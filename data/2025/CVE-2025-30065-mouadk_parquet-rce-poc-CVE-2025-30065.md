# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

# CVE-2025-30065

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md](../2025/CVE-2025-30065-B1ack4sh_Blackash-CVE-2025-30065.md)

## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #2

**来源**: [CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-F5-Labs_parquet-canary-exploit-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #3

**来源**: [CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md](../2025/CVE-2025-30065-ThreatRadarAI_TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行和完全系统控制

**影响版本:** <= 1.15.0

**利用条件:** 需要应用使用Apache Parquet Java库的parquet-avro模块，并处理恶意的Parquet文件。常见于文件上传、API接口或数据管道。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065是一个存在于Apache Parquet Java库parquet-avro模块中的远程代码执行漏洞。该漏洞源于对Avro schema解析过程中的不安全反序列化。攻击者可以通过构造恶意的Parquet文件，利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞允许攻击者执行任意代码，并且给出了修复版本。搜索引擎结果中也包含了多个关于该漏洞的分析和利用的文章。提供的漏洞利用代码模拟了攻击场景，进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的漏洞利用代码主要包含一个HTML文件和一个README.md文件。HTML文件模拟了三种攻击场景，没有发现直接的恶意代码。README.md文件提供了漏洞的描述和利用方法，也没有发现直接的恶意代码。

尽管没有发现明显的恶意代码，但考虑到以下几点，仍存在一定的投毒风险：

1.  **依赖性风险：** HTML展示场景中，可能需要调用其他组件或库来处理Parquet文件，这些依赖项可能存在潜在的漏洞或恶意代码。
2.  **间接风险：** README.md文件可能会引导用户下载或使用其他工具，这些工具可能包含恶意代码。
3. **模拟环境的误导性：** 模拟环境本身是安全的，但用户可能会误以为可以在生产环境中安全地测试恶意Parquet文件，从而导致实际攻击。

基于以上分析，初步判断投毒风险较低，约为10%。

**利用方式分析：**
该漏洞的利用方式主要包括以下几个步骤：

1.  **构造恶意的Parquet文件：** 攻击者需要构造包含恶意Avro schema的Parquet文件。这个schema中包含可以触发不安全反序列化的代码。
2.  **上传或注入恶意文件：** 攻击者将恶意的Parquet文件上传到目标系统，或者通过其他方式将文件注入到目标系统的数据处理流程中。常见场景包括：
    *   通过API接口上传文件。
    *   通过Web表单上传文件。
    *   上传到云存储，并通过自动数据管道（如Apache NiFi/Airflow）进行处理。
3.  **触发漏洞：** 当目标系统使用Apache Parquet Java库的parquet-avro模块解析恶意的Parquet文件时，会触发不安全反序列化漏洞，导致任意代码执行。

总而言之，该漏洞利用的关键在于构造能够触发不安全反序列化的恶意Avro schema，并将该文件传递给存在漏洞的系统进行处理。

**项目地址:** [ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-](https://github.com/ThreatRadarAI/TRA-001-Critical-RCE-Vulnerability-in-Apache-Parquet-CVE-2025-30065-Simulation-)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #4

**来源**: [CVE-2025-30065-bjornhels_CVE-2025-30065.md](../2025/CVE-2025-30065-bjornhels_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化RCE

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 目标系统使用受影响版本的Apache Parquet，且接受并解析来自不可信来源的Parquet文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-30065存在于Apache Parquet Java库的parquet-avro模块中，由于不安全的Avro模式解析导致的反序列化漏洞。攻击者可以构造包含恶意序列化Java对象的Parquet文件，当受害者使用受影响的库解析该文件时，恶意代码将被执行，从而实现远程代码执行（RCE）。

**漏洞利用有效性评估：**

根据漏洞库信息、搜索结果和提供的POC代码，可以判定此漏洞利用是有效的。漏洞库信息明确指出该漏洞允许执行任意代码，搜索结果中多个来源都确认了这是一个高危RCE漏洞，并且POC代码也提供了可行的利用方式。

**投毒风险评估：**

分析提供的POC代码，没有发现明显的投毒代码。`MaliciousPayload.java` 类的目的是执行 `whoami` 命令，用于验证代码执行。`ParquetPayloadWriter.java` 用于生成包含序列化 `MaliciousPayload` 对象的 Parquet 文件。 `ParquetPayloadReader.java`用于读取`Parquet`文件，触发恶意代码。`docker-compose.yaml` 和 `pom.xml` 文件用于构建和运行 POC 环境。虽然理论上作者可以在生成payload时植入其他恶意代码，但当前提供的代码片段没有直接证据表明存在恶意代码植入行为，因此，评估投毒风险极低，给出1%的概率主要原因是存在作者在生成payload阶段可能动手脚的情况。

**漏洞利用方式：**

1.  **构造恶意Parquet文件：** 攻击者创建一个特制的Parquet文件，该文件包含嵌入的序列化Java对象 (`MaliciousPayload`)。`ParquetPayloadWriter.java`用于生成恶意payload。
2.  **诱骗目标解析恶意Parquet文件：** 攻击者通过某种方式（例如，上传、邮件、网络共享等）将恶意Parquet文件发送给受害者。
3.  **触发反序列化：** 当目标应用程序使用受影响版本的Apache Parquet库解析该恶意Parquet文件时，`AvroParquetReader` 会尝试反序列化嵌入的Java对象。`ParquetPayloadReader.java` 用于模拟读取恶意payload。
4.  **执行恶意代码：** 由于不安全的反序列化，`MaliciousPayload` 中的静态代码块将被执行，从而实现远程代码执行。`MaliciousPayload.java`中的静态代码块会执行`whoami`命令作为演示。

总结：漏洞利用过程依赖于反序列化漏洞，攻击者需要构造特殊的Parquet文件并诱使用户加载解析。

**项目地址:** [bjornhels/CVE-2025-30065](https://github.com/bjornhels/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #5

**来源**: [CVE-2025-30065-h3st4k3r_CVE-2025-30065.md](../2025/CVE-2025-30065-h3st4k3r_CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 应用程序使用 Apache Parquet Java 的 parquet-avro 模块处理不可信来源的 Parquet 文件，且环境中存在可利用的 Gadget Class

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 漏洞存在于 Apache Parquet Java 库的 parquet-avro 模块中，允许恶意攻击者通过构造恶意的 Parquet 文件，在受害者系统上执行任意代码。

**利用方式：**

1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。该 schema 的 `default` 字段包含一个指向恶意类的序列化字符串，例如 `!com.securitytest.RCEPayload`。
2.  当受害者应用程序使用 Apache Parquet Java 库（版本 1.15.0 及更早版本）解析该 Parquet 文件时，parquet-avro 模块会尝试反序列化 Avro schema。
3.  由于 `default` 字段的值被当做类名进行实例化，如果受害者环境中存在该类（或攻击者精心构造的 Gadget Class），则会导致任意代码执行。
4.  漏洞利用代码 `POC-CVE-2025-30065-ParquetExploitGenerator.java` 用于生成包含恶意 Avro schema 的 Parquet 文件。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是一个严重级别的 RCE 漏洞，CVSS 评分为 10.0。提供的 POC 代码旨在生成具有恶意 Avro schema 的 Parquet 文件，从而验证该漏洞。从代码实现逻辑来看，POC代码的有效性较高，能够生成触发漏洞的Parquet文件，成功利用的前提是目标classpath存在利用链。

**投毒风险分析：**

查看提供的 POC 代码，发现该代码主要功能是生成包含恶意 Avro schema 的 Parquet 文件。代码中包含一个警告头，表明这是一个 PoC，用于安全研究目的。`appendWarningHeader` 函数会将此头部信息写入 Parquet 文件开头，以提醒用户。

但是，仍需要注意以下几点：

*   **依赖项：** POC 代码依赖于 `org.apache.avro`、`org.apache.parquet` 和 `org.apache.hadoop` 等库。如果这些库本身存在安全问题，或者攻击者篡改了这些依赖项，可能会引入投毒风险。
*   **恶意类：** POC 代码中的 `com.securitytest.RCEPayload` 类是攻击者预先准备好的恶意类，用于执行任意代码。如果攻击者修改了该类的行为，可能会导致意想不到的后果。
*   **appendWarningHeader 函数：**虽然`appendWarningHeader`函数本身没有明显的投毒行为，但是该操作修改了Parquet文件的内容，一定程度上破坏了文件的完整性，如果Parquet文件有完整性校验，那么会校验失败。

综合来看，该POC代码本身存在潜在投毒风险的可能性较低，但是需要使用者注意依赖项安全以及payload的安全性。投毒风险预估为10%，主要来自于依赖和payload可控性。

**项目地址:** [h3st4k3r/CVE-2025-30065](https://github.com/h3st4k3r/CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #6

**来源**: [CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md](../2025/CVE-2025-30065-mouadk_parquet-rce-poc-CVE-2025-30065.md)

## CVE-2025-30065-Apache Parquet-RCE/SSRF

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可导致远程代码执行(RCE)或服务器端请求伪造(SSRF)

**影响版本:** <= 1.15.0

**利用条件:** 需要受影响的系统处理恶意的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065存在于Apache Parquet的parquet-avro模块中，由于不安全的反序列化导致RCE或SSRF。攻击者可以构造恶意的Parquet文件，其中包含恶意的Avro schema，当受害者使用存在漏洞的版本解析该文件时，会导致代码执行或SSRF。

**有效性：**
根据漏洞信息和搜索结果，该漏洞被评为高危，并且已经存在公开的POC代码。POC代码中提供了两种利用方式：
1.  利用RCEPayload.java (需要RCEPayload.java存在于classpath中)
2.  利用MaliciousSSRF.java (可触发SSRF, 风险更高)

综合来看，POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险：**
查看提供的POC代码，主要功能是生成包含恶意Avro schema的Parquet文件，利用`java-class`属性指定反序列化的类。仔细分析代码，并未发现明显的后门或恶意代码。`DISCLAIMER.md`也声明了该代码仅用于教育和安全研究目的。但是，考虑到安全风险，仍然存在一定的投毒风险，比如作者可能使用了混淆技术隐藏了恶意代码，或者依赖了其他不安全的第三方库。 总体投毒风险较低，估计为10%。

**利用方式：**
1.  攻击者构造恶意的Parquet文件，其中包含恶意的Avro schema。Schema中的字段类型利用`java-class`属性指定为恶意类。
2.  受害者使用存在漏洞的Apache Parquet版本读取该Parquet文件。
3.  parquet-avro模块在解析Avro schema时，会尝试反序列化恶意类，从而导致RCE或SSRF。如果classpath中存在利用链，则可以导致RCE。否则，可以使用SSRF payload，发起网络请求。

从提供的`README.md` 可以看到，需要读者理解漏洞原理才能复现成功，所以降低了直接利用的风险。


**项目地址:** [mouadk/parquet-rce-poc-CVE-2025-30065](https://github.com/mouadk/parquet-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---



---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---



---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---



---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---



---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---



---

## POC #7

**来源**: [CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md](../2025/CVE-2025-30065-ron-imperva_CVE-2025-30065-PoC.md)

## CVE-2025-30065-Apache Parquet-反序列化漏洞

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够上传或控制Parquet文件的Avro schema

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30065是Apache Parquet Java库中parquet-avro模块的一个反序列化漏洞。攻击者可以通过构造恶意的Parquet文件，特别是其中的Avro schema，利用不安全的反序列化机制执行任意代码。漏洞存在于1.15.0及之前的版本。根据漏洞库信息，CVSS v4.0评分为10.0，为最高危等级，表明该漏洞易于利用且影响严重。

**有效性分析：**

根据提供的漏洞利用代码（Dockerfile、README.md、entrypoint.sh、pom.xml、GeneratePayload.java、MaliciousObject.java、TriggerVuln.java），可以判断该POC代码是有效的。Dockerfile构建了一个包含易受攻击的Apache Parquet版本的环境，并且包含了生成恶意Parquet文件以及触发漏洞的必要组件。README提供了使用说明，包括构建Docker镜像，生成恶意Parquet文件，以及触发漏洞的步骤。

**投毒风险分析：**

分析POC代码后，没有发现作者隐藏的恶意代码。代码的功能集中于利用反序列化漏洞生成payload和触发漏洞，没有额外连接外部服务器、修改系统配置或执行其他恶意操作的部分。
* `Dockerfile`: 用于构建包含漏洞环境的Docker镜像。没有发现恶意行为。
* `README.md`: 提供使用说明，不包含任何代码。
* `entrypoint.sh`: 用于执行Java程序，根据参数选择生成payload或触发漏洞，没有发现恶意行为。
* `pom.xml`: 定义项目依赖，其中`parquet-avro`的版本为1.12.0，存在漏洞。
* `GeneratePayload.java`: 用于生成包含恶意payload的Parquet文件。它将一个实现了`Serializable`接口的`MaliciousObject`类序列化后，写入Parquet文件。`MaliciousObject`在反序列化时会执行预定义的命令。
* `MaliciousObject.java`: 实现了`Serializable`接口，并在反序列化时执行命令。这个是漏洞利用的核心，但本身不是投毒代码。
* `TriggerVuln.java`: 用于读取Parquet文件并触发反序列化漏洞。没有发现恶意行为。

因此，投毒风险估计为0%。

**利用方式：**

1.  **构建包含漏洞版本的环境：** 使用Dockerfile构建包含Apache Parquet Java库（版本<= 1.15.0）的环境。
2.  **生成恶意Parquet文件：** 运行`GeneratePayload`类，指定要执行的命令和输出文件名。`GeneratePayload`会将包含恶意`MaliciousObject`对象的序列化数据嵌入到Parquet文件的Avro schema中。
3.  **触发漏洞：** 运行`TriggerVuln`类，指定恶意Parquet文件。`TriggerVuln`会读取Parquet文件的Avro schema，并反序列化其中的恶意对象，从而执行任意代码。

**缓解措施：**
升级到Apache Parquet Java 1.15.1或更高版本可以修复此漏洞。

**项目地址:** [ron-imperva/CVE-2025-30065-PoC](https://github.com/ron-imperva/CVE-2025-30065-PoC)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)

---

