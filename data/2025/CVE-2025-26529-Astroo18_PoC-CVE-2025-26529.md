# CVE-2025-26529

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-26529-Astroo18_PoC-CVE-2025-26529.md](../2025/CVE-2025-26529-Astroo18_PoC-CVE-2025-26529.md)

## CVE-2025-26529-Moodle-Stored XSS to RCE

**漏洞编号:** CVE-2025-26529

**漏洞类型:** Stored XSS

**影响应用:** Moodle

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 4.5.0 to 4.5.1, 4.4.0 to 4.4.5, 4.3.0 to 4.3.9, 4.1.0 to 4.1.15

**利用条件:** 需要具有向管理日志写入描述信息权限的用户，以及管理员用户访问管理日志。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26529 是 Moodle 中的一个存储型 XSS 漏洞，存在于站点管理实时日志的功能中。未经充分净化的描述信息会导致 XSS 风险。攻击者可以通过向管理日志中注入恶意 JavaScript 代码，当管理员访问该日志时，恶意代码会被执行，从而窃取管理员的 Cookie，最终利用 Cookie 提权并上传 webshell 实现远程代码执行。

**有效性：**
根据漏洞信息和提供的 PoC 代码，此漏洞利用的有效性较高。PoC 代码中明确指出在 Moodle 4.4.5 版本上测试通过，并且提供了详细的利用步骤和视频演示。

**投毒风险：**
分析 PoC 代码 `console.py`，主要功能是提供一个交互式控制台，用于在 Moodle 服务器上执行命令和下载文件。它依赖于一个名为 `moodle_webshell` 的插件。PoC本身看起来是为了简化利用过程，并没有明显的投毒代码。但是，该PoC仓库中包含的`moodle_webshell` 插件可能存在后门风险，或者被人恶意替换，由于无法获取`moodle_webshell`插件的代码，因此无法准确评估投毒风险。风险评估为10%是基于如下事实：
*PoC作者感谢了p0dalirius, 说明`moodle_webshell`并非PoC作者原创，可能存在未知风险。
*console.py 通过 POST 请求与webshell交互，如果webshell被篡改，可能导致恶意代码执行。

**利用方式：**
1.  **SSRF to XSS:** 首先，通过某种方式（PoC未明确说明，可能需要结合其他漏洞或功能）触发服务端请求伪造 (SSRF)。
2.  **Stored XSS:**  利用 SSRF 将包含恶意 JavaScript 代码的描述信息写入 Moodle 的管理日志。恶意代码的目的通常是窃取管理员的 Cookie。
3.  **Admin Cookie Theft:** 当管理员访问包含恶意代码的管理日志时，恶意 JavaScript 代码会在管理员的浏览器中执行，窃取管理员的 Cookie。
4.  **RCE via Webshell:** 使用窃取的管理员 Cookie 登录 Moodle 后台，然后上传并利用 `moodle_webshell` 插件执行任意命令，从而实现远程代码执行 (RCE)。`console.py` 脚本用于与上传的 webshell 交互。

请注意，此漏洞利用过程依赖于 `moodle_webshell` 插件，该插件并非 Moodle 官方组件，其安全性无法保证。

**项目地址:** [Astroo18/PoC-CVE-2025-26529](https://github.com/Astroo18/PoC-CVE-2025-26529)

**漏洞详情:** [CVE-2025-26529](https://nvd.nist.gov/vuln/detail/CVE-2025-26529)

---

## POC #2

**来源**: [CVE-2025-26529-NightBloodz_moodleTestingEnv.md](../2025/CVE-2025-26529-NightBloodz_moodleTestingEnv.md)

## CVE-2025-26529-Moodle-Stored XSS

**漏洞编号:** CVE-2025-26529

**漏洞类型:** Stored XSS

**影响应用:** Moodle

**危害等级:** 高危，可能导致账户劫持和恶意代码执行

**影响版本:** 4.5.0 to 4.5.1, 4.4.0 to 4.4.5, 4.3.0 to 4.3.9, 4.1.0 to 4.1.15

**利用条件:** 需要能够向管理日志注入恶意代码，通常需要一定权限或欺骗管理员操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26529是Moodle管理界面实时日志中的一个存储型XSS漏洞。攻击者可以利用此漏洞将恶意JavaScript代码注入到管理日志中。当管理员查看日志时，这些恶意代码将被执行，从而可能导致管理员账户被劫持或执行其他恶意操作。

**有效性：**
提供的Dockerfile和docker-compose.yml文件配置了一个易受攻击的Moodle环境（版本4.4.5），明确声明其易受CVE-2025-26529攻击。exploit.py 脚本似乎旨在通过 Web 服务器提供payload，然后通过登录和其他操作来利用该漏洞。该脚本使用requests库与目标Moodle服务器交互，并使用正则表达式来提取登录令牌，这表明有效性较高。

**投毒风险：**
该代码仓库主要目的是搭建一个存在漏洞的环境，并提供一个简单的利用框架。虽然主要的漏洞利用脚本 (exploit.py) 和提供的JavaScript payload（alert(1)）本身没有明显的恶意行为，但仍然存在一些轻微的风险点:
*   服务器组件： Python脚本需要绑定到 IP 地址和端口，增加了暴露在恶意网络流量中的风险，除非谨慎使用，否则可能会被其他攻击者利用。虽然脚本的目的是为了方便漏洞利用，但也有可能被用于恶意目的。
*   依赖性风险：Dockerfile安装了一些不必要的组件, 增加了潜在攻击面。
*   第三方库风险: Python脚本依赖的requests库，存在被供应链攻击的风险。如果requests库被恶意篡改，可能会导致Python脚本执行恶意代码。
总体而言，投毒风险较低，约为10%。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建一个存在漏洞的Moodle环境 (版本4.4.5)。
2.  **准备Payload：**  准备一个恶意的JavaScript payload，例如修改管理员权限或执行其他恶意操作的代码。
3.  **启动攻击服务器：** 运行 exploit.py 脚本，设置适当的IP地址、端口和JavaScript文件路径。这个脚本会启动一个Web服务器来提供payload。
4.  **获取登录token:** 通过目标服务器获取login token。
5.  **注入XSS：**  构造包含恶意JavaScript代码的请求，将其注入到Moodle的管理日志中，可能通过伪造管理员身份、或者欺骗管理员点击链接的方式实现。
6.  **触发漏洞：**  等待管理员查看包含恶意代码的日志条目，或者诱导管理员查看。当管理员访问该日志条目时，恶意JavaScript代码将在管理员的浏览器中执行。

**项目地址:** [NightBloodz/moodleTestingEnv](https://github.com/NightBloodz/moodleTestingEnv)

**漏洞详情:** [CVE-2025-26529](https://nvd.nist.gov/vuln/detail/CVE-2025-26529)

---

## POC #3

**来源**: [CVE-2025-26529-exfil0_UNISA_CVE-2025-26529.md](../2025/CVE-2025-26529-exfil0_UNISA_CVE-2025-26529.md)

## CVE-2025-26529-Moodle-Stored XSS

**漏洞编号:** CVE-2025-26529

**漏洞类型:** Stored XSS

**影响应用:** Moodle

**危害等级:** 高危，可能导致账户劫持、权限提升、恶意代码执行。

**影响版本:** 4.5.0 to 4.5.1, 4.4.0 to 4.4.5, 4.3.0 to 4.3.9, 4.1.0 to 4.1.15, 4.2.*, 4.0.*

**利用条件:** 需要用户交互，可能需要较低权限的用户发布包含恶意脚本的内容。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26529 是 Moodle 的管理实时日志中存在的存储型跨站脚本 (XSS) 漏洞。根据漏洞描述，漏洞是由于站点管理实时日志中显示的信息需要额外的清理以防止存储的 XSS 风险。攻击者可以利用此漏洞在 Moodle 网站上存储恶意 JavaScript 代码。当其他用户（包括管理员）查看包含恶意代码的日志时，脚本会在他们的浏览器中执行，从而可能导致会话劫持、cookie窃取或执行其他恶意操作。

**有效性：**
提供的PoC代码似乎有效，因为它包含检测和利用CVE-2025-26529漏洞所需的必要组件。该代码包括一个扫描器（xss_checker.py），该扫描器使用各种XSS有效负载来测试Moodle实例是否存在漏洞。它还包含用于演示DOM XSS攻击和clickjacking攻击的PoC HTML文件。

PoC脚本xss_checker.py针对UNISA Moodle门户网站，并通过检查暴露文件、有效负载反射和管理面板可访问性来确认漏洞的存在。此外，该脚本使用Selenium在无头浏览器中自动加载DOM XSS PoC，从而进一步验证了DOM XSS漏洞。

**投毒风险：**
分析PoC代码，发现以下潜在的投毒风险：

*   **目标明确：**  该PoC明确针对`mymodules.dtls.unisa.ac.za`，其他Moodle实例的测试可能会产生未预期的结果。
*   **依赖外部资源：**  PoC依赖于`requirements.txt`中指定的外部Python库。虽然这些库本身很常用，但供应链攻击可能导致这些库被恶意版本替换。
*   **日志记录：**  PoC会将扫描结果写入日志文件`cve2025_full_scan.log`。如果日志记录功能被滥用，可能会泄露敏感信息。
*   **无头浏览器：** 使用Selenium运行无头浏览器增加了复杂性，并且引入了与浏览器本身相关的潜在风险。

考虑到以上因素，我估计该PoC存在10%的投毒风险。主要的风险在于PoC的目标限定以及潜在的依赖项问题。

**利用方式：**
1.  **未经身份验证的攻击：**
    *   攻击者将恶意代码注入到可以写入管理实时日志的任何未经过滤的字段中。这可能涉及利用另一个漏洞或利用Moodle配置中的缺陷。
2.  **存储型XSS：**
    *   恶意代码被存储在数据库中，并显示在管理实时日志中。
3.  **管理员交互：**
    *   当管理员查看包含恶意代码的日志时，JavaScript 代码将在其浏览器中执行。
4.  **攻击后果：**
    *   攻击者可以劫持管理员会话，从而完全控制 Moodle 网站。
    *   攻击者可以更改网站配置、创建新帐户或注入其他恶意代码。

**项目地址:** [exfil0/UNISA_CVE-2025-26529](https://github.com/exfil0/UNISA_CVE-2025-26529)

**漏洞详情:** [CVE-2025-26529](https://nvd.nist.gov/vuln/detail/CVE-2025-26529)

---

