## CVE-2025-55182 - React Server Components, Next.js (使用App Router) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js (使用App Router)

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** React Server Components versions 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js applications using the App Router (例如 PoC 中使用的 next: 16.0.6)

**利用条件:** 无需认证 (pre-authentication), 远程网络访问, 通过恶意构造的HTTP请求发送至Server Function端点

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182 是一个影响 React Server Components (RSC) 的关键远程代码执行 (RCE) 漏洞，特别是当它们与 Next.js 的 App Router 结合使用时。此漏洞源于对发送到服务器函数端点的 HTTP 请求中的有效负载进行不安全的反序列化，攻击者能够注入恶意数据，从而在服务器上执行任意代码。Next.js 中的下游影响由 CVE-2025-66478 跟踪。

**POC有效性分析**
所提供的PoC是一个精心构建的、用于测试安全扫描器的最小化易受攻击环境。它通过Docker镜像（`ghcr.io/l4rm4nd/cve-2025-55182:latest`）提供了一个预配置的Next.js应用。该应用被特意配置为使用易受攻击的依赖版本，包括 `next: 16.0.6`、`react: 19.2.0` 和 `react-dom: 19.2.0`，这些版本明确指出了其对 CVE-2025-55182 的脆弱性。`Dockerfile` 文件清晰地展示了应用程序的构建和运行方式，确保了环境的可复现性。`README.md` 文件提供了详细的运行指南和漏洞检测方法，推荐使用 AssetNote Scanner 进行验证，并展示了扫描器成功检测到漏洞的示例输出。这表明该PoC能够有效且可靠地复现和验证 CVE-2025-55182 远程代码执行漏洞。PoC 的设计侧重于 RCE，这与搜索结果中频繁提及的 React Server Components 拒绝服务漏洞 (CVE-2025-55184, CVE-2025-67779, CVE-2026-23864) 和源代码暴露漏洞 (CVE-2025-55183) 有所区别。本次分析主要聚焦于 PoC 所针对的 RCE 漏洞。

**利用步骤**
1.  **环境搭建**: 首先，攻击者或安全研究人员需要在本地安装Docker环境。然后，通过执行 `docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest` 命令，启动一个监听在本地 `127.0.0.1:3000` 端口的易受攻击的Next.js应用程序。
2.  **准备利用工具**: 获取 PoC 中提及的 AssetNote Scanner 或其他能够生成恶意 RSC Flight Payload 的工具。根据 PoC 说明，可以通过 `git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner` 下载并配置扫描器。
3.  **执行漏洞检测/利用**: 运行扫描器，并指定目标URL为已启动的易受攻击服务地址。例如，执行 `python3 scanner.py -u http://127.0.0.1:3000`。扫描器会向 Next.js 的 Server Function 端点发送特制的 HTTP 请求，这些请求包含精心构造的恶意载荷，旨在触发不安全的反序列化。
4.  **远程代码执行**: 如果目标系统存在漏洞，恶意载荷将在服务器端被反序列化并执行，从而导致攻击者获得远程代码执行的能力。由于此漏洞是预认证的，且攻击复杂度低，攻击者无需任何凭据即可通过网络触发，实现对服务器的完全控制，从而执行任意命令、窃取数据或进行其他恶意操作。

**投毒风险分析**
此PoC的投毒风险评估为5%，属于极低风险。主要理由如下：
1.  **目的明确且合法**: 该PoC明确声明其目的是“提供一个最小化的、有意易受攻击的环境，以测试安全扫描器对抗最近的关键RCE漏洞”，属于合法的防御性安全研究工作。其`README.md`文件清晰地警告用户“此设置是故意易受攻击的，绝不能暴露给公共互联网或用于生产环境”，表明了负责任的披露态度。
2.  **代码透明度高**: `Dockerfile` 文件内容直观，明确列出了基础镜像、依赖项安装和应用程序构建过程，不包含混淆代码或可疑的外部调用。`package.json` 中的依赖版本也清晰可见，均为开源库。这种高度透明的代码结构使得安全研究人员可以轻松审计其内容，确保没有隐藏的恶意行为。
3.  **无恶意行为植入**: PoC 的核心在于搭建一个易受攻击的靶机环境，而非执行恶意攻击。它不包含任何后门代码、加密货币挖掘器、数据窃取逻辑或C2（命令与控制）通信模块。其功能仅限于创建一个可被攻击者利用的漏洞点，以便进行安全测试和验证。

尽管PoC本身风险极低，但在实际应用和研究过程中，仍需警惕以下潜在的间接风险：
1.  **伪装和变种PoC**: 恶意攻击者可能会发布伪装成合法PoC的恶意版本。这些变种可能包含混淆的代码、隐藏的恶意有效载荷或利用供应链投毒技术，在用户不知情的情况下执行恶意操作。因此，务必从官方或可信赖的来源获取PoC代码，并进行代码审计。
2.  **供应链依赖风险**: 尽管此PoC的代码较为干净，但它依赖于Node.js、npm 和 Docker 等工具及其各自的生态系统。如果这些依赖项的某个环节被投毒（例如，某个npm包被恶意篡改），即使PoC代码本身没有问题，也可能间接引入恶意软件。
3.  **误用风险**: 即使PoC明确警告，缺乏安全意识的用户仍可能在生产环境或公共可访问的网络上部署此类易受攻击的环境，从而成为真实攻击者的目标。因此，在使用任何PoC时，都必须在隔离且受控的环境中进行操作。

综上所述，PoC代码本身的投毒风险非常低，但用户在下载、使用和部署此类安全研究工具时，仍需保持高度警惕，严格遵守安全实践，以防范潜在的间接或变种攻击。

**项目地址:** https://github.com/l4rm4nd/cve-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
