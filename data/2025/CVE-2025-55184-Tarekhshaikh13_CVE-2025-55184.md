## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** React Server Components (react, react-dom) versions 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 16.0.6 (使用App Router)

**利用条件:** 无需认证, 可远程利用, 通过发送恶意构造的HTTP请求至服务器函数端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

### POC有效性分析
该POC提供了一个完整、独立且易于部署的漏洞环境，专门用于演示和测试`CVE-2025-55182`及`CVE-2025-66478`，这被描述为React Server Components和Next.js中的预认证远程代码执行（RCE）漏洞。POC通过明确的`Dockerfile`和`package.json`文件，将关键依赖如`next`（版本16.0.6）、`react`（版本19.2.0）和`react-dom`（版本19.2.0）锁定在已知易受攻击的版本。这种精确的版本控制确保了漏洞环境的高度可复现性。`README.md`文件提供了清晰的部署说明，用户可以通过简单的`docker run`命令快速启动一个易受攻击的Next.js应用程序实例。更重要的是，该POC还指出了如何使用外部的`react2shell-scanner`工具进行漏洞检测和验证，该扫描器旨在发送恶意的RSC Flight Payload以触发不安全的反序列化过程，最终导致RCE。这使得安全研究人员和开发者能够高效地验证漏洞的存在性及其可利用性，极大地提升了该POC的实用性和有效性。整体而言，该POC在环境配置、漏洞复现和验证方面表现出高水平的质量和可靠性。

### 利用步骤
1.  **环境搭建**：首先，攻击者或安全研究人员需要在一个支持Docker的环境中，通过执行`docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest`命令来启动一个包含易受攻击的Next.js应用程序的容器。该容器将在本地的3000端口对外暴露服务，并运行一个配置了特定脆弱版本（如React 19.2.0和Next.js 16.0.6）的React Server Components应用。
2.  **漏洞检测/利用工具准备**：该POC推荐使用AssetNote团队提供的`react2shell-scanner`工具来检测和利用漏洞。攻击者或研究人员需要从GitHub克隆该工具的仓库：`git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner`。接着，在Python虚拟环境中安装所需的依赖：`virtualenv venv && source venv/bin/activate && pip install -r requirements.txt`，以确保扫描器能够正常运行。
3.  **执行攻击**：完成工具准备后，针对已启动的易受攻击服务（默认地址为`http://127.0.0.1:3000`）执行扫描或攻击命令：`python3 scanner.py -u http://127.0.0.1:3000`。该扫描器会负责构造并发送包含恶意RSC Flight Payload的HTTP请求到目标应用的服务器函数端点。由于应用程序在反序列化这些请求时存在安全缺陷，恶意Payload将被不安全地处理，从而触发远程代码执行漏洞。
4.  **结果验证**：扫描器执行完成后，会输出漏洞检测结果。如果漏洞被成功利用，通常意味着攻击者能够在目标服务器上执行任意代码，例如获取反弹shell、读取或写入敏感文件、执行系统命令等。具体的RCE效果取决于攻击者构造的Payload的复杂程度和目标环境的配置情况。

### 投毒风险分析
该POC代码本身表现出极低的投毒风险，评估为0%。其设计目的和实现方式都符合合法安全研究和测试的标准。具体分析如下：
1.  **明确的防御性声明**：POC的`README.md`文件开宗明义地指出这是一个“故意易受攻击的环境”，其目的是“测试安全扫描器”，并明确警告“绝不能将其暴露给公共互联网或用于生产环境”。这种声明是合法安全研究项目的典型特征，旨在帮助防御者而非攻击者。
2.  **代码高度透明**：所有提供的代码文件，包括`Dockerfile`、`Dockerfile.bk`、`package.json`等，内容均清晰可见，未进行任何形式的代码混淆、加密或隐藏。这些文件主要用于构建和运行一个标准的Node.js/Next.js应用程序，并明确地将`next`和`react`等核心组件版本锁定在已知的脆弱版本，以重现漏洞。所有`npm install`等操作均为标准的包管理和构建流程。
3.  **无恶意行为迹象**：在提供的代码片段中，未发现任何可疑的、非预期的恶意行为。这包括但不限于：没有向未知外部服务器发送数据（如回连C2服务器），没有进行异常的文件系统操作（如篡改系统文件、创建后门），没有加载非标准或高度可疑的外部脚本，也没有滥用`eval()`或`child_process`模块等敏感函数执行非预期的动态代码。`server.js`和`app`目录下的Next.js应用组件是构建正常Web应用程序的组成部分，不包含植入的恶意逻辑。
4.  **依赖项的合法性**：`package.json`文件中列出的依赖项均为Next.js和React生态系统中广泛使用且经过验证的标准库。尽管这些特定版本存在漏洞，但这些库本身并非恶意软件，其引入是为了模拟真实世界的脆弱应用环境，而非注入恶意功能。
5.  **目的专注性**：该POC的核心目标是提供一个可复现的漏洞环境，以便于安全团队进行漏洞研究、渗透测试工具开发或安全产品验证。它通过构建一个符合已知漏洞条件的应用来达到这一目的，而不是通过在代码中嵌入恶意逻辑来实施攻击。
综上所述，该POC完全符合安全社区的道德规范，旨在促进漏洞研究和防御能力的提升。因此，将其误判为带有投毒风险的恶意软件的可能性极低，投毒风险评估为0%。

**项目地址:** https://github.com/l4rm4nd/cve-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
