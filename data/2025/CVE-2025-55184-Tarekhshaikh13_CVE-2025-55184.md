## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 高危

**CVSS评分:** 未提供具体数值，但为关键RCE漏洞

**影响版本:** React Server Components: 19.0.0, 19.1.0, 19.1.1, 19.2.0。Next.js: 16.0.6 (使用App Router), react: 19.2.0, react-dom: 19.2.0

**利用条件:** 预认证、网络访问、恶意构造的HTTP请求

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

### POC有效性分析
本POC，代号为“React2Shell PoC”，主要针对CVE-2025-55182这一关键的预认证远程代码执行（RCE）漏洞。该漏洞影响React Server Components（RSC）的特定版本以及使用App Router的Next.js应用程序。其根本原因在于服务器函数端点接收到的HTTP请求中的有效载荷存在不安全的反序列化缺陷，攻击者通过恶意构造的请求即可触发RCE。POC明确指出受影响的React Server Components版本包括19.0.0、19.1.0、19.1.1和19.2.0，并且特别提到Next.js应用（如版本16.0.6）在使用App Router时也会受到影响，涉及react和react-dom版本19.2.0。

该POC通过Docker容器提供了一个最小化的、有意为之的脆弱环境。`Dockerfile`清晰地定义了构建过程，包括基于`node:20-alpine`镜像、安装依赖（如`next`、`react`、`react-dom`的脆弱版本）、拷贝应用文件并最终构建和启动Next.js应用。这种设置确保了环境的高度可控性和可重复性，使其成为验证CVE-2025-55182的理想平台。`README.md`文件也明确了其作为“测试安全扫描器”的用途，并强调其“有意脆弱”的性质，绝不应在生产环境中使用。通过配合AssetNote提供的`react2shell-scanner`，可以有效验证并演示该RCE漏洞的成功利用，从而确认POC的完整性和有效性。值得注意的是，提供的搜索结果主要讨论的是React Server Components的拒绝服务（DoS）漏洞（如CVE-2025-55184）和源代码暴露漏洞（如CVE-2025-55183），而并非此RCE漏洞（CVE-2025-55182），这意味着搜索结果与本POC所针对的特定漏洞存在信息差异，本分析以POC信息为准。

### 利用步骤
1.  **启动漏洞环境**：在本地终端中执行Docker命令，拉取并运行预配置的漏洞镜像。这将启动一个包含脆弱Next.js应用的容器，该应用将在本地的3000端口监听HTTP请求。
    ```bash
docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest
    ```
2.  **获取漏洞扫描器**：在新的终端窗口中，克隆AssetNote提供的专门用于检测此RCE漏洞的扫描工具。
    ```bash
git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner
    ```
3.  **安装扫描器依赖**：为扫描器创建一个独立的Python虚拟环境，并安装其运行所需的所有Python依赖。
    ```bash
virtualenv venv && source venv/bin/activate && pip install -r requirements.txt
    ```
4.  **执行漏洞检测**：使用已配置好的扫描器对运行中的漏洞应用发起攻击，探测并确认RCE漏洞的存在。扫描器将向`http://127.0.0.1:3000`发送恶意构造的HTTP请求。
    ```bash
python3 scanner.py -u http://127.0.0.1:3000
    ```
5.  **验证结果**：如果漏洞利用成功，扫描器将返回指示远程代码已执行的输出，例如显示目标系统的`whoami`命令结果，从而确认CVE-2025-55182漏洞已成功被触发。

### 投毒风险分析
该POC的投毒风险评估为低（10%）。其设计宗旨是为防御性安全研究提供一个透明且可控的漏洞复现环境，而非进行恶意活动。以下是详细分析：

1.  **代码透明性与可读性**：POC提供的`Dockerfile`及其内容清晰易懂，所有步骤都一目了然。它包含了标准的Node.js应用构建指令，如`FROM node:20-alpine`、`COPY`文件、`RUN npm install`和`npm run build`。没有发现任何代码混淆、加密或难以理解的逻辑，这大大降低了隐藏恶意行为的可能性。

2.  **依赖项的合法性**：`package.json`文件中列出的依赖项如`next`、`react`、`react-dom`均为公开且广泛使用的合法JavaScript库。虽然它们被指定为存在漏洞的特定版本，但这正是为了实现漏洞复现的目的。`npm install`过程会从官方NPM注册表拉取这些包，而非未经验证的第三方源。

3.  **无外部可疑资源引入**：POC的`Dockerfile`或`README.md`中没有发现任何下载或执行来自不明外部URL的脚本或二进制文件的指令。Docker镜像的拉取源`ghcr.io/l4rm4nd/cve-2025-55182:latest`指向GitHub Container Registry，这是一个由GitHub官方运营的镜像托管服务，通常被认为是可信的开源项目发布渠道。扫描器也通过GitHub进行克隆，进一步验证了其来源的合法性。

4.  **明确的安全警告**：`README.md`中包含了明确的警示信息，指出“此设置是有意为之的漏洞环境，绝不能暴露到公共互联网或用于生产环境”。这种负责任的披露表明作者的意图是促进安全研究，而非造成危害。

5.  **POC的本质与漏洞利用行为的区别**：RCE漏洞的利用本身是安全研究的一部分，即通过特定的输入在目标系统上执行任意代码。POC的目的就是演示这种“利用”。例如，当扫描器成功触发RCE并执行`whoami`命令时，这并非POC代码本身的“投毒”，而是漏洞成功被利用后，攻击者（此处是扫描器）在目标系统上执行了指令。POC代码本身并未包含恶意负载，而是提供了一个能被外部（扫描器）利用来执行代码的脆弱环境。

综上所述，此POC的代码结构、依赖管理和作者意图均符合防御性安全研究的标准，不含有主动的恶意投毒行为。使用者在隔离环境中遵循指示进行操作，可有效避免潜在风险。

**项目地址:** https://github.com/l4rm4nd/cve-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
