## CVE-2025-55182 - React Server Components, Next.js Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** React Server Components versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0. Next.js applications using the App Router are also affected when bundling these vulnerable React Server Components versions (e.g., Next.js 16.0.6 demonstrated in PoC).

**利用条件:** Pre-authentication required, network access required.

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

本报告详细分析了CVE-2025-55182，这一被命名为“React2Shell”的严重预认证远程代码执行（RCE）漏洞。该漏洞主要影响React Server Components，并间接影响使用App Router的Next.js应用程序。具体而言，受影响的React Server Components版本包括19.0.0、19.1.0、19.1.1和19.2.0，涉及的包如react-server-dom-parcel、react-server-dom-turbopack和react-server-dom-webpack。漏洞的根本原因在于针对服务器函数端点的HTTP请求中，对payload的非安全反序列化操作。未经认证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码，从而导致数据窃取、系统全面受控或应用程序彻底被接管等严重后果。相关的CVE-2025-66478专门跟踪了此漏洞对Next.js应用程序的下游影响，凸显了其潜在的广泛威胁。CVSS评分虽未在输入中明确给出，但根据其“关键RCE”和“预认证”特性，评估为9.8，属于最高威胁等级。此漏洞需要组织高度关注并立即采取防护措施。

**POC有效性分析 (Proof-of-Concept Effectiveness Analysis):**
所提供的概念验证（PoC）经过精心设计，具有极高的有效性和可靠性，能够准确重现和验证CVE-2025-55182漏洞。它构建了一个自包含、故意包含漏洞的Next.js应用程序环境，并通过Docker轻松部署。`Dockerfile`和`Dockerfile.bk`清晰地描绘了设置过程，从建立Node.js运行时到安装必要的依赖项，复制应用程序文件，执行Next.js构建，并最终启动服务器。这种透明的构建过程确保了安全研究人员可以审查环境的构建，以排除任何意外的复杂性或隐藏组件。

PoC有效性的一个关键方面在于其明确锁定了易受攻击的软件版本。`package.json`文件指定使用`next@16.0.6`、`react@19.2.0`和`react-dom@19.2.0`。这些版本已知易受“React2Shell”RCE漏洞的影响，从而确保PoC环境准确反映了易受攻击的状态。这种精确的版本控制对于在不同测试设置中实现一致的重现至关重要。

此外，PoC附带的`README.md`为运行易受攻击的应用程序和检测RCE提供了全面而明确的说明。它详细说明了如何使用预构建的Docker镜像（`ghcr.io/l4rm4nd/cve-2025-55182:latest`）启动Docker容器，以及如何使用外部的`AssetNote Scanner`。AssetNote是一家著名的安全研究公司，其专用扫描器通过尝试触发RCE来验证漏洞。这种分层方法——受控的易受攻击环境与专用检测工具相结合——使PoC成为防御性安全团队的宝贵资源。它使他们能够理解漏洞的底层机制，开发内部检测签名，并严格测试自己的安全解决方案，以应对真实的关键RCE。易于部署和验证大大降低了安全从业人员的入门门槛，从而能够快速进行研究和改善防御态势。PoC清晰的演示和验证方法巩固了其作为解决CVE-2025-55182的强大而可靠工具的地位。

**利用步骤 (Exploitation Steps):**
利用所提供的PoC和扫描器来利用CVE-2025-55182涉及一系列清晰的行动：

1.  **启动易受攻击的环境**：第一步是启动故意易受攻击的Next.js应用程序。这通过Docker实现：
    ```bash
    docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest
    ```
    此命令拉取并运行预配置的Docker镜像，其中包含易受攻击的Next.js应用程序。`-p 127.0.0.1:3000:3000`标志将容器内部的3000端口映射到主机机器环回接口的3000端口，使应用程序可在本地`http://127.0.0.1:3000`访问。`--rm`标志确保容器在退出时自动移除，以保持测试环境的清洁。

2.  **获取漏洞扫描器**：下一步是获取专门设计用于检测CVE-2025-55182的扫描器。此扫描器由AssetNote提供，可在GitHub上获取：
    ```bash
    git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner
    ```
    此命令将扫描器的仓库克隆到本地机器，并将当前目录更改为新克隆的仓库目录。

3.  **准备扫描器环境**：基于Python的扫描器需要特定的依赖项。这些依赖项可以在虚拟环境中安装，以避免与系统范围的Python包发生冲突：
    ```bash
    virtualenv venv && source venv/bin/activate && pip install -r requirements.txt
    ```
    此序列创建一个名为`venv`的虚拟环境，激活它，然后安装`requirements.txt`中列出的所有必要的Python库（例如`requests`、`urllib3`、`click`）。

4.  **执行漏洞检测**：在易受攻击的应用程序运行且扫描器环境准备就绪后，最后一步是针对目标执行扫描器：
    ```bash
    python3 scanner.py -u http://127.0.0.1:3000
    ```
    `scanner.py`脚本将向指定的URL（`http://127.0.0.1:3000`）发送特制HTTP请求。这些请求旨在通过在请求体中嵌入恶意payload来利用React Server Components中的非安全反序列化漏洞，通常针对服务器函数端点。成功利用后，扫描器将确认RCE的存在，通常通过触发回调（例如DNS外渗）或尝试执行一个简单命令并随后检索其输出来演示在没有任何事先认证的情况下在服务器上执行任意代码。此过程最终验证了CVE-2025-55182的存在和可利用性。

**投毒风险分析 (Poisoning Risk Analysis):**
本PoC项目的投毒风险评估为极低，设定为10%。这一评估基于对其来源、代码内容、行为模式以及其明确声明的分析。

首先，从**项目来源和透明度**来看，该PoC由安全研究人员创建，其Docker镜像通过`ghcr.io`（GitHub Container Registry）提供，而推荐用于检测的扫描器则由知名的安全研究公司AssetNote开发并开源于GitHub。这种开放且可溯源的来源显著增强了其可信度。更重要的是，项目`README.md`中包含明确而醒目的警告：“此设置有意包含漏洞，绝不能公开暴露到互联网或用于生产环境。” 这一透明的声明明确了PoC的防御性安全研究目的，而非恶意利用。

其次，深入分析**代码内容和行为模式**，未发现任何恶意或可疑迹象。
- **`Dockerfile`s**（`Dockerfile`和`Dockerfile.bk`）的内容是标准且可预见的。它们主要负责设置Node.js运行环境、安装依赖项、复制应用文件、执行构建过程以及启动Next.js应用。整个流程中，没有发现任何尝试拉取外部未知脚本、执行加密或混淆代码、建立隐秘网络通信通道、或请求非必要系统权限的命令。所有构建步骤都清晰地列出，便于审查。
- **`package.json`** 文件作为Node.js项目的依赖管理核心，其内容清晰地列出了所有项目依赖及其精确版本。特别指出的是，为了重现`CVE-2025-55182`，该文件有意地将`next`、`react`和`react-dom`等核心框架降级到已知存在漏洞的版本（例如`next@16.0.6`, `react@19.2.0`）。所有列出的依赖包均来自标准的npm官方仓库，未引入任何第三方、未经验证或来源可疑的包。这进一步降低了通过依赖链条引入恶意组件的风险。
- **应用程序代码（隐含）**：尽管PoC中未提供完整的Next.js应用程序代码，但从其“最小化有意易受攻击环境”的描述来看，可以合理推断其内部代码是简洁的，主要用于展示漏洞点，而非包含复杂的、具有副作用的业务逻辑或潜在的恶意功能。
- **扫描器**：推荐使用的AssetNote扫描器是一个独立的Python脚本，其唯一职责是探测并验证`CVE-2025-55182`的存在。即使其代码未包含在此PoC仓库中，但AssetNote作为一家专业的安全公司，其发布的工具通常经过严格审查，旨在合法安全测试。没有迹象表明该扫描器会进行恶意活动（如数据窃取、后门植入等）。

最后，项目中没有检测到任何尝试实现持久化后门、窃取敏感数据、发起拒绝服务攻击、进行横向移动或执行其他未授权行为的代码片段。该PoC的整体设计和实现与其作为安全研究和防御测试工具的声明完全一致。它旨在帮助组织理解漏洞并加强防御，而非构成新的威胁。因此，其投毒风险被判定为极低。

**项目地址:** https://github.com/l4rm4nd/cve-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
