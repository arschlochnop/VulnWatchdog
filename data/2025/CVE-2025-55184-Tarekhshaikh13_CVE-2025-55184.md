## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 高危/严重

**CVSS评分:** 未披露，预计9.8

**影响版本:** React Server Components versions 19.0.0, 19.1.0, 19.1.1, 19.2.0 (包括 react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack 包); Next.js 16.0.6 (使用App Router的应用)

**利用条件:** 预认证 (pre-authentication)，无需认证；攻击者通过不安全反序列化HTTP请求payload至服务器函数端点即可利用

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个针对React Server Components (RSC)和Next.js应用的严重远程代码执行漏洞，其核心在于对HTTP请求到服务器函数端点的数据进行了不安全的反序列化。此漏洞允许未经身份验证的攻击者通过构造恶意payload来执行任意代码，对受影响的系统构成重大威胁。此外，CVE-2025-66478追踪了该漏洞对使用App Router的Next.js应用程序的下游影响。同时，搜索结果中也提到了CVE-2025-55184（DoS）和CVE-2025-55183（源代码暴露），但本POC主要针对RCE漏洞。

**POC有效性分析**
该POC提供了一个功能完整且易于部署的测试环境，用于复现和验证CVE-2025-55182漏洞。它通过两个`Dockerfile`定义了基于Node.js 20-alpine的Docker镜像，其中一个用于生产环境部署（`Dockerfile`），另一个用于多阶段构建优化（`Dockerfile.bk`）。应用配置精确地锁定了已知的脆弱版本：`next: 16.0.6`，以及`react`和`react-dom`的`19.2.0`版本。`README.md`文件清晰地阐述了漏洞的背景信息，其CVE ID（CVE-2025-55182和影响Next.js的CVE-2025-66478），并明确指出这是一个“故意脆弱的环境”，不应暴露于公共网络。POC提供了通过Docker命令运行预构建镜像的简便方法，同时指示了如何使用AssetNote提供的外部扫描器进行漏洞检测。这种自包含、易于部署和验证的特性，使得该POC在复现和测试方面具有极高的有效性和可用性。

**利用步骤**
1.  **准备环境**：确保本地已安装Docker。
2.  **运行易受攻击的应用**：通过执行`docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest`命令，启动包含漏洞的Next.js应用。这将在本地3000端口监听服务。
3.  **获取检测工具**：从GitHub克隆AssetNote的React2Shell扫描器项目：`git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner`。该项目地址为`https://github.com/assetnote/react2shell-scanner`。
4.  **配置扫描器**：在扫描器目录中，创建并激活Python虚拟环境：`virtualenv venv && source venv/bin/activate`，然后安装所需依赖：`pip install -r requirements.txt`。
5.  **执行漏洞检测**：运行扫描器对本地运行的易受攻击服务进行检测：`python3 scanner.py -u http://127.0.0.1:3000`。
6.  **验证结果**：扫描器将与易受攻击的服务交互，尝试触发并检测漏洞。成功检测将表明RCE漏洞的存在，验证POC的有效性。

**投毒风险分析**
对该POC的投毒风险评估结果为低风险（10%），主要基于以下考量：
*   **代码清晰度与透明度**：POC的核心文件（`Dockerfile`、`Dockerfile.bk`、`README.md`）结构清晰，所有配置和命令都直接可见，未发现任何形式的代码混淆、加密或二进制打包。`Dockerfile`遵循标准的Docker构建实践，包括安装Node.js依赖、复制应用程序文件和执行构建命令。`README.md`详细阐述了漏洞信息、POC目的以及运行和检测方法，其坦诚的警告“This setup is intentionally vulnerable and must never be exposed to the public internet or used in production”进一步增强了其透明度，明确了其安全测试而非恶意利用的性质。
*   **依赖项分析**：`Dockerfile`中通过`npm install`安装的依赖项是构建Next.js应用程序的标准组件，如`next`、`react`和`react-dom`。这些依赖项的版本被刻意锁定为已知存在`CVE-2025-55182`漏洞的版本，以确保漏洞复现环境的准确性。在`package.json`中没有发现引入任何异常的、非官方的、或是被安全社区标记为恶意的第三方库。所有的依赖管理都通过标准的npm机制进行，没有迹象表明有隐蔽的或未经授权的包注入。
*   **外部资源与网络行为**：POC的运行环境构建于官方的`node:20-alpine`Docker镜像之上，确保了基础环境的纯净性。应用程序本身在容器内部运行，其设计目的是模拟一个存在RCE漏洞的Web服务。在POC的代码中，并未发现有主动连接外部未知服务器、下载并执行可疑脚本或二进制文件、尝试进行域名解析劫持等恶意网络行为。用于检测该漏洞的扫描器（`react2shell-scanner`）则是由知名安全公司AssetNote提供，其在GitHub上公开的源代码表明其专注于漏洞检测，不包含恶意功能。POC的执行流程完全局限于本地环境的搭建和测试，没有超出此范围的异常外部通信。
*   **无恶意功能实现**：仔细审查了提供的POC代码，未发现任何旨在执行传统恶意行为的逻辑，例如植入后门、进行凭据窃取、发起拒绝服务攻击（除了复现漏洞本身，该漏洞允许攻击者发起RCE，而非POC本身发起攻击）、挖掘加密货币、篡改系统关键文件或利用其他漏洞链。该POC的唯一明确目的是创建一个可复现RCE漏洞的环境，以供安全研究人员、渗透测试人员或漏洞扫描器进行测试和验证。它是一个纯粹用于防御性研究和教育目的的工具，因此，在严格遵循其运行指南并在隔离环境中操作的前提下，其投毒风险可以被认为是极低的。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
