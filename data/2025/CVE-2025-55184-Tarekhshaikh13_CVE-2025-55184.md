## CVE-2025-55182 - React Server Components / Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components / Next.js

**危害等级:** 致命 (Critical)

**CVSS评分:** 10.0

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 16.0.6 (App Router 模式)

**利用条件:** 远程未经身份验证，攻击者需能够向 Server Function (RSC) 端点发送精心构造的 HTTP 请求。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为 'React2Shell'，其核心在于 React Server Components (RSC) 在处理服务端函数（Server Functions）端点时，由于不安全地反序列化了来自 HTTP 请求的 Payload，导致攻击者能够注入并执行恶意代码。提供的 POC 代码是一个高度结构化的 Dockerized 环境，通过将 Next.js 锁定在 16.0.6 版本、React 锁定在 19.2.0 版本，完美复现了受影响的依赖链。Dockerfile 采用了多阶段构建（Stage 1 build 和 Stage 2 runtime），这确保了复现环境的一致性和隔离性。README 明确指出了漏洞点位于 react-server-dom-parcel、react-server-dom-turbopack 和 react-server-dom-webpack 等核心包中。该 POC 不仅提供了目标环境，还关联了 AssetNote 开发的专用扫描工具（react2shell-scanner），这进一步证实了漏洞的真实性与可利用性。通过分析 POC，可以确认利用步骤通常涉及向 Next.js 的 RSC 路径发送 POST 请求，并在请求头或 Body 中携带特定的反序列化 Payload。由于该漏洞处于预认证阶段，且 React 应用广泛，其潜在杀伤力极大。利用该 POC，安全研究员可以清晰地观察到恶意 Payload 是如何绕过常规校验并在服务端触发代码执行逻辑的。\n\n【利用步骤】1. 部署受影响的容器环境：使用命令 `docker run -p 3000:3000 ghcr.io/l4rm4nd/cve-2025-55182` 启动漏洞靶场。2. 确认服务状态：访问本地 3000 端口，确保 Next.js 应用运行正常并开启了 App Router 功能。3. 配置攻击工具：克隆 AssetNote 的 scanner 仓库，并安装必要的 Python 依赖库。4. 执行漏洞探测：运行扫描脚本 `python3 scanner.py -u http://127.0.0.1:3000`，脚本会自动构造特制的 RSC 请求。5. 验证 RCE 结果：观察服务端响应或容器日志，确认 Payload 是否成功执行系统命令或建立反弹 Shell。\n\n【投毒风险分析】该 POC 项目的投毒风险评定为低（15%）。首先，代码结构极其透明，主要由标准的 Dockerfile、package.json 和 README 组成，没有发现经过混淆的二进制文件或加密的 shell 脚本。其次，项目引用的基础镜像为官方 `node:20-alpine`，这是一种业界公认的安全最小化镜像。项目的外部依赖仅限于官方 npm 仓库中的 React 和 Next.js 特定版本，未见引入来源不明的私有包。然而，风险点主要存在于两处：一是其推荐的外部扫描工具 `react2shell-scanner`，如果用户在未审查该第三方工具源码的情况下直接运行，可能存在工具侧投毒的风险；二是 Docker 镜像 `ghcr.io/l4rm4nd/cve-2025-55182` 是预构建好的镜像，虽然 Dockerfile 开源，但如果镜像构建过程中插入了非源码声明的恶意层，则会造成隐蔽投毒。综合来看，代码本身是安全的，但作为防御性研究员，建议通过本地 Docker build 重新构建镜像，而非直接拉取预构建镜像，以完全规避供应链风险。

**项目地址:** [https://github.com/l4rm4nd/cve-2025-55182](https://www.google.com/search?q=https://github.com/l4rm4nd/cve-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
