## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 关键

**CVSS评分:** 

**影响版本:** React Server Components: 19.0.0, 19.1.0, 19.1.1, 19.2.0 (包括 react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack);
Next.js: 16.0.6 (App Router);
React: 19.2.0;
React-DOM: 19.2.0

**利用条件:** 预认证 (pre-authentication)，需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

本概念验证 (PoC) 环境旨在演示和测试针对 React Server Components 和 Next.js 的关键远程代码执行 (RCE) 漏洞，即 React2Shell。此漏洞被追踪为 CVE-2025-55182，主要影响 React Server Components 19.0.0、19.1.0、19.1.1 和 19.2.0 版本，特别是 `react-server-dom-parcel`、`react-server-dom-turbopack` 和 `react-server-dom-webpack` 等包。其根本原因是 Server Function 端点在处理 HTTP 请求时，对负载进行了不安全的 deserialization。此外，CVE-2025-66478 记录了此漏洞对使用 App Router 的 Next.js 应用程序的下游影响。

本 PoC 环境通过 Dockerfile 创建了一个最小化的 Next.js 项目，其核心组件被故意降级至易受攻击的版本。具体而言，它固定了 `next: 16.0.6`、`react: 19.2.0` 和 `react-dom: 19.2.0`。这些版本配置结合了 Next.js 的 App Router 和 React Server Actions，为漏洞的触发创造了必要条件。PoC 的 `README.md` 文件明确声明其为“有意为之的脆弱设置”，并详细说明了如何部署和检测。

利用此 PoC 环境的步骤如下：
1.  **部署脆弱环境**: 用户可以通过运行 `docker run --rm -p 127.0.0.1:3000:3000 ghcr.io/l4rm4nd/cve-2025-55182:latest` 命令，快速启动一个易受攻击的 Next.js 应用实例。此命令从 GitHub Container Registry 拉取预构建的 Docker 镜像并在本地端口 3000 监听。
2.  **获取检测工具**: 克隆 AssetNote 提供的 `react2shell-scanner` 工具仓库：`git clone https://github.com/assetnote/react2shell-scanner && cd react2shell-scanner`。
3.  **安装扫描器依赖**: 在虚拟环境中安装所需的 Python 依赖：`virtualenv venv && source venv/bin/activate && pip install -r requirements.txt`。
4.  **执行漏洞扫描**: 运行扫描器针对已部署的脆弱目标：`python3 scanner.py -u http://127.0.0.1:3000`。
5.  **验证结果**: 扫描器将检测目标应用程序是否存在 React2Shell 漏洞。若漏洞存在，扫描器会报告成功，确认了 RCE 漏洞的有效性和可利用性。
整个过程简单直接，清晰地展示了漏洞的存在和检测方式，证实了 PoC 的高度有效性。

基于对所提供的 PoC 代码、其运行环境以及相关文档的全面分析，本 PoC 的投毒风险被评估为极低，定为 10%。这一评估主要基于以下几个关键因素：

首先，**透明度和明确声明**是降低投毒风险的核心。`README.md` 文件明确且醒目地警告用户：“此设置是故意易受攻击的，绝不能暴露在公共互联网上或用于生产环境。”这种清晰的免责声明和使用指导，表明了 PoC 的设计初衷是用于合法的安全研究、测试和教育，而非隐藏恶意意图。

其次，**代码内容的透明性**极高。所提供的 `Dockerfile` 和 `Dockerfile.bk` 文件内容简单明了，没有进行任何代码混淆、加密或使用难以理解的技巧。它们仅仅展示了构建一个标准 Node.js/Next.js 应用程序的常规步骤，其中最关键的“脆弱性”在于显式地安装了已知存在漏洞的特定版本 `next` (16.0.6)、`react` (19.2.0) 和 `react-dom` (19.2.0)。这些依赖版本都是公开可查的，并非特制或植入后门的版本。构建过程中，应用程序的文件（`package.json`, `next.config.mjs`, `app`, `server.js`）被直接复制到 Docker 镜像中，没有引入外部的、不可信的二进制文件或脚本。

再者，**依赖来源和工具的可靠性**进一步巩固了低风险评估。基础 Docker 镜像 `node:20-alpine` 是 Docker Hub 上官方且受信任的 Node.js 镜像。用于运行漏洞环境的 Docker 镜像 `ghcr.io/l4rm4nd/cve-2025-55182:latest` 托管在 GitHub Container Registry，其作者 `l4rm4nd` 在安全社区内以其研究工作而闻名。此外，推荐用于检测漏洞的扫描器 `react2shell-scanner` 由知名网络安全公司 AssetNote 开发并维护在其官方 GitHub 仓库中。这些来源的声誉和透明度表明，整个生态系统都建立在受信任的基础之上。

最后，**行为分析**没有发现任何可疑迹象。PoC 应用程序的构建和运行命令（`npm install`, `npm run build`, `node server.js`, `npm run start`）都是标准 Node.js/Next.js 开发流程的一部分。应用程序没有尝试连接到未知外部服务器、下载额外的恶意载荷、修改系统关键配置、执行加密货币挖矿或其他任何与预期安全研究目的不符的行为。它仅仅是一个静态的、易受攻击的 Next.js 应用，等待外部扫描器或攻击者通过其预期的漏洞路径进行交互。

综上所述，此 PoC 完全符合合法安全研究工具的特征。用户只需严格遵循 `README.md` 中关于不将环境暴露给公共网络的警告，即可安全地使用此 PoC 进行漏洞学习和防御测试，无需担忧潜在的投毒风险。

**项目地址:** https://github.com/assetnote/react2shell-scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
