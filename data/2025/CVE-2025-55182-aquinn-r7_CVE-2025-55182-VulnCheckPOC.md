## CVE-2025-55182 - React Server Components (RSC) in Next.js 反序列化RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 反序列化RCE

**影响应用:** React Server Components (RSC) in Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** 未经身份验证的网络访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个存在于React Server Components (RSC) 中的严重反序列化漏洞，特别影响使用Next.js框架的应用程序。该漏洞允许未经身份验证的远程攻击者执行任意代码。根据搜索结果和提供的POC代码，该漏洞的利用依赖于向目标服务器发送特制的HTTP POST请求，该请求包含恶意的序列化数据。当服务器尝试反序列化这些数据时，攻击者可以控制服务器的行为，最终导致远程代码执行(RCE)。

POC代码`reactServerComponentsCheck.py`通过构造特定的HTTP请求来验证漏洞是否存在。该脚本发送包含特制的`Next-Router-State-Tree`和`Content-Disposition`头的POST请求。如果服务器返回包含`E{"digest`字符串的500错误响应，则表明服务器存在漏洞。该POC的有效性在于它模拟了攻击者可能使用的恶意请求，并验证了服务器是否容易受到反序列化攻击。使用方法是指定目标文件，脚本会发送请求，并检查返回的内容中是否存在特征字符串。如果目标返回包含 "E{\"digest" 的500错误，则被标记为 vulnerable。POC 可以有效识别出存在漏洞的服务器。

**利用步骤：**
1. 确定目标Next.js应用程序。
2. 运行提供的python脚本, `python3 script.py <targets_file>`，其中targets_file包含目标服务器列表。
3. 脚本将向目标服务器发送特制的HTTP POST请求。
4. 检查响应状态代码和响应内容。如果状态代码为500，并且响应内容包含字符串`E{"digest`，则目标服务器容易受到攻击。
5. 如果确认存在漏洞，攻击者可以进一步构造恶意序列化数据，以执行任意代码。这一步需要更深入的理解React Server Components的内部工作原理以及目标服务器上可用的类和方法。

**投毒风险分析：**
该POC的主要目的是检测漏洞，而不是利用它执行恶意操作。代码相对清晰，只使用了标准的Python库（requests, urllib）。该脚本本身并没有包含任何明显的恶意代码，例如混淆的代码、下载或执行外部脚本的行为。但是，任何POC都存在被滥用的风险。攻击者可能会修改此POC，使其不仅检测漏洞，还尝试利用它来安装后门或执行其他恶意操作。此外，如果该POC被托管在公共代码仓库中，并且没有采取适当的安全措施，则可能会受到供应链攻击，攻击者可能会将恶意代码注入到POC中，然后分发给不知情的用户。由于其功能是发送特制的HTTP请求以触发服务器端错误，其投毒风险较低，大约为10%。使用者需要注意验证脚本的来源，并避免使用来自不受信任来源的POC代码，以降低风险。

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
