## CVE-2025-30208 - Vite 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Vite

**危害等级:** 中危 (High Severity in some contexts)

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**影响版本:** Vite < 6.2.3, 6.1.2, 6.0.12, 5.4.15

**利用条件:** 需要访问Vite开发服务器（Dev Server），通常在开发环境或配置不当的生产预览中触发。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：提供的Python脚本（Vite-CVE-2025-30208-ReadAnyFile.py）是一个高度工程化的自动化利用工具。该脚本逻辑清晰，使用了requests、concurrent.futures和threading等库实现多线程并发扫描。其核心攻击向量通过构造特殊的查询参数（如 ?import&raw??）来绕过Vite开发服务器对 /@fs/ 路径的安全限制。在Vite的设计中，/@fs/ 旨在提供文件系统访问，但应受路径安全策略限制。此POC通过向请求末尾添加双问号（??）干扰了服务器对路径和查询字符串的解析逻辑，使得路径验证失效。脚本具备批量扫描、自定义Payload、代理支持以及生成Excel格式报告的功能。经分析，其Payload构造逻辑符合公开披露的漏洞细节，能够有效读取Linux系统下的 /etc/passwd 或Windows系统下的 win.ini 等敏感文件。利用步骤：1. 确认目标环境运行着受影响版本的Vite开发服务器。2. 使用 python vite_check.py -u [目标URL] 发起单个检测，或使用 -f 参数导入目标列表。3. 通过 -p 参数指定特定的文件路径，例如 /@fs/etc/passwd?import&raw??。4. 脚本将发送构造好的HTTP GET请求到目标服务器。5. 服务器解析异常导致路径遍历，返回敏感文件内容。6. 脚本捕获响应并验证是否存在预期的关键词（如 root:x:0:0），最后将结果记录到 output 报告中。投毒风险分析：该脚本展示了极低的投毒风险（约为10%）。代码逻辑完全透明，主要依赖Python标准库和常用的第三方库（requests, openpyxl），没有发现代码混淆、Base64编码的恶意载荷执行或不寻常的远程网络连接。脚本中的 threading.Lock() 和 concurrent.futures 处理方式符合标准的多线程编程规范。虽然脚本引用了外部Excel处理库 openpyxl，但这属于正常的数据导出功能。唯一需要关注的是其导入的 urllib3 禁用了不安全请求警告，这在安全工具中是常见做法，不属于恶意行为。脚本未包含任何自动安装后门、窃取本地环境变量或上传敏感凭据到第三方服务器的代码。该工具纯粹用于合法的漏洞验证与资产普查，属于典型的防御性安全研究代码。使用者在使用过程中应确保 openpyxl 库是从官方 PyPI 源安装，以避免供应链攻击。整体来看，该POC是一个高质量、干净且可控的安全研究脚本。

**项目地址:** [https://newskysecurity.com/cve-2025-30208/](https://newskysecurity.com/cve-2025-30208/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
