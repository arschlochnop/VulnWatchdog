# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

## CVE-2025-6018 PAM 本地权限提升漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** PAM (Pluggable Authentication Modules)

**危害等级:** 高危，攻击者可利用此漏洞获得系统完全控制权限

**影响版本:** PAM 1.3.0 - 1.6.0 (受影响版本)

**利用条件:** 需要本地用户权限，可以通过SSH等方式登录系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6018 是一个 PAM (Pluggable Authentication Modules) 中的本地权限提升漏洞。该漏洞允许一个非特权本地攻击者获得通常保留给物理存在的 "allow_active" 用户的提升权限。根据搜索结果，此漏洞与 CVE-2025-6019 常常被链接在一起利用，可以获得 root 权限。漏洞存在于pam-config中。

**有效性评估：**
提供的 POC 代码是一个 Python 脚本，它利用了 PAM 的 `pam_env.so` 模块中的一个环境变量注入漏洞。攻击者通过在 `~/.pam_environment` 文件中注入恶意环境变量，可以操纵 SystemD 会话，最终提升权限。

脚本包含以下步骤：
1.  **漏洞检测：** 脚本首先尝试检测目标系统上 PAM 的版本以及 `pam_env.so` 和 `pam_systemd.so` 是否被配置使用。它检查 `rpm -q pam` 或 `dpkg -l | grep libpam`的输出，寻找易受攻击的版本字符串，然后尝试使用 find 命令和 grep 命令查找包含'pam_env'和'pam_systemd'的文件。
2.  **恶意环境创建：** 如果系统被判断为易受攻击，脚本会创建一个恶意的 `~/.pam_environment` 文件，其中包含覆盖 XDG 和 SYSTEMD 环境变量的 payload。
3.  **权限提升测试：** 脚本尝试使用 `gdbus call` 命令来触发权限提升，例如尝试重启系统。

根据漏洞库信息和搜索结果，此漏洞是真实存在的，且多个来源表明存在可利用的 PoC 代码。

**投毒风险评估：**
阅读给出的 POC 脚本`CVE-2025-6018.py` ，发现此脚本的logger记录了详细的操作步骤以及相关命令，这些日志信息会写入到`cve_2025_6018_exploit.log`文件中。由于脚本使用了标准库paramiko进行SSH连接，没有发现直接执行恶意代码或者下载恶意文件的代码。该脚本主要目的是通过环境变量注入来利用漏洞，相对比较透明。

但是，任何 PoC 代码都存在一定的风险，例如：
*   **意外的副作用：** 即使 PoC 代码的目的是提权，但错误的使用方式可能会导致系统不稳定或其他问题。
*   **代码作者的恶意行为：** 尽管代码本身看起来是良性的，但作者可能在其他地方隐藏了恶意代码。虽然该脚本没有发现明显的恶意行为，但不能完全排除作者通过其他方式（例如，使用混淆的代码或利用未知的漏洞）来植入后门的可能。
考虑到以上风险，这里给出10%的投毒风险评估。

**利用方式：**
1.  **SSH 登录：** 攻击者需要具有目标系统的 SSH 登录凭据（用户名和密码）。
2.  **执行 PoC 脚本：** 攻击者将 PoC 脚本上传到目标系统，并使用 Python 解释器执行它。
3.  **权限提升：** 脚本会检测系统是否易受攻击，然后创建一个恶意的 `~/.pam_environment` 文件。当下一次用户登录或启动新会话时，PAM 会读取这个文件，设置被篡改的环境变量，从而允许攻击者执行特权操作。

总而言之，该漏洞是一个严重的安全问题，可被攻击者利用来获得受影响系统的完全控制权限。系统管理员应尽快应用补丁。

**项目地址:** [ibrahmsql/CVE-2025-6018](https://github.com/ibrahmsql/CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---



---



---



---



---



---



---



---



---



---



---

