# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #3

**来源**: [CVE-2025-6018-ibrahmsql_CVE-2025-6018.md](../2025/CVE-2025-6018-ibrahmsql_CVE-2025-6018.md)

# CVE-2025-6018

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md](../2025/CVE-2025-6018-B1ack4sh_Blackash-CVE-2025-6018.md)

## CVE-2025-6018 Pam-config 本地提权漏洞

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权 (LPE)

**影响应用:** pam-config (Linux PAM)

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** < 1.1.8-24.71.1 (可能影响其他未打补丁的Linux发行版)

**利用条件:** 需要本地用户权限（例如通过SSH登录）和可写的~/.pam_environment文件，且PAM配置存在缺陷（pam_env.so在pam_systemd.so之前）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6018 是一个 Linux PAM 中的本地提权漏洞。未经授权的本地攻击者可以获得通常为物理存在的 "allow_active" 用户保留的提升权限。利用方式如下：

1.  **漏洞原理：**`pam_env.so` 模块允许用户通过 `~/.pam_environment` 文件设置环境变量。如果 `pam_env.so` 在 PAM 堆栈中位于 `pam_systemd.so` 之前（例如在 `/etc/pam.d/sshd` 中），用户可以在系统确定会话类型之前注入环境变量。
2.  **利用步骤：**
    *   攻击者通过 SSH 等方式获得本地用户权限。
    *   攻击者创建一个包含以下内容 `~/.pam_environment` 文件：
    ```
    XDG_SEAT=seat0
XDG_VTNR=1
    ```
    *   这些变量欺骗系统，使其认为用户是活动的桌面会话用户。
    *   因此，Polkit 将用户视为 "local active user"，并通过 `allow_active=yes` 授予提升的权限。
3. **结合CVE-2025-6019提权至ROOT:**
    *   获取 `allow_active` 权限后，攻击者可以结合 CVE-2025-6019 (udisks2/libblockdev 中的另一个 LPE) 进一步提升至 root 权限。
    *   攻击者使用 `allow_active` 权限挂载恶意磁盘镜像。
    *   由于不安全的挂载选项，他们可以执行 SUID 二进制文件或类似的 payload。
    *   这最终导致完整的 root shell 访问。
4. **缓解措施:**
    *  更新PAM、pam-config、udisks2 和 libblockdev
    *  PAM配置修复：将`pam_env.so`移动到`/etc/pam.d/sshd` 和类似文件中的`pam_systemd.so`之后。或者禁用 `user_readenv=1` 以防止读取用户环境变量文件。
    *  Polkit策略加固：更改默认 `allow_active` 操作（如磁盘挂载）以需要 `auth_admin`。根据需要修改 `/etc/polkit-1/rules.d/`。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-6018](https://github.com/B1ack4sh/Blackash-CVE-2025-6018)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---

## POC #2

**来源**: [CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md](../2025/CVE-2025-6018-iamgithubber_CVE-2025-6018-19-exploit.md)

## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)

---



---



---



---

