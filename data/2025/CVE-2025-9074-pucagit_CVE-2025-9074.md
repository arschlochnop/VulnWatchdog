## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop ≤ 4.44.3 (Windows and macOS)

**利用条件:** 需要本地运行恶意容器，无需认证即可访问Docker Engine API

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074 是一个影响 Docker Desktop（Windows 和 macOS 版本）的严重容器逃逸漏洞。该漏洞的核心在于，在 Docker Desktop 的默认配置下，本地运行的恶意 Linux 容器能够绕过隔离机制，无需任何认证即可直接访问宿主机上的 Docker Engine API。该 API 接口通常监听在默认子网的特定端口（例如 192.168.65.7:2375）。
提供的 POC 代码清晰有效地验证了这一漏洞。其工作原理如下：攻击者首先在一个受影响的 Docker Desktop 环境中启动一个任意的容器（例如一个 `alpine` 容器）。然后，通过在该容器内部执行一系列 `wget` 命令，直接向宿主机的 Docker Engine API 发送 HTTP 请求。第一个关键请求是向 `/containers/create` 端点发送 POST 请求，指令 Docker Engine 创建一个新的容器。这个新的容器被巧妙地配置为挂载宿主机的敏感目录（例如 `C:\` 目录）到其内部文件系统的一个指定路径（例如 `/host_root`）。同时，该新容器的启动命令被设置为执行恶意操作，例如向宿主机挂载的目录中写入一个文件（`echo pwned > /host_root/test/pwn.txt`）。随后，另一个 POST 请求会启动这个恶意创建的容器，从而导致宿主机文件系统被写入。为了进一步证明攻击的全面性，POC 还展示了如何通过向 `/containers/$cid/archive` 端点发送 GET 请求来从宿主机上读取文件，例如获取 `C:\test` 目录的内容并解压查看。
这个 POC 代码的有效性极高，它不仅演示了通过非授权 API 访问实现容器逃逸的完整链条，还具体展示了攻击者如何获得宿主机的文件系统读写权限。这种直接利用 Docker 自身 API 的方式使得漏洞的利用逻辑清晰且可靠。其限制在于攻击者需具备在目标系统上运行容器的能力，但一旦满足此条件，攻击者便能完全突破容器沙箱的限制。

**利用步骤：**
1. 在 Windows 宿主机上创建测试目录（例如 `C:\test`）并放置一个示例文件。
2. 启动一个任意的 Linux 容器（例如 `alpine`），并在容器内执行命令：
   - 通过 HTTP POST 请求向 `http://192.168.65.7:2375/containers/create` 创建一个新容器，该容器配置为将宿主机 `C:\` 目录挂载到其 `/host_root`，并执行写入操作（`echo pwned > /host_root/test/pwn.txt`）。
   - 提取新创建容器的 ID。
   - 通过 HTTP POST 请求向 `http://192.168.65.7:2375/containers/$cid/start` 启动该容器。
3. 从初始容器内通过 HTTP GET 请求向 `http://192.168.65.7:2375/containers/$cid/archive?path=/host_root/test` 获取包含宿主机 `C:\test` 目录内容的压缩包，并解压验证文件读取。

**投毒风险分析：**
针对所提供的 CVE-2025-9074 POC 代码，其投毒风险评估为低。原因如下：首先，POC 代码清晰、透明，主要由标准 `wget` 命令构成，用于向 Docker 内部 API 发送 HTTP 请求。这些请求的目标 IP (192.168.65.7) 和端口 (2375) 是 Docker Desktop 内部通信所使用的默认地址，而非外部恶意服务器。其次，代码的逻辑旨在直接、明确地演示漏洞的利用过程，即通过在容器内调用 Docker Engine API 来创建并控制其他容器，进而实现宿主机文件系统的读写。代码中没有发现任何混淆、加密、引入外部恶意脚本、或尝试建立持久性后门的行为。此外，POC 的 `README.md` 文件明确声明其为“教育和研究目的”，并强调“不包含武器化利用代码”，也“不承担滥用责任”，这进一步印证了其作为安全研究成果的合法性与非恶意性。因此，尽管该漏洞本身具有高危影响，但这份特定的 POC 代码旨在帮助防御者理解漏洞机制和进行安全测试，而非进行恶意攻击。组织在分析此类 POC 时，应重点关注漏洞本身带来的风险和修复措施，而不是对 POC 代码本身产生投毒疑虑。

**项目地址:** N/A

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-9074
