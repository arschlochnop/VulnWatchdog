## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop ≤ 4.44.3 on Windows and macOS

**利用条件:** 本地运行的恶意容器；需要Docker Engine HTTP API在默认子网(192.168.65.7:2375)可达；需要用户对目标挂载文件夹有相应权限

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker Desktop（Windows和macOS版本）的严重容器越权访问漏洞，CVSS评分为9.3。该漏洞允许本地运行的恶意Linux容器绕过隔离机制，通过默认子网（192.168.65.7:2375）直接访问主机上的Docker Engine API。攻击者可利用此缺陷创建带有主机卷挂载的新容器，从而获得对主机文件系统的读写权限，最终实现主机接管。此漏洞已在Docker Desktop 4.44.3版本中修复。

**POC有效性分析：**
提供的PoC（概念验证）代码功能完整且文档详尽，清晰地演示了CVE-2025-9074的攻击链。其有效性体现在：
1.  **直接访问Docker Engine API：** PoC利用`wget`命令向`http://192.168.65.7:2375/containers/create`发送POST请求，证实了恶意容器无需认证即可访问本地Docker Engine API。
2.  **创建带主机卷的新容器：** PoC通过构造JSON载荷，成功将主机的C盘（或macOS根目录）挂载到新容器的`/host_root`，证明了突破容器隔离、任意挂载主机目录的能力。
3.  **读写主机文件系统：** PoC在新容器中执行命令，在主机`C:\test`目录下成功创建`pwn.txt`文件，并随后通过`wget`请求容器归档的方式读取了主机的`readme.txt`文件，完整演示了对主机文件系统的读写权限获取。
4.  **清晰的复现步骤与预期结果：** PoC提供了详细的步骤、命令示例及截图，使得复现过程直观可靠。
该PoC的高度实用性和可靠性，使其成为理解和验证此漏洞的优秀工具。

**利用步骤：**
1.  **环境准备：** 在Windows主机上创建`C:\test`文件夹（含`readme.txt`），并确保Docker Desktop版本≤4.44.3。
2.  **启动基础容器：** 运行`docker run -it alpine '/bin/sh'`进入一个基础Alpine容器。
3.  **创建并启动攻击容器（写入）：** 在基础容器内执行`wget`命令，向Docker Engine API发送POST请求，创建一个将主机C盘挂载到`/host_root`的新容器，并在其启动时写入`pwned > /host_root/test/pwn.txt`。之后，提取容器ID并再次使用`wget`命令启动该容器。此时，主机`C:\test\pwn.txt`文件应已生成。
4.  **读取主机文件：** 继续在基础容器内，使用`wget`命令从Docker Engine API请求`containers/$cid/archive?path=/host_root/test`的归档。解压`test.tar`文件后，即可查看并读取主机`C:\test`目录下的文件，例如`readme.txt`。

**投毒风险分析：**
对该PoC代码本身的投毒风险评估为**低（10%）**。
1.  **代码透明且无混淆：** PoC代码完全开源可见，逻辑清晰，不含任何代码混淆或加密，易于审查。
2.  **依赖标准工具：** PoC仅使用操作系统自带的`wget`和`tar`命令以及Docker环境，未引入任何外部不可信的第三方可执行文件或脚本。
3.  **行为可控且可预测：** PoC的所有操作均围绕演示漏洞原理展开，即通过HTTP请求与本地Docker Engine API交互，实现容器创建、主机挂载和文件操作。其行为与漏洞描述高度一致，未发现超出此范围的恶意行为（如下载病毒、植入后门等）。
4.  **明确的免责声明：** `README.md`明确指出PoC“仅用于教育和研究目的”，且“不包含武器化的利用代码”，表明其旨在安全研究而非恶意传播。
虽然PoC代码本身无害，但它所演示的漏洞具有极高的危害性，攻击者一旦掌握此技术，可以轻易突破容器隔离并完全控制主机系统。因此，尽管PoC代码是安全的演示，用户仍应将此漏洞的威胁等级视为严重，并立即升级Docker Desktop至安全版本（≥4.44.3）以进行防护。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-9074
