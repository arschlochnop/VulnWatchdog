## CVE-2025-9074 - Docker Desktop 容器越权访问/逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问/逃逸

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop <= 4.44.3 (Windows和macOS版本)

**利用条件:** 本地运行恶意容器，无需认证，API端口可达

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074是一个影响Docker Desktop的容器越权访问/逃逸漏洞，它允许本地运行的恶意Linux容器突破Docker的隔离机制，直接访问宿主机文件系统。该漏洞的严重评分为9.3（满分10分），影响Windows和macOS版本的Docker Desktop，已于2025年8月20日在Docker Desktop 4.44.3及更高版本中修复。

**POC有效性分析：**
核心问题在于Docker Desktop内部的HTTP API（位于http://192.168.65.7:2375）在受影响版本中未正确配置访问控制，导致容器可以无认证地访问此API。此API可以被用于创建新的Docker容器，攻击者可以利用`HostConfig.Binds`参数，将宿主机的任意路径（如`C:\`或`/`）挂载到新创建容器的内部路径。一旦宿主机目录被挂载到容器中，攻击者就获得了对宿主机文件系统的读写权限，从而实现了容器逃逸。

提供的PoC代码清晰地演示了这一过程：
1.  **准备环境：** 首先，在Windows或macOS宿主机上创建一个测试目录（例如`C:\test`）并放置一个示例文件（如`readme.txt`）。
2.  **创建和启动恶意容器：** 从一个已经运行的Alpine容器内部，通过`wget`向`http://192.168.65.7:2375/containers/create`发送POST请求。请求体中指定创建一个新的Alpine容器，并利用`HostConfig":{"Binds":["/mnt/host/c:/host_root"]}`将宿主机的C盘根目录挂载到新容器的`/host_root`路径。新容器启动时执行`echo pwned > /host_root/test/pwn.txt`命令，目的是在宿主机`C:\test`目录下创建一个名为`pwn.txt`的文件。随后，PoC解析返回的容器ID并发送`POST`请求到`/containers/$cid/start`来启动新容器。
3.  **验证读写能力：** PoC通过检查宿主机`C:\test`目录下是否成功生成了`pwn.txt`文件来验证写入操作的有效性。为了验证读取能力，PoC通过`wget`向`http://192.168.65.7:2375/containers/$cid/archive?path=/host_root/test`发送GET请求，获取宿主机`C:\test`目录内容的压缩包，并解压`test.tar`以显示`readme.txt`的内容。

实验结果与预期一致，成功在宿主机上创建和读取文件，充分验证了该漏洞的有效性和PoC代码的准确性。PoC的步骤和输出都非常清晰，易于复现和理解。

**利用步骤：**
利用此漏洞需要攻击者能够在一个Docker Desktop环境中运行一个恶意或受控的Linux容器。攻击复杂度较低。
1.  **获取初始容器访问权限：** 攻击者需要设法在目标Docker Desktop环境中运行一个容器。这可能是通过诱骗用户运行恶意镜像，或利用其他漏洞获取在容器内执行命令的权限。
2.  **通过容器内部访问Docker Engine API：** 在恶意容器内部，攻击者向`http://192.168.65.7:2375`发起HTTP请求，这是Docker Desktop内部未受保护的API端点。
3.  **创建并启动带有宿主机卷挂载的新容器：** 攻击者构造一个JSON请求体，通过API创建一个新的容器，并在请求中恶意地指定`HostConfig.Binds`参数，将宿主机的根目录或其他敏感目录（例如`C:/`或`/`）挂载到新容器的某个路径（如`/host_root`）。
4.  **在宿主机上执行操作：** 新容器启动后，其内可执行的命令（例如`Cmd`参数中指定）将能在宿主机挂载的卷上进行读写操作，从而实现文件篡改、数据窃取、植入后门等恶意行为，达到完全的容器逃逸和宿主机接管。

**投毒风险分析：**
对提供的PoC代码进行严格审查后，评估其投毒风险为极低，具体评分约为5%。该PoC代码的核心构成是明确的Shell命令，主要利用`wget`工具向本地Docker Engine API发送HTTP请求，以及使用`tar`解压验证结果。代码逻辑简洁明了，没有发现任何明显的恶意行为、混淆技术、外部依赖或隐藏功能。

1.  **透明性与可审查性：** PoC代码直接以文本形式嵌入在README文件中，其内容是可见且易于理解的。攻击者无法在其中隐藏复杂的恶意逻辑或引入额外的恶意组件，因为任何异常的`wget`目标（非本地IP）或额外的`Cmd`参数都会立刻被安全研究人员识别。
2.  **无外部资源加载：** 代码中所有的网络请求都指向本地IP地址`192.168.65.7:2375`，这是Docker Desktop内部API的默认地址。PoC不尝试从外部网站下载任何二进制文件、脚本或配置，这大大降低了引入供应链攻击或通过第三方托管恶意代码的风险。
3.  **无混淆或加密：** 代码没有任何形式的混淆、加密或打包，因此其执行意图一目了然。这与高风险的恶意PoC形成鲜明对比，后者通常会使用这些技术来规避检测。
4.  **目的局限性：** 该PoC的明确目的是“概念验证”，旨在安全地演示漏洞的存在和可利用性，而非进行武器化的攻击。它所执行的操作，如在宿主机上创建`pwn.txt`文件或读取`readme.txt`，都是为了直观地展示容器逃逸的效果，而非真正的数据破坏或窃取。
5.  **明确的免责声明：** PoC的作者在README中明确指出“本PoC仅用于教育和研究目的”，并“不承担滥用责任”。虽然免责声明本身不能完全排除风险，但结合代码内容和其透明性，可以推断其发布者的意图是良性的，旨在促进安全社区对漏洞的理解和防御。

尽管PoC本身不含投毒，但如果用户在生产环境或未受控的系统中运行此PoC，或者在其基础上进一步开发恶意载荷，那么可能导致宿主机敏感数据泄露或被篡改。然而，这种风险源于漏洞本身的严重性以及用户对PoC的不当使用，而非PoC代码自身的恶意属性。综上所述，此PoC在结构、内容和意图上均表现出高度的透明性和非恶意性，因此其投毒风险可以视为极低。建议防御方在复现时仍应在隔离环境中进行，并维持对所有代码的审查习惯。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-9074
