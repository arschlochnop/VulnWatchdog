## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸 / 未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 / 未授权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop <= 4.44.3

**利用条件:** 攻击者需在本地运行的 Linux 容器中执行恶意代码，且 Docker Desktop 处于运行状态。

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码非常完整且具有极高的实操性。它直接利用了Docker Desktop在Windows和macOS平台上默认子网（192.168.65.7:2375）缺乏认证机制的缺陷。代码通过简单的HTTP请求（wget）与宿主机的Docker Engine API交互，展示了如何通过创建一个挂载了宿主机根目录（如/mnt/host/c）的新容器来实现逃逸。POC中清晰地展示了从创建容器、注入恶意指令（echo pwned）、启动容器到最后通过API获取宿主机文件归档的完整链路。由于该API在漏洞版本中默认监听并信任来自容器子网的流量，此攻击方式无需任何凭据即可生效，验证了漏洞的严重性。该POC不仅能证明文件读写权限，还间接证明了攻击者可以获取宿主机的高级控制权，是研究容器逃逸防御的极佳样本。【利用步骤】1. 在受影响的Docker Desktop环境下启动一个基础Linux容器（如Alpine）。2. 在容器内部，利用wget向192.168.65.7:2375发送POST请求，调用/containers/create接口，并在JSON payload中配置HostConfig/Binds，将宿主机磁盘挂载到新容器。3. 解析返回的JSON获取新容器ID。4. 发送POST请求到/containers/{id}/start启动该容器，执行预设的宿主机写操作。5. 利用/containers/{id}/archive接口通过GET请求读取宿主机敏感文件。【投毒风险分析】经过对提供的POC代码进行深度静态扫描，未发现混淆代码、外部恶意域名连接或异常的二进制Payload。代码逻辑完全基于标准的Docker API调用和常用的Linux工具（wget, cut, tar），行为透明。PoC README中明确标注了引用来源（Felix Boulet）和免责声明，符合安全研究规范。该POC通过写入 'pwned' 字符串至测试文件夹而非敏感系统目录，体现了其非破坏性的验证意图。投毒风险极低，仅5%，这部分风险主要来自于此类高危漏洞POC在分发过程中可能被第三方二次修改植入反弹Shell，但就原始POC本身而言是安全的。防御者在使用时应确保在隔离的沙箱环境中运行，并直接从可信源获取此类脚本，避免从非官方仓库下载已经过编译的二进制利用程序。

**项目地址:** [https://blog.qwertysecurity.com/Articles/blog3.html](https://blog.qwertysecurity.com/Articles/blog3.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
