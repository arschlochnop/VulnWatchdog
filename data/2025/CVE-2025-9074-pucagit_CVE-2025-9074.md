## CVE-2025-9074 - Docker Desktop (Windows & macOS) 权限提升/容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 权限提升/容器逃逸/未授权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop <= 4.44.3

**利用条件:** 攻击者需在受影响的宿主机上运行一个恶意的 Linux 容器；无需身份验证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC展现了极高的有效性与可操作性。漏洞核心在于Docker Desktop在Windows和macOS环境下的内部网络隔离机制存在缺陷。在默认配置下，Docker Desktop会在宿主机上开启一个特定的API接口（192.168.65.7:2375），该接口是Docker Engine API的监听地址。正常情况下，容器应被限制访问宿主机的管理接口，但CVE-2025-9074允许运行在Linux容器内的进程通过默认子网直接访问该API，且无需任何身份验证。通过分析POC代码可知，攻击者只需使用简单的HTTP客户端工具（如wget或curl），向该API发送精心构造的JSON请求即可创建新容器。此POC的关键在于利用了Docker API的容器创建功能，通过'HostConfig'中的'Binds'参数，将宿主机的根目录（如C:\驱动器）直接挂载到新创建的容器中。由于该API具有最高管理权限，攻击者不仅可以实现对宿主机文件系统的任意读写，还能通过控制容器生命周期实现完全的宿主机接管。此漏洞利用流程简洁、逻辑严密，直接利用了Docker的原生API设计特性，几乎没有环境依赖，验证成功率极高。【利用步骤】1. 在受害宿主机上启动一个基础Linux容器（如alpine）；2. 在容器内部使用wget向192.168.65.7:2375/containers/create发送POST请求，请求体中定义一个新镜像，并将宿主机路径（/mnt/host/c）挂载至容器内部路径（/host_root）；3. 从API返回的JSON中提取新生成的容器ID（cid）；4. 再次向API发送POST请求启动该cid对应的容器；5. 此时新容器已在后台运行并执行了恶意指令（如在宿主机写入文件）；6. 若需获取数据，可通过API的archive接口直接读取挂载点下的宿主机敏感文件。【投毒风险分析】当前POC代码表现出极高的透明度和教育属性，属于典型的防御性研究代码，其投毒风险处于低水平（约15%）。代码中使用的工具均为系统自带的wget、cut、tar等标准二进制文件，不包含任何经过混淆的Base64字符、外部加密脚本加载或反射式注入行为。PoC的操作逻辑完全公开，每一个步骤都有对应的解释说明。分析过程中未发现恶意后连（C2）行为，其写入的文件名如'pwn.txt'和'readme.txt'均符合安全通告中的演示规范。然而，由于该漏洞的利用门槛极低且破坏力巨大，该POC极易被恶意攻击者稍加修改后封装进自动化的恶意镜像或投毒包中。风险点主要在于：如果该代码被集成到不透明的脚本工具或看似无害的GitHub仓库中，用户在不知情的情况下运行，可能会被利用进行宿主机扫描或凭据窃取。作为威胁情报研究员，建议关注任何尝试连接192.168.65.7地址的容器流量，并重点审计容器创建请求中的挂载配置。

**项目地址:** [https://blog.qwertysecurity.com/Articles/blog3.html](https://blog.qwertysecurity.com/Articles/blog3.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
