## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** 7.12 及以下版本

**利用条件:** 用户通过 WinRAR 打开或解压由攻击者构造的特制 RAR 压缩文件。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC工具展示了针对CVE-2025-8088的高效利用能力。漏洞核心源于WinRAR在处理RAR压缩包内文件名时，未能对Windows NTFS备用数据流（ADS）和特殊的路径遍历序列进行严格校验。分析POC代码可知，该工具通过Python脚本自动化构造恶意RAR文件。它不仅利用了传统的路径遍历符号，更结合了ADS特性（如filename::$DATA），成功绕过了WinRAR的文件名验证机制。POC中的逻辑展示了如何修补RAR头部结构以注入非法路径，并自动重新计算CRC校验值以确保压缩包在WinRAR中不报错。此利用链非常成熟，攻击者能够将载荷精准投放至用户的启动目录（Startup），实现持久化执行。从代码层面看，其配置项允许自定义诱饵文件、目标投放路径和Payload内容，具备极高的实战化水平和极低的利用门槛。该漏洞在2025年已被观测到由RomCom组织用于实战攻击，证明了该漏洞在对抗环境下的高稳定性。利用步骤：1. 配置config.py，设定诱饵文件名（如document）、Payload执行逻辑及目标解压路径（默认为Windows启动文件夹）。2. 准备Payload文件（如bat或exe）。3. 运行main.py脚本，脚本将读取配置并生成伪造的RAR文件。4. 诱导受害者使用存在漏洞的WinRAR版本打开或解压该文件。5. 恶意文件被静默释放至启动目录，受害者下次登录时载荷自动执行。投毒风险分析：该POC库虽然包含合法的防御性研究目的，但存在一定的投毒风险点。首先，代码逻辑中包含对外部文件的读取和复杂的二进制流操作，攻击者可能通过修改脚本逻辑，在生成恶意压缩包的同时，在研究员本地环境执行额外的恶意操作。其次，提供的extract.py（虽部分截断）中出现了socket和asyncio等网络通信模块，以及load_keys这类读取本地敏感信息的函数命名，这在纯粹的RAR生成器中显得有些冗余和可疑，不能排除其在后台悄悄收集运行该脚本的用户信息并回传至攻击者控制端的可能性。虽然目前的POC代码主要侧重于生成逻辑，但研究人员在使用时应保持高度警惕，建议在物理隔离的沙箱环境运行，并重点审计网络通信和文件系统写入逻辑，以防POC本身成为针对安全研究员的特洛伊木马。总体投毒风险评估为低到中等（15%），主要来自于此类高价值漏洞利用工具常被作为社会工程学攻击的载体。

**项目地址:** [https://github.com/walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
