## CVE-2025-8088 - WinRAR 路径遍历 / 目录穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 目录穿越 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户需要使用受影响版本的WinRAR打开并解压攻击者构造的恶意RAR压缩包文件。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC项目是一个针对CVE-2025-8088漏洞的自动化构造工具，其有效性较高。该漏洞源于WinRAR在处理压缩包文件路径时，未能正确过滤NTFS备用数据流（ADS）和特定的路径遍历序列。攻击者通过在RAR文件头中注入带有“..\”序列的路径，并结合NTFS ADS特性，可以强制WinRAR将文件提取到预定义的目标路径之外。根据POC代码分析，该脚本通过操作RAR文件的底层块结构（Header Patches），绕过了常规的文件名检查。其核心逻辑在于：1. 创建一个合法的伪装文件（Decoy）以降低受害者警惕；2. 构造包含嵌套路径遍历序列的恶意文件项；3. 利用NTFS ADS（如 filename:stream）语法进一步规避安全软件对路径提取行为的监控。该POC不仅提供了自动生成恶意压缩包的Python脚本，还包含了针对RAR头部CRC校验值的重新计算功能，确保了生成的恶意包在结构上符合规范，能被WinRAR正常识别并处理。在Windows环境下，攻击者通常将Payload指向用户的启动目录（Startup），这意味着一旦用户在任何位置解压该压缩包，恶意程序都会静默写入启动项，实现持久化控制。这种利用方式在红队评估和实际网络攻击中具有极高的成功率。 \n\n【利用步骤】1. 编辑config.py文件，设置DECOY_FILE_NAME为伪装文件名（如document），DROP_PATH设置为目标启动路径（如AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\payload.bat），并定义PAYLOAD内容。2. 运行main.py脚本，脚本将读取配置并生成包含恶意路径信息的RAR文件。3. 将生成的恶意RAR文件通过邮件、IM等社交工程手段发送给目标用户。4. 用户使用WinRAR 7.12或更早版本解压该文件，Payload将被自动释放到指定的启动目录。5. 用户下次登录系统时，Payload自动执行。\n\n【投毒风险分析】该POC项目存在中等偏高的投毒风险。首先，在其提供的extract.py代码片段中，出现了涉及网络套接字（socket）、结构化数据打包（struct）以及从外部文件（keys.txt）加载密钥的逻辑，这些功能与漏洞利用的核心逻辑（生成恶意RAR）并不直接相关，表现出典型的信息搜集或后门加载器的特征。其次，代码库中包含了一些被截断的异步函数（asyncio）和随机化处理（random），可能用于混淆其真实的通信意图。由于该项目声称用于“教育目的”，但代码结构中包含了与攻击行为无关的网络交互模块，这暗示该脚本本身可能被植入了解析器或窃密模块。如果安全研究人员在不具备隔离环境的情况下直接运行此Python脚本，可能会导致本地敏感信息被提取并发送至攻击者的C2服务器。此外，README中提到的‘确保可靠执行’等描述更倾向于武器化工具而非单纯的技术验证。建议在分析此POC时，必须在完全断网的虚拟机沙盒中进行，并严格审计main.py和extract.py中所有网络连接相关的函数，防止在研究过程中自身系统遭到侵害。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
