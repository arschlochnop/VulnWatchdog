## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100

**利用条件:** Unauthenticated remote access; partial PUT feature enabled.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 30%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability in Apache Tomcat's partial PUT functionality. The vulnerability allows an attacker to execute arbitrary code on the server by sending a specially crafted PUT request. The vulnerability exists due to improper handling of partial PUT requests, potentially allowing an attacker to bypass security checks and write arbitrary files to the server's file system. This can lead to code execution if the attacker uploads a malicious file, such as a JSP file, to a location where Tomcat can execute it. The POC code provided, `Apache_GoExploiter.go`, is a Go program designed to exploit this vulnerability. The code attempts to detect the protocol (HTTP or HTTPS) and then sends a crafted PUT request to upload a JSP webshell. This webshell allows for remote command execution on the target server. The exploit leverages Tomcat's partial PUT feature, which, if not correctly configured, can permit the overwriting of existing files or the creation of new ones. The provided Go code includes functionalities such as protocol detection (HTTP/HTTPS), custom user-agent settings, and concurrent target scanning using goroutines to enhance its effectiveness. It constructs a malicious JSP payload to achieve code execution on the server. The script attempts to upload a JSP shell, enabling the attacker to execute arbitrary commands on the compromised system. The successful exploitation depends on several factors, including the Tomcat version, configuration, and the presence of any security measures. The POC is mostly complete but may require minor configuration changes, such as adjusting the target URL and the path for the uploaded JSP shell. 

**Exploitation Steps:**
1. Compile and run the `Apache_GoExploiter.go` program.
2. Provide the target URL as a command-line argument.
3. The program will automatically detect the protocol and attempt to upload a JSP webshell to a common directory.
4. If successful, the program will print the URL of the uploaded webshell.
5. The attacker can then access the webshell and execute arbitrary commands on the server.

**投毒风险分析:**
虽然该POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。具体来说，`Apache_GoExploiter.go`代码中使用了`crypto/tls`包，并设置了`InsecureSkipVerify: true`。这会禁用SSL证书验证，使得该工具在连接HTTPS服务器时容易受到中间人攻击。虽然这在渗透测试中可能很方便，但在实际应用中会增加风险。此外，该POC尝试上传JSP webshell。虽然JSP webshell本身不是恶意代码，但可能被攻击者滥用。上传webshell是攻击链的一部分，如果攻击者获得服务器的访问权限，恶意行为的可能性就会增加。总的来说，投毒风险为中等，约为30%，因为该代码功能相对明确，主要用于漏洞利用，没有明显的恶意行为，但是webshell上传功能有潜在的风险。

**项目地址:** https://github.com/random-user/random-repo

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
