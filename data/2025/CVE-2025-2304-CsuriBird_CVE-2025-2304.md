## CVE-2025-2304 - Camaleon CMS Privilege Escalation (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** <= 2.9.0

**利用条件:** Requires authentication, Network access

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10

## 详情

CVE-2025-2304 披露了 Camaleon CMS 2.9.0 版本中存在的一个严重权限提升漏洞，该漏洞源于一个大规模赋值（Mass Assignment）缺陷。具体来说，当用户尝试更新其个人资料时，`UsersController` 中的 `updated_ajax` 方法错误地使用了 `permit!` 而非细粒度的参数过滤，导致攻击者能够绕过权限检查，任意修改用户的 `role` 参数，从而将普通用户提升为管理员权限。

**POC有效性分析**
提供的 Python POC 脚本针对这一缺陷进行了完整而有效的利用。脚本首先处理用户认证，成功登录为普通注册用户。随后，它会向 `/admin/users/[id]/updated_ajax` 端点发送一个特制的 POST 请求。该请求的 payload 中包含 `password[role]=admin` 参数，结合用户的 `password` 和 `password_confirmation` 参数一并提交。由于 `updated_ajax` 方法中的 `permit!` 函数未能正确过滤敏感参数，CMS 后端会无条件接受并处理 `role` 参数的修改请求，从而将当前用户的角色从普通用户更改为管理员。脚本还包含了验证步骤，尝试访问管理员专属的页面或功能来确认权限提升是否成功，这使得整个利用流程闭环且具有高度的可靠性。POC 的 `README.md` 文件清晰地阐述了漏洞原理、影响版本、利用方式和预期结果，甚至给出了脆弱代码片段和具体的 HTTP 请求示例，这表明了其高质量和极强的复现性。

**利用步骤**
1.  **环境准备**：部署 Camaleon CMS 版本 2.9.0 或更早版本的目标系统。
2.  **用户凭证获取**：注册一个普通用户账户，或获取一个现有普通用户的用户名和密码。
3.  **POC安装**：在本地环境中安装 Python 及其依赖。通过 `pip install -r requirements.txt` 安装 POC 脚本所需的库（如 `requests`）。
4.  **执行POC**：使用命令行运行 POC 脚本，指定目标 CMS 的 URL、普通用户的用户名和密码。例如：
    `python camaleon_cms_privilege_escalation.py --url http://target-cms.com --username regularuser --password userpassword` 
    可选地，可以使用 `--new-password` 参数在提升权限的同时设置新的管理员密码。
5.  **漏洞利用**：脚本会自动登录，发送构造好的 POST 请求到 `/admin/users/[id]/updated_ajax`。请求中的 `password[role]=admin` 参数会被服务器接受，导致当前已认证用户的权限被提升。
6.  **结果验证**：脚本随后会尝试访问只有管理员才能访问的页面或功能，以确认权限提升是否成功。攻击者此时可以使用原先的普通用户账户和（如果设置了）新密码，以管理员身份登录 CMS 后台，获得对整个系统的完全控制。

**投毒风险分析**
根据提供的 POC 代码描述及其 `README.md` 内容，该 POC 脚本的投毒风险评估为低（10%）。主要原因如下：
1.  **代码透明度高**：`README.md` 详细描述了脚本的工作原理、利用步骤和涉及的技术细节，包括具体的 HTTP 请求和payload结构，没有发现任何代码混淆或隐藏行为的迹象。
2.  **行为明确**：脚本的唯一目的被清晰地定义为执行 Camaleon CMS 的权限提升漏洞，并提供了明确的利用路径。其核心功能是修改用户角色参数，这是漏洞利用的直接体现，而非恶意后门。
3.  **无外部依赖或可疑调用**：描述中未提及脚本会从外部下载或执行任何可疑代码、shell命令，或与非预期的第三方服务进行通信。它似乎仅依赖标准的 Python 库（如 `requests`），用于 HTTP 请求。
4.  **目的单一**：作为防御性安全研究，此 POC 旨在展示漏洞的实际可利用性，帮助安全团队理解攻击面。其设计的验证步骤也是为了确认漏洞利用的成功，而非植入持久化后门或进行其他未声明的恶意活动。

综上所述，虽然任何从非官方源获取的代码都应进行严格审查和沙盒环境执行，但就目前提供的信息而言，该 POC 脚本的描述不包含任何可能导致供应链投毒或意外恶意行为的要素。其行为与声明的漏洞利用目标完全一致，因此投毒风险较低。

**项目地址:** Not available in provided data

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
