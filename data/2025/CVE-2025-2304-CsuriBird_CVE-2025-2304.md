## CVE-2025-2304 - Camaleon CMS Mass Assignment / Privilege Escalation

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Mass Assignment / Privilege Escalation

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** <= 2.9.0

**利用条件:** Requires authentication as a regular user, network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** Medium

**投毒风险:** 10%

## 详情

### POC有效性分析

该POC描述了一个针对Camaleon CMS 2.9.0版本的关键质量分配（Mass Assignment）漏洞（CVE-2025-2304）的权限提升攻击。根据README文件，该漏洞存在于`UsersController`的`updated_ajax`方法中，由于使用了`permit!`方法，导致所有参数未经适当过滤就被允许通过，其中包括敏感的`role`参数。攻击者可以利用此漏洞，将普通注册用户的权限提升至管理员级别。POC提供了详细的漏洞细节、利用机制、安装和使用说明，并包含易于理解的代码片段和HTTP请求示例。Python脚本首先会以普通用户身份登录，然后向`/admin/users/[id]/updated_ajax`发送一个恶意POST请求，在请求体中包含`password[role]=admin`，从而修改用户的角色。脚本还提供了验证机制，通过尝试访问管理员专用端点来确认攻击成功。鉴于其清晰的描述、完整的利用流程、详细的技术背景以及对受影响版本和攻击向量的明确说明，该POC具有高度的有效性，能够可靠地在Camaleon CMS 2.9.0版本上复现权限提升漏洞。

### 利用步骤

1.  **环境准备**：确保目标系统运行的是Camaleon CMS 2.9.0版本。攻击者需要一台能够访问目标CMS的机器，并安装Python环境及所需的依赖。
2.  **前置条件**：攻击者必须拥有目标CMS上一个普通注册用户的有效凭据（用户名和密码）。
3.  **安装依赖**：通过命令行执行`pip install -r requirements.txt`安装POC脚本所需的Python库，通常包括用于HTTP请求的`requests`库。
4.  **执行脚本**：运行提供的Python利用脚本，并传入目标CMS的URL、普通用户的用户名和密码。例如：`python camaleon_cms_privilege_escalation.py --url http://192.168.1.100 --username testuser --password testpass123 --new-password newadminpass`。其中，`--new-password`参数是可选的，用于在权限提升后设置新的管理员密码。
5.  **用户认证**：脚本首先会使用提供的普通用户凭据登录目标CMS，获取有效的会话。
6.  **构造并发送恶意请求**：脚本随后会构造一个POST请求，目标地址为`/admin/users/[id]/updated_ajax`，其中`[id]`是当前已登录普通用户的ID（脚本可能会自动发现或使用默认值，如`5`）。请求体中包含`password[role]=admin`以及用户的密码更新字段（`password[password]`和`password[password_confirmation]`）。这个`password[role]=admin`参数正是利用质量分配漏洞的关键，它绕过了正常的权限检查，直接将用户的角色修改为管理员。
7.  **权限提升**：如果目标CMS未打补丁，服务器会处理这个恶意请求，并将当前用户的角色从普通用户更新为管理员。
8.  **验证攻击**：脚本会尝试访问只有管理员才能访问的CMS管理面板路径或功能，以验证权限提升是否成功。

### 投毒风险分析

根据提供的POC描述，此POC的投毒风险评估为低（10%）。POC的`README.md`文件清晰地阐述了漏洞的细节、利用方法以及预期的结果，其目的是合法地演示Camaleon CMS的权限提升漏洞。描述中没有任何暗示存在恶意行为，例如代码混淆、植入后门、进行未经授权的外部通信、或在执行POC的系统上执行除利用漏洞之外的其他操作。POC的主要功能是通过标准HTTP POST请求向目标CMS发送精心构造的参数，从而修改目标系统上的用户权限。这种行为是漏洞利用的组成部分，不应被误判为针对执行POC的用户进行的“投毒”。

POC文档中列出了`requirements.txt`文件，这表明它依赖标准的Python库，而非不明来源的二进制文件或脚本。通常情况下，这些库是为执行正常的网络操作而设计，并非用于恶意目的。该POC的预期效果是将目标CMS上的普通用户权限提升为管理员，这确实为攻击者提供了对目标系统的完全控制，但这属于漏洞利用的“影响”，而不是POC代码本身对研究人员或其环境造成的“投毒”风险。一个负责任的安全研究员在运行任何外部来源的POC时，仍应审阅其源代码，以确保其行为与描述一致，并避免潜在的恶意或意外操作。但基于目前提供的信息，该POC被设计为一种干净、直接的漏洞利用工具，不含额外的恶意负载或隐藏功能。

总结来说，该POC的透明度和详细的攻击流程描述表明，其主要目的是为了验证漏洞存在并提供利用方法，而不是作为恶意软件传播的载体。因此，对于合法的防御性安全研究而言，其投毒风险较低。然而，无论POC描述多么详尽，最佳实践仍是始终在隔离环境中运行POC，并对任何潜在的可疑行为保持警惕。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
