## CVE-2025-2304 - Camaleon CMS 权限提升 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** 

**影响版本:** 2.9.0

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该漏洞被识别为CVE-2025-2304，影响Camaleon CMS 2.9.0版本，是一个严重的质量分配缺陷，可导致权限提升。具体来说，该漏洞存在于`UsersController`的`updated_ajax`方法中。此方法错误地使用了`params.require(:user).permit!`，而不是应用特定的参数过滤。这种宽松的处理允许请求中发送的任何参数被批量分配给用户对象，包括`role`等敏感属性。因此，经过身份验证的普通用户可以在未经适当授权的情况下恶意将其自身角色修改为“admin”。此漏洞的影响是严重的，它使普通用户获得管理员权限，可能导致完整的系统入侵、数据泄露以及对CMS实例的持久性未授权控制。

**POC有效性分析：**
所提供的概念验证（POC）在`README.md`文件中进行了详细描述，全面阐述了CVE-2025-2304的利用机制和使用方法。`README`清晰地指出，该漏洞利用的是Camaleon CMS 2.9.0中的一个质量分配漏洞。它解释说，`UsersController`中`updated_ajax`操作中的`permit!`方法是根本原因，允许未过滤的参数（包括`role`）被修改。`README`包含确切的端点（`/admin/users/[id]/updated_ajax`）、特定的恶意载荷（`password[role]=admin`）以及预期的成功JSON响应。此外，它提供了Python脚本的安装说明（`pip install -r requirements.txt`）和使用示例，表明存在一个功能齐全的利用脚本，旨在自动化攻击。技术细节，包括脆弱的代码片段，有力地证实了所描述的漏洞和利用方法。`README`的清晰度和完整性表明，相关的Python脚本在演示和利用此权限提升漏洞方面将是高效且可靠的。

**利用步骤：**
利用CVE-2025-2304是一个直接的过程，主要需要事先以普通用户身份进行身份验证：
1.  **初始访问：** 攻击者必须首先获得Camaleon CMS 2.9.0实例上有效普通用户账户的访问权限。这可能涉及在启用公共注册时注册新用户，或利用受损凭据。
2.  **执行漏洞利用脚本：** 攻击者随后从命令行执行提供的Python漏洞利用脚本，指定目标CMS URL、普通用户名和相应的密码。例如：`python camaleon_cms_privilege_escalation.py --url http://192.168.1.100 --username testuser --password testpass123`。还可以使用可选参数`--new-password`为提升权限后的管理员账户设置新密码。
3.  **身份验证：** 脚本首先使用提供的普通用户凭据对Camaleon CMS进行身份验证。
4.  **构建恶意请求：** 身份验证成功后，脚本会构建一个专门设计的POST请求。此请求被发送到`/admin/users/[id]/updated_ajax`端点，其中`[id]`对应于已认证的普通用户ID（POC中提到`id 5`是一个常见的默认值，但可能需要调整）。
5.  **质量分配载荷：** 攻击的核心在于请求的载荷，其中包括`password[password]=newpass123&password[password_confirmation]=newpass123&password[role]=admin&_method=patch`。关键是包含了`password[role]=admin`参数。
6.  **权限提升：** 由于CMS的`updated_ajax`操作中存在脆弱的`permit!`方法，`role`参数未被正确过滤，而是批量分配给了用户对象，从而有效地将普通用户的角色更改为“admin”。
7.  **验证：** 脚本最后尝试访问仅限管理员的端点。成功访问证实了用户的权限已成功提升为管理员。此时，攻击者对Camaleon CMS拥有完全的管理员控制权。

**投毒风险分析：**
关于CVE-2025-2304所提供的信息是以`README.md`文件的形式呈现，详细描述了一个Python漏洞利用脚本。根据`README.md`中的描述文本，该漏洞利用代码本身包含与所述漏洞无关的恶意功能的“投毒”风险似乎很低。该文档清晰地概述了脚本的目的：利用Camaleon CMS 2.9.0中特定的质量分配漏洞进行权限提升。 “漏洞利用原理”、“恶意载荷”示例和“技术细节”部分直接与针对所描述漏洞的靶向攻击相符。没有提及或观察到任何指示代码混淆、包含或获取外部恶意脚本，或除了身份验证和权限提升POST请求所需之外的任何异常网络请求的模式。该脚本旨在获取用户明确提供的输入（URL、用户名、密码），并执行一个单一、明确定义的恶意操作（更改用户角色）。使用标准Python库（通过`pip install -r requirements.txt`暗示用于HTTP请求）以及没有可疑的动态代码执行结构（如`eval`）进一步支持了低投毒风险的评估。重点完全在于演示和实现所述漏洞的影响。因此，组织在使用或分析此POC时，可以相对高度地确信它不会引入次要的、未声明的恶意载荷或后门。主要风险仍然在于目标系统未打补丁时漏洞本身。

**项目地址:** 

**漏洞详情:** 
