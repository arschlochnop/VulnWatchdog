## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Camaleon CMS

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** <= 2.9.0

**利用条件:** 需要认证，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该漏洞，CVE-2025-2304，存在于Camaleon CMS 2.9.0及其之前版本中。这是一个权限提升漏洞，具体表现为通过“大规模赋值”（Mass Assignment）机制实现。该漏洞存在于`UsersController`的`updated_ajax`方法中，由于使用了`permit!`方法而非对参数进行严格过滤，导致任意已注册用户在更新个人资料时，可以通过提交恶意构造的请求来修改其角色（`role`）参数，从而将普通用户权限提升至管理员权限。攻击者无需具备特殊的先验知识或复杂环境即可利用此漏洞。

**POC有效性分析**
提供的POC是一个Python脚本，名为`camaleon_cms_privilege_escalation.py`。该脚本详细地描述了漏洞的原理、利用方式、安装和使用方法，并提供了代码示例和恶意负载。它首先模拟普通用户登录，然后向`/admin/users/[id]/updated_ajax`发送一个POST请求，请求体中包含`password[role]=admin`以及用户的新密码。根据POC的描述，由于`updated_ajax`方法中`params.require(:user).permit!`的错误使用，系统会未经检查地将`role`参数赋值给用户对象，从而实现权限提升。脚本还包含验证步骤，尝试访问管理员专用接口以确认权限变更。虽然README中提到脚本可能抛出一些错误，但明确指出可以通过检查CMS登录页面并使用新密码登录来验证是否成功提升为管理员。这表明该POC是一个功能完善、可直接用于复现和利用的工具，其有效性非常高，能够成功演示并执行权限提升攻击。其详细的解释和步骤使其成为一个高质量的验证工具。

**利用步骤**
1.  **识别目标**: 确定运行Camaleon CMS且版本为2.9.0或更早的实例。
2.  **获取普通用户凭证**: 拥有一个已注册的普通用户账户的用户名和密码。
3.  **安装依赖**: 在本地攻击机上安装POC所需的Python依赖 (`pip install -r requirements.txt`)。
4.  **执行POC脚本**: 运行Python脚本，提供目标CMS的URL、普通用户的用户名和密码。例如：
    `python camaleon_cms_privilege_escalation.py --url http://target-cms.com --username regularuser --password userpassword --new-password newadminpass`
5.  **POC操作**: 脚本首先会尝试使用提供的凭证登录到Camaleon CMS。成功登录后，它会构建一个恶意HTTP POST请求，目标是`/admin/users/[id]/updated_ajax`端点（其中`[id]`是当前已登录用户的ID，POC默认使用5，但可能需要根据实际情况调整）。请求体中会包含如`password[password]=newadminpass&password[role]=admin`等参数，其中关键是`password[role]=admin`。
6.  **权限提升**: 由于CMS后端`updated_ajax`方法存在大规模赋值漏洞，系统会将`password[role]=admin`成功地应用到当前用户的角色属性上，将其从普通用户更改为管理员。
7.  **验证**: POC脚本会尝试访问管理员专属功能来验证权限提升是否成功。攻击者也可以在脚本执行完毕后，访问CMS的登录页面，用之前提供的用户名和新密码登录。如果成功以管理员身份登录，则表示权限提升成功。

**投毒风险分析**
针对提供的POC代码（通过其`README.md`描述），投毒风险评估为低（约10%）。
1.  **代码意图清晰**: `README.md`文件清晰地描述了漏洞类型（Mass Assignment）、受影响版本（Camaleon CMS 2.9.0）以及利用方式（将普通用户角色提升为管理员）。整个文档的焦点在于复现和利用CVE-2025-2304。攻击的核心是通过向特定的HTTP端点发送包含`password[role]=admin`参数的POST请求。这种行为是完全符合其所声称的权限提升漏洞利用逻辑的。
2.  **无恶意行为迹象**: `README.md`中没有提及或暗示任何额外、与权限提升无关的恶意行为，例如：
    *   **代码混淆或加密**: 文档中展示了清晰的Ruby代码片段和HTTP请求负载，没有提到POC脚本本身使用了代码混淆。
    *   **外部资源加载**: 未提及POC脚本会从外部服务器下载或执行任何额外的脚本、二进制文件或恶意负载。
    *   **非预期网络通信**: 除了向目标CMS发送认证和漏洞利用请求外，没有提及进行其他与攻击目的无关的网络通信（如向C2服务器回连、数据窃取等）。
    *   **持久化机制**: 漏洞利用的结果是提升了现有用户的权限，而非植入一个持久化后门。虽然管理员权限本身可以用于植入后门，但这属于利用后续行为，并非POC本身的投毒行为。
3.  **遵循标准利用模式**: `Mass Assignment`是Web应用中常见的漏洞类型，其利用方式通常涉及修改特定参数以绕过权限控制。该POC的描述完全符合这种标准的漏洞利用模式。
4.  **警告信息**: `README.md`中提到“The script might throw some errors, please ignore them.”，这可能暗示脚本健壮性不佳或存在一些预期外的输出，但这并非恶意行为的直接证据，更倾向于开发质量问题。
5.  **本地文件路径**: 输入数据中的POC路径是`/tmp/vulnwatchdog_.../README.md`，表明这是一个本地文件描述，而非公开的GitHub或其他平台上的代码库。因此，我们只能基于提供的README内容进行风险评估。在没有实际Python脚本可供审计的情况下，无法从代码层面进行深入分析。
综上所述，根据提供的信息，该POC的明确目标是利用已知的漏洞，并清晰地描述了其工作原理，没有表现出任何额外的恶意载荷或非预期行为。因此，判断其投毒风险较低，主要风险在于其作为漏洞利用工具本身，而非携带额外的恶意载荷。

**项目地址:** N/A

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
