## CVE-2025-54100 - PowerShell (Windows PowerShell 5.1) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-54100

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PowerShell (Windows PowerShell 5.1)

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Windows 10/11, Windows Server 2008-2025, PowerShell 5.1

**利用条件:** 受害者需使用 Invoke-WebRequest 或 curl 访问攻击者控制的恶意 URL，且未使用 -UseBasicParsing 参数。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞的根源在于 Windows PowerShell 5.1 在处理 HTTP 响应时，默认调用 MSHTML 引擎进行解析。当用户执行 Invoke-WebRequest 而未显式指定 -UseBasicParsing 参数时，MSHTML 会像浏览器一样渲染返回的 HTML。POC 通过 FastAPI 搭建恶意服务器，返回包含 ActiveXObject（如 WScript.Shell 或 Shell.Application）的 HTML 代码。由于 MSHTML 在 PowerShell 环境下的安全限制较弱，这些脚本能够绕过传统浏览器沙箱，直接在调用者的用户上下文中执行系统命令（如启动 calc.exe）。经过对提供代码的分析，其 Python 后端逻辑清晰，HTML 载荷构造精确，能有效触发 MSHTML 解析行为，验证了从 web 响应到系统命令执行的完整路径。利用步骤：1. 在攻击机上部署 Python 环境并安装 FastAPI 与 uvicorn；2. 运行 app.py 启动恶意 HTTP 服务器，监听特定端口（如 8888）；3. 在目标 Windows 主机上通过 PowerShell 5.1 执行 Invoke-WebRequest -Uri 攻击机IP:8888；4. 观察目标机是否弹出计算器或执行预设命令。投毒风险分析：该 POC 来源于 GitHub 上的安全研究项目，代码结构透明，主要由 Python 编写的后端和 HTML 模板组成，未发现明显的二进制后门或混淆代码。然而，投毒风险依然存在于以下几点：首先，README 中提到的‘调整 Internet 选项以验证执行’可能诱导防御者降低自身系统的安全阈值，若未及时恢复则会留下永久隐患；其次，虽然当前载荷是 calc.exe，但攻击者极易修改 HTML 中的脚本逻辑，将其替换为下载并运行远控木马的 PowerShell 指令。鉴于该 POC 需要依赖特定的 PowerShell 5.1 环境及 MSHTML 组件，风险主要集中在安全人员自测时的误操作，而非代码本身的恶意投毒。该代码采用标准库和主流框架，逻辑可读性强，整体属于低投毒风险范畴，但在引用时仍需在隔离环境运行。

**项目地址:** [https://github.com/osman1337-security/CVE-2025-54100](https://github.com/osman1337-security/CVE-2025-54100)

**漏洞详情:** [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-54100)
