## CVE-2025-33073 - Microsoft Windows / SMB Client 权限提升 (EoP)

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升 (EoP)

**影响应用:** Microsoft Windows / SMB Client

**危害等级:** 高危 (High)

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Windows 10, Windows 11, Windows Server 2008-2025

**利用条件:** 需要普通域用户权限，目标环境未强制执行SMB签名，网络可达

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC框架针对CVE-2025-33073漏洞实现了完整的自动化攻击链。该漏洞源于Windows SMB客户端在处理编组目标信息（Marshaled target info）时的访问控制不当，导致其绕过了原有的NTLM反射攻击缓解措施。通过分析代码结构，该POC集成了ADIDNS投毒和NTLM重放技术。利用步骤如下：首先，攻击者利用普通域用户权限在Active Directory集成DNS（ADIDNS）中添加恶意的DNS记录。接着，通过触发机制（如连接请求或诱导）强制域内目标计算机对恶意记录进行解析。当目标机尝试通过SMB协议连接攻击者伪造的服务端时，POC中的'Malicious SMB Server'组件会截获NTLM认证请求，并利用驱动程序（mrxsmb.sys）的缺陷，将认证凭据反射回目标机自身或转发至其他未启用SMB签名的机器。此POC的有效性在于它不仅提供了Python实现的利用框架，还包含了PowerShell版本和管理员权限启动脚本，具备极高的实战价值，能直接获取SYSTEM权限。投毒风险分析：经过对提供的代码结构和描述进行安全性审查，该项目主要展现为安全研究性质。README中明确标注了作者（cyberseallll）及研究意图。代码采用了标准的Python和PowerShell库，未发现明显的恶意二机制文件嵌入或混淆代码。然而，项目中包含的'run_as_admin.bat'和'admin_exploit_framework.py'在执行时会请求高权限，这在防御性测试中是合理的，但如果脚本来源不明，可能被插入隐蔽的后门。由于该POC具有极高的攻击性能（被称为‘域内大杀器’），且能自动化完成DNS注入和中继攻击，因此该工具本身具备双刃剑性质。在实际部署测试时，需警惕脚本是否在执行利用的同时向外部C2地址发送敏感凭据（如NTLM Hash）。当前评估其投毒风险为15%，属于较低范围，风险主要源于工具的破坏力而非代码本身的后门特征。

**项目地址:** [https://github.com/cyberseallll/CVE-2025-33073-Research](https://www.google.com/search?q=https://github.com/cyberseallll/CVE-2025-33073-Research)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)
