## CVE-2025-30208 - Vite (前端开发构建工具) 路径遍历/任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 路径遍历/任意文件读取

**影响应用:** Vite (前端开发构建工具)

**危害等级:** 中等至高

**CVSS评分:** 5.3

**影响版本:** < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15, < 4.5.10

**利用条件:** 1. 目标运行受影响版本的Vite开发服务器；2. 开发服务器配置为对网络公开暴露（使用 --host 或 server.host）；3. 攻击者具备网络可达性。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC详细展示了针对Vite开发服务器中@fs路径限制绕过的多种方法。在Vite的设计中，为了方便调试，允许通过/@fs/前缀访问文件系统中的文件，但通过server.fs.deny配置了黑名单以保护敏感文件。CVE-2025-30208的漏洞核心在于Vite在处理URL查询参数时存在逻辑漏洞。当攻击者构造带有特定的‘尾部分隔符’（如?raw??或?import&raw??）的请求时，Vite的内部路径解析机制会错误地移除或忽略这些多余的问号，但在应用安全过滤正则表达式阶段，这些多余字符导致正则匹配失效，从而绕过了对禁止访问路径的检查。经分析，该POC提供的curl命令在实验环境中具有极高的成功率。利用步骤：首先，攻击者需确认目标主机的5173端口（或其他自定义Vite端口）是否对外开放。其次，通过简单的HTTP GET请求测试能否直接访问敏感路径，如使用curl探测 /@fs/etc/passwd。如果直接访问返回403 Forbidden，则尝试在该路径后追加特定的绕过载荷，例如 /@fs/etc/passwd?raw??。如果服务器返回了文件内容，则漏洞利用成功。该POC还涵盖了CVE-2025-31125等相关漏洞的利用方式，利用?inline&import等参数实现类似的绕过效果。投毒风险分析：该POC代码主要由说明文档（README.md）和标准的curl命令行示例组成。代码逻辑透明，完全使用标准的HTTP客户端工具进行演示，不包含任何二进制文件、经过混淆的JavaScript代码或自动化的远程脚本下载行为。虽然文档中提到了针对.ssh/id_rsa等敏感文件的读取，但这属于典型的漏洞危害演示，而非恶意投毒逻辑。该POC的发布者身份明确（指向安全研究社区），代码中没有发现任何试图在分析者机器上执行持久化操作或反弹shell的后门。因此，该POC被判定为低风险（5%），其风险主要来自于被恶意攻击者直接用于实战攻击，而非代码本身携带毒素。对于防御性研究员而言，可以直接引用其中的Payload进行补丁有效性验证或扫描规则编写。

**项目地址:** /tmp/vulnwatchdog_13f20c37b7a525703ea8a34c5d083146/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
