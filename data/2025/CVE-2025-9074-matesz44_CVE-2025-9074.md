## CVE-2025-9074 - Docker Desktop 不当访问控制/容器逃逸/本地权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 不当访问控制/容器逃逸/本地权限提升

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 受影响版本为2025年8月修复补丁发布之前的Docker Desktop版本。

**利用条件:** 需要网络访问到Docker引擎API，且该API存在访问控制不当漏洞（未认证暴露）。在特定WSL后端配置下，可进一步挂载主机驱动器。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是Docker Desktop中的一个严重漏洞，源于Docker引擎API的访问控制不当。该漏洞允许攻击者在具备本地Linux容器访问权限或通过网络访问到未受认证保护的Docker引擎API时，执行特权命令并实现容器逃逸，进而以当前用户权限挂载主机驱动器，对个人电脑造成全面威胁。

**POC有效性分析：**
提供的POC是一个名为`CVE-2025-9074.sh`的shell脚本，它演示了如何利用这个Docker Desktop的访问控制不当漏洞实现容器逃逸和本地权限提升。脚本的核心逻辑是利用`curl`工具与目标Docker引擎API进行交互。首先，脚本尝试从`http://IP:PORT/images/json`路径获取一个可用的Docker镜像名称。随后，它构造一个包含恶意命令的JSON载荷，发送到`http://IP:PORT/containers/create`端点以创建一个新的容器。这个恶意命令是一个`bash`反向shell，旨在连接回攻击者监听的IP和端口（LHOST:LPORT），从而在受害机器上建立一个交互式shell。更关键的是，该POC在`HostConfig`中设置了`Binds`，尝试将主机的`/mnt/host/c`（针对Windows）和根目录`/`（针对Linux）分别挂载到新创建容器的`/host_root_win`和`/host_root_nix`路径。这意味着一旦容器成功启动，攻击者将能够从容器内部访问并操作宿主机的文件系统，这直接证明了容器逃逸的有效性。最后，脚本通过向`http://IP:PORT/containers/ID/start`发送POST请求来启动新创建的容器。整个流程清晰、逻辑严谨，完全符合漏洞描述的利用场景，因此该POC被评估为功能完整的、高有效性的利用代码。

**利用步骤：**
1.  **环境准备**：
    *   受害者机器运行着存在CVE-2025-9074漏洞的Docker Desktop版本（2025年8月修复补丁发布之前）。
    *   Docker引擎API在目标IP和端口上暴露且没有恰当的认证机制。
    *   攻击者需要一台监听反向shell的机器。
2.  **启动监听器**：在攻击者机器上启动一个网络监听器，例如使用`netcat`：`nc -lvp [LPORT]`。
3.  **执行POC**：在攻击者机器上运行POC脚本，提供目标Docker引擎API的IP和端口，以及攻击者监听机的IP和端口。
    例如：`sh CVE-2025-9074.sh 192.168.65.7 2375 10.10.14.73 9002`
    *   `192.168.65.7`是Docker引擎API的IP地址。
    *   `2375`是Docker引擎API的端口。
    *   `10.10.14.73`是攻击者监听反向shell的IP地址。
    *   `9002`是攻击者监听反向shell的端口。
4.  **接收反向Shell**：如果利用成功，攻击者的监听器将收到一个来自受害者机器的反向shell，且由于容器逃逸，此shell将具备访问宿主机文件系统的能力。

**投毒风险分析：**
对提供的POC代码`CVE-2025-9074.sh`进行分析后，评估其投毒风险为低 (10%)。具体分析如下：
*   **代码清晰度与可读性**：该POC代码是纯粹的shell脚本，结构简单，逻辑直观。所有命令都清晰可见，没有使用任何形式的代码混淆技术，如base64编码、压缩、加密或复杂的字符串拼接等，使其难以理解或分析。这大大降低了隐藏恶意代码的风险。
*   **外部依赖与请求**：脚本的核心功能依赖于`curl`和`bash`这两个标准Linux/Unix工具。`curl`用于与Docker引擎API进行HTTP通信，其目标地址直接由用户输入参数（`IP`和`PORT`）决定，所有请求都指向目标Docker服务，而不是未知的第三方服务器。脚本中没有发现调用或下载外部脚本（例如`wget`或`curl | bash`到未知URL）的行为，这意味着它不会在执行过程中引入未经审查的外部代码。
*   **恶意行为与利用逻辑**：POC的主要“恶意”行为是创建一个反向shell并挂载宿主机目录。然而，这正是漏洞利用本身的目的，旨在证明容器逃逸和权限提升能力，而不是额外的、隐蔽的恶意载荷。反向shell的IP和端口同样由用户在命令行中明确指定，且是标准、可识别的攻击载荷形式。脚本没有包含比特币挖矿、勒索软件、数据窃取、持久化后门安装或破坏性操作等超出漏洞验证范畴的隐蔽功能。
*   **动态代码执行**：脚本确实构造了动态命令字符串来传递给`bash -c`，但这属于反向shell的正常构造方式，并且该命令的内容直接可见，其目的是建立连接到攻击者指定IP和端口的反向shell，并非用于执行来自不可信源的任意代码或进行模糊处理。

综上所述，该POC代码完全服务于其声明的漏洞验证目的，代码透明、行为可预测，且不包含任何旨在隐藏或执行次要恶意活动的特征。因此，其作为防御性安全研究工具的投毒风险被判定为低。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
