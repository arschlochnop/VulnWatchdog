## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Redis 6.x - 8.x; 修复版本为 8.2.2, 8.0.4, 7.4.6, 7.2.11

**利用条件:** 需要网络访问权限，通常需要通过身份验证（即使是低权限用户）以执行Lua脚本命令

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为'RediShell'，是Redis历史上首个CVSS满分漏洞。POC基于Wiz研究团队披露的机制，通过构造特定的Lua脚本触发内存管理中的Use-After-Free（UAF）漏洞。在Redis执行Lua脚本时，攻击者可以释放特定内存块后重新引用，从而实现对Lua沙盒的逃逸并获取系统底层的执行权限。该POC提供了一个完整的容器化实验环境，包含Dockerfile、配置好的易受攻击版本（Redis 7.2.0）以及多功能的Python漏洞检测与攻击脚本。脚本覆盖了从简单的漏洞检测到高级的沙盒逃逸和内存损坏测试，结构严谨且具有极高的实战参考价值。利用步骤：1. 使用Docker部署漏洞环境，确保Redis服务在指定端口运行；2. 使用exploit_poc.py脚本，首先通过'-m check'模式验证目标是否存在漏洞；3. 针对存在漏洞的目标，使用'-m sandbox'或'-m advanced'模式执行具体攻击，脚本将向Redis发送精心构造的EVAL命令，执行恶意Lua逻辑；4. 成功后可实现命令执行，通常表现为反弹Shell或在宿主机执行系统命令。投毒风险分析：该POC项目代码透明度高，逻辑清晰，主要基于标准Python库（redis, colorama）编写。虽然攻击脚本包含复杂的内存操作逻辑，但其意图明确，未发现明显的代码混淆或恶意隐藏行为。Dockerfile和README文档提供了详细的部署指南和免责声明，符合防御性研究的规范。然而，由于该漏洞影响范围极广且危害极大，此类工具在非受控环境中极易被滥用。目前投毒风险较低，主要风险在于脚本可能会被第三方修改后植入恶意外部请求或反弹回连至攻击者服务器。建议用户在使用前仔细核对exploit_poc.py中涉及socket连接和系统调用的部分，确保其行为仅限于本地测试目标。组织应加强对生产环境Redis的认证审计，并尽快升级到官方发布的修复版本，以阻断此类高效率POC的攻击路径。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844-RediShell](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844-RediShell)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
