## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Redis 8.2.1及以下, 8.0.3及以下, 7.4.5及以下, 7.2.10及以下

**利用条件:** 经过身份验证的远程用户权限（低权限即可）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC（RediShell）具有极高的有效性。它提供了一个完整的Docker实验环境，预配置了易受攻击的Redis 7.2.0版本。POC代码结构清晰，通过Python脚本实现了从漏洞检测（check模式）到沙箱逃逸（sandbox模式）再到内存损坏（advanced模式）的全路径利用。该漏洞的核心在于Redis Lua解释器在处理特定脚本逻辑时的内存管理缺陷，即Use-After-Free（释放后重用）。POC利用此缺陷绕过了Redis内置的Lua沙箱限制，直接操作底层内存，从而在宿主机进程上下文中执行任意系统命令。由于Redis通常以较高权限运行且内部通信信任度高，此POC证明了漏洞可导致服务器完全失陷。代码中包含针对不同利用阶段的模块化设计，具备实战化利用能力。【利用步骤】1. 环境搭建：使用提供的Dockerfile构建并启动Redis容器，关闭保护模式并监听0.0.0.0。2. 依赖安装：在攻击机安装redis-py和colorama库。3. 漏洞检测：运行python3 exploit_poc.py -m check，验证目标是否存在UAF漏洞。4. 执行利用：运行-m all或-m sandbox，脚本将向Redis发送精心构造的Lua脚本（通过EVAL命令），触发UAF并劫持程序流执行shell命令。5. 权限维持：利用成功后可实现命令执行，进而进行横向移动。【投毒风险分析】该POC项目目前的投毒风险处于较低水平（约15%）。分析代码发现，其核心Python利用脚本逻辑透明，主要使用标准库和公认的redis客户端库，未见混淆代码或加密payload。Dockerfile构建过程直接来源于Docker Hub官方镜像，未引入可疑的第三方二进制文件。然而，作为安全研究员需注意：1. 自动化工具倾向：脚本中预留了-H和-p参数，若被恶意修改默认连接到外部C2服务器，则存在跳板风险。2. 虚假POC风险：虽然此版本安全，但此类高价值漏洞（CVSS 10.0）极易被黑客重包装，在GitHub等平台发布带有后门的‘一键利用工具’，例如在执行exploit时静默下载木马。3. 实验环境安全：POC要求关闭Redis保护模式，如果在非隔离环境测试，可能导致测试机反被入侵。综上，此POC是高质量的防御研究资料，但在下载和使用非官方渠道的衍生版本时必须严格审计Python脚本中的eval或os.system调用。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844-RediShell](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844-RediShell)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
