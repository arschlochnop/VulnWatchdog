## CVE-2025-14558 - FreeBSD rtsold 命令注入/RCE

**漏洞编号:** CVE-2025-14558

**漏洞类型:** 命令注入/RCE

**影响应用:** FreeBSD rtsold

**危害等级:** 高危

**CVSS评分:** 8.8 (CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** FreeBSD 13.x, 14.x, 15.x (2025-12-16之前的版本)

**利用条件:** 攻击者需与目标系统处于同一二层网络(同一局域网/网段)，且目标系统需启用rtsold并接受路由通告(ACCEPT_RTADV)。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于FreeBSD的IPv6路由通告守护程序rtsold(8)中。通过分析提供的Python脚本，攻击者利用Scapy库构造恶意的ICMPv6路由通告（RA）报文。其核心利用点在于DNSSL（DNS Search List）选项的解析过程。rtsold在接收到RA报文后，会将解码后的域名直接传递给resolvconf(8)脚本进行处理。由于resolvconf是一个Shell脚本，且在处理变量时未对特殊字符进行转义或引用，导致攻击者可以通过构造包含“$()”或反引号的恶意域名实现命令注入。POC代码展示了如何将有效载荷封装在DNS标签格式中并发送。经评估，该POC逻辑清晰，直接针对FreeBSD安全公告中描述的缺陷，在满足二层网络连通性的前提下具有极高的利用成功率。利用步骤：1. 攻击者接入目标所在的同一物理网络或VLAN；2. 准备Python3环境并安装Scapy库；3. 识别目标的网络接口；4. 使用root权限运行POC脚本，通过“-p”参数指定待执行的Shell命令；5. POC会构造包含恶意DNSSL选项的ICMPv6 RA包并向链路本地多播地址（ff02::1）发送；6. 目标主机的rtsold进程接收并解析该包，触发resolvconf执行注入的命令。投毒风险分析：该POC代码由Lukas Johannes Möller发布，代码结构规范，主要依赖标准的Scapy库进行低层协议构造。代码中未发现明显的恶意混淆、远程Shell反弹至第三方可疑IP或删除系统关键文件的行为。其核心功能函数如encode_domain和build_dnssl逻辑透明，符合合法的安全研究用途。主要的风险点在于：首先，攻击脚本需要以root权限运行（为了发送原始套接字报文），这在不可信的环境下运行任何第三方脚本都存在潜在的权限滥用风险；其次，虽然当前POC默认行为是“touch /tmp/pwned”，但其具备自定义payload的能力，若被集成到自动化攻击工具中可能造成严重破坏。总体而言，该代码作为公开的安全研究样本，其自身的恶意特征不明显，投毒风险处于低水平，但研究人员仍应在隔离环境中使用。

**项目地址:** [https://github.com/JohannesLks/CVE-2025-14558](https://github.com/JohannesLks/CVE-2025-14558)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14558](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2025-14558)
