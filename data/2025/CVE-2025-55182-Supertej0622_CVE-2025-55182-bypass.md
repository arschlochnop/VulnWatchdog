## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 极危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**影响版本:** React Server Components 19.0.0, 19.1.0, 19.1.1, 19.2.0 (以及相关组件如react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack)

**利用条件:** 无需认证的远程网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个针对React Server Components (RSC) 的严重远程代码执行漏洞，被社区称为“React2Shell”，其威胁等级被认为与Log4Shell相当。该漏洞源于对HTTP请求中发送到Server Function端点的负载进行不安全的反序列化，使得未经身份验证的攻击者能够远程执行任意代码。受影响的版本包括React Server Components 19.0.0、19.1.0、19.1.1和19.2.0，以及依赖这些组件的框架，如Next.js。

**POC有效性分析：**
提供的POC是一个Nuclei模板，具有`verified: true`标签，这表明该模板经过验证且功能有效。模板中明确列出了受影响的产品、版本范围，并给出了CVSS 10.0的满分严重性评分以及高达0.97572的EPSS百分位，这些都强烈表明该漏洞的真实性和高可利用性。Nuclei模板以其自动化和可靠的漏洞检测能力而闻名。尽管POC中具体的RCE payload部分被截断，但其包含的`batteringram`攻击模式以及对多种`charset`的测试，旨在绕过WAF检测，这说明了该POC具备高级的攻击策略。鉴于这些因素，该Nuclei模板被设计为一个完整且高效的利用工具，能够自动化地识别并利用目标系统中的不安全反序列化漏洞，最终实现未经授权的远程代码执行。

**利用步骤：**
攻击者可以利用此漏洞通过向受影响的React Server Components或Next.js应用发送一个精心构造的HTTP请求来实现远程代码执行。具体的利用步骤如下：
1.  **目标识别：** 攻击者首先通过互联网扫描工具（如Shodan，利用`http.component:"Next.js"`等查询）识别出运行受影响React Server Components或Next.js版本的Web应用。这些应用通常暴露了可供远程访问的Server Function端点。
2.  **准备攻击负载：** 攻击者将制作一个恶意的序列化数据包。此数据包利用React Server Components中的不安全反序列化漏洞，其中包含了攻击者希望在服务器上执行的任意代码（例如，反向Shell命令）。
3.  **发送恶意请求：** 利用该Nuclei模板，攻击者配置目标URL，然后发送包含恶意序列化负载的HTTP请求。为了增加成功率和绕过潜在的防御措施，请求头中的`Content-Type`参数可能会被尝试使用多种字符集编码（如POC中`charset`部分所示），以测试不同的WAF或服务器解析机制。
4.  **服务器执行代码：** 当目标服务器接收到这个恶意请求并尝试反序列化其内容时，由于存在不安全的反序列化漏洞，服务器将无意中执行攻击者注入的任意代码。
5.  **获取控制权：** 一旦代码成功执行，攻击者便可以在服务器上执行任意命令，包括但不限于获取反向Shell、数据窃取、部署恶意软件或进一步渗透内部网络，从而实现对服务器的完全控制。

**投毒风险分析：**
该POC是作为一个标准的Nuclei扫描模板提供的，由安全研究员`momika233`发布，并在GitHub等开源社区中共享。Nuclei模板本质上是文本配置文件，用于指导Nuclei引擎执行自动化扫描和漏洞检测任务，而非独立的可执行程序，因此其自身不具备恶意功能。

1.  **代码透明度：** Nuclei模板采用YAML格式，内容结构化且清晰可读。模板中没有出现任何形式的代码混淆、加密或难以理解的逻辑，所有操作意图都公开可见。这使得安全研究人员和用户可以轻松审查其内容，以确保其不包含恶意行为。
2.  **依赖项：** 该POC作为Nuclei模板，不引入任何外部可执行文件、恶意库或可疑的外部脚本。它完全依赖于Nuclei引擎及其内置的功能来构造和发送HTTP请求，并分析响应。
3.  **行为分析：** POC中的变量生成随机字符串和数字，这在渗透测试中是常见做法，用于避免缓存、生成唯一的请求ID或作为Payload的一部分。`batteringram`攻击模式结合多种`charset`参数是为了测试WAF绕过，属于典型的渗透测试技术，旨在评估不同编码方式对漏洞利用的影响，而非执行恶意操作。POC的核心功能是发送HTTP请求并解析服务器响应，而不是在运行POC的本地机器上执行任意的、非预期的代码。
4.  **执行环境：** Nuclei工具通常在受控的安全研究环境中使用，用户明确知道其功能是进行漏洞扫描。它不会在用户不知情的情况下在本地机器上安装后门或执行恶意代码。

综上所述，鉴于该POC的开源性质、透明且可审查的代码结构、以及其作为漏洞检测工具的明确用途，它对执行该POC的用户造成的投毒风险极低。该POC旨在帮助安全团队识别并修复其系统中的漏洞，而不是成为恶意传播的载体。因此，我们评估其投毒风险为10%。

**项目地址:** https://github.com/Chocapikk/CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
