## CVE-2025-55182 - React Server Components, react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack, Next.js Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** React Server Components, react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack, Next.js

**危害等级:** critical

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**影响版本:** 19.0.0, 19.1.0, 19.1.1, and 19.2.0

**利用条件:** 无需认证, 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182是一项针对React Server Components的严重远程代码执行（RCE）漏洞，影响版本包括19.0.0、19.1.0、19.1.1和19.2.0，以及依赖这些组件的框架，如Next.js。此漏洞源于Server Function端点在处理来自HTTP请求的payload时，存在不安全的序列化与反序列化问题。未经身份验证的攻击者可以利用此漏洞远程执行任意代码，无需任何认证，从而可能导致系统完全受控。其CVSS v3.1评分为满分10.0，且EPSS分数高达0.46718，EPSS百分位为0.97572，表明该漏洞的潜在利用概率极高。

**POC有效性分析:**
所提供的POC是一个高质量的Nuclei模板（CVE-2025-55182-Bypass-Waf.yaml），由安全研究员momika233编写。Nuclei模板因其结构化、可自动化和高可靠性而广泛应用于漏洞检测与验证。该模板的`info`部分详细描述了漏洞名称、作者、严重性、受影响产品及版本、潜在影响（未经认证的RCE导致系统完全受控）以及修复建议。它还列举了多条权威参考链接，包括GitHub漏洞仓库、Facebook安全公告、React官方博客、Vercel变更日志和oss-security邮件列表，这些都进一步证实了漏洞的真实性和关键性。在`classification`字段中，明确给出了CVSS v3.1向量（AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H）和满分10.0的CVSS分数，以及CWE-502（反序列化非受信任数据）的标识，这些都充分说明了漏洞的严重程度和技术细节。`metadata`部分标注`verified: true`，表明该POC已经过验证。`shodan-query`字段提供了基于Shodan识别潜在目标（如运行Next.js的系统）的方法，显示了POC的实战应用潜力。核心的`http`部分定义了`batteringram`攻击模式，这意味着它将对HTTP请求中的特定参数使用不同的payload进行迭代测试。特别是，`payloads`部分列举了大量的`charset`编码类型（如UTF-16LE、UTF-8、Windows代码页、ISO-8859扩展），这强烈暗示了POC旨在通过操纵HTTP `Content-Type`头中的编码声明，尝试绕过Web应用防火墙（WAF）或利用服务器在不同字符集解析上的差异，以成功传递恶意反序列化数据。`variables`字段定义了用于生成动态和随机内容的函数，如`rand_text_alphanumeric`和`rand_int`，这些随机值将用于构造唯一的请求ID、HTML内容以及一个巨大的`bypass_data`字符串（50000个字符），这些都是构建有效反序列化payload的关键组成部分，有助于避免静态检测和提高攻击成功率。`oast`标签的存在表明该POC使用带外应用安全测试（OAST）技术来验证RCE，即通过触发目标系统与攻击者控制的外部服务器进行交互（如DNS查询或HTTP请求）来确认代码执行的成功。综上所述，该POC是完全可用且高度可靠的，能够有效检测和利用CVE-2025-55182漏洞。

**利用步骤:**
1.  **安装Nuclei**: 首先，确保您的渗透测试环境中已安装Nuclei扫描器。
2.  **获取POC**: 将提供的YAML文件（`CVE-2025-55182-Bypass-Waf.yaml`）保存到本地。
3.  **目标识别**: 确定目标Web应用程序是否使用了受影响版本的React Server Components或Next.js。可以利用Nuclei模板中提供的`shodan-query: http.component:"Next.js"`在Shodan等搜索引擎中查找潜在目标。
4.  **配置OAST平台**: 为了验证远程代码执行，攻击者需要配置一个OAST平台（例如Interactsh）。当漏洞被成功利用时，目标服务器将向OAST平台发起一个回连请求，以此确认RCE的发生。
5.  **执行Nuclei**: 运行Nuclei扫描器并指定目标URL和POC模板文件。命令示例：`nuclei -t CVE-2025-55182-Bypass-Waf.yaml -u http://target.example.com -o rce_result.txt`。
6.  **构造恶意请求**: Nuclei模板将根据其`http`部分的定义，利用`batteringram`模式生成一系列HTTP请求。这些请求将在`Content-Type`头中使用多种`charset`编码组合，并集成动态生成的随机数据（如`request-id`、`bypass_data`等）。
7.  **触发反序列化**: 恶意构造的HTTP请求将被发送到目标应用程序的Server Function端点。目标服务器在处理这些请求时，由于存在不安全的反序列化漏洞，将错误地解析并执行其中包含的RCE gadget。
8.  **验证RCE**: 攻击者将监控Nuclei的输出以及OAST平台的回调记录。一旦RCE成功触发，OAST平台将收到来自目标服务器的回连请求（如DNS查询或HTTP请求），从而验证代码执行的成功。如果Nuclei配置了报告功能，它也将记录成功利用的信息。

**投毒风险分析:**
该POC为Nuclei模板，其主要功能是用于漏洞检测和利用，不包含恶意代码，因此自身的“投毒”风险极低。Nuclei模板采用人类可读的YAML格式，内容透明，未发现任何代码混淆、加密或恶意二进制文件嵌入。POC中的变量生成（如`rand_text_alphanumeric`）是为了增加payload的动态性、绕过WAF或进行模糊测试，而不是为了执行恶意操作。例如，`bypass_data`生成50000个随机字符的目的是测试数据长度或填充，不是传输有害内容。此POC的目的是帮助防御者和安全研究人员合法地验证系统是否存在漏洞，并模拟攻击以加强防御。它本身不会在运行POC的环境中引入后门、病毒或任何其他形式的恶意软件。然而，由于这是一个远程代码执行（RCE）的POC，其利用能力非常强大。如果被未经授权的人员或在非授权系统上滥用，可能导致目标系统的数据泄露、系统破坏、服务中断甚至被完全控制。因此，用户在使用此POC时必须严格遵守安全研究的伦理和法律规范，仅在获得明确授权的测试环境中进行，以避免任何意外的负面后果。POC工具本身是中立的，其风险主要取决于使用者的目的和操作的合法性。

**项目地址:** https://github.com/Chocapikk/CVE-2025-55182

**漏洞详情:** https://www.facebook.com/security/advisories/cve-2025-55182
