## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**影响版本:** 19.0.0, 19.1.0, 19.1.1, and 19.2.0 (包括react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack)

**利用条件:** 无需认证，需要网络访问，通过HTTP请求利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该Nuclei模板（CVE-2025-55182-Bypass-Waf.yaml）是一个专门针对React Server Components（RSC）中远程代码执行（RCE）漏洞（CVE-2025-55182）的探测和利用工具。根据POC的描述，此漏洞存在于React Server Components的多个版本中，具体为19.0.0、19.1.0、19.1.1和19.2.0，同时影响了相关的集成组件，如react-server-dom-parcel、react-server-dom-turbopack和react-server-dom-webpack。漏洞的根本原因在于对HTTP请求中发送到Server Function端点的payload进行了不安全的解序列化操作。这使得未经身份验证的攻击者能够远程执行任意代码，从而对受影响的系统造成严重威胁。POC明确指出利用此漏洞无需任何认证，且后果可能导致完整的系统控制。

模板采用了Nuclei的“batteringram”攻击模式，这意味着它会针对目标发送一系列精心构造的请求，其中包含不同的`charset`编码（例如utf-16le, utf-32, windows-1250等），旨在测试不同的解序列化路径或绕过潜在的Web应用防火墙（WAF）。这种策略增加了成功利用漏洞的可能性。模板中定义的变量，如`request-id`、`nextjs-html`、`bypass_data`和随机数计算，旨在生成动态且唯一的攻击载荷，避免静态特征被防御系统检测。

RCE的验证机制主要通过带外应用安全测试（OAST）来实现，这意味着当代码成功执行时，会触发一个外部请求到攻击者控制的OAST服务，从而确认漏洞的利用。`verified: true`的元数据和丰富的参考链接，包括Assetnote的`react2shell-scanner`项目、Facebook安全公告、React官方博客以及Next.js的安全通告，都强力证实了此漏洞的真实性、严重性和POC的有效性。Shodan查询条件`http.component:"Next.js"`进一步表明，使用Next.js框架且集成了受影响RSC版本的Web应用是该漏洞的主要攻击目标。总而言之，此POC提供了一个全面且高度有效的机制，用于识别和验证运行在React Server Components上的应用程序是否存在CVE-2025-55182漏洞。其自动化特性和清晰的漏洞描述使其成为防御者和攻击者都值得关注的重要工具。

**利用步骤**:
1. 确保已安装Nuclei扫描器。
2. 将提供的YAML文件保存为`CVE-2025-55182-Bypass-Waf.yaml`。
3. 使用Nuclei命令运行POC，例如：`nuclei -t CVE-2025-55182-Bypass-Waf.yaml -u http://target.com -o results.txt`。
4. Nuclei会向目标URL发送多个包含不同`charset`和恶意序列化数据的HTTP请求。
5. 如果目标系统存在漏洞，攻击者可以通过特定的反序列化payload触发远程代码执行。OAST服务将用于接收带外请求，从而验证代码是否成功执行。
6. 成功利用后，攻击者可以在目标服务器上执行任意命令，可能导致完全系统控制。

**投毒风险分析**:
该Nuclei模板（CVE-2025-55182-Bypass-Waf.yaml）作为一个漏洞利用和检测工具，其投毒风险评估为极低。以下是详细分析：

首先，**代码结构与可读性**是评估风险的关键因素。这个POC是一个Nuclei模板，采用YAML格式编写，这种格式是声明性的，而非命令式的，这意味着它主要用于定义攻击请求的结构、参数和验证规则，而不是直接执行复杂的程序逻辑。模板内容清晰、逻辑分明，不包含任何混淆、加密的代码，也没有使用难以理解的编码技巧。安全研究人员可以轻松审查其所有组件，包括请求头、Payload以及变量定义，以理解其预期行为。

其次，**依赖性**方面，该模板仅依赖于Nuclei扫描器本身的功能，例如HTTP请求模块、变量生成器和OAST集成。它不引入任何外部的、可疑的第三方脚本文件、动态链接库或编译后的二进制文件。这意味着攻击者无法通过在模板中嵌入恶意可执行代码来感染用户的系统。所有的操作都限制在Nuclei框架及其内置功能之内。

再者，**行为分析**显示，模板中定义的所有HTTP请求、payload生成和OAST验证机制都直接服务于CVE-2025-55182漏洞的探测和利用。例如，`bypass_data`变量填充的随机文本是为了构造反序列化漏洞所需的特定数据结构，并非传递恶意指令。`charset`的遍历也是为了测试不同编码下漏洞触发的可能性，这都是漏洞利用的合法手段。OAST是确认远程代码执行成功的标准方法，通过带外请求来验证命令是否被执行，这种机制本身是透明且可控的。没有迹象表明模板会尝试进行例如文件写入、下载恶意软件、连接未知C2服务器或进行未经授权的系统修改等非预期行为。

最后，**来源和上下文**也很重要。POC提供了丰富的参考链接，包括GitHub上的`assetnote/react2shell-scanner`项目和`Chocapikk/CVE-2025-55182`，以及官方的安全通告。这些都是可信的安全研究来源，进一步降低了模板被恶意篡改的风险。

综上所述，该Nuclei POC模板旨在合法地验证和利用一个高危的反序列化漏洞。它遵循安全工具的良好实践，代码透明，不包含任何外部依赖，且其行为完全符合漏洞探测和利用的目的。因此，可以认为其投毒风险非常低，用户可以相对安全地使用它来评估其系统的安全性。

**项目地址:** https://github.com/Chocapikk/CVE-2025-55182

**漏洞详情:** https://www.facebook.com/security/advisories/cve-2025-55182
