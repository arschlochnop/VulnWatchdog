## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal) / 目录穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal) / 目录穿越

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户需要下载并手动解压攻击者构造的恶意压缩文件，无需身份验证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码展示了如何利用Windows NTFS备用数据流 (ADS) 特性来绕过WinRAR的路径安全过滤机制。通过代码片段可见，它定义了RAR5文件签名，并试图定位本地环境中的rar.exe。其核心逻辑在于构造一个包含特殊ADS路径（如 'filename:stream'）的项目。在Windows文件系统中，若将此类路径与路径遍历字符（如 '../'）结合使用，WinRAR在解压处理时可能无法正确规范化目标路径。POC明确定义了目标路径为 'ProgramData\Microsoft\Windows\Start Menu\Programs\Startup'，这是典型的Windows自启动目录。当受害者使用受影响版本的WinRAR解压该恶意文件时，payload.exe 会被静默写入启动项，从而在下次登录时实现任意代码执行。由于代码引用了 struct 和 zlib 库来处理二进制流和校验，说明其具备生成功能性RAR报文的能力，具有极高的实战参考价值。【利用步骤】1. 攻击者准备一个恶意可执行文件作为Payload。2. 运行POC脚本，脚本会调用本地 rar.exe 或直接构造二进制流，创建一个特制的RAR压缩包。3. 脚本在压缩包内部文件头中注入带有 ADS 标识和 '../' 路径遍历序列的文件名。4. 攻击者通过社交工程手段（如电子邮件附件、虚假下载站）将压缩包发送给受害者。5. 受害者双击或点击‘解压到当前文件夹’，WinRAR将文件释放至预设的系统启动目录。6. 系统重启或用户重新登录，恶意程序自动运行。【投毒风险分析】该POC代码本身主要使用了Python标准库（os, pathlib, subprocess, struct, zlib），代码逻辑清晰，主要用于合法的漏洞研究和复现。风险在于其生成的RAR文件具有极强的迷惑性，且搜索结果提到该漏洞能规避部分EDR的沙盒检测。从POC源码看，虽然没有明显的混淆或反连接行为，但其自动寻找 'Startup' 目录的行为具有攻击性特征。投毒风险评定为15%，主要是针对该代码可能被非法改造为自动化武器化工具，而非代码本身携带后门。研究人员在运行此类脚本时，应在隔离环境（虚拟机）中操作，防止脚本误将测试Payload写入宿主机的自启动目录造成意外感染。此外，需警惕从非官方渠道下载的、经过混淆的此类漏洞利用脚本，因为该漏洞目前在野活跃度高，是网络犯罪分子投毒的热门模板。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
