## CVE-2025-8088 - WinRAR 路径遍历 / 目录穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 目录穿越 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** 7.12 及以下版本

**利用条件:** 诱导用户下载并解压经过特殊构造的恶意压缩包文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码展示了CVE-2025-8088漏洞的完整利用逻辑。漏洞的核心在于WinRAR处理Windows NTFS备用数据流（ADS）时的缺陷，结合路径遍历字符（如“../”），允许攻击者绕过常规的解压路径限制。POC代码通过Python脚本自动定位本地安装的rar.exe工具，并利用它作为底层引擎来构造特定的压缩包。代码中明确定义了目标路径为‘ProgramData\Microsoft\Windows\Start Menu\Programs\Startup’，这是典型的Windows启动项目录。通过利用ADS特性，POC能够将恶意载荷（payload）伪装成合法文件或隐藏在流中，并在用户解压时将其悄无声息地写入启动目录。经过审计，该POC在逻辑上是高度有效的，它通过修改RAR文件头中的属性标记位（如HFL_EXTRA和HFL_DATA）来实现对解压路径的重定向，完全符合该漏洞的技术特征。相比于之前的CVE-2025-6218，此漏洞利用ADS特性进一步增强了隐蔽性，能有效规避部分沙盒和EDR的安全检测。利用步骤如下：1. 编写或准备一个恶意可执行文件作为payload。2. 运行POC脚本，脚本会调用rar.exe创建一个基础RAR文件。3. 脚本在二进制层面修改RAR头信息，将解压路径指向系统启动目录。4. 将生成的恶意压缩包通过钓鱼邮件或社交工程手段发送给受害者。5. 只要受害者使用受影响版本的WinRAR进行解压，恶意文件就会被放置在启动项中。6. 受害者下次重启电脑时，恶意程序自动运行。【投毒风险分析】该POC代码主要使用了Python标准库（如os, pathlib, struct, zlib），代码逻辑清晰，主要行为集中在构造二进制文件结构。虽然脚本中包含了查找本地rar.exe并执行命令行调用的操作，但这属于漏洞构造的必要步骤。代码中没有发现明显的恶意代码混淆、未授权的网络连接或窃取本地敏感信息的行为。风险点主要在于其功能高度自动化，容易被不法分子直接包装成攻击工具。此外，POC脚本默认的目标路径是敏感的系统启动目录，这虽然证明了漏洞的危害，但也降低了将其转化为实际攻击的门槛。从防御研究角度看，该代码是安全的，但由于其具备“开箱即用”的特性，如果该脚本被分发到不受监管的开源平台，可能会被他人通过修改payload路径进行二次投毒。目前评估其投毒风险较低，主要风险源于攻击者利用该代码模板快速生成钓鱼附件。

**项目地址:** [https://github.com/vulnwatchdog/Cve_2025_8088](https://www.google.com/search?q=https://github.com/vulnwatchdog/Cve_2025_8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
