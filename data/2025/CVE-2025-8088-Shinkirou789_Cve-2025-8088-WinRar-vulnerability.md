## CVE-2025-8088 - WinRAR 路径遍历/目录遍历 (Path Traversal/Directory Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录遍历 (Path Traversal/Directory Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** WinRAR的Windows版本及相关组件（包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll），具体受影响版本范围未明确指出

**利用条件:** 需要用户解压恶意构造的RAR文件

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
所提供的Python POC，`Cve_2025_8088.py`，是针对WinRAR中CVE-2025-8088目录遍历漏洞的强大且结构良好的利用代码。该脚本利用Windows NTFS备用数据流（ADS）特性，结合路径遍历技术，绕过WinRAR的文件验证机制，从而将任意文件写入到敏感位置。

核心逻辑位于`_crear_exploit_ads`方法中。此方法首先定位系统上的`rar.exe`可执行文件。然后，它接收`ruta_payload`（要放置的恶意文件）和`ruta_salida`（最终恶意.rar档案的名称）作为输入。脚本为payload构造了一个目标目录路径，特别指向`ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`。将文件放入此目录可确保payload（例如，可执行文件或脚本）在Windows启动时自动运行，从而实现具有持久性的任意代码执行。

脚本的主要机制是使用合法的`rar.exe`实用程序创建一个基础RAR档案，然后手动修改此档案的头部信息。此修改过程至关重要：它注入了特制的包含目录遍历序列（例如，`..\..\`）和NTFS ADS（例如，`filename:stream`）的文件路径，以确保当WinRAR解压档案时，恶意文件被写入到`Startup`文件夹，从而覆盖用户指定的解压路径。该POC展示了对RAR文件格式和底层Windows文件系统机制（ADS）的深刻理解，这对于绕过WinRAR的安全检查至关重要。`struct`和`zlib`的使用表明了对档案二进制结构的直接操作。

利用步骤:
1.  **准备Payload**: 攻击者首先准备一个恶意文件（例如，一个可执行文件、批处理脚本或LNK文件），这将作为“payload”在目标系统上执行。
2.  **创建恶意RAR文件**: 攻击者使用类似本POC的工具，将准备好的payload作为输入，生成一个特制的RAR压缩文件。这个RAR文件中包含了一个伪装的文件名和路径，但实际的文件路径被精心构造，利用目录遍历和ADS技术指向系统启动目录。
3.  **社会工程学诱骗**: 攻击者通过鱼叉式网络钓鱼邮件或其他社交工程手段，将这个恶意RAR文件发送给目标用户。邮件内容通常会结合地缘政治、经济或其他敏感话题作为诱饵，诱导用户打开并解压附件。
4.  **用户解压**: 目标用户在不察觉的情况下，使用WinRAR解压了这个恶意RAR文件。由于WinRAR的漏洞，payload被悄无声息地写入到系统启动目录（例如，`C:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startup`）。
5.  **代码执行与持久化**: 用户下次重启计算机或登录系统时，位于启动目录的恶意payload会自动执行，从而赋予攻击者在受害者系统上的任意代码执行能力和持久化访问。

投毒风险分析:
本POC代码（`Cve_2025_8088.py`）的投毒风险极低，评分为10%。其主要原因如下：
1.  **目的明确**: 该代码的唯一目的是为了演示WinRAR的CVE-2025-8088漏洞的利用方式，即生成一个恶意的RAR文件。它本身并不包含任何恶意负载或执行恶意行为。
2.  **代码清晰度高**: 代码结构清晰，逻辑分明，使用了Python的标准库，没有发现代码混淆、加密或不透明的外部调用。所有操作都直接围绕RAR文件的构造和路径遍历漏洞的利用。
3.  **无内置恶意功能**: 脚本的核心功能是 `_crear_archivo_malicioso` 和 `_crear_exploit_ads`，它们负责将用户指定的 `ruta_payload`（payload文件）嵌入到生成的恶意RAR文件中。脚本本身并不提供这个 `ruta_payload`，也未包含任何内置的后门程序、病毒代码或信息窃取功能。
4.  **依赖外部RAR工具**: POC通过 `subprocess` 调用合法的 `rar.exe` 工具来创建基础RAR文件，而不是从零开始构建RAR文件，这进一步降低了其作为投毒工具的可能性。
5.  **无网络通信或敏感数据窃取**: 脚本中没有发现任何与外部服务器进行通信、下载额外组件或窃取本地敏感数据的代码。

如果防御者或研究人员下载并运行了未经验证的、声称是针对此漏洞的POC代码，尤其是在非隔离环境中，那么他们可能会面临风险。然而，本特定的Python脚本是设计用来 *生成* 恶意RAR文件，而不是 *作为* 恶意RAR文件。它明确地接受一个用户定义的`payload`路径作为输入，这意味着任何恶意行为都将源于用户提供的`payload`，而非脚本本身。因此，在评估本POC的投毒风险时，我们主要关注其自身代码的安全性，而不是利用其生成的恶意RAR文件的潜在危害。

此外，尽管此POC代码本身是干净的，但在现实世界中，声称是漏洞利用代码的恶意文件并不少见。攻击者可能会将真实的POC代码与恶意负载捆绑，或者在公开的POC中植入后门。因此，任何下载和使用公开POC代码的研究人员都应始终在隔离环境中进行，并仔细审查代码，警惕任何可疑的网络请求、文件写入或系统命令执行。特别需要警惕那些使用混淆技术、包含难以理解的二进制数据或尝试从外部URL下载内容的POC。然而，本POC代码的透明度和对标准库的依赖性，以及其明确的设计目的（生成而不是成为恶意文件），使其在此方面的风险保持在较低水平。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
