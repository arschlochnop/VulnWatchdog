## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 and older EOL versions

**利用条件:** Server must allow PUT requests to a writable directory (e.g., /uploads/../sessions/) and process the uploaded session file, triggering deserialization.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞源于不正确处理上传的会话文件和反序列化机制。攻击者通过向可写目录（如`/uploads/../sessions/`）上传恶意序列化payload，可以触发反序列化，从而在目标服务器上执行任意命令。该PoC利用了Tomcat的PUT方法和会话管理机制中的缺陷。

**POC有效性分析：**
该PoC的有效性取决于目标Tomcat服务器是否满足以下条件：
1. 运行易受攻击的Apache Tomcat版本。
2. 允许PUT请求到可写目录（例如，`/uploads/../sessions/`）。
3. 服务器必须处理上传的会话文件（例如，通过对`/index.jsp`的GET请求），并触发payload的反序列化。
如果满足这些条件，该PoC可以成功地在目标服务器上执行任意代码。

**利用步骤：**
1. 检查目标服务器是否允许通过PUT请求写入文件。
2. 生成恶意序列化payload（例如，使用`ysoserial`）。
3. 将payload上传到服务器上的可写目录，例如`/uploads/../sessions/<session_id>.session`。
4. 触发payload的反序列化，通常通过访问一个JSP页面，该页面会尝试加载上传的会话文件。
5. 成功利用后，服务器将执行payload中包含的任意代码。

**缓解措施：**
1. 升级到已修复漏洞的Apache Tomcat版本。
2. 禁用或限制PUT请求到敏感目录。
3. 实施严格的输入验证和清理，以防止恶意payload上传。
4. 使用Web应用程序防火墙（WAF）来检测和阻止利用尝试。

**投毒风险分析：**
该PoC的投毒风险较低，因为其主要功能是利用已知的安全漏洞，而不是执行恶意操作。PoC代码本身相对清晰，使用了标准的Python库，没有发现混淆或可疑的外部脚本。但是，攻击者可能会修改payload生成部分，以包含恶意代码，从而增加投毒风险。例如，攻击者可以将payload替换为下载和执行任意代码的payload。该PoC创建的文件payload.ser 具有潜在的风险，如果payload来自不受信任的源，则可能会被篡改以包含恶意代码。payload上传的路径/uploads/../sessions/ 也需要仔细审查，确保没有其他恶意文件的上传。

总的来说，CVE-2025-24813 PoC本身具有较低的投毒风险，但用户在使用时应保持警惕，并确保从可信来源获取PoC代码。

**项目地址:** https://github.com/whoisdxm/CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
