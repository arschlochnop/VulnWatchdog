## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 19.0.0, 19.1.0, 19.1.1, and 19.2.0

**利用条件:** Unauthenticated remote access

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 20%

## 详情

CVE-2025-55182 (React2Shell) is a critical Remote Code Execution (RCE) vulnerability affecting React Server Components (RSC) in React 19.x and frameworks like Next.js. The vulnerability lies in unsafe deserialization of "Flight" protocol chunks, allowing attackers to inject malicious structures that resolve into the Function constructor, resulting in arbitrary JavaScript execution on the server. The vulnerability exists because React's Flight protocol deserialization logic does not properly validate the structure of incoming data chunks. An attacker can craft malicious chunks containing prototype accessors, fake promise-like objects (`thenables`), and keys referencing the prototype chain to expose the Function constructor. During deserialization, React interprets the malicious object as a thenable and attempts to call its `then` method. However, the `then` method is actually the Function constructor, resulting in arbitrary JavaScript execution. This vulnerability can be triggered by sending a specially crafted multipart/form-data request to a vulnerable React Server Function endpoint. The PoC code demonstrates the exploit by injecting a payload that executes arbitrary JavaScript on the server. The PoC is effective against default configurations and requires no authentication. The vulnerability allows an unauthenticated attacker to send a specially crafted request to an RSC "Server Function" endpoint and potentially execute arbitrary code on the server.

**Exploit Steps:**
1. Craft a malicious Flight protocol chunk containing prototype accessors, fake promise-like objects, and keys referencing the prototype chain to expose the Function constructor.
2. Send the malicious chunk as part of a multipart/form-data request to a vulnerable React Server Function endpoint.
3. The React server deserializes the malicious chunk, leading to the execution of the Function constructor with an attacker-controlled payload.

**Poisoning Risk Analysis:**
The provided PoC code primarily focuses on demonstrating the RCE vulnerability. The risk of supply chain poisoning is relatively low because the exploit itself is self-contained and does not rely on external scripts or dependencies. However, there are some considerations. The exploit involves crafting malicious data structures that are injected into the deserialization process. While the immediate impact is RCE, there is a slight risk that an attacker could modify the payload to include code that attempts to tamper with application state or data. This could be used to inject backdoors or compromise other parts of the application. The PoC code is relatively clear and uses standard JavaScript constructs. There are no signs of obfuscation or malicious intent within the exploit code itself. However, it is essential to be cautious when using any exploit code in a production environment. Always thoroughly review and test the code before deploying it. It is important to apply the recommended mitigations to prevent exploitation of this vulnerability. The primary mitigation is to update React to version 19.2.1 or later, or upgrade Next.js to a patched version. Additionally, consider implementing input validation and sanitization to prevent malicious data from being deserialized.
 The poisoning risk is estimated at 20% due to the potential for payload modification, which could be used to inject malicious code into other parts of the application. However, the PoC code itself is relatively clean and does not exhibit signs of malicious intent.

**项目地址:** https://github.com/user-attachments/assets/ec6ff558-f743-452d-ad29-2df777d4ca30

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
