# CVE-2025-49844

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-49844-Ashwesker_Blackash-CVE-2025-49844.md](../2025/CVE-2025-49844-Ashwesker_Blackash-CVE-2025-49844.md)

## CVE-2025-49844-Redis-RediShell-RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free / RCE

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行和主机完全控制

**影响版本:** < 8.2.2

**利用条件:** 需要 Redis 实例开启 Lua 脚本功能，并具有执行 EVAL 或 EVALSHA 命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 use-after-free 漏洞，被称为 RediShell。攻击者可以利用该漏洞，通过构造特制的 Lua 脚本，操纵垃圾回收器，触发 use-after-free 错误，最终实现沙箱逃逸和远程代码执行，完全控制 Redis 主机。

**有效性：**

提供的 README.md 文件详细描述了漏洞信息、影响范围、利用方式和缓解措施，并给出了检测和验证的命令示例。虽然没有提供具体的 Lua 脚本PoC，但文档清晰地说明了该漏洞已公开，并且存在可利用的PoC，说明该漏洞是有效的，可以被利用。

**投毒风险：**

提供的漏洞利用代码（README.md）本身不包含恶意代码或后门，更多的是漏洞的描述、缓解措施和检测方法。虽然文档中也提到可能存在 active scanning，但并未直接提供任何可执行的漏洞利用程序，因此投毒的概率较低。但是不能完全排除作者在其他地方发布了包含投毒代码的PoC，或者攻击者修改该README.md后进行传播。所以，谨慎估计投毒风险为 10%。

**利用方式：**

1.  **攻击者需要具有 Redis 的认证访问权限。** 如果 Redis 没有设置密码或使用了弱密码，则攻击者可以直接连接到 Redis 实例。
2.  **攻击者使用 EVAL 或 EVALSHA 命令执行恶意的 Lua 脚本。** 该 Lua 脚本会精心构造，利用 Lua 垃圾回收机制中的缺陷，触发 use-after-free 漏洞。
3.  **成功触发 use-after-free 漏洞后，攻击者可以实现沙箱逃逸，执行任意本地代码。**
4.  **攻击者利用执行本地代码的能力，完全控制 Redis 主机，进行数据窃取、篡改或拒绝服务攻击。**


**项目地址:** [Ashwesker/Blackash-CVE-2025-49844](https://github.com/Ashwesker/Blackash-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #2

**来源**: [CVE-2025-49844-B1ack4sh_Blackash-CVE-2025-49844.md](../2025/CVE-2025-49844-B1ack4sh_Blackash-CVE-2025-49844.md)

## CVE-2025-49844-Redis-Lua-Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis Lua脚本功能开启，攻击者需具有执行Lua脚本的权限（ACL限制允许）

**POC 可用性:** 否

**投毒风险:** 5%

## 详情

CVE-2025-49844是Redis中Lua脚本引擎存在的一个使用后释放漏洞。攻击者可以通过构造恶意的Lua脚本来操纵垃圾回收器，触发use-after-free，从而导致远程代码执行。漏洞影响版本小于8.2.2。缓解措施包括升级到8.2.2或更高版本，或者使用ACL来限制EVAL和EVALSHA命令，从而禁用Lua脚本的执行。

**有效性分析：**
漏洞库信息表明此漏洞是真实存在的，且危害等级为CRITICAL。POC代码仅仅是一个README.md文件，没有任何实际利用代码，无法直接验证漏洞的有效性。因此，目前POC的有效性无法确认。

**投毒风险分析：**
提供的POC代码只有一个README.md文件，内容非常简单，只包含CVE编号，不包含任何可执行代码，因此投毒的概率极低。可以认为存在极小的投毒风险（例如，未来作者可能会添加恶意代码）。

**利用方式：**
1.  攻击者需要连接到Redis服务器。
2.  攻击者需要具有执行Lua脚本的权限。默认情况下，如果没有设置ACL，所有用户都可以执行Lua脚本。
3.  攻击者需要构造一个恶意的Lua脚本，该脚本可以操纵垃圾回收器并触发use-after-free。
4.  成功利用该漏洞后，攻击者可以在Redis服务器上执行任意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-49844](https://github.com/B1ack4sh/Blackash-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #3

**来源**: [CVE-2025-49844-MiclelsonCN_CVE-2025-49844_POC.md](../2025/CVE-2025-49844-MiclelsonCN_CVE-2025-49844_POC.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要已认证的Redis用户，并且Lua脚本已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Redis的Lua脚本解释器中。攻击者可以利用特制的Lua脚本来操纵垃圾回收器，从而触发use-after-free漏洞，最终可能导致远程代码执行。漏洞利用需要先连接到Redis实例，然后执行恶意的Lua脚本。PoC代码提供了基础的UAF触发、沙箱逃逸和内存破坏的演示，但实际利用可能更复杂，涉及精确的堆操作。关于投毒风险，代码中存在使用`redis.log`函数，虽然在PoC验证过程中起到了日志记录的作用，但实际生产环境中可能被滥用，监控日志是重点，但是整体PoC代码清晰，注释完整，投毒可能性低。

**项目地址:** [MiclelsonCN/CVE-2025-49844_POC](https://github.com/MiclelsonCN/CVE-2025-49844_POC)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #4

**来源**: [CVE-2025-49844-Mufti22_CVE-2025-49844-RediShell-Vulnerability-Scanner.md](../2025/CVE-2025-49844-Mufti22_CVE-2025-49844-RediShell-Vulnerability-Scanner.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，且攻击者具有执行EVAL或EVALSHA命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。攻击者可以通过精心构造的 Lua 脚本，操纵垃圾回收器，在对象释放后再次访问该对象，从而可能导致远程代码执行。

**有效性评估：**

提供的 POC 代码是一个漏洞检测脚本，而不是直接的漏洞利用代码。该脚本首先连接到 Redis 服务器，检查 Redis 版本，并验证 Lua 脚本是否已启用。然后它尝试通过执行一个测试性的 Lua 脚本来确认 Lua 脚本功能是否正常工作，并探测是否存在UAF模式。漏洞利用的有效性取决于目标 Redis 服务器的版本和配置。

**投毒风险评估：**

分析提供的 Redis 漏洞检测脚本，发现其中存在潜在的投毒风险的可能性较低。虽然脚本的目的是检测 Redis 服务器是否存在 CVE-2025-49844 漏洞，但漏洞本身利用了 Lua 脚本的 use-after-free 漏洞，存在通过构造恶意的Lua脚本进行RCE的可能性。 脚本自身主要用于检测，但最终目的是为了方便漏洞利用，因此，认为存在 10% 的投毒风险。

**利用方式分析：**

1.  **漏洞触发：** 攻击者需要向 Redis 服务器发送包含恶意 Lua 脚本的 EVAL 或 EVALSHA 命令。
2.  **UAF 触发：** 恶意 Lua 脚本通过操纵 Redis 的垃圾回收机制，触发 Use-After-Free 漏洞。
3.  **RCE：** 成功触发 UAF 后，攻击者可以进一步利用该漏洞，实现远程代码执行。具体步骤通常涉及内存布局的控制和代码注入等技术。

**缓解措施：**

*   升级到 Redis 8.2.2 或更高版本。
*   禁用 Lua 脚本功能 (如果不需要该功能)。
*   使用 ACL 限制 EVAL 和 EVALSHA 命令的执行权限。


**项目地址:** [Mufti22/CVE-2025-49844-RediShell-Vulnerability-Scanner](https://github.com/Mufti22/CVE-2025-49844-RediShell-Vulnerability-Scanner)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #5

**来源**: [CVE-2025-49844-Network-Sec_CVE-2025-49844-RediShell-AI-made-Revshell.md](../2025/CVE-2025-49844-Network-Sec_CVE-2025-49844-RediShell-AI-made-Revshell.md)

## CVE-2025-49844 Redis Lua Use-After-Free / CVE-2025-62507 Redis XACKDEL Stack Overflow

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free / Stack Overflow

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要已认证用户权限和网络访问Redis服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-49844 描述了 Redis 在 Lua 脚本处理中存在 Use-After-Free 漏洞，攻击者通过精心构造的 Lua 脚本，可操纵垃圾回收器，触发该漏洞，可能导致远程代码执行。修复版本为 8.2.2。缓解措施包括限制用户执行 Lua 脚本的权限。

搜索引擎结果为空，但提供了漏洞利用代码和相关文档。该文档提及了 CVE-2025-62507，并指出该漏洞（Redis `XACKDEL` 命令中的栈溢出）是比 Use-After-Free (CVE-2025-49844) 更简单的 RCE 利用方式，并提供了exp。

POC代码 (`CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py`) 利用 Redis 的 `XACKDEL` 命令处理 stream ID 时的栈溢出漏洞。该脚本首先建立与 Redis 服务的连接，然后创建一个 stream 和 consumer group。接着，脚本构造一个包含大量 stream ID 的 `XACKDEL` 命令，这些 stream ID 的长度经过精心设计，可以溢出栈缓冲区。`NUM_IDS_TO_SEND` 设置为大于 8 的值，确保溢出到重要的栈数据上。脚本发送该命令后，Redis 服务器预计会崩溃。

**有效性：**
根据 README 文档和 POC 代码分析，POC 脚本 `CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py` 可以触发 Redis 服务器的崩溃，表明该 POC 代码在一定程度上是有效的。README 提到已经成功触发了崩溃。因此，该漏洞的利用是有效的。

**投毒风险：**
考虑到以下因素，投毒风险较低：
*   代码相对简单，主要功能是构造并发送恶意 `XACKDEL` 命令。
*   代码使用了 `pwn` 库，但其使用方式是标准用法，未发现任何异常操作。
*   README 文件中描述了作者的测试过程和遇到的问题，没有发现任何恶意代码或意图。
*   代码文件都是文本文件，没有发现隐藏的二进制文件或混淆的代码。

综合分析，认为该仓库存在恶意投毒代码的可能性较低，大约为 5%。虽然存在风险，但从代码本身来看，没有明显的投毒迹象。

**利用方式：**
1.  攻击者需要能够连接到 Redis 服务。
2.  攻击者需要至少具有可以执行 `XGROUP CREATE` 和 `XACKDEL` 命令的权限，也就是需要认证。
3.  攻击者利用脚本构造包含超长 stream ID 的 `XACKDEL` 命令，触发栈溢出。
4.  攻击可能导致 Redis 服务崩溃或被远程代码执行（尽管 README 提到 RCE 实现比较困难）。

**项目地址:** [Network-Sec/CVE-2025-49844-RediShell-AI-made-Revshell](https://github.com/Network-Sec/CVE-2025-49844-RediShell-AI-made-Revshell)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #6

**来源**: [CVE-2025-49844-YuanBenSir_CVE-2025-49844_POC.md](../2025/CVE-2025-49844-YuanBenSir_CVE-2025-49844_POC.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器启用Lua脚本功能，且攻击者具有执行Lua脚本的权限（通常需要已认证的用户身份）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844 漏洞是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。攻击者可以利用精心构造的 Lua 脚本来操作垃圾回收器，从而触发 Use-After-Free 漏洞，最终可能导致远程代码执行。

**有效性：**
根据漏洞描述，只要 Redis 服务器版本低于 8.2.2，并且启用了 Lua 脚本功能，就可能受到攻击。攻击者需要具有执行 Lua 脚本的权限。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache License 的文本内容，没有发现任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要向 Redis 服务器发送包含恶意 Lua 脚本的 EVAL 或 EVALSHA 命令。
2.  **内存操作：** 恶意 Lua 脚本会尝试操作 Redis 的垃圾回收器，例如释放已经释放的内存。
3.  **Use-After-Free：** 攻击者通过特定的 Lua 脚本，控制内存释放和访问，触发 Use-After-Free 漏洞。
4.  **远程代码执行：** 进一步利用 Use-After-Free 漏洞，通过内存布局和函数指针覆盖等技术，最终实现远程代码执行。

**总结：**
该漏洞危害性极高，可能导致 Redis 服务器被完全控制。修复方法是升级到 Redis 8.2.2 或更高版本，或者使用 ACL 限制 EVAL 和 EVALSHA 命令的执行，从而禁用 Lua 脚本功能。

**项目地址:** [YuanBenSir/CVE-2025-49844_POC](https://github.com/YuanBenSir/CVE-2025-49844_POC)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #7

**来源**: [CVE-2025-49844-Yuri08loveElaina_CVE-2025-49844.md](../2025/CVE-2025-49844-Yuri08loveElaina_CVE-2025-49844.md)

## CVE-2025-49844 - Redis Lua Interpreter UAF

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本支持，并具有执行EVAL/EVALSHA命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是 Redis 中 Lua 解释器存在的一个 Use-After-Free 漏洞。未经授权的用户可以通过构造特制的 Lua 脚本来操作垃圾回收器，触发 UAF 漏洞，最终可能导致远程代码执行。

**有效性：**
提供的漏洞利用代码（redis_exploit.py）看起来较为完整，包含初始化、连接、版本检测、架构检测、堆喷射、UAF对象创建、内存泄漏、ROP链构造和Shellcode执行等多个阶段。其README.md 也描述了利用流程以及需要的参数。总体来看，此PoC 有效的可能性较高，具体取决于目标环境和Redis配置。

**投毒风险：**
在分析提供的漏洞利用代码片段中，虽然没有发现明显的恶意代码或后门植入行为，但考虑到完整代码未完全提供，仍存在一定的投毒风险。可能的风险点包括：
*   **Shellcode的来源与功能：** exploit.py 中使用了 shellcode，如果shellcode的功能被篡改，可能会导致恶意行为。虽然给出了reverse shell的功能，如果shellcode的功能被篡改，可能会导致恶意行为。
*   **依赖库风险：**  `requirements.txt` 中指定的依赖库，如果被替换为恶意版本，可能导致安全问题。
综合来看，投毒风险评估为 10%。这是一个经验判断，因为在部分代码的情况下无法进行完整分析。

**利用方式：**
该漏洞的利用方式如下：
1.  **连接目标Redis服务器：**  使用 redis 客户端连接到目标服务器。
2.  **版本检测：**  检测 Redis 服务器的版本，确认其是否受漏洞影响。
3.  **架构检测：**  确定目标系统的架构（x86/x64），以便选择合适的 Shellcode 和 ROP gadgets。
4.  **堆喷射：**  进行堆喷射，在内存中填充大量数据，提高漏洞利用的可靠性。
5.  **UAF对象创建：**  创建用于触发 Use-After-Free 漏洞的对象。
6.  **内存泄漏：**  泄漏内存地址，绕过地址空间布局随机化 (ASLR)。
7.  **ROP链构造：**  构造 Return-Oriented Programming (ROP) 链，绕过数据执行保护 (DEP/NX)。
8.  **Shellcode执行：**  执行 Shellcode，实现任意代码执行。通常用于建立反向Shell或执行其他恶意操作。
9.  **持久化（可选）：** 尝试建立持久化后门，以便长期控制目标系统。

**项目地址:** [Yuri08loveElaina/CVE-2025-49844](https://github.com/Yuri08loveElaina/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #8

**来源**: [CVE-2025-49844-Zain3311_CVE-2025-49844.md](../2025/CVE-2025-49844-Zain3311_CVE-2025-49844.md)

## CVE-2025-49844 Redis Lua UAF 远程代码执行漏洞 (RediShell)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free (UAF) 远程代码执行

**影响应用:** Redis

**危害等级:** 高危，CVSS 10.0，可能导致远程代码执行

**影响版本:** 影响所有支持Lua脚本的版本 (包括6.x-8.x全分支)

**利用条件:** 需要低权限及以上用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索引擎结果，CVE-2025-49844 是 Redis 数据库的一个 Use-After-Free 漏洞，存在于 Lua 脚本执行模块中，CVSS 评分为 10.0，影响所有支持 Lua 脚本的版本。漏洞允许拥有低权限及以上用户权限的攻击者执行远程代码。搜索结果链接 5 指向了一个名为 RediShell 的 GitHub 存储库，其中包含 CVE-2025-49844 的利用代码。

提供的代码片段看起来像是 Visual Studio 的项目文件，项目名称为 'DesiShop'，使用 C# 和 .NET 5.0 构建 Web 应用程序，包含 JWT 身份验证。 **虽然项目名为DesiShop，但是根据以往的经验和漏洞信息，此项目本身并不是 Redis 的漏洞利用程序，更像是用来搭建一个WEB环境的示例代码。它更有可能是攻击者在成功利用 Redis UAF 漏洞后部署的后门或者webshell,从而达到控制服务器的目的。**

由于提供的代码片段是 Visual Studio 项目文件，并非 Redis 利用代码本身，因此无法直接评估其漏洞利用的有效性。必须结合针对 CVE-2025-49844 的 RediShell 利用代码（来自链接 5）才能完整评估利用链。

**投毒风险分析：**

提供的代码片段是标准的 .NET Web 应用程序项目文件，没有明显的恶意代码。该项目使用了一些常见的 NuGet 包，例如 JWT 身份验证、Newtonsoft.Json 和 Swagger。因此，直接从这段代码中判断出存在投毒代码的风险较低。考虑到它可能是成功利用Redis漏洞后的部署的后门，故判定投毒风险为0%。

**利用方式：**

1.  攻击者利用 CVE-2025-49844 Redis Lua UAF 漏洞 (RediShell) 在目标 Redis 服务器上执行任意代码。
2.  执行的代码可能用于部署恶意 Web 应用程序 (DesiShop)，充当后门或 WebShell。
3.  攻击者通过部署的 Web 应用程序来控制服务器，例如窃取数据、执行系统命令等。

**项目地址:** [Zain3311/CVE-2025-49844](https://github.com/Zain3311/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #9

**来源**: [CVE-2025-49844-angelusrivera_CVE-2025-49844.md](../2025/CVE-2025-49844-angelusrivera_CVE-2025-49844.md)

## CVE-2025-49844 Redis Lua Use-After-Free 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，并且攻击者能够执行Lua脚本（通过 EVAL 或 EVALSHA 命令）。需要较低权限即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 漏洞是 Redis 在处理 Lua 脚本时出现的 use-after-free 漏洞。具体来说，当 Redis 服务器允许执行 Lua 脚本时，攻击者可以利用精心构造的 Lua 脚本来操纵 Redis 的垃圾回收器，从而触发 use-after-free 漏洞，并最终导致远程代码执行。

**漏洞利用方式：**

1.  **攻击目标：** 针对 Redis 的 Lua 脚本系统，尤其是 `EVAL` 和 `EVALSHA` 命令。
2.  **攻击步骤：**
    *   攻击者首先需要能够连接到 Redis 服务器，并且拥有执行 Lua 脚本的权限。
    *   然后，攻击者发送包含恶意代码的 Lua 脚本到 Redis 服务器。
    *   恶意 Lua 脚本会利用 Redis 的内存管理机制中的缺陷，特别是垃圾回收器。
    *   通过操纵垃圾回收器，攻击者可以释放已被使用的内存，然后再次尝试访问该内存。
    *   这会导致 use-after-free 漏洞，并允许攻击者覆盖内存中的数据，最终执行任意代码。

**POC有效性评估：**

提供的 POC 代码是一个 Redis 漏洞扫描器，用于检查 Redis 服务器是否存在 CVE-2025-49844 漏洞。该代码通过编译 `redis-scanner.go` 文件生成一个名为 `rscan` 的可执行文件，然后可以使用不同的参数来扫描 Redis 服务器。例如，它可以检查单个服务器、使用密码验证的服务器、多个服务器或从文件中读取的主机列表。如果 Redis 服务器版本低于 8.2.2 并且 Lua 脚本已启用，则扫描器会报告服务器存在漏洞。

**投毒风险评估：**

该 POC 代码的主要功能是扫描 Redis 服务器是否存在漏洞，并提供修复建议。但是，存在少量潜在的投毒风险，原因是攻击者可能在扫描器中植入恶意代码，例如：

*   **信息收集：** 扫描器可能会收集 Redis 服务器的相关信息（例如版本、配置等），并将这些信息发送到攻击者的服务器。
*   **后门植入：** 扫描器可能会尝试在 Redis 服务器上植入后门，以便攻击者可以长期控制该服务器。
*   **拒绝服务攻击：** 扫描器可能会发送大量的请求到 Redis 服务器，从而导致拒绝服务攻击。
*   **依赖包污染:** `go mod tidy` 存在依赖包污染的可能性.

尽管存在这些风险，但总体来说，该 POC 代码的投毒风险相对较低，因为它的主要目的是帮助用户检测和修复漏洞。 风险占比10%。

总之，该漏洞的利用方式是利用 Lua 脚本操纵 Redis 的内存管理机制，触发 use-after-free 漏洞，并最终导致远程代码执行。提供的扫描器用于检测是否存在此漏洞，并存在一定的低概率投毒风险。

**项目地址:** [angelusrivera/CVE-2025-49844](https://github.com/angelusrivera/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #10

**来源**: [CVE-2025-49844-dwisiswant0_CVE-2025-49844.md](../2025/CVE-2025-49844-dwisiswant0_CVE-2025-49844.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要能够执行Lua脚本的Redis权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。该漏洞允许经过身份验证的用户使用特制的 Lua 脚本来操纵垃圾收集器，触发释放后使用，并可能导致远程代码执行。漏洞存在于所有具有 Lua 脚本功能的 Redis 版本中，直到 8.2.2 版本修复。 

**有效性：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC 代码通过精心构造 Lua 脚本，利用 Redis 在解析 Lua 脚本时垃圾回收机制的竞争条件。该脚本创建带有 `__gc` 元方法的代理对象，该方法在垃圾回收时被调用，并尝试再次触发垃圾回收，从而导致 Use-After-Free。重复执行该脚本会导致 Redis 服务崩溃或连接断开，证明了漏洞的可利用性。

**投毒风险：**
通过分析提供的 POC 代码，未发现任何明显的投毒代码。该代码的目标是利用 Redis 本身的漏洞，而不是植入恶意代码。代码逻辑主要集中在触发漏洞本身，没有额外的恶意行为。因此，该仓库中存在作者隐藏的投毒代码的可能性较低 (0%)。

**利用方式：**
利用方式如下：
1.  攻击者需要具有执行 Lua 脚本的 Redis 权限（通常需要身份验证）。
2.  攻击者使用 `redis-cli` 工具执行 `CVE-2025-49844.lua` 脚本。脚本通过 `loadstring` 函数加载包含大量注释的 Lua 代码块，并使用带有 `__gc` 元方法的代理对象作为 chunk 名称。
3.  当 Lua 脚本解析器运行时，代理对象的 `__gc` 元方法会在垃圾回收期间被调用。这个元方法会再次触发垃圾回收，导致解析器中使用的 chunk 名称字符串被释放。
4.  解析器随后尝试访问已释放的 chunk 名称字符串，从而触发 Use-After-Free 漏洞。
5.  重复执行该脚本会增加触发漏洞的概率，最终导致 Redis 服务崩溃或允许远程代码执行。

**缓解措施：**
1.  升级到 Redis 8.2.2 或更高版本，该版本已修复此漏洞。
2.  限制不受信任的用户执行 Lua 脚本的能力，可以通过 ACL 限制 `EVAL` 和 `EVALSHA` 命令。

**项目地址:** [dwisiswant0/CVE-2025-49844](https://github.com/dwisiswant0/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #11

**来源**: [CVE-2025-49844-elyasbassir_CVE-2025-49844.md](../2025/CVE-2025-49844-elyasbassir_CVE-2025-49844.md)

## CVE-2025-49844 - Redis Lua Use-After-Free 导致远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本支持，攻击者需具备低权限用户账号

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Redis的Lua脚本解析器中。攻击者可以利用精心构造的Lua脚本，操纵垃圾回收器，触发释放后使用（Use-After-Free）漏洞，从而可能导致远程代码执行。

**有效性评估：**
提供的POC代码尝试通过创建大量Lua对象并强制进行垃圾回收，从而触发漏洞。具体来说，它定义了一个 `make_chunk_name` 函数，该函数创建一个带有 `__gc` 元方法的代理对象。当该代理对象被垃圾回收时，`__gc` 元方法会被调用，并在此时再次调用 `collectgarbage('collect')`，这可能导致在 Lua 脚本解析器仍在持有chunk name字符串时就进行垃圾回收。该操作可能会导致程序崩溃或者被利用进行代码执行。

**投毒风险评估：**
虽然POC的主要目的是触发漏洞，但仍然存在微小的投毒风险。POC代码的目的是造成崩溃或者代码执行，攻击者可能通过细微修改，增加其他恶意操作，例如在成功利用漏洞后，下载并执行远程shell，或者篡改Redis中的数据等。代码本身的混淆程度较低，易于分析，降低了投毒成功的可能性。风险评估为 10%，主要是考虑到攻击者可能会在利用该漏洞的基础上进行二次开发。

**利用方式：**
1.  攻击者需要拥有Redis实例的访问权限，并能够执行Lua脚本(eval 或 evalsha)。
2.  攻击者发送精心设计的Lua脚本到Redis服务器。
3.  Lua脚本利用垃圾回收机制的缺陷，触发Use-After-Free漏洞。
4.  成功利用该漏洞后，攻击者可以执行任意代码，从而完全控制Redis服务器。

**缓解措施：**
1.  升级Redis到8.2.2或更高版本。
2.  禁用Lua脚本执行功能，或者通过ACL限制可执行Lua脚本的用户。

**项目地址:** [elyasbassir/CVE-2025-49844](https://github.com/elyasbassir/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #12

**来源**: [CVE-2025-49844-gopinaath_CVE-2025-49844-discovery.md](../2025/CVE-2025-49844-gopinaath_CVE-2025-49844-discovery.md)

## CVE-2025-49844-Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要能够执行Lua脚本的已认证用户

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。低权限的已认证用户可以通过构造恶意的 Lua 脚本来操纵垃圾回收器，触发释放后重用 (Use-After-Free) 漏洞，从而可能导致远程代码执行。

**有效性评估:**
根据漏洞库信息，该漏洞存在于 Redis 8.2.1 及更早版本，并在 8.2.2 版本中修复。漏洞利用需要能够执行 Lua 脚本的已认证用户。漏洞利用代码部分只包含 AWS ElastiCache Redis/Valkey 集群的网络分析工具，和 Redis Lua Use-After-Free 漏洞没有任何联系, 因此无法直接验证该漏洞.

**投毒风险分析:**
提供的代码为 ElastiCache Redis/Valkey 网络分析工具，用于审计 AWS ElastiCache Redis 和 Valkey 集群的网络暴露情况。代码主要是 bash 脚本，用于列出集群、检查网络配置等。脚本功能清晰，依赖的外部命令主要是 `aws cli` 和 `jq`。 代码内容没有发现任何恶意行为，例如反弹 shell、上传文件、执行恶意命令等。
因此，该仓库中存在作者隐藏的投毒代码的可能性极低，风险评估为0%.

**利用方式分析:**
根据漏洞库信息，攻击者需要利用 Lua 脚本操纵 Redis 的垃圾回收机制来触发 Use-After-Free 漏洞。具体步骤可能包括:

1.  认证用户连接到 Redis 服务器。
2.  构造一个恶意的 Lua 脚本，该脚本会创建一些对象，然后释放它们，但保留指向已释放内存的指针。
3.  通过某种方式（例如，再次调用 Lua 脚本），触发对已释放内存的访问，从而导致 Use-After-Free 漏洞。
4.  如果成功利用该漏洞，攻击者可能能够执行任意代码。

**项目地址:** [gopinaath/CVE-2025-49844-discovery](https://github.com/gopinaath/CVE-2025-49844-discovery)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #13

**来源**: [CVE-2025-49844-ksnnd32_redis_exploit.md](../2025/CVE-2025-49844-ksnnd32_redis_exploit.md)

## CVE-2025-49844 Redis Lua UAF 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** UAF（释放后重用）

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 所有支持Lua脚本的版本（包括6.x-8.x全分支）

**利用条件:** 需要拥有低权限及以上用户权限访问Redis服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-49844 是 Redis 数据库中 Lua 脚本执行模块的 Use-After-Free (UAF) 漏洞，CVSS评分为10.0，属于高危漏洞。漏洞存在于 Redis 的 Lua 脚本执行模块中，拥有低权限及以上用户权限的攻击者可以通过构造特定的 Lua 脚本来触发漏洞，最终实现远程代码执行。

**有效性：**
搜索结果表明，该漏洞存在公开的利用代码（POC）。根据搜索结果，特别是GitHub上的信息，该漏洞的利用代码已经可用，并且已被命名为RediShell。因此，提供的漏洞利用代码可能有效。

**投毒风险：**
提供的代码是用于音频处理，与 Redis Lua UAF 漏洞无关，代码功能是处理音频文件，提取 MFCC 特征，并将特征数据写入 CSV 文件。因此，从提供的代码本身来看，不存在针对 Redis 漏洞的利用，也不存在投毒行为。投毒风险为0%。

**利用方式：**
利用方式基于搜索结果分析。该漏洞是Redis Lua脚本的UAF漏洞，攻击者需要：
1.  **连接Redis服务器：** 使用Redis客户端连接到目标Redis服务器。
2.  **执行恶意Lua脚本：** 构造包含漏洞触发代码的Lua脚本，并将其发送到Redis服务器执行。这个Lua脚本会利用UAF漏洞，覆盖内存区域，并最终执行攻击者预先设定的恶意代码。
3.  **远程代码执行：** 成功利用漏洞后，攻击者可以在Redis服务器上执行任意代码。

根据搜索结果，Wiz团队在Pwn2Own Berlin上演示了此漏洞的利用。

**项目地址:** [ksnnd32/redis_exploit](https://github.com/ksnnd32/redis_exploit)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #14

**来源**: [CVE-2025-49844-lastvocher_redis-CVE-2025-49844.md](../2025/CVE-2025-49844-lastvocher_redis-CVE-2025-49844.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis开启Lua脚本支持，并允许攻击者执行Lua脚本 (默认配置可能允许)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 是一个 Redis Lua 解释器中的 Use-After-Free 漏洞，可能导致远程代码执行。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，POC代码的有效性较高。漏洞库信息明确指出，Redis 版本低于 8.2.2 受到此漏洞的影响，而提供的 Dockerfile 使用了 Redis 7.2.0，确认是受影响的版本。提供的 README.md 文档详细描述了漏洞利用的步骤和预期输出，包含验证漏洞、触发UAF，测试沙箱逃逸、内存破坏等方式，进一步佐证了 POC 代码的有效性。

**投毒风险：**

提供的 Dockerfile 只是为了创建一个存在漏洞的 Redis 环境，其主要目的是方便进行漏洞验证和复现。其中`protected-mode no`、`bind 0.0.0.0`等配置项，是为了方便攻击，让 Redis 暴露在公网上，方便漏洞的利用.但实际环境中，这些配置都是非常危险的。 提供的python脚本`exploit_poc.py` 主要是用来验证漏洞的存在和利用。综合来看，虽然存在一些不安全的配置，方便了攻击，但并未发现明显的投毒代码。投毒风险较低，评估为10%。风险主要集中在使用者是否清楚风险，以及是否在生产环境中使用这些不安全配置上。

**利用方式：**

1.  **漏洞触发：** 攻击者需要能够连接到 Redis 服务器，并且 Redis 实例允许执行 Lua 脚本。默认情况下，未经身份验证的连接即可执行 Lua 脚本。
2.  **利用 EVAL 命令：** 攻击者可以使用 EVAL 或 EVALSHA 命令发送恶意的 Lua 脚本。
3.  **UAF 触发：** 恶意 Lua 脚本会精心构造，利用 Redis 的垃圾回收机制中的缺陷，触发 Use-After-Free 漏洞。这通常涉及对 Redis 内部对象进行操作，导致在对象被释放后仍然被访问。
4.  **沙箱逃逸(如果存在)：**早期的分析和报告曾提到利用此UAF进行沙箱逃逸，但是更多是利用内存破坏直接实现RCE。 如果目标启用了 Lua 沙箱，攻击者可能需要利用 UAF 漏洞绕过沙箱限制，以便执行任意代码。
5.  **远程代码执行：** 成功利用 Use-After-Free 漏洞后，攻击者可以执行任意代码，从而完全控制 Redis 服务器。这意味着攻击者可以读取、修改或删除 Redis 中的数据，甚至可以利用 Redis 服务器作为跳板攻击内网中的其他系统。
6.  **利用 ACL 进行缓解：** 漏洞描述中提到可以通过 ACL 限制 EVAL 和 EVALSHA 命令来缓解此漏洞。

**项目地址:** [lastvocher/redis-CVE-2025-49844](https://github.com/lastvocher/redis-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #15

**来源**: [CVE-2025-49844-pedrorichil_CVE-2025-49844.md](../2025/CVE-2025-49844-pedrorichil_CVE-2025-49844.md)

## CVE-2025-49844 (RediShell) - Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要 Redis 服务运行，并且允许执行 Lua 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 解释器中的一个 Use-After-Free 漏洞，存在于 Redis 8.2.2 之前的版本中。攻击者可以利用精心构造的 Lua 脚本来操纵垃圾回收器，触发 Use-After-Free 漏洞，最终导致远程代码执行。

**利用方式：**

1.  **连接 Redis 服务器：** 攻击者首先需要连接到目标 Redis 服务器，可以是认证的或未认证的，取决于服务器的配置。
2.  **发送恶意 Lua 脚本：** 通过 `EVAL` 命令将恶意的 Lua 脚本发送到 Redis 服务器。该脚本旨在利用 Lua 解释器的内存管理缺陷。
3.  **触发 Use-After-Free：** Lua 脚本会精心构造内存操作，通过垃圾回收机制，触发 Use-After-Free 漏洞。
4.  **绕过 Lua 沙箱（如果需要）：** 某些情况下，漏洞利用可能需要绕过 Lua 沙箱的限制，以执行更高级的操作。
5.  **执行任意代码：** 成功触发 Use-After-Free 漏洞后，攻击者可以利用内存损坏实现任意代码执行。
6.  **控制系统：**  最终，攻击者可以获得对 Redis 服务器所在主机的完全控制权，进行数据窃取、恶意软件安装等恶意活动。

**POC有效性：**

提供的 `Dockerfile` 和 `README.md` 描述了一个用于测试 CVE-2025-49844 漏洞的实验环境。`Dockerfile` 设置了一个运行 Redis 7.2.0 版本的 Docker 容器，该版本已知存在此漏洞。`README.md` 提供了快速启动说明和使用示例，包括检查漏洞状态、触发 UAF、测试沙箱逃逸和执行内存损坏模式。根据描述，POC 代码的目的是触发 UAF 漏洞并展示其潜在影响。因此，可以认为提供的 POC 代码是有效的，至少在指定的实验环境中可以验证该漏洞的存在。

**投毒风险评估：**

查看提供的 `Dockerfile` 和 `README.md` 文件，没有发现明显的恶意代码或后门。 `Dockerfile` 只是创建了一个包含易受攻击的Redis版本的环境,`README.md` 只提供了如何使用POC的说明，没有证据表明作者在这些文件中隐藏了任何投毒代码。因此，投毒风险非常低。


**项目地址:** [pedrorichil/CVE-2025-49844](https://github.com/pedrorichil/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #16

**来源**: [CVE-2025-49844-raminfp_redis_exploit.md](../2025/CVE-2025-49844-raminfp_redis_exploit.md)

## CVE-2025-49844 (RediShell) - Redis Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis开启Lua脚本支持，以及具有执行EVAL和EVALSHA命令的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49844 RediShell 是一个Redis Lua 解释器中的 Use-After-Free 漏洞，存在于 Redis 8.2.2 之前的版本中。利用该漏洞，经过身份验证的用户可以使用特制的 Lua 脚本来操纵垃圾收集器，触发 Use-After-Free 漏洞，并可能导致远程代码执行。

**有效性:**

提供的 Dockerfile 和 README.md 文件构成了一个用于复现 CVE-2025-49844 的实验环境。Dockerfile 设置了一个易受攻击的 Redis 实例（7.2.0 版本），禁用了 protected-mode，并允许从任何地址绑定，暴露了6379 端口。README.md 提供了关于漏洞的信息和利用说明，其中包含使用 python 脚本 `exploit_poc.py` 的利用示例。这个 POC 看起来是有效的，因为它明确针对了漏洞，并提供了不同模式的测试，例如 basic UAF 触发，沙箱逃逸和内存破坏。同时也说明了修复版本以及绕过缓解措施。

**投毒风险:**

对提供的 Dockerfile 和 README.md 文件内容进行分析，发现投毒风险较低。以下是分析结果：

*   **Dockerfile:** Dockerfile 的主要目的是创建一个存在漏洞的 Redis 实例，禁用了安全设置，以便于漏洞利用的演示和测试。该 Dockerfile 本身没有发现恶意代码或后门。
*   **README.md:** README.md 文件提供了漏洞的信息和利用说明，以及如何使用 `exploit_poc.py` 脚本来测试漏洞。该文件本身没有发现恶意代码或后门。
*   **exploit_poc.py (未提供全部代码，但分析思路相同):**  如果 `exploit_poc.py` 脚本包含恶意代码，例如在成功利用漏洞后安装后门或执行其他恶意操作，那么就存在投毒风险。但是，从提供的 `README.md` 文件的描述来看，该脚本的主要目的是验证漏洞的存在，而不是执行恶意操作。需要检查脚本内容才能确认。

因此，综合来看，此仓库中存在作者隐藏的投毒代码的可能性较低，估计为 10%。 重点需要review `exploit_poc.py` 代码

**利用方式:**

漏洞利用方式如下：

1.  **环境准备：** 构建包含漏洞版本的 Redis 实例，例如使用提供的 Dockerfile。
2.  **连接 Redis：** 使用 Redis 客户端连接到 Redis 服务器。
3.  **执行恶意 Lua 脚本：** 使用 EVAL 或 EVALSHA 命令执行特制的 Lua 脚本。该脚本会操纵垃圾收集器，触发 Use-After-Free 漏洞。
4.  **沙箱逃逸（如果需要）：** 利用漏洞绕过 Lua 沙箱的限制，访问受限函数。
5.  **远程代码执行：** 执行任意本地代码，从而获得对主机的完全访问权限。

**项目地址:** [raminfp/redis_exploit](https://github.com/raminfp/redis_exploit)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #17

**来源**: [CVE-2025-49844-saneki_cve-2025-49844.md](../2025/CVE-2025-49844-saneki_cve-2025-49844.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要已认证用户执行 Lua 脚本 (默认开启)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。该漏洞允许经过身份验证的用户通过精心构造的 Lua 脚本来操纵垃圾回收器，触发 Use-After-Free 漏洞，并可能导致远程代码执行。

**有效性:**

根据漏洞库信息和提供的POC代码，可以判断POC代码有效。POC目录下的 `demonstration.py` 文件展示了如何利用 Lua 脚本中的垃圾回收机制来触发该漏洞。 `README.md` 描述了如何使用该 POC 在目标 Redis 环境中执行命令或连接到反向 shell。

**投毒风险:**

对提供的POC代码进行分析，发现作者提供的代码主要用于漏洞验证，没有发现明显的恶意投毒代码。`pyproject.toml` 定义了依赖项，如 `hexdump`、`iced-x86` 和 `redis`，这些依赖项都是常用的库，没有发现可疑之处。`dockerfiles` 目录下的 Dockerfile 和 compose.yaml 文件定义了 Redis 的运行环境，也没有发现恶意代码。 但是考虑到任何代码都可能被用于恶意目的，因此无法完全排除投毒风险，综合考虑，判定投毒风险为5%。

**利用方式:**

1.  **Lua 脚本执行:** 攻击者需要能够执行 Lua 脚本。默认情况下 Redis 允许执行 Lua 脚本。但在实际环境中可能通过 ACL 限制 `EVAL` 和 `EVALSHA` 命令来缓解。
2.  **精心构造的 Lua 脚本:** 攻击者需要构造一个特殊的 Lua 脚本，该脚本利用 Lua 垃圾回收器的行为，在对象被释放后再次访问它，触发 Use-After-Free 漏洞。
3.  **利用 Use-After-Free 漏洞:** 成功触发 Use-After-Free 漏洞后，攻击者可以进一步利用该漏洞执行任意代码，例如，执行系统命令或连接到反向 shell。

**总结:**

该漏洞危害性极高，攻击者可以利用该漏洞在 Redis 服务器上执行任意代码。修复方法是升级到 Redis 8.2.2 或更高版本，或者通过 ACL 限制 `EVAL` 和 `EVALSHA` 命令的执行。

**项目地址:** [saneki/cve-2025-49844](https://github.com/saneki/cve-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

## POC #18

**来源**: [CVE-2025-49844-srozb_reditrap.md](../2025/CVE-2025-49844-srozb_reditrap.md)

## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务开启Lua脚本支持，攻击者需要有权限执行Lua脚本（例如，通过认证，或者Redis配置不当允许未授权访问）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844是一个Redis Lua引擎中的Use-After-Free漏洞，该漏洞允许经过身份验证的用户通过精心构造的Lua脚本操纵垃圾回收器，从而触发Use-After-Free，并可能导致远程代码执行。漏洞存在于所有启用Lua脚本的Redis版本中，直到8.2.2版本修复。该漏洞的利用方式是利用Redis的EVAL、EVALSHA或SCRIPT LOAD命令发送恶意的Lua脚本。提供的代码实际上是一个Redis蜜罐（RediTrap Honeypot），用于检测针对CVE-2025-49844的攻击尝试，而不是漏洞利用代码本身。它通过监听Redis端口，并记录所有命令，特别是Lua脚本相关的命令，并将其标记为可疑。该蜜罐旨在模仿旧版本的Redis行为，以诱使攻击者继续尝试利用该漏洞。这个仓库本身没有任何投毒代码，因为它的目的是监控和记录攻击行为，而非发起攻击。

**项目地址:** [srozb/reditrap](https://github.com/srozb/reditrap)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

---

