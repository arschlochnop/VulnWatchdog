## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** DefaultServlet写入功能启用, partial PUT请求支持, 文件会话持久化开启, 存在反序列化漏洞的库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个严重安全漏洞，允许未经身份验证的远程代码执行。该漏洞源于对partial PUT请求处理不当，攻击者可以利用此漏洞上传恶意序列化数据到会话文件中，从而执行任意代码。要成功利用此漏洞，需要满足以下条件：应用程序启用了DefaultServlet写入功能（默认关闭）；应用程序支持partial PUT请求（默认开启）；应用程序使用了Tomcat的文件会话持久化，并且使用了默认的会话存储位置；应用程序包含一个存在反序列化漏洞的库，例如commons-collections。 

POC的有效性分析：提供的POC代码展示了完整的利用过程，包括生成恶意的序列化文件，使用PUT请求上传该文件，以及使用GET请求触发反序列化漏洞。该POC包含完整的HTTP请求示例，并详细说明了所需的配置和步骤。根据Rapid7的博客文章，该漏洞已修复，因此POC在未打补丁的系统上应该有效。

利用步骤：
1. 确保目标Tomcat服务器满足利用条件。
2. 生成包含恶意代码的序列化文件，例如使用ysoserial工具。
3. 使用PUT请求将序列化文件上传到目标服务器的会话文件中，需要注意设置Content-Length和Content-Range头。
4. 使用包含有效JSESSIONID的GET请求访问目标服务器，触发反序列化漏洞，执行恶意代码。

投毒风险分析：
该POC的投毒风险较低，因为POC代码清晰地展示了利用过程，没有包含任何混淆或恶意行为。POC主要依赖于标准库和已知的反序列化漏洞利用链。但是，由于该漏洞允许远程代码执行，因此攻击者可能会利用该漏洞上传恶意war包或其他恶意文件，从而对服务器造成更大的危害。此外，攻击者也可能通过修改POC代码，使其包含额外的恶意功能，例如窃取敏感数据或进行横向渗透。因此，在使用该POC时，需要仔细审查代码，并确保在安全的环境中进行测试。

**项目地址:** https://github.com/issamjr/CVE-2025-24813-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
