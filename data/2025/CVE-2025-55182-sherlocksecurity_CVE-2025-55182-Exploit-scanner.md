## CVE-2025-55182 - React, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React, Next.js

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 不明确，所有使用受影响的React Server Components (RSC)的框架版本

**利用条件:** 无需身份验证，可通过网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 35%

## 详情

CVE-2025-55182是一个存在于React和Next.js中的反序列化漏洞，攻击者可以利用该漏洞执行远程命令（RCE）。该漏洞存在于React Server Components (RSC)处理反序列化数据的方式中。未经身份验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而在服务器上执行任意代码。

**POC有效性分析：**
提供的POC代码是一个Python脚本，旨在利用CVE-2025-55182漏洞。该脚本包含构建恶意payload以触发RCE的函数。它支持选择Windows或Linux命令，并具有WAF绕过机制。脚本首先导入必要的库，如`requests`、`tqdm`等。然后，定义了一些辅助函数，用于颜色化输出、解析HTTP头部、规范化主机URL以及生成随机数据。`build_safe_payload`函数构建了一个看似无害的payload，而`build_rce_payload`函数则用于生成包含恶意命令的payload。`exploit`函数负责发送HTTP请求，并根据响应判断漏洞是否成功利用。脚本还包括并发扫描功能，可以同时测试多个目标。通过命令注入，可以在服务器上执行任意代码。POC的有效性在于它能够模拟攻击者的行为，验证漏洞是否真实存在，并评估其潜在影响。从代码来看，该POC比较成熟，考虑到了WAF绕过，并支持并发测试，具有较高的实用价值。

**利用步骤：**
1.  准备目标：确定运行受影响版本的React或Next.js应用程序的目标服务器。
2.  配置POC：设置POC脚本中的目标URL。如果需要，配置WAF绕过和Windows/Linux命令。
3.  运行POC：执行POC脚本，观察响应。如果成功，将在服务器上执行命令。
4.  验证：检查命令执行的结果，确认RCE漏洞是否成功利用。

**投毒风险分析：**
该POC代码的投毒风险属于中等。主要风险点在于以下几个方面：
1.  **eval函数的使用：** 为了执行JavaScript代码，POC使用了`eval`函数。虽然`eval`在某些情况下是必要的，但它也可能被滥用以执行恶意代码。如果攻击者修改了POC代码，将恶意的JavaScript代码注入到`eval`函数中，那么在执行POC时，就会执行这些恶意代码，从而对本地环境造成危害。例如，攻击者可以将`eval`函数修改为从远程服务器下载并执行恶意脚本。
2.  **代码混淆：** 虽然POC代码本身没有明显的混淆，但是攻击者可能会对代码进行混淆处理，使其难以阅读和理解。这样一来，用户在审查代码时就很难发现潜在的恶意行为。
3. **绕过WAF的尝试：** POC代码中包含绕过WAF的机制，例如使用大小写混合、URL编码等方式。虽然这些技术本身不是恶意的，但是它们可能会被攻击者利用来隐藏恶意payload，从而绕过安全防护。

**缓解措施：**
1.  保持React和Next.js框架更新到最新版本。
2.  实施严格的输入验证和清理，以防止反序列化攻击。
3.  使用Web应用程序防火墙（WAF）来检测和阻止恶意请求。
4.  定期进行安全审计和渗透测试，以发现潜在的安全漏洞。

尽管该POC旨在验证漏洞，但用户在使用时务必谨慎，避免在生产环境中直接执行，以免造成不必要的损失。对POC进行安全审查，确保其不包含恶意代码，并且在隔离的环境中运行。

**项目地址:** https://github.com/sherlocksecure/React2Shell

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
