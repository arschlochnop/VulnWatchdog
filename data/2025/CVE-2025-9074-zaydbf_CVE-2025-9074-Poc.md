## CVE-2025-9074 - Docker Desktop (Windows & macOS) RCE/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** RCE/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.3

**影响版本:** 所有未修复 CVE-2025-9074 的 Docker Desktop 版本

**利用条件:** 攻击者需在 Docker Desktop 内部运行一个 Linux 容器，或拥有本地受限执行权限

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本是一个高度有效的自动化利用工具，它针对 Docker Desktop 内部隔离机制的缺陷进行攻击。漏洞根源在于 Docker Desktop 默认配置下，Linux 容器可以通过特定的子网 IP（192.168.65.7）和端口（2375）在无认证的情况下访问宿主机的 Docker Engine API。POC 脚本首先通过 curl 请求 /images/json 获取本地已有的镜像列表，以确保后续创建容器时有可用的基础镜像。接着，它利用 API 的 /containers/create 接口构造一个恶意容器。关键的逃逸手段在于 HostConfig 参数：通过设置 'Binds': ['/:/host'] 将宿主机的根目录挂载到容器内部，并开启 'Privileged': true 以及 'NetworkMode': 'host'。最后，脚本通过 chroot 切换到宿主机根目录并执行反弹 Shell 命令。这种利用方式直接绕过了 Docker 的命名空间隔离和文件系统限制，证明了该漏洞在默认配置下的高危害性。脚本编写规范，逻辑清晰，在受影响的环境中几乎可以做到一键逃逸，具有极高的实战参考价值。

利用步骤：1. 攻击者在 Docker Desktop 环境中启动一个基础 Linux 容器。2. 在容器内部或通过本地网络环境访问 192.168.65.7:2375 以确认 API 响应。3. 执行脚本并指定监听者的 IP 和端口（例如：./exploit.sh -l 10.0.0.1 -p 4444）。4. 脚本自动搜索可用镜像并向 API 发送 POST 请求创建特权容器。5. 脚本启动容器，触发 chroot 挂载逃逸，攻击者在监听端获得宿主机的 root 权限 Shell。

投毒风险分析：该 POC 脚本本身表现为标准的防御性研究工具，其代码逻辑完全透明，使用了 Bash 原生工具如 curl、grep 和 cut，不涉及任何外部二进制文件的下载或执行，也没有代码混淆行为。脚本中的反弹 Shell 指向的是用户通过参数指定的 -l (LHOST) 和 -p (LPORT)，而非硬编码的远程恶意服务器，因此其本身被判定为‘恶意投毒’的风险较低。然而，在威胁情报视角下，此类利用简单的漏洞脚本极易被攻击者二次打包，嵌入到所谓的‘安全工具’或‘自动修复补丁’中分发。由于该漏洞涉及到直接的宿主机文件系统挂载，如果用户在未经审计的情况下运行修改版的脚本，攻击者只需修改反弹 Shell 的目的地或在创建容器的 Cmd 中加入静默植入后门的指令，即可实现对运行者宿主机的全盘控制。因此，虽然此原始脚本风险较低，但其展示的‘无认证特权挂载’机制是投毒者最青睐的攻击载荷，建议安全研究员仅在受控隔离环境中使用，并严禁直接运行来源不明的衍生脚本。

**项目地址:** [https://www.freebuf.com/articles/vuls/445648.html](https://www.freebuf.com/articles/vuls/445648.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
