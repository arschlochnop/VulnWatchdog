## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者使用受影响版本的WinRAR解压恶意构造的RAR压缩文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC利用了WinRAR在处理Windows NTFS备用数据流（ADS）和文件路径解析时的逻辑缺陷。通过构造包含特定路径遍历字符（如..\）的文件项，并结合ADS特性（文件名:流名），攻击者可以诱导WinRAR将文件解压到用户预期的目录之外。在提供的builder.py代码中，脚本自动化了RAR头部的修改过程，特别是针对文件系统路径的深度注入。它通过循环构建多个深度的遍历路径，确保无论用户在哪个层级解压，恶意负载都能准确命中目标路径。该POC展示了极高的实用性，能够直接生成可导致代码执行的恶意压缩包，且不依赖于WinRAR以外的其他漏洞，具有极强的实战验证价值。利用步骤：1. 攻击者准备攻击载荷，如精心构造的.lnk快捷方式或.exe可执行文件。2. 使用builder.py脚本，配置PAYLOAD_MAPPING，定义载荷在目标系统上的存放路径，通常指向系统的启动文件夹（Startup）。3. 脚本会自动创建一个包含合法诱饵文件（如图片或文档）和隐藏恶意流的RAR文件。4. 攻击者将此RAR文件通过邮件、社交工程或挂马网站分发给受害者。5. 受害者双击或右键‘解压到当前文件夹’，WinRAR在解压过程中会无意中将恶意载荷写入启动目录。6. 当受害者下次重启系统或登录时，恶意程序自动运行。投毒风险分析：该POC项目来源于GitHub第三方仓库，其核心脚本代码逻辑相对透明，主要使用Python标准库（struct, os, pathlib等）进行二进制流操作，未发现经过混淆的恶意后门代码。然而，作为安全研究员必须注意，此类针对WinRAR的漏洞POC极易被黑客社区利用进行二次开发。目前观察到的风险点主要在于：第一，脚本中预设的PAYLOAD_MAPPING包含硬编码的路径（如特定的用户名‘Duy’），这提示代码可能来源于真实的攻击样本分析，研究人员在使用时需谨慎修改，防止意外在本地环境触发真实Payload。第二，该类项目经常吸引恶意攻击者在Issue或分支中提交带有真正后门的‘加强版’工具。第三，代码中使用了subprocess调用外部RAR工具（如果存在），需确保本地RAR环境的安全。总体而言，该POC本身代码清晰度高，投毒风险处于低至中等水平（15%），风险主要源于使用者的环境配置不当或对预设路径的盲目执行。

**项目地址:** [https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder](https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
