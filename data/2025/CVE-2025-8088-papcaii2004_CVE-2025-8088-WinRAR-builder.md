## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 7.12 及更低版本

**利用条件:** 需要用户交互 (受害者解压恶意压缩包), 可通过社会工程学进行投递

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析: 该POC是一个基于Python的构建器 (`builder.py`)，旨在创建专门构造的WinRAR压缩文件，用于利用CVE-2025-8088漏洞。此漏洞是WinRAR中的一个路径遍历（Path Traversal）缺陷，允许攻击者在受害者使用易受攻击的WinRAR版本（7.12及更低版本）解压恶意压缩文件时，将任意文件写入到系统上的任意位置。POC通过巧妙利用Windows NTFS备用数据流（Alternate Data Streams, ADS）特性和RAR头部操纵技术，绕过WinRAR的文件解压路径验证机制。攻击者可以强制将恶意Payload（例如，指向恶意可执行文件的.lnk快捷方式文件）放置到Windows启动文件夹等关键系统目录中。`README.md`文件提供了清晰的操作指南，详细说明了如何创建恶意压缩文件以及预期的执行流程：受害者解压文件后，Payload被投放到指定目录，并在系统下次重启时自动执行，从而实现任意代码执行（RCE）。脚本中的`PAYLOAD_MAPPING`配置项允许攻击者灵活地指定Payload文件及其目标解压路径，这充分展示了该漏洞利用的强大功能和POC的实用性。这种类型的漏洞及其利用方法在安全界已有先例（例如，历史上的WinRAR路径遍历漏洞），因此该POC在实现其既定目标方面显得高度有效。

利用步骤:
1.  **环境准备**: 首先，攻击者需要从GitHub克隆POC代码库：`git clone https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git` 并进入到克隆的目录中。
2.  **准备Payload**: 在POC项目的根目录下创建一个名为 `payloads` 的文件夹。将用于攻击的恶意文件（例如，用于下载和执行恶意软件的`.exe`文件，或指向恶意脚本的`.lnk`快捷方式文件）放入此 `payloads` 文件夹中。
3.  **配置Payload映射**: 编辑 `builder.py` 脚本中的 `PAYLOAD_MAPPING` 列表。在此处，攻击者需指定 `payloads` 文件夹中的文件名及其在受害者系统上期望的最终解压路径。一个常见的策略是将`.lnk`文件映射到Windows启动文件夹，例如 `..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\important_update.lnk`，以确保Payload在系统重启时自动执行。
4.  **生成恶意RAR文件**: 运行Python脚本来生成恶意压缩包：`python builder.py <decoy_file>`。`<decoy_file>` 可以是任何合法的、无害的文件（例如，一张图片或一个文档），用作诱饵以增加压缩包的迷惑性。该命令将生成名为 `exploit.rar` 的恶意文件。
5.  **社会工程学投递**: 攻击者通过社会工程学手段，例如发送带有恶意附件的钓鱼邮件、诱骗受害者从恶意网站下载，或者利用即时通讯工具传播，将生成的 `exploit.rar` 文件投递给目标受害者。
6.  **受害者解压**: 当受害者使用安装了存在漏洞的WinRAR版本（7.12及更低版本）的计算机解压这个 `exploit.rar` 文件时，WinRAR的路径遍历缺陷将被触发。恶意Payload不会被解压到用户指定的安全位置，而是被秘密地写入到攻击者在 `PAYLOAD_MAPPING` 中预设的目标系统路径（例如，Windows启动文件夹）。
7.  **Payload自动执行**: 在受害者下次重启其计算机时，由于恶意Payload已被写入到系统的启动目录，它将随系统启动而自动执行。这将赋予攻击者在受害者系统上执行任意代码的能力，从而完全控制受害者的计算机。

投毒风险分析: 针对CVE-2025-8088的POC代码，其投毒风险被评估为低（15%）。这一评估基于对代码的透明度、功能范围、依赖关系以及其设计目的的全面分析。
首先，该POC的核心组件是一个用Python编写的脚本（`builder.py`），Python代码因其高可读性而易于审查。脚本的结构清晰，其主要功能明确为构造恶意的RAR压缩文件。它不涉及复杂的代码混淆、加密或任何试图隐藏其真实意图的技术，这使得安全研究人员能够相对容易地审计代码，从而验证其行为是否与声明相符，并确保其不包含额外的恶意负载。
其次，该POC的功能范围非常专注，仅限于生成利用WinRAR路径遍历漏洞的压缩文件。代码中没有发现任何与漏洞利用无关的恶意功能，例如建立反向Shell、上传敏感数据、修改系统关键配置或尝试进行其他未经授权的网络通信。代码的核心逻辑围绕文件操作（读取准备好的Payload、构造RAR文件头、写入文件内容）和调用合法的RAR命令行工具来完成压缩任务，这些操作是可预测和受控的。
再者，代码的依赖项主要包括Python标准库（如`os`、`struct`、`subprocess`、`zlib`、`shutil`）以及系统上预先安装的WinRAR命令行工具。没有发现使用可疑的第三方库或从外部源下载并执行代码的行为。对外部RAR工具的调用也是为了实现漏洞利用所需的文件压缩功能，其命令参数和执行上下文均可被研究人员清晰地看到和理解。
最后，需要强调的是，该POC的最终产物是一个`.rar`文件，而不是在运行POC的机器上直接执行任何恶意操作。`PAYLOAD_MAPPING`中定义的路径遍历行为是该漏洞利用逻辑的组成部分，并非POC代码自身对运行环境的“投毒”。因此，运行`builder.py`来生成恶意文件本身，并不会直接对研究人员的系统造成危害。真正的风险点在于随后对生成的`exploit.rar`文件的处理和测试，这需要在一个隔离且受控的环境中进行。
综合以上分析，该POC代码的透明度高、功能单一且可审计，不含隐藏的恶意功能或不安全的外部依赖，因此其对安全研究员自身的投毒风险处于低水平。

**项目地址:** https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git

**漏洞详情:** https://avd.aliyun.com/detail?id=AVD-2025-8088
