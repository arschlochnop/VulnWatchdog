## CVE-2025-8088 - WinRAR 路径遍历/RCE

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/RCE

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者需要使用存在漏洞的WinRAR版本解压攻击者构造的恶意RAR压缩包

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了一个高度有效的路径遍历利用方案。核心机制在于利用了Windows NTFS文件系统的备用数据流（Alternate Data Streams, ADS）特性。在WinRAR 7.12及更早版本中，解压逻辑未能对压缩包内包含ADS标记的文件路径进行严格校验。builder.py脚本通过构建含有特定结构的RAR5文档，将恶意载荷（如.lnk或.exe）映射到具有多个目录回溯符（..\）的目标路径中。分析POC代码发现，它通过操作RAR头文件结构，将文件写入受害者的敏感目录，如Windows启动文件夹（Startup）。由于WinRAR在处理此类特制流文件时会忽略安全边界检查，导致文件被强制解压缩到预定义位置。这种利用方式极其隐蔽，因为在压缩包预览界面，用户通常只能看到一个普通的TXT文件（如metadata.txt），而无法直观发现隐藏在ADS中的遍历路径。复现步骤如下：1. 环境准备，安装Python 3并确保系统安装了WinRAR 7.12或更早版本；2. 在payloads文件夹中放置恶意文件，如用于建立反弹shell的快捷方式或可执行文件；3. 修改PAYLOAD_MAPPING，将目标路径指向'AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\'；4. 运行builder.py脚本生成exploit.rar；5. 将该压缩包发送给受害者，一旦受害者右键点击‘解压到当前文件夹’或‘解压到指定文件夹’，恶意文件即会被静默释放到启动项中。投毒风险分析：该POC项目来源于GitHub，主要包含README.md说明文件和builder.py核心构建脚本。从防御性研究角度看，代码逻辑较为透明，使用了Python标准库如os、struct、zlib等进行二进制文件构造，未发现经过混淆的Base64载荷或远程下载恶意脚本的隐藏行为。然而，此类安全研究工具本身具备极强的攻击属性，存在被恶意第三方通过‘黑吃黑’方式投毒的风险。例如，攻击者可能会在类似的Builder脚本中插入一段后门代码，在生成exploit.rar的同时，获取研究人员的主机权限。当前分析的项目代码结构清晰，payload映射关系明确，属于典型的安全评估工具。但由于其直接提供了将文件释放至启动项的配置模板，其在野利用门槛极低，极易被转化为实际的恶意软件分发工具。防御者在测试此POC时，应严格在隔离的虚拟机环境中运行，并监控脚本是否产生非预期的网络连接或系统文件篡改行为。

**项目地址:** [https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder](https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
