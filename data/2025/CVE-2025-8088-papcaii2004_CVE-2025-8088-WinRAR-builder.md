## CVE-2025-8088 - WinRAR 目录遍历 (Directory Traversal), 任意代码执行 (Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历 (Directory Traversal), 任意代码执行 (Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 高

**影响版本:** 7.12及以下版本

**利用条件:** 用户需解压恶意构造的RAR压缩包，且使用受影响的WinRAR版本。

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该POC工具（CVE-2025-8088-WinRAR-builder）是一个功能完整的漏洞利用工具，用于生成恶意的RAR压缩包，旨在利用WinRAR软件中的目录遍历漏洞（CVE-2025-8088），该漏洞影响7.12及以下版本。POC通过巧妙地结合Windows NTFS备用数据流（ADS）特性和路径遍历技术，绕过WinRAR的文件验证机制。它允许攻击者将恶意文件释放到系统任意位置，特别是Windows启动文件夹（例如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`），从而实现持久化和任意代码执行。该POC通过创建包含多个ADS流的RAR文件来提高攻击成功率，每个流都嵌入了具有不同路径遍历深度的Payload。当受害者使用脆弱版本的WinRAR解压此恶意RAR文件时，Payload即会被写入目标路径，并在系统重启后自动执行。搜索结果表明，该漏洞已被RomCom等APT组织广泛利用，证实了其有效性和高危害性。

**利用步骤：**
1.  **克隆仓库**: 使用`git clone https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git`命令获取POC代码。
2.  **进入目录**: 切换到克隆的`CVE-2025-8088-WinRAR-builder`目录。
3.  **准备Payload**: 在项目根目录下创建`payloads`文件夹，并将恶意Payload文件（如`.exe`, `.dll`, `.lnk`等）放入其中。
4.  **配置Payload映射**: 修改`builder.py`脚本中的`PAYLOAD_MAPPING`变量，将Payload文件名映射到目标解压路径，例如Windows启动文件夹。
5.  **运行脚本**: 执行`python builder.py <decoy_file>`命令，`<decoy_file>`是一个诱饵文件（如`metadata.txt`），脚本将生成名为`exploit.rar`的恶意压缩包。
6.  **诱骗受害者**: 将`exploit.rar`发送给受害者，诱导其使用WinRAR 7.12或更早版本解压。Payload将在解压后写入目标位置，并在下次系统启动时自动执行。

**投毒风险分析：**
对`CVE-2025-8088-WinRAR-builder`这一POC工具的投毒风险评估为低（10%）。代码审查表明，`builder.py`文件结构清晰，逻辑直接，未发现任何恶意代码或可疑行为。它使用标准Python库（如`os`, `struct`, `subprocess`, `zlib`等），并通过`subprocess.run`调用合法的`Rar.exe`程序来构建恶意RAR文件。该脚本不涉及任何网络通信，没有引入外部不信任的依赖，也没有使用代码混淆技术。需要明确的是，该POC工具本身是用于“构建”恶意压缩包的，其内部不包含预设的恶意代码，而是要求用户提供Payload。这些用户提供的Payload是漏洞利用的载体，而非POC工具自身的恶意组成部分。因此，该POC代码是专注于漏洞利用原理的实现，不包含旨在攻击POC使用者自身的恶意逻辑，投毒风险极低。

**项目地址:** https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
