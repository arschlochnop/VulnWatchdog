## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 7.12及以下版本

**利用条件:** 需要用户交互, 无需认证, 本地文件操作

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-8088是一个影响WinRAR软件7.12及以下版本的严重路径遍历/目录穿越漏洞。攻击者可以通过精心构造的恶意RAR压缩包，利用Windows NTFS备用数据流 (ADS) 特性以及RAR文件头中的路径操控技术，绕过WinRAR的文件验证和路径清理机制。这使得恶意文件能够在解压时被释放到系统任意指定位置，例如Windows启动文件夹（Start Menu\Programs\Startup）。一旦恶意文件被成功放置到启动目录，它将在受害者下次重启或登录时自动执行，从而实现任意代码执行（RCE）和持久化控制。该漏洞的危险性在于WinRAR作为一款广泛使用的压缩工具，其用户基数庞大，使得潜在受攻击面非常广。

**POC有效性分析**
所提供的POC，名为`CVE-2025-8088-WinRAR-builder`，是一个高度有效且功能完整的漏洞利用工具。该POC由Python编写，能够系统地生成一个恶意RAR压缩包。`README.md`文件提供了清晰的设置和使用说明。`builder.py`脚本精确实现了核心利用逻辑：首先，它利用Windows NTFS备用数据流（ADS）技术，将恶意载荷（如`.lnk`、`.exe`、`.dll`文件）嵌入到看似无害的文本文件（如`metadata.txt`）的隐藏数据流中。其次，脚本通过巧妙地操纵RAR存档的内部头部结构，构造包含足够路径遍历序列（例如`..\..\..\`）和指向关键系统目录（如`Startup`文件夹）的绝对或相对路径。当受害者使用存在漏洞的WinRAR版本解压此恶意RAR文件时，路径遍历漏洞会导致WinRAR忽略用户指定的目标路径，转而使用攻击者精心设计的内部路径，从而将恶意载荷释放到预定位置。该POC通过将载荷投放到Windows启动文件夹来实现持久化。代码模块化程度高，用户可以通过修改`PAYLOAD_MAPPING`配置轻松定义多个载荷及其目标路径。鉴于其清晰的结构、详细的文档和对漏洞核心机制的直接实现，该POC在漏洞研究和利用方面都非常有效。

**利用步骤**
1.  **准备阶段**：
    *   克隆`CVE-2025-8088-WinRAR-builder` GitHub仓库。
    *   在克隆的仓库目录中创建名为`payloads`的文件夹。
    *   将预期的恶意文件（例如，`cmd.lnk`、`evil.exe`）放入`payloads`文件夹。
    *   编辑`builder.py`脚本中的`PAYLOAD_MAPPING`列表，指定`payloads`文件夹中的文件名及其在受害者系统上的目标路径（例如，`("cmd.lnk", "C:\Users\Duy\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\important_update.lnk")`）。
2.  **生成利用文件**：
    *   在命令行中执行`builder.py`脚本，并提供一个诱饵文件作为参数。诱饵文件是一个合法的文档，将被包含在恶意RAR存档中，用于伪装和分散受害者注意力。例如：`python builder.py legitimate_document.pdf`。
    *   脚本将生成一个名为`exploit.rar`的恶意压缩包在当前目录下。
3.  **投递**：
    *   通过社会工程学手段，例如钓鱼邮件、恶意网站下载或共享网络驱动器，将生成的`exploit.rar`文件投递给受害者，通常伪装成重要的或合法的文件。
4.  **受害者交互**：
    *   受害者使用受影响的WinRAR版本（7.12或更低）解压`exploit.rar`文件。路径遍历漏洞与ADS流相结合，将导致恶意载荷被写入攻击者指定的关键系统位置（例如Windows启动文件夹），绕过正常的文件验证和用户选择的解压路径。
5.  **持久化与执行**：
    *   在受害者下次系统重启或登录后，被投放到启动文件夹的任何恶意文件将自动执行，从而实现任意代码执行和潜在的系统完整性破坏。

**投毒风险分析**
`CVE-2025-8088-WinRAR-builder` POC仓库对安全研究人员或将其用于合法防御目的的用户来说，投毒风险极低。对提供的`README.md`和`builder.py`脚本进行全面审查后，没有发现任何表明恶意意图或隐藏功能的指标，不会对用户的系统造成危害。

**代码透明度和可审查性**：该Python代码以高度透明和可读的方式开发。代码中没有使用任何模糊化、加密或其他通常被恶意行为者用来隐藏其活动的技术。构建RAR存档、操纵其内部头部以及为载荷嵌入备用数据流（ADS）的逻辑在`builder.py`脚本中明确可见且易于理解。这种透明度允许安全专业人员进行直接的审计和验证，确保该工具仅执行其宣传的漏洞利用生成功能。

**依赖项和供应链完整性**：该脚本仅依赖于标准的Python库，包括`os`、`struct`、`subprocess`、`zlib`、`sys`、`shutil`、`pathlib`和`typing`。这些是Python生态系统的核心组件，由受信任的来源维护，并且极不可能包含未公开的恶意代码。至关重要的是，该POC不需要从任何可能不受信任的存储库安装任何晦涩的第三方软件包。这显著降低了供应链风险，因为没有机会通过受损的依赖项注入恶意代码。

**网络活动和数据外泄**：对`builder.py`代码的检查证实，该脚本不会发起任何未经授权或意外的出站网络连接。它不会尝试从外部服务器下载额外的组件、与命令和控制（C2）基础设施通信，也不会从主机机器外泄任何数据。脚本执行的所有操作都局限于本地文件系统，专注于生成漏洞利用存档。这种缺乏网络通信是该工具非恶意性质的有力指标。

**系统交互范围**：`builder.py`脚本执行的系统交互与其目的完全一致。这些交互主要涉及文件系统操作，例如创建临时目录、读取用户提供的载荷文件以及写入最终的`exploit.rar`输出文件。尽管该脚本在某些实现中可能会利用`subprocess`模块与`rar.exe`等外部工具进行交互（尽管提供的片段表明它直接构建RAR结构），但此类操作在制作RAR存档的上下文中是合法且预期的。脚本的操作严格限于漏洞利用生成所需的范围，不会涉及任何可能暗示主机系统被入侵的领域。

**漏洞利用与投毒工具的区别**：区分POC的恶意“输出”（即制作的`exploit.rar`文件）与POC脚本本身的良性性质至关重要。`PAYLOAD_MAPPING`部分明确指定用户在`payloads`目录中提供的文件是*生成的漏洞利用所要部署的*恶意内容，而不是POC脚本本身中嵌入的恶意组件。这种设计明确表明POC是一个用于创建攻击工件的工具，而不是攻击工件本身。该脚本有助于创建有害的载荷，但它不会为研究人员嵌入自我伤害的功能。综上所述，`CVE-2025-8088-WinRAR-builder`仓库通过其透明的代码、最小且受信任的依赖项、缺乏网络通信以及受限的系统交互，对任何将其用于防御性安全研究或测试目的的人来说，投毒风险微乎其微。

**项目地址:** https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git

**漏洞详情:** 
