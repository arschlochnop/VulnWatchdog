## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal), 任意文件写入 (Arbitrary File Write), 任意代码执行 (Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal), 任意文件写入 (Arbitrary File Write), 任意代码执行 (Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** CVSS v3.1 8.4

**影响版本:** 7.12 及更低版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 无需认证, 需要用户解压特制恶意RAR压缩包, 受害者系统需安装WinRAR 7.12或更低版本

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-8088是WinRAR软件中存在的一个高危路径遍历漏洞，CVSS v3.1评分为8.4。该漏洞的核心机制在于WinRAR在解压特制压缩包时，未能正确处理文件路径，导致攻击者可以利用Windows NTFS备用数据流（ADS）和目录穿越技术，将恶意文件释放到系统任意位置，例如Windows启动文件夹。一旦文件被释放到启动目录，系统在下次启动时会自动执行该恶意文件，从而实现任意代码执行。根据搜索结果，该漏洞已被UNC4895 (RomCom)、APT44、Turla等多个高级持续性威胁（APT）组织广泛利用，针对乌克兰军事及政府机构进行攻击，甚至有中国境内的非法攻击团伙也在利用。ESET和谷歌威胁情报小组也证实了该漏洞的零日和在野利用情况。

提供的POC代码`CVE-2025-8088-WinRAR-builder`是一个Python脚本，旨在自动化构建恶意RAR压缩包以利用此漏洞。该POC的工作原理是：首先创建一个RAR文件，并通过巧妙地操纵RAR头和利用NTFS ADS特性，将用户指定的payload文件（例如`.lnk`快捷方式、`.exe`可执行文件等）嵌入到RAR压缩包中。然后，通过路径遍历技术，恶意RAR文件在解压时会强制WinRAR将这些payload文件写入到受害者系统上的特定目标路径，如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`目录。当受害者使用受影响版本（7.12及更低版本）的WinRAR解压这个特制压缩包时，payload文件就会被放置到启动目录。系统下次重启时，该payload将自动执行，从而导致任意代码执行。

该POC脚本的`builder.py`文件清晰地展示了如何配置payload文件和其对应的目标解压路径，例如将`cmd.lnk`放置到启动文件夹。`README.md`文件提供了详细的使用说明和执行流程，包括如何克隆仓库、准备payload、配置映射以及运行脚本。POC明确指出，需要Windows操作系统、Python 3.x和WinRAR环境来运行。代码逻辑清晰，没有明显的错误，且与漏洞原理完全吻合，因此判断该POC是完整可用且有效的。它能够成功生成一个利用CVE-2025-8088的恶意RAR文件，为防御者提供了重现和分析漏洞的有力工具。

**利用步骤**:
1. 克隆POC仓库：`git clone https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git`
2. 进入目录：`cd CVE-2025-8088-WinRAR-builder`
3. 创建`payloads`文件夹并放入恶意文件（例如`evil.exe`或`malicious.lnk`）。
4. 编辑`builder.py`中的`PAYLOAD_MAPPING`列表，将payload文件名映射到目标解压路径，例如：`PAYLOAD_MAPPING: List[Tuple[str, str]] = [("evil.exe", "..\\..\\..\\..\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\important_update.exe")]`
5. 运行构建脚本，提供一个诱饵文件作为参数：`python builder.py decoy.txt`。这将生成一个名为`exploit.rar`的恶意压缩包。
6. 诱骗受害者在安装了WinRAR 7.12或更低版本的Windows系统上解压`exploit.rar`。
7. 一旦受害者解压了该压缩包，恶意文件（如`important_update.exe`）将被写入其启动目录。
8. 受害者系统在下次重启时，将自动执行该恶意文件，从而实现任意代码执行。

**投毒风险分析**:
该POC代码的投毒风险极低，评估为5%。其主要原因如下：
1. **代码透明度高**: `builder.py`是用Python编写的，代码结构清晰，逻辑易于理解，没有进行任何混淆处理。所有文件操作、RAR头构造和子进程调用都清晰可见。
2. **标准库使用**: POC仅依赖Python的标准库（如`os`, `subprocess`, `zlib`等）以及WinRAR的命令行工具（`rar.exe`），不涉及任何第三方恶意库或外部依赖。
3. **无恶意网络行为**: 代码中没有发现任何进行网络连接、下载外部资源、与C2服务器通信或向外部发送数据的行为。它完全是一个本地文件操作工具。
4. **明确的利用目的**: 该POC的唯一目的是生成一个恶意RAR文件，以演示或验证CVE-2025-8088漏洞。它本身不包含任何后门、勒索软件或其他恶意功能。
5. **用户控制**: 攻击者/研究人员需要明确指定`payloads`目录中的文件，并通过`PAYLOAD_MAPPING`配置其目标路径。这意味着恶意payload的性质和目标完全由用户决定，POC本身并未硬编码任何恶意内容。
尽管风险极低，但仍然存在一些非技术性风险，主要源于用户的误操作或对POC目的的误解：
*   **误用**: 如果不熟悉安全研究的用户误以为这是无害的工具，并在生产环境中生成并解压了包含真实恶意payload的RAR文件，可能会对自身系统造成损害。
*   **意外感染**: 在测试过程中，如果将真实的恶意样本作为payload进行测试，并意外在测试环境中执行，可能导致测试环境感染。因此，虽然POC代码本身是干净的，但使用时仍需谨慎，严格在隔离的测试环境中进行，并确保理解其工作原理，避免因操作不当造成意外后果。

**项目地址:** https://github.com/papcaii2004/CVE-2025-8088-WinRAR-builder.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
