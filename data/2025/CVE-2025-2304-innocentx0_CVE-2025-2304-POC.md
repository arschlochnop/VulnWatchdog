## CVE-2025-2304 - Camaleon CMS 特权升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** N/A

**影响版本:** 低于 2.9.1 版本 (例如 2.9.0)

**利用条件:** 需要认证 (低权限用户), 需要网络访问和请求拦截/修改能力

**POC 可用性:** 4

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

POC有效性分析：
提供的POC详细描述了针对Camaleon CMS版本2.9.0的特权升级漏洞（通过Mass Assignment）的手动利用步骤。此漏洞允许低权限用户通过操纵密码更改请求来提升其账户权限至管理员。POC的核心在于拦截一个`updated_ajax`请求，并在其POST请求体中注入额外的参数`password[role]=admin`。如果应用程序未能对所有传入的参数进行严格的授权检查或输入验证，并直接将这些参数映射到数据库中的用户对象属性，就可能导致攻击者控制不应由用户修改的敏感字段，例如用户角色。POC明确指出“不要在repeater中执行”，这可能意味着请求的上下文或会话状态对于漏洞的成功利用至关重要，需要在一个实时且正确的请求流程中进行。尽管目前POC仅为手动操作指南，而非自动化脚本，但其描述的Mass Assignment机制是一种常见的Web应用漏洞类型，其原理清晰，利用步骤具体，因此概念验证的有效性较高。成功的利用将赋予低权限用户管理员权限，从而完全控制CMS系统。

利用步骤：
1.  以任意低权限用户（例如，一个名为“Bob”的普通用户）身份登录到Camaleon CMS。
2.  启动一个Web代理工具，例如Burp Suite或Caido，并配置浏览器以拦截所有HTTP/HTTPS流量。
3.  在CMS界面中，导航到用户个人资料设置，并尝试更改当前用户的密码。
4.  当执行密码更改操作时，代理工具会捕获到发送给服务器的`updated_ajax`请求。拦截此请求。
5.  在被拦截的POST请求体中，手动添加一个参数：`password[role]=admin`。确保这个参数与其他现有参数一起提交。
6.  转发修改后的请求至服务器。POC特别强调，此操作应在正常请求流程中完成，而非通过代理工具的“Repeater”功能单独发送。
7.  如果漏洞成功被利用，服务器将处理此请求并将用户的角色在数据库中更新为“admin”。攻击者现在应具备管理员权限。

投毒风险分析：
当前提供的POC是一个纯文本的`README.md`文件，仅包含关于如何手动执行攻击的文字说明和步骤。它不包含任何可执行代码、脚本文件、外部链接或二进制组件。因此，从直接分析这份POC代码（即这份`README.md`文件）的角度来看，其本身不携带任何恶意负载、后门代码或混淆逻辑，其投毒风险为极低（0%）。这意味着，使用者不会因为下载或阅读这份README文件而直接遭受恶意软件感染、系统损害或信息泄露。然而，值得注意的是，POC中提到“A python3 PoC will be available as soon as possible.”。一旦未来发布了自动化Python POC或其他形式的可执行代码，其投毒风险将需要重新进行评估。届时，必须对新的POC代码进行彻底的安全审查，以检测是否存在隐藏的恶意行为，例如：下载并执行外部恶意脚本、创建反向Shell、收集敏感信息、进行拒绝服务攻击等。对于当前的手动POC，唯一的“风险”在于攻击者如果遵循其步骤在生产环境中进行未经授权的测试，可能会导致非法访问和数据篡改。但这是利用漏洞本身的风险，而非POC代码被“投毒”的风险。

**项目地址:** N/A

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
