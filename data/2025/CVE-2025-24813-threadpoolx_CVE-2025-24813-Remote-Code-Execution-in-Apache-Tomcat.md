## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** 9.0 (CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100

**利用条件:** Non-default server configuration altering URL parsing behavior, partial PUT enabled

**POC 可用性:** 9/10

**POC 类型:** Conceptual Exploit

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-24813 is a critical vulnerability in Apache Tomcat arising from inconsistent URL parsing, specifically concerning semicolons (;). This inconsistency enables attackers to bypass security constraints and achieve Remote Code Execution (RCE) under specific non-default server configurations. The vulnerability stems from a desynchronization between the security manager and the file system resolver when handling URLs containing semicolons. The security manager may parse the path up to the semicolon, checking security rules only for the initial part of the path. If this initial part is permissible, the request is approved. However, the file system resolver interprets the entire path, including the part after the semicolon, potentially leading to access to restricted directories. Exploitability hinges on a non-default Tomcat configuration where the standard URL parsing behavior is altered, alongside the presence of file upload functionality. An attacker can craft a malicious URL containing a semicolon to bypass security checks, upload a JSP file (e.g., shell.jsp) to a restricted directory (e.g., /uploads/), and then execute it, achieving RCE. The provided POC in the README.md outlines the conceptual exploit logic. It highlights that an attacker can leverage the path equivalence issue to trick Tomcat into serving files from locations it should otherwise restrict access to. The attack chain involves crafting a URL like `/app/user/..;/uploads/shell.jsp`, where `/app/user/` is a public directory and `/uploads/` is a restricted directory. The security manager approves access based on `/app/user/`, while the file system resolver ultimately serves the file from `/uploads/shell.jsp`. 

**利用步骤：**
1. 确定目标Tomcat服务器启用了`allowLinking`或存在类似可利用的配置问题。
2. 构造包含`..;`的恶意URL，指向受保护的上传目录中的JSP文件。
3. 通过上传功能，将恶意JSP文件上传至目标目录。
4. 使用构造的URL访问上传的JSP文件，触发RCE。

**投毒风险分析：**
该POC的投毒风险较低，约为10%。主要风险在于攻击者可能在上传的JSP shell中嵌入恶意代码。然而，由于JSP shell本身是利用漏洞的必要组成部分，因此很难将其与恶意投毒行为完全区分开来。此外，POC代码本身清晰，主要依赖Tomcat服务器的配置缺陷，没有发现明显的混淆或恶意行为。 尽管风险较低，安全团队仍应审查任何通过此漏洞上传的文件，并监控服务器行为，以防止潜在的恶意活动。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
