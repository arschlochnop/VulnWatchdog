## CVE-2025-55182 - React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 高危

**CVSS评分:** 未提供具体数值，但描述为核弹级/高危漏洞，预估CVSSv3.1评分在9.0-10.0之间

**影响版本:** Next.js < 14.3.2, Next.js < 15.2.4 (针对Next.js框架); 其他基于React Server Components的应用可能受影响，特别是使用了react-server-dom-we的旧版本

**利用条件:** 未认证、通过精心构造的multipart表单请求、需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 被动检测工具/概念验证 (无代码执行)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55182，又称“React2Shell”，是一个在React Server Components (RSC) 中发现的远程代码执行 (RCE) 漏洞，被广泛认为是“核弹级”和“致命”漏洞。该漏洞主要影响Next.js、Shopify Hydrogen和Gatsby 5等主流框架中广泛采用的RSC架构。其核心问题在于React Flight反序列化机制对对象属性访问路径（如__proto__、constructor）缺乏严格校验。攻击者可以在未经身份验证的情况下，通过精心构造的HTTP请求执行任意代码，对受影响的系统造成严重威胁。据报道，该漏洞自2025年12月3日公开披露以来，已遭到大规模的实际利用，首例Windows终端攻击尝试可追溯至2025年12月4日。

漏洞利用过程涉及构造恶意的multipart表单。攻击者可以通过利用$B引用，结合可控的_response._prefix和被劫持为Function类型的_formData.get，动态生成包含任意系统命令的函数。随后，该恶意函数被赋值给对象的.then属性。当RSC的“Flight”协议将序列化数据以JSON-like流式格式发送到客户端并在服务端进行反序列化处理时，由于反序列化过程未正确校验，导致原型链被污染，进而触发JavaScript Promise机制，最终在服务器端执行预设的系统命令，实现远程代码执行。这个过程不需要认证，只需要攻击者能够向目标服务器发送特制的HTTP请求。

提供的Python脚本 `passive.py` 是一个专为CVE-2025-55182设计的“被动扫描器”，旨在实现“隐秘检测”而非主动利用。该工具明确指出“仅进行行为测试——不执行代码”，并通过“错误模式指纹识别”来检测漏洞，而非注入RCE有效载荷。尽管它不是一个直接的漏洞利用工具，但作为概念验证和检测工具，其质量和有效性极高。该POC具备以下关键特性：多重探测机制，包含多种反序列化探测器（如`broken_flight_ref`、`invalid_promise`、`constructor_ref`），这些探测器经过精心设计，以增加检测成功率，同时尽量避免触发WAF规则；版本检测与补丁感知，能够检测目标框架的版本，并对照已知的补丁版本（例如Next.js 14.3.2+和15.2.4+为已修复版本）进行判断，准确识别易受攻击的版本；RSC端点发现，通过扫描`robots.txt`、`sitemap`以及常见的路径来发现潜在的RSC端点，扩大检测范围；指纹识别，结合头部信息和RSC `Accept` 头探测进行指纹识别，进一步提高检测准确性；WAF友好，探测请求被设计为WAF友好型，降低被防火墙拦截的风险；大规模扫描能力，支持通过URL列表进行大规模扫描，并提供结构化的JSON/CSV/TXT输出，便于自动化处理和报告；稳定性，包含可达性预检查、带抖动的速率限制功能，确保扫描过程的稳定性和隐蔽性。这是一个功能完善、设计精良、文档齐全的被动检测工具，对于安全团队进行大规模脆弱性评估或作为防御前置的预警机制具有显著价值。它能在不实际执行恶意代码的情况下，有效识别出存在CVE-2025-55182漏洞的系统，其作为检测类POC的质量可评为9/10。

综合评估POC代码后，可以断定其投毒风险为0%，即极低。首先，POC代码采用Python编写，结构清晰，注释详细，变量命名规范，极易阅读和审计，没有发现任何混淆、加密或难以理解的部分。其次，该脚本主要依赖Python标准库和广受欢迎的`requests`库，`requests`是一个成熟且广泛用于HTTP请求的第三方库，其安全性已得到充分验证，代码中未导入任何可疑的、不常见的或恶意第三方库。再者，脚本的明确目的是进行“隐秘检测”和“行为测试”，并且明确声明“不执行代码”。在代码中，没有发现任何尝试执行系统命令（如`os.system()`、`subprocess.run()`）、`eval()`、`exec()`等可能导致代码执行的函数调用。它仅向目标服务器发送特定的HTTP请求，并分析服务器的响应，不涉及在本地运行扫描器的主机上执行任何外部或恶意代码。此外，代码中没有迹象表明它会向除目标服务器之外的任何其他地址发送数据，或尝试建立C2（命令与控制）连接，以窃取信息或下载恶意载荷。除了可能的日志或结果输出，脚本不会尝试修改本地文件系统，不创建、删除或篡改敏感文件。鉴于POC代码的透明度、使用的标准安全库、明确的非恶意目的声明以及缺乏任何可疑功能，该POC被认定为不携带任何投毒风险。安全研究人员和团队可以放心地运行此脚本进行漏洞检测。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
