## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** Next.js < 14.3.2, Next.js < 15.2.4 (以及其他使用受影响react-server-dom-we的React Server Components实现)

**利用条件:** 未经身份验证 (Unauthenticated), 需要网络访问 (Network access), 攻击者需构造恶意multipart表单

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (漏洞检测工具)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：
提供的Python脚本（`passive.py`）是一个先进的被动扫描器，旨在检测CVE-2025-55182（又名“React2Shell”）的存在。该漏洞是影响React服务器组件和Next.js应用程序的一个关键远程代码执行（RCE）漏洞。该扫描器明确设计用于隐蔽检测，不使用主动RCE payloads，因此适用于安全评估而不会造成意外的系统中断。其主要漏洞检测方法包括“错误模式指纹识别”，即分析响应中的特定错误消息或堆栈跟踪，这些信息表明存在反序列化缺陷；以及“框架版本检测”，根据其内部的`PATCHED_VERSIONS`映射（例如，Next.js版本低于14.3.2或15.2.4被认为是易受攻击的）来识别易受攻击的Next.js版本。该工具还通过检查通用路径、`robots.txt`和`sitemap.xml`来发现“RSC端点”，并使用“基于标头的指纹识别”和“RSC Accept标头探测”来识别目标技术。代码结构良好，使用标准Python库，并包含强大的功能，如可达性预检查、带抖动的速率限制以规避WAF、用于大规模扫描的多线程以及结构化输出格式（JSON/CSV/TXT），表明这是一个高质量、成熟的检测工具。扫描器的有效性在很大程度上取决于其定义的错误模式的准确性以及其正确识别目标应用程序框架和版本的能力。它严格遵守对目标执行“仅行为测试——不执行代码”，确保了非侵入性评估。

利用步骤 (CVE-2025-55182)：
CVE-2025-55182是一个关键的RCE漏洞，源于Next.js和React服务器组件中React Flight反序列化处理不当。核心问题在于反序列化机制未能验证对象属性访问路径，特别是涉及`__proto__`或`constructor`的路径。攻击者可以通过精心构造的`multipart`表单来利用此漏洞。此表单经过精心设计，利用Flight协议中的`$B`引用，允许攻击者操纵内部对象属性。关键步骤包括控制`_response._prefix`等字段，并劫持`_formData.get`——这种技术可以将它们强制转换为`Function`对象。通过这样做，攻击者可以动态生成一个包含任意系统命令的函数。然后，这个恶意构造的函数被赋值给一个易受攻击对象的`.then`属性。当服务器处理或等待此对象时，现在包含攻击者控制的函数的`.then`属性被调用，导致嵌入的系统命令在服务器上执行。攻击通常涉及直接向易受攻击的Next.js/React应用程序发送一个专门设计的HTTP请求，无需事先进行身份验证，使其成为一个高影响、低复杂度的威胁。

投毒风险分析 (POC代码)：
所提供的Python脚本`passive.py`是一个合法的防御性安全工具，旨在检测CVE-2025-55182漏洞。经过全面分析，该代码对运行脚本的用户表现出非常低的“投毒”或恶意意图风险。脚本明确声明其目的是“隐蔽检测”和“仅行为测试——不执行代码”，强调其非利用性质。它以清晰、可读的Python 3编写，仅使用标准和广泛接受的第三方库，如`requests`、`urllib3`、`argparse`、`json`、`csv`、`time`、`random`和`concurrent.futures`。没有证据表明代码混淆、可疑的动态代码执行（如`eval()`），或调用外部、未知或潜在恶意的URL来获取额外的payloads或脚本。脚本的逻辑主要包括向指定目标发出HTTP请求，分析服务器响应以获取错误模式和版本信息，然后呈现结果。所有操作都局限于漏洞检测的范围。`BANNER`和详细日志清晰地传达了脚本的行为和意图。因此，用户可以高度自信地执行此脚本，相信它将执行其声明的被动漏洞扫描功能，而不会在他们的系统上引入任何隐藏的恶意活动或后门。总体投毒风险评估为低（10%）。

**项目地址:** 

**漏洞详情:** 
