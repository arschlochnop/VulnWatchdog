## CVE-2025-32463 - Linux Sudo 本地提权 (Local Privilege Escalation, LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation, LPE)

**影响应用:** Linux Sudo

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.3

**影响版本:** Sudo版本1.8.8至1.9.17 (不包含1.9.17p1，例如1.9.17及之前版本受影响)

**利用条件:** 需要本地低权限用户访问权限，且目标系统启用了nsswitch功能。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463 是 Linux Sudo 组件中的一个高危本地提权漏洞，其 CVSS 评分为 9.3，属于严重级别。该漏洞主要影响 Sudo 的 `--chroot` 功能，源于其在处理非可信控制范围时存在缺陷，特别是在 chroot 环境中处理命令匹配和 `nsswitch` 模块加载时。攻击者可以通过构造恶意的环境参数，在使用 `sudo --chroot` 命令时绕过权限检查，从而在受影响的系统上获取 `root` 权限。受影响的版本范围为 Sudo 1.8.8 至 1.9.17（不包含 1.9.17p1）。

**POC有效性分析:**

提供的POC是一个名为 `cve202532463.sh` 的Shell脚本，旨在自动化利用 CVE-2025-32463 漏洞。配套的 `README.md` 文件清晰地描述了漏洞背景、利用方式、前置条件以及补丁信息。该脚本首先会检查当前用户是否为 `root`（如果是则退出），然后验证系统是否安装了 `gcc`（用于编译）和 `sudo` 工具，并检查 `/etc/nsswitch.conf` 文件是否存在，以确保 `nsswitch` 功能已启用。此外，它还会通过 `sudo --version` 命令确认 `sudo` 版本是否在受影响的范围（POC明确指出针对 1.9.14 到 1.9.17 版本）。

该漏洞的典型利用方式是，低权限用户首先创建一个受控的 chroot 环境。在此环境中，攻击者会放置一个特制的恶意共享库（例如，一个伪造的 `nsswitch` 模块，如 `libnss_poc.so`）以及必要的配置。当 `sudo` 命令在 `--chroot` 选项下运行时，如果其内部机制错误地加载了 chroot 环境中的恶意 `nsswitch` 模块，该模块便可以在 `root` 权限下执行任意代码。POC脚本通过自动化这些步骤，最终成功地将低权限用户的Shell提升到 `root` 权限，其输出 `uid=0(root)` 明确验证了利用的成功。鉴于其清晰的文档、自动化流程、前置条件检查和明确的成功反馈，此POC具有高度的有效性和可用性。

**利用步骤:**

1.  **环境检查与准备**: 攻击者需要获得目标系统的本地低权限用户Shell访问权限。确认目标系统安装的 Sudo 版本在 1.8.8 到 1.9.17 之间（不含 1.9.17p1），并且 `/etc/nsswitch.conf` 文件存在，表明 `nsswitch` 功能已启用。
2.  **下载POC脚本**: 使用 `wget` 命令从指定GitHub仓库下载 `cve202532463.sh` 脚本。例如：`wget https://github.com/aexdyhaxor/CVE-2025-32463/raw/refs/heads/main/cve202532463.sh`。
3.  **脚本执行**: 在下载POC后，通过 Bash Shell 执行该脚本：`bash cve202532463.sh`。
4.  **验证提权**: 脚本执行后，如果利用成功，将输出 `woot!` 消息，并为攻击者提供一个 `root` 权限的Shell提示符（例如 `root@ubutes01:/#`）。此时，执行 `id` 命令将显示 `uid=0(root)`，确认提权成功。
5.  **清理**: 脚本包含 `cleanup` 函数，用于在执行完成后移除创建的临时文件和目录，以减少攻击痕迹。

**投毒风险分析:**

对提供的 `cve202532463.sh` POC 脚本进行详细分析后，其投毒风险评估为较低（5%）。该脚本代码结构清晰，使用了标准的Bash命令和函数，未发现明显的代码混淆、加密或其他试图隐藏恶意行为的手段。脚本的主要功能围绕漏洞利用展开，包括环境检测、临时文件创建、编译（依赖 `gcc` 表明可能在临时目录中编译C语言代码以生成恶意共享库），以及最终通过特制的 `sudo --chroot` 命令触发提权。这些操作与 Sudo chroot 漏洞的常见利用模式一致。

脚本的外部依赖仅限于初始下载时的 `wget` 命令，用于从公开的 GitHub 仓库获取脚本本身。在执行过程中，脚本不涉及额外的外部网络通信，例如连接C2服务器、下载额外的恶意载荷或进行数据窃取。脚本中包含明确的清理机制 (`cleanup` 函数)，用于在执行后删除创建的临时目录和文件，这体现了负责任的漏洞研究行为，而非恶意软件的持久化尝试。

`README.md` 中包含的免责声明进一步支持了其作为防御性安全研究工具的性质，强调其仅用于教育和测试目的，禁止在未经授权的系统上使用。鉴于上述分析，该POC的核心目标是展示漏洞的利用，而不是作为攻击工具携带额外的恶意功能。因此，其投毒风险主要来源于脚本可能在未来被恶意第三方篡改，或在下载过程中遭遇中间人攻击，但就当前提供的代码而言，其本身不具备额外的恶意载载荷或行为。

**项目地址:** https://github.com/aexdyhaxor/CVE-2025-32463/

**漏洞详情:** https://ubuntu.com/security/CVE-2025-32463
