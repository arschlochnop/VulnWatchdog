## CVE-2025-32463 - sudo 本地提权 (EoP)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (EoP)

**影响应用:** sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17p1 之前的版本

**利用条件:** 本地低权限用户访问、sudo 支持 chroot 选项 (-R)、存在可控目录

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 sudo 的 chroot 机制（-R 选项）在实现上存在缺陷。当执行带有 -R 选项的命令时，sudo 在切换根目录后未能正确隔离环境，导致其尝试加载受用户控制目录下的 /etc/nsswitch.conf 配置文件。攻击者可以通过在自己拥有的目录下伪造特定的 /etc/nsswitch.conf 和恶意的共享库文件（如 libnss_custom.so.2），利用动态链接器的加载机制，在 sudo 以 root 权限运行的过程中劫持执行流。提供的 Shell 脚本 POC 展示了自动化的攻击过程：首先创建一个模拟的 chroot 目录结构，写入恶意 C 代码并编译为共享库，随后通过 `sudo -R` 命令触发漏洞。脚本逻辑完整，包含了环境检测（gcc、sudo 版本）、payload 编译以及最终的提权验证。此漏洞利用路径清晰，无需特殊内核漏洞配合，仅依赖 sudo 自身的配置缺陷，因此在受影响版本中具有极高的利用成功率。利用步骤：1. 在用户可写目录（如 /tmp）下创建一个伪造的根目录结构，包含 etc 和 lib 子目录。2. 编写一个惡意的共享库（C 语言），其构造函数包含提权逻辑（如执行 /bin/bash）。3. 将该库放置在伪造的 lib 目录下，并在伪造的 etc 目录下创建 nsswitch.conf，配置其加载该恶意库。4. 使用具有执行权限的命令调用 `sudo -R [伪造目录] [命令]`。5. sudo 在 chroot 后读取伪造的 nsswitch.conf 并加载恶意库，从而获得 root shell。投毒风险分析：该 POC 脚本主要采用标准的 Bash 脚本编写，其行为逻辑透明，主要包括文件创建、gcc 编译和 sudo 调用。通过对代码段的审查，并未发现明显的恶意混淆、远程恶意服务器回调或隐蔽的系统破坏代码。脚本中使用了 `wget` 下载主脚本，这在自动化利用中属于常见操作，但用户在使用时需警惕 URL 指向的安全性。由于脚本直接要求 root 提权，攻击者可能会在公开的 POC 中植入反弹 shell 或静默修改 /etc/shadow 的指令。目前的 PoC 代码中，cleanup 函数处理了临时文件的清理，且 payload 逻辑仅限于弹出 shell，属于典型的安全研究范畴。然而，风险点在于该 POC 引用了预编译的二进制库链接（虽脚本内有编译逻辑），在生产环境直接运行未经审计的二进制文件存在中度风险。建议研究人员在隔离环境（VM 或容器）中手动编译 payload 以确保安全。整体而言，该代码结构规范，未见针对研究员主机的投毒意图，但仍需防范供应链中可能被篡改的下载链接。

**项目地址:** [https://github.com/aexdyhaxor/CVE-2025-32463/](https://github.com/aexdyhaxor/CVE-2025-32463/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
