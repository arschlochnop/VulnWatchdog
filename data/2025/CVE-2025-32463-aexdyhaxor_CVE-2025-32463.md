## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地用户访问权限，sudo 开启 chroot 支持 (-R 选项)，且系统启用 nsswitch

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）的核心在于 Sudo 在执行带有 --chroot (-R) 选项的命令时，未能正确隔离共享库的加载路径。攻击者可以利用这一缺陷，通过在一个由其控制的目录中伪造 /etc/nsswitch.conf 文件。由于 Sudo 会加载该配置文件并根据其指示加载相应的 NSS 库（Name Service Switch libraries），攻击者可以在该受控目录中放置一个恶意的共享库。当 Sudo 尝试在 chroot 环境下运行命令并调用 NSS 相关函数时，它会加载并以 root 权限执行该恶意库中的代码。提供的 shell 脚本 POC 逻辑清晰，自动创建了所需的目录结构，并在其中生成了虚假的配置环境。它利用了 sudo 的 -R 参数将根目录重定向至攻击者可写的目录。该 POC 包含了编译恶意 .so 文件并将其链接到 nsswitch 流程的步骤，验证了从普通用户权限获取 root shell 的全过程。在测试环境下，该脚本能够实现一键式提权，证明该 POC 具有极高的有效性和实用性。利用步骤如下：1. 环境确认：检查 sudo 版本是否在 1.9.14-1.9.17 之间且具有 -R 选项；2. 目录伪造：创建一个模拟 root 布局的临时目录，并构造 /etc 目录；3. 配置文件投毒：在临时目录的 /etc/nsswitch.conf 中定义自定义库加载路径；4. 恶意库注入：将预编译或现场编译的恶意共享库放置在对应位置；5. 触发利用：执行 sudo -R [临时目录] [任意低权限命令]，触发 NSS 库加载从而执行 Payload。【投毒风险分析】该 POC 的投毒风险被评估为低（15%）。分析其脚本内容（cve202532463.sh），其代码逻辑透明，主要执行的是标准的文件操作、GCC 编译指令以及对 sudo 命令的调用。脚本开头的变量定义和清理函数（cleanup）符合正常的开发规范。风险点在于脚本尝试从外部 GitHub 仓库下载预编译好的二进制文件或脚本（如 wget 指令），这在不受信任的源下可能导致执行非预期代码。然而，POC 的主体部分主要聚焦于本地环境的搭建。在安全研究场景中，此类脚本通常被视为标准的漏洞验证工具。投毒检测中未发现明显的代码混淆、远程命令与控制（C2）通信、或是对系统关键文件的恶意破坏逻辑。其主要行为（如创建 root shell）是提权 POC 的核心预期功能，而非隐蔽的后门行为。为了降低风险，研究人员在使用此类 POC 时应在隔离的沙箱环境或虚拟机中运行，并手动审查 wget 下载的目标内容。整体而言，该脚本作为安全研究用途是相对安全的，但仍需警惕来源不可信导致的供应链攻击风险。

**项目地址:** [https://github.com/aexdyhaxor/CVE-2025-32463/](https://github.com/aexdyhaxor/CVE-2025-32463/)

**漏洞详情:** [https://ubuntu.com/security/CVE-2025-32463](https://ubuntu.com/security/CVE-2025-32463)
