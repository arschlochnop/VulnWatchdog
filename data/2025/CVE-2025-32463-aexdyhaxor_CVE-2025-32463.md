## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 - 1.9.17

**利用条件:** 本地低权限用户访问；Sudo 支持 -R (chroot) 选项；系统启用 nsswitch.conf 机制

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 Sudo 1.9.14 版本引入的 chroot 机制缺陷。当使用 sudo -R (或 --chroot) 选项执行命令时，Sudo 在切换根目录后未能正确限制对外部配置文件（如 /etc/nsswitch.conf）的加载路径，或者在 chroot 之后依然根据不受信用户控制的目录加载动态库。提供的 Bash 脚本通过以下步骤验证有效性：首先检查 Sudo 版本是否在受影响区间内，随后在 /tmp 目录下创建一个模拟的 chroot 环境，并在其中放置精心构造的 nsswitch.conf 配置文件。该文件配置为引导系统加载攻击者预先编译好的恶意共享库（.so文件）。由于 Sudo 以 root 权限运行，在执行 chroot 操作时会触发该配置文件的读取并加载恶意库，从而在 root 上下文中执行任意代码（通常是启动一个 root shell）。该 POC 逻辑清晰，包含了依赖检查（gcc, sudo）、环境清理和自动编译逻辑，在 Ubuntu 24.04 等主流发行版上具有极高的成功率。利用步骤：1. 下载 cve202532463.sh 脚本；2. 赋予执行权限并运行，脚本会自动检测系统是否满足利用条件；3. 脚本在临时目录构建 rootfs 骨架，并编译一个旨在提权的 C 语言共享库；4. 调用 sudo -R 执行该环境，触发库加载；5. 成功后将直接获得 root 权限的交互式 Shell。投毒风险分析：该 POC 脚本虽然包含 wget 远程获取文件的指令，但其来源指向了已知的安全研究仓库（GitHub aexdyhaxor），主要用于获取辅助脚本。代码分析显示，其核心逻辑是在本地编译 C 代码，并没有进行复杂的代码混淆或加密处理。脚本中的 cleanup 函数确保了利用后的临时文件会被删除，减少了痕迹。然而，风险点在于：第一，该 POC 提供了一个预编译库的下载路径，在无法验证远程服务器文件完整性的情况下，直接运行 wget ... | bash 类操作存在被中间人攻击或上游仓库遭篡改的风险；第二，脚本在执行过程中会创建具有 SUID 权限的文件或尝试修改敏感环境，如果运行失败，可能会在系统留下不安全残留；第三，脚本未对编译环境进行严格隔离。综合评估，该 POC 属于标准的安全研究展示代码，投毒风险较低，但在生产环境测试前应将远程下载部分改为本地手动审核。

**项目地址:** [https://github.com/aexdyhaxor/CVE-2025-32463/](https://github.com/aexdyhaxor/CVE-2025-32463/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
