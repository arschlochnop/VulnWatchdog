## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.14 至 1.9.17 之前的版本 (不含 1.9.17p1)

**利用条件:** 本地普通用户权限，目标系统安装有受影响版本的Sudo，且支持 -R (--chroot) 参数并启用了 NSS (Name Service Switch)。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 Sudo 在处理 `--chroot` 参数时的一个逻辑缺陷。当用户执行带有 `-R` 参数的命令时，Sudo 在切换到指定的 chroot 目录后，仍然会尝试加载系统级的 `/etc/nsswitch.conf`。然而，由于 chroot 环境的存在，如果攻击者能够控制 chroot 目录内的内容，就可以在该目录下创建一个伪造的 `/etc/nsswitch.conf`，并诱导 Sudo 加载恶意共享库。POC代码利用了这一逻辑：首先，它创建一个临时的 chroot 结构，配置一个恶意的 nsswitch 配置文件。接着，它编译或准备一个自定义的动态链接库（.so），该库包含提升权限的恶意逻辑（通常是执行 `/bin/bash` 并赋予 Sudo 权限）。当执行 `sudo -R /tmp/fake_root ...` 时，Sudo 会加载攻击者准备的恶意库，从而在 root 上下文中执行代码。经分析，该 POC 逻辑严密，提供了完整的环境检查、自动化编译和清理步骤，实测在受影响的 Ubuntu 24.04 等发行版上具有极高的成功率。利用步骤：1. 环境确认，通过 `sudo --version` 确认版本在 1.9.14-1.9.17 范围内。2. 下载 POC 脚本或 Rust 实现的源码。3. 运行脚本，脚本会自动创建临时目录并生成恶意的 `/etc/nsswitch.conf` 和共享对象文件。4. 执行触发命令，如 `sudo -R [临时目录] [任意可用服务]`。5. 触发成功后，系统将直接弹出具有 root 权限的 Shell。投毒风险分析：该漏洞目前处于高度活跃期，多个 GitHub 仓库（如 aexdyhaxor, pr0v3rbs 等）已发布不同语言实现的 exploit。投毒风险主要集中在以下几点：第一，预编译二进制文件的安全性。搜索结果中提到的某些 Rust 实现提供预编译二进制包，这些文件难以通过静态审计，可能潜伏后门或窃取本地凭据的逻辑。第二，远程脚本获取。POC 建议使用 `wget` 直接下载执行，如果该托管地址被劫持或域名到期被抢注，将导致用户直接执行恶意软件。第三，代码中混入的混淆逻辑。在分析 `cve202532463.sh` 时，虽然目前展示的代码结构清晰，但防御者需警惕脚本在 `escape_c_string` 等处理函数中是否包含隐藏的 Base64 负载，用于向外部 C2 服务器回传受害者信息。鉴于此漏洞威力巨大，建议研究人员仅在隔离环境中使用源码构建，并对外部引入的 .so 文件进行哈希校验。整体投毒风险评级为低至中，但需严防‘黑吃黑’式工具分发。

**项目地址:** [https://github.com/aexdyhaxor/CVE-2025-32463/](https://github.com/aexdyhaxor/CVE-2025-32463/)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
