## CVE-2025-32463 - sudo 本地提权 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17 之前的版本

**利用条件:** 本地低权限用户访问、sudo支持chroot(-R选项)、启用了nsswitch.conf

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC通过Bash脚本自动化实现了对CVE-2025-32463的利用。核心原理是利用Sudo在1.9.14版本后引入的chroot支持缺陷。在执行具有chroot属性的sudo命令时，系统会错误地加载用户受控目录下的/etc/nsswitch.conf文件。攻击者通过在临时目录下伪造该配置文件，并诱导系统加载自定义的共享库（如libnss_custom.so），从而在root权限的上下文中执行恶意代码。脚本中包含了完整的依赖检测、环境准备、C代码编译（用于生成恶意的共享对象文件）以及最终的sudo触发逻辑。经过分析，该脚本逻辑清晰，直接针对漏洞触发点，在受影响的Ubuntu 24.04等系统中具有极高的利用成功率。利用步骤：1. 本地低权限用户下载cve202532463.sh脚本。2. 脚本检查系统环境是否包含gcc和受影响版本的sudo。3. 脚本在/tmp目录下创建一个模拟的chroot环境，并生成恶意的C语言代码。4. 使用gcc编译该代码为共享库文件。5. 脚本构造一个伪造的/etc/nsswitch.conf，将其指向该恶意库。6. 运行'sudo -R [路径] ...'触发漏洞。7. 系统以root权限加载恶意库，执行/bin/bash，攻击者获得root Shell。投毒风险分析：该POC代码开源且逻辑透明，主要风险在于其wget下载远程脚本的行为。虽然当前分析的代码段显示其仅用于合法的安全研究和漏洞修复后的验证，但其提供的下载链接（[github.com/aexdyhaxor/](https://www.google.com/search?q=https://github.com/aexdyhaxor/)...）属于第三方个人仓库，存在供应链投毒的潜在风险。若攻击者接管该仓库或在脚本后续更新中加入持久化后门、敏感信息回传（如反弹Shell至攻击者服务器、窃取/etc/shadow）等逻辑，普通用户在盲目执行bash脚本时将面临被控风险。目前脚本中的cleanup函数和标准库调用较为规范，未发现明显的代码混淆或恶意混淆行为。建议防御者在测试时，务必在隔离的沙箱环境中手动审查cve202532463.sh的完整代码，避免直接执行未经审计的远程脚本，并优先使用官方补丁进行加固。

**项目地址:** [https://github.com/aexdyhaxor/CVE-2025-32463/](https://github.com/aexdyhaxor/CVE-2025-32463/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
