## CVE-2025-27591 - Below 提权 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 提权 (Privilege Escalation)

**影响应用:** Below

**危害等级:** 高 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** < 0.9.0

**利用条件:** 本地低权限用户访问，目标系统安装了受影响版本的 below 实用程序且配置了错误的目录权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC针对CVE-2025-27591漏洞提供了完整的利用路径。该漏洞的核心在于below服务在初始化时创建了一个全球可写的目录 /var/log/below。POC利用这一特性，通过删除该目录下预期的日志文件并创建一个指向敏感系统文件（如 /etc/passwd）的符号链接来实现越权写入。脚本中通过循环执行 below live 触发服务以root权限写入日志的操作。由于符号链接的存在，原本应写入日志的数据被重定向到了 /etc/passwd。POC中定义的 USER_LINE 包含了一个预设密码为'1'的root权限用户 root2。脚本使用追加模式（>>）向目标路径写入该行。这种竞争条件的利用方式在Linux提权中非常经典且有效。经过分析，该POC逻辑清晰，利用了Linux文件系统链接处理的常见缺陷，在受影响的 below v0.9.0 之前的版本中具有极高的成功率。脚本还包含了备份 /etc/passwd 的防御性操作，增加了测试的安全性。利用步骤：1. 本地低权限用户执行脚本，脚本首先备份当前的密码文件。2. 脚本在 /var/log/below/ 下创建一个指向 /etc/passwd 的符号链接。3. 脚本进入循环，不断尝试启动 /usr/bin/below 进程并向日志路径写入 payload。4. 一旦系统将 payload 成功写入 /etc/passwd，用户即可通过 su - root2 切换至 root 权限。投毒风险分析：从防御性安全研究角度看，该POC的投毒风险极低。首先，代码结构透明，采用 Bash 编写，没有任何混淆、加密或二进制 Payload。脚本的行为完全符合其描述的提权逻辑，没有发现任何向外部服务器发送数据（如反弹 Shell 或敏感信息泄露）的恶意请求。其使用的命令均为系统标准命令（ln, printf, sudo, getent）。虽然脚本中包含了修改 /etc/passwd 的高风险操作，但这属于 POC 证明其提权能力的核心功能，而非隐藏的恶意逻辑。此外，代码中主动包含了备份原始文件的步骤，显示了开发者对环境恢复的考量。对比恶意投毒样本常见的特征（如隐藏的 eval、base64 编码的恶意指令、后台静默下载器），本 POC 未表现出任何异常。该项目托管在公共 GitHub 仓库，代码提交记录正常，属于典型的安全研究分享。研究人员在使用时仅需注意在隔离的沙盒环境中运行，以防利用过程中由于竞争条件导致的系统文件损坏，但从软件供应链安全的角度来看，该代码包是安全的。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
