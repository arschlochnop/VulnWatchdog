## CVE-2025-27591 - Below (Facebook/Meta 监控工具) 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Below (Facebook/Meta 监控工具)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < v0.9.0

**利用条件:** 攻击者需拥有目标系统的本地普通用户访问权限，且系统需安装有 v0.9.0 以下版本的 Below 服务。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞的根源在于 Below 服务在初始化时，错误地将其日志目录 /var/log/below 的权限设置为 0777 (world-writable)。由于 Below 服务通常以 root 权限运行或通过 sudo 执行以获取系统性能指标，这种权限配置失当为攻击者提供了攻击面。POC代码通过创建一个指向敏感系统文件（如 /etc/passwd）的符号链接（Symlink），将 Below 尝试写入的日志文件重定向。当 Below 以 root 权限执行并写入内容时，实际上是在修改 /etc/passwd。此 POC 的逻辑非常清晰且直接：首先，它在 /var/log/below 目录下创建一个名为 error_root.log 的符号链接，指向 /etc/passwd。接着，它触发 Below 运行（利用 sudo），导致 root 权限的 Below 写入日志。由于符号链接的存在，权限校验被绕过。最后，POC 向被破坏的文件中追加一个新的 root 用户项（root2），从而实现完全的权限提升。该 POC 具备极高的有效性，逻辑完全符合 Linux 符号链接攻击的典型特征。利用步骤：1. 确认目标系统 Below 版本低于 0.9.0。2. 在 /var/log/below/ 目录下创建指向 /etc/passwd 的符号链接 error_root.log。3. 诱导系统或通过现有权限执行 sudo below record 触发日志写入。4. 向 /etc/passwd 追加具有 root 权限的用户 payload。5. 使用新用户登录获取 root Shell。投毒风险分析：该 POC 代码片段由 Shell 脚本和 README 组成。从逻辑上看，该脚本的操作完全透明，主要依赖于标准的 Linux 命令如 ln, rm, echo, 和 sudo。代码库中没有发现任何混淆、base64 加密的载荷或与外部服务器建立反向 Shell 的可疑连接。POC 中定义的 PAYLOAD 是典型的权限提升手法（增加一个 UID 为 0 的用户），属于漏洞验证的范畴，而非恶意投毒行为。虽然在执行过程中使用了 sudo 命令，这在本地提权 POC 中是常见的前置条件。项目 README 虽然提到了外部 GitHub 仓库，但核心利用代码已直接给出，风险较低。主要的投毒风险点在于，如果用户直接从不可信的第三方仓库克隆并运行，可能会存在被替换恶意脚本的风险，但就目前提供的代码片段而言，其行为是安全且可控的。建议安全研究人员在隔离的 VM 环境中测试，并手动检查 shell 脚本中的每一行命令，尤其是涉及 sudo 或文件覆盖的操作。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
