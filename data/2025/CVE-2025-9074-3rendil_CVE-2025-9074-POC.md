## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < v4.44.3

**利用条件:** 本地运行恶意Linux容器、可访问特定内部子网(192.168.65.7)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC通过Shell脚本展示了CVE-2025-9074的完整利用链。漏洞核心在于Docker Desktop在Windows和macOS上运行的隔离机制不完善，导致本地运行的Linux容器可以通过默认子网地址192.168.65.7:2375直接访问宿主机的Docker Engine API。POC代码首先探测API的可访问性，随后构造一个JSON负载，通过API创建一个特权容器。该负载的关键点在于设置了'Privileged': true、'NetworkMode': 'host'以及最核心的挂载点'Binds': ['/:/hostfs:rw']。这种配置允许攻击者将宿主机的根目录映射到容器内部，从而实现完全的宿主机接管。利用步骤：1. 攻击者在本地启动监听器（如nc -lvnp 4444）。2. 运行POC脚本并指定目标网关IP、端口及攻击者IP。3. 脚本发送curl请求至Docker Engine API。4. API响应并创建恶意的Alpine容器，容器启动后执行反弹Shell指令。5. 攻击者获得宿主机权限并可通过/hostfs读写宿主机文件。该POC逻辑清晰，直接利用了API未授权访问的特性，由于不依赖卷挂载绕过，成功率极高，证实了漏洞的高危性。投毒风险分析：该POC项目结构简洁，包含README和Shell脚本。代码层面使用的是标准的bash工具（curl, grep, cut）和Docker官方API协议，未发现代码混淆、二进制加密执行、或者针对攻击者环境的敏感信息嗅探行为。payload中的反弹shell部分（rm /tmp/f;mkfifo /tmp/f...）是典型的渗透测试行为，旨在验证权限控制而非恶意投毒。脚本中所有变量均可通过命令行参数控制，透明度较高。虽然存在极低风险，即攻击者可能修改脚本中的LHOST为第三方监控服务器，但在当前提供的代码版本中，其行为完全符合安全研究与漏洞验证的规范。建议在受控的沙箱环境或虚拟机中运行此脚本，并确保API访问范围受限，以防意外泄露宿主机权限。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-9074-POC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-9074-POC) (示例链接)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
