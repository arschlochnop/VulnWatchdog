## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34.0之前的版本

**利用条件:** 攻击者需在本地运行一个恶意的Linux容器，且Docker Desktop配置中允许通过默认子网192.168.65.7访问Engine API

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个功能完整的Bash脚本，通过利用Docker Desktop在特定版本中默认监听的内部API端口进行攻击。在受影响的配置中，Docker Engine API会暴露在内部网桥地址（通常为192.168.65.7）的2375端口上。该脚本首先通过curl访问/version路径验证API的可访问性，随后构造一个恶意JSON负载发送至/containers/create接口。该负载极具威胁性，它指定了alpine镜像并配置了'Binds': ['/:/hostfs:rw']、'Privileged': true以及'NetworkMode': host。这意味着新创建的容器将拥有宿主机的完整根文件系统读写权限、特权模式以及宿主机网络栈。利用步骤：1. 攻击者在本地或受控容器内运行脚本；2. 脚本检测192.168.65.7:2375是否开启；3. 脚本发送POST请求创建特权容器，并将宿主机根目录挂载至容器内的/hostfs；4. 容器启动后通过mkfifo和nc向攻击者指定的IP/端口反弹一个交互式Shell；5. 攻击者通过该Shell直接操作宿主机文件系统。经分析，此POC逻辑清晰且符合Docker API规范，在未修补的环境下具有极高的成功率。 投毒风险分析：该POC代码结构简洁，主要使用标准的curl、cat、grep和cut命令，未发现明显的代码混淆或加壳行为。脚本中的Payload部分清晰地展示了容器创建参数，易于安全人员审计。脚本逻辑中除目标IP和监听IP外，不涉及向第三方未知服务器发送敏感数据的行为。潜在的风险点在于其依赖的alpine镜像拉取过程，但在安全测试环境中通常被认为是正常的。由于该脚本直接实现了自动化的反弹Shell攻击，且利用了默认的192.168.65.7地址，这种高度集成的自动化工具如果被发布在非官方渠道，极易被二次修改并植入真正的恶意payload（如静默修改LHOST指向攻击者的服务器）。对于防御性安全研究员而言，虽然此版本代码目前是安全的，但必须警惕此类直接利用API进行特权挂载的行为，这在威胁建模中属于典型的逃逸路径。建议仅在隔离的实验环境中运行此脚本，并严格限制出口流量。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-9074-POC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-9074-POC) (模拟链接)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
