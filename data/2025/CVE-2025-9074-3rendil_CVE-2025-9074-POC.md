## CVE-2025-9074 - Docker Daemon 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Docker Daemon

**危害等级:** 高危

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 所有暴露Docker Daemon API的未授权配置版本

**利用条件:** 无需认证，需要网络访问目标Docker Daemon API端口

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

POC有效性分析：
提供的`cve-2025-9074.sh`脚本是一个高度有效的概念验证（PoC），用于利用未授权暴露的Docker Daemon API实现远程代码执行。该脚本通过直接与Docker API交互，创建并启动一个具有高度特权配置的新容器，从而在目标主机上建立反向Shell。
核心利用机制在于以下容器配置：
1.  `Image: alpine:latest`：使用轻量级Alpine Linux镜像作为基础。
2.  `Cmd: ["/bin/sh", "-c", "..."]`：在容器启动时执行一个精心构造的netcat反向Shell命令，将Shell重定向到攻击者的监听端口。
3.  `HostConfig.Privileged: true`：赋予容器所有Linux内核能力，使其能够执行几乎所有系统调用，如同在主机上以root权限运行。
4.  `HostConfig.NetworkMode: host`：使容器共享主机的网络命名空间，这意味着容器可以直接访问主机的网络接口和端口，绕过常规容器网络隔离。
5.  `HostConfig.Binds: ["/:/hostfs:rw"]`：将主机的根文件系统以读写方式挂载到容器内部的`/hostfs`目录。结合`Privileged`模式，这允许攻击者从容器内部直接读写主机上的任何文件，包括敏感的系统配置或用户数据。

脚本首先通过向`${API}/version`发送请求来验证Docker API的可访问性。一旦确认API可达，它会构建一个JSON负载，其中包含上述恶意容器配置，并通过`POST`请求发送到`${API}/containers/create`来创建容器。成功创建后，脚本会通过`POST`请求到`${API}/containers/${CID}/start`启动该容器。容器启动后，其内置的反向Shell命令便会执行，连接回攻击者预设的监听器。这种结合特权模式、主机网络和主机文件系统挂载的利用方式，使得攻击者能够获得对目标系统的完整root级控制权。

利用步骤：
1.  **前提条件**：目标服务器的Docker Daemon API（通常监听在2375端口）在网络上对攻击者开放，并且未配置任何形式的认证或访问控制。
2.  **攻击者准备**：在攻击者机器上，使用`netcat`工具启动一个监听器，等待来自目标的反向Shell连接。例如：`nc -lvnp <listener_port>`。
3.  **执行PoC**：运行提供的PoC脚本`cve-2025-9074.sh`，并传入目标Docker API的IP地址、端口、攻击者本机的IP地址和监听端口。示例：`./cve-2025-9074.sh 192.168.65.7 2375 10.10.14.x 4444`。
4.  **获取控制权**：脚本成功执行后，攻击者机器上的`netcat`监听器将接收到来自目标服务器的反向Shell连接。通过此Shell，攻击者将获得目标Docker宿主机的root权限，可以执行任意命令，从而实现完全系统控制。

投毒风险分析：
对提供的PoC代码（`cve-2025-9074.sh`）进行全面分析后，评估其投毒风险为**0% (低风险)**。具体原因如下：
1.  **代码透明性与简洁性**：PoC代码是一个标准的bash脚本，结构简单、逻辑清晰，所有操作一目了然。代码中没有使用任何混淆技术，攻击者可以轻松地逐行审查脚本内容，理解其意图和执行流程。
2.  **目的明确**：脚本的核心和唯一目的是通过利用Docker Daemon的未授权访问漏洞来建立一个反向Shell，从而证明漏洞的存在和可利用性。此行为完全符合漏洞验证的目的，不包含任何与漏洞利用无关的、可疑的或恶意的功能。
3.  **无恶意副作用**：除了建立反向Shell以获得对目标系统的控制外，脚本本身不会执行任何额外的恶意操作，例如删除文件、修改系统配置（超出容器创建本身的需求）、安装后门程序、进行数据窃取或发起其他形式的攻击。它是一个纯粹的漏洞利用演示工具。
4.  **标准工具的使用**：脚本主要依赖于`curl`命令与HTTP API进行交互，以及`netcat`命令来建立反向Shell。这些都是Linux和网络安全领域广泛使用的标准工具。脚本内部用于创建反向Shell的命令是典型的shell管道操作，未发现任何尝试下载、执行不明二进制文件或利用系统特定漏洞的行为。
5.  **无外部依赖和供应链风险**：脚本是完全自包含的，除了依赖目标系统和攻击者系统上普遍存在的`bash`、`curl`和`netcat`等基本工具外，没有引入任何第三方库、远程资源或外部脚本。这排除了通过供应链攻击对PoC代码本身进行投毒的风险。
6.  **明确的法律免责声明**：PoC的`README.md`文件中明确包含了法律免责声明，指出其仅用于教育和授权的安全测试目的，并警告未经授权的利用是非法和不道德的。这进一步强化了其防御性安全研究工具的性质。
综上所述，该PoC代码是“干净”且无害的，专为防御性安全研究和漏洞复现而设计。用户可以安全地使用此PoC来验证和测试对Docker Daemon未授权访问漏洞的防御措施，无需担忧PoC代码本身带来的安全风险。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
