## CVE-2025-55184 - React Server Components 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 未明确指定，建议立即升级受影响版本。

**利用条件:** 无需认证，通过恶意构造的HTTP请求发送至React Server Function端点即可利用。

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55184 是一个影响 React Server Components (RSC) 的高危拒绝服务 (DoS) 漏洞，CVSS 评分为 7.5。该漏洞的根源在于服务器函数端点接收到的 HTTP 请求的有效负载在反序列化过程中存在不安全性，可能导致触发无限循环，从而消耗大量 CPU 资源，造成服务器进程挂起，并可能阻止后续 HTTP 请求的处理，最终导致服务不可用。攻击者无需进行身份验证即可利用此漏洞，只需发送特制的 HTTP 请求即可。此漏洞与 CVE-2025-67779 密切相关，后者被认为是 CVE-2025-55184 的不完整修复，影响相同。此外，同一时间段内还披露了 CVE-2025-55183 (CVSS 评分 5.3)，该漏洞涉及源代码暴露。

**POC有效性分析：**
所提供的 JavaScript POC 代码（文件名为 `action-trigger-waf-bypass.cjs`）旨在测试 React Server Components (RSC) 的服务器行动端点是否可达和功能正常，并通过发送一个“大尺寸填充负载”来验证其可访问性、RSC 协议工作情况以及是否存在 WAF/速率限制的阻碍。虽然此 POC 代码并未直接构造导致“反序列化无限循环”的特定恶意负载，但它提供了一个功能完整的框架，用于与 RSC 服务器行动端点进行 HTTP POST 请求交互，并能够发送自定义的、带有特定头部（如 `Next-Action`）和表单编码内容（包括可变大小的填充数据）的负载。这使得它成为一个有效的概念验证工具，因为它展示了攻击者如何识别目标 `actionId`（甚至支持从页面抓取）并构造对易受攻击端点的请求。攻击者可以基于此 POC，修改其负载生成逻辑，以包含触发 CVE-2025-55184 中描述的无限循环反序列化漏洞所需的精确恶意数据。例如，他们可以通过改变 `params.append('0', '["test"]')` 和 `params.append('1', JSON.stringify({ id: targetActionId, bound: null }))` 中的内容来引入恶意序列化对象。因此，该 POC 代码虽然并非直接的完全利用代码，但为开发完整的拒绝服务攻击提供了坚实的基础和必要的交互机制，在有效性上属于高度相关和可用的概念验证。

**利用步骤：**
1.  **目标识别：** 攻击者首先需要识别使用 React Server Components 的目标应用程序，并确定其公开可访问的服务器函数端点。
2.  **发现Action ID（可选）：** 利用 POC 代码中的 `getActionId` 函数（或类似方法），从目标应用程序的 HTML 页面中自动发现有效的 `actionId`。这些 ID 是进行服务器行动调用的必要参数。
3.  **构造恶意HTTP请求：** 准备一个 HTTP POST 请求。请求的 `Content-Type` 必须设置为 `application/x-www-form-urlencoded`，这与 POC 中的设置一致。
4.  **制作恶意负载：** 请求的主体（payload）必须包含经过精心构造的数据，当 React Server Function 端点尝试对其进行反序列化时，会触发无限循环或导致极度资源消耗。虽然提供的 POC 使用了通用的 `["test"]` 和 `{ id: targetActionId, bound: null }` 并附加了填充数据，但实际的漏洞利用会用针对特定反序列化缺陷的恶意格式化数据替换这些内容。
5.  **设置请求头部：** 在 HTTP 请求中设置必要的头部，包括 `Next-Action`（值为目标 `actionId`）和 `Accept: text/x-component`，这些都可以在 POC 代码中找到示例。
6.  **发送请求：** 将构造好的恶意 POST 请求发送到目标服务器函数端点。
7.  **触发DoS：** 易受攻击的服务器在接收到并尝试反序列化恶意负载时，会触发一个无限循环，从而耗尽大量的 CPU 资源，导致服务器进程挂起，无法处理新的请求，最终造成拒绝服务。
8.  **维持攻击（可选）：** 攻击者可以重复发送此类恶意请求以维持拒绝服务状态。

**投毒风险分析：**
所提供的 POC 代码（`action-trigger-waf-bypass.cjs`）的投毒风险极低，估计为 5%。该代码使用标准 JavaScript/Node.js 编写，依赖于 `http`、`https`、`URL` 和 `Buffer` 等核心内置模块，无需额外的第三方依赖。代码结构清晰，逻辑透明，没有任何混淆、加密或使用 `eval()` 等动态代码执行的机制。它明确定义了如何解析命令行参数、如何发起 HTTP/HTTPS 请求、如何构造请求体和头部。所有的网络通信都指向用户指定的 `target` URL，且请求内容是根据提供的参数和硬编码的模板（如 `["test"]`）生成的。代码的注释清晰地说明了其目的是测试服务器行动端点的可达性和功能性，以及 WAF/速率限制的绕过。它不包含任何尝试下载或执行外部脚本、修改系统文件、收集敏感信息或进行其他未经授权行为的迹象。因此，对于进行合法防御性安全研究和漏洞验证的团队而言，这份 POC 代码是安全可靠的，可以在受控环境中进行分析和执行，而无需担忧隐藏的恶意功能或“投毒”行为。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
