## CVE-2025-55184 - React Server Components (RSC) 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components (RSC)

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** React Server Components受影响版本 (具体版本号未披露，需在官方补丁发布前升级)

**利用条件:** 无需认证，需要网络访问，通过恶意构造的HTTP请求

**POC 可用性:** 5

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55184是一个高危拒绝服务（DoS）漏洞，影响使用React Server Components（RSC）的应用程序。此漏洞的CVSS评分为7.5。攻击者无需进行身份验证，即可通过向服务器函数端点发送恶意构造的HTTP请求来利用此漏洞。该漏洞的核心机制在于对HTTP请求负载进行反序列化时的不安全性，特别是当有效负载包含“循环Promise引用（Cyclical Promise References）”时。这种恶意构造会导致反序列化过程进入无限循环，从而使服务器进程挂起，CPU利用率飙升至100%，并可能阻止后续HTTP请求的响应，最终导致服务完全瘫痪。

此漏洞的修复被认为是不完整的，因此后续又披露了CVE-2025-67779，该漏洞是对CVE-2025-55184的不完整修复，影响相同。同时，还存在一个相关的源代码暴露漏洞CVE-2025-55183（CVSS 5.3），攻击者可以通过该漏洞获取标记为`use server`的函数源代码，其中可能包含API密钥或数据库连接字符串等敏感信息。本分析主要聚焦于CVE-2025-55184的拒绝服务风险。

**POC有效性分析**
提供的POC代码`action-trigger-waf-bypass.cjs`是一个Node.js脚本，旨在使用标准`http`和`https`模块与React Server Components（RSC）端点进行交互。根据其注释，它的主要目的是测试服务器操作端点是否可达且功能正常，并通过发送一个大型填充负载来验证：操作可访问性、RSC协议工作以及是否存在WAF/速率限制。该脚本具有以下功能：解析命令行参数以指定目标URL、动作ID和填充大小；如果未提供动作ID，它可以自动从目标页面获取一个动作ID（通过正则表达式匹配`[a-f0-9]{40,42}`）；然后，它会构造一个`POST`请求，设置`Content-Type: application/x-www-form-urlencoded`、`Accept: text/x-component`和`Next-Action`头，并在请求体中包含一个通过`paddingSize`参数控制的大量字符（例如'A'）填充的负载。虽然这个POC能够有效地与RSC端点进行通信并发送任意大小的负载，从而可能导致服务器资源（如网络带宽或内存）的初步耗尽，但它**并未直接实现导致CVE-2025-55184所述“无限循环反序列化”的“循环Promise引用”核心机制**。因此，作为直接触发该特定无限循环DoS的完整利用代码，它是不完善的。然而，该脚本作为验证RSC端点存在性、功能性和测试服务器处理大负载能力的工具，以及作为构建更复杂DoS利用的基础，具有很高的概念验证价值。它展示了与RSC交互的基本方式，可以作为开发针对CVE-2025-55184的完整DoS利用的基础，需要修改其payload以包含导致无限循环的具体构造。

**利用步骤**
1.  **识别目标**: 确定一个使用了React Server Components的Web应用程序作为攻击目标。该POC脚本可以通过其自动获取`actionId`的功能来辅助识别活跃的RSC端点。
2.  **构造恶意Payload**: 攻击者需要精心构造一个HTTP POST请求的负载。根据研究披露，这个恶意负载的关键在于包含“循环Promise引用”结构，使其在服务器尝试反序列化时触发无限循环。原始POC代码当前发送的是一个参数化的表单数据，需要对其进行修改，使其能够生成符合RSC协议规范的、包含循环引用的特定结构化数据。
3.  **发送攻击请求**: 使用修改后的POC或其他HTTP客户端，将构造好的恶意POST请求发送到目标RSC服务器函数端点。由于该漏洞是认证前的，因此无需任何凭证。
4.  **触发DoS**: 服务器收到恶意请求后，在尝试反序列化其负载的过程中，会因为“循环Promise引用”而陷入无限循环。这将迅速消耗服务器的所有可用CPU资源，导致进程挂起，服务无法响应新的请求，从而实现拒绝服务攻击。
5.  **验证攻击效果**: 观察目标应用的响应时间、服务器资源使用情况，确认服务是否已停止响应或运行异常。

**投毒风险分析**
提供的POC代码`action-trigger-waf-bypass.cjs`的投毒风险评估为**0% (低风险)**。该脚本是一个明确且功能透明的Node.js程序，旨在进行合法的安全测试和研究。其风险分析如下：
*   **代码清晰度与可读性**: 脚本代码结构清晰，逻辑简单，使用了标准的JavaScript语法和Node.js内置模块，没有发现任何混淆、加密或难以理解的代码段。任何人都可以轻松阅读并理解其功能。
*   **依赖性**: 该脚本仅依赖Node.js的内置模块（`http`, `https`, `url`, `process`）。它不引入任何第三方NPM包或外部库，从而消除了通过供应链引入恶意代码的风险。
*   **行为透明性**: 脚本执行的行为完全符合其注释中描述的功能：获取动作ID，然后向指定目标发送一个HTTP请求，其中包含一个可配置大小的填充负载。它不执行任何超出此范围的额外操作。
*   **无恶意功能**: 未发现任何试图执行恶意操作的代码，例如：下载和执行外部可执行文件、修改系统配置、植入后门、窃取敏感数据、连接非预期外部C2服务器、扫描本地网络或进行勒索行为等。它只是向用户指定的URL发送HTTP请求。
*   **资源滥用**: 脚本通过`paddingSize`参数可以控制发送负载的大小，这可能被滥用以进行某种程度的带宽消耗，但这属于其预期测试功能的一部分，并非隐蔽的恶意行为。
**结论**: 该POC代码是安全研究的合法工具，其编写方式、依赖和执行行为均无恶意迹象。用户可以放心审查和使用此代码，无需担心其会引入后门或执行任何未经授权的恶意操作。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
