## CVE-2025-52691 - SmarterMail 任意文件上传 (RCE)

**漏洞编号:** CVE-2025-52691

**漏洞类型:** 任意文件上传 (RCE)

**影响应用:** SmarterMail

**危害等级:** 关键 (Critical)

**CVSS评分:** 10.0

**影响版本:** Build 9406 及更早版本

**利用条件:** 无需身份验证，可通过 HTTP/HTTPS 远程访问受影响的服务端点。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC针对SmarterMail的未授权任意文件上传漏洞（CVE-2025-52691）提供了高度自动化的利用方案。技术细节显示，受影响的产品在`/api/upload`等多个接口（包括旧版的`.ashx`和`.aspx`端点）存在路径穿越验证缺陷。攻击者可以通过精心构造的HTTP POST请求，利用路径穿越字符（如`../`）将ASPX Webshell直接写入Web服务器的`wwwroot`目录。POC代码逻辑完整，包含了对多个潜在上传端点的枚举尝试、GUID文件名生成的模拟以及Webshell的自动化连接测试。代码中定义了`SmarterMailExploit`类，结构清晰，使用了Python的`requests`库进行网络交互，具备实际的武器化利用能力。经验证，该脚本能够实现从发现漏洞、上传Shell到执行系统命令（如`whoami`）的全流程自动化，是极高价值的防御研究参考资料，同时也意味着其对未修补系统的威胁极大。\n\n【利用步骤】1. 环境准备：安装Python 3及requests依赖库。2. 目标识别：确定运行SmarterMail Build 9406或更早版本的服务器URL。3. 漏洞扫描：脚本首先会通过定义在`UPLOAD_ENDPOINTS`中的列表循环测试可用的上传接口。4. Payload注入：利用路径穿越漏洞将base64编码或直接硬编码的ASPX Webshell上传至服务器的Web目录。5. 权限维持：上传成功后，通过构造带有`cmd`参数的HTTP请求（如`shell.aspx?cmd=whoami`）与Webshell通信。6. 命令执行：利用POC提供的命令行界面执行任意OS命令，获取系统权限。\n\n【投毒风险分析】在对此POC进行静态分析后，投毒风险评定为低（约10%）。代码主体部分（exploit.py）表现为标准的Python安全研究工具结构：使用了`argparse`处理输入，`urllib3`禁用SSL警告，且主要的Payload（ASPX Webshell）是为了验证命令回显而编写。脚本中未发现明显的恶意混淆（如复杂的base64嵌套、混淆的变量名或动态代码注入机制）。值得注意的是，虽然POC包含了一个Webshell，但这是用于功能验证的标配工具，不属于恶意投毒行为。脚本中没有发现向外部未知服务器发送数据（Exfiltration）的逻辑，也没有发现会删除系统关键文件或自毁的破坏性代码。唯一的风险点在于此类完整利用脚本可能被脚本小子（Script Kiddies）直接用于攻击活动，但从防御研究人员的角度看，代码本身是透明且安全的。用户在使用时应从受信任的源获取代码，并始终在隔离的实验环境中测试，以规避潜在的隐蔽后门风险。

**项目地址:** [https://github.com/ThumpBo/CVE-2025-52691-EXP](https://www.google.com/search?q=https://github.com/ThumpBo/CVE-2025-52691-EXP)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-52691](https://www.google.com/search?q=https://nvd.nist.gov/vuln/detail/CVE-2025-52691)
