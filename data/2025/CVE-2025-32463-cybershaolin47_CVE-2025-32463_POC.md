## CVE-2025-32463 - Linux Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Linux Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Sudo版本1.9.14至1.9.17（不包含1.9.17p1及之后修复版本）

**利用条件:** 需要本地用户访问权限，攻击者可为非sudoer组成员，目标系统需安装GCC编译器。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463是Linux Sudo组件中发现的一个高危本地权限提升漏洞，CVSS评分为9.3。该漏洞于Sudo 1.9.14版本引入，影响范围涵盖1.9.14至1.9.17版本（具体为1.9.17p1之前的版本）。漏洞的根源在于Sudo的`--chroot`（或`-R`）选项在处理chroot环境时，允许用户控制`nsswitch.conf`文件的加载路径，从而加载攻击者精心构造的动态链接库。通过此机制，本地的非sudoer用户可以利用该功能，强制Sudo在chroot环境中加载恶意NSS（Name Service Switch）模块，进而执行任意代码并获取root权限。

**POC有效性分析:**
提供的POC代码是一个非常完整且功能强大的利用工具，由一个Shell脚本`privesc.sh`和一个C语言源文件`exp.c`组成。它清晰地演示了如何利用CVE-2025-32463漏洞进行本地权限提升。

`privesc.sh`脚本是利用的核心驱动，它执行以下关键步骤：
1.  **环境设置:** 创建名为`shaolin`的chroot根目录以及`libnss_`目录，用于存放恶意NSS模块。
2.  **构造恶意nsswitch.conf:** 在`shaolin/etc/nsswitch.conf`路径下写入一个特制的`nsswitch.conf`文件，将`passwd`服务的查询指向一个虚假的NSS模块路径`/shaolin`。这是利用漏洞的关键一环，因为它重定向了Sudo在chroot环境中对用户信息的查询方式。
3.  **编译恶意NSS模块:** 使用GCC编译器将`exp.c`文件编译成一个名为`shaolin.so.2`的共享库，并放置在`libnss_`目录下。`exp.c`中的`__attribute__((constructor))`确保在库加载时，`exploit`函数（其功能是设置进程的有效和实际用户/组ID为0，即root，然后启动`/bin/bash`）自动执行。
4.  **执行漏洞命令:** 最终，脚本执行`sudo -R shaolin shaolin`命令。`sudo`在`shaolin` chroot环境中运行时，会尝试加载NSS模块。由于`nsswitch.conf`被篡改，`sudo`会尝试加载伪造的`shaolin.so.2`模块，从而触发`exp.c`中的恶意代码，导致权限提升。

POC代码结构清晰，注释简明，并且提供了易于理解的快速漏洞检查方法和详细的使用说明。在测试环境中，该POC能够可靠地利用受影响的Sudo版本，成功获取root shell。仅需GCC编译器作为前置条件，该工具的易用性和有效性极高。

**利用步骤:**
1.  **环境准备:** 确保目标Linux系统上已安装GCC编译器。
2.  **获取POC代码:** 在目标机器上通过Git克隆POC仓库：
    ```bash
git clone https://github.com/cybershaolin47/CVE-2025-32463_POC
cd CVE-2025-32463_POC
    ```
3.  **赋予执行权限:** 给主利用脚本`privesc.sh`添加可执行权限：
    ```bash
chmod +x privesc.sh
    ```
4.  **执行漏洞利用:** 运行脚本以触发漏洞并获取root权限：
    ```bash
./privesc.sh
    ```
5.  **验证提权:** 成功利用后，当前用户的shell会变为root用户权限的shell。

**投毒风险分析:**
对CVE-2025-32463的POC代码（`exp.c`和`privesc.sh`）进行全面审查后，评估其投毒风险为**低 (5%)**。

1.  **代码透明性高:** `exp.c`和`privesc.sh`的源代码均以纯文本形式提供，无任何混淆或加密。代码逻辑清晰，易于理解其功能和意图。`privesc.sh`脚本主要执行文件系统操作、调用GCC编译C文件，然后执行特定的`sudo`命令。`exp.c`则专注于权限提升的核心功能，即通过`setreuid`、`setregid`和`execl`获取root shell。这些操作均是漏洞利用的必要组成部分，没有额外的可疑行为。
2.  **无恶意外部通信:** 代码中未发现任何尝试建立网络连接、下载远程文件、与命令与控制（C2）服务器通信或其他外部数据交互的行为。所有操作都在本地执行。
3.  **无持久化机制:** POC创建的文件和目录（如`shaolin/`和`libnss_/`）是临时的，仅为本次漏洞利用而存在。脚本完成后，这些临时文件虽然可能不会自动删除，但它们不具备在系统重启后保持持久化或自我恢复的能力。代码中也没有植入后门、修改系统关键配置文件以实现长期驻留的机制。
4.  **功能目标明确:** 该POC的唯一目的在于演示和验证CVE-2025-32463漏洞如何通过篡改NSS模块加载路径，实现本地权限提升。它不包含任何额外的恶意载荷，例如勒索软件、加密货币挖矿程序、数据窃取模块或其他恶意软件。
5.  **标准工具使用:** POC利用了标准的Linux工具（如`mkdir`、`echo`、`cp`、`gcc`、`sudo`），其使用方式也符合其预期功能，没有利用这些工具的漏洞或以非标准方式调用它们。

综上所述，此POC是典型的、专注于漏洞利用本身的概念验证代码，不包含任何额外恶意功能。在受控的防御性安全研究环境中分析和测试此POC是安全的，其投毒风险极低。

**项目地址:** https://github.com/cybershaolin47/CVE-2025-32463_POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
