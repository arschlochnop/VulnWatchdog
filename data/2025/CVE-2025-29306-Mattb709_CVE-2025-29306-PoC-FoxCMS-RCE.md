## CVE-2025-29306 - FoxCMS 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-29306

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** FoxCMS

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** v1.2.5

**利用条件:** 远程访问权限，无需身份认证

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-29306是一个影响FoxCMS v1.2.5版本的严重远程代码执行漏洞。该漏洞的根源在于index.html组件中的案例展示页面对'id'参数的处理存在缺陷。具体而言，程序将用户输入的'id'参数未经任何过滤或验证直接传递给了PHP的unserialize()函数。由于PHP反序列化过程中可能触发魔术方法，攻击者可以构造恶意的序列化Payload，实现任意PHP代码执行。POC有效性分析：提供的Python脚本展示了针对该漏洞的自动化攻击流程。脚本通过构造包含PHP system()函数的恶意字符串，利用urllib将其进行URL编码，并作为'id'参数附加在请求URL中。POC使用了requests库发送HTTP GET请求，并配合BeautifulSoup解析响应内容以确认命令执行结果。从代码结构看，该POC具备单个目标验证和批量扫描功能，逻辑严密，具有极高的实战参考价值。利用步骤：1. 识别运行FoxCMS v1.2.5的目标服务器；2. 构造Payload，如将要执行的系统命令嵌入到PHP代码块中（如${@print_r(@system("id"))}）；3. 确定目标路径/images/index.html；4. 将Payload作为URL参数'id'的值发送GET请求；5. 服务器解析参数并触发unserialize()，导致命令执行，返回结果通常显示在页面的特定HTML元素中。投毒风险分析：经过对提供的POC代码进行静态审计，未发现明显的恶意行为或投毒迹象。代码使用了标准的Python库如requests、BeautifulSoup和concurrent.futures，逻辑透明，主要功能集中在目标探测和命令回显确认。虽然脚本包含了一个banner打印和批量处理逻辑，但这符合常规安全工具的设计模式。唯一潜在的风险点在于用户如果从非官方渠道下载此类脚本，攻击者可能会在代码中植入后门（如在发送请求时同时将目标IP泄露给第三方，或在执行命令时附加恶意指令）。但就当前代码片段而言，其行为是干净且可控的。脚本中的SSL验证关闭（verify=False）是针对内网测试的常见配置，不属于投毒范畴。建议在使用时始终在隔离的沙箱环境中运行，并对所有外部传入的Command参数进行二次确认，以防止误操作导致生产环境受损。

**项目地址:** 本地文件: /tmp/vulnwatchdog_d683722f5bac8123295e4208d202bdfd/CVE-2025-29306-PoC.py

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-29306](https://nvd.nist.gov/vuln/detail/CVE-2025-29306)
