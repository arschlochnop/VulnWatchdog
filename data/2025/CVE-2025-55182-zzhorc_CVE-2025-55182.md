## CVE-2025-55182 - React Server Components (React, Next.js) RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components (React, Next.js)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** React Core: 19.0.0 to 19.2.0; Next.js: 15.x, 16.x (App Router); RSC Bundler: react-server-dom-webpack 19.0.0 to 19.2.0; Node.js >= 20.9.0

**利用条件:** Unauthenticated network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182 是 React Server Components (RSC) 中的一个严重远程代码执行 (RCE) 漏洞。该漏洞存在于 React Server Functions 的设计中，允许客户端发起请求调用服务器端函数。React 将客户端的请求转换为 HTTP 请求，如果未正确处理，攻击者可以利用此漏洞在服务器上执行任意代码。

POC 有效性分析：

该 POC 包含完整的利用代码（scanner_with_rce.py），可以验证漏洞的存在并执行任意命令。POC 的 README 文件提供了详细的构建和启动步骤，以及示例用法。它还包括一个检测工具（scanner.py），可用于扫描目标主机是否存在漏洞。该 POC 基于对漏洞原理的深刻理解，能够可靠地触发漏洞，并且提供了 WAF 绕过选项，增加了漏洞利用的成功率。该 POC 包含明确的验证步骤，通过执行 `ls /` 命令验证 RCE 是否成功。漏洞利用方法是构造特制的 multipart POST 请求，其中包含执行恶意代码的 payload。服务器端接收到该请求后，会执行 payload 中的代码，从而实现 RCE。

利用步骤：

1.  搭建易受攻击的环境：根据 README 文件中的说明，安装指定版本的 Node.js、Next.js 和 React。使用 `npm install --force` 强制安装低版本依赖，并验证依赖版本是否正确。
2.  构建项目：运行 `npm run build` 构建项目。
3.  启动服务器：运行 `npm start` 启动服务器，服务器将在 http://localhost:3000 监听。
4.  漏洞检测/扫描：使用 scanner.py 脚本扫描目标主机，例如：`python3.11 scanner.py -u http://127.0.0.1:3000/`。
5.  RCE：使用 scanner_with_rce.py 脚本执行任意命令，例如：`python3.11 scanner_with_rce.py -u http://127.0.0.1:3000/ -c "ls /"`。
6.  验证 RCE 是否成功：查看服务器的响应，确认命令已成功执行。

投毒风险分析：

该 POC 的投毒风险较低，主要基于以下几点：

1.  代码清晰：POC 代码结构清晰，易于理解，没有明显的恶意代码或混淆。
2.  标准库：POC 主要使用 Python 的标准库（如 requests），没有引入不常见的第三方库。
3.  无可疑行为：POC 的主要功能是发送 HTTP 请求并解析响应，没有执行任何可疑的操作，例如访问本地文件、修改系统配置等。
4.  依赖可信：POC 依赖的第三方库（如 requests）是常用的、经过广泛测试的库，不太可能包含恶意代码。
5.  但需要注意的是，RCE 本身就存在一定的风险。攻击者可能会修改 POC 代码，添加恶意代码，然后传播修改后的 POC。因此，在使用 POC 时，务必仔细检查代码，确保其安全性。

尽管总体风险较低，仍需注意以下潜在风险点：

*   Payload 中的命令：虽然示例中使用的是 `ls /` 命令，但攻击者可以替换为任意命令，包括下载恶意软件、修改系统文件等。因此，在测试 RCE 时，务必使用安全的命令，避免对系统造成损害。
*   WAF 绕过：POC 提供了 WAF 绕过选项，这可能会被攻击者利用，绕过安全防护措施，从而成功利用漏洞。

总结：此漏洞的 POC 质量高，利用复杂度低，但是由于RCE自身存在的风险，以及可能被利用进行WAF绕过，仍然存在一定的投毒风险，但代码本身较为清晰，依赖可信，综合评估投毒风险为10%。

**项目地址:** https://github.com/assetnote/react2shell-scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
