## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 未知

**利用条件:** 克隆包含恶意.gitmodules的仓库

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-48384是一个存在于Git中的任意文件写入漏洞。该漏洞允许攻击者通过创建恶意的Git仓库，并在用户克隆该仓库时，在用户系统上写入任意文件，从而可能导致远程代码执行。该漏洞的根源在于Git处理submodule的方式存在缺陷，当.gitmodules文件包含恶意配置时，Git可能会在不进行充分验证的情况下写入文件。 

POC有效性分析：

根据搜索结果和提供的POC代码，该漏洞的POC已经存在，并且在GitHub上可以找到相应的代码。通过分析POC代码，可以确认该漏洞是可利用的。POC代码展示了一个简单的bash脚本，该脚本在受害者机器上建立反向shell连接到攻击者的IP地址。要验证该POC的有效性，需要搭建一个Git服务器，创建一个包含恶意.gitmodules文件的仓库，然后尝试在受害者机器上克隆该仓库。如果成功建立了反向shell连接，则说明该漏洞是可利用的。

利用步骤：
1. 攻击者创建一个包含恶意.gitmodules文件的Git仓库。
2. 攻击者诱骗受害者克隆该仓库。
3. 受害者克隆仓库时，Git会解析.gitmodules文件。
4. 由于.gitmodules文件包含恶意配置，Git会在受害者系统上写入任意文件，从而导致代码执行。
5. 在给定的POC中，恶意.gitmodules配置会导致执行`post-checkout`脚本，此脚本会创建一个反向shell连接到攻击者的机器。

投毒风险分析：
该POC的投毒风险属于中等水平。尽管提供的POC代码本身看起来比较简单，只是建立了一个反向shell连接，但是攻击者可以很容易地修改POC代码，使其执行更具破坏性的操作，例如删除文件、安装恶意软件或窃取敏感数据。此外，攻击者还可以通过代码混淆等技术来隐藏恶意代码，从而增加检测的难度。由于该漏洞涉及到Git仓库的克隆操作，攻击者可以通过社会工程学等手段来诱骗用户克隆恶意仓库，从而扩大攻击范围。例如，攻击者可以在GitHub等代码托管平台上发布包含恶意.gitmodules文件的项目，并诱导其他用户克隆这些项目。此外，如果攻击者能够控制目标组织的内部Git服务器，那么他们就可以更加容易地发起攻击。因此，需要对该漏洞保持警惕，并采取相应的安全措施来防范潜在的攻击。

由于POC本身包含网络连接行为，有一定的投毒风险。攻击者可能通过替换反向shell的IP地址，将受害者连接到恶意服务器，或者在反向shell中执行恶意指令。 混淆代码或添加额外的恶意功能也可能增加投毒风险。该POC的投毒风险评估为30%。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-48384
