# CVE-2025-24104

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24104-ifpdz_CVE-2025-24104.md](../2025/CVE-2025-24104-ifpdz_CVE-2025-24104.md)

# CVE-2025-24104

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24104-ifpdz_CVE-2025-24104.md](../2025/CVE-2025-24104-ifpdz_CVE-2025-24104.md)

# CVE-2025-24104

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24104-ifpdz_CVE-2025-24104.md](../2025/CVE-2025-24104-ifpdz_CVE-2025-24104.md)

# CVE-2025-24104

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24104-ifpdz_CVE-2025-24104.md](../2025/CVE-2025-24104-ifpdz_CVE-2025-24104.md)

## CVE-2025-24104-iOS/iPadOS备份文件符号链接读取漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接

**影响应用:** iOS/iPadOS

**危害等级:** 中危，可能导致敏感数据泄露

**影响版本:** iOS and iPadOS < 18.3, iPadOS < 17.7.4

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 漏洞是由于在恢复备份文件时，对符号链接处理不当造成的。恶意攻击者可以构造包含指向系统敏感文件的符号链接的备份文件，当用户恢复这个恶意备份后，系统会读取符号链接指向的文件内容，从而导致敏感信息泄露。根据提供的漏洞利用代码，漏洞作者描述了利用此漏洞读取沙盒之外任意文件的方法，而苹果的修复并不彻底，作者声称存在绕过方法，但未公开。

**有效性评估：**

根据漏洞描述和PoC代码，该漏洞是有效的。PoC 展示了如何创建一个包含指向敏感文件的符号链接的恶意备份，并在恢复后读取这些文件。漏洞已在 iOS 18.3 和 iPadOS 18.3 中修复，但修复可能不完整。

**投毒风险评估：**

投毒风险较低，约为 10%。 代码仓库主要包含漏洞的描述、时间线、利用方法和修复方案。虽然作者声称存在绕过补丁的方法但并没有公布，这暗示着可能存在未公开的利用方式。license文件和readme文件均属于常规的开源代码仓库内容，未发现明显的恶意代码或后门。风险主要来自作者未公开的绕过方法。

**利用方式：**

1.  **创建恶意备份：** 攻击者创建一个备份文件，其中`/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles/Library/ConfigurationProfiles/CloudConfigurationDetails.plist` 文件被替换为指向目标文件的符号链接。
2.  **恢复备份：** 诱使用户在受影响的 iOS/iPadOS 设备上恢复该恶意备份。
3.  **触发漏洞：** 通过lockdown连接向 `com.apple.mobile.MCInstall` 服务发送 `GetCloudConfiguration` 命令。由于符号链接未被正确处理，服务会返回符号链接指向的文件内容，而不是预期的 `CloudConfigurationDetails.plist` 内容。
4.  **读取敏感信息：** 攻击者可以利用此漏洞读取沙盒之外的敏感文件，例如系统配置文件等。

**项目地址:** [ifpdz/CVE-2025-24104](https://github.com/ifpdz/CVE-2025-24104)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)

---

## POC #2

**来源**: [CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md](../2025/CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md)

## CVE-2025-24104 - iOS/iPadOS 本地文件修改漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接处理不当导致的文件修改

**影响应用:** iOS/iPadOS

**危害等级:** 中危，需要用户交互，可能导致受保护的系统文件被修改

**影响版本:** iPadOS < 17.7.4, iOS and iPadOS < 18.3

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 是一个由于符号链接处理不当导致的文件修改漏洞，存在于 iPadOS 和 iOS 中。攻击者可以制作一个恶意的备份文件，诱导用户恢复该备份。由于系统在恢复备份时对符号链接处理不当，攻击者可以利用该漏洞修改受保护的系统文件，如 `/private/etc/passwd`。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意符号链接的备份文件。
2.  攻击者诱骗用户恢复该备份文件。
3.  在备份恢复过程中，恶意符号链接会将目标文件（如 `/private/etc/passwd`）链接到备份文件中的某个攻击者可控的文件。
4.  备份恢复过程会将攻击者可控的文件内容覆盖到目标文件，从而修改了受保护的系统文件。

**POC有效性评估：**

根据漏洞描述和POC代码，该POC利用了 `idevicebackup2` 工具来备份和恢复设备。POC代码通过创建包含恶意符号链接的备份，并尝试将其恢复到目标设备上，验证了该漏洞的存在。如果目标设备的iOS版本低于18.3 (或 iPadOS 17.7.4)，且用户执行了恢复操作，则POC可以成功修改目标文件，证明漏洞利用的有效性。值得注意的是，POC中强调了需要用户交互，即需要用户主动恢复恶意备份。

**投毒风险评估：**

虽然提供的POC代码主要目的是验证漏洞的存在，但仍需评估是否存在隐藏的投毒代码。代码中涉及创建临时目录、执行外部命令(`idevicebackup2`)、读取和写入 plist 文件等操作，这些操作都可能被利用来执行恶意代码。例如，攻击者可能通过修改 plist 文件或在临时目录中放置恶意文件，在用户不知情的情况下执行恶意操作。但是，从代码整体结构来看，其主要功能是围绕漏洞验证展开，恶意代码的隐藏空间相对有限。因此，初步估计投毒风险约为 10%。这个百分比是主观评估，基于对代码的快速审查。更深入的审计可能发现更高或更低的风险。

**缓解措施：**

*   及时更新 iOS/iPadOS 到最新版本。
*   避免恢复来自不可信来源的备份文件。
*   增强对备份文件的安全性检查。

**项目地址:** [missaels235/POC-CVE-2025-24104-Py](https://github.com/missaels235/POC-CVE-2025-24104-Py)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)

---



---

## POC #2

**来源**: [CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md](../2025/CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md)

## CVE-2025-24104 - iOS/iPadOS 本地文件修改漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接处理不当导致的文件修改

**影响应用:** iOS/iPadOS

**危害等级:** 中危，需要用户交互，可能导致受保护的系统文件被修改

**影响版本:** iPadOS < 17.7.4, iOS and iPadOS < 18.3

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 是一个由于符号链接处理不当导致的文件修改漏洞，存在于 iPadOS 和 iOS 中。攻击者可以制作一个恶意的备份文件，诱导用户恢复该备份。由于系统在恢复备份时对符号链接处理不当，攻击者可以利用该漏洞修改受保护的系统文件，如 `/private/etc/passwd`。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意符号链接的备份文件。
2.  攻击者诱骗用户恢复该备份文件。
3.  在备份恢复过程中，恶意符号链接会将目标文件（如 `/private/etc/passwd`）链接到备份文件中的某个攻击者可控的文件。
4.  备份恢复过程会将攻击者可控的文件内容覆盖到目标文件，从而修改了受保护的系统文件。

**POC有效性评估：**

根据漏洞描述和POC代码，该POC利用了 `idevicebackup2` 工具来备份和恢复设备。POC代码通过创建包含恶意符号链接的备份，并尝试将其恢复到目标设备上，验证了该漏洞的存在。如果目标设备的iOS版本低于18.3 (或 iPadOS 17.7.4)，且用户执行了恢复操作，则POC可以成功修改目标文件，证明漏洞利用的有效性。值得注意的是，POC中强调了需要用户交互，即需要用户主动恢复恶意备份。

**投毒风险评估：**

虽然提供的POC代码主要目的是验证漏洞的存在，但仍需评估是否存在隐藏的投毒代码。代码中涉及创建临时目录、执行外部命令(`idevicebackup2`)、读取和写入 plist 文件等操作，这些操作都可能被利用来执行恶意代码。例如，攻击者可能通过修改 plist 文件或在临时目录中放置恶意文件，在用户不知情的情况下执行恶意操作。但是，从代码整体结构来看，其主要功能是围绕漏洞验证展开，恶意代码的隐藏空间相对有限。因此，初步估计投毒风险约为 10%。这个百分比是主观评估，基于对代码的快速审查。更深入的审计可能发现更高或更低的风险。

**缓解措施：**

*   及时更新 iOS/iPadOS 到最新版本。
*   避免恢复来自不可信来源的备份文件。
*   增强对备份文件的安全性检查。

**项目地址:** [missaels235/POC-CVE-2025-24104-Py](https://github.com/missaels235/POC-CVE-2025-24104-Py)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)

---



---

## POC #2

**来源**: [CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md](../2025/CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md)

## CVE-2025-24104 - iOS/iPadOS 本地文件修改漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接处理不当导致的文件修改

**影响应用:** iOS/iPadOS

**危害等级:** 中危，需要用户交互，可能导致受保护的系统文件被修改

**影响版本:** iPadOS < 17.7.4, iOS and iPadOS < 18.3

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 是一个由于符号链接处理不当导致的文件修改漏洞，存在于 iPadOS 和 iOS 中。攻击者可以制作一个恶意的备份文件，诱导用户恢复该备份。由于系统在恢复备份时对符号链接处理不当，攻击者可以利用该漏洞修改受保护的系统文件，如 `/private/etc/passwd`。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意符号链接的备份文件。
2.  攻击者诱骗用户恢复该备份文件。
3.  在备份恢复过程中，恶意符号链接会将目标文件（如 `/private/etc/passwd`）链接到备份文件中的某个攻击者可控的文件。
4.  备份恢复过程会将攻击者可控的文件内容覆盖到目标文件，从而修改了受保护的系统文件。

**POC有效性评估：**

根据漏洞描述和POC代码，该POC利用了 `idevicebackup2` 工具来备份和恢复设备。POC代码通过创建包含恶意符号链接的备份，并尝试将其恢复到目标设备上，验证了该漏洞的存在。如果目标设备的iOS版本低于18.3 (或 iPadOS 17.7.4)，且用户执行了恢复操作，则POC可以成功修改目标文件，证明漏洞利用的有效性。值得注意的是，POC中强调了需要用户交互，即需要用户主动恢复恶意备份。

**投毒风险评估：**

虽然提供的POC代码主要目的是验证漏洞的存在，但仍需评估是否存在隐藏的投毒代码。代码中涉及创建临时目录、执行外部命令(`idevicebackup2`)、读取和写入 plist 文件等操作，这些操作都可能被利用来执行恶意代码。例如，攻击者可能通过修改 plist 文件或在临时目录中放置恶意文件，在用户不知情的情况下执行恶意操作。但是，从代码整体结构来看，其主要功能是围绕漏洞验证展开，恶意代码的隐藏空间相对有限。因此，初步估计投毒风险约为 10%。这个百分比是主观评估，基于对代码的快速审查。更深入的审计可能发现更高或更低的风险。

**缓解措施：**

*   及时更新 iOS/iPadOS 到最新版本。
*   避免恢复来自不可信来源的备份文件。
*   增强对备份文件的安全性检查。

**项目地址:** [missaels235/POC-CVE-2025-24104-Py](https://github.com/missaels235/POC-CVE-2025-24104-Py)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)

---



---

## POC #2

**来源**: [CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md](../2025/CVE-2025-24104-missaels235_POC-CVE-2025-24104-Py.md)

## CVE-2025-24104 - iOS/iPadOS 本地文件修改漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接处理不当导致的文件修改

**影响应用:** iOS/iPadOS

**危害等级:** 中危，需要用户交互，可能导致受保护的系统文件被修改

**影响版本:** iPadOS < 17.7.4, iOS and iPadOS < 18.3

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 是一个由于符号链接处理不当导致的文件修改漏洞，存在于 iPadOS 和 iOS 中。攻击者可以制作一个恶意的备份文件，诱导用户恢复该备份。由于系统在恢复备份时对符号链接处理不当，攻击者可以利用该漏洞修改受保护的系统文件，如 `/private/etc/passwd`。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意符号链接的备份文件。
2.  攻击者诱骗用户恢复该备份文件。
3.  在备份恢复过程中，恶意符号链接会将目标文件（如 `/private/etc/passwd`）链接到备份文件中的某个攻击者可控的文件。
4.  备份恢复过程会将攻击者可控的文件内容覆盖到目标文件，从而修改了受保护的系统文件。

**POC有效性评估：**

根据漏洞描述和POC代码，该POC利用了 `idevicebackup2` 工具来备份和恢复设备。POC代码通过创建包含恶意符号链接的备份，并尝试将其恢复到目标设备上，验证了该漏洞的存在。如果目标设备的iOS版本低于18.3 (或 iPadOS 17.7.4)，且用户执行了恢复操作，则POC可以成功修改目标文件，证明漏洞利用的有效性。值得注意的是，POC中强调了需要用户交互，即需要用户主动恢复恶意备份。

**投毒风险评估：**

虽然提供的POC代码主要目的是验证漏洞的存在，但仍需评估是否存在隐藏的投毒代码。代码中涉及创建临时目录、执行外部命令(`idevicebackup2`)、读取和写入 plist 文件等操作，这些操作都可能被利用来执行恶意代码。例如，攻击者可能通过修改 plist 文件或在临时目录中放置恶意文件，在用户不知情的情况下执行恶意操作。但是，从代码整体结构来看，其主要功能是围绕漏洞验证展开，恶意代码的隐藏空间相对有限。因此，初步估计投毒风险约为 10%。这个百分比是主观评估，基于对代码的快速审查。更深入的审计可能发现更高或更低的风险。

**缓解措施：**

*   及时更新 iOS/iPadOS 到最新版本。
*   避免恢复来自不可信来源的备份文件。
*   增强对备份文件的安全性检查。

**项目地址:** [missaels235/POC-CVE-2025-24104-Py](https://github.com/missaels235/POC-CVE-2025-24104-Py)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)

---

