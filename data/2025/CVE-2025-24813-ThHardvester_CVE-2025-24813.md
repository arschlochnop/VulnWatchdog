## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (猜测，基于RCE漏洞)

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires network access to the Tomcat server, partial PUT feature enabled.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 35%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability in Apache Tomcat related to the improper handling of partial PUT requests. The vulnerability allows a remote attacker to execute arbitrary code on the server. The provided Python POC exploits this vulnerability by first checking if the Tomcat server is writable via PUT requests by attempting to write a file named 'check.txt'. If the server allows PUT requests, the script proceeds to generate a payload using ysoserial, if the ysoserial path is provided, or a Java payload if not, which will execute a command specified by the user. The payload is then uploaded to the server using a PUT request with a crafted Content-Range header, exploiting the partial PUT feature. The successful execution of the payload results in arbitrary code execution on the Tomcat server. The vulnerability exists because Tomcat does not properly validate the Content-Range header when handling PUT requests, allowing an attacker to overwrite arbitrary files on the server, including files containing executable code. 

**Exploit Steps:**
1. The script checks for write access via PUT requests.
2. A ysoserial or Java payload is generated to execute a specified command.
3. The payload is uploaded using a PUT request with a crafted Content-Range header.
4. If successful, the specified command is executed on the server.

**Poisoning Risk Analysis:** The Python script provided demonstrates a direct exploitation of the RCE vulnerability. The primary risk stems from the dependency on ysoserial, a tool widely used for generating Java deserialization payloads. While ysoserial itself is not inherently malicious, payloads generated with it can be used to execute arbitrary code, making it a potential vector for malicious activities if the script were to be modified to automatically download ysoserial from an untrusted source or to use pre-generated payloads from unknown origins. The script itself does not contain any explicit code obfuscation or attempt to execute arbitrary commands beyond what is provided as user input, but the ability to execute commands makes the script potentially dangerous. The java payload also poses a risk since it also executes commands.
 The risk is further increased if the script were distributed with malicious intent, as it could be used to easily compromise vulnerable Tomcat servers.
Considering that the script requires user-provided commands and relies on a known tool (ysoserial), the poisoning risk is estimated to be moderate. The usage of external commands via subprocess carries inherent risk.

**项目地址:** https://github.com/whoadmin/cve-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
