## CVE-2025-30208 - Vite (前端开发工具) 路径穿越 (Path Traversal)

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 路径穿越 (Path Traversal)

**影响应用:** Vite (前端开发工具)

**危害等级:** 中等 (Medium)

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)

**影响版本:** Vite < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15

**利用条件:** 目标处于开发模式并运行 Vite Dev Server，攻击者能够通过网络访问该服务端口（默认 5173）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对 Vite 开发服务器中的 `@fs` 路径处理逻辑进行了针对性实现。Vite 在开发环境下提供了一个文件系统访问 API，即 `@fs` 前缀。原本的设计应限制在项目目录或允许的路径内。然而，CVE-2025-30208 揭示了通过构造特定的查询参数（如 `?import&raw??`）可以绕过现有的路径验证逻辑。分析 POC 代码可以看到，脚本通过 `requests` 库向 `http://target:port/@fs/etc/passwd?import&raw??` 发送请求。关键点在于查询字符串的末尾使用了双问号及 `import&raw` 标志，这诱导 Vite 服务端将其识别为静态原始资源，从而跳过了某些安全中间件的路径解析限制。代码中包含了 `ast.literal_eval` 处理返回的 JavaScript 模块字符串（Vite 会将读取的文件内容封装在 `export default "..."` 中），这表明攻击者可以直接在内存中还原出被读取文件的明文内容。经评估，该 POC 逻辑严密，能够复现路径穿越的效果，属于高质量的漏洞利用脚本。利用步骤：1. 确认目标 Vite 开发服务器地址，通常为 localhost:5173 或内网 IP 端口。2. 构造攻击 URL，路径格式为 `[目标地址]/@fs/[绝对路径]?[Payload]`。3. 使用 POC 发送 GET 请求，Payload 为 `import&raw??`。4. 解析服务器返回的 JavaScript 封装格式，提取文件真实数据。投毒风险分析：该脚本虽然使用了 `ast.literal_eval` 这一具有潜在风险的函数，但其目的是为了解析 Vite 返回的特定格式字符串。`ast.literal_eval` 相比 `eval` 更加安全，因为它只处理字面量。脚本逻辑透明，主要使用了 `requests` 和 `argparse` 等标准库，未发现明显的混淆、恶意后门、隐藏的网络回传或篡改本地文件的行为。脚本包含了一个标准的 ASCII Banner 和详细的日志记录功能，显示其更倾向于防御性安全研究工具。然而，鉴于该脚本可以轻松获取敏感系统文件（如 /etc/passwd 或 .env 文件），且通过 `logging` 模块将敏感信息写入本地文件，用户在不受信任的环境中运行仍需谨慎。综合来看，其恶意投毒概率较低，但在实际防御场景中，应警惕他人对此 POC 进行二次修改，例如将读取到的文件内容静默发送至攻击者控制的远程服务器。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
