## CVE-2025-57105 - D-Link DI-7400G+ 企业级路由器 命令注入 (Command Injection)

**漏洞编号:** CVE-2025-57105

**漏洞类型:** 命令注入 (Command Injection)

**影响应用:** D-Link DI-7400G+ 企业级路由器

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Firmware 19.12.25A1 及更早版本 (EOL)

**利用条件:** 远程网络访问，无需身份验证 (根据POC逻辑显示无需Auth头)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该漏洞存在于D-Link DI-7400G+路由器的后台管理组件中，具体涉及mng_platform.asp与wayos_ac_server.asp。漏洞根源在于系统对NVRAM参数处理不当。攻击者可以通过HTTP GET请求向mng_platform.asp发送精心构造的参数ac_mng_srv_host，该参数会被持久化存储在路由器的NVRAM中。随后，当访问wayos_ac_server.asp时，系统会从NVRAM读取该参数并直接拼接到shell命令字符串中执行。利用步骤如下：1. 首先发送请求至mng_platform.asp，设置opt=proxy、proxy_ac_status=1及ac_server_enable=1以开启必要的前置服务。2. 在同个或后续请求中，通过ac_mng_srv_host参数注入恶意shell指令（例如：;id;）。3. 访问wayos_ac_server.asp触发后台对该NVRAM值的读取与执行，从而实现远程代码执行（RCE）。提供的Python POC代码结构完整，采用了模块化设计，包含了参数解析（argparse）、自动化环境准备（SETUP_ENDPOINT）以及指令触发（TRIGGER_ENDPOINT）功能，能够实现从简单的指令回显到反弹shell的完整链路。经过代码静态审计，该POC逻辑清晰，针对性极强，在受影响的物理设备上具有极高的成功率。 投毒风险分析：对提供的exploit.py代码进行安全性评估，未发现明显的投毒或恶意后门行为。代码使用了标准的Python库如requests、argparse、dataclasses和enum。逻辑流程完全围绕CVE-2025-57105的漏洞特征展开，没有发现试图读取本地敏感文件（如~/.ssh/id_rsa）、执行未授权的系统命令或向第三方C2服务器外传数据的混淆代码。代码中唯一的外部连接指向用户定义的<target_ip>。虽然包含反弹shell（--reverse-shell）功能，但这是作为漏洞验证工具的常规功能存在，且由用户主动通过命令行参数触发。代码风格符合安全研究人员的编写习惯，未使用base64混淆执行、eval()动态代码执行等高风险特征。由于该漏洞影响的是已停止维护（EOL）的设备，此POC更多用于内网渗透测试或安全研究。综上所述，该代码具有极高的透明度，投毒风险极低，属于高质量的防御性安全研究资源。

**项目地址:** N/A (本地分析路径: /tmp/vulnwatchdog_74b71655f5944da37553da88c9e1ba1e)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-57105](https://nvd.nist.gov/vuln/detail/CVE-2025-57105)
