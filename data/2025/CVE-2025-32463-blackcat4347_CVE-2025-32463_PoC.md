## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17(含)

**利用条件:** 本地用户访问权限，sudo支持-R (chroot) 选项

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC通过构造恶意的chroot环境实现了对Sudo本地提权漏洞CVE-2025-32463的完整利用。分析POC代码可知，漏洞的核心在于Sudo在处理‘-R’或‘--chroot’参数时，未能正确隔离动态库的加载路径。攻击者可以在受控目录下创建伪造的‘/etc/nsswitch.conf’文件，并将其中的‘passwd’数据库指向一个自定义名称。随后，利用glibc的NSS（Name Service Switch）机制，系统会尝试加载‘libnss_自定义名称.so.2’。POC中的cve_2025_32463.c自动化了这一过程：它首先创建一个临时目录作为Stage，并在其中构建必要的目录结构，将包含恶意代码的动态库（由woot1337.c编译并由libwoot1337.h以二进制数组形式嵌入）写入该目录。当执行‘sudo -R’指向该Stage目录时，Sudo会以root权限加载该动态库，从而触发woot函数。该函数通过setreuid(0,0)和setregid(0,0)重置权限并弹出root shell。此利用链条逻辑清晰，直接针对Sudo 1.9.14+版本的架构缺陷，具有极高的实战有效性，在受影响的Linux发行版（如Ubuntu等）上成功率极高。【利用步骤】1. 编译恶意动态库：使用gcc将woot1337.c编译为共享库libwoot1337.so；2. 转换数据：利用xxd将.so文件转换为C头文件，以便主利用程序调用；3. 编译主程序：编译cve_2025_32463.c生成可执行文件；4. 执行攻击：在目标机器上运行编译后的程序，程序会自动创建恶意chroot环境并调用sudo -R，最终获得root shell。【投毒风险分析】经过深入的代码审计，该POC代码表现出极高的透明度和安全性。主程序cve_2025_32463.c的行为完全局限于/tmp目录下的随机子目录中，且所有操作（如mkdir, write_file, execlp）均清晰可见，没有发现任何网络连接、磁盘遍历或混淆加密等恶意行为。被嵌入的动态库代码woot1337.c功能单一，仅执行权限提升和启动bash的操作，属于典型的漏洞验证逻辑，而非恶意后门。README文档中虽然提到‘提供预编译版本以应对缺少GCC的环境’，这在威胁情报领域通常被视为一个风险信号，因为预编译二进制文件可能包含难以审计的恶意负载，但从源代码层面看，该项目本身是清洁的。由于代码逻辑简单且公开，攻击者对其进行二次修改并植入恶意代码的门槛极低，因此在从非官方渠道下载此类POC的编译产物时，仍需保持警惕。综合评估，该源码级别的POC投毒风险极低，属于标准的安全研究代码。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
