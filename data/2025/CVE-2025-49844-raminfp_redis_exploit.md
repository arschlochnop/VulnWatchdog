## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis < 8.2.2, < 8.0.4, < 7.4.6, < 7.2.11

**利用条件:** 需要经过身份验证（低权限账号即可），且Redis服务器需启用Lua脚本功能（默认启用）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC提供了一个完整的漏洞研究实验室环境，包含Dockerfile、docker-compose配置以及Python利用脚本。通过分析可知，该漏洞被称为‘RediShell’，是由于Redis Lua引擎在处理特定脚本逻辑时存在内存管理缺陷，导致Use-After-Free（释放后重用）漏洞。POC脚本通过多种模式（check/basic/sandbox/advanced）对目标进行探测和利用，能够实现从Lua沙箱逃逸到宿主机操作系统的远程代码执行。脚本逻辑清晰，使用了标准的redis-py库，证明了该漏洞在CVSS 10.0评分下的真实威力。该POC不仅能验证漏洞存在，还能通过内存破坏技术稳定获取Shell，具有极高的实战参考价值。利用步骤：1. 使用Docker部署漏洞环境（Redis 7.2.0）；2. 安装Python依赖（redis, colorama）；3. 执行exploit_poc.py脚本，指定目标IP和端口；4. 选择‘all’模式进行自动化测试，脚本将依次进行UAF触发、沙箱逃逸及最终的指令执行。投毒风险分析：经过对提供的代码结构审计，该POC目前表现为较低的投毒风险。代码中未发现明显的混淆处理、恶意二进制Payload下载或敏感信息外传行为。其依赖项均为Python官方仓库的常用库。然而，作为针对CVSS满分漏洞的利用工具，此类脚本在传播过程中极易被篡改。风险点在于：首先，攻击者可能在exploit_poc.py的Payload生成逻辑中注入反弹Shell至第三方服务器的代码；其次，Dockerfile中可能被植入恶意的基础镜像。虽然当前代码包主要用于实验室防御性研究，但在生产环境下载并运行此类未经严格审计的第三方脚本仍需谨慎。建议研究人员在隔离的虚拟化环境（如本POC自带的Docker环境）中进行测试，并对Python脚本中的核心Payload进行静态代码扫描，以防潜在的供应链投毒风险。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
