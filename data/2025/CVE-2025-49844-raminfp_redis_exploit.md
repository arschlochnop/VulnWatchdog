## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis < 8.2.2, < 8.0.4, < 7.4.6, < 7.2.11

**利用条件:** 经过身份验证的远程用户（具备执行Lua脚本权限，如低权限用户）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC（代号RediShell）针对Redis Lua解释器中的Use-After-Free (UAF) 漏洞提供了完整的实验环境。通过Dockerfile构建的Redis 7.2.0镜像，模拟了真实受灾版本。exploit_poc.py 脚本涵盖了从漏洞检测（check）、基础UAF测试到高级内存损坏（advanced）及沙箱逃逸（sandbox）的全路径，逻辑严密，能够绕过Lua沙箱实现宿主机级别的代码执行。利用步骤：1. 部署环境：使用docker-compose启动漏洞版本Redis；2. 侦察阶段：运行-m check模式确认目标版本是否存在内存管理缺陷；3. 内存布局：脚本通过特定Lua指令触发错误的内存释放，并利用新数据占据已释放的内存块；4. 执行Payload：通过恶意构造的Lua脚本触发UAF，改变程序执行流，从而执行任意系统命令。投毒风险分析：该POC目前表现为专业的防御性研究工具，其Dockerfile和README文档清晰地标注了安全警告，代码结构透明且未使用混淆技术。风险点在于其‘advanced’和‘all’模式包含了能够直接导致内存损坏的高级利用代码，若被不法分子直接包装在自动化脚本中，可能导致生产环境的大规模崩溃。经过代码审计，该POC依赖标准库（redis, colorama），未发现明显的外部恶意请求发送或后门植入行为，整体属于低风险的科研范畴，但因利用代码极其致命且完整，建议仅在受控隔离网络环境中使用，防止被作为攻击跳板。

**项目地址:** 本地实验室环境路径: /tmp/vulnwatchdog_7236513b7655933b116768be461dcc77/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
