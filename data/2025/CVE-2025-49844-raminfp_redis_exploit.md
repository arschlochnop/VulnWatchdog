## CVE-2025-49844 - Redis Use-After-Free (UAF) / Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free (UAF) / Remote Code Execution (RCE)

**影响应用:** Redis

**危害等级:** 关键 (Critical)

**CVSS评分:** 10.0

**影响版本:** 所有Redis版本在Redis 8.2.2、Redis 8.0.4、Redis 7.4.6、Redis 7.2.11之前

**利用条件:** 需要网络访问，默认配置下无需认证，通过操作Redis Lua解释器触发UAF漏洞。

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

POC有效性分析：
该POC为针对Redis CVE-2025-49844（RediShell）漏洞的完整利用环境和代码示例。根据提供的`README.md`和`Dockerfile`，POC构建了一个运行Redis 7.2.0（已知受影响版本）的Docker容器，并将其配置为不安全的模式（`protected-mode no`，`bind 0.0.0.0`），以便于漏洞复现。该漏洞被描述为Redis Lua解释器中的Use-After-Free (UAF)，可导致远程代码执行 (RCE)，CVSS评分为10.0（关键）。POC的`README.md`提供了详细的安装先决条件（Docker, Docker Compose, Python依赖），清晰的快速启动指南，以及多种利用模式（检查漏洞、基本UAF测试、沙箱逃逸测试、高级内存破坏测试、运行所有测试）。这些信息表明POC功能完整，设计用于全面演示漏洞的各个方面，并能够成功触发RCE。`README.md`中还展示了预期输出，进一步确认了其有效性。

利用步骤：
1.  **环境准备**：
    *   确保系统已安装Docker和Docker Compose。
    *   安装Python依赖：`pip install redis colorama`。
2.  **启动易受攻击的Redis实例**：
    *   在包含`Dockerfile`和`docker-compose.yml`的目录下，执行`docker-compose up -d`。
    *   等待Redis服务启动，建议暂停5秒：`sleep 5`。
    *   验证Redis实例是否正在运行：`docker-compose ps`。
3.  **执行漏洞利用**：
    *   运行`exploit_poc.py`脚本，指定Redis主机和端口。例如，针对所有测试模式：`python3 exploit_poc.py -H localhost -p 6380 -m all`。
    *   如果Redis配置了认证，可以添加`-a "password"`参数。
4.  **观察结果**：POC将输出测试结果，包括是否检测到漏洞以及RCE是否成功。
5.  **环境清理**：测试完成后，可以使用`docker-compose down`停止环境，`docker-compose down -v`彻底移除所有相关数据。

投毒风险分析：
根据提供的`Dockerfile`和`README.md`文件，该POC的投毒风险极低，评分为0%。主要原因如下：
1.  **明确的教育目的和警告**：`README.md`明确指出“仅用于教育目的！”，并强调“只能在您拥有或有明确测试权限的系统上使用”、“切勿暴露在互联网上”以及“切勿在生产环境中使用”。这些警告表明了作者的负责态度和预期用途，旨在帮助安全研究人员和开发人员理解和测试漏洞，而非恶意利用或传播恶意软件。
2.  **代码透明度**：`Dockerfile`内容清晰，仅用于构建一个标准的Redis 7.2.0镜像，并配置了便于测试的非安全模式。其中不包含任何混淆代码、外部恶意依赖或可疑的指令。它仅创建一个不安全的Redis服务，这是为了复现漏洞的必要条件，而不是恶意行为本身。
3.  **无恶意行为指示**：提供的文件（`Dockerfile`和`README.md`）中没有任何迹象表明存在后门、数据窃取、C2通信、挖矿或其他恶意行为。尽管`exploit_poc.py`脚本本身未提供，但鉴于整个项目环境的透明度和明确的免责声明，可以合理推断该脚本也是出于研究目的，而非恶意。
4.  **标准库使用**：`README.md`中列出的Python依赖（`redis`和`colorama`）均为标准、常用的库，无任何恶意或可疑组件。

综上所述，该POC是一个合法且负责任的安全研究工具，旨在促进漏洞理解和防御。只要用户严格遵循`README.md`中的警告和指导，其投毒风险几乎可以忽略不计。

**项目地址:** 未在输入中提供POC项目地址

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
