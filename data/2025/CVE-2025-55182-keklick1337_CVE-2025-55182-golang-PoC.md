## CVE-2025-55182 - React Server Components, Next.js 远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** react-server-dom-webpack: 19.0.0 - 19.2.0; Next.js: 15.x (before patches: 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7); Next.js: 16.x (before 16.0.7); Next.js: 14.3.0-canary.77 and later canary versions

**利用条件:** 无需认证，可远程利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182是一个存在于React Server Components (Flight 协议)中的严重远程代码执行漏洞。该漏洞源于Flight协议反序列化中的原型污染。PoC的有效性分析如下：

PoC利用了以下步骤实现RCE：首先，它使用`$@`反序列化来获取Chunk引用。然后，它将`Chunk.prototype.then`设置为根对象的`then`属性。接着，它将状态设置为`RESOLVED_MODEL`，以便使用受控的伪造chunk调用`initializeModelChunk`。最后，它触发Blob反序列化，该反序列化使用攻击者payload调用`response._formData.get`，并将`response._formData.get`设置为Function构造函数以实现任意代码执行。

该PoC的Go语言实现提供了多种功能，包括完整的RCE能力，允许执行任意命令并获取输出。它还提供了漏洞检查模式，可以在不进行实际利用的情况下安全地检测漏洞。此外，PoC能够自动检测Next.js的版本，并支持多种代理类型，如SOCKS5、SOCKS4和HTTP/HTTPS代理。PoC还支持内存Shell注入，可以在`/exec?cmd=`路径下创建一个持久的后门。还包括批量扫描功能，允许使用多线程进行扫描，并输出JSON格式的结果。PoC还具有隐身模式，可以模拟浏览器、爬虫或安全User-Agent。此外，PoC还支持速率限制、反向shell和数据泄露等功能。该PoC提供了跨平台构建，支持30多种操作系统和架构组合，并提供JSON输出，以便进行自动化。

利用步骤：
1. 下载或构建PoC工具。
2. 配置目标URL和所需的任何代理或身份验证。
3. 运行PoC工具，选择漏洞检查模式或完整利用模式。
4. 如果成功，PoC将执行任意代码并在目标服务器上获得控制权。

投毒风险分析：

该PoC的投毒风险较低。PoC代码清晰，主要使用标准库，没有明显的混淆或恶意行为。PoC没有包含执行恶意操作或下载外部脚本的代码，没有使用`eval`等高风险函数。该PoC主要用于验证漏洞的存在和进行渗透测试，不包含恶意负载或后门代码。该工具明确声明仅用于授权的安全测试。尽管如此，仍然存在一些轻微的风险，例如攻击者可能会修改PoC代码以包含恶意功能，或者不小心在生产环境中运行PoC。鉴于以上分析，该PoC的投毒风险估计为15%。

**项目地址:** https://github.com/keklick1337/CVE-2025-55182-golang-PoC

**漏洞详情:** None
