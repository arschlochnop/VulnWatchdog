# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-Nowafen_cve-2025-4123.md](../2025/CVE-2025-4123-Nowafen_cve-2025-4123.md)

# CVE-2025-4123

> 📦 该CVE有 **9** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md](../2025/CVE-2025-4123-B1ack4sh_Blackash-CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #2

**来源**: [CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md](../2025/CVE-2025-4123-DesDoTvl_CVE-2025-4123grafana.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行

**影响版本:** 受影响版本：Grafana 10.4.18+security-01 之前的所有 10.x 版本，Grafana 11.2.9+security-01 之前的所有 11.2.x 版本，Grafana 11.3.6+security-01 之前的所有 11.3.x 版本，Grafana 11.4.4+security-01 之前的所有 11.4.x 版本，Grafana 11.5.4+security-01 之前的所有 11.5.x 版本，Grafana 11.6.1+security-01 之前的所有 11.6.x 版本，Grafana 12.0.0+security-01 之前的所有 12.0.x 版本

**利用条件:** 需要用户交互（点击恶意链接）。如果启用了匿名访问，则XSS无需身份验证即可工作。安装了Grafana Image Renderer插件则可能存在SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，允许攻击者将用户重定向到一个托管恶意前端插件的网站，该插件可以执行任意 JavaScript。如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取 SSRF。

**利用方式：**

1.  **XSS：** 攻击者构造一个包含恶意重定向 URL 的链接，诱骗用户点击。此 URL 指向一个托管恶意 Grafana 插件的服务器。恶意插件包含 JavaScript 代码，可以在用户的 Grafana 会话中执行。
2.  **SSRF (如果安装了 Grafana Image Renderer)：** 攻击者利用开放重定向，将 Grafana Image Renderer 重定向到内部或外部资源。由于 Grafana Image Renderer 会获取重定向后的内容，因此攻击者可以读取服务器上的敏感文件或与内部服务交互。

**POC代码分析：**

提供的 Python 代码是一个网络扫描器，用于检测给定网络中是否存在易受 CVE-2025-4123 攻击的 Grafana 实例。它不是直接利用漏洞的 PoC，而是一个用于查找潜在目标的工具。该脚本通过发送请求并检查响应来确定 Grafana 实例是否容易受到攻击。

**投毒风险分析：**

提供的代码片段主要是GUI扫描器，该代码未发现恶意代码。因此,投毒风险为0%。

**项目地址:** [DesDoTvl/CVE-2025-4123grafana](https://github.com/DesDoTvl/CVE-2025-4123grafana)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #3

**来源**: [CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md](../2025/CVE-2025-4123-ItsNee_Grafana-CVE-2025-4123-POC.md)

## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #4

**来源**: [CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md](../2025/CVE-2025-4123-MorphyKutay_CVE-2025-4123-Exploit.md)

## CVE-2025-4123-Grafana-XSS和Open Redirect

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和开放重定向

**影响应用:** Grafana

**危害等级:** 高危，可能导致用户凭据泄露，SSRF攻击以及任意JavaScript代码执行。

**影响版本:** 受影响版本：Grafana < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例，且可能需要匿名访问开启。如果安装了Grafana Image Renderer插件，则可能触发SSRF。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个跨站脚本（XSS）漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到托管恶意前端插件的网站，该插件可以执行任意 JavaScript 代码。此漏洞不需要编辑器权限，如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**有效性分析：**

提供的 PoC 代码通过发送包含特定 payload 的请求，并检查服务器是否返回 301 或 302 重定向响应来检测漏洞。Payload `/public/..%2F%5cgoogle.com%2F%3f%2F..%2F..` 旨在触发路径遍历和开放重定向。

该 PoC 通过 `CheckRedirect` 函数禁用 Go 的自动重定向，以便能够检查原始响应的 `Location` 标头。如果服务器返回 301 或 302 响应，并且 `Location` 标头指示重定向到非预期域（例如 google.com），则表明存在漏洞。

**投毒风险分析：**

在提供的 PoC 代码中，没有发现明显的投毒代码。该代码的功能是发送特定 payload 并检查重定向响应，这与漏洞描述一致。PoC 本身旨在验证漏洞的存在，而不是执行恶意操作。代码逻辑简单，没有隐藏的或混淆的代码段，也没有尝试执行任何系统命令或访问敏感信息。

**利用方式分析：**

1.  **路径遍历和开放重定向：** 漏洞利用的核心是路径遍历和开放重定向。攻击者构造包含特殊字符的 URL，利用 Grafana 的路径处理逻辑中的缺陷，将用户重定向到攻击者控制的域。
2.  **XSS 攻击：** 一旦用户被重定向到攻击者控制的域，攻击者就可以通过托管包含恶意 JavaScript 代码的前端插件来执行 XSS 攻击。此代码可以窃取用户凭据、执行管理操作或进一步攻击其他系统。
3.  **SSRF 攻击（如果安装了 Grafana Image Renderer 插件）：** 如果 Grafana Image Renderer 插件已安装，攻击者可以利用开放重定向来触发 SSRF 攻击。攻击者可以控制服务器端发出的请求，读取服务器上的敏感文件或访问内部服务。
4.  **绕过 CSP：** 漏洞描述提到默认的 Content-Security-Policy (CSP) 可能会阻止 XSS，但 `connect-src` 指令配置不当或者存在其他绕过方式，攻击仍然可以成功。

**总结：**

该漏洞利用方式较为直接，利用路径遍历和开放重定向将用户导向恶意站点，从而实施 XSS 或 SSRF 攻击。PoC 代码有效，可以用来检测漏洞的存在。提供的代码本身不包含投毒行为。

**项目地址:** [MorphyKutay/CVE-2025-4123-Exploit](https://github.com/MorphyKutay/CVE-2025-4123-Exploit)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #5

**来源**: [CVE-2025-4123-NightBloodz_CVE-2025-4123.md](../2025/CVE-2025-4123-NightBloodz_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #6

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #7

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---



---

## POC #7

**来源**: [CVE-2025-4123-imbas007_CVE-2025-4123-template.md](../2025/CVE-2025-4123-imbas007_CVE-2025-4123-template.md)

## CVE-2025-4123-Grafana-XSS/Open Redirect/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/Open Redirect/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户劫持、敏感信息泄露、SSRF

**影响版本:** 受影响版本包括 Grafana 10.4.18+security-01 之前的所有 10.4.x 版本、11.2.9+security-01 之前的所有 11.2.x 版本、11.3.6+security-01 之前的所有 11.3.x 版本、11.4.4+security-01 之前的所有 11.4.x 版本、11.5.4+security-01 之前的所有 11.5.x 版本、11.6.1+security-01 之前的所有 11.6.x 版本、以及 12.0.0+security-01 之前的所有 12.0.x 版本。

**利用条件:** 需要用户交互（点击恶意链接），匿名访问可能增加风险，安装Grafana Image Renderer插件将允许SSRF攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。 攻击者可以利用此漏洞将用户重定向到托管前端插件的恶意网站，从而执行任意 JavaScript 代码。 如果启用了匿名访问，则此漏洞无需编辑权限即可利用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完整的读取 SSRF。该漏洞的CVSS评分为7.6，属于高危漏洞。 漏洞利用方式为：攻击者构造包含恶意路径的URL，诱导用户点击。该URL首先利用客户端路径遍历和开放重定向，将用户重定向到攻击者控制的服务器，然后攻击者控制的服务器返回包含恶意 JavaScript 代码的页面，从而在用户的浏览器中执行任意代码。

**有效性评估：** 根据搜索结果和提供的nuclei模板，可以确认该漏洞利用代码（nuclei模板）是有效的。多个来源证实了漏洞的存在，以及利用客户端路径遍历和开放重定向进行XSS和SSRF攻击的可能性。

**投毒风险评估：** nuclei模板文件本身没有明显的恶意代码，主要是请求和匹配。但是`README.md`文件内容简单,也无风险,总体仓库较小,但需要人工进行review确认没有被篡改覆盖。

**利用方式分析：**

1.  **开放重定向：** 利用 Grafana 的开放重定向漏洞，将用户重定向到恶意网站。
2.  **XSS：** 在恶意网站上托管包含 XSS 有效负载的 JavaScript 代码，当用户被重定向到该网站时，恶意代码将在用户的浏览器中执行。
3.  **SSRF（可选）：** 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现 SSRF 攻击，读取内部服务的信息。

**Nuclei 模板利用流程：**

1.  Nuclei 模板发送包含特殊构造的 URL 的 GET 请求，该 URL 包含路径遍历序列（`..%252f%255C` 或 `..%2F%5c`）和指向恶意网站的重定向（`{{interactsh-url}}` 或 `oast.pro`）。
2.  Grafana 服务器处理请求时，由于路径遍历漏洞，会错误地将请求重定向到恶意网站。
3.  如果请求成功重定向，Nuclei 模板会通过状态码（302）和 Location 头部中是否包含恶意网站的 URL 来判断是否存在开放重定向漏洞。
4.  如果 Interactsh 检测到 DNS 交互，并且 content type 是 image/png 说明存在SSRF漏洞，这是因为 `/render` 接口会尝试渲染重定向到的地址，从而触发SSRF。

**项目地址:** [imbas007/CVE-2025-4123-template](https://github.com/imbas007/CVE-2025-4123-template)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #8

**来源**: [CVE-2025-4123-kk12-30_CVE-2025-4123.md](../2025/CVE-2025-4123-kk12-30_CVE-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #9

**来源**: [CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md](../2025/CVE-2025-4123-punitdarji_Grafana-cve-2025-4123.md)

## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

## POC #10

**来源**: [CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md](../2025/CVE-2025-4123-ynsmroztas_CVE-2025-4123-Exploit-Tool-Grafana-.md)

## CVE-2025-4123 - Grafana 路径遍历、开放重定向和XSS漏洞

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 路径遍历、开放重定向、跨站脚本（XSS）

**影响应用:** Grafana

**危害等级:** 高危，可能导致信息泄露、SSRF、远程代码执行（通过XSS或SSRF）和账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要Grafana实例存在`/public`端点，且可能需要匿名访问或用户交互（点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本（XSS）攻击。攻击者可以利用此漏洞将用户重定向到包含恶意前端插件的网站，从而执行任意JavaScript代码。漏洞影响的版本包括10.4.19之前，11.2.10之前，11.3.7之前，11.4.5之前，11.5.5之前，11.6.2之前，以及12.0.1之前的Grafana版本。

**利用方式：**

1.  **路径遍历：**  利用`../`序列绕过`/public`目录的访问限制。
2.  **开放重定向：**  构造包含恶意URL的链接，诱导用户点击，使其重定向到攻击者控制的站点。
3.  **XSS：**  在重定向的站点上，通过恶意插件执行JavaScript代码，例如窃取用户会话或执行其他恶意操作。
4.  **SSRF (如果安装了Grafana Image Renderer插件)：** 利用开放重定向结合 Grafana Image Renderer 插件实现 SSRF 攻击，读取内部资源。
5.  **LFI：** 尝试读取服务器上的敏感文件，如`/etc/passwd`。

**有效性：**

提供的PoC代码有效，它实现了SSRF、LFI、开放重定向和XSS攻击。该PoC允许用户指定目标Grafana实例和所需攻击模式，并生成相应的URL。PoC 会测试生成的 URL，并打印状态代码和响应片段。

**投毒风险：**

分析PoC代码，未发现明显的投毒代码。脚本的主要功能是生成和测试包含恶意payload的URL，没有发现任何尝试在受害者系统上安装恶意软件或执行其他恶意操作的逻辑。该脚本的意图是展示漏洞如何被利用，而不是部署恶意软件。因此，投毒风险为0%。

**项目地址:** [ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-](https://github.com/ynsmroztas/CVE-2025-4123-Exploit-Tool-Grafana-)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)

---

