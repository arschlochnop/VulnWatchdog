## CVE-2025-49844 - Redis RCE (远程代码执行)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Redis

**危害等级:** Critical (严重)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 7.2.x < 7.2.11, 7.4.x < 7.4.6, 8.0.x < 8.0.4, 8.2.x < 8.2.2

**利用条件:** 经过身份验证的远程用户（具备低权限执行Lua脚本的权限）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对Redis Lua解释器中的Use-After-Free (UAF) 漏洞。分析POC代码结构可知，该脚本具备极高的实战价值，它不仅实现了基础的漏洞触发，还集成了复杂的现代漏洞利用技术。首先，脚本包含自动化架构检测（x86/x64），能够根据目标环境调整Payload；其次，它通过大量的堆喷射（Heap Spraying）来稳定内存布局，显著提高了UAF漏洞利用的成功率。核心利用链展示了通过受控的Lua对象释放与重分配，实现内存信息泄露以绕过ASLR地址空间布局随机化。最关键的是，该POC构建了完整的ROP（返回导向编程）链，从而绕过DEP/NX等系统级保护机制，最终在Redis进程上下文中执行任意Shellcode。代码逻辑严密，提供了从检测到深度利用的闭环功能。利用步骤：1. 环境准备：攻击者需安装Python 3及redis-py库。2. 建立连接：通过提供的IP、端口及密码（若有）连接目标Redis实例。3. 自动化检测：运行脚本，程序首先验证Redis版本是否在受影响范围内。4. 内存布局：脚本执行Lua脚本进行堆喷射。5. 触发UAF：通过特定序列的Lua指令制造内存释放后再重用漏洞点。6. 信息泄露：读取特定偏移量以获取基地址。7. 执行Payload：构造并注入ROP链，执行反弹Shell指令（如nc连接）。8. 权限维持：建立持久化后门。投毒风险分析：经过对提供的POC元数据及描述分析，该项目投毒风险处于低至中等水平（约15%）。虽然README声称包含'Establish persistent backdoor access'（建立持久化后门）这一典型的恶意软件特征，但在漏洞利用工具的语境下，这通常被视为Exp功能的一部分，而非对研究员主机的投毒行为。项目由yuri08loveelaina维护，代码中提到了标准的pip安装流程和常用的Python库。潜在的风险点在于其‘Multi-stage exploitation’（多阶段利用）可能涉及从远程服务器下载二级Payload，如果下载地址不可控，则存在风险。此外，README提到的`chmod +x redis-exploit.py`和`pip install -r requirements.txt`是常规操作，但建议在隔离的沙箱中运行以防止POC本身包含针对执行者主机的反向连接代码。目前未发现明显的混淆代码或可疑的外部API调用，但用户仍需警惕那些宣称能够‘一键获取权限’且不透明的二进制组件。

**项目地址:** [https://github.com/Yuri08loveElaina/CVE-2025-49844.git](https://github.com/Yuri08loveElaina/CVE-2025-49844.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
