## CVE-2025-49844 - Redis RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis 7.2.x < 7.2.11, 7.4.x < 7.4.6, 8.0.x < 8.0.4, 8.2.x < 8.2.2

**利用条件:** 经过身份验证的用户权限（低权限即可），具备执行Lua脚本的权限

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对Redis Lua解释器中的Use-After-Free（UAF）漏洞。漏洞源于Redis在处理Lua脚本时内存管理逻辑不当，导致已释放的内存对象被重新引用。POC代码展示了极高的专业性，集成了自动化环境检测与多阶段漏洞利用逻辑。有效性体现在其完整的利用链：首先，通过堆喷射（Heap Spraying）技术稳定内存布局，确保UAF触发后能精确控制重叠的内存块。其次，利用内存信息泄露漏洞获取Redis进程的基地址，从而绕过ASLR（地址空间布局随机化）。接着，POC构造了复杂的ROP链（Return-Oriented Programming）来绕过DEP/NX防护，最终实现任意Shellcode的加载。根据其README描述，该脚本支持自动识别x86/x64架构并建立反弹Shell。从技术实现看，该POC并非简单的PoC验证，而是高度武器化的漏洞利用工具，能在受影响的版本上实现高成功率的远程代码执行。【利用步骤】1. 环境准备：安装Python Redis客户端，确保目标Redis服务版本在漏洞影响范围内。2. 权限获取：获取有效的Redis访问凭据（如有密码需-a参数）。3. 攻击执行：运行exploit.py，指定目标主机及端口，脚本会自动进行版本和架构检测。4. 漏洞触发：脚本发送精心构造的Lua脚本至Redis，触发UAF并泄露内存地址。5. 载荷投送：脚本根据泄露地址生成ROP链并注入Shellcode。6. 权限维持：若配置了-l/-P参数，攻击者可在本地监听端口获取反弹Shell，甚至建立持久化后门。【投毒风险分析】在对此POC项目进行安全性评估时发现，该仓库由名为'Yuri08loveElaina'的用户发布，具备典型的开源安全研究项目特征。代码结构清晰，依赖项常规（redis库），未发现明显的恶意混淆或加密二进制文件。然而，作为安全研究员必须警惕以下几点风险：1. 武器化风险：由于该POC功能过于完整，包含了'建立持久化后门'等攻击性功能，极易被非专业黑客直接用于非法入侵，这属于功能性溢出带来的社会工程学风险。2. 二手传播风险：虽然原始代码目前看起来是合规的，但攻击者常通过Fork该仓库并修改exploit.py，在代码深处注入静默上传SSH密钥或向攻击者C2服务器发送受害者IP的行为。3. 虚假POC风险：安全社区曾多次出现针对CVE-10.0评分漏洞发布的虚假POC，这些POC在运行后会反向格式化运行者的磁盘或植入窃号木马。当前的POC代码虽然提供了详细的防御检测指标（如不寻常的Lua执行模式），但研究人员在测试时仍应在隔离的沙箱环境中运行，严禁在生产环境尝试，且需重点检查exploit.py是否包含非目标IP的隐藏Socket连接。目前评估其投毒风险为15%，主要源于其高杀伤力可能被恶意第三方利用篡改。

**项目地址:** [https://github.com/Yuri08loveElaina/CVE-2025-49844](https://github.com/Yuri08loveElaina/CVE-2025-49844)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
