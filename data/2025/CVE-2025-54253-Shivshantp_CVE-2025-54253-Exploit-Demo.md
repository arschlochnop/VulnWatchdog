## CVE-2025-54253 - Adobe AEM Forms on JEE 远程代码执行 (RCE), OGNL注入, 认证绕过

**漏洞编号:** CVE-2025-54253

**漏洞类型:** 远程代码执行 (RCE), OGNL注入, 认证绕过

**影响应用:** Adobe AEM Forms on JEE

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** <= 6.5.23.0

**利用条件:** 远程利用, 无需认证, 无需用户交互, 低复杂度

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2025-54253 是 Adobe Experience Manager (AEM) Forms on JEE 中的一个关键远程代码执行 (RCE) 漏洞。该漏洞源于 Apache Struts 在 AEM Forms 管理界面中错误地启用了“devMode”，并结合了认证绕过缺陷。这使得未经身份验证的攻击者能够向 `/adminui/debug` 端点发送特制的 HTTP 请求，并执行 Struts 框架解析的 OGNL (Object-Graph Navigation Language) 表达式，最终导致在应用程序服务器的上下文中执行任意操作系统命令。该漏洞的利用复杂度极低，且无需任何用户交互或认证。

**POC有效性分析：**
该漏洞的公开概念验证 (PoC) 代码表现出极高的有效性和实用性。PoC 提供了多种利用方式，包括通过 `curl` 命令直接在命令行中执行 OGNL 表达式，以及一个专门的 Python 脚本 (`cve-2025-54253-poc.py`)。PoC 的 `README.md` 文档非常详细和专业，清晰地概述了漏洞概览、技术细节、受影响产品和版本（<= 6.5.23.0）。文档中包含大量的截图，直观展示了从运行 Flask 模拟服务器、通过浏览器和 `curl` 执行 OGNL 命令（如 `whoami`、`id`、`uname -a`、`ls -la`）到 Python 脚本运行和详细日志输出的整个利用过程。这些证据充分验证了 PoC 的功能完整性及其成功实现远程代码执行的能力。因此，该 PoC 被评定为高质量的完整利用工具，能够直接用于漏洞的复现和验证。

**利用步骤：**
攻击者可以遵循以下简单步骤利用此漏洞：
1.  **识别目标：** 找到暴露 `/adminui/debug` 端点的 Adobe AEM Forms on JEE 实例。
2.  **构造请求：** 向 `/adminui/debug` 端点发送 HTTP GET 请求，并在 `debug` 参数中注入 OGNL 表达式。例如，要执行 `whoami` 命令，可以发送 `http://[目标IP或域名]:[端口]/adminui/debug?debug=OGNL:whoami`。
3.  **执行命令：** 应用程序服务器将解析并执行 OGNL 表达式，从而在服务器上执行指定的操作系统命令，并将结果返回给攻击者。
4.  **使用PoC脚本：** 对于更自动化的利用，可以使用提供的 Python PoC 脚本。例如，`python3 poc/cve-2025-54253-poc.py --url http://127.0.0.1:4502 --cmd "whoami"` 将会向指定 URL 发送请求并执行命令。脚本还会将执行结果记录到 `exploit.log` 文件中。

**投毒风险分析：**
根据对公开 PoC 代码（特别是其 `README.md` 文档）的分析，该 PoC 的投毒风险被评估为低（约10%）。主要原因如下：
1.  **代码透明性：** `README.md` 对漏洞原理、PoC 使用方法和预期结果进行了详尽的描述，且提供了命令行示例和脚本调用方式。这种高度的透明性降低了隐藏恶意代码或行为的可能性。
2.  **标准工具和技术：** PoC 主要依赖于标准工具（如 `curl`、Python）和常见的渗透测试技术（OGNL注入）。文档中没有提及使用任何非标准库、加密混淆技术或复杂的后门植入方法。
3.  **无恶意行为迹象：** PoC 演示的命令执行功能是为了验证漏洞，执行的都是典型的系统信息查询命令（`whoami`、`id`、`uname -a`、`ls -la`），这些命令本身不具有破坏性或恶意性。文档中也没有任何提示 PoC 会尝试连接外部恶意服务器、下载恶意载荷或修改系统关键配置。
4.  **安全研究目的：** PoC 的整体呈现方式符合合法安全研究和漏洞验证的最佳实践。其目标是帮助安全专业人员理解和复现漏洞，以便及时采取防御措施。
综上所述，虽然任何外部代码都存在潜在风险，但该 PoC 从现有信息来看，其设计和意图是用于安全研究，而非恶意投毒。组织在使用时仍应在隔离环境中进行测试，并仔细审查任何实际执行的脚本代码。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-54253
