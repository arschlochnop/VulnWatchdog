## CVE-2025-8110 - Gogs 远程代码执行 (RCE) / 符号链接绕过

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE) / 符号链接绕过

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** Gogs <= 0.13.3

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-8110是Gogs自托管Git服务中的一个高危远程代码执行（RCE）漏洞，影响Gogs 0.13.3及更早版本。该漏洞源于对符号链接的不当处理，成功绕过CVE-2024-55947的修复。经过身份验证的攻击者可通过创建恶意符号链接，并利用`PutContents` API或提交操作，欺骗Gogs将文件内容写入仓库外部任意位置（例如覆盖`~/.ssh/authorized_keys`或Git `hooks`），从而在服务器上执行任意代码。此漏洞CVSS v3.1评分为7.8，已被在野外积极利用，导致数百个Gogs实例被攻陷。

**POC有效性分析**: 提供的POC是一个Nuclei模板，旨在通过版本号检测Gogs实例是否存在漏洞。它通过发送HTTP GET请求访问`/user/login`页面，提取HTML页脚中的Gogs版本信息。随后，通过内置的DSL规则`compare_versions(version, "<= 0.13.3")`判断目标版本是否易受攻击。此POC仅用于非侵入性检测，不进行实际的漏洞利用，对于公开版本信息的Gogs实例具有高可靠性，且无副作用。

**利用步骤**: 攻击者需先登录Gogs，然后在一个仓库中构造一个指向服务器敏感文件（如SSH密钥文件或Git钩子目录）的恶意符号链接。接着，利用Gogs的API（如`PutContents`）或通过常规Git提交操作，向该符号链接写入恶意内容。Gogs服务器会被欺骗，将内容写入到符号链接指向的实际系统关键位置，例如，覆盖`authorized_keys`以实现SSH登录，或注入恶意Git `hooks`脚本以在特定Git操作时（如`git push`）执行任意命令，从而完全控制服务器。

**投毒风险分析**: 此POC的投毒风险评估为**0% (低)**。该Nuclei模板代码清晰，行为透明，仅执行一个安全的HTTP GET请求来获取版本信息。它不包含任何恶意负载、外部依赖或混淆代码，不执行文件写入、命令执行或其他入侵性操作。整个检测过程是非入侵性的，不会修改目标系统上的任何文件或配置，也不会尝试建立反向Shell连接。因此，该POC不具备投毒能力，对使用者和目标系统均无投毒风险。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
