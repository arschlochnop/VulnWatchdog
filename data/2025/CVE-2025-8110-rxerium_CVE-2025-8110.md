## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** Gogs 0.13.3 及更早版本

**利用条件:** 需要认证，远程网络访问

**POC 可用性:** 9

**POC 类型:** 概念验证 (仅版本检测)

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8110是一个影响Gogs（一款开源自托管Git服务）的严重远程代码执行（RCE）漏洞。该漏洞通过符号链接机制绕过了先前CVE-2024-55947的安全修复。攻击者可利用Gogs在处理Git仓库文件操作（特别是文件上传和在线编辑功能）时的逻辑缺陷，通过创建指向`.git`目录的恶意符号链接，进而重写文件，最终实现远程命令执行。该漏洞允许经过身份验证的攻击者在目标服务器上执行任意代码，并且已被监测到在野外被积极利用，导致超过700个公网暴露的Gogs实例遭到攻陷。

**POC有效性分析**
所提供的POC是一个基于Nuclei框架的YAML模板（`CVE-2025-8110.yaml`），其核心功能是**检测**目标Gogs实例是否运行在受影响的版本。该POC通过向Gogs服务的`/user/login`路径发送GET请求，然后利用正则表达式`Gogs Version: ([0-9.]+)`从页面页脚提取Gogs版本信息。一旦提取到版本，它会检查该版本是否等于或低于`0.13.3`。如果条件满足，POC则将目标标记为存在CVE-2025-8110漏洞。该POC的有效性在于它能准确、被动地识别出易受攻击的Gogs版本，无需进行实际的攻击尝试。这意味着它是一个**可靠的漏洞版本检测工具**。然而，需要明确的是，此POC**不包含实际的远程代码执行（RCE）利用代码**，它仅用于验证漏洞存在的先决条件（即易受攻击的版本）。因此，从实际攻击利用的角度来看，它是一个**概念验证**性质的POC，证明了漏洞的可检测性，但没有提供完整的攻击链。对于防御方而言，这是一个有价值的工具，可以用于资产自查，识别潜在的风险系统。

**利用步骤**
1.  **认证访问**: 攻击者需要首先获得Gogs实例的有效用户凭证，登录系统。这是利用此漏洞的前提条件。
2.  **构造恶意Git仓库**: 攻击者会创建一个恶意的Git仓库。在这个仓库中，攻击者将精心构造一个或多个符号链接（symbolic links）。这些符号链接会指向Gogs服务器文件系统上的敏感目标路径，例如SSH授权密钥文件（`/home/git/.ssh/authorized_keys`）、系统关键配置文件，或者Git钩子（Git hooks）文件。
3.  **上传恶意内容**: 攻击者利用Gogs的`PutContents` API来提交文件。由于CVE-2025-8110漏洞利用了Gogs对符号链接处理不当的缺陷，服务器会被欺骗，将攻击者提交的文件内容写入到符号链接所指向的**仓库外部**的任意路径。
4.  **实现RCE**: 通过覆盖服务器上的SSH密钥文件，攻击者可以直接通过SSH访问服务器；或者通过覆盖Git钩子脚本（例如`post-receive`钩子），当有新的提交被推送到仓库时，恶意脚本就会在服务器上自动执行，从而实现远程代码执行（RCE），完全控制受感染的Gogs服务器。此漏洞绕过了先前CVE-2024-55947的安全修复。

**投毒风险分析**
所提供的POC代码是一个基于Nuclei框架的YAML模板，其设计意图是进行漏洞的**版本检测**。该POC的投毒风险评估为**5%**，属于极低风险。
1.  **代码清晰度与可读性**: 该YAML模板结构清晰，逻辑简单明了。它只包含一个HTTP GET请求到`/user/login`路径，并使用一个明确的正则表达式来提取页面中的Gogs版本信息。`README.md`文件也提供了详尽的说明，包括如何安装Nuclei、如何运行POC以及预期输出。代码中没有发现任何混淆、加密或难以理解的部分。
2.  **依赖项与外部交互**: 该POC的主要依赖项是Nuclei工具本身，这是一个广泛认可和使用的开源安全扫描器。POC代码本身不包含任何外部脚本引用、恶意二进制文件或其他可疑的外部资源加载。它只与目标Gogs服务器的登录页面进行HTTP GET请求。
3.  **行为分析**: POC的行为完全符合其“版本检测”的声明。它仅执行被动的信息收集（版本号），不涉及任何对目标系统的修改、文件写入、命令执行或任何具有潜在破坏性的操作。它也不会尝试建立反向Shell、数据窃取或发起其他攻击行为。
4.  **结论**: 鉴于以上分析，该Nuclei POC是一个合法的、用于安全研究和资产清点目的的检测工具。在使用时，用户应确保从官方或可信来源获取Nuclei工具和此POC模板，以避免中间人攻击或其他供应链风险。该POC本身不构成恶意代码或投毒威胁。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
