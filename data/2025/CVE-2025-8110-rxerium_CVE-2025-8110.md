## CVE-2025-8110 - Gogs 符号链接绕过导致远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 符号链接绕过导致远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 8.7

**影响版本:** Gogs <= 0.13.3

**利用条件:** 需要身份认证，需要网络访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-8110是一个严重影响Gogs自托管Git服务的高危远程代码执行（RCE）漏洞。该漏洞的根本原因在于Gogs的`PutContents` API在处理用户上传的Git仓库内容时，未能正确地处理和验证符号链接（symlink）。攻击者可以利用这一缺陷，绕过Gogs之前针对类似问题（CVE-2024-55947）的安全修复措施。具体来说，当一名已通过身份验证的攻击者在Git仓库中创建并提交一个指向服务器文件系统上敏感位置（例如，配置文件、特定系统路径或Git Hook目录）的恶意符号链接时，Gogs服务器在处理此提交操作时，会将写入操作的目标重定向到符号链接所指向的实际文件，而非符号链接本身。这种机制允许攻击者实现任意文件写入，进而通过写入可执行文件（如Git Hook脚本）或修改关键配置，最终在目标Gogs服务器上执行任意代码，从而获得服务器的完全控制权。该漏洞被评定为高危，CVSS 4.0评分为8.7，且有明确证据表明此漏洞已在野外被积极利用，导致全球范围内大量公网暴露的Gogs实例（据称超过700个）遭到入侵。受影响的版本包括Gogs 0.13.3及更早的所有版本。

**POC有效性分析**：
所提供的POC是一个基于ProjectDiscovery Nuclei框架的检测模板（CVE-2025-8110.yaml）。该模板的核心功能是识别运行存在漏洞版本的Gogs实例。它的工作原理是向目标Gogs服务的`/user/login`路径发送一个标准的HTTP GET请求。在收到服务器的响应后，POC会使用预定义的正则表达式从页面的HTML内容中提取Gogs的版本号（通常位于页脚的"Gogs Version: X.X.X"部分）。提取到版本号后，POC会执行一个版本比较操作，判断目标Gogs实例的版本是否小于或等于`0.13.3`。如果满足这个条件，则该目标被标记为存在CVE-2025-8110漏洞。
从有效性角度来看，此POC是一个可靠的漏洞检测工具而非漏洞利用工具。它的准确性高度依赖于目标Gogs实例是否在登录页面清晰地展示版本信息，以及版本信息的格式是否符合正则表达式的匹配规则。如果Gogs管理员对登录页面进行了定制化，移除了版本信息，或者更改了其显示格式，那么该POC可能无法成功提取版本号，从而导致漏报。然而，对于大多数未经修改的标准Gogs部署，这个POC能够有效且非侵入性地识别脆弱系统。其优点在于操作简便、执行效率高，并且无需与目标系统进行复杂的交互或执行恶意载荷，因此在资产清点和风险评估阶段具有很高的实用价值。它提供了一种快速、低风险的方式来确定Gogs资产是否存在潜在风险。

**利用步骤**：
要成功利用CVE-2025-8110漏洞，攻击者需要满足以下条件并执行一系列操作：
1.  **获取认证凭证**：攻击者首先需要获取一个有效的Gogs用户账户凭证。此漏洞要求攻击者具有在Gogs实例上创建或推送代码的权限。
2.  **准备恶意Git仓库**：攻击者在本地初始化一个新的Git仓库。
3.  **创建恶意符号链接**：攻击者在本地仓库中创建一个特殊构造的符号链接。这个符号链接不是指向仓库内部的某个文件，而是指向Gogs服务器文件系统上的一个敏感路径。例如，可以指向 `/etc/passwd`、`Gogs`应用程序的配置文件（如`app.ini`），或者更关键的是，指向Gogs仓库目录下的Git Hook文件，如`.git/hooks/pre-receive`。命令示例：`ln -s /path/to/server/sensitive/file malicious_symlink_name`。
4.  **提交并推送**：攻击者将包含这个恶意符号链接的Git修改提交到本地仓库，然后将其推送到目标Gogs服务器。
5.  **Gogs处理触发漏洞**：当Gogs服务器接收并处理这个推送到仓库的请求时，由于其`PutContents` API对符号链接处理不当，服务器会错误地解析`malicious_symlink_name`。 вместо将符号链接本身存储到仓库中，它会尝试对符号链接所指向的实际文件进行操作。
6.  **实现任意文件写入与RCE**：通过巧妙地构造符号链接，攻击者可以利用这种任意文件写入的能力。例如，攻击者可以将包含恶意脚本（如反弹shell脚本）的内容写入到`pre-receive`等Git Hook文件中。一旦恶意内容被写入，后续任何推送到该仓库的操作都将触发这个恶意的Git Hook脚本，从而在Gogs服务器上以Gogs进程的权限执行攻击者指定的任意代码，实现远程代码执行。
7.  **权限维持与数据窃取**：成功执行RCE后，攻击者便可进一步在服务器上部署后门、提升权限、窃取敏感数据、植入挖矿程序或发起进一步的内网渗透攻击。

**投毒风险分析**：
所提供的CVE-2025-8110 Nuclei模板在投毒风险方面被评估为极低，接近于0%。这一结论基于对其代码结构、行为模式及外部依赖的全面分析。
首先，从**代码透明性**角度来看，该POC完全采用Nuclei模板语言（YAML格式）编写，其内容清晰、结构化且易于阅读和理解。模板中定义的HTTP请求方法、路径、正则表达式以及版本比较逻辑都一目了然，不涉及任何形式的代码混淆、加密处理或二进制内容。任何具备基本的YAML文件阅读能力和网络协议知识的安全分析人员，都能够迅速审阅其全部逻辑，从而确保没有隐藏的恶意功能。
其次，关于**外部依赖性**，该POC的运行仅依赖于ProjectDiscovery Nuclei工具本身。它不包含任何指向外部未知或可疑URL的请求，不存在从第三方服务器下载并执行额外脚本的行为，也没有引入任何非标准或非开源的库文件。所有的检测逻辑都完全内联在`CVE-2025-8110.yaml`文件中，这大大降低了引入供应链攻击或外部恶意载荷的风险。
再者，从**行为模式**来看，该POC的行为是纯粹的被动式检测。它唯一的操作是向目标Gogs服务器的`/user/login`路径发起一个标准的HTTP GET请求。此请求旨在获取页面的HTML内容以提取版本信息，它不会尝试执行任何主动的攻击行为，例如文件写入、删除、命令执行、数据库操作或权限提升。POC中没有任何用于建立反向shell连接、窃取敏感数据、植入挖矿程序、后门或者僵尸网络组件的代码。它只对响应进行分析，不修改目标系统状态，因此本质上是一个非侵入性的“指纹识别”工具。
此外，作为**安全研究规范**的一部分，Nuclei模板通常由安全社区维护，并经过广泛的审查。该模板的设计目的明确是帮助防御者快速识别其Gogs资产是否存在风险，而非作为攻击工具制造新的风险或传播恶意软件。它遵循了业界公认的防御性安全研究原则。
综上所述，无论是从代码审计的角度，还是从运行时行为的观察，该CVE-2025-8110的Nuclei POC均展现出高度的安全性。它完全符合防御性安全研究工作的要求，使用者可以放心地将其部署到自己的安全扫描和风险评估流程中，而无需担忧任何潜在的投毒风险或引入恶意代码。

**项目地址:** https://github.com/rxerium/nuclei-templates

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
