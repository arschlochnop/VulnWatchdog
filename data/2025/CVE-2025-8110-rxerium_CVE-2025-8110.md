## CVE-2025-8110 - Gogs 符号链接绕过, 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 符号链接绕过, 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** High

**CVSS评分:** 

**影响版本:** 0.13.3 and earlier

**利用条件:** 需要认证, 需要网络访问, 针对PutContents API

**POC 可用性:** 9

**POC 类型:** 概念验证 (仅检测)

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

POC有效性分析:
本POC是一个用Nuclei模板语言编写的检测脚本（CVE-2025-8110.yaml），专门用于识别存在CVE-2025-8110漏洞的Gogs实例。该漏洞描述为Gogs 0.13.3及更早版本中存在的符号链接绕过缺陷，可进一步导致远程代码执行（RCE）。该模板通过向目标Gogs服务的“/user/login”端点发送一个标准HTTP GET请求来工作。它设计用于从该页面返回的HTML响应中，使用精确的正则表达式“Gogs Version: ([0-9.]+)”提取Gogs的版本信息。随后，POC会逻辑判断提取到的版本是否小于或等于“0.13.3”。
这种基于公开版本字符串的检测方法被认为是高效且非侵入性的。其有效性在于Gogs通常会在登录页面底部显式地显示其版本信息。通过匹配响应状态码200和特定的页面标题“Sign In - Gogs: Go Git Service”，POC确保了目标是预期的Gogs服务，并减少了误报的可能性。此POC仅执行版本识别，不包含任何漏洞利用代码，因此非常适合作为组织安全扫描的初步筛选工具。

利用步骤:
检测方法:
1.  环境准备: 确保已安装Nuclei。
2.  执行扫描: 保存CVE-2025-8110.yaml模板文件。
3.  运行命令: 对单个目标，使用 “nuclei -u <target_url> -t CVE-2025-8110.yaml”。对目标列表，使用 “nuclei -l <targets.txt> -t CVE-2025-8110.yaml”。
4.  结果: 若目标Gogs版本为0.13.3或更早，Nuclei将报告漏洞存在。
漏洞利用概述:
根据CVE描述，此漏洞的实际利用需要攻击者为已认证用户。攻击者需通过Gogs的PutContents API提交一个包含恶意构造符号链接的Git commit。该符号链接会指向仓库外部的敏感文件。由于Gogs对符号链接处理不当，将导致攻击者能够覆盖服务器上的任意文件，最终通过覆盖关键系统文件实现远程代码执行（RCE）。本POC不包含利用代码，仅用于检测。

投毒风险分析:
提供的POC代码是一个结构清晰、完全透明的Nuclei模板。它采用声明式配置，定义了特定的HTTP请求、响应解析逻辑和匹配规则，而非可执行的编程脚本。这种设计从根本上降低了代码投毒的风险，因为它不包含任何编译后的二进制代码、混淆的脚本、动态加载的外部库或通常与恶意软件相关的复杂行为。
该POC的唯一网络行为是向目标Web服务器的“/user/login”路径发送一个标准的HTTP GET请求。此请求不携带任何敏感数据，不尝试修改服务器状态，不执行任何写入操作，也不触发任何远程命令执行。所有的HTTP交互都仅限于获取页面内容。数据处理完全局限于本地Nuclei引擎内，用于提取和比较版本字符串，这些操作是无害且可审计的。模板中未发现任何恶意载荷、加密字符串、恶意域名回调、“eval()”或“system()”等危险函数的使用。它也没有尝试下载或执行任何外部脚本，更没有包含任何可疑的第三方库或二进制文件。
此外，POC中提供的参考链接指向了知名的安全研究机构Wiz的官方博客文章以及开源项目Nuclei的官方GitHub仓库。Wiz因其高质量的安全研究而闻名，而Nuclei作为一个广泛采用的开源漏洞扫描工具，其社区活跃、代码透明且经过大量安全专业人员的审查。这些高可信度的来源进一步排除了POC被植入恶意内容的可能性，确保了其作为合法安全工具的地位。
综上所述，这份POC旨在提供一种安全、非侵入性的漏洞检测方法。其代码完全透明，行为可预测且仅限于信息收集。它不具备任何恶意功能或潜在的副作用。因此，该POC的投毒风险评估为0%。组织可以安全地使用此POC进行Gogs实例的漏洞状态检测，而无需担心引入额外的供应链风险或遭受恶意代码感染。

**项目地址:** N/A

**漏洞详情:** https://www.wiz.io/blog/wiz-research-gogs-cve-2025-8110-rce-exploit
