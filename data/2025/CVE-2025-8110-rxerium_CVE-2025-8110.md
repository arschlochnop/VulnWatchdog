## CVE-2025-8110 - Gogs (Go Git Service) RCE (远程代码执行)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Gogs (Go Git Service)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (预测值)

**影响版本:** <= 0.13.3

**利用条件:** 需要经过身份验证的账户权限，能够通过PutContents API提交内容或创建仓库提交。

**POC 可用性:** 4/10

**POC 类型:** 概念验证 (仅版本扫描)

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞实质上是对先前漏洞CVE-2024-55947修复补丁的绕过。在Gogs 0.13.3及更早版本中，其PutContents API在处理文件上传和写入时，未能正确校验符号链接（Symlinks）的目标路径。攻击者可以构造一个特殊的Git提交，其中包含一个指向服务器敏感位置（如.git目录或配置文件）的符号链接。由于Gogs在后续操作中未对该链接进行深度解析和限制，攻击者可以通过该链接实现文件覆盖。结合Git服务的特性，攻击者可以重写仓库的钩子脚本（Git Hooks）或Gogs的配置文件，从而在服务器上下文执行任意系统命令。目前提供的POC代码是一个基于Nuclei框架的YAML模板，其有效性仅限于“漏洞识别”而非“漏洞利用”。它通过匹配Gogs登录页面的版本号字符串来判断目标是否处于受影响版本范围（<= 0.13.3）。该POC无法直接获取权限或执行命令，属于无损检测工具。真实的利用链需要通过API构建符号链接并触发文件写入，利用门槛相对较高，需要对Git内部结构有深入理解。此外，由于该漏洞属于0-day绕过利用，公开的完整利用脚本（Exploit）较为罕见，大多以漏洞分析和防御建议为主。【利用步骤】1. 获取一个有效的Gogs用户账户。2. 构造一个包含符号链接的恶意Git仓库对象，该链接指向系统关键路径（如：ln -s /home/gogs/repository/.git/hooks/update malicious_link）。3. 通过API或Git协议提交该链接，绕过Gogs的文件名过滤器。4. 利用PutContents等功能通过该符号链接向目标路径写入恶意指令。5. 触发对应的Git操作（如Push）以执行写入的恶意钩子脚本，达成远程代码执行。【投毒风险分析】当前获取到的POC代码投毒风险极低。该YAML模板使用了标准的Nuclei DSL语法，其逻辑仅包含：访问/user/login页面、使用正则表达式提取版本号、使用compare_versions函数进行版本比对。代码中没有使用任何混淆技术，没有外部请求（除了对BaseURL的访问），也没有执行任何敏感的系统命令。该脚本由rxerium编写，遵循了公开的安全研究规范。然而，由于CVE-2025-8110属于高价值的RCE漏洞，防御者在搜索更高级的Exploit（如Python编写的自动利用脚本）时需保持警惕。攻击者可能在所谓“完整版利用工具”中加入恶意载荷，例如：1. 在Python脚本的base64加密字段中隐藏反弹Shell；2. 在安装依赖阶段通过setup.py下载恶意二进制文件；3. 将利用成功的Session或凭证回传至匿名C2服务器。鉴于该漏洞涉及底层文件操作，任何声称能自动完成“Symlink注入”的二进制程序若未提供源码，投毒风险将大幅上升。建议安全从业者在使用此类高级脚本前，必须在沙箱环境进行静态审计和流量监控。

**项目地址:** [https://github.com/rxerium/CVE-2025-8110](https://github.com/rxerium/CVE-2025-8110)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
