## CVE-2025-8110 - Gogs 符号链接绕过, 任意文件写入, 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 符号链接绕过, 任意文件写入, 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 8.7 (CVSS 4.0)

**影响版本:** 0.13.3 及更早版本

**利用条件:** 需要认证, 需要网络访问

**POC 可用性:** 4

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-8110是一个影响Gogs自托管Git服务的严重远程代码执行（RCE）漏洞。Gogs是一款流行的由Go语言编写的轻量级Git服务解决方案。此漏洞的本质是对符号链接处理不当，使得先前针对RCE漏洞CVE-2024-55947的修复被成功绕过。攻击者通过利用Gogs的PutContents API，可以创建指向敏感目标文件（如配置文件或特定系统文件）的符号链接，从而实现任意文件写入，最终在受影响的服务器上执行任意代码。该漏洞因其高危性质（CVSS 4.0评分8.7分）和在野利用的报告，已引起广泛关注，据称已有超过700个公网暴露的Gogs实例遭到入侵。

提供的POC代码是一个Nuclei检测模板（CVE-2025-8110.yaml），它旨在识别运行易受攻击版本的Gogs实例，而非直接利用该漏洞实现RCE。该模板通过向目标Gogs实例的`/user/login`路径发送GET请求，并使用正则表达式从页面底部提取Gogs版本信息。然后，它将提取到的版本与已知易受攻击的版本`0.13.3`进行比较。如果目标Gogs实例的版本等于或早于`0.13.3`，则该模板会将其标记为易受攻击。这种检测方法依赖于Gogs在登录页面公开版本号的特性，是一种被动且非侵入式的识别方式。因此，该POC在识别易受攻击系统方面具有较高的有效性和可靠性，它能够准确地判断目标是否满足漏洞版本条件。然而，需要明确的是，此POC并不能执行远程代码，也无法模拟任意文件写入的实际利用过程，它仅是一个“概念验证”或“漏洞扫描器”性质的工具，用于验证目标系统的版本是否处于已知易受攻击的范围。对于安全研究人员和防御者来说，这是一个有价值的初步筛查工具。

该漏洞的实际利用步骤通常涉及以下关键环节。首先，攻击者必须获取到目标Gogs实例的有效认证凭证，因为漏洞利用需要通过认证后的PutContents API。获得认证后，攻击者会利用PutContents API的缺陷，在Gogs存储库内创建一个恶意设计的符号链接。这个符号链接不是指向存储库内的文件或目录，而是巧妙地指向目标服务器文件系统中的敏感路径，例如Gogs的配置目录（`../conf`或`../config`）或其他可写且具有执行权限的目录。随后，攻击者会再次利用PutContents API或类似的写入操作，通过已创建的符号链接，向实际的敏感目标文件写入恶意内容。例如，攻击者可以覆盖Gogs的`app.ini`配置文件，插入恶意脚本的路径，或者直接写入一个Web Shell到公开可访问的目录中。一旦恶意内容被成功写入并触发（例如，通过Gogs服务的重启、特定Web请求或计划任务），攻击者即可在目标服务器上实现远程代码执行。整个攻击流程虽然需要认证，但一旦条件满足，其利用路径相对直接且危害巨大。

针对此特定POC的投毒风险分析，可以得出结论：风险极低。该Nuclei模板（`CVE-2025-8110.yaml`）的代码是清晰、简洁且高度透明的。它只包含一个HTTP GET请求到`/user/login`路径，用于获取Gogs版本信息，并且仅使用标准正则表达式进行版本解析和DSL规则进行版本比较。代码中没有发现任何恶意载荷、混淆技术、外部脚本引用、可疑的网络请求（除目标Gogs实例本身）或其他异常行为。`README.md`文件也清晰地解释了该模板的检测机制和运行方式。这表明该POC是出于合法的安全研究目的而创建的，旨在帮助用户识别潜在的漏洞。因此，从提供的POC代码本身来看，将其部署到安全分析环境中或用于合法的漏洞扫描是安全的，无需担心其引入任何恶意代码或执行不当操作。然而，这并不意味着所有与CVE-2025-8110相关的公共POC都同样安全；在获取任何POC代码时，始终建议进行彻底的安全审查以防范潜在的投毒风险。

**项目地址:** N/A

**漏洞详情:** https://www.wiz.io/blog/wiz-research-gogs-cve-2025-8110-rce-exploit
