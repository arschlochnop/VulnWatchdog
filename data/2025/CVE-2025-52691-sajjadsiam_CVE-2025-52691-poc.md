## CVE-2025-52691 - SmarterMail RCE (远程代码执行)

**漏洞编号:** CVE-2025-52691

**漏洞类型:** RCE (远程代码执行)

**影响应用:** SmarterMail

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (预测值)

**影响版本:** 未知 (基于搜索结果描述为高版本受影响)

**利用条件:** 无需认证，可通过网络直接访问受影响的API端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码结构非常完整且具有高度的可操作性，涵盖了漏洞扫描、自动化利用以及库集成三个维度。其核心逻辑在于利用SmarterMail在文件上传接口（如/api/upload等）存在的路径穿越漏洞，绕过预设的上传目录限制，将恶意的ASPX格式Webshell直接写入Web根目录。代码中提供的check.py能够高效识别潜在目标，而pwn.py则实现了从上传到交互式命令执行的完整路径。从安全研究角度看，该POC的有效性极高，因为它直接针对文件处理逻辑中的输入验证缺陷。利用步骤：1. 环境准备，安装requests和urllib3依赖库。2. 侦察阶段，使用check.py对目标URL进行扫描，确认是否存在CVE-2025-52691漏洞。3. 攻击阶段，执行pwn.py脚本，该脚本构造包含路径穿越字符（如../）的多部分表单数据请求，发送至受影响的API端点。4. 维持权限，成功上传ASPX脚本后，脚本通过-c参数发送指令或通过-i参数进入伪交互式Shell，实现对服务器的完全控制。 投毒风险分析：经过对提供的代码结构进行静态评估，该POC被归类为低至中等投毒风险。代码主要依赖标准的requests库进行HTTP通信，未发现明显的恶意二阶段载荷植入或敏感信息回传至第三方服务器的行为。其README中声明的‘仅用于教育与授权测试’符合正规安全研究的特征。然而，作为防御方需警惕以下几点：首先，虽然当前片段看起来清洁，但此类自动化利用工具极易被恶意攻击者重新打包，通过在exploit.py等库文件中植入混淆的eval语句或base64编码的后门实现‘黑吃黑’。其次，工具中包含的批量扫描功能（-f参数）具有明显的蠕虫化倾向，容易被用于大规模非法扫描。目前未发现该POC有代码混淆，但鉴于其高度的自动化程度，使用者在运行前应严格审计其网络请求逻辑，确保没有任何指向未知IP的非预期外连。整体来看，代码逻辑透明，符合安全研究员发布的标准POC规范，投毒风险处于受控范围。

**项目地址:** [https://github.com/yourusername/CVE-2025-52691-POC](https://www.google.com/search?q=https://github.com/yourusername/CVE-2025-52691-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-52691](https://nvd.nist.gov/vuln/detail/CVE-2025-52691)
