## CVE-2025-32463 - Sudo 本地提权(Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权(Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户访问权限；sudoers配置中允许使用-R或--chroot选项，且定义了ChrootDir指令；攻击者需控制chroot目录环境。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-32463是Linux Sudo组件中发现的一个高危本地提权漏洞，其CVSSv3评分为9.3（Critical）。该漏洞影响Sudo 1.9.17p1之前的版本，允许没有特殊权限的本地攻击者通过滥用Sudo的`-R`或`--chroot`选项来提升权限至root。漏洞的核心在于Sudo在处理chroot选项时的一个缺陷，攻击者可以联合NSS（Name Service Switch）劫持技术，欺骗Sudo加载恶意共享库，从而在Sudo尚未放弃其特权时执行任意代码。

**POC有效性分析：**
值得注意的是，提供的POC代码`Xpl0it`明确指出其目标是`CVE-2023-42456`，而非`CVE-2025-32463`。尽管CVE ID不同，但两者都利用了Sudo在使用`-R`（chroot）选项时，在动态加载NSS库方面存在的信任模型缺陷。`Xpl0it` PoC是一个文档齐全、功能完整的安全研究工具，旨在通过NSS库注入来实现权限提升。它通过控制chroot目录内的`nsswitch.conf`文件，强制Sudo在特权下降之前加载恶意共享库。该工具能够根据Sudo版本进行检测，并声称成功运行后可以获得root shell或以root权限执行指定命令。因此，尽管并非直接针对`CVE-2025-32463`，但`Xpl0it`为理解和开发`CVE-2025-32463`的利用提供了高度相关的技术洞察和实现范例。根据其自述文件，该POC对于其声明的目标CVE (`CVE-2023-42456`) 而言，是有效且功能完整的利用工具。

**利用步骤：**
1.  **本地访问：** 攻击者首先需要获得目标Linux系统的本地用户访问权限。
2.  **sudoers配置要求：** 系统上的`sudoers`文件必须包含允许目标用户使用`-R`或`--chroot`选项的条目，并且通常需要指定`ChrootDir`指令（例如 `targetuser ALL=(root) ChrootDir=* NOPASSWD: ALL`）。如果没有`ChrootDir`配置，Sudo将拒绝`-R`选项。
3.  **环境准备：** 攻击者需创建或控制一个临时的chroot目录（例如`/tmp/evil_chroot`）。
4.  **恶意文件注入：** 在该chroot目录内，攻击者会创建或修改一个恶意的`nsswitch.conf`文件，使其指向一个由攻击者控制的恶意NSS共享库（例如`libnss_exploit.so`）。该恶意库通常包含能够执行`setuid(0); setgid(0); execve("/bin/bash", ...);`等操作的代码，以获取root权限。
5.  **执行攻击：** 攻击者随后执行`sudo -R /tmp/evil_chroot /bin/bash` 或其他命令。当Sudo尝试在chroot环境中加载NSS库以解析用户或组信息时，它会在特权下降之前加载攻击者指定的恶意库。
6.  **权限提升：** 恶意库被加载并执行，从而导致攻击者成功获取root权限，通常会获得一个root shell。

**投毒风险分析：**
提供的POC代码`Xpl0it`的`README.md`文件明确声明其用途为“授权的渗透测试和教育安全研究工具”，并提供了详细的免责声明，警示未经授权的使用是非法的。根据`README`的描述，该工具旨在通过技术手段利用`sudo`的特定缺陷进行本地权限提升，没有提及任何代码混淆、调用外部恶意服务、下载未知二进制文件或包含隐藏后门等可疑行为。其核心功能是构建并利用一个本地NSS劫持机制。从防御性安全研究的角度来看，仅凭提供的`README`文件内容，可以评估该POC本身的直接投毒风险较低。它符合一个概念验证或研究工具的典型特征，旨在展示漏洞机制而非执行额外的恶意行为。然而，任何涉及运行特权代码的POC都应谨慎对待，建议在受控环境中进行测试，并始终对完整的源代码进行审查，以确保没有隐藏的恶意功能或意外的副作用。

**项目地址:** 

**漏洞详情:** https://ubuntu.com/security/CVE-2025-32463
