## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17(不含 1.9.17p1)

**利用条件:** 本地普通用户访问权限，受影响系统安装了存在缺陷的 Sudo 版本，且支持 -R/--chroot 选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC通过Dockerfile构建了一个包含受影响版本Sudo (1.9.16p2) 的受控Ubuntu环境，具有极高的重现性和有效性。技术原理上，漏洞源于Sudo在处理--chroot（或-R）选项时的逻辑缺陷。当Sudo执行chroot操作进入用户控制的目录后，在丢弃root权限之前，会根据该目录下的/etc/nsswitch.conf配置文件加载Name Service Switch (NSS) 动态库。攻击者可以在其控制的目录下伪造恶意的/etc/nsswitch.conf和对应的libnss_*.so共享库文件。由于此时Sudo尚未执行setuid(0)之外的权限降级，动态库中的构造函数（constructor）会以root权限执行。本POC脚本poc.sh自动完成了恶意库的编译、目录结构的伪造以及sudo命令的触发。测试显示，该POC能够稳定地在目标容器内产生一个UID为0的root shell。相比于传统的本地提权，此漏洞不需要用户具备任何sudoers配置条目（即即便用户没有sudo权限，只要能执行sudo程序即可利用），这极大提升了其利用价值。利用步骤：1. 在目标机器创建受控目录并模拟根目录结构；2. 放置恶意的/etc/nsswitch.conf；3. 编译并放置包含提权payload的动态库；4. 执行sudo --chroot [受控目录] 命令触发库加载；5. 获得root权限。 投毒风险分析：该POC代码结构清晰，主要由Dockerfile、README和poc.sh组成。通过对提供的片段分析，其核心逻辑是标准的本地漏洞演示，未发现混淆代码、隐藏的远程连接或敏感信息窃取行为。Dockerfile使用了官方Ubuntu镜像并从sudo.ws官网下载源码，降低了供应链污染风险。然而，由于该漏洞具有高度的通用性和危害性，任何提供此类POC的第三方仓库若被恶意篡改，可能在poc.sh中植入静默的反弹Shell或凭据记录器。当前分析的脚本专注于漏洞验证，仅在本地环境中操作，因此投毒风险评级为低（10%）。用户在非受控生产环境运行此类POC前，应重点检查poc.sh中是否存在非常规的curl/wget下载指令或向系统敏感目录（如/usr/bin/）写入持久化后门的行为。防御建议是立即将Sudo升级至1.9.17p1或更高版本，若无法升级，可考虑通过限制普通用户对sudo执行文件的访问或禁用系统的chroot调用来临时缓解风险。

**项目地址:** 内部研究环境 (基于提供的POC文本)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
