## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** Critical

**CVSS评分:** 9.3

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地低权限用户访问，无需特定的sudo规则配置

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC提供了一个完整的Docker化测试环境，通过Dockerfile构建受影响的Sudo 1.9.16p2版本，确保了漏洞复现的可靠性。其核心逻辑利用了sudo在处理-R（--chroot）参数时的设计缺陷。当sudo执行chroot操作时，它会切换根目录到攻击者控制的路径。在切换根目录后但尚未丢弃特权之前，sudo会根据/etc/nsswitch.conf配置加载NSS（Name Service Switch）动态链接库。由于攻击者拥有chroot目录的控制权，可以放置伪造的/etc/nsswitch.conf和编译好的恶意共享对象文件（libnss_*.so）。利用步骤如下：1. 创建攻击者可控的目录结构作为伪造根目录；2. 在该目录下放置恶意的/etc/nsswitch.conf，指向自定义的NSS模块；3. 编译一个含有构造函数（__attribute__((constructor))）的共享库，该函数在加载时调用setuid(0)和setgid(0)，并执行/bin/sh或反弹shell；4. 执行sudo -R [伪造目录] [任意指令]。此时，sudo会以root身份加载恶意库，触发提权。经分析，该POC逻辑清晰，直接针对Sudo核心加载逻辑，在Linux主流发行版中具有极高的利用成功率。投毒风险分析：该POC代码表现为标准的漏洞研究脚本，主要由Dockerfile、poc.sh以及恶意的C语言源码组成。代码中未发现混淆处理、未加密的远程下载Payload或可疑的二进制预编译文件。所有的编译过程（gcc）均在本地透明执行。投毒风险主要集中在poc.sh脚本中是否包含隐藏的后门逻辑，但在当前样本中，其行为仅限于在chroot环境中提权并生成Root Shell，符合防御性研究的预期。为了安全起见，建议研究人员在隔离的容器或虚拟机环境中运行此POC，并严格审查poc.sh中定义的shell指令，防止在提权成功后执行非预期的系统破坏动作。整体评估显示，该项目投毒风险极低，属于高质量的公开技术分析资料。

**项目地址:** 内部研究获取 (参考文件 /tmp/vulnwatchdog_3942bad833191274665763fa843857d2)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
