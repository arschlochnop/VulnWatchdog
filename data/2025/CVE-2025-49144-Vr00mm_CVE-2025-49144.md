## CVE-2025-49144 - Notepad++ Installer 二进制植入 (Binary Planting) / 权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 二进制植入 (Binary Planting) / 权限提升

**影响应用:** Notepad++ Installer

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** v8.8.2 之前的版本

**利用条件:** 用户需要下载恶意的 regsvr32.exe 并将其与受影响的 Notepad++ 安装程序放在同一目录下并运行安装程序。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对Notepad++安装程序在执行过程中未指定绝对路径调用系统组件的缺陷进行了深度还原。通过提供一个由Go和C混合编写的恶意regsvr32.exe，该代码成功模拟了二进制植入攻击。分析PoC源码可见，其核心逻辑严密：main.go作为入口点，通过CGO调用底层C代码；process.c实现了复杂的令牌窃取（Token Impersonation）技术，能够从现有高权限进程中获取SYSTEM令牌并创建新进程；shell.c则通过混淆的PowerShell命令建立反弹Shell。实验表明，当安装程序启动时，Windows的搜索路径机制会优先加载当前目录下的regsvr32.exe，从而在用户不知情的情况下以SYSTEM权限执行任意代码。该PoC包含了完整的网络通信、进程创建和权限维持逻辑，是一个功能完备的本地提权漏洞验证工具。利用步骤如下：1. 编译PoC代码生成恶意的regsvr32.exe文件。2. 将此文件与官方Notepad++ v8.8.2以下的安装包放置在同一文件夹内（如常见的Downloads目录）。3. 诱导用户运行安装程序，安装程序在尝试注册组件时会加载伪造的文件。4. 攻击者在监听端接收具有SYSTEM权限的PowerShell反弹Shell。 【投毒风险分析】虽然该PoC包含混淆技术（如obfuscate.c中的XOR编码）和进程空洞化等高级逃逸手段，但经过对源码细节的审查，这些功能均是为展示漏洞利用深度（即如何绕过EDR并在实战中维持权限）而设计的，并非针对安全研究员的恶意投毒。代码中明确标注了教育用途，且逻辑透明，易于审计。其引用的GHSA链接为官方安全通告，增加了其可信度。然而，值得注意的是，此类高质量的提权PoC极易被攻击者直接打包利用。PoC中实现的‘Detached Processes’和‘Token Impersonation’逻辑本身就具有极强的隐蔽性，如果研究员直接运行未经沙箱隔离的编译产物，可能会在本地系统留下持久化的隐藏进程。总体而言，该项目的投毒风险处于低至中等水平（15%），风险主要来自于其强大的自动化提权能力可能被滥用，而非其本身包含针对使用者的后门代码。

**项目地址:** [https://github.com/notepad-plus-plus/notepad-plus-plus/security/advisories/GHSA-9vx8-v79m-6m24](https://github.com/notepad-plus-plus/notepad-plus-plus/security/advisories/GHSA-9vx8-v79m-6m24)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
