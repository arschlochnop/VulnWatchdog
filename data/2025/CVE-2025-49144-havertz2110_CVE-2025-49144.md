## CVE-2025-49144 - Notepad++ 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高 (High)

**CVSS评分:** N/A (Pending NVD Enrichment)

**影响版本:** 8.8.1 及之前的版本

**利用条件:** 攻击者需诱导用户将恶意文件（regsvr32.exe）放置在与 Notepad++ 安装程序相同的目录下并运行安装程序。

**POC 可用性:** 4/10

**POC 类型:** 仅说明/概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞属于经典的‘二进制植入’（Binary Planting）或‘路径搜索序漏洞’。根据提供的POC分析资料，Notepad++ 8.8.1 安装程序在卸载旧版本 shell 扩展时，调用了 ExecWait 'regsvr32 /u /s ...'。由于未指定 regsvr32.exe 的绝对路径（如 $SYSDIR\regsvr32.exe），Windows 会按照特定的搜索顺序查找该执行文件。在典型的下载场景中，如果用户从浏览器下载安装程序到‘下载’文件夹，并被诱导在该文件夹中同时放置一个恶意的 regsvr32.exe，安装程序在运行时会优先加载当前目录下的恶意程序而非系统目录下的合法程序。由于安装程序本身通常具有管理员权限（通过 UAC 提权），因此被调用的恶意 regsvr32.exe 也会继承这些高权限。此 POC 的有效性在逻辑上是成立的，因为它利用了 Windows 操作系统底层的 API 调用搜索机制，而非 Notepad++ 本身的代码逻辑错误，属于典型的安装程序封装缺陷。其利用成功率高度依赖于文件放置位置。利用步骤：1. 攻击者创建一个恶意可执行文件并重命名为 regsvr32.exe；2. 通过社会工程学诱导目标用户下载该文件，并将其与受影响版本的 Notepad++ 安装程序放在同一文件夹中；3. 用户运行安装程序并授予管理员权限；4. 系统自动执行当前目录下的恶意 regsvr32.exe，导致恶意代码以管理员或 SYSTEM 权限执行。若要达到 SYSTEM 权限，恶意程序需包含令牌复制（Token Duplication）等进一步提权代码。 【投毒风险分析】目前公开的 GitHub 存储库 ammarm0010/CVE-2025-49144_PoC 主要表现为教育和说明性质。虽然该漏洞利用简单，但投毒风险主要集中在两个方面：第一，此类‘二进制植入’漏洞非常适合通过‘补丁包’或‘常用工具合集’进行传播。攻击者可能会在非官方的软件下载站上传打包好的 ZIP 文件，内部包含合法的安装程序和伪装成系统组件的恶意 DLL 或 EXE。第二，GitHub 上的 POC 项目可能存在被篡改的风险。分析显示目前的说明文档相对清晰，未见明显的恶意代码混淆。然而，由于此类漏洞涉及替换系统级二进制文件，防御者在测试时如果不加甄别地运行他人提供的预编译 regsvr32.exe，极易导致测试机被植入后门。建议研究人员在验证时，应自行编写简单的弹窗程序（如弹出计算器）作为替代，切勿直接运行不明来源的可执行文件。鉴于目前该漏洞的公开程度和利用门槛极低，黑产利用此漏洞重包装合法软件进行投毒的可能性较高，组织应加强对终端下载行为的监控，尤其是同一个目录下出现异常系统同名文件的情况。

**项目地址:** [https://github.com/ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
