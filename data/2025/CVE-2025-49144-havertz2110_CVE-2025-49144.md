## CVE-2025-49144 - Notepad++ 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Notepad++

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Notepad++ 8.8.1 及以下版本

**利用条件:** 攻击者需诱导受害者将恶意构造的可执行文件与Notepad++安装程序放在同一目录下并运行安装程序

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC揭示了Notepad++安装程序在执行系统命令时存在的一个典型二进制种植（Binary Planting）漏洞。具体而言，Notepad++ 8.8.1安装程序在调用regsvr32来卸载旧版本的Shell扩展（NppShell_01.dll）时，未使用绝对路径指定系统工具，仅使用了'regsvr32'字符串。由于Windows操作系统的可执行文件搜索顺序（Search Order）机制，当一个进程尝试执行不带完整路径的文件时，它首先会检查应用程序当前所在的目录。如果攻击者将一个恶意的、名为'regsvr32.exe'的文件放置在安装程序同级目录（例如常见的'Downloads'文件夹），安装程序将优先执行该恶意文件。由于安装程序通常需要通过UAC弹窗获得管理员权限运行，因此被错误加载的恶意regsvr32.exe也会继承高权限。此POC描述的利用逻辑非常清晰且符合Windows底层运行机制，验证了在安装过程中实现权限提升的可行性。在测试环境中，只要能够构造一个简单的弹窗或反弹Shell的EXE重命名为regsvr32.exe并置于同级目录，即可完成触发。该漏洞在8.8.2版本中通过引入$SYSDIR环境变量前缀指明绝对路径得到了修复。【利用步骤】1. 攻击者编写一个具有恶意功能的二进制文件（如弹出计算器或执行Shell命令）。2. 将该文件重命名为'regsvr32.exe'。3. 将恶意的regsvr32.exe与Notepad++ 8.8.1官方安装包放在同一文件夹中。4. 诱导目标用户运行Notepad++安装程序。5. 安装过程中，系统会自动执行同目录下的恶意regsvr32.exe，攻击者从而获得管理员权限。【投毒风险分析】该漏洞分析文档本身属于合法的防御性研究，风险较低。但在威胁情报层面，此类漏洞的投毒风险主要体现在以下两个方面：第一，恶意软件传播者可能会在非官方的软件下载站、论坛或云盘中，将Notepad++安装包与预置好的恶意regsvr32.exe打包提供下载。这种‘捆绑投毒’方式对普通用户极具欺骗性，因为用户运行的是真实的安装程序，只是在后台触发了攻击代码。第二，针对安全研究人员的POC投毒。虽然目前分析的代码段主要为解释性逻辑，但如果未来的POC包中包含预编译的regsvr32.exe二进制文件，该文件极易被嵌入后门或木马。防御团队在复现此漏洞时，应自行编译简单的验证代码，切勿直接运行不明来源的二进制文件。目前来看，该漏洞的公开文档逻辑透明，投毒风险受控在15%左右，属于较低水平，但需警惕社会工程学利用渠道。

**项目地址:** [https://github.com/notepad-plus-plus/notepad-plus-plus/issues](https://github.com/notepad-plus-plus/notepad-plus-plus/issues)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
