## CVE-2025-49144 - Notepad++ 本地权限提升 (LPE) / 二进制文件植入 (Binary Planting)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (LPE) / 二进制文件植入 (Binary Planting)

**影响应用:** Notepad++

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** Notepad++ 8.8.1 及其以下版本

**利用条件:** 攻击者需诱导用户将恶意 regsvr32.exe 放置在与安装包相同的目录下并执行安装程序

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (PoC)

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞的核心成因在于Notepad++ 8.8.1版本的安装程序在卸载旧版Shell扩展时，调用了regsvr32命令但未指定绝对路径。根据Windows操作系统的搜索顺序（Search Order），安装程序会优先在当前可执行文件所在的目录寻找匹配的二进制文件。POC代码通过在安装包同级目录下放置一个伪造的regsvr32.exe，利用Windows的默认搜索机制实现劫持。经分析，该POC在逻辑上是完全成立的，利用步骤清晰且符合Windows API的行为特征。由于Notepad++安装程序在运行阶段通常需要UAC授权以获取管理员权限，被劫持执行的伪造regsvr32.exe将继承安装程序的特权级别，从而实现从普通用户权限到Admin甚至SYSTEM权限的提升。此漏洞属于典型的二进制植入攻击，其有效性高度依赖于用户的操作习惯，但在特定社交工程场景下极具杀伤力。\n\n【利用步骤】1. 攻击者准备一个名为regsvr32.exe的恶意PE文件，该文件包含提权载荷或后门代码。2. 将此恶意文件重命名并分发，诱导目标用户将其与Notepad++ 8.8.1的安装包（npp.8.8.1.Installer.x64.exe）放置在同一个文件夹内，最常见的场景是浏览器的‘下载’文件夹。3. 用户双击运行Notepad++安装程序并点击‘允许’UAC弹窗。4. 安装程序执行过程中，会调用ExecWait 'regsvr32 /u /s ...'。5. 系统未在PATH之前找到绝对路径，转而加载并运行目录下的恶意regsvr32.exe。6. 恶意载荷以管理员权限执行，完成权限提升。\n\n【投毒风险分析】在针对此类提权漏洞的威胁情报监测中，投毒风险主要体现为‘双重钓鱼’。分析发现，虽然当前提供的README说明文档是防御性的，但在公开社区流传的相关POC脚本中，存在恶意研究者将植入物（regsvr32.exe）替换为真实后门程序的风险。投毒者往往通过GitHub或技术论坛发布所谓的‘一键利用工具’，这些工具中包含的二进制文件可能经过混淆处理，旨在反向控制尝试复现漏洞的安全人员。由于该漏洞本身就需要执行一个外部二进制文件，防御者很难在第一时间辨别该文件是单纯的PoC弹窗程序还是具备持久化能力的木马。目前评估其投毒风险为15%，主要风险点在于伪造的regsvr32.exe可能包含恶意Shellcode，建议安全人员在完全隔离的虚拟机环境中进行静态脱壳和动态调试，切勿在宿主机直接运行任何随附的EXE文件。

**项目地址:** [https://github.com/notepad-plus-plus/notepad-plus-plus/issues](https://github.com/notepad-plus-plus/notepad-plus-plus/issues)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
