## CVE-2025-49144 - Notepad++ 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高危

**CVSS评分:** N/A (Awaiting Analysis)

**影响版本:** v8.8.1 及更早版本

**利用条件:** 需要用户交互，攻击者需通过社会工程学或点击劫持诱使用户将恶意文件和安装程序下载到同一目录，并运行安装程序。

**POC 可用性:** 8/10

**POC 类型:** 概念验证/仅说明

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-49144 是一个存在于 Notepad++ v8.8.1 及更早版本安装程序中的本地权限提升漏洞。该漏洞的根本原因是“不安全的执行文件搜索路径”（binary planting），即安装程序在调用 `regsvr32` 命令时没有使用其绝对路径。根据 Windows 的默认搜索顺序，当未指定可执行文件的完整路径时，系统会优先在当前应用程序（即安装程序）所在的目录中查找该文件，而非直接从系统目录加载。这为攻击者创造了可乘之机。

**POC有效性分析**：
所提供的POC文档（`README.md`）对该漏洞进行了非常详细和清晰的分析，准确揭示了其核心机制。文档明确指出，安装程序执行了 `ExecWait 'regsvr32 /u /s "$INSTDIR\NppShell_01.dll"'`，而非更安全的 `ExecWait '$SYSDIR\regsvr32.exe /u /s "$INSTDIR\NppShell_01.dll"'`。这使得攻击者可以通过在安装程序所在的目录中放置一个精心构造的恶意 `regsvr32.exe` 文件来劫持执行流程。由于安装程序通常在用户接受UAC提示后以高权限运行，因此恶意 `regsvr32.exe` 也会继承这些高权限，从而实现本地权限提升。POC详细解释了Windows的搜索路径优先级，以及恶意文件被调用的完整流程。该分析内容完整且准确，为理解和复现漏洞提供了坚实的基础，因此POC在概念验证和指导方面具有很高的有效性。

**利用步骤**：
1. **制作恶意载荷**：攻击者首先需要制作一个恶意的 `regsvr32.exe` 可执行文件。这个文件可以包含攻击者希望以高权限执行的任意代码，例如用于获取 SYSTEM 权限的Token复制工具或反向 Shell。
2. **诱导文件放置**：攻击者通过社会工程学手段（如钓鱼邮件、虚假软件更新提示）或点击劫持等方式，诱使用户下载 Notepad++ v8.8.1（或更早版本）的合法安装程序，并将攻击者制作的恶意 `regsvr32.exe` 文件放置在与安装程序相同的目录下（例如，用户的“下载”目录）。
3. **用户执行安装**：用户双击运行 Notepad++ v8.8.1 安装程序。在启动时，系统会提示用户接受用户账户控制（UAC），用户同意后，安装程序将以管理员权限运行。
4. **触发漏洞**：在安装程序执行过程中，它会尝试调用 `regsvr32` 命令来注销旧的 shell 扩展。由于安装程序未指定 `regsvr32` 的绝对路径，Windows 将根据其搜索顺序，优先在安装程序所在的目录中查找并执行攻击者预先放置的恶意 `regsvr32.exe`。
5. **权限提升**：恶意 `regsvr32.exe` 将在与安装程序相同的（提升的）权限下执行。如果恶意载荷设计得当，它可以进一步将权限提升到 `NT AUTHORITY\SYSTEM`，从而使攻击者获得目标机器的完全控制权。

**投毒风险分析**：
所提供的POC是一个Markdown格式的说明文档，不包含任何可执行代码、脚本、外部链接或动态加载组件。它仅仅是关于漏洞原理、利用方法和复现步骤的纯文本描述。因此，就这个特定的POC文档本身而言，其“投毒风险”评估为0%。它不会在执行时引入恶意代码，也不会尝试连接到外部可疑资源。用户可以安全地查阅和学习这个文档，而无需担心直接被其感染。

然而，尽管POC文档本身无害，但它提供了详细的攻击指导，这使得任何具备一定技术知识的攻击者都可以根据文档内容来构建实际的恶意载荷。因此，从广义的威胁情报角度来看，虽然POC本身无毒，但其披露的信息具有指导恶意攻击的潜力。组织应关注此类漏洞知识的传播，并采取相应的防御措施，如：及时更新软件（Notepad++ v8.8.2 及更高版本已修复此漏洞）、实施应用程序白名单策略以防止未经授权的可执行文件运行、加强用户安全意识培训以防范社会工程学攻击，以及部署先进的端点检测与响应（EDR）解决方案来识别并阻止异常的进程行为和权限提升尝试。防御的重点在于对基于此漏洞构建的实际攻击载荷及其行为的检测和阻止，而不是POC文档本身。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
