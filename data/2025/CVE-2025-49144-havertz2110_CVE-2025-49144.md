## CVE-2025-49144 - Notepad++ 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高 (High)

**CVSS评分:** Not available in provided data

**影响版本:** 8.8.1

**利用条件:** 需要本地访问或用户交互 (如执行安装程序并接受UAC)，攻击者需将恶意文件放置在安装程序同目录下。

**POC 可用性:** 9/10

**POC 类型:** 概念验证 (Conceptual Proof of Concept)

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-49144是一个影响Notepad++安装程序版本8.8.1的本地权限提升（LPE）漏洞。该漏洞源于一个“不受控可执行文件搜索路径”或“二进制植入”缺陷。具体来说，安装程序在调用`regsvr32`时未指定其绝对路径，这使其容易受到恶意文件注入的影响。攻击者可以利用此漏洞以提升的权限执行任意代码，可能获得`NT AUTHORITY\SYSTEM`的完全系统控制权，对用户系统构成严重威胁，尤其是在Notepad++ 8.8.1被安装或重新安装时。

**POC有效性分析**

所提供的POC是一个高度有效且详细的`README.md`文档。它彻底解释了漏洞的底层机制，包括Windows可执行文件搜索顺序以及安装程序所做的特定`ExecWait`调用。它清晰地阐明了如何在Notepad++安装程序所在的同一目录下放置一个恶意的`regsvr32.exe`文件来劫持执行流程。虽然该文档不包含可执行的有效载荷，但其全面的解释为任何熟练的个人开发功能齐全的漏洞利用提供了极好的指导。分析涵盖了核心执行流程、UAC的作用，甚至暗示了如何通过令牌复制实现`SYSTEM`权限。因此，该POC在概念上非常完整和具有指导性。

**利用步骤**

1.  **制作恶意载荷**：攻击者首先开发一个恶意可执行文件（例如，反向Shell、恶意软件投递器或用于`SYSTEM`令牌复制的工具），并将其重命名为`regsvr32.exe`。
2.  **放置文件**：攻击者随后将此制作的`regsvr32.exe`文件放置在合法的Notepad++ 8.8.1安装程序所在的同一目录中（例如，`Downloads`文件夹或一个为钓鱼攻击准备的目录）。
3.  **用户交互**：受害者被诱导（例如，通过钓鱼攻击、社会工程）从该受感染的目录下载并执行Notepad++ 8.8.1安装程序。
4.  **权限提升**：在安装过程中，Notepad++安装程序尝试通过调用`regsvr32 /u /s "$INSTDIR\NppShell_01.dll"`来注销旧的Shell扩展。由于安装程序没有为`regsvr32`使用绝对路径，Windows的搜索顺序会优先在当前目录（安装程序运行的位置）中找到`regsvr32.exe`。
5.  **恶意执行**：因此，攻击者的恶意`regsvr32.exe`被执行。由于Notepad++安装程序通常需要提升的权限（通过UAC提示），恶意的`regsvr32.exe`也继承了这些提升的权限，允许它以管理员甚至`NT AUTHORITY\SYSTEM`权限运行，具体取决于载荷的设计。

**投毒风险分析**

所提供的POC数据仅包含一个`README.md`文件。此文件是对CVE的文本解释和分析，不包含任何可执行代码、脚本、二进制文件或可能被篡改或固有地携带恶意软件的外部依赖项。文档明确描述了创建和部署恶意`regsvr32.exe`的*概念*，但并未提供此类文件。因此，检查此特定的`README.md`文件是否存在潜在的“投毒”风险，结果显示为**0%风险**。文档本身是无害的，纯粹用于信息和防御性安全研究目的。任何风险都将源于攻击者使用自己的恶意载荷*实现*所描述的漏洞利用，而不是来自此处提供的教育材料。防御者可以安全地分析此`README.md`文件，而不必担心直接受到损害。

**项目地址:** Not available in provided data

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
