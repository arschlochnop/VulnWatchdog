## CVE-2025-49144 - Notepad++ 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** 8.8.1 及更早版本

**利用条件:** 攻击者需诱导用户将恶意二进制文件放置在与Notepad++安装程序相同的目录下（如Downloads文件夹）并运行安装程序。

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (PoC)

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞属于典型的二进制植入（Binary Planting）或不受控的执行文件搜索路径（Uncontrolled Executable Search Path）漏洞。经过对POC代码和技术文档的详细分析，该漏洞的有效性极高。漏洞的核心在于Notepad++ 8.8.1及之前版本的安装程序（NSIS脚本编写）在执行清理或注册操作时，调用了系统命令`regsvr32`但未指定其绝对路径。Windows操作系统的搜索顺序规定，当进程尝试加载没有完整路径的可执行文件时，会首先检查该进程启动所在的目录。这意味着如果攻击者预先在下载目录中放置了一个名为`regsvr32.exe`的恶意文件，当用户在同一目录下运行Notepad++安装程序时，安装程序会错误地以其提升后的管理员权限启动该恶意文件。POC代码清晰地展示了这种劫持逻辑：通过社会工程学手段利用用户的‘下载文件夹’作为攻击平面。该利用方式稳定，不依赖于复杂的堆栈溢出或内存损坏，因此在特定场景下的成功率非常高。

【利用步骤】1. 攻击者编写一个具有恶意功能的DLL，并将其封装在一个伪造成`regsvr32.exe`的可执行文件中。2. 攻击者通过钓鱼网站、社交工程或水坑攻击，诱导目标用户下载该恶意文件到特定的本地目录（通常是Downloads目录）。3. 诱导用户同时下载Notepad++ 8.8.1或更早版本的官方安装程序到同一目录下。4. 用户双击运行Notepad++安装程序，系统触发UAC弹窗，用户授权后，安装程序以提升的权限运行。5. 在安装流程中，安装程序执行到卸载旧版本Shell扩展的步骤，通过`ExecWait`调用不带路径的`regsvr32`。6. Windows按照搜索顺序优先在当前目录找到了攻击者的恶意`regsvr32.exe`并执行。7. 恶意代码继承了安装程序的Elevated权限（通常是Admin），如果利用了Token复制技术，甚至可以进一步获取SYSTEM权限，实现对目标主机的完全控制。

【投毒风险分析】针对该漏洞的GitHub项目及相关代码仓库存在中低度的投毒风险。由于该漏洞的利用高度依赖于本地文件布局，许多PoC项目可能会提供预编译的二进制文件（如恶意`regsvr32.exe`示例）。安全研究员在下载此类仓库时应保持高度警惕，因为预编译的二进制文件极易混入真实的后门或远控木马（RAT）。分析发现，目前的公开PoC主要侧重于教育和防御验证，代码逻辑相对透明，直接在README中解释了利用原理，这降低了恶意投毒的可能性。然而，考虑到权限提升漏洞的吸引力，不排除攻击者会在第三方分发渠道发布包含恶意Shellcode的‘一键利用脚本’。建议防御者在测试时，务必自行编写或从源码编译测试Payload，避免直接运行任何来源不明的exe文件。此外，由于此漏洞涉及安装目录劫持，任何声称‘自动修复’或‘自动验证’的脚本如果要求管理员权限运行，应被视为高风险投毒信号。防御团队应重点关注代码中是否存在Base64加密的Payload或非标准的网络外连请求。

**项目地址:** [https://github.com/ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
