## CVE-2025-49144 - Notepad++ 权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危

**CVSS评分:** N/A (Awaiting Analysis)

**影响版本:** 8.8.1及更早版本

**利用条件:** 需要用户交互 (社会工程学/点击劫持), 攻击者需诱导用户下载恶意文件到安装目录, 需要接受UAC提示。

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

Notepad++安装程序8.8.1及更早版本存在一个严重的本地权限提升漏洞（CVE-2025-49144），该漏洞源于不安全的执行文件搜索路径（binary planting）。在安装过程中，安装程序会调用 `regsvr32` 来卸载旧的Shell扩展，但并未指定 `regsvr32` 的绝对路径。根据Windows的执行文件搜索顺序，如果当前目录中存在一个名为 `regsvr32.exe` 的可执行文件，系统会优先执行它，而非 `%SystemRoot%\System32` 目录下的合法 `regsvr32.exe`。攻击者可以利用社会工程学或点击劫持等手段，诱导受害者将恶意的 `regsvr32.exe` 和合法的Notepad++安装程序下载到同一目录。当受害者运行安装程序并接受用户账户控制（UAC）提示时，恶意的 `regsvr32.exe` 将被以提升的权限（管理员或SYSTEM权限）执行，从而使攻击者获得目标机器的完全控制权。该漏洞已在Notepad++ 8.8.2版本中通过指定 `regsvr32` 的绝对路径（即从 `system dir` 调用）得到修复。

**POC有效性分析:**
所提供的POC代码实际上是一个详细的 `README.md` 文档，它对漏洞进行了深入的分析和概念验证。文档清晰地阐述了漏洞的根源——不安全的执行文件搜索路径，并详细解释了Windows的执行文件搜索顺序以及攻击者如何利用这一机制。尽管该POC没有直接提供恶意的 `regsvr32.exe` 可执行文件，但它详细描述了攻击者如何构造并植入该文件，以及攻击的整个流程，甚至提及了通过令牌复制（token duplication）获取 `NT AUTHORITY\SYSTEM` 权限的方法。这种高度详细的分析和利用步骤说明，使得安全研究人员可以轻松理解并复现该漏洞，从而构建一个功能完整的利用程序。因此，这个POC在概念验证和指导复现方面具有极高的有效性。

**利用步骤:**
1.  **准备恶意载荷:** 攻击者首先需要创建一个恶意的 `regsvr32.exe` 可执行文件，该文件包含攻击者期望以高权限执行的恶意代码（例如，反向Shell或持久化机制）。
2.  **社会工程学/点击劫持:** 攻击者通过社会工程学手段（如钓鱼邮件、恶意网站诱导下载）或点击劫持技术，诱导受害者下载该恶意的 `regsvr32.exe` 以及合法的Notepad++ 8.8.1安装程序到同一个目录（例如 `Downloads` 文件夹）。
3.  **用户执行:** 受害者双击运行Notepad++ 8.8.1安装程序。
4.  **UAC提示:** 操作系统将弹出用户账户控制（UAC）提示，要求用户确认以管理员权限运行安装程序。受害者接受此提示。
5.  **权限提升:** 在安装程序的执行过程中，当其尝试卸载旧的Shell扩展并调用 `regsvr32` 时，Windows的执行文件搜索顺序将优先在当前目录中找到并执行攻击者植入的恶意 `regsvr32.exe`。
6.  **获得控制权:** 恶意的 `regsvr32.exe` 以Notepad++安装程序相同的（已提升的）权限执行，攻击者从而获得目标机器的完全控制权，可以是管理员权限，如果恶意载荷进一步执行了令牌复制等操作，甚至可以获得 `NT AUTHORITY\SYSTEM` 的最高权限。

**投毒风险分析:**
所提供的“POC代码”实际上是一个名为 `README.md` 的纯文本文件。该文件旨在详细描述CVE-2025-49144漏洞的原理、利用方式以及修复方法。作为一个文档文件，它不包含任何可执行代码、脚本、宏或外部链接。因此，从这个特定的 `README.md` 文件本身来看，其投毒风险为0%。它不会自动执行任何操作，也不会下载任何外部内容，更不会包含恶意载荷。用户仅仅阅读此文档不会导致系统被感染或受到损害。任何所谓的“恶意行为”都是该文档所 *描述* 的攻击手段，而非文档本身所 *执行* 的。因此，对于分析的这个 `README.md` 文件，可以安全地进行审查和使用，无需担心其自带的投毒风险。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
