## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34.2 之前的版本

**利用条件:** 本地运行的 Linux 容器权限；Docker Engine API 未授权暴露在默认子网（192.168.65.7:2375）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2025-9074漏洞提供了非常直观且功能完整的验证逻辑。漏洞的核心在于Docker Desktop在Windows/macOS环境下，其内部Linux虚拟机（用于运行容器）与宿主机通信的子网配置不当。默认情况下，Docker Engine API在192.168.65.7的2375端口上监听，且没有启用TLS认证。POC代码通过在容器内直接向该固定IP发送HTTP请求，利用了Docker API的远程管理特性。它不通过常规的Docker命令，而是使用Python的requests库直接操作Restful API。其核心逻辑是通过API创建一个新的容器，并在创建配置中加入HostConfig。在该配置中，关键点在于Bind挂载：它尝试将Linux VM视图下的宿主机挂载点（如/mnt/host/c，这在Docker Desktop架构中通常代表宿主机的C盘）映射到新容器的/host_root目录下。通过这种方式，攻击者可以突破当前容器的隔离限制，获得对宿主机文件系统的写权限。该POC不仅验证了连接性，还通过实际创建文件的操作证明了逃逸的可行性，代码结构清晰，参数化程度高，具有极高的实战参考价值和复现成功率。利用步骤：1. 在受影响的Docker Desktop环境中启动一个基础容器（如Alpine或Python）。2. 在容器内通过pip安装requests库。3. 运行POC脚本，脚本会自动探测192.168.65.7:2375的可用性。4. 脚本调用API创建新容器，执行命令'echo pwned > /host_root/pwn.txt'，其中/host_root关联至宿主机C盘。5. 脚本启动该新容器，触发文件写入。6. 在宿主机检查C:\pwn.txt文件是否存在以验证逃逸。投毒风险分析：该POC代码表现出较低的投毒风险。首先，代码逻辑完全透明，使用了标准的Python库（requests和argparse），没有任何混淆或加密处理。代码中明确标识了默认的目标IP和端口，且操作行为（如创建文件）属于典型的漏洞验证范畴。其次，脚本提供的清理逻辑（虽然截断但在README中有提及）显示其设计初衷是可控的。风险主要集中在两点：一是用户在使用pip安装依赖时可能由于环境配置不当引入不可靠的源，二是脚本本身如果被植入恶意远程连接指令，由于其需要网络访问权限，容易被二次修改为反弹Shell。然而，从提供的代码段看，并没有发现任何隐藏的外部C2连接、恶意Base64编码或对敏感系统信息（如环境变量、浏览器Cookie）的窃取行为。代码中的'pwn'字样仅作为漏洞成功的标识，不具备自我传播或持久化能力。整体而言，该POC属于高质量、低风险的安全研究脚本，适合防御性团队进行闭环测试，但在生产环境执行前仍建议在审计过的离线镜像中运行，以防范潜在的供应链污染风险。

**项目地址:** /tmp/vulnwatchdog_0f25496b8f99f7fa78ac0fbdbc6eda5c/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
