## CVE-2025-9074 - Docker Desktop 容器逃逸/未授权访问/特权升级

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问/特权升级

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows 和 macOS < 4.44.3

**利用条件:** 需要本地运行的Linux容器；Docker Engine API在默认子网(192.168.65.7:2375)上以HTTP方式暴露，无TLS；不依赖挂载Docker socket；不依赖“Expose daemon”设置。

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074 是一个影响 Docker Desktop（Windows 和 macOS 版本）的严重漏洞，允许本地运行的 Linux 容器绕过隔离机制，通过默认子网 `192.168.65.7:2375` 直接访问 Docker Engine API。该漏洞的核心在于 Docker Engine API 以 HTTP 明文形式暴露给容器，并且不依赖于挂载 Docker socket 或“Expose daemon”设置。此 PoC 代码（`cve_2025_9074_poc.py`）完美地验证了这一漏洞的有效性。
PoC 的工作原理是：它首先尝试连接到预设的 Docker Engine API 地址（默认为 `http://192.168.65.7:2375`）。通过向 Docker Engine API 发送请求，它创建一个新的短生命周期容器。在创建容器时，PoC 会精心构造一个 `bind mount`。具体来说，它将 Windows 主机文件系统的 `C:\` 驱动器（在 Linux VM 中表现为 `/mnt/host/c`）绑定挂载到新创建容器内部的 `/host_root` 路径。容器启动后，PoC 在容器内执行一个简单命令：`sh -c 'echo pwned_by_CVE_2025_9074 > /host_root/pwn.txt'`。这个命令的作用是在容器内 `/host_root` 路径下创建一个名为 `pwn.txt` 的文件，并将字符串 `pwned_by_CVE_2025_9074` 写入其中。由于 `/host_root` 实际上是主机 `C:\` 驱动器的挂载点，因此这个操作最终会在 Windows 主机上创建 `C:\pwn.txt` 文件。PoC 运行完成后，会尝试清理生成的容器。这个过程清晰地演示了攻击者如何从一个受控的容器内部，利用暴露的 Docker Engine API，实现对主机文件系统的任意文件写入，从而达到容器逃逸和主机控制的目的。PoC 提供了详细的命令行参数，允许用户自定义目标引擎地址、端口、容器镜像、主机路径、挂载点和输出文件名，这进一步增强了其可用性和验证能力。在易受攻击的系统上，执行 PoC 后，Windows 主机上 `C:\pwn.txt` 文件的出现，是漏洞成功利用的直接证据。
攻击者只需在一个已在目标 Docker Desktop 主机上运行的 Linux 容器内部执行以下操作：1. **安装依赖：** 确保容器内安装了 Python 3.8+ 和 `requests` 库。可以通过运行 `pip install --no-input requests` 来安装。2. **获取 PoC：** 将 `cve_2025_9074_poc.py` 脚本传输到容器内部。3. **运行 PoC：** 执行脚本以利用漏洞。默认运行方式：`python3 cve_2025_9074_poc.py`。自定义选项（可选）：可以通过命令行参数定制攻击，例如 `--host <IP>`、`--port <PORT>`、`--image <IMAGE>`、`--host-path <PATH>`、`--mount-path <PATH>`、`--outfile <FILENAME>`。4. **验证：** 在主机上检查 `C:\pwn.txt` 文件是否存在及其内容，以确认攻击是否成功。该文件应包含 `pwned_by_CVE_2025_9074`。
对提供的 `cve_2025_9074_poc.py` 代码进行分析，该 PoC 的投毒风险被评估为 **低风险 (10%)**。主要原因如下：1. **代码清晰易读：** PoC 代码是用 Python 编写的，结构清晰，逻辑简单。它使用了标准的 `requests` 库进行 HTTP 通信，并直接调用 Docker Engine API 创建容器、绑定挂载和执行命令。所有操作都直观可见，没有经过混淆处理。2. **功能专一明确：** 脚本的唯一目的是验证 CVE-2025-9074 漏洞的存在，即通过容器逃逸在主机上写入一个特定文件 (`C:\pwn.txt`)。它不包含任何额外的、不相关的功能，也没有尝试执行其他恶意操作。3. **无外部依赖加载：** PoC 不会从外部下载或加载任何脚本或二进制文件。除了 `requests` 库（一个广泛使用的、受信任的第三方库）之外，没有其他非标准或可疑的依赖。4. **无混淆或加密：** 代码中没有发现任何代码混淆、加密或尝试隐藏真实意图的技术。参数和函数调用都直接明了。5. **无网络回调或数据外泄：** 脚本没有设计任何向外部服务器进行回调、发送敏感数据或建立持久性后门的行为。它只与本地 Docker Engine API 进行通信。综合来看，该 PoC 代码是用于教育和授权测试目的的合法安全研究工具，专注于漏洞验证。因此，将其用于测试目的时，投毒风险极低。然而，任何 PoC 都应在受控环境中运行，并始终对代码进行审查，以确保其安全性和符合组织政策。

**项目地址:** 

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
