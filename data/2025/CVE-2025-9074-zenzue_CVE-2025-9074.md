## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问 (Container-to-Host 文件写入)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问 (Container-to-Host 文件写入)

**影响应用:** Docker Desktop

**危害等级:** 高

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS < 4.44.3 (修复日期: 2025年8月20日)

**利用条件:** 本地容器环境，恶意容器可访问宿主机上暴露的Docker Engine API (默认地址: http://192.168.65.7:2375，HTTP无TLS)，无需认证。或通过具备SSRF能力的宿主机服务间接利用。

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是Docker Desktop（Windows和macOS版）中的一个容器越权访问/逃逸漏洞，由Felix Boulet发现，CVSS评分为9.3（高危）。该漏洞的根源在于，受影响版本的Docker Desktop会将Docker Engine的HTTP API（默认地址`http://192.168.65.7:2375`）意外地暴露给运行在同一宿主机上的Linux容器。这允许恶意容器无需认证即可直接访问和操控宿主机的Docker Engine，从而突破容器隔离，实现对宿主机的控制。攻击者通过本地容器或具备SSRF能力的宿主机服务即可利用。

POC有效性分析：
POC代码`cve_2025_9074_poc.py`是一个Python脚本，使用`requests`库与暴露的Docker Engine API交互。它通过API调用创建一个新的容器，并巧妙地配置一个“绑定挂载”，将宿主机C盘（在Linux VM中为`/mnt/host/c`）映射到容器内部的`/host_root`目录。随后，该容器执行命令，在宿主机C盘根目录创建`pwn.txt`文件，并写入“`pwned_by_CVE_2025_9074`”文本。此POC功能完整，代码清晰，无需复杂配置，在受漏洞影响的环境下能稳定复现并成功在宿主机上创建文件，直观证明了漏洞的利用可行性与容器逃逸能力。其POC质量评分为9分。

利用步骤：
利用该漏洞，攻击者需拥有目标宿主机上一个恶意Linux容器的访问权限。具体步骤如下：
1.  确保Docker Desktop版本低于4.44.3。
2.  在恶意容器内部安装Python `requests`库：`pip install --no-input requests`。
3.  运行POC脚本：`python3 cve_2025_9074_poc.py`。
成功利用后，宿主机C盘根目录将出现`pwn.txt`文件。POC支持自定义参数，如`--outfile test.txt`或`--host-path /mnt/host/d`，允许灵活地修改写入文件或目标路径，从而可能导致植入后门、修改系统配置等更严重后果。

投毒风险分析：
该POC项目在`README.md`中明确声明为“概念验证”和“教育/授权测试专用”，并附有明确的警告信息，强调其合法用途。POC脚本`cve_2025_9074_poc.py`基于标准Python `requests`库实现，代码结构清晰，逻辑透明，未发现混淆、恶意外部依赖、非标准库调用或与外部服务器进行可疑通信的行为（除了与本地Docker Engine API）。其唯一目的是演示容器逃逸机制和文件写入能力。因此，此POC代码本身携带恶意负载或执行隐蔽恶意操作的风险极低，可判定为低投毒风险。在使用时，仍建议从可信来源获取并在隔离环境中进行测试。组织在内部测试中应遵循严格的安全规范，以防范潜在的误用风险。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
