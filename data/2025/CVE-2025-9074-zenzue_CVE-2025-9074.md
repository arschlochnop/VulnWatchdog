## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** 具体修复前的所有版本，建议更新至2025年8月后发布的最新版

**利用条件:** 本地运行的Linux容器、能够访问默认子网(192.168.65.7)

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞的核心在于Docker Desktop的隔离机制不完善，导致宿主机的Docker Engine API接口（默认监听在192.168.65.7:2375）在特定网络配置下对容器内部暴露。此POC通过Python脚本在容器内发起HTTP请求。首先，它使用/_ping接口验证API的可达性。一旦确认API未授权可访问，POC会通过API构造一个特殊的容器创建请求。该请求的关键在于使用了Docker的bind mount（绑定挂载）功能。由于Docker Desktop在Windows上运行于轻量级Linux虚拟机（如WSL2）中，宿主机的磁盘通常挂载在虚拟机的/mnt/host/c下。POC通过挂载宿主机的C盘根目录到新容器的目录中，从而获得对宿主机文件系统的写权限。该POC逻辑清晰，利用了Docker Engine API的原生功能，不涉及复杂的内存破坏，因此在环境满足（API暴露）的情况下成功率极高。利用步骤：1. 在受影响的Docker Desktop环境中启动一个普通的Linux容器。2. 在容器内安装Python及requests库。3. 运行POC脚本，脚本将向192.168.65.7:2375发送POST请求创建新容器。4. 新容器被配置为挂载宿主机路径（如/mnt/host/c）至容器内。5. 启动该新容器并在挂载点写入文件（如pwn.txt），从而实现从容器到宿主机的逃逸与文件写入。投毒风险分析：该POC代码本身表现为标准的防御性安全研究脚本，结构透明，使用了常见的requests库，未发现经过混淆的Base64字符、eval()调用或异常的远程二进制文件下载行为。脚本中定义的192.168.65.7为Docker Desktop内部预留的固定IP，不属于外部恶意地址。然而，从威胁情报角度看，此类POC存在被二次打包投毒的潜在风险。攻击者可能在README中诱导用户执行'pip install'命令，若修改依赖项为恶意库（如Typosquatting攻击），或者在POC脚本末尾添加静默反弹Shell的代码，则会对安全研究员的测试环境造成威胁。当前POC版本侧重于本地文件写入验证，其行为属于安全研究范畴，但用户在使用时仍需注意检查脚本中是否有非预期的网络外联或对敏感系统路径（如System32或启动项）的非授权写入尝试。

**项目地址:** n/a

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
