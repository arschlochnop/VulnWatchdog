## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < v4.44.3

**利用条件:** 本地运行的恶意Linux容器，且Docker Engine API在默认子网192.168.65.7:2375上暴露且未开启身份验证

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Docker Desktop在Windows和macOS平台上默认配置的安全性缺陷。在受影响的版本中，Docker Engine API（默认监听在192.168.65.7:2375）对内部容器网络开放且缺乏身份验证机制。本POC展示了攻击者如何利用此暴露的接口，通过发送API请求，指示Docker Engine创建一个新的恶意容器。该恶意容器的关键在于使用了'bind mount'（绑定挂载）功能，将宿主机的物理磁盘路径（如Windows的C:\盘在Linux VM中的映射路径/mnt/host/c）挂载到容器内部的/host_root目录。一旦挂载成功，攻击者便可以在容器内以root权限直接读写宿主机上的任意文件。利用步骤：1. 在受害者的Docker Desktop环境中运行一个基础镜像容器（如alpine）。2. 检查网络连通性，确认是否能访问192.168.65.7:2375。3. 运行Python POC脚本，脚本将向Docker API发送POST请求创建新容器，并在HostConfig中设置Binds参数为['/mnt/host/c:/host_root']。4. 启动该新容器并在其中执行shell指令，在挂载的路径下写入'pwn.txt'。5. 验证宿主机C盘根目录是否存在该文件。此路径不仅限于写入文件，攻击者还可以通过修改宿主机的计划任务、启动项或敏感配置文件实现持久化控制或提权，漏洞危害极大。投毒风险分析：针对该POC代码本身，其风险较低。代码采用Python编写，使用了标准的requests库，未发现明显的代码混淆、二阶段Payload下载或针对分析者主机的反向shell特征。POC的核心行为——向192.168.65.7发送API调用——是针对漏洞靶标的直接验证逻辑，而非针对运行环境的攻击。然而，该漏洞的特性使得投毒者极易伪装恶意镜像或在GitHub上发布虚假的自动化修复/检测脚本。在实际环境中，若下载并运行了未经审计的第三方提供的自动化POC，存在以下风险：1. 脚本可能在后台偷偷向攻击者的C2服务器回传当前机器的Docker配置信息。2. 脚本可能在尝试写入pwn.txt的同时，悄悄在宿主机的启动目录植入真正的木马程序。3. 脚本可能利用Docker API的其他功能静默拉取并运行具有挖矿插件的隐藏容器。因此，尽管本POC逻辑清晰且无明显恶意行为，但在使用类似工具时应严格审计API请求的目标地址和挂载路径，确保操作在隔离的实验室环境中进行。

**项目地址:** [https://github.com/w01f/CVE-2025-9074-PoC](https://www.google.com/search?q=https://github.com/w01f/CVE-2025-9074-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
