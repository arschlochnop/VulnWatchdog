## CVE-2025-9074 - Docker Desktop for Windows 容器逃逸/主机文件写入 (Container-to-Host File Write)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/主机文件写入 (Container-to-Host File Write)

**影响应用:** Docker Desktop for Windows

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 某些版本 (具体版本号未披露，但与Engine API暴露配置相关)

**利用条件:** Docker Engine HTTP API (默认在http://192.168.65.7:2375) 可从容器内部访问，或通过SSRF可达。无需认证，API配置为无TLS。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074 是一个影响 Docker Desktop for Windows 的严重漏洞，其本质是由于 Docker Engine HTTP API 存在配置缺陷导致暴露。在受影响的配置中，Docker Engine API（通常监听在 `http://192.168.65.7:2375`）可从在同一主机上运行的容器内部访问，甚至可能通过服务器端请求伪造（SSRF）利用。这种未经授权的访问允许攻击者通过 Docker API 执行特权操作，从而实现容器逃逸并向 Windows 主机写入任意文件。

**漏洞概述与影响**
该漏洞的利用点在于 Docker Engine API 的不当暴露。当 API 在没有 TLS 保护且容器可访问的网络接口上监听时，容器内的攻击者可以向其发送请求。POC 明确指出，这种访问可以被用于创建一个新的容器，并巧妙地配置一个绑定挂载（bind mount），将宿主机的 `C:\` 驱动器（在 Docker Desktop 的底层 Linux VM 中表现为 `/mnt/host/c`）挂载到新创建容器的内部路径。一旦主机文件系统被挂载到容器中，攻击者便可以在容器内部执行命令，从而在宿主机上写入、修改或删除文件，这构成了严重的文件系统破坏风险，并可能导致进一步的权限提升或持久化。

**利用步骤**
1.  **获得初始立足点**：攻击者首先需要在受害的 Docker Desktop 主机上获得一个容器的执行权限，或找到一个存在 SSRF 漏洞的服务，该服务能够访问到暴露的 Docker Engine API 端点 `http://192.168.65.7:2375`。
2.  **验证API可达性**：在攻击者所控制的容器内部，通过发送一个简单的 HTTP GET 请求到 `http://192.168.65.7:2375/_ping` 来验证 Docker Engine API 是否可达。如果 API 正常响应并返回 `OK`，则利用条件满足。
3.  **执行POC**：在容器内部安装 Python `requests` 库 (`pip install requests`)，然后运行提供的 Python POC 脚本 `cve_2025_9074_poc.py`。
4.  **POC操作**：该脚本将通过 HTTP 连接到暴露的 Docker Engine API。它会向 API 发送指令，创建一个临时的、短生命周期的容器。
5.  **创建绑定挂载**：在创建新容器的请求中，POC 会指定一个关键的绑定挂载配置：将宿主机的 `C:\` 驱动器（在 Linux VM 中表现为 `/mnt/host/c`）挂载到新容器内的 `/host_root` 目录。
6.  **文件写入**：在新创建的容器内部，POC 执行一个简单的命令，将包含文本 `pwned_by_CVE_2025_9074` 的文件写入到 `/host_root/pwn.txt`。由于 `/host_root` 绑定挂载到宿主机的 `C:\`，因此该文件最终会以 `C:\pwn.txt` 的形式出现在 Windows 宿主机上。
7.  **确认利用成功**：攻击者通过检查 Windows 宿主机上是否存在 `C:\pwn.txt` 文件来确认漏洞利用成功。该文件出现即表明容器已成功将数据写入到主机文件系统。

**POC有效性分析**
提供的 Python POC (`cve_2025_9074_poc.py`) 在功能上完整且高度有效，能够准确地演示 CVE-2025-9074 漏洞。该脚本使用 Python 的 `requests` 库与 Docker Engine API 进行 HTTP 通信，这是与 Docker Daemon 交互的标准方式。它清晰地展示了如何通过 API 调用来创建具有特定绑定挂载配置的容器，从而实现从容器到主机的目录遍历和文件写入。代码结构良好，易于阅读和理解，并且通过命令行参数提供了灵活的配置选项，例如目标主机 IP、端口、容器镜像、主机路径、容器挂载点以及输出文件名。`README.md` 文件提供了详细的设置和运行说明，使得漏洞复现过程直观且可重复。POC 的核心逻辑直接针对 Docker API 的 `create container` 和 `start container` 端点，利用 `Binds` 参数实现主机文件系统的挂载，这与 Docker 的官方 API 文档和社区实践相符。因此，该 POC 被评定为“完整利用”，其可靠性高，能够直接复现漏洞效果。

**投毒风险分析**
针对 `cve_2025_9074_poc.py` 这个特定的 POC，其投毒风险评估为低（10%）。代码本身是公开的 Python 脚本，采用清晰可读的结构，且仅依赖于广泛使用的、受信任的 `requests` 库。代码中没有发现任何混淆、加密或尝试隐藏恶意行为的迹象。脚本的目的明确，即通过在宿主机上创建 `C:\pwn.txt` 文件来证明漏洞的存在。这个文件内容是硬编码的，且无害。没有迹象表明该 POC 会进行额外的网络连接、执行未授权的系统命令（除了用于漏洞演示的写入文件操作）或加载外部恶意模块。作为一个防御性安全研究工具，其代码的透明度和简单性大大降低了被滥用或包含恶意负载的风险。我们始终建议在受控环境中运行任何 POC，并在执行前对其代码进行审查，但就此 POC 而言，其恶意性极低。

**项目地址:** 

**漏洞详情:** 
