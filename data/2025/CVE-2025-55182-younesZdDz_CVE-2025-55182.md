## CVE-2025-55182 - React and Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React and Next.js

**危害等级:** Critical

**CVSS评分:** 10

**影响版本:** React Server Components and Next.js applications using the App Router are affected.

**利用条件:** Unauthenticated remote attacker can exploit this vulnerability by sending a specially crafted payload to a vulnerable React Server Function endpoint.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-55182 是一个存在于 React Server Components (RSC) 中的不安全的反序列化漏洞，该漏洞允许未经身份验证的远程攻击者通过向易受攻击的 React Server Function 端点发送特制负载来执行任意代码。该漏洞也影响使用 App Router 的 Next.js 应用程序。根据漏洞描述，攻击者可以通过发送特制的请求来触发漏洞，从而在服务器上执行任意代码。通过分析提供的POC代码，我们可以验证漏洞的有效性。

POC有效性分析:
POC代码(exploit.js)通过构造一个包含恶意负载的 multipart/form-data 请求来利用此漏洞。它定义了一个 `craftedChunk` 对象，该对象包含一个 `_response` 属性，其中包含一个 `_prefix` 字段，该字段包含将在服务器上执行的恶意 JavaScript 代码。此代码使用 `child_process.execSync` 函数执行操作系统命令。POC脚本接受两个命令行参数：目标服务器的 URL 和要执行的命令。默认情况下，它将尝试在 `http://localhost:3000` 上执行 `printenv > public/env.txt` 命令，将环境变量输出到服务器的 `public` 目录下。该POC通过篡改JavaScript的原型链，将恶意代码注入到反序列化过程中，最终导致远程代码执行。该请求的 'Next-Action' 标头设置为 'x'，表明这是一个利用漏洞的尝试。漏洞利用的关键在于构造恶意的 JSON 结构，特别是 `then`、`status`、`reason`、`value` 和 `_response` 字段，这些字段会被反序列化引擎处理，从而触发代码执行。`_prefix`字段包含要执行的实际命令，并被嵌入到 JavaScript 代码中。boundary变量用于构建 multipart/form-data 请求的边界，确保服务器正确解析请求体。客户端代码使用 http 或 https 模块发送请求，具体取决于目标 URL 的协议。如果请求成功，服务器将执行指定的命令，并将结果输出到控制台。提供的 `test-app` 目录包含一个简单的 Next.js 应用程序，可用于测试和验证该漏洞。该应用程序基于 `create-next-app` 模板，并包含基本的页面路由和组件结构。要验证该漏洞，需要启动 Next.js 应用程序，然后运行 exploit.js 脚本，将目标 URL 设置为 Next.js 应用程序的地址。如果漏洞利用成功，将在服务器上执行指定的命令，并且可以在服务器的文件系统中找到包含环境变量输出的 `env.txt` 文件。

利用步骤:
1. 部署存在漏洞的React或Next.js应用。
2. 准备exploit.js脚本，修改目标URL和需要执行的命令。
3. 运行exploit.js脚本，发送恶意请求。
4. 验证命令是否在服务器上成功执行。

投毒风险分析:
POC代码主要使用标准Node.js库（如http、https和url），没有明显的恶意代码或混淆。然而，它确实包含允许攻击者在服务器上执行任意命令的功能，这本身就构成了一种风险。该脚本没有尝试下载或执行任何外部脚本，也没有利用 eval 或其他危险的 JavaScript 功能。虽然该漏洞允许远程代码执行，但 POC 代码本身看起来并没有被设计成具有任何持久性或自我传播的能力。它仅仅是利用了反序列化漏洞来执行一次性命令。但是，该POC允许执行任意命令，攻击者可能使用此漏洞植入后门、窃取敏感数据或进行其他恶意活动。因此，我们认为存在中低度的投毒风险。如果攻击者修改了 POC 以包含更复杂的恶意代码（例如，下载和执行远程脚本），则风险将大大增加。此POC需要用户提供目标URL和要执行的命令。这增加了安全性，因为用户必须明确指定要执行的操作。但是，如果用户不小心指定了恶意命令，仍然存在风险。由于利用代码相对清晰且依赖标准库，因此投毒风险较低，大约为20%。但是，如果被攻击者修改，风险可能会增加。

**项目地址:** 无

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
