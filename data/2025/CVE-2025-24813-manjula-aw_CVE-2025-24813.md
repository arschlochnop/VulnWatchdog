## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires network access

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 35%

## 详情

CVE-2025-24813 is a critical security vulnerability in Apache Tomcat, specifically an unauthenticated remote code execution (RCE) vulnerability that stems from the improper handling of partial PUT requests. The vulnerability affects multiple versions of Apache Tomcat, including versions 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, and even older, end-of-life (EOL) versions like 8.5.0 through 8.5.100.

The provided Proof of Concept (POC) code demonstrates the exploitation process. The `01-prepare-environment.sh` script automates the setup of a vulnerable Tomcat instance. It first checks if a Tomcat instance already exists and shuts it down if it does. Then, it downloads the specified Tomcat version (defaulting to 10.1.15) from the Apache archive. The script modifies the `web.xml` file to set the `readonly` parameter of the `DefaultServlet` to `false`, enabling PUT requests. It also modifies the `context.xml` file to enable persistent session management using a `FileStore`. A `commons-collections-3.1.jar` is downloaded to the Tomcat's `lib` directory, providing a serialization gadget needed for the exploit. Finally, it downloads `ysoserial`, generates a payload that creates a file `/tmp/pwndtomcat${tomcat_version}`, encodes it in base64, and starts the Tomcat server.

The `02-test.sh` script then exploits the vulnerability. It retrieves the base64 encoded payload. It constructs a `Content-Range` header, crafting a PUT request to the `/testwithslash1/session` endpoint with the crafted header and payload. This triggers the deserialization vulnerability, leading to arbitrary code execution. The successful execution of the exploit will create the file `/tmp/pwndtomcat${tomcat_version}` on the target system, confirming the RCE.

POC有效性分析：该POC的有效性很高，因为它提供了一整套自动化脚本，可以快速部署易受攻击的Tomcat实例并利用该漏洞。该漏洞不需要身份验证，并且攻击复杂度低，使得攻击者容易利用。给定的脚本清晰地描述了漏洞利用过程，减少了用户交互的需要，并简化了复制利用。

利用步骤：
1. 运行`01-prepare-environment.sh`脚本来设置易受攻击的Tomcat实例。
2. 运行`02-test.sh`脚本来利用该漏洞。该脚本将向Tomcat服务器发送特制的PUT请求。
3. 如果利用成功，将在目标系统上创建`/tmp/pwndtomcat${tomcat_version}`文件，表明远程代码已成功执行。

投毒风险分析：
投毒风险评估为35%。脚本本身清晰且使用标准工具（如wget、sed、curl）以及maven仓库下载的通用组件，降低了立即注入恶意的风险。然而，`ysoserial`工具在历史上曾被用于恶意目的，通过下载和执行来自GitHub的预编译jar存在一定的风险。虽然脚本中没有明显的混淆或恶意行为，但使用`ysoserial`引入了中等程度的风险，因为攻击者可能会替换`ysoserial`生成恶意负载，从而允许执行恶意代码。此外，开启readonly权限也存在一定风险，允许未授权的上传行为。



**项目地址:** https://github.com/frohoff/ysoserial

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
