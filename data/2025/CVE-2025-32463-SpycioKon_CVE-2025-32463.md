## CVE-2025-32463 - Linux sudo 本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Linux sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地访问，无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463是影响Linux sudo版本（低于1.9.17p1）的高危本地权限提升漏洞。未经授权的本地用户可利用此漏洞获取root权限。漏洞根源在于sudo在使用`-R`（chroot）选项时，会错误地从用户控制的chroot环境加载`/etc/nsswitch.conf`，从而允许攻击者注入恶意NSS模块。

**POC有效性分析：**
提供的POC脚本`CVE-2025-32463.sh`是功能完整的利用程序。它自动化了攻击流程：
1. 创建临时目录并生成C源文件`woot1337.c`。此文件包含构造函数`woot`，旨在通过`setreuid(0,0)`和`setregid(0,0)`获取root权限，随后执行shell或指定命令。
2. 创建自定义`nsswitch.conf`，配置`passwd`条目使用`/woot1337`作为NSS模块。
3. 将`woot1337.c`编译为共享库`libnss_/woot1337.so.2`，确保`woot`函数在库加载时立即执行。
4. 执行`sudo -R woot woot`。`-R`选项使得sudo在攻击者控制的chroot环境中查找`nsswitch.conf`。此举导致sudo加载攻击者的`nsswitch.conf`，进而触发恶意共享库加载和`woot`函数执行，成功授予root权限。
5. 脚本最后清理临时文件。
该POC清晰、直接，有效演示了漏洞机制。

**利用步骤：**
1. 获取对运行受影响sudo版本（<1.9.17p1）的Linux系统的本地用户访问权限。
2. 下载或创建`CVE-2025-32463.sh`脚本。
3. 在本地shell中执行：`./CVE-2025-32463.sh`（获取root shell）或`./CVE-2025-32463.sh "id"`（以root权限执行命令）。
4. 脚本将自动编译并触发漏洞，获取root权限。

**投毒风险分析：**
POC脚本`CVE-2025-32463.sh`的投毒风险极低。代码完全透明且自包含，直接在脚本中生成C源代码并编译成共享库。C代码的唯一目的即是获取root权限并执行指定命令，无其他恶意行为。脚本不下载外部payload、不连接C2服务器、不进行数据窃取，也不安装持久性后门。所有临时文件在执行后会被清理。`CMD_C_ESCAPED`确保命令安全转义。此POC旨在清晰地演示漏洞并获取root shell，不含隐藏恶意功能。因此，对防御性安全研究而言，该POC在受控环境中分析和执行是安全的。

**项目地址:** Not available

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
