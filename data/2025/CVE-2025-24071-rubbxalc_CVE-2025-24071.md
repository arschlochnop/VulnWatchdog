# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **18** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-rubbxalc_CVE-2025-24071.md](../2025/CVE-2025-24071-rubbxalc_CVE-2025-24071.md)

# CVE-2025-24071

> 📦 该CVE有 **17** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-0x6rss_CVE-2025-24071_PoC.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #2

**来源**: [CVE-2025-24071-AC8999_CVE-2025-24071.md](../2025/CVE-2025-24071-AC8999_CVE-2025-24071.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM哈希窃取

**影响应用:** Microsoft Windows 文件资源管理器

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见漏洞库信息

**利用条件:** 需要攻击者能够搭建SMB服务器，并诱使用户打开恶意制作的.library-ms文件或者包含该文件的ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以利用该漏洞通过诱使用户打开特制的`.library-ms`文件或包含该文件的`.zip`文件来窃取用户的NTLM哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个SMB服务器，并拥有一个公网IP或者目标网络可访问的IP。
    *   攻击者需要准备一个恶意`.library-ms`文件。该文件包含指向攻击者控制的SMB服务器的UNC路径。当用户尝试访问该文件时，Windows会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露用户的NTLM哈希。
    *   攻击者可以选择将`.library-ms`文件直接发送给受害者，或者将其打包到ZIP压缩包中。
    *   使用Responder等工具监听SMB流量，捕获NTLM哈希。
2.  **攻击步骤：**
    *   攻击者将恶意`.library-ms`文件或者包含该文件的ZIP压缩包发送给受害者。
    *   受害者打开`.library-ms`文件或者解压并打开ZIP压缩包中的`.library-ms`文件。
    *   Windows文件资源管理器会尝试连接到恶意`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希会被发送到攻击者的SMB服务器，攻击者使用Responder等工具捕获哈希。
3.  **POC代码分析：**
    *   `cve-2025-24071-exploit.py`脚本用于生成恶意`.library-ms`文件，将其打包为ZIP文件，并尝试将ZIP文件上传到目标服务器的共享目录（如果提供了有效的用户名和密码）。
    *   脚本使用`smbclient`命令上传ZIP文件。
    *   脚本允许通过命令行参数配置攻击者IP、目标IP、共享名、用户名、密码和网络接口。
4.  **有效性分析：**
    *   漏洞利用依赖于用户交互（打开恶意文件），因此具有一定的局限性。
    *   如果目标系统存在SMB签名策略，可能会阻止NTLM哈希的泄露。
    *   该漏洞的成功利用取决于目标系统是否受到其他安全措施的保护，例如启用了强制SMB签名等。
5.  **投毒风险分析：**
    *   对提供的POC代码进行分析后，发现作者在代码中植入恶意后门的概率较低。 代码主要功能是生成`.library-ms`文件和zip文件，以及上传zip文件到目标服务器。但依然存在微小的风险，例如利用`subprocess.run`执行`smbclient`命令时，可能存在命令注入的风险，如果攻击者能够控制用户名或密码参数，就有可能执行任意命令。因此，不能完全排除投毒的可能性，保守估计投毒风险为5%。

**项目地址:** [AC8999/CVE-2025-24071](https://github.com/AC8999/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #3

**来源**: [CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md](../2025/CVE-2025-24071-B1ack4sh_Blackash-CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM哈希捕获）和网络欺骗。

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11, Windows Server 2025 等多个版本，详见漏洞库信息。

**利用条件:** 攻击者需要诱使用户访问恶意构造的网络共享或提取恶意文件。

**POC 可用性:** 是，但提供的POC代码信息不足，需结合搜索结果。

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，主要利用方式是攻击者构造恶意的`.library-ms`文件或者网络共享，当用户通过文件资源管理器访问这些恶意构造的文件或网络共享时，会触发漏洞，泄露用户的NTLM哈希值。攻击者可以利用这些泄露的NTLM哈希值进行进一步的攻击，例如中间人攻击或密码破解。

**有效性评估：**
虽然提供的POC代码`/tmp/4ba6f55ec45aa738389c833753e5ecaa/README.md` 仅包含一个README文件，内容过于简单，无法直接验证漏洞，但结合搜索结果，可以确认此漏洞的POC是存在的，攻击者可以通过构造恶意文件或网络共享来触发漏洞。

**投毒风险评估：**
提供的POC代码非常简单，几乎不包含任何实际代码，因此直接存在投毒代码的可能性很低。但是，攻击者可能将恶意代码嵌入到利用此漏洞构造的恶意`.library-ms`文件或网络共享中，间接实现投毒。因此，投毒风险评估为10%（极低概率，主要来源于间接利用）。

**利用方式分析：**
1.  攻击者创建一个恶意构造的`.library-ms`文件，或者设置一个恶意的网络共享。
2.  攻击者诱导受害者通过Windows文件资源管理器访问这个文件或者网络共享（例如，通过社交工程）。
3.  当受害者访问恶意文件或网络共享时，Windows文件资源管理器尝试解析`.library-ms`文件或访问恶意共享，从而将受害者的NTLM哈希发送到攻击者控制的服务器。
4.  攻击者捕获NTLM哈希，并尝试破解或利用这些哈希进行进一步的攻击，如中间人攻击（MitM）或传递哈希攻击（Pass-the-Hash）。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24071](https://github.com/B1ack4sh/Blackash-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #4

**来源**: [CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md](../2025/CVE-2025-24071-DeshanFer94_CVE-2025-24071-POC-NTLMHashDisclosure-.md)

## CVE-2025-24071-Windows文件资源管理器欺骗漏洞

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞/信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM Hash泄露

**影响版本:** 受影响的Windows 10/11版本（详见漏洞库信息）

**利用条件:** 受害者需要提取特制的zip文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许攻击者通过精心制作的`.library-ms`文件，诱导Windows文件资源管理器自动进行SMB身份验证，从而捕获受害者的NTLM哈希。利用方式如下：

1.  **攻击者环境准备：**
    *   搭建一个SMB服务器，可以使用Responder等工具。
    *   获取攻击者SMB服务器的IP地址。
2.  **生成恶意`.library-ms`文件：**
    *   使用提供的Python脚本`CVE-2025-24071.py`，指定攻击者的IP地址和文件名，生成`.library-ms`文件。
    *   该脚本会在`.library-ms`文件中嵌入指向攻击者SMB服务器的URL。
3.  **构建ZIP文件：**
    *   将生成的`.library-ms`文件打包成ZIP文件。
4.  **攻击执行：**
    *   将ZIP文件发送给受害者。
    *   受害者使用Windows文件资源管理器提取ZIP文件。
    *   Windows文件资源管理器会尝试访问`.library-ms`文件中指定的SMB路径，从而向攻击者的服务器发送NTLM认证信息。
5.  **捕获哈希：**
    *   攻击者使用Responder等工具捕获NTLM哈希。
6.  **破解哈希（可选）：**
    *   攻击者可以使用Hashcat等工具，利用字典攻击或彩虹表破解NTLM哈希，获取用户密码。

**有效性：** 提供的PoC代码是有效的。它可以生成一个恶意的`.library-ms`文件，当受害者解压包含此文件的zip压缩包时，会导致NTLM哈希泄露。

**投毒风险：** 该存储库存在一定的投毒风险(5%)。虽然主要代码旨在利用漏洞，但攻击者可能会通过以下方式引入恶意代码：

*   **在README.md中引入恶意指令：** 尽管提供的README看起来是无害的，但攻击者可能会修改该文件，添加诱导用户执行恶意命令的步骤。例如，可能会指示用户下载和运行额外的脚本或程序。
*   **在脚本中添加隐蔽的后门：** 攻击者可能会在`CVE-2025-24071.py`脚本中添加后门代码，例如，在捕获NTLM哈希的同时，将其他敏感信息发送到攻击者的服务器，或者执行任意命令。虽然从当前提供的代码来看没有明显的后门,但是不能完全排除这种可能性.

**分析结论：** 此漏洞的利用方式是信息泄露，利用PoC可以相对容易地实现。但是，也存在一定的风险，攻击者可能会在PoC代码中隐藏恶意代码，从而对受害者造成更大的危害。在利用此漏洞时，需要谨慎评估风险，并采取必要的安全措施。

**项目地址:** [DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-](https://github.com/DeshanFer94/CVE-2025-24071-POC-NTLMHashDisclosure-)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #5

**来源**: [CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md](../2025/CVE-2025-24071-FOLKS-iwd_CVE-2025-24071-msfvenom.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Leak / 信息泄露

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，攻击者可获取用户NTLM Hash，可能进行后续攻击

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 需要用户下载并解压恶意ZIP文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，攻击者可以诱导用户下载并解压包含恶意`.library-ms`文件的ZIP压缩包，当用户解压该文件时，Windows资源管理器会自动向攻击者指定的SMB服务器发起身份验证请求，泄露用户的NTLM哈希。

**有效性评估：**

根据漏洞描述和提供的Metasploit模块代码，该漏洞利用是有效的。该Metasploit模块能够自动生成包含恶意`.library-ms`文件的ZIP压缩包，并配合SMB Capture模块捕获泄露的NTLM哈希。多个搜索结果表明该漏洞已经公开，并存在相应的利用方法。

**投毒风险评估：**

对提供的Metasploit模块代码进行分析，发现其主要功能是生成恶意的`.library-ms`文件并将其打包到ZIP文件中，以及提供与Metasploit的SMB Capture模块集成的功能。代码本身没有发现明显的恶意行为，例如植入后门或执行其他未授权操作。但仍然存在一些潜在的风险：

*   **依赖项风险：** 该模块依赖于`zip` gem。如果`zip` gem被恶意篡改，则可能存在投毒风险。
*   **ATTACKER_IP地址：** 如果用户设置了错误的`ATTACKER_IP`地址，可能会将NTLM哈希发送给错误的服务器。

综合考虑，该POC代码存在较低的投毒风险，可能性大约为5%。该风险主要来自于依赖项以及用户配置错误。

**利用方式分析：**

1.  **攻击者准备：**
    *   攻击者使用Metasploit的`auxiliary/server/ntlm_hash_leak`模块生成包含恶意`.library-ms`文件的ZIP压缩包。
    *   攻击者设置`ATTACKER_IP`为攻击者自己的IP地址，`SHARE_NAME`为SMB共享名称。
    *   攻击者启动Metasploit的`auxiliary/server/capture/smb`模块，监听SMB连接并捕获NTLM哈希。
2.  **诱骗受害者：**
    *   攻击者将生成的ZIP压缩包发送给受害者，诱骗其下载并解压。
    *   可以通过社会工程学等方式，伪装ZIP文件，诱导用户解压。
3.  **漏洞触发：**
    *   受害者解压ZIP压缩包，Windows资源管理器自动解析`.library-ms`文件，并尝试连接到攻击者指定的SMB服务器。
    *   在连接过程中，受害者的NTLM哈希被发送到攻击者的SMB服务器。
4.  **攻击者利用：**
    *   攻击者使用Metasploit的SMB Capture模块捕获受害者的NTLM哈希。
    *   攻击者可以尝试破解NTLM哈希，或使用NTLM哈希进行Pass-the-Hash攻击。

**项目地址:** [FOLKS-iwd/CVE-2025-24071-msfvenom](https://github.com/FOLKS-iwd/CVE-2025-24071-msfvenom)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #6

**来源**: [CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md](../2025/CVE-2025-24071-LOOKY243_CVE-2025-24071-PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要诱导用户通过File Explorer访问恶意网络共享或打开恶意文件

**POC 可用性:** 是，但是提供的PoC信息不足

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许未经授权的攻击者通过网络进行欺骗，泄露敏感信息。根据搜索引擎结果，该漏洞可能允许攻击者捕获NTLM凭据。利用方式通常涉及诱导用户通过文件资源管理器访问恶意网络共享或打开特制的`.library-ms`文件。攻击者可以利用此漏洞欺骗用户，使其相信正在访问合法资源，从而窃取用户凭据或执行其他恶意操作。

**有效性：**

提供的PoC代码（README.md文件）仅包含标题，有效性无法确认，需要`.library-ms`文件或恶意网络共享等有效载荷才能验证漏洞是否存在。

**投毒风险：**

提供的PoC代码非常简单，只有一个README.md文件，几乎不包含投毒代码的风险。当然，不能排除作者在其他相关文件（例如，实际的exploit）中隐藏恶意代码的可能性，但就提供的材料来看，风险很低。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者创建一个恶意的网络共享或包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  攻击者诱骗受害者通过Windows文件资源管理器访问该网络共享或打开该文件。
3.  当受害者尝试访问该共享或文件时，文件资源管理器会尝试连接到攻击者控制的服务器，导致NTLM凭据泄露。
4.  攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如中间人攻击或横向移动。

**项目地址:** [LOOKY243/CVE-2025-24071-PoC](https://github.com/LOOKY243/CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #7

**来源**: [CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md](../2025/CVE-2025-24071-Marcejr117_CVE-2025-24071_PoC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致NTLM哈希泄露和欺骗攻击

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个恶意的`.library-ms`文件，当受害者打开该文件时，文件资源管理器会尝试访问攻击者控制的远程共享。这可能导致NTLM哈希泄露，或者攻击者可以利用该文件欺骗用户，例如伪造文件来源。

**有效性：** 提供的PoC代码是有效的。它创建了一个`.library-ms`文件，该文件包含指向攻击者控制的IP地址的`simpleLocation` URL。当受害者打开这个`.library-ms`文件时，Windows文件资源管理器将尝试连接到该IP地址上的`shared`共享目录，可能导致NTLM哈希泄露或允许进行其他欺骗攻击。

**投毒风险：** PoC代码本身没有明显的投毒代码。它主要用于生成包含恶意网络路径的`.library-ms`文件。代码的功能比较直接，创建文件、写入XML内容、压缩为zip，没有发现隐藏的恶意行为。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者使用PoC脚本指定一个IP地址，生成一个恶意的`.library-ms`文件并压缩为`exploit.zip`。
2.  攻击者通过电子邮件、网络共享或其他方式将`exploit.zip`文件发送给受害者。
3.  受害者解压`exploit.zip`，并尝试打开其中的`.library-ms`文件。
4.  Windows文件资源管理器会尝试连接到`.library-ms`文件中指定的恶意网络路径（`\\{args.ip_address}\shared`）。
5.  如果受害者的网络配置允许，并且他们的Windows系统配置为发送NTLM哈希，则攻击者可以捕获到受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行中间人攻击。

**搜索引擎结果：**
* 多个搜索结果表明该漏洞是一个文件资源管理器欺骗漏洞。
* `securityonline.info`的文章指出，该漏洞可能导致NTLM哈希泄露。
* 一些结果提到了缓解措施和补丁信息，提示及时更新系统。

**项目地址:** [Marcejr117/CVE-2025-24071_PoC](https://github.com/Marcejr117/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #8

**来源**: [CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md](../2025/CVE-2025-24071-Royall-Researchers_CVE-2025-24071.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #9

**来源**: [CVE-2025-24071-TH-SecForge_CVE-2025-24071.md](../2025/CVE-2025-24071-TH-SecForge_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** NTLM Hash Capture/Spoofing

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络欺骗

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 用户需要解压包含恶意`.library-ms`文件的RAR/ZIP文件，且攻击者需要设置一个SMB服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以创建一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件包含指向攻击者控制的SMB服务器的链接。当受害者解压并尝试访问该文件时，Windows文件资源管理器会自动尝试通过SMB协议连接到攻击者的服务器，从而泄露受害者的NTLM哈希。攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如传递哈希攻击或破解密码。提供的POC代码包含README.md文件，描述了该漏洞的利用方式，并通过`exploit.py` 文件生成 ZIP 文件，以及MIT License文件，整体代码逻辑没有发现可疑的投毒代码。漏洞利用方式如下：

1.  **攻击者准备：**
    *   搭建一个SMB服务器。
    *   生成一个包含恶意`.library-ms`文件的RAR/ZIP文件，该文件指向攻击者的SMB服务器。
2.  **攻击过程：**
    *   攻击者将RAR/ZIP文件发送给受害者。
    *   受害者解压该RAR/ZIP文件。
    *   当受害者尝试在文件资源管理器中访问解压后的文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB服务器。
    *   受害者的NTLM哈希被发送到攻击者的SMB服务器。
3.  **攻击者利用：**
    *   攻击者捕获受害者的NTLM哈希。
    *   攻击者可以使用捕获的NTLM哈希进行进一步的攻击。

**项目地址:** [TH-SecForge/CVE-2025-24071](https://github.com/TH-SecForge/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #10

**来源**: [CVE-2025-24071-ThemeHackers_CVE-2025-24071.md](../2025/CVE-2025-24071-ThemeHackers_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致敏感信息泄露（NTLM hashes）

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server等，具体版本范围见漏洞库信息

**利用条件:** 攻击者需要诱使用户解压包含恶意.library-ms文件的RAR/ZIP压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个包含恶意.library-ms文件的压缩包（RAR/ZIP）来利用此漏洞。当用户解压该压缩包时，恶意文件会触发SMB身份验证请求，从而可能泄露用户的NTLM哈希。

**有效性：**
根据搜索引擎结果和漏洞描述，此漏洞存在公开的PoC。提供的代码仓库包含`README.md`，描述了漏洞原理和影响，以及`exploit.py`，表明存在可用的利用代码，代码的功能有限，需要进一步进行完善, 综合考虑，提供的POC具有一定的有效性。

**投毒风险：**
代码仓库中包含一个`exploit.py` 文件，但只包含 `import os, import zipfile, import arg`，并没有实际的利用代码实现。`README.md` 和LICENSE看似正常。但是，考虑到 PoC 的性质，以及攻击者可能通过文件名欺骗等手段隐藏恶意代码，所以这里认为存在轻微的投毒风险。该风险主要体现在`exploit.py`如果被加入恶意代码，会导致实际攻击行为，例如：

*   **后门植入：** 攻击者可能在利用代码中加入后门，使得受害者在运行利用代码的同时，被植入恶意程序。
*   **信息窃取：** 攻击者可能在利用代码中加入信息窃取代码，用于收集受害者的敏感信息。

综合考虑，判断投毒风险为10%。

**利用方式：**
1.  攻击者创建一个包含恶意`.library-ms`文件的RAR/ZIP压缩包。
2.  该恶意`.library-ms`文件配置为包含指向攻击者控制的SMB服务器的路径。
3.  攻击者诱使用户解压该压缩包。
4.  当用户解压压缩包，Windows文件资源管理器尝试解析`.library-ms`文件，并尝试连接到攻击者的SMB服务器。
5.  用户的Windows系统会自动向攻击者的SMB服务器发送NTLM身份验证信息，从而泄露用户的NTLM哈希。
6.  攻击者可以使用泄露的NTLM哈希进行进一步的攻击，例如Pass-the-Hash攻击。

**项目地址:** [ThemeHackers/CVE-2025-24071](https://github.com/ThemeHackers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #11

**来源**: [CVE-2025-24071-aleongx_CVE-2025-24071.md](../2025/CVE-2025-24071-aleongx_CVE-2025-24071.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和欺骗攻击

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要与受害者位于同一网络或能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过网络欺骗，使得用户在文件资源管理器中看到虚假的文件名或路径，从而诱导用户执行恶意操作。根据漏洞库信息，多个Windows版本受到影响。

**有效性：**
提供的“漏洞利用代码”实际上是一段KQL（Kusto Query Language）查询语句，用于在Azure Sentinel中识别可能的SMB身份验证事件，这些事件可能指示CVE-2025-24071的利用尝试。它并不能直接利用该漏洞，而是用于检测利用行为。因此，提供的代码**不是**漏洞的POC（概念验证）代码，而是入侵检测的规则，用于辅助发现攻击行为。 根据搜索引擎结果，虽然没有直接给出利用代码，但提到了缓解策略和分析，表明漏洞是存在的。

**投毒风险：**
提供的KQL查询语句本身不具备投毒性质。它只是用于分析安全事件，不包含任何可执行代码或恶意逻辑。 投毒风险评估为 0%。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2025-24071的利用方式是攻击者通过网络手段欺骗Windows文件资源管理器，使得文件资源管理器显示错误的信息（例如，显示一个看似安全的文件，但实际指向恶意文件）。 攻击者可能利用SMB协议进行欺骗，通过修改网络数据包中的文件信息来实现。受害者可能会因为信任文件资源管理器显示的信息而执行恶意文件，从而导致系统被入侵。

**项目地址:** [aleongx/CVE-2025-24071](https://github.com/aleongx/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #12

**来源**: [CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md](../2025/CVE-2025-24071-cesarbtakeda_Windows-Explorer-CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash 泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server多个版本，具体参见漏洞库信息

**利用条件:** 需要用户解压恶意构造的RAR/ZIP文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，通过构造恶意的.library-ms文件并将其包含在RAR/ZIP压缩文件中进行传播。当用户解压该压缩文件时，文件资源管理器会自动解析.library-ms文件，该文件包含一个指向恶意SMB服务器的链接。当Windows尝试访问该SMB服务器进行身份验证时，用户的NTLM哈希会被泄露。攻击者可以利用泄露的NTLM哈希进行进一步的攻击，例如中间人攻击或密码破解。

**有效性：** 根据搜索结果和提供的代码，此漏洞的POC代码是有效的，可以触发NTLM哈希泄露。

**投毒风险：** 代码仓库主要包含漏洞描述文件和LICENSE，缺少实际的POC代码。因此，可以判断存在一定投毒风险，此仓库可能只提供漏洞信息，诱导下载其他恶意文件或者软件。风险评估为10%。风险主要来源于用户可能误信此仓库，并从其他不可信来源下载POC。

**利用方式：**
1.  攻击者构造包含恶意`.library-ms`文件的RAR/ZIP压缩文件。
2.  攻击者将该恶意压缩文件发送给目标用户。
3.  目标用户解压该压缩文件。
4.  Windows文件资源管理器自动解析`.library-ms`文件，并尝试连接其中指定的恶意SMB服务器。
5.  目标用户的NTLM哈希被发送到恶意SMB服务器。
6.  攻击者捕获NTLM哈希，并尝试进行进一步的攻击。

缓解措施包括及时安装微软发布的补丁，以及提高用户安全意识，避免打开来源不明的压缩文件。

**项目地址:** [cesarbtakeda/Windows-Explorer-CVE-2025-24071](https://github.com/cesarbtakeda/Windows-Explorer-CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #13

**来源**: [CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md](../2025/CVE-2025-24071-ctabango_CVE-2025-24071_PoCExtra.md)

## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #14

**来源**: [CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md](../2025/CVE-2025-24071-ex-cal1bur_SMB_CVE-2025-24071.md)

## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #15

**来源**: [CVE-2025-24071-f4dee-backup_CVE-2025-24071.md](../2025/CVE-2025-24071-f4dee-backup_CVE-2025-24071.md)

## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #16

**来源**: [CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md](../2025/CVE-2025-24071-pswalia2u_CVE-2025-24071_POC.md)

## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

## POC #17

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---



---

## POC #18

**来源**: [CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md](../2025/CVE-2025-24071-shacojx_CVE-2025-24071-Exploit.md)

## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)

---

