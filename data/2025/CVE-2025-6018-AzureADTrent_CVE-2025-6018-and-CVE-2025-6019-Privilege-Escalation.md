## CVE-2025-6018 - Linux PAM (Pluggable Authentication Modules), SUSE 15, 银河麒麟 (KylinOS) 本地权限提升

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地权限提升

**影响应用:** Linux PAM (Pluggable Authentication Modules), SUSE 15, 银河麒麟 (KylinOS)

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** Linux systems using PAM, specifically SUSE 15, 银河麒麟 (KylinOS), and potentially other distributions, for versions affected by CVE-2025-6018 and CVE-2025-6019.

**利用条件:** 需要本地用户权限

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-6018和CVE-2025-6019是影响Linux系统，特别是其可插拔认证模块（PAM）以及可能的`libblockdev`库的本地权限提升漏洞。这些漏洞允许具有本地用户权限的攻击者，在特定配置或受影响版本上，将权限提升至`root`用户，从而完全控制受感染的系统。根据搜索结果，SUSE 15和银河麒麟（KylinOS）等发行版可能受到影响。

所提供的POC代码（位于`README.md`）详细描述了一个利用这两个漏洞实现权限提升的攻击链。该POC的有效性分析表明，它是一个结构清晰、步骤明确的完整利用指南。它假设攻击者已获得对目标系统的初始低权限访问（如普通用户shell），然后通过一系列本地操作来完成权限提升。POC通过明确的指令链接到两个外部GitHub仓库中的脚本，这些脚本是实际漏洞利用的核心。其利用步骤包括生成特定的攻击文件、在受害者系统上设置必要的环境变量，并执行最终的提权脚本。这种分阶段的利用方式是典型的本地权限提升漏洞利用模式，表明该POC具有高度的可用性和有效性。POC中明确提到“You should now have root”，进一步证实了其旨在提供完整的`root`权限获取过程。鉴于描述的细节程度和对典型LPE攻击流程的遵循，该POC在适当的目标环境下极可能成功。

利用CVE-2025-6018和CVE-2025-6019的权限提升过程涉及以下关键步骤：

1.  **获取初始Shell（可能为前置条件）**：POC首先指示攻击者在攻击机上使用位于`https://raw.githubusercontent.com/ibrahmsql/CVE-2025-6018/refs/heads/main/CVE-202`的工具。这暗示可能存在一个前置步骤，用于获取目标系统的初始用户级shell，或者此工具本身就是权限提升过程的初始阶段。如果利用失败，POC建议重启受害者机器，这可能表明漏洞利用的稳定性或环境依赖性。
2.  **准备本地提权脚本**：攻击者需要在其攻击机上下载第二个关键脚本，该脚本位于`https://raw.githubusercontent.com/guinea-offensive-security/CVE-2025-6019/`。
3.  **生成攻击镜像文件**：在攻击机上，以`sudo`权限执行第二步下载的脚本，并使用`L`选项。此操作将生成一个名为`xfs.image`的攻击文件，该文件是后续提权操作的关键组件。
4.  **文件传输至目标**：将上一步生成的`xfs.image`文件以及第二步下载的`CVE-2025-6019`脚本，通过`wget`或`SCP`等方式传输到受害者机器上。
5.  **配置受害者环境**：在受害者机器上执行提权脚本之前，必须设置`PATH`环境变量以确保系统能找到所需的二进制文件。具体命令是`export PATH=$PATH:/sbin:/usr/sbin`。
6.  **执行最终提权**：在受害者机器上，执行已传输的`CVE-2025-6019`脚本，并使用`C`选项。
7.  **获取Root权限**：如果所有步骤成功执行，攻击者将获得目标系统的`root`权限，从而实现完全控制。

针对此CVE的POC，投毒风险评估主要集中在两个方面：POC描述本身以及其引用的外部资源。

**POC描述本身的风险**：提供的输入数据中，POC代码表现为一个`README.md`文件。这个Markdown文件本身是纯文本，不包含任何可直接执行的代码、混淆内容或可疑的外部请求。因此，直接从这个`README.md`文件本身获取恶意代码（即被“投毒”）的风险是极低的。它充当的是一个操作指南，清晰地说明了利用步骤。

**引用的外部资源的风险**：真正的投毒风险源自`README.md`中引用的两个外部GitHub链接：
1.  `https://raw.githubusercontent.com/ibrahmsql/CVE-2025-6018/refs/heads/main/CVE-202`
2.  `https://raw.githubusercontent.com/guinea-offensive-security/CVE-2025-6019/`

这些链接指向托管在GitHub上的原始脚本文件。虽然GitHub作为一个代码托管平台具有一定的透明度，但其上的内容是由个人或组织用户上传和维护的。这引入了以下风险点：

*   **内容的可变性**：`raw.githubusercontent.com`上的文件内容可以被仓库所有者随时修改。这意味着今天你审查的脚本可能是良性的，但明天它可能被替换为包含恶意负载（如后门、加密货币矿工、僵尸网络客户端或数据窃取模块）的版本，而用户在下载时不会察觉到任何异常。
*   **缺乏第三方审计**：这些脚本并非由官方厂商或知名安全机构发布，缺乏独立的审计或验证。其代码质量和安全性完全依赖于原始作者的意图和能力。
*   **代码混淆与隐藏恶意行为**：即使表面上看起来是合法的漏洞利用代码，恶意作者也可能通过代码混淆、编码（如Base64）、动态加载或调用外部资源等方式，隐藏真正的恶意行为。例如，脚本可能在执行提权的同时，静默地建立一个持久化后门或与攻击者的C2服务器通信。
*   **供应链风险**：如果GitHub仓库的所有者账户被攻陷，攻击者可以轻易地将合法POC替换为恶意版本。任何依赖这些链接进行测试或研究的用户都可能面临系统被渗透的风险。
*   **缺乏完整性校验**：POC的`README.md`中没有提供这些脚本的哈希值（如SHA256）。这意味着无法验证下载的脚本是否与作者最初提供的版本一致，也无法检测传输过程中的篡改。

**综合评估**：考虑到POC`README.md`本身是无害的，但其核心功能依赖于未经审查且内容可随时更改的外部脚本，整体投毒风险被评定为中等偏低（10%）。这个百分比反映的是README文件本身的“无毒”特性，但务必强调，实际使用这些外部脚本时，必须采取严格的安全措施。

**防御性建议**：为了应对这种风险，防御性安全研究员在评估和使用此类POC时应遵循以下最佳实践：
1.  **隔离环境执行**：所有POC和相关脚本都应在与生产环境完全隔离的沙盒或虚拟机中执行，并限制其网络访问能力。
2.  **彻底的代码审查**：在执行任何外部脚本之前，必须对其进行详尽的代码审查，查找任何可疑的函数调用、网络请求、文件操作或混淆代码。
3.  **静态和动态分析**：利用专业的静态代码分析工具检测潜在恶意模式，并通过动态分析（在沙盒中运行并监控其行为）来观察其运行时活动，包括文件系统更改、进程创建和网络通信。
4.  **网络流量监控**：在POC执行期间，密切监控所有出入站网络流量，识别任何与已知恶意C2服务器的通信或意外数据传输。
5.  **使用受信任来源**：尽可能优先使用来自官方厂商、NVD、MITRE或其他受信任安全研究机构发布的漏洞详情和POC。

**项目地址:** https://github.com/ibrahmsql/CVE-2025-6018

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-6018
