## CVE-2025-14847 - MongoDB 信息泄露

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 信息泄露

**影响应用:** MongoDB

**危害等级:** 高危

**CVSS评分:** 8.7

**影响版本:** 8.2.0-8.2.2, 8.0.0-8.0.16, 7.0.0-7.0.27, 6.0.0-6.0.26, 5.0.0-5.0.31, 4.4.0-4.4.29, 以及 4.2.x, 4.0.x, 3.6.x 所有版本

**利用条件:** 远程未经身份验证，且目标 MongoDB 实例启用了 Zlib 网络压缩协议（--networkMessageCompressors 包含 zlib）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞（CVE-2025-14847）源于 MongoDB 处理 Zlib 压缩协议数据包时的逻辑缺陷。由于协议头中的长度字段校验不足，攻击者可以通过发送畸形的 Zlib 压缩包，诱导服务器返回超过实际解压数据长度的缓冲区内容。提供的 POC 代码是用 Go 语言编写的，具备高度的工程化水平。它不仅包含了版本探测逻辑，还实现了具体的内存提取功能。通过对比文档长度偏移量（offset），该工具能够精准触发堆内存越界读取。该 POC 经过验证，能够有效获取 MongoDB 进程内存中的未初始化片段。由于 MongoDB 经常在堆内存中处理明文凭证、查询结果和会话令牌，此类内存泄露通常意味着敏感数据的直接暴露。该工具有效性极高，能够实现单目标扫描和多线程批量扫描，是防御性评估的强力工具，但也极易被非法利用进行大规模资产探测。【利用步骤】1. 环境确认：确认目标 MongoDB 端口（默认 27017）开放且支持 Zlib 压缩。2. 工具配置：使用 Go 编译器编译 main.go，生成可执行文件。3. 触发漏洞：运行扫描命令（如 `./mongodb-scanner -t target:27017`），工具会向目标发送精心构造的 OP_MSG 或 OP_QUERY 压缩消息。4. 数据获取：观察终端实时输出的十六进制内存数据，从中筛选包含 'password'、'scram' 或 'token' 等特征的字符串。【投毒风险分析】在对此 POC 项目的源代码结构分析中，未发现明显的投毒迹象。项目采用了标准的 Go 模块化结构，依赖项清晰。其核心逻辑聚焦于网络套接字通信与 Zlib 协议封装，代码逻辑透明，没有进行 Base64 混淆或通过 `eval` 执行动态脚本的行为。编译过程不依赖外部不受信任的预编译二进制文件。然而，由于该漏洞属于近期披露的热点，此类工具在社区传播时（如 GitHub Fork 或 Telegram 频道）极易被修改。常见的投毒手段可能包括：在 `go mod` 依赖中引入同名的恶意包，或在数据处理逻辑中加入隐蔽的 `HTTP POST` 请求将泄露的内存数据同步发送至攻击者的 C2 服务器。尽管当前版本评定为低风险（10%），但安全研究员在使用时仍应坚持在沙箱环境编译，并严格监控对外网络连接。

**项目地址:** [https://github.com/onewinner/CVE-2025-14847.git](https://github.com/onewinner/CVE-2025-14847.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14847](https://nvd.nist.gov/vuln/detail/CVE-2025-14847)
