## CVE-2025-27591 - Below (Linux 监控工具) 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** Below (Linux 监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8

**影响版本:** 小于 v0.9.0

**利用条件:** 本地低权限用户访问权限，且目标系统安装了受影响版本的 below 服务，通常需要 sudo 执行权限或该服务以 root 权限运行且目录权限配置错误。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞源于 Below 服务在创建日志目录 /var/log/below 时将其权限设置为全局可写（world-writable）。在 Linux 系统中，如果一个由高权限进程使用的目录对低权限用户可写，攻击者可以利用符号链接（Symlink）攻击来控制高权限进程的文件操作。本 POC 代码非常完整且具有实战价值。脚本首先验证了本地环境是否可以通过 sudo 执行 below 命令。随后，它备份了关键的系统文件 /etc/passwd，并使用 openssl 生成了一个具有 root 权限的新用户 'haxor' 的哈希行。核心利用步骤是通过删除原有的日志文件并创建一个指向 /etc/passwd 的软链接。当脚本通过执行一个带有无效参数的 below 命令强制程序写入错误日志时，由于程序没有校验目标文件是否为符号链接，它会以 root 权限打开并写入该链接指向的文件。最后，POC 通过 cat 命令向该链接写入 payload，实际上是将伪造的 root 用户信息注入到了系统账号数据库中。整个逻辑闭环，在未修复的 Ubuntu 或 CentOS 环境中具有极高的成功率。该利用方式属于典型的竞态条件或不安全的文件处理逻辑漏洞。【利用步骤】1. 获取目标系统的普通 shell 权限；2. 确认 /var/log/below 目录存在且为全局可写；3. 准备一个恶意的 /etc/passwd 条目，包含已知的 root 权限用户哈希；4. 将 /var/log/below/error_root.log 软链接至 /etc/passwd；5. 调用 below 程序触发日志写入动作；6. 利用打开的文件描述符或直接写入覆盖系统敏感文件；7. 使用 su 命令切换至新创建的 root 用户。【投毒风险分析】从代码结构来看，该 POC 属于高质量的开源安全研究脚本，投毒风险较低。代码逻辑透明，使用了标准的 Bash 命令（cp, rm, ln, openssl, cat），没有引入经过混淆的 Base64 字符串，也没有尝试从远程服务器下载可疑的二进制执行文件。脚本中包含的备份操作（备份 /etc/passwd 至 /tmp/passwd.bak）显示了开发者的一定良性意图，防止系统由于误操作彻底崩溃。然而，风险点在于：1. 该脚本会直接修改系统的 /etc/passwd 文件，这种操作具有破坏性，如果注入失败或权限配置异常，可能导致合法用户无法登录；2. 脚本最后尝试执行 'su haxor'，在自动化测试环境中可能会导致交互挂起。对于此类涉及内核或关键系统配置修改的 POC，建议在完全隔离的沙箱或虚拟机中运行。代码中未发现隐藏的反弹 shell 或窃取环境变量的恶意逻辑，其行为完全符合其宣称的提权功能说明，但使用者仍需警惕那些通过修改脚本中的 openssl 哈希值来植入特定后门的变种。在本案例中，提供的内容是安全的防御研究样本。

**项目地址:** 本地存储路径: /tmp/vulnwatchdog_3374547aca1c5d2e09f9fd64f8addbbb/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
