## CVE-2025-32463 - Sudo 权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 <= sudo <= 1.9.17

**利用条件:** 本地低权限用户访问，目标系统启用了sudo的chroot功能（-R/--chroot选项）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Sudo在处理-R（--chroot）参数时存在逻辑漏洞。当用户指定一个受其控制的目录作为chroot环境时，Sudo未能正确限制动态库的加载路径，导致其在提权至root后，仍会从该恶意目录中读取/etc/nsswitch.conf。由于nsswitch机制会根据配置文件动态加载相应的.so库（如libnss_files.so），攻击者可以通过构造一个恶意的nsswitch配置文件，并将恶意编译的动态库放置在对应路径。当Sudo执行时，会以root权限加载并运行该恶意库中的初始化函数或构造函数。目前公开的POC详细说明了如何构建这种伪造的根目录结构，并验证了通过劫持NSS库实现从普通用户到root的权限跳跃。该POC利用逻辑闭环，在受影响的版本（1.9.14至1.9.17）上具有极高的成功率。利用步骤：1. 攻击者在用户可写目录（如/tmp）下创建一个伪造的根文件系统结构，包括etc和lib目录。2. 在etc目录下编写恶意的nsswitch.conf，指定一个虚假的解析服务名。3. 编写一个包含恶意payload（如/bin/sh提权代码）的C源文件，利用__attribute__((constructor))确保在库加载时立即执行。4. 将其编译为对应服务名的动态库（.so文件）并放置在伪造的库目录下。5. 执行sudo -R /tmp/fake_root任意命令。6. Sudo在切换到root权限后读取fake_root中的配置，触发恶意库加载，从而弹出root shell。投毒风险分析：该漏洞相关的POC多见于安全研究社区（如奇安信攻防社区、先知社区等），代码透明度较高。目前分析的POC主要侧重于漏洞原理的复现，代码结构清晰，使用的均是标准的Linux系统调用和GCC编译命令，未发现明显的恶意混淆或外部C2服务器连接。然而，由于该漏洞属于高价值的本地提权漏洞，且利用门槛相对较低，市场上可能出现伪装成一键自动化利用脚本的投毒样本。此类投毒脚本可能在执行提权逻辑的同时，静默向/root/.ssh/authorized_keys添加攻击者的公钥，或者在编译过程中植入持久化后门。建议防御者在分析此类POC时，重点关注Makefile文件或一键执行Shell脚本中是否存在非必要的curl/wget行为，以及编译产生的动态库是否包含非预期的系统调用。本次分析的代码示例主要为教学和验证性质，投毒风险处于低位，但在下载未经审核的二进制利用工具时仍需保持高度警惕。

**项目地址:** [https://xz.aliyun.com/news/18486](https://xz.aliyun.com/news/18486)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
