## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= sudo <= 1.9.17

**利用条件:** 攻击者需拥有目标系统的本地普通用户账号权限，且sudo版本在受影响范围内。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的分析报告和代码片段，该POC利用了Sudo在1.9.14版本中引入的chroot（-R）功能缺陷。其核心逻辑在于，当Sudo在用户指定的目录下执行chroot操作时，会错误地读取该目录下的/etc/nsswitch.conf文件。攻击者通过在受控目录下构造恶意的nsswitch.conf，并配合伪造的共享库（.so文件），可以诱导Glibc在Sudo以root身份运行时加载这些库。由于Sudo是SUID程序，加载攻击者控制的库会导致代码以root权限执行。此POC在受影响版本（如1.9.14至1.9.17）的Linux系统（如Ubuntu 22.04、Kali等）上具有极高的复现成功率。利用步骤：1. 在本地创建一个由用户完全控制的目录（如/tmp/fake_root）；2. 在该目录下建立etc子目录，并写入恶意构造的nsswitch.conf，将其中的数据库条目指向自定义名称（如'passwd: evil'）；3. 编写并编译一个恶意的动态链接库（如libnss_evil.so.2），并在其构造函数中写入提权Payload（如执行/bin/sh或chmod +s /usr/bin/bash）；4. 将编译好的库放置在fake_root下的lib目录中；5. 执行命令 'sudo -R /tmp/fake_root id'。此时，Sudo会切换根目录并读取恶意的配置文件，从而触发库加载并弹出root shell。投毒风险分析：该漏洞由于影响范围极广（几乎涵盖所有主流Linux发行版近两年的版本），目前在GitHub及各大安全社区（如FreeBuf、CSDN、奇安信社区）存在大量公开的POC和EXP。经过对当前主流POC的审查，大部分公开代码属于合法的安全研究范畴，代码逻辑透明，多使用标准C语言和Shell脚本编写，未发现大规模混淆或隐藏的恶意外部请求。然而，由于该漏洞属于提权类“核弹级”漏洞，部分不可信来源提供的所谓“一键利用脚本”存在极高风险。风险点主要集中在：1. 脚本通过curl/wget静默下载预编译好的二进制文件，这些文件可能被植入持久化后门（如Rootkit或反弹Shell）；2. 某些POC会修改系统的sudoers文件或SSH密钥，表面上是展示利用结果，实际上为发布者预留了访问通道；3. 混淆处理的Payload可能包含删除系统日志或加密文件的逻辑。组织在进行防御性研究时，应优先参考知名社区的分析文章，并对脚本中的库编译过程进行严格的代码审计，严禁直接运行未经审计的二进制利用包。

**项目地址:** [https://www.freebuf.com/articles/vuls/437488.html](https://www.freebuf.com/articles/vuls/437488.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
