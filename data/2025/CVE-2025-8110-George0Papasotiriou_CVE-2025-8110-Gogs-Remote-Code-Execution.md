## CVE-2025-8110 - Gogs 远程代码执行 (符号链接绕过/任意文件写入)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (符号链接绕过/任意文件写入)

**影响应用:** Gogs

**危害等级:** 严重

**CVSS评分:** 7.8

**影响版本:** Gogs <= 0.12.x (或Gogs版本低于0.13.0)

**利用条件:** 需要认证 (具有仓库推送权限)

**POC 可用性:** 4/10

**POC 类型:** 仅概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8110是一个影响开源自托管Git服务Gogs的严重远程代码执行漏洞。该漏洞的根源在于Gogs的PutContents API在处理符号链接时存在缺陷，导致攻击者可以通过精心构造的符号链接来绕过已有的安全修复（例如针对CVE-2024-55947的修复），进而重写服务器上的任意文件。最终，这使得经过身份验证的攻击者能够在目标服务器上执行任意代码。根据威胁情报，此漏洞已在野外被积极利用，导致大量公网暴露的Gogs实例遭到攻陷，构成了严重的安全威胁。

**POC有效性分析:**
提供的POC代码包，包括`README.md`、`bash.sh`和`exploit.py`，旨在演示Gogs服务上可能存在的远程代码执行能力。然而，在分析其与CVE-2025-8110的关联时，我们发现存在一个重要的不一致。根据公开的威胁情报和NVD描述，CVE-2025-8110的核心漏洞是Gogs的`PutContents` API中“符号链接处理不当”，这导致攻击者能够绕过安全限制并写入任意文件，最终实现远程代码执行。与之不同的是，POC包中的`README.md`文件将所演示的漏洞类型明确描述为“Git钩子机制中的命令注入”。

尽管两者都涉及Gogs服务（特别是Gogs版本低于0.13.0），且最终都可导致远程代码执行，但其攻击路径和利用机制明显不同。`exploit.py`脚本的功能主要是在本地文件系统上创建模拟的恶意Git `post-receive`钩子脚本。它并未涉及任何网络通信、对Gogs `PutContents` API的调用，也完全没有演示如何利用符号链接绕过漏洞来远程写入文件。脚本只是在本地路径`/tmp/malicious_repo/.git/hooks/post-receive`下创建文件，并写入一个简单的命令（如`id > /tmp/gogs_exploited`），然后赋予执行权限。

因此，该POC代码包**并未直接复现或利用CVE-2025-8110中“符号链接处理不当”这一具体的、导致任意文件写入的漏洞触发点。** 相反，它更侧重于演示**当攻击者已成功通过某种机制（例如CVE-2025-8110的任意文件写入）在Gogs服务器上植入恶意Git钩子脚本后，如何通过`git push`操作触发并执行这些脚本，从而实现最终的远程代码执行。** 简而言之，该POC是关于RCE的**最终有效载荷及其触发方式**的“概念验证”，而非关于CVE-2025-8110的**初始利用向量**的完整演示。它有助于理解攻击的后期阶段，但对于理解和防御符号链接绕过的初始攻击面而言是不完整的。

**利用步骤:**
要完全利用CVE-2025-8110，需要以下步骤：
1.  **认证获取：** 攻击者首先需获取受影响Gogs实例的有效用户认证凭据，并确保拥有对至少一个Git仓库的`push`权限。
2.  **符号链接绕过与文件写入：** 攻击者利用Gogs `PutContents` API中处理符号链接的漏洞。通过精心构造包含符号链接的请求，攻击者可以绕过Gogs的文件路径验证，实现对服务器任意文件（特别是目标仓库的`.git/hooks/`目录）的远程写入操作。此步骤是CVE-2025-8110的核心。
3.  **植入恶意Git钩子：** 攻击者将包含恶意Shell命令（例如反向Shell连接或任意系统系统命令）的脚本作为Git钩子（如`post-receive`或`update`）的内容，通过第二步的任意文件写入漏洞植入到目标仓库的`.git/hooks/`目录下，并确保其具有可执行权限。POC中的`bash.sh`和`exploit.py`中的`hook_content`即为此类恶意脚本的示例。
4.  **触发执行：** 一旦恶意钩子脚本被成功植入，攻击者只需向该受控仓库执行一次`git push`操作。Gogs服务器在处理此推送时，会自动执行已植入的恶意Git钩子脚本，从而在服务器上下文实现远程代码执行。
5.  **POC的定位：** 提供的`exploit.py`仅模拟了第3步中“植入恶意Git钩子”的本地准备过程，未包含第2步的关键远程利用逻辑。

**投毒风险分析:**
对提供的POC代码包进行全面审查后，评估其投毒风险为极低（10%）。这种低风险级别主要基于以下发现：
*   **代码透明且无混淆：** POC中的所有文件内容均以明文形式提供，易于阅读、理解和审计，不存在任何代码混淆或加密。
*   **功能意图明确：**
    *   `README.md`仅为文本描述，无执行风险。
    *   `bash.sh`是典型的Bash反向Shell脚本，作为漏洞利用后的Payload示例，其目的是演示命令执行效果，而非POC本身的恶意组件。代码逻辑直白。
    *   `exploit.py`是一个Python脚本，使用标准库（`os`, `subprocess`）在本地文件系统模拟创建恶意Git钩子文件，并写入测试命令（如`id`命令），然后赋予执行权限。其行为完全在预期范围内，用于演示钩子植入过程。
*   **无额外恶意行为：** 未发现POC代码有尝试下载外部恶意代码、与未知C2服务器通信（除了Payload本身）、收集敏感信息、植入持久化后门、或进行提权/横向移动等非预期恶意行为。其所有操作均局限于本地文件系统演示，且内容清晰。
综上，该POC代码包透明、目的明确，不包含任何恶意投毒成分，可安全用于合法的安全研究和测试。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110/
