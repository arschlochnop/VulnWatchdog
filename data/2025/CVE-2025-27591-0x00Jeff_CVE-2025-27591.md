## CVE-2025-27591 - Below (Facebook/Meta 监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook/Meta 监控工具)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 攻击者需拥有本地普通用户访问权限，且系统需安装有受影响版本的 below 监控程序。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 below 服务在早期版本中不安全地创建了 /var/log/below 目录。由于该目录被设置为全局可写（World-writable），本地攻击者可以利用竞争条件或预先删除该目录下的日志文件（如 error_root.log），并将其替换为一个指向敏感系统文件的符号链接（如 /etc/ld.so.preload）。当 below 服务以 root 权限运行（如通过 sudo 或定时任务启动）并尝试写入该日志或修改其权限时，攻击者利用符号链接劫持了写操作，从而使得原本只有 root 可写的文件变为全局可写。POC代码展示了一个完整的攻击链：首先通过脚本创建目录结构并诱导 below 运行产生日志，接着使用 `ln -s` 创建符号链接指向 `/etc/ld.so.preload`，最后通过 `timeout 0.5 sudo below record` 触发漏洞。由于 `ld.so.preload` 可以强制所有新启动的进程加载指定的共享库，攻击者随后写入一个预先编译好的恶意 `.so` 文件路径，从而在任何程序运行时注入代码，最终获取 root 权限。该 POC 逻辑清晰，利用方式在 Linux 环境下非常经典，且针对特定的安装包配置（如 Ubuntu, Arch 等）具有极高的成功率。 利用步骤：1. 本地用户登录系统。2. 检查 /var/log/below 目录是否存在或是否具有创建权限。3. 运行 compile.sh 编译包含后门或提权逻辑的 shared.so。4. 运行 exploit.sh：脚本会先删除原有的日志文件，建立到 /etc/ld.so.preload 的软连接。5. 脚本尝试运行 below 触发权限修改，使 ld.so.preload 变为攻击者可写。6. 攻击者将 shared.so 路径写入 ld.so.preload。7. 下一次任何特权程序运行时，恶意共享库将被加载，从而执行攻击者定义的提权操作（如反弹 shell）。 投毒风险分析：该 POC 整体代码透明度较高，主要的 exploit.sh 逻辑使用 Bash 编写，清晰可辨，未发现明显的恶意混淆或加密行为。编译脚本 compile.sh 仅调用 gcc 编译本地 code，不涉及下载外部恶意负载。其主要风险点在于提权后的自动化操作：脚本中提到了会将恶意共享库放入 /dev/shm 这一内存文件系统，这是黑客常用的隐匿手段。虽然该 POC 的核心目的是展示漏洞（Proof of Concept），但由于其提权过程非常高效且涉及修改系统全局预加载配置文件，如果使用者不了解 `ld.so.preload` 的危险性，可能会导致系统环境持续失稳或被其他攻击者二次利用。此外，由于该脚本来源于第三方个人仓库（BridgerAlderson），在真实对抗环境中，需要警惕此类脚本在后期更新中加入隐藏的回连指令。目前分析显示其投毒风险处于低水平（15%），属于正常的安全研究范畴，但建议在隔离的沙箱环境中进行验证，并在测试后务必手动清理 /etc/ld.so.preload 的内容，以防系统崩溃或残留安全隐患。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
