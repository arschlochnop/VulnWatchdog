## CVE-2025-55182 - React, Next.js 反序列化RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 反序列化RCE

**影响应用:** React, Next.js

**危害等级:** 严重

**CVSS评分:** 待定

**影响版本:** 受影响版本范围待定

**利用条件:** 无需认证，远程可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个React和Next.js框架中的反序列化远程代码执行漏洞，主要影响使用了React Server Components (RSC) 的应用程序。攻击者可以通过发送特制的Flight请求，利用不安全的反序列化机制在服务器端执行任意代码。该漏洞源于React Server Functions处理传入Flight请求的方式存在缺陷，允许攻击者通过构造恶意数据来触发原型污染，最终导致RCE。

**POC有效性分析：**
提供的POC包含两个主要脚本：`detect.sh`、`exploit-nextjs.sh`以及辅助脚本`nextjs-detect.sh`和`vite-detect.sh`（代码未提供）。`detect.sh`脚本用于检测目标是否易受攻击，它首先尝试使用`nextjs-detect.sh`检测Next.js应用的漏洞，然后使用`vite-detect.sh`检测Vite应用的漏洞。`exploit-nextjs.sh`脚本用于利用Next.js应用中的漏洞，它通过构造一个包含恶意payload的multipart/form-data请求，该payload利用原型污染来执行任意命令。

`exploit-nextjs.sh`脚本的工作原理如下：
1.  脚本接受目标URL和要执行的命令作为参数。
2.  脚本使用`sed`命令对命令进行转义，以防止注入攻击。
3.  脚本创建一个临时文件，用于存储multipart/form-data请求的原始body。
4.  脚本构造一个包含恶意payload的multipart/form-data请求。该payload包含三个部分：
    *   `0`：包含一个JSON对象，该对象利用`__proto__`属性进行原型污染，将`process.mainModule.require('child_process').execSync()`函数注入到`_response`对象的`_prefix`属性中。
    *   `1`：包含一个字符串`$@0`，该字符串将在服务器端被解释为命令参数。
    *   `2`：包含一个空数组。
5.  脚本使用`curl`命令发送multipart/form-data请求到目标URL。
6.  脚本输出HTTP响应代码。

从提供的POC代码来看，该漏洞利用过程较为直接，攻击者只需要发送一个精心构造的HTTP请求即可触发漏洞，无需进行复杂的身份验证或交互。Tenable的博客文章也提到，未经身份验证的远程攻击者可以通过向易受攻击的React Server Function端点发送特制payload来利用此漏洞。Google Cloud也发布了Cloud Armor WAF规则来检测和阻止与CVE-2025-55182相关的攻击尝试，这进一步证实了该漏洞的有效性和严重性。

**利用步骤：**
1.  运行`detect.sh`脚本，检测目标是否易受攻击。
2.  如果目标易受攻击，运行`exploit-nextjs.sh`脚本，指定目标URL和要执行的命令。
3.  脚本将发送一个包含恶意payload的HTTP请求到目标URL。
4.  如果利用成功，目标服务器将执行指定的命令。

**投毒风险分析：**
该POC的投毒风险较低，约为10%。主要原因如下：
*   POC代码相对清晰，没有明显的混淆或恶意行为。
*   POC主要使用标准的shell命令（如`sed`、`mktemp`、`curl`）和库函数，没有依赖外部脚本或可疑的第三方库。
*   虽然POC利用了原型污染漏洞来实现RCE，但其目的是为了验证漏洞的存在，而不是为了在目标系统上安装后门或执行其他恶意活动。
*   `exploit-nextjs.sh`脚本中的命令转义和临时文件清理机制也有助于降低投毒风险。

然而，仍然存在一些潜在的投毒风险：
*   攻击者可能会修改`exploit-nextjs.sh`脚本，以执行更具破坏性的命令，例如删除文件或窃取敏感数据。
*   攻击者可能会将POC代码与其他恶意代码结合起来，以创建一个更复杂的攻击工具。
*   如果攻击者控制了运行POC代码的系统，他们可能会利用该系统来传播恶意软件或执行其他恶意活动。

总体而言，CVE-2025-55182是一个严重的反序列化RCE漏洞，攻击者可以利用该漏洞在目标系统上执行任意代码。尽管提供的POC代码的投毒风险较低，但用户仍然需要采取适当的安全措施来保护其系统免受攻击。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
