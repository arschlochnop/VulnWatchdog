## CVE-2025-9074 - Docker Desktop 容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 本地运行的恶意Linux容器，无需认证即可访问Docker Engine API

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是Docker Desktop中发现的一个严重容器逃逸漏洞，CVSS评分为9.3。该漏洞允许在Windows或macOS系统上运行的恶意Linux容器，在未进行任何身份验证的情况下，通过默认子网192.168.65.7:2375直接访问Docker Engine API。这一缺陷绕过了Docker Desktop的安全隔离机制，包括增强容器隔离（ECI）设置和“Expose daemon on tcp://localhost:2375 without TLS”配置。该漏洞已于2025年8月20日在Docker Desktop 4.44.3版本中修复。

漏洞的技术细节在于，Docker Engine API被不安全地暴露在一个TCP套接字上，该套接字可从容器内部直接访问。这意味着，即使容器被设计为隔离环境，恶意容器也能利用这一暴露的API执行特权操作。在Windows系统上，由于Docker Desktop通常利用WSL（Windows Subsystem for Linux）作为其后端，成功利用此漏洞可导致攻击者完全接管主机系统并获得管理员权限。而在macOS系统上，攻击者可以操控容器并可能进行后门植入，但其影响可能受到用户提示的限制。值得注意的是，原生Linux系统上的Docker Engine不使用TCP套接字进行此种通信，因此不受此漏洞影响。

POC有效性分析：
提供的POC文档详细说明了一个Python脚本`exploit.py`的用法，该脚本旨在利用CVE-2025-9074漏洞。POC文档内容完整、清晰，包括漏洞概述、受影响版本、发现者以及详细的技术描述。它提供了两种主要利用模式：命令执行模式和反向Shell模式。
1. **命令执行模式**：攻击者可以通过指定Docker Engine API的URL（http://192.168.65.7:2375），并传递要执行的命令，直接在主机系统上运行任意命令。示例中展示了如何执行`whoami`、读取主机文件系统上的文件（如`/hostfs/mnt/c/Users/Administrator/Desktop/root.txt`）以及列出用户目录。这表明攻击者可以对主机文件系统进行读取和写入操作，并执行任意系统命令。
2. **反向Shell模式**：POC还支持建立一个反向Shell，使攻击者能够获得一个交互式Shell会话。这通常涉及在一个终端设置监听器（如`nc -lvnp 4444`），然后在另一个终端执行`exploit.py`脚本，指定监听IP和端口。一旦连接建立，攻击者即可完全控制主机，并且主机文件系统在`/hostfs`路径下可被访问。
POC的文档和示例代码（尽管只提供了命令行调用，未提供Python源代码）显示其功能完整且易于理解和复现。它明确指出了`pip3 install requests`作为前提条件，进一步验证了其可靠性和可用性。攻击流程图直观地展示了从恶意容器到完全主机控制的路径。因此，该POC被评估为高质量且功能完整的利用工具，评分为9/10。

投毒风险分析：
根据提供的POC `README.md`内容，本研究评估其投毒风险为低，设定为10%。理由如下：
1. **代码清晰度与描述**：`README.md`对漏洞的技术细节、攻击原理和利用方法进行了清晰、透明的描述。它明确指出利用的目标是Docker Engine API的未授权访问，并通过创建特权容器、挂载主机文件系统等方式实现主机控制。这些都是典型的容器逃逸漏洞利用手法。
2. **无恶意行为描述**：文档中未提及任何可能构成“投毒”的隐藏或额外恶意行为，例如在利用过程中植入后门、进行加密货币挖矿、下载额外恶意负载、或向外部C2服务器发送数据等。所有的操作都集中在实现漏洞描述的“容器逃逸和主机接管”这一核心功能上。
3. **标准库依赖**：POC明确指出了对`requests`库的依赖，这是一个广泛使用的HTTP客户端库，本身不具有恶意性。文档中未提及其他可疑的第三方库或外部脚本调用。
4. **源代码不可见性**：虽然实际的Python源代码未提供，无法进行直接的代码审计，但仅凭`README.md`的描述，其利用步骤是直接且可验证的。如果实际的`exploit.py`代码与`README.md`描述一致，则其投毒风险非常低。
综上所述，根据现有信息，该POC被设计为演示和利用CVE-2025-9074的合法安全工具，而非旨在传播恶意软件或进行其他未经授权的活动。防御性安全研究人员在实际使用此类POC时，仍应自行审查代码以确保其安全性。

**项目地址:** 

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-9074
