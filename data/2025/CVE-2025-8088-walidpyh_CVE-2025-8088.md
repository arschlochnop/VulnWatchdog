## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8

**影响版本:** 7.12 及以下版本

**利用条件:** 用户下载并解压攻击者构造的恶意RAR压缩文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码展现了极高的技术完成度和实用性。通过分析main.py脚本，可以看出攻击者利用了Windows NTFS文件系统的备用数据流（ADS）特性。代码逻辑清晰地展示了如何构建一个符合RAR5格式标准的压缩包，并巧妙地在第一个诱饵文件的文件头中植入路径遍历序列。POC能够自动化地重新计算RAR报文头部的CRC校验值，这确保了恶意压缩包在被WinRAR打开时不会触发‘压缩文件损坏’的警告。其核心有效性在于利用WinRAR在处理特定ADS流路径时的解析逻辑缺陷，允许攻击者将payload（如.exe或.cmd文件）写入用户的启动目录或系统关键目录。由于该POC支持多诱饵文件混淆，且完全符合RAR5协议规范，能有效绕过依赖静态特征扫描的传统杀软检测。利用步骤：首先，攻击者准备一个恶意负载文件（如Updaters.exe）和若干正常诱饵文件。接着，使用Python脚本运行‘python main.py <payload> <output.rar> --decoy <decoy_files>’。脚本会自动创建诱饵文件，并通过WinRAR命令行工具或底层字节流操作，将负载文件以‘filename:ads_name’的形式附加到诱饵文件上。关键步骤在于脚本会修改RAR文件头的目录项，插入路径遍历符（如..\..\），并将修改后的数据重新封装。最后，攻击者通过钓鱼邮件或即时通讯工具诱导受害者下载并解压该文件，解压动作会触发payload被写入预设的敏感目录。投毒风险分析：经过对提供的代码片段深度审计，该GitHub项目（walidpyh/CVE-2025-8088）目前的投毒风险处于低位。代码逻辑主要使用Python标准库（如os, struct, zlib）进行字节流操作，没有发现明显的代码混淆、远程Shell反弹、或窃取本地凭据的恶意行为。脚本中包含明确的教育用途声明和免责声明。然而，作为安全研究员需注意，此类POC具有极强的‘武器化’潜力。虽然脚本本身未投毒，但其生成的恶意RAR文件本质上就是一种攻击载荷。在实际防御场景中，应警惕该POC被二次包装。例如，攻击者可能在README中诱导用户运行某些未经过滤的二进制‘示例’，或者在复杂的Builder类中隐藏下载远程恶意二阶段Payload的指令。目前代码展示的是本地生成逻辑，未见网络外发请求，故判定投毒风险为15%，主要风险点在于其功能足以被直接用于恶意活动。

**项目地址:** [https://github.com/walidpyh/CVE-2025-8088.git](https://github.com/walidpyh/CVE-2025-8088.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
