## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12 (Windows版本)

**利用条件:** 需要用户交互（诱导用户下载并使用受影响版本的WinRAR解压恶意构造的RAR文件）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-8088是WinRAR中存在的一个严重的路径遍历漏洞，其核心原理在于利用了Windows NTFS文件系统的‘备用数据流’（Alternate Data Streams, ADS）特性。该漏洞允许攻击者构造一个特殊的RAR5格式压缩包，当受害者使用7.12或更早版本的WinRAR提取文件时，程序未能正确过滤带有ADS标识的文件名，导致攻击者可以将恶意文件（如.exe或.lnk）写入系统关键目录，例如用户的‘启动’文件夹（Startup）。POC有效性分析：提供的Python代码是一个高度自动化的Exploit构建工具。它通过`ADSRarBuilder`类实现，首先调用本地安装的WinRAR环境生成基础RAR5压缩包。关键逻辑在于`_patch_rar`函数，它通过二进制模式打开生成的RAR文件，精确定位文件头中的文件名标识，并将其替换为包含路径遍历序列（如`..\..\`）和ADS特定语法（`filename:streamname`）的恶意字符串。该POC还包含了CRC32校验和的自动重算逻辑，确保修改后的压缩包在WinRAR中不会报错。由于RAR5格式结构的复杂性，手动构造非常困难，该POC极大地降低了利用门槛。利用步骤：1. 准备payload文件（如木马程序）和诱饵文件。2. 运行脚本：`python main.py payload.exe out.rar --decoy decoy.txt`。3. 脚本会自动调用rar.exe打包，然后通过十六进制偏移修改文件头。4. 诱导目标使用旧版WinRAR解压。解压时，WinRAR会忽略路径限制，通过ADS特性将文件写入意想不到的物理位置。投毒风险分析：该POC代码本身表现出较高的专业性和透明度，属于典型的安全研究工具。风险评估为15%（低风险）。代码逻辑清晰，使用了标准的Python库（os, struct, zlib, argparse），未发现混淆处理、Base64加密的Payload或任何隐蔽的网络请求。脚本通过直接操作二进制流实现漏洞触发，所有行为均在本地文件系统完成。需要注意的是，此类高度自动化的EXP生成器极易被黑客修改。虽然目前的README声明仅用于教育目的，但在实际环境中，攻击者可能会克隆此仓库并加入恶意后门（例如在生成RAR的过程中向payload文件注入额外病毒，或在脚本运行阶段搜集本地WinRAR路径和系统信息）。防范措施应侧重于对POC脚本运行环境的隔离，以及对生成的二进制文件进行严格的静态分析。

**项目地址:** [https://github.com/walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
