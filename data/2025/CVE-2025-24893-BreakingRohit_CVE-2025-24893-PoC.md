## CVE-2025-24893 - XWiki RCE (远程代码执行)

**漏洞编号:** CVE-2025-24893

**漏洞类型:** RCE (远程代码执行)

**影响应用:** XWiki

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** XWiki <= 15.10.10

**利用条件:** 无需身份验证，可直接通过网络访问受影响的SolrSearch端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的POC代码和README文档显示，该漏洞利用了XWiki中SolrSearch组件对用户输入处理不当导致的服务器端模板注入（SSTI）。具体而言，攻击者通过在HTTP GET请求中构造恶意的Groovy脚本代码并发送至受影响的端点，XWiki的脚本引擎（Groovy）会由于缺乏必要的沙箱限制或输入验证，直接将该输入作为受信任的代码执行。该POC具备极高的有效性，因为它不仅提供了基础的漏洞检测（Check模式），还集成了反弹Shell（Reverse Shell）和绑定Shell（Bind Shell）功能，能够实现从探测到完全控制目标系统的全流程自动化。代码结构清晰，利用逻辑符合XWiki SSTI的历史漏洞特征（如CVE-2024-31982等类似模式），且明确指出了受影响的SolrSearch路径。利用步骤：首先，攻击者使用`-m check`参数扫描目标URL，通过执行简单的算术表达式（如${7*7}）并观察响应结果来确认漏洞存在。确认后，攻击者在本地启动监听程序（如nc -lvnp 4444），随后运行POC脚本，使用`-m reverse`参数并指定本地IP及端口。脚本会构造包含Java Runtime执行命令的Groovy Payload（例如使用`Runtime.getRuntime().exec()`），通过URL编码后发送至目标服务器。服务器解析请求并执行Payload，从而向攻击者主机建立反向连接。投毒风险分析：该POC来源于GitHub开源项目gunzf0x/CVE-2025-24893。经过对脚本逻辑的静态分析，其核心功能集中在生成恶意HTTP请求和处理命令行参数上。脚本使用了Python的标准库（如requests、argparse），未发现明显的代码混淆或加密后的Shellcode。虽然该工具的主要目的是为了合法的渗透测试和防御研究，但作为一款自动化攻击工具，其本身包含执行`nc`、`/bin/bash`等敏感操作的逻辑。风险点在于，如果用户从非官方或第三方镜像克隆此类POC，攻击者可能在脚本中潜伏恶意代码（如在建立反弹Shell的同时，将用户的SSH密钥上传至远程服务器）。目前该POC代码透明度高，逻辑直观，未发现隐藏的恶意行为或投毒特征，属于较低风险级别，但仍建议在受控的沙箱环境中使用。

**项目地址:** [https://github.com/gunzf0x/CVE-2025-24893](https://github.com/gunzf0x/CVE-2025-24893)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)
