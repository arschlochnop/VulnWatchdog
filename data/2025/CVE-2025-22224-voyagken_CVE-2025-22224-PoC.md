# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

# CVE-2025-22224

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22224-bronsoneaver_CVE-2025-22224.md](../2025/CVE-2025-22224-bronsoneaver_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #2

**来源**: [CVE-2025-22224-lacelruz_CVE-2025-22224.md](../2025/CVE-2025-22224-lacelruz_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件导致的权限提升

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 严重，可能导致从虚拟机逃逸并在主机上执行代码

**影响版本:** ESXi 8.0 (小于ESXi80U3d-24585383和ESXi80U2d-24585300), ESXi 7.0 (小于ESXi70U3s-24585291), Workstation 17.x (小于17.6.3), Cloud Foundation 5.x, 4.5.x, Telco Cloud Platform 5.x, 4.x, 3.x, 2.x, Telco Cloud Infrastructure 3.x, 2.x

**利用条件:** 需要虚拟机内的本地管理权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞态条件漏洞，会导致越界写入。攻击者利用该漏洞可以在主机上以虚拟机的 VMX 进程身份执行代码。从漏洞描述和搜索引擎结果来看，此漏洞影响广泛且危害严重，存在可用的 PoC 利用代码。

**有效性：**

提供的 PoC 代码描述了利用 VMX 进程中的 TOCTOU 漏洞，该漏洞发生在资源操作期间（例如，内存映射 I/O），由于在检查和实际使用之间未能重新验证访问控制，因此攻击者可以在验证后更改文件描述符或内存区域。PoC 通过两个线程同步利用此漏洞：一个线程重复触发虚拟机内的易受攻击的系统调用，另一个线程并发地竞相在检查之后、使用之前交换内存区域或文件描述符。这种竞争条件会导致主机 VMX 进程中损坏的指针解引用，从而允许攻击者覆盖敏感结构并提升权限。
根据漏洞信息和搜索结果，此漏洞的 PoC 是可用的，并且该 PoC 描述的利用方式与漏洞描述一致，因此该 PoC 代码的有效性较高。

**投毒风险：**

由于PoC代码提供的是一个链接，指向下载位置，因此存在较高的投毒风险。攻击者可能在PoC代码中植入恶意代码，例如反向 shell 或其他后门，从而在成功利用漏洞后进一步控制受害系统。即使提供的链接指向一个看似可信的存储库，该存储库也有可能被恶意用户控制，从而分发被篡改的 PoC 代码。
根据经验，通过链接下载的PoC代码存在更高的风险，因此投毒风险评定为 80%。

**利用方式：**

1.  攻击者需要在受影响的 VMware 环境中获得一个虚拟机的本地管理权限。
2.  攻击者需要在虚拟机内运行 PoC 代码，该代码会触发 VMX 进程中的 TOCTOU 漏洞。
3.  PoC 代码会利用竞态条件，在 VMX 进程执行检查后、使用资源前更改资源（例如，内存区域或文件描述符）。
4.  成功的利用会导致 VMX 进程中的越界写入，允许攻击者覆盖敏感数据结构。
5.  通过覆盖这些数据结构，攻击者可以提升权限，并在主机上以 VMX 进程的身份执行任意代码，从而实现虚拟机逃逸。

**项目地址:** [lacelruz/CVE-2025-22224](https://github.com/lacelruz/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #3

**来源**: [CVE-2025-22224-takerishunte_CVE-2025-22224.md](../2025/CVE-2025-22224-takerishunte_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU竞态条件导致权限提升

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU竞态条件

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致客户机逃逸和主机权限提升

**影响版本:** ESXi 8.0 < ESXi80U3d-24585383, ESXi 8.0 < ESXi80U2d-24585300, ESXi 7.0 < ESXi70U3s-24585291, Workstation 17.x < 17.6.3

**利用条件:** 需要在虚拟机内具备本地管理权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU (Time-of-Check Time-of-Use) 竞态条件漏洞，会导致越界写入。具有虚拟机本地管理权限的恶意攻击者可以利用此问题以主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性:**
根据漏洞描述和搜索结果，该漏洞利用PoC是存在的，并且已经被CISA添加到已知被利用的漏洞列表中，因此该漏洞利用的有效性较高。

**投毒风险分析:**
PoC 代码通过 TinyURL 提供下载链接。这本身就带来了一定的风险，因为无法直接审查代码。此外，PoC利用竞态条件，这使得漏洞利用本身具有一定的不稳定性，也为潜在的投毒代码提供了隐藏空间。虽然PoC描述中没有明确的恶意行为，但考虑到攻击者控制主机执行代码的能力，不排除存在潜在的后门或恶意代码的可能性，PoC链接被投毒的可能性估计为20%。

**利用方式:**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 版本的虚拟机内获得本地管理权限。
2.  攻击者在虚拟机内运行 PoC 漏洞利用程序。
3.  PoC 程序利用 VMX 进程中的 TOCTOU 漏洞，通过竞态条件竞争来修改内存区域或文件描述符，从而导致越界写入。
4.  攻击者利用越界写入，在主机上运行的 VMX 进程中覆盖敏感数据，从而获得在主机上执行任意代码的权限。
5.  成功利用漏洞后，攻击者可以在主机上以 root 权限执行任意命令，从而完全控制主机。

**项目地址:** [takerishunte/CVE-2025-22224](https://github.com/takerishunte/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #4

**来源**: [CVE-2025-22224-takeshirisulu_CVE-2025-22224.md](../2025/CVE-2025-22224-takeshirisulu_CVE-2025-22224.md)

## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---

## POC #5

**来源**: [CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md](../2025/CVE-2025-22224-voyagken_CVE-2025-22224-PoC.md)

## CVE-2025-22224-VMware VMX TOCTOU 漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸，在宿主机上执行代码

**影响版本:** ESXi 7.0/8.0受影响版本，Workstation 17.x 受影响版本

**利用条件:** 需要虚拟机内的本地管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，它会导致越界写入。具有虚拟机本地管理员权限的恶意行为者可以利用此漏洞，以在宿主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个 VMware 产品，并且已被 CISA 加入 KEV 列表，表明该漏洞已被积极利用。提供的 POC 代码仓库名称为 `CVE-2025-22224-PoC`，且描述为 `Privilege Escalation via TOCTOU in VMware VMX (CVE-2025-22224)`，表明存在可用的 POC 代码。

**投毒风险：**
POC 代码仓库目前只包含一个 README.md 文件，无法直接评估其投毒风险。考虑到通常 PoC 会附带漏洞验证及利用代码,此 PoC 验证代码可能存在恶意的后门或植入行为。如果后期代码仓库更新添加了二进制文件或其他可执行代码，则投毒风险将大大提高。目前仅从 README.md 文件来判断，投毒风险较低，估计为 10%。

**利用方式：**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 上的虚拟机中获得本地管理员权限。
2.  利用 TOCTOU 漏洞，在检查和使用某资源之间的时间差内，修改该资源的状态。
3.  通过精心设计的攻击，造成越界写入。
4.  最终，攻击者可以在宿主机上运行的虚拟机的 VMX 进程的身份执行任意代码，实现虚拟机逃逸和宿主机控制。

**项目地址:** [voyagken/CVE-2025-22224-PoC](https://github.com/voyagken/CVE-2025-22224-PoC)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)

---



---



---



---



---



---

