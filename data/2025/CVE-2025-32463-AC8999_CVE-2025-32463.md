## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 具有本地普通用户访问权限，目标系统安装了受影响版本的Sudo并允许运行带有chroot参数的sudo指令

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Sudo在处理chroot选项（-r或--chroot）时，对非可信控制目录下的配置文件处理不当。自1.9.14版本引入的chroot机制在切换根目录后，依然尝试加载由用户控制目录下的/etc/nsswitch.conf。由于该文件定义了系统如何检索密码、组等信息，攻击者可以通过提供一个恶意的nsswitch.conf并配合特定的共享库实现提权。提供的Python POC通过自动化创建临时的chroot环境，生成恶意的C源码并编译为共享对象（libnss_/woot1337.so.2）。当Sudo以root权限运行并读取被修改的nsswitch.conf时，会自动触发__attribute__((constructor))修饰的woot函数。该函数调用setreuid(0,0)和setregid(0,0)重置权限，最终通过execl弹出root shell。此POC逻辑清晰，直接利用了动态链接器的库加载机制，在实验环境下具有极高的成功率。利用步骤：1. 在本地创建临时工作目录。2. 构造伪造的目录结构（如woot/etc），并写入恶意的nsswitch.conf。3. 编写C语言代码，实现setreuid(0,0)及执行/bin/sh的逻辑。4. 使用gcc将C代码编译为符合NSS命名规范的动态链接库。5. 执行带有--chroot指向伪造目录的sudo命令。6. 触发库加载，获得root shell。投毒风险分析：该脚本虽然包含外部推广链接（YouTube频道），但其核心逻辑使用了Python标准库（os, sys, tempfile, subprocess）和GCC编译器，代码透明度较高。脚本中主要的可疑点在于其动态编译和执行逻辑，这是PoC功能的必要组成部分，并非针对研究者的恶意行为。然而，脚本中存在未完全显示的后续部分，且包含针对HTB（Hack The Box）实验室的适配，意味着在未知来源下载此类脚本时需警惕。投毒风险主要体现在三方面：首先，代码包含硬编码的YouTube推广，这类脚本往往会被二次修改嵌入反弹Shell。其次，由于脚本涉及gcc编译过程，攻击者可以在Makefile或编译指令中注入隐藏的恶意指令。最后，虽然目前看到的逻辑是安全的，但由于脚本会修改本地文件系统并运行sudo，若被投毒，攻击者可能在提权过程中将研究者的机器变为僵尸网络的一部分。目前该特定POC投毒风险处于低至中等水平（15%），属于正常的安全研究分享范畴。

**项目地址:** [https://github.com/mirch/sudo-chwoot](https://www.google.com/search?q=https://github.com/mirch/sudo-chwoot) (基于搜索结果推导)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
