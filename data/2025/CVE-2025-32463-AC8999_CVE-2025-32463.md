## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地普通用户访问权限，且目标系统安装了受影响版本的 Sudo

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是Sudo在1.9.14版本中引入的一个逻辑漏洞，主要存在于处理‘--chroot’（或‘-R’）选项的代码逻辑中。Sudo在执行chroot操作后，由于对环境隔离和加载机制的处理不当，导致系统在进入受限环境后，依然会尝试从用户可控的目录下加载配置文件（如/etc/nsswitch.conf）。分析提供的Python POC代码发现，其逻辑非常清晰且具有高度可执行性：首先，它创建了一个临时目录作为伪造的根环境（Staging Directory），并在该目录下构建了虚假的/etc目录；其次，它编写并编译了一个C语言共享对象（.so文件），该文件利用‘**attribute**((constructor))’属性，在库加载时即调用setreuid(0,0)尝试获取Root权限；最后，POC通过修改伪造环境中的nsswitch.conf，将Name Service Switch重定向到恶意的.so文件，并诱导Sudo在chroot模式下加载该库。代码展示了完整的攻击链条，通过NSS劫持（NSS Hijacking）配合Sudo对chroot路径校验的缺失，实现了从低权限用户到Root权限的跃迁。此POC针对HTB等实验室环境编写，逻辑标准，未见明显的混淆或无效逻辑，有效性极高。【利用步骤】1. 在本地创建一个攻击者可写的目录作为chroot的目标路径；2. 在该目录下创建/etc/nsswitch.conf，并配置特定的服务（如passwd）指向恶意的so库名；3. 编写C代码，在构造函数中执行提权命令（如/bin/sh），编译为对应的共享库文件并放置在加载路径下；4. 执行‘sudo -R /path/to/malicious/dir <command>’，触发Sudo加载恶意库，从而执行高权限Payload。【投毒风险分析】经过深入的代码审计，该POC代码表现出较低的投毒风险。代码主要使用Python标准库（os, sys, subprocess, shutil, tempfile）构建，逻辑透明且具备良好的日志记录（logging）。其核心载荷部分（woot1337.c）的功能非常单一，即典型的权限提升并启动Shell，不存在隐蔽的网络通信、磁盘加密或凭据回传等恶意后门行为。虽然POC头部提到了Youtube频道，但这属于常见的安全研究员推广行为，并非恶意攻击。脚本中对‘gcc’的调用和对临时目录的处理符合常规漏洞利用验证逻辑。需要注意的是，尽管此脚本本身安全，但在生产环境或不可信的开源仓库中，攻击者可能通过修改‘libnss_’相关路径或注入隐蔽的下载指令（如使用requests库）来实施投毒。当前版本未发现此类异常，建议在隔离的沙箱或虚拟机环境中进行防御性测试。其投毒风险评级为10%，主要是指此类自动化提权脚本在未经审计的情况下被直接运行可能带来的潜在系统破坏风险，而非恶意后门风险。

**项目地址:** [https://github.com/Stratascale-CRU/CVE-2025-32463](https://www.google.com/search?q=https://github.com/Stratascale-CRU/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
