## CVE-2025-32463 - Sudo (sudo-chroot / sudo-host) 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo (sudo-chroot / sudo-host)

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 版本 1.9.16p2 及其之前的版本，特定受影响系统包括 Ubuntu 20.04 LTS, Debian 10, CentOS 7, Fedora 34

**利用条件:** 攻击者必须拥有目标系统的低权限访问权限（本地用户），且系统配置了受影响的 sudo 策略（如 chroot 或相关限制）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

CVE-2025-32463 是一个存在于 Sudo 程序中的本地权限提升漏洞。该漏洞的根源在于对用户输入的验证不当，特别是在处理 `sudo chroot` 相关的逻辑时，未能正确隔离或过滤路径参数，导致攻击者可以绕过预设的安全限制。POC有效性分析：提供的 Dockerfile 明确指定了受影响的 sudo 版本（1.9.16p2），这为漏洞复现提供了标准化的环境。PoC 代码包含一个名为 `sudo-chwoot.sh` 的 Shell 脚本以及对应的 C 源码 `exploit.c`。通过在隔离的 Docker 容器中编译并运行该程序，可以观察到攻击者从普通用户 `pwn` 提升至 `root` 权限。利用步骤：首先，使用 Docker 部署提供的漏洞环境；其次，进入容器内部切换到普通用户；然后，通过 `gcc` 编译 `exploit.c` 源码生成二进制执行文件；最后，运行该利用程序。该程序会触发 `sudo` 内部的逻辑错误，利用路径遍历或错误的 chroot 引用执行特权指令。投毒风险分析：该项目虽然提供了详细的复现步骤，但在 README 中引导用户访问外部链接（如 GitHub Releases 中的 tar.gz 包）下载预编译文件，而非直接通过透明代码运行，这构成了主要的投毒风险点。投毒风险分析（400-600字）：虽然该存储库的代码结构看起来相对标准，但安全研究员需保持警惕。首先，README.md 中包含指向特定 GitHub 用户（如 yeremeu）的 Release 链接，这类预编译的二进制文件（CVE-2025-32463.tar.gz）属于‘黑盒’，极易包含恶意逻辑，如反弹 Shell 或植入后门。在防御性研究中，严禁直接运行从未经审计的 Release 页面下载的编译产物。其次，搜索结果显示该漏洞在 2025 年 7 月左右被广泛讨论，部分博文提到的 Rust 实现或 Shell 脚本（如 sudo-chwoot.sh）虽具有较高的教育价值，但也容易被威胁行动者利用作为‘投毒’媒介，通过诱导安全人员下载‘一键复现脚本’来实现对安全人员主机的反向渗透。代码分析显示其 Dockerfile 使用了标准的官方镜像，基础构建逻辑较为清晰，未发现明显的代码混淆（Obfuscation）或可疑的 eval 调用，因此代码层面的直接投毒风险处于低至中等水平（25%）。然而，考虑到此类高价值 LPE 漏洞常被用于供应链攻击，建议仅在受控的沙箱环境中审计源码并自行编译。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
