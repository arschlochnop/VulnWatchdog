## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有受影响系统上的低权限本地用户访问权限，且sudo配置允许执行特定具有--chroot选项的命令或特定配置环境。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

POC有效性分析：根据提供的搜索结果和代码片段，CVE-2025-32463是一个存在于Sudo组件中的严重安全缺陷。漏洞的核心在于1.9.17p1版本之前的Sudo在使用--chroot参数时，会错误地加载受用户控制目录下的/etc/nsswitch.conf文件。在典型的Linux提权原语中，对nsswitch.conf的控制意味着攻击者可以诱导受影响的进程（此处为具有root权限的sudo进程）加载伪造的共享库（如通过自定义的passwd或group插件）。输入的Dockerfile显示了一个明确的复现环境，使用Ubuntu 24.04并手动编译了易受攻击的1.9.16p2版本，这证明了研究者已经确证了漏洞的存在性。POC脚本sudo-chwoot.sh利用了chroot环境下的路径解析缺陷，通过在用户可写的目录中构建虚假的配置环境，强制sudo加载恶意库，从而实现从普通用户到root用户的权限提升。该漏洞的有效性极高，因为sudo是Linux系统的核心组件，且该利用路径绕过了传统的sudoers策略限制。利用步骤：1. 在目标系统上创建一个攻击者可控的目录结构，模拟根目录。2. 在该伪造根目录的etc/目录下放置一个恶意的nsswitch.conf文件。3. 编写一个恶意的共享库（.so文件），并将其放置在nsswitch.conf指向的路径中，该库应包含执行/bin/sh或提权的代码。4. 执行sudo命令并配合--chroot参数指向该目录。5. 系统将以root权限加载恶意库，完成提权。投毒风险分析：该POC仓库存在中等程度的投毒风险。虽然Dockerfile展示了透明的构建过程，但README.md引导用户从外部链接（GitHub Releases）下载预编译的二进制文件或压缩包（CVE-2025-32463.tar.gz），而不是直接在仓库中展示核心利用代码。这种‘引导外部下载’的行为是典型的投毒特征，因为Release中的二进制文件可能包含未经审查的后门、远控木马或窃取凭据的脚本。此外，README中提到的编译步骤‘gcc exploit.c -o exploit’与仓库根目录下显示的脚本名‘sudo-chwoot.sh’不完全一致，这种文档与代码的不匹配增加了混淆。防御性研究员在分析此类POC时，必须严禁直接运行任何来自Release页面的二进制文件。虽然漏洞本身是真实的，但分发渠道可能已被劫持用于针对安全研究人员的供应链攻击，建议仅在隔离的沙箱环境中使用自行编译的源代码进行验证。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
