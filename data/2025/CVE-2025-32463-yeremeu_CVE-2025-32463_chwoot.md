## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 具有本地低权限用户访问权限，系统安装了受影响版本的 Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2025-32463 是 Sudo 程序中存在的一个严重本地权限提升漏洞。该漏洞的根源在于 Sudo 在处理 `--chroot` 参数时，未能正确隔离或验证受控目录下的 `/etc/nsswitch.conf` 配置文件。根据提供的搜索结果和 POC 代码分析，该漏洞的利用逻辑非常清晰且具有高度可行性。POC 代码（sudo-chwoot.sh）通过创建一个用户可控的目录结构，并在该目录中伪造系统关键配置文件（如 nsswitch.conf 和相关的共享库），诱导以 root 权限运行的 sudo 进程加载攻击者恶意构造的库文件。在 Dockerfile 中可以看到，环境被配置为安装受影响的 sudo 1.9.16p2 版本，这证明了漏洞环境的可复现性。利用脚本能直接从低权限（lowpriv）环境跳转到 root shell，展示了极高的有效性。通过 Rust 实现的版本进一步说明该漏洞利用已进入成熟阶段，不仅限于简单的 Shell 脚本，还支持更隐蔽、更高效的二进制实现。该漏洞利用不依赖复杂的堆栈溢出或内存布局，而是基于逻辑路径处理缺陷，因此在不同 Linux 发行版（Ubuntu, Debian, CentOS）上的成功率极高，属于高价值且极其稳定的利用代码。【利用步骤】1. 准备阶段：在本地系统创建临时工作目录；2. 构造环境：在工作目录下模拟 root 根目录结构，特别是创建 etc 目录并放置伪造的 nsswitch.conf；3. 放置 payload：将编译好的恶意共享库放置在特定路径，该库包含执行 /bin/bash 的初始化函数；4. 触发漏洞：执行命令 `sudo --chroot [工作目录] -u [任意用户] [任意命令]`；5. 权限获取：由于 sudo 加载了攻击者控制的 nsswitch 配置及对应的恶意库，此时将以 root 权限执行 bash，从而完成提权。【投毒风险分析】该 POC 虽属于高质量的漏洞研究资源，但也存在中低程度的投毒风险。首先，README 中提供的链接指向了外部 Release 下载页面（[github.com/yeremeu/](https://www.google.com/search?q=https://github.com/yeremeu/)...），此类预编译的二进制文件是投毒的高发区，防御者在未经审计的情况下运行这些 binary 可能导致机器被植入后门。其次，搜索结果中提到的『Rust 实现』和『一键利用脚本』虽然提升了研究效率，但也降低了攻击门槛，容易被恶意人员二次打包。在 POC 分析中发现，尽管 Dockerfile 逻辑透明，但外部引用的 `sudo-chwoot.sh` 若从非官方源下载，可能包含额外的混淆指令。目前分析来看，代码主要集中在漏洞验证逻辑，尚未发现明显的恶意回连或文件破坏行为，但由于其广泛的影响范围，建议安全研究员在隔离的虚拟机或容器环境中进行测试，并严格审查 `Makefile` 或 `run.sh` 等自动化脚本中的远程拉取行为，以防供应链投毒风险。

**项目地址:** [https://github.com/pr0v3rbs/CVE-2025-32463_chwoot](https://github.com/pr0v3rbs/CVE-2025-32463_chwoot)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
