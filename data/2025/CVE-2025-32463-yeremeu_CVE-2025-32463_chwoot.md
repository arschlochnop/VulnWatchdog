## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1 (特别是 1.9.16p2 及更早版本)

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Sudo在处理配置加载时，错误地允许从用户可控目录读取/etc/nsswitch.conf文件。提供的POC代码包含一个Dockerfile，通过编译安装受影响的Sudo版本（1.9.16p2）来构建实验环境，这表明该POC具有极高的真实性和可重现性。Readme文档中提到的利用步骤包括编译exploit.c文件并运行，这通常涉及到利用环境变量或符号链接欺骗Sudo加载恶意库或配置文件。经分析，该漏洞的成因是Sudo在初始化过程中对搜索路径的验证不严，导致权限极低的本地用户可以注入恶意的名称服务切换配置，进而劫持身份验证流程并以root身份执行任意命令。此POC不仅提供了理论说明，还通过容器化技术固化了攻击环境，对于安全防御研究具有很高的参考价值，能有效验证系统补丁的有效性。

利用步骤：1. 在测试环境中使用Dockerfile构建镜像，确保环境隔离。2. 切换到普通用户权限。3. 编写或提取exploit.c代码。4. 使用gcc进行编译，生成名为exploit的可执行文件。5. 执行该程序，通过操纵本地目录结构和nsswitch.conf内容，引导Sudo加载非预期的库。6. 成功触发后，当前Shell将提权至root权限。

投毒风险分析：该POC项目来源于GitHub，虽然代码主体表现为标准的安全研究工具，但README中引导用户前往'Releases'页面下载二进制文件（CVE-2025-32463.tar.gz）的行为存在一定的投毒风险。在威胁情报实践中，攻击者常利用高流行CVE的POC名义分发捆绑了恶意后门的二进制工具。虽然Dockerfile本身使用了官方Ubuntu镜像和sudo.ws的源码包，属于清洁操作，但由于Readme中未提供核心exploit.c的源码正文，而是诱导下载，这增加了供应链污染的可能性。经过对仓库元数据的初步审查，目前尚未发现明显的混淆脚本，但建议研究人员仅在受控沙箱内运行下载的二进制文件，或优先审计Dockerfile中拉取的远程资源。整体投毒风险评级为15%，属于较低水平，但需警惕'Release'中的预编译程序。

**项目地址:** [https://github.com/yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
