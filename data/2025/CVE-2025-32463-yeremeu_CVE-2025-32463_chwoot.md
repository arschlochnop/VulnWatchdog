## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞允许本地用户通过利用`--chroot`选项结合用户可控的`/etc/nsswitch.conf`文件获得root权限。该漏洞的核心在于Sudo在chroot环境下对nsswitch.conf文件的处理不当，允许攻击者加载恶意NSS模块，从而执行任意代码并提升权限。

POC有效性分析：

提供的POC代码（Dockerfile和sudo-chwoot.sh）提供了一个完整的漏洞利用链。Dockerfile用于构建一个包含易受攻击的Sudo版本的Ubuntu环境。该环境简化了漏洞的复现和分析。sudo-chwoot.sh脚本则包含了实际的利用代码，它创建一个伪造的chroot环境，构建一个恶意的NSS模块，并使用sudo -R触发漏洞。通过执行该脚本，攻击者可以获得root权限。POC的质量很高，因为它提供了一个可直接运行的exploit，并且包含了详细的说明文档。

利用步骤：

1.  构建包含易受攻击的Sudo版本的Docker镜像。
2.  运行Docker容器并进入容器的shell。
3.  将sudo-chwoot.sh脚本复制到容器中的pwn用户的home目录。
4.  切换到pwn用户。
5.  运行sudo-chwoot.sh脚本。
6.  脚本将创建一个伪造的chroot环境，构建一个恶意的NSS模块，并使用sudo -R触发漏洞，从而获得root权限。

投毒风险分析：

该POC的投毒风险较低。首先，POC代码（sudo-chwoot.sh）主要由shell脚本组成，代码清晰易懂，没有明显的混淆或隐藏恶意行为。其次，POC主要使用了标准的Linux工具和库，例如gcc, make, tar等，没有引入任何可疑的第三方依赖。最后，POC的目的是利用已知的Sudo漏洞进行提权，而不是植入后门或进行其他恶意活动。

但是，仍然存在一定的投毒风险。攻击者可能会修改POC脚本，例如，在NSS模块中添加恶意代码，或者在提权后执行其他恶意操作。此外，攻击者还可能将POC代码与其他恶意软件捆绑在一起，从而传播恶意软件。因此，在使用该POC时，必须仔细审查代码，确保其安全性。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
