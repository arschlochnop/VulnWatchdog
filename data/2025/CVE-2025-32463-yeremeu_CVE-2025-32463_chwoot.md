## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有低权限本地用户访问权限，且sudo版本在受影响范围内，允许执行带有--chroot选项的sudo命令或相关配置。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于Sudo 1.9.17p1之前的版本中。其根本原因在于sudo在处理--chroot参数时，会加载并使用来自用户受控目录中的/etc/nsswitch.conf文件，导致本地攻击者可以控制系统的名称服务转换机制，进而加载恶意的共享库。通过提供的Dockerfile和README信息分析，该POC具有极高的有效性。Dockerfile明确指定了编译受影响版本sudo-1.9.16p2的过程，这为漏洞验证提供了标准化的沙盒环境。POC脚本sudo-chwoot.sh通过模拟非特权用户（pwn）在指定目录下构造伪造的配置文件，并利用sudo执行时的逻辑缺陷实现提权。该利用链条清晰，包含了环境搭建、目标编译、利用脚本执行及权限验证（id命令输出uid=0），属于成熟且可复现的利用代码。【利用步骤】1. 环境搭建：使用提供的Dockerfile构建并运行容器，该容器会自动安装编译环境并编译安装受影响的sudo 1.9.16p2版本；2. 准备阶段：切换到低权限用户pwn，进入工作目录；3. 执行利用：运行sudo-chwoot.sh脚本。脚本会创建一个受控目录，在其中放置恶意的nsswitch.conf和精心构造的库文件；4. 触发漏洞：调用sudo命令并配合--chroot参数指向受控目录，迫使sudo在特权上下文中加载受控配置；5. 获取权限：漏洞触发后，攻击者将获得root Shell，可通过id命令确认权限提升结果。【投毒风险分析】本样本的投毒风险评定为15%，属于低风险范畴。其代码逻辑主要集中在合法的安全研究和环境构建。首先，Dockerfile使用的是官方镜像源（Ubuntu 24.04）和Sudo官方源码包（sudo.ws），未发现重定向到恶意镜像库的行为。其次，POC脚本sudo-chwoot.sh和README中提到的编译步骤属于标准的C/Rust开发流程，没有明显的混淆代码、Base64加密payload或异常的网络外联请求。虽然README中包含了一个指向GitHub Releases的外部链接，这是潜在的风险点，因为预编译的二进制文件可能被替换为恶意程序，但针对公开的源代码分析，其核心逻辑是透明的。安全研究人员在使用此类POC时，应坚持‘源码编译’原则，避免直接运行下载的二进制文件。总体而言，该项目更倾向于技术分享和防御性研究工具，而非用于传播后门的恶意投毒载体。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
