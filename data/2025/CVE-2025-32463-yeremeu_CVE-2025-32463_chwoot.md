## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有本地普通用户权限，且系统安装了受影响版本的Sudo，目标Sudo配置允许使用 --chroot 参数或存在特定的nsswitch配置缺陷。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

POC有效性分析：本漏洞源于Sudo在处理--chroot参数时，未能正确隔离或验证受用户控制目录下的配置文件（特别是/etc/nsswitch.conf）。根据提供的PoC代码和Dockerfile，研究者通过构建特定的Ubuntu 24.04环境并手动编译安装存在漏洞的Sudo 1.9.16p2版本进行验证。PoC的核心逻辑在于利用sudo执行命令时，若指定了--chroot到攻击者可控的目录，Sudo可能会加载该目录下的恶意nsswitch.conf文件，进而加载攻击者伪造的共享库（如动态链接库注入），从而在root权限下执行任意代码。搜索结果显示多个GitHub仓库（如kh4sh3i/CVE-2025-32463）已公开此类利用脚本，且在2025年7月已被确认为高频利用的高危漏洞。该PoC在实验环境下具有极高的成功率，因为它直接触及了Sudo对chroot环境信任边界的处理缺陷。利用步骤通常包括：1. 准备恶意共享库；2. 创建包含恶意配置文件的伪装根目录结构；3. 执行带有--chroot参数的sudo指令触发加载。投毒风险分析：该POC存在中等程度的投毒风险。首先，README文档中引导用户前往外部‘Releases’页面下载预编译的二进制文件（如CVE-2025-32463.tar.gz），这是典型的投毒诱导手段，因为二进制文件难以通过常规文本审查发现后门。其次，部分搜索结果（如结果3）指向的Shell脚本可能包含混淆指令或尝试从远程服务器下载未知载荷。在安全研究界，此类热门且易于利用的LPE漏洞常被攻击者利用，通过发布‘一键脚本’来感染研究者的主机。虽然Dockerfile展示了从源码编译的过程较为透明，但若用户直接执行仓库中的.sh脚本或下载Release中的成品，极易遭遇供应链攻击。建议防御者仅在隔离的沙箱环境中分析源码，严禁直接运行任何未审计的二进制利用工具。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
