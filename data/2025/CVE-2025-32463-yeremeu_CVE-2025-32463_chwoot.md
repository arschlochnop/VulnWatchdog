## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** High

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (例如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限，且系统安装了受影响版本的 Sudo。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞源于 Sudo 在处理 --chroot 选项时存在逻辑缺陷。当使用该选项时，Sudo 会从用户可控的目录中读取并加载 /etc/nsswitch.conf 配置文件，而非系统根目录下的安全配置。通过精心构造该配置文件并结合恶意的动态链接库或特定的名称服务插件，本地普通用户可以诱导 Sudo 以 root 权限执行任意代码。所提供的 Dockerfile 展示了高度的有效性：它使用了 Ubuntu 24.04 基础镜像，并手动编译安装了已知受影响的 1.9.16p2 版本。Dockerfile 中明确包含了创建普通用户 pwn 以及拷贝名为 sudo-chwoot.sh 的利用脚本。这种环境复现方式非常标准，证明该 POC 并非空穴来风，其利用逻辑符合 CVE-2025-32463 的公开描述，即通过劫持 chroot 环境下的配置实现提权。利用步骤通常涉及：1. 创建一个伪造的目录结构包含 /etc/nsswitch.conf；2. 在该配置中指定恶意的库路径；3. 执行带有 --chroot 参数的 sudo 命令触发加载。该 POC 脚本 sudo-chwoot.sh 很可能自动化了这一过程，从技术原理上看其成功率极高，是对研究人员非常有价值的参考。 【投毒风险分析】在对此 POC 项目进行评估时，虽然其核心逻辑（Dockerfile 和脚本名称）看起来是为了安全研究，但仍存在一定的投毒隐患。首先，README.md 中提供的外部下载链接（[github.com/yeremeu/CVE-2025-32463_chwoot/releases](https://github.com/yeremeu/CVE-2025-32463_chwoot/releases)）指向预编译的二进制文件或压缩包，这是威胁情报领域中常见的投毒向量。攻击者可能会在这些压缩包中植入后门或窃取信息的木马，特别是考虑到提权类 POC 的使用者通常具有较高的权限需求，极易成为针对性攻击的目标。其次，搜索结果中出现了指向非安全专业站点的链接（如 Dropbox 或 CHIP 等下载站点的混合信息），这暗示了该 CVE 相关的关键词可能正在被 SEO 投毒攻击利用，诱导用户下载虚假补丁。尽管 Dockerfile 本身通过标准编译流程构建 sudo 表现出较低风险，但如果 sudo-chwoot.sh 脚本内部包含混淆的 Base64 负载或尝试连接外部 C2 服务器，风险将显著上升。由于当前代码段中未显示脚本细节，综合 README 指向外部不可控下载点这一行为，判定其存在 15% 的中低度投毒风险，建议研究人员仅在隔离的沙箱环境中使用 Dockerfile 自行构建，切勿点击 README 中的外部发布链接或直接运行未审计的 shell 脚本。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
