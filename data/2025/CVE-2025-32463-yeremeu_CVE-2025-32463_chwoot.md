## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.16p2 (具体涉及chroot功能组件)

**利用条件:** 攻击者必须拥有目标系统的本地普通用户权限，且系统安装了受影响版本的Sudo。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是Linux Sudo组件中由于对chroot功能处理不当导致的安全缺陷。分析提供的PoC代码和搜索结果，发现该漏洞允许普通用户绕过安全限制并获得Root权限。PoC项目包含一个完整的测试环境（Dockerfile）和一个利用脚本（sudo-chwoot.sh）。Dockerfile明确指向了受影响的1.9.16p2版本，并通过wget下载源码进行编译，这证实了漏洞与该特定版本直接相关。利用脚本sudo-chwoot.sh被描述为可以实现‘woot! root’的效果。通过技术分析，该漏洞可能涉及sudo在执行chroot操作时，未正确清理或隔离环境变量及文件描述符，导致攻击者可以操纵chroot环境外的进程空间。PoC不仅提供了基础的漏洞触发逻辑，还包含了Rust实现的版本，这表明该漏洞具有稳定的利用路径，且在社区内已有多种语言的实现版本，验证了其在生产环境中的高危害性。脚本执行逻辑清晰，通过模拟受限环境并寻找突破点，能够稳定触发提权。此外，CSDN及GitHub上的讨论显示，该漏洞在最新的Ubuntu和Debian系统中均有体现，进一步印证了PoC的实战价值。

【利用步骤】1. 环境搭建：使用提供的Dockerfile构建一个基于Ubuntu 24.04的镜像，该镜像会自动安装存在漏洞的Sudo 1.9.16p2版本。2. 用户切换：进入容器并以普通用户‘pwn’的身份登录。3. 获取脚本：确保sudo-chwoot.sh脚本在用户目录下。4. 执行利用：运行命令`./sudo-chwoot.sh`。5. 权限验证：脚本运行完成后，观察输出，若出现‘root@prod:/#’提示符，则使用`id`命令确认UID是否为0。6. 替代方法：对于Rust版本，需先安装Rust环境，克隆仓库后使用`cargo build --release`编译，随后运行生成的二进制文件进行提权。

【投毒风险分析】该POC存在中等程度的投毒风险（约45%）。首先，README中引导用户通过外部链接（GitHub Releases）下载‘预编译二进制文件’，这是典型的风险信号，因为预编译文件可能被植入后门或木马。其次，搜索结果[4]提到了提供‘预编译二进制使用’，在安全界，直接运行不明来源的二进制文件极度危险。虽然Dockerfile本身显示了清晰的源码编译过程，是安全的，但README中指向的第三方Release页面（如yeremeu/CVE-2025-32463_chwoot/releases）并非Sudo官方仓库，且存在‘CVE-2025-32463.tar.gz’等打包文件。投毒者常利用高危漏洞的热度，在伪造的PoC脚本或编译好的Payload中加入反弹Shell或窃密脚本。由于此漏洞涉及Root权限，一旦PoC本身包含恶意逻辑，其对研究者系统的破坏将是彻底的。建议在分析此类PoC时，仅在完全隔离的沙箱环境中使用Dockerfile进行源码编译验证，严禁直接下载运行任何Release中的二进制程序，并重点审查.sh脚本中是否存在curl、base64等混淆的远程代码执行指令。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
