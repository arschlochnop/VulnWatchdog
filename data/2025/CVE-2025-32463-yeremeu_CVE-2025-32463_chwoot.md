## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具备目标系统的本地普通用户访问权限，且目标系统安装了受影响版本的Sudo。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

POC有效性分析：根据公开的搜索结果和提供的代码片段，CVE-2025-32463 是 Sudo 工具中的一个严重本地提权漏洞。该漏洞的核心在于 sudo 命令在处理 --chroot 参数时，未对用户控制目录下的 /etc/nsswitch.conf 配置文件进行严格校验。攻击者可以通过创建一个恶意的 chroot 环境，并在该环境的 /etc/nsswitch.conf 中配置恶意的 Name Service Switch (NSS) 模块（例如通过修改主机名查找或用户认证的动态库路径），诱导 sudo 加载攻击者控制的动态链接库，从而在 sudo 以 root 权限运行的环境中执行任意代码。搜索结果显示已有 Rust 实现的版本以及包含 Dockerfile 的测试环境，这表明 POC 的成熟度较高且易于复现。Dockerfile 清晰地展示了通过安装 sudo-1.9.16p2 版本来构建漏洞环境的过程，结合脚本 sudo-chwoot.sh，验证了利用逻辑的连贯性。此 POC 不仅是理论上的概念证明，更是一个接近生产级别的利用工具，能够稳定触发从普通用户到 root 权限的跃迁。利用步骤：1. 在本地系统中准备一个受攻击者控制的目录作为伪造的 chroot 根目录；2. 在该目录下的 etc 子目录中创建一个伪造的 nsswitch.conf 文件；3. 编译一个恶意的 .so 共享库，并将其放置在伪造目录的库加载路径中，确保其在加载时执行提权逻辑（如执行 /bin/bash）；4. 使用 sudo --chroot 指向该目录执行任意命令；5. 系统因加载了恶意的 NSS 配置文件而加载了攻击者的共享库，最终赋予攻击者 root shell。投毒风险分析：该漏洞相关的 POC 存在中等程度的投毒风险。首先，在搜索结果中发现了指向 GitHub Releases 页面下载预编译二进制文件的建议，这在安全研究中是极高风险的行为，因为二进制文件可能被嵌入后门、远控木马（RAT）或信息窃取程序。其次，虽然提供的 Dockerfile 表面上用于构建漏洞环境，但其下载 sudo 源码的链接若被劫持或指向非官方镜像，可能导致实验机器被渗透。利用脚本 sudo-chwoot.sh 的具体内容在输入中被截断，但 README 中提到的 'download required files' 引导用户从第三方个人仓库下载压缩包，这符合典型的投毒模式。攻击者往往利用此类高热度 CVE 的利用需求，发布看似正常的 Exploit 代码，实则在 shell 脚本中隐藏了 curl 下载远程恶意载荷或修改用户 .bashrc 的命令。研究人员在测试此类 POC 时，必须在完全隔离的沙箱环境中运行，并对所有 .sh 和 .c 源码进行逐行审计，严禁直接运行未经审计的预编译二进制文件或从非官方仓库下载的压缩包。

**项目地址:** [https://github.com/pr0v3rbs/CVE-2025-32463_chwoot](https://github.com/pr0v3rbs/CVE-2025-32463_chwoot)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
