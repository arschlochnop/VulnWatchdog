## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 本地普通用户访问权限，Sudo配置中支持--chroot选项

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于Sudo 1.9.17p1之前的版本中，核心缺陷在于其处理`--chroot`选项时的安全隔离失效。分析提供的POC代码和搜索结果发现，当用户执行带有`--chroot`参数的命令时，Sudo会错误地尝试从用户定义的受控目录中加载`/etc/nsswitch.conf`配置文件，而不是系统安全的根配置文件。这种行为允许本地低权限用户通过创建一个恶意的根目录环境，并在其中伪造`nsswitch.conf`及相关的共享库，从而诱导以root权限运行的Sudo进程加载不受信任的动态链接库。POC脚本通过构建受控目录结构，利用Glibc在解析NSS配置时的动态加载机制实现代码执行。由于Sudo在执行chroot之前或过程中未正确重置环境变量或锁定配置文件路径，导致了权限提升。该POC结构清晰，包含Dockerfile用于环境复现，展示了从普通用户`pwn`到`root`的完整路径，在满足版本条件的Linux发行版（如Ubuntu 24.04、1.9.16p2版本的Sudo）中具有极高的利用成功率。利用步骤如下：1. 创建用户可写的临时目录作为虚假的根环境。2. 在该目录下构造`/etc/nsswitch.conf`，指定恶意的库搜索路径。3. 编译并放置一个恶意的.so文件。4. 调用`sudo --chroot [路径] [命令]`触发漏洞。5. Sudo加载恶意库，执行预设的提权负载。 【投毒风险分析】该漏洞相关的公开资源存在中等程度的投毒风险。在分析提供的README和项目描述中，存在典型的社会工程学诱导特征。首先，部分搜索结果（如结果2和结果3）指向了非官方的GitHub仓库和第三方安全预警页面，其中包含了诱导用户点击并下载已编译二进制文件的链接。README中明确建议用户从“Releases section”下载文件，这在安全工具领域是极高风险的行为，攻击者常利用CVE的热度，在Release包中替换带有后门的二进制执行文件（如木马化的`exploit`程序）。其次，POC代码库中包含了复杂的构建脚本和预编译提示，这为恶意代码的植入提供了掩护。虽然Dockerfile本身看起来是用于合法的安全研究，但配套的`sudo-chwoot.sh`内容未完全披露，且提及的外部下载源可能存在中间人攻击或供应链污染的风险。此外，网络上已出现以该CVE命名的虚假仓库，利用安全研究人员急于测试的心态，诱导其在生产环境或高价值开发机上运行未经审计的shell脚本。鉴于Sudo漏洞的广泛影响力和极高的关注度，该漏洞相关的POC极易被黑产团队利用进行二阶段投毒，攻击者可能在Exploit代码中加入窃取系统凭据、反弹Shell或部署持久化Rootkit的逻辑。建议防御方仅在隔离的沙箱环境中以非特权用户身份审计源码，严禁直接运行任何来自非受信源的预编译Payload。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32463](https://avd.aliyun.com/detail?id=AVD-2025-32463)
