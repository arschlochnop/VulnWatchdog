## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 攻击者需拥有目标系统的本地普通用户访问权限，且 sudo 配置允许使用 --chroot 参数或相关环境。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的搜索结果和POC代码段，CVE-2025-32463是一个存在于Sudo组件中的严重本地提权漏洞。该漏洞的根源在于Sudo在处理带有'--chroot'参数的指令时，未能正确隔离用户控制目录下的配置文件（如/etc/nsswitch.conf）。通过在用户可控的目录下伪造恶意的nsswitch.conf文件并利用Sudo执行chroot操作，攻击者可以诱导Sudo加载恶意的动态链接库或更改用户查找逻辑，从而以root权限执行任意代码。提供的Dockerfile证明了环境的可复现性，它通过编译受影响的1.9.16p2版本并配合sudo-chwoot.sh脚本进行利用。该POC脚本在受影响的Ubuntu、Debian、CentOS等系统上具有较高的利用成功率，能够直接将普通shell提升为root shell。利用步骤：1. 在本地创建一个攻击者可控的目录（如/tmp/pwn）；2. 在该目录中准备伪造的/etc/nsswitch.conf文件和相关的恶意库文件；3. 调用带有'--chroot'参数的sudo命令，指向该目录，例如执行'sudo --chroot /tmp/pwn /bin/sh'；4. 此时Sudo会读取伪造的配置文件而非系统真实的配置文件，触发权限提升。投毒风险分析：该POC的投毒风险评估为15%，属于低风险范畴。主要的风险点在于README中引导用户前往外部Release地址（[如github.com/yeremeu/CVE-2025-32463_chwoot/releases](https://www.google.com/search?q=https://%E5%A6%82github.com/yeremeu/CVE-2025-32463_chwoot/releases)）下载预编译的二进制文件或压缩包。这种引导下载并运行未知二进制文件的行为是典型的投毒手段，可能包含键盘记录器或远程后门。然而，项目本身提供了透明的Dockerfile和源代码编译指令（gcc exploit.c），这符合安全研究的合规性。代码逻辑中未发现明显的恶意混淆或无关的网络通信。研究人员应坚持从源码编译，并严格审查sudo-chwoot.sh脚本中的环境变量设置和执行流，避免运行任何来自不可信Release页面的预编译二进制程序，以确保研究环境的安全。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
