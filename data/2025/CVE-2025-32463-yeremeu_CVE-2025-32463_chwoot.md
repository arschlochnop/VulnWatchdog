## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 攻击者必须拥有目标系统的本地普通用户访问权限，且目标系统安装了受影响版本的 Sudo 程序，利用时通常涉及对 --chroot (-R) 选项的使用。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

CVE-2025-32463 是 Sudo 程序中存在的一个严重本地提权漏洞。该漏洞的根源在于 Sudo 在处理 `--chroot` (或 `-R`) 命令行选项时，未能正确隔离受控环境下的配置文件加载逻辑。具体而言，当用户执行带有 chroot 选项的 sudo 命令时，程序会尝试从用户可控的目录中读取 `/etc/nsswitch.conf` 等关键配置文件。攻击者可以预先在特定目录下构造恶意的配置文件，通过劫持名称服务切换（NSS）机制，加载攻击者提供的恶意共享库，从而在 Sudo 执行过程中以 root 权限执行任意代码。POC 有效性分析：提供的 Dockerfile 脚本具有极高的实战参考价值，它通过构建包含特定旧版本 Sudo (1.9.16p2) 的 Ubuntu 环境，完整模拟了漏洞触发场景。其提供的 `sudo-chwoot.sh` 脚本（虽未显示全文但从结构可推断）旨在自动化创建恶意 chroot 环境并触发 root shell 弹出。由于 Sudo 在 Linux 发行版中几乎是标配，此漏洞的覆盖面极广，利用逻辑清晰且稳定。利用步骤如下：1. 准备一个受控目录并构建伪造的根目录结构，包含 /etc/nsswitch.conf。2. 在该目录下放置恶意编译的 .so 库文件。3. 执行 `sudo -R /path/to/controlled_dir command`。4. 诱导 Sudo 加载恶意库，实现权限提升。 投毒风险分析：该 POC 的投毒风险等级评定为中等（45%）。主要的风险点在于 README.md 引导用户前往外部未经验证的 GitHub Release 链接（`yeremeu/CVE-2025-32463_chwoot`）下载预编译的二进制文件或压缩包。这种引导下载并运行黑盒程序的行为是威胁情报领域典型的‘投毒’特征。攻击者往往在合法的 POC 包装下，植入反弹 shell 或窃取敏感信息的恶意逻辑。虽然 Dockerfile 本身展现的编译流程是透明的，但 README 中推荐的 `tar -xvf` 和直接执行 `gcc exploit.c` 的步骤，如果配套的 source code 来源于不可信的分发渠道，极易导致安全研究员的测试机被反向渗透。防御建议是仅参考 Dockerfile 中的环境搭建逻辑，严禁直接运行任何来自 Release 页面的预编译程序，并对利用脚本中的 library 加载路径进行严格审计。

**项目地址:** [https://github.com/yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
