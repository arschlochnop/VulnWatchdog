## CVE-2025-32463 - Sudo 本地权限提升(LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升(LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 攻击者必须具有目标系统的本地低权限用户访问权限，且 sudo 允许使用 --chroot 选项。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于 Sudo 的 --chroot 选项处理逻辑中。分析提供的 Dockerfile 和搜索结果可知，漏洞核心在于 sudo 在执行 chroot 操作时，会加载用户受控目录下的 /etc/nsswitch.conf 配置文件。攻击者可以创建一个恶意的 chroot 环境，并在其中放置伪造的 nsswitch.conf 以及恶意共享库（如通过加载自定义的 libc 或 PAM 模块）。当具有 sudo 权限的用户尝试使用 --chroot 选项执行命令时，sudo 在切换根目录后会以 root 权限加载并解析该恶意配置文件，进而执行攻击者预设的代码，实现从普通用户到 root 用户的垂直权限提升。提供的 Dockerfile 自动构建了存在漏洞的 sudo 1.9.16p2 版本，并包含了一个名为 sudo-chwoot.sh 的利用脚本，这表明该 POC 具有极高的实战参考价值，能够复现从源码编译、环境搭建到最终利用的完整链条。利用步骤通常包括：1. 创建一个用户可写的目录作为伪造的 root 环境；2. 在该目录下构建基本的目录结构（如 /etc, /lib）；3. 将恶意的 nsswitch.conf 和对应的 .so 库放入对应位置；4. 调用 sudo --chroot 指向该目录执行任意命令触发加载。该利用方式在 Linux 运维环境中具有极大的破坏性。

【投毒风险分析】尽管该项目提供了详细的 Dockerfile 用于安全研究，但投毒风险评级为 45%（中等风险），主要基于以下几点：首先，README.md 中诱导用户前往 GitHub Releases 下载已打包的压缩包（CVE-2025-32463.tar.gz），而不是直接使用仓库中的源代码。这是恶意软件分发的典型手法，攻击者常在预编译的二进制文件或压缩包中植入后门。其次，README 中提到的编译步骤 'gcc exploit.c -o exploit'，但仓库文件列表中并未直接展示 exploit.c 的完整内容，这种不透明性增加了恶意代码执行的可能性。此外，这类高价值的本地提权 POC 常被攻击者作为‘诱饵’，在所谓的‘一键脚本’中加入反弹 Shell 或敏感信息窃取逻辑。防御性研究员在分析时，必须严格限制在隔离的沙箱或虚拟机环境中运行，并重点检查 sudo-chwoot.sh 脚本是否包含 base64 混淆代码、外部 curl/wget 请求或对系统关键位置（如 /home/pwn/.ssh/authorized_keys）的非法写入。目前观察到该 POC 引导用户下载外部 Release 的行为具有明显的诱导特征，需高度警惕其二进制文件的安全性。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
