## CVE-2025-32463-sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** sudo

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 二进制文件中的一个本地权限提升漏洞。该漏洞允许本地用户在特定错误配置或使用精心设计的输入的情况下将权限提升为 root。

**有效性：**

根据提供的搜索结果和漏洞利用代码，该漏洞的 POC 代码是有效的。搜索结果中 NVD 和 GitHub 链接都确认了该漏洞的存在，以及它是一个本地提权漏洞。提供的 Dockerfile 构建了一个易受攻击的 sudo 版本（1.9.16p2），并配置了利用该漏洞所需的环境。

**投毒风险：**

评估投毒风险时，需要仔细审查 POC 代码，寻找任何非预期的、恶意的行为。

1.  **Dockerfile:** Dockerfile 的目的是构建一个包含易受攻击的 sudo 版本的环境。它从一个干净的 Ubuntu 24.04 镜像开始，安装必要的构建工具和依赖项，下载并编译易受攻击的 sudo 版本，创建一个普通用户 pwn，复制 POC 脚本，并切换到 pwn 用户。Dockerfile 本身看起来没有包含任何明显的投毒代码。
2.  **sudo-chwoot.sh（未提供）：** 漏洞利用脚本 `sudo-chwoot.sh` 的内容没有完全提供，因此无法完全确定。需要检查这个脚本是否存在恶意的、与提权无关的行为。例如，是否尝试修改其他系统文件、安装后门、或发送信息到外部服务器。
3.  **README.md:** README 文件只是提供了漏洞的信息和利用说明，本身没有可执行代码，因此没有投毒风险。

综合考虑，Dockerfile 的构建过程相对标准，主要是为了复现漏洞环境。主要的风险在于 `sudo-chwoot.sh` 脚本，因为攻击者可能会在提权代码中加入恶意行为。由于无法完整查看 `sudo-chwoot.sh` 的内容，所以不能完全排除投毒的可能。预估投毒风险为10%。

**利用方式：**

利用方式如下：

1.  **环境准备：** 使用 Dockerfile 构建包含易受攻击的 sudo 版本的环境。
2.  **用户切换：** 切换到普通用户 pwn。
3.  **执行 PoC：** 运行 `sudo-chwoot.sh` 脚本。该脚本会利用 /etc/nsswitch.conf 文件的漏洞，通过 `--chroot` 选项获得 root 权限。

总而言之，此漏洞允许本地用户通过特制的 `nsswitch.conf` 文件和 `--chroot` 选项，在存在漏洞的 sudo 版本上获取 root 权限。

**项目地址:** [yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)