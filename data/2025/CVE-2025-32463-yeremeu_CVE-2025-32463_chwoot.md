## CVE-2025-32463 - Sudo 权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 具有受影响系统上低权限用户的本地访问权限

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

CVE-2025-32463 是 Sudo 程序中的一个本地权限提升漏洞。该漏洞源于 Sudo 在处理带有 --chroot 选项的命令时，未对用户控制目录下的 /etc/nsswitch.conf 文件进行严格校验。具体而言，当用户请求以 chroot 环境执行命令时，Sudo 会加载该环境内的名称服务切换配置，攻击者可以通过构造恶意的共享库路径或修改 nsswitch.conf 配置文件，诱导系统加载攻击者控制的动态链接库，从而在目标系统上以 root 权限执行任意代码。 

【POC有效性分析】通过对提供的 Dockerfile 和搜索到的 PoC 项目（如 K1tt3h/CVE-2025-32463-POC）分析，该 PoC 具有极高的有效性。Dockerfile 明确指定了存在漏洞的版本 sudo-1.9.16p2 进行编译安装，并配备了名为 sudo-chwoot.sh 的利用脚本。搜索结果显示已有 Rust 语言实现的成熟利用版本及 Shell 脚本版本，能够在主流发行版（Ubuntu 20.04/24.04, Debian 10等）的特定配置下稳定触发权限提升。代码逻辑清晰，主要涉及对 chroot 环境的构造和对 sudo 命令特定参数的调用，符合该 CVE 的技术特征。 

【利用步骤】1. 获取低权限用户 Shell；2. 创建一个由用户可控的目录作为伪造的根环境；3. 在该目录下构建虚假的 /etc 目录并放置恶意的 nsswitch.conf 配置文件；4. 编译或准备恶意共享库（.so文件）；5. 执行 sudo --chroot [路径] [命令]，触发 Sudo 加载恶意库文件，从而获取 root shell。 

【投毒风险分析】该漏洞相关的投毒风险处于中等偏高水平（45%）。首先，CVE 编号本身较为新颖（2025年序列），容易吸引安全研究员和初学者下载测试。其次，搜索结果中出现了多个托管在 GitHub 和第三方博客上的 POC，其中部分项目诱导用户从外部链接下载“预编译二进制文件”（如结果3提到的 Releases 下载），这是典型的投毒手段。由于利用过程涉及 chroot 环境构建和动态库编译，初学者往往倾向于直接运行提供的 .sh 或 .py 脚本，攻击者可能在这些脚本中植入反弹 Shell（如利用 bash -i >& /dev/tcp/...）或窃取 SSH 密钥的代码。特别是在 Docker 环境之外直接执行此类脚本，若脚本要求 sudo 权限以安装依赖，则极易导致宿主机被控。分析发现，部分名为 'chwoot' 的利用脚本包含对外部 URL 的 wget 请求，需严格审计其下载的二进制文件内容。建议防御方在沙箱环境中进行 PoC 验证，且严禁直接运行未经代码审计的二进制利用工具。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
