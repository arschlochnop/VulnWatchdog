## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本 (例如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地普通用户访问权限，且 sudo 配置允许该用户使用带有 --chroot 参数的命令，或者系统配置存在特定的 nsswitch 解析逻辑缺陷。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是 sudo 程序在处理 chroot 环境时的一个严重逻辑缺陷。根据提供的搜索结果和 POC 结构分析，核心问题在于 sudo 在执行带有 --chroot 参数的命令时，会错误地加载受用户控制目录下的 /etc/nsswitch.conf 配置文件。攻击者可以创建一个恶意的 chroot 目录环境，在该目录下伪造 nsswitch.conf 文件并配置恶意的动态链接库（如自定义的 NSS 模块）。当 sudo 尝试在 chroot 环境中解析用户或组信息时，会加载并执行该恶意库中的代码，由于 sudo 本身具有 SUID 权限，这直接导致了权限从普通用户提升至 root。POC 包含了一个 Dockerfile 环境用于复现 1.9.16p2 版本的漏洞，并提供了 sudo-chwoot.sh 脚本，这表明该 POC 具有极高的实战价值且经过验证。代码逻辑清晰，通过环境变量和文件系统布局触发漏洞，技术路径符合公开的 CVE 描述，有效性极高。【利用步骤】1. 准备阶段：在本地可写目录（如 /tmp）创建一个伪造的根目录结构，包含必要的 /etc 目录。2. 配置投毒：在伪造的 /etc/nsswitch.conf 中定义恶意的 passwd 或 group 数据源。3. 载荷编写：编译一个恶意共享库（.so），将其路径映射到 nsswitch 配置中，使其包含提权代码（如执行 /bin/bash）。4. 触发执行：运行命令 `sudo --chroot /tmp/fake_root [command]`。5. 获取权限：sudo 在处理过程中加载恶意库，触发提权逻辑，攻击者获得 root shell。【投毒风险分析】该 POC 存在中等程度的投毒风险。风险主要来源于两个方面：第一，README 文档中显式引导用户前往外部 Release 页面下载预编译的二进制文件（CVE-2025-32463.tar.gz），这是典型的投毒手段，因为预编译文件无法通过源码审计发现后门；第二，部分搜索结果（结果3）提到了提供‘预编译二进制使用’的利用方式，这类由非官方维护的二进制文件极可能捆绑了远控木马或窃密脚本。虽然 Dockerfile 本身通过 wget 下载官方 sudo 源码进行构建是安全的，但配套的 sudo-chwoot.sh 或 README 指向的下载链接可能包含未经审查的恶意代码。此外，项目描述中存在诱导性链接，这符合威胁情报中‘漏洞武器化投毒’的特征。防御者在测试此 POC 时，应严格限制在隔离的沙箱或虚拟机环境中进行，切勿直接在生产环境或个人宿主机上运行任何预编译组件，且必须对 sudo-chwoot.sh 脚本进行逐行代码审计。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
