## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** High

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 本地用户访问权限；Sudo版本低于1.9.17p1；利用--chroot选项且存在可控目录

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于Sudo在处理--chroot选项时，错误地使用了用户受控目录下的/etc/nsswitch.conf文件。在正常逻辑中，chroot操作后应当严格限制配置文件来源，但Sudo在执行过程中未能正确隔离环境，导致其加载了攻击者伪造的nsswitch配置。通过在受控目录中放置恶意的/etc/nsswitch.conf和对应的动态链接库（如自定义的glibc插件），本地攻击者可以在sudo执行提权操作时劫持程序流，从而获得完整的root访问权限。提供的Dockerfile通过安装受影响的1.9.16p2版本验证了漏洞的存在性，其逻辑闭环且符合技术原理。利用步骤：1. 准备一个用户可写的目录作为模拟的chroot环境。2. 在该目录下创建etc子目录，并写入恶意构造的nsswitch.conf文件。3. 编写一个恶意的共享库文件，使其在被加载时执行提权代码（如执行/bin/bash）。4. 使用具有sudo执行权限（即便仅限特定命令）的账户，执行带有--chroot参数的命令指向该目录。5. Sudo加载恶意库，攻击者获取root shell。投毒风险分析：该POC项目展现出一定的投毒风险，主要体现在其README文档引导用户前往外部链接（[github.com/yeremeu/CVE-2025-32463_chwoot/releases](https://github.com/yeremeu/CVE-2025-32463_chwoot/releases)）下载预编译的二进制文件或压缩包，而非直接在代码库中展示核心利用代码。这种‘二进制分发’模式是典型的投毒手段，因为编译后的二进制文件极易混入后门或信息窃取脚本。虽然Dockerfile本身显示的是标准的编译流程，但README中提及的外部Release地址与当前仓库可能不一致，增加了社交工程攻击的概率。此外，文档中要求用户下载并运行未审核的tar.gz包，若包内包含混淆的shell脚本，可能导致研究人员的机器被反弹shell或敏感信息被泄露。建议在隔离的沙箱环境中使用，并严格审计sudo-chwoot.sh脚本内容。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
