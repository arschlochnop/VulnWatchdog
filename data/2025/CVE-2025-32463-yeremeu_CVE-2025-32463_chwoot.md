## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 具有本地用户访问权限，能够执行带有 --chroot 选项的 sudo 命令

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

POC有效性分析：该漏洞存在于 Sudo 的 chroot 功能实现中。在版本 1.9.17p1 之前，当用户使用 --chroot 选项时，Sudo 错误地加载了用户受控目录中的 /etc/nsswitch.conf 配置文件。提供的 POC 代码通过 Docker 镜像模拟了一个受影响的环境（安装了 sudo 1.9.16p2）。有效的利用步骤如下：首先，攻击者在用户可写的目录下（如 /tmp）创建一个伪造的 chroot 环境，并在其中放置恶意的 nsswitch.conf 以及相应的共享库文件。当 sudo --chroot 执行时，它会以 root 权限加载这些受控的库，从而导致任意代码执行。Dockerfile 证明了环境的一致性，sudo-chwoot.sh 脚本则是核心的自动化攻击载体。该 POC 在本地环境中具有极高的复现成功率。利用步骤：1. 准备受影响的 Sudo 环境；2. 创建包含恶意 nsswitch.conf 和动态库的目录结构；3. 调用 sudo 并配合 --chroot 参数指向该目录；4. 触发恶意库加载以获取 root shell。 投毒风险分析：该 POC 存在中等程度的投毒风险。虽然仓库提供了 Dockerfile 和 shell 脚本，增加了透明度，但 README.md 中引导用户前往 external release 页面下载预编译二进制文件（CVE-2025-32463.tar.gz）是一个显著的红旗。在安全研究领域，鼓励通过源代码编译以确保审计安全性，而提供未经审查的二进制文件是投毒的典型手段。此外，描述中提到的 GitHub 链接（yeremeu/CVE-2025-32463_chwoot）在搜索结果中与已知的恶意投毒模式相似。用户在运行下载的二进制文件时，极易被植入第二阶段后门，如反弹 Shell 或窃取 SSH 密钥的脚本。建议研究人员仅参考 Dockerfile 中的构建逻辑，严禁直接运行 Release 中的编译产物，并应对 shell 脚本中的网络请求进行严格审计，防止其在利用漏洞的同时下载恶意荷载。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
