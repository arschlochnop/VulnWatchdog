## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1 (包括 1.9.16p2 等版本)

**利用条件:** 本地普通用户权限，系统允许使用 --chroot 选项或存在特定的环境配置

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

CVE-2025-32463 是 Sudo 实用程序中发现的一个严重的本地权限提升漏洞。该漏洞源于 Sudo 在处理带有 --chroot 参数的命令时，由于对用户控制目录下的配置文件（特别是 /etc/nsswitch.conf）验证不当，导致本地普通用户可以加载恶意的动态库或修改系统解析逻辑，从而获取 root 访问权限。在受影响的版本（1.9.17p1 之前）中，如果攻击者能够控制 chroot 环境内的文件系统结构，就可以通过伪造 nsswitch 配置引导 Sudo 调用攻击者准备好的恶意 SO 文件。该漏洞的有效性分析显示，公开的 POC 包含 Dockerfile 模拟环境和 Shell 脚本利用逻辑，通过创建一个受控的 chroot 环境并放置恶意库文件，可以稳定触发提权。利用步骤通常包括：1. 准备一个包含恶意 /etc/nsswitch.conf 和动态链接库的目录；2. 使用具有 sudo 权限或特定配置的 sudo 命令配合 --chroot 指向该目录；3. 触发 Sudo 加载恶意库执行代码。该 POC 的完整性较高，不仅提供了环境搭建脚本，还提供了 Rust 版本的实现参考，使得漏洞复现难度显著降低。

关于投毒风险分析，该漏洞的公开资源中存在中等程度的风险。首先，搜索结果显示部分仓库（如 yeremeu/CVE-2025-32463_chwoot）引导用户从 Releases 页面下载预编译的二进制文件（CVE-2025-32463.tar.gz），这是典型的投毒向量。黑客可能在预编译的二进制文件中植入后门、勒索软件或窃密木马，而普通研究员往往只注意其提权功能而忽略了静态分析。其次，README 中引导用户通过 curl/wget 下载脚本并直接运行，若下载源被劫持或仓库本身即为钓鱼仓库，将导致研究员主机失陷。虽然 Dockerfile 展示了从源码编译的过程，看起来较为透明，但脚本 `sudo-chwoot.sh` 的具体内容未完整披露，其中可能包含向远程服务器发送敏感信息（如主机密钥、环境变量）的代码。建议防御者在分析此类 POC 时，必须在完全隔离的沙箱环境中进行，严禁直接运行任何未经审计的预编译文件，并重点检查网络连接行为。目前 GitHub 上已出现多个针对该 CVE 的仓库，部分仓库内容高度雷同且发布时间密集，具有明显的自动化僵尸网络特征，旨在利用热门漏洞话题对安全从业者进行精准投毒。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
