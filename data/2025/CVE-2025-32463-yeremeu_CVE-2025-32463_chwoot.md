## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 攻击者必须拥有目标系统的低权限本地访问权限，且目标系统安装了受影响版本的Sudo，同时Sudo配置允许使用 --chroot 参数或特定的nsswitch.conf处理逻辑存在缺陷。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-32463 是一个存在于 Sudo 组件中的高危本地提权漏洞。该漏洞源于 Sudo 在处理 `--chroot` 参数时，对 `/etc/nsswitch.conf` 文件的加载路径校验不当。在受影响的版本（1.9.17p1 之前）中，如果攻击者能够控制某个目录，并诱导 Sudo 在该目录下执行 chroot 操作，Sudo 可能会错误地加载攻击者伪造的 nsswitch.conf 配置文件。通过这种方式，攻击者可以劫持系统的名称服务切换（NSS）机制，加载恶意共享库，从而在 Sudo 以 root 权限运行的过程中执行任意代码。POC有效性分析：提供的 Dockerfile 明确构建了一个包含漏洞版本 sudo-1.9.16p2 的环境，这证明了研究者对漏洞复现环境有清晰的认知。仓库中的 README 描述了通过编译 exploit.c 并运行 sudo-chwoot.sh 来触发漏洞。该利用链逻辑严密：首先通过 chroot 环境隔离，然后利用 Sudo 对配置文件加载的逻辑缺陷，将非特权的本地访问权限提升至 root。由于 Sudo 在类 Unix 系统中被广泛作为特权管理工具，此漏洞的实际影响范围非常广，尤其是那些允许非 root 用户使用 chroot 功能的受限环境。利用步骤：1. 在目标系统上部署或寻找一个攻击者可写的目录。2. 在该目录中准备伪造的 /etc/nsswitch.conf 文件和恶意的 NSS 插件库（.so文件）。3. 执行带有 --chroot 参数的 sudo 命令指向该目录，例如 `sudo --chroot /path/to/malicious/dir ...`。4. 此时 Sudo 会加载恶意的 NSS 库，触发其中的 payload。5. 攻击者成功获得 root shell。投毒风险分析：该项目的投毒风险处于较低水平（约15%）。分析代码结构发现，Dockerfile 和 Shell 脚本主要用于自动化搭建易受攻击的实验环境，属于标准的安全研究行为。README 中引导用户去 'Releases' 页面下载预编译文件，这在某些情况下可能潜藏风险（如预编译二进制文件包含后门），但目前从公开的仓库结构看，其主要目的是为了方便复现。代码中没有发现明显的混淆、反调试、或连接未知 C2 服务器的指令。主要的风险在于漏洞本身的杀伤力极大，且提供的 shell 脚本（sudo-chwoot.sh）如果直接在生产环境运行而不经过审计，可能会因为环境差异导致不可预知的后果。整体来看，该 POC 属于高质量的防御性研究资料，建议安全团队在隔离的沙箱环境中进行验证，并重点关注 Sudo 升级至 1.9.17p1 或更高版本。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
