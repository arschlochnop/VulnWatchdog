## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.16p2 之前的版本 (特别是涉及 chroot 功能的实现)

**利用条件:** 攻击者需拥有本地非特权用户访问权限，且系统配置允许或存在特定的 chroot 处理逻辑缺陷。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

POC有效性分析：根据公开的搜索结果和代码片段，该POC（sudo-chwoot.sh）针对的是Linux Sudo组件中的chroot安全缺陷。漏洞源于chroot实现中对非可信控制范围的处理不当，允许本地低权限用户通过特定的路径操纵或环境变量逃逸受限环境并获取root权限。提供的Dockerfile显示了完整的实验环境构建过程，包括安装依赖、下载并编译存在漏洞的sudo-1.9.16p2版本、创建非特权用户pwn以及运行利用脚本。这证明了漏洞的可复现性非常高。脚本sudo-chwoot.sh在描述中展现了成功获取uid=0(root)的结果。利用步骤：1. 在受影响的Linux系统上获取低权限Shell。2. 确认sudo版本低于1.9.16p2或包含相关补丁前的代码。3. 准备利用环境，通常涉及构建一个伪造的chroot环境或利用特定的路径解析漏洞。4. 运行POC脚本sudo-chwoot.sh，该脚本会通过sudo调用存在缺陷的逻辑。5. 脚本利用竞争条件或不当的文件描述符处理，劫持执行流。6. 验证权限提升，通过id命令确认已获得root身份。该漏洞对于多用户环境和容器逃逸场景具有极高的威胁性。投毒风险分析：该POC存在中等程度的投毒风险，主要体现在以下几个方面：首先，README中引导用户前往外部的Releases链接下载预编译的二进制文件（CVE-2025-32463.tar.gz），这是典型的恶意软件分发手段。在防御性研究中，下载并运行未经审计的二进制文件具有极高风险，可能包含后门或勒索软件。其次，虽然Dockerfile本身逻辑相对透明，但其COPY指令引入的sudo-chwoot.sh脚本内容在输入数据中未完全展示，可能在脚本末尾包含反弹Shell或搜集敏感信息的指令。第三，GitHub上的多个仓库（如K1tt3h和yeremeu的引用）可能存在仿冒真实安全研究员的情况，部分仓库可能通过SEO手段诱导开发者下载。在分析此类POC时，必须严格限制在隔离的沙箱或虚拟机环境中运行，并重点检查Makefile或编译脚本中是否包含curl/wget等外连下载行为。对于提及的Rust实现版本，由于其编译产物更难逆向分析，投毒风险进一步提升。建议研究人员仅参考Dockerfile中的构建逻辑，手动审查源码，而非直接运行第三方提供的Releases包。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
