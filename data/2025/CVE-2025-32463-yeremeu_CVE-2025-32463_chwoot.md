## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.16p2 之前的版本 (含 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限；Sudo 配置允许使用特定功能（如 chroot）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是 Sudo 组件中关于 chroot 功能实现的安全缺陷。分析提供的 POC 代码和 Dockerfile 发现，漏洞利用的核心在于 Sudo 在处理 chroot 环境时未能正确限制非可信控制范围，导致攻击者可以绕过预设的安全边界。Dockerfile 明确指定了受影响的 Sudo 版本 1.9.16p2，并通过编译安装该版本来重现环境。PoC 脚本 `sudo-chwoot.sh` 配合 C 语言编写的 `chwoot-demo.c` 利用了 sudo 命令在执行带有 chroot 操作时的逻辑漏洞。有效性验证表明，在受影响的 Ubuntu 24.04 容器环境中，普通用户执行该脚本后能成功通过非法路径逃逸并获取 root 权限（UID=0）。此 POC 提供了从环境构建（Dockerfile）、源码编译到利用脚本的完整链路，具有极高的实战参考价值。漏洞利用步骤如下：1. 使用提供的 Dockerfile 构建易受攻击的 Sudo 环境并创建普通用户 pwn。2. 编译漏洞利用程序（如 exploit.c 或 chwoot-demo.c）。3. 以普通用户身份执行 sudo-chwoot.sh 脚本。4. 脚本利用 sudo 的 chroot 缺陷触发权限提升。5. 成功后系统将返回一个具有 root 权限的交互式 Shell。【投毒风险分析】在分析过程中，虽然发现多个 GitHub 仓库（如 K1tt3h/CVE-2025-32463-POC）提供了脚本，但需警惕投毒风险。目前的投毒风险评级为 25%，处于低到中水平。主要的风险点在于：首先，搜索结果中提到了 Rust 实现的利用版本，虽然 Rust 具有较好的性能，但预编译的二进制文件（Pre-compiled binary）可能包含恶意后门，且不易被传统的静态扫描工具检测。其次，README 文档中提供的下载链接指向了非官方的 Release 页面（如 yeremeu 的个人仓库），此类二进制文件未经审计，极易被嵌入反向 Shell 或木马。再次，部分脚本中可能包含混淆过的 base64 字符串或自动从远程服务器下载文件的指令，这些行为虽然在安全研究中常见，但也常被攻击者用来掩盖真实的投毒载荷。建议安全研究人员在测试时，务必在隔离的沙箱或虚拟机环境中运行，并优先使用 Dockerfile 自行编译源码，避免直接运行来源不明的二进制程序或含有 curl/wget 外部执行指令的 shell 脚本。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
