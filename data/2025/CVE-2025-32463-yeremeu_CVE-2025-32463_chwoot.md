## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限，且 sudo 配置允许使用 --chroot 参数。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：根据提供的 Dockerfile 和搜索结果，该漏洞源于 sudo 在执行 --chroot 参数时，对用户可控目录下的 /etc/nsswitch.conf 配置文件处理不当。漏洞的核心在于受控环境（chroot）内的配置加载逻辑泄露到了高权限执行上下文中。PoC 代码通过构建一个包含恶意 nsswitch.conf 的目录，并诱导 sudo 在该环境下运行，从而加载攻击者定义的恶意库或修改后的系统配置，最终实现从普通用户到 root 用户的提权。Dockerfile 显示该 POC 可以在 Ubuntu 24.04 环境下成功编译并安装受影响的 sudo 1.9.16p2 版本进行复现，证明了其实战可行性。脚本 sudo-chwoot.sh 预计包含了创建伪造 root 根目录结构及触发 sudo 调用 chroot 的具体逻辑。利用步骤：1. 准备受影响版本的 sudo 环境（如 1.9.16p2）。2. 创建一个攻击者可控的目录作为伪造的 root 根路径。3. 在该目录下放置恶意的 /etc/nsswitch.conf 文件。4. 在该目录下的对应库路径（如 /lib 或 /usr/lib）放置恶意共享对象（.so），该对象应包含提权代码（如执行 /bin/sh）。5. 使用 sudo --chroot <伪造目录> <命令> 触发漏洞。6. 此时 sudo 将加载伪造目录下的 nsswitch 配置并调用攻击者的恶意库，从而在 root 权限下执行任意代码。投毒风险分析：该 POC 来源于 GitHub 用户 K1tt3h。从目前提供的内容来看，Dockerfile 主要用于搭建合法的漏洞实验环境，下载的是 sudo 官方分发包，其行为透明且符合安全研究规范。README 文档结构完整，提供了编译和使用的标准步骤。然而，投毒风险主要存在于 README 中提到的 'Releases' 下载链接，安全研究员在下载编译好的 binary 或 tar.gz 包时需警惕。虽然 Dockerfile 本身是安全的，但如果用户直接运行下载的 pre-compiled 脚本而不审计 sudo-chwoot.sh 的内容，可能存在被植入反弹 shell 或后门的风险。初步评估代码逻辑清晰，主要依赖标准库和 build-essential 工具链，未发现明显的恶意混淆或外部可疑请求，属于低至中等投毒风险范畴。建议在使用时仅参考 Dockerfile 逻辑，自行下载源码并审计 shell 脚本内容，严禁直接执行来源不明的二进制文件。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
