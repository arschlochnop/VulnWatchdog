## CVE-2025-32463 - Sudo 本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有本地普通用户访问权限，且目标系统安装了受影响版本的Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 40%

## 详情

POC有效性分析：该漏洞存在于Sudo 1.9.17p1之前的版本中。漏洞核心原因在于Sudo在处理--chroot参数时，未能正确隔离或验证来自用户受控目录的/etc/nsswitch.conf文件。在利用过程中，攻击者可以创建一个恶意的chroot环境，并在此环境中放置自定义的nsswitch.conf及配套的共享库。当sudo以root权限在chroot路径下执行时，它会加载该恶意配置，进而加载攻击者提供的恶意动态链接库（如libnss_custom.so.2），从而在root上下文中执行任意代码。根据提供的搜索结果和Dockerfile，该POC包含了一个完整的模拟环境（基于Ubuntu 24.04，手动编译安装了易受攻击的Sudo 1.9.16p2）以及对应的利用脚本sudo-chwoot.sh。脚本展示了如何通过简单的命令执行直接获取root shell。经过分析，该POC逻辑清晰，复现步骤完整，在受影响的旧版本Linux发行版上具有极高的成功率。利用步骤：1. 攻击者获取目标系统的普通用户Shell。2. 确认Sudo版本在1.9.17p1以下。3. 准备恶意chroot目录结构，包含伪造的/etc/nsswitch.conf和编译好的恶意库文件。4. 执行sudo --chroot [path] [command]，触发配置加载。5. 恶意库被加载后，将当前进程或衍生进程的UID/GID设置为0，弹出Root Shell。 投毒风险分析：该POC虽然提供了详细的源代码和Dockerfile，但也表现出一定的投毒风险。首先，README中引导用户前往Releases页面下载预编译的二进制文件（CVE-2025-32463.tar.gz），这是典型的安全威胁点，因为二进制文件可能包含未经审核的恶意代码。其次，搜索结果[3]提到了Rust实现的利用版本，并强调了预编译二进制的使用，这在安全社区中常被用作分发后门的手段。由于此类提权脚本通常需要root权限或旨在获取root权限，一旦执行了被投毒的Payload，攻击者将直接获得系统的最高控制权。在分析过程中发现，虽然Dockerfile显示了合法的编译流程，但用户如果直接下载外部Releases中的tar包或执行未经审计的Shell脚本，将面临中等程度的投毒风险。建议研究人员仅参考其.sh脚本逻辑并自行在受控环境中编译，严禁运行来源不明的编译后文件。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
