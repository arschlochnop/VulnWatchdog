## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地普通用户访问权限，且系统需配置允许使用 --chroot 选项或相关 NSSwitch 配置。

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

POC有效性分析：CVE-2025-32463 是 Sudo 程序中的一个高危本地权限提升漏洞。该漏洞源于在处理 --chroot 命令行选项时，Sudo 未能正确限制对用户控制目录中配置文件的加载。具体而言，当使用 --chroot 选项时，Sudo 可能会从用户可写的目录中加载 /etc/nsswitch.conf。由于 NSSwitch (Name Service Switch) 允许通过共享库（.so 文件）动态加载名称解析插件，攻击者可以构造一个恶意的 nsswitch.conf 文件，指向攻击者控制的恶意共享对象库。当 Sudo 以 root 权限执行并加载该恶意库时，攻击者的代码将以最高权限运行。提供的 Dockerfile 证明了该漏洞的环境一致性，通过下载并编译受影响的 1.9.16p2 版本，确保了利用环境的复现。利用步骤：1. 攻击者首先在本地建立一个由其控制的目录结构，模拟根目录环境。2. 在该目录中创建 /etc 目录，并编写一个伪造的 nsswitch.conf 文件。3. 编写一个恶意的 C 语言共享库，其中包含初始化函数或特定的名称解析函数，其逻辑为执行 /bin/bash 或更改权限。4. 编译该库并将其放置在伪造目录的库搜索路径中。5. 调用 sudo 并配合 --chroot 选项指向该恶意目录。6. Sudo 在初始化过程中加载恶意插件，导致特权执行，从而使普通用户获得 root shell。该漏洞对 Linux 服务器安全构成严重威胁，特别是多用户环境或提供容器化服务的环境。

投毒风险分析：该 POC 项目存在显著的投毒风险。首先，README 中提供的链接指向了外部的 GitHub Release 地址（yeremeu/CVE-2025-32463_chwoot），而非直接在仓库中提供源代码。这种引导用户下载预编译二进制文件（CVE-2025-32463.tar.gz）的行为是典型的恶意投毒手段，因为二进制文件难以审计，极易植入反弹 Shell 或木马。其次，提供的 Dockerfile 虽然看似正常，但它依赖于外部的 shell 脚本 sudo-chwoot.sh，而该脚本的内容在输入中缺失，无法通过静态分析确认其安全性。README 中的安装步骤引导用户运行 gcc 编译 exploit.c，但在项目根目录中并未看到该 C 源代码，这种文档与实际代码不符的情况通常暗示项目可能包含隐藏的恶意逻辑。考虑到这是一个针对高价值目标（Sudo 提权）的漏洞，威胁情报团队应将其视为‘潜在投毒项目’。安全研究员在测试时必须在完全隔离的沙箱环境中运行，严禁在生产机器或连接了内网的测试机上直接执行 Release 中的任何内容，以防遭受供应链攻击或本地终端被控。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
