## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 本地用户访问权限，存在 --chroot 选项使用场景或特定的配置错误

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

POC有效性分析：该漏洞存在于 Sudo 的 --chroot 选项处理逻辑中。根据搜索结果和提供的 Dockerfile，漏洞核心在于 Sudo 在执行 chroot 操作时，会读取用户受控目录下的 /etc/nsswitch.conf 文件。由于该文件决定了系统如何解析用户、组和其他信息，攻击者可以通过构造恶意的 nsswitch.conf 并配合特定的共享库加载机制，在 chroot 环境切换过程中诱导 Sudo 加载攻击者控制的代码。提供的内容中包含了一个完整的 Ubuntu 24.04 模拟环境，手动编译了受影响的 sudo-1.9.16p2 版本。这证明了该 POC 不仅仅是理论说明，而是具备可重复性的实验环境。利用步骤：1. 在受影响系统中创建一个由当前用户控制的目录。2. 在该目录下构造伪造的目录结构，包含恶意的 /etc/nsswitch.conf 文件。3. 编写一个恶意共享对象文件（.so），并在 nsswitch.conf 中引用它。4. 调用 sudo 并使用 --chroot 参数指向该目录。5. Sudo 在初始化阶段会读取受控目录下的配置并加载恶意库，从而以 root 身份执行代码。投毒风险分析：该 POC 项目的投毒风险评级为低到中等。风险点主要在于 README 中引导用户从外部链接（GitHub Releases）下载预编译的二进制文件或压缩包（CVE-2025-32463.tar.gz），而不是直接在仓库中提供源代码。这种‘引导至外部下载’的行为是典型的投毒手段，因为二进制文件难以审计，可能包含后门。然而，项目同时提供了 Dockerfile，允许研究人员在隔离环境中自行构建受影响的版本并进行测试，这增加了透明度。代码片段中显示的编译过程（gcc exploit.c -o exploit）属于标准操作。防御者应警惕任何要求以 root 权限运行未经审计的脚本或下载运行第三方 Release 文件的行为。建议仅在 Docker 等容器化隔离环境内运行此类 POC，并严格检查 sudo-chwoot.sh 脚本的内容，防止其包含非预期的网络回连或敏感信息外传指令。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
