## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.16p2

**利用条件:** 具有本地普通用户访问权限，目标系统安装有受影响版本的Sudo且配置了chroot相关权限或存在chroot执行逻辑。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的POC代码和Dockerfile分析，该漏洞（CVE-2025-32463）存在于Sudo组件的chroot处理逻辑中。POC通过Dockerfile构建了一个包含受影响版本（1.9.16p2）的Ubuntu环境，并引入了名为`sudo-chwoot.sh`的利用脚本。从搜索结果[3]可以看到，该脚本在执行后成功将uid从1001提升至0（root），验证了漏洞的真实性。漏洞的核心成因在于Sudo在处理chroot功能时，对非可信控制范围的验证不当，导致攻击者可以绕过预设的路径限制或通过特定的文件系统操作实现提权。该POC提供了完整的构建环境和利用脚本，对于防御性研究而言具有极高的参考价值，能够清晰展示从普通用户权限获取root权限的攻击路径。利用步骤：1. 在目标系统中下载或编写POC脚本（如sudo-chwoot.sh）。2. 确保系统存在受影响的Sudo版本（1.9.16p2及以下）。3. 赋予脚本执行权限：chmod +x sudo-chwoot.sh。4. 执行脚本：./sudo-chwoot.sh。5. 脚本利用Sudo在chroot处理上的缺陷，通过特定的路径溢出或环境变量注入，诱导Sudo以root权限执行任意命令或开启一个新的root shell。6. 验证权限：输入id命令，确认当前用户为root。投毒风险分析：该POC的投毒风险评级为15%，属于低风险。分析主要基于以下几点：首先，POC代码库结构清晰，包含标准的Dockerfile和README说明文件，符合安全研究社区的规范。其次，核心逻辑主要体现在Shell脚本和C语言编写的演示代码中，未发现经过高度混淆（Obfuscation）的二进制payload或加密段。虽然README中提到了从GitHub Releases下载预编译文件的建议（见搜索结果[4]和README内容），这在理论上存在供应链攻击的可能性（即预编译文件可能被替换为恶意程序），但提供的Dockerfile是从Sudo官网下载源码现场编译，这种透明的构建过程极大降低了后门植入的风险。代码中未发现明显的反向Shell连接到非公开IP或非标准的eval执行敏感系统路径的操作。建议研究人员在测试时，优先选择基于源码编译的Dockerfile方式，避免直接运行来自非官方Release页面的预编译二进制文件，以确保研究环境的安全可控。该POC的主要目的是用于漏洞复现和防御特征提取，不具备典型的恶意软件投毒特征。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
