## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 本地普通用户权限，系统安装了受影响版本的 Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-32463 是 Sudo 程序中的一个本地权限提升漏洞。该漏洞存在于 Sudo 处理 --chroot 参数的过程中。当 sudo 在执行命令前切换 root 目录（chroot）时，它错误地加载了用户可控目录下的 /etc/nsswitch.conf 配置文件。攻击者可以利用这一特性，通过创建一个恶意的 chroot 环境，并在其中放置伪造的 nsswitch.conf 指向恶意的共享库，从而在 sudo 执行过程中以 root 身份加载并执行任意代码。此漏洞的影响非常广泛，涵盖了主流的 Linux 发行版如 Ubuntu、Debian 和 CentOS 等。利用该漏洞，本地普通用户可以轻易获取完全的 root 控制权，从而导致整个系统的沦陷。POC 有效性分析：根据搜索结果和提供的 Dockerfile 来看，该漏洞具有极高的复现成功率。Dockerfile 中明确指定了受影响的 sudo-1.9.16p2 版本，并配合 sudo-chwoot.sh 脚本进行利用。这种环境隔离的复现方式证明了漏洞逻辑的稳定性。POC 脚本通常包含创建虚假根目录、配置恶意 nsswitch.conf 以及编译注入库的步骤。利用步骤：首先，攻击者需要进入一个受影响的 Linux 环境。其次，准备一个自定义的目录作为伪造的 root 路径，并在该路径下的 etc 目录中写入恶意的 nsswitch.conf 文件。接着，编译一个恶意共享库，使其在被加载时执行提权代码（如执行 /bin/bash）。最后，使用 sudo --chroot 指向该伪造目录并执行任意命令，触发 sudo 加载恶意配置并最终弹出 root shell。投毒风险分析：该 POC 项目的投毒风险被评估为低（15%）。代码本身逻辑清晰，主要由 Shell 脚本、C 源码和 Dockerfile 组成，便于安全研究员进行静态审计。虽然搜索结果中提到了 Rust 实现的版本和预编译二进制文件，但主要的 GitHub 仓库代码结构透明。风险主要源于：1. 某些第三方提供的‘一键利用脚本’或‘预编译二进制’可能在提权成功后悄悄建立反弹 Shell 或植入 SSH 后门；2. 搜索结果 2 中提到的 bash1234 等简化演示代码可能包含非预期的系统修改。防御人员在测试时应始终优先在隔离的 Docker 容器中运行，避免直接在宿主机执行未经审计的二进制文件。整体而言，该 POC 是用于安全研究的高质量资源，但使用时仍需警惕来源不明的预编译版本。

**项目地址:** [https://github.com/pr0v3rbs/CVE-2025-32463_chwoot](https://github.com/pr0v3rbs/CVE-2025-32463_chwoot)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
