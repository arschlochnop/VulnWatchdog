## CVE-2025-32463 - Sudo 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 具有本地普通用户访问权限，且系统安装了受影响版本的 Sudo

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于 Sudo 在处理 --chroot 参数时，未能正确隔离或验证来自用户可控目录下的 /etc/nsswitch.conf 配置文件。在受影响的版本（1.9.17p1 之前）中，如果攻击者能够控制 chroot 环境内的路径，Sudo 会加载该路径下的名称服务开关配置，导致攻击者可以加载恶意的共享库。提供的 Dockerfile 显示其基础环境为 Ubuntu 24.04，并手动编译安装了存在漏洞的 Sudo 1.9.16p2 版本。POC 脚本 sudo-chwoot.sh 通过构建特定的目录结构，利用 --chroot 选项强制 Sudo 读取恶意的 nsswitch 配置，进而实现从普通用户到 root 用户的权限提升。经分析，该利用链条在逻辑上是完整的，且针对特定版本具有极高的成功率，适合在实验室环境下进行漏洞复现。利用步骤：首先，在受影响的系统上准备一个普通用户环境；其次，创建一个受控目录并在其中伪造 /etc/nsswitch.conf 文件及相关的恶意库文件（如 libnss_custom.so.2）；然后，执行带有 --chroot 参数的 sudo 命令指向该目录；最后，Sudo 在执行过程中会加载恶意库，触发其中的 payload（通常是 /bin/bash 的 setuid 调用），从而获得 root shell。投毒风险分析：该 POC 项目（以 K1tt3h/CVE-2025-32463-POC 为代表）代码结构较为清晰，主要由 Shell 脚本和 Dockerfile 组成，便于安全研究人员进行代码审计。风险点在于搜索结果中提到了 pre-built binary（预编译二进制文件）的使用，这是典型的风险项。在安全界，直接运行来源不明的二进制文件（如 README 中提到的 tar 解压后的 exploit）极易导致主机被植入后门或木马。虽然 Dockerfile 本身是安全的（仅用于构建漏洞环境），但 README 引导用户从 Release 页面下载编译好的文件，这类操作绕过了源代码审计，存在中低度的投毒风险。建议研究人员务必通过 Rust 源码或 C 源码自行编译，切勿直接运行 Release 中的二进制程序。此外，脚本中虽然没有明显的代码混淆，但仍需警惕在执行过程中可能产生的外部网络连接请求，建议在隔离的沙箱或虚拟机内运行。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
