## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有受限用户权限的本地系统访问权限，系统安装了受影响版本的Sudo且允许使用--chroot选项或类似配置。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于Sudo版本1.9.17p1之前。其核心缺陷在于使用--chroot选项时，Sudo未能正确隔离用户受控目录中的/etc/nsswitch.conf文件。在执行过程中，Sudo会加载该受控目录下的名称服务切换配置，导致攻击者可以通过伪造恶意共享库（通过nsswitch.conf加载）来以root身份执行任意代码。根据提供的POC数据，包含了一个Dockerfile用于构建易受攻击的1.9.16p2环境，以及一个sudo-chwoot.sh脚本。搜索结果显示已有基于Rust和Bash的完整利用实现，能够实现从普通用户到root的跳转。POC通过创建一个包含恶意nsswitch.conf和编译好的库文件的chroot环境，诱导sudo加载，从而获得特权，证明了该漏洞在特定配置下具有极高的利用稳定性。【利用步骤】1. 准备攻击负载：编写一个惡意的共享对象文件（.so），其内容为设置UID为0并启动shell。2. 构建虚假根目录：创建一个临时文件夹作为chroot环境，并在其中创建etc目录。3. 伪造配置文件：在etc目录下放置恶意的nsswitch.conf，配置其加载步骤1中创建的库。4. 执行触发：使用sudo --chroot [/path/to/fake/root] [command]命令。Sudo在进入chroot前或期间会读取该目录下的nsswitch.conf并加载恶意库。5. 获取权限：恶意库代码执行，用户获得root shell。【投毒风险分析】该漏洞的相关POC存在中等程度的投毒风险。分析发现：1. 供应链风险：搜索结果3和4中提到了“预编译二进制使用”，这是极高的安全风险点。安全研究员或管理员在测试时若直接运行未审计的二进制文件，可能导致测试机被植入后门。2. 伪装链接：README文档中引用的Release下载链接指向了外部GitHub仓库。在安全社区中，经常有黑客利用热门CVE漏洞发布伪造的POC仓库，其中的脚本可能包含Base64编码的恶意指令、反弹Shell或静默安装木马。3. 脚本内容可疑：描述中提到的‘chwoot-demo.c’或‘sudo-chwoot.sh’虽然在功能上是POC，但如果不加审计地运行，攻击者可能在脚本中夹带了窃取本地凭据（如/etc/shadow或SSH Keys）的命令。建议在完全隔离的容器环境（如提供的Dockerfile）中进行复现，并严禁直接执行任何下载的二进制文件。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
