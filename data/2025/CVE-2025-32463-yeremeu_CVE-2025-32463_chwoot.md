## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 本地低权限用户访问，目标系统启用了 sudo 的 chroot 功能或允许使用 --chroot 参数

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

POC有效性分析：根据提供的搜索结果和代码片段，该POC针对的是Sudo中的chroot安全缺陷。Sudo在处理--chroot参数时，未对用户控制目录下的配置文件（如/etc/nsswitch.conf）进行充分的验证和隔离。提供的Dockerfile展示了一个完整的漏洞复现环境，它下载并编译了存在漏洞的Sudo 1.9.16p2版本，并配置了一个普通用户pwn以及名为sudo-chwoot.sh的利用脚本。此脚本的核心逻辑通常是通过创建一个受控的chroot环境，并在该环境中放置恶意的nsswitch.conf文件。当Sudo以root权限在chroot环境中尝试解析用户或组信息时，会加载并执行该恶意配置文件指向的动态链接库，从而实现从普通用户到root用户的权限提升。搜索结果显示该漏洞已在野利用且有公开POC，证明其有效性极高。利用步骤：1. 在目标机器上创建一个可写的目录作为伪造的chroot根目录；2. 在该目录下构造特定的目录结构，包括复制必要的系统库文件；3. 在该目录的etc/下创建恶意的nsswitch.conf文件，并配置它指向一个攻击者编写的恶意.so文件；4. 编写该.so文件，其初始化函数执行提权操作（如执行/bin/sh并赋予SUID权限）；5. 运行sudo --chroot [伪造目录] [任意命令]，触发Sudo加载恶意库；6. 成功获取root shell。投毒风险分析：该漏洞相关的POC存在明显的中等投毒风险。首先，README中提到的Releases下载链接指向了一个外部地址（[github.com/yeremeu/](https://www.google.com/search?q=https://github.com/yeremeu/)...），此类外部编译产物往往是投毒的高发区，攻击者常利用高危漏洞的热度分发预编译的二进制后门。其次，提供的Dockerfile中虽然展示了源码编译过程，但其引用的sudo-chwoot.sh脚本内容未完全公开，可能包含隐蔽的外部下载指令或凭据窃取逻辑。此外，README中的安装步骤引导用户运行`tar -xvf`和`gcc`编译，这种交互式过程容易降低用户的警惕性。最关键的是，搜索结果显示该漏洞在野利用活跃，攻击者极有可能在GitHub等平台上发布名为POC实为Reverse Shell或Stealer的恶意项目。用户在测试此类脚本时，务必在隔离的沙箱或虚拟机中运行，并严格审查脚本中是否包含curl/wget下载未知脚本并管道执行（| bash）的行为，以及是否存在混淆的Base64代码。本次分析的POC包因包含引导用户从非官方Release获取文件的行为，投毒风险评估为45%。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
