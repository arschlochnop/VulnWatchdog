## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 本地低权限用户访问，目标系统存在 sudo 且支持 --chroot 参数

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开的漏洞详情和POC脚本分析，CVE-2025-32463是一个存在于Sudo程序中的严重本地权限提升漏洞。该漏洞的根源在于Sudo在处理--chroot参数时，未能正确隔离外部资源的引用。具体而言，当用户指定一个受控目录作为chroot环境时，Sudo会尝试从该目录中加载/etc/nsswitch.conf文件。攻击者可以通过创建一个恶意的nsswitch.conf文件并将其放置在自己控制的目录中，结合特制的共享库，利用Sudo在root权限下运行的特性，诱导系统加载恶意的共享库（如通过passwd或group数据库映射）。在提供的Dockerfile环境中，通过构建存在漏洞的1.9.16p2版本Sudo，配合sudo-chwoot.sh脚本可以实现稳定的提权。利用步骤：1. 在本地创建一个由攻击者控制的目录，并在该目录下伪造符合nsswitch.conf格式的文件；2. 在该目录中放置恶意的共享库文件，使其包含在库搜索路径或通过nsswitch配置触发加载；3. 执行命令 'sudo --chroot [受控目录] [任意命令]'。由于Sudo在进入chroot环境前未清除或重置必要的安全环境变量，或者在加载配置文件时缺乏对路径的严格校验，导致其以root权限执行了攻击者植入的恶意库代码。实验证明，该漏洞在主流发行版（如Ubuntu、Debian）的旧版本上具有极高的触发成功率。投毒风险分析：该POC目前主要表现为教育和研究用途，代码逻辑相对透明。在分析提供的README及脚本片段时，发现其采用了典型的GitHub Release分发模式。投毒风险主要集中在以下几点：首先，README中引导用户从外部链接下载预编译的.tar.gz压缩包（如Release v1.0.0），而非直接提供源代码审计，这是一种常见的潜在投毒手段，攻击者可能在编译好的二进制文件中植入后门。其次，利用脚本sudo-chwoot.sh可能包含未经过滤的外部下载指令。然而，从Dockerfile的构建逻辑来看，其使用的是官方Sudo源码库进行本地编译，这降低了直接供应链投毒的风险。综合评估，该漏洞的公开POC中，若直接运行未经审计的shell脚本或二进制文件，存在约15%的投毒风险。建议安全研究人员在隔离的沙箱环境（如Dockerfile所构建的环境）中进行测试，并严格审查sudo-chwoot.sh的每行代码，避免执行从非官方Release下载的二进制程序。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
