## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 1.9.17p1之前版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞源于sudo在处理chroot选项时，允许用户控制的目录中的/etc/nsswitch.conf文件被使用，从而允许本地用户获得root权限。

POC有效性分析：

提供的Dockerfile文件构建了一个易受攻击的Sudo版本（1.9.16p2），并创建了一个普通用户pwn。sudo-chwoot.sh脚本很可能包含利用该漏洞的代码。README.md文件提供了有关漏洞利用的说明，包括安装、使用和示例。编译exploit.c，说明可能存在C语言编写的利用程序。

利用步骤：

1.  构建包含漏洞版本的Sudo的Docker镜像。
2.  以普通用户身份登录到Docker容器。
3.  编译并运行sudo-chwoot.sh脚本或exploit.c程序。
4.  如果漏洞利用成功，普通用户将获得root权限。

投毒风险分析：

该POC的投毒风险较低，因为:

1.  Dockerfile和README.md文件清晰地描述了漏洞利用过程。
2.  POC代码（sudo-chwoot.sh和exploit.c）很可能直接利用漏洞，而不是包含恶意代码。
3.  该POC的目的是演示漏洞利用，而不是在目标系统上安装后门。

但是，仍然存在一些潜在的投毒风险:

1.  攻击者可能会修改POC代码，以包含恶意代码。
2.  用户在运行POC代码之前，应该仔细检查代码，以确保其不包含任何恶意行为。
3. Dockerfile从`https://www.sudo.ws/dist/sudo-1.9.16p2.tar.gz`下载源代码，需要确保该链接的安全性，如果被中间人攻击，可能会被植入恶意代码。

总而言之，该POC的投毒风险较低，但用户在运行POC代码之前，应该仔细检查代码，以确保其不包含任何恶意行为。漏洞利用本身可能会导致系统不稳定或数据丢失，因此建议在测试环境中使用该POC。

具体来说，`sudo-chwoot.sh`脚本可能包含以下操作：

*   创建一个包含恶意配置的`/etc/nsswitch.conf`文件。
*   使用`sudo -R`选项运行命令，并指定包含恶意`/etc/nsswitch.conf`文件的目录。
*   `sudo`将使用恶意`/etc/nsswitch.conf`文件来解析用户名，从而允许攻击者执行任意命令。

`exploit.c`程序可能包含以下操作：

*   利用Sudo的`--chroot`选项中的漏洞。
*   通过构造恶意的环境变量或命令行参数来绕过安全检查。
*   执行任意命令并获得root权限。

**项目地址:** https://github.com/yeremeu/CVE-2025-32463_chwoot

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
