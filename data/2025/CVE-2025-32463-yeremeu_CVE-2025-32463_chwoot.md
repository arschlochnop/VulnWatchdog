## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (High)

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前的版本中的本地提权漏洞。该漏洞源于chroot选项处理/etc/nsswitch.conf文件时存在缺陷，允许本地用户通过用户控制的目录获取root权限。POC代码分析显示，该POC包含一个Dockerfile和一个bash脚本，用于构建易受攻击的Sudo版本并执行提权。Dockerfile通过ubuntu:24.04镜像构建环境，安装必要的编译工具和依赖项，下载并编译存在漏洞的Sudo 1.9.16p2版本。随后，创建一个名为pwn的普通用户，并将提权脚本sudo-chwoot.sh复制到该用户的home目录下。最后，切换到pwn用户并启动bash shell。sudo-chwoot.sh脚本利用了chroot选项的漏洞，通过精心构造的/etc/nsswitch.conf文件，使得Sudo以root权限执行命令，从而实现提权。从搜索结果和POC代码来看，该漏洞利用过程简单，易于复现，且影响范围较广。利用步骤如下：
1. 使用Dockerfile构建包含漏洞的Sudo环境。
2. 切换到普通用户pwn。
3. 运行sudo-chwoot.sh脚本。
4. 成功获取root权限。

该POC的有效性较高，因为它提供了一个完整的可执行的漏洞利用方案。POC代码清晰，易于理解，并提供了详细的说明文档。然而，该POC也存在一定的投毒风险。虽然Dockerfile和bash脚本本身没有明显的恶意代码，但攻击者可能会修改这些文件，例如在编译Sudo时添加后门，或者在提权脚本中执行恶意操作。此外，攻击者还可能将该POC与其他漏洞利用代码捆绑在一起，形成更为复杂的攻击链。由于POC代码中主要使用了apt-get安装软件，wget下载源码，tar解压，./configure编译等常规操作，且脚本内容清晰，未发现eval，base64编码等可疑操作，投毒风险较低，预估为10%。尽管如此，用户在使用该POC时仍需保持警惕，仔细审查代码，确保其安全性。

**项目地址:** https://github.com/yeremeu/CVE-2025-32463_chwoot/releases

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
