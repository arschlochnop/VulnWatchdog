## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (High)

**影响版本:** Sudo before 1.9.17p1, 1.9.14及之后引入-R/--chroot选项的版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞源于Sudo在实现chroot功能时，未能正确处理非可信控制范围。具体来说，当Sudo以chroot模式运行时，它会使用用户控制的目录中的/etc/nsswitch.conf文件。攻击者可以通过创建一个恶意的nsswitch.conf文件，并将其放置在一个他们可以控制的目录中，然后利用Sudo的chroot功能来执行任意代码，从而获得root权限。该漏洞利用的关键在于`--chroot`选项允许用户指定一个根目录，而Sudo没有充分验证该目录的内容，导致可以从用户可控的目录加载`/etc/nsswitch.conf`配置文件。此配置文件用于名称服务切换，攻击者可以利用它来加载恶意动态链接库，从而执行任意代码。POC代码的有效性分析：提供的Dockerfile构建了一个易受攻击的Sudo环境（1.9.16p2版本）。Dockerfile首先安装了构建工具和依赖，然后下载、编译和安装了存在漏洞的Sudo版本。接着，它创建了一个名为pwn的普通用户，并将PoC脚本sudo-chwoot.sh复制到该用户的home目录下。最后，它切换到pwn用户并运行bash shell。README.md文件描述了漏洞的细节和利用方法。利用步骤如下：
1.构建包含漏洞版本的Sudo的Docker镜像。
2.以pwn用户身份运行Docker容器。
3.执行sudo-chwoot.sh脚本，该脚本会利用漏洞提升权限。

投毒风险分析：该POC的投毒风险较低。Dockerfile主要用于构建漏洞环境，使用的都是常见的系统工具和官方源，没有发现恶意行为。sudo-chwoot.sh脚本的功能是利用漏洞，其行为是可预期的。尽管如此，仍然存在一些潜在的风险。例如，Dockerfile中wget下载的sudo安装包的来源如果被篡改，可能会引入恶意代码。此外，攻击者可能会修改sudo-chwoot.sh脚本，使其在利用漏洞的同时执行其他恶意操作，例如安装后门或窃取敏感信息。然而，从提供的代码来看，没有明显的投毒迹象，因此风险较低。代码清晰，主要使用标准库，没有发现可疑的外部脚本或eval调用。总体而言，该POC的投毒风险较低，但用户仍然应该保持警惕，仔细审查代码，并在隔离环境中运行。

**项目地址:** https://github.com/yeremeu/CVE-2025-32463_chwoot

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
