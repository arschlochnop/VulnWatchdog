## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (High)

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞源于程序在使用--chroot选项时，没有正确处理用户控制目录下的/etc/nsswitch.conf文件。攻击者可以利用这一点，通过控制/etc/nsswitch.conf文件来获得root权限。

POC有效性分析：
根据搜索结果和提供的POC代码，该漏洞的利用方式是通过创建一个恶意的/etc/nsswitch.conf文件，并将其放置在一个用户可控的目录下。当sudo以chroot模式运行时，会加载这个恶意的配置文件，从而导致提权。提供的Dockerfile文件构建了一个存在漏洞的Sudo版本（1.9.16p2），并复制了一个名为sudo-chwoot.sh的PoC脚本，这表明该PoC具有实际的可利用性。README.md文件也提供了详细的漏洞描述、受影响系统以及利用步骤。综合来看，该POC质量较高，具备完整性和可操作性。

利用步骤：
1.  构建存在漏洞的Sudo环境，可以使用提供的Dockerfile。
2.  创建一个恶意的/etc/nsswitch.conf文件，该文件能够执行攻击者控制的命令。
3.  将该文件放置在一个用户可控的目录下。
4.  使用sudo以chroot模式运行，并指定该用户可控目录为chroot根目录。
5.  当sudo加载恶意的/etc/nsswitch.conf文件时，攻击者即可获得root权限。

投毒风险分析：
该POC的投毒风险较低，主要原因如下：
1.  代码清晰：Dockerfile和PoC脚本代码相对清晰，没有明显的混淆或隐藏恶意行为。
2.  标准库：POC主要使用标准库函数，没有引入可疑的第三方库。
3.  无可疑行为：POC的目的是利用已知的Sudo漏洞进行提权，没有发现额外的恶意行为，例如植入后门、窃取信息等。
4.  依赖特定环境：POC需要在存在漏洞的Sudo版本上运行，并且需要用户具有一定的权限才能进行利用，这限制了其传播范围和危害。

尽管如此，仍然需要注意以下潜在的投毒风险：
1.  替换恶意文件：攻击者可能将恶意的/etc/nsswitch.conf文件伪装成正常文件，诱骗用户下载和使用。
2.  捆绑恶意代码：攻击者可能将POC代码与恶意代码捆绑在一起，例如植入后门或窃取用户凭据。

为了降低投毒风险，建议从可信的来源获取POC代码，并仔细审查代码，确保其没有包含恶意行为。同时，及时更新Sudo版本，以修复已知的安全漏洞。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
