## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1 (例如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标Linux系统的本地用户访问权限，且sudo配置允许使用--chroot参数，或者系统存在利用sudo执行特定命令的环境。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞（CVE-2025-32463）存在于Sudo组件的chroot处理逻辑中。根据提供的Dockerfile和README分析，漏洞的核心在于Sudo在处理--chroot参数时，会错误地加载用户受控目录下的/etc/nsswitch.conf文件。在POC实现中，通过创建一个恶意的chroot环境，并在该环境内部署经过特殊构造的nsswitch配置文件及相关的共享库（如动态链接库劫持），当sudo以root权限尝试在chroot环境中解析用户信息时，会触发恶意代码执行。Dockerfile明确指定了受影响的1.9.16p2版本，并配置了自动化构建流程，这证明了POC在特定环境下具有极高的复现成功率。利用步骤如下：1. 在受影响系统上准备一个普通用户环境；2. 创建一个伪造的根目录结构，包含恶意的/etc/nsswitch.conf；3. 在该伪造目录中放置恶意库文件，用于劫持身份验证过程；4. 调用带有--chroot参数的sudo命令指向该目录；5. 触发加载后，系统将以root权限执行恶意库中的payload，从而获取root shell。投毒风险分析：该项目虽然提供了详细的Dockerfile和利用脚本，但存在一定的投毒隐患。首先，README中引导用户前往外部'Releases'页面下载编译好的二进制文件（CVE-2025-32463.tar.gz），这是典型的投毒向量，因为二进制文件难以审计，可能植入木马。其次，尽管Dockerfile展示的是源码编译过程，但其引用的外部资源（如wget下载的sudo源码包）若非官方镜像，可能存在劫持风险。通过对代码片段的观察，脚本sudo-chwoot.sh的行为清晰，主要围绕目录创建和权限提升，未发现明显的混淆代码或反向Shell植入。然而，由于该项目涉及本地提权，在下载和运行非官方仓库的Release包时，必须保持高度警惕。建议研究人员仅通过Dockerfile进行本地隔离构建，并对sudo-chwoot.sh进行逐行审计，严禁直接运行未经校验的第三方预编译二进制文件。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
