## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有受限本地用户权限，系统中安装了存在缺陷的sudo版本，且允许使用--chroot选项或存在特定nsswitch配置。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是Sudo组件在处理--chroot参数时存在的安全缺陷。根据POC代码分析，漏洞核心在于Sudo在切换到chroot环境时，错误地加载了由用户控制目录下的/etc/nsswitch.conf文件。在正常逻辑下，chroot应当限制进程访问外部资源，但由于Sudo在执行权限切换前未能正确处理命名服务切换（NSS）的配置加载路径，攻击者可以创建一个恶意的chroot目录，并在其中伪造nsswitch.conf和对应的共享库。当以--chroot执行sudo命令时，系统会加载攻击者提供的恶意动态链接库（.so文件），从而在root上下文中执行任意代码。POC中提供的Dockerfile完整模拟了这一环境，通过下载存在漏洞的1.9.16p2版本进行编译安装，证明了该POC具有极高的真实性和可复现性。利用脚本sudo-chwoot.sh通过构造恶意的根目录结构，利用Sudo对配置文件处理的不当实现从普通用户到root用户的提权。此POC并非简单的概念验证，而是具备完整提权能力的自动化脚本。【利用步骤】1. 在本地系统中准备一个受控目录作为伪chroot根环境；2. 在该目录下创建/etc/nsswitch.conf，并配置其加载非标准的NSS模块；3. 编译一个恶意的共享库（如libnss_pwn.so.2），并在其初始化函数中加入提权代码（如chmod +s /bin/bash）；4. 执行命令 `sudo --chroot /path/to/evil_dir /bin/true`；5. 此时Sudo会加载恶意库，执行提权指令，随后攻击者即可通过执行/bin/bash -p等方式获取root Shell。【投毒风险分析】该POC项目目前的投毒风险评级为低（15%）。分析其代码构成：Dockerfile主要用于搭建易受攻击的实验环境，下载链接指向官方sudo.ws域名，无重定向风险；README中提供的安装步骤涉及gcc编译本地c文件，这是典型的漏洞利用方式。然而，值得警惕的是README中提到引导用户去GitHub Releases页面下载编译好的二进制文件或压缩包（CVE-2025-32463.tar.gz），这在威胁情报领域是常见的投毒向量。虽然脚本源码层面表现清晰，但如果攻击者在Releases的预编译包中植入后门（如反弹Shell或键盘记录器），用户直接运行编译产物将面临严重威胁。此外，由于漏洞发生在2025年7月左右，属于较新漏洞，目前网络上散布的同名POC仓库可能存在恶意篡改。建议安全研究人员在测试时，务必只参考其逻辑并自行编写代码，严禁直接运行来源不明的二进制程序。代码本身未见明显的eval注入或混淆，但对外部Release包的依赖是主要的潜在风险点。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
