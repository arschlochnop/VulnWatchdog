## CVE-2025-32463 - Sudo 权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17p1 之前的版本

**利用条件:** 本地低权限用户访问；系统安装了受影响版本的 Sudo；允许用户在受控目录下构建 chroot 环境。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞源于 Sudo 在处理 chroot 机制时存在的路径解析实现缺陷。当 sudo 配置为允许在特定目录下执行 chroot 时，它未能正确限制动态链接库的加载路径。攻击者可以创建一个恶意的 chroot 环境，并在其中放置伪造的共享对象文件（动态库）。当 sudo 以 root 权限在 chroot 环境中执行时，会错误地加载攻击者提供的恶意库，从而导致任意代码以 root 身份执行。提供的 POC 代码（如 Dockerfile 和 .sh 脚本）显示了完整的复现链：首先通过编译特定版本（1.9.16p2）的 sudo 构建易受攻击环境，然后通过脚本自动化执行提权逻辑。搜索结果显示该 POC 在多种 Linux 发行版（Ubuntu, Debian）上均有复现成功的案例，且存在 Rust 编写的高级版本，证明了利用方案的成熟度和有效性。

【利用步骤】1. 准备阶段：在本地系统或容器内确认 sudo 版本处于 1.9.14 至 1.9.16p2 之间。2. 环境部署：创建一个攻击者可控的目录作为伪造的根环境，并在此目录内构造特定的目录结构（如 /lib, /usr/lib）。3. 库劫持：将编译好的恶意共享库放置在上述目录中，确保其名称符合 sudo 运行时加载的需求。4. 触发漏洞：使用 sudo 执行 chroot 命令指向该目录，由于 sudo 的路径解析逻辑错误，它将加载并执行恶意库中的代码。5. 获取权限：恶意代码执行后通常会生成一个具有 root 权限的 shell 或修改 /etc/passwd 等关键文件，完成提权。

【投毒风险分析】在开源社区及安全论坛中流通的该漏洞 POC 存在一定的投毒风险。分析发现，部分公开的仓库（如提到的 GitHub 链接）包含预编译的二进制文件或复杂的自动化构建脚本。投毒风险主要体现在：1. 混淆的 Shell 脚本：部分脚本可能在提权成功后悄悄下载远程木马或开启反弹 shell，将研究者的机器变为僵尸网络的一部分。2. 恶意库文件：由于漏洞利用核心在于动态库加载，攻击者可能分发已编译好的 .so 文件，这些文件中除了包含提权逻辑外，还可能隐藏了后门。3. 虚假 POC：在一些社交平台上，存在以 CVE-2025-32463 为名实际执行一键删库或信息窃取脚本的案例。当前分析的 Dockerfile 显示其从 sudo 官网下载源码编译，行为相对透明，风险较低。但建议研究人员在测试时务必在隔离的虚拟机或容器环境中运行，并对所有 .sh 和 .c 源码进行逐行审计，避免直接运行未经审查的预编译二进制包。

**项目地址:** [https://github.com/yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32463](https://avd.aliyun.com/detail?id=AVD-2025-32463)
