## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 具有受限本地用户访问权限，且 sudo 允许使用 --chroot 选项

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是由于 Sudo 在处理 --chroot 选项时存在设计缺陷，导致其加载用户可控目录下的 /etc/nsswitch.conf 配置文件。攻击者可以通过在受控目录下构造恶意的 nsswitch 配置文件及配套的动态链接库（共享对象文件），诱导 sudo 加载这些不受信任的库。提供的 Dockerfile 显示了一个完整的漏洞复现环境，基于 Ubuntu 24.04 并手动编译了存在漏洞的 sudo 1.9.16p2 版本。README.md 虽然包含了一些模版化的下载链接（可能指向未验证的二进制文件），但其核心逻辑符合 Sudo chroot 提权的已知利用路径。利用步骤：1. 在用户可写目录下创建一个伪造的根目录结构（如 /tmp/fake_root）；2. 在该目录下创建 /etc 目录并放入修改过的 nsswitch.conf，配置其加载特定的加载项（如 passwd: files mysos）；3. 编译并放置一个恶意的共享库（如 mysos.so），其中包含提升权限的代码或 shell 调用；4. 执行 sudo --chroot /tmp/fake_root -u root [command]，此时 sudo 将根据伪造的 nsswitch.conf 加载攻击者的恶意库，从而在 root 上下文中执行任意代码。投毒风险分析：该项目的投毒风险处于较低水平，但仍需谨慎。Dockerfile 脚本主要使用官方源（sudo.ws）进行源码编译，这是安全的透明操作。代码中主要包含 Bash 脚本和 C 语言源文件，便于审计。然而，README.md 中诱导用户前往 GitHub Releases 下载预编译的压缩包（CVE-2025-32463.tar.gz）的行为需要警惕。在安全研究实践中，下载并执行未经审计的二进制利用程序是极高风险的行为，因为此类预编译文件可能包含隐藏的后门、反弹 Shell 或恶意木马。此外，搜索结果中出现了不相关的、具有误导性的外部链接（如结果 3 和 7），这表明在非官方渠道获取相关工具时可能遭遇 SEO 投毒或恶意广告诱导。建议研究人员仅参考其 Dockerfile 提供的复现逻辑，自行编写或编译利用代码，避免直接运行发布包中的二进制文件。

**项目地址:** [https://github.com/yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
