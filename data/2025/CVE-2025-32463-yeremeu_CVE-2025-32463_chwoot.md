## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 攻击者必须拥有目标系统的本地普通用户访问权限，且 sudo 命令支持 --chroot 选项或存在特定的 nsswitch 配置文件解析逻辑错误。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Sudo 的 chroot 功能实现中。根据提供的 POC 代码和搜索结果，漏洞的核心在于 Sudo 在处理 --chroot 参数时，未对用户受控目录下的 /etc/nsswitch.conf 文件进行充分的安全性校验。攻击者可以通过创建一个恶意的 chroot 环境，并在其中放置精心构造的 nsswitch.conf 文件，诱导 Sudo 加载恶意共享库，从而在执行时获取 root 权限。提供的 Dockerfile 展示了完整的漏洞复现环境，使用 ubuntu:24.04 并手动编译安装了受影响的 sudo-1.9.16p2 版本。配套的 sudo-chwoot.sh 脚本利用了该机制实现提权。该 POC 逻辑清晰，包含了环境搭建（Dockerfile）和执行脚本，具有极高的实战参考价值和复现成功率。利用步骤：1. 在受影响的系统中创建一个可写的目录作为伪造的 root 根目录。2. 在该目录下创建 etc 目录，并写入恶意构造的 nsswitch.conf，配置其加载攻击者控制的动态链接库（如恶意库）。3. 准备提权脚本或编译好的恶意 .so 文件。4. 执行 sudo --chroot [恶意目录] [命令]，触发 Sudo 加载该目录下的配置文件。5. 由于 Sudo 以 root 身份运行，加载恶意库后将直接执行攻击者定义的 payload，最终弹出 root shell。投毒风险分析：该 POC 项目中包含预编译二进制文件的引用（见搜索结果3），这是主要的风险来源。虽然提供的 Dockerfile 和 README 展现了开源的意图，但 readme 中提到的从 'Releases' 页面下载并执行二进制文件的行为在威胁情报视角下属于中低风险投毒行为。攻击者常利用此类高危漏洞的 POC 吸引安全研究人员下载，并在预编译的 exploit 二进制文件中植入后门。目前公开的代码片段（Dockerfile、.sh 脚本）本身未见混淆或恶意外部请求，主要使用标准构建工具（gcc, wget, make），其代码透明度较高。然而，对于任何要求下载并解压运行外部 tar.gz 或执行二进制文件的仓库，必须保持警惕。建议研究人员仅参考其逻辑，在隔离的沙箱环境中使用源码自行编译，以规避可能潜伏的供应链投毒风险。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
