## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1 (例如 1.9.16p2 及更早版本)

**利用条件:** 攻击者必须拥有目标系统的本地普通用户访问权限，且系统安装了受影响版本的 Sudo。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：根据公开披露的漏洞信息和POC代码分析，CVE-2025-32463 是 Sudo 历史上一个关键的本地提权漏洞。该漏洞源于 Sudo 在处理 `--chroot` 参数时，未能正确隔离或校验用户可控目录下的配置文件（如 /etc/nsswitch.conf）。POC 代码显示，通过创建一个受控的 chroot 环境，攻击者可以欺骗 Sudo 加载恶意库或配置文件，从而绕过安全策略并以 root 权限执行命令。输入数据中的 Dockerfile 展示了漏洞环境的搭建过程，明确指向 sudo-1.9.16p2 版本为脆弱版本，而 sudo-chwoot.sh 脚本提供了自动化提权的逻辑。该 POC 在实验环境下表现出极高的成功率，能够直接将普通用户 shell 提升至 UID 0。利用步骤如下：1. 在本地创建一个攻击者可写的目录作为伪造的 chroot 根目录；2. 在该目录的 /etc/ 目录下放置恶意的 nsswitch.conf 文件；3. 准备恶意共享对象（.so 文件）并配置 nsswitch 使其加载该对象；4. 使用带 --chroot 参数的 sudo 命令指向该目录；5. 触发 Sudo 加载逻辑，执行共享对象中的恶意代码，通过 setuid(0) 和 execve() 获取 root shell。 投毒风险分析：该 POC 整体表现为标准的安全研究脚本，投毒风险处于较低水平（约 15%）。代码结构清晰，主要使用了 Shell 和 Rust/C 语言编写，核心逻辑聚焦于系统调用和目录结构的构造。README 中提到的‘Releases section’下载链接需要保持警惕，因为预编译的二进制文件（如 exploit 二进制文件）无法进行源码审计，是投毒攻击的常见载体。攻击者可能在编译后的二进制文件中植入反弹 shell 或木马程序。此外，输入中提到的某些 GitHub 链接可能指向非官方的分叉仓库，存在通过下载 external 脚本或混淆代码段进行二次感染的可能。建议防御者在分析时仅参考源码，并在隔离的沙箱或 Docker 环境中编译运行。虽然 Dockerfile 本身是安全的（从官方源拉取基础镜像并从 sudo 官网下载源码编译），但若脚本中包含未经验证的 curl|bash 操作，则风险会显著提升。目前提供的文本片段未发现明显恶意后门，但需关注外部引用的二进制包安全性。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
