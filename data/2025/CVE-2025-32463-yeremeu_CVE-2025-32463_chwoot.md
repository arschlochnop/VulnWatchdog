## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** 1.9.17p1之前版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是Linux sudo组件中的一个高危本地提权漏洞，存在于1.9.17p1之前的版本中。该漏洞源于chroot实现中对非可信控制范围的处理不当，攻击者可利用--chroot选项和用户可控的/etc/nsswitch.conf文件获取root权限。具体来说，Sudo从1.9.14版本开始引入了-R/–chroot选项，允许用户指定chroot目录，但由于对用户提供的配置文件的验证不足，攻击者可以通过操纵/etc/nsswitch.conf文件来执行任意代码。攻击者需要本地用户权限，但利用成功后可以获得root权限，从而完全控制受影响的系统。

POC有效性分析：
提供的Dockerfile构建了一个包含漏洞版本的sudo环境，并提供了一个sudo-chwoot.sh脚本作为PoC。通过README.md文件，可以了解到该漏洞的利用方式涉及使用`sudo -R <user_controlled_dir> command`，其中`<user_controlled_dir>`包含一个特制的/etc/nsswitch.conf文件。此文件会被sudo使用，允许攻击者控制名称服务切换的行为，从而执行恶意代码。Dockerfile中构建的sudo版本为1.9.16p2，位于受影响的版本范围内，因此PoC具有有效性。漏洞利用的成功依赖于目标系统存在sudo并且版本在受影响范围内，以及攻击者能够控制/etc/nsswitch.conf文件。

利用步骤：
1.  构建包含漏洞版本的sudo环境（如使用提供的Dockerfile）。
2.  创建一个包含恶意配置的/etc/nsswitch.conf文件。
3.  使用`sudo -R <user_controlled_dir> command`命令，其中`<user_controlled_dir>`指向包含恶意/etc/nsswitch.conf文件的目录。
4.  执行任意命令，以root权限运行。

投毒风险分析：
该PoC的投毒风险较低。主要原因是：
1.  提供的Dockerfile和shell脚本都比较清晰，没有发现任何混淆代码或恶意行为。
2.  Dockerfile主要用于构建包含漏洞的环境，没有执行任何额外的网络请求或外部脚本。
3.  利用过程依赖于sudo本身的漏洞，而不是通过引入恶意代码来实现。
4.  shell脚本sudo-chwoot.sh主要用于演示漏洞利用过程，代码较为简单，没有发现任何可疑行为。
但是，仍然存在一些潜在的风险：
1. 如果攻击者修改了/etc/nsswitch.conf文件，可能会导致系统功能异常或崩溃。
2.  如果攻击者在利用过程中下载了额外的文件或脚本，可能会引入恶意代码。
3.  需要注意的是，利用此漏洞需要本地用户权限，如果系统存在其他漏洞，攻击者可能会通过其他漏洞获取本地用户权限，然后再利用此漏洞进行提权。总的来说，该PoC的投毒风险较低，但仍然需要保持警惕，避免引入额外的恶意代码。

**项目地址:** https://github.com/yeremeu/CVE-2025-32463_chwoot

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
