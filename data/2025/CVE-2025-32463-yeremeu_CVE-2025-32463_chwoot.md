## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** High

**CVSS评分:** 7.5

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限，且目标系统安装了受影响版本的Sudo程序。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于Sudo程序的--chroot（-R）选项中。根据披露的信息，Sudo在执行带有--chroot参数的命令时，未能正确处理用户受控目录下的配置文件加载逻辑。具体而言，它会从用户指定的chroot目录中加载/etc/nsswitch.conf文件。本地攻击者可以通过创建一个恶意的chroot环境，并在其中的/etc/nsswitch.conf里配置自定义的Name Service Switch插件（如恶意的动态链接库），从而在Sudo以root权限运行这些插件时执行任意代码，实现从普通用户到root用户的权限提升。提供的POC代码包含一个Dockerfile，用于构建受影响的Sudo版本（1.9.16p2），这证明了漏洞环境是可重现的。README文档描述了基本的利用流程：通过编译exploit.c并运行来触发漏洞。由于Sudo是类Unix系统的核心组件，此漏洞具有极高的实用价值。利用步骤通常包括：1. 准备一个包含恶意nsswitch.conf和恶意共享库的伪造根目录结构；2. 调用带有-R参数的sudo指向该目录；3. 触发系统服务查询以加载恶意库。\n\n【投毒风险分析】该POC项目存在中等程度的投毒风险。首先，README中引导用户去外部链接（GitHub Releases）下载预编译的二进制文件或压缩包（CVE-2025-32463.tar.gz），这是典型的投毒诱饵，攻击者可能在这些压缩包中植入后门。其次，项目描述中存在前后不一致的情况：Dockerfile中引用的是sudo-chwoot.sh脚本，而安装说明中又提到需要编译exploit.c。这种不一致性可能意味着README是批量生成的模板。此外，攻击者常利用CVE-2025这类年份较新的漏洞编号（即便实际年份尚未到达，可能为预留或虚构编号）来吸引安全研究人员。在防御性分析过程中，必须警惕该仓库提供的Release下载链接，严禁直接在宿主机运行未经审计的二进制文件。代码中使用的wget和git操作也需要仔细检查，以防在构建阶段从恶意服务器拉取投毒载荷。

**项目地址:** [https://github.com/yeremeu/CVE-2025-32463_chwoot](https://github.com/yeremeu/CVE-2025-32463_chwoot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
