## CVE-2025-32463 - Sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 本地普通用户访问权限，Sudo配置允许使用 --chroot 参数且存在非预期的 nsswitch.conf 加载路径。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞（CVE-2025-32463）源于Sudo在处理--chroot选项时的逻辑缺陷。在1.9.17p1之前的版本中，当用户使用带有--chroot参数的sudo命令时，程序未能正确隔离或清理用户可控目录下的配置文件环境。具体而言，系统会错误地加载用户控制目录中的/etc/nsswitch.conf文件。攻击者可以创建一个恶意的nsswitch.conf，并配合自定义的共享库（如通过passwd或group插件加载），在sudo提权执行过程中诱导程序加载该恶意库，从而以root身份执行任意代码。从提供的Dockerfile和代码结构看，该POC通过构建特定的Sudo 1.9.16p2版本环境，能够稳定复现从普通用户pwn提升至root权限的过程。利用步骤：1. 在用户可控目录下伪造根目录结构（如/home/pwn/fake_root）。2. 在该伪造目录中创建etc子目录，并写入恶意的nsswitch.conf文件。3. 编写并编译一个恶意的.so共享库，将其路径配置在伪造的nsswitch.conf中。4. 执行命令 `sudo --chroot /home/pwn/fake_root <command>`，此时sudo会尝试在chroot环境中读取nsswitch配置并加载恶意库。5. 恶意库中的初始化函数被调用，直接获取root shell。投毒风险分析：该POC的公开版本（源自GitHub项目K1tt3h/CVE-2025-32463-POC）主要包含Dockerfile、Bash脚本和C源码。初步代码审计显示其逻辑清晰，主要用于学术研究和安全测试。然而，投毒风险在于以下几点：首先，README中引导用户通过Release页面下载预编译的二进制文件（CVE-2025-32463.tar.gz），这种预编译包往往是恶意载荷潜伏的高危区，攻击者可能在编译后的exploit程序中植入反弹Shell或木马；其次，部分GitHub克隆库（如搜索结果中提到的不同用户仓库）可能修改了Makefile或exploit.c，添加了额外的外部下载指令或对敏感目录（如~/.ssh/authorized_keys）的非法操作。鉴于提权类漏洞POC极易被修改为窃取Root凭据的工具，建议防御者仅在隔离的沙箱环境中使用源代码进行审计后编译，严禁直接运行任何来源不明的预编译二进制包或包含eval命令的Shell脚本。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
