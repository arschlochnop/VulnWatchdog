## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (High)

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个Sudo的本地提权漏洞，存在于1.9.17p1之前的版本中。该漏洞允许本地用户通过 `--chroot` 选项使用用户可控目录下的 `/etc/nsswitch.conf` 文件来获取root权限。 

POC有效性分析：
提供的Dockerfile和README.md文件清晰地描述了漏洞的利用方式。Dockerfile用于构建一个包含漏洞版本的Sudo的Ubuntu环境。通过`wget`下载并编译Sudo 1.9.16p2版本，然后创建一个普通用户`pwn`，将PoC脚本复制到该用户的home目录下。README.md详细说明了漏洞的细节，包括影响的系统、安装和使用方法。`sudo-chwoot.sh`（未提供具体内容，但根据描述推测）应该是利用该漏洞的关键脚本。整体来看，该PoC提供了一个完整的利用链，从环境搭建到漏洞触发，具有很高的有效性。

利用步骤：
1. 使用Dockerfile构建一个包含漏洞版本的Sudo的Docker镜像。
2. 运行该镜像，创建一个普通用户（例如`pwn`）。
3. 将PoC脚本（`sudo-chwoot.sh`）复制到该用户的home目录下。
4. 切换到该用户，并运行PoC脚本。
5. 脚本利用`--chroot`选项和一个精心构造的`/etc/nsswitch.conf`文件，导致Sudo以root权限执行命令，从而实现提权。

投毒风险分析：
该PoC的投毒风险较低，主要原因是：
1. 代码清晰：Dockerfile和README.md都提供了清晰的步骤和说明，没有发现任何混淆或隐藏的代码。
2. 标准库：Dockerfile主要使用apt-get、wget、tar等标准工具，没有引入任何第三方库或组件。
3. 无可疑行为：PoC的目的明确，即利用Sudo漏洞进行提权，没有发现任何与此目的无关的行为，例如窃取用户数据、安装后门等。
4. 脚本依赖：虽然`sudo-chwoot.sh`脚本的具体内容未知，但可以推测其主要功能是构造恶意`/etc/nsswitch.conf`文件并利用`--chroot`选项触发漏洞。这种利用方式本身不涉及恶意代码或后门。
5. 权限控制：PoC的利用需要在本地用户权限下进行，无法远程触发，降低了投毒的风险。
6. 镜像隔离：通过Dockerfile构建Docker镜像运行PoC，可以将PoC与宿主机隔离，进一步降低了潜在的风险。

尽管如此，仍然需要注意以下几点：
*  确保从可信的来源下载PoC代码。
*  在隔离环境中运行PoC，避免对生产环境造成影响。
*  仔细审查`sudo-chwoot.sh`脚本的内容，确保其没有包含恶意代码。

**项目地址:** https://github.com/yeremeu/CVE-2025-32463_chwoot

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
