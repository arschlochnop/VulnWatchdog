## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 攻击者必须拥有受影响系统的本地低权限用户访问权限，且 sudo 程序被赋予了 chroot 权限或环境配置允许 --chroot 参数的使用。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 25%

## 详情

【POC有效性分析】该漏洞源于 Sudo 在处理 `--chroot` 参数时的不当安全实现。根据搜索结果和提供的 Dockerfile 分析，Sudo 1.9.17p1 之前的版本允许本地用户在特定的 chroot 环境中通过控制 /etc/nsswitch.conf 文件来影响系统的查找逻辑。POC 代码展示了攻击者如何创建一个受控目录，通过在该目录中伪造 nsswitch 配置，引导 sudo 加载恶意插件或利用库加载机制，从而绕过原本的安全限制。Dockerfile 展示了在 Ubuntu 24.04 环境下手动编译安装受影响的 1.9.16p2 版本 sudo 的过程，这证明了环境复现的可行性。脚本 `sudo-chwoot.sh` 被设计用于自动化利用流程。该 POC 具有较高的实战价值，因为它不需要复杂的交互，只需在本地执行脚本即可获得 root 权限，且已有多个 GitHub 仓库（如 K1tt3h 和 kh4sh3i）发布了针对该漏洞的利用脚本，证明了社区的验证热度。利用步骤通常包括：1. 创建一个用户可控的目录作为伪 chroot 根目录；2. 在该目录下的 /etc/ 目录中写入恶意的 nsswitch.conf；3. 执行带有 --chroot 参数的 sudo 命令触发漏洞；4. 通过环境变量或库劫持获取提权后的 Shell。【投毒风险分析】在对此 POC 及其相关仓库进行防御性评估时，发现存在一定的投毒风险。虽然核心漏洞逻辑是真实的，但部分搜索结果（如结果 2）提到的 `chwoot-demo.c` 和 `sudo-chwoot.sh` 脚本在未公开源码的情况下，可能包含恶意后门。特别是 README 中诱导用户前往 `Releases` 页面下载预编译二进制文件或压缩包（CVE-2025-32463.tar.gz）的行为，是典型的供应链攻击手法。安全研究员应警惕这类要求下载执行外部二进制文件的 POC，因为它们可能在提升权限的同时，秘密安装持久化后门（如修改 ~/.ssh/authorized_keys）或泄露主机敏感数据（如 /etc/shadow）。由于目前已知的 CVE-2025-32463 属于虚构或未来预警性质的数据（根据 2025 年的时间线推测），大量出现的 GitHub 仓库可能包含为安全从业者准备的『蜜罐』或恶意程序。评估认为其投毒风险处于低至中等水平（25%），主要风险点在于 README 引导的外部链接下载和编译过程中的隐藏指令。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
