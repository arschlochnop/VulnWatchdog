## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2)

**利用条件:** 本地普通用户访问权限，目标系统安装了受影响版本的 Sudo，且允许用户执行带有 --chroot 选项或相关配置的 sudo 命令。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Sudo 1.9.17p1 之前的版本中。其核心问题在于使用 `--chroot` 参数时，Sudo 错误地加载了用户可控目录下的 `/etc/nsswitch.conf` 配置文件。在 Linux 系统中，`nsswitch.conf` 决定了系统如何查找用户信息、主机名等。攻击者可以通过创建一个恶意的 chroot 环境，并在其中放置伪造的 `nsswitch.conf` 和恶意的共享库（如通过 `passwd` 模块加载的库），诱导以 root 权限运行的 Sudo 加载该恶意库，从而实现从普通用户到 root 用户的权限提升。提供的 POC 包含 Dockerfile 用于构建易受攻击的环境，以及 Shell 脚本和 C 代码（chwoot-demo.c/exploit.c）用于执行攻击。Dockerfile 明确拉取了 `sudo-1.9.16p2` 进行编译安装，这证明了环境的可复现性。利用步骤：1. 在本地创建一个目录作为伪造的根目录。2. 在该目录下构建特定的文件系统结构，特别是 `/etc/nsswitch.conf`。3. 编写一个恶意共享库，其内容通常为执行 `/bin/sh` 或修改 `/etc/shadow`。4. 执行 `sudo --chroot [目录] [命令]`，触发 Sudo 对恶意配置的加载。5. 成功后将直接获得 root 权限。该 POC 代码逻辑清晰，针对 Sudo 的 chroot 处理逻辑缺陷进行了精准打击，具有极高的实战参考价值。投毒风险分析：经过对提供的数据和外部链接描述的综合评估，该漏洞相关的公开资源存在中低度投毒风险。虽然 GitHub 上的 K1tt3h 仓库展示了标准的 POC 脚本和 Docker 环境，代码结构透明且易于审计，但搜索结果 [3] 提到的‘预编译二进制使用’是一个显著的红旗。在安全社区中，提供未经审计的预编译二进制文件（Exp.exe 或 Linux 编译好的 ELF）是投毒的常用手段，这些文件可能捆绑了反弹 Shell 或后门木马。此外，README 中引导用户去外部 Release 页面下载 `CVE-2025-32463.tar.gz` 的行为也需要警惕，因为压缩包内的内容可能与 README 描述的纯净源码不符。分析过程中未发现明显的恶意混淆代码，但鉴于此类提权漏洞的高热度，建议研究人员仅在隔离的沙箱环境中使用源码进行编译，切勿直接运行任何预编译的可执行文件，并仔细检查 Makefile 或构建脚本中是否包含 curl 到可疑域名的操作。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
