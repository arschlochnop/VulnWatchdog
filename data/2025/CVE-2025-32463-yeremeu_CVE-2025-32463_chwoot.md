## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo before 1.9.17p1

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞允许本地用户通过利用用户控制目录中的/etc/nsswitch.conf文件以及--chroot选项获得root权限。根据提供的搜索结果和POC代码，该漏洞利用涉及以下步骤：

1.  **环境准备**: 搭建一个包含漏洞版本的Sudo的环境。Dockerfile文件展示了如何使用Ubuntu 24.04构建一个包含Sudo 1.9.16p2的Docker镜像。该镜像安装了必要的编译工具和依赖项，例如build-essential、libpam0g-dev等，然后从sudo.ws下载并编译安装了存在漏洞的Sudo版本。
2.  **用户创建**: 创建一个普通用户（例如pwn），用于执行提权操作。
3.  **POC脚本准备**: 将POC脚本（sudo-chwoot.sh）复制到普通用户的home目录，并更改所有者。
4.  **漏洞触发**: 使用普通用户身份运行POC脚本，该脚本会利用--chroot选项和用户控制的/etc/nsswitch.conf文件来提升权限。
5.  **权限提升**: 成功利用该漏洞后，普通用户可以获得root权限。

POC有效性分析：提供的Dockerfile和README文件表明该POC是一个完整的、可执行的漏洞利用程序。README文件详细描述了漏洞的细节、影响的系统以及利用步骤。Dockerfile提供了一个可重复的环境，方便用户验证该漏洞。POC代码中包含的脚本（sudo-chwoot.sh）很可能实现了利用漏洞的具体步骤，例如创建恶意的/etc/nsswitch.conf文件，并使用sudo命令的--chroot选项来触发漏洞。

利用步骤：

1.  构建包含漏洞Sudo的Docker镜像。
2.  创建一个普通用户。
3.  将POC脚本复制到普通用户的home目录。
4.  切换到普通用户身份。
5.  运行POC脚本。
6.  验证是否成功获得root权限。

投毒风险分析：

该POC的投毒风险较低。主要原因如下：

1.  **代码清晰**: Dockerfile和README文件提供了清晰的步骤和说明，易于理解和审查。
2.  **标准库**: POC代码主要使用标准库和系统工具，没有发现恶意代码或外部脚本。
3.  **权限控制**: POC代码仅在本地环境中运行，不会尝试访问外部网络或执行未经授权的操作。
4.  **目的明确**: 该POC的目的是验证和演示漏洞，而不是执行恶意活动。

尽管如此，仍然需要注意以下几点：

1.  **来源可信度**: 确保从可信的来源下载POC代码，以避免下载被篡改的版本。
2.  **环境隔离**: 在隔离的环境中运行POC代码，以防止对生产系统造成意外影响。
3.  **代码审查**: 在运行POC代码之前，仔细审查代码，以确保没有恶意行为。

考虑到以上因素，该POC的投毒风险较低，约为10%。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
