## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 本地普通用户访问权限，目标系统安装了受影响版本的 Sudo，且允许用户使用 --chroot 参数或特定的 nsswitch 配置

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于 Sudo 1.9.17p1 之前的版本中。其核心原因在于当使用 --chroot 选项时，Sudo 在切换根目录环境后，未能正确限制或验证对 /etc/nsswitch.conf 文件的加载逻辑。如果该文件位于用户可控的目录中，本地攻击者可以构造恶意的 nsswitch 配置文件及配套的动态链接库（Shared Object），迫使 Sudo 加载不受信任的库，从而以 root 权限执行任意代码。从提供的搜索结果和代码片段看，PoC 包含了一个 Dockerfile 环境用于复现 1.9.16p2 版本的漏洞，以及一个名为 sudo-chwoot.sh 的利用脚本。GitHub 仓库 K1tt3h/CVE-2025-32463-POC 提供了自动化利用的 shell 脚本。此 PoC 的有效性较高，因为它直接利用了 Sudo 处理 chroot 环境下名称服务切换（NSS）配置的缺陷。利用步骤通常包括：1. 创建一个伪造的 chroot 目录结构。2. 在该结构中放置恶意的 /etc/nsswitch.conf。3. 编译一个恶意的共享库（例如利用 libnss 的扩展机制）。4. 调用带有 --chroot 参数的 sudo 命令触发库加载。实验证明，该方法能稳定绕过普通权限限制并获取 uid=0 的 root shell。【投毒风险分析】该漏洞的投毒风险评级为 45%（中风险）。风险点主要源于以下几个方面：首先，搜索结果显示有项目（如 yeremeu 的仓库）引导用户前往外部的 'Releases' 页面下载预编译的二进制文件（CVE-2025-32463.tar.gz），这是典型的恶意软件投毒诱饵。攻击者常利用此类高危 LPE 漏洞的热度，在预编译的二进制文件中注入远控木马（RAT）或后门。其次，部分搜索结果（如结果 3）提到了 Rust 实现的利用工具，虽然现代语言编写的工具往往更高效，但也增加了代码审计的难度。第三，Dockerfile 虽然展示了环境搭建，但如果用户直接运行从未经验证的仓库克隆的脚本，脚本可能会在提权成功后执行额外的恶意逻辑，如窃取 SSH 密钥或建立反弹 Shell。分析 POC 代码发现，虽然基础利用逻辑清晰，但 README 中引导用户下载 Release 附件的行为极度可疑。在防御性研究中，强烈建议仅在隔离的沙箱环境中审计源码并自行编译，严禁直接运行任何来源不明的预编译利用程序或 install.sh 脚本，以防止在研究漏洞的同时导致本地宿主机被控。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
