## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 本地用户访问权限，目标系统安装了受影响版本的 Sudo

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

POC有效性分析：该漏洞 CVE-2025-32463 是 Sudo 程序中的一个关键安全缺陷。其核心问题在于当 Sudo 使用 --chroot 选项时，会错误地从用户可控制的目录加载 /etc/nsswitch.conf 配置文件。在 Linux 系统中，nsswitch.conf 决定了系统如何查找用户、组和主机名等信息，并允许加载动态链接库（NSS 模块）。攻击者通过在受控目录下伪造 nsswitch.conf 并在该目录中放置恶意的动态库，当 Sudo 以 root 权限执行并进入该 chroot 环境时，会加载并执行该恶意库，从而实现从普通用户到 root 用户的权限提升。提供的 POC 代码包含了一个 Dockerfile，其环境构建逻辑非常清晰：它下载并编译了存在漏洞的 sudo-1.9.16p2 版本，并配置了一个名为 'pwn' 的低权限用户。这证明了 POC 具有较高的可重现性和技术参考价值，不仅仅是理论上的概念验证。利用步骤：首先，攻击者需要获得目标系统的本地 shell 访问权限。其次，创建一个受攻击者控制的目录作为伪 chroot 环境，并在其中伪造目录结构，包括放入恶意的 /etc/nsswitch.conf 文件。接着，将编译好的恶意共享对象（.so 文件）放入该目录下的库路径中。最后，调用带有 --chroot 参数的 sudo 命令指向该目录，Sudo 在初始化过程中会加载恶意库，从而在 root 上下文中执行攻击者预定义的代码，通常是弹出 root shell 或修改敏感文件。该 POC 虽然在 Dockerfile 中仅展示了环境搭建，但配套的 README 提到了具体的编译和执行步骤。投毒风险分析：该项目存在中等程度的投毒风险。风险点主要体现在其获取核心利用代码的方式上。README 中明确引导用户前往外部的 'Releases' 链接（[github.com/yeremeu/](https://www.google.com/search?q=https://github.com/yeremeu/)...）下载预编译的二进制文件或压缩包，而不是直接在仓库中提供完整的源码。这是恶意软件分发的典型手法，攻击者可能在预编译的二进制文件或 release 压缩包中植入后门程序、勒索软件或窃密木马。虽然 Dockerfile 本身的构建脚本（基于官方 Ubuntu 镜像和 Sudo 官网源码）是透明且安全的，但其核心 exploit.c 代码在当前截断的文本中并未完整展示。防御研究员在测试此类 POC 时，必须保持高度警惕，严格禁止在宿主机直接运行从 Release 页面下载的任何文件。建议仅参考 Dockerfile 构建的隔离环境进行行为观察，并对下载的压缩包进行深度静态扫描和沙箱审计，以防在复现漏洞的过程中遭受供应链投毒攻击。

**项目地址:** [https://github.com/kh4sh3i/CVE-2025-32463](https://github.com/kh4sh3i/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
