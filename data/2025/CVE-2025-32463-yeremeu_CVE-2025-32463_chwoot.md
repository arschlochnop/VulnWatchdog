## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 7.5

**影响版本:** Sudo 1.9.17p1 之前的版本 (如 1.9.16p2 等)

**利用条件:** 攻击者必须拥有目标系统的本地用户访问权限，且 sudo 配置允许使用 --chroot 选项或相关 NSS 配置存在缺陷。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是 Sudo 组件中的一个严重安全缺陷，源于其在处理 --chroot 选项时对 /etc/nsswitch.conf 配置文件的加载逻辑存在问题。根据提供的 POC 代码分析，攻击者可以通过创建一个受控的目录环境，并在其中伪造恶意的 nsswitch.conf 文件。当 sudo 在 chroot 环境下运行时，它会错误地从用户控制的目录加载该配置文件，进而通过加载恶意共享库（动态链接库）的方式实现权限提升。Dockerfile 展示了一个典型的实验环境，安装了 1.9.16p2 版本的漏洞组件。利用脚本 sudo-chwoot.sh 旨在自动化这一过程。经过代码逻辑评估，该漏洞利用路径清晰且符合 Sudo 权限管理的逻辑缺陷，在未打补丁的 Linux 发行版（如 Ubuntu 20.04 或 Debian 10）上具有极高的成功率。该漏洞不仅是概念验证，更是可以直接导致系统完全失陷的完整利用工具。 【利用步骤】1. 在目标系统上准备一个普通用户权限的 shell。2. 下载或编写恶意的动态链接库（.so 文件），该库包含提权至 root 的代码（如 setuid(0); execve('/bin/sh', ...)）。3. 创建一个临时工作目录，并在其中创建 /etc 目录结构。4. 在该伪造的 /etc 下放置恶意的 nsswitch.conf，并指向恶意库。5. 执行带 --chroot 参数的 sudo 命令，触发加载逻辑。6. 获得 root 权限。 【投毒风险分析】该 POC 存在中等程度的投毒风险。分析 README.md 发现，其诱导用户从外部链接（GitHub Releases）下载预编译的二进制文件或压缩包（CVE-2025-32463.tar.gz），而不是直接提供全透明的源代码，这是威胁情报中的典型红旗（Red Flag）。攻击者往往在编译好的二进制文件中植入反弹 shell 或后门（如窃取 /etc/shadow 或 ssh keys）。此外，部分搜索结果（如 K1tt3h 仓库）虽然提供了脚本，但脚本中可能包含向外部服务器传输敏感信息的混淆命令。鉴于该漏洞发布于 2025 年 7 月，且短时间内出现了多个自动化利用工具，大量攻击者会利用安全研究人员急于验证漏洞的心理进行『黑吃黑』式投毒。建议研究人员仅在隔离的 Docker 容器中审计并运行此代码，严禁在生产环境或宿主机直接下载并执行 Release 附件。风险点主要集中在第三方提供的编译脚本和二进制 payload 完整性上。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
