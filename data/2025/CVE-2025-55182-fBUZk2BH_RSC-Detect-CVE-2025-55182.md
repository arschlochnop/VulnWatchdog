## CVE-2025-55182 - React Server Components, Next.js applications 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js applications

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** 未明确指定受影响版本范围，但影响使用React Server Components和Next.js框架的应用程序。

**利用条件:** 无需认证，可通过网络访问，攻击者需构造恶意multipart表单。

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：
提供的POC，名为“RSC-Detect”，是一个专门的检测工具，而非CVE-2025-55182的直接利用工具。其主要目标是识别使用React Server Components (RSC) 和Next.js框架的网站，这些框架是此关键漏洞的基础技术。该工具通过向目标URL发送轻量级HTTP请求，并仔细检查响应中的各种指示器来完成此任务。这些指示器包括特定的RSC标记（如`__flight__`、`react-server-streaming`和`__REACT_SERVER_APP__`）、特定的`Content-Type`头（如`text/x-component`和`text/vnd.rsc`）。此外，它还会检查HTML内容中Next.js特有的模式（如`__NEXT_DATA__`、`/_next/static/`、`next-font`和`next/script`），以及是否存在`x-powered-by: next.js`头。
作为一个检测工具，“RSC-Detect”非常有效，兼具轻量级、快速和准确的特点。它仅依赖于`requests`库，每个目标只需执行一个HTTP请求，并采用多种检测模式以确保可靠性。其简洁性使其易于理解和修改，对安全研究人员进行评估时的侦察、Web开发人员了解竞争对手框架、DevOps团队进行技术资产清点以及漏洞赏金猎人快速指纹识别目标应用程序都极具价值。然而，必须重申，此工具不包含任何直接利用CVE-2025-55182的代码。其作用仅限于识别可能存在漏洞的潜在目标，作为使用单独的、专用漏洞利用程序进行实际攻击前的准备步骤。

利用步骤：
CVE-2025-55182，绰号“React2Shell”，是一个严重的远程代码执行（RCE）漏洞，CVSS评分为10.0，表明其具有极高影响。它主要影响使用React Server Components (RSC) 和Next.js应用程序。问题的根源在于React Flight的反序列化机制，该机制在处理对象属性访问路径（特别是`__proto__`和`constructor`属性）时未能充分验证。这一漏洞为原型链污染攻击打开了大门。
攻击者可以无需认证并通过网络构造一个经过精心设计的`multipart`表单请求来利用此漏洞。攻击的核心在于操纵反序列化过程。攻击者利用序列化数据流中的`$B`引用，结合可控的`_response._prefix`。关键是，他们劫持了`_formData.get`方法，将其强制转换为`Function`类型。这种复杂的操纵允许攻击者动态生成一个包含任意系统命令的函数。然后，这个新创建的恶意函数被赋值给一个合法对象的`.then`属性，这种模式通常与Promise或异步操作相关联。当易受攻击的应用程序尝试处理或评估此对象，特别是当`.then`被调用时，嵌入的任意系统命令将在底层服务器上执行。这种执行使攻击者获得远程代码执行能力，从而能够完全控制受感染的服务器。利用过程需要理解React Flight的内部序列化和反序列化细节，以及JavaScript原型链操纵技术，但一旦开发出可行的Payload，它就可以广泛分发和自动化，导致像披露后不久观察到的“大规模实际利用”。

投毒风险分析：
提供的“RSC-Detect”POC代码显示出极低的投毒风险，估计约为10%。此评估基于对其结构、依赖关系和操作逻辑的全面审查。该代码使用Python编写，是一种广为人知的语言，并且代码量紧凑。它唯一的外部依赖是`requests`库，这是一个标准且信誉良好的HTTP客户端，最大程度地减少了第三方包引入的攻击面。
至关重要的是，代码的功能透明且直接符合其声明的目的：向指定目标URL发送良性HTTP GET请求，然后解析HTTP头和响应体以查找预定义的字符串模式。代码中没有发现混淆技术，而混淆通常是恶意意图的常见指标。该脚本不包含或尝试加载任何外部的、不受信任的脚本或二进制文件。此外，它避免使用`eval()`或`exec()`等动态代码执行函数，这些函数可能被利用进行任意代码注入。代码流程是线性且可预测的，主要涉及HTTP GET请求和字符串匹配；它不尝试建立未经授权的外部连接（除了对指定目标的合法HTTP请求）或以意想不到的方式操纵系统资源。`main.py`文件清晰地列出了目标列表，`analyzeTarget`函数明确详细说明了其HTTP请求和模式匹配操作。虽然没有代码能完全免疫复杂的供应链攻击或意外泄露，但“RSC-Detect”的清晰、简洁和专注的特性显著降低了其包含隐藏恶意Payload或后门的风险。建议用户始终从经过验证的来源获取此类工具，并在执行前自行进行安全审查，但在其当前形式下，投毒风险极低。

**项目地址:** https://github.com/fBUZk2BH/RSC-Detect-CVE-2025-55182.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
