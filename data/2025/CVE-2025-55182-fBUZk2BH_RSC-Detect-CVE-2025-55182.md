## CVE-2025-55182 - React Server Components (RSC) 及 Next.js 应用程序 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC) 及 Next.js 应用程序

**危害等级:** 核弹级/严重

**CVSS评分:** 10.0

**影响版本:** 未明确指定版本范围，影响使用React Server Components的Next.js应用程序

**利用条件:** 无需认证，需要网络访问，通过精心构造的请求

**POC 可用性:** 9/10

**POC 类型:** 仅说明/概念验证 (目标检测器)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个严重的远程代码执行（RCE）漏洞，CVSS 评分为 10.0 分，被业内广泛称为“核弹级”漏洞。该漏洞影响 React 服务器组件（RSC）和 Next.js 应用程序，由 Lachlan Davidson 于 2025 年 12 月 3 日披露。自披露以来，该漏洞已遭到大规模的实际利用，最早的攻击尝试可追溯至 2025 年 12 月 4 日，对 Windows 终端进行攻击。

该漏洞的核心技术原理在于 React Flight 反序列化机制未对对象属性访问路径（如 `__proto__`、`constructor`）进行充分校验。攻击者可以通过构造恶意的 multipart 表单，利用 `$B` 引用结合可控的 `_response._prefix`，并将 `_formData.get` 等方法劫持为 `Function` 对象。通过这种方式，攻击者可以动态生成包含任意系统命令的函数，并将其赋值给对象的 `.then` 属性。当服务器端处理这些序列化的 React 组件数据时，恶意的函数便会被执行，从而导致远程代码执行，最终实现对目标系统的完全控制。此漏洞主要影响 `react-server-dom-webpack` 等组件。

**POC有效性分析:**
提供的 POC 代码名为 `RSC-Detect`，是一个 Python 脚本，其主要目的是检测目标网站是否使用了 React Server Components (RSC) 和 Next.js 框架。它通过检查 HTTP 响应中的特定 RSC 标记（如 `__flight__`, `react-server-streaming`, `__REACT_SERVER_APP__`）、特定的 Content-Type 头（如 `text/x-component`, `text/vnd.rsc`）、Next.js 特有的 HTML 结构（如 `__NEXT_DATA__`, `/_next/static/`），以及 `x-powered-by: next.js` 头部信息来识别这些技术栈。这个工具是一个轻量级的检测器，仅依赖 `requests` 库，执行速度快，并且通过多种模式检测提高了准确性。需要强调的是，`RSC-Detect` *并非*一个直接利用 CVE-2025-55182 执行 RCE 的漏洞利用工具，而是一个用于识别潜在易受攻击目标的预扫描工具。对于其宣称的“检测”功能，该工具是完整、可用且文档齐全的，能够有效帮助安全研究人员和开发者在渗透测试或资产清点阶段快速识别使用RSC和Next.js的应用程序。因此，作为一种检测机制，其POC质量评分为 9/10。

**利用步骤:**
1.  **目标识别:** 使用 `RSC-Detect` 等工具扫描并识别运行 React Server Components 或 Next.js 的目标应用程序。
2.  **恶意负载构造:** 攻击者需要精心构造一个恶意的 `multipart` 表单数据负载。
3.  **原型链污染:** 利用 React Flight 反序列化机制的缺陷，通过 `$B` 引用，结合受控的 `_response._prefix` 以及劫持 `_formData.get` （或其他类似方法）为 `Function` 类型，实现原型链污染或对象属性的恶意操纵。
4.  **命令注入:** 在动态生成的 `Function` 对象中嵌入任意的系统命令（例如通过调用 `child_process.execSync`）。
5.  **属性赋值:** 将包含恶意命令的 `Function` 赋值给某个会在服务器端处理过程中被调用的对象的 `.then` 属性。
6.  **发送请求:** 将构造好的恶意请求发送到目标 React Server Component 的处理端点。
7.  **代码执行:** 服务器在反序列化并处理请求时，将触发 `.then` 属性中注入的恶意函数，从而执行系统命令，导致远程代码执行。

**投毒风险分析:**
对 `RSC-Detect` 这个 POC 代码进行分析，其投毒风险评估为低风险（约 10%）。该 Python 脚本的实现非常透明和简洁。它主要依赖于标准的 `requests` 库进行 HTTP 请求，并对返回的响应内容（包括头部和 HTML 正文）进行字符串匹配。代码中没有发现任何混淆、恶意外部脚本引用、使用 `eval()` 函数执行动态代码，或进行任何与其检测目的不符的异常网络通信。脚本的日志输出也清晰地展示了其检测过程。因此，该 POC 代码被认为是一个安全、无恶意行为的工具，专门用于技术栈的识别，不包含任何隐藏的后门或投毒机制。用户可以安全地下载和运行此工具来识别潜在的易受攻击目标。

**项目地址:** https://github.com/fBUZk2BH/RSC-Detect-CVE-2025-55182.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
