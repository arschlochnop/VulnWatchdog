## CVE-2025-27591 - Below (Linux系统监控工具) 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Below (Linux系统监控工具)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < v0.9.0

**利用条件:** 1. 目标系统安装了低于0.9.0版本的below工具；2. /var/log/below目录被设置为全局可写（World-writable）；3. 当前低权限用户具备通过sudo运行'below record'的权限（通常在不需要密码的情况下更容易触发）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了一个经典的符号链接（Symlink）攻击场景，用于在Linux环境下实现从普通用户到root用户的权限提升。其核心逻辑在于利用`below`服务在记录日志时未安全处理文件路径的缺陷。在受影响的版本中，`/var/log/below`目录权限被错误地设置为777（drwxrwxrwx），这意味着任何本地用户都可以在该目录下创建或删除文件。POC通过在该目录下创建一个指向敏感系统文件（如`/etc/passwd`）的符号链接，诱使以root权限运行的`below`进程将日志信息写入该链接。虽然日志内容本身可能无法直接控制，但通过后续利用——如手动向该符号链接（实际上是`/etc/passwd`）写入预先构造的、UID为0的新用户信息——攻击者可以成功篡改系统认证数据库。验证步骤显示，该漏洞利用链条完整且直接，能够在具备sudo权限的环境下稳定复现。利用步骤：1. 确认`/var/log/below`目录权限为全局可写；2. 清除已有的日志文件并创建一个名为`error_root.log`的符号链接，指向`/etc/passwd`；3. 准备一个包含新root用户定义的payload字符串；4. 触发`sudo below record`命令，使root权限的进程尝试访问并操作该符号链接，通过劫持文件流，普通用户可以使用`cp`命令覆盖`/etc/passwd`；5. 使用`su`命令切换到新创建的root账号。投毒风险分析：该POC代码由Python脚本`dbs_exploit.py`和详尽的Markdown说明文档组成。经过代码审计，该POC的主要行为集中在本地文件系统操作（os.symlink, os.remove）和本地子进程调用（subprocess.run）。脚本中不包含混淆代码、Base64加密的恶意负载或远程Webshell下载行为，其操作逻辑与披露的CVE原理高度吻合。风险点在于该POC虽然是用于安全研究，但其自动化脚本`dbs_exploit.py`可能包含对本地敏感文件的强制覆盖操作，如果用户在生产环境直接运行，可能导致系统账号配置丢失或损坏。此外，虽然目前未发现明显的反连恶意服务器代码，但在复杂的安全工具分发过程中，第三方二次修改的脚本可能被植入恶意指令。当前分析的版本属于低风险，主要风险源于操作失误导致的系统破坏而非主动投毒。建议在隔离的沙箱或虚拟机环境中测试，并人工核对脚本中的文件写入目标，防止误伤宿主机。

**项目地址:** N/A (本地分析文件: /tmp/vulnwatchdog_7ddb3e9e4e91f458d027e6f851dfad62)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
