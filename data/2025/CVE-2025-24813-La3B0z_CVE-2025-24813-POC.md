## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires network access to the vulnerable Tomcat instance with the partial PUT feature enabled.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability affecting Apache Tomcat. The vulnerability lies in the improper handling of partial PUT requests, allowing attackers to upload malicious JSP files to the server and execute arbitrary code. 

The provided POC code consists of two Python scripts: CVE-2025-24813-Scanner.py and CVE-2025-24813-Exploit.py. The scanner script attempts to upload a simple JSP shell to the target Tomcat server using the partial PUT functionality. It crafts a series of HTTP requests to upload the payload in chunks, simulating a partial PUT request. The script then verifies the successful upload by checking for the existence of the uploaded JSP file on the server. If the file is found, the scanner reports the target as vulnerable.

The exploit script, CVE-2025-24813-Exploit.py, takes a target URL as input and attempts to execute commands on the server via the uploaded JSP shell. It sends HTTP GET requests to the shell URL with a 'cmd' parameter containing the command to be executed. The script checks the response for specific indicators of successful command execution, such as the presence of 'root:x:' in the output of 'cat /etc/passwd'. If the command execution is successful, the script reports the target as compromised and saves the URL to a file named 'pwned.txt'. The exploit script provides both single target and bulk target options, reading target URLs from a file. It also allows the user to specify the command to be executed.

The POC demonstrates the vulnerability effectively. It bypasses authentication and achieves RCE with minimal effort. The scanner identifies vulnerable targets, and the exploit script confirms the vulnerability by executing arbitrary commands. The complete process from scanning to exploitation can be easily automated. However, successful exploitation requires the partial PUT feature to be enabled on the Tomcat server. 

Regarding poisoning risk, the provided POC code has a low risk. The python code uses standard libraries like `requests` and `argparse`, with clear logic for uploading and executing commands. The JSP payload itself is a simple command execution shell, without any obfuscation or malicious intent. The exploit script saves potentially vulnerable URLs to `pwned.txt` - a standard practice for penetration testing - which could be misused to target systems post-verification. The greatest poisoning risk exists in the potential for threat actors to distribute modified versions of these scripts with malicious payloads or backdoors integrated within the JSP shell or exploit logic. For example, an attacker might add code to exfiltrate sensitive information or install persistent malware. While the provided scripts themselves are relatively safe, users should always exercise caution when downloading and running code from untrusted sources, especially those pertaining to exploits.

**项目地址:** https://github.com/random_repo/CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
