## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** Not available

**影响版本:** prior to 2.9.1

**利用条件:** 需要认证 (低权限用户), 可通过网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析: 本PoC针对Camaleon CMS（版本低于2.9.1）中存在的Mass Assignment权限提升漏洞（CVE-2025-2304）提供了一个功能完整的利用方案。该漏洞位于用户管理模块的`updated_ajax`端点，当用户更新个人资料时，应用程序未能严格过滤`password`参数哈希中的敏感属性。通过在`password`作用域内注入`role`属性，低权限用户可以修改自己的权限，从而获得管理员身份。PoC采用Python语言编写，利用`requests.Session`维持会话，并通过解析DOM动态获取并同步`authenticity_token`以满足Rails的CSRF防护要求。此外，它还能动态发现`user[id]`并模拟`_method=patch`以满足RESTful路由。这些技术特性使得该PoC能够可靠地自动化整个攻击流程，从认证到最终的权限提升，具有很高的可用性和有效性。该PoC的详细文档和使用说明清晰，符合高可用性PoC的标准。
利用步骤: 攻击者首先通过`POST /admin/login`接口，使用一个低权限用户的有效凭据登录Camaleon CMS，建立一个经过认证的会话。登录成功后，PoC会向`/admin/profile/edit`发送一个GET请求，解析返回的HTML内容，以动态提取当前用户的唯一`user[id]`和一个新的`authenticity_token`，这是后续步骤中绕过CSRF防护和定位目标用户所必需的。最后，PoC构造一个恶意的`application/x-www-form-urlencoded`请求，目标URL为`/admin/users/:id/updated_ajax`。请求体中包含`_method=patch`参数以覆盖HTTP方法，以及`authenticity_token`和`password[password]`（用于满足密码更新的验证要求）。关键的恶意注入载荷是`password[role]=admin`，它利用了应用程序对`password`作用域内属性过滤不严格的弱点，将当前用户的角色属性强制更新为`admin`，从而完成权限提升，使低权限用户获得管理员访问权限。
投毒风险分析: 对提供的PoC代码结构和其README描述进行全面分析，该PoC使用了Python标准库`requests`（用于HTTP通信）和`beautifulsoup4`（用于HTML解析），这些都是常见的、信誉良好的第三方库。代码描述清晰、逻辑明确，详细说明了攻击流程、所需参数和技术实现细节。没有迹象表明PoC代码中存在代码混淆、加载外部恶意脚本、执行非预期的系统命令、或进行与漏洞利用无关的、可疑的网络通信（例如，连接到非目标域名的远程服务器进行数据外传或接收指令）。PoC的核心功能完全集中在模拟用户登录、信息收集和构造特定请求以触发Camaleon CMS中的Mass Assignment权限提升漏洞。其设计目标是演示漏洞，而非植入后门或进行其他恶意活动。因此，该PoC本身的投毒风险被评估为较低（10%）。然而，作为防御性安全研究员，我们始终建议使用者在任何环境中执行外部来源的PoC之前，都应完整审查所有源代码，以确保其行为完全符合预期，并仅在授权的测试环境中进行，以避免任何意外或非法操作。

**项目地址:** Not available

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
