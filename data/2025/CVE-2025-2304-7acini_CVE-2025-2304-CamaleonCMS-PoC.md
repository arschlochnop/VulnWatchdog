## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** 未提供

**影响版本:** 2.8.1之前版本

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

对CVE-2025-2304的POC代码分析显示，这是一个针对Camaleon CMS的权限提升漏洞，核心在于其用户管理模块的`updated_ajax`端点存在“质量赋值”（Mass Assignment）缺陷。应用程序在处理用户个人资料更新时，未能严格过滤`password`参数哈希中的敏感属性。攻击者可以利用这一漏洞，通过注入`role`属性到`password`作用域中，将自身权限从低权限用户提升至管理员。

**POC有效性分析：**
该PoC代码是一个功能完整且高度有效的验证工具，使用Python编写并依赖`requests`和`beautifulsoup4`库。代码设计精良，具备多项技术特点确保了利用的成功率和稳定性。首先，它通过`requests.Session`实现了会话持久性，能够在一个认证会话中完成后续的利用步骤。其次，PoC自动化处理了CSRF令牌的同步，能够从 `/admin/profile/edit` 页面的DOM中抓取`authenticity_token`并将其正确地放置在请求头中，绕过了Rails框架的AJAX安全机制。再次，它能够动态发现目标用户的ID，通过解析 `/admin/profile/edit` 页面获取 `user[id]`，这对于构建特定用户的RESTful更新请求至关重要。最后，PoC通过在POST请求中包含 `_method=patch` 参数，巧妙地模拟了HTTP PATCH方法，满足了Rails应用程序对资源更新的路由要求。整个利用流程清晰，逻辑严谨，充分证明了该“质量赋值”漏洞可以直接导致权限提升，将低权限用户转变为管理员账户。

**利用步骤：**
1.  **认证 (Auth)**：PoC首先向目标Camaleon CMS的 `/admin/login` 端点发送HTTP POST请求，使用预设的低权限用户名和密码进行登录。成功后，`requests.Session`将维护一个经过认证的会话，这是后续攻击的前提。
2.  **侦察 (Recon)**：在建立认证会话后，PoC会向 `/admin/profile/edit` 端点发起HTTP GET请求。此步骤的目的是解析返回的HTML响应，提取当前已认证用户的`user[id]`以及页面中包含的最新`authenticity_token`。这些动态获取的信息对于构造后续的权限提升请求至关重要。
3.  **权限提升 (Escalation)**：PoC利用上一步骤获取的`user[id]`和`authenticity_token`，向 `/admin/users/:id/updated_ajax` （其中`:id`替换为目标用户的实际ID）端点发送HTTP POST请求。此请求的`application/x-www-form-urlencoded`格式的payload中包含`_method=patch`（用于模拟PATCH请求）、正确的`authenticity_token`，以及关键的恶意注入参数`password[role]=admin`。由于应用程序对`password`作用域的输入过滤不足，`role`属性被错误地处理并更新到用户账户中，从而使当前用户获得管理员权限。

**投毒风险分析：**
根据对PoC代码和相关文档的全面审查，该PoC的投毒风险评估为低（5%）。此评估基于以下几个关键因素：
1.  **代码透明度高**：PoC代码（`main.py`）结构清晰，逻辑直接，未发现任何代码混淆、加密或通过动态加载恶意脚本的行为。所有功能都以易于审计的方式实现，安全研究人员可以轻松理解其执行的每一步。
2.  **依赖库安全**：代码仅依赖于Python标准库以及两个广受认可和使用的第三方库：`requests`（用于HTTP通信）和`beautifulsoup4`（用于HTML解析）。这些库本身是业界标准，没有已知恶意功能。
3.  **行为模式符合预期**：PoC的行为完全集中于验证Camaleon CMS中的权限提升漏洞。其网络请求、参数构造和数据解析都严格围绕漏洞的利用机制展开。未观察到任何异常的网络流量（例如，向未知C2服务器发送数据）、文件系统操作（例如，创建或修改系统文件、植入后门）或非预期的系统命令执行。
4.  **无隐藏恶意载荷**：PoC的核心有效载荷是`password[role]=admin`，这是一个直接且针对特定漏洞的参数注入，旨在修改用户角色，而非执行任意恶意代码或加载恶意二进制文件。它不会在目标系统上留下任何独立的恶意软件组件。
5.  **明确的道德声明**：PoC的`README.md`文件中明确指出该工具仅用于教育和授权的渗透测试目的，严禁未经授权用于生产系统。这反映了开发者的负责任态度。基于上述分析，可以确认此PoC代码是一个专注于技术验证的安全工具，不包含恶意投毒或意外的副作用。

**项目地址:** 未知

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
