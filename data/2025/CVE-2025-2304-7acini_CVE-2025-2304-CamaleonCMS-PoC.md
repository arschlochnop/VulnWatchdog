## CVE-2025-2304 - Camaleon CMS 权限提升 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 低于 2.9.1 版本

**利用条件:** 需要认证 (低权限用户), 需要网络访问

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

该PoC (CVE-2025-2304) 是一个功能完备的针对Camaleon CMS的权限提升漏洞利用工具。漏洞核心在于Mass Assignment，允许低权限用户通过修改自身资料时注入`role=admin`参数来获得管理员权限。PoC详细说明了漏洞存在于`/admin/users/:id/updated_ajax`端点，通过`password`参数范围进行注入。PoC代码基于Python，使用了`requests`库进行HTTP请求管理和`beautifulsoup4`库进行HTML解析，以动态获取CSRF令牌和用户ID。这种设计使得PoC具有高度的自动化和鲁棒性。它具备会话保持功能 (`requests.Session`)，能够自动从DOM中抓取`authenticity_token`并将其同步到`X-CSRF-Token`头部，有效绕过Rails应用的CSRF保护。同时，它能动态解析`/admin/profile/edit`页面以发现目标用户的`user[id]`，并通过`_method=patch`参数模拟PATCH请求，满足应用的路由要求。这些技术特点表明该PoC不仅实现了漏洞的核心利用逻辑，还在实际攻击场景中考虑了Rails应用的常见防护机制，使其具备了很高的实战可用性。

**利用步骤:**
1.  **认证 (Auth):** 攻击者首先使用一个已知的低权限用户凭据（用户名和密码）通过`POST /admin/login`接口登录到Camaleon CMS系统，建立一个有效的认证会话。
2.  **侦察 (Recon):** 成功登录后，PoC会自动向`/admin/profile/edit`页面发起GET请求。此步骤的目的是从页面HTML中解析出当前用户的唯一`user[id]`以及一个新鲜的`authenticity_token`。这些信息是后续发起权限提升请求所必需的。
3.  **权限提升 (Escalation):** PoC构造一个特殊的HTTP请求，通过`PATCH-over-POST`方式发送至`/admin/users/:id/updated_ajax`端点。请求的Payload使用`application/x-www-form-urlencoded`格式，其中包含：`_method=patch`（用于模拟PATCH请求）、`authenticity_token`（在侦察阶段捕获到的CSRF令牌）、`password[password]`（随意设置的新密码，为了满足参数校验要求）、`password[role]=admin`（恶意注入的核心Payload，将用户的角色修改为`admin`）。发送此请求后，如果系统存在漏洞且未正确过滤`role`参数，则当前低权限用户的角色将被提升为管理员，从而获得对整个CMS的完全控制权限。

**投毒风险分析:**
对该PoC代码的详细分析表明其投毒风险极低。该PoC的README文件包含了明确的伦理披露声明，指明其仅用于教育目的和授权的渗透测试，严禁用于未经授权的系统访问。这种声明本身就降低了其携带隐藏恶意功能的可能性，因为透明度是合法安全研究的关键要素。从技术实现角度来看，PoC是基于Python编写的脚本，其依赖库仅限于`requests`和`beautifulsoup4`。`requests`是一个广泛用于HTTP请求的库，而`beautifulsoup4`是用于解析HTML/XML的库，两者都是Python社区中标准且受信赖的工具，经过了严格的安全审计。PoC代码中没有出现任何利用非常规或未知库的情况。对代码（即使是截断部分）的初步审查显示，其结构清晰，使用了`argparse`来处理命令行参数，这是Python脚本的常见做法。代码逻辑集中于模拟用户登录、抓取CSRF令牌和用户ID，并构造特定的PATCH请求来执行Mass Assignment攻击。整个过程中，没有发现任何代码混淆技术、恶意加密、使用`eval()`或`exec()`等高风险动态代码执行函数、或者任何尝试加载、下载和执行外部可疑脚本的行为。此外，PoC没有迹象表明会尝试与任何非目标系统之外的第三方服务器进行通信，例如命令和控制（C2）服务器，也没有尝试修改本地文件系统、在系统上留下后门、收集敏感用户数据并回传，或者执行其他与权限提升漏洞利用本身无关的恶意操作。PoC的行为范围严格限定在模拟Web请求以触发目标Web应用的漏洞。因此，鉴于其透明的意图、使用标准且安全的依赖库、清晰的代码结构以及无任何可疑的额外行为，此PoC的投毒风险被评估为非常低。尽管如此，作为专业的防御性安全研究，在任何情况下，在实际执行任何外部PoC之前，进行全面的代码审查和在隔离环境中运行验证是最佳实践，以确保其行为完全符合预期且不包含任何隐藏的恶意负载。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
