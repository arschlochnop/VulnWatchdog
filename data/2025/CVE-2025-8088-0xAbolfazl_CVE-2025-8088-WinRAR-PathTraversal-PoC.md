## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户下载并手动解压特制的恶意RAR文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码展现了针对WinRAR 7.12及以下版本的路径遍历漏洞利用过程。其核心逻辑在于利用Windows NTFS备用数据流（ADS）特性和WinRAR在处理解压路径时的逻辑缺陷。通过构造特殊的RAR5文件结构，攻击者可以在文件名中包含路径遍历序列（如“../”），并结合ADS语法。分析代码可知，POC首先初始化RAR5文件头（RAR5_SIG），并设置文件头标志位以包含额外数据。它通过精心构建文件名字符串，在解压时诱导WinRAR跳出预定的目标目录。该漏洞的有效性极高，因为它能够绕过WinRAR之前的补丁限制，将恶意文件（如启动项中的exe或dll）直接释放到系统的关键位置（如Windows启动目录或System32）。代码中包含了对RAR文件结构的底层构造，包括CRC校验计算、头部块封装等，这证明了该POC并非简单的脚本，而是具备完整文件构造能力的利用工具。在受影响版本上运行该POC生成的压缩包，一旦用户执行解压操作，预设的文件会精准出现在目标绝对路径下。利用步骤：1. 攻击者确定目标系统上的敏感路径，如“C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\”。2. 运行POC脚本，通过参数指定要植入的恶意负载文件及对应的路径遍历目标名。3. 脚本根据RAR5协议规范，将负载文件封装进压缩包，并对文件名进行特殊的ADS编码处理。4. 攻击者通过钓鱼邮件、虚假资源下载等社交工程手段分发该RAR文件。5. 用户使用WinRAR 7.12或更低版本打开并解压文件，触发漏洞，恶意文件被静默写入系统启动目录。投毒风险分析：该POC代码主要由Python编写，使用了subprocess、pathlib、struct等标准库。代码逻辑透明，主要集中在RAR二进制结构的拼接。初步扫描未发现混淆的Base64指令或隐藏的网络外连请求。虽然代码中存在os.system('clear')和subprocess执行命令的部分，但主要是为了优化终端显示和调用WinRAR命令行工具进行辅助验证，属于功能性代码。然而，考虑到此类漏洞利用工具的特殊性，潜在风险点在于：首先，POC中引用的外部库pyfiglet和colorama虽为常用库，但在不受信任的源下载时存在供应链风险。其次，脚本中execute_command函数封装了复杂的系统调用逻辑，虽然目前看起来是防御性的，但攻击者可以轻易将其修改为在生成压缩包的同时，在执行者本地机器上执行恶意静默指令。目前的POC代码风险评级为低（15%），属于典型的防御性研究工具，代码清晰且未见恶意混淆，但安全研究员在运行此类生成脚本时，仍建议在隔离的沙盒环境（如Docker或虚拟机）中操作，防止脚本被二次修改导致的本地感染。

**项目地址:** [https://github.com/0xAbolfazl](https://github.com/0xAbolfazl)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
