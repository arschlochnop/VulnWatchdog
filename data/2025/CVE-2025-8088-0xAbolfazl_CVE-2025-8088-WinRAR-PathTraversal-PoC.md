## CVE-2025-8088 - WinRAR (Windows版本) 路径遍历/任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/任意文件写入

**影响应用:** WinRAR (Windows版本)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户需要下载并使用受影响版本的WinRAR解压攻击者构造的恶意压缩包文件，且操作系统文件系统需支持NTFS备用数据流 (ADS)。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码旨在复现CVE-2025-8088漏洞，通过构造符合RAR5格式的恶意压缩包，利用Windows NTFS备用数据流（Alternate Data Streams, ADS）特性绕过WinRAR的安全检查。分析POC代码发现，其核心逻辑在于通过在文件名中注入特定的字符序列（如ADS标识符），诱导WinRAR在解压过程中将文件写入到预期的解压目录之外。该POC提供了完整的RAR5签名处理（RAR5_SIG）、块结构构造以及颜色化控制台输出，具备较高的工业化成熟度。其使用了subprocess和pathlib等库来处理底层逻辑，并定义了严格的校验函数execute_command以确保命令执行的准确性。由于该漏洞本质上是对CVE-2025-6218的绕过升级版，该POC成功利用了WinRAR在处理带有ADS特征的文件路径时未能正确规范化路径的缺陷，能够实现将恶意程序（如exe或bat）投递至系统启动项或敏感目录。利用步骤如下：1. 使用Python环境运行POC脚本；2. 脚本会自动生成一个特制的.rar文件；3. 将该文件发送给目标用户；4. 目标用户使用WinRAR 7.12或更低版本打开并点击“解压到”；5. 触发路径遍历，payload被写入至攻击者预设的系统路径（如C:/Users/Public/等）。【投毒风险分析】该POC的投毒风险评级为低（15%）。虽然脚本中使用了os.system('clear')和subprocess等具有潜在敏感性的函数，但其主要用途是清理终端显示和驱动WinRAR命令行工具进行自动化测试，属于典型的渗透测试框架风格。代码结构清晰，主要依赖colorama和pyfiglet等美化库，未发现经过混淆的Base64载荷、远程下载并执行脚本（stager）的行为或恶意socket回连代码。然而，由于该POC包含高度自动化的利用链生成逻辑，恶意人员极易将其封装进虚假的漏洞修复工具或集成到自动化攻击套件中。鉴于WinRAR缺乏自动更新机制，此类公开的POC极易被修改为静默释放恶意后门的工具，因此在下载运行此类漏洞研究脚本时，建议在隔离的沙盒环境内进行，并重点监控文件系统写入事件。开发者GitHub链接虽然存在，但需警惕克隆版仓库可能植入的恶意逻辑。

**项目地址:** [https://github.com/0xAbolfazl](https://github.com/0xAbolfazl)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
