## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4

**影响版本:** WinRAR <= 7.12

**利用条件:** 需要用户交互（打开恶意RAR文件），无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：
该PoC脚本，`poc.py`，在演示CVE-2025-8088漏洞的有效性方面表现出色。它是一个基于Python的工具，利用WinRAR的命令行工具（`rar.exe`）来制作一个专门设计的恶意RAR压缩包。该漏洞的核心机制在于WinRAR 7.12及更早版本中存在的路径遍历缺陷。此缺陷允许攻击者在看似正常的RAR文件中，通过利用Alternate Data Streams (ADSes) 嵌入恶意载荷。当易受攻击的WinRAR版本解压这个精心制作的压缩包时，隐藏在ADSes中的恶意文件会被写入到受害者系统上的任意敏感位置，例如Windows的启动文件夹。PoC的`README.md`文档非常详细，清晰地概述了漏洞、受影响的版本以及漏洞的工作原理。它还包含一个`poc.gif`，直观地演示了恶意文件（例如，一个快捷方式`.lnk`文件）成功提取到非预期目录的过程。该脚本结构良好，要求用户指定一个诱饵文件（如虚假的简历）和一个载荷文件（实际的恶意组件）。这种设置确保了生成的RAR文件看起来是合法的，同时秘密地传递了漏洞利用。PoC对`rar.exe`的依赖确保了漏洞利用逻辑直接模拟了真实世界的攻击条件，使其成为漏洞可利用性的真实代表。该脚本是独立的，除了标准的Python库外，不依赖于复杂的外部库，这有助于其可靠性和易用性，适用于研究目的。

利用步骤：
利用此PoC进行CVE-2025-8088攻击涉及以下几个简单的步骤：
1.  **环境准备:** 确保安装了Python环境，并且WinRAR的命令行工具`rar.exe`已安装并可通过系统PATH访问。如果`rar.exe`不在PATH中，其完整路径必须作为参数提供给PoC脚本。
2.  **准备文件:** 创建或获取一个“诱饵”文件（例如`resume.pdf`），它将对受害者显得合法；以及一个“载荷”文件（例如`malicious.lnk`或`malicious.dll`），其中包含实际的恶意代码或要执行的命令。
3.  **生成恶意RAR:** 在命令行中执行PoC脚本，提供诱饵和载荷文件的路径，并为恶意RAR压缩包指定一个输出文件名。例如：`python poc.py --decoy C:\Users\Attacker\Desktop\resume.pdf --payload C:\Users\Attacker\Desktop\evil.lnk --output C:\Users\Attacker\Desktop\job_application.rar`。
4.  **社会工程学投递:** 生成的`job_application.rar`文件随后可以通过鱼叉式网络钓鱼邮件等方式分发给目标，伪装成合法文档，如求职申请。
5.  **受害者触发:** 当受害者使用易受攻击的WinRAR版本（<= 7.12）解压`job_application.rar`文件时，路径遍历漏洞与Alternate Data Streams结合，会导致`evil.lnk`载荷被提取到一个关键的系统位置，例如Windows启动文件夹（`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
6.  **自动执行:** 在受害者下次系统重启或登录时，位于启动文件夹中的载荷（例如`evil.lnk`）将自动执行，从而实现持久化和代码执行。

投毒风险分析：
在分析此PoC代码的投毒风险时，需要明确其主要功能是**生成**一个恶意RAR文件以演示漏洞，而非PoC代码本身直接执行攻击或包含后门。从安全研究的角度评估，该PoC对研究人员环境的直接投毒风险极低。

**代码清晰度与可读性:** 该PoC的代码结构清晰，主要使用Python标准库进行文件操作，并调用外部的`rar.exe`程序。代码中没有发现明显的混淆、难以理解的复杂逻辑或不常见的加密算法。所有关键操作，如文件读取、路径构造和`subprocess`调用，都易于审计，允许安全研究人员充分理解其功能。

**外部依赖与请求:** PoC代码没有引入非标准的Python外部库，也没有进行任何可疑的网络请求（如向未知C2服务器发送数据、下载额外组件或与远程服务器进行未经授权的通信）。其唯一外部交互是调用本地安装的`rar.exe`，这符合其功能描述，并且是生成恶意RAR文件所必需的。这种自包含的特性显著降低了供应链攻击或通过外部组件引入恶意代码的风险。

**恶意行为分析:** PoC脚本的核心在于构造一个具有特定ADS（Alternate Data Streams）路径的RAR文件，以实现路径遍历。这是一种**有意为之的恶意文件生成**行为，但这种“恶意”是针对目标受害系统而言，而非运行PoC脚本的开发或研究人员的环境。脚本本身不会在研究人员的机器上创建非预期的后门、窃取敏感数据、修改系统配置或进行其他未经授权的操作。它严格遵循了其作为漏洞验证工具的角色，专注于生成一个可触发漏洞的测试用例。

**误用风险:** 尽管PoC本身不构成投毒，但其生成的恶意RAR文件具有高度利用价值。如果研究人员在不安全的沙箱环境中运行PoC并意外提取了该RAR文件，尤其是在运行脆弱版本的WinRAR时，则**生成的恶意负载可能对研究环境造成感染**。例如，如果载荷是一个`autorun.inf`或`.lnk`文件并被写入启动目录，重启后可能自动执行。因此，**对研究人员而言，真正的风险在于对PoC产物的处理不当，而非PoC代码本身**。这强调了在进行任何漏洞复现和分析时，始终使用隔离环境的重要性。

**总结:** 鉴于PoC代码的透明度、缺乏外部恶意通信、以及其作为漏洞生成器的明确用途，该PoC脚本的投毒风险（即对运行PoC的研究人员环境造成恶意影响）被评估为**低**。其主要风险在于不当操作生成出的恶意RAR文件。防御性安全研究人员在复现时应始终在隔离环境中进行，并仔细检查生成的恶意文件内容和行为，以避免意外激活。

**项目地址:** https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
