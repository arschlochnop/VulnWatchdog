## CVE-2025-8088 - WinRAR 路径遍历/目录穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12, UnRAR.dll, Portable UnRAR source code

**利用条件:** 用户需要下载并使用受影响版本的WinRAR解压攻击者构造的特制恶意压缩包（通常通过钓鱼攻击分发）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC脚本名为poc.py，其核心逻辑是通过Python调用WinRAR命令行工具（rar.exe）构建一个包含特殊NTFS备用数据流（ADS）路径的压缩文件。该漏洞的有效性源于WinRAR在处理RAR5格式压缩包时，未能正确过滤或校验ADS中的路径序列（..\）。漏洞复现过程中，POC会将一个正常的‘诱饵’文件与一个隐藏在ADS中的恶意载荷结合。当受害者解压此文件时，漏洞导致WinRAR忽略用户选定的解压路径，而是根据ADS路径将文件写入敏感位置。经分析，该POC结构完整，包含了命令行参数处理、RAR构建逻辑以及自动生成诱饵和载荷的功能，是一套可以直接产生武器化压缩包的自动化工具，技术复现率极高。【利用步骤】1. 环境准备：安装WinRAR 7.12或更早版本，安装Python环境，并将rar.exe路径加入系统环境变量。2. 编写/准备载荷：准备一个恶意脚本（如a.bat或.lnk文件）作为payload，以及一个PDF或文档作为诱饵文件。3. 执行生成：运行命令‘python poc.py --decoy resume.pdf --payload attack.bat --output malicious.rar’。4. 漏洞触发：受害者双击malicious.rar并选择‘解压到当前文件夹’。5. 结果验证：观察发现攻击载荷并非出现在当前文件夹，而是被穿越至指定路径（如C:\Users\Username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup），实现持久化控制。【投毒风险分析】在针对该CVE的公开资源调查中，存在一定的投毒风险。由于该漏洞在2025年夏季曾被野外组织（如RomCom组）大规模利用，目前网络上流传的部分PoC仓库可能夹杂经过混淆的二进制文件或带有后门的预构建脚本。分析当前的POC Python代码，其主要依赖标准库（如os, subprocess, argparse），代码逻辑透明且具有清晰的免责声明。然而，投毒风险点在于：部分虚假的GitHub仓库会声称提供‘一键生成工具’的EXE版本，此类EXE往往包含僵尸网络木马。此外，由于漏洞本身涉及ADS特性，攻击者可能利用POC本身作为载体，在分发测试脚本时就将真实的恶意代码隐藏在脚本附件的ADS中。建议研究人员仅在隔离沙箱内运行此类Python脚本，并手动审查subprocess调用的参数，严禁运行任何未经审计的预编译二进制执行文件。考虑到该漏洞的高利用价值，开源社区中已出现多个钓鱼性质的PoC仓库，投毒比例估算为15%左右，研究者应保持高度警惕。

**项目地址:** [https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-](https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
