## CVE-2025-8088 - WinRAR, UnRAR.dll及其便携源代码 路径遍历/目录穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越

**影响应用:** WinRAR, UnRAR.dll及其便携源代码

**危害等级:** 高危

**CVSS评分:** CVSS 8.4

**影响版本:** WinRAR ≤ 7.12

**利用条件:** 需要用户交互（解压恶意文件）

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重路径遍历漏洞，特别是7.12及以下版本，以及相关的UnRAR.dll和其便携源代码。该漏洞允许攻击者利用Windows NTFS备用数据流（ADS）特性，将恶意载荷隐藏在看似无害的文件（如PDF简历）中，并结合路径遍历技术，绕过WinRAR的文件验证机制。当受害者解压精心制作的RAR文件时，隐藏在ADS中的恶意文件可以被释放到任意敏感系统位置，例如Windows的“启动”文件夹。这可能导致恶意文件（如DLL或.lnk快捷方式文件）在系统重启时自动执行，从而实现任意代码执行、系统感染或持久化攻击。该漏洞已于2025年7月18日被发现存在在野利用，并于2025年7月30日在WinRAR 7.13版本中得到修复。攻击者通常通过钓鱼邮件分发这些恶意RAR文件，伪装成求职申请，目标涉及金融、国防、制造和物流等关键行业。

**POC有效性分析**：
提供的POC是一个功能完整的Python脚本，有效演示了CVE-2025-8088漏洞的利用方式。该脚本能够利用`rar.exe`命令行工具，生成一个恶意的RAR压缩文件。利用过程包括指定一个诱饵文件（如`.pdf`）和一个实际的恶意载荷文件（如`.lnk`或`.exe`）。POC通过巧妙地将恶意载荷嵌入到诱饵文件的NTFS备用数据流中，并结合路径遍历序列，使得在解压时，恶意载荷能够被放置在目标系统上的任意指定路径，例如Windows启动目录。POC的`README.md`文档清晰明了，包含了详细的用法说明、命令参数以及一个演示漏洞利用的GIF动画，极大地降低了复现和理解漏洞的门槛。其工作原理与公开的漏洞细节（利用ADS和路径遍历）完全一致，确认了POC的有效性和准确性。因此，该POC是验证和研究CVE-2025-8088漏洞的可靠工具。

**利用步骤**：
1. **环境准备**：确保目标系统安装了WinRAR 7.12或更早版本。攻击者需要安装Python环境，并确保`rar.exe`（WinRAR的命令行工具）在系统PATH中或通过参数指定路径。
2. **克隆POC**：从GitHub仓库克隆该POC代码。
3. **准备文件**：准备一个诱饵文件（如`resume.pdf`）和一个恶意载荷文件（如一个指向恶意脚本的`.lnk`文件或一个恶意DLL）。
4. **生成恶意RAR**：运行POC脚本，例如`python poc.py --decoy resume.pdf --payload evil.lnk --output malicious.rar`。脚本会生成一个包含诱饵文件和隐藏恶意载荷的`malicious.rar`文件。
5. **分发攻击**：攻击者通过钓鱼邮件等社会工程学手段，将`malicious.rar`发送给受害者，诱骗其解压。
6. **受害者解压**：受害者使用受影响版本的WinRAR解压该压缩包。
7. **漏洞触发**：在解压过程中，POC利用的路径遍历和ADS技术会绕过WinRAR的安全检查，将隐藏的`evil.lnk`文件释放到系统关键位置（例如`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
8. **自动执行**：当受害者下次重启系统时，`Startup`文件夹中的`evil.lnk`会自动执行，从而触发预设的恶意行为，例如下载并执行远程木马、窃取信息或建立持久化后门。

**投毒风险分析**：
对该POC的投毒风险评估为低（5%）。首先，该GitHub仓库明确标注为“Proof of Concept (PoC-Exploit)”，并包含一份清晰的免责声明，强调其仅用于教育和研究目的，禁止滥用，作者不承担任何误用或损害的责任。从提供的`README.md`内容和POC功能描述来看，其核心目的是生成一个演示CVE-2025-8088漏洞的恶意RAR文件，而不是POC代码本身包含恶意行为。脚本依赖于Python标准库和WinRAR的官方命令行工具`rar.exe`来完成压缩文件的创建。在描述中，没有发现任何代码混淆、加载外部恶意脚本、连接可疑C2服务器、执行加密货币挖掘或植入后门等高风险行为。该POC的功能专注于漏洞演示的构造过程，其输出是一个恶意载荷文件，而非POC本身。因此，尽管该POC可以用于生成攻击性载荷，但POC代码本身不包含二次投毒的风险。用户在执行任何POC时仍应保持警惕，建议在隔离环境中运行，并对代码进行安全审计，以确保其安全性。

**项目地址:** https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
