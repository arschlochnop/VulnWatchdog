## CVE-2025-7338 - Multer File Upload Restriction Bypass

**漏洞编号:** CVE-2025-7338

**漏洞类型:** File Upload Restriction Bypass

**影响应用:** Multer

**危害等级:** Medium

**CVSS评分:** N/A

**影响版本:** <1.4.4-lts.1

**利用条件:** Requires a web application using Multer for file uploads. No authentication required in default configurations.

**POC 可用性:** 5/10

**POC 类型:** Concept Verification

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

This vulnerability allows an attacker to bypass file upload restrictions imposed by Multer. Multer is a popular Node.js middleware for handling `multipart/form-data`, which is primarily used for uploading files. The vulnerability occurs due to insufficient validation of file extensions or MIME types, allowing an attacker to upload malicious files (e.g., PHP, ASP, or executable files) disguised as harmless ones (e.g., images or text files).

POC有效性分析：The provided `package.json` indicates that this POC is designed to test a specific version of Multer (`^1.4.4-lts.1`).  The absence of actual exploit code suggests it's a minimal demonstration or intended as part of a larger test suite. The effectiveness hinges on the application's specific implementation of Multer and its subsequent handling of uploaded files. Without additional code or context, its difficult to assess the exploitability fully. To successfully exploit the vulnerability, the attacker needs to craft a malicious file with a deceptive extension and MIME type. The server-side application must then fail to properly validate the file, allowing it to be stored and potentially executed. This often involves manipulating the 'Content-Type' header in the HTTP request. Successful exploitation could lead to remote code execution if the attacker manages to upload and execute a malicious script. The `poc_type` is marked as 'Concept Verification' due to only providing the dependencies.

利用步骤:
1.  Identify a web application using Multer for file uploads.
2.  Determine the Multer version used by the application. If it's older than 1.4.4-lts.1, it might be vulnerable.
3.  Craft a malicious file with a deceptive extension and MIME type (e.g., a PHP file with a .jpg extension and image/jpeg MIME type).
4.  Upload the file to the application.
5.  If the application fails to properly validate the file, it will be stored on the server.
6.  Attempt to access the uploaded file via a web browser. If the server executes the file, the vulnerability is confirmed.

投毒风险分析:
The `package.json` file itself poses a low risk of supply chain poisoning. It only declares a dependency on the `multer` package. There's no malicious code or obfuscation present. However, the risk lies in the potential for an attacker to distribute a modified version of Multer that contains backdoors or other malicious code.  This highlights the importance of verifying the integrity of dependencies and using software composition analysis tools to detect known vulnerabilities. Also, the package name `multer-sca-rule-test_cve-2025-7338` suggests this package is for testing security rules, it's unlikely to be published publicly. However, if it was published with malicious intent the package name may trick security researchers to download and execute the package. Therefore, the poisoning risk is relatively low (10%). The test script just outputs an error and exits. There is no install script to run malicious code.

**项目地址:** https://example.com/multer-sca-poc

**漏洞详情:** https://www.cve.org/cve/CVE-2025-7338
