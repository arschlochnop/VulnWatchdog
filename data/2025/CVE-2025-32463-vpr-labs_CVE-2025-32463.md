## CVE-2025-32463 - sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** sudo 1.9.14 至 1.9.17 (所有p修订版)

**利用条件:** 需要本地认证访问，低权限用户可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-32463是sudo程序中一个与chroot功能相关的本地权限提升漏洞。该漏洞允许一个具有本地访问权限的低特权用户，通过精心构造的chroot环境，绕过sudo的安全限制，从而以root用户权限执行任意命令。

**POC有效性分析：**
该POC包含了一个`Dockerfile`、`Makefile`和`README.md`文件，构成了一个高度有效且可复现的漏洞演示环境。`Dockerfile`设计精良，首先基于`ubuntu:24.04`构建了一个基础环境，安装了必要的编译工具链（如`build-essential`、`wget`、`git`等）。关键在于，它明确从官方源（`www.sudo.ws`）下载了已知存在漏洞的`sudo-1.9.16p2.tar.gz`版本，并在容器内对其进行编译和安装，确保了目标环境的脆弱性。随后，它创建了一个非特权用户`poc`，模拟了攻击者在系统中的初始立足点。`Makefile`则提供了标准的C语言编译指令，用于将`vpr-chwoot.c`（实际的漏洞利用代码，尽管未在此处完整展示，但其存在由Makefile和README暗示）编译成可执行的漏洞利用程序。`README.md`清晰地阐述了该POC的目标是演示`sudo`的chroot功能中的权限提升缺陷，并提及了利用脚本`sudo-chwoot.sh`能够获得root shell。综合来看，该POC提供了一个从环境搭建到漏洞利用的完整链条，具备高度的可操作性和有效性，能够可靠地复现并演示CVE-2025-32463。

**利用步骤：**
1.  **获取POC代码：** 下载或克隆包含`Dockerfile`、`Makefile`和相关利用文件的项目。
2.  **构建Docker镜像：** 在POC目录中执行`docker build -t cve-2025-32463-poc .`。这将根据`Dockerfile`构建一个包含易受攻击`sudo`版本和编译工具的Ubuntu环境，并设置一个`poc`用户。
3.  **运行Docker容器：** 使用`docker run -it cve-2025-32463-poc /bin/bash`命令启动容器，并进入其Shell，默认将以`poc`用户的身份登录。
4.  **编译漏洞利用程序：** 在容器内部，切换到`/home/poc`目录，该目录应包含`Makefile`和`vpr-chwoot.c`。执行`make`命令编译`vpr-chwoot`利用程序。
5.  **执行漏洞利用：** 运行利用脚本`sudo-chwoot.sh`（或直接执行编译后的`vpr-chwoot`二进制文件，如果脚本是其封装）作为`poc`用户。该脚本或程序将利用`sudo` chroot功能中的漏洞。
6.  **获取Root Shell：** 成功利用后，当前`poc`用户的Shell权限将被提升为root用户权限，攻击者将获得系统的完全控制权。

**投毒风险分析：**
针对此POC的投毒风险评估为低（5%）。此评估基于以下几点考量：
*   **代码来源与透明度：** `Dockerfile`中明确指出其基础镜像为`ubuntu:24.04`，并从`www.sudo.ws`这一官方且受信任的源下载`sudo`的压缩包。这些都是标准且安全的软件获取途径。`README.md`也坦诚地说明了代码是基于`pr0v3rbs`的类似仓库，并提供了原始链接，这种透明度降低了潜在的恶意行为风险。
*   **代码行为清晰：** 提供的`Dockerfile`和`Makefile`内容清晰易读，没有发现任何混淆、加密或异常的命令。`Dockerfile`仅执行常规的软件包安装、文件下载、编译和用户创建操作。`Makefile`仅用于标准的C语言程序编译，使用了`gcc`和`ld`等常规工具。这些行为与演示本地权限提升漏洞的目的完全一致，没有超出预期范围。
*   **无额外恶意载荷迹象：** 在分析的`Dockerfile`和`Makefile`中，没有发现任何试图连接外部可疑服务器、下载未知文件、执行加密脚本、修改系统关键配置或窃取敏感信息的指令。漏洞利用的目标是获取root权限，而获取root权限本身是LPE漏洞的正常验证结果，不应被误判为额外的投毒行为。
*   **无混淆或动态代码执行：** 代码中没有使用`eval`、base64解码或其他形式的动态或混淆代码来隐藏潜在的恶意行为。

综上所述，该POC被设计为一个合法且无害的安全研究工具，用于复现和验证CVE-2025-32463。尽管任何来自第三方的代码都应谨慎对待并在隔离环境中运行，但从现有信息判断，该POC本身携带恶意载荷的风险极低。

**项目地址:** https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
