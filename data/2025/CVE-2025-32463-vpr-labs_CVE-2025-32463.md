## CVE-2025-32463 - Linux sudo组件 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** Linux sudo组件

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H (9.3)

**影响版本:** sudo 版本 1.9.14 到 1.9.17 (含所有p修订版)

**利用条件:** 需要本地访问权限，通过低权限用户即可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是Linux sudo组件中一个高危本地提权漏洞，于2025年6月30日公开披露。该漏洞源于sudo的`chroot`功能中对非可信控制范围的处理不当。其CVSS评分为9.3，表明其具有严重的威胁性。漏洞允许本地攻击者通过欺骗sudo使用用户指定的根目录（通过`-R`或`--chroot`选项）来加载任意共享库，从而提升其权限。此漏洞在Sudo v1.9.14（2023年6月）中引入，与使用`chroot`功能时命令匹配处理代码的更新有关，其根源在于`chroot`实现中对用户指定路径的验证不足，导致恶意库可以被加载并执行。

**POC有效性分析**：
提供的PoC（包括`Dockerfile`、`Makefile`和`README.md`）构建了一个高度可复现的环境来演示CVE-2025-32463漏洞。`Dockerfile`详细地配置了一个Ubuntu 24.04基础镜像，安装了编译所需工具，并从官方`sudo.ws`网站下载并编译安装了受影响的Sudo版本（1.9.16p2）。它还创建了一个低权限的`poc`用户，并拷贝了用于编译恶意共享库的`Makefile`和`vpr-chwoot.c`（通过`Makefile`和`COPY`命令推断其存在），以及用于触发漏洞的`sudo-chwoot.sh`脚本（在`Dockerfile`和`README.md`中均有提及）。`Makefile`旨在将`vpr-chwoot.c`编译为名为`vpr-chwoot`的共享库，该库是攻击的有效载荷。`README.md`明确指出，该仓库提供了一个最小化、可复现的环境来演示此漏洞，并且`sudo-chwoot.sh`是一个能够生成root shell的PoC利用脚本。尽管`vpr-chwoot.c`和`sudo-chwoot.sh`的完整源代码未直接包含在输入数据中，但它们的存在和在攻击链中的作用通过`Dockerfile`和`README.md`得到了清晰的描述和支持。这种结构表明这是一个功能完整且文档齐全的PoC，能够有效展示`chroot`绕过机制并成功实现本地提权。

**利用步骤**：
1.  攻击者首先需要具备目标Linux系统上的本地低权限用户账户。
2.  确认目标系统上安装的`sudo`版本位于受影响的范围（1.9.14到1.9.17，含所有p修订版）。
3.  攻击者准备一个恶意的共享库（例如PoC中的`vpr-chwoot`），该库被设计为在加载时执行特权指令，通常是生成一个root shell或执行任意代码。
4.  攻击者通过精心构造`sudo`命令，利用`-R`或`--chroot`选项指定一个由攻击者控制的目录作为`chroot`的根目录。
5.  在`sudo`尝试在其`chroot`环境中解析并加载所需库时，由于`chroot`实现对非信任控制范围处理不当，`sudo`会被诱骗从攻击者控制的目录下加载恶意的共享库。
6.  一旦恶意共享库被以root权限运行的`sudo`进程加载，库中的恶意代码将被执行，从而使攻击者获得系统的root权限。

**投毒风险分析**：
根据提供的`Dockerfile`、`Makefile`和`README.md`，该PoC的投毒风险评估为低（10%）。`Dockerfile`从官方的Ubuntu镜像和`sudo.ws`网站获取软件组件，这些都是可信的来源。它使用标准的`apt-get`命令安装常用的构建工具和依赖库。`Makefile`也是标准且透明的，用于编译共享库，没有出现代码混淆、可疑的外部网络请求或执行未知脚本的行为。`vpr-chwoot.c`（作为恶意载荷）的目的是为了利用漏洞实现提权，而不是PoC本身作为载体来传递额外的恶意软件。换句话说，PoC的核心功能是演示漏洞，而非隐匿其他恶意行为。因此，该PoC在构建和准备阶段没有显示出明显的恶意投毒迹象。尽管如此，作为防御性安全研究的常规实践，任何PoC在执行前都应仔细审查其完整源代码（包括`vpr-chwoot.c`和`sudo-chwoot.sh`），以确保其行为符合预期且不包含未声明的恶意功能，尤其是在生产或敏感环境中。


**项目地址:** https://github.com/pr0v3rbs/CVE-2025-32463_chwoot/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
