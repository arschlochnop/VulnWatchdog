## CVE-2025-63945 - Tencent iOA (腾讯电脑管家) 任意文件删除, 本地权限提升 (EoP)

**漏洞编号:** CVE-2025-63945

**漏洞类型:** 任意文件删除, 本地权限提升 (EoP)

**影响应用:** Tencent iOA (腾讯电脑管家)

**危害等级:** 高危，可导致未授权的本地用户提权至SYSTEM权限，删除任意系统文件或目录。

**CVSS评分:** 待定

**影响版本:** before 210.9.28693.62001

**利用条件:** 需要本地用户权限，无需认证即可利用。攻击者需能够创建并修改C:\Windows\Temp\TencentDownload目录，且拥有对系统进行OpLock、junction和symlink操作的能力。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

POC有效性分析:
该漏洞（CVE-2025-63945）存在于腾讯iOA（Tencent PC Manager）的LegacyKB_ioa_win.exe进程中。该进程在执行更新或热修复时，会以SYSTEM权限处理C:\Windows\Temp目录下的文件和目录。具体来说，当“ioa”组件启用时，LegacyKB_ioa_win.exe会周期性启动，并在C:\Windows\Temp下创建“TencentDownload”目录，下载文件后，再以SYSTEM权限删除其中的特定子目录（以“~”前缀命名）。
该漏洞的核心在于对C:\Windows\Temp\TencentDownload目录及其子目录处理不当。由于普通用户可以创建并修改C:\Windows\Temp\TencentDownload目录，且LegacyKB_ioa_win.exe进程在删除操作前缺乏充分的路径验证，攻击者可以通过符号链接（symlink）攻击，诱骗SYSTEM权限进程删除任意文件或目录。通过精心构造OpLock、目录移动、交接点（junction）和符号链接，攻击者可以将SYSTEM权限的删除操作重定向到系统关键文件或目录（例如C:\Windows\System32\secrets），从而实现任意文件删除，并进一步导致本地权限提升（Local Privilege Escalation, LPE）。PoC视频（https://drive.google.com/file/d/1RXQgaNBDeopurcP63xmhMXDM7stHaIzO/view?usp=sharing）的存在进一步证实了该漏洞的可利用性。

利用步骤:
1. 攻击者在C:\Windows\Temp目录下创建名为“TencentDownload”的文件夹。
2. 当观察到LegacyKB_ioa_win.exe进程在C:\Windows\Temp\TencentDownload下创建任何以“~”为前缀的文件夹时，攻击者对该文件夹设置OpLock（机会锁）。
3. LegacyKB_ioa_win.exe进程尝试以SYSTEM权限删除C:\Windows\Temp\TencentDownload\~*文件夹。
4. 由于OpLock的触发，LegacyKB_ioa_win.exe进程被暂停。
5. OpLock触发后，攻击者将C:\Windows\Temp\TencentDownload\~*文件夹移动到其他位置，使其原来的位置变空。
6. 攻击者将C:\Windows\Temp\TencentDownload\创建为一个指向“\RPC Control”的交接点（junction）。
7. 攻击者在“GLOBAL\GLOBALROOT\RPC Control”下创建一个符号链接“~*”，指向目标文件或文件夹（例如C:\Windows\System32\secrets）。
8. 攻击者释放OpLock。
9. LegacyKB_ioa_win.exe进程恢复执行，并继续删除操作，但此时其删除的目标已通过交接点和符号链接重定向至攻击者指定的高权限文件或文件夹。
10. 攻击者删除创建的符号链接。
11. 目标文件/文件夹（例如C:\Windows\System32\secrets）将被SYSTEM权限删除。

投毒风险分析:
根据提供的输入数据，PoC信息仅以Markdown格式的README文件呈现，详细描述了漏洞原理、影响版本和具体的利用步骤。其中没有包含任何可执行代码、脚本文件或外部链接（除了PoC视频链接和GitHub图片链接）。因此，就当前提供的这份PoC文档而言，其本身不包含任何恶意代码或投毒行为。它清晰地阐述了漏洞的攻击逻辑，旨在帮助安全研究人员理解和复现漏洞，以构建防御措施。
然而，需要注意的是，任何漏洞的PoC一旦被公开，都有被恶意行为者利用的风险。如果后续有其他研究员或攻击者基于此README文件开发出实际的利用脚本，这些脚本可能会被混淆、捆绑恶意负载或包含后门。因此，虽然这份README本身无投毒风险（0%），但组织在下载或运行任何来源不明的PoC代码时，仍需进行严格的安全审查，包括静态代码分析、沙箱执行、网络行为监控等，以防范潜在的投毒风险。对于本PoC所描述的攻击链，如果存在实际可运行的脚本，则需要重点检查其是否在攻击成功后植入恶意程序、建立持久化后门或执行其他未声明的行为。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-63945
