## CVE-2025-32433 - Erlang/OTP SSH Daemon 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH Daemon

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 具体版本范围未知，已知涉及使用Erlang/OTP构建的SSH服务及其后端应用

**利用条件:** 无需身份验证，目标系统开启了受影响版本的Erlang/OTP SSH服务，且网络可达

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2025-32433漏洞，这是一种存在于Erlang/OTP SSH守护程序中的严重预身份验证缺陷。POC代码逻辑完整，通过模拟标准的SSH握手协议，绕过了正常的身份验证流程。其核心利用原理是在SSH密钥交换（KEXINIT）阶段之后、用户身份验证完成之前，利用SSH协议消息处理逻辑中的缺陷注入恶意指令。代码中展示了如何通过raw TCP连接发送特定的SSH Banner和Banner包，并尝试通过不同的CHANNEL_OPEN类型（如session或direct-tcpip）来探测漏洞存在。最关键的有效性体现在其命令注入逻辑：POC尝试在SSH连接建立后的非安全通道中执行Erlang特定的代码片段（如file:write_file），这种针对Erlang运行时的注入方式直接命中漏洞核心，即在不安全的传输上下文执行了受控指令。POC还集成了多线程扫描和进度显示（tqdm），具备较高的工程化水平，能够在大规模网段中快速定位脆弱资产。利用步骤：1. 环境准备，确保安装了Python 3及必要的库（如argparse, socket）。2. 资产识别，将目标IP地址和端口填入配置文件或作为命令行参数传入。3. 协议仿真，脚本向目标端口发起TCP连接，发送符合协议规范的SSH版本识别字符串。4. 漏洞触发，利用脚本构造特殊的SSH消息包，在未经过身份验证的状态下尝试打开特定类型的SSH通道。5. 载荷执行，一旦通道非法开启，脚本会发送预定义的Erlang指令（默认操作是在根目录写入特定文件或建立反弹Shell）。6. 结果记录，脚本根据服务器返回的响应包特征判断是否利用成功，并将成功记录保存至results.txt。投毒风险分析：该POC代码结构透明，采用了Python标准库（socket, struct, threading）进行底层通信，增加了代码的可读性，便于安全审计人员验证其意图。代码中虽包含远程执行指令的功能（如file:write_file和潜在的反弹shell代码），但这属于漏洞验证（Exploit）的标配功能，而非针对渗透测试人员的恶意后门。风险点在于该POC可能被二次修改，攻击者可能在payload生成逻辑中隐蔽地嵌入攻击渗透机本身的恶意代码。目前脚本逻辑清晰，没有发现明显的代码混淆、非法外部连接、Base64编码的隐藏逻辑或针对本地环境的破坏行为。为了防御潜在风险，用户在执行此POC前应仔细检查DEFAULT_COMMAND参数的具体值，并建议在隔离的沙箱环境（Sandbox）中运行。总体而言，该脚本作为一种防御性安全研究工具，其投毒风险处于低风险区间，但由于其利用能力极强，若落入恶意攻击者之手，将构成重大的外部威胁。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32433_Erlang-OTP](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32433_Erlang-OTP)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
