## CVE-2025-55182 - React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 所有使用受影响React Server Components实现的应用，特别是Next.js

**利用条件:** 无需认证，可通过单次HTTP请求进行网络访问利用

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，绰号“React2Shell”，是CVSS评分为10.0的严重远程代码执行（RCE）漏洞。它主要影响React Server Components (RSC)及其构建的应用程序，特别是Next.js、Shopify Hydrogen和Gatsby 5。漏洞源于React Flight协议在反序列化不可信数据时的原型链污染（Prototype Pollution）缺陷。攻击者无需认证，通过构造恶意multipart表单请求，利用`$B`引用结合被劫持为`Function`的`_formData.get`，可动态生成并执行任意系统命令，实现对服务器的完全控制。此漏洞已被观察到大规模实际利用，例如Windows终端攻击尝试可追溯至2025年12月4日。

**POC有效性分析**：
提供的POC包含一个`Dockerfile`用于构建一个基于Node.js 20和pnpm的Next.js应用环境，以及一个详细的`README.md`文档。`Dockerfile`清晰地展示了如何搭建一个标准的Next.js生产环境，该环境若包含受影响的RSC功能，则会存在漏洞。`README.md`文档对React2Shell漏洞的原理、攻击机制、Flight协议的缺陷以及漏洞时间线进行了深入分析，提供了丰富的背景信息和技术细节。该POC是高质量的概念验证，能帮助研究人员快速构建测试环境并理解漏洞。然而，当前提供的代码片段本身未包含可以直接执行RCE的攻击脚本（如`exploit.py`或特定的请求构造代码）。因此，它虽有助于理解和复现漏洞，但仍需额外开发利用模块才能实现远程代码执行。

**利用步骤（概念性）**：
1.  **目标识别**：定位使用React Server Components（尤其Next.js、Shopify Hydrogen、Gatsby 5）的Web应用。
2.  **请求构造**：攻击者需利用Flight协议反序列化缺陷，精心构造一个恶意的HTTP multipart请求，利用其流式格式的特性。
3.  **注入载荷**：通过操纵`__proto__`、`constructor`等属性，并利用`$B`引用和受控变量，将包含系统命令的恶意函数注入应用程序数据结构中。
4.  **命令执行**：当应用程序处理恶意构造的数据时，受污染的对象属性会被触发，导致预设的系统命令在服务器上执行。
5.  **实现RCE**：成功执行命令后，攻击者可进一步下载恶意程序、窃取敏感数据或完全控制受感染的服务器。

**投毒风险分析**：
对提供的POC文件进行审查，包括`Dockerfile`和`README.md`，未发现任何恶意代码或可疑行为。`Dockerfile`是一个标准的Next.js应用程序构建和运行配置，其基础镜像来自官方Node.js仓库，依赖管理使用pnpm，并遵循了容器化部署的最佳实践，例如创建非root用户运行服务。所有命令都是为了构建和运行一个正常的Next.js应用。`README.md`则是一篇纯粹的漏洞分析文档，内容详尽且专业，无任何混淆代码、外部恶意链接或隐藏的恶意脚本。文件中提到的团队成员信息和项目描述都指向合法的安全研究活动。因此，该POC代码的投毒风险极低。尽管任何公开的POC都存在被恶意利用的潜在风险，但就其代码本身的安全性而言，本POC是清洁和无害的，旨在帮助防御者理解和防护此漏洞，而不是传播恶意软件。因此，投毒风险评估为10%。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
