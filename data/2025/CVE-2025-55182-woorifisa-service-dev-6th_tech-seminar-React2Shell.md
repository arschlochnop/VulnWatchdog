## CVE-2025-55182 - React Server Components (RSC), Next.js applications, react-server-dom-we 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC), Next.js applications, react-server-dom-we

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** 受影响版本为React Server Components及Next.js应用，在2025年12月3日补丁发布之前的所有版本。

**利用条件:** 无需认证，通过网络访问，单次HTTP请求即可利用。

**POC 可用性:** 4

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55182，代号“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，CVSS评分为10.0，被誉为“核弹级”漏洞。该漏洞主要影响React Server Components（RSC）架构下的应用程序以及基于Next.js的框架。其核心问题源于React在处理其专有的“Flight Protocol”数据时存在不安全的反序列化缺陷，具体表现为Prototype Pollution。Flight Protocol旨在优化组件渲染，通过JSON-like流式格式在服务端和客户端之间传输复杂的数据类型，如Promise、Blob和Map。攻击者能够通过精心构造的恶意请求，利用Flight Protocol中对用户输入处理不当，在未经认证的情况下，触发不安全的反序列化，从而在目标服务器上执行任意代码。

**POC有效性分析：**
提供的POC代码包含一个`Dockerfile`和一个`README.md`文件。`Dockerfile`用于构建一个基于Node.js 20和Next.js的应用程序环境，这通常是用于模拟或搭建一个可能存在漏洞的目标系统。它定义了构建依赖、应用构建步骤以及运行配置，是典型的Next.js生产环境部署流程。`README.md`文件则是一份详细的漏洞分析与研究报告，用于“우리FISA 기술세미나 6기 - 3팀”的演示。该报告深入阐述了React2Shell（CVE-2025-55182）的背景、核心问题（不安全的反序列化、Prototype Pollution）、Flight Protocol的缺陷、漏洞发现时间线以及攻击机制的原理性描述。尽管这份README提供了对攻击机制（例如利用Flight协议的表达式`$$`和`$@`进行恶意脚本注入）的详细解释，但它**并未包含一个直接可执行的攻击脚本**或完整的利用链代码。因此，该POC更倾向于一份高质量的“概念验证”或“漏洞分析说明”，而非一个开箱即用的RCE利用工具。它为理解漏洞原理提供了极大的帮助，但复现漏洞需要根据其描述自行编写利用代码。该POC的有效性在于其详尽的理论支撑和对漏洞深层机制的揭示，对于防御者理解漏洞并制定防御策略具有重要价值。

**利用步骤（基于概念分析）：**
1. **目标识别：** 识别使用React Server Components或Next.js且未及时打补丁（2025年12月3日前）的应用程序。
2. **请求构造：** 攻击者需要深入理解React Flight Protocol的结构和不安全反序列化的特性，精心构造一个包含恶意数据（利用Prototype Pollution）的HTTP请求体。这个请求将针对RSC处理Flight Protocol数据流的端点。
3. **发送攻击载荷：** 将构造好的恶意HTTP请求发送到目标服务器。由于漏洞是未认证的，攻击者无需任何凭据即可进行。
4. **触发反序列化：** 服务器在接收并尝试反序列化恶意构造的Flight Protocol数据时，由于不当处理用户输入，将触发Prototype Pollution，并最终导致在服务器端执行攻击者指定的任意代码。
5. **实现RCE：** 成功执行代码后，攻击者可以在服务器上执行系统命令、窃取敏感数据、部署后门或进一步渗透内部网络。

**投毒风险分析：**
鉴于提供的POC内容，投毒风险评估为**0%**。原因如下：
1. **代码内容纯净：** 提供的`Dockerfile`是标准的Node.js/Next.js应用程序构建脚本，使用了官方的Node.js Alpine镜像，并安装了标准的包管理器（pnpm）。它不包含任何可疑的外部依赖、混淆代码、恶意脚本注入或非常规操作。所有命令都是为了搭建一个合法的开发/生产环境。
2. **`README.md`为分析文档：** `README.md`文件是漏洞的详细分析报告，专注于描述漏洞原理、影响和利用机制。它没有嵌入任何可执行代码片段，也没有提供指向恶意资源的链接或执行恶意行为的指令。其内容完全是用于教育和研究目的。
3. **无实际利用代码：** 此POC并未提供可直接执行的RCE脚本或二进制文件。它仅停留在概念和理论分析层面，不包含任何能够直接在用户系统上执行恶意操作的组件。
4. **透明度高：** 整个POC项目的结构和内容都非常透明，没有进行任何形式的混淆或隐藏。这表明其意图是进行合法的安全研究和知识分享，而非传播恶意软件。
综上所述，该POC材料完全符合防御性安全研究的范畴，不具备任何投毒风险。

**项目地址:** N/A (本地文件路径，未提供公开项目地址)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
