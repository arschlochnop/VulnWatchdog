## CVE-2025-55182 - React Server Components (RSC) 远程代码执行 (RCE), 原型链污染 (Prototype Pollution), 反序列化漏洞 (Deserialization Vulnerability)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE), 原型链污染 (Prototype Pollution), 反序列化漏洞 (Deserialization Vulnerability)

**影响应用:** React Server Components (RSC)

**危害等级:** 核弹级漏洞, 高危

**CVSS评分:** 10.0

**影响版本:** 所有使用React Server Components (RSC) Flight Protocol的应用程序，包括Next.js、Shopify Hydrogen、Gatsby 5等，在2025年12月3日补丁发布之前版本

**利用条件:** 无需认证, 单次HTTP请求, 网络可访问

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55182，被称为“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，其根源在于React服务器组件（RSC）及其底层“Flight Protocol”的设计缺陷。该漏洞主要表现为在反序列化不可信数据过程中触发的原型链污染（Prototype Pollution）问题。攻击者可以利用这一缺陷，通过构造一个未经身份验证的恶意HTTP请求，在服务器端执行任意代码。此漏洞的危害程度被标记为“核弹级”和“高危”，其CVSS评分为10.0，充分体现了其严重性。由于RSC技术已被Next.js、Shopify Hydrogen和Gatsby 5等主流框架广泛采用，该漏洞对各类基于这些技术的Web应用程序和服务构成了重大威胁。核心问题在于Flight Protocol在处理复杂数据类型（如Promise、Blob、Map）时，未能正确验证对象属性的访问路径，从而允许攻击者注入并执行恶意脚本。

所提供的“POC代码”包含一个`Dockerfile`和一个详细的`README.md`文件。`Dockerfile`旨在构建一个基于`node:20-alpine`的容器化环境，并设置一个使用React服务器组件的Next.js应用程序。这有效地建立了一个存在React2Shell漏洞的“易受攻击的目标环境”。构建过程通过`pnpm`安装依赖，构建应用程序，并将其配置为以非root用户（`nextjs`）在端口3000上运行。这个Docker设置清晰且功能健全，可以用于创建潜在易受攻击的应用程序实例。`README.md`作为全面的文档，详细介绍了漏洞的背景、其“核心问题”（原型链污染）、Flight Protocol的复杂性、漏洞披露的时间线（从Meta Bug Bounty到2025年12月3日补丁发布），以及攻击机制的高级概述。然而，需要特别指出的是，所提供的文件“不包含实际的漏洞利用载荷或脚本”，无法直接对容器化应用程序触发RCE。因此，尽管该POC在研究和理解漏洞上下文方面非常出色，并能成功搭建漏洞环境，但它是一个“概念验证”性质的POC，而非完整的“利用代码”。

CVE-2025-55182的利用通常遵循以下概念性步骤：
1.  **目标识别**：识别使用Next.js等框架且利用了React服务器组件，并且运行在2025年12月3日补丁发布之前的易受攻击版本的Web应用程序。
2.  **请求构造**：构造一个恶意的HTTP请求，通常是`multipart/form-data`类型的请求，这种请求常用于在RSC上下文中将客户端组件数据发送到服务器。
3.  **载荷注入**：在请求体中嵌入一个经过特殊设计的恶意载荷。该载荷必须符合Flight Protocol的格式，但被设计用于利用其反序列化缺陷。关键技术包括利用`$B`引用、操纵`_response._prefix`或劫持`_formData.get`等函数。
4.  **原型链污染**：载荷旨在通过针对敏感对象属性或其原型（`__proto__`、`constructor`）来实现原型链污染。这种操作允许攻击者将任意数据（例如系统命令）注入到一个将在执行期间被解释为函数或评估的上下文中（例如，将 shell 命令字符串赋值给一个对象的`.then`属性）。
5.  **远程代码执行**：当服务器尝试反序列化恶意Flight Protocol流时，原型链污染被触发，注入的命令在服务器环境中执行，从而赋予攻击者远程代码执行能力。

与所提供的POC（Dockerfile和README）相关的投毒风险非常低，可评估为0%。`Dockerfile`使用标准且可信的基础镜像（`node:20-alpine`）以及知名的包管理器（`pnpm`）。其指令透明，且完全专注于设置一个Next.js应用程序，该应用程序本身即是易受攻击的目标。代码中没有发现任何隐藏命令、混淆脚本或试图获取恶意外部资源的行为。同样，`README.md`文件纯粹是描述性和信息性的，旨在为用户提供漏洞研究的教育目的。它明确声明了项目的目标是“分析及研究”。POC代码中没有嵌入任何恶意载荷或脚本，不会在运行POC的系统上执行。因此，安全研究人员或组织在分析此POC时，不会直接暴露于来自POC本身的恶意代码执行风险。风险在于`Dockerfile`所创建的应用程序的漏洞性，如果该应用程序暴露在不受信任的网络中，则可能被第三方利用。在处理易受攻击的软件环境时，始终建议进行适当的隔离和沙盒防护，但POC代码本身并非恶意。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
