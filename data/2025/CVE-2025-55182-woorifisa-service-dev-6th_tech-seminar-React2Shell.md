## CVE-2025-55182 - React Server Components (RSC), Next.js 远程代码执行 (RCE), 不安全反序列化, 原型污染

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE), 不安全反序列化, 原型污染

**影响应用:** React Server Components (RSC), Next.js

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 所有受影响的React Server Components (RSC) 及使用其Flight Protocol的Next.js应用程序（在2025年12月3日补丁发布前）

**利用条件:** 无需认证，通过网络访问，构造恶意HTTP请求

**POC 可用性:** 3

**POC 类型:** 概念验证 (提供漏洞环境与详细分析)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，又名“React2Shell”，是一个针对React Server Components (RSC) 和Next.js应用程序的严重远程代码执行 (RCE) 漏洞。该漏洞源于RSC所使用的Flight Protocol在处理不可信数据时的不安全反序列化问题，具体表现为原型污染 (Prototype Pollution)。攻击者无需认证即可通过精心构造的HTTP请求在服务器端执行任意代码。其CVSS 评分为10.0，被认为是“核弹级”漏洞，并已在披露后短时间内遭到大规模实际利用，包括与国家背景威胁行为者相关的攻击。根据Timeline信息，此漏洞于2025年11月29日首次报告，并于2025年12月3日发布补丁并公开披露。

**POC有效性分析**
所提供的POC代码包括一个`Dockerfile`和一个`README.md`文件。`Dockerfile`用于构建一个基于Node.js 20-alpine的Next.js应用程序环境。它设置了依赖项 (`pnpm install`)，执行 `pnpm run build`，并最终以非特权用户 `nextjs` 运行 `node server.js`。这表明该`Dockerfile`旨在部署一个可能存在漏洞的Next.js应用实例，作为一个测试或复现环境，它本身不包含任何攻击性代码。`README.md`文件则提供了对CVE-2025-55182漏洞的详细分析。它解释了React2Shell的概念、核心问题（不安全反序列化和原型污染）、Flight Protocol的设计缺陷以及攻击机制。它还包含了漏洞发现和披露的时间线。这个`README.md`是一个非常高质量的漏洞分析文档，有助于理解漏洞原理，但同样不包含直接用于利用的攻击脚本或工具。综合来看，所提供的“POC代码”并非一个完整的攻击利用脚本，而更像是一个用于搭建漏洞复现环境和深入理解漏洞机制的资料包。它为安全研究人员提供了研究漏洞所需的脆弱应用程序环境（通过`Dockerfile`）和详细的背景知识（通过`README`）。如果需要实际执行RCE，还需要根据`README`中描述的攻击机制，编写或获取单独的利用脚本，构造特定的HTTP请求来触发反序列化漏洞。因此，该POC的有效性在于提供了漏洞环境和详细分析，而非即插即用的攻击工具。

**利用步骤**
1. **搭建脆弱环境**: 使用提供的`Dockerfile`构建并运行一个存在漏洞的Next.js应用程序实例。这会在本地或服务器上创建一个可供测试的目标。
2. **理解攻击原理**: 仔细阅读`README.md`中关于React Flight Protocol、不安全反序列化和原型污染的描述，理解攻击者如何构造恶意数据来操纵服务器端组件的处理逻辑。
3. **构造恶意请求**: 根据Flight Protocol的特性和漏洞点，攻击者需要精心构造一个恶意的HTTP请求。这个请求通常会包含特殊格式的数据，例如利用`$`或`$$`标识符来注入原型污染的payload，从而在服务器端触发 `child_process.execSync` 或其他高危函数的调用，实现远程代码执行。
4. **发送请求**: 将构造好的恶意请求发送到运行中的Next.js应用程序。
5. **验证RCE**: 如果利用成功，服务器将执行攻击者指定的任意命令，例如创建文件、执行反弹shell等，从而验证远程代码执行的效果。

**投毒风险分析**
提供的POC代码（`Dockerfile`和`README.md`）本身没有任何恶意内容。`Dockerfile`仅用于构建标准的Node.js/Next.js应用，不包含任何可疑的外部依赖、混淆代码或恶意脚本。`README.md`是纯文本的漏洞分析文档。因此，仅基于提供的这些文件，投毒风险为低，评定为5%。然而，由于这是一个“核弹级”RCE漏洞，且已经存在大规模实际利用，因此存在以下潜在风险：
*   **恶意POC蔓延风险**: 在公共领域可能会出现包含实际恶意payload的利用脚本。下载并执行来源不明的POC代码时，需警惕其中是否被植入后门、挖矿程序、僵尸网络客户端或其他恶意软件。
*   **供应链攻击风险**: 如果在构建或部署应用程序时，引入了受此漏洞影响的旧版本`react-server-dom-we`或Next.js库，则可能在不经意间引入了攻击面。
*   **误用风险**: 即使是合法的POC，也可能被不法分子用于攻击未打补丁的系统。

**防御建议**
*   立即升级React Server Components和Next.js到已修复的版本。
*   在网络边界部署WAF/IPS，并确保其规则库已更新，能够识别并拦截针对CVE-2025-55182的攻击特征，特别是针对HTTP请求报文中高危参数和恶意构造内容的深度解析。
*   对所有来自外部的POC和利用工具进行严格的安全审查，包括静态代码分析和动态行为监控，确保其不包含恶意载荷。
*   遵循最小权限原则，确保应用运行环境的权限受限。
*   监控异常的进程执行和网络连接，及时发现潜在的RCE攻击。

**项目地址:** N/A (本地文件)

**漏洞详情:** N/A (未提供NVD链接，且CVE年份较新)
