## CVE-2025-55182 - React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE), 反序列化漏洞 (Deserialization), 原型链污染 (Prototype Pollution)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE), 反序列化漏洞 (Deserialization), 原型链污染 (Prototype Pollution)

**影响应用:** React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 核弹级, 严重

**CVSS评分:** 10.0

**影响版本:** React 19, Next.js 15/16, react-server-dom-we

**利用条件:** 无需认证, 单次HTTP请求, 网络可访问

**POC 可用性:** 4

**POC 类型:** 概念验证 (Concept Proof)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55182，又称“React2Shell”，是一个针对React Server Components (RSC) 的“核弹级”远程代码执行（RCE）漏洞，其CVSS评分高达10.0。此漏洞的核心问题在于React用于组件传输的“Flight Protocol”中存在不安全的去序列化机制。攻击者可以在未经认证的情况下，通过精心构造的HTTP请求，利用原型链污染（Prototype Pollution）技术，在目标服务器上执行任意代码。

**POC有效性分析：**
本次提供的“POC代码”并非直接可执行的漏洞利用脚本，而是一个用于构建脆弱环境的`Dockerfile`文件和一个详细描述漏洞原理与攻击机制的`README.md`文档。`Dockerfile`清晰地定义了一个基于Node.js 20-alpine和pnpm的Next.js应用程序的构建和运行环境，这对于复现受影响的Next.js应用场景至关重要。它包括了依赖安装、应用构建和最终生产环境的设置，并创建了低权限用户`nextjs`来运行服务，体现了构建一个接近真实环境的规范性。`README.md`文档则提供了对CVE-2025-55182漏洞的深入分析，详细解释了Flight Protocol的工作原理、漏洞的根本原因（信任链污染导致的去序列化问题）以及具体的攻击机制。文档中明确指出攻击者可以利用Flight Protocol流式格式中对`__proto__`、`constructor`等对象属性访问路径未进行严格校验的缺陷。通过构造恶意的`multipart`表单，结合`$B`引用，操纵可控的`_response._prefix`和被劫持为`Function`的`_formData.get`，动态生成包含任意系统命令的函数，并将其赋值给对象的`.then`属性，最终触发RCE。虽然未提供可直接运行的 exploit 脚本，但这份详细的原理分析和环境搭建文件，足以指导安全研究人员和开发者复现漏洞、验证概念并开发出实际的利用方式。因此，将其归类为“概念验证”类型，并在详细程度上赋予较高评价。

**利用步骤（基于概念和分析推断）：**
1.  **环境识别：** 识别使用React Server Components（RSC）的应用程序，特别是基于React 19或Next.js 15/16的系统。
2.  **请求构造：** 攻击者需要构造一个特殊的HTTP请求，通常是`multipart`表单请求，以利用Flight Protocol的去序列化过程。
3.  **原型链污染：** 在请求数据中注入恶意载荷，利用Flight Protocol未校验对象属性访问路径的缺陷，实现原型链污染。这可能涉及在序列化数据中插入对`__proto__`或`constructor`等特殊属性的引用。
4.  **恶意函数注入：** 利用协议中的`$B`引用机制，结合可控的服务端属性（如`_response._prefix`），并劫持特定方法（如`_formData.get`）将其变为一个函数构造器。
5.  **命令执行：** 动态生成包含任意系统命令的函数，并将其赋值给去序列化对象中的`.then`属性。当这个对象被处理时，恶意函数将被执行，从而实现远程代码执行。
该攻击无需认证，只需单次HTTP请求即可触发，攻击复杂度为低。

**投毒风险分析：**
根据提供的`Dockerfile`和`README.md`文件，本次评估的投毒风险为极低（0%）。`Dockerfile`的内容是一个标准的Node.js/Next.js应用程序构建流程，它从官方的`node:20-alpine`镜像开始，使用`pnpm`进行依赖管理，并将构建的应用打包到生产镜像中。整个构建脚本中没有发现任何异常的外部文件下载、可疑的命令执行、混淆代码或试图植入后门的行为。它旨在提供一个干净、可复现的脆弱目标环境，用于安全研究和漏洞验证。`README.md`文件则是一个纯粹的学术/技术分析文档，详细解释了CVE-2025-55182漏洞的原理、攻击机制和影响，其中所有的攻击描述都停留在概念层面，并没有包含任何实际可执行的恶意代码或恶意链接。该文档的目的明确为教育和研究，帮助读者理解漏洞的细节。由于提供的文件内容清晰透明，符合防御性安全研究的规范，不包含任何恶意载荷或引导用户执行有害操作的指令，因此，用户在下载并使用这些文件时，不会面临因这些文件本身而产生的投毒风险。本POC的目的是为了帮助组织理解和防御此漏洞，而非传播恶意代码。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
