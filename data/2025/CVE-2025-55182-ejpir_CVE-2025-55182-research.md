## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** 未经授权的网络访问

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182是React Server Components中存在的一个严重的反序列化漏洞，CVSS评分为10.0，允许未经身份验证的远程代码执行。该漏洞存在于React的Flight Protocol反序列化过程中，通过`getOutlinedModel()`函数中的原型链遍历实现。攻击者可以利用该漏洞访问`Function`构造函数，而无需预先注册模块，从而执行任意代码。

POC代码分析显示，原始的PoC尝试通过在服务器清单中显式注册危险模块（如`fs`、`child_process`、`vm`）来利用此漏洞，但这并非漏洞的真实利用方式。实际的漏洞利用涉及通过`getOutlinedModel()`函数进行原型链遍历。该函数在处理`$`引用时，没有进行`hasOwnProperty`检查，导致可以访问对象的原型链。通过构造特定的payload，例如`"$1:constructor:constructor"`，攻击者可以依次访问`chunk[1]["constructor"]`和`Object["constructor"]`，最终获得`Function`构造函数，从而执行任意代码。

利用步骤：
1. 构造包含恶意引用的FormData，例如`formData.set('0', '"$1:constructor:constructor"')`。
2. 使用`decodeReply`函数反序列化FormData。
3. 反序列化过程中的`getOutlinedModel`函数会执行原型链遍历，最终返回`Function`构造函数。
4. 攻击者可以使用`Function`构造函数执行任意代码。

POC有效性分析：虽然提供的POC代码不是一个完整的利用，但它验证了通过原型链遍历获取`Function`构造函数的可能性。这个概念验证对于理解漏洞的根本原因和开发有效的防御措施非常有价值。

投毒风险分析：该PoC的投毒风险较低，因为代码清晰，主要使用了标准库，没有发现可疑的请求或行为。但是，如果攻击者修改PoC，使其包含恶意代码或外部依赖项，则投毒风险会增加。此外，如果攻击者利用此漏洞在服务器端执行任意代码，则可能会植入后门或恶意软件，从而对服务器造成持久性损害。因此，需要对PoC代码进行仔细审查，并采取适当的安全措施来防止潜在的攻击。

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
