## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地低权限用户访问；Sudo支持并配置了--chroot选项功能

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）源于Sudo自1.9.14版本引入的--chroot机制存在严重的安全缺陷。在受影响的版本中，当执行带有chroot选项的命令时，Sudo对非可信用户控制目录下的环境处理不当。具体而言，系统会从用户控制的目录中加载诸如/etc/nsswitch.conf等配置文件，通过构造恶意的目录结构和伪造的库文件，攻击者可以诱导Sudo在提升权限的过程中加载非法的动态链接库。本次分析的POC代码展示了极高的成熟度。该POC不仅提供了自动化的Python脚本（get_root.py）和Shell脚本（get_root.sh），还预编译了针对x86_64和aarch64架构的二进制Payload。这意味着攻击者无需在目标机器上安装gcc等编译工具即可完成利用。脚本通过检测系统架构，解压对应的Base64编码载荷，并在临时目录构建恶意chroot环境，最终触发Sudo加载恶意组件以获取Root Shell。经分析，其利用链条完整，适配性强，在默认配置的受影响Linux发行版上具有极高的成功率。【利用步骤】1. 获取目标系统的本地低权限Shell；2. 确认Sudo版本在1.9.14至1.9.17之间；3. 下载并解压POC包，赋予执行权限；4. 运行./get_root.sh，脚本会自动探测CPU架构；5. 脚本创建伪造的chroot rootfs并放置恶意nsswitch配置文件及对应的so库；6. 触发sudo --chroot并加载载荷，最终弹出Root权限的交互式终端。【投毒风险分析】该POC项目投毒风险处于低至中等水平（约15%）。主要的风险点在于：1. 二进制黑盒载荷：POC采用了Base64编码的预编译二进制文件（位于archs-dynamic/static目录下）。由于这些载荷是以二进制形式分发的，普通用户难以直接审计其内部行为，存在被植入第二阶段后门、木马或持久化工具的潜在风险。2. 外部依赖：README中引导用户访问特定的外部博客链接获取“缓解方案”，这类引导可能被用于钓鱼或传播其他恶意信息。3. 敏感权限操作：由于提权POC本身就需要操作敏感系统路径（如/tmp下的特权执行），恶意代码容易混淆其中。然而，代码整体结构清晰，逻辑符合CVE描述的漏洞原理，未发现明显的反向Shell回连或破坏性系统指令。建议在隔离的沙箱环境中使用，并优先选择手动审计mkall-dynamic.sh源码后自行编译载荷，而非直接运行预置的二进制文件。

**项目地址:** [https://github.com/MohamedKarrab/CVE-2025-32463](https://github.com/MohamedKarrab/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
