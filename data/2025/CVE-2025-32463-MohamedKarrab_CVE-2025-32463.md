## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 本地低权限用户访问，目标系统安装了受影响版本的 Sudo 且支持 --chroot (-R) 选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）是 Sudo 在 1.9.14 版本引入 --chroot (-R) 参数后产生的安全缺陷。漏洞核心在于 Sudo 在处理 chroot 环境时，未能正确隔离 NSS（Name Service Switch）配置文件的加载路径。当用户执行带有 --chroot 选项的 Sudo 命令时，程序会尝试从用户控制的目录中加载 /etc/nsswitch.conf。攻击者可以通过在受控目录下构造恶意的 nsswitch.conf 文件，并配合特制的动态链接库（.so文件），迫使 Sudo 以 root 权限加载并执行该恶意库，从而实现从普通用户到 root 权限的提升。此 POC 的有效性极高，因为它不仅提供了自动化脚本（get_root.sh/py），还内置了针对 x86_64 和 aarch64 架构的预编译二进制 payload，极大地降低了利用门槛，甚至无需目标系统安装 gcc 编译器。利用步骤如下：1. 攻击者获取目标 Linux 系统的普通 Shell 权限；2. 克隆或上传 POC 工具包；3. 运行 get_root.sh，脚本会自动检测系统架构并选择对应的 base64 编码 Payload；4. 脚本在 /tmp 目录下创建伪造的 chroot 根目录环境，配置恶意的 nsswitch.conf；5. 执行 sudo -R 命令触发漏洞，最终弹回或直接获取 root shell。经分析，该 POC 逻辑清晰，利用链条完整，在 Ubuntu 等主流发行版上具有极高的实战价值。【投毒风险分析】该 POC 存在中低程度的投毒风险，主要风险点源于其“免编译”特性。POC 中包含大量 base64 编码的二进制 Payload（如 king.x86_64.b64 等），这些预编译的二进制文件对于安全研究人员来说是“黑盒”，很难直接通过肉眼审计其真实行为。虽然作者声称这些是用于提权的 payload，但理论上攻击者可以在其中植入隐蔽的后门、中继木马或窃密脚本。此外，POC 脚本 get_root.py 中包含从外部仓库克隆及执行动态下载内容的操作，如果 GitHub 仓库被接管，脚本可能被替换为恶意程序。然而，目前的分析显示其主要行为仍聚焦于漏洞验证。建议在隔离的沙箱环境或虚拟机中进行测试，严禁直接在生产环境运行未经审计的二进制 payload。对于防御方，应重点监控 sudo -R 参数的使用记录，并尽快升级 sudo 至 1.9.17p1 或更高版本，或者通过配置禁用普通用户的 chroot 权限。

**项目地址:** [https://github.com/MohamedKarrab/CVE-2025-32463](https://github.com/MohamedKarrab/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
