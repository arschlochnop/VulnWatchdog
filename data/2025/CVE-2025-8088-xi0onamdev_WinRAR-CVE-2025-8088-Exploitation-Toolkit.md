## CVE-2025-8088 - WinRAR 目录遍历/任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 高危

**影响版本:** 未明确指定受影响版本范围，但搜索结果指出该漏洞影响广泛

**利用条件:** 需要用户交互，即用户解压恶意构造的RAR压缩包。攻击者需通过社交工程或其他方式诱导受害者打开恶意文件。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重目录遍历漏洞。该漏洞的根本原因在于WinRAR在处理RAR压缩文件时，未能正确验证压缩包中文件路径的合法性，攻击者可巧妙利用Windows NTFS备用数据流（ADS）特性和路径遍历（例如 `..\..\`）技术，绕过WinRAR的文件验证机制。通过构造一个恶意的RAR压缩包，攻击者可以将恶意文件释放到系统任意指定位置，例如Windows启动文件夹 (`%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`)。一旦恶意文件被成功释放至启动文件夹，当受害者的系统下次启动时，该恶意文件将自动执行，从而实现任意代码执行（RCE）和持久化控制。

该漏洞的危害级别被评定为“高危”，并且有报告指出，此漏洞已被RomCom等APT组织广泛利用于实际攻击中，表明其具有高度的现实威胁性。鉴于WinRAR作为Windows平台广泛使用的压缩工具，其用户基数庞大，此漏洞的影响范围极为广泛，对个人及企业用户构成严重安全风险。

**POC有效性分析**

提供的POC是一个名为“CVE-2025-8088 WinRAR Exploit Tool”的GUI工具，设计精良且功能强大，旨在利用WinRAR的路径遍历漏洞。该工具通过结合高级NTFS备用数据流（ADS）技术和RAR5头部操作，实现了对安全控制的绕过。其主要能力包括：
*   **ADS隐身技术**: 利用NTFS备用数据流隐藏Payload，增强隐蔽性。
*   **头部注入**: 精确操作RAR5文件头，实现路径遍历。
*   **自动持久化**: 自动将Payload释放到Windows启动文件夹，确保系统重启后继续执行。
*   **诱饵操作**: 支持自定义诱饵文件，以分散受害者注意力。

该工具的运行需要Python 3.8+、WinRAR CLI（需在系统PATH中）以及PyQt6库。其操作手册清晰，用户只需选择Payload、可选的诱饵文件、目标用户名和输出文件名，即可一键生成武器化的恶意RAR存档。从技术原理上看，该工具遵循五个阶段：流注入、存档构建、头部打补丁（修改路径为 `..\..\`）、完整性检查（重计算CRC32）和最终部署。目标路径明确指向Windows启动文件夹，这是一种经典的持久化机制。这些详细的描述和功能实现表明该POC是一个功能完整、可操作性强的漏洞利用工具，能够有效地复现和利用CVE-2025-8088漏洞。

**利用步骤**

攻击者可利用此POC工具按照以下步骤进行攻击：
1.  **环境设置**: 确保攻击机器上安装Python 3.8+，并通过 `pip install PyQt6` 安装必要的库。同时，WinRAR的命令行工具 `rar.exe` 需位于系统PATH中。
2.  **启动工具**: 通过命令行 `python gui.py` 启动GUI界面的漏洞利用工具。
3.  **选择Payload**: 在工具界面中，选择预先准备好的恶意可执行文件（如 `.exe` 或 `.bat`）作为攻击载荷。
4.  **配置诱饵文件 (可选)**: 根据需要，选择一个合法的、无害的文件作为诱饵文件，以增加恶意压缩包的欺骗性。
5.  **设置目标用户**: 指定一个备用的Windows用户名（默认为Administrator），以适配不同的目标环境。
6.  **定义输出文件**: 为生成的恶意RAR存档文件命名（例如 `report.rar`）。
7.  **生成恶意存档**: 点击“INITIATE EXPLOIT BUILD”按钮，工具将自动执行流注入、RAR5头部操作、CRC32重计算等步骤，生成包含恶意Payload的武器化RAR文件。
8.  **攻击投递与执行**: 攻击者将生成的恶意RAR文件（如 `report.rar`）通过邮件、即时通讯、恶意网站下载等方式投递给目标受害者。一旦受害者被诱导解压此恶意RAR文件，其中的Payload将利用目录遍历漏洞被释放到 `%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\` 目录。系统下次启动时，该Payload将自动执行，从而实现攻击者的任意代码执行目的。

**投毒风险分析**

对该POC代码本身的投毒风险评估为低（5%）。此POC的 `README.md` 文件明确声明其用途为“教育目的”和“授权安全测试”，并附有警告免责声明，指出作者不对滥用或造成的损害负责。从提供的文档和部分代码片段来看，没有发现明显的恶意代码混淆、植入外部恶意脚本、或未经授权地收集用户信息等行为。该工具的核心功能围绕着RAR文件的结构操作，利用其漏洞机制，以生成一个“武器化”的压缩包，而非在POC工具运行时对使用者系统本身进行攻击。

“后门代码”或“恶意文件”的提及，指的是攻击者通过此POC工具所选择并嵌入的“Payload”（例如用户提供的 `.exe` 或 `.bat` 文件），而非POC工具自身包含额外的恶意载荷。POC的作用是帮助安全研究人员或授权测试人员模拟攻击，验证漏洞的存在和可利用性。因此，该POC代码本身在设计上是服务于安全研究目的的，并非旨在对使用者进行投毒。然而，任何开源工具都存在潜在的供应链风险，建议用户在使用前仔细审查代码，并在隔离、受控的环境中运行，以防万一。同时，切勿将此类工具用于未经授权的非法活动。

**项目地址:** 未提供公开代码仓库地址，仅有开发者Telegram链接

**漏洞详情:** https://avd.aliyun.com/detail?id=AVD-2025-8088
