## CVE-2025-8088 - WinRAR 目录遍历/路径穿越 (Directory Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越 (Directory Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 8.4

**影响版本:** WinRAR 7.12 及更早版本

**利用条件:** 需要用户交互 (解压恶意压缩包)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：
提供的POC是一个基于Python的图形用户界面 (GUI) 工具，名为“CVE-2025-8088 WinRAR Exploit Tool”，旨在创建恶意RAR压缩包以利用WinRAR的目录遍历漏洞 (CVE-2025-8088)。该工具被设计为能够绕过安全控制并实现目标系统的持久化。它采用了两种高级技术：首先，利用NTFS备用数据流 (ADS) 来隐蔽地存储实际的恶意载荷，使其不易被常规检测手段发现；其次，直接操作RAR5压缩包的头部信息，注入精心构造的路径遍历序列（例如，`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）。这种头部篡改允许攻击者指定一个任意的解压路径，绕过WinRAR的文件路径验证机制，从而将恶意文件放置到系统关键位置，如Windows的启动文件夹。一旦目标用户下次登录系统，位于启动文件夹的恶意载荷（例如`.exe`或`.bat`文件）将自动执行，从而授予攻击者远程代码执行 (RCE) 的权限。该工具还具备自动持久化功能（通过定位Windows启动文件夹）和诱饵文件支持，以进一步增强攻击的隐蔽性。核心文件`exploit_core.py`展示了其技术实现细节，包括如何调用`rar.exe`创建基础RAR压缩包，然后修改其内部结构（特别是文件头部和CRC32校验和）以实现路径遍历。这种详细且功能完备的实现方式，证实了该POC在演示和利用此漏洞方面的极高有效性。

利用步骤：
要使用提供的“CVE-2025-8088 WinRAR Exploit Tool”POC：
1.  **系统环境准备**：确保系统安装了Python 3.8或更高版本。同时，WinRAR的命令行工具`rar.exe`必须存在于系统PATH环境变量中，或者位于其默认安装路径下（例如`C:\Program Files\WinRAR\rar.exe`或`C:\Program Files (x86)\WinRAR\rar.exe`）。
2.  **安装依赖库**：打开终端或命令提示符，执行`pip install PyQt6`命令来安装所需的Python模块。
3.  **启动工具**：导航到包含POC文件的目录（即`gui.py`所在目录），然后执行命令`python gui.py`。这将启动POC的图形用户界面。
4.  **选择恶意载荷**：在GUI界面中，点击“PAYLOAD”按钮，选择您的可执行恶意载荷文件（例如`malware.exe`、`script.bat`）。这是最终将被放置到目标系统并执行的文件。
5.  **选择诱饵文件（可选）**：点击“DECOY”按钮，选择一个诱饵文件。该文件将被正常解压，旨在分散受害者的注意力，使其误以为压缩包内容无害。
6.  **设置目标用户名**：根据需要调整“TARGET”字段，指定一个备用的用户名。通常情况下，使用默认值或利用`%USERNAME%`环境变量即可。
7.  **定义输出文件名**：在“OUTPUT”字段中，指定要生成的恶意RAR压缩包的文件名（例如`invoice.rar`）。
8.  **启动漏洞利用构建**：点击“INITIATE EXPLOIT BUILD”按钮。工具将按以下五个阶段执行操作：流注入（将载荷隐藏在ADS中）、归档构建（创建基础RAR）、头部修补（修改头部以实现路径遍历）、完整性检查（重新计算CRC32）和部署（最终完成武器化RAR）。
9.  **部署与攻击**：恶意RAR压缩包生成后，即可将其分发给受害者。当受害者使用存在漏洞的WinRAR版本解压此压缩包时，恶意载荷将被放置到其Windows启动文件夹，从而在系统登录时实现持久化和RCE。

投毒风险分析：
对提供的POC代码（包括`README.md`和`exploit_core.py`）进行分析后，评估其投毒风险为**低 (10%)**。

1.  **代码透明与可审计性**：核心逻辑文件`exploit_core.py`的代码结构清晰、易于阅读，使用了标准Python库和模块（如`os`、`shutil`、`subprocess`、`struct`、`zlib`、`pathlib`）。代码中未发现任何旨在混淆、加密或隐藏其真实意图的复杂逻辑。`README.md`也提供了详细的工具使用指南和技术说明。
2.  **合法外部依赖**：POC依赖于Python 3.8+、PyQt6图形库以及系统上已安装的WinRAR命令行工具（`rar.exe`）。这些都是常见且合法的软件或开发库。`exploit_core.py`中通过`subprocess`调用`rar.exe`的行为是透明且符合其功能需求的。
3.  **无恶意自传播行为**：该POC的目的是**生成**一个利用WinRAR漏洞的恶意RAR文件，而不是POC代码本身具有恶意行为。在代码中，未发现任何主动进行网络通信（如连接C2服务器、下载外部脚本）、对研究人员系统进行未经授权的修改（如安装后门、植入恶意软件、窃取数据）或进行自传播的迹象。
4.  **无代码混淆或滥用**：代码中未使用任何形式的代码混淆、动态加载或不透明的加密技术。所有逻辑都可以直接通过源代码进行审查。`subprocess`的使用是为了调用外部的`rar.exe`，这是完全合法的，没有发现滥用`eval()`、`exec()`等危险函数的行为。
5.  **明确的教育和测试声明**：`README.md`中明确声明此工具仅用于“教育目的”和“授权安全测试”。虽然此免责声明不能完全排除所有风险，但在代码透明且缺乏实际恶意行为的情况下，它进一步支持了该POC的防御性安全研究性质。

综上所述，该POC代码本身不包含任何恶意或可疑的投毒行为。它是一个用于帮助安全研究人员理解、复现漏洞并构建防御措施的工具，而非旨在攻击研究人员系统本身的恶意软件。因此，其投毒风险极低。

**项目地址:** 无公开仓库链接

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
