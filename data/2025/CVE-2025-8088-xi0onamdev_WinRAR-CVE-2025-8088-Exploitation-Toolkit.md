## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 暂无 (NVD尚未发布评分)

**影响版本:** WinRAR 7.12 及以下版本

**利用条件:** 需要用户解压精心制作的RAR压缩包，攻击链通常将恶意文件隐藏在压缩包内诱饵文件的替代数据流中。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-8088是一个影响WinRAR压缩软件的严重路径遍历漏洞，主要波及版本7.12及更早版本。该漏洞利用Windows NTFS文件系统的备用数据流（Alternate Data Streams, ADS）特性和RAR5压缩格式的头部操作，绕过WinRAR的文件解压验证机制。攻击者可构造恶意RAR压缩包，通过ADS隐藏恶意负载，并利用路径遍历技术（如`../../`）将恶意文件释放到任意指定目录，包括系统启动目录（如`C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）。一旦恶意文件置于启动目录，将在用户登录或系统启动时自动执行，实现持久化驻留和任意代码执行（RCE）。搜索结果显示，此漏洞已被用于有针对性的间谍活动，尤其在东南亚地区，表明其在实际攻击中的高价值。部分报告提及该漏洞可能导致蓝屏攻击，凸显其危害性。

提供的POC代码是一个名为“CVE-2025-8088 WinRAR Exploit Tool”的Python工具。该工具旨在创建一个恶意的RAR压缩包，利用路径遍历漏洞。其核心功能包括：ADS隐身技术（隐藏负载）、RAR5头部注入（实现精确路径遍历到启动目录）、自动持久化（目标Windows启动目录）和诱饵操作（支持自定义诱饵文件）。工具基于Python 3.8+、PyQt6（用于GUI）和WinRAR CLI构建。`exploit_core.py`模块负责核心逻辑，包括定位WinRAR可执行文件和生成恶意RAR文件的流程。它通过文件流注入隐藏payload，构建RAR档案，修改RAR头部插入路径遍历序列，并重新计算CRC32校验和。

**POC有效性分析**：
`README.md`提供了清晰的操作手册、系统要求和技术情报，展示了作者对漏洞原理的深入理解。`exploit_core.py`代码片段则展示了实现漏洞利用的关键逻辑，如`_find_winrar`函数和`create_malicious_archive`函数，涉及RAR5签名、头部标志、结构处理和CRC计算。该工具支持GUI，为攻击者提供了用户友好的操作环境，显著降低了技术门槛。这表明它是一个成熟的、可立即投入使用的漏洞利用工具。多篇漏洞复现文章进一步证实了该漏洞的广泛关注度和可复现性，因此该POC的有效性极高。

**利用步骤**：
1.  **环境准备**：攻击者需安装Python 3.8+、PyQt6库并确保WinRAR CLI工具位于系统PATH中。
2.  **启动工具**：运行Python GUI工具。
3.  **配置Payload**：在工具界面中选择待植入的恶意可执行文件（如`.exe`或`.bat`）。
4.  **配置诱饵**：可选地，选择一个无害诱饵文件以增加欺骗性。
5.  **设置目标**：指定回退用户名（默认为Administrator），构造释放路径。
6.  **定义输出**：设置生成的恶意RAR档案的文件名。
7.  **生成档案**：点击“INITIATE EXPLOIT BUILD”，工具将执行流注入、档案构建、头部修补（插入路径遍历序列指向Windows启动目录）和CRC32重新计算，最终生成恶意RAR档案。
8.  **社会工程**：攻击者将生成的恶意RAR档案通过电子邮件、即时通讯或恶意网站等方式发送给受害者。
9.  **用户交互**：受害者解压该RAR档案后，恶意Payload通过路径遍历漏洞被释放到Windows启动目录。
10. **代码执行**：当受害者下次启动系统或登录时，启动目录中的恶意Payload将自动执行，从而实现对受害者系统的控制。

**投毒风险分析**：
对该POC代码的投毒风险评估为**低**（5%）。`README.md`文件明确声明工具用于“教育目的”和“授权安全测试”，并附带清晰免责声明，符合合法安全工具的实践。技术层面，`exploit_core.py`代码片段未显示自我“投毒”迹象。代码中未发现进行不明网络请求、下载外部脚本或连接C2服务器的行为，所有操作均围绕本地文件系统、WinRAR命令行工具和RAR文件格式处理。代码可读性强，无明显混淆。它主要使用Python标准库和PyQt6，这些库的使用与合法压缩包漏洞利用工具的需求一致。代码的核心功能（通过ADS隐藏文件、修改RAR头部、重新计算CRC32）与`README.md`描述的漏洞利用机制完全匹配。工具旨在**生成**恶意RAR文件，而非自身成为恶意软件。其运作原理透明，易于安全研究人员审计，确认无额外恶意功能。因此，该POC工具本身被恶意代码“投毒”的风险非常低。

**项目地址:** N/A (本地文件路径)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
