## CVE-2025-8088 - WinRAR 目录遍历/路径穿越(Directory Traversal/Path Traversal) -> 任意代码执行(RCE)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越(Directory Traversal/Path Traversal) -> 任意代码执行(RCE)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 7.12及以下版本

**利用条件:** 需要用户打开恶意构造的RAR压缩包，需要本地安装WinRAR

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

对CVE-2025-8088的分析表明，这是一个影响WinRAR软件的严重目录遍历漏洞。该漏洞允许攻击者通过精心构造恶意的RAR压缩包，在受害者解压时将文件释放到系统任意位置，最终导致任意代码执行。该漏洞已被APT组织（如RomCom）利用，影响广泛，危害级别被评定为“高”。

**POC有效性分析**

提供的POC是一个名为“CVE-2025-8088 WinRAR Exploit Tool”的Python GUI工具，设计精良且功能完整。它旨在利用WinRAR的路径遍历漏洞，生成恶意的RAR档案。该工具通过以下核心技术实现了漏洞利用的有效性：
1.  **NTFS备用数据流（ADS）隐身技术**：攻击载荷（如`.exe`或`.bat`文件）被嵌入到NTFS备用数据流中，使其在标准文件系统视图和某些基础安全扫描中不可见，增强了隐蔽性。
2.  **RAR5文件头操纵与路径遍历**：工具能够直接修改RAR5压缩包的文件头，在文件路径中插入目录遍历序列（例如`..\..\..\..\Startup\`）。这使得恶意文件在解压时能够“跳出”预期的解压目录，被放置到攻击者指定的目标位置，特别是Windows的启动文件夹（`Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）。
`exploit_core.py`代码（尽管被截断）与`README.md`的描述一致，包含了定位WinRAR可执行文件、将载荷注入ADS、构建基础RAR文件、修补文件头以实现路径遍历以及重新计算CRC32校验和以确保文件完整性等关键步骤。`README.md`中概述的“流注入”、“档案构建”、“文件头修补”、“完整性检查”和“部署”五个阶段，进一步证实了该漏洞利用工具的技术完备性。通过自动将载荷部署到启动目录，实现了系统重启或用户登录时的持久化和任意代码执行。此外，该工具还支持设置诱饵文件，以增加社会工程学的成功率，诱导受害者打开并解压恶意档案。

**利用步骤**

利用CVE-2025-8088 WinRAR Exploit Tool的步骤如下：
1.  **环境准备**：确保操作系统安装了Python 3.8+，并且WinRAR CLI版本存在于系统PATH或默认安装路径中。通过`pip install PyQt6`安装GUI所需的Python库。
2.  **启动工具**：在命令行中执行`python gui.py`来启动漏洞利用工具的图形用户界面。
3.  **选择载荷**：在工具界面中，指定要植入目标系统的恶意可执行文件（例如`.exe`或`.bat`脚本）。
4.  **选择诱饵文件（可选）**：为了增加欺骗性，可以选择一个看似正常的文档或图片作为诱饵文件，使其与恶意载荷一同打包。
5.  **设置目标路径**：工具会自动构造针对Windows启动目录的路径。用户可以设置一个备用的Windows用户名（默认为“Administrator”）来构建目标路径。
6.  **定义输出**：指定生成的恶意RAR压缩包的文件名。
7.  **生成恶意档案**：点击界面上的“INITIATE EXPLOIT BUILD”按钮，工具将执行上述五阶段操作，生成最终的武器化RAR文件。
8.  **分发与诱导**：将生成的恶意RAR文件通过邮件、即时通讯或其他方式分发给目标用户，并设法诱导其打开并解压该压缩包。一旦解压，载荷将成功植入目标系统的启动目录，等待执行。

**投毒风险分析**

根据对提供的POC代码 (`exploit_core.py`) 和 `README.md` 文件的深入分析，该POC的投毒风险被评估为**0% (低风险)**。主要理由如下：
1.  **明确的教育与测试目的**：`README.md`明确指出该工具仅用于“教育目的”和“授权安全测试”，并警告使用者不得滥用。这种透明的声明表明其设计意图是合法的安全研究。
2.  **代码行为透明**：代码的片段显示其主要功能集中在文件操作（例如使用`os`、`shutil`、`pathlib`模块）、外部程序调用（使用`subprocess`模块调用本地`rar.exe`）以及二进制数据处理（使用`struct`和`zlib`模块进行RAR文件头和CRC32的计算）。这些行为均符合一个漏洞利用构造工具的预期功能，而不是其自身具有恶意性。
3.  **无恶意网络通信**：在提供的代码和描述中，未发现任何试图建立未经授权的网络连接、下载外部恶意资源、或与远程服务器进行数据交换的行为。所有操作都限定在本地文件系统和本地程序调用范围内。
4.  **依赖标准库与明确的第三方库**：除了用于构建图形界面的`PyQt6`库外，该POC仅依赖Python标准库。没有引入任何未知来源、模糊用途或已被识别为潜在恶意行为的第三方库。
5.  **无代码混淆或加密**：代码以清晰可读的方式呈现，没有使用任何混淆、加密或其他隐藏其真实意图的技术。这使得安全分析人员能够直接审查其功能。

综上所述，该POC本身是一个合法的安全研究工具，用于演示和复现WinRAR漏洞的利用过程。它旨在生成恶意载荷，而非其自身即为恶意载荷。因此，将其用于安全分析和防御措施的建立是安全的，无需担忧其作为“投毒”工具的风险。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
