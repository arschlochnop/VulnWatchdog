## CVE-2025-8088 - WinRAR 路径遍历/目录穿越/任意代码执行 (Path Traversal/Directory Traversal/Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越/任意代码执行 (Path Traversal/Directory Traversal/Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 8.4

**影响版本:** 受影响的WinRAR版本，包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll

**利用条件:** 需要用户解压特制恶意压缩包

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重路径遍历漏洞，允许攻击者通过制作恶意压缩包，在用户解压时绕过WinRAR的文件验证机制，将恶意文件释放到系统任意位置，最终实现任意代码执行。该漏洞利用了Windows NTFS备用数据流 (ADS) 特性以及路径遍历技术 (例如 `../../..`)。受影响的版本包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll。此漏洞最初被ESET安全研究人员发现并报告，随后被多个威胁情报机构，如ESET和Google威胁情报小组 (GTIG) 确认已被RomCom (UNC4895)、APT44、图拉 (Turla) 等境外APT组织广泛武器化利用，针对乌克兰军事及政府机构发动定制化的鱼叉式网络钓鱼攻击。此外，也有报告指出中国境内的非法攻击团伙也在利用此漏洞。该漏洞因其零日特性和高利用率，被评定为高危级别，CVSS v3.1评分为8.4。

**POC有效性分析：**

提供的POC是一个名为“CVE-2025-8088 WinRAR Exploit Tool”的Python GUI工具，旨在创建利用此WinRAR路径遍历漏洞的恶意RAR压缩包。该工具设计精良，具备军用级别特征，能够有效实现对WinRAR的攻击。它利用了多项先进技术，包括NTFS备用数据流 (ADS) 来隐藏有效载荷，以及对RAR5文件头进行直接操作以实现精确的路径遍历。该工具支持自动持久化机制，能够将恶意文件释放到Windows启动文件夹 (例如 `C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`)，确保系统重启后自动执行。此外，它还支持自定义诱饵文件以增强隐蔽性。该POC工具的核心功能通过`exploit_core.py`实现，详细展示了其构建恶意RAR文件的能力，包括：1. **流注入 (Stream Injection)**：将恶意载荷隐藏在ADS中；2. **档案构建 (Archive Construction)**：构建基础RAR文件结构；3. **头部修补 (Header Patching)**：修改RAR文件头，插入`../../`等路径遍历序列以控制文件释放路径；4. **完整性检查 (Integrity Check)**：重新计算CRC32校验和以确保恶意档案的有效性；5. **部署 (Deployment)**：生成最终的武器化RAR文件。`exploit_core.py`代码中对RAR文件格式的深入理解，特别是对文件头结构和CRC32的精确计算，表明了该POC的高度专业性和有效性。通过调用系统中的`rar.exe`命令行工具进行操作，确保了与WinRAR官方程序的兼容性。因此，该POC在生成可利用WinRAR漏洞的恶意压缩包方面具有极高的有效性和可靠性。

**利用步骤：**

1.  确保系统已安装Python 3.8+和PyQt6，并且WinRAR CLI (`rar.exe`) 在系统PATH中或默认位置。
2.  运行`pip install PyQt6`安装依赖。
3.  执行`python gui.py`启动图形化攻击控制台。
4.  在控制台中选择要隐藏的恶意可执行文件 (如 `.exe` 或 `.bat`) 作为PAYLOAD。
5.  (可选) 选择一个诱饵文件 (DECOY) 来分散目标注意力。
6.  设置备用用户名 (TARGET)，默认为Administrator。
7.  定义恶意压缩包的输出名称 (OUTPUT)。
8.  点击“INITIATE EXPLOIT BUILD”按钮，生成武器化的RAR压缩包。
9.  将生成的恶意RAR压缩包通过社会工程学手段发送给受害者。
10. 受害者解压该恶意RAR压缩包后，恶意载荷将被释放到指定路径（如Startup文件夹）。
11. 当受害者系统重启或触发恶意载荷时，攻击者实现任意代码执行。

**投毒风险分析：**

对该POC代码的分析显示，其自身的投毒风险较低。该POC的明确目标是创建一个用于利用WinRAR漏洞的工具，而不是自身包含恶意代码或成为恶意载体。它主要使用了Python标准库 (`os`, `shutil`, `subprocess`, `struct`, `zlib`) 以及GUI库 (`PyQt6`)。代码逻辑清晰，没有发现任何混淆、加密、连接外部恶意C2服务器、下载额外可执行文件或执行`eval`等可疑行为。项目README文件也明确声明该工具仅用于“教育目的”和“授权安全测试”。代码中`exploit_core.py`的核心功能是构造RAR文件头部、注入ADS和计算CRC32，这些都是技术上实现漏洞利用的必要步骤，而非恶意行为本身。它依赖于系统已安装的WinRAR CLI工具 (`rar.exe`) 来执行压缩操作，而不是内置恶意压缩逻辑。因此，该POC工具本身被注入恶意代码或隐藏后门的风险非常低。然而，由该工具生成的恶意RAR压缩包则具有极高的危害性，应谨慎处理和防范。

**项目地址:** 

**漏洞详情:** 
