## CVE-2025-8088 - WinRAR 目录遍历/路径遍历 (Path Traversal) 导致任意代码执行 (RCE)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径遍历 (Path Traversal) 导致任意代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 低于 7.13 版本的 WinRAR (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 需要用户交互 (受害者解压恶意RAR文件)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

WinRAR 目录遍历漏洞 (CVE-2025-8088) 是一个严重的客户端安全漏洞，影响了广泛使用的文件压缩与解压缩工具 WinRAR。该漏洞的根本原因在于WinRAR在处理特制压缩文件时，未能正确验证文件路径，从而允许攻击者构造恶意的RAR压缩包。当受害者解压此类恶意RAR文件时，攻击者可以利用目录遍历技术，将文件释放到系统上的任意位置，而非用户指定的目标路径。这种能力通常被用于将恶意可执行文件（例如`.exe`或`.bat`文件）放置到系统的关键位置，例如Windows的启动文件夹（`Startup`），从而在系统下次启动或用户登录时实现任意代码执行（RCE）和持久化。

该漏洞利用了NTFS备用数据流 (ADS) 特性来隐藏恶意载荷，并结合RAR5文件头操作来实现精确的路径穿越，例如使用`..\..\`序列来逃逸限制目录。根据多个威胁情报来源，该漏洞已被RomCom等APT组织广泛利用，表明其在实际攻击中具有高度的有效性和实用性，对个人和企业用户构成重大威胁。

**POC有效性分析：**
所提供的POC描述了一个名为“CVE-2025-8088 WinRAR Exploit Tool”的图形用户界面（GUI）工具，该工具旨在自动化创建利用此WinRAR路径遍历漏洞的恶意RAR档案。根据`README.md`文件，该工具具备“ADS隐身技术”（ADS Stealth Technology）来隐藏载荷、“文件头注入”（Header Injection）以实现精确的路径遍历、“自动持久化”（Auto-Persistence）以靶向Windows启动文件夹，并支持自定义诱饵文件。这些特性表明该工具实现了漏洞利用的核心机制，使其能够生成高度隐蔽且有效的恶意载荷。`exploit_core.py`的片段进一步证实了其实现细节，例如通过`subprocess`调用`rar.exe`命令行工具来创建RAR档案，以及通过Python代码对RAR文件结构进行底层操作（如`struct`和`zlib`库的使用）以注入恶意路径。明确的系统要求（Python 3.8+，WinRAR CLI，PyQt6）和详细的操作手册（包括选择载荷、诱饵、目标和输出）都表明这是一个功能完整、易于使用的利用工具。该工具将复杂的利用技术封装成简单的操作，显著降低了攻击者的技术门槛。鉴于其详细的功能描述、代码片段的吻合性以及对核心漏洞机制的利用，该POC被评估为高度有效且功能完备的“完整利用”工具。

**利用步骤：**
1.  **环境准备**：确保系统安装了Python 3.8+。通过`pip install PyQt6`安装所需的PyQt6模块。WinRAR命令行工具（`rar.exe`）需在系统PATH中或默认安装路径下。
2.  **启动工具**：运行`python gui.py`启动漏洞利用工具的图形界面。
3.  **载荷选择**：在工具界面中，选择预先准备好的恶意可执行文件（如`.exe`, `.bat`），这将是被植入目标系统的载荷。
4.  **诱饵设置（可选）**：选择一个无害的诱饵文件（如PDF、图片），用于伪装恶意RAR文件，增加欺骗性。
5.  **目标用户设定**：设置一个回退的用户名（默认：Administrator），以防动态`%USERNAME%`路径失效。
6.  **输出档案命名**：指定生成的恶意RAR档案的文件名（例如：`Confidential_Report.rar`）。
7.  **生成恶意档案**：点击“INITIATE EXPLOIT BUILD”按钮，工具将自动执行流注入、档案构建、文件头修补、CRC32校验和部署等步骤，生成一个恶意的WinRAR档案。
8.  **分发与诱骗**：攻击者将生成的恶意RAR档案通过钓鱼邮件、恶意网站下载等方式分发给受害者。
9.  **受害者操作**：当受害者使用存在漏洞的WinRAR版本解压该恶意档案时，载荷文件将通过路径遍历被放置到预设的任意位置（例如Windows启动目录），从而在后续系统启动时自动执行，实现任意代码执行。

**投毒风险分析：**
针对提供的POC代码（`README.md`和`exploit_core.py`），评估其投毒风险为低（5%）。该POC明确声明其用途是“教育目的”和“授权安全测试”，并强调作者不对其滥用负责。在代码层面，`exploit_core.py`片段展示了对Python标准库（`os`、`shutil`、`subprocess`、`struct`、`zlib`）的合法使用，主要功能是与外部的`rar.exe`命令行工具进行交互，以及对RAR文件结构进行底层的二进制操作，以实现漏洞利用逻辑。代码中没有发现任何恶意行为的迹象，例如代码混淆、植入后门、与未知外部C2服务器通信、下载或执行额外恶意载荷、窃取用户数据等。POC中提及的“PAYLOAD”是指攻击者自己准备并希望通过该工具嵌入到恶意RAR文件中的可执行文件，而不是POC工具本身包含的恶意载荷。因此，该POC代码本身是干净的，不具备投毒能力。防御性安全研究人员可以放心地分析和使用此POC来复现和理解CVE-2025-8088漏洞的原理和利用方式，而无需担心其自身被利用或包含恶意组件。风险主要集中在其作为一种攻击工具可能被滥用，而不是工具本身带有恶意意图或功能。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
