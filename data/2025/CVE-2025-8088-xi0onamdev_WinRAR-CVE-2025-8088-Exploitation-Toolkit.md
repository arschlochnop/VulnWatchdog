## CVE-2025-8088 - WinRAR 路径遍历/RCE

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/RCE

**影响应用:** WinRAR

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 7.12 及以下版本

**利用条件:** 用户下载并使用受影响版本的WinRAR解压特制的RAR文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了极高的有效性。其核心逻辑通过操作RAR5文件结构，特别是针对文件头部的路径字段进行篡改。它巧妙地利用了Windows NTFS备用数据流（ADS）特性，配合大量的‘..\\’路径跳转符，将恶意负载重定向到系统的‘启动’（Startup）目录。代码逻辑中包含了对RAR5签名（Rar!\x1A\x07\x01\x00）的校验、数据头（HFL_DATA）的修改以及CRC32循环冗余校验码的重新计算，这确保了生成的压缩包能被WinRAR正常识别而不报错，但在解压瞬间会将payload静默释放到高权限目录。此POC采用了PyQt6图形化界面，大幅降低了漏洞利用的门槛，使得非专业人员也能快速生成具有攻击性的压缩包。利用步骤：1. 准备攻击负载，如.exe或.bat文件。2. 运行poc.py或gui.py。3. 在界面中配置Payload路径、伪装用的Decoy文件以及目标系统的Fallback用户名（用于构建Startup路径）。4. 点击生成按钮，脚本将自动计算偏移量并修补RAR文件头。5. 将生成的RAR文件通过社交工程等方式发送给目标，一旦目标右键选择‘解压到当前文件夹’，payload即被写入启动目录。投毒风险分析：该POC代码库表现为中低度投毒风险。代码本身基于标准的Python库（os, struct, zlib, PyQt6）编写，逻辑清晰透明，未发现明显的代码混淆或远程下载额外后门的恶意行为。工具的开发者信息指向电报频道（@XiaoNamdev），这种公开身份的行为在一定程度上降低了后门隐藏的可能性。然而，值得警惕的是，由于该工具被冠以‘军事级’（military-grade）等煽动性文案，且其生成的RAR文件具有高度的隐蔽性和破坏力，极易被其他恶意软件开发者二次打包或嵌入真正的投毒代码后再次分发。对于安全研究人员，建议在隔离的沙箱环境中使用此类GUI工具，防止其在构建过程中通过未披露的旁路收集本地环境信息。虽然当前分析的版本未见恶意外部请求，但此类‘一键式’利用工具通常是黑灰产关注的重点，后续版本的供应链安全性存在不确定性。

**项目地址:** [https://github.com/walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
