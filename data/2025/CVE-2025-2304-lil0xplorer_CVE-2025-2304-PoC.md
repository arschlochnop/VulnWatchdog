## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Camaleon CMS

**危害等级:** 高危 (High)

**CVSS评分:** Not provided

**影响版本:** 低于 2.9.1 版本 (Versions prior to 2.9.1)

**利用条件:** 需要认证、需要网络访问、具备普通用户凭证 (Requires authentication, network access, and regular user credentials)

**POC 可用性:** 10

**POC 类型:** 完整利用 (Full exploit)

**攻击复杂度:** 中 (Medium)

**投毒风险:** 0%

## 详情

POC有效性分析：
提供的Proof-of-Concept (POC) 脚本 `exploit.py` 是高度有效且准确地演示了Camaleon CMS中的权限提升漏洞 (CVE-2025-2304)。此漏洞源于“大规模赋值（Mass Assignment）”缺陷，特别是在处理密码更改请求时 `UsersController` 的 `updated_ajax` 方法中。正如 `README.md` 中所述，核心问题在于使用了“危险的permit!”方法，该方法未能充分过滤传入的参数，从而允许攻击者注入任意字段。`exploit.py` 脚本利用这一点，通过向 `/admin/users/{user_id}/updated_ajax` 发送 `PATCH` 请求。该请求被精心构造，不仅包含合法的密码更新参数 (`password[password]`, `password[password_confirmation]`)，还包含一个非法注入的 `password[role]=admin` 参数。通过注入这个 `role` 参数，应用程序的大规模赋值机制对其进行处理，从而无意中将用户的角色更新为数据库中的“admin”。脚本细致地处理了利用所需的所有先决条件，包括通过使用提供的用户凭据登录来获取已认证的会话，以及从CMS的登录和配置文件页面提取动态CSRF令牌 (`authenticity_token` 和 `csrf-token`)。它还正确地从配置文件编辑页面解析了 `user_id`，这对于针对特定用户进行权限提升至关重要。脚本的成功执行，最终输出“[+] Exploited! You're admin now”，明确验证了漏洞以及POC从标准认证用户账户获得完全管理员权限的能力。这使得该POC成为演示漏洞的可靠而强大的工具。

利用步骤：
攻击者首先需要获得一个Camaleon CMS的普通用户账户凭证。然后，攻击者可以运行提供的Python POC脚本，指定目标URL、普通用户的用户名和密码。脚本将自动完成登录、获取用户ID和CSRF token，并构造恶意的更新请求。该请求通过“大规模赋值”漏洞，在更新用户密码的同时，注入`password[role]=admin`参数，从而将当前用户的角色提升为管理员。攻击成功后，脚本会输出“Exploited! You're admin now”，表明该普通用户账户已成功获得管理员权限。

投毒风险分析：
对提供的POC代码 (`exploit.py`) 进行的详细分析显示，该工具的投毒风险极低，评估为0%。代码结构清晰，易于阅读和理解。它仅使用了Python的标准库，包括`requests`（用于HTTP请求）、`argparse`（用于命令行参数解析）、`BeautifulSoup`（用于HTML解析）和`re`（用于正则表达式匹配）。这些都是安全领域常用的合法库，且在代码中以标准方式使用，没有发现任何可疑的外部依赖、混淆技术、恶意负载、后门代码、加密数据泄露、或者与未知服务器进行非预期通信的行为。脚本的主要目的是演示和利用Camaleon CMS中的权限提升漏洞，其行为完全符合漏洞描述和预期利用过程。因此，可以确定该POC代码是干净的，不包含任何恶意投毒成分，可以安全地用于合法的防御性安全研究和测试。

**项目地址:** 未提供公开POC项目地址 (No public POC repository URL provided)

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
