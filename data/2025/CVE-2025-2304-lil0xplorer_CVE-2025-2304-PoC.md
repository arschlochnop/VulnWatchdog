## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation), 质量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危：未经授权的用户（需先认证）可以通过利用质量赋值漏洞提升至管理员权限，从而完全控制受影响的CMS实例，导致数据泄露、篡改或服务中断。

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要已认证的低权限用户凭据；需要网络访问。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-2304 指出 Camaleon CMS 存在一个通过质量赋值导致的权限提升漏洞。该漏洞存在于 UsersController 的 `updated_ajax` 方法中。当用户尝试修改密码时，此方法会被调用。漏洞的关键在于使用了危险的 `permit!` 方法，该方法允许所有参数在未经充分过滤的情况下直接传递。这使得攻击者可以在密码更新请求中注入额外的参数，例如 `password[role]=admin`，从而将自身角色提升为管理员。

**POC有效性分析：**
提供的Python POC (`exploit.py`) 是一个功能完整且经过良好组织的脚本，旨在有效利用CVE-2025-2304。该脚本利用了Python的`requests`库进行HTTP通信，`BeautifulSoup`库用于解析HTML以提取关键的CSRF令牌，以及`re`库用于从页面内容中提取用户ID。脚本的执行流程清晰：首先，它模拟用户登录到CMS的管理员界面（`/admin/login`），成功获取`authenticity_token`（CSRF令牌）。登录后，脚本会访问用户的个人资料编辑页面（`/admin/profile/edit`），从该页面获取当前认证用户的ID和新的CSRF令牌。最后，脚本构造并发送一个PATCH请求（通过POST请求模拟`_method: patch`）到目标API端点`/admin/users/{user_id}/updated_ajax`。这个请求中包含了必要的`authenticity_token`、用户的当前密码以及最重要的恶意参数`password[role]=admin`。由于Camaleon CMS的`updated_ajax`方法未能正确过滤所有传入参数，它会将注入的`role`参数赋值给当前用户。脚本的输出，如“Exploited! You're admin now”，明确证实了攻击的成功，表明一个低权限的认证用户已成功将其权限提升至管理员级别。该代码结构清晰、易于理解，并且仅依赖于标准的Python库，安装要求简单（`pip install requests beautifulsoup4`），易于部署和验证。该POC完全实现了漏洞的利用，能够可靠地重现权限提升。

**项目地址:** Not available from provided data

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
