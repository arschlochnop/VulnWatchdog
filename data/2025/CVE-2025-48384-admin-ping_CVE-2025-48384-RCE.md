## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本范围未知，参考GitHub advisory

**利用条件:** 克隆包含恶意.gitmodules的仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-48384是一个存在于Git中的任意文件写入漏洞。攻击者可以创建一个包含恶意的`.gitmodules`文件的Git仓库，当用户克隆这个仓库时，Git会自动初始化并配置子模块。恶意`.gitmodules`文件可以被构造来写入任意文件，从而导致远程代码执行。该漏洞的POC代码可在GitHub上找到，由liamg维护。该POC的有效性在于利用了Git子模块的特性，`.gitmodules`文件中指定的路径没有被充分过滤，从而允许写入仓库目录之外的文件。利用步骤如下：

1. 攻击者创建一个包含恶意`.gitmodules`文件的Git仓库。
2. 攻击者诱导用户克隆该仓库。
3. 当用户克隆仓库时，Git会自动处理`.gitmodules`文件，并尝试初始化和配置子模块。
4. 由于`.gitmodules`文件包含恶意配置，Git会将文件写入到指定的位置，从而导致任意文件写入。
5. 写入的文件可以包含shell脚本或其他可执行代码，从而允许攻击者执行任意命令。

根据搜索结果，Git官方已经发布了补丁来修复此漏洞。建议受影响的用户尽快更新到最新版本。

**投毒风险分析：**
此POC的投毒风险中等。虽然POC本身的代码比较简单，主要是创建一个恶意`.gitmodules`文件和一个简单的shell脚本，但是`.gitmodules`文件的恶意构造方式可能被用于隐藏更复杂的恶意代码。例如，攻击者可以将`.gitmodules`文件配置为从远程服务器下载并执行恶意脚本，或者将恶意代码嵌入到看似无害的文件中。此外，由于该漏洞涉及到Git仓库的克隆操作，攻击者可以通过社会工程学手段诱导用户克隆恶意仓库，从而扩大攻击范围。该POC脚本创建了`/tmp/CVE-2025-48384`文件，表明了其利用目标系统的能力。虽然这个行为本身是良性的PoC验证，但攻击者可以轻易替换成更具破坏性的操作。因此，需要警惕利用此漏洞进行投毒攻击的可能性，并采取相应的防御措施，例如对`.gitmodules`文件进行严格的校验和过滤，以及加强对Git仓库来源的审查。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 待定
