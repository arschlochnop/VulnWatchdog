## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** 受影响版本范围未知

**利用条件:** 克隆包含恶意配置的Git仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 60%

## 详情

CVE-2025-48384 允许攻击者通过创建恶意的Git仓库，当用户克隆该仓库时，触发任意文件写入漏洞，导致远程代码执行。该漏洞源于 Git 在处理 submodule 时，没有充分验证配置，导致攻击者可以控制 `.gitmodules` 文件中的内容，从而在克隆过程中执行恶意操作。

POC代码分析：

`README.md` 只是一个简单的说明文件，用于标记这是一个 CVE-2025-48384 的 submodule。

`post-checkout` 脚本是漏洞利用的关键。它包含以下恶意行为：

1.  尝试将 `/etc/passwd` 文件发送到攻击者的 webhook 服务器 `https://cve48384.requestcatcher.com`。脚本尝试使用 `curl` 和 `wget` 命令，并忽略错误，以避免中断克隆过程。
2.  检查 `$HOME/flag.txt` 文件是否存在，如果存在，则将其内容复制到 `/tmp/flag.txt`。这可能用于在受害者系统上留下标记。
3.  尝试建立反向 shell 连接到攻击者的 IP 地址 `10.11.0.7` 的端口 `4444`。脚本尝试使用多种方法，包括 `bash`，`nc` 和 `sh`，以提高成功率。脚本使用 `nohup` 和 `disown` 命令将反向 shell 连接放到后台运行，并忽略错误。

利用步骤：

1.  攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件指向一个包含 `post-checkout` 脚本的 submodule。
2.  受害者克隆该恶意仓库。
3.  当 Git 初始化 submodule 时，会自动执行 `post-checkout` 脚本。
4.  `post-checkout` 脚本将执行恶意操作，例如发送 `/etc/passwd` 文件和建立反向 shell 连接。

POC 有效性分析：

POC 代码通过修改 `.gitmodules` 文件，在 submodule 初始化时执行恶意的 `post-checkout` 脚本。该脚本能够获取敏感信息（`/etc/passwd`）并尝试建立反向 shell 连接，证明了该漏洞的严重性。

投毒风险分析：

该 POC 具有较高的投毒风险，主要体现在以下几个方面：

1.  恶意脚本：`post-checkout` 脚本包含明显的恶意行为，例如发送敏感文件和建立反向 shell 连接。
2.  外部依赖：脚本依赖于 `curl`、`wget` 和 `nc` 等外部命令，这些命令可能被篡改或替换为恶意版本。
3.  反向 shell：建立反向 shell 连接可能导致受害者系统完全受攻击者控制。
4.  Webhook：将 `/etc/passwd` 文件发送到外部 webhook 服务器可能泄露敏感信息。

由于该POC利用submodule功能自动执行恶意脚本，且包含向外部服务器发送数据的行为，以及尝试建立反向shell连接，因此投毒风险较高。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 未提供
