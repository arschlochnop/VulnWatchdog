## CVE-2025-8088 - WinRAR 路径遍历/目录穿越/任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越/任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/8.4

**影响版本:** 未明确指出具体版本范围，但影响Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll。建议用户更新至最新版本以修复此漏洞。

**利用条件:** 需要用户解压特制恶意压缩包；不需认证；攻击者可构造并分发恶意压缩包；利用Windows NTFS备用数据流 (ADS)特性和RAR5头文件操作。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重路径遍历漏洞，攻击者可以通过构造恶意压缩包，利用Windows NTFS备用数据流 (ADS)特性和RAR5头文件操作技术，绕过WinRAR的文件验证机制。当用户解压此类特制压缩包时，WinRAR会错误地将恶意文件释放到系统上的任意位置，而非用户指定的解压目录。这通常导致恶意文件被植入到关键系统目录，如Windows启动文件夹，从而在系统重启或用户登录时实现任意代码执行，对系统安全构成严重威胁。该漏洞已被RomCom、UNC4895 (RomCom)、APT44、Turla等多个APT组织广泛利用，特别是在针对乌克兰军事及政府机构的攻击活动中，攻击者使用高度定制化的地缘政治相关诱饵进行钓鱼攻击。ESET安全研究人员也发现了该零日漏洞并进行了披露。

**POC有效性分析与利用步骤：**
提供的POC工具名为"Advanced WinRAR Path Traversal Exploit Tool"，是一个基于Python的、功能完善且带有图形用户界面（GUI）的漏洞利用生成器。该工具旨在自动化创建利用CVE-2025-8088的恶意RAR档案。
从代码结构和README描述来看，POC的有效性极高：
1.  **高级利用技术集成**：该工具利用了NTFS备用数据流（ADS）特性来隐藏有效载荷，并通过直接操作RAR5头文件来注入路径遍历字符串，这两种技术的结合使其能够有效绕过WinRAR的防御机制。
2.  **易用性**：GUI界面（由`gui.py`提供）极大地降低了攻击者的技术门槛。用户只需选择恶意可执行文件（payload）、可选的诱饵文件、指定输出的RAR文件名，即可一键生成恶意压缩包。
3.  **自动化目标定位**：工具具备"Startup Targeting"功能，能够自动将恶意载荷放置到Windows启动文件夹，例如`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`，确保持久化感染和任意代码执行。
4.  **核心逻辑健全**：`exploit_core.py`模块负责核心的漏洞利用逻辑，包括通过`subprocess`模块调用系统上安装的`rar.exe`命令行工具来创建基础RAR档案，识别RAR5的签名，精确修补RAR5头文件以嵌入路径遍历字符串，并在修补后重新计算并更新CRC校验码，使其看起来是合法的压缩包。
5.  **跨平台兼容性（部分）**：虽然WinRAR是Windows软件，但该Python工具本身可以在Python 3.6+环境下运行，且其核心逻辑（如RAR头文件操作）是平台独立的，仅依赖于WinRAR CLI的存在。

**利用步骤概括：**
1.  **环境准备**：攻击者需要在Linux/Windows/macOS系统上安装Python 3.6+及其依赖（`customtkinter`）以及Windows WinRAR CLI工具（`rar.exe`）。
2.  **启动工具**：运行`python gui.py`启动图形用户界面。
3.  **配置Payload**：选择一个恶意的可执行文件（例如后门程序、勒索软件等）作为payload。
4.  **配置诱饵文件**：为增加欺骗性，攻击者可选择一个正常的文件作为诱饵（如一份虚假文档）。
5.  **生成恶意档案**：输入输出RAR文件名，点击“Build”按钮。工具将自动化完成ADS创建、WinRAR CLI调用、RAR5头文件修补和CRC重计算，生成一个特制的恶意`.rar`文件。
6.  **投递与执行**：攻击者通过鱼叉式钓鱼、社交工程等方式将恶意`.rar`文件投递给受害者。当受害者解压该档案时，恶意payload会被植入到Windows启动目录。
7.  **持久化与RCE**：受害者下次开机或登录时，payload将自动执行，从而实现任意代码执行。

**投毒风险分析：**
对于本防御性安全研究而言，此POC代码的投毒风险评估为**低**，具体百分比为**10%**。评估依据如下：
1.  **代码透明度高**：提供的POC代码片段（`README.md`和`exploit_core.py`的开始部分）显示其结构清晰，使用了标准的Python库，没有明显的代码混淆、加密或其他试图隐藏真实意图的技术。核心逻辑如文件操作、子进程调用和二进制结构处理都直接可见。
2.  **功能目标明确**：该工具的唯一目的是生成利用WinRAR漏洞的恶意压缩包，而非在执行自身时对运行环境造成损害。它是一个“武器生成器”，而不是一个“武器”本身。
3.  **标准库依赖**：代码主要依赖`os`, `shutil`, `subprocess`, `struct`, `zlib`, `pathlib`等Python标准库。这些库的使用符合其描述的功能，没有发现调用异常的、不明来源的或网络外部的资源。
4.  **无外部可疑请求**：在提供的代码片段中，没有发现任何向外部C2服务器发起连接、下载额外恶意组件或执行可疑网络操作的代码。
5.  **明确的免责声明**：`README.md`中明确指出：“This tool is for **educational and authorized testing purposes only**.”以及“Use only in controlled environments with proper consent.”这表明了作者的意图并非用于非法活动，而是用于安全研究和测试。
6.  **作者身份可见**：作者提供了Telegram联系方式（`@tcixt`），增加了透明度。
尽管该工具的输出是恶意的，但工具本身在执行过程中不含恶意行为。因此，在防御性安全研究中分析此POC代码时，可以认为其自身的“投毒风险”较低，即该POC代码自身不会对研究人员的环境造成意外部署或感染。但需强调，其**生成物**的恶意性极高，因此在测试时必须在隔离且受控的环境中进行。

**项目地址:** 未提供公开仓库链接

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
