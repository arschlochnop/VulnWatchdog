## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户下载并尝试解压特制的恶意RAR压缩包，且运行环境支持NTFS备用数据流(ADS)。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC项目是一个功能完整的WinRAR路径遍历漏洞利用工具。CVE-2025-8088是由于WinRAR在处理包含NTFS备用数据流（ADS）的文件名时，未能正确过滤和校验路径序列，导致攻击者可以构造包含“..\”等遍历字符的文件路径。此POC代码通过Python编写，逻辑上分为三个核心步骤：首先，利用WinRAR命令行工具创建一个包含NTFS ADS的文件；其次，通过二进制模式打开生成的RAR5格式文件，直接操作RAR5文件头（Header）字段，将恶意的路径遍历字符串注入到文件名属性中；最后，重新计算并更新CRC32校验值以维持压缩包的完整性。从代码结构看，该工具使用了customtkinter构建GUI界面，提供了直观的载荷选择、诱饵文件设置以及自动指向Windows启动目录的功能。由于其直接针对RAR5文件头进行字节级修补，这种利用方式能够有效绕过早期仅针对传统文件名过滤的防护机制。该POC在Windows 10/11环境下配合WinRAR 7.12版本具有极高的成功率，能够稳定地将payload.exe释放到用户的启动目录（Startup），实现持久化攻击。【利用步骤】1. 攻击者准备攻击载荷（如exe或bat文件）；2. 使用该POC工具选择载荷文件并设置诱饵文件名；3. 工具自动计算路径遍历深度（默认针对AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup）；4. 点击Build生成恶意RAR压缩包；5. 诱导受害者右键点击该压缩包并选择‘解压到当前文件夹’或‘解压到指定文件夹’，文件将被静默写入系统启动目录。【投毒风险分析】该POC项目的投毒风险评估为低到中等（15%）。代码的主要逻辑集中在RAR文件头的处理和WinRAR命令行调用上，其依赖库包括customtkinter、struct和zlib，均为标准的Python GUI库或内置模块，未发现明显的外部恶意链接下载行为。代码中包含了一个指向Telegram（@tcixt）的联系方式，表明这可能是一个红队研究员发布的工具。风险点主要在于：第一，该工具本身就是一个高度武器化的Exploit生成器，极易被脚本小子直接用于发起真实攻击；第二，虽然目前的代码段未显示后门，但由于其提供了‘一键构建’功能，若发布者在二进制发行版或后续更新中植入恶意代码（如在生成的压缩包中额外添加指向发布者服务器的Payload），普通用户难以察觉。此外，POC中对‘Administrator’等硬编码路径的使用显示其具有明确的针对性。作为防御方，应重点监控文件系统中的‘:’号ADS文件生成行为以及WinRAR进程向敏感目录（如Startup、System32）写入文件的异常操作。

**项目地址:** [https://t.me/tcixt](https://t.me/tcixt) (项目源于vulnwatchdog监测到的临时目录)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
