## CVE-2025-32433 - Erlang/OTP SSH daemon RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE

**影响应用:** Erlang/OTP SSH daemon

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** 未知 (具体受影响的 Erlang/OTP 版本取决于内部 SSH 守护进程的实现)

**利用条件:** 受影响的系统必须开启了 Erlang/OTP 的 SSH 服务，且攻击者可以网络访问该端口，无需身份验证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-32433 是 Erlang/OTP SSH 守护程序中的一个严重漏洞，允许攻击者在未通过身份验证的情况下执行任意远程代码。根据 POC 有效性分析，该脚本通过模拟 SSH 协议握手流程，构造了特定的 SSH_MSG_KEXINIT 数据包来初始化连接，随后通过发送 SSH_MSG_CHANNEL_OPEN 和 SSH_MSG_CHANNEL_REQUEST 消息。其核心利用点在于在身份验证阶段（pre-auth）之前，错误地处理了 'exec' 类型的通道请求。POC 代码通过 `struct` 模块精确构造了符合 SSH 协议格式的二进制流，并在 `build_channel_request` 函数中植入了 Erlang 样式的命令执行负载 `os:cmd(...)`。由于 Erlang SSH 守护进程在某些版本中未能正确隔离未授权用户的通道请求权限，导致攻击者可以直接通过该协议漏洞绕过认证检查。利用步骤如下：1. 初始化 socket 连接到目标端口（默认 2222）。2. 发送符合规范的 SSH 版本横幅（Banner）。3. 执行密钥交换初始化（KEXINIT）。4. 申请开启一个 session 通道。5. 在未进行任何 USERAUTH 认证的情况下，直接发送一个执行请求，其中包含精心构造的恶意 OS 命令。该漏洞的威胁等级极高，因为其利用过程非常直接，无需任何先决条件，且一旦利用成功即可获得系统 shell 权限。POC 脚本中使用的 reverse shell 指令通过 mkfifo 和 nc 实现，是典型的渗透测试利用手法，能有效验证漏洞存在。投毒风险分析如下：该 POC 代码主要使用 Python 标准库（socket, struct, time），代码逻辑透明度高，未发现混淆处理。虽然 POC 中包含了一个反弹 shell 的 payload（指向 10.10.16.4），但这属于漏洞验证（Exploit）的正常组成部分，不应被视为对研究人员的投毒行为。脚本中没有发现额外的恶意文件下载、本地凭据窃取或针对运行者主机的破坏性逻辑。然而，作为防御性安全研究员，仍需注意 15% 的潜在风险，主要源于 POC 中包含硬编码的远程 IP 和端口，若在未审阅代码的情况下直接运行，可能导致非预期的流量外溢到攻击者控制的服务器。建议在受控的沙箱环境中修改 HOST 和负载后再进行测试，以确保安全性。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32433-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32433-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
