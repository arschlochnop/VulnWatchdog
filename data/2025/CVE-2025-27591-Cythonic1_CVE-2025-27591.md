## CVE-2025-27591 - Below (Facebook/Meta 开源的系统监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook/Meta 开源的系统监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 本地普通用户访问权限，系统安装有受影响版本的 Below 且具有 sudo 执行权限或错误配置的 setuid 权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-27591 是存在于 Facebook/Meta 开发的 Below 系统监控工具中的一个严重提权漏洞。该漏洞的根源在于 Below 服务在初始化日志目录 /var/log/below 时，错误地将其权限设置为全局可写（world-writable）。在 Linux 系统安全架构中，任何全局可写的关键系统目录都是极大的安全隐患，因为这允许低权限用户操纵其中的文件结构。

POC 有效性分析：所提供的 POC 代码展示了通过符号链接（Symbolic Link）攻击实现提权的经典路径。首先，利用代码通过 `unlink` 移除 /var/log/below/error_root.log（或利用目录的可写权限创建该文件），然后创建一个指向 /etc/passwd 的软链接。当 Below 进程（通常以 root 权限运行）尝试向该日志文件写入数据时，由于软链接的存在，写入操作实际上被重定向到了 /etc/passwd。POC 利用了 `below replay --time` 命令的一个特性，即该命令会将无法解析的输入（如精心构造的包含换行符和用户凭据的字符串）记录到错误日志中。通过这种方式，攻击者可以将一行符合 /etc/passwd 格式的 root 权限用户信息（例如 user:password_hash:0:0:root:/root:/bin/bash）注入到系统密码文件中。一旦注入成功，攻击者即可通过 `su` 或直接登录的方式切换到该伪造的 root 账号，从而获取系统的最高控制权。该 POC 逻辑严密，直接针对漏洞成因，具有极高的利用价值和成功率。

利用步骤如下：
1. 编译 exploit 代码，链接 libcrypt 以生成符合格式的加密密码哈希。
2. 运行 exploit 并指定要创建的伪造 root 用户名和密码。
3. 程序删除目标日志路径下的现有文件，创建指向 /etc/passwd 的符号链接。
4. 调用 `sudo below replay --time`，并将包含恶意用户条目的字符串作为参数传入。
5. Below 报错并将包含恶意字符串的内容写入日志（即 /etc/passwd）。
6. 验证 /etc/passwd 是否被污染，使用伪造用户登录提权。

投毒风险分析：该 POC 的投毒风险极低，约为 5%。分析其 main.c 代码可以发现，该工具使用了标准的 Linux 系统编程接口，如 `symlink`, `unlink`, `system` 以及 `crypt.h` 库。代码逻辑透明，完全符合漏洞利用验证的预期功能。编译指令中使用的 `-static` 和 `-lcrypt` 是为了确保在不同环境下运行的兼容性，并非为了隐藏恶意行为。主要的 `system()` 调用指向的是 `sudo below` 这一合法的目标程序。代码中没有发现任何网络外连行为（如反弹 Shell 到第三方服务器）、文件混淆或加密隐藏 payload 的迹象。README 中的指令清晰，对应的仓库地址为公开的安全研究项目。对于防御方而言，此类 POC 是测试系统加固效果的良性工具。唯一的风险点在于攻击者可能修改此类公开脚本添加后门，但就目前分析的源码而言，其安全性是可控的，主要用于合法的防御性安全研究和漏洞验证。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
