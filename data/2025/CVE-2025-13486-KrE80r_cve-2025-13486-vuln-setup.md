## CVE-2025-13486 - ACF Extended RCE

**漏洞编号:** CVE-2025-13486

**漏洞类型:** RCE

**影响应用:** ACF Extended

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 0.9.0.5 - 0.9.1.1

**利用条件:** Unauthenticated network access

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-13486是WordPress Advanced Custom Fields (ACF) Extended插件中的一个远程代码执行(RCE)漏洞，影响版本0.9.0.5到0.9.1.1。该漏洞源于`prepare_form()`函数，它接受用户输入并通过`call_user_func_array()`传递，允许未经身份验证的攻击者在服务器上执行任意代码。根据Tenable的描述，该漏洞允许攻击者注入恶意代码。

POC有效性分析：提供的POC由一个docker-compose环境，包含一个易受攻击的WordPress实例，以及使用Nuclei测试该漏洞的步骤。Dockerfile用于构建WordPress环境，docker-compose.yml编排了数据库和WordPress服务，并挂载了包含插件的目录。README.md提供了启动环境、下载所需插件（ACF Pro和ACF Extended 0.9.0.5）、提取nonce值以及使用curl命令进行RCE测试的详细说明。其中curl 命令通过向 `/wp-admin/admin-ajax.php` 发送POST请求，设置action为`acfe/form/render_form_ajax`，利用`form[render]`参数传递恶意代码，实现RCE。该POC的质量很高，因为它提供了一个完整的、可重复的环境和明确的利用步骤。

利用步骤：
1. 下载并安装Docker和Docker Compose。
2. 克隆包含Dockerfile、docker-compose.yml和相关脚本的POC代码仓库。
3. 运行`./download-plugins.sh`脚本下载ACF Pro和ACF Extended 0.9.0.5插件，或手动下载并将它们放置在`plugins/`目录下（如果脚本失败）。
4. 运行`docker-compose up -d --build`命令构建并启动环境。
5. 等待30秒左右，待环境设置完成后，使用Nuclei运行`nuclei -t CVE-2025-13486.yaml -u http://localhost:8888`进行漏洞验证，或手动提取nonce值并使用提供的curl命令执行RCE。
6. 使用`docker-compose down -v`命令清理环境。

投毒风险分析：该POC的投毒风险较低，为10%。Dockerfile使用官方wordpress镜像，没有明显的恶意行为。docker-compose.yml文件仅用于设置数据库和WordPress服务，没有包含任何可疑的配置。README.md中提供的利用步骤清晰，使用标准curl命令，没有包含混淆或恶意代码。唯一的风险点可能在于download-plugins.sh脚本，如果该脚本被篡改，可能会下载恶意版本的插件。然而，由于脚本本身比较简单，且用户可以手动下载插件，因此总体风险较低。此外，利用代码本质上是通过`call_user_func_array()`执行PHP代码，可能会被误判为后门。但是，该POC的目标是验证RCE漏洞，而非植入恶意后门。

**项目地址:** https://github.com/.../CVE-2025-13486

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-13486
