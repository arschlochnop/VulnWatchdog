## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE), 不安全反序列化

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE), 不安全反序列化

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025, Windows Server 2022, Windows Server 2019

**利用条件:** 无需认证, 远程网络可访问, 攻击复杂度低

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个针对微软Windows Server Update Services (WSUS)组件的高危远程代码执行(RCE)漏洞，CVSS评分为9.8。其根本原因是服务端在处理AuthorizationCookie时存在不安全的反序列化缺陷，具体涉及WSUS使用.NET的BinaryFormatter反序列化AuthorizationCookie中的数据。攻击者无需任何身份凭证，即可通过网络远程触发该漏洞，实现对目标服务器的完全控制。

**POC有效性分析**
提供的POC代码包含一个`README.md`文件和一个`exploit.cs`文件。`README.md`详细描述了漏洞的性质、利用方法和攻击流程。它明确指出漏洞利用GetCookie()端点，允许未经身份验证的攻击者以SYSTEM权限执行任意代码。攻击流程包括生成PowerShell反向Shell命令、使用`ysoserial.net`的`TypeConfuseDelegate` gadget进行序列化、使用固定密钥和随机盐进行AES-128-CBC加密、Base64编码，最后将编码后的payload嵌入SOAP请求的`AuthorizationCookie`字段并发送到目标的WSUS GetCookie端点。`exploit.cs`文件是一个C#控制台应用程序，实现了POC的客户端逻辑。它定义了固定的AES加密密钥（`AESKeyHex = "877C14E433638145AD21BD0C17393071"`），并包含处理加密、HTTP请求构建的函数（尽管POC代码在此处被截断，但从`README.md`的描述和已有的代码片段可以看出其意图）。通过结合`ysoserial.net`工具生成恶意反序列化数据，此POC能够构造并发送特制的SOAP请求，利用WSUS的不安全反序列化漏洞实现远程代码执行，从而在目标服务器上获取SYSTEM权限的反向Shell。POC的描述和代码结构清晰，利用链完整，具备高度的有效性。它直接针对漏洞核心机制，通过构造恶意序列化数据来绕过认证并执行任意代码，符合高危RCE漏洞的常见利用模式。

**利用步骤**
1.  **环境准备**: 确保攻击机上安装了Mono（用于编译C#代码）和Netcat（用于监听反向Shell）。
2.  **编译POC**: 使用Mono编译器编译`exploit.cs`文件，生成可执行程序。
3.  **启动监听器**: 在攻击机上使用Netcat启动监听，例如`nc -lvnp 4444`，等待目标服务器的反向Shell连接。
4.  **运行POC**: 执行编译好的POC程序。
5.  **输入参数**: 根据程序提示，输入目标WSUS服务器的URL、攻击机的IP地址（LIP）和监听端口（LPORT）。
6.  **触发漏洞**: POC程序将构造并发送包含恶意反序列化payload的SOAP请求到目标WSUS服务器。
7.  **获取Shell**: 如果利用成功，目标WSUS服务器将解密并反序列化payload，执行PowerShell反向Shell命令，从而连接到攻击机的监听器，授予攻击者SYSTEM权限的Shell。

**投毒风险分析**
对提供的POC代码`exploit.cs`和`README.md`文件进行分析后，评估其投毒风险为低 (10%)。`exploit.cs`是一个用C#编写的控制台应用程序，其主要功能是构造、加密并发送一个包含反向Shell payload的SOAP请求，以利用CVE-2025-59287漏洞。代码中明确定义了AES加密密钥和反向Shell的生成逻辑。其核心目的是执行远程代码，因此它会生成并尝试执行一个PowerShell反向Shell命令，这是漏洞利用的预期行为，而非POC代码本身的恶意投毒。代码结构清晰，没有发现混淆、隐藏的恶意功能、对外部不明链接的隐秘调用、或者包含除标准库以外的可疑第三方依赖。POC的`README.md`也明确指出其用途是生成反向Shell，并且强调了“MAKE SURE YOU HAVE WRITTEN authorization before testing exploits like this. Use responsibly and legally!”，这表明其开发者意图是用于合法的安全测试。虽然该POC利用反序列化机制，并涉及加密/编码，但这都是为了成功利用目标漏洞所需的技术步骤，不应将其误判为POC代码本身的投毒行为。POC代码本身没有迹象表明会执行超出其漏洞利用目的之外的任何恶意操作，例如感染攻击者的机器、泄露攻击者信息或进行其他未经授权的行为。因此，其作为防御性安全研究工具的纯洁性较高，投毒风险较低。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
