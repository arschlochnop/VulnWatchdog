# CVE-2025-24016

> 📦 该CVE有 **8** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Wazuh

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能通过被入侵的dashboard、Wazuh集群服务器或配置不当的agent），以及目标Wazuh服务器监听在网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Wazuh服务器的DistributedAPI组件中，由于对JSON反序列化数据处理不当，攻击者可以通过发送特制的DAPI请求，在服务器上执行任意代码。利用方式如下：

1.  **漏洞原理：**  Wazuh服务器使用`as_wazuh_object`函数反序列化DAPI请求中的JSON数据。攻击者可以构造包含`__unhandled_exc__`键的恶意JSON，该键的值包含一个类名（如`os.system`）和相应的参数，从而触发任意代码执行。
2.  **利用步骤：**
    *   获取API访问权限（例如，通过Wazuh dashboard或集群中的其他服务器）。
    *   构造恶意的JSON payload，利用`__unhandled_exc__`执行反向shell命令，连接到攻击者的IP地址和端口。
    *   将payload作为DAPI请求发送到Wazuh服务器。
    *   在攻击者的机器上监听指定端口，接收反向shell。
3.  **POC代码分析：**  提供的POC代码是一个Python脚本，它接受目标URL、攻击者IP地址和端口作为参数，并生成包含恶意payload的DAPI请求。该脚本使用`requests`库发送POST请求，并使用`HTTPBasicAuth`进行身份验证。payload中的`__unhandled_exc__`被设置为执行反向shell的命令。
4.  **投毒风险分析：**  POC代码本身逻辑较为简单，主要用于利用漏洞。潜在的投毒风险可能存在于以下几个方面：
    *   **依赖项：**  检查`requirements.txt`或`setup.py`等文件，确保没有引入恶意依赖项。
    *   **混淆代码：**  查看代码中是否存在混淆或隐藏的恶意代码。
    *   **网络请求：**  监控代码是否尝试连接到未知的外部服务器。
    *   **反向shell：** 虽然反向shell是PoC的一部分，但恶意版本可能会试图下载payload或执行其他未经授权的操作。代码中存在明显的反向shell创建逻辑，因此这部分代码并非隐藏的投毒。
    *   **信息收集：**  代码可能包含收集目标系统信息的行为，例如用户名、操作系统版本等，并将其发送给攻击者。当前代码收集信息行为并不明显，但要仔细检查与系统交互的部分。

  综合评估，该POC代码的投毒风险较低（约10%），主要是因为其功能相对直接，但仍需要谨慎审查代码和相关依赖项，以确保其安全性。要特别注意payload中命令执行的参数，是否存在编码或格式化问题，导致其他恶意代码被注入。

**项目地址:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**来源**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-反序列化RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞

**影响应用:** Wazuh

**危害等级:** 高危，可导致远程代码执行

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能通过被入侵的dashboard、集群中的Wazuh服务器或特定配置下的被入侵的Agent获得）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24016 是 Wazuh 服务器中的一个远程代码执行 (RCE) 漏洞，源于不安全的反序列化。攻击者可以利用 `DistributedAPI` 的参数反序列化过程，通过注入恶意的 JSON 数据，在服务器上执行任意代码。

**有效性分析：**

根据提供的漏洞信息和PoC代码，该漏洞利用是有效的。PoC通过向 `/security/user/authenticate/run_as` 端点发送包含 `__unhandled_exc__` 字段的恶意JSON payload，触发了反序列化漏洞，进而执行了代码。PoC代码清晰地展示了攻击向量和触发条件，可以复现。

**投毒风险分析：**

PoC代码中主要包含一个 README.md 文件和一个rce.png文件。README.md 文件详细描述了漏洞原理、影响版本、PoC利用方法和缓解措施。代码较为简洁，目的明确，旨在展示和验证漏洞。rce.png 是 Burp Suite 的截图，作为PoC的辅助说明。作者隐藏恶意代码的可能性较低，但仍不能完全排除。由于缺乏更深入的代码分析，假设存在很小的可能作者隐藏了例如通过图片隐写术将后门代码隐藏在rce.png图片中，故投毒风险为5%。

**利用方式：**

1.  **漏洞位置：** `framework/wazuh/core/cluster/common.py` 中的 `as_wazuh_object` 函数。
2.  **攻击向量：** 通过构造恶意的 `DistributedAPI` 请求，将包含特殊键 `__unhandled_exc__` 的 JSON 数据发送到服务器。
3.  **触发点：** `run_as` 接口，利用 `auth_context` 参数。
4.  **利用流程：**
    *   攻击者首先获取 Wazuh API 的访问权限（通过被入侵的 dashboard、集群中的 Wazuh 服务器或特定配置下的被入侵的 Agent）。
    *   攻击者构造包含恶意 JSON payload 的 HTTP POST 请求，发送到 `/security/user/authenticate/run_as` 端点。
    *   Wazuh 服务器在反序列化 JSON 数据时，由于不安全的反序列化操作，导致 `__unhandled_exc__` 字段中的代码被执行。
    *   攻击者可以利用此漏洞执行任意代码，例如，PoC 中使用了 `exit()` 函数导致服务器退出。
5.  **修复方案：** 升级到 Wazuh 4.9.1 或更高版本，该版本已修复此漏洞。

**项目地址:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #3

**来源**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可导致远程代码执行，完全控制系统

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限 (可能通过被攻陷的dashboard, 集群中的Wazuh服务器, 或者特定配置下被攻陷的agent)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24016是Wazuh服务器中的一个反序列化漏洞，允许远程攻击者执行任意代码。漏洞位于`DistributedAPI`组件中，该组件使用JSON序列化和`as_wazuh_object`反序列化DAPI请求参数。如果攻击者能够注入恶意构造的字典到DAPI请求中，他们可以构造一个未处理的异常(`__unhandled_exc__`)来执行任意Python代码。此漏洞CVSS评分为9.9，影响Wazuh 4.4.0到4.9.0版本。

**有效性:** 提供的PoC代码有效。它利用了`run_as`端点，允许攻击者通过控制`auth_context`参数来注入恶意payload。Payload中包含`__unhandled_exc__`，导致服务器执行任意Python代码。

**投毒风险:** PoC代码本身旨在演示漏洞，但存在一定的投毒风险。攻击者可能修改PoC代码，例如替换`exit()`为更具破坏性的命令，比如删除文件或执行恶意脚本。但从目前分析结果看，该仓库结构简单，代码量少，没有发现明显的恶意代码隐藏。因此，PoC存储库本身直接包含恶意代码的可能性较低，投毒风险约为10%，主要风险在于使用者是否会对POC进行修改。

**利用方式:**
1.  攻击者需要获得Wazuh API的访问权限。这可以通过以下方式实现：
    *   攻陷Wazuh dashboard。
    *   控制Wazuh集群中的一个服务器。
    *   在某些配置中，攻陷一个Wazuh agent。
2.  攻击者构造一个包含恶意payload的HTTP POST请求，发送到`/security/user/authenticate/run_as`端点。Payload中包含`__unhandled_exc__`，`__class__`设置为需要执行的函数(例如`exit`或`os.system`)，`__args__`设置为函数的参数。
3.  Wazuh服务器反序列化payload，并执行其中包含的Python代码，从而导致RCE。

**项目地址:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**来源**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可导致系统完全控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能是通过受损的Dashboard或集群中的Wazuh服务器），某些配置下可能被受损的Agent利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24016 是一个存在于 Wazuh 服务器中的远程代码执行漏洞，由不安全的反序列化引起。攻击者可以利用此漏洞在受影响的 Wazuh 服务器上执行任意代码。

**有效性：**

提供的 POC 代码似乎有效。根据漏洞描述， DistributedAPI 参数以 JSON 格式序列化，并使用 `as_wazuh_object` 反序列化。如果攻击者能够在 DAPI 请求/响应中注入未经消毒的字典，他们可以伪造一个未处理的异常 (`__unhandled_exc__`) 来评估任意 Python 代码。提供的 POC 代码正是利用了这一点，通过 `__unhandled_exc__` 注入 `os.system` 函数，从而执行任意命令。

**投毒风险：**

检查提供的 Python 脚本 `exploit_wazuh.py` 和 `requirements.txt`，没有发现明显的恶意代码或后门。该脚本的功能明确，即利用 Wazuh 的反序列化漏洞执行命令。代码中没有发现任何试图连接外部服务器、收集敏感信息或执行其他可疑操作的迹象。
 `requirements.txt` 文件包含 `requests` 和 `urllib3` 库，这些都是常见的 Python 库，用于发送 HTTP 请求，没有可疑之处. 因此，可以认为该仓库存在投毒代码的风险为 0%。

**利用方式：**

1.  **漏洞点：** `framework/wazuh/core/cluster/common.py` 中的 `as_wazuh_object` 函数在处理 DistributedAPI 参数时存在不安全的反序列化。
2.  **攻击方法：** 攻击者需要首先获得 Wazuh API 的访问权限，这可以通过多种方式实现，例如攻击 Wazuh Dashboard，或者控制集群中的一台 Wazuh 服务器。在某些情况下，甚至受损的 Agent 也可以触发该漏洞。
3.  **利用过程：** 攻击者构造一个包含恶意 `__unhandled_exc__` 键的 JSON 负载，该键的值为一个包含 `__class__` 和 `__args__` 键的字典。`__class__` 键指定要执行的 Python 函数，`__args__` 键指定传递给该函数的参数。在本例中，`__class__` 被设置为 `os.system`，`__args__` 被设置为要执行的命令。
4.  **发送请求：** 攻击者将此恶意负载作为 DAPI 请求发送到 Wazuh 服务器。服务器在反序列化该负载时，会触发 `__unhandled_exc__` 异常，并执行攻击者指定的命令。

总而言之，此漏洞利用的有效性高，攻击难度适中，危害性极大，需要尽快修复。

**项目地址:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**来源**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能通过被攻陷的dashboard、集群节点或特定配置下的Agent）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24016是Wazuh服务器中存在的一个远程代码执行漏洞，源于不安全的反序列化。攻击者可以通过构造恶意的JSON数据，利用DistributedAPI接口中的`as_wazuh_object`函数在反序列化过程中执行任意Python代码。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用是有效的。POC代码通过向`/security/user/authenticate/run_as`端点发送包含恶意`__reduce__`的JSON payload，在服务器端执行`os.system`命令，从而实现远程代码执行。

**投毒风险分析：**

虽然POC代码本身是为了验证漏洞，但查看提供的代码，`CVE-2025-24016-POC.py`脚本并没有明显的恶意代码或后门。风险在于攻击者可能修改POC，使其在目标系统上安装后门或执行其他恶意操作。此外，README中给出的Burp Suite请求示例中，虽然`__unhandled_exc__`示例会导致Wazuh服务器关闭，形成拒绝服务，但它本身不是一个隐蔽的后门。

LICENSE采用MIT许可证，允许修改和分发，但也增加了潜在的投毒风险。攻击者可以修改代码并重新发布，使其包含恶意功能。因此，初步判断投毒风险为10%。

**利用方式分析：**

1.  **攻击入口：** 攻击者需要具备Wazuh API的访问权限。这可能通过以下方式获得：
    *   攻陷Wazuh dashboard。
    *   攻陷Wazuh集群中的其他节点。
    *   在某些配置下，攻陷Wazuh Agent。
2.  **漏洞触发：** 攻击者构造恶意的JSON payload，其中包含`__reduce__`或其他可触发代码执行的反序列化gadget。
3.  **利用过程：** 攻击者将payload发送到Wazuh API的`/security/user/authenticate/run_as`端点，触发反序列化过程。
4.  **代码执行：** Wazuh服务器在反序列化payload时，会执行攻击者指定的Python代码，从而实现远程代码执行。
5.  **影响：** 攻击者可以利用该漏洞执行任意系统命令，获取敏感信息，安装后门，甚至完全控制Wazuh服务器。

**缓解措施：**

*   升级到Wazuh v4.9.1或更高版本。
*   避免将API暴露在公网上。
*   监控API的异常活动。

**项目地址:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**来源**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限 (可能通过弱口令，集群内部攻击或受损的agent)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于Wazuh服务器在处理DistributedAPI请求时，使用了不安全的JSON反序列化`as_wazuh_object`函数，导致攻击者可以注入恶意Python代码。攻击者通过构造包含`__unhandled_exc__`字段的恶意JSON数据，该字段指向`os.system`类，从而执行任意系统命令。POC代码通过构造这样的payload，利用bash反弹shell到攻击者指定的IP地址和端口。 

**利用方式：**

1.  攻击者需要拥有Wazuh API的访问权限。 这可能通过多种方式实现：
    *   爆破或利用默认弱口令
    *   如果Wazuh服务器在集群环境中，攻击者可能控制了集群中的其他服务器，并通过集群内部网络进行攻击。
    *   攻击者可能通过入侵Wazuh Agent，并使用Agent连接到服务器。
2.  攻击者构造包含恶意`__unhandled_exc__`的JSON数据，并将其作为DAPI请求发送到Wazuh服务器的API端点（例如`/security/user/authenticate/run_as`）。
3.  服务器在反序列化JSON数据时，会调用`os.system`执行攻击者提供的bash命令，反弹shell到攻击者。

**投毒风险分析：**

代码存在一定投毒风险，主要是因为以下几点：

1.  **自定义Header:** POC中存在`X-Header-Name: Custom-Header`，虽然目前没有实际危害，但可能被用于后续投毒利用，例如配合中间人攻击。
2.  **Proxy配置:** 存在使用代理的选项，可能诱导用户配置恶意代理，从而窃取凭据或者植入恶意代码。
3.  **配置文件读取:**  虽然POC里没有使用config-file，但如果允许用户自定义配置文件，可能存在读取恶意配置文件的风险。
4.  **代码结构复杂性:** 代码为了增加易读性和可配置性，引入了一些函数和参数，这会增加代码的复杂性，可能隐藏恶意逻辑。

总的来说，POC主要目的是演示漏洞，但存在一些可以被利用进行恶意行为的潜在风险，但相对较低。风险点主要集中在用户配置和自定义header上。


**项目地址:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**来源**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-反序列化RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化RCE

**影响应用:** Wazuh

**危害等级:** 高危，可导致远程代码执行，完全系统控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问（可能需要较低权限），某些配置下agent可触发

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24016是Wazuh服务器中的一个反序列化远程代码执行漏洞。攻击者可以通过向 DistributedAPI 发送特制的JSON请求，利用 `as_wazuh_object` 函数中的不安全反序列化机制，执行任意Python代码。POC代码通过构造包含 `__unhandled_exc__` 字段的JSON数据，并设置一个不存在的类`NotARealClass`，触发`NameError`，如果服务器返回500状态码且body中包含"NameError"，则表明存在漏洞。尽管该POC旨在检测漏洞而非利用，但如果将`NotARealClass`替换为可以利用的反序列化gadget，则可实现RCE。投毒风险较低，主要集中在作者在其他地方公布了恶意利用方式的可能性，或者未来修改模板增加恶意代码，因此投毒风险评估为5%。漏洞利用方式为：

1.  **攻击者** 需要能够访问Wazuh API，可能是通过Web界面、集群中的其他服务器，或者在特定配置下甚至是受损的agent。
2.  **攻击者** 构造包含恶意序列化数据的JSON请求，将其发送到 DistributedAPI。
3.  **Wazuh服务器** 使用 `as_wazuh_object` 反序列化JSON数据。
4.  **攻击者注入的恶意对象** 被实例化，导致执行任意Python代码。

**项目地址:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**来源**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-反序列化RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** >= 4.4.0, < 4.9.1

**利用条件:** 需要API访问权限（可能通过控制面板、集群中的Wazuh服务器或受损的代理实现）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24016 是一个存在于 Wazuh 服务器中的反序列化远程代码执行漏洞。该漏洞影响 Wazuh 4.4.0 到 4.9.0 版本。由于 DistributedAPI 组件中存在不安全的反序列化缺陷，攻击者可以通过注入恶意构造的 JSON 数据，利用 `as_wazuh_object` 函数执行任意 Python 代码。根据搜索引擎结果，此漏洞已被 Mirai 僵尸网络利用，进行 DDoS 攻击和感染 IoT 设备。提供的 Nuclei 模板通过检查 Wazuh Web 界面的版本来检测是否存在此漏洞。检测逻辑为通过正则匹配页面中的wazuhVersion，同时需要满足页面返回200状态码并且body中包含`<title>Wazuh</title>` 和 `wazuhVersion`。如果版本在 4.4.0 和 4.9.0 之间，则判定为存在漏洞。投毒风险分析：提供的Nuclei模板主要用于漏洞检测，而非漏洞利用。该模板仅通过发送HTTP GET请求并分析响应来判断目标系统是否存在漏洞，不会主动执行恶意代码。考虑到作者可能会在域名检测规则中加入恶意域名，或者在版本检测规则中加入陷阱，因此存在极低的投毒风险，大约1%。利用方式：攻击者需要首先获得 Wazuh API 的访问权限，然后发送包含恶意序列化数据的请求，触发 `__unhandled_exc__` 异常，从而执行任意 Python 代码。攻击途径可能包括：
1.  **攻击控制面板：**如果攻击者可以访问或控制 Wazuh 控制面板，他们就可以通过 API 发送恶意请求。
2.  **攻击集群中的 Wazuh 服务器：**如果攻击者控制了集群中的一台 Wazuh 服务器，他们就可以利用该服务器向其他服务器发送恶意请求。
3.  **攻击受损的代理：**在某些配置中，受损的代理也可以被用来触发此漏洞。
成功利用此漏洞可能导致攻击者完全控制受影响的 Wazuh 服务器。

**项目地址:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

