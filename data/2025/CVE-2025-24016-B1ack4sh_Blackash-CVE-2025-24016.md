# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

# CVE-2025-24016

> ðŸ“¦ è¯¥CVEæœ‰ **9** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-24016-0xjessie21_CVE-2025-24016.md](../2025/CVE-2025-24016-0xjessie21_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** ä¸¥é‡ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€Wazuhé›†ç¾¤æœåŠ¡å™¨æˆ–é…ç½®ä¸å½“çš„agentï¼‰ï¼Œä»¥åŠç›®æ ‡WazuhæœåŠ¡å™¨ç›‘å¬åœ¨ç½‘ç»œç«¯å£ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žå­˜åœ¨äºŽWazuhæœåŠ¡å™¨çš„DistributedAPIç»„ä»¶ä¸­ï¼Œç”±äºŽå¯¹JSONååºåˆ—åŒ–æ•°æ®å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„DAPIè¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´žåŽŸç†ï¼š**  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`å‡½æ•°ååºåˆ—åŒ–DAPIè¯·æ±‚ä¸­çš„JSONæ•°æ®ã€‚æ”»å‡»è€…å¯ä»¥æž„é€ åŒ…å«`__unhandled_exc__`é”®çš„æ¶æ„JSONï¼Œè¯¥é”®çš„å€¼åŒ…å«ä¸€ä¸ªç±»åï¼ˆå¦‚`os.system`ï¼‰å’Œç›¸åº”çš„å‚æ•°ï¼Œä»Žè€Œè§¦å‘ä»»æ„ä»£ç æ‰§è¡Œã€‚
2.  **åˆ©ç”¨æ­¥éª¤ï¼š**
    *   èŽ·å–APIè®¿é—®æƒé™ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡Wazuh dashboardæˆ–é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼‰ã€‚
    *   æž„é€ æ¶æ„çš„JSON payloadï¼Œåˆ©ç”¨`__unhandled_exc__`æ‰§è¡Œåå‘shellå‘½ä»¤ï¼Œè¿žæŽ¥åˆ°æ”»å‡»è€…çš„IPåœ°å€å’Œç«¯å£ã€‚
    *   å°†payloadä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨ã€‚
    *   åœ¨æ”»å‡»è€…çš„æœºå™¨ä¸Šç›‘å¬æŒ‡å®šç«¯å£ï¼ŒæŽ¥æ”¶åå‘shellã€‚
3.  **POCä»£ç åˆ†æžï¼š**  æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒæŽ¥å—ç›®æ ‡URLã€æ”»å‡»è€…IPåœ°å€å’Œç«¯å£ä½œä¸ºå‚æ•°ï¼Œå¹¶ç”ŸæˆåŒ…å«æ¶æ„payloadçš„DAPIè¯·æ±‚ã€‚è¯¥è„šæœ¬ä½¿ç”¨`requests`åº“å‘é€POSTè¯·æ±‚ï¼Œå¹¶ä½¿ç”¨`HTTPBasicAuth`è¿›è¡Œèº«ä»½éªŒè¯ã€‚payloadä¸­çš„`__unhandled_exc__`è¢«è®¾ç½®ä¸ºæ‰§è¡Œåå‘shellçš„å‘½ä»¤ã€‚
4.  **æŠ•æ¯’é£Žé™©åˆ†æžï¼š**  POCä»£ç æœ¬èº«é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºŽåˆ©ç”¨æ¼æ´žã€‚æ½œåœ¨çš„æŠ•æ¯’é£Žé™©å¯èƒ½å­˜åœ¨äºŽä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
    *   **ä¾èµ–é¡¹ï¼š**  æ£€æŸ¥`requirements.txt`æˆ–`setup.py`ç­‰æ–‡ä»¶ï¼Œç¡®ä¿æ²¡æœ‰å¼•å…¥æ¶æ„ä¾èµ–é¡¹ã€‚
    *   **æ··æ·†ä»£ç ï¼š**  æŸ¥çœ‹ä»£ç ä¸­æ˜¯å¦å­˜åœ¨æ··æ·†æˆ–éšè—çš„æ¶æ„ä»£ç ã€‚
    *   **ç½‘ç»œè¯·æ±‚ï¼š**  ç›‘æŽ§ä»£ç æ˜¯å¦å°è¯•è¿žæŽ¥åˆ°æœªçŸ¥çš„å¤–éƒ¨æœåŠ¡å™¨ã€‚
    *   **åå‘shellï¼š** è™½ç„¶åå‘shellæ˜¯PoCçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ¶æ„ç‰ˆæœ¬å¯èƒ½ä¼šè¯•å›¾ä¸‹è½½payloadæˆ–æ‰§è¡Œå…¶ä»–æœªç»æŽˆæƒçš„æ“ä½œã€‚ä»£ç ä¸­å­˜åœ¨æ˜Žæ˜¾çš„åå‘shellåˆ›å»ºé€»è¾‘ï¼Œå› æ­¤è¿™éƒ¨åˆ†ä»£ç å¹¶éžéšè—çš„æŠ•æ¯’ã€‚
    *   **ä¿¡æ¯æ”¶é›†ï¼š**  ä»£ç å¯èƒ½åŒ…å«æ”¶é›†ç›®æ ‡ç³»ç»Ÿä¿¡æ¯çš„è¡Œä¸ºï¼Œä¾‹å¦‚ç”¨æˆ·åã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ç­‰ï¼Œå¹¶å°†å…¶å‘é€ç»™æ”»å‡»è€…ã€‚å½“å‰ä»£ç æ”¶é›†ä¿¡æ¯è¡Œä¸ºå¹¶ä¸æ˜Žæ˜¾ï¼Œä½†è¦ä»”ç»†æ£€æŸ¥ä¸Žç³»ç»Ÿäº¤äº’çš„éƒ¨åˆ†ã€‚

  ç»¼åˆè¯„ä¼°ï¼Œè¯¥POCä»£ç çš„æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼ˆçº¦10%ï¼‰ï¼Œä¸»è¦æ˜¯å› ä¸ºå…¶åŠŸèƒ½ç›¸å¯¹ç›´æŽ¥ï¼Œä½†ä»éœ€è¦è°¨æ…Žå®¡æŸ¥ä»£ç å’Œç›¸å…³ä¾èµ–é¡¹ï¼Œä»¥ç¡®ä¿å…¶å®‰å…¨æ€§ã€‚è¦ç‰¹åˆ«æ³¨æ„payloadä¸­å‘½ä»¤æ‰§è¡Œçš„å‚æ•°ï¼Œæ˜¯å¦å­˜åœ¨ç¼–ç æˆ–æ ¼å¼åŒ–é—®é¢˜ï¼Œå¯¼è‡´å…¶ä»–æ¶æ„ä»£ç è¢«æ³¨å…¥ã€‚

**é¡¹ç›®åœ°å€:** [0xjessie21/CVE-2025-24016](https://github.com/0xjessie21/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #2

**æ¥æº**: [CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md](../2025/CVE-2025-24016-B1ack4sh_Blackash-CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** 4.4.0 <= version < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ¥è‡ªå—æŸçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼Œç”šè‡³æŸäº›é…ç½®ä¸‹çš„å—æŸAgentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä¿¡æ¯ä¸è¶³ä»¥éªŒè¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå½±å“ç‰ˆæœ¬4.4.0åˆ°4.9.0ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚è¯¥æ¼æ´žå­˜åœ¨äºŽDistributedAPIç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨`as_wazuh_object`ååºåˆ—åŒ–JSONæ•°æ®ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚/å“åº”ä¸­ï¼Œåˆ™å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´žåº“ä¿¡æ¯å’Œæœç´¢ç»“æžœï¼Œè¯¥æ¼æ´žæ˜¯çœŸå®žå­˜åœ¨çš„ï¼Œå¹¶ä¸”è¢«å¹¿æ³›å…³æ³¨ã€‚CISAçš„Known Exploited Vulnerabilities Catalogä¹Ÿæ”¶å½•äº†è¯¥æ¼æ´žã€‚ç„¶è€Œï¼Œæä¾›çš„POCä»£ç ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åªæä¾›äº†æ¼æ´žIDï¼Œæ²¡æœ‰ä»»ä½•å®žé™…çš„åˆ©ç”¨ä»£ç ã€‚å› æ­¤ï¼Œä»…å‡­æ­¤POCä»£ç æ— æ³•éªŒè¯æ¼æ´žçš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**
ç”±äºŽæä¾›çš„POCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ²¡æœ‰å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤å‡ ä¹Žä¸å­˜åœ¨æŠ•æ¯’é£Žé™©ã€‚å¯ä»¥åˆ¤å®šæŠ•æ¯’æ¦‚çŽ‡æžä½Ž,ä¸º1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´žåº“ä¿¡æ¯å’Œæœç´¢ç»“æžœï¼Œæ¼æ´žçš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  æ”»å‡»è€…éœ€è¦å…·æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡»å—æŸçš„Wazuh dashboardï¼ŒæŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„å¦ä¸€å°æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨æŸäº›é…ç½®ä¸‹ï¼ŒæŽ§åˆ¶å—æŸçš„Agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„å­—å…¸çš„DAPIè¯·æ±‚æˆ–å“åº”ã€‚
3.  æ”»å‡»è€…é€šè¿‡APIå‘é€è¯¥æ¶æ„è¯·æ±‚/å“åº”åˆ°WazuhæœåŠ¡å™¨ã€‚
4.  WazuhæœåŠ¡å™¨ä½¿ç”¨`as_wazuh_object`ååºåˆ—åŒ–è¯¥JSONæ•°æ®ã€‚
5.  æ¶æ„å­—å…¸ä¸­çš„ç‰¹å®šå­—æ®µï¼ˆ`__unhandled_exc__`ï¼‰è¢«è§¦å‘ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œæ”»å‡»è€…æ³¨å…¥çš„ä»»æ„Pythonä»£ç ã€‚

**ä¿®å¤å»ºè®®ï¼š**
å»ºè®®å°½å¿«å‡çº§åˆ°Wazuh 4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-24016](https://github.com/B1ack4sh/Blackash-CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---



---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---



---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---



---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---



---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---



---

## POC #3

**æ¥æº**: [CVE-2025-24016-GloStarRx1_CVE-2025-24016.md](../2025/CVE-2025-24016-GloStarRx1_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´ž

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«å…¥ä¾µçš„dashboardã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„AgentèŽ·å¾—ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ Wazuh æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œ (RCE) æ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ `DistributedAPI` çš„å‚æ•°ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡æ³¨å…¥æ¶æ„çš„ JSON æ•°æ®ï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æä¾›çš„æ¼æ´žä¿¡æ¯å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚PoCé€šè¿‡å‘ `/security/user/authenticate/run_as` ç«¯ç‚¹å‘é€åŒ…å« `__unhandled_exc__` å­—æ®µçš„æ¶æ„JSON payloadï¼Œè§¦å‘äº†ååºåˆ—åŒ–æ¼æ´žï¼Œè¿›è€Œæ‰§è¡Œäº†ä»£ç ã€‚PoCä»£ç æ¸…æ™°åœ°å±•ç¤ºäº†æ”»å‡»å‘é‡å’Œè§¦å‘æ¡ä»¶ï¼Œå¯ä»¥å¤çŽ°ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

PoCä»£ç ä¸­ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ªrce.pngæ–‡ä»¶ã€‚README.md æ–‡ä»¶è¯¦ç»†æè¿°äº†æ¼æ´žåŽŸç†ã€å½±å“ç‰ˆæœ¬ã€PoCåˆ©ç”¨æ–¹æ³•å’Œç¼“è§£æŽªæ–½ã€‚ä»£ç è¾ƒä¸ºç®€æ´ï¼Œç›®çš„æ˜Žç¡®ï¼Œæ—¨åœ¨å±•ç¤ºå’ŒéªŒè¯æ¼æ´žã€‚rce.png æ˜¯ Burp Suite çš„æˆªå›¾ï¼Œä½œä¸ºPoCçš„è¾…åŠ©è¯´æ˜Žã€‚ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼Œä½†ä»ä¸èƒ½å®Œå…¨æŽ’é™¤ã€‚ç”±äºŽç¼ºä¹æ›´æ·±å…¥çš„ä»£ç åˆ†æžï¼Œå‡è®¾å­˜åœ¨å¾ˆå°çš„å¯èƒ½ä½œè€…éšè—äº†ä¾‹å¦‚é€šè¿‡å›¾ç‰‡éšå†™æœ¯å°†åŽé—¨ä»£ç éšè—åœ¨rce.pngå›¾ç‰‡ä¸­ï¼Œæ•…æŠ•æ¯’é£Žé™©ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žä½ç½®ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°ã€‚
2.  **æ”»å‡»å‘é‡ï¼š** é€šè¿‡æž„é€ æ¶æ„çš„ `DistributedAPI` è¯·æ±‚ï¼Œå°†åŒ…å«ç‰¹æ®Šé”® `__unhandled_exc__` çš„ JSON æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ã€‚
3.  **è§¦å‘ç‚¹ï¼š** `run_as` æŽ¥å£ï¼Œåˆ©ç”¨ `auth_context` å‚æ•°ã€‚
4.  **åˆ©ç”¨æµç¨‹ï¼š**
    *   æ”»å‡»è€…é¦–å…ˆèŽ·å– Wazuh API çš„è®¿é—®æƒé™ï¼ˆé€šè¿‡è¢«å…¥ä¾µçš„ dashboardã€é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨æˆ–ç‰¹å®šé…ç½®ä¸‹çš„è¢«å…¥ä¾µçš„ Agentï¼‰ã€‚
    *   æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„ JSON payload çš„ HTTP POST è¯·æ±‚ï¼Œå‘é€åˆ° `/security/user/authenticate/run_as` ç«¯ç‚¹ã€‚
    *   Wazuh æœåŠ¡å™¨åœ¨ååºåˆ—åŒ– JSON æ•°æ®æ—¶ï¼Œç”±äºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–æ“ä½œï¼Œå¯¼è‡´ `__unhandled_exc__` å­—æ®µä¸­çš„ä»£ç è¢«æ‰§è¡Œã€‚
    *   æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žæ‰§è¡Œä»»æ„ä»£ç ï¼Œä¾‹å¦‚ï¼ŒPoC ä¸­ä½¿ç”¨äº† `exit()` å‡½æ•°å¯¼è‡´æœåŠ¡å™¨é€€å‡ºã€‚
5.  **ä¿®å¤æ–¹æ¡ˆï¼š** å‡çº§åˆ° Wazuh 4.9.1 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬å·²ä¿®å¤æ­¤æ¼æ´žã€‚

**é¡¹ç›®åœ°å€:** [GloStarRx1/CVE-2025-24016](https://github.com/GloStarRx1/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #4

**æ¥æº**: [CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md](../2025/CVE-2025-24016-MuhammadWaseem29_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨æŽ§åˆ¶ç³»ç»Ÿ

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboard, é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨, æˆ–è€…ç‰¹å®šé…ç½®ä¸‹è¢«æ”»é™·çš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–æ¼æ´žï¼Œå…è®¸è¿œç¨‹æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´žä½äºŽ`DistributedAPI`ç»„ä»¶ä¸­ï¼Œè¯¥ç»„ä»¶ä½¿ç”¨JSONåºåˆ—åŒ–å’Œ`as_wazuh_object`ååºåˆ—åŒ–DAPIè¯·æ±‚å‚æ•°ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿæ³¨å…¥æ¶æ„æž„é€ çš„å­—å…¸åˆ°DAPIè¯·æ±‚ä¸­ï¼Œä»–ä»¬å¯ä»¥æž„é€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸(`__unhandled_exc__`)æ¥æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚æ­¤æ¼æ´žCVSSè¯„åˆ†ä¸º9.9ï¼Œå½±å“Wazuh 4.4.0åˆ°4.9.0ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§:** æä¾›çš„PoCä»£ç æœ‰æ•ˆã€‚å®ƒåˆ©ç”¨äº†`run_as`ç«¯ç‚¹ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æŽ§åˆ¶`auth_context`å‚æ•°æ¥æ³¨å…¥æ¶æ„payloadã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œå¯¼è‡´æœåŠ¡å™¨æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æŠ•æ¯’é£Žé™©:** PoCä»£ç æœ¬èº«æ—¨åœ¨æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯èƒ½ä¿®æ”¹PoCä»£ç ï¼Œä¾‹å¦‚æ›¿æ¢`exit()`ä¸ºæ›´å…·ç ´åæ€§çš„å‘½ä»¤ï¼Œæ¯”å¦‚åˆ é™¤æ–‡ä»¶æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ä½†ä»Žç›®å‰åˆ†æžç»“æžœçœ‹ï¼Œè¯¥ä»“åº“ç»“æž„ç®€å•ï¼Œä»£ç é‡å°‘ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç éšè—ã€‚å› æ­¤ï¼ŒPoCå­˜å‚¨åº“æœ¬èº«ç›´æŽ¥åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½Žï¼ŒæŠ•æ¯’é£Žé™©çº¦ä¸º10%ï¼Œä¸»è¦é£Žé™©åœ¨äºŽä½¿ç”¨è€…æ˜¯å¦ä¼šå¯¹POCè¿›è¡Œä¿®æ”¹ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  æ”»å‡»è€…éœ€è¦èŽ·å¾—Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®žçŽ°ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æŽ§åˆ¶Wazuhé›†ç¾¤ä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸­ï¼Œæ”»é™·ä¸€ä¸ªWazuh agentã€‚
2.  æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„payloadçš„HTTP POSTè¯·æ±‚ï¼Œå‘é€åˆ°`/security/user/authenticate/run_as`ç«¯ç‚¹ã€‚Payloadä¸­åŒ…å«`__unhandled_exc__`ï¼Œ`__class__`è®¾ç½®ä¸ºéœ€è¦æ‰§è¡Œçš„å‡½æ•°(ä¾‹å¦‚`exit`æˆ–`os.system`)ï¼Œ`__args__`è®¾ç½®ä¸ºå‡½æ•°çš„å‚æ•°ã€‚
3.  WazuhæœåŠ¡å™¨ååºåˆ—åŒ–payloadï¼Œå¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„Pythonä»£ç ï¼Œä»Žè€Œå¯¼è‡´RCEã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-24016](https://github.com/MuhammadWaseem29/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #5

**æ¥æº**: [CVE-2025-24016-celsius026_poc_CVE-2025-24016.md](../2025/CVE-2025-24016-celsius026_poc_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´ç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½æ˜¯é€šè¿‡å—æŸçš„Dashboardæˆ–é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹å¯èƒ½è¢«å—æŸçš„Agentåˆ©ç”¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 0%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼Œç”±ä¸å®‰å…¨çš„ååºåˆ—åŒ–å¼•èµ·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´žåœ¨å—å½±å“çš„ Wazuh æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç ä¼¼ä¹Žæœ‰æ•ˆã€‚æ ¹æ®æ¼æ´žæè¿°ï¼Œ DistributedAPI å‚æ•°ä»¥ JSON æ ¼å¼åºåˆ—åŒ–ï¼Œå¹¶ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–ã€‚å¦‚æžœæ”»å‡»è€…èƒ½å¤Ÿåœ¨ DAPI è¯·æ±‚/å“åº”ä¸­æ³¨å…¥æœªç»æ¶ˆæ¯’çš„å­—å…¸ï¼Œä»–ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæœªå¤„ç†çš„å¼‚å¸¸ (`__unhandled_exc__`) æ¥è¯„ä¼°ä»»æ„ Python ä»£ç ã€‚æä¾›çš„ POC ä»£ç æ­£æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼Œé€šè¿‡ `__unhandled_exc__` æ³¨å…¥ `os.system` å‡½æ•°ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**æŠ•æ¯’é£Žé™©ï¼š**

æ£€æŸ¥æä¾›çš„ Python è„šæœ¬ `exploit_wazuh.py` å’Œ `requirements.txt`ï¼Œæ²¡æœ‰å‘çŽ°æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜Žç¡®ï¼Œå³åˆ©ç”¨ Wazuh çš„ååºåˆ—åŒ–æ¼æ´žæ‰§è¡Œå‘½ä»¤ã€‚ä»£ç ä¸­æ²¡æœ‰å‘çŽ°ä»»ä½•è¯•å›¾è¿žæŽ¥å¤–éƒ¨æœåŠ¡å™¨ã€æ”¶é›†æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œå…¶ä»–å¯ç–‘æ“ä½œçš„è¿¹è±¡ã€‚
 `requirements.txt` æ–‡ä»¶åŒ…å« `requests` å’Œ `urllib3` åº“ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„ Python åº“ï¼Œç”¨äºŽå‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„. å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„é£Žé™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´žç‚¹ï¼š** `framework/wazuh/core/cluster/common.py` ä¸­çš„ `as_wazuh_object` å‡½æ•°åœ¨å¤„ç† DistributedAPI å‚æ•°æ—¶å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚
2.  **æ”»å‡»æ–¹æ³•ï¼š** æ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œè¿™å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼Œä¾‹å¦‚æ”»å‡» Wazuh Dashboardï¼Œæˆ–è€…æŽ§åˆ¶é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å—æŸçš„ Agent ä¹Ÿå¯ä»¥è§¦å‘è¯¥æ¼æ´žã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…æž„é€ ä¸€ä¸ªåŒ…å«æ¶æ„ `__unhandled_exc__` é”®çš„ JSON è´Ÿè½½ï¼Œè¯¥é”®çš„å€¼ä¸ºä¸€ä¸ªåŒ…å« `__class__` å’Œ `__args__` é”®çš„å­—å…¸ã€‚`__class__` é”®æŒ‡å®šè¦æ‰§è¡Œçš„ Python å‡½æ•°ï¼Œ`__args__` é”®æŒ‡å®šä¼ é€’ç»™è¯¥å‡½æ•°çš„å‚æ•°ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œ`__class__` è¢«è®¾ç½®ä¸º `os.system`ï¼Œ`__args__` è¢«è®¾ç½®ä¸ºè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚
4.  **å‘é€è¯·æ±‚ï¼š** æ”»å‡»è€…å°†æ­¤æ¶æ„è´Ÿè½½ä½œä¸º DAPI è¯·æ±‚å‘é€åˆ° Wazuh æœåŠ¡å™¨ã€‚æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–è¯¥è´Ÿè½½æ—¶ï¼Œä¼šè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œå¹¶æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚

æ€»è€Œè¨€ä¹‹ï¼Œæ­¤æ¼æ´žåˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ï¼Œæ”»å‡»éš¾åº¦é€‚ä¸­ï¼Œå±å®³æ€§æžå¤§ï¼Œéœ€è¦å°½å¿«ä¿®å¤ã€‚

**é¡¹ç›®åœ°å€:** [celsius026/poc_CVE-2025-24016](https://github.com/celsius026/poc_CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #6

**æ¥æº**: [CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md](../2025/CVE-2025-24016-cybersecplayground_CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC.md)

## CVE-2025-24016-Wazuh-RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–æ¼æ´žå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´å®Œå…¨ç³»ç»Ÿæƒé™æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡è¢«æ”»é™·çš„dashboardã€é›†ç¾¤èŠ‚ç‚¹æˆ–ç‰¹å®šé…ç½®ä¸‹çš„Agentï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­å­˜åœ¨çš„ä¸€ä¸ªè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žï¼ŒæºäºŽä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æž„é€ æ¶æ„çš„JSONæ•°æ®ï¼Œåˆ©ç”¨DistributedAPIæŽ¥å£ä¸­çš„`as_wazuh_object`å‡½æ•°åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**æœ‰æ•ˆæ€§åˆ†æžï¼š**

æ ¹æ®æ¼æ´žæè¿°å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´žåˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡å‘`/security/user/authenticate/run_as`ç«¯ç‚¹å‘é€åŒ…å«æ¶æ„`__reduce__`çš„JSON payloadï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œ`os.system`å‘½ä»¤ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

è™½ç„¶POCä»£ç æœ¬èº«æ˜¯ä¸ºäº†éªŒè¯æ¼æ´žï¼Œä½†æŸ¥çœ‹æä¾›çš„ä»£ç ï¼Œ`CVE-2025-24016-POC.py`è„šæœ¬å¹¶æ²¡æœ‰æ˜Žæ˜¾çš„æ¶æ„ä»£ç æˆ–åŽé—¨ã€‚é£Žé™©åœ¨äºŽæ”»å‡»è€…å¯èƒ½ä¿®æ”¹POCï¼Œä½¿å…¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šå®‰è£…åŽé—¨æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚æ­¤å¤–ï¼ŒREADMEä¸­ç»™å‡ºçš„Burp Suiteè¯·æ±‚ç¤ºä¾‹ä¸­ï¼Œè™½ç„¶`__unhandled_exc__`ç¤ºä¾‹ä¼šå¯¼è‡´WazuhæœåŠ¡å™¨å…³é—­ï¼Œå½¢æˆæ‹’ç»æœåŠ¡ï¼Œä½†å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ªéšè”½çš„åŽé—¨ã€‚

LICENSEé‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸ä¿®æ”¹å’Œåˆ†å‘ï¼Œä½†ä¹Ÿå¢žåŠ äº†æ½œåœ¨çš„æŠ•æ¯’é£Žé™©ã€‚æ”»å‡»è€…å¯ä»¥ä¿®æ”¹ä»£ç å¹¶é‡æ–°å‘å¸ƒï¼Œä½¿å…¶åŒ…å«æ¶æ„åŠŸèƒ½ã€‚å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­æŠ•æ¯’é£Žé™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æžï¼š**

1.  **æ”»å‡»å…¥å£ï¼š** æ”»å‡»è€…éœ€è¦å…·å¤‡Wazuh APIçš„è®¿é—®æƒé™ã€‚è¿™å¯èƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼èŽ·å¾—ï¼š
    *   æ”»é™·Wazuh dashboardã€‚
    *   æ”»é™·Wazuhé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚
    *   åœ¨æŸäº›é…ç½®ä¸‹ï¼Œæ”»é™·Wazuh Agentã€‚
2.  **æ¼æ´žè§¦å‘ï¼š** æ”»å‡»è€…æž„é€ æ¶æ„çš„JSON payloadï¼Œå…¶ä¸­åŒ…å«`__reduce__`æˆ–å…¶ä»–å¯è§¦å‘ä»£ç æ‰§è¡Œçš„ååºåˆ—åŒ–gadgetã€‚
3.  **åˆ©ç”¨è¿‡ç¨‹ï¼š** æ”»å‡»è€…å°†payloadå‘é€åˆ°Wazuh APIçš„`/security/user/authenticate/run_as`ç«¯ç‚¹ï¼Œè§¦å‘ååºåˆ—åŒ–è¿‡ç¨‹ã€‚
4.  **ä»£ç æ‰§è¡Œï¼š** WazuhæœåŠ¡å™¨åœ¨ååºåˆ—åŒ–payloadæ—¶ï¼Œä¼šæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„Pythonä»£ç ï¼Œä»Žè€Œå®žçŽ°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚
5.  **å½±å“ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´žæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ï¼ŒèŽ·å–æ•æ„Ÿä¿¡æ¯ï¼Œå®‰è£…åŽé—¨ï¼Œç”šè‡³å®Œå…¨æŽ§åˆ¶WazuhæœåŠ¡å™¨ã€‚

**ç¼“è§£æŽªæ–½ï¼š**

*   å‡çº§åˆ°Wazuh v4.9.1æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é¿å…å°†APIæš´éœ²åœ¨å…¬ç½‘ä¸Šã€‚
*   ç›‘æŽ§APIçš„å¼‚å¸¸æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC](https://github.com/cybersecplayground/CVE-2025-24016-Wazuh-Remote-Code-Execution-RCE-PoC)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #7

**æ¥æº**: [CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md](../2025/CVE-2025-24016-guinea-offensive-security_Wazuh-RCE.md)

## CVE-2025-24016 - Wazuh Server RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœåŠ¡å™¨å®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ (å¯èƒ½é€šè¿‡å¼±å£ä»¤ï¼Œé›†ç¾¤å†…éƒ¨æ”»å‡»æˆ–å—æŸçš„agent)

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´žæ˜¯ç”±äºŽWazuhæœåŠ¡å™¨åœ¨å¤„ç†DistributedAPIè¯·æ±‚æ—¶ï¼Œä½¿ç”¨äº†ä¸å®‰å…¨çš„JSONååºåˆ—åŒ–`as_wazuh_object`å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„Pythonä»£ç ã€‚æ”»å‡»è€…é€šè¿‡æž„é€ åŒ…å«`__unhandled_exc__`å­—æ®µçš„æ¶æ„JSONæ•°æ®ï¼Œè¯¥å­—æ®µæŒ‡å‘`os.system`ç±»ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚POCä»£ç é€šè¿‡æž„é€ è¿™æ ·çš„payloadï¼Œåˆ©ç”¨bashåå¼¹shellåˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ã€‚ 

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…éœ€è¦æ‹¥æœ‰Wazuh APIçš„è®¿é—®æƒé™ã€‚ è¿™å¯èƒ½é€šè¿‡å¤šç§æ–¹å¼å®žçŽ°ï¼š
    *   çˆ†ç ´æˆ–åˆ©ç”¨é»˜è®¤å¼±å£ä»¤
    *   å¦‚æžœWazuhæœåŠ¡å™¨åœ¨é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œæ”»å‡»è€…å¯èƒ½æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œå¹¶é€šè¿‡é›†ç¾¤å†…éƒ¨ç½‘ç»œè¿›è¡Œæ”»å‡»ã€‚
    *   æ”»å‡»è€…å¯èƒ½é€šè¿‡å…¥ä¾µWazuh Agentï¼Œå¹¶ä½¿ç”¨Agentè¿žæŽ¥åˆ°æœåŠ¡å™¨ã€‚
2.  æ”»å‡»è€…æž„é€ åŒ…å«æ¶æ„`__unhandled_exc__`çš„JSONæ•°æ®ï¼Œå¹¶å°†å…¶ä½œä¸ºDAPIè¯·æ±‚å‘é€åˆ°WazuhæœåŠ¡å™¨çš„APIç«¯ç‚¹ï¼ˆä¾‹å¦‚`/security/user/authenticate/run_as`ï¼‰ã€‚
3.  æœåŠ¡å™¨åœ¨ååºåˆ—åŒ–JSONæ•°æ®æ—¶ï¼Œä¼šè°ƒç”¨`os.system`æ‰§è¡Œæ”»å‡»è€…æä¾›çš„bashå‘½ä»¤ï¼Œåå¼¹shellåˆ°æ”»å‡»è€…ã€‚

**æŠ•æ¯’é£Žé™©åˆ†æžï¼š**

ä»£ç å­˜åœ¨ä¸€å®šæŠ•æ¯’é£Žé™©ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  **è‡ªå®šä¹‰Header:** POCä¸­å­˜åœ¨`X-Header-Name: Custom-Header`ï¼Œè™½ç„¶ç›®å‰æ²¡æœ‰å®žé™…å±å®³ï¼Œä½†å¯èƒ½è¢«ç”¨äºŽåŽç»­æŠ•æ¯’åˆ©ç”¨ï¼Œä¾‹å¦‚é…åˆä¸­é—´äººæ”»å‡»ã€‚
2.  **Proxyé…ç½®:** å­˜åœ¨ä½¿ç”¨ä»£ç†çš„é€‰é¡¹ï¼Œå¯èƒ½è¯±å¯¼ç”¨æˆ·é…ç½®æ¶æ„ä»£ç†ï¼Œä»Žè€Œçªƒå–å‡­æ®æˆ–è€…æ¤å…¥æ¶æ„ä»£ç ã€‚
3.  **é…ç½®æ–‡ä»¶è¯»å–:**  è™½ç„¶POCé‡Œæ²¡æœ‰ä½¿ç”¨config-fileï¼Œä½†å¦‚æžœå…è®¸ç”¨æˆ·è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ï¼Œå¯èƒ½å­˜åœ¨è¯»å–æ¶æ„é…ç½®æ–‡ä»¶çš„é£Žé™©ã€‚
4.  **ä»£ç ç»“æž„å¤æ‚æ€§:** ä»£ç ä¸ºäº†å¢žåŠ æ˜“è¯»æ€§å’Œå¯é…ç½®æ€§ï¼Œå¼•å…¥äº†ä¸€äº›å‡½æ•°å’Œå‚æ•°ï¼Œè¿™ä¼šå¢žåŠ ä»£ç çš„å¤æ‚æ€§ï¼Œå¯èƒ½éšè—æ¶æ„é€»è¾‘ã€‚

æ€»çš„æ¥è¯´ï¼ŒPOCä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´žï¼Œä½†å­˜åœ¨ä¸€äº›å¯ä»¥è¢«åˆ©ç”¨è¿›è¡Œæ¶æ„è¡Œä¸ºçš„æ½œåœ¨é£Žé™©ï¼Œä½†ç›¸å¯¹è¾ƒä½Žã€‚é£Žé™©ç‚¹ä¸»è¦é›†ä¸­åœ¨ç”¨æˆ·é…ç½®å’Œè‡ªå®šä¹‰headerä¸Šã€‚


**é¡¹ç›®åœ°å€:** [guinea-offensive-security/Wazuh-RCE](https://github.com/guinea-offensive-security/Wazuh-RCE)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #8

**æ¥æº**: [CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md](../2025/CVE-2025-24016-huseyinstif_CVE-2025-24016-Nuclei-Template.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–RCE

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå®Œå…¨ç³»ç»ŸæŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®ï¼ˆå¯èƒ½éœ€è¦è¾ƒä½Žæƒé™ï¼‰ï¼ŒæŸäº›é…ç½®ä¸‹agentå¯è§¦å‘

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 5%

## è¯¦æƒ…

CVE-2025-24016æ˜¯WazuhæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘ DistributedAPI å‘é€ç‰¹åˆ¶çš„JSONè¯·æ±‚ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°ä¸­çš„ä¸å®‰å…¨ååºåˆ—åŒ–æœºåˆ¶ï¼Œæ‰§è¡Œä»»æ„Pythonä»£ç ã€‚POCä»£ç é€šè¿‡æž„é€ åŒ…å« `__unhandled_exc__` å­—æ®µçš„JSONæ•°æ®ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„ç±»`NotARealClass`ï¼Œè§¦å‘`NameError`ï¼Œå¦‚æžœæœåŠ¡å™¨è¿”å›ž500çŠ¶æ€ç ä¸”bodyä¸­åŒ…å«"NameError"ï¼Œåˆ™è¡¨æ˜Žå­˜åœ¨æ¼æ´žã€‚å°½ç®¡è¯¥POCæ—¨åœ¨æ£€æµ‹æ¼æ´žè€Œéžåˆ©ç”¨ï¼Œä½†å¦‚æžœå°†`NotARealClass`æ›¿æ¢ä¸ºå¯ä»¥åˆ©ç”¨çš„ååºåˆ—åŒ–gadgetï¼Œåˆ™å¯å®žçŽ°RCEã€‚æŠ•æ¯’é£Žé™©è¾ƒä½Žï¼Œä¸»è¦é›†ä¸­åœ¨ä½œè€…åœ¨å…¶ä»–åœ°æ–¹å…¬å¸ƒäº†æ¶æ„åˆ©ç”¨æ–¹å¼çš„å¯èƒ½æ€§ï¼Œæˆ–è€…æœªæ¥ä¿®æ”¹æ¨¡æ¿å¢žåŠ æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£Žé™©è¯„ä¼°ä¸º5%ã€‚æ¼æ´žåˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  **æ”»å‡»è€…** éœ€è¦èƒ½å¤Ÿè®¿é—®Wazuh APIï¼Œå¯èƒ½æ˜¯é€šè¿‡Webç•Œé¢ã€é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨ï¼Œæˆ–è€…åœ¨ç‰¹å®šé…ç½®ä¸‹ç”šè‡³æ˜¯å—æŸçš„agentã€‚
2.  **æ”»å‡»è€…** æž„é€ åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„JSONè¯·æ±‚ï¼Œå°†å…¶å‘é€åˆ° DistributedAPIã€‚
3.  **WazuhæœåŠ¡å™¨** ä½¿ç”¨ `as_wazuh_object` ååºåˆ—åŒ–JSONæ•°æ®ã€‚
4.  **æ”»å‡»è€…æ³¨å…¥çš„æ¶æ„å¯¹è±¡** è¢«å®žä¾‹åŒ–ï¼Œå¯¼è‡´æ‰§è¡Œä»»æ„Pythonä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [huseyinstif/CVE-2025-24016-Nuclei-Template](https://github.com/huseyinstif/CVE-2025-24016-Nuclei-Template)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

## POC #9

**æ¥æº**: [CVE-2025-24016-rxerium_CVE-2025-24016.md](../2025/CVE-2025-24016-rxerium_CVE-2025-24016.md)

## CVE-2025-24016-Wazuh-ååºåˆ—åŒ–RCE

**æ¼æ´žç¼–å·:** CVE-2025-24016

**æ¼æ´žç±»åž‹:** ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“åº”ç”¨:** Wazuh

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œå’Œç³»ç»Ÿå®Œå…¨æŽ§åˆ¶

**å½±å“ç‰ˆæœ¬:** >= 4.4.0, < 4.9.1

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦APIè®¿é—®æƒé™ï¼ˆå¯èƒ½é€šè¿‡æŽ§åˆ¶é¢æ¿ã€é›†ç¾¤ä¸­çš„WazuhæœåŠ¡å™¨æˆ–å—æŸçš„ä»£ç†å®žçŽ°ï¼‰

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£Žé™©:** 1%

## è¯¦æƒ…

CVE-2025-24016 æ˜¯ä¸€ä¸ªå­˜åœ¨äºŽ Wazuh æœåŠ¡å™¨ä¸­çš„ååºåˆ—åŒ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´žã€‚è¯¥æ¼æ´žå½±å“ Wazuh 4.4.0 åˆ° 4.9.0 ç‰ˆæœ¬ã€‚ç”±äºŽ DistributedAPI ç»„ä»¶ä¸­å­˜åœ¨ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥æ¶æ„æž„é€ çš„ JSON æ•°æ®ï¼Œåˆ©ç”¨ `as_wazuh_object` å‡½æ•°æ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“Žç»“æžœï¼Œæ­¤æ¼æ´žå·²è¢« Mirai åƒµå°¸ç½‘ç»œåˆ©ç”¨ï¼Œè¿›è¡Œ DDoS æ”»å‡»å’Œæ„ŸæŸ“ IoT è®¾å¤‡ã€‚æä¾›çš„ Nuclei æ¨¡æ¿é€šè¿‡æ£€æŸ¥ Wazuh Web ç•Œé¢çš„ç‰ˆæœ¬æ¥æ£€æµ‹æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´žã€‚æ£€æµ‹é€»è¾‘ä¸ºé€šè¿‡æ­£åˆ™åŒ¹é…é¡µé¢ä¸­çš„wazuhVersionï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³é¡µé¢è¿”å›ž200çŠ¶æ€ç å¹¶ä¸”bodyä¸­åŒ…å«`<title>Wazuh</title>` å’Œ `wazuhVersion`ã€‚å¦‚æžœç‰ˆæœ¬åœ¨ 4.4.0 å’Œ 4.9.0 ä¹‹é—´ï¼Œåˆ™åˆ¤å®šä¸ºå­˜åœ¨æ¼æ´žã€‚æŠ•æ¯’é£Žé™©åˆ†æžï¼šæä¾›çš„Nucleiæ¨¡æ¿ä¸»è¦ç”¨äºŽæ¼æ´žæ£€æµ‹ï¼Œè€Œéžæ¼æ´žåˆ©ç”¨ã€‚è¯¥æ¨¡æ¿ä»…é€šè¿‡å‘é€HTTP GETè¯·æ±‚å¹¶åˆ†æžå“åº”æ¥åˆ¤æ–­ç›®æ ‡ç³»ç»Ÿæ˜¯å¦å­˜åœ¨æ¼æ´žï¼Œä¸ä¼šä¸»åŠ¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚è€ƒè™‘åˆ°ä½œè€…å¯èƒ½ä¼šåœ¨åŸŸåæ£€æµ‹è§„åˆ™ä¸­åŠ å…¥æ¶æ„åŸŸåï¼Œæˆ–è€…åœ¨ç‰ˆæœ¬æ£€æµ‹è§„åˆ™ä¸­åŠ å…¥é™·é˜±ï¼Œå› æ­¤å­˜åœ¨æžä½Žçš„æŠ•æ¯’é£Žé™©ï¼Œå¤§çº¦1%ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…éœ€è¦é¦–å…ˆèŽ·å¾— Wazuh API çš„è®¿é—®æƒé™ï¼Œç„¶åŽå‘é€åŒ…å«æ¶æ„åºåˆ—åŒ–æ•°æ®çš„è¯·æ±‚ï¼Œè§¦å‘ `__unhandled_exc__` å¼‚å¸¸ï¼Œä»Žè€Œæ‰§è¡Œä»»æ„ Python ä»£ç ã€‚æ”»å‡»é€”å¾„å¯èƒ½åŒ…æ‹¬ï¼š
1.  **æ”»å‡»æŽ§åˆ¶é¢æ¿ï¼š**å¦‚æžœæ”»å‡»è€…å¯ä»¥è®¿é—®æˆ–æŽ§åˆ¶ Wazuh æŽ§åˆ¶é¢æ¿ï¼Œä»–ä»¬å°±å¯ä»¥é€šè¿‡ API å‘é€æ¶æ„è¯·æ±‚ã€‚
2.  **æ”»å‡»é›†ç¾¤ä¸­çš„ Wazuh æœåŠ¡å™¨ï¼š**å¦‚æžœæ”»å‡»è€…æŽ§åˆ¶äº†é›†ç¾¤ä¸­çš„ä¸€å° Wazuh æœåŠ¡å™¨ï¼Œä»–ä»¬å°±å¯ä»¥åˆ©ç”¨è¯¥æœåŠ¡å™¨å‘å…¶ä»–æœåŠ¡å™¨å‘é€æ¶æ„è¯·æ±‚ã€‚
3.  **æ”»å‡»å—æŸçš„ä»£ç†ï¼š**åœ¨æŸäº›é…ç½®ä¸­ï¼Œå—æŸçš„ä»£ç†ä¹Ÿå¯ä»¥è¢«ç”¨æ¥è§¦å‘æ­¤æ¼æ´žã€‚
æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´žå¯èƒ½å¯¼è‡´æ”»å‡»è€…å®Œå…¨æŽ§åˆ¶å—å½±å“çš„ Wazuh æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [rxerium/CVE-2025-24016](https://github.com/rxerium/CVE-2025-24016)

**æ¼æ´žè¯¦æƒ…:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)

---

