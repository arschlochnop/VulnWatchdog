## CVE-2025-48384 - Git 任意文件写入导致远程代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入导致远程代码执行

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本范围待定，参考GitHub advisory

**利用条件:** 需要用户执行git clone --recursive操作，攻击者可控制的Git仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 40%

## 详情

CVE-2025-48384是Git中的一个关键漏洞，允许攻击者在执行`git clone --recursive`操作期间写入任意文件。此漏洞可能通过恶意的.gitmodules文件、符号链接和Git hooks导致远程代码执行（RCE）。此漏洞影响Linux和macOS平台，Windows不受影响。

POC有效性分析：提供的POC包含一个Python扫描器，用于检测利用CVE-2025-48384的潜在恶意Git仓库。扫描器检查`.gitmodules`文件中的可疑条目（包含`..`或以`\r`结尾的路径）、指向hooks的符号链接以及可执行的hooks脚本。POC的`cve_2025_48384_auto_print_scanner.py`脚本通过以下步骤检测漏洞：1. 读取`.gitmodules`文件并查找`path`条目，检查是否存在`..`（目录遍历）或以`\r`（回车符）结尾的情况，这可能导致文件写入到预期位置之外。2. 在仓库中查找指向`.git/hooks`目录的符号链接，这些链接可能被用来劫持Git hook执行流程。3. 查找仓库中可执行的Git hooks（如`post-checkout`，`post-merge`，`pre-commit`，`pre-push`，`post-commit`等）。这些hooks如果被恶意修改，可以在特定的Git操作期间执行任意代码。

利用步骤：攻击者创建一个包含恶意`.gitmodules`文件的Git仓库。该文件包含指向仓库外部或包含回车符的子模块路径。攻击者还可以创建指向`.git/hooks`目录的符号链接，或者直接包含恶意的可执行Git hooks。当受害者使用`git clone --recursive`克隆此仓库时，恶意`.gitmodules`文件可能导致Git写入任意文件，符号链接可能劫持Git hook执行，可执行的hooks会被执行，从而导致RCE。

投毒风险分析：该POC包含一个扫描器，其本身不包含直接的恶意代码，但它可以被修改以包含恶意行为。该POC的投毒风险主要来自于以下几个方面：1. 扫描器可以被修改为在检测到漏洞后，自动执行某些操作，例如下载并执行恶意payload。2. 扫描器可以被修改为将扫描结果发送到远程服务器，从而泄露敏感信息。3. 扫描器可能依赖于外部库，这些库可能包含漏洞或恶意代码。4. 扫描器生成的报告可能被篡改，以误导用户或隐藏潜在的漏洞。 由于该POC的代码相对清晰，主要使用标准库，并且没有明显的恶意行为，因此投毒风险为中等，约为40%。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-48384
