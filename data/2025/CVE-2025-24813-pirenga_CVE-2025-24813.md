## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires network access, uses partial PUT feature

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability in Apache Tomcat related to the handling of partial PUT requests. According to Rapid7, the vulnerability was disclosed on March 10, 2025, and fixed versions are available. The vulnerability affects versions 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, and the end-of-life versions 8.5.0 through 8.5.100. The provided POC code demonstrates a deserialization vulnerability. The `ExploitServlet.java` file defines a servlet that deserializes Java objects from the request input stream. This servlet is mapped to the `/vulnerable_endpoint` URL. The `SafeGadget.java` defines a class that, when deserialized, writes "Pwned!" to `/tmp/pwn.txt`. The `SafeGadgetSerializer.java` serializes an instance of `SafeGadget` to `payload.ser`. To exploit this vulnerability, an attacker would need to deploy the provided web application to a vulnerable Tomcat server, craft a malicious serialized Java object using `SafeGadgetSerializer.java`, and then send a POST request to `/vuln-app/vulnerable_endpoint` with the serialized object as the request body. Successful exploitation results in the creation of the `/tmp/pwn.txt` file on the server with the content "Pwned!".

The POC is effective because it bypasses the intended usage of partial PUT requests and leverages Java deserialization to execute arbitrary code. The web.xml configures the servlet and mapping, and the index.jsp provides instructions. The vulnerability exists because Tomcat does not properly sanitize or validate the data being deserialized, allowing an attacker to inject malicious code. This can lead to remote code execution, allowing the attacker to gain control of the server.

**投毒风险分析:** The poisoning risk for this POC is relatively low. The provided code primarily uses standard Java libraries for serialization and file writing. The only potentially concerning behavior is the creation of a file in the `/tmp` directory, which could be flagged as suspicious. However, this action is directly related to the intended functionality of the exploit, which is to demonstrate remote code execution by writing to a file. There is no evidence of code obfuscation, external script dependencies, or attempts to download or execute arbitrary code. The payload is self-contained and the malicious activity is directly triggered by deserializing a crafted Java object. While the act of deserializing untrusted data is inherently risky, the provided POC does not introduce any additional or hidden malicious behavior. Furthermore, the code clearly defines the actions taken, making it easier to review and assess the risk. Overall, the risk of the POC being used to deliver a poisoned payload is estimated to be 15%.

**项目地址:** No specific repository URL provided, code snippets included in analysis.

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
