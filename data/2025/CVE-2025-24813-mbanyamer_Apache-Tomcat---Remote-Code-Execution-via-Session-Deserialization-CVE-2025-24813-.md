## CVE-2025-24813 - Apache Tomcat 远程代码执行(RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Tomcat

**危害等级:** 严重

**CVSS评分:** 待定(根据Rapid7博客，该漏洞为未经身份验证的远程代码执行漏洞)

**影响版本:** Apache Tomcat 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** 未经身份验证，需要目标服务器开启PUT方法。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，源于不安全的反序列化会话文件。该漏洞允许未经身份验证的攻击者通过PUT请求上传恶意序列化Java payload到可写的会话目录，然后通过触发对JSP文件的请求来执行任意命令。 

POC有效性分析：提供的Python POC代码CVE-2025-24813.py是一个完整的利用程序。首先，它检查目标服务器是否支持PUT方法。如果支持，它将生成一个恶意的Java序列化payload（利用ysoserial），并将其上传到Tomcat会话目录中。最后，它通过访问一个JSP文件来触发payload的执行。该POC经过测试，确认可以在易受攻击的Apache Tomcat版本上实现远程代码执行。

利用步骤：
1. 确保目标服务器运行的是受影响的Apache Tomcat版本（11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98, 8.5.0 to 8.5.100）。
2. 确保目标服务器启用了PUT方法。
3. 下载或生成ysoserial.jar文件，用于生成序列化payload。
4. 运行提供的Python脚本，指定目标URL和要执行的命令。
5. 脚本将自动上传payload并触发漏洞，在目标服务器上执行指定的命令。
6. 检查执行结果。

投毒风险分析：该POC的投毒风险较低。代码主要使用标准Python库，如requests, os, random, string, subprocess。恶意行为主要体现在payload的生成和上传，以及命令的执行。ysoserial是常用的Java反序列化利用工具，本身不属于恶意软件，但被用于生成恶意payload。Payload上传使用了PUT方法，路径包含uploads/../sessions，存在一定绕过风险。subprocess被用于调用java执行命令，具有一定风险。脚本本身逻辑清晰，未发现明显的混淆或恶意代码。综合评估，投毒风险为20%。尽管payload是利用ysoserial生成的，但脚本本身并没有包含直接的、明显的恶意行为，例如下载和执行外部脚本，或者进行信息窃取。此外，该脚本依赖于目标系统的漏洞和配置（例如，开启PUT方法），因此其攻击能力是有限的。

**项目地址:** https://github.com/...

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
