# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> ğŸ“¦ è¯¥CVEæœ‰ **7** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿå­˜åœ¨æ¼æ´ç‰ˆæœ¬ä¸”ç½‘ç»œå¯è¾¾ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´ä½äºå¤„ç†ç‰¹å®šç±»å‹çš„ HTTP è¯·æ±‚æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€å¹¶åŠ«æŒç¨‹åºæ§åˆ¶æµã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

1.  **æ¼æ´æˆå› ï¼š**  æ¼æ´æ˜¯ç”±äºç¨‹åºåœ¨æ ˆä¸Šåˆ†é…çš„ç¼“å†²åŒºå¤§å°ä¸è¶³ä»¥å®¹çº³è¾“å…¥æ•°æ®ï¼Œå¯¼è‡´æ•°æ®æº¢å‡ºè¦†ç›–äº†æ ˆä¸Šçš„å…¶ä»–æ•°æ®ï¼ŒåŒ…æ‹¬è¿”å›åœ°å€ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š**  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ä»£ç çš„ç‰¹æ®Šè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šå¯¼è‡´æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä½¿å…¶æŒ‡å‘æ”»å‡»è€…æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ï¼ŒROPé“¾ï¼‰ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„rubyè„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„POCï¼Œå®ƒå®ç°äº†åˆ©ç”¨è¯¥æ¼æ´çš„æ­¥éª¤ã€‚ è¯¥è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡ Ivanti è®¾å¤‡çš„ productversionã€‚ ç„¶åæ ¹æ®è¯¥ç‰ˆæœ¬ï¼Œä½¿ç”¨é¢„å®šä¹‰çš„åç§»é‡å’Œgadgetåœ°å€ï¼Œæ¥ç²¾å¿ƒæ„é€ æº¢å‡ºæ•°æ®ï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚ è¯¥è„šæœ¬ä½¿ç”¨ HTTP è¯·æ±‚å‘é€æ¶æ„æ•°æ®ã€‚ è¯¥ POC åŒ…å« brute force libdsplibs.so çš„åœ°å€åŠŸèƒ½, æé«˜æ¼æ´åˆ©ç”¨çš„æˆåŠŸæ¦‚ç‡ã€‚
4.  **æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯åˆ©ç”¨æ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æŠ•æ¯’ã€‚è„šæœ¬å°è¯•å»ºç«‹åå‘shellè¿æ¥åˆ°æ”»å‡»è€…çš„æœºå™¨ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œè¿™æ˜¯æ¼æ´åˆ©ç”¨çš„å¸¸è§æ‰‹æ³•ï¼Œå¹¶éåé—¨ä»£ç ã€‚ä½†ä¾ç„¶éœ€è¦æ³¨æ„ï¼Œä»»ä½•æœªç»éªŒè¯çš„ç¬¬ä¸‰æ–¹ä»£ç éƒ½å­˜åœ¨æ½œåœ¨é£é™©ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º1%ã€‚ä¸»è¦é£é™©å¯èƒ½æ¥æºäºæ”»å‡»è€…åˆ©ç”¨è¯¥POCè¿›è¡Œæ”»å‡»æ´»åŠ¨ï¼Œè€ŒéPOCæœ¬èº«åŒ…å«æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**æ¥æº**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-å †æ ˆç¼“å†²åŒºæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** å †æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ— éœ€èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 60%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ Neurons for ZTA gateways ä¸­å­˜åœ¨çš„å †æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457æ˜¯ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå·²è¢«ç§¯æåˆ©ç”¨ã€‚ æœç´¢ç»“æœè¡¨æ˜ï¼Œå¤šä¸ªå®‰å…¨æœºæ„ï¼ˆå¦‚Mandiantã€Rapid7ã€CISAï¼‰éƒ½å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„æŠ¥å‘Šï¼Œå¹¶ç¡®è®¤äº†è¯¥æ¼æ´åœ¨é‡å¤–è¢«åˆ©ç”¨çš„äº‹å®ã€‚æä¾›çš„PoCä»£ç åŒ…æ‹¬Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œè¡¨æ˜è¯¥æ¼æ´å…·æœ‰è¾ƒé«˜çš„å¯åˆ©ç”¨æ€§ã€‚ ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwatchtowr.labsçš„æœç´¢ç»“æœä¸­æåˆ°åˆ©ç”¨X-Forwarded-Forå¤´å¯èƒ½ä¸å¯è¡Œï¼ˆå—é™äºå­—ç¬¦ï¼‰ã€‚ ä½†æ€»ä½“ä¸Šï¼Œç”±äºå­˜åœ¨å…¬å¼€å¯ç”¨çš„PoCå’Œåœ¨é‡åˆ©ç”¨æŠ¥å‘Šï¼Œæ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æä¾›çš„PoCä¸‹è½½é“¾æ¥æŒ‡å‘ä¸€ä¸ªçŸ­é“¾æ¥ï¼ˆbit.lyï¼‰ï¼Œè¿™æœ¬èº«å°±å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œå› ä¸ºæ— æ³•ç›´æ¥ç¡®å®šé“¾æ¥æŒ‡å‘çš„æ–‡ä»¶çš„çœŸå®æ€§å’Œå®‰å…¨æ€§ã€‚è™½ç„¶PoCè¯´æ˜ä¸­å£°æ˜â€œyet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.â€æš—ç¤ºPoCçš„ç¨€ç¼ºæ€§,å­˜åœ¨é’“é±¼å«Œç–‘ï¼Œä½†æ˜¯æ ¹æ®CISAçš„æŠ¥å‘Šè¯¥æ¼æ´å·²ç»è¢«åˆ©ç”¨ï¼Œæ‰€ä»¥è¿™ä¸€å¥è¯çš„å¯ä¿¡åº¦éœ€è¦é™ä½ã€‚
README.mdæ–‡ä»¶å†…å®¹è¡¨æ˜åŒ…å«Pythonè„šæœ¬å’ŒMetasploitæ¨¡å—ï¼Œå¢åŠ äº†åˆ†æå¤æ‚æ€§ã€‚å› ä¸ºMetasploitæ¨¡å—å¯èƒ½åŒ…å«å¤æ‚æ¶æ„è½½è·ï¼Œé€šè¿‡åˆ†æçŸ­é“¾æ¥çš„ä¸‹è½½é“¾æ¥ï¼ˆè‹¥å¯è·å¾—ï¼‰å’Œè¯¦ç»†çš„ä»£ç è¡Œä¸ºåˆ†æå¯ä»¥è¾ƒä¸ºå‡†ç¡®åˆ¤æ–­æŠ•æ¯’é£é™©ï¼Œä½†ç›®å‰ä¿¡æ¯æœ‰é™ã€‚å‡è®¾ä¸‹è½½çš„æ–‡ä»¶ä¸­å­˜åœ¨è¢«ç¯¡æ”¹çš„ä»£ç ï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–æ¶æ„è½½è·ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ä½†é‰´äºè¯¥æ¼æ´å½±å“è¾ƒå¤§ä¸”åœ¨é‡åˆ©ç”¨ï¼Œå…¬å¼€çš„PoCå¾ˆå¯èƒ½å·²ç»è¢«å®‰å…¨ç ”ç©¶äººå‘˜åˆ†æè¿‡ï¼Œå› æ­¤æŠ•æ¯’ä»£ç è¢«å‘ç°çš„å¯èƒ½æ€§è¾ƒé«˜ã€‚ç»¼åˆè€ƒè™‘ï¼Œç»™å‡º60%çš„æŠ•æ¯’é£é™©è¯„ä¼°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
è¯¥æ¼æ´æ˜¯å †æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–å †æ ˆä¸Šçš„è¿”å›åœ°å€æˆ–å…¶ä»–å…³é”®æ•°æ®ï¼Œä»è€ŒåŠ«æŒç¨‹åºçš„æ§åˆ¶æµï¼Œæœ€ç»ˆæ‰§è¡Œä»»æ„ä»£ç ã€‚PoCåˆ©ç”¨å¯èƒ½æ¶‰åŠåˆ°ä»¥ä¸‹æ­¥éª¤ï¼š

1.  å‘é€åŒ…å«æ¶æ„payloadçš„HTTPè¯·æ±‚ï¼Œé€šå¸¸åˆ©ç”¨`X-Forwarded-For` header (ä½†æ ¹æ®ä¸€éƒ¨åˆ†æœç´¢ç»“æœè¯¥æ–¹å¼å¯èƒ½ä¸å¯è¡Œï¼Œå…·ä½“æƒ…å†µéœ€è¦è¿›ä¸€æ­¥éªŒè¯)ã€‚
2.  Payloadæº¢å‡ºå †æ ˆç¼“å†²åŒºï¼Œè¦†ç›–è¿”å›åœ°å€ã€‚
3.  è¿”å›åœ°å€è¢«æ›¿æ¢ä¸ºæ”»å‡»è€…æ§åˆ¶çš„åœ°å€ï¼ŒæŒ‡å‘ shellcode æˆ– ROP é“¾ã€‚
4.  æ‰§è¡Œ shellcode æˆ– ROP é“¾ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

ç”±äºæ­¤æ¼æ´æ— éœ€èº«ä»½éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥è¿œç¨‹ç›´æ¥å‘èµ·æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**æ¥æº**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»èº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œä»è€Œåœ¨ç›®æ ‡è®¾å¤‡ä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœï¼ˆç‰¹åˆ«æ˜¯Rapid7çš„åˆ†æä»¥åŠattackerkbçš„è¯„ä¼°ï¼‰å’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æœ¬èº«æä¾›äº†é’ˆå¯¹æ˜“å—æ”»å‡»çš„ Ivanti Connect Secure ç›®æ ‡ (ç‰ˆæœ¬ 22.7r2.4) çš„åˆ©ç”¨ç¤ºä¾‹ï¼ŒåŒ…æ‹¬ ASLR ç»•è¿‡å’Œè·å–åå‘ shellã€‚æœç´¢ç»“æœä¹Ÿè¡¨æ˜è¯¥æ¼æ´å·²è¢«é‡å¤–åˆ©ç”¨ (UNC5221, ä¸­å›½èƒŒæ™¯çš„å¨èƒè¡Œä¸ºè€…)ã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoCä»£ç çš„ `README.md` æ–‡ä»¶ä¸­åŒ…å«å®Œæ•´çš„åˆ©ç”¨è¯´æ˜å’Œå‚æ•°è§£é‡Šï¼Œç»“æ„æ¸…æ™°ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç†è§£å’Œå¤ç°æ¼æ´ã€‚è¯¥PoCåˆ©ç”¨çš„æ˜¯æ ˆæº¢å‡ºæ¼æ´ï¼Œé€šè¿‡æ§åˆ¶è¿”å›åœ°å€æ¥æ‰§è¡Œæ¶æ„ä»£ç ï¼Œè·å–åå‘shellã€‚è™½ç„¶åˆ©ç”¨æœ¬èº«ä¼šé€ æˆç³»ç»ŸæŸå®³ï¼Œä½†ä»£ç æœ¬èº«æ²¡æœ‰å‘ç°æ•…æ„å¼•å…¥çš„æ¶æ„è¡Œä¸ºæˆ–è€…åé—¨ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚è€ƒè™‘åˆ°å…¬å¼€ PoC çš„æ€§è´¨ï¼Œä½œè€…å¯èƒ½è¯•å›¾é€šè¿‡å¾®å¦™çš„ä¿®æ”¹å¼•å…¥åé—¨ï¼Œä¾‹å¦‚ï¼Œè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„è¿¹è±¡,ä¾‹å¦‚å°†åå‘ shell è¿æ¥åˆ°æœªçŸ¥ IP åœ°å€æˆ–æ‰§è¡Œå…¶ä»–æœªç»æˆæƒçš„æ“ä½œï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€äº›å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œshellcode å¯èƒ½ä¼šè¢«ä¿®æ”¹ä¸ºåŒ…å«é¢å¤–çš„æ¶æ„æ“ä½œï¼Œæˆ–è€…ä¾èµ–é¡¹å¯èƒ½è¢«ç¯¡æ”¹ã€‚ ä½†PoCçš„é‡å¿ƒæ”¾åœ¨æ¼”ç¤ºæ¼æ´åˆ©ç”¨ä¸Šã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´å®šä½ï¼š** æ ˆæº¢å‡ºæ¼æ´å­˜åœ¨äº Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways çš„ç‰¹å®šç‰ˆæœ¬ä¸­ã€‚
2.  **æ”»å‡»å…¥å£ï¼š** è¿œç¨‹ã€æœªç»èº«ä»½éªŒè¯çš„ç½‘ç»œè®¿é—®ã€‚
3.  **æ¼æ´åˆ©ç”¨ï¼š** æ”»å‡»è€…å‘é€ç‰¹åˆ¶çš„è¯·æ±‚ï¼Œåˆ©ç”¨æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡Œæ¶æ„ä»£ç ã€‚
4.  **ASLRç»•è¿‡ï¼š** PoCä»£ç ä½¿ç”¨æš´åŠ›ç ´è§£ASLRæ¥å®šä½`libdsplibs.so`çš„åŸºå€ï¼Œæˆ–è€…é€šè¿‡å‚æ•° `--libdsplibs` ç›´æ¥æŒ‡å®šåŸºå€ã€‚
5.  **Payloadï¼š** PoCä»£ç ä½¿ç”¨åå‘ shell ä½œä¸º payloadï¼Œå…è®¸æ”»å‡»è€…åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œå‘½ä»¤ã€‚
6.  **æ§åˆ¶ç³»ç»Ÿï¼š** æˆåŠŸåˆ©ç”¨æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥è·å¾—ç›®æ ‡ç³»ç»Ÿçš„æ§åˆ¶æƒï¼ˆå¦‚ï¼Œè·å¾—shellï¼‰ï¼Œä»è€Œå¯èƒ½è¿›è¡Œæ•°æ®çªƒå–ã€æ¶æ„è½¯ä»¶å®‰è£…æˆ–å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**æ¥æº**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆç¼“å†²åŒºæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼šIvanti Connect Secure 22.7R2.6ä¹‹å‰, Ivanti Policy Secure 22.7R1.4ä¹‹å‰, Ivanti ZTA Gateways 22.8R2.2ä¹‹å‰

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæ¼æ´å­˜åœ¨äºæœªæˆæƒçš„ç«¯ç‚¹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç å¹¶éç›´æ¥çš„exploitï¼Œè€Œæ˜¯ç¼“è§£æªæ–½

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457æ˜¯ä¸€ä¸ªIvanti Connect Secure, Policy Secure, ZTA Gatewaysä¸­çš„æ ˆç¼“å†²åŒºæº¢å‡ºæ¼æ´ã€‚æœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-22457 æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«ç§¯æåˆ©ç”¨ã€‚æä¾›çš„ä»£ç  `ivantiunlocker` å¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ä¸€ç§ç¼“è§£æªæ–½ï¼Œé€šè¿‡åœ¨ Ivanti è®¾å¤‡å‰è®¾ç½®ä¸€ä¸ªç®€å•çš„ web è®¤è¯ç½‘å…³ï¼Œé™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚åŸå§‹æ¼æ´åˆ©ç”¨æ˜¯é€šè¿‡å‘é€æ„é€ çš„HTTPè¯·æ±‚ï¼Œåˆ©ç”¨æ ˆç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œä»£ç ã€‚

**æŠ•æ¯’é£é™©ï¼š**

`unlock_web.py` æœ¬èº«çš„åŠŸèƒ½æ˜¯åšä¸€ä¸ªç®€æ˜“çš„webè®¤è¯ï¼Œå¢åŠ äº†ä¸€å±‚è®¿é—®æ§åˆ¶ã€‚ä½†æ˜¯ï¼Œ`PASSWORD = "yoursuperduperpassword"`  é»˜è®¤å¯†ç è¿‡äºç®€å•ï¼Œå¦‚æœä½¿ç”¨è€…ä¸ä¿®æ”¹ï¼Œå­˜åœ¨è¢«ç»•è¿‡çš„é£é™©ã€‚è€Œä¸”ï¼Œè¯¥è„šæœ¬å°†æ—¥å¿—è®°å½•åˆ° `/var/log/ivantiunlocker.log`ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼Œæ¯”å¦‚IPåœ°å€ç­‰ã€‚æ­¤å¤–ï¼Œå¦‚æœwebæœåŠ¡å™¨æœ¬èº«å­˜åœ¨æ¼æ´ï¼Œåˆ™ä¼šå¼•å…¥æ–°çš„å®‰å…¨é£é™©ã€‚

æ€»ä½“æ¥è¯´ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯é…ç½®ä¸å½“æˆ–webæœåŠ¡å™¨å®‰å…¨é—®é¢˜å¼•èµ·çš„é£é™©ã€‚ç”±äºä»£ç è¾ƒä¸ºç®€å•ï¼Œå¯ä»¥ç›´æ¥å®¡æŸ¥ï¼Œå­˜åœ¨æ¶æ„åé—¨çš„æ¦‚ç‡è¾ƒä½ã€‚è¯¥ä»£ç çš„ä¸»è¦ç›®çš„æ˜¯é˜²å¾¡ï¼Œè€Œéæ”»å‡»ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´çš„åŸå§‹åˆ©ç”¨æ–¹å¼æ˜¯å‘å­˜åœ¨æ¼æ´çš„ Ivanti è®¾å¤‡å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«è¿‡é•¿çš„ `X-Forwarded-For` å¤´éƒ¨æˆ–å…¶ä»–å‚æ•°ï¼Œå¯¼è‡´æ ˆç¼“å†²åŒºæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„ä»£ç ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—è®¾å¤‡ä¸Šçš„è¿œç¨‹ä»£ç æ‰§è¡Œæƒé™ï¼Œè¿›è€Œæ§åˆ¶æ•´ä¸ªç½‘ç»œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  åŠæ—¶æ›´æ–° Ivanti Connect Secure, Policy Secure, ZTA Gateways åˆ°ä¸å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  ä½¿ç”¨é˜²ç«å¢™æˆ–å…¶ä»–ç½‘ç»œå®‰å…¨è®¾å¤‡é™åˆ¶å¯¹ Ivanti è®¾å¤‡çš„è®¿é—®ã€‚
3.  å®¡æŸ¥å¹¶åŠ å›º Ivanti è®¾å¤‡çš„é…ç½®ã€‚
4.  ä½¿ç”¨æä¾›çš„ `ivantiunlocker` è„šæœ¬ä½œä¸ºä¸´æ—¶ç¼“è§£æ–¹æ¡ˆï¼Œä½†éœ€è¦ä¿®æ”¹é»˜è®¤å¯†ç å¹¶æ³¨æ„ web æœåŠ¡å™¨çš„å®‰å…¨ã€‚

**é¡¹ç›®åœ°å€:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**æ¥æº**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

## CVE-2025-22457 - Ivanti Connect Secure æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Ivanti Connect Secure < 22.7R2.6, Ivanti Policy Secure < 22.7R1.4, Ivanti ZTA Gateways < 22.8R2.2

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 95%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚è¿œç¨‹æœªè®¤è¯çš„æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å·²è¢«ç§¯æåˆ©ç”¨ã€‚POC ä»£ç æ˜¾ç¤ºéœ€è¦ Python 3.9 ç¯å¢ƒï¼Œå¹¶é€šè¿‡ `python exploit.py -h <ç›®æ ‡IP> -c '<å‘½ä»¤>'` æ–¹å¼æ‰§è¡Œå‘½ä»¤ã€‚ç„¶è€Œï¼ŒPOCä»£ç é€šè¿‡é“¾æ¥(`https://bit.ly/42tvT9m`)æä¾›ä¸‹è½½ï¼Œå¹¶ä¸”`Contact`æç¤ºè”ç³»**llussiess@exploit.in**ï¼Œæœ‰ç†ç”±æ€€ç–‘æ­¤é“¾æ¥ä¸‹è½½çš„`exploit.py`å¯èƒ½åŒ…å«æ¶æ„ä»£ç ï¼Œè¯¥é“¾æ¥ä½¿ç”¨çŸ­é“¾æ¥ï¼Œå¢åŠ äº†å®‰å…¨æ€§é£é™©ã€‚githubä¸Šçš„å›¾ç‰‡æ˜¾ç¤ºäº†ç®€è¦çš„payloadæ„é€ æ–¹å¼ï¼Œä½†æ˜¯å®é™…çš„pocæ–‡ä»¶å¹¶æ²¡æœ‰æä¾›ï¼Œè¿™å¢åŠ äº†æŠ•æ¯’é£é™©ï¼Œæ‰€ä»¥è®¤ä¸ºå­˜åœ¨æé«˜çš„æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„ç½‘ç»œè¯·æ±‚è§¦å‘æ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æä¾›çš„shellcodeæˆ–æ¶æ„å‘½ä»¤ã€‚ç”±äºæ”»å‡»å¤æ‚æ€§è¢«NVDè¯„ä¸ºHIGH,è¿™æ„å‘³ç€æ¼æ´åˆ©ç”¨å¯èƒ½éœ€è¦æ»¡è¶³ç‰¹å®šçš„æ¡ä»¶æˆ–è€…ç»•è¿‡æŸäº›å®‰å…¨æœºåˆ¶ã€‚watchtowr.comçš„æŠ¥å‘Šæåˆ°è¯¥æ¼æ´åˆ©ç”¨å—åˆ°å­—ç¬¦çš„é™åˆ¶ï¼ˆä»…é™å¥ç‚¹å’Œæ•°å­—ï¼‰ï¼Œå› æ­¤ï¼Œè®¤ä¸ºç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œè¿œç¨‹ä»£ç æ‰§è¡Œä»ç„¶å…·æœ‰è¾ƒé«˜çš„æŠ€æœ¯æŒ‘æˆ˜ã€‚

**é¡¹ç›®åœ°å€:** [llussiess/CVE-2025-22457](https://github.com/llussiess/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**æ¥æº**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡ºå¯¼è‡´RCE

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œæœªç»éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥åˆ©ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secureã€Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„æ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æ¼æ´åº“ä¿¡æ¯ï¼šæ˜ç¡®æŒ‡å‡ºæ¼æ´æ˜¯æ ˆæº¢å‡ºï¼Œä¸”æœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯è¿œç¨‹åˆ©ç”¨ã€‚
*   æœç´¢å¼•æ“ç»“æœï¼šå¤šä¸ªæ¥æºç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶è¯å®äº†å…¶å·²è¢«é‡å¤–åˆ©ç”¨ã€‚å…¶ä¸­ï¼Œrapid7ã€truesecã€arcticwolfç­‰å®‰å…¨å‚å•†ä¹Ÿå‘å¸ƒäº†ç›¸å…³åˆ†ææŠ¥å‘Šï¼Œè¯æ˜æ¼æ´çš„å­˜åœ¨ã€‚
*   æ¼æ´åˆ©ç”¨ä»£ç ï¼šæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä»…åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæè¿°äº†è¯¥POCæ‰«æå™¨çš„ç”¨é€”ï¼Œç”¨äºæ£€æµ‹Ivanti Connect Secureçš„RCEæ¼æ´ã€‚è™½ç„¶è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•åˆ©ç”¨ä»£ç ï¼Œä½†è¡¨æ˜å­˜åœ¨å¯ç”¨çš„åˆ©ç”¨POCã€‚ç”±äºæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œéš¾ä»¥ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°å¤šä¸ªæ¥æºéƒ½è¡¨æ˜æ¼æ´å·²è¢«åˆ©ç”¨ï¼Œå¯ä»¥æ¨æ–­å­˜åœ¨æœ‰æ•ˆçš„åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥ä»“åº“ç›®å‰ä»…åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶ï¼Œé£é™©è¾ƒä½ã€‚ä½†æœªæ¥ä½œè€…å¯èƒ½ä¼šæäº¤åŒ…å«æ¶æ„ä»£ç çš„commitï¼Œå› æ­¤ä»ç„¶å­˜åœ¨ä¸€å®šçš„é£é™©ã€‚ é¢„ä¼°é£é™©å€¼: 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€ç‰¹åˆ¶çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿçš„æ ˆæº¢å‡ºï¼Œä»è€Œè¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€ï¼ŒåŠ«æŒç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œæœ€ç»ˆæ‰§è¡Œæ”»å‡»è€…é¢„å…ˆè®¾å®šçš„æ¶æ„ä»£ç ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æ ¹æ®watchtowrçš„åˆ†æï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºå¤„ç†æŸäº›ç‰¹å®šè¯·æ±‚å‚æ•°çš„è¿‡ç¨‹ä¸­ã€‚æ ¹æ®å…¶ä»–æ¥æºçš„ä¿¡æ¯ï¼Œæ­¤æ¼æ´å·²ç»è¢«ä¸­å›½çš„APTç»„ç»‡ç§¯æåˆ©ç”¨ã€‚


**é¡¹ç›®åœ°å€:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**æ¥æº**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-æ ˆæº¢å‡º

**æ¼æ´ç¼–å·:** CVE-2025-22457

**æ¼æ´ç±»å‹:** æ ˆæº¢å‡º

**å½±å“åº”ç”¨:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**å±å®³ç­‰çº§:** é«˜å±ï¼Œè¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®ï¼Œç›®æ ‡å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Ivantiè®¾å¤‡

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-22457 æ˜¯ Ivanti Connect Secure, Policy Secure å’Œ ZTA Gateways ä¸­å­˜åœ¨çš„ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´ã€‚æœªç»èº«ä»½éªŒè¯çš„è¿œç¨‹æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€ç‰¹åˆ¶çš„è¯·æ±‚åˆ©ç”¨æ­¤æ¼æ´ï¼Œå®ç°åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šæ‰§è¡Œä»»æ„ä»£ç ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œæ”»å‡»å¤æ‚åº¦è¾ƒé«˜ï¼Œä½†CVSSè¯„åˆ†é«˜è¾¾9.0ï¼Œå±äºCriticalçº§åˆ«ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´å·²è¢«åœ¨é‡åˆ©ç”¨ï¼Œå¹¶ä¸”æœ‰APTç»„ç»‡å‚ä¸ã€‚PoCä»£ç åˆ©ç”¨æ–¹å¼æ˜¯é¦–å…ˆè·å–ç›®æ ‡è®¾å¤‡çš„productversionï¼Œç„¶åæ ¹æ®productversioné€‰æ‹©ç›¸åº”çš„gadgetåœ°å€, ç»“åˆ libdsplibs.so çš„åŸºåœ°å€ï¼Œæ„é€ ROPé“¾ï¼Œæœ€ç»ˆå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚PoCä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„åœ°æ–¹ï¼Œå°±æ˜¯attempt å¾ªç¯ã€‚å¾ªç¯ä¸­ä¸æ–­å°è¯•ä½¿ç”¨ä¸åŒçš„libdsplibs.soåœ°å€ï¼Œè¿™å¯èƒ½æ˜¯åœ¨å®é™…ç¯å¢ƒä¸­libdsplibs.soåœ°å€ä¸å›ºå®šé€ æˆçš„ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨å°è¯•ç‰¹å®šèŒƒå›´åœ°å€çš„å¯èƒ½æ€§ï¼Œä½†æ€»ä½“æ¥çœ‹ä¸æ„æˆæ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚PoCé¦–å…ˆä¼šåˆ›å»ºå¤šä¸ªsocketè¿æ¥, é€šè¿‡ä¿®æ”¹HTTPè¯·æ±‚å¤´æ¥è§¦å‘æ¼æ´ã€‚åˆ©ç”¨çš„å…³é”®åœ¨äºæ ˆæº¢å‡ºï¼Œè¦†ç›–è¿”å›åœ°å€ï¼Œæ‰§è¡ŒROPé“¾ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨æ˜¯å¦ç¨³å®šï¼Œå› ä¸ºéœ€è¦çŒœæµ‹ libdsplibs.so çš„åœ°å€ï¼ŒçŒœæµ‹é”™è¯¯ä¼šå¯¼è‡´æœåŠ¡å´©æºƒï¼Œä½†å¹¶ä¸æ„æˆæŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

