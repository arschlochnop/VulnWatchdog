# CVE-2025-22457

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要目标系统存在漏洞版本且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。漏洞位于处理特定类型的 HTTP 请求时，攻击者可以覆盖堆栈上的返回地址并劫持程序控制流。

**漏洞利用分析：**

1.  **漏洞成因：**  漏洞是由于程序在栈上分配的缓冲区大小不足以容纳输入数据，导致数据溢出覆盖了栈上的其他数据，包括返回地址。
2.  **利用方式：**  攻击者构造包含恶意代码的特殊请求，该请求会导致栈溢出，覆盖返回地址，使其指向攻击者控制的代码（例如，ROP链）。
3.  **POC有效性：** 提供的ruby脚本是一个有效的POC，它实现了利用该漏洞的步骤。 该脚本首先获取目标 Ivanti 设备的 productversion。 然后根据该版本，使用预定义的偏移量和gadget地址，来精心构造溢出数据，覆盖返回地址，执行远程代码。 该脚本使用 HTTP 请求发送恶意数据。 该 POC 包含 brute force libdsplibs.so 的地址功能, 提高漏洞利用的成功概率。
4.  **投毒风险评估：** 该代码的主要目的是利用漏洞，而非进行恶意投毒。脚本尝试建立反向shell连接到攻击者的机器，实现远程代码执行，这是漏洞利用的常见手法，并非后门代码。但依然需要注意，任何未经验证的第三方代码都存在潜在风险。综合评估，投毒风险较低，约为1%。主要风险可能来源于攻击者利用该POC进行攻击活动，而非POC本身包含恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**来源**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-堆栈缓冲区溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA gateways 中存在的堆栈缓冲区溢出漏洞。远程未经身份验证的攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2025-22457是一个关键漏洞，已被积极利用。 搜索结果表明，多个安全机构（如Mandiant、Rapid7、CISA）都发布了关于该漏洞的报告，并确认了该漏洞在野外被利用的事实。提供的PoC代码包括Python脚本和Metasploit模块，表明该漏洞具有较高的可利用性。 然而，需要注意的是，watchtowr.labs的搜索结果中提到利用X-Forwarded-For头可能不可行（受限于字符）。 但总体上，由于存在公开可用的PoC和在野利用报告，漏洞的有效性较高。

**投毒风险分析：**
提供的PoC下载链接指向一个短链接（bit.ly），这本身就存在一定的风险，因为无法直接确定链接指向的文件的真实性和安全性。虽然PoC说明中声明“yet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.”暗示PoC的稀缺性,存在钓鱼嫌疑，但是根据CISA的报告该漏洞已经被利用，所以这一句话的可信度需要降低。
README.md文件内容表明包含Python脚本和Metasploit模块，增加了分析复杂性。因为Metasploit模块可能包含复杂恶意载荷，通过分析短链接的下载链接（若可获得）和详细的代码行为分析可以较为准确判断投毒风险，但目前信息有限。假设下载的文件中存在被篡改的代码，例如植入后门或恶意载荷，则存在投毒风险。但鉴于该漏洞影响较大且在野利用，公开的PoC很可能已经被安全研究人员分析过，因此投毒代码被发现的可能性较高。综合考虑，给出60%的投毒风险评估。

**利用方式：**
该漏洞是堆栈缓冲区溢出，攻击者通过发送特制的网络请求，导致缓冲区溢出，覆盖堆栈上的返回地址或其他关键数据，从而劫持程序的控制流，最终执行任意代码。PoC利用可能涉及到以下步骤：

1.  发送包含恶意payload的HTTP请求，通常利用`X-Forwarded-For` header (但根据一部分搜索结果该方式可能不可行，具体情况需要进一步验证)。
2.  Payload溢出堆栈缓冲区，覆盖返回地址。
3.  返回地址被替换为攻击者控制的地址，指向 shellcode 或 ROP 链。
4.  执行 shellcode 或 ROP 链，实现远程代码执行。

由于此漏洞无需身份验证，攻击者可以远程直接发起攻击。

**项目地址:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**来源**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是一个存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，从而在目标设备上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（特别是Rapid7的分析以及attackerkb的评估）和提供的PoC代码，可以确定该漏洞是有效的。PoC代码本身提供了针对易受攻击的 Ivanti Connect Secure 目标 (版本 22.7r2.4) 的利用示例，包括 ASLR 绕过和获取反向 shell。搜索结果也表明该漏洞已被野外利用 (UNC5221, 中国背景的威胁行为者)。

**投毒风险：**

PoC代码的 `README.md` 文件中包含完整的利用说明和参数解释，结构清晰，目的是为了方便用户理解和复现漏洞。该PoC利用的是栈溢出漏洞，通过控制返回地址来执行恶意代码，获取反向shell。虽然利用本身会造成系统损害，但代码本身没有发现故意引入的恶意行为或者后门。

投毒风险评估为5%。考虑到公开 PoC 的性质，作者可能试图通过微妙的修改引入后门，例如，虽然没有明显的迹象,例如将反向 shell 连接到未知 IP 地址或执行其他未经授权的操作，但仍然存在一些可能性。例如，shellcode 可能会被修改为包含额外的恶意操作，或者依赖项可能被篡改。 但PoC的重心放在演示漏洞利用上。

**利用方式：**

1.  **漏洞定位：** 栈溢出漏洞存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 的特定版本中。
2.  **攻击入口：** 远程、未经身份验证的网络访问。
3.  **漏洞利用：** 攻击者发送特制的请求，利用栈溢出覆盖返回地址，执行恶意代码。
4.  **ASLR绕过：** PoC代码使用暴力破解ASLR来定位`libdsplibs.so`的基址，或者通过参数 `--libdsplibs` 直接指定基址。
5.  **Payload：** PoC代码使用反向 shell 作为 payload，允许攻击者在目标系统上执行命令。
6.  **控制系统：** 成功利用漏洞后，攻击者可以获得目标系统的控制权（如，获得shell），从而可能进行数据窃取、恶意软件安装或其他恶意活动。

**项目地址:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**来源**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，漏洞存在于未授权的端点。

**POC 可用性:** 是，但提供的代码并非直接的exploit，而是缓解措施

**投毒风险:** 10%

## 详情

CVE-2025-22457是一个Ivanti Connect Secure, Policy Secure, ZTA Gateways中的栈缓冲区溢出漏洞。未经验证的远程攻击者可以利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2025-22457 漏洞是真实存在的，并且已经被积极利用。提供的代码 `ivantiunlocker` 并非漏洞利用代码，而是一种缓解措施，通过在 Ivanti 设备前设置一个简单的 web 认证网关，限制对 Ivanti 设备的访问。原始漏洞利用是通过发送构造的HTTP请求，利用栈缓冲区溢出执行代码。

**投毒风险：**

`unlock_web.py` 本身的功能是做一个简易的web认证，增加了一层访问控制。但是，`PASSWORD = "yoursuperduperpassword"`  默认密码过于简单，如果使用者不修改，存在被绕过的风险。而且，该脚本将日志记录到 `/var/log/ivantiunlocker.log`，可能导致信息泄露，比如IP地址等。此外，如果web服务器本身存在漏洞，则会引入新的安全风险。

总体来说，投毒风险较低，主要是配置不当或web服务器安全问题引起的风险。由于代码较为简单，可以直接审查，存在恶意后门的概率较低。该代码的主要目的是防御，而非攻击。

**利用方式：**

该漏洞的原始利用方式是向存在漏洞的 Ivanti 设备发送特制的 HTTP 请求，其中包含过长的 `X-Forwarded-For` 头部或其他参数，导致栈缓冲区溢出，覆盖返回地址，从而执行攻击者控制的代码。攻击者可以利用它来获得设备上的远程代码执行权限，进而控制整个网络。

**缓解措施：**
1.  及时更新 Ivanti Connect Secure, Policy Secure, ZTA Gateways 到不受影响的版本。
2.  使用防火墙或其他网络安全设备限制对 Ivanti 设备的访问。
3.  审查并加固 Ivanti 设备的配置。
4.  使用提供的 `ivantiunlocker` 脚本作为临时缓解方案，但需要修改默认密码并注意 web 服务器的安全。

**项目地址:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**来源**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要目标系统存在漏洞版本且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。漏洞位于处理特定类型的 HTTP 请求时，攻击者可以覆盖堆栈上的返回地址并劫持程序控制流。

**漏洞利用分析：**

1.  **漏洞成因：**  漏洞是由于程序在栈上分配的缓冲区大小不足以容纳输入数据，导致数据溢出覆盖了栈上的其他数据，包括返回地址。
2.  **利用方式：**  攻击者构造包含恶意代码的特殊请求，该请求会导致栈溢出，覆盖返回地址，使其指向攻击者控制的代码（例如，ROP链）。
3.  **POC有效性：** 提供的ruby脚本是一个有效的POC，它实现了利用该漏洞的步骤。 该脚本首先获取目标 Ivanti 设备的 productversion。 然后根据该版本，使用预定义的偏移量和gadget地址，来精心构造溢出数据，覆盖返回地址，执行远程代码。 该脚本使用 HTTP 请求发送恶意数据。 该 POC 包含 brute force libdsplibs.so 的地址功能, 提高漏洞利用的成功概率。
4.  **投毒风险评估：** 该代码的主要目的是利用漏洞，而非进行恶意投毒。脚本尝试建立反向shell连接到攻击者的机器，实现远程代码执行，这是漏洞利用的常见手法，并非后门代码。但依然需要注意，任何未经验证的第三方代码都存在潜在风险。综合评估，投毒风险较低，约为1%。主要风险可能来源于攻击者利用该POC进行攻击活动，而非POC本身包含恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**来源**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-堆栈缓冲区溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA gateways 中存在的堆栈缓冲区溢出漏洞。远程未经身份验证的攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2025-22457是一个关键漏洞，已被积极利用。 搜索结果表明，多个安全机构（如Mandiant、Rapid7、CISA）都发布了关于该漏洞的报告，并确认了该漏洞在野外被利用的事实。提供的PoC代码包括Python脚本和Metasploit模块，表明该漏洞具有较高的可利用性。 然而，需要注意的是，watchtowr.labs的搜索结果中提到利用X-Forwarded-For头可能不可行（受限于字符）。 但总体上，由于存在公开可用的PoC和在野利用报告，漏洞的有效性较高。

**投毒风险分析：**
提供的PoC下载链接指向一个短链接（bit.ly），这本身就存在一定的风险，因为无法直接确定链接指向的文件的真实性和安全性。虽然PoC说明中声明“yet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.”暗示PoC的稀缺性,存在钓鱼嫌疑，但是根据CISA的报告该漏洞已经被利用，所以这一句话的可信度需要降低。
README.md文件内容表明包含Python脚本和Metasploit模块，增加了分析复杂性。因为Metasploit模块可能包含复杂恶意载荷，通过分析短链接的下载链接（若可获得）和详细的代码行为分析可以较为准确判断投毒风险，但目前信息有限。假设下载的文件中存在被篡改的代码，例如植入后门或恶意载荷，则存在投毒风险。但鉴于该漏洞影响较大且在野利用，公开的PoC很可能已经被安全研究人员分析过，因此投毒代码被发现的可能性较高。综合考虑，给出60%的投毒风险评估。

**利用方式：**
该漏洞是堆栈缓冲区溢出，攻击者通过发送特制的网络请求，导致缓冲区溢出，覆盖堆栈上的返回地址或其他关键数据，从而劫持程序的控制流，最终执行任意代码。PoC利用可能涉及到以下步骤：

1.  发送包含恶意payload的HTTP请求，通常利用`X-Forwarded-For` header (但根据一部分搜索结果该方式可能不可行，具体情况需要进一步验证)。
2.  Payload溢出堆栈缓冲区，覆盖返回地址。
3.  返回地址被替换为攻击者控制的地址，指向 shellcode 或 ROP 链。
4.  执行 shellcode 或 ROP 链，实现远程代码执行。

由于此漏洞无需身份验证，攻击者可以远程直接发起攻击。

**项目地址:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**来源**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是一个存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，从而在目标设备上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（特别是Rapid7的分析以及attackerkb的评估）和提供的PoC代码，可以确定该漏洞是有效的。PoC代码本身提供了针对易受攻击的 Ivanti Connect Secure 目标 (版本 22.7r2.4) 的利用示例，包括 ASLR 绕过和获取反向 shell。搜索结果也表明该漏洞已被野外利用 (UNC5221, 中国背景的威胁行为者)。

**投毒风险：**

PoC代码的 `README.md` 文件中包含完整的利用说明和参数解释，结构清晰，目的是为了方便用户理解和复现漏洞。该PoC利用的是栈溢出漏洞，通过控制返回地址来执行恶意代码，获取反向shell。虽然利用本身会造成系统损害，但代码本身没有发现故意引入的恶意行为或者后门。

投毒风险评估为5%。考虑到公开 PoC 的性质，作者可能试图通过微妙的修改引入后门，例如，虽然没有明显的迹象,例如将反向 shell 连接到未知 IP 地址或执行其他未经授权的操作，但仍然存在一些可能性。例如，shellcode 可能会被修改为包含额外的恶意操作，或者依赖项可能被篡改。 但PoC的重心放在演示漏洞利用上。

**利用方式：**

1.  **漏洞定位：** 栈溢出漏洞存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 的特定版本中。
2.  **攻击入口：** 远程、未经身份验证的网络访问。
3.  **漏洞利用：** 攻击者发送特制的请求，利用栈溢出覆盖返回地址，执行恶意代码。
4.  **ASLR绕过：** PoC代码使用暴力破解ASLR来定位`libdsplibs.so`的基址，或者通过参数 `--libdsplibs` 直接指定基址。
5.  **Payload：** PoC代码使用反向 shell 作为 payload，允许攻击者在目标系统上执行命令。
6.  **控制系统：** 成功利用漏洞后，攻击者可以获得目标系统的控制权（如，获得shell），从而可能进行数据窃取、恶意软件安装或其他恶意活动。

**项目地址:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**来源**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，漏洞存在于未授权的端点。

**POC 可用性:** 是，但提供的代码并非直接的exploit，而是缓解措施

**投毒风险:** 10%

## 详情

CVE-2025-22457是一个Ivanti Connect Secure, Policy Secure, ZTA Gateways中的栈缓冲区溢出漏洞。未经验证的远程攻击者可以利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2025-22457 漏洞是真实存在的，并且已经被积极利用。提供的代码 `ivantiunlocker` 并非漏洞利用代码，而是一种缓解措施，通过在 Ivanti 设备前设置一个简单的 web 认证网关，限制对 Ivanti 设备的访问。原始漏洞利用是通过发送构造的HTTP请求，利用栈缓冲区溢出执行代码。

**投毒风险：**

`unlock_web.py` 本身的功能是做一个简易的web认证，增加了一层访问控制。但是，`PASSWORD = "yoursuperduperpassword"`  默认密码过于简单，如果使用者不修改，存在被绕过的风险。而且，该脚本将日志记录到 `/var/log/ivantiunlocker.log`，可能导致信息泄露，比如IP地址等。此外，如果web服务器本身存在漏洞，则会引入新的安全风险。

总体来说，投毒风险较低，主要是配置不当或web服务器安全问题引起的风险。由于代码较为简单，可以直接审查，存在恶意后门的概率较低。该代码的主要目的是防御，而非攻击。

**利用方式：**

该漏洞的原始利用方式是向存在漏洞的 Ivanti 设备发送特制的 HTTP 请求，其中包含过长的 `X-Forwarded-For` 头部或其他参数，导致栈缓冲区溢出，覆盖返回地址，从而执行攻击者控制的代码。攻击者可以利用它来获得设备上的远程代码执行权限，进而控制整个网络。

**缓解措施：**
1.  及时更新 Ivanti Connect Secure, Policy Secure, ZTA Gateways 到不受影响的版本。
2.  使用防火墙或其他网络安全设备限制对 Ivanti 设备的访问。
3.  审查并加固 Ivanti 设备的配置。
4.  使用提供的 `ivantiunlocker` 脚本作为临时缓解方案，但需要修改默认密码并注意 web 服务器的安全。

**项目地址:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**来源**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要目标系统存在漏洞版本且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。漏洞位于处理特定类型的 HTTP 请求时，攻击者可以覆盖堆栈上的返回地址并劫持程序控制流。

**漏洞利用分析：**

1.  **漏洞成因：**  漏洞是由于程序在栈上分配的缓冲区大小不足以容纳输入数据，导致数据溢出覆盖了栈上的其他数据，包括返回地址。
2.  **利用方式：**  攻击者构造包含恶意代码的特殊请求，该请求会导致栈溢出，覆盖返回地址，使其指向攻击者控制的代码（例如，ROP链）。
3.  **POC有效性：** 提供的ruby脚本是一个有效的POC，它实现了利用该漏洞的步骤。 该脚本首先获取目标 Ivanti 设备的 productversion。 然后根据该版本，使用预定义的偏移量和gadget地址，来精心构造溢出数据，覆盖返回地址，执行远程代码。 该脚本使用 HTTP 请求发送恶意数据。 该 POC 包含 brute force libdsplibs.so 的地址功能, 提高漏洞利用的成功概率。
4.  **投毒风险评估：** 该代码的主要目的是利用漏洞，而非进行恶意投毒。脚本尝试建立反向shell连接到攻击者的机器，实现远程代码执行，这是漏洞利用的常见手法，并非后门代码。但依然需要注意，任何未经验证的第三方代码都存在潜在风险。综合评估，投毒风险较低，约为1%。主要风险可能来源于攻击者利用该POC进行攻击活动，而非POC本身包含恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**来源**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-堆栈缓冲区溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA gateways 中存在的堆栈缓冲区溢出漏洞。远程未经身份验证的攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2025-22457是一个关键漏洞，已被积极利用。 搜索结果表明，多个安全机构（如Mandiant、Rapid7、CISA）都发布了关于该漏洞的报告，并确认了该漏洞在野外被利用的事实。提供的PoC代码包括Python脚本和Metasploit模块，表明该漏洞具有较高的可利用性。 然而，需要注意的是，watchtowr.labs的搜索结果中提到利用X-Forwarded-For头可能不可行（受限于字符）。 但总体上，由于存在公开可用的PoC和在野利用报告，漏洞的有效性较高。

**投毒风险分析：**
提供的PoC下载链接指向一个短链接（bit.ly），这本身就存在一定的风险，因为无法直接确定链接指向的文件的真实性和安全性。虽然PoC说明中声明“yet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.”暗示PoC的稀缺性,存在钓鱼嫌疑，但是根据CISA的报告该漏洞已经被利用，所以这一句话的可信度需要降低。
README.md文件内容表明包含Python脚本和Metasploit模块，增加了分析复杂性。因为Metasploit模块可能包含复杂恶意载荷，通过分析短链接的下载链接（若可获得）和详细的代码行为分析可以较为准确判断投毒风险，但目前信息有限。假设下载的文件中存在被篡改的代码，例如植入后门或恶意载荷，则存在投毒风险。但鉴于该漏洞影响较大且在野利用，公开的PoC很可能已经被安全研究人员分析过，因此投毒代码被发现的可能性较高。综合考虑，给出60%的投毒风险评估。

**利用方式：**
该漏洞是堆栈缓冲区溢出，攻击者通过发送特制的网络请求，导致缓冲区溢出，覆盖堆栈上的返回地址或其他关键数据，从而劫持程序的控制流，最终执行任意代码。PoC利用可能涉及到以下步骤：

1.  发送包含恶意payload的HTTP请求，通常利用`X-Forwarded-For` header (但根据一部分搜索结果该方式可能不可行，具体情况需要进一步验证)。
2.  Payload溢出堆栈缓冲区，覆盖返回地址。
3.  返回地址被替换为攻击者控制的地址，指向 shellcode 或 ROP 链。
4.  执行 shellcode 或 ROP 链，实现远程代码执行。

由于此漏洞无需身份验证，攻击者可以远程直接发起攻击。

**项目地址:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**来源**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是一个存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，从而在目标设备上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（特别是Rapid7的分析以及attackerkb的评估）和提供的PoC代码，可以确定该漏洞是有效的。PoC代码本身提供了针对易受攻击的 Ivanti Connect Secure 目标 (版本 22.7r2.4) 的利用示例，包括 ASLR 绕过和获取反向 shell。搜索结果也表明该漏洞已被野外利用 (UNC5221, 中国背景的威胁行为者)。

**投毒风险：**

PoC代码的 `README.md` 文件中包含完整的利用说明和参数解释，结构清晰，目的是为了方便用户理解和复现漏洞。该PoC利用的是栈溢出漏洞，通过控制返回地址来执行恶意代码，获取反向shell。虽然利用本身会造成系统损害，但代码本身没有发现故意引入的恶意行为或者后门。

投毒风险评估为5%。考虑到公开 PoC 的性质，作者可能试图通过微妙的修改引入后门，例如，虽然没有明显的迹象,例如将反向 shell 连接到未知 IP 地址或执行其他未经授权的操作，但仍然存在一些可能性。例如，shellcode 可能会被修改为包含额外的恶意操作，或者依赖项可能被篡改。 但PoC的重心放在演示漏洞利用上。

**利用方式：**

1.  **漏洞定位：** 栈溢出漏洞存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 的特定版本中。
2.  **攻击入口：** 远程、未经身份验证的网络访问。
3.  **漏洞利用：** 攻击者发送特制的请求，利用栈溢出覆盖返回地址，执行恶意代码。
4.  **ASLR绕过：** PoC代码使用暴力破解ASLR来定位`libdsplibs.so`的基址，或者通过参数 `--libdsplibs` 直接指定基址。
5.  **Payload：** PoC代码使用反向 shell 作为 payload，允许攻击者在目标系统上执行命令。
6.  **控制系统：** 成功利用漏洞后，攻击者可以获得目标系统的控制权（如，获得shell），从而可能进行数据窃取、恶意软件安装或其他恶意活动。

**项目地址:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**来源**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，漏洞存在于未授权的端点。

**POC 可用性:** 是，但提供的代码并非直接的exploit，而是缓解措施

**投毒风险:** 10%

## 详情

CVE-2025-22457是一个Ivanti Connect Secure, Policy Secure, ZTA Gateways中的栈缓冲区溢出漏洞。未经验证的远程攻击者可以利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2025-22457 漏洞是真实存在的，并且已经被积极利用。提供的代码 `ivantiunlocker` 并非漏洞利用代码，而是一种缓解措施，通过在 Ivanti 设备前设置一个简单的 web 认证网关，限制对 Ivanti 设备的访问。原始漏洞利用是通过发送构造的HTTP请求，利用栈缓冲区溢出执行代码。

**投毒风险：**

`unlock_web.py` 本身的功能是做一个简易的web认证，增加了一层访问控制。但是，`PASSWORD = "yoursuperduperpassword"`  默认密码过于简单，如果使用者不修改，存在被绕过的风险。而且，该脚本将日志记录到 `/var/log/ivantiunlocker.log`，可能导致信息泄露，比如IP地址等。此外，如果web服务器本身存在漏洞，则会引入新的安全风险。

总体来说，投毒风险较低，主要是配置不当或web服务器安全问题引起的风险。由于代码较为简单，可以直接审查，存在恶意后门的概率较低。该代码的主要目的是防御，而非攻击。

**利用方式：**

该漏洞的原始利用方式是向存在漏洞的 Ivanti 设备发送特制的 HTTP 请求，其中包含过长的 `X-Forwarded-For` 头部或其他参数，导致栈缓冲区溢出，覆盖返回地址，从而执行攻击者控制的代码。攻击者可以利用它来获得设备上的远程代码执行权限，进而控制整个网络。

**缓解措施：**
1.  及时更新 Ivanti Connect Secure, Policy Secure, ZTA Gateways 到不受影响的版本。
2.  使用防火墙或其他网络安全设备限制对 Ivanti 设备的访问。
3.  审查并加固 Ivanti 设备的配置。
4.  使用提供的 `ivantiunlocker` 脚本作为临时缓解方案，但需要修改默认密码并注意 web 服务器的安全。

**项目地址:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**来源**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

# CVE-2025-22457

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md](../2025/CVE-2025-22457-B1ack4sh_Blackash-CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要目标系统存在漏洞版本且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。漏洞位于处理特定类型的 HTTP 请求时，攻击者可以覆盖堆栈上的返回地址并劫持程序控制流。

**漏洞利用分析：**

1.  **漏洞成因：**  漏洞是由于程序在栈上分配的缓冲区大小不足以容纳输入数据，导致数据溢出覆盖了栈上的其他数据，包括返回地址。
2.  **利用方式：**  攻击者构造包含恶意代码的特殊请求，该请求会导致栈溢出，覆盖返回地址，使其指向攻击者控制的代码（例如，ROP链）。
3.  **POC有效性：** 提供的ruby脚本是一个有效的POC，它实现了利用该漏洞的步骤。 该脚本首先获取目标 Ivanti 设备的 productversion。 然后根据该版本，使用预定义的偏移量和gadget地址，来精心构造溢出数据，覆盖返回地址，执行远程代码。 该脚本使用 HTTP 请求发送恶意数据。 该 POC 包含 brute force libdsplibs.so 的地址功能, 提高漏洞利用的成功概率。
4.  **投毒风险评估：** 该代码的主要目的是利用漏洞，而非进行恶意投毒。脚本尝试建立反向shell连接到攻击者的机器，实现远程代码执行，这是漏洞利用的常见手法，并非后门代码。但依然需要注意，任何未经验证的第三方代码都存在潜在风险。综合评估，投毒风险较低，约为1%。主要风险可能来源于攻击者利用该POC进行攻击活动，而非POC本身包含恶意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22457](https://github.com/B1ack4sh/Blackash-CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #2

**来源**: [CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md](../2025/CVE-2025-22457-N4SL1_CVE-2025-22457-PoC.md)

## CVE-2025-22457-Ivanti Connect Secure-堆栈缓冲区溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA gateways 中存在的堆栈缓冲区溢出漏洞。远程未经身份验证的攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2025-22457是一个关键漏洞，已被积极利用。 搜索结果表明，多个安全机构（如Mandiant、Rapid7、CISA）都发布了关于该漏洞的报告，并确认了该漏洞在野外被利用的事实。提供的PoC代码包括Python脚本和Metasploit模块，表明该漏洞具有较高的可利用性。 然而，需要注意的是，watchtowr.labs的搜索结果中提到利用X-Forwarded-For头可能不可行（受限于字符）。 但总体上，由于存在公开可用的PoC和在野利用报告，漏洞的有效性较高。

**投毒风险分析：**
提供的PoC下载链接指向一个短链接（bit.ly），这本身就存在一定的风险，因为无法直接确定链接指向的文件的真实性和安全性。虽然PoC说明中声明“yet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.”暗示PoC的稀缺性,存在钓鱼嫌疑，但是根据CISA的报告该漏洞已经被利用，所以这一句话的可信度需要降低。
README.md文件内容表明包含Python脚本和Metasploit模块，增加了分析复杂性。因为Metasploit模块可能包含复杂恶意载荷，通过分析短链接的下载链接（若可获得）和详细的代码行为分析可以较为准确判断投毒风险，但目前信息有限。假设下载的文件中存在被篡改的代码，例如植入后门或恶意载荷，则存在投毒风险。但鉴于该漏洞影响较大且在野利用，公开的PoC很可能已经被安全研究人员分析过，因此投毒代码被发现的可能性较高。综合考虑，给出60%的投毒风险评估。

**利用方式：**
该漏洞是堆栈缓冲区溢出，攻击者通过发送特制的网络请求，导致缓冲区溢出，覆盖堆栈上的返回地址或其他关键数据，从而劫持程序的控制流，最终执行任意代码。PoC利用可能涉及到以下步骤：

1.  发送包含恶意payload的HTTP请求，通常利用`X-Forwarded-For` header (但根据一部分搜索结果该方式可能不可行，具体情况需要进一步验证)。
2.  Payload溢出堆栈缓冲区，覆盖返回地址。
3.  返回地址被替换为攻击者控制的地址，指向 shellcode 或 ROP 链。
4.  执行 shellcode 或 ROP 链，实现远程代码执行。

由于此漏洞无需身份验证，攻击者可以远程直接发起攻击。

**项目地址:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #3

**来源**: [CVE-2025-22457-TRone-ux_CVE-2025-22457.md](../2025/CVE-2025-22457-TRone-ux_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是一个存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，从而在目标设备上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（特别是Rapid7的分析以及attackerkb的评估）和提供的PoC代码，可以确定该漏洞是有效的。PoC代码本身提供了针对易受攻击的 Ivanti Connect Secure 目标 (版本 22.7r2.4) 的利用示例，包括 ASLR 绕过和获取反向 shell。搜索结果也表明该漏洞已被野外利用 (UNC5221, 中国背景的威胁行为者)。

**投毒风险：**

PoC代码的 `README.md` 文件中包含完整的利用说明和参数解释，结构清晰，目的是为了方便用户理解和复现漏洞。该PoC利用的是栈溢出漏洞，通过控制返回地址来执行恶意代码，获取反向shell。虽然利用本身会造成系统损害，但代码本身没有发现故意引入的恶意行为或者后门。

投毒风险评估为5%。考虑到公开 PoC 的性质，作者可能试图通过微妙的修改引入后门，例如，虽然没有明显的迹象,例如将反向 shell 连接到未知 IP 地址或执行其他未经授权的操作，但仍然存在一些可能性。例如，shellcode 可能会被修改为包含额外的恶意操作，或者依赖项可能被篡改。 但PoC的重心放在演示漏洞利用上。

**利用方式：**

1.  **漏洞定位：** 栈溢出漏洞存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 的特定版本中。
2.  **攻击入口：** 远程、未经身份验证的网络访问。
3.  **漏洞利用：** 攻击者发送特制的请求，利用栈溢出覆盖返回地址，执行恶意代码。
4.  **ASLR绕过：** PoC代码使用暴力破解ASLR来定位`libdsplibs.so`的基址，或者通过参数 `--libdsplibs` 直接指定基址。
5.  **Payload：** PoC代码使用反向 shell 作为 payload，允许攻击者在目标系统上执行命令。
6.  **控制系统：** 成功利用漏洞后，攻击者可以获得目标系统的控制权（如，获得shell），从而可能进行数据窃取、恶意软件安装或其他恶意活动。

**项目地址:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #4

**来源**: [CVE-2025-22457-Vinylrider_ivantiunlocker.md](../2025/CVE-2025-22457-Vinylrider_ivantiunlocker.md)

## CVE-2025-22457-Ivanti Connect Secure-Stack Buffer Overflow

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，漏洞存在于未授权的端点。

**POC 可用性:** 是，但提供的代码并非直接的exploit，而是缓解措施

**投毒风险:** 10%

## 详情

CVE-2025-22457是一个Ivanti Connect Secure, Policy Secure, ZTA Gateways中的栈缓冲区溢出漏洞。未经验证的远程攻击者可以利用此漏洞执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2025-22457 漏洞是真实存在的，并且已经被积极利用。提供的代码 `ivantiunlocker` 并非漏洞利用代码，而是一种缓解措施，通过在 Ivanti 设备前设置一个简单的 web 认证网关，限制对 Ivanti 设备的访问。原始漏洞利用是通过发送构造的HTTP请求，利用栈缓冲区溢出执行代码。

**投毒风险：**

`unlock_web.py` 本身的功能是做一个简易的web认证，增加了一层访问控制。但是，`PASSWORD = "yoursuperduperpassword"`  默认密码过于简单，如果使用者不修改，存在被绕过的风险。而且，该脚本将日志记录到 `/var/log/ivantiunlocker.log`，可能导致信息泄露，比如IP地址等。此外，如果web服务器本身存在漏洞，则会引入新的安全风险。

总体来说，投毒风险较低，主要是配置不当或web服务器安全问题引起的风险。由于代码较为简单，可以直接审查，存在恶意后门的概率较低。该代码的主要目的是防御，而非攻击。

**利用方式：**

该漏洞的原始利用方式是向存在漏洞的 Ivanti 设备发送特制的 HTTP 请求，其中包含过长的 `X-Forwarded-For` 头部或其他参数，导致栈缓冲区溢出，覆盖返回地址，从而执行攻击者控制的代码。攻击者可以利用它来获得设备上的远程代码执行权限，进而控制整个网络。

**缓解措施：**
1.  及时更新 Ivanti Connect Secure, Policy Secure, ZTA Gateways 到不受影响的版本。
2.  使用防火墙或其他网络安全设备限制对 Ivanti 设备的访问。
3.  审查并加固 Ivanti 设备的配置。
4.  使用提供的 `ivantiunlocker` 脚本作为临时缓解方案，但需要修改默认密码并注意 web 服务器的安全。

**项目地址:** [Vinylrider/ivantiunlocker](https://github.com/Vinylrider/ivantiunlocker)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #5

**来源**: [CVE-2025-22457-llussiess_CVE-2025-22457.md](../2025/CVE-2025-22457-llussiess_CVE-2025-22457.md)

## CVE-2025-22457 - Ivanti Connect Secure 栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Ivanti Connect Secure < 22.7R2.6, Ivanti Policy Secure < 22.7R1.4, Ivanti ZTA Gateways < 22.8R2.2

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。远程未认证的攻击者可以通过发送特制的请求利用此漏洞在目标系统上执行任意代码。根据搜索引擎结果，该漏洞已被积极利用。POC 代码显示需要 Python 3.9 环境，并通过 `python exploit.py -h <目标IP> -c '<命令>'` 方式执行命令。然而，POC代码通过链接(`https://bit.ly/42tvT9m`)提供下载，并且`Contact`提示联系**llussiess@exploit.in**，有理由怀疑此链接下载的`exploit.py`可能包含恶意代码，该链接使用短链接，增加了安全性风险。github上的图片显示了简要的payload构造方式，但是实际的poc文件并没有提供，这增加了投毒风险，所以认为存在极高的投毒风险。利用方式是通过构造特定的网络请求触发栈溢出，覆盖返回地址，从而执行攻击者提供的shellcode或恶意命令。由于攻击复杂性被NVD评为HIGH,这意味着漏洞利用可能需要满足特定的条件或者绕过某些安全机制。watchtowr.com的报告提到该漏洞利用受到字符的限制（仅限句点和数字），因此，认为直接利用该漏洞进行远程代码执行仍然具有较高的技术挑战。

**项目地址:** [llussiess/CVE-2025-22457](https://github.com/llussiess/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #6

**来源**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出导致RCE

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经验证的远程攻击者可以利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性评估：**

*   漏洞库信息：明确指出漏洞是栈溢出，且未经身份验证的攻击者可远程利用。
*   搜索引擎结果：多个来源确认了此漏洞的存在，并证实了其已被野外利用。其中，rapid7、truesec、arcticwolf等安全厂商也发布了相关分析报告，证明漏洞的存在。
*   漏洞利用代码：提供的漏洞利用代码仓库仅包含一个README.md文件，描述了该POC扫描器的用途，用于检测Ivanti Connect Secure的RCE漏洞。虽然该文件本身不包含任何利用代码，但表明存在可用的利用POC。由于没有实际的利用代码，难以直接评估其有效性，但考虑到多个来源都表明漏洞已被利用，可以推断存在有效的利用方式。

**投毒风险：**

该仓库目前仅包含一个 README.md 文件，风险较低。但未来作者可能会提交包含恶意代码的commit，因此仍然存在一定的风险。 预估风险值: 10%。

**利用方式：**

该漏洞是一个栈溢出漏洞，攻击者通过发送特制的网络请求，导致目标系统的栈溢出，从而覆盖栈上的返回地址，劫持程序执行流程，最终执行攻击者预先设定的恶意代码，实现远程代码执行。根据watchtowr的分析，漏洞可能存在于处理某些特定请求参数的过程中。根据其他来源的信息，此漏洞已经被中国的APT组织积极利用。


**项目地址:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**来源**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，目标存在漏洞版本的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure, Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，实现在目标系统上执行任意代码。根据漏洞库信息，攻击复杂度较高，但CVSS评分高达9.0，属于Critical级别。搜索引擎结果表明，该漏洞已被在野利用，并且有APT组织参与。PoC代码利用方式是首先获取目标设备的productversion，然后根据productversion选择相应的gadget地址, 结合 libdsplibs.so 的基地址，构造ROP链，最终实现远程代码执行。PoC代码中存在一个可疑的地方，就是attempt 循环。循环中不断尝试使用不同的libdsplibs.so地址，这可能是在实际环境中libdsplibs.so地址不固定造成的，也可能存在尝试特定范围地址的可能性，但总体来看不构成明显的投毒行为。PoC首先会创建多个socket连接, 通过修改HTTP请求头来触发漏洞。利用的关键在于栈溢出，覆盖返回地址，执行ROP链。投毒风险较低，主要风险在于利用是否稳定，因为需要猜测 libdsplibs.so 的地址，猜测错误会导致服务崩溃，但并不构成投毒。

**项目地址:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**来源**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出导致RCE

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经验证的远程攻击者可以利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性评估：**

*   漏洞库信息：明确指出漏洞是栈溢出，且未经身份验证的攻击者可远程利用。
*   搜索引擎结果：多个来源确认了此漏洞的存在，并证实了其已被野外利用。其中，rapid7、truesec、arcticwolf等安全厂商也发布了相关分析报告，证明漏洞的存在。
*   漏洞利用代码：提供的漏洞利用代码仓库仅包含一个README.md文件，描述了该POC扫描器的用途，用于检测Ivanti Connect Secure的RCE漏洞。虽然该文件本身不包含任何利用代码，但表明存在可用的利用POC。由于没有实际的利用代码，难以直接评估其有效性，但考虑到多个来源都表明漏洞已被利用，可以推断存在有效的利用方式。

**投毒风险：**

该仓库目前仅包含一个 README.md 文件，风险较低。但未来作者可能会提交包含恶意代码的commit，因此仍然存在一定的风险。 预估风险值: 10%。

**利用方式：**

该漏洞是一个栈溢出漏洞，攻击者通过发送特制的网络请求，导致目标系统的栈溢出，从而覆盖栈上的返回地址，劫持程序执行流程，最终执行攻击者预先设定的恶意代码，实现远程代码执行。根据watchtowr的分析，漏洞可能存在于处理某些特定请求参数的过程中。根据其他来源的信息，此漏洞已经被中国的APT组织积极利用。


**项目地址:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**来源**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，目标存在漏洞版本的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure, Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，实现在目标系统上执行任意代码。根据漏洞库信息，攻击复杂度较高，但CVSS评分高达9.0，属于Critical级别。搜索引擎结果表明，该漏洞已被在野利用，并且有APT组织参与。PoC代码利用方式是首先获取目标设备的productversion，然后根据productversion选择相应的gadget地址, 结合 libdsplibs.so 的基地址，构造ROP链，最终实现远程代码执行。PoC代码中存在一个可疑的地方，就是attempt 循环。循环中不断尝试使用不同的libdsplibs.so地址，这可能是在实际环境中libdsplibs.so地址不固定造成的，也可能存在尝试特定范围地址的可能性，但总体来看不构成明显的投毒行为。PoC首先会创建多个socket连接, 通过修改HTTP请求头来触发漏洞。利用的关键在于栈溢出，覆盖返回地址，执行ROP链。投毒风险较低，主要风险在于利用是否稳定，因为需要猜测 libdsplibs.so 的地址，猜测错误会导致服务崩溃，但并不构成投毒。

**项目地址:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**来源**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出导致RCE

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经验证的远程攻击者可以利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性评估：**

*   漏洞库信息：明确指出漏洞是栈溢出，且未经身份验证的攻击者可远程利用。
*   搜索引擎结果：多个来源确认了此漏洞的存在，并证实了其已被野外利用。其中，rapid7、truesec、arcticwolf等安全厂商也发布了相关分析报告，证明漏洞的存在。
*   漏洞利用代码：提供的漏洞利用代码仓库仅包含一个README.md文件，描述了该POC扫描器的用途，用于检测Ivanti Connect Secure的RCE漏洞。虽然该文件本身不包含任何利用代码，但表明存在可用的利用POC。由于没有实际的利用代码，难以直接评估其有效性，但考虑到多个来源都表明漏洞已被利用，可以推断存在有效的利用方式。

**投毒风险：**

该仓库目前仅包含一个 README.md 文件，风险较低。但未来作者可能会提交包含恶意代码的commit，因此仍然存在一定的风险。 预估风险值: 10%。

**利用方式：**

该漏洞是一个栈溢出漏洞，攻击者通过发送特制的网络请求，导致目标系统的栈溢出，从而覆盖栈上的返回地址，劫持程序执行流程，最终执行攻击者预先设定的恶意代码，实现远程代码执行。根据watchtowr的分析，漏洞可能存在于处理某些特定请求参数的过程中。根据其他来源的信息，此漏洞已经被中国的APT组织积极利用。


**项目地址:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**来源**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，目标存在漏洞版本的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure, Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，实现在目标系统上执行任意代码。根据漏洞库信息，攻击复杂度较高，但CVSS评分高达9.0，属于Critical级别。搜索引擎结果表明，该漏洞已被在野利用，并且有APT组织参与。PoC代码利用方式是首先获取目标设备的productversion，然后根据productversion选择相应的gadget地址, 结合 libdsplibs.so 的基地址，构造ROP链，最终实现远程代码执行。PoC代码中存在一个可疑的地方，就是attempt 循环。循环中不断尝试使用不同的libdsplibs.so地址，这可能是在实际环境中libdsplibs.so地址不固定造成的，也可能存在尝试特定范围地址的可能性，但总体来看不构成明显的投毒行为。PoC首先会创建多个socket连接, 通过修改HTTP请求头来触发漏洞。利用的关键在于栈溢出，覆盖返回地址，执行ROP链。投毒风险较低，主要风险在于利用是否稳定，因为需要猜测 libdsplibs.so 的地址，猜测错误会导致服务崩溃，但并不构成投毒。

**项目地址:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---



---

## POC #6

**来源**: [CVE-2025-22457-securekomodo_CVE-2025-22457.md](../2025/CVE-2025-22457-securekomodo_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出导致RCE

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经验证的远程攻击者可以利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性评估：**

*   漏洞库信息：明确指出漏洞是栈溢出，且未经身份验证的攻击者可远程利用。
*   搜索引擎结果：多个来源确认了此漏洞的存在，并证实了其已被野外利用。其中，rapid7、truesec、arcticwolf等安全厂商也发布了相关分析报告，证明漏洞的存在。
*   漏洞利用代码：提供的漏洞利用代码仓库仅包含一个README.md文件，描述了该POC扫描器的用途，用于检测Ivanti Connect Secure的RCE漏洞。虽然该文件本身不包含任何利用代码，但表明存在可用的利用POC。由于没有实际的利用代码，难以直接评估其有效性，但考虑到多个来源都表明漏洞已被利用，可以推断存在有效的利用方式。

**投毒风险：**

该仓库目前仅包含一个 README.md 文件，风险较低。但未来作者可能会提交包含恶意代码的commit，因此仍然存在一定的风险。 预估风险值: 10%。

**利用方式：**

该漏洞是一个栈溢出漏洞，攻击者通过发送特制的网络请求，导致目标系统的栈溢出，从而覆盖栈上的返回地址，劫持程序执行流程，最终执行攻击者预先设定的恶意代码，实现远程代码执行。根据watchtowr的分析，漏洞可能存在于处理某些特定请求参数的过程中。根据其他来源的信息，此漏洞已经被中国的APT组织积极利用。


**项目地址:** [securekomodo/CVE-2025-22457](https://github.com/securekomodo/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

## POC #7

**来源**: [CVE-2025-22457-sfewer-r7_CVE-2025-22457.md](../2025/CVE-2025-22457-sfewer-r7_CVE-2025-22457.md)

## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，目标存在漏洞版本的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure, Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，实现在目标系统上执行任意代码。根据漏洞库信息，攻击复杂度较高，但CVSS评分高达9.0，属于Critical级别。搜索引擎结果表明，该漏洞已被在野利用，并且有APT组织参与。PoC代码利用方式是首先获取目标设备的productversion，然后根据productversion选择相应的gadget地址, 结合 libdsplibs.so 的基地址，构造ROP链，最终实现远程代码执行。PoC代码中存在一个可疑的地方，就是attempt 循环。循环中不断尝试使用不同的libdsplibs.so地址，这可能是在实际环境中libdsplibs.so地址不固定造成的，也可能存在尝试特定范围地址的可能性，但总体来看不构成明显的投毒行为。PoC首先会创建多个socket连接, 通过修改HTTP请求头来触发漏洞。利用的关键在于栈溢出，覆盖返回地址，执行ROP链。投毒风险较低，主要风险在于利用是否稳定，因为需要猜测 libdsplibs.so 的地址，猜测错误会导致服务崩溃，但并不构成投毒。

**项目地址:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)

---

