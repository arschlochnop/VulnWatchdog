## CVE-2025-8088 - WinRAR 路径遍历/任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/任意文件写入

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户需要下载并使用受影响版本的WinRAR解压攻击者构造的恶意RAR压缩包。

**POC 可用性:** 4/10

**POC 类型:** 概念验证 (YARA规则与检测规则)

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本研究所分析的输入数据并非直接的可执行利用代码（Exploit），而是由Corelight和ESET提供的检测规则及漏洞说明文档。提供的YARA规则（CVE_2025_8088_rar_ADS_traversal）极具参考价值，它揭示了漏洞的核心利用机制：利用Windows NTFS文件系统的备用数据流（ADS）特性配合路径遍历字符。规则中的字符串$x3匹配了类似'STM..:..\'的特征，这表明攻击者通过在RAR文件名中嵌入ADS标记（如:STM）和回退符（..\），可以诱导WinRAR在解压时忽略用户选择的目标目录，转而将文件写入系统关键位置。虽然没有直接提供生成恶意压缩包的Python脚本或二进制工具，但基于这些规则，安全研究人员可以复现出导致漏洞的RAR文件结构。此类漏洞的有效性极高，因为它利用了底层文件系统解析与应用程序逻辑之间的差异，且WinRAR用户基数巨大，极易通过钓鱼攻击实现大规模利用。利用步骤：1. 攻击者创建一个恶意文件，例如一个名为'malware.exe'的后门。2. 构造一个特殊的RAR压缩包，在压缩包的文件头中，将目标路径通过NTFS ADS语法进行伪装，并加入'..\..\..\'等路径遍历序列。3. 攻击者将写入路径指向Windows启动目录（如：C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup）。4. 将该压缩包通过邮件、下载站等方式分发。5. 受害者使用WinRAR 7.12或更早版本解压该文件，恶意文件被静默写入启动项。6. 用户下次登录系统时，恶意程序自动运行，攻击者获得远程代码执行权限。投毒风险分析：本次提供的资料主要源自知名安全机构和防御性工具库，其投毒风险处于较低水平（约15%）。README文档和规则文件逻辑清晰，代码主要为声明式的YARA签名和Suricata/Snort网络过滤规则，不存在混淆的可执行脚本或自动下载外部二进制文件的行为。然而，威胁情报领域常存在恶意分子伪造此类漏洞研究仓库，并在README中诱导用户下载所谓的'一键复现工具'或'自动化利用脚本'。在分析这类仓库时，需警惕任何包含编译好的.exe文件或复杂的、无法通过静态审计确认逻辑的脚本。当前的POC仅为检测逻辑，其本身不具备攻击性，但在实际防御研究中，若从非官方渠道获取此类漏洞的Generator工具，必须在隔离沙箱环境中运行，防止攻击者利用'反向投毒'技术（即在POC工具中植入后门）对安全研究员发起攻击。本案例中的规则定义明确，未发现恶意指令或指向可疑C2服务器的连接，风险主要集中在后续寻找或编写具体Payload生成器时的供应链安全风险。

**项目地址:** [https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/](https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/)

**漏洞详情:** [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-8088](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-8088)
