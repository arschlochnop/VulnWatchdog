## CVE-2025-8088 - WinRAR 路径遍历 / 任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意代码执行

**影响应用:** WinRAR

**危害等级:** 严重

**CVSS评分:** 9.8 (预测)

**影响版本:** WinRAR <= 7.12

**利用条件:** 攻击者需诱导受害者下载并使用受影响版本的WinRAR解压特制的恶意压缩包。

**POC 可用性:** 4/10

**POC 类型:** 概念验证 / 检测规则

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该CVE-2025-8088漏洞是WinRAR中一个极其隐蔽且高危的路径遍历漏洞。从公开的搜索结果和部分POC代码（YARA规则与Snort规则）来看，其技术核心在于利用了Windows NTFS文件系统的备用数据流（ADS, Alternate Data Stream）特性。攻击者通过在RAR压缩包的文件名中注入特定的ADS标识（如'STM'）结合经典的目录穿越序列（..\\），能够绕过WinRAR原有的路径清洗机制。根据规则分析，$x3正则匹配模式表明攻击者试图在ADS名称中嵌入跳转指令。这意味着POC的主要逻辑是构造一种特殊的压缩结构，使得解压程序在处理ADS流时错误地将数据流指向系统关键目录（如启动目录或System32）。由于该漏洞是CVE-2025-6218的升级版，具备更强的反侦察能力，能规避大部分EDR的沙盒检测，其实际利用价值极高。当前公开的POC多为防御性的检测规则，而非一键式的自动化脚本，因此直接利用的门槛尚存，但对于具备二进制修改能力的攻击者而言，复现难度不高。【利用步骤】1. 攻击者准备一个恶意可执行文件或脚本；2. 使用特制工具构造一个包含路径遍历Payload的RAR压缩包，利用NTFS ADS语法（如 filename:streamname）嵌入..\\路径；3. 诱导目标用户下载该压缩包；4. 用户使用WinRAR 7.12及以下版本解压时，漏洞触发，恶意文件被静默写入到预设的敏感目录（如C:\Users\Username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup）；5. 目标重启系统或触发相应条件时，恶意程序自动运行。【投毒风险分析】目前提供的POC主要以检测规则（YARA和IDS rules）形式存在，不包含可执行的二进制利用程序或复杂的自动化混淆脚本，因此直接的恶意投毒风险处于低位（约10%）。风险主要集中在以下两点：首先，描述中提到的GitHub存储库或其他下载渠道可能被攻击者利用，通过提供假冒的“全自动复现工具”来分发包含后门（如Cobalt Strike Beacon）的压缩包。其次，对于防御方提供的检测工具，虽然代码本身透明（如正则匹配规则），但如果用户从非官方或未经审计的第三方博客下载所谓的“漏洞环境包”进行测试，极易感染该漏洞对应的实际在野利用样本。由于此漏洞已被证实有RomCom等APT组织在野利用，任何声称是“完整利用代码”的资源都应被视为具有高度投毒嫌疑。总体而言，当前文档中的代码主要用于防御检测，代码逻辑清晰且使用标准语法，不具备恶意混淆或外部恶意连接请求，安全性较高。

**项目地址:** [https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/](https://www.welivesecurity.com/en/eset-research/update-winrar-tools-now-romcom-and-others-exploiting-zero-day-vulnerability/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
