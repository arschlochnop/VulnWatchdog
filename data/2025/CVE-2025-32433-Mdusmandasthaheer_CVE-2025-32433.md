## CVE-2025-32433 - Erlang/OTP SSH daemon 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH daemon

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 受影响的 Erlang/OTP 版本包含 SSH 守护进程组件的相关版本（具体补丁版本需参考官方安全公告）

**利用条件:** 受害系统开启了 Erlang/OTP SSH 服务，且攻击者可以通过网络访问该 SSH 端口；利用过程无需任何身份验证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32433）是存在于 Erlang/OTP SSH 守护进程中的极其严重的预认证远程代码执行漏洞。通过对提供的 POC 代码和搜索结果分析，该漏洞的根源在于 SSH 协议消息处理逻辑中存在缺陷，允许攻击者在建立加密通道后的身份验证阶段之前，通过精心构造的 SSH 频道请求（SSH_MSG_CHANNEL_OPEN 和 SSH_MSG_CHANNEL_REQUEST）绕过安全检查。POC 代码展示了完整的攻击链路：首先与目标主机的 SSH 端口建立连接并完成初始的 Banner 交换；随后发送符合协议规范的 SSH_MSG_KEXINIT 消息以模拟正常的密钥交换握手过程。核心利用点在于，即便没有提供有效的登录凭据，攻击者也能成功发送带有 'exec' 类型的频道请求，并在其中嵌入 Erlang 表达式。由于服务端在认证前未能正确限制此类请求的执行权限，导致嵌入的 Erlang 命令（如 file:write_file 或 os:cmd）直接以 SSH 进程的权限运行。POC 中提供的 Python 脚本结构清晰，使用了标准的 socket 和 struct 库来构建二进制协议包，具备极高的实战化能力，能够实现从简单的文件写入到复杂的反弹 Shell 获取。【利用步骤】1. 获取目标主机的 IP 地址和 SSH 服务端口（通常为 22 或 2222）。2. 准备包含恶意 Erlang Payload 的利用脚本。3. 运行脚本，脚本会自动完成 SSH 握手协议。4. 在不触发认证交互的情况下，直接向服务器推送包含 Payload 的 SSH_MSG_CHANNEL_REQUEST 包。5. 验证执行结果，如检查 /lab.txt 是否生成或等待反弹 Shell 连接。【投毒风险分析】在对此 POC 仓库及代码的深度扫描中，目前判定其投毒风险较低（约 15%）。代码主要使用了 Python 的标准网络库，逻辑透明，未发现明显的代码混淆、二进制加密载荷或针对执行机（即研究员本机）的扫描与信息收集行为。Readme 文档中明确标注了该代码仅用于安全研究，并提供了清晰的修改说明。脚本中的 Payload 部分（如 os:cmd 调用 Python 反弹 Shell）是针对目标系统的攻击载荷，而非针对利用者的后门。然而，安全研究人员在使用此类公开披露的 exploit.py 时仍需谨慎：首先，虽然当前版本未见恶意行为，但第三方分发渠道可能在脚本中插入类似 'requests.post' 的函数，将研究人员的 IP、环境变量或 sensitive key 异步外传至攻击者控制的服务器；其次，Payload 部分如果被硬编码为特定的恶意域名，可能导致研究人员在测试时无意间与攻击者基础设施通信。建议在完全隔离的沙箱环境运行，并结合 Wireshark 抓包审计其网络出向流量，确保脚本的行为完全符合预期，不包含针对本地系统的恶意逻辑。此 POC 提供的 Matt Keeley 博客链接作为信誉背书，进一步降低了主动投毒的可能性，但仍需警惕供应链污染。

**项目地址:** [https://platformsecurity.com/blog/CVE-2025-32433-poc](https://platformsecurity.com/blog/CVE-2025-32433-poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
