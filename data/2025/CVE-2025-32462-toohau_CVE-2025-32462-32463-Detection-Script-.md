## CVE-2025-32462 - Sudo 逻辑缺陷/权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 逻辑缺陷/权限提升

**影响应用:** Sudo

**危害等级:** 中危 (Important)

**CVSS评分:** 2.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:N)

**影响版本:** Sudo < 1.9.17p1 (具体受影响版本范围通常包含 1.8.8 至 1.9.17 之前)

**利用条件:** 本地用户访问权限，且 sudoers 配置文件中定义了特定的主机限制（非 ALL 且非当前主机）

**POC 可用性:** 4/10

**POC 类型:** 概念验证/检测脚本

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32462）源于 Sudo 在处理 `-h` (host) 参数时的匹配逻辑存在缺陷。当 sudoers 文件中指定了特定主机名而非 'ALL' 时，攻击者可以通过特定的主机匹配绕过限制，在非预期机器上执行命令。提供的 POC 代码（check_cve_2025_32462.sh）实际上是一个“检测脚本”而非“利用脚本”。它通过 `sudo -V` 获取版本号并与易受攻击的版本范围（1.8.8 至 1.9.17）进行字符串比对。虽然该脚本能够识别系统是否处于风险版本，但它并不具备实现权限提升或绕过逻辑的实际 Exploit 功能。脚本中对 `sudo -h` 的测试仅是探测命令是否接受该参数，并不能证明漏洞可被成功利用。在真实渗透测试场景中，此 POC 仅能作为预研工具，无法直接获取 Root 权限。此外，脚本的版本比对逻辑较为简单（使用 Bash 字符串比较），在某些发行版修改了版本命名规则的情况下可能存在误报。该漏洞通常与 CVE-2025-32463（高危）关联提及，后者通过 `--chroot` 逃逸 NSS 库实现 Root 提升，更具威胁性。利用步骤如下：1. 攻击者获取目标系统的本地普通用户权限；2. 检查 `/etc/sudoers` 配置，确认是否存在限定特定主机的规则；3. 调用 `sudo -h [目标主机] [命令]` 触发逻辑错误。若配合 CVE-2025-32463，则需准备受控目录及伪造的 `nsswitch.conf` 和恶意共享库。 【投毒风险分析】该 POC 的投毒风险极低（评估为 5%）。分析其 shell 脚本内容，其逻辑纯粹是基于系统命令（sudo -V, awk, grep）进行版本信息提取和条件判断。脚本中未发现任何网络外连请求（如 curl, wget 下载远程负载）、无混淆代码、无 eval 执行加密字符串的行为，也没有对系统敏感文件（如 /etc/shadow 或 ~/.ssh/authorized_keys）的修改尝试。其主要操作仅限于标准输出显示检测结果。唯一潜在的小风险在于，如果用户以 Root 身份运行此检测脚本，虽然脚本本身无恶意，但任何脚本在未审计情况下高权限运行都是不安全的。该脚本来自教育目的的 GitHub 仓库（MAAYTHM/CVE-2025-32462_32463-Lab），旨在提供 Docker 环境下的漏洞实验，符合安全研究规范。对于防御方而言，可以安全地参考其版本检测逻辑，但建议在生产环境中使用官方维护的扫描工具或直接升级 Sudo 软件包至 1.9.17p1 或更高版本。

**项目地址:** [https://github.com/MAAYTHM/CVE-2025-32462_32463-Lab](https://github.com/MAAYTHM/CVE-2025-32462_32463-Lab)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
