## CVE-2025-2304 - Camaleon CMS 权限提升, 大量赋值 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升, 大量赋值 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要有效低权限用户凭证, 需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-2304描述了Camaleon CMS中存在的一个权限提升漏洞，具体表现为通过“大量赋值”（Mass Assignment）缺陷实现。该漏洞影响Camaleon CMS 2.9.1之前的版本。攻击者可以利用此漏洞，将一个低权限的用户角色提升至管理员权限，从而完全控制受影响的CMS实例。此漏洞的核心在于用户在更新密码时，系统未能正确地过滤或验证提交的参数，导致攻击者可以注入额外的字段（如用户角色），并将其值设置为具有更高权限的属性。

**POC有效性分析：**
提供的Python POC代码（exploit.py）以及详细的README.md文档显示这是一个完整且高度有效的利用工具。该POC基于Python 3开发，并依赖于`requests`库进行HTTP通信，以及`beautifulsoup4`库进行HTML内容解析，这两种都是Python生态系统中广泛使用且信誉良好的标准库。POC的实现逻辑与漏洞描述高度一致，它首先通过模拟正常的用户登录流程，获取必要的CSRF令牌，然后利用这些令牌和低权限用户的凭证进行认证。关键步骤在于，在用户修改个人资料（尤其是密码）的AJAX请求中，POC巧妙地注入了`password[role]=admin`参数。这种构造方式直接利用了CMS后端对参数处理不当的缺陷，强制将当前用户的角色更新为管理员。POC还包含了对利用结果的验证机制，通过检查响应内容来确认用户角色是否已成功提升，并在成功时输出可复用的管理员会话Cookie。代码结构清晰，易于理解和审计，具备良好的可用性、稳定性和可靠性。

**利用步骤：**
1.  **环境准备**：确保本地系统已安装Python 3，并通过`pip install requests beautifulsoup4`安装所需库。
2.  **获取凭证**：获取目标Camaleon CMS系统中一个有效的低权限用户（非管理员）的用户名和密码。
3.  **运行POC**：在命令行中执行POC脚本，指定目标CMS的URL、低权限用户名和密码：
    `python3 exploit.py -t http://target.com -u <username> -p <password>`
4.  **CSRF令牌获取**：POC脚本首先会访问CMS的登录页面，解析HTML以提取初始的CSRF令牌，用于后续的认证请求。
5.  **用户认证**：使用提供的低权限用户名、密码以及获取到的CSRF令牌，POC向CMS发送POST请求以完成用户登录。
6.  **访问资料编辑页**：成功登录后，POC会导航至用户的个人资料编辑页面（`/admin/profile/edit`），并从该页面中提取用于密码更新的API端点和对应的CSRF令牌。
7.  **构造恶意请求**：POC构造一个PATCH请求，目标是密码更新API端点。在这个请求的数据中，除了正常的密码更新字段外，POC还注入了`password[role]=admin`参数。这是实现权限提升的核心步骤，通过大量赋值漏洞将用户角色强制修改为管理员。
8.  **验证与输出**：POC发送恶意请求后，会解析CMS的响应，验证用户角色是否已成功提升为管理员。如果验证成功，脚本将输出当前管理员会话的Cookie，攻击者可以使用这些Cookie直接访问CMS的管理员后台。

**投毒风险分析：**
对提供的`exploit.py`和`README.md`文件进行详细分析后，评估其投毒风险为**低 (10%)**。该POC的代码质量高，结构清晰，未发现任何恶意或可疑行为。

1.  **代码清晰度与可读性**：脚本代码注释详尽，变量命名规范，逻辑流程一目了然。没有使用任何代码混淆技术、加密字符串或难以理解的编程范式，使得安全研究人员可以轻松审计每一行代码，确保其行为符合预期。
2.  **依赖项管理**：POC仅依赖`requests`和`beautifulsoup4`这两个Python标准库，它们都是开源且经过社区广泛审查的，且通常通过PyPI进行安装。脚本未尝试下载或执行任何外部的、非标准的二进制文件或第三方脚本，大大降低了供应链攻击的风险。只要Python环境和PyPI源是安全的，这些依赖本身引入恶意代码的可能性极低。
3.  **网络行为**：所有的网络请求都明确指向用户通过`-t`参数指定的目标URL。脚本没有硬编码任何外部C2服务器地址、可疑IP或未知域名。它仅限于对目标CMS进行HTTP/HTTPS请求，不进行任何端口扫描、数据包嗅探或其他非预期网络活动。
4.  **文件系统操作**：脚本在执行过程中不涉及任何对本地文件系统的写入、删除或修改操作，除了Python解释器正常的工作机制外。它不会尝试创建或修改系统关键文件、下载恶意Payload到磁盘或持久化任何后门。
5.  **系统资源占用与沙盒逃逸**：POC代码逻辑简单，主要执行HTTP请求和HTML解析，对系统资源的占用极低。它不包含任何利用操作系统漏洞或容器逃逸的尝试。
6.  **动态代码执行**：代码中未发现`eval()`、`exec()`等可能导致远程代码执行或动态执行恶意Payload的函数调用。所有执行路径都是静态可分析的，确保脚本行为的可预测性。

综上所述，该POC代码是专门为演示和验证Camaleon CMS的权限提升漏洞而设计的，其行为完全符合描述。在合法的防御性安全研究和授权测试场景下，使用此POC的投毒风险极低。然而，任何安全工具在未经仔细审查的情况下都可能被滥用或被恶意篡改，因此建议在使用前始终进行代码审计。

**项目地址:** 

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
