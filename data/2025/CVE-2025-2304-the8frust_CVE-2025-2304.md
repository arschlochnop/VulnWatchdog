## CVE-2025-2304 - Camaleon CMS Privilege Escalation, Mass Assignment

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation, Mass Assignment

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** Not available

**影响版本:** < 2.9.1

**利用条件:** 需要有效的低权限用户凭据, 需要网络访问

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
该漏洞利用POC (`exploit.py`) 针对Camaleon CMS < 2.9.1 版本中的大规模赋值 (Mass Assignment) 漏洞，实现低权限用户到管理员的权限提升。POC代码结构清晰，使用了Python的标准库 `requests` 进行HTTP通信，`beautifulsoup4` 进行HTML解析以提取CSRF令牌。

利用流程如下：
1.  **获取登录页面和CSRF令牌**: 脚本首先向 `/admin/login` 发送GET请求，解析HTML响应以提取用于后续认证的CSRF令牌。这一步是确保会话安全性的标准做法。
2.  **用户认证**: 使用提供的低权限用户名和密码，脚本向登录端点发送POST请求进行认证。认证成功后，会话cookie被保存以供后续请求使用。
3.  **访问用户资料编辑页面**: 认证成功后，脚本导航到 `/admin/profile/edit` 页面，再次解析HTML以提取修改密码所需的CSRF令牌和密码更新端点。
4.  **发送伪造的PATCH请求进行权限提升**: 这是利用的关键步骤。脚本向密码更新端点发送一个PATCH请求，请求体中包含 `password[role]=admin`。Camaleon CMS由于存在大规模赋值漏洞，会错误地将用户提交的 `role` 字段赋值给用户对象，从而将当前用户的角色从低权限提升为管理员。
5.  **验证角色提升**: 脚本在修改密码后，会再次检查用户的权限，确认其是否已成功提升为管理员。
6.  **输出会话Cookies**: 如果利用成功，脚本会打印出可重用的会话cookie，攻击者可以使用这些cookie直接以管理员身份登录。
从代码逻辑和README描述来看，这个POC是功能完整的、可直接利用的。它遵循了典型的Web应用漏洞利用模式，对目标CMS的漏洞机制有深入理解。代码中包含了详细的日志输出，方便用户跟踪利用过程。

利用步骤:
1.  **环境准备**: 确保系统已安装Python 3。
2.  **安装依赖**: 运行 `pip install requests beautifulsoup4` 安装所需的Python模块。
3.  **获取POC代码**: 将 `exploit.py` 文件保存到本地。
4.  **执行攻击**: 在命令行中运行脚本，指定目标URL、有效的低权限用户名和密码：`python3 exploit.py -t http://target.com -u <username> -p <password>`，例如: `python3 exploit.py -t http://facts.htb -u user -p pass`。
5.  **结果验证**: 如果攻击成功，脚本将确认认证成功，密码更新成功，用户角色提升为管理员，并打印出可重用的管理员会话cookies。攻击者可以使用这些cookies直接登录CMS后台。

投毒风险分析:
该POC代码的投毒风险评估为**低**（10%）。分析理由如下：
1.  **代码清晰度高**: `exploit.py` 代码逻辑清晰，没有进行任何形式的代码混淆或加密。所有功能和操作都一目了然。
2.  **仅使用标准和常用库**: 脚本仅使用了 `argparse`, `textwrap`, `requests`, `sys`, `bs4` (BeautifulSoup) 这些Python标准库或业界广泛认可的第三方库。`requests` 用于HTTP请求，`beautifulsoup4` 用于HTML解析，这些都是渗透测试和Web抓取中常用的安全工具。
3.  **无外部可疑资源引用**: 代码中没有发现任何从外部下载或执行脚本的行为，也没有引用可疑的远程资源。所有操作都在本地进行。
4.  **无恶意行为迹象**: 脚本的核心目的是利用Camaleon CMS的特定漏洞进行权限提升。在代码中未发现任何与勒索、数据窃取、后门植入、挖矿、拒绝服务攻击等恶意行为相关的代码。它严格限定在漏洞利用的范围之内。
5.  **目标明确，行为可预测**: 脚本的HTTP请求都是针对目标CMS的特定URL，并且请求参数和数据都是为了实现权限提升而构造。其网络行为是可预测和可解释的。
6.  **免责声明**: `README.md` 中明确指出该工具仅用于教育和授权的安全测试，禁止未经授权的使用。这进一步表明了开发者的意图是合法的安全研究。
综上所述，该POC代码是干净的，不包含任何恶意投毒代码。它是一个合法的安全研究工具，用于演示和验证Camaleon CMS中的权限提升漏洞。在安全分析和测试中使用此POC是安全的，但应始终遵循其免责声明，仅在授权环境下使用。

**项目地址:** Not available (local copy provided)

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
