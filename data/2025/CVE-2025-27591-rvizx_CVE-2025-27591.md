## CVE-2025-27591 - Facebook Below (系统监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Facebook Below (系统监控工具)

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Below < v0.9.0

**利用条件:** 本地用户访问权限；目标系统存在 /var/log/below 且权限为世界可写；用户拥有 sudo 执行 /usr/bin/below 的权限（常见于运维环境配置）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞源于 Below 服务在初始化时创建了一个全局可写（world-writable）的日志目录 `/var/log/below`。POC代码揭示了逻辑缺陷：当以高权限执行 `below snapshot` 时，程序会尝试设置日志文件的权限。攻击者可以利用符号链接（Symlink）劫持此过程。具体来说，攻击者先删除自己的日志文件，然后创建一个指向敏感文件（如 `/etc/passwd`）的同名符号链接。当 `sudo below` 运行时，程序由于缺乏对符号链接的安全检查，会错误地对链接目标调用 `chmod 0666` 并尝试写入内容。这不仅导致了越权写，更由于文件权限被修改为全局可写，使得普通用户可以直接修改 `/etc/passwd`。POC通过向该文件追加一个具备 root 权限的伪造用户（pwn::0:0...）并切换至该用户，成功实现了从普通用户到 root 的垂直提权。代码逻辑严密，直接利用了 Linux 文件系统特性与程序权限逻辑冲突，在受影响版本上具有极高的成功率。利用步骤如下：1. 获取当前用户名并确定对应的日志文件名；2. 删除原日志文件并创建指向 /etc/passwd 的软链接；3. 设置环境变量并触发 sudo 执行 below 任务；4. 验证 /etc/passwd 是否变为 666 权限；5. 注入 root 权限用户并提权。【投毒风险分析】该 POC 项目主要由 README.md 说明文档和一段简短的 Bash 脚本组成。经过代码审计，脚本内容完全透明，使用的命令均为 Linux 标准系统命令（如 id, rm, ln, sudo, echo, su），不存在任何二进制文件下载、远程服务器反弹 Shell 或加密混淆行为。脚本中的 `echo 'pwn::0:0...' >> /etc/passwd` 虽然是攻击行为，但其目的是为了演示权限提升的结果，属于典型的安全研究验证逻辑。其引用的 GitHub 仓库地址和作者信息与安全社区（如 SUSE 公告）披露的信息吻合，且项目引用了知名安全研究员 IppSec 的建议，显示了其真实的研究背景。风险评估为极低，唯一的风险点在于自动化脚本对 /etc/passwd 的修改可能会破坏系统稳定性（如果操作不当或多次执行），但这属于 POC 的副作用而非恶意投毒。防御者可以放心在隔离环境中使用此代码进行漏洞复现和防御策略验证。建议在审计过程中重点关注脚本是否包含不明的 curl/wget 下载行为，目前的 POC 版本是安全的。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
