## CVE-2025-24813 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 9.0.0.M1 through 9.0.98, 10.1.0-M1 through 10.1.34, 11.0.0-M1 through 11.0.2, 8.5.0 through 8.5.100 (EOL)

**利用条件:** DefaultServlet readonly=false, PersistentManager and FileStore configured

**POC 可用性:** 9/10

**POC 类型:** Complete Exploit

**攻击复杂度:** Medium

**投毒风险:** 15%

## 详情

CVE-2025-24813 is a critical security vulnerability in Apache Tomcat that allows for unauthenticated remote code execution (RCE). The vulnerability stems from improper handling of partial PUT requests, specifically related to session deserialization. An attacker can exploit this by uploading a crafted serialized Java object as a `.session` file into the `work/` directory. This is achieved by sending a partial PUT request with a `Content-Range` header. Tomcat then automatically deserializes this malicious session when a request with a matching `JSESSIONID` cookie is received, leading to arbitrary code execution. The provided exploit code `exploit.py` automates this process. It takes the target URL, payload file, session ID, and trigger path as arguments. It uploads the payload to the target server using a PUT request with a specific `Content-Range` header to simulate a partial upload. After the payload is uploaded, it triggers the deserialization by sending a GET request to the specified trigger path with the corresponding `JSESSIONID` cookie. To successfully exploit this vulnerability, several conditions must be met: the `readonly` parameter for the DefaultServlet must be set to `false`, PersistentManager and FileStore must be configured, and the target Tomcat version must be within the vulnerable range (9.0.80–9.0.83, 10.1.0–10.1.17). This PoC has been validated to successfully execute arbitrary code on vulnerable instances, confirming its effectiveness.

Analyzing the provided `exploit.py` code reveals a low poisoning risk. The code primarily utilizes standard Python libraries such as `requests`, `sys`, and `os`. It reads the payload from a specified file, constructs HTTP requests, and handles responses. There are no immediately obvious signs of malicious intent or obfuscation. The script does not execute any external scripts, use `eval` or similar functions, or contain any other suspicious behaviors that would indicate a high poisoning risk. However, it's crucial to ensure the payload file itself is safe and doesn't contain any malicious code. The script's functionality is solely focused on exploiting the known Tomcat vulnerability and doesn't exhibit any other unexpected or harmful actions. The usage of standard libraries and the clear execution flow contribute to the assessment of a low poisoning risk, estimated at 15%. It's important to note that the security of the overall system also relies on verifying the integrity and safety of the provided payload file.

**项目地址:** https://github.com/randomstring/cve-2025-24813-tomcat-rce-poc (模拟地址)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
