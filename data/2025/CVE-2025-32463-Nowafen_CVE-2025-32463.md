## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 攻击者需拥有本地非特权用户访问权限，且系统中 sudo 的配置允许用户使用 --chroot (-R) 选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

POC有效性分析：该POC是一个基于Go语言编写的自动化利用工具，针对Sudo在处理--chroot（-R）选项时的设计缺陷。其核心原理是利用Sudo在切换到chroot环境后，仍会尝试加载受用户控制目录下的系统配置文件（如/etc/nsswitch.conf）。通过在攻击者可控的目录中伪造该文件及配套的共享库（libnss），POC能够诱导具有root权限的sudo进程加载恶意的动态链接库（.so文件）。在.so文件的初始化代码中，POC执行了setuid(0)和setgid(0)操作，并最终调用execve启动一个交互式的root shell。经代码逻辑审计，该POC包含了环境创建、恶意C代码生成、自动化编译（集成gcc）以及最后的漏洞触发等全流程，具有极高的实战化程度和成功率，在满足利用条件的情况下可直接获取系统最高权限。利用步骤：1. 在目标系统上安装Go环境及GCC编译器；2. 获取并编译POC源码生成可执行文件；3. 执行./exploit --execution；4. 脚本会自动在/tmp目录下创建随机后缀的伪造chroot环境，并生成恶意nss库；5. 脚本调用sudo -R指向该伪造环境；6. 漏洞触发，返回uid=0的shell。投毒风险分析：该项目虽然提供了完整的源码，但其投毒风险主要体现在分发方式上。在README中，作者诱导用户通过curl直接下载并运行预编译的二进制文件（releases/download/exploit/exploit），这在安全研究中属于极高风险行为。预编译二进制文件可能包含与源码不一致的恶意后门代码，如窃取凭据、建立反弹shell或植入持久化木马。此外，源码中提到了可以使用garble工具进行代码混淆，这通常是恶意软件规避静态分析的常用手段。尽管目前从公开的README和main.go结构看，其行为主要围绕漏洞验证展开，但攻击者极易通过修改src目录下的隐藏逻辑，在提升权限的同时将敏感信息外传。防御研究人员在分析此类工具时，必须严格在隔离的沙箱或虚拟机环境中进行，且应优先审计并自行编译源码，严禁直接运行互联网上的预编译程序。

**项目地址:** [https://github.com/Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
