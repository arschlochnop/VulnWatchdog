## CVE-2025-32463 - sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 - 1.9.17 (before 1.9.17p1)

**利用条件:** 攻击者需拥有本地低权限用户访问权限，且目标系统启用了 sudo 的 chroot 功能（--chroot 或 -R 选项），通常需要用户具有在 sudoers 中执行带有 chroot 权限的命令。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC针对 CVE-2025-32463 漏洞提供了高度自动化的利用流程。漏洞的核心在于 sudo 的 chroot 机制存在缺陷。当 sudo 以 chroot 模式运行时，会不安全地加载用户可控目录下的 /etc/nsswitch.conf 文件。该 POC 逻辑严密，首先在 /tmp 目录下创建随机的工作空间以避免竞争冲突，随后通过 C 语言编写一个恶意的 NSS 共享库。该库在加载时会执行特定的 init 函数，通过 setuid(0) 和 setgid(0) 将当前进程提权为 root，并调用 execve 弹出 /bin/sh 交互式 shell。随后，POC 自动修改 chroot 目标目录下的 NSS 配置文件，使其指向该恶意库，并最终调用 sudo -R 触发加载流程。该 POC 具备自动清理机制，能够删除生成的临时 C 代码和共享库文件。从代码实现看，Go 语言编写的入口程序负责环境编排，GCC 负责编译 Payload，整个过程符合漏洞触发逻辑，具有极高的实战有效性。在受影响的 sudo 版本（1.9.14 至 1.9.17）上，若配置了相应的 chroot 策略，提权成功率极高。利用步骤如下：1. 环境检查，确认 Go 和 GCC 环境；2. 运行 exploit 程序；3. 程序创建临时 chroot 根目录并写入恶意 nsswitch.conf；4. 编译生成恶意的共享库文件；5. 调用 sudo --chroot 执行目标路径，触发 NSS 库加载；6. 获得 root shell 并清理痕迹。【投毒风险分析】该 POC 存在中等程度的投毒风险，主要体现在其获取和分发方式上。README 文档中诱导用户直接使用 curl 下载预编译的二进制文件（exploit），这是典型的投毒向量。未经审计的二进制文件可能在执行提权逻辑的同时，静默安装持久化后门、窃取 SSH 密钥或将系统信息外发。虽然源代码（Go 语言部分）显示其主要逻辑为漏洞利用，但 README 中提到可以使用 'garble' 混淆工具进行编译，这通常是攻击者为了躲避杀毒软件（AV/EDR）检测而采取的手段。在防御性研究场景下，研究员若直接运行提供的二进制文件而不自行从源码编译并审计，将面临极高的供应链风险。此外，GitHub 链接（Nowafen/CVE-2025-32463）虽看似正常，但考虑到其发布时机与漏洞公开时间高度重合，且重点推荐下载 Pre-built 文件的行为，不排除其作为恶意软件分发诱饵的可能性。建议研究人员务必在隔离的虚拟机环境中操作，并严格审计源码中的网络请求部分，禁止直接运行任何预编译程序。

**项目地址:** [https://github.com/Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
