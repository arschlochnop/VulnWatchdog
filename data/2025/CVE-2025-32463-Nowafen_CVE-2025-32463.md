## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 - 1.9.17 (低于1.9.17p1)

**利用条件:** 本地普通用户权限，且sudo配置允许该用户使用--chroot (-R)选项

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个基于Go语言编写的自动化提权工具，针对CVE-2025-32463漏洞具有极高的实用价值和有效性。该漏洞根源在于Sudo从1.9.14版本引入的chroot机制实现缺陷。当执行带有--chroot参数的sudo命令时，系统未能在切换根目录前安全地处理动态库加载路径及相关配置文件。具体来说，Sudo会尝试读取用户受控目录下的/etc/nsswitch.conf文件，并根据其配置加载对应的共享对象文件。POC通过以下步骤成功实现利用：首先，在/tmp目录下创建一个随机命名的工作目录（如sudowoot.stage.*）；其次，生成一段恶意C语言代码，该代码的核心逻辑是调用setuid(0)和setgid(0)以获取root权限，随后启动一个交互式的shell（如/bin/sh）；接着，POC调用系统编译器（gcc）将该C代码编译成共享库文件，并放置在伪造的目录结构中；最后，通过执行'sudo -R'命令强制sudo加载该恶意库。这种利用方式直接绕过了Linux的安全边界，且POC脚本自带环境清理功能，能自动删除临时生成的C代码和库文件，具有极高的实战完成度。经过评估，该POC在符合版本条件的Ubuntu及其他主流Linux发行版上具有极高的成功率。

利用步骤：1. 环境确认：确保目标系统的sudo版本在1.9.14至1.9.17之间，且当前用户拥有sudo chroot权限。2. 工具准备：在目标机器上下载或编译POC工具，若使用源码编译需具备Go环境及gcc编译器。3. 执行漏洞利用：运行命令'./exploit --execution'。4. 权限维持：POC会自动创建临时chroot环境，诱导sudo加载恶意生成的共享库，从而反弹或直接开启一个UID为0的root shell。5. 验证结果：在获取的新shell中执行'id'或'whoami'命令，确认当前身份已切换为root。

投毒风险分析：该POC代码表现出较低的投毒风险。通过分析提供的Go源码及README文档，代码逻辑清晰且目标明确，主要使用Go标准库进行文件系统操作和命令执行，未发现明显的恶意混淆（Obfuscation）或反调试逻辑。虽然README中提到了可以使用'garble'工具进行混淆，但这更多是出于绕过EDR检测的实战考虑，而非隐藏恶意后门。在README中提供的预编译二进制文件下载链接（curl下载方式）存在一定的潜在风险，因为二进制文件无法直接审计其安全性，不排除发布者在编译过程中植入远控木马或窃密脚本的可能性。此外，代码执行过程中涉及的/tmp目录写入和共享库加载属于此类提权漏洞的标准化利用动作，并非针对研究者本人的攻击。总体评估投毒风险为15%，风险主要集中在建议用户直接下载执行的‘Pre-built Binary’（预编译二进制）中，强烈建议防御性研究员在隔离的沙箱环境中使用源码自行编译运行。

**项目地址:** [https://github.com/Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
