## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本范围待定

**利用条件:** 克隆恶意Git仓库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 60%

## 详情

CVE-2025-48384是一个存在于Git中的高危漏洞，允许攻击者创建恶意的Git仓库，当用户克隆这些仓库时，可能导致任意文件写入。根据搜索结果，该漏洞与`git clone`子模块有关，通过精心构造的`.gitmodules`文件以及其他Git配置，可能实现在克隆过程中写入任意文件，进而执行恶意代码。

**POC有效性分析：**

根据已找到的POC代码（/tmp/vulnwatchdog_569f31ff6b5166501e6218f8839f5620/post-checkout），攻击者可以在`post-checkout`钩子中插入恶意命令。当用户克隆包含此恶意钩子的仓库时，`post-checkout`脚本会被执行。示例代码中的`ping wtt0rkb926c0mj6tsxmzfr2xlorff53u.test-burp.huidoumeng.com`表明PoC的目的是通过DNS请求来验证漏洞是否被成功触发。这可以用于简单地检测漏洞的存在，但实际攻击中可以替换为任意恶意命令，例如下载并执行payload，或修改系统配置。

利用该漏洞，攻击者可以诱导用户克隆恶意仓库，从而在用户系统上执行任意代码。考虑到Git的广泛使用，尤其是在开发环境中，该漏洞的影响范围非常大。成功利用该漏洞可能导致敏感信息泄露、系统被完全控制等严重后果。

**利用步骤：**

1.  攻击者创建一个包含恶意`.gitmodules`和`post-checkout`钩子的Git仓库。
2.  攻击者诱导受害者克隆此仓库（例如，通过社交工程、钓鱼邮件等）。
3.  当受害者执行`git clone`命令时，恶意`post-checkout`钩子被触发，执行攻击者预设的恶意命令。

**投毒风险分析：**

此PoC的投毒风险较高，初步判断为60%。原因如下：

1.  **恶意代码执行：** PoC通过`post-checkout`钩子执行命令，允许攻击者在受害者机器上执行任意代码。如果攻击者将恶意代码嵌入到广泛使用的开源项目中，并诱导开发者clone，影响范围会进一步扩大。
2.  **命令注入：** 尽管PoC中的示例代码只是一个简单的`ping`命令，但攻击者可以将其替换为更复杂的恶意命令，例如下载并执行恶意脚本，这大大增加了投毒的潜在危害。
3.  **传播方式：** 该漏洞可以通过Git仓库进行传播，这意味着攻击者可以将恶意代码隐藏在看似正常的代码库中，并利用开发者之间的协作关系进行传播。考虑到软件供应链攻击的日益严重，这种投毒方式的危害性不可忽视。

为了降低投毒风险，组织应加强对Git仓库的审计，确保代码的安全性，并对克隆的仓库进行安全检查。同时，应教育开发者提高安全意识，避免克隆来源不明的仓库。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 待定
