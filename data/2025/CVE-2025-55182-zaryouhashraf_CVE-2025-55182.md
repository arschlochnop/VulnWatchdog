## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 关键 (Critical)

**CVSS评分:** 10.0

**影响版本:** react-server-dom-webpack 19.0.0 – 19.2.0, react-server-dom-parcel 19.0.0 – 19.2.0, react-server-dom-turbopack 19.0.0 – 19.2.0, 以及使用这些库的Next.js应用

**利用条件:** 无需认证, 网络可达

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个严重的远程代码执行（RCE）漏洞，CVSS评分为10.0，影响React服务器组件（RSC）及其上构建的Next.js应用程序。此漏洞源于React Flight反序列化机制对对象属性访问路径（如`__proto__`、`constructor`）缺乏严格校验，导致不安全的反序列化。攻击者无需认证，即可通过精心构造的`multipart/form-data`表单请求，利用 `$B` 引用结合可控的 `_response._prefix` 和被劫持为 `Function` 的 `_formData.get`，在服务端动态生成并执行包含任意系统命令的函数。

提供的POC代码是一个HTTP POST请求示例，其中包含关键的 `Next-Action`、`X-Nextjs-Request-Id` 等头信息，以及一个精心构造的请求体。请求体中的JSON-like流式格式展示了对 `then` 属性的劫持，这是利用JavaScript Promise机制执行代码的常见手法。尽管POC请求体已截断，但其结构与漏洞描述高度吻合，即通过操纵反序列化过程中的对象属性，最终实现任意代码执行。多篇专业安全报告（如腾讯、阿里、FreeBuf）均证实了该漏洞的“核弹级”影响和野外利用情况，表明该POC模式是有效且具有代表性的。锐捷网络等厂商也发布了针对此漏洞的IPS规则更新，进一步佐证了其真实性和高危性。

**利用步骤**:
1. 识别目标应用程序是否使用了受影响版本的`react-server-dom-webpack`、`react-server-dom-parcel`或`react-server-dom-turbopack`（19.0.0 – 19.2.0），或基于这些库的Next.js应用。
2. 构造一个恶意的HTTP POST请求。请求的`Host`应指向目标服务器，`Content-Type`设置为`multipart/form-data; boundary=...`。
3. 添加必要的Next.js特定请求头，例如`Next-Action: x`、`X-Nextjs-Request-Id`等。
4. 在`multipart/form-data`的表单数据部分，构造一个名为`"0"`的字段，其值包含一个JSON-like结构。这个结构是利用漏洞的关键，它将通过React Flight协议的反序列化过程，在服务器端构建一个恶意对象。
5. 恶意负载的核心在于劫持对象的特定属性（例如，POC中显示的`"then": "$1:__..."`），并将其指向一个能够执行系统命令的函数。这通常涉及到利用原型链污染（`__proto__`）或利用特定数据类型转换机制来将字符串解析为可执行函数。
6. 将此恶意POST请求发送到受害服务器的RSC处理端点。一旦服务器反序列化该请求，其中包含的恶意代码将被执行，从而实现远程代码执行。

**投毒风险分析**:
对当前提供的POC代码进行投毒风险评估，结论为低风险（0-29%）。该POC以纯文本HTTP请求示例的形式呈现，其核心内容是一个经过精心构造的HTTP POST请求负载，旨在演示如何触发CVE-2025-55182远程代码执行漏洞。此格式的POC不涉及复杂的脚本、编译后的二进制文件或外部依赖，因此其透明度极高。用户可以清晰地审查其内容，理解其攻击意图——即通过特定的数据包结构对目标服务器发起攻击。

该POC代码本身不包含任何混淆、后门、恶意软件下载链接或其他可疑行为。它是一个直接且清晰的漏洞利用演示，其目的是帮助安全研究人员理解漏洞原理和验证防护措施。运行此POC并不会对执行POC本身的环境造成危害，其危害作用仅指向受攻击的目标系统。因此，从“投毒”的角度而言，即POC代码本身是否会引入额外的恶意功能到使用者系统，风险评估为极低。防御者可以安全地分析和使用此POC来测试其防御系统，而无需担心POC自身带有隐匿的恶意载荷。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
