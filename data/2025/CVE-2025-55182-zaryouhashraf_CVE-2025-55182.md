## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** react-server-dom-webpack 19.0.0 – 19.2.0, react-server-dom-parcel 19.0.0 – 19.2.0, react-server-dom-turbopack 19.0.0 – 19.2.0。基于这些包构建的框架（例如Next.js应用程序）也可能受影响。

**利用条件:** 无需认证, 网络可达

**POC 可用性:** 8

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个已公开披露的、威胁等级为“严重”（CVSS评分10.0）的远程代码执行（RCE）漏洞，主要影响React Server Components（RSC）及其构建的上层应用，如Next.js。此漏洞于2025年12月3日被Lachlan Davidson发现并披露，并且自12月4日起已观察到大规模的实际利用，这表明其攻击面广且易于利用。

该漏洞的核心根源在于React Flight协议在处理服务器端组件（RSC）的序列化和反序列化机制时存在缺陷。RSC允许组件在服务端渲染，并以JSON-like的流式格式通过Flight协议发送到客户端，实现高效交互。然而，问题出在反序列化过程中，特别是当处理`multipart/form-data`类型的请求时，对用户输入的属性访问路径（如`__proto__`、`constructor`）缺乏严格的校验。这使得未经身份验证的攻击者能够通过精心构造的请求，利用原型链污染等技术，在服务器上执行任意代码。

具体而言，攻击者可以构造恶意的`multipart`表单，利用`$B`引用结合可控的`_response._prefix`和被劫持为`Function`的`_formData.get`。通过这种方式，攻击者能够动态生成包含任意系统命令的函数，并将其赋值给对象的`.then`属性。在反序列化执行到特定阶段时，这个恶意函数就会被触发，从而在服务器端执行预设的命令。搜索结果中提及了利用`child_process.execSync`来执行系统命令，进一步印证了这种利用方式的可行性。

所提供的POC代码虽然是一个HTTP请求的截断片段，但其结构完整地展示了攻击载荷的关键部分，例如`Next-Action`头部、`Content-Type: multipart/form-data`以及请求体中`"then": "$1:__..."`的注入模式。这个模式是JavaScript原型链污染结合特定函数劫持的典型标志，与漏洞原理高度吻合。

POC的`README.md`文档清晰地概述了漏洞的攻击向量、影响、受影响版本和技术根源。它明确指出漏洞是“网络可达”、“无需认证”、“攻击复杂度低”的，且可能导致“完全服务器沦陷”。这些特征与CVE的CVSS 10.0评分相符，并预示着极高的利用价值。鉴于其技术细节的详尽程度以及对实际攻击载荷结构的提示，该POC被认为是高度有效的概念验证，足以指导具备一定安全知识的工程师复现和理解漏洞。

**利用步骤:**
1.  **目标识别：** 识别运行受影响的`react-server-dom-webpack`、`react-server-dom-parcel`、`react-server-dom-turbopack`（版本19.0.0至19.2.0）或基于这些库构建的Next.js应用程序的Web服务器。
2.  **准备攻击载荷：** 参照POC中提供的HTTP请求结构，构造一个恶意的`multipart/form-data`请求。核心在于精心设计请求体中的JSON-like数据，利用React Flight协议的反序列化机制进行原型链污染。
3.  **原型链污染：** 在请求数据中，通过特定语法（例如利用`__proto__`或`constructor`属性）对服务器端对象的原型进行修改，使得在后续的反序列化过程中，某些关键属性（如`_formData.get`）被替换为攻击者控制的恶意函数。
4.  **注入命令：** 将包含任意系统命令（例如`eval('require(\'child_process\').execSync(\'id > /tmp/pwned\')')`）的JavaScript代码封装成一个`Function`对象。这个恶意`Function`会被注入到被污染的对象属性中，通常是通过`$B`引用结合`_response._prefix`来动态生成。
5.  **触发执行：** 当服务器接收并尝试反序列化此恶意请求时，被污染的`.then`属性会在反序列化过程中被调用，从而执行其中包含的系统命令。
6.  **结果验证：** 攻击者可以通过带外通信（如DNS查询、HTTP请求）或后续连接，验证命令是否成功执行，并进一步利用已获得的服务器访问权限。

**投毒风险分析:**
在评估此POC代码的投毒风险时，我们专注于POC本身是否包含恶意代码，而非其所利用漏洞的危害。从提供的输入数据来看，该POC代码主要由一个`README.md`文档和一段HTTP请求的截断片段组成。

**代码内容分析：**
*   `README.md`：这是一份纯文本说明文档，详细描述了漏洞的背景、影响、技术细节和利用方式。它不包含任何可执行代码、外部链接或二进制文件。其内容清晰、专业，没有任何混淆或可疑的迹象。
*   HTTP请求片段：这是一个标准的HTTP POST请求模板，包含头部信息和请求体的一部分。请求体中展示的是用于触发RCE的恶意载荷结构（例如`"then": "$1:__..."`）。这个载荷本身是为了演示攻击原理，旨在执行目标系统上的命令，而非在运行POC的环境中执行恶意操作。它不包含任何针对POC执行者的恶意指令。

**行为分析：**
*   **无外部依赖：** POC中没有提及需要下载或执行任何外部脚本、可执行文件或通过网络请求加载额外的恶意组件。
*   **无代码混淆：** 所提供的文本内容（`README.md`和HTTP片段）清晰易读，没有经过任何形式的混淆处理。
*   **无非预期行为：** 基于现有信息，此POC旨在演示RCE漏洞的利用方式，其设计目标是让研究者理解如何构造恶意请求以影响目标系统，而不是在研究者本地机器上执行恶意操作或窃取信息。

**结论：**
综合来看，该POC的投毒风险极低（评分为10%）。它是一个关于漏洞利用方法的详细描述和攻击载荷的示例，其本身不包含恶意功能，也不会在研究人员的系统上执行除演示攻击载荷之外的任何操作。

然而，作为防御性安全研究人员，我们始终强调在使用任何来源的POC时都应保持高度警惕。即使该POC本身是干净的，但以下通用风险仍需注意：
1.  **社会工程学风险：** 攻击者可能将看似无害的POC包装成恶意软件。
2.  **供应链风险：** 如果POC来自一个实际的代码仓库，且该仓库被劫持，攻击者可能会注入恶意代码。
3.  **误用风险：** 即使POC本身无害，不当使用或在生产环境中执行攻击载荷都可能导致严重后果。

因此，建议始终在隔离的、受控的环境（例如沙箱或虚拟机）中审查和测试POC，并对所有涉及的代码进行彻底的静态和动态分析，以确保其安全性和预期行为。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
