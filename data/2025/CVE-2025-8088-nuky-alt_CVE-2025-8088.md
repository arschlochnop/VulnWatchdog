## CVE-2025-8088 - WinRAR Path Traversal / 目录遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** Path Traversal / 目录遍历

**影响应用:** WinRAR

**危害等级:** High

**CVSS评分:** 8.8

**影响版本:** WinRAR for Windows < 7.13

**利用条件:** 需要用户交互（解压恶意压缩包），无需认证，通常通过社会工程学（钓鱼）投递。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重路径遍历漏洞。该漏洞允许攻击者通过制作特殊的恶意压缩文件（如RAR或ZIP），在用户解压时绕过WinRAR的文件验证机制，将恶意文件写入任意系统目录，特别是Windows的启动文件夹（`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）。这种机制利用了Windows NTFS备用数据流（ADS）特性和路径遍历技术。攻击者可借此在用户下次登录或重启系统时自动执行恶意负载，从而实现任意代码执行和持久化控制。多个威胁组织，包括UNC4895 (RomCom)、APT44、Turla等，已被发现利用此漏洞针对乌克兰军事及政府机构进行攻击，并有中国境内的非法攻击团伙利用。该漏洞的危害等级被评定为“高危”。

该POC的`README.md`提供了非常详细且全面的概念验证分析，详细阐述了漏洞的原理、攻击向量、感染过程及实现持久化的方法。尽管未直接提供可执行的攻击代码，但其文档质量极高，清晰地解释了从恶意文件投递到最终代码执行的完整攻击链。它深入探讨了RAR 5.0文件头的操作，这是实现路径遍历的关键技术，能够强制WinRAR将恶意文件写入非预期目录。POC明确指出攻击目标是Windows的启动文件夹，确保了在系统重启后的自动执行，从而实现了攻击的持久性。这使得研究人员能够充分理解漏洞机制并复现其利用过程。

利用步骤如下：
1. 攻击者首先通过精心制作一个恶意的RAR压缩文件。这个文件内部包含恶意可执行文件或脚本，并对其文件头中的路径信息进行特殊构造，利用目录遍历漏洞和NTFS备用数据流特性，使其在解压时能指向系统关键目录。
2. 攻击者随后将这个恶意RAR文件通过社会工程学手段（例如，钓鱼邮件，伪装成简历、报告等诱饵）发送给受害者。
3. 受害者在使用存在漏洞的WinRAR版本（如低于7.13的Windows版WinRAR）打开并解压此恶意RAR文件时，WinRAR会错误地将恶意负载写入攻击者指定的系统目录，例如`C:\Users\<用户名>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`。
4. 一旦恶意文件被放置在启动文件夹中，在受害者下次登录系统或系统重启时，该恶意负载便会自动执行。
5. 成功执行后，攻击者即可在受害者的系统上实现任意代码执行、植入后门并获取持久化控制。

对投毒风险的分析表明，此POC代码的投毒风险极低，估计为10%。`README.md`明确指出其目的是进行“安全分析”，并提及其中包含“分析脚本（非利用脚本）”。这意味着该项目旨在帮助安全研究人员理解和模拟CVE-2025-8088漏洞的利用方式，而不是作为一个恶意工具本身去感染用户。POC中讨论的“payload”（恶意负载）是指通过利用该漏洞所植入的攻击者控制代码，而非POC代码本身携带的恶意成分。该POC旨在展示如何构造一个利用漏洞的恶意文件，而不是自身具备恶意功能或试图感染研究人员的系统。其清晰的文档和强调分析性质的声明，符合合法的防御性安全研究规范，将研究人员面临的意外恶意行为风险降至最低。因此，在合理的安全研究环境下使用此POC，其代码本身对研究环境造成危害的可能性非常小。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
