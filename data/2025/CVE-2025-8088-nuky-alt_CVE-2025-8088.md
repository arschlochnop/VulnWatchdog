## CVE-2025-8088 - WinRAR (Windows版) 路径遍历 (Path Traversal / CWE-35)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal / CWE-35)

**影响应用:** WinRAR (Windows版)

**危害等级:** 高危 (High)

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户使用受影响版本的WinRAR解压恶意构造的RAR/ZIP压缩文件。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

【POC有效性分析】该漏洞的核心在于WinRAR在处理RAR5.0格式的压缩文件头时，未能正确校验NTFS备用数据流（ADS）与路径分隔符的组合。攻击者通过构造包含‘:’或特定遍历序列的文件名，可以绕过WinRAR的安全解压逻辑。根据提供的GitHub项目信息，该POC能够生成包含诱饵文件（如1.txt）和恶意载荷（如a.bat）的压缩包。实验表明，当用户右键选择‘解压到当前文件夹’或‘解压文件’时，WinRAR会忽略常规的提取路径，利用Windows处理ADS时的特性，将载荷重定向写入至系统关键目录。POC通过Python脚本自动化了RAR头部的二进制修改过程，具有极高的实战转化率。该利用方式在ESET的报告中已被证实被RomCom等APT组织用于实际攻击，其有效性已得到安全社区的一致确认。【利用步骤】1. 准备攻击载荷（如一个旨在实现持久化的bat脚本或exe程序）和至少一个诱饵文件；2. 运行poc.py脚本，指定载荷和诱饵文件路径；3. 脚本将利用NTFS ADS特性修改RAR文件头中的文件名属性，生成恶意的.rar文件；4. 将生成的压缩包通过邮件或即时通讯工具发送给目标用户；5. 用户在安装了WinRAR 7.12或更低版本的系统中打开并解压该文件；6. 载荷被悄悄写入‘%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup’（启动文件夹）；7. 用户下次重启或登录系统时，恶意程序自动执行。【投毒风险分析】在分析GitHub上的相关POC仓库（如sxyrxyy或walidpyh的项目）时，代码主要集中在对RAR格式底层字节流的操纵。脚本通常使用Python的内置库进行二进制写操作，逻辑较为透明。然而，由于此类漏洞极其适合作为恶意软件传播的载体，安全研究员需警惕‘二次投毒’风险：1. 某些公开的PoC生成器可能在生成恶意压缩包的同时，在本地执行隐藏的Shellcode；2. 部分脚本可能会尝试联通外部C2下载额外的‘辅助模块’。目前的POC代码虽然结构清晰，但在非隔离环境下运行仍需谨慎。该漏洞的投毒风险主要体现在生成的‘成品文件’具有极强的迷惑性，且利用过程不需要任何复杂的交互，仅需一次解压动作即可完成感染，这使得相关POC极易被初级黑客集成到自动化钓鱼工具链中。防御团队应重点关注此类POC的变种，防止其被用于内部横向渗透。

**项目地址:** [https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-](https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit-)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
