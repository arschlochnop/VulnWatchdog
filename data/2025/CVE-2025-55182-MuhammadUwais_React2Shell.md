## CVE-2025-55182 - React Server Components (RSC), Next.js App Router, react-server-dom-we 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC), Next.js App Router, react-server-dom-we

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 使用React Server Components (RSC) 和 Next.js App Router 的应用，特别是依赖 `react-server-dom-we` 的版本。

**利用条件:** 未认证 (Unauthenticated), 网络可达 (Network Accessible), 无需用户交互 (对于漏洞利用本身，但POC工具需要用户手动触发)

**POC 可用性:** 9

**POC 类型:** 完整利用工具

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，CVSS评分高达10.0。该漏洞存在于React Server Components (RSC) 和 Next.js 应用程序中。其核心问题源于对“Flight”协议数据的不安全反序列化处理。Flight协议是一种JSON-like的流式格式，用于在服务端渲染组件并将其序列化发送到客户端。攻击者可以通过精心构造的请求，在未经认证的情况下操纵服务器端的组件处理流程，最终在服务器上执行任意代码。此漏洞自2025年12月3日披露以来，已遭到大规模的实际利用，甚至在数小时内就被与特定国家关联的威胁行为者积极利用，显示出其极高的攻击价值和广泛的潜在影响。

**POC有效性分析:**
提供的POC代码是一个名为“RSC Sentinel”的Firefox浏览器扩展。它是一个功能完备的工具，旨在帮助安全研究人员和教育者检测并利用CVE-2025-55182漏洞。该扩展提供了多重功能：首先，它能被动检测Web应用程序中的React Server Components和Next.js App Router指示器；其次，它允许用户发起主动的指纹探测以收集额外信息；最关键的是，它提供了“手动命令执行”功能，使用户能够在授权测试下执行远程代码。`README.md`文件清晰地描述了该扩展的特性、安装步骤（通过Firefox的临时加载插件功能）和使用方法，这表明其具有高可用性和完善的文档。虽然POC的利用过程需要用户通过浏览器扩展手动触发，而不是一个完全自动化的脚本，但其提供了一个清晰且可控的手段来验证和利用漏洞的RCE能力。`background.js`文件（尽管已截断）显示了处理浏览器扩展消息的标准模式，这与扩展的功能描述一致。鉴于其完整的功能集、明确的指导和用户驱动的利用方式，该POC被评估为高质量的完整利用工具，能够有效地证明和利用CVE-2025-55182的RCE能力。

**利用步骤:**
1.  **环境准备**: 确保已安装Firefox浏览器。
2.  **安装RSC Sentinel扩展**:
    *   在Firefox浏览器中，导航至 `about:debugging`。
    *   选择左侧的“This Firefox”选项。
    *   点击“Load Temporary Add-on”按钮。
    *   在文件选择对话框中，定位到RSC Sentinel项目目录，并选择 `manifest.json` 文件进行加载。扩展将立即加载并激活。
3.  **被动检测**: 正常浏览目标Web应用程序。RSC Sentinel将在后台自动监控HTTP响应头和内容模式，以识别React Server Components (RSC) 和 Next.js App Router 的潜在指示器。
4.  **查看检测结果**: 点击Firefox工具栏上的RSC Sentinel扩展图标，打开弹出界面，查看被动检测到的信号。
5.  **主动探测 (可选，需授权)**: 在获得明确授权的情况下，点击弹出界面中的“Run fingerprint probe”按钮，发起一次主动探测请求，以收集更多关于目标应用程序的RSC/Next.js相关信息。
6.  **手动命令执行 (可选，需授权)**: 在严格授权的测试环境下，通过扩展提供的“Manual Command Execution”功能来构造并发送恶意请求。攻击者需要利用对React Server Components“Flight”协议的深入理解，精心构造恶意数据流，使其在服务端被不安全地反序列化，从而触发远程代码执行。这个过程需要用户手动输入或配置要执行的命令，并通过扩展界面将其发送到目标服务器。

**投毒风险分析:**
对“RSC Sentinel”POC代码的投毒风险评估为低（5%）。此评估基于以下几个关键因素：
1.  **明确的合法目的与警告**: `README.md` 文件明确指出该工具是为“安全研究员和教育者”设计，用于合法目的。它包含了强烈的“负责任使用”警告，强调“仅用于您拥有或获得明确许可的系统上进行测试”，并明确表示“作者不对滥用负责”。这种透明度和对道德使用的强调显著降低了其作为恶意软件传播的直接风险。
2.  **代码行为的透明性与预期性**: 提供的`background.js`代码片段（尽管不完整）显示了处理浏览器扩展消息的典型模式，这与扩展作为安全工具的描述一致。`README.md`中描述的“被动检测”、“主动探测”和“手动命令执行”功能均是安全测试工具的常见功能。特别是“命令执行”被明确描述为“手动、用户驱动的执行流程”，意味着需要用户明确授权和主动触发，而非自动或秘密执行恶意负载。
3.  **缺乏恶意特征**: 在可用的代码片段和文档中，没有发现任何混淆代码、从未知或可疑外部URL加载恶意脚本、或包含如后门、勒索软件、信息窃取等恶意负载的迹象。项目结构是标准的浏览器扩展结构，便于代码审查和功能理解。
4.  **定位为攻击目标系统的工具而非自身攻击**: 该POC的设计目的是帮助用户识别并利用 *目标系统* 的漏洞，而不是攻击 *运行该POC的用户或系统本身*。因此，它不包含会危害用户自身的投毒代码。风险主要集中在使用者可能滥用该工具进行非法或未经授权的活动，而非工具本身携带恶意功能。综合来看，只要用户从可信来源获取该POC并负责任地使用，其自身的供应链投毒风险极低。

**项目地址:** N/A - POC是本地目录中的Firefox扩展，未提供公共仓库URL。

**漏洞详情:** https://cloud.tencent.com/developer/article/2609893
