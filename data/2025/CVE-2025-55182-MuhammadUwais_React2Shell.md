## CVE-2025-55182 - React Server Components (RSC), Next.js 远程代码执行 (RCE) / 不安全反序列化

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE) / 不安全反序列化

**影响应用:** React Server Components (RSC), Next.js

**危害等级:** 严重 (Critical)

**CVSS评分:** 未披露，预计9.8 (Critical)

**影响版本:** Next.js 15.0.0-16.0.6 (可能涉及其他使用React Server Components的应用)

**利用条件:** 无需认证，网络可达，通过构造特殊HTTP请求即可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，又称“React2Shell”，是一个针对React Server Components (RSC) 和 Next.js 框架的严重远程代码执行（RCE）漏洞。该漏洞源于RSC架构中的不安全反序列化缺陷，允许攻击者在未经身份验证的情况下，通过发送精心构造的HTTP请求，操纵Flight协议（一种JSON-like流式格式）中的用户输入处理逻辑，从而在服务器端触发反序列化过程并执行任意代码。Next.js框架在版本15.0.0到16.0.6之间受到此漏洞影响。该漏洞具备影响范围广、攻击门槛低、危害程度高等特点，自2025年12月3日公开披露以来，已观察到大规模的实际利用，甚至被用于传播NutsBot僵尸网络，对部署了受影响版本的Web应用构成“核弹级”威胁。

**POC有效性分析:**
提供的POC是一个名为“RSC Sentinel”的Firefox浏览器扩展程序，旨在帮助安全研究人员和教育工作者检测和（在授权情况下）利用CVE-2025-55182（以及CVE-2025-66478）。该扩展分为三个主要功能：
1.  **被动检测 (Passive Detection)**：在正常浏览时自动监控高层次的RSC和App Router指标，无需用户干预。
2.  **主动探测 (Active Probing)**：允许用户发起指纹识别请求，以在受控方式下收集额外信号。
3.  **手动命令执行 (Manual Command Execution)**：此功能专门设计用于授权测试，提供一个用户驱动的执行流程，允许在受影响的服务器上执行任意命令。
POC的文档（`README.md`）非常详细，清晰地说明了其功能、安装步骤、使用方法以及项目结构。它强调了负责任使用和仅在授权系统上测试的重要性。尽管提供的代码片段是截断的（仅`background.js`的一部分），但根据描述，该扩展程序提供了一个完整的工具集，能够从检测到最终的用户驱动的RCE利用。因此，作为一款实现其设计目标的综合性安全工具，该POC的质量很高。

**利用步骤:**
1.  **安装扩展程序**:
    *   在Firefox浏览器中，导航至 `about:debugging`。
    *   在左侧边栏选择 **This Firefox**。
    *   点击 **Load Temporary Add-on**。
    *   选择POC项目目录中的 `manifest.json` 文件以加载扩展程序。
2.  **被动检测**:
    正常浏览网页，RSC Sentinel将在后台自动检测潜在的RSC和Next.js App Router指标。用户可以从Firefox工具栏打开扩展程序弹窗查看检测到的信号。
3.  **主动探测 (可选)**:
    在授权评估中，用户可以通过弹窗界面选择 **Run fingerprint probe** 以发起一个手动探测请求，收集更多信号。
4.  **手动命令执行 (利用)**:
    在确认目标系统存在漏洞并获得明确授权后，用户可以通过扩展程序的弹窗UI来触发手动命令执行功能。具体操作通常会涉及在扩展界面中输入待执行的命令，然后由扩展程序构造并发送特制的HTTP请求，利用不安全的反序列化漏洞在目标服务器上执行该命令。这个过程是用户驱动的，并且需要用户明确选择执行操作。

**投毒风险分析:**
RSC Sentinel被明确声明为一个开源的、用于教育和授权安全研究目的的工具。`README.md`中包含了多处负责任使用和法律伦理规范的警告，这表明其作者的意图是良性的。
1.  **代码清晰度与混淆**: 虽然提供了代码片段是截断的，但 `README.md` 中展示的项目结构和描述暗示了代码是结构化和可理解的。没有证据表明存在代码混淆或加密以隐藏恶意行为。
2.  **外部依赖与请求**: 作为一个浏览器扩展，它会与正在浏览的网站进行交互。其功能设计专注于本地检测和用户发起的探测/命令执行，没有迹象表明它会未经用户同意向外部未知服务器发送敏感数据或下载执行恶意脚本。
3.  **恶意行为检测**: 提供的 `background.js` 示例片段 (`chrome.runtime.onMessage.addListener`) 是浏览器扩展中常见的消息监听模式，本身不含恶意。其核心功能是基于用户交互触发的，降低了自动投毒的风险。
4.  **用户控制**: RCE功能被明确标记为“Manual Command Execution”，并强调“user-driven execution workflow intended strictly for authorized testing”。这意味着，即使利用功能存在，也需要用户主动触发，并且是在用户明确知情和授权的情况下进行。综合来看，该POC作为安全研究工具，其投毒风险极低。它旨在帮助防御者理解和测试漏洞，而非隐蔽地攻击用户。其开放源代码的性质也允许安全社区对其进行审查。鉴于其高度透明的意图和操作模式，投毒风险评估为5%。

**项目地址:** 

**漏洞详情:** 
