## CVE-2025-13486 - Advanced Custom Fields: Extended Remote Code Execution

**漏洞编号:** CVE-2025-13486

**漏洞类型:** Remote Code Execution

**影响应用:** Advanced Custom Fields: Extended

**危害等级:** Critical

**CVSS评分:** 未提供，待定

**影响版本:** 未知，需要进一步分析确定

**利用条件:** 需要能够访问WordPress后台，可能需要某些权限

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-13486 存在于 Advanced Custom Fields: Extended 插件中，允许远程代码执行。该漏洞的POC代码利用了 `acfe/form/render_form_ajax` action，通过构造恶意的 `form[render]` 参数，可以调用任意函数，从而执行任意代码。经过分析，该POC的有效性较高。首先，它通过 `get_nonce` 函数获取 WordPress 的 nonce 值，然后构造包含恶意参数的 payload，发送到 `/wp-admin/admin-ajax.php`。该 payload 将 `form[render]` 设置为 `wp_insert_user`，用于创建新的管理员用户。如果攻击成功，将在 WordPress 站点上创建一个具有指定用户名、密码和电子邮件地址的新管理员帐户。这使得攻击者可以完全控制受感染的 WordPress 站点。 

利用步骤如下：
1. 找到存在漏洞的 WordPress 站点，该站点使用了 Advanced Custom Fields: Extended 插件。
2. 运行 POC 脚本，提供目标站点的 URL，以及要创建的管理员用户的用户名、密码和电子邮件地址。
3. 脚本将尝试获取 nonce 值，并构造包含恶意参数的 payload。
4. 脚本将 payload 发送到 `/wp-admin/admin-ajax.php`。
5. 如果攻击成功，脚本将输出成功消息，并显示新创建的管理员用户的凭据。
6. 使用新创建的管理员帐户登录 WordPress 后台。

投毒风险分析：该POC代码的投毒风险为中等。代码本身相对清晰，没有明显的混淆或恶意行为。它使用了 `requests` 库发送 HTTP 请求，使用了 `urllib.parse` 库处理 URL。然而，该代码确实可以被修改以包含恶意代码。例如，攻击者可以在 `wp_insert_user` 之后添加额外的函数调用，以执行其他恶意操作，例如安装后门、篡改数据库或窃取敏感信息。此外，如果攻击者控制了运行 POC 脚本的服务器，他们可以修改脚本以针对特定的目标，或收集有关受感染站点的信息。POC使用verify=False来忽略SSL证书验证，这在生产环境中是不安全的。POC使用了print_r进行验证，这可能暴露敏感信息。
虽然该POC主要依赖于标准的 Python 库，降低了直接植入恶意代码的可能，但仍需警惕攻击者利用其开放性进行二次开发，例如嵌入隐蔽的后门代码或数据收集模块，从而在用户不知情的情况下窃取敏感信息或进行恶意活动。此外，该脚本创建管理员用户的行为本身就具有一定的风险，可能被滥用于非法入侵和控制网站。因此，在使用和传播该POC时，务必保持警惕，并采取必要的安全措施，例如代码审查、安全扫描和行为监控，以防止潜在的投毒风险。

**项目地址:** https://github.com/projectdiscovery/nuclei-templates/issues/14212

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-13486
