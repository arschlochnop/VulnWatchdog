## CVE-2025-14847 - MongoDB Server 信息泄露/堆内存读取

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 信息泄露/堆内存读取

**影响应用:** MongoDB Server

**危害等级:** 高危

**CVSS评分:** 8.7

**影响版本:** MongoDB 8.2.0-8.2.3, 8.0.0-8.0.16, 7.0.0-7.0.26, 6.0.0-6.0.26, 5.0.0-5.0.31, 4.4.0-4.4.29, 以及所有 4.2, 4.0, 3.6 版本

**利用条件:** 远程访问，未授权，启用 zlib 网络消息压缩

**POC 可用性:** 7/10

**POC 类型:** 概念验证/环境搭建

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：本漏洞源于 MongoDB 在处理使用 zlib 压缩的协议头时，存在长度字段不匹配的逻辑错误。攻击者通过发送精心构造的畸形 zlib 压缩请求包，可以诱导服务端在解压或处理缓冲区时，读取并返回未初始化的堆内存数据。提供的 POC 数据集包含了一个完整的漏洞复现环境。其中 docker-compose.yml 明确指定了受影响的 mongo:7.0.5 版本，并通过命令行参数显式启用了 --networkMessageCompressors zlib，这是漏洞触发的核心前置条件。init-db.js 文件用于模拟真实业务环境中的敏感数据（如 flag{...} 和 admin_backup_key），这对于验证漏洞是否能泄露特定内存块非常有帮助。虽然 README.md 指向了官方的 Jira 记录和 Git 提交记录，且仓库内包含 AI 生成的辅助内容，但其提供的测试逻辑（即 message_compressor_manager_test.cpp 的引用）与漏洞成因高度契合，具有极高的实战防御研究价值。利用步骤：1. 部署提供的 docker-compose 环境。2. 攻击者使用支持 zlib 压缩的 MongoDB 客户端或原始套接字连接到 27017 端口。3. 构造一个包含错误长度字段的 zlib 压缩 OP_MSG 或其他通信协议包。4. 发送该数据包至服务端，服务端在解析压缩头时因字段校验失效导致读取超出预定范围的堆内存。5. 接收并解析服务端返回的数据，从中提取敏感信息。投毒风险分析：该 POC 的主要投毒风险较低，约为 10%。分析其提供的代码构成：docker-compose.yml 使用的是官方公开镜像，无自定义 Dockerfile 或恶意镜像引用。init-db.js 仅用于在本地容器内填充模拟数据，脚本内容均为标准的 MongoDB Shell 语法，无混淆或网络外连行为。虽然 README 中提到‘该仓库内容包含 AI 生成’，这暗示文档或部分辅助脚本可能存在逻辑瑕疵，但从核心防御研究角度看，其主要目的是提供实验环境。需要注意的风险点在于引用的外部链接和可能存在的隐藏脚本，但在目前的输入数据中，代码逻辑清晰且遵循标准开发规范。用户在复现时应重点检查是否包含自动执行的 shell 脚本（如后门或反弹 shell），但本案例中暂未发现此类恶意特征。该项目更偏向于 CTF 挑战和防御加固演示，而非恶意软件传播载体。

**项目地址:** /tmp/vulnwatchdog_a1ffd1fc04388aba77cade26052664b3/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14847](https://nvd.nist.gov/vuln/detail/CVE-2025-14847)
