## CVE-2025-49144 - Notepad++ 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Notepad++

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (预计)

**影响版本:** v8.8.1 及更早版本

**利用条件:** 本地访问权限；能够将恶意文件放置在与安装程序相同的目录下；诱导管理员运行安装程序

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞属于典型的‘DLL/可执行文件劫持’路径搜索漏洞。经过对披露的POC代码分析，该安装程序在执行过程中调用 regsvr32.exe 时未指定绝对路径。根据Windows系统的搜索顺序，它会优先在当前目录（即安装程序所在目录）查找。POC提供了一个完整的利用链路：通过msfvenom生成恶意shellcode，并使用C语言编写一个伪造的regsvr32.exe加载器进行编译。当安装程序以管理员权限运行时，由于系统搜索机制，它会加载并执行同一目录下的恶意regsvr32.exe。由于安装程序通常需要提升权限（UAC），攻击者的代码将直接在 SYSTEM 权限下运行，从而实现从普通用户到系统最高权限的跨越。经评估，该POC逻辑清晰，技术路径符合Windows系统特性，在未打补丁的 v8.8.1 版本中具有极高的复现成功率。利用步骤：首先，攻击者需要使用 msfvenom 或类似工具生成针对 Windows x64 平台的反弹 Shell 或 payload。其次，将 payload 嵌入到 POC 提供的 regsvr32_loader.c 模板中，并使用交叉编译器（如 x86_64-w64-mingw32-gcc）将其编译为名为 regsvr32.exe 的可执行文件。接着，将该恶意文件放置在受害者的下载目录中。最后，诱导或等待受害者下载并运行官方的 Notepad++ v8.8.1 安装程序。在安装过程中，恶意代码将被自动触发。投毒风险分析：针对该特定漏洞的投毒风险处于较低水平，但仍需警惕。分析发现，Github 上的 POC 项目代码结构透明，主要由 README 文档、C 源码和 shellcode 填充说明组成，未发现混淆代码或隐蔽的外部连接。然而，风险点在于攻击者可能通过‘社会工程学’手段，在非官方渠道发布捆绑了该恶意 regsvr32.exe 的 Notepad++ 压缩包。此外，由于该漏洞利用了安装程序的信任属性，某些‘一键复现脚本’可能在编译阶段引入恶意第三方库或在 payload 注入环节植入后门。防御者在测试此 POC 时，应严格在隔离的虚拟机环境中操作，并确保关闭实时监控以防止干扰实验。总体而言，该 POC 是用于安全教育和防御验证的正向工具，但在分发过程中存在被二次打包投毒的可能性，建议通过哈希值校验确认源码完整性。

**项目地址:** [https://github.com/ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
