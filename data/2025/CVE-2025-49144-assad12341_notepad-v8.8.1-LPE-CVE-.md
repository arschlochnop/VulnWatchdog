## CVE-2025-49144 - Notepad++ Installer DLL劫持/不受控制的可执行文件搜索路径

**漏洞编号:** CVE-2025-49144

**漏洞类型:** DLL劫持/不受控制的可执行文件搜索路径

**影响应用:** Notepad++ Installer

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (预计)

**影响版本:** Notepad++ v8.8.1 及更早版本

**利用条件:** 攻击者需具备本地低权限访问权限，并能将文件放置在安装程序所在的目录中（如下载目录）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对Notepad++安装程序在执行过程中未指定regsvr32.exe完整路径的缺陷。由于Windows系统的DLL/执行文件搜索顺序，安装程序会优先检查当前目录。POC通过msfvenom生成恶意shellcode并利用Mingw编译器构建伪造的regsvr32.exe。经分析，该利用链逻辑完整，步骤清晰，在关闭Windows Defender的环境下可稳健触发SYSTEM权限回连，具有极高的实战参考价值。利用步骤：1. 使用msfvenom生成Windows x64反弹Shell代码；2. 将Shellcode植入提供的loader源文件并使用gcc编译生成伪造的regsvr32.exe；3. 配置Metasploit监听器；4. 将编译好的恶意exe放置在Notepad++ v8.8.1安装包同级目录下；5. 诱导用户或以管理员身份运行安装程序，安装程序在尝试注册组件时会加载当前目录下的伪造程序，从而实现提权。投毒风险分析：该POC代码本身公开透明，主要由C语言加载器和标准的Metasploit payload组成，未发现隐藏的恶意混淆或第三方下载指令。代码逻辑主要集中在内存加载shellcode，属于典型的安全研究范畴。尽管存在15%的潜在风险（主要来自用户从非官方仓库下载预编译好的exe文件），但从源码层面看，其行为是可预测且易于审计的。该POC不属于恶意投毒工具，但由于其提权效果显著，防御方应重点监控安装程序目录下的异常可执行文件生成行为。建议组织立即更新Notepad++至v8.8.2版本，并利用AppLocker等工具限制从用户可写目录（如Downloads）执行程序。

**项目地址:** [https://github.com/user-attachments/assets/b828c797-8025-4d44-8bbb-31dfd5887a59](https://github.com/user-attachments/assets/b828c797-8025-4d44-8bbb-31dfd5887a59)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
