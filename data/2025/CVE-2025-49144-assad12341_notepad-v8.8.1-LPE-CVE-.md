## CVE-2025-49144 - Notepad++ 本地权限提升 (LPE) / 路径遍历与搜索顺序劫持

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (LPE) / 路径遍历与搜索顺序劫持

**影响应用:** Notepad++

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H

**影响版本:** Notepad++ v8.8.1 及之前版本

**利用条件:** 攻击者需具备本地低权限访问权限，并能将恶意文件放置在安装程序同级目录下；需要诱导管理员运行安装程序。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞本质上是典型的二进制搜索路径劫持（Binary Planting）。Notepad++安装程序在执行过程中调用系统组件regsvr32.exe时未指定绝对路径。根据Windows操作系统的搜索机制，程序会优先在当前启动目录（如用户的Downloads文件夹）中寻找该执行文件。提供的POC代码通过Mingw-w64编译一个伪造的regsvr32.exe，该伪造程序实质上是一个加载器，用于执行通过msfvenom生成的Meterpreter Shellcode。由于安装程序通常需要管理员权限运行，被劫持的恶意regsvr32.exe将继承该权限，最终在NT AUTHORITY\SYSTEM上下文中执行。此POC逻辑清晰，复现步骤完整，包括Payload生成、编译命令及监听配置，具有极高的实战参考价值和有效性。其利用的关键点在于安装器请求UAC提权后的权限传递。此外，搜索结果中提到的CVE-2025-8088（WinRAR）和React相关漏洞反映了2025年供应链及基础软件安全形势的严峻性，进一步证实了此类安装包劫持漏洞的普遍威胁。

【利用步骤】1. 使用msfvenom生成针对Windows x64架构的reverse_tcp Shellcode并保存为文本。2. 获取POC提供的regsvr32_loader.c源码，将生成的Shellcode嵌入到代码指定的变量位置。3. 使用x86_64-w64-mingw32-gcc编译器将源码编译为名为regsvr32.exe的可执行文件。4. 在攻击机上配置Metasploit的multi/handler监听器，匹配对应的Payload、LHOST和LPORT。5. 将编译好的恶意regsvr32.exe放置在目标机器的下载目录中。6. 获取受影响版本的Notepad++安装包（v8.8.1或更早版本）并将其放入同一目录。7. 诱导用户运行安装程序，在安装过程中，系统会自动加载并运行同目录下的恶意regsvr32.exe。8. 攻击者在监听端接收到具有SYSTEM权限的反弹Shell。

【投毒风险分析】从POC代码结构来看，该项目主要作为安全研究和演示目的。代码主体为标准C语言，使用了通用的Windows API调用，未发现明显的恶意混淆或针对研究者环境的破坏性行为。然而，投毒风险主要源于两个方面：第一，Payload部分。POC要求用户自行填入Shellcode，这虽然降低了直接中毒的风险，但如果用户从第三方不可信来源获取预编译的regsvr32.exe，则极易被植入后门。第二，工具链风险。在编译阶段，如果使用的交叉编译环境（如Mingw）本身不安全，生成的二进制文件可能携带额外载荷。目前该README说明文档详尽，公开了底层原理，属于典型的白帽研究成果。但考虑到其针对的是高频使用的Notepad++软件，攻击者可能利用此POC制作看似合法的补丁或“一键修复工具”进行二次传播。整体投毒风险评定为15%，属于较低水平，主要风险在于研究者对Shellcode来源的把控。防御方应重点关注安装程序启动目录的文件完整性，并建议升级至v8.8.2以修复路径硬编码问题。

**项目地址:** [https://github.com/user-attachments/assets/b828c797-8025-4d44-8bbb-31dfd5887a59](https://github.com/user-attachments/assets/b828c797-8025-4d44-8bbb-31dfd5887a59)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
