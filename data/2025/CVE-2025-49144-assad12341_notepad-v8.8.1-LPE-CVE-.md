## CVE-2025-49144 - Notepad++ Installer 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Notepad++ Installer

**危害等级:** 高 (High)

**CVSS评分:** N/A (NVD Awaiting Analysis)

**影响版本:** <= 8.8.1

**利用条件:** 本地访问权限；诱导具备管理员权限的用户运行放置在特定目录下的安装程序；在同一目录下预先放置恶意可执行文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞属于典型的‘不安全的可执行文件搜索路径’（Uncontrolled Executable Search Path）漏洞。Notepad++ 8.8.1及之前版本的安装程序在执行过程中会调用系统组件 regsvr32.exe 来注册DLL，但在调用时未指定绝对路径（如 C:\Windows\System32\regsvr32.exe）。根据Windows系统的加载机制，程序会优先在当前目录（即安装包所在目录，如‘下载’文件夹）中搜索同名文件。由于安装程序通常请求管理员权限运行，如果攻击者预先在同一目录下放置了一个恶意的 regsvr32.exe，安装程序将以 SYSTEM 权限执行该恶意文件，从而实现从普通用户到系统最高权限的提升。PoC代码展示了通过 msfvenom 生成 shellcode 并通过 C 语言加载器编译成伪造的 regsvr32.exe，配合安装程序的触发流程，逻辑清晰且高度可行。利用步骤：1. 使用 msfvenom 生成针对 Windows x64 的反弹 Shell 载荷。2. 将载荷嵌入 regsvr32_loader.c 源代码中。3. 使用跨平台编译器 x86_64-w64-mingw32-gcc 将源代码编译为名为 regsvr32.exe 的可执行文件。4. 在攻击机上启动 Metasploit 的 multi/handler 监听器。5. 将编译好的恶意 regsvr32.exe 放置在受害者机器的某个文件夹（如 Downloads）中。6. 诱导受害者将合法的 Notepad++ v8.8.1 安装程序下载到同一文件夹并运行。7. 安装程序启动后会自动调用同目录下的恶意 regsvr32.exe，攻击者在监听端即可获得 SYSTEM 权限的 Shell。投毒风险分析：该 PoC 项目（ammarm0010/CVE-2025-49144_PoC）目前表现为标准的网络安全教育和渗透测试研究用途。代码逻辑透明，核心操作是编译一个自定义的可执行文件，而非分发预编译的二进制后门。由于 README 明确指导用户使用 msfvenom 生成自己的 shellcode，这降低了直接包含静态后门的嫌疑。然而，投毒风险在于：第一，该漏洞利用高度依赖社会工程学，攻击者可能分发捆绑了恶意 regsvr32.exe 的压缩包。第二，虽然当前仓库代码清晰，但此类 LPE 漏洞常被二次封装成‘一键自动化脚本’，在非官方渠道分发时，脚本内部可能被植入针对研究者本人的远控木马或窃密组件。鉴于目前代码为源代码形式且逻辑符合渗透测试规范，判定投毒风险为低，但仍需警惕任何要求关闭防火墙运行的第三方预编译版本。

**项目地址:** [https://github.com/ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
