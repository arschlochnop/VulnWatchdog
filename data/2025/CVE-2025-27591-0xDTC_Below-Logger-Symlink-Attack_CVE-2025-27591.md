## CVE-2025-27591 - Below (Facebook/Meta 开源的资源监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook/Meta 开源的资源监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 小于 v0.9.0

**利用条件:** 本地普通用户权限，系统安装有受影响版本的 Below 服务

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对CVE-2025-27591漏洞，利用了Below服务在初始化日志目录/var/log/below时存在的错误权限配置（world-writable，即777权限）。有效性分析如下：1. 权限基础：POC首先通过check_world_writable函数验证目标目录权限，确认非特权用户是否具备写入权，这是漏洞利用的前提。2. 攻击向量：漏洞核心在于Below服务会以root权限向/var/log/below下的日志文件写入内容。由于该目录对所有用户可写，攻击者可以预先创建一个指向敏感文件（如/etc/passwd）的符号链接。3. 提权路径：POC展示了典型的符号链接攻击（Symlink Attack）。它创建了一个指向/etc/passwd的软链接，模拟日志文件。当Below服务尝试写入错误日志时，其root权限会将攻击者构造的内容（如具备root权限的新用户信息）追加到/etc/passwd中。4. 代码实现：脚本包含完善的清理逻辑（cleanup_target_log）和环境检测，自动化程度高，能够准确触发越权写文件行为。利用步骤：首先，攻击者作为本地普通用户登录，确认/var/log/below目录存在且权限为777。其次，执行脚本，脚本会在该目录下创建一个名为error_root.log的符号链接，指向系统敏感文件/etc/passwd。最后，通过某种方式触发Below服务的日志记录行为（例如输入错误参数或停止/启动服务），导致Below以root身份向该链接写入攻击者定义的root级别用户行。一旦写入成功，攻击者即可通过‘su’切换至新创建的root用户，完成提权。【投毒风险分析】该POC项目目前的投毒风险评级为低（15%）。风险分析如下：1. 代码透明度：提供的Bash脚本代码逻辑清晰，主要使用了标准的Linux命令如stat、ln、rm和printf。通过静态分析未发现混淆处理、加密荷载或隐藏的二进制执行文件。2. 外部通信：脚本未包含任何curl、wget或网络套接字操作，这意味着它不会向远程服务器回传受害者主机的敏感信息（如SSH密钥、环境变量等），也不具备下载后续恶意payload的功能。3. 行为意图：脚本的唯一目的非常明确，即通过符号链接修改/etc/passwd。虽然这种行为本身具有破坏性，但它是该漏洞提权PoC的核心逻辑，属于预期的安全研究行为，而非隐藏的后门。4. 潜在风险点：唯一的风险在于脚本修改了/etc/passwd，如果用户在生产环境误用且未及时恢复，可能导致系统账号体系紊乱。此外，脚本中虽然声明由0xDTC‘翻新’，但目前未发现该作者在脚本中插入恶意的逻辑注入。整体来看，该POC是一个典型的安全研究工具，建议研究人员在受控的沙箱环境中使用，并密切监控对敏感系统文件的写操作。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
