## CVE-2025-9074 - Docker API (守护进程) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Docker API (守护进程)

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 所有配置不当的Docker守护进程版本

**利用条件:** 无需认证，需要网络访问Docker API端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析: `cve-2025-9074.sh`是一个针对未授权Docker API的远程代码执行（RCE）PoC。该脚本功能强大且高度有效，能够动态检测目标操作系统的类型（Linux或Windows），并尝试将宿主机的根文件系统（或C盘）挂载到一个新创建的容器中。它首先枚举目标Docker宿主机上已有的镜像，如果未找到，则会尝试拉取`alpine:latest`作为备用（这要求目标宿主机具备互联网连接）。脚本随后创建并启动一个容器，然后通过`exec`命令在容器内执行用户指定的任意命令。由于容器以挂载宿主机根目录的方式运行，这使得攻击者可以在没有认证的情况下，在目标宿主系统上执行任意命令，从而实现完全控制。脚本包含连接检查、容器创建失败处理等错误处理机制，输出清晰，易于理解和使用。

利用步骤:
1. 确认目标Docker守护进程已在网络端口（默认2375）上暴露且未启用认证。
2. 下载并赋予`cve-2025-9074.sh`执行权限：`chmod +x cve-2025-9074.sh`。
3. 执行脚本，指定目标IP和欲执行的命令。例如：
    * Linux目标：`./cve-2025-9074.sh 192.168.1.10 'ls -la /host_root'`
    * Windows目标：`./cve-2025-9074.sh 192.168.1.10 'cmd /c dir C:\host_root'`
4. 可选择性地指定非默认端口：`./cve-2025-9074.sh 192.168.1.10 'whoami' 2376`。

投毒风险分析: 该PoC脚本`cve-2025-9074.sh`的投毒风险极低（估计为10%）。脚本采用纯Bash编写，代码逻辑清晰透明，主要通过`curl`与Docker API进行交互，并使用标准的shell工具进行文本处理。脚本中没有发现任何代码混淆、调用可疑外部二进制文件或从不可信源下载并执行恶意代码的行为。其核心功能是作为一种利用工具，帮助安全研究人员或攻击者在脆弱的Docker环境中执行用户指定的命令。尽管其目的是进行利用，但脚本本身并未包含任何旨在危害分析人员系统或执行未预期操作的隐藏恶意负载或后门。所谓的“恶意行为”完全取决于用户在命令行中输入的命令，而非脚本自身的内部机制。经过审阅，该脚本是一个结构良好、目的明确的合法渗透测试工具。

**项目地址:** 无

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
