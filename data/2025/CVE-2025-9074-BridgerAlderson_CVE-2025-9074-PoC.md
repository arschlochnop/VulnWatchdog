## CVE-2025-9074 - Docker Desktop (Windows and macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows and macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Prior to 4.34.2

**利用条件:** Local access to a running Linux container within Docker Desktop; the target's Docker Engine API must be reachable via the default subnet (192.168.65.7:2375).

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC脚本是一个功能完备的Bash利用工具，设计思路非常严谨且具有高度的通用性。它首先通过访问Docker Engine API的/info接口来探测目标系统的操作系统类型（Linux或Windows），以此决定后续挂载路径（宿主机根目录或C盘）。脚本展示了极高的实用价值，因为它能够动态地从API获取现有的镜像列表（RepoTags），避免了因硬编码镜像缺失而导致的利用失败。如果本地没有镜像，它甚至包含了一个向alpine:latest回退的逻辑。利用步骤如下：1. 脚本通过网络访问192.168.65.7:2375（默认隔离失效路径）。2. 调用API创建一个新容器，关键点在于HostConfig中的Binds参数，它将宿主机的根目录挂载到容器内部。3. 启动容器并执行tail -f /dev/null保持存活。4. 通过exec接口在已挂载宿主文件系统的容器内执行任意命令，从而实现从容器到宿主机的实质性逃逸和最高权限控制。由于Docker Desktop在受影响版本中未对该API接口进行严格的来源验证和网络隔离，攻击者只需在受控的轻量级Linux容器中运行此类简单脚本，即可完全接管宿主操作系统。投毒风险分析：该POC本身代码逻辑清晰，主要使用标准的curl命令和简单的字符串处理（grep/sed/cut），不包含二进制组件或混淆代码。脚本中的RED/GREEN/BLUE等变量仅用于终端输出美化。风险评估为低风险（15%），这主要源于脚本具有自动联网拉取镜像（alpine:latest）的能力，在特定的受限环境中，这种外部请求可能被视为异常行为。脚本中没有发现恶意混淆、eval执行加密载荷或回传敏感信息到第三方服务器的逻辑。它的行为符合典型的渗透测试和漏洞验证工具特征。然而，防御者应注意，此类脚本如果被封装在看似合法的Docker镜像中发布到公共仓库（如Docker Hub），则构成供应链投毒。脚本本身是透明的工具，但在恶意分发的场景下，它可能被集成到自动化攻击框架中。

**项目地址:** [https://www.freebuf.com/articles/vuls/445648.html](https://www.freebuf.com/articles/vuls/445648.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
