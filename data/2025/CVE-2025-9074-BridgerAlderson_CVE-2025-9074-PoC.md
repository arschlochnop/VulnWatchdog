## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸/权限提升/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升/未授权访问

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop Windows/macOS 4.34.0 之前的所有版本

**利用条件:** 攻击者需在本地 Linux 容器内拥有执行权限，且 Docker Desktop 配置了默认的子网接口（通常为 192.168.65.7）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该提供的脚本是一个针对 Docker Engine API 未授权访问的自动化利用工具。脚本的核心逻辑在于利用了 Docker Desktop 容器隔离机制的缺陷，即 Linux 容器可以通过默认子网地址（如 192.168.65.7）直接访问宿主机的 Docker API 端口（2375）。POC 通过 curl 工具实现以下步骤：1. 自动探测目标 IP 的 Docker API 是否开放。2. 通过 API 的 /info 接口识别宿主机操作系统类型（Linux 或 Windows），并据此动态调整挂载路径。3. 自动化枚举宿主机本地已有的镜像，增加攻击隐蔽性，避免因拉取外部镜像产生异常流量。4. 使用 POST 请求创建恶意容器，关键在于 HostConfig 中的 Binds 参数，将宿主机的根目录（/ 或 C:/）挂载到容器内部。5. 脚本随后通过 /containers/start 启动容器并执行任意命令。此 POC 逻辑严密，处理了跨平台差异，具有极高的实战有效性，可直接导致宿主机完全沦陷。【利用步骤】1. 在 Docker Desktop 运行的 Linux 容器中执行该脚本。2. 脚本向 192.168.65.7:2375 发起 HTTP 请求探测。3. 获取宿主机信息并确定可用的容器镜像。4. 构造 JSON 载荷，创建一个配置了宿主机根目录挂载（Volume Mount）的新容器。5. 启动该容器，通过 chroot 或直接访问挂载点对宿主机文件系统进行读写，从而实现逃逸并控制宿主机系统。【投毒风险分析】该脚本本身主要表现为功能性的渗透测试工具，其代码逻辑相对透明。首先，脚本使用了标准的 shell 语法和基础工具（curl, grep, sed），没有进行任何混淆或加密处理，易于安全审计。其次，脚本中定义的变量如 TARGET_IP、CMD 等允许用户交互式输入，符合工具化特征。然而，存在以下风险点：1. 虽然脚本中未发现明显的反连后门，但其自动探测和静默创建容器的行为极易被恶意改装，在后台偷偷执行持久化脚本。2. 在 fallback 机制中提到了 alpine:latest 镜像，如果目标环境网络被劫持，可能拉取到恶意的镜像。3. 由于其‘万能’性质，如果此类代码通过不可信的仓库分发，攻击者可能在 curl 请求中埋入向第三方服务器发送目标元数据的逻辑。当前 POC 属于防御性研究中的标准利用演示代码，但使用时仍需在沙箱环境中审查其外发流量，防止敏感数据泄露。

**项目地址:** [https://www.freebuf.com/articles/vuls/445648.html](https://www.freebuf.com/articles/vuls/445648.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
