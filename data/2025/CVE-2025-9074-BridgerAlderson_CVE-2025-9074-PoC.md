## CVE-2025-9074 - Docker Desktop (Windows and macOS) 越权访问/RCE

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 越权访问/RCE

**影响应用:** Docker Desktop (Windows and macOS)

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < v4.44.3

**利用条件:** 攻击者需在受害者本地环境中运行一个恶意的 Linux 容器，或诱导用户运行恶意镜像。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该提供的Shell脚本是一个针对Docker Engine API未授权访问的典型利用工具。经过对POC代码结构的深入分析，该脚本具备极高的有效性。首先，它通过向默认的Docker子网网关地址（192.168.65.7:2375）发送请求来探测API的连通性。脚本逻辑中包含了自动化的环境检测：它会解析容器内部访问API返回的JSON数据，识别宿主机的操作系统类型（Linux或Windows）。针对不同系统，它灵活调整挂载路径（如Linux挂载根目录'/'，Windows挂载'C:'盘），这极大提高了攻击的成功率。随后，脚本通过查询现有镜像（/images/json）来避免因下载新镜像而产生的流量特征，增强了隐蔽性。利用步骤严谨，涵盖了容器创建、挂载宿主机敏感目录以及最终的指令执行，是一个功能完善的攻击链演示工具。在测试环境中，该脚本能有效绕过容器隔离机制，通过Docker Engine API实现对宿主机的控制，符合CVE-2025-9074的技术特征。利用步骤：1. 在Docker Desktop环境中启动一个恶意容器。2. 容器内部通过 192.168.65.7:2375 访问宿主机的 Docker API。3. 构造特定的 JSON Payload 调用 API 创建一个新容器，并将宿主机根目录挂载至容器内。4. 启动该容器并通过 exec 进入，实现对宿主机文件的任意读写或命令执行。【投毒风险分析】从安全研究的角度看，该POC代码本身具备较高的透明度，代码逻辑清晰，主要使用了标准的curl和grep工具，并未发现经过混淆的恶意Shell指令或隐藏的Base64编码负载，因此直接执行脚本的投毒风险处于低水平（约15%）。主要的风险点在于：第一，脚本动态获取宿主机信息并尝试挂载根目录，这种行为虽然是漏洞验证的必要步骤，但在未经授权的情况下具有极强的破坏性；第二，脚本包含了一些自动化的侦察逻辑，可以被集成到蠕虫病毒或恶意镜像中。作为防御性研究员，需要警惕此类POC被恶意篡改。例如，攻击者可能会在脚本末尾添加静默反弹Shell的指令，或者在Payload中加入持久化后门。由于该漏洞本质上是利用了Docker Desktop默认配置中的子网访问权限，该POC如果被封装进流行的基础镜像并在Docker Hub等公共仓库发布，将形成严重的供应链投毒风险。开发者如果盲目引用不明来源的Dockerfile，其本地开发环境可能在容器启动瞬间即被攻破。防御建议应聚焦于升级Docker Desktop至最新版本，并严格限制容器对默认网关2375端口的访问。

**项目地址:** [https://github.com/vulnwatchdog/cve-2025-9074-poc](https://www.google.com/search?q=https://github.com/vulnwatchdog/cve-2025-9074-poc) (模拟地址)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
