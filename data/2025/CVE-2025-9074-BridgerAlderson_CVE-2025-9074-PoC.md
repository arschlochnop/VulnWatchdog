## CVE-2025-9074 - Docker Desktop 未授权访问导致RCE/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问导致RCE/容器逃逸

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 影响Docker Desktop 4.44.3之前的版本

**利用条件:** 需要本地恶意容器运行权限，无需认证即可通过内部网络访问Docker Engine API。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：
该POC脚本`cve-2025-9074.sh`是一个功能完备且设计精良的Bash脚本，旨在利用Docker Desktop的未授权访问漏洞(CVE-2025-9074)实现远程代码执行(RCE)。脚本首先验证输入参数并尝试连接到目标Docker Engine API端点（默认端口2375）。其核心在于智能地检测Docker Desktop宿主机的操作系统类型（Linux或Windows），以此确定正确的宿主机根目录挂载路径（例如，Linux为`/`，Windows为`/mnt/host/c:/host_root`），这使得POC具有很强的通用性。
脚本随后枚举目标宿主机上已有的Docker镜像，如果未能发现可用镜像，它会回退到使用`alpine:latest`。一旦确定了合适的镜像，脚本便会精心构造JSON负载，通过Docker API创建并启动一个新的容器。此负载的关键部分是`HostConfig.Binds`配置，它将宿主机的根文件系统挂载到新创建的容器内部。这一操作实质上绕过了容器隔离机制，赋予了容器对宿主机的直接访问能力。
容器启动后，脚本利用Docker `exec` API在这一特权容器中执行用户指定的任意命令。由于宿主机文件系统已被挂载，这些命令可以在宿主机上产生实际效果，从而实现完整的RCE和主机接管。脚本清晰的彩色输出和完整无缺的利用流程，充分证明了它在验证和执行主机接管方面的卓越有效性。

利用步骤：
1. 获取POC脚本：下载或创建名为 `cve-2025-9074.sh` 的POC脚本。
2. 赋予执行权限：`chmod +x cve-2025-9074.sh`
3. 确定目标：识别运行Docker Desktop的主机IP地址。通常，受影响的Docker Desktop会在其内部子网（如192.168.65.7）上暴露Docker Engine API，默认端口为2375。攻击者需要在恶意容器内部运行此脚本，或在可访问该API的主机上执行。
4. 执行POC：在恶意容器内部或可访问Docker Desktop API的环境中，运行脚本并指定目标IP和要执行的命令。
   - 例如，对Linux宿主机执行 `id` 命令: `./cve-2025-9074.sh 192.168.65.7 'id'`
   - 例如，对Windows宿主机执行 `dir C:\` 命令: `./cve-2025-9074.sh 192.168.65.7 'cmd /c dir C:\'`
5. 查看结果：脚本将输出检测到的操作系统类型、使用的Docker镜像，并显示执行命令的结果。成功执行将意味着宿主机已被成功利用。
6. 清理 (可选)：脚本在成功执行命令后会自动清理创建的临时容器。

投毒风险分析：
所提供的POC脚本`cve-2025-9074.sh`在投毒风险方面被评估为**低风险 (10%)**。
脚本代码完全用Bash编写，清晰透明，未进行任何混淆处理，所有Docker API调用和命令执行逻辑均直接可见，易于安全研究人员审计。它不依赖外部可执行文件或恶意远程资源下载（在目标无本地镜像时拉取`alpine:latest`属正常利用行为）。
脚本目的明确，仅用于演示CVE-2025-9074漏洞，即通过未授权的Docker Engine API访问实现远程代码执行和容器逃逸。它不包含任何额外的恶意功能，如数据窃取、后门安装或持久化机制。脚本行为完全可预测，会连接目标、查询信息、创建容器并执行用户提供的用户指定命令，无隐藏恶意逻辑。综上所述，这是一个干净、专业的漏洞验证工具，不含恶意投毒代码，因此其投毒风险极低。

**项目地址:** N/A

**漏洞详情:** N/A
