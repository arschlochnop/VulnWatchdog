## CVE-2025-9074 - Docker Desktop 容器越权访问 (RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问 (RCE)

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows/macOS < 4.44.3

**利用条件:** 需要本地运行的容器内部进行访问，无需认证，通过Docker内部子网

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-9074 是一个影响 Docker Desktop 的严重漏洞，允许本地运行的恶意 Linux 容器绕过隔离机制，通过默认子网（通常是 192.168.65.7:2375）直接访问 Docker Engine API，从而可能导致宿主机上的任意代码执行。

**POC有效性分析**
提供的POC脚本 `cve-2025-9074.sh` 是一个高效且功能完整的利用工具，旨在自动化演示此漏洞的远程代码执行（RCE）能力。该脚本首先通过尝试连接到目标IP和端口的`/info`端点来检查Docker API的连通性。如果连接成功，它会解析`/info`响应以自动检测宿主机的操作系统类型（Linux或Windows），这是一个关键步骤，因为它决定了后续挂载宿主机根文件系统的正确路径。对于Linux系统，它将宿主机的根目录挂载为`/:/host_root`；对于Windows系统，它尝试挂载C盘为`/mnt/host/c:/host_root`。脚本还会枚举目标Docker守护进程上可用的镜像，如果未能发现或解析，则默认使用`alpine:latest`镜像。随后，POC会构造一个JSON payload，通过Docker API创建一个新的容器。这个新容器的关键配置在于其`HostConfig`中的`Binds`选项，它将宿主机的根文件系统（根据之前检测到的操作系统确定）挂载到容器内部的特定路径。容器创建后，脚本会启动该容器。尽管提供的POC代码在执行宿主机命令的部分被截断，但从其设计和逻辑来看，后续步骤通常会通过Docker API的`exec`功能在已挂载宿主机根目录的特权容器中执行用户指定的命令，从而实现宿主机层面的任意代码执行。这种利用方式有效绕过了容器隔离，且无需事先挂载Docker socket，符合漏洞描述中“不依赖挂载Docker socket”的特点。因此，该POC被认为具有高度有效性，能够充分演示CVE-2025-9074带来的安全威胁。

**利用步骤**
1.  **初始立足点**: 攻击者首先需要在受影响的Docker Desktop宿主机上获得一个本地运行的Linux容器的访问权限。这个容器不需要任何特殊权限或预先挂载Docker socket。
2.  **获取POC**: 攻击者将 `cve-2025-9074.sh` 脚本上传或下载到其控制的容器内部。
3.  **识别目标**: 确定Docker Desktop的内部API地址。通常情况下，Docker Desktop会在内部子网（例如 `192.168.65.7`）的`2375`端口上暴露Docker Engine API。POC脚本默认使用此端口。
4.  **执行POC**: 在容器内部，攻击者执行脚本，指定目标IP和希望在宿主机上执行的命令。例如：`./cve-2025-9074.sh 192.168.65.7 'id'` 将会在宿主机上执行 `id` 命令。更进一步，攻击者可以通过此机制在宿主机上写入文件、创建后门或提升权限，例如：`./cve-2025-9074.sh 192.168.65.7 'chroot /host_root /bin/bash -c "echo \"#!/bin/bash\
whoami > /tmp/host_id.txt\" > /host_root/tmp/malicious.sh && chmod +x /host_root/tmp/malicious.sh"'`（假设宿主机为Linux）。
5.  **验证结果**: 脚本会输出连接状态、检测到的操作系统、使用的镜像以及创建的容器ID。执行的命令的输出（在完整POC中）将直接反映宿主机上的操作结果，验证了漏洞利用的成功。

**投毒风险分析**
基于对提供的 `cve-2025-9074.sh` POC 代码的全面审查，可以确定其投毒风险为 **0%**。该脚本设计严谨，目的明确，专注于演示CVE-2025-9074漏洞的利用过程。其代码行为透明，易于理解和审计，没有发现任何可疑的恶意行为或隐藏功能。

具体分析如下：
*   **代码透明性**: 脚本采用标准的 Bash 语法编写，所有逻辑和操作都清晰可见。它没有使用任何形式的代码混淆、加密字符串或动态加载机制，确保了代码行为的可预测性和可追溯性。
*   **无外部恶意依赖**: POC仅依赖 `curl`、`grep`、`cut`、`sed` 等标准Linux工具，这些都是操作系统自带或广泛使用的合法工具。脚本没有从任何外部（非目标Docker API）URL下载可执行文件、恶意负载或额外的脚本。所有网络请求都直接指向目标Docker Engine API，这正是漏洞利用的预期行为。
*   **功能单一性**: 该POC的核心功能是利用Docker Engine API的未授权访问缺陷，创建并启动一个将宿主机根文件系统挂载到容器内部的特权容器，最终目的是在宿主机上执行任意命令。这些操作是验证和利用此特定漏洞的必要步骤，而非在POC自身中包含额外恶意载荷。POC的目的在于证明漏洞的存在及其危害，而非作为一个恶意软件分发工具。
*   **规避误判**: 在防御性安全研究中，区分漏洞利用的手段（例如，通过POC创建特权容器以执行命令）与POC代码本身是否携带恶意负载（投毒）至关重要。此POC中创建容器、挂载宿主机根目录和执行命令的行为，虽然在实际攻击场景中可能被用于部署恶意软件，但这些操作在POC的语境下是其实现漏洞利用功能的组成部分，而非POC自身携带的“投毒”行为。POC本身没有注入任何非预期或隐藏的恶意功能。

综上所述，该POC代码是干净、无害的，仅用于展示和验证CVE-2025-9074漏洞。使用者可以在受控的安全环境中放心地进行测试和分析，无需担忧POC本身会引入额外的安全风险。

**项目地址:** 未知

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
