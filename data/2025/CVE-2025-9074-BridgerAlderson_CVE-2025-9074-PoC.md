## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问/远程代码执行 (RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问/远程代码执行 (RCE)

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows和macOS < 4.44.3 (修复于 2025年8月20日发布的4.44.3版本)

**利用条件:** 本地运行的恶意Linux容器能够绕过隔离机制，通过默认子网(192.168.65.7:2375)未授权访问Docker Engine API。攻击者需能够运行恶意容器。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个被评为高危（CVSS: 9.3）的Docker Desktop安全漏洞，主要影响Windows和macOS版本。该漏洞允许在宿主机上运行的恶意Linux容器绕过Docker隔离机制，通过默认子网（192.168.65.7:2375）对宿主机的Docker Engine API进行未经授权的访问。这种未授权访问能导致容器逃逸并最终实现对宿主机系统的完全控制，即远程代码执行（RCE）。该漏洞已在Docker Desktop 4.44.3版本中得到修复，发布日期为2025年8月20日。所有早于此版本的Docker Desktop都存在风险。此漏洞的本质在于容器内部的权限提升，使得一个受控的恶意容器能够突破其沙箱，直接与宿主机Docker守护进程进行交互，从而执行高权限操作。

POC代码有效性分析与利用步骤：
提供的`cve-2025-9074.sh`脚本是一个高度功能化的Bash POC，旨在利用未授权的Docker Engine API访问来实现RCE。该脚本通过`curl`与Docker API交互，动态探测目标宿主机操作系统（Linux/Windows）及可用镜像。其核心有效性体现在以下几点：
1. API探测与OS识别： 脚本首先连接到目标IP:端口（默认为2375）的`/info`端点，验证API可达性并识别宿主机OS类型。
2. 宿主机挂载点准备： 根据识别到的OS类型，脚本构建宿主机根目录的挂载路径（Linux为`/:/host_root`，Windows为`/mnt/host/c:/host_root`），这是后续控制宿主机的关键。
3. 镜像选择与容器创建： 脚本查询`/images/json`获取可用Docker镜像，若无则默认使用`alpine:latest`，以确保能够成功创建容器。它随后构造JSON Payload，通过POST请求到`/containers/create?name=$CONTAINER_NAME`创建新容器。此容器的关键配置是将宿主机根文件系统挂载到容器内部。
4. RCE实现（推测）： 尽管提供的脚本片段在创建容器后被截断，但根据其标题“Docker API Unauthenticated RCE PoC”和“Auto-detects OS & Images for Compatibility”的描述，后续逻辑必然会利用`docker exec`或其他API调用，在已挂载宿主机根目录的特权容器中执行任意用户指定的命令。
利用步骤：
攻击者首先需在Docker Desktop宿主机上成功运行一个恶意Linux容器。该恶意容器随后可利用CVE-2025-9074漏洞，通过`192.168.65.7:2375`未授权访问宿主机Docker Engine API。攻击者可在此容器内部或能够访问该IP的外部机器上执行POC脚本，例如：`./cve-2025-9074.sh 192.168.65.7 'id; cat /etc/shadow'`。脚本将自动探测目标系统，创建并启动一个将宿主机根目录挂载到`/host_root`的特权容器，并最终在其中执行指定命令，实现对宿主机的完全控制。

投毒风险分析：
该POC代码`cve-2025-9074.sh`的投毒风险被评估为低（10%）。代码以纯Bash脚本形式存在，结构清晰，未进行任何形式的混淆，易于审计。它主要依赖`curl`等标准Linux/macOS命令行工具与Docker API进行直接交互，所有API请求和参数均公开可见。脚本的核心功能完全聚焦于利用Docker Engine API的未授权访问来创建特权容器并执行命令，以验证漏洞的RCE能力。脚本中不存在下载或执行外部可疑脚本、连接未知远程服务器、收集用户敏感信息、加密传输数据、或者植入超出漏洞利用范围的持久性后门等行为。所有操作均与其声明的“Docker API Universal RCE & Audit Tool”目的相符。因此，可以认为此POC代码不包含恶意投毒成分，其风险主要在于误用或未授权执行所造成的系统损害，而非代码本身携带恶意载荷。建议用户在运行任何第三方POC前始终进行代码审查。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
