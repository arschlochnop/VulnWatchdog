## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100

**利用条件:** Unauthenticated network access, PUT requests enabled with Content-Range support

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-24813是Apache Tomcat中存在的一个远程代码执行漏洞，该漏洞源于Tomcat的Partial PUT功能。攻击者可以通过发送特制的HTTP PUT请求，利用Java反序列化漏洞，将恶意session文件上传到服务器的session目录下，从而实现远程代码执行。该漏洞影响了Apache Tomcat 11.0.0-M1至11.0.2，10.1.0-M1至10.1.34，9.0.0-M1至9.0.98以及8.5.0至8.5.100等多个版本。 

POC代码分析：
POC代码是一个Python脚本，它利用了Tomcat的Partial PUT功能中的漏洞。该脚本首先尝试从目标服务器获取JSESSIONID，如果无法获取，则使用默认值。然后，脚本会测试服务器是否接受带有Content-Range的PUT请求。接下来，脚本会生成恶意payload，payload的生成方式有两种：一种是使用ysoserial生成序列化的Java对象，另一种是编译一个Java文件生成.jar文件。最后，脚本将payload上传到Tomcat的session目录，通过访问带有恶意JSESSIONID的应用程序触发反序列化，从而执行任意命令。

利用步骤：
1. 确定目标服务器运行着受影响的Apache Tomcat版本，并且启用了PUT方法。
2. 运行POC脚本，指定目标URL和要执行的命令。
3. 脚本会自动完成payload生成、上传和触发，最终在目标服务器上执行指定的命令。

投毒风险分析：
该POC脚本的投毒风险较低，主要风险集中在payload生成阶段。
1. ysoserial payload：如果攻击者篡改ysoserial.jar文件，可能会在payload中注入恶意代码。用户在使用POC之前，应该确保ysoserial.jar的来源可靠。
2. Java payload：攻击者可能修改java_payload函数，使其生成的.jar文件执行恶意操作。用户在使用POC之前，应该仔细审查java_payload函数的代码。
3. 该POC不包含任何混淆代码或外部脚本，并且只使用了Python标准库和requests库，降低了潜在的投毒风险。
4. 脚本中发送的HTTP请求虽然可能被拦截和分析，但本身不包含可以直接利用的恶意代码。
总的来说，该POC的投毒风险较低，但用户仍需保持警惕，特别是payload生成阶段，需要确保相关依赖的来源可靠。

**项目地址:** https://github.com/who cares

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
