## CVE-2025-68613 - n8n (开源工作流自动化平台) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n (开源工作流自动化平台)

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 至 1.120.3 以及 1.121.0

**利用条件:** 需要具有有效凭证的认证用户权限 (Authenticated)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码展示了一个针对n8n工作流引擎的完整利用流程。其核心逻辑在于利用n8n节点参数处理中的表达式注入漏洞。通过分析代码，脚本首先模拟用户登录流程（/rest/login）获取API Key或认证Cookie，随后构建一个包含恶意JavaScript载荷的JSON工作流对象。该载荷使用了Node.js环境下的常用逃逸技巧：`this.constructor.constructor('return process...')()`，这种方式能够绕过基本的沙箱限制，直接访问Node.js的全局进程对象。在n8n的“Set”节点或类似的表达式解析环节，当系统尝试计算以'='开头的表达式时，恶意代码将被执行。该POC具备自动化的登录、工作流创建和触发逻辑，结构清晰，功能闭环，对于未修补的n8n实例具有极高的攻击有效性。它不仅能验证漏洞存在，还能通过Node.js的process对象回传目标系统的架构、平台、当前路径及环境变量等敏感信息，证明了漏洞可以实现完整的系统信息窃取甚至进一步的OS指令执行。

【利用步骤】1. 环境准备：攻击者需要获取目标n8n实例的访问地址及一组有效的登录凭证（邮箱和密码）。2. 身份认证：运行POC脚本，脚本通过POST请求发送凭证至/rest/login，从响应中提取apiKey或Auth Cookie。3. 载荷构建：脚本构造一个特制的工作流定义，其中包含一个带有恶意JavaScript表达式的节点（如Set节点），表达式内容设计为执行系统调用或信息探测。4. 任务下发：脚本通过带认证头的API请求将该工作流导入目标系统。5. 漏洞触发：触发工作流执行，n8n后端引擎在解析节点参数中的表达式时执行注入的代码。6. 结果回显：脚本捕获并解析返回的JSON数据，展示目标系统的敏感元数据。

【投毒风险分析】该POC代码的投毒风险评级为低（15%）。从代码结构上看，该脚本使用了Python的标准库（sys, argparse）和流行的第三方库（requests），代码逻辑透明且具有良好的注释说明，没有发现明显的代码混淆或字节码加密行为。脚本的外部连接仅限于用户通过命令行参数指定的n8n目标URL，不存在静默连接到未知第三方C2（命令与控制）服务器的行为。虽然代码中包含了一段看似危险的JavaScript字符串载荷，但那是漏洞利用的核心部分，用于在受害机器上执行验证操作，而非针对攻击者本人的机器。唯一存在的潜在风险在于该POC可能会被修改用于非法用途，或者在分发过程中被他人植入后门。目前提供的代码版本中，其行为完全符合安全研究和合规渗透测试的特征，未发现针对执行者的恶意意图。对于防御者而言，应重点关注工作流导入接口的异常调用记录。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_78d4e9239c984667d67429549ed5822a/exploit.py

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
