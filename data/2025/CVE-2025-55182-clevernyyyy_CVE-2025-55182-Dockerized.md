## CVE-2025-55182 - React, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React, Next.js

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** All versions of React and Next.js using vulnerable Server Functions protocol prior to the fix.

**利用条件:** Unauthenticated remote attacker with network access to a vulnerable React Server Function endpoint.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182 is a critical remote code execution (RCE) vulnerability affecting React and Next.js applications that utilize React Server Components (RSC) and server functions. The vulnerability stems from unsafe deserialization of incoming Flight requests, allowing an unauthenticated, remote attacker to execute arbitrary code on the server. The vulnerability, dubbed React2Shell, is easily exploitable, requiring only a specially crafted payload sent to a vulnerable React Server Function endpoint. 

The provided POC code demonstrates a complete exploit, including a Docker setup for easy deployment and testing. The DOCKER_SETUP.md file provides clear instructions on how to build and run the vulnerable application using Docker Compose. The steps involve building the Docker image, starting the container, extracting the action ID from the server, and executing the exploit using the poc.py script. The poc.py script sends a malicious payload to the server, triggering the RCE. The exploit's success can be verified by checking for the creation of a file inside the container's filesystem or by examining the container logs.

The exploit leverages the vulnerability in how React's Server Functions protocol processes incoming Flight requests. By sending a specially crafted payload, an attacker can bypass deserialization safeguards and inject arbitrary code, leading to remote code execution. The POC specifically exploits the unsafe deserialization vulnerability in RSC. The provided examples showcase how to create files, write to files, and execute arbitrary commands within the container. The documentation notes that a timeout error is expected, indicating that the RCE has executed successfully, as the server hangs after executing the command.

**Exploitation Steps:**

1.  **Setup the Vulnerable Environment:** Use the provided Docker Compose file to build and run the vulnerable Next.js server.
2.  **Obtain the Action ID:** Extract the action ID from the running server.
3.  **Execute the Exploit:** Run the poc.py script with the server URL, action ID, and the desired command to execute.
4.  **Verify the Exploit:** Check the container's filesystem or logs to confirm the execution of the command.

**投毒风险分析:**

While the provided POC itself appears to be clean and straightforward, the nature of RCE vulnerabilities always carries a risk of being weaponized with malicious payloads. A threat actor could potentially modify the poc.py script to deliver a more harmful payload, such as a reverse shell or a data exfiltration script. The risk of direct code poisoning within the provided POC is relatively low (estimated at 15%) due to the code's clarity and the use of standard Python libraries. However, the greater danger lies in the potential for attackers to leverage this POC as a base for creating more sophisticated and malicious exploits. For example, they might attempt to obfuscate the payload or integrate it with other attack vectors. Because the exploit is unauthenticated, the attack surface is quite large. Mitigation strategies should include implementing robust input validation, sanitization, and security monitoring to detect and prevent exploitation attempts.

**项目地址:** https://example.com/hypothetical_repo

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
