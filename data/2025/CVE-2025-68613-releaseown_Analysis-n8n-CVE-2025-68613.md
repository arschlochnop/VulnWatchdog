## CVE-2025-68613 - n8n (开源工作流自动化平台) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n (开源工作流自动化平台)

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** >= 0.211.0 且 < 1.120.4, < 1.121.1, < 1.122.0

**利用条件:** 需要身份认证，且用户必须具有工作流编辑权限 (创建或编辑)

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：根据提供的README.md文档，该POC详细描述了针对n8n自动化平台中JavaScript表达式处理不当导致的远程代码执行漏洞。由于n8n允许用户在工作流中使用JavaScript来处理数据，漏洞根源在于沙箱环境（Sandbox）未能完全隔离某些特定的JavaScript表达式，导致具有编辑权限的用户可以逃逸沙箱并在托管n8n实例的服务器上执行任意系统命令。文档中展示了攻击路径从登录认证到权限确认的过程。虽然核心代码部分被截断，但从结构来看，攻击者可以通过构造特殊的JS节点或表达式触发系统调用。该漏洞在生产环境中极具威胁，因为n8n通常拥有访问敏感数据库和云服务的权限。利用步骤：1. 攻击者通过合法凭据登录n8n Web界面。2. 确认当前账号拥有创建或编辑工作流的权限。3. 创建一个新的工作流或在现有工作流中添加一个支持JavaScript表达式的节点（如Code Node或Set Node）。4. 在表达式输入框中构造恶意的JavaScript代码，旨在通过Node.js底层API或特定混淆技巧绕过n8n的vm2或其他沙箱限制。5. 保存并手动触发执行该工作流，恶意代码随之在宿主机系统中以n8n进程的权限运行。6. 验证是否成功执行，如执行反弹shell或读写敏感配置文件。投毒风险分析：该仓库（Analysis-n8n-CVE-2025-68613）目前的投毒风险评级为低（15%）。分析理由如下：首先，仓库的目的是技术文档记录和防御性分析，README中明确标注了受影响版本和修复方案。其次，文档中引用的图片存储在GitHub官方路径下，而非未知的第三方恶意图床。代码层面，虽然截断部分未完全展示，但前面的指引侧重于教育性质和漏洞复现流程，没有明显的混淆代码或自动运行的外部恶意脚本。然而，风险主要源于此类高价值RCE漏洞的POC极易被修改。攻击者可能通过诱导用户下载包含恶意二进制文件、npm安装钩子或带后门的n8n导出JSON文件进行二次投毒。目前该项目代码结构清晰，尚未发现恶意意图。安全研究人员在使用此类公开分析项目时，应重点检查是否存在隐藏的.js、.sh或.py脚本，并仅在隔离的实验环境中进行测试，避免直接在生产环境或开发主机上运行未经验证的自动化利用脚本。

**项目地址:** [https://github.com/releaseown/Analysis-n8n-CVE-2025-68613](https://www.google.com/search?q=https://github.com/releaseown/Analysis-n8n-CVE-2025-68613)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
