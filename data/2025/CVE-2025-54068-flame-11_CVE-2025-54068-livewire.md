## CVE-2025-54068 - Laravel Livewire 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-54068

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Laravel Livewire

**危害等级:** CRITICAL

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (估算 9.8)

**影响版本:** v3.0.0-beta.1 到 v3.6.3

**利用条件:** 无需身份验证，无需用户交互，只要目标应用使用了受影响版本的 Livewire 组件并暴露了水合（Hydration）过程中的属性更新接口即可利用。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC项目是一个极高质量的本地复现环境。它通过Dockerfile和docker-compose构建了一个完整的、版本固定的脆弱环境（PHP 8.3 + Laravel 11 + Livewire 3.6.3）。分析PoC代码结构可知，该漏洞的核心在于Livewire在‘水合’（Hydration）过程中对组件属性更新的处理不当。Livewire通过在前端和后端之间传递JSON负载来维持状态，而此漏洞允许攻击者构造特殊的Payload，绕过类型检查或利用PHP的特性（如数组转换或特定类的实例化）来执行任意代码。本项目提供的脚本`scripts/poc.py`模拟了真实的利用链：首先通过一个请求触发组件状态的特定转换，随后利用属性更新接口执行Payload。该PoC采用了安全验证方式，即通过`echo`输出特定的标记字符来证明RCE的存在，而非植入恶意后门，具有极高的实战参考价值和防御研究意义。\n\n【利用步骤】1. 使用Docker部署环境：通过执行`docker compose up -d --build`启动预配置的脆弱Web服务。2. 确认服务状态：访问`http://localhost:18081`确保Laravel应用正常运行且Livewire组件已加载。3. 执行漏洞检测：运行Python脚本`python3 scripts/poc.py http://localhost:18081/`。该脚本会向目标发送精心构造的JSON POST请求，目标路径通常为`/livewire/update`。4. 观察结果：脚本通过捕获HTTP响应中的特定字符串来确认命令执行是否成功。如果成功，说明该环境确实存在CVE-2025-54068漏洞。\n\n【投毒风险分析】经过对提供的POC代码（Dockerfile、README、docker-compose等）进行深度扫描，未发现明显的投毒风险。该项目的Dockerfile使用的是官方PHP镜像（php:8.3.29-apache），所有的依赖安装均通过标准的apt和composer进行，且明确指定了版本，避免了供应链攻击的隐患。脚本逻辑清晰，仅使用了标准库如requests（通过python3环境）进行HTTP交互，没有发现代码混淆、base64编码的可执行Payload、或者向外部可疑IP发起反弹Shell等行为。项目中的README文档详细指导了如何安全地进行本地实验。虽然利用脚本本身具有攻击性，但其目的是为了防御性的漏洞复现和补丁验证。该PoC属于透明度较高的开源研究资料，其投毒风险极低，仅需注意在隔离环境（如虚拟机或Docker容器）中运行即可，防止潜在的配置意外影响宿主机。研究人员应重点关注其Payload构造逻辑，以开发相应的WAF拦截规则。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-54068-Livewire-RCE](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-54068-Livewire-RCE)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54068](https://nvd.nist.gov/vuln/detail/CVE-2025-54068)
