## CVE-2025-32463 - sudo 本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 1.9.14 <= sudo < 1.9.17p1

**利用条件:** 本地访问权限；系统安装gcc；用户有权限运行带有任意目录的`sudo -R`命令。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
CVE-2025-32463是一个影响`sudo`版本1.9.14到1.9.17p1的本地权限提升漏洞。该漏洞源于`sudo`的`--chroot` (`-R`) 选项处理不当，允许非特权用户在受控的chroot环境中伪造`nsswitch.conf`，强制`sudo`（以root身份运行）加载并执行攻击者指定的NSS库。提供的`CVE-2025-32463.sh`脚本是一个完整的利用工具，它自动化了创建恶意C代码、编译为共享库、构建chroot环境，并通过`sudo -R`命令触发漏洞。恶意库加载后，其`constructor`函数将执行权限提升操作，最终启动root shell。该POC逻辑清晰，步骤完整，能够可靠地实现本地权限提升。

利用步骤:
1.  **环境检查**: 确认`sudo`版本在1.9.14到1.9.17p1之间，且安装`gcc`。
2.  **获取POC**: 下载`CVE-2025-32463.sh`脚本。
3.  **赋予权限**: `chmod +x CVE-2025-32463.sh`。
4.  **执行**: `./CVE-2025-32463.sh`。成功后将获得root shell。

投毒风险分析:
对CVE-2025-32463的POC代码进行分析，旨在评估其潜在的投毒风险。
*   **代码透明度**: 脚本`CVE-2025-32463.sh`及其内嵌的C代码`pwn.c`高度透明，无代码混淆，所有操作（如创建临时文件、编译、权限提升）均清晰可见。
*   **外部依赖**: POC仅依赖于系统自带的`gcc`、`mktemp`和标准shell命令，不从外部不可信源下载任何代码，避免了供应链投毒风险。
*   **恶意行为范围**: 脚本的唯一明确目标是利用漏洞获取本地root权限。它通过标准的权限提升操作（`setreuid(0, 0)`等）来启动root shell，未发现除此以外的其他恶意载荷，如安装后门、窃取数据、挖矿或进行持久化控制等。脚本在执行完毕后会清理其创建的临时文件。
*   **风险评估**: 鉴于代码的透明性、无外部不可信依赖以及功能仅限于权限提升本身，此POC代码本身的“投毒风险”为**低 (10%)**。这意味着代码本身被恶意篡改以包含隐藏恶意功能的可能性较低。然而，必须强调的是，即使POC本身“干净”，其成功利用漏洞后带来的系统控制权是高危的。用户应始终在隔离环境中运行此类代码，并优先修补相关漏洞，以防范实际攻击。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
