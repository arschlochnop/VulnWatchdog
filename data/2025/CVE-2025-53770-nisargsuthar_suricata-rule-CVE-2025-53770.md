# CVE-2025-53770

> 📦 该CVE有 **52** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-53770-0x-crypt_CVE-2025-53770-Scanner.md](../2025/CVE-2025-53770-0x-crypt_CVE-2025-53770-Scanner.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标系统运行存在漏洞的 SharePoint Server 版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞，通过构造恶意的序列化数据，在目标服务器上执行任意代码。漏洞影响 SharePoint Server 2016、SharePoint Server 2019 和 SharePoint Server Subscription Edition 的特定版本。

**利用方式：**

1.  攻击者利用 `ToolPane.aspx` 端点，通过 POST 请求发送恶意构造的序列化数据。
2.  请求中包含经过 URL 编码的 `MSOTlPn_Uri` 参数（目标 URL）和 `MSOTlPn_DWP` 参数（包含恶意 payload）。
3.  恶意 payload 利用 `Scorecard:ExcelDataSet` 控件，该控件允许加载压缩的 DataTable。
4.  服务器反序列化恶意数据，导致代码执行。
5.  POC 代码通过发送包含特定标记（IntruderScannerDetectionPayload）的 payload 来检测漏洞是否存在。如果服务器返回包含此标记的响应，则表示存在漏洞。

**投毒风险分析：**

该 POC 代码的主要目的是检测漏洞，而不是直接执行恶意操作。代码中包含的 `Scorecard:ExcelDataSet` 组件，以及用于检测漏洞的 "IntruderScannerDetectionPayload" 字符串，都表明其目的是识别漏洞，而非进行实际攻击。虽然理论上攻击者可能修改此 POC 代码以执行恶意操作，但从提供的代码来看，它主要是一个安全扫描工具，作者隐藏的投毒代码风险很低。代码中存在通过命令行执行curl命令，存在一定的命令注入风险，但是必须在存在漏洞的sharepoint服务器上。

因此，评估认为此仓库中存在作者隐藏的投毒代码的可能性较低，大约为 1%。

**项目地址:** [0x-crypt/CVE-2025-53770-Scanner](https://github.com/0x-crypt/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #2

**来源**: [CVE-2025-53770-0xray5c68616e37_cve-2025-53770.md](../2025/CVE-2025-53770-0xray5c68616e37_cve-2025-53770.md)

## CVE-2025-53770 SharePoint Deserialization RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码并完全控制系统

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要能够访问存在漏洞的 SharePoint 服务器的网络访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，由于未授权数据反序列化造成。攻击者可以通过向 `/_layouts/15/ToolPane.aspx` 路径发送特制的 POST 请求来利用此漏洞。该请求包含一个经过编码和压缩的恶意 .NET 对象，该对象在反序列化时执行任意代码。PoC 通过 `curl` 命令发送构造的请求，然后提取、解码和解压缩返回的数据以检测漏洞。请求中的 `MSOTlPn_DWP` 参数包含序列化的 payload。尽管提供的 PoC 的目的是展示漏洞，但恶意行为者可以使用类似的 payload 来执行任意命令，从而导致完整的系统compromise。该存储库存在轻微的投毒风险，因为攻击者可以修改 PoC 中的 payload，使其包含隐蔽的恶意代码，例如下载和执行其他恶意软件。 投毒风险估计为 10%，因为PoC 的主要目的是展示漏洞，而不是提供开箱即用的攻击工具，尽管可以修改。

**项目地址:** [0xray5c68616e37/cve-2025-53770](https://github.com/0xray5c68616e37/cve-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #3

**来源**: [CVE-2025-53770-3a7_CVE-2025-53770.md](../2025/CVE-2025-53770-3a7_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码，导致完全系统入侵。

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (< 16.0.18526.20508)

**利用条件:** 需要目标服务器存在漏洞，并且攻击者可以访问目标服务器的ToolPane.aspx页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 SharePoint Server 在处理不可信数据反序列化时存在缺陷，允许未经身份验证的攻击者远程执行代码。利用方式是向 `/_layouts/15/ToolPane.aspx` 页面发送包含恶意序列化数据的 POST 请求。  

**有效性：**

提供的 POC 代码 `CVE-2025-53770-Scanner.py` 通过发送精心构造的 POST 请求到 `ToolPane.aspx` 页面，利用 SharePoint Server 的反序列化漏洞。如果目标服务器存在漏洞，扫描器会识别到并报告。根据搜索引擎结果，此漏洞正在被积极利用，因此POC的有效性较高。

**投毒风险：**

代码主要功能是利用漏洞进行扫描，用于判断目标系统是否存在漏洞。虽然代码本身主要是为了验证漏洞是否存在，但是仍存在轻微的投毒风险，例如:

*   **依赖项风险：** 代码依赖于 `requests`, `re`, `base64`, `gzip`, `urllib3` 库，如果恶意攻击者篡改了依赖库，可能会引入恶意代码。
*   **结果误判：** 虽然代码已经尽可能精确的识别漏洞，但是任然存在误判的风险，例如将未授权的服务器标记为存在漏洞，从而导致不必要的恐慌。
*   **信息泄露风险：** 扫描器本身会发送HTTP请求，可能会在日志中留下痕迹，为攻击者提供一些信息。

**利用方式：**

1.  攻击者构造包含恶意序列化数据的 SOAP 包。
2.  将构造的 SOAP 包作为 POST 请求的数据发送到 `/_layouts/15/ToolPane.aspx` 页面。
3.  SharePoint Server 反序列化 SOAP 包中的数据。
4.  由于数据包含恶意代码，反序列化过程会导致代码执行。

总的来说，此 POC 的主要目的是验证漏洞的存在，而非直接进行攻击。因此，投毒风险相对较低，约为10%。 但需要注意使用环境和依赖项的安全性。

**项目地址:** [3a7/CVE-2025-53770](https://github.com/3a7/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #4

**来源**: [CVE-2025-53770-AdityaBhatt3010_CVE-2025-53770-SharePoint-Zero-Day-Variant-Exploited-for-Full-RCE.md](../2025/CVE-2025-53770-AdityaBhatt3010_CVE-2025-53770-SharePoint-Zero-Day-Variant-Exploited-for-Full-RCE.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标SharePoint服务器需要暴露在网络上，且未安装相应的安全更新。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中的远程代码执行漏洞。它允许未经身份验证的攻击者通过发送特制的 HTTP 请求来执行任意代码。

**利用方式：**
1.  攻击者发送包含恶意 `__VIEWSTATE` payload 或伪造的身份验证令牌的请求到易受攻击的 SharePoint 端点。
2.  恶意 payload 绕过验证。
3.  代码在 IIS ( `w3wp.exe` ) 进程中以 `NT AUTHORITY\SYSTEM` 权限执行。
4.  上传 Web shell，建立远程访问。
5.  启动 C2 通信，开始横向移动。

**有效性：**
根据漏洞描述信息和搜索结果，该漏洞是一个已知的、正在被积极利用的零日漏洞。提供的漏洞利用代码（README.md）描述了该漏洞的细节，以及攻击者利用该漏洞的实际案例，可以认为该漏洞是有效的。

**投毒风险：**
代码仓库中的 `LICENSE` 和 `README.md` 文件本身不包含任何可执行代码，因此直接投毒的可能性较低。但是, 攻击者可能会在实际利用漏洞时，上传恶意 Web shell 或其他 payload，这些 payload 本身可能包含恶意代码。README中提到的攻击链涉及多个CVE，且Payload为常见的webshell，因此判断为真实漏洞利用的可能性较高。但是不排除作者在实际漏洞利用过程中，使用一些隐藏的后门或者恶意操作的可能性。因为只是提供POC，并未提供完整EXP，因此投毒风险评估为较低，大概在10%左右。

**项目地址:** [AdityaBhatt3010/CVE-2025-53770-SharePoint-Zero-Day-Variant-Exploited-for-Full-RCE](https://github.com/AdityaBhatt3010/CVE-2025-53770-SharePoint-Zero-Day-Variant-Exploited-for-Full-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #5

**来源**: [CVE-2025-53770-Agampreet-Singh_CVE-2025-53770.md](../2025/CVE-2025-53770-Agampreet-Singh_CVE-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标SharePoint服务器可访问，且未安装相应的安全补丁或缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于本地部署的 Microsoft SharePoint Server 中的远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。

**有效性评估：**

根据漏洞库信息，此漏洞已被积极利用（“exploit for CVE-2025-53770 exists in the wild”），并且 CISA 已将其添加到已知被利用的漏洞目录 (KEV)。提供的PoC代码针对的是 SharePoint Server 的 `ToolPane.aspx` 页面，利用 `Scorecard:ExcelDataSet` 控件中不安全的反序列化漏洞。PoC 通过 POST 请求发送包含恶意序列化数据的 payload，从而实现 RCE。

搜索引擎结果也证实了该漏洞的严重性以及已被利用的事实。多个安全厂商和组织发布了关于此漏洞的警告和分析报告。

因此，提供的 PoC 代码很可能有效。

**投毒风险分析：**

PoC 代码主要功能是利用已知的反序列化漏洞。Payload 部分，即 `CompressedDataTable` 字段的内容，是经过压缩和 Base64 编码的序列化数据。

投毒的潜在风险主要在于：

1.  **payload 内容：** 攻击者可能会修改 payload，使其在利用漏洞的同时，执行一些恶意操作，例如安装后门、窃取数据、破坏系统等。
2.  **代码逻辑：**  虽然PoC代码比较简短，但依然存在被植入恶意代码的可能。例如，在成功利用漏洞后，悄悄地下载并执行额外的恶意程序。

尽管存在这些风险，但 PoC 代码本身看起来主要是为了演示漏洞利用，而非恶意行为。风险评估为10%。

**利用方式分析：**

1.  攻击者构造恶意的序列化数据，并将其压缩和 Base64 编码。
2.  攻击者向目标 SharePoint 服务器的 `/_layouts/15/ToolPane.aspx` 页面发送 POST 请求，其中包含 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数。`MSOTlPn_DWP` 参数的值是包含恶意序列化数据的 payload。
3.  SharePoint 服务器在处理请求时，会反序列化 `CompressedDataTable` 中的数据，由于数据是恶意的，会导致 RCE。
4.  攻击者可以在目标服务器上执行任意代码。

**项目地址:** [Agampreet-Singh/CVE-2025-53770](https://github.com/Agampreet-Singh/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #6

**来源**: [CVE-2025-53770-B1ack4sh_Blackash-CVE-2025-53770.md](../2025/CVE-2025-53770-B1ack4sh_Blackash-CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** SharePoint Server 2016 (on-prem), SharePoint Server 2019 (on-prem), SharePoint Subscription Edition (versionStartIncluding: 16.0.0, versionEndExcluding: 16.0.18526.20508)

**利用条件:** 需要目标系统为受影响的SharePoint Server版本，且攻击者能够上传.aspx文件或发送特制的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中存在的一个远程代码执行漏洞，该漏洞是由于对不可信数据进行反序列化造成的。攻击者可以通过上传恶意的 .aspx 文件或构造包含恶意 ViewState 数据的请求来利用此漏洞，从而在服务器上执行任意代码。根据漏洞信息和搜索结果，此漏洞已被积极利用，并且没有官方补丁可用，因此缓解措施至关重要。POC 代码利用 ViewState 伪造，通过窃取的 ASP.NET `machineKey`（ValidationKey 和 DecryptionKey）绕过签名验证并执行任意代码。虽然提供的 POC 代码本身看起来不包含明显的投毒代码，但由于攻击者需要能够上传恶意.aspx文件或能够发送特制的HTTP请求，因此如果将POC代码进行修改，比如在其中嵌入额外的后门代码或者用于大规模传播，则可能存在投毒风险。该风险比例预估为10%。

**漏洞利用方式：**

1.  **获取 machineKey：** 攻击者首先需要通过某种方式获取 SharePoint 服务器的 machineKey（ValidationKey 和 DecryptionKey）。这通常通过上传一个恶意的 .aspx 文件 (例如 `spinstall0.aspx`) ，利用 SharePoint 的反序列化漏洞读取内存中的敏感信息来实现。
2.  **构造恶意 ViewState：**  利用获取到的 machineKey，攻击者可以构造恶意的 ViewState payload。这些 payload 包含要执行的任意代码。
3.  **发送恶意请求：**  将构造好的恶意 ViewState payload 嵌入到发送给 SharePoint 服务器的 HTTP 请求中。该请求可以是一个 POST 请求，目标是 SharePoint 的某个页面（例如 `/sites/*/_layouts/15/ToolPane.aspx?DisplayMode=Edit`）。
4.  **执行代码：**  SharePoint 服务器在处理请求时，会反序列化 ViewState 数据，由于 ViewState 是伪造的，包含了恶意代码，从而导致服务器执行攻击者指定的代码。代码在 `w3wp.exe` 进程下执行。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-53770](https://github.com/B1ack4sh/Blackash-CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #7

**来源**: [CVE-2025-53770-BirdsAreFlyingCameras_CVE-2025-53770_Raw-HTTP-Request-Generator.md](../2025/CVE-2025-53770-BirdsAreFlyingCameras_CVE-2025-53770_Raw-HTTP-Request-Generator.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本 < 16.0.18526.20508)

**利用条件:** 需要目标系统运行受影响版本的SharePoint Server，并且能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。该漏洞允许未经授权的攻击者通过网络执行任意代码。根据漏洞信息，该漏洞已被积极利用，并且 CISA 已将其添加到已知被利用的漏洞目录中。提供的POC代码利用了 `ToolPane.aspx` 页面，通过构造恶意的序列化数据，触发反序列化漏洞，从而执行攻击者预先准备的 PowerShell 脚本。

**利用方式：**

1.  **准备 Payload：**  攻击者首先需要准备一个恶意的 ASPX payload (`pwn.aspx`)，该文件包含将执行的恶意代码，例如，执行系统命令、部署 webshell等。在此示例中，`pwn.aspx` 包含C#代码，用于执行任意操作。
2.  **Payload 编码：**  POC 代码首先对 ASPX payload 进行 Base64 编码，然后将其嵌入到 PowerShell 脚本中。PowerShell 脚本的作用是将解码后的 ASPX payload 写入到 SharePoint 的 Layouts 目录下，命名为 `spinstall0.aspx`。 
3.  **构造反序列化 Payload：**  接下来，POC 代码将包含 Base64 编码的 PowerShell 命令的 payload 嵌入到一个 XML 结构中，该结构使用 `LosFormatter` 类来触发反序列化漏洞。 XML 数据随后被进行 Base64 编码并使用 Gzip 压缩。然后，此Gzip压缩的数据再次进行Base64 编码。
4.  **构建 HTTP 请求：**  POC 代码构造一个 POST 请求，目标是 SharePoint 的 `/_layouts/15/ToolPane.aspx` 页面。请求体中包含 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数。`MSOTlPn_DWP` 参数的值是经过 URL 编码的最终 payload。
5.  **发送请求：**  攻击者将构造好的 HTTP 请求发送到目标 SharePoint Server。当 SharePoint Server 处理该请求时，会触发反序列化漏洞，从而执行嵌入在 XML payload 中的 PowerShell 脚本，并将恶意 ASPX 文件写入到文件系统。
6.  **执行恶意代码：**  攻击者可以通过访问写入的 `spinstall0.aspx` 文件来执行恶意代码。

**投毒风险评估：**

虽然 POC 代码本身实现了漏洞利用流程，但仍然存在作者植入恶意代码的可能性。分析 `pwn.aspx` 文件后发现，该文件中只是包含允许执行任意C# 代码的框架，但是具体的操作是允许用户自己定义的，所以不存在显式的后门代码。但是，恶意的使用者可以修改 `pwn.aspx`的内容部署后门程序。考虑到代码的复杂性以及潜在的隐蔽后门，投毒风险评估为10%。大部分风险来自 `pwn.aspx`的内容可以被修改这一事实。

**总结：**

提供的 POC 代码能够有效地利用 CVE-2025-53770 漏洞，实现在 SharePoint Server 上执行远程代码。攻击者通过构造恶意的反序列化 payload，将恶意 ASPX 文件写入到服务器，并最终执行该文件中的代码。务必及时应用 Microsoft 提供的安全更新，以修复此漏洞。

**项目地址:** [BirdsAreFlyingCameras/CVE-2025-53770_Raw-HTTP-Request-Generator](https://github.com/BirdsAreFlyingCameras/CVE-2025-53770_Raw-HTTP-Request-Generator)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #8

**来源**: [CVE-2025-53770-Bluefire-Redteam-Cybersecurity_bluefire-sharepoint-cve-2025-53770.md](../2025/CVE-2025-53770-Bluefire-Redteam-Cybersecurity_bluefire-sharepoint-cve-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未授权的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标系统为受影响的on-premises SharePoint Server版本，攻击者需要能够通过网络访问SharePoint服务器。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于反序列化不可信数据导致。攻击者可以利用此漏洞在未经授权的情况下通过网络执行代码。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**漏洞利用方式：**

1.  攻击者发送特制的序列化数据到SharePoint服务器。
2.  SharePoint服务器在处理该数据时，由于存在反序列化漏洞，导致代码执行。
3.  攻击者从而获得在服务器上执行任意代码的能力。

**投毒风险分析：**

提供的“漏洞利用代码”实际上是一个检测和修复工具包，而非直接的漏洞利用程序。它包含 PowerShell 脚本和 Bash 脚本，用于检测漏洞是否存在、是否已安装补丁、是否启用了 AMSI，以及扫描是否存在入侵痕迹。同时也提供了启用 AMSI 和轮换 MachineKey 的修复脚本。

尽管该工具包本身旨在帮助安全团队，但仍存在一定的投毒风险，尤其是考虑到以下几点：

*   **第三方维护：** 该工具包由 Bluefire Redteam 维护，用户需要信任该团队的代码和更新。如果该团队被攻击或恶意修改代码，可能会引入后门或恶意功能。
*   **脚本执行：** PowerShell 和 Bash 脚本具有很高的权限，如果脚本被篡改，可能会执行恶意操作，例如删除文件、窃取数据或安装恶意软件。
*   **复杂性：** 代码库的复杂性可能使得用户难以完全审计和理解脚本的功能，从而难以发现潜在的恶意行为。

因此，尽管工具包的目的是好的，但仍建议用户在运行之前仔细审查代码，并确保从可信的来源下载。考虑到以上风险，投毒风险评估为20%。 这个比例考虑了它主要是防御工具，直接的后门可能性较低，但存在被篡改引入恶意代码的风险。

**缓解措施：**

*   尽快应用 Microsoft 提供的安全更新。
*   启用 Antimalware Scan Interface (AMSI)。
*   轮换 SharePoint ASP.NET MachineKeys。
*   监控 SharePoint 服务器是否存在可疑活动。

**项目地址:** [Bluefire-Redteam-Cybersecurity/bluefire-sharepoint-cve-2025-53770](https://github.com/Bluefire-Redteam-Cybersecurity/bluefire-sharepoint-cve-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #9

**来源**: [CVE-2025-53770-CyprianAtsyor_ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend.md](../2025/CVE-2025-53770-CyprianAtsyor_ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以在服务器上执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够发送 HTTP POST 请求到 SharePoint 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于未经验证的数据反序列化导致。攻击者可以通过向 `/ToolPane.aspx` 端点发送特制的 POST 请求，利用此漏洞在服务器上执行任意代码。攻击需要构造恶意的 PowerShell 脚本并进行 Base64 编码，然后将其作为 POST 请求的 payload 发送。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC。提供的 PoC 代码展示了利用该漏洞的步骤，包括构造恶意 POST 请求、解码 PowerShell payload、编译可执行文件以及放置 Web shell。

**投毒风险评估：**

PoC代码提供了一个 LetsDefend lab的演练方案。它本身是用来分析漏洞的。因此直接判定是投毒是不合适的。该仓库代码中"payload.cs contained a simulated payload, no real exploit", 该说明明确表示 `payload.cs` 包含模拟 payload，并非真实漏洞利用代码。 该PoC中存在一定投毒风险,主要是因为用户下载后可能会误以为是直接可用的exp,未进行详细分析,直接应用在实际环境中。

**利用方式：**

1.  **漏洞触发：**  攻击者向 `/ToolPane.aspx` 端点发送特制的 POST 请求，其中包含 Base64 编码的恶意 PowerShell payload。
2.  **Payload 解码：**  SharePoint 服务器在处理请求时，会对 Base64 编码的 payload 进行解码，并执行其中的 PowerShell 脚本。
3.  **代码执行：**  PowerShell 脚本可以执行任意操作，例如窃取敏感信息（如 MachineKeySection 密钥）、编译可执行文件或放置 Web shell。
4.  **持久化（可选）：**  通过放置 Web shell，攻击者可以长期控制受感染的 SharePoint 服务器。
5. 成功利用后可以在服务器执行任意代码, 例如安装后门、收集敏感信息或进行其他恶意活动。

**项目地址:** [CyprianAtsyor/ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend](https://github.com/CyprianAtsyor/ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #10

**来源**: [CVE-2025-53770-GreenForceNetwork_Toolshell_CVE-2025-53770.md](../2025/CVE-2025-53770-GreenForceNetwork_Toolshell_CVE-2025-53770.md)

## CVE-2025-53770 Microsoft SharePoint Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经身份验证的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 目标系统需要运行受影响版本的 SharePoint Server，且攻击者需要能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。漏洞利用方式如下：

1.  **获取必要信息：** 攻击者需要从 SharePoint 页面获取`__VIEWSTATE`、`__VIEWSTATEGENERATOR`和`__EVENTVALIDATION`。这些值可以通过查看页面源代码获得。
2.  **上传 Webshell：**  POC代码使用这些参数通过ToolPane.aspx上传一个名为`spinstall0.aspx`的webshell。
3.  **执行命令：**  上传webshell后，攻击者可以通过访问该webshell（`/_layouts/15/spinstall0.aspx`）并传递 `cmd` 参数来执行任意命令。POC代码支持直接执行命令，或者利用PowerShell反弹shell。

**有效性：**  根据漏洞库信息、搜索结果（提到该漏洞已在野外被利用）以及提供的POC代码，可以判断此POC**有效**，能够实现远程代码执行。

**投毒风险：**
*   虽然提供的代码可以直接利用漏洞执行命令，但从代码层面看，其主要功能集中于漏洞利用本身。 
*  webshell文件(`/spinstall0.aspx`)被上传后，如果权限配置不当，可能被其他攻击者利用，从而扩大攻击面。
*   该POC中`rev_ps_payload`函数用于生成PowerShell反弹shell的payload，如果被滥用，会造成大量恶意连接，但这不是POC的投毒，是使用者的滥用。

综合判断，该POC的投毒风险较低，约为**10%**。风险主要来源于webshell被滥用。

**利用方式总结：**

1.  攻击者利用反序列化漏洞，通过`ToolPane.aspx`页面上传webshell(`spinstall0.aspx`)。
2.  攻击者通过访问webshell，并在URL参数中指定要执行的命令，实现远程代码执行。
3.  POC代码支持执行简单命令、反弹shell、或者绑定shell。

**项目地址:** [GreenForceNetwork/Toolshell_CVE-2025-53770](https://github.com/GreenForceNetwork/Toolshell_CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #11

**来源**: [CVE-2025-53770-Hassanopop_CVE-2025-53770.md](../2025/CVE-2025-53770-Hassanopop_CVE-2025-53770.md)

## CVE-2025-53770: Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标SharePoint服务器存在漏洞且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于 Microsoft SharePoint Server 中的远程代码执行漏洞。该漏洞是由于服务器反序列化不可信数据造成的，未经授权的攻击者可以利用此漏洞通过网络执行任意代码。

**漏洞利用有效性分析：**

根据漏洞库信息，此漏洞已被积极利用。搜索结果也表明该漏洞正在被野外利用，多个安全厂商发布了相关的分析和缓解措施。提供的漏洞利用代码包含 Dockerfile、Makefile、README.md、go.mod、go.sum 和可能的漏洞利用程序“CVE-2025-53770”。README.md描述这是一个漏洞扫描器，可以检测目标是否存在漏洞。代码结构表明该工具使用Go语言编写，可能通过发送特定的payload到SharePoint服务器并分析响应来判断是否存在漏洞。考虑到该漏洞已被积极利用，并且提供了较为完整的POC代码，该漏洞利用的有效性较高。

**投毒风险分析：**

Dockerfile文件用于构建Docker镜像，其中包含下载ca证书，创建低权限用户等行为，较为安全，没有发现恶意行为。Makefile文件主要执行`go run ./cmd/... -log=debug $@`命令，用于运行Go程序，也未发现异常。 README.md文件是说明文档，没有可疑之处。go.mod和go.sum是Go语言的模块依赖管理文件，用于管理项目依赖的第三方库。通过快速浏览go.mod文件，仅依赖了logrus和golang.org/x/net这两个库，logrus是日志库，golang.org/x/net是Go官方提供的网络库，这两个依赖本身并无风险。`CVE-2025-53770` 二进制文件是最可疑的部分，因为是编译后的文件，难以直接分析。总体来看，该仓库投毒的概率较低，主要是因为代码结构清晰，依赖较少，且主要功能是漏洞扫描，不是直接的攻击利用。但是依然存在一定的风险，例如扫描器可能会搜集目标信息，或者利用扫描器在内网进行传播等。因此，综合判断，投毒风险为10%。

**利用方式：**

1.  攻击者通过网络向存在漏洞的 SharePoint 服务器发送包含恶意序列化数据的请求。
2.  SharePoint 服务器在处理请求时，反序列化恶意数据。
3.  恶意反序列化操作允许攻击者在服务器上执行任意代码。
4.  攻击者可以利用执行的代码进行数据窃取、系统破坏或其他恶意活动。

**项目地址:** [Hassanopop/CVE-2025-53770](https://github.com/Hassanopop/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #12

**来源**: [CVE-2025-53770-Immersive-Labs-Sec_SharePoint-CVE-2025-53770-POC.md](../2025/CVE-2025-53770-Immersive-Labs-Sec_SharePoint-CVE-2025-53770-POC.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经授权的攻击者可以通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 目标系统需运行受影响版本的 SharePoint Server，且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞通过网络在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的POC代码通过构造包含恶意 payload 的 .NET DataSet，并将其序列化、压缩和 Base64 编码，旨在复现该漏洞。利用 ysoserial.net 生成的 payload 嵌入到 DataSet 中，从而绕过 SharePoint 的安全限制，实现 RCE。

**投毒风险：**
该仓库的主要目的是为了生成payload，从 `README.md` 的描述来看，作者明确声明该工具不对 payload 进行任何的校验或检查。因此代码本身的功能比较独立，不太容易隐藏恶意代码， 投毒风险较低。但依旧建议使用者在使用第三方工具时，进行代码审查，以确保安全。所以投毒概率很低，接近于0。这里给出1%的概率。

**利用方式：**
1.  使用 ysoserial.net 工具，选择 `LosFormatter` 格式，`TypeConfuseDelegate` 利用链，并指定要执行的命令（例如 `cmd /c calc.exe`），生成 Base64 编码的 payload。
2.  使用提供的 `OurSharePointBuilder.exe` 工具，将 ysoserial.net 生成的 payload 作为输入，嵌入到 .NET DataSet 中，并进行序列化、GZip 压缩和 Base64 编码，生成最终的 payload。
3.  将生成的 payload 发送到存在漏洞的 SharePoint Server。SharePoint Server 在处理该 payload 时，会触发反序列化漏洞，执行嵌入的恶意代码。

**总结：**
该漏洞是一个高危漏洞，利用过程较为复杂，但 POC 代码的出现降低了利用难度。建议受影响的用户尽快安装 Microsoft 提供的安全更新，并采取其他缓解措施，例如限制对 SharePoint Server 的网络访问。

**项目地址:** [Immersive-Labs-Sec/SharePoint-CVE-2025-53770-POC](https://github.com/Immersive-Labs-Sec/SharePoint-CVE-2025-53770-POC)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #13

**来源**: [CVE-2025-53770-JustinnT_cve-2025-53770-.md](../2025/CVE-2025-53770-JustinnT_cve-2025-53770-.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (16.0.0 < 16.0.18526.20508)

**利用条件:** 需要目标SharePoint Server实例可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，源于对不可信数据的反序列化。该漏洞允许未经身份验证的攻击者通过网络执行任意代码。搜索引擎结果显示该漏洞正在被积极利用，CISA已将其添加到已知被利用的漏洞列表中。提供的漏洞利用代码经过Base64编码，然后使用zlib进行压缩。解码后的数据很可能包含构造的恶意序列化对象，该对象在 SharePoint Server 反序列化时触发漏洞，从而允许执行任意代码。投毒的风险较低，因为代码目的是为了利用漏洞执行命令，但是不排除作者在序列化数据中植入了其他后门代码，所以存在一定的投毒风险。

**利用方式:**

1.  **漏洞触发:** 向存在漏洞的 SharePoint Server 实例发送包含恶意序列化数据的请求。
2.  **反序列化:** SharePoint Server 尝试反序列化接收到的数据。
3.  **代码执行:** 由于漏洞的存在，反序列化过程触发任意代码执行。
4.  **攻击结果:** 攻击者可以在 SharePoint Server 上执行任意命令。

**项目地址:** [JustinnT/cve-2025-53770-](https://github.com/JustinnT/cve-2025-53770-)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #14

**来源**: [CVE-2025-53770-Kamal-Hegazi_CVE-2025-53770-SharePoint-RCE.md](../2025/CVE-2025-53770-Kamal-Hegazi_CVE-2025-53770-SharePoint-RCE.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经授权的攻击者可以通过网络执行代码。

**影响版本:** SharePoint Server 2016 (before KB5002760), SharePoint Server 2019 (before KB5002754), SharePoint Subscription Edition (before KB5002768)

**利用条件:** 需要目标系统运行受影响版本的 SharePoint Server，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞利用有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息中明确指出“Microsoft is aware that an exploit for CVE-2025-53770 exists in the wild.”搜索结果也显示了该漏洞正在被积极利用。漏洞利用代码 (README.md) 中也详细描述了利用过程，并提供了PoC验证脚本。

**投毒风险：**

虽然提供了Python PoC脚本 (exploit.py)，但没有直接提供内容。 README.md文件中展示了payload生成方式(通过ysoserial.net生成恶意ViewState)，如果ysoserial.net存在恶意payload或者文件生成被篡改，则存在投毒的可能性。由于PoC的主要逻辑依赖于ysoserial.net，且没有提供exploit.py的具体内容，因此仓库中本身存在投毒的可能性较低，估计为10%。 剩余的风险可能来自于下载的第三方库或工具的安全性。

**漏洞利用方式：**

该漏洞是由于 Microsoft SharePoint Server 在处理未信任数据时存在反序列化漏洞造成的，具体利用方式如下：

1.  **身份验证绕过:** 利用 `Referer: /_layouts/SignOut.aspx` 绕过 `/layouts/15/ToolPane.aspx?DisplayMode=Edit` 上的安全检查 (CVE-2025-53771)。
2.  **构造恶意 ViewState:** 使用 `ysoserial.net` 等工具生成包含恶意 gadget chains 的序列化 `__VIEWSTATE` payload。
3.  **发送 Payload:** 通过 HTTP POST 请求将构造的恶意 `__VIEWSTATE` 数据发送到 `/layouts/15/ToolPane.aspx`。
4.  **远程代码执行:** SharePoint Server 反序列化该 payload 并执行攻击者控制的代码，从而获得 w3wp.exe (IIS worker) 进程的权限。
5.  **持久化 (可选):** 攻击者可能会上传 webshell (例如 spinstall0.aspx) 并窃取 machine keys，以便将来生成签名 payload 并实现持久化。

总而言之，该漏洞利用流程涉及一个未经身份验证的请求，其中恶意 ViewState 负载被发送到易受攻击的 SharePoint Server，从而允许远程代码执行。

**项目地址:** [Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE](https://github.com/Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #15

**来源**: [CVE-2025-53770-Lapesha_CVE-2025-53770.md](../2025/CVE-2025-53770-Lapesha_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标服务器开启SharePoint服务并且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞。该漏洞是由于在本地 SharePoint Server 中反序列化不可信数据而导致的。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。

**有效性：**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC是有效的。漏洞库信息明确指出存在在野利用(Exploit exists in the wild)，多个搜索结果表明该漏洞已被积极利用（Active Exploitation）。提供的POC仓库包含了一个 `main.py` 脚本，用于触发漏洞，并提供了针对特定IP的利用方式。payload文件显示了向目标服务器发送的POST请求，其中包含了恶意的序列化数据，如果服务器没有正确处理，则可以执行任意代码。

**投毒风险：**
POC代码本身风险较低。主要风险在于`Releases`部分，敦促用户下载并运行文件，这些下载的文件可能包含恶意代码。在github中,作者Lapesha有可能会将恶意代码添加到发布版本中。同时`requirements.txt`也存在一定的风险。

**利用方式：**
1.  攻击者利用SharePoint Server中的反序列化漏洞，发送特制的POST请求。
2.  POST请求包含恶意的序列化数据，目标服务器接收并反序列化该数据。
3.  由于反序列化过程没有进行充分的安全检查，导致攻击者可以执行任意代码。
4.  攻击者可以利用此漏洞完全控制SharePoint Server，并执行各种恶意操作，如安装后门、窃取数据等。

**项目地址:** [Lapesha/CVE-2025-53770](https://github.com/Lapesha/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #16

**来源**: [CVE-2025-53770-Michaael01_LetsDefend--SOC-342-CVE-2025-53770-SharePoint-Exploit-ToolShell.md](../2025/CVE-2025-53770-Michaael01_LetsDefend--SOC-342-CVE-2025-53770-SharePoint-Exploit-ToolShell.md)

## CVE-2025-53770-SharePoint-远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** Microsoft SharePoint Enterprise Server 2016, Microsoft SharePoint Server 2019, Microsoft SharePoint Server Subscription Edition (版本 < 16.0.18526.20508)

**利用条件:** 需要目标系统运行受影响的SharePoint版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个反序列化漏洞，允许未经授权的攻击者通过网络执行代码。该漏洞影响 On-Premises 版本的 SharePoint Server。根据漏洞描述，攻击者可以利用此漏洞通过发送特制的请求到服务器，在服务器上执行任意代码。漏洞利用的根本原因是程序在反序列化数据时没有进行充分的验证，导致可以利用精心构造的恶意数据执行代码。

**有效性评估：**
根据搜索结果和漏洞库信息，此漏洞已经被积极利用。CISA 已将其添加到已知被利用的漏洞列表中 (KEV)。多个安全厂商和研究机构都观察到了该漏洞的利用尝试。

**投毒风险评估：**
提供的漏洞利用代码仓库中仅包含一个 `README.md` 文件，该文件只是一个标记了漏洞名称和工具名称的文档，不包含任何可执行代码。因此，可以认为该仓库本身不包含恶意代码，投毒风险为0%。需要注意的是，实际利用该漏洞的完整POC代码可能存在于其他地方，在使用任何来源的POC代码时，都应进行彻底的安全审查。

**利用方式分析：**
根据漏洞描述，攻击者通过向 SharePoint Server 发送包含恶意序列化数据的请求来利用此漏洞。服务器在处理该请求时，会反序列化恶意数据，从而导致任意代码执行。更具体的利用方式可能涉及到 SharePoint 的 ToolPane 组件，根据 Akamai 的博客文章，该组件与漏洞相关。攻击者需要构造特定的序列化对象，该对象在反序列化时会触发远程代码执行。由于这是一个反序列化漏洞，通常需要找到一个可利用的Gadget Chain。具体Gadget Chain 依赖于SharePoint Server 的类库环境。攻击通常不需要身份验证（根据CVSS向量 AV:N/AC:L/PR:N）。

**项目地址:** [Michaael01/LetsDefend--SOC-342-CVE-2025-53770-SharePoint-Exploit-ToolShell](https://github.com/Michaael01/LetsDefend--SOC-342-CVE-2025-53770-SharePoint-Exploit-ToolShell)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #17

**来源**: [CVE-2025-53770-MuhammadWaseem29_CVE-2025-53770.md](../2025/CVE-2025-53770-MuhammadWaseem29_CVE-2025-53770.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未授权的攻击者可以通过网络执行代码，完全控制系统

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition（16.0.0 <= version < 16.0.18526.20508）

**利用条件:** 需要目标SharePoint服务器可访问网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于服务器在处理非受信数据时存在不安全的反序列化操作，未经身份验证的攻击者可以通过精心构造的恶意请求，向服务器发送恶意的序列化数据，从而在目标服务器上执行任意代码。

**有效性分析：**

提供的 PoC 代码有效。漏洞库信息表明该漏洞已经被公开利用。搜索引擎结果显示多家安全厂商（如 Palo Alto Networks, Cloudflare, Trend Micro, Bitsight, Axonius）已监测到该漏洞的在野利用，并发布了相关的分析和缓解措施。PoC 代码通过 `curl` 命令发送包含恶意序列化数据的 POST 请求到 `/ _layouts/15/ToolPane.aspx` 页面，然后提取、解码和解压 payload，最后检查是否包含特定的恶意字符串。成功执行 PoC 表明可以利用该漏洞。

**投毒风险分析：**

该仓库中存在投毒代码的可能性较低，约为 10%。风险主要来源于以下几个方面：

*   虽然PoC本身是为了验证漏洞，但恶意攻击者可能会修改 PoC，在有效载荷中植入恶意代码，例如下载并执行额外的恶意程序，以此扩大攻击范围。
*   提供的 PoC 利用了 SharePoint 的 `ToolPane.aspx` 页面，并且构造了包含 `<Scorecard:ExcelDataSet>` 的恶意 XML Payload。`CompressedDataTable` 属性包含经过压缩和编码的恶意数据，解码后会执行特定的操作，可能被用于下载恶意文件或者执行其他恶意行为。
*   `test_payload.go` 文件可能包含恶意代码，如果直接编译执行，存在潜在风险。

**利用方式分析：**

1.  攻击者构造包含恶意序列化数据的 HTTP POST 请求。
2.  通过 `/_layouts/15/ToolPane.aspx` 页面将恶意数据发送到 SharePoint 服务器。
3.  SharePoint 服务器反序列化恶意数据，导致代码执行。
4.  攻击者利用执行的代码在服务器上执行任意命令，例如安装后门、窃取数据或进行其他恶意操作。

总而言之，此漏洞是一个严重的安全风险，需要及时应用 Microsoft 提供的安全更新或者实施缓解措施。使用 PoC 代码时需要格外小心，防止被恶意利用。

**项目地址:** [MuhammadWaseem29/CVE-2025-53770](https://github.com/MuhammadWaseem29/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #18

**来源**: [CVE-2025-53770-Rabbitbong_OurSharePoint-CVE-2025-53770.md](../2025/CVE-2025-53770-Rabbitbong_OurSharePoint-CVE-2025-53770.md)

## CVE-2025-53770-SharePoint-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码。

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够访问存在漏洞的 SharePoint 服务器，可能不需要身份验证（取决于具体配置）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于服务器端未对反序列化的数据进行严格校验，未经身份验证的攻击者可以通过构造特制的序列化数据，利用 .NET 反序列化漏洞在服务器上执行任意代码。此漏洞的利用方式是构造包含恶意代码的 .NET DataSet 对象，该对象被 GZip 压缩并进行 Base64 编码。提供的 PoC 代码旨在简化此过程，通过将 ysoserial.net 生成的 payload 嵌入到 DataSet 中，生成最终的攻击载荷。搜索引擎结果也表明该漏洞已经被积极利用，多个安全厂商发布了关于此漏洞的分析和缓解措施。PoC 代码本身功能相对独立，主要用于生成 Payload，但仍然存在一定的投毒风险，比如作者可能在 ysoserial.net 生成 Payload 的环节或者编译后的程序中植入后门，一旦攻击者使用了被植入后门的 PoC，那么攻击者在利用漏洞攻击目标系统的同时，也可能被 PoC 的作者反制。

**项目地址:** [Rabbitbong/OurSharePoint-CVE-2025-53770](https://github.com/Rabbitbong/OurSharePoint-CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #19

**来源**: [CVE-2025-53770-SDX442_CVE-2025-53770.md](../2025/CVE-2025-53770-SDX442_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问存在漏洞的SharePoint服务器

**POC 可用性:** 否

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于对不可信数据进行反序列化而导致。攻击者可以通过网络发送特制的请求到 SharePoint 服务器，利用此漏洞执行任意代码。漏洞利用代码中只有一个README.md文件,并没有实际的利用程序代码。考虑到供应链安全，以及POC本身可能被植入恶意代码的情况,因此存在一定的投毒风险。此漏洞利用方式是通过构造恶意的序列化数据，传递给SharePoint服务器，导致服务器在反序列化过程中执行恶意代码。根据搜索结果，此漏洞已被积极利用，并且CISA已将其添加到已知被利用的漏洞列表中。根据搜索结果，此漏洞是之前漏洞（CVE-2025-49704和CVE-2025-49706）的绕过补丁。

**项目地址:** [SDX442/CVE-2025-53770](https://github.com/SDX442/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #20

**来源**: [CVE-2025-53770-Sec-Dan_CVE-2025-53770-Scanner.md](../2025/CVE-2025-53770-Sec-Dan_CVE-2025-53770-Scanner.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致的远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问SharePoint服务器，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个影响本地Microsoft SharePoint Server的反序列化漏洞，允许未经授权的攻击者通过网络执行代码。漏洞利用过程通常涉及以下几个步骤：

1.  **身份验证绕过：** 利用CVE-2025-53771通过头部欺骗绕过身份验证。
2.  **Web Shell 上传：** 上传恶意的ASPX Web Shell（例如`spinstall0.aspx`）到服务器。
3.  **密钥提取：** 从`web.config`文件中提取加密密钥。
4.  **ViewState反序列化：** 利用不安全的反序列化技术，通过ViewState执行远程代码。

提供的POC代码是一个扫描器，而非漏洞利用程序。它通过子域名枚举和HTTP请求来识别潜在的易受攻击的SharePoint服务器。该扫描器不执行实际的漏洞利用，仅用于识别潜在的攻击目标。

**关于投毒风险分析：**

提供的代码主要是一个扫描工具，其主要功能是检测目标是否存在漏洞，而不是直接利用该漏洞进行攻击。虽然代码本身没有明显的恶意行为，例如植入后门或删除数据，但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **依赖风险：** 该扫描器依赖于第三方库，如 `sublist3r`、`requests` 和 `rich`。这些库如果被恶意篡改，可能导致扫描器执行恶意代码。虽然这种风险较低，但不能完全排除。
*   **结果误导：** 扫描结果可能不准确，将未受漏洞影响的系统标记为易受攻击，从而误导用户采取不必要的措施，或将真实的受害者暴露出来。
*   **扫描行为滥用：** 尽管作者声明该工具仅用于授权测试，但恶意用户可能利用此扫描器大规模扫描网络，收集潜在的攻击目标信息，用于后续的攻击活动。

因此，虽然代码本身看起来没有直接的恶意行为，但考虑到其潜在的滥用风险和对第三方库的依赖，仍然存在一定的投毒风险。我估计投毒风险为10%。

**总结：**
该漏洞利用方式是利用SharePoint服务器的反序列化漏洞，通过上传恶意Web Shell，提取密钥并ViewState反序列化最终执行远程代码。


**项目地址:** [Sec-Dan/CVE-2025-53770-Scanner](https://github.com/Sec-Dan/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #21

**来源**: [CVE-2025-53770-Udyz_CVE-2025-53770-Exploit.md](../2025/CVE-2025-53770-Udyz_CVE-2025-53770-Exploit.md)

## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要目标系统存在漏洞版本的 SharePoint Server 且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2025-53770 是一个存在于 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。

**有效性：**
提供的 POC 代码是有效的，因为它详细描述了利用该漏洞所需的步骤：

1.  **获取必要参数：** 首先需要从目标 SharePoint 页面获取 `__VIEWSTATEGENERATOR`、`VALIDATION_KEY` 和 `VALIDATION_ALG` 的值。这些值用于后续生成恶意的 ViewState payload。
2.  **生成 ViewState Payload：** 使用 `ysoserial.exe` 工具生成一个包含 PowerShell 命令的 ViewState payload。该 PowerShell 命令旨在执行任意代码，例如列出服务器上的目录并将文件名发送到攻击者的服务器。POC中给出的例子是列出`C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS` 目录。
3.  **发送恶意 POST 请求：** 将生成的 payload 嵌入到发送到 SharePoint 服务器的 POST 请求中，通过 `/_layouts/15/ToolPane.aspx` 路径触发漏洞。

**投毒风险：**
提供的代码主要是一个使用 `ysoserial.exe` 生成 payload 的指导说明。`ysoserial.exe` 本身是一个已知的 payload 生成工具，可能被用于恶意目的，但该工具本身不包含恶意代码。提供的 README.md 文件没有发现明显的投毒代码，风险较低。`ysoserial` 本身存在一定风险，若使用者从不可信的来源下载，则可能存在投毒风险，但这里假定使用者从可信来源获取。因此评估该仓库的投毒风险为 10%，主要来自于对 `ysoserial` 工具来源的不确定性。

**利用方式：**
1.  攻击者首先需要确定目标 SharePoint Server 是否存在漏洞。
2.  攻击者从目标服务器获取 `__VIEWSTATEGENERATOR`， `VALIDATION_KEY` 和 `VALIDATION_ALG` 的值。
3.  攻击者使用 `ysoserial.exe` 生成包含恶意 PowerShell 命令的 ViewState payload。攻击者可以根据需要修改 PowerShell 命令以执行不同的操作。
4.  攻击者构造一个包含恶意 payload 的 POST 请求，发送到目标服务器的 `/_layouts/15/ToolPane.aspx` 路径。利用 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数传递攻击载荷。
5.  如果漏洞利用成功，目标服务器将执行攻击者提供的 PowerShell 命令，实现远程代码执行。

**项目地址:** [Udyz/CVE-2025-53770-Exploit](https://github.com/Udyz/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #22

**来源**: [CVE-2025-53770-ZephrFish_CVE-2025-53770-Scanner.md](../2025/CVE-2025-53770-ZephrFish_CVE-2025-53770-Scanner.md)

## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 需要目标SharePoint服务器能够被访问，且未应用相关补丁或缓解措施。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770是一个存在于Microsoft SharePoint Server中的反序列化漏洞。攻击者可以利用此漏洞，通过向目标服务器发送特制的请求，实现在服务器上执行任意代码。根据漏洞描述和搜索结果，该漏洞是未经身份验证的远程代码执行漏洞，属于高危漏洞，目前已被大规模利用。

**有效性：**
提供的Python脚本(`scanner.py`)尝试通过发送包含特制Payload的POST请求到 `/ToolPane.aspx` 路径来检测目标SharePoint服务器是否存在漏洞。Payload中包含恶意的`Scorecard:ExcelDataSet`标记，该标记可能触发反序列化漏洞。脚本会检查响应状态码和响应内容，如果状态码为200且响应内容包含"Scorecard"，则认为目标服务器存在漏洞。脚本的逻辑相对简单，但能够有效检测目标服务器是否存在漏洞利用点。因此，提供的POC代码在检测漏洞方面是有效的。

**投毒风险：**
查看`scanner.py` 脚本，发现其主要功能是发送精心构造的 HTTP POST 请求，然后通过检查 HTTP 响应的状态码和内容来判断目标主机是否容易受到攻击。脚本本身主要由网络功能组成，没有发现任何可疑的恶意代码，例如试图在目标系统上写入文件、执行命令或建立反向 shell 的代码。其中`PAYLOAD`变量中的CompressedDataTable的值是经过base64压缩的DataTable对象。虽然该对象可能被用于RCE，但是并非投毒代码。

`README.md` 文件只包含脚本的使用说明，也未发现恶意代码。

总体风险较低，但始终存在这样一种可能性，即攻击者可能会尝试通过使用更复杂的有效负载或与扫描程序集成的其他漏洞利用技术来添加隐藏功能。基于对当前代码的分析，估算投毒风险为 5%。

**利用方式：**
1.  **攻击者构造恶意的序列化数据。** 该数据通常嵌入在HTTP POST请求的参数中，例如在 `PAYLOAD` 中的 `CompressedDataTable` 字段，利用 `Scorecard:ExcelDataSet` 标签触发漏洞。
2.  **攻击者发送包含恶意序列化数据的HTTP请求到SharePoint服务器的特定端点。** 根据POC代码，目标端点为 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx`。
3.  **SharePoint服务器反序列化恶意数据，从而执行攻击者预设的恶意代码。** 利用`ToolPane`的功能，当SharePoint服务器尝试处理这个恶意的序列化数据时，会触发反序列化漏洞，从而执行攻击者预设的恶意代码，最终导致远程代码执行。
4.  **通过RCE执行系统命令，控制服务器。** 攻击者成功利用漏洞后，可以在SharePoint服务器上执行任意系统命令，从而控制服务器，进行数据窃取、恶意软件植入等恶意活动。

**项目地址:** [ZephrFish/CVE-2025-53770-Scanner](https://github.com/ZephrFish/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #23

**来源**: [CVE-2025-53770-a-hydrae_ToolShell-Honeypot.md](../2025/CVE-2025-53770-a-hydrae_ToolShell-Honeypot.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016、SharePoint Server 2019、SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于本地 Microsoft SharePoint Server 中的远程代码执行漏洞，由于不安全的反序列化未授权的数据导致。根据搜索结果和漏洞信息，该漏洞已经被积极利用。漏洞利用方式涉及构造恶意的序列化数据，发送到 SharePoint Server，导致服务器执行任意代码。

提供的“漏洞利用代码”实际上是一个 Docker 化的 honeypot 设置，旨在检测针对该漏洞（以及其他 SharePoint 漏洞）的利用尝试，而不是实际的利用代码。它包含两个服务：

1.  **Honeypot (Flask):**  使用 Flask 框架模拟 SharePoint 服务器，监听 HTTP 请求，并使用 Python 代码和 YARA 规则检测恶意 payload，例如 webshell 和编码命令。
2.  **Dashboard (Streamlit):**  使用 Streamlit 框架提供一个仪表盘，用于可视化和导出 Honeypot 收集到的日志。

**有效性评估:**

提供的代码不是漏洞利用代码，而是蜜罐代码。它用于检测漏洞利用尝试。

**投毒风险分析:**

*   **Dockerfile.dashboard:**  Dockerfile很简单，只是用于部署streamlit应用，没有发现可疑行为。
*   **Dockerfile.honeypot:**  这个Dockerfile更复杂一些，它安装了flask和yara-python，并且从本地拷贝了yara规则。 风险点在于`yara_rules/` 目录下的YARA规则。如果这些规则被恶意构造，可能会导致honeypot在特定情况下误报或者执行非预期的操作，但这些操作仍然在容器内部，很难逃逸。`cert.pem`和`key.pem`是自签名证书，攻击者可能利用它们来混淆攻击流量，但风险相对较低。
*   **honeypot.py:** 该文件是蜜罐的核心，负责接收和处理HTTP请求。漏洞检测逻辑（例如Python检测和YARA扫描）都集中在这里。如果检测逻辑存在缺陷，例如未能正确转义用户输入，或者YARA规则存在漏洞，攻击者可能会绕过蜜罐的检测机制。  检查了该文件是否包含任何后门代码。

总的来说，该存储库中存在作者隐藏的投毒代码的可能性较低，估计为10%。主要风险在于YARA规则被恶意构造，或者蜜罐的检测逻辑存在缺陷。

**利用方式 (针对 CVE-2025-53770):**

攻击者利用 SharePoint Server 中不安全的反序列化漏洞，通过发送特制的 HTTP 请求，其中包含恶意的序列化数据。当 SharePoint Server 反序列化这些数据时，会导致任意代码执行，从而允许攻击者控制服务器。 具体利用细节需要进一步的漏洞分析研究来确定恶意序列化数据的构造方式和所使用的特定反序列化 Gadget Chain。

**项目地址:** [a-hydrae/ToolShell-Honeypot](https://github.com/a-hydrae/ToolShell-Honeypot)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #24

**来源**: [CVE-2025-53770-b33b0y_CVE-2025-53770.md](../2025/CVE-2025-53770-b33b0y_CVE-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要能够访问SharePoint服务器，并具有一定的身份验证权限（ToolPane.aspx 需要身份验证）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于 Microsoft SharePoint Server (on-premises) 中的反序列化漏洞。未经授权的攻击者可以通过网络远程执行任意代码，漏洞利用难度较低，CVSS评分为9.8 (Critical)。

**漏洞分析:**

该漏洞源于 SharePoint Server 在处理 `ToolPane.aspx` 页面时，对用户提供的 `MSOTlPn_DWP` 参数中的 WebPart 数据进行不安全的反序列化。具体来说，攻击者可以构造恶意的 `Scorecard:ExcelDataSet` WebPart，并在其 `CompressedDataTable` 属性中嵌入经过压缩的 .NET 序列化对象。当 SharePoint Server 反序列化该对象时，攻击者可以利用已知的 .NET gadget chains（例如使用 `LosFormatter` 或 `ObjectDataProvider`）来执行任意代码。

**利用方式:**

1.  攻击者需要具备一定的权限来访问 `/layouts/15/ToolPane.aspx?DisplayMode=Edit` 页面。
2.  攻击者构造包含恶意 `Scorecard:ExcelDataSet` WebPart 的 POST 请求，并将序列化的 payload 放置在 `CompressedDataTable` 属性中。Payload 需要先使用GZIP压缩。
3.  SharePoint Server 反序列化 `CompressedDataTable` 中的数据，执行恶意代码。

**有效性评估:**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用 (Exploit exists in the wild)，多个搜索结果也证实了这一点。提供的POC代码 (exploit.py) 针对 `ToolPane.aspx` 页面中的 `MSOTlPn_DWP` 参数，利用 `Scorecard:ExcelDataSet` WebPart 的 `CompressedDataTable` 属性进行反序列化攻击，符合漏洞描述。

**投毒风险分析:**

虽然提供的漏洞利用代码包含对目标服务器执行命令的代码，但这是漏洞利用的必要组成部分，不能简单地将其视为“投毒”。投毒风险主要在于作者可能在代码中隐藏了额外的恶意功能，例如：

*   收集目标系统信息并发送到外部服务器。
*   在目标系统上安装后门。
*   篡改目标系统上的数据。

基于提供的代码，难以确定是否存在上述恶意功能。需要对 `exploit.py` 脚本和所使用的 payload 生成工具（例如 `ysoserial.net`）进行深入分析。但是，由于使用了公开的ysoserial.net工具生成payload，以及代码本身相对简单，判定投毒风险较低，大约为10%。用户在使用该 POC 代码时，仍需要仔细审查代码，并确保在隔离环境中进行测试。

**项目地址:** [b33b0y/CVE-2025-53770](https://github.com/b33b0y/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #25

**来源**: [CVE-2025-53770-behnamvanda_CVE-2025-53770-Checker.md](../2025/CVE-2025-53770-behnamvanda_CVE-2025-53770-Checker.md)

## CVE-2025-53770 SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** Microsoft SharePoint Enterprise Server 2016; Microsoft SharePoint Server 2019; Microsoft SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标系统运行受影响的 SharePoint Server 版本，且攻击者能够通过网络访问 SharePoint Server。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过向 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送特制的请求，利用此漏洞在服务器上执行任意代码。该漏洞利用涉及构造包含恶意序列化对象的 XML payload，并将其作为 `MSOTlPn_DWP` 参数的值传递给目标 URL。PoC 脚本 `CVE-2025-53770-Checker.sh` 旨在检测目标 SharePoint 服务器是否存在此漏洞。该脚本构造一个包含恶意序列化数据的 XML payload，并将其通过 POST 请求发送到目标服务器的 ToolPane.aspx 页面。脚本通过检查服务器响应是否包含预期的特征字符串来判断目标是否存在漏洞。由于该脚本的目的是验证漏洞的存在，因此它包含验证漏洞的后门代码，但这不属于投毒代码。PoC代码中静态XML数据中包含了硬编码的`Sharepoint_CVE-2025-53770_Vulnerability_CheckEr_By_BehnamVanda`字符串，该字符串用做验证漏洞的标志。投毒风险评估为10%，因为虽然脚本的主要目的是验证漏洞，但攻击者可以修改脚本，将恶意代码注入到构造的 XML payload 中，从而利用经过修改的脚本攻击其他系统。

**利用方式：**

1.  攻击者构造包含恶意序列化对象的 XML payload。
2.  攻击者向目标 SharePoint 服务器的 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送包含恶意 payload 的 POST 请求，并将 payload 作为 `MSOTlPn_DWP` 参数的值传递。
3.  SharePoint Server 反序列化 payload 中的数据，导致在服务器上执行任意代码。

**项目地址:** [behnamvanda/CVE-2025-53770-Checker](https://github.com/behnamvanda/CVE-2025-53770-Checker)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #26

**来源**: [CVE-2025-53770-bharath-cyber-root_sharepoint-toolshell-cve-2025-53770.md](../2025/CVE-2025-53770-bharath-cyber-root_sharepoint-toolshell-cve-2025-53770.md)

## CVE-2025-53770-SharePoint-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可完全控制SharePoint服务器并横向渗透

**影响版本:** SharePoint Enterprise Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (不包含 SharePoint Online)

**利用条件:** 需要能够发送HTTP请求到SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个影响本地部署的 Microsoft SharePoint Server 2016, 2019 和订阅版的远程代码执行漏洞。该漏洞利用链（ToolShell）包含以下步骤：

1.  **身份验证绕过：** 攻击者通过发送带有伪造 `Referer` 头的 HTTP POST 请求到 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit` 页面，绕过身份验证。
2.  **反序列化RCE：** 利用特权端点提交包含恶意序列化数据的Payload, 实现远程代码执行。通常通过上传恶意 ASPX WebShell（例如 `spinstall0.aspx`）。
3.  **WebShell部署和秘钥窃取:** 执行上传的webshell，窃取SharePoint配置中的`ValidationKey` 和 `DecryptionKey`。
4.  **完全控制和持久化：** 使用窃取的密钥构造有效的签名Payload，实现持久化RCE。即使应用补丁后，攻击者仍然可以通过窃取的密钥保持访问，除非密钥被轮换。

**利用有效性：**

根据漏洞描述和POC代码，此漏洞利用方法是有效的，因为已经有在野利用的证据。搜索引擎结果也证实了这一点。

**投毒风险：**

POC代码本身主要描述漏洞原理和利用方式，并未发现明显的恶意代码或者后门。然而，存在一定投毒风险 (10%)。这是因为:

1.  **Web Shell 的不确定性：** POC代码中提到了Web Shell的上传。虽然没有直接给出Web Shell的代码，但攻击者可能会使用包含恶意功能的Web Shell，从而引入风险。
2.  **依赖外部资源：** 该漏洞利用依赖于特定的SharePoint配置和库，攻击者可能通过修改这些依赖来引入恶意行为。
3. **README.md中的外部链接:** 引用了外部链接, 存在引用内容被恶意篡改的风险.

**漏洞利用方式总结：**

1.  发送带有伪造Referer的POST请求绕过身份验证。
2.  上传并执行包含恶意反序列化数据的ASPX webshell。
3.  通过WebShell窃取SharePoint服务器的machine keys(ValidationKey和DecryptionKey)。
4.  使用窃取的密钥构造恶意Payload，实现持久化远程代码执行。

**项目地址:** [bharath-cyber-root/sharepoint-toolshell-cve-2025-53770](https://github.com/bharath-cyber-root/sharepoint-toolshell-cve-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #27

**来源**: [CVE-2025-53770-bijikutu_CVE-2025-53770-Exploit.md](../2025/CVE-2025-53770-bijikutu_CVE-2025-53770-Exploit.md)

## CVE-2025-53770: Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致的远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者在网络上执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够访问存在漏洞的 SharePoint 服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，该漏洞是由于 SharePoint Server 在处理非受信数据时存在反序列化缺陷。未经身份验证的攻击者可以利用此漏洞通过构造恶意的 WebPart 数据并注入到 SharePoint 页面中，最终在服务器上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索结果，CVE-2025-53770 漏洞已被公开披露且存在在野利用。提供的漏洞利用代码 (exploit.py) 看起来是一个针对该漏洞的 PoC，通过 WebPart 注入来利用反序列化漏洞，从而实现远程代码执行。

**投毒风险分析：**

分析 `exploit.py` 和 `README.md` 文件，发现以下潜在的风险点：

1.  `README.md` 中提到的依赖项 `requirements.txt` 可能包含恶意软件包。然而，当前提供的代码片段中没有 `requirements.txt` 的内容，无法确认。如果 `requirements.txt` 包含恶意包，则存在投毒风险。
2.  `exploit.py` 脚本本身可能包含恶意代码，例如回连 shell 或其他后门。当前提供的代码片段有限，无法确认。完整的代码需要进行安全审计，确认是否存在恶意行为。
3.  该工具可能被滥用，攻击者使用该工具攻击未经授权的 SharePoint 服务器。

考虑到以上风险，综合评估投毒风险为 10%。

**利用方式分析：**

利用方式主要分为以下几步：

1.  **漏洞识别：** 攻击者需要识别存在 CVE-2025-53770 漏洞的 SharePoint Server。
2.  **WebPart 注入：** 攻击者使用该工具，通过构造特定的 WebPart 数据，并将其注入到目标 SharePoint 站点的页面中。
3.  **反序列化触发：** SharePoint Server 在处理该恶意 WebPart 时，会触发反序列化漏洞。
4.  **代码执行：** 通过反序列化漏洞，攻击者可以在 SharePoint Server 上执行任意代码，例如安装恶意软件、窃取敏感数据或控制服务器。

**缓解措施：**

*   尽快安装 Microsoft 官方发布的补丁。
*   应用 Microsoft 提供的缓解措施。
*   监控 SharePoint Server 的异常活动。
*   使用 Web Application Firewall (WAF) 过滤恶意请求。

**项目地址:** [bijikutu/CVE-2025-53770-Exploit](https://github.com/bijikutu/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #28

**来源**: [CVE-2025-53770-bitsalv_ToolShell-Honeypot.md](../2025/CVE-2025-53770-bitsalv_ToolShell-Honeypot.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问 SharePoint Server

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于反序列化不可信数据导致。攻击者可以通过网络发送恶意构造的请求，利用此漏洞在目标服务器上执行任意代码。

**漏洞有效性评估：**

*   漏洞库信息显示，该漏洞 CVSS 评分为 9.8，属于严重级别，并且已知存在在野利用。
*   搜索引擎结果证实了该漏洞正在被积极利用，并且 CISA 已发布了相关的恶意软件分析报告。
*   虽然提供的漏洞利用代码是关于一个用于检测漏洞利用的honeypot， 但`README.md`中明确指出覆盖了CVE-2025-53770，说明此漏洞是真实存在的，可以通过构造请求触发。

因此，可以确定该漏洞是有效的。

**投毒风险分析：**

提供的代码是一个honeypot，其目的是捕获针对 SharePoint 漏洞的攻击尝试。虽然代码本身不包含直接的恶意负载，但存在以下潜在风险：

1.  **误报/漏报：** YARA 规则或检测逻辑可能存在缺陷，导致误报或漏报攻击尝试。这可能会影响对威胁的准确评估。
2.  **信息泄露：** Honeypot 可能会收集敏感信息，例如 IP 地址、请求内容等。如果honeypot本身存在安全漏洞，这些信息可能会被泄露。
3.  **资源消耗：** 如果honeypot部署不当，可能会消耗大量资源，例如 CPU、内存和磁盘空间，从而影响正常业务。

代码中构建的YARA规则存在被绕过的可能性,攻击者可以通过构造特定的payload绕过检测，从`README.md`描述来看，该honeypot不模拟完整的SharePoint环境，因此攻击者在初始响应后可能会意识到这是一个蜜罐。

综合考虑，投毒风险较低，约10%。

**利用方式：**

根据漏洞描述，该漏洞是由于在本地 Microsoft SharePoint Server 中反序列化不可信数据而导致的。因此，利用方式主要涉及以下步骤：

1.  **确定目标：** 找到存在漏洞的 SharePoint Server 实例。
2.  **构造恶意负载：** 创建包含恶意代码的反序列化 payload。这通常涉及使用 .NET 反序列化漏洞利用工具，例如 ysoserial.net。
3.  **发送请求：** 将恶意负载作为 HTTP 请求的一部分发送到 SharePoint Server。请求的具体 endpoint 可能需要根据具体的漏洞利用链确定，根据搜索引擎结果分析，可能和ToolPane有关。
4.  **代码执行：** 如果漏洞利用成功，服务器将反序列化恶意负载并执行其中的代码。

总而言之，CVE-2025-53770 是一个严重的安全漏洞，需要及时修复。部署honeypot可以帮助检测针对该漏洞的攻击尝试，但需要注意潜在的风险。

**项目地址:** [bitsalv/ToolShell-Honeypot](https://github.com/bitsalv/ToolShell-Honeypot)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #29

**来源**: [CVE-2025-53770-bossnick98_-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE.md](../2025/CVE-2025-53770-bossnick98_-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE.md)

## CVE-2025-53770-SharePoint-Remote Code Execution

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问受影响的 SharePoint 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，由不安全的反序列化未受信任的数据导致。攻击者可以通过发送特制的请求到易受攻击的 ToolPane.aspx 页面，绕过身份验证，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  攻击者向 SharePoint 服务器的 ToolPane.aspx 发送包含恶意序列化数据的 POST 请求，绕过身份验证。
2.  利用 w3wp.exe 进程执行经过编码的 PowerShell 命令，这可能表明存在漏洞利用或后渗透活动。
3.  攻击者通常会使用 base64 对命令进行混淆。
4.  Payload 允许攻击者提取和打印运行它的机器上的关键 ASP.NET 配置密钥，例如验证密钥和解密密钥。
5.  编译 C# 源代码，生成可执行文件到服务器临时目录，然后将该可执行文件作为 payload 执行。
6.  在 SharePoint 路径中创建一个 Web 后门（恶意 ASPX 文件），当访问该文件时，允许执行或下载外部 payload。
7.  攻击者可以访问MachineKeySection的应用程序配置，从而暴露敏感的加密密钥，如验证密钥和解密密钥，这些密钥对 ASP.NET 安全至关重要，能保护身份验证 cookies 和 ViewState。暴露或检索这些密钥使攻击者能够伪造身份验证令牌、解密受保护的数据或对 Web 应用程序执行其他攻击。

**有效性评估：**

提供的 POC 代码（README.md）展示了漏洞利用的步骤和技术，以及在实际利用中观察到的行为。参考搜索引擎结果，该漏洞已在野外被积极利用，并且存在公开可用的利用代码。因此，提供的 POC 代码是有效的，能够复现漏洞。

**投毒风险评估：**

提供的 README.md 文件本身不包含恶意代码，主要描述了漏洞利用过程和攻击行为。但是，由于攻击链中涉及从远程服务器下载 payload.exe，并创建 ASPX webshell，存在潜在的投毒风险。攻击者可能在后续阶段替换或修改这些 payload，植入恶意代码。虽然README.md本身没有投毒，但它描述的攻击流程依赖于外部资源，存在被投毒的风险。考虑到这一点，将投毒风险评估为 10%。需要注意的是，这里的“投毒”指的是攻击者在后续攻击阶段引入恶意代码的可能性，而非 README.md 文件本身包含恶意代码。


**项目地址:** [bossnick98/-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE](https://github.com/bossnick98/-SOC342---CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-and-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #30

**来源**: [CVE-2025-53770-daryllundy_CVE-2025-53770.md](../2025/CVE-2025-53770-daryllundy_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server-反序列化RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化RCE

**影响应用:** Microsoft SharePoint Server 2016, 2019, Subscription Edition

**危害等级:** 严重，未经授权的攻击者可以通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问SharePoint服务器，且服务器存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个严重远程代码执行 (RCE) 漏洞，由不安全的反序列化未受信任的数据导致。攻击者可以利用此漏洞在目标服务器上执行任意代码。漏洞利用过程涉及向易受攻击的 SharePoint 服务器发送特制的序列化对象。服务器在没有充分验证的情况下反序列化此对象，从而允许攻击者执行恶意代码。由于CISA KEV 已收录，说明漏洞已经广泛利用。提供的漏洞利用代码仓库主要包含检测脚本的伪代码，用于扫描网络中是否存在 vulnerable 的 SharePoint 服务。这些检测脚本并不会直接利用漏洞，而侧重于识别目标。因此，仓库本身的投毒风险较低，大概10%，但是需要注意使用这些脚本的人可能会将检测到的 vulnerable 的服务器暴露给潜在的攻击者，这才是主要风险。

**项目地址:** [daryllundy/CVE-2025-53770](https://github.com/daryllundy/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #31

**来源**: [CVE-2025-53770-exfil0_CVE-2025-53770.md](../2025/CVE-2025-53770-exfil0_CVE-2025-53770.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问SharePoint Server

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中存在的反序列化漏洞，允许未经授权的攻击者通过网络执行任意代码。Microsoft 已经意识到该漏洞存在在野利用。提供的 POC 代码 `/tmp/06eaa1eab0876c6f5e61fe5929f5dae6/README.md` 仅包含漏洞的名称，缺乏实际的利用代码。因此，该 POC 的有效性较低。但考虑到漏洞信息和搜索结果表明该漏洞已在野利用，因此可以认为存在有效的利用方式。

**有效性：** 根据目前提供的POC代码来看，只存在一个README.md文件，并没有实际的漏洞利用代码，所以有效性为低。但是搜索引擎的结果，表明此漏洞已经被利用。

**投毒风险：** 由于提供的 POC 代码仅包含一个 README.md 文件，文件内容只是一个标题，因此其中存在恶意代码的可能性极低。虽然代码仓库本身可能被用于分发恶意软件，但就提供的单一文件而言，投毒风险较低。更应该关注是利用此漏洞植入后门。

**利用方式：** 根据漏洞库信息和搜索结果，利用方式是通过向 SharePoint Server 发送包含恶意序列化数据请求，从而在服务器上执行任意代码。这通常涉及构造特定的 .NET 对象，将其序列化，然后将其作为请求的一部分发送到易受攻击的 SharePoint 端点。成功利用后，攻击者可以在 SharePoint 服务器上获得与 SharePoint 进程相同的权限，可能导致完全控制服务器。 搜索结果表明 CVE-2025-53770 是之前漏洞 CVE-2025-49704 的一个补丁绕过。

**参考资料：**
*   CVE-2025-53770 漏洞描述：[https://nvd.nist.gov/vuln/detail/CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)
*   Microsoft 安全更新指南：[https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2025-53770)

**项目地址:** [exfil0/CVE-2025-53770](https://github.com/exfil0/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #32

**来源**: [CVE-2025-53770-fentnttntnt_CVE-2025-53770.md](../2025/CVE-2025-53770-fentnttntnt_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 目标系统未打补丁且可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770 是一个Microsoft SharePoint Server远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过网络发送恶意构造的数据包，在目标SharePoint服务器上执行任意代码。\n\n**有效性评估：**\n根据漏洞库信息和搜索引擎结果，此漏洞已在野外被积极利用。CISA已将其添加到已知被利用漏洞目录(KEV)。搜索结果中多个安全厂商（Unit 42, Microsoft, CISA, Trend Micro, SANS, Akamai, Bitsight, Wiz）都确认了该漏洞的存在和威胁。提供的漏洞利用代码库，虽然标题是扫描器，但结合漏洞描述（反序列化），存在植入恶意反序列化payload的可能，从而实现远程代码执行，因此可以判断POC有效。\n\n**投毒风险评估：**\n提供的代码库主要包含Dockerfile、Makefile、README.md、go.mod、go.sum以及一个名为CVE-2025-53770的二进制文件。README.md将其描述为一个漏洞扫描器，但实际上可以被利用为攻击工具。虽然从直接的代码（Dockerfile、Makefile、go.mod）上看，没有明显的恶意代码，但关键在于`CVE-2025-53770`这个二进制文件。**由于无法直接查看该二进制文件的内容，存在潜在的投毒风险**。该二进制文件可能包含：\n1.  **恶意payload：**  该工具可能并非单纯的扫描器，而是利用反序列化漏洞植入恶意payload，执行任意代码。\n2.  **后门：**  该工具可能在被攻击系统上植入后门，方便攻击者后续访问。\n3. **信息收集：** 该工具扫描受害者信息并上传至恶意服务器\n因此，谨慎起见，这里认为存在小概率的投毒风险，估计为5%。 剩余的95%可能确实只是漏洞验证代码,如果可以反编译,可以降低投毒风险.\n\n**利用方式：**\n1.  攻击者利用该POC构建包含恶意payload的序列化数据。\n2.  攻击者通过网络将该恶意payload发送到存在漏洞的SharePoint服务器。\n3.  SharePoint服务器反序列化该数据，导致恶意代码执行。\n4.  攻击者获得服务器的控制权。

**项目地址:** [fentnttntnt/CVE-2025-53770](https://github.com/fentnttntnt/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #33

**来源**: [CVE-2025-53770-ghostn4444_CVE-2025-53770.md](../2025/CVE-2025-53770-ghostn4444_CVE-2025-53770.md)

## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** 受影响版本：SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition (16.0.0 < Version < 16.0.18526.20508)

**利用条件:** 需要目标SharePoint服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个Microsoft SharePoint Server中的远程代码执行漏洞，原因是未授权的攻击者可以通过网络执行代码，利用了不安全的反序列化。该漏洞CVSS评分为9.8，表明其严重性很高，且已知存在在野利用。

**有效性评估：**
提供的PoC代码有效。首先，利用CVE-2025-53771绕过身份验证（通过操纵Referer头）。其次，利用CVE-2025-53770执行任意代码（通过上传包含恶意序列化数据的.aspx文件）。PoC包含提取MachineKey的代码，然后使用ysoserial.net等工具生成恶意ViewState。

**利用方式：**
1.  **身份验证绕过 (CVE-2025-53771):** 通过向`/layouts/15/ToolPane.aspx`发送POST请求，并设置`Referer: /_layouts/SignOut.aspx`来绕过身份验证。
2.  **上传恶意ASPX文件 (CVE-2025-53770):**  上传包含C#代码的`.aspx`文件，该代码用于读取SharePoint服务器的MachineKey。然后，使用ysoserial.net等工具，利用获取的MachineKey生成恶意的ViewState。
3.  **远程代码执行:**  通过发送包含恶意ViewState的请求，触发反序列化漏洞，执行任意代码。

**投毒风险分析：**
虽然主要目的是展示漏洞，但仍存在一定的投毒风险。PoC中提供了一个提取MachineKey信息的aspx文件。这段代码本身不是恶意代码，但如果攻击者将提取的MachineKey用于其他恶意目的，例如解密或签名数据，则存在潜在的风险。另外，由于使用了base64编码和gzip压缩来隐藏payload，存在隐藏更复杂恶意代码的可能性，因此投毒风险评估为10%。主要因为代码只是为了证明漏洞存在，没有直接植入后门或者恶意行为的代码。

**项目地址:** [ghostn4444/CVE-2025-53770](https://github.com/ghostn4444/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #34

**来源**: [CVE-2025-53770-go-bi_sharepoint-CVE-2025-53770.md](../2025/CVE-2025-53770-go-bi_sharepoint-CVE-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft SharePoint Enterprise Server 2016, Microsoft SharePoint Server 2019, Microsoft SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中一个严重的反序列化漏洞，攻击者可以通过网络发送特制的请求到存在漏洞的SharePoint服务器，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，并且存在公开可用的POC代码，证明其有效性。提供的nuclei模板和python上传脚本可以验证漏洞的存在，并上传恶意webshell。

**投毒风险：**
尽管提供的代码看起来主要是利用漏洞，但仍存在一定的投毒风险（10%）。
*   `README.md`中包含多个外部链接，指向不同的博客和教程，这些链接可能包含恶意内容或引导用户执行恶意操作。虽然这些链接本身不构成投毒，但用户在查阅这些资料时需要保持警惕。
* 上传webshell的脚本，可以被修改为上传更加隐蔽的后门代码, 此类投毒难以检测. 建议在使用POC前进行代码审计，确保其行为符合预期。

**利用方式：**
利用方式主要分为以下几步：
1.  **漏洞检测：** 使用 nuclei 模板检测目标 SharePoint 服务器是否存在 CVE-2025-53770 漏洞。检查`/_layouts/15/ToolPane.aspx` 页面是否存在漏洞。
2.  **构建Payload：** 使用提供的 Python 脚本 (`BuildPayload`) 构建恶意 Payload，该 Payload 包含经过多重编码和压缩的 PowerShell 命令，用于在目标服务器上写入 ASPX Webshell。
    *   第一步将上传的webshell进行base64编码。
    *   第二步将第一步生成的base64编码的webshell，嵌入到powershell代码中，对powershell代码进行base64编码。
    *   第三步将第二步生成的powershell代码, 构造为反序列化payload, 进行gzip压缩和base64编码。
    *   第四步将第三步生成payload, 嵌入到aspx代码中，进行URL编码，得到最终的payload。
3.  **发送请求：** 将构建好的 Payload 嵌入到特制的 HTTP 请求中，发送到目标 SharePoint 服务器的 `ToolPane.aspx` 页面。  `DisplayMode=Edit&a=/ToolPane.aspx`
4.  **代码执行：** 服务器在处理该请求时，会反序列化 Payload 中的数据，导致 PowerShell 命令执行，从而将 Webshell 写入到服务器的指定目录（`C:\PROGRA~1\COMMON~1\MICROS~1\WEBSER~1\16\TEMPLATE\LAYOUTS\spinstall0.aspx`）。
5.  **控制服务器：** 攻击者可以通过访问上传的 Webshell，执行任意命令，从而控制目标 SharePoint 服务器。

**项目地址:** [go-bi/sharepoint-CVE-2025-53770](https://github.com/go-bi/sharepoint-CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #35

**来源**: [CVE-2025-53770-grupooruss_CVE-2025-53770-Checker.md](../2025/CVE-2025-53770-grupooruss_CVE-2025-53770-Checker.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标SharePoint服务器可网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个严重的反序列化漏洞。攻击者可以通过向 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit` 发送特制的 POST 请求，利用恶意的 ViewState 数据触发反序列化，从而在服务器上执行任意代码。漏洞利用的先决条件是目标服务器未安装相应的安全补丁。根据搜索结果，该漏洞已在野外被利用，并且是 “ToolShell” 攻击链的一部分。提供的 POC 代码 `check_sp_cve2025_53770.py` 旨在检测目标 SharePoint 服务器是否存在此漏洞。它首先尝试获取 SharePoint 的构建版本信息（通过 `/_vti_pvt/buildversion.xml` 或 HTTP 头部），然后将其与已知的已修补版本进行比较。如果版本低于已修补版本，则脚本会发送一个测试 POST 请求到 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit`，以检测是否存在反序列化错误。虽然checker本身不是利用代码，但可以用来判断是否存在被利用的可能性。由于该漏洞可以通过发送恶意数据进行利用，所以存在一定投毒风险，例如，攻击者可能修改检测脚本，使其在检测漏洞的同时，植入后门。代码主要为检测，未发现恶意行为，但有网络请求，存在被篡改风险，所以认为存在10%投毒风险。

**利用方式：**

1.  **漏洞检测：** 使用 `check_sp_cve2025_53770.py` 脚本检测目标 SharePoint 服务器是否存在漏洞。
2.  **构建恶意 Payload：** 构造包含恶意代码的 ViewState payload。由于信息有限，具体构造方式需要进一步分析。
3.  **发送请求：** 将构造好的恶意 payload 通过 POST 请求发送到 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit`。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [grupooruss/CVE-2025-53770-Checker](https://github.com/grupooruss/CVE-2025-53770-Checker)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #36

**来源**: [CVE-2025-53770-harryhaxor_CVE-2025-53770-SharePoint-Deserialization-RCE-PoC.md](../2025/CVE-2025-53770-harryhaxor_CVE-2025-53770-SharePoint-Deserialization-RCE-PoC.md)

## CVE-2025-53770-SharePoint-Deserialization-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够通过网络访问SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个Microsoft SharePoint Server中的反序列化漏洞,允许未授权的攻击者通过网络执行远程代码。根据漏洞库信息，该漏洞已被公开利用 (Exploit exists in the wild)，CISA的已知被利用漏洞目录中也包含了此漏洞 (CVE-2025-53770 added to CISA KEV)。搜索引擎结果也表明，该漏洞正在被积极利用 (Active Exploitation)。

**有效性评估：**

根据POC代码，利用方式是通过发送特制的POST请求到 `/_layouts/15/ToolPane.aspx` 页面，该请求包含恶意的序列化数据，这些数据经过base64编码和gzip压缩。服务器在反序列化这些数据时，执行攻击者预先设定的代码，从而实现远程代码执行。

从提供的搜索结果来看，很多安全厂商的博客都提到了该漏洞以及利用方式，因此提供的POC是有效的。

**投毒风险评估：**

POC代码中包含一个经过base64和gzip编码的数据块。解码后的数据包含一些SharePoint相关的标签，比如`Scorecard:ExcelDataSet`，`asp:UpdateProgress`，`ProgressTemplate`，`divWaiting`。这些标签本身是合法的SharePoint组件。

风险点在于`CompressedDataTable`属性的值。这个值同样经过了Base64编码和Gzip压缩，攻击者可能将恶意代码隐藏在这个属性中。

虽然大部分代码都是SharePoint正常代码，不能排除攻击者在`CompressedDataTable` 属性值植入恶意代码的可能性，评估投毒风险为10%。

**利用方式总结：**

1.  攻击者构造一个恶意的序列化对象，该对象利用SharePoint的`ToolPane.aspx`页面进行反序列化。
2.  将序列化对象进行Gzip压缩和Base64编码。
3.  构造一个POST请求，将编码后的数据作为`MSOTlPn_DWP`参数的值发送到`/_layouts/15/ToolPane.aspx`页面。
4.  SharePoint服务器反序列化`MSOTlPn_DWP`参数中的数据，执行攻击者注入的恶意代码。
5.  由于此漏洞为未授权远程代码执行，未经身份验证的攻击者可以通过网络触发漏洞。

**项目地址:** [harryhaxor/CVE-2025-53770-SharePoint-Deserialization-RCE-PoC](https://github.com/harryhaxor/CVE-2025-53770-SharePoint-Deserialization-RCE-PoC)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #37

**来源**: [CVE-2025-53770-hazcod_CVE-2025-53770.md](../2025/CVE-2025-53770-hazcod_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞评估：**

基于提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下评估：

*   **有效性：** 提供的POC代码是有效的。该代码通过向目标SharePoint服务器发送特制的HTTP POST请求，利用反序列化漏洞在服务器上执行代码。POC代码本身设计为无害的，旨在验证漏洞的存在，通过在SharePoint ToolBox widget中注入一个marker来判断目标是否易受攻击。如果服务器响应中找到该marker，则表明目标存在漏洞。

*   **投毒风险：** 该代码仓库的投毒风险极低（0%）。提供的代码主要是用于扫描漏洞是否存在，其核心功能是发送一个包含特定XML Payload的HTTP请求，并在响应中查找特定的marker。虽然实际利用中该Payload可以包含恶意代码，但提供的PoC代码本身只包含无害的marker。

*   **利用方式：**

1.  **漏洞原理：** CVE-2025-53770 是一个由于在本地部署的 Microsoft SharePoint Server 中反序列化不可信数据而导致的远程代码执行漏洞。
2.  **攻击过程：** 攻击者通过向`/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送特制的HTTP POST请求来触发此漏洞。该请求包含一个经过GZIP压缩和BASE64编码的XML payload。 XML payload 中包含一个`System.DelegateSerializationHolder`对象，攻击者可以利用此对象执行任意代码。
3.  **Payload结构：** Payload 包含一个`Scorecard:ExcelDataSet` 标签,该标签利用 `CompressedDataTable` 属性接收经过压缩和编码的数据。
4.  **RCE实现：** 攻击者可以在payload中嵌入恶意代码，例如 PowerShell 命令，从而在 SharePoint 服务器上执行任意代码。

*   **总结：**

CVE-2025-53770 是一个严重的安全漏洞，影响 Microsoft SharePoint Server。攻击者可以利用此漏洞在未经授权的情况下远程执行代码。 建议尽快应用 Microsoft 提供的安全更新。

**项目地址:** [hazcod/CVE-2025-53770](https://github.com/hazcod/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #38

**来源**: [CVE-2025-53770-imbas007_CVE-2025-53770-Vulnerable-Scanner.md](../2025/CVE-2025-53770-imbas007_CVE-2025-53770-Vulnerable-Scanner.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码。

**影响版本:** SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要网络可达，目标SharePoint服务器存在漏洞且未应用补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个反序列化漏洞，允许未经授权的攻击者通过网络执行任意代码。漏洞原理在于SharePoint Server在处理用户提交的恶意构造的序列化数据时，未能进行充分的验证，导致恶意代码被执行。 

**利用方式：**

1.  攻击者需要构造恶意的序列化数据，通常使用ysoserial等工具生成适用于.NET反序列化的Payload。
2.  POC提供的`Vul_Sacnner.py`脚本用于检测目标SharePoint服务器是否存在此漏洞。
3.  此脚本通过发送包含恶意Payload的HTTP POST请求到SharePoint服务器，默认通过Burp Suite代理进行流量分析。
4.  `config.json`文件包含检测规则，比如状态码、返回内容中的特征字符串等，用于判断目标是否受到攻击。
5.  `payload.json`文件包含POST数据，其中`MSOTlPn_Uri`指向一个SharePoint Server的`.ascx`控件，`MSOTlPn_DWP`包含了恶意payload。
6.  如果服务器存在漏洞，恶意Payload将被反序列化并执行，从而导致远程代码执行。

**有效性：**

根据漏洞描述和搜索结果，以及POC代码的逻辑，此POC代码是有效的，因为CVE描述中明确说明了该漏洞的存在性，以及漏洞的类型为反序列化。

**投毒风险：**

代码存在一定的投毒风险，虽然脚本的主要功能是漏洞检测，但`config.json`和`payload.json`的内容完全由使用者控制。因此，使用者可以修改`payload.json`来执行任意代码，如果攻击者将包含恶意代码的`config.json`或`payload.json`分发给他人，可能会导致被攻击者在不知情的情况下执行恶意操作。投毒风险评估为10%，因为利用此脚本进行攻击需要对`payload.json`进行构造，存在一定门槛，且需要修改配置文件，不会直接执行恶意操作。

**项目地址:** [imbas007/CVE-2025-53770-Vulnerable-Scanner](https://github.com/imbas007/CVE-2025-53770-Vulnerable-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #39

**来源**: [CVE-2025-53770-kaizensecurity_CVE-2025-53770.md](../2025/CVE-2025-53770-kaizensecurity_CVE-2025-53770.md)

## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问和目标SharePoint服务器未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于未经验证的数据反序列化而产生。攻击者可以发送特制的请求到 SharePoint 服务器，从而执行任意代码。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞已经被积极利用，并且存在公开的 POC 代码，因此判断提供的POC代码有效。

**投毒风险：**
POC代码包含一个经过编码的 ExcelDataSet (CompressedDataTable)。
分析这个Base64编码并解压缩的数据流，需要对SharePoint的序列化机制有深入的了解。虽然目前无法通过代码直接分析压缩数据中是否包含恶意后门，但payload的整体结构是符合利用CWE-502进行RCE的思路的,因为攻击的本质是利用可控的反序列化数据流来实现RCE。所以初步判断，存在投毒代码的概率较低，但不能完全排除。
投毒风险初步评估为10%， 主要风险在于：
1.  `CompressedDataTable` 内部可能包含恶意代码。

**利用方式：**
1.  攻击者发送包含特制 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数的POST请求到 `/ToolPane.aspx` 页面。
2.  `MSOTlPn_Uri` 参数指向一个恶意的ASCX控件。
3.  `MSOTlPn_DWP` 参数包含经过压缩和Base64编码的序列化数据。
4.  SharePoint服务器在处理该请求时，会反序列化`CompressedDataTable`，如果其中包含恶意代码，则会导致远程代码执行。

利用的关键在于构造恶意的序列化数据，使其在反序列化过程中执行攻击者预期的代码。

**项目地址:** [kaizensecurity/CVE-2025-53770](https://github.com/kaizensecurity/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #40

**来源**: [CVE-2025-53770-m4r1x_CVE-2025-53770-Scanner.md](../2025/CVE-2025-53770-m4r1x_CVE-2025-53770-Scanner.md)

## CVE-2025-53770-SharePoint-反序列化RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化RCE

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标SharePoint服务器可访问，利用代码需根据具体反序列化链构造。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，源于对不可信数据的反序列化。根据漏洞信息，该漏洞已被在野利用，并且CISA已将其添加到已知被利用的漏洞目录中。该漏洞影响 SharePoint Server 2016, SharePoint Server 2019 和 SharePoint Server Subscription Edition（版本低于 16.0.18526.20508）。

**有效性分析：**
提供的PoC代码是一个扫描器，主要用于检测目标SharePoint实例是否存在CVE-2025-53770漏洞，通过发送特制的HTTP请求并分析响应来判断。虽然该代码本身不是完整的利用代码，但它可以帮助安全专业人员识别潜在的漏洞暴露面，为后续的漏洞利用提供依据。根据搜索结果，该漏洞已被积极利用，因此，如果扫描器能准确识别漏洞，则可以认为PoC具有一定的有效性。但是，需要注意的是，仅仅识别漏洞存在是不够的，还需要进一步利用才能实现远程代码执行。

**投毒风险分析：**
检查提供的代码，尤其是 `spScanner.py`，发现其导入了一些库，如 `requests`, `urllib3`, `subprocess` 等。`requirements.txt` 文件列出了 `rich`, `requests`, `sublist3r`。  虽然 `requests` 是常用的 HTTP 客户端库，但 `sublist3r` 主要用于子域名枚举。  虽然这些库本身没有明显的恶意行为，但如果 `spScanner.py` 中存在以下情况，则存在投毒的可能：

1.  **恶意代码注入：**  在扫描器逻辑中，如果代码会执行外部命令（例如，通过 `subprocess` 模块），且命令的参数受到用户输入的影响，则可能存在命令注入漏洞。攻击者可以利用此漏洞执行任意命令。
2.  **数据回传：**  扫描器可能会收集目标 SharePoint 实例的信息，如果未经授权将这些信息发送到外部服务器，则可能存在隐私泄露风险。
3.  **依赖项劫持：** 虽然提供的依赖项看起来没问题，但如果仓库所有者在其他地方提供恶意依赖项（例如，通过 PyPI），诱导用户安装，则存在供应链攻击的风险。

基于以上分析，虽然目前提供的代码段没有发现明显的投毒行为，但仍需仔细审查 `spScanner.py` 的全部逻辑，特别是与网络请求、命令执行和数据处理相关的部分。 同时需要警惕仓库维护者在其他地方（如PyPI）是否存在恶意行为。考虑到漏洞扫描器可能收集敏感信息并存在潜在的命令执行风险，因此判断投毒风险为 30%。

**利用方式分析：**
根据漏洞库信息和搜索结果，CVE-2025-53770是由于SharePoint Server在处理不可信数据反序列化时存在缺陷导致的远程代码执行漏洞。攻击者可以通过构造恶意的序列化数据，诱使SharePoint Server进行反序列化操作，从而在服务器上执行任意代码。具体的利用方式可能涉及以下步骤：

1.  **识别漏洞入口点：** 找到SharePoint Server中处理序列化数据的接口或组件。
2.  **构造恶意序列化数据：** 使用特定的序列化格式（例如，.NET BinaryFormatter）构造包含恶意代码的序列化数据。该恶意代码可以执行任意系统命令，例如，下载并执行恶意程序。
3.  **发送恶意请求：** 将构造的恶意序列化数据作为请求的一部分发送到SharePoint Server的漏洞入口点。
4.  **触发反序列化：** 触发SharePoint Server对接收到的序列化数据进行反序列化操作。
5.  **执行恶意代码：** 反序列化过程会导致恶意代码在服务器上执行，从而实现远程代码执行。

由于该漏洞是反序列化漏洞，因此可能需要深入了解SharePoint Server的内部结构和使用的序列化机制，才能成功构造出可利用的payload。

**项目地址:** [m4r1x/CVE-2025-53770-Scanner](https://github.com/m4r1x/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #41

**来源**: [CVE-2025-53770-n1chr0x_ZeroPoint.md](../2025/CVE-2025-53770-n1chr0x_ZeroPoint.md)

## CVE-2025-53770-Microsoft SharePoint Server-远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** SharePoint Server 2016、SharePoint Server 2019、SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要网络访问到存在漏洞的SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。根据漏洞信息和搜索结果，该漏洞已被积极利用，且CISA已将其添加到已知被利用漏洞目录中。利用方式是通过发送特制的序列化数据到SharePoint服务器，服务器在反序列化该数据时执行攻击者预设的恶意代码，从而控制服务器。由于提供的漏洞利用代码仅包含GNU GENERAL PUBLIC LICENSE，并未发现实际的利用代码，因此无法判断该POC的有效性。但是可以确定的是公开信息表明该漏洞的EXP已经存在。提供的代码仅为GPL协议内容，没有发现作者隐藏的投毒代码。 因此，投毒风险为0%。

**项目地址:** [n1chr0x/ZeroPoint](https://github.com/n1chr0x/ZeroPoint)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #42

**来源**: [CVE-2025-53770-paolokappa_SharePointSecurityMonitor.md](../2025/CVE-2025-53770-paolokappa_SharePointSecurityMonitor.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问，目标系统安装存在漏洞的SharePoint Server版本

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 远程代码执行漏洞，由于服务器在处理非受信数据时存在反序列化漏洞，攻击者可以通过网络发送特制的请求来执行任意代码。漏洞利用代码 `Install-SharePointSecurityMonitor.ps1` 看上去是一个安全监控工具的安装脚本，但实际上可能包含恶意代码。安装脚本首先会清理已存在的计划任务，然后创建目录结构，接着从其他位置下载或拷贝脚本文件，这表明了潜在的投毒风险，下载或复制过程中可能引入恶意的文件。尽管该脚本声称提供 CVE-2025-53770 的保护，但它本身可能被利用来植入后门或执行其他恶意操作。 从搜索引擎结果来看，该漏洞已经被广泛利用，属于在野0day漏洞，风险极高。

**项目地址:** [paolokappa/SharePointSecurityMonitor](https://github.com/paolokappa/SharePointSecurityMonitor)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #43

**来源**: [CVE-2025-53770-r3xbugbounty_CVE-2025-53770.md](../2025/CVE-2025-53770-r3xbugbounty_CVE-2025-53770.md)

## CVE-2025-53770-SharePoint-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行，完全控制受影响的SharePoint服务器

**影响版本:** SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要能够访问SharePoint服务器，可能需要一定的权限才能触发漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个存在于Microsoft SharePoint Server的远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。未经授权的攻击者可以通过网络利用此漏洞在受影响的服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，CVE-2025-53770是一个已经被积极利用的漏洞，具有高危风险。提供的PoC代码尝试利用此漏洞。该PoC代码的工作方式是：首先从target.txt文件中读取目标SharePoint服务器的URL列表。然后，对于每个URL，它构造一个特殊的POST请求，发送到`/_layouts/15/ToolPane.aspx`端点，并在POST数据中包含精心构造的`MSOTlPn_DWP`参数。这个参数包含一个序列化的对象，其中包含一个恶意`Scorecard:ExcelDataSet`标记，该标记包含压缩和base64编码的数据，一旦反序列化，就可以执行任意代码。PoC代码会尝试解码和解压缩响应，然后搜索特定的字符串，如果找到，则表明服务器存在漏洞。

**投毒风险分析：**
该PoC代码的投毒风险较低，约为10%。 代码的主要功能是利用漏洞，没有明显的恶意行为，例如删除文件、传播恶意软件等。 但仍然存在细微的投毒风险， 例如：作者可以将解码后的内容保存到`/tmp`目录，这是一个公共目录，可能会造成一些信息泄露或者被其他恶意程序利用。

**利用方式：**
1.  **目标识别：** 首先需要识别存在漏洞的SharePoint服务器，可以通过版本信息或者漏洞扫描工具来完成。
2.  **构造Payload：** 攻击者需要构造一个恶意的序列化对象，该对象在反序列化时可以执行任意代码。这通常涉及到使用`Scorecard:ExcelDataSet`等SharePoint组件，并嵌入压缩和base64编码的恶意数据。
3.  **发送请求：** 将构造好的Payload通过POST请求发送到目标SharePoint服务器的`/_layouts/15/ToolPane.aspx`端点。Referer设置为目标站点的SignOut.aspx页面。
4.  **代码执行：** 如果服务器存在漏洞，并且Payload构造正确，服务器在处理请求时会对Payload进行反序列化，从而执行攻击者预先设定的恶意代码。
5.  **结果验证:** PoC通过正则匹配返回包中的特定字符串来判断漏洞是否存在，实际利用中，回显可能被屏蔽，需要使用其他方式验证。

**缓解措施：**
*   应用Microsoft提供的安全更新。
*   实施缓解措施，例如禁用不安全的反序列化功能，或者限制对`/_layouts/15/ToolPane.aspx`端点的访问。

**项目地址:** [r3xbugbounty/CVE-2025-53770](https://github.com/r3xbugbounty/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #44

**来源**: [CVE-2025-53770-saladin0x1_CVE-2025-53770.md](../2025/CVE-2025-53770-saladin0x1_CVE-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以通过网络执行任意代码。

**影响版本:** 受影响版本包括 SharePoint Server 2016, SharePoint Server 2019, 和 SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标 SharePoint 服务器需要暴露在网络中，且未安装相应的安全更新或缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一种 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。该漏洞允许未经授权的攻击者通过网络执行代码。根据漏洞库信息，该漏洞已被公开利用 (Exploit Exists)。

**利用方式：**

1.  **身份验证绕过:** 攻击者首先绕过身份验证机制，访问受保护的 ToolPane.aspx 页面（CVE-2025-49706 及其补丁绕过 CVE-2025-53771）。
2.  **不安全的反序列化:** 成功绕过身份验证后，攻击者利用不安全的反序列化漏洞 (CVE-2025-49704 和 CVE-2025-53770 的补丁绕过)，将恶意序列化对象发送到 SharePoint 服务器。
3.  **远程代码执行:** SharePoint 服务器在反序列化恶意对象时，会执行其中包含的任意代码，从而导致远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含以下组件：

*   `scanner/scanner.py`: 用于扫描易受攻击的 SharePoint 安装。
*   `exploit/exploit.py`: 主要的 Python RCE 利用脚本，用于发送恶意负载。
*   `metasploit_ref/cURL`: 包含 cURL 命令示例，用于测试利用。
*   `analysis/analyse.py`: 用于解码和分析利用响应的工具。

POC 代码利用了身份验证绕过和不安全的反序列化漏洞链，实现未经身份验证的远程代码执行。

**投毒风险分析：**

尽管 POC 代码提供了漏洞利用的功能，但它也可能包含潜在的投毒代码。风险评估基于以下几点：

*   **代码复杂性:** 代码逻辑相对清晰，易于理解。但是仍然需要审查依赖项和外部资源，以排除恶意代码的可能性。
*   **权限要求:** 利用需要对目标系统执行代码，这意味着任何隐藏的恶意代码也可能以相同的权限运行。文件读写操作，网络行为和系统调用需要仔细审查。
*   **代码来源:** 代码的作者身份未知，增加了潜在风险。建议从可信来源获取 POC 代码，并进行彻底审查。

综上所述，POC 代码存在一定的投毒风险，评估为 **10%**。虽然代码结构看似正常，但仍然需要仔细检查，以确保其中不包含任何隐藏的恶意代码。建议在隔离环境中运行 POC 代码，并使用安全工具进行分析。

**项目地址:** [saladin0x1/CVE-2025-53770](https://github.com/saladin0x1/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #45

**来源**: [CVE-2025-53770-soltanali0_CVE-2025-53770-Exploit.md](../2025/CVE-2025-53770-soltanali0_CVE-2025-53770-Exploit.md)

## CVE-2025-53770-Microsoft SharePoint Server-远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要身份验证的用户访问SharePoint服务器，并能够发送POST请求到/ToolPane.aspx

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过向 `/layouts/15/ToolPane.aspx` 发送包含恶意序列化 .NET 对象的特制 POST 请求来利用此漏洞。PoC 代码通过构造一个包含 `Scorecard:ExcelDataSet` WebPart 的恶意 XML 负载来实现。`CompressedDataTable` 属性包含一个 GZIP 压缩的序列化 .NET DataSet 对象，该对象利用 gadget chain（例如 `LosFormatter` 和 `ObjectDataProvider`）来执行任意代码。由于PoC 代码主要利用已知的反序列化技术和 gadget chain，因此投毒风险较低，主要风险在于部署环境的配置错误和疏忽。PoC 中 C2 地址参数的设置可能存在风险，但整体上，PoC 的恶意程度较低。投毒风险评估为 5%。漏洞利用步骤如下：

1.  攻击者需要具有经过身份验证的用户权限。
2.  攻击者构造一个包含恶意 `Scorecard:ExcelDataSet` WebPart 的 XML 负载，其中 `CompressedDataTable` 属性包含恶意的序列化 .NET 对象。
3.  攻击者将此负载通过 POST 请求发送到 `/layouts/15/ToolPane.aspx?DisplayMode=Edit`。
4.  SharePoint Server 反序列化该对象，导致执行攻击者指定的任意代码。

**项目地址:** [soltanali0/CVE-2025-53770-Exploit](https://github.com/soltanali0/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #46

**来源**: [CVE-2025-53770-taqiaferdianshah_CVE-2025-53770.md](../2025/CVE-2025-53770-taqiaferdianshah_CVE-2025-53770.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，可导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 需要未经授权的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个Microsoft SharePoint Server中的反序列化漏洞，允许未经授权的攻击者通过网络执行任意代码。漏洞存在于`ToolPane.aspx`页面，利用方式是发送包含恶意序列化数据的POST请求。搜索引擎结果表明该漏洞已被积极利用。 

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已经被公开披露且存在野外利用，POC代码的出现进一步证实了其有效性。

**投毒风险：**

提供的漏洞利用代码包含两个文件：

*   `README.md`：这是一个说明文件，指导用户下载和使用POC代码。该文件本身不包含任何恶意代码。
*   `payload`：这是一个POST请求的内容，包含了利用漏洞的序列化数据。其中 `CompressedDataTable` 似乎是一个经过压缩的数据表，很可能包含恶意代码。分析后认为文件本身不包含明显的投毒代码，而是利用漏洞本身执行恶意操作。但仍需谨慎，不排除作者通过复杂方式隐藏恶意行为的可能性，因此存在较低的投毒风险。
根据仓库提供的下载链接地址可以确定是`Github`提供的下载地址。恶意投毒的可能性较低。

**利用方式：**

1.  攻击者构造一个包含恶意序列化数据的POST请求，目标是`/_layouts/15/ToolPane.aspx`页面。
2.  POST请求的`MSOTlPn_DWP`参数包含一个经过编码的ASP.NET WebPart定义，其中包括`ExcelDataSet`控件，该控件的`CompressedDataTable`属性包含了压缩的序列化数据。
3.  SharePoint Server在处理该请求时，会反序列化`CompressedDataTable`中的数据，如果数据中包含恶意代码，就会导致远程代码执行。
4.  攻击者可以通过修改`CompressedDataTable`中的内容来执行任意命令。

总的来说，该漏洞的利用方式是通过构造恶意的序列化数据，诱使SharePoint Server进行反序列化，从而执行攻击者预先设定的代码。

**项目地址:** [taqiaferdianshah/CVE-2025-53770](https://github.com/taqiaferdianshah/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #47

**来源**: [CVE-2025-53770-tripoloski1337_CVE-2025-53770-scanner.md](../2025/CVE-2025-53770-tripoloski1337_CVE-2025-53770-scanner.md)

## CVE-2025-53770-Microsoft SharePoint Server-远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标 SharePoint Server 可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过发送特制的 HTTP 请求利用此漏洞在服务器上执行任意代码。根据漏洞描述，该漏洞已经被公开利用（“exists in the wild”），并已被添加到 CISA KEV 列表，表明其威胁程度较高。

**有效性：**
根据提供的漏洞信息和搜索结果，该漏洞已被确认存在且正在被积极利用。提供的Python扫描器脚本的功能是检查目标URL是否存在漏洞利用的前提条件， 即检查`/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx`路径是否返回状态码200。它本身并不是一个完整的漏洞利用程序，但是验证目标是否存在该页面为后续的漏洞利用做准备。

**投毒风险：**
提供的脚本中存在微小的投毒风险 (10%)。虽然脚本的主要功能是扫描，并没有直接执行恶意代码， 但是`c2_url`和`dwp_payload`变量为空，这意味着需要用户手动填写，如果用户从不可信来源获取了恶意载荷，则可能被利用。同时，脚本会读取targets.txt文件，如果该文件被篡改，则可能导致扫描恶意URL。

**利用方式：**
根据漏洞描述和搜索结果，利用方式如下：
1.  攻击者构造包含恶意序列化数据的 HTTP 请求。
2.  将此请求发送到存在漏洞的 SharePoint Server。
3.  SharePoint Server 反序列化恶意数据，导致任意代码执行。

提供的扫描器脚本旨在检测目标 SharePoint Server 是否存在漏洞利用的先决条件。完整的漏洞利用可能需要结合其他工具和技术来生成和发送恶意序列化数据。

**项目地址:** [tripoloski1337/CVE-2025-53770-scanner](https://github.com/tripoloski1337/CVE-2025-53770-scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #48

**来源**: [CVE-2025-53770-unk9vvn_sharepoint-toolpane.md](../2025/CVE-2025-53770-unk9vvn_sharepoint-toolpane.md)

## CVE-2025-53770-Microsoft SharePoint Server-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码。

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (16.0.0 <= 版本 < 16.0.18526.20508)

**利用条件:** 需要网络访问，目标为存在漏洞的SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-53770是Microsoft SharePoint Server中的一个远程代码执行漏洞。该漏洞是由于对不可信数据的反序列化造成的。未经身份验证的攻击者可以利用此漏洞通过网络在目标系统上执行任意代码。

**有效性：** 根据漏洞描述和搜索结果，此漏洞已在野外被积极利用，利用代码的存在也进一步证明了其有效性。

**投毒风险：** 提供的代码段是Apache License 2.0的许可协议，不包含任何可执行代码，因此不存在投毒风险。投毒风险为0%。

**利用方式：**
1.  **确定目标：**  寻找运行受影响版本SharePoint Server的服务器。
2.  **构造恶意序列化数据：**  攻击者需要构造恶意的序列化数据，该数据在反序列化时会执行攻击者指定的代码。 这通常涉及使用.NET gadget chains。
3.  **发送恶意请求：**  将构造的恶意序列化数据通过SharePoint Server的某个入口点（通常是HTTP请求）发送到目标服务器。
4.  **远程代码执行：**  SharePoint Server反序列化数据，导致攻击者指定的代码在服务器上执行，从而实现远程代码执行。

**项目地址:** [unk9vvn/sharepoint-toolpane](https://github.com/unk9vvn/sharepoint-toolpane)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #49

**来源**: [CVE-2025-53770-victormbogu1_LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320.md](../2025/CVE-2025-53770-victormbogu1_LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016、SharePoint Server 2019、SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要目标系统运行受影响版本的SharePoint Server，且攻击者能够发送特制的POST请求到`/\_layouts/15/ToolPane.aspx`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个反序列化远程代码执行漏洞。攻击者可以利用此漏洞，通过向 `/\_layouts/15/ToolPane.aspx` 发送特制的 POST 请求，在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息，微软已经意识到此漏洞正在被利用。搜索引擎结果也证实了这一点，多个安全厂商和CISA都发布了关于此漏洞的分析报告和警告。提供的漏洞利用代码（LetsDefend SOC342案例）展示了攻击者如何利用此漏洞，通过发送包含恶意序列化数据的POST请求，绕过身份验证，执行 PowerShell 命令，窃取密钥，并部署WebShell，从而完全控制 SharePoint 服务器。综合来看，提供的POC代码有效。

**投毒风险分析：**
提供的漏洞利用代码来自LetsDefend的实验环境，主要目的是为了安全分析和学习。其中存在少量的投毒风险,主要来自于WebShell(spinstall0.aspx)可能被用于持续控制系统，并执行其他恶意操作。风险占比估计为10%。

**漏洞利用方式：**
1.  攻击者构造恶意的POST请求，目标地址为 `/\_layouts/15/ToolPane.aspx`，该请求包含精心设计的序列化数据。
2.  SharePoint Server 在处理该请求时，由于反序列化漏洞，导致攻击者可以执行任意代码。
3.  攻击者利用执行代码的能力，首先执行PowerShell命令，窃取MachineKeySection密钥。
4.  攻击者使用窃取的密钥编译payload.exe，该payload可能包含恶意代码。
5.  攻击者部署一个WebShell (spinstall0.aspx)，以便后续的控制和利用。

**项目地址:** [victormbogu1/LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320](https://github.com/victormbogu1/LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #50

**来源**: [CVE-2025-53770-yashz0007_CVE-2025-53770-Exploit.md](../2025/CVE-2025-53770-yashz0007_CVE-2025-53770-Exploit.md)

## CVE-2025-53770-SharePoint远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 目标系统存在漏洞版本的SharePoint服务且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中存在的反序列化漏洞。未经授权的攻击者可以利用此漏洞通过网络执行远程代码。漏洞的利用方式是攻击者发送特制的序列化数据到存在漏洞的 SharePoint 服务器，服务器在反序列化该数据时执行攻击者注入的恶意代码。

**有效性评估：**

*   漏洞库信息显示，CVE-2025-53770 已经被公开利用（"exploit for CVE-2025-53770 exists in the wild."）。
*   搜索引擎结果也表明该漏洞已被积极利用（"Active Exploitation of Microsoft SharePoint Vulnerabilities"）。
*   提供的漏洞利用代码（`exploit.py`）的描述是“Ultimate SharePoint Exploit Tool Combines Detection + Version Check + WebPart Injection (CVE-2025-53770)”，表明该代码旨在利用此漏洞进行WebPart注入。
*   综合以上信息，可以判断提供的POC代码有效。

**投毒风险分析：**

*   `README.md` 文件只是一个简单的使用说明文档，主要介绍如何下载、安装和使用该工具，没有发现任何可疑代码。
*   `compress.py` 文件用于压缩和编码有效载荷（payload）。该脚本首先读取 `base64.txt` 文件，对其进行 Base64 解码，然后使用 gzip 压缩，最后再次进行 Base64 编码，并将结果写入 `payload-final.txt` 文件。虽然该脚本本身没有明显的恶意代码，但它处理的数据来源 `base64.txt` 存在潜在风险。攻击者可能会在 `base64.txt` 中嵌入恶意代码，从而在压缩和编码后隐藏其真实目的。
*   `exploit.py` 文件是漏洞利用的主脚本。粗略浏览来看，代码结构相对清晰，主要功能是检测 SharePoint 版本，然后尝试进行 WebPart 注入。代码可能包含隐藏的后门或者恶意行为，因为该代码结合了检测、版本检查和 WebPart 注入等多个功能，且代码中存在从外部文件读取数据的情况，如果外部文件被篡改，可能会导致恶意行为。因此，投毒的风险存在，但需要进一步详细分析代码逻辑才能确定。
*   综合考虑，`base64.txt` 文件和 `exploit.py` 脚本是主要的潜在投毒点。

**利用方式分析：**

该漏洞利用方式涉及以下步骤：

1.  **目标确认：** 攻击者需要确定目标 SharePoint 服务器是否存在漏洞（版本在受影响范围内）。
2.  **有效载荷准备：** 攻击者需要准备恶意的序列化数据，该数据在反序列化时可以执行任意代码。
3.  **WebPart注入：**  利用 SharePoint 的 WebPart 功能，将包含恶意序列化数据的 WebPart 注入到 SharePoint 页面中。
4.  **触发反序列化：** 当用户访问包含恶意 WebPart 的页面时，SharePoint 服务器会尝试反序列化 WebPart 中的数据，从而触发远程代码执行。

**项目地址:** [yashz0007/CVE-2025-53770-Exploit](https://github.com/yashz0007/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #51

**来源**: [CVE-2025-53770-zach115th_ToolShellFinder.md](../2025/CVE-2025-53770-zach115th_ToolShellFinder.md)

## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** Microsoft SharePoint Enterprise Server 2016, Microsoft SharePoint Server 2019, Microsoft SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要目标SharePoint服务器可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2025-53770 是一个 Microsoft SharePoint Server 中存在的远程代码执行漏洞，源于对不可信数据的反序列化。 

**有效性评估：**
根据搜索引擎结果[webpage 2, 7, 9]，此漏洞已被积极利用，并且存在公开可用的PoC。提供的漏洞利用代码 (toolshellfinder.ps1) 实际上是一个检测脚本，用于在 IIS 日志中查找与 CVE-2025-53770 和 CVE-2025-53771 相关的攻击痕迹。 它通过搜索特定的 HTTP 方法、URI、查询字符串、User-Agent 和 Referer 字段来识别潜在的攻击尝试。 虽然它本身不是一个利用程序，但它表明了该漏洞的可利用性以及攻击者可能使用的攻击模式。

**投毒风险分析：**
提供的 PowerShell 脚本 `toolshellfinder.ps1` 的主要功能是分析 IIS 日志，查找攻击的 IoC。 它不包含任何明显的恶意代码来执行远程代码或修改系统。 投毒风险较低，估计为 10%。 这种风险主要来自于以下几个方面：

*   **依赖的输入数据（IIS 日志）：** 脚本的正确性依赖于 IIS 日志的完整性和准确性。 如果日志被篡改或包含恶意数据，可能会导致脚本误报或漏报。 
*   **PowerShell 执行策略：** 在某些配置下，PowerShell 的执行策略可能会允许执行未经签名的脚本。 如果攻击者能够修改脚本或替换它，可能会引入恶意代码。
*   **潜在的供应链风险：** 尽管当前代码看起来是安全的，但如果该脚本是从一个不可信的来源下载，或者脚本作者本身被攻击，则存在一定的供应链风险。虽然readme文件看起来正常,但作者也可能在其他地方投毒。

**漏洞利用方式分析：**
1.  **反序列化漏洞：** 漏洞的核心是由于 SharePoint Server 在处理反序列化数据时存在缺陷，导致攻击者可以构造恶意序列化数据，当服务器反序列化这些数据时，即可执行攻击者预先设定的代码。 
2.  **攻击入口点：** 根据搜索结果和检测脚本中的 IoC，攻击者可能利用 `/_layouts/15/ToolPane.aspx` 或 `/_layouts/16/ToolPane.aspx` 等页面，通过构造包含恶意序列化数据的 POST 请求来触发漏洞。`success.aspx`也可能作为利用的端点。
3.  **IIS 日志痕迹：** 成功或失败的攻击尝试都会在 IIS 日志中留下痕迹。 通过分析 IIS 日志，可以检测到以下 IoC：
    *   包含特定查询字符串（例如 `DisplayMode=Edit&a=/ToolPane.aspx`）的 `ToolPane.aspx` 请求。
    *   Referer 为 `/_layouts/SignOut.aspx` 的可疑文件下载请求。
    *   User-Agent 中包含 `curl`、`powershell` 或 `python` 关键字的 `start.aspx` 或 `success.aspx` 请求。
    *   `success.aspx`页面，并且查询字符串以长`__VIEWSTATE=`值开头

总结：该漏洞利用涉及发送特制的恶意序列化数据到SharePoint服务器，从而允许远程代码执行。提供的PoC代码是一个检测工具，用于在IIS日志中查找利用该漏洞的攻击尝试。虽然PoC代码本身不包含后门，但需要注意潜在的供应链风险。

**项目地址:** [zach115th/ToolShellFinder](https://github.com/zach115th/ToolShellFinder)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

## POC #52

**来源**: [CVE-2025-53770-ziisenpai_CVE-2025-53770-Scanner.md](../2025/CVE-2025-53770-ziisenpai_CVE-2025-53770-Scanner.md)

## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问目标SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-53770 是一个Microsoft SharePoint Server的远程代码执行漏洞，由于服务器端未对用户提交的序列化数据进行安全验证，攻击者可以通过发送特制的序列化数据来执行任意代码。

**有效性:**
根据漏洞库信息和搜索结果，CVE-2025-53770漏洞已被积极利用，因此该漏洞是有效的。

**投毒风险分析:**
提供的漏洞利用代码（spScanner.py 和 README.md 等）是一个SharePoint漏洞扫描器，用于检测目标SharePoint是否存在CVE-2025-53770漏洞。 虽然代码本身似乎是一个扫描器，但仍然存在一定的投毒风险:

*   **依赖项风险:** requirements.txt 中声明了`requests` 和 `sublist3r` 和 `rich`依赖。`requests` 本身被投毒的可能性较低，但如果扫描器包含从远程位置下载或执行其他脚本的功能，或者扫描器利用了`sublist3r`自身存在的潜在漏洞，则可能引入恶意代码。 *   **后门植入:** 攻击者可能在扫描器中插入恶意代码，例如反向shell或数据收集器。 虽然现在提供的代码比较简单，无法验证，但存在这种可能性。 *   **诱导用户执行恶意操作:** 攻击者可以诱导用户使用恶意参数运行扫描器，从而执行有害操作。

综合考虑，该扫描器存在一定的投毒风险，大约为30%。建议在使用前仔细审查代码，并确保从可信来源下载。

**利用方式:**
1.  攻击者通过网络向存在漏洞的SharePoint服务器发送包含恶意序列化数据的请求。
2.  SharePoint服务器反序列化该数据，由于数据中包含恶意代码，导致服务器执行该代码。
3.  攻击者从而获得服务器的控制权，实现远程代码执行。

**项目地址:** [ziisenpai/CVE-2025-53770-Scanner](https://github.com/ziisenpai/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)

---

