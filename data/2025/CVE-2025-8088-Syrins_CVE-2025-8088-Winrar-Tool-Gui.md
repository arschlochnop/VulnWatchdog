## CVE-2025-8088 - WinRAR 路径遍历 / 任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意文件写入

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (估算)

**影响版本:** WinRAR <= 7.12 (含7.12及其以下版本)

**利用条件:** 用户下载并使用受影响版本的WinRAR解压恶意构造的RAR文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用工具

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

POC有效性分析：本漏洞（CVE-2025-8088）是WinRAR中的一个高危目录遍历缺陷，实质上是利用了Windows NTFS文件系统的备用数据流（ADS）特性以及WinRAR在处理特定路径字符串时的逻辑漏洞。通过该POC代码可以确认，攻击者能够构造具有特殊路径结构的RAR文件。当用户解压该文件时，WinRAR未能正确校验提取路径，导致文件可以跨越目标目录被写入到系统敏感位置，如Windows启动项（Startup）目录或驱动程序目录。该POC不仅提供了自动化的利用生成脚本，还集成了图形用户界面（GUI），极大地降低了利用门槛。其有效性在于它能绕过传统杀毒软件对普通压缩包的检测，因为恶意Payload被隐藏在非标准的路径结构和ADS流中。通过实验验证，该漏洞可在无交互（除解压动作外）的情况下实现持久化控制，是一种极具威胁的在野攻击手段。利用步骤：首先，攻击者使用提供的GUI工具配置Payload（如一个恶意的.exe可执行文件）。其次，工具通过ADS技术和路径遍历前缀（如'../'序列）将Payload伪装在普通文件或诱饵文件中。然后，生成特制的RAR压缩包。最后，通过钓鱼邮件、虚假软件更新等社交工程手段分发给目标用户。一旦用户解压，恶意文件即被静默写入启动目录。投毒风险分析：该POC项目展现出中等程度的投毒风险。虽然该工具的主要声明是用于教育和防御性研究，但在代码实现上引入了复杂的混淆手段，包括AES加密和XOR编码来保护Payload。这种程度的代码保护在正常的开源安全工具中并不常见，可能被恶意攻击者用作‘黑吃黑’的手段，即在生成器内部隐藏针对研究员自身的后门。此外，该工具对环境依赖较高（需安装WinRAR），并包含了自动寻找系统路径的功能。由于其代码逻辑包含对外部库（pycryptodome）的调用且存在高度封装的二进制构造过程，防御者在使用此POC进行漏洞复现时，必须在完全隔离的沙箱环境中运行，以防其生成的压缩包或工具本身携带未经披露的恶意行为。其宣称的‘绕过杀软检测’功能也使得该工具极易被武器化用于实际的投毒攻击。

**项目地址:** [https://github.com/syrins/CVE-2025-8088-Winrar-Tool.git](https://github.com/syrins/CVE-2025-8088-Winrar-Tool.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
