## CVE-2025-68613 - n8n (工作流自动化平台) RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n (工作流自动化平台)

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.9

**影响版本:** 0.211.0 <= n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要用户认证，默认配置，通过工作流表达式评估系统触发

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】CVE-2025-68613 是存在于 n8n 工作流表达式评估系统中的沙箱逃逸漏洞。根据提供的搜索结果和代码片段，该漏洞允许具有认证权限的用户通过精心构造的表达式绕过沙箱限制，进而在底层系统执行任意代码。虽然漏洞需要认证，但考虑到 n8n 通常被用于处理敏感的自动化任务，攻击者若能接管一个普通账户，即可利用此漏洞实现权限提升至底层操作系统。提供的 POC 代码库包含一个 Docker 环境（使用 1.121.0 版本，属于受影响范围）以及详细的检测指南。该 POC 虽然没有直接给出最终的 RCE Payload，但提供了完整的漏洞环境搭建脚本和检测建议，能够有效地帮助安全研究员复现和分析漏洞触发路径。其提供的检测指南中提到了由于 n8n 本身日志系统的限制，需要通过 Nginx 代理记录请求体来捕获利用行为，这进一步证明了漏洞在默认日志级别下的隐蔽性。【利用步骤】1. 环境搭建：使用 POC 中的 Dockerfile 和 docker-compose.yml 部署受影响版本的 n8n 实例（如 v1.121.0）。2. 用户登录：访问 http://localhost:5678 并以认证用户的身份登录。3. 构造 Payload：在工作流的节点中使用包含沙箱逃逸代码的表达式（例如利用 Node.js 环境下的对象原形链或内置模块逃逸）。4. 触发执行：运行该工作流，当系统评估表达式时，代码将在主机环境执行。5. 验证结果：观察是否能执行系统命令，如反弹 shell 或写入文件。【投毒风险分析】针对该漏洞的 POC 项目（[https://github.com/Dlanang/homelab-CVE-2025-68613.git](https://github.com/Dlanang/homelab-CVE-2025-68613.git)）目前表现为低风险。经过对提供代码的审查，Dockerfile 仅从官方镜像仓库拉取特定版本的 n8n，未发现添加恶意的外部脚本或修改入口文件（Entrypoint）。USAGE.md 文档描述的是标准 Docker Compose 操作流程，没有诱导用户执行不安全的二进制文件或复杂的混淆脚本。虽然 detection.md 部分涉及 Lua 脚本和 Nginx 配置，但这属于防御性检测建议，代码逻辑清晰且与防御目的相符。投毒风险较低，但作为防御性研究员仍需警惕：1. 仓库中可能后续更新包含恶意混淆 payload 的示例。2. 攻击者可能通过提供看似合法的“预配置数据库镜像”或修改后的 n8n 镜像来实现持久化后门。3. 目前代码库虽然清晰，但依赖的第三方容器环境需要进一步校验指纹。总体而言，该项目更像是一个合法的漏洞研究实验室，投毒风险评定为 5%。

**项目地址:** [https://github.com/Dlanang/homelab-CVE-2025-68613.git](https://github.com/Dlanang/homelab-CVE-2025-68613.git)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-68613](https://avd.aliyun.com/detail?id=AVD-2025-68613)
