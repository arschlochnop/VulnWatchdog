## CVE-2025-68613 - n8n RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n

**危害等级:** CRITICAL

**CVSS评分:** 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要用户认证（拥有创建或修改工作流权限），默认配置下即可触发。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/环境搭建

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：提供的POC项目（homelab-CVE-2025-68613）本质上是一个漏洞环境复现脚本。其Dockerfile指定了受影响的镜像版本（n8nio/n8n:1.121.0），并提供了详细的检测指南。虽然项目本身不包含自动化的Exploit脚本，但其detection.md明确指出漏洞根源在于表达式注入（Expression Injection）。在n8n中，该漏洞源于JavaScript沙箱逃逸。攻击者利用n8n工作流节点中对JS表达式处理不当的缺陷，通过构造特殊的Payload逃逸Vm2或内置沙箱，从而在底层宿主机执行任意系统命令。由于n8n通常以容器化或Node.js进程运行，此类逃逸意味着获取了完整的容器权限。该POC对于研究漏洞触发路径和搭建复现环境非常有效，但对于非技术人员而言，缺乏一键利用工具。利用步骤：1. 部署受影响版本的n8n服务。2. 使用合法用户凭据登录Web UI。3. 创建一个新的工作流，并添加一个支持JS表达式的节点（如'Code'节点或'Set'节点）。4. 在表达式输入框中构造特定的沙箱逃逸Payload，例如利用原型链污染或未过滤的全局对象访问fs、child_process模块。5. 执行或预览该节点，观察命令是否在服务器端执行。投毒风险分析：该项目源码目前表现为典型的安全研究用途。其检测指南建议使用Nginx代理记录Request Body以弥补n8n原生日志的不足，这种建议具有较高的专业防御价值，且未发现恶意代码混淆或自动执行的后门。然而，存在15%的潜在投毒风险，主要来自其引用的外部Docker镜像和可能存在的恶意克隆变体。攻击者往往会克隆此类合法的CVE复现仓库，并向README中的'一键运行'脚本添加恶意下载器（如curl | bash），诱导安全从业者在测试环境中执行。此外，若POC中包含编译好的二进制文件或加密混淆的JS片段，则需极度警惕。当前分析的样本代码逻辑透明，仅作为环境搭建和防御参考，属于低风险范畴。

**项目地址:** [https://github.com/Dlanang/homelab-CVE-2025-68613.git](https://github.com/Dlanang/homelab-CVE-2025-68613.git)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-68613](https://avd.aliyun.com/detail?id=AVD-2025-68613)
