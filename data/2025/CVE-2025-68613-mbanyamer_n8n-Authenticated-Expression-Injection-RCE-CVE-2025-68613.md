## CVE-2025-68613 - n8n (开源工作流自动化工具) RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n (开源工作流自动化工具)

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 ≤ n8n < 1.120.4; n8n < 1.121.1; n8n < 1.122.0

**利用条件:** 需要用户认证，默认配置，可远程触发

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC由Mohammed Idrees Banyamer发布，针对n8n工作流工具中的表达式注入漏洞。漏洞核心在于n8n在处理工作流表达式时，其沙箱环境存在逻辑缺陷，未能完全限制Node.js底层对象的访问。POC通过构建特定的混淆表达式，成功逃逸JavaScript沙箱并调用系统的process或child_process模块。经过对POC代码结构的初步评估，该脚本包含了完整的认证流程处理、自动化Payload生成以及HTTP请求发送模块。其在测试版本1.119.3（Docker环境）上表现出极高的稳定性。该利用方式利用了n8n核心节点对表达式解析的信任，能够实现非预期的OS命令执行。由于n8n通常部署在具有较高权限的容器或服务器中，且常用于连接企业内部多种敏感API，一旦漏洞被触发，攻击者不仅能获得主机控制权，还能通过已配置的凭据横向移动到其他云服务或内部数据库，危害程度极大。利用步骤：1. 攻击者首先需要获取n8n实例的合法认证凭据（用户名/密码或API Key）。2. 登录后，通过API或Web UI创建一个新的工作流。3. 在工作流的节点配置中，插入精心构造的恶意JavaScript表达式，该表达式包含沙箱逃逸Payload。4. 触发该工作流运行（例如通过Webhook触发或手动点击执行）。5. n8n后端在解析该表达式时，由于沙箱过滤不严，恶意指令脱离隔离环境并在底层操作系统上以n8n进程权限执行。6. 攻击者通过反弹Shell或带外请求（OOB）确认利用成功。投毒风险分析：该POC代码托管于GitHub且提供了详细的README和作者信息，代码逻辑相对透明。分析其提供的Bash脚本发现，其主要功能集中在自动化利用流程，包括登录鉴权和Payload推送。代码中使用了标准的curl工具和基础的Base64编码处理，并未发现明显的代码混淆、二阶段恶意负载下载或针对研究人员主机的破坏性指令。然而，作为安全研究人员仍需警惕，此类高热度CVE的POC往往会被恶意第三方克隆并二次修改，在脚本中埋入窃取环境变量（如AWS/Azure Key）的后门代码。当前的原始POC属于较低风险，但建议在隔离的沙箱环境（如无网络的Docker容器）中运行。此外，脚本中包含作者的社交媒体链接，需核实其发布渠道的真实性，防止因供应链投毒导致的防御端失陷。建议在使用前逐行审计HTTP请求的Header和Body，确保没有非法的数据回传路径。

**项目地址:** [https://github.com/mbanyamer](https://github.com/mbanyamer)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
