# CVE-2025-24085

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24085-JGoyd_glass-cage-ios18-cve-2025-24085-cve-2025-24201.md](../2025/CVE-2025-24085-JGoyd_glass-cage-ios18-cve-2025-24085-cve-2025-24201.md)

# CVE-2025-24085

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-24085-JGoyd_glass-cage-ios18-cve-2025-24085-cve-2025-24201.md](../2025/CVE-2025-24085-JGoyd_glass-cage-ios18-cve-2025-24085-cve-2025-24201.md)

## CVE-2025-24085 - Core Media Privilege Escalation

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free Privilege Escalation

**影响应用:** Apple iOS, iPadOS, macOS, tvOS, watchOS, visionOS

**危害等级:** 高危，可导致提权至root，完全控制设备，数据窃取，甚至设备变砖

**影响版本:** < 18.3 (iOS & iPadOS), < 15.3 (macOS), < 18.3 (tvOS), < 11.3 (watchOS), < 2.3 (visionOS)

**利用条件:** 受害者需要接收并处理恶意构造的PNG图像，通常通过iMessage，无需用户交互（Zero-Click）。需要目标设备运行受影响的操作系统版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085是一个存在于Apple Core Media框架中的use-after-free漏洞，可被利用进行权限提升。根据漏洞信息、搜索结果以及提供的漏洞利用代码（Glass Cage），漏洞利用方式如下：

1.  **恶意PNG图像创建：** 攻击者创建一个特制的PNG图像，该图像包含恶意的HEIF负载和畸形的EXIF字段，用于触发`ATXEncoder`中的堆损坏。
2.  **Silent触发：** 通过iMessage发送恶意PNG图像。`MessagesBlastDoorService`会自动处理接收到的文件，无需用户交互。
3.  **远程代码执行（RCE）：** 通过WebKit漏洞（CVE-2025-24201）实现RCE。该漏洞与CVE-2025-24085一起构成完整的攻击链。
4.  **沙箱逃逸：** WebKit绕过资源隔离，访问私有资源。
5.  **权限提升：** 利用Core Media的use-after-free漏洞（CVE-2025-24085）获得内核访问权限，该漏洞会利用`mediaplaybackd`、`codecctl`和`IOHIDInterface`。
6.  **持久化和破坏：** 注入恶意守护进程通过`launchd`，劫持网络通过`wifid`，通过修改IORegistry值来使设备变砖。

**有效性：**
提供的POC代码（`poc/malicious_png_generator.py`）旨在生成触发漏洞的恶意PNG图像。根据描述，此漏洞利用链（Glass Cage）已经在野外被发现并利用，因此提供的POC代码具有很高的有效性。

**投毒风险：**
虽然提供的自述文件没有明显的投毒迹象，但需要注意的是，`poc/malicious_png_generator.py`脚本本身就具有潜在风险。 攻击者可能会修改该脚本，添加额外功能，例如，在成功利用漏洞后，偷偷安装后门程序或收集敏感信息。 由于无法直接审查脚本代码，因此将投毒风险评估为10%。 这主要考虑了以下因素：
    *   自述文件仅提供了利用漏洞的总体描述，实际的漏洞利用代码可能包含隐藏的恶意功能。
    *   攻击者可能会利用人们对POC代码的信任，在代码中添加难以察觉的后门。

总体而言，虽然此POC代码能够重现该漏洞，但在使用时务必谨慎，并在受控环境中运行，以避免潜在的风险。

**项目地址:** [JGoyd/glass-cage-ios18-cve-2025-24085-cve-2025-24201](https://github.com/JGoyd/glass-cage-ios18-cve-2025-24085-cve-2025-24201)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

## POC #2

**来源**: [CVE-2025-24085-apt-007_12345.md](../2025/CVE-2025-24085-apt-007_12345.md)

## CVE-2025-24085-Apple-Use-After-Free-Privilege-Escalation

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free权限提升

**影响应用:** Apple visionOS, iOS, iPadOS, macOS, tvOS, watchOS (CoreMedia)

**危害等级:** 高危，允许恶意应用程序提升权限

**影响版本:** < visionOS 2.3, < iOS/iPadOS 18.3, < macOS Sequoia 15.3, < watchOS 11.3, < tvOS 18.3

**利用条件:** 需要恶意应用程序在受害者设备上运行，且用户需要与该应用交互（如点击按钮）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085 是 Apple CoreMedia 框架中的一个使用后释放（Use-After-Free）漏洞，攻击者可以利用该漏洞提升权限。漏洞存在于visionOS, iOS, iPadOS, macOS, tvOS, 和 watchOS 等多个 Apple 操作系统中。根据漏洞信息，该漏洞可能已被实际利用攻击 iOS 17.2 之前的版本。

**漏洞利用方式：**

根据提供的漏洞利用代码（AppDelegate.swift 和 ContentView.swift），该POC尝试利用 XNU VM_BEHAVIOR_ZERO_WIRED_PAGES 漏洞，该漏洞允许对只读页面进行写入，从而实现权限提升。具体利用步骤可能包括：

1.  将目标文件映射到只读内存。
2.  设置特殊的内存行为标志（VM_BEHAVIOR_ZERO_WIRED_PAGES）。
3.  锁定内存页面。
4.  解除内存映射。

通过这些步骤，攻击者可以修改系统只读文件的内容，从而可能实现权限提升。

**有效性评估：**

漏洞库信息和搜索引擎结果都表明 CVE-2025-24085 是一个真实存在的，且已被修复的漏洞。由于有实际利用案例的报告，该漏洞的利用是可行的。提供的POC代码似乎尝试实现上述利用方式，因此判断POC代码可能有效，但需要实际测试验证。

**投毒风险评估：**

POC 代码中存在投毒的风险较低，大约为 10%。 代码结构较为简单，主要功能是创建测试文件并在该文件上尝试利用 UAF 漏洞。潜在的风险点在于`ExploitCore`类中 `prepareExploit`和`runExploit`方法的实现，这些方法可能包含恶意代码。但是代码中作者的注释和简单的代码结构降低了投毒的可能性。需要进一步检查`ExploitCore`的具体实现，以确定是否存在恶意行为。

**项目地址:** [apt-007/12345](https://github.com/apt-007/12345)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

## POC #3

**来源**: [CVE-2025-24085-pxx917144686_12345.md](../2025/CVE-2025-24085-pxx917144686_12345.md)

## CVE-2025-24085 - XNU内核压缩内存子系统权限绕过漏洞

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free (释放后使用)

**影响应用:** Apple iOS, iPadOS, macOS, tvOS, watchOS, visionOS (CoreMedia)

**危害等级:** 高危，权限提升

**影响版本:** iOS < 18.3 (actively exploited before 17.2), macOS < 15.3, tvOS < 18.3, watchOS < 11.3, visionOS < 2.3

**利用条件:** 本地应用，需要用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085 是一个 XNU 内核压缩内存子系统中的释放后使用漏洞，允许恶意应用程序提升权限。Apple 意识到该漏洞可能已被积极利用于 iOS 17.2 之前的版本。

**漏洞原理：**
该漏洞存在于 XNU 内核的压缩内存 (VM_COMPRESSOR) 子系统中。在特定条件下，当系统尝试压缩和解压缩页面时，内核未能正确维护内存页面的原始保护标志，导致可以在解压缩过程中修改只读内存页面的内容。

**利用方式：**
1.  映射目标只读文件。
2.  创建内存压力（通过分配大量内存强制系统压缩）。
3.  设置内存通知回调。
4.  触发内存压缩/解压缩循环。
5.  在解压缩时间窗口内修改只读页面内容。

**POC 分析：**
POC 代码尝试通过以下步骤利用该漏洞：
*   使用 `mmap` 将目标文件映射为只读。
*   创建一个 `memory_pressure_thread` 来模拟内存压力，促使系统压缩页面。
*   使用信号量 `g_exploit_semaphore` 和 `g_pressure_semaphore` 控制压缩和解压缩的时机。
*   `page_monitor_thread` 尝试在解压缩的时间窗口内写入目标页面。

**有效性评估：**
POC 代码提供了一个利用漏洞的基本框架。 根据漏洞信息显示，该漏洞已被野外利用，所以该PoC具有一定有效性，能够提权。但是，代码中的内存通知注册部分标记为 "概念验证"，表明需要使用真实的通知 API（例如 `host_register_mach_notification` 或类似机制）才能完整实现漏洞利用。

**投毒风险分析：**
代码中存在少量潜在的投毒风险，主要体现在以下几个方面：
*   `memory_pressure_thread` 中，循环分配内存并写入特定数据，理论上可以被篡改为恶意代码，但需要精巧的构造，可能性较低。
*    使用内联汇编直接写入内存。内联汇编提供了直接操作内存的能力，但是如果被恶意修改，可能导致意外的系统行为或崩溃。虽然代码里添加了注释说明是绕过编译器检查，但这仍然是一个潜在的风险点。
*   虽然代码本身主要关注提权，但也可能包含一些额外的、未公开的目的，例如收集系统信息或植入后门。不过，就现有代码来看，这种可能性较低，所以认定为10%。 总体评估投毒风险为10%。

**项目地址:** [pxx917144686/12345](https://github.com/pxx917144686/12345)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

## POC #4

**来源**: [CVE-2025-24085-windz3r0day_CVE-2025-24085.md](../2025/CVE-2025-24085-windz3r0day_CVE-2025-24085.md)

## CVE-2025-24085-Apple-Use-After-Free

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free

**影响应用:** visionOS, tvOS, macOS, watchOS, iOS and iPadOS

**危害等级:** 高危，可能导致权限提升

**影响版本:** < visionOS 2.3, < tvOS 18.3, < macOS Sequoia 15.3, < watchOS 11.3, < iOS and iPadOS 18.3

**利用条件:** 需要用户安装恶意应用程序

**POC 可用性:** 未知，未提供完整的PoC，只有协议

**投毒风险:** 0%

## 详情

CVE-2025-24085是一个存在于Apple CoreMedia框架中的Use-After-Free漏洞。根据漏洞描述，该漏洞允许恶意应用程序提升权限。Apple已知该漏洞已被积极利用于iOS 17.2之前的版本。修复方案是通过改进内存管理解决该问题。

**有效性：**
根据提供的代码片段（LICENSE），无法判断该漏洞利用代码的有效性。提供的仅仅是Creative Commons Legal Code，而非漏洞利用的代码。

**投毒风险：**
提供的代码片段只是一个LICENSE文件，不包含任何可执行代码，因此不存在投毒风险。风险评分为0%。

**利用方式：**
根据漏洞描述和搜索结果，该漏洞的利用方式是：
1.  攻击者需要创建一个恶意的应用程序。
2.  该应用程序利用CoreMedia框架中的Use-After-Free漏洞。
3.  成功利用后，该应用程序可以获得提升的权限。

**排序和总结：**
搜索引擎结果表明，该漏洞是一个被积极利用的零日漏洞，影响多个Apple操作系统。该漏洞位于CoreMedia框架中，是一个Use-After-Free漏洞，可能导致权限提升。漏洞利用需要一个恶意应用程序，用户需要安装该程序。修复方案是升级到受影响操作系统的指定版本（visionOS 2.3, iOS 18.3 and iPadOS 18.3, macOS Sequoia 15.3, watchOS 11.3, tvOS 18.3）。

**项目地址:** [windz3r0day/CVE-2025-24085](https://github.com/windz3r0day/CVE-2025-24085)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---



---

## POC #2

**来源**: [CVE-2025-24085-apt-007_12345.md](../2025/CVE-2025-24085-apt-007_12345.md)

## CVE-2025-24085-Apple-Use-After-Free-Privilege-Escalation

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free权限提升

**影响应用:** Apple visionOS, iOS, iPadOS, macOS, tvOS, watchOS (CoreMedia)

**危害等级:** 高危，允许恶意应用程序提升权限

**影响版本:** < visionOS 2.3, < iOS/iPadOS 18.3, < macOS Sequoia 15.3, < watchOS 11.3, < tvOS 18.3

**利用条件:** 需要恶意应用程序在受害者设备上运行，且用户需要与该应用交互（如点击按钮）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085 是 Apple CoreMedia 框架中的一个使用后释放（Use-After-Free）漏洞，攻击者可以利用该漏洞提升权限。漏洞存在于visionOS, iOS, iPadOS, macOS, tvOS, 和 watchOS 等多个 Apple 操作系统中。根据漏洞信息，该漏洞可能已被实际利用攻击 iOS 17.2 之前的版本。

**漏洞利用方式：**

根据提供的漏洞利用代码（AppDelegate.swift 和 ContentView.swift），该POC尝试利用 XNU VM_BEHAVIOR_ZERO_WIRED_PAGES 漏洞，该漏洞允许对只读页面进行写入，从而实现权限提升。具体利用步骤可能包括：

1.  将目标文件映射到只读内存。
2.  设置特殊的内存行为标志（VM_BEHAVIOR_ZERO_WIRED_PAGES）。
3.  锁定内存页面。
4.  解除内存映射。

通过这些步骤，攻击者可以修改系统只读文件的内容，从而可能实现权限提升。

**有效性评估：**

漏洞库信息和搜索引擎结果都表明 CVE-2025-24085 是一个真实存在的，且已被修复的漏洞。由于有实际利用案例的报告，该漏洞的利用是可行的。提供的POC代码似乎尝试实现上述利用方式，因此判断POC代码可能有效，但需要实际测试验证。

**投毒风险评估：**

POC 代码中存在投毒的风险较低，大约为 10%。 代码结构较为简单，主要功能是创建测试文件并在该文件上尝试利用 UAF 漏洞。潜在的风险点在于`ExploitCore`类中 `prepareExploit`和`runExploit`方法的实现，这些方法可能包含恶意代码。但是代码中作者的注释和简单的代码结构降低了投毒的可能性。需要进一步检查`ExploitCore`的具体实现，以确定是否存在恶意行为。

**项目地址:** [apt-007/12345](https://github.com/apt-007/12345)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

## POC #3

**来源**: [CVE-2025-24085-pxx917144686_12345.md](../2025/CVE-2025-24085-pxx917144686_12345.md)

## CVE-2025-24085 - XNU内核压缩内存子系统权限绕过漏洞

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free (释放后使用)

**影响应用:** Apple iOS, iPadOS, macOS, tvOS, watchOS, visionOS (CoreMedia)

**危害等级:** 高危，权限提升

**影响版本:** iOS < 18.3 (actively exploited before 17.2), macOS < 15.3, tvOS < 18.3, watchOS < 11.3, visionOS < 2.3

**利用条件:** 本地应用，需要用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085 是一个 XNU 内核压缩内存子系统中的释放后使用漏洞，允许恶意应用程序提升权限。Apple 意识到该漏洞可能已被积极利用于 iOS 17.2 之前的版本。

**漏洞原理：**
该漏洞存在于 XNU 内核的压缩内存 (VM_COMPRESSOR) 子系统中。在特定条件下，当系统尝试压缩和解压缩页面时，内核未能正确维护内存页面的原始保护标志，导致可以在解压缩过程中修改只读内存页面的内容。

**利用方式：**
1.  映射目标只读文件。
2.  创建内存压力（通过分配大量内存强制系统压缩）。
3.  设置内存通知回调。
4.  触发内存压缩/解压缩循环。
5.  在解压缩时间窗口内修改只读页面内容。

**POC 分析：**
POC 代码尝试通过以下步骤利用该漏洞：
*   使用 `mmap` 将目标文件映射为只读。
*   创建一个 `memory_pressure_thread` 来模拟内存压力，促使系统压缩页面。
*   使用信号量 `g_exploit_semaphore` 和 `g_pressure_semaphore` 控制压缩和解压缩的时机。
*   `page_monitor_thread` 尝试在解压缩的时间窗口内写入目标页面。

**有效性评估：**
POC 代码提供了一个利用漏洞的基本框架。 根据漏洞信息显示，该漏洞已被野外利用，所以该PoC具有一定有效性，能够提权。但是，代码中的内存通知注册部分标记为 "概念验证"，表明需要使用真实的通知 API（例如 `host_register_mach_notification` 或类似机制）才能完整实现漏洞利用。

**投毒风险分析：**
代码中存在少量潜在的投毒风险，主要体现在以下几个方面：
*   `memory_pressure_thread` 中，循环分配内存并写入特定数据，理论上可以被篡改为恶意代码，但需要精巧的构造，可能性较低。
*    使用内联汇编直接写入内存。内联汇编提供了直接操作内存的能力，但是如果被恶意修改，可能导致意外的系统行为或崩溃。虽然代码里添加了注释说明是绕过编译器检查，但这仍然是一个潜在的风险点。
*   虽然代码本身主要关注提权，但也可能包含一些额外的、未公开的目的，例如收集系统信息或植入后门。不过，就现有代码来看，这种可能性较低，所以认定为10%。 总体评估投毒风险为10%。

**项目地址:** [pxx917144686/12345](https://github.com/pxx917144686/12345)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

## POC #4

**来源**: [CVE-2025-24085-windz3r0day_CVE-2025-24085.md](../2025/CVE-2025-24085-windz3r0day_CVE-2025-24085.md)

## CVE-2025-24085-Apple-Use-After-Free

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free

**影响应用:** visionOS, tvOS, macOS, watchOS, iOS and iPadOS

**危害等级:** 高危，可能导致权限提升

**影响版本:** < visionOS 2.3, < tvOS 18.3, < macOS Sequoia 15.3, < watchOS 11.3, < iOS and iPadOS 18.3

**利用条件:** 需要用户安装恶意应用程序

**POC 可用性:** 未知，未提供完整的PoC，只有协议

**投毒风险:** 0%

## 详情

CVE-2025-24085是一个存在于Apple CoreMedia框架中的Use-After-Free漏洞。根据漏洞描述，该漏洞允许恶意应用程序提升权限。Apple已知该漏洞已被积极利用于iOS 17.2之前的版本。修复方案是通过改进内存管理解决该问题。

**有效性：**
根据提供的代码片段（LICENSE），无法判断该漏洞利用代码的有效性。提供的仅仅是Creative Commons Legal Code，而非漏洞利用的代码。

**投毒风险：**
提供的代码片段只是一个LICENSE文件，不包含任何可执行代码，因此不存在投毒风险。风险评分为0%。

**利用方式：**
根据漏洞描述和搜索结果，该漏洞的利用方式是：
1.  攻击者需要创建一个恶意的应用程序。
2.  该应用程序利用CoreMedia框架中的Use-After-Free漏洞。
3.  成功利用后，该应用程序可以获得提升的权限。

**排序和总结：**
搜索引擎结果表明，该漏洞是一个被积极利用的零日漏洞，影响多个Apple操作系统。该漏洞位于CoreMedia框架中，是一个Use-After-Free漏洞，可能导致权限提升。漏洞利用需要一个恶意应用程序，用户需要安装该程序。修复方案是升级到受影响操作系统的指定版本（visionOS 2.3, iOS 18.3 and iPadOS 18.3, macOS Sequoia 15.3, watchOS 11.3, tvOS 18.3）。

**项目地址:** [windz3r0day/CVE-2025-24085](https://github.com/windz3r0day/CVE-2025-24085)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)

---

