# CVE-2025-32023

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32023-LordBheem_CVE-2025-32023.md](../2025/CVE-2025-32023-LordBheem_CVE-2025-32023.md)

## CVE-2025-32023-Redis-HyperLogLog-RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Redis

**危害等级:** 高危，可能导致系统完全控制和数据泄露

**影响版本:** 2.8 到 8.0.3 之前, 7.4.5 之前, 7.2.10 之前, 6.2.19 之前

**利用条件:** 需要已认证的用户身份。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-32023 漏洞存在于 Redis 的 HyperLogLog 操作中。经过身份验证的用户可以利用特制的字符串触发堆栈或堆上的越界写入，可能导致远程代码执行。漏洞根源在于稀疏 HyperLogLog 编码处理中的整数溢出。

**有效性：**

提供的POC代码看起来有效。它给出了漏洞利用的基本步骤，即克隆包含exploit的git仓库，更改权限并执行exploit脚本，并提供了针对host和port的参数。

**投毒风险：**

虽然POC 描述中提到要替换占位符，但由于没有提供 exploit 脚本的实际内容, 且需要使用者从 git clone 仓库下载可执行文件，因此存在一定的投毒风险。风险点在于git仓库本身可能包含恶意代码。因此，推测投毒风险为20%。

**利用方式：**

1.  攻击者需要拥有 Redis 实例的有效用户身份。
2.  攻击者发送特制的 HyperLogLog 命令，触发整数溢出。
3.  整数溢出导致越界写入，覆盖堆栈或堆上的内存。
4.  通过精心构造的内存覆盖，攻击者可以执行任意代码。

**缓解措施：**

*   升级到已修复的版本 (8.0.3, 7.4.5, 7.2.10, 或 6.2.19)。
*   使用 ACL 阻止 HyperLogLog 相关命令的执行。
*   限制对 Redis 实例的网络访问。
*   监控 Redis 日志中可疑的 HyperLogLog 命令使用情况。

**项目地址:** [LordBheem/CVE-2025-32023](https://github.com/LordBheem/CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)

---

## POC #2

**来源**: [CVE-2025-32023-atomicjjbod_CVE-2025-32023.md](../2025/CVE-2025-32023-atomicjjbod_CVE-2025-32023.md)

## CVE-2025-32023-Redis-堆溢出导致RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 堆溢出

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 2.8.0 <= version < 6.2.19; 7.0.0 <= version < 7.2.10; 7.4-rc1 <= version < 7.4.5; 8.0.0 <= version < 8.0.3

**利用条件:** 需要Redis实例运行，攻击者需具备Redis的低权限认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32023 存在于 Redis 的 hyperloglog 功能中，是一个整数溢出导致堆溢出的漏洞。攻击者可以通过构造特制的字符串，触发 hyperloglog 操作中的越界写，从而可能导致远程代码执行。

**有效性：** 根据漏洞描述，攻击者需要进行认证，并且攻击复杂性较高，但可以实现RCE。 搜索结果表明该漏洞存在且已经被公开讨论，并有github的链接。

**投毒风险：** 提供的漏洞利用代码只有一个README.md文件，说明有POC但是没有包含实际的exp。仅仅一个readme文件,没有包含任何的后门代码，因此投毒的概率较低，但是不排除作者在其他文件（未提供）中隐藏恶意代码的可能性。因此, 投毒风险设为10%。

**利用方式：** 
1.  攻击者首先需要通过某种方式获得 Redis 的低权限认证。
2.  利用 specially crafted string构造恶意的输入，通过HLL相关指令，触发整数溢出。
3.  整数溢出导致堆越界写。
4.  通过堆越界写，覆盖内存中的其他数据，达到远程代码执行的目的。

此漏洞利用属于经典的堆利用，需要攻击者对Redis的内存管理机制有深入的理解。可以参考github上给出的利用方式(leesh3288/CVE-2025-32023)， 通过构造一个超长的sds对象，再结合embstr进行堆喷，实现RCE。

**项目地址:** [atomicjjbod/CVE-2025-32023](https://github.com/atomicjjbod/CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)

---

## POC #3

**来源**: [CVE-2025-32023-leesh3288_CVE-2025-32023.md](../2025/CVE-2025-32023-leesh3288_CVE-2025-32023.md)

## CVE-2025-32023 Redis HyperLogLog 整数溢出导致OOB写

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 整数溢出, 堆/栈溢出

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** >= 2.8 且 < 8.0.3, 7.4.5, 7.2.10, 6.2.19

**利用条件:** 需要能与Redis服务器建立连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32023是Redis中HyperLogLog数据结构处理不当导致的整数溢出漏洞。当Redis使用稀疏编码存储HyperLogLog时，在`hllMerge`函数中计算run lengths的总和时，如果HLL数据结构被恶意构造，可能导致整数溢出，使得索引`i`变为负数。这会导致对HLL结构体进行负偏移的写入，造成堆/栈溢出，最终导致远程代码执行。

**漏洞利用方式：**

1.  **构造恶意HLL数据：** 攻击者需要构造一个恶意的稀疏编码的HyperLogLog数据，其中包含超长的run lengths，以便在`hllMerge`函数中触发整数溢出。
2.  **触发整数溢出：** 通过`PFCOUNT`命令合并恶意构造的HLL数据，触发`hllMerge`函数中的整数溢出。
3.  **内存破坏：** 整数溢出导致负偏移写入，破坏堆或栈上的数据结构。
4.  **RCE：** 利用内存破坏实现任意代码执行。利用代码中展示了通过篡改SDS对象，进而伪造module对象，最终利用module的卸载触发RCE的经典redis利用方法。

**投毒风险分析：**

代码仓库中主要包含POC和利用代码，用于验证和利用该漏洞。其中`poc.py`用于触发整数溢出，`solver-f0b22e429fa6c984f39a409744ff954d3a45d843edd29428ef3a68085d696a7d.py`包含了更完善的exploit，实现了泄露地址，伪造module对象等步骤。

投毒风险较低（5%）。虽然攻击者可能在利用代码中加入恶意指令，例如在RCE阶段执行恶意shell命令。但是此漏洞的利用需要对redis内部结构有较深入的了解，且exp编写难度较高，因此不太可能出现通用的，隐蔽性强的后门代码。`solver-f0b22e429fa6c984f39a409744ff954d3a45d843edd29428ef3a68085d696a7d.py` 中存在硬编码的偏移量(0xc000, 0x956c)，这可能导致exp在不同版本/环境的redis上运行失败，但不能算是投毒代码。因此判断投毒风险较低。

**项目地址:** [leesh3288/CVE-2025-32023](https://github.com/leesh3288/CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)

---

## POC #4

**来源**: [CVE-2025-32023-shayantrix_POC-CVE-2025-32023.md](../2025/CVE-2025-32023-shayantrix_POC-CVE-2025-32023.md)

## CVE-2025-32023-Redis-HyperLogLog-RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 远程代码执行

**影响应用:** Redis

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.8.0 <= version < 6.2.19, 7.0.0 <= version < 7.2.10, 7.4-rc1 <= version < 7.4.5, 8.0.0 <= version < 8.0.3

**利用条件:** 需要已认证的 Redis 用户，且 Redis 实例存在于漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32023 漏洞存在于 Redis 的 HyperLogLog (HLL) 实现中，允许经过身份验证的用户通过构造特殊的字符串触发栈/堆的越界写入，从而可能导致远程代码执行。漏洞影响 Redis 版本 2.8 到 8.0.3 之前的多个版本。漏洞利用方式通常涉及利用 HLL 命令（如 PFADD、PFCOUNT、PFMERGE）处理恶意构造的输入，从而触发整数溢出，导致缓冲区溢出，最终执行任意代码。

**有效性：**
根据漏洞描述，该漏洞影响多个 Redis 版本，且已经有公开的修复补丁。攻击复杂度较高 (LOCAL/HIGH)，需要已认证的用户，但如果利用成功，可以获得服务器的完全控制权。

**投毒风险：**
提供的代码片段是 Apache 2.0 许可协议，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者需要拥有 Redis 实例的有效身份验证凭据。
2.  攻击者构造一个恶意的字符串，该字符串能够触发 HyperLogLog 命令中的整数溢出。
3.  攻击者使用受影响的 HyperLogLog 命令（如 PFADD、PFCOUNT、PFMERGE）将恶意字符串传递给 Redis 服务器。
4.  Redis 服务器在处理恶意字符串时发生整数溢出，导致缓冲区溢出。
5.  攻击者利用缓冲区溢出执行任意代码，从而控制 Redis 服务器。

**项目地址:** [shayantrix/POC-CVE-2025-32023](https://github.com/shayantrix/POC-CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)

---

