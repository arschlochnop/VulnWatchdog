## CVE-2025-32463 - sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= sudo < 1.9.17p1

**利用条件:** 本地低权限用户访问；sudo需支持并配置了--chroot (-R) 选项

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于sudo在处理--chroot选项时的设计缺陷。从1.9.14版本开始，sudo引入了该功能，但在实现过程中未能正确隔离用户控制下的配置文件。攻击者可以创建一个包含伪造配置的恶意chroot环境，其中关键在于劫持/etc/nsswitch.conf文件。在利用过程中，POC通过创建一个包含恶意动态库（如libnss_king.so.2）的临时目录结构，并诱导sudo在执行带chroot的操作时加载该库。由于sudo在切换到chroot环境后仍具有高权限执行上下文，加载的恶意库将以root权限执行。提供的Python脚本逻辑清晰，自动化程度极高，能够自动识别架构（x86_64, aarch64等）并部署预编译的Base64有效载荷。经过分析，该POC在受影响版本的Linux系统上具有极高的成功率。利用步骤：1. 在受害机器上克隆PoC仓库或复制脚本。2. 脚本自动检测当前CPU架构。3. 创建临时工作目录，构建伪造的chroot rootfs结构（包含etc目录）。4. 将恶意的共享库文件写入该目录，并配置nsswitch.conf指向该库。5. 执行命令 'sudo -R [chroot目录] [命令]'，触发sudo加载恶意库。6. 恶意库执行其Payload（通常为/bin/sh或反弹shell），从而获取root shell。投毒风险分析：该POC虽然使用了Base64编码的二进制Payload，这在某些情况下可能隐藏恶意后门，但在此情境下，这是为了在目标机器没有GCC编译环境时确保Exploit能运行的常规做法。代码逻辑显示其主要行为是进行权限提升测试。主要的潜在风险在于：第一，该POC尝试从GitHub动态下载或执行预编译的二进制文件，如果GitHub仓库遭到劫持，下载的文件可能包含勒索软件或远控木马；第二，脚本中使用了tempfile和shutil进行大量文件操作，若清理逻辑失败，可能在系统中留下敏感的提权工具痕迹。然而，代码本身没有发现明显的混淆、恶意外部请求或删除系统关键文件的逻辑，因此判定投毒风险为低。安全研究员在使用时建议在受控的沙箱环境中手动审查Base64解码后的二进制文件，或使用mkall-dynamic.sh脚本自行从源码编译以确保纯净性。

**项目地址:** [https://github.com/shazed-x/CVE-2025-32463](https://github.com/shazed-x/CVE-2025-32463)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
