## CVE-2025-68613 - n8n (开源工作流自动化工具) RCE/沙箱逃逸

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE/沙箱逃逸

**影响应用:** n8n (开源工作流自动化工具)

**危害等级:** 致命 (Critical)

**CVSS评分:** 9.9

**影响版本:** 0.211.0 <= n8n < 1.120.4, < 1.121.1, < 1.122.0

**利用条件:** 需要用户认证, 默认配置即可触发

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：提供的Python POC代码结构完整且逻辑严密，专门针对n8n的表达式评价系统漏洞。该POC首先尝试获取目标版本，然后通过两种不同的登录模式（n8n 1.x和旧版本）进行身份验证。核心利用逻辑在于定位n8n的工作流处理机制，注入恶意构造的JavaScript表达式。由于n8n在处理表达式时沙箱限制不严（CWE-913），攻击者可以利用特定对象（如process或constructor）逃逸出Node.js沙箱，执行系统命令。该POC包含了完整的Session管理、Workflow创建、Webhook配置以及利用后的清理动作，不仅支持直接命令执行，还预留了反弹Shell的逻辑，在受控实验环境下具有极高的成功率。通过分析代码，其对n8n REST API的调用序列（/rest/login, /rest/settings, /rest/workflows）符合生产环境业务逻辑，足以证明漏洞的可利用性及其实际威胁。利用步骤：1. 使用有效的n8n账户凭证（用户名/密码）进行身份验证，获取Session和CSRF Token。2. 扫描并确定目标n8n的具体版本，选择对应的Payload模板。3. 构造恶意工作流，在其中嵌入经过逃逸处理的表达式Payload（如：{{constructor.constructor('return process')().mainModule.require('child_process').execSync('id')}}）。4. 触发该工作流执行（通常通过HTTP Request节点或特定的Webhook接口）。5. 观察命令执行结果，并根据POC提供的命令行参数获取回显或维持权限。投毒风险分析：该POC代码采用了清晰的Python编写风格，主要依赖标准库如requests、json、argparse等，未发现经过混淆的二进制Payload或外部可疑下载请求。代码中虽然包含了urllib3的证书警告禁用，但这在安全工具编写中属于常见做法，不属于恶意投毒特征。主要的投毒风险点在于：1. 提供的下载地址可能包含被修改过的exploit.py，其中若插入了反向连接攻击者服务器的隐藏代码，将导致研究人员电脑被控。2. 由于该漏洞分值极高（9.9），且n8n通常部署在企业内网工作流核心，攻击者可能利用此漏洞POC分发作为诱饵，在README或脚本注释中隐藏恶意URL。3. 目前分析的样本代码逻辑透明，仅用于POC演示，但仍建议在隔离的沙箱环境运行，防止因脚本内部未察觉的逻辑导致本地敏感数据泄露。整体来看，当前POC样本低风险，属于纯技术研究性质，但需警惕该漏洞近期可能引发的大规模自动化扫描。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-68613-Python-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-68613-Python-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
