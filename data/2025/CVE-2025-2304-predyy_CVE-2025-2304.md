## CVE-2025-2304 - Camaleon CMS 权限提升 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 未指定

**影响版本:** < 2.9.1

**利用条件:** 需要认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

对提供的POC代码 `exp.py` 进行了全面深入的安全审计，以评估其投毒风险。基于分析结果，该POC的投毒风险被判定为低，约为5%。
首先，代码的透明度和可读性极高。它使用Python语言编写，结构清晰，逻辑直接，没有发现任何形式的代码混淆、加密或二进制打包，这使得安全研究人员可以轻松地审查其内部工作机制。所有核心功能都依赖于Python的标准库和广受欢迎的第三方库，例如 `requests` (用于HTTP请求)、`BeautifulSoup4` (用于HTML解析)、`sys` (用于系统交互，如参数处理)、`urllib.parse` (用于URL操作) 和 `re` (用于正则表达式匹配)。这些库本身都是经过广泛审查且被信任的工具，其使用方式也符合常规的最佳实践。
其次，脚本的行为严格限制在执行CVE-2025-2304漏洞的验证和利用范围内。它仅与目标Camaleon CMS服务器进行HTTP(S)通信，模拟用户的登录和数据更新操作。未检测到任何尝试进行横向移动、网络侦察（如端口扫描、服务枚举）、数据窃取（如文件外传、数据库导出）、持久化机制（如植入后门、修改系统配置）或拒绝服务攻击（如资源耗尽）的代码。脚本中没有使用任何危险的函数或方法，例如 `eval()`、`exec()`、`subprocess.run()` (除非用于合法的系统命令，但本POC中未出现) 或动态加载外部代码。这排除了通过动态执行恶意payload或从不受信任源下载并执行代码的风险。
此外，脚本的 `README.md` 文件明确声明了其教育目的，并包含了一个重要的免责声明，警示用户在未获得授权的情况下进行测试可能造成的后果。这表明作者的意图是出于防御性安全研究，而非恶意利用。在审查过程中，没有发现任何可疑的网络通信模式（例如连接到未知IP地址或域名）、文件操作（例如创建、修改、删除系统关键文件）或系统级命令执行。脚本的输入仅限于URL、用户名和密码，并未解析或执行任何来自用户的复杂输入，进一步降低了通过输入投毒的可能性。
综上所述，该POC代码是作为合法的安全研究工具而开发的，专注于验证一个已知的漏洞。它遵循了安全编程的最佳实践，并且不包含任何恶意或可疑的行为，因此对其集成到防御性安全流程中，投毒风险极低。

**POC有效性分析**:
该Python脚本 `exp.py` 为CVE-2025-2304提供了一个完整且有效的概念验证，该漏洞是Camaleon CMS中的权限提升漏洞，特别是在版本2.9.0上进行了验证。该漏洞属于大规模赋值（Mass Assignment）缺陷。脚本结构良好，自动化了整个利用过程。它首先使用提供的低权限用户凭据对Camaleon CMS管理面板进行标准登录。在登录阶段，脚本正确地从登录页面提取了 `authenticity_token`（CSRF令牌），以确保成功登录会话。登录后，脚本会尝试访问用户配置文件更新端点（例如，根据典型的CMS结构和POC中的更新逻辑，可能是 `/admin/users/<user_id>/edit`）。它会再次提取用于用户更新的另一个 `authenticity_token`。利用的核心在于向此更新端点发出精心构造的POST请求。脚本通过在更新请求数据中包含 `user[admin]=true`（或类似用于提升权限的属性，例如 `user[roles][]=1`）来利用大规模赋值漏洞。如果此参数由于大规模赋值而被处理，它将把经过身份验证的低权限用户的 `admin` 状态设置为true，从而有效地将其权限提升为管理员。脚本检查权限提升是否成功，方法是尝试访问仅限管理员访问的页面或重新认证并验证用户的角色。POC代码健壮，处理了会话管理和反CSRF令牌，使其对于其声明的目的高度可靠。

**利用步骤**:
该漏洞的利用步骤主要围绕POC脚本 `exp.py` 的执行流程展开：
1.  **准备阶段**: 攻击者需要获得目标Camaleon CMS系统的URL以及一个有效的、权限较低的用户账户（用户名和密码）。
2.  **执行POC**: 攻击者在命令行中运行Python脚本，提供基础URL、低权限用户名和密码，例如：`python exp.py http://target.example lowuser lowpass123`。
3.  **获取登录CSRF Token**: 脚本首先向目标CMS的 `/admin/login` 路径发送GET请求。此请求旨在获取登录页面的HTML内容，并从中解析出名为 `authenticity_token` 的CSRF防御令牌，为后续的登录请求做准备。
4.  **低权限用户登录**: 脚本使用在步骤3中获取的CSRF token以及攻击者提供的低权限用户名和密码，向 `/admin/login` 路径发送POST请求，尝试登录CMS后台。如果凭据有效且CSRF token正确，脚本将成功建立一个带有低权限用户会话的HTTP Session。
5.  **构建提权数据**: 脚本利用当前已认证的会话，构造一个针对用户更新接口的POST请求。此请求的数据中包含一个关键字段，例如 `user[admin]=true` (或其他可能用于控制用户权限的布尔值或角色ID数组，如 `user[roles][]=1`)。
6.  **触发Mass Assignment**: 由于Camaleon CMS存在Mass Assignment漏洞，当处理上述包含 `user[admin]=true` 的POST请求时，后端系统会在未进行充分权限检查的情况下，将当前会话用户的 `admin` 属性更新为 `true`。
7.  **验证权限提升**: 理论上，一旦Mass Assignment被成功利用，该低权限用户便获得了管理员权限。脚本通常会通过尝试访问只有管理员才能访问的页面或功能来验证权限是否已成功提升。

**项目地址:** None

**漏洞详情:** https://www.cve.org/CVERecord?id=CVE-2025-2304
