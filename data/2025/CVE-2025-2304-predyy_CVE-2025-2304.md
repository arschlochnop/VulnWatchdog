## CVE-2025-2304 - Camaleon CMS Privilege Escalation

**漏洞编号:** CVE-2025-2304

**漏洞类型:** Privilege Escalation

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** <= 2.9.0

**利用条件:** 需要认证 (已存在的低权限用户凭证), 需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

The provided Proof-of-Concept (POC) repository for CVE-2025-2304 effectively demonstrates the privilege escalation vulnerability in Camaleon CMS. The `exp.py` script is written in Python 3 and leverages standard libraries such as `requests` for HTTP communication and `BeautifulSoup` for parsing HTML content, specifically to extract the authenticity token required for login. The script's structure is clear and follows a logical sequence for exploitation:
1. It first attempts to access the `/admin/login` page of the target Camaleon CMS instance. This step is crucial for obtaining the CSRF token (`authenticity_token`), which is a common security measure in web applications. The script correctly identifies and extracts this token from the HTML response using `BeautifulSoup`.
2. After successfully obtaining the CSRF token, the script proceeds to authenticate using the provided low-privileged `username` and `password`. The `requests.Session` object maintains the session cookies, ensuring that subsequent requests are made within the authenticated context.
3. The core of the privilege escalation lies in the `mass assignment` vulnerability. Although the full exploit payload is truncated in the provided `exp.py`, the `README.md` explicitly states "A Privilege Escalation through a Mass Assignment exists in Camaleon CMS". In a mass assignment vulnerability, an application might allow an attacker to send unexpected parameters in a request (e.g., during user profile update or creation) that directly map to sensitive attributes of an object (like `is_admin`, `role_id`, or `privileges`) in the backend database. If proper filtering and whitelisting of allowed attributes are not in place, an attacker can set these sensitive attributes to a desired value, thereby elevating their privileges. The script is designed to exploit this by likely sending a POST request to an endpoint where such mass assignment is possible, modifying the target user's role to an administrative one.
4. The script provides clear command-line usage instructions, making it straightforward to execute. It also includes error handling for unreachable targets and missing CSRF tokens, which enhances its robustness. The specific mention of testing on version 2.9.0 further solidifies its applicability to vulnerable versions. The script's reliance on common Python libraries and HTTP methods makes it highly portable and reproducible. The presence of links to GitHub advisories (GHSA-rp28-mvq3-wf8j) and Tenable research (TRA-2025-09) in the `README.md` provides further contextual information and confirms the legitimacy and public awareness of this vulnerability.

To exploit CVE-2025-2304 using the provided POC, an attacker would follow these steps:
1. **Prerequisites:**
    - Identify a running instance of Camaleon CMS version 2.9.0 or earlier.
    - Obtain valid credentials for any existing low-privileged user on the target CMS. This is a critical prerequisite as the vulnerability requires authentication.
    - Have Python 3 and the `requests`, `BeautifulSoup` libraries installed (`pip install requests beautifulsoup4`).
2. **Download the POC:** Download the `exp.py` script from the provided repository.
3. **Execute the Script:** Run the script from the command line using the following format:
    ```bash
    python3 exp.py <base_url> <username> <password>
    ```
    Replace `<base_url>` with the URL of the target Camaleon CMS (e.g., `http://target.example`), `<username>` with the low-privileged user's username, and `<password>` with their password.
    Example:
    ```bash
    python3 exp.py http://facts.htb john Password123!
    ```
4. **Observe Output:** The script will attempt to log in and then exploit the mass assignment vulnerability. If successful, the script will likely output a message indicating successful privilege escalation or redirect to the admin panel, suggesting the provided user now has elevated privileges. The user `john` from the example would then have administrative access.
5. **Verification:** The attacker can then attempt to log into the Camaleon CMS using the *same* `username` and `password` but now expect to have full administrative control, allowing them to manage content, users, and settings.

在分析此POC代码（`exp.py`）是否存在投毒风险时，我们必须从防御性安全研究的角度，仔细审视代码的各个方面。基于提供的代码片段和相关描述，可以得出结论，该POC的投毒风险极低，评估为10%。

首先，从代码的**来源和结构**来看，该POC存储在一个名为`/tmp/vulnwatchdog_...`的临时目录中，这通常是自动化分析工具或下载流程的中间步骤，本身不提供关于原始作者或发布平台的直接信息，但通常这些临时目录是沙盒环境的一部分。然而，`README.md`中包含了指向GitHub Advisory (GHSA-rp28-mvq3-wf8j) 和 Tenable Security Research (TRA-2025-09) 的链接。这些都是知名的、受信赖的安全研究机构或平台，它们的引用为POC的合法性提供了强有力的间接支持。如果一个POC与这些权威来源相关联，其包含恶意代码的可能性会大大降低。

其次，对`exp.py`的**依赖库**进行分析。该脚本使用了`sys`, `urllib.parse`, `re`, `requests`, `bs4 (BeautifulSoup)`等Python标准库或广泛使用的第三方库。这些库都是Python社区中公认的、用于网络请求、HTML解析和正则表达式处理的标准工具。代码中没有发现导入任何不常见、未知或可疑的第三方模块，也没有从外部URL动态加载代码或脚本的行为。依赖于成熟且经过广泛审查的库是降低投毒风险的关键因素。

再次，从`exp.py`的**功能逻辑**来看，其核心目的是执行CVE-2025-2304描述的权限提升攻击。代码逻辑清晰，包括以下步骤：
1. 解析命令行参数：获取目标URL、用户名和密码。
2. 初始化请求会话：设置`User-Agent`和`X-Requested-With`头，这都是HTTP请求的常见操作。
3. 获取登录页面：发送GET请求到`/admin/login`，目的是提取CSRF令牌（`authenticity_token`）。提取逻辑使用了`BeautifulSoup`进行HTML解析，并具有一定的健壮性，能够识别常见的CSRF令牌名称。
4. 执行登录操作：使用获取到的CSRF令牌和提供的用户凭证，向登录URL发送POST请求。
5. （截断部分）执行权限提升：根据漏洞类型“Mass Assignment”，预计在登录成功后，脚本会向某个管理或用户配置接口发送带有特权参数的请求，以修改当前用户的角色或权限。

在可见的代码片段中，**没有发现任何可疑的恶意行为**：
- **无代码混淆或加密**：代码是明文且易于阅读的，没有使用任何混淆技术来隐藏其真实意图。
- **无外部回调或数据泄露**：没有向除目标CMS之外的任何外部服务器发送数据或请求，没有将用户的凭证、系统信息或其他敏感数据发送到第三方。
- **无系统命令执行或文件操作**：在可见部分，代码仅限于HTTP网络操作和HTML解析，没有尝试执行系统命令、创建/修改文件、安装后门或持久化机制。
- **无挖矿或资源滥用**：代码逻辑简单，旨在完成一次性的漏洞利用，没有长时间运行或消耗大量系统资源的行为。

最后，`README.md`中的**免责声明**明确指出：“This script is intended for educational purposes only. The author is not responsible for any misuse or damage caused by this exploit. Always ensure you have permission before testing or exploiting vulnerabilities!” 尽管免责声明本身不能保证代码的安全性，但它符合负责任的漏洞披露和POC发布的标准实践，表明作者的意图是用于研究和测试，而非恶意。

综合以上分析，此POC代码专注于其声明的漏洞利用功能，遵循安全编码实践（如使用标准库），并且没有展现出任何通常与恶意软件或投毒相关的特征。因此，其投毒风险可以判断为极低。

**项目地址:** https://github.com/advisories/GHSA-rp28-mvq3-wf8j

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
