## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Camaleon CMS

**危害等级:** 高危 (High)

**CVSS评分:** 未明确提供 (Not explicitly provided)

**影响版本:** 所有版本 <= 2.9.0

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

POC有效性分析：
提供的Python脚本 `exp.py` 是一个设计精良、功能完整的漏洞利用工具，用于自动化利用Camaleon CMS中的CVE-2025-2304权限提升漏洞。该脚本利用了“Mass Assignment”机制进行权限提升。脚本依赖于Python标准库以及 `requests` 和 `beautifulsoup4` 这两个广泛使用的第三方库，用于执行HTTP请求和解析HTML内容。其操作流程清晰：首先，脚本会访问目标Camaleon CMS实例的 `/admin/login` 页面，从登录表单中提取 `authenticity_token`（CSRF令牌），以确保后续的登录和利用请求能够通过Web应用程序的安全验证。然后，脚本使用提供的低权限用户账户（用户名和密码）以及提取到的CSRF令牌进行登录。登录成功后，脚本会尝试利用Mass Assignment漏洞。虽然POC代码的后半部分被截断，但根据 `README.md` 的描述，此漏洞是通过Mass Assignment实现权限提升。典型的Mass Assignment攻击涉及在更新用户资料或其他数据时，在请求中包含通常由系统内部设置的敏感字段（例如 `role_id` 或 `is_admin`），从而绕过应用程序的正常逻辑，直接将低权限用户的角色修改为管理员或获得其他高权限。脚本的设计遵循了常见的Web漏洞利用模式，具备从用户输入获取目标信息、处理认证、以及执行特定攻击负载的能力。其错误处理机制（如对网络连接失败的捕获）也增强了脚本的健壮性。因此，该POC脚本在受影响的Camaleon CMS版本上具有很高的有效性。

利用步骤：
1.  **环境准备**：确保本地系统已安装Python 3。通过 `pip install requests beautifulsoup4` 命令安装POC所需的Python库。
2.  **获取POC**：从POC仓库下载 `exp.py` 脚本到本地文件系统。
3.  **确定目标**：识别运行Camaleon CMS且版本为2.9.0或更低的目标服务器的URL。此漏洞已在2.9.1及更高版本中修复。
4.  **准备凭证**：获取一个目标Camaleon CMS系统上的低权限用户账号的用户名和密码。此漏洞需要已认证的低权限用户才能执行提权操作。
5.  **执行POC**：在命令行中，导航到 `exp.py` 脚本所在的目录，并执行以下命令：`python3 exp.py http://target.example your_username your_password`。请将 `http://target.example` 替换为实际的Camaleon CMS基础URL，将 `your_username` 和 `your_password` 替换为准备好的低权限用户凭证。
6.  **验证**：脚本执行完毕后，如果攻击成功，之前提供的低权限用户账户的权限将被提升。攻击者可以尝试使用该账户重新登录Camaleon CMS，并验证是否能够访问管理员功能或执行只有管理员才能执行的操作，从而确认权限提升是否成功。

投毒风险分析：
对提供的 `exp.py` 脚本进行全面的代码审查后，评估其投毒风险为0%。该判断基于以下详细分析：
1.  **代码清晰透明**：脚本的代码结构非常清晰，变量命名直观，逻辑流程易于理解。没有发现任何形式的代码混淆、加密或打包，因此可以完全审查其功能。
2.  **依赖标准且常用库**：脚本仅使用了Python的内置模块（如 `sys`、`urllib.parse`、`re`）以及两个广泛用于Web开发和安全测试的第三方库：`requests`（用于HTTP通信）和 `beautifulsoup4`（用于HTML解析）。这些库都是业界认可的、经过严格安全审计的成熟项目，不会引入未知或可疑的外部依赖。
3.  **无恶意网络活动**：脚本的所有网络请求都明确指向用户通过命令行参数指定的目标Camaleon CMS实例。没有发现任何尝试连接其他外部服务器、下载恶意负载、或进行其他与漏洞利用目的无关的、可疑的通信行为。
4.  **无文件系统操作**：脚本代码中没有包含任何文件读取、写入、创建、删除等文件系统操作。这意味着脚本不会在执行过程中对本地系统或远程目标的文件系统造成任何未经授权的修改。
5.  **无系统命令执行**：脚本没有调用 `subprocess` 或 `os.system` 等函数来执行系统命令。其操作完全限制在HTTP通信和数据解析的范畴内。
6.  **功能与描述一致**：脚本的功能完全符合 `README.md` 中关于利用CVE-2025-2304权限提升漏洞的描述。没有发现任何隐藏的、与漏洞利用无关的恶意功能。
7.  **明确的免责声明**：`README.md` 中包含明确的免责声明，指出脚本仅用于教育目的，并强调用户应在获得授权后方可进行测试。这进一步表明了作者的意图是促进合法的安全研究。
综上所述，该POC脚本是一个干净、无害的漏洞验证工具，不包含任何投毒代码，可以安全地用于合法的安全测试和研究活动。

**项目地址:** https://github.com/advisories/GHSA-rp28-mvq3-wf8j

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
