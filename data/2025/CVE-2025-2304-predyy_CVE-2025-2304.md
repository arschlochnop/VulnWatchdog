## CVE-2025-2304 - Camaleon CMS 特权升级 (Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 特权升级 (Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 未指定

**影响版本:** < 2.9.1 (已在 2.9.0 版本中验证)

**利用条件:** 需要认证 (需具备有效用户凭据)

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

该POC提供了一个名为`exp.py`的Python脚本，旨在自动化利用CVE-2025-2304漏洞，该漏洞存在于Camaleon CMS中。这是一个通过Mass Assignment导致的特权升级漏洞。根据POC的`README.md`文件，该脚本已在Camaleon CMS 2.9.0版本上成功测试，表明其对受影响版本（小于2.9.1）的有效性。脚本的执行流程清晰且逻辑严谨：首先，它通过向`/admin/login`端点发送GET请求来获取登录页面，并从中提取`authenticity_token`（或CSRF令牌）。随后，它使用提供的低权限用户凭据（用户名和密码）以及获取到的令牌，向同一登录端点发起POST请求以完成用户认证。登录成功后，脚本的关键部分在于利用Mass Assignment。它构造一个PUT请求，目标是已认证用户的管理接口（`/admin/users/<user_id>`）。在此请求的数据中，恶意地加入了`user[roles_attributes][0][role_id]=1`参数。在Ruby on Rails（Camaleon CMS所基于的框架）中，如果开发者没有正确地过滤或限制参数，这种"Mass Assignment"机制允许攻击者通过单个请求修改多个模型属性，包括通常受保护的属性如用户角色。`role_id=1`通常代表管理员角色。脚本通过此操作尝试将当前用户的角色提升至管理员。最后，POC通过再次访问用户管理页面并解析HTML来验证权限升级是否成功，从而确认漏洞是否被有效利用。整个过程完全自动化，代码结构良好，易于理解，且仅使用了标准Python库（`requests`、`bs4`等），进一步证实了其作为有效概念验证工具的可靠性。

**利用步骤**：
1.  **目标识别**: 确定运行Camaleon CMS且版本低于2.9.1的目标系统。
2.  **凭据获取**: 获取目标CMS上一个已注册的低权限用户账户的用户名和密码。
3.  **POC获取**: 将提供的`exp.py`脚本保存到本地机器。
4.  **环境配置**: 确保本地系统安装了Python 3及必要的库：`requests`和`beautifulsoup4`。若未安装，可通过`pip install requests beautifulsoup4`进行安装。
5.  **执行攻击**: 打开终端，导航到`exp.py`所在目录，并执行命令：`python3 exp.py <目标CMS的基础URL> <低权限用户名> <低权限密码>`。例如：`python3 exp.py http://example.com john Password123!`。
6.  **结果验证**: 脚本执行后将输出权限升级的结果。若成功，脚本会提示指定用户已被提升为管理员，此时可尝试使用该账户登录管理后台验证高权限功能。

**投毒风险分析**：
在防御性安全研究的背景下，对提供的POC代码的投毒风险进行了深入分析。结果表明，该`exp.py`脚本的投毒风险评估为0%。主要基于以下观察：
1.  **代码透明性**: 脚本代码完全可读，没有使用任何形式的代码混淆技术。其逻辑清晰地展示了漏洞利用的步骤，即登录、通过Mass Assignment修改用户角色、然后验证。
2.  **库依赖**: 脚本仅依赖于Python的标准库以及广泛使用的第三方库`requests`（用于HTTP请求）和`beautifulsoup4`（用于HTML解析）。这些库都是业界公认安全且被广泛信赖的。脚本中没有发现引入任何不明来源或可疑的外部模块或代码片段。
3.  **行为分析**: 脚本的网络活动仅限于与目标Camaleon CMS实例进行HTTP/HTTPS通信，以完成登录、权限提升尝试和验证。没有证据表明它会连接到任何第三方服务器、C2服务器，或进行其他异常的网络请求。
4.  **系统交互**: 脚本不涉及任何文件系统操作（如创建、修改或删除文件）、注册表修改或执行任意系统命令。它的作用域严格限制在通过HTTP协议与Web应用程序的交互。
5.  **免责声明**: `README.md`中包含明确的免责声明，指出脚本仅用于教育目的，并强调了在测试前获取授权的重要性。这进一步降低了其被设计为恶意工具的可能性。
综上所述，该POC代码在设计和实现上均未表现出任何恶意特征或潜在的投毒风险。它是一个纯粹用于演示和验证特定漏洞的工具，可以安全地用于合法的安全研究和测试活动。

**项目地址:** 未公开指定

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
