## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** AppRouter + RSC (版本未知，需检测)

**利用条件:** 无需任何权限，只需要一次特制请求

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478是一个影响Next.js应用程序的远程代码执行（RCE）漏洞，特别是在使用App Router和React Server Components（RSC）时。根据披露的信息，该漏洞的危险等级被评为CVSS 10.0，表明其严重性极高。这意味着攻击者几乎不需要任何权限，只需发送一个特制的请求，就可能在服务器上执行任意代码。该漏洞类似于前端圈的log4j漏洞，可见其危害之大。

POC有效性分析：提供的POC代码是一个命令行扫描器，用于检测Next.js应用程序是否受到CVE-2025-66478漏洞的影响。该扫描器通过发送特定的HTTP请求来检测目标应用程序的版本，并判断该版本是否存在漏洞。它并不直接利用该漏洞，而是用于识别易受攻击的目标。扫描器使用go语言编写，通过go-rod库自动下载chrome/chromium浏览器，模拟浏览器行为，从而应对一些反爬机制，具有一定的实用性。POC的质量评分为8/10，因为它提供了一个相对完整的概念验证工具，但缺少实际的漏洞利用代码。

利用步骤：
1.  使用提供的扫描器（nextjs-scanner）扫描目标Next.js应用程序。
2.  如果扫描器检测到目标应用程序易受CVE-2025-66478攻击，则需要进一步研究漏洞的利用方法。由于POC只提供了漏洞检测功能，因此需要查找或自行开发漏洞利用代码，才能真正实现远程代码执行。
3.  根据找到的漏洞利用方法，构造恶意请求，并将其发送到目标应用程序。该恶意请求可能包含恶意的JavaScript代码，当服务器处理该请求时，会执行该代码，从而导致远程代码执行。
4.  如果利用成功，攻击者可以在服务器上执行任意命令，例如，安装后门程序、窃取敏感数据或篡改网站内容。

投毒风险分析：
该POC主要是一个扫描工具，用于检测目标是否存在漏洞，本身不包含恶意代码，因此投毒风险较低。但是，如果攻击者修改了扫描器代码，添加了恶意功能，例如，在扫描过程中收集目标信息或植入后门，则会增加投毒风险。因此，在使用该POC时，务必检查代码的完整性和安全性。

该POC的投毒风险评分为10%。理由是该POC本身不具有直接的攻击性，主要功能是扫描，虽然存在被修改后用于恶意用途的可能性，但是原始代码较为清晰，依赖的也是标准库和go-rod，没有发现可疑行为。

**项目地址:** https://github.com/Malayke/Next.js-RSC-RCE-Scanner-CVE-2025-66478

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478
