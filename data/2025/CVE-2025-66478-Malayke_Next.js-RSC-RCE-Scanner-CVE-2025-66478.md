## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** AppRouter + RSC (具体版本未知，需检测)

**利用条件:** 无需认证，一次特制请求

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478是一个存在于Next.js应用程序中的远程代码执行（RCE）漏洞，特别是在使用AppRouter和RSC配置时。根据搜索结果，该漏洞的CVSS评分为10.0，属于最高危级别，攻击者仅需发送一个特制的请求就可以在服务器上执行任意代码。POC代码（nextjs-scanner）提供了一个命令行工具，用于批量检测Next.js应用程序的版本，并判断其是否受到CVE-2025-66478漏洞的影响。该工具通过自动化浏览器访问目标网站（使用go-rod），并执行`window.next.version`来检测Next.js版本。该工具并未尝试利用漏洞本身，只是检测是否存在漏洞。

**POC有效性分析：**
该POC工具（nextjs-scanner）的有效性在于它可以快速批量检测目标系统是否存在受影响的Next.js版本。它通过模拟浏览器行为，获取页面的Next.js版本信息，并根据版本信息判断是否存在漏洞。使用 go-rod 库，可以模拟 Chrome/Chromium 浏览器，从而更真实地模拟用户环境。POC提供了详细的使用说明，包括如何构建程序、准备URL列表以及运行扫描。扫描结果清晰地展示了目标URL的状态、Next.js版本以及是否存在漏洞。

**利用步骤：**
1.  使用go build命令编译nextjs-scanner程序。
2.  创建urls.txt文件，并在其中添加要扫描的目标URL。
3.  运行nextjs-scanner程序，指定urls.txt文件作为输入。可以使用不同的参数来调整扫描的并发数和超时时间。
4.  分析输出结果，如果目标URL被标记为Vulnerable ⚠️，则表示该站点受到CVE-2025-66478漏洞的影响。

**投毒风险分析：**
该POC代码的投毒风险较低。代码使用标准的Go语言库，没有发现任何可疑的外部依赖或恶意行为。代码的主要功能是检测Next.js版本，没有尝试执行任何潜在的危险操作。唯一的风险点在于，攻击者可能会修改该代码，添加恶意功能，例如收集目标系统的信息或执行恶意代码。但原始代码本身是相对安全的，投毒风险较低，估计为10%。代码逻辑清晰，主要使用go-rod库进行页面访问和信息提取，没有使用eval等高危函数，降低了投毒风险。由于程序只进行检测，不进行利用，因此也降低了被用于恶意目的的风险。

根据以上分析，该POC工具的质量较高，可以有效地检测Next.js应用程序是否存在CVE-2025-66478漏洞，并且投毒风险较低。

**项目地址:** https://github.com/lincemorado97/CVE-2025-64446_CVE-2025-58034

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478
