## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** AppRouter + RSC架构下的所有版本

**利用条件:** 无需任何权限，只需发送特制请求。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478是一个存在于Next.js应用程序中的远程代码执行（RCE）漏洞。根据初步分析，该漏洞的危险等级被评为CVSS 10.0，是最高级别。这意味着攻击者几乎不需要任何权限，只需要发送一次特制的请求，就可能在受影响的服务器上执行任意代码。该漏洞主要影响使用了App Router和React Server Components (RSC) 的 Next.js 项目。由于这些项目默认处于风险之中，因此危害性极高。

POC代码分析：

POC代码是一个命令行扫描器，用于批量检测Next.js应用的版本，并判断它们是否受CVE-2025-66478漏洞影响。该扫描器本身不利用该漏洞。它通过向目标URL发送请求并分析响应来确定Next.js版本。然后，它将检测到的版本与已知受影响的版本进行比较，以确定该应用程序是否容易受到攻击。POC利用了go-rod库进行headless Chrome/Chromium浏览器操作，这允许它呈现JavaScript并与动态内容交互。

利用步骤：

1.  构建扫描器：`go build -o nextjs-scanner`
2.  准备URL列表：创建一个urls.txt文件，并将要扫描的目标URL添加到其中。
3.  运行扫描：`./nextjs-scanner -file urls.txt`
4.  分析输出：扫描器将输出一个表格，显示每个目标的HTTP状态代码、检测到的Next.js版本以及漏洞状态（Vulnerable、Not Vulnerable或Unknown）。

该工具可以指定并发级别，自定义超时，并以调试模式运行（显示浏览器界面）。扫描器会检测Next.js的版本，如果检测到受影响的版本，则报告为“Vulnerable”。该扫描器可以批量检测Next.js应用的版本，并判断它们是否受CVE-2025-66478漏洞影响。

投毒风险分析：

该POC代码的投毒风险较低。主要基于以下几点：

1.  代码清晰：POC代码主要使用Go语言编写，代码结构清晰，易于阅读和理解。
2.  标准库：POC代码主要使用Go语言的标准库以及go-rod库，没有发现使用第三方高风险库。
3.  无可疑行为：POC代码的功能是扫描Next.js应用的版本并检测漏洞，没有发现任何恶意行为，例如：文件读写、网络连接等。
4.  依赖可控：POC工具依赖Chrome/Chromium浏览器，但go-rod会自动下载，降低了用户手动引入恶意依赖的风险。

尽管如此，仍然存在一些潜在的风险：

1.  依赖劫持：攻击者可能通过篡改go.mod文件或利用Go Modules的漏洞来注入恶意依赖。
2.  go-rod风险：虽然go-rod是一个常用的库，但仍然存在被攻击者利用的风险。
3.  输出误导：攻击者可能修改扫描器的输出结果，将未受影响的应用程序标记为“Vulnerable”，从而误导用户。

由于该POC代码的功能相对简单，并且没有发现明显的恶意行为，因此可以认为其投毒风险较低，大约为10%。然而，在使用任何POC代码时，都应该保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** https://nextjs.org/blog/CVE-2025-66478

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478
