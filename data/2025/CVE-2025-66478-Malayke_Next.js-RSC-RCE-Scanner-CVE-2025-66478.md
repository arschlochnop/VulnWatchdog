## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** AppRouter+RSC (具体版本范围未知，需进一步分析)

**利用条件:** 无需任何权限，只需要一次特制请求

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478 是 Next.js 框架中的一个远程代码执行 (RCE) 漏洞，威胁等级被评为最高级别 CVSS 10.0。该漏洞存在于使用了 AppRouter 和 RSC (React Server Components) 的 Next.js 项目中。根据公开信息，攻击者可以通过发送一个特制的请求，在服务器上执行任意代码，而无需任何身份验证或特殊权限。这意味着攻击者可以完全控制受影响的服务器，从而导致数据泄露、服务中断或恶意代码植入等严重后果。

POC 验证分析：提供的 POC 代码是一个命令行扫描器，用于批量检测 Next.js 应用程序的版本，并确定它们是否受到 CVE-2025-66478 漏洞的影响。该扫描器通过发送 HTTP 请求并分析响应来识别 Next.js 版本，并根据版本信息判断是否存在漏洞。该 POC 包含详细的快速启动指南、使用示例、输出解释和常见问题解答。它支持高并发扫描、自定义超时和 GUI 调试模式，方便用户进行漏洞检测和验证。通过对目标 URL 列表进行扫描，工具能够识别易受攻击的 Next.js 应用程序。

利用步骤：
1. 准备包含目标 URL 的文件或直接指定 URL。
2. 运行 Next.js 扫描器，使用默认配置或自定义并发数、超时等参数。
3. 扫描器将发送 HTTP 请求并检测 Next.js 版本。
4. 如果检测到易受攻击的版本，扫描器将标记为“Vulnerable”。
5. 攻击者可以进一步利用该漏洞，通过构造恶意请求在服务器上执行任意代码。

投毒风险分析：虽然提供的 POC 代码本身看起来比较干净，主要功能是扫描和检测漏洞，但仍然存在一定的投毒风险。首先，`go build` 命令可能会引入恶意依赖项，如果攻击者能够控制构建环境，就可以在编译过程中注入恶意代码。其次，扫描器在发送 HTTP 请求时，可能会携带一些敏感信息，例如用户代理、Referer 等，攻击者可以利用这些信息进行进一步的攻击。最后，如果扫描器的输出被重定向到文件或管道，攻击者可能会篡改输出结果，从而误导用户。该POC代码主要使用Go标准库，代码可读性高，功能较为集中，主要为RCE漏洞的扫描和验证，没有发现明显恶意行为，因此投毒风险较低，预估为10%。

**项目地址:** https://github.com/ThumpBo/CVE-2025-30208-EXP (关联CVE-2025-30208, 作为参考)

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478
