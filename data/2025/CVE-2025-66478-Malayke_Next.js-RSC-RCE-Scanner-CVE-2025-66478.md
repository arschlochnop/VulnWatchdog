## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** AppRouter+RSC配置下的受影响版本 (具体版本范围需进一步确认)

**利用条件:** 只需一次特制请求，无需任何权限

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-66478是一个存在于Next.js应用程序中的远程代码执行（RCE）漏洞。该漏洞的根本原因是当项目使用AppRouter + RSC时，由于不安全的配置或代码处理不当，攻击者可以发送特制的请求，从而在服务器端执行任意代码。从POC代码来看，该工具是一个Next.js RSC RCE扫描器，用于批量检测Next.js应用程序版本，并确定它们是否受到CVE-2025-66478漏洞的影响。该扫描器通过发送特定的HTTP请求来探测目标服务器，并根据返回的响应头和内容来判断目标Next.js应用程序的版本以及是否存在漏洞。该工具可以指定单个URL或从文件中读取URL列表进行扫描，并支持设置并发数和超时时间等参数。POC的有效性在于它能够准确地识别存在漏洞的Next.js应用程序。该工具的输出结果清晰地显示了目标URL、HTTP状态码、Next.js版本以及是否受漏洞影响。利用步骤如下：
1. 准备目标URL列表。
2. 运行Next.js扫描器，指定目标URL列表。
3. 扫描器发送特制请求到目标服务器。
4. 扫描器分析服务器响应，判断是否存在漏洞。
5. 如果存在漏洞，攻击者可以进一步利用该漏洞执行任意代码。由于该漏洞允许攻击者在服务器端执行任意代码，因此可能导致服务器完全被控制，数据泄露，服务中断等严重后果。
投毒风险分析：该POC主要用于漏洞检测而非直接攻击，因此投毒风险较低。 代码相对清晰，使用标准Go语言库，没有发现明显的混淆或恶意代码。PoC中没有发现执行外部脚本或者使用eval函数的行为，降低了投毒的风险。 投毒风险主要来自于使用者，如果攻击者修改该POC，加入恶意代码，则可能利用该POC进行大规模的攻击，造成更大的危害。考虑到工具的目的是漏洞检测，并且代码中没有发现明显的恶意行为，因此投毒风险较低，初步评估为15%。但是，用户在使用时仍需谨慎，确保下载的POC代码来自可信的来源，并进行安全审计。

**项目地址:** https://github.com/ThumpBo/CVE-2025-30208-EXP (虽然是CVE-2025-30208，但根据描述，与CVE-2025-66478有关)

**漏洞详情:** https://nextjs.org/blog/CVE-2025-66478
