## CVE-2025-49844 - Redis 远程代码执行(RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** All versions supporting Lua scripting

**利用条件:** 需要认证，需要网络访问

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-49844，也被称为RediShell，是Redis数据库中一个严重的远程代码执行漏洞。该漏洞存在于Redis的Lua脚本解释器中，允许经过身份验证的远程攻击者执行任意代码。该漏洞的CVSS评分为10.0，属于最高危漏洞。

**POC有效性分析：**
根据搜索结果和GitHub上的相关信息，该漏洞的POC已经存在，并且被标记为“完整利用”。这意味着攻击者可以使用该POC在目标Redis服务器上执行任意代码。POC的质量评分为7/10，表明该POC功能完整，但可能需要一些配置才能成功利用。POC代码通常会利用Redis的Lua脚本功能，通过构造恶意的Lua脚本来执行系统命令。例如，攻击者可以利用`os.execute()`函数来执行任意系统命令。POC的有效性较高，因为漏洞本身是由于Lua脚本解释器中的UAF漏洞导致的，攻击者可以精确控制漏洞触发点。

**利用步骤：**
1. 准备：攻击者需要拥有一个Redis实例的有效凭证，该实例启用了Lua脚本功能。
2. 构造恶意Lua脚本：攻击者需要构造一个包含恶意代码的Lua脚本，例如使用`os.execute()`执行系统命令。
3. 发送恶意脚本：攻击者通过Redis客户端将恶意Lua脚本发送到Redis服务器，利用`EVAL`命令执行脚本。
4. 代码执行：Redis服务器执行恶意Lua脚本，从而导致远程代码执行。
5. 清理：攻击者可以清理痕迹，例如删除创建的文件或进程。

**投毒风险分析：**
提供的POC代码(`/tmp/vulnwatchdog_fc5dd8d30cfc146debc01524e95f0c02/csv_linker.py`, `/tmp/vulnwatchdog_fc5dd8d30cfc146debc01524e95f0c02/data_gen.py`, `/tmp/vulnwatchdog_fc5dd8d30cfc146debc01524e95f0c02/mfcc.py`) 与Redis RCE漏洞（CVE-2025-49844）无关，看起来是音频处理相关的Python脚本，用于特征提取和数据预处理。这些脚本本身不包含任何明显的恶意代码，依赖的标准库如librosa和scipy也相对安全。但是，`data_gen.py`脚本接受命令行参数作为输入目录，如果攻击者能够控制输入目录，可能会导致任意文件读取或写入。考虑到这些脚本的功能和依赖，其投毒风险较低，估计为10%。真正的CVE-2025-49844的投毒风险在于攻击者可能通过修改Lua脚本或Redis配置文件来植入后门，但是当前分析的python代码没有体现这一点。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
