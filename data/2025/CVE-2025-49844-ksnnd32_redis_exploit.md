## CVE-2025-49844 - Redis 远程代码执行(RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Redis

**危害等级:** 严重

**CVSS评分:** 10.0 (Critical)

**影响版本:** 未知，所有受Lua脚本影响的版本

**利用条件:** 需要经过身份验证的低权限或以上用户权限

**POC 可用性:** 7/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 30%

## 详情

CVE-2025-49844 是 Redis 数据库中 Lua 脚本引擎存在的一个远程代码执行漏洞。经过身份验证的攻击者可以通过 Lua 脚本触发释放后重用 (Use-After-Free) 漏洞，从而在 Redis 服务器上执行任意代码。根据搜索结果，该漏洞的 CVSS 评分为 10.0，表明其严重性为“严重”。

POC 代码分析表明，存在一个名为 "RediShell" 的利用程序，声称可以利用此漏洞。虽然提供的代码片段主要集中在音频特征提取上，与漏洞本身关系不大，但根据搜索结果，可以推断利用过程涉及向 Redis 服务器发送特制的 Lua 脚本。这些脚本可能利用 Lua 解释器中的 Use-After-Free 漏洞，允许攻击者覆盖内存并执行恶意代码。

利用步骤可能如下：
1.  攻击者首先需要拥有 Redis 服务器的有效身份验证凭据。
2.  攻击者构造一个恶意的 Lua 脚本，该脚本利用 Use-After-Free 漏洞。
3.  攻击者使用 Redis 客户端将恶意脚本发送到 Redis 服务器。
4.  Redis 服务器执行该脚本，导致漏洞触发。
5.  攻击者在服务器上执行任意代码，可能导致数据泄露、服务中断或完全系统控制。

提供的 Python 脚本片段涉及音频处理，包括计算梅尔频率倒谱系数 (MFCC)。这些脚本本身似乎与 Redis 漏洞无关，更可能是用于生成训练数据或进行音频分析。然而，如果这些脚本被整合到攻击链中，它们可能被用作攻击 Redis 服务器的辅助手段，例如，通过生成用于触发漏洞的特定数据模式。csv_linker.py 和 data_gen.py 文件，结合 mfcc.py 文件，用于从音频文件生成特征数据。攻击者可能使用这些脚本来生成特定的输入，以触发 Redis 服务器上的漏洞，或者作为漏洞利用的一部分，将恶意代码嵌入到音频特征中。

投毒风险分析：
此漏洞的投毒风险评估为 30%。原因是尽管公开可用的 POC 利用的是 Use-After-Free 漏洞，但攻击者可能会尝试通过修改 Lua 脚本或 Redis 配置来引入恶意功能。虽然提供的 POC 代码片段本身不包含明显的恶意代码，但 Lua 脚本的灵活性允许攻击者在执行过程中注入恶意指令。此外，攻击者可能会试图通过将 Redis 配置更改为允许执行不安全操作（例如，加载外部库）来毒害系统。考虑到攻击者可以通过 Lua 脚本执行任意代码，因此存在通过此漏洞引入后门的风险。

例如，攻击者可以修改 Lua 脚本以包含下载和执行任意代码的指令。他们还可以尝试修改 Redis 的配置文件以允许加载恶意模块。因此，必须对通过此漏洞执行的任何 Lua 脚本进行仔细审查，并严格控制 Redis 服务器的访问权限，以缓解潜在的投毒风险。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
