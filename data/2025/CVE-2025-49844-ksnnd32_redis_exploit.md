## CVE-2025-49844 - Redis 远程代码执行

**漏洞编号:** CVE-2025-49844

**漏洞类型:** 远程代码执行

**影响应用:** Redis

**危害等级:** 严重

**CVSS评分:** 10.0 (Critical)

**影响版本:** 所有版本

**利用条件:** 需要认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-49844是Redis数据库中Lua脚本引擎的一个严重的use-after-free漏洞，可能允许经过身份验证的远程攻击者执行任意代码。该漏洞的CVSS评分为10.0，表明其具有最高的严重性。 根据搜索结果，多个来源都证实了该漏洞的存在，包括Redis官方的安全公告、厦门大学信息与网络中心的安全通报以及安全研究人员的PoC代码（RediShell）。

POC有效性分析：
名为RediShell的PoC代码是由raminfp在GitHub上发布的。该PoC利用了Redis的Lua脚本引擎中的use-after-free漏洞。成功利用此漏洞可以允许经过身份验证的攻击者在Redis服务器上执行任意代码。 由于该漏洞存在于Lua脚本引擎中，攻击者可以利用特制的Lua脚本来触发use-after-free条件，从而获得对Redis服务器的控制权。

利用步骤：
1. 攻击者需要拥有对Redis服务器的有效身份验证凭据。
2. 攻击者构造一个恶意的Lua脚本，该脚本旨在触发Lua脚本引擎中的use-after-free漏洞。
3. 攻击者将构造的恶意Lua脚本发送到Redis服务器执行。
4. 如果利用成功，攻击者将在Redis服务器上获得远程代码执行权限，从而能够执行任意系统命令。

投毒风险分析：
提供的Python代码片段似乎与漏洞利用无关。这些Python脚本用于处理音频数据和生成MFCC特征，这是一种常见的音频处理技术。这些脚本本身不包含任何恶意代码，并且其功能是明确的。然而，在实际的攻击场景中，攻击者可能会尝试将恶意代码注入到通过Redis存储或处理的数据中。例如，攻击者可能会将包含恶意JavaScript代码的字符串存储在Redis中，如果应用程序在没有适当清理的情况下将这些字符串输出到Web页面，则可能导致跨站点脚本攻击（XSS）。此外，如果Redis用于存储或处理可执行文件，攻击者可能会尝试替换这些文件为恶意版本。考虑到漏洞利用本身是远程代码执行，投毒风险较低。攻击者已经控制服务器，进一步投毒的意义不大。

综合来看，此漏洞威胁等级高，但PoC明确且投毒风险低。组织应尽快升级Redis版本或应用官方提供的补丁。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
