## CVE-2025-49844 - Redis RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 所有支持Lua脚本的Redis版本

**利用条件:** 经过身份验证的远程攻击者

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-49844，又名RediShell，是Redis数据库中一个严重的远程代码执行（RCE）漏洞。该漏洞存在于Redis的Lua脚本解释器中，允许经过身份验证的远程攻击者执行任意代码。该漏洞的CVSS评分为10.0，表明其具有最高的严重性。漏洞影响所有支持Lua脚本的Redis版本。

POC有效性分析：根据搜索结果，存在公开可用的POC代码，例如GitHub上的“redis_exploit”项目。这些POC旨在利用Redis Lua脚本执行功能中的UAF漏洞实现远程代码执行。通过分析POC代码，可以确认该漏洞的利用方式是向Redis服务器发送特制的Lua脚本，该脚本能够触发UAF漏洞，进而允许攻击者执行任意系统命令。CSDN等技术社区也提供了关于该漏洞的分析和重现资源，进一步验证了POC的有效性。代码分析显示，POC利用了Redis中Lua脚本执行的缺陷，通过精心构造的输入触发内存错误，最终实现RCE。给定的Python脚本csv_linker.py, data_gen.py, mfcc.py 看起来与此CVE无关, 可能是其他漏洞或者项目的一部分，因此不作为主要分析对象。

利用步骤：
1. 攻击者需要具有对Redis服务器的身份验证访问权限。
2. 攻击者构造一个恶意的Lua脚本，该脚本利用Redis Lua脚本解释器中的UAF漏洞。
3. 攻击者将恶意Lua脚本发送到Redis服务器。
4. Redis服务器执行该脚本，触发UAF漏洞，并允许攻击者执行任意代码。
5. 攻击者可以利用执行的任意代码来控制Redis服务器，并可能进一步入侵其他系统。

投毒风险分析：虽然提供的POC代码（csv_linker.py, data_gen.py, mfcc.py）本身没有明显的恶意行为，但是利用Redis RCE漏洞进行投毒的风险仍然存在。例如，攻击者可以利用RCE漏洞在Redis服务器上安装后门程序，或者修改Redis配置文件以允许未经授权的访问。这种攻击可以通过多种方式进行，例如：
1.  植入恶意Lua脚本：攻击者可以利用RCE漏洞执行Lua脚本，该脚本会下载并执行恶意代码。
2.  修改Redis配置文件：攻击者可以修改Redis配置文件（例如redis.conf），以允许未经授权的访问或禁用安全功能。
3.  安装后门程序：攻击者可以利用RCE漏洞在Redis服务器上安装后门程序，以便将来进行未经授权的访问。
由于原始的Redis程序和Lua脚本本身可能被用于恶意目的（例如，数据窃取、拒绝服务攻击等），因此存在一定的投毒风险。然而，考虑到提供的POC代码主要集中在漏洞利用本身，并且没有直接执行恶意操作，因此投毒风险较低，大约为15%。

**项目地址:** https://github.com/raminfp/redis_exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
