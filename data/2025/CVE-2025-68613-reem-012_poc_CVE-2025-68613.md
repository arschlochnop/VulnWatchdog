## CVE-2025-68613 - n8n (工作流自动化平台) RCE (沙箱逃逸)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (沙箱逃逸)

**影响应用:** n8n (工作流自动化平台)

**危害等级:** CRITICAL

**CVSS评分:** 9.9

**影响版本:** 0.211.0 ≤ n8n < 1.120.4, n8n < 1.121.1, n8n < 1.122.0

**利用条件:** 需要具有工作流编辑权限的认证用户，默认配置即可触发。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞属于高危的沙箱逃逸漏洞。在n8n的表达式编辑器中，虽然系统尝试使用内部沙箱环境限制JavaScript的执行权限，但CVE-2025-68613揭示了攻击者可以通过访问全局对象中的特定属性（如this.process）来绕过这些限制。POC代码展示了三种递进的利用方式：首先通过访问process.env泄露环境变量，这能获取到敏感的API密钥或凭据；其次通过process.mainModule.require引入child_process模块，这直接突破了沙箱，允许执行系统级命令。经分析，该POC结构完整，包含了环境搭建指导（Docker命令）和详细的Payload，能够稳定复现漏洞，具备极高的实战参考价值。漏洞利用的关键点在于n8n在处理表达式注入时未对主模块及其关联对象的递归属性进行严格过滤。利用步骤：1. 启动版本低于1.122.0的n8n容器实例；2. 登录Web界面并创建一个新的工作流；3. 添加一个Set节点或其他支持表达式的节点；4. 将参数输入类型切换为'Expression'；5. 填入特定的JavaScript自执行函数Payload，利用this.process.mainModule.require('child_process').execSync()执行任意系统指令。投毒风险分析：该POC代码逻辑透明，直接使用了标准的Node.js API进行演示，未发现混淆代码或隐蔽的外部连接请求。Payload部分清晰展示了攻击意图，包括环境变量读取和命令执行，没有集成任何恶意的自动化后门植入脚本。然而，鉴于该漏洞CVSS评分高达9.9且n8n在企业自动化流程中具有高权限，该POC极易被武器化。由于n8n用户基数大，社区中流传的修改版POC可能被植入恶意的反弹Shell地址或自动感染脚本。目前提供的README文档和Payload属于标准的防御性安全研究范畴，低风险，但研究人员在从非官方渠道（如GitHub Gist或不明CSDN链接）获取相关变体POC时，应警惕Payload中是否包含经过Base64编码的可疑二进制执行块或指向第三方域名的curl/wget命令，防止在本地调试时被‘黑吃黑’。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-68613](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-68613)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
