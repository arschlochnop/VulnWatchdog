## CVE-2025-55182 - React Server Components, Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 高危 (Critical)

**CVSS评分:** 

**影响版本:** React Server Components及其相关框架 (如 Next.js, Shopify Hydrogen, Gatsby 5), 尤其影响 react-server-dom-we 组件

**利用条件:** 无需认证, 通过网络可达 (未认证远程代码执行)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，又被称为React2Shell，是一个影响React Server Components (RSC) 的高危远程代码执行（RCE）漏洞，该漏洞已被多家安全厂商和研究机构评定为“核弹级”威胁，因为它影响范围广泛、攻击门槛低且危害程度极高。其核心问题源于React Flight反序列化机制在处理用户输入时未能正确校验对象属性访问路径，特别是对`__proto__`和`constructor`等原型链属性的访问。攻击者通过精心构造恶意的`multipart`表单请求，利用JavaScript的原型链污染特性，在服务端劫持特定对象的属性。具体而言，攻击者能够结合`$B`引用和一个可控的`_response._prefix`，将`_formData.get`属性动态地劫持为一个`Function`类型，并使该函数包含任意的系统命令。最终，当受影响的服务器组件处理此构造的请求时，这个被劫持的函数会被执行，从而在服务器上实现任意代码执行。这种攻击方式通常通过调用如`child_process.execSync()`等函数来执行操作系统命令。

**POC有效性分析:**
本分析中提供的POC代码，位于`exploit_react2shell.py`，是一个功能完备、易于使用的Python脚本，其有效性体现在以下几个方面：首先，该POC清晰地展示了如何利用上述原型链污染和反序列化漏洞。它通过构建一个特制的HTTP `multipart/form-data`请求来传递恶意载荷。这个载荷在服务器端被反序列化时，会触发漏洞，修改React内部组件对象的原型链，最终导致`child_process.execSync()`被调用，执行攻击者指定的任意系统命令。其次，POC的实现细节表明其具备很高的可靠性和可用性。它采用纯Python标准库实现，不依赖外部第三方库，这增加了其在不同环境下的兼容性。脚本支持HTTP和HTTPS两种协议，通过`ssl`模块实现安全的TLS连接，能够适应各种目标部署环境。此外，它还具备智能URL解析功能，可以自动检测协议并处理端口。再者，POC的用户体验设计也考虑周全。它包含了一个`Loader`类，在接收服务器响应时显示动画加载器，提升了交互性。最关键的是，该脚本能够自动提取并显示目标命令的执行结果。这意味着攻击者不仅可以执行命令，还能实时获取命令输出，从而实现完整的远程控制，验证了RCE的成功利用。`README.md`文件也为POC提供了详细的使用指南，包括克隆、运行和使用示例，进一步确认了这是一个开箱即用的完整利用工具。其清晰的结构和功能使其成为一个高质量的漏洞利用验证工具。

**利用步骤:**
利用CVE-2025-55182的POC步骤如下：
1.  **克隆POC仓库**: 首先，需要通过Git克隆POC代码仓库到本地系统。
    ```bash
    git clone https://github.com/BrianLopezM99/react2shell-CVE-2025-55182.git
    ```
2.  **进入POC目录**: 进入新克隆的`react2shell-CVE-2025-55182`目录。
    ```bash
    cd react2shell-CVE-2025-55182
    ```
3.  **执行漏洞利用**: 使用Python 3运行`exploit_react2shell.py`脚本，并提供目标URL和要执行的系统命令。
    *   **针对HTTP目标**:
        ```bash
        python3 exploit_react2shell.py http://target.com:3000 "id"
        ```
        或者
        ```bash
        python3 exploit_react2shell.py 192.168.1.100:8080 "ls -la"
        ```
    *   **针对HTTPS目标**:
        ```bash
        python3 exploit_react2shell.py https://target.com "whoami"
        ```
        或者
        ```bash
        python3 exploit_react2shell.py https://target.com:8443 "cat /etc/passwd"
        ```
    脚本将尝试连接目标服务器，发送精心构造的Payload，执行指定命令，并打印命令的输出结果。

**投毒风险分析:**
针对CVE-2025-55182的POC代码（`exploit_react2shell.py`）及配套的`README.md`文件，经分析，其作为投毒代码的风险评估为**极低（10%）**。以下是详细的风险分析：

1.  **明确的声明与用途**:
    `README.md`中包含明确的法律声明和用途说明：“For authorized security testing only.”和“Educational purposes only.”。这些声明清晰地指明了该工具的预期用途是合法的安全测试和教育研究，而非用于非法活动。这种透明度是判断工具性质的重要依据。工具的命名“React2Shell Exploit”也直接指明了其功能是漏洞利用，而非伪装成其他软件。

2.  **代码的透明度与可读性**:
    从提供的POC代码片段来看，其结构清晰，使用了标准的Python语法和库函数。例如，`Loader`类用于显示动画，`socket`和`ssl`模块用于网络通信，`urlparse`用于URL解析。这些都是常见的、无害的编程实践。代码逻辑专注于漏洞利用的核心机制：构建HTTP请求头、创建`multipart/form-data`体、发送Payload、处理服务器响应以提取命令输出。整个流程都是围绕漏洞验证和利用展开的，没有发现任何与恶意软件行为相关的额外或隐藏功能。

3.  **无外部依赖性**:
    `README.md`中明确指出“No external dependencies”除Python 3.6+外。这意味着该POC在运行时不会从互联网上下载或引入任何第三方库或脚本。许多恶意软件会通过引入外部依赖来加载恶意组件或实现C2通信，该POC缺乏此类行为，大大降低了通过供应链攻击引入恶意代码的风险。所有操作都基于Python内置功能，这使得代码的审计和理解变得更加容易和可靠。

4.  **行为模式的局限性**:
    该POC的行为模式完全符合一个漏洞利用工具的预期：它连接到指定目标，发送一个恶意的HTTP请求，并尝试从响应中解析命令执行结果。它不包含例如：数据窃取、持久化机制、C2通信等典型的恶意软件行为。此外，代码没有进行混淆处理，所有字符串和逻辑都是明文可见的，这与恶意软件通常试图隐藏其意图的做法相反。

5.  **总结**:
    综合以上分析，该POC代码表现出高度的透明度、功能单一性、无额外恶意行为以及明确的合法用途声明。它是一个专注于验证和研究特定漏洞的专业工具。因此，将其误判为投毒代码的风险极低，用户在遵循其授权和教育目的的前提下，可以安全地使用和研究该POC。

**项目地址:** https://github.com/BrianLopezM99/react2shell-CVE-2025-55182.git

**漏洞详情:** 
