# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

# CVE-2025-6019

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md](../2025/CVE-2025-6019-And-oss_CVE-2025-6019-exploit.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks2

**危害等级:** 高危，攻击者可以从低权限用户提升至root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10

**利用条件:** 需要本地访问，并且用户拥有Polkit中"allow_active"权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6019是libblockdev中的一个本地权限提升漏洞。利用方式是攻击者可以创建一个特制的XFS镜像，该镜像包含一个SUID-root的shell。然后，通过udisks2的DBus接口调用Resize方法来调整该镜像的大小。由于udisks2在挂载用户提供的文件系统镜像时，通常会设置nosuid和nodev等安全标志以防止权限提升，但是该漏洞允许攻击者绕过这些安全措施。攻击者通过利用文件系统调整大小过程中的竞争条件，使得udisks2以root权限挂载恶意镜像，从而允许攻击者执行SUID-root shell并获得完整的系统控制权。

利用步骤如下：
1.  **创建恶意镜像:** 攻击者使用`dd`创建一个XFS镜像，然后使用`mkfs.xfs`格式化该镜像。接着，将该镜像挂载到本地目录，并将`/bin/bash`复制到该挂载点，然后设置SUID权限。最后卸载该镜像。
2.  **利用漏洞:**
    *   杀死可能干扰的`gvfs-udisks2-volume-monitor`进程。
    *   使用`udisksctl loop-setup`命令设置loop设备指向恶意镜像。
    *   启动一个后台进程，不断检查`/tmp/blockdev*/bash`是否存在，一旦存在则退出（利用竞争条件）。
    *   使用`gdbus call`调用`org.freedesktop.UDisks2.Filesystem.Resize`方法，触发漏洞。
    *   等待一段时间后，找到`/tmp/blockdev*`目录，如果其中存在SUID-root的bash，则执行它以获取root权限。

**关于投毒风险的分析：**
*   **代码分析：** POC代码主要由两部分组成：创建恶意镜像的函数`create_suid_image()`和执行漏洞利用的函数`exploit_system()`。代码本身相对简洁，没有明显的恶意代码。
*   **潜在风险：** 主要的风险在于创建镜像的过程中，虽然代码复制了`/bin/bash`，并设置了SUID权限。但恶意攻击者可以在创建镜像的过程中，复制其他具有后门的程序，并设置SUID权限。
*   **判断：**  代码中没有明显的恶意行为，但存在替换`/bin/bash`为包含后门的程序的风险。考虑到这个风险，我将其判定为存在一定的投毒风险（5%）。这个风险来自于使用者可能没有仔细审查创建镜像的步骤，从而引入了额外的安全问题。

**有效性分析：**根据漏洞信息，搜索结果，以及POC代码，可以判断，POC代码有效，可以进行本地提权。

**排序优先级：**搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [And-oss/CVE-2025-6019-exploit](https://github.com/And-oss/CVE-2025-6019-exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---



---

## POC #2

**来源**: [CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md](../2025/CVE-2025-6019-dreysanox_CVE-2025-6019_Poc.md)

## CVE-2025-6019-libblockdev-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** libblockdev (通过 udisks)

**危害等级:** 高危，攻击者可以从 allow_active 用户权限提升到 root 权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10 受影响

**利用条件:** 需要本地访问权限，且Polkit配置允许 allow_active 用户进行某些操作

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-6019 是 libblockdev 中的一个本地权限提升漏洞。利用方式是，攻击者首先利用 Polkit 中 'allow_active' 设置允许的权限，然后通过构造恶意的 XFS 镜像，诱使 udisks 调整其大小。由于 udisks 在挂载用户提供的文件系统镜像时通常会设置 nosuid 和 nodev 等安全标志，但攻击者可以通过精心设计的 XFS 镜像包含 SUID-root shell，从而绕过这些安全措施。当 udisks 以 root 权限挂载这个恶意文件系统后，攻击者就可以执行 SUID-root shell 并获得 root 权限。

提供的 POC 代码 `poc2025-6019.py` 尝试利用与 CVE-2025-6018 相关的另一种提权方式，该方式依赖于 PAM 环境的污染，看起来与漏洞描述中的利用方式有所不同。

**有效性评估：**

提供的 POC 代码 `poc2025-6019.py` 并非直接利用 XFS 镜像的漏洞，而是尝试通过 PAM 环境污染利用 CVE-2025-6018 漏洞。该脚本首先通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018/6019 漏洞的前提条件（PAM 版本和配置），然后尝试通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。根据漏洞描述，CVE-2025-6019 的根本原因是恶意构造的 XFS 镜像绕过了 udisks 的安全机制。 因此，提供的 POC 利用的提权方式与漏洞描述并不完全相符，有效性存疑，可能需要目标系统同时存在 CVE-2025-6018 漏洞才能成功。

**投毒风险评估：**

代码中存在轻微的投毒风险，主要是由于脚本需要在目标主机上创建和修改文件。虽然脚本本身的目标是利用漏洞，但如果攻击者修改了脚本，例如在 `commands_sequence_1` 或 `commands_sequence_2` 中添加恶意命令，则可能在目标主机上执行任意代码。由于脚本需要 SSH 凭据才能运行，因此只有具有一定权限的用户才能利用此脚本进行攻击。投毒风险较低(约为1%)，因为代码本身较为简单，且主要是执行系统命令，不易隐藏恶意代码。主要风险在于脚本可能被修改以执行恶意命令。

**利用方式总结：**

1.  **CVE-2025-6019 (基于漏洞描述)：** 攻击者创建包含 SUID-root shell 的恶意 XFS 镜像，并诱使 udisks 以 root 权限挂载该镜像，从而执行 SUID-root shell 并获得 root 权限。
2.  **POC 代码 (`poc2025-6019.py`)：** 通过 SSH 连接到目标主机，检查是否存在 CVE-2025-6018 的前提条件，然后通过修改 `~/.pam_environment` 文件来污染 PAM 环境，最后检查是否成功提升权限。这是一种利用 PAM 配置不当的提权方式，与 CVE-2025-6019 的原始漏洞描述有所不同，更像是利用了 CVE-2025-6018 的方式。

**项目地址:** [dreysanox/CVE-2025-6019_Poc](https://github.com/dreysanox/CVE-2025-6019_Poc)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #3

**来源**: [CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md](../2025/CVE-2025-6019-guinea-offensive-security_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-udisks-本地提权

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** 受影响的Linux发行版和libblockdev版本未知，需要具体发行版信息

**利用条件:** 需要本地低权限用户权限，udisks服务运行

**POC 可用性:** 部分可用，提供的POC仅包含README.md文件，缺乏实际的漏洞利用代码

**投毒风险:** 10%

## 详情

CVE-2025-6019是libblockdev中的一个漏洞，通过udisks服务可以被利用，允许低权限本地用户提升到root权限。根据搜索结果，该漏洞影响多个Linux发行版，并且可能需要与其他漏洞（如CVE-2025-6018）结合利用。提供的POC代码仅包含一个README.md文件，缺乏实际的漏洞利用脚本，因此无法直接验证漏洞的有效性。 关于投毒风险，由于只提供了一个README.md文件，实际的投毒代码可能性较低，但依然不能完全排除作者未来添加恶意代码的可能。 该漏洞利用方式是通过udisks服务，利用libblockdev中的缺陷，使低权限用户执行特权操作，从而获得root权限。具体利用细节需要进一步的漏洞分析和利用代码。

**项目地址:** [guinea-offensive-security/CVE-2025-6019](https://github.com/guinea-offensive-security/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #4

**来源**: [CVE-2025-6019-harshitvarma05_CVE-2025-6019.md](../2025/CVE-2025-6019-harshitvarma05_CVE-2025-6019.md)

## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

## POC #5

**来源**: [CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md](../2025/CVE-2025-6019-neko205-mx_CVE-2025-6019_Exploit.md)

## CVE-2025-6019-libblockdev-udisks-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地提权

**影响应用:** libblockdev/udisks

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** Red Hat Enterprise Linux 7, 8, 9, 10 (可能影响其他Linux发行版)

**利用条件:** 需要本地用户具有 'allow_active' 权限，并且系统运行udisks daemon。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libblockdev与udisks交互过程中，利用方式如下：

1.  **漏洞描述：** CVE-2025-6019 允许具有 'allow_active' 权限的本地用户通过利用 udisks daemon 提升为 root 权限。攻击者可以创建一个特制的 XFS 镜像，其中包含一个 SUID-root shell，然后诱使 udisks 调整其大小。这将以 root 权限挂载恶意文件系统，从而允许攻击者执行 SUID-root shell 并获得对系统的完全控制。

2.  **利用方式：**
    *   攻击者首先使用`1.sh`脚本创建一个恶意的XFS镜像 (`xfs.image`)，并在其中包含一个 SUID-root shell。
    *   然后，攻击者将此镜像传输到目标系统。
    *   在目标系统上，攻击者运行`2.sh`脚本。
    *   `2.sh`脚本首先尝试使用`udisksctl loop-setup`将XFS镜像设置为loop设备。
    *   脚本通过`gdbus call`调用 UDisks2 的 `Resize` 方法，触发漏洞。udisks 可能会尝试在没有正确安全标志的情况下调整恶意镜像的大小，从而允许执行 SUID-root shell。
    *   脚本随后搜索并执行该 SUID-root shell，实现提权。

3.  **有效性：** 提供的POC代码看起来是有效的。`1.sh` 创建包含 SUID bash 的镜像， `2.sh` 利用 `udisksctl loop-setup` 挂载镜像，然后使用 `gdbus call` 调用 `Resize` 函数尝试触发漏洞，最后查找并执行 SUID bash。

4.  **投毒风险：** 该仓库中存在一定投毒风险（约10%）。`1.sh`脚本中没有明显的恶意代码，主要负责创建XFS镜像。`2.sh`脚本中的风险在于，攻击者可能会在while循环中执行其他恶意命令，而不是简单的 sleep。另外，攻击者也可以在创建的xfs.image中包含其他后门程序，在提权后执行。`README.md` 没有发现可疑之处。

5.  **缓解措施：** 更新 libblockdev 和 udisks2 软件包至已修复版本。

**项目地址:** [neko205-mx/CVE-2025-6019_Exploit](https://github.com/neko205-mx/CVE-2025-6019_Exploit)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)

---

