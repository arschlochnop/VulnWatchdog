## CVE-2025-55182 - React (react-server-dom-webpack), Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React (react-server-dom-webpack), Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 影响启用了 React Server Components (RSC) 和 Server Actions 的特定版本，具体涉及 react-server-dom-webpack 及其集成的 Next.js 框架

**利用条件:** 应用部署并启用了 React Server Components (RSC) 及 Server Actions 功能；攻击者需能发送特制的 HTTP 请求；通常无需身份验证

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为“React2Shell”，其核心在于 React Server Components (RSC) 在处理“Flight”协议数据时的不安全反序列化。根据提供的 POC 信息，漏洞利用了 JavaScript 的原型链污染 (Prototype Pollution) 和 Thenable 对象的特性。在 Next.js 的 Server Actions 流转中，服务器会对客户端提交的表单或 JSON 对象进行反序列化以重建数据对象。攻击者通过注入 `__proto__` 属性，能够污染全局对象原型。更关键的是，攻击者利用了 `constructor.constructor` 技巧获取到 `Function` 构造函数。通过将对象的 `then` 方法重写为恶意逻辑，当 Node.js 后端尝试 resolve 一个被污染的 Promise 或类 Promise 对象时，会触发执行攻击者定义的代码。POC 代码展示了如何通过简单的 HTTP 请求结构实现从 Web 应用层到系统 Shell 层的突破，具有极高的实战有效性。此利用方式不依赖于特定的业务逻辑，而是框架底层的解析缺陷，因此具有极强的通用性。

【利用步骤】1. 确定目标应用是否使用了 Next.js 且启用了 Server Actions 功能。2. 构造一个包含恶意原型污染载荷的 HTTP POST 请求，通常目标是 Server Action 的端点。3. 在载荷中利用 `__proto__` 注入恶意属性，并使用 `constructor.constructor("return process")().mainModule.require("child_process").execSync("id")` 等方式构建命令执行链。4. 发送请求，后端在反序列化并处理数据对象时触发恶意代码执行。5. 观察服务器响应或通过反弹 Shell 确认控制权。

【投毒风险分析】在安全研究领域，针对此类“核弹级”漏洞的 POC 往往是供应链投毒的高发区。目前分析显示，虽然公开的 README 和原理解析是透明的，但由于其利用涉及复杂的 JavaScript 内部机制（如 Promise 链、原型注入），非专业人员很难通过肉眼快速辨别混淆后的 payload。投毒风险主要体现在：1. 伪装成一键复现脚本：攻击者可能在 GitHub 等平台发布所谓的一键利用工具，内部通过 Base64 或 Hex 加密隐藏反连木马。2. 依赖项污染：由于该漏洞涉及 npm 生态，攻击者可能发布名称相似的恶意补丁包或检测工具包诱导管理员安装。3. 协作平台投毒：在 TryHackMe 等实验室或博客园等技术社区分享的 POC 中，若包含未经过滤的外部 JS 引用，可能导致研究员的本地环境被渗透。当前 POC 文档以教育和防御研究为主，代码逻辑清晰，但考虑到其极高的关注度，获取第三方工具时必须严格审计 `child_process`、`eval` 等敏感函数的调用，防止在测试过程中被反向控制。

**项目地址:** [https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/](https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
