## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** Gogs <= 0.13.2

**利用条件:** 需要认证，需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

该POC（概念验证）报告清晰且有效地演示了CVE-2025-8110在Gogs 0.13.2版本中的存在及可利用性。报告详细描述了在Docker环境中搭建易受攻击Gogs实例的步骤（提及`setup-gogs-vulnerable.sh`脚本），并完整记录了从创建恶意符号链接到实现远程代码执行（RCE）的利用过程。POC通过具体的命令行操作（`ln -s`、`git add/commit/push`、`curl -X PUT`）展示了攻击者如何利用Gogs在处理Git仓库文件操作时（特别是文件上传和在线编辑功能）符号链接过滤不当的漏洞。
验证过程分步进行，首先通过将符号链接指向`/tmp/pwned_marker`，成功证明了任意文件写入能力。随后，通过将符号链接指向`.git/config`文件并注入恶意`sshCommand`，成功篡改了Git配置。最终，通过模拟Git的SSH操作（`git ls-remote git@github`），触发了`sshCommand`中定义的任意命令执行（如`whoami > /tmp/hacked`）。报告通过`docker exec`命令直接验证了文件内容被成功修改以及RCE的发生，充分证明了POC的完整性和准确性。该POC质量极高，提供了复现漏洞所需的全部信息，具有很强的指导意义。

CVE-2025-8110的利用过程主要分为以下几个阶段：
1.  **环境准备与权限获取**: 攻击者需要一个Gogs实例的合法用户凭证，并拥有API Token。POC中使用了具有`admin`权限的用户，表明攻击者需具备已认证身份。
2.  **创建恶意符号链接**: 攻击者在其本地Git仓库中创建两个符号链接。第一个`malicious_link_abs`指向服务器上的任意路径（例如`/tmp/pwned_marker`），用于验证任意文件写入。第二个`link_to_config`指向目标Gogs仓库在服务器上的Git配置文件路径（例如`/data/git/gogs-repositories/attacker/test-repo.git/config`），这是实现RCE的关键。
3.  **推送恶意仓库**: 攻击者将包含这些恶意符号链接的本地仓库推送到Gogs服务器。由于Gogs对符号链接过滤不当，这些链接会被成功创建并存在于仓库中。
4.  **触发文件覆盖**: 攻击者利用已认证的Gogs `PutContents` API向这些符号链接写入数据。Gogs服务器会跟随符号链接，将数据写入到符号链接实际指向的仓库外部路径。
    *   **任意文件写入**: 向`malicious_link_abs`写入Base64编码的“PWNED”，服务器将其解码并写入`/tmp/pwned_marker`，验证了任意文件写入能力。
    *   **注入恶意Git配置**: 向`link_to_config`写入一个包含恶意`sshCommand`指令的Git配置文件内容（例如`sshCommand = "whoami > /tmp/hacked"`）。
5.  **触发远程代码执行**: 当Gogs服务器或任何通过SSH与该恶意仓库交互的进程（如`git fetch`或`git ls-remote git@github`）尝试执行涉及SSH的Git命令时，Git会读取被篡改的`.git/config`文件，并执行`sshCommand`中定义的恶意命令，从而实现远程代码执行。

此POC报告的投毒风险评估为**低** (约5%)。该风险评估主要基于以下几点：
首先，POC本身是一个**纯文本Markdown格式的报告**，不包含任何可直接执行的二进制文件、编译型程序或复杂的恶意脚本。它通过清晰的步骤和命令行示例来描述漏洞验证过程，这意味着所有操作都是透明且易于审查的。这种格式极大地降低了隐藏恶意代码或行为的可能性。
其次，报告中明确列出的所有命令，如`ln -s`、`git add/commit/push`、`curl`和`docker exec`，均为**标准且公开的系统工具**。`curl`命令的请求URL和JSON payload内容都清晰可见，没有经过任何混淆处理，直接与Gogs API进行合法交互。`git`命令用于正常的Git仓库操作，`docker exec`用于在Docker容器内部验证结果，这些都是符合预期的、无害的操作。
第三，尽管报告提及了`setup-gogs-vulnerable.sh`脚本用于环境搭建，这属于POC的外部依赖，而非POC报告本身的一部分。任何外部脚本都应谨慎对待，但在本例中，其明确旨在提供**受控的、易受攻击的测试环境**。用户在执行此类环境搭建脚本时，理应进行内容审查并在隔离环境中操作，但这不构成POC报告本身的投毒风险。
最后，报告中用于实现RCE的“恶意”部分是**注入到Gogs服务器上的Git配置文件中的`sshCommand`**。这是漏洞被利用的方式和攻击载荷，它作用于受害者服务器，而非POC报告本身携带的恶意组件。POC的目的是演示漏洞的利用机制，而不是通过POC文件来感染用户系统。
综上所述，该POC报告在代码透明度、所用工具的合法性以及缺乏隐藏执行机制方面表现出色，因此其作为恶意软件载体的直接投毒风险极低。用户在复现时应重点关注对目标Gogs实例可能造成的影响，而不是担心POC文件本身带来威胁。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
