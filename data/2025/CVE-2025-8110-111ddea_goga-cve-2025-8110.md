## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 严重

**CVSS评分:** 7.8

**影响版本:** Gogs <= 0.13.2

**利用条件:** 需要认证 (admin权限), 需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析:
该漏洞验证报告详细阐述了Gogs自托管Git服务中存在的CVE-2025-8110符号链接绕过远程代码执行漏洞。报告以Markdown格式提供，通过清晰的步骤和命令展示了如何利用Gogs在处理Git仓库文件操作（特别是通过API对文件内容进行更新）时未能正确过滤符号链接的缺陷。攻击者首先在本地Git仓库中创建恶意的符号链接，这些链接指向Gogs服务器上的敏感文件或目录之外的任意位置。例如，报告中演示了创建指向`/tmp/pwned_marker`的符号链接，以及更关键的，指向Git仓库自身`.git/config`文件的符号链接。这些恶意符号链接随后被推送到受影响的Gogs服务器。

漏洞的核心利用点在于Gogs的`PutContents` API。攻击者利用此API向之前创建的符号链接写入数据。由于Gogs未能在写入操作时正确解析并限制符号链接的解析范围，它会跟随符号链接将内容写入到符号链接所指向的任意文件路径。当攻击者将包含恶意`sshCommand`的Git配置内容写入到目标仓库的`.git/config`文件时，就为远程代码执行创造了条件。POC中具体演示了如何注入`sshCommand = "whoami > /tmp/hacked"`或`sshCommand = touch /tmp/pwned_rce_verified; /usr/bin/ssh`。一旦Gogs服务器（或管理员）对该仓库执行任何涉及网络的Git命令（如`git fetch`或`git clone`），Git客户端将解析其配置中的`sshCommand`并执行它，从而导致任意命令在服务器上以Gogs进程的权限执行。

验证报告还提供了明确的结果验证步骤，通过`docker exec`命令检查`/tmp/pwned_marker`文件是否被成功写入，以及`.git/config`文件是否已被篡改。这些步骤清晰地证实了漏洞的有效性，攻击者确实能够通过符号链接绕过实现任意文件写入，并最终通过修改Git配置实现远程代码执行。整个报告结构完整，逻辑严谨，命令可直接复现，表明这是一个高度可用和有效的POC。

利用步骤:
CVE-2025-8110的利用主要分为以下三个核心步骤：
1.  **准备恶意仓库:** 攻击者在本地初始化一个Git仓库，并在其中创建至少一个或多个恶意符号链接。这些符号链接被精心构造，使其在Gogs服务器上被解析时，指向仓库目录之外的任意敏感文件。例如，POC中创建了`malicious_link_abs`指向`/tmp/pwned_marker`用于测试任意文件写入，以及`link_to_config`指向目标Gogs仓库的`.git/config`文件，这是RCE的关键路径。
2.  **推送恶意仓库:** 攻击者需要拥有一个Gogs实例上的认证凭据（例如，`admin`权限和API Token）。通过正常的Git操作（`git add . && git commit -m "Add symlinks" && git push`），攻击者将包含这些恶意符号链接的仓库推送到Gogs服务器。此时，符号链接作为仓库文件的一部分被存储在服务器上。
3.  **触发文件覆盖与RCE:** 攻击者利用Gogs提供的`PutContents` API，向已推送到服务器的恶意符号链接写入内容。由于Gogs对符号链接的解析缺陷，API会跟随链接将数据写入到符号链接实际指向的服务器文件系统路径上。为了实现RCE，攻击者会向指向`.git/config`的符号链接注入包含恶意`sshCommand`字段的Git配置内容。一旦`config`文件被篡改，Gogs服务器或任何对该仓库执行Git网络操作（如`git fetch`、`git pull`）的用户，在执行这些命令时，Git客户端将自动执行`config`中定义的`sshCommand`，从而在服务器上执行任意代码，达成远程代码执行。

投毒风险分析:
提供的POC是一个详细的Markdown格式的漏洞验证报告，其核心目的是为了清晰地展示CVE-2025-8110漏洞的复现过程、利用方法和验证结果。根据安全研究领域的惯例，这类报告通常被设计为透明和可审计的，以帮助防御者理解漏洞机制并建立相应的防护措施。

从其内容来看，该POC不包含任何代码混淆、恶意外部链接或非标准的可疑组件。报告中演示的所有命令都是标准且普遍的`bash`、`git`和`curl`操作，这些操作被用于逻辑性地展示漏洞的利用流程，而不是作为恶意软件的载体。虽然报告内嵌了会导致远程代码执行的Git `sshCommand`配置内容，但这属于漏洞利用的“载荷”部分，是攻击者成功利用漏洞后在目标系统上执行的命令，而非POC报告文件本身携带的恶意代码。这份报告的创建者明确指出其为“漏洞验证报告”，其意图是进行防御性安全研究，旨在揭示漏洞原理以促进防护，而非传播恶意软件。

因此，将此POC报告文件（`CVE-2025-8110-verification-report.md`）本身视为投毒的风险极低，可以认定为0-29%的低风险范畴。报告没有引入任何外部脚本或二进制文件，所有操作都直接在报告文本中清晰可见。对于防御性安全研究员而言，这份报告是一个宝贵的学习资源，能够帮助他们深入理解Gogs的符号链接处理缺陷。用户在处理此类报告时，重要的是要关注报告中描述的“如何利用漏洞”的潜在威胁，并以此为基础加强自身系统的防御，而不是对报告文件本身的安全属性产生疑虑。只要严格遵循报告的防御性安全研究目的，不盲目执行未经理解的代码，并确保是在隔离环境中进行研究和复现，其投毒风险可以忽略不计。这份POC的清晰度和透明度是其低风险的决定性因素。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8110
