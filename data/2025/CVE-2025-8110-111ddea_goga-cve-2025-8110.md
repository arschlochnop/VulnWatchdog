## CVE-2025-8110 - Gogs (Go Git Service) RCE (远程代码执行)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Gogs (Go Git Service)

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** <= 0.13.2

**利用条件:** 需要经过身份验证的用户权限（拥有 API Token 或 Web UI 访问权限），且目标服务器允许文件写入操作。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞是针对CVE-2024-55947修复补丁的绕过利用。分析提供的POC代码可知，漏洞根源在于Gogs在处理Git仓库内容的API（如PutContents）时，未能对符号链接（Symbolic Link）进行严格的路径递归校验。攻击者通过向仓库推送一个指向服务器敏感文件（如仓库本身的.git/config）的符号链接，随后利用API对该链接进行内容写入。POC通过Base64编码的Payload成功将恶意配置注入到Git配置文件中。关键点在于利用了Git的sshCommand特性，通过覆盖仓库配置，将原本用于SSH连接的命令替换为任意系统命令。当服务器后续执行git fetch或git ls-remote等操作时，Git会自动调用sshCommand中定义的恶意脚本。经过验证，该POC在Docker环境下展示了完整的文件覆盖及后续命令触发流程，证明了漏洞的高效性与严重性。利用步骤：1. 攻击者首先在本地创建一个指向目标服务器绝对路径或仓库配置文件路径的符号链接（如ln -s /data/git/repos/user/repo.git/config link_to_config）。2. 将此符号链接推送到Gogs服务器上的指定仓库。3. 调用Gogs API v1的/contents/{filepath}接口，向该符号链接路径发送PUT请求。4. 在请求体中构造恶意Git配置内容，重点是设置[core]段下的sshCommand参数，例如包含反弹shell或文件写入命令。5. 通过Web界面或API触发仓库的同步、抓取等涉及网络的操作。6. Git执行相关操作时触发sshCommand，从而在服务器上下文执行攻击者预设的指令。投毒风险分析：该POC代码结构清晰，逻辑透明，主要由Shell脚本和标准的Git命令组成，不涉及混淆加密。其核心功能是利用Docker环境模拟受害者服务器并进行自我攻击验证，并未发现隐藏的外部服务器连接或未授权的数据外传逻辑。虽然POC中包含了touch /tmp/pwned_rce_verified和whoami等典型的验证性载荷，但这属于安全研究中的标准证明动作（Proof of Concept），不应被视为恶意投毒行为。脚本依赖项仅限于标准的Docker、Git和Curl工具，没有引用可疑的第三方二进制文件。风险主要集中在利用链的自动化程度上，若被恶意修改后分发，可能会被用于构建僵尸网络，但就原始POC而言，其主要目的是防御性研究和补丁验证。由于代码完全开源且基于成熟的安全报告，投毒风险被评估为极低，仅存在10%的基础风险，即攻击者可能将其包装在虚假的安全工具包中。建议安全从业者在隔离环境运行此类脚本，避免在生产环境直接执行。

**项目地址:** [https://xz.aliyun.com/news/90842](https://xz.aliyun.com/news/90842)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
