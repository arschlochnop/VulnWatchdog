## CVE-2025-8110 - Gogs 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Gogs

**危害等级:** 高危

**CVSS评分:** 8.7

**影响版本:** Gogs <= 0.13.2

**利用条件:** 需要认证, 需要网络访问, 多步骤攻击

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8110 是 Gogs (Go-Git-Service) 自托管 Git 服务中的一个高危漏洞，最终可导致远程代码执行 (RCE)。此漏洞源于 Gogs 的 `PutContents` API 对符号链接的处理不当，允许经过身份验证的攻击者绕过此前针对目录遍历的修复（如 CVE-2024-55947），实现任意文件写入。攻击者可以通过创建指向服务器上任意路径的符号链接，并将其推送到 Gogs 仓库，然后利用 API 向这些符号链接写入内容，从而在目标系统上覆盖文件。其CVSS 4.0评分为8.7分，CVSS 3.1评分为7.8分。据监测，截至2025年12月，全球已有超过700台公网暴露的Gogs实例遭到入侵，且在野外已被积极利用。

**POC有效性分析：**

提供的POC是一份详细的漏洞验证报告，以Markdown格式呈现，具备高度的有效性和可复现性。它明确指定了验证目标为Gogs 0.13.2版本，并建议使用Docker环境进行自动化搭建。POC清晰地展示了从环境准备、恶意符号链接创建、文件推送、利用Gogs API触发文件覆盖，到最终结果验证的全过程。攻击者在本地仓库中创建指向服务器任意路径（如`/tmp/pwned_marker`）和仓库内部敏感文件（如`.git/config`）的符号链接。随后，通过带有API Token的`PUT`请求向这些符号链接写入Base64编码的恶意内容。报告通过`docker exec`命令在容器内部验证了`/tmp/pwned_marker`文件的成功创建和内容写入，证明了任意文件写入的能力。更关键的是，它演示了如何向`.git/config`文件注入恶意`sshCommand`，例如`whoami > /tmp/hacked`，从而在服务器执行任何涉及SSH的Git操作时触发RCE。整个POC流程完整、步骤明确，命令清晰，使得验证人员能够轻松地复现该漏洞并确认其危害。

**利用步骤：**

1.  **环境准备**：部署一个受影响版本的Gogs服务，例如Gogs 0.13.2。POC建议使用Docker进行自动化环境搭建。
2.  **获取认证凭据**：攻击者需要拥有一个Gogs用户账户的认证凭据（例如，管理员账户的API Token），该账户拥有对至少一个仓库的写入权限。
3.  **创建本地Git仓库**：在攻击者本地创建一个新的Git仓库，并将其克隆或推送到目标Gogs服务器。
4.  **构造恶意符号链接**：在本地仓库中创建两个关键的符号链接：
    *   `malicious_link_abs`：指向服务器上任意可写路径，例如`/tmp/pwned_marker`，用于验证任意文件写入能力。命令示例：`ln -s /tmp/pwned_marker malicious_link_abs`。
    *   `link_to_config`：指向目标仓库的`.git/config`文件路径，例如`/data/git/gogs-repositories/attacker/test-repo.git/config`，用于实现RCE。命令示例：`ln -s /data/git/gogs-repositories/attacker/test-repo.git/config link_to_config`。
5.  **推送符号链接**：将这些符号链接添加到本地Git仓库并推送到Gogs服务器：`git add . && git commit -m "Add symlinks" && git push`。
6.  **触发文件覆盖**：使用Gogs的`PutContents` API（`PUT /api/v1/repos/{owner}/{repo}/contents/{filepath}`）向已上传的符号链接写入恶意内容。此操作需提供API Token：
    *   向`malicious_link_abs`写入任意内容（例如Base64编码的“PWNED”），以确认任意文件写入是否成功。
    *   向`link_to_config`写入包含恶意`sshCommand`的Git配置内容，例如`[core]\n\tsshCommand = "whoami > /tmp/hacked"`。
7.  **触发RCE**：一旦`.git/config`被成功修改，Gogs服务器或任何对该仓库执行涉及SSH的Git操作（如`git ls-remote`、`git fetch`）的用户，都会触发恶意`sshCommand`的执行，从而在服务器上实现远程代码执行。

**投毒风险分析：**

所提供的POC内容是一个漏洞验证报告，其核心目的是以清晰、透明的方式演示CVE-2025-8110漏洞的利用过程。该报告以Markdown格式呈现，其中包含Bash命令（如`ln -s`、`git`、`docker exec`）和`curl`命令，用于与Gogs API进行交互以及验证漏洞效果。这些命令都是标准且常用的，没有经过任何形式的混淆处理。报告中没有包含任何可直接执行的恶意二进制文件、混淆的脚本或从外部不可信源下载并执行代码的行为。报告中提到的“恶意”部分，仅限于通过漏洞机制注入到目标系统（例如Git仓库的`.git/config`文件）中的数据内容（如`sshCommand = "whoami > /tmp/hacked"`），这些数据旨在证明RCE的可能性，而非POC代码本身含有恶意负载。因此，从防御性安全研究的角度来看，该POC作为验证漏洞的工具，其自身的“投毒”风险极低（约为5%）。它不包含任何试图安装后门、窃取信息或进行其他恶意行为的隐蔽逻辑。使用者在运行此POC时，只要确保在受控环境中，并理解每个步骤的含义，即可安全地进行漏洞验证。主要风险点在于，若POC使用者不当配置或在生产环境中使用，可能会对目标系统造成预期内的损害（即RCE），但这属于漏洞利用的范畴，而非POC代码本身的恶意性。

**项目地址:** N/A

**漏洞详情:** N/A
