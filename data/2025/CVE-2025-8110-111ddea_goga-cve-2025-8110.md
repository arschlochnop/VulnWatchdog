## CVE-2025-8110 - Gogs (Self-hosted Git service) RCE/符号链接绕过/命令注入

**漏洞编号:** CVE-2025-8110

**漏洞类型:** RCE/符号链接绕过/命令注入

**影响应用:** Gogs (Self-hosted Git service)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Gogs <= 0.13.2

**利用条件:** 需要拥有普通用户权限或API Token，能够创建并推送Git仓库内容

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是针对CVE-2024-55947修复补丁的二次绕过。Gogs在处理Git内容上传时，虽然尝试限制了文件路径，但未能有效处理符号链接（Symlink）。POC展示了攻击者可以通过推送包含指向服务器敏感路径（如仓库配置文件.git/config或系统目录/tmp）的符号链接。当攻击者利用PutContents API向该链接写入内容时，Gogs会跟随链接（Follow Symlink）将数据写入目标路径而非仓库内部。验证显示，攻击者成功将恶意core.sshCommand配置写入仓库配置文件。由于Git在执行涉及网络的操作（如fetch/ls-remote）时会读取该配置，攻击者可诱导系统执行任意Shell命令。此POC逻辑清晰，步骤完整（包含环境搭建、链接创建、内容写入、触发执行），在Gogs 0.13.2环境下表现稳定，具备极高的实战参考价值。利用步骤：1. 攻击者在本地创建指向目标敏感文件（如/data/git/gogs-repositories/user/repo.git/config）的符号链接并推送到Gogs。2. 调用API接口（/api/v1/repos/{owner}/{repo}/contents/{path}）并使用PUT方法。3. 在Payload中构造恶意Git配置，设置core.sshCommand字段为待执行命令。4. 通过API触发Git相关动作（如ls-remote）使服务器加载并执行恶意配置。投毒风险分析：该漏洞分析报告及配套代码主要用于安全研究和防御建设。代码逻辑透明，使用了标准的curl和git命令行工具，未发现明显的代码混淆、二进制后门或非预期的外部网络连接。风险点在于该漏洞利用链涉及到对Git配置文件的修改，若在生产环境测试后未及时清理，可能导致持久化后门隐患。POC中虽然包含'whoami'或'touch'等无害化命令，但攻击者极易将其替换为反弹Shell脚本。由于该漏洞处于在野利用阶段（0-day/N-day），网络上可能流传混淆后的自动利用脚本，防范重点应放在API权限审计和容器隔离上。目前分析的POC代码本身属于合法的验证程序，仅在手动配置错误或在未授权环境运行下存在次生风险，投毒风险评级为低。

**项目地址:** [https://github.com/gogs/gogs](https://github.com/gogs/gogs)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
