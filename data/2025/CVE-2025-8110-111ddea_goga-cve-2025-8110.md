## CVE-2025-8110 - Gogs RCE (远程代码执行)

**漏洞编号:** CVE-2025-8110

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Gogs

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** <= 0.13.2

**利用条件:** 需要拥有创建仓库或向仓库推送代码的权限（经过身份验证的攻击者），且目标服务器启用了文件管理相关的 API 功能。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC通过模拟攻击者在Gogs环境中利用符号链接（Symlink）绕过之前CVE-2024-55947的安全修复。验证报告显示，利用链非常完整且具有极高的实战价值。首先，攻击者利用Git客户端在本地创建指向敏感路径（如仓库内部的.git/config或系统路径/tmp）的符号链接并推送到Gogs。核心漏洞点在于Gogs的PutContents API在处理文件更新时，未能对软链接指向的目标路径进行严格校验，导致其‘跟随’链接。POC展示了两种验证方式：一是成功向系统/tmp目录写入标识文件，证明了任意文件写入能力；二是精准覆盖了Git仓库的config文件。通过在config中注入core.sshCommand参数，攻击者将Git合法的网络操作转化为系统指令执行。当服务器执行git fetch或git ls-remote等操作时，预设的恶意命令将以运行Gogs服务的权限（通常是git用户或root）执行，从而实现从文件覆盖到远程代码执行（RCE）的权限提升。利用步骤：1. 攻击者创建一个Git仓库并克隆到本地。2. 使用`ln -s`创建指向服务器敏感文件（如`/data/git/gogs-repositories/user/repo.git/config`）的符号链接。3. 将该链接推送到Gogs服务端。4. 调用Gogs API `api/v1/repos/{owner}/{repo}/contents/{path}`，在payload中指定符号链接路径，并提供Base64编码的恶意git配置内容，其中包含`sshCommand`后门。5. 触发服务器端的Git网络操作（如利用API触发镜像同步或手动执行Git命令），激活注入的`sshCommand`。投毒风险分析：该POC代码本身主要由Shell脚本和API调用组成，逻辑清晰，不包含经过混淆的二进制数据或加密的远程下载指令。然而，风险点在于利用步骤中提及的`setup-gogs-vulnerable.sh`脚本。防御性研究人员在运行此类自动化搭建脚本时，必须仔细审查脚本是否会修改宿主机的系统配置或下载来源不明的Docker镜像。当前分析显示，POC提供的核心逻辑是标准的漏洞验证逻辑，但在实际的威胁情报场景中，此类漏洞极易被恶意攻击者封装进伪装成‘安全工具’或‘复现脚本’的项目中。由于该漏洞涉及到文件系统的底层路径操作，攻击者可能会在POC中隐藏额外的软链接，指向研究人员本机的`.ssh/authorized_keys`或`.bashrc`。如果研究人员在未隔离的环境中直接运行不明来源的利用代码，可能会反遭‘投毒’。建议在严格的Docker沙箱环境下进行测试，并监控API调用产生的异常文件IO行为，防止POC验证过程演变为真实的系统沦陷。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8110-Verification](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8110-Verification)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8110](https://nvd.nist.gov/vuln/detail/CVE-2025-8110)
