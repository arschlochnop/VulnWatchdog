## CVE-2025-68613 - n8n (Workflow Automation Platform) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** n8n (Workflow Automation Platform)

**危害等级:** Critical

**CVSS评分:** 9.8 (Estimated)

**影响版本:** 0.211.0 to < 1.120.4, 1.121.1, 1.122.0

**利用条件:** 需要具有创建或修改工作流权限的有效用户认证凭证 (Authenticated)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对n8n工作流表达式评估系统中的关键漏洞。由于n8n在早期版本中未能对工作流表达式进行严格的沙箱化或输入验证，攻击者可以构造恶意的JavaScript表达式或利用Node.js底层环境执行系统命令。该POC通过Python脚本实现了完整的攻击链：首先，脚本调用/rest/login接口进行身份验证并获取会话Cookie；其次，通过/rest/projects和/rest/workflows/new接口定位项目并创建新的恶意工作流。核心利用点在于向工作流中注入特定的payload，使表达式引擎在解析时突破限制执行任意代码。根据代码结构，该脚本逻辑清晰，使用了标准的requests库进行HTTP通信，能够自动化完成登录、项目枚举、工作流创建及Payload发送的闭环，实战有效性极高。利用步骤：1. 安装必要的Python依赖库（requests）。2. 准备具有n8n后台访问权限的邮箱和密码。3. 执行脚本并指定目标URL及凭证：python exploit.py -u <target> -e <email> -p <pass>。4. 脚本将自动登录并创建一个包含恶意表达式的新工作流。5. 触发工作流执行，从而在托管n8n的服务器上实现远程代码执行。投毒风险分析：该POC项目的投毒风险处于低至中等水平（约15%）。代码分析显示，脚本主要使用标准requests库，并未发现明显的混淆、二进制Payload注入或针对本地执行环境的窃密行为。User-Agent字段被明确标注为‘CVE-2025-68613: demo script’，表现出较强的研究属性。然而，风险点在于：首先，POC项目包含requirements.txt，在通过pip安装依赖时，如果上游仓库被劫持可能导致供应链攻击；其次，这类RCE脚本往往会被快速二次打包并散布在非官方渠道，不法分子可能在其中植入反弹Shell或窃取本地凭证的隐蔽逻辑。此外，由于脚本中包含硬编码的远程请求URL，若用户在不隔离的环境下运行，可能导致目标资产信息泄露给POC作者。建议在沙箱环境或虚拟机中运行，并手动审计代码中是否存在未声明的外部网络连接请求或eval()等动态执行函数。

**项目地址:** [https://github.com/AbdulRKB/n8n-RCE.git](https://github.com/AbdulRKB/n8n-RCE.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
