## CVE-2025-43529 - Apple WebKit (iOS, iPadOS, macOS, watchOS, Safari, tvOS, visionOS) Use-After-Free (UAF)

**漏洞编号:** CVE-2025-43529

**漏洞类型:** Use-After-Free (UAF)

**影响应用:** Apple WebKit (iOS, iPadOS, macOS, watchOS, Safari, tvOS, visionOS)

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.8 (Estimated)

**影响版本:** iOS < 18.7.3/26.2, iPadOS < 18.7.3/26.2, macOS < 26.2, Safari < 26.2, watchOS < 26.2, visionOS < 26.2, tvOS < 26.2

**利用条件:** 远程利用；用户访问恶意构造的Web内容（点击恶意链接或访问被挂马的网页）

**POC 可用性:** 4/10

**POC 类型:** 仅说明

**攻击复杂度:** 高

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞属于WebKit引擎中JavaScriptCore (JSC) 模块的高级内存破坏漏洞。根据POC描述，漏洞根源在于DFG（数据流图）JIT编译器在处理逃逸分析（Escape Analysis）时存在逻辑缺陷。具体而言，编译器虽然识别出合并多个控制流路径的Phi节点已经逃逸，但未能正确识别与其关联的Upsilon节点也发生了逃逸。在DFG编译的StoreBarrierInsertionPhase阶段，这种漏判导致编译器跳过了关键的存储屏障（Store Barrier）指令插入。在分代垃圾回收（GC）机制中，存储屏障负责维护‘记住集’，确保并发GC能够追踪到旧生代对象对新生代对象的引用。由于缺少屏障，并发GC在标记过程中可能遗漏本应扫描的对象，导致该对象被错误回收，进而触发Use-After-Free（UAF）状态。POC文档通过深入的底层原理分析论证了利用的可行性，并指出了关键的补丁提交记录。虽然提供的文本截断了具体的Exp代码，但其详细阐述了JSC内存管理状态机（White/Grey/Black CellState）的绕过路径，证明了该漏洞在技术上是高度可利用的，且已经有针对iOS 26.1等版本的实战化利用证明。利用该漏洞通常需要精密的堆喷射（Heap Spraying）和对JIT内部结构的深度操控，因此具备极高的技术门槛。【利用步骤】1. 构建恶意JavaScript脚本，触发DFG JIT编译特定函数；2. 在该函数中构造复杂的控制流合并点（Phi/Upsilon nodes），使对象发生逃逸；3. 利用编译器漏掉Store Barrier的间隙，在并发GC运行时修改对象引用；4. 诱导GC回收仍在使用的对象，造成UAF；5. 通过重叠内存布局控制悬挂指针，实现任意读写并最终执行代码。【投毒风险分析】目前该POC以技术分析文档的形式存在，主要包含漏洞原理说明和补丁对比。README中提及了具体的漏洞触发机制和受影响版本。从现有资料看，该分析文档属于防御性安全研究范畴，意在揭示高阶APT攻击中使用的0-day技术。风险评估显示，其投毒风险处于低水平（10%），原因如下：首先，文档代码部分主要集中于C++底层数据结构说明（如JSCell、CellState）和编译器逻辑解释，而非可直接运行的自动化攻击脚本；其次，此类针对JIT编译器的漏洞利用极度依赖目标系统的内存布局和具体的偏移量，难以编写通用的、具备大规模传播能力的恶意载荷；最后，该漏洞已被官方修复且被证实曾用于针对特定目标的‘极度先进’攻击，公开此类原理有助于安全团队开发基于内存行为的检测规则，而非助长无差别攻击。然而，由于该漏洞涉及内核级别的代码执行能力，若后续有攻击者封装完整的Webkit Exploit Kit并以此文档作为诱饵分发伪造的修复补丁，仍存在一定的社工风险。

**项目地址:** /tmp/vulnwatchdog_38a1dae25b7a27d33c479ddf37867098/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-43529](https://nvd.nist.gov/vuln/detail/CVE-2025-43529)
