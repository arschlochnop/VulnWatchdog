## CVE-2025-47962 - Microsoft Windows SDK 权限提升 (DLL劫持)

**漏洞编号:** CVE-2025-47962

**漏洞类型:** 权限提升 (DLL劫持)

**影响应用:** Microsoft Windows SDK

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 包含 Windows SDK 且存在 C:\Microsoft Shared 目录不当权限配置的版本

**利用条件:** 本地低权限用户访问，目标机器安装了特定版本的 Windows SDK

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC展示了一个经典的本地权限提升漏洞利用过程，利用了Windows SDK安装过程中对目录权限配置不当的缺陷。根据提供的信息，目录“C:\Microsoft Shared\”在安装后被赋予了BUILTIN\Users组“完全控制(F)”或“修改(M)”的权限。这意味着任何登录到系统的低权限用户都可以在该目录下创建或修改文件。关键点在于名为IpOverUsbSvc的服务，该服务以LocalSystem高权限运行，其二进制文件IpOverUsbSvc.exe位于该受限目录的子路径中。利用步骤如下：首先，攻击者编写一个恶意的DLL文件（如CRYPTBASE.dll），该DLL包含在加载时执行的恶意逻辑（本例中为在C:\Windows\Temp\下创建标记文件）。其次，利用交叉编译工具（如i686-w64-mingw32-gcc）生成该DLL。然后，由于权限配置错误，攻击者可以直接将生成的恶意DLL拷贝到服务程序所在的目录中。最后，通过重启IpOverUsbSvc服务，系统会尝试加载该目录下的DLL，从而使攻击者的恶意代码在LocalSystem上下文中执行。此POC代码逻辑清晰，利用了系统默认的DLL加载搜索顺序和不安全的ACL配置，验证方法（创建文件）是安全研究中的标准做法，具有极高的实战参考价值和复现成功率。投毒风险分析：该POC代码本身表现出极低的投毒风险。分析其提供的poc.c代码可以发现，其包含的逻辑非常透明，仅包含标准的windows.h头文件。代码的主要功能是在DllMain函数的DLL_PROCESS_ATTACH阶段调用CreateFileA和WriteFile。其操作目标是C:\Windows\Temp\PWNED_SYSTEM.txt，这在安全研究中属于典型的“无害化证明”操作，即仅通过创建一个特定文件来证明代码已获得系统级权限，而不执行任何窃取数据、安装后门或破坏系统的操作。代码中没有发现任何网络连接、资源加密、敏感信息枚举或混淆代码。编译指令使用的是标准的开源工具链，未涉及任何未知的二进制依赖。README文档中详细说明了服务名称、目录路径以及权限配置信息，提供了完整的技术细节而非黑盒工具。因此，该POC可以被判定为纯粹的安全研究验证代码。尽管如此，防守方仍需注意，任何公开的POC都可能被攻击者直接拿来改造，将简单的文件创建逻辑替换为更具破坏性的Payload，但在其目前的形态下，该代码是安全的且不具备恶意投毒特征。

**项目地址:** [https://github.com/user-attachments/assets/](https://www.google.com/search?q=https://github.com/user-attachments/assets/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-47962](https://nvd.nist.gov/vuln/detail/CVE-2025-47962)
