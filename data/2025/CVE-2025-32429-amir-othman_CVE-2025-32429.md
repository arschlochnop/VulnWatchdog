# CVE-2025-32429

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-32429-amir-othman_CVE-2025-32429.md](../2025/CVE-2025-32429-amir-othman_CVE-2025-32429.md)

## CVE-2025-32429 - XWiki Platform SQL 注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL 注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 9.4-rc-1 到 16.10.5 和 17.0.0-rc-1 到 17.2.2

**利用条件:** 需要网络访问 XWiki 平台，并且目标系统存在漏洞版本的 XWiki。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32429 是 XWiki Platform 中的一个 SQL 注入漏洞，存在于 `getdeleteddocuments.vm` 模板的 `sort` 参数中。攻击者可以通过构造恶意的 SQL 语句，利用 `sort` 参数作为 ORDER BY 的值进行注入。

**有效性：**
提供的 PoC 代码尝试利用该漏洞。代码使用 curl 发送带有恶意 payload 的 HTTP 请求，payload 包含 SQL 注入语句。如果目标 XWiki 平台存在漏洞，则注入可能会成功。

**投毒风险：**
PoC 代码本身是用 C 编写的，主要功能是发送 HTTP 请求。代码包含了一些看似多余的汇编代码，例如`exitAssembly`函数，这个函数看起来是为了直接通过系统调用退出程序,但这个函数并没有被调用,并且在curl初始化失败的情况下通过系统调用来执行ping命令。虽然这段汇编代码本身没有明显的恶意行为，但它增加了代码复杂性，存在潜在的隐藏恶意行为的可能性。因此, 投毒风险评定为10%。

**利用方式：**
1.  **确定目标 XWiki 平台版本：** 确认目标 XWiki 平台版本在漏洞影响范围内 (9.4-rc-1 到 16.10.5 和 17.0.0-rc-1 到 17.2.2)。
2.  **构造恶意 URL：**  构造包含 SQL 注入 payload 的 URL，该 payload 附加到 `getdeleteddocuments.vm` 模板的 `sort` 参数。
3.  **发送 HTTP 请求：** 使用 curl 或其他 HTTP 客户端发送包含恶意 URL 的 HTTP 请求。
4.  **分析响应：**  根据响应判断注入是否成功。可能的成功标志包括错误信息、延迟或数据泄露。

**项目地址:** [amir-othman/CVE-2025-32429](https://github.com/amir-othman/CVE-2025-32429)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)

---

## POC #2

**来源**: [CVE-2025-32429-byteReaper77_CVE-2025-32429.md](../2025/CVE-2025-32429-byteReaper77_CVE-2025-32429.md)

## CVE-2025-32429-XWiki Platform-SQL注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 9.4-rc-1 ~ 16.10.5, 17.0.0-rc-1 ~ 17.2.2

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32429存在于XWiki Platform的getdeleteddocuments.vm模板中，攻击者可以通过操纵`sort`参数来注入恶意的SQL代码。漏洞利用代码提供了一个C语言编写的PoC，可以检测WAF，并尝试执行SQL注入攻击，包括基于布尔、基于时间的盲注以及union查询。PoC代码编译运行后，通过向目标URL发送包含恶意SQL语句的请求，判断是否存在SQL注入漏洞。

**有效性：** 根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。漏洞库明确指出`getdeleteddocuments.vm`的`sort`参数存在SQL注入，搜索结果也确认了该漏洞的存在，并且PoC代码旨在验证并利用此漏洞。

**投毒风险：** 提供的代码中存在一些可疑的地方，例如`exitAssembly`函数使用了内联汇编，直接调用了Linux的exit系统调用，看起来没有必要。但是总体来看，这个PoC代码主要功能是执行SQL注入，没有发现明显的恶意代码或者后门，因此判定投毒的风险较低，约为5%。风险主要集中在编译环境的安全性，以及libcurl库本身是否存在未知的漏洞上。

**利用方式：**
1.  **确定目标：** 确定存在漏洞的XWiki Platform版本。
2.  **编译PoC：** 使用GCC编译提供的C代码，需要libcurl和argparse库。
3.  **运行PoC：** 运行编译后的可执行文件，提供目标XWiki实例的URL作为参数。可以选择提供cookie文件以进行身份验证。
4.  **漏洞验证：** PoC首先尝试检测WAF，然后发送一系列包含SQL注入Payload的请求，根据响应时间和内容判断是否存在SQL注入漏洞。
5.  **信息提取：** 如果存在漏洞，攻击者可以进一步利用SQL注入读取数据库信息或执行其他恶意操作。

**项目地址:** [byteReaper77/CVE-2025-32429](https://github.com/byteReaper77/CVE-2025-32429)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)

---

## POC #3

**来源**: [CVE-2025-32429-imbas007_CVE-2025-32429-Checker.md](../2025/CVE-2025-32429-imbas007_CVE-2025-32429-Checker.md)

## CVE-2025-32429-XWiki-SQL注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 9.4-rc-1 <= version < 16.10.6, 17.0.0-rc-1 <= version < 17.3.0-rc-1

**利用条件:** 需要网络访问，且目标XWiki实例存在getdeleteddocuments.vm模板并允许未授权访问该模板。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32429是XWiki Platform中的一个SQL注入漏洞，位于`getdeleteddocuments.vm`模板的`sort`参数中。攻击者可以通过构造恶意的SQL语句，利用该漏洞执行任意SQL查询，从而获取敏感信息，甚至可能执行任意代码。根据漏洞描述，该漏洞无需认证即可利用，CVSS评分为9.3，属于严重级别漏洞。

**有效性:**
根据提供的漏洞利用代码，该POC脚本通过发送特制的HTTP请求到`/xwiki/rest/liveData/sources/liveTable/entries`接口，并操控`sourceParams.template`和`sort`参数来触发漏洞。POC代码实现了WAF检测、基于时间的盲注和基于错误的SQL注入检测，表明该POC在一定程度上是有效的。

**投毒风险:**
分析POC代码，发现代码主要功能是检测漏洞，虽然存在多线程功能，但主要目的是为了提高扫描效率。代码中没有发现明显的恶意行为，比如反弹shell、上传文件等。但是，攻击者可以基于此POC进行修改，加入恶意代码进行传播，因此存在一定的投毒风险，评估为10%， 主要基于以下原因:
1.  **依赖第三方库：** POC 使用了`requests` 和 `urllib3`库，虽然这些库本身是常用的，但是如果攻击者修改POC，使其依赖于包含恶意代码的第三方库，则可能引入风险。
2.  **代码可修改性：**  POC 代码是开源的，攻击者可以很容易地修改该代码，添加恶意功能。
3.  **执行系统命令风险：**  虽然当前POC没有直接执行系统命令，但攻击者可以通过SQL注入执行数据库命令，进而可能导致间接的系统命令执行。

**利用方式:**
1.  **确定目标XWiki版本：** 确认目标XWiki Platform的版本是否在受影响范围内（9.4-rc-1 <= version < 16.10.6, 17.0.0-rc-1 <= version < 17.3.0-rc-1）。
2.  **发送恶意请求：** 构造包含恶意SQL代码的HTTP请求，通过修改`sort`参数的值，注入到SQL查询语句中。
    例如：`https://target/xwiki/rest/liveData/sources/liveTable/entries?sourceParams.template=getdeleteddocuments.vm&sort=恶意SQL代码`
3.  **获取敏感信息或执行任意代码：** 利用注入的SQL代码，读取数据库中的敏感信息，例如用户名、密码等。如果数据库权限配置不当，甚至可以执行任意代码。

**项目地址:** [imbas007/CVE-2025-32429-Checker](https://github.com/imbas007/CVE-2025-32429-Checker)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)

---

