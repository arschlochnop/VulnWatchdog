## CVE-2025-30208 - Vite (前端开发工具服务器) 路径穿越/任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 路径穿越/任意文件读取

**影响应用:** Vite (前端开发工具服务器)

**危害等级:** 中危 (Medium)

**CVSS评分:** 5.3 (CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N)

**影响版本:** Vite < 6.2.3, 6.1.2, 6.0.12, 5.4.15, 4.5.10

**利用条件:** Vite开发服务器显式暴露于网络（使用--host参数），且攻击者能够构造恶意URL诱导开发者访问或直接访问可达的服务。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞存在于Vite开发服务器的`@fs`路径处理逻辑中。Vite通常使用`@fs`前缀来提供对本地文件系统的访问，但会配合白名单机制进行限制。CVE-2025-30208的本质在于Vite在处理带有查询参数的URL时，对末尾分隔符（如问号?）的处理存在逻辑缺陷。当攻击者构造类似`?import&raw??`或`?raw??`的查询字符串时，由于正则匹配未能正确处理多余的分隔符，导致文件路径验证被绕过。分析提供的Python POC脚本可知，其利用方式非常直接：通过向目标URL拼接`/@fs/etc/passwd?import&raw?&`（Linux）或`/@fs/C://windows/win.ini?import&raw?&`（Windows）发起GET请求。若返回内容包含`root`或`win.ini`特征字符，则验证成功。提供的YAML文件则定义了自动化扫描的Payload。经评估，此POC逻辑清晰，直接利用了Vite源码中对Query String解析不严的漏洞点，具有极高的实战有效性。利用步骤如下：1. 确认目标运行着受影响版本的Vite开发服务器并对外开放。2. 构造包含`?import&raw??`后缀的敏感文件路径。3. 发送HTTP GET请求。4. 服务器将错误地剥离多余符号并匹配到读取逻辑，绕过白名单，返回敏感文件内容。此漏洞对开发环境的安全威胁极大，可能导致源代码、环境变量（.env）或SSH密钥泄露。

【投毒风险分析】提供的POC代码（Python和YAML版本）投毒风险极低。首先，Python代码使用了标准的`argparse`和`requests`库，逻辑透明，主要功能仅限于发送特定结构的HTTP GET请求并检查响应正文中的字符串。代码中明确包含了`requests.packages.urllib3.disable_warnings()`，这在安全扫描工具中是常见做法，用于处理自签名证书。代码中未发现任何诸如Base64混淆执行、远程下载恶意Payload、修改本地关键系统文件或反弹Shell的恶意逻辑。其次，YAML文件是标准的Nuclei/VulnWatchdog格式模板，仅包含元数据、引用链接和匹配规则，属于纯声明式文档，不具备执行恶意代码的能力。整体而言，该POC包是典型的安全研究和漏洞验证工具，不含投毒成分。唯一的风险点在于此类工具若被未经授权的人员使用，可能对目标系统造成信息泄露风险，但这属于工具滥用而非代码投毒。建议研究人员在使用时，确保已获得授权，并注意在合规环境下运行脚本。

**项目地址:** [https://github.com/vitejs/vite/security/advisories/GHSA-x574-m823-4x7w](https://github.com/vitejs/vite/security/advisories/GHSA-x574-m823-4x7w)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
