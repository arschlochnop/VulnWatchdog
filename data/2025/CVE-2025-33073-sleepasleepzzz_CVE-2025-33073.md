# CVE-2025-33073

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 提权漏洞

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本和Build号在漏洞库信息中已列出

**利用条件:** 需要能够访问目标网络，并且目标机器上存在受影响的SMB客户端版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-33073是Windows SMB客户端中的一个权限提升漏洞，允许经过身份验证的攻击者通过网络提升权限。提供的漏洞利用代码（CVE-2025-33073.py）利用了dnstool.py、ntlmrelayx和nxc等工具，构成了一个完整的攻击链。该攻击链首先使用dnstool.py在域控制器上添加一个恶意的DNS记录。然后，该脚本会等待DNS记录生效。接下来，脚本启动ntlmrelayx，配置为将收到的NTLM认证请求转发到目标机器。最后，脚本通过nxc（用于网络渗透测试）使用PetitPotam、Printerbug或DFSCoerce等强制认证方法，诱使目标机器向攻击者控制的ntlmrelayx服务器进行身份验证，从而利用NTLM relay攻击提升权限。

**有效性分析：**

该POC代码利用了已知的NTLM relay攻击技术，结合DNS欺骗和强制认证方法，在特定条件下可以有效提升权限。漏洞利用代码主要依赖于 `dnstool.py` 添加恶意 DNS 记录，结合 `ntlmrelayx` 监听和中继 NTLM 认证，最后通过 `nxc` 触发强制认证。

**投毒风险分析：**

代码存在一定的投毒风险，但可能性较低，约为5%。原因如下：

*   代码中使用了多个第三方工具（dnstool.py, impacket-ntlmrelayx, nxc）。虽然这些工具本身是合法的渗透测试工具，但如果攻击者修改了脚本，使其在调用这些工具时添加额外的恶意参数或执行恶意操作，则可能存在投毒风险。
*   该脚本本身包含添加DNS记录的操作，如果被滥用，可能会导致网络中断或其他恶意行为。
*   脚本通过 xterm 打开新终端执行命令，这种行为本身可能存在风险。攻击者可能会利用这一点，在终端中执行恶意命令。

**利用方式分析：**

1.  **设置环境:** 攻击者需要一个攻击机（通常是Linux/Kali），安装了必要的工具（dnstool.py，impacket，nxc）。
2.  **DNS欺骗:** 攻击者使用dnstool.py向域控制器添加一个静态DNS记录，将特定的主机名解析到攻击者的IP地址。
3.  **NTLM中继:** 攻击者启动ntlmrelayx，监听传入的NTLM认证请求，并将其转发到目标机器。
4.  **强制认证:** 攻击者使用nxc（或类似工具）结合PetitPotam、Printerbug或DFSCoerce等方法，诱使目标机器通过SMB协议向攻击者控制的ntlmrelayx服务器进行身份验证。
5.  **权限提升:** 一旦目标机器向ntlmrelayx进行身份验证，攻击者就可以利用中继的凭据在目标机器上执行命令，从而提升权限。

**漏洞缓解措施：**

*   安装Microsoft提供的安全更新。
*   启用SMB签名以防止NTLM中继攻击。
*   限制对RPC服务的访问。
*   监控DNS服务器的异常记录。

**项目地址:** [Ashwesker/Blackash-CVE-2025-33073](https://github.com/Ashwesker/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #2

**来源**: [CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 - Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许未经授权的攻击者提升网络上的权限

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要域环境，目标系统在受影响的版本范围内，攻击者位于可访问域控和目标机器的网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许经过身份验证的攻击者通过SMB客户端提升权限。利用方式如下：

1.  **利用 `dnstool.py` 添加恶意DNS记录:**  攻击者首先使用提供的`dnstool.py`脚本在域控制器上添加一个恶意的DNS记录，将一个特定的主机名（`STATIC_DNS_RECORD`）解析到攻击者的IP地址。这通常需要有效的域用户凭据。
2.  **等待DNS记录传播:** 脚本会等待新添加的DNS记录在DNS服务器上生效，确保目标系统能够解析到攻击者的IP。
3.  **启动 `ntlmrelayx` 监听器:** 使用 `impacket` 工具集中的 `ntlmrelayx` 启动一个NTLM中继服务器。这个服务器会监听来自目标系统的NTLM认证请求，并将其转发到另一个目标（`--target`），通常是域控制器本身，以获取权限。
4.  **触发NTLM认证请求:**  使用 `nxc` (crackmapexec的修改版本)  配合 `coerce_plus` 模块，通过诸如`PetitPotam`、`Printerbug`或`DFSCoerce`之类的方法强制目标服务器向攻击者控制的IP地址进行NTLM认证。这些方法通常利用Windows服务的特性来触发认证。
5.  **NTLM中继和权限提升:** `ntlmrelayx` 将收到的NTLM认证请求中继到域控制器，如果relay成功，攻击者可以模拟目标机器的身份，从而执行操作，例如添加用户、修改组策略或者执行任意命令。根据`--custom-command`参数，可以指定要执行的命令，默认情况下可能执行`secretsdump.py`来转储域凭据。

**有效性评估:**  提供的POC代码看起来是有效的，它结合了多个已知的攻击技术（DNS欺骗、NTLM中继、强制认证）来实现权限提升。  成功利用该漏洞取决于多个因素，包括目标系统的配置、网络环境以及所使用的强制认证方法的有效性。

**投毒风险评估:** 通过对POC代码的分析，没有发现明显的恶意或投毒代码。所有操作都是为了实现合法的攻击流程，没有隐藏的后门或破坏性行为。因此，投毒风险评估为0%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-33073](https://github.com/B1ack4sh/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #3

**来源**: [CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 见漏洞库信息

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞是Windows SMB客户端中的一个权限提升漏洞（CVE-2025-33073），由于SMB协议栈中存在不正确的访问控制机制导致。攻击者可以通过网络利用此漏洞提升权限。

**有效性评估：**
根据提供的漏洞库信息，该漏洞影响多个Windows版本，且CVSS评分为8.8，表明漏洞严重性较高。提供的漏洞利用代码包含Python和PowerShell的PoC，增加了利用的灵活性。代码描述了利用不正确的访问控制来构造SMB2数据包，从而导致权限提升。综合来看，PoC代码具有一定的有效性。

**投毒风险分析：**
虽然代码库提供了多种利用方式（Python和Powershell），但仍然存在一定的投毒风险。
1.  **代码复杂性：** SMB协议本身比较复杂，PoC代码必然涉及大量的协议细节，这使得在不完全理解协议的情况下，难以判断是否存在恶意代码。
2.  **权限提升的利用方式：** 权限提升漏洞本身就可能被用于植入后门，例如在提升权限后，修改系统文件，添加恶意服务等。
3.  **作者声明的免责声明：**虽然作者在`README.md`中声明该框架仅用于授权的安全研究、教育目的和受控测试环境，并强调了使用限制和风险缓解措施，但免责声明不能完全排除恶意使用的可能性。

基于以上分析，初步判断存在20%的投毒风险，需要进一步的代码审计来确认是否存在后门或恶意行为。

**利用方式：**
1.  **搭建恶意SMB服务器：** 攻击者需要搭建一个恶意的SMB服务器，该服务器能够响应客户端的SMB请求。
2.  **构造恶意SMB数据包：** 攻击者利用PoC代码构造恶意的SMB数据包，例如精心设计的协商请求或会话设置请求，触发SMB客户端的漏洞。
3.  **触发权限提升：** 当受害者（SMB客户端）连接到攻击者的恶意SMB服务器并处理恶意数据包时，由于不正确的访问控制，攻击者可以提升在受害者系统上的权限。
4. **代码中的利用方法:** 代码中的利用方法主要分为以下几种：
   * 利用python实现的smb_exploit_framework.py脚本进行攻击
   * 利用python实现的admin_exploit_framework.py脚本进行攻击,需要管理员权限
   * 通过PowerShell脚本exploit.ps1进行攻击

**风险提示：**
在实际测试和分析PoC代码时，务必在隔离的环境中进行，避免对生产系统造成影响。进行详细的代码审计是发现潜在投毒代码的必要步骤。

**项目地址:** [SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #4

**来源**: [CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server (2008-2025)，具体版本请参考CVE描述。

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

根据提供的漏洞信息和利用代码，CVE-2025-33073是一个Windows SMB客户端的特权提升漏洞。攻击者可以通过网络发送特制的SMB数据包，利用SMB协议栈中不正确的访问控制机制，从而提升权限。

**有效性：**
提供的POC代码包含多个文件，包括Python脚本（`smb_exploit_framework.py`, `admin_exploit_framework.py`）和PowerShell脚本(`exploit.ps1`)，以及一个批处理文件(`run_as_admin.bat`)。这些文件表明存在多种利用该漏洞的方法。`README.md` 文件详细描述了漏洞原理和利用步骤，包括构建恶意SMB服务器和客户端，以及构造特定的SMB2数据包来触发漏洞。如果目标系统在受影响的版本范围内，并且没有安装相应的安全补丁，则提供的POC代码很可能有效。

**投毒风险：**
虽然`README.md`文件声明该框架仅用于授权的安全研究和教育目的，但仍然存在投毒的风险。以下是一些潜在的风险点：
*   **代码复杂度:** 虽然代码提供了利用思路,但缺乏具体的exp细节实现，增加了分析难度，可能会隐藏恶意代码。  
*   **管理员权限要求:** `admin_exploit_framework.py`和`run_as_admin.bat`需要管理员权限才能运行，这表明该漏洞可能被用于在已入侵系统上提升权限，或者执行恶意操作。
*   **Payload定制：** 攻击者可能修改POC代码，嵌入额外的恶意Payload，例如反向Shell或远程控制木马，从而实现更深层次的入侵。
*   **日志记录：** 攻击者可能篡改日志记录功能，以隐藏其攻击行为。

综合考虑，该POC代码存在一定的投毒风险，估计为20%。使用者应仔细审查代码，并在隔离环境中进行测试，以避免潜在的危害。

**利用方式：**
1.  **搭建恶意SMB服务器：** 使用`smb_exploit_framework.py`或类似脚本创建一个模拟恶意SMB服务器。该服务器会监听特定的端口（通常是445），等待受害者连接。
2.  **客户端连接：** 受害者的Windows SMB客户端尝试连接到恶意SMB服务器。
3.  **数据包构造：** 恶意SMB服务器发送特制的SMB2数据包，利用SMB客户端的访问控制漏洞。
4.  **权限提升：** 如果漏洞利用成功，攻击者可以在受害者系统上获得更高的权限。
5.  **PowerShell利用：** 可以通过PowerShell脚本（`exploit.ps1`）执行，允许通过命令行指定目标主机和端口。
6.  **利用SMB协商阶段，会话建立阶段的漏洞。**

**项目地址:** [SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #5

**来源**: [CVE-2025-33073-cve-2025-33073_cve-2025-33073.md](../2025/CVE-2025-33073-cve-2025-33073_cve-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致网络权限提升

**影响版本:** 受影响的Windows版本详见漏洞描述

**利用条件:** 需要网络访问

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-33073是一个Windows SMB客户端的权限提升漏洞。攻击者可以通过不当的访问控制，在网络上提升权限。受影响的系统包括多个版本的Windows 10、Windows Server等。漏洞利用的复杂度较低，容易被利用，CVSS评分为8.8，属于高危漏洞。

然而，提供的“漏洞利用代码”实际上是一个个人介绍文件，与SMB漏洞利用无关。该文件内容为葡萄牙语，描述了作者的编程技能和爱好，包括C++, Java, PHP, Python和C#，以及信息安全。**因此，这段代码本身并不能用于利用CVE-2025-33073漏洞，且存在严重的投毒风险，因为其与漏洞描述完全不符。**

**利用方式分析：**

由于缺乏有效的PoC代码，无法确定具体利用方式。根据漏洞描述，该漏洞与SMB客户端的权限提升有关，攻击者可能通过构造恶意的SMB请求或响应，利用SMB协议中的缺陷来提升权限。可能的利用方式包括:

1.  **中间人攻击：** 攻击者拦截SMB客户端与服务器之间的通信，篡改SMB协议数据包，从而提升权限。
2.  **恶意SMB服务器：** 攻击者搭建恶意的SMB服务器，诱导受害者连接，利用服务器端的漏洞来提升权限。
3.  **利用SMB客户端解析漏洞：** 攻击者发送特制的SMB数据包，触发客户端的解析漏洞，从而执行恶意代码。

需要注意的是，具体利用方式取决于漏洞的根本原因，在没有有效PoC的情况下，只能进行推测。

**项目地址:** [cve-2025-33073/cve-2025-33073](https://github.com/cve-2025-33073/cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #6

**来源**: [CVE-2025-33073-joaozixx_CVE-2025-33073.md](../2025/CVE-2025-33073-joaozixx_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本（参见CVE描述中的版本范围）

**利用条件:** 攻击者需要位于与目标系统相同的网络中，并拥有有效的域凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞，允许经过身份验证的攻击者通过不正确的访问控制提升权限。该漏洞利用链包含以下步骤：

1.  **添加恶意DNS记录:** 使用dnstool.py工具，通过提供的用户名和密码，在域控制器的DNS服务器上添加一个恶意的DNS记录。这个记录将攻击者的IP地址与特定的DNS名称（`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`）关联起来。
2.  **验证DNS记录:** 脚本会等待恶意DNS记录生效，通过`dig`命令进行验证，确保记录已经成功添加到DNS服务器并且可以解析。
3.  **启动NTLM Relay:** 脚本启动`ntlmrelayx`工具，监听传入的NTLM认证请求，并将其转发到目标服务器。可以指定自定义命令，或者使用默认的`secretsdump`来提取目标系统的凭据。可以选择通过xterm启动，或直接在当前终端运行。
4.  **触发PetitPotam强制认证:** 脚本利用`nxc`（`netexec`）工具，通过PetitPotam（`coerce_plus`模块）强制目标服务器向攻击者控制的服务器进行NTLM认证。PetitPotam通过MS-EFSRPC协议触发认证。目标服务器会尝试解析之前添加的恶意DNS记录，并将NTLM认证信息发送到攻击者的`ntlmrelayx`监听器。

整个过程依赖于NTLM中继攻击，以及利用PetitPotam强制目标机器向攻击者控制的服务器进行认证。攻击者利用中继的NTLM认证信息，可以执行任意命令或提取目标系统的敏感信息，从而提升权限。

**有效性：**
根据搜索结果和提供的PoC代码，此PoC利用链看起来是有效的。Synacktiv的博客文章详细分析了此漏洞，并提供了利用此漏洞绕过NTLM反射缓解措施的方法。PoC代码旨在自动化整个攻击链。

**投毒风险：**
PoC代码本身没有明显的投毒代码，但存在以下潜在风险：

*   **依赖项风险：** 该脚本依赖于`dnstool.py`、`impacket-ntlmrelayx`和`nxc`。如果这些依赖项本身被篡改或包含恶意代码，那么使用该脚本也可能受到影响。
*   **滥用风险：** 该脚本提供的功能可以被滥用于未经授权的渗透测试或攻击。脚本作者或未经授权的第三方可能会修改该脚本以包含其他恶意功能，例如植入后门、删除数据等。但从现有代码本身来看，直接植入后门代码的概率较低,大约为10%，因为代码流程比较清晰，主要是调用现有的工具和库。

**利用方式总结：**
该漏洞利用方式的核心是利用NTLM中继攻击，结合恶意DNS记录和PetitPotam强制认证，将目标服务器的NTLM认证信息中继到攻击者控制的服务器，并利用这些信息提升权限。攻击者首先诱使目标服务器向攻击者控制的服务器进行认证，然后利用中继的认证信息执行任意命令或提取敏感信息。

**项目地址:** [joaozixx/CVE-2025-33073](https://github.com/joaozixx/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #7

**来源**: [CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md](../2025/CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者在网络上提升权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要受害者系统存在于与攻击者相同的网络中，并且攻击者需要具有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-33073 是一个 Windows SMB 客户端提权漏洞。该漏洞的利用方式是首先检查目标服务器是否禁用了 SMB 签名。如果 SMB 签名被禁用，攻击者可以使用 PetitPotam 强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证，从而进行 NTLM 中继攻击，最终提升权限。POC代码通过 crackmapexec 工具来检查 SMB 签名状态，使用 netcat 监听 445 端口，并利用 PetitPotam 脚本发起 NTLM 身份验证强制攻击。

**有效性评估:** 提供的 POC 代码看起来有效。它包含了检测漏洞和利用漏洞的必要步骤。它首先检查 SMB 签名是否禁用，然后尝试使用 PetitPotam 进行 NTLM 身份验证强制。

**投毒风险评估:** 投毒风险评估为20%。 虽然该脚本主要目的是验证漏洞的存在，但存在轻微的投毒风险，原因如下：

1.  **依赖外部脚本 (PetitPotam.py):** 该脚本依赖于从外部源下载的 PetitPotam.py 脚本。如果该脚本被恶意修改，则可能导致受害者系统被感染。
2.  **执行系统命令（sudo nc）:** 该脚本使用 `sudo nc` 启动 netcat 监听器，这可能会引入安全风险，尤其是在配置不当的情况下。
3.  **硬编码域名：**脚本的 README.md 文件提示需要在DNS中注册一个域名(`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`)，如果攻击者控制了受害者的DNS服务器，则可以劫持该域名并造成进一步的攻击。

**利用方式:**

1.  **环境准备:**  攻击者需要安装 crackmapexec, netcat, python3, 并且获得一个有效的域用户凭据。
2.  **检查 SMB 签名:** 使用 crackmapexec 工具检查目标服务器是否禁用了 SMB 签名。
3.  **强制身份验证:** 如果 SMB 签名被禁用，攻击者使用 PetitPotam 脚本强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证。
4.  **NTLM 中继:**  攻击者使用 netcat 监听 445 端口，捕获 NTLM 身份验证信息。
5.  **权限提升:**  攻击者利用捕获到的 NTLM 身份验证信息进行 NTLM 中继攻击，最终提升权限。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #8

**来源**: [CVE-2025-33073-mverschu_CVE-2025-33073.md](../2025/CVE-2025-33073-mverschu_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致域内权限提升和远程代码执行

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 需要攻击者在域内，并且目标主机受到漏洞影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 是一个Windows SMB客户端权限提升漏洞。该漏洞允许经过身份验证的攻击者通过SMB协议提升权限。提供的PoC代码利用了dnstool.py来添加恶意DNS记录，然后使用ntlmrelayx进行NTLM中继攻击，最后使用PetitPotam或其他类似方法触发目标机器向攻击者控制的服务器进行身份验证，从而通过NTLM中继获得目标机器的权限。 

**有效性分析：**
PoC代码看起来有效，因为它涵盖了NTLM中继攻击的典型步骤：
1.  添加恶意DNS记录，使目标机器解析特定主机名为攻击者控制的IP地址。
2.  启动ntlmrelayx监听器，等待NTLM身份验证请求。
3.  使用PetitPotam或其他强制身份验证的方法，诱使目标机器向攻击者控制的服务器进行身份验证。
4.  ntlmrelayx中继身份验证到目标服务器，执行任意命令，从而提升权限。

**投毒风险分析：**
代码中存在一定投毒风险，但概率较低（10%）。
*   `dnstool.py` 脚本的安全性需要进一步审查，如果该脚本本身存在漏洞，则可能被用于植入后门或者执行恶意操作。
*   代码使用了`subprocess.run` 和 `subprocess.Popen`，这些函数如果使用不当，可能会受到命令注入攻击。
*   PoC 依赖于 `impacket` 和 `nxc` 这两个第三方库。虽然这两个库本身很常用，但如果攻击者修改了 PoC，加入了从恶意源下载这些库的逻辑，就有可能引入恶意代码。
*   代码中使用了静态DNS记录，这可能会导致攻击行为更容易被检测。

**漏洞利用方式：**
1.  攻击者首先需要位于与目标机器相同的网络中。
2.  攻击者使用提供的PoC代码，指定用户名、密码、攻击者IP、DNS服务器IP、域控制器FQDN以及目标机器IP。
3.  PoC代码使用dnstool.py在DNS服务器上添加一个恶意的DNS记录，将特定的域名解析到攻击者控制的IP地址。
4.  PoC代码启动ntlmrelayx，监听传入的NTLM身份验证请求。
5.  PoC代码使用PetitPotam, Printerbug 或 DFSCoerce 等方法诱使目标机器向攻击者控制的IP地址发起NTLM身份验证。
6.  ntlmrelayx截获NTLM身份验证信息，并将其转发到目标机器。
7.  成功中继NTLM身份验证后，攻击者可以在目标机器上执行任意命令，从而提升权限。

**排序优先级考虑：** 由于没有提供搜索结果，漏洞利用代码的分析比漏洞库信息更具优先级。 代码本身提供更详细的攻击步骤，对风险判断、利用方式分析更有帮助。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #9

**来源**: [CVE-2025-33073-obscura-cert_CVE-2025-33073.md](../2025/CVE-2025-33073-obscura-cert_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，攻击者可通过网络提升权限

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参考CVE信息

**利用条件:** 攻击者需要位于同一网络，且能够访问SMB服务，需要受害者触发SMB连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 描述的是 Windows SMB 客户端的权限提升漏洞。攻击者可以利用该漏洞通过网络提升权限。

**利用方式分析：**

根据提供的漏洞利用代码，这是一个结合了 DNS 注入、NTLM 中继和 RPC 强制身份验证的攻击链。具体流程如下：

1.  **DNS 注入：** 使用 `samba-tool` 向 DNS 服务器添加一条 A 记录，将一个子域名指向攻击者的 IP 地址。这需要管理员权限。
2.  **DNS 记录验证：** 验证 DNS 记录是否成功传播，确保目标系统可以解析到攻击者的 IP。
3.  **NTLM 中继：** 启动 `impacket-ntlmrelayx` 工具，监听 NTLM 认证请求，并将请求中继到目标服务器。
4.  **RPC 强制身份验证：** 使用 `rpcping` 工具，强制目标系统通过 SMB 协议连接到攻击者控制的域名，触发 NTLM 认证。`rpcping` 通过 `spoolss` 管道强制进行身份验证。
5.  **权限提升：** 一旦 NTLM 认证被中继到目标服务器，攻击者就可以利用 `ntlmrelayx` 获取目标服务器的权限，从而提升在目标服务器上的权限。

**有效性分析：**

该PoC 代码逻辑完整，覆盖了利用该漏洞所需的关键步骤。根据CVE描述 Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.如果环境配置正确（例如，攻击者可以成功注入 DNS 记录，受害者系统存在 NTLM 中继的漏洞等），则该 PoC 代码应能成功利用该漏洞。

**投毒风险分析：**

检查 PoC 代码，发现该脚本主要实现了 DNS 注入、NTLM relay和RPC 强制身份验证。没有直接发现恶意代码或后门。虽然代码本身没有明显的恶意行为，但仍存在一定的投毒风险，占比约为10%：

*   **依赖风险：** 该脚本依赖于 `samba-tool` 和 `impacket-ntlmrelayx`。如果这些依赖库被恶意篡改，可能会导致意外的恶意行为。
*   **密码硬编码：** 代码中存在硬编码的管理员密码 `YourPassword`。攻击者如果直接使用该代码，可能会暴露密码，导致安全风险。
*   **滥用风险：** 该 PoC 代码旨在模拟攻击行为。如果被用于非法目的，可能会对目标系统造成损害。

总体而言，该 PoC 代码的投毒风险较低，主要风险来自于依赖项和潜在的滥用。使用该代码时，应谨慎评估风险，并采取必要的安全措施。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #10

**来源**: [CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md](../2025/CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md)

# CVE-2025-33073

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 提权漏洞

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本和Build号在漏洞库信息中已列出

**利用条件:** 需要能够访问目标网络，并且目标机器上存在受影响的SMB客户端版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-33073是Windows SMB客户端中的一个权限提升漏洞，允许经过身份验证的攻击者通过网络提升权限。提供的漏洞利用代码（CVE-2025-33073.py）利用了dnstool.py、ntlmrelayx和nxc等工具，构成了一个完整的攻击链。该攻击链首先使用dnstool.py在域控制器上添加一个恶意的DNS记录。然后，该脚本会等待DNS记录生效。接下来，脚本启动ntlmrelayx，配置为将收到的NTLM认证请求转发到目标机器。最后，脚本通过nxc（用于网络渗透测试）使用PetitPotam、Printerbug或DFSCoerce等强制认证方法，诱使目标机器向攻击者控制的ntlmrelayx服务器进行身份验证，从而利用NTLM relay攻击提升权限。

**有效性分析：**

该POC代码利用了已知的NTLM relay攻击技术，结合DNS欺骗和强制认证方法，在特定条件下可以有效提升权限。漏洞利用代码主要依赖于 `dnstool.py` 添加恶意 DNS 记录，结合 `ntlmrelayx` 监听和中继 NTLM 认证，最后通过 `nxc` 触发强制认证。

**投毒风险分析：**

代码存在一定的投毒风险，但可能性较低，约为5%。原因如下：

*   代码中使用了多个第三方工具（dnstool.py, impacket-ntlmrelayx, nxc）。虽然这些工具本身是合法的渗透测试工具，但如果攻击者修改了脚本，使其在调用这些工具时添加额外的恶意参数或执行恶意操作，则可能存在投毒风险。
*   该脚本本身包含添加DNS记录的操作，如果被滥用，可能会导致网络中断或其他恶意行为。
*   脚本通过 xterm 打开新终端执行命令，这种行为本身可能存在风险。攻击者可能会利用这一点，在终端中执行恶意命令。

**利用方式分析：**

1.  **设置环境:** 攻击者需要一个攻击机（通常是Linux/Kali），安装了必要的工具（dnstool.py，impacket，nxc）。
2.  **DNS欺骗:** 攻击者使用dnstool.py向域控制器添加一个静态DNS记录，将特定的主机名解析到攻击者的IP地址。
3.  **NTLM中继:** 攻击者启动ntlmrelayx，监听传入的NTLM认证请求，并将其转发到目标机器。
4.  **强制认证:** 攻击者使用nxc（或类似工具）结合PetitPotam、Printerbug或DFSCoerce等方法，诱使目标机器通过SMB协议向攻击者控制的ntlmrelayx服务器进行身份验证。
5.  **权限提升:** 一旦目标机器向ntlmrelayx进行身份验证，攻击者就可以利用中继的凭据在目标机器上执行命令，从而提升权限。

**漏洞缓解措施：**

*   安装Microsoft提供的安全更新。
*   启用SMB签名以防止NTLM中继攻击。
*   限制对RPC服务的访问。
*   监控DNS服务器的异常记录。

**项目地址:** [Ashwesker/Blackash-CVE-2025-33073](https://github.com/Ashwesker/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #2

**来源**: [CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 - Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许未经授权的攻击者提升网络上的权限

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要域环境，目标系统在受影响的版本范围内，攻击者位于可访问域控和目标机器的网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许经过身份验证的攻击者通过SMB客户端提升权限。利用方式如下：

1.  **利用 `dnstool.py` 添加恶意DNS记录:**  攻击者首先使用提供的`dnstool.py`脚本在域控制器上添加一个恶意的DNS记录，将一个特定的主机名（`STATIC_DNS_RECORD`）解析到攻击者的IP地址。这通常需要有效的域用户凭据。
2.  **等待DNS记录传播:** 脚本会等待新添加的DNS记录在DNS服务器上生效，确保目标系统能够解析到攻击者的IP。
3.  **启动 `ntlmrelayx` 监听器:** 使用 `impacket` 工具集中的 `ntlmrelayx` 启动一个NTLM中继服务器。这个服务器会监听来自目标系统的NTLM认证请求，并将其转发到另一个目标（`--target`），通常是域控制器本身，以获取权限。
4.  **触发NTLM认证请求:**  使用 `nxc` (crackmapexec的修改版本)  配合 `coerce_plus` 模块，通过诸如`PetitPotam`、`Printerbug`或`DFSCoerce`之类的方法强制目标服务器向攻击者控制的IP地址进行NTLM认证。这些方法通常利用Windows服务的特性来触发认证。
5.  **NTLM中继和权限提升:** `ntlmrelayx` 将收到的NTLM认证请求中继到域控制器，如果relay成功，攻击者可以模拟目标机器的身份，从而执行操作，例如添加用户、修改组策略或者执行任意命令。根据`--custom-command`参数，可以指定要执行的命令，默认情况下可能执行`secretsdump.py`来转储域凭据。

**有效性评估:**  提供的POC代码看起来是有效的，它结合了多个已知的攻击技术（DNS欺骗、NTLM中继、强制认证）来实现权限提升。  成功利用该漏洞取决于多个因素，包括目标系统的配置、网络环境以及所使用的强制认证方法的有效性。

**投毒风险评估:** 通过对POC代码的分析，没有发现明显的恶意或投毒代码。所有操作都是为了实现合法的攻击流程，没有隐藏的后门或破坏性行为。因此，投毒风险评估为0%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-33073](https://github.com/B1ack4sh/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #3

**来源**: [CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 见漏洞库信息

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞是Windows SMB客户端中的一个权限提升漏洞（CVE-2025-33073），由于SMB协议栈中存在不正确的访问控制机制导致。攻击者可以通过网络利用此漏洞提升权限。

**有效性评估：**
根据提供的漏洞库信息，该漏洞影响多个Windows版本，且CVSS评分为8.8，表明漏洞严重性较高。提供的漏洞利用代码包含Python和PowerShell的PoC，增加了利用的灵活性。代码描述了利用不正确的访问控制来构造SMB2数据包，从而导致权限提升。综合来看，PoC代码具有一定的有效性。

**投毒风险分析：**
虽然代码库提供了多种利用方式（Python和Powershell），但仍然存在一定的投毒风险。
1.  **代码复杂性：** SMB协议本身比较复杂，PoC代码必然涉及大量的协议细节，这使得在不完全理解协议的情况下，难以判断是否存在恶意代码。
2.  **权限提升的利用方式：** 权限提升漏洞本身就可能被用于植入后门，例如在提升权限后，修改系统文件，添加恶意服务等。
3.  **作者声明的免责声明：**虽然作者在`README.md`中声明该框架仅用于授权的安全研究、教育目的和受控测试环境，并强调了使用限制和风险缓解措施，但免责声明不能完全排除恶意使用的可能性。

基于以上分析，初步判断存在20%的投毒风险，需要进一步的代码审计来确认是否存在后门或恶意行为。

**利用方式：**
1.  **搭建恶意SMB服务器：** 攻击者需要搭建一个恶意的SMB服务器，该服务器能够响应客户端的SMB请求。
2.  **构造恶意SMB数据包：** 攻击者利用PoC代码构造恶意的SMB数据包，例如精心设计的协商请求或会话设置请求，触发SMB客户端的漏洞。
3.  **触发权限提升：** 当受害者（SMB客户端）连接到攻击者的恶意SMB服务器并处理恶意数据包时，由于不正确的访问控制，攻击者可以提升在受害者系统上的权限。
4. **代码中的利用方法:** 代码中的利用方法主要分为以下几种：
   * 利用python实现的smb_exploit_framework.py脚本进行攻击
   * 利用python实现的admin_exploit_framework.py脚本进行攻击,需要管理员权限
   * 通过PowerShell脚本exploit.ps1进行攻击

**风险提示：**
在实际测试和分析PoC代码时，务必在隔离的环境中进行，避免对生产系统造成影响。进行详细的代码审计是发现潜在投毒代码的必要步骤。

**项目地址:** [SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #4

**来源**: [CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server (2008-2025)，具体版本请参考CVE描述。

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

根据提供的漏洞信息和利用代码，CVE-2025-33073是一个Windows SMB客户端的特权提升漏洞。攻击者可以通过网络发送特制的SMB数据包，利用SMB协议栈中不正确的访问控制机制，从而提升权限。

**有效性：**
提供的POC代码包含多个文件，包括Python脚本（`smb_exploit_framework.py`, `admin_exploit_framework.py`）和PowerShell脚本(`exploit.ps1`)，以及一个批处理文件(`run_as_admin.bat`)。这些文件表明存在多种利用该漏洞的方法。`README.md` 文件详细描述了漏洞原理和利用步骤，包括构建恶意SMB服务器和客户端，以及构造特定的SMB2数据包来触发漏洞。如果目标系统在受影响的版本范围内，并且没有安装相应的安全补丁，则提供的POC代码很可能有效。

**投毒风险：**
虽然`README.md`文件声明该框架仅用于授权的安全研究和教育目的，但仍然存在投毒的风险。以下是一些潜在的风险点：
*   **代码复杂度:** 虽然代码提供了利用思路,但缺乏具体的exp细节实现，增加了分析难度，可能会隐藏恶意代码。  
*   **管理员权限要求:** `admin_exploit_framework.py`和`run_as_admin.bat`需要管理员权限才能运行，这表明该漏洞可能被用于在已入侵系统上提升权限，或者执行恶意操作。
*   **Payload定制：** 攻击者可能修改POC代码，嵌入额外的恶意Payload，例如反向Shell或远程控制木马，从而实现更深层次的入侵。
*   **日志记录：** 攻击者可能篡改日志记录功能，以隐藏其攻击行为。

综合考虑，该POC代码存在一定的投毒风险，估计为20%。使用者应仔细审查代码，并在隔离环境中进行测试，以避免潜在的危害。

**利用方式：**
1.  **搭建恶意SMB服务器：** 使用`smb_exploit_framework.py`或类似脚本创建一个模拟恶意SMB服务器。该服务器会监听特定的端口（通常是445），等待受害者连接。
2.  **客户端连接：** 受害者的Windows SMB客户端尝试连接到恶意SMB服务器。
3.  **数据包构造：** 恶意SMB服务器发送特制的SMB2数据包，利用SMB客户端的访问控制漏洞。
4.  **权限提升：** 如果漏洞利用成功，攻击者可以在受害者系统上获得更高的权限。
5.  **PowerShell利用：** 可以通过PowerShell脚本（`exploit.ps1`）执行，允许通过命令行指定目标主机和端口。
6.  **利用SMB协商阶段，会话建立阶段的漏洞。**

**项目地址:** [SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #5

**来源**: [CVE-2025-33073-cve-2025-33073_cve-2025-33073.md](../2025/CVE-2025-33073-cve-2025-33073_cve-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致网络权限提升

**影响版本:** 受影响的Windows版本详见漏洞描述

**利用条件:** 需要网络访问

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-33073是一个Windows SMB客户端的权限提升漏洞。攻击者可以通过不当的访问控制，在网络上提升权限。受影响的系统包括多个版本的Windows 10、Windows Server等。漏洞利用的复杂度较低，容易被利用，CVSS评分为8.8，属于高危漏洞。

然而，提供的“漏洞利用代码”实际上是一个个人介绍文件，与SMB漏洞利用无关。该文件内容为葡萄牙语，描述了作者的编程技能和爱好，包括C++, Java, PHP, Python和C#，以及信息安全。**因此，这段代码本身并不能用于利用CVE-2025-33073漏洞，且存在严重的投毒风险，因为其与漏洞描述完全不符。**

**利用方式分析：**

由于缺乏有效的PoC代码，无法确定具体利用方式。根据漏洞描述，该漏洞与SMB客户端的权限提升有关，攻击者可能通过构造恶意的SMB请求或响应，利用SMB协议中的缺陷来提升权限。可能的利用方式包括:

1.  **中间人攻击：** 攻击者拦截SMB客户端与服务器之间的通信，篡改SMB协议数据包，从而提升权限。
2.  **恶意SMB服务器：** 攻击者搭建恶意的SMB服务器，诱导受害者连接，利用服务器端的漏洞来提升权限。
3.  **利用SMB客户端解析漏洞：** 攻击者发送特制的SMB数据包，触发客户端的解析漏洞，从而执行恶意代码。

需要注意的是，具体利用方式取决于漏洞的根本原因，在没有有效PoC的情况下，只能进行推测。

**项目地址:** [cve-2025-33073/cve-2025-33073](https://github.com/cve-2025-33073/cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #6

**来源**: [CVE-2025-33073-joaozixx_CVE-2025-33073.md](../2025/CVE-2025-33073-joaozixx_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本（参见CVE描述中的版本范围）

**利用条件:** 攻击者需要位于与目标系统相同的网络中，并拥有有效的域凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞，允许经过身份验证的攻击者通过不正确的访问控制提升权限。该漏洞利用链包含以下步骤：

1.  **添加恶意DNS记录:** 使用dnstool.py工具，通过提供的用户名和密码，在域控制器的DNS服务器上添加一个恶意的DNS记录。这个记录将攻击者的IP地址与特定的DNS名称（`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`）关联起来。
2.  **验证DNS记录:** 脚本会等待恶意DNS记录生效，通过`dig`命令进行验证，确保记录已经成功添加到DNS服务器并且可以解析。
3.  **启动NTLM Relay:** 脚本启动`ntlmrelayx`工具，监听传入的NTLM认证请求，并将其转发到目标服务器。可以指定自定义命令，或者使用默认的`secretsdump`来提取目标系统的凭据。可以选择通过xterm启动，或直接在当前终端运行。
4.  **触发PetitPotam强制认证:** 脚本利用`nxc`（`netexec`）工具，通过PetitPotam（`coerce_plus`模块）强制目标服务器向攻击者控制的服务器进行NTLM认证。PetitPotam通过MS-EFSRPC协议触发认证。目标服务器会尝试解析之前添加的恶意DNS记录，并将NTLM认证信息发送到攻击者的`ntlmrelayx`监听器。

整个过程依赖于NTLM中继攻击，以及利用PetitPotam强制目标机器向攻击者控制的服务器进行认证。攻击者利用中继的NTLM认证信息，可以执行任意命令或提取目标系统的敏感信息，从而提升权限。

**有效性：**
根据搜索结果和提供的PoC代码，此PoC利用链看起来是有效的。Synacktiv的博客文章详细分析了此漏洞，并提供了利用此漏洞绕过NTLM反射缓解措施的方法。PoC代码旨在自动化整个攻击链。

**投毒风险：**
PoC代码本身没有明显的投毒代码，但存在以下潜在风险：

*   **依赖项风险：** 该脚本依赖于`dnstool.py`、`impacket-ntlmrelayx`和`nxc`。如果这些依赖项本身被篡改或包含恶意代码，那么使用该脚本也可能受到影响。
*   **滥用风险：** 该脚本提供的功能可以被滥用于未经授权的渗透测试或攻击。脚本作者或未经授权的第三方可能会修改该脚本以包含其他恶意功能，例如植入后门、删除数据等。但从现有代码本身来看，直接植入后门代码的概率较低,大约为10%，因为代码流程比较清晰，主要是调用现有的工具和库。

**利用方式总结：**
该漏洞利用方式的核心是利用NTLM中继攻击，结合恶意DNS记录和PetitPotam强制认证，将目标服务器的NTLM认证信息中继到攻击者控制的服务器，并利用这些信息提升权限。攻击者首先诱使目标服务器向攻击者控制的服务器进行认证，然后利用中继的认证信息执行任意命令或提取敏感信息。

**项目地址:** [joaozixx/CVE-2025-33073](https://github.com/joaozixx/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #7

**来源**: [CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md](../2025/CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者在网络上提升权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要受害者系统存在于与攻击者相同的网络中，并且攻击者需要具有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-33073 是一个 Windows SMB 客户端提权漏洞。该漏洞的利用方式是首先检查目标服务器是否禁用了 SMB 签名。如果 SMB 签名被禁用，攻击者可以使用 PetitPotam 强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证，从而进行 NTLM 中继攻击，最终提升权限。POC代码通过 crackmapexec 工具来检查 SMB 签名状态，使用 netcat 监听 445 端口，并利用 PetitPotam 脚本发起 NTLM 身份验证强制攻击。

**有效性评估:** 提供的 POC 代码看起来有效。它包含了检测漏洞和利用漏洞的必要步骤。它首先检查 SMB 签名是否禁用，然后尝试使用 PetitPotam 进行 NTLM 身份验证强制。

**投毒风险评估:** 投毒风险评估为20%。 虽然该脚本主要目的是验证漏洞的存在，但存在轻微的投毒风险，原因如下：

1.  **依赖外部脚本 (PetitPotam.py):** 该脚本依赖于从外部源下载的 PetitPotam.py 脚本。如果该脚本被恶意修改，则可能导致受害者系统被感染。
2.  **执行系统命令（sudo nc）:** 该脚本使用 `sudo nc` 启动 netcat 监听器，这可能会引入安全风险，尤其是在配置不当的情况下。
3.  **硬编码域名：**脚本的 README.md 文件提示需要在DNS中注册一个域名(`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`)，如果攻击者控制了受害者的DNS服务器，则可以劫持该域名并造成进一步的攻击。

**利用方式:**

1.  **环境准备:**  攻击者需要安装 crackmapexec, netcat, python3, 并且获得一个有效的域用户凭据。
2.  **检查 SMB 签名:** 使用 crackmapexec 工具检查目标服务器是否禁用了 SMB 签名。
3.  **强制身份验证:** 如果 SMB 签名被禁用，攻击者使用 PetitPotam 脚本强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证。
4.  **NTLM 中继:**  攻击者使用 netcat 监听 445 端口，捕获 NTLM 身份验证信息。
5.  **权限提升:**  攻击者利用捕获到的 NTLM 身份验证信息进行 NTLM 中继攻击，最终提升权限。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #8

**来源**: [CVE-2025-33073-mverschu_CVE-2025-33073.md](../2025/CVE-2025-33073-mverschu_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致域内权限提升和远程代码执行

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 需要攻击者在域内，并且目标主机受到漏洞影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 是一个Windows SMB客户端权限提升漏洞。该漏洞允许经过身份验证的攻击者通过SMB协议提升权限。提供的PoC代码利用了dnstool.py来添加恶意DNS记录，然后使用ntlmrelayx进行NTLM中继攻击，最后使用PetitPotam或其他类似方法触发目标机器向攻击者控制的服务器进行身份验证，从而通过NTLM中继获得目标机器的权限。 

**有效性分析：**
PoC代码看起来有效，因为它涵盖了NTLM中继攻击的典型步骤：
1.  添加恶意DNS记录，使目标机器解析特定主机名为攻击者控制的IP地址。
2.  启动ntlmrelayx监听器，等待NTLM身份验证请求。
3.  使用PetitPotam或其他强制身份验证的方法，诱使目标机器向攻击者控制的服务器进行身份验证。
4.  ntlmrelayx中继身份验证到目标服务器，执行任意命令，从而提升权限。

**投毒风险分析：**
代码中存在一定投毒风险，但概率较低（10%）。
*   `dnstool.py` 脚本的安全性需要进一步审查，如果该脚本本身存在漏洞，则可能被用于植入后门或者执行恶意操作。
*   代码使用了`subprocess.run` 和 `subprocess.Popen`，这些函数如果使用不当，可能会受到命令注入攻击。
*   PoC 依赖于 `impacket` 和 `nxc` 这两个第三方库。虽然这两个库本身很常用，但如果攻击者修改了 PoC，加入了从恶意源下载这些库的逻辑，就有可能引入恶意代码。
*   代码中使用了静态DNS记录，这可能会导致攻击行为更容易被检测。

**漏洞利用方式：**
1.  攻击者首先需要位于与目标机器相同的网络中。
2.  攻击者使用提供的PoC代码，指定用户名、密码、攻击者IP、DNS服务器IP、域控制器FQDN以及目标机器IP。
3.  PoC代码使用dnstool.py在DNS服务器上添加一个恶意的DNS记录，将特定的域名解析到攻击者控制的IP地址。
4.  PoC代码启动ntlmrelayx，监听传入的NTLM身份验证请求。
5.  PoC代码使用PetitPotam, Printerbug 或 DFSCoerce 等方法诱使目标机器向攻击者控制的IP地址发起NTLM身份验证。
6.  ntlmrelayx截获NTLM身份验证信息，并将其转发到目标机器。
7.  成功中继NTLM身份验证后，攻击者可以在目标机器上执行任意命令，从而提升权限。

**排序优先级考虑：** 由于没有提供搜索结果，漏洞利用代码的分析比漏洞库信息更具优先级。 代码本身提供更详细的攻击步骤，对风险判断、利用方式分析更有帮助。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #9

**来源**: [CVE-2025-33073-obscura-cert_CVE-2025-33073.md](../2025/CVE-2025-33073-obscura-cert_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，攻击者可通过网络提升权限

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参考CVE信息

**利用条件:** 攻击者需要位于同一网络，且能够访问SMB服务，需要受害者触发SMB连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 描述的是 Windows SMB 客户端的权限提升漏洞。攻击者可以利用该漏洞通过网络提升权限。

**利用方式分析：**

根据提供的漏洞利用代码，这是一个结合了 DNS 注入、NTLM 中继和 RPC 强制身份验证的攻击链。具体流程如下：

1.  **DNS 注入：** 使用 `samba-tool` 向 DNS 服务器添加一条 A 记录，将一个子域名指向攻击者的 IP 地址。这需要管理员权限。
2.  **DNS 记录验证：** 验证 DNS 记录是否成功传播，确保目标系统可以解析到攻击者的 IP。
3.  **NTLM 中继：** 启动 `impacket-ntlmrelayx` 工具，监听 NTLM 认证请求，并将请求中继到目标服务器。
4.  **RPC 强制身份验证：** 使用 `rpcping` 工具，强制目标系统通过 SMB 协议连接到攻击者控制的域名，触发 NTLM 认证。`rpcping` 通过 `spoolss` 管道强制进行身份验证。
5.  **权限提升：** 一旦 NTLM 认证被中继到目标服务器，攻击者就可以利用 `ntlmrelayx` 获取目标服务器的权限，从而提升在目标服务器上的权限。

**有效性分析：**

该PoC 代码逻辑完整，覆盖了利用该漏洞所需的关键步骤。根据CVE描述 Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.如果环境配置正确（例如，攻击者可以成功注入 DNS 记录，受害者系统存在 NTLM 中继的漏洞等），则该 PoC 代码应能成功利用该漏洞。

**投毒风险分析：**

检查 PoC 代码，发现该脚本主要实现了 DNS 注入、NTLM relay和RPC 强制身份验证。没有直接发现恶意代码或后门。虽然代码本身没有明显的恶意行为，但仍存在一定的投毒风险，占比约为10%：

*   **依赖风险：** 该脚本依赖于 `samba-tool` 和 `impacket-ntlmrelayx`。如果这些依赖库被恶意篡改，可能会导致意外的恶意行为。
*   **密码硬编码：** 代码中存在硬编码的管理员密码 `YourPassword`。攻击者如果直接使用该代码，可能会暴露密码，导致安全风险。
*   **滥用风险：** 该 PoC 代码旨在模拟攻击行为。如果被用于非法目的，可能会对目标系统造成损害。

总体而言，该 PoC 代码的投毒风险较低，主要风险来自于依赖项和潜在的滥用。使用该代码时，应谨慎评估风险，并采取必要的安全措施。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #10

**来源**: [CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md](../2025/CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md)

# CVE-2025-33073

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 提权漏洞

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本和Build号在漏洞库信息中已列出

**利用条件:** 需要能够访问目标网络，并且目标机器上存在受影响的SMB客户端版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-33073是Windows SMB客户端中的一个权限提升漏洞，允许经过身份验证的攻击者通过网络提升权限。提供的漏洞利用代码（CVE-2025-33073.py）利用了dnstool.py、ntlmrelayx和nxc等工具，构成了一个完整的攻击链。该攻击链首先使用dnstool.py在域控制器上添加一个恶意的DNS记录。然后，该脚本会等待DNS记录生效。接下来，脚本启动ntlmrelayx，配置为将收到的NTLM认证请求转发到目标机器。最后，脚本通过nxc（用于网络渗透测试）使用PetitPotam、Printerbug或DFSCoerce等强制认证方法，诱使目标机器向攻击者控制的ntlmrelayx服务器进行身份验证，从而利用NTLM relay攻击提升权限。

**有效性分析：**

该POC代码利用了已知的NTLM relay攻击技术，结合DNS欺骗和强制认证方法，在特定条件下可以有效提升权限。漏洞利用代码主要依赖于 `dnstool.py` 添加恶意 DNS 记录，结合 `ntlmrelayx` 监听和中继 NTLM 认证，最后通过 `nxc` 触发强制认证。

**投毒风险分析：**

代码存在一定的投毒风险，但可能性较低，约为5%。原因如下：

*   代码中使用了多个第三方工具（dnstool.py, impacket-ntlmrelayx, nxc）。虽然这些工具本身是合法的渗透测试工具，但如果攻击者修改了脚本，使其在调用这些工具时添加额外的恶意参数或执行恶意操作，则可能存在投毒风险。
*   该脚本本身包含添加DNS记录的操作，如果被滥用，可能会导致网络中断或其他恶意行为。
*   脚本通过 xterm 打开新终端执行命令，这种行为本身可能存在风险。攻击者可能会利用这一点，在终端中执行恶意命令。

**利用方式分析：**

1.  **设置环境:** 攻击者需要一个攻击机（通常是Linux/Kali），安装了必要的工具（dnstool.py，impacket，nxc）。
2.  **DNS欺骗:** 攻击者使用dnstool.py向域控制器添加一个静态DNS记录，将特定的主机名解析到攻击者的IP地址。
3.  **NTLM中继:** 攻击者启动ntlmrelayx，监听传入的NTLM认证请求，并将其转发到目标机器。
4.  **强制认证:** 攻击者使用nxc（或类似工具）结合PetitPotam、Printerbug或DFSCoerce等方法，诱使目标机器通过SMB协议向攻击者控制的ntlmrelayx服务器进行身份验证。
5.  **权限提升:** 一旦目标机器向ntlmrelayx进行身份验证，攻击者就可以利用中继的凭据在目标机器上执行命令，从而提升权限。

**漏洞缓解措施：**

*   安装Microsoft提供的安全更新。
*   启用SMB签名以防止NTLM中继攻击。
*   限制对RPC服务的访问。
*   监控DNS服务器的异常记录。

**项目地址:** [Ashwesker/Blackash-CVE-2025-33073](https://github.com/Ashwesker/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #2

**来源**: [CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 - Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许未经授权的攻击者提升网络上的权限

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要域环境，目标系统在受影响的版本范围内，攻击者位于可访问域控和目标机器的网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许经过身份验证的攻击者通过SMB客户端提升权限。利用方式如下：

1.  **利用 `dnstool.py` 添加恶意DNS记录:**  攻击者首先使用提供的`dnstool.py`脚本在域控制器上添加一个恶意的DNS记录，将一个特定的主机名（`STATIC_DNS_RECORD`）解析到攻击者的IP地址。这通常需要有效的域用户凭据。
2.  **等待DNS记录传播:** 脚本会等待新添加的DNS记录在DNS服务器上生效，确保目标系统能够解析到攻击者的IP。
3.  **启动 `ntlmrelayx` 监听器:** 使用 `impacket` 工具集中的 `ntlmrelayx` 启动一个NTLM中继服务器。这个服务器会监听来自目标系统的NTLM认证请求，并将其转发到另一个目标（`--target`），通常是域控制器本身，以获取权限。
4.  **触发NTLM认证请求:**  使用 `nxc` (crackmapexec的修改版本)  配合 `coerce_plus` 模块，通过诸如`PetitPotam`、`Printerbug`或`DFSCoerce`之类的方法强制目标服务器向攻击者控制的IP地址进行NTLM认证。这些方法通常利用Windows服务的特性来触发认证。
5.  **NTLM中继和权限提升:** `ntlmrelayx` 将收到的NTLM认证请求中继到域控制器，如果relay成功，攻击者可以模拟目标机器的身份，从而执行操作，例如添加用户、修改组策略或者执行任意命令。根据`--custom-command`参数，可以指定要执行的命令，默认情况下可能执行`secretsdump.py`来转储域凭据。

**有效性评估:**  提供的POC代码看起来是有效的，它结合了多个已知的攻击技术（DNS欺骗、NTLM中继、强制认证）来实现权限提升。  成功利用该漏洞取决于多个因素，包括目标系统的配置、网络环境以及所使用的强制认证方法的有效性。

**投毒风险评估:** 通过对POC代码的分析，没有发现明显的恶意或投毒代码。所有操作都是为了实现合法的攻击流程，没有隐藏的后门或破坏性行为。因此，投毒风险评估为0%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-33073](https://github.com/B1ack4sh/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #3

**来源**: [CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 见漏洞库信息

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞是Windows SMB客户端中的一个权限提升漏洞（CVE-2025-33073），由于SMB协议栈中存在不正确的访问控制机制导致。攻击者可以通过网络利用此漏洞提升权限。

**有效性评估：**
根据提供的漏洞库信息，该漏洞影响多个Windows版本，且CVSS评分为8.8，表明漏洞严重性较高。提供的漏洞利用代码包含Python和PowerShell的PoC，增加了利用的灵活性。代码描述了利用不正确的访问控制来构造SMB2数据包，从而导致权限提升。综合来看，PoC代码具有一定的有效性。

**投毒风险分析：**
虽然代码库提供了多种利用方式（Python和Powershell），但仍然存在一定的投毒风险。
1.  **代码复杂性：** SMB协议本身比较复杂，PoC代码必然涉及大量的协议细节，这使得在不完全理解协议的情况下，难以判断是否存在恶意代码。
2.  **权限提升的利用方式：** 权限提升漏洞本身就可能被用于植入后门，例如在提升权限后，修改系统文件，添加恶意服务等。
3.  **作者声明的免责声明：**虽然作者在`README.md`中声明该框架仅用于授权的安全研究、教育目的和受控测试环境，并强调了使用限制和风险缓解措施，但免责声明不能完全排除恶意使用的可能性。

基于以上分析，初步判断存在20%的投毒风险，需要进一步的代码审计来确认是否存在后门或恶意行为。

**利用方式：**
1.  **搭建恶意SMB服务器：** 攻击者需要搭建一个恶意的SMB服务器，该服务器能够响应客户端的SMB请求。
2.  **构造恶意SMB数据包：** 攻击者利用PoC代码构造恶意的SMB数据包，例如精心设计的协商请求或会话设置请求，触发SMB客户端的漏洞。
3.  **触发权限提升：** 当受害者（SMB客户端）连接到攻击者的恶意SMB服务器并处理恶意数据包时，由于不正确的访问控制，攻击者可以提升在受害者系统上的权限。
4. **代码中的利用方法:** 代码中的利用方法主要分为以下几种：
   * 利用python实现的smb_exploit_framework.py脚本进行攻击
   * 利用python实现的admin_exploit_framework.py脚本进行攻击,需要管理员权限
   * 通过PowerShell脚本exploit.ps1进行攻击

**风险提示：**
在实际测试和分析PoC代码时，务必在隔离的环境中进行，避免对生产系统造成影响。进行详细的代码审计是发现潜在投毒代码的必要步骤。

**项目地址:** [SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #4

**来源**: [CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server (2008-2025)，具体版本请参考CVE描述。

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

根据提供的漏洞信息和利用代码，CVE-2025-33073是一个Windows SMB客户端的特权提升漏洞。攻击者可以通过网络发送特制的SMB数据包，利用SMB协议栈中不正确的访问控制机制，从而提升权限。

**有效性：**
提供的POC代码包含多个文件，包括Python脚本（`smb_exploit_framework.py`, `admin_exploit_framework.py`）和PowerShell脚本(`exploit.ps1`)，以及一个批处理文件(`run_as_admin.bat`)。这些文件表明存在多种利用该漏洞的方法。`README.md` 文件详细描述了漏洞原理和利用步骤，包括构建恶意SMB服务器和客户端，以及构造特定的SMB2数据包来触发漏洞。如果目标系统在受影响的版本范围内，并且没有安装相应的安全补丁，则提供的POC代码很可能有效。

**投毒风险：**
虽然`README.md`文件声明该框架仅用于授权的安全研究和教育目的，但仍然存在投毒的风险。以下是一些潜在的风险点：
*   **代码复杂度:** 虽然代码提供了利用思路,但缺乏具体的exp细节实现，增加了分析难度，可能会隐藏恶意代码。  
*   **管理员权限要求:** `admin_exploit_framework.py`和`run_as_admin.bat`需要管理员权限才能运行，这表明该漏洞可能被用于在已入侵系统上提升权限，或者执行恶意操作。
*   **Payload定制：** 攻击者可能修改POC代码，嵌入额外的恶意Payload，例如反向Shell或远程控制木马，从而实现更深层次的入侵。
*   **日志记录：** 攻击者可能篡改日志记录功能，以隐藏其攻击行为。

综合考虑，该POC代码存在一定的投毒风险，估计为20%。使用者应仔细审查代码，并在隔离环境中进行测试，以避免潜在的危害。

**利用方式：**
1.  **搭建恶意SMB服务器：** 使用`smb_exploit_framework.py`或类似脚本创建一个模拟恶意SMB服务器。该服务器会监听特定的端口（通常是445），等待受害者连接。
2.  **客户端连接：** 受害者的Windows SMB客户端尝试连接到恶意SMB服务器。
3.  **数据包构造：** 恶意SMB服务器发送特制的SMB2数据包，利用SMB客户端的访问控制漏洞。
4.  **权限提升：** 如果漏洞利用成功，攻击者可以在受害者系统上获得更高的权限。
5.  **PowerShell利用：** 可以通过PowerShell脚本（`exploit.ps1`）执行，允许通过命令行指定目标主机和端口。
6.  **利用SMB协商阶段，会话建立阶段的漏洞。**

**项目地址:** [SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #5

**来源**: [CVE-2025-33073-cve-2025-33073_cve-2025-33073.md](../2025/CVE-2025-33073-cve-2025-33073_cve-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致网络权限提升

**影响版本:** 受影响的Windows版本详见漏洞描述

**利用条件:** 需要网络访问

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-33073是一个Windows SMB客户端的权限提升漏洞。攻击者可以通过不当的访问控制，在网络上提升权限。受影响的系统包括多个版本的Windows 10、Windows Server等。漏洞利用的复杂度较低，容易被利用，CVSS评分为8.8，属于高危漏洞。

然而，提供的“漏洞利用代码”实际上是一个个人介绍文件，与SMB漏洞利用无关。该文件内容为葡萄牙语，描述了作者的编程技能和爱好，包括C++, Java, PHP, Python和C#，以及信息安全。**因此，这段代码本身并不能用于利用CVE-2025-33073漏洞，且存在严重的投毒风险，因为其与漏洞描述完全不符。**

**利用方式分析：**

由于缺乏有效的PoC代码，无法确定具体利用方式。根据漏洞描述，该漏洞与SMB客户端的权限提升有关，攻击者可能通过构造恶意的SMB请求或响应，利用SMB协议中的缺陷来提升权限。可能的利用方式包括:

1.  **中间人攻击：** 攻击者拦截SMB客户端与服务器之间的通信，篡改SMB协议数据包，从而提升权限。
2.  **恶意SMB服务器：** 攻击者搭建恶意的SMB服务器，诱导受害者连接，利用服务器端的漏洞来提升权限。
3.  **利用SMB客户端解析漏洞：** 攻击者发送特制的SMB数据包，触发客户端的解析漏洞，从而执行恶意代码。

需要注意的是，具体利用方式取决于漏洞的根本原因，在没有有效PoC的情况下，只能进行推测。

**项目地址:** [cve-2025-33073/cve-2025-33073](https://github.com/cve-2025-33073/cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #6

**来源**: [CVE-2025-33073-joaozixx_CVE-2025-33073.md](../2025/CVE-2025-33073-joaozixx_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本（参见CVE描述中的版本范围）

**利用条件:** 攻击者需要位于与目标系统相同的网络中，并拥有有效的域凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞，允许经过身份验证的攻击者通过不正确的访问控制提升权限。该漏洞利用链包含以下步骤：

1.  **添加恶意DNS记录:** 使用dnstool.py工具，通过提供的用户名和密码，在域控制器的DNS服务器上添加一个恶意的DNS记录。这个记录将攻击者的IP地址与特定的DNS名称（`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`）关联起来。
2.  **验证DNS记录:** 脚本会等待恶意DNS记录生效，通过`dig`命令进行验证，确保记录已经成功添加到DNS服务器并且可以解析。
3.  **启动NTLM Relay:** 脚本启动`ntlmrelayx`工具，监听传入的NTLM认证请求，并将其转发到目标服务器。可以指定自定义命令，或者使用默认的`secretsdump`来提取目标系统的凭据。可以选择通过xterm启动，或直接在当前终端运行。
4.  **触发PetitPotam强制认证:** 脚本利用`nxc`（`netexec`）工具，通过PetitPotam（`coerce_plus`模块）强制目标服务器向攻击者控制的服务器进行NTLM认证。PetitPotam通过MS-EFSRPC协议触发认证。目标服务器会尝试解析之前添加的恶意DNS记录，并将NTLM认证信息发送到攻击者的`ntlmrelayx`监听器。

整个过程依赖于NTLM中继攻击，以及利用PetitPotam强制目标机器向攻击者控制的服务器进行认证。攻击者利用中继的NTLM认证信息，可以执行任意命令或提取目标系统的敏感信息，从而提升权限。

**有效性：**
根据搜索结果和提供的PoC代码，此PoC利用链看起来是有效的。Synacktiv的博客文章详细分析了此漏洞，并提供了利用此漏洞绕过NTLM反射缓解措施的方法。PoC代码旨在自动化整个攻击链。

**投毒风险：**
PoC代码本身没有明显的投毒代码，但存在以下潜在风险：

*   **依赖项风险：** 该脚本依赖于`dnstool.py`、`impacket-ntlmrelayx`和`nxc`。如果这些依赖项本身被篡改或包含恶意代码，那么使用该脚本也可能受到影响。
*   **滥用风险：** 该脚本提供的功能可以被滥用于未经授权的渗透测试或攻击。脚本作者或未经授权的第三方可能会修改该脚本以包含其他恶意功能，例如植入后门、删除数据等。但从现有代码本身来看，直接植入后门代码的概率较低,大约为10%，因为代码流程比较清晰，主要是调用现有的工具和库。

**利用方式总结：**
该漏洞利用方式的核心是利用NTLM中继攻击，结合恶意DNS记录和PetitPotam强制认证，将目标服务器的NTLM认证信息中继到攻击者控制的服务器，并利用这些信息提升权限。攻击者首先诱使目标服务器向攻击者控制的服务器进行认证，然后利用中继的认证信息执行任意命令或提取敏感信息。

**项目地址:** [joaozixx/CVE-2025-33073](https://github.com/joaozixx/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #7

**来源**: [CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md](../2025/CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者在网络上提升权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要受害者系统存在于与攻击者相同的网络中，并且攻击者需要具有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-33073 是一个 Windows SMB 客户端提权漏洞。该漏洞的利用方式是首先检查目标服务器是否禁用了 SMB 签名。如果 SMB 签名被禁用，攻击者可以使用 PetitPotam 强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证，从而进行 NTLM 中继攻击，最终提升权限。POC代码通过 crackmapexec 工具来检查 SMB 签名状态，使用 netcat 监听 445 端口，并利用 PetitPotam 脚本发起 NTLM 身份验证强制攻击。

**有效性评估:** 提供的 POC 代码看起来有效。它包含了检测漏洞和利用漏洞的必要步骤。它首先检查 SMB 签名是否禁用，然后尝试使用 PetitPotam 进行 NTLM 身份验证强制。

**投毒风险评估:** 投毒风险评估为20%。 虽然该脚本主要目的是验证漏洞的存在，但存在轻微的投毒风险，原因如下：

1.  **依赖外部脚本 (PetitPotam.py):** 该脚本依赖于从外部源下载的 PetitPotam.py 脚本。如果该脚本被恶意修改，则可能导致受害者系统被感染。
2.  **执行系统命令（sudo nc）:** 该脚本使用 `sudo nc` 启动 netcat 监听器，这可能会引入安全风险，尤其是在配置不当的情况下。
3.  **硬编码域名：**脚本的 README.md 文件提示需要在DNS中注册一个域名(`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`)，如果攻击者控制了受害者的DNS服务器，则可以劫持该域名并造成进一步的攻击。

**利用方式:**

1.  **环境准备:**  攻击者需要安装 crackmapexec, netcat, python3, 并且获得一个有效的域用户凭据。
2.  **检查 SMB 签名:** 使用 crackmapexec 工具检查目标服务器是否禁用了 SMB 签名。
3.  **强制身份验证:** 如果 SMB 签名被禁用，攻击者使用 PetitPotam 脚本强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证。
4.  **NTLM 中继:**  攻击者使用 netcat 监听 445 端口，捕获 NTLM 身份验证信息。
5.  **权限提升:**  攻击者利用捕获到的 NTLM 身份验证信息进行 NTLM 中继攻击，最终提升权限。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #8

**来源**: [CVE-2025-33073-mverschu_CVE-2025-33073.md](../2025/CVE-2025-33073-mverschu_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致域内权限提升和远程代码执行

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 需要攻击者在域内，并且目标主机受到漏洞影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 是一个Windows SMB客户端权限提升漏洞。该漏洞允许经过身份验证的攻击者通过SMB协议提升权限。提供的PoC代码利用了dnstool.py来添加恶意DNS记录，然后使用ntlmrelayx进行NTLM中继攻击，最后使用PetitPotam或其他类似方法触发目标机器向攻击者控制的服务器进行身份验证，从而通过NTLM中继获得目标机器的权限。 

**有效性分析：**
PoC代码看起来有效，因为它涵盖了NTLM中继攻击的典型步骤：
1.  添加恶意DNS记录，使目标机器解析特定主机名为攻击者控制的IP地址。
2.  启动ntlmrelayx监听器，等待NTLM身份验证请求。
3.  使用PetitPotam或其他强制身份验证的方法，诱使目标机器向攻击者控制的服务器进行身份验证。
4.  ntlmrelayx中继身份验证到目标服务器，执行任意命令，从而提升权限。

**投毒风险分析：**
代码中存在一定投毒风险，但概率较低（10%）。
*   `dnstool.py` 脚本的安全性需要进一步审查，如果该脚本本身存在漏洞，则可能被用于植入后门或者执行恶意操作。
*   代码使用了`subprocess.run` 和 `subprocess.Popen`，这些函数如果使用不当，可能会受到命令注入攻击。
*   PoC 依赖于 `impacket` 和 `nxc` 这两个第三方库。虽然这两个库本身很常用，但如果攻击者修改了 PoC，加入了从恶意源下载这些库的逻辑，就有可能引入恶意代码。
*   代码中使用了静态DNS记录，这可能会导致攻击行为更容易被检测。

**漏洞利用方式：**
1.  攻击者首先需要位于与目标机器相同的网络中。
2.  攻击者使用提供的PoC代码，指定用户名、密码、攻击者IP、DNS服务器IP、域控制器FQDN以及目标机器IP。
3.  PoC代码使用dnstool.py在DNS服务器上添加一个恶意的DNS记录，将特定的域名解析到攻击者控制的IP地址。
4.  PoC代码启动ntlmrelayx，监听传入的NTLM身份验证请求。
5.  PoC代码使用PetitPotam, Printerbug 或 DFSCoerce 等方法诱使目标机器向攻击者控制的IP地址发起NTLM身份验证。
6.  ntlmrelayx截获NTLM身份验证信息，并将其转发到目标机器。
7.  成功中继NTLM身份验证后，攻击者可以在目标机器上执行任意命令，从而提升权限。

**排序优先级考虑：** 由于没有提供搜索结果，漏洞利用代码的分析比漏洞库信息更具优先级。 代码本身提供更详细的攻击步骤，对风险判断、利用方式分析更有帮助。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #9

**来源**: [CVE-2025-33073-obscura-cert_CVE-2025-33073.md](../2025/CVE-2025-33073-obscura-cert_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，攻击者可通过网络提升权限

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参考CVE信息

**利用条件:** 攻击者需要位于同一网络，且能够访问SMB服务，需要受害者触发SMB连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 描述的是 Windows SMB 客户端的权限提升漏洞。攻击者可以利用该漏洞通过网络提升权限。

**利用方式分析：**

根据提供的漏洞利用代码，这是一个结合了 DNS 注入、NTLM 中继和 RPC 强制身份验证的攻击链。具体流程如下：

1.  **DNS 注入：** 使用 `samba-tool` 向 DNS 服务器添加一条 A 记录，将一个子域名指向攻击者的 IP 地址。这需要管理员权限。
2.  **DNS 记录验证：** 验证 DNS 记录是否成功传播，确保目标系统可以解析到攻击者的 IP。
3.  **NTLM 中继：** 启动 `impacket-ntlmrelayx` 工具，监听 NTLM 认证请求，并将请求中继到目标服务器。
4.  **RPC 强制身份验证：** 使用 `rpcping` 工具，强制目标系统通过 SMB 协议连接到攻击者控制的域名，触发 NTLM 认证。`rpcping` 通过 `spoolss` 管道强制进行身份验证。
5.  **权限提升：** 一旦 NTLM 认证被中继到目标服务器，攻击者就可以利用 `ntlmrelayx` 获取目标服务器的权限，从而提升在目标服务器上的权限。

**有效性分析：**

该PoC 代码逻辑完整，覆盖了利用该漏洞所需的关键步骤。根据CVE描述 Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.如果环境配置正确（例如，攻击者可以成功注入 DNS 记录，受害者系统存在 NTLM 中继的漏洞等），则该 PoC 代码应能成功利用该漏洞。

**投毒风险分析：**

检查 PoC 代码，发现该脚本主要实现了 DNS 注入、NTLM relay和RPC 强制身份验证。没有直接发现恶意代码或后门。虽然代码本身没有明显的恶意行为，但仍存在一定的投毒风险，占比约为10%：

*   **依赖风险：** 该脚本依赖于 `samba-tool` 和 `impacket-ntlmrelayx`。如果这些依赖库被恶意篡改，可能会导致意外的恶意行为。
*   **密码硬编码：** 代码中存在硬编码的管理员密码 `YourPassword`。攻击者如果直接使用该代码，可能会暴露密码，导致安全风险。
*   **滥用风险：** 该 PoC 代码旨在模拟攻击行为。如果被用于非法目的，可能会对目标系统造成损害。

总体而言，该 PoC 代码的投毒风险较低，主要风险来自于依赖项和潜在的滥用。使用该代码时，应谨慎评估风险，并采取必要的安全措施。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #10

**来源**: [CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md](../2025/CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md)

# CVE-2025-33073

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 提权漏洞

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本和Build号在漏洞库信息中已列出

**利用条件:** 需要能够访问目标网络，并且目标机器上存在受影响的SMB客户端版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-33073是Windows SMB客户端中的一个权限提升漏洞，允许经过身份验证的攻击者通过网络提升权限。提供的漏洞利用代码（CVE-2025-33073.py）利用了dnstool.py、ntlmrelayx和nxc等工具，构成了一个完整的攻击链。该攻击链首先使用dnstool.py在域控制器上添加一个恶意的DNS记录。然后，该脚本会等待DNS记录生效。接下来，脚本启动ntlmrelayx，配置为将收到的NTLM认证请求转发到目标机器。最后，脚本通过nxc（用于网络渗透测试）使用PetitPotam、Printerbug或DFSCoerce等强制认证方法，诱使目标机器向攻击者控制的ntlmrelayx服务器进行身份验证，从而利用NTLM relay攻击提升权限。

**有效性分析：**

该POC代码利用了已知的NTLM relay攻击技术，结合DNS欺骗和强制认证方法，在特定条件下可以有效提升权限。漏洞利用代码主要依赖于 `dnstool.py` 添加恶意 DNS 记录，结合 `ntlmrelayx` 监听和中继 NTLM 认证，最后通过 `nxc` 触发强制认证。

**投毒风险分析：**

代码存在一定的投毒风险，但可能性较低，约为5%。原因如下：

*   代码中使用了多个第三方工具（dnstool.py, impacket-ntlmrelayx, nxc）。虽然这些工具本身是合法的渗透测试工具，但如果攻击者修改了脚本，使其在调用这些工具时添加额外的恶意参数或执行恶意操作，则可能存在投毒风险。
*   该脚本本身包含添加DNS记录的操作，如果被滥用，可能会导致网络中断或其他恶意行为。
*   脚本通过 xterm 打开新终端执行命令，这种行为本身可能存在风险。攻击者可能会利用这一点，在终端中执行恶意命令。

**利用方式分析：**

1.  **设置环境:** 攻击者需要一个攻击机（通常是Linux/Kali），安装了必要的工具（dnstool.py，impacket，nxc）。
2.  **DNS欺骗:** 攻击者使用dnstool.py向域控制器添加一个静态DNS记录，将特定的主机名解析到攻击者的IP地址。
3.  **NTLM中继:** 攻击者启动ntlmrelayx，监听传入的NTLM认证请求，并将其转发到目标机器。
4.  **强制认证:** 攻击者使用nxc（或类似工具）结合PetitPotam、Printerbug或DFSCoerce等方法，诱使目标机器通过SMB协议向攻击者控制的ntlmrelayx服务器进行身份验证。
5.  **权限提升:** 一旦目标机器向ntlmrelayx进行身份验证，攻击者就可以利用中继的凭据在目标机器上执行命令，从而提升权限。

**漏洞缓解措施：**

*   安装Microsoft提供的安全更新。
*   启用SMB签名以防止NTLM中继攻击。
*   限制对RPC服务的访问。
*   监控DNS服务器的异常记录。

**项目地址:** [Ashwesker/Blackash-CVE-2025-33073](https://github.com/Ashwesker/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #2

**来源**: [CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 - Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许未经授权的攻击者提升网络上的权限

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要域环境，目标系统在受影响的版本范围内，攻击者位于可访问域控和目标机器的网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许经过身份验证的攻击者通过SMB客户端提升权限。利用方式如下：

1.  **利用 `dnstool.py` 添加恶意DNS记录:**  攻击者首先使用提供的`dnstool.py`脚本在域控制器上添加一个恶意的DNS记录，将一个特定的主机名（`STATIC_DNS_RECORD`）解析到攻击者的IP地址。这通常需要有效的域用户凭据。
2.  **等待DNS记录传播:** 脚本会等待新添加的DNS记录在DNS服务器上生效，确保目标系统能够解析到攻击者的IP。
3.  **启动 `ntlmrelayx` 监听器:** 使用 `impacket` 工具集中的 `ntlmrelayx` 启动一个NTLM中继服务器。这个服务器会监听来自目标系统的NTLM认证请求，并将其转发到另一个目标（`--target`），通常是域控制器本身，以获取权限。
4.  **触发NTLM认证请求:**  使用 `nxc` (crackmapexec的修改版本)  配合 `coerce_plus` 模块，通过诸如`PetitPotam`、`Printerbug`或`DFSCoerce`之类的方法强制目标服务器向攻击者控制的IP地址进行NTLM认证。这些方法通常利用Windows服务的特性来触发认证。
5.  **NTLM中继和权限提升:** `ntlmrelayx` 将收到的NTLM认证请求中继到域控制器，如果relay成功，攻击者可以模拟目标机器的身份，从而执行操作，例如添加用户、修改组策略或者执行任意命令。根据`--custom-command`参数，可以指定要执行的命令，默认情况下可能执行`secretsdump.py`来转储域凭据。

**有效性评估:**  提供的POC代码看起来是有效的，它结合了多个已知的攻击技术（DNS欺骗、NTLM中继、强制认证）来实现权限提升。  成功利用该漏洞取决于多个因素，包括目标系统的配置、网络环境以及所使用的强制认证方法的有效性。

**投毒风险评估:** 通过对POC代码的分析，没有发现明显的恶意或投毒代码。所有操作都是为了实现合法的攻击流程，没有隐藏的后门或破坏性行为。因此，投毒风险评估为0%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-33073](https://github.com/B1ack4sh/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #3

**来源**: [CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 见漏洞库信息

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞是Windows SMB客户端中的一个权限提升漏洞（CVE-2025-33073），由于SMB协议栈中存在不正确的访问控制机制导致。攻击者可以通过网络利用此漏洞提升权限。

**有效性评估：**
根据提供的漏洞库信息，该漏洞影响多个Windows版本，且CVSS评分为8.8，表明漏洞严重性较高。提供的漏洞利用代码包含Python和PowerShell的PoC，增加了利用的灵活性。代码描述了利用不正确的访问控制来构造SMB2数据包，从而导致权限提升。综合来看，PoC代码具有一定的有效性。

**投毒风险分析：**
虽然代码库提供了多种利用方式（Python和Powershell），但仍然存在一定的投毒风险。
1.  **代码复杂性：** SMB协议本身比较复杂，PoC代码必然涉及大量的协议细节，这使得在不完全理解协议的情况下，难以判断是否存在恶意代码。
2.  **权限提升的利用方式：** 权限提升漏洞本身就可能被用于植入后门，例如在提升权限后，修改系统文件，添加恶意服务等。
3.  **作者声明的免责声明：**虽然作者在`README.md`中声明该框架仅用于授权的安全研究、教育目的和受控测试环境，并强调了使用限制和风险缓解措施，但免责声明不能完全排除恶意使用的可能性。

基于以上分析，初步判断存在20%的投毒风险，需要进一步的代码审计来确认是否存在后门或恶意行为。

**利用方式：**
1.  **搭建恶意SMB服务器：** 攻击者需要搭建一个恶意的SMB服务器，该服务器能够响应客户端的SMB请求。
2.  **构造恶意SMB数据包：** 攻击者利用PoC代码构造恶意的SMB数据包，例如精心设计的协商请求或会话设置请求，触发SMB客户端的漏洞。
3.  **触发权限提升：** 当受害者（SMB客户端）连接到攻击者的恶意SMB服务器并处理恶意数据包时，由于不正确的访问控制，攻击者可以提升在受害者系统上的权限。
4. **代码中的利用方法:** 代码中的利用方法主要分为以下几种：
   * 利用python实现的smb_exploit_framework.py脚本进行攻击
   * 利用python实现的admin_exploit_framework.py脚本进行攻击,需要管理员权限
   * 通过PowerShell脚本exploit.ps1进行攻击

**风险提示：**
在实际测试和分析PoC代码时，务必在隔离的环境中进行，避免对生产系统造成影响。进行详细的代码审计是发现潜在投毒代码的必要步骤。

**项目地址:** [SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #4

**来源**: [CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server (2008-2025)，具体版本请参考CVE描述。

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

根据提供的漏洞信息和利用代码，CVE-2025-33073是一个Windows SMB客户端的特权提升漏洞。攻击者可以通过网络发送特制的SMB数据包，利用SMB协议栈中不正确的访问控制机制，从而提升权限。

**有效性：**
提供的POC代码包含多个文件，包括Python脚本（`smb_exploit_framework.py`, `admin_exploit_framework.py`）和PowerShell脚本(`exploit.ps1`)，以及一个批处理文件(`run_as_admin.bat`)。这些文件表明存在多种利用该漏洞的方法。`README.md` 文件详细描述了漏洞原理和利用步骤，包括构建恶意SMB服务器和客户端，以及构造特定的SMB2数据包来触发漏洞。如果目标系统在受影响的版本范围内，并且没有安装相应的安全补丁，则提供的POC代码很可能有效。

**投毒风险：**
虽然`README.md`文件声明该框架仅用于授权的安全研究和教育目的，但仍然存在投毒的风险。以下是一些潜在的风险点：
*   **代码复杂度:** 虽然代码提供了利用思路,但缺乏具体的exp细节实现，增加了分析难度，可能会隐藏恶意代码。  
*   **管理员权限要求:** `admin_exploit_framework.py`和`run_as_admin.bat`需要管理员权限才能运行，这表明该漏洞可能被用于在已入侵系统上提升权限，或者执行恶意操作。
*   **Payload定制：** 攻击者可能修改POC代码，嵌入额外的恶意Payload，例如反向Shell或远程控制木马，从而实现更深层次的入侵。
*   **日志记录：** 攻击者可能篡改日志记录功能，以隐藏其攻击行为。

综合考虑，该POC代码存在一定的投毒风险，估计为20%。使用者应仔细审查代码，并在隔离环境中进行测试，以避免潜在的危害。

**利用方式：**
1.  **搭建恶意SMB服务器：** 使用`smb_exploit_framework.py`或类似脚本创建一个模拟恶意SMB服务器。该服务器会监听特定的端口（通常是445），等待受害者连接。
2.  **客户端连接：** 受害者的Windows SMB客户端尝试连接到恶意SMB服务器。
3.  **数据包构造：** 恶意SMB服务器发送特制的SMB2数据包，利用SMB客户端的访问控制漏洞。
4.  **权限提升：** 如果漏洞利用成功，攻击者可以在受害者系统上获得更高的权限。
5.  **PowerShell利用：** 可以通过PowerShell脚本（`exploit.ps1`）执行，允许通过命令行指定目标主机和端口。
6.  **利用SMB协商阶段，会话建立阶段的漏洞。**

**项目地址:** [SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #5

**来源**: [CVE-2025-33073-cve-2025-33073_cve-2025-33073.md](../2025/CVE-2025-33073-cve-2025-33073_cve-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致网络权限提升

**影响版本:** 受影响的Windows版本详见漏洞描述

**利用条件:** 需要网络访问

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-33073是一个Windows SMB客户端的权限提升漏洞。攻击者可以通过不当的访问控制，在网络上提升权限。受影响的系统包括多个版本的Windows 10、Windows Server等。漏洞利用的复杂度较低，容易被利用，CVSS评分为8.8，属于高危漏洞。

然而，提供的“漏洞利用代码”实际上是一个个人介绍文件，与SMB漏洞利用无关。该文件内容为葡萄牙语，描述了作者的编程技能和爱好，包括C++, Java, PHP, Python和C#，以及信息安全。**因此，这段代码本身并不能用于利用CVE-2025-33073漏洞，且存在严重的投毒风险，因为其与漏洞描述完全不符。**

**利用方式分析：**

由于缺乏有效的PoC代码，无法确定具体利用方式。根据漏洞描述，该漏洞与SMB客户端的权限提升有关，攻击者可能通过构造恶意的SMB请求或响应，利用SMB协议中的缺陷来提升权限。可能的利用方式包括:

1.  **中间人攻击：** 攻击者拦截SMB客户端与服务器之间的通信，篡改SMB协议数据包，从而提升权限。
2.  **恶意SMB服务器：** 攻击者搭建恶意的SMB服务器，诱导受害者连接，利用服务器端的漏洞来提升权限。
3.  **利用SMB客户端解析漏洞：** 攻击者发送特制的SMB数据包，触发客户端的解析漏洞，从而执行恶意代码。

需要注意的是，具体利用方式取决于漏洞的根本原因，在没有有效PoC的情况下，只能进行推测。

**项目地址:** [cve-2025-33073/cve-2025-33073](https://github.com/cve-2025-33073/cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #6

**来源**: [CVE-2025-33073-joaozixx_CVE-2025-33073.md](../2025/CVE-2025-33073-joaozixx_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本（参见CVE描述中的版本范围）

**利用条件:** 攻击者需要位于与目标系统相同的网络中，并拥有有效的域凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞，允许经过身份验证的攻击者通过不正确的访问控制提升权限。该漏洞利用链包含以下步骤：

1.  **添加恶意DNS记录:** 使用dnstool.py工具，通过提供的用户名和密码，在域控制器的DNS服务器上添加一个恶意的DNS记录。这个记录将攻击者的IP地址与特定的DNS名称（`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`）关联起来。
2.  **验证DNS记录:** 脚本会等待恶意DNS记录生效，通过`dig`命令进行验证，确保记录已经成功添加到DNS服务器并且可以解析。
3.  **启动NTLM Relay:** 脚本启动`ntlmrelayx`工具，监听传入的NTLM认证请求，并将其转发到目标服务器。可以指定自定义命令，或者使用默认的`secretsdump`来提取目标系统的凭据。可以选择通过xterm启动，或直接在当前终端运行。
4.  **触发PetitPotam强制认证:** 脚本利用`nxc`（`netexec`）工具，通过PetitPotam（`coerce_plus`模块）强制目标服务器向攻击者控制的服务器进行NTLM认证。PetitPotam通过MS-EFSRPC协议触发认证。目标服务器会尝试解析之前添加的恶意DNS记录，并将NTLM认证信息发送到攻击者的`ntlmrelayx`监听器。

整个过程依赖于NTLM中继攻击，以及利用PetitPotam强制目标机器向攻击者控制的服务器进行认证。攻击者利用中继的NTLM认证信息，可以执行任意命令或提取目标系统的敏感信息，从而提升权限。

**有效性：**
根据搜索结果和提供的PoC代码，此PoC利用链看起来是有效的。Synacktiv的博客文章详细分析了此漏洞，并提供了利用此漏洞绕过NTLM反射缓解措施的方法。PoC代码旨在自动化整个攻击链。

**投毒风险：**
PoC代码本身没有明显的投毒代码，但存在以下潜在风险：

*   **依赖项风险：** 该脚本依赖于`dnstool.py`、`impacket-ntlmrelayx`和`nxc`。如果这些依赖项本身被篡改或包含恶意代码，那么使用该脚本也可能受到影响。
*   **滥用风险：** 该脚本提供的功能可以被滥用于未经授权的渗透测试或攻击。脚本作者或未经授权的第三方可能会修改该脚本以包含其他恶意功能，例如植入后门、删除数据等。但从现有代码本身来看，直接植入后门代码的概率较低,大约为10%，因为代码流程比较清晰，主要是调用现有的工具和库。

**利用方式总结：**
该漏洞利用方式的核心是利用NTLM中继攻击，结合恶意DNS记录和PetitPotam强制认证，将目标服务器的NTLM认证信息中继到攻击者控制的服务器，并利用这些信息提升权限。攻击者首先诱使目标服务器向攻击者控制的服务器进行认证，然后利用中继的认证信息执行任意命令或提取敏感信息。

**项目地址:** [joaozixx/CVE-2025-33073](https://github.com/joaozixx/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #7

**来源**: [CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md](../2025/CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者在网络上提升权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要受害者系统存在于与攻击者相同的网络中，并且攻击者需要具有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-33073 是一个 Windows SMB 客户端提权漏洞。该漏洞的利用方式是首先检查目标服务器是否禁用了 SMB 签名。如果 SMB 签名被禁用，攻击者可以使用 PetitPotam 强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证，从而进行 NTLM 中继攻击，最终提升权限。POC代码通过 crackmapexec 工具来检查 SMB 签名状态，使用 netcat 监听 445 端口，并利用 PetitPotam 脚本发起 NTLM 身份验证强制攻击。

**有效性评估:** 提供的 POC 代码看起来有效。它包含了检测漏洞和利用漏洞的必要步骤。它首先检查 SMB 签名是否禁用，然后尝试使用 PetitPotam 进行 NTLM 身份验证强制。

**投毒风险评估:** 投毒风险评估为20%。 虽然该脚本主要目的是验证漏洞的存在，但存在轻微的投毒风险，原因如下：

1.  **依赖外部脚本 (PetitPotam.py):** 该脚本依赖于从外部源下载的 PetitPotam.py 脚本。如果该脚本被恶意修改，则可能导致受害者系统被感染。
2.  **执行系统命令（sudo nc）:** 该脚本使用 `sudo nc` 启动 netcat 监听器，这可能会引入安全风险，尤其是在配置不当的情况下。
3.  **硬编码域名：**脚本的 README.md 文件提示需要在DNS中注册一个域名(`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`)，如果攻击者控制了受害者的DNS服务器，则可以劫持该域名并造成进一步的攻击。

**利用方式:**

1.  **环境准备:**  攻击者需要安装 crackmapexec, netcat, python3, 并且获得一个有效的域用户凭据。
2.  **检查 SMB 签名:** 使用 crackmapexec 工具检查目标服务器是否禁用了 SMB 签名。
3.  **强制身份验证:** 如果 SMB 签名被禁用，攻击者使用 PetitPotam 脚本强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证。
4.  **NTLM 中继:**  攻击者使用 netcat 监听 445 端口，捕获 NTLM 身份验证信息。
5.  **权限提升:**  攻击者利用捕获到的 NTLM 身份验证信息进行 NTLM 中继攻击，最终提升权限。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #8

**来源**: [CVE-2025-33073-mverschu_CVE-2025-33073.md](../2025/CVE-2025-33073-mverschu_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致域内权限提升和远程代码执行

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 需要攻击者在域内，并且目标主机受到漏洞影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 是一个Windows SMB客户端权限提升漏洞。该漏洞允许经过身份验证的攻击者通过SMB协议提升权限。提供的PoC代码利用了dnstool.py来添加恶意DNS记录，然后使用ntlmrelayx进行NTLM中继攻击，最后使用PetitPotam或其他类似方法触发目标机器向攻击者控制的服务器进行身份验证，从而通过NTLM中继获得目标机器的权限。 

**有效性分析：**
PoC代码看起来有效，因为它涵盖了NTLM中继攻击的典型步骤：
1.  添加恶意DNS记录，使目标机器解析特定主机名为攻击者控制的IP地址。
2.  启动ntlmrelayx监听器，等待NTLM身份验证请求。
3.  使用PetitPotam或其他强制身份验证的方法，诱使目标机器向攻击者控制的服务器进行身份验证。
4.  ntlmrelayx中继身份验证到目标服务器，执行任意命令，从而提升权限。

**投毒风险分析：**
代码中存在一定投毒风险，但概率较低（10%）。
*   `dnstool.py` 脚本的安全性需要进一步审查，如果该脚本本身存在漏洞，则可能被用于植入后门或者执行恶意操作。
*   代码使用了`subprocess.run` 和 `subprocess.Popen`，这些函数如果使用不当，可能会受到命令注入攻击。
*   PoC 依赖于 `impacket` 和 `nxc` 这两个第三方库。虽然这两个库本身很常用，但如果攻击者修改了 PoC，加入了从恶意源下载这些库的逻辑，就有可能引入恶意代码。
*   代码中使用了静态DNS记录，这可能会导致攻击行为更容易被检测。

**漏洞利用方式：**
1.  攻击者首先需要位于与目标机器相同的网络中。
2.  攻击者使用提供的PoC代码，指定用户名、密码、攻击者IP、DNS服务器IP、域控制器FQDN以及目标机器IP。
3.  PoC代码使用dnstool.py在DNS服务器上添加一个恶意的DNS记录，将特定的域名解析到攻击者控制的IP地址。
4.  PoC代码启动ntlmrelayx，监听传入的NTLM身份验证请求。
5.  PoC代码使用PetitPotam, Printerbug 或 DFSCoerce 等方法诱使目标机器向攻击者控制的IP地址发起NTLM身份验证。
6.  ntlmrelayx截获NTLM身份验证信息，并将其转发到目标机器。
7.  成功中继NTLM身份验证后，攻击者可以在目标机器上执行任意命令，从而提升权限。

**排序优先级考虑：** 由于没有提供搜索结果，漏洞利用代码的分析比漏洞库信息更具优先级。 代码本身提供更详细的攻击步骤，对风险判断、利用方式分析更有帮助。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #9

**来源**: [CVE-2025-33073-obscura-cert_CVE-2025-33073.md](../2025/CVE-2025-33073-obscura-cert_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，攻击者可通过网络提升权限

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参考CVE信息

**利用条件:** 攻击者需要位于同一网络，且能够访问SMB服务，需要受害者触发SMB连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 描述的是 Windows SMB 客户端的权限提升漏洞。攻击者可以利用该漏洞通过网络提升权限。

**利用方式分析：**

根据提供的漏洞利用代码，这是一个结合了 DNS 注入、NTLM 中继和 RPC 强制身份验证的攻击链。具体流程如下：

1.  **DNS 注入：** 使用 `samba-tool` 向 DNS 服务器添加一条 A 记录，将一个子域名指向攻击者的 IP 地址。这需要管理员权限。
2.  **DNS 记录验证：** 验证 DNS 记录是否成功传播，确保目标系统可以解析到攻击者的 IP。
3.  **NTLM 中继：** 启动 `impacket-ntlmrelayx` 工具，监听 NTLM 认证请求，并将请求中继到目标服务器。
4.  **RPC 强制身份验证：** 使用 `rpcping` 工具，强制目标系统通过 SMB 协议连接到攻击者控制的域名，触发 NTLM 认证。`rpcping` 通过 `spoolss` 管道强制进行身份验证。
5.  **权限提升：** 一旦 NTLM 认证被中继到目标服务器，攻击者就可以利用 `ntlmrelayx` 获取目标服务器的权限，从而提升在目标服务器上的权限。

**有效性分析：**

该PoC 代码逻辑完整，覆盖了利用该漏洞所需的关键步骤。根据CVE描述 Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.如果环境配置正确（例如，攻击者可以成功注入 DNS 记录，受害者系统存在 NTLM 中继的漏洞等），则该 PoC 代码应能成功利用该漏洞。

**投毒风险分析：**

检查 PoC 代码，发现该脚本主要实现了 DNS 注入、NTLM relay和RPC 强制身份验证。没有直接发现恶意代码或后门。虽然代码本身没有明显的恶意行为，但仍存在一定的投毒风险，占比约为10%：

*   **依赖风险：** 该脚本依赖于 `samba-tool` 和 `impacket-ntlmrelayx`。如果这些依赖库被恶意篡改，可能会导致意外的恶意行为。
*   **密码硬编码：** 代码中存在硬编码的管理员密码 `YourPassword`。攻击者如果直接使用该代码，可能会暴露密码，导致安全风险。
*   **滥用风险：** 该 PoC 代码旨在模拟攻击行为。如果被用于非法目的，可能会对目标系统造成损害。

总体而言，该 PoC 代码的投毒风险较低，主要风险来自于依赖项和潜在的滥用。使用该代码时，应谨慎评估风险，并采取必要的安全措施。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #10

**来源**: [CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md](../2025/CVE-2025-33073-sleepasleepzzz_CVE-2025-33073.md)

# CVE-2025-33073

> 📦 该CVE有 **11** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-Ashwesker_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 提权漏洞

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本和Build号在漏洞库信息中已列出

**利用条件:** 需要能够访问目标网络，并且目标机器上存在受影响的SMB客户端版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息，CVE-2025-33073是Windows SMB客户端中的一个权限提升漏洞，允许经过身份验证的攻击者通过网络提升权限。提供的漏洞利用代码（CVE-2025-33073.py）利用了dnstool.py、ntlmrelayx和nxc等工具，构成了一个完整的攻击链。该攻击链首先使用dnstool.py在域控制器上添加一个恶意的DNS记录。然后，该脚本会等待DNS记录生效。接下来，脚本启动ntlmrelayx，配置为将收到的NTLM认证请求转发到目标机器。最后，脚本通过nxc（用于网络渗透测试）使用PetitPotam、Printerbug或DFSCoerce等强制认证方法，诱使目标机器向攻击者控制的ntlmrelayx服务器进行身份验证，从而利用NTLM relay攻击提升权限。

**有效性分析：**

该POC代码利用了已知的NTLM relay攻击技术，结合DNS欺骗和强制认证方法，在特定条件下可以有效提升权限。漏洞利用代码主要依赖于 `dnstool.py` 添加恶意 DNS 记录，结合 `ntlmrelayx` 监听和中继 NTLM 认证，最后通过 `nxc` 触发强制认证。

**投毒风险分析：**

代码存在一定的投毒风险，但可能性较低，约为5%。原因如下：

*   代码中使用了多个第三方工具（dnstool.py, impacket-ntlmrelayx, nxc）。虽然这些工具本身是合法的渗透测试工具，但如果攻击者修改了脚本，使其在调用这些工具时添加额外的恶意参数或执行恶意操作，则可能存在投毒风险。
*   该脚本本身包含添加DNS记录的操作，如果被滥用，可能会导致网络中断或其他恶意行为。
*   脚本通过 xterm 打开新终端执行命令，这种行为本身可能存在风险。攻击者可能会利用这一点，在终端中执行恶意命令。

**利用方式分析：**

1.  **设置环境:** 攻击者需要一个攻击机（通常是Linux/Kali），安装了必要的工具（dnstool.py，impacket，nxc）。
2.  **DNS欺骗:** 攻击者使用dnstool.py向域控制器添加一个静态DNS记录，将特定的主机名解析到攻击者的IP地址。
3.  **NTLM中继:** 攻击者启动ntlmrelayx，监听传入的NTLM认证请求，并将其转发到目标机器。
4.  **强制认证:** 攻击者使用nxc（或类似工具）结合PetitPotam、Printerbug或DFSCoerce等方法，诱使目标机器通过SMB协议向攻击者控制的ntlmrelayx服务器进行身份验证。
5.  **权限提升:** 一旦目标机器向ntlmrelayx进行身份验证，攻击者就可以利用中继的凭据在目标机器上执行命令，从而提升权限。

**漏洞缓解措施：**

*   安装Microsoft提供的安全更新。
*   启用SMB签名以防止NTLM中继攻击。
*   限制对RPC服务的访问。
*   监控DNS服务器的异常记录。

**项目地址:** [Ashwesker/Blackash-CVE-2025-33073](https://github.com/Ashwesker/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #2

**来源**: [CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md](../2025/CVE-2025-33073-B1ack4sh_Blackash-CVE-2025-33073.md)

## CVE-2025-33073 - Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许未经授权的攻击者提升网络上的权限

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要域环境，目标系统在受影响的版本范围内，攻击者位于可访问域控和目标机器的网络中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许经过身份验证的攻击者通过SMB客户端提升权限。利用方式如下：

1.  **利用 `dnstool.py` 添加恶意DNS记录:**  攻击者首先使用提供的`dnstool.py`脚本在域控制器上添加一个恶意的DNS记录，将一个特定的主机名（`STATIC_DNS_RECORD`）解析到攻击者的IP地址。这通常需要有效的域用户凭据。
2.  **等待DNS记录传播:** 脚本会等待新添加的DNS记录在DNS服务器上生效，确保目标系统能够解析到攻击者的IP。
3.  **启动 `ntlmrelayx` 监听器:** 使用 `impacket` 工具集中的 `ntlmrelayx` 启动一个NTLM中继服务器。这个服务器会监听来自目标系统的NTLM认证请求，并将其转发到另一个目标（`--target`），通常是域控制器本身，以获取权限。
4.  **触发NTLM认证请求:**  使用 `nxc` (crackmapexec的修改版本)  配合 `coerce_plus` 模块，通过诸如`PetitPotam`、`Printerbug`或`DFSCoerce`之类的方法强制目标服务器向攻击者控制的IP地址进行NTLM认证。这些方法通常利用Windows服务的特性来触发认证。
5.  **NTLM中继和权限提升:** `ntlmrelayx` 将收到的NTLM认证请求中继到域控制器，如果relay成功，攻击者可以模拟目标机器的身份，从而执行操作，例如添加用户、修改组策略或者执行任意命令。根据`--custom-command`参数，可以指定要执行的命令，默认情况下可能执行`secretsdump.py`来转储域凭据。

**有效性评估:**  提供的POC代码看起来是有效的，它结合了多个已知的攻击技术（DNS欺骗、NTLM中继、强制认证）来实现权限提升。  成功利用该漏洞取决于多个因素，包括目标系统的配置、网络环境以及所使用的强制认证方法的有效性。

**投毒风险评估:** 通过对POC代码的分析，没有发现明显的恶意或投毒代码。所有操作都是为了实现合法的攻击流程，没有隐藏的后门或破坏性行为。因此，投毒风险评估为0%。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-33073](https://github.com/B1ack4sh/Blackash-CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #3

**来源**: [CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SFRDevelopment_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 见漏洞库信息

**利用条件:** 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

该漏洞是Windows SMB客户端中的一个权限提升漏洞（CVE-2025-33073），由于SMB协议栈中存在不正确的访问控制机制导致。攻击者可以通过网络利用此漏洞提升权限。

**有效性评估：**
根据提供的漏洞库信息，该漏洞影响多个Windows版本，且CVSS评分为8.8，表明漏洞严重性较高。提供的漏洞利用代码包含Python和PowerShell的PoC，增加了利用的灵活性。代码描述了利用不正确的访问控制来构造SMB2数据包，从而导致权限提升。综合来看，PoC代码具有一定的有效性。

**投毒风险分析：**
虽然代码库提供了多种利用方式（Python和Powershell），但仍然存在一定的投毒风险。
1.  **代码复杂性：** SMB协议本身比较复杂，PoC代码必然涉及大量的协议细节，这使得在不完全理解协议的情况下，难以判断是否存在恶意代码。
2.  **权限提升的利用方式：** 权限提升漏洞本身就可能被用于植入后门，例如在提升权限后，修改系统文件，添加恶意服务等。
3.  **作者声明的免责声明：**虽然作者在`README.md`中声明该框架仅用于授权的安全研究、教育目的和受控测试环境，并强调了使用限制和风险缓解措施，但免责声明不能完全排除恶意使用的可能性。

基于以上分析，初步判断存在20%的投毒风险，需要进一步的代码审计来确认是否存在后门或恶意行为。

**利用方式：**
1.  **搭建恶意SMB服务器：** 攻击者需要搭建一个恶意的SMB服务器，该服务器能够响应客户端的SMB请求。
2.  **构造恶意SMB数据包：** 攻击者利用PoC代码构造恶意的SMB数据包，例如精心设计的协商请求或会话设置请求，触发SMB客户端的漏洞。
3.  **触发权限提升：** 当受害者（SMB客户端）连接到攻击者的恶意SMB服务器并处理恶意数据包时，由于不正确的访问控制，攻击者可以提升在受害者系统上的权限。
4. **代码中的利用方法:** 代码中的利用方法主要分为以下几种：
   * 利用python实现的smb_exploit_framework.py脚本进行攻击
   * 利用python实现的admin_exploit_framework.py脚本进行攻击,需要管理员权限
   * 通过PowerShell脚本exploit.ps1进行攻击

**风险提示：**
在实际测试和分析PoC代码时，务必在隔离的环境中进行，避免对生产系统造成影响。进行详细的代码审计是发现潜在投毒代码的必要步骤。

**项目地址:** [SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SFRDevelopment/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #4

**来源**: [CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md](../2025/CVE-2025-33073-SellMeFish_windows-smb-vulnerability-framework-cve-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server (2008-2025)，具体版本请参考CVE描述。

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

根据提供的漏洞信息和利用代码，CVE-2025-33073是一个Windows SMB客户端的特权提升漏洞。攻击者可以通过网络发送特制的SMB数据包，利用SMB协议栈中不正确的访问控制机制，从而提升权限。

**有效性：**
提供的POC代码包含多个文件，包括Python脚本（`smb_exploit_framework.py`, `admin_exploit_framework.py`）和PowerShell脚本(`exploit.ps1`)，以及一个批处理文件(`run_as_admin.bat`)。这些文件表明存在多种利用该漏洞的方法。`README.md` 文件详细描述了漏洞原理和利用步骤，包括构建恶意SMB服务器和客户端，以及构造特定的SMB2数据包来触发漏洞。如果目标系统在受影响的版本范围内，并且没有安装相应的安全补丁，则提供的POC代码很可能有效。

**投毒风险：**
虽然`README.md`文件声明该框架仅用于授权的安全研究和教育目的，但仍然存在投毒的风险。以下是一些潜在的风险点：
*   **代码复杂度:** 虽然代码提供了利用思路,但缺乏具体的exp细节实现，增加了分析难度，可能会隐藏恶意代码。  
*   **管理员权限要求:** `admin_exploit_framework.py`和`run_as_admin.bat`需要管理员权限才能运行，这表明该漏洞可能被用于在已入侵系统上提升权限，或者执行恶意操作。
*   **Payload定制：** 攻击者可能修改POC代码，嵌入额外的恶意Payload，例如反向Shell或远程控制木马，从而实现更深层次的入侵。
*   **日志记录：** 攻击者可能篡改日志记录功能，以隐藏其攻击行为。

综合考虑，该POC代码存在一定的投毒风险，估计为20%。使用者应仔细审查代码，并在隔离环境中进行测试，以避免潜在的危害。

**利用方式：**
1.  **搭建恶意SMB服务器：** 使用`smb_exploit_framework.py`或类似脚本创建一个模拟恶意SMB服务器。该服务器会监听特定的端口（通常是445），等待受害者连接。
2.  **客户端连接：** 受害者的Windows SMB客户端尝试连接到恶意SMB服务器。
3.  **数据包构造：** 恶意SMB服务器发送特制的SMB2数据包，利用SMB客户端的访问控制漏洞。
4.  **权限提升：** 如果漏洞利用成功，攻击者可以在受害者系统上获得更高的权限。
5.  **PowerShell利用：** 可以通过PowerShell脚本（`exploit.ps1`）执行，允许通过命令行指定目标主机和端口。
6.  **利用SMB协商阶段，会话建立阶段的漏洞。**

**项目地址:** [SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073](https://github.com/SellMeFish/windows-smb-vulnerability-framework-cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #5

**来源**: [CVE-2025-33073-cve-2025-33073_cve-2025-33073.md](../2025/CVE-2025-33073-cve-2025-33073_cve-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致网络权限提升

**影响版本:** 受影响的Windows版本详见漏洞描述

**利用条件:** 需要网络访问

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据漏洞库信息，CVE-2025-33073是一个Windows SMB客户端的权限提升漏洞。攻击者可以通过不当的访问控制，在网络上提升权限。受影响的系统包括多个版本的Windows 10、Windows Server等。漏洞利用的复杂度较低，容易被利用，CVSS评分为8.8，属于高危漏洞。

然而，提供的“漏洞利用代码”实际上是一个个人介绍文件，与SMB漏洞利用无关。该文件内容为葡萄牙语，描述了作者的编程技能和爱好，包括C++, Java, PHP, Python和C#，以及信息安全。**因此，这段代码本身并不能用于利用CVE-2025-33073漏洞，且存在严重的投毒风险，因为其与漏洞描述完全不符。**

**利用方式分析：**

由于缺乏有效的PoC代码，无法确定具体利用方式。根据漏洞描述，该漏洞与SMB客户端的权限提升有关，攻击者可能通过构造恶意的SMB请求或响应，利用SMB协议中的缺陷来提升权限。可能的利用方式包括:

1.  **中间人攻击：** 攻击者拦截SMB客户端与服务器之间的通信，篡改SMB协议数据包，从而提升权限。
2.  **恶意SMB服务器：** 攻击者搭建恶意的SMB服务器，诱导受害者连接，利用服务器端的漏洞来提升权限。
3.  **利用SMB客户端解析漏洞：** 攻击者发送特制的SMB数据包，触发客户端的解析漏洞，从而执行恶意代码。

需要注意的是，具体利用方式取决于漏洞的根本原因，在没有有效PoC的情况下，只能进行推测。

**项目地址:** [cve-2025-33073/cve-2025-33073](https://github.com/cve-2025-33073/cve-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #6

**来源**: [CVE-2025-33073-joaozixx_CVE-2025-33073.md](../2025/CVE-2025-33073-joaozixx_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本（参见CVE描述中的版本范围）

**利用条件:** 攻击者需要位于与目标系统相同的网络中，并拥有有效的域凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞，允许经过身份验证的攻击者通过不正确的访问控制提升权限。该漏洞利用链包含以下步骤：

1.  **添加恶意DNS记录:** 使用dnstool.py工具，通过提供的用户名和密码，在域控制器的DNS服务器上添加一个恶意的DNS记录。这个记录将攻击者的IP地址与特定的DNS名称（`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`）关联起来。
2.  **验证DNS记录:** 脚本会等待恶意DNS记录生效，通过`dig`命令进行验证，确保记录已经成功添加到DNS服务器并且可以解析。
3.  **启动NTLM Relay:** 脚本启动`ntlmrelayx`工具，监听传入的NTLM认证请求，并将其转发到目标服务器。可以指定自定义命令，或者使用默认的`secretsdump`来提取目标系统的凭据。可以选择通过xterm启动，或直接在当前终端运行。
4.  **触发PetitPotam强制认证:** 脚本利用`nxc`（`netexec`）工具，通过PetitPotam（`coerce_plus`模块）强制目标服务器向攻击者控制的服务器进行NTLM认证。PetitPotam通过MS-EFSRPC协议触发认证。目标服务器会尝试解析之前添加的恶意DNS记录，并将NTLM认证信息发送到攻击者的`ntlmrelayx`监听器。

整个过程依赖于NTLM中继攻击，以及利用PetitPotam强制目标机器向攻击者控制的服务器进行认证。攻击者利用中继的NTLM认证信息，可以执行任意命令或提取目标系统的敏感信息，从而提升权限。

**有效性：**
根据搜索结果和提供的PoC代码，此PoC利用链看起来是有效的。Synacktiv的博客文章详细分析了此漏洞，并提供了利用此漏洞绕过NTLM反射缓解措施的方法。PoC代码旨在自动化整个攻击链。

**投毒风险：**
PoC代码本身没有明显的投毒代码，但存在以下潜在风险：

*   **依赖项风险：** 该脚本依赖于`dnstool.py`、`impacket-ntlmrelayx`和`nxc`。如果这些依赖项本身被篡改或包含恶意代码，那么使用该脚本也可能受到影响。
*   **滥用风险：** 该脚本提供的功能可以被滥用于未经授权的渗透测试或攻击。脚本作者或未经授权的第三方可能会修改该脚本以包含其他恶意功能，例如植入后门、删除数据等。但从现有代码本身来看，直接植入后门代码的概率较低,大约为10%，因为代码流程比较清晰，主要是调用现有的工具和库。

**利用方式总结：**
该漏洞利用方式的核心是利用NTLM中继攻击，结合恶意DNS记录和PetitPotam强制认证，将目标服务器的NTLM认证信息中继到攻击者控制的服务器，并利用这些信息提升权限。攻击者首先诱使目标服务器向攻击者控制的服务器进行认证，然后利用中继的认证信息执行任意命令或提取敏感信息。

**项目地址:** [joaozixx/CVE-2025-33073](https://github.com/joaozixx/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #7

**来源**: [CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md](../2025/CVE-2025-33073-matejsmycka_CVE-2025-33073-checker.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者在网络上提升权限

**影响版本:** 受影响的Windows版本详见CVE描述

**利用条件:** 需要受害者系统存在于与攻击者相同的网络中，并且攻击者需要具有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-33073 是一个 Windows SMB 客户端提权漏洞。该漏洞的利用方式是首先检查目标服务器是否禁用了 SMB 签名。如果 SMB 签名被禁用，攻击者可以使用 PetitPotam 强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证，从而进行 NTLM 中继攻击，最终提升权限。POC代码通过 crackmapexec 工具来检查 SMB 签名状态，使用 netcat 监听 445 端口，并利用 PetitPotam 脚本发起 NTLM 身份验证强制攻击。

**有效性评估:** 提供的 POC 代码看起来有效。它包含了检测漏洞和利用漏洞的必要步骤。它首先检查 SMB 签名是否禁用，然后尝试使用 PetitPotam 进行 NTLM 身份验证强制。

**投毒风险评估:** 投毒风险评估为20%。 虽然该脚本主要目的是验证漏洞的存在，但存在轻微的投毒风险，原因如下：

1.  **依赖外部脚本 (PetitPotam.py):** 该脚本依赖于从外部源下载的 PetitPotam.py 脚本。如果该脚本被恶意修改，则可能导致受害者系统被感染。
2.  **执行系统命令（sudo nc）:** 该脚本使用 `sudo nc` 启动 netcat 监听器，这可能会引入安全风险，尤其是在配置不当的情况下。
3.  **硬编码域名：**脚本的 README.md 文件提示需要在DNS中注册一个域名(`localhost1UWhRCAAAAAAAAAAAAAAAAAAAAAAAAAAAAwbEAYBAAAA`)，如果攻击者控制了受害者的DNS服务器，则可以劫持该域名并造成进一步的攻击。

**利用方式:**

1.  **环境准备:**  攻击者需要安装 crackmapexec, netcat, python3, 并且获得一个有效的域用户凭据。
2.  **检查 SMB 签名:** 使用 crackmapexec 工具检查目标服务器是否禁用了 SMB 签名。
3.  **强制身份验证:** 如果 SMB 签名被禁用，攻击者使用 PetitPotam 脚本强制目标机器通过 SMB 协议向攻击者控制的服务器进行身份验证。
4.  **NTLM 中继:**  攻击者使用 netcat 监听 445 端口，捕获 NTLM 身份验证信息。
5.  **权限提升:**  攻击者利用捕获到的 NTLM 身份验证信息进行 NTLM 中继攻击，最终提升权限。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #8

**来源**: [CVE-2025-33073-mverschu_CVE-2025-33073.md](../2025/CVE-2025-33073-mverschu_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致域内权限提升和远程代码执行

**影响版本:** 见CVE描述中的受影响版本范围

**利用条件:** 需要攻击者在域内，并且目标主机受到漏洞影响

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 是一个Windows SMB客户端权限提升漏洞。该漏洞允许经过身份验证的攻击者通过SMB协议提升权限。提供的PoC代码利用了dnstool.py来添加恶意DNS记录，然后使用ntlmrelayx进行NTLM中继攻击，最后使用PetitPotam或其他类似方法触发目标机器向攻击者控制的服务器进行身份验证，从而通过NTLM中继获得目标机器的权限。 

**有效性分析：**
PoC代码看起来有效，因为它涵盖了NTLM中继攻击的典型步骤：
1.  添加恶意DNS记录，使目标机器解析特定主机名为攻击者控制的IP地址。
2.  启动ntlmrelayx监听器，等待NTLM身份验证请求。
3.  使用PetitPotam或其他强制身份验证的方法，诱使目标机器向攻击者控制的服务器进行身份验证。
4.  ntlmrelayx中继身份验证到目标服务器，执行任意命令，从而提升权限。

**投毒风险分析：**
代码中存在一定投毒风险，但概率较低（10%）。
*   `dnstool.py` 脚本的安全性需要进一步审查，如果该脚本本身存在漏洞，则可能被用于植入后门或者执行恶意操作。
*   代码使用了`subprocess.run` 和 `subprocess.Popen`，这些函数如果使用不当，可能会受到命令注入攻击。
*   PoC 依赖于 `impacket` 和 `nxc` 这两个第三方库。虽然这两个库本身很常用，但如果攻击者修改了 PoC，加入了从恶意源下载这些库的逻辑，就有可能引入恶意代码。
*   代码中使用了静态DNS记录，这可能会导致攻击行为更容易被检测。

**漏洞利用方式：**
1.  攻击者首先需要位于与目标机器相同的网络中。
2.  攻击者使用提供的PoC代码，指定用户名、密码、攻击者IP、DNS服务器IP、域控制器FQDN以及目标机器IP。
3.  PoC代码使用dnstool.py在DNS服务器上添加一个恶意的DNS记录，将特定的域名解析到攻击者控制的IP地址。
4.  PoC代码启动ntlmrelayx，监听传入的NTLM身份验证请求。
5.  PoC代码使用PetitPotam, Printerbug 或 DFSCoerce 等方法诱使目标机器向攻击者控制的IP地址发起NTLM身份验证。
6.  ntlmrelayx截获NTLM身份验证信息，并将其转发到目标机器。
7.  成功中继NTLM身份验证后，攻击者可以在目标机器上执行任意命令，从而提升权限。

**排序优先级考虑：** 由于没有提供搜索结果，漏洞利用代码的分析比漏洞库信息更具优先级。 代码本身提供更详细的攻击步骤，对风险判断、利用方式分析更有帮助。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #9

**来源**: [CVE-2025-33073-obscura-cert_CVE-2025-33073.md](../2025/CVE-2025-33073-obscura-cert_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，攻击者可通过网络提升权限

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围参考CVE信息

**利用条件:** 攻击者需要位于同一网络，且能够访问SMB服务，需要受害者触发SMB连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073 描述的是 Windows SMB 客户端的权限提升漏洞。攻击者可以利用该漏洞通过网络提升权限。

**利用方式分析：**

根据提供的漏洞利用代码，这是一个结合了 DNS 注入、NTLM 中继和 RPC 强制身份验证的攻击链。具体流程如下：

1.  **DNS 注入：** 使用 `samba-tool` 向 DNS 服务器添加一条 A 记录，将一个子域名指向攻击者的 IP 地址。这需要管理员权限。
2.  **DNS 记录验证：** 验证 DNS 记录是否成功传播，确保目标系统可以解析到攻击者的 IP。
3.  **NTLM 中继：** 启动 `impacket-ntlmrelayx` 工具，监听 NTLM 认证请求，并将请求中继到目标服务器。
4.  **RPC 强制身份验证：** 使用 `rpcping` 工具，强制目标系统通过 SMB 协议连接到攻击者控制的域名，触发 NTLM 认证。`rpcping` 通过 `spoolss` 管道强制进行身份验证。
5.  **权限提升：** 一旦 NTLM 认证被中继到目标服务器，攻击者就可以利用 `ntlmrelayx` 获取目标服务器的权限，从而提升在目标服务器上的权限。

**有效性分析：**

该PoC 代码逻辑完整，覆盖了利用该漏洞所需的关键步骤。根据CVE描述 Improper access control in Windows SMB allows an authorized attacker to elevate privileges over a network.如果环境配置正确（例如，攻击者可以成功注入 DNS 记录，受害者系统存在 NTLM 中继的漏洞等），则该 PoC 代码应能成功利用该漏洞。

**投毒风险分析：**

检查 PoC 代码，发现该脚本主要实现了 DNS 注入、NTLM relay和RPC 强制身份验证。没有直接发现恶意代码或后门。虽然代码本身没有明显的恶意行为，但仍存在一定的投毒风险，占比约为10%：

*   **依赖风险：** 该脚本依赖于 `samba-tool` 和 `impacket-ntlmrelayx`。如果这些依赖库被恶意篡改，可能会导致意外的恶意行为。
*   **密码硬编码：** 代码中存在硬编码的管理员密码 `YourPassword`。攻击者如果直接使用该代码，可能会暴露密码，导致安全风险。
*   **滥用风险：** 该 PoC 代码旨在模拟攻击行为。如果被用于非法目的，可能会对目标系统造成损害。

总体而言，该 PoC 代码的投毒风险较低，主要风险来自于依赖项和潜在的滥用。使用该代码时，应谨慎评估风险，并采取必要的安全措施。

**项目地址:** [obscura-cert/CVE-2025-33073](https://github.com/obscura-cert/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #10

**来源**: [CVE-2025-33073-uziii2208_CVE-2025-33073.md](../2025/CVE-2025-33073-uziii2208_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致SYSTEM权限代码执行

**影响版本:** 见受影响的Windows版本列表

**利用条件:** 需要攻击者在域内, 拥有DNSAdmins权限, 目标DC启用WinRM服务，且网络可达（SMB 445, DNS 53, WinRM 5985/5986端口）。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-33073 漏洞允许经过身份验证的攻击者通过网络提升权限。该漏洞的利用方式主要通过以下步骤：

1.  **DNS 投毒:** 利用`krbrelayx.dnstool`修改或创建DNS记录，将目标指向攻击者控制的IP地址。
2.  **NTLM 中继:** 启动NTLM中继服务器 (`ntlmrelayx.py`)，监听传入的NTLM认证请求。
3.  **强制认证:** 使用`nxc`和`PetitPotam`等工具，强制域控制器 (DC) 向攻击者的IP地址进行身份验证。
4.  **中继至 WinRM:** 将捕获的NTLM认证凭据中继到目标DC的WinRM服务。
5.  **获取 SYSTEM Shell:** 成功认证后，通过WinRM执行系统命令，获取SYSTEM权限的shell。
6.  **自动提取 Flag:** 脚本自动搜索并提取指定目录和文件模式中的flag。

**有效性评估：**

根据漏洞描述和提供的PoC代码，该漏洞利用链是可行的。PoC代码包含了DNS投毒、NTLM中继和WinRM利用等关键步骤，并且针对CTF环境进行了优化，具有较高的成功率。

**投毒风险评估：**

虽然PoC代码本身看起来是合法的漏洞利用工具，但仍然存在一定的投毒风险。风险主要体现在以下几个方面：

*   **外部依赖：** PoC依赖`krbrelayx`和`impacket`等外部库。这些库如果被恶意修改，可能引入恶意代码。
*   **命令执行：** PoC会执行系统命令，攻击者可以通过修改`exploit.sh`中的命令来执行恶意操作。
*  **脚本内容分析:** 初步检查未发现明显的恶意代码，但是代码逻辑较为复杂，存在隐藏后门的可能，需进一步审计脚本和依赖。

综合以上因素，初步判断投毒风险为30%。需要注意的是，在实际使用PoC时，务必进行代码审计，并从可信的来源获取依赖库，以降低安全风险。

**项目地址:** [uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #11

**来源**: [CVE-2025-33073-yigitsql_CVE-2025-33073.md](../2025/CVE-2025-33073-yigitsql_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---



---

## POC #11

**来源**: [CVE-2025-33073-uziii2208_CVE-2025-33073.md](../2025/CVE-2025-33073-uziii2208_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致SYSTEM权限代码执行

**影响版本:** 见受影响的Windows版本列表

**利用条件:** 需要攻击者在域内, 拥有DNSAdmins权限, 目标DC启用WinRM服务，且网络可达（SMB 445, DNS 53, WinRM 5985/5986端口）。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-33073 漏洞允许经过身份验证的攻击者通过网络提升权限。该漏洞的利用方式主要通过以下步骤：

1.  **DNS 投毒:** 利用`krbrelayx.dnstool`修改或创建DNS记录，将目标指向攻击者控制的IP地址。
2.  **NTLM 中继:** 启动NTLM中继服务器 (`ntlmrelayx.py`)，监听传入的NTLM认证请求。
3.  **强制认证:** 使用`nxc`和`PetitPotam`等工具，强制域控制器 (DC) 向攻击者的IP地址进行身份验证。
4.  **中继至 WinRM:** 将捕获的NTLM认证凭据中继到目标DC的WinRM服务。
5.  **获取 SYSTEM Shell:** 成功认证后，通过WinRM执行系统命令，获取SYSTEM权限的shell。
6.  **自动提取 Flag:** 脚本自动搜索并提取指定目录和文件模式中的flag。

**有效性评估：**

根据漏洞描述和提供的PoC代码，该漏洞利用链是可行的。PoC代码包含了DNS投毒、NTLM中继和WinRM利用等关键步骤，并且针对CTF环境进行了优化，具有较高的成功率。

**投毒风险评估：**

虽然PoC代码本身看起来是合法的漏洞利用工具，但仍然存在一定的投毒风险。风险主要体现在以下几个方面：

*   **外部依赖：** PoC依赖`krbrelayx`和`impacket`等外部库。这些库如果被恶意修改，可能引入恶意代码。
*   **命令执行：** PoC会执行系统命令，攻击者可以通过修改`exploit.sh`中的命令来执行恶意操作。
*  **脚本内容分析:** 初步检查未发现明显的恶意代码，但是代码逻辑较为复杂，存在隐藏后门的可能，需进一步审计脚本和依赖。

综合以上因素，初步判断投毒风险为30%。需要注意的是，在实际使用PoC时，务必进行代码审计，并从可信的来源获取依赖库，以降低安全风险。

**项目地址:** [uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #12

**来源**: [CVE-2025-33073-yigitsql_CVE-2025-33073.md](../2025/CVE-2025-33073-yigitsql_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---



---

## POC #11

**来源**: [CVE-2025-33073-uziii2208_CVE-2025-33073.md](../2025/CVE-2025-33073-uziii2208_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致SYSTEM权限代码执行

**影响版本:** 见受影响的Windows版本列表

**利用条件:** 需要攻击者在域内, 拥有DNSAdmins权限, 目标DC启用WinRM服务，且网络可达（SMB 445, DNS 53, WinRM 5985/5986端口）。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-33073 漏洞允许经过身份验证的攻击者通过网络提升权限。该漏洞的利用方式主要通过以下步骤：

1.  **DNS 投毒:** 利用`krbrelayx.dnstool`修改或创建DNS记录，将目标指向攻击者控制的IP地址。
2.  **NTLM 中继:** 启动NTLM中继服务器 (`ntlmrelayx.py`)，监听传入的NTLM认证请求。
3.  **强制认证:** 使用`nxc`和`PetitPotam`等工具，强制域控制器 (DC) 向攻击者的IP地址进行身份验证。
4.  **中继至 WinRM:** 将捕获的NTLM认证凭据中继到目标DC的WinRM服务。
5.  **获取 SYSTEM Shell:** 成功认证后，通过WinRM执行系统命令，获取SYSTEM权限的shell。
6.  **自动提取 Flag:** 脚本自动搜索并提取指定目录和文件模式中的flag。

**有效性评估：**

根据漏洞描述和提供的PoC代码，该漏洞利用链是可行的。PoC代码包含了DNS投毒、NTLM中继和WinRM利用等关键步骤，并且针对CTF环境进行了优化，具有较高的成功率。

**投毒风险评估：**

虽然PoC代码本身看起来是合法的漏洞利用工具，但仍然存在一定的投毒风险。风险主要体现在以下几个方面：

*   **外部依赖：** PoC依赖`krbrelayx`和`impacket`等外部库。这些库如果被恶意修改，可能引入恶意代码。
*   **命令执行：** PoC会执行系统命令，攻击者可以通过修改`exploit.sh`中的命令来执行恶意操作。
*  **脚本内容分析:** 初步检查未发现明显的恶意代码，但是代码逻辑较为复杂，存在隐藏后门的可能，需进一步审计脚本和依赖。

综合以上因素，初步判断投毒风险为30%。需要注意的是，在实际使用PoC时，务必进行代码审计，并从可信的来源获取依赖库，以降低安全风险。

**项目地址:** [uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #12

**来源**: [CVE-2025-33073-yigitsql_CVE-2025-33073.md](../2025/CVE-2025-33073-yigitsql_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---



---

## POC #11

**来源**: [CVE-2025-33073-uziii2208_CVE-2025-33073.md](../2025/CVE-2025-33073-uziii2208_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致SYSTEM权限代码执行

**影响版本:** 见受影响的Windows版本列表

**利用条件:** 需要攻击者在域内, 拥有DNSAdmins权限, 目标DC启用WinRM服务，且网络可达（SMB 445, DNS 53, WinRM 5985/5986端口）。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-33073 漏洞允许经过身份验证的攻击者通过网络提升权限。该漏洞的利用方式主要通过以下步骤：

1.  **DNS 投毒:** 利用`krbrelayx.dnstool`修改或创建DNS记录，将目标指向攻击者控制的IP地址。
2.  **NTLM 中继:** 启动NTLM中继服务器 (`ntlmrelayx.py`)，监听传入的NTLM认证请求。
3.  **强制认证:** 使用`nxc`和`PetitPotam`等工具，强制域控制器 (DC) 向攻击者的IP地址进行身份验证。
4.  **中继至 WinRM:** 将捕获的NTLM认证凭据中继到目标DC的WinRM服务。
5.  **获取 SYSTEM Shell:** 成功认证后，通过WinRM执行系统命令，获取SYSTEM权限的shell。
6.  **自动提取 Flag:** 脚本自动搜索并提取指定目录和文件模式中的flag。

**有效性评估：**

根据漏洞描述和提供的PoC代码，该漏洞利用链是可行的。PoC代码包含了DNS投毒、NTLM中继和WinRM利用等关键步骤，并且针对CTF环境进行了优化，具有较高的成功率。

**投毒风险评估：**

虽然PoC代码本身看起来是合法的漏洞利用工具，但仍然存在一定的投毒风险。风险主要体现在以下几个方面：

*   **外部依赖：** PoC依赖`krbrelayx`和`impacket`等外部库。这些库如果被恶意修改，可能引入恶意代码。
*   **命令执行：** PoC会执行系统命令，攻击者可以通过修改`exploit.sh`中的命令来执行恶意操作。
*  **脚本内容分析:** 初步检查未发现明显的恶意代码，但是代码逻辑较为复杂，存在隐藏后门的可能，需进一步审计脚本和依赖。

综合以上因素，初步判断投毒风险为30%。需要注意的是，在实际使用PoC时，务必进行代码审计，并从可信的来源获取依赖库，以降低安全风险。

**项目地址:** [uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #12

**来源**: [CVE-2025-33073-yigitsql_CVE-2025-33073.md](../2025/CVE-2025-33073-yigitsql_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---



---

## POC #11

**来源**: [CVE-2025-33073-uziii2208_CVE-2025-33073.md](../2025/CVE-2025-33073-uziii2208_CVE-2025-33073.md)

## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可导致SYSTEM权限代码执行

**影响版本:** 见受影响的Windows版本列表

**利用条件:** 需要攻击者在域内, 拥有DNSAdmins权限, 目标DC启用WinRM服务，且网络可达（SMB 445, DNS 53, WinRM 5985/5986端口）。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-33073 漏洞允许经过身份验证的攻击者通过网络提升权限。该漏洞的利用方式主要通过以下步骤：

1.  **DNS 投毒:** 利用`krbrelayx.dnstool`修改或创建DNS记录，将目标指向攻击者控制的IP地址。
2.  **NTLM 中继:** 启动NTLM中继服务器 (`ntlmrelayx.py`)，监听传入的NTLM认证请求。
3.  **强制认证:** 使用`nxc`和`PetitPotam`等工具，强制域控制器 (DC) 向攻击者的IP地址进行身份验证。
4.  **中继至 WinRM:** 将捕获的NTLM认证凭据中继到目标DC的WinRM服务。
5.  **获取 SYSTEM Shell:** 成功认证后，通过WinRM执行系统命令，获取SYSTEM权限的shell。
6.  **自动提取 Flag:** 脚本自动搜索并提取指定目录和文件模式中的flag。

**有效性评估：**

根据漏洞描述和提供的PoC代码，该漏洞利用链是可行的。PoC代码包含了DNS投毒、NTLM中继和WinRM利用等关键步骤，并且针对CTF环境进行了优化，具有较高的成功率。

**投毒风险评估：**

虽然PoC代码本身看起来是合法的漏洞利用工具，但仍然存在一定的投毒风险。风险主要体现在以下几个方面：

*   **外部依赖：** PoC依赖`krbrelayx`和`impacket`等外部库。这些库如果被恶意修改，可能引入恶意代码。
*   **命令执行：** PoC会执行系统命令，攻击者可以通过修改`exploit.sh`中的命令来执行恶意操作。
*  **脚本内容分析:** 初步检查未发现明显的恶意代码，但是代码逻辑较为复杂，存在隐藏后门的可能，需进一步审计脚本和依赖。

综合以上因素，初步判断投毒风险为30%。需要注意的是，在实际使用PoC时，务必进行代码审计，并从可信的来源获取依赖库，以降低安全风险。

**项目地址:** [uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

## POC #12

**来源**: [CVE-2025-33073-yigitsql_CVE-2025-33073.md](../2025/CVE-2025-33073-yigitsql_CVE-2025-33073.md)

## CVE-2025-33073-Windows SMB Client Elevation of Privilege

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限

**影响版本:** 受影响的Windows版本及版本范围在漏洞库信息中已列出

**利用条件:** 需要攻击者在网络中，并具有一定的权限。目标系统需启用SMB服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端权限提升漏洞。根据漏洞库信息，未经适当访问控制的Windows SMB组件允许经过身份验证的攻击者在网络上提升权限。搜索引擎结果显示该漏洞利用了NTLM反射绕过，利用POC代码的github仓库已经存在。提供的POC代码（main.go）是一个用Go编写的HTTP Kerberos Relay Server，它接收带有Negotiate头的HTTP请求，提取Kerberos令牌，然后打印令牌长度。这个PoC缺少实际的SMB relay攻击逻辑，只实现了接受和解析Kerberos认证的初步框架。servers/dnsrelay.go是DNS中继服务器框架代码,暂时没有被main.go引用。因此，提供的PoC**不完整**，仅能作为漏洞利用的起点。PoC完整性取决于之后是否添加了完整的利用链。 投毒风险分析：提供的PoC代码主要是一个HTTP Kerberos Relay Server，用于接收和解析Kerberos票据。虽然代码本身没有明显的恶意行为，但如果攻击者修改此代码，例如在处理Kerberos票据时执行恶意操作，或者在DNS中继服务器中进行恶意DNS解析，则可能存在投毒风险。目前代码只是一个框架，存在被植入后门的可能，因此判定投毒风险为10%。 利用方式：攻击者首先需要设置一个恶意的SMB服务器或者劫持一个合法的SMB服务器。然后，诱骗受害者连接到该服务器。服务器通过NTLM反射或其他方法，迫使受害者客户端向攻击者控制的Kerberos Relay Server进行身份验证。 Relay Server接收到Kerberos票据后，利用此票据在目标网络上执行提升权限的操作。具体的操作可能包括访问敏感资源或执行特权命令。 总而言之，该漏洞的利用涉及中间人攻击和Kerberos协议的滥用。

**项目地址:** [yigitsql/CVE-2025-33073](https://github.com/yigitsql/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)

---

