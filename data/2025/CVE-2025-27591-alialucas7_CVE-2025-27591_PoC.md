## CVE-2025-27591 - Facebook Below (系统监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Facebook Below (系统监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 攻击者需拥有目标系统的本地普通用户权限，且系统已安装并运行版本早于0.9.0的Below服务。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC是一个使用Go语言编写的自动化攻击脚本，其逻辑清晰且针对性强。通过分析代码，该脚本首先验证环境是否存在漏洞，即检查目录 /var/log/below 是否具有‘全写’（world-writable）权限。核心利用步骤包括：在 /var/log/below 目录下创建一个指向 /etc/passwd 的符号链接文件 error_root.log。由于 Below 服务以 root 权限运行，并会在发生错误或执行特定任务时将日志内容写入该文件，攻击者可以利用这一竞态条件或权限错误，诱导 root 进程向 /etc/passwd 写入包含特定格式的数据（如攻击者自定义的 root 级用户行）。POC中定义的 maliciousLine 变量包含了 root 权限用户的定义。只要 Below 服务在写入日志时没有正确处理符号链接，就会导致越权修改系统敏感文件，从而实现从普通用户到 root 的垂直权限提升。该 POC 具备较高的实战价值，能够在受影响的版本上稳定复现。

利用步骤：1. 在本地机器编译 Go 脚本生成可执行文件；2. 将编译好的二进制文件上传至目标 Linux 服务器；3. 以普通用户身份执行该二进制文件；4. 脚本会自动检查 /var/log/below 的权限；5. 脚本创建指向 /etc/passwd 的软链接；6. 脚本可能通过触发 Below 服务的报错行为（如输入非法指令或利用服务重启），强制服务将错误日志输出到预设的软链接中；7. 若写入成功，/etc/passwd 会被追加一行 attacker 权限定义；8. 攻击者通过 su attacker 命令切换至 root 权限账户。

投毒风险分析：该 POC 来源于 GitHub 公开仓库 BridgerAlderson/CVE-2025-27591-PoC。代码审核显示，其逻辑主要围绕 os.Symlink、os.WriteFile 和系统路径检查展开，使用了标准的 Go 标准库，未发现明显的代码混淆、远程 Shell 反弹（Reverse Shell）或下载第三方恶意负载的行为。唯一的敏感行为是向 /etc/passwd 写入新用户，但这属于该漏洞利用过程的标准演示操作。然而，作为安全研究员，仍需注意虽然此 POC 目前看起来是‘干净’的，但攻击者可能克隆此类仓库并插入隐藏的恶意后门。本脚本由于包含直接修改核心系统文件的硬编码字符串，若在非隔离环境运行，可能导致系统账号体系损坏。目前评估其投毒风险为低（15%），主要风险点在于其对 /etc/passwd 的破坏性修改而非隐藏的恶意逻辑。在测试时，务必在严格的沙盒或虚拟机环境中运行，并建议手动审查任何来自第三方 GitHub 仓库的二进制预编译版本。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
