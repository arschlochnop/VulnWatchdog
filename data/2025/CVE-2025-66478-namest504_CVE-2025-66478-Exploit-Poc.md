## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, Next.js 16.x, Next.js 14.3.0-canary.77 及更高版本 (Canary releases)

**利用条件:** 通过特制请求远程执行代码，无需认证，AppRouter+RSC

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-66478 是 Next.js 应用程序中的一个远程代码执行 (RCE) 漏洞，该漏洞存在于 Next.js Server Actions 的处理中。该漏洞的根本原因是 RSC（React Server Components）Flight 协议中的不安全反序列化，攻击向量是通过 `__proto__` 属性进行原型污染。攻击者可以构造一个使用 React Flight 序列化格式的恶意负载，注入如 `__proto__` 这样的属性。服务器在没有适当验证的情况下反序列化该负载，导致 `Object.prototype` 被污染。污染会将 `then` 属性注入到所有对象中。Next.js 逻辑错误地将这些对象识别为 Promise（Thenables）。当服务器尝试 `await` 这个 "假 Promise" 时，注入到 `then` 方法中的恶意 JavaScript 代码（例如，`child_process.execSync`）将被执行，从而实现 RCE。此漏洞影响使用 App Router 的 Next.js 应用程序，包括 Next.js 15.x、Next.js 16.x 和 Next.js 14.3.0-canary.77 及更高版本（Canary 版本）。PoC 包含一个易受攻击的 Next.js 应用程序和一个 Python 漏洞利用脚本，用于测试该漏洞。该 PoC 的有效性已得到验证，使用 PoC 提供的 Python 脚本可以成功触发 RCE。利用步骤如下：1. 部署易受攻击的 Next.js 应用程序。2. 运行 Python 漏洞利用脚本，指定目标服务器的 URL。3. 脚本将发送包含恶意负载的 POST 请求。4. 服务器将反序列化负载并执行恶意代码。

投毒风险分析：该 PoC 的投毒风险较低，因为它主要由一个 Python 脚本和一个简单的 Next.js 应用程序组成。Python 脚本的代码清晰，使用了标准库，并且没有发现可疑行为。Next.js 应用程序的代码也相对简单，主要用于演示漏洞。但是，由于该漏洞允许远程代码执行，因此攻击者可能会尝试将恶意代码注入到服务器的应用程序中，以实现持久化或进一步的攻击。为了降低投毒风险，建议仔细审查任何从不受信任的来源下载的代码，并在生产环境中禁用 Server Actions 或实施更严格的输入验证。

**项目地址:** https://github.com/xxx/xxx

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-66478
