## CVE-2025-24813 - Apache Tomcat 远程代码执行(RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** 未知，需进一步分析确定

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** 未经身份验证，通过PUT请求上传恶意session文件触发反序列化

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 35%

## 详情

CVE-2025-24813是Apache Tomcat中一个未经身份验证的远程代码执行漏洞。该漏洞源于Tomcat处理部分PUT请求的功能存在缺陷，攻击者可以通过发送特制的PUT请求上传包含恶意代码的session文件到服务器，然后通过伪造的session cookie触发反序列化，最终实现远程代码执行。根据Rapid7的博客文章，该漏洞于2025年3月10日被披露，并且已经发布了修复版本。 

POC代码分析表明，该漏洞利用主要包含以下几个步骤：
1. **准备环境**: 检查java环境，如果不是java8，尝试下载java8。下载ysoserial工具，用于生成反序列化payload。
2. **生成Payload**: 使用ysoserial工具，根据指定的gadget (CommonsBeanutils1) 和命令 (CMD) 生成恶意payload，并将其写入到session文件。
3. **上传Payload**: 使用PUT请求将包含恶意payload的session文件上传到Tomcat服务器的/sessions/ 目录。POC代码中使用了随机数来避免文件名冲突。
4. **触发反序列化**: 通过设置包含伪造session ID的cookie向Tomcat服务器发送GET请求，从而触发反序列化操作，执行payload中的恶意代码。
5. **清理**: 删除上传的session文件。

POC代码的有效性较高，它自动化了漏洞利用的整个过程，可以轻松地在目标系统上执行任意命令。该POC利用了Tomcat的session管理机制，通过上传恶意session文件并触发反序列化漏洞来实现RCE。验证该POC时，需要确保目标系统安装了受影响版本的Apache Tomcat，并且允许PUT请求上传文件。 

**投毒风险分析：** 
该POC的投毒风险中等。ysoserial本身是一个广泛使用的反序列化漏洞利用工具，并非恶意软件。POC代码中使用了subprocess模块执行系统命令，这可能存在一定的风险，但ysoserial生成的payload是漏洞利用的关键，若被替换成恶意payload，则会造成严重危害。此外，POC在上传session文件时使用了随机数，这在一定程度上增加了分析的难度。综合考虑，该POC存在一定的投毒风险，但风险等级较低。攻击者可能会修改POC代码，例如替换ysoserial的gadget，插入额外的恶意代码，或者使用混淆技术来隐藏其真实意图。为了降低投毒风险，建议在运行POC代码之前进行详细的安全审查，例如检查代码中是否存在可疑的函数调用、网络请求或者文件操作。同时，需要密切关注ysoserial工具的安全性，确保使用的版本没有被篡改。

**项目地址:** https://github.com/random/repo

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
