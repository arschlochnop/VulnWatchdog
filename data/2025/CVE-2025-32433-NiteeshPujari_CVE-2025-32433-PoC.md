## CVE-2025-32433 - Erlang/OTP SSH server RCE (Remote Code Execution)

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE (Remote Code Execution)

**影响应用:** Erlang/OTP SSH server

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** OTP-27.3.2 及更早版本; OTP-26.2.5.10 及更早版本; OTP-25.3.2.19 及更早版本; 以及 17.0 以上的旧版本

**利用条件:** 远程且无需身份验证，目标系统需运行受影响版本的 Erlang/OTP SSH 服务

**POC 可用性:** 8/10

**POC 类型:** 完整利用/环境搭建引导

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】CVE-2025-32433 是一个存在于 Erlang/OTP SSH 守护程序中的极其严重的漏洞。该漏洞的核心在于 SSH 协议状态机的实现缺陷。在正常的 SSH 握手流程中，身份验证应该是后续所有通道操作的前提。然而，受影响的 Erlang/OTP 版本在处理 pre-authentication（预认证）阶段的消息时，未能严格强制执行协议顺序。攻击者可以绕过身份验证步骤，直接向服务器发送 `SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 消息。这种越权操作允许攻击者在未提供任何有效凭据的情况下，在服务器上打开会话通道并请求执行子进程或 shell。由于 Erlang 运行时的特性，这通常意味着攻击者可以以运行 Erlang 节点的系统用户权限执行任意操作系统命令。提供的 POC 包含了一个完整的 Docker 环境构建脚本，能够编译特定的受影响版本（OTP-26.2.5.10），这为漏洞复现提供了极高的可靠性。虽然截断的代码中未显示最终的攻击载荷脚本，但 README 明确说明了利用路径，结合 Dockerfile 中的环境配置，该 POC 对于安全研究人员验证漏洞极具参考价值。其利用逻辑符合 SSH 协议逻辑错误的典型特征，具有很高的实战威力。【利用步骤】1. 使用提供的 Dockerfile 构建实验环境，该环境会安装依赖并编译存在漏洞的 Erlang/OTP 版本。2. 启动容器内的 Erlang SSH 服务器，该服务器会监听 2222 端口。3. 攻击者编写一个 Python 或 Erlang 脚本，使用底层的 SSH 协议库（如 Paramiko 或直接构造 TCP 包）。4. 脚本连接到目标端口，但在进行传统的 `SSH_MSG_USERAUTH_REQUEST` 之前，直接发送 `SSH_MSG_CHANNEL_OPEN`。5. 接着发送类型为 'exec' 的 `SSH_MSG_CHANNEL_REQUEST`，并在 payload 中填入需要执行的 shell 命令（如 `whoami` 或反弹 shell）。6. 观察服务器响应，命令将在无需登录的情况下被执行。【投毒风险分析】该 POC 的投毒风险被评估为低（10%）。首先，代码结构非常透明，主要由一个标准的 Dockerfile 和一个 README 说明文件组成。Dockerfile 中所有的操作都是从官方镜像（Debian Bookworm）开始，并从 Erlang/OTP 的官方 GitHub 仓库拉取源代码进行编译，没有引入任何不明来源的第三方二进制文件或经过混淆的 Shell 脚本。README 中虽然包含了一些警告信息，但并没有发现强制要求用户运行 sudo 脚本或下载外部加密 payload 的可疑指令。10% 的风险保留主要基于安全行业的审慎原则：任何声称提供 RCE POC 的资源，其最终用于攻击的 Python 脚本或利用工具（在截断部分可能存在）都需要逐行审计，以防其在攻击目标的同时，将攻击者的信息回传至恶意服务器，或在本地机器植入隐蔽的持久化后门。目前的构建脚本侧重于服务端环境搭建，表现为标准的防御性研究工具。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32433](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32433)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
