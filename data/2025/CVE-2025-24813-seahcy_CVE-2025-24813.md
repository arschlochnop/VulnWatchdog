## CVE-2025-24813 - Apache Tomcat RCE/路径等价性(Path Equivalence)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE/路径等价性(Path Equivalence)

**影响应用:** Apache Tomcat

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 11.0.0-M1至11.0.2, 10.1.0-M1至10.1.34, 9.0.0.M1至9.0.98, 8.5.0至8.5.100

**利用条件:** 启用DefaultServlet的写入功能(readonly=false)，且通常需要利用PUT方法上传恶意文件。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-24813）源于Apache Tomcat在处理带有‘Internal Dot’（内部点号）的文件名时存在路径等价性逻辑缺陷。在特定配置下（如Default Servlet配置为允许写入），攻击者可以通过构造特殊的路径绕过安全限制，实现任意文件上传。POC代码针对Tomcat v9.0.90环境，展示了通过PUT请求上传恶意负载的过程。其核心利用逻辑是结合了Java反序列化漏洞，通过ysoserial工具生成基于CommonsCollections6的Payload，并利用目标服务器上存在的commons-collections-3.2.1.jar依赖触发代码执行。该POC提供了详细的Windows Server 2019环境搭建指南，包括JDK安装、Tomcat配置及环境变量设置。POC的有效性极高，因为它不仅验证了路径绕过漏洞本身，还演示了如何将其转化为完全的远程代码执行。对于防御者而言，此POC清晰地展示了攻击链路：首先利用路径等价性缺陷获得文件写入权限，然后通过上传并触发Java反序列化Payload来夺取系统控制权。分析表明，若Tomcat的Default Servlet被配置为非只读模式，该利用链在受影响版本中具有极高的成功率。此外，POC中提到的PUT请求绕过了许多传统的Web应用防火墙（WAF）规则，增加了检测难度。【利用步骤】1. 在受害机上部署指定版本的Tomcat并配置Default Servlet为可写；2. 在WEB-INF/lib下放置存在漏洞的commons-collections组件；3. 攻击者使用ysoserial生成反序列化Payload；4. 通过PUT请求利用路径等价性绕过限制，将Payload写入目标服务器；5. 触发Payload执行系统命令。【投毒风险分析】该POC仓库的投毒风险评估为15%，属于低风险范畴。代码逻辑主要集中在环境自动化部署脚本（PowerShell）和利用说明上。经过对提供的README及脚本片段分析，其下载链接均指向官方合法的资源库，如Apache官网、Oracle官网及Maven中央仓库，未发现重定向至恶意域名的行为。脚本内容公开透明，主要用于网络安全威胁演练。尽管如此，安全研究员仍需警惕以下几点：第一，虽然当前展示的Invoke-WebRequest链接是安全的，但在实际克隆仓库时，需检查是否存在未披露的二进制可执行文件或混淆的Python脚本（如exploit.py的具体实现）；第二，该仓库诱导用户降低服务器安全配置（如修改tomcat-users.xml和context.xml），在生产环境中操作具有极高风险。目前的分析结果显示，该项目更多是一个教学和漏洞复现工具，而非恶意投毒样本，其行为符合防御性安全研究的特征，未发现隐藏的后门代码或针对研究员环境的攻击指令。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-24813](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-24813)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)
