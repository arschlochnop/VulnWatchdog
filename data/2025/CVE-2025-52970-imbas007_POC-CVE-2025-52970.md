# CVE-2025-52970

> 📦 该CVE有 **4** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-52970-34zY_CVE-2025-52970.md](../2025/CVE-2025-52970-34zY_CVE-2025-52970.md)

## CVE-2025-52970-FortiWeb-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2025-52970

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** FortiWeb

**危害等级:** 高危，可导致完全控制受影响的 FortiWeb 设备

**影响版本:** <=7.6.3, <=7.4.7, <=7.2.10, <=7.0.10

**利用条件:** 需要能够通过网络访问 FortiWeb 设备的管理界面, 并且需要具备针对目标用户的非公开信息（根据漏洞库描述）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-52970 漏洞是 Fortinet FortiWeb 中的一个参数处理不当漏洞（CWE-233），允许未经身份验证的远程攻击者利用特定构造的请求绕过身份验证，并获得设备的管理员权限。根据漏洞库信息，攻击需要非公开信息，这增加了攻击的复杂性，CVSS评分表明这是一个高危漏洞，具有高机密性、完整性和可用性影响。搜索结果表明该漏洞已经被公开披露，并且存在可用的漏洞利用代码（POC）。

**漏洞利用方式：**

1.  **身份验证绕过：** 攻击者通过构造包含恶意 SQL 注入的 `Authorization` 请求头，向 `/api/fabric/device/status` API 端点发送请求，绕过身份验证机制。
2.  **远程代码执行（RCE）：** 漏洞利用代码使用 SQL 注入来写入 webshell 和执行 chmod 命令。
    *   首先，它使用 SQL 注入在数据库表 `fabric_user.a` 中写入一个简单的 webshell (保存在 `/migadmin/cgi-bin/x.cgi`)。 这个 webshell 简单地执行 `User-Agent` 中的命令。
    *   然后，它使用 SQL 注入写入一个 chmod 脚本到 `/var/log/lib/python3.10/pylab.py`.
    *   最后，它通过访问 `/cgi-bin/ml-draw.py` 来触发 chmod 命令的执行，从而使 webshell 具备执行权限。
3.  **命令执行：** 成功部署 webshell 后，攻击者可以通过修改 HTTP 请求的 `User-Agent` 头来执行任意命令。

**有效性评估：**
根据搜索结果和提供的漏洞利用代码，该漏洞的POC是可用的，并且已经被公开讨论，因此该POC很可能有效。漏洞利用代码实现了身份验证绕过和远程代码执行，证明了漏洞的可利用性。

**投毒风险评估：**
仔细分析提供的Python脚本`CVE-2025-52970.py`，存在一定投毒风险，可能性为10%。

*   **可能的投毒点分析：**
    *   **Webshell位置：**/migadmin/cgi-bin/x.cgi。虽然webshell本身功能比较直接（执行User-Agent中的命令），但该路径的选择可能较为隐蔽，不易被发现。如果目标系统运维人员不熟悉此路径，可能会忽略webshell的存在。
    *   **依赖关系：**脚本依赖于`requests`和`urllib3`库。虽然这是常见的库，但如果目标系统缺少这些依赖，攻击者可以诱导受害者安装包含恶意代码的库。
    *   **错误处理：**脚本中的错误处理相对简单。虽然有`try-except`块，但如果请求失败，可能不会提供足够的信息来帮助受害者识别问题，从而增加了攻击者隐藏恶意行为的机会。

*  **理由：**
    *   该脚本的主要功能是利用已知的身份验证绕过漏洞执行远程代码。webshell功能简单，主要风险在于位置的隐蔽性。
    *  该脚本没有任何明显的恶意代码，例如反向shell、数据窃取或破坏操作。然而，攻击者完全可以修改脚本，加入这些恶意行为。webshell本身也为后续的恶意操作提供了便利。
    *   该脚本的设计可能旨在隐藏真实目的。利用SQL注入写入webshell和chmod脚本，这种多步骤的利用过程增加了复杂性，使得快速分析变得困难。攻击者可能试图利用这一点，在后续阶段添加恶意功能。

总体而言，该脚本存在一定的投毒风险。虽然该脚本主要关注利用已知漏洞，但攻击者完全可以利用脚本的特性来隐藏其他恶意行为。

**缓解措施：**
*   立即升级 FortiWeb 到不受影响的版本（8.0.0 或以上，7.6.4 或以上，7.4.8 或以上，7.2.11 或以上，7.0.11 或以上）。
*   如果无法立即升级，请实施网络分段和访问控制策略，限制对 FortiWeb 管理界面的访问。
*   监控 FortiWeb 设备的日志，以检测任何可疑活动。

**项目地址:** [34zY/CVE-2025-52970](https://github.com/34zY/CVE-2025-52970)

**漏洞详情:** [CVE-2025-52970](https://nvd.nist.gov/vuln/detail/CVE-2025-52970)

---

## POC #2

**来源**: [CVE-2025-52970-Hex00-0x4_Authentication-Bypass-in-FortiWeb-CVE-2025-52970-.md](../2025/CVE-2025-52970-Hex00-0x4_Authentication-Bypass-in-FortiWeb-CVE-2025-52970-.md)

## CVE-2025-52970-FortiWeb-权限提升

**漏洞编号:** CVE-2025-52970

**漏洞类型:** 权限提升

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致完全控制设备

**影响版本:** 7.6.3 及以下, 7.4.7 及以下, 7.2.10 及以下, 7.0.10 及以下

**利用条件:** 需要具有非公开的设备和目标用户信息，网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-52970 是 FortiWeb 中的一个参数处理不当漏洞，允许未经身份验证的远程攻击者，如果拥有关于设备和目标用户的非公开信息，可以通过精心构造的请求获得设备上的管理员权限。

**有效性评估：**
根据搜索引擎结果，漏洞利用代码已被发布，Fortinet 也确认存在公开的 PoC。因此，漏洞利用的有效性较高。

**投毒风险评估：**
提供的漏洞利用代码仅包含 MIT 许可证，未发现任何可疑的或恶意的代码。因此，投毒风险较低。

**利用方式分析：**
1.  攻击者需要获取关于目标 FortiWeb 设备和用户的非公开信息。
2.  攻击者构造一个特殊的 HTTP 请求，其中包含精心设计的参数，利用参数处理不当的漏洞。
3.  成功利用后，攻击者将获得 FortiWeb 设备的管理员权限。

根据漏洞描述，攻击复杂度较高（CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H），需要特定的非公开信息。

**项目地址:** [Hex00-0x4/Authentication-Bypass-in-FortiWeb-CVE-2025-52970-](https://github.com/Hex00-0x4/Authentication-Bypass-in-FortiWeb-CVE-2025-52970-)

**漏洞详情:** [CVE-2025-52970](https://nvd.nist.gov/vuln/detail/CVE-2025-52970)

---

## POC #3

**来源**: [CVE-2025-52970-Hex00-0x4_FortiWeb-CVE-2025-52970-Authentication-Bypass.md](../2025/CVE-2025-52970-Hex00-0x4_FortiWeb-CVE-2025-52970-Authentication-Bypass.md)

## CVE-2025-52970-FortiWeb-权限提升

**漏洞编号:** CVE-2025-52970

**漏洞类型:** 权限提升

**影响应用:** FortiWeb

**危害等级:** 高危，允许未授权远程攻击者获得管理员权限

**影响版本:** <= 7.6.3, <= 7.4.7, <= 7.2.10, <= 7.0.10

**利用条件:** 需要拥有关于目标设备和目标用户的非公开信息

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-52970 是 FortiWeb 中的一个参数处理不当漏洞。利用该漏洞，拥有目标设备和目标用户非公开信息的未经身份验证的远程攻击者可以通过精心设计的请求获得设备上的管理员权限。攻击复杂度较高，因为攻击者需要拥有非公开的信息。漏洞利用代码本身（提供的LICENSE）没有发现任何投毒代码，但攻击者可能在实际的利用payload中进行投毒，这部分无法从当前信息中判断。

**有效性评估：**

从漏洞库信息和搜索结果来看，存在公开的PoC代码，Fortinet官方也确认了该漏洞的存在和修复方案。搜索结果[webpage 7]表明“部分PoC代码是公开的”。这说明漏洞存在可利用性。

**投毒风险评估：**

提供的漏洞利用代码(LICENSE)仅仅是一个开源协议的声明，本身不包含任何可执行代码，因此不存在明显的投毒风险。如果攻击者将该漏洞与恶意代码结合使用，则存在投毒的可能，但提供的文件本身不构成直接的投毒行为。所以投毒风险评估为0%。

**利用方式：**

1.  **信息收集：** 攻击者需要收集关于目标 FortiWeb 设备和目标用户的非公开信息。
2.  **构造恶意请求：** 攻击者根据收集到的信息，构造一个特别设计的 HTTP 请求。
3.  **权限提升：** FortiWeb 在处理恶意请求时，参数处理不当导致攻击者绕过身份验证，获得管理员权限。

**项目地址:** [Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass](https://github.com/Hex00-0x4/FortiWeb-CVE-2025-52970-Authentication-Bypass)

**漏洞详情:** [CVE-2025-52970](https://nvd.nist.gov/vuln/detail/CVE-2025-52970)

---

## POC #4

**来源**: [CVE-2025-52970-imbas007_POC-CVE-2025-52970.md](../2025/CVE-2025-52970-imbas007_POC-CVE-2025-52970.md)

## CVE-2025-52970-FortiWeb-身份验证绕过和远程代码执行

**漏洞编号:** CVE-2025-52970

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** FortiWeb

**危害等级:** 高危，允许未经身份验证的远程攻击者获得管理员权限并在设备上执行任意代码

**影响版本:** <= 7.6.3, <= 7.4.7, <= 7.2.10, <= 7.0.10

**利用条件:** 需要目标FortiWeb设备可以通过网络访问，并且攻击者需要具备关于目标设备和目标用户的非公开信息。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-52970 是 Fortinet FortiWeb 中的一个参数处理不当漏洞，允许未经身份验证的远程攻击者利用非公开信息构造恶意请求，绕过身份验证并获得设备的管理员权限。攻击利用方式主要分为三个阶段：

1.  **SQL 注入：**
    *   POC 代码利用了 `/api/fabric/device/status` API 接口的 SQL 注入漏洞。通过在 `Authorization` header 中注入恶意 SQL 代码，攻击者可以执行任意 SQL 查询。注入点在 `Bearer` 字段后，利用 `;` 分隔符注入SQL语句。

2.  **远程代码执行 (RCE)：**
    *   利用 SQL 注入，攻击者可以向数据库表中写入 webshell 和执行 chmod 命令的恶意代码（pylab.py）。具体流程是：
        *   首先，清空并重新创建名为 `fabric_user.a` 的表，用于存储 webshell 代码片段。
        *   将 webshell 代码分割成 16 字节的小块，并通过 SQL 注入将这些小块逐步写入到 `fabric_user.a` 表的 `a` 列中。
        *   使用 `select ... into outfile` 语句将 `fabric_user.a` 表中的内容写入到 `/migadmin/cgi-bin/x.cgi` 文件，该文件成为 webshell。
        *   类似地，将用于执行 chmod 命令的代码写入到 `/var/log/lib/python3.10/pylab.py` 文件。
        *   通过访问 `/cgi-bin/ml-draw.py` 触发 pylab.py 的执行，进而执行 chmod 命令，为 webshell 赋予执行权限。

3.  **命令执行：**
    *   webshell 部署在 `/migadmin/cgi-bin/x.cgi`。攻击者可以通过修改 `User-Agent` HTTP 头来传递要执行的命令，webshell 会执行该命令并将结果返回。

**有效性评估：**

根据漏洞信息和 POC 代码，该漏洞利用的有效性较高。搜索引擎结果也表明该漏洞已被公开利用，并且存在可用的 exploit 代码。

**投毒风险评估：**

该 POC 代码本身主要包含漏洞利用所需的必要步骤，但仍然存在轻微的投毒风险的可能性，例如：

*   **依赖项风险：** 代码依赖于 `requests` 和 `urllib3` 库。虽然这些库本身是安全的，但如果用户的环境中存在被恶意篡改的同名库，则可能引入安全风险。
*   **后门植入：** 攻击者可能会在 webshell 代码中插入额外的恶意代码，例如反向 shell 或持久化机制。
*   **日志清除失败：** 代码中没有明确的日志清除功能。如果攻击成功，但系统日志中留下了痕迹，可能会暴露攻击行为。
*   **webshell路径存在风险:**webshell 路径是 `/migadmin/cgi-bin/x.cgi` , 如果代码的作者提前在相同路径下放置一个恶意的文件,将会存在风险.该文件会在脚本成功写入webshell文件之前执行

综合考虑，投毒风险大约为 10%。

**项目地址:** [imbas007/POC-CVE-2025-52970](https://github.com/imbas007/POC-CVE-2025-52970)

**漏洞详情:** [CVE-2025-52970](https://nvd.nist.gov/vuln/detail/CVE-2025-52970)

---

