## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** sudo 1.9.14 – 1.9.17 (固定版本 1.9.17p1 及以上)

**利用条件:** 需要本地用户权限；Sudo配置允许使用`--chroot`选项；攻击者需能在一个用户控制的目录中写入恶意文件（如`nsswitch.conf`和恶意动态库）。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-32463是Linux Sudo组件中一个高危本地权限提升漏洞，CVSS评分为9.3。该漏洞影响Sudo版本1.9.14至1.9.17，并通过滥用Sudo的`--chroot`（或`-R`）选项实现。漏洞的核心在于，当Sudo使用`--chroot`选项执行命令时，它会在一个由用户控制的临时chroot环境中查找`/etc/nsswitch.conf`文件。攻击者可以利用这一点，在该chroot环境中构造一个恶意的`nsswitch.conf`文件，并使其加载一个预先准备的恶意`libnss_*.so`动态库。当Sudo以root权限在chroot环境中尝试解析名称服务（如用户或组信息）时，会加载并执行这个恶意的动态库，从而允许攻击者在root权限下执行任意代码，实现完整的本地权限提升。

**POC有效性分析：**
提供的POC（`sudo-chwoot.sh`脚本）是一个经过验证的完整利用程序，尤其被设计用于HackViser的VIP挑战，这表明其具有高度的可靠性和有效性。POC通过创建一个临时目录作为chroot环境，在该环境中精心构造`nsswitch.conf`文件，并创建一个恶意动态库（例如，伪装成`libnss_systemd.so.2`或类似的库）。该恶意库会在被Sudo加载时执行预设的命令，例如启动一个root shell或写入特定文件。脚本的逻辑清晰，步骤明确，包括环境设置、恶意文件创建、利用以及清理。虽然POC代码已被截断，但从`README.md`的描述和剩余代码片段来看，其核心利用逻辑符合典型的`libnss_`劫持方式，即通过控制`nsswitch.conf`文件来强制Sudo加载一个恶意的共享库。这种方法在Linux本地提权中被广泛认知和利用，且历史上有多个类似的漏洞（如CVE-2019-14287等），因此该POC被判定为高度有效，能够可靠地实现root权限获取。

**利用步骤：**
1. SSH登录到目标机器：`ssh guest@<TARGET-IP>`
2. 进入可写目录：`cd /tmp`
3. 创建exploit文件：`nano run.sh`
4. 将POC脚本内容粘贴到`run.sh`中并保存（Ctrl+X, Y, Enter）。
5. 赋予脚本执行权限：`chmod +x run.sh`
6. 运行exploit：`./run.sh`
7. 验证root权限：`id` 或 `whoami`
8. 读取flag文件（如果是在CTF环境）：`cat /secret.txt`

**投毒风险分析：**
经过对POC代码（`sudo-chwoot.sh`）、`README.md`以及相关文件（如`License`和`Defensive Recommendations`）的全面分析，我们评估该POC的投毒风险为0%。这一判断基于以下几个关键因素：
首先，**代码的透明性和可读性**。`sudo-chwoot.sh`脚本虽然被截断，但其现有的部分以及`README.md`中对利用机制的描述都表明，代码逻辑清晰，没有采用任何形式的混淆技术。攻击者通过构造恶意的`nsswitch.conf`文件和动态链接库来实现提权的原理在安全社区是公开且被充分理解的。这种透明度允许任何具备基本Shell脚本和Linux系统知识的用户检查其行为，确保其仅执行了预期的漏洞利用逻辑，而不包含其他未经声明的恶意功能。
其次，**缺乏外部依赖和可疑网络活动**。该POC的利用过程完全依赖于目标系统自身的Sudo组件和动态链接机制，没有迹象表明它会尝试从外部服务器下载额外的代码、库文件或执行其他不可预测的操作。脚本中未发现任何涉及`curl`、`wget`或其他网络通信工具的代码片段，也未检测到与非标准C2服务器通信的尝试。这大大降低了在利用过程中被植入后门或进行数据窃取的风险。
再者，**明确的许可协议和防御建议**。该项目附带了标准的MIT许可协议，这是一个广为接受的开源软件许可，其开放性本身就鼓励用户进行审查。更重要的是，项目明确提供了“Defensive Recommendations”（防御建议），这包括升级Sudo到最新版本、禁用`--chroot`选项以及监控`libnss_*.so`的非预期加载等。这些建议是典型的防御性安全研究输出，与恶意软件或投毒代码的行为模式完全不符。一个旨在投毒的项目通常不会主动告知用户如何防御其攻击。
最后，**POC的用途和背景**。`README.md`明确指出该POC是为HackViser的“VIP Challenge”而设计的，这通常是安全竞赛或渗透测试演练的一部分。在这种背景下，POC的唯一目标是证明漏洞的可利用性以完成挑战，而非秘密地安装恶意软件或造成系统破坏。
综上所述，所有迹象均表明此POC是一个合法的安全研究和漏洞演示工具，其代码行为可预测且符合声明目的。因此，在合理使用和来源确认的前提下，其投毒风险可以忽略不计。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
