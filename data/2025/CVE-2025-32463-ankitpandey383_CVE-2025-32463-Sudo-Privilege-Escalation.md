## CVE-2025-32463 - Sudo 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.9.14 - 1.9.17

**利用条件:** 具有本地低权限用户访问权限，且sudo版本在受影响范围内

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC代码展现了极高的有效性，针对的是Sudo 1.9.14至1.9.17版本中引入的--chroot (-R) 选项缺陷。漏洞核心在于sudo在处理chroot环境时，未能正确隔离动态链接库的加载路径，允许本地用户通过受控目录下的/etc/nsswitch.conf引导系统加载恶意的共享库。通过分析提供的POC脚本‘sudo-chwoot.sh’，该脚本自动化执行了以下逻辑：首先创建一个临时目录作为伪造的chroot环境，随后在其中构造必要的目录结构（如etc、lib等）。关键步骤是生成一个恶意的共享库（通常命名为libnss_开头的库文件），并在其中编写执行提权代码的初始化函数。最后，脚本通过sudo --chroot执行一个简单的命令，触发sudo在特权上下文中加载恶意库，从而获取root Shell。代码结构清晰，利用逻辑符合Sudo漏洞公开的机理，在实验环境中具有很高的复现成功率。 【利用步骤】1. 获取目标Linux系统的本地低权限Shell访问。2. 检查sudo版本，确认在1.9.14至1.9.17范围内。3. 将POC脚本上传至可写目录（如/tmp）。4. 赋予执行权限：chmod +x sudo-chwoot.sh。5. 执行脚本：./sudo-chwoot.sh。脚本会自动创建工作空间，生成并编译恶意so文件，随后触发sudo执行。6. 验证权限：执行id或whoami，确认当前用户已提升至root权限。7. 读取敏感文件（如/etc/shadow或/secret.txt）完成验证。 【投毒风险分析】该POC的投毒风险极低，约为5%。首先，代码托管于HackViser等知名安全挑战平台相关的项目，具有较高的可信度。其次，代码逻辑透明，使用了标准的Bash脚本和GCC编译流程，没有经过任何形式的代码混淆、Base64加密或十六进制编码。分析其网络行为，脚本未发现尝试连接外部C2（控制端）服务器的逻辑，也没有下载执行不明远程脚本的行为。虽然脚本涉及创建临时文件和编译操作，但这均属于提权POC的标准行为，并非恶意软件特征。唯一需要注意的是，用户在从非官方渠道下载此类脚本时，应确保其来源可靠，防止恶意第三方在脚本中植入窃取凭据的后门指令。当前提供的脚本内容纯粹用于安全研究和漏洞复现，未发现恶意投毒迹象。

**项目地址:** [https://github.com/AnkitDayanand/CVE-2025-32463-Sudo-Privilege-Escalation](https://www.google.com/search?q=https://github.com/AnkitDayanand/CVE-2025-32463-Sudo-Privilege-Escalation)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
