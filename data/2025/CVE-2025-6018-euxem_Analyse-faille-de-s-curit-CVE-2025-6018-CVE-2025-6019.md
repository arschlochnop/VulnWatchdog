## CVE-2025-6018 - Linux (openSUSE Leap 15/SLES 15 PAM模块及udisks组件) 本地权限提升

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地权限提升

**影响应用:** Linux (openSUSE Leap 15/SLES 15 PAM模块及udisks组件)

**危害等级:** 高

**CVSS评分:** 待定

**影响版本:** openSUSE Leap 15 / SLES 15 (PAM模块存在配置缺陷，如polkit=121-150500.3.3.1) 以及波及多数主流Linux发行版 (udisks组件，如udisks2=2.9.2-150400.3.8.1)。POC特定环境为openSUSE-Leap-15.6。

**利用条件:** 本地普通用户权限，无需认证，需要可交互的会话（如SSH/TTY）。

**POC 可用性:** 6/10

**POC 类型:** 概念验证 (环境搭建)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-6018 和 CVE-2025-6019 是由 Qualys 威胁研究小组披露的一对高危本地权限提升漏洞，它们通常被组合利用形成一个漏洞利用链，允许本地普通用户在受影响的 Linux 系统上提升权限至 root。CVE-2025-6018 主要影响 openSUSE Leap 15 / SLES 15 操作系统中的 PAM（可插拔认证模块）配置缺陷，具体表现为 PAM 错误地将远程登录会话识别为本地控制台会话，从而绕过某些安全限制。CVE-2025-6019 则是一个更广泛的漏洞，波及几乎所有主流 Linux 发行版（包括 Ubuntu、Debian、Fedora、openSUSE），其根源在于 udisks 守护进程在挂载文件系统时对 libblockdev 库的调用存在问题。这两个漏洞结合利用，能让攻击者在无需特殊手段的情况下，从普通用户权限轻松获取系统 root 权限，对系统安全构成严重威胁。腾讯云安全中心和阿里云漏洞库均已发布风险通告，强调了这两个漏洞的严重性。

**POC有效性分析:**
提供的 POC 代码包含一个 `README.md` 文件和一个 `vagrantfile`。`README.md` 详细指导用户如何设置一个用于演示漏洞的 VirtualBox 虚拟机环境，包括下载特定版本的 openSUSE-Leap-15.6 ISO 镜像，并要求安装 VirtualBox 和 Vagrant 依赖。`vagrantfile` 文件是 Vagrant 虚拟化工具的配置文件，它负责自动化虚拟机的创建和配置过程。具体来说，该 `vagrantfile` 完成以下任务：
1.  **定义ISO路径**: 设置 `ISO_PATH` 变量指向下载的 openSUSE-Leap-15.6 DVD-aarch64 镜像文件。
2.  **VM配置**: 配置 VirtualBox 虚拟机，命名为 "CVE-2025-6018ANDCVE-2025-6019"，分配 2GB 内存和 2 个 CPU 核心。
3.  **ISO挂载**: 将指定的 ISO 镜像作为 DVD 驱动器挂载到虚拟机中。
4.  **系统初始化**: 通过 shell 脚本进行系统初始化，包括：
    *   刷新 `zypper` 软件包管理器。
    *   安装 `sudo`。
    *   **关键步骤**: 安装特定版本的 `polkit=121-150500.3.3.1` 和 `udisks2=2.9.2-150400.3.8.1`。这些特定版本被认为是存在漏洞的版本，POC 通过此步骤确保了虚拟机环境处于易受攻击的状态。
    *   创建一个名为 `etudiant` 的普通用户，密码为 `Etudiant123!`，用于后续的漏洞利用测试。
    *   启用并启动 SSHD 服务，以便通过 SSH 连接到虚拟机。
总结来说，此 POC 代码本身并不包含实际的漏洞利用 Payload 或攻击脚本，它是一个**环境搭建脚本**，用于创建和配置一个包含 CVE-2025-6018 和 CVE-2025-6019 漏洞的 openSUSE-Leap-15.6 系统。其有效性在于能够可靠地重现漏洞存在的环境，为后续的漏洞利用开发和测试提供了基础。因此，它是一个高质量的**概念验证环境搭建**工具，但并非一个完整的、一键式的漏洞利用工具。攻击者需要在此环境基础上，自行开发或整合已有的 exploit 代码来完成提权。

**利用步骤:**
1.  **准备环境**: 确保宿主机已安装 VirtualBox 和 Vagrant。
2.  **下载ISO**: 从 `https://download.opensuse.org/distribution/leap/15.6/iso/openSUSE-Leap-15.6-DVD-aarch64-Build710.3-Media.iso` 下载 openSUSE-Leap-15.6 镜像文件，并将其放置在 `vagrantfile` 所在的目录。根据 `vagrantfile` 中的 `ISO_PATH` 变量，确保路径正确。
3.  **启动VM**: 在 `vagrantfile` 所在目录打开终端，运行 `vagrant up` 命令。Vagrant 将自动创建并配置 VirtualBox 虚拟机，安装指定的操作系统和易受攻击的软件包版本。
4.  **登录虚拟机**: 待虚拟机启动并配置完成后，可以通过 SSH 连接到虚拟机。默认情况下，Vagrant 会设置一个端口转发，用户可以使用 `vagrant ssh` 命令登录，或者使用用户名 `etudiant` 和密码 `Etudiant123!` 通过 SSH (默认端口 2222) 登录。
5.  **执行漏洞利用**: 登录后，攻击者需要在此虚拟机内部，执行针对 CVE-2025-6018 和/或 CVE-2025-6019 的实际漏洞利用代码（此 POC 中未提供），以尝试从普通用户 `etudiant` 提升权限到 root 用户。

**投毒风险分析:**
对所提供的 POC 代码（`README.md` 和 `vagrantfile`）进行分析，评估其投毒风险。
1.  **代码内容**: `README.md` 仅包含说明文档，不涉及可执行代码。`vagrantfile` 是一个基于 Ruby 的配置文件，其核心是调用 VirtualBox 和 shell 命令来配置虚拟机。所有 shell 命令都是标准且可读的，例如 `zypper refresh`、`zypper install`、`useradd`、`chpasswd`、`systemctl`。这些命令的目的是为了搭建一个特定的、已知脆弱的系统环境，而非执行恶意操作。
2.  **外部依赖**: `vagrantfile` 主要依赖本地安装的 VirtualBox 和 Vagrant 工具。它引导用户从 openSUSE 官方镜像站点下载 ISO 文件，这是一个可信赖的来源。在虚拟机内部，它使用 `zypper` 包管理器从官方源安装软件包。
3.  **混淆和加密**: 代码清晰可见，没有任何混淆、加密或难以理解的部分。
4.  **恶意行为**: 代码中没有发现任何试图执行非预期操作、回连 C2 服务器、下载恶意负载、修改关键系统文件、收集敏感信息或创建后门的行为。创建 `etudiant` 用户并设置密码是为了测试目的，属于正常环境设置范畴。安装特定版本的 `polkit` 和 `udisks2` 是为了还原漏洞环境，并非投毒行为。
综合以上分析，此 POC 代码的投毒风险极低（0%）。它严格遵循了其声明的目的——搭建一个用于研究和验证漏洞的环境，不包含任何恶意或可疑的 Payload。用户可以安全地使用此 POC 来构建测试环境。

**项目地址:** N/A (本地路径)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-6018
