## CVE-2025-0411 - 7-Zip MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 用户下载并执行恶意构造的压缩文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-0411是一个存在于7-Zip压缩软件中的高危漏洞，它允许攻击者绕过Windows的Mark-of-the-Web (MOTW) 安全机制，从而在受害者系统上执行任意代码。该漏洞源于7-Zip在处理嵌套压缩文件时未能正确传递MOTW标志。当用户下载并解压特制的恶意压缩文件时，其中包含的可执行文件将不会被标记为来自网络，从而绕过Windows的安全警告，允许恶意代码在用户不知情的情况下执行。

POC有效性分析：
根据已有的POC代码和搜索结果，该漏洞利用方式较为简单，用户只需使用受影响的7-Zip版本（24.09之前）将一个可执行文件压缩两次，即可生成一个能够绕过MOTW机制的恶意压缩包。当用户下载并执行这个恶意压缩包时，其中的可执行文件不会显示安全警告，从而可能诱使用户执行恶意代码。POC代码已经公开，表明该漏洞已经得到了验证，并且可以被恶意攻击者利用。多个新闻报道和安全公告都确认了该漏洞的存在及其潜在危害。

利用步骤：
1. 攻击者创建一个包含恶意代码的可执行文件。
2. 攻击者使用7-Zip 24.09之前的版本将该可执行文件压缩两次，生成恶意压缩包。
3. 攻击者将恶意压缩包上传到网络或通过其他方式传播给受害者。
4. 受害者下载并解压该恶意压缩包。
5. 受害者执行解压后的可执行文件，恶意代码在受害者系统上执行。

投毒风险分析：
该POC的投毒风险较低，因为POC代码主要用于演示漏洞原理，本身不包含恶意代码。但是，如果攻击者将POC代码与恶意代码结合，就可以创建一个具有更高投毒风险的恶意压缩包。攻击者可能会在压缩包中嵌入恶意脚本或可执行文件，诱使用户执行。此外，攻击者还可能对POC代码进行混淆，以隐藏其真实目的。由于利用方式简单，容易被攻击者利用进行恶意软件传播，因此存在一定的投毒风险。考虑到POC代码本身清晰易懂，没有发现恶意行为或外部脚本调用，并且使用了标准的压缩库，因此判定投毒风险为10%。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC

**漏洞详情:** 未提供
