## CVE-2025-0411-7-Zip-MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 受影响版本低于24.09

**利用条件:** 用户需要下载并使用恶意的压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411是一个存在于7-Zip中的高危漏洞，允许攻击者绕过Windows的Mark-of-the-Web (MOTW)安全机制，从而在受害者系统上执行任意代码。该漏洞的利用方式是，攻击者创建一个包含恶意代码的特制压缩文件，诱骗用户下载并使用7-Zip打开。由于该漏洞绕过了MOTW，Windows不会显示警告，用户在不知情的情况下执行了恶意代码。

**有效性：**

根据搜索结果和POC代码描述，该漏洞的POC是存在的，并且被认为是有效的。多个新闻报道都提到了该漏洞以及更新到24.09版本的必要性，进一步佐证了其有效性。

**投毒风险：**

POC代码本身是一个漏洞验证的利用代码，投毒风险主要来自以下几个方面：

1.  **POC代码本身被修改：** 尽管Github仓库的内容看似安全，但仍然存在作者在后续更新中引入恶意代码的可能性。不过，考虑到这是一个相对简单的MOTW绕过漏洞的POC，直接在绕过代码中添加恶意行为的可能性较低。
2.  **依赖的外部资源被污染：**  POC可能依赖于某些外部链接或脚本，如果这些资源被攻击者控制，就可能引入恶意代码。
3.  **用户误用POC：** 最常见的投毒风险是用户在不了解POC代码的情况下，直接将其应用于生产环境，从而导致安全问题。虽然不是作者直接投毒，但用户的误用也是一种风险。

基于以上分析，判定此仓库中存在作者隐藏的投毒代码的可能性较低，大约为10%。

**利用方式：**

1.  攻击者构造一个特制的恶意压缩包，其中包含恶意可执行文件。
2.  攻击者将恶意压缩包放置在网络共享或者通过钓鱼邮件等方式传播。
3.  受害者使用存在漏洞的7-Zip版本打开恶意压缩包。
4.  由于MOTW绕过，Windows不会显示安全警告。
5.  恶意可执行文件在受害者系统上执行，实现任意代码执行。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)