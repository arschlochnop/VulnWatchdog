## CVE-2025-0411 - 7-Zip MOTW Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW Bypass

**影响应用:** 7-Zip

**危害等级:** High

**CVSS评分:** N/A

**影响版本:** All versions before 24.09

**利用条件:** User interaction (downloading and executing a specially crafted archive).

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 30%

## 详情

CVE-2025-0411 is a high-risk vulnerability in 7-Zip that allows remote attackers to bypass the Mark-of-the-Web (MOTW) security mechanism in Windows. This vulnerability exists because 7-Zip fails to properly propagate the MOTW flag when handling nested archives. An attacker can exploit this flaw by creating a specially crafted archive that, when extracted by a vulnerable version of 7-Zip, will execute malicious code without the usual security warnings. This can lead to arbitrary code execution on the victim's system. The vulnerability is triggered when a user downloads a malicious archive (e.g., a ZIP file containing another ZIP file, which in turn contains an executable) and extracts it using 7-Zip. Due to the MOTW bypass, the extracted executable will not be flagged as originating from the internet, and the user will not be prompted with a security warning before executing it.

POC有效性分析：根据多个搜索结果和提供的POC代码，此漏洞的POC是有效的。该POC通过创建一个嵌套压缩文件，使得当用户使用存在漏洞的7-Zip版本解压该文件时，其中的恶意代码可以绕过Windows的安全机制（MOTW）执行。POC代码库中包含了相关的利用场景，进一步验证了此漏洞的可行性。

利用步骤：
1.  攻击者创建一个包含恶意可执行文件的嵌套压缩文件（例如，一个ZIP文件包含另一个ZIP文件，其中包含exe文件）。
2.  攻击者将该恶意压缩文件上传到互联网，并通过社交工程等手段诱骗用户下载。
3.  用户使用存在漏洞的7-Zip版本解压该文件。
4.  由于MOTW绕过，其中的恶意可执行文件在没有安全警告的情况下被执行，导致攻击者可以执行任意代码。

投毒风险分析：该POC的投毒风险为中等。虽然POC本身旨在演示漏洞，但攻击者可能修改POC以包含实际的恶意代码，并将其伪装成正常文件进行传播。此外，攻击者还可以利用此漏洞绕过安全检测机制，从而更容易地传播恶意软件。POC代码的投毒风险分析如下：POC代码中包含下载链接，可能存在被替换为恶意链接的风险；POC利用了7zip的压缩功能，可能存在被用于压缩恶意程序的风险；POC的代码较为清晰，主要使用标准库，没有明显的可疑行为，降低了直接投毒的风险。综合考虑，该POC的投毒风险为30%。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC/releases

**漏洞详情:** N/A
