## CVE-2025-0411 - 7-Zip MOTW Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW Bypass

**影响应用:** 7-Zip

**危害等级:** High

**CVSS评分:** N/A

**影响版本:** All versions before 24.09

**利用条件:** User interaction required (download and open a malicious archive). No authentication required.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2025-0411 is a high-risk vulnerability in 7-Zip that allows a remote attacker to bypass the Mark-of-the-Web (MOTW) security feature in Windows. This bypass enables the execution of arbitrary code without the usual security warnings presented to the user. The vulnerability stems from the improper handling of nested archive files with the MOTW flag. Specifically, when a user downloads a specially crafted archive and extracts its contents using a vulnerable version of 7-Zip, the files within the archive may not be properly flagged as originating from the internet. This lack of proper flagging allows executable files to run without the usual security prompts, potentially leading to the execution of malicious code. The provided Proof of Concept (POC) demonstrates the ease with which this vulnerability can be exploited. An attacker can create a double-compressed archive. The outer archive will have the Mark-of-the-Web (MOTW) flag, but the inner one, which contains the malicious executable, will not. When the user extracts the outer archive using a vulnerable 7-Zip version, the inner archive and its contents are extracted without the MOTW flag. This allows the malicious executable to run without the security prompt. The POC is considered effective as it directly demonstrates the bypass of the MOTW protection. To exploit this vulnerability, an attacker would first need to craft a malicious archive file. This archive would typically contain an executable file designed to perform malicious actions on the victim's system. The attacker would then need to distribute this malicious archive to potential victims. This could be done through various means, such as email attachments, malicious websites, or social engineering tactics. Once the victim downloads and extracts the archive using a vulnerable version of 7-Zip, the malicious executable would be executed without any security warnings, giving the attacker control over the victim's system. The successful exploitation of this vulnerability could lead to a variety of negative consequences, including malware infection, data theft, and system compromise.

The投毒风险分析: The provided POC, while demonstrating a vulnerability, presents a relatively low risk of direct poisoning. The primary risk stems from the potential for malicious actors to weaponize the exploit and distribute it in conjunction with actual malware. The provided POC code itself appears clean and does not contain any explicitly malicious instructions. It mainly consists of instructions and links on how to download the vulnerable software, and guidance on how to exploit the MOTW bypass. However, the inherent nature of the vulnerability – bypassing security mechanisms – makes it a valuable tool for attackers. The risk of poisoning primarily arises from the potential for threat actors to bundle the exploit with malicious payloads, creating seemingly benign archives that, when extracted, execute malicious code. The risk is estimated to be 10% because the code itself is clean, but the nature of the vulnerability allows for its misuse to spread malware. The updated versions of 7-Zip mitigate the vulnerability.

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC/releases

**漏洞详情:** N/A
