## CVE-2025-0411 - 7-Zip MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 用户下载并解压恶意构造的压缩包

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-0411是一个存在于7-Zip压缩软件中的高危漏洞，该漏洞允许攻击者绕过Windows的安全功能“网络标记”（Mark of the Web，简称MOTW）。MOTW是Windows操作系统用于标记从Internet下载的文件的一种安全机制，旨在提醒用户这些文件可能存在风险。通过绕过MOTW，攻击者可以使恶意文件在用户不知情的情况下执行，从而导致系统感染、数据泄露或其他安全问题。

POC有效性分析：
根据多个搜索结果和提供的POC代码，CVE-2025-0411的POC利用方式相对简单直接。攻击者首先需要创建一个包含恶意代码的可执行文件（如exe文件）。然后，使用受影响版本的7-Zip（24.09之前的版本）对该可执行文件进行两次压缩。当用户下载并解压这个双重压缩的文件时，Windows的MOTW机制会被绕过，导致系统不会显示安全警告，恶意代码得以执行。该POC的有效性已得到多个来源的证实，包括安全媒体的报道和漏洞公告。

利用步骤：
1. 准备恶意可执行文件（例如，包含反弹shell或下载恶意程序的exe文件）。
2. 使用7-Zip 24.09之前的版本，将恶意可执行文件压缩成一个zip或7z文件。
3. 再次使用7-Zip将第一次压缩得到的文件再次压缩。
4. 将最终的压缩文件分发给目标用户。
5. 诱骗用户下载并解压该文件。
6. 用户双击解压后的文件时，恶意代码将在没有安全警告的情况下执行。

投毒风险分析：
该POC的投毒风险较低。提供的POC代码主要用于演示MOTW绕过，本身不包含恶意代码或后门。然而，攻击者可能利用此漏洞传播恶意软件，因此存在间接的投毒风险。具体来说，攻击者可能会将POC代码与恶意payload结合，创建带有病毒或木马的压缩文件。此外，攻击者也可能创建虚假的POC，其中包含恶意脚本或链接，诱导用户下载并执行。由于该漏洞的利用依赖于用户手动解压和执行文件，因此，缓解投毒风险的关键在于提高用户的安全意识，教育用户避免下载和执行来源不明的文件。同时，企业应加强网络边界安全，防止恶意压缩文件进入内部网络。总体而言，CVE-2025-0411的直接投毒风险较低（约10%），但通过该漏洞传播恶意软件的间接风险需要引起重视。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-0411
