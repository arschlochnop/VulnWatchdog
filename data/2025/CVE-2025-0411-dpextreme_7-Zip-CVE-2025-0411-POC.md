## CVE-2025-0411 - 7-Zip MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 用户下载并执行恶意构造的压缩文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-0411是一个存在于7-Zip压缩软件中的高危漏洞，允许远程攻击者绕过Windows的Mark-of-the-Web (MOTW) 安全机制，从而在受影响的系统上执行任意代码。该漏洞存在于7-Zip处理嵌套压缩文件时，未能正确传递MOTW标志。攻击者可以利用该漏洞，通过精心构造的压缩文件，在用户不知情的情况下执行恶意代码。

POC有效性分析：
根据多个搜索结果和POC代码，可以确认CVE-2025-0411漏洞是真实存在的，并且可以被成功利用。POC代码提供了一个完整的利用场景，展示了如何通过双重压缩绕过MOTW保护。该POC质量较高，包含详细的说明文档和可执行的示例代码。用户可以通过下载POC代码，并在受控环境中进行测试，验证漏洞的有效性。根据POC的描述，只需要使用7-Zip的24.09之前的版本压缩两次包含恶意代码的文件，即可绕过MOTW。

利用步骤：
1. 攻击者创建一个包含恶意代码的可执行文件。
2. 攻击者使用7-Zip的24.09之前的版本，将可执行文件压缩成一个压缩文件（例如，zip文件）。
3. 攻击者再次使用7-Zip的24.09之前的版本，将步骤2中生成的压缩文件再次压缩成一个新的压缩文件。
4. 攻击者将最终生成的压缩文件通过网络（例如，电子邮件、恶意网站）传播给受害者。
5. 受害者下载并解压该压缩文件。
6. 受害者执行解压后的可执行文件，恶意代码将在受害者系统上执行。

投毒风险分析：
该POC的投毒风险较低，因为POC代码本身主要用于演示漏洞利用过程，并没有发现明显的恶意行为。该POC主要包含构建恶意压缩包的脚本以及说明文档，没有发现后门或者恶意代码注入的行为。但是，攻击者可能会在利用该漏洞传播恶意软件时，将恶意代码注入到压缩文件中，从而实现投毒攻击。另外，攻击者有可能通过修改POC代码，使其包含恶意功能，然后再将其发布到公共代码托管平台，诱导用户下载和使用，从而实现投毒攻击。经过分析，该POC使用了标准库，代码逻辑清晰，但考虑到该漏洞本身可用于传播恶意软件，故评定投毒风险为20%。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC/releases

**漏洞详情:** 待定
