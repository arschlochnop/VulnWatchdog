## CVE-2025-0411 - 7-Zip MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 需要用户下载并解压恶意构造的压缩文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-0411是一个存在于7-Zip压缩软件中的高危漏洞，允许攻击者绕过Windows的安全功能“网络标记”（Mark of the Web，MOTW）。该漏洞源于7-Zip在处理带有MOTW标志的恶意压缩包时存在缺陷，未能正确传递该标记给解压后的文件。攻击者可以利用此漏洞，通过精心构造的压缩文件，在用户不知情的情况下执行恶意代码。

**POC有效性分析：**
根据提供的POC代码仓库（7-Zip-CVE-2025-0411-POC），该POC旨在演示CVE-2025-0411漏洞，通过构造特定的压缩文件，绕过Windows的MOTW安全机制。POC代码仓库包含了一个README文件，其中详细描述了漏洞信息、利用方法和潜在风险。该POC的有效性在于它能够成功地绕过MOTW，使得解压后的文件在没有安全警告的情况下执行。由于POC已经提供了一个可下载的压缩文件，用户只需下载并解压该文件即可复现该漏洞，从而验证其有效性。POC的质量评分为8/10，因为它提供了完整的利用链，并且有详细的文档说明，但是可能需要用户根据自己的环境进行一些配置才能成功复现。

**利用步骤：**
1. 攻击者创建一个包含恶意代码的可执行文件（例如exe文件）。
2. 攻击者将该可执行文件压缩成zip或其他7-Zip支持的压缩格式。
3. 攻击者修改压缩文件，使其包含MOTW标记。
4. 攻击者将恶意压缩文件上传到互联网，并通过社交媒体、电子邮件或其他方式诱骗用户下载。
5. 用户使用存在漏洞的7-Zip版本（24.09之前）解压该压缩文件。
6. 由于漏洞的存在，解压后的可执行文件不会被标记为来自互联网，用户双击运行该文件时，不会收到安全警告。
7. 恶意代码在用户计算机上执行，攻击者可以远程控制用户计算机，窃取敏感信息或进行其他恶意活动。

**投毒风险分析：**
该POC的投毒风险为30%。虽然该POC主要用于演示漏洞，但攻击者可能利用该POC进行恶意活动，例如：
1. 在POC中添加额外的恶意代码，例如后门程序、键盘记录器等。
2. 将POC与社会工程学攻击相结合，诱骗用户下载并运行恶意压缩文件。
3. 利用POC传播勒索软件。

尽管POC本身可能不包含明显的恶意代码，但其绕过安全机制的特性使得它成为恶意攻击者的有效工具。攻击者可以将恶意payload嵌入到利用此漏洞的压缩文件中，并利用社会工程学技巧诱骗用户运行。由于7-Zip是一款流行的压缩软件，用户对其解压的文件通常信任度较高，这进一步增加了投毒的风险。此外，攻击者还可能修改POC代码，使其在受害者不知情的情况下执行额外的恶意操作，例如收集系统信息、下载其他恶意文件等。因此，尽管该POC的初始风险较低，但潜在的危害性不容忽视。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC/releases

**漏洞详情:** 待定
