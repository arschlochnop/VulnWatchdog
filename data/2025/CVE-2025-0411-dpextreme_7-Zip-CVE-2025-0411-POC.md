## CVE-2025-0411 - 7-Zip MOTW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MOTW绕过

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 用户下载并执行恶意构造的压缩文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-0411是一个存在于7-Zip压缩软件中的高危漏洞，允许远程攻击者绕过Windows的Mark-of-the-Web（MOTW）安全机制，从而在受影响的系统上执行任意代码。该漏洞源于7-Zip在处理嵌套压缩文件时未能正确传递MOTW标志。当用户下载并解压恶意构造的压缩文件时，其中的可执行文件可能在没有安全警告的情况下运行，从而允许攻击者执行恶意代码。POC代码已经公开，其中包含利用此漏洞的示例。攻击者可以通过创建特制的压缩文件，诱骗用户下载并执行，从而绕过Windows的安全警告，最终执行恶意代码。

POC有效性分析：根据已公开的POC代码和相关分析报告，该漏洞利用方式相对简单，通过双重压缩即可绕过MOTW。POC代码质量较高，提供了完整的利用示例，可以快速复现该漏洞。该漏洞影响广泛，7-Zip是一款流行的压缩软件，用户群体庞大，因此该漏洞的潜在危害较高。利用步骤：
1. 准备一个恶意可执行文件。
2. 使用受影响的7-Zip版本（24.09之前）将该可执行文件压缩一次。
3. 再次使用7-Zip将第一次压缩后的文件再次压缩。
4. 将最终的压缩文件分发给目标用户。
5. 目标用户下载并解压该压缩文件后，其中的可执行文件将在没有安全警告的情况下运行。

投毒风险分析：该POC的投毒风险较低，主要风险点在于利用压缩文件传播恶意可执行文件。攻击者可能在压缩文件中嵌入恶意软件，诱骗用户执行。此外，攻击者可能利用该漏洞进行网络钓鱼攻击，例如通过电子邮件发送包含恶意压缩文件的链接，诱骗用户下载并执行。由于POC代码本身仅包含漏洞利用的示例，不包含恶意代码，因此投毒风险相对较低。但是，攻击者可能修改POC代码，添加恶意功能，从而提高投毒风险。此外，攻击者可能利用社会工程学技巧，诱骗用户关闭安全警告或禁用安全软件，从而提高攻击成功率。综上所述，该漏洞的投毒风险为15%，主要风险在于恶意软件传播和网络钓鱼攻击。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC/releases

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-0411
