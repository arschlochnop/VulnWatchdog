## CVE-2025-0411-7-Zip-MotW绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** MotW绕过

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致任意代码执行

**影响版本:** <= 24.08 (受影响版本范围需进一步验证)

**利用条件:** 用户需要下载并解压恶意构造的压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0411是一个存在于7-Zip中的Mark-of-the-Web (MotW) 绕过漏洞。当7-Zip解压从网络下载的，带有MotW标记的压缩文件时，它未能将该标记传播到解压后的文件。这意味着攻击者可以创建一个恶意压缩文件，其中包含可执行文件或其他恶意内容。当用户使用7-Zip解压该压缩文件时，Windows不会将解压后的文件视为来自网络，从而绕过了安全警告和保护机制。攻击者可以利用此漏洞在用户不知情的情况下执行任意代码。

**有效性：**
根据搜索结果和POC代码，此漏洞是有效的。多个来源（包括启明星辰VSRC、腾讯云开发者社区、CSDN博客等）都确认了CVE-2025-0411的存在，并提供了漏洞描述和复现方法。POC代码仓库也提供了相关的POC场景。

**投毒风险：**
POC代码本身是一个README.md文件，用于介绍该漏洞的POC，并提供了一个指向Releases页面的链接。这个链接以及整个github仓库本身可能存在风险，用户下载Releases中的文件后，如果Releases文件本身就是恶意构造的，那么可能存在投毒风险。因为缺乏对Releases中文件的分析，这里假设存在10%的投毒风险。

**利用方式：**
1.  攻击者创建一个恶意压缩文件，其中包含可执行文件或其他恶意内容。
2.  攻击者将该压缩文件托管在网络上，并诱导用户下载。
3.  用户使用受影响版本的7-Zip解压该压缩文件。
4.  7-Zip未能将MotW标记传播到解压后的文件。
5.  用户运行解压后的恶意文件，导致任意代码执行。

**项目地址:** [dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)