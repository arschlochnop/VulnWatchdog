## CVE-2025-0411 - 7-Zip RCE(Remote Code Execution)/MOTW Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** RCE(Remote Code Execution)/MOTW Bypass

**影响应用:** 7-Zip

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 24.09之前版本

**利用条件:** 用户下载并执行恶意构造的压缩文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-0411是7-Zip压缩软件中的一个高危漏洞，允许远程攻击者绕过Windows的Mark-of-the-Web (MOTW) 安全机制，从而在受影响的系统上执行任意代码。该漏洞存在于7-Zip处理嵌套压缩文件时未能正确传递MOTW标志。攻击者可以利用此漏洞构造特制的压缩包，当用户下载并解压该压缩包时，其中的恶意代码可以在没有安全警告的情况下执行，从而绕过Windows的安全保护措施。

POC有效性分析：
根据搜索结果和POC代码，该漏洞的利用方式相对简单。攻击者只需要使用受影响的7-Zip版本（24.09之前）对恶意文件进行两次压缩，即可生成绕过MOTW的压缩包。用户下载并解压该压缩包后，恶意代码就会在没有安全警告的情况下执行。POC代码库中提供了利用该漏洞的示例，用户可以下载并运行这些示例来验证漏洞的存在和利用方式。这些POC通常包含一个恶意payload，例如一个简单的可执行文件，当用户解压该压缩包时，该可执行文件就会被执行，从而证明漏洞的存在。

利用步骤：
1. 攻击者构造一个包含恶意代码的可执行文件。
2. 攻击者使用7-Zip 24.09之前的版本，将该可执行文件压缩成一个压缩包（例如zip或7z）。
3. 攻击者再次使用7-Zip 24.09之前的版本，将第一次生成的压缩包再次压缩成另一个压缩包。
4. 攻击者将最终生成的压缩包上传到恶意网站或通过电子邮件发送给受害者。
5. 受害者下载并解压该压缩包。
6. 由于MOTW标志被绕过，Windows不会显示安全警告，恶意代码将在受害者的计算机上执行。

投毒风险分析：
该POC的投毒风险较低。POC代码主要用于演示漏洞的存在和利用方式，不包含恶意行为或后门代码。代码库中提供的示例通常只包含简单的可执行文件，例如显示一个消息框或创建一个文件，以证明漏洞的存在。但是，攻击者可以利用该漏洞传播恶意软件，例如勒索软件、木马病毒等。为了降低投毒风险，用户应该从官方网站或可信来源下载7-Zip，并及时更新到最新版本。此外，用户还应该谨慎处理来自未知来源的压缩包，避免下载和解压恶意文件。

具体来说，POC本身的代码是清晰的，主要依赖标准库，没有发现可疑行为。但是，利用该漏洞传播的压缩包可能包含恶意代码，例如经过混淆的恶意脚本或可执行文件，这些恶意代码可能会执行危险操作，例如窃取用户数据、安装后门程序等。因此，在测试和使用POC时，务必在一个安全、隔离的环境中进行，避免对实际系统造成损害。

**项目地址:** https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC

**漏洞详情:** 待定
