## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H

**影响版本:** 19.0.0, 19.1.0, 19.1.1, and 19.2.0 (react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack)

**利用条件:** Unauthenticated network access to RSC "Server Function" endpoint

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 40%

## 详情

CVE-2025-55182是React Server Components (RSC)中存在的一个严重远程代码执行(RCE)漏洞。该漏洞源于`react-server-dom-*`包中`requireModule`函数的不安全属性访问。攻击者可以通过构造恶意请求，将`metadata[NAME]`设置为`"constructor"`，从而访问JavaScript的`Function`构造函数。利用`Function`构造函数，攻击者可以动态地创建并执行任意JavaScript代码，最终导致服务器上的RCE。根据POC描述，攻击流程如下：首先，攻击者利用`$@x`构造Chunk对象引用。然后，利用`$f`和`$不定`构建对象，并将`metadata[NAME]`设置为`constructor`。接着，通过Flight协议将恶意数据发送到服务器。服务器在处理Flight数据时，会调用存在漏洞的`requireModule`函数，从而触发RCE。POC代码展示了完整的攻击过程，包括构造恶意Flight数据和发送HTTP请求。漏洞利用的关键在于利用JavaScript原型链的特性，通过访问`constructor`属性来获取`Function`构造函数，进而执行任意代码。 

利用步骤如下：
1.  构造包含恶意数据的Flight请求。
2.  将请求发送到受影响的RSC Server Function endpoint。
3.  服务器处理请求时，`requireModule`函数会被调用。
4.  攻击者利用`constructor`属性获取`Function`构造函数。
5.  执行任意JavaScript代码，实现RCE。

投毒风险分析：该POC的投毒风险评估为中等。虽然POC代码本身没有明显的恶意行为，但攻击者可以利用该漏洞在服务器上执行任意代码，包括下载和执行恶意脚本、安装后门程序等。此外，POC中使用了`Function`构造函数，这可能会被安全工具标记为可疑行为。攻击者可能会尝试混淆POC代码，以逃避安全检测。由于攻击者可以完全控制服务器的执行环境，因此存在较高的投毒风险。例如，攻击者可以将恶意代码注入到服务器的启动脚本中，或者替换服务器上的关键组件。考虑到POC的完整性和潜在的危害性，建议用户尽快采取措施修复该漏洞，并加强服务器的安全防护。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
