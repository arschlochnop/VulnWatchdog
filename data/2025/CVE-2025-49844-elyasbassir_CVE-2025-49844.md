## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis < 8.2.2

**利用条件:** 需要经过身份验证的用户权限(低权限及以上)，具备执行Lua脚本的权限(EVAL命令)

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

【POC有效性分析】该漏洞源于Redis Lua脚本引擎在处理脚本名（chunk name）时的内存管理缺陷。具体而言，在调用loadstring函数解析Lua代码时，如果强制触发垃圾回收（GC），可能会导致解析器持有的内存地址被释放后重新使用（Use-After-Free）。提供的Lua代码通过创建带有__gc元方法的proxy对象，并强行调用collectgarbage('collect')，试图在解析过程中使内存布局失效。代码中的循环迭代和内存填充逻辑是为了增加竞争条件的触发概率，使堆内存处于不稳定状态。经过分析，该POC逻辑符合CVE-2025-49844的原理，能够导致Redis进程崩溃或在特定内存布局下实现指令重定向，具备较高的验证价值。利用步骤如下：1. 攻击者获取Redis实例的认证访问权限；2. 构造包含垃圾回收触发逻辑的恶意Lua脚本；3. 通过redis-cli使用--eval参数反复执行该脚本；4. 监测Redis进程状态，若成功触发UAF，服务将崩溃或执行注入的shellcode。由于该漏洞在解析阶段触发，且受影响版本广泛，其危害极高。

【投毒风险分析】该POC项目存在明显的中等投毒风险。首先，README文件使用了非英语（波斯语）编写，这种异常的语言分布常出现在通过翻译工具伪装的恶意仓库中。其次，README中包含的执行建议涉及将流量指向'localhost'的无限循环脚本，虽然这看起来是本地测试，但其诱导用户使用product:"Redis key-value store"在Shodan上搜索目标的行为，具有明显的非法利用引导倾向。最关键的是，该仓库的README描述中提到了‘连接到服务器 :) RCE’等带有煽动性的字眼，且其提供的POC执行方式可能隐藏了恶意混淆逻辑。在提供的.lua代码片段中，虽然核心逻辑是针对UAF的测试，但考虑到此类披露往往伴随着自动化投毒脚本（如在执行exp时反弹shell到第三方服务器），防御者必须在隔离沙箱中运行此类POC。此外，仓库中提到的README.MD包含对非受控外部IP的潜在连接指引，这符合典型‘漏洞利用工具投毒’的特征，即利用安全研究人员急于复现漏洞的心理，诱导其运行带有后门的验证脚本。建议在分析时仅参考Lua脚本核心逻辑，严禁直接运行仓库内的shell脚本或二进制文件。

**项目地址:** n/a (基于提供的临时路径分析)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
