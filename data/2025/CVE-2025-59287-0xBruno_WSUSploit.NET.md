## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2025, Windows Server 2022, Windows Server 2019 (包括Server Core installation)

**利用条件:** 无需认证、远程网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-59287是Microsoft Windows Server Update Services (WSUS) 组件中一个被公开披露的高危远程代码执行（RCE）漏洞。该漏洞的根本原因在于WSUS服务端存在不安全的反序列化设计缺陷。未经身份验证的远程攻击者可以通过发送特制的事件，利用传统序列化机制中不安全的对象反序列化，从而在目标服务器上实现远程代码执行，获得完全控制权限。该漏洞被赋予CVSS 9.8的严重评级。

**受影响版本:**
目前受影响的Windows Server版本包括Windows Server 2025（包括Server Core安装）、Windows Server 2022和Windows Server 2019。

**利用条件:**
该漏洞利用条件极为宽松，攻击者无需获取任何身份凭证即可通过网络远程触发漏洞，属于未经身份验证的远程代码执行。

**POC有效性分析:**
所提供的POC代码是一个名为`WSUSploit.NET`的C#程序，旨在完整利用CVE-2025-59287漏洞。该POC的核心在于利用.NET的`BinaryFormatter`进行不安全的反序列化。攻击流程首先通过`WSUSServer`类与目标WSUS服务器建立连接，获取必要的服务器ID和会话Cookie（非认证凭证，而是通信所需的上下文信息），为后续的恶意请求做准备。随后，`Sploit`类负责生成恶意载荷。该载荷的核心是一个精心构造的XAML字符串，其内部使用了`ObjectDataProvider`，并将其`ObjectInstance`设置为`System.Diagnostics.Process`，通过调用`Start`方法，并传入攻击者指定的命令，实现任意命令执行。为了将这个XAML字符串注入到反序列化过程中，POC设计了一个`TextFormattingRunPropertiesMock`类。这个Mock类实现了`ISerializable`接口，并在`GetObjectData`方法中，巧妙地将序列化类型信息伪造成WSUS组件可能合法处理的`Microsoft.VisualStudio.Text.Formatting.TextFormattingRunProperties`类型，并将其`ForegroundBrush`属性设置为恶意的XAML载荷。最后，`BinaryFormatter`将这个封装了恶意XAML的Mock对象序列化成二进制数据，并通过`server.SendMaliciousEvent`方法发送给目标WSUS服务器。当WSUS服务器尝试反序列化这个特制的二进制数据时，由于不安全的配置或逻辑，它会错误地解释并执行嵌入的XAML载荷，最终导致命令执行。该POC代码结构清晰，逻辑完整，直接实现了漏洞利用链，具有极高的有效性。

**利用步骤:**
1.  确保系统安装了.NET开发环境。
2.  下载或编译`WSUSploit.NET`项目。
3.  在命令行中执行POC：`WSUSploit.NET <WSUS服务器URL> <待执行的命令>`。
    例如：`WSUSploit.NET https://wsus.example.com "notepad.exe"`
4.  POC将连接到目标WSUS服务器，发送特制的反序列化载荷，从而在WSUS服务器上远程执行指定的命令。

**投毒风险分析:**
对`WSUSploit.NET`的POC代码进行分析后，评估其投毒风险为低（5%）。代码以C#编写，结构清晰，所有依赖均为标准.NET库（如`System.Text`, `System.Net.Http`, `System.IO`, `System.Runtime.Serialization`等），未发现使用任何非标准或可疑的外部库。Payload的构建（XAML结合`ObjectDataProvider`和`System.Diagnostics.Process.Start`）是典型的.NET反序列化漏洞利用技术，旨在执行用户指定的命令，并非POC作者植入恶意代码。代码中没有出现混淆、加密、连接未知服务器、下载外部脚本或进行其他可疑文件操作的行为。其核心功能完全围绕漏洞的复现和利用展开。因此，该POC代码是合法的防御性安全研究工具，专注于展示和利用WSUS中的RCE漏洞，不包含恶意投毒组件。研究人员可以安全地审查和使用此代码进行测试和防御体系构建。

**项目地址:** 

**漏洞详情:** 
