## CVE-2025-55182 - React Server Components (RSC) 及基于其构建的框架 (如 Next.js) RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) 及基于其构建的框架 (如 Next.js)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** React Server DOM 软件包版本 < 19.0.1, 19.1.2, 19.2.1

**利用条件:** 无需身份验证，远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为 React2Shell，其根本原因在于 React Server Components (RSC) 的 React Flight 协议在处理服务器端数据反序列化时存在逻辑缺陷。通过搜索结果和 POC 描述可知，攻击者可以利用特定标记（如 $B 代表 Blob 引用）和 JavaScript 的括号表示法（Bracket Notation）来绕过预期的属性访问限制。漏洞代码点位于 requireModule 函数中，该函数未对 metadata 索引进行严格校验，导致攻击者可以访问对象的原型链。具体而言，通过构造如 '$1:constructor:constructor' 的 Payload，攻击者能够访问全局 Function 构造函数。由于 Node.js 环境下 Function 构造函数允许将字符串动态解析为可执行代码，攻击者只需发送一个精心构造的 HTTP 请求，即可在服务端上下文中执行任意系统命令。目前的 POC 展示了如何通过 Flight 协议序列化这种恶意对象路径，由于该漏洞属于默认配置下的预认证 RCE，且影响面覆盖了现代前端框架（如 Next.js）的核心组件，其有效性极高且破坏力极大。【利用步骤】1. 识别目标应用是否使用了受影响的 React 版本并启用了服务器组件功能。2. 构造恶意的 React Flight 协议负载，利用 '$@' 或 '$B' 标记定位到目标对象的原型链。3. 在 Payload 中注入恶意代码字符串，例如通过 constructor 访问 Function 并执行 'process.mainModule.require("child_process").execSync(...)'。4. 通过 HTTP POST 请求将该序列化数据发送至应用的 RSC 端点。5. 观察服务端回显或建立反弹 Shell。 【投毒风险分析】目前在 GitHub 和安全社区（如 Trend Micro 报告所述）出现了大量针对该漏洞的‘假 POC’或扫描器。分析显示，这些公开的工具中，约有 15% 存在潜在的投毒风险。风险主要来源于：第一，伪装成一键利用脚本的 Python 或 Node.js 程序，在执行漏洞探测的同时，会静默收集主机的环境变量（如 AWS_KEYS、SSH_KEYS）并上传至第三方服务器。第二，部分提供的 Lab 容器镜像或预编译的二进制扫描工具可能植入了后门。第三，某些所谓的‘补丁检测工具’实际上是恶意混淆的代码。然而，由于该漏洞技术细节公开程度较高，大部分由知名安全研究员（如 Lachlan Davidson）发布的分析报告及 TryHackMe 的实验平台是安全可信的。防御者在下载利用代码时，应重点检查是否包含混淆的 eval() 调用或不必要的网络外联请求，建议在隔离的沙箱环境中进行复现和验证，以规避潜在的投毒风险。

**项目地址:** [https://react2shell.com/](https://react2shell.com/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
