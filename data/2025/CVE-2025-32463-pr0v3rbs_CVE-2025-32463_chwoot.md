## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地普通用户访问权限，目标系统安装了受影响版本的Sudo且支持-R (chroot) 选项。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为'chwoot'，其核心在于Sudo在处理-R或--chroot选项时存在逻辑缺陷。当用户执行带有chroot选项的sudo命令时，Sudo本应在受限环境中执行命令，但由于它错误地使用了用户可控目录下的/etc/nsswitch.conf文件，导致攻击者可以通过构建特定的目录结构并伪造该配置文件，诱导Sudo动态加载位于用户目录下的恶意共享库（通过NSS机制）。在POC代码中，通过Dockerfile构建了一个包含漏洞版本sudo 1.9.16p2的Ubuntu环境，并配合名为sudo-chwoot.sh的脚本自动化完成攻击流程。该POC完整展示了从普通用户权限获取root Shell的过程，通过模拟攻击者控制的chroot目录，成功触发了glibc的NSS库加载机制。利用步骤：1. 在本地创建一个由普通用户完全控制的目录作为伪造的chroot根目录。2. 在该目录下创建/etc/nsswitch.conf并指向恶意库，同时在对应路径放置编译好的恶意.so文件。3. 执行'sudo -R [伪造目录] [命令]'。4. 此时Sudo会以root权限加载并执行伪造目录下的恶意代码，从而实现提权。投毒风险分析：该POC代码逻辑清晰，主要由Dockerfile和Bash脚本组成。Dockerfile使用的是官方Ubuntu镜像作为基础镜像，安装的依赖包均为标准安全库（如libpam0g-dev, libssl-dev等），没有发现从不明第三方源下载二进制文件的行为。Bash脚本逻辑主要是文件系统的创建和Sudo命令的调用，具有较高的透明度。虽然攻击者可能会利用此类POC模板进行二次封装，并在恶意库（.so文件）编译阶段植入反弹Shell或木马，但在当前提供的POC源代码中，并未发现明显的恶意混淆、未授权的外部网络请求或隐藏的二进制Payload。整体而言，该代码库属于安全研究性质的公开验证工具。防御建议：组织应立即将Sudo升级至1.9.17p1或更高版本。如果无法立即升级，可以通过权限控制手段禁用普通用户的sudo -R选项，或利用Linux Audit系统监控sudo带有-R参数的异常调用行为。

**项目地址:** [https://github.com/pr0v3rbs/CVE-2025-32463_chwoot](https://github.com/pr0v3rbs/CVE-2025-32463_chwoot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
