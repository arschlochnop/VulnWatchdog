## CVE-2025-32463 - Sudo 本地权限提升 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Local Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Sudo 1.9.14 至 1.9.17 (包括所有p修订版)

**利用条件:** 需要本地访问权限，攻击者可为非sudoer组用户

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是Linux Sudo组件中的一个高危本地权限提升漏洞，也被称为“chwoot”漏洞。该漏洞存在于Sudo的`--chroot`（或`-R`）选项中，影响Sudo 1.9.14到1.9.17版本。漏洞根源在于Sudo在执行`chroot`功能时，不当地处理了用户控制的`chroot`目录中的`/etc/nsswitch.conf`文件。攻击者可以利用这一缺陷，通过构造一个恶意的`chroot`环境，在该环境中放置一个特制的`nsswitch.conf`文件，使其指向一个恶意的动态链接库（例如`libnss_alt.so.2`）。当Sudo以`root`权限在`chroot`环境中尝试解析用户或组信息时，会加载并执行这个恶意库，从而在`root`权限下执行任意代码，最终实现本地权限提升。

**POC有效性分析**：
提供的POC项目包含一个`Dockerfile`、一个`sudo-chwoot.sh`利用脚本以及一个`run.sh`辅助脚本。`Dockerfile`负责构建一个Ubuntu 24.04的Docker镜像，并在其中编译安装了易受攻击的Sudo 1.9.16p2版本，同时创建了一个普通用户`pwn`。`sudo-chwoot.sh`脚本是核心利用部分，它会在`pwn`用户的家目录下创建一个临时目录作为恶意`chroot`环境，并在此环境中生成一个恶意的`nsswitch.conf`文件和一个恶意的C语言共享库。这个共享库经过编译后，会在被`sudo`加载时自动执行`execve("/bin/sh", NULL, NULL)`命令，从而弹出一个`root` shell。整个POC流程清晰，从环境搭建到漏洞触发和权限获取都自动化完成，且在Docker隔离环境中验证了其有效性。根据README和代码分析，该POC能够成功复现并利用CVE-2025-32463漏洞，获取root权限，因此其功能完整且质量极高。

**利用步骤**：
1.  通过`git clone https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git`克隆POC仓库。
2.  进入克隆的目录：`cd CVE-2025-32463_chwoot`。
3.  运行`run.sh`脚本来构建Docker镜像并启动容器：`sudo ./run.sh`。
4.  在启动的Docker容器内部，以`pwn`用户身份执行漏洞利用脚本：`./sudo-chwoot.sh`。
5.  成功利用后，当前用户将获得一个`root`权限的shell。

**投毒风险分析**：
对提供的POC代码（`Dockerfile`和`sudo-chwoot.sh`）进行了详细审查，以评估潜在的投毒风险。
`Dockerfile`的主要作用是搭建一个包含特定Sudo易受攻击版本的Ubuntu环境。它通过`apt-get`安装必要的构建工具和依赖项，然后从官方源（www.sudo.ws）下载Sudo的1.9.16p2版本源码并编译安装。这些步骤都是为了创建受控的漏洞复现环境，没有发现任何引入恶意代码、外部非官方源下载或进行异常系统配置的行为。
`sudo-chwoot.sh`是实际的利用脚本。它在本地文件系统上构建了一个恶意的`chroot`环境，包括一个特制的`/etc/nsswitch.conf`文件和一个恶意加载的共享库（通过C代码编译）。恶意共享库的功能仅限于执行`/bin/sh`以获取`root` shell，这是漏洞利用的核心 payload。脚本中没有发现任何试图进行外部网络通信、窃取敏感数据、下载其他恶意二进制文件、创建持久化后门或对宿主机系统造成破坏性修改的行为。所有操作都局限在`chroot`环境或临时文件中，并在成功获取`root` shell后结束。代码逻辑清晰，没有使用代码混淆或加密技术来隐藏恶意意图。综合来看，该POC代码是一个标准、专业的漏洞利用演示，不包含额外的恶意投毒行为，投毒风险极低。

**项目地址:** https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
