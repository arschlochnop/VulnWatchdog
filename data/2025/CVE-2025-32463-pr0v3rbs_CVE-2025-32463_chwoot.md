## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 攻击者需拥有目标系统的本地普通用户访问权限，且系统安装了受影响版本的sudo工具。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC（名为sudo-chwoot）展现了极高的有效性与复现参考价值。其核心逻辑聚焦于sudo在1.9.14版本引入的新特性：-R（--chroot）选项。该选项允许sudo在执行命令前先进入指定的chroot环境。漏洞的根源在于sudo在执行chroot后，未正确隔离或重置对非信任目录下配置文件的依赖。具体而言，当执行带有-R参数的命令时，sudo会尝试加载chroot目录下的/etc/nsswitch.conf文件。通过在受控目录下构造恶意的nsswitch.conf并放置伪造的共享库（如libnss_xxx.so.2），攻击者可以诱导sudo在root上下文中加载并执行攻击者定义的恶意库文件，从而实现从普通用户到root权限的直接跃迁。POC中提供的Dockerfile完整构建了漏洞环境（Ubuntu 24.04 + sudo 1.9.16p2），并通过sudo-chwoot.sh脚本自动化完成了恶意目录结构的创建、恶意库的编译以及触发提权的步骤，经分析其逻辑闭环，复现成功率极高。【利用步骤】1. 环境准备：部署受影响版本的sudo（如1.9.16p2）。2. 构造陷阱：在用户可控目录下（如/home/pwn/woot）创建伪造的根目录结构。3. 配置文件注入：在伪造目录的etc下写入恶意的nsswitch.conf，配置特定的名称解析服务指向恶意库。4. 恶意库放置：编译一个执行提权操作（如设置/bin/bash为SUID或执行反弹shell）的.so库文件，并放置在伪造目录的lib下。5. 触发漏洞：执行命令 sudo -R /home/pwn/woot /bin/sh。此时sudo会切换根目录到该位置并加载恶意库，由于sudo进程具有root权限，加载的库代码将以最高权限执行。【投毒风险分析】该POC项目结构透明，代码行为符合安全研究的预期。主要的Dockerfile和Shell脚本均公开展示了其操作流程。经过对代码的深度扫描，未发现明显的恶意混淆代码、未经授权的网络外连请求或针对主机系统的持久化后门植入行为。项目包含的编译指令均指向标准的系统库和sudo官方源码包。唯一的潜在风险在于攻击者可能利用此类公开POC脚本进行简单的修改，在提权成功后加入自动化的横向移动或信息窃取逻辑。但在目前公开的仓库版本中，其脚本主要用于创建临时测试环境及提权演示，属于低风险等级。由于其主要操作集中在Docker容器内部，对宿主机的直接威胁较小。建议安全从业者在测试时，始终坚持在隔离的虚拟机或容器环境中运行，并仔细核对脚本中每个rm或chmod指令的目标路径，防止误操作导致测试环境之外的系统受损。

**项目地址:** [https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git](https://github.com/pr0v3rbs/CVE-2025-32463_chwoot.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
