## CVE-2025-66478 - Next.js RCE

**漏洞编号:** CVE-2025-66478

**漏洞类型:** RCE

**影响应用:** Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Next.js 15.0.0 - 15.0.4, Next.js 15.1.0 - 15.1.8, Next.js 15.2.0 - 15.2.5, Next.js 15.3.0 - 15.3.5, Next.js 15.4.0 - 15.4.7, Next.js 15.5.0 - 15.5.6, Next.js 16.0.0 - 16.0.6, Next.js 14.3.0-canary.77+

**利用条件:** 需要网络访问，利用React Server Components (RSC)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-66478 是一个存在于 Next.js 应用中的远程代码执行漏洞，该漏洞利用了 React Server Components (RSC)。

POC有效性分析：
POC代码“React2Shell Ultimate”是一个用于扫描和利用 CVE-2025-66478 漏洞的工具。该工具提供了多种模式，包括安全模式（side-channel）、RCE模式（PoC）和本地模式。它还包括绕过 WAF 和 Vercel 的选项，以及 Unicode 支持。该工具支持的 Next.js 版本包括 15.0.0 到 16.0.6 的多个版本，以及 14.3.0-canary.77+。根据POC的描述，这是一个相当完善的利用工具，具有较高的成功率，且提供了多种规避检测的方法。该POC的README文档清晰地描述了漏洞的细节、影响版本和使用方法，使得安全研究人员能够快速理解和复现该漏洞。

利用步骤：
1. 确定目标 Next.js 应用程序是否使用了 React Server Components (RSC)。
2. 确定目标应用程序的 Next.js 版本是否在受影响的版本范围内。
3. 使用 React2Shell Ultimate 工具，选择合适的模式（例如，--rce）来利用该漏洞。
4. 根据需要，使用 WAF 绕过选项（例如，--waf-bypass 或 --vercel-bypass）来绕过安全防护。
5. 执行 POC，成功后可以在目标服务器上执行任意代码。

投毒风险分析：
该POC工具主要由Python代码编写，使用了标准库，代码结构清晰。虽然POC本身是为了验证和利用漏洞，但是攻击者可能会修改该工具，添加恶意功能，例如：植入后门、窃取敏感数据或进行其他恶意活动。该POC涉及网络请求，攻击者可能会修改请求内容，例如：发送包含恶意代码的请求，从而在服务器端执行恶意操作。但是，该POC代码没有发现明显的恶意行为或代码混淆，因此投毒风险较低。综合来看，投毒风险较低，估计在15%左右。攻击者需要具备一定的技术能力才能修改和利用该工具，因此实际的投毒风险取决于攻击者的能力和动机。

总结：该漏洞的危害性极高，CVSS评分为10.0。通过精心构造的请求，攻击者可以远程执行服务器代码，严重威胁服务器安全。考虑到该漏洞的严重性和利用的简易性，建议相关组织立即采取措施，升级Next.js版本或采取其他缓解措施。

**项目地址:** https://github.com/hackersatyamrastogi

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
