# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

# CVE-2025-29927

> ğŸ“¦ è¯¥CVEæœ‰ **117** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2025-29927-0x0Luk_0xMiddleware.md](../2025/CVE-2025-29927-0x0Luk_0xMiddleware.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä¾‹å¦‚èº«ä»½éªŒè¯ã€‚ 

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ï¼ŒCVSSè¯„åˆ†é«˜è¾¾9.1ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆRapid7, Picus Security, JFrog, Truesec, Zscaler, Akamaiç­‰ï¼‰éƒ½å‘å¸ƒäº†å…³äºæ­¤æ¼æ´çš„åˆ†æå’Œç¼“è§£æªæ–½ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœæ­£å¸¸è¯·æ±‚è¿”å› 403 çŠ¶æ€ç ï¼Œè€Œå¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹äº†æä¾›çš„ exploit ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ HTTP è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ç»•è¿‡æ¼æ´ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚å›è¿æ¶æ„æœåŠ¡å™¨ï¼Œä¸Šä¼ æ¶æ„æ–‡ä»¶ï¼Œæˆ–è€…åˆ é™¤æ•°æ®ç­‰ã€‚ThreadPoolExecutorå¤šçº¿ç¨‹æé«˜æ‰«æé€Ÿåº¦ï¼Œç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œä½¿ç”¨è€…ä»éœ€æ³¨æ„ï¼Œæœªç»æˆæƒçš„æ¼æ´æ‰«æå’Œåˆ©ç”¨è¡Œä¸ºå¯èƒ½è§¦çŠ¯æ³•å¾‹ã€‚å­˜åœ¨çš„é£é™©ç‚¹æ˜¯,åœ¨æ‰«æä¹‹å‰è¢«ç¯¡æ”¹äº†ï¼Œæ·»åŠ äº†æ¶æ„ä»£ç ï¼Œæˆ–è€…æ‰«æç›®æ ‡æœ¬èº«å°±è¢«æŠ•æ¯’äº†ã€‚å› æ­¤ï¼Œ**æŠ•æ¯’çš„å¯èƒ½æ€§è¯„ä¼°ä¸º10%**ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡åº”ç”¨æ˜¯å¦ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶å°†è¯¥è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚
4.  æ¼æ´åˆ©ç”¨ä»£ç é€šè¿‡éå†ä¸åŒçš„ `x-middleware-subrequest` çš„ payloadï¼Œå¹¶æ¯”è¾ƒæ­£å¸¸è¯·æ±‚å’Œæ¶æ„è¯·æ±‚çš„å“åº”ï¼Œæ¥æ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**é¡¹ç›®åœ°å€:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #2

**æ¥æº**: [CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md](../2025/CVE-2025-29927-0xPThree_next.js_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦éƒ¨ç½²å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œä¸”åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»…åŒ…å«README.mdæ–‡ä»¶ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ä»¥ç¡®è®¤åˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ„é€ è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ç”±äºæä¾›çš„POCä»£ç ä»…åŒ…å«README.mdï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œæœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥è¯„ä¼°ã€‚ä½†æ˜¯ï¼Œæ ¹æ®æœç´¢ç»“æœä¸­çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«å¹¿æ³›è®¨è®ºï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„æ”»å‡»æ–¹æ³•ã€‚å…³äºæŠ•æ¯’é£é™©ï¼Œç”±äºæä¾›çš„POCéå¸¸ç®€å•ï¼Œä»…åŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œå› æ­¤å­˜åœ¨ä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä¼°è®¡çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç†è§£ä¸­é—´ä»¶æˆæƒé€»è¾‘ï¼š** æ”»å‡»è€…éœ€è¦åˆ†æç›®æ ‡ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä»£ç ï¼Œäº†è§£å…¶æˆæƒæ£€æŸ¥çš„æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸­é—´ä»¶å¯èƒ½ä¼šæ£€æŸ¥ç”¨æˆ·çš„èº«ä»½éªŒè¯çŠ¶æ€ã€è§’è‰²æˆ–æƒé™ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** æ”»å‡»è€…éœ€è¦æ„é€ ä¸€ä¸ªç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œè¯¥è¯·æ±‚èƒ½å¤Ÿç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä»æ¼æ´æè¿°ä¸­çš„`x-middleware-subrequest` headeræ¥çœ‹ï¼Œå¯èƒ½ä¸å†…éƒ¨å­è¯·æ±‚æœ‰å…³ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿæˆ–ç¯¡æ”¹æ­¤è¯·æ±‚å¤´ï¼Œæˆ–é€šè¿‡å…¶ä»–æ–¹å¼ï¼Œä½¿ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘å¤±æ•ˆã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** æˆåŠŸç»•è¿‡æˆæƒåï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚æ•æ„Ÿæ•°æ®ã€ç®¡ç†é¡µé¢ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #3

**æ¥æº**: [CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-0xPb1_Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº† middleware è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­ `middleware.js` å®šä¹‰äº†åŸºäº cookie (`auth_token`) çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œç”¨äºä¿æŠ¤ `/admin` è·¯å¾„ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å¯èƒ½é€šè¿‡æŸç§æ–¹å¼æ“çºµæˆ–ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ï¼Œä¾‹å¦‚ï¼Œé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ‡å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯ã€‚å°½ç®¡æä¾›çš„ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†æ¶æ„æ”»å‡»è€…å¯èƒ½ä¼šåœ¨å®é™…éƒ¨ç½²ç¯å¢ƒä¸­ä¿®æ”¹æˆ–æ›¿æ¢ `middleware.js` æ–‡ä»¶ï¼Œä»¥å®Œå…¨ç¦ç”¨èº«ä»½éªŒè¯æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚ è¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’é£é™©, é€šè¿‡ä¿®æ”¹æ„å»ºæµç¨‹, ä¾‹å¦‚åœ¨`npm install` é˜¶æ®µ,æ¤å…¥æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [0xPb1/Next.js-CVE-2025-29927](https://github.com/0xPb1/Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #4

**æ¥æº**: [CVE-2025-29927-0xWhoknows_CVE-2025-29927.md](../2025/CVE-2025-29927-0xWhoknows_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `X-Middleware-Subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œæ­¤æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest`  header æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹ç›®æ ‡URLæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œå¹¶åˆ©ç”¨è¯¥æ¼æ´å°è¯•è®¿é—®èµ„æºã€‚ä»£ç ä¸­å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„é£é™©ç‚¹:

*   **ä¾èµ–ç®¡ç†ï¼š** ä»£ç ä½¿ç”¨äº†`aiohttp`ã€`asyncio`ã€`aiofiles`ç­‰ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œæˆ–è€…åœ¨å®‰è£…è¿‡ç¨‹ä¸­è¢«ç¯¡æ”¹ï¼Œåˆ™å¯èƒ½å¼•å…¥æ¶æ„ä»£ç ã€‚
*   **ç»“æœä¿å­˜ï¼š** ä»£ç ä¼šå°†æ‰«æç»“æœä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ–‡ä»¶ç³»ç»Ÿï¼Œå¯èƒ½ä¼šç¯¡æ”¹æ­¤æ–‡ä»¶ã€‚
*   **å¼‚å¸¸å¤„ç†ï¼š** ä»£ç ä¸­å­˜åœ¨å¼‚å¸¸å¤„ç†ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œå–„ï¼ŒæŸäº›æœªæ•è·çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ‰§è¡Œæµç¨‹å¼‚å¸¸ã€‚
*   **æ‰«æè¡Œä¸ºï¼š** å¤§è§„æ¨¡æ‰«æå¯èƒ½è¢«ç›®æ ‡ç³»ç»Ÿè¯†åˆ«ä¸ºæ¶æ„è¡Œä¸ºï¼Œå¯¼è‡´IPè¢«å°ç¦æˆ–å…¶ä»–å®‰å…¨æªæ–½ã€‚

 ç»¼åˆåˆ†æï¼Œæ­¤POCä»£ç **å­˜åœ¨è¾ƒä½çš„æŠ•æ¯’é£é™©ï¼Œå¤§çº¦ä¸º10%**ã€‚ä¸»è¦é£é™©åœ¨äºä¾èµ–åº“çš„å®‰å…¨æ€§ä»¥åŠä¸å®Œå–„çš„å¼‚å¸¸å¤„ç†ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ‰«æç›®æ ‡åº”ç”¨ï¼Œå‘ç°å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å‘é€å¸¦æœ‰`X-Middleware-Subrequest` headerçš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œå°è¯•ç»•è¿‡æˆæƒã€‚
4.  å¦‚æœè¿”å› 200 OK çŠ¶æ€ç ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #5

**æ¥æº**: [CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md](../2025/CVE-2025-29927-0xcucumbersalad_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•æ˜¯é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå…¶å€¼ä¸ºä¸€ç³»åˆ— `src/middleware` çš„é‡å¤ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„éªŒè¯ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´å­˜åœ¨å¹¶å·²è¢«ä¿®å¤ï¼ŒPOCä»£ç ä¸æ¼æ´æè¿°ç›¸ç¬¦ï¼Œå› æ­¤POCä»£ç åº”è¯¥æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç æ–‡ä»¶ï¼š
*   `README.md`: æä¾›äº†æ¼æ´åˆ©ç”¨çš„æ­¥éª¤ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚
*   `next.config.mjs`: è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `package-lock.json`: åŒ…å«äº†é¡¹ç›®ä¾èµ–çš„ä¿¡æ¯ã€‚è™½ç„¶ä¾èµ–é¡¹æœ¬èº«å¯èƒ½å­˜åœ¨æ½œåœ¨æ¼æ´ï¼Œä½†è¯¥æ–‡ä»¶æœ¬èº«ä¸åŒ…å«å¯ç›´æ¥æ‰§è¡Œçš„æ¶æ„ä»£ç ã€‚æ–‡ä»¶æ˜¾ç¤ºä½¿ç”¨äº† `next@14.2.13` ç‰ˆæœ¬ï¼Œæ˜¯åœ¨å—å½±å“èŒƒå›´å†…ã€‚
*   `pages/api/flag.js`ï¼šæ˜¯apiç«¯ç‚¹è¿”å›flagçš„æ–‡ä»¶ï¼Œå±äºåé—¨éªŒè¯æ–‡ä»¶ï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
*   `src/middleware.js`ï¼šä¸­é—´ä»¶æ–‡ä»¶ï¼Œç”¨äºæ¨¡æ‹ŸéªŒè¯ç»•è¿‡æƒ…å†µï¼Œä¸æ˜¯æŠ•æ¯’æ–‡ä»¶ã€‚
ç»¼åˆä»¥ä¸Šåˆ†æï¼Œè¯¥ä»“åº“å­˜åœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä¸æ’é™¤é€šè¿‡ç¯¡æ”¹ä¾èµ–é¡¹ç‰ˆæœ¬å¼•å…¥æ¶æ„ä¾èµ–çš„å¯èƒ½ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯ Next.js åº”ç”¨ç¨‹åºä¸­éœ€è¦èº«ä»½éªŒè¯çš„ API ç«¯ç‚¹ï¼ˆä¾‹å¦‚ `/api/flag`ï¼‰ã€‚
2.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸º `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚  è¯¥é‡å¤çš„`src/middleware`å€¼è¢«ç”¨äºæ¬ºéª—ä¸­é—´ä»¶ã€‚
3.  Next.js åº”ç”¨ç¨‹åºçš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œèº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡éªŒè¯ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„ API ç«¯ç‚¹ï¼Œè·å–æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ä¿®å¤å»ºè®®ï¼š**
å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€…æŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [0xcucumbersalad/cve-2025-29927](https://github.com/0xcucumbersalad/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #6

**æ¥æº**: [CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md](../2025/CVE-2025-29927-0xpr4bin_vulnerable-next_js_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ç®¡ç†åå°åŠæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”éƒ¨ç½²åœ¨å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´çš„PoCåˆ©ç”¨ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªä¿¡æ¯æ¥æºï¼ˆå¦‚Rapid7ã€JFrogã€Zscalerç­‰ï¼‰éƒ½è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`middleware.js`ï¼‰å±•ç¤ºäº†ä½¿ç”¨cookieè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶ä¸”åœ¨Next.jsä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™æ£€æŸ¥çš„æ–¹å¼ã€‚æ¼æ´å­˜åœ¨äº `x-middleware-subrequest` å¤´éƒ¨çš„å¤„ç†ä¸Šï¼Œå…è®¸æœªç»æˆæƒçš„ç”¨æˆ·ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æ²¡æœ‰ç›´æ¥ç»™å‡ºå‘é€headerçš„åˆ©ç”¨ä»£ç ï¼Œä½†åˆ©ç”¨åŸç†æ˜ç¡®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æ£€æŸ¥ç»™å®šçš„ä»£ç ä»“åº“æ˜¯å¦å­˜åœ¨æŠ•æ¯’é£é™©ã€‚ ä»£ç ä»“åº“ä¸­åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `Dockerfile`ï¼šç”¨äºæ„å»º Docker é•œåƒï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `Jenkinsfile`ï¼šç”¨äº Jenkins è‡ªåŠ¨åŒ–æ„å»ºï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä»…ä»…ç”¨äºæ„å»ºå’Œè¿è¡Œã€‚
*   `README.md`ï¼šæä¾›åŸºæœ¬çš„åº”ç”¨ä¿¡æ¯å’Œè¿è¡Œè¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `middleware.js`ï¼šåŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæƒé™éªŒè¯ï¼Œæ˜¯æ¼æ´çš„åˆ©ç”¨ç‚¹ï¼Œä½†ä¸æ˜¯æ¶æ„æŠ•æ¯’ä»£ç ã€‚
*   `package-lock.json`ï¼šä¾èµ–é”å®šæ–‡ä»¶ï¼Œä½†å†…å®¹è¿‡é•¿ï¼Œæ— æ³•å®Œå…¨åˆ†æï¼Œå­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†æ˜¯æ¦‚ç‡è¾ƒä½ï¼Œå‡è®¾ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´å‡ºç°åœ¨ Next.js åº”ç”¨çš„ä¸­é—´ä»¶ä¸­ï¼Œå½“ä¸­é—´ä»¶ä½¿ç”¨ cookie è¿›è¡Œèº«ä»½éªŒè¯æ—¶ï¼Œé€šè¿‡æŸç§æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œä¿®æ”¹æˆ–æ·»åŠ  `x-middleware-subrequest` headerï¼‰å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚
2.  **ç»•è¿‡éªŒè¯ï¼š** æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼ŒåŒ…å«æ¶æ„çš„ `x-middleware-subrequest` headerï¼Œä½¿ Next.js é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
3.  **è®¿é—®å—é™èµ„æºï¼š** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦ç®¡ç†å‘˜æƒé™æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ `/admin` è·¯å¾„ä¸‹çš„é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

**æ€»ç»“ï¼š**

æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§é«˜ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼ä¸»è¦é€šè¿‡æ„é€ å«æœ‰ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚ç»•è¿‡æƒé™éªŒè¯,åˆ©ç”¨è¿‡ç¨‹ç›¸å¯¹ç®€å•ã€‚è™½ç„¶ä¸»è¦æ–‡ä»¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†`package-lock.json`æ–‡ä»¶è¿‡å¤§ï¼Œå­˜åœ¨æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œä½†ä¸ç¡®å®šæ€§è¾ƒé«˜ã€‚

**é¡¹ç›®åœ°å€:** [0xpr4bin/vulnerable-next_js_cve-2025-29927](https://github.com/0xpr4bin/vulnerable-next_js_cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #7

**æ¥æº**: [CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-6mile_nextjs-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒZeroPath Blog æœ‰ä¸€ç¯‡æ·±å…¥åˆ†ææ–‡ç« ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„å­˜åœ¨ã€‚ç”±äºNucleiæ¨¡æ¿åªæ˜¯ç”¨äºæ£€æµ‹ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¾æ—§å­˜åœ¨æ¨¡æ¿ä½œè€…åŠ å…¥æ¶æ„payloadçš„é£é™©ï¼Œæ•…æŠ•æ¯’é£é™©è¯„ä¼°ä¸º5%ã€‚

**é¡¹ç›®åœ°å€:** [6mile/nextjs-CVE-2025-29927](https://github.com/6mile/nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #8

**æ¥æº**: [CVE-2025-29927-Ademking_CVE-2025-29927.md](../2025/CVE-2025-29927-Ademking_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•æ„Ÿæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6ï¼Œä»¥åŠ > 14.0.0 ä¸” < 14.2.25ï¼Œä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒé€»è¾‘ã€‚

POC ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå®ƒä½¿ç”¨ Nuclei æ¨¡æ¿éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è¯¥æ¨¡æ¿é€šè¿‡å¯¼èˆªåˆ°ç›®æ ‡ URLï¼Œç­‰å¾…é¡µé¢ç¨³å®šï¼Œç„¶åæ‰§è¡Œ JavaScript ä»£ç æ¥æŒ‡çº¹è¯†åˆ« Next.js ç‰ˆæœ¬ã€‚å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼Œåˆ™æ¼æ´å­˜åœ¨ã€‚

æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ åé—¨çš„å¯èƒ½ï¼Œä½†æä¾›çš„ `CVE-2025-29927.yaml` æ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´æ£€æµ‹é€»è¾‘ï¼Œä»…åŒ…å«æŒ‡çº¹è¯†åˆ«å½“å‰next.jsç‰ˆæœ¬æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚`README.md` æ–‡ä»¶æä¾›äº†å¦‚ä½•ä½¿ç”¨ Nuclei è¿è¡Œæ¨¡æ¿çš„è¯´æ˜ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Ademking/CVE-2025-29927](https://github.com/Ademking/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #9

**æ¥æº**: [CVE-2025-29927-AnonKryptiQuz_NextSploit.md](../2025/CVE-2025-29927-AnonKryptiQuz_NextSploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç›®æ ‡ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™éªŒè¯ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š** Next.js ä¸­é—´ä»¶åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶ï¼Œå­˜åœ¨æ ¡éªŒç¼ºé™·ï¼Œå¯¼è‡´æƒé™éªŒè¯å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œå‘é€åˆ° Next.js åº”ç”¨ç¨‹åºã€‚
3.  **åˆ©ç”¨æ•ˆæœï¼š** æˆåŠŸç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´è¢«è®¤ä¸ºæ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„é£é™©ç­‰çº§ï¼ˆCVSS 9.1ï¼‰ã€‚å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å·²å‘å¸ƒç›¸å…³æŠ¥å‘Šå’Œåˆ†æã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ POC ä»£ç  `NextSploit.py` ä¸»è¦åŠŸèƒ½æ˜¯æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹ React ç‰ˆæœ¬ï¼Œå¹¶åˆ©ç”¨ Wappalyzer å·¥å…·è¯†åˆ«ç½‘ç«™æŠ€æœ¯æ ˆã€‚è™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†å­˜åœ¨ä»¥ä¸‹æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é¡¹å®‰è£…ï¼š** ä»£ç ä¼šè‡ªåŠ¨å®‰è£… `wappalyzer`ã€`requests`ã€`colorama` å’Œ `selenium` ç­‰ Python åŒ…ã€‚è¿™äº›åŒ…æœ¬èº«æ˜¯åˆæ³•çš„ï¼Œä½†å¦‚æœé»‘å®¢ç¯¡æ”¹ `NextSploit.py` å¹¶æ›¿æ¢æˆæ¶æ„åŒ…ï¼Œåˆ™å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚
*   **subprocess.run ä½¿ç”¨ï¼š** ä»£ç ä½¿ç”¨ `subprocess.run` æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼ˆå¦‚ `wappalyzer`ï¼‰ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ `scan_command` å˜é‡ï¼Œå°±å¯ä»¥æ‰§è¡Œä»»æ„ç³»ç»Ÿå‘½ä»¤ã€‚
*   **è¾“å‡ºæ–‡ä»¶å¤„ç†ï¼š** ä»£ç å°† Wappalyzer çš„è¾“å‡ºä¿å­˜åˆ° `output.json` æ–‡ä»¶ä¸­ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹æˆ–è¦†ç›–æ­¤æ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²æˆ–æ‹’ç»æœåŠ¡ã€‚

è™½ç„¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†æ€»ä½“æ¥çœ‹ï¼Œ`NextSploit.py` çš„æŠ•æ¯’é£é™©è¾ƒä½ã€‚ ä»£ç ä¸»è¦ç”¨äºä¿¡æ¯æ”¶é›†ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ æ ¹æ®åˆ†æ,æŠ•æ¯’é£é™©çº¦ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚å…·ä½“åˆ©ç”¨æ–¹å¼å–å†³äºåº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘å’Œä¸­é—´ä»¶çš„é…ç½®ã€‚ä¾‹å¦‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®ç®¡ç†å‘˜é¡µé¢ã€ä¿®æ”¹ç”¨æˆ·æ•°æ®æˆ–æ‰§è¡Œå…¶ä»–æ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #10

**æ¥æº**: [CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md](../2025/CVE-2025-29927-B1ack4sh_Blackash-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯,ä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®å¤„ç†ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„POCä»£ç ä»…ä¸ºREADMEæ–‡ä»¶ï¼Œéœ€è¦è‡ªè¡Œæ„é€ åˆ©ç”¨ä»£ç ã€‚

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ æ¼æ´å½±å“ Next.js ç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚ ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œå› æ­¤å®é™…åˆ©ç”¨çš„æœ‰æ•ˆæ€§å–å†³äºè‡ªè¡Œæ„é€ çš„Payloadã€‚README.mdæ–‡ä»¶æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œä½†ä»“åº“çš„åˆ›å»ºè€…æœ‰å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹æ¤å…¥æ¶æ„ä»£ç (æ¯”å¦‚git hooks)ï¼Œå› æ­¤å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚ åˆ©ç”¨æ–¹å¼ï¼š 1. ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚ 2. æ”»å‡»è€…å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚ 3. Next.js åº”ç”¨æœªæ­£ç¡®éªŒè¯è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚ 4. æ”»å‡»è€…æˆåŠŸè®¿é—®æœªç»æˆæƒçš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #11

**æ¥æº**: [CVE-2025-29927-Balajih4kr_cve-2025-29927.md](../2025/CVE-2025-29927-Balajih4kr_cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµæˆ–æ·»åŠ  `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç  `README.md` æ–‡ä»¶ä»…æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æ²¡æœ‰æä¾›å¯ç›´æ¥æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©å¾ˆä½ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶å¹¶ç»•è¿‡æˆæƒã€‚

**é¡¹ç›®åœ°å€:** [Balajih4kr/cve-2025-29927](https://github.com/Balajih4kr/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #12

**æ¥æº**: [CVE-2025-29927-BilalGns_CVE-2025-29927.md](../2025/CVE-2025-29927-BilalGns_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å­˜åœ¨ä¸­é—´ä»¶æƒé™æ ¡éªŒï¼Œå¹¶ä¸”åº”ç”¨å—åˆ°å½±å“ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ ¹æ®æœç´¢ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯ï¼Œæ­¤æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæä¾›çš„ README.mdï¼‰æŒ‡å‘äº†ä¸€ä¸ªåŒ…å«æ›´å¤šç»†èŠ‚çš„å¤–éƒ¨é“¾æ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„æ¶æ„è¯·æ±‚ã€‚ å…³äºæŠ•æ¯’é£é™©ï¼ŒPOCä»£ç æœ¬èº«éå¸¸ç®€å•ï¼ŒåªåŒ…å«ä¸€ä¸ª README æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æä¾›äº†æ¼æ´ä¿¡æ¯å’Œå¤–éƒ¨é“¾æ¥ã€‚ æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥é“¾æ¥å¯èƒ½åŒ…å«æ¶æ„å†…å®¹ï¼Œæ‰€ä»¥å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„HTTPè¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ã€‚
2.  Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ²¡æœ‰æ­£ç¡®éªŒè¯è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”åˆ©ç”¨èµ·æ¥ç›¸å¯¹ç®€å•ï¼Œåªéœ€æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å³å¯ã€‚


**é¡¹ç›®åœ°å€:** [BilalGns/CVE-2025-29927](https://github.com/BilalGns/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #13

**æ¥æº**: [CVE-2025-29927-Bongni_CVE-2025-29927.md](../2025/CVE-2025-29927-Bongni_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927çš„æè¿°ï¼Œæ­¤æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æä¾›çš„POCä»£ç åŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä¸»è¦ç”¨äºæ¼æ´çš„å¤ç°å’Œä¿®å¤ã€‚LICENSEæ–‡ä»¶æ˜¯MITè®¸å¯è¯ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹ä»£ç ã€‚README.mdæ–‡ä»¶è¯´æ˜äº†è¯¥POCæ˜¯é’ˆå¯¹CVE-2025-29927æ¼æ´çš„ã€‚ç”±äºæ²¡æœ‰åŒ…å«å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ,æ‰€ä»¥åˆ¤å®šæä¾›çš„POCä»…ä¸ºå£°æ˜æ–‡ä»¶,æœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æä¾›çš„POCä»£ç ä»…åŒ…å«Licenseå’ŒReadmeæ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ï¼Œæœ‰æ•ˆæ€§å¾ˆä½ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š** POCä»£ç æ–‡ä»¶(LICENSE å’Œ README.md)æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç æˆ–æ¶æ„æŒ‡ä»¤ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°çº¦ä¸º 5%ã€‚è™½ç„¶ä»£ç ä»“åº“çš„ä½œè€…å¯ä»¥å°è¯•é€šè¿‡å…¶ä»–æ–¹å¼å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†åœ¨è¿™ä¸ªç®€å•çš„POCä¸­ï¼Œé£é™©éå¸¸å°ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**  æ ¹æ®æ¼æ´æè¿°ï¼Œåˆ©ç”¨æ–¹å¼æ˜¯ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ `x-middleware-subrequest`  è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ï¼Œæˆ–è€…å‡çº§åˆ°å·²ä¿®å¤çš„ç‰ˆæœ¬(>=14.2.25 or >=15.2.3)ã€‚

**é¡¹ç›®åœ°å€:** [Bongni/CVE-2025-29927](https://github.com/Bongni/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #14

**æ¥æº**: [CVE-2025-29927-BugHawak_CVE-2025-29927.md](../2025/CVE-2025-29927-BugHawak_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ã€‚POC åˆ©ç”¨æ–¹å¼ä¸ºå‘é€åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒé€»è¾‘ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å·²è¢«ç¡®è®¤ï¼Œå¹¶ä¸”æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å’Œä¿®å¤ç‰ˆæœ¬ã€‚æ¼æ´åˆ©ç”¨ä»£ç å°è¯•é€šè¿‡è®¾ç½® `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè¿™ä¸æ¼æ´æè¿°ä¸­æä¾›çš„ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å«è¯¥å¤´çš„è¯·æ±‚ï¼‰ç›¸ç¬¦ï¼Œå› æ­¤ POC ä»£ç å¾ˆå¯èƒ½æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ï¼Œå°è¯•ç»•è¿‡æˆæƒï¼Œä»£ç ä¸­åŒ…å«ä¸€äº›å¸¸è§çš„ç½‘ç»œè¯·æ±‚æ“ä½œå’Œå‚æ•°é…ç½®ï¼Œä¾‹å¦‚è®¾ç½® User-Agentã€å¤„ç†é‡å®šå‘ç­‰ã€‚è™½ç„¶ä»£ç æ¯”è¾ƒé•¿ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¸Šä¼ æ–‡ä»¶ç­‰ã€‚è€ƒè™‘åˆ°ä»£ç ä¸»è¦ç›®çš„æ˜¯éªŒè¯æˆæƒç»•è¿‡æ¼æ´ï¼Œå› æ­¤æ¨æµ‹æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ç²¾å¿ƒæ„é€ çš„è¯·æ±‚å¤´æ¥è§¦å‘æœåŠ¡å™¨çš„æœªçŸ¥æ¼æ´æˆ–èµ„æºæ¶ˆè€—ï¼‰ã€‚å› æ­¤ï¼Œè¿™é‡Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

ç¼“è§£æªæ–½ï¼š
*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #15

**æ¥æº**: [CVE-2025-29927-CEAarab_CVE-2025-29927_env.md](../2025/CVE-2025-29927-CEAarab_CVE-2025-29927_env.md)

## CVE-2025-29927-Next.js-Middlewareæˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœ Next.js åº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜ï¼Œè¯¥æ¼æ´ä¸ `x-middleware-subrequest` æ ‡å¤´çš„ä½¿ç”¨ä¸å½“æœ‰å…³ã€‚åˆ©ç”¨æ–¹å¼æ˜¯æ”»å‡»è€…å¯ä»¥åœ¨è¯·æ±‚ä¸­åŒ…å«æˆ–æ“çºµ `x-middleware-subrequest` æ ‡å¤´ï¼Œä»è€Œæ¬ºéª—ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œè¿›è€Œç»•è¿‡æˆæƒã€‚æä¾›çš„ä»£ç ç‰‡æ®µçœ‹èµ·æ¥æ˜¯ä¸€ä¸ª Next.js åº”ç”¨çš„ Dockerfile å’Œä¸€äº›é…ç½®è„šæœ¬ï¼Œç”¨äºç¦»çº¿éƒ¨ç½² MediGuard åº”ç”¨ã€‚**Dockerfile** ç”¨äºæ„å»ºDockeré•œåƒï¼ŒåŒ…å«äº†å®‰è£…ä¾èµ–ã€å¤åˆ¶æ–‡ä»¶ã€æ„å»ºé¡¹ç›®ã€è£å‰ªç”Ÿäº§ç¯å¢ƒä¾èµ–ç­‰æ“ä½œã€‚**OFFLINE.md** æä¾›äº†ç¦»çº¿éƒ¨ç½²çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¤åˆ¶å­—ä½“å’ŒCSSæ–‡ä»¶ã€æ„å»ºé¡¹ç›®ç­‰ã€‚**README.md** æè¿°äº†MediGuardåº”ç”¨çš„åŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•ï¼Œä»¥åŠä¸€ä¸ªå®‰å…¨è­¦å‘Šï¼Œè¡¨æ˜è¯¥åº”ç”¨åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ã€‚è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä¸»è¦åŠŸèƒ½æ˜¯ç¯å¢ƒé…ç½®å’Œéƒ¨ç½²ï¼Œä½†é‰´äº MediGuard åº”ç”¨æœ¬èº«åŒ…å«ä¸€ä¸ªæ•…æ„è®¾è®¡çš„æ¼æ´å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼Œå­˜åœ¨è¢«æ¶æ„åˆ©ç”¨çš„é£é™©ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©è¯„ä¼°ä¸º10%ã€‚ æ¼æ´åˆ©ç”¨æ–¹å¼æ€»ç»“å¦‚ä¸‹ï¼š

1.  **è¯†åˆ«ç›®æ ‡ï¼š** å¯»æ‰¾ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä¾èµ–ä¸­é—´ä»¶çš„åº”ç”¨ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** åœ¨HTTPè¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œæˆ–è€…ä¿®æ”¹è¯¥æ ‡å¤´çš„å€¼ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  åˆ©ç”¨ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–åŠŸèƒ½ã€‚
4. **éªŒè¯æ¼æ´ï¼š** å°è¯•è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼ŒéªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #16

**æ¥æº**: [CVE-2025-29927-EQSTLab_CVE-2025-29927.md](../2025/CVE-2025-29927-EQSTLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®šæ„é€ çš„ `x-middleware-subrequest` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦èº«ä»½éªŒè¯çš„å—ä¿æŠ¤è·¯ç”±ï¼Œä¾‹å¦‚ `/admin`ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æè¿°äº†è¯¥æ¼æ´ï¼Œå¹¶æŒ‡å‡ºå¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ bash è„šæœ¬ï¼Œè¯¥è„šæœ¬ä½¿ç”¨ curl å‘½ä»¤å‘é€åŒ…å«æ¶æ„æ„é€ çš„ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡å¯¹ `/admin` è·¯ç”±çš„æƒé™éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
å®¡æŸ¥äº†æä¾›çš„æ–‡ä»¶å†…å®¹ï¼ŒåŒ…æ‹¬ `README.md`ï¼Œ`poc.sh`ï¼Œ`Dockerfile`ï¼Œ `middleware.ts`ç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„ã€æ¶æ„çš„ä»£ç ã€‚è¯¥å­˜å‚¨åº“ä¸»è¦ç”¨äºæ¼”ç¤ºCVE-2025-29927æ¼æ´ï¼Œå¹¶ä¸”ç›¸å…³æ–‡ä»¶ä»…åŒ…å«PoCä»£ç ï¼Œé…ç½®æ–‡ä»¶å’Œè¯´æ˜æ–‡æ¡£ã€‚å› æ­¤ï¼ŒæŠ•æ¯’çš„é£é™©è¾ƒä½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„ Next.jsï¼Œå¹¶ä¸”æƒé™éªŒè¯é€»è¾‘å¿…é¡»åœ¨ä¸­é—´ä»¶ä¸­å®ç°ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `X-Middleware-Subrequest` è¯·æ±‚å¤´ï¼Œè¯¥è¯·æ±‚å¤´çš„å€¼å¯ä»¥åŒ…å«å¤šä¸ª `middleware` å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `middleware:middleware:middleware:middleware:middleware`ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„HTTPè¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  ç”±äºNext.jså¯¹ `X-Middleware-Subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [EQSTLab/CVE-2025-29927](https://github.com/EQSTLab/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #17

**æ¥æº**: [CVE-2025-29927-EarthAngel666_x-middleware-exploit.md](../2025/CVE-2025-29927-EarthAngel666_x-middleware-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨å­˜åœ¨Next.jsä¸­é—´ä»¶ï¼Œä¸”ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç† `x-middleware-subrequest` header æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œæä¾›çš„ POC ä»£ç åŸºæœ¬æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` header æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œå°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸­ï¼Œ`nextjsmiddlewareexploit.py` è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚ `user-agents.txt` æ–‡ä»¶åŒ…å«å¸¸è§çš„ User-Agent å­—ç¬¦ä¸²ï¼Œç”¨äºæ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œå› æ­¤æŠ•æ¯’çš„é£é™©è¾ƒä½,å¯ä»¥åˆ¤æ–­ä¸º0%ã€‚ä½†æ˜¯ä»£ç ä¸­çš„URLæ˜¯ç¤ºä¾‹ç½‘ç«™ï¼Œå¦‚æœè¦å¯¹ç›®æ ‡ç½‘ç«™è¿›è¡Œæ”»å‡»ï¼Œéœ€è¦ä¿®æ”¹URLã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦é‰´æƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

è¯¥æ¼æ´çš„å…³é”®åœ¨äºåˆ©ç”¨ `x-middleware-subrequest` header æ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨ï¼Œä»è€Œè·³è¿‡é‰´æƒæ£€æŸ¥ã€‚

**ä¿®å¤å»ºè®®ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  åœ¨ä¸­é—´ä»¶ä¸­ï¼ŒéªŒè¯ `x-middleware-subrequest` header çš„æ¥æºï¼Œç¡®ä¿å®ƒç¡®å®æ¥è‡ªå†…éƒ¨å¯ä¿¡çš„æ¥æºã€‚
3.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [EarthAngel666/x-middleware-exploit](https://github.com/EarthAngel666/x-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #18

**æ¥æº**: [CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md](../2025/CVE-2025-29927-Eve-SatOrU_POC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²ã€XSSæ”»å‡»å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ PoC ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥ä½¿ç”¨åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ï¼Œè€Œæ— éœ€ç»è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯æµç¨‹ã€‚æ­¤å¤–ï¼ŒPoC è¿˜æ¼”ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSPï¼ˆå†…å®¹å®‰å…¨ç­–ç•¥ï¼‰å¹¶æ‰§è¡Œ XSS æ”»å‡»ï¼Œä»¥åŠè¿›è¡Œç¼“å­˜æŠ•æ¯’çš„ DoS æ”»å‡»ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoC ä»£ç æœ‰æ•ˆã€‚å®ƒæä¾›äº†ä¸€ä¸ªæ¸…æ™°çš„æ¼”ç¤ºï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç æœ¬èº«ä¸»è¦æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„ï¼Œç›¸å¯¹ç®€å•ã€‚ç„¶è€Œï¼Œå­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ã€‚è¯¥å­˜å‚¨åº“å¯èƒ½åŒ…å«ä¸€äº›éšè”½çš„ä»£ç ä¿®æ”¹ï¼Œè¿™äº›ä¿®æ”¹ä¸æ˜¯æ¼æ´åˆ©ç”¨ç›´æ¥éœ€è¦çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¶æ„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œå­˜åœ¨æ›´æ”¹ `npm run dev` æ‰§è¡Œçš„è„šæœ¬çš„å¯èƒ½æ€§ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°ç¯å¢ƒä¸­å¼•å…¥åé—¨æˆ–æ”¶é›†ä¿¡æ¯ã€‚ä½†æ ¹æ®æ–‡ä»¶å†…å®¹è¿›è¡Œåˆæ­¥åˆ¤æ–­ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚è¿™éƒ¨åˆ†é£é™©ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨å…‹éš†å’Œè¿è¡Œç¬¬ä¸‰æ–¹ä»£ç æ—¶æ€»æ˜¯éœ€è¦ä¿æŒè­¦æƒ•ï¼Œç‰¹åˆ«æ˜¯æ¶‰åŠåˆ°ç½‘ç»œæœåŠ¡ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** è¯¥æ¼æ´ä¸»è¦é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ©ç”¨ï¼š

1.  **æˆæƒç»•è¿‡ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
2.  **CSP ç»•è¿‡ï¼š**  æ”»å‡»è€…åˆ©ç”¨æ­¤æ¼æ´ç»•è¿‡ CSP ç­–ç•¥ï¼Œä»è€Œå…è®¸æ‰§è¡Œæ¶æ„è„šæœ¬ï¼Œå¯¼è‡´ XSS æ”»å‡»ã€‚
3.  **ç¼“å­˜æŠ•æ¯’ DoSï¼š** æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ¥å¼ºåˆ¶æœåŠ¡å™¨ç¼“å­˜é”™è¯¯çš„å†…å®¹ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼Œå½±å“æ­£å¸¸ç”¨æˆ·çš„è®¿é—®ã€‚

**ä¿®å¤å»ºè®®ï¼š**

1.  å‡çº§ Next.js åˆ° >= 14.2.25 æˆ– >= 15.2.3 ç‰ˆæœ¬ã€‚
2.  åœ¨æ— æ³•å‡çº§çš„æƒ…å†µä¸‹ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚
3. éªŒè¯ä¸­é—´ä»¶é€»è¾‘ä»¥é˜²æ­¢ç»•è¿‡ã€‚

**é¡¹ç›®åœ°å€:** [Eve-SatOrU/POC-CVE-2025-29927](https://github.com/Eve-SatOrU/POC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #19

**æ¥æº**: [CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md](../2025/CVE-2025-29927-Gokul-Krishnan-V-R_cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ ç‰¹å®šçš„`x-middleware-subrequest` Headeræ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹å¼æœ‰æ•ˆã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚å…·ä½“æ¥è¯´ï¼Œå½“Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶æ—¶ï¼Œ`runMiddleware`å‡½æ•°ä¼šæ£€ç´¢`x-middleware-subrequest` Headerçš„å€¼ï¼Œå¹¶ä½¿ç”¨å†’å·(:)ä½œä¸ºåˆ†éš”ç¬¦å°†å…¶æ‹†åˆ†ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ç„¶åï¼Œå®ƒä¼šæ£€æŸ¥è¯¥åˆ—è¡¨æ˜¯å¦åŒ…å«ä¸­é—´ä»¶çš„`name`å€¼ã€‚å¦‚æœæ”»å‡»è€…åœ¨è¯·æ±‚ä¸­æ·»åŠ åŒ…å«æ­£ç¡®å€¼çš„`x-middleware-subrequest` Headerï¼Œä¸­é—´ä»¶å°†è¢«å®Œå…¨å¿½ç•¥ï¼Œè¯·æ±‚å°†é€šè¿‡`NextResponse.next()`è½¬å‘åˆ°åŸå§‹ç›®çš„åœ°ï¼Œè€Œä¸­é—´ä»¶ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

POCä»£ç æœ¬èº«ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹å¼çš„ç¤ºä¾‹é¡¹ç›®ï¼Œå…¶åŒ…å«çš„æ–‡ä»¶å¦‚`Readme.md`, `eslint.config.mjs`, `next-env.d.ts`, `next.config.js`, `package-lock.json`éƒ½å±äºæ­£å¸¸é¡¹ç›®æ–‡ä»¶ã€‚ è™½ç„¶ç†è®ºä¸Šå¯ä»¥å¾€è¿™äº›æ–‡ä»¶ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œä½†ä»ç°æœ‰çš„ä¿¡æ¯æ¥çœ‹ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ã€‚ä½†æ˜¯éœ€è¦äººå·¥è¿›ä¸€æ­¥reviewä»£ç ç¡®ä¿æ²¡æœ‰éšè—çš„æ¶æ„è¡Œä¸ºï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†… (>= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3).
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨middlewareè¿›è¡Œæƒé™æ ¡éªŒ.
3.  æ”»å‡»è€…é€šè¿‡Burp Suiteæˆ–ç±»ä¼¼çš„å·¥å…·æ‹¦æˆªè¯·æ±‚ã€‚
4.  æ”»å‡»è€…æ·»åŠ `x-middleware-subrequest` headerï¼Œå…¶å€¼è®¾ç½®ä¸ºåŒ…å«middlewareåç§°çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸ç”¨å†’å·åˆ†éš”ï¼‰ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä¸­é—´ä»¶çš„åç§°æ˜¯`authMiddleware`ï¼Œåˆ™headerçš„å€¼å¯ä»¥æ˜¯`authMiddleware:otherValue`ã€‚
5.  å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œä¸­é—´ä»¶å°†è¢«ç»•è¿‡ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Gokul-Krishnan-V-R/cve-2025-29927](https://github.com/Gokul-Krishnan-V-R/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #20

**æ¥æº**: [CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md](../2025/CVE-2025-29927-Grand-Moomin_Vuln-Next.js-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”æœªèƒ½æ­£ç¡®å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ åŒ…å«`x-middleware-subrequest`è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œå¤§äº14.0.0å°äº14.2.25ï¼Œä»¥åŠå¤§äº15.0.0å°äº15.2.3ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºè¯¥æ¼æ´ä¸`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“æœ‰å…³ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0çš„åè®®æ–‡æœ¬ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æ— æ³•è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä¸”æ²¡æœ‰è¯æ®è¡¨æ˜å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç ã€‚åˆ©ç”¨æ–¹å¼ä¸ºæ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨æœåŠ¡å™¨ï¼Œä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [Grand-Moomin/Vuln-Next.js-CVE-2025-29927](https://github.com/Grand-Moomin/Vuln-Next.js-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #21

**æ¥æº**: [CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-Heimd411_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 15.0.0, <= 15.2.2 (ä¹Ÿå½±å“å…¶ä»–ç‰ˆæœ¬)

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.js middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ middleware å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ `x-middleware-subrequest` header æ¥ç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹å®šçš„ header å€¼ï¼Œæ¬ºéª— middleware å°†è¯·æ±‚è§†ä¸ºå·²ç»å¤„ç†è¿‡ï¼Œä»è€Œè·³è¿‡å®‰å…¨æ§åˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨ä¸”è¢«å¹¿æ³›å…³æ³¨çš„æ¼æ´ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨éªŒè¯è¯¥æ¼æ´ï¼Œå¹¶åŒ…å«ç‰ˆæœ¬æ£€æµ‹å’Œåˆ©ç”¨æ­¥éª¤ã€‚å› æ­¤ï¼Œè¯¥ PoC ä»£ç åœ¨ç†è®ºä¸Šæ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®é™…åˆ©ç”¨æ•ˆæœå–å†³äºç›®æ ‡åº”ç”¨ç¨‹åºçš„å…·ä½“é…ç½®å’Œç¯å¢ƒã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«çš„ä¸»è¦ç›®çš„æ˜¯æ¼æ´éªŒè¯ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç åŒ…æ‹¬ç‰ˆæœ¬æ£€æµ‹ï¼Œheader æ„é€ ï¼Œå’Œç»“æœéªŒè¯ç­‰éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°å®‰å…¨é£é™©ï¼Œä»ç„¶å­˜åœ¨æä½çš„æŠ•æ¯’é£é™©ã€‚PoCä»£ç çš„ä½œè€…èº«ä»½æœªçŸ¥ï¼Œä»£ç çš„åŠŸèƒ½æ˜¯è¿›è¡Œå®‰å…¨æµ‹è¯•ã€‚æ‰€ä»¥ï¼Œä¿å®ˆä¼°è®¡å­˜åœ¨1%çš„å¯èƒ½æ€§ï¼Œä½œè€…éšè—äº†æŸäº›åé—¨æˆ–æ¶æ„åŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** PoCé¦–å…ˆå°è¯•é€šè¿‡è®¿é—® `_next/static/development/_buildManifest.js` æˆ– `_next/static/` ç›®å½•ï¼Œæˆ–è€…server timing headersæ¥ç¡®å®šç›®æ ‡ Next.js åº”ç”¨çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´è§¦å‘ï¼š** å¦‚æœæ£€æµ‹åˆ°æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬ï¼ˆ15.0.0 åˆ° 15.2.2ï¼‰ï¼ŒPoC ä¼šæ„é€ ä¸€ä¸ªå¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  **ç»•è¿‡éªŒè¯ï¼š**  è¯¥ header çš„ç›®çš„æ˜¯æ¬ºéª— Next.js middlewareï¼Œä½¿å…¶è®¤ä¸ºè¯·æ±‚å·²ç»è¢«å¤„ç†ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** å¦‚æœåˆ©ç”¨æˆåŠŸï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿæœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¢æ¿æˆ–å…¶ä»–éœ€è¦èº«ä»½éªŒè¯çš„é¡µé¢ã€‚

**ä¿®å¤å»ºè®®ï¼š**

å‡çº§ Next.js åˆ° 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬å¯ä»¥ä¿®å¤æ­¤æ¼æ´ã€‚åŒæ—¶ï¼Œå»ºè®®åœ¨ middleware ä¸­è¿›è¡Œæ›´ä¸¥æ ¼çš„ header éªŒè¯ï¼Œé˜²æ­¢æ¶æ„ç¯¡æ”¹ã€‚

**é¡¹ç›®åœ°å€:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #22

**æ¥æº**: [CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md](../2025/CVE-2025-29927-Hirainsingadia_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”é‰´æƒé€»è¾‘åœ¨ä¸­é—´ä»¶ä¸­å®ç°

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„é‰´æƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç  `cve_2025_29927_bypass.py` æ—¨åœ¨æµ‹è¯•è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¸åŒ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œå¹¶åˆ†ææœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ï¼Œä»¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨é‰´æƒç»•è¿‡ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œå¯æœ‰æ•ˆéªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç»åˆ†æï¼Œè¯¥ POC ä»£ç æœªå‘ç°å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„è¿¹è±¡ã€‚ä»£ç åŠŸèƒ½å•ä¸€ï¼Œä¸»è¦ç”¨äºå‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°æ‰§è¡Œæ¶æ„æ“ä½œæˆ–ä¼ æ’­æ¶æ„ä»£ç çš„é€»è¾‘ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„ Next.js åº”ç”¨ç¨‹åºã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨ POC ä»£ç æˆ–æ‰‹åŠ¨æ„é€  HTTP è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°è¯•ä¸åŒçš„å€¼ (ä¾‹å¦‚ `middleware`, `randomstring`, ç©ºå­—ç¬¦ä¸²ç­‰)ã€‚
3.  **åˆ†æå“åº”ï¼š** è§‚å¯ŸæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç ã€‚å¦‚æœè¿”å› 200 OKï¼Œåˆ™è¡¨æ˜å¯èƒ½æˆåŠŸç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å¦‚æœè¿”å› 401 æˆ– 403ï¼Œåˆ™è¡¨æ˜é‰´æƒç”Ÿæ•ˆï¼Œæ¼æ´åˆ©ç”¨å¤±è´¥ã€‚

è¯¥æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` header çš„å¤„ç†ä¸å½“ï¼Œå› æ­¤é€šè¿‡æ“çºµè¯¥ header çš„å€¼ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„é‰´æƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #23

**æ¥æº**: [CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md](../2025/CVE-2025-29927-HoumanPashaei_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”æš´éœ²åœ¨ç½‘ç»œä¸Šã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´æºäºNext.jsåœ¨å¤„ç†`x-middleware-subrequest`è¯·æ±‚å¤´æ—¶çš„ä¸å½“è¡Œä¸ºï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰è¯¥è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å…·æœ‰è¾ƒé«˜çš„å±å®³æ€§ã€‚æä¾›çš„POCä»£ç ï¼ˆæ‰«æå™¨ï¼‰é€šè¿‡æ¨¡æ‹Ÿæ”»å‡»è€…å‘é€å¸¦æœ‰`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ï¼Œæ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼ŒåŸç†ä¸Šæ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ£€æŸ¥æä¾›çš„ä»£ç ï¼Œå‘ç°ä»¥ä¸‹æ½œåœ¨é£é™©ï¼š

1.  **ä¾èµ–é£é™©ï¼š** `requirements.txt`ä¸­æ˜¯å¦å­˜åœ¨æ¶æ„ä¾èµ–éœ€è¦è¿›ä¸€æ­¥å®¡æŸ¥ã€‚è™½ç„¶ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä½†ä»»ä½•ä¾èµ–éƒ½å¯èƒ½è¢«æŠ•æ¯’ã€‚
2.  **ç½‘ç»œè¡Œä¸ºï¼š** æ‰«æå™¨ä¼šå‘ç›®æ ‡ç½‘ç«™å‘èµ·å¤§é‡è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™éƒ¨ç½²äº†åçˆ¬æœºåˆ¶ï¼Œå¯èƒ½ä¼šè§¦å‘å‘Šè­¦ç”šè‡³è¢«å°ç¦IPã€‚
3. **ç»“æœç¯¡æ”¹ï¼š** æ‰«æå™¨å¯èƒ½å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œå¯¼è‡´è¯¯æŠ¥æˆ–æ¼æŠ¥ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†æ‰«æå™¨ï¼Œåˆ™å¯èƒ½æ¶æ„ç¯¡æ”¹æ‰«æç»“æœã€‚

ç»¼åˆåˆ†æï¼Œè¯¥POCä»£ç æœ¬èº«éšè—æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦10%ï¼Œä½†æ˜¯å­˜åœ¨è¢«æ»¥ç”¨æˆ–è€…å› ä¾èµ–é¡¹è€Œå¼•å…¥é£é™©çš„å¯èƒ½ï¼Œæ‰€ä»¥ä¾èµ–é¡¹å’Œä½¿ç”¨è€…éœ€è¦æ³¨æ„ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨POCä»£ç ï¼ˆæˆ–æ‰‹åŠ¨æ„é€ è¯·æ±‚ï¼‰å‘ç›®æ ‡åº”ç”¨å‘é€å¸¦æœ‰`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  å¦‚æœèµ„æºå¯ä»¥è¢«æœªç»æˆæƒè®¿é—®ï¼Œåˆ™è¯´æ˜ç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ã€‚
4.  æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è®¿é—®æ•æ„Ÿæ•°æ®ã€æ‰§è¡Œæœªæˆæƒæ“ä½œç­‰ã€‚

**é¡¹ç›®åœ°å€:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #24

**æ¥æº**: [CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md](../2025/CVE-2025-29927-Kamal-418_CVE-2025-29927-NextJs-Lab.md)

## CVE-2025-29927-next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®CVE-2025-29927æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ï¼ˆ`x-middleware-subrequest`ï¼‰ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ä»£ç å±•ç¤ºäº†ä¸€ä¸ªä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯çš„ç®€å•ç¤ºä¾‹ã€‚`middleware.ts` æ–‡ä»¶ä¸­çš„ä¸­é—´ä»¶ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `auth_token` cookieã€‚å¦‚æœè®¿é—® `/admin` è·¯å¾„ï¼Œä¸”ä¸å­˜åœ¨è¯¥ cookieï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ° `/login`ã€‚åˆ©ç”¨è¯¥æ¼æ´å¯ä»¥é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`headerçš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œç›´æ¥è®¿é—®`/admin`é¡µé¢,ä»è€ŒæˆåŠŸåˆ©ç”¨è¯¥æ¼æ´ã€‚è¯¥POCèƒ½å¤Ÿå¤ç°è¯¥æ¼æ´ï¼Œå› æ­¤POCæœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ä»£ç ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸Next.jsåº”ç”¨ç¨‹åºçš„æ­£å¸¸ç»“æ„å’ŒåŠŸèƒ½ç›¸ç¬¦ã€‚`Dockerfile` ç”¨äºæ„å»º Docker é•œåƒï¼Œ`README.md` æä¾›æ„å»ºå’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ï¼Œ `middleware.ts` åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œ`package.json` åˆ—å‡ºé¡¹ç›®ä¾èµ–é¡¹ï¼Œ `tsconfig.json` é…ç½® TypeScript ç¼–è¯‘å™¨ï¼Œ`pages/admin.tsx` æ˜¯ä¸€ä¸ªç®€å•çš„ç®¡ç†é¡µé¢ï¼Œå±•ç¤ºäº†ç™»å‡ºåŠŸèƒ½ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå¹¶å­˜åœ¨æ¼æ´ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
3.  å°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/admin` é¡µé¢ï¼‰ã€‚
4.  ç”±äºä¸­é—´ä»¶éªŒè¯ç»•è¿‡ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Kamal-418/CVE-2025-29927-NextJs-Lab](https://github.com/Kamal-418/CVE-2025-29927-NextJs-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #25

**æ¥æº**: [CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md](../2025/CVE-2025-29927-Kamal-Hegazi_Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æƒé™æå‡å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, 14.0.0 < ç‰ˆæœ¬ < 14.2.25, 15.0.0 < ç‰ˆæœ¬ < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶è¿è¡Œåœ¨ `next start` æˆ–ç‹¬ç«‹æ¨¡å¼ä¸‹ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶æ‰§è¡Œçš„æˆæƒæ£€æŸ¥ã€‚å¯¹äº 15.x ç‰ˆæœ¬ï¼Œéœ€è¦é‡å¤è¯¥å¤´éƒ¨çš„å€¼äº”æ¬¡ä»¥è¾¾åˆ°æœ€å¤§é€’å½’æ·±åº¦é™åˆ¶ã€‚æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºè¯¥æ¼æ´åˆ©ç”¨ç®€å•ï¼Œåªéœ€æ·»åŠ ä¸€ä¸ªç‰¹åˆ¶çš„HTTPå¤´éƒ¨å³å¯ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œä»“åº“ä¸­æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æŠ•æ¯’ä»£ç ã€‚æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **åŸºæœ¬ç»•è¿‡ï¼ˆv15 ä¹‹å‰ï¼‰:**  å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
2.  **é€’å½’æ·±åº¦ç»•è¿‡ï¼ˆv15.xï¼‰:** å‘ç›®æ ‡ `/admin` æˆ–å…¶ä»–å—ä¿æŠ¤çš„è·¯ç”±å‘é€ GET è¯·æ±‚ï¼Œå¹¶åœ¨ HTTP å¤´éƒ¨ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´åï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€è®¿é—®æ§åˆ¶å’Œé‡å®šå‘ï¼Œä»è€Œè®¿é—®æœªç»æˆæƒçš„èµ„æºï¼Œå¯¼è‡´æ½œåœ¨çš„æƒé™æå‡å’Œæ•°æ®æ³„éœ²ã€‚

**é¡¹ç›®åœ°å€:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #26

**æ¥æº**: [CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md](../2025/CVE-2025-29927-KamalideenAK_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.js ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå½±å“ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚ æ¼æ´åŸå› æ˜¯ Next.js ä¸­é—´ä»¶å¯¹äº `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

*   æä¾›çš„ POC ä»£ç é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ä»£ç é€šè¿‡æ¯”è¾ƒæœ‰æ— è¯¥å¤´éƒ¨æ—¶çš„å“åº”çŠ¶æ€æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢å¼•æ“ç»“æœå‡è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   POC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå…¶æ ¸å¿ƒæ˜¯æ„é€ å¸¦æœ‰ `x-middleware-subrequest` å¤´éƒ¨çš„ HTTP è¯·æ±‚ã€‚ä»£ç ä¸­åŒ…å« `rejectUnauthorized: false` ç”¨äºæµ‹è¯•è‡ªç­¾åè¯ä¹¦ç«™ç‚¹ï¼Œè¿™é™ä½äº†ä»£ç çš„å®‰å…¨æ€§ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ã€‚æ€»ä½“è€Œè¨€ï¼Œä»£ç é€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œè¯·æ±‚è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: 1` å¤´éƒ¨ï¼Œä¼ªè£…æˆ Next.js å†…éƒ¨å­è¯·æ±‚ã€‚
3.  ç”±äº Next.js å¯¹å¸¦æœ‰è¯¥å¤´éƒ¨çš„è¯·æ±‚å¤„ç†ä¸å½“ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œç»•è¿‡èº«ä»½éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #27

**æ¥æº**: [CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md](../2025/CVE-2025-29927-KaztoRay_CVE-2025-29927-Research.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ŒPOCé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` header çš„HTTPè¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ã€‚å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ¼æ´ï¼ŒæœåŠ¡å™¨å°†è¿”å›å—ä¿æŠ¤çš„å†…å®¹ï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘æˆ–æ¶æ„çš„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼š

1.  æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
2.  å‘é€è¯¥è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™ä¼šç»•è¿‡èº«ä»½éªŒè¯å¹¶è¿”å›å—ä¿æŠ¤çš„å†…å®¹ã€‚

æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹è¯¥æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ï¼Œè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ã€‚

**é¡¹ç›®åœ°å€:** [KaztoRay/CVE-2025-29927-Research](https://github.com/KaztoRay/CVE-2025-29927-Research)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #28

**æ¥æº**: [CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md](../2025/CVE-2025-29927-Knotsecurity_CVE-2025-29927-NextJs-Middleware-Simulation.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥æ ‡å¤´æ¥è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œï¼Œä»è€Œç»•è¿‡æˆæƒéªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js è¯¯å°†è¯¥è¯·æ±‚è¯†åˆ«ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œè·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ PoC ä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªæ¨¡æ‹Ÿç¯å¢ƒæ¥æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´ï¼Œè¯¥POCæä¾›äº†ä¸€ä¸ªéªŒè¯æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡burpsuiteæŠ“åŒ…æ·»åŠ `x-middleware-subrequest: middleware`è¯·æ±‚å¤´æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶è¯¥ä»£ç åº“ä¸»è¦ç”¨äºæ¼æ´æ¼”ç¤ºï¼Œä½†ä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚é£é™©ç‚¹åœ¨äºï¼š

*   **æ½œåœ¨çš„æ¶æ„ä¾èµ–ï¼š** è™½ç„¶ç›®å‰çš„ä¾èµ–çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ä¾èµ–ï¼Œä½†æœªæ¥å¯èƒ½è¢«ä½œè€…æ·»åŠ æ¶æ„ä¾èµ–ï¼Œä¾‹å¦‚åœ¨ `npm install` é˜¶æ®µæ‰§è¡Œæ¶æ„è„šæœ¬ã€‚
*   **åé—¨ä»£ç ï¼š** ä½œè€…å¯èƒ½åœ¨è¡¨é¢ä¸Šæ— å®³çš„ä»£ç ä¸­éšè—åé—¨ï¼Œä¾‹å¦‚åœ¨çœ‹ä¼¼æ­£å¸¸çš„æ—¥å¿—è®°å½•æˆ–é”™è¯¯å¤„ç†ä»£ç ä¸­æ·»åŠ æ‰§è¡Œä»»æ„ä»£ç çš„é€»è¾‘ã€‚ä¸è¿‡æ ¹æ®ä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„åé—¨ä»£ç 

ç”±äºä»£ç é‡è¾ƒå°ï¼Œä¸”ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 10%ã€‚ ä½†æ˜¯ï¼Œåœ¨å®é™…ä½¿ç”¨ä»»ä½•æ¥è‡ªä¸å¯ä¿¡æ¥æºçš„ä»£ç æ—¶ï¼Œéƒ½åº”è¯¥è¿›è¡Œå½»åº•çš„å®¡æŸ¥å’Œå®‰å…¨å®¡è®¡ã€‚

**é¡¹ç›®åœ°å€:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #29

**æ¥æº**: [CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-MKIRAHMET_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `X-Middleware-Subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚PoC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `X-Middleware-Subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¹¶æ¯”è¾ƒ baselineï¼ˆä¸å¸¦ headerï¼‰å’Œå¸¦æœ‰ header çš„è¯·æ±‚çš„å“åº”ï¼Œä»è€Œæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 ä¸”å“åº”å†…å®¹ä¸åŒï¼Œåˆ™è¡¨æ˜åº”ç”¨å¯èƒ½å­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š** PoCä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šå¤´éƒ¨ä¿¡æ¯çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´ï¼Œå¹¶æ ¹æ®å“åº”çš„å·®å¼‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š** æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚

åˆ†æï¼š
*   è¯¥ä»£ç çš„ä¸»è¦åŠŸèƒ½æ˜¯æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚
*   ä»£ç é¦–å…ˆæç¤ºç”¨æˆ·è¾“å…¥ç›®æ ‡åŸŸåï¼Œç„¶åæ„é€ åŒ…å«æ¶æ„è·¯å¾„çš„ URLã€‚
*   `X-Middleware-Subrequest` å¤´éƒ¨ç”¨äºè§¦å‘æ¼æ´ã€‚
*   ä»£ç å‘é€ä¸¤ä¸ª HTTP GET è¯·æ±‚ï¼šä¸€ä¸ªä¸å¸¦å¤´éƒ¨ï¼Œå¦ä¸€ä¸ªå¸¦ `X-Middleware-Subrequest` å¤´éƒ¨ã€‚
*   æ¯”è¾ƒä¸¤ä¸ªè¯·æ±‚çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹ã€‚å¦‚æœçŠ¶æ€ç ä¸º 200 å¹¶ä¸”å†…å®¹ä¸åŒï¼Œåˆ™è®¤ä¸ºç›®æ ‡æ˜“å—æ”»å‡»ã€‚

æŠ•æ¯’é£é™©è¯„ä¼°ï¼š

*   **README.md æ˜ç¡®å£°æ˜ä»£ç ä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œå¹¶ä¸”ä»…åº”é’ˆå¯¹æœ¬åœ°æˆ–å®éªŒç¯å¢ƒè¿è¡Œã€‚**
*   **PoC ä»£ç æœ¬èº«å¹¶ä¸åŒ…å«ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åé—¨æˆ–æ•°æ®æ³„éœ²åŠŸèƒ½ã€‚**
*   **ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯åˆ©ç”¨æ¼æ´ã€‚**
*   å­˜åœ¨ä¸€å®šçš„é£é™©ï¼šè™½ç„¶ä»£ç æœ¬èº«æ²¡æœ‰æ¶æ„ï¼Œä½†ç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤ä»£ç ï¼Œå¹¶å°†å…¶ç”¨äºæœªç»æˆæƒçš„æµ‹è¯•æˆ–æ”»å‡»ã€‚æ­¤å¤–ï¼Œå³ä½¿ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œä¹Ÿå¯èƒ½ä¼šæ„å¤–åœ°æ³„éœ²ç›®æ ‡ç³»ç»Ÿçš„ä¿¡æ¯ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `X-Middleware-Subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†è¯¥å¤´éƒ¨ï¼Œå¯¼è‡´æƒé™æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œå¦‚æ•æ„Ÿæ•°æ®æˆ–ç®¡ç†é¡µé¢ã€‚

**é¡¹ç›®åœ°å€:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #30

**æ¥æº**: [CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-MuhammadWaseem29_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ§åˆ¶ï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ”»å‡»è€…å¯èƒ½é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥å®ç°ç»•è¿‡ã€‚æä¾›çš„POCä»£ç åªåŒ…å«README.mdæ–‡ä»¶ï¼Œå†…å®¹éå¸¸ç®€å•ï¼Œä»…å£°æ˜äº†æ¼æ´å’ŒPOCä¿¡æ¯ï¼Œç¼ºä¹å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§æ— æ³•ç¡®å®šã€‚è¯¥ä»“åº“ä¸­æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºç›®å‰åªåŒ…å«READMEæ–‡ä»¶ï¼Œä½†ä»éœ€å…³æ³¨åç»­æ›´æ–°ï¼Œå­˜åœ¨è¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**é¡¹ç›®åœ°å€:** [MuhammadWaseem29/CVE-2025-29927-POC](https://github.com/MuhammadWaseem29/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #31

**æ¥æº**: [CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md](../2025/CVE-2025-29927-NS-Projects-Unina_CTF_CVE_DSP_1.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†middlewareè¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js middleware æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest`ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒã€‚

**æ¼æ´åˆ©ç”¨åˆ†æï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å‘ç”Ÿåœ¨ Next.js middleware ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆDockerfileï¼‰ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´ç¯å¢ƒçš„CTFæŒ‘æˆ˜ï¼Œå…¶ä¸­åŒ…å«äº†Webåº”ç”¨éƒ¨ç½²ï¼ŒSSHæœåŠ¡é…ç½®ï¼Œä»¥åŠæƒé™æå‡ç­‰æ­¥éª¤ã€‚è¿™ä¸ªDockerfileæœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å¤ç°è¯¥æ¼æ´çš„ç¯å¢ƒã€‚

å…·ä½“åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œå°è¯•è®¿é—®æœªç»æˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤Dockeré•œåƒçš„ä¸»è¦ç›®çš„æ˜¯åˆ›å»ºä¸€ä¸ªå¯ä¾›ç»ƒä¹ çš„CTFç¯å¢ƒï¼Œä»Dockerfileçš„å†…å®¹æ¥çœ‹ï¼Œè™½ç„¶åŒ…å«äº†ä¸€äº›ç”¨æˆ·åˆ›å»ºã€æ–‡ä»¶å¤åˆ¶ç­‰æ“ä½œï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚é£é™©ç‚¹å¯èƒ½åœ¨äºé¢„å…ˆè®¾ç½®çš„ç”¨æˆ·åå¯†ç ï¼ˆsimone/scoobydooï¼‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ©ç”¨ï¼Œä½†è¿™æ˜¯CTFæŒ‘æˆ˜çš„ä¸€éƒ¨åˆ†ï¼Œä¸ç®—æŠ•æ¯’è¡Œä¸ºã€‚è¯¥é•œåƒä¸»è¦ç”¨äºå®‰å…¨ç»ƒä¹ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ã€‚

é£é™©ç‚¹åˆ†æï¼š

1.  **é¢„è®¾å¯†ç ï¼š** ç”¨æˆ· 'simone' æ‹¥æœ‰é¢„è®¾å¯†ç  'scoobydoo'ã€‚åœ¨çœŸå®ç¯å¢ƒä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨é£é™©ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä½¿ç”¨è¯¥å¯†ç ç™»å½•ã€‚ä½†åœ¨CTFç¯å¢ƒä¸­ï¼Œè¿™é€šå¸¸æ˜¯è§£é¢˜çš„çº¿ç´¢ä¹‹ä¸€ã€‚
2.  **SUID Wrapperï¼š** `/opt/tools/archive-logs` è¢«è®¾ç½®ä¸º SUID rootã€‚å¦‚æœ `log_archiver.py` ä¸­å­˜åœ¨æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´ææƒã€‚è™½ç„¶è¿™æ˜¯ä¸€ä¸ªæƒé™æå‡çš„åˆ©ç”¨ç‚¹ï¼Œä½†åœ¨CTFç¯å¢ƒä¸­å±äºè®¾è®¡çš„ä¸€éƒ¨åˆ†ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„Dockerfileä¸»è¦æ˜¯ä¸ºäº†æ­å»ºä¸€ä¸ªCTFç¯å¢ƒï¼Œæ‰€ä»¥éœ€è¦ç»“åˆå®é™…çš„Next.jsåº”ç”¨ä»£ç æ¥éªŒè¯æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯ï¼Œè¯¥Dockerfileæä¾›äº†å¤ç°è¯¥æ¼æ´æ‰€éœ€çš„ç¯å¢ƒï¼Œå› æ­¤å…·æœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚

**é¡¹ç›®åœ°å€:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #32

**æ¥æº**: [CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md](../2025/CVE-2025-29927-Naveen-005_Next.Js-middleware-bypass-vulnerability-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½è¢«ç»•è¿‡ã€‚æ¼æ´æ ¹æºåœ¨äº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§:**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrimeï¼‰çš„åšå®¢éƒ½æåˆ°äº†è¯¥æ¼æ´ï¼Œå¹¶æè¿°äº†åˆ©ç”¨æ–¹æ³•ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºæ„é€ åŒ…å« `x-middleware-subrequest` header çš„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©:**

æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®æ¨¡æ¿ï¼ŒåŒ…å«äº† `README.md`, `jsconfig.json`, `next.config.mjs`, å’Œ `package-lock.json` ç­‰æ–‡ä»¶ã€‚`package-lock.json` æ–‡ä»¶æ˜¾ç¤ºé¡¹ç›®ä¾èµ–çš„ Next.js ç‰ˆæœ¬ä¸º 15.2.2ï¼Œè¿™æ˜¯ä¸€ä¸ªå—æ¼æ´å½±å“çš„ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œä»æä¾›çš„ä»£ç æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚ä¸‹è½½å’Œæ‰§è¡Œä»»æ„è„šæœ¬ç­‰ã€‚è™½ç„¶`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œä½†ä»æä¾›çš„æ–‡ä»¶å†…å®¹æœ¬èº«æ¥çœ‹ï¼Œç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§è¾ƒä½ã€‚æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«å€¾å‘äºéªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œè€Œéå®æ–½æ¶æ„è¡Œä¸ºï¼Œå› æ­¤æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨10%å·¦å³ã€‚

**åˆ©ç”¨æ–¹å¼:**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.js å¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­åŒ…å« `x-middleware-subrequest` headerã€‚
3.  ç”±äº Next.js å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œå—é™æ“ä½œã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§ Next.js åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #33

**æ¥æº**: [CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md](../2025/CVE-2025-29927-Nekicj_CVE-2025-29927-exploit.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”å­˜åœ¨å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡è¿™äº›éªŒè¯ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
ä»æœç´¢å¼•æ“ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œç¡®è®¤å…¶å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ä¹Ÿæä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æä¾›çš„ä»£ç åŒ…å«ä¸‰ä¸ª Python è„šæœ¬å’Œä¸€ä¸ªåŸŸååˆ—è¡¨ã€‚å…¶ä¸­ `main.py` ç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦åŸºäº Next.js æ„å»ºã€‚`sites-parser.py` æ˜¯ä¸€ä¸ªç”¨äºä» Google æœç´¢ç»“æœä¸­æå–åŸŸååˆ—è¡¨çš„çˆ¬è™«è„šæœ¬ã€‚`sites.txt` åŒ…å«ä¸€ä¸ªåŸŸååˆ—è¡¨ï¼Œç”¨äºç»™ `main.py` è¿›è¡Œæµ‹è¯•ã€‚è¿™äº›è„šæœ¬æœ¬èº«å¹¶æ²¡æœ‰ç›´æ¥åˆ©ç”¨æ¼æ´ï¼Œè€Œæ˜¯ç”¨äºå‘ç°æ½œåœ¨çš„å—å®³è€…ï¼Œå› æ­¤æä¾›çš„ä»£ç æœ¬èº«**ä¸ç›´æ¥æ˜¯POC**ï¼Œå®ƒåªæ˜¯è¾…åŠ©å‘ç°ç›®æ ‡ã€‚

è¦å®Œå…¨éªŒè¯è¯¥æ¼æ´ï¼Œéœ€è¦æ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚ï¼Œé€šå¸¸æ¶‰åŠæ“çºµ `x-middleware-subrequest` å¤´éƒ¨ï¼Œæ‰èƒ½ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚æ ¹æ®å·²æœ‰çš„ä¿¡æ¯ï¼ŒéªŒè¯ POC æœ‰æ•ˆéœ€è¦ä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ï¼Œæ ¹æ®è¯¥æ¼æ´çš„ç‰¹æ€§æ„é€  payload.

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Python è„šæœ¬å’ŒåŸŸååˆ—è¡¨æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„åé—¨æˆ–è€…æ¶æ„è¡Œä¸ºã€‚`sites-parser.py` çš„ç›®çš„æ˜¯ä» Google æœç´¢ç»“æœä¸­æå–åŸŸåï¼Œè¿™æœ¬èº«æ˜¯ä¸€ä¸ªå¸¸è§çš„ç½‘ç»œçˆ¬è™«è¡Œä¸ºã€‚`main.py` åªæ˜¯æ£€æŸ¥ç›®æ ‡æ˜¯å¦ä½¿ç”¨äº† Next.jsã€‚å› æ­¤ï¼Œå¯ä»¥è®¤ä¸ºæ­¤ä»£ç **ä¸å­˜åœ¨æŠ•æ¯’é£é™©**ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆéœ€è¦æ‰¾åˆ°ä¸€ä¸ªä½¿ç”¨å—å½±å“ç‰ˆæœ¬ Next.js çš„åº”ç”¨ï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨ï¼Œæ¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯
3.  é€šè¿‡å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å« `x-middleware-subrequest` å¤´éƒ¨æˆ–å…¶ä»–ç›¸å…³å¤´éƒ¨ä¿¡æ¯çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚
4.  ç”±äºè¯¥æ¼æ´æ˜¯æƒé™ç»•è¿‡ï¼Œåˆ©ç”¨æˆåŠŸåï¼Œæ”»å‡»è€…å¯ä»¥ä»¥æœªæˆæƒç”¨æˆ·çš„èº«ä»½æ‰§è¡Œæ“ä½œï¼Œä¾‹å¦‚è®¿é—®ç®¡ç†å‘˜é¡µé¢ã€æŸ¥çœ‹æ•æ„Ÿæ•°æ®ç­‰ã€‚

**é¡¹ç›®åœ°å€:** [Nekicj/CVE-2025-29927-exploit](https://github.com/Nekicj/CVE-2025-29927-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #34

**æ¥æº**: [CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md](../2025/CVE-2025-29927-Oyst3r1ng_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js 14.0.0 ~ 14.2.25, Next.js 15.0.0 ~ 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼šé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest` å­—æ®µï¼Œå¹¶å°†å…¶å€¼è®¾ç½®ä¸ºåŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°ï¼ˆé»˜è®¤ä¸º `middleware`ï¼Œå¯ä»¥é€šè¿‡params.nameæŸ¥çœ‹ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»è€Œè§¦å‘ Next.js ä¸­é—´ä»¶çš„é€’å½’æ·±åº¦æ£€æŸ¥ã€‚å½“é€’å½’æ·±åº¦è¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼ï¼ˆ`MAX_RECURSION_DEPTH = 5`ï¼‰æ—¶ï¼Œä¸­é—´ä»¶ä¼šè·³è¿‡è®¤è¯é€»è¾‘ï¼Œå¯¼è‡´è®¤è¯ç»•è¿‡ã€‚

POC ä»£ç é€šè¿‡å‘é€å¸¦æœ‰æ„é€ å¥½çš„ `x-middleware-subrequest` å¤´éƒ¨çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„ `/admin` è·¯å¾„æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å¦‚æœçŠ¶æ€ç ä»æ­£å¸¸è¯·æ±‚çš„çŠ¶æ€ç å˜ä¸º200ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

*   **Poc_CVE-2025-29927.pyï¼š** è¯¥ POC çœ‹èµ·æ¥ç›¸å¯¹å®‰å…¨ã€‚å®ƒä½¿ç”¨ `pocsuite3` æ¡†æ¶ï¼Œå¹¶ä¸”å…¶ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚éªŒè¯é€»è¾‘æ˜¯æ£€æŸ¥çŠ¶æ€ç æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚ æ²¡æœ‰æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚
*   **README.mdï¼š** æè¿°äº†ç¯å¢ƒæ­å»ºå’Œæ¼æ´åŸç†åˆ†æï¼Œæ²¡æœ‰å‘ç°å¯ç–‘ä»£ç ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

å°½ç®¡POCä»£ç æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†è€ƒè™‘åˆ°ä»¥ä¸‹å› ç´ ï¼Œä»å­˜åœ¨ä¸€å®šé£é™©ï¼š

1.  **ç¬¬ä¸‰æ–¹ä¾èµ–ï¼š** `pocsuite3` æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œéœ€è¦å®‰è£…ã€‚è™½ç„¶è¯¥æ¡†æ¶æœ¬èº«æ¯”è¾ƒæˆç†Ÿï¼Œä½†ä»å­˜åœ¨è¢«ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œå¦‚æœè¯¥æ¡†æ¶è¢«ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¼•å…¥æ¶æ„ä»£ç ã€‚
2.  **ç¯å¢ƒæ­å»ºï¼š** README.md ä¸­æ¶‰åŠé¡¹ç›®æºç çš„æ‘˜å–å’Œå®‰è£…ä¾èµ–ï¼Œåœ¨ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­ï¼Œå¦‚æœåœ¨å®‰è£…äº†æ¶æ„çš„ä¾èµ–åŒ…ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿè¢«æ¤å…¥åé—¨ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œè¯¥ä»“åº“å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå¤§æ¦‚ä¸º10%ã€‚è¯¥é£é™©ä¸»è¦æ¥æºäºé—´æ¥çš„ä¾›åº”é“¾æ”»å‡»æˆ–ç¯å¢ƒæ­å»ºè¿‡ç¨‹ä¸­çš„æ¶æ„ä¾èµ–åŒ…ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ„é€ åŒ…å«è¶³å¤Ÿæ•°é‡çš„ä¸­é—´ä»¶åç§°çš„ `x-middleware-subrequest` è¯·æ±‚å¤´ï¼Œä¾‹å¦‚ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  å‘å—ä¿æŠ¤çš„è·¯ç”±å‘é€åŒ…å«è¯¥è¯·æ±‚å¤´çš„è¯·æ±‚ã€‚
4.  å¦‚æœæˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œåˆ™å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [Oyst3r1ng/CVE-2025-29927](https://github.com/Oyst3r1ng/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #35

**æ¥æº**: [CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md](../2025/CVE-2025-29927-R3verseIN_Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œé‰´æƒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ã€‚å¦‚æœåº”ç”¨ç¨‹åºçš„é‰´æƒé€»è¾‘ä¾èµ–äº Next.js ä¸­é—´ä»¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥è¯·æ±‚å¤´ç»•è¿‡é‰´æƒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å±å®³è¾ƒé«˜ã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•CVE-2025-29927æ¼æ´çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå®ƒæ˜ç¡®æŒ‡å‡ºè‡ªèº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œè®¾è®¡çš„ï¼Œå› æ­¤è¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œèƒ½å¤Ÿé‡ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼ˆREADME.mdå’Œbun.lockæ–‡ä»¶ï¼‰ï¼š
*   `README.md` æ–‡ä»¶æè¿°äº†å¦‚ä½•è¿è¡Œè¯¥åº”ç”¨ç¨‹åºä»¥åŠæ¼æ´çš„æè¿°ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `bun.lock` æ–‡ä»¶æ˜¯ `bun` åŒ…ç®¡ç†å™¨çš„é”å®šæ–‡ä»¶ï¼Œç”¨äºç¡®ä¿ä¾èµ–é¡¹çš„ç‰ˆæœ¬ä¸€è‡´æ€§ï¼Œé€šå¸¸ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œä½†å¯èƒ½åŒ…å«ä¸å®‰å…¨çš„ä¾èµ–åŒ…ç‰ˆæœ¬ã€‚

ç»¼åˆæ¥çœ‹ï¼Œæ­¤ä»“åº“ä¸»è¦ç›®çš„æ˜¯å¤ç°æ¼æ´ï¼Œä½†ä¹Ÿä¸èƒ½å®Œå…¨æ’é™¤å¼•å…¥äº†å­˜åœ¨å·²çŸ¥æ¼æ´çš„ä¾èµ–åŒ…çš„å¯èƒ½æ€§ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥è¯·æ±‚ï¼Œå¯¼è‡´é‰´æƒç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927](https://github.com/R3verseIN/Nextjs-middleware-vulnerable-appdemo-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #36

**æ¥æº**: [CVE-2025-29927-RoyCampos_CVE-2025-29927.md](../2025/CVE-2025-29927-RoyCampos_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²ï¼Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å…è®¸æœªç»æˆæƒçš„æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **è¯†åˆ«ç›®æ ‡ï¼š** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„ç‰ˆæœ¬ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š**  å‘ç›®æ ‡åº”ç”¨ç¨‹åºå‘é€HTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå…¶å€¼è®¾ç½®ä¸ºç‰¹å®šçš„è·¯å¾„ï¼Œä¾‹å¦‚`pages/_middleware`ï¼Œ `pages/dashboard/_middleware`ç­‰ã€‚è¯¥è„šæœ¬æä¾›äº†å¤šä¸ªpayloadï¼Œé€šè¿‡`HEADERS`æ•°ç»„å®šä¹‰ã€‚
3.  **ç»•è¿‡æˆæƒï¼š**  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„é¡µé¢æˆ–èµ„æºã€‚
4.  **éªŒè¯ï¼š**  å¯ä»¥é€šè¿‡æ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦ç¼ºå°‘`X-Middleware-Rewrite`æˆ–`X-Middleware-Set-Cookie`å¤´æ¥åˆ¤æ–­æˆæƒæ˜¯å¦æˆåŠŸç»•è¿‡ã€‚POCä»£ç ä¼šæ£€æµ‹è¿™äº›headerï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚PoCä»£ç åˆ©ç”¨curlå‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”å¤´æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯¥PoCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹å’ŒéªŒè¯ã€‚LICENSEæ–‡ä»¶å£°æ˜ä½¿ç”¨MITå¼€æºåè®®ã€‚ä»¥ä¸‹å‡ ç‚¹é™ä½äº†æŠ•æ¯’é£é™©ï¼š

*   ä»£ç åŠŸèƒ½ç›¸å¯¹ç®€å•ï¼Œä¸»è¦ä½¿ç”¨curlå‘é€è¯·æ±‚å’Œgrepåˆ†æå“åº”ï¼Œé€»è¾‘æ¸…æ™°ã€‚
*   ä»£ç çš„ç›®çš„æ˜¯æ£€æµ‹æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚
*   ä½¿ç”¨äº†whatweb æ¥è¿›è¡Œåˆæ­¥æŒ‡çº¹è¯†åˆ«ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œæ¯”å¦‚ï¼š

*   **ä¾èµ–é£é™©ï¼š**  ä»£ç ä¾èµ–äºå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚`curl`ã€`whatweb`ç­‰ã€‚å¦‚æœè¿™äº›å‘½ä»¤è¢«æ¶æ„æ›¿æ¢ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚
*   **æ—¥å¿—æ³„éœ²ï¼š**  è„šæœ¬åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¾“å‡ºä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼ˆä¾‹å¦‚BUILD_IDï¼‰ï¼Œè™½ç„¶ä¸æ˜¯ç›´æ¥æŠ•æ¯’ï¼Œä½†å¯èƒ½ä¸ºæ”»å‡»è€…æä¾›ä¾¿åˆ©ã€‚

ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦åœ¨10%å·¦å³ã€‚ä¸»è¦çš„é£é™©åœ¨äºå¯¹å¤–éƒ¨å‘½ä»¤çš„ä¾èµ–æ€§ï¼Œä»¥åŠæ½œåœ¨çš„æ—¥å¿—ä¿¡æ¯æ³„éœ²ï¼Œå› æ­¤ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„ç¯å¢ƒå®‰å…¨ã€‚


**é¡¹ç›®åœ°å€:** [RoyCampos/CVE-2025-29927](https://github.com/RoyCampos/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #37

**æ¥æº**: [CVE-2025-29927-Slvignesh05_CVE-2025-29927.md](../2025/CVE-2025-29927-Slvignesh05_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²æˆ–ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest` headerç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…é¦–å…ˆæ¢æµ‹æœåŠ¡å™¨æ˜¯å¦æ”¯æŒ`X-Nextjs-Data`header,å¦‚æœæ”¯æŒï¼Œå°±å‘é€ç²¾å¿ƒæ„é€ çš„åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æ­¤headeråŒ…å«ä¸€é•¿ä¸²`src/middleware`å­—ç¬¦ä¸²,å¯¼è‡´ä¸­é—´ä»¶å¤„ç†é€»è¾‘å‡ºç°é—®é¢˜ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯,è¯»å–æœªæˆæƒçš„èµ„æºã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºè¯¥POCä¸»è¦æ˜¯åˆ©ç”¨ç‰¹å®šçš„headerç»•è¿‡éªŒè¯ï¼Œæ²¡æœ‰æ˜æ˜¾çš„åé—¨ä»£ç ï¼Œä½†æ˜¯å­˜åœ¨æä½çš„é£é™©ï¼Œå¦‚æœNext.jsåº”ç”¨å¼€å‘è€…ä½¿ç”¨äº†æŸäº›ä¸å®‰å…¨çš„ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶æˆ–è€…è‡ªå®šä¹‰ä¸­é—´ä»¶é€»è¾‘å­˜åœ¨æ¼æ´ï¼Œæ”»å‡»è€…å¯èƒ½åˆ©ç”¨æ­¤æ¼æ´ä½œä¸ºè·³æ¿è¿›è¡Œè¿›ä¸€æ­¥çš„æ”»å‡»ã€‚

**é¡¹ç›®åœ°å€:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #38

**æ¥æº**: [CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-SugiB3o_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927 Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Headerï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ PoC ä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ `x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œä¸»è¦åŒ…å«ï¼š
* `README.md`: æ¼æ´å¤ç°è¯´æ˜æ–‡æ¡£
* `jsconfig.json`:  JSé…ç½®
* `middleware.js`: ä¸­é—´ä»¶æƒé™éªŒè¯ï¼ŒéªŒè¯authorizationæ˜¯å¦ä¸º`my-jwt-token-here`ï¼Œå¦åˆ™è¿”å›401
* `next.config.mjs`: Next.js é…ç½®æ–‡ä»¶
* `package-lock.json`:  ä¾èµ–åŒ…ä¿¡æ¯

PoCä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–è€…åé—¨ã€‚éªŒè¯é€»è¾‘æ¯”è¾ƒæ¸…æ™°ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` Headerç»•è¿‡éªŒè¯ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œè¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨ Next.js ä¸­é—´ä»¶æ¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šæ ¼å¼ `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ï¼Œ ä¾‹å¦‚ï¼š`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`ã€‚
3.  å¦‚æœNext.jsç‰ˆæœ¬å°äº14.2.25å’Œ15.2.3ï¼Œä¸”ç¬¦åˆå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ï¼Œåˆ™ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…ä»è€Œå¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #39

**æ¥æº**: [CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md](../2025/CVE-2025-29927-TheresAFewConors_CVE-2025-29927-Testing.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å­˜åœ¨å¯åˆ©ç”¨çš„PoCã€‚æä¾›çš„PowerShellè„šæœ¬æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚è¯¥è„šæœ¬é€šè¿‡æ£€æŸ¥`x-powered-by`å¤´æ¥ç¡®å®šæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œç„¶åå°è¯•ä»é™æ€èµ„æºä¸­æå–Next.jsç‰ˆæœ¬ï¼Œå¹¶å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å®ƒå‘é€ä¸€ä¸ªç‰¹å®šçš„HTTPå¤´ (`x-middleware-subrequest`)ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚å°½ç®¡ä»£ç æœ¬èº«çœ‹èµ·æ¥æ˜¯ä¸ºäº†å®‰å…¨æµ‹è¯•ç›®çš„è€Œç¼–å†™çš„ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶è¾ƒä½ï¼š

*   **ä¾èµ–é£é™©ï¼š** å¦‚æœè¯¥è„šæœ¬ä¾èµ–äºå¤–éƒ¨æ¨¡å—æˆ–æœåŠ¡ï¼Œè¿™äº›å¤–éƒ¨ä¾èµ–å¯èƒ½è¢«æ¶æ„ç¯¡æ”¹ã€‚
*   **è¯¯æŠ¥/æ¼æŠ¥ï¼š** è„šæœ¬å¯èƒ½å­˜åœ¨è¯¯æŠ¥æˆ–æ¼æŠ¥ï¼Œå¯¼è‡´ç”¨æˆ·å¯¹ç³»ç»Ÿçš„å®‰å…¨çŠ¶æ€äº§ç”Ÿé”™è¯¯çš„åˆ¤æ–­ã€‚æ”»å‡»è€…å¯èƒ½åˆ©ç”¨è¿™äº›ä¿¡æ¯å‘èµ·æ”»å‡»ã€‚
*   **æ»¥ç”¨ï¼š** æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬æ‰«æå¤§é‡Next.jsåº”ç”¨ï¼Œå¯»æ‰¾å­˜åœ¨æ¼æ´çš„ç›®æ ‡ã€‚
*   **ä»£ç æ··æ·†ï¼š** å°½ç®¡å½“å‰ä»£ç æ¸…æ™°æ˜“æ‡‚ï¼Œæœªæ¥çš„ç‰ˆæœ¬å¯èƒ½ä¼šåŠ å…¥æ··æ·†æˆ–æ¶æ„ä»£ç ï¼Œå¢åŠ æŠ•æ¯’é£é™©ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ï¼š** å¯ä»¥é€šè¿‡HTTPå“åº”å¤´ï¼ˆå¦‚`x-powered-by`ï¼‰æˆ–åˆ†æé™æ€JavaScriptæ–‡ä»¶æ¥ç¡®å®šã€‚
2.  **å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼š**  æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: anything`ã€‚å¦‚æœä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯¥è¯·æ±‚å¯èƒ½ä¼šç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **éªŒè¯æ˜¯å¦æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼š** æ£€æŸ¥å“åº”çŠ¶æ€ç å’Œå†…å®¹ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸè®¿é—®äº†æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°å·²ä¿®å¤æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
*   åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯æˆ–åˆ é™¤`x-middleware-subrequest`å¤´ã€‚
*   å¢å¼ºèº«ä»½éªŒè¯æœºåˆ¶ï¼Œé¿å…ä»…ä»…ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œå®‰å…¨æ£€æŸ¥ã€‚
*   é™åˆ¶ä¸­é—´ä»¶çš„ä½œç”¨èŒƒå›´ï¼Œä»…åº”ç”¨äºå¿…è¦çš„è·¯å¾„ã€‚
*   ç›‘æ§å’Œè®°å½•ä¸ä¸­é—´ä»¶ç»•è¿‡å°è¯•ç›¸å…³çš„å¯ç–‘æ´»åŠ¨ã€‚

**é¡¹ç›®åœ°å€:** [TheresAFewConors/CVE-2025-29927-Testing](https://github.com/TheresAFewConors/CVE-2025-29927-Testing)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #40

**æ¥æº**: [CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md](../2025/CVE-2025-29927-UNICORDev_exploit-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js æ¡†æ¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æœ¬åŸå› æ˜¯ Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚ 

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ‰æ•ˆã€‚æ¼æ´åº“å’Œæœç´¢ç»“æœéƒ½è¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªå…³é”®çš„æƒé™ç»•è¿‡æ¼æ´ï¼Œè€Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸“é—¨é’ˆå¯¹æ­¤æ¼æ´ï¼Œé€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æŸ¥çœ‹æä¾›çš„ exploit-CVE-2025-29927.py è„šæœ¬ï¼Œä»£ç ä¸»è¦åŠŸèƒ½æ˜¯ï¼š

1.  å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ã€‚
2.  æ ¹æ®ç›®æ ‡ URL å’Œå¯é€‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œæ„é€ ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚
3.  æ£€æµ‹Next.js ç‰ˆæœ¬ï¼Œé’ˆå¯¹ä¸åŒç‰ˆæœ¬å‘é€ç‰¹åˆ¶Headerã€‚

é£é™©ä¸»è¦æ¥è‡ªä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©:** è„šæœ¬ä¾èµ–äº `requests` åº“ï¼Œå¦‚æœç”¨æˆ·é€šè¿‡éå®˜æ–¹æ¸ é“å®‰è£…è¯¥åº“ï¼Œå¯èƒ½å­˜åœ¨è¢«ç¯¡æ”¹çš„é£é™©ã€‚
2.  **ç›®æ ‡ç¯å¢ƒé£é™©:** è¯¥è„šæœ¬éœ€è¦åœ¨ç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ¼æ´çš„æƒ…å†µä¸‹æ‰èƒ½ç”Ÿæ•ˆã€‚å¦‚æœç›®æ ‡åº”ç”¨å·²ç»ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¿è¡Œè¯¥è„šæœ¬ä¸ä¼šäº§ç”Ÿé¢„æœŸæ•ˆæœï¼Œä½†ä»å¯èƒ½ç•™ä¸‹æ”»å‡»ç—•è¿¹ã€‚

ä»£ç æœ¬èº«æœªå‘ç°æ¶æ„è¡Œä¸ºï¼Œå¦‚åå¼¹ shellã€æ¤å…¥åé—¨ç­‰ã€‚ä½†ä»å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨ä»£ç ä¸­æ·»åŠ éšè”½çš„æ¶æ„ä»£ç ï¼Œåˆ©ç”¨è¯¥æ¼æ´åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** ç¡®å®šä½¿ç”¨ Next.js ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…çš„åº”ç”¨ç¨‹åºã€‚
2.  **è¿è¡ŒPoCè„šæœ¬ï¼š** ä½¿ç”¨æä¾›çš„ `exploit-CVE-2025-29927.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡ URLã€‚
3.  **ç»•è¿‡è®¤è¯ï¼š** è„šæœ¬ä¼šå‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æˆåŠŸç»•è¿‡æƒé™æ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #41

**æ¥æº**: [CVE-2025-29927-ValGrace_middleware-auth-bypass.md](../2025/CVE-2025-29927-ValGrace_middleware-auth-bypass.md)

## CVE-2025-29927-Next.js-Middleware-è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´çš„å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥æ ‡å¤´çš„æ¶æ„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ã€é«˜å±çš„æ¼æ´ã€‚æä¾›çš„POCä»£ç ï¼ˆmiddleware-auth-bypassï¼‰è¡¨æ˜è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„POCä»£ç åªåŒ…å«LICENSEå’ŒREADME.mdæ–‡ä»¶ï¼Œä»ç›®å‰çš„ä»£ç æ¥çœ‹æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ç”±äºç¼ºå°‘æ¼æ´åˆ©ç”¨çš„expä»£ç ï¼Œæ— æ³•åšæ›´æ·±åº¦çš„åˆ†æã€‚ä½†æ˜¯ä»“åº“ä¸­å¯èƒ½å­˜åœ¨éšè—çš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…æˆ–é…ç½®è¿‡ç¨‹ä¸­å¼•å…¥æ¶æ„ä¾èµ–æˆ–æ‰§è¡Œæ¶æ„è„šæœ¬ã€‚ æ•…æŠ•æ¯’é£é™©è¯„å®šä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  å¦‚æœNext.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥å¯èƒ½è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒåœ°è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
4.  ç¼“è§£æªæ–½åŒ…æ‹¬å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #42

**æ¥æº**: [CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md](../2025/CVE-2025-29927-YEONDG_nextjs-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚PoCä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡è®¾ç½®`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡èº«ä»½éªŒè¯ä¸­é—´ä»¶ï¼Œä»è€Œè®¿é—®`/api/protected`ç«¯ç‚¹ã€‚æœç´¢å¼•æ“ç»“æœä¸­çš„å¤šä¸ªåšå®¢æ–‡ç« å’Œå®‰å…¨å…¬å‘Šéƒ½ç¡®è®¤äº†æ­¤æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä»“åº“ä¸»è¦åŒ…å«ç”¨äºæ¼”ç¤ºå’ŒéªŒè¯æ¼æ´çš„ç»„ä»¶ä»¥åŠç›¸å…³çš„é…ç½®æ–‡ä»¶ã€‚ä»£ç é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œä¸»è¦ç”¨äºæ­å»ºä¸¤ä¸ªç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼ˆä¸€ä¸ªæ˜“å—æ”»å‡»ï¼Œä¸€ä¸ªå·²ä¿®å¤ï¼‰ã€‚
* `README.md`: æä¾›äº†æ¼æ´çš„æè¿°ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ï¼Œæœªå‘ç°å¯ç–‘ä»£ç ã€‚
* `package.json`: åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–é¡¹ï¼Œéƒ½æ˜¯å¸¸è§çš„å¼€å‘å’Œæ„å»ºå·¥å…·ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä¾èµ–ã€‚
* `pnpm-lock.yaml`:  é”å®šäº†ä¾èµ–ç‰ˆæœ¬ï¼Œæœ‰åŠ©äºç¡®ä¿æ„å»ºçš„å¯é‡å¤æ€§ã€‚æ£€æŸ¥ä¾èµ–é¡¹çš„å®Œæ•´æ€§ååˆ†é‡è¦ï¼Œè¿™é‡Œå‡è®¾ pnpm-lock.yaml æ–‡ä»¶æ˜¯å¹²å‡€çš„ã€‚
* `/apps/next15_1_7/` å’Œ `/apps/next15_2_4/`:  åŒ…å«äº†Next.jsåº”ç”¨ç¨‹åºçš„ä»£ç ã€‚ éœ€è¦å®¡è®¡è¿™äº›åº”ç”¨ç¨‹åºçš„ä»£ç ï¼Œä»¥æŸ¥æ‰¾æ½œåœ¨çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚é€šå¸¸ï¼Œåº”è¯¥å…³æ³¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š
   * ä¸å¸¸è§çš„æˆ–è€…æ··æ·†çš„ä»£ç 
   *  åŠ¨æ€ä»£ç æ‰§è¡Œ (`eval`, `Function` æ„é€ å‡½æ•°ç­‰)
   *  æœªç»æ£€æŸ¥çš„ç”¨æˆ·è¾“å…¥
   *  ä¸å¤–éƒ¨æœåŠ¡çš„å¯ç–‘äº¤äº’

è™½ç„¶ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ï¼Œä½†ä»ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ã€‚å› æ­¤ï¼Œå»ºè®®è¿›è¡Œå½»åº•çš„ä»£ç å®¡æŸ¥ï¼Œä»¥ç¡®è®¤ä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚
æ€»ä½“è€Œè¨€ï¼Œè¯¥å­˜å‚¨åº“ä¸­å­˜åœ¨æ¶æ„ä»£ç çš„é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
3.  å¦‚æœå¤´éƒ¨çš„å€¼æ„é€ å¾—å½“ï¼ˆä¾‹å¦‚ï¼Œå¤šæ¬¡é‡å¤`middleware:`ï¼‰ï¼ŒNext.jsçš„ä¸­é—´ä»¶é€»è¾‘ä¼šè¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œä¾‹å¦‚APIç«¯ç‚¹æˆ–é¡µé¢ï¼Œè€Œæ— éœ€æä¾›æœ‰æ•ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚

**é¡¹ç›®åœ°å€:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #43

**æ¥æº**: [CVE-2025-29927-a9v8i_CVE-2025-29927.md](../2025/CVE-2025-29927-a9v8i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œæ¼æ´åŸç†æ˜¯ç”±äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œä½¿å¾—æ¶æ„ç”¨æˆ·å¯ä»¥åˆ©ç”¨è¯¥å¤´ç»•è¿‡æˆæƒé€»è¾‘ã€‚æ¼æ´åˆ©ç”¨ä»£ç åªåŒ…å«Apache License 2.0åè®®å†…å®¹ï¼Œå±äºæ­£å¸¸å¼€æºåè®®æ–‡æœ¬ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„ `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [a9v8i/CVE-2025-29927](https://github.com/a9v8i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #44

**æ¥æº**: [CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md](../2025/CVE-2025-29927-aayush256-sys_next-js-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æƒé™ç»•è¿‡æ¼æ´ã€‚å½“æƒé™éªŒè¯é€»è¾‘å­˜åœ¨äº Next.js ä¸­é—´ä»¶æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„Next.jsåº”ç”¨ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ªå—ä¿æŠ¤çš„ `/admin` è·¯ç”±ï¼Œè¯¥è·¯ç”±å—åˆ°ä¸­é—´ä»¶ä¿æŠ¤ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†åˆ©ç”¨ `x-middleware-subrequest` è¯·æ±‚å¤´ç»•è¿‡ä¸­é—´ä»¶éªŒè¯è®¿é—® `/admin` è·¯ç”±çš„æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¤šç§åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬æµè§ˆå™¨æ‰©å±•ã€JavaScript Consoleã€cURLå’ŒPython Requestsã€‚

**æŠ•æ¯’é£é™©ï¼š**

è¯„ä¼°POCä»£ç ï¼Œå‘ç°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ 5%ã€‚ ä¸»è¦é£é™©ç‚¹å¯èƒ½å­˜åœ¨äºå¼€å‘è€…å¯¹POCä»£ç çš„ä¾èµ–ä»¥åŠåæœŸä¿®æ”¹ï¼Œä½†ä»æä¾›çš„ä»£ç æœ¬èº«æ¥çœ‹ï¼Œé™¤äº†æ¼”ç¤ºæ¼æ´åˆ©ç”¨å¤–ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æˆ–éšè—çš„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚** æ ¹æ®Next.jsç‰ˆæœ¬ï¼Œ`x-middleware-subrequest`å¤´çš„å€¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ `middleware`ã€`src/middleware` æˆ– `middleware:middleware:middleware:middleware:middleware`ã€‚
2.  **ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚** é€šè¿‡å‘é€åŒ…å«ä¸Šè¿°å¤´çš„è¯·æ±‚ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚** æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®ä¾‹å¦‚`/admin`ä¹‹ç±»çš„å—ä¿æŠ¤è·¯ç”±ï¼Œå¹¶æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ°Next.js 15.2.3+ (14.2.25+ for 14.x)ã€‚
*   åœ¨ä»£ç†/CDNçº§åˆ«é˜»æ­¢`x-middleware-subrequest`è¯·æ±‚å¤´ã€‚
*   å®æ–½é¢å¤–çš„æœåŠ¡å™¨ç«¯éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [aayush256-sys/next-js-auth-bypass](https://github.com/aayush256-sys/next-js-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #45

**æ¥æº**: [CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-adjscent_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æä¾›çš„POCä»£ç ï¼Œé€šè¿‡å¤šæ¬¡åµŒå¥—middlewareåˆ°`x-middleware-subrequest`å¤´ä¸­å¯ä»¥ç»•è¿‡è®¤è¯ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è¿˜æåˆ°äº†é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬ï¼Œè¯¥headerçš„å‚æ•°æœ‰å¤šç§å½¢å¼ï¼Œä¾‹å¦‚`middleware`ã€`src/middleware`ã€`_middleware`ç­‰ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä»ç›®å‰ä»£ç æ¥çœ‹ï¼Œè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©ä¸º0%, æœªå‘ç°æ¶æ„ä»£ç ï¼Œä¸»è¦æä¾›äº†æ¼æ´å¤ç°æ–¹æ³•å’Œä¸åŒç‰ˆæœ¬Next.jsçš„payloadã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œä»¥åŠå—åˆ°å½±å“çš„Next.jsç‰ˆæœ¬èŒƒå›´ã€‚å¤šä¸ªæ¥æºå¼ºè°ƒäº†`x-middleware-subrequest` headeråœ¨æ¼æ´åˆ©ç”¨ä¸­çš„ä½œç”¨ã€‚

**é¡¹ç›®åœ°å€:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #46

**æ¥æº**: [CVE-2025-29927-alastair66_CVE-2025-29927.md](../2025/CVE-2025-29927-alastair66_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº† Next.js ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”æœªå¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´è¿›è¡Œæ­£ç¡®æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js æ¡†æ¶ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ ¹æ®æœç´¢ç»“æœï¼Œæ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ–¹å¼å­˜åœ¨ç¼ºé™·ã€‚è¯¥å¤´éƒ¨åŸæœ¬ç”¨äºé˜²æ­¢æ— é™é‡å®šå‘ï¼Œä½†å¯ä»¥è¢«æ»¥ç”¨ä»¥ç»•è¿‡è®¤è¯ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
POCä»£ç çš„æœ‰æ•ˆæ€§éœ€è¦è¿›ä¸€æ­¥éªŒè¯ã€‚æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªåŒ…å«æ¼æ´IDå’Œæè¿°ä¿¡æ¯çš„ `README.md` æ–‡ä»¶ï¼Œå¹¶æ²¡æœ‰åŒ…å«ä»»ä½•å®é™…çš„æ”»å‡»ä»£ç ã€‚ ä½†æ˜¯æ ¹æ®æœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
`README.md` æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ç›´æ¥æŠ•æ¯’çš„é£é™©è¾ƒä½ï¼Œè¯„ä¼°æŠ•æ¯’é£é™©ä¸º10%ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç¯¡æ”¹äº†åŒ…å« `README.md` æ–‡ä»¶çš„æ•´ä¸ªé¡¹ç›®ä»“åº“ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æ¶æ„ä»£ç ï¼Œåˆ™å­˜åœ¨æŠ•æ¯’çš„å¯èƒ½ã€‚å› æ­¤ï¼Œä½¿ç”¨è¯¥ä»“åº“éœ€è¦è°¨æ…ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  ç”±äº Next.js ä¸­é—´ä»¶å¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´è®¤è¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§ Next.js åˆ°å®‰å…¨ç‰ˆæœ¬ (>= 14.2.25 æˆ– >= 15.2.3)ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œåˆ™éœ€è¦å¯¹æ‰€æœ‰åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚è¿›è¡Œè¿‡æ»¤ï¼Œç¡®ä¿å…¶æ— æ³•åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alastair66/CVE-2025-29927](https://github.com/alastair66/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #47

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** Next.js 11.1.4 ~ 13.5.6, Next.js > 14.0.0 < 14.2.25, Next.js > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ï¼Œèƒ½é€šè¿‡å‘é€å¸¦æœ‰'x-middleware-subrequest'çš„è¯·æ±‚ç»•è¿‡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ¼æ´åŸå› æ˜¯ Next.js åœ¨å¤„ç†å¸¦æœ‰ `x-middleware-subrequest` header çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å¤±æ•ˆã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„POCæ˜¯æœ‰æ•ˆçš„ï¼Œå¯ä»¥å®ç°æƒé™ç»•è¿‡ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ª KQL (Kusto Query Language) æŸ¥è¯¢è¯­å¥ï¼Œç”¨äºåœ¨ Azure Diagnostics ä¸­æŸ¥æ‰¾ä¸æ­¤æ¼æ´ç›¸å…³çš„å¯ç–‘è¡Œä¸ºã€‚å®ƒæŸ¥æ‰¾åŒ…å«ç‰¹å®šè·¯å¾„ï¼ˆä¾‹å¦‚`/api/auth`, `/middleware-bypass`, `/unauthorized-access`ï¼‰çš„è¯·æ±‚ï¼Œæ¥è‡ªç‰¹å®šIPåœ°å€æˆ–å…·æœ‰ç‰¹å®šç”¨æˆ·ä»£ç†ï¼ˆä¾‹å¦‚ `curl`, `wget`, `python-requests`ï¼‰çš„è¯·æ±‚ã€‚æ­¤ä»£ç æœ¬èº«ä¸æ˜¯æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè€Œæ˜¯ç”¨äºæ£€æµ‹æ”»å‡»çš„æ—¥å¿—åˆ†ææŸ¥è¯¢ã€‚å› æ­¤ï¼Œè¯¥ä»£ç ä¸åŒ…å«ä»»ä½•æ¶æ„payloadï¼Œæ²¡æœ‰æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: true` (æˆ–å…¶ä»–ç±»ä¼¼çš„å€¼)ã€‚
2.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ° Next.js åº”ç”¨ã€‚
3.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å½±å“ï¼Œæ— æ³•æ­£ç¡®æ‰§è¡Œæƒé™æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æƒé™éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ–¹æ³•ç®€å•ï¼Œå±å®³æ€§é«˜ï¼Œä¿®å¤æ–¹æ³•ä¸ºå‡çº§Next.jsè‡³å®‰å…¨ç‰ˆæœ¬æˆ–è¿‡æ»¤åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927](https://github.com/aleongx/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #48

**æ¥æº**: [CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md](../2025/CVE-2025-29927-aleongx_CVE-2025-29927_Scanner.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨middlewareä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` headeræ¥ç»•è¿‡æˆæƒéªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œä¾‹å¦‚`/dashboard`ã€`/admin`ç­‰ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsæœåŠ¡å™¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…è®¾ç½®`x-middleware-subrequest` headerï¼Œå¹¶èµ‹äºˆç‰¹å®šçš„payloadï¼Œè¯¥payloadæ—¨åœ¨æ¬ºéª—æˆ–ç»•è¿‡middlewareä¸­çš„æˆæƒæ£€æŸ¥é€»è¾‘ã€‚
3.  æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯`x-middleware-subrequest` headerï¼Œå¯¼è‡´æˆæƒç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–é¡µé¢ã€‚

**POCæœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒä¼šæ£€æµ‹å“åº”çŠ¶æ€ç ä»¥åŠå“åº”å†…å®¹ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿè·¯å¾„ï¼Œä»è€Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥POCä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œç”¨äºå‘é€ç‰¹å®šheaderå¹¶åˆ†æå“åº”ã€‚`README.md` æ–‡ä»¶æè¿°äº†è¯¥æ¼æ´çš„åŸç†å’Œåˆ©ç”¨æ–¹å¼ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚æŠ•æ¯’é£é™©æä½ã€‚å­˜åœ¨å¾ˆä½çš„æ¦‚ç‡è¢«æ¤å…¥åé—¨ï¼Œä½†æ˜¯å¯èƒ½æ€§å¾ˆå°ï¼Œå°äº1%ã€‚

**é¡¹ç›®åœ°å€:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #49

**æ¥æº**: [CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-alihussainzada_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** å—å½±å“ç‰ˆæœ¬çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”ä½¿ç”¨äº†NextAuthä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäºå¯¹ `x-middleware-subrequest` HTTP header å¤„ç†ä¸å½“ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥headerç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. æ”»å‡»è€…å‘ç›®æ ‡ Next.js åº”ç”¨å‘é€ç‰¹åˆ¶çš„ HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ç²¾å¿ƒæ„é€ çš„ `x-middleware-subrequest` headerã€‚
2. Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºheaderçš„æ¬ºéª—æ€§å†…å®¹ï¼Œé”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æ¥è‡ªå†…éƒ¨å­è¯·æ±‚ã€‚
3. ä¸­é—´ä»¶è·³è¿‡æ­£å¸¸çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4. æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„POCä»£ç ï¼Œä¸»è¦åŒ…å« Dockerfileã€README.mdã€middleware.jsã€package.jsonã€globals.cssã€_app.js å’Œ dashboard.js ç­‰æ–‡ä»¶ã€‚è¿™äº›æ–‡ä»¶æ„æˆäº†ä¸€ä¸ªåŸºäº Next.js å’Œ NextAuth çš„ç®€å•èº«ä»½éªŒè¯ç¤ºä¾‹ï¼Œç”¨äºæ¼”ç¤º CVE-2025-29927 æ¼æ´çš„åˆ©ç”¨ã€‚

Dockerfile ç”¨äºæ„å»º Docker é•œåƒï¼Œæ–¹ä¾¿éƒ¨ç½²å’Œæµ‹è¯•ã€‚
README.md æä¾›äº†æ¼æ´æè¿°ã€å½±å“ç‰ˆæœ¬ã€å¤ç°æ­¥éª¤å’Œå‚è€ƒé“¾æ¥ã€‚
middleware.js æ˜¯æ ¸å¿ƒï¼Œå®ç°äº†å¸¦æˆæƒçš„ä¸­é—´ä»¶é€»è¾‘ã€‚åˆ©ç”¨æ–¹å¼å³é€šè¿‡ä¼ªé€ `X-Middleware-Subrequest`è¯·æ±‚å¤´ï¼Œç»•è¿‡å…¶ä¸­çš„`authorized`é‰´æƒå‡½æ•°ã€‚è¯¥é‰´æƒå‡½æ•°åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ï¼Œtokenä¸å­˜åœ¨åˆ™redirectåˆ°ç™»å½•é¡µé¢ã€‚
package.json å®šä¹‰äº†é¡¹ç›®ä¾èµ–ï¼ŒåŒ…æ‹¬ nextã€reactã€react-domã€next-auth å’Œ bcryptjsã€‚
globals.css å®šä¹‰äº†å…¨å±€æ ·å¼ã€‚
_app.js ä½¿ç”¨ SessionProvider åŒ…è£¹äº†æ•´ä¸ªåº”ç”¨ï¼Œä»¥ä¾¿åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ sessionã€‚
dashboard.js æ˜¯ä¸€ä¸ªå—ä¿æŠ¤çš„é¡µé¢ï¼Œéœ€è¦ç™»å½•æ‰èƒ½è®¿é—®ã€‚å¦‚æœæœªç™»å½•ï¼Œåˆ™ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚

æ€»ä½“è€Œè¨€ï¼Œæä¾›çš„ä»£ç ä¸»è¦æ˜¯ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä»£ç ä¸­ bcryptjs ç”¨äºå¯†ç åŠ å¯†å“ˆå¸Œå­˜å‚¨ï¼Œæ˜¯å¸¸è§„æ“ä½œã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ¥è‡ªäºä¾èµ–é¡¹ï¼Œä½†éœ€è¦è¿›ä¸€æ­¥åˆ†æè¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å·²çŸ¥æ¼æ´ã€‚æ­¤å¤–ï¼Œä¸æ’é™¤ä½œè€…å¯èƒ½åœ¨å…¶ä»–åˆ†æ”¯æˆ– commit ä¸­å¼•å…¥æ¶æ„ä»£ç ï¼Œä½†æ ¹æ®ç›®å‰æä¾›çš„æ–‡ä»¶ï¼Œ**æŠ•æ¯’é£é™©è¾ƒä½ï¼Œé¢„ä¼°ä¸º10%**ã€‚ä¸»è¦æ˜¯å› ä¸ºä»£ç æ¯”è¾ƒæ¸…æ™°ï¼Œæ ¸å¿ƒæ¼æ´åˆ©ç”¨æ–¹å¼ä¹Ÿæ¯”è¾ƒæ˜ç¡®ã€‚å¦‚æœä½œè€…æƒ³æŠ•æ¯’ï¼Œå¯èƒ½éœ€è¦åœ¨æ›´éšè”½çš„åœ°æ–¹ï¼Œå¦‚ä¾èµ–é¡¹æˆ–æ„å»ºè„šæœ¬ä¸­åŠ¨æ‰‹è„šã€‚

**POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç åˆ©ç”¨äº† `x-middleware-subrequest` header æ¥ç»•è¿‡ NextAuth ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚è¯¥PoCé‡ç°äº† CVE-2025-29927 æ¼æ´ï¼Œå…·æœ‰è¾ƒé«˜çš„æœ‰æ•ˆæ€§ï¼Œå¯ä»¥è¯æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨å¹¶å¯ä»¥è¢«åˆ©ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [alihussainzada/CVE-2025-29927-PoC](https://github.com/alihussainzada/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #50

**æ¥æº**: [CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md](../2025/CVE-2025-29927-amalpvatayam67_day10-nextjs-middleware-lab.md)

## CVE-2025-29927-Next.js Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsåº”ç”¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚å½“åº”ç”¨ä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒæ—¶ï¼Œå¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®šå­—ç¬¦ä¸²ï¼ˆ'admin'ï¼‰çš„è¯·æ±‚å¤´ï¼ˆx-tokenï¼‰æ¥ç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç æ˜ç¡®åœ°æ¨¡æ‹Ÿäº†è¯¥æ¼æ´çš„åˆ©ç”¨ã€‚`middleware.js` æ–‡ä»¶ä¸­çš„æƒé™æ ¡éªŒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œå®ƒé”™è¯¯åœ°ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥ `x-token` å¤´æ˜¯å¦åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚è¿™ä½¿å¾—æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« 'admin' å­å­—ç¬¦ä¸²çš„ä»»æ„ `x-token` å¤´æ¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚

`exploit.sh` è„šæœ¬æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡å‘é€å¸¦æœ‰ `x-token: ZADMINZ` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶éªŒè¯å¹¶è®¿é—® `/admin` è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

æ­¤ä»“åº“çš„ç›®çš„æ˜¯ä¸ºäº†æ•™è‚²æ¼”ç¤º CVE-2025-29927 æ¼æ´ï¼Œ`DISCLAIMER.md` æ–‡ä»¶ä¹Ÿå¼ºè°ƒäº†è¿™ä¸€ç‚¹ã€‚ä»£ç åº“æœ¬èº«æ²¡æœ‰å‘ç°æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘ shell æˆ–å…¶ä»–æ¶æ„åŠŸèƒ½ã€‚æ‰€æœ‰è„šæœ¬å’Œé…ç½®æ–‡ä»¶éƒ½ç”¨äºæ¼”ç¤ºå’Œåˆ©ç”¨æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsã€‚
2.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”ä¸­é—´ä»¶çš„å®ç°æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¾‹å¦‚ä½¿ç”¨äº† `includes()` æ–¹æ³•æ¥æ£€æŸ¥è¯·æ±‚å¤´ã€‚
3.  æ”»å‡»è€…å‘é€ä¸€ä¸ªHTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«ä¸€ä¸ª `x-token` å¤´ï¼Œè¯¥å¤´çš„å€¼åŒ…å« 'admin' å­—ç¬¦ä¸²ã€‚
4.  ç”±äºä¸­é—´ä»¶çš„é”™è¯¯å®ç°ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜äº†æ­¤æ¼æ´çš„ä¸¥é‡æ€§å’Œåˆ©ç”¨çš„ç®€æ˜“æ€§ï¼Œå¤šä¸ªæ–‡ç« å¼ºè°ƒäº†å¯ä»¥é€šè¿‡æ­¤æ¼æ´ç»•è¿‡èº«ä»½éªŒè¯å¹¶å¯èƒ½å¯¼è‡´ç¼“å­˜æŠ•æ¯’ã€‚

**é¡¹ç›®åœ°å€:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #51

**æ¥æº**: [CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md](../2025/CVE-2025-29927-amitlttwo_Next.JS-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´åŸç†ï¼š**  Next.js åœ¨å¤„ç†å†…éƒ¨å­è¯·æ±‚æ—¶ï¼Œå¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥å¤±æ•ˆã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„ HTTP è¯·æ±‚ï¼Œå‘é€åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
3.  **å½±å“ï¼š**  æˆåŠŸåˆ©ç”¨æ­¤æ¼æ´å¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„ç”¨æˆ·è®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚
4.  **ç¼“è§£æªæ–½ï¼š**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚ã€‚
5.  **POCåˆ†æï¼š** æä¾›çš„Goä»£ç æ˜¯ä¸€ä¸ªNext.jsç‰ˆæœ¬æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€HTTPè¯·æ±‚å¹¶æ£€æŸ¥å“åº”å¤´æˆ–å†…å®¹æ¥æ£€æµ‹ç›®æ ‡URLæ˜¯å¦è¿è¡ŒNext.jsï¼Œå¹¶å°è¯•ç¡®å®šå…¶ç‰ˆæœ¬ã€‚ç„¶åï¼Œå®ƒå°†æ£€æµ‹åˆ°çš„ç‰ˆæœ¬ä¸å·²çŸ¥çš„æ˜“å—æ”»å‡»çš„ç‰ˆæœ¬èŒƒå›´è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ç¡®å®šç›®æ ‡æ˜¯å¦å®¹æ˜“å—åˆ°CVE-2025-29927çš„æ”»å‡»ã€‚æ­¤ä»£ç **æœ¬èº«ä¸åŒ…å«åˆ©ç”¨æ¼æ´çš„åé—¨**ï¼Œè€Œåªæ˜¯ä¸€ä¸ªç”¨äºç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦æ˜“å—æ”»å‡»çš„å·¥å…·ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶æä¾›çš„Goä»£ç ä¸»è¦ç”¨äºæ¼æ´æ£€æµ‹ï¼Œä½†ä»å­˜åœ¨ä¸€äº›æ½œåœ¨çš„æŠ•æ¯’é£é™©ï¼š

*   **ä¾èµ–é£é™©ï¼š** `go.mod`æ–‡ä»¶æœªæä¾›ï¼Œä»£ç ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼Œå¦‚`github.com/fatih/color`ã€`github.com/hashicorp/go-version`ã€‚æ¶æ„ä½œè€…å¯èƒ½ç¯¡æ”¹è¿™äº›ä¾èµ–é¡¹ï¼Œæ¤å…¥æ¶æ„ä»£ç ã€‚**é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½æ’é™¤**ã€‚
*   **è¾“å‡ºæ§åˆ¶ï¼š**  æ‰«æå™¨å¯ä»¥å°†ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ã€‚å¦‚æœè¾“å‡ºæ–‡ä»¶è¢«å…¶ä»–ç³»ç»Ÿæˆ–è¿›ç¨‹ä½¿ç”¨ï¼Œæ¶æ„ä½œè€…å¯èƒ½é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ‰«æç»“æœï¼Œé—´æ¥å½±å“å…¶ä»–ç³»ç»Ÿã€‚**é£é™©è¾ƒä½**ã€‚
* **é€»è¾‘åé—¨:** ä»£ç ä¼šæ ¹æ®é…ç½®é¡¹`-thorough`å†³å®šæ˜¯å¦è¿›è¡Œæ›´å½»åº•çš„éªŒè¯ï¼Œä½œè€…å¯èƒ½å­˜åœ¨éšè—çš„åˆ¤æ–­ï¼Œå½“ç‰¹å®šæ¡ä»¶æ»¡è¶³æ—¶ï¼Œå­˜åœ¨è¿æ¥æ¶æ„æœåŠ¡å™¨ï¼Œæˆ–è€…æ‰§è¡Œç‰¹å®šæ“ä½œ.è¯¥é£é™©è¾ƒä½. å› æ­¤ï¼Œç»¼åˆè¯„ä¼°ï¼Œè¯¥ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨ **5%** å·¦å³ã€‚éœ€è¦äººå·¥å®¡æ ¸ä¾èµ–é¡¹å’Œè¾“å‡ºé€»è¾‘ï¼Œä»¥ç¡®ä¿å®‰å…¨æ€§ã€‚

**é¡¹ç›®åœ°å€:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #52

**æ¥æº**: [CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md](../2025/CVE-2025-29927-arvion-agent_next-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶å®‰å…¨æ§åˆ¶ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å…¬å¼€çš„PoCå¯ä»¥éªŒè¯ã€‚æä¾›çš„ä»£ç åº“åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå®ƒæ•…æ„å°†`isAuthorized`è®¾ç½®ä¸º`false`ï¼Œä»è€Œå§‹ç»ˆè¿”å›401 Unauthorizedã€‚é€šè¿‡æ„é€ åŒ…å«`x-middleware-subrequest`çš„è¯·æ±‚å¯ä»¥ç»•è¿‡è¿™ä¸ªä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸­ä¸»è¦åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`: æè¿°äº†æ¼æ´å’Œç¼“è§£æªæ–½ã€‚
*   `middleware.js`: åŒ…å«ä¸€ä¸ªç®€å•çš„ä¸­é—´ä»¶å‡½æ•°ï¼Œç”¨äºæ¼”ç¤ºæˆæƒç»•è¿‡ã€‚
*   `package-lock.json`: ä¾èµ–é¡¹é”æ–‡ä»¶ï¼Œç”¨äºä¿è¯ä¾èµ–ä¸€è‡´æ€§ã€‚

åˆ†æè¿™äº›æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` ä¸­åŒ…å«ä¸€äº›ä¾èµ–é¡¹ï¼Œä¾‹å¦‚ `next`, `react` å’Œ `react-dom`ï¼Œä»¥åŠä¸€äº›æ„å»ºä¾èµ–,ä½†æ²¡æœ‰å‘ç°å¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¾ƒä½,ä½†ä¹Ÿéœ€è¦è°¨æ…è¯„ä¼°,ç»™å‡º 5% çš„æŠ•æ¯’é£é™©è¯„ä¼°.

**åˆ©ç”¨æ–¹å¼ï¼š**

åˆ©ç”¨æ­¤æ¼æ´çš„å…¸å‹æ–¹å¼å¦‚ä¸‹ï¼š

1.  åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«`x-middleware-subrequest: anything`ã€‚
3.  Next.jsçš„æ¼æ´å¯¼è‡´ä¸­é—´ä»¶æœªèƒ½æ­£ç¡®å¤„ç†æ­¤æ ‡å¤´ï¼Œä»è€Œç»•è¿‡äº†æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #53

**æ¥æº**: [CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md](../2025/CVE-2025-29927-ayato-shitomi_WebLab_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js åº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†å—å½±å“çš„ç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœæä¾›äº†å¤šä¸ªå…³äºè¯¥æ¼æ´çš„æè¿°ã€åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åŒ…å«Dockerfileã€docker-compose.yamlç­‰æ–‡ä»¶ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„PoCï¼Œå¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ­å»ºä¸€ä¸ªåŒ…å«æ¼æ´çš„ Next.js ç¯å¢ƒä»¥ä¾¿è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œè™½ç„¶æ¦‚ç‡è¾ƒä½ï¼š
*   **Dockeré•œåƒæ„å»ºè¿‡ç¨‹ï¼š** `Dockerfile` ä¸­ `RUN npm install` è¿™ä¸€æ­¥å¦‚æœå­˜åœ¨æ¶æ„ä¾èµ–ï¼Œå¯èƒ½å¼•å…¥åé—¨ã€‚ä½†æ˜¯ï¼Œç›´æ¥æŸ¥çœ‹ `package-lock.json` å’Œ `package.json` æ–‡ä»¶ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `docker-compose.yaml` ä¸­å®šä¹‰äº† `NODE_ENV=production`ï¼Œç†è®ºä¸Šç”Ÿäº§ç¯å¢ƒä¸‹çš„ä»£ç ä¸åº”è¯¥åŒ…å«è°ƒè¯•æˆ–åé—¨æ€§è´¨çš„ä»£ç ï¼Œä½†ä»éœ€æ£€æŸ¥åº”ç”¨è‡ªèº«çš„ä»£ç ã€‚
*   **åº”ç”¨ä»£ç ï¼š** çœŸæ­£çš„æŠ•æ¯’é£é™©åœ¨äº `/tmp/d0027c9d9688f1cef43f23884faaaf80/next-auth-middleware` ä¸­çš„åº”ç”¨ä»£ç ã€‚è™½ç„¶è¿™é‡Œæ²¡æœ‰ç›´æ¥å±•ç¤ºè¿™äº›ä»£ç ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ä»£ç æœ¬èº«åŒ…å«æ•…æ„è®¾è®¡çš„åé—¨ï¼Œé‚£ä¹ˆå³ä½¿ Dockerfile å’Œä¾èµ–æ²¡æœ‰é—®é¢˜ï¼Œä»ç„¶å­˜åœ¨é£é™©ã€‚å‡è®¾æ£€æŸ¥åº”ç”¨ä»£ç å‘ç°å…¶ä¸­å­˜åœ¨å¯ç–‘è¡Œä¸ºçš„æ¦‚ç‡ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºä¸æ­£ç¡®çš„éªŒè¯é€»è¾‘ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…ç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
*   å‡çº§ Next.js ç‰ˆæœ¬åˆ° 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [ayato-shitomi/WebLab_CVE-2025-29927](https://github.com/ayato-shitomi/WebLab_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #54

**æ¥æº**: [CVE-2025-29927-aydinnyunus_CVE-2025-29927.md](../2025/CVE-2025-29927-aydinnyunus_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** è‡ªæ‰˜ç®¡Next.jsåº”ç”¨ï¼Œä½¿ç”¨Middlewareè¿›è¡Œèº«ä»½éªŒè¯/æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ã€‚ åº”ç”¨éœ€è¦éƒ¨ç½²ä¸º`next start` å’Œ `output: standalone` æ¨¡å¼ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´å­˜åœ¨äºNext.jsçš„ä¸­é—´ä»¶å®ç°ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡è®¾ç½®`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç é€šè¿‡è®¾ç½®`x-middleware-subrequest: middleware` headeræ¥æ¨¡æ‹Ÿå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´åˆ©ç”¨æ–¹æ³•ã€‚ ä»£ç ä»“åº“åŒ…å«ä¸€ä¸ª`exploit-test.js`ç”¨äºæµ‹è¯•æ¼æ´åˆ©ç”¨ã€‚ æ¼æ´æœ¬èº«åŸç†ç®€å•ï¼Œåˆ©ç”¨æ–¹å¼æ¯”è¾ƒç›´æ¥ï¼Œå› æ­¤ä½œè€…åœ¨POCä¸­éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚ ä½†æ˜¯ä¾ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä¾‹å¦‚åœ¨å®‰è£…ä¾èµ–æ—¶å¼•å…¥æ¶æ„ä¾èµ–é¡¹ï¼Œæˆ–è€…é€šè¿‡æ··æ·†ç­‰æ–¹å¼åœ¨åˆ©ç”¨è„šæœ¬ä¸­æ·»åŠ æ¶æ„ä»£ç ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘ç›®æ ‡Next.jsåº”ç”¨å‘é€HTTPè¯·æ±‚ã€‚
2.  åœ¨HTTPè¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  å¦‚æœç›®æ ‡åº”ç”¨ä¾èµ–ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒï¼Œå¹¶ä¸”æ²¡æœ‰åœ¨åç»­è·¯ç”±ä¸­è¿›è¡ŒäºŒæ¬¡éªŒè¯ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æ£€æŸ¥ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**ç¼“è§£æªæ–½ï¼š**
1.  å‡çº§åˆ°Next.js 15.2.3æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 14.2.25æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒNext.js 13.5.9æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é…ç½®Webåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚
3.  åœ¨æ‰€æœ‰éœ€è¦èº«ä»½éªŒè¯çš„è·¯ç”±ä¸­ï¼Œè¿›è¡ŒäºŒæ¬¡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [aydinnyunus/CVE-2025-29927](https://github.com/aydinnyunus/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #55

**æ¥æº**: [CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md](../2025/CVE-2025-29927-azu_nextjs-cve-2025-29927-poc.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºMiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` å¤´æ¥å¤ç°æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æ·»åŠ ç‰¹å®šçš„ HTTP å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ä»”ç»†æ£€æŸ¥äº†æä¾›çš„æ‰€æœ‰æ–‡ä»¶ï¼ŒåŒ…æ‹¬ README.mdã€eslint.config.mjsã€next.config.ts å’Œ package-lock.jsonã€‚æœªå‘ç°ä»»ä½•æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½ä¸ Next.js é¡¹ç›®çš„æ ‡å‡†ç»“æ„å’Œé…ç½®ç›¸ç¬¦ã€‚

*   README.md æä¾›äº†æ¼æ´çš„æè¿°å’Œå¤ç°æ­¥éª¤ï¼Œçœ‹èµ·æ¥æ˜¯åˆæ³•çš„ POC æ–‡æ¡£ã€‚
*   eslint.config.mjs å®šä¹‰äº† ESLint çš„é…ç½®ï¼Œç”¨äºä»£ç æ£€æŸ¥ã€‚
*   next.config.ts æ˜¯ Next.js çš„é…ç½®æ–‡ä»¶ï¼Œç›®å‰æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰åŒ…å«ä»»ä½•å¯ç–‘çš„ä»£ç ã€‚
*   package-lock.json é”å®šäº†é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ï¼Œå¯ä»¥éªŒè¯ä¾èµ–çš„å®Œæ•´æ€§ã€‚è™½ç„¶å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„ç†è®ºå¯èƒ½ï¼Œä½†è¯¥é£é™©è¾ƒä½ã€‚æ–‡ä»¶æœ¬èº«æ— é—®é¢˜ã€‚

ç»¼åˆæ‰€æœ‰åˆ†æï¼ŒæŠ•æ¯’çš„å¯èƒ½æ€§éå¸¸ä½ï¼Œä¼°è®¡ä¸º 1%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨å¿…é¡»ä½¿ç”¨å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…å‘ç›®æ ‡åº”ç”¨å‘é€ HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
3.  Next.js åº”ç”¨åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œä¼šé”™è¯¯åœ°è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œå¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #56

**æ¥æº**: [CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md](../2025/CVE-2025-29927-b4sh0xf_PoC-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å…è®¸æœªæˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºå’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºmiddlewareã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨ HTTP è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼Œåªéœ€åœ¨è¯·æ±‚ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æ ‡å¤´å³å¯ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ï¼Œå¦‚ `/dashboard`ã€‚æœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´å½±å“ Next.js å¤šä¸ªç‰ˆæœ¬ï¼Œå¹¶è¢«è®¤ä¸ºæ˜¯é«˜å±æ¼æ´ã€‚PoC ä»£ç æä¾›äº†ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç éå¸¸ç®€çŸ­ï¼Œä¸»è¦æ˜¯ä¸€ä¸ª Markdown æ–‡ä»¶ï¼Œä¸”åˆ©ç”¨æ–¹å¼æ˜ç¡®ï¼Œæ²¡æœ‰éšè—çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºåç»­ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥POCè¿›è¡Œæ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­çš„ä¸è§„èŒƒæ“ä½œå¸¦æ¥çš„é£é™©ã€‚ä½†æ˜¯ç”±äºè¯¥æ¼æ´å·²ç»å…¬å¼€ï¼Œä¸”å­˜åœ¨å·²çŸ¥åˆ©ç”¨æ–¹å¼ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ï¼Œå› æ­¤éœ€è¦åŠæ—¶ä¿®å¤ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥PoCä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œç”¨äºè§£é‡Šæ¼æ´å’Œæä¾›ç¤ºä¾‹ã€‚æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡åœ¨5%å·¦å³ã€‚ä½†éœ€è¦æ³¨æ„ï¼Œåç»­å¼€å‘è€…å¯èƒ½ä¼šä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` æ ‡å¤´æ¥ç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**é¡¹ç›®åœ°å€:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #57

**æ¥æº**: [CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md](../2025/CVE-2025-29927-bohmiiidd_CVE-2025-29927-exploit-code-.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ªå­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥é€»è¾‘å®ç°åœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest`  header çš„æ¶æ„è¯·æ±‚ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚  

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ PoC ä»£ç æœ‰æ•ˆã€‚å®ƒé€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚æ¥å°è¯•ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„ `/dashboard` è·¯å¾„ã€‚å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜ç»•è¿‡æˆåŠŸã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„ PoCã€‚

**æŠ•æ¯’é£é™©ï¼š**
PoC ä»£ç æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„ HTTP è¯·æ±‚ã€‚åœ¨ç»™å®šçš„ä»£ç ä¸­ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€ä¿®æ”¹æ–‡ä»¶ç³»ç»Ÿæˆ–è¿›è¡Œå…¶ä»–æ¶æ„æ“ä½œçš„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªå¯¹ PoC ä»£ç çš„ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ­¤å¤„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ã€‚æ½œåœ¨çš„é£é™©å¯èƒ½æ˜¯ä¿®æ”¹ PoCï¼Œä½¿å…¶åœ¨æˆåŠŸç»•è¿‡è®¤è¯åï¼Œæ‰§è¡Œæ¶æ„æ“ä½œï¼Œä½†åŸå§‹ PoC ä»…æ—¨åœ¨éªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  ç¡®å®šç›®æ ‡åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“çš„èŒƒå›´å†… (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)ã€‚
3.  å‘ç›®æ ‡åº”ç”¨å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå°è¯•è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/dashboard`ï¼‰ã€‚
4.  å¦‚æœæœåŠ¡å™¨è¿”å› 200 çŠ¶æ€ç ï¼Œåˆ™è¡¨æ˜æˆæƒç»•è¿‡æˆåŠŸã€‚
5.  å¦‚æœæˆæƒç»•è¿‡æˆåŠŸï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®é€šå¸¸éœ€è¦èº«ä»½éªŒè¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²æˆ–å…¶ä»–å®‰å…¨é—®é¢˜ã€‚

**é¡¹ç›®åœ°å€:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #58

**æ¥æº**: [CVE-2025-29927-c0dejump_CVE-2025-29927-check.md](../2025/CVE-2025-29927-c0dejump_CVE-2025-29927-check.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨å­˜åœ¨å—å½±å“çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å«x-middleware-subrequestå¤´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` header æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´å½±å“çš„ Next.js ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚æä¾›çš„ POC ä»£ç  `CVE202529927-check.py` æ—¨åœ¨æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼å’Œè·¯å¾„ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥è„šæœ¬é¦–å…ˆå®šä¹‰äº†`middleware_names`å’Œ`paths`åˆ—è¡¨ï¼Œç”¨äºæ„å»ºpayloadã€‚ç„¶åï¼Œå®ƒå°è¯•é€šè¿‡ä¿®æ”¹ `x-middleware-subrequest` header çš„å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚`is_authentication_page` å‡½æ•°æ£€æµ‹é¡µé¢å†…å®¹ä¸­æ˜¯å¦åŒ…å«èº«ä»½éªŒè¯ç›¸å…³çš„å…³é”®è¯ï¼Œä»¥åˆ¤æ–­é¡µé¢æ˜¯å¦ä¸ºç™»å½•é¡µé¢ã€‚`bypass_auth`å‡½æ•°ç”¨äºå‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚æ¥ç»•è¿‡éªŒè¯ï¼Œå¦‚æœçŠ¶æ€ç å’Œå†…å®¹é•¿åº¦å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæä¾›çš„ POC ä»£ç èƒ½å¤Ÿæœ‰æ•ˆéªŒè¯æ¼æ´çš„å­˜åœ¨ã€‚å®ƒå°è¯•ä½¿ç”¨ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥ç»•è¿‡ä¸­é—´ä»¶è®¤è¯ï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ä¸é¢„æœŸä¸ç¬¦ï¼Œåˆ™è¯´æ˜æ¼æ´å­˜åœ¨ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š** ä»£ç ä¸­å¯èƒ½å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **ä¾èµ–é£é™©ï¼š** è„šæœ¬ä½¿ç”¨äº†`requests`å’Œ`BeautifulSoup4`åº“ï¼Œå¦‚æœè¿™äº›åº“æœ¬èº«è¢«æ¤å…¥æ¶æ„ä»£ç ï¼Œå¯èƒ½å½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚å°½ç®¡requestså’Œbeautifulsoup4æœ¬èº«å¾ˆå¸¸ç”¨ï¼Œé£é™©è¾ƒä½ã€‚
2.  **æ‹’ç»æœåŠ¡ (DoS)ï¼š**  è„šæœ¬ä¸­çš„ `cache_p` å‡½æ•°ï¼Œé€šè¿‡éšæœºç”ŸæˆæŸ¥è¯¢å‚æ•°å¹¶é‡å¤å‘é€è¯·æ±‚ï¼Œå¯èƒ½å¯¼è‡´ç›®æ ‡æœåŠ¡å™¨çš„ç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œé€ æˆ DoS æ”»å‡»ï¼Œå ç”¨å¤§é‡èµ„æºï¼Œå¯¼è‡´æœåŠ¡å™¨æ€§èƒ½ä¸‹é™ã€‚
3.  **ä¿¡æ¯æ³„éœ²ï¼š** è„šæœ¬ä¼šæ‰“å°æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç å’Œå†…å®¹é•¿åº¦ç­‰ä¿¡æ¯ï¼Œè™½ç„¶è¿™äº›ä¿¡æ¯æœ¬èº«ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½è¢«æ”»å‡»è€…åˆ©ç”¨æ¥æ¨æ–­æœåŠ¡å™¨çš„å†…éƒ¨ç»“æ„å’Œé…ç½®ã€‚

æ€»ä½“è€Œè¨€ï¼ŒæŠ•æ¯’çš„æ¦‚ç‡æ¯”è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦æ˜¯è„šæœ¬ä½¿ç”¨äº†å¤–éƒ¨åº“ï¼Œå¯èƒ½å­˜åœ¨ä¾èµ–é£é™©ã€‚åŒæ—¶`cache_p` å‡½æ•°æœ‰æ½œåœ¨çš„ DoS é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„ä¸­é—´ä»¶åç§°ï¼Œä¾‹å¦‚ 'middleware'ï¼Œ'pages/_middleware'ç­‰ã€‚
3.  å‘é€è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  å¦‚æœä¸­é—´ä»¶éªŒè¯é€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [c0dejump/CVE-2025-29927-check](https://github.com/c0dejump/CVE-2025-29927-check)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #59

**æ¥æº**: [CVE-2025-29927-dante01yoon_CVE-2025-29927.md](../2025/CVE-2025-29927-dante01yoon_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç½‘ç»œè®¿é—®

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è¯¥æ¼æ´å½±å“ Next.js çš„å¤šä¸ªç‰ˆæœ¬ï¼ŒåŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.24 å’Œ 15.0.0 åˆ° 15.2.2ã€‚æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åº (vulnerable-app) å’Œä¸€ä¸ªå·²ä¿®å¤çš„åº”ç”¨ç¨‹åº (fixed-app)ã€‚é€šè¿‡è¿è¡Œ vulnerable-app å¹¶ä½¿ç”¨ curl æˆ–æµè§ˆå™¨æ‰©å±•è®¾ç½® `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥ç›´æ¥è®¿é—®éœ€è¦è®¤è¯çš„é¡µé¢ï¼ˆå¦‚ adminï¼‰ã€‚fixed-app ç”±äºä¿®å¤äº†æ¼æ´ï¼Œå› æ­¤æ— æ³•ç»•è¿‡èº«ä»½éªŒè¯ã€‚è™½ç„¶POCåˆ©ç”¨éœ€è¦æ­å»ºç¯å¢ƒæ‰èƒ½æµ‹è¯•ï¼Œä½†æ˜¯POCä»£ç ä»…ç”¨äºæ¼”ç¤ºæ¼æ´æœ¬èº«ï¼Œé€»è¾‘ç®€å•ï¼Œä¸å¤ªå¯èƒ½å­˜åœ¨åé—¨æˆ–è€…å…¶ä»–æ¼æ´åˆ©ç”¨ä»£ç ã€‚ä»…å­˜åœ¨æå°çš„æŠ•æ¯’é£é™©ã€‚

**é¡¹ç›®åœ°å€:** [dante01yoon/CVE-2025-29927](https://github.com/dante01yoon/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #60

**æ¥æº**: [CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md](../2025/CVE-2025-29927-darklotuskdb_nextjs-CVE-2025-29927-hunter.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼ŒCVE-2025-29927 æ˜¯ä¸€ç§ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™å¯èƒ½è¢«åˆ©ç”¨ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ­¤æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯ç»™å‡ºäº†æ˜ç¡®çš„å—å½±å“ç‰ˆæœ¬èŒƒå›´ï¼Œå¹¶æä¾›äº†ç¼“è§£æªæ–½ï¼ˆé˜»æ­¢åŒ…å« x-middleware-subrequest å¤´çš„å¤–éƒ¨è¯·æ±‚ï¼‰ã€‚æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥ï¼ˆä¾‹å¦‚ï¼Œæ¥è‡ª Picus Securityã€Datadog Security Labsã€Rapid7ã€JFrogã€Akamai å’Œ Truesec çš„æ–‡ç« ï¼‰è¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æè¿°äº†å…¶å½±å“ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæ˜¯ä¸€ä¸ª GNU GPL è®¸å¯è¯ï¼Œä¸åŒ…å«ä»»ä½•å®é™…çš„æ¼æ´åˆ©ç”¨ä»£ç ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚æ¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€ç»è¿‡æ­£ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚

**æ€»ç»“ï¼š**
CVE-2025-29927 æ˜¯ä¸€ä¸ªé«˜å±æ¼æ´ï¼Œåˆ©ç”¨ç®€å•ï¼Œå½±å“å¹¿æ³›ã€‚å—å½±å“çš„ Next.js åº”ç”¨åº”å°½å¿«å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œæˆ–è€… 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ã€‚

**é¡¹ç›®åœ°å€:** [darklotuskdb/nextjs-CVE-2025-29927-hunter](https://github.com/darklotuskdb/nextjs-CVE-2025-29927-hunter)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #61

**æ¥æº**: [CVE-2025-29927-diogolourencodev_middleforce.md](../2025/CVE-2025-29927-diogolourencodev_middleforce.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµç‰¹å®šçš„ HTTP å¤´éƒ¨æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.js åº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ– API æ¥å£ã€‚
3.  **POC ä»£ç åˆ†æï¼š** æä¾›çš„ `middleforce.py` è„šæœ¬é€šè¿‡å‘é€ä¸¤ç§ç±»å‹çš„è¯·æ±‚æ¥æ£€æµ‹æ¼æ´ï¼š
    *   **Basic Requestï¼š**  å‘é€ä¸å¸¦ä»»ä½•ç‰¹æ®Šå¤´çš„æ™®é€šè¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **Middleware Requestï¼š** å‘é€åŒ…å« `x-middleware-subrequest: middleware` ä»¥åŠå…¶ä»–ä¸€äº›å¤´ï¼ˆå¦‚ `X-Frame-Options`, `Access-Control-Allow-*`ï¼‰çš„è¯·æ±‚ï¼Œæ¨¡æ‹Ÿä¸­é—´ä»¶å­è¯·æ±‚ï¼Œè·å–çŠ¶æ€ç ã€‚
    *   **æ¼æ´åˆ¤æ–­ï¼š** å¦‚æœ Basic Request è¢«æ‹¦æˆªï¼ˆä¾‹å¦‚è¿”å› 403ï¼‰ï¼Œè€Œ Middleware Request æˆåŠŸè¿”å› 200ï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶æˆæƒè¢«ç»•è¿‡ã€‚
4.  **æœ‰æ•ˆæ€§è¯„ä¼°ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’ŒPOCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POCä»£ç æ¨¡æ‹Ÿäº†æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶æˆæƒçš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿå‡†ç¡®åœ°æ£€æµ‹åˆ°å­˜åœ¨æ¼æ´çš„ Next.js åº”ç”¨ã€‚
5.  **æŠ•æ¯’é£é™©åˆ†æï¼š**
    *   `middleforce.py`ï¼šè¯¥è„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚å¹¶æ ¹æ®å“åº”çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œé€»è¾‘ç›¸å¯¹ç®€å•ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚ä½†headerä¸­åŒ…å«ä¸€äº›ä¸CORSç›¸å…³çš„headerå¯èƒ½å­˜åœ¨ä¸€äº›é£é™©ã€‚
    *   `install.sh`ï¼šå®‰è£…è„šæœ¬å°è¯•ä½¿ç”¨ `pip install -r requirements.txt --break-system-packages` å®‰è£…ä¾èµ–ï¼Œè¿™åœ¨æŸäº›ç³»ç»Ÿé…ç½®ä¸‹å¯èƒ½å¯¼è‡´é—®é¢˜ï¼Œä½†å¹¶éæ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚å°†è„šæœ¬å¤åˆ¶åˆ° `/usr/local/bin` ç›®å½•æ˜¯æ­£å¸¸çš„å®‰è£…æµç¨‹ã€‚
    *   `README.md`ï¼šåªæ˜¯å·¥å…·çš„è¯´æ˜æ–‡æ¡£ï¼Œæ²¡æœ‰é£é™©ã€‚
    *   **ç»¼åˆè¯„ä¼°ï¼š** æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä¸­å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æŸäº›é…ç½®å¯èƒ½å¼•èµ·ä½¿ç”¨è€…ç³»ç»Ÿå¼‚å¸¸ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**æ€»ç»“ï¼š** è¯¥æ¼æ´åˆ©ç”¨æœ‰æ•ˆï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´ç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚å°½ç®¡ POC ä»£ç æœ¬èº«æœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºï¼Œä½†ä»éœ€è°¨æ…ä½¿ç”¨ï¼Œå¹¶åœ¨å—æ§ç¯å¢ƒä¸­è¿›è¡Œæµ‹è¯•ã€‚

**é¡¹ç›®åœ°å€:** [diogolourencodev/middleforce](https://github.com/diogolourencodev/middleforce)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #62

**æ¥æº**: [CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md](../2025/CVE-2025-29927-elshaheedy_CVE-2025-29927-Sigma-Rule.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„ç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest: middleware` å¤´çš„è¯·æ±‚å¯ä»¥ç»•è¿‡èº«ä»½éªŒè¯ã€‚ä»æœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åˆ©ç”¨ä»£ç æ¥çœ‹ï¼Œè¯¥æ¼æ´çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ä¸ºå‘é€ç‰¹å®šçš„ HTTP è¯·æ±‚å¤´ã€‚æä¾›çš„ Sigma è§„åˆ™æ—¨åœ¨æ£€æµ‹åŒ…å«è¯¥æ¶æ„headerçš„è¯·æ±‚ã€‚è™½ç„¶æä¾›çš„POCä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯æ£€æµ‹è§„åˆ™å’Œæ–‡æ¡£ï¼Œä½†ç†è®ºä¸Šæ”»å‡»è€…å¯ä»¥ä½¿ç”¨è¯¥ä¿¡æ¯ç»•è¿‡èº«ä»½éªŒè¯ã€‚è¯¥ä»“åº“æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨è¯¥è§„åˆ™è¿›è¡Œæ”»å‡»æ—¶ï¼Œå¦‚æœæ—¥å¿—é…ç½®ä¸å½“ï¼Œå¯èƒ½æ— æ³•æ£€æµ‹åˆ°æ”»å‡»ã€‚ä»“åº“ä¸­çš„æ–‡ä»¶çœ‹èµ·æ¥æ˜¯åˆæ³•çš„æ¼æ´åˆ©ç”¨PoCå’Œæ£€æµ‹è§„åˆ™ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä½†ä»»ä½•è§„åˆ™éƒ½æœ‰å¯èƒ½è¢«è¯¯ç”¨,å› æ­¤å­˜åœ¨ä¸€å®šçš„è¯¯æŠ¥æˆ–æ¼æŠ¥é£é™©ï¼Œä»è€Œè¢«æ¶æ„åˆ©ç”¨ï¼Œç»™æ£€æµ‹äººå‘˜é€ æˆå›°æ‰°ã€‚ æ€»ä½“æŠ•æ¯’é£é™©å¤§çº¦ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [elshaheedy/CVE-2025-29927-Sigma-Rule](https://github.com/elshaheedy/CVE-2025-29927-Sigma-Rule)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #63

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927-Docker-Lab.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬åŒ…æ‹¬ï¼š>= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™å¯èƒ½ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ­¤ä»“åº“æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒæ¥å¤ç°æ¼æ´,é€šè¿‡`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` å‘½ä»¤å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœä»¥åŠæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå¯ä»¥åˆ¤æ–­æ­¤æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´æ˜¯ç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¼•èµ·çš„ï¼Œæœç´¢ç»“æœä¸­ä¹ŸåŒ…å«å¤šä¸ªå…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨çš„æ–‡ç« ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Docker ç¯å¢ƒï¼Œæ–¹ä¾¿ç”¨æˆ·å¤ç°è¯¥æ¼æ´ï¼Œè¿›ä¸€æ­¥éªŒè¯äº†æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ Dockerfile ä¸»è¦ç”¨äºæ„å»º Next.js åº”ç”¨ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.md å’Œ VULNERABILITY.md æ–‡ä»¶ä¹Ÿä¸»è¦æä¾›æ¼æ´çš„è¯´æ˜å’Œåˆ©ç”¨æ–¹æ³•ã€‚docker-compose.ymlæ–‡ä»¶æœªæä¾›ï¼Œæ— æ³•è¿›è¡Œåˆ†æã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤ä»“åº“æœ¬èº«å°±æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´è€Œå­˜åœ¨ï¼Œå› æ­¤å­˜åœ¨ä¸€å®šé£é™©ï¼Œä¸åº”ç›´æ¥éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…åˆ©ç”¨ Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“çš„ç¼ºé™·ã€‚
2.  æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
3.  å‘é€æ¶æ„è¯·æ±‚åˆ°å—å½±å“çš„ Next.js åº”ç”¨ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #64

**æ¥æº**: [CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md](../2025/CVE-2025-29927-enochgitgamefied_NextJS-CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬å¤šä¸ªNext.jsç‰ˆæœ¬èŒƒå›´ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æŒ‡å‡ºæ˜¯ç”±äºNext.jså¯¹ `x-middleware-subrequest`  headerå¤„ç†ä¸å½“é€ æˆçš„ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªå±•ç¤ºæ¼æ´çš„ã€æ•…æ„å­˜åœ¨æ¼æ´çš„Next.jsåº”ç”¨ç¨‹åºã€‚è¿™ä¸ªåº”ç”¨åŒ…å«æ¨¡æ‹ŸWebåº”ç”¨é˜²ç«å¢™ï¼ˆWAFï¼‰çš„ä¸­é—´ä»¶ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest`  headerçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚è™½ç„¶æä¾›çš„ä»£ç æœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´ï¼Œä½†ä»éœ€è¦è°¨æ…è¯„ä¼°å…¶å®‰å…¨æ€§ï¼Œå°¤å…¶æ˜¯ä¾èµ–é¡¹å’Œæ•°æ®åº“é…ç½®ã€‚æŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹ï¼š

1.  æ•°æ®åº“é…ç½®ï¼š `README.md` ä¸­æåˆ°éœ€è¦é…ç½®MySQLæ•°æ®åº“ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ã€‚å¦‚æœç”¨æˆ·ç›´æ¥ä½¿ç”¨ç¤ºä¾‹é…ç½®ï¼Œå¹¶ä¸”æ•°æ®åº“æœªè¿›è¡Œå®‰å…¨åŠ å›ºï¼Œåˆ™å¯èƒ½å­˜åœ¨è¢«æ”»å‡»çš„é£é™©ã€‚
2.  ä¾èµ–é¡¹ï¼š `package-lock.json` æ–‡ä»¶ä¸­åˆ—å‡ºäº†åº”ç”¨ç¨‹åºçš„ä¾èµ–é¡¹ã€‚è™½ç„¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä¾èµ–ï¼Œä½†ä»éœ€å®šæœŸæ£€æŸ¥è¿™äº›ä¾èµ–é¡¹æ˜¯å¦å­˜åœ¨å®‰å…¨æ¼æ´ã€‚

æ€»ä½“æ¥è¯´ï¼Œæ­¤POCæœ¬èº«æ˜¯ä¸ºäº†æ¼”ç¤ºæ¼æ´çš„å­˜åœ¨ï¼Œä¸»è¦é£é™©åœ¨äºç”¨æˆ·ä¸å®‰å…¨åœ°ä½¿ç”¨å’Œé…ç½®æ­¤POCç¯å¢ƒã€‚


**é¡¹ç›®åœ°å€:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #65

**æ¥æº**: [CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md](../2025/CVE-2025-29927-ethanol1310_POC-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-Middlewareè®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Middlewareè¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢å¼•æ“ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest` å¤´å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆï¼Œå› ä¸ºå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å¸¦æœ‰ç‰¹å®šå€¼çš„`x-middleware-subrequest`å¤´æ¥å‘é€è¯·æ±‚ï¼Œä»è€Œç»•è¿‡è®¤è¯ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

è™½ç„¶å¤§éƒ¨åˆ†ä»£ç çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®ç»“æ„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°ï¼š

1.  POCä¸­çš„ `x-middleware-subrequest` çš„å€¼éå¸¸é•¿ä¸”é‡å¤ï¼Œ `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` è¿™ç§é‡å¤å¯èƒ½è§¦å‘æœªçŸ¥çš„ä»£ç è¡Œä¸ºï¼Œä»è€Œè¾¾åˆ°æ³¨å…¥æ¶æ„ä»£ç çš„ç›®çš„ã€‚
2.  POCä½¿ç”¨äº†ChatGPTç”Ÿæˆï¼Œè¿™æœ‰ä¸€å®šæ¦‚ç‡æºå…¥ä¸å®‰å…¨çš„ä»£ç ã€‚

ç»¼åˆæ¥çœ‹ï¼Œå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’å¯èƒ½æ€§ï¼Œä½†å¯èƒ½æ€§è¾ƒä½ã€‚åˆæ­¥ä¼°è®¡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨éœ€è¦ä½¿ç”¨Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†middlewareæ¥åšè®¤è¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest`å¤´ï¼Œå¹¶å°†è¯¥å¤´çš„å€¼è®¾ç½®ä¸ºç‰¹å®šçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`ã€‚
3.  å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼Œæ”»å‡»è€…å°†èƒ½å¤Ÿç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #66

**æ¥æº**: [CVE-2025-29927-fahimalshihab_NextBypass.md](../2025/CVE-2025-29927-fahimalshihab_NextBypass.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ï¼Œç”±äº Next.js å¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“å¯¼è‡´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­æ·»åŠ è¯¥ header ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ï¼Œæœç´¢å¼•æ“ç»“æœä»¥åŠæä¾›çš„POCä»£ç ï¼Œå¯ä»¥åˆ¤æ–­è¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„POCä»£ç ä¸»è¦åŒ…å«ä¸€ä¸ª README.md æ–‡ä»¶å’Œä¸€ä¸ª MIT è®¸å¯åè®®æ–‡ä»¶ï¼Œä»¥åŠä¸€ä¸ªæ¼”ç¤ºçš„gifå›¾ç‰‡ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`NextBypass`å·¥å…·çš„ä½¿ç”¨éœ€è¦ç”¨æˆ·è‡ªå·± `git clone` ä»£ç ï¼Œå¹¶æ‰§è¡Œ `./NextBypass`å‘½ä»¤ã€‚å¦‚æœæ”»å‡»è€…ä¿®æ”¹äº†githubä»“åº“ä¸­çš„NextBypasså†…å®¹æ·»åŠ äº†æ¶æ„ä»£ç ï¼Œå°†ä¼šå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œä½†æ˜¯æ•´ä½“é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°ï¼Œå®¹æ˜“è¢«å‘ç°ã€‚ ä¼°è®¡æŠ•æ¯’é£é™©ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` header çš„æ¶æ„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ç”¨æˆ·çš„æƒé™ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #67

**æ¥æº**: [CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md](../2025/CVE-2025-29927-ferpalma21_Automated-Next.js-Security-Scanner-for-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„ Next.js ä¸­é—´ä»¶ä¸­ã€‚ æœç´¢ç»“æœä¹Ÿæ˜¾ç¤ºå¤šä¸ªå®‰å…¨åšå®¢å’Œ NVD éƒ½åœ¨è®¨è®ºæ­¤æ¼æ´ï¼Œå¹¶å¼ºè°ƒäº†å…¶ä¸¥é‡æ€§ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆæ‰«æå™¨ï¼‰æ—¨åœ¨æ£€æµ‹å’Œå°è¯•åˆ©ç”¨æ­¤æ¼æ´ï¼Œè¿›ä¸€æ­¥è¯å®äº†å…¶æœ‰æ•ˆæ€§ã€‚è¯¥POCé€šè¿‡ç‰ˆæœ¬è¯†åˆ«å’Œæ„é€ ç‰¹å®šè¯·æ±‚æ¥éªŒè¯æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„ Javascript ä»£ç ï¼Œé£é™©åœ¨äºï¼š
1. **ä¾èµ–é¡¹é£é™©ï¼š** `index.js` ä¾èµ–äº `puppeteer`, `yargs`, å’Œ `fs` æ¨¡å—ã€‚å¦‚æœè¿™äº›ä¾èµ–é¡¹æœ¬èº«è¢«æŠ•æ¯’ï¼Œå¯èƒ½ä¼šå½±å“è„šæœ¬çš„å®‰å…¨æ€§ã€‚
2. **å¤–éƒ¨èµ„æºå¼•ç”¨ï¼š** è„šæœ¬ä»æ–‡ä»¶ä¸­è¯»å– URL åˆ—è¡¨ (`-f` å‚æ•°) å’Œå­—å…¸æ–‡ä»¶ (`-w` å‚æ•°)ã€‚å¦‚æœè¿™äº›æ–‡ä»¶è¢«æ¶æ„ç¯¡æ”¹ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„šæœ¬æ‰§è¡Œæ¶æ„æ“ä½œã€‚
3. **Puppeteeré£é™©ï¼š** Puppeteer ç”¨äºæ¨¡æ‹Ÿæµè§ˆå™¨è¡Œä¸ºï¼Œå¦‚æœç½‘ç«™å­˜åœ¨æ¶æ„ä»£ç ï¼ŒPuppeteer å¯èƒ½ä¼šè¢«åˆ©ç”¨æ‰§è¡Œè¿™äº›ä»£ç ã€‚ æ­¤å¤–ï¼Œå¦‚æœChromiumè·¯å¾„(`-c`)è¢«æ¶æ„ä¿®æ”¹,å¯èƒ½ä¼šåŠ è½½æ¶æ„Chromiumã€‚
4. **å°è¯•åˆ©ç”¨æ¼æ´é€»è¾‘ï¼š**  `-a` å‚æ•°å…è®¸å°è¯•åˆ©ç”¨æ¼æ´ï¼Œå¦‚æœåˆ©ç”¨æ–¹å¼ä¸å½“æˆ–ç›®æ ‡ç³»ç»Ÿå­˜åœ¨é˜²å¾¡æœºåˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–å…¶ä»–æ„å¤–æƒ…å†µã€‚
5. **ç»“æœè¾“å‡ºï¼š**  ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶ (`-o` å‚æ•°) å¯èƒ½ä¼šå¯¼è‡´æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚

è™½ç„¶ä»¥ä¸Šæƒ…å†µå­˜åœ¨é£é™©ï¼Œä½†æœªå‘ç°ä½œè€…ä¸»åŠ¨æ·»åŠ çš„æ¶æ„ä»£ç ã€‚é£é™©ä¸»è¦æ¥è‡ªäºä¸å®‰å…¨çš„ä½¿ç”¨æ–¹å¼å’Œå¤–éƒ¨èµ„æºçš„æ½œåœ¨é£é™©ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š**  ä½¿ç”¨æä¾›çš„è„šæœ¬æ‰«æç›®æ ‡ç½‘ç«™ï¼Œæ£€æµ‹å…¶æ˜¯å¦ä½¿ç”¨ Next.jsï¼Œå¹¶ç¡®å®š Next.js çš„ç‰ˆæœ¬ã€‚
2.  **æ¼æ´éªŒè¯ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨äº†å—å½±å“çš„ Next.js ç‰ˆæœ¬ï¼Œåˆ™å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
3.  **åˆ©ç”¨ï¼š** ä½¿ç”¨æ”»å‡»è½½è·ï¼ˆé€šè¿‡ `-w` å‚æ•°æŒ‡å®šçš„å­—å…¸æ–‡ä»¶ï¼‰ï¼Œå°è¯•ä¸åŒçš„è·¯å¾„ï¼Œä»¥ä¾¿ç»•è¿‡æˆæƒè®¿é—®å…³é”®èµ„æºã€‚
4.  **ç¼“è§£æªæ–½:**  å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœæ— æ³•å‡çº§ï¼Œé˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #68

**æ¥æº**: [CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md](../2025/CVE-2025-29927-fourcube_nextjs-middleware-bypass-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` HTTP Header æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼Œå‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚å¯ä»¥ç›´æ¥ç»•è¿‡åŸæœ¬åº”è¯¥è¿”å› 403 é”™è¯¯çš„è®¿é—®é™åˆ¶ï¼Œè¿”å› 200 OKã€‚æ¼æ´åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œåªéœ€è¦å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ã€‚

**æœ‰æ•ˆæ€§ï¼š**  æä¾›çš„POCä»£ç æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚

**æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦åŒ…å«Demoç¨‹åºï¼Œlicenseï¼Œè¯´æ˜æ–‡æ¡£å’Œä¸€äº›é…ç½®æ–‡ä»¶ï¼Œç”¨äºé‡ç°æ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚å…¶ä¸­è™½ç„¶åŒ…å«ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯åœ¨ package-lock.json æ–‡ä»¶ä¸­éƒ½è¢«é”å®šåˆ°ç‰¹å®šç‰ˆæœ¬ï¼Œæ‰€ä»¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œ è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.js åº”ç”¨çš„ä¸­é—´ä»¶å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®åŸæœ¬å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #69

**æ¥æº**: [CVE-2025-29927-furmak331_CVE-2025-29927.md](../2025/CVE-2025-29927-furmak331_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”è®¤è¯é€»è¾‘ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡ Next.js åº”ç”¨ä¸­çš„è®¤è¯æ£€æŸ¥ï¼Œå¦‚æœè®¤è¯æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25ï¼Œä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯é€»è¾‘ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ç¼“è§£æªæ–½æ˜¯å‡çº§åˆ° 14.2.25 æˆ– 15.2.3 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` header çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚æä¾›çš„POCä»£ç ï¼ˆ`README.md`ï¼‰æœ¬èº«åªåŒ…å«æ¼æ´IDå’Œæè¿°ï¼Œæ²¡æœ‰å®é™…çš„åˆ©ç”¨ä»£ç ï¼Œå› æ­¤å…¶æœ‰æ•ˆæ€§ä¾èµ–äºå…¶ä»–å¯ç”¨çš„åˆ©ç”¨æ–¹å¼ï¼Œæ‰€ä»¥æœ‰æ•ˆæ€§å¯ä»¥ç†è§£ä¸ºé—´æ¥æœ‰æ•ˆã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ `README.md` æ–‡ä»¶å†…å®¹ç®€å•ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç , åªæ˜¯ä¸€ä¸ªè¯´æ˜æ–‡æ¡£ã€‚ç”±äºPOCä¸å®Œæ•´ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­ï¼Œå€¾å‘äºè¯¥æ¼æ´éœ€è¦é…åˆç‰¹å®šçš„åº”ç”¨é€»è¾‘æ¥è¿›è¡Œåˆ©ç”¨,æ‰€ä»¥æŠ•æ¯’é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [furmak331/CVE-2025-29927](https://github.com/furmak331/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #70

**æ¥æº**: [CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md](../2025/CVE-2025-29927-goncalocsousa1_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½®`x-middleware-subrequest: middleware`å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ï¼Œå®ƒæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨`x-middleware-subrequest`å¤´ç»•è¿‡Next.jsä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹äº†ä»“åº“ä¸­çš„æ–‡ä»¶ï¼š
*   `/README.md`: æä¾›äº†æ¼æ´æè¿°ã€å®‰è£…å’Œè¿è¡ŒæŒ‡å—ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨æ¼æ´çš„è¯´æ˜ã€‚
*   `/middleware.ts`: åŒ…å«ä¸­é—´ä»¶é€»è¾‘ï¼Œç”¨äºæ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²é€šè¿‡èº«ä»½éªŒè¯ã€‚å­˜åœ¨æ¼æ´çš„ä»£ç ã€‚
*   `/next-env.d.ts`: Next.jsç¯å¢ƒå£°æ˜æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚
*   `/next.config.js`: Next.jsé…ç½®æ–‡ä»¶ï¼Œå¼€å¯appDirè¯•éªŒæ€§åŠŸèƒ½,ä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç 
*   `/package-lock.json`: åŒ…ä¾èµ–é”å®šæ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

æ‰€æœ‰æ–‡ä»¶ä¸­çš„ä»£ç éƒ½ä¸æ¼æ´æè¿°å’Œåˆ©ç”¨æ–¹å¼ä¸€è‡´ã€‚è€ƒè™‘åˆ°è¿™äº›å› ç´ ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«`x-middleware-subrequest: middleware`å¤´ã€‚
3.  æ”»å‡»è€…å°†æ­¤è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  Next.jsä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
5.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [goncalocsousa1/CVE-2025-29927](https://github.com/goncalocsousa1/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #71

**æ¥æº**: [CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md](../2025/CVE-2025-29927-gotcadumitru_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest` header ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Next.jsé¡¹ç›®ç»“æ„ï¼Œ`middleware.ts` æ–‡ä»¶æ¨¡æ‹Ÿäº†ä¸€ä¸ªç®€å•çš„æƒé™éªŒè¯ï¼Œä½†æ˜¯ç¼ºå°‘å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ï¼Œå®¹æ˜“è¢«ç»•è¿‡. ä»“åº“ä¸­çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦ä½“ç°åœ¨ package-lock.json ä¸­å­˜åœ¨ä¸€äº›ä¾èµ–ï¼Œä½†æ˜¯æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: anything` å¤´çš„HTTPè¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
2.  Next.jsåº”ç”¨å¦‚æœæ²¡æœ‰æ­£ç¡®éªŒè¯æˆ–ç§»é™¤è¯¥headerï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯ä¼šè¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #72

**æ¥æº**: [CVE-2025-29927-gotr00t0day_CVE-2025-29927.md](../2025/CVE-2025-29927-gotr00t0day_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä¸­é—´ä»¶å®ç°ä¸­ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`å¤´éƒ¨å¤„ç†ä¸å½“é€ æˆçš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ç‰¹å®š`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§åˆ†æï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæ¥æºè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†åˆ©ç”¨æ–¹æ³•ï¼Œå³æ„é€ åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚ã€‚æä¾›çš„PoCä»£ç å°è¯•é€šè¿‡æ­¤å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
åˆ†ææä¾›çš„PoCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ã€‚è¯¥ä»£ç ä¸»è¦ç”¨äºæ£€æµ‹ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œåˆ©ç”¨æ–¹å¼ç›¸å¯¹ç›´æ¥ã€‚`exploit_header` çš„å€¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ç³»åˆ—ç›®å½•æ‹¼æ¥ï¼Œç›®çš„æ˜¯è§¦å‘ Next.js å†…éƒ¨çš„è·¯å¾„è§£æé”™è¯¯ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶ã€‚ è¯¥ä»£ç çš„ç›®çš„æ˜¯éªŒè¯æ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨çš„ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´éƒ¨çš„HTTPè¯·æ±‚ã€‚
4.  å¦‚æœè¿”å›çŠ¶æ€ç ä¸º200ï¼Œä¸”åŸæœ¬åº”è¯¥è¢«ä¸­é—´ä»¶æ‹¦æˆªï¼Œåˆ™è¡¨æ˜æ¼æ´å­˜åœ¨ï¼Œæˆæƒç»•è¿‡æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [gotr00t0day/CVE-2025-29927](https://github.com/gotr00t0day/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #73

**æ¥æº**: [CVE-2025-29927-hed1ad_my-CVE-2025-29927.md](../2025/CVE-2025-29927-hed1ad_my-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é…ç½®ï¼Œä¸”å…è®¸å¤–éƒ¨è¯·æ±‚åŒ…å« 'x-middleware-subrequest' å¤´éƒ¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶é‰´æƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` å¤´éƒ¨å¤„ç†ä¸å½“ã€‚å½“è¯·æ±‚åŒ…å«è¯¥å¤´éƒ¨æ—¶ï¼Œä¸­é—´ä»¶ä¸­çš„é‰´æƒé€»è¾‘å¯èƒ½è¢«ç»•è¿‡ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªæŠ¥å‘Šå’Œåˆ†ææ–‡ç« ä½è¯ã€‚æä¾›çš„ POC ä»£ç  `exploit.py` åˆ©ç”¨äº† `x-middleware-subrequest` å¤´éƒ¨æ¥ç»•è¿‡é‰´æƒï¼Œå› æ­¤ POC ä»£ç æœ‰æ•ˆã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ªç®€å•çš„ HTTP ä»£ç†æœåŠ¡å™¨ï¼Œç”¨äºæ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ä»¥åŠå…¶ä»–è‡ªå®šä¹‰å¤´éƒ¨ï¼ˆé€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` è®¾ç½®ï¼‰ã€‚ä»£ç æœ¬èº«åŠŸèƒ½æ¸…æ™°ï¼Œæ²¡æœ‰å‘ç°éšè—çš„æ¶æ„ä»£ç ã€‚è™½ç„¶å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `PROXY_HEADERS` æ·»åŠ ä»»æ„ Header, ä½†è¿™æ˜¯è„šæœ¬çš„æ­£å¸¸åŠŸèƒ½, ä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  è¿è¡Œ `exploit.py` è„šæœ¬ï¼Œå¯åŠ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚
2.  é…ç½®æµè§ˆå™¨æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯ä½¿ç”¨è¯¥ä»£ç†ã€‚
3.  å‘ Next.js åº”ç”¨å‘é€è¯·æ±‚ï¼Œä»£ç†ä¼šè‡ªåŠ¨æ·»åŠ  `X-Middleware-Subrequest` å¤´éƒ¨ï¼ˆä»¥åŠé€šè¿‡ç¯å¢ƒå˜é‡æŒ‡å®šçš„å…¶ä»–å¤´éƒ¨ï¼‰ã€‚
4.  å¦‚æœ Next.js åº”ç”¨å­˜åœ¨æ¼æ´ä¸”ä¸­é—´ä»¶é‰´æƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œè¯·æ±‚å°†ç»•è¿‡é‰´æƒï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®æœ¬åº”å—åˆ°ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #74

**æ¥æº**: [CVE-2025-29927-iSee857_CVE-2025-29927.md](../2025/CVE-2025-29927-iSee857_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.jsåº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥çš„åº”ç”¨ä¸­ã€‚è¯¥æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œæä¾›çš„POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚è¯¥ä»£ç é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶`x-middleware-subrequest`å¤´çš„è¯·æ±‚æ¥æ¨¡æ‹Ÿæ”»å‡»ï¼Œå¹¶æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”çŠ¶æ€ç æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚

**æŠ•æ¯’é£é™©ï¼š**

åˆ†ææä¾›çš„POCä»£ç ï¼Œæœªå‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚ä»£ç é€»è¾‘æ¸…æ™°ï¼Œä¸»è¦åŠŸèƒ½æ˜¯å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„HTTPè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ‰€æœ‰æ“ä½œéƒ½åœ¨é¢„æœŸä¹‹å†…ï¼Œæ²¡æœ‰å‘ç°æ¶æ„è¡Œä¸ºæˆ–éšè—çš„åé—¨ï¼Œé£é™©æ˜¯0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç¡®å®šç›®æ ‡ï¼š** è¯†åˆ«è¿è¡Œç€å—å½±å“ç‰ˆæœ¬Next.jsçš„åº”ç”¨ï¼Œä¸”è¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  **æ„é€ æ¶æ„è¯·æ±‚ï¼š** ä½¿ç”¨POCæˆ–ç±»ä¼¼å·¥å…·ï¼Œæ„é€ åŒ…å«`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚`x-middleware-subrequest`çš„å€¼è®¾ç½®ä¸º`middleware:middleware:middleware:middleware:middleware`ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨çš„å—ä¿æŠ¤èµ„æºã€‚
4.  **éªŒè¯æ¼æ´ï¼š** æ£€æŸ¥æœåŠ¡å™¨çš„å“åº”ã€‚å¦‚æœæœªç»æˆæƒå³å¯è®¿é—®èµ„æºï¼Œåˆ™è¡¨æ˜å­˜åœ¨æ¼æ´ã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå»ºè®®é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #75

**æ¥æº**: [CVE-2025-29927-iteride_CVE-2025-29927.md](../2025/CVE-2025-29927-iteride_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”éƒ¨ç½²ç¯å¢ƒå…è®¸å¤–éƒ¨è¯·æ±‚è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯ Next.js æ²¡æœ‰æ­£ç¡®å¤„ç† `x-middleware-subrequest` æ ‡å¤´ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œè·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±æˆ–æ•°æ®çš„æœªæˆæƒè®¿é—®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  `x-middleware-subrequest` æ ‡å¤´çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºæ¬ºéª— Next.js è¿è¡Œæ—¶ï¼Œä½¿å…¶è·³è¿‡ä¸­é—´ä»¶çš„æ‰§è¡Œã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚
4.  å¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œä¸”æˆæƒæ£€æŸ¥ä»…å­˜åœ¨äºä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å°†ç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’Œæä¾›çš„POCä»£ç ï¼Œæ­¤æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œæœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥éƒ½æä¾›äº†æ¼æ´åˆ†æå’Œåˆ©ç”¨è¯´æ˜ã€‚POCä»£ç ä¸­è¯¦ç»†æè¿°äº†æ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†CPEå’Œåˆ©ç”¨æ¡ä»¶ï¼Œè¿›ä¸€æ­¥è¯å®äº†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æœ¬èº«ä¸»è¦æ˜¯æ¼æ´çš„åŸç†è¯´æ˜å’ŒéªŒè¯ï¼Œä»¥åŠæ£€æµ‹è„šæœ¬ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚README.mdæ–‡ä»¶ä¸»è¦åŒ…å«æ¼æ´ä»‹ç»ã€å½±å“ç‰ˆæœ¬ã€åˆ©ç”¨æ¡ä»¶å’ŒéªŒè¯æ–¹æ³•ã€‚nuclei æ¨¡æ¿å’Œ Python/Go æ‰«æè„šæœ¬ç”¨äºæ£€æµ‹æ¼æ´æ˜¯å¦å­˜åœ¨ï¼Œæœ¬èº«æ²¡æœ‰å±å®³æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚åœ¨10%å·¦å³ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªäº nuclei æ¨¡æ¿æˆ–æ‰«æè„šæœ¬å¦‚æœè¢«æ¶æ„ä¿®æ”¹ï¼Œå¯èƒ½ä¼šè¢«ç”¨äºè¿›è¡Œæ‹’ç»æœåŠ¡æ”»å‡»æˆ–å…¶ä»–æ¶æ„è¡Œä¸ºï¼Œä½†ä»ç›®å‰çš„ä»£ç å†…å®¹æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©ç›¸å¯¹è¾ƒä½ã€‚

**é¡¹ç›®åœ°å€:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #76

**æ¥æº**: [CVE-2025-29927-jeymo092_cve-2025-29927.md](../2025/CVE-2025-29927-jeymo092_cve-2025-29927.md)

## CVE-2025-29927-Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ï¼Œæ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ç‰¹å®šçš„è¯·æ±‚å¤´ (`x-middleware-subrequest`) æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œæœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®NVDå’Œå¤šä¸ªå®‰å…¨åšå®¢çš„ä¿¡æ¯ï¼Œè¯¥æ¼æ´CVSSè¯„åˆ†ä¸º9.1ï¼Œå±äºé«˜å±æ¼æ´ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œä¸”å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚ è¯¥æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰`README.md`æ–‡ä»¶ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªç©ºçš„ POC ä»“åº“ï¼Œæ‰€ä»¥æä¾›çš„POCä»£ç æœ¬èº«æ— æ•ˆï¼Œä»…ä»…æä¾›ä¸€ä¸ªå ä½ç¬¦ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ç”±äºæä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç åªæœ‰ `README.md` æ–‡ä»¶ï¼Œå†…å®¹æ˜¯å…³äºæ¼æ´çš„ä¿¡æ¯ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œçš„ä»£ç ï¼Œå› æ­¤æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚ä½†æ˜¯ï¼Œä¸èƒ½å®Œå…¨æ’é™¤æœªæ¥å‘æ­¤ä»“åº“æ·»åŠ æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ã€‚

**åˆ©ç”¨æ–¹å¼åˆ†æï¼š**

1.  **æ¼æ´è§¦å‘ï¼š** æ¼æ´çš„è§¦å‘ç‚¹åœ¨äº Next.js ä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **æ”»å‡»æ­¥éª¤ï¼š** æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  **ç»•è¿‡æˆæƒï¼š** Next.js ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†æˆ–å¿½ç•¥è¯¥è¯·æ±‚å¤´ï¼Œå¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  **æœªæˆæƒè®¿é—®ï¼š** æ”»å‡»è€…æˆåŠŸè®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†åå°æˆ–æ•æ„Ÿæ•°æ®ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** æ¼æ´æè¿°ä¸­å»ºè®®ï¼Œå¦‚æœæ— æ³•å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #77

**æ¥æº**: [CVE-2025-29927-jmbowes_NextSecureScan.md](../2025/CVE-2025-29927-jmbowes_NextSecureScan.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæƒé™æå‡

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµç‰¹å®šçš„HTTPè¯·æ±‚å¤´ï¼ˆ`X-Middleware-Subrequest`ï¼‰æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** è¯¥æ¼æ´æºäºNext.jsä¸­é—´ä»¶å¯¹`X-Middleware-Subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚
2.  **å½±å“ç‰ˆæœ¬ï¼š** Next.jsç‰ˆæœ¬ >= 11.1.4 ä¸” <= 13.5.6, > 14.0.0 ä¸” < 14.2.25, ä»¥åŠ > 15.0.0 ä¸” < 15.2.3ã€‚
3.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«ç‰¹åˆ¶çš„`X-Middleware-Subrequest`å¤´çš„HTTPè¯·æ±‚ï¼Œå³å¯ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚
4.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è¯¥æ¼æ´çš„æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å‘é€åŒ…å«`X-Middleware-Subrequest`å¤´çš„è¯·æ±‚æ¥åˆ¤æ–­ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚æ ¹æ®æè¿°ï¼Œè¯¥POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚
5.  **æŠ•æ¯’é£é™©ï¼š**  æä¾›çš„ä»£ç åº“ä¸»è¦æ˜¯ä¸€ä¸ªæ‰«æå·¥å…·ï¼Œå…¶ç›®çš„æ˜¯æ£€æµ‹Next.jsåº”ç”¨ç¨‹åºä¸­CVE-2025-29927æ¼æ´çš„å­˜åœ¨ã€‚ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼Œä¾‹å¦‚åå‘shellæˆ–æ•°æ®æ³„éœ²æœºåˆ¶ã€‚å®ƒä¸»è¦ä¾èµ–äºå‘é€ç‰¹å®šçš„HTTPè¯·æ±‚å¤´æ¥æµ‹è¯•ä¸­é—´ä»¶çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œå®ƒä»ç„¶å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šè¯¯ç”¨æ­¤è„šæœ¬ï¼Œæ”»å‡»æœªç»æˆæƒçš„ç³»ç»Ÿã€‚æ­¤å¤–ï¼Œæ¶æ„æ”»å‡»è€…ä¹Ÿå¯èƒ½ä¿®æ”¹æ‰«æå™¨ï¼Œæ·»åŠ æ¶æ„åŠŸèƒ½å¹¶åœ¨ç¤¾åŒºä¸­ä¼ æ’­ã€‚
6. **ç¼“è§£æªæ–½ï¼š**
   * å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šã€‚
   * åœ¨ä¸­é—´ä»¶ä¸­éªŒè¯`x-middleware-subrequest`å¤´ï¼Œç¡®ä¿å®ƒä¸æ˜¯æ¥è‡ªå¤–éƒ¨ç”¨æˆ·çš„è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #78

**æ¥æº**: [CVE-2025-29927-kOaDT_poc-cve-2025-29927.md](../2025/CVE-2025-29927-kOaDT_poc-cve-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** å—å½±å“ç‰ˆæœ¬ï¼š11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”è¿è¡Œäºå—å½±å“çš„ç‰ˆæœ¬èŒƒå›´å†…ã€‚ éœ€è¦ç½‘ç»œè®¿é—®ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ 

**æ¼æ´æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æ ¹æ®æ¼æ´åº“ä¿¡æ¯ã€æœç´¢å¼•æ“ç»“æœå’Œæä¾›çš„PoCä»£ç ï¼Œå¯ä»¥ç¡®è®¤è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚æ¼æ´åº“ä¿¡æ¯æ˜ç¡®æŒ‡å‡ºè¯¥æ¼æ´å­˜åœ¨äºç‰¹å®šç‰ˆæœ¬çš„Next.jsä¸­ï¼Œå¹¶æä¾›äº†ä¿®å¤ç‰ˆæœ¬ã€‚æœç´¢å¼•æ“ç»“æœä¸­ä¹ŸåŒ…å«äº†å¤šä¸ªå®‰å…¨å‚å•†å’Œç ”ç©¶äººå‘˜å¯¹è¯¥æ¼æ´çš„åˆ†æå’Œè­¦å‘Šã€‚PoCä»£ç æä¾›äº†ä¸€ç§åˆ©ç”¨è¯¥æ¼æ´çš„å…·ä½“æ–¹æ³•ï¼Œå³é€šè¿‡å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

æä¾›çš„PoCä»£ç ä¸»è¦åŒ…å«ä¸¤ä¸ªæ–‡ä»¶ï¼šREADME.md å’Œ exploit.jsã€‚

*   **README.mdï¼š** æè¿°äº†æ¼æ´çš„ç»†èŠ‚ã€å½±å“ã€ä¿®å¤ç‰ˆæœ¬ä»¥åŠPoCçš„ä½¿ç”¨æ–¹æ³•ã€‚è¯¥æ–‡ä»¶ä¸»è¦ç”¨äºæä¾›ä¿¡æ¯å’ŒæŒ‡å¯¼ï¼Œä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤ä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚
*   **exploit.jsï¼š** æ˜¯PoCçš„æ ¸å¿ƒä»£ç ï¼Œç”¨äºå‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´éƒ¨çš„æ¶æ„è¯·æ±‚ã€‚è¯¥ä»£ç ç›¸å¯¹ç®€å•ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å’Œå‘é€HTTP/HTTPSè¯·æ±‚ï¼Œå¹¶æ ¹æ®å“åº”åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»”ç»†æ£€æŸ¥åï¼Œå‘ç°exploit.jsæœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½æ˜¯å›´ç»•ç€æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚ä½†ä¾ç„¶éœ€è¦äººå·¥å®¡æ ¸ç¡®ä¿ä»£ç æ²¡æœ‰éšè—çš„é£é™©ã€‚

ç»¼åˆè€ƒè™‘ï¼Œæ­¤ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º5%ã€‚æ­¤å¤„çš„é£é™©ä¸»è¦æ¥è‡ªå¯¹ä»£ç çš„ä¿¡ä»»é—®é¢˜ï¼Œä»¥åŠå¯èƒ½å­˜åœ¨çš„ç¼–ç ç¼ºé™·å¸¦æ¥çš„å®‰å…¨é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…è¯†åˆ«å‡ºç›®æ ‡Next.jsåº”ç”¨ï¼Œå¹¶ç¡®è®¤å…¶ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„HTTP/HTTPSè¯·æ±‚ã€‚
3.  æ”»å‡»è€…å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨çš„å—ä¿æŠ¤è·¯ç”±ã€‚
4.  å¦‚æœåº”ç”¨å­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

1.  å‡çº§Next.jsç‰ˆæœ¬åˆ°å®‰å…¨ç‰ˆæœ¬ï¼ˆ>= 14.2.25 æˆ– >= 15.2.3ï¼‰ã€‚
2.  å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´éƒ¨çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚
3.  åœ¨ä¸­é—´ä»¶ä¸­æ·»åŠ é¢å¤–çš„éªŒè¯é€»è¾‘ï¼Œä»¥ç¡®ä¿è¯·æ±‚çš„åˆæ³•æ€§ã€‚

**é¡¹ç›®åœ°å€:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #79

**æ¥æº**: [CVE-2025-29927-kh4sh3i_CVE-2025-29927.md](../2025/CVE-2025-29927-kh4sh3i_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` header ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çœŸå®å­˜åœ¨ä¸”å±å®³è¾ƒé«˜ï¼ŒCVSSè¯„åˆ†9.1ã€‚è™½ç„¶æä¾›çš„ä»£ç ä»…ä¸ºLICENSEæ–‡ä»¶ï¼Œæ— æ³•ç›´æ¥éªŒè¯æ¼æ´ï¼Œä½†æ˜¯å­˜åœ¨å¤§é‡å…¬å¼€ä¿¡æ¯ä½è¯è¯¥æ¼æ´çš„å­˜åœ¨å’Œå¯åˆ©ç”¨æ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„ä»£ç æ˜¯CC0 1.0 Universal åè®®çš„è®¸å¯è¯æ–‡ä»¶ï¼Œä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  å‘é€åŒ…å« `x-middleware-subrequest` header çš„ HTTP è¯·æ±‚ã€‚
3.  ç”±äºNext.jså¤„ç†è¯¥headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘å¯èƒ½è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [kh4sh3i/CVE-2025-29927](https://github.com/kh4sh3i/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #80

**æ¥æº**: [CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md](../2025/CVE-2025-29927-kuzushiki_CVE-2025-29927-test.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ª Dockerfile å’Œç¤ºä¾‹ Next.js åº”ç”¨æ¥å¤ç°è¯¥æ¼æ´ã€‚Dockerfile ç”¨äºæ„å»ºåŒ…å«æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬çš„ç¯å¢ƒã€‚`README.md` æä¾›äº†å…³äºå¦‚ä½•ä½¿ç”¨ Docker æˆ–ç›´æ¥ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºçš„è¯´æ˜ã€‚`package-lock.json` åˆ—å‡ºäº†åº”ç”¨ç¨‹åºä¾èµ–é¡¹ï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„ Next.js ç‰ˆæœ¬ 15.2.2ã€‚ä»æœç´¢ç»“æœæ¥çœ‹ï¼Œå¤šä¸ªæ¥æºéƒ½ç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œä¸¥é‡æ€§ï¼Œå¹¶æä¾›äº†å…³äºæ¼æ´åŸç†å’Œåˆ©ç”¨æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚åˆ©ç”¨æ–¹å¼ï¼šæ”»å‡»è€…å‘é€åŒ…å«ç‰¹å®š headerï¼ˆx-middleware-subrequestï¼‰çš„æ¶æ„è¯·æ±‚ï¼ŒæœåŠ¡å™¨é”™è¯¯çš„å°†å…¶è¯†åˆ«ä¸ºå­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™éªŒè¯ä¸­é—´ä»¶ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
Dockerfile ç›¸å¯¹æ ‡å‡†ï¼Œä¸»è¦ç”¨äºæ­å»ºç¯å¢ƒã€‚ README.md ä¸»è¦æä¾›ä½¿ç”¨è¯´æ˜ï¼Œæ²¡æœ‰å¯ç–‘ä»£ç ã€‚ package-lock.json çœ‹èµ·æ¥æ˜¯æ ‡å‡†çš„ä¾èµ–å®šä¹‰æ–‡ä»¶ã€‚ é£é™©åœ¨äºï¼Œåœ¨ `npm run dev` æ¨¡å¼ä¸‹ï¼ŒNext.js ä¼šåŠ¨æ€åŠ è½½ä»£ç ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶äº†éƒ¨åˆ†åº”ç”¨ä»£ç ï¼Œå¯èƒ½ä¼šæ³¨å…¥æ¶æ„ä»£ç ã€‚è™½ç„¶æ¼æ´æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†åˆ©ç”¨è¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿›ä¸€æ­¥çš„æ”»å‡»ï¼Œä¾‹å¦‚è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œå› æ­¤æœ‰ä¸€å®šçš„æŠ•æ¯’é£é™©ï¼Œçº¦ä¸º10%ã€‚ä¸»è¦é£é™©åœ¨äºè¯¥POCæä¾›äº†ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„Next.jsé¡¹ç›®ï¼Œä½¿ç”¨è€…å®¹æ˜“ç›´æ¥ä½¿ç”¨è¯¥é¡¹ç›®ï¼Œå¦‚æœä½œè€…åœ¨pagesæˆ–å…¶ä»–æ–‡ä»¶ä¸­æ¤å…¥æ¶æ„ä»£ç ï¼Œä½¿ç”¨è€…å¯èƒ½åœ¨ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å¼•å…¥ã€‚

**é¡¹ç›®åœ°å€:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #81

**æ¥æº**: [CVE-2025-29927-l1uk_nextjs-middleware-exploit.md](../2025/CVE-2025-29927-l1uk_nextjs-middleware-exploit.md)

## CVE-2025-29927-Next.js-Middleware æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®ã€æ•°æ®æ³„éœ²å’Œæ½œåœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6ï¼Œ> 14.0.0, < 14.2.25ï¼Œ> 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµè¯¥æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œå¦‚ç®¡ç†é¡µé¢ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œå…¶ä¸­ `/admin` é¡µé¢å—ä¸­é—´ä»¶ä¿æŠ¤ã€‚ä¸­é—´ä»¶æ£€æŸ¥æ˜¯å¦å­˜åœ¨åä¸º `token` çš„ cookieï¼Œå¦‚æœ token ä¸æ˜¯ `CYBERUS`ï¼Œåˆ™é‡å®šå‘åˆ° `/login` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œåœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡æŸç§æ–¹å¼å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼Œå³å¯ç»•è¿‡tokençš„éªŒè¯è®¿é—®`/admin`é¡µé¢ã€‚è€ƒè™‘åˆ°ä»“åº“ä¸­åŒ…å« Dockerfile, docker-compose.yml ä»¥åŠå®Œæ•´çš„Next.jsé¡¹ç›®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯ä»¥åˆ¤å®šPOCæ˜¯æœ‰æ•ˆçš„ã€‚å…³äºæŠ•æ¯’é£é™©ï¼šPOCä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œä½†`README.md` ä¸­ç¼ºå°‘æ¸…æ™°çš„åˆ©ç”¨payloadå’Œåˆ©ç”¨æ–¹å¼ï¼Œä»…æç¤ºDIEGOï¼Œå¢åŠ äº†æ”»å‡»è€…ç†è§£å’Œä½¿ç”¨çš„éš¾åº¦ã€‚è¿™ç§æ¨¡ç³Šæ€§å¯èƒ½è¢«æ¶æ„åˆ©ç”¨ï¼Œè¯±å¯¼ç”¨æˆ·ä¿®æ”¹æˆ–æ·»åŠ æ¶æ„ä»£ç ã€‚å¦å¤–ï¼Œæ­¤ç¤ºä¾‹ä½¿ç”¨ Next.js 12.0.7 ç‰ˆæœ¬ï¼Œè™½ç„¶å±äºå—å½±å“ç‰ˆæœ¬ï¼Œä½†ç‰ˆæœ¬è¾ƒä½ï¼ŒæŸäº›ä¾èµ–å¯èƒ½å­˜åœ¨å·²çŸ¥æ¼æ´ï¼Œå¢åŠ æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§æ¦‚ä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #82

**æ¥æº**: [CVE-2025-29927-lediusa_CVE-2025-29927.md](../2025/CVE-2025-29927-lediusa_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªå…³é”®æ¼æ´ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡æ“çºµ`x-middleware-subrequest`æ ‡å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ§åˆ¶ã€‚ é€šè¿‡æ³¨å…¥æ­¤æ ‡å¤´ï¼Œæ”»å‡»è€…å¯ä»¥æ¬ºéª—æ¡†æ¶è·³è¿‡ä¸­é—´ä»¶æ‰§è¡Œï¼Œä¾‹å¦‚èº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“Next.jsç‰ˆæœ¬ 11.1.4 åˆ° 13.5.6ï¼Œ14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯å‘é€å¸¦æœ‰ç‰¹åˆ¶çš„`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ã€‚ æä¾›çš„Nucleiæ¨¡æ¿é€šè¿‡æ³¨å…¥x-middleware-subrequestæ ‡å¤´æ¥å°è¯•è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚å¦‚æœæœåŠ¡å™¨å“åº”200 OKçŠ¶æ€ï¼Œåˆ™è¡¨æ˜å¯èƒ½å­˜åœ¨èº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚æ ¹æ®ä»£ç ï¼Œä»“åº“ä¸­å¯èƒ½å­˜åœ¨è½»å¾®æŠ•æ¯’é£é™©ï¼Œä¸»è¦æ˜¯æŒ‡ä»“åº“ä¸­å¯èƒ½å­˜åœ¨å…¶ä»–æœªè¯´æ˜ç”¨é€”æˆ–è¡Œä¸ºçš„ä»£ç ï¼Œä½†é£é™©è¾ƒä½ï¼Œä¸º10%ã€‚

**é¡¹ç›®åœ°å€:** [lediusa/CVE-2025-29927](https://github.com/lediusa/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #83

**æ¥æº**: [CVE-2025-29927-lem0n817_CVE-2025-29927.md](../2025/CVE-2025-29927-lem0n817_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”å—å½±å“çš„ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´å­˜åœ¨äºNext.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25ï¼Œä»¥åŠå¤§äº 15.0.0 å°äº 15.2.3 çš„ç‰ˆæœ¬ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest: anything` è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚
2.  Next.jsåº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚
3.  ç”±äºæ¼æ´å­˜åœ¨ï¼Œä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†äº†`x-middleware-subrequest`å¤´ï¼Œå¯¼è‡´èº«ä»½éªŒè¯æ£€æŸ¥è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œè€Œæ— éœ€è¿›è¡Œæ­£ç¡®çš„èº«ä»½éªŒè¯ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•æ­¤æ¼æ´çš„ç¯å¢ƒã€‚å®ƒåŒ…å«ä¸€ä¸ª Next.js åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ¥ä¿æŠ¤æŸäº›è·¯ç”±ã€‚ é€šè¿‡è®¾ç½®cookieåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»é™†.æ”»å‡»è€…å¯ä»¥ä¿®æ”¹è¯·æ±‚å¤´ `x-middleware-subrequest` ç»•è¿‡èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç åº“ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚æ½œåœ¨çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦10%ã€‚ é£é™©ä¸»è¦åœ¨äºè¯¥æµ‹è¯•ç¯å¢ƒå¯èƒ½è¢«æ»¥ç”¨ï¼Œä¿®æ”¹æˆæ”»å‡»è½½è·ï¼Œé€ æˆæ›´å¤§èŒƒå›´çš„æ”»å‡»ã€‚ä¾‹å¦‚ï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ·»åŠ é¢å¤–çš„åé—¨è·¯ç”±æˆ–æ¶æ„è„šæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #84

**æ¥æº**: [CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-lirantal_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼æ˜¯ï¼Œé€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µï¼Œå¹¶é‡å¤ `middleware` å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ¬ºéª— Next.js ç»•è¿‡æˆæƒã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.js` æ–‡ä»¶å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„æˆæƒé€»è¾‘ï¼Œéœ€è¦ `Authorization` å¤´ä¸º `my-jwt-token-here`ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰æ„é€ çš„ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ç»•è¿‡æ­¤æ£€æŸ¥ã€‚å¯¹äºæ—§ç‰ˆæœ¬çš„ Next.jsï¼Œä¸­é—´ä»¶æ–‡ä»¶åå¯èƒ½ä¸åŒï¼ˆä¾‹å¦‚ï¼Œ`_middleware.js`ï¼‰ï¼Œå› æ­¤éœ€è¦è°ƒæ•´ `x-middleware-subrequest` çš„å€¼ã€‚ä»£ç ä»“åº“ä¸­æœªå‘ç°æ˜æ˜¾çš„æ¶æ„æŠ•æ¯’ä»£ç ï¼Œjsconfig.jsonï¼Œnext.config.mjs å’Œ package-lock.json éƒ½æ¯”è¾ƒå¸¸è§„ï¼ŒREADME.md åªæ˜¯æ¼æ´åˆ©ç”¨è¯´æ˜ï¼Œmiddleware.js æœ¬èº«åªæ˜¯éªŒè¯ä¸­é—´ä»¶ç»•è¿‡çš„åŠŸèƒ½ï¼Œæ²¡æœ‰å‘ç°é¢å¤–åé—¨ï¼Œå› æ­¤åˆ¤æ–­æŠ•æ¯’é£é™©æä½ï¼Œå¤§çº¦ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #85

**æ¥æº**: [CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md](../2025/CVE-2025-29927-lucaschanzx_CVE-2025-29927-PoC.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨Middlewareè¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘ä¸­ã€‚åœ¨å—å½±å“çš„ç‰ˆæœ¬ä¸­ï¼Œå½“æƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­æ—¶ï¼Œå¯èƒ½è¢«ç»•è¿‡ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚

æä¾›çš„ä»£ç ç¤ºä¾‹åŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

*   `README.md`:  Next.js é¡¹ç›®çš„ä»‹ç»æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `middleware.ts`:  Next.js ä¸­é—´ä»¶ä»£ç ï¼Œå®ç°äº†ç®€å•çš„æƒé™éªŒè¯ã€‚å¦‚æœè¯·æ±‚çš„è·¯å¾„ä»¥ `/private` å¼€å¤´ï¼Œå¹¶ä¸” `authorization` header ä¸ç­‰äº `secret-token`ï¼Œåˆ™è¿”å› 401 Unauthorizedã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¼æ´åˆ©ç”¨ä»£ç ã€‚

è™½ç„¶æ²¡æœ‰ç›´æ¥çš„åˆ©ç”¨ä»£ç ï¼Œä½†`middleware.ts`å®šä¹‰äº†ä¸€ä¸ªä¸å®‰å…¨çš„èº«ä»½éªŒè¯é€»è¾‘, æ”»å‡»è€…å¯ä»¥å°è¯•ç»•è¿‡ï¼Œè¯¥æ¼æ´è¯´æ˜ä¸­æåˆ°ï¼Œ`x-middleware-subrequest`å¤´éƒ¨å¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œè™½ç„¶ç¤ºä¾‹æ²¡æœ‰ç›´æ¥ä½¿ç”¨è¯¥å¤´éƒ¨ï¼Œä½†ç†è§£å¦‚ä½•åˆ©ç”¨è¯¥å¤´éƒ¨ä¸ä¸­é—´ä»¶è®¤è¯é€»è¾‘ä¹‹é—´çš„äº¤äº’æ˜¯å…³é”®ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æŠ•æ¯’ä»£ç ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½æ˜¯æ ‡å‡†çš„ Next.js é¡¹ç›®æ–‡ä»¶ï¼Œå¹¶ä¸”ä¸­é—´ä»¶ä»£ç è™½ç„¶å­˜åœ¨æ¼æ´ï¼Œä½†ä¸æ˜¯æ¶æ„ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ ¹æ®æ¼æ´æè¿°ï¼Œå¯èƒ½çš„åˆ©ç”¨æ–¹å¼æ˜¯ï¼š

1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚ï¼š** å°è¯•å‘é€å¸¦æœ‰ `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆ`/private`ï¼‰ã€‚å¦‚æœ Next.js ä¸­é—´ä»¶å¯¹è¯¥ header çš„å¤„ç†å­˜åœ¨ç¼ºé™·ï¼Œå¯èƒ½å¯¼è‡´æƒé™éªŒè¯è¢«ç»•è¿‡ã€‚
2.  **å…¶ä»–ç»•è¿‡æ–¹å¼ï¼š**  è™½ç„¶æ²¡æœ‰å…·ä½“ç»†èŠ‚ï¼Œä½†æ¼æ´æè¿°è¡¨æ˜å¯èƒ½å­˜åœ¨å…¶ä»–ç»•è¿‡æƒé™éªŒè¯çš„æ–¹å¼ï¼Œéœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ Next.js ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚ã€‚

æ”»å‡»è€…éœ€è¦æ„é€ ç‰¹å®šçš„è¯·æ±‚ï¼Œåˆ©ç”¨ Next.js ä¸­é—´ä»¶çš„æ¼æ´ï¼Œç»•è¿‡æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**ç¼“è§£æªæ–½ï¼š**

*   å‡çº§åˆ° Next.js çš„å®‰å…¨ç‰ˆæœ¬ï¼ˆ14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰ã€‚
*   å¦‚æœæ— æ³•å‡çº§ï¼Œå¯ä»¥é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾ Next.js åº”ç”¨ç¨‹åºã€‚

**é¡¹ç›®åœ°å€:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #86

**æ¥æº**: [CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md](../2025/CVE-2025-29927-m2hcz_m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œè®¤è¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶çš„ä¸€ä¸ªè®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„ Python è„šæœ¬æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ POCï¼Œå®ƒé€šè¿‡è®¾ç½® `x-middleware-subrequest` å¤´æ¥å°è¯•ç»•è¿‡è®¤è¯ã€‚å¦‚æœç›®æ ‡ Next.js åº”ç”¨å­˜åœ¨æ­¤æ¼æ´ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™è¯¥è„šæœ¬å¯ä»¥æˆåŠŸè®¿é—®é€šå¸¸éœ€è¦è®¤è¯çš„ `/admin` è·¯å¾„ï¼ˆæˆ–å…¶ä»–å—ä¿æŠ¤è·¯ç”±ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯¥ POC ä»£ç çš„æŠ•æ¯’é£é™©æä½ï¼Œä»£ç éå¸¸ç®€æ´ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®š HTTP å¤´çš„è¯·æ±‚å¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ã€‚æ²¡æœ‰å‘ç°ä»»ä½•éšè—çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚æ‰€æœ‰æ“ä½œéƒ½é›†ä¸­äºåˆ©ç”¨å·²çŸ¥çš„è®¤è¯ç»•è¿‡æ¼æ´ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest` å­—æ®µï¼Œå¹¶è®¾ç½®ç‰¹å®šçš„å€¼ï¼Œä¾‹å¦‚ "middleware:middleware:middleware:middleware:middleware"ã€‚
3.  æ”»å‡»è€…å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼ˆä¾‹å¦‚ `/admin`ï¼‰ã€‚
4.  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒNext.js ä¸­é—´ä»¶å°†æ— æ³•æ­£ç¡®éªŒè¯è¯·æ±‚ï¼Œä»è€Œå…è®¸æ”»å‡»è€…æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚
5.  æœç´¢å¼•æ“ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ï¼Œå¹¶æä¾›äº†ç›¸å…³çš„ä¿®å¤ä¿¡æ¯ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ©ç”¨è¯¥æ¼æ´çš„å…³é”®åœ¨äºæ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #87

**æ¥æº**: [CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md](../2025/CVE-2025-29927-maronnjapan_claude-create-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡æ¼æ´

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»è¢«å¹¿æ³›æŠ¥é“ã€‚æä¾›çš„POCä»£ç åŒ…å«ä¸€ä¸ªå®Œæ•´çš„æµ‹è¯•ç¯å¢ƒï¼ŒåŒ…æ‹¬æ˜“å—æ”»å‡»çš„Next.jsåº”ç”¨ã€æµ‹è¯•è„šæœ¬å’Œè¯¦ç»†çš„æ–‡æ¡£ã€‚è¿™äº›è„šæœ¬é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚æ¥éªŒè¯æ¼æ´çš„å­˜åœ¨ï¼Œå› æ­¤POCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**
POCä»£ç æ—¨åœ¨æµ‹è¯•å’Œæ¼”ç¤ºæ¼æ´ï¼Œè€Œéè¿›è¡Œæ¶æ„æ´»åŠ¨ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç åº“éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ã€‚è€ƒè™‘åˆ°è¯¥é¡¹ç›®çš„ä¸»è¦ç›®çš„æ˜¯å®‰å…¨æµ‹è¯•ï¼Œä½œè€…éšè—æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é£é™©ä¸»è¦åœ¨äºä½¿ç”¨è€…å¯èƒ½é”™è¯¯åœ°ç†è§£æˆ–æ¶æ„åœ°ä½¿ç”¨è¿™äº›ä»£ç ï¼Œä¾‹å¦‚ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿›è¡Œæœªç»æˆæƒçš„æ¸—é€æµ‹è¯•ã€‚ä»£ç ä»“åº“çš„æ£€æµ‹é€»è¾‘ä¸»è¦é€šè¿‡headeræ¥ç»•è¿‡éªŒè¯ï¼Œå±äºå¯¹æ¼æ´çš„æ­£å¸¸åˆ©ç”¨ï¼Œä¸è§†ä¸ºæŠ•æ¯’ã€‚ç»¼åˆè¯„ä¼°ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…æ„é€ ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­åŒ…å« `x-middleware-subrequest: middleware` ã€‚
2.  å°†è¯¥è¯·æ±‚å‘é€åˆ°å—ä¿æŠ¤çš„Next.jsè·¯ç”±æˆ–APIç«¯ç‚¹ã€‚
3.  å¦‚æœNext.jsåº”ç”¨çš„ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œä¸­é—´ä»¶å°†é”™è¯¯åœ°è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œè·³è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚
4.  æ”»å‡»è€…æˆåŠŸç»•è¿‡æˆæƒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [maronnjapan/claude-create-CVE-2025-29927](https://github.com/maronnjapan/claude-create-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #88

**æ¥æº**: [CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md](../2025/CVE-2025-29927-mhamzakhattak_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯ã€‚

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

è¯¥æ¼æ´å­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„è¯·æ±‚ï¼Œç›´æ¥è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„PoCä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚æ ¹æ®æ¼æ´æè¿°å’Œåˆ©ç”¨ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è®¾ç½®`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ç»è¿‡åˆ†æï¼Œæ­¤ä»“åº“å­˜åœ¨ä¸€å®šæŠ•æ¯’é£é™©ã€‚è™½ç„¶æ ¸å¿ƒçš„æ¼æ´åˆ©ç”¨ä»£ç ç›¸å¯¹ç®€å•ç›´æ¥ï¼Œä½†DockerfileæŒ‡å®šäº† node:14-alpineï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²æ¼æ´ã€‚

  *   `exploit.py`ï¼šè¯¥è„šæœ¬åŠŸèƒ½æ˜ç¡®ï¼Œç›®çš„æ˜¯é€šè¿‡å‘é€ç‰¹å®šHTTPè¯·æ±‚æ¥åˆ©ç”¨æ¼æ´ã€‚æ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æ¶æ„ä»£ç ã€‚ä»£ç é€»è¾‘ç®€å•æ¸…æ™°ï¼Œä¸»è¦æ˜¯æ„é€ å¸¦æœ‰ç‰¹å®šheaderçš„è¯·æ±‚ã€‚ä½†å­˜åœ¨è¢«å…¶ä»–æ¶æ„ç¨‹åºç¯¡æ”¹çš„å¯èƒ½
  *   `Dockerfile`ï¼šDockerfileæŒ‡å®šäº†node:14-alpineä½œä¸ºåŸºç¡€é•œåƒï¼Œå¯èƒ½å­˜åœ¨ä¸€äº›å†å²å®‰å…¨æ¼æ´,éœ€è¦å¯¹dockerå†…å®¹åšè¿›ä¸€æ­¥çš„æ£€æŸ¥ã€‚
  *   `middleware.js`ï¼šè¯¥æ–‡ä»¶åŒ…å«å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶éªŒè¯é€»è¾‘ï¼Œä¸å­˜åœ¨æ¶æ„ä»£ç ã€‚

å› æ­¤ï¼Œç»¼åˆåˆ¤æ–­ï¼Œè¯¥ä»“åº“å­˜åœ¨**10%**çš„æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
2.  ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
3.  æ”»å‡»è€…å‘é€å¸¦æœ‰`x-middleware-subrequest: middleware`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  ä¸­é—´ä»¶éªŒè¯é€»è¾‘å¤±æ•ˆï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœç´¢å¼•æ“ç»“æœä½è¯ï¼š** æœç´¢ç»“æœä¸­çš„å¤šä¸ªé“¾æ¥è¡¨æ˜è¯¥æ¼æ´ç¡®å®å­˜åœ¨ï¼Œå¹¶ä¸”æ˜¯ç”±äºå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“é€ æˆçš„ã€‚

**é¡¹ç›®åœ°å€:** [mhamzakhattak/CVE-2025-29927](https://github.com/mhamzakhattak/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #89

**æ¥æº**: [CVE-2025-29927-mickhacking_Thank-u-Next.md](../2025/CVE-2025-29927-mickhacking_Thank-u-Next.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”å—åˆ°å½±å“çš„ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å…è®¸æ”»å‡»è€…ç»•è¿‡Next.jsåº”ç”¨ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå¦‚æœæˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº`x-middleware-subrequest`å¤´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒã€‚æ ¹æ®æœç´¢ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†å·²ç»å‘å¸ƒäº†å…³äºè¯¥æ¼æ´çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„ä»£ç ç‰‡æ®µåªæ˜¯GPLè®¸å¯åè®®ï¼Œå¹¶éæ¼æ´åˆ©ç”¨ä»£ç ï¼Œå› æ­¤æ— æ³•ç›´æ¥è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœå‡è¡¨æ˜è¯¥æ¼æ´å¯è¢«åˆ©ç”¨ï¼Œæ¨æ–­æ¼æ´åˆ©ç”¨çš„æœ‰æ•ˆæ€§è¾ƒé«˜ã€‚ä»£ç ç‰‡æ®µä¸ºLICENSEæ–‡ä»¶ï¼Œå¹¶æœªå‘ç°ä»»ä½•æŠ•æ¯’ä»£ç ï¼Œå› æ­¤æŠ•æ¯’é£é™©ä¸º0%ã€‚åˆ©ç”¨æ–¹å¼æ˜¯å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚ä¿®å¤å»ºè®®æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [mickhacking/Thank-u-Next](https://github.com/mickhacking/Thank-u-Next)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #90

**æ¥æº**: [CVE-2025-29927-moften_CVE-2025-29927.md](../2025/CVE-2025-29927-moften_CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨ Next.jsï¼Œå¹¶ä¸”ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶è¿›è¡Œè®¤è¯ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¯¹ `x-middleware-subrequest` è¯·æ±‚å¤´å¤„ç†ä¸å½“ã€‚å½“åº”ç”¨åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæƒé™éªŒè¯æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` è¯·æ±‚å¤´çš„è¯·æ±‚æ¥ç»•è¿‡è®¤è¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **æ£€æµ‹ï¼š** POC ä»£ç é¦–å…ˆé€šè¿‡å‘é€ GET è¯·æ±‚åˆ°ç›®æ ‡ URLï¼Œç„¶åæ£€æŸ¥å“åº”å¤´ä¸­æ˜¯å¦åŒ…å« Next.js ç‰¹æœ‰çš„æ ‡è¯†ï¼Œä¾‹å¦‚ `x-powered-by`ï¼Œ`x-nextjs-cache` ç­‰ã€‚å¦‚æœæ£€æµ‹åˆ° Next.js å¹¶ä¸”çŠ¶æ€ç ä¸º 200ï¼Œåˆ™è®¤ä¸ºç›®æ ‡å¯èƒ½å­˜åœ¨æ¼æ´ã€‚
2.  **ç»•è¿‡è®¤è¯ï¼š** æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äº `x-middleware-subrequest` è¯·æ±‚å¤´ã€‚æ”»å‡»è€…éœ€è¦åœ¨å‘é€åˆ° Next.js åº”ç”¨çš„è¯·æ±‚ä¸­æ·»åŠ è¿™ä¸ªè¯·æ±‚å¤´ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„è®¤è¯æ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤èµ„æºï¼š** ä¸€æ—¦æˆåŠŸç»•è¿‡è®¤è¯ï¼Œæ”»å‡»è€…å°±å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**

POC ä»£ç çš„æœ‰æ•ˆæ€§åœ¨äºå®ƒå¯ä»¥å¸®åŠ©å®‰å…¨ç ”ç©¶äººå‘˜å’Œå¼€å‘äººå‘˜å¿«é€Ÿæ£€æµ‹ Next.js åº”ç”¨æ˜¯å¦å­˜åœ¨ CVE-2025-29927 æ¼æ´ã€‚POC è„šæœ¬é€šè¿‡æ£€æŸ¥ HTTP å“åº”å¤´æ¥åˆ¤æ–­ç›®æ ‡ç«™ç‚¹æ˜¯å¦ä½¿ç”¨äº† Next.js æ¡†æ¶ï¼Œä»è€Œå¸®åŠ©ç”¨æˆ·éªŒè¯ç›®æ ‡æ˜¯å¦ä¸ºå—å½±å“çš„ Next.js åº”ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ POC ä»£ç ä¸­æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ï¼Œé£é™©è¾ƒä½ã€‚ä»£ç åŠŸèƒ½ä¸»è¦æ˜¯å‘é€ HTTP è¯·æ±‚ï¼Œæ£€æµ‹ Next.js çš„å­˜åœ¨å¹¶æ‰“å°å“åº”å¤´ã€‚å› æ­¤ï¼Œè¯¥ä»£ç è¢«æŠ•æ¯’çš„å¯èƒ½æ€§å¾ˆä½ã€‚å¯ä»¥è®¤ä¸ºæŠ•æ¯’é£é™©æ˜¯0%ã€‚

**é¡¹ç›®åœ°å€:** [moften/CVE-2025-29927](https://github.com/moften/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #91

**æ¥æº**: [CVE-2025-29927-nicknisi_next-attack.md](../2025/CVE-2025-29927-nicknisi_next-attack.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œäº†æƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ¼æ´çš„æ ¹æºåœ¨äº Next.js å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ã€‚è¯¥æ¼æ´å½±å“ Next.js 11.1.4 åˆ° 13.5.6ã€14.0.0 åˆ° 14.2.25 ä»¥åŠ 15.0.0 åˆ° 15.2.3 ç‰ˆæœ¬ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æä¾›çš„æ¼æ´ä¿¡æ¯å’Œåˆ©ç”¨ä»£ç ï¼Œè¯¥æ¼æ´çš„ POC ä»£ç æ˜¯æœ‰æ•ˆçš„ã€‚POC é€šè¿‡è®¾ç½®ç‰¹å®šçš„ `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ `/api/admin`ï¼‰ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä»“åº“ä¸»è¦æ˜¯æ¼”ç¤ºæ¼æ´çš„åˆ©ç”¨ï¼Œå­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„é£é™©è¾ƒä½ã€‚`package-lock.json`æ–‡ä»¶å¯èƒ½å­˜åœ¨æŠ•æ¯’é£é™©ï¼Œä½†æ¦‚ç‡è¾ƒä½ã€‚`next.config.ts`æ˜¯ä¸€ä¸ªåŸºæœ¬çš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§å¾ˆå°ã€‚è€Œæä¾›çš„ POC ä»£ç ä¸»è¦ç›®çš„æ˜¯æ¼”ç¤ºæ¼æ´ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ¶æ„æ“ä½œã€‚è™½ç„¶æ— æ³•å®Œå…¨æ’é™¤é£é™©ï¼Œä½†å¯ä»¥è®¤ä¸ºè¯¥ä»£ç ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  Next.js åº”ç”¨åœ¨å¤„ç†è¯¥è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®éªŒè¯ `x-middleware-subrequest` å¤´çš„æœ‰æ•ˆæ€§ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ã€‚
3.  æ”»å‡»è€…å› æ­¤å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºï¼Œä¾‹å¦‚ç®¡ç†é¡µé¢æˆ– API ç«¯ç‚¹ã€‚

ç®€å•æ¥è¯´ï¼Œæ”»å‡»è€…é€šè¿‡ä¼ªé€ å†…éƒ¨å­è¯·æ±‚ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ã€‚

**ç¼“è§£æªæ–½:**

*   å‡çº§åˆ° Next.js 14.2.25 æˆ– 15.2.3 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚
*   é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #92

**æ¥æº**: [CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md](../2025/CVE-2025-29927-nocomp_CVE-2025-29927-scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 13.5.6, >14.0.0 < 14.2.25, >15.0.0 < 15.2.3, >= 11.1.4 <= 13.5.6

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 20%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œå¦‚æœ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚

**æœ‰æ•ˆæ€§ï¼š**

*   ä»æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœæ¥çœ‹ï¼Œæ­¤æ¼æ´æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å½±å“äº†å¤šä¸ªç‰ˆæœ¬çš„Next.jsã€‚
*   æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªPythonè„šæœ¬ï¼Œç”¨äºæ£€æµ‹ç›®æ ‡ç½‘ç«™æ˜¯å¦ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ã€‚
*   è„šæœ¬é€šè¿‡å‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç„¶åè§£æå“åº”å†…å®¹ï¼ŒæŸ¥æ‰¾Next.jsçš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å¦‚æœæ‰¾åˆ°ç‰ˆæœ¬ä¿¡æ¯ï¼Œè„šæœ¬ä¼šæ£€æŸ¥è¯¥ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“çš„èŒƒå›´å†…ã€‚
*   è™½ç„¶æ­¤è„šæœ¬ä¸»è¦æ˜¯æ£€æµ‹ç‰ˆæœ¬ï¼Œä½†å¯ä»¥ä½œä¸ºæ¼æ´åˆ©ç”¨çš„å‰ç½®æ­¥éª¤ï¼Œç¡®è®¤ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾…åŠ©åˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

*   æ­¤ä»£ç å­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚
*   ä»¥ä¸‹æ˜¯é£é™©åˆ†æï¼š
    *   **subprocess.run() å‡½æ•°**: è„šæœ¬ä½¿ç”¨ `subprocess.run()` æ¥æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œå¦‚ `subfinder`, `dig`, `host`ã€‚å¦‚æœæ”»å‡»è€…æ§åˆ¶äº†è¿™äº›å‘½ä»¤çš„è¾“å…¥æˆ–æ‰§è¡Œè·¯å¾„ï¼Œä»–ä»¬å¯ä»¥æ³¨å…¥æ¶æ„å‘½ä»¤ã€‚
    *   **urllib3.disable_warnings()**: ç¦ç”¨ HTTPS è­¦å‘Šå¯èƒ½ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ã€‚
    *   **request.get(url, verify=False)**: ç¦ç”¨ SSL è¯ä¹¦éªŒè¯å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„é£é™©ï¼Œå¯èƒ½å…è®¸æ”»å‡»è€…æ‹¦æˆªæˆ–ç¯¡æ”¹æµé‡ã€‚
*   è¯„ä¼°ï¼šsubprocessæ¨¡å—çš„é£é™©ç›¸å¯¹è¾ƒé«˜ï¼Œå…¶ä»–é£é™©ç›¸å¯¹è¾ƒä½ï¼Œæ•´ä½“**æŠ•æ¯’é£é™©ä¸º20%**ï¼Œä¸»è¦æ¥è‡ª subprocess æ‰§è¡Œçš„å¤–éƒ¨å‘½ä»¤ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç‰ˆæœ¬æ£€æµ‹ï¼š** ä½¿ç”¨æä¾›çš„Pythonè„šæœ¬æ£€æµ‹ç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬ã€‚
2.  **å‘é€æ¶æ„è¯·æ±‚ï¼š**  å¦‚æœç›®æ ‡ç½‘ç«™ä½¿ç”¨çš„Next.jsç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œæ”»å‡»è€…å¯ä»¥å°è¯•å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **è·å–æœªæˆæƒè®¿é—®æƒé™ï¼š** æˆåŠŸç»•è¿‡æˆæƒæ£€æŸ¥åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºæˆ–æ‰§è¡Œæ“ä½œã€‚

æ­¤æ¼æ´çš„æ ¸å¿ƒåœ¨äº`x-middleware-subrequest`æ ‡å¤´çš„å¤„ç†ä¸å½“ã€‚Next.jså®˜æ–¹å»ºè®®ä¸´æ—¶ç¼“è§£æªæ–½æ˜¯é˜»æ­¢åŒ…å«æ­¤æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚åˆ°è¾¾åº”ç”¨ï¼Œç›´åˆ°å‡çº§åˆ°ä¿®å¤ç‰ˆæœ¬ã€‚

**é¡¹ç›®åœ°å€:** [nocomp/CVE-2025-29927-scanner](https://github.com/nocomp/CVE-2025-29927-scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #93

**æ¥æº**: [CVE-2025-29927-nyctophile0969_CVE-2025-29927.md](../2025/CVE-2025-29927-nyctophile0969_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’Œæ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æºäº Next.js å¤„ç† `x-middleware-subrequest` header çš„æ–¹å¼å­˜åœ¨è®¾è®¡ç¼ºé™·ã€‚æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥ header ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æœç´¢å¼•æ“çš„ç»“æœï¼Œå¤šä¸ªå®‰å…¨å‚å•†éƒ½å…³æ³¨å¹¶åˆ†æäº†è¯¥æ¼æ´ï¼Œç¡®è®¤å…¶å½±å“å’Œåˆ©ç”¨æ–¹å¼ã€‚æä¾›çš„POCä»£ç åŒ…å«äº†ä¸€ä¸ªç®€å•çš„ Next.js åº”ç”¨ï¼Œè¯¥åº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚æ¼æ´åˆ©ç”¨çš„æ–¹å¼æ˜¯æ„é€ åŒ…å«ç‰¹å®š `x-middleware-subrequest` header çš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—® `/dashboard` é¡µé¢ï¼Œå³ä½¿æ²¡æœ‰æœ‰æ•ˆçš„ tokenã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºä»£ç é‡è¾ƒå°‘ï¼Œä¸»è¦é€»è¾‘é›†ä¸­åœ¨ `middleware.js` æ–‡ä»¶ä¸­ï¼Œå…¶ä¸­åŒ…å«éªŒè¯é€»è¾‘å’Œè·¯ç”±é‡å®šå‘ã€‚å°½ç®¡å¯èƒ½æ€§è¾ƒä½ï¼Œ`package-lock.json` ä¸­å¯èƒ½å­˜åœ¨ä¾èµ–æŠ•æ¯’çš„é£é™©ï¼Œæˆ–è€…ä½œè€…é€šè¿‡å…¶ä»–ä¸æ˜æ˜¾çš„æ–¹å¼æ·»åŠ æ¶æ„ä»£ç ã€‚`lib/auth.js`ï¼ˆæœªæä¾›ï¼‰ä¹Ÿå¯èƒ½å­˜åœ¨åé—¨æˆ–æ¼æ´ã€‚å› æ­¤ï¼Œæ€»ä½“æŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10% ã€‚

**é¡¹ç›®åœ°å€:** [nyctophile0969/CVE-2025-29927](https://github.com/nyctophile0969/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #94

**æ¥æº**: [CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md](../2025/CVE-2025-29927-olimpiofreitas_CVE-2025-29927_scanner.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä¾èµ–äºä¸­é—´ä»¶ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨æ–¹å¼å¦‚ä¸‹ï¼š

1.  **æ¼æ´æè¿°ï¼š** Next.jsåº”ç”¨å¦‚æœä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ï¼Œåˆ™å¯èƒ½å­˜åœ¨æ­¤æ¼æ´ã€‚
2.  **åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„HTTPè¯·æ±‚ï¼Œè¯¥è¯·æ±‚ä¼šè¢«ä¸æ­£ç¡®åœ°å¤„ç†ï¼Œå¯¼è‡´ç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚
3.  **POCæœ‰æ•ˆæ€§ï¼š** æä¾›çš„Pythonè„šæœ¬å°è¯•æ£€æµ‹ç›®æ ‡URLæ˜¯å¦ä½¿ç”¨äº†Next.jsï¼Œè·å–ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¹¶å°è¯•é€šè¿‡è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é€šè¿‡æ£€æŸ¥æœåŠ¡å™¨å¤´å’Œé¡µé¢å†…å®¹æ¥ç¡®å®šNext.jsç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨é»˜è®¤è·¯ç”±åˆ—è¡¨æˆ–è‡ªå®šä¹‰è·¯ç”±åˆ—è¡¨æµ‹è¯•æˆæƒç»•è¿‡ã€‚
4.  **æŠ•æ¯’é£é™©ï¼š** è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œä½†å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«ä¿®æ”¹ä¸ºå°è¯•åˆ©ç”¨è¯¥æ¼æ´è¿›è¡Œæ”»å‡»ã€‚ä½†ä»ç°æœ‰ä»£ç æ¥çœ‹ï¼Œå…¶é£é™©ç‚¹ä¸»è¦åœ¨äºï¼š
    * åˆ›å»º`routes.txt`æ–‡ä»¶ï¼šå¦‚æœè„šæœ¬è¢«æ”¾ç½®åœ¨å…·æœ‰å†™å…¥æƒé™çš„ç›®å½•ä¸­ï¼Œå¯èƒ½ä¼šåˆ›å»ºæ–‡ä»¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å°çš„æƒé™é—®é¢˜ï¼Œä½†ä¸å¤ªå¯èƒ½æ„æˆä¸¥é‡çš„æŠ•æ¯’ã€‚
    * ä¾èµ–å¤–éƒ¨åº“ï¼ˆrequests, urllib3ï¼‰ï¼šè™½ç„¶è¿™äº›æ˜¯å¸¸è§çš„åº“ï¼Œä½†æ¶æ„ä¿®æ”¹å¯èƒ½ä¼šå¯¼è‡´è¯·æ±‚é‡å®šå‘åˆ°æ¶æ„ç«™ç‚¹æˆ–æ‰§è¡Œå…¶ä»–æ¶æ„æ“ä½œã€‚
    * å¿½ç•¥SSLè¯ä¹¦éªŒè¯ï¼ˆ`verify=False`ï¼‰ï¼šè¿™æœ¬èº«ä¸æ˜¯æŠ•æ¯’ï¼Œä½†ä¼šä½¿è„šæœ¬æ›´å®¹æ˜“å—åˆ°ä¸­é—´äººæ”»å‡»ï¼Œä»è€Œå¯èƒ½è¢«ç¯¡æ”¹ã€‚
5.  **ç¼“è§£æªæ–½ï¼š** å‡çº§Next.jsç‰ˆæœ¬åˆ°14.2.25æˆ–15.2.3åŠä»¥ä¸Šï¼Œæˆ–è€…é˜»æ­¢åŒ…å«`x-middleware-subrequest`æ ‡å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨ã€‚

**é¡¹ç›®åœ°å€:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #95

**æ¥æº**: [CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md](../2025/CVE-2025-29927-pickovven_vulnerable-nextjs-14-CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥ï¼Œå¹¶ä¸”ç‰ˆæœ¬å­˜åœ¨æ¼æ´ã€‚

**POC å¯ç”¨æ€§:** æ˜¯ï¼Œä½†æä¾›çš„ä»£ç ä¸å®Œæ•´

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ï¼Œå½±å“å¤šä¸ªç‰ˆæœ¬ã€‚è¯¥æ¼æ´å‡ºç°åœ¨Next.jsä¸­é—´ä»¶ä¸­ï¼Œå¦‚æœåº”ç”¨ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯æˆ–æˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åˆ©ç”¨çš„å…³é”®åœ¨äºNext.jså¯¹è¯¥è¯·æ±‚å¤´çš„å¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„POCä»£ç `README.md`ä»…åŒ…å«æ ‡é¢˜ï¼Œæ˜¯ä¸€ä¸ªä¸å®Œæ•´çš„POCï¼Œæ— æ³•ç›´æ¥ç”¨äºæ¼æ´åˆ©ç”¨ã€‚éœ€è¦æ›´è¯¦ç»†çš„åˆ©ç”¨è„šæœ¬æˆ–æ­¥éª¤ã€‚

**æŠ•æ¯’é£é™©ï¼š**
ç”±äºæä¾›çš„POCä»£ç åªæœ‰ä¸€ä¸ª`README.md`æ–‡ä»¶ï¼Œå†…å®¹å¾ˆå°‘ï¼ŒåŸºæœ¬å¯ä»¥æ’é™¤ç›´æ¥æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€ç»å¯¹å®‰å…¨ï¼Œä½œè€…ä»ç„¶å¯èƒ½åœ¨å…¶ä»–åœ°æ–¹éšè—æ¶æ„ä»£ç ï¼ˆæ¯”å¦‚å®Œæ•´çš„åˆ©ç”¨è„šæœ¬ï¼‰ã€‚å› æ­¤ï¼Œå‡è®¾å­˜åœ¨**10%** çš„æŠ•æ¯’é£é™©ï¼Œä¸»è¦è€ƒè™‘åˆ°æœªæ¥å¯èƒ½å‡ºç°æ›´å®Œæ•´çš„POCï¼Œéœ€è¦ä¿æŒè­¦æƒ•ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘Next.jsåº”ç”¨å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest`è¯·æ±‚å¤´çš„HTTPè¯·æ±‚ã€‚é€šè¿‡æ„é€ æ¶æ„çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚ä¿®å¤æ­¤æ¼æ´çš„æ–¹æ³•æ˜¯å‡çº§åˆ°Next.js 14.2.25æˆ–15.2.3åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œæˆ–è€…åœ¨middlewareå±‚å¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒã€‚

**é¡¹ç›®åœ°å€:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #96

**æ¥æº**: [CVE-2025-29927-pixilated730_NextJS-Exploit-.md](../2025/CVE-2025-29927-pixilated730_NextJS-Exploit-.md)

## CVE-2025-29927-Next.js-Middlewareæƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæ¶æ„æ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æƒé™æ ¡éªŒé€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚è¯¥æ¼æ´æ˜¯ç”±äºNext.jså¯¹`x-middleware-subrequest`headerå¤„ç†ä¸å½“å¯¼è‡´çš„ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«è¯¥headerçš„æ¶æ„è¯·æ±‚ï¼Œç»•è¿‡åŸæœ¬åº”è¯¥åœ¨middlewareä¸­æ‰§è¡Œçš„æƒé™æ ¡éªŒã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚åˆ°ç›®æ ‡Next.jsåº”ç”¨ã€‚
2.  å¦‚æœæƒé™æ ¡éªŒé€»è¾‘åœ¨middlewareä¸­ï¼ŒNext.jsåº”ç”¨å¯èƒ½é”™è¯¯åœ°å¤„ç†è¯¥è¯·æ±‚ï¼Œä»è€Œç»•è¿‡æƒé™æ ¡éªŒã€‚
3.  æ”»å‡»è€…å¯ä»¥è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ‰§è¡Œæœªæˆæƒçš„æ“ä½œã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå¹¶ä¸”å·²ç»æœ‰å…¬å¼€çš„åˆ†æå’Œåˆ©ç”¨æ–¹æ³•ã€‚æä¾›çš„Pythonè„šæœ¬`NextSploit.py`çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªé€šç”¨çš„Webåº”ç”¨æ¼æ´æ‰«æå·¥å…·ï¼Œç›®å‰æä¾›çš„ä»£ç ç‰‡æ®µï¼Œæ²¡æœ‰ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ï¼Œä½†æ˜¯è¯¥ä»£ç æ¡†æ¶å…·å¤‡é›†æˆçš„å¯èƒ½ã€‚æœç´¢å¼•æ“ç»“æœä¹Ÿè¡¨æ˜Rapid7ã€Picus Securityç­‰å®‰å…¨å‚å•†å·²ç»å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æï¼Œå› æ­¤è¯¥æ¼æ´æ˜¯å¯åˆ©ç”¨çš„ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„Pythonè„šæœ¬ç‰‡æ®µå­˜åœ¨ä¸€å®šçš„æŠ•æ¯’é£é™©ã€‚ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š

1.  **è‡ªåŠ¨å®‰è£…ä¾èµ–:** è„šæœ¬ä¼šè‡ªåŠ¨æ£€æŸ¥å¹¶å®‰è£…ä¸€äº›PythonåŒ…ï¼ˆä¾‹å¦‚`wappalyzer`ã€`requests`ã€`colorama`ã€`selenium`ï¼‰ã€‚å¦‚æœå®‰è£…æºè¢«ç¯¡æ”¹ï¼Œæˆ–è€…æ¶æ„äººå‘˜æŠ•æ¯’äº†è¿™äº›å¸¸ç”¨package,åˆ™å¯èƒ½å®‰è£…æ¶æ„ç‰ˆæœ¬ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œã€‚
2.  **Wappalyzeré›†æˆ:** è„šæœ¬ä½¿ç”¨`wappalyzer`è¿›è¡ŒWebåº”ç”¨æŒ‡çº¹è¯†åˆ«ã€‚è™½ç„¶`wappalyzer`æœ¬èº«æ˜¯ä¸€ä¸ªåˆæ³•çš„å·¥å…·ï¼Œä½†æ¶æ„äººå‘˜å¯èƒ½åˆ©ç”¨å®ƒæ¥æ”¶é›†æ•æ„Ÿä¿¡æ¯ï¼Œæˆ–ä¸ºåç»­æ”»å‡»åšå‡†å¤‡ã€‚
3. **MIDDLEWARE_VALUE** å…¨å±€å˜é‡ç”¨äºå­˜å‚¨ä¸­é—´ä»¶å€¼ï¼Œå¯èƒ½å­˜åœ¨é€šè¿‡å¤–éƒ¨è¾“å…¥ä¿®æ”¹è¯¥å€¼çš„æ“ä½œï¼Œå­˜åœ¨é£é™©

ç»¼ä¸Šæ‰€è¿°ï¼Œä»£ç ä¸­å­˜åœ¨ä¸€å®šçš„é£é™©ï¼Œä½†å¹¶éæ˜¾å¼çš„æ¶æ„ä»£ç ï¼Œæ›´åƒæ˜¯å®‰å…¨å·¥å…·ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ã€‚ å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚ä¸»è¦æ˜¯ä¾èµ–åŒ…å®‰è£…å’Œç¬¬ä¸‰æ–¹å·¥å…·ä½¿ç”¨å¸¦æ¥çš„é£é™©ã€‚

**å»ºè®®ï¼š**

*   åŠæ—¶æ›´æ–°Next.jsåˆ°å®‰å…¨ç‰ˆæœ¬(>=14.2.25æˆ–>=15.2.3)ã€‚
*   å¦‚æœæ— æ³•æ›´æ–°ï¼ŒæŒ‰ç…§å®˜æ–¹å»ºè®®ï¼Œé˜»æ­¢åŒ…å«`x-middleware-subrequest` headerçš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [pixilated730/NextJS-Exploit-](https://github.com/pixilated730/NextJS-Exploit-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #97

**æ¥æº**: [CVE-2025-29927-pouriam23_CVE-2025-29927.md](../2025/CVE-2025-29927-pouriam23_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œä¸”æƒé™éªŒè¯é€»è¾‘ä½äºmiddlewareä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ¼æ´åŸå› æ˜¯Next.jså¯¹`x-middleware-subrequest` headerå¤„ç†ä¸å½“ã€‚æ ¹æ®æ¼æ´æè¿°ï¼Œé€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„è¯·æ±‚ï¼Œå¯ä»¥ç»•è¿‡ä¸­é—´ä»¶çš„æƒé™éªŒè¯ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æä¾›çš„POCä»£ç æ˜¯ä¸€ä¸ªCTFæŒ‘æˆ˜ï¼Œæ—¨åœ¨æ¼”ç¤ºå’Œåˆ©ç”¨æ­¤æ¼æ´ã€‚ è¯¥æŒ‘æˆ˜æ¨¡æ‹Ÿäº†ä¸€ä¸ªä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤çš„`/admin`è·¯ç”±ï¼Œæ”»å‡»ç›®æ ‡æ˜¯åœ¨ä¸ä½¿ç”¨adminå‡­æ®çš„æƒ…å†µä¸‹è®¿é—®è¯¥è·¯ç”±ï¼Œæ ¹æ®challengeæè¿°ï¼Œæ¼æ´å¯èƒ½å­˜åœ¨äºmiddlewareå¯¹urlå‚æ•°çš„éªŒè¯ä¸Šã€‚æ ¹æ®ç›®å‰çš„ä¿¡æ¯ï¼Œè¯¥POCä¸åŒ…å«æŠ•æ¯’ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/CVE-2025-29927](https://github.com/pouriam23/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #98

**æ¥æº**: [CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md](../2025/CVE-2025-29927-pouriam23_Next.js-Middleware-Bypass-CVE-2025-29927-.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªå¯¹`x-middleware-subrequest`è¯·æ±‚å¤´è¿›è¡Œæ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsæ¡†æ¶ä¸­ä¸€ä¸ªä¸¥é‡çš„è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå­˜åœ¨äºNext.jsä¸­é—´ä»¶ä¸­ã€‚å½“åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶æ‰§è¡Œæˆæƒæ£€æŸ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`å¤´éƒ¨æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ï¼Œä»è€Œè·å¾—å¯¹å—é™èµ„æºçš„æœªæˆæƒè®¿é—®ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œæ­¤æ¼æ´å·²è¢«ç¡®è®¤å­˜åœ¨ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªå®‰å…¨å‚å•†å‘å¸ƒäº†ç›¸å…³çš„åˆ†ææŠ¥å‘Šå’Œç¼“è§£æªæ–½ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­è™½ç„¶æ²¡æœ‰ç›´æ¥ä½“ç°æ¼æ´åˆ©ç”¨çš„Payloadï¼Œä½†å…¶ç¯å¢ƒæ­å»ºè¯´æ˜ï¼ˆNext.jsé¡¹ç›®ç»“æ„ï¼Œä¾èµ–ç­‰ï¼‰å¯ç”¨äºæ­å»ºå­˜åœ¨æ¼æ´çš„ç¯å¢ƒï¼Œè¿›è€ŒéªŒè¯å’Œå¤ç°æ¼æ´ï¼Œä»è€ŒéªŒè¯å…¶æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æ˜¯ä¸€ä¸ª Next.js é¡¹ç›®çš„è„šæ‰‹æ¶ä»£ç ï¼ŒåŒ…æ‹¬é¡¹ç›®ç»“æ„ã€ä¾èµ–é…ç½®å’Œä¸€äº›ç¤ºä¾‹ä»£ç ã€‚ä»”ç»†æ£€æŸ¥è¿™äº›æ–‡ä»¶ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç æˆ–åé—¨ã€‚`package-lock.json` æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ç¯¡æ”¹è¯¥æ–‡ä»¶å¼•å…¥æ¶æ„ä¾èµ–ï¼Œä½†ç›®å‰çš„æ–‡ä»¶å†…å®¹æ˜¯æ ‡å‡†çš„ï¼Œæ²¡æœ‰å¯ç–‘ä¹‹å¤„ã€‚ä½†ä»»ä½•é¡¹ç›®éƒ½å­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ï¼Œé€šè¿‡ä¾èµ–åŒ…å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§æ€»æ˜¯å­˜åœ¨ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œä»¥åŠå¯¹é¡¹ç›®æ„å»ºè¿‡ç¨‹çš„æ½œåœ¨å½±å“ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡ç¡®è®¤:** ç¡®è®¤ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ï¼Œå¹¶ä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **è¯·æ±‚æ„é€ :** æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„ HTTP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ Burp Suite æˆ–å…¶ä»– HTTP ä»£ç†å·¥å…·ä¿®æ”¹è¯·æ±‚å¤´ã€‚
3.  **æƒé™ç»•è¿‡:** å°†æ„é€ çš„æ¶æ„è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ã€‚å¦‚æœåº”ç”¨æœªæ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´ï¼Œä¸­é—´ä»¶çš„æƒé™éªŒè¯é€»è¾‘å°†è¢«ç»•è¿‡ã€‚
4.  **èµ„æºè®¿é—®:** æˆåŠŸç»•è¿‡æƒé™éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #99

**æ¥æº**: [CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md](../2025/CVE-2025-29927-rgvillanueva28_vulnbox-easy-CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-æƒé™ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦Next.jsåº”ç”¨ä½¿ç”¨middlewareè¿›è¡Œæƒé™éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.js middlewareä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æºäºNext.jså¤„ç†`x-middleware-subrequest` headerçš„æ–¹å¼å­˜åœ¨ç¼ºé™·ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡åœ¨middlewareä¸­å®ç°çš„èº«ä»½éªŒè¯æœºåˆ¶ã€‚

**æœ‰æ•ˆæ€§ï¼š** æ ¹æ®æä¾›çš„ä»£ç ï¼Œçœ‹èµ·æ¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„Next.jsåº”ç”¨ï¼Œå¹¶ä¸”åœ¨`middleware.ts`ä¸­å®ç°äº†åŸºäºJWTçš„æƒé™éªŒè¯ã€‚è¿™ä¸ªPOCå¯èƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ªçœŸå®çš„åœºæ™¯ï¼Œå…¶ä¸­æƒé™éªŒè¯æ˜¯åœ¨middlewareä¸­è¿›è¡Œçš„ã€‚åˆ©ç”¨æ–¹å¼å¦‚ä¸‹æ‰€è¿°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«ç‰¹å®š`x-middleware-subrequest` headerçš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡middlewareçš„æƒé™æ£€æŸ¥ã€‚å…·ä½“åˆ©ç”¨æ–¹å¼éœ€è¦åˆ†æNext.jså¦‚ä½•å¤„ç†è¿™ä¸ªheaderï¼Œä»¥åŠå¦‚ä½•ä¿®æ”¹è¯·æ±‚æ‰èƒ½ç»•è¿‡éªŒè¯ã€‚ç”±äºPOCåªæä¾›åº”ç”¨ä»£ç ï¼Œæ²¡æœ‰ç›´æ¥çš„exploitä»£ç ï¼Œéœ€è¦è¿›ä¸€æ­¥åˆ†æåº”ç”¨è¡Œä¸ºæ„é€ æ¶æ„è¯·æ±‚ã€‚

**æŠ•æ¯’é£é™©ï¼š**
æ£€æŸ¥Dockerfileã€docker-compose.ymlã€docker-entrypoint.shç­‰æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚docker-entrypoint.sh ä¸»è¦è´Ÿè´£æ•°æ®åº“è¿ç§»å’Œåˆå§‹åŒ–ã€‚middleware.ts å®ç°äº†æƒé™ç»•è¿‡çš„éªŒè¯ä»£ç ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ä»£ç ã€‚Dockerfileï¼Œdocker-compose.ymlå’Œenvé…ç½®æ–‡ä»¶æ²¡æœ‰å‘ç°ä»»ä½•æ¶æ„æŠ•æ¯’çš„ç—•è¿¹ï¼Œåˆ¤æ–­ä»“åº“ä¸­å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå› æ­¤é£é™©è¯„ä¼°ä¸º1%ã€‚

**é¡¹ç›®åœ°å€:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #100

**æ¥æº**: [CVE-2025-29927-ricsirigu_CVE-2025-29927.md](../2025/CVE-2025-29927-ricsirigu_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯æˆ–æ‰§è¡Œæœªæˆæƒæ“ä½œ

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ä¸€ä¸ª Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚å½“ Next.js åº”ç”¨çš„æˆæƒæ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œæ—¶ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´éƒ¨çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆREADME.mdï¼‰ï¼Œåªéœ€ä½¿ç”¨æ‹¦æˆªä»£ç†ï¼ˆå¦‚ ZAP æˆ– Burpï¼‰æ•è·è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚ä¸­æ³¨å…¥ä»¥ä¸‹å¤´éƒ¨å³å¯å®ç°ç»•è¿‡ï¼š`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚å¤šä¸ªæœç´¢ç»“æœä¹Ÿè¯å®äº†è¯¥æ¼æ´çš„å­˜åœ¨ä»¥åŠåˆ©ç”¨æ–¹å¼ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†ææä¾›çš„æ–‡ä»¶ï¼š
*   `README.md`: åŒ…å«æ¼æ´æè¿°ã€åˆ©ç”¨æ–¹æ³•å’Œå…è´£å£°æ˜ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚
*   `eslint.config.mjs`:  ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼æ£€æŸ¥ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `middleware.ts`:  å®šä¹‰ Next.js ä¸­é—´ä»¶ï¼Œç”¨äºæˆæƒæ£€æŸ¥ã€‚å­˜åœ¨æ¼æ´åˆ©ç”¨çš„é€»è¾‘ï¼Œä½†æœ¬èº«ä¸æ˜¯æŠ•æ¯’ä»£ç ï¼Œè€Œæ˜¯æ¼æ´çš„æ ¹æºã€‚
*   `next.config.ts`:  Next.js é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Next.js åº”ç”¨ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚
*   `package-lock.json`:  è®°å½•é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œä¸åŒ…å«æ¶æ„ä»£ç ã€‚

 è™½ç„¶æ£€æŸ¥äº†æ‰€æœ‰æä¾›çš„ä»£ç ï¼Œä½†è€ƒè™‘åˆ°æ¼æ´åˆ©ç”¨ä»£ç ä»“åº“ä¸­å¯èƒ½å­˜åœ¨çš„æ½œåœ¨é£é™©ï¼Œä¾‹å¦‚ä½œè€…å¯èƒ½åœ¨å…¶ä»–æœªç›´æ¥å±•ç¤ºçš„æ–‡ä»¶ä¸­éšè—æ¶æ„ä»£ç ï¼Œæˆ–è€…åœ¨æ›´æ–°ç‰ˆæœ¬æ—¶å¼•å…¥æ¶æ„ä»£ç ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦ä¿ç•™ä¸€å®šçš„è­¦æƒ•æ€§ã€‚æˆ‘è¯„ä¼°æŠ•æ¯’é£é™©ä¸º 10%ï¼Œå› ä¸ºè™½ç„¶æ²¡æœ‰æ˜æ˜¾çš„æŠ•æ¯’è¿¹è±¡ï¼Œä½†æ— æ³•å®Œå…¨æ’é™¤ä½œè€…æ¶æ„è¡Œä¸ºçš„å¯èƒ½æ€§ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ç¨‹åºä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä¸”æˆæƒé€»è¾‘ä½äºä¸­é—´ä»¶ä¸­ã€‚
2.  æ”»å‡»è€…ä½¿ç”¨ä»£ç†å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰æ‹¦æˆªè¯·æ±‚ã€‚
3.  æ”»å‡»è€…åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`ã€‚
4.  æ”»å‡»è€…å‘é€ä¿®æ”¹åçš„è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #101

**æ¥æº**: [CVE-2025-29927-rubbxalc_CVE-2025-29927.md](../2025/CVE-2025-29927-rubbxalc_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡ŒæˆæƒéªŒè¯ï¼Œä¸”ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` æ ‡å¤´å¤„ç†ä¸å½“å¯¼è‡´æˆæƒç»•è¿‡ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«è¯¥æ ‡å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  **å‘é€åŸºçº¿è¯·æ±‚ï¼š** é¦–å…ˆï¼Œå‘é€ä¸€ä¸ªä¸å¸¦ä»»ä½•ç‰¹æ®Šæ ‡å¤´çš„è¯·æ±‚åˆ°ç›®æ ‡è·¯ç”±ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ä¸­é—´ä»¶ä¿æŠ¤ï¼ˆé€šå¸¸è¡¨ç°ä¸º307é‡å®šå‘ï¼‰ã€‚
2.  **å‘é€åŒ…å« 'x-middleware-subrequest' æ ‡å¤´çš„è¯·æ±‚ï¼š** å¦‚æœåŸºçº¿è¯·æ±‚é‡å®šå‘ï¼Œåˆ™å‘é€ä¸€ä¸ªåŒ…å« `x-middleware-subrequest: middleware` æ ‡å¤´çš„ç›¸åŒè¯·æ±‚ã€‚  å¦‚æœæ¼æ´å­˜åœ¨ï¼ŒæœåŠ¡å™¨å°†è·³è¿‡ä¸­é—´ä»¶éªŒè¯ï¼Œå¹¶å…è®¸è®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´æè¿°ã€æœç´¢ç»“æœå’Œæä¾›çš„ POC ä»£ç ï¼Œè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚  POC ä»£ç çš„ `exploit.py` è„šæœ¬é¦–å…ˆå‘é€ä¸€ä¸ªåŸºçº¿è¯·æ±‚æ¥æ£€æµ‹é‡å®šå‘ï¼Œç„¶åå°è¯•ä½¿ç”¨ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡ä¸­é—´ä»¶ã€‚

**æŠ•æ¯’é£é™©ï¼š**

æä¾›çš„ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æœªå‘ç°æ˜æ˜¾çš„æ¶æ„ä»£ç ã€‚`requirements.txt` æ–‡ä»¶ä¸­åªåŒ…å«äº†å¸¸ç”¨çš„ `requests`ã€`colorama` å’Œ `beautifulsoup4` åº“ï¼Œæ²¡æœ‰å¯ç–‘çš„ä¾èµ–é¡¹ã€‚ä¸è¿‡ï¼Œä»»ä½•ä»£ç éƒ½å­˜åœ¨æ½œåœ¨çš„é£é™©ï¼Œå› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º 5%ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç æ¥æºçš„ä¿¡ä»»åº¦ä»¥åŠä½œè€…å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­å¼•å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æ€»ç»“ï¼š**

è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€‚æä¾›çš„ POC ä»£ç å¯ä»¥ç”¨æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚å»ºè®®å—å½±å“çš„ Next.js åº”ç”¨å‡çº§åˆ°å®‰å…¨ç‰ˆæœ¬ï¼Œæˆ–è€…é‡‡å–ç¼“è§£æªæ–½ï¼Œä¾‹å¦‚é˜»æ­¢åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [rubbxalc/CVE-2025-29927](https://github.com/rubbxalc/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #102

**æ¥æº**: [CVE-2025-29927-sagsooz_CVE-2025-29927.md](../2025/CVE-2025-29927-sagsooz_CVE-2025-29927.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ,ä¸”å—å½±å“ç‰ˆæœ¬ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘ä¸­ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­è®¾ç½® `x-middleware-subrequest` å­—æ®µä¸ºç‰¹å®šå€¼ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æœç´¢ç»“æœä¸­å¤šä¸ªé“¾æ¥ä¹Ÿè¯å®äº†æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ï¼Œå¹¶æŒ‡å‡ºæ¼æ´æ˜¯ç”±äºä¸æ­£ç¡®å¤„ç† `x-middleware-subrequest` å¤´éƒ¨é€ æˆçš„ã€‚

æä¾›çš„PoC ä»£ç æ˜¯ä¸€ä¸ªäº¤äº’å¼çš„æ¼æ´æ‰«æå™¨ï¼Œå®ƒé€šè¿‡å°è¯•ä¸åŒçš„ `x-middleware-subrequest` å€¼æ¥æ£€æµ‹ç›®æ ‡åº”ç”¨æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ä»£ç çš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒæ¨¡æ‹Ÿäº†æ”»å‡»è€…åˆ©ç”¨æ¼æ´çš„æ–¹å¼ã€‚ä»£ç ä¸­ä½¿ç”¨äº† `requests` åº“å‘é€ HTTP è¯·æ±‚ï¼Œ`BeautifulSoup` åº“è§£æ HTML å“åº”ï¼Œå¹¶æ ¹æ®å“åº”çŠ¶æ€ç å’Œå†…å®¹åˆ¤æ–­æ˜¯å¦å­˜åœ¨ç»•è¿‡ã€‚å®ƒè¿˜æ£€æµ‹äº†meta refreshè·³è½¬å’Œä¸€äº›å…³é”®è¯æ¥æ™ºèƒ½åˆ¤æ–­æ˜¯å¦é‡å®šå‘åˆ°ç™»é™†é¡µé¢ï¼Œå‡å°‘äº†è¯¯æŠ¥çš„å¯èƒ½æ€§ã€‚

æŠ•æ¯’é£é™©åˆ†æï¼šPoC ä»£ç ä¸»è¦åŠŸèƒ½æ˜¯æ£€æµ‹æ¼æ´ï¼Œè™½ç„¶ä»£ç å°è¯•ä¸åŒçš„å¤´éƒ¨è¿›è¡Œæµ‹è¯•ï¼Œä½†æ²¡æœ‰å‘ç°æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºï¼Œä¾‹å¦‚æ¤å…¥åé—¨æˆ–ç¯¡æ”¹æ•°æ®ã€‚ä»£ç å¯èƒ½å­˜åœ¨çš„é£é™©ç‚¹åœ¨äºï¼Œå¦‚æœç›®æ ‡åº”ç”¨å­˜åœ¨å…¶ä»–æœªçŸ¥çš„æ¼æ´ï¼ŒPoC ä»£ç çš„è¯·æ±‚å¯èƒ½ä¼šè§¦å‘è¿™äº›æ¼æ´ã€‚æ­¤å¤–ï¼ŒPoC ä»£ç çš„ä½œè€…æ¥è‡ª Telegramï¼Œè™½ç„¶ä¸èƒ½ç›´æ¥æ–­å®šå­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œä½†éœ€è¦ä¿æŒä¸€å®šçš„è­¦æƒ•ã€‚å› æ­¤ï¼Œç»¼åˆè€ƒè™‘ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¼°è®¡ä¸º10%ã€‚

åˆ©ç”¨æ–¹å¼æ€»ç»“ï¼šæ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œç»•è¿‡ Next.js ä¸­é—´ä»¶çš„æƒé™æ ¡éªŒï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ”»å‡»çš„å…³é”®åœ¨äºæ„é€ æ­£ç¡®çš„ `x-middleware-subrequest` å€¼ï¼Œä½¿å…¶èƒ½å¤Ÿè¢«ä¸­é—´ä»¶é”™è¯¯åœ°å¤„ç†ï¼Œä»è€Œè·³è¿‡æƒé™éªŒè¯ã€‚

**é¡¹ç›®åœ°å€:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #103

**æ¥æº**: [CVE-2025-29927-sahbaazansari_CVE-2025-29927.md](../2025/CVE-2025-29927-sahbaazansari_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-AuthorizationBypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®ç¯¡æ”¹

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒï¼Œä¸”å—å½±å“ç‰ˆæœ¬å­˜åœ¨æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œç”±äºå¯¹ `x-middleware-subrequest` header å¤„ç†ä¸å½“ï¼Œå¯¼è‡´å¯ä»¥ç»•è¿‡æƒé™éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå¦‚æœæƒé™æ£€æŸ¥å‘ç”Ÿåœ¨ä¸­é—´ä»¶ä¸­ï¼Œå°±å¯èƒ½å­˜åœ¨ç»•è¿‡ã€‚æœç´¢å¼•æ“ç»“æœæŒ‡å‘è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` å¤´éƒ¨çš„ä¸æ­£ç¡®å¤„ç†ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `endpoints.json` åŒ…å«äº†ä¸€ç³»åˆ— URLï¼Œè¿™äº› URL å¯èƒ½æ˜¯æ”»å‡»è€…å°è¯•ç»•è¿‡èº«ä»½éªŒè¯å¹¶è®¿é—®çš„ç«¯ç‚¹åˆ—è¡¨ã€‚æ”»å‡»è€…å¯èƒ½é€šè¿‡æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ï¼Œæ¬ºéª— Next.js åº”ç”¨ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ä¸­é—´ä»¶çš„æƒé™æ£€æŸ¥ã€‚ æŠ•æ¯’é£é™©è¾ƒä½ï¼Œå› ä¸ºæä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªURLåˆ—è¡¨ï¼Œé£é™©å æ¯”10%ã€‚åˆ©ç”¨æ–¹å¼ä¸º: æ„é€ åŒ…å«ç‰¹å®šheaderçš„æ¶æ„è¯·æ±‚, è®¿é—®å—ä¿æŠ¤èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sahbaazansari/CVE-2025-29927](https://github.com/sahbaazansari/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #104

**æ¥æº**: [CVE-2025-29927-sdrtba_CVE-2025-29927.md](../2025/CVE-2025-29927-sdrtba_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®ã€æ•°æ®æ³„éœ²å’Œç¼“å­˜æŠ•æ¯’

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œå¹¶ä¸”ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚ç”±äº Next.js ä¸­é—´ä»¶åœ¨è¿›è¡Œæˆæƒå†³ç­–æ—¶ï¼Œä¸æ­£ç¡®åœ°ä¿¡ä»» `x-middleware-subrequest` å†…éƒ¨æ ‡å¿—ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨å¤–éƒ¨è¯·æ±‚ä¸­è®¾ç½®è¯¥æ ‡å¤´æ¥ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´å½±å“å¤šä¸ªç‰ˆæœ¬çš„ Next.jsã€‚åˆ©ç”¨è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„é¡µé¢å’Œæ•°æ®ï¼Œç”šè‡³å¯èƒ½è¿›è¡Œç¼“å­˜æŠ•æ¯’æ”»å‡»ï¼ˆCPDoSï¼‰ï¼Œæ“çºµ CDN/è¾¹ç¼˜ç¼“å­˜ï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡æˆ–æ•°æ®æ³„éœ²ã€‚ 

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**
1. åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯/æˆæƒã€‚
2. åº”ç”¨ç¨‹åºä½¿ç”¨çš„ Next.js ç‰ˆæœ¬åœ¨å—å½±å“èŒƒå›´å†…ã€‚
3. æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest: 1` æ ‡å¤´çš„ HTTP è¯·æ±‚è®¿é—®å—ä¿æŠ¤èµ„æºã€‚
4. å¦‚æœåº”ç”¨ç¨‹åºå­˜åœ¨æ¼æ´ï¼Œä¸­é—´ä»¶ä¼šé”™è¯¯åœ°å°†è¯¥è¯·æ±‚è§†ä¸ºå†…éƒ¨å­è¯·æ±‚ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ï¼Œå¹¶å…è®¸æ”»å‡»è€…è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
è¯¥æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦æä¾›çš„æ˜¯æ¼æ´éªŒè¯çš„æ­¥éª¤å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¦‚ä½•æ„å»ºåŒ…å«ç‰¹å®š header çš„è¯·æ±‚æ¥æµ‹è¯•æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚æä¾›çš„ Dockerfile ç”¨äºå¿«é€Ÿæ­å»ºä¸€ä¸ªå­˜åœ¨æ¼æ´çš„ç¯å¢ƒè¿›è¡Œæµ‹è¯•ã€‚è™½ç„¶åœ¨æ‰¹é‡éªŒè¯éƒ¨åˆ†æåˆ°äº† nuclei å’Œ Pythonï¼Œä½†ä¹Ÿåªæ˜¯æä¾›äº†ä¸€ç§æ‰«ææ£€æµ‹çš„æ€è·¯ï¼Œå¹¶æ²¡æœ‰ç›´æ¥æä¾›ä»»ä½•å¯æ‰§è¡Œçš„è„šæœ¬ã€‚å› æ­¤ï¼Œä»æ€»ä½“æ¥çœ‹ï¼Œè¯¥æ¼æ´åˆ©ç”¨ä»£ç æœ¬èº«åŒ…å«æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œä½†æ˜¯ï¼Œåœ¨ nuclei æ‰¹é‡æ‰«ææ£€æµ‹æ—¶ï¼Œéœ€è¦æ³¨æ„æ§åˆ¶æ‰«æé¢‘ç‡ï¼Œé¿å…å¯¹ç›®æ ‡é€ æˆ DoS å½±å“ã€‚

**é£é™©è¯„ä¼°ï¼š**
è™½ç„¶ç›´æ¥æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»éœ€è°¨æ…ã€‚å»ºè®®åœ¨ä½¿ç”¨ä»»ä½•è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œæ¼æ´éªŒè¯ä¹‹å‰ï¼Œä»”ç»†å®¡æŸ¥ä»£ç ï¼Œå¹¶ç¡®ä¿åœ¨æˆæƒç¯å¢ƒä¸‹è¿›è¡Œæµ‹è¯•ã€‚

**æŠ•æ¯’é£é™©ç™¾åˆ†æ¯”ï¼š** 10%

**é¡¹ç›®åœ°å€:** [sdrtba/CVE-2025-29927](https://github.com/sdrtba/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #105

**æ¥æº**: [CVE-2025-29927-serhalp_test-cve-2025-29927.md](../2025/CVE-2025-29927-serhalp_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬ï¼Œä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js ä¸­ï¼Œæ˜¯ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®æœªæˆæƒçš„èµ„æºã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, å’Œ > 15.0.0, < 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå¯èƒ½å¯¼è‡´ä¸¥é‡çš„åæœã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**
æä¾›çš„ POC ä»£ç åŒ…å«ä¸€ä¸ª Next.js é¡¹ç›®çš„æ¡†æ¶ä»£ç ï¼ŒåŒ…æ‹¬ `middleware.ts`ã€‚è¿™ä¸ªæ–‡ä»¶è®¾ç½®äº†ä¸€äº›ç®€å•çš„headerï¼Œä½†æœ¬èº«å¹¶æ²¡æœ‰å±•ç¤ºå¦‚ä½•åˆ©ç”¨ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡èº«ä»½éªŒè¯ã€‚æ‰€ä»¥POCæœ¬èº«ä¸åŒ…å«ç›´æ¥çš„æ”»å‡»ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªé¡¹ç›®å¯ä»¥ç”¨æ¥å¤ç°æ¼æ´ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**
æŸ¥çœ‹æä¾›çš„æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°è¯¥ä»£ç ä¸»è¦æ˜¯ Next.js é¡¹ç›®çš„åŸºç¡€é…ç½®å’Œä¸­é—´ä»¶ç¤ºä¾‹ï¼Œå¹¶æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç å­˜åœ¨ã€‚å…¶ä¸­ `package-lock.json`  æ–‡ä»¶åˆ—å‡ºäº†é¡¹ç›®ä¾èµ–ï¼Œä½†éƒ½æ˜¯å¸¸è§çš„ Next.js ä¾èµ–é¡¹ã€‚`middleware.ts`è®¾ç½®äº†ä¸€äº›å“åº”å¤´ï¼Œä¾‹å¦‚ `x-test-used-middleware` å’Œ `x-test-used-next-version`ã€‚`netlify.toml` æ˜¯ Netlify éƒ¨ç½²é…ç½®æ–‡ä»¶ã€‚
å› æ­¤ï¼Œåˆæ­¥åˆ¤æ–­è¯¥ä»£ç ä»“åº“å­˜åœ¨æ¶æ„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ï¼Œå¤§çº¦ä¸º 5%ï¼Œä¸»è¦è€ƒè™‘åˆ°ä¾›åº”é“¾æŠ•æ¯’çš„å¯èƒ½æ€§ï¼Œä¾èµ–åº“å¯èƒ½å­˜åœ¨æ½œåœ¨é£é™©ï¼Œä½†ä»æä¾›çš„å†…å®¹æ— æ³•ç›´æ¥åˆ¤æ–­ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œåˆ©ç”¨æ–¹å¼é€šå¸¸æ¶‰åŠæ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœ Next.js åº”ç”¨çš„ä¸­é—´ä»¶æˆæƒé€»è¾‘å­˜åœ¨ç¼ºé™·ï¼Œæœªèƒ½æ­£ç¡®å¤„ç†æˆ–éªŒè¯å¸¦æœ‰æ­¤å¤´çš„è¯·æ±‚ï¼Œæ”»å‡»è€…å³å¯ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚å…·ä½“ç»•è¿‡æ–¹å¼éœ€è¦æ ¹æ®ç›®æ ‡åº”ç”¨ä¸­é—´ä»¶çš„å®ç°ç»†èŠ‚æ¥ç¡®å®šï¼Œæ¯”å¦‚å¯ä»¥é€šè¿‡ä¿®æ”¹è¯·æ±‚å¤´ã€è¯·æ±‚ä½“ç­‰æ–¹å¼æ¥æ¬ºéª—æˆæƒé€»è¾‘ã€‚

**é¡¹ç›®åœ°å€:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #106

**æ¥æº**: [CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md](../2025/CVE-2025-29927-sermikr0_nextjs-middleware-auth-bypass.md)

## CVE-2025-29927-Next.js Middleware èº«ä»½éªŒè¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** èº«ä»½éªŒè¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨ Next.js ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ã€‚å¦‚æœ Next.js åº”ç”¨ç¨‹åºçš„èº«ä»½éªŒè¯æ£€æŸ¥åœ¨ä¸­é—´ä»¶ä¸­è¿›è¡Œï¼Œåˆ™æ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´çš„ CVSS è¯„åˆ†ä¸º 9.1ï¼Œè¡¨æ˜å…¶ä¸¥é‡æ€§å¾ˆé«˜ã€‚æ¼æ´åˆ©ç”¨ä»£ç æä¾›äº†ä¸€ä¸ªä½¿ç”¨ Docker éƒ¨ç½² Next.js åº”ç”¨ç¨‹åºçš„ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª `middleware.js` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä½¿ç”¨ cookie (`next_username` å’Œ `next_password`) æ¥æ£€æŸ¥ç”¨æˆ·èº«ä»½éªŒè¯ã€‚PoCä»£ç ç›´æ¥ç¡¬ç¼–ç äº†ç”¨æˆ·åå¯†ç  admin/password å­˜åœ¨å®‰å…¨é£é™©ï¼Œä½†æ˜¯ä¸æ˜¯æŠ•æ¯’ä»£ç . 

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ä»£ç æ„æˆäº†ä¸€ä¸ªæ¦‚å¿µéªŒè¯ (PoC)ï¼Œæ—¨åœ¨æ¼”ç¤ºå¦‚ä½•åˆ©ç”¨æ­¤æ¼æ´ã€‚é€šè¿‡æ„å»ºå’Œè¿è¡Œ Docker é•œåƒï¼Œæ”»å‡»è€…å¯ä»¥éƒ¨ç½²ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Next.js åº”ç”¨ç¨‹åºï¼Œå¹¶ç»•è¿‡ä¸­é—´ä»¶ä¸­å®ç°çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œå‰ææ˜¯æ”»å‡»è€…çŸ¥é“æˆ–å¯ä»¥çŒœæµ‹åˆ°æ­£ç¡®çš„cookieã€‚è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ä¼¼ä¹å¾ˆé«˜ï¼Œå› ä¸ºæœç´¢ç»“æœè¡¨æ˜è¯¥æ¼æ´æ˜“äºåˆ©ç”¨ã€‚

**æŠ•æ¯’é£é™©ï¼š**

Dockerfile åªæ˜¯å®šä¹‰äº†åº”ç”¨éƒ¨ç½²è¿‡ç¨‹ï¼Œæ²¡æœ‰é£é™©ã€‚README.md æ–‡ä»¶ä»…åŒ…å«æœ‰å…³å¦‚ä½•æ„å»ºå’Œè¿è¡Œ Docker é•œåƒçš„è¯´æ˜ï¼Œä»¥åŠæŒ‡å‘æµ‹è¯•å’Œå®‰å…¨å·¥å…·ï¼ˆå¦‚ Burp Suiteï¼‰çš„é“¾æ¥ã€‚è¿™äº›éƒ½ä¸æ˜¯æ¶æ„ä»£ç ã€‚

`middleware.js` æ–‡ä»¶ä¸­çš„èº«ä»½éªŒè¯é€»è¾‘éå¸¸ç®€å•ï¼Œå¹¶ä¸”ä½¿ç”¨ç¡¬ç¼–ç çš„å‡­æ®ï¼ˆadmin/passwordï¼‰è¿›è¡Œèº«ä»½éªŒè¯ã€‚è™½ç„¶è¿™æœ¬èº«å°±æ˜¯ä¸€ä¸ªå®‰å…¨é—®é¢˜ï¼Œä½†è¿™å¹¶ä¸è¡¨æ˜å­˜åœ¨æŠ•æ¯’è¡Œä¸ºï¼Œå› ä¸ºå®ƒä»…ç”¨äºæ¼”ç¤º PoCã€‚

`next.config.js` æ–‡ä»¶æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Next.js é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›åŸºæœ¬çš„é…ç½®é€‰é¡¹ã€‚è¯¥æ–‡ä»¶æ²¡æœ‰åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

`package.json` å’Œ `yarn.lock` æ–‡ä»¶åŒ…å«é¡¹ç›®ä¾èµ–é¡¹å’Œç‰ˆæœ¬ä¿¡æ¯ã€‚è¿™äº›æ–‡ä»¶æœ¬èº«æ²¡æœ‰åŒ…å«ä»»ä½•æ¶æ„ä»£ç ã€‚

ä»“åº“ä¸­å­˜åœ¨çš„æ¼æ´åˆ©ç”¨ä»£ç ä¸»è¦ç”¨äºæ¼”ç¤ºæ¼æ´ï¼Œé£é™©è¾ƒä½ã€‚ä½†æ˜¯**åŠ¡å¿…ä¸èƒ½æŠŠPOCéªŒè¯çš„åé—¨ä»£ç åˆ¤å®šä¸ºæŠ•æ¯’ä»£ç **ï¼Œç»¼åˆåˆ†æååˆ¤å®šæŠ•æ¯’é£é™©ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å¯ä»¥å‘é€åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯æ£€æŸ¥ã€‚æ­¤æ–¹æ³•å·²åœ¨æ¼æ´æè¿°ä¸­æåŠï¼Œå¹¶ç”±æœç´¢ç»“æœè¯å®ã€‚
2.  æˆ–è€…ï¼Œæ”»å‡»è€…å¯ä»¥è®¾ç½® `next_username` å’Œ `next_password` cookie ä¸º 'admin' å’Œ 'password' æ¥ç»•è¿‡ PoC æä¾›çš„èº«ä»½éªŒè¯é€»è¾‘ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨æ­¤ç‰¹å®šä»£ç ï¼‰ã€‚
3.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯åï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºå¹¶æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œï¼Œå…·ä½“å–å†³äºåº”ç”¨ç¨‹åºçš„å®ç°ã€‚


**é¡¹ç›®åœ°å€:** [sermikr0/nextjs-middleware-auth-bypass](https://github.com/sermikr0/nextjs-middleware-auth-bypass)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---



---

## POC #107

**æ¥æº**: [CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md](../2025/CVE-2025-29927-sn1p3rt3s7_NextJS_CVE-2025-29927.md)

## CVE-2025-29927-Next.jsä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶ï¼Œä¸”å­˜åœ¨åŸºäº x-middleware-subrequest å¤´çš„æˆæƒé€»è¾‘ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 1%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶å­˜åœ¨çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚ä¸­è®¾ç½® `x-middleware-subrequest` å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´å½±å“å¤šä¸ª Next.js ç‰ˆæœ¬ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl -H "x-middleware-subrequest: middleware" http://localhost:3000/admin` å‘½ä»¤ç»•è¿‡ä¸­é—´ä»¶ä¿æŠ¤è®¿é—® `/admin` é¡µé¢ã€‚æ¼æ´åˆ©ç”¨ä»£ç ä¸­çš„ `middleware.ts` æ–‡ä»¶å±•ç¤ºäº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é€»è¾‘ï¼Œè¯¥é€»è¾‘æ£€æŸ¥è¯·æ±‚å¤´ `x-middleware-subrequest` æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™ç»•è¿‡è®¤è¯ã€‚è¯¥æ¼æ´çš„åˆ©ç”¨æ–¹å¼ç®€å•ï¼Œé£é™©è¾ƒé«˜ï¼Œéœ€è¦åŠæ—¶å‡çº§ Next.js ç‰ˆæœ¬è¿›è¡Œä¿®å¤ã€‚ç»è¿‡å¯¹pocä»£ç åˆ†æï¼Œè¯¥ä»“åº“ä¸­åŸºæœ¬ä¸å­˜åœ¨ä½œè€…éšè—çš„æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§ï¼š**

æä¾›çš„ POC ä»£ç æœ‰æ•ˆï¼Œå¯ä»¥æˆåŠŸç»•è¿‡ Next.js ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æŠ•æ¯’é£é™©ï¼š**

ä»£ç ä¸­æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„ä»£ç ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º1%ã€‚ä¸»è¦åŸå› æ˜¯è¯¥é¡¹ç›®åŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œä»£ç é‡å°‘ï¼Œä¸”ç›®çš„æ€§æ˜ç¡®ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

æ”»å‡»è€…é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ï¼Œæ¬ºéª— Next.js ä¸­é—´ä»¶ï¼Œä½¿å…¶è®¤ä¸ºè¯¥è¯·æ±‚æ˜¯å†…éƒ¨å­è¯·æ±‚ï¼Œä»è€Œç»•è¿‡èº«ä»½éªŒè¯å’Œæˆæƒæ£€æŸ¥ã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š

1.  ç¡®å®šç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œè·¯ç”±ä¿æŠ¤ã€‚
2.  æ„é€  HTTP è¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ  `x-middleware-subrequest: middleware`ã€‚
3.  å‘é€æ„é€ å¥½çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ã€‚
4.  æˆåŠŸç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [sn1p3rt3s7/NextJS_CVE-2025-29927](https://github.com/sn1p3rt3s7/NextJS_CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #108

**æ¥æº**: [CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md](../2025/CVE-2025-29927-strobes-security_nextjs-vulnerable-app.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿèµ„æº

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` å¤´éƒ¨ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„å®‰å…¨æ§åˆ¶ã€‚æ ¹æ®æœç´¢å¼•æ“ç»“æœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸¥é‡çš„å®‰å…¨æ¼æ´ï¼ŒCVSS è¯„åˆ†é«˜è¾¾ 9.1ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“è¢«åˆ©ç”¨ã€‚æ¼æ´åº“ä¿¡æ¯ç¡®è®¤äº†è¯¥æ¼æ´å­˜åœ¨äºå¤šä¸ª Next.js ç‰ˆæœ¬ä¸­ï¼Œå¹¶å»ºè®®é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨è¯·æ±‚ã€‚æä¾›çš„ä»£ç çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªä½¿ç”¨ NextAuth.js å®ç°èº«ä»½éªŒè¯çš„ Next.js åº”ç”¨ç¨‹åºç¤ºä¾‹ï¼ŒåŒ…å«ç”¨äºä¿æŠ¤è·¯ç”±çš„ä¸­é—´ä»¶ã€‚`middleware.js` æ–‡ä»¶ä¸­å®ç°äº†è·¯ç”±ä¿æŠ¤é€»è¾‘ï¼Œä¾èµ– `next-auth/jwt` æ¥éªŒè¯ tokenã€‚å¦‚æœ `x-middleware-subrequest` å¤´éƒ¨å¯ä»¥ç»•è¿‡ `getToken` çš„éªŒè¯é€»è¾‘ï¼Œåˆ™å¯ä»¥æœªç»æˆæƒè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚

**æ¼æ´åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„æ¶æ„è¯·æ±‚ã€‚
2.  å¦‚æœä¸­é—´ä»¶å¯¹ `x-middleware-subrequest` å¤´çš„å¤„ç†ä¸å½“ï¼Œå¯èƒ½ç»•è¿‡èº«ä»½éªŒè¯æ£€æŸ¥ã€‚
3.  æ”»å‡»è€…è·å¾—å¯¹å—ä¿æŠ¤è·¯ç”±çš„æœªç»æˆæƒçš„è®¿é—®æƒé™ã€‚

**æŠ•æ¯’é£é™©åˆ†æï¼š**

åˆ†ææä¾›çš„ä»£ç ä»“åº“ï¼Œå‘ç°æ½œåœ¨çš„æŠ•æ¯’ç‚¹è¾ƒå°‘ã€‚ä¸»è¦é›†ä¸­åœ¨ä»¥ä¸‹æ–¹é¢ï¼š

*   **ä¾èµ–é¡¹ï¼š** `package.json` æ–‡ä»¶ä¸­å£°æ˜çš„ä¾èµ–é¡¹å¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚ä¸è¿‡ï¼Œè¿™äº›éƒ½æ˜¯å¸¸ç”¨çš„åº“ï¼Œé£é™©ç›¸å¯¹è¾ƒä½ã€‚
*   **ç¯å¢ƒå˜é‡ï¼š** `.env.local` æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡å¦‚æœè¢«æ³„éœ²ï¼Œå¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ã€‚ä½†è¿™æ˜¯åº”ç”¨ç¨‹åºé…ç½®é—®é¢˜ï¼Œä¸å±äºæŠ•æ¯’ã€‚

æ€»ä½“æ¥çœ‹ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚é£é™©ä¸»è¦æ¥è‡ªäºæ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»ï¼Œå³ä¾èµ–é¡¹ä¸­åŒ…å«æ¶æ„ä»£ç çš„å¯èƒ½æ€§ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„ä»£ç ä¼¼ä¹æ˜¯ä¸€ä¸ªç”¨äºæ¼”ç¤º Next.js èº«ä»½éªŒè¯çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œæœ¬èº«å¹¶ä¸åŒ…å«åˆ©ç”¨ CVE-2025-29927 æ¼æ´çš„ä»£ç ã€‚ä½†æ˜¯é€šè¿‡åœ¨å‘é€åˆ°æ­¤ç¤ºä¾‹åº”ç”¨ç¨‹åºçš„è¯·æ±‚æ·»åŠ  `x-middleware-subrequest` å¤´éƒ¨ï¼Œå¯ä»¥æµ‹è¯•è¯¥æ¼æ´çš„å­˜åœ¨ã€‚

**ä¼˜å…ˆçº§ï¼š**

ç”±äºæœç´¢å¼•æ“ç»“æœå’Œæ¼æ´åº“ä¿¡æ¯éƒ½è¡¨æ˜ CVE-2025-29927 æ˜¯ä¸€ä¸ªä¸¥é‡ä¸”å®¹æ˜“è¢«åˆ©ç”¨çš„æ¼æ´ï¼Œå› æ­¤åº”ä¼˜å…ˆä¿®å¤ã€‚


**é¡¹ç›®åœ°å€:** [strobes-security/nextjs-vulnerable-app](https://github.com/strobes-security/nextjs-vulnerable-app)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #109

**æ¥æº**: [CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md](../2025/CVE-2025-29927-t3tra-dev_cve-2025-29927-demo.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** Criticalï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿä¿¡æ¯å’ŒåŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** Next.js åº”ç”¨ä½¿ç”¨ middleware è¿›è¡Œæƒé™éªŒè¯ï¼Œä¸”æœªä¿®å¤æ­¤æ¼æ´

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 æ˜¯ Next.js ä¸­é—´ä»¶æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å« `x-middleware-subrequest` å¤´çš„ç‰¹åˆ¶ HTTP è¯·æ±‚ç»•è¿‡èº«ä»½éªŒè¯ã€‚æä¾›çš„ POC ä»£ç æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ `curl` å‘½ä»¤å‘é€åŒ…å«è¯¥æ ‡å¤´çš„è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚

**æœ‰æ•ˆæ€§:**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„ POC ä»£ç ï¼Œå¯ä»¥ç¡®å®šè¯¥æ¼æ´åˆ©ç”¨æ˜¯æœ‰æ•ˆçš„ã€‚POC æä¾›äº†ä¸€ä¸ªç®€å•çš„æ­¥éª¤æ¥é‡ç°è¯¥æ¼æ´ï¼Œå³å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„é¡µé¢ã€‚

**æŠ•æ¯’é£é™©:**
ä»£ç ä»“åº“ä¸­å‘ç°æ½œåœ¨æŠ•æ¯’ä»£ç çš„å¯èƒ½æ€§ä¼°è®¡ä¸º 10%ã€‚åŸå› æ˜¯ï¼š
  *  `eslint.config.mjs`ã€`next.config.ts`ã€`package-lock.json`ä¸»è¦æ˜¯é…ç½®æ–‡ä»¶ï¼ŒæŠ•æ¯’æ¦‚ç‡è¾ƒä½
  *  `middleware.ts` æ–‡ä»¶å®šä¹‰äº†ä¸­é—´ä»¶é€»è¾‘ï¼Œå¯èƒ½å­˜åœ¨æ¶æ„ä¿®æ”¹æƒé™éªŒè¯é€»è¾‘çš„é£é™©ã€‚
  *  `README.md`æ–‡ä»¶æä¾›äº†å¦‚ä½•åˆ©ç”¨è¯¥æ¼æ´çš„ä¿¡æ¯ï¼Œä½†æœ¬èº«ä¸åŒ…å«æ¶æ„ä»£ç ã€‚
  *  éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPOC æœ¬èº«åˆ©ç”¨æ¼æ´è¿›è¡ŒéªŒè¯ï¼Œä¸åº”å°†å…¶è§†ä¸ºæŠ•æ¯’ã€‚

**åˆ©ç”¨æ–¹å¼:**
1.  ç›®æ ‡ Next.js åº”ç”¨å¿…é¡»ä½¿ç”¨ middleware è¿›è¡Œæˆæƒæ£€æŸ¥ã€‚
2.  åº”ç”¨ç‰ˆæœ¬å¿…é¡»åœ¨å—å½±å“çš„èŒƒå›´å†…ï¼ˆ>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3ï¼‰ã€‚
3.  æ”»å‡»è€…æ„é€ åŒ…å« `x-middleware-subrequest` å¤´çš„ HTTP è¯·æ±‚ã€‚å¯¹äº Next.js 15.x ç‰ˆæœ¬ï¼Œè¯¥headerçš„å€¼éœ€è¦å°† middleware name é‡å¤ 5 æ¬¡ä»¥ä¸Šä½¿ç”¨":" åˆ†å‰²ã€‚æ—§ç‰ˆæœ¬å¯èƒ½åªéœ€ä¸€ä¸ªmiddleware nameã€‚
4.  å‘é€æ„é€ çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±ï¼Œç»•è¿‡æˆæƒæ£€æŸ¥ã€‚

**é¡¹ç›®åœ°å€:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #110

**æ¥æº**: [CVE-2025-29927-takumade_ghost-route.md](../2025/CVE-2025-29927-takumade_ghost-route.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** 11.1.4 <= ç‰ˆæœ¬ <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”æ¼æ´æœªè¢«ä¿®å¤

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´æ˜¯ç”±äº Next.js åœ¨å¤„ç†åŒ…å« `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚æ—¶å­˜åœ¨ç¼ºé™·ã€‚ æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®špayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„æ¶æ„è¯·æ±‚æ¥ç»•è¿‡èº«ä»½éªŒè¯ï¼Œè®¿é—®å—ä¿æŠ¤çš„è·¯ç”±ã€‚æ¼æ´åˆ©ç”¨ä»£ç  `ghost-route.py` é€šè¿‡å‘é€å¸¦æœ‰ä¸åŒpayloadçš„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP GET è¯·æ±‚æ¥æµ‹è¯•ç›®æ ‡æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ ä»£ç ä¸­æ²¡æœ‰å‘ç°ä»»ä½•æ˜æ˜¾çš„æŠ•æ¯’è¡Œä¸ºã€‚ å®ƒåªæ˜¯å‘é€å¸¦æœ‰æ¶æ„headerçš„è¯·æ±‚ï¼Œå¹¶æ£€æŸ¥å“åº”çŠ¶æ€ç ï¼Œåˆ¤æ–­æ˜¯å¦æˆåŠŸç»•è¿‡ä¸­é—´ä»¶ï¼Œè®¿é—®å—ä¿æŠ¤èµ„æº.  å¦‚æœçŠ¶æ€ç ä¸æ˜¯ 403, 401, 302 æˆ– 404ï¼Œåˆ™æŠ¥å‘Šå­˜åœ¨æ¼æ´ã€‚ 

**åˆ©ç”¨æ–¹å¼:**
1.  **å‘é€å¸¦æœ‰ `x-middleware-subrequest` æ ‡å¤´çš„è¯·æ±‚ï¼š** æ”»å‡»è€…æ„é€ ä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å« `x-middleware-subrequest` æ ‡å¤´ï¼Œå¹¶è®¾ç½®æ¶æ„payloadã€‚ä¸åŒçš„Next.jsç‰ˆæœ¬Payloadä¸åŒï¼Œpocä»£ç æä¾›å¤šç§payloadså°è¯•ã€‚
2.  **ç»•è¿‡æˆæƒæ£€æŸ¥ï¼š** Next.js åº”ç”¨çš„ä¸­é—´ä»¶åœ¨å¤„ç†è¯·æ±‚æ—¶ï¼Œç”±äºæ¼æ´çš„å­˜åœ¨ï¼Œæœªèƒ½æ­£ç¡®åœ°æ‰§è¡Œæˆæƒæ£€æŸ¥ã€‚
3.  **è®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼š** æ”»å‡»è€…æˆåŠŸåœ°ç»•è¿‡äº†æˆæƒï¼Œä»è€Œå¯ä»¥è®¿é—®åŸæœ¬å—ä¿æŠ¤çš„è·¯ç”±æˆ–èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #111

**æ¥æº**: [CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md](../2025/CVE-2025-29927-ticofookfook_poc-nextjs-CVE-2025-29927.md)

## CVE-2025-29927 - Next.js Middleware æˆæƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ Next.js åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶ï¼Œä¸”å¯¹å¤–å¼€æ”¾æœåŠ¡ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927 å­˜åœ¨äº Next.js çš„ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…é€šè¿‡ `x-middleware-subrequest` æ ‡å¤´ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚ æ ¹æ® Next.js çš„ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ payloadï¼š

*   **æ—©æœŸç‰ˆæœ¬ï¼ˆä½äº 12.2ï¼‰**: `x-middleware-subrequest: pages/_middleware`
*   **ç‰ˆæœ¬ 12.2 åŠæ›´é«˜ç‰ˆæœ¬**: `x-middleware-subrequest: middleware` æˆ– `x-middleware-subrequest: src/middleware`ï¼ˆå¦‚æœåº”ç”¨ç¨‹åºä½¿ç”¨ src ç›®å½•ï¼‰
*   **æ›´æ–°ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ 15.xï¼‰**: `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` æˆ– `x-middleware-subrequest: src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`

**æœ‰æ•ˆæ€§ï¼š**

æ ¹æ®æ¼æ´ä¿¡æ¯å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚æä¾›çš„ PoC ä»£ç æ—¨åœ¨é€šè¿‡å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚æ¥æ£€æµ‹æ­¤æ¼æ´ã€‚PoC åŒ…å«é’ˆå¯¹ä¸åŒ Next.js ç‰ˆæœ¬çš„ payloadï¼Œè¿™è¡¨æ˜å®ƒèƒ½å¤Ÿæ£€æµ‹å„ç§å—å½±å“çš„åº”ç”¨ç¨‹åºã€‚

**æŠ•æ¯’é£é™©ï¼š**

PoC ä»£ç æœ¬èº«ä¸»è¦ç”¨äºæ£€æµ‹æ¼æ´ã€‚ä½†æ˜¯ï¼Œå­˜åœ¨å°‘é‡æŠ•æ¯’é£é™©ã€‚PoC ä»£ç æ‰§è¡Œ HTTP è¯·æ±‚ï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨å®¹æ˜“å—åˆ°å‘½ä»¤æ³¨å…¥æˆ–å…¶ä»–æœåŠ¡å™¨ç«¯æ¼æ´çš„å½±å“ï¼Œåˆ™å¯èƒ½ä¼šè¢«åˆ©ç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ PoC å…è®¸ç”¨æˆ·æŒ‡å®šä»»æ„è·¯å¾„ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥æ³¨å…¥æ¶æ„ä»£ç ã€‚æ­¤å¤–ï¼Œè¯¥ PoC ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹åº“ï¼ˆrequests, coloramaï¼‰,è™½ç„¶è¿™äº›åº“æœ¬èº«ä¸è¢«è®¤ä¸ºæ˜¯æ¶æ„çš„ï¼Œä½†å§‹ç»ˆå­˜åœ¨ä¾›åº”é“¾æ”»å‡»çš„é£é™©ã€‚è€ƒè™‘åˆ°è¿™äº›é£é™©ï¼ŒæŠ•æ¯’é£é™©ä¼°è®¡ä¸º 10%ã€‚å¤§éƒ¨åˆ†ä»£ç æ˜¯æ‰«æå™¨å’Œè¾“å‡ºï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…æ„é€ åŒ…å«æ¶æ„ `x-middleware-subrequest` æ ‡å¤´çš„ HTTP è¯·æ±‚ã€‚
2.  æ­¤è¯·æ±‚å‘é€åˆ°ç›®æ ‡ Next.js åº”ç”¨ç¨‹åºã€‚
3.  å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶ä¸­çš„æˆæƒæ£€æŸ¥å°†è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæœªç»æˆæƒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ç»•è¿‡èº«ä»½éªŒè¯æˆ–æˆæƒæœºåˆ¶ï¼Œè®¿é—®ç®¡ç†é¢æ¿æˆ–æ•æ„Ÿæ•°æ®ã€‚

**é¡¹ç›®åœ°å€:** [ticofookfook/poc-nextjs-CVE-2025-29927](https://github.com/ticofookfook/poc-nextjs-CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #112

**æ¥æº**: [CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md](../2025/CVE-2025-29927-tobiasGuta_CVE-2025-29927-POC.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶è®¤è¯ç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** è®¤è¯ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** < 14.2.25, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** åº”ç”¨ç¨‹åºä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2025-29927æ˜¯ä¸€ä¸ªNext.jsä¸­é—´ä»¶è®¤è¯ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`æ¥ç»•è¿‡ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼Œå—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬Next.js 11.1.4 åˆ° 13.5.6ï¼Œå¤§äº 14.0.0 å°äº 14.2.25, å¤§äº 15.0.0 å°äº 15.2.3ã€‚æœç´¢å¼•æ“ç»“æœæ˜¾ç¤ºè¯¥æ¼æ´å·²å…¬å¼€ï¼Œå¹¶æœ‰å¤šä¸ªå®‰å…¨å‚å•†è¿›è¡Œäº†åˆ†æã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªNucleiæ¨¡æ¿ï¼Œå®ƒé€šè¿‡å‘é€å¸¦æœ‰æ¶æ„headerçš„GETè¯·æ±‚æ¥æ£€æµ‹æ¼æ´ã€‚å¦‚æœæœåŠ¡å™¨è¿”å›200çŠ¶æ€ç ï¼Œä¸”å“åº”å†…å®¹åŒ…å«"Protected Page Content"ï¼Œåˆ™è¡¨ç¤ºæ¼æ´å­˜åœ¨ã€‚è¯¥POCçš„æœ‰æ•ˆæ€§è¾ƒé«˜ï¼Œå› ä¸ºå®ƒç›´æ¥åˆ©ç”¨äº†æ¼æ´çš„æ ¹æœ¬åŸå› ï¼ˆå³`x-middleware-subrequest`å¤´çš„å¤„ç†ä¸å½“ï¼‰ã€‚

**å…³äºæŠ•æ¯’é£é™©ï¼š**
æŸ¥çœ‹POCä»£ç ï¼Œè¯¥ä»“åº“ä¸»è¦åŒ…å«ä¸€ä¸ªYAMLæ ¼å¼çš„Nucleiæ¨¡æ¿å’Œä¸€ä¸ªREADME.mdæ–‡ä»¶ã€‚Nucleiæ¨¡æ¿å®šä¹‰äº†æ¼æ´çš„æ£€æµ‹é€»è¾‘ï¼Œå³å‘é€å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚å¹¶éªŒè¯å“åº”ã€‚README.mdæ–‡ä»¶æä¾›äº†æ¼æ´çš„æè¿°å’Œä½¿ç”¨è¯´æ˜ã€‚æ•´ä¸ªä»£ç åº“çš„åŠŸèƒ½é›†ä¸­äºæ¼æ´çš„æ£€æµ‹ï¼Œæ²¡æœ‰å‘ç°ä»»ä½•å¯ç–‘çš„æˆ–åé—¨ä»£ç ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¯„ä¼°ä¸º0%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **ç›®æ ‡è¯†åˆ«:** ç¡®å®šç›®æ ‡Next.jsåº”ç”¨ç¨‹åºæ˜¯å¦ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ï¼Œä¸”ç‰ˆæœ¬æ˜¯å¦åœ¨å—å½±å“èŒƒå›´å†…ã€‚
2.  **æ„é€ è¯·æ±‚:** æ„é€ ä¸€ä¸ªHTTP GETè¯·æ±‚ï¼Œå¹¶åœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ `x-middleware-subrequest: middleware`ã€‚
3.  **å‘é€è¯·æ±‚:** å°†æ„é€ å¥½çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **éªŒè¯ç»“æœ:** å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºè¿”å›æœªç»æˆæƒçš„é¡µé¢çš„å†…å®¹ï¼ˆä¾‹å¦‚ï¼Œæœ¬åº”éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®çš„é¡µé¢ï¼‰ï¼Œåˆ™è¡¨ç¤ºæ¼æ´åˆ©ç”¨æˆåŠŸã€‚

**é¡¹ç›®åœ°å€:** [tobiasGuta/CVE-2025-29927-POC](https://github.com/tobiasGuta/CVE-2025-29927-POC)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #113

**æ¥æº**: [CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md](../2025/CVE-2025-29927-w2hcorp_CVE-2025-29927-Exploit.md)

## CVE-2025-29927-Next.js-ä¸­é—´ä»¶é‰´æƒç»•è¿‡

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** é‰´æƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®æ•æ„Ÿæ•°æ®æˆ–åŠŸèƒ½

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡Next.jsåº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„ä¸­é—´ä»¶é‰´æƒé€»è¾‘ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘èµ·ç½‘ç»œè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927 æ¼æ´å­˜åœ¨äº Next.js ä¸­é—´ä»¶ä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡æˆæƒæ£€æŸ¥ã€‚è¯¥æ¼æ´çš„æ ¹æºåœ¨äºå¯¹ `x-middleware-subrequest` HTTP å¤´çš„å¤„ç†ä¸å½“ã€‚å½“æ­¤ header è¢«è®¾ç½®ä¸º `middleware` æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½é”™è¯¯åœ°è®¤ä¸ºè¯·æ±‚æºè‡ªå†…éƒ¨é€»è¾‘ï¼Œä»è€Œç»•è¿‡åŸºäºä¸­é—´ä»¶çš„èº«ä»½éªŒè¯ã€‚æ ¹æ®æ¼æ´åº“ä¿¡æ¯ï¼ŒCVSS è¯„åˆ†ä¸º 9.1ï¼Œå±äºä¸¥é‡çº§åˆ«ã€‚å—å½±å“çš„ç‰ˆæœ¬åŒ…æ‹¬ >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25 å’Œ > 15.0.0, < 15.2.3ã€‚

**æœ‰æ•ˆæ€§ï¼š** æä¾›çš„ PoC ä»£ç çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒä½¿ç”¨ Python çš„ `requests` åº“å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ã€‚å¦‚æœç›®æ ‡åº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œåˆ™æ­¤è¯·æ±‚å°†ç»•è¿‡ä¸­é—´ä»¶èº«ä»½éªŒè¯ã€‚

**æŠ•æ¯’é£é™©ï¼š** PoC ä»£ç çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º 5%ã€‚ä¸»è¦é£é™©æ¥è‡ªäºä¾èµ–é¡¹ï¼Œå³ `requests` åº“ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„åº“ï¼Œä¸å¤ªå¯èƒ½åŒ…å«æ¶æ„ä»£ç ã€‚PoC ä»£ç æœ¬èº«éå¸¸ç®€å•ï¼Œç›´æ¥å‘é€å¸¦æœ‰ç‰¹å®š header çš„è¯·æ±‚ï¼Œæ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚é£é™©ç‚¹åŒ…æ‹¬ï¼š1. å¦‚æœä»£ç†æœåŠ¡å™¨è¢«æ¶æ„æ§åˆ¶ï¼Œåˆ™æ”»å‡»è€…çš„æµé‡å¯èƒ½è¢«å—…æ¢æˆ–ç¯¡æ”¹ã€‚2. æ”»å‡»è€…å¯èƒ½ä¼šä¿®æ”¹expolit.pyï¼Œä½¿å…¶åŒ…å«æ¶æ„payloadå¹¶ä¼ æ’­ï¼Œè¯±å¯¼å…¶ä»–å®‰å…¨ç ”ç©¶äººå‘˜ä½¿ç”¨ã€‚å°½ç®¡æœ‰è¿™äº›å¯èƒ½æ€§ï¼Œä½†æ ¸å¿ƒ PoC ä»£ç æœ¬èº«ä¼¼ä¹æ˜¯å®‰å…¨çš„ï¼Œé£é™©å æ¯”å°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š** æ”»å‡»è€…é€šè¿‡å‘é€å¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚æ¥åˆ©ç”¨æ­¤æ¼æ´ã€‚åˆ©ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š

1.  **ç¡®å®šç›®æ ‡ï¼š** æ‰¾åˆ°è¿è¡Œå­˜åœ¨æ¼æ´çš„ Next.js ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è¯¥åº”ç”¨ç¨‹åºä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯ã€‚
2.  **æ„é€ è¯·æ±‚ï¼š** åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ `x-middleware-subrequest: middleware` å¤´çš„ HTTP è¯·æ±‚ï¼Œç›®æ ‡æ˜¯å—ä¿æŠ¤çš„èµ„æºï¼ˆä¾‹å¦‚ï¼Œç®¡ç†é¢æ¿æˆ– API ç«¯ç‚¹ï¼‰ã€‚
3.  **å‘é€è¯·æ±‚ï¼š** å°†æ„é€ çš„è¯·æ±‚å‘é€åˆ°ç›®æ ‡åº”ç”¨ç¨‹åºã€‚
4.  **ç»•è¿‡èº«ä»½éªŒè¯ï¼š** å¦‚æœåº”ç”¨ç¨‹åºæ˜“å—æ”»å‡»ï¼Œä¸­é—´ä»¶èº«ä»½éªŒè¯å°†è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

å¯ä»¥é€šè¿‡å‡çº§ Next.js ç‰ˆæœ¬æˆ–è€…åœ¨ Web åº”ç”¨é˜²ç«å¢™ä¸­è®¾ç½®è§„åˆ™æ¥é˜»æ­¢å«æœ‰ `x-middleware-subrequest: middleware` çš„è¯·æ±‚ï¼Œæ¥ç¼“è§£æ­¤æ¼æ´ã€‚

**é¡¹ç›®åœ°å€:** [w2hcorp/CVE-2025-29927-Exploit](https://github.com/w2hcorp/CVE-2025-29927-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #114

**æ¥æº**: [CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md](../2025/CVE-2025-29927-websecnl_CVE-2025-29927-PoC-Exploit.md)

## CVE-2025-29927-Next.js Middleware Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æˆæƒç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å—å½±å“çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æˆæƒç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ `x-middleware-subrequest` è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å­˜åœ¨äºç‰ˆæœ¬ >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3ã€‚æä¾›çš„PoCè„šæœ¬é€šè¿‡å‘é€åŒ…å«ç‰¹åˆ¶ `x-middleware-subrequest` å¤´çš„è¯·æ±‚æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚è„šæœ¬é¦–å…ˆè·å–ç›®æ ‡URLçš„baselineå“åº”ï¼Œç„¶åå‘é€å¸¦æœ‰payloadçš„æµ‹è¯•è¯·æ±‚ã€‚å¦‚æœä¸¤ä¸ªå“åº”ä¸åŒï¼Œåˆ™è®¤ä¸ºå­˜åœ¨æ¼æ´ã€‚è¯¥è„šæœ¬ä¼šå°è¯•ä¸€äº›å¸¸è§çš„ç®¡ç†é¡µé¢å’Œç™»å½•é¡µé¢ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦æ˜¯å› ä¸ºä»£ç åŠŸèƒ½ç›¸å¯¹æ¸…æ™°ï¼Œç”¨äºæ¼æ´éªŒè¯ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ä½œè€…æ¶æ„æ·»åŠ çš„ç»†å¾®åé—¨ä»£ç çš„å¯èƒ½æ€§ï¼Œä¾‹å¦‚ä¸æ˜æ˜¾çš„è¯·æ±‚å¤´ä¿®æ”¹æˆ–æ¡ä»¶åˆ¤æ–­ã€‚ä¸»è¦é£é™©ç‚¹åœ¨äºPoCä»£ç çš„ç”Ÿæˆæ–¹å¼æ˜¯åŸºäºOpenAI GPT-3ï¼Œè¿™å¯èƒ½å¼•å…¥ä¸€äº›ä¸å¯é¢„æµ‹çš„è¡Œä¸º,ä»¥åŠä¾èµ–åº“çš„å®‰å…¨æ€§ã€‚ æ¼æ´çš„åˆ©ç”¨æ–¹å¼æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€å¸¦æœ‰ç‰¹å®š `x-middleware-subrequest` å¤´çš„HTTPè¯·æ±‚ï¼Œç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ã€‚ä¸ºäº†ç¼“è§£æ­¤æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°Next.jsçš„ä¿®å¤ç‰ˆæœ¬(>=14.2.25 æˆ– >=15.2.3)ï¼Œæˆ–è€…é˜»æ­¢åŒ…å« `x-middleware-subrequest` å¤´çš„å¤–éƒ¨ç”¨æˆ·è¯·æ±‚ã€‚

**é¡¹ç›®åœ°å€:** [websecnl/CVE-2025-29927-PoC-Exploit](https://github.com/websecnl/CVE-2025-29927-PoC-Exploit)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #115

**æ¥æº**: [CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md](../2025/CVE-2025-29927-yugo-eliatrope_test-cve-2025-29927.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** Authorization Bypass

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªç»æˆæƒçš„è®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œå¹¶ä¸”æˆæƒæ£€æŸ¥ä½äºä¸­é—´ä»¶ä¸­

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæˆæƒç»•è¿‡æ¼æ´ã€‚æ ¹æ®æ¼æ´æè¿°å’Œæœç´¢ç»“æœï¼Œè¯¥æ¼æ´æ˜¯ç”±äºNext.jså¤„ç†`x-middleware-subrequest` headerä¸å½“é€ æˆçš„ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æŸç§æ–¹å¼æ“çºµè¿™ä¸ªheaderç»•è¿‡ä¸­é—´ä»¶çš„æˆæƒæ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚æ¼æ´å½±å“çš„Next.jsç‰ˆæœ¬åŒ…æ‹¬11.1.4åˆ°13.5.6ï¼Œ14.0.0åˆ°14.2.25ï¼Œä»¥åŠ15.0.0åˆ°15.2.3ã€‚Rapid7ã€JFrogã€Picus Securityã€Truesecã€Strobesã€Cyoloã€SLCyberå’ŒSocprimeç­‰å®‰å…¨å‚å•†éƒ½å¯¹æ­¤æ¼æ´è¿›è¡Œäº†åˆ†æå’ŒæŠ¥é“ã€‚

æä¾›çš„ä»£ç åªæ˜¯ä¸€ä¸ªNext.jsé¡¹ç›®çš„åŸºæœ¬æ¡†æ¶ï¼Œç”¨äºåˆ›å»ºã€æ„å»ºå’Œè¿è¡ŒNext.jsåº”ç”¨ç¨‹åºï¼Œæœ¬èº«ä¸åŒ…å«ä»»ä½•ç›´æ¥åˆ©ç”¨CVE-2025-29927æ¼æ´çš„ä»£ç ã€‚å› æ­¤,åˆ¤å®šPOCæœ‰æ•ˆæ€§,å–å†³äºæ˜¯å¦å­˜åœ¨åˆ©ç”¨`x-middleware-subrequest` headerç»•è¿‡ä¸­é—´ä»¶æˆæƒéªŒè¯,å®Œæˆæ”»å‡»çš„ä»£ç å®ç°ã€‚è¿™äº›ä»£ç ç”¨äºæ¼”ç¤ºæˆ–éªŒè¯æ¼æ´çš„å­˜åœ¨, æœç´¢ç»“æœä¸­å¤§é‡æ–‡ç« åˆ†æäº†æ¼æ´åŸç†ã€‚æ‰€ä»¥POCæ˜¯å­˜åœ¨çš„ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

ä»£ç ä»“åº“ä¸­åŒ…å«`README.md`, `next.config.mjs`, `package.json`, `tsconfig.json`, `yarn.lock` è¿™äº›æ ‡å‡†Next.jsé¡¹ç›®çš„é…ç½®æ–‡ä»¶ï¼Œæ²¡æœ‰å‘ç°æ¶æ„ä»£ç ã€‚ä½†æ˜¯ï¼Œ`package.json` ä¸­çš„ä¾èµ–é¡¹å¯èƒ½å­˜åœ¨æ½œåœ¨çš„ä¾›åº”é“¾æ”»å‡»é£é™©ï¼Œéœ€è¦ä»”ç»†æ£€æŸ¥ä¾èµ–é¡¹çš„å®‰å…¨æ€§ã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªæ¡†æ¶ä»£ç ï¼Œè¢«æ¤å…¥æ¶æ„ä»£ç çš„å¯èƒ½æ€§ä¸é«˜ã€‚æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä¸èƒ½å®Œå…¨æ’é™¤ã€‚é¢„ä¼°æŠ•æ¯’æ¦‚ç‡ä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€åŒ…å«æ¶æ„æ„é€ çš„`x-middleware-subrequest` headerçš„HTTPè¯·æ±‚ã€‚
2.  Next.jsä¸­é—´ä»¶æœªèƒ½æ­£ç¡®éªŒè¯è¯¥headerã€‚
3.  å¯¼è‡´æˆæƒæ£€æŸ¥è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…è·å¾—æœªæˆæƒè®¿é—®æƒé™ã€‚
4.  æ”»å‡»è€…å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„èµ„æºæˆ–æ‰§è¡Œæ•æ„Ÿæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [yugo-eliatrope/test-cve-2025-29927](https://github.com/yugo-eliatrope/test-cve-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #116

**æ¥æº**: [CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md](../2025/CVE-2025-29927-yuzu-juice_CVE-2025-29927_demo.md)

## CVE-2025-29927-Next.js-Authorization Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡åº”ç”¨ä½¿ç”¨äº†Next.jsä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒ

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­å­˜åœ¨çš„æƒé™ç»•è¿‡æ¼æ´ã€‚å¦‚æœåº”ç”¨ç¨‹åºåœ¨ä¸­é—´ä»¶ä¸­æ‰§è¡Œæˆæƒæ£€æŸ¥ï¼Œåˆ™æ”»å‡»è€…å¯ä»¥é€šè¿‡å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„ç‰¹åˆ¶HTTPè¯·æ±‚æ¥ç»•è¿‡è¿™äº›æ£€æŸ¥ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æ ¹æ®æ¼æ´æè¿°å’Œæä¾›çš„POCä»£ç ï¼Œè¯¥æ¼æ´æ˜¯æœ‰æ•ˆçš„ã€‚POCç»™å‡ºäº†é‡ç°æ­¥éª¤ï¼ŒåŒ…æ‹¬å®‰è£…ä¾èµ–ã€å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œç„¶åä½¿ç”¨curlå‘½ä»¤å‘é€å¸¦æœ‰ç‰¹å®š`x-middleware-subrequest`å¤´çš„è¯·æ±‚åˆ°å—ä¿æŠ¤çš„è·¯ç”±`/protected`ã€‚

**æŠ•æ¯’é£é™©ï¼š**
åˆ†æPOCä»£ç ï¼Œä¸»è¦åŒ…å«`README.md`ã€`next.config.ts`ã€`package-lock.json`ã€`package.json`ä»¥åŠpagesç›®å½•ä¸‹çš„è·¯ç”±æ–‡ä»¶ã€‚ä»£ç ç»“æ„ç®€å•ï¼Œä¸»è¦æ˜¯Next.jsé¡¹ç›®çš„åŸºç¡€é…ç½®å’Œè·¯ç”±å®šä¹‰ã€‚ä¸»è¦çš„é£é™©åœ¨äºå®‰è£…ä¾èµ–æ—¶å¯èƒ½å¼•å…¥æ¶æ„åŒ…ã€‚ä½†ç›´æ¥åœ¨å½“å‰ä»“åº“çš„ä»£ç ä¸­å‘ç°æ˜æ˜¾æ¶æ„ä»£ç çš„å¯èƒ½æ€§è¾ƒä½ã€‚é£é™©è¯„ä¼°ï¼š10%ï¼ˆä½ï¼‰ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å­˜åœ¨æ¼æ´çš„Next.jsç‰ˆæœ¬ï¼Œä¸”ä½¿ç”¨äº†ä¸­é—´ä»¶è¿›è¡Œæƒé™æ ¡éªŒã€‚
2.  æ”»å‡»è€…æ„é€ å¸¦æœ‰`x-middleware-subrequest`å¤´çš„HTTPè¯·æ±‚ã€‚
3.  å½“è¯·æ±‚åˆ°è¾¾Next.jsåº”ç”¨æ—¶ï¼Œä¸­é—´ä»¶çš„æƒé™æ ¡éªŒé€»è¾‘è¢«ç»•è¿‡ï¼Œæ”»å‡»è€…å¯ä»¥è®¿é—®åŸæœ¬éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„èµ„æºã€‚

**é¡¹ç›®åœ°å€:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

## POC #117

**æ¥æº**: [CVE-2025-29927-zs1n_CVE-2025-29927.md](../2025/CVE-2025-29927-zs1n_CVE-2025-29927.md)

## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**æ¼æ´ç¼–å·:** CVE-2025-29927

**æ¼æ´ç±»å‹:** æƒé™ç»•è¿‡

**å½±å“åº”ç”¨:** Next.js

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´æœªæˆæƒè®¿é—®å’Œæ•°æ®æ³„éœ²

**å½±å“ç‰ˆæœ¬:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡åº”ç”¨ä½¿ç”¨Next.jsä¸­é—´ä»¶è¿›è¡Œèº«ä»½éªŒè¯

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2025-29927æ˜¯Next.jsä¸­é—´ä»¶ä¸­çš„ä¸€ä¸ªæƒé™ç»•è¿‡æ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ`x-middleware-subrequest`è¯·æ±‚å¤´æ¥ç»•è¿‡ä¸­é—´ä»¶ä¸­çš„èº«ä»½éªŒè¯æ£€æŸ¥ï¼Œä»è€Œè®¿é—®å—ä¿æŠ¤çš„èµ„æºã€‚

**æœ‰æ•ˆæ€§ï¼š**æ ¹æ®æä¾›çš„æ¼æ´åº“ä¿¡æ¯ã€æœç´¢ç»“æœå’ŒPoCä»£ç ï¼Œè¯¥æ¼æ´çš„PoCå·²å‘å¸ƒï¼Œå¹¶ä¸”å¤šä¸ªå®‰å…¨å‚å•†ï¼ˆå¦‚Picus Security, JFrog, Assetnote, Wiz, Rapid7, ProjectDiscovery, Datadog, OffSecï¼‰éƒ½å‘å¸ƒäº†åˆ†ææŠ¥å‘Šï¼Œè¯æ˜è¯¥æ¼æ´çš„æœ‰æ•ˆæ€§ã€‚

**æŠ•æ¯’é£é™©ï¼š** æä¾›çš„PoCä»£ç åªåŒ…å«ä¸€ä¸ªREADME.mdæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹åªæ˜¯æè¿°äº†æ¼æ´å’Œå½±å“ç‰ˆæœ¬ã€‚å› æ­¤ï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œä½†ä»ä¸èƒ½å®Œå…¨æ’é™¤ï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨å…¶ä»–æœªå…¬å¼€çš„æŠ•æ¯’æ‰‹æ®µã€‚è€ƒè™‘åˆ°ä»£ç ä»“åº“éå¸¸ç®€å•, æŠ•æ¯’é£é™©è¯„å®šä¸º10%ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  ç›®æ ‡åº”ç”¨ä½¿ç”¨å—å½±å“ç‰ˆæœ¬çš„Next.jsï¼Œå¹¶ä½¿ç”¨ä¸­é—´ä»¶è¿›è¡Œæƒé™éªŒè¯ã€‚
2.  æ”»å‡»è€…å‘é€åŒ…å«`x-middleware-subrequest`å¤´çš„æ¶æ„è¯·æ±‚ã€‚
3.  Next.jsåœ¨å¤„ç†è¯¥è¯·æ±‚å¤´æ—¶å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´ä¸­é—´ä»¶çš„èº«ä»½éªŒè¯é€»è¾‘è¢«ç»•è¿‡ã€‚
4.  æ”»å‡»è€…æˆåŠŸè®¿é—®å—ä¿æŠ¤çš„èµ„æºï¼Œæ‰§è¡Œæœªæˆæƒæ“ä½œã€‚

**é¡¹ç›®åœ°å€:** [zs1n/CVE-2025-29927](https://github.com/zs1n/CVE-2025-29927)

**æ¼æ´è¯¦æƒ…:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)

---

