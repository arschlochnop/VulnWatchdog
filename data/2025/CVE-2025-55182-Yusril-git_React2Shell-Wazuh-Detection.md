## CVE-2025-55182 - React Server Components, Next.js, react-server-dom-we 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, react-server-dom-we

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** 影响React服务器组件和Next.js应用程序，特别是`react-server-dom-we`组件，具体受影响版本范围未详细披露

**利用条件:** 未认证访问，需要通过精心构造的multipart表单请求，通过网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (实验室环境与检测工程)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，CVSS评分为10.0，影响React服务器组件（React Server Components, RSC）及基于Next.js的应用。该漏洞于2025年12月3日由Lachlan Davidson披露，并迅速被安全社区认定为“核弹级”漏洞，在野外被多个威胁组织利用。

该漏洞的核心根源在于React Flight反序列化机制中，在处理对象属性访问路径（如`__proto__`、`constructor`）时缺乏严格的校验。React Server Components架构允许组件在服务端渲染并通过“Flight”协议以JSON-like流式格式发送到客户端，实现高效交互。然而，攻击者可以利用这一反序列化过程的缺陷，通过构造恶意的multipart表单实现RCE。具体的攻击流程涉及攻击者利用`$B`引用，结合可控的`_response._prefix`和被劫持为`Function`类型的`_formData.get`，动态生成包含任意系统命令的函数。随后，这些恶意函数被赋值给对象的`.then`属性，当Promise对象解析时，导致系统命令被执行。这种攻击手法巧妙地绕过了既有的安全防护机制，通过操纵反序列化过程，在未认证的情况下，允许攻击者在服务器上执行任意代码。受影响的组件包括`react-server-dom-we`。

**POC有效性分析:**
提供的POC是一个名为“React2Shell (CVE-2025-55182) Detection Lab”的防御性研究项目。该项目旨在帮助蓝队和SOC分析师理解并检测CVE-2025-55182漏洞的利用行为。它包含一个完整的实验环境，而非仅仅是一个简单的漏洞利用脚本。具体而言，它提供了：
1.  `/app`目录：包含一个模拟易受攻击的Node.js应用程序的源代码。这个应用程序可能通过使用`node-serialize`等库来模拟不安全的反序列化场景，从而暴露漏洞。
2.  `/payloads`目录：包含用于生成恶意Base64编码payload的脚本。这些payload旨在模拟攻击者构造的，能够触发RCE和反弹shell的恶意数据。
3.  `/wazuh-rules`目录：包含Wazuh SIEM/EDR的自定义检测规则（XML配置）。这些规则是专门为捕获CVE-2025-55182漏洞利用过程中产生的特定妥协指标（IOCs）而设计的。
4.  `/evidence`目录：包含Wazuh警报的截图，作为漏洞成功检测的证据。

该POC的质量非常高（评分为9/10），因为它不仅提供了漏洞利用的模拟环境，还提供了详细的蓝队检测方案。它的主要目标是“仿真”攻击向量（包括Base64 payload的使用和任意函数执行）以及“检测工程”，以实时捕获利用的IOCs。这使得它对于安全研究人员、防御团队和教育目的来说是一个极其有效和实用的资源，能够深入理解漏洞的机制和如何有效地进行防御。

**利用步骤（基于POC和搜索结果综合提炼）:**
1.  **目标识别**：识别运行React服务器组件或Next.js应用程序的潜在受害者服务器。
2.  **构造恶意请求**：攻击者需要精心构造一个恶意的multipart表单请求。这个请求将包含用于操纵React Flight协议反序列化逻辑的特殊结构。
3.  **Payload注入**：在表单数据中嵌入经过编码（例如Base64）的恶意代码或系统命令。这些payload将针对反序列化过程中的`__proto__`或`constructor`路径进行注入，以动态地创建和执行函数。
4.  **反序列化触发**：当服务器尝试反序列化传入的Flight协议数据时，攻击者构造的恶意结构会导致其内部逻辑被劫持，例如将`_formData.get`方法重定向到一个恶意函数。
5.  **命令执行**：最终，注入的恶意代码（例如调用`child_process.execSync`）会在服务器上执行，从而实现远程代码执行，可能导致数据窃取、系统破坏或建立反向shell。
6.  **POC模拟**：在Detection Lab中，攻击者（或模拟者）将使用`/payloads`中的脚本生成恶意payload，并将其发送到`/app`中运行的脆弱应用程序，从而触发RCE，并在Wazuh中观察到相应的警报。

**投毒风险分析:**
该POC存储库的投毒风险极低（5%）。其作者明确声明其角色为“Aspiring SOC Analyst | Blue Team Enthusiast”，并且项目的核心目标是进行“Detection Engineering”和“Simulation”以理解漏洞。项目的结构清晰，将易受攻击的应用程序源代码、payload生成脚本和Wazuh检测规则分别存放。

1.  **意图明确**：项目描述和作者背景都清晰地表明这是一个用于防御性安全研究和教育的合法工具，旨在帮助安全专业人员保护系统，而非发起攻击。
2.  **代码透明**：存储库中的代码（如`/app`和`/payloads`）是公开且可审查的。`node-serialize`的使用是在`/app`中为了模拟漏洞，而不是在POC本身中引入恶意依赖。
3.  **无混淆/外部脚本**：没有迹象表明存在代码混淆、链接到外部恶意脚本或其他可疑行为。Payloads是为了模拟攻击行为而生成，但它们本身并非POC的恶意组件。
4.  **操作风险**：主要的风险在于用户错误地将`/app`中的易受攻击代码部署到生产环境，或者不慎将`/payloads`中的攻击脚本用于未经授权的目标。然而，对于其预期的学习和检测目的，该POC是安全的。

总结来说，这个POC是一个宝贵的蓝队资源，对于理解CVE-2025-55182的利用方式、开发和测试防御策略具有非常高的价值，而其自身带来的投毒风险微乎其微。

**项目地址:** 

**漏洞详情:** 
