## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 6.0.0-6.2.20, 7.0.0-7.2.11, 7.4.0-7.4.6, 8.0.0-8.0.4, 8.2.0-8.2.2

**利用条件:** 需要通过身份验证（即使是低权限用户）并拥有执行Lua脚本的权限（如EVAL命令）。

**POC 可用性:** 7/10

**POC 类型:** 概念验证/版本检测

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：提供的POC代码主要是一个针对CVE-2025-49844的漏洞检测脚本。其核心逻辑是通过Redis官方及各大安全平台披露的版本号进行比对，而非执行具有破坏性的UAF Exploit。该脚本使用了Python的redis库和packaging库，逻辑清晰。脚本首先尝试连接目标Redis实例，获取其INFO信息中的redis_version字段，随后将其与预设的受影响版本范围（如6.x、7.x、8.x等特定区间）进行匹配。这种基于版本的检测方式有效性极高且风险极低，适用于大规模资产排查。利用步骤：1. 准备Python环境并安装redis与packaging依赖包；2. 使用具有基础权限的凭据连接目标Redis服务器；3. 执行脚本，脚本将发送PING命令确认连接，随后调用INFO命令获取版本；4. 脚本对比硬编码的漏洞版本区间，输出是否存在风险。该漏洞本质上是Lua解释器在处理特定脚本逻辑时，对内存对象的引用计数管理不当，导致释放后重用（Use-After-Free）。攻击者通过构造特殊的Lua脚本，可以在Lua环境中触发出界写或控制流劫持，最终在Redis进程上下文中执行任意系统命令。由于Redis通常以高权限运行，此漏洞可直接导致主机失陷。投毒风险分析：该POC代码的投毒风险评级为低（15%）。分析其源码，代码逻辑透明，使用了标准的Python库，未发现混淆代码、Base64加密的恶意payload或不寻常的网络外连请求。脚本中包含作者署名‘Malik Fomin’，且声明仅用于授权渗透测试。虽然该脚本本身是安全的，但在实际威胁情报工作中，研究人员需警惕以此CVE命名的其他压缩包或一键化利用工具。由于该漏洞CVSS评分高达10.0，极易吸引攻击者发布带有后门的假POC。本POC中仅需注意库依赖安装过程，建议在隔离的沙箱环境中使用pip安装依赖。总结：该漏洞威胁等级极高，建议所有相关组织立即对照受影响版本列表进行升级，将Redis更新至安全版本（如8.2.3或更高版本，具体视分支而定）。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844-Scanner](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844-Scanner)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
