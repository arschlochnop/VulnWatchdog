## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** 6.0.0-6.2.19, 7.0.0-7.2.10, 7.4.0-7.4.5, 8.0.0-8.0.3, 8.2.0-8.2.1

**利用条件:** 需要对Redis服务器拥有基本的Lua执行权限（通常需要认证），且网络可达

**POC 可用性:** 8/10

**POC 类型:** 概念验证(检测工具)

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：提供的代码为一个基于Python编写的漏洞扫描工具（RediShell Vulnerability Scanner）。该工具的有效性主要体现在其版本检测逻辑和潜在的无损扫描机制。代码引入了packaging.version模块，对Redis实例的版本进行了细致的区间匹配，覆盖了从6.x到8.x的多个主要版本分支。通过检测redis_info中的redis_version字段，工具能快速定位潜在受影响的目标。由于代码截断，虽未见完整的溢出或触发UAF的Payload注入部分，但从其设计模式看，它倾向于利用Lua脚本环境的内存布局特性。在实际防御研究中，此类扫描器的准确度取决于其模拟触发路径的能力而不实际崩溃服务。利用步骤：1. 准备Python环境并安装redis与packaging库。2. 获取目标Redis服务器的IP地址、端口（默认6379）以及必要的访问密码。3. 执行脚本连接目标，通过INFO命令检索版本号。4. 脚本对比内置的受影响版本清单，判断是否存在CVE-2025-49844风险。5. 若发现版本符合，脚本可能进一步发送特制的只读Lua脚本进行指纹确认。投毒风险分析：该POC代码结构清晰，使用了标准的redis-py库，没有明显的混淆手段或非必要的外部域名请求。投毒风险极低，其风险主要来源于用户在未对脚本进行全面审计的情况下，从第三方仓库下载并赋予高权限执行。代码中定义了Malik Fomin作为作者，并明确标注仅用于授权渗透测试。分析过程中未发现恶意删库（FLUSHALL）、反弹Shell等后门行为。然而，威胁情报团队需注意，在复杂的利用场景下，此类检测工具若被恶意篡改，可在输出漏扫结果的同时，将获取到的Redis认证凭据通过socket隐蔽通道外传。目前的脚本仅依赖标准库和公认的第三方库，投毒概率估计为15%，主要防范方向应在于供应链安全，即确保脚本来源的真实性。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-49844-RediShell](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-49844-RediShell)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
