## CVE-2025-59287 - Microsoft Windows Server Update Services (WSUS) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows Server Update Services (WSUS)

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** Windows Server 2012, Windows Server 2012 R2, Windows Server 2016, Windows Server 2019, Windows Server 2022, Windows Server 2025

**利用条件:** 无需认证，远程网络访问

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (检测/验证脚本)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-59287是一个严重的高危远程代码执行（RCE）漏洞，CVSS评分为9.8分（满分10分），影响Microsoft Windows Server Update Services（WSUS）。该漏洞的根本原因在于WSUS在处理AuthorizationCookie时存在不安全的反序列化缺陷，利用了.NET的BinaryFormatter。未经身份验证的远程攻击者可以通过发送特制的事件，触发传统序列化机制中不安全的对象反序列化，从而导致目标服务器上的远程代码执行，最终实现对服务器的完全控制。该漏洞的利用无需获取任何身份凭证。

受影响的Windows Server版本包括：Windows Server 2012、Windows Server 2012 R2、Windows Server 2016、Windows Server 2019、Windows Server 2022以及Windows Server 2025。

该漏洞的利用条件为低复杂度。攻击者无需进行身份验证，只需通过网络远程发送精心构造的请求即可触发。典型的利用步骤可能包括：首先，攻击者需要识别目标网络中运行的WSUS服务器。其次，利用如ysoserial.net等工具生成恶意的反序列化Payload。随后，将此Payload嵌入到特制的HTTP请求中，例如作为AuthorizationCookie或其他WSUS组件中易受攻击的反序列化点的一部分。最后，将构造好的恶意请求发送给目标WSUS服务器。当WSUS服务器尝试反序列化此恶意对象时，将执行攻击者提供的任意代码，通常以WSUS服务账户的权限运行。

POC有效性分析：
提供的PowerShell脚本 `CVE-2025-59287.ps1` 并非一个主动的漏洞利用脚本，而是一个**用于验证系统是否已打补丁或是否仍然脆弱的审计工具**。脚本的宗旨和描述明确指出其目的是进行“CRÍTICA验证”WSUS角色以及针对CVE-2025-59287 RCE漏洞的OOB（带外）缓解补丁。该脚本首先通过WMI（Get-WmiObject）获取目标服务器的操作系统版本信息，无论是本地执行还是远程审计。然后，它通过一个`switch -Wildcard`语句将检测到的操作系统版本映射到针对CVE-2025-59287的正确缓解补丁KB（Knowledge Base）编号，例如，为Windows Server 2022映射到KB5070884。接着，脚本会检查目标服务器是否安装了WSUS角色。如果WSUS角色存在，它将进一步检查对应版本的关键KB补丁是否存在于系统上。如果WSUS角色已安装但关键补丁缺失，脚本将报告该服务器“VULNERABLE”（易受攻击）。

该脚本在识别易受攻击系统方面具有很高的有效性。它设计良好，注释清晰，兼容PowerShell 5.1，这使其能够在广泛的Windows Server环境中运行。通过检查补丁的缺失来推断漏洞的存在，该脚本为防御者提供了一个关键工具来评估其组织的WSUS服务器对CVE-2025-59287的暴露程度。虽然它不演示实际的RCE利用过程，但它直接确认了系统是否处于可被利用的状态，因此对于威胁情报和防御措施而言，它是一个高质量且实用的概念验证脚本。

投毒风险分析：
`CVE-2025-59287.ps1` 脚本的投毒风险评估为**非常低（约5%）**。该脚本的代码逻辑清晰、可读性强，完全由标准的PowerShell命令（如`Get-WmiObject`、`Write-Host`、`Get-ItemProperty`等）构成。在对脚本内容的分析中，未发现任何代码混淆、恶意外部链接调用（除了通过WinRM进行远程服务器审计，这是PowerShell脚本的合法功能）、可疑的文件系统操作或未经授权的系统修改尝试。脚本不包含任何`eval`语句或其他动态代码执行机制，也没有迹象表明它会下载并执行任意的外部代码。其唯一的功能是安全地收集系统信息（如操作系统版本、已安装的角色和补丁信息），并基于这些数据报告目标服务器对特定CVE的脆弱状态。所有变量和函数均命名规范，逻辑流程易于理解。因此，该脚本被设计用于防御性审计目的，不会对用户的系统或数据构成内在的“投毒”威胁。尽管如此，作为最佳安全实践，任何管理员在执行第三方脚本之前都应进行代码审查。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
