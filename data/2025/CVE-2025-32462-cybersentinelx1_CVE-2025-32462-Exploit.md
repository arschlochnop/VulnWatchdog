## CVE-2025-32462 - Sudo 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 本地用户访问权限，且sudoers配置文件中使用了基于主机名的限制策略（非ALL且非当前主机名）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码（matrix-sudo-escape.sh）针对CVE-2025-32462漏洞提供了极高完整性的验证逻辑。技术核心在于利用Sudo在1.9.17版本之前对`-h`（host）参数的处理缺陷。在特定的sudoers配置中，管理员可能允许用户在特定主机（如zion-core）上以root身份执行命令。漏洞产生的原因是Sudo未能正确校验当前物理主机与`-h`指定的远程主机之间的逻辑隔离，导致本地用户可以通过伪造目标主机名参数来绕过本机的权限限制。POC脚本首先通过`sudo --version`进行版本检测，确认版本低于1.9.17后，模拟创建受限用户环境，随后演示如何通过执行`sudo -h [白名单主机] [命令]`获取root权限。代码逻辑清晰，使用了标准的Shell语法，不含混淆内容，能够准确触发漏洞逻辑，对于防御性研究具有极高的参考价值。利用步骤如下：1. 确认系统Sudo版本；2. 在sudoers中存在非ALL的主机别名配置；3. 运行POC脚本或手动执行带-h参数的sudo命令；4. 成功越权切换至uid=0。该漏洞在多主机共享LDAP/sudoers配置的环境中危害极大，可导致受限用户在任意节点实现完全提权。【投毒风险分析】经过深入的代码审计，该POC项目的投毒风险处于低水平（约15%）。主要的风险点在于其脚本执行需要高权限环境来配置测试用户和sudoers规则，这在不受控的环境下可能被恶意利用。然而，代码本身并未发现任何形式的恶意混淆、未授权的反弹Shell请求、敏感文件（如/etc/shadow）的静默外传或二进制后门植入。脚本中虽包含`set -euo pipefail`等严谨的Shell编写规范，但其核心逻辑完全透明，注释详尽，符合安全研究工具的特征。脚本提到的‘Matrix’主题仅为UI美化，不影响安全性。唯一需要警惕的是其提供的GitHub地址（cybersentinelx1），在实际部署防御措施前，研究人员应始终通过哈希校验或在沙箱中运行此类交互式脚本。总体而言，该代码是合法的漏洞验证程序，未发现针对研究人员主机的恶意攻击载荷。

**项目地址:** [https://github.com/cybersentinelx1/CVE-2025-32462-Exploit.git](https://github.com/cybersentinelx1/CVE-2025-32462-Exploit.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
