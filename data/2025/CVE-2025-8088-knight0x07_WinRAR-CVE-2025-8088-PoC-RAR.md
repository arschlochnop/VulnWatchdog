## CVE-2025-8088 - WinRAR 路径遍历/目录穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** WinRAR <= 7.12

**利用条件:** 需要用户交互（解压恶意压缩文件），可被远程未经身份鉴别的攻击者通过钓鱼攻击利用

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

POC有效性分析：
提供的POC，通过其`README.md`文件（标题为“WinRAR-CVE-2025-8088-PoC-RAR”）详细描述了WinRAR软件中一个严重的路径遍历漏洞（CVE-2025-8088）的利用方式。此漏洞影响WinRAR 7.12及更早版本。该POC的核心机制在于巧妙地结合Windows NTFS备用数据流（ADS）特性和路径遍历技术，来绕过WinRAR的文件验证机制。这允许攻击者在用户解压特制压缩文件时，将恶意文件释放到目标系统预期的解压路径之外的任意位置，甚至是系统关键目录。
具体而言，POC指导用户将一个名为`My_Resume_final.rar`的特制压缩包放置到`Downloads`目录，并通过WinRAR的“Extract to My_Resume_final”选项进行解压。一旦解压完成，一个VBScript文件`WindowsConfigurationFileRun1.vbs`将被成功放置到Windows的`Startup`目录。该VBScript是一个无害的负载，其功能是在系统重启后弹出一个消息框，显示“Exploit Successful: WinRAR CVE-2025-8088”，以此明确地验证了路径遍历漏洞的成功利用以及任意文件写入的能力。该POC的描述清晰，步骤明确，通过在关键系统目录中植入受控文件（即使是无害的），充分证明了漏洞的真实性和高危性，为安全研究和防御提供了可靠的验证依据。

利用步骤：
1.  **获取恶意压缩包**：攻击者首先需要制作一个特制的RAR压缩包（例如POC中提到的`My_Resume_final.rar`），该压缩包内部包含利用NTFS ADS和路径遍历技术隐藏的恶意文件（在本POC中是`WindowsConfigurationFileRun1.vbs`）。
2.  **分发与诱导**：攻击者通过钓鱼邮件或其他社会工程学手段，将恶意压缩包分发给受害者，并诱导受害者下载并尝试解压。
3.  **用户交互触发**：受害者将压缩包放置于其本地目录（例如`Downloads`），并使用受影响的WinRAR版本（<=7.12）进行解压。POC指定使用“Extract to My_Resume_final”等特定解压选项。
4.  **恶意文件释放**：在解压过程中，由于漏洞，WinRAR未能正确处理路径，导致恶意VBScript文件`WindowsConfigurationFileRun1.vbs`被写入到Windows的`Startup`目录（例如`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
5.  **权限维持/代码执行**：在系统重启后，Windows会自动执行`Startup`目录下的VBScript文件。在POC场景下，会弹出一个显示“Exploit Successful: WinRAR CVE-2025-8088”的消息框，从而证明漏洞利用成功。在实际攻击中，此处将是恶意负载的执行点。

投毒风险分析：
根据提供的POC `README.md`内容，本概念验证代码本身被投毒的风险评估为**非常低 (5%)**。
风险评估依据：
1.  **代码透明度**：`README.md`文件清晰地描述了POC的机制、预期的有效载荷（一个弹出消息框的VBScript）以及利用步骤。没有迹象表明存在代码混淆、复杂的外部依赖或隐藏的恶意功能。
2.  **负载性质**：POC中描述的最终有效载荷是一个简单的VBScript，其唯一功能是显示一个消息框，明确告知漏洞利用成功。这是一种典型的无害化验证方式，旨在证明漏洞的存在，而非造成实际损害。它不包含任何试图窃取数据、安装后门、进行网络通信或破坏系统的指令。
3.  **无外部引用**：`README.md`中未提及POC代码会从外部URL下载任何文件或执行未知脚本。POC的整个流程似乎是自包含的，仅依赖于本地文件系统操作。
潜在风险与误区：需要明确区分POC代码自身的投毒风险与该漏洞被攻击者利用后的高风险。此POC旨在**展示**一个高危漏洞，而这个漏洞本身具有极高的利用价值和危害性。一旦攻击者利用此漏洞，他们可以将任何恶意文件（如勒索软件、远控木马、信息窃取器等）通过相同的路径遍历机制写入到系统关键目录，从而实现持久化控制或即时危害。因此，尽管此POC作为研究工具的投毒风险低，但它所代表的**漏洞在野利用的风险极高**。组织在进行安全测试时，应始终在隔离环境中操作，并保持对任何不明来源代码的警惕。
防御建议：鉴于该漏洞的严重性和易于武器化的特性，组织应立即采取措施。首先，**升级WinRAR至7.13或更高版本**是首要的缓解措施。其次，提高员工的安全意识，警惕不明来源的压缩文件，尤其是在解压前务必仔细检查文件内容和来源。在安全防护层面，终端检测与响应 (EDR) 和杀毒软件应配置为检测异常的文件写入行为，特别是对Startup等敏感目录的非预期写入操作，以及对NTFS ADS的异常使用。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
