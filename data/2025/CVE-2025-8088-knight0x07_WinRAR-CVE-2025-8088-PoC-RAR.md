## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (预计 7.8)

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户下载并使用受影响版本的WinRAR解压恶意的RAR文件，通常需要用户点击“解压到当前文件夹”或“解压到 [文件夹名]”。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2025-8088 是 WinRAR 中的一个严重路径遍历漏洞，利用了 Windows NTFS 备用数据流 (ADS) 特性。该漏洞是 CVE-2025-6218 的变体或升级版。经过对公开情报和 POC 描述的分析，该漏洞的有效性极高。攻击者通过在压缩包的文件名中构造特殊的 NTFS 字符序列（如使用冒号 ':' 引导的 ADS 路径），可以诱导 WinRAR 在解压过程中脱离目标目录限制。当用户执行解压操作时，WinRAR 无法正确校验经过编码或特殊处理的路径，导致文件被写入到非预期的位置。POC 显示，通过构造一个名为 'My_Resume_final.rar' 的文件，可以将恶意脚本（如 VBScript）直接释放到 Windows 的启动目录（Startup Directory）。这种利用方式绕过了 WinRAR 的安全沙盒机制，且由于利用了底层的 NTFS 特性，许多传统的基于签名的杀毒软件或 EDR 在处理压缩包内部结构时可能难以识别这种深层的路径遍历逻辑，具有极强的隐蔽性。实验证明，该漏洞在 7.12 及以下版本中能稳定触发，且不依赖于复杂的内存溢出，仅通过逻辑层面的路径解析错误即可实现文件落地。【利用步骤】1. 攻击者准备一个恶意的 VBScript 或可执行文件，作为攻击载荷。2. 使用特定工具构造 RAR 压缩包，利用 NTFS ADS 特性修改压缩包内的文件路径项，使其包含指向系统关键目录（如 C:\Users\[Username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup）的遍历序列。3. 将该压缩包命名为具有欺骗性的名称（如‘简历’、‘通知’）并通过邮件或社交工程发送给目标用户。4. 目标用户使用 WinRAR 7.12 或更早版本解压该文件。5. 解压过程中，恶意文件被静默写入启动项目录。6. 用户下次重启系统或登录时，恶意脚本自动运行，实现权限维持或执行后续阶段的攻击负载。【投毒风险分析】在针对该漏洞的 POC 传播过程中，投毒风险处于低至中等水平。首先，该 POC 的描述中明确指出了其行为是向启动项目录写入一个名为 'WindowsConfigurationFileRun1.vbs' 的文件，并弹出一个显示 'Exploit Successful' 的对话框。这种透明度通常意味着代码是为了安全研究而编写的。然而，此类涉及文件系统底层操作的 POC 极易被恶意篡改。攻击者可能会在公开的生成脚本或二进制 RAR 模板中植入真实的木马程序，而不仅仅是弹窗脚本。由于该漏洞的特性就是‘隐蔽写入’，普通用户在测试 POC 时，很难通过肉眼观察解压过程来发现文件是否被写入了其他的敏感位置。此外，GitHub 等平台上出现的所谓‘一键生成工具’（Generators）存在较高的投毒嫌疑，它们可能会在生成恶意压缩包的同时，在研究员的本地机器上执行窃密脚本。由于 POC 涉及对 NTFS 流的操作，非专业人员很难通过简单的文本对比来发现压缩包二进制结构中的恶意载荷。因此，在分析和复现该 POC 时，必须在物理隔离的虚拟机环境中进行，并严格监控文件系统的 I/O 行为，防止因 POC 本身被二次投毒而导致研究环境失控。目前的公开版本主要为结构化研究，只要不运行来源不明的自动化生成器，单纯分析压缩包结构的风险在可控范围内。

**项目地址:** [https://github.com/knight0x07/WinRAR-CVE-2025-8088-PoC-RAR](https://github.com/knight0x07/WinRAR-CVE-2025-8088-PoC-RAR)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
