## CVE-2025-8088 - WinRAR 路径遍历/目录穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高 (High)

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者需要使用存在漏洞的WinRAR版本打开并解压攻击者构造的特制RAR压缩包，通常需要诱导用户点击“解压到当前文件夹”或特定的解压选项。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-8088）是WinRAR在处理压缩文件内嵌路径时存在的一个严重路径遍历缺陷。根据披露的信息和POC说明，其有效性非常高。该漏洞允许攻击者绕过预期的解压目标目录限制。在正常的解压流程中，软件应当将文件约束在用户指定的输出目录下，但受影响的WinRAR版本（7.12及以下）会错误地处理压缩包内精心构造的相对路径（如使用'../'或特定的绝对路径序列）。POC展示了一个名为'My_Resume_final.rar'的压缩包，当用户尝试解压时，它并不仅仅在当前目录释放文件，而是通过路径穿越技术将一个名为'WindowsConfigurationFileRun1.vbs'的脚本直接写入系统的启动（Startup）文件夹中。这意味着一旦文件释放成功，在下一次系统重启时，恶意脚本将自动执行，从而实现从文件解压到任意代码执行（RCE）的跨越。这种利用方式在社会工程学攻击中极具威胁，因为用户通常认为解压简历等文档是安全的操作。利用步骤如下：1. 攻击者使用利用脚本（如poc.py）生成包含路径穿越向量的RAR文件。2. 攻击者将此压缩包伪装成合法文件（如简历、补丁）发送给目标。3. 目标用户使用WinRAR 7.12或更早版本打开压缩包并选择解压。4. 漏洞触发，WinRAR忽略用户选定的目标路径，根据压缩包内部定义的路径将文件写入系统关键位置（如启动项或系统目录）。5. 恶意脚本在下次登录或系统启动时触发执行。【投毒风险分析】针对该POC的投毒风险评估为15%，属于低风险范畴。分析其代码结构，该POC属于典型的防御性研究展示。开发者'knight0x07'明确说明了其行为是释放一个名为'WindowsConfigurationFileRun1.vbs'的文件并弹出'Exploit Successful'的消息框，这属于标准的非破坏性POC验证手段，其目的在于证明漏洞的存在及其导致的目录穿越后果，而非执行真正的恶意载荷（Payload）。代码库中虽然包含了利用脚本和生成的RAR文件，但其逻辑透明，没有发现混淆代码、隐藏的远程下载器或针对安全研究员本人的后门指令。然而，需要警惕的是，由于该漏洞利用门槛极低且效果显著，网络上的恶意行为者可能会克隆此类POC并将其中的VBS脚本替换为真正的远控木马或勒索病毒。目前的15%风险主要来自于POC被恶意篡改后的二次传播，而非原始代码本身的恶意性。对于研究人员而言，直接运行来自非受信任源生成的RAR包仍需在隔离虚拟环境中进行，以防解压路径被修改为其他敏感系统目录造成环境损坏。

**项目地址:** [https://github.com/knight0x07/WinRAR-CVE-2025-8088-PoC-RAR](https://github.com/knight0x07/WinRAR-CVE-2025-8088-PoC-RAR)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
