## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本范围待定

**利用条件:** 克隆包含恶意子模块的存储库

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-48384 允许攻击者通过创建包含恶意子模块的 Git 仓库来执行任意文件写入。当用户克隆该仓库时，Git 会尝试初始化和更新子模块。恶意仓库通过`.gitmodules` 文件中的精心构造的配置，可以控制子模块的克隆方式，从而导致在用户系统上写入任意文件。根据搜索结果，该漏洞存在于 Git 的子模块处理逻辑中。PoC 代码通过创建一个包含恶意的 `.gitmodules` 文件的 Git 仓库来演示该漏洞。当用户克隆该仓库时，`post-checkout` 脚本会被触发，该脚本会尝试在 `/tmp` 目录下创建一个文件 `asp-was-here-cve-2025-48384`，以此证明漏洞利用成功。利用步骤如下：1. 创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件包含指向恶意仓库的子模块的 URL，以及执行任意文件写入所需的配置。2. 将恶意仓库上传到公共 Git 托管服务（例如 GitHub）。3. 诱使用户克隆恶意仓库。当用户执行 `git clone` 命令时，Git 会自动初始化和更新子模块。4. Git 执行 `.gitmodules` 文件中指定的命令，导致在用户系统上写入任意文件。

**POC有效性分析：** PoC 代码的有效性通过创建一个简单的 `post-checkout` 脚本来验证。该脚本尝试在 `/tmp` 目录下创建一个文件。如果文件创建成功，则表示漏洞利用成功。从搜索结果来看，多个来源证实了该漏洞的存在以及利用的可能性。GitHub 上存在公开的 PoC 代码，进一步证明了该漏洞的可利用性。一些安全厂商也发布了关于该漏洞的分析报告，表明该漏洞具有实际的威胁。该漏洞的修复需要更新 Git 到修复版本。

**投毒风险分析：** 该漏洞的投毒风险较低。虽然攻击者可以利用该漏洞在用户系统上写入任意文件，但写入的文件内容受到攻击者的控制。攻击者可以利用该漏洞来安装恶意软件或修改系统配置，但这种攻击需要用户执行额外的步骤。由于POC代码相对清晰，主要功能是创建文件，并未发现任何可疑的混淆或恶意行为，因此投毒风险较低。主要的风险在于，如果攻击者控制了目标机器，他们可以修改 `.git/config` 文件或设置环境变量，从而导致在克隆其他仓库时触发恶意行为。尽管存在潜在的风险，但攻击者需要具备较高的技术水平才能成功实施投毒攻击。PoC 代码主要使用标准的 shell 命令，例如 `touch`，没有发现任何可疑的系统调用或外部脚本。总体而言，该漏洞的投毒风险较低，但需要采取适当的措施来降低风险。建议用户验证克隆仓库的来源，避免克隆来自不受信任的来源的仓库，并及时更新 Git 到最新版本。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** 待定
