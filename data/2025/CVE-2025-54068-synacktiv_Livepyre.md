## CVE-2025-54068 - Laravel Livewire RCE (远程命令执行)

**漏洞编号:** CVE-2025-54068

**漏洞类型:** RCE (远程命令执行)

**影响应用:** Laravel Livewire

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Livewire v3.x <= v3.6.3

**利用条件:** 无需认证，远程网络访问，且目标应用使用了受影响的Livewire组件属性更新机制（若已知APP_KEY则可100%利用，未知时取决于具体组件实现）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC（Livepyre.py）是一个针对Laravel Livewire框架特定版本中存在的反序列化或属性水合（Hydration）漏洞的完整利用工具。通过分析提供的代码结构，该工具被模块化为两种攻击模式：ExploitWithAppKey和ExploitWithoutAppKey。在Livewire v3中，组件的状态通过快照（Snapshot）在前后端传递。漏洞的核心在于受影响版本在处理这些更新时，未能对不安全的属性更新进行充分校验。POC的有效性极高，因为它模拟了Livewire合法的通信协议，通过精心构造的JSON载荷触发后端组件的属性更新逻辑。代码中包含了详细的参数处理（如-f指定函数，-p指定参数），默认利用PHP的system函数执行id命令，这在安全研究中是标准的非破坏性验证方式。通过可选的APP_KEY参数，攻击者可以对快照进行合法签名，绕过框架的完整性校验，从而在服务器上执行任意系统命令。即使在没有APP_KEY的情况下，工具也提供了探测（--check）和暴力尝试功能，这表明该漏洞在特定配置下即使没有密钥也存在被触发的可能。整体代码逻辑严密，导入了专门的exploit模块，是一个工业级的漏洞验证工具。【利用步骤】1. 环境准备：攻击者需安装Python 3环境，并确保安装了requests等依赖库。2. 目标探测：使用`./Livepyre.py -u <目标URL> --check`命令检查目标是否存在CVE-2025-54068漏洞。3. 基础利用：若已知目标的Laravel APP_KEY，执行`./Livepyre.py -u <目标URL> -a <APP_KEY> -f system -p 'whoami'`。此命令会利用密钥对恶意快照签名，使后端信任并执行payload。4. 盲打利用：在未知密钥的情况下，使用`./Livepyre.py -u <目标URL>`进行攻击，工具将尝试利用无需签名的组件属性水合缺陷。5. 进阶操作：通过-H参数注入自定义Header（如User-Agent或Cookie）以绕过简单的WAF规则，或通过-P设置代理隐藏攻击来源。【投毒风险分析】经过对代码逻辑的详细审计，该POC目前表现为较低的投毒风险。代码编写风格清晰，遵循标准的Python命令行工具开发规范，使用了argparse处理参数，且导入的库（如warnings, argparse）均为Python标准库。其核心利用逻辑封装在exploit文件夹下的模块中，从现有代码片段看，并未发现明显的代码混淆、远程Shellcode下载、或针对研究者环境的破坏性行为（如删除本地文件或窃取本机的环境变量/SSH密钥）。尽管该工具具有极强的攻击性，但其目的是为了安全检测。需要注意的是，此类高度自动化的利用脚本在传播过程中，如果不法分子在exploit/exploit_appkey.py等子模块中植入恶意的eval()函数或隐藏的socket回连代码，则可能演变为投毒工具。目前的分析仅基于主入口脚本及已知元数据，在实际使用前，建议在隔离的沙盒环境或虚拟机中运行，并监控其外发流量。代码中的'-d'（调试模式）允许用户观察生成的Payload，这增加了透明度。总体而言，该代码作为威胁情报来源是可信的，其主要的风险在于其强大的RCE能力可能被初级攻击者（Script Kiddies）直接利用，而非代码本身包含恶意后门。

**项目地址:** [https://github.com/remsio/Livepyre](https://www.google.com/search?q=https://github.com/remsio/Livepyre)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54068](https://nvd.nist.gov/vuln/detail/CVE-2025-54068)
