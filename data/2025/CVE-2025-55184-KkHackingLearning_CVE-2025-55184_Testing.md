## CVE-2025-55184 - React Server Components 反序列化拒绝服务 (DoS)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 反序列化拒绝服务 (DoS)

**影响应用:** React Server Components

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H (估算)

**影响版本:** React 19.x 系列，包括但不限于早于 19.0.2, 19.1.3, 19.2.2 的版本

**利用条件:** 需要网络访问，无需认证

**POC 可用性:** 9/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析:
`KK_CVE_2025-55184_Testing.py` 脚本是一个功能强大且结构良好的PoC扫描器，用于检测React Server Components (RSC) 反序列化缺陷导致的CVE-2025-55184拒绝服务 (DoS) 漏洞。该脚本利用Python的`requests`库进行HTTP通信，`json`库构建攻击载荷，以及`argparse`处理命令行参数，保证了其可靠性和易用性。其采用的面向对象设计（`CVE202555184Scanner`类）封装了日志、URL处理、RSC端点识别和核心漏洞检测逻辑，代码可读性强。

PoC的核心在于`check_vulnerability`方法。它精心构造并发送HTTP POST请求，包含`RSC: 1`、`Content-Type: text/x-component`和`Accept: text/x-component`等RSC处理所需的关键头信息。攻击载荷为特意畸形的RSC数据，例如简单的`"J0"`或复杂的`["J0",{"id":0,"name":"react-server-dom-webpack/client"}]` JSON数组。当受影响的React Server Component尝试反序列化这些畸形载荷时，会触发无限解析循环，导致服务器CPU资源耗尽。

脚本通过监控服务器响应来确认漏洞存在。它主要检查HTTP 500错误码，更重要的是，会测量响应时间。如果响应时间显著超过预设的`CPU_EXHAUSTION_THRESHOLD`（如5秒），则强烈表明服务器CPU正在被大量消耗，与DoS症状一致。为提高准确性，扫描器会尝试多种载荷并进行重试。彩色的日志输出提供了实时的扫描状态、识别的RSC端点和漏洞验证结果，使其成为一个高效、可靠的内部安全验证工具。

利用步骤:
1.  **环境准备**: 确保系统已安装 Python 3 和 `requests` 库（通过 `pip install requests` 安装）。
2.  **获取PoC脚本**: 下载 `KK_CVE_2025-55184_Testing.py` 脚本到本地。
3.  **运行脚本**: 在终端中执行以下命令：
    ```bash
    python3 KK_CVE_2025-55184_Testing.py -t <TARGET_URL> [-o <OUTPUT_FILE>] [-v] [--timeout <SECONDS>]
    ```
    将 `<TARGET_URL>` 替换为目标 React Server Components 应用程序的基URL（例如 `http://example.com`）。可选参数包括 `-o` 保存结果、`-v` 详细模式、`--timeout` 设置请求超时。
4.  **观察结果**: 如果目标系统存在漏洞，脚本将发送恶意RSC负载，并输出 `[SUCCESS]` 消息，指示检测到CPU耗尽，响应时间显著延长，或目标应用程序可能返回HTTP 500错误、响应迟缓甚至无响应。
5.  **验证DoS影响**: 脚本报告成功后，尝试访问目标应用程序的其他功能。若应用程序响应迟钝、报错或完全不可用，则确认DoS攻击成功。

投毒风险分析:
对 `KK_CVE_2025-55184_Testing.py` PoC 代码的审查表明，其投毒风险为**低 (10%)**。
首先，代码结构高度透明，无任何混淆、加密或试图掩盖意图的代码段。所有功能均基于Python标准库及广受信赖的`requests`库，未引入或执行外部未知脚本或二进制文件，使得代码可被安全审计。

其次，脚本的网络通信行为严格限定在其声明的目标。它仅连接用户通过 `-t` 参数指定的URL，未发现任何尝试连接恶意IP、域名、数据回传、C2通信或其他可疑网络活动。所有请求均围绕向目标发送特制的RSC负载以触发漏洞。

再者，代码中没有滥用 `eval()`、`exec()` 等动态执行代码的函数，也未对用户输入进行不安全处理以执行系统命令。攻击负载硬编码在脚本内部，旨在利用React Server Components的反序列化逻辑缺陷引发无限循环和CPU耗尽，而非操作系统级别的任意代码执行。

最后，脚本内明确包含了“Safe, Authorized Security Validation Tool”和“Internal testing use only – authorization required”等警示信息，强烈表明其设计目的为合法安全测试。综合来看，该PoC是一个专注于漏洞检测的工具，行为透明，依赖安全，未发现恶意载荷、后门或信息窃取功能。因此，评估为低投毒风险。

**项目地址:** N/A (本地文件)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
