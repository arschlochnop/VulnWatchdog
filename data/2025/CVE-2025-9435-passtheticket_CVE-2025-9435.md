## CVE-2025-9435 - ManageEngine ADManager Plus 权限提升 (Elevation of Privilege)

**漏洞编号:** CVE-2025-9435

**漏洞类型:** 权限提升 (Elevation of Privilege)

**影响应用:** ManageEngine ADManager Plus

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Build < 7230

**利用条件:** 需要低权限技术员账户凭据，且该账户拥有“修改用户通用属性”角色，并具备登录ADManager所在服务器的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析：该POC详细说明了ManageEngine ADManager Plus中存在的一个路径遍历和权限配置不当漏洞。有效性极高，因为它利用了Web应用在处理“Home folder”路径设置时的逻辑缺陷。由于应用程序未对用户输入的路径进行严格校验和规范化，攻击者可以注入具有特殊意义的目录路径（如Java运行环境的库目录）。该漏洞的核心在于Web应用后端在创建目录时，赋予了当前操作用户对该新建目录的“完全控制”权限，即便该目录位于系统级受限路径下。POC通过在BurpSuite中截获并修改请求参数，强制系统在JRE搜索路径下创建一个名为'amd64'的子目录。因为该目录是由用户通过漏洞创建的，用户获得了文件写入权限。当攻击者将恶意DLL（如sunmscapi.dll）放入该目录并重启服务时，ADManager使用的Java虚拟机在加载核心库前会优先检索并加载该路径下的DLL，从而实现以SYSTEM或服务账户权限执行任意代码。利用步骤：1. 以低权限技术员身份登录ADManager。2. 进入用户属性修改界面，定位至“Home folder”配置项。3. 使用BurpSuite拦截修改请求，将homeDirectory参数更改为特定的相对路径（如....\\jre\\lib\\ext\\amd64）。4. 确认目录创建成功并验证权限。5. 准备恶意DLL文件，登录服务器并将DLL复制到新创建的目录中。6. 等待或诱导管理员重启ADManager服务，DLL被加载后反弹高权限Shell。投毒风险分析：该POC主要以Markdown文档形式存在，提供了明确的逻辑说明和手动利用步骤。由于其主要内容为操作指南而非自动化的混淆二进制文件或加密脚本，因此直接的恶意代码投毒风险较低。然而，README中提到的PoC详情链接指向了外部站点（https://www.google.com/search?q=docs.unsafe-inline.com），用户在访问此类安全研究站点时应警惕潜在的浏览器端劫持或虚假POC下载包。代码层面，POC建议创建'sunmscapi.dll'以获取Shell，但也警告了'sunec.dll'可能导致服务无法启动，这显示了研究者对影响的透明披露而非故意破坏。防御者在验证时应自行编译DLL，避免从非受信任来源直接下载预编译的二进制文件。整体来看，该说明文档旨在揭示防御漏洞，代码清晰度高，无明显的后门植入或混淆行为。

**项目地址:** [https://docs.unsafe-inline.com/0day/admanager-plus-build-less-than-7230-elevation-of-privilege-vulnerability-cve-2025-9435](https://docs.unsafe-inline.com/0day/admanager-plus-build-less-than-7230-elevation-of-privilege-vulnerability-cve-2025-9435)

**漏洞详情:** [https://www.cve.org/CVERecord?id=CVE-2025-9435](https://www.cve.org/CVERecord?id=CVE-2025-9435)
