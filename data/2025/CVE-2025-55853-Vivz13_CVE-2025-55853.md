## CVE-2025-55853 - SoftVision webPDF Server-Side Request Forgery (SSRF) / Local File Inclusion (LFI)

**漏洞编号:** CVE-2025-55853

**漏洞类型:** Server-Side Request Forgery (SSRF) / Local File Inclusion (LFI)

**影响应用:** SoftVision webPDF

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** before 10.0.2

**利用条件:** 需要文件上传权限;需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-55853是一个影响SoftVision webPDF版本低于10.0.2的高危漏洞，其本质是服务器端请求伪造（SSRF），可进一步导致本地文件包含（LFI）。该漏洞的核心在于webPDF应用的PDF转换功能在处理用户上传的XML或HTML文件时，未能对其中嵌入的资源请求进行充分的验证和限制。具体而言，转换器允许使用如`http://`和`file:///`等多种协议来引用资源，这使得攻击者能够操控服务器向任意内部或外部地址发起请求，并读取本地文件。

**POC有效性分析**:
提供的POC是一个简洁的HTML文件，其核心payload为`<iframe src=file:///etc/passwd height="1000px" width="1000px"></iframe>`。当此HTML文件被上传至脆弱的webPDF应用进行PDF转换时，服务器端的PDF渲染引擎会解析`iframe`标签。由于缺乏适当的协议限制，渲染引擎会被迫读取`file:///etc/passwd`文件的内容，并将其嵌入到生成的PDF文档中。通过下载该PDF文件，攻击者可以直接查看包含系统用户信息的`/etc/passwd`文件内容，从而确凿地证明了LFI漏洞的存在和可利用性。此漏洞不仅限于`/etc/passwd`，理论上，攻击者可以读取服务器上webPDF进程拥有读权限的任何文件，如配置文件、私钥或日志文件，可能导致敏感信息泄露甚至更深层次的系统入侵。此外，该SSRF能力还允许进行内部网络端口扫描，攻击者可以通过`iframe src`指向内部IP和端口，利用webPDF服务器作为跳板探测内部网络拓扑和开放服务，绕过外部防火墙限制，为后续的横向移动和更复杂攻击铺平道路。POC的直观性和明确的payload使其验证过程简单高效，对安全团队评估自身系统风险具有极高价值。

**利用步骤**:
1.  **目标确认**: 攻击者首先识别运行SoftVision webPDF且版本低于10.0.2的目标系统，并获取文件上传权限。
2.  **构造Payload**: 创建一个恶意的HTML或XML文件。例如，为实现LFI，构造上述包含`file:///etc/passwd`的`iframe`标签的HTML文件。若需进行内部端口扫描，可将`src`指向内部IP和端口，如`http://192.168.1.1:8080`。
3.  **上传与转换**: 将构造的恶意文件通过webPDF应用的转换功能上传。
4.  **服务器执行**: webPDF服务器在转换过程中解析并执行恶意文件中的`iframe`指令，由于漏洞存在，服务器将按指令读取本地文件或发起内部网络请求。
5.  **结果获取**: 攻击者下载生成的PDF文件。如果是LFI，PDF中会直接显示被读取文件的内容。如果是端口扫描，可通过PDF生成时间、错误信息或服务器日志间接推断端口状态。
6.  **后续攻击**: 利用获取的敏感信息（如系统凭据、内部网络架构）进行进一步的提权、横向移动或远程代码执行。

**投毒风险分析**:
本次分析的POC代码是一个清晰且自包含的HTML片段，其核心目的是演示SSRF与LFI漏洞，通过`file:///etc/passwd`路径明确指示其文件读取行为。该POC不包含任何代码混淆、外部脚本引用、动态代码执行（如`eval()`）、C2通信或任何尝试写入/修改文件系统的指令。代码逻辑透明，行为可预测，完全符合其作为概念验证的初衷。因此，该POC的投毒风险被评估为**0%**。这意味着它是一个高度安全、可信赖的测试工具，可供防御性安全团队放心地用于验证和测试系统对CVE-2025-55853的脆弱性，而无需担心其本身会引入任何恶意载荷。

**缓解措施**:
*   将webPDF软件更新至10.0.2或更高版本。
*   限制PDF转换器可用的协议，只允许HTTP和HTTPS，并采用白名单机制。
*   通过解析域名并阻止请求流向内部网络段，限制对内部网络的请求。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55853
