## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 and older EOL versions

**利用条件:** Unauthenticated network access

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2025-24813是Apache Tomcat中的一个关键安全漏洞，允许攻击者利用不当处理的partial PUT请求执行远程代码。该漏洞源于Tomcat允许通过PUT方法上传文件，如果PUT方法未被禁用且配置不当，攻击者可以上传包含恶意代码的JSP文件（例如webshell）。

POC代码的有效性分析：提供的POC代码包含完整的利用链，包括Docker环境的搭建、恶意JSP文件的上传和执行。通过构建包含漏洞的Tomcat Docker镜像，可以轻松重现该漏洞。利用步骤清晰，包括：
1. 构建并运行包含漏洞的Tomcat Docker镜像。
2. 使用PUT方法上传恶意JSP文件到服务器。
3. 通过访问上传的JSP文件，执行任意命令。
POC中包含了一个Python脚本，用于自动化利用过程。该脚本简化了攻击流程，降低了利用的技术门槛。

利用步骤：
1. 准备：确保已安装Docker和Python 3。
2. 环境搭建：使用提供的Dockerfile构建Tomcat Docker镜像，并运行容器，将Tomcat服务暴露在本地端口8080上。
3. 恶意JSP上传：使用curl命令，通过PUT方法将`exploit/shell.jsp`文件上传到Tomcat服务器。
4. 漏洞利用：运行Python脚本`exploit/1_exploit_cve_2025_24813.py`，该脚本将自动触发漏洞，并在服务器上执行命令。
5. Webshell交互：通过浏览器访问上传的JSP文件，使用`cmd`参数执行任意命令，例如`http://localhost:8080/shell.jsp?cmd=id`。

投毒风险分析：
该POC的投毒风险较低，主要风险在于JSP webshell本身。攻击者可能修改`exploit/shell.jsp`文件，使其包含恶意代码，例如：
* 下载并执行其他恶意程序。
* 收集敏感信息并发送到远程服务器。
* 修改系统配置，创建后门账户。
* 植入挖矿程序等。
为了降低投毒风险，建议在使用POC时，仔细审查`exploit/shell.jsp`文件的内容，确保其不包含任何恶意代码。同时，建议在隔离环境中运行POC，避免对生产环境造成影响。此外，POC中包含的Python脚本也存在一定的投毒风险，攻击者可能修改脚本，使其执行恶意操作。但由于Python代码相对易读，因此投毒风险较低。总体来说，该POC的投毒风险较低（15%），但仍需保持警惕。

**项目地址:** https://github.com/issamjr/CVE-2025-24813-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
