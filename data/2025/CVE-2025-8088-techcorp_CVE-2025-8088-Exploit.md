## CVE-2025-8088 - WinRAR 路径遍历/目录穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** WinRAR 7.12及以下版本

**利用条件:** 需要用户解压恶意构造的RAR压缩包，无需认证

**POC 可用性:** 6/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

WinRAR 目录穿越/路径遍历漏洞（CVE-2025-8088）是一个影响 WinRAR 软件的高危安全漏洞。攻击者可以利用 Windows NTFS 备用数据流（ADS）特性和路径遍历技术，绕过 WinRAR 的文件验证机制。通过构造恶意的 RAR 压缩包，攻击者可以使 WinRAR 在解压文件时，将恶意文件释放到系统任意位置，例如 Windows 启动文件夹（Start Menu\Programs\Startup），从而在用户下次启动或登录时实现任意代码执行。该漏洞已确认被多个境外高级持续性威胁（APT）组织（如 UNC4895/RomCom、APT44、Turla）广泛利用，针对乌克兰军事及政府机构发动攻击，并有证据表明存在中国境内的非法攻击团伙利用此漏洞。受影响版本包括 WinRAR 7.12 及以下版本。用户需通过解压恶意压缩包来触发此漏洞，通常通过社会工程学手段进行传播。

**POC有效性分析**
提供的POC代码（`CVE-2025-8088.py`）旨在演示 WinRAR 路径遍历漏洞的利用过程。该脚本详细定义了攻击所需的关键参数，包括路径遍历深度（`NUM_DEPTHS`）、恶意文件释放的相对目标路径（`RELATIVE_DROP_PATH`）以及最终执行的恶意负载（`PAYLOAD`）。`RELATIVE_DROP_PATH` 被精心设置为 `AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`，这是一个标准的 Windows 启动文件夹路径，确保了恶意脚本在受害者系统启动时自动执行，从而实现持久化。`PAYLOAD` 部分是一个简单的批处理脚本，其功能是在受害系统上反复弹出“System Hacked”消息框，并启动 Chrome 浏览器和计算器（`calc.exe`）。这清晰地证明了漏洞能够实现任意代码执行的能力，是一个典型的概念验证行为。

POC代码还明确提及利用 NTFS 备用数据流（ADS）特性来隐藏恶意文件，以及使用一系列路径遍历模式（`../../../` 等）。ADS 结合路径遍历是此漏洞利用的关键技术，它允许攻击者将恶意数据嵌入到看似无害的文件中，并利用路径遍历将其放置到系统关键位置。此外，代码中 `create_professional_cv` 函数的存在，尽管与核心漏洞利用逻辑看似无关，但很可能是一个社会工程学诱饵的生成器，旨在制作一个看起来无害的 PDF 文件作为恶意 RAR 压缩包的载体，以增加受害者打开压缩包的可能性。这种将诱饵文件与漏洞利用相结合的做法在真实世界的攻击中非常普遍。

尽管 RAR 文件的实际生成和 ADS 嵌入逻辑在提供的代码段中被截断，但所有必要的配置和组件（如恶意负载内容、目标路径、路径遍历模式和ADS流名称）都已明确定义，这表明该 POC 具备很高的完整度，仅需补全标准 RAR 库的调用或自定义 RAR 结构生成部分即可成为一个完整的、可直接运行的利用工具。因此，该 POC 在概念上是完整的，在技术实现上仅差最终的组装部分，其有效性潜力极高。

**利用步骤**
1.  **构造恶意压缩包**：攻击者首先利用类似提供的 Python 脚本，结合 RAR 库或自定义代码，构造一个恶意的 RAR 压缩包（例如 `exploit.rar`）。这个压缩包内部包含一个精心制作的文件路径，该路径利用 `../` 等路径遍历符，并结合 NTFS ADS 特性，将一个恶意脚本（如 `payload.bat`）指向目标系统上的启动文件夹。
2.  **社会工程学传播**：攻击者通过鱼叉式网络钓鱼、恶意网站下载或其他社会工程学手段，将这个恶意 `exploit.rar` 文件发送给受害者。常见的诱饵可能包括伪装成重要的文档（例如，如 POC 中暗示的“专业简历”、“项目报告”等），以诱骗受害者打开它。
3.  **用户解压触发**：受害者在不明就里的情况下，使用 WinRAR 软件解压这个恶意压缩包。由于 WinRAR 存在 CVE-2025-8088 路径遍历漏洞，它会错误地处理压缩包内嵌的特制文件路径，而非用户指定的目标路径，从而将 `payload.bat` 恶意脚本悄无声息地释放到系统启动目录（如 `C:\Users\<用户名>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`）。
4.  **恶意代码执行**：当受害者下次重新启动计算机或登录 Windows 系统时，Windows 操作系统会自动执行位于启动文件夹中的 `payload.bat` 脚本。`payload.bat` 脚本被执行后，如 POC 中所示，会弹出“System Hacked”消息，并反复启动 Chrome 和计算器，从而实现任意代码执行。在真实攻击场景中，攻击者可以放置更具破坏性的负载，例如下载并执行远程控制木马、勒索软件、数据窃取程序或建立持久性后门。

**投毒风险分析**
从提供的 POC 代码来看，其核心恶意负载（`PAYLOAD` 变量中的批处理脚本）的功能是显示消息并打开合法的系统程序（Chrome 和 Calc），这旨在明确演示漏洞的任意代码执行能力。该负载不包含任何持久性、隐蔽性或破坏性的恶意操作。它没有典型的投毒特征，如外部 C2（命令与控制）通信、复杂的加密或混淆、注册表修改、服务创建、文件删除、数据窃取或安装高级恶意软件等行为。POC Python 脚本本身也是可读的，没有明显的代码混淆。它使用了 Python 标准库，并且恶意负载直接在代码中以字符串形式定义，这使得代码审计变得相对容易。在提供的代码段中，没有发现任何加载外部可疑脚本、二进制文件或进行非预期网络请求的行为。`create_professional_cv` 函数虽然可能作为社会工程学的诱饵，但其本身是生成 PDF 文档的合法行为，不构成代码层面的投毒。

因此，基于当前对所提供 POC 代码的分析，**该 POC 代码本身的投毒风险被评估为低**（10%）。其主要目的是验证 WinRAR 漏洞的存在和可利用性，而非进行实际的恶意攻击。然而，需要强调的是，任何能够实现任意代码执行的漏洞都可能被恶意攻击者用于投递高风险的恶意负载。攻击者可以轻易地将 POC 中的演示性 `PAYLOAD` 替换为真实的、具有高度危害性的恶意软件（如后门、信息窃取器、勒索软件、远程控制木马等），从而构成极高的实际攻击风险。鉴于该漏洞已被多个 APT 组织广泛利用，组织在防御时应将此漏洞视为高危威胁，并尽快升级 WinRAR 版本至 7.13 或更高，以防范潜在的恶意利用。

**项目地址:** 

**漏洞详情:** 
