## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 未提供具体评分

**影响版本:** 7.12 及以下版本

**利用条件:** 需要用户解压恶意压缩包；无需认证；本地用户操作

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

该CVE漏洞涉及WinRAR压缩软件中存在的一个高危路径遍历漏洞（也称为目录穿越漏洞）。该漏洞影响WinRAR 7.12及以下版本。攻击者可利用此漏洞结合NTFS数据流特性，通过精心构造的恶意RAR压缩包，在受害者解压文件时绕过验证，将恶意文件写入任意目录，甚至Windows的启动目录，从而实现任意代码执行。此漏洞已被发现为零日漏洞，并被俄罗斯相关黑客组织用于传播RomCom恶意软件，表明其在野利用的活跃性。

**POC有效性分析**
所提供的Python POC脚本 `CVE-2025-8088.py` 是一个功能完备且有效的WinRAR路径遍历漏洞利用工具。该脚本通过以下机制证明了漏洞的有效性：
1.  **恶意RAR文件生成**：脚本能够成功生成一个名为 `exploit.rar` 的恶意RAR压缩包。该压缩包是精心构造的，包含利用路径遍历特性的恶意文件路径。
2.  **路径遍历构造**：脚本使用了多种路径遍历模式（例如 `../../../`），这些模式被嵌入到RAR文件头中，旨在在解压时将文件路径“向上”移动到目标目录之外。
3.  **NTFS数据流利用**：代码中提及的 `ADS_STREAMS` 和 `generate_long_stream_names` 功能暗示了对NTFS数据流特性的利用，这可能是绕过WinRAR内部安全检查或混淆文件真实路径的关键机制，允许攻击者隐藏恶意文件并使其在非预期位置执行。
4.  **恶意负载投递**：脚本明确指定了 `RELATIVE_DROP_PATH` 为 `AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`。这意味着在漏洞成功利用后，恶意批处理文件 `payload.bat` 将被放置到Windows的启动目录中，确保系统重启后自动执行。
5.  **有效负载内容**：`PAYLOAD` 变量包含了具体的批处理脚本内容，它会执行以下操作：显示“System Hacked”消息框，并循环五次启动 `chrome.exe` 和 `calc.exe`，每次间隔10秒。这清晰地证明了攻击者能够通过此漏洞实现任意代码执行。
6.  **诱饵文档生成**：脚本还包含生成一个专业简历PDF文件 (`create_professional_cv`) 的功能。这个PDF文件可以作为诱饵，使得恶意RAR文件看起来更具合法性，从而增加社会工程学攻击的成功率。整个POC脚本结构清晰，逻辑严谨，完全实现了路径遍历漏洞的利用，并提供了直观的恶意代码执行演示，因此被评为高质量的完整利用型POC。

**利用步骤**
1.  **准备环境**：确保受害者系统安装了WinRAR的受影响版本（例如 7.12 或更早版本）。
2.  **生成恶意RAR**：攻击者运行 `CVE-2025-8088.py` 脚本，该脚本将生成一个名为 `exploit.rar` 的恶意压缩包。脚本还会生成一个伪装用的 `Alicia_Sheree_CV_YYYY.pdf` 文件，该文件将作为压缩包内的诱饵文件。
3.  **社会工程学诱导**：攻击者通过鱼叉式钓鱼邮件、恶意网站下载或其他方式，将 `exploit.rar` 压缩包发送给目标受害者，并诱导受害者下载并解压此文件（例如，声称这是一个重要的简历、报告或其他文档）。
4.  **解压触发漏洞**：当受害者使用受影响版本的WinRAR解压 `exploit.rar` 文件时，由于路径遍历漏洞，脚本中定义的 `payload.bat` 文件将绕过预期的解压路径，被静默写入到Windows的启动目录 (`C:\Users\<用户名>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`)。
5.  **任意代码执行**：一旦 `payload.bat` 成功写入启动目录，它将在受害者下次启动Windows系统时自动执行（或在某些配置下可能立即执行）。执行后，批处理脚本将弹出“System Hacked”消息框，并循环启动 `chrome.exe` 和 `calc.exe`，从而实现攻击者预设的任意代码执行。

**投毒风险分析**
对该POC脚本 `CVE-2025-8088.py` 的投毒风险评估为低（5%）。理由如下：
1.  **代码透明性**：该POC脚本是纯Python代码，可读性强，未发现任何形式的代码混淆或加密。所有关键逻辑，包括路径遍历模式、目标投放路径和恶意负载内容，都以明文形式直接呈现在脚本中。
2.  **明确的恶意负载**：脚本内定义的 `PAYLOAD` 变量明确包含了批处理脚本的内容，其行为是弹出消息框和启动系统程序。这种负载是POC演示漏洞效果的直接组成部分，而非隐藏的、非预期的恶意行为。在安全研究中，演示漏洞利用的后门代码不应被误判为POC代码本身的“投毒”。
3.  **无外部依赖**：除了用于生成诱饵PDF的 `reportlab` 库，脚本没有从外部URL下载或执行任何代码，也没有包含可疑的第三方模块或库。所有操作都在本地完成，降低了外部恶意代码注入的风险。
4.  **无隐藏行为**：脚本没有表现出任何未文档化或非预期的行为，例如收集用户信息、建立反向Shell、下载额外的恶意软件、修改系统重要配置或试图长期驻留。其目的仅限于演示路径遍历漏洞的利用及其带来的任意代码执行能力。

综上所述，虽然该POC脚本用于生成具有恶意效果的文件以证明漏洞，但其自身的代码是干净、透明且目的明确的，没有迹象表明POC脚本本身被植入了额外的、非预期的恶意功能（即“投毒”）。研究人员可以安全地分析和运行此POC，以理解漏洞机制和验证其影响。

**项目地址:** 未提供

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
