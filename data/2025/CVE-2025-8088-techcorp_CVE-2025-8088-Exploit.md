## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 严重

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** WinRAR <= 7.12 (Windows版本)

**利用条件:** 攻击者需诱导用户打开并解压一个特制的恶意RAR压缩文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞的根源在于WinRAR在处理Windows NTFS文件系统的备用数据流（ADS）以及解压路径验证时的逻辑缺陷。提供的POC代码揭示了其利用机制，即通过在RAR头部构造包含多个'../'路径遍历序列的文件名，结合ADS特性，绕过WinRAR的安全沙箱。具体而言，POC通过`struct`模块操作RAR5底层头部结构，注入冗长的路径偏移量。当用户点击‘解压到当前文件夹’或类似操作时，WinRAR未能正确过滤经过ADS封装的路径，导致文件被写入到预定目录之外。该POC功能完整，包含了PDF假文档生成器（诱饵文件）和恶意批处理载荷构造逻辑，经分析其能够成功生成旨在将`payload.bat`写入Windows启动项（Startup）目录的恶意压缩包，有效性极高。利用步骤：1. 运行POC脚本，脚本会利用`reportlab`库生成一个看起来合法的PDF个人简历作为诱饵。2. 脚本定义了目标路径为`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`。3. 通过路径遍历字符`../`的重复堆叠，脚本计算出相对于解压目录的偏移量。4. 脚本将诱饵PDF和恶意Payload打包进`exploit.rar`，并对RAR文件头进行二进制级别的修改，利用NTFS ADS流隐藏路径。5. 攻击者将`exploit.rar`发送给受害者，一旦受害者使用受影响版本的WinRAR解压，恶意批处理文件将静默写入启动文件夹。6. 受害者下次登录系统时，`payload.bat`执行，弹出‘System Hacked’消息并启动计算器和浏览器。投毒风险分析：该POC代码本身主要基于标准库和开源绘图库`reportlab`构建，代码逻辑清晰且可读性强。主要的‘恶意代码’（如弹出消息、启动计算器）被明确定义在`PAYLOAD`变量中，作为漏洞验证的示例载荷，这属于合法的安全研究范畴，不应被视为针对研究员的投毒。代码中使用了`subprocess`和`pathlib`等模块进行文件操作，但这与其生成RAR文件的功能相符，未发现隐藏的远程连接、加密混淆或针对研究员本机的静默攻击行为。尽管如此，考虑到该POC涉及到底层二进制结构的修改，且GitHub上存在多个类似项目的变体，仍需注意部分第三方修改版POC可能在`PAYLOAD`变量中植入真正的僵尸网络或勒索病毒。目前的分析结论是，此特定POC脚本是相对安全的教学/防御研究工具，但其生成的`exploit.rar`具有极强的实战杀伤力，不可在非隔离环境中解压生成的成品。

**项目地址:** [https://github.com/walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
