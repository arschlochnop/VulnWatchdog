## CVE-2025-8088 - WinRAR 目录遍历/路径穿越 (Directory Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越 (Directory Traversal)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** WinRAR存在目录遍历漏洞的受影响版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll，具体版本未在提供信息中明确指出)

**利用条件:** 用户需解压特制恶意压缩包

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析
提供的Python POC脚本 `CVE-2025-8088.py` 旨在利用WinRAR的目录遍历漏洞 (CVE-2025-8088) 来实现任意代码执行。脚本通过编程方式构造一个恶意的RAR5压缩包 `exploit.rar`。核心机制在于利用WinRAR在处理特制压缩包时，会错误地采用压缩包内嵌的路径，而非用户指定的目标路径进行文件解压。

脚本首先定义了一个攻击载荷 `PAYLOAD`，这是一个批处理脚本 (`payload.bat`)。该批处理脚本的功能是循环显示“System Hacked”消息、启动Chrome浏览器和计算器程序，以直观地演示攻击成功。脚本还设置了 `RELATIVE_DROP_PATH` 为 `AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`，这意味着攻击者意图将恶意文件释放到Windows的启动文件夹中，从而确保在用户下次登录或系统启动时自动执行。

POC利用 `PATH_TRAVERSALS` 列表，其中包含不同深度的目录遍历符 (例如 "../", "../../" 等)，结合一个长占位符流名称 `ADS_STREAMS`，来构建能够突破当前解压目录限制的恶意文件路径。虽然RAR文件的具体构造逻辑在提供的代码段中被截断，但从RAR5常量的定义 (`RAR5_SIG`, `HFL_EXTRA`, `HFL_DATA`) 以及对 `PATH_TRAVERSALS` 和 `RELATIVE_DROP_PATH` 的使用，可以推断该脚本能够有效地生成一个能够触发目录遍历漏洞的RAR压缩包。一旦受害者解压此文件，`payload.bat` 将被放置到指定启动路径，并在后续系统启动时自动运行，成功实现预期的任意代码执行。

值得注意的是，脚本中包含一个名为 `create_professional_cv` 的函数，该函数使用 `reportlab` 库来生成PDF简历。这个功能与WinRAR漏洞的利用本身无关，可能是开发者在开发过程中遗留的无关代码或作为某种诱饵文件生成的一部分。然而，其本身不具备恶意行为，也不会影响POC的漏洞利用有效性。总的来说，该POC脚本逻辑清晰，目标明确，提供了一个完整的利用链来验证CVE-2025-8088漏洞。

利用步骤
1.  **生成恶意压缩包**: 攻击者运行提供的 `CVE-2025-8088.py` 脚本，该脚本将根据预设的 `PAYLOAD` 和 `RELATIVE_DROP_PATH` 参数，在当前目录下生成一个名为 `exploit.rar` 的恶意RAR5压缩包。
2.  **分发恶意压缩包**: 攻击者通过钓鱼邮件、恶意网站下载、即时通讯工具等方式，将 `exploit.rar` 文件发送给目标受害者。根据搜索结果，现实中攻击者常使用高度定制化的地缘政治相关诱饵进行钓鱼。
3.  **受害者解压**: 受害者在不知情的情况下，使用存在漏洞的WinRAR版本（如Windows版RAR、UnRAR或相关组件）解压了 `exploit.rar`。
4.  **目录遍历发生**: WinRAR在解压过程中未能正确处理 `exploit.rar` 中内嵌的恶意文件路径，导致 `payload.bat` 文件被写入到 Windows 系统启动目录，即 `C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`。
5.  **任意代码执行**: 当受害者下次登录或系统启动时，`payload.bat` 会自动执行。根据POC中定义的 `PAYLOAD` 内容，这将导致系统显示消息框、启动Chrome浏览器和计算器程序，从而证明攻击者已在受害者系统上实现了任意代码执行。

投毒风险分析
对所提供的 `CVE-2025-8088.py` POC脚本进行分析，其投毒风险评估为低 (10%)。这一判断主要基于以下几点：

1.  **明确的恶意载荷定义**: 脚本的核心攻击载荷 `PAYLOAD` 是一个批处理脚本，其内容被清晰地定义在代码中，并直接用于演示漏洞的效果。这种直接且未混淆的定义方式，使得安全研究人员和分析人员可以轻易地识别并理解其意图，没有隐藏的恶意行为。
2.  **代码结构清晰，无混淆**: 整个POC脚本的代码结构清晰，变量命名直观，逻辑流程易于理解。没有发现任何代码混淆技术（如 base64 编码、多层加密、动态加载等），也没有使用常见的反沙盒或反调试技术。
3.  **无外部可疑连接**: 脚本中未包含任何向外部服务器（C2服务器）发起连接、下载额外恶意组件或泄露敏感信息的代码。所有的攻击逻辑都内嵌于脚本自身，并作用于本地生成的RAR文件。
4.  **无关代码的无害性**: 脚本中虽然存在一个与漏洞利用无关的 `create_professional_cv` 函数及其 `reportlab` 依赖，但该函数本身旨在生成一个PDF文档，并未被调用执行任何恶意操作，也没有迹象表明其被用于隐藏或触发其他恶意功能。其存在更可能是一个开发过程中的遗留物或误添加。
5.  **不属于“后门”**: 脚本生成的 `payload.bat` 虽然在受害者机器上执行了恶意操作（消息、启动程序），但这属于漏洞利用成功的直接演示，而非POC脚本自身携带的“后门”或“投毒”行为。攻击者使用此POC进行利用时，其“恶意”行为是预期和可见的。

综上所述，该POC脚本作为防御性安全研究的工具是相对安全的。它清晰地展示了漏洞的利用方式和效果，而自身不包含隐藏的、意图感染分析者系统的额外恶意功能。潜在的风险仅在于分析者在不加审查的情况下运行其生成的恶意RAR文件，但这已超出POC脚本本身的投毒范畴，而是漏洞演示的必然结果。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
