## CVE-2025-2304 - Camaleon CMS 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Camaleon CMS

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 未知/未指定

**利用条件:** 需要认证、需要网络访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-2304漏洞影响Camaleon CMS，其根本原因在于`UsersController`中的`updated_ajax`方法不安全地使用了`permit!`函数，导致存在不安全的批量赋值漏洞。该漏洞允许已认证的用户通过操纵参数来修改受限属性，从而获得提升的权限。

**POC有效性分析:**
提供的POC是一个Python脚本（`exploit.py`），旨在自动化此权限提升漏洞的利用过程。该脚本利用`requests`库进行HTTP通信，并使用`BeautifulSoup`库解析HTML响应，以提取必要的`authenticity_token`和`csrf-token`。该脚本首先通过对`/admin/login`进行GET请求来获取初始的`authenticity_token`，随后对同一端点进行POST请求，使用提供的用户名和密码进行用户认证。认证成功后，脚本会向`/admin/profile/edit`发起GET请求，以获取新的CSRF令牌和用于配置文件更新的正确操作URL。漏洞利用的核心在于随后向`updated_ajax`端点发送的POST请求。在该请求中，脚本精心构造了一个数据载荷，除了标准的密码更新字段（`password[password]`、`password[password_confirmation]`）之外，还恶意地包含了参数`"password[role]": "admin"`。由于存在不安全的批量赋值漏洞，Camaleon CMS应用程序会处理这个`role`参数，从而将已认证用户的权限提升至管理员级别。脚本通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。该POC设计健壮，能够正确处理令牌，并覆盖了从认证到权限提升的整个利用流程，其结构清晰和明确的成功/失败消息表明其高质量和可靠性。

**利用步骤:**
要利用此POC，攻击者需要目标Camaleon CMS的URL以及任何现有用户的有效凭据（即使是低权限用户）。执行漏洞利用的命令非常简单：
```bash
python exploit.py --url <目标Camaleon_CMS_URL> --username <有效用户名> --password <有效密码>
```
脚本将自动执行登录、检索令牌，并发送构造的请求以将指定用户的角色提升为“admin”。成功执行后，用户可以使用相同的凭据重新登录，并会发现自己拥有管理员权限。

**投毒风险分析:**
所提供的`exploit.py`脚本在恶意载荷注入或“投毒”方面表现出极低的风险。代码清晰、易读，并且只使用了常见、受信任的Python库：`requests`用于HTTP请求，`argparse`用于命令行参数解析，以及`BeautifulSoup`用于HTML解析。代码中没有发现混淆、动态代码执行（如`eval`）或不寻常的编码技术。脚本没有尝试下载或执行外部文件，也没有向与目标Camaleon CMS实例无关的第三方域名发起可疑的网络请求。所有通信都仅定向到指定的`--url`参数。脚本的逻辑直接实现了所述的权限提升漏洞，通过在配置文件更新期间操纵`role`参数。它不包含任何可能引入后门、建立持久性或从系统中窃取数据的代码。此外，`README.md`文件明确声明：“⚠️此漏洞利用仅供教育和研究目的使用。”这与代码本身的非恶意性质相符。综上所述，通过对源代码的全面审查，该POC被评估为投毒风险极低（例如5%），它是一个合法的工具，旨在为防御性安全研究演示和测试CVE-2025-2304漏洞。

**项目地址:** Local filesystem provided, no public URL

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-2304
