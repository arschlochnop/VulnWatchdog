## CVE-2025-2304 - Camaleon CMS 权限提升(Mass Assignment)

**漏洞编号:** CVE-2025-2304

**漏洞类型:** 权限提升(Mass Assignment)

**影响应用:** Camaleon CMS

**危害等级:** 高

**CVSS评分:** 

**影响版本:** < 2.9.1

**利用条件:** 需要认证，需要网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 0%

## 详情

提供的Python POC (`exploit.py`) 是一个精心设计且高度有效的工具，用于演示Camaleon CMS中编号为CVE-2025-2304的权限提升漏洞。此漏洞的核心是`UsersController`中`updated_ajax`方法对Mass Assignment的不安全处理。具体来说，该方法错误地使用了`permit!`函数，允许对用户提交的参数进行未经筛选的处理。这一关键缺陷使得经过身份验证的攻击者能够注入并修改受限制的属性，例如用户角色，这些属性通常应受到保护，不被直接通过用户输入修改。`exploit.py`脚本通过一套系统化的步骤利用此漏洞。它首先执行标准的登录流程，要求提供有效的用户凭据，并正确提取`authenticity_token`以绕过登录端点的CSRF保护。成功认证后，脚本会导航到用户的个人资料编辑页面，从中提取另一个`csrf-token`（来自meta标签）以及用于个人资料更新表单（`profie-form-ajax-password`）的动态`action` URL。关键的利用步骤涉及向此`updated_ajax`端点发送一个POST请求。在此请求中，脚本会在其他合法的密码更新参数旁注入`password[role]="admin"`。由于`permit!`函数的疏忽，CMS会将`password[role]`作为允许的属性进行处理，从而将已认证用户的角色提升为“管理员”。脚本通过检查HTTP 200状态码来验证操作是否成功，这表示服务器已无错误地处理了请求。此漏洞利用对`requests`库进行健壮的HTTP请求处理和对`BeautifulSoup`进行高效HTML解析的依赖，使其可靠且易于执行。此详细分析确认了POC在演示和利用所述权限提升漏洞方面的有效性。

**利用步骤**:
1.  **环境准备**: 确保目标系统上运行的是Camaleon CMS，且版本低于补丁版本2.9.1。攻击者需要访问目标CMS的网络，并拥有一对有效的、非管理员权限的用户账户凭证（用户名和密码）。
2.  **获取POC**: 从可信源获取`exploit.py`脚本。
3.  **安装依赖**: 如果尚未安装，请通过`pip install requests beautifulsoup4`安装所需的Python库。
4.  **执行攻击**: 打开命令行终端，运行以下命令，将`http://target-cms.com`替换为实际的CMS URL，并将`your_user`和`your_password`替换为合法用户的凭证：
    `python exploit.py --url http://target-cms.com --username your_user --password your_password`
5.  **验证**: 脚本执行成功后，将打印"Exploit sucessfull."。攻击者随后可以尝试使用相同的`your_user`和`your_password`重新登录Camaleon CMS，此时会发现该账户已拥有管理员权限。

**投毒风险分析**:
对提供的POC代码 (`exploit.py`) 进行全面和深入的分析后，可以确认其投毒风险为极低，评分为0%。这一结论基于对代码结构、外部依赖、执行逻辑和数据处理方式的严格审查。
*   **代码透明度与可读性**: 脚本代码完全以明文形式提供，并且注释清晰，逻辑结构直接。没有使用任何形式的代码混淆技术，这使得任何具备Python基础的分析人员都可以轻松地审计其完整功能，确保没有隐藏的恶意行为。
*   **依赖项审查**: 脚本仅依赖于两个标准且广泛使用的Python库：`requests`（用于HTTP请求）和`beautifulsoup4`（用于HTML解析）。这两个库都是Python生态系统中的基石，维护良好，并且是执行此类Web交互任务的常见选择。脚本没有引入任何非标准、来源不明或具有潜在风险的第三方库。
*   **无外部代码加载或执行**: `exploit.py`没有包含任何机制来从远程服务器下载或执行额外的代码或二进制文件。所有执行逻辑都完全封装在提供的脚本文件中。其所有的网络请求都直接针对用户在命令行中指定的Camaleon CMS目标URL，没有向任何其他未知的或攻击者控制的服务器发送数据或建立连接。
*   **Payload性质**: 漏洞利用的关键Payload (`password[role]="admin"`) 是静态定义在脚本中的，并且其目的与描述的“权限提升”漏洞完全吻合。它没有包含任何可疑的指令、shell命令或尝试执行系统级操作。它仅仅是利用了应用程序逻辑缺陷来修改数据库中的用户属性。
*   **无数据窃取或回连**: 脚本中没有任何代码试图收集目标系统上的敏感数据（如文件内容、环境变量、数据库信息等）并将其传输到外部服务器。同样，脚本也未尝试建立任何形式的反向shell连接，以获得对目标系统的持久化控制。
*   **明确的非恶意声明**: 随附的`README.md`文件明确声明“This exploit is provided for educational and research purposes only.”，这与代码的实际行为高度一致，进一步增强了其作为防御性研究工具的可信度。
综合来看，该POC代码是纯粹的漏洞验证工具，不包含任何恶意功能或潜在的投毒风险。组织在进行防御性安全研究时可以安全地运行和分析此POC。

**项目地址:** 

**漏洞详情:** https://rubysec.com/advisories/CVE-2025-2304/
