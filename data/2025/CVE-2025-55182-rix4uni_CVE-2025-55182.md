## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (反序列化/命令注入)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (反序列化/命令注入)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 相关版本

**利用条件:** 无须认证 (Pre-authentication)，目标应用启用了 React Server Components 且处理 Flight 协议数据。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为‘React2Shell’，是React生态系统中极具破坏性的安全漏洞。分析提供的Bash脚本POC（版本1.0.1）可知，该利用工具具备高度的自动化和武器化特征。POC通过构造恶意的Flight协议负载，利用React Server Components在处理服务端组件序列化数据时的逻辑缺陷实现代码执行。脚本预置了包括‘cat /etc/passwd’、‘id’、‘env’在内的13个敏感系统命令，并支持自定义指令执行。其有效性体现在其对目标域名的智能处理（自动补全协议）以及对返回结果的自动化捕获。该漏洞的核心在于Flight协议解析器在反序列化过程中未对特定标记位进行严格校验，导致攻击者可以伪造服务端指令流。POC通过模拟合法的前端请求，在HTTP请求体中注入经过编码的恶意序列化对象，当后端Next.js或React服务尝试解析该‘Flight数据流’以渲染UI组件时，恶意载荷被执行，从而在操作系统层面获得控制权。由于该漏洞处于核心框架层，几乎所有使用默认配置的React 19早期版本均受到威胁，且利用过程不需要任何登录凭证，攻击路径极短且稳定。【利用步骤】1. 确定目标URL，验证服务是否运行React 19/Next.js环境；2. 使用POC脚本，通过-d参数指定目标地址；3. 脚本首先发送探测包验证Flight协议响应点；4. 构造包含OS命令注入序列化对象的POST/GET请求（具体取决于Flight触发路径）；5. 发送Payload并从响应流中提取命令执行回显结果。【投毒风险分析】在针对该POC代码的安全审计中，主要关注点在于脚本是否包含恶意后门或数据外泄逻辑。该Bash脚本代码逻辑相对透明，主要使用了标准库工具如curl、grep和sed，未发现明显的base64混淆执行段或远程下载未知脚本的行为。然而，作为威胁情报研究员，仍需注意此类‘武器化’脚本在安全社区流传时的潜在风险。风险点一：由于脚本包含大量敏感信息搜集命令（如读取.ssh/authorized_keys和env环境变量），如果使用者在未经授权的环境下运行或脚本被恶意修改指向攻击者控制的日志服务器，则存在数据泄露风险。风险点二：虽然此版本代码看似清晰，但此类‘一键化’利用工具极易被修改并二次分发，在代码末尾添加隐蔽的‘curl -X POST’反连操作。风险点三：脚本默认尝试连接localhost:3000，若在本地调试时疏忽，可能导致开发者本地敏感配置信息被脚本内预设的探测命令抓取。综合评估，该POC本身属于安全研究工具，投毒风险评级为15%，主要风险源于使用者操作不当或脚本被第三方二次篡改注入恶意逻辑。

**项目地址:** [https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/](https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
