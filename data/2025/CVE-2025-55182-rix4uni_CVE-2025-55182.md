## CVE-2025-55182 - React Server Components (RSC) RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components (RSC)

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 相关版本

**利用条件:** 无须认证，目标应用启用了 React Server Components (RSC) 功能并暴露了相关 API 端点。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为‘React2Shell’，是针对现代Web开发框架React的一种‘核弹级’攻击方式。分析搜索结果和POC代码片段可知，该漏洞的核心成因在于React Server Components（RSC）在处理‘Flight’协议数据时，未能对序列化的流数据进行严格的校验。Flight协议是RSC在服务器与客户端之间传输组件树、状态和数据的专有格式。攻击者可以构造恶意的Flight流片段，利用不安全的反序列化逻辑，将恶意指令注入到服务器端的执行上下文中。POC脚本显示，攻击者只需通过简单的HTTP POST或GET请求（通常带有特定的Headers如RSC: 1），发送精心设计的Payload，即可在服务器端触发命令执行。此POC支持自动化扫描和多命令执行，具备极高的实战化程度。它绕过了传统的WAF规则，因为攻击载荷被封装在正常的RSC通讯协议中，具有极强的隐蔽性。该漏洞影响范围广泛，涵盖了使用React 19系列的Next.js等主流SSR框架，考虑到React在全球范围内的极高市场占有率，该漏洞的有效性和杀伤力极强。

【利用步骤】1. 信息收集：识别目标网站是否使用React Server Components（通常通过响应头或页面加载时的Flight流请求特征判断）。2. 环境准备：配置POC脚本，设定目标域名（如使用-d参数）。3. 构造Payload：根据Flight协议格式，将攻击者定义的操作系统命令（如id、whoami、cat /etc/passwd）嵌入到序列化数据中。4. 发送请求：向目标的RSC端点（常见于Next.js的路由地址）发送包含恶意Flight数据的请求。5. 结果回显：服务器解析恶意数据并触发命令执行，POC捕获HTTP响应中的回显内容并展示在控制台。

【投毒风险分析】该POC脚本本身表现为典型的防御性安全测试工具。分析代码结构，脚本提供了命令行参数解析、颜色输出美化以及默认的系统信息收集命令（如cat /etc/os-release等）。虽然脚本包含了一些敏感操作的自动化尝试（如读取SSH密钥），但这属于渗透测试中典型的权限验证逻辑。代码中使用了标准的Bash语法，未发现经过混淆处理的Base64字符、动态执行的反弹Shell隐藏代码或针对分析者宿主机的破坏性指令。然而，由于该漏洞等级极高，攻击者极易将此类脚本修改后嵌入到合法的NPM包或GitHub仓库中进行供应链投毒。目前的POC代码逻辑清晰，依赖项较少，其风险主要在于被恶意二次修改。防御者在使用此类POC时，应重点检查脚本中是否存在向非目标服务器发送数据的curl或wget请求。在本样本中，投毒风险处于低水平（15%），属于相对安全的漏洞验证工具。

**项目地址:** [https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/](https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
