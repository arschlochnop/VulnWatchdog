## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** WinRAR <= 7.12

**利用条件:** 用户下载并使用受影响版本的WinRAR解压攻击者构造的恶意RAR压缩包文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码展现了CVE-2025-8088漏洞的核心逻辑，即利用Windows NTFS备用数据流（ADS）特性配合路径遍历字符实现文件非法写入。代码通过Python脚本调用rar.exe命令行工具创建原始压缩包，随后通过底层字节操作（patch_placeholder_in_header函数）修改RAR5报文头中的文件名。具体而言，它利用了ADS的冒号分隔符语法，将原本看似普通的文件名修改为包含多个‘../’跳转序列的目标路径（如启动目录）。分析POC结构可见其逻辑严密，涵盖了从 decoy 文件生成、ADS 附加到最后的二进制头修复，能够实现在解压过程中将‘payload.bat’自动释放到Windows启动项目录，具有极高的实战化水平。由于该漏洞本质上绕过了WinRAR之前的安全补丁，增加了对抗杀软（EDR）沙盒检测的迷惑性，因此此POC在未打补丁（7.13版本以下）的环境中具有极高的触发成功率。【利用步骤】1. 配置攻击载荷，如设置RELATIVE_DROP_PATH为系统的启动目录，编写payload.bat内容；2. 运行Python脚本，脚本会自动调用本地WinRAR路径（rar.exe）生成基础压缩包；3. 脚本通过二进制修改技术，将压缩包内的文件映射到ADS流并注入路径遍历序列；4. 生成最终的exploit.rar文件。5. 诱导受害者右键点击该RAR文件并选择‘解压到当前文件夹’或‘解压到指定目录’，触发payload释放。【投毒风险分析】该POC代码本身主要使用了Python标准库（os, struct, subprocess, zlib, pathlib），代码逻辑相对透明。核心危险操作在于对二进制文件头部的Patch操作，这属于漏洞利用的必要手段，而非恶意投毒行为。代码中虽然包含了生成payload.bat并在启动项写入的逻辑，但其内容仅为简单的‘echo’打印输出，属于典型的教学/验证类载荷，不具备窃密或持久化控制的恶意特征。风险评估为低（15%），主要风险点在于其依赖于本地环境中已安装的WinRAR路径，如果在一个不安全的第三方分发渠道获取此类脚本，攻击者可能会在subprocess.run环节注入额外的系统命令。代码中没有发现Base64编码的隐藏Payload、不明域名的网络请求或eval/exec等动态执行混淆代码的行为，开发者应当重点关注脚本运行时的本地环境权限控制，防止生成的exploit.rar被意外执行。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
