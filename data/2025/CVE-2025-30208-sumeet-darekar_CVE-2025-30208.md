## CVE-2025-30208 - Vite (前端开发工具) 任意文件读取 / 路径穿越

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取 / 路径穿越

**影响应用:** Vite (前端开发工具)

**危害等级:** 高危 (High)

**CVSS评分:** 7.5 (根据描述评估)

**影响版本:** < 6.2.3, < 6.1.2, < 6.0.12, < 5.4.15, < 4.5.10

**利用条件:** Vite 开发服务器处于运行状态，攻击者能够通过网络访问该端口（通常为 5173）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC（vulnwatchdog）由三个核心部分组成：Bash调度脚本、检测脚本（detect_vite.py）和扫描脚本（scan_vite.py）。经过分析，其有效性较高。首先，detect_vite.py 通过识别特定的资产路径（如 /@vite/client、/vite.svg）以及匹配 HMR（热更新）相关的 JS 指纹来精准锁定 Vite 实例，这大大降低了盲目发包的频率。其次，scan_vite.py 针对 CVE-2025-30208 的核心成因——即对 @fs 路径处理的绕过进行了实现。在受影响的版本中，Vite 的中间件未能正确过滤经过编码或特定构造的路径，导致攻击者可以通过访问类似于 /@fs/etc/passwd 的构造 URL 来读取宿主机的敏感文件。此 POC 还集成了 Discord 通知功能，便于攻击者或研究人员实时获取扫描结果。虽然代码中部分函数被截断，但从其 README 和逻辑流来看，它具备了从自动发现到自动化验证的完整闭环，是典型的针对开发环境的自动化攻击工具。【利用步骤】1. 环境准备：攻击者将目标 URL 列表存入 urls.txt，配置 Discord Webhook 用于接收战果。2. 资产发现：运行 script.sh 调用 detect_vite.py，该脚本通过并发 ThreadPoolExecutor 发送探测请求，确认目标是否运行了 Vite 开发服务器。3. 漏洞扫描：一旦识别出 Vite 实例，script.sh 会将结果存入 hosts.txt 并自动启动 scan_vite.py。4. 路径穿越：scan_vite.py 向目标发送精心构造的 HTTP 请求，尝试读取 /etc/passwd（Linux）或 C:/Windows/win.ini（Windows）等关键文件。5. 结果回传：若读取成功，脚本会将漏洞信息及目标详细地址通过 Discord Webhook 推送到攻击者的客户端。【投毒风险分析】该 POC 的投毒风险处于低至中等水平（约 15%）。代码本身逻辑清晰，使用了标准的 Python requests 库进行网络请求，且仓库结构符合合法的安全扫描工具特征。其 Discord 通知功能虽然常被黑客用于数据回传，但在安全工具中也常用于提醒。需要警惕的是，安装步骤中要求用户“Replace YOUR_DISCORD_WEBHOOK_URL”，如果攻击者在分发此 POC 时预设了自己的 Webhook 地址，或者在被截断的 detect_vite.py 代码段中植入了隐藏的 eval() 执行逻辑或混淆的 base64 载荷，那么使用者在测试时可能会反向泄露己方的扫描目标和网络环境信息。建议安全研究员在运行此类代码前，必须手动检查所有 Python 脚本中的外部通信行为，并确保在受控的沙箱环境中执行。

**项目地址:** [https://github.com/sumeet-darekar/CVE-2025-30208](https://github.com/sumeet-darekar/CVE-2025-30208)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)
