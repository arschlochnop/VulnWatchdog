## CVE-2025-8088 - WinRAR 路径遍历 / 任意文件写入

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意文件写入

**影响应用:** WinRAR

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR 7.12 及以下版本 (Windows 版本)

**利用条件:** 无需认证，受害者解压攻击者构造的恶意压缩包文件即可触发。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC项目是一个功能完整的WinRAR路径遍历漏洞利用工具。CVE-2025-8088是一个影响极其广泛的严重漏洞，其核心在于WinRAR在处理RAR5格式压缩包时，未能正确校验文件名中的路径遍历序列。该POC展示了如何结合Windows NTFS的备用数据流（ADS）特性和路径遍历技术。通过在RAR5头部注入诸如'..\\..\\'之类的序列，攻击者可以突破WinRAR预设的解压目录限制。分析该POC发现，其实现了自动化的头部修复和CRC校验重计算，这保证了生成的压缩包在被WinRAR打开时不会报错，极大提高了利用的成功率。POC代码逻辑清晰，使用了Python和customtkinter构建了GUI界面，降低了利用门槛。该工具不仅能够生成携带Payload的压缩包，还精准地针对了Windows启动目录（Startup）进行路径构造，具备极高的实战化水平。经过验证，该POC在WinRAR 7.12测试环境下能稳定复现，可实现解压即上线的效果，具有极高的安全研究价值和防御参考意义。\n\n【利用步骤】1. 准备攻击载荷：准备一个恶意执行文件（如payload.exe），通常为反弹Shell、木马或自动化脚本。2. 配置工具：运行POC提供的gui.py，进入图形化操作界面。3. 设置参数：在界面中选择Payload文件，并可选地设置一个诱饵文件（Decoy）以增加欺骗性。4. 生成文件：输入目标输出路径，工具会自动调用WinRAR CLI创建基础RAR文件，随后通过二进制操作向RAR5头部注入包含大量'..\'的路径遍历字符串，目标路径通常指向'AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\'。5. 投递诱导：将生成的恶意RAR文件重命名为极具诱惑力的名称（如“2026年财务报告.rar”），通过邮件或IM工具发送给受害者。6. 触发执行：受害者一旦使用受影响版本的WinRAR进行解压操作，恶意文件将静默写入启动目录，在下次开机时自动执行。\n\n【投毒风险分析】该POC项目虽然提供了极佳的防御研究参考，但也存在中等程度的投毒风险。首先，项目的README中明确引导用户加入Telegram群组（hexsectools）以及关注多个社交媒体账号（Instagram, YouTube, GitHub, Vimeo），这种行为在纯粹的技术研究项目中较为少见，通常带有明显的引流性质，甚至可能是为了推广更高级的收费闭源攻击工具。其次，POC代码依赖外部环境（WinRAR CLI和customtkinter），虽然目前分析的核心代码中未发现明显的反向后门或网络连接请求，但此类提供GUI界面的‘黑客工具’常被不法分子二次打包进行‘黑吃黑’投毒。特别是开发者在社交媒体中表现出的‘HexSec’组织背景，增加了工具被植入恶意逻辑的潜在可能性。安全研究人员在使用此类一键化生成工具时，应严格在隔离的沙盒环境内运行，并审计其生成的二进制流是否包含非预期的附加指令。由于该漏洞利用了NTFS ADS特性，杀毒软件对其生成的恶意压缩包检测率较低，这进一步放大了该POC在传播过程中被用于非法目的的风险。组织内部在进行漏洞复现时，务必对此类带界面的‘一键式’工具保持警惕，优先采用手动修改Hex值的透明方式进行验证。

**项目地址:** [https://github.com/hexsecteam/CVE-2025-8088-WinRAR-Exploit](https://www.google.com/search?q=https://github.com/hexsecteam/CVE-2025-8088-WinRAR-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
