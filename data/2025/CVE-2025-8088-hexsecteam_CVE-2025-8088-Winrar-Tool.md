## CVE-2025-8088 - WinRAR 目录遍历/路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 高

**影响版本:** WinRAR v7.13以下版本

**利用条件:** 用户需解压恶意构造的RAR压缩包

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该POC是一个功能完善、用户友好的Python图形用户界面工具，旨在利用CVE-2025-8088，即WinRAR目录遍历漏洞。其高级性体现在结合使用了多种技术：利用NTFS备用数据流（ADS）来隐藏有效载荷、操纵RAR5归档头部以实现路径注入，以及调用WinRAR命令行界面来创建归档。该工具的README文件非常清晰，详细列出了其特性，如“ADS Exploitation”、“RAR5 Header Manipulation”、“GUI Interface”、“Startup Targeting”和“Custom Decoy Support”。它明确了环境要求（Python 3.6+、WinRAR CLI、customtkinter）并提供了详细的“快速启动”和“使用”说明，包括GUI截图和演示漏洞利用过程的GIF动图，这都表明其高度的功能完整性和可靠性。工具能够自动生成恶意RAR归档，并进行CRC重新计算以保持完整性，这充分证明了其在演示和利用CVE-2025-8088方面的有效性。其核心利用机制是将路径遍历序列（如`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`）直接注入到归档头部，确保当受害者解压精心制作的归档时，嵌入的恶意有效载荷会被放置到任意指定位置，例如Windows的启动文件夹，从而实现持久性的任意代码执行。这种全面的方法和清晰的文档使得该POC在所述目的上高度有效且合法。

**利用步骤：**
1.  **准备攻击环境**: 攻击者需准备一台安装有 Python 3.6+、WinRAR 命令行工具 (WinRAR CLI) 以及 `customtkinter` 库（通过 `pip install -r requirements.txt` 安装）的操作系统。
2.  **启动漏洞利用工具**: 执行 `python gui.py` 命令启动 WinRAR 路径遍历漏洞利用工具的图形用户界面。
3.  **配置恶意载荷 (Payload)**: 在工具界面中，攻击者需要选择一个预先准备好的恶意可执行文件，如一个 `.exe` 程序或 `.bat` 脚本。这个文件将是最终在受害者系统上执行的恶意代码。
4.  **选择诱饵文件 (Decoy)**: （可选但推荐）攻击者可以选择一个看似无害的正常文件作为诱饵。当受害者解压恶意 RAR 压缩包时，这个诱饵文件会同时被释放，以迷惑受害者，使其不易察觉到恶意行为。
5.  **指定输出文件名**: 攻击者输入希望生成的恶意 RAR 压缩包的文件名，例如 `Important_Document.rar`。
6.  **生成恶意 RAR 压缩包**: 点击工具界面上的“Build”按钮。该工具将自动执行一系列复杂操作：
    *   首先，它利用 NTFS 备用数据流 (ADS) 技术将恶意 Payload 隐藏起来，使其在常规文件视图中不可见。
    *   接着，它调用 WinRAR CLI 创建一个包含此隐藏 Payload 的基础 RAR 压缩包。
    *   最关键的一步是，工具会直接修改 RAR5 格式的压缩包头部，巧妙地注入精心构造的路径遍历序列。例如，一个典型的路径可能形如 `..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`。这个序列旨在绕过 WinRAR 的安全检查，指示解压程序将 Payload 文件释放到受害者系统上的任意指定目录，特别是 Windows 的启动文件夹 (Startup folder)。
    *   最后，工具会重新计算并更新压缩包的 CRC 校验值，确保修改后的 RAR 文件结构完整且能够被 WinRAR 正常解压，同时隐藏了其内部的恶意修改。
7.  **社会工程学攻击与分发**: 攻击者通过电子邮件、即时消息、恶意网站下载等方式，将生成的恶意 RAR 压缩包分发给目标用户。通常会配合社会工程学手段，诱骗受害者认为这是一个合法且重要的文件，从而下载并解压。
8.  **触发漏洞并实现代码执行**: 当受害者使用 WinRAR 解压这个恶意构造的 RAR 压缩包时，由于 WinRAR 存在 CVE-2025-8088 目录遍历漏洞，隐藏在 ADS 中的恶意 Payload 文件不会被释放到用户指定的安全目录，而是按照 RAR5 头部中注入的遍历路径，被放置到 Windows 的启动文件夹或其他攻击者指定的位置。一旦 Payload 被置于启动文件夹，系统在下次启动时便会自动执行该 Payload，从而实现任意代码执行，赋予攻击者在受害者系统上的控制权，可能导致数据窃取、系统破坏或更进一步的恶意活动。

**投毒风险分析：** 对本 POC 代码（GitHub 项目 `HexSec` 团队提供的工具）的投毒风险进行分析，结果显示其自身代码的投毒风险较低。该工具的 README 文件明确声明其用途为“教育和授权测试目的”，并详细列出了其功能和操作步骤。从公开的代码结构和描述来看，它是一个基于 Python 的图形用户界面工具，主要功能是自动化生成一个利用 WinRAR 目录遍历漏洞的恶意 RAR 压缩包。该工具依赖于 Python 标准库、`customtkinter` 库（一个常见的 Python GUI 库）以及调用系统上已安装的 WinRAR 命令行工具来执行其核心功能。在代码审查过程中，并未发现任何表明其包含额外恶意功能的迹象，例如：无后门或远程控制代码、无恶意 Payload 捆绑（工具的目的是让用户自行选择并捆绑恶意 Payload，它本身不预置）、无加密货币挖矿或信息窃取功能、无代码混淆或加密。代码结构清晰，易于理解，未见刻意进行代码混淆或使用加密技术来隐藏恶意意图。因此，该 POC 工具本身被视为一个合法的安全研究或测试工具。其“恶意性”体现在它能够生成具有漏洞利用能力的 RAR 文件，但这正是其设计目的，不应与工具自身的投毒风险混淆。组织在使用此类工具进行内部防御性测试或红队演练时，应确保所有操作都在严格隔离的、受控的环境中进行，并且对生成的恶意 RAR 文件进行妥善管理，防止其意外泄露或被未经授权的人员滥用。正确使用该工具可以有效评估组织在面临 WinRAR 目录遍历攻击时的防御能力。

**项目地址:** https://github.com/hexsecteam

**漏洞详情:** 
