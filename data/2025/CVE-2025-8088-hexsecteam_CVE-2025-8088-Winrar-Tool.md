## CVE-2025-8088 - WinRAR 路径遍历/目录穿越 (任意代码执行)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越 (任意代码执行)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** WinRAR 7.12及以下版本

**利用条件:** 用户解压恶意构造的RAR压缩包，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR压缩软件的严重安全漏洞，被分类为路径遍历（或目录穿越）漏洞。该漏洞允许攻击者通过精心构造的恶意RAR压缩包，绕过WinRAR的文件验证机制，将恶意文件释放到系统中的任意位置，特别是Windows启动文件夹等关键路径，最终导致任意代码执行（RCE）。受影响的版本主要包括WinRAR 7.12及以下版本。攻击者利用Windows NTFS备用数据流（ADS）特性隐藏恶意负载，并结合RAR5文件头操纵技术来实现路径遍历，从而在用户解压文件时执行恶意操作。

该漏洞的威胁等级被评估为“高危”，并且根据公开披露的信息，它已经被多个境外高级持续性威胁（APT）组织武器化利用。例如，UNC4895（RomCom）、APT44和Turla等团伙被发现在针对乌克兰军事及政府机构的攻击活动中持续利用此漏洞。这些攻击活动通常结合高度定制化的地缘政治相关诱饵进行鱼叉式网络钓鱼，诱骗受害者解压恶意RAR文件。此外，也有报告指出中国境内的非法攻击团伙也利用了此漏洞。WinRAR作为Windows平台广泛使用的压缩工具，其高普及率使得此漏洞的影响范围非常大，对全球用户构成严重威胁。

**POC有效性分析:**
提供的POC是一个名为“CVE-2025-8088 WinRAR Exploit”的Python GUI工具，由“Hexec”开发。该工具旨在自动化WinRAR路径遍历漏洞（CVE-2025-8088）的利用。从README文件来看，该工具功能完善且易于使用。它支持NTFS备用数据流（ADS）来隐藏恶意负载，通过直接操纵RAR5文件头来实现路径注入，并将恶意文件自动放置到Windows启动文件夹。该工具提供了友好的图形用户界面（GUI），以及自定义诱饵文件等功能。其“How It Works”部分详细解释了利用原理，包括ADS创建、RAR构建、文件头修补（注入遍历路径）和CRC重新计算，确保了生成恶意RAR档案的完整性。鉴于详细的说明、功能列表和可视化预览（UI Preview，POC Exploit GIF），该POC被认为是一个完整且高度可用的利用工具。它将复杂的漏洞利用过程封装在一个简单的GUI中，极大地降低了攻击者的技术门槛，使得非专业人士也能构造出有效的恶意RAR文件。

**利用步骤:**
1.  **环境准备:** 攻击者需要安装Python 3.6+、WinRAR命令行工具和`customtkinter`库。
2.  **启动工具:** 运行`python gui.py`启动图形用户界面。
3.  **选择负载:** 在GUI中选择要隐藏并执行的恶意可执行文件（如`.exe`或`.bat`）。
4.  **选择诱饵（可选）:** 选择一个合法的诱饵文件，或者使用工具的默认诱饵文件。
5.  **命名压缩包:** 输入输出的RAR文件名，例如`report.rar`。
6.  **生成:** 点击“Build”按钮，工具将自动构造包含路径遍历漏洞的恶意RAR压缩包。
7.  **分发:** 攻击者通过电子邮件钓鱼、即时通讯工具或其他社交工程手段将恶意RAR文件发送给目标受害者。
8.  **受害者触发:** 受害者被诱骗解压该恶意RAR文件。由于路径遍历漏洞，恶意文件将在解压过程中被释放到攻击者指定的高权限位置（例如Windows启动文件夹），并可能通过ADS特性隐藏起来。
9.  **任意代码执行:** 当受害者系统启动或满足特定条件时，被释放的恶意文件会自动执行，从而实现任意代码执行。

**投毒风险分析:**
对提供的POC代码（README文件内容）进行分析，评估其投毒风险为**低**。
1.  **代码意图明确:** POC的README文件明确声明其用于“教育和授权测试目的”，旨在帮助用户创建恶意RAR档案来利用CVE-2025-8088。其核心功能是生成恶意文件，而非自身带有恶意负载。
2.  **行为分析透明:** “How It Works”部分详细解释了其操作原理，包括ADS创建、RAR文件构建和RAR5文件头修补，这些都是与漏洞利用相关的合法技术，并没有提及任何未经授权的网络通信、数据窃取或后门植入行为。
3.  **依赖库分析:** 工具依赖Python标准库、`customtkinter`和WinRAR CLI，这些都是常见的、用于合法用途的库和工具。README中没有指出使用任何可疑的外部脚本或混淆代码。
4.  **无恶意捆绑迹象:** 在提供的README内容中，没有迹象表明POC工具本身捆绑了额外的恶意软件、广告软件或挖矿程序。作者提供了一些社交媒体链接，但这些是为了社区交流和作者推广，并非直接的恶意行为。
5.  **源码可审计性:** 作为一个Python GUI工具，假定其源代码是可审查的，这有助于安全研究人员验证其行为，确保没有隐藏的恶意功能。如果源代码是开放的，用户可以自行检查其安全性。
综合来看，该POC工具本身是用于“制造”恶意文件的，而非自身携带恶意。因此，在没有发现代码混淆、可疑网络请求或其他非预期行为的情况下，其作为安全研究工具的投毒风险极低。用户在使用时应注意其创建的恶意压缩包，而不是POC工具本身。

**项目地址:** https://github.com/hexsecteam

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
