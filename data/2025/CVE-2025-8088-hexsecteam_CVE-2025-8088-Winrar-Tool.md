## CVE-2025-8088 - WinRAR 路径遍历/目录遍历/任意文件写入/RCE

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录遍历/任意文件写入/RCE

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 所有受影响的WinRAR版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 用户需要解压恶意构造的RAR压缩包。攻击者通常通过钓鱼邮件等社会工程学手段诱导受害者打开并解压恶意文件。无需认证。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重安全漏洞，其核心机制在于WinRAR在处理特制压缩包时，错误地采用了压缩包内嵌的恶意文件路径，而非用户指定的目标路径，从而导致目录遍历（Path Traversal）缺陷。攻击者巧妙利用Windows NTFS备用数据流（ADS）特性和RAR5头部操控技术，可以绕过WinRAR的文件验证机制，将恶意文件写入到系统任意位置，特别是Windows启动文件夹（如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。一旦恶意文件被放置在启动目录，便可在系统重启或用户登录时自动执行，最终实现任意代码执行（RCE），对受害系统造成完全控制。此漏洞已被证实遭到境外高级持续性威胁（APT）组织如UNC4895（RomCom）、APT44、图拉（Turla）以及中国境内非法攻击团伙的武器化利用，针对乌克兰军事及政府机构等目标展开高度定制化的地缘政治相关钓鱼攻击，威胁等级为高危。

**POC有效性分析：**
本漏洞的POC是一个名为“CVE-2025-8088 WinRAR Exploit”的“高级WinRAR路径遍历利用工具”，由Hexec开发。该工具是一个基于Python的GUI应用程序，旨在自动化生成恶意RAR压缩包以利用CVE-2025-8088。其功能强大且完善，具有以下关键特性：
*   **ADS利用**：利用NTFS备用数据流隐藏恶意载荷，增加检测难度。
*   **RAR5头部操控**：直接修改RAR5压缩包头部，注入路径遍历序列（例如：`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`），确保恶意文件被释放到目标系统的特定路径。
*   **图形用户界面（GUI）**：提供直观友好的用户界面，极大降低了利用此漏洞的技术门槛，使不具备深厚技术背景的攻击者也能快速生成高危恶意RAR文件。
*   **启动项投递**：专门设计用于将载荷放置在Windows启动目录中，从而实现持久化和系统启动时的自动执行。
*   **自定义诱饵支持**：允许攻击者选择一个无害的诱饵文件，使其在解压时显示，进一步增强社会工程学攻击的隐蔽性。
该工具的工作流程包括ADS创建、使用WinRAR CLI构建基础RAR文件、注入路径遍历补丁到RAR5头部，以及重新计算CRC校验和以确保压缩包的完整性。考虑到其完整的功能、详细的文档和已验证的“在野”利用情况，该POC被评为10分（完整利用），是当前针对CVE-2025-8088威胁的有效利用工具。

**利用步骤：**
1.  **环境准备**：攻击者需安装Python 3.6+、`customtkinter`库以及WinRAR命令行工具（WinRAR CLI）。
2.  **启动工具**：运行`python gui.py`启动图形化漏洞利用工具。
3.  **选择载荷**：攻击者选择预设的恶意可执行文件（如`.exe`、`.bat`等）作为最终在受害者系统上执行的载荷。
4.  **选择诱饵（可选）**：攻击者可选择一个无害的诱饵文件（如图片、文档）用于迷惑受害者。
5.  **命名压缩包**：攻击者为生成的恶意RAR压缩包指定文件名（如“紧急报告.rar”、“发票信息.rar”）。
6.  **生成恶意压缩包**：点击“Build”按钮后，工具会自动执行以下操作：
    *   创建NTFS备用数据流并嵌入载荷。
    *   调用WinRAR CLI构建基础RAR压缩包。
    *   篡改RAR5头部，注入目录遍历路径，将载荷指向如Windows启动文件夹。
    *   重新计算CRC校验和，以保持压缩包的合法性。
7.  **投递攻击**：攻击者通过鱼叉式钓鱼邮件、恶意网站下载等社会工程学手段，诱导受害者下载并解压恶意RAR压缩包。
8.  **受害者交互**：当受害者使用未打补丁的WinRAR版本解压该恶意压缩包时，漏洞被触发，恶意载荷将被写入到预设的系统启动目录中，而非用户指定的安全路径。
9.  **任意代码执行**：在受害者系统下次启动或用户登录时，位于启动目录的恶意载荷会自动执行，从而赋予攻击者对受害系统的完全控制权。

**投毒风险分析：**
本次分析的POC，即“CVE-2025-8088 WinRAR Exploit”工具，其公开的`README.md`文件清晰地阐述了其作为WinRAR路径遍历漏洞利用工具的目的和功能。从透明度和意图来看，该工具旨在演示和促进CVE-2025-8088的利用过程，而非隐藏恶意行为。作者Hexec及其相关的“HexSec Social Media”平台，如Telegram、Instagram和GitHub，主要关注工具、教程和漏洞利用社区，这通常表明其致力于安全研究和教育用途。该工具明确表示“仅用于教育和授权测试目的”，尽管这并非绝对保障，但至少表明了创作者的公开意图。

在代码混淆和复杂性方面，根据`README.md`的描述，该工具基于Python和`customtkinter`库，并依赖于WinRAR CLI。未发现任何迹象表明工具本身存在高度混淆的代码、打包技术或反分析措施。这意味着其Python源代码，在被安全研究人员审查时，很可能易于理解和审计，从而降低了隐藏恶意载荷的可能性。此外，该工具在外部依赖和网络活动方面也表现出低风险。它要求通过`pip install -r requirements.txt`安装依赖，这通常是标准的Python包管理方式，未提及任何可疑的外部网络连接（如C2通信、下载额外恶意组件）。它利用本地安装的WinRAR CLI进行压缩包操作，进一步减少了通过网络引入外部威胁的风险。

最重要的是，需要明确区分该POC工具本身与它所生成的“载荷”。该工具的核心功能是帮助用户（攻击者）将**用户选择的恶意载荷**（例如一个后门程序、勒索软件）嵌入到特制的RAR压缩包中，从而在受害者系统上执行。因此，工具本身并非恶意软件，而是用于创建恶意压缩包的工具。安全研究人员在分析POC时，应聚焦于工具是否在其声明的功能之外，秘密地执行了其他恶意操作（例如感染研究人员的系统、窃取数据）。基于现有的`README.md`信息，该工具并未显示出此类额外的恶意行为。

综上所述，运行此POC工具本身的投毒风险被评估为**低风险（10%）**。该工具的意图、功能和实现细节都相对透明，未见隐藏的恶意代码或可疑的网络行为。它依赖于标准库和合法外部程序，且其目的明确为漏洞利用工具的生成。然而，无论POC来源如何，始终建议在隔离、受控的环境中进行测试，以防范任何潜在的未知风险。主要风险在于该工具的产物——恶意RAR压缩包被滥用，而不是工具本身对研究人员的威胁。

**项目地址:** https://github.com/hexsecteam/CVE-2025-8088-WinRAR-Exploit

**漏洞详情:** 
