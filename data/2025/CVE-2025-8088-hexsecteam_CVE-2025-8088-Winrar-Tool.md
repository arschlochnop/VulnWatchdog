## CVE-2025-8088 - WinRAR 路径遍历 / 任意文件写入 / RCE

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 任意文件写入 / RCE

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 诱导用户下载并解压特制的恶意RAR文件

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

【POC有效性分析】该POC项目是一个功能完整的攻击利用工具。它通过Python编写的GUI界面，自动化了CVE-2025-8088漏洞的复杂构造过程。其核心有效性在于结合了NTFS备用数据流（ADS）技术和RAR5格式的头部字段篡改。在WinRAR 7.12及更早版本中，解压逻辑未能正确过滤带有ADS标识的路径名。该工具首先利用WinRAR命令行工具创建包含ADS的基础压缩包，随后通过十六进制级别的文件头修补（Header Patching），将跨目录路径（如大量的 ../ 序列）注入到文件名记录中，并重新计算CRC校验值以确保解压时不报错。经分析，该POC能够精准地将恶意有效负载（Payload）定向到Windows系统的启动目录（Startup），实现持久化执行。这种自动化构造方式大大降低了漏洞利用的门槛，使得非专业攻击者也能生成极其隐蔽的恶意压缩文件，具有极高的实战威胁性。\n\n【利用步骤】1. 准备阶段：在本地环境中安装Python 3.6及以上版本、WinRAR客户端以及所需的GUI库（customtkinter）。2. 配置Payload：通过POC的GUI界面选择一个可执行文件（如.exe或.bat）作为攻击载荷。3. 伪装设置：选择一个正常的文档或图片作为诱饵文件（Decoy），以增强迷惑性。4. 生成文件：点击Build按钮，工具会自动执行ADS创建、RAR5头部修改和CRC重算过程，输出一个看似普通的.rar压缩包。5. 攻击实施：将生成的恶意RAR文件通过邮件钓鱼或社工手段发送给受害者。当受害者使用受影响版本的WinRAR进行解压时，Payload将被静默释放到系统的启动目录中。6. 触发执行：受害者下次重启电脑登录时，恶意程序将自动运行。\n\n【投毒风险分析】该POC项目存在中等偏上的投毒风险。首先，该工具是由名为‘Hexec’的外部开发者在Telegram及社交媒体平台上推广的，其README中包含了大量指向第三方社群（Telegram群组）的链接，这是典型的恶意软件分发者或黑客组织的引流行为。其次，虽然目前的代码主要展示了GUI生成器的逻辑，但其核心依赖项（如gui.py及后续可能下载的二进制组件）并未完全透明化，不排除工具在生成恶意RAR的同时，也会在攻击者的本地主机上留后门或窃取敏感信息的可能性。特别是在‘Quick Start’步骤中要求的pip install操作，如果requirements.txt指向了非官方仓库或包含混淆脚本的包，则存在供应链投毒风险。此外，此类‘Exploit Tool’往往会被二次打包分发，在野外传播过程中极易被加入真正的恶意木马。安全研究员在测试此POC时，必须在完全隔离的沙箱环境中运行，严禁在生产或个人主机上直接执行该项目的安装脚本及GUI程序。

**项目地址:** [https://github.com/hexsecteam/CVE-2025-8088-WinRAR-Exploit](https://www.google.com/search?q=https://github.com/hexsecteam/CVE-2025-8088-WinRAR-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
