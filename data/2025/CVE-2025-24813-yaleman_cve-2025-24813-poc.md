## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** NVD待定，Rapid7评为严重

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires partial PUT feature enabled

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-24813是Apache Tomcat中的一个严重远程代码执行（RCE）漏洞，位于Tomcat的partial PUT功能中。该漏洞允许未经身份验证的攻击者通过构造恶意的PUT请求来执行任意代码。Rapid7的分析表明，该漏洞利用起来相对简单，攻击者可以发送特制的HTTP请求来利用此漏洞。漏洞存在于Apache Tomcat 11.0.0-M1到11.0.2、10.1.0-M1到10.1.34、9.0.0.M1到9.0.98以及8.5.0到8.5.100版本中。其中8.5.x版本已经EOL，但仍然受影响。该漏洞的核心问题在于Tomcat处理PUT请求时，未对输入进行充分的验证和过滤，导致攻击者可以上传包含恶意代码的文件，并在服务器上执行。

POC有效性分析：提供的POC代码（/tmp/vulnwatchdog_c3c8e4c81c5e9989931a8a68cbe68e21/README.md, /tmp/vulnwatchdog_c3c8e4c81c5e9989931a8a68cbe68e21/CLAUDE.md, /tmp/vulnwatchdog_c3c8e4c81c5e9989931a8a68cbe68e21/Dockerfile, /tmp/vulnwatchdog_c3c8e4c81c5e9989931a8a68cbe68e21/Dockerfile.vulnerable）表明这是一个可工作的漏洞利用程序，包含Dockerfile用于构建易受攻击的Tomcat环境以及利用脚本（main.py，未提供完整内容）。README文件提供了详细的设置和使用说明，包括使用Docker构建和运行POC的步骤。POC利用了Java反序列化漏洞，通过ysoserial生成恶意payload，并通过PUT请求发送到目标Tomcat服务器。成功利用此漏洞将允许攻击者在服务器上执行任意代码。

利用步骤：
1.  构建易受攻击的Tomcat环境：使用提供的Dockerfile.vulnerable构建一个包含漏洞的Tomcat服务器。该Dockerfile配置了Tomcat 9.0，并包含易受攻击的commons-collections库。
2.  下载ysoserial：使用download.sh脚本下载ysoserial工具，该工具用于生成Java反序列化payload。
3.  生成恶意payload：使用ysoserial生成一个执行任意命令的payload。
4.  发送恶意PUT请求：使用POC脚本（main.py）将生成的payload作为PUT请求的一部分发送到目标Tomcat服务器。脚本中需要指定目标服务器的地址。
5.  执行任意代码：如果漏洞利用成功，Tomcat服务器将执行payload中包含的任意代码。

投毒风险分析：该POC的投毒风险较低（15%）。主要风险在于ysoserial工具的使用。ysoserial本身是一个合法的渗透测试工具，但也可以被用于恶意目的。此外，POC代码中可能包含一些不必要的依赖项或功能，这些依赖项或功能可能会被滥用。代码仓库结构清晰，未发现明显混淆和恶意行为，依赖库均为常见组件，故判定投毒风险较低。主要风险集中在使用第三方payload生成工具生成payload后，payload本身可能存在恶意代码，但该风险并非POC本身引入。该POC主要依赖Docker环境和标准Python库，恶意行为的可能性较低。综上所述，该POC的投毒风险较低。

**项目地址:** https://github.com/absholi7ly/POC-CVE-2025-24813/

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
