## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12 (Windows版本)

**利用条件:** 用户需要下载并使用受影响版本的WinRAR解压攻击者构造的恶意压缩文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-8088是WinRAR软件中存在的一个严重路径遍历漏洞。该漏洞的根源在于WinRAR在处理Windows NTFS备用数据流（ADS）及特定路径序列时，未能进行充分的边界检查和过滤。攻击者可以通过构造特殊的RAR文件，利用ADS特性（如'filename::$DATA'）配合路径遍历字符（'../'），绕过WinRAR的安全提取限制。【POC有效性分析】：提供的Python脚本是一个高度功能化的漏洞利用工具。它首先通过`reportlab`库伪造了一个看起来非常专业的PDF简历（Alicia_Sheree_CV.pdf），这种社会工程学手段极大地提高了诱导用户点击的可能性。在技术实现层面，脚本定义了多层深度的路径遍历模式（从1层到10层不等），旨在覆盖不同的用户系统环境。其核心逻辑在于构造RAR5格式的头部信息，通过注入`RELATIVE_DROP_PATH`（即Windows启动目录路径），试图将恶意Payload（payload.bat）持久化到目标系统中。虽然代码片段在简历生成部分较为冗长，但其针对RAR文件结构的操纵逻辑清晰，具备极高的实战转化率。【利用步骤】：1. 攻击者运行Python脚本，生成包含诱导性PDF和隐藏路径遍历指令的恶意RAR压缩包；2. 攻击者通过邮件、社交软件或下载站传播该RAR文件；3. 受害者使用WinRAR 7.12或更早版本打开并选择‘解压到当前文件夹’或‘解压到...’；4. 漏洞触发，WinRAR将隐藏的payload.bat释放到系统的`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\`目录下；5. 受害者下次重启电脑时，恶意脚本自动执行。【投毒风险分析】：该POC代码的投毒风险评级为15%，属于较低风险。代码主要使用了标准库（os, sys, struct等）以及常见的第三方库（reportlab）。虽然脚本中包含生成payload.bat的行为，但这属于漏洞利用演示（PoC）的标准范畴，用于证明文件能够被成功释放到启动项。代码结构透明，没有发现恶意混淆、动态下载远程执行脚本（如curl/wget恶意服务器）或窃取本地凭据的后门逻辑。不过，由于其生成的简历内容极其逼真，防御研究人员在测试时应确保在隔离的沙箱环境中运行，防止脚本生成的exploit.rar被意外解压到宿主机系统。代码中引入`reportlab`虽然是为了增加迷惑性，但也可能被用于承载更复杂的PDF漏洞利用，需警惕此类复合型攻击脚本。总体而言，该代码是合法的安全研究工具，但其生成的成品具有较强的实战危害。建议安全团队在分析此类POC时，重点关注其RAR头部构造函数中对ADS流的操作逻辑，这是该漏洞防御的核心检测点。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088-Exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088-Exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
