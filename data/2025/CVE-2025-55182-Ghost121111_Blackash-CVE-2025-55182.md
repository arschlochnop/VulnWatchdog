## CVE-2025-55182 - React Server Components / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未补丁版本)

**利用条件:** 无需认证，远程网络访问受影响的 React Server Function 端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，属于 React Server Components (RSC) 中的不安全反序列化漏洞。经过分析提供的 Python POC 代码，其利用逻辑非常直接且高度有效。POC 通过构造恶意的 `multipart/form-data` 请求，针对 `/_next/static/chunks/react-flight` 或类似的 RSC 序列化端点发送 payload。代码中核心的有效负载利用了 JavaScript 的动态函数构造，通过 `{"__type":"Function","code":"..."}` 语法强制 React 后端在反序列化过程中执行任意 Node.js 代码。该 POC 包含了三种不同的 Payload 变体，分别针对 Linux (Bash)、通用环境 (Netcat 管道) 以及 Windows (PowerShell) 环境，这种多平台适配性显著提高了其实际环境下的成功率。代码使用了标准的 `requests` 库，逻辑清晰，没有依赖复杂的第三方库，其模拟的 HTTP 报文结构与 React 处理 RSC 数据流的协议完全吻合。利用步骤：1. 攻击者确定目标 Next.js 或 React 19 应用的 URL；2. 准备接收反弹 Shell 的监听服务器（如使用 nc -lvnp）；3. 运行脚本并提供目标 URL 和监听地址；4. 脚本向服务器发送带有特定 `__type: Function` 标记的序列化 JSON 对象；5. 服务端解析该对象时触发代码执行，从而反连回攻击者的监听器。投毒风险分析：该 POC 的投毒风险评估为低（15%）。虽然它是一个威力巨大的 RCE 利用工具，但从代码结构上看，其行为是透明且符合预期的。脚本主要由标准的 Python 环境库（sys, requests, time）构成，没有发现混淆代码、外部加密下载器或试图修改本地攻击者系统的行为。代码中明确指出了 payload 的内容，即常见的反弹 Shell 指令，这对于安全研究员来说是易于审计的。主要的风险点在于此类 POC 往往被非法修改并重新分发，但在当前分析的这份源码中，并未发现除了攻击目标之外的非法后门。脚本开头的注释指向了 GitHub 仓库，这种公开透明的发布方式通常比匿名发布的混淆脚本更具可信度。然而，防御者在下载此类利用脚本时仍需在沙箱环境中运行，以防其中包含未被察觉的针对本地执行环境的探测行为。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
