## CVE-2025-55182 - React Server Components / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (预测)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x

**利用条件:** 未经身份验证的网络访问，目标启用了 React Server Functions (RSC)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对CVE-2025-55182漏洞，这是一个存在于React Server Components (RSC)中的严重反序列化漏洞，被称为‘React2Shell’。分析POC代码可知，其核心逻辑是通过向`/_next/static/chunks/react-flight`端点发送构造好的`multipart/form-data`请求。该请求中包含一个伪造的JSON对象，利用了React 19在处理服务端函数调用时的反序列化缺陷。攻击者通过注入`__type: Function`并配合Node.js的`child_process`模块，实现了从不安全的数据结构转换到任意系统命令执行的跳跃。POC中集成了三种不同类型的Payload：针对Linux环境的Bash交互式Shell、作为备选的管道符Netcat反向连接，以及针对Windows/Azure环境的PowerShell代码。脚本通过自动遍历这些Payload并发送POST请求，极大地降低了利用门槛。经评估，该POC在未修复的Next.js 15+环境下具有极高的成功率，能够直接获取系统底层的命令执行权限，属于高威胁级别的武器化利用工具。利用步骤通常包括：1. 环境准备，确保安装Python requests库；2. 启动本地监听器（如nc -lvnp 4444）；3. 执行脚本并指定目标URL与本地监听IP/端口；4. 脚本循环发送三种Payload，直到目标服务器建立反向连接。【投毒风险分析】在对此公开的POC代码（源自Github: Ashwesker/Blackash-CVE-2025-55182）进行静态分析后，发现其主要风险在于代码的传播渠道而非脚本本身的恶意隐藏逻辑。代码逻辑清晰，使用的是标准的Python requests库进行网络请求，且Payload内容透明，均显式定义在`payloads`列表中，没有发现混淆处理、外部加密下载器或针对执行者本机的后门行为（如窃取环境变量、SSH密钥等）。脚本中虽然包含了反弹Shell代码，但这是作为漏洞利用的验证目的，明确指向用户输入的`LHOST`。然而，由于该漏洞影响范围极广且POC极其简单易用，该脚本极易被修改并集成到蠕虫病毒或自动攻击工具中。风险评估为15%，主要源于其武器化程度高，可能吸引初级攻击者（脚本小子）直接运行来源不明的变体版本，而这些变体可能被第三方二次加工植入恶意逻辑。防御建议是组织应立即检查React版本并升级至官方发布的修复补丁，同时在WAF层面拦截包含`__type: Function`等异常JSON结构的RSC请求。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
