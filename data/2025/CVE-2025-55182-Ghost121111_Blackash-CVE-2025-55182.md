## CVE-2025-55182 - React Server Components / Next.js RCE (反序列化/不安全函数调用)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (反序列化/不安全函数调用)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** React Server Components 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x

**利用条件:** 无须身份验证，目标开启了 React Server Functions 终端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，是 React Server Components (RSC) 中的一个灾难性漏洞。根据 POC 代码分析，该漏洞的根源在于 React 19 处理服务器组件序列化数据时的逻辑缺陷。利用代码通过向 `/_next/static/chunks/react-flight` 路径发送恶意的 `multipart/form-data` 请求。其核心 Payload 构造了一个包含 `__type: Function` 的 JSON 对象，其中 `code` 字段利用 Node.js 的全局对象 `global.process.mainModule.require` 调用 `child_process` 模块的 `exec` 函数。由于 React 后端在处理此类特定反序列化对象时未进行足够的类型校验和沙箱隔离，导致攻击者可以绕过身份验证执行系统级命令。POC 脚本中包含针对 Linux (Bash/Netcat) 和 Windows (PowerShell) 的多种 Payload，证明了该漏洞具有极高的通用性和武器化价值，攻击者只需获取目标 URL 即可一键获得反弹 Shell。利用步骤：首先，攻击者在本地使用 `nc -lvnp` 启动监听。其次，运行攻击脚本，指定目标 URL 和攻击者的 LHOST:LPORT。脚本会自动向目标的 React Flight 终端点发送三个不同的 Payload。如果目标环境存在漏洞且未配置 WAF 拦截，Payload 会触发 Node.js 后端的函数执行逻辑，通过 `child_process.exec` 将 Shell 回连至攻击者机器。投毒风险分析：该 POC 的投毒风险被评估为较低（15%）。代码使用了标准的 Python `requests` 库和 `sys`、`time` 模块，逻辑透明，主要功能集中在构造 HTTP 请求上。Payload 部分虽然包含恶意的反弹 Shell 命令，但这是为了证明 RCE 漏洞的危害性，而非针对 POC 使用者的投毒行为。脚本中没有发现 `base64` 混淆、非预期的 Socket 连接到第三方 IP 或读取本地敏感文件（如 `.ssh` 或 `.env`）的行为。GitHub 链接指向了一个相对公开的项目，符合安全研究员发布 POC 的惯例。尽管如此，使用者在运行此类 POC 时仍应在隔离的沙箱环境中执行，因为 POC 代码声明支持 'Instant Reverse Shell'，如果不慎配置错误，可能导致非预期的网络流量或系统行为。总的来说，该 POC 是一份高质量的防御性研究样本，直接展示了 React 19 在反序列化处理上的安全短板。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
