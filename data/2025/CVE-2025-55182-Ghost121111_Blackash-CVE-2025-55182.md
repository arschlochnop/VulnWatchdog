## CVE-2025-55182 - React Server Components / Next.js RCE (不安全反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全反序列化)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x

**利用条件:** 无须身份验证，远程网络访问受影响的React Server Function端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（被社区称为React2Shell）源于React Server Components（RSC）在处理客户端请求时存在不安全的反序列化逻辑。根据提供的POC代码分析，漏洞点位于`/_next/static/chunks/react-flight`等处理React Flight数据流的端点。利用代码通过构造恶意的`multipart/form-data`请求，在Payload中注入了特定的JSON序列化对象。该对象利用了React内部对`__type: Function`的处理机制，通过Node.js的`global.process.mainModule.require`方法加载`child_process`模块，并调用`exec`函数执行系统命令。POC展示了三种不同操作系统的Payload：针对Linux的Bash反弹Shell、针对无特定工具环境的Mkfifo反弹Shell，以及针对Windows环境的PowerShell反弹Shell。代码逻辑清晰，能够自动化完成从目标探测到Payload投送的全过程。经评估，该POC在未打补丁的Next.js 15/16环境中具有极高的成功率，属于一键式攻击工具，利用难度极低，威胁程度极高。其核心逻辑直接利用了RSC反序列化时的代码执行路径，证明了该漏洞可以实现完全的服务器控制。【利用步骤】1. 环境准备：攻击者在公网VPS上使用`nc -lvnp <port>`开启监听。2. 目标确定：确认目标应用使用了受影响版本的React或Next.js。3. 构造请求：发送POST请求至目标路径，Content-Type设置为包含随机Boundary的表单数据。4. 注入Payload：在表单字段中注入包含恶意JS代码的JSON对象，尝试通过`require('child_process').exec`执行反弹命令。5. 获取权限：目标服务器解析恶意对象并执行命令，攻击者在监听端获得系统Shell。【投毒风险分析】该POC代码虽然具有极强的攻击性，但从代码结构和行为模式上看，其投毒风险相对较低，处于受控范围。代码主要使用了Python标准库`requests`、`sys`和`time`，没有引入混淆后的Base64编码块、未知的外部加密库或远程下载执行脚本（如通过curl下载二进制文件）。代码中虽然包含反弹Shell的Payload，但这些Payload的目的是针对受攻击的Target（目标服务器），而非运行脚本的Researcher（研究员）。代码逻辑完全透明，没有任何尝试扫描本地敏感文件（如~/.ssh/id_rsa）、窃取浏览器凭据或将本地环境变量发送至第三方服务器的行为。GitHub链接指向的是公开的安全研究仓库。尽管如此，安全研究员在运行此类高威力利用代码时，仍应在隔离的沙箱环境或虚拟机中操作，以防止误操作或潜在的隐藏漏洞导致本地系统受损。该POC的作者在代码中明确标注了用途和原理，没有表现出恶意投毒者的隐蔽性特征。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
