## CVE-2025-55182 - React Server Components (RSC) / Next.js Framework RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js Framework

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需认证，远程网络访问，目标开启了 React Server Functions / App Router 且未应用安全补丁

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被命名为 React2Shell，是一个存在于 React Server Components (RSC) 负载处理中的严重不安全反序列化漏洞。通过分析提供的 POC 代码，攻击者通过构造一个特殊的 multipart/form-data 请求，向 `/_next/static/chunks/react-flight` 或类似的 React Server Function 端点发送恶意 Payload。该 Payload 利用了 RSC 在处理序列化数据时对 `__type: Function` 的解析逻辑，通过 JavaScript 的 `global.process.mainModule.require('child_process').exec()` 直接在服务器后端执行系统命令。POC 中集成了三种不同类型的 Payload：针对 Linux 环境的 Bash 反向 Shell、基于 FIFO 管道的 Netcat 反向 Shell 以及针对 Windows/Azure 环境的 PowerShell 反向 Shell。经分析，该 POC 逻辑严密，利用过程无需任何前置认证（Pre-authentication），且 Payload 构建精准，能绕过基础的输入过滤。只要目标环境版本符合且未进行安全加固，该 POC 具有极高的实战成功率。利用步骤：1. 准备处于公网或目标可达环境的监听主机，使用 `nc -lvnp <port>` 开启监听。2. 攻击者运行 Python 脚本，指定目标 URL 以及监听者的 IP 和端口。3. 脚本会自动构造包含恶意 `__type: Function` 序列化对象的 POST 请求。4. 脚本通过 multipart 边界封装 Payload 并发送至受影响的 React Flight 处理接口。5. 服务器解析恶意对象并触发命令执行，向攻击者主机回连 Shell。投毒风险分析：该 POC 代码主要使用了 Python 标准库中的 `requests`、`sys` 和 `time`，整体逻辑清晰易读，主要功能集中在 Payload 的字符串拼接和 HTTP 请求的发送。代码中未发现明显的混淆、外部恶意域名回连或敏感信息窃取逻辑。脚本中包含的 Reverse Shell 字符串属于预期的漏洞利用功能，而非针对攻击者本机的后门投毒。然而，考虑到此类高价值漏洞（RCE 10.0）的敏感性，虽然当前脚本表面安全，但用户在运行来自第三方 GitHub 仓库（如 Ashwesker/Blackash-CVE-2025-55182）的代码时仍需警惕。潜在风险在于：1. 仓库所有者可能会在后续更新中引入针对执行者的信息收集脚本（如获取执行者的系统环境变量或 SSH Key）。2. POC 中提供的 Bash/PowerShell 指令如果被修改，可能在特定环境下导致非预期的本地破坏。目前评估其投毒风险较低，属于标准的漏洞研究脚本，但仍建议在隔离的沙箱环境中进行测试。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
