## CVE-2025-55182 - Next.js / React 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js / React

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Next.js 15.x, 16.x (15.0.0 之前的版本及特定 React 19 环境)

**利用条件:** 无需身份验证，目标系统开启了 App Router 且未修补 React Server Components (RSC) 解析逻辑。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是 Next.js 生态中极其严重的远程代码执行漏洞。核心成因在于 React Server Components (RSC) 在处理特定格式的 `multipart/form-data` 请求时，未能对 `react-flight` 数据的解析过程进行充分的安全检查。通过分析提供的 POC 代码（CVE-2025-55182-revshell.py），攻击者构造了一个特殊的 JSON 负载，其中包含 `"__type":"Function"` 键值对。当 Next.js 服务端尝试反序列化此负载时，由于 React 19 在某些环境下的内部逻辑缺陷，它会意外执行 `code` 属性中的内容。该 POC 巧妙地利用了 Node.js 全局对象 `global.process.mainModule.require` 来调用 `child_process.exec`，从而在服务器底层执行任意系统命令。利用步骤如下：1. 确认目标系统运行受影响的 Next.js 版本；2. 设置本地监听器（如 nc -lvnp 4444）；3. 发送带有特定 boundary 和恶意的 JSON payload 的 POST 请求至 `/_next/static/chunks/react-flight`；4. 服务器解析 payload 时触发命令执行，回连攻击者机器。该 POC 涵盖了 Linux（Bash、Mkfifo）和 Windows（PowerShell）的 payload，具有极高的实战化程度。投毒风险分析：针对此类‘史诗级’漏洞的 POC 往往是供应链投毒的高发区。分析当前获取的代码，其逻辑清晰，使用了标准的 Python `requests` 库，未发现明显的代码混淆、外部非法域名的回传操作或 Base64 隐藏的恶意指令。脚本末尾的 `User-Agent` 被设置为 `Mozilla/5.0 (CVE-2025-55182)`，这是一种典型的漏洞扫描特征，而非恶意木马特征。然而，在 GitHub 或社交媒体上流传的其他变种 POC（如搜索结果中提到的 lachlan2k 项目）可能包含‘一键部署’脚本，研究人员需警惕其在执行漏洞验证的同时，在本地环境中静默安装浏览器插件或窃取 `.ssh` 密钥。目前的脚本虽为正向安全研究工具，但其‘即插即用’的特性极易被集成到恶意僵尸网络中。研究人员在下载此类 POC 时，应重点检查 `requests.post` 以外的系统调用，确保不会反向感染研究员主机。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
