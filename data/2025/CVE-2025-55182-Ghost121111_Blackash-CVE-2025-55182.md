## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未打补丁版本)

**利用条件:** 无需认证，远程网络访问，目标开启了 React Server Components (如 Next.js App Router)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：本漏洞名为 React2Shell，是一个由于 React Server Components (RSC) 在处理序列化数据时未对 __type 为 Function 的对象进行严格校验而导致的不安全反序列化漏洞。提供的 Python POC 代码展示了极高的有效性。它通过构造一个包含恶意 JSON 载荷的 multipart/form-data POST 请求，直接命中 Next.js 默认的 /_next/static/chunks/react-flight 接口或类似的 RSC 端点。核心 payload 利用了 Node.js 环境下的 global.process.mainModule.require 链，能够绕过常规的安全限制执行 child_process.exec。该 POC 针对不同操作系统环境准备了三套 Payload：Bash 反弹 shell、Netcat 命令链以及 PowerShell 脚本。这意味着该漏洞具有极强的跨平台兼容性，在 Windows (Azure/IIS) 和 Linux (Vercel/Self-hosted) 环境下均可实现一键 RCE。利用步骤：1. 确认目标使用受影响版本的 React/Next.js 并启用了 App Router。2. 攻击者在本地准备监听程序，如执行 nc -lvnp 4444。3. 运行 Python 攻击脚本，指定目标 URL 和攻击者的 LHOST:LPORT。4. 脚本构造 HTTP POST 请求，将包含恶意反序列化逻辑的 payload 发送至目标的 RSC 处理路径。5. 服务器解析请求时触发函数反序列化，执行系统命令。6. 攻击者在监听端获得目标服务器的交互式 Shell。投毒风险分析：该 POC 代码逻辑清晰，主要使用了 Python 标准库 requests、sys 和 time，没有引入经过混淆的外部依赖或异常的二进制包，符合防御性安全研究的规范。虽然脚本中包含了反弹 Shell 的指令，但这属于漏洞利用验证（Exploit Logic）的必要组成部分，而非针对分析者本人的投毒行为。脚本中提到的 GitHub 链接（Ashwesker/Blackash-CVE-2025-55182）需要谨慎访问，因为此类高危漏洞的早期公开仓库经常被黑客利用进行‘黑吃黑’攻击，可能在安装依赖阶段（setup.py）注入恶意代码。目前分析的这段 Python 代码本身风险较低，仅执行了定义的攻击逻辑。但由于其利用门槛极低且破坏力巨大，安全人员在测试时应确保在隔离环境（Sandbox）中运行，并注意 POC 是否存在隐蔽的 HTTP 回连，将其攻击流量重定向至第三方监控服务器。整体而言，该代码具有极强的实用性，但也伴随着较高的滥用风险。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
