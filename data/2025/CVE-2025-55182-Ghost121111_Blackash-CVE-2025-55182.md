## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React Server Components 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x / 16.x (未打补丁版本)

**利用条件:** 无需身份验证，远程网络访问受影响的 React Server Function 端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（React2Shell）源于React Server Components（RSC）在处理反序列化时的严重缺陷。攻击者通过向 `/_next/static/chunks/react-flight` 或相关的 Server Function 接口发送精心构造的 Multipart 请求，可以在 `__type: Function` 字段中注入恶意的 JavaScript 代码。POC代码显示，利用方式极其直接：利用 Node.js 的 `global.process.mainModule.require('child_process').exec` 直接执行系统命令。此 POC 提供了针对 Linux (Bash/Mkfifo) 和 Windows (PowerShell) 的三种反弹 Shell 负载，覆盖面广且成功率极高。代码逻辑清晰，通过 Python 的 requests 库模拟 HTTP POST 请求，不仅验证了漏洞的存在性，还实现了全自动化的远程控制。这种‘开箱即用’的特性使得该 POC 在野外极具威胁。漏洞的根源在于 React 19 引入的 RSC 序列化机制未对函数类型对象进行严格的安全边界校验，导致预身份验证阶段即可触发恶意代码执行。【利用步骤】1. 确定目标是否存在 React 19 或 Next.js 15+ 框架；2. 设置本地监听器（如 `nc -lvnp 4444`）；3. 运行 POC 脚本，指定目标 URL 和本地监听 IP/端口；4. POC 构造包含恶意 `Function` 类型 JSON 的 Multipart 负载；5. 服务器解析请求时误将负载作为函数执行，触发反弹 Shell。【投毒风险分析】在对此 POC 源代码（CVE-2025-55182-revshell.py）进行审计后，发现其主要逻辑围绕合法的防御性安全研究和渗透测试展开。代码未发现明显的混淆、加密或向非指定地址发送敏感信息的行为。Payloads 明确指向用户输入的 LHOST，符合安全工具的行为规范。然而，由于该脚本来源于第三方个人仓库（Ashwesker/Blackash-CVE-2025-55182），且该漏洞属于‘零日/新近’高价值漏洞，存在被攻击者利用作为钓鱼工具的潜在风险。此类 POC 容易被修改并重新发布，在其中嵌入二阶后门（如在执行反弹 Shell 的同时偷偷上传本地 SSH 密钥或凭证）。目前的 15% 风险评分主要基于仓库的可信度审查和自动化工具下载执行风险，建议安全研究员在隔离环境下运行，并仔细检查 `requests` 请求头或任何隐藏的 `exec/eval` 语句。该脚本使用了标准的 Python 库，暂无恶意的外部依赖投毒迹象。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
