## CVE-2025-55182 - React Server Components (Next.js App Router) RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (Next.js App Router)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需认证，远程网络访问受影响的React Server Function端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2025-55182漏洞提供了极其完整且自动化的利用实现。漏洞根源在于React Server Components (RSC) 在处理客户端提交的数据时存在不安全的反序列化逻辑。POC通过构造特定的多部分表单数据 (multipart/form-data)，向目标端点 `/_next/static/chunks/react-flight` 发送经过特殊设计的 JSON 负载。该负载利用了 React 内部对 `__type: Function` 的解析逻辑，通过 `global.process.mainModule.require` 注入 Node.js 的 `child_process` 模块并调用 `exec` 函数。POC包含了针对 Linux (Bash/Netcat) 和 Windows (PowerShell) 的三种不同反向 Shell 载荷，通过循环尝试确保了在不同操作系统环境下的高成功率。代码逻辑清晰，依赖项仅为标准的 `requests` 库，且利用路径直击 Next.js 的核心路由，具有极高的实战价值和威胁性。利用步骤：1. 攻击者准备监听环境，如使用 `nc -lvnp <LPORT>`。2. 运行 Python 脚本，指定目标 URL 和攻击者 IP/端口。3. 脚本自动构造含有恶意 JSON 的 multipart 请求。4. 目标服务器解析 RSC 数据流时触发反序列化，执行 `child_process.exec`。5. 服务器向攻击者机器发起反弹连接，攻击者获得系统 shell。投毒风险分析：该代码片段目前表现为清晰的安全研究和渗透测试工具。代码结构透明，没有发现明显的代码混淆（Obfuscation）或加密的外壳。核心攻击逻辑直接暴露，易于审计。主要的潜在风险在于脚本引用了外部 Github 仓库 (Ashwesker/Blackash-CVE-2025-55182)，如果用户从不可信的来源下载衍生版本，可能被植入二次后门。然而，就当前分析的代码本身而言，其执行的行为完全符合其声称的反向 Shell 功能，并未发现隐藏的第三方外联请求、本地文件窃取或敏感凭据上传等典型的投毒特征。脚本中的 `User-Agent` 被自定义为漏洞编号，这在实战中实际上增加了被安全设备（如 WAF）发现的概率，而非隐蔽攻击，符合防御性研究工具的特征。尽管如此，由于此类 RCE 脚本具有高度破坏性，仍建议在隔离的沙箱环境中使用，以防脚本在后续更新中引入恶意逻辑。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
