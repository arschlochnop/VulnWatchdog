## CVE-2025-55182 - Next.js / React Server Components RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Next.js / React Server Components

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Next.js 15.x, 16.x (截止至2025年12月前版本), React 19 系列

**利用条件:** 无需身份验证，目标服务器启用了 React Server Components (RSC) 或 Next.js App Router 模式，且未安装最新安全补丁。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞属于极其严重的预认证远程代码执行（RCE）。分析提供的Python POC代码可知，攻击者利用了Next.js/React在处理服务器组件（React Server Components, RSC）反序列化过程中的缺陷。具体的攻击入口位于 `/_next/static/chunks/react-flight` 接口。攻击载荷通过 `multipart/form-data` 格式发送，核心Payload通过伪造 `__type: Function` 的JSON对象，直接调用Node.js全局环境中的 `global.process.mainModule.require` 来加载 `child_process` 模块，从而执行系统级命令。代码中提供了三种Payload，分别针对Linux（Bash反弹Shell）、通用Unix（FIFO管道反弹Shell）以及Windows/Azure（PowerShell反弹Shell），这表明该漏洞具有极高的跨平台通用性和实战打击能力。POC通过循环发送多组载荷来确保成功率，且完全无需任何前置鉴权，这验证了该漏洞被称为‘核弹级’的真实性。其利用逻辑清晰，绕过了常规的输入验证，直接作用于React底层的Flight协议解析层，利用效率极高。经过分析，该POC结构完整，脚本逻辑严密，能够实现一键获取反弹Shell的功能，对未修复的系统构成致命威胁。

【利用步骤】1. 准备攻击环境，安装Python3及其requests库。2. 在攻击机上开启监听，例如使用 `nc -lvnp 4444`。3. 确定目标地址及端口，确认为使用Next.js框架且未打补丁的版本。4. 运行脚本：`python3 CVE-2025-55182-revshell.py <目标URL> <攻击机IP:端口>`。5. 脚本将向目标的 `/_next/static/chunks/react-flight` 路径发送构造好的多段Payload。6. 目标服务器在解析恶意构造的RSC数据包时，会触发Function构造函数或类似的动态代码执行机制。7. 攻击者在监听端即可接收到由目标服务器主动发起的反弹Shell，获取系统控制权。

【投毒风险分析】本样本的投毒风险评定为15%（低风险）。经过对POC源代码的逐行审计，该脚本的主要功能确实是旨在验证CVE-2025-55182漏洞。脚本逻辑透明，使用了标准的Python库（requests, sys, time），没有发现明显的代码混淆或加密手段。脚本中定义的Payload（Bash, NC, PowerShell）是典型的网络安全渗透测试载荷，用于获取交互式Shell，并非针对分析者机器的恶意扣费、数据窃取或勒索行为。虽然脚本中包含了指向第三方Github（Ashwesker/Blackash）的链接，但在提供的代码片段内未发现隐藏的外部脚本下载执行逻辑或向非预期第三方IP发送敏感数据的行为。需要注意的是，此类高度危险的RCE工具在传播过程中极易被第三方二次修改，例如在Payload中植入额外的后门或在执行时偷偷上传分析者的环境变量。但就目前提供的此份特定POC代码而言，其行为符合安全研究员进行合规性测试的预期，暂未发现主动投毒迹象。防御建议：组织应立即自查Next.js版本并升级至官方最新补丁版，同时在WAF层拦截包含 `react-flight` 关键字且含有 `Function` 或 `require` 特征的异常POST请求。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
