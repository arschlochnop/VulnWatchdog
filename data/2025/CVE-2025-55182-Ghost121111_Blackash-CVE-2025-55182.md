## CVE-2025-55182 - React Server Components / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19, Next.js 15.0.0 - 16.0.6

**利用条件:** 无需身份验证，服务器开启了React Server Components (RSC) 功能并暴露了相关端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被安全社区称为『React2Shell』，是一个影响极广的『核弹级』漏洞。通过对提供的Python POC代码分析，其核心原理是利用了React Server Components中的『Flight』协议在反序列化过程中的缺陷。POC针对的是`/_next/static/chunks/react-flight`端点，通过发送一个精心构造的`multipart/form-data` POST请求，注入了一个包含`__type: Function`的JSON对象。其关键Payload利用了Node.js运行时环境下的`global.process.mainModule.require('child_process').exec`方法。这种攻击方式绕过了传统的输入验证，因为它直接作用于React框架底层的序列化流处理层。POC代码展示了极高的有效性，能够针对Linux和Windows环境（包括Azure托管环境）分别发送Bash、Netcat和PowerShell三种反弹Shell指令，实现了真正意义上的『一键RCE』。由于Next.js 15/16版本默认大量采用RSC架构，该POC在未打补丁的目标上几乎是即插即用，且由于是底层协议解析错误，传统的WAF规则若未针对Flight协议进行深度解析，很难有效拦截此类流量。此外，POC中通过循环发送多种Payload的方式增加了攻击的成功率，反映了该漏洞利用链的成熟度。【利用步骤】1. 环境准备：攻击者在公网VPS上开启监听端口（如nc -lvnp 4444）。2. 确定目标：寻找运行Next.js 15+或React 19的Web应用。3. 执行脚本：运行POC脚本并传入目标URL和LHOST:LPORT参数。4. 触发漏洞：脚本构造带有特定Boundary的Multipart请求，Payload注入到名为'0'的表单字段中。5. 建立连接：服务器解析请求时触发Node.js代码执行，反弹Shell连接至攻击者服务器。【投毒风险分析】在对此POC代码进行安全性审计时发现，该代码虽然实现了极具威胁的攻击功能，但其代码逻辑本身相对透明，主要依赖Python标准库`requests`、`sys`和`time`，没有发现明显的恶意代码混淆、外部非法域名请求或隐藏的二进制Payload下载。POC中虽然包含反弹Shell指令，但这是该特定漏洞验证功能的组成部分，属于已知的预期行为，不应直接归类为针对研究员的『反向投毒』。然而，风险点在于：首先，此类高价值POC往往会被二次封装。在GitHub等平台上，可能存在某些克隆仓库在合法的POC代码中植入后门（如在发送Payload的同时，秘密将研究员的本地敏感信息发送至第三方服务器）。其次，该脚本使用了`verify=False`禁用SSL校验，虽然是为了兼容自签名证书，但也可能被用于中间人攻击。最后，脚本头部的自定义User-Agent `Mozilla/5.0 (CVE-2025-55182)`虽具标识性，但也易被防御方检测。综合评估，该POC本身投毒风险较低，属于开源社区常见的漏洞验证脚本，但鉴于漏洞价值极高，建议安全研究员在隔离沙箱环境中运行此类脚本，并警惕非官方来源的修改版本。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components](https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components)
