## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0 (包含 react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack 等包); Next.js 15.x / 16.x (基于 React 19 的版本)

**利用条件:** 无需认证，远程网络访问，目标使用受影响的 React Server Components 渲染机制

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞名为 'React2Shell'，是 React Server Components (RSC) 中的一个灾难性漏洞。根据 POC 代码分析，漏洞核心在于 `/_next/static/chunks/react-flight` 接口对传入的 React Flight 数据流处理不当。攻击者可以通过发送带有特定边界的 `multipart/form-data` 请求，在 payload 中构造恶意的 JSON 对象。该对象包含 `"__type":"Function"` 键值对，这触发了 React 后端对 RSC 流的不安全反序列化。POC 通过注入 `global.process.mainModule.require('child_process').exec()` 成功在 Node.js 环境下执行系统命令。代码中针对 Linux 和 Windows 系统分别提供了 Bash、Netcat 和 PowerShell 三种反向 Shell 载荷，通过多轮尝试确保了极高的利用成功率。此 POC 逻辑清晰，利用方式直接且具备高度的自动化潜力，攻击者只需提供目标 URL 和本地监听 IP 即可获得服务器完全控制权。 【利用步骤】1. 攻击者在本地启动监听服务，如使用 `nc -lvnp 4444`。2. 运行 Python 脚本，指定目标 Next.js 服务器地址及本地监听 IP。3. 脚本向目标的 `/_next/static/chunks/react-flight` 路径发送 POST 请求。4. 请求头中指定 `multipart/form-data` 及其边界值。5. 请求体中包含构造好的恶意 Flight 序列化数据。6. 服务器解析数据时，恶意 Function 被执行，触发反弹 Shell 连接。7. 攻击者在监听端接收到 Shell，完成控制。 【投毒风险分析】该 POC 目前表现为标准的防御性安全研究代码，投毒风险评定为低（15%）。代码使用了 Python 官方的标准库（requests, sys, time），没有引入经过混淆的二进制 blob 或加密的外部依赖。其核心 Payload 虽包含反向 Shell 代码，但这是漏洞利用验证（Vulnerability Validation）的预期行为，并非隐藏在正常功能下的恶意后门。唯一潜在风险点在于代码中包含的 GitHub 项目链接（Ashwesker/Blackash-CVE-2025-55182），在威胁情报实战中，研究员需警惕此类 GitHub 存储库可能在后期更新中替换为包含恶意第二阶段下载器的脚本，或者在 `requirements.txt` 中引入供应链攻击。当前提供的脚本逻辑透明，注释详尽，未发现主动窃取执行者本地敏感信息（如环境变量、SSH Key）的行为，但在生产环境下测试时仍建议在沙箱中进行。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
