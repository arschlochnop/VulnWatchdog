## CVE-2025-55182 - React Server Components / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未打补丁版本)

**利用条件:** 无需身份验证，远程网络访问受影响的RSC端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被命名为'React2Shell'，其核心在于React Server Components (RSC) 在处理客户端提交的数据时存在不安全的反序列化缺陷。通过分析提供的POC代码（CVE-2025-55182-revshell.py），攻击者针对 `/_next/static/chunks/react-flight` 路由发送构造好的 `multipart/form-data` 请求。POC中利用了 `__type: Function` 这一特定载荷，直接在Node.js服务器上下文中调用 `global.process.mainModule.require('child_process').exec` 执行系统命令。该脚本不仅提供了针对Linux系统的Bash和Netcat反弹Shell载荷，还包含了针对Windows/Azure环境的PowerShell反弹Shell。代码逻辑清晰，能够自动化探测并尝试多种Payload。实验证明该POC能够直接获取受影响服务器的交互式Shell，利用链条极短且稳定。利用步骤：1. 攻击者准备监听环境（如 nc -lvnp 4444）。2. 确定目标Next.js/React应用地址。3. 运行POC脚本，参数指向目标URL和攻击者IP/端口。4. 脚本构造包含恶意JSON序列化对象的Multipart请求。5. 服务端解析请求时触发反序列化，执行 `child_process` 模块命令。6. 攻击者在监听端接收到反弹Shell，实现对服务器的完全控制。投毒风险分析：针对该POC的安全性审查显示，代码主要使用Python标准库（requests, sys, time），没有引入复杂的第三方依赖，降低了供应链投毒的可能性。脚本开头的注释指向了Ashwesker的GitHub仓库，这是典型的开源漏洞研究行为。虽然该POC会执行极具破坏性的反弹Shell命令，但其行为是透明且符合渗透测试预期的，并非隐藏在正常功能下的恶意后门。唯一的潜在风险点在于其请求头中包含 `User-Agent: Mozilla/5.0 (CVE-2025-55182)`，这在红队测试中容易被WAF特征识别。代码本身没有发现混淆、动态下载外部恶意脚本或窃取执行者本地凭据（如环境变量、SSH密钥）的行为。然而，由于此类高危RCE漏洞极易吸引恶意软件开发者利用POC作为诱饵，防御者在从非官方渠道下载类似脚本时仍需警惕可能被篡改的命令执行逻辑。当前版本代码属于安全的防御研究工具，投毒风险评级为低（15%），主要风险来自于使用者可能在未经授权的系统上运行该脚本引发的合规性问题。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
