## CVE-2025-55182 - React Server Components (Next.js) RCE (不安全反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全反序列化)

**影响应用:** React Server Components (Next.js)

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack

**利用条件:** 远程网络访问，无需认证 (Pre-authentication)

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为‘React2Shell’，其核心在于React Server Components在处理客户端请求时存在不安全的反序列化缺陷。POC代码显示，攻击者可以向路径 `/_next/static/chunks/react-flight` 发送构造好的 `multipart/form-data` 请求。POC利用了React Flight协议中的特定负载格式，通过传递 `__type: Function` 并在 `code` 字段中注入Node.js代码（如 `global.process.mainModule.require('child_process').exec`），实现了从反序列化到任意代码执行的转化。分析POC中的Payload，其包含了针对Linux环境的Bash反向Shell、针对通用环境的Fifo/Netcat Shell以及针对Windows环境的PowerShell混淆脚本，这表明该漏洞具有跨平台的利用能力。由于漏洞点位于底层的React Server DOM封装包中，使用Next.js App Router的现代Web应用极易受到攻击。POC中的请求逻辑简单直接，通过单个POST请求即可触发执行，证明了该漏洞的高可利用性和高危性。 

【利用步骤】1. 环境准备：攻击者首先在其控制的服务器上启动网络监听（例如 `nc -lvnp 4444`）。2. 确定目标：识别使用受影响版本React/Next.js的Web应用。3. 构造Payload：根据目标操作系统选择合适的反弹Shell指令（Bash/NC/PowerShell）。4. 触发漏洞：使用POC脚本向目标端点 `/_next/static/chunks/react-flight` 发送带有恶意JSON对象的Multipart请求。5. 获取权限：目标服务器在反序列化该对象时会执行注入的代码，将权限反弹回攻击者的监听器，从而获得系统的远程控制权。 

【投毒风险分析】该POC项目来自于非官方的第三方GitHub库，虽然代码逻辑在表面上是直接的功能实现，但存在以下风险点：首先，脚本中包含了多种高度混淆的Shell Payload，特别是针对Windows的PowerShell部分，采用了大量的转义和管道操作，这虽然是利用代码的常见手段，但也为隐藏额外恶意行为（如静默下载后门）提供了可能。其次，脚本直接要求用户输入本地IP和端口（LHOST/LPORT），在缺乏沙箱隔离的环境下运行此类脚本，若脚本内部被篡改，可能会导致安全研究员自己的工作站反向暴露。此外，这类带有‘Instant Reverse Shell’标签的PoC往往是供应量攻击（Supply Chain Attack）的重灾区，攻击者可能通过GitHub Action或类似的恶意分发方式，在PoC脚本中加入信息收集逻辑。经过静态分析，目前的POC代码库属于标准的漏洞利用演示，没有发现明显的第二阶段恶意下载器，但其利用的广泛性意味着存在被恶意分子修改再分发的极高风险。建议在隔离的虚拟化环境中测试，严禁直接在生产环境或连接敏感资产的主机上运行未经审查的脚本。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
