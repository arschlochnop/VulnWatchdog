## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 9.8

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0 (包含 react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack); Next.js 15.x, 16.x

**利用条件:** 未经身份验证的远程网络访问，且目标应用启用了 React Server Components (RSC)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被命名为 'React2Shell'，其根本原因在于 React Server Components (RSC) 在处理客户端传输的数据时存在不安全的反序列化缺陷。具体而言，受影响的版本在解析 `/ _next/static/chunks/react-flight` 路径下的 multipart/form-data 请求时，未能对反序列化的对象类型进行严格校验。POC代码展示了攻击者如何通过构造一个特定的 JSON 负载，利用 `__type: Function` 标识符注入恶意代码。代码片段 `global.process.mainModule.require('child_process').exec(...)` 揭示了攻击者可以直接调用 Node.js 的子进程模块执行系统命令。此 POC 提供了针对 Linux (Bash/Nc) 和 Windows (PowerShell) 的三种不同 Payload，极大地提高了在不同部署环境下的攻击成功率。经分析，该 POC 结构清晰，逻辑完整，通过单次 POST 请求即可触发，验证了该漏洞具有极高的实战威胁。利用步骤：1. 攻击者在本地启动监听器（如 nc -lvnp 4444）。2. 确定目标 Next.js/React 应用的 URL。3. 运行 Python 脚本，脚本会自动构造包含恶意 RSC 序列化载荷的 multipart 请求。4. 请求发送至目标的 RSC 端点（通常为 /_next/static/chunks/react-flight）。5. 目标服务器反序列化该载荷，触发 Function 构造函数执行其中的命令。6. 服务器建立反向连接，攻击者获得 Shell 权限。投毒风险分析：经过对提供的 POC 代码（CVE-2025-55182-revshell.py）进行静态审计，发现其主要逻辑集中在漏洞利用本身。脚本使用了标准的 requests 库，未发现混淆代码或 Base64 隐藏指令。虽然脚本包含执行反弹 Shell 的功能，但这属于 POC 的预期破坏性功能，而非针对安全研究员的投毒行为。脚本头部声明的 Github 来源 (Ashwesker/Blackash-CVE-2025-55182) 需要谨慎对待，因为此类高影响力 RCE 的 POC 经常被恶意行为者修改后重新分发。尽管当前代码片段未见明显恶意后门（如窃取本地环境变量、修改 ~/.bashrc 或上传 /etc/shadow），但该脚本使用了硬编码的 User-Agent 'Mozilla/5.0 (CVE-2025-55182)'，这可能被用于扫描统计。整体投毒风险评级为低（15%），主要风险在于该 POC 的广泛传播可能诱导安全人员在未审计的情况下运行包含类似逻辑但被二次修改的恶意变体。建议在隔离的沙箱环境中使用此类脚本，并严格检查 Payload 部分是否包含非目标的外部 IP 或域名。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
