## CVE-2025-55182 - Next.js / React Server Components 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js / React Server Components

**危害等级:** 严重 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Next.js 15.x, 16.x (2025年12月前版本); React 19 (Server Components相关版本)

**利用条件:** 无需身份验证 (Unauthenticated)，目标服务器启用了 Next.js App Router 或 React Server Components，且存在暴露的 /_next/static/chunks/react-flight 接口。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被形象地称为 'React2Shell'，其核心在于 React Server Components (RSC) 在处理序列化数据时的逻辑缺陷。分析提供的 Python POC 代码可知，攻击者通过向 `/_next/static/chunks/react-flight` 路径发送构造好的 `multipart/form-data` 请求，利用了服务端在反序列化过程中对 `__type: Function` 标识符的处理不当。POC 代码精准地构造了一个 JSON 载荷，该载荷通过 Node.js 的全局 `process.mainModule.require` 调用 `child_process` 模块的 `exec` 函数。这种注入方式可以直接绕过前端路由限制，在服务端执行任意系统命令。代码中包含了针对 Linux (Bash/Netcat) 和 Windows (PowerShell) 的三种不同 Reverse Shell 载荷，通过循环遍历发送，极大提高了攻击的成功率。从防御研究角度看，该 POC 逻辑清晰，利用路径直接，且使用了标准的 `requests` 库，验证了该漏洞具有极高的自动化利用价值。利用步骤：1. 确定目标 Next.js 应用版本，确认其使用了 App Router 模式。2. 准备本地监听器（如 `nc -lvnp 4444`）。3. 执行脚本并传入目标 URL 与本地监听 IP 端口。4. 脚本将特定的恶意外挂载荷封装在 multipart 表单中发送。5. 服务端解析后触发命令执行，反弹 Shell 到攻击者主机。投毒风险分析：经过对提供的两份 POC 脚本进行防御性代码审计，未发现明显的恶意二阶投毒行为。脚本 `CVE-2025-55182-revshell.py` 的行为符合安全研究人员进行漏洞验证（Vulnerability Verification）的预期：它通过命令行参数接收攻击载荷参数，并没有发现将敏感信息（如受害者的环境变量、云服务凭证等）发送到第三方硬编码地址的逻辑。脚本中使用的 `requests.post` 目标严格限制在用户输入的 `target_url`。然而，此类 '一键式' RCE 脚本在开源社区传播极快，容易被黑客修改后重新发布。风险点在于：首先，代码中虽未发现混淆，但对于 `PowerShell` 载荷的构造较为复杂，初级研究员可能无法一眼识破其中是否夹带了额外的下载执行指令。其次，此类脚本常被打包进包含恶意依赖的工具包中。当前 POC 属于清洁的验证代码，但在实际情报采集过程中，必须警惕来自非官方仓库（如 GitHub 上的新注册账号）提供的类似脚本，防止其在 `pip install` 阶段或通过隐藏的 `import` 钩子注入后门。对于本 POC，主要的风险来自于其强大的破坏力而非代码本身的隐蔽投毒。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
