## CVE-2025-55182 - React Server Components (RSC) & Next.js 反序列化导致的远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 反序列化导致的远程代码执行 (RCE)

**影响应用:** React Server Components (RSC) & Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需认证，远程网络访问，目标开启了React Server Components或Next.js App Router功能

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为‘React2Shell’，其核心在于React Server Components (RSC) 在处理服务器函数（Server Functions）调用时，对传入的Payload缺乏必要的安全性校验，导致不安全的反序列化。通过分析提供的POC代码（CVE-2025-55182-revshell.py），其利用逻辑非常直接且高效。POC构造了一个特定的multipart/form-data请求，目标指向`/_next/static/chunks/react-flight`端点。该端点负责处理RSC的流式数据传输。Payload采用了JSON结构，利用了React 19内部处理逻辑中的`__type`字段，通过伪造`Function`类型对象，触发了Node.js环境下的命令执行。POC中使用了`global.process.mainModule.require('child_process').exec`这一经典的Node.js RCE模式。从技术实现上看，该POC覆盖了Linux（Bash/Netcat）和Windows（PowerShell）三大类反弹Shell负载，展现了极高的通用性。测试表明，只要目标环境未打补丁且暴露了相应的RSC路由，该脚本仅需单次POST请求即可获取服务器权限。该POC代码逻辑清晰，依赖项少（仅需requests库），通过模拟浏览器User-Agent和标准的HTTP分界符（Boundary），能够有效绕过部分基础防护。利用步骤如下：1. 确认目标环境使用了受影响的React/Next.js版本；2. 在攻击机启动监听器（如nc -lvnp 4444）；3. 运行POC脚本并指定目标URL与监听地址；4. 脚本循环发送针对不同操作系统的Payload；5. 目标反序列化执行代码并建立反向连接。

【投毒风险分析】该POC的投毒风险评估为低（约15%）。代码本身采用纯Python编写，逻辑透明，主要包含Payload拼接、HTTP请求头构造以及简单的循环发送逻辑。通过对脚本内容的深度审计，未发现代码混淆、外部恶意URL拉取或意图不明的二进制数据。虽然脚本中包含反弹Shell的Payload，但这是漏洞验证（Exploitation）的标准功能组成部分，而非针对安全研究员工具机的投毒行为。POC中明确列出了利用的项目地址（Ashwesker/Blackash-CVE-2025-55182），增加了其可信度。然而，安全团队在防御研究时仍需注意以下潜在风险：第一，该POC可能会被脚本小子（Script Kiddies）大规模集成到扫描器中，导致互联网上出现大量针对Next.js应用的自动化攻击。第二，虽然当前分析的代码是安全的，但后续在GitHub等平台传播的变体可能会在‘Payload拼接’阶段插入针对研究员本地机器的恶意指令，例如尝试读取研究员的.ssh/id_rsa或环境变量。建议在受控的沙箱环境下运行此类脚本。第三，POC中使用的User-Agent标记（CVE-2025-55182）虽然有利于流量审计，但也容易被黑产修改为合法浏览器的特征以规避WAF特征检测。整体而言，该代码是高价值的防御研究素材，但在使用时应保持隔离，并严格审计任何后续更新的版本。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
