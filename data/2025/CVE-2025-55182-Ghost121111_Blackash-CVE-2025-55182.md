## CVE-2025-55182 - React Server Components / Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, 16.x (截止2025年12月未修补版本), React 19

**利用条件:** 无需身份验证，目标启用了 React Server Components (RSC) 且路径可访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为‘战略核导弹’级别，其核心在于 React Server Components (RSC) 在处理服务器端渲染请求时，未能对传入的序列化对象进行严格校验。提供的 POC 代码展示了通过 POST 请求向 `/_next/static/chunks/react-flight` 接口发送恶意的 `multipart/form-data` 数据包。该数据包中包含一个伪造的 JSON 对象，利用了 `__type: Function` 标识符。攻击者通过注入 `global.process.mainModule.require('child_process').exec()` 这种经典的 Node.js 环境下的原型污染或反序列化注入手段，可以直接在服务器进程中执行任意系统命令。POC 中集成了三种不同类型的 Payload，分别针对 Linux 系统的 Bash 交互式 Shell、通过 mkfifo 创建的管道 Shell，以及针对 Windows 容器或 Azure 环境的 PowerShell 反向连接脚本。这种多平台兼容性的设计使得该 POC 具有极高的实战化程度。测试逻辑非常清晰，通过 requests 库自动化完成 Payload 的构造与投送，攻击者仅需提供目标 URL 和本地监听地址即可实现‘一键式’获取 Shell，其有效性在未修补的环境中极高。利用步骤如下：1. 攻击者在公网服务器上开启监听端口（如使用 nc -lvnp 4444）；2. 运行 Python 脚本，指定目标 URL 和攻击者 IP:PORT；3. 脚本自动构造含有恶意 Function 类型定义的 React Flight 数据包；4. 目标服务器解析数据包时，触发服务器端 JavaScript 执行环境下的 child_process 调用；5. 目标服务器主动回连攻击者，建立交互式 Shell。投毒风险分析：该 POC 的主要投毒风险较低，但仍需警惕。代码逻辑公开透明，使用了标准的 requests 和 sys 等 Python 库，未见明显的混淆手段。其包含的反向 Shell 载荷（Reverse Shell）属于标准的漏洞验证行为，旨在向研究人员展示代码执行的能力，而非隐藏的恶意后门。然而，风险点在于：第一，该脚本宣称来自 GitHub 上的 Ashwesker 或 sickwell 仓库，在实际环境中，此类‘一键化’脚本极易被二开修改，注入额外的静默下载指令或窃取环境变量的恶意代码。第二，脚本中的 User-Agent 被硬编码为 `Mozilla/5.0 (CVE-2025-55182)`，虽然方便防御者在日志中识别，但也可能掩盖了脚本在运行初期可能进行的非预期网络通信。第三，由于此类漏洞影响范围极大（包含 Dify 等流行框架），网络上可能流传带有后门的‘快速扫描器’变体。研究人员在使用时应务必在隔离的沙箱环境中运行，并对 `payloads` 列表进行审查，确保执行的命令仅限于预期的测试范围，防止在测试过程中反被脚本作者控制。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
