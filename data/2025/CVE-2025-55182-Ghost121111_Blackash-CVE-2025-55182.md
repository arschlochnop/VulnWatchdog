## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** React Server Components versions 19.0.0, 19.1.0, 19.1.1, 19.2.0 (packages: react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack); Next.js 15.x/16.x (unpatched)

**利用条件:** 远程且无需身份验证，目标系统开启了 React Server Components 功能并暴露了相关 API 端点。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被命名为“React2Shell”，源于 React Server Components (RSC) 在处理恶意构造的串行化数据时存在不安全的反序列化缺陷。提供的 POC 代码展示了如何通过发送一个精心构造的 multipart/form-data POST 请求到 `/_next/static/chunks/react-flight` 路径来触发漏洞。POC 使用了 React 内部函数类型的 payload：`{"__type":"Function","code":"..."}`，这直接利用了 RSC 在解析流式数据时的逻辑漏洞，通过 `global.process.mainModule.require` 调用 Node.js 的 `child_process` 模块执行系统命令。利用步骤如下：1. 攻击者准备一个攻击机，使用 nc (netcat) 开启监听端口；2. 运行 Python 脚本，指定目标 URL 和攻击机 IP:PORT；3. 脚本会自动构造包含 Bash、Netcat 或 PowerShell 不同环境下的反向 Shell 命令；4. 脚本通过 Multipart 表单形式发送恶意 Payload 至目标后端；5. 目标服务器反序列化该对象时，由于缺乏对 Function 类型的严格过滤，直接在服务端上下文中执行了注入的代码。经分析，该 POC 代码逻辑清晰，针对性强，在未修复的 Next.js/React 19 环境中具有极高的成功率。 

投毒风险分析：该 POC 代码本身具有较低的投毒风险。代码使用了标准的 Python `requests` 库和 `sys`、`time` 等原生库，没有发现经过混淆的十六进制字符串或 Base64 加密的隐藏代码块。代码中虽然包含了反向 Shell 载荷，但那是作为漏洞验证的必要部分，且载荷内容是透明可见的（如 `bash -i` 等）。其头部声明的 GitHub 地址 `Ashwesker/Blackash-CVE-2025-55182` 符合安全研究员发布 POC 的惯例。唯一需要关注的是其 User-Agent 被设置为 `Mozilla/5.0 (CVE-2025-55182)`，这虽然是硬编码但属于合法的流量标记。代码中没有发现向攻击者控制的第三方服务器发送敏感数据（如目标环境变量、凭据等）的行为。然而，由于此漏洞影响范围极大且利用门槛极低，这类 POC 在社交平台（如 Reddit、GitHub）传播时，可能被恶意人员克隆并加入真正的投毒后门。在本分析样本中，代码行为仅限于针对特定目标的漏洞探测与利用。防御建议是立即更新 React 至官方修复版本，并在 Web 应用防火墙 (WAF) 上针对 `react-flight` 路径及特定 JSON 结构进行特征拦截。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
