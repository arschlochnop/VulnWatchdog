## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Next.js 15.x, 16.x (截止2025年12月3日未修复版本), React 19

**利用条件:** 无需认证，远程网络访问，目标开启了 React Server Components 功能且存在特定路由端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：此漏洞被称为 'React2Shell'，是由于 React Server Components (RSC) 在处理特定的 'react-flight' 数据流时存在不安全的反序列化缺陷。提供的 POC 代码针对 `/ _next/static/chunks/react-flight` 路径发送构造好的 `multipart/form-data` 请求。POC 中的核心 Payload 利用了 `__type: Function` 这种反序列化特征，通过 Node.js 的全局 `process.mainModule.require` 调用 `child_process` 模块的 `exec` 函数。这种方法在 React 的服务端渲染环境中极具杀伤力，因为它绕过了普通应用逻辑层，直接在底层执行系统命令。该 POC 集成了三种不同环境的 Payload（Bash、Netcat、PowerShell），显著提高了攻击在不同操作系统（Linux/Windows）上的成功率。从防御者角度看，该 POC 逻辑清晰，利用方式符合 RSC 的底层通信协议特征，具有极高的实战价值，能直接获得反弹 Shell。利用步骤：首先，攻击者在本地启动监听（如 `nc -lvnp 4444`）。其次，运行脚本并传入目标 URL 与本地 IP 端口。脚本会构造含有恶意反序列化载荷的 HTTP POST 请求。最后，服务器解析载荷并触发 RCE，攻击者获得控制权。投毒风险分析：该 POC 代码本身结构清晰，使用了 Python 标准的 `requests` 库，未观察到明显的恶意代码混淆或针对研究者本人的后门。脚本中的 `User-Agent: Mozilla/5.0 (CVE-2025-55182)` 是为了调试标记，而非恶意。虽然代码中包含多种反弹 Shell 命令，但这些均明确指向用户输入的 `LHOST/LPORT`，属于正常的漏洞验证逻辑，不被视为针对研究者的投毒。然而，考虑到该漏洞 CVSS 评分为 10.0，搜索结果中提到目前存在大量虚假的 POC（Fake PoC）和扫描器。真实的投毒风险可能来自于其他未经审核的第三方仓库。本 POC 仓库 `Ashwesker/Blackash-CVE-2025-55182` 目前表现为功能性验证工具，但防御人员在使用此类工具时仍需在沙箱环境中运行，以防 Payload 中隐藏了额外的恶意 OOB（Out-of-Band）回连指令，用于窃取研究人员的环境变量或敏感凭证。总体而言，此代码公开性较高，建议关注其引用的外部库及后续更新是否引入不明的二进制依赖。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
