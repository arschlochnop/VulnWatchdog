## CVE-2025-55182 - React Server Components (RSC) & Next.js Framework 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components (RSC) & Next.js Framework

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需身份验证，目标服务器需启用 React Server Components 或 Next.js App Router 架构且暴露特定端点 (如 /_next/static/chunks/react-flight)。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，本质上是 React Server Components 在反序列化服务器端渲染逻辑时，对受控对象类型的处理不当。分析提供的 Python 脚本可见，攻击者通过构造一个特定的 multipart/form-data 请求，向 `/_next/static/chunks/react-flight` 路由发送 Payload。Payload 核心在于模拟一个 `__type: Function` 的 JSON 对象，通过 `global.process.mainModule.require` 调用 Node.js 的 `child_process.exec` 函数。由于 Next.js 在处理某些实验性或特定配置下的 Server Actions 时未能对传入的指令进行严格的沙箱隔离或类型检查，导致未经身份验证的用户可以执行系统级命令。该 POC 提供了针对 Linux (Bash/NC) 和 Windows (PowerShell) 的三种反弹 Shell 负载，具有极高的实战化程度。测试脚本显示其利用过程仅需一个简单的 POST 请求，配合特定的 Boundary 封装即可触发，且在默认配置的多个版本中均有效。利用步骤：1. 确认目标环境运行受影响的 Next.js/React 版本；2. 准备攻击机监听端口 (如 nc -lvnp 4444)；3. 运行 Python 脚本，指定目标 URL 和 LHOST:LPORT；4. 脚本构造包含恶意反序列化 Payload 的 multipart 请求；5. 目标服务器解析请求时触发 Node.js 代码执行，回连攻击机。投毒风险分析：该 POC 代码逻辑透明，主要使用了 Python 标准库 `requests`、`sys` 和 `time`，未见明显的代码混淆或第三方恶意依赖注入。脚本虽然会执行反弹 Shell 命令，但这属于安全研究中定义的预期‘攻击载荷’而非‘投毒后门’。然而，风险点在于该脚本来自非官方 GitHub 仓库 (Ashwesker/Blackash-CVE-2025-55182)，且在脚本执行前存在一个 3 秒的强制休眠，这在高度自动化的投毒场景中常被用来规避简单的沙箱检测。虽然目前的 Payload 是针对 target 变量定义的，但使用者应警惕该类脚本在未来可能被修改为在本地运行环境下执行静默命令。目前评估其投毒风险较低，属于标准的公开漏洞验证代码，但在企业内网研究时仍建议在隔离环境测试，防止脚本在本地环境中执行非预期操作。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
