## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0 (包含 react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack); Next.js 15.x/16.x

**利用条件:** 无需认证 (Pre-authentication)，可远程访问受影响的 React Server Function 端点或 Next.js 静态路由地址。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（被称为 React2Shell）源于 React Server Components (RSC) 在处理服务器函数调用时的不安全反序列化。POC代码（CVE-2025-55182-revshell.py）展示了如何利用该漏洞。它通过向 `/_next/static/chunks/react-flight` 或相关的 RSC 端点发送一个特制的 `multipart/form-data` 请求。POC的核心在于构造了一个包含 `__type: Function` 属性的 JSON 载荷。这种攻击载荷直接利用了 Node.js 环境下 `global.process.mainModule.require` 的动态调用能力，通过 `child_process.exec` 执行任意系统命令。此 POC 提供了针对 Linux (Bash/Netcat) 和 Windows (PowerShell) 的三种不同 Reverse Shell 载荷，通过单次 HTTP POST 请求即可触发。从防御角度看，该 POC 的逻辑非常清晰，直接验证了执行流从受控的反序列化数据到系统级命令执行的路径。由于它绕过了身份验证且不依赖复杂的内存布局劫持，其成功率极高，是一种极其危险的‘开箱即用’类利用代码。

【利用步骤】1. 环境准备：攻击者首先在本地监听端口（例如：nc -lvnp 4444）。2. 确定目标：扫描目标服务器是否存在 Next.js 或 RSC 相关路由。3. 构造请求：发送 POST 请求至受影响端点，设置 `Content-Type` 为 `multipart/form-data`，并定义特定的 boundary。4. 注入载荷：在 body 中插入恶意 JSON 字符串 `{"__type":"Function","code":"..."}`，其中 code 字段包含 Node.js 执行命令的代码。5. 获得权限：服务器在解析该 RSC 请求时会执行恶意代码，攻击者即可获得反弹 Shell。

【投毒风险分析】在对此 POC 代码进行安全性审计时，发现其投毒风险处于低至中等水平。代码本身逻辑透明，使用了标准的 Python `requests` 库，没有引入复杂的第三方依赖、加密二进制包或经过混淆的 Shellcode。代码头部标注了来源 GitHub 仓库（Ashwesker/Blackash-CVE-2025-55182），这种透明度通常降低了隐藏后门的概率。然而，这类 RCE POC 本身具有极高的传播价值，威胁情报团队在野外观察到大量此类脚本被封装进所谓的‘一键式扫描器’。风险点主要在于：1. 脚本可能会向开发者的 C2 服务器发送‘打点’信息（虽然此特定 POC 未发现）。2. 某些变体可能在执行反弹 Shell 的同时，静默下载并执行另一个恶意脚本（如劫持 SSH key）。3. 脚本中包含的 `verify=False` 虽然是为了忽略证书错误，但也可能掩盖中间人攻击。鉴于此漏洞等级为 CVSS 10.0，目前开源社区存在大量虚假的、包含混淆代码的伪造 POC，研究人员在下载此类脚本时必须在沙箱环境中进行审计，防止被恶意攻击者‘反向钓鱼’。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
