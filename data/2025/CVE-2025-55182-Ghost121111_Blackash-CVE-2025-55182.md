## CVE-2025-55182 - React / Next.js (Server Components) RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React / Next.js (Server Components)

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, Next.js 16.x (截止2025年12月初版本), React 19 及其相关服务器组件实现

**利用条件:** 无需身份验证，目标服务器启用了 React Server Components (RSC) 或 Next.js App Router，且存在特定的反序列化或函数调用逻辑漏洞。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被描述为React和Next.js生态中的“核弹级”漏洞，主要源于React Server Components (RSC) 在处理服务器端函数序列化与执行时的逻辑缺陷。分析提供的Python POC代码发现，其攻击路径非常清晰且极具威胁。攻击者通过向 `/_next/static/chunks/react-flight` 接口发送精心构造的 `multipart/form-data` 请求，利用了 `react-flight` 处理逻辑中对特定 JSON 结构的解析漏洞。POC中构造的 payload 为 `1{"__type":"Function","code":"..."}`，这表明漏洞点在于服务器端错误地将输入数据反序列化为可执行函数，并允许通过 Node.js 的内置模块如 `child_process` 执行任意系统命令。此利用方式不需要任何前置身份验证，且能直接获取系统 Shell，在自动化扫描和攻击场景中具有极高的成功率。POC代码中集成了针对 Linux 和 Windows 环境的多种 Payload，包括 Bash 反弹 Shell、FIFO 管道 Shell 以及 PowerShell 混淆脚本，这显著增强了其在不同部署环境下的普适性。从技术实现看，该 POC 逻辑严密，利用了 Next.js 默认路由特性，验证了漏洞的真实性与高危属性。

利用步骤：1. 环境准备：攻击者首先在公网 VPS 上使用 `nc -lvnp <LPORT>` 开启监听端口。2. 目标识别：针对目标域名，确认其是否使用了 Next.js 15+ 或 React 19 的服务器组件功能。3. 构造请求：通过 Python 脚本构造一个指向 `/_next/static/chunks/react-flight` 的 POST 请求，设置 `Content-Type` 为 `multipart/form-data`。4. 注入 Payload：在请求体中注入包含 `global.process.mainModule.require('child_process').exec()` 的特殊 JSON 对象。5. 执行反弹：服务器解析该对象后触发命令执行，将 Shell 连接回攻击者的监听端口。6. 权限维持：一旦 Shell 建立，攻击者即可进行进一步的内网渗透或数据窃取。

投毒风险分析：该 POC 脚本的投毒风险评级为低（15%）。代码逻辑透明，主要使用了 Python 的 `requests`、`sys` 和 `time` 等标准或常用库，未发现混淆代码、外部恶意域名请求或针对分析者主机的隐藏破坏行为。虽然脚本中包含反弹 Shell 的指令，但这属于安全研究中典型的利用验证逻辑，用于证明漏洞的 RCE 能力。脚本中明确标注了来源 GitHub 地址（Ashwesker/Blackash-CVE-2025-55182），且代码注释清晰地说明了其用途。尽管如此，在使用此类公开 POC 时，防御者仍需注意风险：首先，由于该漏洞影响范围极广且处于爆发初期，许多类似的所谓“Exploit”可能被恶意用户二次包装，在其中嵌入窃取开发者凭证或 SSH Key 的后门代码。其次，由于脚本会产生真实的攻击行为，在未经授权的生产环境测试可能导致法律风险或业务中断。建议安全研究人员在隔离沙箱环境中运行该脚本，并仔细检查任何非标准库的调用或异常的网络外连行为，以确保研究过程的安全性。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
