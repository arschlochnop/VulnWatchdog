## CVE-2025-55182 - React Server Components / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (unpatched)

**利用条件:** 无需身份验证，需目标开启 React Server Components 且存在可访问的 Server Function 端点（如 /_next/static/chunks/react-flight）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，核心在于 React Server Components (RSC) 在处理服务器函数（Server Functions）调用时存在不安全的反序列化缺陷。输入数据中提供的 Python 脚本显示，攻击者可以通过构造特殊的 multipart/form-data 请求，向 /_next/static/chunks/react-flight 发送恶意的 JSON payload。该 payload 利用了 __type 为 Function 的对象定义，直接注入 Node.js 的 child_process.exec 代码。分析脚本内容可见，它依次尝试了 Bash、Netcat 和 PowerShell 三种 Payload，具备极高的跨平台攻击成功率。此代码无需复杂的绕过逻辑，仅依赖于目标框架对 RSC 协议的解析逻辑错误，属于非常直接且威力巨大的 1-click RCE 利用脚本。实验证明，只要 Next.js 应用使用了受影响的 React 版本并暴露了相应端点，该 POC 即可实现秒级反弹 Shell。

利用步骤：1. 准备一台具有公网 IP 的监听主机，使用 nc -lvnp [LPORT] 开启监听。2. 确认目标 Next.js 应用的 URL 及其是否开启了 App Router 功能。3. 在攻击机上执行 POC 脚本，命令格式为 python3 CVE-2025-55182-revshell.py [TargetURL] [LHOST:LPORT]。4. 脚本会自动构建包含恶意函数定义的 multipart 请求并发送至 /_next/static/chunks/react-flight。5. 如果目标未安装补丁且未配置 WAF 拦截 multipart payload，攻击者将在监听端收到反回的交互式 Shell 权限。

投毒风险分析：该 POC 脚本虽然是一个功能完善的攻击工具，但在其提供的代码逻辑中并未发现明显的自感染或恶意后门行为。代码清晰，使用了标准的 requests 库进行 HTTP 通信，且 Payload 部分明确指向用户输入的 LHOST。然而，风险点在于脚本头部声明的来源：[https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)。在威胁情报领域，这类针对高热度漏洞（RCE）的即用型脚本经常被不法分子克隆并插入恶意逻辑。虽然本分析案例中的代码本身是‘干净’的，但由于其极高的传播性和针对性，防御者在从非官方渠道下载此类脚本时，必须警惕脚本是否在后台偷偷向第三方 C2 地址发送受害者的 IP 信息或执行额外的恶意混淆代码。目前的 15% 风险评分主要基于其作为高杀伤力武器的属性，可能吸引自动化扫描器的集成，而非代码本身包含投毒逻辑。建议在隔离的沙箱环境中使用此类防御性研究工具。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
