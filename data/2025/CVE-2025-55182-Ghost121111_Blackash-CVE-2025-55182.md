## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** React Server Components 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (早期版本)

**利用条件:** 远程未经身份验证、存在受影响的React Server Function端点、未应用补丁

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为“React2Shell”，源于React Server Components（RSC）在处理Server Functions时的不安全反序列化机制。分析提供的POC代码（CVE-2025-55182-revshell.py），其利用逻辑高度成熟且具有极强的实战针对性。POC通过构造一个含有特定`__type":"Function"`属性的JSON对象，试图触发后端反序列化引擎执行任意代码。代码中直接调用了Node.js环境下的`global.process.mainModule.require('child_process').exec`，这是典型的利用Node.js原型污染或反序列化漏洞执行系统命令的手段。POC针对不同操作系统环境准备了三套Payload：Bash反向Shell、基于命名管道（mkfifo）的Netcat Shell以及针对Windows/Azure环境的PowerShell代码。其攻击目标被精准定位在`/_next/static/chunks/react-flight`端点，并采用了`multipart/form-data`封装，旨在绕过简单的Web应用防火墙（WAF）规则。该POC无需任何预备权限，属于“开箱即用”的高质量攻击脚本，能在极短时间内将脆弱服务器转化为受控端，验证了CVE-2025-55182属于极其严重的预认证RCE漏洞。利用步骤如下：1. 确认目标环境使用了受影响的React 19/Next.js版本。2. 在攻击机启动nc监听（如nc -lvnp 4444）。3. 执行POC脚本，传入目标URL和LHOST:LPORT。4. 脚本循环发送三种Payload，若成功执行则在nc端获得交互式Shell。

【投毒风险分析】从安全审计角度来看，该POC的投毒风险处于低至中等水平（约15%）。该脚本代码逻辑清晰，主要依赖Python标准库`requests`、`sys`和`time`，没有引入混淆后的Base64编码或外部未知的恶意二进制分发。脚本中定义的Payload明确用于反弹Shell，这是渗透测试和漏洞验证中的标准功能，不应被误判为针对研究员的投毒后门。然而，存在两个潜在风险点：首先，开发者在代码注释中引导用户访问特定的GitHub仓库（Blackash-CVE-2025-55182），如果该第三方仓库在后续更新中被植入恶意代码（如在安装依赖或执行setup.py时静默下载木马），将构成间接投毒威胁。其次，POC中硬编码了`User-Agent: Mozilla/5.0 (CVE-2025-55182)`，这虽然利于蓝队溯源，但也可能被防御方作为简单指纹。综合评估，该POC本身是纯净的防御性研究工具，但其高破坏力意味着它极易被黑产直接利用。研究人员在下载和运行此类涉及`exec`操作的脚本时，应始终在隔离的沙箱环境中进行，并仔细检查Payload中是否存在除攻击目标外的第二外联IP，以防“黑吃黑”类型的投毒攻击。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
