## CVE-2025-55182 - React Server Components / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (基于RSC构建的版本)

**利用条件:** 无需认证，目标应用启用了 React Server Components (RSC) 且路径暴露（如 /_next/static/chunks/react-flight）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为 React2Shell，核心成因在于 React Server Components 在处理服务器函数（Server Functions）负载时存在不安全的反序列化缺陷。攻击者可以通过发送构造精良的 multipart/form-data HTTP POST 请求，向后端 API 端点注入恶意的 JSON 序列化对象。根据提供的 POC 代码分析，漏洞触发点位于 `/ _next/static/chunks/react-flight` 或类似的 RSC 处理接口。POC 构造了一个包含 `__type: Function` 属性的 JSON 载荷，利用了后端在恢复组件状态时对 Function 类型的错误信任，通过 Node.js 的 `global.process.mainModule.require` 调用 `child_process` 模块。代码中展示的利用链极其直接且高效：首先尝试 Bash 交互式 Shell，若失败则切换为基于 mkfifo 的 Netcat 管道，最后针对 Windows 环境提供了 PowerShell 反向连接脚本。这种三位一体的 Payload 覆盖了 Linux 和 Windows 常见的生产环境。POC 脚本逻辑严谨，包含了 boundary 自动构建、多载荷循环尝试以及详细的状态反馈，属于高成熟度的 Exploit 代码，能够实现一键式获取系统 Shell，对企业生产环境构成极高威胁。【利用步骤】1. 环境准备：在攻击机执行 `nc -lvnp <LPORT>` 监听端口。2. 目标探测：确认目标 Next.js 应用是否暴露了 RSC 相关的 API 路径。3. 执行脚本：运行 `python3 CVE-2025-55182-revshell.py <目标URL> <LHOST:LPORT>`。4. 自动化攻击：脚本会自动封装 multipart 报文，依次发送针对 Bash、NC 和 PowerShell 的 Payload。5. 权限维持：成功触发反序列化后，目标服务器将主动连接攻击机，建立反向 Shell 会话。【投毒风险分析】该 POC 的投毒风险处于低至中等水平（约 15%）。代码本身采用纯 Python 标准库（requests, sys, time）编写，逻辑透明，未见混淆处理。虽然脚本具备强大的破坏性（反弹 Shell），但其行为完全符合渗透测试工具的预期。风险主要来源于两个方面：第一，POC 脚本头部引用的 GitHub 仓库 `Ashwesker/Blackash-CVE-2025-55182` 可能存在后续更新中引入恶意依赖或后门的风险。第二，在 `payloads` 数组中，虽然脚本声称是执行反弹 Shell，但攻击者可以轻易在其中植入静默的持久化木马下载命令（如 curl | bash），而使用者如果不仔细审计代码中 `evil` 变量的拼接逻辑，可能会在利用目标的同时导致自己受控。此外，搜索结果中出现的某些不明确链接（如 result 3 和 result 6 的第三方 releases）是典型的投毒高发区，建议安全研究员仅参考知名安全社区提供的代码片段，严禁直接运行未经审计的二进制或混淆脚本。针对此类 RCE 漏洞，防护建议是立即升级 React 至受支持的补丁版本，并在 WAF 层级拦截异常的 RSC JSON 序列化对象注入。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
