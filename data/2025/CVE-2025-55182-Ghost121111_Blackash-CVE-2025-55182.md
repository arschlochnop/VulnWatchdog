## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未打补丁版本)

**利用条件:** 无需认证，远程网络访问，目标开启了React Server Functions或使用App Router

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC针对CVE-2025-55182漏洞（又称React2Shell）提供了完整的自动化利用脚本。漏洞根源在于React Server Components在处理服务端函数（Server Functions）荷载时，未能对反序列化过程进行充分验证，导致攻击者可以构造包含恶意__type和指令的JSON对象。分析代码发现，POC通过向/_next/static/chunks/react-flight接口发送精心构造的multipart/form-data请求。其核心payload利用了JavaScript环境中的全局对象访问权，通过global.process.mainModule.require访问child_process模块并调用exec函数。这种利用方式在Node.js服务端环境下极为高效。POC中内置了针对Linux（Bash/Netcat）和Windows（PowerShell）的三种不同反向Shell荷载，具有极高的实战化程度。测试脚本显示其无需任何前置认证即可触发，且通过变换User-Agent尝试规避简单的安全过滤。经评估，该POC在未修复的Next.js 15+环境下具备极高的成功率。利用步骤：1. 确认目标系统使用受影响的React/Next.js版本；2. 在攻击机启动监听器（如nc -lvnp 4444）；3. 运行脚本并指定目标URL及攻击机IP端口；4. 脚本循环发送三种Payload，若目标环境符合，将建立反向Shell。【投毒风险分析】该POC代码逻辑清晰，主要依赖Python标准库requests和sys，未发现明显的代码混淆或加密行为。脚本中的Payload部分虽包含典型的反向Shell指令，但这是安全研究中验证RCE漏洞的标准做法，不应直接判定为投毒行为。然而，由于该漏洞影响范围极广且危害巨大，此类一键化脚本极易被恶意攻击者用于大规模扫描。代码中提到的Github地址（Ashwesker/Blackash-CVE-2025-55182）需谨慎对待，尽管当前脚本看似安全，但后续更新可能引入恶意依赖下载或外连控制端的情况。此外，脚本中虽然没有显式的恶意后门，但其通过Content-Type和User-Agent的固定指纹可能会被WAF识别。防御者在分析此类POC时，应注意其是否在执行过程中向第三方服务器发送了敏感的环境变量（如process.env），本脚本目前专注于漏洞利用，投毒风险较低，属于常规的安全研究工具。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
