## CVE-2025-55182 - React / Next.js RCE (不安全反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全反序列化)

**影响应用:** React / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需认证，远程网络访问，目标使用 React Server Components (RSC) 并暴露特定端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞名为 React2Shell，源于 React Server Components (RSC) 在处理服务器函数（Server Functions）荷载时存在不安全的反序列化逻辑。通过分析提供的 Python POC 代码，其利用逻辑非常清晰且具有高度可行性。POC 通过向 `/_next/static/chunks/react-flight` 或类似的 RSC 处理端点发送构造好的 `multipart/form-data` 请求进行攻击。关键载荷位于 `evil` 变量中，它模拟了一个类型为 `Function` 的对象，利用 Node.js 环境下 `global.process.mainModule.require` 的特性调用 `child_process` 模块的 `exec` 函数。代码展示了三种不同的 payload：针对 Linux 的标准 Bash 反弹 shell、针对无 Bash 环境的 FIFO 命名管道 Netcat 反弹 shell，以及针对 Windows/Azure 环境的 PowerShell 反弹 shell。这种多载荷尝试极大地提高了在不同服务器操作系统上的成功率。由于 React 19 和 Next.js 15+ 广泛采用 App Router 和 RSC，该漏洞的攻击面极大。POC 代码结构完整，包含目标 URL 解析、LHOST/LPORT 配置以及自动化的 multipart 数据包封装，攻击者只需提供目标地址即可实现一键获取权限，验证了该漏洞作为‘远程代码执行’的严重性和易用性。【利用步骤】1. 攻击者在本地使用 `nc -lvnp <port>` 开启监听。2. 运行 POC 脚本并指定目标服务器 URL 和本地监听地址。3. 脚本会自动构造包含恶意反序列化对象的 multipart 请求。4. 脚本循环发送三种针对不同操作系统的 Payload 至服务器的 RSC 端点。5. 服务器在处理该请求时，反序列化器错误地执行了 `Function` 对象中的 JavaScript 代码。6. 目标服务器向攻击者主机发起反向连接，攻击者获得系统 Shell。【投毒风险分析】经过对 POC 代码的深度审计，该脚本的主要风险在于其提供的攻击便利性，而非传统意义上的‘供应链投毒’或‘恶意后门’。代码逻辑透明，仅引用了 Python 的标准库 `requests`、`sys` 和 `time`，未发现任何混淆（Obfuscation）或加密代码。代码中明确指出了攻击载荷的意图，即通过 `child_process.exec` 执行命令。虽然脚本内含反弹 shell 代码，但这属于漏洞验证（Exploit）的正常功能范畴，并非针对研究者本人的后门。唯一潜在的微小风险在于脚本中硬编码的 User-Agent 包含 CVE 编号，且其注释中引导用户访问特定的 GitHub 仓库。在威胁情报视角下，此类 POC 的传播风险在于其易于被脚本小子（Script Kiddies）直接利用。对于防御者而言，代码本身是安全的研究工具，不含窃取研究者本地凭证或感染本地主机的恶意逻辑。投毒风险评级为 15%，主要考虑是攻击者可能会修改此类脚本，在 `payloads` 列表中悄悄加入针对研究者主机的反向连接请求，建议在使用任何公开 POC 前，必须手动核对 payload 字符串内容是否与预期的一致。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
