## CVE-2025-55182 - React Server Components / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, 16.x (截至2025年12月3日未修复版本), React 19 开发预览版/特定构建

**利用条件:** 远程未经身份验证，目标启用了 React Server Components (RSC) 且存在可访问的 Server Function 端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，其核心在于 React Server Components (RSC) 在处理客户端传递的序列化数据时，未能对数据类型和执行逻辑进行严格校验。分析提供的 POC 代码可知，攻击者通过构造一个特殊的 Multipart 报文，向 `/_next/static/chunks/react-flight` 路径（或类似的 RSC 交互端点）发送包含 `__type: Function` 标识的 JSON 载荷。由于 React 内部在反序列化过程中对该特殊类型的处理不当，导致其可以直接通过 Node.js 的全局 `process.mainModule.require` 调用 `child_process.exec` 执行任意系统命令。该 POC 展示了极高的有效性，它通过三次尝试（Bash 交互式、FIFO 管道、PowerShell）来确保在不同的操作系统环境（Linux/Windows）下均能成功建立反向 Shell。代码逻辑清晰，利用了标准的 HTTP POST 请求，不依赖复杂的中间件。利用步骤：首先，攻击者在本地启动监听器（如 `nc -lvnp 4444`）；其次，运行 POC 脚本并指定目标 URL 与本地监听地址；脚本会自动构造符合 RSC 协议格式的 Payload，利用 `multipart/form-data` 绕过一些基础的字符过滤；最后，受害者服务器接收到请求并触发反序列化逻辑，执行注入的 Node.js 代码，主动连接回攻击者机器。投毒风险分析：该 POC 脚本虽然表现为高度自动化的利用工具，但其代码透明度较高，主要依赖 `requests` 库，没有发现经过混淆的恶意二阶段下载器或窃取本地凭据（如 .ssh 密钥或 .env 文件）的隐蔽行为。然而，其提供的 Github 链接 `Ashwesker/Blackash-CVE-2025-55182` 需谨慎对待。在威胁情报视角下，此类具有 '一键式利用' 特性的脚本常被黑灰产用于快速集成。尽管当前脚本仅包含反弹 Shell 的载荷，但其利用门槛极低，极易被修改为在攻击成功后自动植入持久化后门或挖矿程序。代码中硬编码的 User-Agent 虽然声明了漏洞编号，但在实际防御场景中，这种明显的特征往往暗示该工具可能被用于大规模僵尸网络扫描。对于防御者而言，最大的风险在于直接运行这类来源不明的自动化脚本进行‘自测’，可能会因为脚本内部隐藏的逻辑（如在成功后向特定第三方服务器上报目标 IP）而导致敏感资产暴露。整体而言，该代码逻辑本身相对安全，但其高破坏力的本质决定了它在传播过程中极易被投毒或作为诱饵。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
