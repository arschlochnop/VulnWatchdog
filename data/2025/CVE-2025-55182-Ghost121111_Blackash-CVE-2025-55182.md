## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (远程代码执行)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (远程代码执行)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL (极危)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0 至 19.2.0, Next.js 15.x, 16.x (早期版本)

**利用条件:** 无需认证，目标应用需启用 App Router 且使用 React Server Components (RSC) 架构，且暴露了受影响的后端端点。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞利用代码针对的是 React Server Components (RSC) 架构中的反序列化安全缺陷。RSC 使用名为 'Flight' 的协议在服务器和客户端之间传输组件数据。分析 POC 代码发现，攻击者利用了 React 在处理多部分表单数据 (multipart/form-data) 时的漏洞，该漏洞位于解码发送至服务器函数端点的请求负载逻辑中。具体而言，POC 通过向 `/_next/static/chunks/react-flight` 或类似的内部路由发送特制的 payload，成功触发了服务器端的原型链污染或非预期对象实例化。在 payload 中，攻击者构造了一个 JSON-like 的对象，其 `__type` 被指定为 `Function`。当 React 的序列化/反序列化层解析该对象时，未能对危险构造函数进行充分过滤。POC 通过 `global.process.mainModule.require('child_process').exec` 直接调用 Node.js 环境下的系统指令。由于 React 19 引入了更复杂的组件序列化机制，该漏洞允许攻击者在无需任何预置权限的情况下，通过单次 HTTP POST 请求实现任意系统命令执行。该 POC 提供了针对 Linux (Bash) 和 Windows (PowerShell) 的多种反弹 Shell 载荷，表现出极高的实战化程度和执行成功率。利用步骤：1. 确认目标应用使用了 React 19 且基于 Next.js App Router 部署。2. 攻击者在本地启动监听器（如 nc -lvnp 4444）。3. 构造包含恶意序列化对象的 multipart/form-data 请求。4. 发送请求至目标服务器的 RSC 处理端点。5. 服务器解析请求时执行内置的 JavaScript 代码，触发 child_process 模块执行反弹 Shell 命令。6. 攻击者获得服务器的完全控制权。投毒风险分析：该 POC 的主要投毒风险较低，属于常规的安全研究工具。代码逻辑清晰，主要依赖 Python 的 requests 标准库。虽然脚本内部包含了多种反弹 Shell 的 Payloads（Bash, Netcat, PowerShell），但这些均是用于验证漏洞 RCE 能力的已知常见手段，而非针对研究者本人的恶意行为。然而，需要警惕的是其来源 Github 仓库（Blackash-CVE-2025-55182）及类似的公开库。由于该漏洞 CVSS 评分为满分 10 分且利用极简，恶意行为者常会在类似的脚本中通过混淆手段加入后门，例如在执行 payload 发送的同时，静默地将当前研究者的环境变量（如 AWS_ACCESS_KEY_ID）外发，或者在本地隐蔽执行一段 base64 编码的恶意 shell 代码。当前分析的脚本并未发现明显的此类混淆逻辑，但由于脚本会执行 `time.sleep` 等操作，且在 header 中定义了特定的 User-Agent，在大规模扫描时极易被 WAF 识别。研究人员在测试此类高危 POC 时，应始终在受控的沙箱环境中运行，并重点检查脚本中是否存在针对本机的 `os.system` 或 `subprocess` 调用。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
