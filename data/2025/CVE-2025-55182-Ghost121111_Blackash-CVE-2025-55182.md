## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (反序列化/命令注入)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (反序列化/命令注入)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x (未修复版本)

**利用条件:** 无需认证，远程网络访问，目标开启了React Server Functions端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被命名为React2Shell，是由于React Server Components在处理反序列化逻辑时存在缺陷。分析提供的Python POC代码发现，其利用效率极高且具备实战化特征。漏洞的核心成因在于RSC解析器在处理multipart/form-data请求时，未能对__type为Function的JSON对象进行严格校验。攻击者通过向/_next/static/chunks/react-flight或类似的Server Function端点发送构造好的payload，可以直接调用Node.js的内部模块。在POC中，攻击代码通过global.process.mainModule.require('child_process').exec()实现了命令执行。此POC针对性地编写了三种Payload，分别适配Bash、FIFO管道以及Windows平台的PowerShell，显示了极高的武器化水平。该脚本能自动处理boundary封装，并针对不同系统环境进行尝试，验证成功率极高，是一个典型的‘开箱即用’式利用脚本。利用步骤：首先，攻击者确定目标站点使用了受影响的React 19或Next.js版本；其次，设置本地监听端口（如nc -lvnp 4444）；然后，运行POC脚本，指定目标URL和本地监听IP与端口；脚本构造包含恶意Function对象的multipart请求并发送至服务端端点；服务端在解析RSC流时触发反序列化漏洞，执行child_process.exec中的Shell命令，最终在攻击者端建立反向Shell连接。投毒风险分析：该POC虽然具备高度的攻击性，但从代码逻辑分析，其投毒风险处于低至中等水平。代码主要依赖Python标准库（requests, sys, time），没有引入经过Base64编码的混淆模块或外部不透明的二进制文件。脚本中的payload（如Bash反弹Shell、PS反弹Shell）是网络安全研究中公认的标准验证Payload，属于显性利用行为，而非隐蔽的恶意投毒。主要的风险点在于：1. 脚本头部引用的Github项目地址（Blackash-CVE-2025-55182）可能在未来的更新中被替换为包含恶意逻辑的版本；2. 脚本中虽然目前没有发现窃取本地凭据（如AWS密钥、.env文件）的侧信道代码，但攻击者极易通过修改payload列表，在用户运行脚本尝试攻击目标的同时，反向收集执行者的系统信息。对于防御团队而言，此代码本身可作为特征提取的样本，但应在隔离沙箱环境中运行，以防其潜藏的针对执行者的二次攻击逻辑。目前来看，其主要风险在于被未授权人员用于非法入侵，而非脚本本身的后门投毒。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
