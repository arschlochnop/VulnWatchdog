## CVE-2025-55182 - React Server Components (RSC) / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components (RSC) / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0; Next.js 15.x, 16.x

**利用条件:** 无需认证，远程网络访问受影响的React Server Function端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为“React2Shell”，源于React Server Components（RSC）在处理服务器函数（Server Functions）调用时存在不安全的反序列化缺陷。POC代码展示了如何利用`react-flight`端点，通过发送精心构造的`multipart/form-data`请求触发漏洞。核心payload利用了反序列化过程中对`__type: Function`的错误解析，注入Node.js代码`global.process.mainModule.require('child_process').exec()`，从而在服务端执行任意系统命令。POC中包含针对Linux（Bash/Netcat）和Windows（PowerShell）的多种Payload，经分析其逻辑符合RSC内部协议结构，具有极高的实战有效性。利用步骤：1. 攻击者准备监听环境（如nc -lvnp 4444）。2. 确定目标是否存在受影响的Next.js/React版本。3. 向目标URL的`/_next/static/chunks/react-flight`发送带有恶意Boundary的POST请求。4. Payload触发服务器端的Node.js进程执行反弹shell命令。5. 攻击者获取服务器控制权限。投毒风险分析：该POC代码逻辑清晰，主要使用标准库`requests`、`sys`和`time`，没有复杂的混淆手段或加密载荷。代码库来自Github用户Ashwesker，虽名为“Blackash”，但其Python逻辑直接暴露了Payload内容，透明度较高。风险点主要在于：第一，其Payload中包含针对多种操作系统的Shell指令，属于高破坏性代码；第二，此类高价值的RCE漏洞POC往往容易被二次修改，在非官方分发渠道可能被植入自下载木马。目前的脚本中未发现明显的恶意二段下载行为或针对分析者主机的反向攻击代码，但在生产环境测试时，仍建议在隔离沙箱中运行并监控网络流量，以防脚本在静默状态下向第三方域名泄露目标资产信息。整体投毒风险较低，主要风险源于攻击指令本身的破坏性。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
