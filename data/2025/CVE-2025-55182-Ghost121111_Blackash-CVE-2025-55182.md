## CVE-2025-55182 - React Server Components / Next.js RCE (不安全的反序列化)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE (不安全的反序列化)

**影响应用:** React Server Components / Next.js

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** React 19.0.0, 19.1.0, 19.1.1, 19.2.0 (react-server-dom-webpack等); Next.js 15.x, 16.x

**利用条件:** 无须认证，远程网络访问目标React Server Function端点

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为'React2Shell'，核心在于React Server Components (RSC) 在处理特定序列化数据（如React Flight协议）时存在缺陷。分析提供的Python脚本可知，该漏洞通过向`/_next/static/chunks/react-flight`端点发送构造好的Multipart/form-data请求实现。POC利用了RSC反序列化过程中对`__type: Function`处理不当的漏洞，允许攻击者注入Node.js代码。脚本通过`global.process.mainModule.require('child_process').exec()`直接调用系统命令，这种方式在Node.js环境下具有极高的执行成功率。代码中包含了针对Linux（Bash/Netcat）和Windows（PowerShell）的三种不同Payload，显著提高了利用的普适性。由于该漏洞处于Pre-authentication（预认证）阶段，且攻击载荷相对精简，防御方若无WAF对特定Multipart边界或JSON内部关键字进行过滤，极难阻断此类自动化攻击。利用步骤：首先，攻击者确定目标Next.js应用的版本是否处于受影响范围；其次，准备本地监听器（如nc -lvnp 4444）；然后，运行POC脚本，脚本会构造一个包含恶意JSON对象的Multipart请求，其中JSON字段包含恶意的代码执行逻辑；最后，服务器在解析RSC流时触发反序列化操作，执行Payload并回连Shell。投毒风险分析：经过对POC代码的静态分析，该脚本逻辑清晰，使用了标准的`requests`和`sys`库，未发现明显的代码混淆或恶意后门植入。虽然脚本名称包含'revshell'且具有真实的攻击载荷，但其行为与描述的功能完全一致，属于安全研究范畴内的全功能利用程序，而非针对研究员的投毒样本。脚本中的Payload虽是恶意的（反弹Shell），但其作为漏洞验证工具的目的明确。不过，由于该脚本引用了外部GitHub项目（Ashwesker/Blackash-CVE-2025-55182），用户在克隆完整项目时仍需警惕仓库中可能存在的其他二进制混淆文件。对于此类高风险POC，建议在隔离环境中使用，以防止在测试过程中意外导致目标生产系统瘫痪或引发不必要的法律风险。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
