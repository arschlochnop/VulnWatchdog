## CVE-2025-55182 - Next.js / React Server Components 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Next.js / React Server Components

**危害等级:** 严重 (CRITICAL)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Next.js 15.x, 16.x (未打补丁版本); React 19 (Server Components 组件)

**利用条件:** 无需身份验证，目标服务器启用了 React Server Components (RSC) 或 Next.js App Router 且未应用安全补丁。可以通过公网直接进行网络访问。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞被称为 'React2Shell'，是 React Server Components 在反序列化过程中对 `Function` 类型对象处理不当导致的严重 RCE 漏洞。分析提供的 Python 脚本可知，攻击者通过向 `/_next/static/chunks/react-flight` 接口发送恶意的 `multipart/form-data` 请求，利用 `1{"__type":"Function","code":"..."}` 这种特定的序列化格式，成功在 Node.js 环境中触发代码执行。POC 构造了三种不同的 Payload：Bash 反弹 Shell、FIFO 管道 Shell 以及针对 Windows 环境的 PowerShell 反弹 Shell。这种多环境适配大大提高了漏洞利用的成功率。从代码逻辑看，POC 使用了 `global.process.mainModule.require('child_process').exec` 这一典型的 Node.js 逃逸及执行命令手法。通过对 Next.js 应用路由接口的直接 POST 请求，攻击者可以在完全不经过身份验证的情况下获得目标服务器的控制权。由于该漏洞 CVSS 评分高达 10.0，且目前已有大量虚假 POC 在社区流传，该脚本的逻辑符合真实的漏洞原理，具有极高的实战威胁。利用步骤：1. 攻击者准备监听环境（如使用 `nc -lvnp 4444`）；2. 运行 Python 脚本，指定目标 URL 和 LHOST:LPORT；3. 脚本自动探测并依次发送针对不同操作系统的 Payload；4. 如果目标未修复，服务端将解析恶意的 React Flight 数据流并执行命令，攻击者获取反弹 Shell。投毒风险分析：该 POC 代码结构清晰，主要使用了标准库 `requests`、`sys` 和 `time`。尽管脚本提供了反弹 Shell 这种具有攻击性的功能，但这属于 POC 本身的预期功能，而非隐藏的恶意逻辑。在对代码进行静态检查时发现，脚本没有尝试读取本地敏感文件（如 SSH 密钥、浏览器密码），也没有向第三方不受控的地址发送数据流。脚本中的 GitHub 链接指向 'Ashwesker'，这在威胁情报中属于需关注的活跃账号。虽然此特定 POC 看起来是纯净的防御性研究工具，但鉴于 CVE-2025-55182 极高的热度，目前 GitHub 和社交媒体上存在大量名为该漏洞 POC 实际上是执行后会感染下载者本机的投毒脚本。分析此脚本时需注意，其请求的 User-Agent 被设置为 'Mozilla/5.0 (CVE-2025-55182)'，这便于蓝队在日志中进行特征匹配。综合来看，此 POC 本身投毒风险较低，但建议在隔离的沙箱环境中使用，以防其引用的外部项目库在未来发生供应链污染。

**项目地址:** [https://github.com/Ashwesker/Blackash-CVE-2025-55182](https://github.com/Ashwesker/Blackash-CVE-2025-55182)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
