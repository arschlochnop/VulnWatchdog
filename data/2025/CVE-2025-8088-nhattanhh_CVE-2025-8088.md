## CVE-2025-8088 - WinRAR (Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll) 路径遍历, 任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历, 任意代码执行

**影响应用:** WinRAR (Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**危害等级:** 高危

**CVSS评分:** CVSS v3.1 8.4

**影响版本:** WinRAR存在漏洞版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 需要用户解压特制压缩包，无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8088是WinRAR软件中的一个高危路径遍历漏洞，攻击者利用Windows NTFS备用数据流(ADS)和目录穿越技术，可绕过WinRAR的文件验证机制，将恶意文件释放到系统任意位置（如启动文件夹），最终实现任意代码执行。该漏洞已被UNC4895(RomCom)、APT44等APT组织在野利用，主要针对乌克兰军事及政府机构，并发现有中国境内的非法攻击团伙也利用此漏洞。

**POC有效性分析与利用步骤：**
提供的Python POC (`CVE-2025-8088.py`) 是一个完整且高质量（评分9/10）的漏洞利用生成器。它通过以下步骤工作：
1.  **准备恶意文件**：脚本创建诱饵文件和包含良性命令（`@echo off\necho Payload executed!\npause\n`）的`payload.bat`。
2.  **ADS隐藏**：将`payload.bat`的内容作为备用数据流附加到诱饵文件上。
3.  **生成基础RAR**：调用系统中的`Rar.exe`，将诱饵文件压缩成`base.rar`。
4.  **RAR头修补**：这是核心步骤。脚本会读取`base.rar`的内部结构，并精确地修补RAR5文件头，将ADS路径（如`file1.txt:placeholder`）替换为构造好的恶意路径（例如，`file1.txt:....\\....\\....\\....\\....\\....\\....\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\payload.bat`），实现目录穿越。
运行此POC脚本将生成一个`exploit.rar`恶意压缩包。受害者使用受影响的WinRAR版本解压此压缩包时，恶意`payload.bat`会因路径遍历被释放到Windows启动目录。一旦受害者下次登录或重启，该脚本将自动执行，导致任意代码执行。此POC有效性极高，能够稳定复现漏洞。

**投毒风险分析：**
该POC代码的投毒风险评估为低（0-29%）。
1.  **代码透明**：代码为Python脚本，逻辑清晰，未见混淆或加密。
2.  **标准依赖**：仅依赖Python标准库及系统`Rar.exe`，无外部不可信依赖或远程下载行为。
3.  **良性载荷**：脚本中定义的`PAYLOAD`为无害的BAT命令，不包含任何恶意功能。
综合来看，该POC自身是安全的漏洞利用生成工具，旨在协助安全研究。但需警惕威胁行为者可能修改公开POC，替换恶意载荷或植入后门，从而将其转化为实际攻击武器。在使用任何第三方POC时，务必进行彻底的代码审计。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
