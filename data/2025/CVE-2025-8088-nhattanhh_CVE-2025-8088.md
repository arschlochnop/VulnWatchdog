## CVE-2025-8088 - WinRAR 路径遍历/目录穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 7.8

**影响版本:** 7.12 及以下版本

**利用条件:** 用户下载并解压攻击者构造的恶意RAR压缩文件

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：提供的Python脚本是一个功能完整的自动化漏洞利用构造工具。该脚本通过利用Windows NTFS文件系统的备用数据流（ADS, Alternate Data Stream）特性来规避WinRAR的安全检查。在构造过程中，它首先创建占位符文件，并使用ADS语法将Payload（如payload.bat）隐匿于文件流中。脚本通过操作RAR5格式的块头部，精细地修改文件路径属性，将ADS路径替换为包含‘../’等目录跳转字符的绝对路径或相对路径。由于WinRAR在旧版本中对带有冒号的ADS路径处理不当，解压时会将Payload释放到系统关键目录（如启动目录）。分析显示，脚本逻辑严密，涉及RAR头部结构偏移计算（get_vint）、校验和重新计算以及二进制补丁技术，能够生成可以直接触发漏洞的恶意压缩包，有效性极高。利用步骤：1. 编写恶意Payload（如.exe或.bat脚本）；2. 运行POC脚本，脚本将调用本地WinRAR命令行工具（rar.exe）创建基础压缩包；3. 脚本在二进制层面修改压缩包文件头，将文件名指向带有目录穿越字符的ADS路径（如：AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat）；4. 诱导目标用户使用WinRAR解压该文件；5. 恶意文件被释放到启动目录，待用户下次登录时自动执行。投毒风险分析：该POC脚本代码逻辑透明，主要使用了Python标准库（os, struct, zlib, pathlib）和子进程调用（subprocess），未发现明显的恶意混淆代码、外部下载指令或针对执行者本机的攻击行为。风险点在于：1. 脚本会自动寻找并调用本地的Rar.exe，虽然是为生成压缩包，但在不受信任的环境下运行可能导致非预期的文件操作；2. 脚本中预设的释放路径为Windows启动项，若研究人员不慎在本机测试生成的压缩包，可能导致自我感染。总体而言，该脚本属于标准的漏洞利用开发工具，投毒风险较低，但由于其产生的产物（exploit.rar）具有极强的攻击性，建议在隔离的沙盒环境中使用。其对ADS和RAR5结构的直接操作也对防御者理解此类隐蔽路径遍历提供了极高的参考价值。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
