## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** 7.12 及以下版本

**利用条件:** 需要诱导用户下载并使用受影响版本的 WinRAR 解压经过特殊构造的恶意 RAR 压缩文件。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC脚本通过Python自动化构建了一个针对CVE-2025-8088的漏洞利用链。其核心逻辑利用了Windows NTFS文件系统的备用数据流（ADS）特性。脚本通过调用系统中的Rar.exe创建一个基础压缩包，随后以二进制方式解析RAR5格式的文件头。关键步骤在于定位文件头中的文件名存储区域，并利用预留的占位符（Placeholder）空间，将原本正常的ADS路径（如file:payload）替换为带有目录遍历序列的恶意路径（如file:../../../../AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/payload.bat）。分析显示，该POC逻辑严密，涵盖了从诱饵文件创建、ADS流附加、二进制头修改到CRC32校验重算的完整过程。这种利用方式极具迷惑性，因为在WinRAR界面中，用户只能看到正常的诱饵文件（如file1.txt），而实际解压时，WinRAR会错误地处理ADS路径中的遍历字符，导致负载文件被静默写入系统启动项或其他敏感目录。此POC在安装有WinRAR 7.12或更早版本的Windows环境下具有极高的成功率，且能有效绕过部分基于文件扩展名检查的安全防护软件。\n\n【利用步骤】1. 攻击者准备Payload文件（如bat或exe）和若干正常诱饵文件。2. 运行POC脚本，脚本首先创建带有ADS流的诱饵文件，确保负载被隐藏在NTFS特性中。3. 脚本调用WinRAR命令行工具生成基础压缩包。4. 脚本以二进制模式打开压缩包，搜索特定的特征码，将原本指向ADS的路径修改为包含多个“../”跳转符的路径。5. 重新计算并更新RAR块的CRC校验值，确保压缩包结构完整且不会报错。6. 攻击者将生成的exploit.rar通过邮件或下载链接发送给受害者。7. 受害者使用WinRAR解压该文件，Payload会自动释放到预设的Windows启动目录中，在下次登录时执行。\n\n【投毒风险分析】该POC项目目前的投毒风险评级为低（15%）。通过对代码逻辑的逐行审计，可以确认脚本主要依赖Python标准库（os, struct, zlib, pathlib）和子进程调用（subprocess），没有引入外部不明依赖或加密的网络请求。代码中虽然包含了生成Payload（payload.bat）的操作，但其内容仅为简单的“echo”和“pause”命令，属于典型的无害化演示代码，符合防御性安全研究的规范。然而，该脚本提供的自动化RAR结构修改框架具有很强的通用性，攻击者可以轻易地将其中的PAYLOAD常量替换为真正的恶意木马（如Cobalt Strike Beacon）。在投毒风险方面，主要的潜在威胁源于第三方分发渠道。如果该脚本被重新打包发布，攻击者可能会在`create_base_rar`函数或`attach_ads`逻辑中插入隐蔽的文件读写操作，窃取本地敏感文件或在执行者机器上静默植入后门。因此，建议安全研究员仅在受控的沙盒环境中使用此类脚本，并始终对下载的自动化工具进行MD5校验和代码审计。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
