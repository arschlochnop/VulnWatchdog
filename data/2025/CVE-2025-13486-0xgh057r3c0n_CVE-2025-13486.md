## CVE-2025-13486 - Advanced Custom Fields: Extended WordPress plugin Remote Code Execution

**漏洞编号:** CVE-2025-13486

**漏洞类型:** Remote Code Execution

**影响应用:** Advanced Custom Fields: Extended WordPress plugin

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 0.9.0.5 through 0.9.1.1

**利用条件:** Unauthenticated, publicly accessible ACFE forms

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 20%

## 详情

CVE-2025-13486是WordPress ACF Extended插件中的一个未经身份验证的远程代码执行漏洞。该漏洞存在于0.9.0.5到0.9.1.1版本中，由于module-form-front-render.php中的prepare_form()函数不安全地使用了call_user_func_array()。如果网站公开访问ACFE表单，攻击者可以从页面JavaScript中提取ACF nonce，并使用它通过恶意的form[render]参数调用render_form_ajax端点，从而导致任意PHP函数执行。

POC有效性分析：
POC代码是一个Nuclei模板，它通过发送HTTP请求来验证漏洞。模板首先尝试从几个常见的ACFE表单页面位置（/, /contact, /contact-us, /register, /signup, /apply）获取ACF nonce。然后，它使用提取的nonce和恶意的form[render]参数向render_form_ajax端点发送POST请求，尝试执行任意PHP代码。如果服务器返回预期的响应，则漏洞被认为是存在的。该POC相当有效，因为它模拟了真实的攻击场景，并且可以自动执行，从而快速识别易受攻击的系统。该POC还包括了关于受影响版本，修复方法以及关于该漏洞的其他参考信息。

利用步骤：
1. 确定目标WordPress网站是否安装并启用了受影响版本的ACF Extended插件。
2. 确定目标网站上是否存在公开访问的ACFE表单。常见的表单页面包括根目录(/), 联系页面(/contact), 注册页面(/register)等。
3. 使用Burp Suite或类似的工具，拦截包含ACF表单的页面的HTTP响应。
4. 在HTML源代码中搜索ACF nonce值，通常位于JavaScript代码中。
5. 构造一个包含提取的ACF nonce和恶意的form[render]参数的POST请求，该参数包含要执行的PHP代码。例如，可以使用system()函数执行操作系统命令。
6. 将构造的POST请求发送到render_form_ajax端点。
7. 检查响应，确认是否成功执行了恶意PHP代码。如果成功执行，则服务器将返回相应的输出。

投毒风险分析：
该POC本身不包含明显的投毒代码，因为它主要关注于利用现有的RCE漏洞。然而，攻击者可能会通过以下方式利用此漏洞进行投毒：
1. 注入恶意代码：攻击者可以通过RCE漏洞在目标服务器上注入恶意代码，例如后门、恶意软件或网络钓鱼页面。这些恶意代码可能会被伪装成合法文件，从而逃避检测。
2. 修改现有文件：攻击者可以修改现有的网站文件，例如主题文件或插件文件，以包含恶意代码。这可能会导致网站行为异常，并对用户造成损害。
3. 创建恶意管理员账户：攻击者可以利用RCE漏洞创建一个具有管理员权限的恶意账户。然后，他们可以使用此账户来完全控制网站，包括安装恶意插件、修改网站内容和窃取用户数据。
4. 通过模板注入恶意代码：该POC本身是一个nuclei模板，虽然这个模板本身目的是检测漏洞，但是如果被攻击者修改，可以被用于大规模的漏洞扫描和利用，造成更大的危害。

考虑到以上因素，该漏洞的投毒风险被评估为中等。虽然POC本身不包含明显的投毒代码，但攻击者可以利用此漏洞进行各种恶意活动，包括注入恶意代码、修改现有文件和创建恶意管理员账户。由于POC代码相对清晰，且主要使用标准库，无可疑行为，因此投毒风险定为20%。

**项目地址:** https://github.com/ThumpBo/CVE-2025-30208-EXP (虽然主要针对CVE-2025-30208, 但有助于理解类似RCE漏洞的利用方式)

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-13486
