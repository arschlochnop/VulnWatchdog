## CVE-2025-8088 - WinRAR 路径遍历/目录穿越，可导致任意代码执行

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越，可导致任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 高危，未提供具体CVSS评分

**影响版本:** WinRAR 7.12及以下版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll，通常也涵盖7.13以下版本)

**利用条件:** 需要用户交互 (受害者解压恶意RAR压缩包)

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

CVE-2025-8088是一个影响WinRAR压缩软件的严重安全漏洞，被归类为路径遍历（或目录穿越）漏洞，最终可导致任意代码执行。攻击者可以精心构造恶意的RAR压缩包，利用Windows NTFS备用数据流（ADS）特性和路径遍历技术，绕过WinRAR的文件验证机制。当受害者使用受影响版本的WinRAR解压此恶意压缩包时，攻击者可将恶意文件（例如，一个可执行文件或脚本）释放到系统中的任意指定位置，特别是那些系统启动时会自动执行的目录，例如用户的启动文件夹（C:\Users\[username]\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup）。一旦恶意文件被释放到这些关键位置，它将在用户下次登录或系统启动时自动运行，从而实现任意代码执行，完全控制受害者的系统。此漏洞影响WinRAR 7.12及以下版本，包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll等组件。已有报告指出，该漏洞已被UNC4895 (RomCom)、APT44、Turla等间谍组织武器化，用于针对乌克兰军事及政府机构的攻击，且有中国境内的非法攻击团伙利用。

POC有效性分析与利用步骤：
提供的POC是一个Python实现的RAR文件生成器，名为exploit_cli.py。该工具旨在利用CVE-2025-8088漏洞，创建携带恶意载荷的RAR压缩包。该POC功能完整且易于使用，通过命令行参数指定恶意载荷文件（--payload）、输出的RAR文件名（--output），并可选择性地提供诱饵文件（--decoy）、目标用户名（--username）以及路径遍历的层级数（--max-up）和占位符长度（--placeholder-len）。根据README.md的说明，该工具能够生成一个“看似合法”的RAR文件，当受害者解压时，它能执行预设的payload。
其利用步骤如下：
1.  准备恶意载荷：攻击者首先需要准备一个恶意可执行文件或脚本，例如payload.exe。
2.  生成恶意RAR：攻击者在本地运行exploit_cli.py脚本，使用准备好的载荷文件生成恶意RAR。例如，命令可能类似于：python3 exploit_cli.py -p payload.exe -o exploit.rar --username VictimUser --max-up 12。这将创建一个名为exploit.rar的压缩包，其内部构造利用了路径遍历和ADS特性。
3.  社会工程学诱导：攻击者通过钓鱼邮件、恶意网站下载或其他社会工程学手段，诱骗目标用户下载并解压exploit.rar。诱饵文件可以伪装成看似无害的文档。
4.  漏洞触发与载荷释放：当目标用户使用受影响的WinRAR版本（如7.12或更早版本）解压exploit.rar时，由于路径遍历漏洞，恶意载荷文件（例如payload.exe）不会被解压到用户选择的路径，而是被悄无声息地释放到攻击者指定的高权限或自启动目录（如目标用户的Startup文件夹）。同时，ADS特性可能被用于隐藏恶意文件或其部分数据，增加检测难度。
5.  任意代码执行：恶意载荷一旦被释放到自启动目录，在受害者下次重启电脑或重新登录时，系统将自动执行该载荷，从而在受害者机器上实现任意代码执行。

投毒风险分析：
对于所提供的POC代码本身，投毒风险评估为低风险，约为5%。该POC是一个Python脚本，通常Python代码的透明度较高，易于审计和理解其行为。README.md文件清晰地阐明了该项目的教育和研究目的，并明确警告其不应用于未经授权的真实系统。在审查的POC代码片段中，没有发现明显的代码混淆、调用外部恶意脚本、连接可疑的远程服务器以下载额外组件，或包含任何直接危害运行POC代码的主机的恶意行为。该脚本的核心功能是生成一个恶意 *RAR文件*，而非其自身带有后门。它主要依赖Python标准库，且逻辑聚焦于构造利用漏洞的压缩文件结构。
然而，即使POC代码本身是干净的，使用此类工具也存在间接风险：
1.  载荷来源风险：用户需要提供一个payload.exe。如果这个载荷文件本身是恶意的或包含后门，那么最终生成的RAR文件将是危险的。用户必须确保其提供的载荷是安全的。
2.  供应链风险：如果POC代码的来源不可信，攻击者可能在其中植入后门。因此，用户应从可靠的源获取并仔细审查任何安全研究工具。
3.  误用风险：尽管有警告，但如果使用者不慎在未授权的环境中使用该工具，可能会造成意外的系统破坏或法律后果。
总而言之，该POC代码本身没有展现出投毒行为，其风险主要源于其生成恶意文件的性质以及用户自身对载荷和来源的把控。

**项目地址:** 未提供公开仓库地址，仅为本地文件路径

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
