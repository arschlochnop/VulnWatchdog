## CVE-2025-8088 - WinRAR 路径穿越 (Path Traversal), 远程代码执行 (Remote Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径穿越 (Path Traversal), 远程代码执行 (Remote Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危，可导致未经授权的远程代码执行。

**CVSS评分:** 待定 (尚未公布)

**影响版本:** WinRAR 7.12 及更早版本，以及所有未打官方补丁的早期版本。影响Windows 10/11操作系统，x86和x64架构。

**利用条件:** 需要用户交互（受害者解压恶意的RAR文件）。攻击无需认证，仅需将恶意RAR文件传递给目标用户。

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Exploit Generator)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR压缩工具的路径穿越与远程代码执行漏洞。该漏洞的本质是WinRAR在解压构造特殊的RAR文件时，未能正确处理其中包含的路径跳转字符（如`../`），导致攻击者可以控制文件在受害者系统上的解压目标路径，从而将恶意文件放置到任意可写目录。当结合将文件放置到系统启动目录（例如`C:\Users\<Username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）时，即可实现开机自启动或下次用户登录时的任意代码执行，对受害者系统造成严重影响。

**POC有效性分析：**
该POC是一个功能完整的Python脚本，设计用于生成恶意RAR文件以利用CVE-2025-8088漏洞。它由`README.md`文件、CLI接口`exploit.py`以及核心逻辑模块`exploit_core.py`组成（后一模块虽未直接提供，但其存在通过`exploit.py`的导入可推断）。`exploit.py`脚本提供了清晰的命令行参数，允许攻击者指定恶意payload文件（`--payload`）、输出的恶意RAR文件名（`--output`）、可选的诱饵文件（`--decoy`）、目标用户名称（`--username`）、ADS占位符长度（`--placeholder-len`）以及路径穿越的目录层级数（`--max-up`）。脚本的工作原理是，将用户提供的可执行payload文件（例如`payload.exe`）嵌入到一个精心构造的RAR压缩包中。在生成过程中，POC利用了WinRAR的路径穿越弱点，将payload的解压目标路径设置为一个系统敏感目录，如Windows启动项目录。通过这种方式，一旦受害者使用存在漏洞的WinRAR版本解压此恶意RAR文件，payload就会被放置到指定位置，并在系统重启或用户登录时自动执行。POC的结构清晰，参数化程度高，使得生成特定攻击场景下的恶意RAR文件变得简单且高效，证实了该漏洞的严重性和可利用性。

**利用步骤：**
1.  **准备Payload：** 攻击者首先需要准备一个恶意的可执行文件（例如后门程序、勒索软件等），作为最终在受害者系统上执行的payload。
2.  **获取POC：** 攻击者从GitHub等渠道下载`CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit`项目。
3.  **生成恶意RAR：** 攻击者使用提供的Python脚本生成恶意RAR文件。例如，可以执行以下命令：
    `python3 exploit_cli.py --payload /path/to/malware.exe --output evil.rar --username VictimUser --max-up 12 --decoy /path/to/legit_document.txt`
    其中，`malware.exe`是恶意payload，`evil.rar`是生成的恶意压缩包，`VictimUser`是目标用户的系统用户名，`legit_document.txt`是可选的诱饵文件。
4.  **社会工程学投递：** 攻击者通过电子邮件附件、恶意网站下载链接、即时通讯工具等社会工程学手段，将生成的`evil.rar`文件投递给目标用户。通常会搭配具有诱惑性的文件名或描述，诱导用户打开。
5.  **用户解压：** 受害者在不知情的情况下，使用存在CVE-2025-8088漏洞的WinRAR版本（即WinRAR 7.12或更早版本）解压了`evil.rar`文件。
6.  **代码执行：** 在解压过程中，恶意payload（`malware.exe`）由于路径穿越漏洞被写入到如“启动”文件夹等高权限或自启动目录。当受害者下次重启计算机或登录系统时，payload会自动运行，从而实现攻击者预期的远程代码执行效果。

**投毒风险分析：**
根据提供的`README.md`和`exploit.py`代码片段，该POC的投毒风险评估为低（10%）。

1.  **代码透明性：** `exploit.py`代码片段结构清晰，参数和功能定义明确，没有发现明显的代码混淆、加密或难以理解的逻辑。其主要功能是作为命令行接口，将用户提供的payload和配置参数传递给核心逻辑模块`exploit_core.py`。
2.  **无内置恶意Payload：** POC本身不包含任何预设的恶意payload。它是一个“利用工具”，需要用户（攻击者或研究人员）主动提供一个外部的`payload.exe`文件。这意味着POC本身并非病毒或恶意软件，而是生成恶意文件的工具。
3.  **无外部网络请求：** 在提供的代码片段中，没有发现直接进行外部网络连接、下载可执行文件或从远程服务器获取指令的API调用或代码逻辑。其操作主要集中在本地文件系统和RAR文件格式的构造上。
4.  **依赖本地模块：** POC依赖于本地的`exploit_core`模块，假设该模块也遵循类似的透明度原则，则整体风险较低。如果`exploit_core.py`被恶意修改，则风险会升高。
5.  **警示信息：** `README.md`明确指出该项目仅用于“教育和研究目的”，并警告“不应在未经明确授权的真实系统中使用”，这表明了作者的意图并非提供恶意软件本身。
尽管POC代码本身投毒风险较低，但任何安全工具在传播过程中都可能被不法分子篡改或捆绑恶意软件。因此，用户在下载此类工具时，仍应从官方或可信来源获取，并进行必要的安全审计，如文件哈希校验、杀毒软件扫描以及代码审查，以确保其完整性和安全性。

**项目地址:** https://github.com/sxyrxyy/CVE-2025-8088-WinRAR-Proof-of-Concept-PoC-Exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
