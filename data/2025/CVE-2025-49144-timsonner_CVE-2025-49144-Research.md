## CVE-2025-49144 - Notepad++ 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Notepad++

**危害等级:** 高危

**CVSS评分:** Awaiting Analysis

**影响版本:** 8.8.1 及更早版本

**利用条件:** 需要用户交互（社会工程学或点击劫持诱导下载并运行），本地访问。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-49144漏洞影响Notepad++安装程序版本8.8.1及更早版本。这是一个权限提升漏洞，源于安装程序中存在不安全的程序搜索路径。具体来说，当合法Notepad++安装程序执行时，它会尝试加载某些系统二进制文件或库。由于存在缺陷的搜索路径机制，如果攻击者将恶意可执行文件或DLL（例如，像FreeBuf文章中提到的`regsvr32.exe`）放置在与Notepad++安装程序相同的目录下，安装程序将优先加载攻击者的恶意文件而非合法的系统文件。由于安装程序通常以SYSTEM权限运行，恶意文件也将以SYSTEM级别权限执行，从而使攻击者获得对受感染机器的完全控制权。

**POC有效性分析：**
根据提供的搜索结果，特别是来自FreeBuf和CSDN的文章，明确指出存在针对此漏洞的“超详细复现”，这表明存在可靠且有效的概念验证（POC）代码。CSDN博客直接链接到一个GitHub存储库（`https://github.com/TheTorjanCaptain/CVE-2025-49144_PoC`），其中很可能包含一个完整的、可工作的漏洞利用程序。这种“不安全的程序搜索路径”或“DLL劫持”是众所周知的漏洞类型，且被广泛利用。输入数据中提供的POC文件，如`call-agent.cs`和`call-agent-no-prompt.cs`，是用于启动Notepad++安装程序的C#程序。虽然这些特定的C#文件本身不包含恶意有效载荷，但它们是触发漏洞利用链的组成部分。`call-agent-no-prompt.cs`文件还试图删除“Web标记”（Zone.Identifier），以绕过安全警告，这是社会工程学攻击中常见的技术，旨在使恶意软件包看起来更合法。多个公开报告、详细的复现步骤以及专门的GitHub存储库的存在，证实了此漏洞POC的高效性和可用性。该漏洞被认为是高危漏洞，因为它允许将本地权限提升到SYSTEM，这是攻击者高度追求的权限。

**利用步骤：**
1.  **制作恶意载荷**：攻击者首先创建一个恶意可执行文件或动态链接库（DLL），执行所需的恶意操作（例如，建立持久后门、数据窃取、执行任意代码）。此载荷必须经过特定命名，以便被Notepad++安装程序劫持（例如，FreeBuf中提到的`regsvr32.exe`，或者如果是DLL劫持漏洞，则为特定的DLL）。
2.  **社会工程学/投递**：攻击者将合法的Notepad++ v8.8.1（或更早版本）安装程序与其恶意载荷捆绑在一起。这个捆绑包（例如，一个ZIP压缩文件）随后通过社会工程学、网络钓鱼邮件或点击劫持等方式传递给受害者，诱导受害者将两个文件都下载到**同一目录**。
3.  **受害者执行**：受害者误以为正在安装合法的Notepad++更新，从而执行Notepad++安装程序。
4.  **权限提升**：由于不安全的搜索路径漏洞，Notepad++安装程序在以SYSTEM权限运行时，将从当前目录加载并执行攻击者的恶意载荷，而不是合法的系统文件。
5.  **系统沦陷**：恶意载荷以SYSTEM权限执行，使攻击者完全控制受害者的机器。

**投毒风险分析：**
关于**提供的POC代码**（`call-agent.cs`和`call-agent-no-prompt.cs`）的投毒风险，评估为**低（10%）**。这些C#文件是简单的程序，其唯一目的是定位并启动Notepad++安装程序。它们不包含任何混淆代码、可疑的网络请求、外部脚本引用或明显的恶意载荷。`call-agent-no-prompt.cs`文件确实包含一个调用`DeleteFile`来移除“Web标记”的功能，这有时是恶意活动中用于减少用户阻碍的技术。然而，在POC的上下文中，这是一个合法的演示更流畅利用流程的功能，并非POC本身固有的恶意行为。因此，直接执行这些特定的C# POC文件，在没有附带攻击者提供的恶意载荷的情况下，只会启动Notepad++安装程序，并带来极小的直接风险。

然而，理解**CVE-2025-49144漏洞本身的性质**至关重要，它依赖于攻击者通过引入恶意可执行文件或DLL来“投毒”执行环境。攻击场景涉及诱骗用户将攻击者控制的文件与合法安装程序一起下载。攻击者随后会使用一个**单独的、真正恶意的载荷**（未包含在输入POC中，但在利用步骤中已描述）来实现实际的系统沦陷。如果提供的POC代码是更大、攻击者控制的捆绑包的一部分，则由于外部恶意组件的存在，风险将显著增高。从防御者的角度来看，任何包含易受攻击的Notepad++安装程序以及同一目录中任何**意外可执行文件或DLL**的软件包，都应被视为高风险，因为它存在这种搜索路径劫持的可能性。此处提供的POC文件本身是干净的，但它们是通向攻击向量的门户，而该攻击向量本质上涉及攻击者进行恶意文件注入。

**项目地址:** https://github.com/TheTorjanCaptain/CVE-2025-49144_PoC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
