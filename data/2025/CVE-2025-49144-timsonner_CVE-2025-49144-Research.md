## CVE-2025-49144 - Notepad++ 权限提升 (LPE) / 搜索路径不安全加载

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升 (LPE) / 搜索路径不安全加载

**影响应用:** Notepad++

**危害等级:** 高 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (估算)

**影响版本:** 8.8.1 及之前的版本

**利用条件:** 攻击者需诱导用户将恶意可执行文件或DLL与合法的Notepad++安装程序放置在同一目录下并执行安装程序。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞属于典型的二进制程序安装包路径搜索优先级漏洞（Uncontrolled Search Path Element）。根据提供的POC代码片段分析，其核心逻辑并非漏洞利用的主体，而是辅助执行。代码 `call-agent-no-prompt.cs` 展示了攻击者如何尝试移除文件的“Mark of the Web”（Zone.Identifier），这是一个关键的防御机制，用于触发安全警告。通过调用 `kernel32.dll` 中的 `DeleteFile` 函数删除该备用数据流，攻击者可以使恶意安装程序在启动时不再弹出“来自互联网的文件”这一类的安全提示，从而降低用户的警惕性。POC中引用的 `installer_Win8_Win11_x64_*.exe` 暗示了该漏洞主要影响Windows平台的安装程序。实际上，该漏洞的成因在于Notepad++安装程序在执行时，会以 SYSTEM 权限尝试加载同目录下的特定DLL或可执行文件。由于Windows搜索路径的特性，当前目录（CWD）往往具有较高的优先级。虽然提供的C#代码只是一个启动器，但它揭示了利用链的第一步：通过社工手段将恶意Payload放置在安装包同目录。真正的漏洞利用效果（获取SYSTEM权限）取决于Notepad++安装程序在提升权限后是否未校验路径地执行了同目录下的二进制文件。目前公开的POC片段更像是一个环境准备工具，而非一键式Exploit，因此有效性评分为4分，属于概念验证级别。【利用步骤】1. 攻击者准备一个经过特制的恶意DLL或可执行文件，重命名为安装程序预备加载的特定名称。2. 使用社会工程学手段（如钓鱼邮件、虚假软件下载站）诱导用户下载合法的Notepad++ v8.8.1安装程序和该恶意文件。3. 诱导用户将两者保存在同一文件夹（通常是‘下载’文件夹）。4. 攻击者可能通过提供的C#启动器脚本（如call-agent.cs）来触发安装程序，该脚本会自动识别并执行安装包。5. 当安装程序运行时，由于其清单（Manifest）要求管理员权限，Windows会弹出UAC提示。6. 用户授权后，安装程序以高权限运行，并错误地加载了同目录下的恶意文件，导致攻击者代码在SYSTEM上下文执行。【投毒风险分析】该POC的投毒风险处于较低水平（约15%）。分析提供的C#源代码，其逻辑相对透明，主要使用了 `System.Diagnostics` 和 `System.IO` 等标准命名空间。其中 `DeleteFile(zoneIdentifierPath)` 虽然具有一定的对抗杀软和安全策略的特征，但这在安全研究领域属于常见的技术展示，目的是演示如何绕过简单的系统限制。代码中没有发现任何混淆、加密、反调试或下发远程木马（RAT）的行为。搜索结果中提到的 GitHub 仓库 (ammarm0010/CVE-2025-49144_PoC) 更多是作为安全教育和知识普及。然而，由于该漏洞涉及“安装包同目录加载”，在防御此类漏洞时，需警惕攻击者将此类启动脚本打包成看似无害的‘一键安装助手’。目前提供的代码片段是纯粹的C#源码，不包含编译后的二进制文件，且没有任何网络通信（Socket）或持久化代码，故判定其本身不具备主动投毒特征，属于防御性研究范畴。安全团队应关注的是其演示的‘删除Zone.Identifier’技术可能被其他恶意程序整合。

**项目地址:** [https://github.com/ammarm0010/CVE-2025-49144_PoC](https://github.com/ammarm0010/CVE-2025-49144_PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)
