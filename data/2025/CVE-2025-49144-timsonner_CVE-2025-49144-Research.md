## CVE-2025-8088 - WinRAR 路径遍历/目录遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 7.8 (预计)

**影响版本:** WinRAR < 7.13

**利用条件:** 用户下载并解压经过恶意构造的压缩文件

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 25%

## 详情

POC有效性分析：根据提供的POC文件分析，该代码片段（C#编写）并非直接利用WinRAR的路径遍历漏洞，而是一个用于触发和绕过系统安全检查的辅助工具。代码展示了如何利用DeleteFile函数移除Windows系统中的'Mark of the Web'（Zone.Identifier），这是一个关键的防御机制。当用户从互联网下载文件时，NTFS流会添加此标识以触发SmartScreen或运行警告。POC通过删除该流，使得攻击者构造的恶意exe安装程序（如installer_Win8_Win11_x64_*.exe）可以在无提示的情况下启动。结合搜索结果中的CVE-2025-8088，该漏洞本质上是WinRAR在处理压缩包内文件路径时存在的目录遍历缺陷，允许攻击者将恶意文件写入非预期目录（如启动目录或系统路径）。当前提供的C#代码更像是一个加载器或执行辅助脚本，验证了在文件落地后的静默执行能力，但并未包含完整的WinRAR漏洞触发逻辑（即构造恶意ZIP/RAR的逻辑）。利用步骤：1. 攻击者创建一个包含目录遍历序列（如../）的恶意压缩包，其中包含伪装成合法文件的恶意可执行程序。2. 攻击者通过社会工程学手段诱导用户使用旧版WinRAR（<7.13）打开并解压。3. 漏洞触发后，恶意程序被解压到系统敏感路径或当前执行目录。4. 结合类似POC中的DeleteFile逻辑，清除文件的Web标记，最终实现静默提权或持久化执行。投毒风险分析：该POC代码本身表现出中低度的投毒风险。虽然它使用了kernel32.dll的P/Invoke调用来删除系统元数据（Zone.Identifier），这在合法的软件安装程序中较为少见，通常是恶意软件规避安全检测的典型特征。然而，代码逻辑清晰透明，没有经过任何混淆处理，且不包含网络外传行为或加密载荷。其主要功能是辅助漏洞利用中的‘落地执行’阶段。对于安全研究人员而言，直接运行此类编译后的二进制文件存在风险，因为其目的是启动一个名为'installer_Win8_Win11_x64_*.exe'的文件，如果该执行文件被替换为真实木马，则会造成系统感染。防御建议是仅在受控的沙箱环境中审计源代码，并重点关注WinRAR版本更新，屏蔽不受信任的压缩包来源。该代码的威胁主要在于其提供的规避技术思路，而非代码本身的直接破坏性。

**项目地址:** [https://notepad-plus-plus.org/downloads/v8.8.1/](https://notepad-plus-plus.org/downloads/v8.8.1/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
