## CVE-2025-49144 - Notepad++ 特权提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 特权提升

**影响应用:** Notepad++

**危害等级:** 高，可导致系统完整入侵

**CVSS评分:** N/A

**影响版本:** Notepad++ v8.8.1 或更早版本

**利用条件:** 用户交互 (执行恶意安装程序), 目标系统需运行Windows操作系统

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-49144是一个影响Notepad++的特权提升漏洞，据搜索结果描述，该漏洞可能导致“系统完整入侵”。尽管没有明确的CVSS评分，但鉴于其潜在影响，危害等级为高。POC代码中提及了Notepad++ v8.8.1版本及相关校验和，表明该版本或更早版本可能受到影响。此漏洞的成功利用通常需要用户执行一个精心构造的恶意安装程序，从而在Windows操作系统上提升攻击者的权限。

**POC有效性分析：**
该POC由两个C#源代码文件（`call-agent.cs`和`call-agent-no-prompt.cs`）以及相关辅助文件（如`npp.8.8.1.checksums.sha256`和指向Notepad++ v8.8.1下载页面的`archive-org.txt`链接）组成。核心功能在于这两个C#程序：它们被设计用于启动一个名为`installer_Win8_Win11_x64_*.exe`的外部可执行文件，该文件预计与C#程序位于同一目录下。
`call-agent.cs`负责直接启动此安装程序。而`call-agent-no-prompt.cs`则更为复杂，它利用Windows API `DeleteFile`（从`kernel32.dll`导入）尝试删除目标安装程序的“Web标记”（`Zone.Identifier`）。“Web标记”是Windows用于识别从互联网下载文件的安全属性，通常会触发安全警告。通过移除此标记，`call-agent-no-prompt.cs`旨在使恶意安装程序看起来像是本地创建或受信任的文件，从而绕过Windows的安全提示。

从技术角度看，这些C#代码是完整且有效的。它们使用标准的.NET库（`System.Diagnostics`, `System.IO`, `System.Runtime.InteropServices`）并正确调用Windows API。因此，该POC在实现其特定目标——启动任意可执行文件并可选地绕过安全警告方面——是有效的。然而，需要强调的是，这个POC本身并不包含CVE-2025-49144的实际特权提升逻辑。它更像是一个精心设计的“投送与执行机制”，用于启动一个（假设为恶意且包含漏洞利用代码的）外部安装程序。因此，其作为“概念验证”是成功的，但并非完整的端到端特权提升漏洞利用代码。

**利用步骤：**
1.  **攻击者准备恶意安装程序：** 攻击者首先需要准备一个恶意安装程序（例如，`installer_Win8_Win11_x64_malicious.exe`），该程序内部包含针对CVE-2025-49144的特权提升利用代码。此安装程序通常会被伪装成合法的Notepad++更新或其他常用软件。 
2.  **编译和部署POC：** 攻击者将`call-agent-no-prompt.cs`编译成可执行文件（如`call-agent-no-prompt.exe`）。选择此版本是为了利用其绕过安全警告的功能。 
3.  **打包和分发：** 攻击者将恶意安装程序与编译后的`call-agent-no-prompt.exe`打包在一起，并通过鱼叉式网络钓鱼邮件、恶意网站下载或受感染的USB驱动器等方式分发给受害者，诱导其执行。 
4.  **用户交互与执行：** 受害者被社会工程学手段诱导，执行了`call-agent-no-prompt.exe`。 
5.  **绕过安全警告：** `call-agent-no-prompt.exe`运行后，会尝试删除同目录下恶意安装程序的“Web标记”。如果成功，当安装程序后续启动时，Windows将不再显示“您确定要运行此来自Internet的文件吗？”等安全警告，大大降低了用户的警惕性。 
6.  **启动恶意安装程序：** `call-agent-no-prompt.exe`随后启动恶意安装程序。 
7.  **特权提升：** 恶意安装程序被执行后，其内置的漏洞利用代码将触发CVE-2025-49144漏洞，成功提升攻击者在目标系统上的权限，最终可能导致系统完全受控。

**投毒风险分析：**
对提供的POC代码（`call-agent.cs`和`call-agent-no-prompt.cs`）进行的分析显示，其本身的投毒风险为**低**，约为10%。主要原因如下：
*   **代码透明度高：** C#源代码非常清晰、简洁且易于阅读。代码中没有任何混淆技术、恶意加密或难以理解的复杂逻辑，研究人员可以快速审计其功能。 
*   **标准库与API使用：** POC仅依赖于标准的.NET框架库（例如用于进程控制和文件路径操作）以及公开文档化的Windows API调用（`kernel32.dll::DeleteFile`）。没有发现使用非标准、可疑的第三方库或私有API，这降低了隐藏恶意功能的可能性。 
*   **无直接恶意载荷：** 源代码本身不包含任何直接的恶意载荷，例如后门、病毒、勒索软件、数据窃取功能或与C2服务器的通信。其核心功能仅限于文件管理操作（删除Zone.Identifier）和进程启动。 
*   **“Web标记”操作的性质：** 尽管移除“Web标记”是攻击者常用的绕过安全措施的手段，但`DeleteFile`函数本身是一个合法的系统操作。此操作的目的并非直接造成系统损害，而是为后续可能加载的恶意代码创造一个更畅通的执行环境。 

因此，从技术实现上讲，该POC代码是“干净”的。然而，其潜在的风险在于其作为**恶意载荷的交付工具**。攻击者完全可以将这个本身无害的POC与一个真正恶意的`installer_Win8_Win11_x64_*.exe`文件捆绑在一起。在这种情况下，POC的作用是降低目标系统对恶意安装程序的安全警报，从而辅助恶意载荷的成功执行和特权提升。安全研究人员在处理包含此类POC的完整漏洞利用包时，应重点关注由POC启动的外部可执行文件的内容，并始终在隔离的安全环境中进行分析。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49144
