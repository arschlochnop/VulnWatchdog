## CVE-2025-8088 - WinRAR 目录遍历 (Directory Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历 (Directory Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR < 7.13

**利用条件:** 用户解压并运行特制的恶意压缩包文件

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 45%

## 详情

POC有效性分析：根据搜索结果8显示，CVE-2025-8088是WinRAR在2025年修复的一个路径处理相关的目录遍历漏洞。提供的POC代码（call-agent-no-prompt.cs 和 call-agent.cs）并非漏洞本身的直接触发Payload，而是用于辅助利用的C#封装程序。代码试图通过调用DeleteFile(zoneIdentifierPath)来删除Windows的Zone.Identifier流，即所谓的Mark of the Web (MotW)。这是典型的防御绕过手段，旨在防止系统弹出‘由于文件来源未知，已阻止运行’的警告。核心代码逻辑在于拼接安装程序路径并使用ShellExecute启动进程。该POC的局限性在于它假设攻击者已经成功通过WinRAR漏洞将恶意可执行文件投递到了特定目录。它不包含漏洞触发的压缩包构造逻辑，因此只能作为利用链中的一部分。在实际防御研究中，该代码仅展示了如何在解压后静默执行程序的行为，其真实利用价值取决于WinRAR漏洞本身的稳定性。利用步骤：首先，攻击者需构造一个利用CVE-2025-8088目录遍历特性的压缩包，该包在解压时会将文件释放到攻击者预期的路径（如启动目录或特定系统目录）。其次，诱导目标用户使用旧版WinRAR（<7.13）解压该文件。若结合此C#辅助POC，它会尝试清理文件的Web标记，从而在后续静默执行时绕过SmartScreen提示。最后，执行恶意负载。投毒风险分析：该POC存在中等程度的投毒风险。虽然代码逻辑看似简单（C#调用WinAPI），但其关键行为——删除Zone.Identifier——是典型的恶意软件逃避技术。这种行为极易被杀毒软件（AV）或端点检测与响应（EDR）系统标记为威胁。分析POC项目时发现，其结构包含checksums校验文件和Archive.org的存档链接，这种复杂的外部依赖增加了供应链攻击的可能性。如果分发的npp.8.8.1.Installer.x64.exe等文件被篡改并重新打包，研究员在下载并运行此‘防御研究工具’时，可能会在不经意间执行带有后门的程序。特别是在call-agent-no-prompt.cs中使用了P/Invoke调用底层kernel32.dll，这种低级操作常被用于混淆真实的系统调用意图。建议在严格隔离的沙箱环境中分析此类工具，严禁在生产环境直接编译运行，以防该POC被用作针对安全研究员的‘钓鱼’载体。

**项目地址:** [https://notepad-plus-plus.org/downloads/v8.8.1/](https://notepad-plus-plus.org/downloads/v8.8.1/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
