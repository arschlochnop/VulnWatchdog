## CVE-2025-59287 - Windows Server Update Services (WSUS) 反序列化远程代码执行

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Windows Server Update Services (WSUS)

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 未知，POC针对WSUS环境

**利用条件:** 需要网络访问，可能需要低权限认证或绕过认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该POC代码("WSUS-CVE-2025-59287.ps1")是针对Windows Server Update Services (WSUS) 中CVE-2025-59287反序列化漏洞的完整利用脚本，可实现远程代码执行（RCE）。脚本自动化了攻击链：首先与WSUS `ReportingWebService`交互，获取`ServerId`和`AuthCookie`；接着，利用`ysoserial.exe`生成一个Base64编码的.NET `BinaryFormatter`反序列化Payload，该Payload旨在执行PowerShell反向Shell以连接到攻击者监听器。最后，脚本通过`New-ComputerObject`函数将恶意Payload嵌入SOAP请求中，触发WSUS服务器反序列化漏洞，从而获得服务器的远程控制。该POC结构清晰，参数化良好，展示了从信息收集到RCE的完整攻击流程，技术原理可靠。

**利用步骤:**
1. 攻击者设置Netcat监听器（如`nc -lvnp 4444`）。
2. 确保`ysoserial.exe`位于`./ysoserial/`路径。
3. 修改脚本中的`$wsusServer`、`$wsusPort`、`$ncHost`、`$ncPort`和`$computerObject`参数。
4. 运行PowerShell脚本，它将自动完成信息获取、Payload生成与发送，触发漏洞并建立反向Shell连接。

**投毒风险分析:**
该POC代码的投毒风险评估为低（10%）。脚本本身是合法的安全研究工具，目的在于演示WSUS反序列化漏洞的利用。代码清晰、未混淆，主要逻辑通过PowerShell实现。它依赖`ysoserial.exe`这一业界认可的开源安全工具来生成Payload。代码中生成的反向Shell是漏洞利用的预期行为，并非POC代码自身携带的额外恶意功能。未发现除与目标WSUS服务器和攻击者Netcat监听器通信之外的任何可疑行为。只要`ysoserial.exe`来自可信来源且脚本参数配置正确，该POC代码自身不会对执行环境造成意外恶意影响。风险主要在于误用或依赖的第三方工具（ysoserial）的潜在供应链风险。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-59287
