## CVE-2025-55182 - React Server Components, Next.js, react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, react-server-dom-parcel, react-server-dom-turbopack, react-server-dom-webpack

**危害等级:** 危急 (Critical)

**CVSS评分:** 10.0

**影响版本:** React Server Components versions 19.0.0, 19.1.0, 19.1.1, and 19.2.0; including packages: react-server-dom-parcel, react-server-dom-turbopack, and react-server-dom-webpack. Also impacts several Next.js/Node.js bundles utilizing these components.

**利用条件:** 预认证 (Pre-authentication), 远程 (Remote)

**POC 可用性:** 9/10

**POC 类型:** 检测工具 (Scanner)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

对CVE-2025-55182的分析表明，这是一个影响React Server Components的预认证远程代码执行（RCE）漏洞，CVSS v3.1基础评分为10.0，被CISA列入已知被利用漏洞目录。该漏洞的核心在于React Flight反序列化机制对对象属性访问路径（如`__proto__`、`constructor`）缺乏校验，导致原型链污染。

**POC有效性分析**
所提供的“POC代码”是一个名为VPS Continuous Scanner的工具，其目的并非直接利用CVE-2025-55182进行攻击，而是作为一种防御性安全研究工具，用于检测和验证目标系统中是否存在与此漏洞相关的指标。该工具设计精良，是一个基于Docker和Docker Compose的轻量级编排和工作扫描器设置，能够对拆分后的输入文件进行大规模/持续扫描。它通过Python脚本实现编排器和工作器，具备以下特点：高效处理大量输入文件、保持集群服务持续运行以加快重复扫描、生成按文件的输出并汇总去重结果。`README.md`文件清晰地阐述了工具的架构、功能、先决条件和系统要求。它明确指出工作扫描器会查找与不安全的Server Function端点和反序列化artifacts一致的指标，并将发现写入日志。值得注意的是，该工具明确声明“不利用漏洞——它只检测指标”，并且要求“未经明确授权，请勿尝试利用”。因此，作为一种漏洞检测工具，其功能完整、文档齐全且设计严谨，能够有效识别潜在的易受攻击系统，对于防御性安全团队而言具有很高的实用价值。

**利用步骤**
尽管提供的代码是检测工具，但CVE-2025-55182本身的利用是实现远程代码执行的关键。根据已公开的漏洞分析报告，攻击者可以在未认证的情况下，通过精心构造恶意请求来利用此漏洞。其典型利用步骤如下：
1.  **构造恶意Multipart表单**: 攻击者首先需要创建一个特制的multipart HTTP表单请求。这个请求将包含恶意序列化数据，旨在触发漏洞。
2.  **利用 `$B` 引用与 `_response._prefix`**: 在序列化数据中，攻击者会利用React Flight机制中的 `$B` 引用，并结合可控的 `_response._prefix` 值。这些元素被用来操纵反序列化过程中的对象结构。
3.  **劫持 `_formData.get` 为 `Function`**: 攻击的核心在于通过原型链污染，将一个合法的 `_formData.get` 方法（或其他可被控制且调用的属性）劫持或替换为一个 `Function` 对象。这意味着当系统试图调用这个被劫持的方法时，实际上会执行攻击者注入的代码。
4.  **动态生成包含系统命令的函数**: 攻击者通过构造反射调用或其他方式，在运行时动态生成一个包含任意系统命令（例如 `ls`, `cat /etc/passwd`，或反弹shell命令）的JavaScript函数。
5.  **赋值给对象的 `.then` 属性**: 将上一步生成的恶意函数赋值给一个对象（例如通过原型链污染创建的中间对象）的 `.then` 属性。在JavaScript环境中，Promise对象的 `.then` 方法是一个常见的代码执行点。
6.  **触发反序列化**: 当存在漏洞的React Server Component接收并反序列化这个精心构造的payload时，由于其未正确校验对象属性访问路径，攻击者注入的恶意函数会被执行，从而在目标服务器上实现远程代码执行，获得服务器的控制权限。整个过程无需任何认证，且可以通过网络远程触发。

**投毒风险分析**
对提供的“POC代码”——VPS Continuous Scanner进行投毒风险评估，结论是风险极低（10%）。
1.  **代码透明性与结构**: 代码库结构清晰，包含 `orchestrator.py`、`worker/scanner.py`、`worker/worker.py` 和 `Dockerfile` 等文件，职责分明。所有代码似乎都是开源且未混淆的，方便安全研究人员进行审计。`README.md` 文件提供了详尽的工具使用说明和架构描述，增强了透明度。
2.  **明确的声明**: 工具的 `README.md` 中明确指出：“This tool does not exploit vulnerabilities — it detects indicators. Do not attempt exploitation without explicit authorization.” 这一声明明确了其防御性研究目的，旨在帮助用户识别漏洞而非恶意利用。
3.  **依赖与环境**: 工具依赖 Docker、Docker Compose 和 Python 3.8+ 等标准、成熟的开源技术栈。这些依赖本身不包含已知恶意代码。工具在隔离的 Docker 容器中运行扫描任务，进一步降低了对宿主系统造成意外影响的风险。
4.  **网络行为**: 作为扫描器，其主要网络行为是向目标系统发送探测请求以识别漏洞指标，这是预期的、合法的安全扫描行为。`README.md` 中没有提及任何向第三方非扫描目标地址发送数据、下载未知外部脚本或建立C2通信等可疑行为。其输出文件被明确写入本地 `output/` 目录。
5.  **代码审查**: 尽管未能对完整的Python脚本进行深入审查，但从 `README.md` 描述的功能来看，没有迹象表明存在代码混淆、加密、利用系统后门或执行恶意指令等高风险行为。其设计目标是检测而非利用，这与恶意软件的行为模式截然不同。鉴于该工具的明确防御性目的、透明的代码结构、对标准技术的依赖以及缺乏任何可疑的恶意行为迹象，其作为合法安全研究工具的投毒风险被评估为低。用户在部署前仍应进行必要的代码审计，以确保其完全符合组织的安全策略。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
