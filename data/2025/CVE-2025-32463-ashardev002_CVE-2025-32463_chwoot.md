## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** Sudo 1.9.17p1 之前版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463 存在于 Sudo 1.9.17p1 之前的版本中，允许本地用户通过 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获取 root 权限。该漏洞的根本原因是 Sudo 在使用 chroot 功能时，没有充分验证用户提供的配置文件的安全性，导致攻击者可以利用精心构造的配置文件来绕过权限检查，从而提升权限。

POC 有效性分析：
提供的 Dockerfile 构建了一个包含易受攻击版本 Sudo（1.9.16p2）的环境。Dockerfile 首先安装了必要的构建工具和依赖项，然后下载并编译了存在漏洞的 Sudo 版本。随后，它创建了一个名为 pwn 的普通用户，并将 PoC 脚本（sudo-chwoot.sh，未提供内容）复制到该用户的 home 目录。Dockerfile 的最后一步是将用户切换到 pwn 并启动一个 bash shell，允许用户执行 PoC 脚本。

从提供的 README.md 文件来看，该 PoC 的目的是演示如何通过 Sudo 二进制文件和 chroot 选项将权限提升到 root 用户。它提供了下载和运行 Docker 镜像的步骤，该镜像预配置了易受攻击的 Sudo 版本。通过执行提供的命令，用户可以在隔离的环境中重现该漏洞。

利用步骤：
1. 构建包含漏洞版本的 Sudo 的 Docker 镜像（使用提供的 Dockerfile）。
2. 运行 Docker 镜像，以 pwn 用户身份进入 shell 环境。
3. 执行 PoC 脚本 sudo-chwoot.sh（该脚本应包含利用该漏洞的具体步骤，例如，创建恶意的 /etc/nsswitch.conf 文件并使用 sudo chroot 执行命令）。
4. 成功利用后，pwn 用户应获得 root 权限。

投毒风险分析：
该 PoC 具有较低的投毒风险。Dockerfile 中使用的命令相对清晰，并且没有发现任何明显的恶意行为。PoC 的主要功能是演示漏洞利用，而不是部署后门或执行其他恶意操作。然而，仍然存在一些潜在的风险：
1. PoC 脚本 sudo-chwoot.sh 的内容未知，可能包含恶意代码。
2. Docker 镜像可能包含其他未知的漏洞或安全问题。
3. 用户可能在生产环境中错误地使用该 PoC，从而导致安全风险。

由于 sudo-chwoot.sh 的内容未知，因此无法完全排除投毒风险。但总体而言，该 PoC 的风险较低，主要用于安全研究和漏洞演示目的。建议用户在受控环境中运行该 PoC，并仔细审查所有代码，以确保其安全性。由于其使用标准的 Ubuntu 镜像和常规的构建步骤，且目标在于重现已知的提权漏洞，因此推测其投毒风险较低。
投毒风险主要集中在 `sudo-chwoot.sh` 脚本中，如果该脚本被替换为恶意脚本，则可能导致提权后执行恶意操作。但是考虑到该漏洞本身是提权漏洞，投毒脚本的危害与直接利用漏洞的危害相比，并没有显著增加。
综合评估，投毒风险较低，约为 10%。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
