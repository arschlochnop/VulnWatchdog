## CVE-2025-32463 - Sudo 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 未知

**影响版本:** Sudo 1.9.17p1之前版本

**利用条件:** 本地用户可控目录

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463 存在于 Sudo 1.9.17p1 之前的版本中，允许本地用户获得 root 权限。漏洞原因是当使用 `--chroot` 选项时，使用了用户控制目录中的 `/etc/nsswitch.conf` 文件。具体来说，当 sudo 使用 chroot 进入一个可由非特权用户写入和控制的目录时，它会使用 chroot 内部的 NSS 配置来解析用户信息。如果攻击者可以控制 chroot 目录及其中的 `nsswitch.conf` 文件，他们可以操纵 NSS 查询，导致 sudo 加载恶意共享库或执行其他恶意操作，从而提升权限。

POC有效性分析：
提供的 Dockerfile 构建了一个易受攻击的 Sudo 环境，版本为 1.9.16p2。它首先安装必要的构建工具和依赖项，然后从 sudo 官方仓库下载并编译易受攻击的 sudo 版本。Dockerfile 还会创建一个名为 pwn 的用户，并将 PoC 脚本 `sudo-chwoot.sh` 复制到该用户的 home 目录中。最后，Dockerfile 切换到 pwn 用户并启动一个 bash shell，允许用户在易受攻击的环境中执行 PoC 脚本。README.md 文件提供了有关漏洞的概述，以及如何下载、安装和运行 PoC 的说明。它还提供了有关受影响的技术和缓解步骤的信息。提供的docker image可以方便地搭建漏洞环境，POC利用脚本如果存在，可以一键触发漏洞，因此POC质量评分为8/10。

利用步骤：
1. 构建包含易受攻击 Sudo 版本的 Docker 镜像。
2. 运行 Docker 镜像并以 pwn 用户身份进入 shell。
3. 运行 PoC 脚本 `sudo-chwoot.sh`。
4. 脚本将利用漏洞来提升权限并获得 root 访问权限。

投毒风险分析：
提供的 Dockerfile 和 README.md 文件似乎不包含任何明显的恶意代码或行为。Dockerfile 仅用于构建易受攻击的 Sudo 环境，而 README.md 文件提供有关如何使用 PoC 的说明。但是，仍然存在一些投毒风险需要考虑：
1. PoC 脚本 `sudo-chwoot.sh` 可能包含恶意代码，旨在损害受攻击的系统。但是，由于未提供 `sudo-chwoot.sh` 的内容，因此无法确定此风险的程度。
2. Docker 镜像可能包含后门或其他恶意软件，这些软件可能会危及受攻击的系统。
3. README.md 文件可能包含指向恶意网站或文件的链接。总体而言，CVE-2025-32463 的投毒风险较低，估计为 10%。这是因为提供的文件似乎不包含任何明显的恶意代码或行为。但是，在执行 PoC 之前，务必仔细审查所有文件，并采取适当的预防措施以保护您的系统免受攻击。由于只是构建漏洞环境，且未发现明显后门代码，投毒风险评分为低。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
