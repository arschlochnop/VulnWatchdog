## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 1.9.17p1之前的所有版本，引入-R/--chroot选项后的版本(>=1.9.14)

**利用条件:** 本地用户

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo中的本地提权漏洞，该漏洞源于chroot实现中对非可信控制范围的处理不当。从Sudo 1.9.14版本开始，引入了-R/--chroot选项，允许用户在指定的chroot目录下执行具有root权限的命令。然而，如果用户可以控制/etc/nsswitch.conf文件，则可以利用此漏洞提升权限。

POC有效性分析：
提供的Dockerfile构建了一个包含漏洞版本的Sudo (1.9.16p2)的Ubuntu 24.04环境。Dockerfile首先安装了构建Sudo所需的依赖项，包括build-essential、libpam0g-dev、libselinux1-dev等。然后，从sudo.ws下载并编译了Sudo 1.9.16p2版本，并禁用了gcrypt。接下来，创建了一个名为pwn的普通用户，并将PoC脚本sudo-chwoot.sh复制到pwn用户的主目录，并更改了所有者。最后，Dockerfile切换到pwn用户，并启动一个bash shell。

利用步骤：
1. 构建包含漏洞环境的Docker镜像：docker build -t cve-2025-32463 .
2. 运行Docker容器：docker run -it cve-2025-32463
3. 在容器中，以pwn用户身份执行/home/pwn/sudo-chwoot.sh脚本。
该脚本应该能够利用该漏洞将pwn用户的权限提升为root权限。

sudo-chwoot.sh内容(从README推断):
该脚本可能包含以下步骤：
  a. 创建一个恶意的/etc/nsswitch.conf文件，该文件将导致Sudo加载用户控制的库。
  b. 使用sudo -R /path/to/chroot command执行命令，其中/path/to/chroot指向包含恶意nsswitch.conf的目录。
  c. 当Sudo加载恶意的nsswitch.conf时，它将执行用户控制的库，从而允许用户提升权限。

通过以上步骤，攻击者可以利用CVE-2025-32463漏洞获得root权限。

投毒风险分析：
该PoC的投毒风险较低。Dockerfile本身没有明显的恶意行为，只是构建了一个包含漏洞的Sudo环境。PoC脚本sudo-chwoot.sh可能会包含一些恶意代码，例如加载用户控制的库，但这些代码的目的是为了利用漏洞，而不是为了进行恶意攻击。不过，需要注意的是，如果攻击者修改了Dockerfile，例如添加了下载恶意软件的步骤，或者在PoC脚本中添加了恶意代码，则投毒风险会大大增加。

以下是一些可能存在的投毒风险：
1. Dockerfile可能包含下载恶意软件的步骤。
2. PoC脚本可能包含执行恶意代码的步骤，例如删除文件、修改系统配置等。
3. PoC脚本可能包含后门代码，允许攻击者远程访问系统。

尽管如此，根据现有信息，该PoC的投毒风险较低，约为10%。主要是考虑到该POC会修改nsswitch.conf配置文件，有一定的潜在风险。

**项目地址:** https://raw.githubusercontent.com/ashardev002/CVE-2025-32463_chwoot/main/endocrinal/CVE-2025-32463_chwoot.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
