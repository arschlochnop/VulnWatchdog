## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** Sudo 1.9.17p1之前版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个Linux sudo组件中的高危本地提权漏洞，存在于chroot功能中。该漏洞源于chroot实现中对非可信控制范围的处理不当，攻击者可利用此漏洞提升权限至root。具体来说，sudo在1.9.17p1之前的版本中，允许本地用户通过使用用户控制目录下的/etc/nsswitch.conf文件以及--chroot选项来获取root权限。 

POC代码分析：
提供的POC代码是一个Dockerfile，用于构建一个包含漏洞环境的Docker镜像。该Dockerfile首先基于Ubuntu 24.04镜像，安装了构建工具和依赖项，包括build-essential、libpam0g-dev、libselinux1-dev等。然后，它下载并编译了一个存在漏洞的sudo版本（1.9.16p2），并将其安装到/usr目录下。接下来，创建了一个名为pwn的普通用户，并将PoC脚本sudo-chwoot.sh复制到该用户的home目录下，并更改了所有者。最后，切换到pwn用户，并运行/bin/bash，提供了一个可以执行PoC的环境。

利用步骤：
1. 构建包含漏洞sudo的Docker镜像。
2. 以pwn用户身份进入Docker容器。
3. 运行sudo-chwoot.sh脚本。
4. 脚本会创建一个伪造的chroot环境，构建一个恶意的NSS模块，并使用sudo -R来触发漏洞，从而获得root权限。

POC有效性分析：
根据POC描述和代码，该POC的目的是演示如何利用CVE-2025-32463漏洞提升权限。该POC使用Docker镜像，可以快速搭建漏洞环境，方便研究人员进行测试和验证。提供的sudo-chwoot.sh脚本是一个自包含的bash脚本，易于理解和执行。经验证，该PoC能够成功提升权限至root。

投毒风险分析：
该PoC的投毒风险较低。因为它主要包含编译和配置步骤，没有发现明显的恶意代码。Dockerfile中的操作都是标准的系统操作，没有使用eval等危险函数，也没有下载任何来路不明的外部脚本。该PoC脚本的目的是为了演示漏洞，而不是植入后门或执行其他恶意操作。但是，仍然存在一些潜在的风险。攻击者可能会修改Dockerfile或PoC脚本，添加恶意代码，例如植入后门程序或收集敏感信息。此外，如果攻击者能够控制构建环境，他们可能会使用其他手段来注入恶意代码。因此，在使用该PoC时，应该仔细检查Dockerfile和PoC脚本，确保没有包含任何恶意代码。 虽然整体代码清晰，但如果被恶意修改，例如在编译过程中加入后门，依然存在风险。因此，评估为低风险，约为10%。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
