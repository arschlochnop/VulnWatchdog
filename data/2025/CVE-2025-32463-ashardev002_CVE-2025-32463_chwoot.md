## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** Sudo 1.9.14 到 1.9.17p1之前

**利用条件:** 本地用户

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 20%

## 详情

CVE-2025-32463是一个存在于Sudo中的本地提权漏洞，该漏洞源于chroot实现中对非可信控制范围的处理不当。攻击者可以利用此漏洞在受影响的系统上获取root权限。Sudo从1.9.14版本开始引入了一个-R/–chroot选项，允许用户通过该选项指定chroot的目录，并在该目录下执行具有root权限的命令。漏洞存在于1.9.17p1之前的版本中。该漏洞允许本地用户通过使用用户控制的/etc/nsswitch.conf文件和--chroot选项获得root权限。 

POC有效性分析：
提供的Dockerfile文件构建了一个包含漏洞版本的Sudo的Ubuntu 24.04环境。Dockerfile首先安装必要的构建工具和依赖项，然后下载并编译Sudo 1.9.16p2版本，该版本受此漏洞影响。它还创建一个名为pwn的普通用户，并将PoC脚本sudo-chwoot.sh复制到该用户的home目录。通过切换到pwn用户，该环境模拟了本地攻击者场景。提供的README.md文件解释了漏洞利用过程，包括下载Docker镜像、加载镜像以及运行容器的步骤。它还简要概述了漏洞的利用方式，参考了其他资源。文件下载链接指向托管在githubusercontent.com上的zip文件，其中包含docker镜像和脚本，以便进一步分析和测试。

利用步骤：
1. 构建包含易受攻击的Sudo版本的Docker镜像。
2. 以普通用户（例如，pwn）身份运行Docker容器。
3. 使用`sudo -R <user-controlled-directory> command` 命令，其中`<user-controlled-directory>`包含恶意的/etc/nsswitch.conf 文件。
4. 执行命令，利用不正确的chroot处理来提升到root权限。

投毒风险分析：
提供的Dockerfile从官方源下载sudo 1.9.16p2的tarball，降低了直接投毒的风险。但是，构建过程中仍然存在一些投毒的可能性。具体来说，恶意软件可能会篡改下载的sudo tarball，或者在构建过程中引入后门。尽管Dockerfile看起来很简单，但构建过程的复杂性（包括编译和安装sudo）为引入恶意代码提供了机会。此外，PoC脚本（sudo-chwoot.sh）也可能包含恶意代码。用户应仔细检查此脚本，然后再执行该脚本。由于项目托管在GitHub上，并且包含来自外部URL的下载，因此存在一定的风险。尽管Dockerfile本身看起来无害，但它所执行的操作可能会被利用。
投毒风险较低，约为20%，因为主要的构建步骤依赖于众所周知的源，并且提供的Dockerfile和README相对清晰。用户仍然需要谨慎，并验证所有下载内容的完整性，并且检查脚本内容，以确保其安全。

**项目地址:** https://raw.githubusercontent.com/ashardev002/CVE-2025-32463_chwoot/main/endocrinal/CVE-2025-32463_chwoot.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
