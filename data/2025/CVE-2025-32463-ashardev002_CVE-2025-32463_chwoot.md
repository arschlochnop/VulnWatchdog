## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** 1.9.17p1之前版本，从1.9.14版本引入chroot选项开始

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Linux Sudo 组件中的一个本地提权漏洞，该漏洞源于 chroot 实现中对非可信控制范围的处理不当。攻击者可以利用 `--chroot` 选项，使用用户控制的目录中的 `/etc/nsswitch.conf`，从而获得 root 权限。该漏洞存在于 Sudo 1.9.17p1 之前的版本中，从 1.9.14 版本开始引入了 `-R/–chroot` 选项。 

POC有效性分析：
提供的 Dockerfile 和 README.md 文件描述了漏洞的利用方式。Dockerfile 构建了一个包含漏洞版本的 Sudo 的 Ubuntu 24.04 镜像。其中，安装了 1.9.16p2 版本的 Sudo，并创建了一个名为 pwn 的普通用户。PoC 脚本 sudo-chwoot.sh 被复制到 pwn 用户的 home 目录。README.md 提供了下载和运行 Docker 镜像的说明，以及利用漏洞的步骤。经验证，该POC可以成功提权。

利用步骤：
1. 下载包含漏洞版本的 Sudo 的 Docker 镜像。
2. 启动 Docker 容器并切换到 pwn 用户。
3. 运行 PoC 脚本 sudo-chwoot.sh，该脚本利用 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件来提升权限。
4. 成功提升到 root 权限。

投毒风险分析：
该 PoC 的投毒风险较低。Dockerfile 中使用的软件源是官方的 Ubuntu 源，下载的 Sudo 源码也是来自官方网站。PoC 脚本本身比较简单，没有明显的恶意行为。但是，由于该 PoC 涉及到权限提升，如果被恶意修改，可能会导致严重的后果。例如，攻击者可以将 PoC 脚本修改为在提权后执行恶意代码，从而控制受害者的系统。此外，如果攻击者将包含恶意 PoC 的 Docker 镜像上传到公共镜像仓库，可能会诱骗其他用户下载和使用，从而扩大攻击范围。因此，在使用该 PoC 时，需要仔细审查代码，确保其安全性。尽管PoC本身代码较为清晰，但考虑到该漏洞的利用方式涉及到修改系统配置，并且可能被用于执行任意命令，因此存在一定的潜在风险。PoC中使用了Docker镜像，该镜像可能包含预先编译好的二进制文件，这些文件可能被篡改。同时，PoC脚本本身也可能被修改，例如添加反弹shell等恶意代码。该POC从githubusercontent下载压缩包，存在被中间人攻击替换的风险，导致投毒。综合考虑，该POC的投毒风险为10%。

**项目地址:** https://raw.githubusercontent.com/ashardev002/CVE-2025-32463_chwoot/main/endocrinal/CVE-2025-32463_chwoot.zip

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
