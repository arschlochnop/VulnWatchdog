## CVE-2025-32463 - Sudo 本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** Sudo 1.9.17p1之前版本

**利用条件:** 本地用户

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.17p1之前版本中的本地提权漏洞。该漏洞源于sudo程序在使用--chroot选项时，会使用用户可控目录下的/etc/nsswitch.conf文件，从而允许本地用户通过构造恶意的nsswitch.conf文件来获取root权限。

POC有效性分析：
根据搜索结果3和4，存在公开可用的POC代码，并且描述中提到该POC是一个自包含的bash脚本，可以创建一个假的chroot环境，构建一个恶意的NSS模块，并使用sudo -R触发漏洞。从提供的Dockerfile可以看出，它构建了一个存在漏洞的sudo版本(1.9.16p2)，并创建了一个普通用户pwn，然后将POC脚本复制到pwn用户的主目录。这意味着该POC是可用的，并且利用过程相对简单。POC的质量较高，因为它提供了一个完整的利用链，从环境准备到漏洞触发，都包含在脚本中。通过运行该POC，可以验证本地用户是否能够通过该漏洞提升到root权限。该漏洞的利用依赖于sudo的chroot功能，攻击者可以通过控制/etc/nsswitch.conf文件来影响sudo的名称服务解析行为，从而执行任意代码。

利用步骤：
1. 准备一个存在漏洞的Sudo版本（低于1.9.17p1）。
2. 创建一个普通用户。
3. 准备一个恶意的nsswitch.conf文件，该文件会将名称服务解析请求重定向到攻击者控制的恶意模块。
4. 使用sudo -R --chroot选项，指定chroot目录为包含恶意nsswitch.conf文件的目录。
5. 运行sudo命令，触发漏洞，提升到root权限。

投毒风险分析：
该POC的投毒风险较低，因为提供的Dockerfile和POC脚本主要用于漏洞验证和利用，没有发现明显的恶意行为。Dockerfile主要用于构建漏洞环境，POC脚本也只是利用已知的漏洞，没有尝试安装后门或执行其他恶意操作。但是，仍然存在一些潜在的风险。例如，攻击者可能会修改POC脚本，添加额外的恶意代码，例如安装后门程序、收集系统信息等。此外，攻击者还可能将该POC与其他漏洞结合使用，形成更复杂的攻击链。由于该POC需要创建chroot环境并构建恶意NSS模块，因此存在一定的复杂性，增加了分析和检测的难度。尽管如此，由于代码清晰，主要使用标准库，并且没有发现可疑行为，因此判断该POC的投毒风险较低，大约为10%。攻击者可能利用该POC进行定向攻击，针对特定目标系统进行渗透测试或漏洞利用。为了降低投毒风险，建议在运行POC之前，仔细审查代码，确保没有恶意行为，并在隔离环境中运行POC，避免对生产环境造成影响。

**项目地址:** https://github.com/K1tt3h/CVE-2025-32463-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
