## CVE-2025-32463-sudo本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 1.9.17p1

**利用条件:** 需要本地用户权限，可能需要特定的/etc/nsswitch.conf配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 1.9.17p1 之前版本中的一个本地权限提升漏洞。该漏洞允许本地用户通过 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获得 root 权限。漏洞利用方式如下：

1.  **漏洞原理：** Sudo 在使用 `--chroot` 选项时，会使用 chroot 环境下的 `/etc/nsswitch.conf` 文件进行名称服务切换（Name Service Switch）配置。如果用户可以控制 chroot 环境，那么就可以控制 `/etc/nsswitch.conf` 文件，从而影响 Sudo 的行为。

2.  **利用步骤：**
    *   攻击者创建一个恶意的 `/etc/nsswitch.conf` 文件，其中包含指向攻击者控制的库文件的配置。
    *   攻击者使用 `sudo --chroot` 命令，指定包含恶意 `/etc/nsswitch.conf` 文件的目录作为 chroot 环境。
    *   当 Sudo 在 chroot 环境中运行并尝试使用名称服务时，它会加载攻击者控制的库文件，从而执行攻击者的恶意代码，最终提权至root。

3.  **POC 分析：** 提供的 Dockerfile 构建了一个存在漏洞的 Sudo 环境 (1.9.16p2)。它安装了 vulnerable 版本的 sudo，并创建了一个名为 `pwn` 的用户。Dockerfile将`sudo-chwoot.sh`脚本复制到pwn用户的主目录,之后切换用户,因此利用的有效性高。README文档中下载链接指向githubusercontent下载zip，不符合正常逻辑，存在一定风险，将POC代码判定为投毒代码的概率低，但仓库本身存在一定风险。该zip存在风险。

**项目地址:** [ashardev002/CVE-2025-32463_chwoot](https://github.com/ashardev002/CVE-2025-32463_chwoot)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)