## CVE-2025-8088 - WinRAR (RAR5 格式解析器) 路径穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径穿越 (Path Traversal)

**影响应用:** WinRAR (RAR5 格式解析器)

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H

**影响版本:** WinRAR < 7.00 (具体受影响版本以官方公告为准)

**利用条件:** 用户下载并使用受影响版本的WinRAR打开或解压包含恶意构造路径的RAR5格式压缩包。

**POC 可用性:** 4/10

**POC 类型:** 概念验证/检测工具

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：本研究所分析的POC代码（RAR Anomaly Inspector）并非攻击性利用脚本，而是一个基于PowerShell开发的防御性检测工具。该工具通过静态分析RAR5压缩包的结构，识别是否存在利用CVE-2025-8088漏洞的特征模式。该漏洞的核心在于WinRAR在处理RAR5格式时，未能正确过滤压缩包内文件路径中的相对路径序列（如'..\'）。攻击者可以构造包含多级回溯符的恶意压缩包，当用户解压时，文件会被释放到预设目录之外的敏感位置，如启动项文件夹（Startup），从而实现持久化控制。通过分析该检测脚本，可以确认其有效性在于它能通过7-Zip的只读模式列出文件清单，并使用正则表达式匹配原始路径指标中的‘..\’序列。脚本输出明确显示了针对'AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'等敏感路径的注入尝试，这证明了漏洞利用的逻辑路径。虽然此POC不具备自动生成恶意压缩包的功能，但它清晰地揭示了漏洞触发的底层逻辑，为防御者提供了识别恶意样本的启发式标准。利用步骤：1. 攻击者创建一个RAR5格式的压缩包。2. 利用底层编辑器或自定义脚本，修改压缩包内文件的目录项，插入多级‘..\’跳转符。3. 将恶意文件目标指向系统关键目录，例如'..\..\..\..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.vbs'。4. 诱导目标用户使用旧版WinRAR解压该文件。5. 文件被静默释放到启动项，用户重启系统后触发恶意代码。投毒风险分析：该POC项目（RAR-Anomaly-Inspector）本身投毒风险较低。代码逻辑透明，完全采用PowerShell原生命令结合7-Zip命令行工具实现，未发现混淆代码、外部敏感域名请求或Base64加密的恶意载荷。其主要行为是文件读取和字符串匹配，属于典型的安全审计脚本。然而，从广义威胁情报来看，CVE-2025-8088相关的搜索结果显示，如NoName057等黑客组织已开始利用该漏洞进行恶意代码投递，针对高科技和国防领域发起攻击。这意味着市场上流传的其他所谓‘一键生成工具’或‘漏洞利用包’具有极高的投毒风险。攻击者常在这些利用工具中植入后门，实现‘黑吃黑’。对于本防御性工具，其风险点仅限于如果用户从非官方仓库下载了被篡改的PowerShell脚本，可能导致本地执行权限被滥用，但在当前GitHub原始版本中，其代码结构符合标准安全工具规范，未见异常投毒迹象。

**项目地址:** [https://github.com/ilhamrzr/RAR-Anomaly-Inspector](https://github.com/ilhamrzr/RAR-Anomaly-Inspector)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
