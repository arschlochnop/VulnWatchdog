## CVE-2025-8088 - WinRAR 路径遍历/目录穿越 (Path Traversal/Directory Traversal)，导致任意代码执行 (RCE)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越 (Path Traversal/Directory Traversal)，导致任意代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 7.12及以下版本

**利用条件:** 需要用户解压恶意压缩包，无需认证

**POC 可用性:** 8

**POC 类型:** 概念验证 (检测工具)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响广泛的WinRAR软件的严重路径遍历漏洞，被追踪为“WinRAR RAR5 Path Traversal”。该漏洞利用Windows NTFS备用数据流（ADS）特性和路径遍历技术（如`..\`），允许攻击者绕过WinRAR的文件验证机制，将恶意文件从压缩包释放到系统任意位置，最终实现任意代码执行（RCE）。受影响的版本包括WinRAR 7.12及以下版本。

此漏洞的危害程度被评估为高危，主要是因为WinRAR在全球用户群中普及率极高，几乎是每台Windows电脑的“标配软件”。一旦用户解压恶意构造的RAR压缩包，攻击者即可在受害者的系统上执行任意代码，窃取敏感信息、植入后门、进行勒索攻击等。

威胁情报显示，该漏洞已遭到多个高级持续性威胁（APT）组织的武器化利用。例如，境外间谍组织UNC4895（RomCom）、APT44和图拉（Turla）等团伙被发现持续利用此漏洞，针对乌克兰军事及政府机构展开攻击，并使用高度定制化的地缘政治相关诱饵进行钓鱼。同时，也有中国境内的非法攻击团伙被发现利用此漏洞，表明其在全球范围内均存在活跃的利用。

**POC有效性分析:**
所提供的POC代码“RAR Anomaly Inspector”是一个基于PowerShell的静态分析工具，专门用于检测RAR压缩包中与CVE-2025-8088相关的路径遍历异常。该工具的核心价值在于其“只读”和“不提取、不执行”的特性，使其成为一个安全的漏洞特征检测器。它通过分析RAR归档的内部结构，能够识别出：
1.  **原始路径遍历模式 (`..\`)**：检测恶意路径中常见的目录穿越序列，如`..\..\..\`。
2.  **写入提取目录外部的迹象**：识别文件路径是否试图将文件放置到用户指定的解压目录之外。
3.  **NTFS备用数据流 (ADS) 指示符**：检测攻击者常用于隐藏恶意文件的ADS机制。
4.  **启发式风险分类**：根据检测到的异常模式，对归档文件进行风险评估。

尽管此POC并非一个直接的利用工具（即它不会自动构造并执行攻击），但它作为“概念验证”工具极为有效。它清晰地展示了恶意RAR文件可能包含的特征，从而验证了漏洞的存在方式。例如，在示例输出中，该工具成功识别出尝试将文件写入到`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`目录的路径，这正是攻击者实现持久化和任意代码执行的关键手段。通过这种静态检测，安全团队能够在不触发实际攻击的情况下，提前识别和隔离潜在的恶意压缩包，从而建立有效的防御措施。因此，该POC在帮助理解漏洞机制和防御部署方面具有很高的实用价值。

**利用步骤:**
CVE-2025-8088漏洞的典型利用流程如下：
1.  **构造恶意压缩包**：攻击者首先制作一个特制的RAR压缩包。该压缩包内部的文件路径被精心构造，利用WinRAR在处理路径时的缺陷。具体来说，攻击者会使用多次目录穿越序列（例如`..\..\..\`）结合Windows NTFS备用数据流（ADS）特性。ADS允许文件拥有多个数据流，攻击者可以利用此特性将恶意代码（如`.vbs`、`.exe`或`.dll`文件）伪装成看似无害的文件，并指定其在解压时被释放到系统中的敏感位置。一个常见的攻击目标是用户的启动文件夹（例如`%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup`），这样恶意文件可以在系统启动时自动运行。
2.  **钓鱼或投递**：攻击者通过各种社会工程学手段将恶意压缩包投递给目标用户。这通常通过钓鱼邮件实现，邮件中包含诱导性的标题和内容（如“军事报告”、“政府文件”、“工资单更新”等），诱骗用户下载并打开附件。也可能通过恶意网站、即时通讯工具或受感染的U盘进行传播。
3.  **用户解压操作**：受害者在不知情的情况下，使用存在漏洞的WinRAR版本（7.12及以下）打开并解压了这个恶意压缩包。由于WinRAR未正确处理特制路径，恶意文件绕过了预期的解压目标，被写入到攻击者指定的任意系统目录。
4.  **恶意文件执行**：如果恶意文件被释放到启动目录，那么当用户下次登录Windows系统或重启计算机时，操作系统会自动执行该目录下的所有程序或脚本。这使得攻击者无需进一步的用户交互即可获得代码执行权限。攻击者通过此方式可以植入后门、窃取数据、安装勒索软件或进行其他恶意活动，从而完全控制受害者的系统。

**投毒风险分析:**
针对提供的“RAR Anomaly Inspector”POC代码进行投毒风险评估，结论为风险较低（估计为10%）。
该POC是一个用PowerShell编写的静态分析工具，其主要功能是检查RAR档案是否存在与CVE-2025-8088相关的路径遍历特征。从其README文档和代码逻辑来看，该工具的设计宗旨是“只读”和“不提取或执行档案内容”，这显著降低了其自身被恶意利用的风险。
代码审查揭示以下关键点：
1.  **明确的声明和目的**：项目明确声明为“read-only PowerShell tool”和“static inspection”，强调其安全性和检测功能，而非利用功能。
2.  **无混淆代码**：代码结构清晰，易于理解，没有发现代码混淆、加密字符串或可疑的十六进制编码等迹象。所有变量、函数和逻辑都直观地服务于文件路径分析。
3.  **不执行外部脚本或可疑命令**：POC代码主要依赖于PowerShell的内置文件系统操作和字符串处理功能，如`Get-ChildItem`、`Select-String`、`Select-Object`等，这些都是标准、安全的命令。没有发现尝试从外部URL下载并执行脚本、使用`Invoke-Expression`或`eval`等高风险函数。
4.  **依赖性安全**：该工具的可选依赖是`7z.exe`，用于列出用户可见的文件。`7z.exe`是一个广为人知的合法工具，且POC仅通过`Start-Process`调用其命令行接口进行文件列表操作，并不会将任意数据传递给它执行。即便`7z.exe`本身被替换为恶意版本，这也不是POC代码本身的投毒问题。
5.  **无网络外联**：代码中没有发现任何尝试建立外部网络连接（如HTTP/HTTPS请求、DNS解析到可疑域等）的行为，进一步排除了数据窃取或命令控制的风险。
综合来看，该POC代码遵循了良好的安全实践，专注于其检测功能。其透明的代码、明确的意图以及缺乏高风险操作，使其被攻击者篡改并用于传播恶意软件（即供应链投毒）的可能性非常低。因此，对于使用此POC进行安全分析的用户而言，其自身引入恶意代码的风险是极低的。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** 
