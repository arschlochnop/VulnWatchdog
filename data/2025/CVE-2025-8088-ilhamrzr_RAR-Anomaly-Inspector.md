## CVE-2025-8088 - WinRAR 路径遍历/目录遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录遍历

**影响应用:** WinRAR

**危害等级:** 高

**CVSS评分:** 

**影响版本:** 7.13及以下版本

**利用条件:** 需要用户交互，无需认证

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

WinRAR 目录遍历漏洞（CVE-2025-8088）是一个影响广泛的严重安全漏洞，允许攻击者通过构造恶意的RAR压缩包，利用路径遍历技术（如`../`）和/或Windows NTFS备用数据流（ADS）特性，绕过WinRAR的文件验证机制。成功利用此漏洞可导致攻击者将恶意文件释放到系统任意位置，特别是像Windows启动文件夹（`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）这样的敏感目录。一旦恶意文件被放置在启动文件夹，当用户下次启动系统或登录时，这些文件将自动执行，从而实现任意代码执行（RCE）。该漏洞被评定为高危，且已有证据表明，APT组织（如RomCom）正在积极利用此漏洞进行攻击，进一步凸显了其威胁的紧迫性。受影响的版本包括WinRAR 7.13及更早版本，建议用户尽快升级到最新版本以 mitigate 风险。

**POC有效性分析：**
提供的POC是一个名为“RAR Anomaly Inspector”的PowerShell脚本（`anom-rar.ps1`），旨在对RAR档案进行静态、只读的检查，以检测与CVE-2025-8088相关的路径遍历异常。该工具具有以下关键特点：首先，它强调其只读性，明确声明“不提取或执行档案内容”，这确保了其作为分析工具的安全性。其次，它能够有效地检测原始路径遍历模式（`..\`）、识别可能导致文件写入提取目录外部的路径，并检测NTFS备用数据流（ADS）的指标。其输出清晰地列出可疑路径，并根据启发式算法进行风险分类，例如给出“ARCHIVE REQUIRES FURTHER INVESTIGATION”的警告。尽管这个POC不是一个直接的漏洞利用工具，它不会主动触发漏洞来获得控制权，但它是一个非常有价值的防御性工具，因为它能够帮助安全分析师和用户在解压任何RAR文件之前对其进行预检查。通过识别潜在的恶意构造，它有效地验证了漏洞概念，并为用户提供了一道防线，避免因解压恶意文件而遭受攻击。因此，该POC在帮助识别潜在恶意RAR文件方面表现出高度的有效性。

**利用步骤：**
1.  **构造恶意RAR文件：** 攻击者首先创建一个特制的RAR压缩包。该压缩包内部包含恶意载荷，例如`.vbs`脚本、`.exe`可执行文件或`.dll`库。在打包过程中，攻击者会利用路径遍历技术，通过在文件路径中插入大量`..\`来尝试逃逸出预期的解压目录，例如将恶意文件路径设置为`..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.vbs`。此外，攻击者还可以结合NTFS备用数据流（ADS）来隐藏恶意文件或绕过某些基于签名的检测。
2.  **社会工程：** 攻击者通过各种社会工程手段，如发送包含恶意附件的钓鱼邮件、诱骗用户访问恶意网站下载文件，或通过即时通讯软件传播，引诱目标用户下载并尝试打开或解压这个恶意RAR文件。
3.  **用户操作：** 受害者在安装了受影响的WinRAR版本（7.13或更早）的系统上，被诱导执行解压操作。
4.  **文件释放：** 由于WinRAR存在的目录遍历漏洞，恶意文件在未经用户明确确认的情况下，被静默地解压到攻击者指定的、位于正常解压目录之外的任意系统路径，特别是Windows的启动文件夹。
5.  **代码执行：** 当受害者下次重新启动Windows系统或重新登录时，放置在启动文件夹中的恶意脚本或程序将自动执行。这将赋予攻击者在受害者系统上执行任意代码的权限，从而可能导致数据窃取、系统控制或进一步的网络入侵。

**投毒风险分析：**
对提供的POC代码“RAR Anomaly Inspector”(`anom-rar.ps1`)进行分析，结果显示其投毒风险极低，基本可认定为0%。该脚本明确设计为一个防御性工具，其核心功能是“静态检查”和“只读分析”RAR档案。代码中明确声明“不提取或执行档案内容”，这一关键特性从根本上杜绝了在分析过程中通过自身行为引入恶意载荷的可能。代码结构清晰，主要依赖于标准的PowerShell命令和函数，用于文件路径的解析、字符串匹配以及目录遍历模式的检测。它利用`7z.exe`（如果可用）来列表档案内容，但这仅限于显示用户可见文件，并不会触发其执行。脚本不包含任何混淆代码、外部资源下载、可疑的网络请求、`eval`函数或其他可能被滥用来执行恶意操作的机制。整个代码逻辑专注于识别RAR文件中可能存在的路径遍历指标和ADS利用迹象。因此，该POC代码自身不包含任何恶意负载或不安全的操作，组织可以安全地部署和使用此工具来增强对WinRAR漏洞的检测能力，而无需担心该工具本身会成为新的攻击向量。它是一个纯粹的检测工具，而非利用工具，其设计原则确保了自身的安全性。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
