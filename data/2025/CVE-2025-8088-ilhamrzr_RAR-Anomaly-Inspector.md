## CVE-2025-8088 - WinRAR 路径遍历及任意代码执行 (Path Traversal and Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历及任意代码执行 (Path Traversal and Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 未提供具体数值，但被评定为高危

**影响版本:** 未知，影响WinRAR的多个版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 需要用户交互（解压恶意RAR文件），通常通过网络钓鱼等社会工程学手段投递恶意压缩包。

**POC 可用性:** 8/10

**POC 类型:** 概念验证 (作为检测工具，展示漏洞利用痕迹)

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-8088是一个影响广泛使用的WinRAR压缩软件的高危路径遍历漏洞。该漏洞的根本原因在于WinRAR在解压RAR文件时，错误地处理了压缩包内嵌的特制文件路径。攻击者可以巧妙利用Windows NTFS备用数据流（ADS）特性以及目录遍历技术（如`..\`），绕过WinRAR的文件验证机制，将恶意文件写入到用户指定解压目录之外的任意系统位置。例如，攻击者可以将恶意脚本或可执行文件释放到操作系统的启动文件夹（如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）中。一旦受害者解压了包含恶意构造路径的RAR文件，恶意文件就会被放置到指定的高权限或自启动目录。当系统重启或用户下次登录时，这些恶意文件便会自动执行，从而实现任意代码执行，导致系统被完全控制。此漏洞已被多个高级持续性威胁（APT）组织（如UNC4895、RomCom、APT44、Turla）武器化利用，针对乌克兰军事及政府机构发起攻击，并发现有中国境内的非法攻击团伙利用。攻击通常通过定制化的地缘政治相关诱饵进行钓鱼攻击，诱导目标用户打开并解压恶意RAR压缩包。

**POC有效性分析**:
提供的POC代码是一个名为“RAR Anomaly Inspector”的PowerShell工具，其目的是对RAR档案进行静态检测，以识别与CVE-2025-8088相关的路径遍历异常。需要强调的是，这个POC**并非一个利用工具**，而是一个**防御性检测工具**。它明确声明为“read-only PowerShell tool”、“static inspection”、“does NOT extract or execute archive contents”，这表明它在运行过程中，不会对RAR文件进行解压操作，也不会执行压缩包内的任何内容，因此本身不具备攻击性。该工具通过分析RAR压缩包的元数据来检测以下关键异常指标：原始路径遍历模式（`..\`）、写入到预定解压目录之外的路径、以及NTFS备用数据流（ADS）的迹象。例如，它能识别出尝试将文件写入到“AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup”等敏感路径的意图。示例输出清晰地展示了它如何列出用户可见的文件和可疑的内部路径指示器，并据此给出风险分类。该工具对于识别潜在的恶意RAR文件非常有效，能够帮助用户和安全团队在文件被实际解压之前发现并隔离危险档案，从而有效地预防攻击。其功能完整、文档清晰，是一个高质量的辅助分析工具。

**利用步骤**:
1.  **构造恶意RAR文件**：攻击者首先创建一个特殊的RAR压缩包。在这个压缩包中，包含一个或多个恶意文件（例如，一个VBS脚本、PowerShell脚本或可执行文件）。
2.  **利用路径遍历**：在RAR文件的内部结构中，攻击者将这些恶意文件的目标路径设置为利用CVE-2025-8088的路径遍历缺陷的路径。这通常涉及使用多个`..\`序列来“跳出”预期的解压目录，并将文件指向一个特权目录，如`C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`。结合NTFS ADS特性，可以进一步隐藏恶意载荷或绕过某些安全检查。
3.  **投递**：攻击者通过鱼叉式网络钓鱼邮件、恶意网站下载或其他社交工程手段将构造好的恶意RAR文件发送给目标。这些邮件通常包含高度相关的诱饵，如伪装成重要的文档、报告或图片。
4.  **用户交互**：受害者被诱导下载并使用WinRAR解压该恶意压缩包。
5.  **恶意文件植入**：当WinRAR尝试解压时，由于漏洞的存在，恶意文件不会被释放到用户选择的目录，而是被写入到攻击者指定的高权限或自启动路径。
6.  **任意代码执行**：一旦恶意文件被植入到启动目录，系统在下次启动或用户登录时会自动执行该文件，从而赋予攻击者对受害系统的任意代码执行能力，可能导致数据窃取、进一步感染或系统完全控制。

**投毒风险分析**:
对提供的POC代码“RAR Anomaly Inspector”进行分析后，可以确认其**投毒风险极低，接近0%**。主要原因如下：
1.  **性质为检测工具**：该POC明确声明是一个“read-only PowerShell tool”，设计用于“static inspection of RAR archives”，并且“does NOT extract or execute archive contents”。这意味着它在运行过程中，不会对RAR文件进行解压操作，也不会执行压缩包内的任何文件，从而彻底避免了激活潜在恶意载荷的风险。
2.  **代码行为透明**：POC代码是纯PowerShell脚本，其逻辑清晰、易于审计。它主要依赖于文件系统操作和字符串匹配来识别RAR文件的内部结构和路径异常。没有发现任何代码混淆、加密或难以理解的复杂逻辑。
3.  **无外部连接或可疑请求**：代码中未包含任何尝试连接外部服务器、下载额外组件或执行可疑网络请求的功能。所有操作都局限于本地文件系统的分析。
4.  **无恶意载荷或后门**：作为检测工具，其目的是分析RAR文件中的路径异常，而非植入恶意代码或建立后门。代码本身不包含任何恶意功能。
综上所述，RAR Anomaly Inspector是一个合法且安全的防御性安全研究工具。它严格遵守了其“只读”和“静态检测”的承诺，不会对运行环境或被分析的RAR文件造成任何负面影响，因此不构成投毒风险。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
