## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 

**影响版本:** 存在漏洞的WinRAR版本，包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll

**利用条件:** 需要用户交互（解压恶意RAR文件），攻击者需构造特制恶意RAR压缩包

**POC 可用性:** 8

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR软件的严重安全漏洞，被归类为路径遍历（或目录遍历）漏洞。WinRAR是一款广泛使用的文件压缩与解压缩工具。该漏洞的根本原因在于WinRAR在处理特制恶意压缩文件（尤其是RAR5格式）时，未能正确解析或过滤其中包含的路径信息。攻击者可以精心构造一个RAR压缩包，在其中嵌入含有目录遍历序列（如 ..\）的文件路径，结合Windows NTFS备用数据流（ADS）特性，绕过WinRAR的文件验证机制。当用户使用存在漏洞的WinRAR版本解压此类恶意文件时，WinRAR会错误地将恶意文件释放到指定解压目录之外的任意位置，例如Windows的启动文件夹（Start Menu\Programs\Startup）。一旦恶意文件（如 .vbs、.exe、.lnk等）被放置到启动目录，系统在下次启动或用户登录时便会自动执行该文件，从而实现任意代码执行，导致受害者系统被完全控制。此漏洞的威胁等级被评定为高危，且已有证据表明，包括RomCom在内的APT组织正在广泛利用此漏洞进行攻击，这进一步凸显了其现实威胁性。受影响的版本包括WinRAR的Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll。

POC有效性分析:
提供的POC代码是一个名为“RAR Anomaly Inspector”的PowerShell工具，其主要功能是对RAR压缩包进行静态、只读的分析，以检测与CVE-2025-8088相关的路径遍历异常。该工具的设计理念是“不提取或执行档案内容”，因此它并非一个直接利用漏洞的攻击工具，而是一个防御性的检测工具。它的有效性体现在能够：1. 静态分析：在不解压文件的情况下，检查RAR档案的元数据，避免了直接执行恶意内容的风险。2. 路径遍历模式检测：能够识别诸如 ..\ 等原始路径遍历模式，这些模式是构造目录穿越攻击的关键元素。3. 异目录写入识别：能够检测档案内容中指示文件将被写入到预期提取目录之外的逻辑路径。4. NTFS ADS指示器检测：识别与NTFS备用数据流相关的指示器，这常被用于隐藏恶意负载或实现更隐蔽的攻击。5. 启发式风险分类：基于检测到的模式，对档案进行启发式风险评估，给出“要求进一步调查”的建议。在示例输出中，该工具成功识别出了多个指向Windows启动文件夹的恶意路径，例如 ..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\CVE-2025-8088.vbs。这表明该POC在验证漏洞的存在性和检测恶意样本方面是高度有效的。

利用步骤:
1. 构造恶意RAR文件：攻击者首先需要创建一个RAR压缩包。在这个压缩包中，包含一个或多个恶意文件（例如一个 .vbs 脚本、.exe 可执行文件或.lnk快捷方式）。关键在于这些恶意文件的内部路径必须经过精心构造，利用目录遍历序列（..\..\..\）指向目标系统上的敏感目录，如Windows启动文件夹 (C:\Users\<username>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)。攻击者还可以利用NTFS备用数据流来隐藏实际的恶意负载，使之不易被常规检测工具发现。2. 社会工程学投递：攻击者通过钓鱼邮件、恶意网站下载、即时通讯工具等多种社会工程学手段，将构造好的恶意RAR文件发送给受害者。攻击邮件通常会伪装成发票、重要文档、软件更新或图片等，诱骗受害者打开。3. 用户解压触发：受害者在不知情的情况下下载并尝试使用存在漏洞的WinRAR版本（包括Windows版RAR、UnRAR等）解压这个恶意RAR文件。4. 漏洞触发与文件释放：在解压过程中，WinRAR由于漏洞的存在，会错误地处理恶意路径，导致恶意文件被释放到其原本不应被写入的系统启动目录。5. 任意代码执行：一旦恶意文件成功释放到启动目录，当受害者下次启动计算机或重新登录系统时，操作系统会自动执行启动目录中的恶意文件。例如，如果释放的是一个 .vbs 脚本，该脚本就会在用户会话中执行，从而赋予攻击者在受害者系统上执行任意代码的能力，实现远程控制、数据窃取、安装后门等恶意行为。

投毒风险分析:
对于RAR Anomaly Inspector这个特定的POC工具而言，其自身的投毒风险极低，评估为10%。这主要是基于以下几点：1. 只读与静态分析：该工具明确声明是一个“read-only PowerShell tool”，用于“static inspection”，并且“does not extract or execute archive contents”。这意味着它只会分析RAR文件的元数据和结构，而不会触发文件中的任何代码或内容。这从根本上杜绝了POC自身被用作恶意载体来执行外部代码或在分析过程中感染系统的可能性。2. 代码透明度：该POC是用PowerShell编写的，PowerShell脚本通常是文本格式，其代码逻辑相对透明，易于审查。代码中没有明显的混淆、加密或二进制组件，这使得安全研究人员可以轻松地审计其行为，确保没有隐藏的恶意功能。3. 无外部可疑请求：从代码描述和用法来看，该工具不涉及向外部未知服务器发送数据、下载外部脚本或执行 eval 等高风险操作。它主要依赖本地的PowerShell环境和可选的 7z.exe 工具进行分析，并且 7z.exe 也仅用于列出用户可见文件，其使用方式是安全的。4. 明确的目的：该POC的唯一目的是检测RAR档案中是否存在路径遍历漏洞的指示器，而非利用或创建恶意负载。它是一个旨在帮助防御者识别威胁的工具，而不是一个攻击性工具。尽管如此，任何从互联网下载的代码都存在理论上的风险。因此，在使用前仍然建议进行代码审查，并最好在隔离环境中运行，以防万一。但从其设计和功能来看，其自身的恶意投毒风险被评估为非常低。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** 
