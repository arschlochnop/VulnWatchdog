## CVE-2025-8088 - WinRAR 目录遍历/路径穿越(Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越(Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高

**CVSS评分:** 高

**影响版本:** 7.12及以下版本

**利用条件:** 攻击者构造恶意压缩包，用户解压该压缩包，可能结合NTFS备用数据流特性进行利用

**POC 可用性:** 4/10

**POC 类型:** 概念验证（检测工具）

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

WinRAR目录遍历漏洞（CVE-2025-8088）是一个严重的安全漏洞，影响了WinRAR文件压缩与解压缩工具的7.12及以下版本。该漏洞的根本原因在于WinRAR在处理压缩文件时存在目录遍历（Path Traversal）缺陷，未能正确解析和验证压缩包中文件路径。攻击者可以精心构造一个恶意的RAR压缩文件，在其中嵌入恶意负载（例如一个可执行文件或脚本），并利用`..\`等路径遍历序列，结合Windows NTFS备用数据流（ADS）特性，绕过WinRAR的文件验证机制。通过这种方式，攻击者可以将恶意文件释放到受害者系统上的任意位置，包括但不限于系统启动文件夹（如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。一旦恶意文件成功被释放到启动文件夹，当用户下次开机或登录时，系统将自动执行该恶意文件，从而在受害者的系统上实现任意代码执行（Arbitrary Code Execution, RCE），导致系统被完全控制。该漏洞被评定为高危害级别，且据报告已被RomCom等APT组织广泛利用，表明其在真实世界攻击中具有极高的利用价值和潜在破坏力。鉴于WinRAR庞大的用户基础，该漏洞影响范围广泛，对个人和企业用户构成严重威胁。

**POC有效性分析：**
提供的“POC代码”是名为“RAR Anomaly Inspector”的PowerShell脚本工具。该工具并非一个漏洞利用程序，而是一个**静态、只读的WinRAR存档文件检测工具**。其核心功能是分析RAR压缩文件，旨在检测与CVE-2025-8088相关的路径遍历异常。该工具明确声明“不提取或执行档案内容”，仅用于识别压缩包内是否存在`..\`等路径遍历模式、尝试将文件写入提取目录外的指示符以及NTFS备用数据流（ADS）的痕迹。通过检测这些异常指标，该工具能够有效识别出符合CVE-2025-8088利用特征的恶意RAR文件，例如在示例输出中，它成功检测到通过多级`..\`路径遍历尝试将`CVE-2025-8088.vbs`文件释放到Windows启动文件夹的行为。因此，作为一款**漏洞检测概念验证工具**，该POC代码是有效的，能够帮助用户识别潜在的恶意文件，从而起到防御作用。然而，需要强调的是，该工具无法用于生成恶意RAR文件或直接触发漏洞进行攻击，它仅限于对现有RAR文件进行安全检查。因此，如果将此代码作为“漏洞利用POC”来评估，其利用功能为零；但如果作为“漏洞相关概念验证代码”的检测功能，它能提供有效的风险识别。

**利用步骤（Vulnerability Exploitation）：**
1.  **构造恶意压缩包：** 攻击者首先创建一个包含恶意负载（如后门程序、勒索病毒脚本）的RAR压缩文件。在打包过程中，攻击者会利用WinRAR的路径解析缺陷，通过在文件路径前添加多个`..\`（例如`..\..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.exe`）来构造一个指向受害者系统关键目录（如启动文件夹）的路径。
2.  **分发恶意压缩包：** 攻击者通过钓鱼邮件、恶意网站、社交媒体或其他社会工程学手段，将精心构造的恶意RAR文件分发给目标受害者，诱骗其下载并打开。
3.  **用户解压触发漏洞：** 受害者在不知情的情况下使用存在漏洞的WinRAR版本（7.12及以下）解压该恶意RAR文件。WinRAR在处理此文件时，未能正确处理带有目录遍历特性的路径，从而导致恶意文件被解压到攻击者指定的任意系统位置。
4.  **实现任意代码执行：** 如果恶意文件被放置到启动文件夹，它将在用户下次启动系统或登录时自动执行。一旦执行，攻击者便能够在受害者的系统上获得与当前用户权限相同的任意代码执行能力，进而安装持久化后门、窃取敏感信息、破坏系统数据或发动进一步的网络攻击。

**投毒风险分析：**
*   **POC代码本身的投毒风险：** 提供的“RAR Anomaly Inspector”工具的投毒风险为**0%**。该工具被设计为“read-only”（只读），明确声明“不提取或执行档案内容”，且代码逻辑清晰，主要进行路径字符串的分析和模式匹配，用于安全检测。它不包含任何可疑的外部网络请求、加密操作、混淆代码、恶意负载或任何潜在的恶意行为。因此，用户运行此检测工具本身不会对系统造成任何危害或引入恶意代码。
*   **漏洞利用的投毒风险：** CVE-2025-8088漏洞的实际利用（即攻击者构造的恶意RAR文件）具有**高投毒风险**。一旦用户解压了由攻击者精心构造的恶意RAR文件，攻击者可以利用目录遍历漏洞将任意恶意文件释放到系统目录并实现任意代码执行。这意味着攻击者可以在受害者系统上安装持久性后门、窃取敏感数据、部署勒索软件、传播病毒或进行其他具有高度破坏性的活动。鉴于此漏洞影响范围广且已被APT组织利用，其对用户系统安全构成的威胁等级极高，导致的数据泄露、系统破坏和服务中断的可能性非常大。组织和个人应高度重视此漏洞，并及时更新WinRAR版本或采取其他缓解措施。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
