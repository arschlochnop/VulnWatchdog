## CVE-2025-8088 - WinRAR 目录遍历/路径穿越

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 目录遍历/路径穿越

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4

**影响版本:** WinRAR 7.12及更早版本

**利用条件:** 需要用户交互（解压恶意构造的压缩文件）

**POC 可用性:** 5

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-8088是一个影响WinRAR软件的目录遍历（或称路径穿越、路径遍历）漏洞，威胁等级为高危，CVSS v3.1评分为8.4。该漏洞的根本原因在于WinRAR在处理特制的RAR压缩包时，错误地采用了压缩包内嵌的文件路径，而非用户指定的目标路径进行解压。这使得攻击者能够通过构造恶意压缩文件，将文件释放到系统任意位置，例如Windows启动文件夹（%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup），从而实现任意代码执行（RCE）权限。受影响的版本包括WinRAR 7.12及所有更早版本。此漏洞已被RomCom等APT组织广泛利用，对个人及企业用户构成严重威胁。

**POC有效性分析:**
所提供的POC名为“RAR Anomaly Inspector”，是一个用PowerShell编写的静态分析工具。其设计目的是对RAR压缩文件进行只读检查，以检测与CVE-2025-8088（WinRAR RAR5路径遍历）相关的路径遍历异常。该工具明确声明“不提取或执行档案内容”，而是专注于识别原始的路径遍历模式（如“..\”）、超出提取目录的写入尝试以及NTFS备用数据流（ADS）指示符。通过示例输出，我们可以看到它能够成功识别类似“..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\CVE-2025-8088.vbs”这样的可疑路径，这与漏洞利用中将恶意文件放置到启动目录以实现持久化的行为高度吻合。虽然它不是一个直接的漏洞利用工具，但它通过展示如何有效地检测恶意压缩包中利用漏洞的特征，从而作为漏洞概念的有效证明。它能够基于启发式规则对档案结构进行风险分类，清晰地指示出高风险的档案，对防御方识别潜在威胁具有极高的价值。

**利用步骤:**
1.  **制作恶意RAR压缩包：** 攻击者首先精心构造一个RAR压缩包（通常是RAR5格式），在其中包含一个恶意载荷（例如可执行文件、VBS脚本、DLL文件等）。文件的内部路径被篡改，嵌入了目录遍历序列（例如`..\..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\evil.exe`），旨在绕过WinRAR的路径验证机制，将文件解压到预期目录之外的任意位置。
2.  **投递恶意压缩包：** 攻击者通过社会工程学手段，如钓鱼邮件、恶意网站下载、即时通讯工具等方式，将此恶意RAR文件投递给受害者。
3.  **用户交互与解压：** 受害者在不知情的情况下下载并尝试使用已安装的、存在漏洞的WinRAR版本（7.12或更早）解压该恶意压缩包。
4.  **触发目录遍历：** WinRAR在解压过程中，错误地解析了压缩包内嵌的恶意路径，导致恶意文件被写入到攻击者指定的目标位置（例如Windows启动文件夹）。
5.  **代码执行：** 如果恶意文件被成功放置到启动文件夹，那么当受害者下一次登录系统或重启计算机时，该恶意文件将自动执行，从而赋予攻击者在受害者系统上任意代码执行的权限，通常是当前用户权限。

**投毒风险分析:**
提供的POC工具“RAR Anomaly Inspector”的投毒风险极低，可以被评估为0%。该工具在其README文件中明确声明是一个“只读PowerShell工具”，专门用于“静态检查RAR档案”，并且“不提取或执行档案内容”。这意味着它被设计为安全地分析文件，而不会对运行它的系统产生任何恶意副作用。其主要功能是识别潜在的路径遍历模式和可疑的档案结构，这对于安全研究和防御工作至关重要。代码是PowerShell脚本，通常是可读且透明的。它唯一提到的外部依赖是可选的`7z.exe`，这是一个广泛使用且合法的压缩/解压缩工具，且其用途明确（用于列出用户可见文件）。整个项目的描述、功能和代码行为都指向一个纯粹的防御性和分析性工具，没有任何迹象表明存在混淆代码、恶意外部请求、利用系统漏洞或执行任何可疑操作。因此，使用此POC工具进行安全分析是安全的，不会引入任何额外的系统风险。

**项目地址:** https://github.com/ilhamrzr/RAR-Anomaly-Inspector

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
