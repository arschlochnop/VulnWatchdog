## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 本地普通用户访问权限，且sudo配置允许使用-R (--chroot)选项或特定sudoers策略允许调用chroot功能。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-32463）存在于Sudo组件中，主要源于其对-R或--chroot参数处理逻辑的缺陷。在1.9.14版本中，为了在评估sudoers策略时支持chroot路径解析，引入了不当的处理机制。攻击者可以创建一个恶意的根目录环境，并在其中伪造/etc/nsswitch.conf配置文件。当Sudo尝试在受控的chroot环境中解析用户信息（如通过getpwnam或getgrnam函数）时，它会读取该伪造的配置文件。通过配置该文件指向攻击者控制的动态链接库（如libnss_woot.so.2），攻击者可以在Sudo以root权限运行的过程中加载并执行任意C语言构造函数代码。提供的Shell脚本POC展示了一个极其高效的攻击流：首先通过mktemp创建临时工作区，编写包含__attribute__((constructor))的C代码（该函数在库加载时立即执行），代码内容执行setreuid(0,0)并调用/bin/bash。随后通过gcc将其编译为共享库并放置在精心构造的目录结构中。最后通过执行'sudo -R woot woot'触发漏洞。经分析，该POC逻辑严密，直接利用了NSS加载机制，且避开了复杂的内存布局挑战，具有极高的实战有效性，在受影响的Kali Linux等发行版上可瞬间完成提权。【利用步骤】1. 创建临时目录并进入。2. 编写攻击性C源码，包含提权至root并执行shell的逻辑。3. 准备伪造的chroot目录结构，包含子目录etc和自定义的nsswitch.conf，并将密码数据库重定向到自定义库名。4. 使用gcc编译共享库，输出为libnss_[name].so.2格式。5. 运行sudo命令，利用-R参数指定伪造目录并触发命令执行。6. 观察到UID/GID变为0，获取root权限。 【投毒风险分析】该POC本身具有低到中度的投毒风险。分析其代码结构，其行为主要是本地文件的创建、编译和执行。风险点一：POC代码中使用了setreuid(0,0)和/bin/bash，这是典型的提权Payload，对于安全研究人员来说是透明的，但若由不明来源提供，其编译生成的.so文件可能被替换为包含持久化后门（如添加SSH Key或反弹Shell）的二进制文件。风险点二：搜索结果显示存在Rust实现的版本和预编译二进制版本，预编译的二进制文件投毒风险极高（约70%以上），因为攻击者可能在编译过程中植入恶意逻辑，用户难以审计。风险点三：GitHub存储库（如K1tt3h/CVE-2025-32463-POC）中可能存在引导用户下载外部脚本的操作。目前该Shell脚本POC代码清晰，未使用eval或Base64混淆，主要依赖系统标准工具（gcc, sudo），因此直接运行源码的风险相对可控，但强烈建议在受控的隔离虚拟机（Docker或VM）中进行测试，以防止提权成功后对宿主机产生不可逆影响。

**项目地址:** [https://github.com/K1tt3h/CVE-2025-32463-POC](https://github.com/K1tt3h/CVE-2025-32463-POC)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32462](https://avd.aliyun.com/detail?id=AVD-2025-32462)
