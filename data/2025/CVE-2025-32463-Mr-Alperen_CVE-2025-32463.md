## CVE-2025-32463 - sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= sudo < 1.9.17p1

**利用条件:** 本地普通用户权限，且系统安装了受影响版本的sudo程序

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码针对CVE-2025-32463漏洞提供了完整的利用逻辑。漏洞的核心在于sudo 1.9.14版本引入的机制缺陷，其在处理 -R (--chroot) 选项时，允许用户指定的根目录中存在恶意配置文件。POC通过以下步骤实现有效利用：首先，它创建一个临时的chroot环境目录结构，并在其中伪造 /etc/nsswitch.conf 文件。在Linux系统中，nsswitch.conf 决定了系统如何解析用户信息。POC将 passwd 数据库的解析指向一个自定义的库名 woot1337。接着，POC编写并编译了一个C语言编写的共享库 libnss_woot1337.so.2，该库利用 __attribute__((constructor)) 特性，在库加载时立即执行。代码中包含了 setreuid(0,0) 和 setregid(0,0) 调用，这旨在将进程的有效用户和组ID切换为root，随后通过 execl 启动一个新的bash shell。由于sudo在评估sudoers策略前会先处理chroot环境并根据 nsswitch.conf 加载对应的NSS库，这就导致原本作为普通用户的攻击者能够以root权限执行任意代码。经分析，该POC逻辑严密，直接利用了sudo处理路径解析的逻辑顺序漏洞，在受影响的Kali Linux等系统上具有极高的成功率。利用步骤：1. 创建临时工作目录并进入。2. 编写恶意C源码，定义构造函数执行提权及Shell启动指令。3. 建立虚假的chroot目录结构，包含 etc/nsswitch.conf 和 etc/group。4. 配置 nsswitch.conf 指向自定义库。5. 使用gcc编译共享库并放置在指定位置。6. 执行 sudo -R 命令触发漏洞。投毒风险分析：该POC本身代码透明，主要由Bash脚本、C源码和标准的gcc编译命令组成，不涉及混淆加密。其核心提权行为（修改UID、启动Shell）是此类Exp的标准操作，不应被视为投毒。风险点主要在于：第一，POC中使用了 mktemp 创建临时目录，需确保执行路径的安全性。第二，脚本中包含 set -e 错误处理，这符合开发规范，并非恶意隐藏。第三，虽然当前代码未见外部网络请求或二进制下载行为，但研究人员在使用此类利用脚本时，应警惕他人可能在编译参数中加入恶意LDFLAGS，或在C代码中隐藏静默修改系统后门（如添加sudoers记录）的指令。本POC表现为标准的防御性研究代码，未发现明显的投毒植入迹象，风险处于低位。建议在隔离的沙箱环境中进行复现验证，并重点关注编译出的 .so 文件是否包含预期之外的系统调用。

**项目地址:** [https://www.freebuf.com/articles/vuls/437488.html](https://www.freebuf.com/articles/vuls/437488.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
