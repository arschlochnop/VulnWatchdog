## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 具有本地普通用户访问权限，且系统支持 -R (--chroot) 选项

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析：该POC针对CVE-2025-32463漏洞提供了极高完整性的验证脚本。漏洞根源在于Sudo 1.9.14版本引入的一项更改，即在评估sudoers文件期间，利用chroot()解析路径时存在逻辑缺陷。攻击者可以通过sudo的-R（--chroot）选项指定一个受控目录作为根目录。此POC的核心逻辑是利用NSS（Name Service Switch）机制的劫持。在受控目录下伪造/etc/nsswitch.conf文件，并将其中的passwd查询重定向到攻击者编译的恶意共享库（libnss_woot1337.so.2）。当sudo尝试在chroot环境下解析用户信息时，会加载该恶意库。POC代码通过__attribute__((constructor))定义的构造函数，在库加载瞬间执行提权逻辑。有效性关键在于setreuid(0,0)和setregid(0,0)的使用，这确保了进程获得真实的root身份，并通过chdir('/')和execl('/bin/bash')实现从chroot环境的‘越狱’并弹回一个root shell。该利用链条完整，不依赖sudoers文件中的特定权限配置，即使是不在sudoers名单中的普通用户也能触发，因此在受影响版本上具有极高的成功率。利用步骤：1. 创建一个临时工作目录作为伪造的根路径。2. 编写C语言代码，利用GCC编译器生成一个包含提权逻辑的动态链接库，并命名为符合NSS规范的格式。3. 在伪造根目录下创建etc目录，并构造恶意的nsswitch.conf文件，配置其在解析用户信息时调用该动态库。4. 执行命令`sudo -R [伪造目录] [任意命令]`。此时Sudo会加载恶意库，触发构造函数，最终弹出具有root权限的bash终端。投毒风险分析：经过对提供的POC代码分析，投毒风险评估为10%（低风险）。代码逻辑透明且符合标准漏洞利用演示逻辑。首先，POC使用了标准的Shell脚本和C语言编写，所有操作均在本地/tmp目录下创建的随机临时目录中进行，未发现对系统关键配置文件的破坏性改写（如直接修改真实的/etc/shadow）。其次，C代码中的提权函数直接调用系统调用setreuid并启动/bin/bash，这是典型的提权演示逻辑，不包含任何远程下载恶意脚本、开启反弹shell后门或加密本地文件的行为。代码中没有混淆手段，所有操作（如mktemp、gcc编译、cp拷贝）均为安全研究中常见的标准操作。唯一的潜在风险点在于恶意库的编译和加载过程，但在防御性研究环境中，这种本地编译行为是完全可控的。该POC不涉及外部服务器通信，也不包含针对特定敏感资产的扫描逻辑，属于干净的、仅用于功能验证的Exploit代码。研究人员在复现时只需注意清理临时目录即可，不会对主机安全性造成持久性的负面影响。

**项目地址:** [https://xz.aliyun.com/news/18486](https://xz.aliyun.com/news/18486)

**漏洞详情:** [https://ubuntu.com/security/CVE-2025-32463](https://ubuntu.com/security/CVE-2025-32463)
