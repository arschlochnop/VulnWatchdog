## CVE-2025-32463 - Sudo 权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17

**利用条件:** 具有本地普通用户访问权限，系统安装有受影响版本的Sudo

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC代码针对CVE-2025-32463漏洞提供了极高完整性的验证流程。漏洞核心在于Sudo 1.9.14版本引入的一个回归缺陷：当使用-R（--chroot）选项时，Sudo在评估sudoers策略之前，会过早地根据用户指定的root目录解析路径。POC通过创建一个恶意的chroot环境并在其中放置伪造的/etc/nsswitch.conf文件，诱导Sudo在提升权限的过程中加载攻击者控制的动态链接库。分析代码发现，POC逻辑严密，首先利用__attribute__((constructor))定义了一个构造函数，该函数在库加载时立即执行，通过setreuid(0,0)和setregid(0,0)获取真实的root身份，并利用chdir('/')突破chroot环境限制，最终执行/bin/bash。这种利用方式巧妙地绕过了sudoers的配置检查。由于-R选项在执行命令前会进行NSS（Name Service Switch）查找，而POC提供的恶意动态库通过nsswitch.conf被注入到查找链中，这使得即便攻击者不在sudoers名单中，也能触发代码执行。该POC在Kali Rolling等现代Linux发行版上具有极高的成功率，因为它利用了Sudo内置的功能逻辑而非内存破坏，稳定性极强。【利用步骤】1. 创建临时工作目录并进入。2. 编写C语言源代码，构造带有提权逻辑的动态链接库，包含重置UID/GID及反弹Shell或启动Bash的代码。3. 构建伪造的chroot环境目录结构，至少包含etc和用户控制的lib目录。4. 在伪造的etc目录下创建恶意nsswitch.conf，配置其引用攻击者编译的NSS库。5. 使用gcc编译共享库并放置在相应位置。6. 执行命令‘sudo -R [伪造目录] [命令]’触发漏洞，此时Sudo会以root权限加载恶意库并执行构造函数。7. 成功获取root shell。【投毒风险分析】在对此POC进行投毒风险评估时，结果显示风险处于较低水平（约10%）。代码结构透明，采用标准的Bash脚本与内联C代码组合，未发现任何经过Base64加密、Hex编码或混淆处理的可疑二进制载荷。脚本中的所有操作均在/tmp下的临时目录中进行，不涉及对系统关键配置文件的持久化破坏。网络层面，代码中未见curl或wget尝试从远程C2服务器下载额外恶意载荷的行为，也没有发现向外部泄露环境变量或SSH密钥的后门逻辑。唯一需要警惕的是，由于该漏洞本身是本地权限提升，该脚本会被安全软件标记为特权提升工具。在防御性研究中使用时，研究人员应重点核实gcc编译出的.so文件是否仅包含定义的woot函数，防止在分发过程中被第三方篡改。整体而言，该POC是一个高质量的、纯粹的漏洞验证工具，不具备主动投毒特征。

**项目地址:** [https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot](https://www.stratascale.com/vulnerability-alert-CVE-2025-32463-sudo-chroot)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
