## CVE-2025-55182 - React Server Components, Next.js, Shopify Hydrogen, Gatsby 5 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js, Shopify Hydrogen, Gatsby 5

**危害等级:** 高危

**CVSS评分:** 未披露，但描述为高危，推测CVSSv3.1 9.8+

**影响版本:** Next.js <= 15.0.0, React <= 19.0.0, react-dom <= 19.0.0; 具体受影响组件及版本需参照官方安全公告。

**利用条件:** 无需认证，可通过构造恶意HTTP请求远程执行代码，攻击门槛低。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该PoC针对CVE-2025-55182 (React2Shell) 漏洞提供了高度有效且易于复现的利用方案，使其成为安全研究和防御验证的宝贵工具。它由一个精心设计的Python利用脚本 (`poc.py`)、一个用于快速搭建漏洞环境的Dockerfile以及一份详细而清晰的使用说明 (`README.md`) 组成。这种综合性的交付方式极大地降低了安全专业人员测试和理解此“核弹级”漏洞的门槛。
`poc.py`脚本以其简洁高效而著称。它使用Python的`requests`库，能够精准地构造和发送恶意HTTP请求。脚本的用户界面友好，仅要求提供目标URL和待执行的系统命令作为参数，大大简化了操作流程。其核心机制在于利用React Flight反序列化协议中对特定对象属性访问路径（如`__proto__`和`constructor`）缺乏严格校验的缺陷。攻击者通过在Flight协议的JSON-like流式格式中，巧妙地注入`$B`引用，结合可控的`_response._prefix`字段，能够劫持并利用`_formData.get`方法。这一系列操作最终导致在服务器端动态生成包含任意系统命令的JavaScript函数，并将其赋值给某个对象的`.then`属性。当这个`.then`属性被调用时，预设的系统命令便会在服务器上得以执行，从而实现远程代码执行（RCE）。脚本随后会解析服务器的响应，将命令的执行结果清晰地回显给攻击者，完整演示了从攻击发起、漏洞触发到结果获取的全链条。这种对细节的精确模拟，使得PoC在证明漏洞存在及其潜在影响方面具有极高的可靠性。
Dockerfile的加入是该PoC的另一大亮点。它基于`node:20-bookworm`这个稳定的Node.js环境，并精准地安装了`next@15.0.0`、`react@19.0.0`和`react-dom@19.0.0`等已知受影响的特定版本依赖。这消除了手动配置复杂开发环境的需要，避免了因版本不匹配导致测试失败的问题。Dockerfile还包含了一个最小化的Next.js App Router应用骨架，确保了PoC可以直接在一个功能完备但易受攻击的Web服务上运行。这种容器化的部署方式，不仅保证了漏洞环境的一致性和可重复性，也为研究人员提供了一个隔离且安全的测试沙箱。
综上所述，该PoC不仅能够稳定且可靠地在受控环境中复现CVE-2025-55182漏洞，而且其清晰的文档、易用的脚本和便捷的环境搭建机制，都使其成为评估和理解此高危漏洞的典范工具。它充分展示了漏洞的利用原理和实际危害，对于防御措施的制定具有重要的指导意义。

**利用步骤**:
1.  **环境搭建与启动**:
    *   首先，获取PoC代码包。如果PoC以压缩包形式提供，请解压到本地目录。
    *   打开命令行终端，导航到PoC代码的根目录，其中包含`Dockerfile`。
    *   使用Docker构建漏洞环境镜像：执行命令 `docker build -t react2shell .`。此过程将下载基础镜像、安装Node.js依赖以及配置一个易受攻击的Next.js应用。
    *   镜像构建成功后，运行容器以启动漏洞环境：执行命令 `docker run -p 3000:3000 react2shell`。这将启动一个Next.js服务器，默认监听在宿主机的`3000`端口，并通过`http://localhost:3000/`可访问。
2.  **执行漏洞利用**:
    *   确认漏洞环境已成功启动并可访问。
    *   在另一个命令行终端中，导航到PoC代码目录，确保`poc.py`脚本文件可见。
    *   运行PoC脚本，指定目标URL和期望在服务器上执行的系统命令。例如，要执行`id`命令以获取当前用户ID信息，请运行：`python poc.py -u http://localhost:3000/ -c 'id'`。若要读取服务器的`/etc/passwd`文件内容，则运行：`python poc.py -u http://localhost:3000/ -c 'cat /etc/passwd'`。
3.  **验证攻击结果**:
    *   PoC脚本将向目标`http://localhost:3000/`发送一个精心构造的HTTP POST请求。这个请求承载着利用React Flight反序列化漏洞的Payload。
    *   如果攻击成功，服务器端将执行`id`或`cat /etc/passwd`等指定命令。
    *   PoC脚本会解析服务器返回的响应，并在命令行中输出命令的执行结果（例如用户ID信息或`/etc/passwd`文件的内容）。攻击者通过观察这些回显信息，即可确认远程代码执行已成功实现。

**投毒风险分析**:
对该PoC的投毒风险评估为极低，约为10%。这一评估主要基于对代码的深度分析、依赖项的透明度以及其行为模式的审慎考量。
首先，**代码的透明度与可读性**是风险评估的核心。`poc.py`脚本使用标准的Python语言编写，代码结构清晰，逻辑简洁明了。它主要依赖于Python生态系统中广为人知且经过严格安全审查的标准库，如`requests`用于HTTP通信，`argparse`用于命令行参数解析，以及`json`用于数据序列化和反序列化。整个脚本中没有发现任何形式的代码混淆、恶意加密、或者难以理解的复杂算法。这种高度的透明性使得任何具备Python基础的安全专业人员都能够轻松审查其源代码，验证其行为是否与声称的漏洞利用目的相符，从而有效识别并排除潜在的恶意代码。
其次，**依赖项的明确性和安全性**是降低投毒风险的关键保障。`dockerfile`详尽地列出了构建漏洞环境所需的所有组件及其精确版本：`node:20-bookworm`作为基础镜像，以及`next@15.0.0`、`react@19.0.0`和`react-dom@19.0.0`。这些依赖项都是开源软件，其源代码可供公众审查，并且版本号固定，杜绝了在构建过程中引入未知或动态更新的恶意软件包的可能性。所有的包安装均通过标准的`npm install`命令完成，没有使用任何私有、未经审计或可疑的包源，进一步增强了安全性。
第三，**无恶意行为的迹象**是该PoC低风险评估的直接证据。通过对`poc.py`和`dockerfile`的代码进行全面审查，我们没有观察到任何超出“证明RCE漏洞存在”这一核心目标之外的额外恶意行为。例如，脚本不会尝试建立到未知C2服务器的反向Shell连接、不会未经用户授权修改系统文件、不会尝试进行权限提升、也不会下载并执行外部的未经审计的二进制文件或脚本。其网络请求仅限于目标URL，且其Payload旨在触发已知的漏洞机制。PoC的整个生命周期——从环境搭建到漏洞利用——都严格限定在演示漏洞效果的范围内，没有表现出任何传播恶意软件、窃取数据或进行其他破坏性活动的行为。
最后，**项目文档的负责任声明**也支持了其低投毒风险的评估。`README.md`文件明确指出该PoC仅为教育和研究目的而开发，并强烈建议仅在受控、授权和非生产环境中进行测试。这种清晰的声明表明了项目作者的负责态度，进一步增强了PoC的可信度。
综上所述，该PoC在设计、实现和文档方面均高度透明且安全。其代码清晰、依赖项明确、行为受限，不包含任何恶意或可疑功能，因此其投毒风险可以视为极低。在遵循其使用说明并在授权环境下使用时，用户可以放心地利用此PoC进行安全研究和验证工作，而无需担心其本身会带来额外的安全威胁。

**项目地址:** 未提供公开POC项目地址

**漏洞详情:** 未在输入中提供NVD链接，待官方发布后更新。
