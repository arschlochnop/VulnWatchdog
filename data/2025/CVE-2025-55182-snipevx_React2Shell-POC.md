## CVE-2025-55182 - React Server Components, Next.js 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** React Server Components, Next.js

**危害等级:** 严重

**CVSS评分:** 10.0

**影响版本:** React Server Components, Next.js (例如 Next.js 15.0.0, React 19.0.0, React-dom 19.0.0 及其他受影响版本)

**利用条件:** 无需认证，可通过网络访问利用

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-55182，又称“React2Shell”，是一个核弹级的远程代码执行（RCE）漏洞，严重影响使用React Server Components（RSC）架构的Next.js应用程序。该漏洞的CVSS评分高达10.0，允许未经身份验证的攻击者通过精心构造的请求在服务器上执行任意代码。其核心问题在于RSC在解析客户端相关请求时，对用户输入处理不当，未能进行充分的安全校验，导致攻击者能够操纵Flight协议的JSON-like流式格式，从而在服务器端注入并执行恶意代码。该漏洞由Lachlan Davidson发现，并于2025年12月3日公开披露。自披露以来，该漏洞已遭到大规模的实际利用，甚至有报告指出与中国有关联的国家背景威胁行为者在披露数小时内便积极利用此漏洞。

**POC有效性分析:**
该漏洞的Proof of Concept（POC）代码质量极高，评分为9/10，体现了其完整性和可用性。POC包含一个Python利用脚本（`poc.py`）和一个用于搭建易受攻击环境的`dockerfile`。`dockerfile`精确地配置了一个基于`node:20-bookworm`的Next.js应用，并安装了`next@15.0.0`、`react@19.0.0`和`react-dom@19.0.0`等特定脆弱版本，这与漏洞影响的版本范围高度吻合，确保了测试环境的真实性和可复现性。`poc.py`脚本是一个功能完整的利用工具，它接收目标URL和要执行的命令作为参数，能够直接触发远程代码执行。`README.md`中提供了清晰的用法说明和示例，如`python poc.py -u http://localhost:3000/ -c 'cat /etc/passwd'`，明确展示了其在目标服务器上执行任意命令的能力。该脚本使用标准的Python库，代码结构良好，易于理解和审计，证实了其通过发送特制HTTP请求来利用RSC解析缺陷，最终实现RCE的有效性。

**利用步骤:**
1.  **环境搭建（用于测试或复现）**: 首先，使用POC提供的`dockerfile`构建一个易受攻击的Next.js应用环境。在POC代码根目录下执行`docker build -t react2shell .`命令构建Docker镜像。构建完成后，通过`docker run -p 3000:3000 react2shell`命令运行容器，这将启动一个监听在3000端口的Next.js应用服务。
2.  **执行POC**: 运行Python利用脚本`poc.py`。通过`-u`参数指定目标Next.js应用的URL（例如：`http://localhost:3000/`），并通过`-c`参数指定要在目标服务器上执行的操作系统命令（例如：`id` 或 `ls -la /`）。命令格式如：`python poc.py -u http://localhost:3000/ -c 'id'`。
3.  **结果验证**: POC脚本执行后，将会在控制台输出远程命令的执行结果。攻击者可以检查输出内容，确认命令是否成功在目标服务器上执行，从而验证远程代码执行漏洞的存在及其可利用性。

**投毒风险分析:**
该POC代码（`poc.py`）及配套的`dockerfile`在投毒风险方面被评估为低风险（10%）。
1.  **代码透明性与可读性**: `poc.py`脚本采用纯Python编写，逻辑清晰，易于阅读和审计。它使用了Python的`requests`库用于发送HTTP请求、`argparse`用于解析命令行参数、`sys`和`json`用于数据处理。代码中没有发现混淆、加密或任何难以理解的恶意逻辑，所有操作都限制在本地执行和与目标服务器的通信中。
2.  **行为分析**: POC的核心功能是构造特定的HTTP请求，利用CVE-2025-55182漏洞在目标系统上执行用户指定的命令，并将结果返回。在审查的代码段中，没有发现任何迹象表明POC会执行恶意行为，如下载额外恶意负载、创建后门账户、修改系统配置、扫描内网或将敏感数据传输到外部C2服务器。
3.  **`dockerfile`安全性**: `dockerfile`仅用于搭建一个标准且易受攻击的Next.js环境，其内容专注于安装指定版本的`node`、`next`和`react`。没有在镜像构建或容器运行过程中插入任何恶意指令或配置。
4.  **免责声明**: `README.md`中明确强调该POC仅用于教育和研究目的，并建议在授权的、非生产环境中进行测试。这表明作者的意图是出于安全研究，而非恶意利用。尽管POC代码本身安全，但任何远程代码执行POC都可能被恶意行为者滥用，通过修改`COMMAND`参数来执行恶意操作。因此，在使用和分享此类POC时，仍需高度警惕并确保仅在授权和隔离的环境中进行，以防止潜在的误用风险。

**项目地址:** N/A

**漏洞详情:** N/A
