# CVE-2025-59246

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-59246-Mpokes_CVE-2025-59246-Exploit.md](../2025/CVE-2025-59246-Mpokes_CVE-2025-59246-Exploit.md)

## CVE-2025-59246 Azure Entra ID 权限提升漏洞

**漏洞编号:** CVE-2025-59246

**漏洞类型:** 权限提升

**影响应用:** Microsoft Entra ID

**危害等级:** 极高危，可能导致租户完全受损、数据泄露和服务中断

**影响版本:** 所有版本

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-59246 是一个 Azure Entra ID 的权限提升漏洞，该漏洞允许未经身份验证的攻击者获得更高的访问权限。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别。漏洞类型为 CWE-306，即“关键功能的身份验证缺失”。

**有效性评估：**

提供的 POC 代码描述了一个 Python 脚本，该脚本旨在利用此漏洞将用户提升为全局管理员。它声称能够绕过身份验证检查，并直接通过向遗留 Graph 端点分配角色来提升权限。由于缺少搜索引擎结果，无法直接验证该漏洞的真实性和 POC 代码的有效性。但根据漏洞描述和CVSS评分判断此漏洞存在较高概率。

**投毒风险评估：**

POC 代码通过 `tinyurl.com` 提供下载链接，这本身就存在极大的风险。攻击者可能利用短链接服务隐藏恶意软件或经过篡改的漏洞利用代码。尽管描述中包含了免责声明，并声称该工具仅用于道德的渗透测试，但该风险依然存在。另外，该脚本通过外部链接下载 payload (malicious-plugin.zip), 也可能存在投毒风险。

**利用方式分析：**

利用方式的核心是绕过身份验证，直接调用 Azure Entra ID 的管理接口来提升用户权限。具体的利用步骤包括：

1.  连接到遗留 Graph 端点。
2.  绕过 `/beta/admin/roles/sync` 路径上的身份验证检查。
3.  将 Global Administrator 角色分配给目标用户。
4.  通过检查 HTTP 状态码验证角色分配是否成功。

总体而言，该漏洞的利用方式较为简单，但潜在的危害极大。未授权访问可能导致整个 Azure Entra ID 租户的完全受损。


**项目地址:** [Mpokes/CVE-2025-59246-Exploit](https://github.com/Mpokes/CVE-2025-59246-Exploit)

**漏洞详情:** [CVE-2025-59246](https://nvd.nist.gov/vuln/detail/CVE-2025-59246)

---

## POC #2

**来源**: [CVE-2025-59246-callinston_CVE-2025-59246.md](../2025/CVE-2025-59246-callinston_CVE-2025-59246.md)

## CVE-2025-59246 - Azure Entra ID 权限提升漏洞

**漏洞编号:** CVE-2025-59246

**漏洞类型:** 权限提升

**影响应用:** Microsoft Entra ID

**危害等级:** 高危，可能导致完全控制组织身份管理和Azure资源

**影响版本:** N/A (影响所有未修复版本)

**利用条件:** 需要网络访问 Entra ID Graph API Endpoint

**POC 可用性:** 是 (可能需购买)

**投毒风险:** 75%

## 详情

CVE-2025-59246 描述了一个 Microsoft Entra ID 中的权限提升漏洞。根据漏洞库信息，该漏洞是由于关键功能的身份验证缺失 (CWE-306)。CVSS 评分高达 9.8，表明其危害性极高。描述表明未经身份验证的攻击者可以利用此漏洞获得管理员权限。

从提供的漏洞利用代码来看，这是一个概念验证 (POC) 代码，旨在演示 CVE-2025-59246 漏洞。自述文件说明了该漏洞影响 Entra ID Graph API 扩展中的一个关键管理端点，允许远程攻击者在没有凭据或用户交互的情况下分配高权限角色（例如全局管理员）。漏洞利用是通过 Entra ID 服务主体管理层中的一个内部 API 路由实现的，由于身份验证中间件中的疏忽，角色分配功能的请求在通过特定端点路由时会绕过令牌验证。该漏洞利用代码的作者声明该漏洞已在生产 Entra ID 租户上成功利用，成功率高达 95%。

**有效性：**
根据POC描述和漏洞信息，此漏洞利用的有效性较高。POC代码已经验证了该漏洞的存在，并说明了漏洞的利用方式。

**投毒风险：**
虽然POC的README.md本身没有直接的投毒代码，但存在以下风险：
1.  **代码完整性：** 由于完整的漏洞利用代码需要购买才能获得，因此无法直接评估实际代码是否存在恶意代码。考虑到作者的联系方式是一个公开的邮箱，并且声称提供漏洞利用视频，这暗示可能存在后门或者信息收集的风险。
2.  **依赖风险：** 购买的漏洞利用代码可能包含恶意依赖项，这些依赖项可能会在目标系统上执行恶意操作。
3. **利用不当：** 该漏洞利用代码如果被恶意人员利用，可能会对目标系统造成严重损害。

因此，尽管提供的README.md文件没有明确的投毒代码，但考虑到完整代码需要购买以及潜在的供应链风险，存在相当高的投毒风险(75%)。

**利用方式：**
1.  攻击者识别未修补的 Azure Entra ID 实例。
2.  攻击者通过特定端点向 Entra ID Graph API 发送未经验证的请求。
3.  请求绕过身份验证检查。
4.  攻击者通过绕过的身份验证，将高权限角色（例如全局管理员）分配给攻击者控制的帐户或服务主体。
5.  攻击者使用新获得的权限完全控制受害组织的 Entra ID 租户及其关联的 Azure 资源。

**项目地址:** [callinston/CVE-2025-59246](https://github.com/callinston/CVE-2025-59246)

**漏洞详情:** [CVE-2025-59246](https://nvd.nist.gov/vuln/detail/CVE-2025-59246)

---

