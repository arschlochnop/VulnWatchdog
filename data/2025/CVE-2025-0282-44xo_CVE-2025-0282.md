# CVE-2025-0282

> 📦 该CVE有 **10** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-0282-44xo_CVE-2025-0282.md](../2025/CVE-2025-0282-44xo_CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许远程未认证的攻击者执行任意代码。

**影响版本:** Ivanti Connect Secure <= 22.7R2.4, Ivanti Policy Secure <= 22.7R1.2, Ivanti Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 目标主机开启了 Ivanti Connect Secure, Policy Secure, 或者 Neurons for ZTA gateways服务，且攻击者可以进行网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是一个存在于 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中的栈溢出漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经验证的远程攻击者通过构造恶意的请求在目标系统上执行任意代码。\n\n**有效性：**\n提供的 POC 代码尝试利用该漏洞。它首先获取目标产品的版本信息，然后根据版本选择相应的内存地址偏移。POC 尝试构造溢出缓冲区，覆盖返回地址，并利用已知的代码片段 (gadgets) 来绕过安全措施并最终执行命令。漏洞利用代码中包含对版本信息的判断以及相应的gadget，存在利用成功的可能性。\n\n**投毒风险：**\n代码中存在一定的投毒风险，可能性估计为10%。虽然代码的主要逻辑是利用漏洞，但以下几点值得注意：\n1.  循环次数: 代码中有一个循环尝试利用漏洞，循环次数为 2048 次。如果利用失败，可能会对目标系统造成拒绝服务攻击，或者留下大量的临时文件。虽然`touch /var/tmp/haxor_{attempt}`本身没有危害，但大量创建会占用磁盘空间。\n2.  硬编码地址: `libdsplibs_base = 0xf6492000` 是一个硬编码的库地址。如果该地址不正确，会导致利用失败。而错误利用尝试，可能会导致服务崩溃或产生其他不可预测的结果。代码的实际效果取决于具体的环境配置。\n3.  版本检测不全:  `targets` 字典中的版本信息可能不全，如果目标版本不在字典中，利用会失败。\n4.  后门植入:  虽然代码的主要目的是执行 `touch /var/tmp/haxor_{attempt}` 命令，但攻击者完全可以修改这个命令来植入更复杂的后门。\n\n**利用方式：**\n1.  **版本检测：** 首先，POC 代码尝试通过发送 HTTP 请求到目标服务器的 `/dana-na/auth/url_admin/welcome.cgi?type=inter` 路径来获取目标产品的版本信息。\n2.  **漏洞利用：** 根据获取到的版本信息，POC 代码选择相应的偏移地址和 gadget。然后，构造一个包含恶意代码的 payload，通过 IF-T 协议发送到目标服务器。\n3.  **代码执行：** 如果 payload 成功发送到目标服务器，攻击者可以利用栈溢出漏洞覆盖返回地址，并执行恶意代码。代码中利用了 ROP (Return-Oriented Programming) 技术，通过串联多个 gadget 来绕过安全措施并执行任意命令。POC 中默认执行的命令是 `touch /var/tmp/haxor_{attempt}`，用于在目标服务器上创建一个临时文件。攻击者可以修改这个命令来执行其他操作，例如植入后门、窃取数据等。\n
**排序优先级说明:** 根据您的指示，我优先考虑了搜索结果（特别是关于在野利用的报道），然后是漏洞利用代码，最后是漏洞库信息。

**项目地址:** [44xo/CVE-2025-0282](https://github.com/44xo/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #2

**来源**: [CVE-2025-0282-AdaniKamal_CVE-2025-0282.md](../2025/CVE-2025-0282-AdaniKamal_CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 严重，远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 远程未授权访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2025-0282是一个存在于Ivanti Connect Secure, Policy Secure, 和 Neurons for ZTA gateways中的栈溢出漏洞。该漏洞允许未经身份验证的远程攻击者执行任意代码。CISA的已知被利用漏洞目录也收录了此漏洞，表明该漏洞已被积极利用。提供的PoC代码 `CVE-2025-0282.py` 主要用于检测目标URL是否存在漏洞，它通过发送GET请求到目标URL，然后从响应中提取产品版本，并判断是否属于受影响的版本范围。该PoC代码本身不包含恶意代码，主要用于验证漏洞的存在性。但是，存在极小的投毒风险，因为PoC可以被修改为在检测到漏洞存在后，执行恶意操作，例如下载并执行恶意payload。但提供的代码不具备该功能，所以投毒概率较低。漏洞利用方式是通过向目标系统发送特制的网络请求，触发栈溢出，覆盖返回地址，从而执行攻击者控制的代码。从搜索结果来看，此漏洞与IF-T连接处理方式有关。

**漏洞利用方式：**
1.  攻击者构造包含恶意代码的payload，该payload能够覆盖函数返回地址，指向攻击者指定的地址。
2.  攻击者通过IF-T连接或者其他漏洞触发点向目标系统发送payload。
3.  目标系统处理payload时，由于栈溢出漏洞，payload中的恶意代码覆盖了函数返回地址。
4.  当函数返回时，程序跳转到攻击者指定的地址，执行恶意代码，实现远程代码执行。

**项目地址:** [AdaniKamal/CVE-2025-0282](https://github.com/AdaniKamal/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #3

**来源**: [CVE-2025-0282-AnonStorks_CVE-2025-0282-Full-version.md](../2025/CVE-2025-0282-AnonStorks_CVE-2025-0282-Full-version.md)

## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问，目标系统运行受影响的Ivanti产品及版本。

**POC 可用性:** 是

**投毒风险:** 75%

## 详情

CVE-2025-0282是Ivanti Connect Secure、Policy Secure和Neurons for ZTA网关中存在的一个栈溢出漏洞。未经验证的远程攻击者可以通过向`/dana-na/auth/url_default/welcome.cgi`端点发送特制的POST请求来利用此漏洞，实现远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Google Cloud的分析）和提供的PoC代码，该漏洞被积极利用，且PoC代码旨在演示远程代码执行。 综合判断PoC代码是有效的。

**投毒风险分析：**

PoC代码存在很高的投毒风险，主要基于以下几点：

1.  **联系方式：** README中要求联系Telegram获取完整代码，这本身就增加了中间人攻击和代码篡改的风险。
2.  **OpenAI依赖：** PoC依赖 OpenAI API 获取系统地址、退出地址和shellcode，将漏洞利用的关键步骤外包给第三方服务，增加代码行为不可预测性，若 OpenAI 返回恶意内容，则可能被利用进行投毒。OPENAI_API_KEY 被代码托管者标记为 XXXX， 这意味着需要用户自行填写，存在让使用者意外使用付费API的可能性。
3.  **MongoDB存储：** PoC将利用结果存储在本地MongoDB数据库中，这虽然看似无害，但可能用于追踪用户行为或收集敏感信息，作者可以在MongoDB中预置恶意数据。
4.  **重试机制：** PoC包含重试机制，这可能被滥用，例如，在成功后植入后门。
5.  **Payload生成方式：** PoC结合msfvenom或OpenAI生成shellcode。虽然msfvenom是常用工具，但如果OpenAI生成恶意shellcode，则存在风险。

综上所述，PoC代码的投毒风险较高。尽管其目的是演示漏洞，但依赖第三方服务、不透明的代码获取方式以及可能存在的恶意代码植入都增加了风险。

**利用方式：**

1.  攻击者构造恶意的POST请求，发送到`/dana-na/auth/url_default/welcome.cgi`端点。
2.  该请求包含精心构造的payload，目的是覆盖栈上的返回地址。
3.  利用ROP（Return-Oriented Programming）绕过ASLR，执行攻击者注入的shellcode。
4.  Shellcode执行后，攻击者可以获得目标系统的控制权，例如反向shell。
5.  PoC代码尝试连接目标，从 OpenAI API 获取地址和 shellcode, 生成 payload, 然后发送 payload。 它验证 payload 并尝试再次连接直到成功。

**项目地址:** [AnonStorks/CVE-2025-0282-Full-version](https://github.com/AnonStorks/CVE-2025-0282-Full-version)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #4

**来源**: [CVE-2025-0282-B1ack4sh_Blackash-CVE-2025-0282.md](../2025/CVE-2025-0282-B1ack4sh_Blackash-CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要目标系统开启HTTPS(443端口)，且存在漏洞版本的Ivanti Connect Secure等产品。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中的一个栈溢出漏洞。攻击者可以通过发送特制的HTTP请求利用该漏洞，实现在目标系统上执行任意代码。根据搜索引擎结果和漏洞库信息，该漏洞已被积极利用。

**有效性:**
提供的Python POC代码尝试利用栈溢出漏洞。代码首先创建带有shell命令的恶意payload,然后通过HTTPS连接发送POST请求到 `/dana-na/auth/url_default/welcome.cgi` 接口。利用成功与否取决于payload的偏移量(offset)、system函数地址(system_address)和命令地址(command_address)是否正确，以及目标环境是否符合漏洞触发条件。 根据CISA KEV信息,该漏洞已被积极利用，因此提供的POC具有一定的有效性。

**投毒风险:**
代码中存在一定的投毒风险，尽管整体上实现的功能是利用漏洞上传webshell并执行命令，但仍有一些地方可能被利用执行恶意操作：
*   **默认参数:**  `offset=500, system_address=0x0804a360, command_address=0x0804b008` 这些硬编码的地址如果直接使用在不匹配的系统上，可能导致拒绝服务或者crash，从而干扰分析和利用。
*   **webshell上传和权限:** 上传webshell `/shell.php`本身就是一个高风险操作，如果攻击者控制了目标，webshell可以被用于长期控制和横向移动。
*   **利用痕迹清理:** 代码包含删除日志（`remove_log_entries`）和禁用更新（`disable_updates`）等操作，虽然看起来是消除利用痕迹，但也可能被滥用，例如阻止系统更新安全补丁。

综合来看，投毒风险主要来自于POC使用中可能存在的恶意利用，以及一些默认参数可能导致的不稳定行为。 因此，将投毒风险评估为 10%。

**利用方式:**
1.  **构建Payload:**  `create_exploit_payload` 函数用于构建溢出payload，该payload覆盖返回地址，使其跳转到`system()` 函数，并将执行的命令作为参数传递给`system()`。
2.  **发送请求:**  `send_payload` 函数通过 HTTPS 连接发送包含恶意payload的POST请求到目标系统的特定URI (`/dana-na/auth/url_default/welcome.cgi`)。
3.  **远程代码执行:** 如果漏洞利用成功，`system()`函数将执行payload中嵌入的命令，从而实现远程代码执行。
4.  **webshell上传和利用:**  通过`upload_web_shell`函数上传一个webshell，然后通过`execute_shell_command`函数执行任意命令。
5.  **持久化和隐藏:** 通过修改系统配置、删除日志等方式尝试在目标系统上建立持久存在，并隐藏攻击痕迹。 

**项目地址:** [B1ack4sh/Blackash-CVE-2025-0282](https://github.com/B1ack4sh/Blackash-CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #5

**来源**: [CVE-2025-0282-Hexastrike_Ivanti-Connect-Secure-Logs-Parser.md](../2025/CVE-2025-0282-Hexastrike_Ivanti-Connect-Secure-Logs-Parser.md)

## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 产品中的一个栈溢出漏洞。未经身份验证的远程攻击者可以利用此漏洞执行任意代码。 

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（日志解析器），可以确认该漏洞是真实存在的，并且已经被积极利用。

**投毒风险：**
提供的Python脚本 `ics_logs_parser.py` 主要功能是将 Ivanti Secure Connect 的 .vc0 日志文件转换为 CSV 格式，用于数字取证和事件响应。脚本本身的功能是提取和转换日志数据，没有发现直接执行恶意代码的逻辑。存在的风险点包括：

*   **依赖的`logmessages_map.csv`文件：** 如果该文件被篡改，可能导致日志解析结果不准确，影响安全分析。 但是，篡改该文件并不能直接执行任意代码，而只是会影响日志分析的准确性。
*   **代码注入风险：** 虽然代码中没有明显的恶意代码，但如果攻击者能够篡改 `ics_logs_parser.py` 文件，例如通过插入恶意代码到 `process_subline()` 函数中的 `datetime.fromtimestamp(...)` 调用，则可能实现远程代码执行。但是，这需要攻击者先获得对服务器的写入权限。

综合以上分析，考虑到脚本的功能和潜在的风险点，可以判断该仓库存在一定投毒风险，但主要集中在需要先获得系统权限进行篡改才能实现。因此，评估投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：** CVE-2025-0282 是一个栈溢出漏洞，位于处理特定类型的网络连接或请求的组件中（例如，IF-T 连接）。
2.  **利用过程：** 攻击者通过构造特制的网络数据包，向目标 Ivanti 设备发送精心设计的恶意数据。由于程序在处理这些数据时没有进行充分的边界检查，导致数据溢出到栈上，覆盖了返回地址或其他关键数据。
3.  **代码执行：** 攻击者通过栈溢出，将返回地址修改为攻击者控制的地址，该地址指向攻击者预先布置好的恶意代码（shellcode）。当程序执行到被覆盖的返回地址时，控制权转移到攻击者的 shellcode，从而实现远程代码执行。
4.  **搜索引擎补充：** 从搜索引擎结果来看，漏洞与 `web` 二进制文件有关，该文件处理 HTTP 连接和 VPN 连接。 

**总结：**
攻击者利用特制的网络请求触发栈溢出，覆盖返回地址，执行 shellcode，最终实现远程代码执行。提供的代码仓库是一个日志解析工具，本身不直接包含漏洞利用代码，但存在被篡改利用的风险。

**项目地址:** [Hexastrike/Ivanti-Connect-Secure-Logs-Parser](https://github.com/Hexastrike/Ivanti-Connect-Secure-Logs-Parser)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #6

**来源**: [CVE-2025-0282-absholi7ly_CVE-2025-0282-Ivanti-exploit.md](../2025/CVE-2025-0282-absholi7ly_CVE-2025-0282-Ivanti-exploit.md)

## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问目标设备的443端口，目标设备运行受影响的Ivanti Connect Secure, Policy Secure, 或 Neurons for ZTA gateways 版本，且未应用补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282是Ivanti Connect Secure, Policy Secure和Neurons for ZTA gateways中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞在目标设备上执行任意代码。

**有效性分析：**

提供的Python POC代码尝试利用该漏洞。代码首先创建一个包含溢出数据的payload，其中包括覆盖返回地址的system()函数地址和要执行的命令地址。然后，它通过HTTPS连接到目标IP，发送包含payload的POST请求到`/dana-na/auth/url_default/welcome.cgi`端点。最后，它接收响应。

根据漏洞描述和搜索结果，该漏洞存在于IF-T连接的处理方式中，POC代码利用了`/dana-na/auth/url_default/welcome.cgi`这个url，与搜索结果中提及的信息一致。因此，该POC代码看起来有效。

**投毒风险分析：**

仔细检查提供的POC代码，发现以下潜在的风险点：

*   **Web Shell 上传：** 代码中包含上传Web Shell的功能，虽然这本身是漏洞利用的一部分，但如果攻击者上传恶意Web Shell，可能会导致持续性的后门访问。
*   **修改系统配置：** 代码包含禁用SELinux，阻止syslog转发，以及修改文件系统挂载方式的功能。这些操作会降低系统的安全性，方便攻击者进行进一步的恶意行为。
*   **日志清除：** 代码包含清除日志的功能，这会隐藏攻击痕迹，增加检测和溯源的难度。
*   **停止和禁用自动更新：**代码包含停止和禁用自动更新的功能。这会使系统无法及时获得安全补丁，长期处于脆弱状态。

虽然这些功能在渗透测试中可能被用作提权或维持权限的手段，但是存在被恶意滥用的风险。这些操作可以视为攻击者在成功利用漏洞后，为了维持访问、隐藏踪迹和进一步控制系统而采取的措施。因此，综合判断，存在10%的投毒风险，主要体现在这些功能可能被用于恶意目的，而非POC本身直接包含恶意代码。

**利用方式：**

1.  攻击者构造包含恶意代码的payload，该payload利用栈溢出漏洞覆盖返回地址，指向system()函数。
2.  攻击者将payload嵌入到发往`/dana-na/auth/url_default/welcome.cgi`端点的HTTP POST请求中。
3.  目标设备接收到请求，由于存在栈溢出漏洞，payload中的恶意代码被执行，导致远程代码执行。
4.  POC中进一步利用WebShell进行远程命令执行，以及禁用SELinux, 阻止日志转发等操作进一步控制和隐藏攻击行为。

**项目地址:** [absholi7ly/CVE-2025-0282-Ivanti-exploit](https://github.com/absholi7ly/CVE-2025-0282-Ivanti-exploit)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #7

**来源**: [CVE-2025-0282-almanatra_CVE-2025-0282.md](../2025/CVE-2025-0282-almanatra_CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许未经身份验证的远程攻击者执行代码。

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要目标系统运行存在漏洞的Ivanti产品，并且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282是一个存在于Ivanti Connect Secure, Policy Secure, 和 Neurons for ZTA gateways中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞执行任意代码。

**有效性分析：** 根据漏洞库信息和搜索结果，该漏洞已被积极利用，并且存在公开的漏洞利用代码。POC代码尝试利用IF-T协议的漏洞，通过精心构造的数据包溢出栈缓冲区并覆盖返回地址，从而执行攻击者控制的代码。该代码包含针对特定版本的偏移量，如果版本检测成功并偏移量匹配，则漏洞利用的有效性较高。但如果版本不匹配，则利用会失败。

**投毒风险分析：** POC代码本身的功能是添加一个后门帐户（admin/admin），允许攻击者登录系统。这本身可以被视为一种投毒行为，因为攻击者可以通过该帐户长期控制系统。此外，POC代码包含许多“CAFEBEEF”魔术字，如果攻击者故意将这些值设置为恶意代码，则可能构成更隐蔽的投毒。总体而言，漏洞利用代码主要目标是添加后门用户,存在一定投毒风险，但直接向payload中植入恶意代码的概率较低，估计为10%。

**利用方式：**
1.  **版本检测：** 首先，利用代码尝试通过访问`/dana-na/auth/url_admin/welcome.cgi?type=inter`来检测目标Ivanti产品的版本。
2.  **选择目标：** 根据检测到的版本，选择相应的利用目标（包含偏移量等信息）。
3.  **协议切换：** 发送HTTP请求，尝试将连接升级到IF-T/TLS 1.0协议。
4.  **发送Payload：** 构造包含溢出数据的IF-T数据包，覆盖栈上的返回地址。Payload中包含：
    *   填充数据，用于到达vftable指针。
    *   指向vftable的gadget，用于控制程序流程。
    *   用于进一步控制堆栈和执行system函数的gadget。
    *   用于添加管理员后门用户的命令 (添加到`/etc/passwd`和`/etc/shadow`)。
5.  **执行命令：** 覆盖返回地址后，程序返回到攻击者控制的地址，最终执行添加后门用户的命令。


**项目地址:** [almanatra/CVE-2025-0282](https://github.com/almanatra/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #8

**来源**: [CVE-2025-0282-punitdarji_Ivanti-CVE-2025-0282.md](../2025/CVE-2025-0282-punitdarji_Ivanti-CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要目标设备运行受影响的 Ivanti 产品，且允许未授权网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure, 和 Neurons for ZTA gateways 产品中的一个栈溢出漏洞。攻击者可以通过发送特制的 HTTP 请求到 `/dana-na/auth/url_default/welcome.cgi` 接口利用此漏洞，实现未授权远程代码执行。根据提供的漏洞利用代码 `CVE_2025_0282_Ivanti.py`，利用方式如下：

1.  **构造恶意 Payload：** 使用 `create_exploit_payload` 函数创建一个包含填充数据、`system()` 函数地址、虚假返回地址以及要执行的命令地址的 payload。该函数通过栈溢出覆盖返回地址为 `system()` 函数的地址，并利用 `system()` 函数执行指定的命令。
2.  **发送 Payload：** 使用 `send_payload` 函数通过 HTTPS POST 请求将恶意 payload 发送到目标设备的 `/dana-na/auth/url_default/welcome.cgi` 接口。此函数首先创建一个 SSL 连接，然后构造包含 payload 的 HTTP 请求，并通过 SSL 连接发送。
3.  **执行命令：** 成功利用漏洞后，目标设备将执行 payload 中包含的命令。
4.  **上传 Web Shell：** 代码中包含 `upload_web_shell` 函数，允许攻击者将本地的 web shell 文件上传到目标服务器的 `/shell.php` 路径下。通过`exploit_vulnerability` 函数在目标服务器上执行 `echo '{web_shell_content}' > /shell.php` 命令实现。
5.  **验证 Web Shell：** `verify_shell` 函数尝试访问上传的 web shell，检查其是否可用。
6.  **执行 Web Shell 命令:** `execute_shell_command` 函数,通过POST请求,设置`cmd`参数,执行相关命令.
7.  **代码审计和投毒风险分析:**
    *   `disable_selinux`, `prevent_syslog_forwarding`, `remount_drive_rw`, `remove_log_entries`, `enable_selinux`, `remount_drive_ro`, `disable_updates` 这些函数目前处于注释状态，意味着它们在当前脚本版本中不会被执行，但是这些函数具有潜在的恶意行为。 如果这些函数被激活，则可能存在以下风险：
        *   禁用 SELinux 会降低系统的安全性。
        *   阻止 syslog 转发会阻止安全事件的日志记录。
        *   以读写方式重新挂载驱动器可能会允许修改关键系统文件。
        *   删除日志条目会覆盖攻击的痕迹。
        *   禁用更新可能会使系统容易受到攻击。
    *   虽然 `upload_web_shell` 功能本身是漏洞利用的一部分，但它也可能被认为是投毒行为，因为它在目标系统上安装了一个后门，攻击者可以利用该后门进行进一步的恶意活动。
    *   由于这些函数在当前版本中没有被激活，因此认为投毒的风险较低,约10%。

基于搜索结果，CVE-2025-0282 已被积极利用，并且存在可用的利用代码，这表明提供的 POC 代码很可能有效。CISA 已发布了针对该漏洞的缓解说明，进一步证明了其严重性和可利用性。

**项目地址:** [punitdarji/Ivanti-CVE-2025-0282](https://github.com/punitdarji/Ivanti-CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #9

**来源**: [CVE-2025-0282-sfewer-r7_CVE-2025-0282.md](../2025/CVE-2025-0282-sfewer-r7_CVE-2025-0282.md)

## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.5 (Connect Secure), < 22.7R1.2 (Policy Secure), < 22.7R2.3 (Neurons for ZTA gateways)

**利用条件:** 需要目标主机开放网络访问端口（通常为443或80）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，该漏洞已被积极利用（in the wild）。提供的PoC代码基于watchTowr发布的利用策略，并且Rapid7也发布了相关的漏洞分析，表明PoC的有效性较高。

**投毒风险：**
PoC代码主要实现了以下功能：
1.  确定目标产品的版本。
2.  根据版本选择相应的内存地址偏移量（gadget）。
3.  构造包含溢出数据的HTTP请求，其中包含指向内存地址的指针，这些地址指向可用于执行任意代码的指令序列（ROP链）。
4.  发送恶意请求，触发栈溢出，并控制程序执行流程。

PoC代码中存在投毒的可能性较低，但不能完全排除。可能存在的风险包括：
1.  修改ROP链，植入恶意代码，例如下载和执行恶意软件。
2.  修改目标版本判断逻辑，使PoC在不适用的版本上运行，导致拒绝服务或系统崩溃。
3.  在溢出数据中添加额外的shellcode，用于执行恶意操作。
虽然存在理论上的投毒风险，但此PoC看起来较为直接地实现了漏洞利用逻辑。综合考虑，投毒风险估计在5%左右。

**利用方式：**
1.  攻击者首先向目标服务器发送HTTP请求，获取目标产品的版本信息。
2.  PoC脚本根据获取的版本信息选择相应的gadget地址。
3.  PoC脚本构造恶意的HTTP请求，该请求包含精心设计的溢出数据，覆盖栈上的返回地址。
4.  覆盖的返回地址指向ROP链，ROP链中的指令序列被设计为执行特定的操作，例如调用`system()`函数执行任意命令。
5.  目标服务器处理恶意请求时，触发栈溢出，程序执行流程被重定向到ROP链，最终导致任意代码执行。
根据 Palo Alto Networks 的报告，该漏洞与 IFT (IF-T) 连接的处理方式有关。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [sfewer-r7/CVE-2025-0282](https://github.com/sfewer-r7/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

## POC #10

**来源**: [CVE-2025-0282-watchtowrlabs_CVE-2025-0282.md](../2025/CVE-2025-0282-watchtowrlabs_CVE-2025-0282.md)

## CVE-2025-0282 - Ivanti Connect Secure 堆栈缓冲区溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 22.7R2.4 (Connect Secure), <= 22.7R1.2 (Policy Secure), <= 22.7R2.3 (Neurons for ZTA gateways)

**利用条件:** 需要网络访问到受影响的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是一个 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA 网关中存在的堆栈缓冲区溢出漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者执行代码。CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明它已被积极利用。

**有效性：**
提供的 PoC 代码基于 `openconnect`，这是一个开源 VPN 客户端。PoC 分为“Normal”模式和“Exploit”模式。“Normal”模式用于测试目标是否正常运行。“Exploit”模式包含利用堆栈缓冲区溢出的代码。PoC 文档明确指出 exploit 代码包含硬编码的地址和偏移量，需要根据目标环境进行修改。这意味着直接使用提供的 PoC 可能无法成功，需要进行调整。

**投毒风险：**
PoC 代码是基于 `openconnect` 修改的，作者也明确表示代码存在非关键性的缺陷，需要使用者付出努力才能使其工作。这种情况下，存在一定的投毒风险，但作者已声明此 PoC 需要手动修改地址和偏移量才能利用，因此可解释为避免直接使用导致意外情况发生，但是存在一定风险，无法保证没有隐藏其他非预期行为。 考虑到作者已经明确说明PoC需要手动修改，并且提供详细的技术文章和背景信息，投毒的可能性相对较低，但仍然存在。风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 该漏洞存在于 IFT（IF-T）连接的处理方式中。通过向存在漏洞的 Ivanti Connect Secure 发送特制的请求，可以触发堆栈缓冲区溢出。
2.  **栈溢出：** 攻击者通过构造特定的数据包，覆盖堆栈上的返回地址，劫持程序的控制流。
3.  **远程代码执行：** 通过控制返回地址，攻击者可以将程序重定向到预先设置的 shellcode，从而执行任意代码。

**总结：**
CVE-2025-0282 是一个严重的安全漏洞，利用难度较高，但一旦成功利用，将导致严重的后果。提供的 PoC 代码可以作为利用该漏洞的起点，但需要根据目标环境进行修改和调整。

**项目地址:** [watchtowrlabs/CVE-2025-0282](https://github.com/watchtowrlabs/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)

---

