# CVE-2025-26794

> 📦 该CVE有 **2** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-26794-XploitGh0st_CVE-2025-26794-exploit.md](../2025/CVE-2025-26794-XploitGh0st_CVE-2025-26794-exploit.md)

## CVE-2025-26794-Exim-SQL注入

**漏洞编号:** CVE-2025-26794

**漏洞类型:** SQL注入

**影响应用:** Exim

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 4.98 (before 4.98.1)

**利用条件:** 需要Exim使用SQLite hints和ETRN序列化，网络可访问SMTP服务(25端口)，无需认证即可使用ETRN命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26794是Exim 4.98中的一个SQL注入漏洞，当Exim配置为使用SQLite DBM存储并且ETRN命令处理程序处理序列化数据时，会发生此漏洞。由于用户可控输入在SQL查询构造之前未经过充分的清理，攻击者可以利用此漏洞提取敏感数据，执行基于时间的盲SQL注入攻击，并枚举数据库结构（表、列、数据）。

**有效性：**
提供的PoC代码有效。漏洞库信息、搜索引擎结果(虽然为空，但暗示存在相关信息)以及漏洞利用代码的README.md文件都表明了该漏洞的存在和利用方式。

**投毒风险：**
README.md文件本身没有明显的投毒代码，但存在一定的风险。风险点在于:

1.  **依赖缺失风险：** README.md表明无依赖库，但是实际使用时可能会加入恶意的依赖.
2.  **代码混淆风险：** exploit.py可能包含混淆的代码，难以直接判断是否存在恶意行为，增加了安全风险。
3.  **隐蔽后门：** 即使exploit.py不包含直接的恶意代码，它也可能利用SQL注入漏洞在目标系统上植入后门或执行其他恶意操作，例如添加管理员账户，修改系统配置等。

综合考虑，投毒风险为10%。

**利用方式：**

1.  **漏洞触发：** 通过SMTP协议向目标Exim服务器发送包含恶意SQL注入payload的ETRN命令。
2.  **Payload构造：** SQL注入payload利用了ETRN命令处理程序中对用户输入的未充分清理，将恶意SQL代码注入到SQLite查询中。示例payload：`ETRN #',1); <MALICIOUS_QUERY> /*`
3.  **数据提取/利用：** 攻击者可以使用时间型盲注（通过`SELECT 1 FROM tbl WHERE 1234=LIKE('ABCDEFG',UPPER(HEX(RANDOMBLOB(500000000/2)))))`等SQLite特定的时间延迟函数）或直接执行SQL查询来提取敏感数据，例如数据库结构、用户凭据等。
4.  **自动化利用：**  PoC代码提供了多种模式，包括自动化数据库dump、交互式SQL查询等，方便攻击者进行漏洞利用。

**项目地址:** [XploitGh0st/CVE-2025-26794-exploit](https://github.com/XploitGh0st/CVE-2025-26794-exploit)

**漏洞详情:** [CVE-2025-26794](https://nvd.nist.gov/vuln/detail/CVE-2025-26794)

---

## POC #2

**来源**: [CVE-2025-26794-ishwardeepp_CVE-2025-26794-Exim-Mail-SQLi.md](../2025/CVE-2025-26794-ishwardeepp_CVE-2025-26794-Exim-Mail-SQLi.md)

## CVE-2025-26794-Exim-SQL注入

**漏洞编号:** CVE-2025-26794

**漏洞类型:** SQL注入

**影响应用:** Exim

**危害等级:** 高危，可能导致信息泄露和远程命令执行

**影响版本:** 4.98 (不含 4.98.1)

**利用条件:** 需要开启SQLite hints和ETRN序列化

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26794是Exim 4.98版本（低于4.98.1）中存在的一个SQL注入漏洞。当Exim同时使用SQLite hints和ETRN序列化时，攻击者可以通过构造恶意的SQL语句，注入到SQLite数据库查询中，从而执行未授权的SQL命令。根据漏洞库信息，CVSS 3.1评分为7.5，属于高危漏洞。

**漏洞利用有效性：**

根据提供的漏洞利用代码（Dockerfile和相关配置文件），该代码创建了一个Exim 4.98的Docker镜像，并配置了SQLite支持。Dockerfile主要作用是搭建漏洞环境，包含以下关键步骤：

*   从Debian镜像构建。
*   安装Exim所需的依赖库（包括libsqlite3-dev和sqlite3）。
*   克隆Exim的git仓库，并checkout到4.98版本。
*   修改`Local/Makefile`以启用SQLite支持（`USE_SQLITE = yes`和`DBMLIB = -lsqlite3`）。
*   编译并安装Exim。

这些步骤表明PoC代码是有效的，因为它创建了一个存在漏洞的环境，方便研究和验证。

根据搜索引擎结果，[webpage 6] 提到“The SQL parameters, when SQLite is used as the DBM, are not properly sanitized. This results in the possibility of a remote user to craft custom SQLite queries.”，进一步确认了漏洞的可利用性。

**投毒风险分析：**

分析Dockerfile和Makefile-Linux，没有发现明显的恶意代码或后门，但存在潜在的风险：

*   PoC为了简化过程，可能关闭了一些安全选项，这本身就引入了安全风险。
*   `start-exim.sh` 文件内容缺失，无法评估其安全性，存在一定风险。
*   虽然启用了SQLite，但`configure`文件内容并不完整，缺少关于SQLite hints和ETRN序列化如何配置的细节，如果配置不当可能导致其他安全问题。
*   PoC中对EXIM_USER进行了修改，可能导致权限问题。

综合来看，投毒的可能性较低，大约为10%。主要风险在于PoC环境的安全性可能低于生产环境，容易被攻击者利用进行进一步渗透。

**利用方式：**

该漏洞的利用方式是通过向Exim发送特制的ETRN请求，其中包含恶意的SQL代码。当Exim处理该请求并将其插入到SQLite数据库查询中时，恶意SQL代码将被执行。攻击者可以通过这种方式读取、修改甚至删除数据库中的数据，或者执行其他恶意操作。常见的攻击方法包括：

*   **信息泄露：** 攻击者可以通过注入SQL查询，获取数据库中的敏感信息，例如用户凭据、邮件内容等。
*   **权限提升：** 如果Exim以高权限用户身份运行，攻击者可以通过SQL注入执行系统命令，从而获得服务器的控制权。
*   **拒绝服务：** 攻击者可以通过注入SQL查询，导致数据库崩溃或Exim进程挂起，从而造成拒绝服务攻击。

**项目地址:** [ishwardeepp/CVE-2025-26794-Exim-Mail-SQLi](https://github.com/ishwardeepp/CVE-2025-26794-Exim-Mail-SQLi)

**漏洞详情:** [CVE-2025-26794](https://nvd.nist.gov/vuln/detail/CVE-2025-26794)

---

