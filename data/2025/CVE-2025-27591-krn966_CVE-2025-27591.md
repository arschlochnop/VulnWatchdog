## CVE-2025-27591 - Below (Facebook 开源的系统监控工具) 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook 开源的系统监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Below < 0.9.0

**利用条件:** 本地普通用户访问权限，且目标系统运行了受影响版本的 below 服务/工具

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-27591 是存在于 Meta 开发的系统监控工具 'below' 中的一个高危本地权限提升漏洞。该漏洞的核心原因在于 insecure log handling（不安全的日志处理机制）。根据公开披露的信息，below 在 v0.9.0 之前的版本中，会创建一个全局可写的目录 /var/log/below，并且在向该目录写入日志文件（如 error_root.log）时，未能正确校验文件路径的符号链接（Symlink）。这导致了典型的符号链接攻击风险。关于 POC 的有效性分析：提供的 POC 代码逻辑清晰且符合此类漏洞的标准利用链。首先，攻击者利用 /var/log/below 目录的全局可写权限，删除现有的日志文件并创建一个指向敏感系统文件（如 /etc/passwd）的同名符号链接。当 root 用户或通过 sudo 运行 below 记录命令时，程序会遵循该符号链接并将内容写入目标敏感文件。由于 root 权限具有覆盖写入能力，攻击者可以通过特定的注入手法（如将带有 UID 0 的新用户行追加到 /etc/passwd）来获取完整的系统管理权限。经评估，该 POC 逻辑在受影响的 Linux 环境下具有极高的利用成功率，属于功能完整的 Exploit。利用步骤如下：1. 确认系统是否存在 /var/log/below 目录。2. 清理现有的日志文件。3. 使用 ln -s 命令创建一个指向 /etc/passwd 的符号链接，命名为 error_root.log。4. 诱导系统触发 below 记录操作。5. 利用权限覆盖向 /etc/passwd 写入攻击者定义的 root 用户信息。6. 通过 su 命令切换至新用户完成提权。关于投毒风险分析：该 POC 来源于 GitHub 仓库 BridgerAlderson/CVE-2025-27591-PoC。经过代码审计，目前公开的代码主要由标准的 Bash 命令组成（如 rm, ln, echo, sudo），没有发现混淆代码、Base64 加密的恶意载荷、或是向外部 C2 服务器发起的可疑网络连接。虽然 POC 本身具有攻击性，但其行为完全是为了展示漏洞的触发机制，而非隐藏的恶意后门。然而，作为安全研究人员仍需注意，此类权限提升脚本极易被修改。在野外环境下，某些投毒者可能会在提权脚本末尾添加一行隐藏的 curl 指令用于下载后续木马，或者修改 /tmp 路径下的文件操作逻辑来植入持久化后门。就目前分析的样本而言，投毒风险较低（约 15%），主要风险点在于其对系统文件 /etc/passwd 的修改是破坏性的，如果在非实验环境下运行可能导致系统登录机制崩溃。建议防御者在受控的沙箱环境中使用非 root 用户进行初步验证，并重点监控对 /var/log 目录下异常符号链接的创建行为。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
