## CVE-2025-61228 - SuperDuper 权限提升, 隐私信息泄露

**漏洞编号:** CVE-2025-61228

**漏洞类型:** 权限提升, 隐私信息泄露

**影响应用:** SuperDuper

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** SuperDuper 3.10及更早版本

**利用条件:** 需要用户运行SuperDuper，并接受恶意更新

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 60%

## 详情

CVE-2025-61228 存在于 SuperDuper 软件的自动更新机制中。攻击者可以通过劫持该机制，诱骗用户安装非官方的恶意软件包，从而实现权限提升和隐私数据泄露。该漏洞的核心在于，macOS 的包安装器在安装 SuperDuper 的更新时，没有充分验证软件包的 notarization 信息，导致恶意程序可以冒充官方更新进行安装，利用步骤如下：

1.  攻击者首先需要创建一个恶意的软件包，该软件包包含恶意代码，例如修改系统文件、窃取用户数据等。
2.  攻击者通过某种方式（例如 DNS 劫持、中间人攻击）拦截 SuperDuper 的自动更新请求，并将恶意软件包的下载链接返回给 SuperDuper。
3.  当 SuperDuper 检测到有新版本可用时，会提示用户进行更新。
4.  如果用户点击“更新”按钮，SuperDuper 将会下载并安装恶意软件包。
5.  恶意软件包在安装过程中，会利用 root 权限执行恶意代码，从而实现权限提升和隐私数据窃取。恶意代码可以访问用户的桌面文件，窃取用户隐私数据，或者在系统中创建一个后门，方便攻击者后续进行控制。根据POC代码，该漏洞可以直接在用户上下文中执行任意代码，权限提升，并窃取用户隐私信息，如桌面文件，在/Library/test目录中写入文件，这表明攻击者可以完全控制用户的系统。

POC有效性分析：该POC提供了一个完整的利用链，包括生成恶意软件包、修改 SuperDuper 的更新 URL、以及触发更新过程。通过执行该 POC，可以验证漏洞的真实性和危害性，该poc可以直接执行，并达成描述中的效果。

**投毒风险分析：**
该 POC 存在一定的投毒风险。首先，POC 代码会创建和修改系统文件，例如在 `/Library/test` 目录下创建文件，这可能会对用户的系统造成损害。其次，POC 代码会窃取用户的桌面文件，这涉及到用户的隐私数据。此外，POC 代码还包含一些可疑操作，例如使用 `defaults` 命令修改系统设置，这可能会对系统的安全性产生影响。POC脚本将home目录和用户名导出为环境变量，这可能被滥用。POC创建的包虽然没有直接展示恶意后门代码，但脚本中包含复制/Applications/SuperDuper!.app到临时目录的行为，可能用于后续的恶意操作，例如替换或篡改原程序。脚本使用`textutil -convert rtf /tmp/superduper_install/update.html` 命令将HTML转换为RTF，这可能被利用来执行恶意代码，因为RTF格式本身可以包含恶意代码。脚本通过`defaults -currentHost write com.blacey.SuperDuper UMdownloadURL "file:///tmp/superduper_install/superduped.tar.gz"`来修改SuperDuper的下载URL，将下载源指向本地文件，存在被篡改的风险，将该风险定为中等，为60%。

**项目地址:** https://github.com/ThumpBo/CVE-2025-30208-EXP

**漏洞详情:** 待定
