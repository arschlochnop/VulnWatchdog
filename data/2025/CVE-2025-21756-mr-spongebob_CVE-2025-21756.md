# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

# CVE-2025-21756

> 📦 该CVE有 **3** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-21756-hoefler02_CVE-2025-21756.md](../2025/CVE-2025-21756-hoefler02_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃、权限提升或信息泄露

**影响版本:** Linux kernel versions before the fixes mentioned in the CVE details (e.g., versions before specific commits in the git repository). Affected versions include 5.5 and potentially some versions in the 5.10, 5.15, 6.1, 6.6, 6.12, and 6.13 series.

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756是Linux内核vsock(虚拟套接字)实现中的一个释放后使用(Use-After-Free)漏洞。该漏洞源于套接字绑定在传输重新分配期间未正确保留，导致在`vsock_bind`函数中对已释放的套接字内存进行访问。攻击者可以利用此漏洞导致内核崩溃、权限提升或信息泄露。

**有效性分析：**

提供的漏洞利用代码看起来是针对此漏洞的，包括了重现漏洞所需的步骤，例如创建和绑定vsock套接字。该代码包含编译脚本(compress.sh)，用于创建包含exploit的initramfs镜像。`run.sh`脚本使用QEMU启动一个包含易受攻击内核的虚拟机，并挂载创建的initramfs。`x.c`是利用代码,它使用了AF_VSOCK相关socket api。
漏洞利用代码`x.c`尝试触发Use-After-Free漏洞，利用`query_vsock_diag`函数,并尝试获取shell。

**投毒风险分析：**

该仓库中存在投毒代码的风险较低，估计为10%。以下是原因：

*   `readme.md`文件声明这是一个漏洞利用程序，并链接到CVE详细信息。
*   `run.sh` 脚本使用 `-nographic` 和 `-monitor /dev/null` 参数，这表明该脚本旨在运行一个headless VM，不太可能包含恶意交互。
*   代码中可能存在后门或恶意逻辑的潜在位置是 `get_shell()` 函数，但该函数只是检查用户 ID 是否为 0，如果为 0 则启动一个 shell。 这在漏洞利用上下文中是合理的。但是，仍然存在轻微风险，即可以修改该函数以执行恶意操作，但概率较低。

**利用方式分析：**

利用方式涉及以下步骤：

1.  **构建环境：** 使用提供的脚本和内核镜像设置易受攻击的Linux内核环境（使用QEMU）。
2.  **编译Exploit：** 使用`compress.sh`脚本编译C代码 (`x.c`) 并创建包含编译后的可执行文件的initramfs镜像。
3.  **触发漏洞：** 在虚拟机中执行利用程序。 该利用程序利用vsock套接字API来触发`vsock_bind`函数中的Use-After-Free漏洞。`query_vsock_diag` 函数被用来辅助漏洞触发。
4.  **权限提升（如果成功）：** 如果成功利用该漏洞，该程序将尝试通过`get_shell`函数获得root shell。

该漏洞是本地权限提升漏洞，需要用户在系统上运行该利用程序。

**项目地址:** [hoefler02/CVE-2025-21756](https://github.com/hoefler02/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #2

**来源**: [CVE-2025-21756-khoatran107_cve-2025-21756.md](../2025/CVE-2025-21756-khoatran107_cve-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Linux Kernel 5.5之前及多个5.x、6.x版本的中间版本 (具体参考漏洞库信息)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 是 Linux kernel vsock (Virtual Socket) 实现中的一个 Use-After-Free 漏洞。攻击者可以通过不当的 socket unbinding 时序触发该漏洞，导致释放后的内存被再次访问，从而可能实现本地权限提升。

**漏洞分析：**
漏洞源于 `vsock_remove_bound` 函数在 transport reassignment 期间没有检查 socket 是否已绑定并移至绑定列表。当 `vsock_bind` 假设 socket 位于 unbound 列表时，`__vsock_insert_bound` 尝试调用 `__vsock_remove_bound`，导致对已释放的 socket 对象执行操作。

**利用方式：**
1.  创建一个 vsock socket。
2.  触发 transport 的 release 操作，这会导致 `vsock_remove_bound` 被调用，但 socket 仍然被认为是 unbound。
3.  调用 `vsock_bind`，此时 `__vsock_remove_bound` 会尝试删除一个已经释放的 socket，导致 Use-After-Free。

根据提供的漏洞利用代码，该POC主要分为两部分：KASLR 绕过和漏洞利用。`entrybleed.c` 使用侧信道攻击来泄露内核基地址，绕过 KASLR。泄露内核基址后，可以利用该地址构造ROP链或者直接修改内核数据，从而实现提权。提供的 `README.md` 说明该利用基于 [Michael Hoefler's writeup](https://hoefler.dev/articles/vsock.html)，并指出exploit的spray步骤有所不同。说明该漏洞已经有公开的分析文章，更容易利用。 `extract-image.sh` 是一个辅助脚本，用于从内核镜像中提取未压缩的 vmlinux，可能用于静态分析或者调试。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的 Linux kernel Use-After-Free 漏洞，并且存在利用代码，所以判断提供的POC代码有效。

**投毒风险评估：**
虽然POC代码包含一个 `flag` 文件，这更像是CTF的题目配置，并不代表投毒。`entrybleed.c` 看起来是用于泄露内核基地址，没有明显的恶意行为。`compile.sh` 只是编译脚本。 `local_runner.sh` 主要作用是设置运行环境，看起来没有植入恶意代码。 总体来看，代码仓库没有明显的投毒行为。风险主要在于漏洞本身可能被用于恶意目的。考虑到作者在 `README.md` 中提到了与原始利用的不同之处（spray step），存在作者修改了原始利用，插入恶意代码的可能性，但是概率较低，故评估投毒风险为10%。

**项目地址:** [khoatran107/cve-2025-21756](https://github.com/khoatran107/cve-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---

## POC #3

**来源**: [CVE-2025-21756-mr-spongebob_CVE-2025-21756.md](../2025/CVE-2025-21756-mr-spongebob_CVE-2025-21756.md)

## CVE-2025-21756-Linux Kernel vsock Use-After-Free

**漏洞编号:** CVE-2025-21756

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和内核崩溃

**影响版本:** Linux kernel versions prior to the fixes mentioned in the CVE details

**利用条件:** 需要启用CONFIG_VSOCKETS内核配置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21756 存在于Linux内核的vsock子系统中，是一个经典的use-after-free漏洞。根据漏洞信息，当 transport 在重新分配时，socket binding 状态处理不当导致此漏洞。具体来说，`vsock_remove_bound()` 函数在 sk 被绑定并移动到绑定列表之前被调用，从而释放了 socket 结构。之后 `vsock_bind()` 函数尝试访问已释放的 socket 结构，导致use-after-free。

**漏洞利用方式分析：**

1.  **触发漏洞：**PoC 通过 `vsock_bind()` 和 `getsockname()`  等函数创建并绑定 vsock socket。然后，它利用传输重新分配期间的竞争条件触发 `vsock_remove_bound()` 的过早调用。
2.  **内存布局：** PoC 代码尝试通过分配大量的 socket 对象来控制内存布局，这有助于增加漏洞利用的可靠性。 `junk[FLUSH]` ,`pre[PRE]`和`post[POST]`这些操作用于进行内存的填充，以便后续的释放可以触发 UAF。
3.  **利用UAF：** PoC中的关键步骤是`vsock_bind(VMADDR_CID_LOCAL, VMADDR_PORT_ANY, SOCK_SEQPACKET);` 和后续的 `bind(junk[i], (struct sockaddr *)&sa, sizeof(sa))`。通过重复绑定操作，可以创造UAF利用的条件。通过netlink socket进行诊断操作。
4.  **权限提升：** 成功触发 UAF 后，攻击者可以控制被释放内存的内容，并覆盖关键的内核数据结构。通过覆盖这些数据结构，攻击者可以修改进程的凭据，从而获得 root 权限。

**有效性评估：**

根据PoC代码和漏洞描述，可以判断该PoC具有较高的有效性。漏洞描述中提供了详细的堆栈信息，这表明该漏洞在真实环境中是可利用的。搜索结果也表明，该漏洞已经有公开的PoC代码。

**投毒风险评估：**

PoC代码本身包含漏洞利用逻辑，可能存在一定的投毒风险。通过阅读 `README.md` 文件,作者提示需要检查`CONFIG_VSOCKETS` 是否开启,如果开启则存在风险。该PoC代码直接编译运行，没有发现明显的恶意代码。 投毒风险评估在10%左右，主要基于对代码作者的信任和代码本身实现的复杂性，不能完全排除作者在代码中隐藏后门或恶意逻辑的可能性，但可能性较低。

总而言之，CVE-2025-21756 是一个严重的安全漏洞，攻击者可以利用它来获得 root 权限。建议尽快升级到修复后的内核版本。

**项目地址:** [mr-spongebob/CVE-2025-21756](https://github.com/mr-spongebob/CVE-2025-21756)

**漏洞详情:** [CVE-2025-21756](https://nvd.nist.gov/vuln/detail/CVE-2025-21756)

---



---



---



---



---



---



---



---



---



---



---



---

