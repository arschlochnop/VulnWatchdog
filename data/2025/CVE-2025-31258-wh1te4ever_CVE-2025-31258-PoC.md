## CVE-2025-31258 - Apple macOS (RemoteViewServices.framework) 沙箱逃逸 (Sandbox Escape)

**漏洞编号:** CVE-2025-31258

**漏洞类型:** 沙箱逃逸 (Sandbox Escape)

**影响应用:** Apple macOS (RemoteViewServices.framework)

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H (预计 8.8)

**影响版本:** macOS 15 以前版本 (具体受影响版本视官方通告为准)

**利用条件:** 攻击者需在受沙箱限制的进程中执行代码，且系统未打补丁。

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞涉及macOS系统框架RemoteViewServices中的PBOXDuplicateRequest函数实现缺陷。从提供的Objective-C代码分析，该POC试图通过dlopen动态加载位于/System/Library/PrivateFrameworks/目录下的私有框架RemoteViewServices，并调用未公开的API。在受限的沙箱环境（如CVE_2025_31258.entitlements所示，仅具有read-only权限且开启了app-sandbox）中，正常情况下应用不应具备越权修改或跨域访问敏感文件的能力。该POC通过构造特定的NSURL参数并传递给PBOXDuplicateRequest，利用该私有服务在处理跨进程文件操作时的验证疏漏，实现对沙箱外文件系统的非法访问或文件副本创建。代码片段中包含了writeFileAtPath等辅助函数，表明其验证逻辑在于测试是否能在沙箱限制下成功执行文件写入或通过私有服务绕过原有的内核沙箱策略。虽然代码被截断，但其结构清晰，展示了典型的逻辑漏洞利用链路。利用步骤：1. 攻击者首先需要获取一个在macOS沙箱环境内运行的代码执行权限（如通过浏览器漏洞或恶意APP）。2. 编写并运行此POC，通过dlopen和dlsym定位并加载RemoteViewServices框架中的PBOXDuplicateRequest符号。3. 构造两个NSURL对象，一个指向沙箱内可读文件，另一个指向沙箱外目标路径。4. 调用该函数，利用底层XPC通信中的特权提升点，使高权限的服务代为执行文件操作。5. 验证目标路径是否产生了预期的文件变更，从而确认沙箱逃逸成功。投毒风险分析：该POC项目目前表现为相对纯净的防御性研究代码，其主要依赖于macOS原生的Cocoa、Foundation以及标准系统库（dlfcn.h, sandbox.h, xpc/xpc.h），未发现引入外部混淆脚本、加密后门或非必要的网络外传行为。代码库结构遵循标准的Xcode工程格式，包含App代理（AppDelegate）和视图控制器（ViewController），属于典型的复现验证模版。虽然涉及到敏感的沙箱逃逸技术，但其代码逻辑透明，开发者seo的命名符合常见安全研究人员的命名习惯。投毒风险主要在于此类1day漏洞POC极易被恶意攻击者重新打包。由于其直接操作底层XPC及私有框架，若被二次修改并植入反弹Shell代码，普通用户很难通过简单的静态审计发现异常。目前的POC版本仅具实验性质，未发现针对研究者环境的攻击逻辑，风险评级较低，但使用者在编译运行此类涉及dlopen私有路径的代码时，仍应在严格隔离的虚拟机环境中进行，以防潜在的利用链溢出影响物理宿主机。

**项目地址:** [https://github.com/seo/CVE-2025-31258-PoC](https://www.google.com/search?q=https://github.com/seo/CVE-2025-31258-PoC) (推测路径)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-31258](https://nvd.nist.gov/vuln/detail/CVE-2025-31258)
