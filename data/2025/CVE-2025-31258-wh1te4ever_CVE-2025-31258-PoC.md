## CVE-2025-31258-macOS-SandboxEscape

**漏洞编号:** CVE-2025-31258

**漏洞类型:** 沙箱逃逸

**影响应用:** macOS

**危害等级:** 高危，可能允许恶意应用程序执行任意代码并访问受保护的资源

**影响版本:** < 15.5

**利用条件:** 需要用户授予Documents文件夹的读取权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许应用程序突破其沙箱，利用了RemoteViewServices框架中的`PBOXDuplicateRequest`函数。POC代码首先请求用户授权访问Documents文件夹，然后调用该函数尝试在沙箱外部创建文件。尽管漏洞库信息表明该问题已在macOS Sequoia 15.5中修复，但POC代码似乎是尝试利用早期的漏洞。关于投毒风险，初步分析代码未发现明显的恶意代码，例如反向shell或未授权的权限提升。但由于使用了`dlopen`和`dlsym`动态加载函数，可能存在被替换为恶意库的风险。此外，写入 "Escaped Sandbox!" 字符串到沙箱外的行为本身是一种PoC行为，如果被恶意利用可能写入恶意代码。风险评估：有效性中等，取决于macOS版本和补丁状态。投毒风险较低，约10%，主要集中在动态库加载和文件写入部分。

**项目地址:** [wh1te4ever/CVE-2025-31258-PoC](https://github.com/wh1te4ever/CVE-2025-31258-PoC)

**漏洞详情:** [CVE-2025-31258](https://nvd.nist.gov/vuln/detail/CVE-2025-31258)