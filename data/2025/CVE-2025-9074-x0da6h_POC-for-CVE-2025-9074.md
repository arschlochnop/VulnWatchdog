## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问 (Container Escape/Privilege Escalation)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问 (Container Escape/Privilege Escalation)

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS prior to 4.44.3

**利用条件:** 本地运行的Linux容器可访问、默认配置存在问题、无需依赖挂载Docker socket、无需认证

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-9074 Docker Desktop容器越权访问/逃逸漏洞分析
该漏洞（CVE-2025-9074）存在于Docker Desktop for Windows和macOS版本中，被评为高危漏洞，CVSS评分达9.3分。其核心问题在于，默认配置下，本地运行的Linux容器能够直接访问宿主机上的Docker Engine HTTP API（通常在`192.168.65.7:2375`），从而绕过容器隔离机制。这一问题无需依赖传统的Docker socket挂载，也不受Docker Desktop中“Expose daemon on tcp://localhost:2375 without TLS”选项的影响，使得利用条件更为宽松。攻击者仅需在已受控的容器内部，即可通过该漏洞实现对宿主机的任意文件读写，进而导致宿主机任意代码执行（RCE）和完全控制。受影响的版本包括Docker Desktop for Windows和macOS 4.44.3之前的版本，Docker已在4.44.3版本中修复此漏洞。

POC代码有效性分析
提供的POC脚本`POC-for-CVE-2025-9074.sh`是高度有效且功能完整的。它是一个shell脚本，利用`curl`工具直接与暴露在`http://192.168.65.7:2375`的Docker Engine API进行交互。脚本首先通过`/_ping`和`/version`端点验证API的可达性及Docker Engine信息。其核心利用机制在于，攻击者可以在受控容器内调用Docker API创建一个新的容器，并在创建时利用`HostConfig.Binds`参数，将宿主机的任意目录（例如`C:\Windows\System32`）以绑定挂载（bind mount）的方式映射到新创建的容器内部（例如映射到`/host_root`）。脚本中的`convert_path`函数负责将Windows路径正确转换为适用于Docker守护进程的Linux路径格式。一旦宿主机目录被成功挂载，攻击者即可在新容器内部通过执行`sh -c`命令，如`cat /host_root/filename.txt`或`printf '%s' 'content' > /host_root/filename.txt`，实现对宿主机上任何文件（位于挂载目录内）的任意读写。该POC提供了`-read`和`-write`两种模式，分别用于从宿主机读取文件内容或向宿主机写入指定内容。整个过程自动化且稳健，清晰地演示了如何突破容器隔离，达到宿主机文件系统访问的目的，从而为进一步的宿主机控制奠定基础。

利用步骤
1.  **环境准备**: 确保目标系统运行着易受攻击版本的Docker Desktop (Windows或macOS)，且攻击者已获取到某个在该Docker Desktop环境下运行的Linux容器的访问权限（例如通过其他漏洞）。
2.  **获取POC**: 攻击者将`POC-for-CVE-2025-9074.sh`脚本下载到其控制的Linux容器内部。
3.  **文件读取**: 要从宿主机读取指定文件，例如，读取Windows宿主机的`C:\Windows\System32\drivers\etc\hosts`文件内容，攻击者在容器内执行以下命令：
    `bash POC-for-CVE-2025-9074.sh -read "C:/Windows/System32/drivers/etc/hosts"`
    脚本会创建临时容器，挂载相应目录，读取文件内容并通过日志输出。
4.  **文件写入**: 要向宿主机写入任意内容到指定文件，例如，在Windows宿主机的`C:\temp`目录下创建一个名为`evil.txt`并写入恶意内容，攻击者执行：
    `bash POC-for-2025-9074.sh -write "I am root on your host!" "C:/temp/evil.txt"`
    脚本会创建临时容器，挂载目录，执行写入操作并报告成功。
5.  **实现RCE和持久化**: 通过文件写入能力，攻击者可以进一步将恶意payload写入宿主机的关键位置以实现任意代码执行和持久化控制。例如，在Windows上可以写入启动项、计划任务配置文件、SSH公钥、修改关键服务配置文件；在macOS上可以修改`launchd` plist文件、`crontab`条目、SSH公钥等。这将使攻击者获得对宿主机的完全控制。

投毒风险分析
对提供的`POC-for-CVE-2025-9074.sh`脚本进行的详细分析显示，其投毒风险为**0% (低风险)**。该脚本是一个纯粹的Bash shell脚本，通过标准的`curl`命令与Docker Engine API进行交互，旨在演示CVE-2025-9074漏洞的利用方式。代码结构清晰，易于阅读和理解，不包含任何形式的代码混淆、加密或二进制组件。脚本中使用的所有外部命令和工具都是标准的系统命令（如`curl`, `sed`, `printf`, `cat`, `basename`, `dirname`, `sh`），并且这些命令的使用方式均直接服务于漏洞的概念验证目的，即通过Docker API创建绑定挂载宿主机目录的容器，并执行文件读写操作。该POC没有任何迹象表明存在以下恶意行为：
*   未经授权收集并外传系统敏感信息或用户凭据。
*   建立与外部控制服务器（C2）的通信通道或反向shell。
*   在宿主机上植入持久性后门（超出漏洞本身提供的文件写入能力，POC本身不含额外恶意行为）。
*   下载、编译或执行任何外部的恶意二进制文件。
*   利用系统资源进行加密货币挖矿或其他滥用行为。
因此，该POC被认定为合法且安全的漏洞研究工具，其目的是帮助安全研究人员、开发者和组织理解、验证并防御此漏洞。用户在下载和使用前，建议从官方或可信来源获取，并进行必要的代码审计。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://cve.mitre.org/cgi-bin/cvename.cgi?name=2025-9074
