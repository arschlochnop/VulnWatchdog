## CVE-2025-9074 - Docker Engine 未授权访问 / 任意文件读写 / 潜在远程代码执行

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问 / 任意文件读写 / 潜在远程代码执行

**影响应用:** Docker Engine

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 所有Docker Engine版本，当其HTTP API配置为暴露且未认证时

**利用条件:** 需要网络访问暴露且未认证的Docker HTTP API

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：
该POC脚本`POC-for-CVE-2025-9074.sh`是高度有效的，能够演示在运行Docker守护进程并暴露未认证HTTP API的主机系统上进行任意文件读写的能力。该脚本巧妙地利用了Docker的`bind`挂载功能，将用户指定的主机目录映射到一个临时容器中。这使得攻击者可以在隔离的容器内部，通过执行shell命令（读取使用`cat`，写入使用`printf`）直接对主机系统上的文件进行操作。脚本包含了强大的路径转换逻辑，将Windows风格的路径（例如`C:/path/to/file.txt`）转换为其Linux等效的主机挂载路径（例如`/mnt/host/c/path/to/file.txt`），这对于Docker常见的多平台利用场景至关重要。它还通过`/_ping`端点执行初始连接检查并提取Docker版本信息，表明这是一个精心设计的利用程序。临时容器的整个生命周期——从创建、启动到执行恶意命令以及随后的移除——都由脚本自主管理，确保了高效简洁的利用过程。脚本清晰的结构、错误处理以及与Docker API的直接交互证实了其作为一个功能齐全的利用程序的有效性。它成功验证了攻击者获取主机任意文件访问权限的可能性，这可以通过操纵关键系统文件（如`/etc/passwd`、`/etc/shadow`、cron任务或SSH授权密钥）进一步升级为远程代码执行（RCE）。这使得该POC成为评估和理解此类错误配置严重性的关键工具。

利用步骤：
1.  **前提条件**: 攻击目标系统必须已部署Docker Engine，并且其Docker HTTP API服务（通常监听在TCP端口2375或2376）必须在网络上对外暴露，且未配置任何形式的认证机制。这种配置通常被视为严重的安全错误。
2.  **获取POC**: 攻击者需要获取`POC-for-CVE-2025-9074.sh`脚本。
3.  **指定目标**: 攻击者可以通过设置环境变量`CVE_HOST`和`CVE_PORT`，或直接修改脚本中的默认值，来指定目标Docker API的IP地址和端口。例如，`export CVE_HOST=target_ip && export CVE_PORT=2375`。
4.  **执行文件读取操作**: 若要读取目标主机上的任意文件，攻击者可以执行以下命令：`./POC-for-CVE-2025-9074.sh -read "/etc/passwd"` (适用于Linux/类Unix系统) 或 `./POC-for-CVE-2025-9074.sh -read "C:/Windows/System32/drivers/etc/hosts"` (适用于Windows系统)。脚本执行后，将会在控制台输出指定文件的内容。
5.  **执行文件写入操作**: 若要向目标主机上的任意文件写入内容，攻击者可以执行以下命令：`./POC-for-CVE-2025-9074.sh -write "malicious_user:x:0:0:root:/root:/bin/bash" "/etc/passwd"` (写入恶意用户) 或 `./POC-for-CVE-2025-9074.sh -write "echo 'hello from attacker' > /tmp/attack.txt" "/etc/cron.d/malicious_cron"` (写入定时任务)。脚本成功执行后，将确认写入操作已完成。
6.  **后续影响**: 通过写入关键系统文件，攻击者可以实现权限提升、持久化控制或进一步的远程代码执行。

投毒风险分析：
该POC脚本`POC-for-CVE-2025-9074.sh`的投毒风险评估为极低，约为5%。此评估基于对其源代码的全面审查。脚本代码结构清晰，易于阅读和理解，不包含任何形式的代码混淆或加密。它完全依赖于标准的shell命令（如`set -e`, `echo`, `printf`, `cat`, `basename`, `dirname`, `tr`）以及`curl`工具来与目标Docker API进行交互。脚本中没有任何迹象表明它会尝试下载外部可执行文件、加载远程脚本、连接到未声明的第三方服务、或者执行任何超出其明确功能范围（即利用暴露的Docker API进行文件读写）的行为。所有网络请求都明确指向用户指定的`CVE_HOST`和`CVE_PORT`。脚本的设计目标是作为一种防御性安全工具，帮助安全研究人员和管理员验证其Docker环境是否存在相关误配置及其可利用性。因此，运行此POC脚本对于执行它的系统而言是安全的，不会引入恶意负载或导致意外的系统损害。用户可以在可控的测试环境中自信地使用此POC来评估风险，而无需担心自身安全受到威胁。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
