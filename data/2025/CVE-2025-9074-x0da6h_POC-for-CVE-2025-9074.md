## CVE-2025-9074 - Docker Desktop (Windows/macOS) 未授权访问 / 权限提升 / 容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问 / 权限提升 / 容器逃逸

**影响应用:** Docker Desktop (Windows/macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 修复版本之前的 Windows (WSL2 后端) 和 macOS 版本

**利用条件:** 攻击者需在 Docker 环境内运行一个本地 Linux 容器，且 Docker Desktop 配置允许通过默认子网访问宿主机的 Docker API 接口 (192.168.65.7:2375)。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该 POC 代码是一个基于 Shell 脚本的完整利用工具，具有极高的实战参考价值。其核心原理是利用 Docker Desktop 默认配置中未对 192.168.65.7:2375 接口进行严格访问控制的缺陷。POC 通过简单的 curl 命令直接与 Docker Engine API 交互。有效性体现在其逻辑严密：首先通过 /_ping 接口验证 API 可达性，随后利用 /version 获取宿主机信息。利用的关键在于其构造的容器创建 JSON Payload，它不仅指定了运行命令，最核心的操作是通过 HostConfig 字段中的 Binds 选项，将宿主机的根路径或特定敏感目录映射到新容器的 /host_root 中。由于 API 无需认证，攻击者可以创建一个具有高权限挂载的‘逃逸’容器，从而实现对宿主机文件系统的任意读写。脚本还包含了路径转换函数 convert_path，专门处理 Windows 路径到 WSL/Docker 挂载路径的映射，这证明了该 POC 针对 Docker Desktop 场景进行了深度定制。利用步骤如下：1. 确认目标 API 地址（通常为默认网关地址）；2. 构造 API 请求以创建新容器，并在 HostConfig 中配置目录挂载；3. 启动该容器执行恶意指令（如 cat 或 printf）；4. 通过容器日志 API 获取执行结果，随后清理痕迹。该漏洞及其 POC 的出现，打破了 Docker Desktop 的安全隔离边界，使得普通的 Linux 容器能够直接操控其所在的宿主机宿主环境，属于典型的越权逃逸漏洞。 【投毒风险分析】经过对 POC 脚本代码的逐行静态分析，该代码具有较低的投毒风险（约 10%）。代码逻辑清晰、透明，使用了标准的 Linux 系统工具如 curl、sed、tr 和 printf，未引入任何外部二进制文件、第三方库或经过混淆的 Shell 脚本。所有的网络通信均指向变量 $BASE_URL，即局域网内部的 Docker 接口，没有发现将敏感数据（如宿主机文件内容、环境变量、SSH 密钥等）回传至远程 C2 服务器的行为。脚本中的 convert_path 和 api 函数定义规范，易于阅读和审查。唯一需要警惕的是脚本中使用了 set -e 和 curl 配合，虽然这是常见的编程习惯，但在防御性研究中仍需注意此类工具在复杂环境下的自动执行特性。此外，该 POC 虽然是一个强大的攻击工具，但其行为完全符合安全研究人员进行漏洞复现的需求，不包含恶意后门、逻辑炸弹或针对分析人员电脑的破坏性指令。在受控环境中运行此 POC 相对安全，但由于其涉及文件系统的任意写操作（-write 功能），操作不当可能导致目标系统不稳定。整体而言，该 POC 代码是干净、可信且具有高度教育意义的防御研究素材，不存在恶意投毒特征。

**项目地址:** 本地文件路径: /tmp/vulnwatchdog_e932222f1a09df6b9715353bac425469/POC-for-CVE-2025-9074.sh

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
