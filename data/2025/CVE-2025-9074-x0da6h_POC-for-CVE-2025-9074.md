## CVE-2025-9074 - Docker, Docker Desktop 容器逃逸, 远程命令执行, 任意文件读写, 未授权访问Docker API

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸, 远程命令执行, 任意文件读写, 未授权访问Docker API

**影响应用:** Docker, Docker Desktop

**危害等级:** Critical

**CVSS评分:** 9.3

**影响版本:** Docker Desktop versions prior to 4.44.3

**利用条件:** 未授权访问Docker API

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-9074是一个针对Docker远程API的严重安全漏洞，其核心在于未授权访问的Docker API允许攻击者创建特权容器，从而导致容器逃逸，进而实现宿主机上的任意命令执行和文件读写。该漏洞在CVSS评分中被评为9.3分（满分10.0），表明其具有极高的危害性。受影响的版本包括Docker Desktop 4.44.3之前的Windows和macOS版本。攻击者如果能够通过网络访问到未受保护的Docker远程API端口（默认为2375），即可利用此漏洞。

**POC有效性分析:**
提供的POC是一个名为`POC-for-CVE-2025-9074.sh`的Bash脚本。该脚本设计精良，功能完备，能够自动化利用CVE-2025-9074漏洞，实现对宿主机文件的任意读写。脚本首先检查Docker API的连通性（`/_ping` 和 `/version`），确认目标服务可用。其核心利用机制是创建一个Docker容器，并通过`HostConfig.Binds`参数将宿主机的特定目录挂载到容器内部。具体来说，脚本将Windows路径转换为Linux风格路径（例如`C:/path/to/file.txt` -> `/mnt/host/c/path/to/file.txt`），然后利用Docker的bind mount功能将宿主机的相应目录映射到容器内部的`/host_root`。这样，容器内部就可以访问到宿主机的这个目录。在容器内部，脚本通过`Cmd`参数执行`sh -c "$CMD"`，其中`$CMD`可以是`printf '%s' '$CONTENT' > '$MOUNT_PATH/$FILE_BASENAME'`（用于写入文件）或`cat '$MOUNT_PATH/$FILE_BASENAME'`（用于读取文件）。通过这种方式，攻击者可以在挂载的宿主机目录中进行文件操作，从而达到容器逃逸并执行任意命令或读写文件的目的。脚本在成功利用后，会清理痕迹，自动停止并删除创建的容器。整个流程清晰，自动化程度高，验证了漏洞的真实性和可利用性。

**利用步骤:**
1.  **环境准备**: 确保目标系统Docker的远程API端口（默认为2375）处于开放且未授权访问状态。对于Docker Desktop，这通常需要在设置中明确配置。此漏洞通常影响到配置不当、远程API直接暴露在网络中的Docker实例。
2.  **获取POC**: 获取`POC-for-CVE-2025-9074.sh`脚本到本地执行环境。
3.  **指定目标**: 设置环境变量`CVE_HOST`和`CVE_PORT`，或者直接在脚本中修改。例如：`export CVE_HOST=192.168.65.7; export CVE_PORT=2375`。`CVE_IMAGE`也可以指定为任意可用的Docker镜像，如`alpine`。
4.  **读取宿主机文件**: 执行脚本读取宿主机上的任意文件。示例：`bash POC-for-CVE-2025-9074.sh -read "C:/Windows/System32/drivers/etc/hosts"` (对于Windows宿主机) 或 `bash POC-for-CVE-2025-9074.sh -read "/etc/passwd"` (对于Linux宿主机，如果Docker Engine API暴露)。
5.  **写入宿主机文件**: 执行脚本向宿主机上的任意文件写入内容。示例：`bash POC-for-CVE-2025-9074.sh -write "Hello, Docker!" "C:/temp/test_cve.txt"`。
6.  **结果验证**: 对于读取操作，脚本将直接输出文件内容；对于写入操作，脚本会提示成功，用户可在宿主机上验证文件是否被修改或创建，内容是否符合预期。

**投毒风险分析:**
经详细分析，该POC脚本的投毒风险为**低 (0%)**。脚本代码结构清晰，使用了标准的Bash命令和`curl`工具与Docker API进行交互，没有发现任何混淆、加密或难以理解的片段。它仅依赖于常见的系统工具，如`curl`, `sed`, `cut`, `printf`, `cat`, `basename`, `dirname`，这些都是Linux/Unix系统中广泛使用的标准工具，不涉及外部非官方库或可疑二进制文件。除了直接与用户指定的Docker API端点进行通信外，脚本没有发起任何其他网络连接，例如连接到攻击者的C2服务器或下载恶意 payloads。所有`curl`请求都明确指向`$BASE_URL`。脚本进行的唯一文件操作是通过Docker容器的bind mount功能在宿主机上读取或写入文件，这是漏洞利用的直接结果，且操作路径由用户明确指定。脚本本身不会创建或修改除用户指定文件之外的任何其他文件。脚本中用于执行命令的`CMD`变量内容直接来源于用户的输入 (`$CONTENT` for write, `cat` for read) 或预定义的安全命令结构。它没有包含任何预设的恶意负载。综上所述，该POC是一个纯粹用于验证和研究漏洞的工具，其行为透明、可控，不包含任何恶意或可疑代码，因此不构成投毒风险。使用者可以安全地进行分析和复现。

**项目地址:** https://github.com/Shaoshi17/CVE-2025-9074-Docker-Exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
