## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape)

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 受影响版本为 4.44.3 之前的版本

**利用条件:** 需要对Docker Remote API端口（默认为2375）具有网络访问权限。如果Docker API未经验证暴露，则无需认证即可利用。也可通过运行恶意容器实现容器内部的权限提升和逃逸。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该漏洞（CVE-2025-9074）是一个针对Docker Desktop的严重容器逃逸漏洞，CVSS评分为9.3。它允许攻击者在受影响的Docker Desktop版本（低于4.44.3）上，通过特定的Docker API请求实现对宿主机的任意文件读写。此漏洞的关键在于当Docker Remote API可被访问时，攻击者可以构造恶意容器配置，利用`HostConfig.Binds`特性将宿主机的任意路径挂载到容器内部，并在容器中执行命令以操作这些宿主机文件，从而实现容器逃逸。

**POC有效性分析**：
所提供的POC脚本（`POC-for-CVE-2025-9074.sh`）是一个功能完备且高度有效的Bash脚本，用于演示该容器逃逸漏洞。该脚本首先检查目标Docker Remote API的连通性并获取版本信息。随后，它根据用户选择的操作（`-read`或`-write`）动态构建一个Docker容器创建请求。其核心机制是将攻击者指定的Windows宿主机路径（例如`C:/Windows/system32/drivers/etc/hosts`）通过`convert_path`函数转换为Linux格式的宿主机挂载路径（例如`/mnt/host/c/Windows/system32/drivers/etc/hosts`），然后将其绑定挂载到容器内部的指定路径。在容器启动后，脚本会在容器内执行`cat`命令（用于读取文件）或`printf`命令（用于写入文件），直接操作宿主机上的文件。整个流程清晰、自动化，能够成功实现宿主机的任意文件读写，证明了漏洞的严重性和可利用性。脚本在操作完成后会清理创建的容器，确保操作的原子性。

**利用步骤**：
1.  **环境准备**：确认目标系统运行的是存在漏洞的Docker Desktop版本（早于4.44.3）。同时，Docker Remote API端口（默认为2375）必须可从攻击者当前网络访问，且通常未经认证。
2.  **执行POC**：
    *   **读取宿主机文件**：攻击者执行命令`bash POC-for-CVE-2025-9074.sh -read "C:/Windows/system32/config/SAM"`（以读取Windows SAM文件为例）。脚本将创建一个临时容器，挂载宿主机C盘的根目录，并在容器内读取并输出SAM文件内容。
    *   **写入宿主机文件**：攻击者执行命令`bash POC-for-2025-9074.sh -write "new_content" "C:/Program Files/Docker/Desktop/resources/bin/docker.exe"`（以篡改Docker二进制文件为例，需注意文件权限）。脚本将创建一个临时容器，挂载相关目录，并在容器内将`new_content`写入到指定的Docker可执行文件。
3.  **结果**：通过任意文件读写，攻击者能够窃取系统敏感信息、修改关键配置文件、甚至植入恶意可执行文件，从而在宿主机上获得任意代码执行能力，实现完整的系统控制。

**投毒风险分析**：
本POC代码的投毒风险评估为**低（10%）**。此评估基于对脚本内容的详细审查：
1.  **代码透明性与可读性**：该POC完全由Bash脚本编写，代码逻辑清晰，易于理解。所有操作均以明文形式存在，不含任何形式的代码混淆或加密。研究人员可以轻松审计其功能和行为。
2.  **无外部可疑依赖**：脚本不从任何外部URL下载或执行未知二进制文件、脚本或Payload。它仅利用本地系统已有的标准工具（如`curl`, `sed`, `printf`, `cat`等）来与Docker API进行交互和处理数据。
3.  **合法API调用与命令执行**：脚本中的所有`curl`请求都指向标准的Docker Remote API端点（`/containers/create`, `/containers/$CID/start`, `/containers/$CID/logs`, `/containers/$CID/delete`等）。在容器内执行的命令（`cat`或`printf`）也是为了实现漏洞利用的合法功能，即文件读写，而非植入恶意程序。这些操作本身是验证漏洞所必需的。
4.  **目的明确**：脚本的设计目的明确，即演示并验证CVE-2025-9074容器逃逸漏洞，实现宿主机上的任意文件读写能力。它不包含任何与漏洞验证无关的恶意代码，例如后门安装、数据窃取、拒绝服务攻击或加密货币挖矿等行为。
5.  **无隐藏或异常行为**：在对脚本进行分析后，未发现任何尝试隐藏其真实意图、修改系统配置以实现持久化、或与未知C2服务器通信等可疑或异常行为。所有的文件路径操作都是为了演示漏洞的利用方式。
综上所述，该POC代码是纯粹用于安全研究和测试的工具，不构成投毒风险。

**项目地址:** https://github.com/Shaoshi17/CVE-2025-9074-Docker-Exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
