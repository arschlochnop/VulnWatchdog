## CVE-2025-9074 - Docker Desktop 容器越权访问/主机接管

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问/主机接管

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Versions prior to Docker Desktop 4.44.3

**利用条件:** 本地运行恶意容器，通过默认子网访问Docker Engine API

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074是Docker Desktop中的一个严重漏洞，影响Windows和macOS版本的Docker软件。该漏洞允许在本地运行的恶意Linux容器绕过隔离机制，通过默认子网（192.168.65.7:2375）直接访问Docker Engine API。由于Docker Engine API通常不应从容器内部直接访问，这种暴露允许攻击者滥用Docker API功能，例如通过创建带有主机文件系统bind mount的特权容器，从而实现对宿主机文件系统的任意读写，最终导致完整的宿主机接管（Host Takeover）。此漏洞的CVSS评分为9.3，属于高危漏洞，已在2025年8月20日发布的Docker Desktop 4.44.3版本中得到修复。攻击者无需依赖挂载Docker socket，也不受“Expose daemon on tcp://localhost:2375 without TLS”设置的影响，使得利用条件相对宽松。

**POC有效性分析：**
提供的PoC脚本`POC-for-CVE-2025-9074.sh`是一个功能完整且高度有效的Bash脚本，直接展示了CVE-2025-9074漏洞的利用方式。该脚本首先通过`curl`命令与Docker Engine API（位于`http://192.168.65.7:2375`）进行交互，执行`/_ping`和`/version`请求以确认API的可达性和Docker版本信息。其核心利用机制在于通过API创建一个新的容器，并在`HostConfig`中设置一个`Binds`参数，将宿主机上的任意指定目录挂载到新容器内部的`/host_root`路径。一旦宿主机目录被成功挂载，攻击者即可在容器内执行预定义的命令，例如使用`cat`命令读取挂载目录下的任意文件，或使用`printf`命令向挂载目录写入任意内容。脚本封装了文件路径的Windows到Linux格式转换，并提供了简洁的命令行接口`-read`和`-write`，使得漏洞利用过程直观便捷。成功读取或写入文件后，脚本会清理现场，自动停止并删除创建的恶意容器，保持了利用的隐蔽性和自动化。该PoC的有效性已通过GitHub上的相关项目得到验证，并且其代码逻辑清晰，易于理解和复现。

**利用步骤：**
利用CVE-2025-9074漏洞的步骤如下：
1. **前置条件：** 攻击者首先需要在受影响的Windows或macOS系统上运行一个恶意的Linux容器。这个容器可以是攻击者通过某种方式部署的，也可以是用户在不知情的情况下运行的包含恶意payload的容器镜像。
2. **API访问：** 一旦恶意容器启动，它将能够直接访问宿主机上Docker Desktop暴露的Docker Engine HTTP API，通常通过默认子网IP `192.168.65.7`和端口`2375`。
3. **构造恶意Payload：** 攻击者会构造一个JSON格式的Docker API请求，用于创建一个新的容器。这个请求的关键在于其`HostConfig.Binds`字段，该字段允许攻击者指定宿主机上的一个目录（例如`C:/Windows/System32`或`/Users/<username>/.ssh`）并将其挂载到新容器内部的某个路径（例如`/host_root`）。
4. **执行任意操作：** 在新创建的容器的`Cmd`字段中，攻击者可以指定要执行的命令。这些命令将针对已挂载的宿主机目录执行，从而实现对宿主机任意文件的读取、写入、修改或删除。例如，可以读取宿主机的敏感配置文件（如SSH私钥），或者向启动目录写入后门程序。
5. **清理：** 利用完成后，攻击者可以通过Docker API停止并删除创建的恶意容器，以清除利用痕迹。PoC脚本自动化了这些步骤，实现了从容器内对宿主机的完全控制。

**投毒风险分析：**
针对`POC-for-CVE-2025-9074.sh`脚本的投毒风险评估为低（约5%）。该脚本以纯Bash编写，代码结构清晰，逻辑直接，没有使用任何形式的代码混淆或加密。脚本仅依赖于标准Linux命令，如`curl`（用于与Docker API通信）、`sed`（用于文本处理，如提取CID和版本信息）、`printf`（用于写入文件内容）、`cat`（用于读取文件内容）、`basename`和`dirname`（用于路径处理）以及`cut`（用于截取CID）。这些都是操作系统环境中常见且透明的工具。
脚本的唯一外部交互目标是本地的Docker Engine HTTP API (`http://192.168.65.7:2375`)，它不会尝试连接到任何远程、未经授权的服务器以下载额外代码、数据或执行外部指令。脚本中没有发现任何恶意行为的迹象，例如植入后门、收集敏感信息并外传、或者进行加密挖矿等。所有操作都围绕着演示CVE-2025-9074漏洞的原理和利用方式。虽然此PoC本身是“干净”的，但任何攻击者都可能基于此PoC开发带有恶意功能的变种。因此，作为防御性安全研究员，我们始终建议在执行任何下载的PoC代码之前，务必进行彻底的代码审计，以确保其安全性。但就当前分析的这份PoC代码而言，其透明性和对标准工具的依赖性表明其投毒风险极低。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
