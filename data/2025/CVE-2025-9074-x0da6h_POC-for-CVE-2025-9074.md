## CVE-2025-9074 - Docker Desktop (Windows & macOS) 容器逃逸 / 权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 / 权限提升

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.34.2

**利用条件:** 本地运行的Linux容器，且Docker Desktop默认监听在特定子网IP（192.168.65.7）

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC脚本通过直接与Docker Desktop在宿主机侧暴露的Engine API接口进行交互，充分证明了漏洞的存在性。漏洞的核心在于Docker Desktop在Windows/macOS环境下，为了实现容器管理，在预设的子网地址（192.168.65.7）的2375端口上开放了未加密、未授权的Docker Engine API。在受影响版本中，由于隔离机制不完善，原本应受限的Linux容器能够直接访问该宿主机接口。POC脚本通过curl命令向该API发送POST请求，创建了一个挂载宿主机根目录（通过Docker Desktop特有的/mnt/host挂载路径转换）的新容器。由于该API默认具有最高权限，新创建的容器可以逃逸出原有的隔离环境，实现对宿主机文件系统的任意读写，从而达成容器逃逸和宿主机层面的提权。脚本包含了路径转换逻辑、容器创建、启动、日志获取及清理的全流程，具有极高的实战复现价值。【利用步骤】1. 在受影响的Docker Desktop环境中启动一个普通的Linux容器。2. 在容器内执行该POC脚本。3. 脚本首先探测192.168.65.7:2375的API可用性。4. 利用API创建一个携带Binds参数的容器，将宿主机的C盘或其他敏感目录挂载到新容器内部。5. 启动该特权容器并执行指定的系统命令（如cat敏感文件或printf写入后门）。6. 任务完成后自动清理生成的临时容器，不留痕迹。【投毒风险分析】该POC代码结构清晰，使用了标准的Shell语法和常见的工具如curl、sed、basename。分析其具体行为：其核心逻辑在于向固定的Docker子网IP发送符合API规范的JSON负载，不包含任何二进制加密载荷或远程下载恶意脚本的行为。虽然脚本具有对宿主机文件的读写能力，但这是其作为逃逸漏洞POC的功能属性，而非隐藏的投毒行为。脚本中没有发现诸如反弹Shell到非预期地址、窃取环境变量发送到外部服务器或混淆代码等恶意投毒特征。唯一的外部交互是针对本地Docker API。因此，该POC被判定为安全的防御研究工具。但在使用时仍需注意，若在非隔离生产环境中误运行，其写入功能可能导致宿主机系统受损，建议在严格的沙箱或实验环境中测试。

**项目地址:** [https://github.com/vulnwatchdog/POC-for-CVE-2025-9074](https://www.google.com/search?q=https://github.com/vulnwatchdog/POC-for-CVE-2025-9074)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
