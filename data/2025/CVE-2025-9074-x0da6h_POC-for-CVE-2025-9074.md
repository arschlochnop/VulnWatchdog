## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44 (固定版本为4.44，发布于2025年8月20日)

**利用条件:** 需要在本地运行恶意Linux容器，通过默认子网192.168.65.7:2375直接访问Docker Engine API，无需认证，不依赖挂载Docker socket。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

该POC脚本（`POC-for-CVE-2025-9074.sh`）是一个功能完整的Bash脚本，它成功演示了Docker Desktop容器逃逸漏洞。脚本利用`curl`工具向Docker Engine API的默认监听地址（通常是`192.168.65.7:2375`）发送HTTP请求。其核心利用机制在于通过`POST /containers/create`请求的`HostConfig.Binds`参数，将宿主机上的任意目录（由用户提供的Windows路径转换）挂载到新创建的容器内部。容器启动后，脚本可在其中执行`cat`或`printf`命令，实现对宿主机文件的任意读取或写入操作。此过程绕过了Docker Desktop的容器隔离机制，使恶意容器能够直接访问和控制宿主机文件系统，从而实现主机接管。POC逻辑清晰，自动化程度高，有效验证了漏洞的完整利用能力。

**利用步骤**:
1.  确保目标Docker Desktop版本低于4.44，并且能够部署恶意Linux容器。
2.  获取POC脚本`POC-for-CVE-2025-9074.sh`。
3.  要读取宿主机文件，执行 `./POC-for-CVE-2025-9074.sh -read "C:/path/to/file.txt"`。
4.  要写入宿主机文件，执行 `./POC-for-CVE-2025-9074.sh -write "<content>" "C:/path/to/file.txt"`。
脚本将自动创建、启动并清理用于利用的临时容器，完成对宿主机文件的操作。

**投毒风险分析**:
此POC的投毒风险评估为极低（10%）。脚本完全由透明的Bash代码构成，无任何混淆或隐藏行为。它仅使用标准系统工具，如`curl`、`sed`、`cat`、`printf`等。所有网络请求均明确指向本地Docker Engine API，未发现与任何外部或潜在恶意服务器通信的尝试。脚本内容不包含任何恶意负载、动态代码执行（如`eval`）或反沙箱机制。其功能仅限于利用漏洞演示容器逃逸，对执行POC的环境本身不构成任何威胁或附带恶意影响。因此，这是一个安全、合法的漏洞验证工具，可用于防御性安全研究。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
