## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34.2 之前的版本

**利用条件:** 攻击者需在受影响的 Docker Desktop 环境中运行一个恶意的 Linux 容器，或具备执行容器命令的权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞源于 Docker Desktop 的容器隔离机制缺陷。在受影响的版本中，Docker 引擎的 API 接口（默认监听在 192.168.65.7:2375）对内部容器网络是开放且缺乏身份验证的。提供的 POC 脚本通过 curl 工具向该固定 IP 和端口发送 REST API 请求，展示了极高的实战有效性。脚本首先通过 /_ping 和 /version 接口确认目标 Docker 引擎的可达性，随后利用 /containers/create 接口创建一个挂载了宿主机根目录（通过 /mnt/host 映射）的新容器。由于 Docker API 允许控制宿主机资源，攻击者可以利用 Binds 参数实现对宿主机文件系统的任意读写。POC 演示了通过新容器执行 cat 或 printf 命令来读取或篡改 Windows 宿主机文件。这种利用方式属于典型的‘通过 Docker API 实现容器逃逸’，攻击路径清晰且由于 IP 和端口在 Docker Desktop 环境中高度统一，脚本的通用性极强，能够稳定触发漏洞并获得宿主机层面的操作权限。 【利用步骤】1. 在 Docker Desktop 中启动一个基础 Linux 容器（如 alpine）。2. 在容器内通过网络工具检测宿主机网关 IP（通常为 192.168.65.7）的 2375 端口是否开放。3. 构造 JSON Payload，定义一个新容器，其 HostConfig 包含 Binds 参数，将宿主机磁盘路径（如 C:/）映射到容器内部路径。4. 调用 Docker API 的 /containers/create 接口提交 Payload。5. 调用 /containers/start 接口启动该容器。6. 此时，通过新容器执行的任何命令都将直接作用于宿主机的挂载文件，实现读写控制。 【投毒风险分析】该 POC 代码逻辑清晰，采用标准 Shell 脚本编写，未使用任何混淆手段。其核心功能依赖于系统自带的 curl、sed、cat 等工具，未引入外部二进制程序或加密的 Base64 载荷。代码中虽然包含了远程连接操作，但其目标地址均为 Docker 内部定义的私有网段（192.168.65.7），不涉及外部恶意服务器。脚本在操作完成后包含自动清理逻辑（api DELETE /containers/$CID），符合安全研究人员的编写习惯。风险评估认为，该代码不存在恶意后门或数据外泄逻辑，投毒风险极低（5%），主要风险点在于其强大的破坏性，若在未授权环境下运行，可能导致宿主机敏感数据泄露或系统文件损毁。建议防御者在受控隔离环境中使用该 POC 进行漏洞复现。

**项目地址:** [https://www.freebuf.com/articles/vuls/445648.html](https://www.freebuf.com/articles/vuls/445648.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
