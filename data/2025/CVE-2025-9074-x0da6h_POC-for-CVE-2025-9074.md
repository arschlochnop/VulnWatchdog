## CVE-2025-9074 - Docker Desktop 容器逃逸 (Container Escape), 任意文件读写 (Arbitrary File Read/Write)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸 (Container Escape), 任意文件读写 (Arbitrary File Read/Write)

**影响应用:** Docker Desktop

**危害等级:** 关键 (Critical)

**CVSS评分:** 9.3

**影响版本:** prior to version 4.44.3 (Windows and macOS)

**利用条件:** 需要直接或通过SSRF访问暴露的Docker Engine HTTP API (端口2375，例如http://192.168.65.7:2375); 无需认证。

**POC 可用性:** 9/10

**POC 类型:** 完整利用 (Full Exploit)

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074是影响Docker Desktop Windows和macOS版本（特指4.44.3之前的版本）的一个关键漏洞。此漏洞源于Docker Engine HTTP API的配置错误或意外暴露，该API通常位于内部网络接口上，例如`http://192.168.65.7:2375`。攻击者可以通过直接网络访问此内部IP，或通过利用其他漏洞（如服务端请求伪造, SSRF）进行链式攻击，在无需认证的情况下与Docker Engine API进行交互。这种访问可导致宿主系统的“容器逃逸 (Container Escape)”和“任意文件读写 (Arbitrary File Read/Write)”。通过创建带有宿主卷挂载的恶意容器，攻击者能够从宿主文件系统的任意位置进行读取或写入，从而获得对系统的重大控制权，并可能导致完全系统入侵。CVSS评分为9.3（关键），反映了其严重的潜在影响。

**POC有效性分析**：
所提供的`POC-for-CVE-2025-9074.sh`是一个功能齐全的Shell脚本，它通过利用暴露的Docker API来演示任意文件读写能力。该脚本支持从指定的Windows路径读取内容或向其写入用户提供的内容，并智能地将Windows路径转换为Linux兼容格式以进行容器挂载。脚本首先通过ping `/_ping`端点验证Docker API的可达性，然后检索版本信息。其核心机制是发送一个`POST /containers/create`请求，并附带一个精心构造的JSON Payload。此Payload定义了`Image`（例如`alpine`）、要执行的`Cmd`（读取时为`cat`，写入时为`printf`），以及最关键的`HostConfig.Binds`。`Binds`数组将宿主目录（从目标Windows路径派生）映射到临时容器内的指定挂载点（例如`/host_root`）。容器创建并启动后，对于读操作，脚本会获取容器日志（其中包含文件内容）；对于写操作，则确认操作成功。最后，脚本会清理并删除创建的容器。这个执行过程有效地利用了易受攻击的API，实现了对宿主文件系统的直接操作，从而验证了漏洞的可利用性。

**利用步骤**：
1.  **API可达性确认**：确定Docker Engine HTTP API（例如`http://192.168.65.7:2375`）是否可访问，无论是直接访问还是通过SSRF等方式。
2.  **文件读取示例**：要读取宿主文件`C:\Windows\System32\drivers\etc\hosts`，执行POC：
    `bash POC-for-CVE-2025-9074.sh -read "C:\Windows\System32\drivers\etc\hosts"`
    脚本将创建容器，挂载宿主目录，对目标文件执行`cat`命令，并输出其内容。
3.  **文件写入示例**：要将“Hello from attacker!”写入`C:\temp\malicious.txt`，执行POC：
    `bash POC-for-CVE-2025-9074.sh -write "Hello from attacker!" "C:\temp\malicious.txt"`
    类似地，脚本会创建容器，挂载目录，使用`printf`写入内容，并报告成功。
4.  **后渗透潜力**：成功利用后，攻击者获得任意文件访问权限，可用于权限提升、敏感数据访问或部署后门，从而可能导致宿主系统的完全沦陷。

**投毒风险分析**：
`POC-for-CVE-2025-9074.sh`脚本被评估为具有**低投毒风险**（估计为5%）。此评估基于其透明性、标准组件的使用以及专注于漏洞演示的特性。
1.  **代码透明度**：该脚本使用标准的、可读的Bash编写，没有混淆。所有步骤，包括参数解析、API交互和清理，都清晰可见，安全专业人员可以轻松审计。
2.  **标准工具的使用**：它完全依赖于常见的Unix工具（`curl`、`cat`、`printf`、`sed`等）。这些都是良性工具，在此处的使用直接支持POC与Docker API交互的既定功能。
3.  **极少外部依赖**：除了直接与目标Docker API交互外，该脚本不从不受信任的来源下载或执行外部代码。这显著降低了供应链攻击的风险。
4.  **受控的容器内命令执行**：在临时Docker容器内执行的命令（`sh -c "$CMD"`）是透明地从用户提供输入中派生出来的。`cat`和`printf`命令仅用于演示漏洞的文件读写功能，不会注入不相关的恶意Payload。
5.  **无意外网络活动**：所有`curl`请求都仅指向指定的Docker API端点（`$HOST:$PORT`）。没有可疑的对外连接，表明没有C2通信或未经授权的数据外泄。
6.  **短暂性操作**：该脚本创建临时容器用于演示，并包含显式的清理例程以将其删除（`DELETE "/containers/$CID?force=1"`）。这最大限度地减少了取证痕迹，并防止了留下持久性后门（写入功能有意修改文件除外）。
综上所述，鉴于其明确的代码、对良性工具的依赖、缺乏外部恶意依赖、集中的执行以及负责任的清理，`POC-for-CVE-2025-9074.sh`脚本的恶意“投毒”风险非常低。其明确目的是合法演示CVE-2025-9074。然而，始终建议在敏感环境中执行任何第三方POC代码之前，务必进行彻底审查，这仍是至关重要的安全实践。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
