## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated remote access, partial PUT feature enabled.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 30%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability affecting Apache Tomcat, stemming from improper handling of partial PUT requests. The vulnerability allows attackers to execute arbitrary code on the target system. 

The provided Python POC script, 'CVE-2025-24813.py', leverages the partial PUT functionality in Apache Tomcat to upload and execute malicious code. The script begins by checking if a given servlet is writable via PUT requests. It attempts to create a temporary file ('check.txt') on the server using a PUT request with a specified Content-Range header. If the server responds with a 200 or 201 status code, it indicates that the servlet is writable. Subsequently, the script proceeds to generate a payload using either Ysoserial or a custom Java code snippet. The Ysoserial payload is generated using a specified gadget and command, while the custom Java payload involves compiling and executing Java code directly on the server. The generated payload is then uploaded to the server via a PUT request, triggering the remote code execution. The script supports both Ysoserial payload generation and custom Java payload execution, providing flexibility in exploiting the vulnerability. Successful exploitation allows attackers to gain complete control over the affected server, potentially leading to data breaches, system compromise, and further malicious activities. The script includes options for specifying the target URL, host, port, Ysoserial path, gadget, and command to be executed, making it highly configurable for different environments.

The exploitability of this vulnerability is high due to the low attack complexity. An attacker only needs network access to the vulnerable Tomcat instance and the partial PUT feature enabled. The provided POC code effectively demonstrates the exploit, making it easier for attackers to weaponize the vulnerability.

Regarding the poisoning risk analysis, the provided Python script utilizes the `subprocess` module to execute external commands for payload generation (Ysoserial). This introduces a medium risk of code poisoning. While Ysoserial itself is a legitimate tool, using it to generate payloads from user-supplied commands can be dangerous. If an attacker manages to inject malicious commands into the `command` parameter, they could potentially execute arbitrary code on the system running the Python script. The script also uses the `requests` library, which is a standard library. However, the script disables SSL warnings, which could expose it to man-in-the-middle attacks if used over an insecure network. The custom Java payload also poses a poisoning risk, as it involves compiling and executing arbitrary Java code on the server. While the Java code is generated dynamically based on the command, it is still susceptible to code injection vulnerabilities if the command is not properly sanitized. Overall, the poisoning risk is estimated to be 30% due to the use of `subprocess`, custom Java payload, and disabled SSL warnings.

**项目地址:** https://github.com/user/repo/CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
