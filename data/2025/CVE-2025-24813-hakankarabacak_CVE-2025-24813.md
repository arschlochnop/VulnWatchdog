## CVE-2025-24813 - Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** RCE

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** N/A

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 and older EOL versions

**利用条件:** Unauthenticated remote access, partial PUT feature enabled

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个关键安全漏洞，允许未经身份验证的攻击者利用不当处理的 partial PUT 请求执行远程代码。POC分析：提供的Dockerfile文件用于构建一个易受攻击的Tomcat环境。它首先基于官方 Tomcat 9.0.90 镜像。然后，通过修改 `conf/web.xml` 文件，移除服务器的只读限制，允许通过 PUT 请求上传文件。同时，`conf/context.xml` 被修改，配置 Tomcat 将会话数据保存到磁盘，这对于漏洞利用至关重要。最后，ROOT.war 文件被复制到 Tomcat 的 `webapps/` 目录，实现应用程序的自动部署。README.md 文件详细描述了漏洞利用的工作流程：首先，上传一个 `check.txt` 文件来验证服务器是否接受 PUT 请求。如果服务器可写，则使用 `ysoserial` 生成一个 payload，该 payload 包含要执行的命令。然后，通过 PUT 请求将恶意的会话文件上传到目录，并将其链接到 Session ID 和 FileName。最后，发送一个带有自定义 `JSESSIONID` 的 GET 请求，触发反序列化，执行恶意代码。根据Rapid7的博客文章，该漏洞允许未经身份验证的远程代码执行。POC利用步骤：1. 搭建易受攻击的Tomcat环境；2. 执行PoC脚本，指定目标URL和要执行的命令；3. PoC脚本会检查服务器是否可写；4. 如果可写，脚本会使用 `ysoserial` 生成恶意payload；5. 脚本通过PUT请求上传payload；6. 脚本发送带有自定义 `JSESSIONID` 的 GET 请求，触发反序列化，执行命令。PoC有效性分析：PoC的有效性很高，因为它提供了一个完整的利用链，可以实现未经身份验证的远程代码执行。该PoC基于官方Tomcat镜像，并且提供了详细的利用步骤和说明，易于复现和理解。 投毒风险分析：该PoC的投毒风险较低。Dockerfile和README.md文件本身不包含任何恶意代码。PoC脚本使用了 `ysoserial` 来生成payload，这是一个已知的工具，用于生成Java反序列化payload。脚本中执行的命令由用户指定，因此用户可以控制payload的行为。但是，如果用户指定了恶意的命令，可能会对系统造成损害。 此外，PoC脚本需要用户手动下载和安装 `ysoserial`，这增加了一定的门槛，降低了被恶意利用的风险。该PoC只使用了标准库，没有调用外部脚本，代码清晰易懂，因此投毒风险较低，大约为15%。

**项目地址:** https://github.com/absholi7ly/POC-CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
