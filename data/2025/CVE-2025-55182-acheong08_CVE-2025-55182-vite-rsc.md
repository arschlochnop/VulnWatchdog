## CVE-2025-55182 - React Server Components (RSC) RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components (RSC)

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** Unauthenticated, requires network access via POST request with specific headers and form data

**POC 可用性:** 8/10

**POC 类型:** Concept Verification

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2025-55182 is a critical remote code execution vulnerability affecting React Server Components (RSC). The vulnerability stems from insecure deserialization within React's Flight protocol, specifically how chunk references are handled. The `getOutlinedModel` function iterates through reference paths without proper `hasOwnProperty` checks, enabling prototype chain traversal. This allows an attacker to manipulate the object's prototype chain and invoke arbitrary functions, leading to remote code execution.

The provided proof-of-concept (PoC) demonstrates the vulnerability by exploiting the `constructor` property of an object's prototype. By sending a crafted POST request with a specific `x-rsc-action` header and form data, the attacker can trigger the invocation of the `Function` constructor. This is achieved by setting the `then` property of the object to `$1:constructor:constructor`, which traverses the prototype chain to `{}.constructor.constructor` and ultimately points to the `Function` constructor. The `Function` constructor is then invoked via `.then()` when the object is `await`ed. The V8 engine passes `resolve` and `reject` functions as arguments to the constructor which causes a syntax error because the stringified representation of these functions contain native code (`function () { [native code] }`). This confirms the successful invocation of the `Function` constructor and demonstrates the potential for arbitrary code execution.

**Exploitation Steps:**

1.  Identify a React application using React Server Components (RSC) and is running a version between 19.0 and 19.2.0.
2.  Craft a POST request to any endpoint that handles RSC actions. Include the `x-rsc-action` header with a valid server action ID.
3.  Include form data with a structure that leverages the prototype chain traversal vulnerability. The following form data is sufficient: `'0={"then":"$1:constructor:constructor"}'` and `'1={"a":"b"}'`.
4.  Send the POST request to the target application.
5.  Observe the server's response. If the application is vulnerable, the server will return an "Internal Server Error" due to the syntax error caused by the invocation of the `Function` constructor. A patched system returns a normal response.

**投毒风险分析:**
While the provided PoC focuses on demonstrating the RCE vulnerability, there is a minor risk of code poisoning through the server actions mechanism. An attacker could potentially inject malicious code into a server action definition that is later executed by the server. For example, by crafting a malicious payload and submitting it to the server, an attacker could manipulate user data, inject malicious scripts, or even compromise the server's file system. However, this requires a deeper understanding of the server's architecture and may require social engineering to convince administrators to deploy the malicious server action.
Given the nature of the PoC and the complexity required to achieve code poisoning, the risk is relatively low. The PoC provided does not contain any explicit attempts at code poisoning. It primarily focuses on demonstrating the RCE vulnerability by exploiting the prototype chain traversal. However, the potential for code poisoning exists and should be considered when assessing the overall risk associated with this vulnerability. The lack of obfuscation, the reliance on standard JavaScript features, and the absence of external resources all contribute to a low poisoning risk score. However, the potential to modify server action definitions warrants a minimal risk assessment.

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
