## CVE-2025-55182 - React Server Components, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10

**影响版本:** React < 19.0.1, React < 19.1.2, React < 19.2.1

**利用条件:** Unauthenticated, requires network access to vulnerable React Server Function endpoint

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2025-55182 is a critical remote code execution (RCE) vulnerability affecting React Server Components (RSC) and Next.js. The vulnerability stems from unsafe deserialization of data within React Server Functions. An unauthenticated, remote attacker can exploit this vulnerability by sending a specially crafted payload to a vulnerable React Server Function endpoint. The core issue lies in how React's Server Functions protocol processes incoming Flight requests, specifically the deserialization of data. Attackers can leverage this to inject malicious code that gets executed on the server. The provided POC code, `detect.sh`, is a timing-based scanner that attempts to detect vulnerable servers. It first checks if the target is a Vite RSC server by sending a request with an invalid `x-rsc-action` header. If the server responds with a 500 error, it proceeds to test for the vulnerability using a `toString` payload. This payload is designed to cause a hang on vulnerable servers due to excessive processing during deserialization. The script measures the time it takes for the server to respond. If the request times out (default timeout is 3 seconds), the script flags the target as vulnerable. The `readme.md` file indicates that the vulnerability may not lead to true RCE in Vite or Next.js due to manifest validation, but it confirms RCE is possible when React is used with `server.node.unbundled` without validation. To exploit this vulnerability, an attacker would need to craft a malicious payload that leverages the unsafe deserialization. The payload would typically involve injecting code into the `then` property of a JavaScript object being sent to the server. The server, upon deserializing the object, would execute the injected code. The vulnerability can be mitigated by upgrading React to versions 19.0.1+, 19.1.2+, or 19.2.1+, which include patches for the unsafe deserialization issue. Additionally, using a Web Application Firewall (WAF) with rules designed to detect and block exploitation attempts, such as the Cloud Armor WAF rule created by Google Cloud, can provide an additional layer of protection. The投毒风险 is relatively low (10%). The provided POC code primarily uses standard `curl` commands and does not involve any code obfuscation or execution of external scripts. While the vulnerability itself can lead to remote code execution, the provided detection script is focused on identifying vulnerable servers rather than actively exploiting them or introducing malicious code. However, there's a slight risk if the script is modified or distributed without proper security considerations, as it could be used to target and exploit vulnerable systems. Additionally, a modified script could potentially include malicious payloads designed to deliver malware or perform other harmful actions. Mitigation strategies include carefully reviewing and validating any third-party scripts before execution, implementing strong input validation and sanitization techniques, and keeping systems up-to-date with the latest security patches.

**项目地址:** https://github.com/acheong08/bullshit-react-project

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
