## CVE-2025-55184 - React (Server Components/Flight Server), Dify 拒绝服务 (Denial of Service), 不安全反序列化 (Insecure Deserialization)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service), 不安全反序列化 (Insecure Deserialization)

**影响应用:** React (Server Components/Flight Server), Dify

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** React 19.x 早期版本, Dify v1.10.1 及之前版本

**利用条件:** 无需认证, 通过HTTP请求远程可利用

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低 (Low)

**投毒风险:** 0%

## 详情

CVE-2025-55184 是一个影响 React Server Components (RSC) 的预认证拒绝服务漏洞，其根源在于对HTTP请求中发送到服务器函数端点的payload进行不安全反序列化。此漏洞可能被利用来触发服务端应用程序的无限循环，从而耗尽系统资源，导致服务中断或拒绝响应。该漏洞影响React 19.x的早期版本，以及依赖于这些版本的应用程序，例如Dify v1.10.1及之前版本（因其使用了存在问题的`react-server-dom-webpack`组件）。CVSS评分为7.5，属于高危漏洞。

**POC有效性分析**:
本次分析提供了两个Python POC脚本，均旨在利用CVE-2025-55184。
*   **POC代码 1 (`1.py`)**：此脚本提供了一个初步的DoS尝试。它通过构造一个包含`rsc-action`和`Next-Action` HTTP头的POST请求，并将一个简单的反序列化payload (`"$@0"`)作为文件数据发送。这个payload在React Flight Server协议中是一个特殊指令，意图触发服务端解析逻辑。脚本设计通过发送此请求，然后捕获`requests.exceptions.RequestException`来间接判断服务端是否因处理不当的payload而崩溃或陷入无响应状态。如果请求在设置的超时时间内没有引发异常，则认为目标不受影响；否则，将提示“DoS attempt sent.”。虽然其验证机制相对粗略，但能够作为快速探测器来识别潜在的脆弱目标。
*   **POC代码 2 (`2.py`)**：这个脚本在技术上更为精巧，它通过精心构造一个“预初始化循环payload”来有效地利用该漏洞。该payload利用React Flight Server协议的多块（chunk）数据结构，构建了一个复杂的循环引用链条：A -> B -> C -> B。关键在于`{"setup":["$2","$3"],"id":"test","bound":"$@1"}`这个元数据块。`setup`数组中的`"$2"`和`"$3"`指令强制服务器在解析主引用（`"$@1"`指向的A）之前，就初始化了B和C。由于C强制引用B，而B又弱引用C，这种预初始化行为会导致服务端在解析过程中陷入无限递归，最终耗尽CPU和内存资源，导致服务拒绝。脚本通过设置一个短HTTP请求超时（5秒），并专门捕获`requests.exceptions.Timeout`异常来验证攻击是否成功。如果捕获到超时异常，则明确输出“✅ Request timed out! The server is likely hanging in an infinite loop.”，这提供了高度可靠的漏洞验证结果。
**总结**: 两个POC都有效地证明了CVE-2025-55184漏洞的存在及可利用性。POC 2通过更高级的payload构造和直接的超时检测机制，展示了更高的有效性和验证精度，是该漏洞利用的典范。

**利用步骤**:
1.  **目标识别与环境准备**: 攻击者首先需要确定目标应用程序是否使用了存在漏洞的React版本（例如React 19.x早期版本或其受影响的依赖组件，如`react-server-dom-webpack`）。Dify v1.10.1及之前版本已被明确标识为受影响的应用。确保攻击机器与目标应用之间的网络连通性，并记录目标应用的URL和端口。
2.  **选择POC脚本**: 根据验证需求，选择合适的POC脚本。对于初步探测或理解漏洞原理，可以使用`1.py`；对于精确验证和重现，`2.py`是更优选择。
3.  **配置POC脚本**: 编辑所选的Python POC脚本，将目标URL变量（`target`或`url`）修改为实际的目标应用程序地址（例如`http://example.com:3000`）。
4.  **执行攻击**: 运行配置好的Python脚本。脚本将通过发送特制的HTTP POST请求，利用不安全反序列化机制触发React Flight Server中的无限循环。
5.  **验证攻击效果**: 
    *   观察POC脚本的输出。如果`2.py`报告“Request timed out! The server is likely hanging in an infinite loop.”，则直接确认DoS成功。
    *   尝试通过浏览器或其他客户端访问目标应用程序的正常页面。如果服务变得无响应、连接超时、返回HTTP 500错误或完全崩溃，则表明拒绝服务攻击已经生效。
    *   在有权限的情况下，监控目标服务器的CPU、内存等资源利用率。成功的DoS攻击会导致这些资源在短时间内急剧飙升，最终耗尽。

**投毒风险分析**:
针对这两个Python POC脚本进行了全面的安全审查，以评估其潜在的投毒风险。分析结果表明，这些脚本的投毒风险极低，具体原因如下：
1.  **代码透明度与可读性**: 两个脚本的代码结构清晰、逻辑直观，且包含有益的注释，解释了payload的意图和作用。没有发现任何代码混淆或加密技术，这意味着任何安全研究人员或分析人员都可以轻松地审阅并理解其全部功能。
2.  **标准库依赖**: 脚本仅依赖于Python的标准库`requests`。这是一个广泛使用且受信任的HTTP客户端库，其安全性已得到社区的充分验证。脚本中未引入任何其他可疑的第三方库或二进制文件，从而避免了通过外部依赖引入恶意代码的风险。
3.  **无恶意副作用**: 脚本的核心功能完全围绕着构造并发送特定的HTTP POST请求，其目的明确且唯一：触发目标服务端的不安全反序列化漏洞，导致拒绝服务。在代码中，没有发现任何执行命令注入、远程代码执行（RCE）、数据窃取、凭证收集、后门植入、连接外部未知服务器（C2通信）、文件系统操作或任何其他超出DoS范畴的恶意行为。`eval()`函数或其他动态代码执行机制也未被使用。
4.  **本地化测试倾向**: POC脚本默认的目标URL设置为`http://localhost:3000`或`http://localhost:3001`。这一默认设置强烈表明脚本的作者意图是供研究人员在本地受控环境中进行测试和验证，而非用于大规模未经授权的网络攻击。虽然用户可以修改目标URL，但默认配置体现了谨慎的设计理念。
5.  **缺乏持久性机制**: 脚本执行后，其影响仅限于对目标服务的临时拒绝服务，不涉及任何持久化机制，如创建计划任务、修改启动项或在目标系统上留下可执行的恶意文件。一旦目标服务重启或问题得到修复，其功能将恢复正常。
**结论**: 综合来看，这些POC脚本是专注于验证CVE-2025-55184拒绝服务漏洞的合法安全研究工具。它们遵循了良好的安全编码实践，没有表现出任何恶意投毒的迹象。因此，它们的投毒风险评定为0%。然而，即使是合法POC，也应在受控环境和获得授权的前提下执行，以防止对生产系统造成意外的服务中断。

**项目地址:** 无法确定

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
