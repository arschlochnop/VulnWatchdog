## CVE-2025-55184 - React Server Components (RSC) 拒绝服务 (Denial of Service)

**漏洞编号:** CVE-2025-55184

**漏洞类型:** 拒绝服务 (Denial of Service)

**影响应用:** React Server Components (RSC)

**危害等级:** 高危 (High)

**CVSS评分:** 7.5

**影响版本:** 影响React Server Components，建议立即升级。

**利用条件:** 无需认证，需要网络访问。

**POC 可用性:** 9

**POC 类型:** 概念验证 (Proof of Concept)

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

### 漏洞描述
CVE-2025-55184 是一个影响 React Server Components (RSC) 的高危拒绝服务 (DoS) 漏洞，CVSS 评分为 7.5。此漏洞涉及身份验证前的攻击，攻击者可以通过恶意构造的HTTP请求发送至 React Server Function 端点，利用不安全的有效负载反序列化过程。具体而言，当服务器尝试反序列化恶意payload时，会触发一个无限循环，从而消耗大量的CPU资源，导致服务器进程挂起，并可能阻止对后续HTTP请求的响应，最终造成服务不可用。后续发现的 CVE-2025-67779 是对 CVE-2025-55184 的不完整修复，存在相同的影响，表明该漏洞的利用方式可能较为复杂或修复难度较大。由于此漏洞无需认证即可利用，且影响React Server Components的核心功能，其威胁等级较高，建议受影响的用户立即升级。

### POC有效性分析
提供的POC代码，特别是`2.py`，展示了如何利用此反序列化漏洞实现拒绝服务。该POC通过精心构造的multipart/form-data请求发送恶意payload。payload的核心在于利用React Flight Server的序列化协议，通过特殊标记（如`"$@2"`表示弱引用、`"$2"`表示强制初始化引用、`"$h4"`表示Server Reference）来创建复杂的循环引用结构。具体来说，它通过定义多个分块（Chunk 1、Chunk 2、Chunk 3）来构建一个“B -> C -> B”的循环依赖链，并在一个元数据分块（Chunk 4）的`"setup"`字段中强制初始化这些循环引用。当最终的`"bound"`字段引用了起点分块A（A又弱引用B）时，该循环在服务器端被触发。这种预初始化循环的机制成功绕过了React Flight Server中可能存在的简单循环检测逻辑，使得反序列化器陷入无限循环。POC通过设置一个短的请求超时时间（5秒）来验证DoS攻击的有效性。如果请求在超时时间内未能收到响应，则明确表示服务器进程已挂起，从而验证了拒绝服务攻击的成功。

### 利用步骤
1.  **识别目标**: 确定目标Web应用程序是否使用了React Server Components，并暴露了可接受HTTP POST请求的React Server Function端点。通常这些端点会处理带有特定头部（如`"rsc-action"`或`"Next-Action"`）的请求。
2.  **构造HTTP请求**: 构造一个HTTP POST请求，其Content-Type为`multipart/form-data`。
3.  **设置请求头**: 在请求头中添加`"rsc-action"`字段，其值可以是一个指向React Server Function的路径，例如`"file:///Users/seunghwajeong/space/react/fixtures/flight/src/actions.js#increment"`。
4.  **构建恶意Payload**: 将POC代码`2.py`中定义的`files`字典转换为multipart/form-data的各个部分。该payload包含多个编号的分块，通过`"$@"`和`"$"`符号来建立内部引用关系，从而形成一个预初始化的循环引用结构。
5.  **发送请求**: 使用HTTP客户端（如Python的`requests`库）向目标端点发送构造好的恶意请求。
6.  **验证DoS**: 观察服务器的响应。如果服务器变得无响应或请求在设定的短时间内超时（如POC中的5秒），则表明攻击成功，服务器已陷入无限循环并发生拒绝服务。

### 投毒风险分析
该POC代码的投毒风险极低（10%）。代码仅使用标准的Python `requests`库进行HTTP通信，这是一个广泛使用的安全库，本身不包含恶意功能。POC的核心逻辑在于构造一个特定的数据结构（恶意payload），并通过正常的HTTP POST请求发送至目标服务器，以触发服务器端反序列化漏洞。代码中没有发现任何试图下载或执行外部可疑脚本、利用`eval()`或`exec()`等危险函数、进行代码混淆、或进行未经授权的外部网络连接的行为。所有操作都清晰地围绕着漏洞利用的机制展开，旨在通过发送一个精心设计的数据包来验证漏洞的存在和影响。因此，该POC代码是纯粹用于漏洞研究和验证目的，不包含任何恶意投毒或后门植入的风险，可以安全地用于防御性安全测试和威胁评估。

**项目地址:** None

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55184
