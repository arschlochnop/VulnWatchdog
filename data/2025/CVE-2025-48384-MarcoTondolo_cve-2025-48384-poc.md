## CVE-2025-48384 - Git 任意文件写入

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意文件写入

**影响应用:** Git

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 受影响版本未知，请参考GitHub advisory获取更多信息。

**利用条件:** 需要克隆恶意Git仓库，并递归初始化子模块

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-48384是Git中的一个高危漏洞，允许攻击者通过创建恶意的Git仓库来执行任意文件写入。该漏洞主要存在于Git客户端处理子模块的方式中。当用户克隆一个包含恶意配置的仓库，并且使用`--recurse-submodules`选项初始化子模块时，攻击者可以利用`.gitmodules`文件中的特殊构造，在目标系统上写入任意文件。

**POC有效性分析：**
根据提供的POC代码，攻击者可以通过构造包含恶意`.gitmodules`文件的Git仓库来利用此漏洞。该文件指定了子模块的URL和路径，当用户使用`git clone --recurse-submodules`命令克隆仓库时，Git客户端会尝试初始化这些子模块。攻击者可以在子模块的路径中嵌入特殊字符，例如换行符，来欺骗Git客户端，使其将子模块的内容写入到非预期的位置。提供的POC代码使用一个名为`sub`的子模块，并将恶意代码放置在`.git/modules/sub/hooks/post-checkout`中，从而实现远程代码执行。通过修改子模块路径，攻击者可以在目标系统上写入任意文件，从而控制系统。

**利用步骤：**
1. 攻击者创建一个包含恶意`.gitmodules`文件的Git仓库。
2. 攻击者将该仓库托管在公共或私有Git服务器上。
3. 攻击者诱使用户克隆该仓库，并使用`--recurse-submodules`选项初始化子模块，例如：`git -c protocol.file.allow=always clone --recurse-submodules git@github.com:liamg/CVE-2025-48384.git`。
4. 当Git客户端尝试初始化子模块时，恶意代码会被写入到目标系统的`.git/modules/sub/hooks/post-checkout`文件中。
5. 当用户执行与子模块相关的Git操作时（例如切换分支），`post-checkout`钩子会被触发，从而执行攻击者写入的恶意代码。

**投毒风险分析：**
该漏洞的投毒风险较低，主要原因是该POC利用方式比较直接，没有明显的混淆或隐藏恶意代码的行为。虽然攻击者可以修改子模块的内容以执行恶意操作，但这种行为很容易被发现。此外，由于该漏洞依赖于用户显式地使用`--recurse-submodules`选项，因此攻击者需要诱使用户执行此操作，增加了攻击的难度。总体而言，该POC的投毒风险较低，大约在10%左右。恶意代码主要体现在`post-checkout`钩子的利用上，若将代码修改为下载执行外部脚本，则投毒风险会升高。攻击者可以尝试使用一些简单的编码方式来混淆`post-checkout`脚本中的代码，例如base64编码或简单的异或操作，但这并不会显著增加投毒风险。通过分析该POC的代码，可以发现其主要依赖于Git的内置功能和标准库，没有使用任何可疑的第三方库或API。因此，可以认为该POC的投毒风险较低。

**项目地址:** https://github.com/liamg/CVE-2025-48384

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-48384
