## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 8.4

**影响版本:** ≤ 7.12

**利用条件:** 用户下载并解压包含恶意构造的NTFS替代数据流（ADS）的RAR压缩包

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是WinRAR在处理NTFS替代数据流（Alternate Data Streams, ADS）时的路径遍历缺陷。根据提供的Python代码分析，POC通过调用系统底层API或利用特定库创建带有‘..\’序列的ADS流。正常情况下，WinRAR在解压时应限制文件写入路径在目标目录内，但此漏洞允许攻击者通过ADS名称中的遍历字符绕过该限制。POC代码展示了如何向一个看似正常的‘decoy.txt’添加名为‘..\..\..\Startup\malware.bat’的流。当受害者使用受影响版本的WinRAR解压该文件时，WinRAR会错误地解析ADS路径，导致payload被提取到系统启动项或其他任意目录。经分析，该POC结构完整，逻辑清晰，能够直接生成恶意的RAR文件，其实际危害极高，因为解压行为是用户对压缩软件的基本信任操作，极具欺骗性。利用步骤：1. 攻击者准备攻击载荷（如.bat或.exe文件）。2. 运行POC脚本，指定诱饵文件（decoy）和载荷（payload），脚本利用循环生成多级路径遍历序列的ADS。3. 脚本调用rar.exe将带有ADS流的文件打包。4. 诱导受害者下载并解压该RAR文件。5. WinRAR执行解压，载荷自动被放置于目标路径（如启动文件夹）。6. 受害者重启系统后，恶意代码自动运行。投毒风险分析：该POC代码本身主要使用了Python标准库（argparse, os, subprocess, sys），代码逻辑透明，未发现明显的恶意混淆、远程执行Shell、或者对研究员环境进行破坏的逻辑。风险主要集中在生成的输出物（恶意RAR）具有极强的隐蔽性。虽然脚本目前设置的默认路径是Windows启动项，这属于PoC的演示行为而非针对研究员的隐藏后门。然而，由于该漏洞属于零日或近期披露的漏洞，且搜索结果显示已有威胁组织（如NoName057）利用相似漏洞（CVE-2025-8088）进行恶意代码投递和长期渗透，攻击者可能分发修改后的‘一键检测工具’。这些修改版可能在生成POC的同时，静默感染研究员的系统。在本特定POC脚本中，投毒风险较低，但鉴于漏洞的利用价值，从外部非官方仓库下载此类POC时需严格审计其是否包含非法外联请求或自动执行脚本。

**项目地址:** 本地分析路径: /tmp/vulnwatchdog_76f10288e51ea46efd6f9ac86046f4b2/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
