## CVE-2025-8088 - WinRAR 路径遍历/Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/Path Traversal

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4

**影响版本:** WinRAR ≤7.12

**利用条件:** 需要用户解压恶意制作的RAR压缩包，利用Windows NTFS备用数据流特性进行路径穿越。攻击者需要诱导受害者打开恶意文件。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR压缩软件的严重安全漏洞，其核心是路径遍历（Path Traversal）。攻击者可以巧妙地利用Windows NTFS备用数据流（ADS）特性，结合路径遍历技术，绕过WinRAR的文件验证机制。当受影响版本的WinRAR（≤7.12）解压精心制作的RAR压缩包时，恶意文件会被释放到期望的解压目录之外的系统关键路径，例如Windows启动文件夹（%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup）。这使得攻击者能够在用户下次启动系统或登录时自动执行恶意代码，从而实现持久化和任意代码执行。

**POC有效性分析**
所提供的Python PoC脚本（`poc.py`）设计精良且功能完整。它能够成功地生成一个恶意RAR压缩文件，该文件利用了WinRAR的路径遍历漏洞和NTFS ADS特性。脚本接收用户指定的诱饵文件和有效载荷文件（如`.bat`或`.exe`），并将有效载荷的内容嵌入到诱饵文件的备用数据流中。在ADS的名称中，通过构造包含多个“`..\`”的路径遍历序列，PoC确保在WinRAR解压时，有效载荷能够被写入到目标系统上的任意指定路径（默认指向启动文件夹）。`README.md`文件提供了清晰的漏洞描述、技术细节、危害说明以及详细的使用指南和先决条件（例如，需要将`rar.exe`添加到系统PATH中）。根据分析，该PoC完全符合其所述功能，能够有效地构造并利用此漏洞。

**利用步骤**
1.  **准备环境**：确保目标系统安装了WinRAR ≤7.12版本，并且攻击者系统已安装Python环境。此外，需要将WinRAR的`rar.exe`命令行工具的路径添加到系统PATH中（PoC脚本会调用它来创建RAR档案）。
2.  **准备Payload**：创建一个包含恶意指令的批处理脚本（例如，`evil.bat`），例如：`echo Malware > %TEMP%\infected.txt`。
3.  **运行PoC脚本**：在命令行中执行PoC脚本，指定诱饵文件、有效载荷文件和输出的RAR档案名称。例如：`python poc.py --decoy resume.txt --payload evil.bat --out exploit.rar`。这将生成一个名为`exploit.rar`的恶意压缩文件。
4.  **社会工程学**：将生成的`exploit.rar`文件发送给受害者，并通过社会工程学手段诱骗受害者下载并解压此文件。
5.  **触发漏洞**：当受害者使用脆弱版本的WinRAR解压`exploit.rar`时，由于路径遍历和ADS的利用，`evil.bat`文件将被悄无声息地写入到系统启动文件夹（例如，`C:\Users\<UserName>\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.bat`）。
6.  **持久化执行**：受害者下次重启计算机或登录系统时，位于启动文件夹中的`malware.bat`脚本将自动执行，从而实现攻击者预期的恶意行为，例如植入后门、窃取信息或进行横向移动。

**投毒风险分析**
对所提供的PoC脚本（`poc.py`）进行分析后，评估其自身投毒风险为低（10%）。该脚本是用Python编写的，代码结构清晰，可读性强，没有发现明显的代码混淆、加密或反调试技术。脚本的主要功能是利用标准库（如`argparse`用于参数解析，`os`用于文件系统操作，`subprocess`用于执行外部命令如`rar.exe`）来构造一个恶意压缩文件。它明确地将用户提供的payload嵌入到ADS中，然后通过合法调用WinRAR命令行工具来创建最终的RAR文件。脚本中没有检测到任何尝试建立外部网络连接、下载外部脚本、执行`eval()`等可疑函数、进行数据窃取或在攻击者机器上植入后门的行为。`README.md`也明确指出该工具仅用于研究目的，并建议在隔离环境中进行测试，这表明作者秉持了负责任的披露原则。因此，可以认为该PoC脚本本身是安全可靠的，其风险在于被恶意利用来创建有害的压缩包，而非PoC代码本身具有恶意负载。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
