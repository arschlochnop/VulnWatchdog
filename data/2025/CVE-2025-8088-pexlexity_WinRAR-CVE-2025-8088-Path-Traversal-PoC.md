## CVE-2025-8088 - WinRAR 路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者使用受影响版本的WinRAR手动解压经过特殊构造的恶意RAR压缩包

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC展示了CVE-2025-8088的核心利用机制，即利用Windows NTFS文件系统的备用数据流（Alternate Data Streams, ADS）特性配合路径遍历字符进行攻击。在WinRAR 7.12及更早版本中，解压逻辑未能对ADS流名称中的路径遍历序列进行严格校验。此POC通过Python脚本调用系统命令或底层API，向一个合法的诱饵文件（decoy file）添加带有大量“..\”序列的ADS流。例如，文件名构造为“resume.txt:..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.bat”。当WinRAR解析此类压缩包并执行解压操作时，虽然主文件resume.txt会被解压到当前目录，但由于其ADS部分的路径解析错误，关联的恶意负载会被系统内核引导至上层目录甚至是系统启动目录中。经过分析，该POC代码逻辑清晰，直接利用了WinRAR在处理RAR压缩包头信息时的脆弱性，能够稳定复现文件跨目录写入的效果，具有极高的实战参考价值。利用步骤：1. 攻击者准备一个合法的诱饵文件（如txt或pdf）以及一个恶意负载（如bat脚本或exe程序）；2. 使用Python脚本（如poc.py）将负载作为ADS流附加到诱饵文件上，并通过参数指定路径遍历的深度以及目标系统路径（如启动项文件夹）；3. 将生成的带流文件打包成RAR格式分发给目标用户；4. 用户在Windows环境下使用WinRAR 7.12以下版本右键解压该文件；5. 恶意文件被隐蔽地写入到指定的系统路径下。投毒风险分析：该POC代码本身表现为标准的防御性安全研究工具，其代码逻辑完全公开透明。在代码层面，主要使用了Python的argparse进行命令行交互，并通过标准的os和文件写入操作来模拟漏洞触发条件，未发现明显的恶意混淆、远程Shellcode下载、环境变量劫持或针对研究员主机的破坏性行为。代码中包含的‘create_ads’函数仅操作用户指定的诱饵文件，符合PoC的验证逻辑。然而，由于该漏洞涉及底层文件系统特性，此类POC极易被修改。虽然当前代码是安全的，但如果研究员从非官方渠道下载该POC的变体，需警惕攻击者可能在payload生成逻辑中插入针对研究员本机的额外ADS流写入，或者在执行脚本时静默释放真实的木马程序。综合评估，该POC的原始版本投毒风险较低，主要风险在于其生成的恶意压缩包本身具有极强的隐蔽性，能绕过许多仅扫描主文件内容的传统杀毒软件或EDR沙盒检测。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-8088-PoC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-8088-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
