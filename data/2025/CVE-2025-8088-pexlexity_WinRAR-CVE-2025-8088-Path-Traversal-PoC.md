## CVE-2025-8088 - WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** Path Traversal

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/8.4

**影响版本:** ≤7.12

**利用条件:** 需要用户解压特制压缩包；需要本地WinRAR安装；利用NTFS备用数据流

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个影响WinRAR压缩软件（版本≤7.12）的严重路径遍历漏洞，CVSS评分8.4。该漏洞允许攻击者通过在特制RAR压缩包的NTFS备用数据流（ADS）中嵌入路径遍历序列（如`..\`），绕过WinRAR的文件验证机制，将恶意文件释放到系统任意位置。这最终可导致受害者系统在重启或登录后自动执行任意代码，实现持久化控制。此漏洞被评为高危，且已证实遭到多个高级持续威胁（APT）组织（如UNC4895/RomCom、APT44、Turla等）的广泛武器化利用，主要针对乌克兰军事及政府机构，并辅以定制化钓鱼诱饵。国内亦有非法攻击团伙利用此漏洞。

所提供的`poc.py`脚本和配套`README.md`文件构成了一个完整且高度有效的概念验证（PoC），精准复现并演示了CVE-2025-8088的攻击原理。该PoC设计巧妙，充分利用了WinRAR对ADS处理的缺陷。其工作流程如下：脚本接受`--decoy`（诱饵文件）、`--payload`（实际载荷，如BAT或EXE脚本）和`--out`（输出RAR文件名）等参数，并读取载荷内容，确保诱饵文件存在。然后，为诱饵文件创建多个ADS，每个ADS的名称都被精心构造，包含多层`..\`路径遍历序列，后接目标路径（例如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.bat`）。这种设计确保无论解压时当前目录深度如何，载荷都能通过足够的`..\`序列逃逸到文件系统根目录，然后精准写入`Startup`文件夹。每个ADS的内容即为用户提供的原始载荷数据。最后，脚本通过`subprocess.run`调用外部`rar.exe`命令行工具，将带有ADS的诱饵文件打包成`.rar`档案。当受害者使用存在漏洞的WinRAR版本解压此特制RAR档案时，WinRAR会错误地将ADS中定义的恶意载荷写入到构造好的`Startup`目录中。一旦系统重启或用户重新登录，位于`Startup`目录中的恶意载荷将自动执行，从而实现任意代码执行和系统持久化。该PoC的清晰结构、详尽说明以及与漏洞机制的高度一致性，使其成为评估和理解CVE-2025-8088威胁的理想工具。

**利用步骤**
1.  **环境准备**：确保目标系统安装WinRAR ≤7.12；在攻击者机器上准备好攻击载荷（如`evil.bat`）并将`rar.exe`添加到PATH。
2.  **生成恶意RAR文件**：在攻击者机器上执行`poc.py`，指定诱饵文件、载荷文件和输出的RAR文件名，例如：`python poc.py --decoy resume.txt --payload evil.bat --out exploit.rar --target_path AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\malware.bat`。这将生成`exploit.rar`。
3.  **投递与受害者操作**：通过社交工程手段将`exploit.rar`投递给受害者。受害者使用脆弱WinRAR解压该文件时，恶意载荷会被写入Windows启动目录。
4.  **恶意载荷执行**：当受害者系统重启或用户重新登录时，启动目录中的载荷将自动执行，实现任意代码执行和持久化控制。

**投毒风险分析**
对所提供的PoC代码（`poc.py`）进行分析后，评估其投毒风险为**低**（约10%）。这种风险评估基于以下因素：
1.  **代码清晰度和可读性**：脚本使用Python编写，结构清晰，逻辑简洁。它使用标准Python库（`argparse`、`os`、`subprocess`、`sys`），无代码混淆，注释（虽为俄语）亦可辅助理解。这种透明度使潜在恶意行为极易被发现和审计。
2.  **标准库与无外部依赖**：脚本完全依赖Python内置模块，不引入任何外部或非标准依赖，避免了从未知来源下载或执行额外代码的风险。
3.  **预期行为一致性**：`poc.py`的核心功能是创建具有特定ADS结构的RAR压缩包，利用`rar.exe`完成压缩。其行为与漏洞（CVE-2025-8088）描述——通过构造恶意压缩包进行路径遍历——完全一致，旨在**生成恶意载荷**，而非**本身就是恶意载荷**。
4.  **无恶意网络或系统行为**：代码中未发现任何尝试建立网络连接、发送数据、下载远程脚本、进行数据窃取或在PoC运行机器上执行非预期系统修改的行为。脚本完全在本地操作。
5.  **明确的免责声明**：`README.md`明确指出PoC仅用于研究目的，建议在隔离环境中测试，进一步表明作者的合法安全研究意图。
综上所述，尽管此PoC的**输出产品**（恶意RAR文件）旨在执行恶意操作，但**PoC代码本身**是干净且专注于漏洞复现的。它不包含任何秘密的恶意功能或潜在的投毒风险。因此，在使用此PoC代码进行防御性研究时，其自身代码的安全性是值得信赖的。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
