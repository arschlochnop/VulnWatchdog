## CVE-2025-52691 - SmarterTools SmarterMail 任意文件上传 (Arbitrary File Upload) 导致 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-52691

**漏洞类型:** 任意文件上传 (Arbitrary File Upload) 导致 远程代码执行 (RCE)

**影响应用:** SmarterTools SmarterMail

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (Estimated)

**影响版本:** 未知 (具体版本未在POC中完全标明，但针对SmarterMail全系受影响组件)

**利用条件:** 无需认证 (Unauthenticated)，网络可达

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 45%

## 详情

关于POC有效性分析：该POC针对CVE-2025-52691漏洞展现了极高的完成度与实战价值。其核心机制在于利用SmarterMail服务器在处理多部分表单数据（Multipart/form-data）、原始数据流（Raw）及JSON封装附件时的逻辑缺陷，成功绕过了未授权访问限制。该POC不仅实现了基本的任意文件上传，还针对性地生成了经过混淆处理的ASPX WebShell。代码中包含自动化的版本探测模块，能够根据目标服务器的存活状态与响应特征动态调整Payload。利用步骤清晰：1. 首先通过特定的API端点进行指纹识别，确认目标为SmarterMail且版本存在弱点；2. 脚本采用多种上传路径（包含multipart、raw、JSON等）并发尝试，确保即使部分接口被WAF拦截，也能通过其他路径植入WebShell；3. WebShell植入后，脚本利用Base64编码指令与服务器进行加密通信，绕过了常规流量监控；4. 具备自动化的交互式Shell界面，支持命令执行、文件拖取及权限维持。整体而言，该POC结构严谨，模块化程度高，不仅是一个概念验证，更是一个具备高度武装能力的渗透测试框架。其利用链完整，从指纹识别到自动化利用再到后渗透清理，均表现出极高的技术水平，对未加防护的SmarterMail服务器构成极大威胁。

关于投毒风险分析：该POC被标注为‘APT-Enhanced’（APT增强版），这一特征显著提高了其作为投毒载体的可能性。风险主要体现在以下几个维度：第一，代码中包含‘Persistence’（持续化）功能模块，尽管POC描述中称其为计划任务占位符，但在实际分发过程中，攻击者极易在`exploit.py`或混淆的`ASPX`负载中植入指向恶意域名的下载执行指令（Download-and-Execute），普通研究人员在未逐行审计混淆Payload的情况下难以发现。第二，脚本广泛使用了`base64`和`random`库对核心逻辑进行动态生成，这种混淆手段虽然是为了绕过防护软件，但也为恶意代码的寄生提供了掩护。第三，该POC支持‘Batch Processing’（批量处理），这暗示了其被用于大规模自动扫描与僵尸网络扩张的潜质。第四，虽然项目声明仅用于教育，但脚本中集成的‘SSL verification bypass’（跳过SSL验证）和‘Proxy Support’（代理支持）是典型的黑客攻击特征，极大地方便了恶意溯源的规避。综合考量，虽然目前观测到的代码主要功能是针对漏洞利用，但其‘APT增强’的属性使得该仓库极易被修改为恶意软件分发节点，用户在下载运行此类‘高集成度’工具时面临中高程度的投毒风险，必须在严格隔离的沙箱环境中进行代码审计。

**项目地址:** /tmp/vulnwatchdog_504ae76829abeef4e9809872cd586945/

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-52691](https://nvd.nist.gov/vuln/detail/CVE-2025-52691)
