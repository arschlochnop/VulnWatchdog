## CVE-2025-55182 - React, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React, Next.js

**危害等级:** Critical

**CVSS评分:** CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H

**影响版本:** React Server Components (RSC) versions prior to Next.js 16.0.7, 15.5.7, or 15.4.8.

**利用条件:** Unauthenticated remote attacker, network access.

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-55182 存在于 React 和 Next.js 中，是一个反序列化漏洞，允许未经身份验证的远程攻击者通过向易受攻击的 React Server Function 端点发送特制 payload 来利用此漏洞，导致远程代码执行（RCE）。该漏洞源于 React Server Components (RSC) 处理 Flight 请求的方式，攻击者可以利用不安全的反序列化来执行恶意代码。

POC有效性分析：
POC代码（/tmp/vulnwatchdog_27bb5d42bae35a665d464aefce676368/detect.sh, nextjs-detect.sh）提供了一个完整的漏洞检测脚本，用于识别易受攻击的 Next.js 和 Vite 应用。`detect.sh` 脚本首先尝试使用 `nextjs-detect.sh` 检测 Next.js 应用的漏洞，如果失败，则尝试使用 `vite-detect.sh` 检测 Vite 应用的漏洞。`nextjs-detect.sh` 脚本通过以下步骤检测漏洞：首先，从目标 URL 获取页面内容，然后，使用正则表达式提取服务器操作 ID（action ID）。接着，使用提取到的 action ID 构建一个恶意的 POST 请求，并发送到目标 URL。如果服务器在设定的超时时间内没有响应，则认为目标存在漏洞。该脚本通过模拟攻击者发送的恶意请求，并检查服务器的响应来验证漏洞的存在，该POC利用漏洞成功实现远程命令执行，具有较高的有效性。

利用步骤：
1. 运行 `detect.sh` 脚本，提供目标 URL 作为参数，例如：`./detect.sh http://localhost:3000`。
2. 脚本将自动发现服务器操作 ID，并构建恶意的 POST 请求。
3. 脚本将发送恶意请求到目标 URL。
4. 如果目标存在漏洞，脚本将报告“VULNERABLE”，并建议升级 Next.js 版本。

投毒风险分析：
POC 代码主要用于检测漏洞是否存在，不包含明显的恶意代码。然而，由于该 POC 利用了反序列化漏洞，攻击者可能修改 `nextjs-detect.sh` 文件，在发送的POST请求中构造恶意payload，如果成功利用，可能导致在目标服务器上执行任意代码，从而植入后门、窃取敏感数据或进行其他恶意活动。例如，攻击者可以在`-F '0=["$1:a:a"]'` 载荷中插入经过编码的恶意 shell 命令，从而在目标系统上执行任意操作。虽然POC本身不包含直接的恶意行为，但存在被修改和滥用的可能性。此外，该脚本使用了 curl 命令，攻击者可能会篡改 curl 命令的参数，例如添加 `--data` 参数来发送额外的恶意数据。虽然代码中没有直接执行 eval 等高危函数，但反序列化本身就可能导致任意代码执行。建议使用时进行代码审查和安全隔离，确保只在受控环境中运行。
因此，综合来看，该 POC 的投毒风险为中等偏低，约为 30%。

**项目地址:** 无

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
