## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17(不含 1.9.17p1)

**利用条件:** 本地用户权限，且系统配置允许使用 sudo --chroot (-R) 选项，或攻击者拥有受限的 sudo 权限。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码具备极高的实用性和有效性。其核心逻辑利用了Sudo在执行--chroot (-R)选项时对环境隔离处理的缺陷。当Sudo进入由用户控制的目录进行chroot操作后，系统库（通常是glibc）会尝试根据该环境下的/etc/nsswitch.conf配置加载Name Service Switch (NSS)模块。POC通过在临时目录中伪造这一配置文件，并诱导系统加载恶意的共享对象文件（libnss_privesc.so.2），成功触发了具有__attribute__((constructor))属性的C代码。由于Sudo在执行此类操作时已经获取或保留了root权限，恶意代码会在提权上下文中被执行。代码实现上使用了Python自动化构建环境，包括C源码的动态生成、GCC自动编译以及环境清理，这大大降低了利用门槛。经评估，在受影响的Sudo版本上，该POC能稳定获取root Shell，是一份高质量的防御性研究素材。【利用步骤】1. 准备环境：确保目标系统安装有Python 3和GCC编译工具链。2. 下载仓库：获取exploit.py及其配套文件。3. 运行脚本：执行python3 exploit.py。4. 自动构建：脚本会创建一个临时的chroot目录结构。5. 负载生成：脚本生成一个恶意C源文件并将其编译为共享库（.so文件）。6. 配置伪造：在临时目录中生成恶意nsswitch.conf。7. 触发利用：脚本调用sudo -R [temp_dir] [command]触发系统加载恶意模块。8. 提权成功：模块加载后立即执行构造函数，弹出root权限的Shell。【投毒风险分析】在对此POC项目进行代码审计后发现，其投毒风险处于低水平（约15%）。首先，项目代码结构清晰，使用了Python标准库（os, tempfile, subprocess等），没有引入经过Base64加密、Hex混淆或远程下载的可疑二进制组件。关键的提权Payload以明文C代码形式存在，透明度高，易于安全人员审查其行为。其次，该POC包含了显式的清理机制，在运行结束后会尝试删除产生的临时文件和编译产物，符合安全研究工具的规范。然而，潜在的风险点在于：该项目引用了外部GitHub链接（K1tt3h的仓库），在自动化环境中如果脚本包含从未经审计的第三方源拉取额外依赖的操作，可能存在供应链污染风险。此外，由于此类提权脚本通常需要root执行环境或模拟环境，攻击者可能在脚本中潜伏持久化指令。但就目前提供的代码片段来看，该脚本仅专注于演示CVE-2025-32463的漏洞机理，未发现恶意后门或窃密行为。建议研究人员在隔离的沙箱环境中使用，并手动检查GCC编译的源码逻辑。

**项目地址:** [https://github.com/nelissandro/CVE-2025-32463-Sudo-Chroot-Escape](https://github.com/nelissandro/CVE-2025-32463-Sudo-Chroot-Escape)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
