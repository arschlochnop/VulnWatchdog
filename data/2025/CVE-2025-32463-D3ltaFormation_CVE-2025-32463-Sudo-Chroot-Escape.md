## CVE-2025-32463 - sudo 本地提权 (Local Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (Local Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 1.9.14 <= sudo < 1.9.17p1

**利用条件:** 本地用户访问权限；sudo配置允许用户通过 -R 或 --chroot 选项在用户可控的目录下执行命令。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC项目结构完整，包含README文档说明及基于Python编写的自动化漏洞利用脚本exploit.py。技术核心在于利用sudo在处理chroot环境时的逻辑缺陷。当sudo使用-R选项进入chroot环境后，若未正确重置或限制加载环境，它会读取该环境下的/etc/nsswitch.conf配置文件。POC通过在用户可控的临时目录下伪造一个恶意的nsswitch.conf，并将其中的用户验证源（如passwd, group）指向一个自定义的恶意动态链接库（libnss_privesc.so.2）。由于sudo以root权限运行，当它尝试在chroot环境中解析用户信息时，会通过glibc加载该恶意库。POC中的C语言载荷利用了__attribute__((constructor))特性，确保在库加载瞬间即执行代码，从而直接在宿主机环境中弹回或产生一个root shell。从代码逻辑看，自动化程度极高，能够自动完成C代码生成、GCC编译及环境模拟，是一个高度有效的漏洞利用脚本。【利用步骤】1. 攻击者获取受害Linux系统的低权限Shell；2. 确认sudo版本在受影响范围内（1.9.14-1.9.17）；3. 运行Python脚本，脚本会在/tmp下创建一个受控目录作为伪chroot环境；4. 脚本在目录内生成恶意的/etc/nsswitch.conf和对应的C源码；5. 调用gcc将C代码编译为共享库文件；6. 执行命令 sudo -R [受控目录] [任意可用命令]，触发漏洞获取root权限。【投毒风险分析】该POC的投毒风险处于较低水平（约15%）。代码采用Python编写，逻辑透明，未见明显的Base64混淆、内存执行（fileless）或针对研究者机器的后门注入。主要的风险点在于：1. 脚本会调用subprocess执行系统编译和删除操作，理论上若脚本被篡改，可被植入删除宿主机关键文件的指令；2. 依赖外部的gcc工具，虽是标准行为，但在供应链污染场景下，恶意作者可能诱导用户在特定环境下运行。然而，README中的Disclaimer非常标准，且代码注释清晰，主要功能集中在提权逻辑实现上。对于防御者而言，在使用该POC进行防御验证时，应重点检查exploit.py中是否有未知的网络外连请求（如向特定IP发送当前主机的凭据），目前审计该代码片段主要专注于漏洞利用，未发现明显的恶意二段跳投毒行为。建议在隔离的沙箱环境中使用，并监控Python进程的文件系统写操作，以确保研究过程的安全。

**项目地址:** [https://github.com/nelissandro/CVE-2025-32463-Sudo-Chroot-Escape](https://github.com/nelissandro/CVE-2025-32463-Sudo-Chroot-Escape)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
