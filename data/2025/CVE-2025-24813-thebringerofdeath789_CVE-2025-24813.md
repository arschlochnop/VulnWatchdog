## CVE-2025-24813 - Apache Tomcat 远程代码执行(RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Tomcat

**危害等级:** 严重

**CVSS评分:** 9.8

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** 无需身份验证，可通过网络访问

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 20%

## 详情

CVE-2025-24813是一个Apache Tomcat中的远程代码执行漏洞，源于对PUT请求处理不当。具体来说，漏洞存在于Tomcat处理部分PUT请求的逻辑中，允许未经身份验证的攻击者上传恶意文件到服务器并执行任意代码。 Rapid7的博客文章指出，该漏洞允许未经验证的远程代码执行。POC代码（tomcat_cve_2025_24813_exploit.py）尝试利用此漏洞。该POC首先尝试从多个URL下载ysoserial，这是一个用于生成Java反序列化有效载荷的工具。如果本地不存在ysoserial.jar，POC会尝试从预定义的URL列表下载它。然后，它生成一个base64编码的Java反序列化有效载荷，并将其上传到会话目录。该脚本通过发送带有Content-Range标头的PUT请求来实现，该标头指定上传的文件范围。成功利用需要目标服务器启用`readonly`初始化参数设置为`false`。POC代码首先会尝试写入一个测试文件来验证目标是否可写。如果目标可写，它会生成一个包含恶意命令的有效载荷（默认是反弹shell），然后将其上传到服务器。POC代码使用java -jar命令通过ysoserial生成payload，并且使用了CommonsCollections6作为gadget。为了提高成功率，POC代码包含了多种ysoserial镜像地址。如果目标服务器启用了身份验证，则需要修改POC以包含正确的身份验证信息。利用步骤如下：
1. 确保目标Tomcat服务器的版本受漏洞影响。
2. 运行提供的Python脚本，指定目标服务器的URL和要执行的命令。
3. 脚本将自动下载ysoserial（如果尚未下载），生成有效载荷，并将其上传到目标服务器。
4. 上传的有效载荷将被反序列化，从而在服务器上执行命令。

**投毒风险分析:**
此POC的投毒风险较低，但并非完全没有。风险点在于ysoserial的下载和使用，虽然ysoserial本身是一个合法的渗透测试工具，但如果攻击者修改了POC脚本，将其指向恶意的ysoserial下载源，那么可能会引入恶意代码。此外，POC中使用了base64编码和bash命令执行，虽然这是为了方便执行任意命令，但也可能被滥用。例如，攻击者可以修改POC，使其下载并执行任意的shell脚本，从而实现更复杂的攻击。该POC使用requests库发送HTTP请求，如果攻击者修改了POC，使其向恶意服务器发送敏感信息，那么可能会造成信息泄露。POC中包含了一个随机字符串生成函数（randid），虽然这主要是为了生成随机文件名，但也可能被用于生成其他随机数据，如果攻击者修改了POC，使其生成具有特定模式的随机数据，那么可能会用于绕过某些安全策略。考虑到这些因素，此POC的投毒风险评定为20%。大部分代码清晰，使用了标准库，行为基本可控，主要风险集中在外部依赖的ysoserial及其可能被替换的下载源上。需要注意的是，不能因为该POC验证后门代码而判断为投毒代码，后门代码是漏洞利用的必要组成部分。

**项目地址:** https://github.com/xxx/CVE-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
