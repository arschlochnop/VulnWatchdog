## CVE-2025-55182 - React和Next.js 反序列化RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 反序列化RCE

**影响应用:** React和Next.js

**危害等级:** 高危

**CVSS评分:** 10

**影响版本:** 受影响版本范围未知，但影响使用React Server Components的React和Next.js应用。

**利用条件:** 未经身份验证的远程攻击者可以通过向易受攻击的React Server Function端点发送特制Payload来利用此漏洞。需要网络访问。

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 30%

## 详情

CVE-2025-55182 是一个存在于 React Server Components (RSC) 中的不安全的反序列化漏洞。 远程未授权的攻击者可以通过向存在漏洞的 React Server Function 端点发送特制的 payload 来利用此漏洞， 从而实现远程代码执行。 该漏洞源于 React 的 Server Functions 协议处理传入的 Flight 请求的方式存在缺陷。React Server Components 允许开发者编写在服务器端运行的代码，从而提高性能和安全性。然而，当服务器接收到客户端发送的请求时，它需要对数据进行反序列化。如果反序列化过程不安全，攻击者就可以利用它来执行恶意代码。根据提供的POC代码，攻击者可以通过构造特定的files参数，利用httpx库向目标服务器的根路径（/）发起POST请求，在请求头中设置Next-Action为特定的ACTION_ID，服务端如果存在漏洞，则会触发反序列化漏洞，从而执行攻击者预期的代码。提供的PoC包含了一些利用示例，展示了不同的payload可能导致的错误类型，比如TypeError或尝试访问服务器端无法访问的客户端对象。这些示例展示了漏洞利用的可能性，但可能需要根据具体的应用环境进行调整。PoC的有效性取决于目标应用程序是否使用了易受攻击的React和Next.js版本，以及是否启用了React Server Components。利用步骤：
1. 确定目标应用程序是否使用了React Server Components。
2. 部署包含漏洞版本的React和Next.js应用程序。
3. 使用提供的PoC代码，构造恶意payload，并通过HTTP POST请求发送到目标应用程序的Server Function端点。
4. 监视服务器端的响应，以确认代码是否成功执行。
投毒风险分析：
该PoC代码主要使用标准Python库httpx，代码本身较为简洁，未发现明显的恶意行为，例如直接执行系统命令或访问敏感文件等。但由于该PoC旨在利用反序列化漏洞，攻击者可以通过构造恶意的序列化数据来执行任意代码。因此，PoC本身可能被修改，以包含更具破坏性的payload。例如，攻击者可能会在序列化数据中嵌入恶意代码，用于下载和执行外部脚本，或者直接在服务器上执行系统命令。此外，攻击者还可能通过混淆PoC代码来隐藏其恶意意图，例如使用base64编码或加密算法来隐藏payload。尽管当前PoC代码的投毒风险较低，但考虑到反序列化漏洞的潜在危害，以及攻击者可能采取的各种攻击手段，仍需保持警惕，并采取必要的安全措施来防范潜在的攻击。

**项目地址:** https://github.com/sickcodes/CVE-2025-55182

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
