## CVE-2025-68613 - n8n 表达式注入 / 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-68613

**漏洞类型:** 表达式注入 / 远程代码执行 (RCE)

**影响应用:** n8n

**危害等级:** Critical (严重)

**CVSS评分:** 9.9 (基于描述推断)

**影响版本:** n8n <= 1.120.0 (及其他未修复版本)

**利用条件:** 需要认证（即使是低权限用户）、可访问n8n Web UI

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞属于典型的表达式注入（Expression Injection）。在n8n的早期版本中，其表达式引擎未能对Node.js环境中的沙箱进行严格隔离，导致用户输入的表达式能够访问到底层JavaScript运行时的全局对象。根据提供的POC代码，攻击者通过在'Set'节点的表达式字段中输入特定构造的JavaScript匿名函数，利用了'this.process.mainModule.require'这一路径。这种手法直接绕过了n8n预设的沙箱限制，使其能够调用Node.js内置的'child_process'模块。执行'execSync'函数可以直接在托管n8n服务的宿主机或容器内运行系统命令（如POC中的'id'命令）。从技术角度看，该POC极其简洁有效，其核心逻辑在于利用了Javascript作用域链中未受保护的process对象。对于防御方而言，该漏洞证明了即使开启了基本认证，恶意用户依然可以获得服务器权限，这在多租户环境或权限划分不严的组织中极具杀伤力。该POC提供了一个完整的Docker测试环境（n8nio/n8n:1.120.0），验证了该版本在处理表达式解析时缺乏对敏感对象属性的拦截，攻击者可以稳定触发RCE，执行权限取决于运行n8n进程的用户权限（通常为root或n8n用户）。【利用步骤】1. 使用认证凭据登录n8n工作台。2. 创建一个新的工作流。3. 添加一个'Set'节点（或任何支持表达式计算的节点）。4. 在节点的配置属性中，点击插入表达式。5. 输入Payload：'{{ (function() { var require = this.process.mainModule.require; var execSync = require("child_process").execSync; return execSync("id").toString(); })() }}'。6. 执行该节点或预览结果，此时后台会执行'id'命令并将结果回显至UI。7. 攻击者可将命令替换为反弹Shell，实现对系统的持久化控制。【投毒风险分析】经过对POC代码（README、Javascript Payload及docker-compose.yml）的详细审计，该资源主要用于安全研究和复现，投毒风险评级为低（10%）。Payload本身是标准的Node.js命令执行模板，其目的是证明漏洞的存在（执行id命令），而非执行恶意的后台窃取或加密操作。docker-compose文件指向官方镜像，不含第三方后门容器。尽管Javascript代码中包含'require'和'execSync'等高危函数，但这是实现RCE验证的必要部分，并未发现混淆、动态下载外部恶意脚本或建立隐蔽C2连接的行为。唯一的风险点在于此类POC可能被二次打包发布在非官方渠道，并修改其中的Payload执行静默下载。但就原始POC而言，代码逻辑清晰、透明，符合安全防御研究的标准。建议研究员在隔离环境中使用该POC，并重点监控Node.js进程派生出的异常子进程。

**项目地址:** N/A

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-68613](https://nvd.nist.gov/vuln/detail/CVE-2025-68613)
