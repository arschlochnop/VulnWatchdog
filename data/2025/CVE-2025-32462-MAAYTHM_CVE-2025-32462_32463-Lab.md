## CVE-2025-32462 - Sudo 权限提升 (LPE)

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高 (High)

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** Sudo < 1.9.17p1

**利用条件:** 具有本地用户访问权限，且 sudoers 配置文件中使用了针对特定主机的 Host 或 Host_Alias 限制规则（而非 ALL）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该POC项目提供了一个高度完整的Docker化实验环境，用于重现CVE-2025-32462漏洞。漏洞根源在于Sudo处理主机名匹配逻辑的缺陷。当sudoers配置中明确指定了允许执行命令的主机名（Host_Alias）而非通配符ALL时，Sudo在验证当前主机是否匹配规则时存在逻辑偏差。攻击者可以通过'sudo -h'参数手动指定主机名来欺骗Sudo，使其误以为当前操作是在被授权的高权限主机上执行，从而绕过原本的主机限制。POC代码通过Dockerfile构建了一个安装有受影响版本（Sudo 1.9.16p2）的Ubuntu 24.04环境。关键利用步骤清晰：首先通过Docker网络模拟多主机环境，并在sudoers中配置排除当前主机的特定权限（如 pwn HIGH,!LOW），随后在lowpriv容器中通过简单的命令行操作即可触发权限提升。该POC逻辑严密，配置文件编写规范，能准确反映漏洞在复杂策略下的触发点，是极高质量的防御研究样本。利用步骤如下：1. 构建Docker镜像；2. 启动并配置sudoers主机别名；3. 以普通用户身份执行带有-h参数的sudo命令，利用逻辑漏洞获取Root权限。【投毒风险分析】经过深入静态代码分析，该POC项目的投毒风险极低。首先，Dockerfile使用的是官方Ubuntu基础镜像，安装的依赖包均为标准开发工具（build-essential, wget, libssl-dev等），没有引入非官方的第三方二进制文件或未授权的PPA源。其次，Sudo源码是从官方dist.sudo.ws地址下载并现场编译的，确保了核心组件的纯净性。README中提供的操作命令均为透明的Shell指令，没有包含任何Base64加密的混淆内容、eval动态执行逻辑或外联C2服务器的行为。唯一需要注意的是实验环境中手动修改/etc/sudoers的行为，但这属于漏洞验证的必要配置步骤，而非恶意持久化手段。项目作者Rich Mirch属于知名网络安全机构Stratascale，具备良好的行业信誉。综合评估，该POC代码透明、逻辑清晰，完全符合安全研究规范，不存在恶意后门植入或信息窃取的风险，可放心在受控实验室环境中使用。

**项目地址:** [https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host](https://www.stratascale.com/vulnerability-alert-CVE-2025-32462-sudo-host)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
