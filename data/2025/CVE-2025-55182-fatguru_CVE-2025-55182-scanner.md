## CVE-2025-55182 - React Server Components RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** 19.0 to 19.2.0

**利用条件:** Unauthenticated, Requires network access

**POC 可用性:** 8/10

**POC 类型:** Concept Verification

**攻击复杂度:** Medium

**投毒风险:** 15%

## 详情

CVE-2025-55182是React Server Components (RSC)中存在的一个严重漏洞，允许未经身份验证的远程代码执行。该漏洞的CVSS评分为10.0，表明其严重性为最高级别。该漏洞影响React Server Components 19.0到19.2.0版本。该漏洞的根本原因是RSC的不安全反序列化，攻击者可以通过特制的请求利用此漏洞在服务器上执行任意代码。官方披露日期为2025年11月29日。

POC有效性分析：
提供的POC代码是一个轻量级的Python工具，旨在检测暴露于CVE-2025-55182的React Server Components (RSC)端点。该工具采用表面检测方法，验证服务器是否公开RSC协议（Content-Type: text/x-component）并接受特定的Next.js操作标头。该脚本不尝试直接利用漏洞，而是检测攻击面，即RSC端点的暴露情况。该POC的优势在于它不依赖于特定的payload，例如`{"id":"vm"}`，这些payload在生产环境中由于代码混淆和tree-shaking可能无法工作。相反，它验证服务器是否正在尝试处理RSC payload。要证明RCE，需要枚举/fuzz Webpack模块ID，并分析客户端`webpack-runtime.js`或chunk文件以提取潜在gadget的有效ID映射。此过程可能需要一些逆向工程技能，但可避免因依赖固定payload而产生的误报。

利用步骤：
1. 运行提供的Python脚本，指定目标URL：`python3 cve_2025_55182_scanner.py -u http://localhost:3000`
2. 如果脚本检测到RSC端点暴露，则继续进行漏洞验证。
3. 枚举Webpack模块ID。这可以通过fuzz测试或分析客户端`webpack-runtime.js`或chunk文件来完成。
4. 构造一个包含有效Webpack模块ID的恶意RSC payload。Payload应尝试执行任意代码，例如通过`vm.runInThisContext`。
5. 将payload发送到暴露的RSC端点。
6. 验证代码是否已在服务器上执行。

投毒风险分析：
提供的Python扫描器本身没有明显的投毒风险。该代码清晰，主要使用标准库，并且不执行任何可疑操作。然而，利用此漏洞的RCE payload可能携带投毒风险。如果攻击者成功地在服务器上执行代码，他们可以安装后门，修改文件或窃取敏感数据。由于该POC主要用于检测漏洞而非实际利用，因此投毒风险较低，大约15%。

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
