## CVE-2025-55182 - React Server Components (RSC), Next.js 不安全反序列化导致的远程代码执行(RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** 不安全反序列化导致的远程代码执行(RCE)

**影响应用:** React Server Components (RSC), Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** React 19.0 to 19.2.0

**利用条件:** 未经授权的网络访问，需要利用链 (Prototype Pollution)

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 20%

## 详情

CVE-2025-55182是一个存在于React Server Components (RSC) 中的严重远程代码执行漏洞。该漏洞源于不安全的反序列化，允许未经身份验证的攻击者执行任意代码。该漏洞影响React 19.0到19.2.0版本，并且与Next.js的CVE-2025-66478相关联。利用此漏洞的先决条件是目标服务器暴露了RSC协议，这意味着服务器能够处理并响应特定的RSC请求。然而，在实际的Next.js生产环境中，利用此漏洞并非易事。Next.js通常使用`serverManifest`来限制允许加载的模块。直接尝试通过RSC加载危险模块（如`child_process`）通常会失败，因为这些模块不在白名单中。因此，攻击者通常需要将此漏洞与原型污染（Prototype Pollution）漏洞结合使用，才能覆盖内存中的`serverManifest`并绕过白名单。该POC通过智能路径探测和主动指纹识别技术来检测目标是否暴露了RSC协议。它通过探测随机不存在的路径来绕过根重定向，并使用特定的payload触发React 19 RSC的“Digest”错误，从而识别目标。该POC不尝试执行任意代码，而是验证流签名，以检测RSC协议是否暴露，并不依赖于脆弱的RCE payload或模块ID。利用步骤如下：1. 使用POC扫描器，确定目标服务器是否暴露RSC端点。2. 如果RSC端点暴露，尝试查找或利用原型污染漏洞，覆盖`serverManifest`。3. 成功覆盖`serverManifest`后，构造恶意RSC请求，执行任意代码。该漏洞的投毒风险较低，因为提供的POC代码主要用于检测RSC端点是否暴露，不包含恶意代码或后门。但是，如果攻击者修改此POC，加入恶意代码或后门，则可能存在投毒风险。例如，攻击者可以在POC中添加代码，在成功利用漏洞后，在目标服务器上安装恶意软件或收集敏感信息。此外，攻击者还可以通过混淆代码或使用加密技术来隐藏恶意代码，从而增加检测难度。在实际应用中，需要对POC代码进行严格的安全审查，确保其不包含恶意代码或后门，才能安全使用。

**项目地址:** https://github.com/0x7556/CVE-2025-59287

**漏洞详情:** None
