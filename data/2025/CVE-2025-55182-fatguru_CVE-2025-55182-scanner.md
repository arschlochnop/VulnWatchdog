## CVE-2025-55182 - React Server Components, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10

**影响版本:** Not specified

**利用条件:** Unauthenticated remote access to a vulnerable React Server Function endpoint

**POC 可用性:** 8/10

**POC 类型:** Surface Detector

**攻击复杂度:** Medium

**投毒风险:** 10%

## 详情

CVE-2025-55182 is a critical remote code execution (RCE) vulnerability affecting React Server Components (RSC) and Next.js applications. The vulnerability stems from unsafe deserialization of data within the RSC protocol. An unauthenticated, remote attacker can exploit this vulnerability by sending a specially crafted payload to a vulnerable React Server Function endpoint.

The provided Proof-of-Concept (POC) code is not a full exploit but a "Surface Detector." It identifies whether the RSC protocol is exposed and active on a given endpoint. This is achieved by checking for the `Content-Type: text/x-component` stream signature. The detector is ID agnostic, meaning it doesn't rely on specific module IDs (which can be minified in production builds) to determine exposure.

The effectiveness of the POC lies in its ability to identify potential attack surfaces. While direct attempts to execute arbitrary code might be blocked by server-side whitelists (`serverManifest` in Next.js), identifying exposed endpoints is a prerequisite for further exploitation attempts, particularly chaining with Prototype Pollution vulnerabilities to bypass the whitelist.

**Exploitation Steps:**
1.  **Identify Exposed Endpoints:** Use the provided scanner to identify endpoints that expose the RSC protocol.
2.  **Bypass Whitelists:** Research and identify potential Prototype Pollution vulnerabilities within the application's code or dependencies. These vulnerabilities can be chained to overwrite the `serverManifest` and allow the execution of arbitrary modules.
3.  **Craft Payload:** Construct a malicious payload that leverages the identified Prototype Pollution vulnerability to modify the `serverManifest` and then executes arbitrary code through the RSC endpoint.
4.  **Send Payload:** Send the crafted payload to the vulnerable endpoint.

The provided POC doesn't directly execute code; it only detects the presence of the vulnerable surface. However, the information it provides is crucial for crafting a full exploit. The success of an exploit depends on the application's specific configuration, the presence of Prototype Pollution vulnerabilities, and the ability to bypass server-side whitelists.

**投毒风险分析:**
虽然本POC本身不包含恶意代码或后门，但它确实存在一定的投毒风险。以下是风险分析：
*   **依赖项风险:** requirements.txt 中列出的依赖项需要进行审查，以确保没有已知的恶意库或具有漏洞的库。虽然代码本身看起来安全，但供应链攻击是一个风险因素。
*   **误报风险:** 如果攻击者修改了代码以报告虚假阳性结果，则可能会误导安全团队，使他们认为系统已受到保护，而实际上并未受到保护。这可能会导致安全团队忽略真正的漏洞。
*   **信息泄露风险:** 该工具可能会在日志中或通过其他方式泄露有关目标系统的信息，这些信息可能会被恶意行为者利用。
*   **使用方式风险:** 该工具可能被用于恶意目的，例如扫描目标系统以查找易受攻击的端点，然后攻击这些端点。虽然该工具旨在帮助安全团队，但它也可能被攻击者滥用。
*   **代码混淆风险:** 攻击者可能会混淆该工具的代码，使其难以检测和分析。这可能会增加投毒的风险。

鉴于以上风险，本POC的投毒风险评定为 10%。建议用户在使用该工具时采取适当的安全措施，例如审查代码和依赖项，并定期更新工具。

**项目地址:** https://github.com/fatguru/CVE-2025-55182-scanner.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-55182
