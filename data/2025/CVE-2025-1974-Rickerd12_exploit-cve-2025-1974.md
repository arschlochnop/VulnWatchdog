# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

# CVE-2025-1974

> 📦 该CVE有 **22** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2025-1974-0xBingo_CVE-2025-1974.md](../2025/CVE-2025-1974-0xBingo_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的密钥泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974是一个存在于kubernetes ingress-nginx中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问pod网络，则可以通过注入恶意配置到ingress-nginx的Validating Admission Controller中，实现任意代码执行。POC代码通过发送包含恶意annotation的AdmissionReview请求到admission controller的`/validate`端点，尝试注入`error_log`指令，如果ingress controller日志中出现权限拒绝错误，则表明存在漏洞。POC代码本身只是用于验证漏洞的存在，并没有发现任何隐藏的投毒代码。

**项目地址:** [0xBingo/CVE-2025-1974](https://github.com/0xBingo/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #2

**来源**: [CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md](../2025/CVE-2025-1974-Armand2002_Exploit-CVE-2025-1974-Lab.md)

## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #3

**来源**: [CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md](../2025/CVE-2025-1974-B1ack4sh_Blackash-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes ingress-nginx的严重远程代码执行漏洞（RCE），被称为'IngressNightmare'。未经身份验证的攻击者如果能够访问Pod网络，可以通过利用Validating Admission Controller中的漏洞来执行任意代码。

**有效性：**

提供的POC代码看起来是有效的。它包含构建恶意共享库（.so文件）的Makefile、说明漏洞利用方式的README.md文件。

从提供的Makefile分析,`danger.c`会被编译为`danger.so`文件，这符合利用描述中上传恶意.so文件的步骤. 同时，`bad_config.conf` 看起来是用于触发漏洞的恶意 Nginx 配置文件。

README.md文件描述了漏洞的详细信息、影响、受影响的版本、利用方式以及缓解步骤，这进一步佐证了POC代码的有效性。

**投毒风险：**

投毒风险较低，约为5%。虽然`danger.c`本身的代码内容未提供，理论上可能存在恶意行为，例如植入后门。但是，考虑到攻击流程主要依赖于上传.so文件和配置文件的注入，恶意代码更可能存在于`danger.c`中。同时`bad_config.conf`也可能存在后门，但概率较低. 总体上, 风险较低. README.md的完整描述提升了可信度,降低投毒的可能性。 

**利用方式：**

1.  **上传恶意.so文件：** 攻击者通过发送一个大的HTTP POST请求，触发NGINX的`client-body buffering`，从而将恶意.so文件存储为临时文件。
2.  **注入恶意配置：** 攻击者构造恶意的`AdmissionReview`请求，通过注入`ssl_engine`指令将.so文件的路径写入临时的 Nginx 配置文件。这是通过向admission validating webhook server发送请求实现的。
3.  **触发RCE：**  Admission webhook运行 `nginx -t` 命令来检查配置文件，这会加载恶意的.so文件，从而导致在Ingress controller Pod中执行任意代码。`nginx -t` 命令的执行是漏洞触发的关键。

漏洞利用需要攻击者能够访问Pod网络，这意味着攻击通常发生在集群内部。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1974](https://github.com/B1ack4sh/Blackash-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #4

**来源**: [CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-BiiTts_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可以完全控制 Kubernetes 集群，暴露所有 Secrets

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 Pod 网络，并且目标集群运行受影响版本的 ingress-nginx

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者通过 Pod 网络访问 ingress-nginx 控制器的 Admission Webhook，进而执行任意代码。 

**有效性：**

提供的 PoC 代码包含两个主要部分：

1.  **shell.so 构建脚本：**  该脚本用于构建一个共享对象 (`shell.so`)，其中包含反向 shell 代码。`shell.c` 文件中的 `reverse_shell` 函数会在加载该共享对象时自动执行，连接到攻击者指定的 IP 地址和端口。**需要注意的是，`shell.c` 中的 IP 地址和端口需要修改为攻击者的 IP 和端口，否则利用会失败。**构建脚本使用 Alpine Linux 镜像，并编译 `shell.c` 为一个小的共享库。

2.  **xpl.py 利用脚本：** 该脚本尝试通过修改 Ingress 对象的 annotation，将恶意的 `shell.so` 库加载到 ingress-nginx 控制器中。它通过遍历 `/proc/[pid]/fd/[fd]` 路径来定位 ingress-nginx 控制器可以访问的文件描述符，并尝试将文件描述符指向的路径注入到 `ssl_engine` 指令中，从而加载恶意的共享库。`review.json` 文件包含 AdmissionReview 对象，其中包含恶意的 Ingress 对象定义，它使用 template injection 的方式尝试加载 shell.so 文件。

**利用方式：**

1.  **构建恶意的 `shell.so`：** 修改 `shell.c` 中的 IP 地址和端口，然后运行 `run_build.sh` 脚本来构建 `shell.so` 文件。
2.  **发送恶意的 AdmissionReview 请求：**  `xpl.py` 脚本会读取 `review.json` 文件，并替换 `REPLACE` 字符串为不同的文件描述符路径，然后将 AdmissionReview 请求发送到 ingress-nginx 控制器的 Admission Webhook。
3.  **利用成功：** 如果成功找到了一个有效的文件描述符，ingress-nginx 控制器将加载恶意的 `shell.so` 文件，执行其中的反向 shell 代码，从而使攻击者获得对控制器的远程代码执行权限。

**投毒风险：**

存在一定的投毒风险，大约为10%。主要体现在以下几个方面：

*   **`shell.c` 文件：**  虽然 `shell.c` 的目的是创建一个反向 shell，但如果作者在代码中添加了额外的恶意逻辑（例如，删除文件、修改配置等），则会在受害者执行 PoC 时造成额外的损害。当前代码比较简单，风险较低。
*   **`xpl.py` 文件：** 该文件尝试进行文件描述符遍历。虽然该脚本主要用于漏洞利用，但是仍然可能存在一些利用失败的情况，可能会影响目标系统的稳定性。
*   **`build.sh`文件:**  虽然该脚本主要是用来编译,但是如果作者在编译过程中加入一些恶意的代码,是有可能存在投毒的。

总体而言，投毒风险较低，主要是因为 PoC 代码相对简单，功能明确。但是，在使用任何 PoC 代码时，都应该仔细审查代码，确保没有隐藏的恶意行为。

**项目地址:** [BiiTts/POC-IngressNightmare-CVE-2025-1974](https://github.com/BiiTts/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #5

**来源**: [CVE-2025-1974-Esonhugh_nginxnightmare.md](../2025/CVE-2025-1974-Esonhugh_nginxnightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以访问 Pod 网络，并在 ingress-nginx 控制器的上下文中执行任意代码，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络。默认安装下，控制器可以访问所有集群范围内的 Secret。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者在一定条件下通过 Pod 网络实现远程代码执行。该漏洞存在于 Validating Admission Controller 中，允许攻击者注入任意 Nginx 指令。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该 POC 代码有效。搜索结果中提到存在公开可用的 RCE 漏洞利用，且POC代码直接关联了 `ingressnightmare`，对应了Wiz的研究成果，并针对反向shell、绑定shell以及命令执行提供了不同的模式。POC 代码针对 `ingress-nginx` 进行了漏洞利用。

**投毒风险：**

分析提供的 POC 代码，`/tmp/a8e962fb8838320afa4e94d5cf0cc187/cmd.go` 文件是主程序入口，定义了各种攻击模式（反向 shell，绑定 shell，命令执行），并根据用户选择的模式生成相应的 Nginx 配置，然后利用漏洞执行。代码中未发现明显的恶意代码或后门。`go.mod` 文件声明了项目依赖，属于正常。虽然不能100%保证没有隐藏的投毒代码（例如，对依赖包的供应链攻击），但从目前的代码来看，投毒可能性较低，大约 1%。这个可能性很低，主要是基于对直接提供的代码的分析，无法确定是否存在深层次的、隐藏的依赖关系投毒。

**利用方式：**

1.  **漏洞触发点：** 漏洞的核心在于 Ingress Nginx 的 Admission Controller 对 Nginx 配置的验证不严格，允许注入恶意的 Nginx 配置指令。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   利用工具(POC)构造包含恶意 Nginx 指令的 Ingress 资源。
    *   将构造的 Ingress 资源提交给 Kubernetes API Server。
    *   Admission Controller 接收到 Ingress 资源后，没有正确验证恶意指令，导致其被写入 Nginx 配置文件。
    *   Nginx 重新加载配置，执行恶意指令，实现 RCE。
3.  **利用方式：**
    *   **反向 Shell：** 攻击者可以利用该漏洞在 Ingress Nginx 容器内执行系统命令，反弹一个 shell 到攻击者控制的机器上，从而完全控制 Ingress Nginx。
    *   **绑定 Shell：** 攻击者在目标机器上绑定一个端口，通过连接该端口，可以获得 shell。
    *   **命令执行：** 攻击者可以执行任意命令，例如读取敏感文件（Secrets），修改系统配置等。

**项目地址:** [Esonhugh/nginxnightmare](https://github.com/Esonhugh/nginxnightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #6

**来源**: [CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md](../2025/CVE-2025-1974-Rickerd12_exploit-cve-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内的 Secrets 泄露和任意代码执行

**影响版本:** <=1.11.4 和 1.12.0

**利用条件:** 需要对 Pod 网络访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络访问权限，在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致 Secrets 泄露（默认安装可以访问整个集群的 Secrets）。

**利用方式：**

1.  **漏洞原理：** 该漏洞是由于 ingress-nginx 验证 Admission Controller 功能中的配置注入漏洞造成的，允许攻击者通过特制的 Ingress 资源绕过路径限制。
2.  **攻击步骤：**
    *   攻击者需要能够访问 Pod 网络。
    *   攻击者构造包含恶意配置的 Ingress 资源，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释。
    *   恶意配置通过 Admission Controller 被注入到 nginx.conf 中。
    *   通过精心构造的配置，攻击者可以加载恶意的动态链接库 (shell.so) 到 nginx 进程中，从而执行任意代码。
3.  **POC 分析：**
    *   `Makefile`：使用 Docker 构建 shell.so 动态链接库。
    *   `build.sh`：用于在 Alpine Linux 环境中编译 shell.so，确保其与 ingress-nginx 控制器的环境兼容 (musl-libc)。使用了国内镜像加速。
    *   `shell.c`（未提供，但根据 README 可知需要修改 IP 地址）：该文件包含恶意代码，通常是一个反弹 shell，用于在目标系统上建立连接。
    *   `exploit.py`：该 Python 脚本利用该漏洞。
        *   它首先读取 shell.so 的内容。
        *   然后，它循环遍历可能的 PID 和 FD 范围，猜测包含 nginx 配置文件的 /proc 文件路径。
        *   它构造包含恶意 `nginx.ingress.kubernetes.io/auth-url` 注释的 Ingress 资源，其中包含指向猜测的 /proc 文件路径的 `ssl_engine` 指令。当 Admission Controller 处理这个 Ingress 资源时，会将恶意配置注入到 nginx.conf 中，从而加载 shell.so。
        *   同时，它还尝试上传 shellcode 到一个URL，这个URL是需要预先部署的，目的是为了将shellcode写入到/proc/pid/fd/fd中去.这里存在竞争条件。
    *   `req.json`：包含 Ingress 资源的 JSON 模板，用于发送到 Admission Controller。
    *   `pyproject.toml`：Python 项目的依赖声明，需要 httpx 库。

**有效性：**

根据漏洞信息和 POC 代码分析，该 POC 代码是有效的，如果满足漏洞利用条件，可以成功实现远程代码执行。

**投毒风险：**

该仓库存在一定的投毒风险。具体如下：

*   `shell.c` 代码未提供，无法确认其功能是否超出反弹 shell 的范围。存在植入恶意后门的可能。
*   `exploit.py` 代码中 `upload()` 函数向外部 URL 上传 shellcode，这个 URL 如果被攻击者控制，可能导致上传恶意代码。
*   虽然使用了国内镜像源加速，但仍然存在被劫持的风险。

综合评估，投毒风险大约为 10%，主要是 `shell.c` 代码未知和 `upload()` 函数的潜在风险。

**项目地址:** [Rickerd12/exploit-cve-2025-1974](https://github.com/Rickerd12/exploit-cve-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---



---

## POC #7

**来源**: [CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md](../2025/CVE-2025-1974-Rubby2001_CVE-2025-1974-go.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secret泄露和任意代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个严重漏洞，CVSS评分为9.8，允许未经身份验证的攻击者在Pod网络中执行任意代码。该漏洞存在于Validating Admission Controller中，攻击者可以通过构造特定的Ingress资源，利用`nginx.ingress.kubernetes.io/auth-url`注解，将恶意代码注入到Ingress Controller的配置中，从而实现远程代码执行。

**有效性分析：**
从漏洞描述和搜索结果来看，该漏洞影响较大且真实存在。提供的POC代码旨在利用此漏洞。代码的主要流程是：

1.  **生成Shellcode:** `build.sh`脚本用于编译一个动态链接库`shell.so`，其中包含反向shell的shellcode。`Makefile` 使用 docker 来构建环境，保证了跨平台编译
2.  **上传Shellcode:** `main.go`中的`uploadShellcode`函数尝试将`shell.so`的内容上传到`ingress-nginx-controller`， 利用`slowReader`结构体来分片发送数据，可能是为了绕过某些限制。
3.  **构造恶意Ingress资源:** `main.go`构造了一个恶意的`AdmissionReview`对象，其中包含一个Ingress资源，该Ingress资源的`nginx.ingress.kubernetes.io/auth-url`注解被设置为一个包含文件路径的恶意字符串，该文件路径指向`/proc/<pid>/fd/<fd>`，通过遍历进程ID和文件描述符， 尝试利用Ingress Controller解析配置时的漏洞，加载恶意的`shell.so`到nginx worker进程中。
4.  **发送Admission请求:** `main.go`将构造的`AdmissionReview`对象发送到`ingress-nginx-controller-admission.ingress-nginx.svc:443`，触发Validating Admission Controller。

总体来看，POC代码具备一定的可行性。它尝试通过文件包含的方式执行shellcode。

**投毒风险分析：**
代码中存在潜在的投毒风险。

1.  `shell.c` 需要修改`server_ip`和`server_port`, 这个反向shell的IP和端口理论上可以是攻击者的服务器。如果用户不检查就直接编译和运行， 就会把受害者的信息泄露给攻击者，并留下后门，此概率为3%。
2.  `main.go`中的`targetURL`和`admissionURL` 都是写死的，需要用户自行更改， 但用户可能直接使用默认的，可能会导致POC无法正常工作, 此概率为2%.
3.  构建shellcode的docker镜像来自`alpine:latest`，如果dockerhub上的alpine镜像被篡改，可能导致构建的shellcode带有恶意代码。此概率为5%

综上，该仓库中存在一定的投毒风险，但主要是依赖于用户是否仔细检查和修改代码。总体评估，投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者首先需要位于受害者的Pod网络内，可以通过渗透其他Pod或利用其他网络漏洞实现。
2.  攻击者运行`main.go`，它将执行以下操作：
    *   构建包含反向shell的`shell.so`， 并上传到ingress-nginx-controller中。
    *   构造一个包含恶意`auth-url`注解的Ingress资源。
    *   将Ingress资源发送到Validating Admission Controller。
3.  Validating Admission Controller尝试创建Ingress资源，由于`auth-url`注解包含恶意代码，Ingress Controller在解析配置时会加载`shell.so`， 从而执行shellcode。
4.  `shellcode`连接到攻击者的服务器，攻击者获得对Ingress Controller的控制权。
5.  由于Ingress Controller通常具有较高的权限，攻击者可以访问集群内的所有Secret，甚至控制整个集群。

**项目地址:** [Rubby2001/CVE-2025-1974-go](https://github.com/Rubby2001/CVE-2025-1974-go)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #8

**来源**: [CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md](../2025/CVE-2025-1974-abrewer251_CVE-2025-1974_IngressNightmare_PoC.md)

## CVE-2025-1974_IngressNightmare

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** kubernetes ingress-nginx

**危害等级:** 高危，可能导致集群范围内的Secrets泄露和完全控制

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要对Pod网络的访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者，如果他们可以访问 Pod 网络，则可以在 ingress-nginx 控制器的上下文中实现任意代码执行。这可能导致泄露控制器可以访问的 Secrets（在默认安装中，控制器可以访问集群范围内的所有 Secrets）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。漏洞等级为严重，CVSS评分为9.8。多个安全厂商博客文章（例如sysdig、wiz、arcticwolf、fortinet）确认了该漏洞的存在，并将其描述为“IngressNightmare”，表明这是一个真实且危险的漏洞。

提供的PoC代码（`poc.py`和`poc.json`）旨在自动化利用该漏洞的过程。`poc.py` 脚本通过 `curl` 向目标 IP 地址列表发送包含 JSON payload 的 HTTPS POST 请求。它会捕获响应，并将结果分类为成功或失败，然后生成 XML 报告。

`poc.json` 文件包含一个 AdmissionReview 对象，该对象用于发送恶意配置到Validating Admission Controller。

**投毒风险分析：**
该PoC代码主要目的是发送恶意请求并记录响应，没有明显的恶意行为。但仍然存在一定的投毒风险，大约为5%。

*   `poc.py` 脚本可能会被修改为包含额外的恶意代码，例如，在成功利用漏洞后执行某些操作（例如，安装后门、删除日志等）。
*   `poc.json` 文件可能会包含更复杂的 payload，这些 payload 不仅利用 CVE-2025-1974，还试图利用其他潜在的漏洞。
*   脚本在处理IP列表时,如果没有做严格的过滤,可能会误导使用者攻击非授权的目标。

**利用方式：**
1.  **攻击者需要能够访问 Kubernetes 集群的 Pod 网络。**
2.  **攻击者使用 `poc.py` 脚本指定目标 IP 地址列表（即 ingress-nginx 控制器的 IP 地址）以及包含恶意 payload 的 `poc.json` 文件。**
3.  **`poc.py` 脚本向每个目标 IP 地址发送一个 HTTPS POST 请求，其中包含 `poc.json` 中的 AdmissionReview 对象。**
4.  **ingress-nginx 控制器中的 Validating Admission Controller 在处理恶意 AdmissionReview 对象时，由于存在漏洞，会允许攻击者执行任意代码。**
5.  **攻击者可以利用执行的代码来访问集群中的 Secrets 或执行其他恶意操作。**

**项目地址:** [abrewer251/CVE-2025-1974_IngressNightmare_PoC](https://github.com/abrewer251/CVE-2025-1974_IngressNightmare_PoC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #9

**来源**: [CVE-2025-1974-chhhd_CVE-2025-1974.md](../2025/CVE-2025-1974-chhhd_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内secrets泄露和远程代码执行

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络的权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个高危漏洞，允许未经身份验证的攻击者通过 pod 网络访问 ingress-nginx 控制器并执行任意代码。利用方式是通过向 Admission Controller 发送特制的 AdmissionReview 请求，注入恶意的 Nginx 配置，特别是利用 `nginx.ingress.kubernetes.io/auth-url` 注释，将 `ssl_engine` 指令指向一个可控的共享对象文件（.so）。

**利用方式：**
1.  **编译恶意共享对象（.so 文件）：** 该文件包含要执行的恶意代码，例如，反向 shell 或创建文件的指令。
2.  **构造恶意的 AdmissionReview 请求：**  `poc.py` 脚本用于生成包含恶意配置的 AdmissionReview 请求。关键在于 `nginx.ingress.kubernetes.io/auth-url` 注释，它会被注入恶意的 `ssl_engine` 指令，该指令指向一个位于 ingress-nginx 容器文件系统中的共享对象文件。
3.  **发送请求到 Admission Controller：**  将构造的 AdmissionReview 请求发送到 Admission Controller 的 admission 端点 (https://localhost:30443/networking/v1/ingresses)。因为 Admission Controller 没有进行充分的验证，恶意配置会被接受。
4.  **触发恶意代码执行：**  当 ingress-nginx 加载包含恶意代码的共享对象文件时，恶意代码会被执行。

**投毒风险分析：**

虽然主要代码展示了漏洞利用过程，但仍然存在小的投毒风险的可能性：

*   **依赖项风险：**`poc.py` 脚本依赖 `requests` 和 `urllib3` 库。如果这些库被恶意替换，可能会引入投毒代码。由于这些都是常见的库，这种可能性相对较低。
*   **`.so` 文件编译风险：** 编译 `.so` 文件的过程本身存在风险。如果攻击者控制了编译环境，他们可以在编译过程中植入恶意代码。但是，提供的 README 中明确指示了如何编译，降低了直接使用预编译文件的可能性。
*   **URL篡改风险：** `poc.py`代码中的URL地址存在被篡改的风险，可能导致用户连接到恶意的服务器上。

综合考虑，该仓库中作者直接隐藏的投毒代码风险较低，估计在 5% 左右。主要风险来自于对脚本依赖项和编译环境的潜在控制。


**项目地址:** [chhhd/CVE-2025-1974](https://github.com/chhhd/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #10

**来源**: [CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md](../2025/CVE-2025-1974-dttuss_IngressNightmare-RCE-POC.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes Ingress-NGINX 中的一个严重漏洞，允许未经身份验证的攻击者通过Pod网络利用配置注入实现远程代码执行。该漏洞存在于 Ingress-NGINX 的 Validating Admission Controller 组件中，该组件用于验证 NGINX 配置。攻击者可以利用该漏洞注入任意 NGINX 指令，例如 `content_by_lua_block`，通过配置片段 annotations (configuration-snippet, server-snippet 等)来执行恶意代码。成功利用此漏洞可能导致敏感信息泄露（例如集群 Secret），或者在具有足够权限的情况下完全控制 Kubernetes 集群。漏洞利用方式如下：

1.  **攻击者接入Pod网络：** 这是利用此漏洞的前提条件。
2.  **构造恶意Ingress资源：** 攻击者创建一个包含恶意配置片段（如configuration-snippet）的Ingress资源，其中包含要执行的恶意 Nginx 配置指令。
3.  **利用Validating Admission Controller：** 当创建或更新 Ingress 资源时，Validating Admission Controller 会验证 Nginx 配置。
4.  **代码执行：** 由于验证不充分，攻击者可以注入恶意的 Nginx 配置指令，从而在 Ingress 控制器 Pod 中执行任意代码。
5.  **权限提升和数据窃取：** 攻击者利用 Ingress 控制器的权限访问集群资源，如 Secrets，或者进一步控制整个集群。

PoC 代码表明该漏洞是可利用的，并且多个来源证实了其严重性。由于提供的PoC描述中提到仅供研究和教育目的，以及声明使用需要明确授权，因此存在潜在的法律风险。此外，该 PoC 可能被修改以包含额外的恶意功能，例如持久化后门或数据窃取工具，但从目前的代码来看，这种可能性较低，推测其存在投毒风险的可能性为10%。

**项目地址:** [dttuss/IngressNightmare-RCE-POC](https://github.com/dttuss/IngressNightmare-RCE-POC)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #11

**来源**: [CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md](../2025/CVE-2025-1974-hi-unc1e_CVE-2025-1974-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #12

**来源**: [CVE-2025-1974-iteride_CVE-2025-1974.md](../2025/CVE-2025-1974-iteride_CVE-2025-1974.md)

## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #13

**来源**: [CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-justmorpheus_IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可以通过 Pod 网络实现任意代码执行，可能导致集群范围内的 Secrets 泄露。

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要访问 Pod 网络

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中 Validating Admission Controller 组件的一个安全漏洞。未经身份验证的攻击者如果能够访问 Pod 网络，就可以利用此漏洞在 ingress-nginx controller 的上下文中执行任意代码。漏洞利用方式通常涉及注入恶意 Nginx 配置指令。这可能导致提取集群内所有 Secret 的权限。根据搜索结果，已经存在公开的 PoC 代码。

提供的代码片段是 GNU GPL v3 许可协议，本身不是漏洞利用代码，但可能被包含在完整的 PoC 中。由于只提供了许可证文件，无法直接判断 PoC 代码的有效性。

投毒风险评估：提供的代码片段是GPL v3许可协议，通常是开源项目的一部分，恶意代码不太可能直接嵌入到许可协议中。但是，完整的漏洞利用包（未提供）可能包含投毒代码，可能性较低，设为20%。

**项目地址:** [justmorpheus/IngressNightmare-CVE-2025-1974](https://github.com/justmorpheus/IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #14

**来源**: [CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md](../2025/CVE-2025-1974-m-q-t_ingressnightmare-detection-poc.md)

## CVE-2025-1974 - Ingress-nginx Admission Controller RCE Escalation

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，未经身份验证的攻击者可能在 Ingress Nginx 控制器的上下文中执行任意代码，导致泄露集群范围内的 Secrets。

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 攻击者需要能够访问 Pod 网络，并且目标系统正在运行受影响版本的 ingress-nginx，并且启用了 Validating Admission Controller。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是一个存在于 Kubernetes ingress-nginx 中的严重漏洞，攻击者可以通过注入恶意的 Nginx 配置指令来利用此漏洞。提供的 PoC 代码通过 `auth-url` 注释注入 `error_log` 指令，该指令会将日志发送到攻击者控制的 DNS 服务器。如果目标系统存在漏洞，Nginx 配置验证过程将尝试解析攻击者的 DNS 服务器，从而确认漏洞存在。该 PoC 仅用于检测漏洞是否存在，不会执行任意代码。

**漏洞利用方式：**

1.  **攻击者访问 Pod 网络：** 攻击者必须位于可以访问 Kubernetes 集群 Pod 网络的网络中。
2.  **注入恶意配置：** 攻击者利用 Ingress 资源的 annotation 功能，特别是 `nginx.ingress.kubernetes.io/auth-url`，注入恶意的 Nginx 配置指令。PoC 中注入的配置包括 resolver 和 error_log 指令。
3.  **触发配置验证：** 当 Admission Controller 处理包含恶意配置的 Ingress 资源时，它会尝试验证 Nginx 配置。
4.  **DNS 解析：** 在配置验证期间，Nginx 尝试解析恶意 `error_log` 指令中指定的攻击者控制的域名。
5.  **漏洞确认：** 攻击者通过监控其 DNS 服务器的日志来确认漏洞的存在，如果看到来自目标系统的 DNS 查询，则表明该系统易受攻击。

**投毒风险分析：**

提供的代码主要用于检测漏洞，并没有发现恶意代码。`detect.py` 脚本用于发送特制的 AdmissionReview 请求以触发 DNS 查询，以此来验证漏洞是否存在，该行为属于漏洞验证行为，不属于投毒。因此，该代码的投毒风险极低。

**项目地址:** [m-q-t/ingressnightmare-detection-poc](https://github.com/m-q-t/ingressnightmare-detection-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #15

**来源**: [CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md](../2025/CVE-2025-1974-rjhaikal_POC-IngressNightmare-CVE-2025-1974.md)

## CVE-2025-1974 Ingress-nginx 远程代码执行漏洞

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的密钥泄露和完全控制

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群部署了受影响版本的ingress-nginx，并启用了Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974 漏洞是 Kubernetes ingress-nginx 中的一个严重安全问题，攻击者通过在 Ingress 对象的 annotations 中注入恶意配置，利用 Validating Admission Controller 的缺陷，可以在 ingress-nginx 控制器的上下文中执行任意代码。

**有效性：**

根据漏洞信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。

*   漏洞库信息明确指出该漏洞允许未经身份验证的攻击者在满足特定条件下执行任意代码。
*   搜索结果中多个链接都将 CVE-2025-1974 描述为 critical 的远程代码执行漏洞，并给出了相关的缓解措施。
*   PoC代码提供了一个完整的利用链，包括编译shellcode、修改Ingress对象annotations，以及上传shellcode到目标 Pod。

**投毒风险：**

该仓库存在一定的投毒风险,虽然整体代码意图是为了验证漏洞，但也存在潜在的风险。

*   **Build脚本中的镜像源替换：**`build.sh`脚本将Alpine的默认镜像源替换为`mirrors.ustc.edu.cn`。虽然这通常是为了加速国内的构建过程，但如果镜像源被恶意篡改，可能引入恶意软件。但是这个镜像源为中科大的镜像源，风险较低。
*   **Shellcode上传的隐藏后门:** exploit.py通过upload函数持续向ingress-nginx-controller发送shellcode，并通过FakeIterator类中的asyncio.sleep函数维持连接。在真实利用场景中，攻击者可能会利用这个连接维持后门，或者植入更隐蔽的恶意代码。
*   **PoC的依赖风险：** PoC依赖 httpx 库。如果 httpx 库本身存在漏洞，或者恶意攻击者上传了同名的恶意库，那么在运行PoC时可能会受到攻击。
    
综合考虑，投毒风险较低，大约为5%。主要是镜像源和库的潜在风险。如果使用者对代码进行审查，可大幅降低投毒风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **准备 shellcode：** 攻击者需要首先编译一个 shellcode，该 shellcode 用于在目标系统上执行恶意操作。PoC 代码提供了 `shell.c` 文件，用于生成 shellcode。
2.  **构造恶意 Ingress 对象：** 攻击者创建一个恶意的 Ingress 对象，并在其 annotations 中注入恶意配置。具体来说，攻击者会修改 `nginx.ingress.kubernetes.io/auth-url` annotation，使其包含指向 `/proc/{pid}/fd/{fd}` 的路径，从而触发文件包含漏洞。
3.  **触发 Validating Admission Controller：** 当攻击者尝试创建或更新包含恶意配置的 Ingress 对象时，Validating Admission Controller 会对其进行验证。
4.  **利用文件包含漏洞执行 shellcode：** 由于 Ingress 对象的 annotations 中包含了恶意配置，当 nginx-ingress-controller 加载该 Ingress 对象时，会触发文件包含漏洞，从而执行攻击者上传的 shellcode。
5.  **上传 Shellcode:** 攻击者同时会向 `ingress-nginx-controller` 的一个虚假地址 (`/fake/addr`) 发送 shellcode，通过遍历进程ID和文件描述符，尝试将 shellcode 写入到 nginx 的配置文件中，实现代码执行。

总结来说，攻击者通过精心构造的 Ingress 对象，结合文件包含漏洞，最终在 ingress-nginx 控制器的上下文中执行任意代码，从而控制整个 Kubernetes 集群。

**项目地址:** [rjhaikal/POC-IngressNightmare-CVE-2025-1974](https://github.com/rjhaikal/POC-IngressNightmare-CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #16

**来源**: [CVE-2025-1974-salt318_CVE-2025-1974.md](../2025/CVE-2025-1974-salt318_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，允许未经身份验证的攻击者在ingress-nginx controller上下文中执行任意代码，可能导致集群范围内的Secret泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，未经身份验证的攻击者通过 Pod 网络访问，可以在 ingress-nginx 控制器的上下文中执行任意代码。该漏洞与 Validating Admission Controller 的功能有关。POC通过构造恶意的Ingress资源，特别是 `nginx.ingress.kubernetes.io/auth-url` 注释，利用路径遍历漏洞覆盖SSL引擎，实现RCE。漏洞利用代码中的`docker-compose.yml`文件用于快速搭建存在漏洞的环境，方便验证。`exploit.py` 脚本执行攻击， 通过fuzzing proc文件描述符，将恶意payload注入到nginx的配置中，导致远程代码执行。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞版本的 ingress-nginx 的 Kubernetes 环境（例如使用 `docker-compose.yml`）。
2.  **构造恶意Ingress资源：**  攻击者需要创建或更新一个Ingress资源，其中包含特制的 `nginx.ingress.kubernetes.io/auth-url` 注释。该注释包含一个指向本地文件系统的路径，该路径用于覆盖SSL引擎。
3.  **发送请求：**  将构造的Ingress资源发送到 Kubernetes API 服务器，触发 Validating Admission Controller 的验证流程。
4.  **路径遍历：**  利用路径遍历漏洞，覆盖  ingress-nginx  的SSL引擎。
5.  **远程代码执行：**  通过覆盖SSL引擎文件，实现远程代码执行。

**投毒风险分析：**

尽管提供的 POC 代码主要功能是漏洞利用，但仍存在一定程度的投毒风险，约为10%。主要体现在以下几个方面：

1.  **Shell 文件内容：** POC 中需要用户提供一个 shell 文件 (`shell_file`)，这个 shell 文件的内容是完全由攻击者控制的。如果用户使用了恶意 shell 文件，就可能导致受害者系统被植入后门、信息泄露等问题。
2.  **Payload执行:** PoC覆盖SSL引擎，恶意代码会被Ingress Controller加载并执行，执行时机和权限依赖于Ingress Controller的运行方式。若Ingress Controller以特权模式运行，危害更大。
3.  **潜在后门：**  作者可能在提供的脚本中添加了额外的功能，例如收集目标环境信息、留下隐蔽的后门等。虽然目前的代码没有明显体现，但需要保持警惕。

**项目地址:** [salt318/CVE-2025-1974](https://github.com/salt318/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #17

**来源**: [CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md](../2025/CVE-2025-1974-sandumjacob_IngressNightmare-POCs.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的Secret泄露和完全控制

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标集群运行受影响版本的ingress-nginx，并且启用Validating Admission Controller功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是一个影响Kubernetes ingress-nginx的严重漏洞，CVSS评分为9.8。未经身份验证的攻击者只要能够访问Pod网络，就能利用此漏洞在ingress-nginx控制器上下文中执行任意代码。这可能导致泄露控制器可访问的所有Secret（默认情况下，这可能是整个集群）。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞允许通过向Validating Admission Controller注入恶意配置来执行任意代码，漏洞利用代码仓库中包含了一个yaml文件用于部署ingress-nginx的rbac角色，和一个example-ingress.yaml描述了一个简单的ingress资源，证明该poc是存在的。由于该poc发布在wiz博客之前，因此poc本身可能已经过时，但是漏洞的利用逻辑应该仍然适用。

**投毒风险评估：**

仓库中包含的YAML文件（`ingress-nginx-controller.yaml`）定义了ingress-nginx控制器的角色和权限，创建ServiceAccount，Role，ClusterRole等资源。这些配置看起来是正常的ingress-nginx controller部署所需的，没有明显的恶意代码。`example-ingress.yaml` 文件定义了一个简单的ingress，没有可疑之处。

但是，仍然存在一定的投毒风险：
*   **依赖项投毒：** 虽然目前的代码没有直接的恶意行为，但是该POC可能依赖于其他外部组件或者镜像，这些组件或者镜像可能被投毒。例如，yaml文件引用的镜像可能包含恶意代码。
*   **未来更新：** 仓库维护者可能会在未来提交包含恶意代码的更新。
*   **供应链攻击：** 仓库本身可能被攻击者控制，导致被篡改。

综合考虑，投毒风险较低，估计为10%。

**利用方式分析：**

1.  **攻击者需要访问Pod网络。**
2.  **攻击者利用漏洞，向Validating Admission Controller 注入恶意配置，这些恶意配置能够执行任意代码。**
3.  **利用执行的代码访问敏感信息，例如Secret。**

总而言之，该漏洞的利用涉及利用Admission Controller中的缺陷来注入恶意配置，从而在受害者的集群中执行代码。缓解措施包括禁用Validating Admission Controller功能或升级到不受影响的版本。

**项目地址:** [sandumjacob/IngressNightmare-POCs](https://github.com/sandumjacob/IngressNightmare-POCs)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #18

**来源**: [CVE-2025-1974-tuladhar_ingress-nightmare.md](../2025/CVE-2025-1974-tuladhar_ingress-nightmare.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #19

**来源**: [CVE-2025-1974-yanmarques_CVE-2025-1974.md](../2025/CVE-2025-1974-yanmarques_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #20

**来源**: [CVE-2025-1974-yoshino-s_CVE-2025-1974.md](../2025/CVE-2025-1974-yoshino-s_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可能导致集群范围内Secrets泄露和任意代码执行

**影响版本:** <=1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974是Kubernetes ingress-nginx中的一个高危漏洞，允许未经身份验证的攻击者在特定条件下通过Pod网络实现ingress-nginx控制器上下文中的任意代码执行。漏洞出现在Validating Admission Controller组件中，由于不正确的配置验证导致。利用方式如下：

1.  **漏洞原理：** 攻击者能够通过修改Ingress对象的annotation，注入恶意的nginx配置。具体来说，可以利用`nginx.ingress.kubernetes.io/auth-url`等annotation，将`ssl_engine`指令指向攻击者可控的文件，从而执行任意代码。
2.  **利用步骤：**
    *   **构建恶意so文件：**  使用提供的`Makefile`和`build.sh`脚本，编译一个包含反弹shell的共享对象(`shell.so`)。需要修改`shell.c`中的IP地址为攻击者控制的IP。
    *   **上传so文件：**  `exploit.py`脚本启动多个协程，将编译好的`shell.so`文件通过HTTP POST请求发送到`/fake/addr`地址。这个地址实际上并不重要，重要的是将恶意so文件写入到ingress-nginx controller的某个可预测的位置。
    *   **触发漏洞：**  `exploit.py`脚本同时向admission controller发送包含恶意annotation的Ingress创建请求。请求中的annotation会包含指向`/proc/<pid>/fd/<fd>`的文件路径，其中`<pid>`和`<fd>`会被循环遍历，尝试找到上传的`shell.so`文件。恶意annotation利用nginx的`ssl_engine`指令加载并执行`shell.so`。
    *   **获取Shell：** 如果成功，ingress-nginx controller会加载并执行`shell.so`，从而建立反弹shell。

3.  **有效性：** 根据提供的漏洞信息、搜索结果以及漏洞利用代码，该POC代码有效，可以实现远程代码执行。

4.  **投毒风险：** 虽然POC的主要目的是漏洞利用，但代码中存在潜在的投毒风险。例如：
    *   **`build.sh`中的镜像源替换：**  将`dl-cdn.alpinelinux.org`替换为`mirrors.ustc.edu.cn`，虽然目的是加速构建过程，但也可能引入恶意软件，如果ustc的镜像源被污染。
    *   **`shell.c`中的IP地址：**  攻击者可能会在`shell.c`中预设一个由其控制的IP地址，导致其他使用者在不知情的情况下将shell反弹给攻击者。但这更像是后门，而非投毒，因为使用者需要显式地构建并使用该shell.so
    *   **`exploit.py`中的目标地址硬编码：**  脚本中的`admission_url`和`url`地址是硬编码的，可能在某些环境下不适用。如果攻击者有意误导，可能导致利用失败。

    综合来看，投毒风险较低，约为10%。主要风险在于构建环境和shell.so本身可能被篡改。

**项目地址:** [yoshino-s/CVE-2025-1974](https://github.com/yoshino-s/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #21

**来源**: [CVE-2025-1974-zulloper_CVE-2025-1974.md](../2025/CVE-2025-1974-zulloper_CVE-2025-1974.md)

## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 高危，可导致集群范围内的Secrets泄露和任意代码执行

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过访问 Pod 网络在 ingress-nginx 控制器的上下文中执行任意代码。漏洞位于 Validating Admission Controller 中，攻击者可以通过构造特制的 Ingress 对象，向 webhook 发送恶意负载，从而绕过验证并注入恶意配置到 Nginx 中。利用链如下：

1.  **环境准备:** 设置 Kubernetes 集群并部署受影响版本的 ingress-nginx controller。
2.  **端口转发:** 将 ingress-nginx pod 的 80 端口（HTTP）和 8443 端口（Webhook）转发到本地端口，例如 8888 和 1337。
3.  **恶意共享对象准备:** 编译一个共享对象（.so 文件），其中包含反向 shell 代码。需要根据目标环境的架构进行交叉编译。
4.  **构造 AdmissionReview 请求:**  创建一个 AdmissionReview 请求，该请求包含一个恶意的 Ingress 对象，该对象利用 `nginx.ingress.kubernetes.io/auth-url` 注解注入恶意 Nginx 指令。`admission_test.yml` 和 `admission_review_req_body.json` 文件用于构建此请求。关键在于`PAYLOAD` 字段，此处会被替换成恶意指令。
5.  **上传恶意共享对象:**  使用 `exploit.py` 脚本将编译好的共享对象上传到 ingress-nginx controller 可以访问的位置。该脚本通过向转发的 8888 端口发送 POST 请求来实现上传。Content-Length 设置为 1000000 允许上传较大的so文件
6.  **触发恶意代码执行:**  通过向 webhook 发送包含恶意 Ingress 对象的 AdmissionReview 请求，触发 Validating Admission Controller 的处理。控制器将执行 Ingress 对象中注入的恶意 Nginx 指令，导致共享对象被加载，从而执行反向 shell 代码。
7.  **获得反向 Shell:** 攻击者使用 `nc -lv 4444` 监听指定端口，一旦恶意代码执行，将建立反向 shell 连接。

**有效性评估：**
提供的 POC 代码看起来是有效的，它详细描述了如何利用该漏洞进行远程代码执行。该 POC 包括了环境设置，恶意共享对象编译，构建 AdmissionReview 请求，上传恶意共享对象以及触发代码执行的完整步骤。

**投毒风险评估：**
代码中存在微小的投毒风险，可能性约为 1%。 主要集中在以下几个方面：

*   **共享对象中的反向 Shell:** 反向 shell 本身可以被视为后门，但这是漏洞利用的必要组成部分，不算作投毒。
*   **潜在的恶意指令注入：** 如果 `exploit.py` 中用于生成 Ingress 对象的代码被修改，可能会注入其他恶意指令，超出反向 shell 的范围。不过，从提供的代码来看，并没有明显的迹象表明存在此类行为。

总体而言，该 POC 的主要目的是演示漏洞利用，而不是植入恶意后门。因此，投毒的风险较低。

**项目地址:** [zulloper/CVE-2025-1974](https://github.com/zulloper/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

## POC #22

**来源**: [CVE-2025-1974-zwxxb_CVE-2025-1974.md](../2025/CVE-2025-1974-zwxxb_CVE-2025-1974.md)

## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)

---

