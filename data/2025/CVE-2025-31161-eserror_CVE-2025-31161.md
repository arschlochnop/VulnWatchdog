## CVE-2025-31161 - CrushFTP 身份验证绕过 (Authentication Bypass)

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过 (Authentication Bypass)

**影响应用:** CrushFTP

**危害等级:** 高危

**CVSS评分:** 待定

**影响版本:** 未披露

**利用条件:** 无需认证，可通过网络远程访问，Web接口开放

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 0%

## 详情

CVE-2025-31161是一个针对CrushFTP服务器的严重身份验证绕过漏洞。CrushFTP是一款流行的企业级文件传输服务器软件。该漏洞允许未经身份验证的远程攻击者，在无需提供有效凭据的情况下，通过利用特定的畸形请求绕过CrushFTP的认证机制，进而获得对系统的未授权访问，甚至创建新的管理用户，从而完全控制受影响的CrushFTP服务器。这种类型的漏洞通常具有极高的危害性，因为它直接破坏了系统的安全边界，使得攻击者能够绕过所有预设的安全控制。

**POC有效性分析：**
本分析所依据的POC代码是一个使用Go语言编写的完整利用工具，名为`exploit`。该工具的设计目标是自动化执行CVE-2025-31161的整个利用链，其核心功能分为两个主要阶段：首先执行身份验证绕过，然后利用绕过后的有效会话创建新的管理员用户。
1.  **身份验证绕过机制：** POC通过向CrushFTP服务器的`/WebInterface/function/?command=getUserList`路径发送一个精心构造的GET请求来启动攻击。这个请求包含一个畸形的`Authorization`头部（模仿AWS4签名，但故意构造不完整，如`AWS4-HMAC-SHA256 Credential=crushadmin/`）和一个伪造的`CrushAuth` cookie。CrushFTP在处理这类头部和cookie组合时存在逻辑缺陷，未能正确验证其有效性，从而误认为请求是合法的。服务器因此返回一个包含有效会话cookie的响应，POC会解析并提取这个新的`CrushAuth`会话cookie，用于后续的特权操作。
2.  **创建新管理员用户：** 在成功获取到有效会话cookie之后，POC会利用这个会话发送一个POST请求到CrushFTP的`UserAdmin`功能接口。该请求的目的是在CrushFTP服务器上创建一个全新的管理员账户。POC在构建请求时，会设置新用户的用户名、密码，并赋予其最高管理权限，包括`(read)(write)(delete)(view)(makedir)(rename)(share)(resume)(properties)(admin)`。这意味着一旦攻击成功，攻击者将拥有对CrushFTP服务器的完全管理控制权，能够执行任何操作。
POC代码结构清晰，使用了Go语言的标准库，没有引入复杂的外部依赖。整个利用链从认证绕过到最终创建管理员用户都得到了完整实现，充分证明了该漏洞的严重性和可利用性。

**利用步骤：**
利用此POC工具攻击CrushFTP服务器的步骤如下：
1.  **环境准备：** 确保已安装Go语言编译环境。下载或克隆POC代码仓库到本地系统。
2.  **编译POC：** 导航至POC代码所在的目录，执行`go build -o exploit`命令，生成可执行文件`exploit`。
3.  **执行攻击：** 在命令行中运行以下命令，替换`[target_ip_or_hostname]`、`[port]`、`[crushadmin_user]`（一个存在于目标系统的用户名）、`[new_admin_username]`和`[new_admin_password]`为实际目标信息和您希望创建的新管理员账户凭据。
    ```bash
    ./exploit -target http://[target_ip_or_hostname]:[port] -user [crushadmin_user] -action create-admin -new-admin-user [new_admin_username] -new-admin-pass [new_admin_password]
    ```
    *   `-target`: 目标CrushFTP服务器的完整URL和端口。
    *   `-user`: 目标CrushFTP系统中存在的用户名（如`crushadmin`）。
    *   `-action`: 执行的操作，`create-admin`用于创建新的管理员用户。
    *   `-new-admin-user`: 新管理员账户的用户名。
    *   `-new-admin-pass`: 新管理员用户的密码。
4.  **验证：** 攻击成功后，POC工具会输出成功信息。攻击者随后可以使用新创建的管理员账户登录CrushFTP Web界面，验证是否已获得完整的管理员权限。

**投毒风险分析：**
对该Go语言POC代码的彻底审查显示，其投毒风险评估为极低，接近于0%。
1.  **代码透明度与可审计性：** 该POC代码完全开源、未经任何混淆处理。其逻辑清晰，所有的网络请求和功能都一目了然。这使得任何具备Go语言基础的分析师都能轻松审查其所有功能和行为，从而排除隐藏恶意载荷的可能性。代码专注于实现CVE-2025-31161的利用过程，没有包含任何额外的恶意载荷、后门代码或非预期的数据泄露行为。
2.  **依赖性分析与供应链风险：** 该POC主要依赖Go语言的标准库（如`net/http`、`crypto/hmac`、`crypto/sha256`等），这些库都是由Go官方维护且经过广泛社区审查的，具有很高的安全性。它没有引入任何可疑的第三方库或外部脚本，显著降低了通过供应链攻击植入恶意代码的风险。
3.  **行为分析与网络通信：** POC的所有外部网络通信仅限于用户在命令行中明确指定的目标CrushFTP服务器。它不会向任何其他预设的IP地址或域名发送数据，也不会尝试下载并执行任何外部内容。其网络请求严格限定在漏洞利用所需的HTTP/HTTPS流量范围内。
4.  **资源消耗与系统影响：** 在执行过程中，该POC不会消耗异常的系统资源（如CPU、内存或网络带宽），也不会进行分布式拒绝服务（DDoS）攻击。其运行旨在一次性完成漏洞利用，而非持续驻留或破坏目标系统。
尽管该特定的POC代码本身是“干净”的，不含恶意软件，但作为一项普遍的安全原则，任何漏洞利用代码都可能被恶意行为者修改或包装，以包含恶意功能。因此，组织在获取和使用任何第三方POC时，仍然强烈建议进行独立的安全性审查，包括全面的代码审计和在隔离沙盒环境中的行为测试，以防范潜在的投毒风险。就当前提供的代码而言，其作为合法防御性安全研究工具的性质是明确的，可以直接用于验证漏洞，投毒风险评估为0%。

**项目地址:** https://github.com/TX-One/CVE-2025-31161

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-31161
