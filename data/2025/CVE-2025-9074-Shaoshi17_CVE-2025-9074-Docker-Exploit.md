## CVE-2025-9074 - Docker Desktop (Windows/Linux/macOS) 未授权访问 / 访问控制不当

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问 / 访问控制不当

**影响应用:** Docker Desktop (Windows/Linux/macOS)

**危害等级:** 高危 (CRITICAL)

**CVSS评分:** 9.0 (预估)

**影响版本:** 2025年8月修复版本之前的 Docker Desktop，特别是使用 WSL 2 后端的 Windows 版本

**利用条件:** 攻击者需在受害者 Docker 环境中运行一个恶意的 Linux 容器，或利用已攻陷的容器作为跳板

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

CVE-2025-9074 是 Docker Desktop 容器隔离机制中的一个严重漏洞。该漏洞源于 Docker Desktop 的默认配置允许本地运行的 Linux 容器通过特定的虚拟网关地址（通常为 192.168.65.7）直接访问宿主机上的 Docker Engine API。由于该接口默认处于未授权状态，恶意容器可以利用此路径直接向 Docker 守护进程发送指令。该漏洞在 Windows 环境下配合 WSL 2 后端时表现尤为突出，因为它打破了容器与宿主机、容器与容器之间的安全隔离边界。通过对提供的 Python POC 代码分析，该脚本展示了极高的有效性：它能够自动定位 Docker API 地址，枚举宿主机上所有正在运行的容器，并支持在任意容器中执行特权命令、管理镜像或创建新容器。POC 中包含了一个关键的路径规范化函数 `normalize_host_path`，这表明攻击者已经深入研究了 Windows 宿主机文件系统在 Docker 中的映射规则（如 /mnt/host/c），意味着攻击者可以通过创建挂载宿主机根目录的新容器，实现从容器环境到宿主机系统的完全逃逸。利用步骤如下：首先在受害者的 Docker 环境中启动一个简单的恶意容器；其次，在容器内运行此类渗透脚本，探测 192.168.65.7:2375 端口；一旦建立连接，通过 API 调用启动一个带有 `--privileged` 标志且挂载了宿主机磁盘（/）的新容器；最后，通过新容器访问宿主机敏感文件（如 /etc/shadow 或 Windows 注册表）完成攻击。关于投毒风险分析，该 POC 代码虽然包含了执行特权命令的功能，但其逻辑结构清晰，使用了标准的 Python 库如 requests 和 argparse，并未发现明显的混淆、恶意后门植入或对外部恶意域名的异常请求。脚本中的 `check_dependencies` 和路径处理逻辑显示这是一个专业、规范的安全研究工具。投毒风险较低，主要风险在于该 POC 如果被直接分发，其强大的容器操作能力可能被恶意用户用于构建自动化的容器蠕虫。防御者应重点关注内网中对 2375 端口的异常访问记录，并确保 Docker Desktop 已升级至 2025 年 8 月以后的版本，该版本已默认禁用了此类跨网段的 API 访问许可。

**项目地址:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
