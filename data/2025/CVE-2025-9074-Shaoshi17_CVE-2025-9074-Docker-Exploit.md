## CVE-2025-9074 - Docker Desktop 容器逃逸/权限提升/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/权限提升/未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS < 4.44.3

**利用条件:** 需要本地运行的恶意Linux容器；容器内可直接访问默认子网(192.168.65.7:2375)上的Docker Engine API；无需额外挂载

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

本漏洞POC为一个名为`CVE-2025-9074-docker-exploit.py`的Python脚本，旨在利用Docker Desktop中的容器越权访问漏洞（CVE-2025-9074），实现容器逃逸并最终控制宿主机。该漏洞允许在本地运行的恶意Linux容器绕过隔离机制，直接通过默认子网地址（192.168.65.7:2375）访问宿主机的Docker Engine API，从而获得对Docker守护进程的完全控制权。

**POC有效性分析：**
该Python脚本展现出高度的实用性和有效性。它利用了`requests`库进行HTTP通信，精确地指向了被暴露的Docker Engine API端点`http://192.168.65.7:2375`，这一地址与漏洞描述中的攻击向量完全吻合。脚本结构清晰，使用了`argparse`模块来处理命令行参数，使得工具的使用具有良好的灵活性。它包含`check_dependencies`函数，确保运行环境具备必要的`docker`库，提高了脚本的健壮性。

一个显著的特点是`normalize_host_path`函数，它专门用于处理Windows Docker Desktop环境中的宿主机路径映射。例如，`D:\temp`会被规范化为`/mnt/host/d/temp`。这个功能对于在容器逃逸后，从攻击者的视角正确地访问和操作宿主机文件系统至关重要，是实现彻底宿主机控制的关键一步，直接验证了漏洞的深度影响。脚本中还提供了`get_containers`功能，可以列出所有运行中的容器，以及`execute_command`功能，允许在指定容器内执行命令。虽然`execute_command`代码被截断，但其功能名称和参数设置表明它能够实现对容器内部的命令执行，这在获得Docker API访问权限后，可用于创建特权容器或在现有容器中进行进一步的利用操作。综合来看，该POC功能完整，结构严谨，能够有效演示并利用CVE-2025-9074漏洞，实现容器逃逸并潜在地完全控制Windows或macOS上的Docker Desktop宿主机。

**利用步骤：**
1.  **初始立足点：** 攻击者首先需要获得运行在Docker Desktop环境中的某个Linux容器的访问权限，即在该容器内能够执行任意代码。这通常可以通过利用容器内运行的应用程序漏洞实现。
2.  **访问Docker API：** 从已被入侵的恶意容器内部，攻击者运行该POC脚本。该脚本利用CVE-2025-9074漏洞，直接向宿主机默认子网上的Docker Engine API（`http://192.168.65.7:2375`）发起未经授权的请求。
3.  **控制Docker守护进程：** 由于漏洞的存在，恶意容器能够绕过隔离，与宿主机上的Docker守护进程直接通信，并获得其控制权。攻击者可以使用该POC的`get_containers`功能列出所有在宿主机上运行的容器。
4.  **宿主机接管：** 攻击者进一步利用获得的Docker API权限，可以执行以下操作以实现宿主机接管：
    *   创建新的特权容器，并挂载宿主机的根文件系统（例如，`docker run -v /:/host --privileged ...`）。POC中的`normalize_host_path`功能有助于正确设置这些挂载点。
    *   通过新的特权容器或利用现有的可控容器，在宿主机上执行任意命令（例如，使用`docker exec`或在挂载的宿主机文件系统上直接操作文件）。
    *   建立反向shell，窃取敏感数据，或安装持久性后门，从而完全控制运行Docker Desktop的宿主机系统。

**投毒风险分析：**
对于提供的`CVE-2025-9074-docker-exploit.py`这个POC代码，其投毒风险评估为**低（10%）**。分析基于以下几个关键因素：

1.  **代码清晰度与可读性：** 脚本采用Python编写，代码结构清晰，函数命名规范，逻辑直观。没有发现任何混淆、加密字符串或难以理解的恶意代码片段。所有的功能，如依赖检查、URL修正、路径规范化以及Docker API交互，都直接服务于漏洞的利用目的，没有额外的、与漏洞利用无关的功能。

2.  **依赖项管理：** 脚本通过`check_dependencies`函数明确检查了对`docker`库的依赖，并提示用户安装。除了`docker`库，脚本仅使用了`requests`、`sys`、`json`、`argparse`、`os`、`signal`、`socket`、`platform`和`threading`等Python标准库。这些都是常见且信誉良好的库，没有引入未知或可疑的第三方模块。

3.  **网络行为：** 脚本的网络通信主要集中在与`http://192.168.65.7:2375`这个明确的Docker Engine API端点进行交互。没有证据表明该脚本会发起与外部（非Docker API）的、未经授权的或隐蔽的连接请求，例如连接到C2服务器、下载恶意载荷或泄露数据到第三方服务器。其网络行为完全符合利用Docker API的需求。

4.  **文件系统操作：** `normalize_host_path`函数虽然处理宿主机路径，但其目的是为了辅助漏洞利用，以便正确地在宿主机上进行文件系统操作（例如，通过挂载宿主机目录实现进一步的访问），而不是在POC自身运行的系统上偷偷创建或修改文件。脚本本身没有包含在运行环境中植入后门、写入恶意文件或修改系统配置的非预期代码。

5.  **行为模式：** 整个脚本的执行流程和功能设计都围绕着CVE-2025-9074漏洞的特性展开，旨在证明和利用容器与宿主机Docker API之间的隔离失效。其行为符合一个合法漏洞利用工具的预期，而不是一个隐藏了额外恶意功能的投毒样本。

综上所述，虽然任何漏洞利用代码在不隔离的环境中运行都存在固有风险，但该POC代码本身表现出良好的安全实践和透明度，未发现明显的投毒迹象。在受控的沙盒环境中进行分析和测试，可以有效地评估其功能而无需担心意外的恶意行为。

**项目地址:** 

**漏洞详情:** 
