## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问 (Container Escape/Privilege Escalation)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问 (Container Escape/Privilege Escalation)

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3 (Windows and macOS)

**利用条件:** 攻击者需在本地运行恶意Linux容器，通过内部网络直接访问宿主机的Docker Engine API (默认地址192.168.65.7:2375)，无需认证，可绕过隔离机制，实现宿主机接管。

**POC 可用性:** 8

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是一个影响Docker Desktop应用程序（包括Windows和macOS版本）的高危安全漏洞。该漏洞允许本地运行的恶意Linux容器绕过Docker的隔离机制，直接通过默认子网（192.168.65.7:2375）访问宿主机的Docker Engine API。一旦恶意容器获得对Docker Engine API的完全控制，攻击者便可以在宿主机上执行任意操作，从而实现对整个主机的完全接管。此漏洞的CVSS评分高达9.3，表明其严重性极高。Docker官方已于2025年8月20日在Docker Desktop 4.44.3版本中修复了此漏洞，因此所有低于此版本的Docker Desktop用户均受影响。

**POC有效性分析:**
提供的POC代码是一个名为`CVE-2025-9074-docker-exploit.py`的Python脚本，旨在利用Docker Desktop的容器越权访问漏洞。该POC的核心功能是直接与宿主机的Docker Engine API进行交互，验证了漏洞描述中“直接访问Docker Engine API”的关键特性。脚本硬编码了`DOCKER_API = "http://192.168.65.7:2375"`，这与漏洞预警中提及的默认子网和端口一致，是漏洞利用的直接入口。脚本依赖于`requests`、`json`、`argparse`等标准Python库，以及`docker`和`websocket-client`这两个与Docker API交互常用的第三方库，`check_dependencies()`函数明确提示了这些依赖，增强了脚本的透明度和可用性。

`normalize_host_path()`函数在POC中扮演着关键角色，它专门处理Windows Docker Desktop下的宿主机路径映射规则（例如，将`D:\`转换为`/mnt/host/d`）。这一设计强烈表明，攻击者在获得Docker Engine API访问权限后，期望能够创建并运行新的容器，并将宿主机的任意文件系统路径（包括根目录）挂载到新容器中。通过这种方式，恶意容器能够直接读写宿主机上的文件，甚至通过`chroot`等技术在宿主机环境中执行命令，从而实现完全的宿主机控制。`get_containers()`函数通过`GET /containers/json`获取运行中的容器列表，这对于攻击者进行侦察和选择目标容器至关重要。尽管`execute_command()`函数在提供的代码片段中被截断，但其存在进一步说明了POC意图在获取API控制权后，执行后续的攻击操作。结合漏洞描述中提及的“主机接管”能力，一个拥有Docker Engine API完全访问权限的恶意容器，可以通过API调用如`/containers/create`并配置`Binds`参数，将宿主机根目录（`/`）挂载到容器内部，从而实现对宿主机文件系统的完全控制。因此，即使POC代码不完整，其核心组件已充分展示了利用此漏洞并导致严重后果的潜力，其有效性基础已被验证。

**利用步骤:**
1.  **初始立足点**: 攻击者首先需要设法在受害者的Windows或macOS系统上运行一个恶意的Linux容器。这可以通过多种方式实现，例如社会工程学诱骗用户运行恶意镜像，或通过供应链攻击植入恶意容器镜像。
2.  **执行POC**: 一旦恶意容器成功运行，攻击者在该容器内部执行此POC脚本。
3.  **API访问**: POC脚本利用Docker Desktop中存在的越权访问漏洞，直接向宿主机暴露的Docker Engine API（默认地址`192.168.65.7:2375`）发送未授权的HTTP请求。由于漏洞允许绕过隔离，这些请求将被宿主机上的Docker Engine接受。
4.  **侦察与特权提升**: 脚本可以调用`/containers/json`等API接口，列出所有运行中的容器，进行环境侦察。更关键的是，通过对Docker Engine API的完全控制，攻击者可以发起`/containers/create`请求，创建一个全新的、特权级更高的容器。在创建新容器时，攻击者可以利用`normalize_host_path`函数中体现的路径映射知识，通过设置`Binds`参数，将宿主机的任意目录（例如，宿主机的整个根文件系统`/`，对于Windows系统则可能是`/mnt/host/c`等）挂载到新创建容器的某个路径下。
5.  **宿主机控制**: 在新创建的、挂载了宿主机文件系统的容器内部，攻击者可以利用`chroot`等命令切换到宿主机的根目录，从而可以在宿主机的文件系统上执行任意命令。这意味着攻击者可以安装恶意软件、修改系统配置、窃取敏感数据、创建新的用户账户，或者完全破坏宿主机系统，实现全面的主机接管。

**投毒风险分析:**
该POC代码的投毒风险评级为低（10%）。

1.  **代码清晰度与可读性**: 脚本使用Python编写，代码结构清晰，变量和函数命名规范，逻辑流程易于理解。代码中没有发现明显的混淆、加密或难以解析的模块，这使得安全研究人员能够相对容易地审计其功能和意图。高透明度是降低投毒风险的关键因素。
2.  **依赖项**: 脚本所依赖的库，如`requests`、`json`、`argparse`以及专门用于Docker交互的`docker`和`websocket-client`，都是Python生态系统中广泛使用且经过充分审查的标准或准标准库。脚本通过`check_dependencies()`函数明确提示并要求用户安装这些库，这种透明的依赖管理方式进一步降低了通过隐蔽依赖引入恶意组件的风险。
3.  **外部连接与通信**: POC的核心功能是向`192.168.65.7:2375`这一硬编码的本地Docker Engine API端点发送HTTP请求，这是利用此漏洞所必需的通信。在提供的代码片段中，没有发现任何向外部（非本地或非预期）服务器、IP地址或URL发送数据、下载额外脚本、执行远程命令或建立反向shell等可疑的网络连接行为。所有网络活动都严格限定在漏洞利用的预期范围内。
4.  **恶意行为排除**: 脚本的唯一目的是演示和利用Docker Desktop的容器越权访问漏洞，以实现对宿主机Docker Engine API的未授权访问和潜在的宿主机接管。虽然这一利用行为本身具有高度破坏性，但它属于漏洞利用范畴，而非POC代码中包含额外恶意载荷（即“投毒”）的表现。代码中未发现诸如删除用户文件、加密数据、植入加密货币挖矿程序、记录键盘输入等超出漏洞利用目的的额外恶意功能。

综上所述，该POC代码表现出高透明度、标准化的依赖管理、以及专注于单一漏洞利用目标的特性，缺乏任何额外可疑的外部通信或隐蔽的恶意载荷，因此被评估为投毒风险较低的合法安全研究工具。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
