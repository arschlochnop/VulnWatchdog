## CVE-2025-9074 - Docker Desktop (Windows & macOS) 未授权访问/容器逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问/容器逃逸

**影响应用:** Docker Desktop (Windows & macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3

**影响版本:** Docker Desktop 4.34.0 之前版本

**利用条件:** 攻击者需在受影响的 Docker Desktop 宿主机上运行一个 Linux 容器；容器内需具备访问默认网关子网的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞源于 Docker Desktop 的网络隔离机制存在严重缺陷。在受影响的版本中，Docker Engine API 默认在宿主机内部接口（通常为 192.168.65.7:2375）上监听，且未配置鉴权。本 POC 代码通过 Python 的 requests 库和 docker-py 库，直接向该内部网关地址发起请求。代码展示了完整的攻击链路：首先，利用 get_containers 函数验证 API 连通性并获取当前宿主机上所有容器的列表；其次，normalize_host_path 函数揭示了攻击者如何利用 Docker Desktop 在 Windows/macOS 上的路径映射特性（如 /mnt/host/c）来定位宿主机文件系统。最为关键的是，POC 尝试调用 Docker API 创建一个新的特权容器或挂载宿主机根目录，从而实现从受限容器到宿主机的逃逸。经分析，该 POC 逻辑清晰，利用了 Docker API 的标准功能（如 /containers/create, /exec），在存在漏洞的环境中具有极高的成功率。由于 Docker Engine API 具有对 Docker 守护进程的完全控制权，一旦访问成功，攻击者可以执行任何 Docker 命令，包括读取、修改宿主机文件，或启动具有宿主机权限的 shell，从而彻底破坏沙箱隔离。【利用步骤】1. 在 Docker Desktop 环境中启动一个基础 Linux 容器（如 Ubuntu 或 Alpine）。2. 在容器内部环境部署此 Python 脚本。3. 脚本首先探测 192.168.65.7:2375 接口，如果返回 200 OK，则证明 API 可被未授权访问。4. 使用脚本枚举宿主机上的容器信息，确认攻击环境。5. 调用 API 创建一个挂载了宿主机根目录（/）的恶意容器。6. 通过 chroot 或直接访问挂载点，获取宿主机敏感文件（如 SSH 密钥、凭据等）或执行系统命令。【投毒风险分析】该 POC 代码主要使用了 Python 标准库（requests, json, os, re）和第三方 docker 库，代码结构透明，逻辑直接，未见明显的混淆或恶意后门植入。脚本中的 DOCKER_API 变量指向的是 Docker Desktop 特定的内部网关 IP，这符合漏洞利用的真实场景。虽然脚本具有强大的破坏性（能够操作容器和文件），但其行为与漏洞验证的目的高度一致。投毒风险较低，约 15%，主要风险点在于若该脚本被集成到自动化扫描工具中，可能会被误用。代码中 normalize_host_path 函数对 Windows 路径的转换逻辑非常专业，显示出开发者对 Docker Desktop 内部机制有深入了解。建议在受控的实验室环境中使用，并确保在测试后清理创建的恶意镜像和容器，防止对开发环境造成持久性破坏。整体而言，该代码是一个高质量的防御性安全研究工具，用于评估系统面临的逃逸风险，而非恶意投毒样本。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-9074-docker-exploit](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-9074-docker-exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
