## CVE-2025-14847 - MongoDB 未授权内存泄露

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 未授权内存泄露

**影响应用:** MongoDB

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

**影响版本:** 几乎影响过去十年发布的所有 MongoDB 版本

**利用条件:** 无需认证，远程可利用，通过发送特制Zlib压缩数据包。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-14847，又被称为“MongoBleed”，是MongoDB数据库服务器中存在的一个高危未授权内存泄露漏洞。该漏洞源于MongoDB在处理Zlib压缩协议数据时，对OP_COMPRESSED消息中的`uncompressedSize`字段校验存在缺陷。未经身份验证的远程攻击者可以通过发送特制的Zlib压缩数据包，利用长度参数不一致的问题，读取服务器堆内存中未初始化的数据。这意味着攻击者无需任何认证即可远程获取MongoDB服务器的敏感内存信息，可能包含凭证、会话令牌或其他配置数据。

**POC有效性分析：**
所提供的`MongoBLEED.py`是一个功能完整且有效的Python POC脚本，旨在利用CVE-2025-14847漏洞。该脚本使用标准的Python库（`socket`、`struct`、`zlib`）来构建和发送恶意请求。其核心功能体现在`criar_pacote_malicioso`函数中，该函数精心构造了一个`OP_COMPRESSED`消息。此消息的关键在于，它将`uncompressedSize`字段设置为一个比实际压缩数据解压后预期大小更大的值（由`SIZE`变量控制），从而触发了MongoDB服务器的内存泄露。脚本首先连接到目标MongoDB实例，然后发送这个特制的OP_COMPRESSED数据包。接着，它尝试接收并解析服务器的响应，将泄露的原始内存数据以十六进制和ASCII格式显示出来（通过`exibir_hex`函数）。这种展示方式直观地证明了漏洞的存在和成功利用。脚本的结构清晰，错误处理（如连接超时、响应不完整）也考虑在内，使其在实际环境中具有较高的可用性。该POC有效且可靠地复现了未经认证的内存泄露。

**项目地址:** 

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-14847
