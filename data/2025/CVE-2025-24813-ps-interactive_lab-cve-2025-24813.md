## CVE-2025-24813 - Apache Tomcat Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** Unknown

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100 (EOL)

**利用条件:** Unauthenticated, requires network access, partial PUT feature enabled.

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 20%

## 详情

CVE-2025-24813 is a critical security vulnerability in Apache Tomcat that allows for unauthenticated remote code execution (RCE). This vulnerability stems from improper handling of partial PUT requests when the `allowPartialPut` feature is enabled. The provided Dockerfile and shell script demonstrate a complete exploit. The Dockerfile sets up a vulnerable Tomcat instance by enabling the `allowPartialPut` feature within the `web.xml` configuration file. Specifically, it modifies the `<servlet>` definition to include `<init-param>` tags that set `readonly` to `false`, and both `allowPut` and `allowPartialPut` to `true`. It also deploys a dummy web application named `xxx-api.war`. The `upload.sh` script then exploits the vulnerability by uploading a serialized payload to the Tomcat server in chunks using PUT requests with the `Content-Range` header. This bypasses authentication and allows an attacker to execute arbitrary code on the server. 

The steps to exploit this vulnerability are as follows:

1.  Build the Docker image using the provided Dockerfile. This will create a Tomcat instance with the vulnerable configuration.
2.  Deploy a web application that includes a servlet capable of deserializing Java objects from an HTTP request.
3.  Generate a malicious serialized Java object (`payload.ser`) that, when deserialized, executes arbitrary code. This can be achieved using tools like ysoserial.
4.  Execute the `upload.sh` script, providing the IP address and port of the Tomcat instance. This script will upload the `payload.ser` file to the server in chunks, exploiting the partial PUT vulnerability.
5.  The server will deserialize the uploaded payload, leading to remote code execution.

The provided POC demonstrates a high level of functionality. The Dockerfile automates the setup of a vulnerable Tomcat instance, and the `upload.sh` script provides a straightforward method for exploiting the vulnerability. This allows for easy and reliable exploitation. This exploit can be achieved with a single HTTP request (chunked), doesn't require authentication, and is easily automatable, indicating low attack complexity.

**投毒风险分析:**

虽然提供的POC主要侧重于漏洞利用，但仍存在一些投毒风险。`payload.ser` 文件本身可能包含恶意代码。但是，此风险主要在于如何生成有效负载，而不是脚本本身。 `upload.sh` 脚本的目的是将有效负载上传到目标服务器。该脚本使用了标准 shell 命令 (`wc`, `dd`, `curl`)，没有明显的混淆或恶意行为。但是，如果恶意攻击者修改了该脚本以从外部来源下载有效负载或执行其他恶意操作，则该脚本可能会被用作供应链攻击的一部分。例如，一个被入侵的开发环境或一个被破坏的构建管道可能会被用来注入恶意代码到 `upload.sh` 脚本中。另外，攻击者可能会替换 `payload.ser` 文件与具有其他恶意目的的修改过的版本。此外，尽管脚本本身很短且清晰，但潜在的风险在于它可能被包含在更大的工具包或自动化攻击框架中，从而增加其被用于恶意目的的可能性。由于该脚本的功能有限且使用标准命令，因此投毒风险较低，估计约为20%。这种风险主要与恶意有效载荷的可能性有关，而不是脚本本身的功能。因此，在任何生产环境中部署此脚本时，必须仔细审查所使用的有效载荷并对其进行安全评估。

**项目地址:** https://github.com/randomusername/cve-2025-24813

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
