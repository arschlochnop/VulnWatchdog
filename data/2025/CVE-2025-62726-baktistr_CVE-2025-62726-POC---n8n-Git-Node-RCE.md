## CVE-2025-62726 - n8n (工作流自动化平台) RCE (远程代码执行)

**漏洞编号:** CVE-2025-62726

**漏洞类型:** RCE (远程代码执行)

**影响应用:** n8n (工作流自动化平台)

**危害等级:** 高危

**CVSS评分:** 8.8 (估计)

**影响版本:** 未知 (具体版本待官方进一步披露)

**利用条件:** 需要目标n8n工作流配置了Git节点，且执行包含git commit的操作，同时攻击者需诱导或劫持Git仓库内容

**POC 可用性:** 7/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞利用了n8n在处理Git集成时的安全逻辑缺陷。根据攻击流图分析，当n8n工作流被配置为执行Git操作（如克隆、添加和提交）时，如果关联的远程仓库包含恶意的Git钩子文件（如.git/hooks/pre-commit），n8n在执行'Git Commit'节点时会触发该钩子脚本。POC展示了这一完整的攻击链路：攻击者首先准备一个包含恶意pre-commit钩子的Git仓库，该钩子中嵌入了攻击载荷。当受害者在n8n中运行涉及该仓库的自动化流程并执行提交操作时，恶意代码将在n8n服务器进程上下文中以相同权限执行。此POC逻辑清晰，通过可视化图表详细说明了攻击发生的具体位置，即在n8n工作流自动化节点与底层系统Git命令交互的边界处。由于n8n通常部署在内网环境且拥有较高的系统权限（如访问数据库、API密钥和其他服务凭据），该漏洞的利用价值极高。【利用步骤】1. 攻击者创建一个特制的Git仓库，并在.git/hooks/目录下编写恶意的pre-commit脚本（例如反弹Shell或数据外传脚本）。2. 攻击者通过社会工程学或供应链污染手段，诱使目标组织的DevOps工程师将该恶意仓库地址配置到n8n的Git节点中。3. 受害者配置一个n8n工作流，流程包含：[Trigger] -> [Git Clone] -> [Git Add] -> [Git Commit]。4. 当工作流运行到Git Commit节点时，Git会自动执行pre-commit钩子，从而在n8n服务器上激活恶意载荷。5. 攻击者最终获得RCE权限，实现对系统的持久化控制。【投毒风险分析】在针对此漏洞的POC研究中，投毒风险主要体现在两个方面：首先，Git钩子本身就是一种隐蔽的代码执行机制，许多安全扫描工具可能不会深入检查.git文件夹内部的脚本内容，这使得恶意代码极易伪装成正常的自动化流程脚本。其次，在威胁情报社区中，如果研究人员提供的POC项目本身就托管在一个包含恶意钩子的Git仓库中，分析人员在本地测试、克隆或执行git commit时，可能会在不知情的情况下触发该POC自身的投毒代码，从而反向控制分析人员的工作站。目前的分析结果显示，该POC主要以文档和逻辑图形式存在，代码部分逻辑清晰且未见明显混淆，属于标准的防御性安全研究范畴。但鉴于利用方式的特殊性，任何声称提供一键化测试脚本的仓库都应受到严格审查，以防其中夹带针对研究人员的二级Payload。由于利用过程依赖于Git原生机制，检测此类投毒行为需要对Git钩子目录进行强制性的完整性校验。

**项目地址:** [https://github.com/ThumpBo/CVE-2025-30208-EXP](https://github.com/ThumpBo/CVE-2025-30208-EXP) (注:搜索结果提及相关项目)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-62726](https://nvd.nist.gov/vuln/detail/CVE-2025-62726)
