## CVE-2025-54424 - 1Panel RCE

**漏洞编号:** CVE-2025-54424

**漏洞类型:** RCE

**影响应用:** 1Panel

**危害等级:** 高危

**CVSS评分:** 9.8

**影响版本:** 1Panel v2.0.0 至 v2.0.5

**利用条件:** 目标系统开启了 Agent 服务且版本在受影响范围内，攻击者需能够访问 Agent 监听端口

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

POC有效性分析：该POC代码具有极高的实用价值和技术完整性。它首先利用cryptography库动态生成一个符合攻击条件的自签名证书，其核心在于将证书的Common Name (CN)字段硬编码为 'panel_client'。根据漏洞原理，受影响版本的1Panel Agent在TLS握手时仅验证客户端证书的CN字段是否匹配，而未验证证书是否由受信任的CA签发。POC利用这一逻辑漏洞，通过ssl库加载伪造的证书与目标Agent建立HTTPS连接。代码进一步展示了利用该连接访问敏感API（如 /api/v2/dashboard/base/os）以及通过WebSocket接口执行系统命令的过程。POC包含了完整的异常处理、多线程扫描逻辑以及动态证书清理机制，能够稳定复现漏洞。利用步骤：1. 攻击者确定目标 1Panel Agent 的 IP 和端口。2. 脚本使用 RSA 算法生成 2048 位的私钥，并签发一份主题名为 'panel_client' 的自签名证书。3. 脚本发起 HTTPS 请求，并在 TLS 握手中提交该伪造证书，绕过 Agent 的身份验证机制。4. 成功认证后，脚本通过 WebSocket 协议连接到命令执行接口。5. 攻击者可发送任意系统指令，Agent 将以 root 或高权限执行该命令并返回结果。投毒风险分析：该 POC 代码表现出极高的透明度和安全性。首先，代码中引用的库均为 Python 标准库（如 os, sys, json, ssl）及知名的第三方安全库（requests, cryptography, websocket-client），未发现引用未知的第三方远程恶意脚本。代码逻辑清晰，从证书生成到网络通信的过程均有明确的注释，未采用 base64 混淆、十六进制编码或 eval() 等常见的代码隐藏手段。关于投毒风险的深度审查：在证书生成环节，生成的临时文件路径通过 tempfile 模块安全管理，并在逻辑结束后有潜在的删除意图；在网络通信部分，所有的请求目标均指向用户指定的 target_host，不存在隐蔽的境外 OOB（带外数据）回传或信息劫持。唯一的外部通信是针对受害主机的漏洞利用尝试，这属于正常的渗透测试行为。脚本中没有发现诸如修改执行环境环境变量、劫持 SSH 密钥或在本地植入后门的恶意逻辑。综上所述，该 POC 属于纯粹的技术研究工具，投毒风险极低，但在分发时仍应注意防止其被未授权人员直接用于非法攻击活动。

**项目地址:** [https://github.com/Mr-xn/CVE-2025-54424](https://github.com/Mr-xn/CVE-2025-54424)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-54424](https://nvd.nist.gov/vuln/detail/CVE-2025-54424)
