## CVE-2025-54424 - 1Panel (开源服务器运维面板) RCE (远程命令执行)

**漏洞编号:** CVE-2025-54424

**漏洞类型:** RCE (远程命令执行)

**影响应用:** 1Panel (开源服务器运维面板)

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.8 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1Panel <= v2.0.5

**利用条件:** 目标系统需开启节点管理功能，且Agent端使用默认的TLS验证配置（tls.RequireAnyClientCert）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞源于1Panel Agent在TLS通信中对客户端证书的校验逻辑存在缺陷。具体而言，Agent端使用了 tls.RequireAnyClientCert 配置，这意味着它仅要求客户端提供证书，但并未验证该证书是否由受信任的CA签署。攻击者可以通过动态生成一个Common Name (CN) 为 'panel_client' 的自签名证书来绕过身份认证。POC代码展示了完整的攻击链条：首先，利用 cryptography 库生成符合要求的伪造证书；其次，通过携带该证书向 API 路径 /api/v2/dashboard/base/os 发起 HTTPS 请求进行预检。一旦预检通过，攻击者通过 WebSocket 协议连接到目标系统，在握手过程中继续使用伪造证书。由于认证被绕过，攻击者能够通过 WebSocket 通信接口执行系统命令，从而实现完全的服务器控制（如反弹 Shell）。此 POC 脚本逻辑清晰，使用了 Python 标准库及成熟的第三方加密库，经过简单配置即可在受影响的版本上稳定复现。 利用步骤：1. 安装 Python 依赖环境，特别是 cryptography、requests 和 websocket-client。2. 脚本会自动调用 generate_self_signed_cert 函数，生成一个 CN 为 'panel_client' 的 RSA 密钥对和自签名证书。3. 脚本首先对目标发起 HTTPS GET 请求，若返回 200 则确认证书验证绕过成功。4. 建立 WebSocket 连接，发送构造好的指令数据包。5. 在目标服务器上执行任意系统指令。 投毒风险分析：经过对提供的脚本代码进行静态审计，该 POC 的投毒风险处于低水平（约15%）。主要原因如下：1. 依赖库透明：脚本引用的 cryptography 和 requests 均为安全业界公认的标准库，未发现引入不明来源的第三方二进制包。2. 逻辑可见：代码中生成证书的过程完全在本地执行，使用的是 Python 内存操作和临时文件存储（tempfile），没有发现将生成的密钥对或敏感信息上传到远程服务器的行为。3. 无混淆特征：代码未经过 base64 混淆或十六进制编码处理核心逻辑，所有函数命名与其功能相符（如 check_target, generate_self_signed_cert）。4. 网络行为受控：脚本的网络活动仅限于与目标主机的 HTTPS 和 WebSocket 通信，未发现隐藏的 DNS 隧道或向 C2 节点发送心跳包的代码。虽然脚本包含删除本地临时文件的操作，这符合常规清理逻辑，并非恶意销毁证据。风险提示主要在于脚本中包含了 threading 模块实现的批量扫描功能，这在未经授权的情况下可能被用于大规模攻击，使用者应确保在授权环境内进行合规测试。

**项目地址:** [https://github.com/1Panel-dev/1Panel](https://github.com/1Panel-dev/1Panel)

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-54424](https://avd.aliyun.com/detail?id=AVD-2025-54424)
