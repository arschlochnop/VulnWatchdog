## CVE-2025-32433 - Erlang/OTP SSH Daemon RCE (远程代码执行)

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Erlang/OTP SSH Daemon

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** OTP-27.3.2 及更早版本; OTP-26.2.5.10 及更早版本; OTP-25.3.2.19 及更早版本

**利用条件:** 受影响的系统启用了 SSH 守护进程服务，攻击者具有网络访问权限，无需任何凭据认证。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该POC针对CVE-2025-32433漏洞，这是一个存在于Erlang/OTP SSH实现中的严重缺陷。漏洞源于SSH协议消息处理逻辑中的缺陷，允许远程未授权攻击者通过精心构造的SSH消息序列绕过身份验证。POC代码通过Python的socket和struct库直接构造SSH协议报文，绕过了常规SSH客户端的限制。其逻辑清晰地展示了漏洞利用的三个阶段：首先是建立基本的TCP连接并进行SSH版本握手；其次是发送特定的通道打开请求（Channel Open），试图触发受影响系统的逻辑错误；最后通过`exec`请求尝试注入Erlang表达式或系统命令。由于Erlang SSH守护进程在处理这些未经验证的请求时未正确校验状态机，导致命令在目标系统上下文中执行。此POC不仅包含了简单的漏洞存在性检测（--check），还实现了完整的反弹Shell功能，证明了该漏洞可以导致系统完全失陷。从代码结构看，它使用了标准的Python网络编程接口，没有依赖复杂的第三方重型库，执行效率高且易于被脚本化用于大规模扫描。

利用步骤：1. 环境准备：攻击者需准备Python3环境，确保目标主机的SSH服务端口（通常为22）对外开放。2. 扫描阶段：使用`--check`参数运行脚本，通过观察目标对构造报文的响应来确认是否存在漏洞。3. 命令执行：通过`-c`参数发送单条系统命令，如`id`或`whoami`，验证执行权限。4. 提权控制：在攻击机监听特定端口（如使用nc -lvnp 4444），然后运行POC并附加`--shell`、`--lhost`和`--lport`参数，诱导目标系统发起反向连接，从而获取交互式Shell。由于漏洞无需认证，整个过程不需要任何弱口令字典或暴力破解。

投毒风险分析：该POC本身代码逻辑透明度较高，主要使用了Python标准库（socket, struct, argparse），在截断的代码片段中未发现明显的恶意混淆（如Base64嵌套解码、动态函数名替换）或隐蔽的第三方下载行为。然而，此类高危、全自动化的RCE工具通常是安全社区和黑客论坛的高频传播对象，存在二次修改投毒的风险。常见的投毒手段包括：在`build_channel_request`等核心函数中植入额外的后门代码，在攻击者执行攻击的同时，脚本会悄悄将攻击者的主机信息发送至投毒者的C2服务器；或者在脚本头部引入看似无害但经过混淆的恶意模块。当前分析的版本属于低风险范畴，因为它直接提供了Git仓库引用和清晰的函数定义。但防御者在使用此类从非官方来源下载的POC时，必须严格审计其网络请求部分，防止在测试过程中反被利用。考虑到该漏洞的严重性和高价值，未来该POC可能会被封装入带有预编译二进制文件的‘一键利用工具’中，那时投毒风险将大幅上升。

**项目地址:** [https://platformsecurity.com/blog/CVE-2025-32433-poc](https://platformsecurity.com/blog/CVE-2025-32433-poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
