## CVE-2025-49844 - Redis RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** Redis 6.x, 7.x, 8.x (所有支持Lua脚本的分支)

**利用条件:** 具有执行Lua脚本权限的身份验证用户（低权限及以上）

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 高

**投毒风险:** 15%

## 详情

POC有效性分析：根据搜索结果和提供的代码段，CVE-2025-49844（被称为RediShell）是一个由于Redis Lua脚本引擎中存在Use-After-Free（UAF）缺陷而导致的高危漏洞。分析提供的Python POC代码发现，虽然标题标注为CVE-2025-62507且针对XACKDEL命令，这与搜索结果中描述的Lua引擎UAF漏洞存在显著差异，表明该POC可能是一个针对Redis 8.2.x版本中Stream处理溢出的独立验证代码，而非RediShell的核心利用。搜索结果显示真正的CVE-2025-49844源于Lua脚本处理时的内存管理问题，由Wiz团队在Pwn2Own Berlin上演示。该漏洞之所以获得CVSS 10.0分，是因为它理论上允许在内存中重构恶意指令。然而，README文档明确提到，尽管可以实现崩溃（DoS），但要实现稳定的代码执行（RCE）极其困难，普通研究者难以通过简单的脚本获得反弹Shell。提供的Python脚本使用了pwntools，通过构造包含大量ID的XACKDEL命令尝试触发缓冲区溢出，这更像是针对Redis新版本的内存破坏测试。总体而言，目前公开的POC大多处于‘崩溃验证’阶段，缺乏稳定的指令流劫持实现。利用步骤：1. 建立与Redis服务器的TCP连接；2. 使用具有Lua脚本执行权限的账号登录；3. 构造特定的Lua脚本或利用缓冲区溢出的流命令（如POC所示的XACKDEL）；4. 通过发送超长Payload触发内存破坏；5. 在理想环境下，精心构造的内存布局会引导CPU执行恶意Shellcode。投毒风险分析：该POC的投毒风险被评估为15%（低风险）。从代码审计角度看，提供的Python脚本逻辑清晰，使用了标准的pwn库进行Socket通信。脚本中虽然包含发送Payload的操作，但其核心功能是计算偏移量和模拟溢出行为，并未发现恶意下载远程脚本、加密本地文件或窃取Redis密钥数据的隐蔽行为。README部分提到的‘AI-made Revshell’虽带有敏感标签，但作者声明其主要用于安全研究，且经过GDB调试发现其执行流难以控制，这降低了被不法分子直接利用作为自动化武器的可能性。主要的风险点在于，某些第三方分发的所谓‘增强版’可能包含混淆的Hex字符串，在执行时可能释放出具有真实危害的恶意二进制文件。因此，防御性研究员在复现时，应在隔离环境中使用，并严格审查Python脚本中u64转换和循环构造逻辑，确保没有恶意的系统调用或意外的网络外连。当前的脚本仅展示了基础的攻击向量，不具备高度的武器化威胁。

**项目地址:** [https://github.com/raminfp/redis_exploit](https://github.com/raminfp/redis_exploit)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
