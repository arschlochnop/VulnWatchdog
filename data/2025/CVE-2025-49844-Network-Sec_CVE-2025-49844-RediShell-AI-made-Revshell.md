## CVE-2025-49844 - Redis Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** Redis 8.2.1-8.2.2

**利用条件:** 需要认证,需要网络访问

**POC 可用性:** 7

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

POC有效性分析与利用步骤:CVE-2025-49844 是一个影响 Redis 服务器的关键漏洞，被标识为 Lua 语言的 Use-After-Free (UAF) 漏洞，可能导致远程代码执行 (RCE)。根据搜索结果，该漏洞的 CVSS 评分高达 10.0，属于严重级别，且需要经过认证的用户才能利用。所提供的 Python PoC (文件名为 `CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py`) 虽然其文件名指向一个缓冲区溢出漏洞，但其关联的 `README.md` 文件明确指出这是对 `CVE-2025-49844` 进行研究的一部分。该 PoC 的目标是通过 `XACKDEL` 命令触发 Redis 服务器的内存损坏。具体来说，PoC 会发送一个带有大量（本例中为20个）特制长整数 ID 的 `XACKDEL` 命令。根据 PoC 代码中的注释，正常情况下 `STREAMID_STATIC_VECTOR_LEN` 为 8，而 PoC 发送 20 个 ID 旨在超出此限制并覆盖栈上重要数据，从而触发内存溢出或相关的内存错误。`README.md` 文件明确提到该 PoC 能够成功导致 Redis 服务器崩溃（“Crashing? Yes.”），但无法实现代码执行（“Commands? No.”）。这表明该 PoC 在概念上验证了 `CVE-2025-49844` 所涉及的内存损坏问题，可以作为拒绝服务（DoS）攻击，但尚未能将其升级为完整的远程代码执行漏洞利用。尽管如此，一个稳定的崩溃 PoC 是进一步开发 RCE 漏洞的基础。

利用步骤概览:
1.  **环境配置**: 确保目标 Redis 服务器版本为受影响的版本（例如，PoC 描述中提到的 Redis 8.2.1 或 8.2.2）。攻击者需要具备对 Redis 服务器的认证凭据，并能通过网络访问 Redis 服务端口（默认为 6379）。
2.  **PoC 准备**: 将提供的 Python 脚本 (`CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py`) 保存到本地。
3.  **依赖安装**: 安装 Python 的 `pwntools` 库，可以通过 `pip install pwntools` 命令完成。
4.  **参数调整**: 根据目标 Redis 服务器的 IP 地址和端口，修改 PoC 脚本中的 `HOST` 和 `PORT` 变量。
5.  **执行 PoC**: 在终端运行 `python3 CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py` 命令。
6.  **结果验证**: 脚本将首先尝试使用 `XGROUP CREATE` 命令设置流和消费者组，这是 `XACKDEL` 命令的前提。随后，它将发送精心构造的 `XACKDEL` 命令，其中包含触发溢出的恶意 ID 列表。成功执行后，Redis 服务器预期会崩溃。攻击者可以检查 Redis 服务状态或其日志来确认崩溃是否发生。

投毒风险分析:对所提供的 PoC 代码及其相关 `README.md` 文件的分析显示，其投毒风险极低。该 PoC 是一个标准的内存崩溃概念验证工具，主要使用 Python 编程语言和 `pwntools` 库。`pwntools` 是一个在漏洞利用开发和逆向工程领域广泛使用的合法安全研究框架，它提供了方便的函数来处理网络连接、字节码操作和生成漏洞利用所需的复杂数据结构。PoC 代码逻辑清晰，结构良好，其核心功能是构建一个旨在触发缓冲区溢出的 Redis 命令。

具体来看，代码中没有发现任何恶意或可疑的行为模式：
1.  **无代码混淆**: 脚本代码未进行任何形式的混淆处理，所有函数调用和逻辑都一目了然。
2.  **无外部依赖或恶意下载**: PoC 没有尝试从外部 URL 下载并执行任何脚本、二进制文件或配置文件。它仅依赖于本地安装的 `pwntools` 库和 Python 标准库。
3.  **无后门或数据窃取**: 代码中没有包含任何创建后门账户、窃取敏感信息（如系统文件、环境变量、用户数据）或进行加密货币挖矿等恶意功能的指令。
4.  **无异常网络行为**: 除了与目标 Redis 服务器进行预期交互以发送漏洞利用命令外，PoC 没有尝试连接到任何其他可疑的IP地址或域名。其网络通信是直接、点对点的，且目的明确。
5.  **无持久化机制**: PoC 不会修改目标系统的文件系统、注册表或任何配置，以实现攻击后的持久化。它只是一个一次性的崩溃触发器。
6.  **`pwn.cyclic` 的使用**: PoC 使用 `pwn.cyclic` 函数来生成用于填充缓冲区和识别溢出点的循环模式数据。这是漏洞利用开发中的常见做法，用于确定偏移量和控制流劫持点，并非恶意代码的标志。
7.  **`README.md` 的澄清**: 尽管 `README.md` 中提到“AI-made Revshell PoC”并暗示了开发逆向 Shell 的尝试，但紧接着的描述明确指出“Untested completition”以及“No matter what we tried, it was impossible to get code execution. Crashing? Yes. Commands? No.” 这清晰地表明，当前提供的 PoC 版本并未成功实现逆向 Shell 或完整的 RCE，而是停留在崩溃层面。这实际上降低了实际的投毒风险，因为它明确了此PoC的范围和局限性。

综上所述，该 PoC 旨在帮助安全研究人员理解和复现 Redis 漏洞的内存损坏行为，其设计和实现符合安全研究工具的标准。因此，判定其投毒风险为极低，约为 10%。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
