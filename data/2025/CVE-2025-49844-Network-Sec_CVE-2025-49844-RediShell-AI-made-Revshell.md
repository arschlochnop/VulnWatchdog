## CVE-2025-49844 - Redis RCE (Use-After-Free)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Use-After-Free)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis 8.2.1 及以下版本

**利用条件:** 经过身份验证的用户权限（通常为低权限），可访问Redis服务端口

**POC 可用性:** 4/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-49844）是一个位于Redis Lua脚本引擎中的内存释放后重用（Use-After-Free）漏洞。输入数据中提供的Python脚本实际上是一个针对CVE-2025-62507（Buffer Overflow）的POC，而非本漏洞的直接Payload，这种编号不一致在公开威胁情报中常暗示信息混杂。真正的CVE-2025-49844涉及Lua脚本处理时的内存管理缺陷。根据搜索结果，该漏洞允许具有Lua脚本执行权限的验证用户通过构造特定的Lua脚本触发UAF。有效性方面，该POC代码（Python版本）试图通过XACKDEL命令溢出静态向量，但在README中作者承认仅能实现崩溃（DoS）而无法实现代码执行（RCE），这反映了现代操作系统保护机制（如ASLR/PIE）下UAF利用的极高门槛。代码在内存布局控制上过于简单，缺乏堆喷射或精确的内存对齐逻辑，因此作为RCE利用工具的有效性较低，仅能作为崩溃复现参考。利用步骤：1. 建立与Redis服务器的连接；2. 使用AUTH命令进行身份验证；3. 准备包含恶意内存操作逻辑的Lua脚本或利用特定的流命令（如POC中所示的XGROUP/XACKDEL）；4. 向服务器发送EVAL或对应命令触发内存破坏；5. 观察服务进程状态，若成功绕过保护则执行Shellcode。【投毒风险分析】该POC的投毒风险评级为低（15%）。代码分析显示，Python脚本使用了标准的pwntools库进行网络交互，其核心逻辑集中在构造特定的Redis协议报文。代码中没有发现典型的恶意投毒特征，如尝试读取本地敏感文件（/etc/shadow）、反弹Shell到不受信任的第三方IP、或者执行rm -rf等破坏性指令。然而，值得警惕的是README中提到的‘AI-made Revshell’字样以及链接指向的外部GitHub仓库。在威胁情报实战中，这种引导用户访问外部脚本的行为是常见的隐蔽投毒手段，攻击者可能在外部链接的.lua或.py文件中植入混淆的恶意代码。此外，POC脚本中使用了'cyclic'生成数据，虽然在pwntools中是标准功能，但如果用户在未检查的情况下运行来自不明来源的所谓‘补丁版’或‘增强版’脚本，存在被注入后门的风险。当前脚本本身结构清晰，无混淆，主要风险在于其不完整性和对外部不可信资源的引用，建议研究人员在沙箱环境中进行调试，并严格审计从外部链接下载的任何Lua组件。

**项目地址:** [https://github.com/raminfp/redis_exploit/blob/main/exploit_poc.py](https://github.com/raminfp/redis_exploit/blob/main/exploit_poc.py)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
