## CVE-2025-49844 - Redis Use-After-Free / 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free / 远程代码执行 (RCE)

**影响应用:** Redis

**危害等级:** Critical

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/P:H)

**影响版本:** 8.2.2 and below

**利用条件:** Authenticated / Network Access

**POC 可用性:** 7

**POC 类型:** 概念验证 (Proof of Concept)

**攻击复杂度:** Low

**投毒风险:** 10%

## 详情

CVE-2025-49844是Redis中一个高危漏洞，被官方认定为Lua引擎中的Use-After-Free（UAF）漏洞，可能导致远程代码执行（RCE），CVSS评分高达10.0。该漏洞影响Redis 8.2.2及以下版本，攻击者需具有低权限以上的认证用户身份，通过精心构造的Lua脚本即可利用。攻击者利用该漏洞可在受影响的Redis服务器上执行任意代码，对数据完整性、机密性和系统可用性造成严重威胁。

**POC有效性分析与利用步骤:**
提供的Python POC代码文件名为`CVE-2025-62507_Crash_Working_PoC_BufferOverflow.py`，其文件名与本分析的CVE-ID（CVE-2025-49844）不符，且该POC代码本身并非针对Redis Lua引擎的Use-After-Free漏洞，而是针对Redis的`XACKDEL`命令中的一个缓冲区溢出缺陷。尽管其所在的`README.md`文件尝试将其与CVE-2025-49844关联，并指出“无法实现代码执行，但能导致崩溃”，这表明该POC是一个拒绝服务（DoS）的验证，而非CVE-2025-49844所描述的远程代码执行。
该POC代码实现了以下利用步骤：
1.  **建立连接：** 脚本首先连接到目标Redis服务器（默认`127.0.0.1:6379`）。
2.  **前置条件设置：** 为了使用`XACKDEL`命令，脚本首先执行`XGROUP CREATE mystream mygroup 0-0 MKSTREAM`命令，创建了一个Stream和消费者组。
3.  **构造溢出Payload：** 核心部分是构造`XACKDEL`命令的参数。Redis内部在处理`XACKDEL`命令时，对于Stream ID列表可能存在一个固定大小的缓冲区（例如，在某些版本中为8）。该POC通过发送20个特意构造的、超长的Stream ID，远超这个内部缓冲区限制。每个ID都是由一个大的64位整数（通过`pwn`库的`cyclic`模式生成）和一个索引组成，确保格式有效但长度溢出。
4.  **发送Payload并触发崩溃：** 脚本将构造好的`XACKDEL`命令发送给Redis服务器。由于Stream ID列表的长度溢出了内部缓冲区，这将导致服务器发生崩溃，实现拒绝服务攻击。
综上，该POC能够成功导致受影响的Redis实例崩溃，验证了缓冲区溢出漏洞的存在。但其并未实现远程代码执行，与CVE-2025-49844描述的RCE攻击目标不符。

**投毒风险分析:**
该POC代码的投毒风险评估为**低**（10%）。主要原因如下：
1.  **代码透明性高：** POC代码使用Python编写，结构清晰，逻辑直接，未经过混淆处理。核心的攻击逻辑是构造`XACKDEL`命令以触发缓冲区溢出，意图明确。
2.  **无恶意外部依赖：** 代码中除了`pwn`库（安全研究常用工具）外，没有引用其他可疑的外部库或脚本，也未进行任何外部网络请求（除了与目标Redis服务器的通信）。
3.  **功能局限性：** 尽管`README.md`中提到“AI-made Revshell PoC”这样的标题，但实际的Python代码并未实现反向Shell功能，其唯一可观察到的效果是使Redis服务器崩溃。这表明该POC的目的仅限于验证漏洞的拒绝服务效果，而非植入后门或进行其他高级恶意活动。
4.  **无动态代码执行：** 代码中没有使用`eval()`、`exec()`等可能被滥用以执行任意代码的函数，这进一步降低了通过代码本身进行投毒的风险。
防御者在评估此类POC时，应始终以实际代码为准，而非仅依赖`README.md`中的描述。该POC的实现方式并未引入额外的恶意载荷，其风险在于可能造成目标系统的拒绝服务，而非秘密植入恶意软件。

**项目地址:** https://github.com/raminfp/redis_exploit/blob/main/exploit_poc.py

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-49844
