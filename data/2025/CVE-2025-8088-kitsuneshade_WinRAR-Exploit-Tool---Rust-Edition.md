## CVE-2025-8088 - WinRAR 路径遍历/目录穿越 (Path Traversal)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/目录穿越 (Path Traversal)

**影响应用:** WinRAR

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12 (Windows版本)

**利用条件:** 需要诱导用户下载并打开经过特制的恶意RAR压缩文件，并执行解压操作。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 25%

## 详情

POC有效性分析：该漏洞是WinRAR在处理RAR5格式压缩文件时的逻辑缺陷，具体涉及Windows NTFS备用数据流（ADS）特性和路径过滤绕过。根据搜索结果和提供的Rust代码分析，该POC通过直接操纵RAR5文件头部（Header Patching）来注入带有‘../’或特定ADS标记（如‘:Zone.Identifier’或‘::$DATA’）的文件路径。这种利用方式比早期的CVE-2025-6218更具隐蔽性，因为它能有效规避部分安全软件对传统路径遍历字符的静态扫描。Rust实现的POC具备高性能和跨平台编译特性，集成了GTK界面，降低了利用门槛。该POC不仅能实现基础的路径穿越，还专门针对Windows启动项（Startup）目录进行了路径硬编码，一旦用户解压，恶意payload（如.exe或.bat）将被静默释放到启动文件夹中，待用户下次重启系统时自动执行，从而实现持久化攻击。经过分析，该代码结构完整，逻辑清晰，具备极高的实战转化能力。利用步骤：1. 攻击者准备Payload文件（如木马程序）和伪装用的诱饵文件（Decoy）。2. 使用该POC工具，选择Payload和Decoy。3. 工具会通过RAR5头部修改技术，将Payload的文件名修改为包含路径遍历字符的目标路径（例如：'..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\evil.exe'）。4. 生成最终的恶意RAR文件。5. 攻击者通过钓鱼邮件或社交工程传播该RAR文件。6. 用户解压文件时，WinRAR未能正确过滤经过混淆的路径，导致恶意文件被释放到预设的系统关键位置。投毒风险分析：该POC项目虽然是基于Rust开发的‘防御研究’工具，但其潜在的投毒风险不容忽视。首先，项目依赖项中包含了大量的Windows API绑定（windows-rs）和系统操作库（dirs, tempfile, walkdir），这赋予了程序深度操作宿主机文件系统的能力。虽然当前展示的代码片段主要是构建恶意RAR逻辑，但Rust的编译特性使得其二进制产物难以被传统反病毒软件识别。风险点在于，如果该工具被二次打包并在非官方渠道流传，攻击者可能在编译过程中植入后门代码，利用Rust的宏系统或构建脚本（build.rs）在编译时下载并运行额外恶意载荷。此外，该工具内置的‘系统诊断’功能（System Diagnostics）和‘启动项定位’逻辑，其本质上也是高级木马常用的环境侦察手段。鉴于其‘一键式’生成漏洞压缩包的便捷性，该项目极易被脚本小子直接用于网络犯罪活动，而非单纯的安全研究。对于防御团队而言，应重点关注此类利用ADS流绕过检测的技术手段，并严格监控WinRAR版本的更新状态。

**项目地址:** n/a (基于提供的本地路径/tmp/vulnwatchdog_832e62107b1452c906f69917ef559b5a)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
