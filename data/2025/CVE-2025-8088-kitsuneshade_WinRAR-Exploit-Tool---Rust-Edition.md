## CVE-2025-8088 - WinRAR 路径遍历/远程代码执行(RCE)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/远程代码执行(RCE)

**影响应用:** WinRAR

**危害等级:** 严重

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者需解压由攻击者构造的特制恶意压缩包

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞是WinRAR中一个极其隐蔽且威力巨大的路径遍历缺陷，被认为是CVE-2025-6218的变体或升级版。其核心原理在于利用Windows NTFS特有的备用数据流（ADS）特性与RAR5格式的文件头处理逻辑冲突。当WinRAR处理包含特定路径标记的压缩包时，它无法正确校验目标解压路径，导致文件可以被写入到预设路径之外的任意位置。提供的Rust版POC展示了极高的工程化水准，使用了tokio异步框架和windows-rs系统库，能够直接操作RAR5头部字节进行特征注入。该工具不仅实现了自动化生成恶意压缩包，还针对性地支持了‘Startup Targeting’功能，能够精准地将负载写入Windows启动目录。经过分析，该POC具备极高的复现成功率，其针对ADS流的构造能够有效绕过部分静态签名检测。利用步骤：1. 准备攻击负载（如exe或bat脚本）和诱饵文件。2. 使用利用工具配置负载路径，并指定目标系统上的穿越路径，例如‘..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe’。3. 工具通过直接修改RAR5压缩包的文件记录头，注入包含ADS标记和遍历字符的路径。4. 将生成的RAR文件发送给目标，诱导其进行‘解压到当前文件夹’或‘解压到指定文件夹’操作。5. 文件被静默释放至启动目录，待用户下次登录系统时自动触发执行。投毒风险分析：该POC虽然结构清晰、文档齐全且使用了内存安全的Rust语言，但也存在一定的潜在投毒风险。首先，该项目依赖较多第三方库（如tokio, windows-rs等），在构建过程中存在依赖链劫持的可能。其次，POC本身集成了高级混淆特性，如利用ADS隐藏负载，这种技术同样可以被用于在安全研究员复现过程中通过该工具反向对研究员系统进行渗透。工具的README中提到了‘System Diagnostics’功能，在未经深入审计的情况下，不能排除该功能在后台收集宿主机敏感信息并回传的可能。尽管代码逻辑主要集中在构造恶意压缩包，但由于其提供了高度自动化的环境搭建脚本和GUI界面，容易被低技术水平的攻击者直接利用。建议研究员在完全隔离的沙盒环境中使用Cargo编译，并严格监控编译产物的网络行为，防止在使用防御性工具时遭到反向投毒。总体而言，该代码库表现出极强的攻击性特征，必须谨慎对待其二进制分发版本。

**项目地址:** winrar_exploit_rust (本地存储于 /tmp/vulnwatchdog_832e62107b1452c906f69917ef559b5a/)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
