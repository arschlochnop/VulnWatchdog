## CVE-2025-8088 - WinRAR 路径遍历 (Path Traversal)，可导致任意代码执行 (Arbitrary Code Execution)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 (Path Traversal)，可导致任意代码执行 (Arbitrary Code Execution)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** N/A

**影响版本:** WinRAR受影响版本 (包括Windows版RAR、UnRAR、便携式UnRAR源代码及UnRAR.dll)

**利用条件:** 需要用户交互 (解压恶意压缩包)，无需认证

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

该POC代码是一个用Rust语言编写的、功能完备的WinRAR漏洞利用工具，专门针对CVE-2025-8088路径遍历漏洞。从其`Cargo.toml`文件中列出的广泛依赖项（如`tokio`, `windows`, `anyhow`, `crc32fast`, `byteorder`, `tempfile`, `walkdir`, `regex`, `serde`, `serde_json`, `dirs`, `chrono`, `uuid`, `clap`, `console`）可以看出，这是一个设计精良、功能丰富的项目。`README.md`文件详细阐述了其高级特性，包括NTFS备用数据流（ADS）利用、RAR5头部操作以实现路径注入、支持Windows启动文件夹目标投放、自定义诱饵文件以及通用文件类型支持等。这些功能表明该工具能够精确地构造恶意压缩包，以绕过WinRAR的文件验证机制，并将恶意文件释放到系统任意指定位置。

该POC的实现细节涵盖了Windows平台特有的NTFS文件系统特性利用，这正是CVE-2025-8088漏洞的核心。通过操纵RAR压缩包的内部结构，使其包含特制的路径，攻击者可以在受害者解压文件时，将恶意载荷写入如`StartUp`目录等敏感位置，从而在系统启动时自动执行。`README.md`中提供的安装、编译和使用说明清晰明了，包括在Windows（MSVC或MSYS2）上安装GTK开发库的步骤，以及使用`cargo build --release`进行编译和`.\winrar_exploit_rust.exe create`命令进行攻击载荷生成的具体示例。这些都充分证明了该POC代码的完整性、可用性和有效性，可以直接用于复现漏洞并生成实际的攻击载荷。因此，其POC质量评分可达9分，属于完整可用且文档齐全的范畴。

**利用步骤：**
1.  **环境配置**: 确保目标系统已安装Rust 1.70+、GTK开发库（若使用GUI）和WinRAR CLI工具，操作系统为Windows 10/11，以支持NTFS特性。
2.  **获取POC**: 从指定代码仓库或本地目录获取`winrar_exploit_rust`项目代码。
3.  **编译工具**: 进入项目根目录，执行`cargo build --release`命令，编译生成优化的可执行文件。
4.  **准备载荷与诱饵**: 准备一个恶意文件（Payload，如`malware.exe`）和一个用于迷惑用户的正常文件（Decoy，如`report.pdf`）。
5.  **生成恶意压缩包**: 运行编译后的工具，例如：`.\winrar_exploit_rust.exe create --payload "C:\path\to\malware.exe" --decoy "C:\path\to\report.pdf" --output "document.rar"`。该命令将创建一个名为`document.rar`的恶意压缩包。
6.  **社会工程**: 通过电子邮件、即时通讯或恶意网站等手段，将生成的`document.rar`文件分发给目标用户，并诱骗其解压。
7.  **漏洞触发**: 当用户使用存在漏洞的WinRAR版本（CVE-2025-8088未修复）解压`document.rar`时，由于路径遍历漏洞和ADS特性，`malware.exe`将被悄无声息地释放到系统预设的敏感位置（例如用户启动目录），并在下次系统启动时自动执行，最终实现任意代码执行。

**投毒风险分析：**
对`winrar_exploit_rust`这个POC代码的投毒风险评估，需要区分代码本身作为工具的安全性与该工具被恶意使用的潜在危害。从代码结构、依赖库和功能描述来看，该POC代码本身的投毒风险极低，评估为10%。

首先，该POC是用Rust语言编写的，Rust以其内存安全性和类型安全性著称，这从根本上降低了代码中引入意外漏洞或恶意行为的风险。其`Cargo.toml`文件中列出的所有依赖库，如`tokio`、`windows`、`anyhow`、`serde`等，都是Rust生态系统中广泛使用且经过社区验证的标准、成熟、开源的库。这些库通常具有良好的可信度和安全性，不存在明显的可疑行为或已知恶意组件。项目的`README.md`文件清晰、透明地说明了工具的所有功能和工作原理，包括ADS利用和RAR5头部操作等技术细节，这表明其意图是公开且可审计的，而非隐藏恶意功能。

其次，该POC工具的核心功能是“生成”一个利用CVE-2025-8088的WinRAR恶意压缩包。它是一个“攻击载荷生成器”，而不是一个直接的攻击载荷本身。它明确要求用户提供“payload”（攻击载荷文件）和“decoy”（诱饵文件）。这意味着该工具本身不包含任何预设的恶意可执行文件或脚本。工具的开发者没有将恶意代码植入工具内部，而是将生成恶意载荷的能力赋予了工具使用者。因此，从工具开发者向使用者“投毒”的角度来看，风险微乎其微。

然而，尽管POC代码本身无毒，但其作为一种强大的漏洞利用工具，无疑具有被恶意行为者滥用的巨大潜力。恶意攻击者可以下载此POC，结合其自制的恶意payload，生成高度定制化的恶意WinRAR压缩包，并针对目标进行社工钓鱼攻击。例如，如搜索结果所示，UNC4895 (RomCom)、APT44、Turla等间谍组织已被发现利用此漏洞，针对乌克兰军事及政府机构展开攻击，甚至有中国境内的非法攻击团伙也在利用。这些攻击活动往往结合“高度定制化的地缘政治相关诱饵”，显著提升了攻击成功率。这种“武器化利用”是该POC代码的次生风险，即由其功能强大性而非代码本身恶意性带来的风险。

总而言之，该POC代码本身是一份相对“干净”的防御性安全研究工具，专注于漏洞的复现和利用机制的验证，其代码本身不包含恶意功能或隐藏的后门。因此，对下载和分析该POC代码进行防御性研究的用户而言，其直接的投毒风险（例如POC代码本身感染你的分析环境）非常低，大约为10%。但必须高度警惕该工具被不法分子用于生成和散布真实的恶意攻击载荷，这才是该漏洞及其POC所带来的主要威胁。组织在部署防御措施时，不仅要识别和阻止漏洞利用，更要警惕恶意压缩包的传播。

**项目地址:** N/A

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-8088
