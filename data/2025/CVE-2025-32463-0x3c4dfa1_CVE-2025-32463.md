## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危 (Critical)

**CVSS评分:** 9.3

**影响版本:** 1.9.14 至 1.9.17 (不含 1.9.17p1)

**利用条件:** 本地用户权限，系统中安装有受影响版本的sudo且支持-R (chroot) 选项

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该漏洞源于Sudo在处理--chroot（或-R）参数时的逻辑缺陷。在受影响的版本中，当用户指定一个受控目录作为chroot环境时，Sudo未能正确隔离或清理NSS（Name Service Switch）配置的加载路径。提供的POC代码展示了一个典型的NSS库劫持攻击流。首先，脚本创建了一个临时目录并构建了一个伪造的chroot环境；其次，通过向该环境下的/etc/nsswitch.conf写入自定义配置（如passwd: /woot1337），迫使Sudo在特权执行上下文中加载攻击者控制的动态链接库。POC中编译的woot1337.c利用了__attribute__((constructor))特性，在库加载时立即执行。代码调用setreuid(0,0)和setregid(0,0)获取root标识，并最终启动一个bash shell。由于sudo -R在执行时已经具备部分特权，这种通过控制外部配置文件来操纵动态库加载路径的方式能够绕过传统chroot的限制。此POC逻辑清晰，直接针对漏洞触发点，在满足GCC编译器和Sudo版本条件的Linux环境下具有极高的成功率。利用步骤如下：1. 创建攻击者可写的目录结构模拟rootfs；2. 构造恶意的nsswitch.conf配置文件；3. 编译恶意SO库并放置在特定路径；4. 执行sudo -R指向该目录触发库加载。【投毒风险分析】该POC代码的投毒风险评级为低（10%）。代码逻辑完全透明，采用标准的Bash脚本和C语言编写，未经过任何形式的混淆处理（如Base64编码或十六进制转义）。其核心操作包括使用mktemp创建临时文件、使用gcc进行标准编译以及调用系统自带的sudo命令。脚本中不包含任何外部网络请求（如curl或wget下载远程payload），也没有尝试修改系统核心敏感文件（如/etc/shadow）的持久化行为。唯一具有“攻击性”的代码段位于__attribute__((constructor))中，但这属于标准的提权验证逻辑，用于证明漏洞可利用性而非实施恶意破坏。对于防御方而言，此类POC具有较高的研究价值，且由于其代码的可读性，安全审计人员可以轻易确认其安全性。唯一的潜在风险在于用户若在生产环境中盲目运行，可能会因为创建了临时特权Shell而导致非预期的配置更改，但这属于工具使用的副作用而非恶意投毒行为。总体而言，该代码是一个干净、合法的漏洞验证程序。

**项目地址:** 本地分析脚本

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-32463](https://avd.aliyun.com/detail?id=AVD-2025-32463)
