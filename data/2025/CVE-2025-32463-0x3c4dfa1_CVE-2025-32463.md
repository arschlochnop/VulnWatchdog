## CVE-2025-32463 - sudo 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** sudo

**危害等级:** 高危

**CVSS评分:** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** 1.9.14 <= sudo < 1.9.17p1

**利用条件:** 本地普通用户访问权限，目标系统sudo版本在受影响范围内，且具备编译环境（如gcc）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC针对CVE-2025-32463漏洞，利用了sudo在处理chroot选项（-R 或 --chroot）时的安全缺陷。自sudo 1.9.14版本引入增强的chroot功能后，其内部逻辑在切换根目录后未能正确隔离动态链接库的搜索路径。POC通过创建一个用户可控的临时目录作为伪造的根环境（STAGE），并在其中构造恶意的/etc/nsswitch.conf文件。关键点在于，当sudo执行chroot操作时，它会尝试加载NSS（Name Service Switch）库。由于POC将passwd数据库指向了自定义的/woot1337路径，并提前在对应目录下放置了编译好的libnss_woot1337.so.2共享库，sudo在提权执行过程中会加载此恶意库。该库包含一个C构造函数（__attribute__((constructor))），会在库加载时立即执行，调用setreuid(0,0)和setregid(0,0)获取root标识，并启动一个新的bash Shell。经分析，此POC逻辑严密，利用了Linux共享库加载机制与sudo特权执行的逻辑漏洞，在存在漏洞的系统中具有极高的成功率。【利用步骤】1. 创建一个随机的临时工作目录并进入。2. 编写C语言代码，该代码定义了一个构造函数，在加载时执行提权并调用/bin/bash。3. 创建伪造的chroot环境目录结构，包括etc和libnss_子目录。4. 编写恶意的nsswitch.conf，强制系统通过自定义名称查找用户。5. 使用gcc将C代码编译为共享库并放置在特定路径。6. 执行‘sudo -R woot woot’命令，触发sudo的chroot逻辑，导致恶意库被加载并弹出root Shell。【投毒风险分析】该POC脚本的投毒风险评级为低（10%）。代码逻辑透明，使用了标准的Linux系统调用和常见的Bash命令（如mktemp, cat, gcc, sudo）。脚本的主要功能是演示漏洞利用，并没有包含任何混淆手段、远程外联代码或隐蔽的持久化逻辑。其中的__attribute__((constructor))段虽然具有强制执行特性，但这是此类本地提权POC的标准写法，目的是在库加载阶段立即截获进程控制权。唯一需要注意的安全风险是脚本最后使用了'rm -rf'清理环境，虽然这符合POC的规范，但在恶意场景下可能被修改为删除系统关键目录。整体来看，该代码由合法的安全研究社区公开，主要用于防御性验证，不具备典型的恶意投毒特征。研究人员在运行前应检查GCC编译的目标路径，确保不会覆盖系统原有的libnss库。

**项目地址:** [https://www.freebuf.com/articles/vuls/437488.html](https://www.freebuf.com/articles/vuls/437488.html)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
