## CVE-2025-14847 - MongoDB Server 内存披露/堆内存泄露

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 内存披露/堆内存泄露

**影响应用:** MongoDB Server

**危害等级:** 高危 (High)

**CVSS评分:** 8.7 (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**影响版本:** MongoDB 使用 zlib 压缩的网络传输层相关版本 (具体取决于 patch 发布的 LTS 版本)

**利用条件:** 无需认证，远程网络访问，MongoDB 启用了 zlib 压缩

**POC 可用性:** 8/10

**POC 类型:** 完整利用/概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被称为‘MongoBleed’，其根本原因在于MongoDB的zlib解压缩逻辑存在缺陷。在`message_compressor_zlib.cpp`中，服务器根据客户端提供的`uncompressedSize`字段分配堆缓冲区。由于缺乏对实际解压数据长度的校验，漏洞代码直接返回了预分配的、包含旧内存数据的完整缓冲区大小。POC通过发送精心构造的、声明较大`uncompressedSize`但实际解压后数据极小的压缩包，诱导服务器将未初始化的堆内存内容（可能包含数KB的内存残余）回传给攻击者。根据文档分析，该POC已在实验室环境验证成功，能够稳定泄露堆碎片，是一个具备高度实用性的泄露类PoC。【利用步骤】1. 探测目标MongoDB服务是否支持并启用zlib压缩扩展。2. 构造符合MongoDB Wire Protocol协议的压缩请求包。3. 在元数据中声明较大的`uncompressedSize`值（例如32KB），但实际有效负载仅包含少量字节。4. 发送请求后，服务器会分配对应的缓冲区并进行解压，随后因代码逻辑错误，将整个包含未初始化数据的32KB缓冲区作为响应返回。5. 攻击者接收响应并解析其中的二进制流，提取敏感信息。【投毒风险分析】目前该POC以文档和结构化工具形式存在，初步评估其代码逻辑清晰且针对性强。投毒风险较低，但在安全研究领域，此类高价值POC常被利用于供应链投毒：1. 恶意脚本化：POC代码可能被嵌入到伪装的漏洞扫描器中，在执行扫描的同时，隐蔽地将泄露出的内存碎片（如AWS密钥、DB凭证）异步外发至攻击者控制的C2服务器。2. 环境后门：某些自称‘Exploit Lab’的自动化部署脚本可能包含恶意的容器镜像或Base64编码的可执行文件，利用研究人员对实验环境的信任进行内网渗透。3. 虚假补丁：攻击者可能分发伪造的‘一键修复’工具，实则安装持久化后门。建议研究人员仅在隔离环境中运行POC，并对任何涉及网络连接的Python或JS脚本进行代码审计。

**项目地址:** [https://github.com/vulnwatchdog/mongobleed](https://www.google.com/search?q=https://github.com/vulnwatchdog/mongobleed)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14847](https://nvd.nist.gov/vuln/detail/CVE-2025-14847)
