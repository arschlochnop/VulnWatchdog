## CVE-2025-14847 - MongoDB Server 信息泄露

**漏洞编号:** CVE-2025-14847

**漏洞类型:** 信息泄露

**影响应用:** MongoDB Server

**危害等级:** 高危

**CVSS评分:** 8.7 (CVSS:4.0) / 7.5 (CVSS:3.1)

**影响版本:** MongoDB 使用 zlib 压缩协议的相关版本（具体补丁前版本）

**利用条件:** 远程、未经身份验证、启用zlib压缩协议

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：根据提供的文档和技术细节，该漏洞被称为‘MongoBleed’，其原理在于MongoDB网络传输层的zlib解压逻辑存在缺陷。具体漏洞点位于`src/mongo/transport/message_compressor_zlib.cpp`。攻击者通过构造恶意的压缩消息包，在元数据中声明一个较大的`uncompressedSize`（解压后大小），而实际发送的压缩数据解压后远小于该声明值。由于服务器在解压过程中未能正确验证声明长度与实际解压长度的一致性，且在解压失败或部分解压后直接返回了预分配的、包含旧堆内存数据的缓冲区。POC代码验证了这一逻辑，通过发送畸形包可成功获取服务器进程内存中的片段。由于该漏洞触发位于身份验证之前，且泄露的内容可能包含明文数据库凭据、会话令牌、AWS访问密钥等高度敏感信息，因此该POC具有极高的实战价值和利用成功率。 \n\n利用步骤：1. 确认目标MongoDB服务开启并支持zlib消息压缩（这是MongoDB常用的默认配置）。2. 构造符合MongoDB通讯协议的压缩请求包，故意设置错误的`uncompressedSize`参数。3. 发送构造的畸形数据包至目标端口（默认27017）。4. 接收服务器返回的响应，读取响应包中包含的未初始化堆内存数据。5. 对获取的内存片段进行扫描，提取潜在的敏感字符串或认证密钥。 \n\n投毒风险分析：该漏洞研究目前主要由合法的威胁情报团队和安全机构披露。从提供的DOCUMENTATION.md来看，该项目结构清晰，包含了实验室环境、扫描器和代码审计工具，旨在帮助防御者进行风险评估。然而，在威胁情报社区中，此类高关注度的漏洞（尤其是被称为‘XXBleed’的漏洞）极易被恶意攻击者利用进行投毒。常见的投毒方式包括：在提供的‘一键利用脚本’中植入混淆的Base64代码，执行反弹Shell；或在Scanner工具中加入后门，在扫描目标的同时将攻击者的本地机器凭据上传至第三方服务器。目前分析的文档显示代码结构尚属标准，但考虑到‘mongobleed’相关PoC在野外流通较广，用户在下载非官方验证的自动化脚本时需保持高度警惕。建议在隔离的沙箱环境中运行任何公开的PoC脚本，并重点检查网络连接请求是否指向非目标IP。当前文档显示的风险较低，但二次传播的脚本风险极高。

**项目地址:** [https://github.com/phoenix-security/mongobleed-poc](https://www.google.com/search?q=https://github.com/phoenix-security/mongobleed-poc)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-14847](https://nvd.nist.gov/vuln/detail/CVE-2025-14847)
