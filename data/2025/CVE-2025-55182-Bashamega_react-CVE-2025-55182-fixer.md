## CVE-2025-55182 - React Server Components, Next.js RCE

**漏洞编号:** CVE-2025-55182

**漏洞类型:** RCE

**影响应用:** React Server Components, Next.js

**危害等级:** Critical

**CVSS评分:** 10.0

**影响版本:** react-server-dom-webpack, react-server-dom-parcel, react-server-dom-turbopack < 19.2.1, react, react-dom < 19.2.1, next < 14.1.4 (canary 14.3.0-canary.77 or above) or < 16.0.7 (15.x/16.x)

**利用条件:** Unauthenticated, requires network access to the React server.

**POC 可用性:** 9/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 15%

## 详情

CVE-2025-55182 是 React Server Components 中存在的一个远程代码执行 (RCE) 漏洞。该漏洞允许未经身份验证的攻击者通过发送特制的 HTTP 请求，在服务器上执行任意代码。React Server Functions 允许客户端调用服务器上的函数，React 将客户端的请求转换为 HTTP 请求。该漏洞源于对客户端请求的处理不当，导致攻击者可以操纵请求以执行恶意代码。

POC有效性分析：
提供的 POC 代码是一个用于自动修复受 CVE-2025-55182 影响的 React 项目的脚本。该脚本扫描 `package.json` 文件，查找易受攻击的 `react-server-dom-*`、`react`、`react-dom` 和 `next` 包版本，并将它们升级到安全版本。该脚本通过创建分支，提交修复的 `package.json` 并打开包含描述性消息和指向 CVE 披露链接的拉取请求来自动化升级过程。POC 包含完整的利用步骤，并且可以成功缓解漏洞，POC 质量较高。

利用步骤：
1. 确定目标 React 应用使用的 `react-server-dom-*`、`react`、`react-dom` 或 `next` 包版本。
2. 如果版本低于修复版本（`react-server-dom-*`, `react`, `react-dom` < 19.2.1, `next` < 14.1.4 (canary 14.3.0-canary.77 或更高版本) 或 < 16.0.7 (15.x/16.x)），则该应用易受攻击。
3. 使用提供的 POC 脚本自动升级易受攻击的依赖项，或者手动将依赖项更新为安全版本。
4. 审核并测试生成的拉取请求，确保修复程序不会引入任何回归。
5. 将修复程序合并到主代码库中。

投毒风险分析：
该POC的主要目的是帮助开发者快速修复漏洞，降低攻击风险。然而，任何自动化工具都存在被恶意利用的潜在风险。如果攻击者修改 POC 脚本以引入恶意依赖项或执行其他恶意操作，则存在投毒风险。具体来说，攻击者可能：
1. 修改 `index.ts` 文件，指向包含恶意代码的虚假仓库。
2. 在更新依赖项时，将受害者指向包含后门的恶意包。
3. 篡改提交消息和拉取请求描述，以隐藏恶意更改。
由于该工具主要操作 `package.json` 文件并创建拉取请求，因此恶意代码的执行需要用户手动合并拉取请求。此外，该POC依赖于 `npm install` 安装依赖，存在依赖包被劫持的风险，虽然风险较低，但仍需注意。代码清晰，主要使用标准库，但是存在更新依赖的动作，依赖更新存在一定投毒风险，综合评估投毒风险为 15%。

**项目地址:** https://github.com/some-repo/react-server-components-security-pr-automation

**漏洞详情:** https://github.com/advisories/GHSA-fv66-9v8q-g76r
