## CVE-2025-24813 - Apache Tomcat Remote Code Execution

**漏洞编号:** CVE-2025-24813

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Tomcat

**危害等级:** Critical

**CVSS评分:** 9.8

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98, 8.5.0 through 8.5.100

**利用条件:** Unauthenticated network access

**POC 可用性:** 8/10

**POC 类型:** Complete exploit

**攻击复杂度:** Low

**投毒风险:** 30%

## 详情

CVE-2025-24813 is a critical unauthenticated remote code execution vulnerability in Apache Tomcat's partial PUT feature. The vulnerability stems from improper handling of partial PUT requests, allowing attackers to write arbitrary files to the server, potentially leading to remote code execution. 

The provided Python POC, CVE-2025-24813-PoC.py, attempts to exploit this vulnerability. The script begins by displaying a banner and then prompts the user to select a payload. It offers the option to use a default harmless serialized Java object or to provide a custom, hex-encoded payload. If the user chooses the default payload, the script proceeds with a safe, benign payload for detection purposes. If a custom payload is selected, the script validates that the payload starts with the Java serialization magic bytes (AC ED), and proceeds with a warning if not detected.

The exploit works by sending a PUT request to the target server with the chosen payload to a specific URL pattern (/{session_id}.session). The Content-Type is set to "application/octet-stream". Following a successful PUT request (HTTP status code 200, 201, or 204), the script sends a GET request to the target with the session ID in the URL. A successful deserialization trigger is indicated by an HTTP 500 error, suggesting potential Remote Code Execution (RCE) if a malicious payload had been used.

The provided POC offers options to skip SSL verification and configure request timeout, which increases its utility for testing on various environments and configurations. The modular structure of the exploit, specifically offering the choice between a default and a user-provided payload, gives researchers flexibility in testing the vulnerability while mitigating risk during initial assessment. The use of colorama enhances usability of the tool, with informative messages.

**Exploitation Steps:**

1.  Run the CVE-2025-24813-PoC.py script.
2.  Provide the target URL of the vulnerable Apache Tomcat server.
3.  Select a payload option. Choose '1' for the default harmless payload or '2' for a custom hex-encoded payload.
4.  If you choose option '2', enter your hex-encoded payload.
5.  The script sends a PUT request with the chosen payload and then a GET request to trigger deserialization.
6.  Check the output for success messages, specifically an HTTP 500 status code for the GET request.

**Poisoning Risk Analysis:**

The provided POC has a medium poisoning risk. Although the default payload is harmless, the script allows users to input custom payloads, which could be malicious. The prompt to use custom payloads could mislead less experienced users into using payloads from untrusted sources, leading to system compromise. The lack of explicit warnings about the dangers of arbitrary serialized Java objects contributes to the poisoning risk. The script imports the colorama library, which is a standard Python library and doesn't introduce significant risk. The risk is assessed at 30% due to the reliance on user-provided input with limited validation and no built-in payload sanitization or safety checks. The script doesn't include any obfuscation or external script execution, lowering the risk compared to highly poisoned POCs. However, the potential for arbitrary code execution via custom payloads necessitates caution when using this exploit.

**项目地址:** https://github.com/issamjr/CVE-2025-24813-Scanner

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-24813
