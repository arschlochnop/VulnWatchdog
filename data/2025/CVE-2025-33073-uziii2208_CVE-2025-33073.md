## CVE-2025-33073 - Microsoft Windows (SMB客户端组件) 特权提升 (EoP) / NTLM反射

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 特权提升 (EoP) / NTLM反射

**影响应用:** Microsoft Windows (SMB客户端组件)

**危害等级:** 高危 (Critical)

**CVSS评分:** 8.8 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Windows Server 2016, 2019, 2022, Windows 10, Windows 11 (未修补版本)

**利用条件:** 需要拥有普通域用户凭据，目标网络环境未强制执行SMB签名，且攻击者需能够进行DNS记录操作（如具有DNSAdmins权限或利用ADIDNS特性）。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞被确认为Windows SMB客户端处理NTLM认证时的逻辑漏洞。分析披露信息显示，mrxsmb.sys驱动程序在处理编组目标信息时存在缺陷，攻击者可以利用该缺陷绕过微软此前针对NTLM反射攻击部署的缓解措施。所提供的POC代码展示了一个完整的攻击链：首先通过ADIDNS（Active Directory Integrated DNS）向域内注入恶意DNS记录，随后利用PetitPotam等工具强制目标主机（通常为域控或其他高价值服务器）向攻击者控制的监听器发起身份验证。由于该漏洞允许攻击者在SMB连接中伪造目标名并反射认证，攻击者可以将此认证流量中继回目标自身或其他未开启SMB签名的机器。POC代码集成了impacket、netexec和krbrelayx等成熟的渗透工具，通过自动化脚本实现了从凭据获取到SYSTEM权限Shell的完整转换。其有效性在于利用了Windows域环境默认不强制SMB签名的普遍配置弱点，使得普通域用户能够跨越权限边界。利用步骤包括：1. 环境准备，安装impacket与krbrelayx；2. 启动本地NTLM中继服务器并设置监听；3. 运行exploit.sh脚本输入域凭据与目标IP；4. 触发Coerce机制（如PetitPotam）诱导目标连接；5. 中继成功后通过WinRM或SMB执行系统命令。该POC逻辑清晰，对于安全研究人员复现环境具有极高的参考价值。【投毒风险分析】经过对POC脚本内容的静态审计，该项目目前的投毒风险处于较低水平（约15%）。脚本主要由Bash和Python编写，其核心功能是调用知名的开源安全工具。项目README中提到的“自动Flag提取”功能在CTF环境中属于常规自动化操作，但在企业生产环境审计时需注意其对文件系统的扫描行为。尽管目前未发现混淆代码或恶意的后连C2指令，但该仓库（uziii2208/CVE-2025-33073）属于个人维护，且利用脚本中包含`chmod +x`等提权执行操作。防御者在下载此类“一键化”工具时，必须警惕脚本内部是否存在隐蔽的base64编码指令或从第三方未授权服务器下载Payload的行为。建议在隔离的沙箱环境中运行该POC，并重点监控脚本是否尝试修改系统本地管理员密码或安装持久化后门。此外，由于该工具集成了多种第三方库，建议手动从官方仓库安装impacket等依赖，而非运行POC包中可能携带的预编译二进制文件。

**项目地址:** [https://github.com/uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)
