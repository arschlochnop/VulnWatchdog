## CVE-2025-33073 - Microsoft Windows Server 权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升 (Privilege Escalation)

**影响应用:** Microsoft Windows Server

**危害等级:** CRITICAL

**CVSS评分:** 9.8 (Estimated)

**影响版本:** Windows Server 2016, 2019, 2022

**利用条件:** 需要拥有DNSAdmins组权限的域用户凭据，目标DC未强制开启SMB签名，网络可达（SMB, DNS, WinRM）

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

POC有效性分析：该POC代码展现了高度的自动化和集成性。它并非简单的脚本，而是一个针对Active Directory环境的攻击框架。通过结合DNS注入、PetitPotam触发器以及NTLM中继技术，成功绕过了Windows现有的NTLM反射缓解措施。其有效性体现在对impacket和krbrelayx等成熟库的深度整合，能够自动化处理从身份验证、DNS记录篡改到最终SYSTEM权限Shell获取的全过程。README文档详细说明了环境要求和操作步骤，且代码逻辑符合2025年最新披露的SMB客户端漏洞特征，具有极高的实战验证价值。利用步骤：首先，攻击者在攻击机上部署Python环境并安装impacket、netexec等依赖库，克隆krbrelayx项目。第二步，运行提供的exploit.sh脚本，配置攻击者IP、目标DC IP、域名以及具备DNSAdmins权限的账号密码。第三步，脚本会自动启动NTLM中继监听服务器，并生成特定的PetitPotam触发命令。第四步，在另一个终端执行该触发命令，利用DNSAdmins权限向DC添加恶意DNS记录，强制DC向攻击者监听端发起身份验证请求。最后，监听端捕获NTLM请求并将其重定向回DC的WinRM服务，从而获取SYSTEM级别的交互式Shell。投毒风险分析：该POC项目来源于GitHub个人仓库，虽然代码逻辑清晰且依赖于标准的安全研究工具，但存在一定的投毒风险点。首先，脚本中包含‘Auto-Flag Extraction’（自动提取Flag）功能，这种功能常见于CTF工具，但也可能被修改为将敏感数据异步发送至第三方服务器。其次，项目引导用户通过curl/git克隆并运行chmod +x脚本，这在缺乏代码审计的情况下可能导致执行隐藏的恶意Payload。经过对代码片段的初步审查，目前未发现明显的混淆代码或反连接后门，但其‘一键式’操作掩盖了底层的执行细节。防御者在测试时，务必在隔离的实验隔离网段中运行，并重点监控exploit.sh在执行过程中是否发起了非预期的外部HTTPS或DNS隧道请求。考虑到该漏洞是‘域内大杀器’，此类高价值POC极易被黑灰产重包并植入木马，建议仅从受信任的来源获取原始代码。

**项目地址:** [https://github.com/uziii2208/CVE-2025-33073](https://github.com/uziii2208/CVE-2025-33073)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)
