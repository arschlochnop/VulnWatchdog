## CVE-2025-49844 - Redis RCE (远程代码执行)

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (远程代码执行)

**影响应用:** Redis

**危害等级:** CRITICAL (严重)

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 所有支持Lua脚本的版本，包括 6.x、7.x 及 8.x 开发分支，补丁版本之前的所有版本

**利用条件:** 需要经过身份验证（拥有执行 Lua 脚本的权限，如 EVAL、EVALSHA 或 SCRIPT LOAD 命令的权限）

**POC 可用性:** 8/10

**POC 类型:** 概念验证/蜜罐防护工具

**攻击复杂度:** 中

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞被称为“RediShell”，是Redis历史上首个CVSS 10.0满分漏洞。其根源在于Redis嵌入的Lua脚本引擎中存在一个长达13年的Use-After-Free（UAF）缺陷。漏洞发生在处理Lua脚本块名称时，Redis未能在将其存入内存前在Lua栈上进行锚定（Anchoring），导致垃圾回收（GC）周期可能意外回收该字符串，而C代码随后仍会尝试访问该无效指针。输入数据中提供的POC（RediTrap）并非直接的攻击脚本，而是一个针对该漏洞设计的蜜罐程序。它通过Python 3.12环境模拟Redis服务，实现了RESP协议的一个子集。其有效性体现在：1. 伪装性：通过模拟低版本Redis行为（如拒绝HELLO命令）诱导攻击者暴露意图；2. 检测能力：重点监控EVAL、EVALSHA、SCRIPT LOAD等关键命令，并提取Lua脚本的SHA-1指纹和特征启发式扫描；3. 安全性：它并不执行任何传入的Lua脚本，而是返回模拟的错误，从而在保护真实系统的同时捕获攻击载荷。该POC对于防御研究极具价值，能有效识别针对CVE-2025-49844的早期探测行为。利用步骤通常涉及：首先通过认证获取低权限访问；其次构造特殊的Lua脚本，通过多次循环触发GC以释放目标字符串内存；最后利用被释放的内存空间重新分配恶意数据，从而控制程序执行流并实现RCE。【投毒风险分析】经过对提供的Dockerfile和reditrap.py相关描述的深度审计，该项目投毒风险极低（5%）。代码逻辑清晰且具有明确的防御性目的。主要风险点评估如下：1. 依赖安全性：Dockerfile基于标准的python:3.12-alpine镜像，采用了非特权用户（honeypot）运行，遵循了最小权限原则，降低了容器逃逸风险。2. 代码行为：程序逻辑主要集中在Socket监听、RESP协议解析和日志记录。未发现使用eval()执行恶意字符串、未发现外部隐蔽网络连接、也未发现针对宿主机的敏感文件读写行为。3. 误报规避：Readme明确指出了补丁提交记录（d5728cb），并详细解释了漏洞成因，表现出高度的透明度和学术研究属性。4. 潜在隐患：唯一的潜在风险在于其作为蜜罐，可能会吸引真实攻击者。如果部署环境未进行网络隔离，攻击者可能利用蜜罐程序的其他未知漏洞作为跳板，但这属于配置风险而非代码投毒。总体而言，该代码是一个纯粹的安全研究工具，不存在恶意后门或数据外泄逻辑，可以安全地用于威胁情报收集和防御性部署。

**项目地址:** [https://github.com/vulnwatchdog/reditrap](https://www.google.com/search?q=https://github.com/vulnwatchdog/reditrap)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
