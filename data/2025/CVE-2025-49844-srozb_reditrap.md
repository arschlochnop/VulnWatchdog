## CVE-2025-49844 - Redis RCE (Remote Code Execution) / Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** RCE (Remote Code Execution) / Use-After-Free

**影响应用:** Redis

**危害等级:** CRITICAL

**CVSS评分:** 10.0 (CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Redis versions 8.2.1 and below (specifically affecting the embedded Lua engine)

**利用条件:** 需要经过身份验证的远程访问权限（通常是拥有执行EVAL/SCRIPT命令权限的低权限账户）

**POC 可用性:** 4/10

**POC 类型:** 概念验证/蜜罐模拟

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

【POC有效性分析】该提供的POC代码并非直接的漏洞利用脚本（Exploit），而是一个名为‘RediTrap’的防御性蜜罐项目。其有效性体现在防御监控层面而非攻击层面。该项目使用Python 3.12-alpine构建，模拟了一个存在CVE-2025-49844漏洞的Redis实例。核心逻辑位于reditrap.py中，它通过实现Redis序列化协议（RESP）的子集，能够响应PING、INFO、AUTH等基础探测命令，并重点监控EVAL、EVALSHA和SCRIPT LOAD等涉及Lua引擎的操作。项目README明确指出，该漏洞源于Redis在处理Lua脚本时未能在解析前将chunk名压入栈进行锚定，导致垃圾回收（GC）周期内可能释放正在使用的字符串指针，从而触发Use-After-Free（UAF）。此蜜罐POC能有效记录攻击者的Payload（通过SHA-1摘要和令牌启发式分析），但由于其内部逻辑仅返回预设的安全错误响应而不实际执行Lua脚本，因此不会对运行蜜罐的主机造成被反向利用的风险。对于安全研究人员而言，此代码是理解漏洞触发路径（Lua脚本加载阶段）的极佳参考。 【利用步骤】1. 环境准备：通过提供的Dockerfile构建镜像或直接运行Python脚本监听6379端口。2. 探测阶段：攻击者通常会发送INFO或PING确认Redis版本及响应。3. 触发尝试：攻击者构造包含特定内存布局触发逻辑的Lua脚本。4. 漏洞利用：通过EVAL或SCRIPT LOAD发送恶意脚本。在真实漏洞场景中，这会导致Lua引擎内部指针失效并被劫持，最终通过精心构造的内存覆盖实现代码执行。但在本POC（蜜罐）中，步骤停留在记录攻击流量并拦截执行。 【投毒风险分析】经详细审计，该POC项目的投毒风险极低（约10%）。首先，代码逻辑完全透明，基于标准的Python异步库或Socket实现，没有发现任何混淆（Obfuscation）代码。其次，容器镜像采用最小化的Alpine镜像，并遵循非特权用户（honeypot用户）运行的安全实践，有效隔离了宿主机环境。README中提供的GitHub commit链接指向Redis官方修复记录，具有极高的可信度。唯一的潜在风险在于，如果防御者在未加固的生产环境网络中部署此蜜罐，且配置不当导致日志文件权限外泄，可能会暴露内部网络的扫描指纹。代码中未发现任何反连Shell、隐藏的外部请求或恶意下载逻辑。该项目属于典型的‘捕鼠器’设计，旨在收集威胁情报而非实施二次攻击，对安全研究人员来说是安全的工具。用户在使用时只需确保日志存储路径（/data）有适当的配额限制，防止日志爆满导致拒绝服务即可。

**项目地址:** [https://github.com/vulnwatchdog/reditrap](https://www.google.com/search?q=https://github.com/vulnwatchdog/reditrap) (基于代码段推测)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)
