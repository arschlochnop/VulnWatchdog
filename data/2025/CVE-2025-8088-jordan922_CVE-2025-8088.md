## CVE-2025-8088 - WinRAR 路径遍历/RCE

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历/RCE

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4 (CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** <= 7.12

**利用条件:** 用户下载并使用受影响版本的WinRAR解压攻击者构造的恶意压缩包文件，且当前用户具有目标目录的写入权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】该漏洞（CVE-2025-8088）是针对广泛使用的压缩工具WinRAR的一个严重目录遍历缺陷。其核心原理在于利用Windows NTFS备用数据流（ADS）特性，配合路径遍历字符（如“..\”），绕过WinRAR在解压过程中的文件名清理逻辑。通过对提供的Python POC代码分析，该脚本有效利用了subprocess调用WinRAR自带的命令行工具rar.exe，通过“-ep”参数指示排除路径，同时在内部构造了包含“..\..\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\\”的深度嵌套路径。当受害者使用存在漏洞的WinRAR版本（7.12及以下）解压该文件时，WinRAR未能正确解析和限制ADS路径，导致解压引擎将攻击者指定的payload文件（如恶意.exe或.bat）跨目录写入到用户的“启动”文件夹中。从技术实现上看，该POC逻辑清晰，通过Python自动化了原本需要十六进制编辑器手动构造的过程，具有极高的实战化参考价值。它不仅证明了漏洞的存在，还展示了从路径遍历到持久化控制（RCE）的完整利用链条。此漏洞的影响面极大，因为WinRAR拥有海量的个人和企业用户，且攻击载体仅为一个看似普通的RAR压缩包，隐蔽性极强。

【利用步骤】1. 准备攻击负载（Payload），如一个简单的弹出计算器的批处理文件（a.bat）。2. 使用提供的POC脚本，通过命令“python CVE-2025-8088.py -p a.bat -o exploit.rar”生成恶意压缩包。脚本会自动计算并构建指向Windows启动目录的相对路径。3. 将生成的“exploit.rar”发送给目标用户，诱导其进行解压操作。4. 目标用户在解压时，WinRAR会将a.bat释放到“C:\Users\用户名\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\”目录下。5. 当目标用户下次登录系统时，恶意脚本将自动运行，从而实现远程代码执行。

【投毒风险分析】针对该POC代码及README文件的详细审查显示，其投毒风险处于极低水平（5%）。首先，POC脚本本身采用标准的Python库（os, shutil, subprocess, pathlib），代码逻辑完全透明，不存在任何Base64加密、Hex混淆或动态代码执行（如exec/eval）等常见的投毒特征。脚本的逻辑仅限于本地文件操作和调用系统本地的rar.exe，未发现任何网络外连行为（如反弹Shell或请求远程服务器下载第二阶段载荷）。其次，README文档明确标注了该工具仅用于“蓝队防御教育”和“安全研究”，并提供了防御性的审计建议（如扫描ZIP/RAR中的可疑路径），显示了典型的安全研究意图。脚本中包含的“Startup”路径利用属于漏洞验证的核心逻辑，而非隐蔽的恶意行为。唯一潜在的风险点在于，如果攻击者将此脚本作为基础并集成到自动化的恶意软件生成框架中，或者将其发布在不可信的第三方仓库中并夹带木马，但就目前分析的这份代码本身而言，它是安全且具有教育意义的，没有证据表明该代码库被投毒。建议研究人员在隔离环境（VM）中运行此类POC，并确保调用的rar.exe是官方合法版本，以进一步降低环境被污染的风险。

**项目地址:** [https://cloud.tencent.com/developer/article/2563725](https://cloud.tencent.com/developer/article/2563725)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)
