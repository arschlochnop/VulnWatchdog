## CVE-2025-8088 - WinRAR 路径遍历 / 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历 / 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危

**CVSS评分:** 8.4 (CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**影响版本:** WinRAR <= 7.12

**利用条件:** 受害者需要使用存在漏洞的WinRAR版本解压攻击者构造的恶意压缩包，且具备写入启动目录或其他敏感目录的权限。

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该POC代码通过Python脚本调用WinRAR命令行工具（rar.exe）来构造恶意RAR压缩包。其核心逻辑在于利用路径遍历序列（..\..\），配合Windows NTFS备用数据流（ADS）特性，绕过WinRAR在解压过程中的安全过滤机制。分析提供的Python代码发现，它通过定义TRAVERSAL_PATH，将有效载荷（payload）重定向至用户的启动目录（Startup folder）。该POC具备极高的实战价值，因为它不仅展示了漏洞原理，还提供了自动化的构建流程。脚本中使用了标准的subprocess库调用本地环境中的WinRAR程序，符合常规安全研究工具的逻辑。由于该漏洞属于逻辑缺陷，POC在解压时的触发成功率极高，一旦用户执行‘解压到当前文件夹’或‘解压到指定文件夹’操作，文件就会被强制写入预期之外的目录。此POC有效验证了攻击者如何通过目录穿越将恶意程序持久化在系统中，是典型的针对客户端软件的防御性研究样本。【利用步骤】1. 准备一个合法的WinRAR可执行环境（需7.12及以下版本用于验证）。2. 准备一个模拟的恶意载荷文件（如calc.exe或简单的.bat脚本）。3. 运行提供的Python脚本，指定输入载荷路径与输出RAR文件名。脚本将利用WinRAR命令行工具的‘-ep’参数将带有遍历路径的文件压缩。4. 受害者在Windows环境下解压此RAR包。由于WinRAR未对内部路径进行严格校验，解压行为会导致文件被释放至 `%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\`。5. 用户下次登录系统时，位于启动项中的恶意程序将自动执行，完成权限获取。【投毒风险分析】该POC脚本整体代码结构清晰，使用了Python的标准库（os, shutil, pathlib, subprocess, argparse），未发现引入不可信的第三方库或外部网络请求。脚本中虽然包含了‘恶意路径’的定义，但这属于漏洞概念验证的必要组成部分，用于演示如何将文件投递到启动项，不属于投毒行为。风险点主要在于：第一，脚本依赖于本地的 `C:\Program Files\WinRAR\rar.exe`，如果攻击者修改了脚本使其下载并执行远程二进制文件，风险会升高，但当前代码中未见此类逻辑。第二，脚本虽然宣称是‘Safe PoC’，但如果用户在生产环境误操作，可能会导致系统环境被修改。第三，对于安全研究员而言，在下载此类POC时应警惕README中提到的第三方rarfile库，虽然目前该库是公开合法的，但在某些供应链攻击案例中，类似的依赖可能被替换为恶意版本。综合评估，该POC代码本身安全性较高，注释详尽并附带了免责声明，属于低投毒风险的教育性代码，主要风险在于其被滥用而非其本身包含后门。

**项目地址:** 本地分析脚本/无外部URL

**漏洞详情:** [https://avd.aliyun.com/detail?id=AVD-2025-8088](https://avd.aliyun.com/detail?id=AVD-2025-8088)
