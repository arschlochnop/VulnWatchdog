## CVE-2025-27591 - Below (Facebook 监控工具) 本地权限提升 (Privilege Escalation)

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地权限提升 (Privilege Escalation)

**影响应用:** Below (Facebook 监控工具)

**危害等级:** 高 (High)

**CVSS评分:** 7.8 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** < 0.9.0

**利用条件:** 1. 目标系统安装了 0.9.0 之前的 Below 服务；2. /var/log/below 目录权限为 0777（全局可写）；3. 当前用户拥有执行 sudo /usr/bin/below 的 NOPASSWD 权限或其他触发方式。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

【POC有效性分析】：此POC针对CVE-2025-27591漏洞提供了完整的利用逻辑，其核心在于利用Below服务在早期版本中不安全的文件系统权限管理。由于 /var/log/below 目录被设置为 0777（全局可写），且该服务以root权限运行时会向该目录下的日志文件（如error_root.log）写入数据，攻击者可以利用符号链接（Symlink）攻击将该日志文件指向系统关键文件。在提供的POC代码中，脚本首先构造了一个具备root权限的新用户行（evil::0:0...），然后将 /var/log/below/error_root.log 删除并创建一个指向 /etc/passwd 的符号链接。当执行 sudo below snapshot 时，程序会尝试以root身份写入日志，从而将恶意定义的root用户信息覆盖到 /etc/passwd 中。此POC通过环境变量 LOGS_DIRECTORY 确保路径正确，并在最后通过 su evil 成功切换到新创建的root账户。经分析，该代码逻辑严密，利用了Linux标准的文件系统特性，在满足sudo配置的前提下具有极高的成功率。该漏洞的根源在于 Below 服务在初始化时执行了不安全的 chmod 逻辑，而非使用 systemd 的 LogsDirectory 安全特性。通过此POC，研究人员可以清晰地观察到竞态条件和符号链接攻击在特权服务中的危害性。利用步骤如下：1. 确认 /var/log/below 目录权限；2. 创建指向 /etc/passwd 的恶意符号链接；3. 准备恶意用户信息字符串；4. 触发具有root权限的 below 命令；5. 验证 /etc/passwd 被篡改并提权。 【投毒风险分析】：该POC代码及其关联的 Shell 脚本具有极低的投毒风险。脚本内容完全透明，代码总量极短，仅使用了基本的 Linux 系统命令（echo, rm, ln, cat, export, sudo, su），不涉及任何复杂的二进制混淆、动态代码加载或外部网络请求。脚本中虽然执行了修改 /etc/passwd 的操作，但这是本地权限提升 POC 的标准验证行为，旨在证明攻击者可以获得系统控制权，而非恶意窃取数据或植入后门。脚本没有调用任何 curl 或 wget 尝试从远程服务器下载未知脚本，也没有对系统进行破坏性的、不可逆的删除（虽然修改了 passwd，但在受控测试环境中属于预期行为）。代码中的逻辑流向清晰，变量定义简单，且 README 文档中明确标注了教育用途和法律免责声明。由于代码库托管在主流开源平台 GitHub 且由可溯源的开发者维护，其作为针对性攻击工具的可能性极低。经过对 poc.sh 的静态分析，未发现任何隐藏的 Base64 编码字符串或针对分析者的反调试逻辑，因此可以判定该 POC 为安全的防御性研究材料。

**项目地址:** [https://github.com/BridgerAlderson/CVE-2025-27591-PoC](https://github.com/BridgerAlderson/CVE-2025-27591-PoC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)
