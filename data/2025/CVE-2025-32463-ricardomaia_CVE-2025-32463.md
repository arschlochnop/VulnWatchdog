## CVE-2025-32463 - Sudo 本地权限提升 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** 1.9.14 至 1.9.17(不含 1.9.17p1)

**利用条件:** 本地普通用户访问权限，目标系统安装了受影响版本的 Sudo 且支持 --chroot (-R) 选项。

**POC 可用性:** 8/10

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 15%

## 详情

【POC有效性分析】CVE-2025-32463 是 Sudo 历史上一个非常严重的本地提权漏洞。该漏洞源于 Sudo 在处理 --chroot（或 -R）选项时，未能正确隔离动态链接器的配置加载过程。在受影响版本中，Sudo 在切换到目标 chroot 目录后，仍然会读取该目录下的 /etc/nsswitch.conf 文件。攻击者可以通过创建一个恶意的 chroot 目录，并在其中放置精心构造的 nsswitch.conf 以及恶意共享库（.so 文件），从而在 Sudo 执行过程中诱导其加载并以 root 权限执行任意代码。输入数据中的 POC 展示了一个基于 Nuclei 框架的检测实现。该 POC 具有较高的参考价值，因为它将复杂的 C 代码编译和 chroot 环境构建过程集成到了 Nuclei 的 code engine 中。通过在容器化环境中运行，它可以自动创建模拟攻击环境并验证提权可能性。有效性分析显示，该 POC 并非直接提供一键提权的二进制文件，而是通过 Nuclei 模板验证 Sudo 是否在执行过程中错误地尝试访问了受控目录下的敏感配置文件，这种方法比传统的直接提权脚本更具鲁棒性和可检测性。利用步骤通常包括：1. 创建一个普通用户可写的目录作为伪造的根目录；2. 在该目录下建立相应的 /etc 层级并放置恶意的 nsswitch.conf；3. 编译一个导出特定 NSS 函数的恶意共享对象；4. 使用 sudo -R 指向该目录执行任意命令；5. 观察系统是否因加载恶意库而执行了非预期的特权操作。【投毒风险分析】该 POC 的投毒风险评估为低（15%）。主要风险点在于其使用了 Nuclei 的 `code` 引擎，这意味着它会执行模板中嵌入的 Go 代码或编译 C 代码。虽然这在漏洞扫描工具中属于高级功能，但也为恶意代码的隐藏提供了空间。然而，通过对描述和部分代码片段的分析，该作者明确说明了这是为了教学目的而对原始恶意利用代码进行的“安全化”改造，将其从直接获取 root shell 的 Exploit 转变为非侵入式的漏洞检测插件。风险分析显示，项目采用了 Docker 容器化方案进行验证，有效地隔离了宿主机环境。主要的潜在风险在于 Nuclei 模板的签名机制：攻击者可能会诱导用户执行未经审核的签名模板。但在本项目中，代码结构透明，且开发者详细记录了挑战和修改过程，符合安全研究员的发布习惯，未发现明显的混淆、反调试或外部隐蔽通信逻辑。对于防御者而言，最大的风险不在于代码本身的恶意性，而在于在生产环境误运行此类具有提权尝试行为的脚本可能会触发审计警报或导致某些服务状态异常。建议在隔离的沙箱或测试容器中验证此 POC，并重点关注代码引擎执行的编译逻辑是否包含非预期的系统调用。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32463-Nuclei](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32463-Nuclei)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)
