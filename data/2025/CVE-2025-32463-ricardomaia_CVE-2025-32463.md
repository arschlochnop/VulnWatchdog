## CVE-2025-32463 - Sudo 本地提权 (LPE)

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权 (LPE)

**影响应用:** Sudo

**危害等级:** 高危

**CVSS评分:** CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H

**影响版本:** 1.9.14 through 1.9.17 (before 1.9.17p1)

**利用条件:** 需要本地用户访问权限，且Sudo配置允许使用--chroot选项

**POC 可用性:** 9

**POC 类型:** 概念验证

**攻击复杂度:** 中

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 中发现的一个本地提权漏洞，影响版本为 1.9.14 到 1.9.17 (不包含 1.9.17p1)。此漏洞源于 Sudo 在使用 --chroot 选项时对命令匹配处理代码的更新引入的缺陷。具体来说，当 Sudo 以 --chroot 选项执行命令时，它可能会从用户控制的 chroot 环境中加载 `/etc/nsswitch.conf` 文件。攻击者可以利用此漏洞，在一个精心构造的目录中放置恶意的 `nsswitch.conf` 文件，并将其配置为加载一个同样由攻击者控制的恶意动态链接库。当 Sudo 在该 chroot 环境中执行时，会加载恶意的动态库，从而允许攻击者以 root 权限执行任意代码，实现本地权限提升。

**POC有效性分析:**
所提供的POC信息包含一个 `README.md` 文件，详细描述了如何使用 Nuclei 模板来测试 CVE-2025-32463 漏洞。作者明确指出，已将原始的恶意利用代码修改为“安全”版本，旨在“有效测试权限提升问题，而不会像原始漏洞利用那样获取 root shell”。这表明该POC的主要目的是进行漏洞验证和概念证明，而不是直接进行全面攻击。POC的执行流程涉及通过 `docker-compose` 搭建一个包含易受攻击 Sudo 版本的容器化环境，然后利用 Nuclei 的 `code` 引擎执行预先签名的模板。这种设计体现了其作为防御性安全研究工具的价值，能够帮助组织在受控环境中验证漏洞的存在和修复情况。详细的设置和执行指南，包括 Nuclei 模板的签名要求和不同操作系统的执行命令，使得该POC具有很高的可用性和可复现性，对于安全团队评估其系统是否存在漏洞非常有效。它侧重于触发漏洞的机制（即从用户控制的chroot加载恶意`nsswitch.conf`并试图加载库），而非直接获取持久化root权限，从而确保了测试过程的安全性与可控性。

**利用步骤:**
1.  攻击者首先需要获得目标Linux系统上的本地访问权限。
2.  攻击者在文件系统上创建一个恶意目录，并在其中构造一个恶意的 `/etc/nsswitch.conf` 文件，该文件被配置为加载一个由攻击者控制的共享库文件（例如，`.so`文件）。
3.  攻击者还需在该恶意目录中放置上述恶意共享库。
4.  攻击者随后执行一个 Sudo 命令，并使用 `--chroot` 选项指向其精心构造的恶意目录。例如：`sudo --chroot=/path/to/evil_dir <some_command>`。
5.  由于 Sudo 的漏洞，它会在 chroot 环境中查找并加载攻击者提供的恶意 `/etc/nsswitch.conf`。
6.  `nsswitch.conf` 的配置将导致系统加载攻击者提供的恶意共享库，从而在 Sudo 进程的上下文中（即以 root 权限）执行攻击者代码，最终实现本地权限提升。

**投毒风险分析:**
根据提供的POC `README.md` 内容，该POC的投毒风险极低。首先，作者明确声明其目标是创建一个“安全”的漏洞利用，用于测试而非获取root shell，这表明了防御性研究的初衷。其次，该POC利用 Nuclei 框架，特别是其 `code` 引擎，要求模板必须经过签名。Nuclei 的签名机制增加了模板的完整性和来源可信度，降低了恶意篡改的风险。第三，POC的执行环境被设计为完全容器化的 Docker 环境，通过 `docker-compose` 搭建。这种隔离机制确保了漏洞测试活动被限制在独立的环境中，即使POC内部代码存在未预期的行为，也极大程度地减少了对宿主系统的影响。`README.md` 中没有提及任何代码混淆、外部恶意脚本下载、与未知C2服务器通信或任何其他可疑的网络行为。它专注于在受控环境中重现漏洞触发条件，以验证漏洞的存在性。因此，基于这些明确的安全声明、框架特性和隔离的测试方法，评估该POC被用于投毒或包含恶意后门代码的风险在10%以下。然而，任何实际执行的代码（在本例中是Nuclei模板中的C代码或其他脚本）在运行前都应进行审查，以确保其与声明的目标一致。

**项目地址:** 未知

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-32463
