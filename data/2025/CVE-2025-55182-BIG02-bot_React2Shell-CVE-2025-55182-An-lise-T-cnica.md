## CVE-2025-55182 - React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5, and related packages including react-server-dom-webpack, react-server-dom-parcel, react-server-dom-turbopack Remote Code Execution (RCE)

**漏洞编号:** CVE-2025-55182

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** React Server Components (RSC), Next.js, Shopify Hydrogen, Gatsby 5, and related packages including react-server-dom-webpack, react-server-dom-parcel, react-server-dom-turbopack

**危害等级:** Critical

**CVSS评分:** Highly Critical (Exact CVSS not provided, implied by descriptions such as "核弹级漏洞", "高危 RCE 漏洞")

**影响版本:** React 19 (where React Server Components were introduced) and all versions of frameworks/libraries utilizing React Server Components (RSC) that implement the vulnerable deserialization mechanism, including Next.js, Shopify Hydrogen, Gatsby 5, and specifically the packages react-server-dom-webpack, react-server-dom-parcel, react-server-dom-turbopack.

**利用条件:** Unauthenticated, remote, single manipulated HTTP request with network access.

**POC 可用性:** 3

**POC 类型:** 概念验证

**攻击复杂度:** Low

**投毒风险:** 5%

## 详情

CVE-2025-55182, dubbed "React2Shell," is a critical unauthenticated Remote Code Execution (RCE) vulnerability affecting applications built with React Server Components (RSC), particularly those leveraging frameworks like Next.js, Shopify Hydrogen, and Gatsby 5. The vulnerability resides within the "React Flight" protocol, a core component of RSC responsible for serializing server-side data and deserializing client-side requests. React Server Components, introduced in React 19, enable server-side rendering to reduce client-side JavaScript bundle sizes and improve performance. However, an insecure deserialization flaw in this protocol allows attackers to manipulate object property access paths, leading to arbitrary code execution.

The root cause of CVE-2025-55182 is the React Flight protocol's failure to properly validate object property access paths during deserialization. Specifically, by crafting a malicious serialized payload, an attacker can exploit references like "$B" (Blob reference) or "$1:constructor:constructor" (prototype chain access) to traverse the JavaScript prototype chain. The provided conceptual POC highlights `moduleExports[metadata[2]]` as a vulnerable access point which, if `metadata[2]` is controlled by an attacker and resolves to a prototype chain accessor like `__proto__` or `constructor`, can lead to an attacker-controlled `Function` constructor. This mechanism allows the dynamic creation of JavaScript functions with arbitrary system commands. Once this malicious function is created and assigned to an object's `.then` property (a common pattern for asynchronous operations), it can be invoked within the Node.js runtime environment, achieving full compromise of the server. The flaw is considered "核弹级" (nuclear-level) due to its wide impact, low attack complexity, and high severity.

**Exploitation Steps:**
Exploiting CVE-2025-55182 typically involves the following conceptual steps:
1.  **Crafting a Malicious Payload**: An attacker constructs a specially formatted `multipart` form or a custom React Flight protocol payload. This payload is meticulously designed to include specific markers (e.g., "$B", "$1:constructor:constructor") and values that, when deserialized, will trigger the prototype chain pollution.
2.  **Triggering Insecure Deserialization**: The crafted payload is sent to the vulnerable React Server Components endpoint. The server, in an attempt to process the React Flight request, deserializes the malicious input without adequate validation of object property access.
3.  **Prototype Chain Traversal/Pollution**: During deserialization, the attacker-controlled input leverages the lack of validation to traverse the JavaScript prototype chain. This allows the attacker to reach fundamental JavaScript objects, such as the `Function` constructor.
4.  **Dynamic Function Creation**: By manipulating the prototype chain, the attacker can hijack existing object methods or properties (e.g., in Next.js, `_formData.get` can be coerced into a `Function` object). This allows the attacker to dynamically inject and create new JavaScript functions containing arbitrary system commands (e.g., `require('child_process').exec('rm -rf /')`).
5.  **Code Execution**: The dynamically created malicious function is then assigned to a property that will be automatically invoked by the application's runtime, such as a `.then` property of a Promise-like object. When this property is accessed or resolved, the attacker's arbitrary code is executed with the privileges of the server process.

**POC Effectiveness Analysis:**
The provided "POC code" is not a traditional runnable script or exploit; rather, it is a detailed `README.md` document that serves as a conceptual proof-of-concept for CVE-2025-55182 (React2Shell). The document, authored in Portuguese, meticulously outlines the security concepts, affected technologies (React Server Components, Next.js, specific `react-server-dom-*` packages), and the architectural context (RSC rendering flow, React Flight protocol). It explicitly describes the root cause of the vulnerability, pinpointing `moduleExports[metadata[2]]` as the vulnerable JavaScript access pattern that permits prototype chain traversal and ultimately leads to arbitrary code execution via the `Function` constructor.

The `README.md` effectively communicates the high-level exploitation flow, mentioning a "Payload serializado manipulado" leading to "Traversal da prototype chain" and "Criação dinâmica de função JavaScript" for "Execução de código no Node.js." It lists potential consequences such as "leitura de arquivos sensíveis," "acesso a variáveis de ambiente," and "execução de comandos do sistema." While it lacks direct exploit code, specific payloads, or step-by-step instructions for reproduction, its detailed explanation of the underlying mechanisms, relevant markers ("$@", "$B", "$1:constructor:constructor"), and impact makes it an invaluable educational resource. For defensive security teams, this conceptual POC offers sufficient technical depth to understand how the vulnerability works, enabling the development of effective detection signatures and mitigation strategies. Its clarity and focus on concepts, despite being non-executable, rate it as a high-quality *conceptual proof-of-concept*, providing strong theoretical understanding.

**Poisoning Risk Analysis:**
The poisoning risk associated with this specific "POC" (the `README.md` file) is extremely low, assessed at 5%. This low rating is primarily because the provided content is a purely descriptive, non-executable markdown document. It does not contain any active code, scripts, binaries, external links to suspicious resources, or obfuscated payloads that could directly harm a system. The repository explicitly states its "finalidade exclusivamente educacional e defensiva" and clarifies that it does "não contendo respostas, flags ou walkthrough completo da plataforma."

Since there is no executable component, the `README.md` cannot inherently introduce malicious software, establish backdoors, perform unwanted network requests, or compromise the integrity of a system simply by being downloaded or viewed. The risk is limited to theoretical scenarios where an attacker might manually attempt to implement the described exploitation concepts using their own malicious code, but the provided `README` itself is inert. Therefore, while always exercising caution when dealing with security-related content, the direct threat from this particular "POC" to a defensive researcher's environment is negligible. The 5% accounts for a general baseline of vigilance, but there are no specific indicators of malicious intent or hidden functionalities within the provided content that would elevate this risk.

**项目地址:** Not publicly available in provided data.

**漏洞详情:** Not available in provided data.
