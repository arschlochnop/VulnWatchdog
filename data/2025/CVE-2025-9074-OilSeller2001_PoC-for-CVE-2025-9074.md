## CVE-2025-9074 - Docker Desktop 容器逃逸/越权访问/未经认证的API访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/越权访问/未经认证的API访问

**影响应用:** Docker Desktop

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop for Windows and macOS prior to 4.44.3

**利用条件:** 需要本地或远程网络访问，且Docker Engine API通过TCP端口2375在没有TLS的情况下暴露，无需认证即可利用。此配置并非默认，但一旦启用则存在风险。默认子网通常为192.168.65.7:2375。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

CVE-2025-9074是Docker Desktop中的一个严重安全漏洞，影响在Windows和macOS系统上运行的Docker Desktop应用程序。该漏洞允许本地运行的恶意Linux容器绕过隔离机制，通过默认子网（通常是192.168.65.7:2375）直接访问未经认证的Docker Engine API。其本质是一个容器越权访问及逃逸漏洞，使得攻击者可以突破容器沙箱，获得对宿主机文件系统的完全控制，进而导致主机被完全接管。该漏洞的CVSS评分为9.3，被标记为严重级别。漏洞的根本原因在于Docker Desktop在特定配置下（尤其是在“Expose daemon on tcp://localhost:2375 without TLS”选项被启用时）会暴露未经认证的Docker Engine API，从而允许任何能够访问该端口的本地或远程攻击者与Docker守护进程进行交互，并执行特权操作。Docker官方已于2025年8月20日在Docker Desktop 4.44.3版本中修复了此漏洞，建议所有受影响的用户尽快升级。

**POC有效性分析与利用步骤：**
提供的POC（`CVE-2025-9074 - Docker API Unauthenticated Access PoC`）是一个功能完整、文档详尽的概念验证工具，旨在演示该漏洞的利用方式。该POC使用Python 3及`requests`库实现，其核心逻辑在于利用未经认证的Docker Engine API，创建一个恶意容器并挂载宿主机的文件系统，从而实现容器逃逸和主机接管。

POC的利用步骤如下：
1.  **环境准备：** 攻击者首先需要确保目标Docker Desktop环境中的Docker Engine API已通过TCP端口2375暴露且未启用TLS认证。在Docker Desktop中，这通常通过启用“Settings → General → Expose daemon on tcp://localhost:2375 without TLS”选项来完成。POC文档明确警告此操作的风险，强调不应在生产环境中启用。
2.  **API可用性检查：** POC脚本首先会尝试访问目标`IP:2375/info`端点，以确认Docker API是否可达且响应正常，这是后续利用的前提。
3.  **拉取基础镜像：** 为了创建恶意容器，POC会拉取一个基础镜像（如`alpine`）。这是标准Docker操作，用于确保后续容器的创建能够顺利进行。
4.  **准备恶意容器负载：** POC随后构造一个容器创建请求，其关键在于在容器配置中包含一个`bind mount`，将宿主机的根文件系统（`/`）挂载到容器内部的特定路径（例如`/mnt`）。这是实现容器逃逸、获取宿主机文件系统访问权限的核心机制。
5.  **创建与启动容器：** POC向Docker Engine API发送容器创建请求，随后发送启动请求。一旦容器成功启动，攻击者便通过该容器获得了对宿主机文件系统的访问权限。
6.  **后渗透操作：** POC提供了一个示例后渗透步骤，即通过`docker exec -it <container_id> sh`进入恶意容器，然后执行`ls /mnt`来列出宿主机根目录的内容，从而直观地验证了对宿主机文件系统的完全访问能力。

该POC逻辑清晰，步骤完整，对漏洞的利用原理进行了有效且直观的演示，能够充分证明该漏洞的严重性和实际可利用性。其提供的详细设置指南和验证方法也使得复现过程相对简单。

**投毒风险分析：**
基于对所提供的POC代码（通过README.md描述推断）和其背景信息的分析，该POC的投毒风险评估为**10%**，属于低风险范畴。

**风险分析点：**
1.  **代码来源与内容透明度：** 该POC的GitHub仓库信息（`zenzue/CVE-2025-9074`）表明它是一个公开且有作者的工具。README.md文件提供了详细的概述、漏洞细节、使用方法、本地测试设置以及利用步骤，代码逻辑完全透明且符合漏洞利用的描述。它明确声明使用Python和`requests`库，没有提及使用任何非标准、可疑或混淆的第三方库或二进制文件。
2.  **意图与免责声明：** POC的“Legal Disclaimer”部分明确指出“for educational and authorized security testing purposes only”，并且警告“Unauthorized exploitation of systems is illegal and unethical”。这种明确的教育和安全测试目的声明，以及对非法使用的警告，是判断其初始意图为良性的重要依据。它还特别警告用户在启用“Expose daemon on tcp://localhost:2375 without TLS”选项时的风险，进一步体现了负责任的安全研究态度。
3.  **行为模式：** POC的核心行为是与Docker Engine API进行交互，执行拉取镜像、创建容器和启动容器等标准Docker操作。其“恶意”之处在于创建容器时通过`bind mount`挂载宿主机文件系统，这是为了演示漏洞的利用效果，而非植入真正的恶意payload或执行秘密的攻击行为。所有操作都是针对目标Docker守护进程的，没有迹象表明它会尝试连接外部恶意服务器、下载并执行任意代码、修改系统关键配置或进行数据窃取。
4.  **依赖项：** POC仅依赖Python 3.x和`requests`库，都是常见的、经过良好审查的开源库。没有发现引入未知或易受攻击的外部脚本或模块。
5.  **代码混淆与加密：** 从提供的README和描述中，没有迹象表明POC代码存在混淆、加密或任何试图隐藏其真实意图的手段。代码逻辑预计是清晰且易于审计的。

**结论：**
尽管任何用于漏洞利用的工具都可能被滥用，但此POC本身的设计、文档和公开信息均表明其是一个用于合法安全研究和测试的工具。它清晰地演示了漏洞的利用方式，但并未包含或暗示任何额外的恶意功能。因此，将其直接作为“投毒”工具的风险极低。在使用此类工具时，仍然建议安全团队对实际代码进行审查，以防范未来可能出现的恶意修改或变种。

**项目地址:** https://github.com/zenzue/CVE-2025-9074

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
