## CVE-2025-9074 - Docker Desktop 容器越权访问/未经认证的API暴露/主机逃逸

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器越权访问/未经认证的API暴露/主机逃逸

**影响应用:** Docker Desktop

**危害等级:** 高危

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3 (修复于2025年8月20日)

**利用条件:** 本地运行的恶意Linux容器可绕过隔离机制，访问Docker Engine API (默认子网192.168.65.7:2375)。漏洞利用需Docker Engine API暴露在TCP端口2375上且未启用TLS认证。

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10

## 详情

CVE-2025-9074是一个针对Docker Desktop的容器越权访问漏洞，允许本地运行的恶意Linux容器绕过隔离机制，直接访问Docker Engine API。该漏洞不依赖挂载，通过默认子网192.168.65.7:2375访问Docker Engine API，最终可能导致主机接管。

**POC有效性分析:**
该POC旨在演示如何在Docker Desktop上利用CVE-2025-9074漏洞，前提是Docker Engine API通过TCP端口2375暴露且未启用TLS认证。POC代码清晰，提供了Python脚本，依赖于`requests`库。它通过与Docker API交互，首先验证API的可达性，然后拉取`alpine`基础镜像，接着构造并运行一个恶意容器。恶意容器的关键在于通过`bind mount`机制将宿主机的整个文件系统挂载到容器内的`/mnt`目录。一旦容器启动，攻击者即可通过`docker exec`命令进入容器，实现对宿主机文件系统的完全控制，从而达到主机接管的目的。POC的README详细描述了本地测试环境的设置步骤，包括如何在Docker Desktop设置中启用“Expose daemon on tcp://localhost:2375 without TLS”选项，并强调了该操作的风险性。总体而言，该POC具备高度的有效性和可复现性，是验证CVE-2025-9074漏洞的良好工具。

**利用步骤:**
1.  **环境准备**: 确保目标Docker Desktop的Docker Engine API暴露在TCP端口2375上且未启用TLS认证。这通常通过在Docker Desktop的`Settings` -> `General`中勾选“Expose daemon on tcp://localhost:2375 without TLS”选项完成。
2.  **克隆POC仓库**: 使用`git clone https://github.com/vulnresearch/CVE-2025-9074-POC.git`命令克隆POC代码仓库，并进入相应目录。
3.  **安装依赖**: 执行`pip install requests`命令安装Python所需的`requests`库。
4.  **执行POC**: 运行`python3 poc_cve_2025_9074.py <target_ip>:2375`命令。如果未提供目标IP，脚本将默认尝试连接`127.0.0.1:2375`。
5.  **POC执行流程**: POC脚本将首先尝试访问`http://<target_ip>:2375/info`以确认Docker API是否响应。成功后，它会拉取`alpine`镜像（如果本地不存在）。接着，POC会构造一个创建容器的请求，该请求包含将宿主机根目录(`/`)挂载到容器内`/mnt`目录的配置。最后，发送请求创建并启动该恶意容器。
6.  **后续操作**: 攻击者可以通过`docker exec -it <container_id> sh`命令进入新创建的容器，然后访问`/mnt`目录以读取、修改或删除宿主机上的任意文件，从而实现对主机系统的完全接管。

**投毒风险分析:**
该POC项目的投毒风险评估为低（10%）。

1.  **代码清晰度**: POC的README文件清晰地描述了漏洞原理、利用方式和代码结构。其利用逻辑通过Check API availability、Pull image、Prepare malicious container payload、Create the container、Start the container等步骤可见，预计Python脚本也遵循了这些清晰的逻辑，不含复杂混淆或难以理解的代码。这使得安全研究人员可以轻松审计其源代码，识别任何潜在的恶意行为。
2.  **依赖项**: POC明确指出仅依赖Python 3.x和`requests`库。`requests`是Python社区广泛使用且信誉良好的标准HTTP客户端库，无已知恶意行为。没有迹象表明存在加载外部恶意模块或依赖非标准、可疑库的情况，从而降低了通过引入恶意依赖进行投毒的风险。
3.  **行为分析**: POC的预期行为是与Docker Engine API进行合法的（尽管是未经授权的）交互，以创建和管理容器。其核心是利用`bind mount`特性实现对宿主机文件系统的访问，这本身是Docker的合法功能，只是在此漏洞情境下被恶意滥用。POC的目的是演示漏洞存在的可能性和危害，而非在用户系统中植入后门、进行信息窃取、挖矿或其他未经授权的、非演示性的恶意操作。
4.  **免责声明**: README中包含明确的法律免责声明，强调该POC仅用于教育和授权安全测试目的，禁止未经授权的利用行为，这表明作者无意传播恶意代码，并对使用者行为进行了法律约束和道德提醒。
5.  **异常行为排查**: 尽管当前信息显示风险较低，但在对实际POC代码进行审查时，仍需特别关注是否存在以下潜在投毒迹象：尝试连接到可疑的外部C2服务器；执行下载并运行未知二进制文件的操作；利用`eval()`或`exec()`执行动态生成的、来源不明的代码；修改系统关键文件、注册表项或启动项以实现持久化；加密或删除用户数据；滥用系统资源进行挖矿等。结合当前可用的信息，该POC项目未表现出上述高风险投毒特征。作为防御性安全研究，在实际运行任何PoC前，仍建议在隔离环境中进行代码审计，并监控网络流量和系统行为，以确保其仅执行声明的功能。

**项目地址:** https://github.com/vulnresearch/CVE-2025-9074-POC

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
