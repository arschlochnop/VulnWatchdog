## CVE-2025-9074 - Docker Engine API 远程代码执行 (RCE)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Docker Engine API

**危害等级:** 高危

**CVSS评分:** 根据PoC描述，攻击者可远程未认证访问Docker API并完全控制宿主机文件系统，危害等级极高。CVSS评分预计在9.8分左右 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)。

**影响版本:** 所有配置为在TCP端口2375上暴露且未启用TLS认证的Docker Engine API版本

**利用条件:** 远程未认证访问。目标系统需在TCP端口2375上暴露Docker Engine API，且未启用TLS认证。攻击者需要网络可达性。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

基于提供的CVE-2025-9074 PoC（Proof-of-Concept）的`README.md`文件，该漏洞涉及Docker Engine API的未认证暴露，攻击者通过访问TCP端口2375上的未受保护API，能够完全控制宿主机。这个PoC是一个功能完整且高度有效的利用工具，能够导致宿主机文件系统被完全访问，进而实现远程代码执行。

**POC有效性分析与利用步骤**：
该PoC的设计思路是利用Docker API的合法功能，通过未认证访问实现恶意目的。其有效性体现在能够成功模拟攻击者与Docker守护进程的交互，从而达到主机妥协。具体步骤如下：
1.  **环境检查**：PoC脚本首先会尝试连接目标IP:2375上的Docker API，通过访问`/info`端点来验证API是否可达且未受认证保护。如果API响应包含`ServerVersion`等信息，则表示漏洞环境存在。
2.  **基础镜像拉取**：为确保后续恶意容器的创建，PoC会尝试拉取一个轻量级的基础镜像，例如`alpine`，作为攻击载体的基础。
3.  **构建恶意容器载荷**：这是攻击的核心。PoC会构造一个特殊的容器创建请求，其中包含一个关键的“bind mount”配置。这个配置将宿主机的整个根文件系统（`/`）映射到即将创建的新容器内部的一个指定路径，通常是`/mnt`。
4.  **创建与启动容器**：PoC随后向Docker API发送容器创建请求，并在容器成功创建后立即启动它。此时，恶意容器已在目标宿主机上运行，并拥有对宿主机文件系统的访问权限。
5.  **宿主机妥协**：一旦容器启动，攻击者便可以通过`docker exec -it <container_id> sh`等命令进入容器的shell。在容器内部，攻击者可以通过访问`/mnt`目录，直接读写、修改宿主机的任何文件。这相当于获得了宿主机的最高权限，可执行任意命令，植入后门，窃取数据，实现完全的远程代码执行和系统控制。
该PoC提供了详细的本地测试设置指导，包括如何在Docker Desktop中暴露API，进一步验证了其复现能力和有效性。其步骤逻辑清晰，易于理解和执行，具备高度的实战价值。

**投毒风险分析**：
鉴于该PoC的描述，其投毒风险被评估为**低**，约为10%。主要基于以下几点分析：
1.  **明确的合法声明**：PoC的`README.md`中包含了清晰的法律免责声明，明确指出其用途仅限于“教育和授权的安全测试目的”，而非非法攻击。这种声明在一定程度上降低了其被恶意利用的直接风险，并强调了代码提供者的防御性研究意图。
2.  **透明的利用逻辑**：PoC描述的利用步骤是基于Docker API的公开功能和常见误配置，没有涉及复杂的混淆技术、加密代码或利用未知漏洞。其操作（检查API、拉取镜像、创建带挂载的容器）都是Docker的常规操作，使得代码行为可预测且易于审计。描述中也未提及从外部不明链接下载并执行脚本或使用`eval()`等高风险函数。
3.  **无明显恶意载荷**：PoC主要利用了Docker自身的特性来获取文件系统访问权限，而非自带恶意软件或病毒。它以`alpine`等基础镜像为载体，本身不包含额外恶意组件。
然而，任何开源的PoC都存在固有风险，因此不能完全排除投毒可能性：
1.  **二次篡改风险**：PoC代码在互联网上传播时，可能被恶意攻击者篡改，植入后门、挖矿脚本或其他恶意载荷。用户在下载后未经验证直接运行，可能面临被投毒的风险。
2.  **供应链风险**：如果PoC所依赖的Python `requests`库或其任何间接依赖项存在漏洞或被投毒，也可能间接影响PoC的安全性。
3.  **误用风险**：即使PoC本身无恶意，但若被缺乏安全意识的用户在生产环境或未经授权的系统上运行，仍可能造成严重的业务中断或数据泄露。恶意行为者也可能将其整合到自动化攻击框架中。
综上所述，虽然此PoC本身的描述未显示直接的恶意行为，但考虑到代码传播和使用的复杂性，仍有低度的被篡改或滥用风险，故给予10%的投毒风险评估。建议用户在执行任何PoC前，务必仔细审查代码来源和内容。

**项目地址:** https://github.com/<your-username>/CVE-2025-9074-POC.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
