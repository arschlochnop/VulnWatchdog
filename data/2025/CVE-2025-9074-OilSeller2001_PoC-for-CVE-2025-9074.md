## CVE-2025-9074 - Docker Desktop (Windows/macOS) 容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问

**影响应用:** Docker Desktop (Windows/macOS)

**危害等级:** 高危/严重

**CVSS评分:** 9.3

**影响版本:** Docker Desktop < 4.44.3

**利用条件:** 攻击者需在受害者主机上运行恶意Linux容器，且Docker Engine API通过TCP端口2375（默认子网192.168.65.7:2375或localhost:2375）暴露且无需认证（即未启用TLS），或通过网络可达该端口。

**POC 可用性:** 10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5%

## 详情

CVE-2025-9074是一个影响Docker Desktop应用程序的严重安全漏洞，其核心问题在于Docker Engine API在特定配置下会通过TCP端口2375在本地（或潜在地远程）暴露，且无需任何认证。这使得本地运行的恶意Linux容器能够绕过Docker的隔离机制，直接访问和控制宿主机的Docker Engine。攻击者一旦获得对该API的访问权限，即可通过创建带有宿主机文件系统绑定挂载的恶意容器，实现宿主机文件系统完全控制，从而导致宿主机被完全攻陷。该漏洞主要影响Docker Desktop在Windows和macOS系统上的部署。官方已在Docker Desktop 4.44.3版本中修复此漏洞。

**POC有效性分析**:
提供的PoC是一个用Python编写的脚本，名为`poc_cve_2025-9074.py`。该PoC设计清晰，文档详尽，具有极高的有效性。PoC的README文件不仅详细说明了漏洞原理、影响、修复版本，还提供了本地测试环境的搭建步骤（即如何在Docker Desktop中启用“Expose daemon on tcp://localhost:2375 without TLS”选项），以及如何验证API是否正确暴露的`curl`命令。
PoC的执行流程严格遵循漏洞利用逻辑：首先检查API可用性以确认Docker Engine API可达且响应；然后拉取`alpine`镜像为后续创建恶意容器做准备；接着构建一个容器创建请求，其中包含一个关键的绑定挂载配置，将宿主机的根目录`/`挂载到容器内的`/mnt`目录；最后通过发送API请求创建并启动该恶意容器。PoC文档进一步指导用户如何通过`docker exec`进入容器，然后通过`ls /mnt`等命令验证是否成功访问到宿主机的根文件系统。整个流程逻辑严谨，代码实现直接通过HTTP请求与Docker API交互，不依赖任何复杂的技巧，因此在满足利用条件（Docker API暴露且无认证）的情况下，PoC是完全可用和可靠的。其清晰的步骤和详细的文档使得复现和验证漏洞变得非常简单。鉴于其完整性和详细的指导，该PoC质量评分为10/10。

**利用步骤**:
1.  **前置条件**: 确保目标Docker Desktop环境存在漏洞（版本低于4.44.3），并且Docker Engine API已通过TCP端口2375暴露且无需TLS认证。在本地测试时，需要在Docker Desktop设置中手动勾选“Expose daemon on tcp://localhost:2375 without TLS”并重启。
2.  **安装依赖**: 在攻击者机器上安装Python 3.x和`requests`库：`pip install requests`。
3.  **克隆PoC仓库**: `git clone https://github.com/<your-username>/CVE-2025-9074-POC.git && cd CVE-2025-9074-POC`。
4.  **执行PoC**: 运行Python脚本，指定目标Docker Engine API的地址。例如，针对本地环境：`python3 poc_cve_2025_9074.py 127.0.0.1:2375`。如果未提供目标，脚本会提示输入并默认使用`127.0.0.1:2375`。
5.  **验证**: PoC成功执行后，将显示创建的容器ID。攻击者可以使用`docker exec -it <container_id> sh`进入新创建的容器，然后执行`ls /mnt`命令，此时将看到宿主机的根文件系统内容，表明容器逃逸成功，并获得了宿主机文件系统的访问权限。

**投毒风险分析**:
该PoC代码的投毒风险极低，评分为5%。主要理由如下：
1.  **代码清晰度与可审计性**: PoC的核心逻辑是围绕使用Python `requests`库向Docker Engine API发送HTTP请求展开的。这种实现方式通常具有高度的透明性，代码结构简单直接，没有复杂的逻辑分支、加密或混淆技术。这意味着安全研究人员可以轻松地审查其源代码，理解每一行代码的意图和行为，从而有效地识别任何潜在的恶意载荷或非预期功能。其核心功能是构造一个Docker容器创建请求，并在其中嵌入宿主机文件系统的绑定挂载点，这是容器逃逸漏洞利用的标准和公开技术，而非隐蔽的恶意行为。
2.  **明确的法律免责声明和教育目的**: PoC的README文件明确包含了“Legal Disclaimer”，指出该工具仅用于教育和授权的安全测试目的。这种声明表明了作者遵循道德规范的意图，降低了其主动在PoC中嵌入恶意代码的可能性。此外，其详细的文档和复现指导也主要服务于安全研究和防御，而非为了传播恶意软件。
3.  **无外部可疑资源或通信**: 对PoC的分析表明，它没有涉及下载、执行任何来自未知源的外部脚本或二进制文件，也没有进行异常的加密通信，或者向外部IP地址发送非预期的敏感数据回传。PoC的所有操作都集中在与目标Docker API的本地或可控网络交互上。其依赖项仅限于标准的Python 3.x和`requests`库，这些都是广泛使用且经过充分审查的开源组件，本身不带有恶意属性。
4.  **利用方式的透明性**: 漏洞的利用方式——通过未认证的Docker API创建恶意容器，并利用绑定挂载将宿主机的根文件系统映射到容器内部——在PoC中被清晰地展示和解释。PoC自身并不执行超出验证漏洞和展示攻击路径范围的任何额外恶意操作。例如，它不会自动安装后门、删除文件或进行加密勒索，而是提供一个通过容器访问宿主机文件系统的入口点，其后的“恶意”行为是用户为了验证漏洞而手动执行的，并非PoC脚本的固有行为。综上所述，虽然任何能够获取高权限的工具都具有被恶意滥用的风险，但从该PoC的代码结构、行为模式、文档声明及其透明的利用方式来看，其自身不包含恶意载荷或投毒机制。因此，其投毒风险被评估为极低。

**项目地址:** https://github.com/<your-username>/CVE-2025-9074-POC.git

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
