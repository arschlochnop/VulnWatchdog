## CVE-2025-9074 - Docker Desktop (Windows/macOS) 未授权API访问导致容器逃逸/主机系统破坏 (Unauthenticated API Access leading to Container Escape/Host Compromise)

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权API访问导致容器逃逸/主机系统破坏 (Unauthenticated API Access leading to Container Escape/Host Compromise)

**影响应用:** Docker Desktop (Windows/macOS)

**危害等级:** 严重

**CVSS评分:** 9.3

**影响版本:** <= 4.44.2

**利用条件:** 远程访问、无需认证、Docker Desktop API端口2375需暴露且未启用TLS

**POC 可用性:** 9

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 5

## 详情

POC有效性分析：
提供的CVE-2025-9074 PoC文档详细描述了其利用Docker Desktop中未授权的Docker Engine API（默认在TCP端口2375暴露）的有效性。该PoC的README内容清晰，表明这是一个功能完整且易于使用的利用工具。PoC的利用链设计巧妙：首先，它会检测目标主机的Docker API是否可访问。一旦确认API开放，它便会拉取一个基础Docker镜像（例如Alpine）。接着，PoC的核心是构造一个恶意容器，其关键在于通过绑定挂载（bind mount）将宿主机的整个文件系统根目录（`/`）挂载到容器内部的特定路径（例如`/mnt`）。容器启动后，攻击者便可执行`docker exec`命令进入容器的shell环境，并直接访问并操控宿主机的 `/mnt` 目录，从而达到对宿主系统的完全控制。PoC文档包含了详细的本地测试设置指南，包括如何在Docker Desktop中启用脆弱的API暴露选项，以及明确警告了在生产环境中启用此选项的巨大风险。这表明PoC的作者对漏洞的理解深入，且致力于提供一个可靠且负责任的研究工具。

利用步骤：
1.  **漏洞环境准备**：目标系统必须运行受影响版本的Docker Desktop，并且Docker Engine API在TCP端口2375上被暴露，且未启用TLS。在测试环境中，这通常通过Docker Desktop的“Settings -> General”中勾选“Expose daemon on tcp://localhost:2375 without TLS”选项来模拟。请务必注意，此操作会极大地降低系统的安全性。
2.  **获取PoC代码**：从GitHub仓库克隆CVE-2025-9074的PoC代码。例如，可以通过`git clone https://github.com/Shaoshi17/CVE-2025-9074-Docker-Exploit.git`命令完成。
3.  **安装依赖**：进入PoC目录，并安装所需的Python依赖库，主要是`requests`，通过`pip install requests`命令完成。
4.  **执行PoC脚本**：运行PoC脚本，指定目标Docker API的地址和端口。例如：`python3 poc_cve_2025_9074.py <target_ip>:2375`。如果未提供目标，脚本通常会默认尝试连接本地的`127.0.0.1:2375`。
5.  **API可用性检查**：PoC脚本首先会发送请求到目标API的`/info`端点，以验证Docker API是否正常响应且无需认证。
6.  **拉取基础镜像**：为后续容器创建做准备，PoC会拉取一个轻量级的Docker基础镜像（如`alpine`）。
7.  **创建并启动恶意容器**：PoC会构造一个包含特定配置的容器创建请求，该配置的核心是将宿主机的根文件系统`/`绑定挂载到容器内部的`/mnt`目录。之后，PoC会发送请求创建并启动该容器。
8.  **执行后利用操作**：一旦恶意容器成功启动，攻击者即可通过`docker exec -it <container_id> sh`命令进入容器的shell。在容器内部，攻击者可以通过访问`/mnt`目录来查看、修改或删除宿主机上的任意文件，从而实现完全的系统控制。

投毒风险分析：
根据提供的PoC README信息，该PoC本身的直接“投毒风险”评估为**低**（约5%）。PoC的README明确声明其目的在于“教育和授权的安全测试”，并强调“未经授权的系统利用是非法的和不道德的”，这表明其创建者的意图是合法的安全研究而非恶意攻击。PoC所依赖的Python `requests`库是一个标准的、广泛使用的网络请求库，没有迹象表明其使用了混淆代码、外部恶意脚本、非标准二进制文件或任何其他可疑组件。其利用流程透明且易于理解，没有隐藏任何恶意载荷或后门功能。文档中还明确警告用户，在生产环境中启用Docker API的未加密未认证暴露是极其危险的行为，这种风险警示进一步降低了PoC代码本身被视为具有恶意意图的可能性。

然而，尽管PoC代码描述自身是“干净”的，但其公开可用的性质会带来以下间接风险：
1.  **恶意利用便利化**：PoC的发布极大地降低了利用CVE-2025-9074漏洞的技术门槛。未经授权的攻击者可以利用此PoC作为基础，快速开发出具有恶意功能的利用工具，例如植入勒索软件、窃取敏感数据、建立持久化后门或加入僵尸网络。
2.  **供应链攻击风险**：如果PoC所在的GitHub仓库遭到恶意接管，其内容可能会被替换为真正的恶意代码，导致下载并使用该PoC的用户无意中受到感染。因此，即使是合法PoC，在下载和使用前也应进行代码审计和安全检查。
3.  **误用风险**：不具备足够安全意识或技能的用户可能会在不安全的生产环境中错误地配置Docker Desktop，或在未经授权的情况下运行此PoC，从而意外地暴露或损害其系统。

综上所述，虽然PoC描述本身无毒，但其披露大大增加了漏洞被恶意利用的可能性。组织应将防御重点放在及时将Docker Desktop更新至安全版本（4.44.3及更高版本），并严格审查和管理Docker Engine API的暴露配置，确保在任何情况下都不会在生产环境中启用未认证、未加密的API访问。

**项目地址:** https://github.com/Shaoshi17/CVE-2025-9074-Docker-Exploit

**漏洞详情:** https://nvd.nist.gov/vuln/detail/CVE-2025-9074
