## CVE-2025-9074 - Docker Desktop (Windows and macOS) 容器逃逸/未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 容器逃逸/未授权访问

**影响应用:** Docker Desktop (Windows and macOS)

**危害等级:** CRITICAL

**CVSS评分:** 9.3 (CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H)

**影响版本:** Docker Desktop 4.34 之前的版本 (具体版本需根据官方通告确认为 2025年8月修复前的版本)

**利用条件:** 本地运行恶意Linux容器，且Docker子网接口(192.168.65.7:2375)未受适当隔离限制

**POC 可用性:** 8/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 15%

## 详情

【POC有效性分析】该漏洞（CVE-2025-9074）是Docker Desktop中的一个关键安全缺陷，源于其Linux容器隔离机制的不完善。在受影响的版本中，Docker Desktop内部的网络配置（通常是192.168.65.7）默认开启了无认证的Docker Engine API服务。这意味着在Docker环境中运行的任何Linux容器，只需通过网络访问该特定的子网IP和2375端口，即可直接与宿主机的Docker守护进程交互。提供的PoC代码展示了这一利用路径的极高有效性：它首先验证API的可访问性，随后通过标准API请求拉取轻量级镜像（如alpine），并创建一个带有宿主机根目录挂载（bind mount）的恶意容器。由于Docker API拥有管理容器的最高权限，攻击者通过此API创建的新容器可以轻易挂载宿主机的磁盘驱动器。这种利用方式不依赖于复杂的内核漏洞，而是利用了配置不当的逻辑缺陷，因此在未修复的环境中成功率接近100%。【利用步骤】1. 在Docker Desktop环境中启动一个普通的Linux容器作为跳板；2. 在容器内通过网络工具（如curl或python脚本）访问硬编码的内部关口IP 192.168.65.7:2375；3. 调用Docker API的容器创建接口（/containers/create），在HostConfig参数中设置Binds将宿主机根路径（如Windows的C盘或macOS的根目录）映射到容器内部路径（如/mnt/host）；4. 启动该恶意容器并进入交互式Shell；5. 通过访问挂载点实现对宿主机敏感文件的读写，或通过修改计划任务、写入SSH密钥等方式实现宿主机完全控制。【投毒风险分析】该PoC代码逻辑清晰，主要使用了Python的requests标准库进行HTTP请求，未发现混淆代码或可疑的远程下载执行逻辑（如使用os.system或eval执行不明Base64字符）。PoC的目的是通过合法的Docker API调用来演示权限提升，虽然利用结果具有高度破坏性（获取宿主机控制权），但代码本身属于典型的安全研究验证脚本。投毒风险评估为15%，主要风险点在于PoC中引导用户开启‘Expose daemon on tcp://localhost:2375 without TLS’的设置，这虽然是测试环境所需，但如果用户在生产环境误操作且未关闭，会留下长期的未授权访问后门。此外，README中的git clone链接被脱敏处理，用户在寻找真实仓库时需警惕可能被恶意攻击者仿冒的‘全自动一键脚本’，这些第三方脚本往往会夹带持久化后门或信息窃取程序。建议研究人员仅在隔离的沙箱中运行此类POC，并严格审查其网络请求目标。

**项目地址:** [https://github.com/vulnwatchdog/CVE-2025-9074-POC](https://www.google.com/search?q=https://github.com/vulnwatchdog/CVE-2025-9074-POC)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)
