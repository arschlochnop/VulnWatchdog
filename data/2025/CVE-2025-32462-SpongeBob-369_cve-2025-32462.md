## CVE-2025-32462 - Sudo 权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危 (High)

**CVSS评分:** 7.8 (AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**影响版本:** Sudo 1.9.17p1 之前的版本

**利用条件:** 攻击者需拥有本地普通用户权限，且目标系统配置了非默认的 sudoers 规则（特别是指定了特定主机的 host-based 规则，如在 LDAP 环境或共享 sudoers 文件的集群中）。

**POC 可用性:** 9/10

**POC 类型:** 完整利用

**攻击复杂度:** 低

**投毒风险:** 10%

## 详情

【POC有效性分析】该POC通过Dockerfile和Shell脚本构建了一个高度仿真的受漏洞影响的环境。在Dockerfile中，它特意编译安装了受影响的旧版本Sudo（1.9.15p5），并模拟了一个在复杂网络环境下常见的错误配置：为用户'ubuntu'赋予了针对特定主机'fakehost'的NOPASSWD权限。POC的有效性在于它准确地触发了Sudo在处理--host (-h) 选项时的逻辑缺陷。在正常的Sudo逻辑中，-h选项应仅与-l（列出权限）配合使用，以查看在其他主机上的权限；然而，受影响的版本允许将-h选项与-i（交互式shell）或其他命令执行选项结合使用。这意味着，如果用户在sudoers中被允许在主机B上以root执行命令，而该用户当前登录在共享同一份sudoers配置的主机A上，他可以通过'sudo -h 主机B -i'越权获得主机A的root权限。本POC通过简单的命令行演示了这一过程，经分析其逻辑严密，能够稳定复现提权过程。【利用步骤】1. 构建容器：通过run.sh执行docker build。2. 进入容器环境：容器启动后自动切换至普通用户'ubuntu'。3. 验证权限分配：执行'sudo -l'，系统会提示输入密码（用户并不知道），显示该用户在当前本机上没有直接提权权限。4. 探测远程权限：执行'sudo -l -h fakehost'，由于sudoers中定义了对fakehost的免密权限，此处会显示该权限。5. 实施提权：执行'sudo -i -h fakehost'，Sudo未能正确拦截非-l场景下的主机规则，导致用户直接在当前物理系统上获取root Shell。【投毒风险分析】该POC项目的代码透明度较高。核心逻辑由一个标准的Dockerfile和一个简单的引导脚本run.sh组成。在Dockerfile中，软件源和依赖安装均采用官方APT仓库，Sudo源码包从官方dist地址下载，未发现重定向至恶意域名的行为。README中提供的Shell指令为标准的Git和Docker操作，不存在混淆或隐藏命令。代码中没有发现典型的恶意投毒特征，如尝试读取宿主机敏感文件（/etc/shadow等）、反弹Shell、下载并执行混淆脚本、修改系统启动项等行为。由于其运行在Docker容器隔离环境中，对本地主机的直接威胁极低。唯一的潜在风险点是引用的外部GitHub仓库（SpongeBob-369/cve-2025-32462）的完整性，但基于当前提供的POC文本分析，该代码纯粹用于安全研究和漏洞演示，属于低风险范畴。

**项目地址:** [https://github.com/SpongeBob-369/cve-2025-32462.git](https://github.com/SpongeBob-369/cve-2025-32462.git)

**漏洞详情:** [https://nvd.nist.gov/vuln/detail/CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)
