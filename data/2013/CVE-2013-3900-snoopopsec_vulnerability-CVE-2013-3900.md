# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

# CVE-2013-3900

> 📦 该CVE有 **12** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md](../2013/CVE-2013-3900-AdenilsonSantos_WinVerifyTrust.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #2

**来源**: [CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md](../2013/CVE-2013-3900-CyberCondor_Fix-WinVerifyTrustSignatureValidationVuln.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本广泛，具体参考漏洞库信息

**利用条件:** 需要用户运行或安装被篡改的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，允许攻击者修改已签名的 PE 文件，并在不使签名失效的情况下添加恶意代码。该漏洞利用方式依赖于修改PE文件，然后诱使用户执行。提供的 PowerShell 脚本 (Fix-WinVerifyTrustSignatureValidationVuln.ps1) 并非漏洞利用代码，而是缓解措施，通过设置 `EnableCertPaddingCheck` 注册表项来启用更严格的签名验证行为。搜索引擎结果也指向该注册表项是缓解此漏洞的有效方法。由于脚本的功能是加固系统而非利用漏洞，因此不存在投毒风险。

**利用方式：**

1.  攻击者需要获取一个合法的、已签名的 PE 文件。
2.  攻击者修改此 PE 文件，在文件内部增加恶意代码，利用签名验证的缺陷使得签名仍然有效。
3.  攻击者诱骗用户运行或安装此被篡改的 PE 文件（例如，通过社会工程学）。
4.  当用户运行此文件时，恶意代码将在用户系统上执行，攻击者可以完全控制受影响的系统。

**有效性：**

提供的漏洞利用代码是缓解脚本，能防御该漏洞，而不是利用该漏洞，因此是有效。但是否能完全防御成功，取决于多种因素。

**投毒风险：**

提供的 PowerShell 脚本的目的是缓解 CVE-2013-3900 漏洞，它通过修改注册表来启用更严格的证书填充检查。 代码逻辑清晰，仅包含创建或修改注册表项的功能，没有发现任何可疑或恶意的代码，因此投毒风险为 0%。脚本旨在修复漏洞，而非利用。


**项目地址:** [CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln](https://github.com/CyberCondor/Fix-WinVerifyTrustSignatureValidationVuln)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #3

**来源**: [CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md](../2013/CVE-2013-3900-DavidBr27_CVE-2013-3900-Remediation-Script.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 代码执行

**影响应用:** Windows

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 用户或应用程序运行或安装特制的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中的远程代码执行漏洞。 攻击者可以通过修改已签名的可执行文件，利用未验证的部分，从而在不使签名失效的情况下向文件中添加恶意代码。漏洞利用方式是通过构造恶意的PE文件，该文件在签名验证时利用WinVerifyTrust函数的漏洞，允许未授权的代码执行。

提供的PowerShell脚本不是漏洞利用代码，而是**缓解措施**，用于设置注册表项`EnableCertPaddingCheck`以启用更严格的证书填充检查，从而修复此漏洞。该脚本检查并设置注册表中两个路径下的`EnableCertPaddingCheck`值为1，然后重启系统使更改生效。由于该脚本的目的是修复漏洞而不是利用漏洞，因此不存在投毒风险。

**项目地址:** [DavidBr27/CVE-2013-3900-Remediation-Script](https://github.com/DavidBr27/CVE-2013-3900-Remediation-Script)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #4

**来源**: [CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md](../2013/CVE-2013-3900-Kramcov_CVE-2013-3900-PowerShell-PoC.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows版本众多，包括Windows 10和Windows 11等。具体版本请参考漏洞库信息。

**利用条件:** 需要用户运行或安装被修改的、带有恶意填充的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件，在不破坏签名的情况下，添加恶意代码。 

**有效性：**
提供的PoC代码(`CVE-2013-3900-PoC-padding-injection.ps1`) 旨在通过在签名PE文件的证书表中注入填充数据来利用此漏洞。脚本首先读取输入文件，解析PE结构，定位证书表，然后添加指定数量的填充字节。最后，脚本更新证书表的大小和文件长度，并将修改后的文件写入输出。脚本还会检查原始文件和修改后文件的 Authenticode 签名状态，并使用 `WinVerifyTrust` 函数进行验证。

**投毒风险：**
PoC代码本身的主要目的是演示漏洞利用，但仍存在潜在的投毒风险，例如：
*   **Payload携带：** 脚本可以被修改以在填充数据中嵌入恶意payload，从而在目标系统上执行恶意代码。
*   **后门植入：** 攻击者可能在脚本中添加后门代码，以便在目标系统上建立持久访问。

考虑到脚本的目的是演示签名绕过，且主要功能是填充数据，因此投毒风险较低，但不可忽视。这里评估投毒风险为10%。

**利用方式：**
1.  **选择目标PE文件：** 选择一个已签名（embedded-signed）的PE文件作为目标。
2.  **运行PoC脚本：** 使用提供的 PowerShell 脚本 (`CVE-2013-3900-PoC-padding-injection.ps1`)，指定输入文件、输出文件和填充字节数。
3.  **脚本执行过程：**
    *   脚本会读取目标PE文件。
    *   解析PE文件头，定位到证书表。
    *   在证书表中插入指定数量的填充字节。
    *   更新证书表的大小和文件长度。
    *   将修改后的文件写入输出文件。
4.  **签名验证绕过：** 修改后的PE文件，虽然被添加了填充数据，但签名仍然有效，可以通过 WinVerifyTrust 函数的验证，从而绕过签名验证机制。
5.  **执行恶意代码：** 如果填充数据中包含恶意代码，则在执行修改后的PE文件时，恶意代码也会被执行。

**项目地址:** [Kramcov/CVE-2013-3900-PowerShell-PoC](https://github.com/Kramcov/CVE-2013-3900-PowerShell-PoC)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #5

**来源**: [CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md](../2013/CVE-2013-3900-OtisSymbos_CVE-2013-3900-WinTrustVerify.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，攻击者可能通过修改已签名文件植入恶意代码

**影响版本:** 受影响的Windows版本众多，请参考漏洞库信息

**利用条件:** 用户需要运行或安装被篡改的、经过签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中。攻击者可以通过修改已签名的可执行文件（PE 文件），利用文件中未验证的部分，在不使签名失效的情况下向文件中添加恶意代码。漏洞利用的关键在于篡改已签名的PE文件，然后诱使用户运行或安装该文件。

**有效性分析：**

根据搜索结果和漏洞库信息，缓解此漏洞的关键在于启用 `EnableCertPaddingCheck` 注册表项。提供的 PowerShell 脚本 `enable_cert_padding_check.ps1` 正是用于设置该注册表项，因此从缓解角度来看，该脚本是有效的。

**投毒风险分析：**

该 PowerShell 脚本的功能非常明确，就是设置注册表项。代码中没有发现任何可疑操作，例如下载恶意文件、执行 shell 命令等。因此，投毒风险较低。

**利用方式分析：**

1.  **攻击者制作恶意PE文件：** 攻击者首先需要找到或创建一个合法的PE文件，并对其进行签名。
2.  **篡改PE文件：** 攻击者修改PE文件，在签名验证过程中未被覆盖的部分添加恶意代码。这通常涉及到对PE文件结构的深入理解。
3.  **诱骗用户执行：** 攻击者通过各种手段（例如，社会工程学）诱骗用户运行或安装被篡改的PE文件。
4.  **代码执行：** 如果系统未启用 `EnableCertPaddingCheck` ，WinVerifyTrust 函数可能无法正确验证签名，从而允许恶意代码执行。

**缓解措施：**

通过运行 `enable_cert_padding_check.ps1` 脚本，可以启用 `EnableCertPaddingCheck` 注册表项，从而增强签名验证的严格性，缓解此漏洞。

**项目地址:** [OtisSymbos/CVE-2013-3900-WinTrustVerify](https://github.com/OtisSymbos/CVE-2013-3900-WinTrustVerify)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #6

**来源**: [CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md](../2013/CVE-2013-3900-Sabecomoeh_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危 (取决于上下文和CVSS评分)

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 用户或应用程序需要运行或安装被篡改的、已签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2013-3900 涉及 WinVerifyTrust 函数在处理 Windows Authenticode 签名验证时存在的问题，攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下添加恶意代码，从而绕过签名验证。 

**有效性：**
提供的 PowerShell 脚本 `Checking_Diplaying.ps1` 并非漏洞利用代码，而是用于检测目标系统是否已配置相应的注册表项以缓解此漏洞。脚本检查 `EnableCertPaddingCheck` 注册表项在以下路径中是否存在，以及是否被设置为 `1`：
  * `HKLM:\Software\Microsoft\Cryptography\Wintrust\Config` (64位系统)
  * `HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config` (32位应用程序在64位系统上运行)
如果注册表项不存在或未正确设置，脚本会提示相应的修复措施。

虽然此脚本本身不能直接利用漏洞，但可以帮助确定系统是否存在潜在的风险。

真正的漏洞利用需要构造一个恶意的PE文件，利用 WinVerifyTrust 函数的缺陷来执行未经验证的代码。 由于微软已经发布了补丁，成功的利用取决于系统是否打了补丁以及注册表项是否正确设置。

**投毒风险：**
此 PowerShell 脚本的主要功能是读取注册表值并显示状态，以及提供修复建议。仔细审查脚本代码后，发现**没有明显的恶意代码或后门**，但存在极低的投毒风险。以下是分析过程：

*   **代码功能单一：** 脚本主要执行注册表读取和状态显示，逻辑相对简单，没有进行网络连接或文件写入等可疑操作。
*   **公开可见：** 脚本代码完全公开，易于审查。隐藏恶意代码的难度较高。
*   **潜在风险：** 极低的风险在于，攻击者可能会篡改脚本的显示信息，误导用户认为系统已安全，而实际上漏洞仍然存在。或者通过修改脚本的修复建议，引导用户进行错误配置，反而引入安全风险。

因此，此脚本的投毒风险较低，估计在**5%** 左右，主要来自于篡改显示信息或修复建议的可能性，而非直接执行恶意代码。

**利用方式：**
1.  **漏洞存在：** 首先，目标系统必须存在 CVE-2013-3900 漏洞，即未安装相应的安全补丁，并且 `EnableCertPaddingCheck` 注册表项未设置为 `1`。
2.  **恶意PE文件：** 攻击者需要准备一个经过特殊构造的 PE 文件，该文件利用 WinVerifyTrust 函数的签名验证缺陷，在签名有效的情况下包含恶意代码。
3.  **诱骗执行：** 攻击者需要诱骗用户运行或安装此恶意 PE 文件，例如通过社交工程、钓鱼邮件、恶意网站等方式。由于需要用户交互，漏洞利用的成功率取决于用户的警惕性。
4.  **代码执行：** 一旦用户运行恶意 PE 文件，WinVerifyTrust 函数会错误地验证签名，导致恶意代码得以执行，攻击者从而获得对系统的控制权。

**项目地址:** [Sabecomoeh/CVE-2013-3900](https://github.com/Sabecomoeh/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #7

**来源**: [CVE-2013-3900-Securenetology_CVE-2013-3900.md](../2013/CVE-2013-3900-Securenetology_CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #8

**来源**: [CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md](../2013/CVE-2013-3900-malaya-m_cve-2013-3900-remediation-report.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #9

**来源**: [CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md](../2013/CVE-2013-3900-oukridrig772_-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation.md)

## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #10

**来源**: [CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md](../2013/CVE-2013-3900-piranhap_CVE-2013-3900_Remediation_PowerShell.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** 受影响的Windows操作系统版本（见漏洞库信息）

**利用条件:** 用户或应用程序需要运行或安装被篡改的签名PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900是一个Windows WinVerifyTrust函数处理 Authenticode 签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，添加恶意代码而不使签名失效。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且可以通过修改PE文件来利用。 提供的POC代码 `tool.ps1` 本身不是漏洞利用代码，而是**缓解措施**，它通过修改注册表键值 `EnableCertPaddingCheck` 来启用或禁用证书填充检查。启用此检查可以缓解此漏洞。因此，提供的代码**不能直接用于漏洞利用，而是用于修复漏洞**。

**投毒风险：**
提供的PowerShell脚本 `tool.ps1` 的目的是修改注册表以启用或禁用证书填充检查，从而缓解 CVE-2013-3900 漏洞。 该脚本相对简单，逻辑清晰，只包含读取用户输入、判断输入值，以及修改注册表的操作。 检查了脚本中的关键操作，例如注册表路径和键名，与缓解 CVE-2013-3900 漏洞所需的设置一致。 没有发现任何可疑的代码或行为，例如执行外部命令、下载恶意文件或收集敏感信息。 此外，脚本的目的是修复漏洞，而不是利用漏洞，这降低了作者故意添加恶意代码的可能性。 因此，该脚本中存在作者隐藏的投毒代码的风险非常低，可以判断投毒风险为0%。

**利用方式：**
攻击者需要篡改已签名的PE文件，在未验证的部分添加恶意代码，然后在目标系统上执行该文件。如果目标系统未启用证书填充检查，则WinVerifyTrust函数不会验证PE文件中添加的恶意代码，从而导致恶意代码执行。 攻击方式通常涉及以下步骤：

1.  获取一个合法的、已签名的PE文件。
2.  在PE文件的PKCS7部分或其他未验证的区域添加恶意代码。
3.  诱骗用户或应用程序运行或安装被篡改的PE文件。

**缓解措施：**
可以通过设置注册表键值 `EnableCertPaddingCheck` 为1来启用证书填充检查，从而缓解此漏洞。提供的 `tool.ps1` 脚本可以自动化此过程。需要管理员权限才能运行此脚本并修改注册表。


**项目地址:** [piranhap/CVE-2013-3900_Remediation_PowerShell](https://github.com/piranhap/CVE-2013-3900_Remediation_PowerShell)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #11

**来源**: [CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md](../2013/CVE-2013-3900-pkblanks_Remediating-CVE-2013-3900-EnableCertPaddingCheck-.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危，但如果用户具有管理员权限，则可能升级为高危

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2019, Windows Server 2022等，具体版本见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装特制的、签名的PE文件

**POC 可用性:** 是，但提供的POC代码只是一个README文件，不包含实际利用代码

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞源于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式存在缺陷。攻击者可以通过修改已签名的可执行文件，在不使签名失效的情况下，添加恶意代码。此漏洞需要用户运行恶意构造的PE文件。缓解措施是启用证书填充检查（EnableCertPaddingCheck）通过修改注册表实现。由于提供的POC代码只是一个README文件，因此无法直接验证漏洞的有效性，但根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被利用过。提供的漏洞利用代码仓库中只包含一个README文件，因此不存在投毒风险。

**项目地址:** [pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-](https://github.com/pkblanks/Remediating-CVE-2013-3900-EnableCertPaddingCheck-)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---

## POC #12

**来源**: [CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md](../2013/CVE-2013-3900-snoopopsec_vulnerability-CVE-2013-3900.md)

## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 所有受支持的Windows版本（需配置注册表）

**利用条件:** 用户或应用程序运行或安装被篡改的、已签名的PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WinVerifyTrust函数处理Windows Authenticode签名验证的方式中。攻击者可以通过修改已签名的PE文件，在不破坏签名的情况下，向文件中添加恶意代码。漏洞利用依赖于用户执行被修改的PE文件。提供的POC代码是注册表文件，用于启用或禁用`EnableCertPaddingCheck`，该值启用更严格的证书填充检查。默认情况下，Windows未启用此检查。利用方式是首先禁用`EnableCertPaddingCheck`（如果已启用），然后修改签名文件，诱导用户运行。要修复此漏洞，需要将`EnableCertPaddingCheck`设置为“1”，以启用更严格的验证。

**项目地址:** [snoopopsec/vulnerability-CVE-2013-3900](https://github.com/snoopopsec/vulnerability-CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)

---



---



---



---



---



---



---



---



---

