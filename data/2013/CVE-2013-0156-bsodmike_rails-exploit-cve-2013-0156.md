# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **7** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md](../2013/CVE-2013-0156-bsodmike_rails-exploit-cve-2013-0156.md)

# CVE-2013-0156

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2013-0156-Jjdt12_kuang_grade_mk11.md](../2013/CVE-2013-0156-Jjdt12_kuang_grade_mk11.md)

## CVE-2013-0156-Rails-XML参数处理对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 应用程序使用受影响版本的Rails，并且允许处理XML格式的参数。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Ruby on Rails框架的`active_support/core_ext/hash/conversions.rb`文件中，由于其在处理XML或YAML参数时未正确限制字符串值的强制转换，攻击者可以通过构造恶意的XML或YAML数据，触发对象注入漏洞，从而执行任意代码或造成拒绝服务。

**利用方式：**

提供的POC代码`mk11.sh`是一个伪shell，它通过以下步骤利用漏洞：

1.  **接收命令：** 脚本接收用户输入的命令。
2.  **Base64编码：** 将命令进行Base64编码，防止特殊字符干扰。
3.  **构造Payload：**  构建一个包含恶意Ruby代码的XML Payload。此Payload利用了Rails中YAML/XML解析时可能存在的对象反序列化漏洞。Payload的核心在于`ActionDispatch::Routing::RouteSet::NamedRouteCollection`和`OpenStruct`等类的使用，这些类在特定情况下可以被用来执行任意代码。其中关键的一段是 `eval(%[${command_string}].unpack(%[m0])[0])`，这段代码将Base64编码后的命令字符串解码并执行。
4.  **发送请求：** 将构造的XML Payload作为POST请求发送到目标服务器。
5.  **获取输出：**  在攻击服务器上部署Web服务，然后通过日志分析（如Apache的access.log）获取命令执行的结果（通过curl命令）。使用分隔符`^`来提取Base64编码的输出，并进行解码显示。

**有效性：**

根据漏洞描述和POC代码，该漏洞利用是有效的，只要目标应用程序使用了受影响版本的Rails，并且允许处理XML格式的参数，攻击者就可以通过构造恶意的XML Payload来执行任意命令。

**投毒风险：**

该POC代码的投毒风险较低，约为1%。 主要风险点在于URL `<YOUR_ATTACKING_SERVER>`需要替换为攻击者自己的服务器。如果用户不小心使用了他人提供的恶意`mk11.sh`脚本，并且未检查脚本中的URL，则可能导致信息泄露给攻击者。

需要注意的是，此POC依赖于目标服务器访问日志，因此在某些配置下可能不可用。

**项目地址:** [Jjdt12/kuang_grade_mk11](https://github.com/Jjdt12/kuang_grade_mk11)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #2

**来源**: [CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md](../2013/CVE-2013-0156-R3dKn33-zz_CVE-2013-0156.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 目标应用使用存在漏洞的Rails版本，并且允许解析XML格式的请求参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 是一个 Ruby on Rails 框架中的对象注入漏洞。该漏洞源于 Rails 在处理 XML 或 YAML 格式的请求参数时，未能正确地限制字符串值的类型转换。攻击者可以通过构造恶意的 XML 或 YAML 数据，将其作为请求参数发送到存在漏洞的 Rails 应用。由于Rails会尝试将字符串转换为相应的 Ruby 对象，攻击者可以在 YAML 数据中嵌入 Ruby 代码，从而执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 Ruby 对象的 XML 或 YAML 数据，例如使用 `!ruby/hash` 或 `!ruby/struct` 等标签。
2.  将构造的恶意数据作为请求参数，通过 POST 请求发送到 Rails 应用。
3.  Rails 应用解析 XML/YAML 数据，尝试将恶意数据转换为 Ruby 对象，触发代码执行。

**有效性：**

提供的 Python 脚本 `CVE-2013-0156.py` 尝试利用 CVE-2013-0156 漏洞。该脚本：

*   定义了目标 URL 和要执行的命令。
*   构造包含恶意 Ruby 对象的 XML payload，其中包含嵌入的 Ruby 代码。
*   设置请求头 `Content-Type` 为 `text/xml`，并使用 `X-HTTP-Method-Override: get`，绕过某些安全限制。
*   发送 POST 请求到目标 URL，并检查响应状态码。

**投毒风险：**

检查提供的漏洞利用代码。代码本身的行为是尝试利用 CVE-2013-0156 漏洞在目标系统上执行命令。代码中没有明显的、不相关的恶意行为。payload 部分的代码目的是利用 YAML 反序列化漏洞。用于执行命令的部分，与漏洞描述一致，没有发现额外的后门或恶意代码。

**总结：**

该 POC 代码旨在利用 CVE-2013-0156 漏洞。它构造了恶意的 XML payload，包含可执行的 Ruby 代码，并通过 `X-HTTP-Method-Override` 绕过可能的安全限制，尝试远程执行命令。 根据代码内容分析，未发现作者隐藏的恶意或投毒代码。

**项目地址:** [R3dKn33-zz/CVE-2013-0156](https://github.com/R3dKn33-zz/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #3

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #4

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---



---

## POC #4

**来源**: [CVE-2013-0156-heroku_heroku-CVE-2013-0156.md](../2013/CVE-2013-0156-heroku_heroku-CVE-2013-0156.md)

## CVE-2013-0156 - Ruby on Rails 对象注入漏洞

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 需要利用 Action Pack 的 YAML 或 Symbol 类型转换功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-0156 存在于 Ruby on Rails 的 `active_support/core_ext/hash/conversions.rb` 文件中。由于 Rails 在处理 XML 参数时，对字符串值的类型转换限制不足，攻击者可以通过构造恶意的 YAML 或 Symbol 数据，进行对象注入攻击，从而执行任意代码或造成拒绝服务。提供的POC代码 `heroku-CVE-2013-0156.rb` 实际上是一个检测 Heroku 应用所使用的 Rails 版本是否受此漏洞影响的脚本，并非直接的漏洞利用代码。它通过 `heroku run bundle show rails --app #{app}` 命令来获取 Rails 版本号，并判断是否在受影响的版本范围内。由于该脚本的目的是检测漏洞存在性，而不是执行恶意操作，因此不存在投毒风险。但是此脚本已被 CVE-2013-0333 替代。漏洞的利用方式是通过发送包含恶意构造的 YAML 或 Symbol 数据的 HTTP 请求，利用 Rails 的参数解析功能触发对象注入。由于搜索结果为空，主要依据漏洞库信息和给定的漏洞利用代码进行分析。

**项目地址:** [heroku/heroku-CVE-2013-0156](https://github.com/heroku/heroku-CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #5

**来源**: [CVE-2013-0156-josal_crack-0.1.8-fixed.md](../2013/CVE-2013-0156-josal_crack-0.1.8-fixed.md)

## CVE-2013-0156

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/代码执行/拒绝服务

**影响应用:** Ruby on Rails

**危害等级:** 高危

**影响版本:** before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标应用使用了存在漏洞的Ruby on Rails版本，并且允许解析YAML或Symbol类型转换的请求参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是Ruby on Rails框架中的一个严重漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。该漏洞源于Rails未能正确限制字符串值的类型转换，允许攻击者通过利用Action Pack对YAML或Symbol类型转换的支持，进行对象注入攻击并执行任意代码，或者导致拒绝服务（内存和CPU消耗）。

**有效性：**
虽然提供的代码片段不是完整的POC，但漏洞库信息和搜索引擎结果（虽然未提供）表明该漏洞存在公开的POC利用代码。

**投毒风险：**
提供的代码片段是`crack` gem 的部分文件，看起来是一个XML/JSON解析库。这些文件主要包含许可证、历史记录、README、Rakefile和gemspec。检查这些文件没有发现明显的恶意代码。历史记录中提到的修复与YAML解析相关，这与漏洞描述相符。Rakefile和gemspec文件定义了gem的构建和依赖关系，没有发现可疑之处。但是依然存在极低的投毒风险，恶意攻击者可能通过其他方式篡改代码，因此投毒风险为10%。

**利用方式：**
1.  **利用YAML类型转换:** 攻击者可以构造包含恶意YAML数据的HTTP请求参数。Rails在解析这些参数时，会将YAML数据反序列化为Ruby对象。通过构造特定的YAML payload，攻击者可以实例化任意Ruby对象，并执行该对象的代码。这通常涉及到利用Rails内置的一些危险类（如`ActiveSupport::Deprecation::DeprecationProxy`）来执行系统命令。
2.  **利用Symbol类型转换:** 类似于YAML利用，攻击者可以构造包含恶意Symbol数据的HTTP请求参数。Rails在处理这些参数时，会将字符串转换为Symbol。通过精心构造字符串，攻击者可以创建任意Symbol，并利用Symbol的特性来执行代码。这种利用方式通常比较复杂，需要对Rails的内部机制有深入的了解。
3.  **拒绝服务:** 如果无法执行代码，攻击者仍然可以利用此漏洞进行拒绝服务攻击。通过发送包含大量嵌套XML实体引用的请求，可以消耗大量的内存和CPU资源，导致服务器崩溃。

**项目地址:** [josal/crack-0.1.8-fixed](https://github.com/josal/crack-0.1.8-fixed)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #6

**来源**: [CVE-2013-0156-oxben10_CVE-2013-0156.md](../2013/CVE-2013-0156-oxben10_CVE-2013-0156.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化漏洞

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Rails before 2.3.15, 3.0.x before 3.0.19, 3.1.x before 3.1.10, and 3.2.x before 3.2.11

**利用条件:** 目标服务器运行存在漏洞的Ruby on Rails版本，并且开启了Action Pack对YAML/XML请求的支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2013-0156是一个Ruby on Rails框架中的对象注入漏洞，存在于`active_support/core_ext/hash/conversions.rb`文件中。漏洞原因是Rails在处理XML或YAML格式的请求参数时，由于类型转换限制不足，允许攻击者通过构造恶意的YAML或XML payload注入任意对象，最终导致远程代码执行。 

**利用方式：**

1.  **构造恶意Payload:**  攻击者构造包含恶意Ruby代码的YAML或XML payload。该payload利用了Ruby对象反序列化的特性，可以执行任意系统命令。
2.  **发送Payload:** 攻击者将构造好的payload作为请求参数（通常是XML格式）发送到目标Rails应用程序。
3.  **触发漏洞:**  Rails应用程序在解析XML或YAML参数时，会触发对象注入漏洞，执行payload中的恶意代码。

提供的POC代码（`cve-2013-0156.py`）主要包含以下几个部分：

*   **Payload生成:**  根据目标Rails版本（2.x或3.x）生成相应的YAML payload，利用`yaml.dump()`函数将payload序列化成YAML格式。  为了防止Payload被多次执行，Payload会被 `wrap_payload` 函数包裹。`escape_payload` 函数用来调整适应 rails2 和 rails3 的格式
*   **XML封装:**  将YAML payload封装在XML结构中，作为HTTP请求的内容发送。
*   **HTTP请求:**  使用`requests`库发送HTTP POST请求，将XML payload发送到目标URL。
*   **结果显示:**  脚本会显示发送的HTTP请求和接收到的HTTP响应，方便用户判断漏洞是否成功利用。

**有效性评估：**

根据漏洞描述和POC代码，可以判断此POC代码是有效的。 它针对的是 Rails 在处理 XML 格式数据时存在缺陷，允许攻击者注入恶意的 YAML payload 以达到执行任意代码的目的。 该POC代码针对Rails 2.x和3.x版本，能较大概率复现漏洞。

**投毒风险分析：**

代码中存在一定的投毒风险，但风险较低。风险点在于 `payload` 变量的内容。如果用户不了解 YAML 反序列化的风险，直接使用脚本可能执行恶意代码。`wrap_payload` 函数可能存在被绕过的风险，具体取决于目标环境的配置和补丁情况。因此，投毒风险估计为10%。

**综上所述：**，该漏洞利用代码的有效性较高，但在使用时需要谨慎，确保payload的安全性，并在授权环境下进行测试。

**项目地址:** [oxben10/CVE-2013-0156](https://github.com/oxben10/CVE-2013-0156)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

## POC #7

**来源**: [CVE-2013-0156-terracatta_name_reverser.md](../2013/CVE-2013-0156-terracatta_name_reverser.md)

## CVE-2013-0156-Ruby on Rails-对象注入

**漏洞编号:** CVE-2013-0156

**漏洞类型:** 对象注入/反序列化

**影响应用:** Ruby on Rails

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Rails < 2.3.15, 3.0.x < 3.0.19, 3.1.x < 3.1.10, 3.2.x < 3.2.11

**利用条件:** 需要服务器接受YAML或Symbol类型转换的数据

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2013-0156是Ruby on Rails框架中Action Pack组件的一个漏洞，攻击者可以通过发送恶意构造的YAML或Symbol数据，利用Rails的参数解析过程中的类型转换缺陷，进行对象注入攻击，从而执行任意代码或者导致拒绝服务。漏洞存在于 `active_support/core_ext/hash/conversions.rb` 文件中。提供的漏洞利用代码（Gemfile和Gemfile.lock）是用于搭建一个存在漏洞的Rails环境的，本身不是PoC。要验证此漏洞需要构造恶意的请求参数，例如利用YAML反序列化漏洞，或者利用Symbol类型转换漏洞。 Gemfile和Gemfile.lock文件定义了Rails 3.2.9的依赖，属于受影响的版本。

**有效性：** 根据漏洞库信息，该漏洞影响Rails 2.3.15, 3.0.x, 3.1.x, 3.2.x等版本。提供的代码Gemfile指定了Rails 3.2.9，因此存在漏洞。搭建此环境之后可以通过发送恶意请求进行验证。

**投毒风险：** 提供的代码文件（Gemfile、Gemfile.lock、README.rdoc）都是标准的Rails项目文件，看起来没有明显的恶意代码。 README.rdoc 只是Rails的欢迎文档。Gemfile 和 Gemfile.lock 定义了项目的依赖，没有发现隐藏的恶意依赖。尽管存在通过依赖引入间接风险的可能性，但是直接投毒的可能性较低。因此，投毒风险较低，估计为1%。

**利用方式：** 攻击者可以发送包含恶意YAML或Symbol数据的HTTP请求，例如，在POST请求中包含一个精心构造的YAML字符串作为参数。Rails在解析参数时会尝试将字符串转换为相应的对象，如果攻击者能够控制转换过程，就可以创建任意对象，并执行该对象的代码。或者通过Symbol类型转换，利用某些内部类的特性达到执行任意代码的目的。攻击通常利用可序列化的类，并利用这些类中的`initialize`或者其他方法执行系统命令。


**项目地址:** [terracatta/name_reverser](https://github.com/terracatta/name_reverser)

**漏洞详情:** [CVE-2013-0156](https://nvd.nist.gov/vuln/detail/CVE-2013-0156)

---

