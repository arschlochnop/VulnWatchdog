# CVE-2015-3224

> ğŸ“¦ è¯¥CVEæœ‰ **4** ä¸ªç›¸å…³POCä»“åº“

---

## POC #1

**æ¥æº**: [CVE-2015-3224-0x00-0x00_CVE-2015-3224.md](../2015/CVE-2015-3224-0x00-0x00_CVE-2015-3224.md)

## CVE-2015-3224 Ruby on Rails Web Console IP Whitelist Bypass RCE

**æ¼æ´ç¼–å·:** CVE-2015-3224

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Ruby on Rails Web Console

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªæˆæƒç”¨æˆ·æ‰§è¡Œä»»æ„å‘½ä»¤

**å½±å“ç‰ˆæœ¬:** Web Console < 2.1.3, Rails 3.x/4.x

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿè¿è¡Œç€å­˜åœ¨æ¼æ´çš„Ruby on Railsåº”ç”¨ï¼Œå¹¶ä¸”Web Consoleå·²å¯ç”¨ã€‚éœ€è¦èƒ½å¤Ÿå‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2015-3224æ˜¯Ruby on Rails Web Consoleçš„ä¸€ä¸ªIPç™½åå•ç»•è¿‡æ¼æ´ã€‚Web Consoleåœ¨2.1.3ä¹‹å‰çš„ç‰ˆæœ¬ä»¥åŠRails 3.xå’Œ4.xä¸­ï¼Œæ²¡æœ‰æ­£ç¡®é™åˆ¶`X-Forwarded-For`å¤´çš„ä½¿ç”¨ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ åŒ…å«ä¼ªé€ IPåœ°å€çš„`X-Forwarded-For`å¤´æ¥ç»•è¿‡ç™½åå•é™åˆ¶ï¼Œä»è€Œè®¿é—®Web Consoleå¹¶æ‰§è¡Œä»»æ„ä»£ç ã€‚ 

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„Metasploitæ¨¡å—æ—¨åœ¨åˆ©ç”¨æ­¤æ¼æ´ã€‚å®ƒé€šè¿‡å‘é€å¸¦æœ‰ä¼ªé€ `X-Forwarded-For`å¤´çš„HTTPè¯·æ±‚ç»•è¿‡IPç™½åå•ï¼Œç„¶ååˆ©ç”¨Web Consoleæ‰§è¡Œä»»æ„å‘½ä»¤ã€‚è¯¥æ¨¡å—çš„ä¿®æ”¹ç‰ˆå…è®¸æ‰§è¡Œå•ä¸ªå‘½ä»¤ï¼Œè€Œä¸ä»…ä»…æ˜¯å»ºç«‹åå‘/ç»‘å®šshellï¼Œå¢åŠ äº†åˆ©ç”¨çš„çµæ´»æ€§ã€‚ä»æœç´¢å¼•æ“ç»“æœä¸­ä¹Ÿèƒ½çœ‹å‡ºï¼Œè¯¥æ¼æ´å­˜åœ¨å¯è¢«åˆ©ç”¨çš„RCE.

**æŠ•æ¯’é£é™©ï¼š**
`install.sh`è„šæœ¬çš„ç›®çš„æ˜¯å°†ä¿®æ”¹åçš„rubyè„šæœ¬æ‹·è´åˆ°metasploitçš„æ¨¡å—ç›®å½•ä¸‹ï¼Œè„šæœ¬æœ¬èº«æ²¡æœ‰æ˜æ˜¾çš„æ¶æ„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œåœ¨`ruby-on-rails-web-console2-rce.rb`è„šæœ¬ä¸­ï¼Œè™½ç„¶ä½œè€…å£°æ˜æ·»åŠ äº†`CMD`å˜é‡ç”¨äºæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä½†è¿™æœ¬èº«å°±æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸èƒ½ç®—ä½œæŠ•æ¯’ã€‚Metasploitæ¨¡å—é€šå¸¸åŒ…å«æ‰§è¡Œä»»æ„å‘½ä»¤çš„åŠŸèƒ½ã€‚æŠ•æ¯’é£é™©åœ¨äºï¼š
1.  **ä»£ç è´¨é‡é—®é¢˜:**  ä»£ç å¯èƒ½å­˜åœ¨æœªçŸ¥çš„bugï¼Œå¯¼è‡´ç›®æ ‡ç³»ç»Ÿå´©æºƒæˆ–ä¸ç¨³å®šã€‚
2.  **ä¾èµ–é—®é¢˜:**  æ¨¡å—å¯èƒ½ä¾èµ–ç‰¹å®šçš„åº“æˆ–ç¯å¢ƒï¼Œå¦‚æœç›®æ ‡ç³»ç»Ÿç¼ºå°‘è¿™äº›ä¾èµ–ï¼Œå¯èƒ½å¯¼è‡´åˆ©ç”¨å¤±è´¥ã€‚
3.  **å…¼å®¹æ€§é—®é¢˜:**  æ¨¡å—å¯èƒ½ä¸å…¼å®¹æ‰€æœ‰ç‰ˆæœ¬çš„Ruby on Railsæˆ–Web Consoleã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“çš„æŠ•æ¯’é£é™©è¾ƒä½ï¼Œä¸»è¦é£é™©åœ¨äºåˆ©ç”¨ä»£ç æœ¬èº«å¯èƒ½å­˜åœ¨çš„ç¼ºé™·å’Œå…¼å®¹æ€§é—®é¢˜ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  æ”»å‡»è€…é¦–å…ˆç¡®å®šç›®æ ‡ç³»ç»Ÿæ˜¯å¦è¿è¡Œç€å­˜åœ¨æ¼æ´çš„Ruby on Railsåº”ç”¨ï¼Œå¹¶ä¸”Web Consoleå·²å¯ç”¨ã€‚
2.  æ”»å‡»è€…å‘é€ä¸€ä¸ªç‰¹åˆ¶çš„HTTPè¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª`X-Forwarded-For`å¤´ï¼Œè¯¥å¤´åŒ…å«ä¸€ä¸ªä¸åœ¨ç™½åå•ä¸­çš„IPåœ°å€ã€‚
3.  ç”±äºWeb Consoleæ²¡æœ‰æ­£ç¡®éªŒè¯`X-Forwarded-For`å¤´ï¼Œæ”»å‡»è€…æˆåŠŸç»•è¿‡IPç™½åå•ã€‚
4.  æ”»å‡»è€…ä½¿ç”¨Web Consoleæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œä»è€Œæ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚

æ­¤POCçš„åˆ©ç”¨æ–¹å¼æ˜¯é€šè¿‡ä¿®æ”¹ Metasploit æ¨¡å—ï¼Œä½¿å…¶èƒ½å¤Ÿå‘é€å¸¦æœ‰ä¼ªé€  `X-Forwarded-For` å¤´çš„ HTTP è¯·æ±‚ï¼Œä»è€Œç»•è¿‡ IP ç™½åå•å¹¶æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚

**é¡¹ç›®åœ°å€:** [0x00-0x00/CVE-2015-3224](https://github.com/0x00-0x00/CVE-2015-3224)

**æ¼æ´è¯¦æƒ…:** [CVE-2015-3224](https://nvd.nist.gov/vuln/detail/CVE-2015-3224)

---

## POC #2

**æ¥æº**: [CVE-2015-3224-0xEval_cve-2015-3224.md](../2015/CVE-2015-3224-0xEval_cve-2015-3224.md)

## CVE-2015-3224 Ruby on Rails Web Console IP Whitelist Bypass

**æ¼æ´ç¼–å·:** CVE-2015-3224

**æ¼æ´ç±»å‹:** IP Whitelist Bypass

**å½±å“åº”ç”¨:** Ruby on Rails Web Console

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰

**å½±å“ç‰ˆæœ¬:** Web Console < 2.1.3, Ruby on Rails 3.x/4.x

**åˆ©ç”¨æ¡ä»¶:** éœ€è¦ç›®æ ‡ç³»ç»Ÿè¿è¡Œå­˜åœ¨æ¼æ´ç‰ˆæœ¬çš„Web Consoleï¼Œä¸”æ”»å‡»è€…èƒ½å¤Ÿå‘é€å¸¦æœ‰æ¶æ„æ„é€ çš„X-Forwarded-Forå¤´çš„HTTPè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 0%

## è¯¦æƒ…

CVE-2015-3224 æ¼æ´å­˜åœ¨äº Ruby on Rails Web Console ä¸­ï¼Œç”±äº `request.rb` æ–‡ä»¶æ²¡æœ‰æ­£ç¡®é™åˆ¶ X-Forwarded-For å¤´çš„ä½¿ç”¨ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ æ¶æ„çš„ X-Forwarded-For å¤´ç»•è¿‡ IP ç™½åå•éªŒè¯ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ“çºµ X-Forwarded-For å¤´ï¼Œå°†æ¶æ„ IP åœ°å€æ·»åŠ åˆ°è¯·æ±‚ä¸­ï¼Œä»è€Œæ¬ºéª— Web Console å…è®¸æœªç»æˆæƒçš„è®¿é—®ï¼Œè¿›ä¸€æ­¥å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç æ˜¯ä¸€ä¸ªGPL v3çš„licenseæ–‡ä»¶, ä¸åŒ…å«ä»»ä½•å¯æ‰§è¡Œä»£ç ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºä¸å­˜åœ¨æŠ•æ¯’é£é™©ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  æ”»å‡»è€…å‘é€ HTTP è¯·æ±‚åˆ°å­˜åœ¨æ¼æ´çš„ Ruby on Rails åº”ç”¨ã€‚
2.  åœ¨è¯·æ±‚å¤´ä¸­ï¼Œæ”»å‡»è€…æ·»åŠ æˆ–ä¿®æ”¹ `X-Forwarded-For` å¤´ï¼ŒåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªä¼ªé€ çš„ IP åœ°å€ï¼Œå…¶ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªè¢« Web Console ä¿¡ä»»çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ï¼Œç™½åå•ä¸­çš„åœ°å€ï¼‰ï¼Œä»¥åŠæ”»å‡»è€…æƒ³è¦ä½¿ç”¨çš„æ¶æ„ IP åœ°å€ã€‚
3.  Web Console åœ¨æ£€æŸ¥å®¢æˆ·ç«¯ IP åœ°å€æ—¶ï¼Œé”™è¯¯åœ°ä¿¡ä»»äº† X-Forwarded-For å¤´ä¸­çš„æ¶æ„ IP åœ°å€ã€‚
4.  æ”»å‡»è€…ç»•è¿‡ IP ç™½åå•çš„é™åˆ¶ï¼Œå¯ä»¥æ‰§è¡Œ Web Console æä¾›çš„è°ƒè¯•åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ‰§è¡Œä»»æ„ Ruby ä»£ç ï¼Œå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆRCEï¼‰ã€‚

**é¡¹ç›®åœ°å€:** [0xEval/cve-2015-3224](https://github.com/0xEval/cve-2015-3224)

**æ¼æ´è¯¦æƒ…:** [CVE-2015-3224](https://nvd.nist.gov/vuln/detail/CVE-2015-3224)

---

## POC #3

**æ¥æº**: [CVE-2015-3224-Sic4rio_CVE-2015-3224.md](../2015/CVE-2015-3224-Sic4rio_CVE-2015-3224.md)

## CVE-2015-3224 Ruby on Rails Web Console IP Whitelist Bypass RCE

**æ¼æ´ç¼–å·:** CVE-2015-3224

**æ¼æ´ç±»å‹:** è¿œç¨‹ä»£ç æ‰§è¡Œ (RCE)

**å½±å“åº”ç”¨:** Ruby on Rails Web Console

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå…è®¸æœªç»æˆæƒçš„è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Web Console < 2.1.3, Ruby on Rails 3.x/4.x

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡æœåŠ¡å™¨è¿è¡Œå­˜åœ¨æ¼æ´çš„Ruby on Rails Web Consoleï¼Œä¸”æ”»å‡»è€…èƒ½å‘é€HTTPè¯·æ±‚ã€‚

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 5%

## è¯¦æƒ…

CVE-2015-3224 æ¼æ´å…è®¸æ”»å‡»è€…é€šè¿‡ä¼ªé€  `X-Forwarded-For` HTTPå¤´æ¥ç»•è¿‡ Web Console çš„ IP ç™½åå•é™åˆ¶ï¼Œä»è€Œè·å¾—æœªæˆæƒçš„è®¿é—®æƒé™å¹¶æ‰§è¡Œä»»æ„ä»£ç ã€‚

**æœ‰æ•ˆæ€§ï¼š**
æä¾›çš„æ¼æ´åˆ©ç”¨ä»£ç ï¼ˆ`exploit.py`ï¼‰çœ‹èµ·æ¥æ˜¯æœ‰æ•ˆçš„ã€‚å®ƒåŒ…å«ä»¥ä¸‹å…³é”®æ­¥éª¤ï¼š

1.  **è·¯å¾„æ¢æµ‹ï¼š** é€šè¿‡è®¿é—® `/force_routing_error` å¼ºåˆ¶è·¯ç”±é”™è¯¯ï¼Œä»¥æ­¤æ¢æµ‹ Web Console çš„åŠ¨æ€è·¯å¾„ã€‚
2.  **IP æ¬ºéª—ï¼š** è®¾ç½® `X-Forwarded-For` å¤´ï¼Œä¼ªé€ å—ä¿¡ä»»çš„ IP åœ°å€ (ä¾‹å¦‚ `127.0.0.1`)ã€‚
3.  **ä»£ç æ‰§è¡Œï¼š** åˆ©ç”¨ Web Console æ‰§è¡Œä»»æ„ä»£ç ï¼Œé€šå¸¸é€šè¿‡ `render inline` å®ç°ã€‚
4.  **äº¤äº’å¼ Shellï¼š**  æ”¯æŒç®€å• shell å’Œåå‘ TTY shell ä¸¤ç§æ¨¡å¼ï¼Œåè€…æä¾›æ›´ç¨³å®šçš„äº¤äº’å¼ä½“éªŒã€‚

æœç´¢å¼•æ“ç»“æœä¹Ÿç¡®è®¤äº†è¯¥æ¼æ´çš„å­˜åœ¨å’Œåˆ©ç”¨æ–¹å¼ã€‚å¤šä¸ªé¡µé¢ï¼ˆå¦‚ HackerOne æŠ¥å‘Šã€Pentest-Tools é¡µé¢ï¼‰æŒ‡å‡ºè¯¥æ¼æ´å¯èƒ½å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚

**æŠ•æ¯’é£é™©ï¼š**
è¯„ä¼°æŠ•æ¯’é£é™©è¾ƒä½ï¼Œçº¦ä¸º5%ã€‚ä»¥ä¸‹æ˜¯è¯„ä¼°è¿‡ç¨‹ï¼š
* `README.md` ä¸­å£°æ˜è¯¥è„šæœ¬ä»…ç”¨äºæˆæƒå®‰å…¨æµ‹è¯•ï¼Œå¹¶å…è´£å£°æ˜æ»¥ç”¨è´£ä»»ã€‚å°½ç®¡è¿™ä¸èƒ½å®Œå…¨æ’é™¤æ¶æ„è¡Œä¸ºï¼Œä½†é™ä½äº†æŠ•æ¯’çš„å¯èƒ½æ€§ã€‚
* ä»£ç æ£€æŸ¥æ˜¾ç¤ºï¼Œè¯¥è„šæœ¬ä¸»è¦åŠŸèƒ½æ˜¯åˆ©ç”¨æ¼æ´ï¼Œå¹¶æ²¡æœ‰å‘ç°æ˜æ˜¾çš„åé—¨æˆ–æ¶æ„ä»£ç ã€‚è„šæœ¬çš„åŠŸèƒ½å›´ç»•åˆ©ç”¨å·²çŸ¥çš„æ¼æ´ï¼Œè€Œéæ¤å…¥æ–°çš„æ¼æ´ã€‚
* å­˜åœ¨è½»å¾®çš„æŠ•æ¯’é£é™©åŸå› åœ¨äºä½œè€…å¯èƒ½é€šè¿‡æœåŠ¡å™¨æ—¥å¿—ç­‰æ–¹å¼è·å–ç›®æ ‡ä¿¡æ¯ï¼Œæˆ–è€…é¢„ç•™äº†ä¸æ˜æ˜¾çš„å›è°ƒåé—¨ï¼Œä½†ä»ä»£ç å¯è¯»æ€§æ¥çœ‹ï¼Œå¯èƒ½æ€§å¾ˆå°ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**
1.  **å®‰è£…ä¾èµ–ï¼š** ç¡®ä¿å®‰è£…äº† Python 3 å’Œ `requests` åº“ã€‚
2.  **è¿è¡Œè„šæœ¬ï¼š** ä½¿ç”¨ `exploit.py` è„šæœ¬ï¼ŒæŒ‡å®šç›®æ ‡æœåŠ¡å™¨çš„ URLã€‚
3.  **é€‰æ‹© Shell æ¨¡å¼ï¼š**
    *   **ç®€å• Shellï¼š** é€‚ç”¨äºæ‰§è¡Œç®€å•çš„å‘½ä»¤ã€‚
    *   **åå‘ TTY Shellï¼š** éœ€è¦å…ˆåœ¨æœ¬åœ°æœºå™¨ä¸Šå¯åŠ¨ä¸€ä¸ª `netcat` ç›‘å¬å™¨ï¼Œç„¶ååœ¨è¿è¡Œè„šæœ¬æ—¶æŒ‡å®šæœ¬åœ° IP åœ°å€å’Œç«¯å£ã€‚è¿æ¥å»ºç«‹åï¼Œéœ€è¦æ‰§è¡Œä¸€äº›å‘½ä»¤æ¥ç¨³å®š shellï¼Œä¾‹å¦‚ `stty raw -echo; fg` å’Œ `reset`ã€‚
4.  **åˆ©ç”¨ X-Forwarded-For ç»•è¿‡ç™½åå•:**  è„šæœ¬ä¼šè‡ªåŠ¨è®¾ç½® `X-Forwarded-For` å¤´ï¼Œä»è€Œç»•è¿‡ IP ç™½åå•é™åˆ¶ï¼Œè·å¾— Web Console çš„è®¿é—®æƒé™ã€‚
5.  **æ‰§è¡Œä»»æ„ä»£ç :** æˆåŠŸç»•è¿‡ç™½åå•åï¼Œå¯ä»¥é€šè¿‡ Web Console æ‰§è¡Œä»»æ„ä»£ç ã€‚

**é¡¹ç›®åœ°å€:** [Sic4rio/CVE-2015-3224](https://github.com/Sic4rio/CVE-2015-3224)

**æ¼æ´è¯¦æƒ…:** [CVE-2015-3224](https://nvd.nist.gov/vuln/detail/CVE-2015-3224)

---

## POC #4

**æ¥æº**: [CVE-2015-3224-n000xy_CVE-2015-3224-.md](../2015/CVE-2015-3224-n000xy_CVE-2015-3224-.md)

## CVE-2015-3224 Web Console IP Whitelist Bypass RCE

**æ¼æ´ç¼–å·:** CVE-2015-3224

**æ¼æ´ç±»å‹:** IP Whitelist Bypass

**å½±å“åº”ç”¨:** Ruby on Rails Web Console

**å±å®³ç­‰çº§:** é«˜å±ï¼Œå¯å¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œ

**å½±å“ç‰ˆæœ¬:** Web Console < 2.1.3, Ruby on Rails 3.x/4.x

**åˆ©ç”¨æ¡ä»¶:** ç›®æ ‡ç³»ç»Ÿå®‰è£…äº†å­˜åœ¨æ¼æ´çš„Web Consoleï¼Œå¹¶ä¸”æ”»å‡»è€…èƒ½å¤Ÿå‘é€HTTPè¯·æ±‚åˆ°ç›®æ ‡æœåŠ¡å™¨

**POC å¯ç”¨æ€§:** æ˜¯

**æŠ•æ¯’é£é™©:** 10%

## è¯¦æƒ…

CVE-2015-3224 æ¼æ´å­˜åœ¨äºRuby on Railsçš„Web Consoleä¸­ï¼Œå…è®¸æ”»å‡»è€…ç»•è¿‡IPç™½åå•é™åˆ¶ï¼Œæ‰§è¡Œä»»æ„ä»£ç ã€‚æ¼æ´åŸå› æ˜¯Web Consoleåœ¨ç¡®å®šå®¢æˆ·ç«¯IPåœ°å€æ—¶ï¼Œå¯¹`X-Forwarded-For` headerå¤„ç†ä¸å½“ã€‚

**æœ‰æ•ˆæ€§è¯„ä¼°ï¼š**

æä¾›çš„POCä»£ç ä¼¼ä¹æœ‰æ•ˆã€‚å®ƒé€šè¿‡è®¾ç½® `X-Forwarded-For` headerä¸ºç™½åå•IPï¼ˆä¾‹å¦‚127.0.0.1ï¼‰æ¥ç»•è¿‡IPç™½åå•çš„é™åˆ¶ï¼Œç„¶ååˆ©ç”¨ `cmd.php` æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚POCé¦–å…ˆä¸‹è½½ä¸€ä¸ªåå¼¹shellè„šæœ¬ (pty.py)ï¼Œç„¶åæ‰§è¡Œå®ƒï¼Œä»è€Œå»ºç«‹ä¸€ä¸ªåå‘shellè¿æ¥ã€‚

**æŠ•æ¯’é£é™©è¯„ä¼°ï¼š**

åˆæ­¥åˆ†æï¼ŒæŠ•æ¯’é£é™©è¾ƒä½ï¼Œå¤§çº¦ä¸º10%ã€‚ä¸»è¦è€ƒè™‘ä»¥ä¸‹å‡ ç‚¹ï¼š

1.  `CVE-2015-3224.py`ï¼šè¯¥è„šæœ¬ä¸»è¦ç”¨äºåˆ©ç”¨æ¼æ´ï¼Œç›¸å¯¹ç›´æ¥ï¼Œä½†ä¾èµ–äº`cmd.php`è¿™ä¸ªæ–‡ä»¶å­˜åœ¨æ½œåœ¨é£é™©ï¼Œå¯èƒ½æ˜¯webshellã€‚
2.  `pty.py`ï¼šè¿™ä¸ªè„šæœ¬æ˜¯ä¸€ä¸ªç®€å•çš„åå¼¹shellï¼Œè™½ç„¶æœ¬èº«ä¸æ˜¯æ¶æ„ä»£ç ï¼Œä½†è¢«æ”»å‡»è€…åˆ©ç”¨åä¼šé€ æˆå±å®³ã€‚è„šæœ¬ä¸­ç¡¬ç¼–ç äº†åå¼¹shellçš„IPåœ°å€å’Œç«¯å£ã€‚å¦‚æœè¯¥IPè¢«æ”»å‡»è€…æ§åˆ¶ï¼Œæ‰€æœ‰ä½¿ç”¨è¯¥è„šæœ¬çš„å—å®³è€…éƒ½ä¼šè¿æ¥åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚
3.  `README.md`ï¼šæä¾›äº†ä¸€äº›åŸºæœ¬çš„ä½¿ç”¨è¯´æ˜ã€‚

æ€»ä½“è€Œè¨€ï¼Œè¯¥ä»“åº“ä»£ç è¾ƒä¸ºç®€å•ï¼Œä¸»è¦é£é™©ç‚¹åœ¨äºåå¼¹shellè„šæœ¬`pty.py`å¯èƒ½è¢«ç”¨äºæ¶æ„ç”¨é€”ï¼Œä¸”`CVE-2015-3224.py`ä¾èµ–çš„`cmd.php` è„šæœ¬å¯èƒ½å­˜åœ¨æ¶æ„ä»£ç ã€‚

**åˆ©ç”¨æ–¹å¼ï¼š**

1.  **ç»•è¿‡IPç™½åå•ï¼š** æ”»å‡»è€…é€šè¿‡åœ¨HTTPè¯·æ±‚ä¸­è®¾ç½® `X-Forwarded-For` headerï¼Œä¼ªé€ å®¢æˆ·ç«¯IPåœ°å€ï¼Œç»•è¿‡Web Consoleçš„IPç™½åå•é™åˆ¶ã€‚
2.  **ä¸Šä¼ åå¼¹shellï¼š** æ”»å‡»è€…åˆ©ç”¨æ¼æ´ï¼Œé€šè¿‡`cmd.php`ä¸Šä¼ ä¸€ä¸ªåå¼¹shellè„šæœ¬ï¼ˆ`pty.py`ï¼‰ã€‚
3.  **æ‰§è¡Œä»»æ„ä»£ç ï¼š** æ”»å‡»è€…åˆ©ç”¨æ¼æ´æ‰§è¡Œä¸Šä¼ çš„åå¼¹shellè„šæœ¬ï¼Œä»è€Œåœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„ä»£ç ï¼Œè·å–shellæ§åˆ¶æƒã€‚
4.  **å»ºç«‹åå‘è¿æ¥ï¼š** åå¼¹shellè„šæœ¬è¿æ¥åˆ°æ”»å‡»è€…æŒ‡å®šçš„IPåœ°å€å’Œç«¯å£ï¼Œå»ºç«‹ä¸€ä¸ªåå‘shellè¿æ¥ï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡è¯¥è¿æ¥è¿œç¨‹æ§åˆ¶ç›®æ ‡æœåŠ¡å™¨ã€‚

**é¡¹ç›®åœ°å€:** [n000xy/CVE-2015-3224-](https://github.com/n000xy/CVE-2015-3224-)

**æ¼æ´è¯¦æƒ…:** [CVE-2015-3224](https://nvd.nist.gov/vuln/detail/CVE-2015-3224)

---

