# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **6** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-YastrebX_CVE-2015-1328.md](../2015/CVE-2015-1328-YastrebX_CVE-2015-1328.md)

# CVE-2015-1328

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-1328-0xf1d0_CVE-2015-1328.md](../2015/CVE-2015-1328-0xf1d0_CVE-2015-1328.md)

## CVE-2015-1328-Overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu through 15.04, Linux kernel before 3.19.0-21.21

**利用条件:** 需要overlayfs支持和用户命名空间启用 (kernel.unprivileged_userns_clone=1)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Linux内核的overlayfs实现中，由于不正确的权限检查，允许本地用户在overlayfs挂载点利用漏洞获取root权限。

**利用方式：**

1.  **命名空间创建：** 利用`unshare(CLONE_NEWUSER)`创建一个新的用户命名空间。
2.  **挂载命名空间：** 创建一个新的挂载命名空间（`CLONE_NEWNS`）。
3.  **Overlayfs挂载：** 挂载overlayfs文件系统，利用overlayfs操纵系统目录。
4.  **文件操纵：** 使用overlayfs重命名文件并写入`/etc/ld.so.preload`。
5.  **库注入：** 将恶意的共享库写入`/tmp/ofs-lib.so`。
6.  **权限提升：** 执行`/bin/su`，它会触发预加载的库。
7.  **Root Shell：** 该库劫持`getuid()`并生成一个root shell。

**代码分析：**

提供的Makefile和源代码表明这是一个利用LD_PRELOAD机制的本地提权漏洞。攻击者通过overlayfs挂载，修改/etc/ld.so.preload，将恶意的动态链接库加载到进程中，劫持`getuid`函数，从而获得root权限。

**投毒风险评估：**

虽然该POC旨在利用漏洞，但存在潜在的投毒风险。例如，`ofs-lib.c` 可以被修改，在提权的同时，执行其他恶意操作，如安装后门，上传敏感数据等。评估的投毒风险较低(5%)，因为该漏洞利用的重点在于提权，而非隐藏恶意行为，且提供的代码较为直接和清晰。但是如果用于实际的渗透测试，需要对`ofs-lib.c`进行更仔细的分析，以确定是否存在隐藏的恶意代码。

**项目地址:** [0xf1d0/CVE-2015-1328](https://github.com/0xf1d0/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #2

**来源**: [CVE-2015-1328-1mgR00T_CVE-2015-1328.md](../2015/CVE-2015-1328-1mgR00T_CVE-2015-1328.md)

## CVE-2015-1328 - OverlayFS 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (OverlayFS)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 12.04, 14.04, 14.10, 15.04 (内核版本 < 3.19.0-21.21)

**利用条件:** 需要在受影响的Ubuntu系统上，且overlayfs未被禁用，并且用户命名空间未被完全隔离。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中，由于权限检查不当，允许本地用户通过在任意挂载命名空间中使用 overlayfs 来获取 root 权限。 

**漏洞利用方式：**

1.  **创建命名空间：** 利用 `unshare(CLONE_NEWUSER)` 和 `clone(CLONE_NEWNS)` 系统调用创建新的用户和挂载命名空间。
2.  **OverlayFS 挂载：** 在新的命名空间中，攻击者通过两次挂载overlayfs文件系统来利用该漏洞。第一次挂载将`/proc/sys/kernel`（或者`/sys/kernel/security/apparmor`在一些内核上）作为下层目录，`/tmp/ns_sploit/upper`作为上层目录。 这允许攻击者在`/tmp/ns_sploit/upper`中创建文件，并在overlayfs中显示为`/proc/sys/kernel`的一部分。
3.  **覆盖 `/etc/ld.so.preload`：** 攻击者利用 overlayfs 的特性，将 `ns_last_pid` 或 `.access`重命名为 `ld.so.preload`，并将它放置在 overlayfs 的 upperdir 中，从而覆盖系统的 `/etc/ld.so.preload` 文件。`ld.so.preload`指定了动态链接器在加载其他共享库之前预加载的共享库，通常用于调试或者性能优化，但也可以被恶意利用。
4.  **创建恶意共享库：** 创建一个恶意共享库 `/tmp/ofs-lib.so`，其中包含在任何程序执行时都会运行的代码（本例中为提权到 root shell 的代码）。该恶意库会取消链接`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，然后使用`setresuid(0, 0, 0)`和`setresgid(0, 0, 0)`提权到root，最后执行一个交互式的shell。
5.  **触发提权：** 通过执行 `/bin/su` 命令来触发动态链接器加载 `/etc/ld.so.preload` 中指定的恶意共享库。由于该库包含提权代码，因此执行 `/bin/su` 会导致攻击者获得 root 权限。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码针对的是 CVE-2015-1328 漏洞，该漏洞影响 Ubuntu 15.04 及之前的版本，并且内核版本低于 3.19.0-21.21。提供的 POC 代码在特定版本的 Ubuntu 上有效。

**投毒风险：**

POC 代码主要目的是利用 overlayfs 的权限漏洞来实现提权。其中存在一定的投毒风险，因为：

*   **恶意共享库：** POC 创建了一个共享库 `/tmp/ofs-lib.so`，虽然其目的是提权，但恶意库可以被修改为执行其他恶意操作，例如安装后门、窃取数据或破坏系统。
*   **`/etc/ld.so.preload`劫持：** 劫持 `/etc/ld.so.preload` 可能会导致其他程序受到影响，因为所有程序都会加载该文件中指定的库。虽然POC在提权成功后会删除`/etc/ld.so.preload`和`/tmp/ofs-lib.so`，但如果提权失败，可能会留下一个被修改过的`/etc/ld.so.preload`，导致系统不稳定或者为后续攻击留下后门。
*   **概率：** 投毒风险的概率大约为10%，主要是考虑到恶意库可以被修改，以及`/etc/ld.so.preload`被劫持后可能带来的潜在影响。

**项目地址:** [1mgR00T/CVE-2015-1328](https://github.com/1mgR00T/CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #3

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #4

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---



---

## POC #4

**来源**: [CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md](../2015/CVE-2015-1328-devtz007_overlayfs_CVE-2015-1328.md)

## CVE-2015-1328 - Overlayfs 本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21 (Ubuntu through 15.04)

**利用条件:** 需要本地用户权限，overlayfs 被允许在用户命名空间中挂载。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2015-1328 是一个存在于 Linux 内核 overlayfs 实现中的权限提升漏洞。在 Ubuntu 15.04 及更早版本的内核（直到 3.19.0-21.21）中，overlayfs 对 upper filesystem 目录中的文件创建权限检查不当，允许本地用户利用此漏洞获取 root 权限。漏洞利用方式如下：

1.  **利用方式：**
    *   利用 overlayfs 在用户命名空间中的挂载功能。
    *   创建一个 overlayfs 文件系统，将 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor` 作为 lowerdir，将 `/tmp/ns_sploit/upper` 作为 upperdir。
    *   在 overlayfs 文件系统中，尝试重命名 `ns_last_pid` 或 `.access` 文件为 `ld.so.preload`。由于权限检查不当，可以成功创建。
    *   然后卸载第一个 overlayfs 文件系统，再使用 `/tmp/ns_sploit/upper` 作为 lowerdir，`/etc` 作为 upperdir 创建一个新的overlayfs挂载点。
    *   修改`/tmp/ns_sploit/o/ld.so.preload`权限，卸载第二个挂载点
    *   创建一个恶意的共享库 `/tmp/ofs-lib.so`，其中包含在 `getuid()` 函数被调用时执行提权操作的代码，即调用 `setresuid(0, 0, 0)` 和 `execle("/bin/sh", "sh", "-i", NULL, NULL)`。
    *   将 `/tmp/ofs-lib.so` 的路径写入 `/etc/ld.so.preload`，使得系统加载该共享库。
    *   当任何程序调用 `getuid()` 时，恶意的 `getuid()` 函数会被执行，从而获得 root 权限。
    *   POC 代码中使用了 `su` 命令来触发提权。

2.  **有效性：**
    *   提供的 POC 代码在漏洞描述中指定的 Ubuntu 版本上是有效的。搜索引擎结果也显示存在可用的利用模块。

3.  **投毒风险：**
    *   代码中没有明显的投毒代码。但存在极小的风险(1%)，作者可能在动态链接库的生成或者其他地方埋藏后门，这个需要更多的代码审计来确定.例如，动态链接库编译过程中可能存在恶意指令。如果确认gcc来自可信源，并且没有其他可疑操作，则可以认为投毒风险较低。

**项目地址:** [devtz007/overlayfs_CVE-2015-1328](https://github.com/devtz007/overlayfs_CVE-2015-1328)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #5

**来源**: [CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md](../2015/CVE-2015-1328-elit3pwner_CVE-2015-1328-GoldenEye.md)

## CVE-2015-1328 - Ubuntu Overlayfs 本地提权漏洞

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (Overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu Linux kernel package before 3.19.0-21.21, Ubuntu 12.04, 14.04, 14.10, 15.04

**利用条件:** 需要本地用户权限，overlayfs被允许在任意mount namespace中挂载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1328 漏洞存在于 Linux kernel 的 overlayfs 实现中，由于其在创建 upper filesystem 目录时没有正确检查权限，导致本地用户可以利用该漏洞获得 root 权限。漏洞利用方式是利用 overlayfs 挂载功能绕过权限检查，通过精心构造的文件系统操作，劫持 /etc/ld.so.preload，加载恶意动态链接库，从而执行任意代码并获取 root 权限。

**利用方式：**

1.  创建 user namespace。
2.  创建必要的目录结构 (work, upper, o)。
3.  使用 overlayfs 挂载 `/proc/sys/kernel` 或 `/sys/kernel/security/apparmor`到 `/tmp/ns_sploit/o` ，并利用权限绕过创建 `ld.so.preload` 文件。
4.  使用 overlayfs 挂载 `/etc` 到 `/tmp/ns_sploit/o`，将恶意的`ld.so.preload`文件写入 overlayfs 的 upper 层。
5.  创建一个恶意的动态链接库 `/tmp/ofs-lib.so`，其中包含在程序启动时执行恶意代码的 `getuid()` 函数。
6.  当具有 setuid 权限的程序（例如 `/bin/su`）运行时，恶意动态链接库会被加载，从而执行恶意代码并获取 root 权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中存在多个指向 Exploit-DB 的链接，其中包含了该漏洞的利用代码。提供的代码也包含了完整的利用流程，包括创建 namespace、挂载 overlayfs、创建恶意动态链接库等。

**投毒风险：**

该仓库存在一定的投毒风险，尽管主要的代码看起来是漏洞利用相关的，但是以下几点需要注意：

1.  **依赖下载：** `exploit.sh`脚本中需要从攻击者服务器下载`exploit`可执行文件,如果这个下载链接被篡改，可能会引入恶意的可执行文件。
2.  **自动化脚本：**  `exploit.sh` 自动化了漏洞利用过程，如果脚本中存在隐藏的恶意命令，可能会在目标系统上执行。
3.  **动态链接库劫持：**  利用过程中需要创建和修改 `/etc/ld.so.preload` 文件，这本身就是一个潜在的后门植入点。尽管这个操作是漏洞利用的一部分，但如果被滥用，可能会导致持久性的安全风险。

虽然利用代码本身主要是为了提权，但也存在潜在的投毒风险，特别是通过 `exploit.sh` 脚本引入恶意代码的可能性。

**项目地址:** [elit3pwner/CVE-2015-1328-GoldenEye](https://github.com/elit3pwner/CVE-2015-1328-GoldenEye)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

## POC #6

**来源**: [CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md](../2015/CVE-2015-1328-thieveshkar_RootQuest-CTF-Box-Multi-Stage-Exploitation-VM.md)

## CVE-2015-1328-Ubuntu-overlayfs本地提权

**漏洞编号:** CVE-2015-1328

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel (overlayfs)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** Ubuntu 15.04 及之前版本，Linux kernel 3.19.0-21.21之前

**利用条件:** 需要overlayfs被允许在任意mount namespace中使用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1328 漏洞存在于 Linux 内核的 overlayfs 实现中。由于在 upper filesystem 目录中创建文件时，权限检查不正确，导致本地用户可以利用此漏洞获得 root 权限。利用条件是 overlayfs 允许在任意 mount namespace 中使用。根据提供的漏洞信息，存在可用的漏洞利用代码 (Exploit-DB 37292, 40688)。

**利用方式：**

1.  利用 overlayfs 的不安全权限检查，在攻击者可控的 overlayfs mount 中创建具有 setuid root 权限的文件。
2.  当这个文件在系统其他地方被执行时，由于 setuid 权限，攻击者可以以 root 权限执行任意代码。

**有效性：**

由于存在 exploit-db 的链接，确认漏洞利用代码可用，因此判断该漏洞是有效的。

**投毒风险：**

提供的代码片段是 CTF 挑战的描述和许可信息，并非漏洞利用代码本身。因此需要假设 exploit-db中的exp才是真正的poc。因为是CTF环境，存在投毒的可能性相对较小。因为ctf box本身就是为了学习漏洞利用，那么进行投毒的概率就很小了。综上所述，该代码仓库中存在作者隐藏的投毒代码的概率为5%。

**项目地址:** [thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM](https://github.com/thieveshkar/RootQuest-CTF-Box-Multi-Stage-Exploitation-VM)

**漏洞详情:** [CVE-2015-1328](https://nvd.nist.gov/vuln/detail/CVE-2015-1328)

---

