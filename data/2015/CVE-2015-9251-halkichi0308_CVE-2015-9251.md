# CVE-2015-9251

> 📦 该CVE有 **5** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-9251-hackgiver_CVE-2015-9251.md](../2015/CVE-2015-9251-hackgiver_CVE-2015-9251.md)

## CVE-2015-9251-jQuery-XSS

**漏洞编号:** CVE-2015-9251

**漏洞类型:** XSS

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户敏感信息泄露或恶意脚本执行

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用存在漏洞的jQuery版本，且允许跨域Ajax请求但未设置dataType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-9251 存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果未设置 `dataType` 选项，`text/javascript` 响应会被执行，从而导致跨站脚本攻击（XSS）。

**有效性分析：**

提供的 PoC 代码看起来是有效的。它包含一个 HTML 页面，该页面使用 jQuery 1.8.1（存在漏洞的版本）发起一个跨域 AJAX 请求到 `http://localhost:8081/malicious.js`，并没有设置 `dataType`。`server.py` 文件模拟了一个恶意服务器，它会返回一段 JavaScript 代码 (`alert(document.domain);`)，这段代码会在客户端执行，从而证明 XSS 漏洞的存在。

**投毒风险分析：**

浏览了提供的代码，没有发现作者隐藏的恶意或后门代码。server.py中的恶意js脚本只是用来验证漏洞的存在。

**利用方式：**

1.  **目标网站条件：** 目标网站需要使用 jQuery 3.0.0 之前的版本。
2.  **跨域请求：** 攻击者需要找到或创建一个机会，让目标网站发起一个到攻击者控制的域的 AJAX 请求。
3.  **绕过同源策略：** 服务器必须返回 `Access-Control-Allow-Origin: *` 头部，以允许跨域请求。同时，服务端还需要设置 `Content-Type: text/javascript`。
4.  **没有 `dataType`：** AJAX 请求不能显式设置 `dataType` 选项。如果没有设置，jQuery 会尝试自动检测响应类型。如果服务器返回 `text/javascript`，jQuery 会将其作为 JavaScript 代码执行。
5.  **XSS 执行：** 攻击者控制的服务器返回包含恶意 JavaScript 代码的响应。由于 jQuery 将其作为代码执行，因此会发生 XSS，允许攻击者在目标网站的上下文中运行任意 JavaScript 代码（例如，窃取 cookie，重定向用户，更改页面内容）。

总之，PoC的目的是模拟利用此漏洞，允许在受害者浏览器中执行任意JavaScript代码。通过设置跨域访问许可并返回 `text/javascript` 内容类型，攻击者可以绕过浏览器的安全限制，并执行恶意脚本。

**项目地址:** [hackgiver/CVE-2015-9251](https://github.com/hackgiver/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)

---

## POC #2

**来源**: [CVE-2015-9251-halkichi0308_CVE-2015-9251.md](../2015/CVE-2015-9251-halkichi0308_CVE-2015-9251.md)

## CVE-2015-9251-jQuery-跨站脚本攻击（XSS）

**漏洞编号:** CVE-2015-9251

**漏洞类型:** 跨站脚本攻击（XSS）

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户信息泄露、会话劫持和恶意代码执行

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用存在漏洞的jQuery版本，且允许跨域Ajax请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-9251 存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果未设置 `dataType` 选项，且服务器返回 `text/javascript` 内容类型，则响应内容将被当作 JavaScript 代码执行，从而导致 XSS 漏洞。

**有效性：**

提供的 POC 代码是有效的。它模拟了一个跨域 Ajax 请求，请求的目标是 `https://sakurity.com/jqueryxss`。如果这个URL返回的内容是 `text/javascript`类型，并且不指定`dataType`，就会执行返回的js代码，从而触发xss漏洞

**投毒风险：**

分析提供的文件，`/tmp/d259c26585c0db19b58b7b9c08c78627/CVE-2015-9251.html` 和 `/tmp/d259c26585c0db19b58b7b9c08c78627/README.md` 看起来都是标准的文件，用于展示漏洞的利用方法。 没有发现任何可疑的代码或行为，表明该存储库中没有隐藏的投毒代码。风险系数为0%。

**利用方式：**

1.  **确定目标网站是否使用了存在漏洞的 jQuery 版本。** 可以通过查看网站的源代码或使用开发者工具来判断。
2.  **找到一个可以发起跨域 Ajax 请求的点。** 这通常涉及到用户可控的 URL 参数或表单。
3.  **构造一个跨域 Ajax 请求，将 `url` 设置为指向攻击者控制的服务器。**
4.  **在攻击者控制的服务器上，返回 `Content-Type: text/javascript` 的响应，并在响应内容中包含恶意的 JavaScript 代码。**
5.  **当用户访问包含该恶意请求的页面时，恶意代码将在用户的浏览器中执行。**

**防范措施：**

*   升级 jQuery 到 3.0.0 或更高版本。
*   在执行跨域 Ajax 请求时，始终明确指定 `dataType` 选项，避免浏览器自动解析响应内容。
*   对所有用户输入进行严格的验证和过滤，防止 XSS 攻击。

**项目地址:** [halkichi0308/CVE-2015-9251](https://github.com/halkichi0308/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)

---

## POC #3

**来源**: [CVE-2015-9251-moften_CVE-2015-9251.md](../2015/CVE-2015-9251-moften_CVE-2015-9251.md)

## CVE-2015-9251-jQuery-XSS

**漏洞编号:** CVE-2015-9251

**漏洞类型:** XSS

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户cookie泄露、页面篡改等

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用受影响的jQuery版本，且存在跨域AJAX请求未设置dataType选项

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于jQuery 3.0.0之前的版本中，当发起跨域AJAX请求时，如果没有指定 `dataType` 选项，且服务器返回 `text/javascript` 类型的数据，jQuery会将返回的数据作为JavaScript代码执行，从而导致XSS漏洞。

**有效性：** 提供的PoC代码是有效的。它模拟了一个跨域AJAX请求，没有设置 `dataType` 选项，并构造了一个包含恶意JavaScript代码的URL。当服务器返回包含 `alert(document.cookie)` 的响应时，这段代码会被jQuery执行，显示用户的cookie。

**投毒风险：** 经过分析，提供的PoC代码和README.md文件没有发现明显的投毒代码。PoC的目的是演示漏洞，而不是进行恶意攻击。代码功能清晰，没有隐藏的恶意逻辑。作者邮箱是protonmail，更注重隐私，因此投毒风险较低，概率为0%。

**利用方式：**
1.  **寻找目标：** 寻找使用jQuery 3.0.0之前版本的网站。
2.  **构造恶意链接：** 构造一个包含恶意JavaScript代码的URL，该URL指向一个可控的服务器，服务器返回 `text/javascript` 类型的数据，数据中包含攻击代码。例如：`https://example.com/api?callback=alert(document.cookie)`。
3.  **诱骗用户访问：** 将恶意链接发送给用户，诱骗其点击。
4.  **XSS攻击：** 用户访问恶意链接后，如果目标网站存在未设置 `dataType` 选项的跨域AJAX请求，并且请求的URL是可控的，jQuery会将恶意代码作为JavaScript代码执行，从而实现XSS攻击。

**项目地址:** [moften/CVE-2015-9251](https://github.com/moften/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)

---

## POC #4

**来源**: [CVE-2015-9251-rox-11_xss.md](../2015/CVE-2015-9251-rox-11_xss.md)

## CVE-2015-9251-jQuery-XSS

**漏洞编号:** CVE-2015-9251

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户凭证泄露、网页内容篡改和恶意代码执行

**影响版本:** < 3.0.0

**利用条件:** 需要存在使用存在漏洞版本的jQuery，并且进行跨域Ajax请求，且未设置dataType参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-9251是jQuery 3.0.0之前版本中的一个XSS漏洞。当执行跨域Ajax请求而没有指定`dataType`选项时，`text/javascript`响应会被执行。这意味着来自不受信任域的响应可能会作为JavaScript代码执行，从而允许攻击者注入恶意脚本。 

**有效性:**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且影响jQuery 3.0.0之前的版本。提供的POC代码 `alert('XSS via CVE-2015-9251');` 可以用来验证漏洞的存在，如果成功执行，则说明漏洞存在。

**投毒风险:**

提供的POC代码非常简单，仅仅弹出一个alert框。仔细检查后，没有发现任何隐藏的、恶意的代码。因此，投毒风险为0%。

**利用方式:**

1.  **确定目标网站是否使用了受影响的jQuery版本。** 可以通过查看网页源代码或者使用开发者工具来确定jQuery版本。
2.  **找到一个跨域Ajax请求。** 攻击者需要找到一个从存在漏洞的网站向其他域发起Ajax请求的地方。
3.  **确保Ajax请求没有设置`dataType`参数。** 这是触发漏洞的关键。
4.  **控制Ajax请求的目标域。** 攻击者需要能够控制Ajax请求返回的内容。这可以通过设置自己的服务器来实现。
5.  **在攻击者的服务器上，返回包含恶意JavaScript代码的`text/javascript`响应。** 例如，`alert('XSS via CVE-2015-9251');`。
6.  **当受害者访问存在漏洞的网站并触发Ajax请求时，恶意JavaScript代码将会被执行。**

**项目地址:** [rox-11/xss](https://github.com/rox-11/xss)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)

---

## POC #5

**来源**: [CVE-2015-9251-wakefulblock262_CVE-2015-9251.md](../2015/CVE-2015-9251-wakefulblock262_CVE-2015-9251.md)

## CVE-2015-9251-jQuery-跨站脚本攻击(XSS)

**漏洞编号:** CVE-2015-9251

**漏洞类型:** 跨站脚本攻击(XSS)

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户cookie泄露，页面内容篡改

**影响版本:** < 3.0.0

**利用条件:** 需要网站使用存在漏洞的jQuery版本，且发起跨域Ajax请求时未设置dataType选项

**POC 可用性:** 否 (提供的代码利用的是另一个XSS漏洞)

**投毒风险:** 0%

## 详情

CVE-2015-9251 漏洞存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果没有指定 `dataType` 选项，且服务器返回 `text/javascript` 类型的响应，jQuery 会尝试执行该响应，从而可能导致 XSS 攻击。 攻击者可以通过控制服务器返回的内容来执行任意 JavaScript 代码。

**有效性评估：**
提供的代码实际上并*不能*利用CVE-2015-9251。它使用`$.parseHTML` 和`$('#target').append(html)`来将包含XSS payload（`<img src=x onerror="alert(document.cookie)">`）的 HTML 插入到页面中。 这本身就是一个XSS漏洞，但是与 CVE-2015-9251 描述的利用方式不同。 此 PoC 利用了 jQuery `append` 函数对 HTML 片段解析时，执行内联 JavaScript 的行为,而不是 `dataType` 选项缺失导致的问题。

**投毒风险：**
提供的代码**没有明显的投毒风险**。代码的功能是展示一个 XSS 的 PoC，虽然本身存在 XSS，但其目的是演示漏洞，而不是隐藏恶意行为。所以投毒风险评估为0%。

**利用方式：**
要利用 CVE-2015-9251，攻击者需要满足以下条件：

1.  目标网站使用 jQuery 3.0.0 之前的版本。
2.  网站发起跨域 Ajax 请求。
3.  Ajax 请求*没有*设置 `dataType` 选项。
4.  服务器返回 `text/javascript` 类型的响应，且响应内容包含恶意 JavaScript 代码。

攻击者可以通过控制服务器的响应内容来执行 XSS 攻击。例如，攻击者可以劫持服务器，或者利用服务器上的漏洞来修改响应内容。

根据搜索结果，许多应用依赖的jQuery受到了此漏洞的影响，包括API Connect等。


**项目地址:** [wakefulblock262/CVE-2015-9251](https://github.com/wakefulblock262/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)

---

