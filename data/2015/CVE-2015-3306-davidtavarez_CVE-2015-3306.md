# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **15** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-davidtavarez_CVE-2015-3306.md](../2015/CVE-2015-3306-davidtavarez_CVE-2015-3306.md)

# CVE-2015-3306

> 📦 该CVE有 **14** 个相关POC仓库

---

## POC #1

**来源**: [CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md](../2015/CVE-2015-3306-0xm4ud_ProFTPD_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者可以连接到FTP服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。漏洞利用过程如下：

1.  **漏洞信息：**
    *   漏洞库信息表明，ProFTPD 1.3.5的mod_copy模块存在权限绕过漏洞。
    *   搜索引擎结果证实了该漏洞的存在，并提供了多个漏洞分析和利用的链接，包括metasploit的使用。
2.  **漏洞利用代码分析：**
    提供的漏洞利用代码只是GNU GPL协议，没有实际的漏洞利用代码。因此无法直接从该代码判断漏洞利用的有效性和投毒风险。
3.  **漏洞利用方式：**

   通过 `SITE CPFR` 指定源文件，`SITE CPTO` 指定目标文件，即可实现任意文件读写。结合搜索引擎结果，攻击者可以利用此漏洞读取服务器上的敏感配置文件（例如，包含数据库密码的文件）或写入恶意代码到服务器的可执行文件中，从而实现远程代码执行。
4.  **有效性：**根据漏洞信息和搜索结果，该漏洞利用是有效的，前提是服务器运行 ProFTPD 1.3.5，并且开启了 `mod_copy` 模块。
5.  **投毒风险：**由于提供的代码只是一个协议，不能判定为恶意代码。因此，投毒风险为0%。

**项目地址:** [0xm4ud/ProFTPD_CVE-2015-3306](https://github.com/0xm4ud/ProFTPD_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #2

**来源**: [CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md](../2015/CVE-2015-3306-JoseLRC97_ProFTPd-1.3.5-mod_copy-Remote-Command-Execution.md)

## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #3

**来源**: [CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md](../2015/CVE-2015-3306-Z3R0-0x30_CVE-2015-3306.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，以及对ProFTPD服务器的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以通过`SITE CPFR`和`SITE CPTO`命令，实现任意文件的读取和写入。 

**有效性:**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞是真实有效的。漏洞利用代码 `Z3R0_ProFTPexploit.py` 提供了一种可行的攻击方法，利用 `SITE CPFR` 和 `SITE CPTO` 命令将SSH私钥复制到目标服务器的指定目录，从而可能实现SSH登录。

**投毒风险:**

对提供的Python代码进行分析，发现以下几点潜在的投毒风险：

1.  **依赖外部命令：** 代码中使用了 `os.system` 函数执行外部命令 `mkdir` 和 `mount`。虽然这些命令本身功能明确，但攻击者可能通过修改传递给 `os.system` 的参数，来执行恶意命令。例如，虽然这里的mount命令的目的是挂载远程目录，但如果目标系统已经存在一个恶意的挂载点，这个操作可能会被利用。
2. **SSH Key路径硬编码**: 脚本要求指定SSH私钥的完整路径, 这意味着攻击者需要知道目标服务器的SSH配置。
3. **mount命令参数**: `os.system("sudo mount " + server + ":/var /mnt/testdir")`  这行代码尝试挂载服务器的`/var`目录到本地`/mnt/testdir`。如果服务器配置不当，或者用户权限足够，攻击者可能通过挂载其他敏感目录(例如`/root`)来获取更多信息。

综合以上分析，认为存在**10%**的投毒风险。主要风险在于攻击者可以利用代码中的外部命令执行，在特定环境下实现恶意操作，但总体来说，该代码的目的是为了实现利用，而不是进行大规模的恶意投毒。

**利用方式:**

1.  **漏洞触发：** 攻击者需要连接到目标ProFTPD服务器，并发送`SITE CPFR`命令指定源文件，然后发送`SITE CPTO`命令指定目标文件。
2.  **任意文件读写：** 通过`SITE CPFR`和`SITE CPTO`命令，攻击者可以读取服务器上的任意文件，并将文件写入到服务器上的任意位置（受限于ProFTPD进程的权限）。
3.  **权限提升 (示例代码)：** 示例代码利用该漏洞将攻击者的SSH私钥复制到目标服务器的某个目录（脚本中的`directory`变量指定），从而实现SSH登录，进而控制目标服务器。
4.  **其他利用方式：** 攻击者可以写入恶意脚本到Web服务器的目录，然后通过Web访问触发脚本执行，实现远程代码执行；或者修改系统配置文件，破坏系统功能。


**项目地址:** [Z3R0-0x30/CVE-2015-3306](https://github.com/Z3R0-0x30/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #4

**来源**: [CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md](../2015/CVE-2015-3306-cd6629_CVE-2015-3306-Python-PoC.md)

## CVE-2015-3306-ProFTPD mod_copy 远程代码执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可远程读取和写入任意文件，最终执行任意代码

**影响版本:** 1.3.5

**利用条件:** ProFTPD服务器开启mod_copy模块，且允许匿名访问(非必须，但降低利用难度)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-3306漏洞存在于ProFTPD 1.3.5版本的mod_copy模块中。攻击者可以利用`SITE CPFR`和`SITE CPTO`命令读取和写入服务器上的任意文件，从而导致远程代码执行。

**利用方式：**

1.  **连接目标FTP服务器：** 建立到目标 ProFTPD 服务器的 FTP 连接。
2.  **利用 `SITE CPFR` 和 `SITE CPTO` 写入webshell:**  通过 `SITE CPFR /proc/self/cmdline` 读取当前 ProFTPD 进程的命令行，然后使用 `SITE CPTO` 将包含恶意 PHP 代码的webshell写入服务器的可访问目录（例如 `/var/www/html`）。该webshell执行GET请求中cmd参数的内容。
3.  **执行任意命令:** 通过访问写入的webshell(http://<target>/shell.php?cmd=<command>)，执行任意命令。
4.  **上传反弹shell:**  利用写入的webshell,使用wget命令，将攻击者服务器上的反弹shell脚本上传到目标机器,并执行.

**有效性：**

提供的PoC代码（`ftp.py`）基于Metasploit模块转换而来，理论上是有效的，但是需要目标服务器开启mod_copy模块，并且需要知道目标服务器的web目录。

**投毒风险：**

PoC代码本身可能存在细微的投毒风险。虽然主要功能是利用漏洞，但存在以下潜在风险：

*   **后门植入：**  虽然 PoC 没有明显的后门代码，但攻击者可能修改 PoC，在目标服务器上植入持久性后门（例如，修改系统文件或添加计划任务），以便长期控制目标系统。

*   **恶意脚本下载：**  PoC 下载并执行 `run.php` 脚本，这个脚本的内容完全由攻击者控制。如果攻击者的服务器被攻破或脚本被替换，目标服务器可能下载并执行恶意代码。

*   **信息收集：**  PoC 可能收集目标服务器的信息（例如，操作系统版本、已安装软件列表）并发送给攻击者。

综上所述，认为存在5%的投毒风险，主要是由于下载执行未知脚本带来的潜在威胁，以及人工修改后植入后门的可能。

**排序优先级解释：**

*   **搜索引擎结果：** 搜索结果验证漏洞的存在，并提供了一些利用该漏洞的途径。
*   **漏洞利用代码：**  漏洞利用代码，是验证和复现漏洞的关键，通过代码分析可以理解漏洞的利用方式和影响。
*   **漏洞库信息：**  漏洞库信息提供了漏洞的基本描述、影响和相关参考链接。

**项目地址:** [cd6629/CVE-2015-3306-Python-PoC](https://github.com/cd6629/CVE-2015-3306-Python-PoC)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #5

**来源**: [CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md](../2015/CVE-2015-3306-cdedmondson_Modified-CVE-2015-3306-Exploit.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ProFTPD 1.3.5的mod_copy模块中，允许未经授权的远程攻击者使用`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。通过覆盖或修改服务器上的配置文件或上传恶意脚本，攻击者可以实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用的有效性较高。存在多个公开的PoC代码和Metasploit模块，证明该漏洞可被利用。

**投毒风险分析：**

分析提供的PoC代码：

*   `modified_cve_2015_3306.py`: 此脚本利用CVE-2015-3306漏洞，通过`SITE CPFR`和`SITE CPTO`命令将包含PHP代码的字符串写入目标服务器的`/tmp`目录，然后将其复制到Web目录下的`backdoor.php`文件中。修改后的脚本增加了从远程服务器下载shell的功能。
*   `README.md`: 描述了如何使用该脚本。要求用户创建一个PHP反向Shell，并通过HTTP服务器托管。然后，该脚本使用漏洞将这个shell下载到目标服务器上。

**潜在的投毒风险：**

虽然脚本本身是为了利用漏洞，但存在以下潜在的投毒风险：

1.  **反向Shell托管服务器：** 攻击者可能会诱导用户使用恶意的PHP反向Shell，从而在用户不知情的情况下控制目标服务器。用户需要自行生成php reverse shell, 并且在本地启动一个http服务来提供下载，此步骤存在一定风险, 如果下载的shell是恶意代码，则可以控制受害者主机。
2.  **依赖外部资源：** 脚本依赖于外部的PHP反向Shell文件和HTTP服务器。如果这些资源被篡改，可能会导致意外的行为或安全问题。

总体来说，投毒风险主要集中在用户自定义的PHP反向Shell脚本本身。虽然脚本作者可能没有直接植入恶意代码，但是脚本利用了外部资源，增加了潜在风险。

**利用方式：**

1.  **漏洞利用：** 使用`SITE CPFR`和`SITE CPTO`命令，将恶意PHP代码写入目标服务器的Web目录下。
2.  **后门植入：** 在Web目录下创建一个PHP后门文件（例如`backdoor.php`），允许攻击者执行任意命令。
3.  **远程代码执行：** 通过访问后门文件，并传递`cmd`参数，执行任意系统命令。
4.  **反向Shell：** 通过`wget`或者`curl`下载并执行反向shell, 从而控制目标主机。

**安全建议：**

*   升级ProFTPD到不受漏洞影响的版本。
*   禁用或限制mod_copy模块的使用。
*   对Web目录进行严格的权限控制，防止未经授权的文件写入。
*   使用安全扫描工具检测Web目录下的恶意文件。

**项目地址:** [cdedmondson/Modified-CVE-2015-3306-Exploit](https://github.com/cdedmondson/Modified-CVE-2015-3306-Exploit)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #6

**来源**: [CVE-2015-3306-cved-sources_cve-2015-3306.md](../2015/CVE-2015-3306-cved-sources_cve-2015-3306.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #7

**来源**: [CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md](../2015/CVE-2015-3306-cybersensei-EH_hackviser_labs_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD 1.3.5 mod_copy 远程命令执行

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程命令执行

**影响应用:** ProFTPD

**危害等级:** 高危，可读取和写入任意文件，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** ProFTPD 1.3.5 开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。该模块允许未经授权的远程攻击者利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性分析：**

提供的 Python 脚本 `exploit.py` 针对 CVE-2015-3306 漏洞，其基本原理是：

1.  连接到目标 ProFTPD 服务器的 21 端口。
2.  发送 `SITE CPFR /secret.txt` 命令，指示服务器从 `/secret.txt` 文件进行复制。
3.  发送 `SITE CPTO /var/www/html/secret.txt` 命令，指示服务器将复制的内容写入 `/var/www/html/secret.txt` 文件。 
4. 通过http请求访问/var/www/html/secret.txt，验证漏洞是否成功

如果目标服务器存在此漏洞且启用了 `mod_copy` 模块，攻击者可以利用此脚本将服务器上的 `/secret.txt` 文件复制到 Web 服务器的根目录，然后通过 Web 浏览器访问该文件，从而获取敏感信息。

**投毒风险分析：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码或后门。脚本的功能与其声明的目的相符，即利用 CVE-2015-3306 漏洞复制文件。脚本仅包含用于连接 FTP 服务器、发送命令和验证文件是否成功写入的代码。因此，可以认为该仓库不存在投毒代码的可能性较高。

**利用方式：**

1.  **目标确定：** 确定运行 ProFTPD 1.3.5 且启用 `mod_copy` 模块的目标服务器。
2.  **脚本执行：** 运行提供的 `exploit.py` 脚本，并提供目标服务器的 IP 地址作为参数 (`python3 exploit.py <target-ip>`)。
3.  **文件访问：** 脚本成功执行后，尝试通过 Web 浏览器访问复制后的文件（例如，`http://<target-ip>/secret.txt`）。如果成功访问，则表明漏洞利用成功。
4.  **权限提升：** 理论上，如果攻击者可以写入任意文件，则可以通过写入恶意的 PHP 脚本到 Web 服务器的根目录，从而实现远程代码执行，最终完全控制服务器。例如可以cpfr /etc/passwd 到web目录。但是本脚本仅仅复制了/secret.txt文件，实际危害取决于该文件的内容。

**注意事项：**

*   确保在授权的情况下进行漏洞利用测试。
*   在生产环境中利用此漏洞可能导致严重的安全问题。
*   建议及时升级 ProFTPD 版本或禁用 `mod_copy` 模块以修复此漏洞。

**项目地址:** [cybersensei-EH/hackviser_labs_CVE-2015-3306](https://github.com/cybersensei-EH/hackviser_labs_CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #8

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #9

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---



---

## POC #9

**来源**: [CVE-2015-3306-donmedfor_CVE-2015-3306.md](../2015/CVE-2015-3306-donmedfor_CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 模块任意文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5 及更早版本

**利用条件:** 目标服务器运行 ProFTPD 1.3.5 及更早版本，且启用了 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 及其早期版本的 mod_copy 模块中。该漏洞允许未经身份验证的远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：**

提供的 Python POC 代码通过 `SITE CPFR` 和 `SITE CPTO` 命令，先将包含 PHP 代码的 payload 写入临时文件，然后将该临时文件复制到 Web 目录，从而创建一个 PHP 后门。之后，可以通过 HTTP 请求执行任意命令。

从搜索引擎结果和漏洞库信息来看，该漏洞已经公开，并且存在可用的利用代码，因此漏洞利用是有效的。

**投毒风险：**

代码仓库中可能存在的投毒风险点分析：

*   **LICENSE 文件:** MIT 许可证允许自由使用、复制、修改和分发代码。恶意代码可能被隐藏在修改后的版本中。
*   **README.md 文件:**  该文件描述了漏洞和利用方法，通常不会包含恶意代码。
*   **exploit.py 文件:** 这是主要利用脚本。潜在的投毒点可能包括：
    *   修改了目标路径，指向攻击者控制的服务器。
    *   添加了额外的网络请求，向攻击者发送敏感信息。
    *   在执行命令之前或之后，执行恶意操作。
    *   后门代码如果被修改，可能会存在反弹shell或者其他恶意功能，比如安装挖矿程序，删除日志等等，如果被植入，可能导致非常严重的后果。
    *   代码中使用了 `requests` 库，这是一个潜在的风险点，因为可以通过修改请求来执行恶意操作。例如,将执行结果回传到攻击者的服务器。
*   **综合评估：** 虽然代码本身实现了漏洞利用，但仍存在一定投毒风险，比如修改了默认的路径，或在原始命令执行后追加执行恶意命令。因此，在使用前务必仔细审查代码。投毒风险评估为 10%。

**利用方式：**

1.  **连接到目标 ProFTPD 服务器。**
2.  **使用 `SITE CPFR /proc/self/cmdline` 命令读取 ProFTPD 进程的命令行参数。**
3.  **构造包含 PHP 代码的 Payload，例如 `<?php echo passthru($_GET['cmd']); ?>`。**
4.  **使用 `SITE CPTO /tmp/.<payload>` 命令将 Payload 写入临时文件。**
5.  **使用 `SITE CPFR /tmp/.<payload>` 命令读取临时文件。**
6.  **使用 `SITE CPTO <webroot>/backdoor.php` 命令将临时文件复制到 Web 目录，创建 PHP 后门。**
7.  **通过 HTTP 请求访问后门，并执行任意命令，例如 `http://<target>/backdoor.php?cmd=whoami`。**

该漏洞利用需要目标服务器开启了 mod_copy 模块，并且攻击者需要知道 Web 目录的路径。

**项目地址:** [donmedfor/CVE-2015-3306](https://github.com/donmedfor/CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #10

**来源**: [CVE-2015-3306-hackarada_cve-2015-3306.md](../2015/CVE-2015-3306-hackarada_cve-2015-3306.md)

## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #11

**来源**: [CVE-2015-3306-jptr218_proftpd_bypass.md](../2015/CVE-2015-3306-jptr218_proftpd_bypass.md)

## CVE-2015-3306-ProFTPD-mod_copy任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要mod_copy模块启用，并且目标服务器运行ProFTPD 1.3.5。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306是ProFTPD 1.3.5版本中mod_copy模块存在的一个漏洞，允许未经授权的远程攻击者通过`SITE CPFR`和`SITE CPTO`命令读取和写入任意文件。 

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码应该是有效的。多个来源 (NVD, Trend Micro, pentest-tools, Exploit-DB) 证实了漏洞的存在和利用的可能性。提供的代码实现了一个针对该漏洞的利用工具。

**投毒风险:**
提供的代码包含以下几个文件：`README.md`, `attack.cpp`, `hdr.h`, `main.cpp`, `misc.cpp`。
*   `README.md`: 描述了工具的使用方法。没有发现恶意代码。
*   `attack.cpp`: 包含`local`和`remote`函数，分别用于在目标服务器上进行本地文件复制和将本地文件内容上传到目标服务器并进行复制。 `remote`函数存在一定的风险，它会将本地文件内容复制到服务器，并尝试将此内容作为文件名进行复制，如果本地文件内容包含恶意指令，可能会存在命令注入风险。但是，主要功能是利用漏洞进行文件读写，没有明显的恶意后门代码，因此，投毒风险较低，估计为10%。这个10%的风险来源于remote函数对本地文件内容的直接使用，可能被利用进行进一步的攻击。
*   `hdr.h`: 包含头文件和函数声明，没有发现恶意代码。
*   `main.cpp`: 程序的入口点，解析命令行参数并调用相应的函数。没有发现恶意代码。
*   `misc.cpp`: 包含网络连接函数，没有发现恶意代码。

虽然代码本身主要是利用已知的漏洞，但`remote`函数中存在潜在的风险，即如果恶意用户构造包含恶意代码的文件并利用此工具上传，可能会在服务器上执行任意命令。但这更多是漏洞利用方式本身的风险，而非代码作者故意植入的后门。

**利用方式:**
利用该漏洞的攻击者可以通过以下步骤进行攻击：
1.  使用`SITE CPFR`命令指定要复制的源文件路径。
2.  使用`SITE CPTO`命令指定要复制的目标文件路径。
如果mod_copy模块没有正确验证文件路径，攻击者可以读取或写入ProFTPD服务器上的任何文件。`remote`函数还允许攻击者将本地文件内容上传到服务器并进行复制，从而实现更高级的攻击，例如覆盖配置文件或执行任意代码。

**项目地址:** [jptr218/proftpd_bypass](https://github.com/jptr218/proftpd_bypass)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #12

**来源**: [CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md](../2015/CVE-2015-3306-netw0rk7_CVE-2015-3306-Home-Lab.md)

## CVE-2015-3306 - ProFTPD mod_copy 远程文件复制到RCE

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 远程代码执行

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD 1.3.5 开启 mod_copy 模块并允许 SITE CPFR/CPTO 命令，匿名FTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 是 ProFTPD 1.3.5 版本中 mod_copy 模块的一个漏洞。该漏洞允许远程攻击者通过 SITE CPFR 和 SITE CPTO 命令读取和写入任意文件，从而导致远程代码执行。

**利用方式：**

1.  攻击者首先通过 FTP 连接到目标服务器。
2.  利用 `SITE CPFR` 命令指定源文件，例如 `/proc/self/cmdline` 以读取 ProFTPD 进程的命令行参数，或者创建一个临时 PHP 文件 `/tmp/<?php echo passthru($_GET['cmd']); ?>`用于执行命令。
3.  使用 `SITE CPTO` 命令将源文件复制到目标位置，例如 Web 目录 `/var/www/html/webshell.php`。
4.  通过 Web 浏览器访问复制到 Web 目录的恶意文件（webshell），并传递 `cmd` 参数来执行任意命令，例如 `http://<IP>/webshell.php?cmd=id`。

**有效性：**

提供的 Dockerfile 用于构建一个易受攻击的 ProFTPD 1.3.5 环境，并配置了必要的条件，例如启用 `mod_copy` 和允许匿名 FTP 访问。README.md 文件中详细描述了漏洞的利用步骤，以及如何通过上传 webshell 执行任意命令。 因此，提供的POC代码是有效的。

**投毒风险：**

Dockerfile 构建过程包含从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码并进行编译安装，理论上存在被中间人攻击替换源代码的可能性，但可能性较低。脚本生成 flag 写入 `/tmp/flag_RANDOM.txt`。`/entrypoint.sh` 脚本的功能是启动 ProFTPD 和 Apache2 服务，并且自动生成一个包含 flag 的文件。这些行为是与漏洞利用相关的，而不是恶意的。**投毒风险较低，大约为10%**。主要是对官方FTP服务器被入侵的担忧。

**项目地址:** [netw0rk7/CVE-2015-3306-Home-Lab](https://github.com/netw0rk7/CVE-2015-3306-Home-Lab)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #13

**来源**: [CVE-2015-3306-nootropics_propane.md](../2015/CVE-2015-3306-nootropics_propane.md)

## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #14

**来源**: [CVE-2015-3306-shk0x_cpx_proftpd.md](../2015/CVE-2015-3306-shk0x_cpx_proftpd.md)

## CVE-2015-3306 - ProFTPD mod_copy 文件访问控制漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读取/写入

**影响应用:** ProFTPD

**危害等级:** 高危，可读取任意文件，写入任意文件，甚至可导致远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且启用了mod_copy模块，攻击者能够连接到FTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。该模块允许远程攻击者通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
提供的 PoC 代码有效。它包含两种利用方式：

*   **方法 1：** 复制任意文件。攻击者可以使用 `SITE CPFR` 指定源文件路径，然后使用 `SITE CPTO` 指定目标文件路径，从而将服务器上的任意文件复制到 Web 目录下，然后通过 Web 访问该文件。
*   **方法 2：** 写入后门。攻击者首先尝试将 `/proc/self/cmdline` 的内容复制到 `/tmp/...<?php passthru($_GET['img']);?>`，然后再将该临时文件复制到 Web 目录下，命名为 `lndex.php`。 成功后，可以通过访问 `http://<目标IP>/lndex.php?img=<命令>` 执行任意系统命令。

**投毒风险：**
经过分析，该 PoC 代码本身不包含明显的投毒代码。代码功能明确，目的是利用漏洞进行文件复制和后门写入，没有发现其他恶意行为。投毒风险评估为 0%。

**利用方式：**
攻击者通过 FTP 客户端连接到目标 ProFTPD 服务器，发送 `SITE CPFR` 和 `SITE CPTO` 命令来利用漏洞。具体步骤如下：

1.  使用 `SITE CPFR <源文件>` 指定要复制的源文件。
2.  使用 `SITE CPTO <目标文件>` 指定复制的目标文件。

如果目标文件是 Web 目录下的 PHP 文件，攻击者可以通过 Web 浏览器访问该文件，并执行恶意代码。

**项目地址:** [shk0x/cpx_proftpd](https://github.com/shk0x/cpx_proftpd)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

## POC #15

**来源**: [CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md](../2015/CVE-2015-3306-t0kx_exploit-CVE-2015-3306.md)

## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)

---

