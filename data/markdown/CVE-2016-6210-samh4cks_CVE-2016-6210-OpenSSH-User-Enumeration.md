## CVE-2016-6210 OpenSSH 用户枚举

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** OpenSSH < 7.3， 使用SHA256或SHA512进行用户密码哈希时

**利用条件:** 目标系统开启SSH服务，且使用受影响的OpenSSH版本和配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6210 存在于 OpenSSH 7.3 之前的版本中。当配置为使用 SHA256 或 SHA512 进行用户密码哈希时，如果尝试使用不存在的用户名进行身份验证，sshd 会使用 BLOWFISH 算法对静态密码进行哈希。 由于对不存在用户名的处理方式与已存在用户名的处理方式不同，攻击者可以通过测量响应时间的差异来判断用户名是否存在。PoC 代码 `sshuserenumeration.py` 通过发送大量密码来触发漏洞，并利用时间差来枚举用户。

**有效性：**
提供的 PoC 代码 `sshuserenumeration.py` 旨在利用此漏洞进行用户枚举。通过分析代码逻辑，可以确认它实现了漏洞描述中提到的时间差测量方法。代码首先连接到目标 SSH 服务器，然后通过尝试使用不同的用户名进行身份验证，并记录每次尝试的时间。通过比较尝试使用现有用户和不存在用户的时间，可以推断出用户名是否存在。

**投毒风险：**
经过分析 `sshuserenumeration.py` 的代码，发现其主要功能是利用时间差来枚举用户名，没有发现明显的恶意代码或后门，但仍然存在一定的投毒风险。投毒风险主要体现在以下几个方面：

1.  **依赖项风险：**`sshuserenumeration.py` 依赖于 `paramiko` 和 `numpy` 库。攻击者可能通过篡改这些依赖项来引入恶意代码。
2.  **时间测量的干扰：** 如果目标系统存在其他高负载进程或网络延迟不稳定，时间测量可能受到干扰，导致枚举结果不准确。攻击者可能利用这一点来误导使用者。
3.  **错误处理：** 代码中的错误处理可能不够完善，可能导致程序崩溃或泄露敏感信息。

**利用方式：**
1.  **环境准备：** 确保目标系统运行着受影响的 OpenSSH 版本，并且配置为使用 SHA256 或 SHA512 进行用户密码哈希。
2.  **运行 PoC：** 运行 `sshuserenumeration.py` 脚本，并提供目标 SSH 服务器的地址和用户名列表。
3.  **分析结果：** 脚本会尝试使用用户名列表中的每个用户名进行身份验证，并记录每次尝试的时间。根据时间差，可以推断出用户名是否存在。

**总结：**
PoC 代码的有效性较高，可以用于验证和利用 CVE-2016-6210 漏洞。但是，在使用 PoC 代码时，需要注意潜在的投毒风险，并采取必要的安全措施。

**项目地址:** [samh4cks/CVE-2016-6210-OpenSSH-User-Enumeration](https://github.com/samh4cks/CVE-2016-6210-OpenSSH-User-Enumeration)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)