## CVE-2021-44967-LimeSurvey-RCE

**漏洞编号:** CVE-2021-44967

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** LimeSurvey

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.2.4

**利用条件:** 需要目标LimeSurvey版本为5.2.4，且攻击者需要具有可登录的管理员权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于LimeSurvey 5.2.4的插件上传和安装功能中。攻击者可以通过上传包含恶意PHP代码的插件来执行任意代码。根据漏洞描述和提供的漏洞利用代码，攻击者首先需要登录到LimeSurvey后台。然后，攻击者创建一个包含PHP反向shell和XML配置文件的ZIP文件，并通过插件管理页面上传并安装该ZIP文件。一旦插件被激活，攻击者可以通过访问上传的PHP文件来触发反向shell，从而获得对服务器的控制权。 

**有效性：**
根据漏洞描述和提供的PoC代码，可以确认该漏洞是有效的。多个搜索引擎结果也证实了该漏洞的存在。PoC代码中包含创建恶意插件、登录LimeSurvey后台、上传插件、安装并激活插件，最后触发反向shell的完整流程。脚本编写的较为完整，逻辑清晰。

**投毒风险：**
查看提供的 exploit.py 文件和相关文件，发现主要的风险在于如果直接使用该脚本而不审查，则可能在未理解代码的情况下执行。但从代码本身来看，**投毒风险较低，接近1%**，主要基于以下几点：
1. **依赖性明确**：脚本依赖于明确的参数（URL、用户名、密码、LHOST、LPORT），如果参数设置错误，脚本将无法正常工作。
2. **功能单一**：脚本的主要功能是利用漏洞，而不是执行其他恶意操作。
3. **未发现隐藏的恶意代码**：仔细审查了代码，没有发现任何看起来像是故意添加的、用于在成功利用漏洞之外执行其他恶意操作的代码。
4. LICENSE文件采用MIT许可，允许修改和再分发，但同时也明确声明作者不承担任何责任。

**利用方式：**
1.  **准备恶意插件：**  攻击者需要创建一个包含恶意PHP代码（例如反向shell）和XML配置文件的ZIP压缩包。
2.  **身份验证：**  攻击者需要使用有效的管理员凭据登录到LimeSurvey后台管理界面。
3.  **上传和安装插件：**  登录后，攻击者导航到插件管理页面，上传准备好的ZIP压缩包，并安装该插件。
4.  **激活插件：**  成功安装后，攻击者需要激活上传的插件。
5.  **触发漏洞：**  一旦插件被激活，攻击者可以通过访问上传的PHP文件来触发恶意代码的执行，例如连接到攻击者的监听端口建立反向shell。

**项目地址:** [D3Ext/CVE-2021-44967](https://github.com/D3Ext/CVE-2021-44967)

**漏洞详情:** [CVE-2021-44967](https://nvd.nist.gov/vuln/detail/CVE-2021-44967)