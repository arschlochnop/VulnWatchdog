## CVE-2019-3396-Confluence-服务器端模板注入

**漏洞编号:** CVE-2019-3396

**漏洞类型:** 服务器端模板注入 (SSTI)

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 小于6.6.12，6.7.0到小于6.12.3，6.13.0到小于6.13.3，6.14.0到小于6.14.2

**利用条件:** 需要 Confluence 实例存在 Widget Connector 宏，且目标版本未修复漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-3396 漏洞存在于 Atlassian Confluence Server 和 Data Center 的 Widget Connector 宏中。攻击者可以利用服务器端模板注入漏洞 (SSTI) 远程执行代码。根据漏洞库信息和搜索结果，该漏洞已经被广泛利用。提供的 POC 代码使用 Velocity 模板语言，尝试通过 `java.lang.Runtime` 类执行 `ipconfig` 命令。该命令本身无害，用于验证漏洞是否存在。由于poc只执行ipconfig命令，没有发现任何投毒代码。利用方式是构造恶意的 Velocity 模板，通过 Widget Connector 宏注入，从而在服务器上执行任意命令。

**项目地址:** [quanpt103/CVE-2019-3396](https://github.com/quanpt103/CVE-2019-3396)

**漏洞详情:** [CVE-2019-3396](https://nvd.nist.gov/vuln/detail/CVE-2019-3396)