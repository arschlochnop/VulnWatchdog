## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露，管理员账户接管

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS Made Simple实例开启News模块，且存在于可访问的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中存在的一个未经身份验证的盲注时间型SQL注入漏洞。该漏洞位于News模块，攻击者可以通过构造恶意的URL，利用`m1_idlist`参数实现SQL注入。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以确定该漏洞是真实存在的，并且POC代码有效。

**投毒风险：**
POC代码主要功能是利用时间盲注提取数据库信息，如用户名、密码盐等。代码中包含从`wordlist`文件读取密码进行爆破的功能，需要用户自行提供字典。代码没有发现明显的恶意投毒行为，例如文件写入、系统命令执行等。但是，用户在使用过程中需要注意以下几点：

*   如果提供的`wordlist`包含恶意Payload，则可能导致密码爆破失败或者其他安全问题。
*   脚本执行时间较长，可能会消耗大量系统资源。

总体来说，投毒风险较低，约为10%，主要来自于用户提供的`wordlist`可能存在的恶意内容。

**利用方式：**
1.  攻击者构造包含恶意SQL语句的URL，其中SQL语句利用`sleep()`函数来判断注入是否成功。
2.  攻击者通过控制`sleep()`函数的延迟时间，逐个字符地猜测数据库中的敏感信息，例如用户名、密码哈希、密码盐等。
3.  攻击者利用获取到的密码盐和密码哈希，可以使用字典进行密码破解，最终获得管理员权限。

**项目地址:** [maraspiras/46635.py](https://github.com/maraspiras/46635.py)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)