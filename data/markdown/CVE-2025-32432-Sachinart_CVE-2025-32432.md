## CVE-2025-32432-CraftCMS-远程代码执行

**漏洞编号:** CVE-2025-32432

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CraftCMS

**危害等级:** 严重，可导致完全控制受影响的系统

**影响版本:** 3.0.0-RC1 < 3.9.15, 4.0.0-RC1 < 4.14.15, 5.0.0-RC1 < 5.6.17

**利用条件:** 无需认证，目标CraftCMS实例需要存在漏洞且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32432是CraftCMS中的一个预认证远程代码执行漏洞，存在于资产转换生成功能中。攻击者可以利用此漏洞通过发送特制的POST请求到`/index.php?p=admin/actions/assets/generate-transform`，其中包含一个恶意PHP对象，该对象在反序列化时导致任意代码执行。攻击者首先需要从`/index.php?p=admin/dashboard`获取CSRF token。漏洞利用代码通过 `GuzzleHttp\Psr7\FnStream` 类来执行代码。POC代码中的投毒风险较低，主要风险在于使用者未授权使用，或是在授权渗透测试中利用此漏洞对目标系统造成超出授权范围的影响。投毒代码的判断基于：
1.  代码主要功能是漏洞利用，而非恶意行为。
2.  代码执行的是标准的漏洞利用流程，包括获取CSRF令牌、发送恶意请求和验证漏洞。
3.  代码旨在提取数据库名称和HOME目录等信息，以验证漏洞是否成功利用，而不是执行恶意操作。

**项目地址:** [Sachinart/CVE-2025-32432](https://github.com/Sachinart/CVE-2025-32432)

**漏洞详情:** [CVE-2025-32432](https://nvd.nist.gov/vuln/detail/CVE-2025-32432)