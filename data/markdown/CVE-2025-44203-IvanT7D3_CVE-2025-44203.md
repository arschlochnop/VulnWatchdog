## CVE-2025-44203 HotelDruid 3.0.0 / 3.0.7 敏感信息泄露和DoS

**漏洞编号:** CVE-2025-44203

**漏洞类型:** 敏感信息泄露，拒绝服务(DoS)

**影响应用:** HotelDruid

**危害等级:** 中危，可能导致敏感信息泄露，弱口令情况下可完全控制系统

**影响版本:** 3.0.0 和 3.0.7

**利用条件:** HotelDruid debian package configuration中"Restrict HotelDruid access to localhost?" 设置为 No

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于HotelDruid 3.0.0和3.0.7版本的creadb.php页面，通过发送大量POST请求，利用SQL verbose错误信息泄露用户名、密码哈希和盐值。攻击者如果通过弱口令爆破成功恢复明文密码，则可能控制HotelDruid系统。从exploit.py的代码可以看出其利用多线程发送POST请求触发漏洞，如果从服务器返回的数据中包含"set password" 则认为攻击成功。Brute.py通过md5 hash 和截断的salt对密码进行爆破。

**有效性评估:** 提供的POC代码看起来是有效的，因为它明确针对HotelDruid的特定版本和creadb.php端点，并且提供了利用步骤和演示视频链接。搜索结果中的CVE-2024-44203是关于macOS的照片库权限问题，与这个HotelDruid漏洞无关。需要注意的是，利用条件较为苛刻，需要将"Restrict HotelDruid access to localhost?" 设置为 No。

**投毒风险分析:**
查看了提供的Python代码 (exploit.py 和 brute.py)。代码本身实现的功能与描述的漏洞利用一致，主要涉及发送HTTP请求和进行密码哈希计算。没有发现明显恶意代码，例如下载执行其他程序、修改系统文件、或者进行隐蔽的网络通信等。但是，`exploit.py` 中的 `sys.exit(0)` 如果在高并发场景下，可能存在一定的拒绝服务风险。`brute.py`需要手动替换salt和final_hash，增加了攻击的难度。总体来说，投毒的可能性较低，估计在5%左右，主要考虑到代码本身可能存在未知的安全问题，或者被用于非授权的渗透测试活动。

**利用方式总结:**
1.  设置HotelDruid的配置，允许远程访问（即 "Restrict HotelDruid access to localhost?" 设置为 No）。
2.  运行`exploit.py`脚本，指定目标HotelDruid服务器的IP地址。
3.  如果`exploit.py`成功，它将输出密码哈希和盐值。
4.  编辑`brute.py`，将提取的盐值和密码哈希填入相应的变量。
5.  运行`brute.py`，并提供一个密码字典文件，尝试破解密码。
6.  如果密码破解成功，攻击者可以使用破解的密码登录HotelDruid系统。

**项目地址:** [IvanT7D3/CVE-2025-44203](https://github.com/IvanT7D3/CVE-2025-44203)

**漏洞详情:** [CVE-2025-44203](https://nvd.nist.gov/vuln/detail/CVE-2025-44203)