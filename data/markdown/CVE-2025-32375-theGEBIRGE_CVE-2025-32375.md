## CVE-2025-32375-BentoML-RCE

**漏洞编号:** CVE-2025-32375

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** BentoML

**危害等级:** 严重，可能导致完全控制受影响的服务器

**影响版本:** >= 1.0, < 1.4.8

**利用条件:** 需要网络访问BentoML runner server的3000端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于BentoML的runner server中，由于对反序列化的数据没有进行充分的验证，攻击者可以通过构造恶意的序列化数据，例如使用pickle，在服务器上执行任意代码。根据漏洞库信息、搜索引擎结果和提供的POC代码，此漏洞的利用方式如下：

1.  **漏洞原理：** BentoML runner server在处理请求时，使用了`pickle.loads`反序列化用户提供的输入数据。由于没有对数据来源做严格校验，攻击者可以构造包含恶意代码的序列化数据，导致远程代码执行。
2.  **利用方式：**
    *   **准备恶意payload：** exploit.py文件中的`class P`定义了一个恶意类，其`__reduce__`方法会被`pickle.dumps`调用，返回一个元组，其中包含要执行的函数（此处为`os.system`）和参数（此处为执行curl命令向攻击者控制的服务器发送请求，带上`id`命令的执行结果）。
    *   **构造恶意请求：** exploit.py 使用requests库向BentoML服务发送POST请求，设置特定的headers，其中`Content-Type` 为 `application/vnd.bentoml.pickled`，表明payload是pickle序列化的数据，`Payload-Container`等header会影响反序列化的过程。请求的data部分是pickle序列化的`P`类实例。
    *   **发送请求：** 攻击者发送构造的POST请求到BentoML runner server。
    *   **触发漏洞：** BentoML runner server在接收到请求后，反序列化`pickle`数据，由于`P`类定义了`__reduce__`方法，导致`os.system`被调用，执行攻击者指定的命令。
    *   **执行恶意代码：** `os.system`函数执行预设的命令，将服务器执行`id`命令的结果发送到攻击者的服务器（通过`curl`）。
3.  **POC有效性：** 提供的Dockerfile 构建了一个包含漏洞版本的BentoML环境(1.4.7)，docker-compose.yml 用于启动服务。exploit.py脚本可以成功触发漏洞，并在受害者机器上执行`id`命令，证明POC有效。
4.  **投毒风险：** 仔细检查了提供的所有文件，包括Dockerfile、docker-compose.yml、exploit.py以及bentoml相关的配置文件和python脚本，没有发现任何明显的投毒代码。例如，Dockerfile只安装了必要的依赖，没有执行任何可疑操作。exploit.py只是利用漏洞，没有添加额外的恶意功能。因此，投毒风险极低，可以认为是0%。

**项目地址:** [theGEBIRGE/CVE-2025-32375](https://github.com/theGEBIRGE/CVE-2025-32375)

**漏洞详情:** [CVE-2025-32375](https://nvd.nist.gov/vuln/detail/CVE-2025-32375)