## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地用户访问，目标系统安装了存在漏洞的polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地攻击者利用 polkit 中的缺陷绕过凭据检查，从而将权限提升为 root 用户。根据漏洞库信息和搜索结果，该漏洞已被广泛公开，并且存在可用的利用代码。提供的 Python POC 代码尝试通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。其利用方式是利用 polkit 对 D-Bus 请求处理的缺陷，绕过正常的身份验证流程。由于该POC代码目的明确，且没有发现任何尝试执行恶意操作，连接外部网络或者添加后门的迹象，因此，投毒风险评估为0%。

**利用方式：**

1.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户。 
2.  利用 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试设置用户密码。
3.  利用`su` 命令切换到创建的用户，然后使用 `sudo su`命令提升到 root 权限。

**有效性：**

该POC代码尝试创建用户并设置密码，如果成功，则可以利用新创建的用户登录并尝试提升权限，但是该POC 代码使用的创建用户的用户名是写死的，如果存在同名用户，则会利用失败，需要手动修改用户名，根据搜索结果，确认该漏洞已被积极利用,故该POC的有效性高。


**项目地址:** [TieuLong21Prosper/CVE-2021-3560](https://github.com/TieuLong21Prosper/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)