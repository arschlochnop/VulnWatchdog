## CVE-2025-3515 - Drag and Drop Multiple File Upload for Contact Form 7 - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-3515

**漏洞类型:** 任意文件上传

**影响应用:** Drag and Drop Multiple File Upload for Contact Form 7 WordPress插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.3.8.9

**利用条件:** 目标网站使用存在漏洞的WordPress插件，且服务器配置允许执行上传的恶意文件（如.phar）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Drag and Drop Multiple File Upload for Contact Form 7 WordPress插件中，由于文件类型验证不足，允许未经验证的攻击者上传任意文件。攻击者可以通过上传包含恶意代码的.phar文件（或其他被服务器解析为PHP的文件）来执行远程代码。

**有效性：**
根据漏洞信息和POC代码，可以判定该漏洞利用是有效的。漏洞描述明确指出由于文件类型验证不足，可以上传.phar等文件，搜索引擎结果也确认了该漏洞的存在及其可能导致的远程代码执行。提供的POC代码包括一个检测脚本(checker.py)用于判断目标网站是否安装了受影响的插件，以及一个利用脚本(exploit.py)用于上传包含webshell的PHP文件。

**投毒风险：**
`exploit.py` 会从 `https://raw.githubusercontent.com/Professor6T9/Filemanager/refs/heads/main/FM.txt` 下载内容，并写入webshell， 存在从远程地址获取恶意代码的风险，可以被远程投毒。 checker.py 本身没有明显投毒代码。

从风险角度分析，`exploit.py`具有一定的投毒风险，但`checker.py`投毒风险较低。
综合评估，投毒风险为10%。

**利用方式：**
1.  **检测：** 运行 checker.py 脚本，该脚本会扫描目标网站是否存在受影响的Drag and Drop Multiple File Upload for Contact Form 7插件。
2.  **上传：** 如果检测到存在漏洞的插件，运行 exploit.py 脚本。
3.  **Shell生成:** exploit.py 脚本会从远程服务器下载内容，生成一个名为`admin.php`的webshell，内容从硬编码的URL地址获得。 
4.  **文件上传：**  exploit.py脚本会将包含webshell的PHP文件上传到目标网站的`wp-admin/admin-ajax.php?action=ddmu_upload_file`接口。
5.  **远程代码执行：**  成功上传后，攻击者可以通过访问上传的PHP文件（webshell）来执行任意代码。

**项目地址:** [Professor6T9/CVE-2025-3515](https://github.com/Professor6T9/CVE-2025-3515)

**漏洞详情:** [CVE-2025-3515](https://nvd.nist.gov/vuln/detail/CVE-2025-3515)