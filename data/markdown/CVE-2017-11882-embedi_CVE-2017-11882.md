## CVE-2017-11882-Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏漏洞

**影响应用:** Microsoft Office

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 用户需要打开特制的Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882是一个存在于Microsoft Office的Equation Editor组件中的内存破坏漏洞。攻击者可以利用此漏洞在当前用户的上下文中执行任意代码。

**有效性：**
提供的POC代码看起来是有效的，并且在野外被广泛利用。搜索引擎结果显示该漏洞被用于传播各种恶意软件，包括Agent Tesla等。

**利用方式：**
该漏洞的利用方式涉及构造包含恶意OLE对象的RTF文档。这些对象利用Equation Editor组件中的内存破坏漏洞，允许攻击者执行任意命令。PoC代码演示了如何使用WebDAV来绕过命令长度限制，从攻击者控制的服务器下载并执行任意程序。攻击者通常会将恶意代码放置在WebDAV服务器上，然后诱骗受害者打开恶意文档，触发漏洞并执行代码。

**投毒风险：**
虽然提供的代码本身主要用于演示漏洞利用，但仍然存在一定投毒风险。`webdav_exec_CVE-2017-11882.py` 脚本的功能是从远程WebDAV服务器执行任意程序。作者可以在WebDAV服务器上放置恶意程序，即使脚本本身没有问题，用户执行脚本时依然可能被感染。

同时OBJDATA_TEMPLATE变量中的数据，虽然大部分是填充字节，但仔细检查，仍然存在隐藏恶意代码的可能性。所以评估投毒风险为10%。

**项目地址:** [embedi/CVE-2017-11882](https://github.com/embedi/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)