## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** XSS

**影响应用:** cPanel

**危害等级:** 中危，可能导致会话劫持、恶意重定向、页面内容篡改等

**影响版本:** < 11.109.9999.116

**利用条件:** 需要目标服务器运行存在漏洞的cPanel版本，攻击者能够发送包含恶意JavaScript代码的URL给受害者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29489是cPanel中存在的一个跨站脚本漏洞。具体来说，`/cpanelwebcall/`端点没有正确地过滤用户输入，导致攻击者可以构造包含恶意JavaScript代码的URL。如果受害者访问了这个URL，恶意代码就会在受害者的浏览器中执行，从而导致会话劫持、恶意重定向、页面内容篡改等。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，该漏洞是有效的。多个来源确认了漏洞的存在，并且提供了验证方法。PoC代码通过发送包含XSS payload的请求到`/cpanelwebcall/`端点来验证漏洞。

**投毒风险：**
PoC代码本身的功能是扫描网站是否存在CVE-2023-29489漏洞。代码主要由以下部分组成：

*   **请求发送与响应判断：** 使用`requests`库发送HTTP请求，并根据响应内容判断是否存在漏洞。
*   **多线程扫描：** 使用`multiprocessing.dummy.Pool`进行多线程扫描，提高效率。
*   **结果输出：** 将扫描结果输出到控制台，并将存在漏洞的URL保存到文件中。

分析代码，存在少量潜在的风险，例如:
*   **依赖库安装风险：** `requirements.txt` 中可能存在恶意依赖，虽然当前未提供此文件。
*   **结果文件投毒：** 攻击者可能通过分析扫描结果，针对性地发起攻击。
*   **作者的签名:** 脚本中包含作者的Telegram频道链接，这可能被用于传播恶意软件。

综合评估，投毒风险约为10%。

**利用方式：**
利用方式主要为构造恶意的URL，诱导受害者点击。构造的URL包含XSS payload，例如`<img src=x onerror="prompt(1)">`。当受害者访问该URL时，payload会在其浏览器中执行，实现XSS攻击。

1.  **确定目标：** 找到运行着存在漏洞的cPanel版本的服务器。
2.  **构造恶意URL：** 构造包含XSS payload的URL，例如`https://目标服务器/cpanelwebcall/%3Cimg%20src=x%20onerror=%22prompt(1)%22%3Eaaaaaaaaaaaa`
3.  **诱导受害者点击：** 将恶意URL发送给受害者，诱导其点击。
4.  **执行XSS攻击：** 如果受害者点击了恶意URL，payload就会在其浏览器中执行，攻击者可以利用XSS漏洞进行各种攻击，例如会话劫持、恶意重定向、页面内容篡改等。

**项目地址:** [Thuankobtcode/CVE-2023-29489](https://github.com/Thuankobtcode/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)