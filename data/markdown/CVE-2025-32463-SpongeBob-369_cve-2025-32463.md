## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463是一个存在于Sudo的本地权限提升漏洞。攻击者可以利用`--chroot`选项，通过控制`/etc/nsswitch.conf`文件来加载恶意共享库，从而以root权限执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和PoC代码，该漏洞利用是有效的。PoC代码构建了一个包含恶意`/etc/nsswitch.conf`的chroot环境，当sudo以chroot模式运行时，会加载并执行恶意共享库，从而获得root权限。

**投毒风险：**
代码仓库中潜在的投毒风险较低（估计为5%）。PoC代码的主要功能是演示漏洞利用，而非执行恶意操作。风险点在于`woot1337.c` 中的shell命令，如果修改 `${CMD_C_ESCAPED}` 可能会执行非预期的恶意指令。

**利用方式：**
1.  构建一个包含自定义`/etc/nsswitch.conf`的目录结构，该文件指向一个恶意的NSS模块（共享库）。
2.  使用`sudo -R <fake_root_dir> <command>`命令，以chroot模式运行sudo。sudo会读取伪造的`/etc/nsswitch.conf`。
3.  由于sudo进程此时以root权限运行，它将加载并执行攻击者提供的恶意NSS模块（共享库），从而获得root权限。

**代码分析:**
*   `Dockerfile`: 用于构建包含易受攻击的Sudo版本（1.9.15p5）的Ubuntu环境。
*   `run.sh`:  使用Docker构建并运行包含漏洞环境的容器。
*   `sudo-chroot.sh`:  这是PoC脚本的核心，它创建一个临时目录，并在该目录中构建一个伪造的chroot环境，其中包含恶意的`/etc/nsswitch.conf`文件。该文件指示系统加载一个恶意的共享库（`libnss_/woot1337.so.2`）。然后，它使用`sudo -R woot woot`命令以chroot模式运行sudo，从而触发漏洞。
*   `woot1337.c`:  这个C程序被编译成一个共享库，它包含一个构造函数`woot()`。当共享库被加载时，`woot()`函数会被自动执行。该函数将进程的UID和GID设置为0（root），然后执行一个shell命令。

**项目地址:** [SpongeBob-369/cve-2025-32463](https://github.com/SpongeBob-369/cve-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)