## CVE-2019-9978 - WordPress Social Warfare Plugin 存储型XSS和远程代码执行

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型XSS / 远程代码执行 (RCE)

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 高危，可能导致网站权限被获取，远程代码执行。

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了存在漏洞的Social Warfare插件，攻击者可以无需认证利用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前的版本中存在的存储型XSS漏洞，并且由于 settings import 功能存在缺陷，可以被利用于远程代码执行。根据漏洞信息和搜索结果，该漏洞已被在野利用。

**有效性：**

提供的POC代码`exploit.sh` 看起来是有效的。它利用`swp_debug=load_options` 和 `swp_url` 参数，通过POST请求将恶意代码注入到插件设置中。具体来说，它：

1.  接受目标WordPress URL，攻击者IP，和要执行的命令作为参数。
2.  创建一个名为`backdoor.php`的文件，该文件包含PHP代码，用于执行经过base64编码的命令（通过GET参数 `cmd`）。
3.  使用`curl`向目标WordPress网站的`wp-admin/admin-post.php`发送请求，设置 `swp_debug=load_options`，并通过`swp_url`参数指向攻击者服务器上的`backdoor.php`文件。`cmd`参数包含经过base64编码的命令。
4.  从响应中提取有用的信息并展示。
5.  删除临时文件。

**投毒风险：**

分析POC代码，`exploit.sh`脚本的主要功能是生成包含恶意PHP代码的`backdoor.php`文件，然后利用漏洞将该文件包含到目标网站上。在提供的`exploit.sh`脚本和 `README.md` 文件中，没有发现明显的恶意代码或后门。 风险极低。

**利用方式：**

1.  **存储型XSS：**攻击者利用`swp_debug=load_options` 和 `swp_url` 参数将恶意JavaScript代码存储到插件设置中。当管理员或其他用户访问插件设置页面时，恶意代码会被执行。
2.  **远程代码执行 (RCE)：**通过包含恶意PHP文件(`backdoor.php`)，攻击者可以在目标服务器上执行任意代码。该PHP文件会接收一个base64编码的命令，解码后使用`system()`函数执行。

攻击者首先要搭建一个可以访问的web服务器，将包含恶意代码的`backdoor.php`放置其中，然后构造恶意的URL，发送到存在漏洞的wordpress网站，如果目标网站没有更新到最新版本，则可能存在远程代码执行漏洞。


**项目地址:** [d3fudd/CVE-2019-9978_Exploit](https://github.com/d3fudd/CVE-2019-9978_Exploit)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)