## CVE-2023-50164: Apache Struts 文件上传路径遍历导致RCE漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32, 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要 Struts 应用存在文件上传功能，且应用使用了 ActionSupport 类。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，允许攻击者通过操纵文件上传参数来执行路径遍历。在某些情况下，这可能导致上传恶意文件，进而执行远程代码。根据漏洞信息，该漏洞的CVSS评分为9.8，表明其严重性。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者可以修改文件上传请求中的参数，利用 `..` 等路径遍历字符，突破上传目录的限制，将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 通过路径遍历，攻击者可以将包含恶意代码的文件（例如 JSP 文件、Servlet 文件等）上传到 Web 容器的可执行目录下。
3.  **远程代码执行 (RCE)：** 一旦恶意文件被上传到可执行目录，攻击者可以通过访问该文件来触发恶意代码的执行，从而实现远程代码执行。

**POC有效性评估：**

提供的漏洞利用代码是一个简单的说明文档，描述了如何搭建调试环境以及分析漏洞。该文档本身**不是完整的可直接运行的POC**，但它指明了漏洞利用的方向，可以辅助安全研究人员或攻击者复现漏洞。

虽然这里提供的POC只有搭建环境说明，但是参考搜索结果，网上已存在公开的POC，因此可以认为此漏洞利用是有效的。

**投毒风险分析：**

由于提供的漏洞利用代码只是一个README.md文件，描述了搭建调试环境的步骤和漏洞分析的简要说明。该文件本身不包含可执行代码，因此，**该文件本身投毒的可能性非常低。**

但是,考虑到黑客攻击的复杂性，不排除作者在搭建环境过程中，通过其他方式进行投毒的可能性。所以，我个人认为投毒风险为10%。需要进一步分析才能给出更精确的评估。

**总结：**

CVE-2023-50164 是一个高危漏洞，攻击者可以利用该漏洞实现任意文件上传和远程代码执行。建议受影响的用户尽快升级到 Struts 2.5.33 或 Struts 6.3.0.2 或更高版本。

**项目地址:** [minhbao15677/CVE-2023-50164](https://github.com/minhbao15677/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)