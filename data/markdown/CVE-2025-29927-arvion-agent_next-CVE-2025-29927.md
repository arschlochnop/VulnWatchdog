## CVE-2025-29927-Next.js-中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中的一个授权绕过漏洞。攻击者可以通过发送包含`x-middleware-subrequest`标头的特制请求来绕过中间件安全控制，获得对受保护路由的未授权访问。

**有效性：**

根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的PoC可以验证。提供的代码库包含一个简单的中间件示例，它故意将`isAuthorized`设置为`false`，从而始终返回401 Unauthorized。通过构造包含`x-middleware-subrequest`的请求可以绕过这个中间件。

**投毒风险：**

代码库中主要包含以下文件：

*   `README.md`: 描述了漏洞和缓解措施。
*   `middleware.js`: 包含一个简单的中间件函数，用于演示授权绕过。
*   `package-lock.json`: 依赖项锁文件，用于保证依赖一致性。

分析这些文件，没有发现明显的恶意代码或后门。`package-lock.json` 中包含一些依赖项，例如 `next`, `react` 和 `react-dom`，以及一些构建依赖,但没有发现异常。投毒风险较低,但也需要谨慎评估,给出 5% 的投毒风险评估.

**利用方式：**

利用此漏洞的典型方式如下：

1.  应用程序使用Next.js中间件进行授权检查。
2.  攻击者构造一个HTTP请求，并在请求头中包含`x-middleware-subrequest: anything`。
3.  Next.js的漏洞导致中间件未能正确处理此标头，从而绕过了授权检查。
4.  攻击者成功访问受保护的路由。

**项目地址:** [arvion-agent/next-CVE-2025-29927](https://github.com/arvion-agent/next-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)