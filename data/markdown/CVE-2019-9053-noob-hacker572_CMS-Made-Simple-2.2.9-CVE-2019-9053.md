## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露，权限提升

**影响版本:** <= 2.2.8

**利用条件:** 需要目标CMS存在News模块，且允许未授权用户访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于CMS Made Simple 2.2.8的News模块中。攻击者可以通过构造恶意的URL，利用m1_idlist参数进行基于时间的盲SQL注入。漏洞利用代码显示，通过精心构造的payload，攻击者可以逐步猜测数据库中的敏感信息，例如用户名、密码Salt值、密码哈希值等。该漏洞不需要身份验证即可利用。

**有效性分析：**
漏洞库信息、搜索引擎结果和漏洞利用代码都表明该漏洞是存在的，并且存在可用的PoC代码。PoC代码利用了基于时间的盲注，并通过不断尝试字符来dump数据库信息，包括用户名、Salt和密码的哈希值。因此，可以判断PoC代码有效。

**投毒风险分析：**
分析PoC代码后，发现其主要功能是利用SQL注入漏洞提取信息。代码中包含了一些美化输出的函数，如`beautify_print_try`和`beautify_print`，但没有发现明显的恶意代码，例如执行系统命令或修改文件等。

但是，仍存在一定程度的投毒风险，主要体现在以下几个方面：
1.  **依赖性：** 代码依赖于`requests`和`termcolor`等第三方库，如果这些库本身存在安全问题，或者被替换为恶意版本，可能导致安全风险。
2.  **时间盲注的延迟：** 代码中设置了`TIME`变量，用于控制时间盲注的延迟。如果`TIME`设置过小，可能导致注入失败；如果设置过大，可能导致攻击耗时过长。
3. **密码破解：** 代码包含破解密码的功能，使用用户提供的字典进行破解。攻击者可能使用恶意或不完整的字典，从而消耗大量资源或导致不准确的结果。
4. **编码问题** 程序中存在编码问题可能导致Payload执行异常

综上，认为存在10%的投毒风险，主要来自于潜在的依赖库风险和用户配置不当的可能性。

**利用方式：**
1.  确定目标CMS的版本低于或等于2.2.8，并且安装了News模块。
2.  使用PoC代码，指定目标URL。
3.  PoC代码会利用SQL注入漏洞，通过基于时间的盲注来获取数据库信息，例如用户名、密码Salt值和密码哈希值。
4.  （可选）如果提供了字典，PoC代码会尝试破解密码。

**项目地址:** [noob-hacker572/CMS-Made-Simple-2.2.9-CVE-2019-9053](https://github.com/noob-hacker572/CMS-Made-Simple-2.2.9-CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)