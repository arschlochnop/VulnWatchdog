## CVE-2025-24813 - Apache Tomcat Path Equivalence/Partial PUT RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/Partial PUT远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足多个条件：默认Servlet启用写入(默认禁用)，启用Partial PUT(默认启用)，目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且通过Partial PUT上传敏感文件。RCE还需要应用程序使用Tomcat的文件会话持久性，以及存在可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，结合启用了写入功能的默认Servlet和Partial PUT功能，可能导致远程代码执行和敏感信息泄露。漏洞利用方式如下：

1.  **信息泄露/内容注入:** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   目标URL是公共上传URL的子目录
    *   攻击者知道敏感文件名
    *   通过Partial PUT上传敏感文件
攻击者可以查看敏感文件或向其中注入恶意内容。

2.  **远程代码执行 (RCE):** 如果满足以下条件：
    *   默认Servlet启用写入（默认禁用）
    *   启用Partial PUT（默认启用）
    *   应用程序使用Tomcat的文件会话持久性，且使用默认存储位置
    *   应用程序包含可利用的反序列化库
攻击者可以通过上传恶意序列化session文件，利用反序列化漏洞执行任意代码。

**有效性：**
根据搜索结果，CVE-2025-24813漏洞存在活跃的利用。PoC代码的README描述了一个基本的利用流程，包括克隆仓库、安装依赖、运行PoC脚本，表明该PoC可能有效，但具体利用成功与否取决于目标环境的配置是否满足漏洞利用条件。PoC的有效性较高，因为搜索结果显示该漏洞正在被积极利用。

**投毒风险：**
分析提供的PoC代码（README.md），投毒风险较低。README.md文件只包含漏洞描述、环境配置、使用方法和免责声明。虽然PoC代码没有直接展示`poc.py`的内容，但是根据描述`poc.py`脚本会提示用户输入目标URL，表明其功能是针对目标进行漏洞验证而非植入后门。当然，`poc.py`本身可能包含恶意代码。在没有查看 `poc.py` 的内容的情况下，预估`poc.py`存在投毒代码的可能性较低，大约10%。主要考虑到以下几点：

*   PoC旨在验证漏洞的存在，而非长期控制目标系统。
*   公开的PoC代码通常会接受安全社区的审查，增加投毒的难度。
*   作者声明仅用于教育和研究目的。

**利用方式总结：**
攻击者利用此漏洞的方式是，首先需要满足前置条件（Default Servlet开启写入、Partial PUT启用等）。然后，通过构造恶意的PUT请求，并利用路径等价，覆盖或者修改敏感文件，实现信息泄露或RCE。RCE场景依赖于反序列化漏洞的利用，需要上传精心构造的恶意序列化数据。

**项目地址:** [CEAlbez/CVE-2025-24813-PoC](https://github.com/CEAlbez/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)