## CVE-2023-51770-Apache DolphinScheduler-任意文件读取

**漏洞编号:** CVE-2023-51770

**漏洞类型:** 任意文件读取

**影响应用:** Apache DolphinScheduler

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 3.2.1

**利用条件:** 需要网络访问到DolphinScheduler服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-51770 是 Apache DolphinScheduler 3.2.1 之前版本中存在的任意文件读取漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，从而获取敏感配置信息、密钥或其他敏感数据。

**有效性：** 根据漏洞库信息和搜索结果可以确定这个漏洞是存在的。虽然提供的 "漏洞利用代码" 实际上是 CONTRIBUTING.md 和 LICENSE 文件，但它们的存在也证明了受影响的 Apache DolphinScheduler 项目的仓库结构。这些信息可用于验证漏洞的存在。

**投毒风险：** 提供的代码片段（CONTRIBUTING.md 和 LICENSE）本身并不包含任何恶意代码，因此直接投毒的可能性较低。但是，考虑到这是Apache DolphinScheduler的开源项目仓库中的一部分，如果攻击者能够通过其他方式（例如，通过影响构建过程或依赖项）向项目注入恶意代码，并将其提交到公共仓库，则存在间接投毒的风险。由于缺乏代码审计信息，投毒风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者发送特制的请求到受影响的 Apache DolphinScheduler 实例。
2.  **路径穿越：** 该请求包含恶意构造的文件路径，利用程序中未正确处理路径的缺陷，实现路径穿越，访问到目标文件。
3.  **文件读取：** 服务器在未授权的情况下，将目标文件的内容返回给攻击者。
4.  **信息泄露：** 攻击者分析返回的文件内容，获取敏感信息，例如数据库凭据、API 密钥等。

**总结：** CVE-2023-51770 是一个典型的任意文件读取漏洞，利用方式相对简单。攻击者可以通过构造恶意请求读取服务器上的敏感文件。虽然提供的代码片段本身不构成漏洞利用代码，但它验证了漏洞的存在，并提供了关于受影响项目的文件结构信息。考虑到开源软件供应链的复杂性，仍然存在一定的投毒风险。

**项目地址:** [shoucheng3/apache__dolphinscheduler_CVE-2023-51770_3_2_1_fixed](https://github.com/shoucheng3/apache__dolphinscheduler_CVE-2023-51770_3_2_1_fixed)

**漏洞详情:** [CVE-2023-51770](https://nvd.nist.gov/vuln/detail/CVE-2023-51770)