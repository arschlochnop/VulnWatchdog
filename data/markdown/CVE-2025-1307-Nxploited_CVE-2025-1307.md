## CVE-2025-1307-Newscrunch-任意文件上传

**漏洞编号:** CVE-2025-1307

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Newscrunch Theme

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.8.4.1

**利用条件:** 需要已认证的Subscriber级别或以上权限的WordPress用户账户

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-1307存在于WordPress的Newscrunch主题中，允许具有Subscriber或以上权限的已认证攻击者上传任意文件。该漏洞是由于`newscrunch_install_and_activate_plugin()`函数中缺少权限检查导致的。攻击者可以利用此漏洞上传恶意的PHP文件，从而实现远程代码执行。POC代码首先检查目标站点的Newscrunch主题版本是否在受影响范围内。然后，尝试使用提供的用户名和密码登录WordPress后台。成功登录后，POC利用`newscrunch_install_activate_plugin`动作上传payload zip文件，payload zip文件解压后，即可上传恶意php文件. 

**有效性：**
提供的POC代码是有效的，因为它模拟了攻击者利用该漏洞的步骤：版本检测、登录认证（Subscriber+权限）、上传包含恶意PHP文件的ZIP压缩包。

**投毒风险：**
POC代码本身存在一定的投毒风险，虽然主要目的是验证漏洞，但如果payload_url指向的zip文件中包含恶意代码（例如后门），则可能导致目标服务器被植入恶意软件。此外，如果作者有意在payload zip中加入带有漏洞的文件，虽然不一定能直接远程代码执行，但是可能会降低目标的安全性。综合判断，投毒风险为20%。代码看起来主要是实现漏洞利用的功能，没有明显的恶意行为，但是利用过程中下载并执行了payload，这个payload的内容存在被恶意篡改的风险。

**利用方式：**
1.  **版本检测：** 脚本会首先尝试从目标网站的readme.txt文件中获取Newscrunch主题的版本信息。如果版本低于或等于1.8.4，则认为目标存在漏洞。
2.  **身份验证：**  脚本使用提供的用户名和密码尝试登录WordPress后台。漏洞利用需要Subscriber或更高权限的账户。
3.  **上传恶意文件：** 脚本通过向`wp-admin/admin-ajax.php`发送POST请求，并设置`action=newscrunch_install_activate_plugin`来触发漏洞。`plugin_url`参数指定了包含恶意PHP文件的ZIP压缩包的URL。
4.  **远程代码执行：** 成功上传后，恶意PHP文件会被解压到服务器上，攻击者可以通过访问该文件来执行任意代码。

**项目地址:** [Nxploited/CVE-2025-1307](https://github.com/Nxploited/CVE-2025-1307)

**漏洞详情:** [CVE-2025-1307](https://nvd.nist.gov/vuln/detail/CVE-2025-1307)