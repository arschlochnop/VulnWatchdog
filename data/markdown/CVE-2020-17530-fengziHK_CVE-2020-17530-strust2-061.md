## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行存在漏洞的Apache Struts版本，且允许用户可控的输入传递到OGNL表达式的计算中。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17530 是一个 Apache Struts 框架的远程代码执行漏洞，由于Struts框架在处理tag标签属性时，会对用户输入进行二次OGNL表达式解析导致。

**有效性：**

根据漏洞信息和搜索结果，此漏洞是真实存在的，并且在野外已被利用。提供的POC代码尝试利用此漏洞执行任意命令。POC代码的原理是构造一个包含恶意OGNL表达式的URL，该表达式会被Struts框架解析并执行，从而实现远程代码执行。

**投毒风险：**

该POC代码主要功能是通过发送包含恶意OGNL表达式的HTTP请求来利用漏洞。经过分析，该脚本的目的是执行用户指定的命令，没有发现明显的后门代码。虽然存在通过执行任意命令来植入后门的潜在可能，但就代码本身而言，投毒的概率较低，约为1%。 需要注意的是，攻击者可以使用此漏洞植入恶意软件，因此使用此PoC需要谨慎。

**利用方式：**

1.  **确定目标系统:** 确认目标系统运行着受影响的Apache Struts版本 (2.0.0 - 2.5.25)。
2.  **构造恶意URL:**  使用POC脚本，将目标URL和要执行的命令作为参数传递给脚本。脚本会构造一个包含恶意OGNL表达式的URL。该表达式利用`freemarker.template.utility.Execute`类执行命令。
3.  **发送请求:**  脚本向目标系统发送构造好的HTTP GET 请求。
4.  **执行命令:**  如果目标系统存在漏洞，Struts框架会解析并执行恶意OGNL表达式，从而执行指定的命令。
5.  **获取结果:** POC脚本会从返回的页面提取命令执行的结果，并输出。

**项目地址:** [fengziHK/CVE-2020-17530-strust2-061](https://github.com/fengziHK/CVE-2020-17530-strust2-061)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)