## CVE-2025-29927-Next.js Middleware 权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**利用条件:** 目标应用使用了Next.js中间件，并且版本在受影响范围内。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件的一个权限绕过漏洞。攻击者可以通过设置 `x-middleware-subrequest` 头部来绕过中间件中的权限检查，例如身份验证。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞被认为是高危漏洞，CVSS评分高达9.1。多个安全厂商（Rapid7, Picus Security, JFrog, Truesec, Zscaler, Akamai等）都发布了关于此漏洞的分析和缓解措施。提供的漏洞利用代码通过发送带有特制 `x-middleware-subrequest` 头的请求来验证漏洞的存在。如果正常请求返回 403 状态码，而带有 `x-middleware-subrequest` 头的请求返回 200 状态码，则表明漏洞存在。

**投毒风险分析：**
查看了提供的 exploit 代码，主要功能是发送带有不同payload的 HTTP 请求来测试目标是否存在中间件绕过漏洞。代码中没有发现明显的恶意行为，例如回连恶意服务器，上传恶意文件，或者删除数据等。ThreadPoolExecutor多线程提高扫描速度，结果输出到文件。但是，使用者仍需注意，未经授权的漏洞扫描和利用行为可能触犯法律。存在的风险点是,在扫描之前被篡改了，添加了恶意代码，或者扫描目标本身就被投毒了。因此，**投毒的可能性评估为10%**。

**利用方式分析：**
1.  攻击者首先需要确定目标应用是否使用了 Next.js 中间件，并且版本在受影响范围内。
2.  攻击者构造包含 `x-middleware-subrequest` 头的 HTTP 请求，并将该请求发送到目标应用。
3.  如果目标应用存在漏洞，中间件的权限检查将被绕过，攻击者可以访问受保护的资源或执行未经授权的操作。
4.  漏洞利用代码通过遍历不同的 `x-middleware-subrequest` 的 payload，并比较正常请求和恶意请求的响应，来检测漏洞是否存在。

**项目地址:** [0x0Luk/0xMiddleware](https://github.com/0x0Luk/0xMiddleware)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)