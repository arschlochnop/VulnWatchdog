## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者提升权限并可能获取敏感信息

**影响版本:** 受影响版本包括 Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise。

**利用条件:** 攻击者需要能够发送包含特制属性的电子邮件给目标用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。攻击者可以通过发送包含特制 `PidLidReminderFileParameter` 属性的电子邮件，使得 Outlook 在无需用户交互的情况下尝试连接到攻击者控制的 UNC 路径。这导致攻击者可以捕获受害者的 NTLM 哈希。 

**有效性：** 根据搜索结果和漏洞库信息，此漏洞已被广泛利用，且存在公开可用的PoC代码，因此漏洞利用有效性高。

**投毒风险：** 提供的代码主要是一个 Visual Studio 解决方案文件和一个 Apache 2.0 许可文件，以及一个项目文件。虽然许可文件本身不构成风险，但代码中可能存在隐藏的恶意代码。然而，鉴于其整体结构和提供的上下文，直接投毒的可能性相对较低，但也并非完全排除。 因此，推测存在10%的投毒风险，因为下载的解决方案文件可能会包含恶意编译指令或者恶意依赖。

**利用方式：**

1.  **构造恶意邮件：** 攻击者创建一个包含特制`PidLidReminderFileParameter`属性的电子邮件。
2.  **发送邮件：** 攻击者将恶意邮件发送给目标用户。
3.  **触发连接：** 当Outlook处理该邮件时，会自动尝试连接到邮件中指定的UNC路径（攻击者控制的服务器）。
4.  **捕获哈希：** 攻击者利用中间人攻击或其它方式，捕获Outlook连接尝试中泄漏的受害者NTLM哈希。
5.  **权限提升：** 攻击者可以使用捕获的哈希进行NTLM中继攻击或其他攻击，以提升权限。

**项目地址:** [djackreuter/CVE-2023-23397-PoC](https://github.com/djackreuter/CVE-2023-23397-PoC)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)