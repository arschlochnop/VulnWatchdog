## CVE-2023-22527 - Atlassian Confluence 远程代码执行

**漏洞编号:** CVE-2023-22527

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Data Center 和 Server

**危害等级:** 高危，允许未授权的攻击者执行任意代码

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22527 是 Atlassian Confluence Data Center 和 Server 中的一个模板注入漏洞，允许未经身份验证的攻击者执行远程代码。该漏洞源于对用户提供的输入未进行充分的验证和清理，导致攻击者可以注入恶意的 OGNL 表达式。 

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性很高。CISA 已将其添加到已知被利用的漏洞目录中。多个安全研究团队和厂商已经发布了关于该漏洞的分析报告和利用案例，证明了其可利用性。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  该请求被发送到受影响的 Confluence 实例的特定端点（例如，`/template/aui/text-inline.vm`）。
3.  Confluence 服务器在处理请求时，由于模板引擎存在缺陷，会执行攻击者注入的 OGNL 表达式，从而导致远程代码执行。
4.  攻击者可以利用此漏洞在服务器上执行任意命令，例如反弹 shell、读取敏感文件或安装恶意软件。

**投毒风险：**
在提供的漏洞利用代码中，投毒风险较低。代码的主要功能是利用漏洞执行命令。虽然任何代码都有潜在的恶意使用的可能，但该代码本身没有明显的植入后门或其他恶意行为。
经过代码分析，主要的风险是使用者利用该POC进行非授权的渗透测试，从而造成未授权的入侵。作者本身并没有植入后门，进行大范围的漏洞利用，或者信息收集。因此，投毒风险较低，估计在 1% 左右。

**缓解措施：**
1.  尽快升级到不受影响的 Confluence 版本（>= 8.5.4, >= 8.6.0, >= 8.7.1）。
2.  如果无法立即升级，可以采取临时缓解措施，例如禁用受影响的模板引擎功能或限制对 Confluence 实例的访问。

**项目地址:** [yoryio/CVE-2023-22527](https://github.com/yoryio/CVE-2023-22527)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)