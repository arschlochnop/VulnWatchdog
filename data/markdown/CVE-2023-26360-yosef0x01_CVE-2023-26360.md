## CVE-2023-26360 Adobe ColdFusion Improper Access Control Arbitrary code execution

**漏洞编号:** CVE-2023-26360

**漏洞类型:** Improper Access Control

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** CF2018U15及更早版本，CF2021U5及更早版本

**利用条件:** 无需用户交互，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26360是一个Adobe ColdFusion中的不当访问控制漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞利用代码通过构造恶意的HTTP POST请求，指定`_cfclient=true`参数，并使用`_variables`参数传递包含目标文件路径的JSON数据。服务器返回的文件内容会被提取并保存到`output.txt`文件中。

**漏洞利用方式：**

1.  攻击者发送精心构造的HTTP POST请求到`/CFIDE/wizards/common/utils.cfc`端点（或配置的`endpoint`）。
2.  请求中包含`method=test`和`_cfclient=true`参数。
3.  请求的`_variables`参数包含一个JSON对象，该对象包含`_metadata`和`_variables`字段。`_metadata.classname`字段设置为`a/<目标文件路径>`，其中`<目标文件路径>`是攻击者想要读取的文件。
4.  服务器处理该请求，由于访问控制不当，会返回目标文件的内容。
5.  POC代码解析服务器的响应，提取文件内容，并将其保存到`output.txt`文件中。

**投毒风险分析：**

代码本身没有明显的恶意行为，例如执行系统命令或上传文件。它只是读取文件内容并保存到本地文件。然而，风险在于：

*   依赖第三方库 `requests`: 攻击者可能修改 `requirements.txt` 文件，指定存在已知漏洞的 `requests` 版本或其他依赖，诱导用户安装存在后门的版本。
*   `output.txt`：虽然代码本身没有直接的危害，但攻击者可能会在 `README.md` 中误导用户，让他们将包含敏感信息的 `output.txt` 上传到公共平台，从而泄露信息。
*   该仓库中包含`images/Ex.png`等文件，不排除图片中包含恶意代码的可能，但是目前无法通过现有信息确认。

考虑到这些因素，投毒风险评估为10%。主要风险集中在用户错误使用、依赖库的安全风险，以及其他隐藏的攻击方式的可能性。

**有效性评估：**

提供的POC代码基本有效，可以通过不当访问控制漏洞读取服务器上的任意文件。该漏洞已经存在于CISA KEV列表，说明已经存在被利用的案例。

**项目地址:** [yosef0x01/CVE-2023-26360](https://github.com/yosef0x01/CVE-2023-26360)

**漏洞详情:** [CVE-2023-26360](https://nvd.nist.gov/vuln/detail/CVE-2023-26360)