## CVE-2025-23266-NVIDIA Container Toolkit-容器逃逸

**漏洞编号:** CVE-2025-23266

**漏洞类型:** 容器逃逸

**影响应用:** NVIDIA Container Toolkit

**危害等级:** 高危，可能导致权限提升、数据篡改、信息泄露和拒绝服务

**影响版本:** NVIDIA Container Toolkit All versions up to and including 1.17.7 (CDI mode only for versions prior to 1.17.5); NVIDIA GPU Operator All versions up to and including 25.3.0 (CDI mode only for versions prior to 25.3.0)

**利用条件:** 需要目标系统安装存在漏洞版本的NVIDIA Container Toolkit/GPU Operator，并且容器以某种方式加载了恶意的动态链接库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-23266 是 NVIDIA Container Toolkit 中的一个容器逃逸漏洞。根据漏洞描述，该漏洞存在于用于初始化容器的某些 hook 中，攻击者可以利用该漏洞以提升的权限执行任意代码。漏洞利用代码通过 `LD_PRELOAD` 环境变量劫持动态链接库的加载，加载恶意的 `evil.so`。`evil.so` 中的 `loader` 函数会尝试通过 `setns` 进入 PID 1 的网络命名空间，然后反弹 shell 到攻击者的指定 IP 地址和端口。 

**有效性：**
提供的 POC 代码似乎有效。`Dockerfile` 构建了一个包含恶意动态链接库 `evil.so` 的镜像，并通过设置 `LD_PRELOAD` 环境变量来强制加载该库。`evil.go` 中的代码实现了网络命名空间切换和反弹 shell，这是容器逃逸的常见利用方式。

**投毒风险：**
虽然POC的主要功能是实现容器逃逸和反弹shell，但仍存在一定的投毒风险。恶意代码可能伪装成漏洞利用的一部分，执行一些隐蔽的操作，例如收集敏感信息、植入后门等。此处的投毒风险评估较低 (10%)，因为代码相对简单，主要功能集中在利用漏洞本身，但是不能排除隐藏的细微恶意行为。 潜在风险点在于反弹shell的IP和端口设置。如果默认IP更改为其他内网IP，则可能探测内网信息，增加投毒的风险。

**利用方式：**
1.  **构建恶意镜像：** 使用提供的 `Dockerfile` 构建包含 `evil.so` 的镜像。
2.  **运行容器：** 运行该镜像，容器启动时会加载 `evil.so`。
3.  **劫持 hook：** `LD_PRELOAD` 环境变量会强制容器加载 `evil.so`，从而劫持容器初始化过程中的 hook。
4.  **网络命名空间切换：** `evil.so` 中的 `loader` 函数会尝试进入 PID 1 的网络命名空间，实现容器逃逸。
5.  **反弹 Shell：** 成功逃逸后，`loader` 函数会连接到攻击者指定的 IP 地址和端口，反弹一个 shell。

利用过程中需要注意，目标系统需要存在漏洞版本的 NVIDIA Container Toolkit 或 GPU Operator，并且需要能够以某种方式让容器加载这个恶意的动态链接库。 CDI模式对此漏洞的利用起到了至关重要的作用, 但是1.17.5之前的CDI模式以及25.3.0之前的NVIDIA GPU Operator，需要特别注意。

**项目地址:** [r0binak/CVE-2025-23266](https://github.com/r0binak/CVE-2025-23266)

**漏洞详情:** [CVE-2025-23266](https://nvd.nist.gov/vuln/detail/CVE-2025-23266)