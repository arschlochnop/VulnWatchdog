## CVE-2022-27925 - Zimbra Collaboration Suite 目录遍历和远程代码执行

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限（初始评估），但后续研究发现存在认证绕过，降低了利用门槛。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925 存在于 Zimbra Collaboration Suite (ZCS) 的 mboximport 功能中，允许经过身份验证的管理员用户通过上传包含恶意路径的 ZIP 归档文件，实现目录遍历，最终上传任意文件到系统。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果（特别是Volexity的博客），此漏洞已被大规模利用。提供的漏洞利用代码（来自 GitHub 仓库 Josexv1/CVE-2022-27925 和 vnhacker1337/CVE-2022-27925-PoC）提供了利用此漏洞的 POC，并且成功实现了远程代码执行。因此，可以判断此POC代码有效。

**投毒风险分析：**
代码仓库`vnhacker1337/CVE-2022-27925-PoC`提供的利用链比较完整，包含目标枚举，漏洞利用，后渗透利用。从给出的信息看，作者进行了后渗透利用，但这些操作不属于投毒行为。代码中直接包含恶意行为的部分可能性较低，所以投毒风险评估为10%。

**利用方式：**
1.  **认证绕过 (CVE-2022-37042):** 最初需要管理员权限，但后续研究揭示存在认证绕过漏洞（CVE-2022-37042），使得未认证的攻击者也能利用该漏洞，降低了利用门槛。
2.  **上传恶意 ZIP 文件：** 利用 mboximport 功能，上传包含恶意构造路径的 ZIP 归档文件。这些路径指向目标文件系统中的特定位置，以便写入或覆盖文件。
3.  **目录遍历：** ZIP 文件中的恶意路径使得解压过程突破目录限制，导致任意文件写入。
4.  **远程代码执行：** 通过写入 Webshell 或其他可执行文件，最终实现远程代码执行。
5.  **后渗透攻击：** 攻击者可以安装后门、窃取数据，甚至部署勒索软件。

**总结：** 该漏洞利用需要上传特定的ZIP文件，利用Zimbra自身的功能进行目录穿越，最终实现代码执行。从搜索结果来看，该漏洞已被广泛利用。

**项目地址:** [jam620/Zimbra](https://github.com/jam620/Zimbra)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)