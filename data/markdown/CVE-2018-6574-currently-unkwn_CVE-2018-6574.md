## CVE-2018-6574-Golang go get RCE

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程代码执行

**影响应用:** Golang

**危害等级:** 高危，允许攻击者在受害者机器上执行任意命令

**影响版本:** < 1.8.7, 1.9.x < 1.9.4, Go 1.10 pre-releases < Go 1.10rc2

**利用条件:** 目标使用受影响的Golang版本，并且尝试使用`go get`命令获取包含恶意C代码的项目。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2018-6574漏洞允许攻击者通过`go get`命令执行远程代码。该漏洞源于Go语言在构建过程中未正确过滤`-fplugin`和`-plugin`参数，导致可以加载恶意的GCC/Clang插件。攻击者可以构造包含恶意C代码的Go项目，当受害者使用`go get`命令获取该项目时，恶意代码会被编译并执行。

**有效性：**

提供的POC代码有效。`main.go`文件通过`// #cgo CFLAGS: -fplugin=./attack.so`指令指定了要加载的插件`attack.so`。`attack.so`文件（未提供，但推测是恶意payload）会被编译并加载，从而执行恶意代码。

**投毒风险：**

代码仓库中可能存在投毒代码的风险，但从给出的`main.go`和`README.md`内容来看，直接的投毒证据并不明显。`main.go`本身只是加载一个插件，恶意代码应该位于`attack.so`中，而这个文件并没有提供。 投毒风险评估为20%是因为攻击者可以将恶意 payload 隐藏在编译后的 `attack.so` 里, 用户下载后编译并不会感知恶意代码的存在, 存在一定风险。

**利用方式：**

1.  攻击者创建一个包含恶意C代码（编译为`.so`文件）的Go项目。
2.  Go项目的源码中，使用`// #cgo CFLAGS: -fplugin=./attack.so`指令指定要加载的恶意插件。
3.  攻击者将该项目托管在公共代码仓库（如GitHub）上。
4.  受害者使用`go get <attacker_repo>`命令尝试获取该项目。
5.  Go在构建项目时，会加载攻击者指定的恶意插件，从而在受害者机器上执行任意代码。
6.  防御措施包括升级到不受影响的Go版本，或配置Go工具链以禁止加载第三方插件。

**项目地址:** [currently-unkwn/CVE-2018-6574](https://github.com/currently-unkwn/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)