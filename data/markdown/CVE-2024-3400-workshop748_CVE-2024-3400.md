## CVE-2024-3400 PAN-OS GlobalProtect 命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，可导致远程代码执行，获取Root权限

**影响版本:** PAN-OS 10.2, 11.0, and 11.1 (特定版本，见漏洞库信息)

**利用条件:** 需要配置GlobalProtect网关或门户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS GlobalProtect功能中的一个命令注入漏洞。攻击者通过在GlobalProtect的特定配置中利用任意文件创建漏洞，可以执行任意代码并获得防火墙上的root权限。该漏洞影响配置了GlobalProtect网关或门户的PAN-OS 10.2、11.0和11.1的特定版本。根据漏洞库信息，受影响的版本包括低于PAN-OS 10.2.9-h1的10.2.x版本，低于PAN-OS 11.0.4-h1的11.0.x版本，以及低于PAN-OS 11.1.2-h3的11.1.x版本。搜索引擎结果显示，该漏洞已被积极利用，且存在公开的PoC代码。提供的漏洞利用代码是Cargo.lock文件，用于Rust项目的依赖管理。虽然该文件本身不包含恶意代码，但由于该项目可能用于漏洞利用，存在作者在其他地方（例如在实际的Rust源代码中，未提供）加入恶意投毒代码的理论风险，但由于Cargo.lock只是锁定版本，直接投毒难度较大，风险较低。漏洞利用方式包括：未经身份验证的攻击者利用GlobalProtect中的漏洞创建任意文件，进而执行操作系统命令。从Volexity的博客文章(webpage 3)来看，检测受损的Palo Alto Networks防火墙设备的方法，从Zscaler的博客文章(webpage 4)来看，存在upstyle后门的技术分析。因此，漏洞的有效性较高，投毒风险较低。

**漏洞利用方式:**

1.  **未授权访问:** 利用未授权访问漏洞进入系统。
2.  **文件创建:**  利用GlobalProtect功能中的漏洞创建任意文件。
3.  **命令注入:**  通过文件创建，注入恶意操作系统命令。
4.  **Root权限获取:**  成功利用后，攻击者获得防火墙的Root权限。


**项目地址:** [workshop748/CVE-2024-3400](https://github.com/workshop748/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)