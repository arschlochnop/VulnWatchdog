## CVE-2025-48384-Git Config Quoting Vulnerability

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互(克隆恶意仓库或初始化包含恶意配置的子模块)

**POC 可用性:** 部分

**投毒风险:** 10%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理配置引用时存在缺陷，允许攻击者通过精心构造的 Git 仓库或子模块执行任意代码。漏洞的利用方式是：攻击者创建一个恶意仓库，该仓库包含一个带有尾随回车符的子模块路径，并在子模块的 hooks 目录中放置恶意 post-checkout hook。当用户克隆该仓库或初始化包含恶意配置的子模块时，由于 Git 会错误地解析带有尾随回车符的子模块路径，导致子模块被检出到错误的位置。如果该错误位置恰好是一个指向子模块 hooks 目录的符号链接，并且子模块包含一个可执行的 post-checkout hook，则该脚本可能会在检出后被意外执行，从而导致代码执行。 

提供的 POC 代码 `/tmp/4295def0b61cc2e3ec2165152003d4b7/README.md` 看起来只是一个 README 文件，表明该仓库很可能是漏洞的利用示例或者演示。根据文件名`CVE-2025-48384-bad-nginx`推测,该代码仓库可能包含一个用于利用此漏洞的恶意Nginx配置。

**有效性：** 漏洞本身是有效的，因为多个来源都证实了它的存在。然而，仅凭提供的 POC 代码片段 `/tmp/4295def0b61cc2e3ec2165152003d4b7/README.md`无法判断具体的漏洞利用方式和有效性。需要查看完整的仓库内容才能确定其利用方式是否有效。

**投毒风险：** 仅根据提供的 README 文件，无法确定是否存在投毒代码。恶意代码可能隐藏在其他文件中（例如子模块的 hook 脚本或Nginx配置）。根据经验，安全研究人员倾向于展示漏洞利用过程,因此，仓库作者主动投毒的可能性较低，估计投毒风险为 10%。该仓库可能需要配合其他步骤,例如修改Nginx配置或者安装特定的依赖,来达到利用效果，这些步骤中可能包含潜在的风险。

**利用方式：** 攻击者诱导用户克隆包含恶意配置的仓库（带有尾随回车符的子模块路径以及恶意的post-checkout hook),从而触发代码执行。

由于搜索引擎返回了大量的相关信息，表明此漏洞是真实且被广泛关注的。SUSE和RedHat都发布了安全公告，更证明了该漏洞的存在。


**项目地址:** [vinieger/CVE-2025-48384-bad-nginx](https://github.com/vinieger/CVE-2025-48384-bad-nginx)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)