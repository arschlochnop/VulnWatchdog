## CVE-2024-21006 - Oracle WebLogic Server 远程代码执行

**漏洞编号:** CVE-2024-21006

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致未授权访问关键数据或完全访问所有Oracle WebLogic Server可访问的数据。

**影响版本:** 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问 WebLogic Server 的 T3 或 IIOP 端口，且目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21006 是 Oracle WebLogic Server 的一个易于利用的漏洞，允许未经身份验证的攻击者通过 T3 或 IIOP 协议进行网络访问，从而危及 Oracle WebLogic Server。成功利用此漏洞可能导致未经授权访问关键数据或完全访问所有 Oracle WebLogic Server 可访问的数据。根据提供的漏洞利用代码，该漏洞利用了 IIOP 和 JNDI 接口中的不安全使用方式。攻击者可以使用恶意的 JNDI 引用，使 WebLogic Server 连接到攻击者控制的 LDAP 服务器。该 LDAP 服务器可以提供一个恶意的 Java 对象，当 WebLogic Server 反序列化该对象时，会导致在服务器上执行任意代码。

**利用方式：**
1.  攻击者搭建一个恶意的 LDAP 服务器 (例如，使用 JNDIExploit 工具)。
2.  攻击者使用提供的 CVE-2024-21006.jar 工具，指定目标 WebLogic Server 的 IP 地址和端口，以及恶意的 LDAP URL。该工具会向 WebLogic Server 发送一个包含恶意 JNDI 引用的 IIOP 请求。
3.  WebLogic Server 尝试解析 JNDI 引用，连接到攻击者的 LDAP 服务器。
4.  LDAP 服务器返回一个恶意的 Java 对象。
5.  WebLogic Server 反序列化该对象，导致在服务器上执行攻击者指定的任意代码。

**投毒风险分析：**
此仓库看起来是一个PoC，用于演示该漏洞的利用方法。虽然它本身旨在展示漏洞，但也可能被用于恶意目的。代码中存在轻微的投毒风险，这源于用户需要在ExploitBox和Kali中执行一些命令，并且需要配置IP地址等信息，这存在被替换成恶意地址的可能。此外，JNDIExploit工具本身就具有一定的风险，如果从不可信的源下载，可能包含恶意代码，因此，投毒风险评定为10%。

**项目地址:** [d3fudd/CVE-2024-21006_POC](https://github.com/d3fudd/CVE-2024-21006_POC)

**漏洞详情:** [CVE-2024-21006](https://nvd.nist.gov/vuln/detail/CVE-2024-21006)