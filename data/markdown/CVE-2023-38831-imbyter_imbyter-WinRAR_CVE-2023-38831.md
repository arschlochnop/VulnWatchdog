## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 6.23

**利用条件:** 用户使用受影响的WinRAR版本打开特制的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 漏洞存在于WinRAR 6.23之前的版本中。攻击者可以构造一个恶意的ZIP压缩包，其中包含一个伪装成良性文件的文件（例如 .jpg），以及一个同名的文件夹。当用户尝试在 WinRAR 中查看该“良性文件”时，实际上会执行同名文件夹中的恶意代码（例如 .cmd 或 .exe 文件）。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。该POC利用了WinRAR处理ZIP压缩包时存在的逻辑漏洞，能够实现远程代码执行。

**投毒风险：**
提供的Python脚本 `make-poc.py` 用于生成POC压缩包，其本身的代码逻辑相对简单，主要功能是将指定的文件和脚本打包成特定的ZIP格式，并进行一些字符串替换以触发漏洞。主要风险在于脚本生成的POC包中包含的脚本，如果这个脚本是恶意的，那么整个利用过程就存在投毒风险。 仓库中的README.md文件里的测试脚本就是一个关闭计算机的脚本。代码本身存在一定的投毒风险.

*   脚本逻辑：脚本的功能是创建包含漏洞利用结构的RAR文件。
*   恶意操作：如果脚本被修改以包含下载和执行恶意软件的逻辑，那么用户在使用此脚本创建RAR文件时，就会受到投毒攻击。

**利用方式：**
1.  攻击者使用 `make-poc.py` 脚本构造恶意的ZIP压缩包，需要提供一个“良性”文件和一个恶意脚本。
2.  攻击者将恶意的ZIP压缩包发送给受害者。
3.  受害者使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看伪装的“良性”文件。
4.  WinRAR错误地执行了与“良性”文件同名的文件夹中的恶意脚本，导致远程代码执行。

**防御措施：**
*   升级WinRAR到6.23或更高版本。
*   谨慎打开来源不明的ZIP压缩包。
*   使用杀毒软件扫描ZIP压缩包。

**项目地址:** [imbyter/imbyter-WinRAR_CVE-2023-38831](https://github.com/imbyter/imbyter-WinRAR_CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)