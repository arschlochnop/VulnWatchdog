## CVE-2025-46408-EagleEyes Lite Android-不正确的Hostname验证

**漏洞编号:** CVE-2025-46408

**漏洞类型:** 不正确的Hostname验证

**影响应用:** EagleEyes Lite

**危害等级:** 中危，可能导致中间人攻击，拦截或篡改敏感数据

**影响版本:** 2.0.0

**利用条件:** 攻击者需要与目标设备处于同一网络，能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-46408 漏洞存在于 EagleEyes Lite Android 应用程序 2.0.0 版本中。 该应用程序在进行 HTTPS 通信时，不正确地验证服务器的主机名，使用了 `SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER`，禁用主机名验证。这意味着应用程序会接受任何 TLS 证书，即使证书的 Common Name (CN) 或 Subject Alternative Name (SAN) 与请求的主机名不匹配。 

**有效性：**

根据提供的漏洞利用代码，该漏洞的 POC 代码是有效的。 `hook.js` 文件使用 Frida 框架来 Hook `AvtechLib` 类的 `SDK_API_26` 变量和 `GetHttpsResponse` 方法。通过将 `SDK_API_26` 设置为 `false`，强制应用程序执行不安全的 HTTPS 通信逻辑。同时Hook `GetHttpsResponse`方法，从而验证漏洞。

**投毒风险：**

提供的 `hook.js` 脚本的目的是利用漏洞，而非进行投毒。脚本通过 Frida 注入修改应用的行为，验证不安全的 HTTPS 通信，没有发现恶意代码，风险为0%。

**利用方式：**

1.  **环境准备：** 攻击者需要与运行 EagleEyes Lite 应用程序的设备处于同一网络中，并能够拦截和修改网络流量，即能够进行中间人攻击（MITM）。
2.  **安装 Frida：** 在攻击者的设备上安装 Frida 工具。
3.  **运行 Hook 脚本：** 使用 Frida 运行提供的 `hook.js` 脚本，该脚本会 Hook EagleEyes Lite 应用程序，并禁用主机名验证。
4.  **中间人攻击：** 攻击者可以使用工具（例如 Wireshark, Burp Suite, Ettercap）来拦截应用程序与服务器之间的 HTTPS 通信。
5.  **伪造证书：** 攻击者需要生成一个有效的 TLS 证书或者自签名证书，用于冒充合法的服务器。
6.  **拦截和篡改：** 由于应用程序禁用了主机名验证，它会接受攻击者提供的伪造证书，从而允许攻击者拦截和篡改应用程序与服务器之间的敏感数据。

**项目地址:** [shinyColumn/CVE-2025-46408](https://github.com/shinyColumn/CVE-2025-46408)

**漏洞详情:** [CVE-2025-46408](https://nvd.nist.gov/vuln/detail/CVE-2025-46408)