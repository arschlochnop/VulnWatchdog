## CVE-2018-9206 - Blueimp jQuery-File-Upload Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2018-9206

**漏洞类型:** 任意文件上传

**影响应用:** Blueimp jQuery-File-Upload

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.22.0

**利用条件:** 目标系统安装了存在漏洞的Blueimp jQuery-File-Upload组件，且文件上传目录可访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Blueimp jQuery-File-Upload组件未对上传的文件进行充分的验证，导致未经身份验证的攻击者可以上传任意文件，包括恶意脚本，从而可能导致远程代码执行。

**漏洞利用方式：**

1.  **路径探测：** PoC脚本首先尝试探测目标系统上是否存在易受攻击的jQuery File Upload组件的默认安装路径，例如`/server/php/upload.class.php`，`/example/upload.php`等，脚本中定义了多个常见的路径。
2.  **Webshell 上传：** 如果找到可用的上传路径，PoC脚本会尝试上传一个webshell（名为`shell.php`），其中包含简单的PHP代码，允许通过`cmd`参数执行系统命令。
3.  **Webshell 探测与命令执行：** 脚本然后尝试访问上传的webshell，并通过`cmd`参数执行`id`命令，验证是否成功上传并执行了webshell。

**有效性：**

提供的PoC代码是有效的，它利用了未授权的文件上传漏洞，通过上传webshell来执行任意命令。

**投毒风险：**

PoC代码中没有发现明显的恶意代码或后门，主要功能是利用漏洞上传和执行webshell。代码片段主要用于验证漏洞的存在和执行效果,因此投毒风险很低. 代码结构清晰，功能明确，主要是为了验证漏洞而编写，而不是为了进行恶意攻击. 虽然webshell本身是恶意的，但它是PoC的一部分，用于验证漏洞利用。

综合分析，投毒风险为0%。

**项目地址:** [Den1al/CVE-2018-9206](https://github.com/Den1al/CVE-2018-9206)

**漏洞详情:** [CVE-2018-9206](https://nvd.nist.gov/vuln/detail/CVE-2018-9206)