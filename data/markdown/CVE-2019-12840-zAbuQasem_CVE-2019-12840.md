## CVE-2019-12840 Webmin 1.910 'Package Updates' 远程命令执行

**漏洞编号:** CVE-2019-12840

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.910

**利用条件:** 需要Webmin用户权限，且该用户拥有 'Package Updates' 模块的访问权限，能访问Webmin服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-12840 漏洞存在于 Webmin 1.910 及更早版本中。任何具有 "Package Updates" 模块访问权限的用户都可以通过向 update.cgi 脚本的 data 参数发送恶意请求，以 root 权限执行任意命令。

**有效性：**
根据漏洞信息、搜索引擎结果和提供的 POC 代码，该漏洞是有效的。搜索引擎结果中 exploit-db 和其他安全站点均已收录该漏洞，并提供了相应的利用方式。

**投毒风险：**
提供的 POC 代码本身主要是利用漏洞进行反弹 shell。代码中存在可疑的代理配置， `proxies={'https':'http://127.0.0.1:8080'}`，如果攻击者将恶意代码注入到利用脚本中，例如修改反弹 shell 的 IP 地址或端口，或者添加额外的命令执行，则可能存在投毒风险，但是从代码本身来看，投毒风险较低，主要集中在使用者如果使用了一些不安全的代理或者下载源不明的脚本，导致payload被篡改，才会产生投毒行为。因此判定投毒风险为1%。

**利用方式：**
1.  攻击者需要具有 Webmin 的有效用户名和密码，并且该用户需要拥有 "Package Updates" 模块的访问权限。
2.  攻击者使用提供的 exploit.py 脚本，输入目标 Webmin 的 URL、有效的 sid cookie、用户名、密码、攻击者用于接收反弹 shell 的 IP 地址和端口。
3.  脚本首先尝试登录 Webmin。
4.  如果登录成功，脚本会构造一个包含恶意命令的 payload，该 payload 会使用 base64 编码，然后通过 POST 请求发送到 /package-updates/update.cgi 脚本。
5.  Webmin 服务器执行 payload 中的命令，从而导致攻击者获得服务器的 root 权限 shell。

**项目地址:** [zAbuQasem/CVE-2019-12840](https://github.com/zAbuQasem/CVE-2019-12840)

**漏洞详情:** [CVE-2019-12840](https://nvd.nist.gov/vuln/detail/CVE-2019-12840)