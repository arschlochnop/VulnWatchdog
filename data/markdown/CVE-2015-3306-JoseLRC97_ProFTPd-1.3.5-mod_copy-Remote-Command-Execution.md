## CVE-2015-3306 ProFTPD mod_copy 文件读写漏洞

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行ProFTPD 1.3.5，且开启mod_copy模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。根据漏洞库信息和搜索引擎结果，该漏洞允许远程攻击者在未经授权的情况下访问服务器上的文件系统，可能导致敏感信息泄露，甚至通过写入恶意代码实现远程代码执行。

**有效性：**
根据搜索结果和漏洞库信息，存在多个可用的Exploit-DB 和 Metasploit 模块，证明该漏洞是可利用的。

**投毒风险：**
提供的代码片段是 GNU GPL 许可证，与漏洞利用代码无关，无法判断是否存在投毒风险。但是从漏洞利用本身来看，如果攻击者成功利用该漏洞写入文件，存在植入恶意代码的可能。 此处判断poc代码的投毒风险为0%，因为提供的是LICENSE文件,不是漏洞验证的后门代码,如果提供的是漏洞验证后门代码,则不判定为投毒代码。

**利用方式：**
1.  攻击者首先需要连接到目标 ProFTPD 服务器。
2.  利用 `SITE CPFR` 命令指定源文件路径，可以是任意文件。
3.  利用 `SITE CPTO` 命令指定目标文件路径，也可以是任意文件。
4.  服务器会尝试将源文件复制到目标文件，如果攻击者能够控制源文件或目标文件路径，则可以读取或写入任意文件。 例如，攻击者可以读取 `/etc/passwd` 文件来获取系统用户信息，或者将恶意 PHP 代码写入 Web 服务器的目录中以执行任意命令。

**项目地址:** [JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution](https://github.com/JoseLRC97/ProFTPd-1.3.5-mod_copy-Remote-Command-Execution)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)