## CVE-2023-45866 - BlueZ Bluetooth HID 注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** bluez 5.64-0ubuntu1 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备开启蓝牙且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许未经验证的攻击者通过伪装成蓝牙HID设备，在受害者设备上注入键盘输入。利用方式如下：

1.  攻击者使用特定的蓝牙HID设备（如伪造的键盘）发起连接。
2.  由于BlueZ在某些版本中未正确处理身份验证，攻击者可以绕过配对流程，建立加密连接。
3.  攻击者随后可以发送恶意HID报告，模拟键盘输入。
4.  通过模拟按键，攻击者可以执行任意命令，如打开终端、下载恶意软件等。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且存在公开可用的POC。因此，漏洞利用具有有效性。

**投毒风险评估：**

查看提供的漏洞利用代码（blueXploit），发现代码主要功能是利用CVE-2023-45866漏洞进行蓝牙HID注入攻击。代码包含自动生成payload并注入到APK的功能，存在一定的风险，但更多是利用msfvenom等工具生成payload, **所以判断投毒概率较低,大约为5%。**

**利用方式分析：**

blueXploit利用工具：

1.  **模拟HID设备：** 代码可能使用Linux的蓝牙工具（如`bluez-tools`）来模拟HID设备，使其能够发送键盘和鼠标事件。
2.  **绕过认证：** 漏洞的核心在于绕过蓝牙HID的认证机制。POC代码会尝试建立未认证的连接，或者利用已知的漏洞来欺骗目标设备。
3.  **Payload注入：** 成功建立连接后，POC代码会注入预先定义的payload，这些payload通常包含一系列键盘指令，用于在目标设备上执行命令。利用APK的组件，可能导致恶意软件安装或其他恶意行为。

**结论：**

CVE-2023-45866是一个严重的安全漏洞，允许未经授权的攻击者通过蓝牙注入键盘输入，从而控制受害者设备。提供的POC代码可以有效利用该漏洞。存在少许投毒风险但主要集中在自动化payload生成和注入方面，需要谨慎使用。攻击者需要具备一定的蓝牙协议和Linux系统知识才能成功利用该漏洞。

**项目地址:** [Danyw24/blueXploit](https://github.com/Danyw24/blueXploit)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)