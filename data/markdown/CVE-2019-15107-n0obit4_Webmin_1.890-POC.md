## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 目标Webmin服务器开启了允许修改过期密码的功能（Webmin -> Webmin Configuration -> Authentication -> Allow changing of expired passwords）。 根据代码，1.890默认存在后门，无需此条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-15107存在于Webmin <= 1.920的password_change.cgi中。该漏洞允许未经身份验证的攻击者通过`old`参数或`expired`参数进行命令注入。提供的POC代码 `Webmin_exploit.py` 针对的是1.890版本，利用了默认存在的后门，对于更高版本 (1.900 - 1.920)，需要目标服务器开启特定的认证配置，即允许修改过期密码，才能利用。漏洞利用方式是构造包含恶意命令的HTTP POST请求到password_change.cgi端点。 

**有效性：**
根据漏洞信息和搜索结果，该漏洞是有效的，并且存在可用的POC代码。POC代码利用了 `password_change.cgi` 脚本中的命令注入漏洞，允许攻击者执行任意系统命令。

**投毒风险：**
代码仓库中的投毒风险较低。主要风险在于该代码可能被滥用以攻击未打补丁的Webmin服务器。仔细检查了 `Webmin_exploit.py` 脚本，没有发现明显的恶意代码或后门。LICENSE文件符合MIT许可协议，这通常意味着代码是开源的，并且作者声明不对因使用该代码造成的任何损害负责。README.md中提示了所需的依赖库，这些库本身比较常用。存在的风险在于脚本的作者可能故意留下一些不明显的缺陷或漏洞，为自己保留一定的利用能力，但是无法确定，只能根据代码特征做出预判，初步判断风险较低。

**利用方式：**
1.  攻击者构造一个包含恶意命令的HTTP POST请求，将请求发送到Webmin服务器的`password_change.cgi`端点。
2.  恶意命令嵌入在POST请求的`old`参数或`expired`参数中。
3.  Webmin服务器在处理`password_change.cgi`请求时，没有对`old`参数或`expired`参数进行充分的过滤和转义，导致命令注入。
4.  服务器执行攻击者注入的命令，从而允许攻击者控制服务器。

**项目地址:** [n0obit4/Webmin_1.890-POC](https://github.com/n0obit4/Webmin_1.890-POC)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)