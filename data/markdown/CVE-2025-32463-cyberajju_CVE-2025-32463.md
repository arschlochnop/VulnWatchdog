## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要存在sudo chroot的错误配置，允许用户控制的/etc/nsswitch.conf文件被使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞允许本地用户通过滥用`sudo chroot`命令提升权限至 root。该漏洞利用的核心在于 `sudo` 在使用 `--chroot` 选项时，会使用用户可控目录下的 `/etc/nsswitch.conf` 文件。`nsswitch.conf` 文件用于配置名称服务查找的顺序，如果攻击者能够控制此文件，则可以劫持名称服务查找过程，例如指向恶意库文件，从而执行任意代码。提供的POC代码描述了利用步骤：首先识别存在错误配置的 `sudo chroot` 权限，然后执行 chroot 环境逃逸技术，最终获得 root 权限。POC 描述中提及了无需 gcc 编译即可利用，这增加了漏洞利用的便利性。该漏洞的缓解措施包括限制 `sudo chroot` 权限以及监控和审计 sudoers 配置。

**有效性评估：** 根据漏洞描述和POC代码信息，该漏洞是有效的，允许本地用户提权。

**投毒风险评估：** POC 代码（README.md）本身只包含了漏洞的描述和利用步骤，以及一些 GIF 图片，没有发现明显的恶意代码。但是，提供的github链接指向的仓库cyberajju/CVE-2025-32463可能存在投毒风险，因为其包含完整的利用链，恶意作者可能在其中隐藏恶意代码。虽然 README.md 文件中没有直接的投毒行为，但是利用过程依赖外部资源（github仓库）。因此，这里给出一个较低的投毒风险评估。

**利用方式：**
1.  寻找存在漏洞版本的Sudo。
2.  确定目标系统上存在允许用户使用 `--chroot` 选项的 `sudo` 配置。
3.  构造一个恶意的 `/etc/nsswitch.conf` 文件，该文件会将名称服务查找导向攻击者控制的恶意库文件。
4.  使用 `sudo chroot` 命令并指定用户控制的目录，触发漏洞。
5.  执行恶意代码，获得 root 权限。

**项目地址:** [cyberajju/CVE-2025-32463](https://github.com/cyberajju/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)