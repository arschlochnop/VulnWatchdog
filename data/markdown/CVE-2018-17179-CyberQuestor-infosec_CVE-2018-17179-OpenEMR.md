## CVE-2018-17179-OpenEMR-SQL注入

**漏洞编号:** CVE-2018-17179

**漏洞类型:** SQL注入

**影响应用:** OpenEMR

**危害等级:** 高危，可导致数据库信息泄露甚至远程代码执行

**影响版本:** < 5.0.1 Patch 7

**利用条件:** 需要OpenEMR的web访问，以及有效的用户名和密码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-17179 是 OpenEMR 5.0.1 Patch 7 之前版本中 `interface/forms/eye_mag/php/taskman_functions.php` 文件的 `make_task` 函数存在的一个 SQL 注入漏洞。此漏洞通过 `interface/forms/eye_mag/taskman.php` 触发。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞是真实存在的，并且有公开的利用代码(POC)。Metasploit也有相关的辅助模块。

根据提供的漏洞利用代码，该脚本通过以下步骤利用漏洞：

1.  **身份验证：** 首先，脚本使用提供的用户名和密码尝试登录到 OpenEMR 系统。
2.  **构造恶意请求：** 成功登录后，脚本构造一个包含恶意 SQL 注入代码的 HTTP 请求，并发送到存在漏洞的 `/interface/forms/eye_mag/taskman.php` 接口的`make_task`函数。
3.  **远程代码执行：** 通过 SQL 注入，攻击者可以在数据库服务器上执行任意 SQL 命令，甚至可以利用 SQL 注入来执行操作系统命令（如果数据库配置允许）。

**投毒风险：**

检查提供的 exploit.py 代码，没有发现明显的恶意代码，比如：

*   **额外的网络请求：** 代码没有向任何未知的外部服务器发送数据。
*   **文件系统修改：** 除了利用漏洞之外，代码没有尝试修改服务器上的任何文件（除了可能通过 SQL 注入修改数据库内容）。
*   **隐蔽的后门：** 代码逻辑清晰，没有发现任何隐藏的后门功能。

因此，可以认为此仓库中作者隐藏的投毒代码的可能性很低，判断投毒风险为0%。

**利用方式：**

1.  **前提条件：** 需要一个可访问的 OpenEMR 实例，版本低于 5.0.1 Patch 7，以及一个有效的用户凭据。
2.  **漏洞利用：** 运行提供的 Python 脚本 `exploit.py`，并提供目标 OpenEMR 的 URL、用户名、密码以及要执行的命令。
3.  **结果：** 如果漏洞利用成功，攻击者将在 OpenEMR 服务器上执行指定的命令。在提供的例子中，命令是启动一个反向 shell，使攻击者能够远程访问服务器。

**项目地址:** [CyberQuestor-infosec/CVE-2018-17179-OpenEMR](https://github.com/CyberQuestor-infosec/CVE-2018-17179-OpenEMR)

**漏洞详情:** [CVE-2018-17179](https://nvd.nist.gov/vuln/detail/CVE-2018-17179)