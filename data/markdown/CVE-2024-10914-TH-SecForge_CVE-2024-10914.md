## CVE-2024-10914 - D-Link account_mgr.cgi OS 命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS 命令注入

**影响应用:** D-Link DNS-320/DNS-320LW/DNS-325/DNS-340L

**危害等级:** 高危，可远程执行任意命令

**影响版本:** <= 20241028

**利用条件:** 目标设备开启web服务，且可网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10914 是 D-Link DNS-320、DNS-320LW、DNS-325 和 DNS-340L NAS 设备中发现的一个关键漏洞，允许未经身份验证的远程攻击者通过 `account_mgr.cgi` 接口中的 `name` 参数执行操作系统命令注入。该漏洞利用的有效性较高，因为漏洞信息和POC代码已经公开，并且有证据表明攻击者在地下论坛分享和讨论该漏洞的利用方式。根据提供的漏洞利用代码，该POC利用方式为通过构造特殊的 `name` 参数，将恶意命令注入到 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 接口中，从而实现远程代码执行。 

**投毒风险分析：** 漏洞利用代码包含一个 `requirements.txt` 文件，需要安装 `requests`、`alive-progress`、`prompt_toolkit` 和 `argparse` 依赖。虽然这些依赖本身是常见的Python库，但攻击者可能通过修改这些依赖的安装源，或者在安装过程中执行恶意代码，从而实现投毒。例如，通过PyPI劫持等手段，替换官方库为恶意库。 同时该代码仓库是一个新的仓库,代码量不多,作者信息也较少,存在一定的投毒的可能性. 综合评估，认为该代码存在大约 5% 的投毒风险。主要是需要用户手动安装依赖，攻击者可能在依赖上做手脚，存在安全风险。建议在使用前进行代码审计和依赖校验。

**项目地址:** [TH-SecForge/CVE-2024-10914](https://github.com/TH-SecForge/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)