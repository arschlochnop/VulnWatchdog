## CVE-2024-2961

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃、覆盖相邻变量甚至远程代码执行。

**影响版本:** < 2.40

**利用条件:** 目标系统使用glibc版本低于2.40，并且程序调用了iconv()函数进行字符集转换，特别是转换到ISO-2022-CN-EXT字符集。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-2961是glibc库中iconv()函数存在的一个缓冲区溢出漏洞。当使用iconv()函数将字符串转换为ISO-2022-CN-EXT字符集时，如果输出缓冲区过小，可能发生最多4个字节的溢出。

**有效性：** 根据漏洞库信息、搜索结果和提供的POC代码，此漏洞被认为是有效的。漏洞库和搜索结果中都明确指出iconv()函数在特定条件下会发生缓冲区溢出。提供的POC代码尝试触发该漏洞，通过将字符串转换为ISO-2022-CN-EXT字符集来测试溢出。

**投毒风险：** 提供的代码仓库中没有发现明显的投毒迹象。`README.md`文件描述了漏洞的利用方法，并提供了编译和运行POC的步骤。`test_iconv.c`文件是简单的C代码，用于调用iconv()函数并尝试触发漏洞。代码本身没有包含任何恶意或隐藏的功能。因此，投毒风险评估为0%。

**利用方式：**

1.  **触发漏洞：** 攻击者需要控制iconv()函数的输入和输出缓冲区，并且指定目标字符集为ISO-2022-CN-EXT。攻击者需要输入精心构造的字符串。
2.  **溢出利用：** 由于溢出只有4个字节，通常无法直接实现任意代码执行。然而，结合其他技术（例如堆利用）可能能够利用此漏洞来覆盖关键数据结构，例如堆元数据或者函数指针。
3.  **远程代码执行(RCE)：**  根据搜索结果，特别是RedHat的描述，该漏洞可能允许攻击者通过构造恶意字符序列触发越界写入并执行远程代码。Ambionics的文章也深入探讨了利用此漏洞实现RCE的可能性，特别是在PHP环境中，通过修改free list 指针，从而实现任意写。

**总结：**

CVE-2024-2961是一个缓冲区溢出漏洞，虽然溢出量较小，但结合其他技术，攻击者可以利用此漏洞实现程序崩溃，变量覆盖，甚至远程代码执行。提供的POC代码验证了该漏洞的存在，代码本身没有发现投毒风险。

**项目地址:** [exfil0/test_iconv](https://github.com/exfil0/test_iconv)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)