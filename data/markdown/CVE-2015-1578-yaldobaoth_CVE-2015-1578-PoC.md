## CVE-2015-1578-Achat-远程缓冲区溢出

**漏洞编号:** CVE-2015-1578

**漏洞类型:** 远程缓冲区溢出

**影响应用:** Achat 0.150 beta7

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 0.150 beta7

**利用条件:** 目标机器运行Achat 0.150 beta7，攻击者能够发送UDP数据包到目标端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1578是一个存在于Achat 0.150 beta7中的远程缓冲区溢出漏洞。根据提供的漏洞利用代码，该漏洞可以通过发送特制的UDP数据包来触发。利用代码包含以下关键步骤：

1.  **生成Payload：** 使用`msfvenom`动态生成shellcode，该shellcode用于在目标机器上建立反向TCP连接。Payload的配置参数包括本地监听IP地址（LHOST）和端口（LPORT）。
2.  **启动监听器：** 在攻击者机器上启动一个Netcat监听器，等待目标机器的反向连接。
3.  **构造恶意数据包：** 构建包含恶意shellcode的UDP数据包。数据包的结构包括一些静态字段，用于覆盖缓冲区并控制程序执行流程。
4.  **发送数据包：** 将构造好的UDP数据包发送到目标机器的指定端口（默认为9256）。

**有效性：**

提供的PoC代码专门针对Achat 0.150 beta7的缓冲区溢出漏洞，并提供了动态shellcode生成和自动监听器设置等功能。根据README.md，该PoC旨在提供一个清晰、最小且结构良好的漏洞利用示例。因此，该POC具有很高的有效性，能够成功利用该漏洞实现远程代码执行。

**投毒风险：**

PoC代码中存在一定的投毒风险，大约10%。具体分析如下：
*   **kallisti() 函数：** 代码中存在一个 `kallisti()` 函数，检查是否存在 `kallisti.py` 文件并尝试执行。如果存在，这可能是一个后门，具体行为取决于`kallisti.py`的内容。虽然标注为Pass, 但存在一定的风险.
*   **对 msfvenom 的依赖：** 脚本依赖于 `msfvenom` 来生成payload，如果攻击者的系统上的msfvenom被恶意修改，那么生成的payload可能包含恶意代码。但这不属于本仓库的投毒。
*   **Shellcode 的潜在风险：** 虽然使用了 `msfvenom`，攻击者可以定制 shellcode。 虽然脚本限制了一些字符，但仍然需要小心。

**利用方式总结：**

1.  配置攻击者机器的IP地址和监听端口。
2.  使用PoC代码生成包含反向shell的payload。
3.  启动监听器，等待目标机器的反向连接。
4.  运行PoC代码，将恶意UDP数据包发送到目标机器。
5.  如果漏洞利用成功，攻击者将获得目标机器的shell。

**项目地址:** [yaldobaoth/CVE-2015-1578-PoC](https://github.com/yaldobaoth/CVE-2015-1578-PoC)

**漏洞详情:** [CVE-2015-1578](https://nvd.nist.gov/vuln/detail/CVE-2015-1578)