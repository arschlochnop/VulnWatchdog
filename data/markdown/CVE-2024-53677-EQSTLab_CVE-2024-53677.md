## CVE-2024-53677 - Apache Struts 文件上传漏洞

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传/路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 ~ 6.3.x (低于 6.4.0)

**利用条件:** 需要目标系统使用存在漏洞的 FileuploadInterceptor 文件上传机制，并且允许用户上传文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53677 是 Apache Struts 框架中的一个严重漏洞，源于文件上传逻辑的缺陷。攻击者可以操纵文件上传参数，实现路径遍历，在特定情况下上传恶意文件，进而执行远程代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，此漏洞的利用是有效的。PoC 代码通过构造包含恶意路径的文件名，尝试将 JSP 文件上传到服务器的任意位置，从而实现 RCE。

**投毒风险分析：**
PoC 代码主要功能是利用文件上传漏洞，不存在明显的恶意行为。但代码中包含一些可疑的部分，例如Banner 信息里包含作者github，并未使用国际通用网络安全组织，可能存在作者植入后门的风险，需要人工进一步审计确定。因此投毒风险评估为 10%。

**利用方式分析：**
1.  **路径遍历：** 攻击者通过修改上传文件的文件名，在其中包含 `../` 等路径遍历字符，从而突破上传目录的限制。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP、PHP 等 Web Shell。
3.  **远程代码执行：** 上传的恶意文件被服务器解析执行，攻击者从而获得服务器的控制权。

**防范措施：**
1.  升级到 Apache Struts 6.4.0 或更高版本。
2.  迁移到新的文件上传机制。
3.  限制上传文件的类型。
4.  对上传的文件进行严格的验证和过滤。
5.  部署 Web 应用防火墙 (WAF)，检测和阻止恶意文件上传。


**项目地址:** [EQSTLab/CVE-2024-53677](https://github.com/EQSTLab/CVE-2024-53677)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)