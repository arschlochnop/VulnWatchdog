## CVE-2022-30190 - Microsoft MSDT 远程代码执行

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要用户打开恶意文档（例如Word文档）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中。攻击者可以利用该漏洞通过调用应用程序(例如Microsoft Word)以URL协议的方式执行任意代码。攻击者通常会创建一个恶意的Word文档，该文档利用Word的远程模板功能从远程Web服务器检索一个HTML文件，该HTML文件包含恶意代码，从而触发MSDT执行任意命令。

**有效性:**
根据搜索结果，该漏洞是真实存在的，并且已被积极利用。漏洞库信息和搜索结果都确认了其存在和影响。

**投毒风险:**
提供的POC代码 `/tmp/64676d48ed786b898eab15332ce05bd0/README.md`  仅仅包含一个README.md文件，其中写着“Hello this is where we will conduct nefarious activities”。
这本身不是利用代码，而只是一个占位符。
因此，直接从这个`README.md`文件判断投毒是不可能的。该仓库如果包含其他恶意利用载荷则具有投毒可能。
投毒风险评估为10%，因为无法直接从提供的代码判断是否存在恶意代码，但说明该仓库可能用于恶意目的。

**利用方式:**
1.  攻击者创建一个包含恶意链接或嵌入对象的文档（例如Word文档）。
2.  当受害者打开该文档时，MSDT通过URL协议被调用。
3.  MSDT执行攻击者指定的恶意代码，从而导致远程代码执行。
4.  攻击者可以利用此漏洞安装程序，查看、更改或删除数据，或创建新帐户，具体取决于用户的权限。

**项目地址:** [mattjmillner/CVE-Smackdown](https://github.com/mattjmillner/CVE-Smackdown)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)