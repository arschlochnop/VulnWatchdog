## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <=1.920

**利用条件:** 需要网络访问Webmin服务，且目标版本在漏洞影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-15107 是一个存在于 Webmin 1.920 及更早版本中的命令注入漏洞。该漏洞位于 `password_change.cgi` 文件的 `old` 参数中。攻击者可以通过在 `old` 参数中注入恶意命令，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC利用代码。多个安全厂商和研究人员都确认了该漏洞的存在和危害。提供的扫描器代码主要用于检测漏洞是否存在，可以辅助进行验证。

**投毒风险：**

提供的代码包括一个漏洞扫描器 (`detect_webmin_cve_2019_15107.py`) 和一个 README 文件，以及 requirements.txt。扫描器代码的目的是检测目标 Webmin 服务器是否易受 CVE-2019-15107 攻击，它通过检查 Webmin 的版本来实现。它首先尝试从 HTTP 头部获取 Webmin 版本信息，如果头部信息不可用，则尝试从 HTML 页面中提取。然后，它将提取的版本与易受攻击的版本范围 (1.882 - 1.920) 进行比较。

分析后，没有发现明显的恶意代码。但是，任何代码库都存在潜在的风险。以下是评估：

*   **正面：** 代码较为简单，易于阅读和理解。只执行版本检测，没有尝试任何利用行为。
*   **负面：** 如果攻击者修改此扫描器，例如，添加一个后门，然后诱骗用户运行它，则可能存在投毒风险。此外，即使是无害的代码，也可能存在意外的错误，导致拒绝服务或其他问题。

鉴于以上分析，投毒风险较低，估计为 5%。主要是担心有人恶意修改代码后传播。

**利用方式：**

1.  攻击者向 `password_change.cgi` 发送包含恶意命令的请求，该命令注入到 `old` 参数中。
2.  Webmin 在处理 `password_change.cgi` 时，没有正确地过滤 `old` 参数，导致注入的命令被执行。
3.  攻击者利用此漏洞在服务器上执行任意代码，从而获得对系统的控制权。攻击者可以通过此漏洞安装恶意软件、窃取敏感数据或执行其他恶意操作。


**项目地址:** [EdouardosStav/CVE-2019-15107-RCE-WebMin](https://github.com/EdouardosStav/CVE-2019-15107-RCE-WebMin)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)