## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了Next.js中间件进行权限校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js中间件中存在的权限绕过漏洞。如果应用程序在中间件中执行授权检查，则攻击者可以通过发送包含`x-middleware-subrequest`头的特制HTTP请求来绕过这些检查。 

**有效性：**
根据漏洞描述和提供的POC代码，该漏洞是有效的。POC给出了重现步骤，包括安装依赖、启动开发服务器，然后使用curl命令发送带有特定`x-middleware-subrequest`头的请求到受保护的路由`/protected`。

**投毒风险：**
分析POC代码，主要包含`README.md`、`next.config.ts`、`package-lock.json`、`package.json`以及pages目录下的路由文件。代码结构简单，主要是Next.js项目的基础配置和路由定义。主要的风险在于安装依赖时可能引入恶意包。但直接在当前仓库的代码中发现明显恶意代码的可能性较低。风险评估：10%（低）。

**利用方式：**
1.  目标应用使用存在漏洞的Next.js版本，且使用了中间件进行权限校验。
2.  攻击者构造带有`x-middleware-subrequest`头的HTTP请求。
3.  当请求到达Next.js应用时，中间件的权限校验逻辑被绕过，攻击者可以访问原本需要授权才能访问的资源。

**项目地址:** [yuzu-juice/CVE-2025-29927_demo](https://github.com/yuzu-juice/CVE-2025-29927_demo)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)