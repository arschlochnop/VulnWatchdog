## CVE-2007-2447-Samba-远程命令注入

**漏洞编号:** CVE-2007-2447

**漏洞类型:** 远程命令注入

**影响应用:** Samba

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.0.0 through 3.0.25rc3

**利用条件:** 需要启用 "username map script" smb.conf 选项，或可以通过 MS-RPC 的其他功能（远程打印、文件共享管理）进行利用,需要能够访问Samba服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2007-2447 存在于 Samba 3.0.0 到 3.0.25rc3 版本中。漏洞原因是 smbd 的 MS-RPC 功能允许远程攻击者通过 shell 元字符执行任意命令。

*   **有效性：** 提供的 POC 代码（README.md）描述了漏洞，并确认可以通过指定包含 shell 元字符的 Samba 用户名来执行任意命令。搜索结果也表明存在公开可利用的漏洞。因此，该漏洞是有效的。
*   **投毒风险：** 提供的 POC 代码只是一个 README 文件，描述了漏洞。其中几乎不包含任何可执行代码，因此投毒风险较低，但依然存在作者加入恶意链接或者其他隐蔽方式进行攻击的可能性，因此评估为10%。
*   **利用方式：** 攻击者可以通过以下几种方式利用该漏洞：
    1.  当 "username map script" smb.conf 选项启用时，利用 `SamrChangePassword` 函数注入 shell 元字符。
    2.  利用 MS-RPC 的其他功能，例如远程打印和文件共享管理，注入 shell 元字符。
    攻击者通过构造包含恶意 shell 元字符的用户名，传递给存在漏洞的 MS-RPC 函数，导致服务器执行任意命令。

**项目地址:** [JoseBarrios/CVE-2007-2447](https://github.com/JoseBarrios/CVE-2007-2447)

**漏洞详情:** [CVE-2007-2447](https://nvd.nist.gov/vuln/detail/CVE-2007-2447)