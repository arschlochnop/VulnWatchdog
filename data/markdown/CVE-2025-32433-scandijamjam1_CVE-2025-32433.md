## CVE-2025-32433-Erlang/OTP SSH Pre-Authentication RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Erlang/OTP

**危害等级:** 高危，未经身份验证即可执行远程代码

**影响版本:** OTP-27.0-rc1 < OTP-27.3.3, OTP-26.0-rc1 < OTP-26.2.5.11, < OTP-25.3.2.20

**利用条件:** 目标系统运行存在漏洞的Erlang/OTP SSH服务，且攻击者可以网络访问该服务端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32433 存在于 Erlang/OTP SSH 服务中，允许未经身份验证的攻击者执行远程代码。漏洞源于 SSH 协议消息处理中的缺陷，攻击者可以在身份验证之前发送特制的 SSH 消息来利用此漏洞。根据搜索引擎的结果，此漏洞已被观察到在野外被利用。提供的Python POC 代码通过以下步骤利用漏洞：

1.  **建立连接:** 与目标 SSH 服务器建立 TCP 连接。
2.  **Banner 交换:** 模拟 SSH banner 交换。
3.  **发送 SSH_MSG_KEXINIT:**  发送一个包含密钥交换算法信息的 SSH_MSG_KEXINIT 数据包。
4.  **发送 SSH_MSG_CHANNEL_OPEN:** 发送一个打开 SSH 通道的请求。
5.  **发送 SSH_MSG_CHANNEL_REQUEST:**  在身份验证之前，发送一个包含要执行的命令的 SSH_MSG_CHANNEL_REQUEST 数据包。此数据包中的命令`file:write_file("/lab.txt", <<"pwned">>).`指示 Erlang 虚拟机将 "pwned" 写入 `/lab.txt` 文件。

**有效性评估:** 根据漏洞描述和POC代码，以及搜索结果中提到该漏洞已被实际利用，此POC代码很可能有效。

**投毒风险评估:** Dockerfile用于构建存在漏洞的环境，ssh_server.erl很可能用来启动存在漏洞的erlang服务。POC代码本身的目的就是执行任意命令，实现RCE。虽然存在修改命令执行其他操作的可能性,但是此代码库作为漏洞验证本身存在用途，且未发现明显的恶意行为或者隐藏后门，因此认为投毒风险较低。存在微小的投毒风险的可能性是由于：
* Dockerfile可能存在一些不必要的依赖或者配置，虽然目前看起来无害，但是未来可能被利用。
* POC中执行的命令虽然是写入文件，但可能被修改为更具破坏性的操作。

总的来说，投毒的概率很小，约为5%。

**利用方式总结:**  攻击者利用漏洞的关键在于在身份验证之前发送恶意的 SSH_MSG_CHANNEL_REQUEST 数据包，从而绕过身份验证并执行任意命令。

**项目地址:** [scandijamjam1/CVE-2025-32433](https://github.com/scandijamjam1/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)