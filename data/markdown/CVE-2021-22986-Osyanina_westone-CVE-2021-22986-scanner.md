## CVE-2021-22986-F5 BIG-IP iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未授权远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统开启并暴露iControl REST接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经身份验证的远程命令执行漏洞。漏洞存在于受影响版本的 iControl REST 接口中，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意系统命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开的 PoC。虽然提供的漏洞利用代码 `/tmp/787246e6ce6e87a4ad488e0e4cce542c/README.md` 看起来只是一个扫描器或者一个占位符，但它表明已经有人在研究并分享关于这个漏洞的利用方法。

**投毒风险：**
提供的代码片段 `README.md` 文件本身不包含可执行代码，因此直接投毒的可能性较低。 但是，考虑到漏洞已经被公开，攻击者可能会创建恶意模块或脚本，伪装成漏洞利用工具，但实际上执行恶意操作。例如，某些PoC中可能包含下载恶意payload执行的操作。因为缺乏代码分析，这里假设有10%的可能性是作者隐藏了投毒代码。

**利用方式：**
1.  **未授权访问:** 攻击者无需身份验证即可访问 iControl REST 接口。
2.  **构造恶意请求:**  攻击者构造包含恶意命令的 HTTP 请求，通常利用 Server-Side Request Forgery (SSRF) 或直接命令注入绕过认证执行命令。
3.  **命令执行:**  BIG-IP/BIG-IQ 系统在收到恶意请求后，执行其中的命令，导致远程代码执行。

**总结：**
CVE-2021-22986 是一个严重的安全漏洞，允许未经身份验证的攻击者在 F5 BIG-IP 和 BIG-IQ 设备上执行任意代码。由于存在公开的 PoC 并且漏洞已被积极利用，受影响的用户应尽快升级到受支持的版本，或采取缓解措施。

**项目地址:** [Osyanina/westone-CVE-2021-22986-scanner](https://github.com/Osyanina/westone-CVE-2021-22986-scanner)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)