## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要存在受影响的OpenSSH版本，并且用户或主机名包含shell元字符，在特定配置下触发ProxyCommand等功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385是OpenSSH中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，且这些名称被特定情况下的扩展标记引用，就可能发生操作系统命令注入。例如，一个不受信任的Git仓库可能有一个子模块，其用户名或主机名中包含shell元字符。根据提供的POC代码，该代码尝试在`/var/www/html/flag`文件中写入'hello'。如果目标系统配置允许写入该文件，并且利用成功触发了命令注入，则POC有效。但是，这个POC本身并不具有明显的恶意投毒行为。更高级的利用可能涉及更复杂的payload，比如反弹shell。

利用方式：

1.  **恶意Git仓库:** 创建一个包含恶意子模块的Git仓库，该子模块的用户名或主机名包含shell元字符。
2.  **配置ProxyCommand:** 在`~/.ssh/config`文件中配置`ProxyCommand`选项，使其引用包含shell元字符的用户名或主机名。
3.  **触发漏洞:** 当OpenSSH处理这些配置时，由于shell元字符未正确转义，导致命令注入。
4.  **执行任意命令:** 攻击者可以利用命令注入执行任意操作系统命令。

**项目地址:** [2048JiaLi/CVE-2023-51385](https://github.com/2048JiaLi/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)