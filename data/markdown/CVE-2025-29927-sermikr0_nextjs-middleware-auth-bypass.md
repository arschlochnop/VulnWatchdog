## CVE-2025-29927-Next.js Middleware 身份验证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 身份验证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用 Next.js 中间件进行身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件中的一个身份验证绕过漏洞。如果 Next.js 应用程序的身份验证检查在中间件中进行，则攻击者可能能够绕过这些检查。根据漏洞库信息和搜索结果，该漏洞的 CVSS 评分为 9.1，表明其严重性很高。漏洞利用代码提供了一个使用 Docker 部署 Next.js 应用程序的示例，其中包含一个 `middleware.js` 文件，该文件使用 cookie (`next_username` 和 `next_password`) 来检查用户身份验证。PoC代码直接硬编码了用户名密码 admin/password 存在安全风险，但是不是投毒代码. 

**有效性：**

提供的代码构成了一个概念验证 (PoC)，旨在演示如何利用此漏洞。通过构建和运行 Docker 镜像，攻击者可以部署一个易受攻击的 Next.js 应用程序，并绕过中间件中实现的身份验证检查，前提是攻击者知道或可以猜测到正确的cookie。该漏洞的有效性似乎很高，因为搜索结果表明该漏洞易于利用。

**投毒风险：**

Dockerfile 只是定义了应用部署过程，没有风险。README.md 文件仅包含有关如何构建和运行 Docker 镜像的说明，以及指向测试和安全工具（如 Burp Suite）的链接。这些都不是恶意代码。

`middleware.js` 文件中的身份验证逻辑非常简单，并且使用硬编码的凭据（admin/password）进行身份验证。虽然这本身就是一个安全问题，但这并不表明存在投毒行为，因为它仅用于演示 PoC。

`next.config.js` 文件是一个标准的 Next.js 配置文件，其中包含一些基本的配置选项。该文件没有包含任何恶意代码。

`package.json` 和 `yarn.lock` 文件包含项目依赖项和版本信息。这些文件本身没有包含任何恶意代码。

仓库中存在的漏洞利用代码主要用于演示漏洞，风险较低。但是**务必不能把POC验证的后门代码判定为投毒代码**，综合分析后判定投毒风险为10%。

**利用方式：**

1.  攻击者可以发送包含 `x-middleware-subrequest` 标头的恶意请求来绕过中间件身份验证检查。此方法已在漏洞描述中提及，并由搜索结果证实。
2.  或者，攻击者可以设置 `next_username` 和 `next_password` cookie 为 'admin' 和 'password' 来绕过 PoC 提供的身份验证逻辑（如果应用程序使用此特定代码）。
3.  成功绕过身份验证后，攻击者可以访问受保护的资源并执行未经授权的操作，具体取决于应用程序的实现。


**项目地址:** [sermikr0/nextjs-middleware-auth-bypass](https://github.com/sermikr0/nextjs-middleware-auth-bypass)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)