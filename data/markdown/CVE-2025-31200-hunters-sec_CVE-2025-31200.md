## CVE-2025-31200: CoreAudio APAC Channel Remapping Buffer Overflow

**漏洞编号:** CVE-2025-31200

**漏洞类型:** 内存损坏/缓冲区溢出

**影响应用:** Apple CoreAudio Framework

**危害等级:** 高危，可能导致代码执行、拒绝服务或沙箱逃逸

**影响版本:** iOS < 18.4.1, macOS < 15.4.1, tvOS < 18.4.1, visionOS < 2.4.1

**利用条件:** 需要用户处理恶意制作的音频文件（例如，通过网页浏览器、媒体播放器、邮件客户端等）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31200 是 Apple CoreAudio 框架 APAC（Apple Positional Audio Codec）解码器中存在的缓冲区溢出漏洞。具体来说，漏洞存在于 `APACHOADecoder::DecodeAPACFrame` 函数中的 `APACChannelRemapper::Process` 函数中。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码（POC），该漏洞的利用是有效的。CISA KEV中标记为已利用漏洞，表明已知该漏洞已被利用。

**投毒风险：**

虽然提供的代码仓库看起来像是用于生成恶意音频文件的工具，但存在一些小的投毒风险。主要考虑点是`create_malicious_mp4.py`中可能利用macOS的`afconvert`工具。该工具本身的功能不可信，如果被替换成恶意版本，会增加投毒的风险，因此投毒风险比例设置为10%。另外，复杂的音频处理库和编解码过程本身也可能隐藏恶意代码。

**利用方式：**

该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者创建一个特制的 APAC 音频文件，该文件包含一个全局通道布局和重映射通道布局，这两个布局之间的通道数量不匹配。
2.  **内存破坏：** 当 CoreAudio 框架处理这个恶意音频文件时，`APACChannelRemapper::Process` 函数会尝试根据重映射通道布局遍历 `mRemappingArray`，但由于通道数量不匹配，导致越界内存访问（缓冲区溢出）。
3.  **攻击目标：** 通过控制越界写入的数据，攻击者可能覆盖函数指针、虚函数表条目或堆元数据，从而实现任意代码执行或沙箱逃逸。
4.  **利用场景：** 攻击者可以将恶意音频文件嵌入到网页、邮件或消息中，诱使用户打开，从而触发漏洞。例如，用户通过网页浏览器播放包含恶意 APAC 音频的 HTML5 音频/视频，或者通过邮件客户端打开包含恶意音频附件的邮件。

**总结：**

CVE-2025-31200 是一个严重的安全漏洞，可能允许攻击者在受影响的系统上执行任意代码。利用该漏洞需要精心构造恶意音频文件，并诱使用户进行处理。建议受影响的用户尽快升级到最新版本的 iOS 或 macOS，以修复此漏洞。

**项目地址:** [hunters-sec/CVE-2025-31200](https://github.com/hunters-sec/CVE-2025-31200)

**漏洞详情:** [CVE-2025-31200](https://nvd.nist.gov/vuln/detail/CVE-2025-31200)