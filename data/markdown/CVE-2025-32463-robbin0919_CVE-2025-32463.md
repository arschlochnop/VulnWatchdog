## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 严重，可获取Root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 需要目标系统上存在有效用户账户，且Sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

漏洞 CVE-2025-32463 允许本地用户通过利用 Sudo 的 `--chroot` 选项提升权限至 root。攻击者可以在用户控制的目录下创建一个恶意的 `/etc/nsswitch.conf` 文件。当 Sudo 在此 chroot 环境中执行时，会读取该恶意配置，可能导致加载攻击者提供的恶意共享库，从而执行任意代码并获得 root 权限。

**有效性：**
提供的漏洞利用代码包含Dockerfile，用于构建包含漏洞版本的Sudo的Docker镜像。这个Dockerfile可以被成功构建，并创建一个存在漏洞的环境，表明该漏洞利用方法是有效的。

**投毒风险分析：**
1.  **Dockerfile：** Dockerfile用于构建存在漏洞的Sudo环境，方便漏洞验证，但不包含恶意代码。
2.  **README.md：** README.md提供了漏洞描述、影响、修复方案和检查方法，内容本身无害。
3.  **Lab_Setup_Guide.md：** Lab_Setup_Guide.md 提供构建漏洞环境的步骤，无恶意代码。
4.  **POC_Guide.md:** 指南用于指导POC的执行，初步分析没有发现明显的后门或者恶意行为。需要进一步的动态分析才能判断是否存在隐藏的恶意代码，鉴于整个环境搭建是为了复现漏洞，投毒的可能性较小，但不能完全排除。

综上，该POC的投毒风险较低，大概为10%，风险主要来自`POC_Guide.md`中可能存在的未检测到的恶意指令或利用方式。

**漏洞利用方式：**
1.  攻击者需要拥有目标系统上的一个有效用户账户。
2.  攻击者创建一个包含恶意 `/etc/nsswitch.conf` 文件的目录。
3.  攻击者使用 `sudo --chroot` 选项，指定该目录作为 chroot 根目录。
4.  当 Sudo 在此 chroot 环境中运行时，会加载攻击者提供的恶意 `/etc/nsswitch.conf` 文件。
5.  恶意 `/etc/nsswitch.conf` 文件会引导 Sudo 加载攻击者提供的共享库。
6.  共享库中的恶意代码被执行，攻击者获得 root 权限。

**项目地址:** [robbin0919/CVE-2025-32463](https://github.com/robbin0919/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)