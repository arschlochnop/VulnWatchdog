## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露和远程代码执行（如果 Grafana Image Renderer 插件安装）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，匿名访问开启时风险更高。SSRF 需安装 Grafana Image Renderer 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致 XSS。攻击者可以诱使用户点击恶意链接，该链接会将用户重定向到一个托管恶意前端插件的网站。该插件可以执行任意 JavaScript 代码，从而可能导致会话劫持和账户接管。如果安装了 Grafana Image Renderer 插件，还可以利用开放重定向实现完整的读取 SSRF，允许攻击者从 Grafana 服务器内部读取敏感信息。

**有效性分析：**
提供的 POC 代码是一个 Flask 应用程序，模拟了攻击者控制的服务器。它能够提供恶意插件 (`data2.json`) 和 JavaScript 代码 (`js.js`)。脚本包含使用 `--host` 参数指定攻击者主机名的功能，并在输出中打印了 XSS 和 SSRF 的利用路由。

**投毒风险分析：**
检查提供的 POC 代码，没有发现明显的恶意或隐藏的后门代码。该代码旨在模拟攻击者服务器的行为，提供必要的恶意文件。该脚本的目的是演示漏洞，而不是部署恶意软件。`data2.json` 和 `js.js` 是恶意负载，需要进一步分析以确定它们的确切行为。所以，投毒风险为0%。

**利用方式：**
1.  **XSS：** 攻击者构造一个包含客户端路径遍历和开放重定向的恶意 URL。此 URL 指向 Grafana 实例，利用路径遍历将用户重定向到攻击者控制的服务器。
2.  **攻击者服务器：** 攻击者设置一个服务器（如提供的 Flask 应用程序），该服务器托管恶意插件 (`data2.json`) 和 JavaScript 文件 (`js.js`)。
3.  **重定向和执行：** 当用户点击恶意 URL 时，Grafana 会将他们重定向到攻击者服务器。服务器提供恶意插件，该插件在用户的 Grafana 会话中执行任意 JavaScript 代码。
4.  **SSRF（如果安装了 Grafana Image Renderer）：** 如果安装了 Grafana Image Renderer 插件，攻击者可以利用开放重定向来触发 SSRF，允许他们从 Grafana 服务器内部读取数据。

从搜索引擎结果来看，该漏洞描述中明确指出结合客户端路径遍历和开放重定向会导致 XSS，同时若安装 Grafana Image Renderer 插件，则可能导致 SSRF，与POC代码的功能和原理相符。poc代码中提供了XSS 和 SSRF 两种利用方式。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4123](https://github.com/B1ack4sh/Blackash-CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)