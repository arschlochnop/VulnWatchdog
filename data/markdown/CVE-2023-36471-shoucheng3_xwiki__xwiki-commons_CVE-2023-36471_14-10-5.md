## CVE-2023-36471-xwiki-commons-HTML注入

**漏洞编号:** CVE-2023-36471

**漏洞类型:** HTML注入/远程代码执行

**影响应用:** xwiki-commons

**危害等级:** 高危，可能导致钓鱼攻击和远程代码执行

**影响版本:** >= 14.6-rc-1, < 14.10.6 和 >= 15.0-rc-1, < 15.2-rc-1

**利用条件:** 需要用户交互（管理员提交表单）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-36471 漏洞存在于 XWiki Commons 的 HTML sanitizer 中，该 sanitizer 允许 form 和 input HTML 标签。攻击者可以利用此漏洞，通过构造恶意的 HTML 表单来进行钓鱼攻击。更严重的是，攻击者可以通过在 sheet 中插入包含 Groovy 代码的隐藏 input 标签，当管理员提交包含恶意 input 的表单时，导致远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞允许插入form表单元素，结合漏洞库中给出的`{{html}}<input type="hidden" name="content" value="{{groovy}}println(&quot;Hello from Groovy!&quot;)" />{{/html}}`，管理员在编辑页面提交表单后会触发groovy代码执行，存在远程代码执行的可能性。POC 代码描述了jenkinsfile，没有显示利用该漏洞的直接代码，但是确定了这是一个与构建流程相关的漏洞。

**投毒风险：**
提供的Jenkinsfile 代码主要用于构建和测试 XWiki Commons，用于Jenkins自动集成，部署过程，并没有发现明显的恶意代码或后门。所有操作看起来都是围绕构建、测试和质量检查展开。因此，**投毒风险评估为0%**。

**利用方式：**
1.  攻击者在 XWiki 页面中注入恶意的 HTML 代码，例如包含隐藏的 input 字段。
2.  该 input 字段的值包含 Groovy 脚本，该脚本会在表单提交时执行。
3.  攻击者诱导管理员编辑并提交包含恶意 HTML 代码的页面。
4.  管理员提交表单后，恶意 Groovy 脚本在服务器端执行，导致远程代码执行。

**漏洞修复：**
通过禁止 form、input、select、textarea 和 button 标签来修复此漏洞。

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2023-36471_14-10-5](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2023-36471_14-10-5)

**漏洞详情:** [CVE-2023-36471](https://nvd.nist.gov/vuln/detail/CVE-2023-36471)