## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行

**影响应用:** Rails

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails应用程序运行于development模式，且攻击者可以访问该应用程序。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420漏洞允许攻击者在Rails应用程序运行于development模式下时，通过猜测自动生成的development模式secret token，结合Rails内部机制，执行远程代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞利用代码（虽然只提供了LICENSE文件）在搜索引擎结果中存在可利用的EXP描述。

**投毒风险：**
提供的代码仅为GNU GENERAL PUBLIC LICENSE，不包含任何可执行代码，因此投毒风险为0%。

**利用方式：**
1.  **前提条件：** Rails应用程序必须运行在development模式下，因为该模式下secret token的生成方式存在缺陷。
2.  **获取Secret Token：** 攻击者需要尝试猜测或通过其他方式获取development模式下的secret token。由于生成方式的随机性不足，存在被猜测的可能性。
3.  **构建恶意请求：** 攻击者利用已知的secret token，构造包含恶意代码的请求，发送到目标Rails应用。
4.  **远程代码执行：** Rails应用在处理恶意请求时，会使用被泄露的secret token进行解密，从而导致恶意代码被执行，最终实现远程代码执行。

**修复方案：**
*   升级Rails版本到>= 5.2.2.1 或 >= 6.0.0.beta3。
*   避免在生产环境中使用development模式。
*   确保production环境配置了强壮的`secret_key_base`。

**项目地址:** [sealldeveloper/CVE-2019-5420-PoC](https://github.com/sealldeveloper/CVE-2019-5420-PoC)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)