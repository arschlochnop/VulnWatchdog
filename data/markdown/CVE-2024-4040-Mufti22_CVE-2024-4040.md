## CVE-2024-4040-CrushFTP-SSTI

**漏洞编号:** CVE-2024-4040

**漏洞类型:** 服务器端模板注入 (SSTI)

**影响应用:** CrushFTP

**危害等级:** 高危，可导致任意文件读取，权限绕过，远程代码执行

**影响版本:** 10.0 <= version < 10.7.1, 11.0 <= version < 11.1.0

**利用条件:** 目标CrushFTP服务器开放网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4040是CrushFTP中存在的一个服务器端模板注入漏洞。未经验证的远程攻击者可以利用此漏洞读取文件系统中的文件，绕过身份验证以获得管理权限，并在服务器上执行远程代码。根据提供的POC代码，利用方式如下：

1.  **获取`currentAuth` Cookie:** POC首先尝试连接到目标URL，获取服务器设置的Cookie，特别是`currentAuth` Cookie。这个Cookie是后续利用的关键。
2.  **构造包含恶意Payload的URL:** POC使用获取的`currentAuth` Cookie和用户提供的文件路径构造一个包含`<INCLUDE>`标签的恶意URL。这个URL会被发送到 `/WebInterface/function/?command=zip`端点。恶意URL的格式如下：

    ```
    /WebInterface/function/?command=zip&c2f=<currentAuth>&path=<INCLUDE><path></INCLUDE>&names=*
    ```

    其中，`<path>`是用户指定的要读取的文件路径，例如 `/path/to/file.txt/`。请注意，路径需要以`/`开头和结尾。
3.  **发送请求并获取响应:** POC将构造的URL和Cookie发送到目标服务器，并获取服务器的响应。响应内容会包含被读取的文件内容。

根据漏洞信息和搜索结果，此漏洞已被积极利用，建议尽快修补。提供的POC代码经过分析，只包含PoC验证代码，没有发现明显的投毒行为。

**项目地址:** [Mufti22/CVE-2024-4040](https://github.com/Mufti22/CVE-2024-4040)

**漏洞详情:** [CVE-2024-4040](https://nvd.nist.gov/vuln/detail/CVE-2024-4040)