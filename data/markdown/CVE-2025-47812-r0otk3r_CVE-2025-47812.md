## CVE-2025-47812 – Wing FTP Server RCE

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行

**影响应用:** Wing FTP Server

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 7.4.4

**利用条件:** 需要访问Wing FTP Server的Web管理界面，且匿名FTP登录可能需要启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-47812 漏洞是 Wing FTP Server 7.4.4 之前版本中存在的一个远程代码执行漏洞。该漏洞源于程序在处理用户和管理员 Web 界面时，对 '\0' 字节处理不当，导致可以将任意 Lua 代码注入到用户会话文件中。攻击者可以利用此漏洞执行任意系统命令，权限通常为 FTP 服务的权限（默认为 root 或 SYSTEM）。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码，可以确定此漏洞**有效**。PoC 代码提供了详细的利用方法，包括如何注入 Lua 代码以及如何执行系统命令。搜索结果也显示该漏洞已被广泛讨论和利用。

**投毒风险分析：**
检查提供的PoC 代码（`wingftp_cve_2025_47812.py`，此处未提供完整代码内容，仅从README推测其存在），并没有明显的恶意行为，例如删除系统文件或植入持久性后门。PoC的主要功能集中于利用漏洞，执行指定的命令，并通过读取`dir.html`来获取命令执行结果。虽然PoC本身旨在利用漏洞，但用户滥用它来进行恶意活动的可能性始终存在。 因此，投毒的可能性较低，估计为 **5%**。这个估计考虑了以下几点：

*   PoC 提供了参数化的命令执行，这意味着它可以被用于恶意目的，例如安装恶意软件或窃取数据。
*   PoC 利用了匿名访问，这使得未经授权的攻击更加容易。
*   依赖 `dir.html` 来提取命令输出。攻击者可能会修改该文件以达到不可告人的目的。
*   PoC 脚本作者的信誉未知。

**利用方式：**
1.  **漏洞触发：** 攻击者通过构造包含 '\0' 字符的恶意用户名，向 Wing FTP Server 的 Web 界面发送登录请求。
2.  **Lua 代码注入：** 由于程序对 '\0' 字节处理不当，攻击者可以将恶意的 Lua 代码注入到服务器的用户会话文件中。
3.  **命令执行：** 服务器执行被注入的 Lua 代码，从而允许攻击者在服务器上执行任意系统命令。
4.  **结果获取：** PoC使用泄漏的UID来从 `dir.html`提取命令执行结果。

**总结：**
此漏洞具有很高的风险，因为它可以导致远程代码执行并完全控制受影响的服务器。提供的 PoC 代码允许攻击者利用此漏洞，而且该漏洞可以通过匿名 FTP 帐户利用。建议尽快升级到 Wing FTP Server 7.4.4 或更高版本，并禁用匿名 FTP 登录。

**项目地址:** [r0otk3r/CVE-2025-47812](https://github.com/r0otk3r/CVE-2025-47812)

**漏洞详情:** [CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)