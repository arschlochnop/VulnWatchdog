## CVE-2025-0282 - Ivanti Connect Secure 堆栈缓冲区溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 22.7R2.4 (Connect Secure), <= 22.7R1.2 (Policy Secure), <= 22.7R2.3 (Neurons for ZTA gateways)

**利用条件:** 需要网络访问到受影响的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是一个 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA 网关中存在的堆栈缓冲区溢出漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者执行代码。CISA 已将此漏洞添加到已知被利用的漏洞目录中，表明它已被积极利用。

**有效性：**
提供的 PoC 代码基于 `openconnect`，这是一个开源 VPN 客户端。PoC 分为“Normal”模式和“Exploit”模式。“Normal”模式用于测试目标是否正常运行。“Exploit”模式包含利用堆栈缓冲区溢出的代码。PoC 文档明确指出 exploit 代码包含硬编码的地址和偏移量，需要根据目标环境进行修改。这意味着直接使用提供的 PoC 可能无法成功，需要进行调整。

**投毒风险：**
PoC 代码是基于 `openconnect` 修改的，作者也明确表示代码存在非关键性的缺陷，需要使用者付出努力才能使其工作。这种情况下，存在一定的投毒风险，但作者已声明此 PoC 需要手动修改地址和偏移量才能利用，因此可解释为避免直接使用导致意外情况发生，但是存在一定风险，无法保证没有隐藏其他非预期行为。 考虑到作者已经明确说明PoC需要手动修改，并且提供详细的技术文章和背景信息，投毒的可能性相对较低，但仍然存在。风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 该漏洞存在于 IFT（IF-T）连接的处理方式中。通过向存在漏洞的 Ivanti Connect Secure 发送特制的请求，可以触发堆栈缓冲区溢出。
2.  **栈溢出：** 攻击者通过构造特定的数据包，覆盖堆栈上的返回地址，劫持程序的控制流。
3.  **远程代码执行：** 通过控制返回地址，攻击者可以将程序重定向到预先设置的 shellcode，从而执行任意代码。

**总结：**
CVE-2025-0282 是一个严重的安全漏洞，利用难度较高，但一旦成功利用，将导致严重的后果。提供的 PoC 代码可以作为利用该漏洞的起点，但需要根据目标环境进行修改和调整。

**项目地址:** [watchtowrlabs/CVE-2025-0282](https://github.com/watchtowrlabs/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)