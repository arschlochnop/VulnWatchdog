## CVE-2024-24919-Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network) 和 R81.10, R80.20 (Spark Gateway)

**利用条件:** 需要目标Check Point Security Gateway连接到互联网，并启用了远程接入VPN或移动接入软件 Blades。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2024-24919 是一个 Check Point Security Gateway 上的信息泄露漏洞。未授权的远程攻击者可以通过发送特制的HTTP请求读取服务器上的任意文件。利用方式是利用路径遍历漏洞访问受限文件。

**有效性：**
提供的PoC代码 `CVE-2024-24919.py` 尝试通过 POST 请求 `http://{host}/clients/MyCRL` 来触发漏洞。它检查响应中是否包含 'root' 字符串，如果存在，则判断目标可能存在漏洞。该PoC通过发送恶意构造的请求，验证是否存在信息泄露，因此是有效的。

**投毒风险：**
*   该仓库包含两个文件 `CVE-2024-24919.py` (漏洞利用脚本) 和 `README.md` (说明文档)。
*   漏洞利用脚本主要功能是发送HTTP请求，判断响应内容是否存在敏感信息。没有发现恶意代码，例如反弹shell，下载执行恶意程序等。
*   `proxies = {'http': 'http://127.0.0.1:8080', 'https': 'http://127.0.0.1:8080'}` 强制使用了本地代理，可能用于调试或抓包，但如果用户不知情，也可能被用来劫持流量，存在一定的风险。
*   `os.system('cls' if os.name == 'nt' else 'clear')`  用于清屏，在不同操作系统上执行不同的命令，没有明显的风险。
*   总体而言，该脚本的主要风险在于误报，由于通过检查'root'字符串判断漏洞存在，可能存在一定的误报率，但整体风险较低。
*   `README.md` 文件主要提供脚本的使用说明，没有发现任何恶意内容。

**结论：**
该仓库主要风险在于`proxies`的配置，可能会被恶意利用，造成流量劫持。但本身利用代码实现的功能较为简单，漏洞利用原理本身存在一定误报的可能性。投毒风险评级为 10%。

**利用方式：**
1.  攻击者发送特制的 HTTP POST 请求到目标 Check Point Security Gateway 的 `/clients/MyCRL` 路径。
2.  请求头需要包含有效的 `Host` 和 `Content-Type`。
3.  服务器如果存在漏洞，将返回包含敏感信息（如 'root'）的响应。
4.  攻击者通过分析响应内容获取敏感信息，例如系统文件内容。

**项目地址:** [0xans/CVE-2024-24919](https://github.com/0xans/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)