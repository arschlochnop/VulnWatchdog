## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-8088 是 WinRAR 在 Windows 平台上的一个路径遍历漏洞。攻击者可以构造恶意的 RAR 压缩包，当用户解压该压缩包时，恶意文件会被释放到任意目录，例如启动目录，从而实现任意代码执行。

**漏洞利用方式：**

1.  **构造恶意RAR文件：** 攻击者创建一个包含恶意路径的 RAR 文件。该路径指向 Windows 启动目录，或者其他攻击者希望写入的目录。
2.  **利用ADS流隐藏payload:** 漏洞利用代码通过创建ADS流将payload隐藏到诱饵文件中。
3.  **诱导用户解压：** 攻击者通过社会工程学或其他方式诱导用户使用 WinRAR 解压该恶意 RAR 文件。
4.  **触发漏洞：** WinRAR 在解压过程中，由于路径遍历漏洞，会将恶意文件释放到指定的恶意路径，例如启动目录。
5.  **执行恶意代码：**  当系统启动时，启动目录下的恶意文件会自动执行，从而导致攻击者可以在目标系统上执行任意代码。

**投毒风险分析：**

尽管提供的 POC 代码主要是为了生成恶意 RAR 文件，但仍然存在一定的投毒风险。风险点主要在于：

1. **依赖关系:** 该脚本依赖Python环境以及第三方库，可能引入恶意依赖。
2. **编码问题:** 在使用`write_text`方法时，可能会出现编码问题，导致文件内容不正确，或者引入其他安全问题。
3. **恶意行为隐藏:**  尽管脚本的主要功能是生成恶意RAR文件，但攻击者可以在脚本中添加额外的恶意行为，例如收集用户信息、上传文件等。
4. **创建ADS流:**  虽然代码中包含删除ADS流的步骤，但是如果删除操作失败，可能会导致payload泄露或者其他问题。

综合考虑，该 POC 代码存在 5% 的投毒风险，主要来源于潜在的恶意行为隐藏和编码问题。

**有效性分析：**

从漏洞库信息和搜索结果来看，CVE-2025-8088 是一个真实存在且被积极利用的漏洞。提供的 POC 代码实现了利用该漏洞创建恶意 RAR 文件的功能，可以有效验证漏洞的存在并进行利用。

**项目地址:** [Shinkirou789/Cve-2025-8088-WinRar-vulnerability](https://github.com/Shinkirou789/Cve-2025-8088-WinRar-vulnerability)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)