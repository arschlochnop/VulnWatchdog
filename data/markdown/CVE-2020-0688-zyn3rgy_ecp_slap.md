## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户权限，能够访问Exchange Control Panel (ECP)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0688是Microsoft Exchange Server中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞源于Exchange服务器未能正确处理内存中的对象，导致攻击者可以发送特制的payload到服务器并执行嵌入的命令。该漏洞利用的关键在于Exchange Control Panel (ECP)在创建唯一密钥时存在缺陷，使用静态密钥进行ViewState的序列化和反序列化。攻击者可以利用这个静态密钥构造恶意的ViewState，从而在服务器上执行任意代码。

**有效性：**
根据搜索结果和漏洞库信息，存在公开可用的POC代码。Rapid7的博客也证实可以通过该漏洞将Exchange用户账号提升到SYSTEM权限。因此，该漏洞利用的有效性较高。

**投毒风险：**
提供的漏洞利用代码片段仅仅是GNU GPL许可协议。由于该文件本身不包含任何可执行代码或配置信息，因此几乎不存在投毒风险。该代码仓库中其他文件的需要进一步分析，但是仅凭此license文件判断投毒几率可以判定为0%

**利用方式：**
1.  **获取Exchange用户凭据：** 攻击者首先需要拥有一个有效的Exchange用户账户。
2.  **利用静态密钥：** 利用已知的静态密钥（由于Exchange服务器未能正确生成唯一密钥）对`.NET` ViewState进行序列化和反序列化操作。
3.  **构造恶意ViewState：** 构造包含恶意代码的ViewState payload。
4.  **发送请求：** 将构造好的恶意ViewState payload发送到Exchange服务器的ECP页面。
5.  **远程代码执行：** Exchange服务器在处理该ViewState时，由于反序列化漏洞，将执行攻击者嵌入的恶意代码，从而实现远程代码执行。

**项目地址:** [zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)