## CVE-2016-6210-OpenSSH-用户名枚举

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** OpenSSH < 7.3, 使用 SHA256 或 SHA512 进行用户密码哈希

**利用条件:** 需要网络访问，目标系统运行存在漏洞版本的OpenSSH，并且配置为使用 SHA256 或 SHA512 进行密码哈希

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6210 允许远程攻击者通过利用 OpenSSH 在处理不存在的用户的身份验证时的时序差异来枚举用户名。当使用 SHA256 或 SHA512 对用户密码进行哈希时，OpenSSH 在处理不存在的用户时会使用 BLOWFISH 哈希处理静态密码。由于 BLOWFISH 哈希的计算速度远快于 SHA256/SHA512 哈希，攻击者可以通过发送大量密码并测量服务器响应时间来区分有效用户名和无效用户名。

漏洞利用方式如下：
1.  攻击者向目标 OpenSSH 服务器发送 SSH 连接请求。
2.  攻击者尝试使用一系列用户名进行身份验证，并为每个用户名提供一个很长的密码。
3.  攻击者测量服务器响应每个身份验证尝试所花费的时间。
4.  对于有效的用户名，服务器需要计算 SHA256/SHA512 哈希，这需要更长的时间。
5.  对于无效的用户名，服务器使用 BLOWFISH 哈希，这花费的时间更少。
6.  通过比较响应时间，攻击者可以区分有效用户名和无效用户名。

提供的POC代码 (ssh_enum.c) 的实现思路与上述描述一致，它通过多次尝试使用无效用户名和长密码，计算平均响应时间，然后尝试使用用户列表中的用户名进行爆破，根据响应时间和无效用户名平均响应时间的偏差来判断用户名是否存在。

投毒风险分析：
查看代码发现，代码功能比较简单，主要是对响应时间进行统计判断，没有发现明显的恶意代码或者后门。 但仍然存在一定的投毒风险，比如可以通过修改 `#define PASS_LEN 50000`将密码长度修改的过大，导致拒绝服务攻击，或者修改时间判断的阈值，导致错误的判断，将所有用户都判断为存在等。该风险发生的概率相对较小，因此风险值设定为 10%。

**项目地址:** [justlce/CVE-2016-6210-Exploit](https://github.com/justlce/CVE-2016-6210-Exploit)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)