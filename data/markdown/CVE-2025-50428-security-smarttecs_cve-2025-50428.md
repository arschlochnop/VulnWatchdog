## CVE-2025-50428 - RaspAP Command Injection

**漏洞编号:** CVE-2025-50428

**漏洞类型:** 命令注入

**影响应用:** RaspAP raspap-webgui

**危害等级:** 高危，可远程代码执行，权限提升

**影响版本:** <= 3.2.9

**利用条件:** 需要有效的RaspAP登录凭据

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-50428 是 RaspAP raspap-webgui 3.2.9 及更早版本中的一个命令注入漏洞。

**有效性：** 提供的 POC 代码似乎是有效的。它包含一个 Python 脚本 (poc.py) 和一个描述该漏洞的 README.md 文件。README.md 提供了关于漏洞的详细信息，包括描述、受影响的版本、利用要求、使用说明和参考资料（包括指向 NVD 漏洞数据库的链接）。该脚本通过 `interface` 参数向 `hostapd.php` 发送带有恶意命令注入 payload 的 POST 请求。该脚本首先尝试认证到 RaspAP web界面并获取CSRF token,用于绕过CSRF保护。

**投毒风险：**  POC代码中发现投毒代码的风险较低，约为5%。主要风险点在于利用 `base64` 编码命令进行反弹shell，虽然方便了命令的传递，但也增加了潜在恶意代码被隐藏的可能性。 脚本本身没有明显的恶意操作，例如删除文件、上传恶意软件等，但如果用户不小心，执行了包含恶意反弹shell的命令，仍然可能导致系统被入侵。

**利用方式：**

1.  **身份验证：** 使用提供的用户名和密码（默认为 admin/secret）登录到 RaspAP Web 界面。
2.  **CSRF Token 获取：**  从登录页面提取 CSRF (Cross-Site Request Forgery) 令牌。该令牌用于防止跨站点请求伪造攻击。
3.  **命令注入：**  将包含恶意命令的 payload 作为 `interface` 参数的值，通过 POST 请求发送到 `hostapd.php` 脚本。Payload 使用 `--interface` 参数传递给 POC 脚本。
4.  **命令执行：**  由于对 `interface` 参数的输入未进行充分的清理，攻击者注入的命令将以 `www-data` 用户的权限在服务器上执行。例如利用反弹shell获取权限。

**搜索引擎信息：**  搜索结果表明该漏洞已经被公开披露，并且 CISA 已将其添加到已知被利用的漏洞目录中。这表明该漏洞在野外被积极利用。

**总结：** 该漏洞利用的有效性较高，利用方式清晰。投毒风险较低，但需要防范用户执行恶意反弹shell代码的风险。

**项目地址:** [security-smarttecs/cve-2025-50428](https://github.com/security-smarttecs/cve-2025-50428)

**漏洞详情:** [CVE-2025-50428](https://nvd.nist.gov/vuln/detail/CVE-2025-50428)