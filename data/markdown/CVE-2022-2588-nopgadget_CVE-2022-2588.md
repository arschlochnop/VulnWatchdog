## CVE-2022-2588 - Linux kernel cls_route UAF

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要 CAP_NET_ADMIN 权限，可能需要 User Namespaces

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤实现中的一个释放后使用（Use-After-Free）漏洞。当 cls_route 过滤器的句柄值为 0 时，内核在释放旧过滤器之前不会将其从哈希表中删除。\n\n**有效性：**\n
根据漏洞库信息和搜索引擎结果，该漏洞存在且影响 Linux kernel 6.0 rc1 之前的版本。已存在公开的PoC代码，github上也有该漏洞的exp,说明该漏洞可以被利用。\n\n**投毒风险：**\n
提供的PoC代码仓库主要包含一个 README.md 文件，用于描述漏洞信息和利用条件。从目前提供的内容来看，直接的投毒代码可能性较低。但是，不能排除以下情况：\n\n*   **隐蔽的利用方式：** PoC 代码可能设计为需要特定配置或环境才能触发，从而在特定情况下执行恶意操作。\n*   **依赖项风险：** PoC 代码可能依赖于其他未知的库或组件，这些依赖项可能包含恶意代码。\n\n综合评估，投毒风险较低，估计为 5%。需要进一步分析完整的 PoC 代码才能进行更准确的判断。\n\n**利用方式：**\n
1.  **触发漏洞：** 通过创建和删除 cls_route 过滤器，并在句柄为 0 的情况下，触发 use-after-free 漏洞。\n2.  **控制释放后的内存：** 利用堆喷射等技术，控制被释放内存的内容，使其指向攻击者可以控制的地址。\n3.  **权限提升：** 通过修改内核数据结构，将当前用户的权限提升为 root 权限。\n\n根据搜索结果，该漏洞允许本地用户崩溃系统，并可能导致本地权限提升。利用需要 CAP_NET_ADMIN 权限。缓解措施包括禁用 cls_route 或使用 modprobe 进行配置。

**项目地址:** [nopgadget/CVE-2022-2588](https://github.com/nopgadget/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)