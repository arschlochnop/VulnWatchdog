## CVE-2020-14882 - Oracle WebLogic Server RCE

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，允许未授权的攻击者完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要目标服务器开放HTTP端口且运行受影响的WebLogic Server版本。无需认证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-14882 是 Oracle WebLogic Server Console 组件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来利用此漏洞，从而在服务器上执行任意代码。

**有效性分析：**

*   漏洞库信息显示该漏洞易于利用，CVSS评分为9.8，影响严重，包括机密性、完整性和可用性。
*   搜索引擎结果表明该漏洞已被广泛利用，存在公开的PoC，并被恶意行为者用于部署coinminer等恶意软件。
*   提供的PoC代码利用了 WebLogic Console 的一个路径穿越漏洞，结合 MVEL 表达式执行任意代码。代码中首先发送一个 GET 请求来确认漏洞存在，然后通过 POST 请求发送包含恶意代码的请求头，从而执行命令。

**投毒风险分析：**

该PoC代码本身主要功能是利用漏洞，但存在以下潜在的投毒风险：

*   **硬编码代理:** 代码中包含一个被注释掉的 `proxies = {'http' : '127.0.0.1:8080'}`，如果用户启用此代理，可能会将流量路由到攻击者控制的服务器，从而导致中间人攻击。这个默认配置风险较低，因为它是被注释掉的。但是如果用户没有意识到代理的存在而取消注释，则会带来风险。
*   **错误处理:** try...except 块过于宽泛，可能会隐藏潜在的错误，导致利用失败或产生不可预期的后果。虽然目的是为了避免程序崩溃，但可能掩盖了关键信息。

虽然存在以上风险，但代码主要功能是执行命令，没有发现明显的恶意代码注入。**投毒风险估计为5%**，主要来自于用户配置不当的可能性以及错误处理可能带来的问题。

**利用方式：**

1.  **发送GET请求 (可选):** 首先，使用 GET 请求，通过特殊的URL构造，检测目标是否存在CVE-2020-14882漏洞。
2.  **发送POST请求:**  如果漏洞存在，发送一个 POST 请求到 `/console/images/%252E%252E%252Fconsole.portal` ，并在请求头中包含 `cmd` 字段，指定要执行的命令。这个命令通过 MVEL 表达式和 Java 反射来执行。
3.  **获取执行结果:** 服务器执行命令后，将结果写入到响应流中，PoC代码读取并输出执行结果。

总的来说，该PoC代码利用了 WebLogic Server Console 组件的路径穿越漏洞和 MVEL 表达式注入，允许攻击者在目标服务器上执行任意代码。由于该漏洞的利用不需要身份验证，且影响严重，因此需要尽快修复。

**项目地址:** [nik0nz7/CVE-2020-14882](https://github.com/nik0nz7/CVE-2020-14882)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)