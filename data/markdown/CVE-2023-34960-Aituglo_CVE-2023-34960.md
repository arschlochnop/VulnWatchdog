## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，允许远程代码执行

**影响版本:** 1.11.* up to v1.11.18

**利用条件:** 需要能够访问 Chamilo 实例的 web 服务接口 (additional_webservices.php)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34960 是 Chamilo 1.11 到 1.11.18 版本中 wsConvertPpt 组件的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的 PowerPoint 文件名，通过 SOAP API 调用 wsConvertPpt 函数来执行任意系统命令。

**漏洞利用方式：**

1.  **攻击入口:** 攻击者需要能够访问 `additional_webservices.php` Web 服务接口。
2.  **SOAP 请求构造:** 攻击者构造一个 SOAP 请求，其中包含 `wsConvertPpt` 方法的调用。
3.  **命令注入:**  在 SOAP 请求的 `file_name` 参数中，攻击者插入包含恶意命令的字符串。由于未进行充分的输入验证和过滤，Chamilo 会将此字符串传递给系统命令执行函数。
4.  **命令执行:**  当 Chamilo 尝试处理（实际上可能不会处理） PowerPoint 文件时，注入的命令会被执行。

**POC 分析:**

提供的 POC 代码 `poc.py` 的工作原理如下：

1.  **构造 SOAP 请求:**  Python 脚本构造包含恶意 `file_name` 的 SOAP 请求，格式化字符串将用户提供的 `command` 插入到 `file_name` 中。
2.  **发送请求:**  脚本使用 `requests` 库向目标 Chamilo 实例的 `additional_webservices.php` 发送 POST 请求，请求体是构造的 SOAP 消息。
3.  **验证响应:**  脚本检查 HTTP 响应状态码是否为 200，以及响应正文中是否包含字符串 `wsConvertPptResponse`，以此判断漏洞是否可能存在以及命令是否可能执行成功。
4.  **命令执行与输出:** 通过 `-c` 参数可以执行任意指令.

**有效性评估:**
根据漏洞描述，搜索引擎结果以及提供的 POC 代码分析，此漏洞利用是有效的。

**投毒风险评估:**

分析提供的 POC 代码，没有发现任何可疑的或恶意的代码，该脚本目的明确，即利用命令注入漏洞，因此不存在投毒的风险。



**项目地址:** [Aituglo/CVE-2023-34960](https://github.com/Aituglo/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)