## CVE-2022-46169-Cacti-命令注入

**漏洞编号:** CVE-2022-46169

**漏洞类型:** 命令注入

**影响应用:** Cacti

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** < 1.2.23

**利用条件:** 目标系统运行受影响的Cacti版本，存在具有`POLLER_ACTION_SCRIPT_PHP`操作的`poller_item`，且攻击者能够访问`remote_agent.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46169 是 Cacti 中的一个命令注入漏洞，未经身份验证的攻击者可以通过精心构造的请求执行任意OS命令。该漏洞存在于`remote_agent.php`文件中，通过伪造 `X-Forwarded-For` 头绕过身份验证，然后通过 `polldata` 操作注入命令。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞已被积极利用。提供的PoC代码利用了身份验证绕过和命令注入漏洞，通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`，如果找到则执行反弹 shell 命令。  PoC的有效性较高。

**投毒风险：**
查看提供的PoC代码（`CVE-2022-46169.py`和`LICENSE`），主要功能是利用漏洞，没有发现明显的恶意代码或后门。`LICENSE` 文件是 GNU GPL v3 许可协议，属于开源协议。

**利用方式：**
1.  **身份验证绕过：** 攻击者通过设置 `X-Forwarded-For` 头部来伪造客户端IP地址，绕过 `remote_agent.php` 文件的身份验证。
2.  **命令注入：** 成功绕过身份验证后，攻击者可以调用 `polldata` 操作，并通过 `poller_id` 参数注入恶意命令。  PoC利用bash反弹shell。
3.  **参数爆破：** PoC代码通过爆破 `host_id` 和 `local_data_ids` 来查找具有 `POLLER_ACTION_SCRIPT_PHP` 操作的 `poller_item`。
4.  **执行任意命令：** 成功注入命令后，服务器将执行攻击者提供的命令。

**项目地址:** [0xZon/CVE-2022-46169-Exploit](https://github.com/0xZon/CVE-2022-46169-Exploit)

**漏洞详情:** [CVE-2022-46169](https://nvd.nist.gov/vuln/detail/CVE-2022-46169)