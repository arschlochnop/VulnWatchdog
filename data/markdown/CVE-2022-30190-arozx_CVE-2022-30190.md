## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在受害者系统上执行任意代码

**影响版本:** 见漏洞库信息中的受影响版本列表

**利用条件:** 用户需要打开恶意Word文档或点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190 (Follina) 是一个 Microsoft Office 漏洞，当从 Word 等调用应用程序中使用 URL 协议调用 MSDT 时，存在远程代码执行漏洞。攻击者可以利用此漏洞在受害者系统上执行任意代码。根据提供的PoC代码，攻击方式主要通过构造恶意的HTML文件（exploit.html），该文件包含大量的 'A' 字符，可能用于缓冲区溢出或其他内存破坏技术，从而执行恶意代码。该HTML文件需要通过Word的远程模板功能从远程服务器检索。server.py脚本可能用于托管该恶意HTML文件。漏洞利用有效性较高，因为该漏洞已被公开利用并添加到 CISA KEV 目录。投毒风险评估为10%。因为攻击者可能通过服务器端植入后门，但是该后门不是通过PoC直接表现，需要攻击者自身行为才能形成。 

**利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意HTML的Word文档。
2.  当用户打开该文档时，Word会尝试通过MSDT URL协议加载远程HTML文件。
3.  恶意HTML文件利用MSDT漏洞执行任意代码，例如下载并执行恶意程序，或直接在受害者系统上执行命令。

**项目地址:** [arozx/CVE-2022-30190](https://github.com/arozx/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)