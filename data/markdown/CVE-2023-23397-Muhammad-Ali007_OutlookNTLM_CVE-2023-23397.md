## CVE-2023-23397 Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本：Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise（具体版本范围参考漏洞库信息）

**利用条件:** 攻击者需要发送特制的日历邀请或邮件，受害者使用受影响的Outlook版本查看邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以通过发送包含指向远程SMB服务器（或其他支持NTLM认证的服务器，如WebDAV）的恶意UNC路径的日历邀请或邮件来利用此漏洞。当Outlook处理该邮件时，会尝试连接到远程服务器以获取声音文件（ReminderSoundFile），这会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。攻击者可以利用获取的Net-NTLM hash进行NTLM Relay攻击或其他凭据破解尝试。

**有效性:** 提供的POC代码通过PowerShell脚本实现了发送或保存包含恶意`ReminderSoundFile`属性的日历邀请，该属性指向攻击者控制的远程文件服务器。因此，该POC代码是有效的。

**投毒风险:** 代码功能明确，旨在利用CVE-2023-23397漏洞，没有发现隐藏的恶意代码或后门。代码目的是为了验证漏洞，没有额外恶意行为。因此投毒风险评估为0%。

**利用方式:**
1.  攻击者创建一个恶意的日历邀请或邮件。
2.  攻击者在日历邀请或邮件的`ReminderSoundFile`属性中设置一个UNC路径，指向攻击者控制的远程服务器（例如，`\\attacker_ip\share\file.wav`）。
3.  攻击者将日历邀请或邮件发送给受害者。
4.  当受害者使用受影响的Outlook版本打开该日历邀请或邮件时，Outlook会尝试连接到攻击者的远程服务器以获取声音文件。
5.  Outlook的连接尝试会触发NTLM认证过程，将受害者的Net-NTLM hash发送到攻击者的服务器。
6.  攻击者捕获Net-NTLM hash，并尝试破解或进行NTLM Relay攻击。

**项目地址:** [Muhammad-Ali007/OutlookNTLM_CVE-2023-23397](https://github.com/Muhammad-Ali007/OutlookNTLM_CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)