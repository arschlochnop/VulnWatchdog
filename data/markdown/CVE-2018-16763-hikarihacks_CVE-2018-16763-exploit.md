## CVE-2018-16763-Fuel CMS 远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** Fuel CMS

**危害等级:** 高危，可以执行任意代码

**影响版本:** 1.4.1

**利用条件:** 无需身份验证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-16763是Fuel CMS 1.4.1版本中的一个远程代码执行漏洞。攻击者可以通过`pages/select/`的`filter`参数或`preview/`的`data`参数注入PHP代码，从而在服务器上执行任意命令。该漏洞无需身份验证即可利用。

**利用方式：**

1.  攻击者构造包含恶意PHP代码的URL，该代码会被注入到`filter`参数中。例如：`victim/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27id%27%29%2b%27`
2.  Fuel CMS在处理`filter`参数时，会对其中的PHP代码进行评估，从而执行攻击者注入的命令。
3.  攻击者可以利用此漏洞在服务器上执行任意系统命令，例如读取文件、写入文件、反弹shell等。

**有效性：**

提供的POC代码是有效的，它利用了`filter`参数中的PHP代码评估漏洞，可以执行任意系统命令。

**投毒风险：**

代码中存在极低的投毒风险（约为1%）。主要原因是：

*   该POC基于已知的漏洞利用，并且代码逻辑清晰，旨在利用漏洞执行命令。
*   代码的主要功能是通过HTTP请求发送包含恶意PHP代码的URL，并解析响应以获取命令执行结果。
*   虽然攻击者可以修改`cmd`变量以执行任意命令，但这是漏洞利用的正常行为，不属于投毒。
*   唯一可能被视为轻微投毒风险的地方在于，攻击者可能会将恶意命令硬编码到脚本中，但这种风险很低，因为攻击者通常会根据目标环境进行定制化修改。

**总结：**

CVE-2018-16763是一个严重的安全漏洞，可以被攻击者利用来执行任意代码。提供的POC代码可以成功利用此漏洞，并且投毒风险较低。

**项目地址:** [hikarihacks/CVE-2018-16763-exploit](https://github.com/hikarihacks/CVE-2018-16763-exploit)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)