## CVE-2025-27591-below-特权提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 特权提升

**影响应用:** below

**危害等级:** 高危，允许本地普通用户提升为root权限

**影响版本:** < 0.9.0

**利用条件:** 需要存在world-writable的/var/log/below目录，以及能够通过sudo执行/usr/bin/below record命令且无需密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

此漏洞是由于`below`服务在低于0.9.0版本时，创建了一个全局可写的目录`/var/log/below`。未经授权的本地用户可以通过符号链接攻击来提升权限。利用步骤如下：

1.  **验证**/var/log/below**目录是否全局可写。
2.  删除**/var/log/below/error_root.log**（如果存在）。
3.  创建一个符号链接，将**/var/log/below/error_root.log**链接到**/etc/passwd**。
4.  创建一个包含恶意用户信息的payload文件（例如，创建一个UID为0的用户）。
5.  使用`sudo /usr/bin/below record`命令触发日志写入，将payload写入符号链接指向的**/etc/passwd**文件。由于`below`以root权限运行，这会将恶意用户添加到**/etc/passwd**。
6. 攻击者可以通过新添加的用户登录系统，从而获得root权限。

**有效性：**

根据漏洞描述和提供的PoC代码，利用方式是有效的。PoC代码演示了如何通过符号链接攻击修改**/etc/passwd**文件，从而添加具有root权限的用户。

**投毒风险：**

经过分析，PoC代码本身没有明显的投毒行为。代码的功能是利用漏洞提升权限，而不是执行其他恶意操作。`dbs_exploit.py` 脚本的目的是自动化利用过程，它创建符号链接、触发日志写入和添加用户，这些操作都是漏洞利用的一部分。所以，投毒风险评估为0%。

**利用方式：**

利用方式是经典的符号链接攻击。攻击者利用全局可写的日志目录，通过符号链接将日志文件链接到敏感文件，然后通过具有root权限的程序（`below`）向日志文件写入内容，从而修改敏感文件。在这种情况下，敏感文件是**/etc/passwd**，通过向其中添加恶意用户，攻击者可以获得root权限。

**项目地址:** [dollarboysushil/Linux-Privilege-Escalation-CVE-2025-27591](https://github.com/dollarboysushil/Linux-Privilege-Escalation-CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)