## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的用户可以通过构造的OGC请求执行任意代码

**影响版本:** 2.22.0 < version < 2.22.6, 2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** GeoServer服务可网络访问，并且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行漏洞。该漏洞源于GeoTools库API以不安全的方式将属性/属性名称传递给commons-jxpath库，从而允许执行任意代码。攻击者可以通过构造恶意的OGC请求（例如WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo、WMS GetLegendGraphic和WPS Execute）来利用此漏洞，执行任意代码。

**有效性：**
提供的POC代码利用了`valueReference`参数执行任意命令，例如计算器程序。从漏洞描述和搜索引擎结果来看，POC是有效的，并且已被野外利用。

**投毒风险：**
查看提供的POC代码和LICENSE文件。LICENSE采用MIT许可，相对宽松。代码本身主要是提供了漏洞的利用方式，没有发现明显的恶意代码。README中包含绕过WAF的payload，以及各种请求方式（GetPropertyValue, GetFeature）的PoC。

*   LICENSE文件: MIT License, 比较通用，没有发现可疑之处
*   README文件：提供了漏洞的描述和多个PoC示例，没有直接执行恶意操作的代码。

综合来看，投毒风险较低，在10%左右。主要风险来自于对POC的滥用，而非POC本身包含恶意代码。

**利用方式：**
1.  确定目标GeoServer版本在受影响范围内。
2.  使用提供的PoC构造恶意OGC请求。
3.  利用`valueReference`参数或`PropertyName`，注入包含恶意代码的XPath表达式。
4.  发送构造的请求到目标GeoServer服务器。
5.  如果漏洞存在，服务器将执行注入的代码。

**项目地址:** [Mr-xn/CVE-2024-36401](https://github.com/Mr-xn/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)