## CVE-2025-32432-CraftCMS-RCE

**漏洞编号:** CVE-2025-32432

**漏洞类型:** 远程代码执行

**影响应用:** Craft CMS

**危害等级:** 高危，允许未经授权的攻击者在服务器上执行任意代码

**影响版本:** 3.0.0-RC1 < 3.9.15, 4.0.0-RC1 < 4.14.15, 5.0.0-RC1 < 5.6.17

**利用条件:** 需要网络访问，目标Craft CMS实例存在漏洞，无需身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32432 是 Craft CMS 中的一个远程代码执行漏洞。根据漏洞信息、搜索结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

*   漏洞信息明确指出这是一个远程代码执行漏洞，CVSS 评分高达 10.0，表明其危害程度极高。
*   搜索结果中多个来源（NVD、OpenText Core SCA、RedPacket Security、cybersecuritynews.com 等）都确认了该漏洞的存在和影响。
*   提供的漏洞利用代码（CVE-2025-32432.go）包含利用该漏洞的 PoC 代码。代码中定义了 `randomPayload` 和 `rcePayload` 函数，分别用于检测漏洞和执行命令。`rcePayload` 函数通过构造恶意的 payload，利用 `GuzzleHttp\Psr7\FnStream` 类和 `system` 函数执行任意命令。

**投毒风险：**

*   漏洞利用代码主要功能是发送恶意请求以触发RCE，看起来没有明显的投毒行为。代码虽然尝试清理输出，但目的是更好地展示结果，而非隐藏恶意行为。
*   经过分析，没有在给定的POC中发现任何直接的投毒代码，例如回连恶意服务器、植入后门等。该POC 的目的是为了验证漏洞的存在以及远程命令执行,所以投毒风险为0%

**利用方式：**

1.  **获取 CSRF Token：** PoC 代码首先尝试从 `/admin/dashboard` 或 `/` 页面获取 CSRF token，用于绕过 CSRF 保护。
2.  **发送恶意请求：** 利用 `rcePayload` 函数构造包含恶意 PHP 代码的 JSON payload。该 payload 利用 Craft CMS 中资产转换功能的漏洞，将恶意代码注入到图像处理流程中。
3.  **触发远程代码执行：** 将构造的 payload 发送到 `?p=admin/actions/assets/generate-transform` 接口，触发漏洞。
4.  **执行任意命令：** 漏洞成功利用后，服务器将执行 payload 中指定的命令，并将结果返回给攻击者。

**总结：**

CVE-2025-32432 是一个高危的远程代码执行漏洞，利用简单，影响范围广。攻击者可以利用该漏洞在未授权的情况下控制 Craft CMS 服务器。 提供的PoC 代码有效，没有发现潜在的投毒风险。

**项目地址:** [ibrahimsql/CVE-2025-32432](https://github.com/ibrahimsql/CVE-2025-32432)

**漏洞详情:** [CVE-2025-32432](https://nvd.nist.gov/vuln/detail/CVE-2025-32432)