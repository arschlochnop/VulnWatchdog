## CVE-2025-1661-HUSKY WooCommerce Filter Plugin-LFI

**漏洞编号:** CVE-2025-1661

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** HUSKY – Products Filter Professional for WooCommerce

**危害等级:** 高危，可能导致敏感数据泄露和远程代码执行

**影响版本:** <= 1.3.6.5

**利用条件:** 需要安装存在漏洞的HUSKY WooCommerce插件，并可以通过HTTP(S)访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1661是HUSKY – Products Filter Professional for WooCommerce插件中存在的一个未经身份验证的本地文件包含漏洞。根据漏洞库信息、搜索引擎结果和提供的POC代码分析，该漏洞允许未经身份验证的攻击者通过`woof_text_search` AJAX action中的`template`参数包含并执行服务器上的任意文件。 

**有效性：**

根据漏洞描述和POC代码，该漏洞的利用较为直接。攻击者可以通过构造包含恶意文件路径的请求来读取服务器上的敏感文件或执行恶意PHP代码。因此，提供的POC代码**有效**。

**投毒风险：**

POC代码本身相对简单，主要描述了如何通过修改请求参数来触发LFI漏洞。但是, POC中包含了一个指向Telegram频道的链接。攻击者可能会通过这个频道传播恶意软件或钓鱼链接，从而进行进一步的攻击。此外，虽然POC本身没有明显的投毒代码，但是攻击者可能会修改POC，添加恶意代码，然后传播给其他人使用。 仓库中存在作者隐藏的投毒代码的可能性较低，但考虑到Telegram链接的风险，投毒风险评估为**10%**。

**利用方式：**

1.  **版本检测：** 首先，攻击者需要确定目标网站是否安装了受影响的HUSKY WooCommerce Filter Professional插件，并检查其版本是否小于等于1.3.6.5。可以通过查看页面源代码，搜索`woocommerce-products-filter`字符串来确定插件版本
2.  **拦截请求：** 攻击者使用Burp Suite等工具拦截包含产品过滤插件搜索功能的请求。
3.  **构造Payload：** 攻击者修改请求中的`template`参数，使其指向目标文件。例如，可以使用`../../../wp-config.php`来尝试读取WordPress配置文件。
4.  **发送请求：** 攻击者发送修改后的请求，服务器将包含指定文件的内容。
5.  **代码执行 (如果允许上传)：** 如果目标服务器允许上传文件(例如图片)，攻击者可以上传包含恶意PHP代码的文件，然后使用LFI漏洞执行该文件，从而实现远程代码执行(RCE)。

**搜索引擎结果参考：**

*   NVD, Wiz.io, Recorded Future, cve.mitre.org 等网站都确认了该漏洞的存在和影响。
*   GitHub上存在相关的漏洞利用代码仓库 (webpage 4)。
*   CISA (webpage 7) 也发布了关于此漏洞的公告。

**项目地址:** [exploit-machine/PoC-EXPLOIT-CVE-2025-1661-Critical-Vulnerability-in-HUSKY-WooCommerce-Filter-Plugin](https://github.com/exploit-machine/PoC-EXPLOIT-CVE-2025-1661-Critical-Vulnerability-in-HUSKY-WooCommerce-Filter-Plugin)

**漏洞详情:** [CVE-2025-1661](https://nvd.nist.gov/vuln/detail/CVE-2025-1661)