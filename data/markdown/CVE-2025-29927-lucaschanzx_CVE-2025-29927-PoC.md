## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据或执行未授权操作

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标Next.js应用使用Middleware进行权限校验，且受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Next.js 中间件的权限验证逻辑中。在受影响的版本中，当权限检查发生在中间件中时，可能被绕过。

**有效性：**

根据漏洞描述，如果 Next.js 应用在中间件中进行权限验证，并且版本在受影响范围内，则该漏洞利用是有效的。

提供的代码示例包含以下文件：

*   `README.md`:  Next.js 项目的介绍文件，不包含漏洞利用代码。
*   `middleware.ts`:  Next.js 中间件代码，实现了简单的权限验证。如果请求的路径以 `/private` 开头，并且 `authorization` header 不等于 `secret-token`，则返回 401 Unauthorized。
*   `next.config.ts`:  Next.js 配置文件，不包含漏洞利用代码。
*   `package-lock.json`:  记录项目依赖的版本信息，不包含漏洞利用代码。

虽然没有直接的利用代码，但`middleware.ts`定义了一个不安全的身份验证逻辑, 攻击者可以尝试绕过，该漏洞说明中提到，`x-middleware-subrequest`头部可能存在问题，虽然示例没有直接使用该头部，但理解如何利用该头部与中间件认证逻辑之间的交互是关键。

**投毒风险：**

提供的代码仓库中没有发现明显的投毒代码。所有文件都是标准的 Next.js 项目文件，并且中间件代码虽然存在漏洞，但不是恶意代码。因此，投毒风险评估为0%。

**利用方式：**

根据漏洞描述，可能的利用方式是：

1.  **发送带有 `x-middleware-subrequest` 头的请求：** 尝试发送带有 `x-middleware-subrequest` 头的请求到受保护的路由（`/private`）。如果 Next.js 中间件对该 header 的处理存在缺陷，可能导致权限验证被绕过。
2.  **其他绕过方式：**  虽然没有具体细节，但漏洞描述表明可能存在其他绕过权限验证的方式，需要进一步研究 Next.js 中间件的实现细节。

攻击者需要构造特定的请求，利用 Next.js 中间件的漏洞，绕过权限验证，从而访问受保护的资源。

**缓解措施：**

*   升级到 Next.js 的安全版本（14.2.25 或 15.2.3 或更高版本）。
*   如果无法升级，可以阻止包含 `x-middleware-subrequest` 头的外部用户请求到达 Next.js 应用程序。

**项目地址:** [lucaschanzx/CVE-2025-29927-PoC](https://github.com/lucaschanzx/CVE-2025-29927-PoC)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)