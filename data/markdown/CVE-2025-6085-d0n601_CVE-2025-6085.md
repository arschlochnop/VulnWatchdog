## Make Connector <= 1.5.10 - Authenticated (Admin+) Arbitrary File Upload

**漏洞编号:** CVE-2025-6085

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Make Connector插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.5.10

**利用条件:** 需要WordPress管理员或更高权限用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 WordPress Make Connector 插件中，允许具有管理员或更高权限的用户通过REST API上传任意文件。漏洞存在的原因是插件在将上传的文件复制到服务器的可浏览目录后，才检查允许的 MIME 类型。攻击者可以上传一个 PHP 文件，然后通过访问该文件来执行任意代码。

**利用方式：**

1.  **准备恶意 PHP 文件：**  创建一个包含恶意代码的 PHP 文件，例如 `shello.php`，该文件可以执行系统命令。
2.  **发起 HTTP POST 请求：**  使用 `curl` 或其他 HTTP 客户端，构造一个包含恶意 PHP 文件的 POST 请求发送到 WordPress 的 REST API 端点 `/wp-json/wp/v2/media`。
    *   请求头需要包含 `IWC-API-KEY`，这是一个身份验证密钥。
    *   请求体需要包含 `file` 参数，值为恶意 PHP 文件的路径；`title`、`description` 和 `caption` 等参数。
3.  **访问上传的 PHP 文件：**  上传成功后，可以通过浏览器或 `curl` 访问上传的 PHP 文件，例如 `https://lab1.hacker/wp-content/uploads/2025/04/shello.php`，并通过 GET 参数 `cmd` 执行系统命令。例如 `https://lab1.hacker/wp-content/uploads/2025/04/shello.php?cmd=ip%20addr`。

**有效性评估：**

提供的 POC 代码是有效的，它展示了如何利用该漏洞上传任意 PHP 文件并执行系统命令。

**投毒风险评估：**

该漏洞利用代码中本身不包含恶意或者隐藏的投毒代码。风险评估为 5% 是因为利用脚本会上传任意文件，如果利用人员在文件内容上动手脚可能会造成投毒，此处认为原始脚本不包含投毒代码。

**缓解措施：**

1.  将 Make Connector 插件更新到最新版本，以修复该漏洞。
2.  限制 WordPress 用户的权限，只允许受信任的用户具有上传文件的权限。
3.  配置 Web 服务器，禁止执行上传目录中的 PHP 文件。
4.  使用 Web 应用程序防火墙 (WAF) 来检测和阻止恶意文件上传。

**项目地址:** [d0n601/CVE-2025-6085](https://github.com/d0n601/CVE-2025-6085)

**漏洞详情:** [CVE-2025-6085](https://nvd.nist.gov/vuln/detail/CVE-2025-6085)