## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiWeb 7.6 (7.6.0 through 7.6.3), FortiWeb 7.4 (7.4.0 through 7.4.7), FortiWeb 7.2 (7.2.0 through 7.2.10), FortiWeb 7.0 (7.0.0 through 7.0.10)

**利用条件:** 目标系统存在漏洞版本的FortiWeb，攻击者可以未经身份验证通过网络访问GUI组件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-25257是FortiWeb中的一个SQL注入漏洞，位于其图形用户界面（GUI）组件中。该漏洞源于对SQL语句中使用的特殊元素未进行适当的中和。 

**有效性：**
根据搜索结果，这是一个关键的未经身份验证的SQL注入漏洞，CVSS评分为9.6。Fortinet已经发布了修复程序。提供的POC代码旨在检测目标FortiWeb实例是否存在此漏洞并利用其实现远程代码执行，因此POC是有效的。

**投毒风险：**
分析POC代码，该脚本首先使用分块方式将命令注入到`token`变量中，然后使用`fabric_user.user_table`更新语句执行注入的命令。脚本尝试执行反向shell，连接到攻击者的`lhost`和`lport`。 由于目标是执行反向shell命令，并非上传恶意文件或者修改其它配置，因此基本不存在恶意投毒风险。 虽然脚本可能包含对目标系统的潜在损害，但这属于漏洞利用的范畴，而非植入恶意代码。

**利用方式：**
1.  **SQL注入：** 攻击者利用SQL注入漏洞，通过构造恶意的SQL语句，修改`fabric_user.user_table`表的`token`字段。
2.  **命令执行：**注入的SQL语句实际上是构造好的反向shell命令，通过`os.system`执行反向shell，从而实现远程代码执行。
3.  **反向Shell：** 成功利用后，受害者主机将通过TCP连接到攻击者指定的IP地址和端口，从而允许攻击者控制受害者主机。

**项目地址:** [watchtowrlabs/watchTowr-vs-FortiWeb-CVE-2025-25257](https://github.com/watchtowrlabs/watchTowr-vs-FortiWeb-CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)