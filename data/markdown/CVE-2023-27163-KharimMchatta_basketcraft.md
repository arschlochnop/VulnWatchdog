## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部网络资源访问和敏感信息泄露

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request-Baskets服务，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-27163是Request-Baskets 1.2.1及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于`/api/baskets/{name}`组件。该漏洞允许攻击者通过构造恶意的API请求来访问内部网络资源和敏感信息。

**有效性评估：**
提供的漏洞利用代码 `basketcraft.sh` 似乎是有效的，因为它旨在自动化利用该SSRF漏洞的过程。它通过提示用户输入目标URL、basket名称和攻击者IP地址，构建一个包含恶意`forward_url`的JSON payload，然后使用curl发送POST请求来创建basket。创建成功后，脚本会输出token，并使用curl再次请求创建的basket URL来触发SSRF。如果成功，Request-Baskets将会向攻击者指定的IP地址和端口发起请求，攻击者可以使用Netcat监听该端口来验证漏洞利用。

**投毒风险评估：**
代码存在轻微的投毒风险。风险点主要在于脚本依赖用户输入`attackerip`。虽然这本身不是恶意代码，但如果攻击者在不知情的情况下运行该脚本，并在`attackerip`处输入了恶意IP，那么该恶意IP可能获取目标服务器的信息。因此，存在一定的欺骗性，让用户无意间参与攻击行为。另外该脚本也存在可读性问题和缺少详细注释等。因此，投毒风险评估为10%。

**漏洞利用方式：**
1.  **创建Basket：** 攻击者使用POST请求向`/api/baskets/{name}`发送请求，其中`{name}`是basket的名称。
2.  **构造Payload：** 在POST请求的body中，攻击者会构造一个JSON payload，其中包含`forward_url`字段。`forward_url`指向攻击者想要访问的内部资源，例如`http://internal_server:8080/admin`。
3.  **触发SSRF：** 当Request-Baskets收到发送到该basket的请求时，它会将该请求转发到`forward_url`指定的地址，从而触发SSRF漏洞。
4.  **信息获取：** 如果成功，攻击者可以通过Netcat监听端口来捕获来自目标服务器的响应，或者访问原本无法访问的内部服务。

总之，该漏洞利用方式相对简单，但可能需要一些社会工程学技巧才能诱使目标用户运行包含恶意`attackerip`的脚本。

**项目地址:** [KharimMchatta/basketcraft](https://github.com/KharimMchatta/basketcraft)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)