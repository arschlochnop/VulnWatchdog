## CVE-2024-21754-FortiOS/FortiProxy密码哈希破解

**漏洞编号:** CVE-2024-21754

**漏洞类型:** 密码哈希破解

**影响应用:** FortiOS/FortiProxy

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** FortiOS: <= 7.4.3, 7.2所有版本, 7.0所有版本, 6.4所有版本; FortiProxy: <= 7.4.2, 7.2所有版本, 7.0所有版本, 2.0所有版本

**利用条件:** 需要目标系统存在漏洞版本，需要具有超级管理员权限和CLI访问权限

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2024-21754 漏洞源于 FortiOS 和 FortiProxy 使用的密码哈希算法的计算强度不足。攻击者若拥有超级管理员权限和 CLI 访问权限，便可能利用该漏洞解密备份文件，窃取敏感信息。

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞确实存在，并且影响多个 FortiOS 和 FortiProxy 版本。提供的漏洞利用代码 (README.md) 指示利用此漏洞需要超级管理员权限和 CLI 访问权限，符合漏洞描述。

**投毒风险分析：**
虽然 `README.md` 文件本身没有直接包含恶意代码，但它提供了一个外部下载链接 `https://t.ly/U6cSD`，用于下载exploit代码。因为这个链接是被缩短过的，所以指向的文件内容未知，存在高风险，可能包含恶意payload、后门或与描述不符的其他恶意功能。因此，判断存在较高的投毒风险。
此外，该漏洞利用工具需要管理员权限，一旦被植入恶意代码，可能产生严重后果，例如控制设备或窃取更多敏感信息。

**利用方式分析：**
1.  **前提条件：** 攻击者必须具有 FortiOS 或 FortiProxy 系统的超级管理员权限和 CLI 访问权限。
2.  **获取备份文件：** 攻击者通过CLI命令获取设备的备份文件。
3.  **密码哈希破解：** 攻击者使用提供的expolit脚本，它包含一个定制的密码破解工具，利用密码哈希算法的脆弱性来破解用于加密备份文件的密码。
4.  **解密备份文件：** 成功破解密码后，攻击者可以使用该密码解密备份文件，从而获取其中的敏感信息，例如用户凭据、配置数据等。
5.  **远程代码执行(RCE):** README.md文件显示执行了'uname -a'命令，可能存在远程代码执行。

**风险提示：** 从不可信的来源下载和运行漏洞利用代码存在极高的风险。在实际环境中利用此漏洞前，务必在隔离环境中进行充分测试和验证，并仔细检查代码内容，防范潜在的恶意代码。

**项目地址:** [CyberSecuritist/CVE-2024-21754-Forti-RCE](https://github.com/CyberSecuritist/CVE-2024-21754-Forti-RCE)

**漏洞详情:** [CVE-2024-21754](https://nvd.nist.gov/vuln/detail/CVE-2024-21754)