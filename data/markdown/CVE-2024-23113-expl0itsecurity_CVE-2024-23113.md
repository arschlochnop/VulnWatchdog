## CVE-2024-23113 - Fortinet Format String RCE

**漏洞编号:** CVE-2024-23113

**漏洞类型:** 格式化字符串漏洞

**影响应用:** FortiOS, FortiProxy, FortiPAM, FortiSwitchManager

**危害等级:** 高危，可导致远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14; FortiPAM: 1.2.0, 1.1.0-1.1.2, 1.0.0-1.0.3; FortiSwitchManager: 7.2.0-7.2.3, 7.0.0-7.0.3

**利用条件:** 需要网络可达目标设备，且目标设备运行受影响的版本。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2024-23113 是一个存在于 FortiOS, FortiProxy, FortiPAM 和 FortiSwitchManager 的格式化字符串漏洞。攻击者可以通过构造特制的网络数据包，利用此漏洞在目标系统上执行任意代码或命令，无需身份验证。漏洞的严重性评级为 Critical (CVSS 9.8)。根据搜索结果，该漏洞容易被利用，且已被积极利用。提供的漏洞利用代码链接使用短链接（bit.ly），存在潜在的投毒风险，因为无法直接审查下载文件的内容，增加了恶意软件或后门的风险。即使下载了名为 'exploit.py' 的文件，其真实行为也可能与预期不符。从描述中，`exploit.py -h 10.10.10.10 -c 'uname -a'`的调用方式来看，`-h` 参数是目标地址，`-c` 参数是想要执行的命令。漏洞利用方式是通过fgfmd守护进程中的格式化字符串漏洞，通过精心设计的请求发送格式化字符串payload，最终实现远程代码执行。虽然代码仓库本身可能包含可行的漏洞利用方式，但由于使用短链接分发，代码被篡改的风险较高，因此评判为有较高的投毒风险。

**项目地址:** [expl0itsecurity/CVE-2024-23113](https://github.com/expl0itsecurity/CVE-2024-23113)

**漏洞详情:** [CVE-2024-23113](https://nvd.nist.gov/vuln/detail/CVE-2024-23113)