## CVE-2016-2098-Ruby on Rails-远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 3.2.22.2, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且允许通过URL参数控制render方法。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞，源于对`render`方法的不受限制的使用。攻击者可以通过构造恶意的URL参数，将Ruby代码注入到`render`方法中执行，从而获得服务器的控制权。

**有效性：**
提供的POC代码`CVE-2016-2098.py`看起来是有效的。它使用`requests`库发送带有恶意参数的GET请求，其中参数值包含要执行的Ruby代码。Payload 构造的核心在于 `#{sys.argv[3]}[inline]=%3C%25=%20%25x({cmd})%20%25%3E` ，这部分代码将命令插入到ERB模板中，利用Rails的render方法执行任意代码。

**投毒风险：**
提供的漏洞利用代码中没有发现明显的投毒代码。该脚本的主要功能是发送包含恶意payload的HTTP请求，并打印响应结果。`README.md`文件仅包含漏洞名称和POC描述，没有可疑内容。因此，投毒风险较低，为0%。

**利用方式：**
1.  **确定目标应用是否使用了存在漏洞的Rails版本。**
2.  **构造包含恶意Ruby代码的URL参数。** 例如，使用提供的POC脚本：
    `python CVE-2016-2098.py 'system("whoami")' 'http://target.com/controller/action' 'payload'`
    这个命令会在目标服务器上执行`whoami`命令，并将结果返回。
3.  **发送包含恶意参数的HTTP请求。**
4.  **分析响应结果，确认代码是否成功执行。**

攻击者可以利用此漏洞执行任意系统命令，读取敏感文件，甚至完全控制服务器。修复此漏洞的方法是升级到受影响Rails版本以上的版本，或者限制对render方法的使用。

**项目地址:** [Shakun8/CVE-2016-2098](https://github.com/Shakun8/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)