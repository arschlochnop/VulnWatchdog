## CVE-2023-41425-WonderCMS-XSS

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** WonderCMS

**危害等级:** 中危，可能导致用户信息泄露和远程代码执行

**影响版本:** 3.2.0 - 3.4.2

**利用条件:** 需要WonderCMS运行在目标服务器上，且目标用户访问恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425是WonderCMS 3.2.0到3.4.2版本中存在的跨站脚本漏洞。攻击者可以通过上传精心制作的脚本到installModule组件来执行任意代码。根据提供的Nmap脚本（cve-2023-41425.nse），该漏洞利用方式是反射型XSS。攻击者需要诱导用户点击包含恶意JavaScript代码的链接。该脚本首先构造一个包含JavaScript代码的URL，该JavaScript代码指向攻击者控制的服务器上的恶意脚本（malicious.js）。如果目标服务器存在漏洞，并且用户访问了该URL，则恶意JavaScript代码将在用户的浏览器中执行，攻击者可能控制用户的会话、窃取敏感信息或进一步利用系统，如安装webshell。根据描述，webshell可能位于`/themes/pwned/malicious.php`。漏洞利用代码中指定攻击者IP地址和端口，这部分存在一定风险，如果恶意代码被托管，则利用过程中可能会存在投毒风险，但是主要风险源自托管的`malicious.js`。因此，这里判断投毒风险较低，为10%。

根据搜索引擎的结果，很多网页都描述了此漏洞，并指向了相关的PoC代码。这表明该漏洞的细节已经被广泛公开，并且存在可用的PoC。github上的链接可能包含更多关于如何利用此漏洞的信息。

**漏洞利用方式:**

1.  攻击者构造一个包含恶意JavaScript代码的URL。
2.  攻击者将此URL发送给目标用户。
3.  如果目标用户点击此URL，并且目标WonderCMS服务器存在漏洞，则恶意JavaScript代码将在用户的浏览器中执行。
4.  恶意JavaScript代码可以执行任意操作，例如窃取用户的会话信息、修改网页内容或安装恶意软件。
5. 攻击者将恶意js托管到自己的服务器上，当用户访问构造的URL时，会加载攻击者的js脚本，从而达到远程代码执行的目的。

**项目地址:** [becrevex/CVE-2023-41425](https://github.com/becrevex/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)