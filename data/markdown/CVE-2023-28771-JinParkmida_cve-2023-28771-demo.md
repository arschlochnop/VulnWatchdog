## CVE-2023-28771 - Zyxel防火墙远程命令注入

**漏洞编号:** CVE-2023-28771

**漏洞类型:** 远程命令注入

**影响应用:** Zyxel ZyWALL/USG, VPN, USG FLEX, ATP系列防火墙

**危害等级:** 严重，未经身份验证的攻击者可执行任意OS命令

**影响版本:** ZyWALL/USG: 4.60-4.73, VPN/USG FLEX/ATP: 4.60-5.35

**利用条件:** 目标设备在受影响版本范围内，且攻击者可访问设备的网络端口（通常是UDP 500，用于IKE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-28771是一个存在于Zyxel防火墙中的远程命令注入漏洞。未经身份验证的攻击者可以向受影响的设备发送特制的IKEv2数据包来执行任意操作系统命令。漏洞位于对错误消息的处理上。该漏洞通过发送特制的IKE数据包利用，其中包含经过DES-CBC加密的数据和Shell元字符的注入，然后触发system()函数执行命令。搜索结果表明该漏洞已被广泛利用，例如Mirai僵尸网络。提供的PoC代码（cve-2023-28771-demo.tsx）似乎是一个模拟的取证平台，展示了漏洞分析的过程，并没有实际的漏洞利用代码。PoC代码展示了对IKEv2数据包的分析，包括对加密数据的处理，以及对提取的命令的展示。代码本身不包含任何直接利用漏洞或创建后门的代码。投毒风险评估：PoC代码主要用于演示和分析，本身并没有直接进行恶意操作的函数，因此投毒风险较低，约10%。风险主要来源于代码本身的潜在缺陷或被篡改的可能性。

**项目地址:** [JinParkmida/cve-2023-28771-demo](https://github.com/JinParkmida/cve-2023-28771-demo)

**漏洞详情:** [CVE-2023-28771](https://nvd.nist.gov/vuln/detail/CVE-2023-28771)