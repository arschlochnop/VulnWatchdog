## CVE-2025-34030-sar2html-OS命令注入

**漏洞编号:** CVE-2025-34030

**漏洞类型:** OS命令注入

**影响应用:** sar2html

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 3.2.2

**利用条件:** 需要目标系统安装sar2html且版本符合漏洞范围，并可通过HTTP(S)访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于sar2html <= 3.2.2版本的index.php中，由于对`plot`参数的输入未进行充分的过滤，导致攻击者可以通过构造包含恶意命令的GET请求（例如，`index.php?plot=;id`）来执行任意系统命令。漏洞利用代码`exploit.py`利用了此漏洞，通过向目标URL的`plot`参数注入经过URL编码的反向shell命令，尝试建立反向shell连接。  

**有效性:** 根据漏洞描述和提供的POC代码，可以判断POC代码是有效的。代码中包含了利用该漏洞的Python脚本，脚本通过构造包含恶意payload的HTTP GET请求来执行系统命令。脚本还包含了一些检查机制，例如，检查目标是否存活，以及通过执行`id`命令来验证漏洞是否存在。  

**投毒风险:**  对`exploit.py`代码进行了分析，未发现明显的投毒代码。脚本的主要功能是利用已知的OS命令注入漏洞，虽然恶意使用者可以修改脚本payload部分植入后门，但原作者本身植入风险较低，只有极低的可能存在通过`requests`库等引入的间接供应链投毒风险，故评估投毒风险为5%。

**利用方式:**
1.  使用提供的`exploit.py`脚本。
2.  指定目标sar2html实例的URL（`--url`参数，例如：`http://vulnerable.com/index.php?id=test`）。
3.  指定攻击者的监听IP地址（`--lhost`参数）。
4.  指定攻击者的监听端口（`--lport`参数，默认为1337）。
5.  运行脚本，脚本将尝试利用漏洞在目标系统上执行命令，并建立一个反向shell连接到攻击者的监听IP地址和端口。
6.  确保攻击者已经设置好相应的监听器（例如，使用`nc -lvnp 1337`）以接收反向shell连接。

**项目地址:** [HackerTyperAbuser/CVE-2025-34030-PoC](https://github.com/HackerTyperAbuser/CVE-2025-34030-PoC)

**漏洞详情:** [CVE-2025-34030](https://nvd.nist.gov/vuln/detail/CVE-2025-34030)