## CVE-2019-5418-Rails文件内容泄露

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**利用条件:** 需要目标系统存在Rails应用且受到影响的版本，攻击者能够发送特制的Accept头

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418是一个Rails Action View的文件内容泄露漏洞，攻击者可以通过构造恶意的Accept头，结合`render file:`调用，读取目标服务器上的任意文件。提供的PoC代码（基于Rails 3）旨在验证此漏洞。漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且有公开的利用方法。

**有效性评估：**
根据漏洞信息，PoC代码（特别是`Rails 3 PoC of CVE-2019-5418`的描述和`demo`目录下的文件结构）以及搜索引擎结果，可以判断提供的PoC代码是有效的，能够验证CVE-2019-5418漏洞在Rails 3上的存在。漏洞利用依赖于特制的Accept header，允许读取服务器上的任意文件。

**投毒风险评估：**
分析提供的Dockerfile、README.md、Gemfile、Gemfile.lock、Rakefile和配置文件等，没有发现任何明显的恶意代码或后门。Dockerfile主要用于构建包含易受攻击Rails版本的Docker镜像，以便进行漏洞验证。Gemfile指定了Rails的版本和依赖项，没有包含任何可疑的gem。README.md 只是PoC的说明文档。因此，可以认为此仓库中存在作者隐藏的投毒代码的风险非常低，接近于0%。

**利用方式分析：**
1.  **目标确定：** 确定运行存在漏洞版本Rails的应用。
2.  **构造恶意Accept头：** 构造包含恶意文件路径的Accept头，例如`Accept: ../../../../../etc/passwd`。
3.  **发送请求：** 向目标服务器发送包含恶意Accept头的HTTP请求。
4.  **读取文件内容：** 如果服务器存在漏洞，服务器将返回被请求文件的内容。

**项目地址:** [ztgrace/CVE-2019-5418-Rails3](https://github.com/ztgrace/CVE-2019-5418-Rails3)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)