## CVE-2023-4911 Looney Tunables 本地提权漏洞

**漏洞编号:** CVE-2023-4911

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc (ld.so)

**危害等级:** 高危，本地权限提升

**影响版本:** 2.34 < version < 2.39

**利用条件:** 本地用户，需要存在SUID权限的程序

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4911 "Looney Tunables" 是glibc动态链接器ld.so中存在的缓冲区溢出漏洞。攻击者可以通过设置恶意的GLIBC_TUNABLES环境变量，在运行具有SUID权限的程序时，利用该漏洞执行任意代码，从而提升权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已经被公开披露，并且存在可用的PoC利用代码。从搜索结果来看，各大安全厂商（Qualys, Sysdig, Uptycs, Elastic等）均对此漏洞进行了分析和跟踪，CISA也将其列入已知被利用漏洞目录。因此，提供的PoC代码很可能有效。

**投毒风险：**
提供的“漏洞利用代码”实际上是 GNU GPL v3 许可协议的文本。这个文件本身没有可执行代码，因此不存在投毒风险。投毒风险为0%。实际漏洞利用代码需要构造特定的GLIBC_TUNABLES环境变量，并配合SUID程序才能触发。

**利用方式：**
1.  **利用方式:** 攻击者需要拥有本地账户权限。
2.  **环境变量设置:** 设置GLIBC_TUNABLES环境变量，构造特定的字符串，使其在ld.so处理时发生缓冲区溢出。
3.  **触发SUID程序:** 运行具有SUID权限的程序，触发动态链接器ld.so加载glibc，并处理GLIBC_TUNABLES环境变量。
4.  **权限提升:**  利用缓冲区溢出，覆盖内存中的关键数据，劫持程序执行流程，从而执行任意代码，提升到SUID程序的所有者权限（通常是root权限）。

**优先级:** 漏洞库信息、搜索结果和漏洞利用代码（GPL许可）均表明该漏洞是一个严重的安全问题，应该优先修复。

**总结:** CVE-2023-4911 是一个高危的本地提权漏洞，利用难度相对较低，影响范围较广。 建议尽快升级glibc版本或采取缓解措施。

**项目地址:** [chaudharyarjun/LooneyPwner](https://github.com/chaudharyarjun/LooneyPwner)

**漏洞详情:** [CVE-2023-4911](https://nvd.nist.gov/vuln/detail/CVE-2023-4911)