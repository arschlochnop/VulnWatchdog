## CVE-2019-12840 - Webmin Package Updates 远程命令执行

**漏洞编号:** CVE-2019-12840

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.910

**利用条件:** 需要Webmin用户拥有Package Updates模块的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-12840 允许拥有 'Package Updates' 模块权限的 Webmin 用户通过 `update.cgi` 的 `data` 参数执行任意命令，且该命令以 root 权限执行。

**有效性:**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性很高。多个来源都确认了该漏洞的存在，并且提供了利用该漏洞的 POC 代码。

**投毒风险:**

对提供的 POC 代码进行分析，未发现明显的恶意投毒代码。脚本的主要功能是：

1.  禁用 SSL 证书验证 (urllib3.disable_warnings(), session.verify = False)
2.  使用提供的用户名和密码登录 Webmin (session.post(webmin_url))
3.  构造包含命令的 POST 请求发送到 `package-updates/update.cgi` (session.post(package_url))
4.  提取并打印命令的执行结果（html.unescape(re.findall(...))）

脚本本身的功能是利用漏洞，没有发现额外隐藏的恶意代码或行为。README.md 文件只是描述了 POC 的用途和 CVE 编号。

**利用方式:**

1.  攻击者需要拥有 Webmin 的有效用户名和密码，并且该用户必须被授权使用 'Package Updates' 模块。
2.  攻击者使用提供的 POC 脚本（或其他类似的工具）登录 Webmin。
3.  POC 脚本构造一个包含恶意命令的 POST 请求，并将该请求发送到 `/package-updates/update.cgi`。
4.  Webmin 执行该命令，并将结果返回给攻击者。

漏洞利用的关键在于 `update.cgi` 没有正确地对 `data` 参数进行过滤，导致攻击者可以注入任意命令。由于 Webmin 以 root 权限运行，因此攻击者执行的命令也具有 root 权限。

**项目地址:** [WizzzStark/CVE-2019-12840.py](https://github.com/WizzzStark/CVE-2019-12840.py)

**漏洞详情:** [CVE-2019-12840](https://nvd.nist.gov/vuln/detail/CVE-2019-12840)