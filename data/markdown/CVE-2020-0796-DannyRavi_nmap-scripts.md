## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1903/1909, Windows Server version 1903/1909

**利用条件:** 目标系统启用 SMBv3 且未打补丁，需要网络访问445端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名 SMBGhost，是一个存在于 Microsoft Server Message Block 3.1.1 (SMBv3) 协议中的远程代码执行漏洞。该漏洞是由于 SMBv3 协议处理特定请求的方式不正确造成的。未经身份验证的攻击者可以通过发送特制的 SMBv3 数据包到存在漏洞的服务器来利用此漏洞，成功利用可能导致远程代码执行。

**有效性:**
根据漏洞信息和搜索结果，该漏洞存在公开可用的 PoC 代码，表明该漏洞具有较高的可利用性。提供的漏洞利用代码（cve-2020-0796.nse）是一个 Nmap 脚本，用于检测目标系统是否存在 CVE-2020-0796 漏洞。它通过发送特定的 SMBv3 请求并分析响应来判断目标是否易受攻击。该脚本本身并不能直接执行代码，而是用于识别潜在的攻击目标，因此，直接判断PoC是否有效需要实际运行此Nmap脚本或者其他RCE的POC。

**投毒风险:**
分析提供的代码，该仓库中包含一个 Nmap 脚本和一个 License 文件，以及其他漏洞的检测脚本。主要风险在于 Nmap 脚本中可能包含恶意代码，比如未经授权的信息收集或拒绝服务攻击。虽然脚本的主要目的是检测漏洞，但潜在的投毒风险仍然存在。综合评估，认为投毒风险为10%，因为此脚本主要是用于检测。

**利用方式:**
1.  **漏洞检测:** 使用 Nmap 脚本 (cve-2020-0796.nse) 扫描目标网络，识别存在 CVE-2020-0796 漏洞的系统。
2.  **漏洞利用:** 如果目标系统被确认为易受攻击，攻击者可以使用公开可用的远程代码执行 PoC 代码来利用该漏洞。这些 PoC 代码通常涉及发送特制的 SMBv3 数据包到目标服务器，触发缓冲区溢出或其他内存损坏错误，从而允许攻击者执行任意代码。
3.  **权限提升:** 成功执行远程代码后，攻击者可能会尝试提升其权限，例如，从普通用户权限提升到 SYSTEM 权限，以便完全控制受感染的系统。
4.  **横向移动:** 控制一台系统后，攻击者可能会利用该系统作为跳板，进一步攻击网络中的其他系统，从而扩大攻击范围。

**项目地址:** [DannyRavi/nmap-scripts](https://github.com/DannyRavi/nmap-scripts)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)