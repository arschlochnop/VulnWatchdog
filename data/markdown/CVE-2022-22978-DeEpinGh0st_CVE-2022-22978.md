## CVE-2022-22978-Spring Security权限绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 权限绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** Spring Security 5.5.x < 5.5.7, Spring Security 5.6.x < 5.6.4, Spring security versions 5.4.x prior to 5.4.11+ and all earlier unsupported versions

**利用条件:** 使用了RegexRequestMatcher，并且正则表达式中包含"."

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22978 是 Spring Security 中的一个权限绕过漏洞。当使用 RegexRequestMatcher 并配置不当，特别是当正则表达式包含`.`时，可能被绕过。攻击者可以通过构造包含换行符（%0a）的恶意请求，绕过身份验证。提供的POC Dockerfile 描述了如何构建和运行受影响的 Spring Security 应用程序的镜像。README.md 文件展示了如何使用 payload `http://localhost:8080/admin/index%0a` 绕过身份验证访问 /admin/index 路径。尽管POC文件mvnw 是 Maven 的包装脚本，通常用于构建项目，但该脚本本身没有明显的投毒迹象。但是，考虑到代码仓库的复杂性，以及自动构建过程中可能存在的风险，例如，构建时可以执行任意命令，因此仍然存在一定的投毒风险。此风险很低，约为5%，因为没有直接证据表明存在恶意代码。利用方式是发送带有换行符的恶意请求，绕过 RegexRequestMatcher 的检查。

**项目地址:** [DeEpinGh0st/CVE-2022-22978](https://github.com/DeEpinGh0st/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)