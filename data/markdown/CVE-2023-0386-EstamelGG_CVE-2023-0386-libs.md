## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel OverlayFS

**危害等级:** 高危，可导致本地用户权限提升至root

**影响版本:** Linux kernel 6.2-rc6 (受影响版本)

**利用条件:** 需要本地用户权限，系统开启OverlayFS

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386是Linux内核OverlayFS子系统中的一个权限提升漏洞。该漏洞允许本地用户通过利用uid映射中的bug，将具有capability的文件从nosuid挂载复制到另一个挂载，从而提升权限。

**有效性分析：**
提供的POC代码是一个FUSE文件系统，它模拟了一个包含SUID文件的环境。该SUID文件被设计成执行一个shell。攻击者可以通过OverlayFS将这个SUID文件复制到其他位置并执行，从而提升权限。根据搜索引擎结果和漏洞描述，此漏洞利用方式是有效的。

**投毒风险分析：**
代码本身看起来比较直接，主要功能是创建具有特定权限的文件，并利用OverlayFS的特性进行提权。代码中存在使用`rand()`函数生成随机字符串作为目录名。虽然`rand()`的安全性不高，但是此次作为目录名，可以忽略不计。shellcode简单，功能明确。因此，投毒的可能性极低，可以忽略不计。

**利用方式：**
1.  运行POC代码，它会创建一个FUSE文件系统。
2.  在FUSE文件系统中，会创建一个具有SUID权限的可执行文件。
3.  利用OverlayFS将该SUID文件复制到文件系统的其他位置。
4.  执行复制后的SUID文件，由于OverlayFS的权限处理不当，攻击者可以获得提升的权限。

**项目地址:** [EstamelGG/CVE-2023-0386-libs](https://github.com/EstamelGG/CVE-2023-0386-libs)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)