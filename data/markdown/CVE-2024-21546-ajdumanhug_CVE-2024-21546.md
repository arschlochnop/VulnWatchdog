## CVE-2024-21546-laravel-filemanager-RCE

**漏洞编号:** CVE-2024-21546

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** unisharp/laravel-filemanager

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** < 2.9.1

**利用条件:** 需要能够上传文件到文件管理器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21546 是一个存在于 unisharp/laravel-filemanager 2.9.1 之前版本中的远程代码执行漏洞。攻击者可以通过上传具有有效MIME类型并包含`.`字符的PHP文件来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的利用是可行的。虽然提供的POC代码 `/tmp/47abf6241e5b58a0b970a3430f025834/README.md` 仅仅是一个 README 文件，并没有包含直接的利用代码，但是漏洞库信息和搜索结果都确认了漏洞的存在并且可以被利用。 漏洞库信息和搜索结果提及利用方式是上传具有正确MIME类型和包含`.`的恶意文件，因此可以确定漏洞利用是有效的，该poc文件只是漏洞验证的一个辅助说明。

**投毒风险：**
提供的 POC 代码文件内容为一个 README 文件，从内容上分析，该文件本身不包含任何恶意代码或后门。但是，整个仓库可能存在其他隐藏的恶意代码。由于仅给出了一个 README 文件，无法全面评估整个仓库，假设性认为存在一定概率的投毒风险，评估为10%。 需要进一步分析整个仓库的代码才能确定是否存在投毒风险。

**利用方式：**
1.  **上传恶意文件：** 攻击者需要上传一个精心构造的文件，该文件需要满足以下条件：
    *   **有效的 MIME 类型：** 文件必须具有服务器能够识别和接受的 MIME 类型。这可能需要攻击者进行一些侦察，以确定服务器允许的 MIME 类型。
    *   **PHP 文件扩展名：** 文件名需要包含 PHP 文件扩展名，例如 `.php`。
    *   **插入 `.` 字符：** 在 PHP 文件扩展名之前插入 `.` 字符，例如 `shell.php.` 。这个点似乎是绕过服务器端文件扩展名检查的关键。
2.  **服务器执行代码：** 当服务器处理上传的文件时，由于漏洞的存在，会将该文件作为 PHP 代码执行。这允许攻击者在服务器上执行任意代码。

总而言之，攻击者利用文件上传功能，绕过服务器的文件扩展名检查，最终达到远程代码执行的目的。

**项目地址:** [ajdumanhug/CVE-2024-21546](https://github.com/ajdumanhug/CVE-2024-21546)

**漏洞详情:** [CVE-2024-21546](https://nvd.nist.gov/vuln/detail/CVE-2024-21546)