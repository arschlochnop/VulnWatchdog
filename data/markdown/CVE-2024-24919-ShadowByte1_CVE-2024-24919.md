## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露 (路径遍历)

**影响应用:** Check Point Quantum Gateway, Spark Gateway, CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway, CloudGuard Network); R81.10, R80.20 (Spark Gateway)

**利用条件:** 目标设备已连接到互联网，并启用了远程访问 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-24919 漏洞是一个存在于 Check Point Security Gateway 中的信息泄露漏洞，允许未经身份验证的远程攻击者读取目标设备上的任意文件内容。根据 Truesec 的博客文章，这是一个路径遍历漏洞，攻击者可以访问 Gaia OS 上的所有文件（即 expert mode）。Rapid7 和 Qualys 的报告也证实了该漏洞允许读取任意文件。提供的 Exploit.yaml 文件展示了使用 POST 请求，通过 'MyCRL' 接口，利用路径遍历（`aCSHELL/../../../../../../../etc/shadow`）来读取 `/etc/shadow` 文件的 PoC。该PoC通过匹配body中是否存在'root:'和'nobody:'字符串来判断漏洞是否成功利用。由于提供的YAML文件仅包含漏洞利用请求和验证逻辑，没有发现任何隐藏的恶意代码或后门，因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送特制的 HTTP POST 请求到 `/clients/MyCRL` 接口。
2.  POST 请求的 body 包含一个路径遍历字符串，例如 `aCSHELL/../../../../../../../etc/shadow`，试图访问目标文件系统上的敏感文件，如 `/etc/shadow`。
3.  如果漏洞存在，服务器将返回包含被请求文件内容（例如 `/etc/shadow`）的响应。
4.  攻击者通过分析响应内容提取敏感信息。

**项目地址:** [ShadowByte1/CVE-2024-24919](https://github.com/ShadowByte1/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)