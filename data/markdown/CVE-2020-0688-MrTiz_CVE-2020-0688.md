## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可完全控制 Exchange 服务器

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要有效的 Exchange 用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 在处理 ViewState 时使用了静态密钥进行加密和签名。攻击者如果拥有有效的 Exchange 用户凭据，就可以利用该密钥构造恶意的 ViewState，从而在服务器上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断该漏洞利用是有效的。许多安全厂商和研究人员都发布了关于该漏洞的报告和 PoC，表明该漏洞已经得到广泛证实。

**投毒风险：**

提供的 PowerShell PoC 代码主要功能是利用已知的静态密钥来构造恶意的 ViewState，并在目标 Exchange 服务器上执行任意命令。代码中包含了身份验证、ViewState 生成、Payload 加密等步骤，没有发现明显的恶意代码或后门。但是，任何公开的漏洞利用代码都存在被篡改或植入恶意代码的风险，所以仍有一定的投毒可能性，大约10%。

**利用方式：**

1.  **获取 Exchange 用户凭据：** 攻击者首先需要获得一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测等方式实现。
2.  **确定 ECP URL：** 攻击者需要确定目标 Exchange 服务器的 ECP URL，例如 `https://example.com/ecp`。
3.  **生成恶意 ViewState：** 利用 PoC 代码（例如提供的 PowerShell 脚本）结合 Ysoserial.exe 工具，使用静态密钥构造包含恶意命令的 ViewState。
4.  **发送请求：** 将包含恶意 ViewState 的请求发送到 ECP 页面，例如 `https://example.com/ecp/default.aspx`。
5.  **执行代码：** Exchange 服务器在处理请求时，会反序列化恶意 ViewState，从而执行攻击者指定的代码。

**缓解措施：**

*   立即安装 Microsoft 发布的 CVE-2020-0688 安全更新。
*   如果无法立即安装更新，可以采取临时缓解措施，例如禁用 ECP 访问或更改静态密钥。

**项目地址:** [MrTiz/CVE-2020-0688](https://github.com/MrTiz/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)