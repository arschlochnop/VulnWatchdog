## CVE-2025-29972-Azure Storage Resource Provider Spoofing Vulnerability

**漏洞编号:** CVE-2025-29972

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Azure Storage Resource Provider (SRP)

**危害等级:** 高危，可能导致信息泄露、权限提升和未经授权的访问

**影响版本:** N/A

**利用条件:** 需要获得授权的攻击者才能利用，且目标系统存在漏洞

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-29972 是 Azure Storage Resource Provider (SRP) 中的一个服务器端请求伪造 (SSRF) 漏洞。 具有授权凭证的攻击者可以利用此漏洞通过网络执行欺骗攻击。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个高危级别的 SSRF 漏洞，CVSS 评分为 9.9。漏洞利用代码声称是针对 CVE-2025-29927 Next.js中间件绕过漏洞的POC。然而，漏洞库信息和搜索结果表明，CVE-2025-29972 漏洞与 Azure Storage Resource Provider 的 SSRF 相关，而提供的漏洞利用代码似乎针对的是 Next.js 中间件绕过，两者描述不符。因此提供的POC代码对于验证CVE-2025-29972是无效的。

**投毒风险分析：**
提供的漏洞利用代码包含一个 `exploit.py` 脚本，该脚本尝试通过发送带有特定 header（`x-middleware-subrequest`）的 HTTP 请求来绕过 Next.js 中间件。 代码中存在以下潜在的投毒风险：

1.  **错误的CVE编号和描述：**README.md 中描述漏洞编号为CVE-2025-29927，但实际上应该为CVE-2025-29972，但是代码库名称为CVE-2025-29972。这本身可能是一种混淆，误导用户，让人误以为该脚本针对特定漏洞，实则不然。
2.  **网络连接风险：** 该脚本包含建立网络连接的代码。攻击者可能会修改脚本，使其连接到恶意服务器，从而窃取敏感信息或执行其他恶意操作。例如，将目标hostname设置为攻击者控制的服务器。
3.  **文件写入风险：** 脚本包含将响应体保存到文件的功能。攻击者可能会修改脚本，使其写入恶意内容到文件中，例如包含恶意 JavaScript 代码的 HTML 文件，从而进行跨站脚本攻击 (XSS)。

此外，虽然脚本本身看起来比较简单，但仍然存在被修改为恶意用途的可能性。尤其是，脚本中的 hostname 参数如果被指向攻击者控制的服务器，则可能导致信息泄露。综上所述，考虑到代码的混淆性、潜在的网络连接风险以及文件写入风险，该漏洞利用代码的投毒风险较高，约为 95%。

**利用方式：**
由于提供的POC代码不是针对CVE-2025-29972的，所以我们根据漏洞库信息和搜索结果推断利用方式如下：

1.  **攻击者利用授权凭证：** 攻击者首先需要获得 Azure 账户的授权凭证，例如用户名和密码、访问密钥等。
2.  **构造恶意请求：** 攻击者构造一个包含恶意 URL 的请求，该 URL 指向内部服务或外部资源。
3.  **发送请求：** 攻击者将构造的恶意请求发送到 Azure Storage Resource Provider。
4.  **SSRF 攻击：** Azure Storage Resource Provider 在收到恶意请求后，会向攻击者指定的 URL 发起请求，从而实现 SSRF 攻击。攻击者可以利用 SSRF 漏洞读取内部服务的数据、执行命令或者扫描内部网络。

由于该漏洞为SSRF，攻击者可以利用它来访问通常无法从外部访问的内部资源，从而可能导致信息泄露和权限提升。

**项目地址:** [TH-SecForge/CVE-2025-29972](https://github.com/TH-SecForge/CVE-2025-29972)

**漏洞详情:** [CVE-2025-29972](https://nvd.nist.gov/vuln/detail/CVE-2025-29972)