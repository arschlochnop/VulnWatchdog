## CVE-2025-31324-SAP NetWeaver Visual Composer Metadata Uploader 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 需要网络访问目标服务器，且目标服务器运行受影响的SAP NetWeaver Visual Composer版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的POC代码，漏洞CVE-2025-31324是一个存在于SAP NetWeaver Visual Composer Metadata Uploader中的未授权文件上传漏洞。攻击者无需身份验证即可上传恶意文件，例如JSP webshell，到服务器上的特定目录（`/sap/public/bc/webdynpro/sap/public/bc/zmetadata_upload`）。

**有效性：**
搜索引擎结果显示该漏洞已被积极利用，多个安全厂商发布了相关的分析和检测方法。提供的POC代码也表明了漏洞的可利用性，包含用于检查漏洞存在的OAST（Out-of-band Application Security Testing）验证模式，以及通过上传指定文件进行漏洞利用的模式。`sap_vc_poc.py`脚本包含实现漏洞利用所需的核心逻辑，例如构建恶意请求、处理SSL证书等。文件`helper.jsp`提供了一个简单的webshell，允许执行任意命令。

**投毒风险：**
对提供的POC代码进行了分析，发现以下潜在风险点：
* `PAYLOAD_TEMPLATE_B64`: 脚本中包含一个base64编码的Java序列化payload，攻击者可以使用它执行任意代码。该payload本身如果来路不明，或者被替换成恶意payload，则会具有潜在的投毒风险。
* webshell(helper.jsp)本身存在被恶意利用的风险,例如被投毒者利用来植入后门,持续控制目标系统。此外，OAST检查模式依赖于外部OAST服务器，攻击者可能会利用这一点来收集信息。
结合这些因素，我估计投毒风险为 10%。

**利用方式：**
1.  **OAST验证模式：** 使用POC脚本检查目标是否存在漏洞，利用Java反序列化Payload，并配合OAST服务来验证漏洞的存在。
2.  **Exploit模式：** 使用POC脚本上传恶意文件(例如JSP webshell,helper.jsp)到目标服务器的指定目录。
3.  **远程代码执行：** 通过访问上传的webshell，执行任意命令，从而完全控制目标系统。

**项目地址:** [nullcult/CVE-2025-31324-File-Upload](https://github.com/nullcult/CVE-2025-31324-File-Upload)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)