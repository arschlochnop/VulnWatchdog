## CVE-2018-16763 - Fuel CMS 1.4.1 远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Fuel CMS

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 1.4.1

**利用条件:** 目标系统运行 Fuel CMS 1.4.1 并且存在网络可达性。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-16763 漏洞存在于 Fuel CMS 1.4.1 中，允许攻击者通过 `pages/select/` 的 `filter` 参数或 `preview/` 的 `data` 参数执行任意 PHP 代码，从而实现未经身份验证的远程代码执行。

**漏洞利用方式：**

1.  **上传 Webshell：**
    *   利用 `filter` 参数的 PHP 代码注入漏洞，上传一个 PHP Webshell 到服务器上。
    *   POC 代码中使用 `file_put_contents` 函数将 Webshell 内容写入到服务器的文件系统中。
    *   攻击者通过构造包含特定 PHP 代码的 URL，例如：`http://127.0.0.1:10080/fuel/pages/select/?filter=%27%2Bpi%28print%28%24a%3D%27file%5Fput%5Fcontents%27%29%29%2B%24a%28%24%5FPOST%5B%22d0eb3f9a%22%5D%2C%24%5FPOST%5B%229bc30f43%22%5D%29%2B%27`，并配合 POST 请求，将 Webshell 内容写入指定的文件。

2.  **执行命令/下载文件：**
    *   上传 Webshell 之后，攻击者可以通过访问 Webshell，并传递 `action=exec` 和 `cmd` 参数来执行系统命令。
    *   也可以通过传递 `action=download` 和 `path` 参数来下载服务器上的文件。
    *   例如，执行 `id` 命令：`curl -X POST 'http://127.0.0.1:10080/c1f3e834b49c4e548ebde7f596028f5b.php' --data "action=exec&cmd=id"`
    *   下载 `/etc/passwd` 文件：`curl -X POST 'http://127.0.0.1:10080/c1f3e834b49c4e548ebde7f596028f5b.php' --data "action=download&path=/etc/passwd" -o-`

**投毒风险分析：**

*   该 POC 主要是利用已知的 RCE 漏洞，通过上传 Webshell 来执行命令或下载文件。`console.py`脚本用于自动化利用过程，并非恶意代码。但仍存在很小的投毒风险（5%），比如：
    *   **依赖风险：** `console.py` 脚本依赖 `requests` 库。如果作者有意投毒，可以修改脚本，使其依赖一个包含恶意代码的恶意 `requests` 库的变种（例如，通过 PyPI 上的名称混淆），诱导用户安装。
    *   **后门维护：** 虽然主要功能是利用漏洞，但上传的 Webshell 本身可能包含一些不易察觉的后门，允许作者在之后维持访问权限。
    *   **版本依赖陷阱：** 脚本可能包含版本检查，如果用户环境不满足特定版本要求，可能触发一些恶意行为。

**总结：**

该漏洞利用代码有效，允许未经授权的远程代码执行。 虽然直接的恶意代码的可能性较低，但仍然需要仔细审查和使用，以防范潜在的依赖项和后门风险。尤其需要注意 Webshell 的内容。

**项目地址:** [p0dalirius/CVE-2018-16763-FuelCMS-1.4.1-RCE](https://github.com/p0dalirius/CVE-2018-16763-FuelCMS-1.4.1-RCE)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)