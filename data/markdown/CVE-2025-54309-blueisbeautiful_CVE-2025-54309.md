## CVE-2025-54309-CrushFTP-AS2认证绕过

**漏洞编号:** CVE-2025-54309

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，允许未授权用户获得管理员权限

**影响版本:** CrushFTP 10 before 10.8.5 and 11 before 11.3.4_23

**利用条件:** 目标CrushFTP服务器未启用DMZ代理功能，且允许HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54309 是 CrushFTP 中的一个认证绕过漏洞。攻击者可以通过发送包含特定格式 `AS2-To` 头的 HTTP 请求，绕过身份验证检查，获取管理员权限。具体来说，当 `AS2-To` 头部的值不包含 `-_-` 分隔符，并且配置项 `blank_passwords` 被禁用（默认禁用）时，`loginCheckHeaderAuth()` 方法会提前返回，跳过身份验证过程。

**利用方式：**

1.  攻击者构造一个带有 `AS2-To` 头的 HTTP 请求，该头的值不包含 `-_-` 分隔符（或为空）。
2.  将此请求发送到目标 CrushFTP 服务器。
3.  由于身份验证检查被绕过，攻击者可以访问需要管理员权限的功能，例如创建新用户。
4.  通过 `setUserItem()` 方法，攻击者可以创建一个新的管理员用户，而无需提供有效凭据。

**投毒风险：**

虽然提供的代码片段主要描述了漏洞的原理和利用方式，但仍存在一定的投毒风险。LICENSE文件声明了MIT开源协议，但作者署名为kali,可能存在代码贡献者不明确问题。同时,代码的真实来源需要进一步验证,有可能被植入恶意后门或存在其他隐蔽的攻击向量。鉴于此，判定投毒风险为10%。需要对完整的代码库进行更深入的审查才能确定是否存在恶意代码。

**项目地址:** [blueisbeautiful/CVE-2025-54309](https://github.com/blueisbeautiful/CVE-2025-54309)

**漏洞详情:** [CVE-2025-54309](https://nvd.nist.gov/vuln/detail/CVE-2025-54309)