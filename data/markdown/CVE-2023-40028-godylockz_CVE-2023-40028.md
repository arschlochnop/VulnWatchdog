## CVE-2023-40028-Ghost-任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost CMS

**危害等级:** 中危，可读取服务器敏感信息

**影响版本:** < 5.59.1

**利用条件:** 需要具有Ghost CMS后台的高权限用户账号

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-40028是Ghost CMS中存在的任意文件读取漏洞。攻击者需要首先拥有Ghost CMS的管理员权限，然后可以上传包含指向系统敏感文件的符号链接的zip文件。Ghost CMS会解压上传的zip文件，而没有正确地验证符号链接的目标，从而导致攻击者可以读取服务器上的任意文件。该漏洞利用的关键在于上传包含恶意构造的符号链接的ZIP文件，绕过Ghost的文件上传安全检查。

**漏洞利用方式：**

1.  攻击者利用Ghost CMS后台管理员权限登录。
2.  攻击者构造一个ZIP文件，其中包含指向目标文件的符号链接（例如`/etc/passwd`）。
3.  攻击者将ZIP文件上传到Ghost CMS。
4.  Ghost CMS解压ZIP文件，符号链接被创建。
5.  攻击者通过访问该符号链接，读取目标文件。

**POC有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码有效。搜索引擎结果中存在多个关于CVE-2023-40028的PoC，并且漏洞库信息也确认了该漏洞的存在和利用方式。

**投毒风险分析：**

提供的POC代码片段包含文件上传、ZIP文件构造和身份验证功能。尽管代码相对完整，但为了判断投毒风险，需要对整个`ghost_fileread.py`脚本进行审查。基于提供的代码片段，未发现明显的投毒行为，例如执行恶意系统命令、反弹shell或修改系统文件。代码的主要功能是上传包含符号链接的ZIP文件并读取目标文件内容。然而，为了更加确信，需要分析完整的POC代码。暂时评估投毒风险为0%。

**项目地址:** [godylockz/CVE-2023-40028](https://github.com/godylockz/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)