## CVE-2025-31324 - SAP NetWeaver Visual Composer 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统需要运行受影响版本的SAP NetWeaver Visual Composer，且漏洞利用程序可以访问到暴露的 Web 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31324 漏洞是 SAP NetWeaver Visual Composer 中的一个未授权文件上传漏洞。未经身份验证的攻击者可以通过 Metadata Uploader 组件上传任意文件，包括可执行文件，从而可能导致远程代码执行，影响系统的机密性、完整性和可用性。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，该漏洞被积极利用。Rapid7、Picus Security、Tenable、Onapsis、Strobes、Pathlock、SecurityBridge 和 ionix 等安全厂商的报告都证实了该漏洞的存在和活跃利用。
提供的 PoC 代码 `PoC.py` 脚本允许攻击者指定目标 SAP 系统的 IP 地址/域名、端口、漏洞端点路径以及要上传的恶意文件，利用方式简单，验证了漏洞的可利用性。脚本还包括触发payload执行的选项。

**投毒风险：**
分析提供的 PoC 代码（`PoC.py`、`CheckForEndpoints.sh` 和 `LICENSE`），没有发现明显的投毒代码。所有代码都专注于漏洞利用的演示和验证，不存在尝试安装后门、收集信息或执行其他恶意操作的迹象。

*   `PoC.py`：用于上传恶意payload并触发执行，只包含漏洞利用的逻辑。
*   `CheckForEndpoints.sh`：用于检测目标系统是否存在漏洞端点，本身不具备恶意行为。
*   `LICENSE`：MIT 许可证，声明了软件的使用权限和免责声明，与投毒无关。

**利用方式：**
1.  **查找目标系统：** 攻击者首先需要找到运行受影响版本的 SAP NetWeaver Visual Composer 的系统。
2.  **确定漏洞端点：**  可以使用 `CheckForEndpoints.sh` 脚本检测目标系统是否存在漏洞端点。这些端点允许未经验证的文件上传。
3.  **准备恶意Payload：** 攻击者需要准备一个恶意文件，例如 WAR 或 JSP 文件，其中包含要执行的恶意代码。 该代码可以是 webshell 或其他恶意软件。
4.  **上传Payload：** 使用 `PoC.py` 脚本，攻击者可以通过 HTTP POST 请求将恶意文件上传到漏洞端点。脚本中的参数允许指定目标主机、端口、端点路径和本地恶意文件的路径。
5.  **触发Payload：** 上传完成后，攻击者需要触发 Payload 的执行。`PoC.py` 脚本还提供了一个触发 Payload 的选项，通过发送 HTTP GET 请求到特定的 URL 路径来实现。
6.  **执行恶意代码：** Payload 成功触发后，恶意代码将在目标系统上执行，攻击者可以获得系统的控制权，执行任意操作。



**项目地址:** [ODST-Forge/CVE-2025-31324_PoC](https://github.com/ODST-Forge/CVE-2025-31324_PoC)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)