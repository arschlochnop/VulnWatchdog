## CVE-2024-46982-Next.js Cache Poisoning

**漏洞编号:** CVE-2024-46982

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致错误或恶意内容被提供给用户

**影响版本:** 13.5.1 <= version < 13.5.7, 14.0.0 <= version < 14.2.10

**利用条件:** 目标 Next.js 应用使用 pages router，且使用非动态 server-side rendered routes

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-46982 是一个 Next.js 缓存投毒漏洞。攻击者通过发送精心构造的 HTTP 请求，可以毒化 pages router 中非动态 server-side rendered 路由的缓存。漏洞影响 Next.js 13.5.1 到 14.2.9 版本。提供的代码只是一个标准的 Next.js 应用示例，用于测试和演示漏洞，并非漏洞利用脚本本身。基于现有信息，无法直接判断该示例代码能否直接被用于攻击，需要构造特定的 HTTP 请求。 由于POC代码只是一个简单的项目引导，不存在投毒代码。利用方式：攻击者发送特制的HTTP请求，导致Next.js将不应该缓存的路由进行缓存，从而投毒缓存。虽然描述是高危，但是实际只是缓存投毒，所以风险定为中危更合理。

**项目地址:** [melmathari/CVE-2024-46982-NUCLEI](https://github.com/melmathari/CVE-2024-46982-NUCLEI)

**漏洞详情:** [CVE-2024-46982](https://nvd.nist.gov/vuln/detail/CVE-2024-46982)