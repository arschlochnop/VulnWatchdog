## CVE-2017-11882-Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者以当前用户身份执行任意代码

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 需要用户打开恶意构造的Office文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-11882 是一个 Microsoft Office 内存破坏漏洞，存在于 Equation Editor 组件中。攻击者可以利用此漏洞在受害者系统上执行任意代码。漏洞原理是 Office 在解析嵌入的 Equation Editor 对象时，未能正确处理内存中的对象，导致栈缓冲区溢出。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。漏洞利用代码（chrome extension）旨在检测包含漏洞利用的 DOCX 文件，通过分析文件内容（例如，检查 `.rels` 文件中是否包含 "equation" 或 "eqnedt32" 关键字，以及检查 OLE 流中是否存在过长的字体名称）来识别潜在的攻击。

**投毒风险：**
该 Chrome 扩展的主要目的是检测利用 CVE-2017-11882 的恶意 DOCX 文件，而非直接利用该漏洞。其中 `jszip.min.js` 是一个成熟的开源库，本身不太可能包含恶意代码。`background.js` 负责分析下载的 DOCX 文件，如果发现可疑内容，则发出通知。投毒风险较低，可能存在极小概率的误报，从而干扰用户的正常使用。 但考虑到 chrome 插件的特殊性，如果作者后期更新插件，存在植入恶意代码的可能，因此投毒风险给出5%。

**利用方式：**
攻击者通常会构造一个恶意的 Office 文档（例如 DOCX），其中包含一个特制的 Equation Editor 对象。当用户打开此文档时，Office 会尝试解析该对象，由于漏洞的存在，会导致内存损坏，允许攻击者执行任意代码。攻击者可以使用此漏洞来安装恶意软件、窃取敏感信息或执行其他恶意操作。

根据搜索结果，该漏洞被广泛用于传播各种恶意软件，包括 Agent Tesla 键盘记录器和信息窃取器。

**项目地址:** [xdrake1010/CVE-2017-11882-Preventer](https://github.com/xdrake1010/CVE-2017-11882-Preventer)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)