## CVE-2022-0847

**漏洞编号:** CVE-2022-0847

**漏洞类型:** Dirty Pipe 本地提权漏洞

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地权限提升

**影响版本:** Linux Kernel 5.17 rc6 (受影响，具体版本范围需要进一步确认)

**利用条件:** 需要本地用户权限

**POC 可用性:** 是 (大量公开PoC)

**投毒风险:** 5%

## 详情

CVE-2022-0847，又名“Dirty Pipe”，是一个Linux内核中的本地权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺少适当的初始化，可能包含过时的值。未授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升系统权限。

**有效性分析：**

根据搜索结果，存在大量公开可用的漏洞利用PoC，表明该漏洞易于利用。漏洞库信息也表明该漏洞已被积极利用，并且已被添加到CISA的已知被利用漏洞目录。

**投毒风险分析：**

提供的PoC代码片段 `README.md` 非常简单，仅包含 CVE ID 的声明，不包含任何实际的利用代码。因此，投毒风险非常低。但整个仓库可能存在隐藏的、经过混淆的投毒代码的可能性，这里给出一个较低的风险评估。

**利用方式分析：**

1.  **查找目标文件：** 攻击者需要找到一个具有适当权限的目标文件，该文件通常是具有SUID权限的可执行文件或其他敏感文件。
2.  **创建管道：** 创建一个管道，利用`pipe()`系统调用。
3.  **注入数据：** 通过管道将恶意数据写入目标文件覆盖部分内容。
4.  **执行目标文件：** 运行被篡改的目标文件，以提升权限或执行恶意代码。

总之，CVE-2022-0847是一个严重的安全漏洞，攻击者可以利用该漏洞轻松提升权限。提供的POC代码片段本身不具备利用能力，但公开可用的PoC代码有效性高，应该警惕其他代码存在的投毒风险。

**项目地址:** [jonathanbest7/cve-2022-0847](https://github.com/jonathanbest7/cve-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)