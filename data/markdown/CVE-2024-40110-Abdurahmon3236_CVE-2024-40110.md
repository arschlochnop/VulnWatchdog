## CVE-2024-40110 - Sourcecodester Poultry Farm Management System v1.0 - Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2024-40110

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Sourcecodester Poultry Farm Management System

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.0

**利用条件:** 目标系统运行存在漏洞的Sourcecodester Poultry Farm Management System v1.0，且攻击者可以访问到/farm/product.php。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Sourcecodester Poultry Farm Management System v1.0的`/farm/product.php`页面，`productimage`参数存在未经身份验证的远程代码执行漏洞(RCE)。

**有效性：**
提供的PoC代码是有效的。根据漏洞库信息和搜索结果，已经确认了此漏洞的存在，并且有公开的PoC脚本可以利用。PoC代码通过向`/farm/product.php`发送包含恶意PHP代码的POST请求，利用`productimage`参数的漏洞执行任意代码。返回的状态码和响应体可以证明这一点，可以根据响应体的内容来判断代码是否成功执行。

**投毒风险：**
PoC代码本身看起来比较直接，主要功能是发送一个包含PHP代码的POST请求。但是，考虑到代码的来源以及潜在的供应链攻击，仍存在一定的投毒风险。风险主要在于：

*   **Payload的修改：** 攻击者可能会修改`payload`变量，使其包含更具破坏性的命令，例如删除文件、篡改数据等。
*   **反向Shell：** 攻击者可以将`payload`修改为反向shell代码，从而控制受害者的服务器。
*   **信息收集：** 攻击者可能在payload中添加用于收集系统信息的代码，例如操作系统版本、已安装软件等。
*   **依赖项安全：** 虽然PoC本身只依赖requests库，但实际环境中，该系统可能依赖其他库或组件，这些依赖项可能存在安全漏洞。

综合考虑，投毒风险较低，大约为10%。主要体现在需要使用者自行修改 `target_url` 和 `payload`，攻击者可以在readme文档中诱导使用者写入恶意代码。

**利用方式：**
1.  **确定目标URL：** 找到存在漏洞的Sourcecodester Poultry Farm Management System v1.0的`/farm/product.php`页面URL。
2.  **构造Payload：** 构造恶意的PHP代码，该代码将在目标服务器上执行。例如，可以使用`system()`函数执行系统命令。
3.  **发送POST请求：** 使用PoC脚本或手动构建POST请求，将包含恶意PHP代码的`payload`作为`productimage`参数的值发送到目标URL。
4.  **执行结果：** 如果漏洞存在且利用成功，目标服务器将执行Payload中的PHP代码，并将结果返回。攻击者可以通过分析返回的结果来判断攻击是否成功，以及执行后续操作。

该漏洞利用简单，只需要发送一个包含特定参数的POST请求即可，因此危害极大。

**项目地址:** [Abdurahmon3236/CVE-2024-40110](https://github.com/Abdurahmon3236/CVE-2024-40110)

**漏洞详情:** [CVE-2024-40110](https://nvd.nist.gov/vuln/detail/CVE-2024-40110)