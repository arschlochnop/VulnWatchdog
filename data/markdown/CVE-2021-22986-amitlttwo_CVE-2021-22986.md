## CVE-2021-22986 - F5 BIG-IP/BIG-IQ iControl REST RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行，可完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 需要网络访问 iControl REST 接口 (通常通过管理界面或 Self IP 地址)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 存在于 F5 BIG-IP 和 BIG-IQ 设备的 iControl REST 接口中，允许未经身份验证的攻击者执行任意系统命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 BIG-IP 和 BIG-IQ。搜索结果表明，该漏洞在野外已被积极利用，甚至被 Mirai 僵尸网络利用。提供的漏洞利用代码 `cve-2021-22986.py` 提供验证漏洞、执行命令、批量扫描和反弹 shell 的功能。它通过向 `/mgmt/tm/util/bash` 接口发送包含命令的 POST 请求来利用漏洞。其中Authorization header的Base64字符串 `YWRtaW46QVNhc1M=` 解码后为 `admin:ASasS`。利用方式是构造包含要执行的命令的 JSON 数据，并将其发送到易受攻击的 iControl REST 端点。由于代码中使用的header值是固定的,存在被记录的风险。关于投毒风险，快速浏览代码没有发现明显的恶意代码，但无法保证代码没有隐藏的后门或恶意行为，考虑到项目协作和网络安全风险，将投毒风险评估为10%，主要来自作者的不可信和payload的风险

**项目地址:** [amitlttwo/CVE-2021-22986](https://github.com/amitlttwo/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)