## CVE-2025-54782-@nestjs/devtools-integration-RCE

**漏洞编号:** CVE-2025-54782

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** @nestjs/devtools-integration

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.2.1

**利用条件:** 需要目标nestjs应用开启devtools-integration，攻击者需要能够通过网络访问目标机器的8000端口（devtools暴露的端口）。由于是CSRF，开发者需要打开恶意网页。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-54782 是 @nestjs/devtools-integration 包中的一个远程代码执行漏洞。当启用该包时，它会暴露一个本地开发HTTP服务器，该服务器具有使用不安全的JavaScript沙箱的API端点。由于不正确的沙箱和缺少跨域保护，开发人员访问的任何恶意网站都可以在他们的本地计算机上执行任意代码。

**有效性分析：**

提供的POC代码包含以下几个部分：

*   `POCWebpage/index.html`:  这是一个恶意网页，它使用 JavaScript 的 XMLHttpRequest 对象向 `http://localhost:8000/inspector/graph/interact` 发送 POST 请求。请求体包含一段 JavaScript 代码，旨在利用沙箱逃逸执行任意命令。这段代码尝试调用`propertyIsEnumerable.call()`，捕获异常，然后通过`pp.constructor.constructor('return process')().mainModule.require('child_process').execSync('touch /tmp/exploited.txt')`执行 `touch /tmp/exploited.txt` 命令。如果攻击成功，会在目标机器的 `/tmp` 目录下创建一个名为 `exploited.txt` 的文件。
*   `POCWebpage/server.js`: 这是一个简单的 HTTP 服务器，用于托管 `index.html` 页面，方便攻击者诱骗开发者访问。
*   `NestServer/Dockerfile`:  这是一个 Dockerfile，用于构建一个包含 nestjs 应用的 Docker 镜像。用于复现漏洞。
*   `NestServer/README.md`:  nestjs 相关说明。

从代码来看，POC 是有效的。它通过 CSRF 攻击，诱导开发者访问恶意网页，从而利用沙箱逃逸漏洞执行任意代码。

**投毒风险分析：**

检查了以下文件：
* README.md: 仅包含说明文档，无恶意代码
* POCWebpage/index.html: 攻击载荷，不是投毒代码
* POCWebpage/server.js: 简易server，用于模拟恶意网站，不是投毒代码
* NestServer/Dockerfile: 用于部署存在漏洞的nestjs环境，不是投毒代码
* NestServer/README.md: 仅包含说明文档，无恶意代码

经过对代码的分析，该仓库中没有发现作者隐藏的投毒代码。该仓库的主要目的是展示 CVE-2025-54782 漏洞的利用过程，帮助安全研究人员理解和复现该漏洞。 投毒风险 0%。

**利用方式：**

1.  攻击者需要搭建一个包含漏洞版本的 @nestjs/devtools-integration 的 nestjs 应用，并运行起来 (或诱导开发者运行包含此漏洞的程序)。
2.  攻击者搭建一个恶意网站 (例如，使用 `POCWebpage/server.js` 提供的简单 HTTP 服务器)。
3.  攻击者诱导受害者 (nestjs 开发者) 在浏览器中访问恶意网站。
4.  恶意网站中的 JavaScript 代码会自动向运行在受害者机器上的 nestjs devtools 服务器 (通常监听 8000 端口) 发送 POST 请求，利用沙箱逃逸漏洞执行任意命令。
5.  攻击成功后，攻击者可以在受害者机器上执行任意代码。

**项目地址:** [vxaretra/CVE-2025-54782](https://github.com/vxaretra/CVE-2025-54782)

**漏洞详情:** [CVE-2025-54782](https://nvd.nist.gov/vuln/detail/CVE-2025-54782)