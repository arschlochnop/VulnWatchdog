## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.3-milestone-2 < 15.10.11 和 16.0.0-rc-1 < 16.4.1

**利用条件:** 需要目标XWiki实例开启Solr搜索功能且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893是XWiki平台中的一个远程代码执行漏洞。攻击者可以通过向`SolrSearch`发送特制的请求，执行任意代码。漏洞存在于`Main.SolrSearchMacros`中，由于对用户输入未进行充分的过滤，导致攻击者可以通过构造恶意的Groovy脚本实现RCE。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个经过确认的高危漏洞，存在公开的PoC利用代码。利用的有效性高，因为无需认证即可利用，影响范围广，且能直接导致RCE。

**投毒风险分析：**

提供的PoC代码只包含`LICENSE`和`README.md`文件，均为描述文件，不包含任何可执行代码。`LICENSE`文件使用MIT许可证，`README.md`文件简单描述了漏洞。

因此，从提供的文件来看，投毒的风险较低。然而，需要注意的是，这只是对**当前提供的代码**的分析。完整的利用链可能包含其他组件或利用方式，这些组件可能存在潜在的恶意代码。假设存在投毒可能性的风险为10%。

**利用方式分析：**

根据漏洞库信息和搜索结果，利用方式如下：

1.  **漏洞点：** `SolrSearchMacros`中的`rawResponse`宏。
2.  **攻击方式：** 构造包含恶意Groovy代码的URL请求发送到受影响的XWiki实例。
3.  **URL示例：** `<host>/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20`
4.  **修复方案：** 升级到XWiki 15.10.11、16.4.1或更高版本。或者，手动修改`Main.SolrSearchMacros`，使其与`macros.vm#L2824`中的`rawResponse`宏匹配，并设置Content-Type为`application/xml`。

**项目地址:** [D3Ext/CVE-2025-24893](https://github.com/D3Ext/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)