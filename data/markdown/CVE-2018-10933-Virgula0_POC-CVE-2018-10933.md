## CVE-2018-10933-libssh-身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.6 及以上，0.7.6 之前，0.8.4 之前

**利用条件:** 目标服务器运行受影响的libssh版本，且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933是libssh服务器端状态机中的一个漏洞。攻击者可以通过发送`SSH2_MSG_USERAUTH_SUCCESS`消息绕过身份验证，无需提供凭据即可建立会话并执行命令。该漏洞影响0.6及以上版本，0.7.6和0.8.4之前的版本。

**漏洞利用有效性:**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞的POC代码有效。搜索引擎结果中提到“authentication bypass by sending a user-authenticated packet to the server”和“By presenting the server an SSH2_MSG_USERAUTH_SUCCESS message”都说明了利用方式。提供的Python脚本`ssh.py`实现了利用该漏洞进行远程命令执行的功能。脚本首先检查目标libssh的版本，如果版本在受影响范围内，则建立SSH连接，发送`SSH2_MSG_USERAUTH_SUCCESS`消息，然后就可以执行任意命令。

**投毒风险评估:**

分析`ssh.py`脚本的内容，没有发现明显的恶意代码或者后门。代码的功能是连接到目标服务器，发送认证成功的消息，然后执行输入的命令。脚本没有进行任何未经授权的数据收集、修改或者传输行为。因此，该仓库中存在作者隐藏的投毒代码的可能性很低。投毒风险评估为0%。

**漏洞利用方式:**

1.  **版本检测:**  利用脚本或者其他方式获取目标服务器上运行的libssh版本。
2.  **连接建立:**  与目标服务器建立TCP连接，建立SSH会话。
3.  **认证绕过:**  发送`SSH2_MSG_USERAUTH_SUCCESS`消息，跳过正常的身份验证过程。
4.  **命令执行:**  利用建立的未授权会话执行任意命令。

**项目地址:** [Virgula0/POC-CVE-2018-10933](https://github.com/Virgula0/POC-CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)