## CVE-2025-32463-Sudo-chroot提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，目标系统sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.14到1.9.17p1版本的本地权限提升漏洞。攻击者可以利用`sudo`的`--chroot`选项，结合精心构造的`/etc/nsswitch.conf`文件，绕过`chroot`环境的限制，从而获取root权限。

**利用方式：**

1.  **准备恶意的`/etc/nsswitch.conf`：**  攻击者需要在用户可控的目录下创建一个包含恶意配置的`/etc/nsswitch.conf`文件，该文件会指示系统使用攻击者控制的库来解析用户和组的信息。
2.  **使用`sudo --chroot`：**  攻击者调用`sudo`命令，并使用`--chroot`选项将根目录更改为用户可控的目录。`sudo`在`chroot`环境下会读取攻击者提供的`/etc/nsswitch.conf`。
3.  **权限提升：**  由于使用了恶意的`/etc/nsswitch.conf`，`sudo`会加载攻击者控制的恶意库，从而执行任意代码，最终提升到root权限。

**有效性：**

根据漏洞信息、搜索结果以及提供的漏洞利用代码（Dockerfile和sudo-chwoot.sh），该漏洞利用的有效性很高。漏洞库信息显示该漏洞的CVSS评分为9.3，属于Critical级别。搜索引擎结果也表明该漏洞被广泛关注，并且存在公开的PoC。

提供的代码是一个Docker环境，包含受影响版本的`sudo`以及漏洞利用脚本`sudo-chwoot.sh`，这进一步证实了该漏洞的可利用性。README.md中描述了如何构建和运行Docker镜像，并执行PoC脚本以获取root权限。

**投毒风险：**

虽然漏洞利用代码本身是为了复现漏洞，但是仍然存在一定的投毒风险。主要体现在以下几个方面：

1.  **Docker镜像的安全性：**  如果从不可信的来源拉取Docker镜像（例如，作者提供的Docker Hub镜像），则存在镜像被篡改的风险。攻击者可以在镜像中植入恶意代码，例如后门程序或挖矿程序。
2.  **漏洞利用脚本的安全性：**  漏洞利用脚本`sudo-chwoot.sh`本身可能包含恶意代码。虽然该脚本的主要功能是利用漏洞提升权限，但攻击者可以在脚本中添加额外的恶意行为，例如收集用户信息、上传文件或执行其他命令。
3.  **Dockerfile的安全性：** Dockerfile文件本身也可能存在恶意指令，比如在构建镜像的过程中，运行一些恶意的脚本，或者下载恶意的依赖。

考虑到以上风险，建议在使用该漏洞利用代码时，仔细审查Dockerfile和漏洞利用脚本的内容，确保没有恶意代码。

综合评估，该仓库的投毒风险较低，约为10%，主要是来自镜像本身和脚本中可能隐藏的恶意代码。

**项目地址:** [y4ney/CVE-2025-32463-lab](https://github.com/y4ney/CVE-2025-32463-lab)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)