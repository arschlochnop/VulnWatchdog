## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 是 Swagger UI 中的一个欺骗漏洞。攻击者可以通过诱导受害者打开一个特制的URL，从而显示远程的 OpenAPI 定义。提供的POC代码展示了利用此漏洞的步骤，包括使用一个包含恶意 OpenAPI 定义的JSON文件。该JSON文件指定了远程的YAML文件，其中ismsxss.yaml包含XSS payload。具体来说，ismsxss.yaml包含一段JavaScript代码（`<img onerror=alert(document.domain) src>`），这段代码会在Swagger UI中执行，从而实现跨站脚本攻击（XSS）。

**有效性：** 根据漏洞信息和POC代码，漏洞是有效的。攻击者通过诱导用户打开包含恶意链接的网页，可以执行XSS攻击。

**投毒风险：** 通过分析提供的POC代码，未发现明显的作者隐藏的投毒代码。虽然POC代码中包含XSS payload，但这是为了验证漏洞的存在，并非恶意投毒。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个包含指向恶意 OpenAPI 定义文件的 URL。
2.  攻击者通过社会工程学等方法诱导受害者点击该 URL。
3.  受害者的 Swagger UI 加载恶意的 OpenAPI 定义文件。
4.  恶意 OpenAPI 定义文件中的 XSS payload 在受害者的浏览器中执行，从而实现攻击目的。例如，可以窃取用户的Cookie或执行其他恶意操作。

**项目地址:** [wrkk112/CVE-2018-25031](https://github.com/wrkk112/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)