## CVE-2018-16119-TP-Link WR1043ND 远程代码执行

**漏洞编号:** CVE-2018-16119

**漏洞类型:** 栈溢出

**影响应用:** TP-Link WR1043ND

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Firmware Version 3 及相关版本

**利用条件:** 需要网络访问和有效的路由器认证凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 TP-Link WR1043ND 路由器 httpd 服务器中的栈溢出漏洞，允许经过身份验证的远程攻击者通过向 `/userRpm/MediaServerFoldersCfgRpm.htm` 发送恶意的 MediaServer 请求来执行任意代码。根据提供的POC代码，利用方式如下：

1.  **编译恶意Payload:** 编译一个 MIPS big-endian 架构的反向shell可执行文件。
2.  **设置反向Shell监听:** 启动一个 netcat 监听器，等待路由器反弹shell。
3.  **执行漏洞利用脚本:** 运行 exploit.py 脚本，该脚本会认证到目标路由器，启动 TFTP 服务器，并利用该漏洞下载并执行反向 shell。
4.  **与 Shell 交互:** 建立连接后，攻击者获得路由器的 root 访问权限。

关于投毒风险，虽然提供的代码结构看似合理，但仍存在潜在的投毒风险。 例如，恶意修改编译后的shell二进制文件或者篡改exploit.py脚本添加反向shell或者恶意指令。因此，建议在使用前仔细审查代码，并在隔离环境中进行测试。代码中的 TFTP 服务器和反向 shell 机制都可能被滥用，因此存在一定的投毒风险。考虑到利用过程相对复杂，需要编译和配置，恶意投毒的几率相对较低，估计为10%。

**项目地址:** [hdbreaker/CVE-2018-16119](https://github.com/hdbreaker/CVE-2018-16119)

**漏洞详情:** [CVE-2018-16119](https://nvd.nist.gov/vuln/detail/CVE-2018-16119)