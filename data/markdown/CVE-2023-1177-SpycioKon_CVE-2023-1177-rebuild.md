## CVE-2023-1177-mlflow-路径遍历

**漏洞编号:** CVE-2023-1177

**漏洞类型:** 路径遍历

**影响应用:** mlflow

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.2.1

**利用条件:** 需要mlflow服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-1177是mlflow中存在的路径遍历漏洞，攻击者可以通过构造包含`\..\filename`的恶意路径，访问服务器上的任意文件。根据漏洞库信息，受影响的版本为2.2.1之前的mlflow版本。搜索引擎结果证实了该漏洞的存在，并指出攻击者可以通过该漏洞读取敏感信息。提供的POC代码首先创建一个模型，然后更新模型的source字段为`file:///`，这允许读取本地文件。最后，通过`model-versions/get-artifact`接口，结合路径遍历payload（例如`flag.txt`，实际上应该包含`..`来遍历目录），读取目标文件。POC代码的有效性较高，因为它直接利用了漏洞描述中提到的`file:///`和路径遍历特性。该漏洞利用代码比较简单，主要是通过mlflow提供的API创建模型以及更新模型属性，不存在明显的投毒代码，风险极小。但需要注意，攻击者可能会在读取到的文件中包含恶意代码，从而进行进一步的攻击。所以投毒风险值较低，主要考虑为POC仓库贡献者账号安全性。

**利用方式:**
1.  **创建模型:** 使用`ajax-api/2.0/mlflow/registered-models/create` API创建一个新的模型。
2.  **更新模型:** 使用`ajax-api/2.0/mlflow/model-versions/create` API更新模型的source属性，将其设置为`file:///`，这使得可以访问本地文件系统。
3.  **路径遍历:** 使用`model-versions/get-artifact` API，并构造包含`..`的路径，例如`model-versions/get-artifact?path=../../../../etc/passwd&name=<model_name>&version=1`，来读取服务器上的任意文件。

**有效性评估:**
基于漏洞描述和POC代码，可以确定该漏洞利用的有效性较高。攻击者可以通过简单的API调用和路径构造，读取服务器上的敏感信息。


**项目地址:** [SpycioKon/CVE-2023-1177-rebuild](https://github.com/SpycioKon/CVE-2023-1177-rebuild)

**漏洞详情:** [CVE-2023-1177](https://nvd.nist.gov/vuln/detail/CVE-2023-1177)