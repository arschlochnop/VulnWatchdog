## CVE-2025-32433-Erlang/OTP SSH RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH

**危害等级:** 严重，无需身份验证即可远程执行代码

**影响版本:** <= OTP-27.3.2, <= OTP-26.2.5.10, <= OTP-25.3.2.19

**利用条件:** 目标系统运行受影响版本的 Erlang/OTP SSH 服务，且攻击者可以建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32433 是 Erlang/OTP SSH 服务器中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。该漏洞源于 SSH 协议消息处理中的缺陷。攻击者可以通过发送特制的 SSH 握手数据包绕过身份验证，并利用此漏洞执行任意命令。

**有效性：**

提供的漏洞利用代码尝试利用此漏洞。代码结构包括：

*   `Reverse_Shell` 类：用于建立反向 shell 连接，在攻击成功后允许攻击者与目标系统交互。
*   `CVE_2025_32433` 类：包含漏洞利用的核心逻辑，例如构造恶意 SSH 数据包。
*   `encode_payload` 函数：用于将 payload 编码为符合 SSH 协议的格式，具体来说是添加长度字段。
*   `binary_packet_protocol` 函数：尝试构造符合 SSH 二进制数据包协议的格式，但提供的代码片段是不完整的，`padding_length_value = bloc`存在问题。完整的实现应该计算合适的padding长度。根据漏洞描述,利用方式应该是构造畸形的SSH协议消息，跳过身份验证流程,从而执行任意命令。 

**投毒风险：**

虽然该漏洞利用代码尝试实现漏洞利用，但仍存在一些潜在的投毒风险：

*   **不完整的代码片段：** 提供的`binary_packet_protocol`是不完整的，无法正常运行，如果未经检查就使用，可能会导致攻击失败或者更严重的问题. 该仓库的其他部分可能包含恶意代码。
*   **反向 Shell：** 反向 shell 本身具有风险，攻击者可以在目标系统上执行任意命令。
*  **依赖项风险：** 该漏洞利用代码依赖于 `pwntools` 库，如果 pwntools 库被篡改，可能会引入额外的安全风险。

基于以上分析，存在少量投毒风险，大概在10%。主要是代码不完整，容易误导使用者, 另外就是使用者需要确认代码和依赖的安全。

**利用方式：**

利用方式主要包括以下步骤：

1.  **构造恶意的 SSH 数据包：** 攻击者需要构造包含漏洞触发条件的 SSH 数据包。根据漏洞描述，这涉及到 SSH 协议消息处理中的缺陷。
2.  **发送恶意数据包：** 将构造的恶意数据包发送到目标 Erlang/OTP SSH 服务器。
3.  **绕过身份验证：** 如果漏洞利用成功，恶意数据包将绕过身份验证过程。
4.  **执行任意代码：** 绕过身份验证后，攻击者可以执行任意代码，例如启动反向 shell。
5.  **建立反向 Shell：** 如果攻击者选择执行反向 shell，目标系统将连接到攻击者的监听端口，从而允许攻击者控制目标系统。

**项目地址:** [vigilante-1337/CVE-2025-32433](https://github.com/vigilante-1337/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)