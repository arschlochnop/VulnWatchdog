## CVE-2023-50564 - Pluck CMS v4.7.18 任意文件上传漏洞

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v4.7.18

**利用条件:** 需要目标系统安装Pluck CMS v4.7.18，并需要有效的管理员用户凭证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50564 是 Pluck CMS v4.7.18 中的一个任意文件上传漏洞。攻击者可以通过 `/inc/modules_install.php` 组件上传特制的 ZIP 文件，从而执行任意代码。由于漏洞利用需要身份验证，因此攻击者需要有效的管理员凭证。

**有效性分析：**

提供的漏洞利用代码 (exploit.py) 针对 CVE-2023-50564，利用 `/admin.php?action=installmodule` 接口上传包含 PHP 反向 shell 的 ZIP 文件。代码中包含身份验证步骤，文件上传过程，以及反向 shell 连接的建立，与漏洞描述一致。根据漏洞信息和代码内容判断，该PoC代码有效。

**投毒风险分析：**

检查提供的 exploit.py 代码，虽然包含了建立反向 shell 的功能，但没有发现明显的恶意代码，例如删除日志、篡改数据等。投毒风险主要在于攻击者可能利用该漏洞上传其他恶意文件，例如勒索软件、挖矿程序等。因此，代码本身可能存在少量投毒可能, 风险评估为10%。

**利用方式：**

1.  **身份验证：** 使用有效的管理员凭据登录 Pluck CMS v4.7.18。
2.  **生成恶意 ZIP 文件：** 创建包含恶意 PHP 反向 shell 文件的 ZIP 压缩包。
3.  **上传 ZIP 文件：** 通过 `/admin.php?action=installmodule` 接口上传恶意 ZIP 文件。
4.  **触发漏洞：** 访问上传的 PHP 文件，触发反向 shell，从而在目标服务器上执行任意代码。
5.  **建立反向连接：** 攻击者监听指定端口，接收目标服务器发起的反向连接，从而获得对目标服务器的控制权。

**项目地址:** [Mrterrestrial/CVE-2023-50564](https://github.com/Mrterrestrial/CVE-2023-50564)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)