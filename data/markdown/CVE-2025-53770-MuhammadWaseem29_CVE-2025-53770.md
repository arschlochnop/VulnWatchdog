## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未授权的攻击者可以通过网络执行代码，完全控制系统

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition（16.0.0 <= version < 16.0.18526.20508）

**利用条件:** 需要目标SharePoint服务器可访问网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于服务器在处理非受信数据时存在不安全的反序列化操作，未经身份验证的攻击者可以通过精心构造的恶意请求，向服务器发送恶意的序列化数据，从而在目标服务器上执行任意代码。

**有效性分析：**

提供的 PoC 代码有效。漏洞库信息表明该漏洞已经被公开利用。搜索引擎结果显示多家安全厂商（如 Palo Alto Networks, Cloudflare, Trend Micro, Bitsight, Axonius）已监测到该漏洞的在野利用，并发布了相关的分析和缓解措施。PoC 代码通过 `curl` 命令发送包含恶意序列化数据的 POST 请求到 `/ _layouts/15/ToolPane.aspx` 页面，然后提取、解码和解压 payload，最后检查是否包含特定的恶意字符串。成功执行 PoC 表明可以利用该漏洞。

**投毒风险分析：**

该仓库中存在投毒代码的可能性较低，约为 10%。风险主要来源于以下几个方面：

*   虽然PoC本身是为了验证漏洞，但恶意攻击者可能会修改 PoC，在有效载荷中植入恶意代码，例如下载并执行额外的恶意程序，以此扩大攻击范围。
*   提供的 PoC 利用了 SharePoint 的 `ToolPane.aspx` 页面，并且构造了包含 `<Scorecard:ExcelDataSet>` 的恶意 XML Payload。`CompressedDataTable` 属性包含经过压缩和编码的恶意数据，解码后会执行特定的操作，可能被用于下载恶意文件或者执行其他恶意行为。
*   `test_payload.go` 文件可能包含恶意代码，如果直接编译执行，存在潜在风险。

**利用方式分析：**

1.  攻击者构造包含恶意序列化数据的 HTTP POST 请求。
2.  通过 `/_layouts/15/ToolPane.aspx` 页面将恶意数据发送到 SharePoint 服务器。
3.  SharePoint 服务器反序列化恶意数据，导致代码执行。
4.  攻击者利用执行的代码在服务器上执行任意命令，例如安装后门、窃取数据或进行其他恶意操作。

总而言之，此漏洞是一个严重的安全风险，需要及时应用 Microsoft 提供的安全更新或者实施缓解措施。使用 PoC 代码时需要格外小心，防止被恶意利用。

**项目地址:** [MuhammadWaseem29/CVE-2025-53770](https://github.com/MuhammadWaseem29/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)