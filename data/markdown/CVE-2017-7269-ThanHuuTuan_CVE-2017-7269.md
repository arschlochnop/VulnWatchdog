## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可导致远程代码执行

**影响版本:** IIS 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行存在漏洞的IIS 6.0，且WebDAV服务已启用。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269是Microsoft IIS 6.0中WebDAV服务`ScStoragePathFromUrl`函数存在的一个缓冲区溢出漏洞。攻击者可以通过发送包含特别构造的“If:”头部的PROPFIND请求，触发缓冲区溢出，从而在目标系统上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞在野外被利用。搜索结果显示，在漏洞公布后的一段时间内，出现了多次利用该漏洞进行攻击的活动，包括挖矿等。

**投毒风险评估：**
提供的POC代码(`/tmp/3af7177f0aabdb4a97a12f1832e1516f/webdav-validation.py`) 主要是用来验证目标服务器是否存在CVE-2017-7269漏洞。该脚本的功能是发送特定格式的HTTP请求，然后根据服务器的响应来判断漏洞是否存在。该脚本本身并没有包含任何恶意代码，因此投毒风险评估为0%。

**利用方式分析：**
1.  攻击者构造一个恶意的HTTP PROPFIND请求，该请求的“If:”头部包含一个超长的字符串。
2.  当IIS 6.0处理该请求时，`ScStoragePathFromUrl`函数会将“If:”头部的内容复制到缓冲区中，由于没有进行充分的边界检查，导致缓冲区溢出。
3.  攻击者可以通过控制溢出的内容，覆盖内存中的关键数据，例如函数返回地址，从而劫持程序的执行流程。
4.  攻击者可以将shellcode注入到内存中，并将返回地址指向shellcode的起始地址，当函数返回时，shellcode就会被执行，从而实现远程代码执行。

**项目地址:** [ThanHuuTuan/CVE-2017-7269](https://github.com/ThanHuuTuan/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)