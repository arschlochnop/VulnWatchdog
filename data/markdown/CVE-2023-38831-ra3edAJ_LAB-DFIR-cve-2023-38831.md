## CVE-2023-38831-WinRAR代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在 6.23 版本之前存在的远程代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，如果压缩包中包含一个良性文件和一个与该良性文件同名的文件夹，WinRAR在尝试访问良性文件时，会错误地执行同名文件夹中的恶意内容。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是可用的。漏洞在野外被广泛利用，并且CISA已将其添加到已知被利用的漏洞目录中。

**投毒风险：**
提供的漏洞利用代码为一个Github仓库的README.md文件，主要描述了如何利用磁盘镜像调查CVE-2023-38831攻击，并通过Windows注册表、NTFS文件和浏览器缓存理解Windows事件序列。仓库本身目的是为了DFIR分析，因此直接包含恶意代码的可能性较低。但考虑到链接跳转至外部教程网站，存在间接投毒的可能，即教程内容可能包含引导至恶意软件下载或运行恶意脚本的指令。因此，投毒风险较低，评估为10%。

**利用方式：**
1.  **创建恶意的ZIP压缩包：** 压缩包中包含一个良性文件（如JPG图片）和一个与该良性文件同名的文件夹。
2.  **将恶意可执行文件放入同名文件夹：** 该文件夹中的可执行文件会在用户尝试打开良性文件时被执行。
3.  **诱导用户打开ZIP压缩包：** 通过社交工程或其他方式，诱导用户使用受影响版本的WinRAR打开该压缩包。
4.  **触发漏洞执行恶意代码：** 当用户尝试查看ZIP压缩包中的良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

**总结：**
该漏洞利用方式较为简单，易于传播，危害较大。用户应及时更新WinRAR至最新版本，避免打开来源不明的ZIP压缩包。

**项目地址:** [ra3edAJ/LAB-DFIR-cve-2023-38831](https://github.com/ra3edAJ/LAB-DFIR-cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)