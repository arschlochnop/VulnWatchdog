## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感资源

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标Next.js应用使用了存在漏洞的中间件配置，且暴露在网络上。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞源于Next.js在处理`x-middleware-subrequest`请求头时的不当行为，导致中间件的授权检查被绕过。攻击者可以通过构造带有该请求头的恶意请求，访问原本需要授权才能访问的资源。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且具有较高的危害性。提供的POC代码（扫描器）通过模拟攻击者发送带有`X-Middleware-Subrequest`头的请求，来检测目标应用是否存在漏洞，原理上是有效的。

**投毒风险分析：**

检查提供的代码，发现以下潜在风险：

1.  **依赖风险：** `requirements.txt`中是否存在恶意依赖需要进一步审查。虽然代码中没有明显的恶意行为，但任何依赖都可能被投毒。
2.  **网络行为：** 扫描器会向目标网站发起大量请求，如果目标网站部署了反爬机制，可能会触发告警甚至被封禁IP。
3. **结果篡改：** 扫描器可能存在逻辑错误，导致误报或漏报。如果攻击者控制了扫描器，则可能恶意篡改扫描结果。

综合分析，该POC代码本身隐藏恶意投毒代码的可能性较低，大约10%，但是存在被滥用或者因依赖项而引入风险的可能，所以依赖项和使用者需要注意。

**利用方式：**

1.  攻击者首先需要确定目标Next.js应用使用的版本是否在受影响的范围内。
2.  攻击者使用POC代码（或手动构造请求）向目标应用发送带有`X-Middleware-Subrequest`请求头的请求，尝试访问受保护的资源。
3.  如果资源可以被未经授权访问，则说明目标应用存在漏洞。
4.  攻击者可以利用该漏洞访问敏感数据、执行未授权操作等。

**项目地址:** [HoumanPashaei/CVE-2025-29927](https://github.com/HoumanPashaei/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)