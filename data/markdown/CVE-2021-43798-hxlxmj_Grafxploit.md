## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，Grafana实例运行在受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本（除已修补版本外）。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 构造恶意 URL，利用目录遍历漏洞读取服务器上的任意文件。提供的漏洞利用代码 `grafxploit.py` 旨在自动化扫描易受攻击的 Grafana 实例，识别易受攻击的插件，并提取敏感文件，如 SSH 密钥。该漏洞利用代码包含扫描目标、指定输出目录和自定义扫描路径列表的功能。通过分析代码，未发现明显的恶意投毒代码，但需要注意依赖库 colorama 可能存在潜在的供应链风险。该工具从github下载，作者可能存在后门代码，但并未在提供的代码段体现，所以预估投毒风险10%。

**利用方式:**
1.  确定目标 Grafana 实例的版本是否在受影响范围内。
2.  使用漏洞利用代码 `grafxploit.py`，指定目标 URL 或目标列表文件。
3.  （可选）指定自定义的输出目录，用于保存提取的文件。
4.  （可选）指定包含其他要检查路径的文件。
5.  运行漏洞利用脚本，该脚本将尝试利用目录遍历漏洞读取指定的文件。

**项目地址:** [hxlxmj/Grafxploit](https://github.com/hxlxmj/Grafxploit)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)