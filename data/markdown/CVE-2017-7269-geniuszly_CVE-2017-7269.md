## CVE-2017-7269 - Microsoft IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft Internet Information Services (IIS) 6.0

**危害等级:** 高危，远程代码执行

**影响版本:** IIS 6.0 on Microsoft Windows Server 2003 R2

**利用条件:** 目标服务器运行IIS 6.0，并且WebDAV服务已启用。需要向服务器发送特制的PROPFIND请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 存在于 Microsoft IIS 6.0 的 WebDAV 服务中的 `ScStoragePathFromUrl` 函数中。攻击者可以发送一个包含长 "If: <http://" 开头的 header 的 PROPFIND 请求，导致缓冲区溢出，从而允许远程执行任意代码。

**有效性:**

漏洞库信息和搜索结果表明该漏洞确实存在并且已被积极利用。提供的POC代码 `GenWebDavIISExploit.py` 旨在生成利用此漏洞的有效载荷。 exploit-db 上也有公开的exploit（例如，41992 和 41738）。所以该POC代码有效

**投毒风险:**

通过分析提供的 `GenWebDavIISExploit.py` 代码，该脚本主要功能是生成用于利用 CVE-2017-7269 漏洞的恶意数据包。 它接受目标 IP 地址、端口以及反向连接的 IP 地址和端口作为参数，生成包含 shellcode 的 PROPFIND 请求。 没有发现该代码直接包含恶意或后门行为。Shellcode 部分用于建立反向连接，而不是执行任何有害操作。代码主要通过溢出缓冲区执行Shellcode来发起反向连接，完成漏洞利用。

**利用方式:**

1.  **确定目标:** 找到运行易受攻击的 IIS 6.0 版本的服务器。根据搜索结果，即使在漏洞发布后，仍然存在暴露的实例。
2.  **准备反向连接:** 设置一个监听器（例如，使用 `netcat` 或 Metasploit）来接收来自目标服务器的反向连接。
3.  **生成利用代码:** 使用 `GenWebDavIISExploit.py` 脚本，指定目标 IP 地址、端口和反向连接的 IP 地址和端口，生成利用代码
4.  **发送恶意请求:** 使用生成的payload向目标服务器发送 PROPFIND 请求。 "If: <http://" header 包含精心设计的溢出数据，包括 shellcode。
5.  **执行代码:** 成功利用后，目标服务器将执行 shellcode，从而建立与攻击者的反向连接。攻击者现在可以在受感染的系统上执行命令。

**项目地址:** [geniuszly/CVE-2017-7269](https://github.com/geniuszly/CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)