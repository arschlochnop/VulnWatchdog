## CVE-2024-8418-aardvark-dns-DoS

**漏洞编号:** CVE-2024-8418

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** aardvark-dns

**危害等级:** 高危，导致服务不可用

**影响版本:** 1.12.0, 1.12.1, < 1.12.1 (建议升级到1.12.1或更高版本)

**利用条件:** 需要能够与aardvark-dns服务建立TCP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-8418是Aardvark-dns中的一个漏洞，由于其串行处理TCP DNS查询，攻击者可以通过保持TCP连接无限期打开来利用此漏洞进行拒绝服务攻击。这导致服务器变得无响应，并导致其他DNS查询超时。该漏洞利用代码 `poc.sh` 尝试使用 `bash` 或 `nc` 建立与目标 aardvark-dns 服务器的 TCP 连接，然后无限期地保持连接打开。如果攻击者能够建立并保持多个这样的连接，则可能耗尽服务器资源，导致拒绝服务。该POC代码没有发现任何投毒风险，它只是尝试打开一个TCP连接并保持连接。

**利用方式：**

1.  **环境准备：** 设置一个运行 Aardvark-dns 的环境，例如使用提供的 `podman` 命令创建网络和容器。
2.  **攻击：** 从具有网络访问权限的容器运行 `poc.sh` 脚本。该脚本尝试与 Aardvark-dns 服务器建立 TCP 连接并保持连接打开。
3.  **验证：** 尝试从网络中的另一个容器执行 DNS 查询。如果 Aardvark-dns 服务器受到攻击影响，DNS 查询将超时，从而验证 DoS 攻击的成功。

**项目地址:** [goma0x2/CVE-2024-8418](https://github.com/goma0x2/CVE-2024-8418)

**漏洞详情:** [CVE-2024-8418](https://nvd.nist.gov/vuln/detail/CVE-2024-8418)