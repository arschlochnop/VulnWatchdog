## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 高危，允许本地非特权用户提升至root权限

**影响版本:** < 0.9.0

**利用条件:** 需要目标系统安装低于0.9.0版本的below，且攻击者需要有sudo权限或以其他方式能够执行below命令

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-27591是一个权限提升漏洞，存在于below服务0.9.0之前的版本中。该漏洞是由于below服务在/var/log/below目录下创建了一个全局可写目录造成的。攻击者可以通过创建一个指向/etc/passwd的符号链接，然后触发below服务写入日志，以此将恶意用户条目注入/etc/passwd文件，从而获得root权限。POC利用代码首先创建从`/var/log/below/error_root.log`到`/etc/passwd`的符号链接。然后，它使用`crypt`库生成给定密码的哈希值，并构造一个包含新用户帐户信息的字符串。最后，它使用`sudo below replay --time`命令将构造的字符串写入日志文件（实际上是`/etc/passwd`），从而将新用户添加到系统中。投毒风险极低，主要集中在license和readme中的链接以及作者声明，但是经过代码分析，没有发现任何恶意代码。由于使用sudo执行below命令，该利用的成功取决于当前用户是否具有sudo权限。

**漏洞利用方式：**

1.  **创建全局可写目录：** below服务在/var/log/below目录下创建了一个全局可写目录，权限为0777。
2.  **符号链接攻击：** 攻击者利用全局可写目录的特性，创建一个指向/etc/passwd文件的符号链接。
3.  **日志注入：** 攻击者通过触发below服务写入日志，将恶意用户条目注入到/etc/passwd文件中。
4.  **权限提升：** 成功注入恶意用户条目后，攻击者可以使用新添加的用户登录系统，从而获得root权限。

**项目地址:** [Cythonic1/CVE-2025-27591](https://github.com/Cythonic1/CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)