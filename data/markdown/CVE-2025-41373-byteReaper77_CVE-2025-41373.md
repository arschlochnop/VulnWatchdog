## CVE-2025-41373 – SQL Injection in Gandia Integra Total

**漏洞编号:** CVE-2025-41373

**漏洞类型:** SQL注入

**影响应用:** Gandia Integra Total

**危害等级:** 高危，允许经过身份验证的攻击者检索、创建、更新和删除数据库

**影响版本:** 2.1.2217.3 to 4.4.2236.1

**利用条件:** 需要 Gandia Integra Total 实例可访问，且攻击者需要已通过身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-41373 是 Gandia Integra Total 中的一个 SQL 注入漏洞。该漏洞存在于 `/encuestas/integraweb[_v4]/integra/html/view/hislistadoacciones.php` 页面的 `idestudio` 参数中。攻击者可以通过将恶意的 SQL 代码注入到该参数中，从而执行未授权的数据库操作。提供的漏洞利用代码 (exploit.c) 旨在通过构造包含 SQL 注入的 HTTP 请求来利用此漏洞。它使用了 boolean-based 和 time-based 两种技术来检测漏洞的存在。代码包含基本的SQL注入payload，例如 `' OR '1'='1`，`" OR "1"="1` 等。该代码通过 gcc 编译，并使用 curl 库发送 HTTP 请求。需要注意的是，exploit.c 中包含使用内联汇编实现的 `sleepSyscall` 和 `exitAssembly` 函数，虽然功能上是为了暂停执行和退出程序，但内联汇编代码增加了潜在的风险，需要谨慎审查。同时存在 uid 函数通过系统调用判断当前用户是否为 root 用户，并输出相应信息。虽然没有直接的投毒代码，但是这些操作具有一定的风险。

**有效性：**
根据代码和漏洞描述，POC 代码基本有效，能够利用 SQL 注入漏洞。

**投毒风险：**
内联汇编的存在带来了一定的风险，虽然目前代码的功能是良性的，但恶意修改的可能性仍然存在。因此，投毒风险评估为 10%。

**利用方式：**
1.  **身份验证：** 攻击者首先需要通过身份验证才能访问存在漏洞的页面。
2.  **构造 Payload：** 攻击者构造包含恶意 SQL 代码的 `idestudio` 参数值。
3.  **发送请求：** 攻击者将构造的 Payload 附加到目标 URL，并通过 HTTP 请求发送到服务器。
4.  **执行注入：** 服务器在处理请求时，会将恶意 SQL 代码注入到数据库查询中。
5.  **获取结果：** 攻击者通过观察响应结果或使用时间延迟等技术，判断注入是否成功，并获取所需的数据或执行其他操作。

**项目地址:** [byteReaper77/CVE-2025-41373](https://github.com/byteReaper77/CVE-2025-41373)

**漏洞详情:** [CVE-2025-41373](https://nvd.nist.gov/vuln/detail/CVE-2025-41373)