## CVE-2017-7529-Nginx范围过滤模块整数溢出

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** 需要启用Nginx的proxy_cache，并设置proxy_force_ranges on;

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7529 漏洞是 Nginx 范围过滤模块中的一个整数溢出漏洞。当 Nginx 处理带有特殊构造的 Range 头的 HTTP 请求时，可能发生整数溢出，导致缓存内容泄露。漏洞影响 Nginx 0.5.6 到 1.13.2 版本。

**漏洞利用方式：**

1.  **配置Nginx:** 确保 Nginx 已启用 `proxy_cache` 并且 `proxy_force_ranges on` 被设置。这使得 Nginx 支持并强制使用 Range 请求。
2.  **发送初始请求:** 发送一个普通的 GET 请求到目标 URL，以便 Nginx 缓存响应。
3.  **构造恶意 Range 请求:** 发送一个带有精心构造的 Range 头的 GET 请求。这个 Range 头的目的是触发整数溢出。根据提供的 `README.md`，可以使用如下的 Range 头：`-n,-(0x8000000000000000-n)`，其中`n`可以根据Content-Length调整. 提供的poc脚本 `poc.py` 自动化了这个过程。
4.  **信息泄露:** 如果漏洞利用成功，Nginx 会返回包含部分缓存内容的响应，从而导致敏感信息泄露。

**有效性评估：**

提供的 Dockerfile 构建了一个包含漏洞版本的 Nginx 和 Flask 应用的环境。`default.conf` 配置文件设置了 `proxy_cache` 和 `proxy_force_ranges on`，满足漏洞利用的必要条件。`README.md` 提供了详细的漏洞利用步骤和示例命令。因此，提供的 POC 代码是有效的。

**投毒风险评估：**

分析提供的代码，发现其中存在一个潜在的风险点，也就是Dockerfile会去debian的archive下载软件包,有可能存在依赖包被篡改的风险。但是概率较低。app.py 是一个简单的 Flask 应用，只返回 "Hello, World!"。`nginx.conf` 和 `default.conf` 是标准的 Nginx 配置文件，没有明显的恶意配置。`entrypoint.sh` 只是启动 Nginx 和 Flask 应用。所以投毒风险极低，大概 1%。

**总结：**

该漏洞利用方式较为直接，通过构造特定的 Range 请求触发整数溢出，从而导致信息泄露。提供的 POC 代码完整且有效，可以用于验证和复现该漏洞。投毒风险较低，主要集中在Dockerfile依赖包的获取上。

**项目地址:** [SirEagIe/CVE-2017-7529](https://github.com/SirEagIe/CVE-2017-7529)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)