## CVE-2021-40539-Zoho ManageEngine ADSelfService Plus-REST API认证绕过导致远程代码执行

**漏洞编号:** CVE-2021-40539

**漏洞类型:** REST API认证绕过导致远程代码执行

**影响应用:** Zoho ManageEngine ADSelfService Plus

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 6113

**利用条件:** 目标系统运行着存在漏洞的Zoho ManageEngine ADSelfService Plus版本，且攻击者可以访问REST API端点。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2021-40539是一个存在于Zoho ManageEngine ADSelfService Plus 6113及更早版本中的REST API认证绕过漏洞，该漏洞可能导致远程代码执行。

**利用方式：**

1.  **认证绕过：** 攻击者可以绕过REST API的认证机制，从而可以访问受保护的端点。
2.  **文件上传：**  POC代码通过`RestAPI/LogonCustomization`端点上传恶意的JSP webshell和Java class文件。具体来说，它首先尝试上传一个JSP webshell (`ws.jsp`)，如果`args.webshell`参数存在，则上传指定的文件，否则上传一个默认的webshell。接着，它上传一个Java class文件 (`Si.class`)，同样，如果`args.java_class`参数存在，则上传指定的文件，否则上传一个Base64编码的预定义的Java class文件。
3.  **远程代码执行：**  攻击者随后可以通过利用上传的webshell执行任意命令。

**投毒风险评估：**

该POC代码存在较高的投毒风险。主要体现在以下几个方面：

*   **默认Payload：** POC代码中包含默认的webshell和Java class payload。如果用户直接使用该POC，可能无意中部署恶意代码，执行未经授权的操作。由于默认的Java class payload是从Base64字符串解码而来，攻击者可以轻松替换该字符串，从而控制执行的代码。 webshell同理。
*   **恶意代码植入：** 攻击者可能修改POC代码，在上传的webshell或Java class中植入恶意代码，例如后门程序、数据窃取程序等。使用被篡改的POC会导致目标系统遭受更严重的攻击。
*   **供应链攻击：** 如果该POC被广泛传播，攻击者可以通过修改POC代码，影响大量用户，扩大攻击范围，构成供应链攻击。

**总结：**

提供的POC代码可以有效利用CVE-2021-40539漏洞，实现远程代码执行。但是，该POC代码存在较高的投毒风险，使用时务必小心谨慎，对代码进行全面审查，确保没有恶意代码。

**项目地址:** [lpyydxs/CVE-2021-40539](https://github.com/lpyydxs/CVE-2021-40539)

**漏洞详情:** [CVE-2021-40539](https://nvd.nist.gov/vuln/detail/CVE-2021-40539)