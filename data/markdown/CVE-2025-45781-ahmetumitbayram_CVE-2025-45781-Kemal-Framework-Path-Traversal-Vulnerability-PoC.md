## CVE-2025-45781-Kemal Framework-Path Traversal

**漏洞编号:** CVE-2025-45781

**漏洞类型:** 路径遍历

**影响应用:** Kemal Framework

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 1.6.0

**利用条件:** 需要运行Kemal Framework应用，并设置了可访问的public目录

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-45781是Kemal Framework 1.6.0版本中的一个路径遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。漏洞存在于`Kemal::StaticFileHandler`类中，当处理静态文件时，框架没有对用户提供的URI中的`../`序列进行过滤，导致攻击者可以访问`@public_dir`目录之外的文件。

**有效性分析：**
根据提供的漏洞利用代码，PoC代码比较完整，包含创建项目、编辑配置文件、安装依赖、编写代码、创建public目录以及测试漏洞的步骤，并且提供了明确的curl命令来验证漏洞是否存在，命令中使用了`..%2f`进行URL编码，以绕过一些基本的过滤。

**投毒风险分析：**
查看POC代码，主要功能是创建Kemal项目，添加依赖，然后通过curl命令测试路径穿越漏洞。唯一可能存在风险的是shards.yml文件，但该文件只是声明了kemalcr/kemal的依赖，不太可能存在投毒。在kemal-test.cr中，代码非常简单，只是返回了“Hello from Kemal!”，设置了public目录，因此没有发现恶意代码。整个POC流程旨在验证路径穿越漏洞，没有明显的投毒迹象，因此投毒风险较低。

**利用方式：**
1.  攻击者构造包含`../`序列的恶意URI，例如`http://localhost:3000/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc%2fpasswd`。
2.  Kemal Framework的`Kemal::StaticFileHandler`类接收到该URI后，没有进行充分的过滤和验证。
3.  框架尝试读取URI指定的文件，由于没有对`../`序列进行处理，导致可以访问`@public_dir`目录之外的文件。
4.  攻击者成功读取服务器上的任意文件，例如`/etc/passwd`。

**项目地址:** [ahmetumitbayram/CVE-2025-45781-Kemal-Framework-Path-Traversal-Vulnerability-PoC](https://github.com/ahmetumitbayram/CVE-2025-45781-Kemal-Framework-Path-Traversal-Vulnerability-PoC)

**漏洞详情:** [CVE-2025-45781](https://nvd.nist.gov/vuln/detail/CVE-2025-45781)