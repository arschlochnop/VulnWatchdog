## CVE-2017-9248 - Telerik UI for ASP.NET AJAX 漏洞

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密弱点/远程代码执行 (RCE)

**影响应用:** Telerik UI for ASP.NET AJAX, Progress Sitefinity

**危害等级:** 高危，可能导致MachineKey泄露、任意文件上传/下载、XSS、ViewState泄露甚至远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本，具体受影响版本范围根据Exploit-DB条目显示为2012.3.1308 < 2017.1.118

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX 组件，且攻击者能够通过网络访问存在漏洞的页面(通常是 Telerik.Web.UI.DialogHandler.aspx)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9248 漏洞是 Telerik UI for ASP.NET AJAX 框架中的一个加密弱点。由于 Telerik.Web.UI.dll 未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致攻击者可以利用此漏洞绕过加密保护机制。

**有效性：**

根据漏洞描述、搜索结果（如Exploit-DB上的PoC）以及提供的漏洞扫描器代码，可以确定该漏洞利用是有效的。CISA 将此漏洞添加到已知被利用的漏洞目录中，表明其在现实世界中被广泛利用。

**投毒风险：**

提供的漏洞利用代码是一个漏洞扫描器，主要功能是发现 Telerik 端点并测试 CVE-2017-9248 加密漏洞。从代码本身来看，其主要风险在于被滥用进行未经授权的漏洞扫描和渗透测试。虽然代码的功能相对简单，投毒风险较低，但是仍然无法排除作者故意添加后门或恶意代码的可能性。例如，扫描器可以记录目标信息并发送给攻击者。考虑到代码的开源性质，用户可以审查代码以降低风险，但对于非安全专业人员，仍然存在一定风险。考虑到其扫描器的性质，投毒风险设为10%。

**利用方式：**

1.  **信息收集：** 首先，攻击者需要确定目标系统是否使用了存在漏洞的 Telerik UI for ASP.NET AJAX 组件。可以使用指纹识别工具或手动检查页面源码来判断。
2.  **漏洞验证：** 通过访问特定的 URL（如 `/Telerik.Web.UI.DialogHandler.aspx`）并发送特制的请求，可以验证漏洞是否存在。扫描器代码可以自动化这个过程。
3.  **MachineKey 泄露：** 如果漏洞存在，攻击者可以尝试泄露 MachineKey。这通常涉及利用加密弱点，例如使用已知的加密密钥或通过暴力破解来获取密钥。
4.  **利用 MachineKey：** 获得 MachineKey 后，攻击者可以利用它来执行各种攻击，例如：
    *   **ViewState 反序列化漏洞利用：** 攻击者可以构造恶意的 ViewState 数据，利用反序列化漏洞执行任意代码。
    *   **任意文件上传/下载：** 攻击者可以使用 MachineKey 来加密/解密用于文件上传或下载的参数，从而实现任意文件操作。
    *   **XSS 攻击：** 攻击者可以利用 MachineKey 来绕过某些安全机制，注入恶意脚本执行 XSS 攻击。
    *   **身份伪造/权限提升：** 攻击者可能使用泄露的 MachineKey 来伪造用户身份或提升权限。

**总结：**

CVE-2017-9248 是一个高危漏洞，攻击者可以利用它执行多种攻击。系统管理员应尽快升级 Telerik UI for ASP.NET AJAX 组件到安全版本，并采取其他安全措施来降低风险。

**项目地址:** [0xsharz/telerik-scanner-cve-2017-9248](https://github.com/0xsharz/telerik-scanner-cve-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)