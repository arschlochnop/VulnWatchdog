## CVE-2024-38063 Windows TCP/IP IPv6 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致系统崩溃或远程代码执行

**影响版本:** 见漏洞库信息，影响多个Windows版本

**利用条件:** 目标系统启用IPv6，攻击者可发送特制的IPv6数据包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索引擎结果，CVE-2024-38063是一个Windows TCP/IP组件中的远程代码执行漏洞，CVSS评分为9.8，影响多个Windows版本。漏洞原理是TCP/IP组件中存在整数下溢漏洞，攻击者可以通过发送特制的IPv6数据包触发该漏洞，实现远程代码执行。

提供的POC代码 `cve-2024-38063.py` 使用 `scapy` 库构造并发送一系列IPv6数据包，包括IPv6扩展头和分片的数据包，目标是触发整数下溢漏洞。代码首先导入 `scapy.all`，然后定义了两个函数 `get_packets_with_mac` 和 `get_packets` 来生成IPv6数据包。这些数据包包含精心构造的IPv6扩展头和分片信息，旨在触发漏洞。最后，代码循环发送这些数据包，并等待一段时间，声称在此期间内存损坏会被触发。根据代码逻辑分析，其目的是发送大量畸形 IPv6 包，没有发现可疑的后门或恶意代码。

**利用方式：**
1.  攻击者需要能够向目标Windows系统发送IPv6数据包。
2.  攻击者运行提供的Python脚本，该脚本会发送一系列精心构造的IPv6数据包。
3.  这些数据包会触发目标系统TCP/IP组件中的整数下溢漏洞。
4.  成功利用后，攻击者可以在目标系统上执行任意代码。

**有效性：**
根据POC代码和搜索引擎结果，该POC代码的有效性较高，但可能需要根据目标系统的具体环境进行调整。

**投毒风险：**
经过对提供的POC代码的分析，没有发现明显的投毒代码。该POC代码的主要功能是构造和发送IPv6数据包，其行为符合漏洞利用的预期。因此，投毒风险较低。



**项目地址:** [PumpkinBridge/Windows-CVE-2024-38063](https://github.com/PumpkinBridge/Windows-CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)