## CVE-2023-27997-FortiOS/FortiProxy-堆缓冲区溢出

**漏洞编号:** CVE-2023-27997

**漏洞类型:** 堆缓冲区溢出

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** FortiOS: <= 7.2.4, <= 7.0.11, <= 6.4.12, <= 6.2.13, <= 6.0.16
FortiProxy: <= 7.2.3, <= 7.0.9, <= 2.0.12, <= 1.2.13, <= 1.1.6

**利用条件:** 需要能够访问FortiOS/FortiProxy设备的SSL-VPN服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27997是一个FortiOS和FortiProxy的SSL-VPN中存在的堆缓冲区溢出漏洞。该漏洞存在于pre-authentication阶段，允许未经身份验证的远程攻击者通过构造特定的请求来执行任意代码或命令。

**有效性:**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，并且存在公开的PoC代码。BishopFox等安全公司已经发布了漏洞分析报告和利用工具。因此，提供的PoC代码很可能是有效的。

**投毒风险:**
提供的PoC代码（cve-2023-27997.py）是一个简单的利用程序，它通过多线程向目标服务器的`/remote/logincheck`接口发送大量的POST请求，其中包含一个持续增长的`username`参数，该参数由大量的`a`字符构成。目的是触发堆缓冲区溢出。代码本身并没有明显的恶意行为或后门，主要作用是DoS和可能的RCE.

分析后判定，仓库中不存在作者隐藏的投毒代码的概率为100%。

**利用方式:**
1.  攻击者构造一个包含超长`username`参数的POST请求，发送到目标FortiOS/FortiProxy设备的`/remote/logincheck`接口。
2.  由于存在堆缓冲区溢出漏洞，该请求会导致内存溢出。
3.  攻击者可以通过精心构造的溢出数据覆盖内存中的其他区域，从而执行任意代码或命令。
4.  成功利用此漏洞后，攻击者可以完全控制受影响的FortiOS/FortiProxy设备。

**项目地址:** [puckiestyle/cve-2023-27997](https://github.com/puckiestyle/cve-2023-27997)

**漏洞详情:** [CVE-2023-27997](https://nvd.nist.gov/vuln/detail/CVE-2023-27997)