## CVE-2019-14224-Alfresco-远程代码执行

**漏洞编号:** CVE-2019-14224

**漏洞类型:** 远程代码执行

**影响应用:** Alfresco Community Edition

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.2 201707

**利用条件:** 需要Alfresco Admin Console、WebDAV或Alfresco Share以及Alfresco Solr界面的访问权限，并需要有效的用户凭据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14224 存在于 Alfresco Community Edition 5.2 201707 中。 攻击者利用该漏洞可以通过以下步骤实现远程代码执行：

1.  **上传恶意Solr配置**: 攻击者需要使用Alfresco上传恶意Solr配置文件到可访问的位置。
2.  **创建Solr Core触发JMX连接**: 攻击者创建Solr Core，这将触发受害者机器向攻击者控制的服务器发起JMX连接。
3.  **恶意RMI服务和反序列化**: 攻击者运行恶意的RMI服务器，当受害者建立JMX连接时，攻击者服务器会发送恶意的Java对象，导致反序列化漏洞并最终执行任意代码。

**漏洞利用有效性：**根据漏洞描述和POC代码，该漏洞利用是有效的，因为它提供了一种通过上传恶意配置文件和利用JMX连接进行反序列化攻击的方式。

**投毒风险分析：** 此仓库的主要风险点在于它依赖于恶意 RMI 服务器来提供有效载荷，这意味着攻击者有机会在服务器端注入恶意代码。此外，上传的Solr配置文件也可能包含允许攻击者执行额外操作的后门。整体的投毒风险评估偏低，因为主要依赖于受害者主动连接JMX。

**利用方式总结：**

*   **身份验证：**首先需要通过身份验证才能访问Alfresco的Web界面和Solr管理界面。
*   **上传：** 上传恶意的Solr配置文件。
*   **JMX连接：** 诱使目标服务器通过JMX连接到攻击者控制的RMI服务器。
*   **反序列化：** 通过RMI服务发送恶意序列化Java对象，触发反序列化漏洞，执行任意代码。

**项目地址:** [mbadanoiu/CVE-2019-14224](https://github.com/mbadanoiu/CVE-2019-14224)

**漏洞详情:** [CVE-2019-14224](https://nvd.nist.gov/vuln/detail/CVE-2019-14224)