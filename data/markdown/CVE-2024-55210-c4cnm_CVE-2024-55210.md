## CVE-2024-55210 - TOTVS Protheus MFA Bypass

**漏洞编号:** CVE-2024-55210

**漏洞类型:** 多因素认证绕过

**影响应用:** TOTVS Protheus

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** 未知，影响Protheus软件的MFA模块

**利用条件:** 需要已经登录目标账户，但需要通过MFA验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于TOTVS Protheus软件的MFA模块中。攻击者在已经登录目标账户的情况下，可以通过拦截和篡改WebSocket消息，将`isValidToken`参数的值修改为`true`，从而绕过MFA验证。POC代码通过截图和文字详细描述了攻击过程，包括拦截的WebSocket消息以及修改`isValidToken`的位置。

**有效性：** 根据POC描述，该漏洞利用方法简单直接，通过修改客户端接收到的WebSocket消息即可绕过MFA，因此有效性较高。

**投毒风险：** POC代码本身主要包含漏洞原理的描述和利用演示。 虽然作者上传了一些图片资源，这些图片被投毒的可能性较低。考虑到POC作者可能在其他地方留下后门，例如在代码中隐藏恶意链接，或者篡改图片内容等，但整体而言，直接从README.md文件本身进行投毒的概率较低。这里保守估计为10%的投毒风险。

**利用方式：**
1.  攻击者首先需要获取目标账户的登录凭据。
2.  使用该凭据登录到Protheus系统，触发MFA验证流程。
3.  在客户端（通常是Web浏览器）拦截服务器发送的WebSocket消息。
4.  修改消息中`isValidToken`参数的值为`true`。
5.  将修改后的消息发送回服务器，即可绕过MFA验证。

**项目地址:** [c4cnm/CVE-2024-55210](https://github.com/c4cnm/CVE-2024-55210)

**漏洞详情:** [CVE-2024-55210](https://nvd.nist.gov/vuln/detail/CVE-2024-55210)