## CVE-2023-32315-Openfire-Authentication Bypass

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台，可能导致敏感信息泄露、配置更改甚至远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8 或 4.7.0 <= version < 4.7.5

**利用条件:** 目标Openfire实例处于漏洞影响版本范围，且setup未被禁用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 的路径遍历漏洞，允许未经身份验证的攻击者访问受限的管理页面。利用方式是访问 `/setup/setup-s/%u002e%u002e/%u002e%u002e/<受限页面>`。提供的POC代码尝试自动化这个过程，包括版本检测、获取JSESSIONID和CSRF令牌，并创建一个新的管理员用户。虽然代码本身看起来直接利用了该漏洞，但存在一些潜在的投毒风险：

*   **依赖性风险：** `requirements.txt` 文件中可能包含恶意依赖，虽然未在此次code中展示，但如果直接使用`pip install -r requirements.txt`仍存在潜在风险。
*   **远程资源风险：** README提到需要前往 `https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass/releases/tag/v0.1` 下载 webshell，这可能引入恶意代码。
*   **行为风险：** 该脚本本身执行创建用户的行为，如果滥用，可能对目标系统产生未授权的修改。

总的来说，POC代码的有效性较高，因为它直接利用了已知的路径遍历漏洞。投毒风险较低（约10%），主要集中在依赖和远程资源上，实际使用时，应该审核依赖文件，并尽量避免直接使用webshell。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/login.jsp` 并解析HTML内容来确定Openfire的版本。
2.  **认证绕过：** 利用路径遍历漏洞，通过访问类似 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 的URL来绕过身份验证。
3.  **会话劫持：** 获取JSESSIONID和CSRF令牌（如果存在），用于后续的操作。
4.  **创建用户：** 构造包含用户名、密码和管理员权限的POST请求，发送到 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-create.jsp`，从而创建一个新的管理员用户。

**项目地址:** [izzz0/CVE-2023-32315-POC](https://github.com/izzz0/CVE-2023-32315-POC)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)