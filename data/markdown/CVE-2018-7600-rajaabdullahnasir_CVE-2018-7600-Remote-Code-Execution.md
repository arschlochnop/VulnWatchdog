## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 需要Drupal网站运行在受影响的版本，且允许未授权访问的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。由于Drupal的Form API（FAPI）在处理AJAX请求时，未充分清理数组值，导致未经身份验证的攻击者可以通过构造恶意请求来执行任意代码。利用方式通常涉及发送包含恶意payload的POST请求到特定Drupal路径（例如/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax）。

**有效性：**
根据漏洞库信息、搜索引擎结果（如NVD、Rapid7、Trend Micro等）以及提供的POC代码，此漏洞是真实存在的，并且存在公开可用的利用代码。POC代码提供单目标、多目标、自定义命令执行等功能，并具有彩色CLI输出和日志记录，增加了利用的便利性，因此该POC代码有效。

**投毒风险：**
分析提供的`drupalgeddon2.py`代码片段，未发现明显的恶意投毒代码。代码主要功能是发送HTTP请求，执行命令，并解析结果，都是漏洞利用的正常行为。虽然存在远程代码执行的风险，但这是漏洞本身的性质，而不是POC引入的额外风险。README中存在免责声明，强调该工具仅用于授权的渗透测试。投毒风险评估为10%，主要考虑到以下几点：
* 代码的复杂性可能隐藏不易察觉的后门。
* 作者有可能在后续版本中添加恶意代码。

**利用方式：**
1.  确定目标Drupal网站是否运行在受影响的版本（Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1）。
2.  使用提供的POC脚本，指定目标URL和要执行的命令。
3.  运行脚本，脚本会发送特制的HTTP POST请求到Drupal网站。
4.  如果漏洞存在，Drupal网站将执行指定的命令，并将结果返回给攻击者。
5.  攻击者可以利用此漏洞进一步控制服务器，例如安装恶意软件、窃取数据等。

**项目地址:** [rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution](https://github.com/rajaabdullahnasir/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)