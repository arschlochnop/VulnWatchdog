## CVE-2014-4688-pfSense-命令注入

**漏洞编号:** CVE-2014-4688

**漏洞类型:** 命令注入

**影响应用:** pfSense

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.1.3

**利用条件:** 需要pfSense的管理界面登录凭证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-4688 允许远程认证用户通过多个参数执行任意命令。

**漏洞分析:**
根据漏洞库信息和搜索引擎结果，该漏洞存在于 pfSense 2.1.4 之前的版本中。攻击者需要首先通过管理界面进行身份验证。身份验证后，他们可以利用以下三个参数进行命令注入：
*   `diag_dns.php` 中的 `hostname` 值（创建别名时）。
*   `diag_smart.php` 中的 `smartmonemail` 值。
*   `status_rrd_graph_img.php` 中的 `database` 值。

**利用方式:**
攻击者需要在上述三个 PHP 脚本中找到一个可利用的参数，并在其中注入恶意命令。由于 pfSense 系统的特性，注入的命令通常以 root 权限执行，因此可能导致系统被完全控制。

**有效性:**
根据Exploit-DB上的信息（链接：https://www.exploit-db.com/exploits/43560），存在可用的利用代码，证明该漏洞是有效的。

**投毒风险:**
提供的POC代码是一个 `README.md` 文件，主要描述了漏洞本身。它只是一个简单的说明文件，用于解释漏洞的存在和影响。但是仓库的其他文件存在潜在的投毒风险, 例如是否包含恶意的nodejs脚本. 根据概率分析, 该代码库较小，主要用于描述漏洞，因此投毒的风险较低, 故推断存在 10% 的投毒风险。


**项目地址:** [fenix0499/CVE-2014-4688-NodeJs-Exploit](https://github.com/fenix0499/CVE-2014-4688-NodeJs-Exploit)

**漏洞详情:** [CVE-2014-4688](https://nvd.nist.gov/vuln/detail/CVE-2014-4688)