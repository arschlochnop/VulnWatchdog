## CVE-2022-1386 – Fusion Builder < 3.6.2 - Unauthenticated SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、内网服务攻击，绕过防火墙等。

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用受影响版本的Fusion Builder插件，且可以通过HTTP访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中小于 3.6.2 版本中存在的未经身份验证的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `admin-ajax.php` 发送特制的 POST 请求，利用此漏洞向任意 URL 发送 HTTP 请求。由于该请求是从服务器端发起的，因此可以绕过防火墙和访问控制措施，访问内部网络服务，例如获取 AWS EC2 元数据，扫描内部端口等。PoC 脚本首先从目标站点获取一个 nonce 值，然后使用该 nonce 值构造一个 multipart/form-data 格式的 POST 请求，其中 `fusionAction` 参数包含要请求的 URL。该请求被发送到 `admin-ajax.php` 端点。如果请求成功，服务器会返回请求 URL 的内容，或者如果使用了类似 Interact.sh 这样的回调服务，则会收到来自受害服务器的回调。该PoC本身没有发现明显的投毒代码,只是利用了SSRF漏洞。

**项目地址:** [fayassgit/CVE-2022-1386-FusionBuilder-SSRF](https://github.com/fayassgit/CVE-2022-1386-FusionBuilder-SSRF)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)