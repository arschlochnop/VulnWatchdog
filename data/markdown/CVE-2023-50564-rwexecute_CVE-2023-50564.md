## CVE-2023-50564-Pluck-CMS-任意文件上传

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck CMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.7.18

**利用条件:** 需要能够登录Pluck CMS后台

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50564 存在于 Pluck CMS v4.7.18 的 `/inc/modules_install.php` 组件中。该漏洞允许经过身份验证的攻击者通过上传特制的 ZIP 文件来执行任意代码。利用方式如下：

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 Pluck CMS 后台。
2.  **构造恶意ZIP文件：**  攻击者创建一个包含恶意代码（例如 PHP 反向 shell）的 ZIP 文件。
3.  **上传ZIP文件：** 攻击者导航到 `/admin.php?action=installmodule`，并上传构造的 ZIP 文件。POC中使用了 `requests_toolbelt` 库来构造multipart/form-data请求。
4.  **代码执行：**  成功上传后，恶意代码将被解压并执行，从而允许攻击者在服务器上执行任意命令。

**有效性分析：**

*   漏洞库信息、搜索引擎结果和提供的漏洞利用代码都确认了该漏洞的存在和利用方式。
*   POC代码通过模拟登录和文件上传流程，实现了漏洞的利用。代码逻辑清晰，利用步骤与漏洞描述一致，因此POC代码有效。

**投毒风险分析：**

*   分析提供的漏洞利用代码，未发现作者隐藏的恶意代码。该脚本的目的是利用 CVE-2023-50564 上传一个用户提供的 ZIP 文件，本身不包含任何其他功能。
*   代码只包含用于漏洞利用的必要功能，没有发现任何可疑或隐藏的行为。LICENSE和README文件也只包含了版权信息和使用说明。
*   因此，可以判断此仓库中不存在作者隐藏的投毒代码的概率为0%。

**利用方式总结：**

攻击者利用此漏洞，首先需要登录后台，然后构造包含恶意PHP代码的ZIP文件，上传到 `/inc/modules_install.php` ， 触发代码执行，最终获取服务器控制权。

**项目地址:** [rwexecute/CVE-2023-50564](https://github.com/rwexecute/CVE-2023-50564)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)