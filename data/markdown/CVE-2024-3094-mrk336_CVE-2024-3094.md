## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，允许未经授权的远程访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受感染的XZ Utils版本，且sshd链接了liblzma

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入XZ Utils库的5.6.0和5.6.1版本。该后门通过修改liblzma的代码，允许攻击者在未经授权的情况下通过SSH远程访问受感染的系统。利用方式如下：

1.  **代码注入：** 恶意代码通过复杂的混淆技术被嵌入到liblzma的构建过程中。
2.  **SSH拦截：** 被注入的代码可以拦截SSH连接，并允许攻击者绕过身份验证。
3.  **远程访问：** 攻击者可以通过SSH连接到受感染的系统，并在系统上执行任意代码。

提供的POC代码的有效性需要验证，因为它与实际漏洞的运作方式有所不同。实际的漏洞利用更为隐蔽，不是简单地修改`src/compress.c`文件。POC中直接修改`compress.c`并添加SSH密钥到`authorized_keys`的方式过于简单粗暴，更容易被检测到，实用性不大，不能完全体现漏洞的完整利用流程。

**投毒风险分析：**

代码仓库本身存在少量投毒风险，判断的依据是:
*   LICENSE声明年份为2025年，属于未来时间，表明代码库可能存在问题。
*   README.md中描述的攻击步骤与已知的漏洞利用方式存在差异，尤其是`backdoor.patch`的内容过于简单。实际的XZ后门远比POC展示的复杂得多，该POC可能无法成功复现漏洞。
*   install_xz_backdoor.sh脚本内容缺失，进一步增加了代码库的可疑程度。

尽管存在风险，但该代码仓库更大的可能性是简化版的POC，用于展示漏洞原理，而非真正的恶意代码投毒。 总体分析认为投毒概率较低。

**项目地址:** [mrk336/CVE-2024-3094](https://github.com/mrk336/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)