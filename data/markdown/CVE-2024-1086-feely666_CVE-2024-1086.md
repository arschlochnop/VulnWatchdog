## CVE-2024-1086

**漏洞编号:** CVE-2024-1086

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** 3.15 to 6.8

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-1086 是 Linux 内核 netfilter (nf_tables) 组件中的一个 use-after-free 漏洞。此漏洞允许本地攻击者提升权限。

**有效性：**
根据搜索引擎结果，该漏洞存在公开可用的 PoC (Proof of Concept) 代码，并且已被积极利用。

**投毒风险：**
提供的 POC 代码仅仅是一个 `README.md` 文件，不包含任何可执行代码。因此，不存在作者隐藏投毒代码的风险。 投毒风险评估为0%。

**利用方式：**
漏洞存在于 `nft_verdict_init()` 函数中，该函数允许正值作为 hook 判决中的 drop 错误。当使用带有类似 NF_ACCEPT 的 drop 错误的 NF_DROP 时，`nf_hook_slow()` 函数可能导致双重释放漏洞。

攻击者可以通过利用此漏洞，将普通用户权限提升到 root 权限。 具体利用方式涉及到 netfilter 和 nf_tables 的配置，构造特定的网络数据包触发漏洞，从而控制内核执行流程，实现权限提升。

**项目地址:** [feely666/CVE-2024-1086](https://github.com/feely666/CVE-2024-1086)

**漏洞详情:** [CVE-2024-1086](https://nvd.nist.gov/vuln/detail/CVE-2024-1086)