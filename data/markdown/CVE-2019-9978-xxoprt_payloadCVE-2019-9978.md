## CVE-2019-9978-Social-Warfare-Stored-XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致用户凭据泄露，网站内容篡改或恶意代码执行

**影响版本:** < 3.5.3

**利用条件:** 需要目标网站安装了Social Warfare插件，且版本低于3.5.3，攻击者需要具有向插件配置项写入数据的权限（通常通过利用另一个漏洞实现，例如未授权的设置更新）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978 是 WordPress Social Warfare 插件3.5.3之前版本中的一个存储型XSS漏洞。该漏洞源于对 `swp_url` 参数的输入没有进行充分的过滤。攻击者可以通过 `wp-admin/admin-post.php?swp_debug=load_options` 端点注入恶意 JavaScript 代码。

**有效性分析：**
根据漏洞描述，攻击者通过构造包含恶意 JavaScript 代码的 `swp_url` 参数，利用 `swp_debug=load_options` 触发插件的设置加载功能，将恶意代码存储到插件的配置项中。当管理员或其他用户访问包含该配置的页面时，恶意代码会被执行。

提供的PoC代码包含一个 `payload.txt` 文件，其中包含 `<pre>system('cat /etc/passwd')</pre>`。该代码尝试使用 `system()` 函数执行系统命令 `cat /etc/passwd`，以读取服务器的密码文件。如果此payload成功注入并执行，将造成严重安全问题。

根据搜索结果，该漏洞已在野外被利用，证明了其有效性。

**投毒风险分析：**
该仓库包含一个 `README.md` 和一个 `payload.txt` 文件。
*   `README.md` 文件内容为 "ssssss"，没有可疑代码。
*   `payload.txt` 文件包含执行系统命令的代码，目的是验证漏洞，并非投毒。

但是依然存在一些投毒风险，需要关注。
*   攻击者可能会修改 `payload.txt` 中的代码，例如替换为恶意链接或更隐蔽的恶意代码。
*   攻击者可能在其他文件中添加恶意代码，例如通过 `eval()` 函数执行远程代码。

综合来看，投毒风险较低，但仍然需要仔细审查代码。

**利用方式分析：**
1.  **找到存在漏洞的 WordPress 站点：** 确定目标站点安装了 Social Warfare 插件，并且版本低于 3.5.3。
2.  **利用漏洞注入恶意代码：**  构造包含恶意 JavaScript 代码的 `swp_url` 参数，发送到 `wp-admin/admin-post.php?swp_debug=load_options` 端点。
3.  **等待恶意代码执行：** 等待管理员或其它用户访问包含受污染配置的页面，触发恶意代码的执行。恶意代码可以窃取用户 Cookie、重定向到恶意网站、篡改页面内容等。

利用此漏洞需要能够修改插件设置，通常攻击者需要利用其他的漏洞比如未授权配置更新来配合利用。根据搜索结果，该漏洞有时会与RCE漏洞一起被提及，因此确认目标是否存在相关漏洞至关重要。

**项目地址:** [xxoprt/payloadCVE-2019-9978](https://github.com/xxoprt/payloadCVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)