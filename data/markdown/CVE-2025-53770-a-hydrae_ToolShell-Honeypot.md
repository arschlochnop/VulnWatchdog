## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016、SharePoint Server 2019、SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于本地 Microsoft SharePoint Server 中的远程代码执行漏洞，由于不安全的反序列化未授权的数据导致。根据搜索结果和漏洞信息，该漏洞已经被积极利用。漏洞利用方式涉及构造恶意的序列化数据，发送到 SharePoint Server，导致服务器执行任意代码。

提供的“漏洞利用代码”实际上是一个 Docker 化的 honeypot 设置，旨在检测针对该漏洞（以及其他 SharePoint 漏洞）的利用尝试，而不是实际的利用代码。它包含两个服务：

1.  **Honeypot (Flask):**  使用 Flask 框架模拟 SharePoint 服务器，监听 HTTP 请求，并使用 Python 代码和 YARA 规则检测恶意 payload，例如 webshell 和编码命令。
2.  **Dashboard (Streamlit):**  使用 Streamlit 框架提供一个仪表盘，用于可视化和导出 Honeypot 收集到的日志。

**有效性评估:**

提供的代码不是漏洞利用代码，而是蜜罐代码。它用于检测漏洞利用尝试。

**投毒风险分析:**

*   **Dockerfile.dashboard:**  Dockerfile很简单，只是用于部署streamlit应用，没有发现可疑行为。
*   **Dockerfile.honeypot:**  这个Dockerfile更复杂一些，它安装了flask和yara-python，并且从本地拷贝了yara规则。 风险点在于`yara_rules/` 目录下的YARA规则。如果这些规则被恶意构造，可能会导致honeypot在特定情况下误报或者执行非预期的操作，但这些操作仍然在容器内部，很难逃逸。`cert.pem`和`key.pem`是自签名证书，攻击者可能利用它们来混淆攻击流量，但风险相对较低。
*   **honeypot.py:** 该文件是蜜罐的核心，负责接收和处理HTTP请求。漏洞检测逻辑（例如Python检测和YARA扫描）都集中在这里。如果检测逻辑存在缺陷，例如未能正确转义用户输入，或者YARA规则存在漏洞，攻击者可能会绕过蜜罐的检测机制。  检查了该文件是否包含任何后门代码。

总的来说，该存储库中存在作者隐藏的投毒代码的可能性较低，估计为10%。主要风险在于YARA规则被恶意构造，或者蜜罐的检测逻辑存在缺陷。

**利用方式 (针对 CVE-2025-53770):**

攻击者利用 SharePoint Server 中不安全的反序列化漏洞，通过发送特制的 HTTP 请求，其中包含恶意的序列化数据。当 SharePoint Server 反序列化这些数据时，会导致任意代码执行，从而允许攻击者控制服务器。 具体利用细节需要进一步的漏洞分析研究来确定恶意序列化数据的构造方式和所使用的特定反序列化 Gadget Chain。

**项目地址:** [a-hydrae/ToolShell-Honeypot](https://github.com/a-hydrae/ToolShell-Honeypot)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)