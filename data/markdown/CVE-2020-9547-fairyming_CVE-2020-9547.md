## CVE-2020-9547：FasterXML jackson-databind 远程代码执行漏洞

**漏洞编号:** CVE-2020-9547

**漏洞类型:** 反序列化漏洞

**影响应用:** FasterXML jackson-databind

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.x before 2.9.10.4

**利用条件:** 目标应用使用了存在漏洞的jackson-databind，且允许反序列化不可信数据。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-9547 漏洞是 FasterXML jackson-databind 中存在的一个反序列化漏洞。该漏洞源于 jackson-databind 在处理序列化 gadget 和类型信息时存在缺陷，允许攻击者利用 com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig (aka ibatis-sqlmap) 类执行任意代码。

**有效性：**
提供的 POC 代码利用了该漏洞，通过构造包含恶意类的 JSON 数据，可以触发反序列化过程，从而执行攻击者预先设定的代码。
根据漏洞描述和POC代码，该漏洞利用的有效性较高。

**投毒风险：**
分析仓库中的代码后，发现 Poc.java 实现了漏洞验证，README.md 描述了漏洞信息。/tmp/d91aa4dc3e6545831e7dca65df5f74c8/Poc.java中的ldap地址`ldap://localhost:1389/Exploit`，如果实际攻击中直接使用该地址，可能连接到攻击者控制的恶意LDAP服务器，存在一定的投毒风险。仓库中包含`images/WechatIMG798.png`图片，暂未发现其他恶意代码。综合来看，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意类的 JSON 数据，例如 POC 中使用的 `com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig` 类。
2.  攻击者将构造的 JSON 数据发送给目标应用程序。
3.  目标应用程序使用存在漏洞的 jackson-databind 库对 JSON 数据进行反序列化。
4.  反序列化过程中，恶意类被实例化，执行攻击者预先设定的代码，例如通过 LDAP 注入执行任意代码。

**结论：**
该漏洞利用的有效性较高，但存在一定的投毒风险（主要集中在LDAP地址）。漏洞利用方式是构造恶意的 JSON 数据，诱使目标应用程序反序列化，从而执行任意代码。

**项目地址:** [fairyming/CVE-2020-9547](https://github.com/fairyming/CVE-2020-9547)

**漏洞详情:** [CVE-2020-9547](https://nvd.nist.gov/vuln/detail/CVE-2020-9547)