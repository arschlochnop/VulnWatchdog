## CVE-2022-46604-Responsive FileManager-RCE

**漏洞编号:** CVE-2022-46604

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Responsive FileManager

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 9.9.5

**利用条件:** 需要身份验证（低权限用户即可）以及上传文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46604是Tecrail Responsive FileManager 9.9.5及以下版本中存在的一个文件扩展名绕过漏洞，允许经过身份验证的攻击者上传恶意PHP文件，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是exploit-db.com）以及GitHub上的POC仓库信息，该漏洞的利用是有效的。多个来源都确认了该漏洞的存在和可利用性。

提供的POC代码`/tmp/5cdc81c8c181540e8e03c8f4d97ce816/README.md`本身并没有包含利用代码，只是一个README文件，指示漏洞的利用已经存在公开的PoC。因此，需要查找其他的PoC代码，例如github上 **galoget/ResponsiveFileManager-CVE-2022-46604** 提供的Python3 脚本。

**投毒风险：**

虽然主要的风险在于漏洞本身的利用，但仍然存在潜在的投毒风险。目前提供的文件是一个README文件，投毒风险很低，约10%。但需要注意以下几点：

*   如果下载和使用了其他来源的POC代码（例如GitHub上的脚本），需要仔细审查代码，防止其中包含恶意代码，例如反弹shell、添加后门等。
*   攻击者可能会伪造POC，诱骗用户下载包含恶意代码的文件。

**利用方式：**

1.  **身份验证：** 攻击者需要先通过身份验证，获得上传文件的权限，该权限要求不高，低权限用户即可利用。
2.  **文件扩展名绕过：** 攻击者利用文件扩展名绕过机制，上传一个包含恶意PHP代码的文件。常见的绕过方法包括：
    *   使用双扩展名（例如：`evil.php.jpg`）。
    *   修改Content-Type头。
    *   利用文件名中的空格或特殊字符。
3.  **远程代码执行：** 上传的PHP文件被服务器解析执行，攻击者从而可以执行任意代码，控制服务器。

**项目地址:** [SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager](https://github.com/SakshiVelampudi/CVE-2022-46604-Responsive-File-Manager)

**漏洞详情:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)