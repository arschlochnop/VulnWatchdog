## CVE-2022-31160-jQuery UI-XSS

**漏洞编号:** CVE-2022-31160

**漏洞类型:** XSS

**影响应用:** jQuery UI

**危害等级:** 中危，可能导致用户浏览器执行恶意脚本

**影响版本:** < 1.13.2

**利用条件:** 需要用户交互，且目标网站使用了受影响版本的jQuery UI

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-31160是jQuery UI的一个XSS漏洞，存在于checkboxradio组件的刷新(refresh)功能中。当checkboxradio组件的input元素被label标签包裹时，调用`.checkboxradio("refresh")`会导致label标签内的HTML实体被错误地解码，如果HTML实体中包含恶意JavaScript代码，就会被执行，从而导致XSS攻击。

**有效性：**
提供的POC代码通过Docker容器部署了一个包含漏洞版本的jQuery UI的示例页面。通过访问示例页面，用户可以触发漏洞，验证其有效性。

**投毒风险：**
查看`/tmp/2b3c6e99ab628ca386ae720d6c3c1976/Dockerfile`，`/tmp/2b3c6e99ab628ca386ae720d6c3c1976/README.md`等文件,未发现明显的恶意代码。考虑到该POC的主要目的是演示漏洞，隐藏恶意代码的可能性较低。虽然无法完全排除投毒的可能性，但风险较低，估算为1%。

**利用方式：**
1.  目标网站使用低于1.13.2版本的jQuery UI。
2.  网站的HTML代码中，checkboxradio组件的input元素被label标签包裹，并且label标签的内容包含HTML实体编码的恶意JavaScript代码。
3.  在页面加载或者某些用户操作后，调用了`.checkboxradio("refresh")`方法刷新checkboxradio组件。
4.  由于HTML实体被错误解码，恶意JavaScript代码得以执行，实现XSS攻击。

攻击者可以利用此漏洞在用户浏览器中执行任意JavaScript代码，例如窃取用户的Cookie、篡改页面内容、重定向用户到恶意网站等。


**项目地址:** [r00nin/jquery-cve-2022-31160](https://github.com/r00nin/jquery-cve-2022-31160)

**漏洞详情:** [CVE-2022-31160](https://nvd.nist.gov/vuln/detail/CVE-2022-31160)