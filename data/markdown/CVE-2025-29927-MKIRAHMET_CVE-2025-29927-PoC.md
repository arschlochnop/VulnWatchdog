## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用Next.js中间件进行权限校验，且存在漏洞版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是 Next.js 中间件中存在的一个权限绕过漏洞。攻击者可以通过操纵 `X-Middleware-Subrequest` 请求头来绕过身份验证，从而访问受保护的资源。PoC 代码通过发送带有特定 `X-Middleware-Subrequest` 头的 HTTP 请求，并比较 baseline（不带 header）和带有 header 的请求的响应，从而检测漏洞是否存在。如果状态码为 200 且响应内容不同，则表明应用可能存在漏洞。

**有效性：** PoC代码有效。它通过发送带有特定头部信息的请求来验证漏洞，并根据响应的差异来判断目标是否存在漏洞。

**投毒风险：** 投毒风险较低，大约为 5%。

分析：
*   该代码的主要功能是测试目标是否存在 CVE-2025-29927 漏洞。
*   代码首先提示用户输入目标域名，然后构造包含恶意路径的 URL。
*   `X-Middleware-Subrequest` 头部用于触发漏洞。
*   代码发送两个 HTTP GET 请求：一个不带头部，另一个带 `X-Middleware-Subrequest` 头部。
*   比较两个请求的响应状态码和内容。如果状态码为 200 并且内容不同，则认为目标易受攻击。

投毒风险评估：

*   **README.md 明确声明代码仅用于教育目的，并且仅应针对本地或实验环境运行。**
*   **PoC 代码本身并不包含任何明显的恶意代码，例如后门或数据泄露功能。**
*   **代码的目的是验证漏洞，而不是利用漏洞。**
*   存在一定的风险：虽然代码本身没有恶意，但用户可能会误用此代码，并将其用于未经授权的测试或攻击。此外，即使代码的目的是验证漏洞，也可能会意外地泄露目标系统的信息。

**利用方式：**

1.  攻击者构造包含 `X-Middleware-Subrequest` 头的恶意 HTTP 请求。
2.  Next.js 中间件未能正确处理该头部，导致权限检查被绕过。
3.  攻击者可以访问原本需要授权才能访问的资源，如敏感数据或管理页面。

**项目地址:** [MKIRAHMET/CVE-2025-29927-PoC](https://github.com/MKIRAHMET/CVE-2025-29927-PoC)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)