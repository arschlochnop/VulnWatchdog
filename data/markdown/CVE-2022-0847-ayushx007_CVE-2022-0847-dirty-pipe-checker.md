## CVE-2022-0847 Dirty Pipe 本地提权漏洞

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, 5.15.25, 5.10.102

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的本地权限提升漏洞。该漏洞源于pipe buffer结构中的"flags"成员未正确初始化，导致可能包含陈旧值。攻击者可以利用此漏洞覆盖只读文件在page cache中的内容，进而提升权限。

**有效性分析：**
提供的PoC代码 `dpipe.sh` 是一个检测脚本，用于判断目标系统的Linux内核版本是否存在Dirty Pipe漏洞。它通过解析内核版本号，并与已知受影响的版本范围进行比较，以此来确定系统是否易受攻击。此脚本本身并不执行漏洞利用，而是作为漏洞检测工具。

**投毒风险分析：**
提供的PoC代码 `dpipe.sh` 本身不包含任何恶意代码。它只是一个版本检测脚本，用于判断目标内核是否受影响。因此，投毒风险为0%。

**利用方式分析：**
1.  **查找可写文件：** 攻击者首先需要找到一个具有适当权限但内容可以被覆盖的文件（例如，SUID程序）。
2.  **创建管道：** 创建一个管道，并通过`splice`系统调用将只读文件数据注入管道。
3.  **修改管道缓冲区标志：** 利用漏洞覆盖pipe buffer的flags，从而允许写入操作。
4.  **写入恶意代码：** 将恶意代码写入管道，这些代码会覆盖只读文件在page cache中的内容。
5.  **执行被篡改的文件：** 运行被篡改的SUID程序或其他被覆盖的文件，从而以更高的权限执行恶意代码，达到提权的目的。

**搜索引擎结果总结：**
搜索结果确认了CVE-2022-0847是一个本地权限提升漏洞，影响Linux内核，并被广泛利用。多个PoC已公开，使得该漏洞易于利用。CISA已将其添加到已知被利用漏洞目录中，强调了其严重性。

**优先级排序：**
鉴于搜索引擎结果与漏洞库信息相符，且提供了更多关于漏洞利用和影响的上下文，因此搜索引擎结果优先级最高。漏洞利用代码（检测脚本）次之，因为它仅提供版本检测功能。漏洞库信息提供了漏洞的基本描述和受影响版本，但不如搜索引擎结果全面。

**项目地址:** [ayushx007/CVE-2022-0847-dirty-pipe-checker](https://github.com/ayushx007/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)