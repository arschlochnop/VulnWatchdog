## CVE-2017-7269-IIS 6.0-缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** IIS 6.0 (Windows Server 2003 R2)

**利用条件:** 目标系统运行IIS 6.0并且WebDAV服务启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7269是Microsoft IIS 6.0中的WebDAV服务中ScStoragePathFromUrl函数存在缓冲区溢出漏洞。攻击者可以通过发送特制的PROPFIND请求，其中包含一个以"If: <http://"开头的长header，从而触发漏洞，导致任意代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且已经被广泛利用。存在公开的POC代码（如提供的Python脚本）和Metasploit模块。因此，提供的POC代码具有较高的有效性。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是生成包含恶意payload的HTTP PROPFIND请求。Payload的构造方式是利用超长字符串触发缓冲区溢出。其中包含一段shellcode。

仔细检查脚本，没有发现明显的投毒代码，例如连接外部服务器下载恶意代码或修改系统关键文件。虽然POC本身是为了利用漏洞，但并*没有*发现额外用于攻击者隐藏恶意目的的 *后门代码*。

因此，投毒风险较低，但不能完全排除。攻击者可能修改脚本，添加额外的恶意功能。需要在使用前进行仔细审查。

**利用方式：**
1.  **目标识别：** 确定目标系统是否运行IIS 6.0并启用了WebDAV服务。
2.  **POC利用：** 运行提供的Python脚本，指定目标IP地址和端口（通常是80）。
3.  **Payload生成：** 脚本会生成一个包含特制"If:" header的HTTP PROPFIND请求。Header中包含的超长字符串旨在溢出ScStoragePathFromUrl函数的缓冲区。
4.  **发送请求：** 脚本将构造的HTTP请求发送到目标服务器。
5.  **代码执行：** 如果漏洞利用成功，服务器会执行payload中的shellcode，从而允许攻击者在服务器上执行任意代码。攻击者可以在shellcode中嵌入反向shell或执行其他恶意操作。

**搜索引擎结果重要信息：**
*   多个安全厂商（如Fortinet, F5, Trend Micro）报告了针对该漏洞的攻击活动。
*   攻击者利用该漏洞进行挖矿（Electroneum, Monero）等恶意活动。
*   Rapid7提供了该漏洞的详细信息和Metasploit模块。
*   Juniper Networks发布了用于检测该漏洞利用的IPS签名。

**项目地址:** [lcatro/CVE-2017-7269-Echo-PoC](https://github.com/lcatro/CVE-2017-7269-Echo-PoC)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)