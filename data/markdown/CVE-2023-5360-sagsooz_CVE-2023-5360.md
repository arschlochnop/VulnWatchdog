## CVE-2023-5360 - Royal Elementor Addons and Templates - Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress插件启用 Royal Elementor Addons and Templates，且版本低于1.3.79，目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中。该插件在 1.3.79 之前的版本中，未对上传的文件进行充分验证，导致未经身份验证的攻击者可以上传任意文件，包括 PHP 脚本等，从而实现远程代码执行。

**利用方式：**

1.  攻击者构造恶意请求，上传包含恶意代码的 PHP 文件。
2.  由于文件上传验证不足，恶意文件被成功上传到服务器。
3.  攻击者通过访问上传的 PHP 文件，执行其中的恶意代码，从而控制服务器。

**有效性：**

根据漏洞描述和搜索结果，该漏洞的 POC 代码应该有效，可以实现未经身份验证的任意文件上传。

**投毒风险分析：**

提供的 `exploit.py` 代码进行了混淆处理，降低了可读性，增加了分析难度。代码中存在如下可疑行为：

1.  使用了 `pycryptodome` 库，但没有明确说明用途，可能用于加密或解密恶意代码。
2.  代码中存在 `pyobfuscate` 字符串，暗示代码经过了某种形式的混淆处理（`pyobfuscate.com`）。
3.  代码中包含大量编码和解码操作（base64, zlib），可能用于隐藏恶意代码。
4.  代码中存在设置 `__builtins__` 对象属性的操作，修改了内置函数 `print`、`exec` 和 `eval`，可能用于隐藏恶意行为或绕过安全检测。

综合以上因素，可以判定该 POC 代码存在较高的投毒风险。攻击者可能在混淆的代码中隐藏了恶意后门，例如反弹 shell 或植入恶意软件。在使用该 POC 代码时需要格外小心，避免在生产环境中直接运行。

综上所述，该POC利用的有效性较高，但投毒风险也较高，建议在隔离环境中进行测试和分析。


**项目地址:** [sagsooz/CVE-2023-5360](https://github.com/sagsooz/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)