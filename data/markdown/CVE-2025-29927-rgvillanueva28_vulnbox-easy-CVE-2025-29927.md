## CVE-2025-29927-Next.js-Middleware-权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要Next.js应用使用middleware进行权限验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927是Next.js middleware中的一个权限绕过漏洞。根据漏洞库信息和搜索结果，该漏洞源于Next.js处理`x-middleware-subrequest` header的方式存在缺陷，允许攻击者绕过在middleware中实现的身份验证机制。

**有效性：** 根据提供的代码，看起来是一个完整的Next.js应用，并且在`middleware.ts`中实现了基于JWT的权限验证。这个POC可能是有效的，因为它模拟了一个真实的场景，其中权限验证是在middleware中进行的。利用方式如下所述。

**利用方式：**
攻击者可以通过发送包含特定`x-middleware-subrequest` header的恶意请求来绕过middleware的权限检查。具体利用方式需要分析Next.js如何处理这个header，以及如何修改请求才能绕过验证。由于POC只提供应用代码，没有直接的exploit代码，需要进一步分析应用行为构造恶意请求。

**投毒风险：**
检查Dockerfile、docker-compose.yml、docker-entrypoint.sh等文件，没有发现明显的恶意代码。docker-entrypoint.sh 主要负责数据库迁移和初始化。middleware.ts 实现了权限绕过的验证代码，不能算作投毒代码。Dockerfile，docker-compose.yml和env配置文件没有发现任何恶意投毒的痕迹，判断仓库中存在作者隐藏的投毒代码的可能性较低，因此风险评估为1%。

**项目地址:** [rgvillanueva28/vulnbox-easy-CVE-2025-29927](https://github.com/rgvillanueva28/vulnbox-easy-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)