## CVE-2022-36537-ZK Framework-信息泄露/RCE

**漏洞编号:** CVE-2022-36537

**漏洞类型:** 信息泄露/远程代码执行

**影响应用:** ZK Framework

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** v9.6.1, 9.6.0.1, 9.5.1.3, 9.0.1.2 and 8.6.4.1

**利用条件:** 目标系统运行受影响版本的ZK Framework，且攻击者可以发起网络请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-36537 漏洞存在于 ZK Framework 的 AuUploader 组件中。攻击者可以发送特制的 POST 请求来访问敏感信息，未经身份验证即可读取web应用程序上下文中的任意文件。根据搜索引擎结果，该漏洞已经被积极利用，并且可能导致远程代码执行（RCE），尤其是在 R1Soft Server Backup Manager 等产品中。提供的Python脚本利用了身份验证绕过漏洞，可能实现任意文件读取和 JDBC 后门部署。风险点主要存在于JDBC后门部署，攻击者可通过构造恶意的JDBC连接字符串执行任意代码。投毒风险评估为较低(10%)，因为脚本的主要功能是利用已知漏洞，但jdbc后门部署存在一定风险,可能被恶意利用。

**利用方式：**

1.  **身份验证绕过：** 通过`bypass_auth2`函数，利用漏洞绕过身份验证，获取`dtid`和`JSESSIONID`。
2.  **任意文件读取：** 通过`read_file`函数，构造包含`nextURI`参数的POST请求，读取目标服务器上的任意文件。
3.  **JDBC后门部署（RCE）：** 通过`deploy_jdbc_backdoor`函数，上传恶意的JDBC驱动，实现远程代码执行。此步骤存在较高风险，可能被用于植入恶意代码。

**代码分析:**

*   脚本使用`requests`库发送HTTP请求，`selenium`库用于辅助身份验证绕过（但已被标记为`Deprecated`）。
*   脚本包含读取文件和部署JDBC后门的功能，但后者存在较大风险。
*   代码中存在proxy设置,存在一定的可控性。
*   build_jdbc_backdoor和upload_jdbc_backdoor方法未完整展示,不排除存在一定风险。

**安全建议:**

*   及时升级ZK Framework到安全版本。
*   限制对AuUploader组件的访问。
*   加强对JDBC驱动的验证，防止恶意驱动被上传。

**项目地址:** [agnihackers/CVE-2022-36537-EXPLOIT](https://github.com/agnihackers/CVE-2022-36537-EXPLOIT)

**漏洞详情:** [CVE-2022-36537](https://nvd.nist.gov/vuln/detail/CVE-2022-36537)