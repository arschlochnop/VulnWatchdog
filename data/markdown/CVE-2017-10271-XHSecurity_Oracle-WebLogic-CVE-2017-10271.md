## CVE-2017-10271 WebLogic WLS 组件远程代码执行漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启 T3 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 漏洞是 Oracle WebLogic Server WLS 组件中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 XML 数据，利用 WebLogic Server 的 XMLDecoder 反序列化漏洞执行任意代码，从而完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是有效的。它利用了 WebLogic Server 的 `wls-wsat` 组件中的 XMLDecoder 反序列化漏洞，允许攻击者执行任意代码。POC 包含两种利用方式，一种是写入 JSP Webshell，另一种是直接执行系统命令。

**投毒风险：**
仓库中存在一定的投毒风险，评估为10%。

*   **风险分析：** 虽然主要的POC代码是为了利用漏洞，但也存在潜在的风险，攻击者可能在实际利用中修改POC，植入恶意代码，例如反弹shell，添加后门账户等，这种风险难以完全排除。
*   **缓解措施：** 在使用任何公开的漏洞利用代码之前，必须对其进行彻底审查，理解其工作原理，并确保没有恶意行为。在测试环境中验证 POC，而不是在生产环境中直接使用。

**利用方式：**

1.  **确定目标服务器的 WebLogic Server 版本是否在受影响范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。**
2.  **通过 T3 协议（或其他方式）向 `/wls-wsat/CoordinatorPortType` 等 `wls-wsat` 目录下的端点发送包含恶意 XML 数据的 SOAP 请求。**
3.  **恶意 XML 数据利用 `java.beans.XMLDecoder` 反序列化漏洞，执行攻击者预先设定的代码。**
4.  **攻击者可以执行以下操作：**
    *   **写入 JSP Webshell：** 将 JSP 代码写入 Web 服务器的可访问目录，从而获得一个 webshell，允许通过 HTTP 访问目标服务器并执行命令。
    *   **直接执行系统命令：** 通过 `java.lang.ProcessBuilder` 等类执行任意系统命令。

**漏洞缓解措施：**

*   **安装 Oracle 官方提供的补丁。**
*   **禁用 T3 协议，如果不需要使用。**
*   **限制对 `/wls-wsat/` 目录的访问。**

**项目地址:** [XHSecurity/Oracle-WebLogic-CVE-2017-10271](https://github.com/XHSecurity/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)