## CVE-2025-29927-Next.js-权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要应用程序使用了Next.js中间件进行权限验证

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件中的一个权限绕过漏洞。该漏洞允许攻击者绕过中间件中的身份验证检查，从而获得未经授权的访问权限。根据漏洞库信息，受影响的版本包括 Next.js 11.1.4 到 13.5.6，14.0.0 到 14.2.25 和 15.0.0 到 15.2.3。漏洞原因是Next.js在处理某些请求时，没有正确验证`x-middleware-subrequest`头，导致攻击者可以通过伪造该请求头来绕过身份验证。利用方式是：

1.  攻击者构造包含 `x-middleware-subrequest` 头的恶意请求。
2.  如果应用程序使用 Next.js 中间件进行身份验证，并且没有正确验证 `x-middleware-subrequest` 头，则攻击者可以绕过身份验证。
3.  攻击者获得未经授权的访问权限。

提供的漏洞利用代码仅包含 MIT 许可证，没有任何可执行代码。因此，无法确定漏洞利用代码的有效性，且不存在投毒风险。根据漏洞库信息，缓解措施包括升级到 Next.js 14.2.25 或 15.2.3，或者防止外部用户请求包含 `x-middleware-subrequest` 头的请求到达 Next.js 应用程序。

**项目地址:** [BugHawak/CVE-2025-29927](https://github.com/BugHawak/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)