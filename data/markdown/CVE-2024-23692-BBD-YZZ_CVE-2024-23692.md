## CVE-2024-23692 - Rejetto HTTP File Server Template Injection RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行存在漏洞的Rejetto HFS，并能通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的模板注入漏洞。攻击者可以通过发送特制的HTTP请求，在服务器上执行任意命令。由于Rejetto HFS已经停止维护，无法通过官方补丁修复此漏洞。

**有效性分析：**
提供的POC代码（hfs.go）利用了该模板注入漏洞，允许攻击者执行命令、执行DNSLog检测等操作。

**投毒风险分析：**
检查了提供的代码仓库，没有发现明显的恶意代码，但是存在以下几点潜在的投毒风险：
1.  **DNSLog配置：** 默认使用ceye.io，如果ceye.io被恶意利用，可能会导致信息泄露。
2.  **代码依赖：** 依赖gopkg.in/ini.v1，此依赖如果存在漏洞，可能会被利用。
3.  **命令执行：** 命令执行本身就存在风险，如果目标系统权限过高，可能会导致严重的安全问题。
4.  **网络请求：** 攻击代码中会发出网络请求，具有一定的流量特征，可以分析网络流量判断是否存在恶意行为。
因此，整体投毒的概率较低，估计为5%。

**利用方式：**
1.  攻击者首先需要确定目标系统运行的是存在漏洞的Rejetto HFS 2.3m。
2.  攻击者可以利用POC代码，通过`-u`参数指定目标URL。
3.  可以使用`-cmd`参数进入命令行模式，执行任意命令。 例如: `go run hfs.go -u http://127.0.0.1 -cmd`。
4.  可以使用`-dns`参数进行DNSLog检测，验证漏洞是否存在。 例如: `go run hfs.go -u http://127.0.0.1 -dns` 或者 `go run hfs.go -u http://127.0.0.1 -dns -d abc.cn`。
5.  如果需要使用代理，可以通过`-p`参数指定代理服务器地址。 例如: `go run hfs.go -u http://127.0.0.1 -cmd -p http://user:pass@127.0.0.1:8080`。

**缓解措施：**
由于Rejetto HFS已经停止维护，建议用户停止使用该软件，并迁移到其他安全的文件服务器软件。

**项目地址:** [BBD-YZZ/CVE-2024-23692](https://github.com/BBD-YZZ/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)