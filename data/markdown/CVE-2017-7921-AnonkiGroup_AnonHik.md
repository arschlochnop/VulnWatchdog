## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** 受影响版本：DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络可达，且目标设备运行受影响的固件版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921 是 Hikvision 摄像机中存在的一个不当身份验证漏洞。攻击者可以通过构造特定的 URL，绕过身份验证，未经授权访问摄像头的快照。提供的 POC 代码 `AnonHik.py` 通过向目标摄像头的 `/onvif-http/snapshot` 路径发送包含硬编码凭据 `admin:11` 的请求，尝试获取快照。如果摄像头存在漏洞，则会返回快照并保存到本地。分析`AnonHik.py`脚本，该脚本主要功能是发送带有硬编码用户名密码（admin:11）的URL请求，并没有发现恶意代码，`README.md`文件只是简单的描述和演示，所以投毒风险判断为0%。利用方式主要是通过未授权访问`/onvif-http/snapshot`，获得摄像头快照。

**项目地址:** [AnonkiGroup/AnonHik](https://github.com/AnonkiGroup/AnonHik)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)