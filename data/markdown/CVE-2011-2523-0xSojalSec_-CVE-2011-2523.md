## CVE-2011-2523-vsftpd-后门命令执行

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门命令执行

**影响应用:** vsftpd

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.3.4 downloaded between 20110630 and 20110703

**利用条件:** 目标服务器运行存在后门的vsftpd 2.3.4版本，且网络端口未受限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于特定时间段内下载的vsftpd 2.3.4版本中，该版本包含一个后门，当用户名和密码均以 `Hello:)` 开头时，会在目标机器上开启6200端口的监听，攻击者通过Telnet连接该端口即可获得shell。提供的PoC脚本首先检查目标版本是否为易受攻击的版本，然后建立socket连接，发送特定的用户名和密码触发后门，最后使用Telnet连接6200端口获得shell。

**有效性：**
根据漏洞信息和提供的PoC代码，该PoC代码是有效的，能够利用该漏洞。

**投毒风险：**
PoC代码本身较为简单，主要利用了Telnet连接后门端口并进行交互。 但是,安装说明中要求执行`pip3 install termcolor argparse`, 虽然`argparse`是Python内置库,不存在投毒风险,但`termcolor`并非Python内置库,存在一定投毒风险。考虑到脚本的用途和涉及的网络操作，攻击者可能通过`termcolor`实施网络钓鱼或信息收集，因此存在一定的投毒风险，但整体投毒可能性较低。

**利用方式：**
1.  检查目标服务器运行的vsftpd版本是否为2.3.4且属于受影响的时间段(20110630-20110703)。
2.  使用PoC脚本连接目标服务器的FTP端口（通常是21端口）。
3.  PoC脚本会发送特定的用户名和密码（以`Hello:)`开头）到目标服务器，触发后门。
4.  后门被触发后，会在目标服务器上开启6200端口的监听。
5.  PoC脚本使用Telnet连接目标服务器的6200端口，获得一个shell，从而可以执行任意命令。

**项目地址:** [0xSojalSec/-CVE-2011-2523](https://github.com/0xSojalSec/-CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)