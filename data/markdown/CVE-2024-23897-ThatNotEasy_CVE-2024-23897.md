## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致RCE

**影响版本:** 受影响版本 <= 2.441，LTS <= 2.426.2

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以 '@' 字符开头的后跟文件路径的字符串替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**漏洞利用方式：**

1.  攻击者通过HTTP、WebSocket或者SSH等方式，向Jenkins CLI发送包含`@/path/to/file`的命令。
2.  Jenkins CLI解析命令时，会将`@/path/to/file`替换为`/path/to/file`文件的内容。
3.  Jenkins将文件内容返回给攻击者。

**POC有效性：**

根据搜索结果和漏洞库信息，该漏洞POC是有效的，并且已被公开利用。

**投毒风险：**

对提供的Python脚本进行分析：

*   脚本包含基本的参数解析、HTTP请求发送和响应处理的功能。
*   脚本尝试通过上传(oplod)和下载(donlod)文件以及命令执行(execute_command)来利用漏洞。
*   脚本具有保存响应内容到文件的功能，可能被用于记录敏感信息，但也可能是正常的调试功能。
*   脚本中存在一些颜色代码，用于在终端显示信息，这本身不是投毒行为。
*   目前只给出了部分代码，循环部分的关键代码缺失，无法完全分析,因此认为存在一定的投毒风险，但主要是信息收集相关。

**投毒风险分析：**
*   **信息收集：** 该脚本可能会尝试读取Jenkins的配置文件，获取管理员凭据等敏感信息。
*   **后门植入：** 攻击者可能会利用该漏洞在Jenkins服务器上植入后门程序，以便长期控制该服务器。
*   **拒绝服务：** 攻击者可能会利用该漏洞读取大量文件，导致Jenkins服务器资源耗尽，从而造成拒绝服务。
*   **代码混淆与隐藏：** 虽然目前提供的代码看起来比较直接，但完整的利用代码可能会包含混淆或者加密的部分，以隐藏真实的攻击行为。
*   **依赖包风险：** 脚本依赖requests和colorama,如果作者在requirements.txt中指定恶意版本或者作者上传了恶意安装包，也可能存在投毒的风险。

根据上述分析，认为此仓库中存在作者隐藏的投毒代码的可能性为20%，主要集中在信息收集和代码混淆方面。

**项目地址:** [ThatNotEasy/CVE-2024-23897](https://github.com/ThatNotEasy/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)