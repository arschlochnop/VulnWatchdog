## CVE-2025-27363-FreeType-OOB Write

**漏洞编号:** CVE-2025-27363

**漏洞类型:** OOB Write

**影响应用:** FreeType

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 2.13.0

**利用条件:** 需要处理特制的 TrueType GX 或 variable font 文件，攻击者通常需要诱使用户或系统处理恶意字体文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27363是 FreeType 2.13.0 及更早版本中的一个越界写入漏洞，存在于解析 TrueType GX 和 variable font 文件相关的字体 subglyph 结构时。脆弱的代码将一个有符号的 short 值分配给一个无符号的 long，然后添加一个静态值，导致其回绕并分配过小的堆缓冲区。然后，该代码相对于此缓冲区越界写入最多 6 个有符号的 long 整数。这可能导致任意代码执行。此漏洞可能已被在野利用。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经被利用。提供的 POC 代码似乎也有效，因为它针对的是 FreeType 库中的特定整数溢出漏洞，该漏洞会导致越界写入。POC代码作者提到官方已经修复了该漏洞。利用该漏洞需要构造恶意的 TrueType 字体文件。

**投毒风险分析：**
分析 POC 代码，发现其主要目的是演示漏洞的利用方法。该分析文档详细描述了漏洞的原理，内存分配机制(PartitionAlloc)，以及如何利用该漏洞在 Chrome 浏览器 headless 模式下实现代码执行。但是，仓库中的 `analysis.md` 文件似乎没有包含恶意的后门代码。不过，仍然存在一定的投毒风险，因为攻击者可能会在 POC 的基础上添加恶意代码，并将其传播给其他用户。该分析文档也提到已经有公开的POC。所以此处投毒的概率较低。综合判断，投毒风险为 10%。

**利用方式：**

1.  **触发漏洞：** 通过加载特制的 TrueType GX 或 variable font 文件，触发 `load_truetype_glyph` 函数中的整数溢出。
2.  **越界写入：** 整数溢出导致分配过小的堆缓冲区，然后向该缓冲区写入数据时发生越界写入。
3.  **控制写入内容：** 攻击者可以部分控制写入的内容，从而覆盖相邻的内存区域。
4.  **代码执行：** 通过精心构造写入的数据，攻击者可以覆盖函数指针或其他关键数据结构，从而实现任意代码执行。

**项目地址:** [tin-z/CVE-2025-27363](https://github.com/tin-z/CVE-2025-27363)

**漏洞详情:** [CVE-2025-27363](https://nvd.nist.gov/vuln/detail/CVE-2025-27363)