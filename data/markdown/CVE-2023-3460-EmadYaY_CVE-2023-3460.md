## CVE-2023-3460 - Ultimate Member Plugin 未授权提权漏洞

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress 插件

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** < 2.6.7

**利用条件:** 无需身份验证，只需访问网站注册页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-3460 存在于 Ultimate Member WordPress 插件 2.6.7 之前的版本中。该漏洞允许未经身份验证的攻击者通过注册用户帐户并操纵 `wp_capabilities` 元数据来提升权限，最终获得管理员权限。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，可以确认该漏洞是有效的，并且已经被积极利用。

**利用方式：**
1.  访问 WordPress 站点的注册页面（如果开启了注册功能）。
2.  在注册过程中，利用 `wp_càpabilities` 参数，通过发送包含特殊字符的payload，绕过 `is_metakey_banned` 函数的检查。
3.  payload 形如 `wp_càpabilities[administrator]=1`，利用 WordPress 的序列化机制，将用户角色设置为管理员。
4.  成功注册后，用户将拥有管理员权限，可以登录后台并控制整个网站。

**投毒风险：**
该仓库主要是漏洞验证的利用方式，不太可能存在作者隐藏的恶意代码。
- 仓库包含图片资源，可以用于辅助理解漏洞原理和利用过程，图片本身存在恶意代码的风险较低。
- README.md 文件描述了漏洞原理和利用方法，也存在被植入恶意链接的风险，但是风险较低。

**总结：**
该漏洞影响较大，利用简单，危害严重。建议受影响的用户尽快升级到最新版本。同时，需要关注 WordPress 站点的安全性，定期检查插件是否存在漏洞。

**项目地址:** [EmadYaY/CVE-2023-3460](https://github.com/EmadYaY/CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)