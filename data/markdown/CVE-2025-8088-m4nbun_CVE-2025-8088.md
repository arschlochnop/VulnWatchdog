## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是 WinRAR 中存在的路径遍历漏洞。攻击者可以构造恶意的RAR压缩包，该压缩包在解压时，会将恶意文件写入到任意目录，例如Windows启动目录，从而实现开机自启动并执行恶意代码。

**有效性分析：**
从提供的漏洞信息、搜索结果和利用代码来看，该漏洞是真实存在的，并且已经被积极利用。搜索结果中有多篇文章提到了该漏洞的利用和缓解措施，包括利用该漏洞传播 RomCom 恶意软件。

提供的Python POC 代码看起来是有效的。它通过以下步骤利用该漏洞：

1.  生成Payload: 创建一个包含恶意指令的 payload.bat 文件，该文件会在解压后执行。
2.  生成诱饵文件(Decoys): 创建一些诱饵文件，如 Financial_Report_Q3_*.txt，这些文件本身无害，但用于混淆攻击，可能诱导受害者解压。
3.  构造恶意RAR压缩包:  脚本的关键在于创建包含特殊RAR头的压缩包，这些 RAR 头利用路径遍历 (..\) 将 payload.bat 写入到 Windows 启动目录 (AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)。
4. 下载 file_cache.exe到本地，并执行，用于进一步感染。

**投毒风险分析：**
虽然主要目的是展示路径遍历漏洞，但代码中存在一定的投毒风险，大约10%:

*   下载并执行 URL `http://176.65.132.123/file_cache.exe` 上的可执行文件。这使得攻击者可以在目标系统上执行任意代码，而这部分代码的功能没有明确说明，具有潜在的恶意行为。
*   config.py中的Payload 可以被修改为任何恶意程序。即使目前的`start /B C:\Users\Public\file.exe`不存在或无害，攻击者也可以将其替换为更具破坏性的命令。

**利用方式：**
1.  攻击者创建一个恶意的RAR压缩包，其中包含利用路径遍历漏洞的文件。
2.  攻击者通过社会工程学或其他方式诱骗用户下载并解压该RAR压缩包。
3.  当用户使用存在漏洞的WinRAR版本解压该压缩包时，恶意的payload.bat文件会被写入到Windows启动目录。
4.  用户下次启动计算机时，payload.bat 文件会被自动执行，从而执行攻击者预设的恶意代码（例如，启动notepad.exe）。
5. 同时，远程的 `file_cache.exe`会被下载并执行，引入未知风险。

总而言之，该漏洞利用方式是通过构造恶意的 RAR 文件，利用路径遍历漏洞将恶意程序写入启动目录，从而实现开机启动，达到持久化攻击的目的。

**项目地址:** [m4nbun/CVE-2025-8088](https://github.com/m4nbun/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)