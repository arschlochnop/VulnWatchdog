## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** Kernel (受影响版本，具体取决于Android安全公告)

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-2215 是 Android Binder 组件中的一个 Use-After-Free 漏洞。该漏洞位于 binder.c 中，允许本地应用程序提升权限到 Linux 内核。无需用户交互即可利用此漏洞，但需要安装恶意本地应用程序或利用网络应用程序中的单独漏洞。

**利用方式：**

1.  **漏洞触发：** 该漏洞是由于 Binder 驱动程序中的对象在释放后被再次使用而触发。
2.  **内存布局：** 攻击者需要控制内核内存布局，以便在释放的对象被再次使用时，能够执行恶意代码。
3.  **权限提升：** 成功利用此漏洞可以允许攻击者执行任意内核代码，从而获得 root 权限。

**POC 代码分析：**

提供的 POC 代码是针对 Google Pixel 2/Pixel 2 XL (walleye/taimen) 设备，运行特定版本的 Android (QP1A.190711.020 image with kernel version-BuildID 4.4.177-g83bee1dc48e8)。该代码通过利用 UAF 漏洞实现内核任意地址读写，绕过 SELinux，并提升当前进程的权限至 root。

**投毒风险评估：**

虽然代码的主要目的是利用 CVE-2019-2215 漏洞进行提权，但仍存在一定的投毒风险。潜在的投毒点可能包括：

*   **后门植入：** 代码中可能包含在提权后植入后门的逻辑，例如修改系统文件或添加具有 root 权限的恶意服务。
*   **稳定性问题：** 漏洞利用本身可能不稳定，导致设备崩溃或数据损坏。恶意修改可能加剧这些问题。
*   **信息收集：** 代码可能在未经用户同意的情况下收集设备信息并发送到外部服务器。

考虑到代码的复杂性以及提权操作的敏感性，即使作者没有明确的恶意意图，也可能因为编码错误或疏忽而导致意外的安全问题。因此，我将投毒风险评估为 5%。这个百分比表示代码中存在故意植入恶意代码的可能性较低，但仍需谨慎使用。

**有效性：**

根据漏洞描述，搜索引擎结果（特别是 Google Project Zero 的报告）以及漏洞利用代码，该漏洞的POC是有效的。该POC代码已在特定的 Pixel 2/Pixel 2 XL 设备上成功实现提权。

**项目地址:** [stevejubx/CVE-2019-2215](https://github.com/stevejubx/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)