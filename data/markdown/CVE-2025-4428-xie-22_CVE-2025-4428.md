## CVE-2025-4428 - Ivanti EPMM 远程代码执行

**漏洞编号:** CVE-2025-4428

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ivanti Endpoint Manager Mobile (EPMM)

**危害等级:** 高危，允许认证后的攻击者执行任意代码

**影响版本:** <= 12.5.0.0

**利用条件:** 需要经过身份验证，但结合CVE-2025-4427可能无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-4428 是 Ivanti Endpoint Manager Mobile (EPMM) 中的一个远程代码执行漏洞。该漏洞存在于 API 组件中，允许经过身份验证的攻击者通过构造特制的 API 请求来执行任意代码。

**漏洞分析：**

*   漏洞位于EPMM的API组件中，允许通过构造恶意请求执行代码。
*   CVSS 3.1 评分为 7.2，属于高危漏洞。
*   需要高权限才能利用，但结合 CVE-2025-4427 身份验证绕过漏洞，可实现未经身份验证的 RCE。

**POC有效性：**

提供的 POC 代码尝试利用 SpEL 表达式注入来执行命令。它首先对要执行的命令进行 Base64 编码，然后将其嵌入到 SpEL 表达式中，该表达式使用 `java.lang.Runtime` 类来执行命令。 该 POC 代码似乎有效，可以利用此漏洞。

**投毒风险：**

代码存在一定的投毒风险，主要体现在以下几个方面：

1.  **硬编码的 User-Agent：**  虽然使用了随机 User-Agent，但 User-Agent 列表是固定的，可能被用于识别攻击流量。
2.  **绕过 SSL 验证：**  `verify=False` 禁用了 SSL 验证，增加了中间人攻击的风险。
3.  **日志记录：**  虽然日志记录本身不是恶意行为，但如果日志记录包含敏感信息，可能会造成信息泄露。
4.  **Payload生成方式：** 如果攻击者可以控制`command`参数，那么他们可以通过精心设计的命令来实现恶意目的。虽然代码对命令进行了Base64编码，但是并没有对命令进行其他安全检查，这为恶意命令的执行提供了可能。

**利用方式：**

1.  攻击者需要首先访问 EPMM 的 API 端点 `/mifs/rs/api/v2/featureusage`。
2.  攻击者需要构造一个恶意的 API 请求，其中包含 SpEL 表达式注入，将要执行的命令嵌入到 format 参数中。
3.  EPMM 在处理请求时，会解析 SpEL 表达式，从而执行攻击者指定的命令。
4.  结合CVE-2025-4427，可以在未经身份验证的情况下实现RCE。


**项目地址:** [xie-22/CVE-2025-4428](https://github.com/xie-22/CVE-2025-4428)

**漏洞详情:** [CVE-2025-4428](https://nvd.nist.gov/vuln/detail/CVE-2025-4428)