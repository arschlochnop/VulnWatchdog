## CVE-2022-1364 - Google Chrome V8 Turbofan Type Confusion

**漏洞编号:** CVE-2022-1364

**漏洞类型:** 类型混淆导致堆损坏

**影响应用:** Google Chrome

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 100.0.4896.127

**利用条件:** 需要用户访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2022-1364 是一个 Chrome 浏览器 V8 引擎 Turbofan 中的类型混淆漏洞。攻击者可以利用此漏洞通过构造恶意的 HTML 页面，导致堆损坏，最终实现远程代码执行。

**有效性评估：**

根据漏洞库信息和代码，此漏洞的 POC 是可用的。漏洞库信息显示该漏洞已被 CISA 加入已知被利用漏洞目录，说明该漏洞在野外已被利用。

**投毒风险评估：**

该代码库中存在一定的投毒风险。虽然代码中包含了利用CVE-2022-1364的UC浏览器利用的README，并且利用了fetch向 `https://192.168.1.246:5000/api/message` 发送用户body的JSON数据，这段javascript代码可能包含未知的恶意行为：

1.  `js_payload` 包含一个 fetch 请求，定期将当前页面的 DOM 结构发送到 `https://192.168.1.246:5000/api/message`。这可能泄露用户的敏感信息，例如网页内容、cookie 等。这个IP地址可能是攻击者控制的服务器，用于收集受害者的数据。
2. 填充了大量的`;`可能为了混淆。 代码本身可能包含其他潜在的恶意行为，例如尝试利用其他漏洞、安装恶意软件等。

基于上述分析，该 POC 存在较高的投毒风险，比例大约为 80%。

**利用方式分析：**

1.  **类型混淆：** 漏洞根源在于 V8 Turbofan 中的类型混淆，允许攻击者控制对象的类型。
2.  **堆损坏：** 通过类型混淆，攻击者可以覆盖内存中的数据，导致堆损坏。
3.  **远程代码执行：** 通过控制堆中的数据，攻击者最终可以劫持程序的执行流程，执行任意代码。
4.  **利用代码分析：** 该代码尝试复现 UC 浏览器的漏洞，通过 `js_payload` 收集document.body的数据并且发送给指定的IP地址,模拟远程攻击。


**项目地址:** [interruptlabs/uc_browser_poc_CVE-2022-1364](https://github.com/interruptlabs/uc_browser_poc_CVE-2022-1364)

**漏洞详情:** [CVE-2022-1364](https://nvd.nist.gov/vuln/detail/CVE-2022-1364)