## CVE-2025-32462-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 中危，本地权限提升

**影响版本:** 1.8.8 到 1.9.17 (不包含 1.9.17p1)

**利用条件:** 需要本地用户权限，sudoers配置中存在非当前主机或ALL的主机配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32462 是一个存在于 Sudo 中的本地权限提升漏洞。当 sudoers 文件中指定了一个既不是当前主机也不是 ALL 的主机时，列出的用户可以在非预期的机器上执行命令。该漏洞存在于 Sudo 1.8.8 到 1.9.17 版本。POC代码的有效性较高，可以直接利用，但需要依赖特定配置的sudoers文件。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 POC 代码应该是有效的，至少在满足特定 sudoers 文件配置的情况下，可以利用此漏洞提升权限。漏洞描述明确指出允许列出的用户在非预期机器上执行命令，这意味着权限提升。

**投毒风险：**
虽然提供的代码仓库中包含了一个 `exploit` 文件，以及用于克隆和执行的命令，但没有足够的信息完全排除投毒的可能性。潜在的投毒风险在于 `exploit` 脚本本身。 虽然 README描述的是一个权限提升的EXP, 但脚本内部可能包含其他恶意代码。因此，不能完全排除投毒风险，估计的可能性为10%。

**利用方式：**
1.  **漏洞触发条件：** 需要存在特定结构的 `sudoers` 文件，该文件中针对特定用户或用户组，指定了允许在特定主机上执行的命令，但目标主机既不是 `ALL` 也不是执行 `sudo` 命令的当前主机。
2.  **利用过程：**
    *   攻击者利用具有漏洞的 Sudo 版本，并确保 `sudoers` 文件满足漏洞触发条件。
    *   攻击者使用 `-h` 或 `--host` 选项指定一个未授权的主机。
    *   Sudo 错误地允许在当前主机上执行命令，从而绕过主机名限制。
    *   如果允许执行的命令是提升权限的命令（如 `su` 或 `sudo`），则攻击者可以提升到 root 权限。

**项目地址:** [atomicjjbod/CVE-2025-32462](https://github.com/atomicjjbod/CVE-2025-32462)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)