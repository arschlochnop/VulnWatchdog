## CVE-2024-7591 - Progress LoadMaster OS 命令注入

**漏洞编号:** CVE-2024-7591

**漏洞类型:** OS 命令注入

**影响应用:** Progress LoadMaster

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 7.2.40.0 及以上 (小于 7.2.60.1), ECS 所有版本, Multi-Tenancy 7.1.35.4 及以上

**利用条件:** 需要网络访问 LoadMaster 的 Web 界面 (无需身份验证)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-7591 是 Progress LoadMaster 中的一个操作系统命令注入漏洞，由于输入验证不当导致。攻击者可以通过向登录页面（/progs/status/login）的 username 和 password 字段构造恶意输入，从而执行任意系统命令。

**有效性分析：**
提供的 Python 脚本 `KempExploit.py` 看起来是有效的漏洞利用代码。它首先从 `/progs/homepage` 获取 token 和 token2，然后使用经过编码的命令作为密码发送到 `/progs/status/login`。脚本使用了 `requests` 库发送 HTTP 请求，并使用 `BeautifulSoup` 解析 HTML。`KempRCECommandGenerator.py` 提供了命令编码功能，能够将用户输入的命令编码成 LoadMaster 可以解析的格式。

**投毒风险分析：**
代码中没有明显的投毒行为。代码逻辑清晰，主要功能是利用漏洞进行命令注入。脚本的目的是发送精心构造的 payload 以利用命令注入漏洞。`process_string` 函数负责编码命令，确保其符合 LoadMaster 的预期格式。虽然任何远程代码执行漏洞都可能被利用于恶意目的（例如安装后门），但提供的代码本身不包含预先植入的恶意代码。经过分析，投毒风险为 0%。

**利用方式分析：**
1.  **目标确定：** 确定目标 LoadMaster 实例的 IP 地址和端口。
2.  **获取 Tokens：** 向 `/progs/homepage` 发送 GET 请求，解析 HTML 响应以提取 `token` 和 `token2`。
3.  **命令编码：** 使用 `process_string` 函数对要执行的命令进行编码，该函数在命令前后添加特定的字符串，并对每个字符进行 URL 编码。
4.  **发送 Payload：**  向 `/progs/status/login` 发送 POST 请求，payload 包含提取的 tokens、用户名和编码后的命令作为密码。
5.  **命令执行：**  LoadMaster 在处理登录请求时，由于不正确的输入验证，会执行编码后的命令。
6.  **结果获取：**  通过检查响应内容来判断命令是否成功执行。

**项目地址:** [butyraldehyde/CVE-2024-7591-PoC](https://github.com/butyraldehyde/CVE-2024-7591-PoC)

**漏洞详情:** [CVE-2024-7591](https://nvd.nist.gov/vuln/detail/CVE-2024-7591)