## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 通过 4.3

**利用条件:** 目标系统使用Bash，且存在允许通过环境变量影响Bash执行的接口(例如CGI脚本)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）是一个存在于GNU Bash中的命令注入漏洞。该漏洞允许远程攻击者通过构造包含恶意代码的环境变量，在目标系统上执行任意命令。利用方式通常涉及以下步骤：

1.  **确定目标系统是否易受攻击：** 检查目标系统是否正在运行易受攻击的Bash版本(通过 4.3).
2.  **寻找攻击入口点：** 寻找目标系统上允许通过环境变量影响Bash执行的接口，例如CGI脚本、OpenSSH的ForceCommand功能、DHCP客户端等。
3.  **构造恶意环境变量：** 构造包含恶意代码的函数定义的环境变量。例如：`() {{ :;}}; command`，其中`command`是要执行的命令。
4.  **发送包含恶意环境变量的请求：** 将构造的恶意环境变量通过HTTP请求头、SSH连接或其他方式传递给目标系统。
5.  **触发漏洞：** 目标系统在执行Bash时，会解析包含恶意代码的环境变量，从而执行攻击者指定的命令。

提供的POC代码`AutoShocker.py`是一个利用Shellshock漏洞的自动化脚本，具备以下功能：

*   **命令执行：** 允许攻击者在目标系统上执行任意命令，并将结果返回。
*   **反向Shell：** 允许攻击者在目标系统上建立反向Shell连接，从而获得对目标系统的完全控制权。

该漏洞利用的有效性取决于目标系统是否易受攻击，以及攻击者是否能够找到合适的攻击入口点。由于脚本需要用户输入目标IP和执行的命令/反向shell信息，因此投毒风险主要在于：

*   **误用风险：** 用户可能在未经授权的系统上使用该脚本，导致法律问题。
*   **脚本篡改：**  攻击者可能篡改脚本，添加恶意功能（例如植入后门、窃取用户凭据等），然后诱骗其他用户使用。

因此，我评估此仓库中存在作者隐藏的投毒代码的风险为10%。这主要是基于脚本本身的性质（漏洞利用工具）以及潜在的被篡改和滥用的可能性。

**项目地址:** [YunchoHang/CVE-2014-6271-SHELLSHOCK](https://github.com/YunchoHang/CVE-2014-6271-SHELLSHOCK)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)