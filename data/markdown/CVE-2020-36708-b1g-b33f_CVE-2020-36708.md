## CVE-2020-36708 - WordPress Epsilon Framework Function Injection

**漏洞编号:** CVE-2020-36708

**漏洞类型:** 函数注入

**影响应用:** 多个 WordPress 主题 (基于 Epsilon Framework)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：Shapely <= 1.2.7, NewsMag <= 2.4.1, Activello <= 1.4.0, Illdy <= 2.1.4, Allegiant <= 1.2.2, Newspaper X <= 1.3.1, Pixova Lite <= 2.0.5, Brilliance <= 1.2.7, MedZone Lite <= 1.2.4, Regina Lite <= 2.0.4, Transcend <= 1.1.8, Affluent <= 1.1.0, Bonkers <= 1.0.4, Antreas <= 1.0.2, Sparkling <= 2.4.8, NatureMag Lite <= 1.0.4

**利用条件:** 目标网站使用受影响的 WordPress 主题，且允许未授权访问 admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-36708 漏洞是 WordPress Epsilon Framework 中的一个函数注入漏洞。未经身份验证的攻击者可以通过 `epsilon_framework_ajax_action`  AJAX action 调用任意 PHP 类方法，从而实现远程代码执行。攻击者控制要调用的类 (例如 `Requests`)、要调用的方法 (例如 `request_multiple`) 以及要提供的参数。

**漏洞利用方式：**

1.  攻击者发送一个 POST 请求到 `wp-admin/admin-ajax.php`。
2.  请求中包含 `action=epsilon_framework_ajax_action` 参数，指示要触发 Epsilon Framework 的 AJAX 处理程序。
3.  请求中包含 `args` 参数，该参数是一个数组，用于指定要调用的类、方法和参数。
    *  `args[action][0]` 指定要调用的类 (例如 `Requests`)。
    *  `args[action][1]` 指定要调用的方法 (例如 `request_multiple`)。
    *  `args[args][0][url]` 指定请求的目标 URL。
    *  `args[args][0][method]` 指定请求方法 (例如 `GET`)。
4.  服务器接收到请求后，会调用指定的类和方法，并将提供的参数传递给该方法。 通过控制这些参数，攻击者可以执行未经授权的操作，例如服务器端请求伪造 (SSRF)。

**有效性：**

提供的 PoC 代码是有效的。它利用 `Requests` 库触发 SSRF，通过让服务器向攻击者控制的域发起 web 请求来验证任意函数执行。 PoC 代码会发送一个精心构造的 POST 请求到 `wp-admin/admin-ajax.php`，利用 `epsilon_framework_ajax_action` 触发漏洞，从而让服务器向攻击者指定的 collaborator 域名发起请求。

**投毒风险：**

分析 PoC 代码内容，未发现作者隐藏的投毒代码，该仓库的目的主要在于重现漏洞，并且提供验证手段。PoC 仓库中存在恶意代码的可能性为0%。

**项目地址:** [b1g-b33f/CVE-2020-36708](https://github.com/b1g-b33f/CVE-2020-36708)

**漏洞详情:** [CVE-2020-36708](https://nvd.nist.gov/vuln/detail/CVE-2020-36708)