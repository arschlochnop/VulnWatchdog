## CVE-2021-41773/CVE-2021-42013 Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，且开启了CGI支持，Alias配置不当，并且相关目录未进行权限限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773和CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历漏洞。攻击者可以利用这些漏洞，通过构造包含特殊字符（如`.%2e`或`.%%32%65`）的URL，绕过服务器的路径检查，访问到Alias指令配置以外的文件。如果目标服务器同时开启了CGI支持，攻击者还可以执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2021-41773已经被证实存在，并且在野外被利用。提供的POC代码也通过Docker构建了易受攻击的环境，并提供了利用脚本，证明了该漏洞的可利用性。

**投毒风险：**

分析POC代码，该代码主要用于构建漏洞环境和执行漏洞利用。虽然代码本身看起来直接，但需要注意以下几点：

*   **Docker镜像来源：** POC需要构建Docker镜像。如果Docker镜像不是来自官方或可信来源，则可能包含恶意软件。
*   **执行任意命令：** RCE相关的POC会执行任意命令，如果攻击者修改了POC代码，可能会导致恶意代码执行。
*   **流量劫持风险：** POC通过curl发送特定请求来触发漏洞，如果网络环境被污染，可能导致流量劫持，使得攻击者可以篡改POC行为。
*   **文件篡改风险：** RCE相关的POC会写`/tmp/exploited`文件，如果服务器的`/tmp`目录权限设置不当，攻击者可以在其他用户不知情的情况下，篡改该文件，从而进一步扩大攻击。

综合以上考虑，认为此POC代码存在一定的投毒风险，但整体比例不高，约为10%。

**利用方式：**

1.  **环境搭建：** 使用Dockerfile构建包含漏洞的Apache HTTP Server环境（2.4.49或2.4.50版本）。
2.  **路径遍历：** 构造包含特殊字符的URL，例如：
    *   `/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd` (针对CVE-2021-41773)
    *   `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd` (针对CVE-2021-42013)
3.  **文件读取：** 如果路径遍历成功，可以直接读取服务器上的敏感文件。
4.  **远程代码执行（RCE）：** 如果服务器开启了CGI支持，并且允许执行shell脚本，则可以通过路径遍历访问到shell脚本，并执行任意命令。例如，POC中使用了以下命令将字符串写入/tmp/exploited文件中：
    *   `echo “Successfully Exploited” > /tmp/exploited`
5.  **利用链：** 进一步的攻击可以包括反弹shell、权限提升、横向移动等。

**项目地址:** [OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits](https://github.com/OfriOuzan/CVE-2021-41773_CVE-2021-42013_Exploits)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)