## CVE-2009-2265-FCKeditor目录遍历

**漏洞编号:** CVE-2009-2265

**漏洞类型:** 目录遍历

**影响应用:** FCKeditor

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** < 2.6.4.1

**利用条件:** 需要目标系统运行存在漏洞的FCKeditor版本，且connector模块可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2009-2265 漏洞存在于 FCKeditor 2.6.4.1 之前的版本中。攻击者可以通过构造包含目录遍历序列的请求，利用connector模块上传恶意文件（如JSP webshell）到服务器任意目录，最终实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。多个来源都确认了该漏洞的存在，并指出它允许攻击者创建可执行文件。

**投毒风险分析：**

提供的PoC代码是一个Python脚本 (cf8-upload.py)，用于利用该漏洞在Adobe ColdFusion 8.0.1服务器上上传文件。脚本本身较为简单，主要功能是构造恶意请求，利用目录遍历漏洞上传指定文件。

*   **代码逻辑：** 脚本通过requests库发送HTTP请求，模拟文件上传过程，包含必要的参数解析和请求构造。
*   **安全风险：** PoC 代码本身几乎没有投毒风险。该脚本的功能明确，仅仅实现文件上传功能, 不太可能存在隐藏的恶意代码。
*   **潜在风险：** 使用该脚本进行渗透测试或攻击时，需要确保上传的文件是安全的。如果上传的文件本身包含恶意代码，则可能对目标系统造成危害。例如，上传包含反弹shell的JSP文件。
*   **结论：** 脚本本身的投毒风险非常低，脚本的功能是文件上传，主要风险在于上传的文件内容。

**利用方式：**

1.  **确定目标系统：** 确定目标系统运行着存在漏洞的 FCKeditor 版本（低于 2.6.4.1）以及Adobe ColdFusion 8.0.1。
2.  **找到connector路径：** 找到 FCKeditor 的 connector 模块路径（通常位于 editor/filemanager/connectors/ 目录下）。
3.  **构造恶意请求：**  构造包含目录遍历序列（如 `../../`）的请求，指定要上传的文件路径和文件名。
4.  **上传恶意文件：** 使用PoC脚本上传包含恶意代码的文件，例如 JSP webshell。
5.  **触发恶意代码：**  通过访问上传的恶意文件，触发其中的代码，实现远程代码执行。
6.  **反弹shell：** 通过msfvenom 生成一个JSP反弹shell，然后通过poc 上传到服务器，并且执行，从而获取服务器权限。 

**项目地址:** [p1ckzi/CVE-2009-2265](https://github.com/p1ckzi/CVE-2009-2265)

**漏洞详情:** [CVE-2009-2265](https://nvd.nist.gov/vuln/detail/CVE-2009-2265)