## CVE-2019-12401: Apache Solr XML Bomb 漏洞

**漏洞编号:** CVE-2019-12401

**漏洞类型:** XML实体扩展攻击（XML Bomb）

**影响应用:** Apache Solr

**危害等级:** 高危，导致拒绝服务（DoS），资源耗尽

**影响版本:** 1.3.0 to 1.4.1, 3.1.0 to 3.6.2, 4.0.0 to 4.10.4

**利用条件:** 需要能够向Solr的更新处理器发送XML请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-12401是Apache Solr中的一个XML实体扩展漏洞（也称为XML Bomb或Lol Bomb）。攻击者可以构造一个恶意的XML文档，其中包含嵌套的实体定义，当Solr服务器解析该XML文档时，这些实体会指数级地展开，导致服务器消耗大量内存和CPU资源，最终导致拒绝服务。该漏洞存在于Solr的更新处理器中，攻击者可以通过向更新处理器发送包含恶意XML的请求来触发该漏洞。

**有效性：** 提供的POC代码指向了一个PDF文档，该文档包含了漏洞的利用过程。根据漏洞描述，此漏洞可以通过发送特定的XML请求来触发，导致Solr实例的资源耗尽。因此，PoC是有效的。

**投毒风险：** 提供的POC代码仓库中只包含一个`README.md`文件和一个指向PDF的链接。 `README.md`文件描述了漏洞和PoC的来源，以及指向包含漏洞利用过程PDF文档的链接。查看仓库内容后，没有发现任何可疑的恶意代码或后门，因此投毒风险评估为0%。 PDF链接指向的外部github仓库同样是公开的，进一步降低了投毒的风险。

**利用方式：** 漏洞利用方式是通过构造包含恶意XML实体的文档，并将其发送到Solr的更新处理器。 恶意XML文档利用DOCTYPE和ENTITY元素来定义嵌套的实体，这些实体在解析时会指数级地展开。 当Solr服务器解析该XML文档时，实体扩展会导致资源消耗迅速增加，最终导致服务器内存溢出（OOM）或CPU资源耗尽，从而拒绝服务。具体的利用方式可参考PoC提供的PDF文档，该文档应该包含了详细的步骤和示例代码。

**项目地址:** [mbadanoiu/CVE-2019-12401](https://github.com/mbadanoiu/CVE-2019-12401)

**漏洞详情:** [CVE-2019-12401](https://nvd.nist.gov/vuln/detail/CVE-2019-12401)