## CVE-2023-46604-Apache ActiveMQ-远程代码执行

**漏洞编号:** CVE-2023-46604

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.15.0 <= version < 5.15.16, 5.16.0 <= version < 5.16.7, 5.17.0 <= version < 5.17.6, 5.18.0 <= version < 5.18.3

**利用条件:** 需要网络访问ActiveMQ服务，且目标系统存在于受影响版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-46604是Apache ActiveMQ中的一个远程代码执行漏洞。该漏洞源于OpenWire协议中存在反序列化漏洞。攻击者可以通过发送特制的OpenWire消息，其中包含恶意序列化对象，导致服务器在反序列化过程中执行任意代码。 

**有效性:**
根据漏洞库信息和搜索引擎结果，该漏洞已被公开披露，并且存在公开可用的PoC代码。多个安全厂商报告了该漏洞的野外利用情况，证明该漏洞是有效的。

**利用方式:**
1.  攻击者通过网络访问存在漏洞的ActiveMQ服务。
2.  构造包含恶意序列化对象的OpenWire消息。该消息利用了不安全的反序列化漏洞，允许攻击者指定要实例化的类。
3.  将恶意消息发送到ActiveMQ服务器。
4.  服务器在处理消息时，会尝试反序列化消息中的对象，从而执行攻击者指定的代码。攻击者通常会利用这一点来执行系统命令，例如下载和执行恶意软件。

**投毒风险:**
提供的PoC代码主要用于分析OpenWire协议和漏洞原理，没有发现明显的恶意代码或后门。但仍然存在一定的投毒风险，原因是：

*   **依赖项风险:** PoC代码可能依赖于特定的库或组件，这些库可能包含漏洞或者恶意代码。
*   **代码混淆风险:** 攻击者可能在PoC代码中插入难以察觉的恶意代码，例如利用反射或者动态加载等技术来隐藏恶意行为。
*   **供应链风险:** PoC代码的作者可能受到恶意攻击，导致代码被篡改。

因此，在使用PoC代码时，务必进行充分的安全审查和测试，以防止潜在的风险。代码分析中，并未发现明显的恶意行为，只是一个协议分析和利用演示，因此投毒风险较低，估计为5%。 该README.md文件仅为漏洞原理分析，并未发现任何直接的后门代码。

**总结:** CVE-2023-46604是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞完全控制受影响的ActiveMQ服务器。用户应尽快升级到安全版本，以防止受到攻击。

**项目地址:** [skrkcb2/CVE-2023-46604](https://github.com/skrkcb2/CVE-2023-46604)

**漏洞详情:** [CVE-2023-46604](https://nvd.nist.gov/vuln/detail/CVE-2023-46604)