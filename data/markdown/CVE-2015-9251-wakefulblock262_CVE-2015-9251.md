## CVE-2015-9251-jQuery-跨站脚本攻击(XSS)

**漏洞编号:** CVE-2015-9251

**漏洞类型:** 跨站脚本攻击(XSS)

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户cookie泄露，页面内容篡改

**影响版本:** < 3.0.0

**利用条件:** 需要网站使用存在漏洞的jQuery版本，且发起跨域Ajax请求时未设置dataType选项

**POC 可用性:** 否 (提供的代码利用的是另一个XSS漏洞)

**投毒风险:** 0%

## 详情

CVE-2015-9251 漏洞存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果没有指定 `dataType` 选项，且服务器返回 `text/javascript` 类型的响应，jQuery 会尝试执行该响应，从而可能导致 XSS 攻击。 攻击者可以通过控制服务器返回的内容来执行任意 JavaScript 代码。

**有效性评估：**
提供的代码实际上并*不能*利用CVE-2015-9251。它使用`$.parseHTML` 和`$('#target').append(html)`来将包含XSS payload（`<img src=x onerror="alert(document.cookie)">`）的 HTML 插入到页面中。 这本身就是一个XSS漏洞，但是与 CVE-2015-9251 描述的利用方式不同。 此 PoC 利用了 jQuery `append` 函数对 HTML 片段解析时，执行内联 JavaScript 的行为,而不是 `dataType` 选项缺失导致的问题。

**投毒风险：**
提供的代码**没有明显的投毒风险**。代码的功能是展示一个 XSS 的 PoC，虽然本身存在 XSS，但其目的是演示漏洞，而不是隐藏恶意行为。所以投毒风险评估为0%。

**利用方式：**
要利用 CVE-2015-9251，攻击者需要满足以下条件：

1.  目标网站使用 jQuery 3.0.0 之前的版本。
2.  网站发起跨域 Ajax 请求。
3.  Ajax 请求*没有*设置 `dataType` 选项。
4.  服务器返回 `text/javascript` 类型的响应，且响应内容包含恶意 JavaScript 代码。

攻击者可以通过控制服务器的响应内容来执行 XSS 攻击。例如，攻击者可以劫持服务器，或者利用服务器上的漏洞来修改响应内容。

根据搜索结果，许多应用依赖的jQuery受到了此漏洞的影响，包括API Connect等。


**项目地址:** [wakefulblock262/CVE-2015-9251](https://github.com/wakefulblock262/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)