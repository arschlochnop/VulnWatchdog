## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 到 1.9.17 (不包含1.9.17p1)

**利用条件:** 本地用户访问权限，sudo版本符合漏洞影响范围

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息、搜索结果和提供的漏洞利用代码，分析如下：

**有效性：**

提供的PoC代码看起来有效。它利用了 Sudo 的 `--chroot` 选项中的漏洞，允许本地用户通过使用用户可控目录中的 `/etc/nsswitch.conf` 来获取 root 权限。PoC的整体思路是创建一个包含恶意 `nsswitch.conf` 文件的目录，然后使用 `sudo -R` 命令执行任意代码。脚本中创建了一个共享库，当程序启动时，该共享库将运行，利用 setreuid/setregid设置root权限，然后执行一个root shell。

**投毒风险：**

通过检查提供的 PoC 代码，未发现明显的恶意代码或后门。脚本主要功能是利用漏洞进行提权，没有其他可疑行为。因此，投毒风险评估为0%。

**利用方式：**

1.  **创建恶意环境：** PoC首先创建一个临时目录 `${STAGE}`，并在该目录下创建必要的子目录 `woot/etc` 和 `libnss_`，模拟 chroot 环境。
2.  **构造恶意 `nsswitch.conf`：**  在 `woot/etc/nsswitch.conf` 中，将 `passwd` 数据库的查找指向 `/woot1337`。这会影响后续的用户名查找过程。
3.  **编译恶意共享库：** PoC编译一个共享库 `libnss_/woot1337.so.2`，其中包含在加载时执行的 `woot()` 函数。`woot()` 函数调用 `setreuid(0,0)` 和 `setregid(0,0)` 将当前进程的有效用户ID和组ID设置为 root，然后启动一个 root shell。
4.  **利用 `sudo -R` 触发漏洞：**  `sudo -R woot woot` 命令使用创建的 chroot 环境 (`woot`) 运行一个虚拟命令 `woot`。由于 `nsswitch.conf` 被篡改，sudo将加载恶意的共享库，导致提权。
5.  **清理环境：** PoC最后清理创建的临时目录。

总而言之，此漏洞允许本地用户通过精心构造的chroot环境和`nsswitch.conf`文件来提升权限至root。


**项目地址:** [san8383/CVE-2025-32463](https://github.com/san8383/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)