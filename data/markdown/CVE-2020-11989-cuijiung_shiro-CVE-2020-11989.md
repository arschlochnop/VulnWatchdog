## CVE-2020-11989-Apache Shiro-身份验证绕过

**漏洞编号:** CVE-2020-11989

**漏洞类型:** 身份验证绕过

**影响应用:** Apache Shiro

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** 1.5.2 - 1.5.3

**利用条件:** Apache Shiro与Spring动态控制器结合使用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2020-11989 是 Apache Shiro 在与 Spring 动态控制器一起使用时存在的身份验证绕过漏洞，影响版本为 1.5.2 和 1.5.3。攻击者可以构造特制的请求绕过身份验证。 

漏洞利用代码分析：

提供的代码是一个 Spring Boot 项目，集成了 Apache Shiro 1.4.2，版本不在受影响范围内，但可以用于搭建Shiro+Spring的环境方便漏洞验证。

`LoginController.java` 定义了登录和访问受保护资源的接口。
`MyRealm.java` 是一个简单的 Realm 实现，用于身份验证，硬编码了用户名为 `javaboy`，密码为 `123`。
`ShiroConfig.java`  预计会配置 Shiro 的过滤器和安全管理器(缺失)。
`pom.xml` 文件中声明了项目依赖，包括 Spring Boot、Shiro Web 和 Shiro Spring。

有效性：

提供的代码本身并不是直接的漏洞利用代码，而是一个包含 Shiro 和 Spring 集成的示例项目。要利用 CVE-2020-11989，需要构造特定的恶意请求。此示例项目可以用来搭建一个存在漏洞的环境，然后进行验证。

投毒风险：

分析代码，`/tmp/9738a33c4eb80baf36691e6f80cc021c/src/main/java/org/javaboy/shirobasic/MyRealm.java` 中存在硬编码的用户名和密码。如果攻击者部署了这个存在漏洞的代码，并且使用默认的配置，那么账户存在安全问题。 存在潜在的投毒风险，但代码本身更多的是简化验证，并非明显的恶意代码。

利用方式：

1.  **环境搭建：** 搭建一个运行受影响版本的 Apache Shiro (1.5.2 或 1.5.3) 并与 Spring 动态控制器集成的应用程序。
2.  **请求构造：** 构造特制的 HTTP 请求，利用 Shiro 在处理特定类型的 URL 时的缺陷，绕过身份验证。
3.  **访问受保护资源：** 在未提供有效身份验证信息的情况下，访问原本需要身份验证才能访问的资源。


**项目地址:** [cuijiung/shiro-CVE-2020-11989](https://github.com/cuijiung/shiro-CVE-2020-11989)

**漏洞详情:** [CVE-2020-11989](https://nvd.nist.gov/vuln/detail/CVE-2020-11989)