## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，Magick二进制文件需要具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268是ImageMagick的一个任意文件读取漏洞，攻击者可以构造恶意的PNG图片，当ImageMagick解析该图片（例如，进行resize操作）时，会将指定文件的内容嵌入到结果图像中，从而实现任意文件读取。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。提供的POC代码（README.md）只是一个说明文件，本身不包含利用代码，但表明该漏洞已经被公开研究，存在可用的POC。

**投毒风险：** 提供的POC代码（README.md）只是一个说明文件，本身不具备投毒能力。但不能排除在其他相关的漏洞利用仓库中存在恶意代码的可能性，比如在构造恶意PNG图片时，可能会嵌入其他恶意指令或脚本。由于提供的POC代码文件类型, 代码行数都较少, 投毒的可能性较低, 但是依然不能完全排除, 因为可能会包含其他资源链接或命令执行等风险。评估风险概率为10%。

**利用方式：**
1.  攻击者构造一个恶意的PNG图片，该图片包含对目标文件的引用或嵌入。
2.  将该图片上传到使用存在漏洞的ImageMagick版本的服务器上，或者以其他方式让服务器使用ImageMagick处理该图片（例如，进行resize操作）。
3.  当ImageMagick处理该图片时，会将目标文件的内容嵌入到结果图像中。
4.  攻击者可以下载结果图像，从而获取目标文件的内容。

**项目地址:** [betillogalvanfbc/POC-CVE-2022-44268](https://github.com/betillogalvanfbc/POC-CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)