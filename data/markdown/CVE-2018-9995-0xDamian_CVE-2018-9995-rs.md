## CVE-2018-9995-TBK DVR系列设备-认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他使用该系列DVR的重新贴牌产品 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问、数据泄露和远程控制

**影响版本:** 受影响版本未知，但影响TBK DVR4104和DVR4216系列

**利用条件:** 需要网络访问目标DVR设备

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2018-9995 漏洞存在于TBK DVR4104和DVR4216系列设备中，以及使用这些DVR重新贴牌的各种品牌设备。攻击者可以通过在HTTP请求头中设置 `Cookie: uid=admin` 来绕过身份验证。具体利用方式是，发送包含此Cookie的请求，例如 `device.rsp?opt=user&cmd=list`，即可获取设备上的用户信息等敏感信息。Rust代码主要是一个Cargo.lock文件，列出了漏洞POC相关的依赖包，但从Cargo.lock文件本身无法判断投毒行为, 但是根据通常情况, 投毒风险极低。利用方式简单，只需要构造带有特定Cookie的HTTP请求，就可以无需用户名密码直接以管理员权限登录设备，从而访问视频流等敏感信息。

**有效性:**
根据漏洞库信息和Exploit-DB的记录（https://www.exploit-db.com/exploits/44577/），该漏洞的POC是有效的。

**投毒风险:**
提供的代码是一个`Cargo.lock`文件，用于锁定Rust项目的依赖版本。它本身不包含可执行代码，因此直接通过此文件进行投毒的可能性很低。投毒可能发生在依赖包中，但需要进一步分析这些依赖包的源代码才能确认。由于Cargo.lock锁定了依赖包的版本，如果其中某个依赖包存在已知漏洞或恶意代码，那么使用该Cargo.lock的项目可能会受到影响。

**利用方式:**
1.  构造一个HTTP请求，在请求头中设置 `Cookie: uid=admin`。
2.  将请求发送到目标DVR设备的Web接口，例如 `device.rsp?opt=user&cmd=list`。
3.  如果设备存在漏洞，攻击者将绕过身份验证，以管理员权限访问设备上的数据和功能。

**项目地址:** [0xDamian/CVE-2018-9995-rs](https://github.com/0xDamian/CVE-2018-9995-rs)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)