## CVE-2023-38646-Metabase-远程代码执行

**漏洞编号:** CVE-2023-38646

**漏洞类型:** 远程代码执行

**影响应用:** Metabase

**危害等级:** 高危，未经身份验证即可远程执行代码

**影响版本:** < 0.46.6.1 和 Enterprise < 1.46.6.1

**利用条件:** 目标Metabase实例可被网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-38646是Metabase的一个远程代码执行漏洞，存在于0.46.6.1之前的开源版本和1.46.6.1之前的企业版本中。未经身份验证的攻击者可以利用此漏洞在服务器上执行任意命令。该漏洞的利用方式是，通过发送特制的HTTP请求到/api/setup/validate端点，其中包含恶意构造的JSON payload。该payload利用H2数据库的特性，通过`CREATE ALIAS`语句创建一个名为`SHELLEXEC`的函数，该函数可以执行任意系统命令。PoC代码通过curl命令回连攻击者的服务器，验证漏洞的存在。虽然POC中使用了curl进行回连，但攻击者可以替换成任何命令进行恶意利用。投毒风险较低，只有极小的可能性作者在代码中植入其他恶意代码（比如在LICENSE文件中隐藏不可见字符），但这可以通过仔细审查代码来避免。PoC代码主要通过H2数据库的特性执行任意代码，LICENSE文件主要声明了版权协议。

**项目地址:** [kh4sh3i/CVE-2023-38646](https://github.com/kh4sh3i/CVE-2023-38646)

**漏洞详情:** [CVE-2023-38646](https://nvd.nist.gov/vuln/detail/CVE-2023-38646)