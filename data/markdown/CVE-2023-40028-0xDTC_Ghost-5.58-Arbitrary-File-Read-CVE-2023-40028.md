## CVE-2023-40028-Ghost-任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost

**危害等级:** 中危，可读取服务器上的敏感文件

**影响版本:** < 5.59.1

**利用条件:** 需要具有Ghost后台管理权限的用户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-40028是Ghost CMS的一个任意文件读取漏洞。该漏洞允许经过身份验证的用户上传包含符号链接的文件。攻击者可以利用此漏洞，上传一个指向服务器上任意文件的符号链接，然后通过访问该符号链接读取文件内容。

**有效性分析：**
提供的POC代码是一个bash脚本，它自动化了漏洞利用过程。该脚本首先通过提供的用户名和密码登录Ghost后台，然后创建一个包含指向目标文件的符号链接的ZIP文件，并将该ZIP文件上传到Ghost服务器。最后，它通过访问上传的符号链接来读取目标文件的内容。根据漏洞描述和POC代码的功能，该POC代码应该是有效的。

**投毒风险分析：**
查看提供的bash脚本代码，没有发现明显的恶意代码，例如反弹shell、删除文件等。脚本的功能主要集中在利用漏洞读取文件内容。但是，任何脚本都存在一定的风险，例如，如果脚本在不受信任的环境中运行，可能会被篡改。 此外脚本要求输入用户名和密码, 存在一定的凭据泄露风险, 建议在使用时进行代码审计。
仓库中还包含一个README.md文件，用于描述漏洞和POC的使用方法，内容没有发现异常。
综合来看，投毒风险较低，估计为5%。

**利用方式：**
1.  攻击者需要具有Ghost后台管理权限的用户名和密码。
2.  攻击者运行POC脚本，提供Ghost服务器的URL、用户名和密码。
3.  脚本登录Ghost后台。
4.  脚本提示攻击者输入要读取的文件路径。
5.  脚本创建一个包含指向目标文件的符号链接的ZIP文件。
6.  脚本将ZIP文件上传到Ghost服务器。
7.  脚本通过访问上传的符号链接来读取目标文件的内容。
8.  脚本在终端上显示目标文件的内容。

**项目地址:** [0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028](https://github.com/0xDTC/Ghost-5.58-Arbitrary-File-Read-CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)