## CVE-2017-7529-Nginx-整数溢出

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** 需要目标服务器开启并使用range filter模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7529是Nginx range filter模块中的一个整数溢出漏洞。当处理带有特制Range头的HTTP请求时，模块计算ranges时可能发生整数溢出，导致读取超出缓冲区的内容，从而泄露敏感信息（例如缓存文件头）。

**有效性：**
提供的POC代码使用Python编写，通过发送包含特制Range头的HTTP请求来触发漏洞。 Range头构造方式为`bytes=-%d,-9223372036854%d`, 通过溢出，使得返回的数据包含超出预期范围的内容。

**投毒风险：**
分析POC代码，该脚本的功能集中在发送特制的HTTP请求以触发漏洞，没有发现任何尝试执行恶意操作的代码。 脚本仅发送带有恶意Range头的请求，并根据响应状态码和是否存在Content-Range头来判断目标是否易受攻击。因此，投毒风险评估为0%。

**利用方式：**
1.  脚本首先发送一个普通的HTTP请求到目标URL，获取Content-Length。
2.  然后，根据Content-Length计算出一个用于构造Range头的参数。
3.  构造一个带有特制Range头的HTTP请求，发送到目标URL。
4.  检查响应状态码是否为206（Partial Content），以及响应头中是否存在Content-Range。如果满足这两个条件，则认为目标存在漏洞，服务器可能存在信息泄露。

**项目地址:** [gemboxteam/exploit-nginx-1.10.3](https://github.com/gemboxteam/exploit-nginx-1.10.3)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)