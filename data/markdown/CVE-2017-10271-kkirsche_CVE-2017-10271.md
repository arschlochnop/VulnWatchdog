## CVE-2017-10271 WebLogic wls-wsat 组件反序列化 RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0 and 12.2.1.2.0

**利用条件:** 目标服务器开启T3协议且存在漏洞，攻击者需要能够通过网络访问目标服务器的T3端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 wls-wsat 组件的一个反序列化漏洞。攻击者可以通过发送特制的 SOAP 消息，利用 XMLDecoder 反序列化漏洞在服务器上执行任意代码，从而完全控制服务器。漏洞存在于处理 SOAP 消息的 wls-wsat 组件中，未经授权的攻击者可以通过 T3 协议利用此漏洞。

**有效性：**

根据提供的漏洞信息和漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息显示这是一个容易被利用的漏洞，并且影响多个 WebLogic Server 版本。漏洞利用代码 (CVE-2017-10271.py) 提供了一个完整的利用程序，可以发送恶意 SOAP 消息来触发反序列化漏洞并执行任意命令。

**投毒风险：**

查看提供的 Python 脚本代码，未发现明显的恶意代码或投毒迹象。脚本的主要功能是构造恶意的 SOAP 消息，该消息包含执行反向 shell 的有效负载。该脚本允许用户指定攻击者的 IP 地址和端口，以便接收反向 shell。脚本本身没有隐藏任何执行恶意操作的代码，其行为与漏洞描述一致。

**利用方式：**

1.  **确定目标 WebLogic Server 版本：**  使用nmap或其他工具对目标进行扫描，确认Weblogic版本是否在受影响的范围内。
2.  **配置漏洞利用程序：** 修改 Python 脚本中的 `lhost` 和 `lport` 变量，以指定攻击者机器的 IP 地址和端口，用于接收反向 shell。
3.  **设置监听器：**  在攻击者机器上设置一个监听器 (例如，使用 `nc -nlvp <port>` 或 Python 的 `http.server` 模块) 以接收反向 shell 连接或者检测 check 验证。
4.  **运行漏洞利用程序：**  运行 Python 脚本，该脚本将向目标 WebLogic Server 发送一个包含恶意 XML 数据的 SOAP 消息。
5.  **获取 shell：**  如果漏洞利用成功，目标服务器将执行恶意代码，并向攻击者机器建立反向 shell 连接，从而允许攻击者在服务器上执行任意命令。

该漏洞利用依赖于 WebLogic Server 错误地处理 SOAP 消息中的 XML 数据，并允许未经授权的用户执行代码。通过利用这个漏洞，攻击者可以完全控制受影响的 WebLogic Server 实例。

**项目地址:** [kkirsche/CVE-2017-10271](https://github.com/kkirsche/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)