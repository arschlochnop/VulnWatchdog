## CVE-2025-20281 - Cisco ISE Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2025-20281

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cisco Identity Services Engine (ISE) / ISE-PIC

**危害等级:** 严重，未授权远程root权限代码执行

**影响版本:** 3.3.0, 3.3 Patch 2, 3.3 Patch 1, 3.3 Patch 3, 3.4.0, 3.3 Patch 4, 3.4 Patch 1, 3.3 Patch 5

**利用条件:** 目标设备存在漏洞版本的Cisco ISE/ISE-PIC，且攻击者可以访问目标设备的网络端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-20281 是 Cisco ISE 和 ISE-PIC 中一个特定的 API 接口存在未授权远程代码执行漏洞。该漏洞是由于对用户提供的输入验证不足造成的。未经身份验证的远程攻击者可以通过提交特制的API请求，以root身份在底层操作系统上执行任意代码。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。漏洞库信息明确指出存在未授权的RCE，CVSS评分为9.8（严重）。搜索引擎结果也证实了该漏洞的存在，并有多家安全厂商发布了相关报告。提供的POC代码利用 `requests` 库向目标API端点发送包含恶意命令的POST请求，通过检查响应中是否包含 `uid=` 或 `root` 来判断漏洞是否存在。攻击载荷 `__import__('os').system('id')` 尝试执行 `id` 命令，如果成功执行，则表明目标系统存在漏洞。

**投毒风险分析：**
该POC代码主要功能是检测漏洞是否存在，其执行的操作相对简单直接，风险较低，但仍存在一定风险。`check_cve_2025_20281.py` 脚本中的 crafted_payload 变量，虽然当前设置为执行 `id` 命令，但如果被修改为恶意命令（例如删除文件、下载恶意软件等），则可能对目标系统造成损害。不过从代码逻辑和结构来看，作者隐藏恶意代码的可能性较低。
因此，投毒风险评估为5%。

**利用方式：**
1.  **确定目标：** 确定运行受影响Cisco ISE/ISE-PIC版本的服务器的IP地址或域名。
2.  **发送恶意API请求：** 使用提供的POC代码，向目标服务器的 `/admin/API/malicious`  路径发送包含恶意payload的POST请求。Payload利用Python的 `os.system` 函数执行系统命令。
3.  **验证漏洞：** 检查服务器的响应。如果响应中包含 `uid=` 或 `root`，则表明漏洞存在且已成功利用。
4.  **代码分析:** path变量`/admin/API/malicious`和payload变量`__import__('os').system('id')`为关键利用点。

**项目地址:** [grupooruss/CVE-2025-20281-Cisco](https://github.com/grupooruss/CVE-2025-20281-Cisco)

**漏洞详情:** [CVE-2025-20281](https://nvd.nist.gov/vuln/detail/CVE-2025-20281)