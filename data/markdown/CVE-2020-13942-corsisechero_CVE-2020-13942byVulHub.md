## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要网络访问Unomi的/context.json端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 漏洞存在于 Apache Unomi 1.5.2 之前的版本中。攻击者可以向 `/context.json` 公共端点注入恶意的 OGNL 或 MVEL 脚本，从而实现远程代码执行。

**有效性分析：**
提供的POC代码通过构造包含 MVEL 表达式的 JSON payload，并将其 POST 到 `/context.json` 端点，利用了 Unomi 对用户输入验证不严格的缺陷，成功执行了 `touch /tmp/pluto` 命令，创建了文件，证明 POC 代码有效。

**投毒风险分析：**
分析提供的漏洞利用代码仓库，发现代码主要包含 docker-compose 编排文件和用于触发漏洞的 curl 命令。docker-compose 文件定义了 Unomi 1.5.1 版本的 Docker 镜像和 Elasticsearch 镜像，环境搭建没有问题。curl 命令中的 MVEL 表达式 `script::Runtime r = Runtime.getRuntime(); r.exec("touch /tmp/pluto");` 用于在目标服务器上创建 `/tmp/pluto` 文件以验证漏洞。**没有发现作者隐藏的恶意代码，主要风险还是在于直接运行未经验证的第三方docker镜像。投毒风险较低，估计为1%。**

**利用方式：**
1.  攻击者构造包含恶意 MVEL 或 OGNL 表达式的 JSON 数据。
2.  将该 JSON 数据通过 HTTP POST 请求发送到 Apache Unomi 服务器的 `/context.json` 端点。
3.  Unomi 服务器解析 JSON 数据，由于输入验证不足，导致恶意表达式被执行，最终实现远程代码执行。

根据漏洞库信息，Apache Unomi 1.5.2 修复了此漏洞，强烈建议升级到最新版本。


**项目地址:** [corsisechero/CVE-2020-13942byVulHub](https://github.com/corsisechero/CVE-2020-13942byVulHub)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)