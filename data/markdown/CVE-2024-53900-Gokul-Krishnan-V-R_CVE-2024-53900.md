## CVE-2024-53900-Mongoose-Search Injection

**漏洞编号:** CVE-2024-53900

**漏洞类型:** Search Injection

**影响应用:** Mongoose

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 8.8.3

**利用条件:** 需要应用程序使用 Mongoose 并且允许用户控制查询参数，特别是 $where 操作符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-53900 是 Mongoose 版本低于 8.8.3 中存在的搜索注入漏洞。漏洞根源在于 Mongoose 对 `match` 查询中的 `$where` 操作符处理不当，允许攻击者注入恶意的 JavaScript 代码，导致信息泄露或远程代码执行。 

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。搜索引擎结果中明确指出该漏洞允许搜索注入攻击，甚至可能导致 RCE。漏洞利用代码提供了一个可利用的`package-lock.json`文件依赖信息，其中指定了`mongoose`的版本为`8.13.1`，高于漏洞存在的版本。但这个并不影响漏洞利用的有效性。因为`package.json`和漏洞利用代码中缺少具体代码，无法精准判断，但是根据其他信息，漏洞利用的有效性依然较高。

**投毒风险：**
分析提供的`package-lock.json`文件，该文件列出了项目依赖的第三方库及其版本。虽然该文件本身不包含恶意代码，但是供应链投毒的风险依然存在。如果攻击者能够篡改这些依赖库，可能会在应用中引入恶意代码。根据文件内容，判断为作者故意隐藏的投毒代码的可能性为10%。因为提供的文件只是依赖关系，没有实际的代码，因此无法确认是否存在后门。

**利用方式：**
1.  攻击者利用用户可控的输入，构造包含恶意 JavaScript 代码的 `$where` 子句。
2.  Mongoose 在执行查询时，会将该 `$where` 子句作为 JavaScript 代码执行。
3.  恶意 JavaScript 代码可以执行任意操作，例如读取敏感数据、修改数据，甚至执行系统命令。

**缓解措施：**
*   升级 Mongoose 到 8.8.3 或更高版本。
*   避免在 `match` 查询中使用 `$where` 操作符。如果必须使用，请务必对用户输入进行严格的验证和过滤。

**项目地址:** [Gokul-Krishnan-V-R/CVE-2024-53900](https://github.com/Gokul-Krishnan-V-R/CVE-2024-53900)

**漏洞详情:** [CVE-2024-53900](https://nvd.nist.gov/vuln/detail/CVE-2024-53900)