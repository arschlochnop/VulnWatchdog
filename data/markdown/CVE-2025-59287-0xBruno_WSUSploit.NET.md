## CVE-2025-59287-Windows Server Update Service (WSUS) Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化漏洞

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，远程代码执行

**影响版本:** Windows Server 2012/2012 R2/2016/2019/2022/2025/23H2 (受影响版本见漏洞库信息)

**利用条件:** 需要网络访问WSUS服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)的远程代码执行漏洞，源于对不可信数据进行反序列化。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。POC代码`WSUSploit.NET`尝试通过SOAP请求与WSUS服务器交互，依次获取Server ID、AuthCookie和ReportingCookie，然后发送恶意事件。虽然提供的代码片段不完整，但整体框架是可行的。有效性取决于完整POC的实现和目标WSUS服务器的具体配置。

**有效性：**
提供的代码片段展示了漏洞利用的初步步骤，包括获取必要的身份验证信息。由于代码不完整，无法直接验证漏洞利用的完整性和有效性。从原理上讲，利用反序列化漏洞实现远程代码执行是可能的。

**投毒风险：**
代码本身并不直接表现出明显的投毒行为，但存在以下潜在风险：

*   **依赖项风险：** 代码可能依赖于外部库（虽然代码片段没有显示，但使用了 `WSUSploit.NET`命名空间，可能引用了其他项目或库）。如果这些库被恶意篡改，可能引入投毒代码。
*   **后门植入：** 虽然当前代码段没有明显的后门，攻击者可能会在完整的POC中植入后门，例如添加额外的网络请求，下载并执行任意代码。
*   **误导性代码：** 代码可能包含混淆或误导性的部分，使得安全研究人员难以发现潜在的恶意行为。从目前给出的代码片段来看投毒风险较低，估计为10%。

**利用方式：**
利用方式主要包括以下步骤：

1.  **获取Server ID：** 通过SOAP请求获取WSUS服务器的Server ID。
2.  **获取AuthCookie：** 使用Server ID通过SOAP请求获取身份验证Cookie。
3.  **获取ReportingCookie (未完整展示)：** 获取Reporting Cookie.
4.  **发送恶意事件：**  构造包含恶意序列化数据的SOAP请求，利用WSUS服务器的反序列化漏洞执行任意代码。

需要注意的是，成功利用该漏洞需要对WSUS协议和反序列化漏洞有深入的理解，并根据目标WSUS服务器的具体配置进行调整。

**项目地址:** [0xBruno/WSUSploit.NET](https://github.com/0xBruno/WSUSploit.NET)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)