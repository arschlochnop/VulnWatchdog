## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 允许攻击者通过在 Git 配置文件中注入恶意代码来执行任意命令。漏洞利用主要围绕 Git 如何处理带有回车符的配置值。如果 submodule 路径包含尾随的回车符 (CR)，则修改后的路径会被读取，导致 submodule 被检出到错误的位置。如果存在一个符号链接，将修改后的路径指向 submodule hooks 目录，并且 submodule 包含一个可执行的 post-checkout hook，则该脚本可能会在检出后被意外执行，导致任意代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞是有效的。已发布了针对此漏洞的修复程序。

**投毒风险：**

提供的 POC 代码包含以下文件：

*   `README.md`: 一个空的 README 文件
*   `sub`:  一个 `.git/modules/sub/hooks` 目录。

`sub` 目录本身并不包含任何可执行代码，仅仅是一个空的hooks目录，因此直接投毒的可能性较低。但是,攻击者可能在受害者执行 `git clone --recursive`后，通过 submodule 初始化过程创建恶意的 hooks 文件或者修改 `.gitmodules` 文件来间接投毒。因此，存在一定的投毒风险，但风险等级较低。

**利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含恶意的 `.gitmodules` 文件的 Git 仓库。该文件中的 submodule 路径包含一个尾随的回车符 (CR)。
2.  **设置符号链接：**  在仓库中创建一个符号链接，该链接将包含回车符的路径指向 submodule 的 `hooks` 目录。
3.  **添加恶意 hook：**  在 submodule 的 `hooks` 目录中添加一个恶意的 post-checkout hook 脚本。当用户执行 `git clone --recursive` 命令时，Git 会将 submodule 检出到错误的位置，由于存在符号链接，恶意的 post-checkout hook 将会被执行，从而导致任意代码执行。

**风险分析：**

该漏洞的利用需要用户执行 `git clone --recursive` 命令，并且依赖于用户机器上的 Git 版本存在漏洞。攻击的复杂性较高，需要精心的构造恶意仓库，但是如果成功利用，可以导致远程代码执行，因此风险等级较高。

**搜索引擎结果分析：**

*   NVD 提供了漏洞的详细信息和更新记录。
*   Red Hat 将此漏洞标记为“重要”，强调了其对 Git 路径和配置完整性的威胁。
*   dgl.cx 的文章详细介绍了利用此漏洞进行 RCE 的方法。


**项目地址:** [testdjshan/CVE-2025-48384](https://github.com/testdjshan/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)