## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或本地权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地访问，并且需要开启 User Namespaces

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当过滤器句柄值为 0 时，旧的过滤器在被释放前不会从哈希表中删除，导致UAF。

**有效性评估:** 根据漏洞库信息和搜索结果，该漏洞的 PoC 是可用的。参考链接：[https://github.com/Markakd/CVE-2022-2588](https://github.com/Markakd/CVE-2022-2588) 说明此漏洞存在可利用性。

**投毒风险评估:** 提供的漏洞利用代码包含两个 C 文件：CVE-2022-2585.c 和 CVE-2022-2586.c。 CVE-2022-2585.c 创建一个定时器，并在定时器回调函数中执行 "./poc" (poc1)。CVE-2022-2586.c 主要针对 netfilter 模块，创建表，对象和集合。
代码分析表明，CVE-2022-2586.c 利用了 `NFT_SET_OBJECT` 标志，这允许集合包含对对象的引用，即使该对象在删除表的上下文中。 这种引用可以导致 Use-After-Free，因为被引用的对象在仍然被集合引用的情况下被释放。
提供的代码本身看起来是合法的漏洞利用尝试，旨在触发 Use-After-Free 漏洞，没有明显的恶意代码或后门。但是,如果存在`./poc`二进制文件，需要进一步分析这个文件来确定这个二进制文件是否包含恶意代码. 这里假设不存在.

**利用方式分析:**

1.  **漏洞触发:** 通过创建和删除 netfilter 表和对象，特别是在设置中使用对象引用。
2.  **UAF 利用:** 通过在对象被删除后仍然保持对其的引用，可以触发 Use-After-Free。
3.  **权限提升 (可能性):**  虽然 CVSS 评分显示完整性影响较低，但搜索结果表明该漏洞可能导致本地权限提升。这是通过 UAF 漏洞的经典利用来实现的，例如覆盖内核数据结构以获得特权。

总而言之，POC 代码是有效的，并且风险在于利用 UAF 漏洞来实现权限提升。由于未在提供的PoC代码中发现明显恶意代码，因此投毒风险较低, 因此评判为 0%。需要进一步分析任何依赖的二进制文件(`poc`).

**项目地址:** [konoha279/2022-LPE-UAF](https://github.com/konoha279/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)