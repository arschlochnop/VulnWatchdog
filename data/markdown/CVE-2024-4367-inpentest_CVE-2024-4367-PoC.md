## CVE-2024-4367-PDF.js 任意JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript执行

**影响应用:** Firefox, Firefox ESR, Thunderbird (通过 PDF.js)

**危害等级:** 高危，可能导致信息泄露、会话劫持等

**影响版本:** < Firefox 126, < Firefox ESR 115.11, < Thunderbird 115.11

**利用条件:** 用户打开恶意的PDF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4367 漏洞存在于 PDF.js 中，由于缺少对字体处理的类型检查，攻击者可以通过构造恶意的PDF文件，嵌入恶意JavaScript代码，当用户使用受影响的 Firefox、Firefox ESR 或 Thunderbird 版本打开该PDF文件时，嵌入的 JavaScript 代码将在 PDF.js 上下文中执行。

**有效性：**
提供的PoC代码是一个PDF文件，其中包含恶意的JavaScript代码。PDF文件利用了字体处理漏洞，当PDF.js解析字体时，会执行嵌入的JavaScript。

**投毒风险：**
该仓库包含一个 PDF PoC,一个 LICENSE 文件，和一个 README。LICENSE 文件和 README 文件本身没有风险。虽然PoC代码能直接利用漏洞，但作者 Ahmad Kabiri 的身份未知，且PoC的目的是展示攻击，因此存在一定的投毒风险，例如，攻击者可能会在实际利用时修改或增加payload, 但该 PoC 文件本身目的明确，结构简单，隐藏恶意后门代码可能性较低。考虑到MIT协议的开放性以及作者已知的漏洞研究背景，投毒的可能性较低，大约为 10%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的PDF文件。
2.  攻击者诱骗用户打开该PDF文件 (例如, 通过钓鱼邮件, 挂马网站)。
3.  如果用户使用的浏览器或邮件客户端（例如 Firefox, Firefox ESR, Thunderbird）的 PDF.js 版本存在漏洞，则恶意JavaScript代码将被执行。
4.  恶意JavaScript代码可以在PDF.js的上下文中执行任意操作，例如窃取cookie、localStorage数据、sessionStorage数据，甚至进行会话劫持等。PoC代码显示会弹出多个alert框来展示获取到的信息.

**项目地址:** [inpentest/CVE-2024-4367-PoC](https://github.com/inpentest/CVE-2024-4367-PoC)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)