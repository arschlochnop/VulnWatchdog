## CVE-2012-4869-FreePBX-远程命令执行

**漏洞编号:** CVE-2012-4869

**漏洞类型:** 远程命令执行

**影响应用:** FreePBX/Elastix

**危害等级:** 高危，可完全控制服务器

**影响版本:** FreePBX 2.9, 2.10, Elastix 2.2.0

**利用条件:** 目标系统存在漏洞页面，攻击者可以访问该页面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2012-4869 是 FreePBX 和 Elastix 存在的一个远程命令执行漏洞，位于 `recordings/misc/callme_page.php` 文件中。攻击者可以利用 `callmenum` 参数，通过构造恶意的输入，执行任意系统命令。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。POC 代码针对 Elastix 2.2.0 进行了验证，但漏洞同样存在于 FreePBX 2.9 和 2.10 中。搜索引擎结果也表明存在可利用的 Metasploit 模块。

**投毒风险分析：**
POC 代码主要是利用 LFI 漏洞执行 Perl 反弹 Shell。虽然代码整体是利用已知漏洞，但仍存在一定的投毒风险：
1.  **反弹 Shell 地址:** 代码中使用了硬编码的反弹 Shell IP 和端口，如果攻击者部署了恶意服务器，可能会诱导用户连接到恶意服务器。
2.  **Payload 修改:** 攻击者可能修改 Perl Payload，植入恶意代码，例如添加下载和执行恶意文件的功能。

整体风险较低，因为利用的核心是已知漏洞，但也不能排除作者故意添加恶意功能的可能性。
综合评估，投毒风险约为 5%。此风险主要体现在反弹 shell 的地址及可修改的payload 上。

**利用方式：**
1.  **漏洞定位：** 漏洞存在于 `recordings/misc/callme_page.php` 文件中。
2.  **参数注入：** 通过 `callmenum` 参数注入恶意代码。
3.  **命令执行：** 注入的命令通过 `system()` 函数执行，从而实现远程命令执行。

**POC 代码利用步骤：**
1.  安装 `requests` 模块。
2.  运行 exploit.py，指定目标 URL、LHOST 和 LPORT。
3.  在本地监听 LPORT，等待反弹 Shell 连接。

**防御措施：**
1.  升级 FreePBX 和 Elastix 到最新版本。
2.  禁用或删除存在漏洞的 `callme_page.php` 文件。
3.  对用户输入进行严格的验证和过滤。
4.  部署入侵检测系统，监控恶意请求。

**项目地址:** [cyberdesu/Elastix-2.2.0-CVE-2012-4869](https://github.com/cyberdesu/Elastix-2.2.0-CVE-2012-4869)

**漏洞详情:** [CVE-2012-4869](https://nvd.nist.gov/vuln/detail/CVE-2012-4869)