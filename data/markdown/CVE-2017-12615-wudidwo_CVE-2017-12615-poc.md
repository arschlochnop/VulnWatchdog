## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，HTTP PUT方法启用（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意 JSP 文件到启用了 HTTP PUT 方法的 Apache Tomcat 服务器上，从而执行任意代码。漏洞存在于 Windows 系统中，并且服务器的 `readonly` 初始化参数必须设置为 `false`，即允许 PUT 请求。 

**有效性：**

根据漏洞描述、搜索引擎结果（例如，Exploit-DB，Rapid7 VulnDB，CISA KEV Catalog）以及提供的PoC代码，此漏洞是有效的。PoC代码的功能是尝试使用PUT方法上传一个JSP文件，然后访问该文件以验证是否成功上传并执行。

**投毒风险：**

分析提供的 PoC 代码（CVE-2017-12615.py 和 README.md）：

*   `CVE-2017-12615.py`：此脚本的主要功能是利用 CVE-2017-12615 漏洞上传 JSP 文件到目标 Tomcat 服务器。它接受 URL 和端口作为参数，并尝试使用 PUT 方法上传指定或默认的 JSP 文件。然后，它检查上传的文件是否可以访问以及是否包含预期的内容。
*   `README.md`：此文件仅包含使用说明，没有恶意代码。

代码中不存在明显的投毒行为。脚本的目的是验证漏洞，而不是执行恶意操作。 经过分析，该仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**利用方式：**

1.  **条件判断：** 确保目标 Tomcat 服务器运行在 Windows 系统上，且启用了 HTTP PUT 方法 ( `readonly` 参数设置为 `false` )。
2.  **上传 JSP 文件：** 使用 PUT 请求上传包含恶意代码的 JSP 文件。可以利用提供的 PoC 脚本，指定目标 URL、端口和要上传的 JSP 文件。
3.  **执行代码：** 成功上传后，通过访问上传的 JSP 文件来触发恶意代码的执行。 这将导致在 Tomcat 服务器上执行任意代码，攻击者可以利用这一点来获取系统控制权，例如安装 webshell，读取敏感数据，或者进行其他恶意活动。

**排序优先级说明：**

在本次分析中，搜索引擎结果提供了漏洞已被广泛利用的证据，并提供了额外的背景信息。漏洞利用代码直接提供了可操作的验证手段。 漏洞库信息提供了漏洞的官方描述和受影响的版本信息。因此遵循 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息 的排序优先级。

**项目地址:** [wudidwo/CVE-2017-12615-poc](https://github.com/wudidwo/CVE-2017-12615-poc)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)