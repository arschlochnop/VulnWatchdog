## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和文件篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2
10.1.0-M1 <= version <= 10.1.34
9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：Default Servlet 开启写入权限 (默认关闭), 开启 partial PUT (默认开启), 敏感文件位于公开上传目录的子目录, 攻击者已知敏感文件名, 使用 partial PUT 上传敏感文件，或者Tomcat使用文件存储 session 且包含可利用的反序列化库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，攻击者可以通过利用 'file.Name' (内部点) 绕过路径检查，结合 Default Servlet 的写入权限和 partial PUT 功能，实现远程代码执行、信息泄露或恶意内容添加。

**漏洞利用方式分析:**

1.  **信息泄露和文件篡改:**
    *   攻击者利用 partial PUT 功能，将恶意内容写入服务器上的临时文件。
    *   利用路径等价漏洞，使得攻击者可以访问或覆盖位于受保护目录中的文件。
    *   通过精心构造的 partial PUT 请求，攻击者可以读取或修改敏感文件，导致信息泄露或文件篡改。
    *   PoC 代码演示了如何通过 partial PUT 请求，在未授权的情况下读取 secret 目录下的文件内容，实现信息泄露。

2.  **远程代码执行 (RCE):**
    *   如果 Tomcat 使用文件存储 session，攻击者可以将包含恶意序列化对象的 payload 上传到 session 文件中。
    *   当 Tomcat 加载该 session 时，会触发反序列化漏洞，导致远程代码执行。

**投毒风险分析:**

PoC 代码存在很高的投毒风险，原因如下：

1.  **利用条件复杂:** 该漏洞的利用依赖于多个配置条件，例如 Default Servlet 开启写入权限，开启 partial PUT，以及特定的目录结构。攻击者可能需要进行大量的探测和尝试才能找到满足利用条件的目标。
2.  **文件上传:** 该漏洞涉及到文件上传，攻击者可以在上传的文件中嵌入恶意代码，例如 webshell 或其他恶意脚本，从而控制服务器。
3. **Partial PUT 特点:**  Partial PUT 允许攻击者分块上传文件,方便投毒和绕过检查。
4.  **反序列化攻击:** RCE的其中一种方式依赖反序列化漏洞，而反序列化 payload 本身就具有极高的投毒风险。

考虑到这些因素，该漏洞的投毒风险非常高。如果攻击者成功利用该漏洞，可能会对服务器造成严重的损害。

**项目地址:** [gregk4sec/CVE-2025-24813](https://github.com/gregk4sec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)