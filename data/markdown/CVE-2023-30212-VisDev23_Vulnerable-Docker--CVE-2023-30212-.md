## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型跨站脚本攻击 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户信息泄露、页面篡改等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212漏洞存在于OURPHP v7.2.0及更早版本中。这是一个反射型XSS漏洞，位于`/client/manage/ourphp_out.php`页面。攻击者可以通过构造包含恶意JavaScript代码的URL，当用户访问该URL时，恶意脚本会在用户的浏览器中执行。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此漏洞是有效的。搜索引擎结果中存在多个关于此漏洞的链接，包括NVD的漏洞详情页面和GitHub上的POC代码。提供的Dockerfile和README.md文件也展示了如何搭建包含漏洞的环境并进行利用。

**投毒风险：**

评估POC代码中是否存在投毒风险。提供的代码主要包含以下几个部分：

1.  **Dockerfile:** 用于构建包含漏洞的OURPHP环境的Docker镜像。这个文件本身不包含恶意代码，只是用于配置和安装必要的组件。
2.  **README.md:** 提供了搭建和利用漏洞的步骤，其中包含XSS payload `</script><script>alert("xss")</script>`。这个payload只是用于验证XSS漏洞的存在，不具有破坏性。
3.  **init.sql 和 my.cnf:** 用于配置MySQL数据库，创建root用户并授予所有权限。 在实际生产环境中，这是一个安全风险，但在这里主要是为了方便搭建漏洞环境。
4.  **data/admin.php:** OURPHP 的一个admin.php 文件，不包含任何恶意后门。

**综合分析：**

*   Dockerfile和README.md文件本身不包含恶意代码。
*   提供的XSS payload只是用于验证漏洞，不具有破坏性。
*   MySQL的配置存在潜在风险，但这是为了方便漏洞环境的搭建，并非恶意的投毒行为。

因此，代码中存在投毒代码的风险较低，大约为10%。主要是因为提供了root用户的数据库权限，如果利用Docker搭建环境的人员不注意，可能会导致安全问题，但这不是作者主动投毒，而是一种不安全的配置。

**利用方式：**

1.  搭建包含漏洞的OURPHP环境（可以使用提供的Dockerfile）。
2.  构造包含XSS payload的URL：`/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert("xss")</script>`
3.  诱导用户点击该URL。用户访问该URL后，浏览器会执行XSS payload，弹出包含"xss"的alert框，表明漏洞利用成功。

**项目地址:** [VisDev23/Vulnerable-Docker--CVE-2023-30212-](https://github.com/VisDev23/Vulnerable-Docker--CVE-2023-30212-)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)