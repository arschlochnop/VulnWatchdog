## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center & Server

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问，且未完成初始化设置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515是一个Atlassian Confluence Data Center和Server中的一个严重漏洞，属于权限控制缺失类型。未经身份验证的远程攻击者可以通过利用/server-info.action端点判断Confluence是否已经初始化，如果未初始化，可以通过/setup/setupadministrator.action端点创建新的管理员账户。利用方式如下：

1.  **检测是否可利用：**  访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，如果返回未完成设置的状态，则存在漏洞。
2.  **创建管理员账户：**  向`/setup/setupadministrator.action`发送POST请求，包含`username`、`fullName`、`email`、`password`和`confirm`参数，创建一个新的管理员账户。
3.  **完成设置：** 向 `/setup/finishsetup.action` 发送POST请求，完成安装。

提供的POC代码`CVE-2023-22515.py`实现了上述步骤，可以有效利用该漏洞。

**投毒风险分析：**

查看了`CVE-2023-22515.py`和`README.md`的内容，没有发现明显的恶意代码或者后门。该脚本的主要功能是自动化创建管理员账户，并没有执行任何与系统安全相关的敏感操作，例如文件读写、命令执行等。此外，`README.md`文件只是简单的介绍了漏洞和使用方法，也未发现任何可疑之处。综上所述，此仓库中存在作者隐藏的投毒代码的可能性极低，接近于0%。

**项目地址:** [Le1a/CVE-2023-22515](https://github.com/Le1a/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)