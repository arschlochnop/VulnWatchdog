## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标Next.js应用使用了middleware进行授权检查，并且请求头中包含`x-middleware-subrequest`。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927 是一个 Next.js middleware 授权绕过漏洞。如果 Next.js 应用使用 middleware 进行授权检查，并且请求头中包含 `x-middleware-subrequest`，则可能绕过授权。

**漏洞利用分析：**

根据漏洞库信息，该漏洞发生在 Next.js middleware 中，攻击者可以通过构造包含 `x-middleware-subrequest` 头的请求来绕过授权检查。漏洞利用代码（Dockerfile）主要用于搭建一个包含漏洞环境的CTF挑战，其中包含了Web应用部署，SSH服务配置，以及权限提升等步骤。这个Dockerfile本身并没有直接利用该漏洞进行攻击，而是构建一个可以复现该漏洞的环境。

具体利用方式是，攻击者通过发送包含 `x-middleware-subrequest` 头部的恶意请求，尝试访问未经授权的资源或执行未授权的操作。

**投毒风险分析：**

此Docker镜像的主要目的是创建一个可供练习的CTF环境，从Dockerfile的内容来看，虽然包含了一些用户创建、文件复制等操作，但没有发现明显的恶意代码。风险点可能在于预先设置的用户名密码（simone/scoobydoo）可能会被恶意利用，但这是CTF挑战的一部分，不算投毒行为。该镜像主要用于安全练习，投毒风险较低。

风险点分析：

1.  **预设密码：** 用户 'simone' 拥有预设密码 'scoobydoo'。在真实环境中，这显然是一个安全风险，攻击者可以直接使用该密码登录。但在CTF环境中，这通常是解题的线索之一。
2.  **SUID Wrapper：** `/opt/tools/archive-logs` 被设置为 SUID root。如果 `log_archiver.py` 中存在漏洞，可能导致提权。虽然这是一个权限提升的利用点，但在CTF环境中属于设计的一部分。

**有效性评估：**

由于提供的Dockerfile主要是为了搭建一个CTF环境，所以需要结合实际的Next.js应用代码来验证漏洞的有效性。但是，该Dockerfile提供了复现该漏洞所需的环境，因此具有一定的参考价值。

**项目地址:** [NS-Projects-Unina/CTF_CVE_DSP_1](https://github.com/NS-Projects-Unina/CTF_CVE_DSP_1)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)