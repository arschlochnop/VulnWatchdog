## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 以及多个re-branded版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问DVR设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216系列及re-branded版本

**利用条件:** 需要网络可达，目标设备未修复漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过设置 `Cookie: uid=admin` header绕过身份验证。提供的Python脚本 `CVE-2018-9995_check.py` 用于检测目标主机是否受此漏洞影响。该脚本通过发送HTTP GET请求到 `/login.rsp` 路径，并检查响应头 `Server` 是否包含 `GNU rsp/1.0`，如果存在，则认为目标存在漏洞，并将URL保存到 `result.txt` 文件中。

**有效性：**
提供的POC脚本是有效的，可以用于检测目标是否存在CVE-2018-9995漏洞。它通过检查服务器响应头来判断目标是否使用了受影响的DVR设备。

**投毒风险：**
投毒风险较低，约为10%。虽然脚本会将检测到的URL写入到 `result.txt` 文件中，但这并不构成直接的投毒行为。投毒风险在于，如果攻击者控制了运行脚本的机器，他们可以修改脚本以执行恶意操作，例如将扫描结果发送到攻击者的服务器，或者执行其他恶意代码。此外，脚本的README.md文件中存在一个指向漏洞利用工具的链接，存在被替换为恶意链接的可能。

**利用方式：**
漏洞的利用方式是通过在HTTP请求中设置 `Cookie: uid=admin` header来绕过身份验证。根据漏洞描述，可以通过发送带有该Cookie的请求到 `device.rsp?opt=user&cmd=list` 路径来获取用户凭据。github.com/ezelf/CVE-2018-9995_dvr_credentials 提供了利用该漏洞的工具，允许攻击者访问DVR设备并获取视频流。

**项目地址:** [Huangkey/CVE-2018-9995_check](https://github.com/Huangkey/CVE-2018-9995_check)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)