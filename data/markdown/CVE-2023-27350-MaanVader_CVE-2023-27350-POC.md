## CVE-2023-27350-PaperCut NG/MF-身份验证绕过与远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914) (NG)和受影响的MF版本

**利用条件:** 目标系统运行PaperCut NG/MF，且允许对9191端口的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-27350 允许未经身份验证的远程攻击者绕过 PaperCut NG/MF 的身份验证机制，从而实现远程代码执行。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。攻击者可以利用此漏洞绕过身份验证，并在 SYSTEM 上下文中执行任意代码。

**有效性：**
从搜索结果以及漏洞描述来看，漏洞真实存在并且已被积极利用。提供的 POC 代码 `find-vuln-ver.py` 旨在检测目标系统是否运行易受攻击的 PaperCut 版本，并通过访问特定的 URL 来引导攻击者进行身份验证绕过。根据github上的其他POC，第一步绕过验证获取权限，第二步利用内置的脚本功能执行代码。

**投毒风险：**
POC 代码 `find-vuln-ver.py` 本身主要用于检测漏洞版本，并给出绕过登录的URL，代码相对简单，不包含任何明显的恶意代码。但是,任何代码都不能保证绝对的安全。因此，极小的可能会有隐藏的投毒代码(比如通过特殊的字符编码、或者利用一些python的特性来执行恶意操作)。但是考虑到其功能主要是版本检测和URL引导，这个可能性非常低。所以投毒风险评定为1%。

**利用方式：**
1.  **版本检测:** 使用POC脚本或者手动访问`http://<ip>:9191/app?service=page/SetupCompleted`来检测PaperCut NG/MF的版本，确定目标系统是否是易受攻击的版本。
2.  **身份验证绕过:**  如果版本确认是易受攻击的版本，攻击者可以通过访问 `http://<ip>:9191/app?service=page/Dashboard` 来绕过身份验证。
3.  **远程代码执行:** 在绕过身份验证后，攻击者可以利用 PaperCut NG/MF 的内置脚本功能来执行任意代码。这通常涉及到上传恶意脚本或者利用已有的脚本执行机制。具体代码执行方式可能需要参考其他的PoC代码，搜索结果中提到了Horizon3ai的PoC。
4.  **权限提升:**  由于漏洞是在 SYSTEM 上下文中执行代码，攻击者可以完全控制受影响的系统。

**总结：**
CVE-2023-27350 是一个严重的安全漏洞，允许未经身份验证的攻击者完全控制 PaperCut NG/MF 服务器。 该漏洞已经被广泛利用，并被列入 CISA 已知被利用漏洞目录中。强烈建议受影响的用户立即应用补丁。

**项目地址:** [MaanVader/CVE-2023-27350-POC](https://github.com/MaanVader/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)