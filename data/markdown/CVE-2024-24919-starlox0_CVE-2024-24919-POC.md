## CVE-2024-24919 Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备已连接互联网，并开启远程接入 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个信息泄露漏洞。攻击者可以利用此漏洞读取 Check Point Security Gateway 上的任意文件。该漏洞是由于路径遍历造成的。根据漏洞库信息和搜索引擎结果，该漏洞影响开启了远程接入 VPN 或 Mobile Access Software Blades 的 Check Point Quantum Gateway, Spark Gateway 和 CloudGuard Network 设备。提供的 POC 代码是一个 bash 脚本，它通过发送带有修改后的路径的 HTTP POST 请求到 `/clients/MyCRL` 端点来利用此漏洞。脚本尝试读取 `/etc/passwd` 文件以验证漏洞。如果响应包含 `/bin/bash` 或 `/sbin/nologin`，则认为目标易受攻击。

**有效性：**
根据CISA KEV和各安全厂商的分析，此漏洞被积极利用，且提供的PoC可以验证漏洞的存在，所以是有效的。

**投毒风险：**
分析 POC 代码后，没有发现任何明显的投毒代码。该脚本的主要功能是发送 HTTP 请求并检查响应。脚本不包含任何下载或执行其他恶意文件的功能。此外，LICENSE 文件采用的是 MIT 许可，表明作者允许修改和分发，但同时也免除了因使用该软件而产生的任何责任。README文件描述了工具的用法，未发现恶意行为。

**利用方式：**
1.  攻击者向目标 Check Point Security Gateway 的 `/clients/MyCRL` 端点发送一个特制的 HTTP POST 请求。
2.  在 POST 请求的数据部分，攻击者使用 `aCSHELL/` 前缀，后跟一个路径遍历字符串，指向要读取的文件。例如，`aCSHELL/../../../../../etc/passwd`。
3.  服务器处理请求，并将指定文件的内容返回给攻击者。
4.  攻击者通过检查返回的内容来验证漏洞是否成功利用（例如，通过查找 `/bin/bash` 或 `/sbin/nologin` 在 `/etc/passwd` 中的存在）。

**项目地址:** [starlox0/CVE-2024-24919-POC](https://github.com/starlox0/CVE-2024-24919-POC)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)