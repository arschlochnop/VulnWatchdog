## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并且Alias-like指令配置不当，或者CGI脚本已启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符（如`.%2e`）的URL，绕过服务器的路径规范化限制，访问Alias-like指令配置目录之外的文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该POC代码有效。漏洞库信息明确指出该漏洞在野外被利用，搜索引擎结果也提供了多个关于该漏洞的解释和利用的文章。POC代码通过构造包含`.%2e`的URL来尝试读取目标服务器上的文件。

**投毒风险：**
分析提供的POC代码，该脚本主要功能是验证目标服务器是否存在CVE-2021-41773漏洞，脚本会检测指定的IP地址是否存在Apache HTTP Server，并尝试通过构造的URL读取指定文件。经验证，该脚本没有发现明显的恶意代码或后门，因此投毒风险较低。投毒风险百分比评估为0%。

**利用方式：**
1.  **确定目标：** 找到运行Apache HTTP Server 2.4.49的目标服务器。
2.  **构造Payload：** 构造包含恶意路径的URL，例如：`http://<target_ip>/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  **发送请求：** 将构造好的URL发送到目标服务器。
4.  **读取文件或执行代码：** 如果目标服务器存在漏洞且配置不当，攻击者可以读取任意文件（如`/etc/passwd`）或执行任意代码（如果CGI脚本已启用）。

需要注意的是，成功利用该漏洞的前提是服务器配置不当，例如没有对Alias-like指令配置的目录之外的文件进行适当的访问控制，或者启用了CGI脚本执行功能。

总而言之，这是一个严重的安全漏洞，可能导致敏感信息泄露和远程代码执行。管理员应尽快升级Apache HTTP Server版本或采取其他缓解措施。

**项目地址:** [Maybe4a6f7365/CVE-2021-41773](https://github.com/Maybe4a6f7365/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)