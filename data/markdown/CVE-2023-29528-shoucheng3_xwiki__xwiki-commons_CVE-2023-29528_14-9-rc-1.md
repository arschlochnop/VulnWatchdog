## CVE-2023-29528-XWiki-XSS

**漏洞编号:** CVE-2023-29528

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** XWiki Commons

**危害等级:** 高危，可能导致敏感信息泄露和服务器端代码执行

**影响版本:** >= 4.2-milestone-1, < 14.10

**利用条件:** 需要低权限用户在XWiki平台中添加包含恶意HTML注释的内容，且需要具有编程权限的特权用户访问该内容。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29528 是 XWiki Commons 中存在的跨站脚本漏洞。攻击者可以利用无效的 HTML 注释注入任意 HTML 代码和 JavaScript 代码。漏洞利用的关键在于，当拥有编程权限的特权用户访问包含恶意 JavaScript 代码的注释时，该代码将在用户会话的上下文中执行，从而可能导致服务器端代码执行，影响 XWiki 实例的保密性、完整性和可用性。

**有效性评估：**
根据漏洞描述，漏洞利用需要特定版本的 XWiki Commons 和特定的用户权限。由于搜索引擎结果表明该漏洞已公开，且漏洞库信息明确了受影响的版本和利用条件，因此可以判断漏洞利用具有一定的有效性。漏洞利用的关键在于构造恶意的HTML注释。

**投毒风险评估：**
提供的代码 `Jenkinsfile` 是一个 Jenkins 管道配置文件，用于自动化构建、测试和部署 XWiki Commons 项目。该文件本身并不直接包含 XWiki Commons 代码，因此直接投毒的风险较低。但是，如果此 Jenkinsfile 被用于构建受漏洞影响的 XWiki Commons 版本，并且构建过程中引入了恶意代码（例如，通过修改构建脚本或依赖项），则可能间接导致投毒。因此，该仓库中存在作者隐藏的投毒代码的风险较低，估计为 10%。这个估计主要考虑Jenkinsfile潜在的间接投毒可能性，例如构建脚本被篡改或依赖项被替换，导致最终构建出的XWiki Commons包含恶意代码。直接在Jenkinsfile本身植入恶意代码的可能性较小，因为该文件主要用于定义构建流程，而不是XWiki Commons的代码。

**利用方式：**
1.  攻击者需要首先在 XWiki 页面中插入包含恶意 JavaScript 代码的 HTML 注释。注释的形式需要能够绕过 XWiki 的 HTML 清理器的限制。
2.  诱导具有编程权限的特权用户访问包含该恶意注释的 XWiki 页面。
3.  当特权用户访问该页面时，恶意 JavaScript 代码将在用户的会话上下文中执行，攻击者可以利用这一点执行恶意操作，例如提升权限、窃取敏感信息或修改系统配置。

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2023-29528_14-9-rc-1](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2023-29528_14-9-rc-1)

**漏洞详情:** [CVE-2023-29528](https://nvd.nist.gov/vuln/detail/CVE-2023-29528)