## CVE-2025-4660-Forescout SecureConnector-RCE

**漏洞编号:** CVE-2025-4660

**漏洞类型:** 远程代码执行

**影响应用:** Forescout SecureConnector

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** <= 11.3.6

**利用条件:** 目标主机运行Windows版SecureConnector，且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-4660是Forescout SecureConnector Windows代理中的一个远程代码执行漏洞。漏洞原因是由于对命名管道的访问控制不当，导致未经身份验证的远程攻击者可以连接到该管道，并重定向代理与恶意服务器通信，进而执行恶意命令。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的PoC代码已经存在，并且netspi博客也确认了该漏洞的存在，说明该漏洞的利用是有效的。

**投毒风险分析：**

提供的PoC代码包含两个Python脚本：`forescout_redirect.py`和`forescout_c2.py`。`forescout_redirect.py`用于将SecureConnector代理重定向到攻击者控制的IP地址。`forescout_c2.py`实现了一个简单的C2服务器，用于与重定向的代理通信并执行命令。通过快速浏览代码，没有发现明显的恶意代码，例如反向shell，特洛伊木马等。该PoC主要功能是验证和利用漏洞本身，而不是进行恶意活动，因此判断投毒风险较低, 大约5%。风险主要在于使用者将C2服务器修改后加入恶意功能。

**漏洞利用方式：**

1.  **攻击者搭建恶意C2服务器 (forescout_c2.py)**
2.  **攻击者使用`forescout_redirect.py`脚本，通过不安全的命名管道，将受害者机器上的SecureConnector代理重定向到攻击者的C2服务器。** 因为命名管道对Everyone组开放并且没有限制远程连接，所以可以从网络上直接访问。
3.  **攻击者利用C2服务器向SecureConnector代理发送恶意命令，从而在受害者机器上执行任意代码。**

总而言之，该漏洞允许未经身份验证的远程攻击者控制受害者的SecureConnector代理，并在受害者机器上执行任意命令，具有很高的风险。

**项目地址:** [NetSPI/CVE-2025-4660](https://github.com/NetSPI/CVE-2025-4660)

**漏洞详情:** [CVE-2025-4660](https://nvd.nist.gov/vuln/detail/CVE-2025-4660)