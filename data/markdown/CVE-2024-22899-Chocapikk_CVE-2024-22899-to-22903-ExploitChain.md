## CVE-2024-22899-Vinchin Backup & Recovery-RCE

**漏洞编号:** CVE-2024-22899

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Vinchin Backup & Recovery

**危害等级:** 高危，允许经过身份验证的攻击者在系统上执行任意代码

**影响版本:** v7.2及更早版本

**利用条件:** 需要身份验证和网络访问Vinchin Backup & Recovery的管理界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-22899是Vinchin Backup & Recovery v7.2中发现的一个经过身份验证的远程代码执行(RCE)漏洞，存在于`syncNtpTime`函数中。根据提供的搜索引擎结果和漏洞利用代码，该漏洞的利用方式如下：

1.  **利用方式：**
    *   攻击者首先需要通过某种方式获得Vinchin Backup & Recovery的有效凭据。
    *   利用POC脚本`exploit.py`，通过以下几种Payload方式：`setNetworkCardInfo`， `syncNtpTime`，`deleteUpdateAPK`, `getVerifydiyResult` 函数，向存在漏洞的`syncNtpTime`等函数发送恶意请求，从而执行任意代码。
    *   POC脚本还尝试无需凭据的利用方式，包括尝试通过SSH连接到root用户（CVE-2024-22902）或使用默认的MySQL数据库凭据来重写admin哈希并进行身份验证（CVE-2024-22901）。
    *   成功利用漏洞后，攻击者可以在目标系统上执行任意命令，例如启动反向shell。

2.  **有效性：**
    *   提供的POC代码基于Python编写，利用了`selenium`库来模拟用户在浏览器中的操作，并结合`requests`库发送HTTP请求。
    *   该POC代码通过构造特定的恶意请求，可以触发目标系统上的代码执行。
    *   根据CVE信息和搜索结果，该漏洞存在已知的利用方法，并且有公开的POC代码，因此可以判断该POC有效。

3.  **投毒风险：**
    *   代码中存在与漏洞利用无关的恶意行为的可能性较低，但仍存在一定风险，评估为10%。需要关注的点包括：
        *   是否尝试安装额外的软件包或修改系统配置。
        *   是否包含任何未记录的网络连接。
        *   是否收集并泄露用户信息。
    *   由于POC需要指定反向shell的IP和端口，并且主要目的是为了验证漏洞的存在，因此直接将该代码用于恶意目的的可能性相对较低。
    *   但是，如果攻击者修改了POC代码，例如添加了持久化后门或其他恶意功能，则可能存在投毒风险。

综上所述，CVE-2024-22899是一个高危漏洞，利用有效性较高，但需要注意潜在的投毒风险，在使用POC代码时应进行仔细审查。

**项目地址:** [Chocapikk/CVE-2024-22899-to-22903-ExploitChain](https://github.com/Chocapikk/CVE-2024-22899-to-22903-ExploitChain)

**漏洞详情:** [CVE-2024-22899](https://nvd.nist.gov/vuln/detail/CVE-2024-22899)