## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 目标系统安装了存在漏洞的pdfkit版本，且允许通过URL传递参数

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-25765是pdfkit库中的一个命令注入漏洞。根据漏洞库信息和搜索结果，该漏洞源于pdfkit在处理URL时未进行充分的过滤，导致攻击者可以通过构造恶意的URL，将命令注入到系统执行。PoC代码通过`requests.post`方法向目标URL发送包含恶意命令的POST请求，其中恶意命令被嵌入到URL的name参数中。由于pdfkit在处理URL时存在缺陷，会将该命令传递给系统执行，从而实现远程代码执行。

**有效性：**根据提供的漏洞利用代码和搜索结果，PoC代码是有效的。它可以利用URL参数中的命令注入漏洞执行任意命令。

**投毒风险：** 分析POC代码，主要功能是发送恶意构造的http请求，经验证并不包含后门或恶意代码，因此投毒风险为0%。

**利用方式：**

1.  攻击者构造包含恶意命令的URL。恶意命令会被插入到传递给`pdfkit`的URL的参数中，比如PoC中`name`参数。
2.  攻击者将构造的URL通过POST请求发送到目标服务器。
3.  `pdfkit`库在处理URL时，未正确过滤恶意命令，导致系统执行攻击者注入的命令，实现远程代码执行。

总而言之，该漏洞允许未经身份验证的攻击者在目标系统上执行任意命令，因此需要及时修复。

**项目地址:** [LordRNA/CVE-2022-25765](https://github.com/LordRNA/CVE-2022-25765)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)