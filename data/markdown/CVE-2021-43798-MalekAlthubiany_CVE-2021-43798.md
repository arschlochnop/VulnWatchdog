## CVE-2021-43798-Grafana目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要网络访问和目标Grafana实例的访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中一个目录遍历漏洞。攻击者可以通过 `/<grafana_host_url>/public/plugins/<plugin_id>/` 路径，利用目录遍历读取服务器上的任意文件。根据漏洞信息，影响版本为 8.0.0-beta1 至 8.3.0，但已修复版本除外 (8.0.7, 8.1.8, 8.2.7, 8.3.1)。

**有效性：**

提供的 POC 代码有效。通过发送包含目录遍历序列（如 `../../../../../../../../../../../etc/passwd`）的请求，可以读取目标服务器上的文件。`curl --path-as-is` 命令确保了路径不会被 curl 规范化，而是直接发送到服务器，从而成功利用漏洞。

**投毒风险：**

POC 代码中没有明显的投毒代码。该代码只是提供了利用漏洞读取文件的 curl 命令示例。仓库中的其他文件（例如 README.md）也只是提供了漏洞信息和利用说明，没有发现任何恶意代码。因此，投毒风险评估为 0%。

**利用方式：**

利用方式是通过构造特殊的 URL，包含目录遍历序列，例如：

`http://<target_ip>:3000/public/plugins/alertlist/../../../../../../../../../../../etc/passwd`

其中 `<target_ip>` 是目标 Grafana 实例的 IP 地址，`alertlist` 是一个已安装插件的 ID。该 URL 尝试读取 `/etc/passwd` 文件。需要注意的是，需要使用 `curl --path-as-is` 命令来发送请求，以确保路径不会被 curl 规范化。

**项目地址:** [MalekAlthubiany/CVE-2021-43798](https://github.com/MalekAlthubiany/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)