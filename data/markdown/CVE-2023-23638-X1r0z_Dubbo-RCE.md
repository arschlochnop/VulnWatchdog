## CVE-2023-23638 - Apache Dubbo Deserialization Vulnerability

**漏洞编号:** CVE-2023-23638

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Dubbo

**危害等级:** 中危，可能导致恶意代码执行

**影响版本:** Apache Dubbo 2.7.x <= 2.7.21, Apache Dubbo 3.0.x <= 3.0.13, Apache Dubbo 3.1.x <= 3.1.5

**利用条件:** 需要Dubbo服务开启generic invoke接口，攻击者可以访问Dubbo服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23638是Apache Dubbo中的一个反序列化漏洞，存在于generic invoke过程中。攻击者可以通过构造恶意的序列化数据，在Dubbo服务端执行任意代码。根据漏洞库信息和搜索结果，该漏洞影响Apache Dubbo 2.7.x <= 2.7.21，Apache Dubbo 3.0.x <= 3.0.13，Apache Dubbo 3.1.x <= 3.1.5版本。

**有效性：**
提供的POC代码显示其是有效的，但需要一些配置，比如ZooKeeper环境以及添加VM参数`-Ddubbo.hessian.allowNonSerializable=true`。该POC利用了修改properties绕过限制的手段，给出的示例是JNDI注入，需要自行修改为反序列化利用方式。

**投毒风险：**
该仓库的`README.md`文件提示了如何配置和利用该漏洞，并给出了分析文章的链接。`pom.xml`文件指定了Dubbo的版本，没有发现明显的恶意代码。但是，由于反序列化漏洞的复杂性，以及需要自行修改POC为反序列化利用方式，存在一定被引导到错误或恶意利用方式的风险，因此判断存在10%的投毒风险，主要来源于用户自行修改POC可能引入恶意代码，而非作者直接投毒。

**利用方式：**
1.  攻击者利用Dubbo的generic invoke功能。
2.  构造恶意的序列化数据，绕过Dubbo的防御机制（例如，通过修改properties）。
3.  利用Hessian反序列化漏洞，执行任意代码，比如JNDI注入或者其他反序列化gadget。

总而言之，漏洞利用的有效性较高，但攻击复杂度为HIGH，因为攻击者需要对Dubbo和Hessian反序列化有深入的理解，并绕过Dubbo的防御机制。投毒风险较低，主要来自于用户自行修改POC引入的风险。

**项目地址:** [X1r0z/Dubbo-RCE](https://github.com/X1r0z/Dubbo-RCE)

**漏洞详情:** [CVE-2023-23638](https://nvd.nist.gov/vuln/detail/CVE-2023-23638)