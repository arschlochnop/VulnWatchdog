## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问OpenSSH服务，glibc-based Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387是一个OpenSSH服务器中的竞争条件漏洞（源于CVE-2006-5051的回归）。未经身份验证的远程攻击者可以通过在设定的时间内未能完成身份验证来触发此漏洞。利用方式是发送大量连接请求，触发竞争条件，在glibc-based Linux系统上可能导致在堆中插入恶意指令，最终实现远程代码执行或拒绝服务。提供的脚本并非POC，而是缓解措施：

1.  **有效性：** 提供的脚本实际上是一个缓解脚本，通过将`LoginGraceTime`设置为0来减少漏洞被利用的可能性，并不能直接验证漏洞，缓解脚本会禁用SSHD服务器在指定超时时间内未完成身份验证时断开连接的能力。虽然降低了RCE的风险，但增加了拒绝服务(DoS)的风险。

2.  **投毒风险：** 提供的脚本目的是缓解漏洞，没有发现任何隐藏的恶意代码，因此投毒风险为0%。

3.  **利用方式：** 根据漏洞信息和搜索结果，利用方式是未认证的攻击者向目标OpenSSH服务器发送大量连接请求，由于竞争条件的存在，sshd可能以不安全的方式处理信号，从而允许攻击者执行任意代码（RCE）或造成拒绝服务(DoS)。攻击成功的关键在于触发竞争条件，因此需要大量的并发连接尝试。


**项目地址:** [redux-sibi-jose/mitigate_ssh](https://github.com/redux-sibi-jose/mitigate_ssh)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)