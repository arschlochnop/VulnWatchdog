## CVE-2024-10924 - Really Simple Security 身份验证绕过

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress插件

**危害等级:** 高危，允许未经身份验证的攻击者以任何现有用户身份登录，包括管理员

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点安装了受影响版本的Really Simple Security插件，并启用了双因素身份验证功能（默认禁用，需要目标站点开启此功能）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924是一个影响Really Simple Security WordPress插件的身份验证绕过漏洞。该漏洞位于双因素身份验证REST API操作的'check_login_and_get_user'函数中，由于不正确的用户检查错误处理，未经身份验证的攻击者可以利用此漏洞绕过身份验证，并以任何现有用户（包括管理员）的身份登录。利用方式如下：

1.  **漏洞触发点：** 受影响的REST API端点，通常与双因素身份验证相关，例如`/wp-json/really-simple-security/v1/two-factor/check_login_and_get_user`。
2.  **利用步骤：**
    *   攻击者首先需要找到目标WordPress站点的用户名，可以通过暴力破解、公开信息泄露等方式获取。
    *   然后，攻击者构造一个恶意的请求，发送到REST API端点，其中包含目标用户名，并利用漏洞绕过双因素身份验证检查。
    *   如果漏洞利用成功，攻击者将获得一个有效的身份验证cookie，从而可以以目标用户身份登录到WordPress管理后台。
3.  **POC分析：**
    *   提供的渗透测试报告显示，该漏洞已成功利用，获得了管理员权限。
    *   报告中提到使用了Python POC，但未提供具体的POC代码。假设POC代码模拟了上述利用步骤，构造了恶意请求并发送到REST API端点。
4.  **投毒风险分析：**
    *   提供的文件中只有渗透测试报告的README.md，不存在可执行的PHP、Python等脚本，直接投毒可能性较低。
    *   截图文件(wappalyzer.png)也无法判断是否含有恶意代码。
    *   报告中的技术细节（如技术栈，时间线等）可能不准确，但整体描述符合漏洞特征。
    *  总体而言，投毒风险较低，大约10%的可能性在于利用描述或工具推荐中存在误导信息，诱导使用者下载恶意工具。
5.  **有效性评估：**
    *   漏洞信息显示该漏洞是真实存在的，并且影响广泛。
    *   提供的渗透测试报告表明该漏洞可以被成功利用。
    *   多个安全厂商（如Wordfence, SonicWall, Kaspersky, Ionix）都发布了关于此漏洞的报告。
    *   综合判断，提供的漏洞利用信息是有效的。

请注意，进行漏洞利用测试必须获得授权，未经授权的渗透测试是非法的。

**项目地址:** [ademto/wordpress-cve-2024-10924-pentest](https://github.com/ademto/wordpress-cve-2024-10924-pentest)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)