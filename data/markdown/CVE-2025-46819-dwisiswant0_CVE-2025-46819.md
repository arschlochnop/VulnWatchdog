## CVE-2025-46819-Redis-DoS

**漏洞编号:** CVE-2025-46819

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Redis

**危害等级:** 中危，可能导致服务中断

**影响版本:** < 8.2.2

**利用条件:** 需要 Redis 实例的低权限访问，Lua脚本功能开启。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-46819 漏洞存在于 Redis 8.2.1 及更早版本中。该漏洞允许经过身份验证的用户通过执行特制的 Lua 脚本来读取越界数据或使服务器崩溃，从而导致拒绝服务。漏洞的根本原因是 Lua 脚本解析器对长字符串分隔符的处理不当，当分隔符格式错误时，会导致缓冲区下溢或过度递归，最终造成 Redis 服务崩溃。

**有效性：**
提供的 POC 代码 `CVE-2025-46819.lua` 旨在利用此漏洞。它通过构造一个巨大的、格式错误的字符串分隔符并将其传递给 `loadstring` 函数来触发漏洞。根据 README.md，预期结果是在易受攻击的版本上导致 "ERR C stack overflow" 或直接崩溃。

**投毒风险：**
查看 POC 代码和 README.md 后，没有发现任何隐藏的恶意代码或后门。该代码的目的明确，即触发 Redis 服务器的崩溃，且与漏洞描述一致。因此，判断投毒风险为 0%。

**利用方式：**
1.  攻击者需要具有 Redis 实例的低权限访问权限。
2.  攻击者需要能够执行 Lua 脚本（默认情况下启用）。
3.  攻击者使用 `redis-cli` 工具或其他 Redis 客户端，加载并执行 `CVE-2025-46819.lua` 脚本。
4.  脚本构造一个包含大量 "=" 字符的、格式错误的 Lua 长字符串分隔符（例如，`[==...==`，但缺少闭合的 `]`）。
5.  当 Redis 解析 Lua 脚本时，会尝试处理此格式错误的分隔符。
6.  由于 Lua 解释器中的缺陷，这会导致 Redis 读取越界内存或发生 C 栈溢出，最终导致服务器崩溃。

**缓解措施：**
*   升级到 Redis 8.2.2 或更高版本。
*   禁用不受信任用户的 Lua 脚本执行。这可以通过使用 ACL 阻止 EVAL 和 FUNCTION 命令系列来实现。

**项目地址:** [dwisiswant0/CVE-2025-46819](https://github.com/dwisiswant0/CVE-2025-46819)

**漏洞详情:** [CVE-2025-46819](https://nvd.nist.gov/vuln/detail/CVE-2025-46819)