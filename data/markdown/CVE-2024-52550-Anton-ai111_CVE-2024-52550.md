## CVE-2024-52550 - Jenkins Pipeline Groovy Plugin 未授权脚本重建

**漏洞编号:** CVE-2024-52550

**漏洞类型:** 权限绕过

**影响应用:** Jenkins Pipeline: Groovy Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3990.vd281dd77a_388 (除了 3975.3977.v478dd9e956c3)

**利用条件:** 需要 Item/Build 权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-52550 允许具有 Item/Build 权限的攻击者重建之前的构建，即使该构建的 Jenkinsfile 脚本不再被批准。攻击者可以通过重建一个包含恶意脚本的旧构建，从而绕过脚本审批机制，最终可能导致远程代码执行。利用方式如下：

1.  攻击者需要具有 Jenkins 的 Item/Build 权限。
2.  攻击者选择一个历史构建，该构建的 Jenkinsfile 脚本不再被批准。
3.  攻击者重建该历史构建，此时 Jenkins 不会检查脚本的批准状态，直接执行。
4.  如果 Jenkinsfile 包含恶意代码，则会在 Jenkins 服务器上执行。

提供的 POC 代码 `exploit.py` 包含两种模式：

*   **模式 1 (n=1):** 启动一个 HTTP 服务器，该服务器包含一个静态文件目录，其中包含一个名为 `secret.txt` 的文件，该文件包含敏感数据 `TOP SECRET DATA`。该模式本身不构成直接的漏洞利用，更像是一个简单的演示或测试环境，用来模拟攻击者利用漏洞后的数据访问。此方法存在风险，因为文件内容固定，可能被用来钓鱼或者投毒，所以投毒概率占10%。
*   **模式 2 (n=2):**  根据用户提供的URL，尝试通过路径穿越漏洞读取 `/etc/passwd` 文件。如果成功读取，则输出 `[+] Potentially vulnerable to CVE-2024-52550`，否则输出 `[-] Looks safe or protected`。该模式直接针对漏洞进行验证。存在误报可能，不代表一定存在漏洞，可能目标做了防护。

根据搜索结果，此漏洞影响 Jenkins Pipeline: Groovy Plugin，允许攻击者绕过脚本批准检查。Red Hat, Wiz, NVD, Tenable 等机构均发布了关于此漏洞的信息。

总体来看，POC 代码的第二种模式较为有效，可以直接验证漏洞是否存在。第一种模式本身并非漏洞利用，但可能被用于构建更复杂的攻击场景。

**项目地址:** [Anton-ai111/CVE-2024-52550](https://github.com/Anton-ai111/CVE-2024-52550)

**漏洞详情:** [CVE-2024-52550](https://nvd.nist.gov/vuln/detail/CVE-2024-52550)