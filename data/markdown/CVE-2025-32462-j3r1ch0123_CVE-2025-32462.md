## CVE-2025-32462-Sudo-主机绕过

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，可导致本地权限提升

**影响版本:** 1.8.8 <= version < 1.9.17p1

**利用条件:** sudoers文件配置中，指定了非当前主机或ALL的主机别名

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32462 漏洞允许已授权用户在配置了特定主机别名（非当前主机且非ALL）的 sudoers 文件中，在错误的机器上执行命令。利用方式是利用 `sudo -h` 选项指定目标主机别名，从而绕过主机限制，以root权限执行命令。提供的PoC代码`exploit.sh` 演示了该漏洞的利用方法：

1.  **设置目标主机：**  用户需要修改 `TARGET_HOST` 变量，设置为 sudoers 文件中配置的，但*不是当前主机*的主机别名。
2.  **伪造root shell：** 通过循环读取用户输入命令，然后通过 `sudo -h "$TARGET_HOST" -- bash -c "$cmd"` 执行。因为存在漏洞，命令会在当前主机以root权限执行，而不是目标主机。
3.  **有效性评估：** PoC代码有效，可以验证该漏洞。
4.  **投毒风险评估：**  `README.md` 文件仅包含漏洞信息，`exploit.sh` 脚本是利用漏洞的 PoC 代码，功能明确，没有发现隐藏的恶意代码，不存在投毒风险。脚本会创建一个伪造的shell，并没有植入后门等恶意操作。

**项目地址:** [j3r1ch0123/CVE-2025-32462](https://github.com/j3r1ch0123/CVE-2025-32462)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)