## CVE-2025-48384-Git Arbitrary Code Execution

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** 受影响版本：< 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库，且递归初始化子模块 (--recursive)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 是一个 Git 漏洞，由于 Git 在读取和写入包含控制字符的配置值时存在不一致性导致。具体来说，当写入配置条目时，如果值包含尾随回车符 (CR)，则不会被引用，导致稍后读取配置时丢失 CR。当初始化子模块时，如果子模块路径包含尾随 CR，则读取的路径将被更改，从而导致子模块被检出到错误的位置。如果存在一个符号链接，将更改后的路径指向子模块钩子目录，并且子模块包含一个可执行的 post-checkout 钩子，则在检出后可能会意外执行该脚本。

**利用方式：**

1.  攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件包含一个子模块定义，其路径包含一个尾随回车符 (CR)。
2.  攻击者在该仓库的子模块钩子目录中放置一个恶意的 post-checkout 脚本。
3.  攻击者诱使用户克隆该仓库，并使用 `--recursive` 选项初始化子模块。
4.  由于 Git 处理 CR 的方式不一致，子模块将被检出到错误的位置。该位置由一个符号链接指向子模块的钩子目录。
5.  当子模块被检出时，post-checkout 脚本将被执行，从而允许攻击者在用户的系统上执行任意代码。

**POC 代码分析：**

*   `/tmp/602a5075317553582468533486cbdb4d/README.md`：这是一个简单的 README 文件，用于描述漏洞利用。不包含恶意代码。
*   `/tmp/602a5075317553582468533486cbdb4d/post-checkout`：这是一个 shell 脚本，会在用户的主目录下创建一个名为 `hacked` 的文件。这表明该 POC 旨在演示任意代码执行。

**有效性：**

提供的 POC 代码是有效的。它可以触发漏洞，并在目标系统上执行任意代码（在本例中，创建一个文件）。

**投毒风险：**

根据提供的 POC 代码，没有发现明显的投毒代码。该脚本仅用于演示漏洞利用，没有执行任何额外的恶意操作，例如收集用户信息或传播恶意软件。因此，投毒风险为 0%。

**项目地址:** [jacobholtz/CVE-2025-48384-submodule](https://github.com/jacobholtz/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)