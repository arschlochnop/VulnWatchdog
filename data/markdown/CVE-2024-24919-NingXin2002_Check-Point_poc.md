## CVE-2024-24919-Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark)

**利用条件:** Check Point 安全网关已连接到互联网，并启用了远程访问 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-24919 是一个 Check Point 安全网关上的信息泄露漏洞，允许未经身份验证的远程攻击者读取设备上的任意文件。根据提供的漏洞信息和搜索结果，此漏洞允许攻击者通过发送特制的 HTTP POST 请求到 `/clients/MyCRL` 路径，利用路径遍历漏洞读取敏感文件，如 `/etc/shadow`。POC 代码通过 POST 请求将 `aCSHELL/../../../../../../../etc/shadow` 作为 `data` 参数发送，如果响应状态码为 200 并且响应内容包含 `root` 字符串，则认为目标存在漏洞。利用方式为路径遍历漏洞，通过构造包含 `../` 的路径来访问系统上的任意文件。

**有效性：**
根据漏洞信息、搜索结果（Rapid7, Arctic Wolf, Truesec 等安全厂商博客）和提供的 POC 代码，可以判断此漏洞真实存在且已被广泛利用。提供的 POC 代码也较为简单，直接利用了路径遍历漏洞读取 `/etc/shadow` 文件，验证了漏洞的有效性。

**投毒风险：**
对提供的 POC 代码进行分析，发现代码逻辑较为简单，主要功能是发送 HTTP POST 请求并检查响应内容。`Check-Point_poc.py` 的主要功能是漏洞验证，没有发现明显的恶意代码或后门。唯一的风险点在于，如果攻击者修改了 POC 代码，例如修改了读取的文件路径或添加了额外的 HTTP 请求，可能会导致信息泄露或触发其他安全问题。`README.md` 文件仅包含 POC 的使用说明，不包含任何恶意代码。因此,投毒风险较低,约为5%。主要来源于用户下载后二次修改的风险。

**利用方式：**
1.  攻击者发送一个特制的 HTTP POST 请求到 Check Point 安全网关的 `/clients/MyCRL` 路径。
2.  POST 请求的数据部分包含一个路径遍历字符串，例如 `aCSHELL/../../../../../../../etc/shadow`，用于尝试访问目标系统上的 `/etc/shadow` 文件。
3.  如果安全网关存在漏洞，它将返回 `/etc/shadow` 文件的内容作为 HTTP 响应。
4.  攻击者可以解析响应内容，提取敏感信息，如用户名和哈希密码。
5.  攻击者可以使用提取的哈希密码进行离线破解，或者使用其他攻击手段进一步入侵目标系统。

**项目地址:** [NingXin2002/Check-Point_poc](https://github.com/NingXin2002/Check-Point_poc)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)