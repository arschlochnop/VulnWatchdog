## CVE-2018-15473 OpenSSH 用户枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名，为后续攻击（如密码破解）提供便利。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行着易受攻击的 OpenSSH 版本，且允许网络连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 是 OpenSSH 中的一个用户枚举漏洞。OpenSSH 7.7 及更早版本存在此漏洞，攻击者可以通过观察服务器对无效和有效用户名认证请求的不同响应时间来枚举有效用户名。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞确实存在并且有公开的PoC。
提供的Python脚本 `SSHEnum.py` 旨在利用此漏洞。脚本通过修改 Paramiko 库的行为，使得服务器在接收到无效用户名时不会立即断开连接，从而可以通过时间差异来判断用户名是否存在。

**投毒风险：**
分析提供的代码，包括 `SSHEnum.py`、`requirements.txt`、`diccionario.txt` 和 `Instrucciones.txt`，没有发现明显的恶意代码或后门。`requirements.txt` 中指定的 `paramiko==2.7.2` 和 `cryptography==2.8` 是已知的库版本，没有发现被篡改的迹象。脚本的主要逻辑集中在修改 Paramiko 库的处理流程以利用时间差进行用户枚举。字典文件 `diccionario.txt` 包含常见的用户名，没有可疑内容。`Instrucciones.txt` 仅仅是安装和使用说明，也没有隐藏的恶意命令。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  攻击者使用 `SSHEnum.py` 脚本，指定目标 IP 地址和用户名列表（或单个用户名）。
2.  脚本尝试使用 Paramiko 库与目标 SSH 服务器建立连接。
3.  脚本修改 Paramiko 的内部函数，使得服务器在接收到无效用户名时不立即断开连接。
4.  脚本对用户名列表中的每个用户名进行认证尝试。
5.  根据服务器的响应时间或其他差异（例如，USERAUTH_FAILURE消息的延迟），脚本判断用户名是否存在。
6.  脚本输出枚举到的有效用户名列表。

**注意事项：**
*   利用此漏洞进行用户枚举可能违反法律法规，请在授权环境下进行测试。
*   修复此漏洞的方法是升级到 OpenSSH 的更高版本（高于 7.7），或应用相关补丁。

**项目地址:** [OmarV4066/SSHEnumKL](https://github.com/OmarV4066/SSHEnumKL)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)