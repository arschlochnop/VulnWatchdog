## CVE-2020-10199-Sonatype Nexus Repository-JavaEL注入

**漏洞编号:** CVE-2020-10199

**漏洞类型:** JavaEL注入

**影响应用:** Sonatype Nexus Repository

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.21.1

**利用条件:** 需要目标Nexus Repository实例的URL，有效的用户名和密码。根据漏洞利用代码，低权限用户即可利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-10199是Sonatype Nexus Repository <= 3.21.1版本中存在的一个JavaEL注入漏洞。攻击者可以通过在特定的API端点（/service/rest/beta/repositories/go/group）的请求体中，构造恶意的JavaEL表达式，实现远程代码执行。根据漏洞利用代码，攻击者首先需要通过用户名和密码获取有效的Session ID，然后利用该Session ID构造包含恶意JavaEL表达式的请求，发送到目标API端点。该漏洞的利用方式是经过身份验证的，但根据参考链接中的描述，任意账户类型都可能利用此漏洞。漏洞利用代码中的cmd变量默认为'whoami'，可以修改为其他命令。 

**有效性:**
从漏洞库信息、搜索引擎结果和提供的漏洞利用代码来看，该漏洞的POC是存在的，并且可以利用。

**投毒风险:**
漏洞利用代码中存在一定的投毒风险。虽然漏洞利用代码的主要目的是执行命令，但代码中使用了`$$BCEL$$`来加载恶意类，意味着攻击者可能通过构造恶意的字节码，执行任意代码。 漏洞利用代码在memberNames构造的地方存在混淆字符,并且请求的URI`/service/rest/beta/repositories/go/group` 以及构造的json 数据 `"name": "internal"`  `"blobStoreName": "default"`也可能是后门代码，可能存在植入后门或者其他恶意行为。因此，存在一定的投毒风险，风险评估为10%。

**利用方式:**
1.  获取目标Nexus Repository实例的URL。通常为`http://<host>:<port>/nexus`。
2.  获取目标Nexus Repository实例的用户名和密码。
3.  运行漏洞利用代码，将URL、用户名和密码作为参数传递给脚本。
4.  漏洞利用代码会首先尝试获取Session ID，然后构造包含恶意JavaEL表达式的请求，发送到目标API端点，执行命令。
5.  命令执行的结果会显示在输出中。

**项目地址:** [zhzyker/CVE-2020-10199_POC-EXP](https://github.com/zhzyker/CVE-2020-10199_POC-EXP)

**漏洞详情:** [CVE-2020-10199](https://nvd.nist.gov/vuln/detail/CVE-2020-10199)