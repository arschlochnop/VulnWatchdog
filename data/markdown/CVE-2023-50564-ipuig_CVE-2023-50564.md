## CVE-2023-50564-Pluck-CMS-任意文件上传

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck CMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.7.18

**利用条件:** 需要登录Pluck CMS后台权限（低权限用户即可）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50564是Pluck CMS 4.7.18版本中的一个任意文件上传漏洞。攻击者可以通过上传特制的ZIP文件，在服务器上执行任意代码。

**利用方式：**

1.  攻击者首先需要登录Pluck CMS后台。根据漏洞信息，低权限用户即可。
2.  攻击者利用`/inc/modules_install.php` 组件，上传包含恶意代码（例如webshell）的ZIP文件。
3.  服务器解压ZIP文件，恶意代码被写入服务器。
4.  攻击者通过访问恶意代码的URL来执行代码，例如获得webshell，从而控制服务器。

**POC分析：**

POC代码 `exploit.go` 自动化了整个攻击过程：

1.  首先，它接收目标 Pluck CMS 的URL、管理员密码、攻击者监听IP地址和端口作为参数。
2.  使用提供的密码登录Pluck CMS。
3.  然后，它生成一个包含反向shell命令的PHP文件 `exploit.php`，并将IP和端口替换为攻击者提供的参数。
4.  将该PHP文件压缩为 `exploit.zip`。
5.  最后，它通过multipart/form-data将 `exploit.zip` 上传到 `/admin.php?action=installmodule`，模拟模块安装过程。
6.  如果上传成功，攻击者将在其监听端口上收到反向shell。

**投毒风险分析：**

代码中存在轻微的投毒风险，主要体现在以下几个方面：

*   **硬编码的代理:**  代码中存在 `proxyUrl, _ := url.Parse("http://localhost:8080")` 和 `transport := &http.Transport{ Proxy: http.ProxyURL(proxyUrl) }`。如果攻击者在不知情的情况下直接运行该代码，可能会通过代理泄露自己的请求信息。但这是一个很常见的调试手段,无法直接证明存在投毒行为.
*   **恶意代码生成:** 虽然PHP反向shell代码是由攻击者控制IP地址和端口生成，并压缩后上传，但如果攻击者在不知情的情况下使用该POC,可能导致其目标主机被其他恶意攻击者控制.

综合来看，投毒的可能性较小,大约10%。主要风险在于攻击者可能不理解代码，直接使用，导致攻击被拦截或者反被利用。核心攻击流程符合漏洞描述，主要功能是简化利用过程。

**项目地址:** [ipuig/CVE-2023-50564](https://github.com/ipuig/CVE-2023-50564)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)