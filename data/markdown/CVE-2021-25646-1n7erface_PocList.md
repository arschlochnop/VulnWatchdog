## CVE-2021-25646-Apache Druid-RCE

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要身份验证（但可绕过配置），目标Druid版本<=0.20.0，且JavaScript执行功能未完全禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-25646允许经过身份验证的用户通过构造特制的请求来执行任意JavaScript代码，从而实现远程代码执行。即使服务器配置禁用了JavaScript功能，此漏洞仍然有效。利用方式主要通过发送包含恶意JavaScript代码的HTTP请求，利用Druid的配置覆盖机制来实现。从提供的代码片段来看，POC是存在的，作者声明项目中存在多个漏洞的POC。由于项目作者声明中存在对安全法的担忧，并且项目后期存在架构上的问题，无法保证提供的所有POC的有效性。因此，无法排除POC中存在隐藏的后门或者恶意代码的可能。但是其主动停止更新，说明存在主动规避风险的意愿，且主要目标是简化漏洞利用流程而非进行恶意活动。投毒风险较低，估计为10%。此漏洞的修复方案是升级到Druid 0.20.1或更高版本，并限制对集群机器的网络访问。

**项目地址:** [1n7erface/PocList](https://github.com/1n7erface/PocList)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)