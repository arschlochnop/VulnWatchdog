## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用OpenSSH，且用户名或主机名包含shell元字符并被某些扩展令牌引用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 漏洞存在于OpenSSH 9.6版本之前，允许攻击者通过在用户名或主机名中注入shell元字符，并在特定情况下被扩展令牌引用时，执行任意操作系统命令。例如，恶意Git仓库的子模块可以在用户名或主机名中包含shell元字符。提供的POC代码 `poc-cve-2023-51385`  仅包含一个 `README.md` 文件，内容简单，仅为标题，说明poc是存在的，但是这个简单的poc没有展示任何攻击代码，这意味着需要其他方式来利用此漏洞。该漏洞的利用方式主要通过以下步骤：1.  攻击者构造包含恶意shell元字符的用户名或主机名。2.  攻击者诱使用户连接到包含恶意用户名或主机名的系统。3.  OpenSSH处理连接时，如果相关配置（例如 `ProxyCommand`）使用了扩展令牌引用该用户名或主机名，则会执行注入的shell命令。根据搜索结果，此漏洞已经公开，并且多个厂商发布了安全公告。虽然提供的POC很简单，但该漏洞的严重性不容忽视。投毒风险评估：由于 POC 代码非常简单，只包含一个 README 文件，因此直接投毒的可能性较低。但是，后续利用该漏洞的Payload可能存在投毒风险，例如，利用该漏洞在目标机器上安装恶意软件或后门。考虑到POC代码的简洁性，以及漏洞本身的性质，估计该仓库存在作者隐藏的投毒代码的可能性较低，约为10%。

**项目地址:** [watarium/poc-cve-2023-51385](https://github.com/watarium/poc-cve-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)