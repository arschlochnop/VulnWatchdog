## CVE-2025-5640-PX4-Autopilot-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-5640

**漏洞类型:** 栈溢出

**影响应用:** PX4-Autopilot

**危害等级:** 中危，可导致拒绝服务

**影响版本:** <= 1.12.3

**利用条件:** 需要本地网络访问或能够发送 MAVLink 消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5640 是 PX4-Autopilot 1.12.3 中的一个栈溢出漏洞，位于 `mavlink_receiver.cpp` 的 `MavlinkReceiver::handle_message_trajectory_representation_waypoints` 函数中。攻击者可以通过发送特制的 `TRAJECTORY_REPRESENTATION_WAYPOINTS` MAVLink 消息来触发此漏洞，导致程序崩溃，从而实现拒绝服务攻击。

**有效性：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞是存在的，并且存在公开的利用代码。提供的 Python 脚本 `CVE-2025-5640.py` 旨在利用此漏洞，通过 UDP 发送包含恶意负载的 MAVLink 消息，导致 PX4 自动驾驶仪崩溃。

**投毒风险：**

尽管提供的漏洞利用代码的主要功能是利用栈溢出漏洞实现拒绝服务，但仍存在一定的投毒风险。 代码逻辑比较简单，主要功能是发送一个包含特定 hex 数据的 payload。但是，任何代码都存在被篡改的可能，例如：

1.  **Payload 修改：** 攻击者可能会修改 `hex_payload`，使其不仅仅导致崩溃，而是执行一些恶意代码，例如修改飞行参数，从而导致更严重的后果。
2.  **后门植入：** 虽然当前代码没有明显的后门，但攻击者可能会添加额外的代码来在目标系统上植入后门，以便后续控制。
3. **依赖库替换:**将 pymavlink 替换为恶意库,从而控制整个流程。

风险评估:
虽然从代码来看，直接投毒的概率较低，但不能完全排除，建议使用者在运行前仔细检查代码，特别是 payload 的内容和依赖库，以确保安全。

综合来看，投毒风险约为 10%。

**利用方式：**

1.  **连接到 PX4：** 脚本首先尝试通过 UDP 连接到目标 PX4 自动驾驶仪，默认 IP 地址为 127.0.0.1，端口为 14540。可以使用 `--ip` 和 `--port` 参数指定不同的目标。
2.  **发送恶意数据包：** 连接成功后，脚本会将预定义的十六进制负载 (`hex_payload`) 转换为二进制数据，并通过 MAVLink 协议发送到 PX4 自动驾驶仪。该负载旨在溢出 `MavlinkReceiver::handle_message_trajectory_representation_waypoints` 函数的栈缓冲区。
3.  **触发崩溃：** 如果漏洞利用成功，PX4 自动驾驶仪将因栈溢出而崩溃，从而导致拒绝服务。

脚本还提供了一个 `check` 模式，用于测试与 PX4 自动驾驶仪的连接，而不会发送恶意数据包。这可以用来验证目标是否可达。

**项目地址:** [mbanyamer/PX4-Military-UAV-Autopilot-1.12.3-Stack-Buffer-Overflow-Exploit-CVE-2025-5640-](https://github.com/mbanyamer/PX4-Military-UAV-Autopilot-1.12.3-Stack-Buffer-Overflow-Exploit-CVE-2025-5640-)

**漏洞详情:** [CVE-2025-5640](https://nvd.nist.gov/vuln/detail/CVE-2025-5640)