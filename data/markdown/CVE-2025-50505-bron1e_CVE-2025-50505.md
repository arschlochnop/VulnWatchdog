## CVE-2025-50505 - Clash Verge Rev 未授权API导致任意命令执行和权限提升

**漏洞编号:** CVE-2025-50505

**漏洞类型:** 命令注入

**影响应用:** Clash Verge Rev

**危害等级:** 高危，可导致本地提权和远程代码执行

**影响版本:** <= v2.2.3

**利用条件:** 本地提权：无条件。远程代码执行：开启局域网连接或配合DNS重绑定攻击。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-50505 漏洞存在于 Clash Verge Rev <= v2.2.3 版本中。该漏洞源于 `clash-verge-service` 组件暴露的未授权HTTP API端点。由于该组件默认以高权限运行，攻击者可以通过构造恶意的请求，利用`/start_clash`接口执行任意命令，从而实现本地权限提升（LPE）或远程代码执行（RCE）。

**利用方式：**

1.  **本地权限提升（LPE）：**
    *   攻击者在本地创建一个恶意脚本（例如，Linux下的`pwn`脚本或Windows下的`pwn.bat`批处理文件）。
    *   攻击者向`http://127.0.0.1:33211/start_clash`发送一个POST请求，并在JSON payload中将`bin_path`参数设置为恶意脚本的路径。
    *   `clash-verge-service`会以高权限执行该恶意脚本，从而实现权限提升。

2.  **远程代码执行（RCE）：**
    *   **局域网（LAN）：** 如果受害者开启了局域网连接，攻击者可以通过局域网直接访问受害者的`clash-verge-service`服务，并利用上述方法执行任意命令。
    *   **公网：** 攻击者可以利用DNS重绑定攻击，绕过浏览器的同源策略，诱导受害者访问恶意网站。该网站会向受害者本地的`clash-verge-service`服务发送恶意请求，从而实现远程代码执行。

**投毒风险分析：**

该漏洞利用代码主要包含一个README.md文件和一些示例图片和脚本。虽然利用方式明确，但是仍然存在一定的投毒风险。

1.  **README.md内容审查：**  虽然README.md文件本身看起来是漏洞的详细描述和利用方式，但攻击者可能在其中插入细微的恶意指令，例如在代码片段中插入混淆代码，或者在链接中指向恶意网站。
2.  **示例脚本：**  `pwn` 脚本和 `pwn.bat` 批处理文件看似简单，只是执行 `id` 命令或 `whoami` 命令。攻击者有可能在这些脚本中插入后门代码，例如反弹 shell 或下载执行恶意程序。
3.  **依赖项：**  该漏洞利用可能依赖于特定的软件或库。攻击者可能会提供修改过的、包含后门的依赖项。

**结论：**

虽然提供的漏洞利用代码看起来有效，但仍然存在一定的投毒风险。使用者应该仔细审查代码的每一个细节，确保没有隐藏的恶意指令。特别是需要关注脚本中的命令和链接，以及任何依赖项的来源。

**风险评估：**

综合考虑，该漏洞利用代码的投毒风险约为10%。主要是由于利用方式比较直接，且代码量较小，方便审查。但仍然需要保持警惕，仔细检查代码的每一个细节。

**项目地址:** [bron1e/CVE-2025-50505](https://github.com/bron1e/CVE-2025-50505)

**漏洞详情:** [CVE-2025-50505](https://nvd.nist.gov/vuln/detail/CVE-2025-50505)