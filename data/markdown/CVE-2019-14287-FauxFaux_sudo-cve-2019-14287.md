## CVE-2019-14287-sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限绕过

**影响应用:** sudo

**危害等级:** 高危，可提升至root权限

**影响版本:** < 1.8.28

**利用条件:** 攻击者需要拥有Runas ALL权限的sudoer账号

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287 漏洞允许拥有Runas ALL权限的sudoer账号的攻击者通过指定一个特殊的user ID来绕过某些策略黑名单和会话PAM模块。例如，通过执行 `sudo -u \#$((0xffffffff))` 命令可以绕过 `!root` 配置，并导致错误的日志记录。漏洞利用方式是利用sudo在处理用户ID时的缺陷，将`-1`或`0xffffffff`转换为无符号整数，从而绕过对目标用户（例如root）的限制。

**有效性：** 基于漏洞信息和搜索引擎结果（特别是exploit-db.com的结果），可以确认该漏洞的POC代码是有效的，因为存在公开可用的利用程序。

**投毒风险：** 提供的代码片段 `ABOUT-NLS` 与漏洞利用本身没有直接关系，它是GNU gettext的一个文件，用于软件国际化和本地化。这个文件主要涉及翻译相关的配置，不包含任何可疑的恶意代码。因此，评估投毒风险为0%。

**利用方式：**
1.  攻击者需要拥有sudoers中具有 `Runas ALL` 权限的账号。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或 `sudo -u #-1` 命令尝试以root权限执行命令。
3.  Sudo在处理`-u`参数时，由于整数转换问题，错误地绕过了对root用户的限制。
4.  攻击者成功以root权限执行任意命令。

**项目地址:** [FauxFaux/sudo-cve-2019-14287](https://github.com/FauxFaux/sudo-cve-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)