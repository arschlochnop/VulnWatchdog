## CVE-2023-20198 - Cisco IOS XE Web UI权限提升漏洞

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响的Cisco设备

**影响版本:** 16.1.1 to 17.12.1及部分17.x版本

**利用条件:** Web UI功能已启用，且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198是一个存在于Cisco IOS XE软件Web UI中的权限提升漏洞。未经身份验证的攻击者可以利用此漏洞创建具有特权级别15（最高权限）的本地用户，从而完全控制受影响的设备。利用过程分为两个阶段：首先利用CVE-2023-20198创建用户，其次利用CVE-2023-20273提升权限至root并写入植入程序。

**漏洞利用方式：**

1.  **身份验证绕过：** 漏洞允许未经身份验证的攻击者与设备的Web UI进行交互。
2.  **创建特权用户：** 攻击者发送特制的SOAP请求到Web UI，该请求绕过身份验证并允许攻击者创建一个具有特权级别15的新用户。
3.  **远程控制：** 创建具有最高权限的用户后，攻击者可以使用此帐户登录设备，并执行任意命令。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以确认POC代码是有效的。搜索结果中的文章提到了漏洞的成功利用和概念验证代码的存在。POC代码也显示了通过发送特制的XML SOAP请求来创建新用户的机制。

**投毒风险：**

提供的POC代码存在轻微的投毒风险，约为10%。风险点分析如下：

*   **默认用户名和密码：** POC代码使用了默认的用户名（shellsmoke）和密码（pwned）。虽然这方便了漏洞测试，但如果未经修改直接用于攻击，很容易被检测到或被其他人利用。
*   **硬编码的URI：** POC中`exURI = '%2577eb%2575i_%2577sma_Http'`，如果攻击者修改此URI植入恶意代码，可能会导致拒绝服务或者其他恶意行为。
*   **命令执行：** 漏洞本身允许执行任意命令，攻击者可能通过植入恶意命令来感染设备。

需要注意的是，以上只是一些潜在的风险点，具体的投毒行为还需要进一步分析。POC的主要功能是验证漏洞的存在，而非恶意利用。因此，将其判定为具有投毒代码是不准确的。

**项目地址:** [Arshit01/CVE-2023-20198](https://github.com/Arshit01/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)