## CVE-2025-56803-Figma-命令注入

**漏洞编号:** CVE-2025-56803

**漏洞类型:** 命令注入

**影响应用:** Figma Desktop Application

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 125.6.5

**利用条件:** 需要用户安装并运行恶意Figma插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-56803 是 Figma Desktop Application 插件执行过程中的一个命令注入漏洞。恶意插件可以通过 `manifest.json` 文件中的 `build` 字段注入任意操作系统命令。Figma 没有对该字段进行充分的验证或转义，直接将其传递给 `child_process.exec()` 执行。当用户安装并运行包含恶意 `manifest.json` 文件的插件时，`build` 字段中的命令会被执行，从而导致任意代码执行。

**有效性评估：** 提供的PoC 代码有效。`manifest.json` 中的 `build` 字段设置为 `calc.exe`，当插件加载时，会启动计算器，证明了漏洞的存在。

**投毒风险评估：** 在分析提供的文件内容后，没有发现任何明显的投毒代码。PoC 主要演示了命令注入漏洞，目的是通过执行 `calc.exe` 证明漏洞存在。`code.js` 和 `code.ts` 文件的内容是标准的 Figma 插件模板，没有任何恶意行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **创建恶意插件：** 攻击者需要创建一个包含恶意 `manifest.json` 文件的 Figma 插件。`manifest.json` 文件中的 `build` 字段包含要执行的恶意命令。例如，可以执行反弹 shell、下载恶意文件等。
2.  **诱导用户安装插件：** 攻击者需要诱导用户安装该恶意插件，可以通过社交工程等方式进行。
3.  **执行命令：** 一旦用户安装并运行该插件，`manifest.json` 文件中的 `build` 字段中的命令会被执行，攻击者从而获得系统控制权。

**缓解措施：**

*   对 `manifest.json` 文件中的 `build` 字段进行严格的输入验证，防止命令注入。
*   避免使用 `child_process.exec()`，使用更安全的替代方案来处理子进程。
*   加强用户安全意识，避免安装来源不明的插件。

**项目地址:** [shinyColumn/CVE-2025-56803](https://github.com/shinyColumn/CVE-2025-56803)

**漏洞详情:** [CVE-2025-56803](https://nvd.nist.gov/vuln/detail/CVE-2025-56803)