## CVE-2019-2215 Android Binder Use-After-Free 本地提权漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel (binder.c)

**危害等级:** 高危，可从应用提权至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或者利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android 系统 binder.c 中的一个 use-after-free 漏洞，允许攻击者从应用程序提升权限到 Linux 内核。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞是真实存在的，并且已经被公开利用。搜索引擎结果中，许多文章都提到了该漏洞，并且存在公开的 PoC 代码。PoC代码本身已经提供了编译和使用的说明。

**投毒风险评估：**
PoC代码本身是用于演示漏洞利用的，但仍然存在潜在的投毒风险，虽然代码的功能是提权，但是代码编写者可能在其中添加恶意代码，例如：
*   **数据窃取：** 在提权后，额外添加代码来窃取设备上的敏感数据。
*   **后门植入：** 在提权后，植入持久性的后门，方便后续控制。
*   **远程控制：** 允许远程攻击者控制设备。

由于代码较长，并且没有经过详细的代码审计，无法100% 排除投毒的可能性。根据分析，初步判断投毒风险为 10%。这个风险评估主要是考虑了代码作者的意图，以及在真实利用场景中可能被恶意修改的可能性。

**利用方式：**
1.  **漏洞触发：** 通过特定的 Binder 调用序列，触发 binder.c 中的 use-after-free 漏洞。
2.  **内存布局：** 精心构造内存布局，以便在释放后再次使用已释放的内存。
3.  **权限提升：** 利用 use-after-free 漏洞修改当前进程的 `cred` 结构体，将 `uid`、`gid`、`suid`、`sgid`、`euid`、`egid`、`fsuid` 和 `fsgid` 设置为 0，从而获得 root 权限。

PoC代码 `poc-bravia.c` 的基本流程如下：

*   **获取目标进程的 `task_struct` 地址:** PoC通过遍历进程列表或其他方式来找到需要提权的进程。
*   **查找 `cred` 结构体:** 从 `task_struct` 中找到 `cred` 结构体的地址。
*   **修改 `cred` 结构体:**  将 `cred` 结构体中的用户ID和组ID修改为0，从而获得root权限。

**总结：**
CVE-2019-2215 是一个高危漏洞，允许本地应用提权至内核。尽管 PoC 代码可以用来验证漏洞的存在，但也存在一定的投毒风险。在实际使用 PoC 代码时，需要谨慎评估风险，并进行充分的代码审计。

该漏洞需要一个恶意应用或者通过另一个漏洞才能触发，本身没有交互要求。

**项目地址:** [LIznzn/CVE-2019-2215](https://github.com/LIznzn/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)