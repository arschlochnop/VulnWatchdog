## CVE-2025-32433 – Erlang/OTP SSH RCE Vulnerability

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** OTP-25.3.2.20 之前, OTP-26.0-rc1 到 OTP-26.2.5.11, OTP-27.0-rc1 到 OTP-27.3.3

**利用条件:** 目标系统运行受影响版本的Erlang/OTP SSH服务，且攻击者能够网络访问该SSH服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32433 是 Erlang/OTP SSH 服务中的一个远程代码执行漏洞。攻击者可以在未经身份验证的情况下，通过构造恶意的SSH协议消息来执行任意代码。该漏洞的利用方式是利用了SSH协议消息处理中的缺陷，在身份验证之前发送特制的`SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 数据包，其中包含要执行的Erlang命令。

**有效性：**
根据漏洞描述和利用代码，该PoC代码有效。漏洞库信息、搜索结果和利用代码均表明这是一个严重的远程代码执行漏洞，并且已经有可用的PoC。

**投毒风险：**
PoC 代码主要由以下几个部分组成：
1.  **连接目标 SSH 服务：** 代码首先建立与目标 SSH 服务的连接。
2.  **构建和发送恶意 SSH 数据包：**  代码构建包含恶意 Erlang 命令的 SSH 数据包，这些数据包绕过了身份验证。
3.  **执行命令：** 如果目标系统存在漏洞，则会执行恶意 Erlang 命令。

PoC 代码本身比较直接，主要用于演示漏洞原理。投毒风险主要在于：
*   **Payload 的修改：** 攻击者可能会修改 `build_channel_request` 函数中的 `command` 变量，从而执行任意恶意命令。 提供的代码默认只是创建文件`/lab.txt`，风险较低。
*   **依赖项风险：**  该PoC脚本依赖python环境，且直接使用socket库，依赖风险较低

综合来看，该代码存在一定的投毒风险，但主要是通过修改 payload 实现。作者在代码中隐藏恶意代码的可能性较低，因此投毒风险估计为 5%。

**利用方式：**
1.  **建立连接：** 攻击者首先与目标 Erlang/OTP SSH 服务建立 TCP 连接。
2.  **发送 KEXINIT：** 发送一个伪造的`SSH_MSG_KEXINIT`数据包来模拟正常的密钥交换过程。
3.  **发送恶意 Channel Request：** 关键步骤是发送包含恶意 Erlang 命令的 `SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 数据包。这些数据包在身份验证之前发送。
4.  **远程代码执行：** 如果目标系统存在漏洞，SSH 服务将执行数据包中包含的 Erlang 命令，从而导致远程代码执行。

**总结：**
CVE-2025-32433 是一个高危漏洞，利用难度较低，影响范围广。建议受影响的用户尽快升级到安全版本或采取缓解措施，例如禁用 SSH 服务或使用防火墙限制访问。

**项目地址:** [Mdusmandasthaheer/CVE-2025-32433](https://github.com/Mdusmandasthaheer/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)