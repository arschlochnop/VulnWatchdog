## CVE-2024-31317-Android Zygote Deserialization

**漏洞编号:** CVE-2024-31317

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可导致任意代码执行和权限提升

**影响版本:** Android 12, 12L, 13, 14

**利用条件:** 需要用户执行权限(User execution privileges needed)，无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31317 漏洞存在于Android系统的Zygote进程中，由于不安全的反序列化导致可以通过`WRITE_SECURE_SETTINGS`权限实现代码执行。该漏洞影响Android 12、12L、13和14。攻击者可以利用此漏洞提升权限，在受影响的设备上以任何应用程序的身份执行代码。

**漏洞利用方式：**

1.  **不安全的反序列化：**  `ZygoteProcess.java`中的多个函数存在不安全的反序列化漏洞，攻击者可以通过构造恶意序列化数据，在反序列化过程中执行任意代码。
2.  **权限提升：** 攻击者需要`WRITE_SECURE_SETTINGS`权限，这个权限通常需要通过其他漏洞或者通过欺骗用户授予。如果攻击者拥有了这个权限,他们就可以通过Zygote进程执行代码，模拟任何app的身份。
3.  **代码执行：**  通过利用反序列化漏洞，攻击者可以在目标设备上执行任意代码。

**POC有效性分析：**

提供的`Android_Zygote_Research_Kit.sh`脚本包含以下组件：

*   `reverse_shell.c`：一个反向shell程序，用于在目标设备上建立与攻击者的连接。
*   `payload91011.txt` 和 `payload1213.txt`：针对不同Android版本的漏洞利用payload。
*   `compile.sh`：用于编译反向shell程序的脚本。
*   `README.txt` 和 `CVE-2024-31317.txt`：提供漏洞利用的说明和技术分析。

该脚本通过生成恶意payload并结合反向shell程序，实现了对CVE-2024-31317漏洞的利用。因此，提供的POC代码被认为是有效的，可以用来验证和利用该漏洞。

**投毒风险分析：**

虽然脚本主要目的是为了漏洞研究和利用，但仍然存在一定的投毒风险：

*   **反向Shell的潜在风险：** `reverse_shell.c`本身可以被视为一种后门。一旦成功利用漏洞，攻击者可以获得设备的控制权，执行恶意操作。
*   **其他恶意代码植入风险：** 脚本中可能包含其他未声明的恶意代码，例如信息收集、恶意软件传播等。

综合来看，投毒风险存在，但主要风险集中在反向shell的功能上，以及脚本作者可能植入的潜在恶意代码。考虑到作者声明的MIT开源协议以及代码中明显的功能实现，投毒的可能性较低，大约为10%。

**项目地址:** [JadeByteZen/CVE-2024-31317-PoC-Deployer](https://github.com/JadeByteZen/CVE-2024-31317-PoC-Deployer)

**漏洞详情:** [CVE-2024-31317](https://nvd.nist.gov/vuln/detail/CVE-2024-31317)