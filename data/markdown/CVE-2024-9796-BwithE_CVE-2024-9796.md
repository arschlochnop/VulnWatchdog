## CVE-2024-9796-WP-Advanced-Search-SQL注入

**漏洞编号:** CVE-2024-9796

**漏洞类型:** SQL注入

**影响应用:** WP-Advanced-Search

**危害等级:** 高危，可能导致数据泄露

**影响版本:** < 3.3.9.2

**利用条件:** 目标WordPress站点安装了WP-Advanced-Search插件，且版本低于3.3.9.2，无需身份验证即可访问包含漏洞的URL。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于WP-Advanced-Search插件的autocompletion-PHP5.5.php文件中，攻击者可以通过构造恶意的SQL语句，注入到`t`参数中，从而获取数据库中的敏感信息，例如WordPress用户的用户名和密码哈希。由于`t`参数未经过充分的过滤和转义，导致了SQL注入漏洞。PoC代码通过发送带有恶意`t`参数的GET请求到易受攻击的URL，并从响应中提取用户名和哈希值。

**有效性：** 提供的POC代码有效。它构造了一个包含SQL注入的HTTP GET请求，能够从易受攻击的WP-Advanced-Search插件中提取用户凭据。

**投毒风险：** 在提供的PoC代码和README文件中，没有发现任何明显的投毒代码。该脚本的功能是利用SQL注入漏洞提取用户名和密码哈希。代码比较简单，没有执行恶意操作的部分。免责声明也强调了脚本仅用于教育目的，并且不应被用于非法活动。

**利用方式：**

1.  确定目标WordPress站点是否安装了WP-Advanced-Search插件，并且版本低于3.3.9.2。
2.  使用PoC脚本，替换`-i`参数为目标IP地址。
3.  脚本将发送包含恶意SQL注入的GET请求到以下URL：
    `http://<目标IP>/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php?q=admin&t=wp_users UNION SELECT user_pass FROM wp_users--&f=user_login&type=&e=`
4.  如果目标站点存在漏洞，脚本将从响应中提取用户名和密码哈希，并将其打印到控制台。

**项目地址:** [BwithE/CVE-2024-9796](https://github.com/BwithE/CVE-2024-9796)

**漏洞详情:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)