## CVE-2018-25031-Swagger UI-欺骗攻击

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意代码执行

**影响版本:** <= 4.1.2

**利用条件:** 需要目标系统使用存在漏洞的Swagger UI版本，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2018-25031 是一个存在于 Swagger UI 4.1.2 及更早版本中的漏洞。攻击者可以诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，造成欺骗攻击。

**有效性：**
提供的 POC 代码有效。通过 `configUrl` 或 `url` 参数，Swagger UI 可以加载远程的 OpenAPI 定义文件（JSON 或 YAML）。

**投毒风险：**
该仓库存在一定的投毒风险，风险为60%。原因如下：

*   **远程加载：** POC 利用了 Swagger UI 加载远程定义文件的功能。攻击者可以控制远程文件的内容。
*   **恶意内容：** `f.yaml` 包含大量的 XSS payload，旨在利用 Swagger UI 中的漏洞执行恶意 JavaScript 代码。例如，`<img src=x oNlY=1 oNerror=alert('xxs')//`  等。
*   **钓鱼攻击：**  `f.yaml` 中包含伪造的登录表单，诱导用户提交敏感信息到攻击者控制的服务器。
*   **SSRF风险：** `f.yaml`中包含`<iframe src=file:///etc/passwd></iframe>`，尝试读取服务器本地文件。
*   **不确定性:** 虽然漏洞利用代码的作者提供了一些payload，但这些payload本身具有攻击性。恶意使用这些Payload,可能会被作者追踪到恶意行为。但作者也可能为了混淆视听，将一些恶意的代码进行隐藏。

**利用方式：**

1.  **发现目标：** 寻找使用了存在漏洞的 Swagger UI 版本的应用。
2.  **构造恶意 URL：**  构造包含 `configUrl` 或 `url` 参数的 URL，指向攻击者控制的 JSON 或 YAML 文件。
3.  **诱骗受害者：**  通过钓鱼或其他方式诱骗受害者点击该 URL。
4.  **执行攻击：**  当受害者访问该 URL 时，Swagger UI 会加载攻击者提供的恶意定义文件，从而执行 XSS 代码或进行其他攻击（例如，窃取 cookie、重定向用户等）。

**总结：**
该漏洞的利用依赖于社会工程学，需要诱骗用户点击恶意链接。攻击者可以利用该漏洞进行钓鱼、XSS 攻击，甚至可能进行 SSRF 攻击。同时，提供的 POC 代码包含多种攻击 Payload，存在较高的投毒风险。

**项目地址:** [mathis2001/CVE-2018-25031](https://github.com/mathis2001/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)