## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216及其他相关品牌DVR设备

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响的TBK DVR4104和DVR4216设备，以及Novo、CeNova、QSee、Pulnix、XVR 5 in 1、Securus、Night OWL、DVR Login、HVR Login和MDVR Login等重新贴牌版本。

**利用条件:** 目标DVR设备需要暴露在网络上

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995漏洞存在于TBK DVR4104和DVR4216系列DVR设备及其重新贴牌版本中。攻击者可以通过在HTTP请求中设置`Cookie: uid=admin`头来绕过身份验证。POC代码通过发送带有特定Cookie的HTTP GET请求到`/device.rsp?opt=user&cmd=list`来利用此漏洞，从而获取设备上的用户名和密码。该漏洞利用代码中不存在明显的投毒行为。利用方式如下：

1.  **构造HTTP请求:**  发送一个GET请求到`/device.rsp?opt=user&cmd=list`，并在请求头中设置`Cookie: uid=admin`。
2.  **绕过认证:**  设备接收到请求后，由于存在漏洞，会错误地将请求视为管理员权限，从而绕过正常的身份验证。
3.  **获取敏感信息:**  服务器返回包含用户列表的JSON数据，其中包含用户名和密码。
4.  **利用POC:** 提供的Python脚本`CVE-2018-9995_V2.2.py`通过读取包含IP地址和端口号的输入文件，然后针对每个IP地址发送包含恶意Cookie的请求，尝试获取用户名和密码，并将结果保存到输出文件中。

因此，该POC是有效的，并且没有发现投毒风险。

**项目地址:** [b510/CVE-2018-9995-POC](https://github.com/b510/CVE-2018-9995-POC)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)