## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 允许未经身份验证的攻击者在满足特定条件（访问Pod网络）的情况下，在 ingress-nginx controller 的上下文中执行任意代码。这可能导致泄露控制器可访问的 Secrets（默认情况下，控制器可以访问整个集群的 Secrets）。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为9.8，属于严重级别，利用前提需要访问Pod网络。POC代码 (`check.py`) 的作用是检测集群是否正在运行易受攻击的 ingress-nginx controller 版本，而不是实际的漏洞利用代码。因此，从提供的代码片段来看，无法直接判断漏洞利用的有效性。

**投毒风险：**

提供的 `check.py` 脚本主要用于检测 Kubernetes 集群中是否存在 vulnerable 的 ingress-nginx 版本，通过读取 Kubernetes API Server 获取相关信息。虽然该脚本本身似乎没有明显的恶意代码，但依然存在一定的投毒风险：

*   **依赖项：** 该脚本依赖 `kubernetes` 和 `packaging` Python 库。如果攻击者能够篡改 `uv` 安装过程或者伪造恶意库，则可能植入恶意代码。
*   **配置：** 该脚本通过 `config.load_kube_config()` 加载 Kubernetes 配置。如果攻击者能够篡改 kubeconfig 文件，则可能导致脚本连接到恶意的 Kubernetes API Server。
*   **信息收集：** 该脚本会收集 Kubernetes 集群中的 ingress-nginx 相关信息，并将版本打印到控制台。攻击者可能通过某种方式获取这些信息，从而进行有针对性的攻击。

综合考虑，该仓库存在约10%的潜在投毒风险，主要集中在依赖项和配置篡改方面。

**利用方式：**

根据漏洞描述和搜索结果，CVE-2025-1974 的利用方式涉及向 Nginx 配置中注入恶意指令，从而实现远程代码执行。具体利用步骤可能包括：

1.  利用其他漏洞（例如，其他多个同时披露的 ingress-nginx 漏洞）或者配置错误，允许攻击者修改或添加 ingress 规则。
2.  构造包含恶意 Nginx 指令的 ingress 规则。这些指令可以执行任意命令，例如，读取敏感文件、创建后门等。
3.  ingress-nginx controller 重新加载配置，执行恶意指令，从而实现远程代码执行。

搜索结果中提到，此漏洞可与其他漏洞链接利用，实现集群接管。

**项目地址:** [tuladhar/ingress-nightmare](https://github.com/tuladhar/ingress-nightmare)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)