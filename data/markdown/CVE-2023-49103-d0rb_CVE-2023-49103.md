## CVE-2023-49103 - ownCloud graphapi 信息泄露

**漏洞编号:** CVE-2023-49103

**漏洞类型:** 信息泄露

**影响应用:** ownCloud graphapi

**危害等级:** 高危，可能导致敏感信息泄露，进而导致完全控制

**影响版本:** owncloud/graphapi 0.2.x before 0.2.1 and 0.3.x before 0.3.1

**利用条件:** 目标系统安装了ownCloud，并且启用了 graphapi 插件。如果为docker部署,且时间在2023年2月之后。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-49103 漏洞允许未经身份验证的攻击者通过访问 `/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php` 暴露的 `phpinfo` 页面来获取敏感信息，例如环境变量。在容器化部署中，这些环境变量可能包含ownCloud管理员密码、邮件服务器凭据和许可证密钥。攻击者可以利用这些泄露的凭据进一步入侵系统。PoC代码首先尝试访问易受攻击的URL，然后解析phpinfo输出以提取敏感的环境变量（如OWNCLOUD_ADMIN_USERNAME和OWNCLOUD_ADMIN_PASSWORD）。提取到用户名和密码后，PoC尝试通过POST请求将这些凭据发送到攻击者控制的服务器（reverse_shell）。

**利用方式：**
1.  攻击者构造特定的URL访问目标ownCloud实例的phpinfo页面。
2.  服务器返回包含敏感信息的phpinfo页面。
3.  攻击者解析phpinfo页面，提取敏感环境变量。
4.  攻击者使用泄露的凭据登录ownCloud后台或进行其他恶意操作。

**投毒风险分析：**
查看提供的PoC代码，没有发现明显的恶意代码。主要功能是提取信息和尝试通过Post请求发送信息到攻击者服务器，并无其他敏感操作。`README.md` 文件包含对以色列人质事件的声援，虽然与漏洞本身无关，但可能使某些人反感，这并非代码投毒。但`PoC.py` 文件存在将获取的用户名密码post到`reverse_shell`的地址，reverse_shell的地址可能被投毒。因此存在投毒风险。

根据网络搜索结果，此漏洞已被积极利用，CISA已将其添加到已知可利用漏洞列表中，表明存在真实的威胁。

**项目地址:** [d0rb/CVE-2023-49103](https://github.com/d0rb/CVE-2023-49103)

**漏洞详情:** [CVE-2023-49103](https://nvd.nist.gov/vuln/detail/CVE-2023-49103)