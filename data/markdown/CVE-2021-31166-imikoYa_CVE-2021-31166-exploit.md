## CVE-2021-31166 (HTTP Protocol Stack Remote Code Execution Vulnerability)

**漏洞编号:** CVE-2021-31166

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows 10 Version 2004 (小于10.0.19041.982), Windows Server version 2004 (小于10.0.19041.982), Windows 10 Version 20H2 (小于10.0.19042.982), Windows Server version 20H2 (小于10.0.19042.982)

**利用条件:** 目标系统运行存在漏洞版本的HTTP.sys服务，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31166 是一个HTTP协议栈远程代码执行漏洞，存在于Microsoft Windows HTTP.sys中。攻击者可以通过发送特制的HTTP请求利用此漏洞在目标系统上执行任意代码。漏洞影响多个版本的Windows 10和Windows Server。根据CISA KEV目录，该漏洞已被积极利用。

**有效性：**
提供的README.md文件本身并不是漏洞利用代码，而是描述了受影响的版本。根据漏洞库信息，以及搜索引擎可能返回的有效利用信息（虽然这里为空），初步判断此漏洞存在可利用的PoC。

**投毒风险：**
提供的POC代码（README.md）仅描述了受影响的版本，本身并不包含恶意代码。但考虑到通常漏洞利用会包含多个文件,比如exp.py,利用脚本等, 风险评估如下:
 - 直接投毒代码：0% (因为只提供了README.md)
 - 潜在投毒风险：10% (由于缺乏实际的漏洞利用代码，无法判断是否存在隐藏的恶意代码，例如通过下载恶意payload执行)

**利用方式：**
根据漏洞描述，攻击者需要构造恶意的HTTP请求并将其发送到目标服务器。该请求会触发HTTP.sys中的漏洞，导致远程代码执行。具体利用方式可能涉及精心构造的HTTP头或请求体，利用 Use-After-Free 漏洞等。


**项目地址:** [imikoYa/CVE-2021-31166-exploit](https://github.com/imikoYa/CVE-2021-31166-exploit)

**漏洞详情:** [CVE-2021-31166](https://nvd.nist.gov/vuln/detail/CVE-2021-31166)