## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络访问Webmin的password_change.cgi页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107是Webmin 1.920及更早版本中password_change.cgi页面存在的一个命令注入漏洞。攻击者可以通过在'old'参数中注入恶意命令，实现远程代码执行。\n\n**有效性：**\n提供的POC代码是有效的，它利用了password_change.cgi中的命令注入漏洞。代码通过构造包含恶意命令的HTTP POST请求发送到目标Webmin服务器，从而执行任意命令。响应状态码500且包含"Your password has expired"表明利用成功。\n\n**投毒风险：**\n查看了提供的POC代码和README文件。POC代码本身实现了漏洞利用逻辑，未发现明显的恶意代码或后门。README文件仅包含漏洞描述和PoC图片，也没有发现可疑内容。因此，投毒风险评估为0%。\n\n**利用方式：**\n1.  **确定目标：** 找到运行Webmin 1.920或更早版本的服务器。\n2.  **发送恶意请求：** 使用POC脚本，指定目标Webmin服务器的URL。POC脚本会构造一个包含恶意命令的POST请求，发送到/password_change.cgi页面。命令注入发生在'old'参数中。\n3.  **执行命令：** Webmin服务器处理请求时，会将'old'参数中的命令注入到系统命令中并执行。\n4.  **获取结果：**  POC代码通过正则表达式从服务器的错误响应中提取命令执行结果并显示出来。\n\n利用的关键点是，攻击者不需要身份验证就可以触发这个漏洞，从而实现未经授权的远程代码执行。

**项目地址:** [0x4r2/Webmin-CVE-2019-15107](https://github.com/0x4r2/Webmin-CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)