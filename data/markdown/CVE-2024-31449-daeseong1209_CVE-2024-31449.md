## CVE-2024-31449-Redis-Stack Buffer Overflow

**漏洞编号:** CVE-2024-31449

**漏洞类型:** Stack Buffer Overflow

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 2.6 < 6.2.16, 7.0.0 < 7.2.6, 7.3.0 < 7.4.1

**利用条件:** 需要认证用户，开启Lua脚本功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-31449是Redis中存在的一个栈缓冲区溢出漏洞。经过身份验证的用户可以通过特制的Lua脚本触发bit库中的栈缓冲区溢出，从而可能导致远程代码执行。漏洞存在于所有包含Lua脚本的Redis版本中，但在6.2.16、7.2.6和7.4.1版本中已修复。

**有效性：**
提供的PoC代码是有效的，它通过`bit.tohex`函数传入特定的参数 `-2147483648`，触发了栈缓冲区溢出。README.md 文件中明确指出，尽管 Redis 具有多种保护机制，难以直接实现 RCE，但可以通过栈溢出进行 DoS 攻击，从docker日志可以看出PoC成功触发了崩溃。

**投毒风险：**
此仓库中存在投毒代码的风险较低，大约为5%。

*   Dockerfile只定义了Redis镜像和启动命令，没有发现可疑操作。
*   PoC.py 中的payload是直接通过redis命令执行lua脚本，功能明确，没有隐藏的恶意代码。
*   README.md 详细描述了漏洞原理和PoC，没有发现与漏洞无关或者具有恶意行为的内容。

**利用方式：**
1.  攻击者需要先获得 Redis 的认证权限。
2.  攻击者利用 Redis 的 Lua 脚本功能，执行特制的 Lua 脚本。
3.  Lua 脚本调用 `bit.tohex` 函数，并传入 `-2147483648`作为参数。
4.  `bit.tohex` 函数在处理该参数时，由于整数溢出，导致栈缓冲区溢出，进而可能导致远程代码执行或拒绝服务。

**项目地址:** [daeseong1209/CVE-2024-31449](https://github.com/daeseong1209/CVE-2024-31449)

**漏洞详情:** [CVE-2024-31449](https://nvd.nist.gov/vuln/detail/CVE-2024-31449)