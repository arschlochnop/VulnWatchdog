## CVE-2020-1472 Zerologon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

Zerologon (CVE-2020-1472) 是一个严重的权限提升漏洞，存在于 Netlogon Remote Protocol (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞。攻击成功后，攻击者可以运行特制的应用程序，从而完全控制域控制器。 

**利用方式：**

1.  **利用MS-NRPC协议：** 攻击者利用 MS-NRPC 协议连接到域控制器。
2.  **重置域控制器的密码：** 攻击者通过将域控制器的计算机密码设置为已知值（通常是空值），从而破坏身份验证过程。
3.  **获取域管理员权限：** 密码重置后，攻击者可以冒充域控制器并获取域管理员权限。

**有效性：**

提供的漏洞利用代码 (zeroscan) 本身是一个扫描器，用于检测目标域控制器是否存在 Zerologon 漏洞、MS-PAR/MS-RPRN 协议是否暴露以及 SMBv2 签名配置。它**不**尝试实际利用该漏洞，但是它使用基于已知的POC修改的代码库来检查漏洞，因此可以判断存在可利用性。

**投毒风险：**

分析提供的代码，投毒风险较低，但不能完全排除。理由如下：

*   **开源代码：** 代码托管在 GitHub 上，具有一定的透明度，更容易受到社区审查。
*   **扫描器功能：** 该工具主要功能是扫描，而非直接利用，因此隐藏恶意代码的动机相对较低。
*   **依赖第三方库：** 代码依赖于 Impacket 和 Nmap 等第三方库，攻击者可能尝试利用这些依赖项中的漏洞进行投毒攻击。但是，直接在zeroscan本身投毒的概率较低。
*  **POC的免责声明：**  `Codebase borrowed from: https://github.com/Anonymous-Family/CVE-2020-1472.git` 声明中，代码借鉴了其他库,存在一定的代码风险.

因此，尽管直接在 zeroscan 代码中植入后门的概率较低（假设为5%），但仍需谨慎使用，并仔细审查代码及所依赖的第三方库。


**项目地址:** [Anonymous-Family/Zero-day-scanning](https://github.com/Anonymous-Family/Zero-day-scanning)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)