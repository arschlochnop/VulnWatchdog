## CVE-2025-4403 - Drag and Drop Multiple File Upload for WooCommerce 任意文件上传漏洞

**漏洞编号:** CVE-2025-4403

**漏洞类型:** 任意文件上传

**影响应用:** Drag and Drop Multiple File Upload for WooCommerce

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.1.6

**利用条件:** WordPress 站点安装了 Drag and Drop Multiple File Upload for WooCommerce 插件，且版本小于等于 1.1.6，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4403 漏洞存在于 Drag and Drop Multiple File Upload for WooCommerce 插件中。由于插件在 `upload()` 函数中接受用户提供的 `supported_type` 字符串和上传的文件名，但没有进行实际的扩展名或 MIME 类型检查，导致未经身份验证的攻击者可以上传任意文件到受影响的服务器上，从而可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者发送一个包含恶意文件的 POST 请求到 `/wp-admin/admin-ajax.php` 接口。
2.  请求中包含 `action=dnd_codedropz_upload_wc` 和 `_ajax_nonce` 参数，用于触发上传逻辑。
3.  `dnd-wc-upload-file` 参数用于指定要上传的文件。文件名可以伪造成任意扩展名，例如 `index.php.`。
4.  `supported_type` 参数用于绕过文件类型检查，设置为 `.` 代表接受所有类型。
5.  服务器接收到请求后，会将恶意文件上传到 `/wp-content/uploads/wc_drag-n-drop_uploads/tmp_uploads/` 目录下。
6.  攻击者可以通过访问上传的文件执行恶意代码。

**有效性评估：**

提供的 PoC 代码看起来有效。它利用了漏洞描述中提到的关键点，包括:

*   获取 nonce 值绕过身份验证检查。
*   上传文件时，将 `supported_type` 设置为 `.`。
*   上传的文件名包含 `php.` 后缀，以绕过扩展名检查。
*   检查上传是否成功，并输出上传文件的 URL。

**投毒风险分析：**

PoC 代码本身的功能是验证漏洞并上传文件。但是，存在轻微的投毒风险。

*   **`test_file = "index.php."`:**  PoC 需要一个名为 `index.php.` 的文件存在于当前目录。这个文件是攻击者需要自己创建的，内容可以自定义。如果攻击者将恶意代码写入此文件中，则可能存在投毒风险。
*   **结果写入 `result.txt`:** 虽然这个行为本身不是恶意的，但如果攻击者通过其他方式控制了服务器，可能会篡改 `result.txt` 文件，误导其他用户。

总体来说，投毒风险较低 (10%)，主要取决于用户如何创建和使用 `index.php.` 文件。

**总结：**

该漏洞允许未经身份验证的攻击者上传任意文件，可能导致远程代码执行。提供的 PoC 代码可以有效利用此漏洞。存在轻微的投毒风险，主要取决于上传的文件内容。

**项目地址:** [Yucaerin/CVE-2025-4403](https://github.com/Yucaerin/CVE-2025-4403)

**漏洞详情:** [CVE-2025-4403](https://nvd.nist.gov/vuln/detail/CVE-2025-4403)