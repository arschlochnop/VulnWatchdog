## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用 Next.js 中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 存在于 Next.js 中间件的权限验证逻辑中。攻击者可以通过发送包含 `x-middleware-subrequest` 头的请求绕过中间件的权限检查，从而访问受保护的资源。漏洞利用代码提供了一个 Dockerfile 和示例 Next.js 应用来复现该漏洞。Dockerfile 用于构建包含易受攻击的 Next.js 版本的环境。`README.md` 提供了关于如何使用 Docker 或直接从源代码运行应用程序的说明。`package-lock.json` 列出了应用程序依赖项，包括易受攻击的 Next.js 版本 15.2.2。从搜索结果来看，多个来源都确认了该漏洞的存在和严重性，并提供了关于漏洞原理和利用方法的详细信息。利用方式：攻击者发送包含特定 header（x-middleware-subrequest）的恶意请求，服务器错误的将其识别为子请求，从而绕过权限验证中间件。

**关于投毒风险：**
Dockerfile 相对标准，主要用于搭建环境。 README.md 主要提供使用说明，没有可疑代码。 package-lock.json 看起来是标准的依赖定义文件。 风险在于，在 `npm run dev` 模式下，Next.js 会动态加载代码，如果攻击者控制了部分应用代码，可能会注入恶意代码。虽然漏洞本身不是投毒，但利用该漏洞可能导致进一步的攻击，例如远程代码执行，因此有一定的投毒风险，约为10%。主要风险在于该POC提供了一个可直接运行的Next.js项目，使用者容易直接使用该项目，如果作者在pages或其他文件中植入恶意代码，使用者可能在不知情的情况下引入。

**项目地址:** [kuzushiki/CVE-2025-29927-test](https://github.com/kuzushiki/CVE-2025-29927-test)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)