## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要ProFTPD服务器开启mod_copy模块，且攻击者能够通过FTP协议连接到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。远程攻击者可以通过 `site cpfr` 和 `site cpto` 命令读取和写入任意文件，从而可能导致敏感信息泄露或远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判定该漏洞利用代码是有效的。搜索引擎结果中包含了多个关于该漏洞的描述和利用方法，exploit-db上也提供了相关的exp利用。

**投毒风险分析：**

提供的 Python 脚本 `propane.py` 用于利用该漏洞，主要功能包括：

*   **测试目标是否脆弱：** 通过 `site cpfr /etc/passwd` 命令测试目标服务器是否存在漏洞。
*   **读取任意文件：** 使用 `site cpfr` 命令指定要读取的文件，然后使用 `site cpto` 命令将文件复制到 Web 服务器的目录中，使得攻击者可以通过 HTTP 协议访问该文件。
*   **代码执行：** 尝试写入一个 PHP webshell，然后通过访问该 webshell 执行任意代码。

对代码进行分析后，未发现作者有意隐藏的恶意投毒代码，例如反向shell或者其他恶意行为。所以投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞发现：** 攻击者通过发送特定的 FTP 命令（`site cpfr` 和 `site cpto`）来触发漏洞。
2.  **任意文件读取：** 攻击者使用 `site cpfr <源文件>` 命令选择要复制的源文件，然后使用 `site cpto <目标文件>` 命令指定目标文件。如果目标文件位于 Web 服务器的根目录下，攻击者就可以通过 HTTP 协议访问该文件，从而读取服务器上的任意文件。
3.  **任意文件写入/代码执行：** 攻击者可以将包含恶意代码的文件写入服务器。一种常见的方法是写入一个 PHP webshell，然后通过 HTTP 协议访问该 webshell，从而在服务器上执行任意代码。脚本中的第三种模式尝试执行此操作。

**项目地址:** [nootropics/propane](https://github.com/nootropics/propane)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)