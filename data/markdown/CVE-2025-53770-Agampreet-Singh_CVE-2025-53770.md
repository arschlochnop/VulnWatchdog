## CVE-2025-53770 - Microsoft SharePoint Server RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要目标SharePoint服务器可访问，且未安装相应的安全补丁或缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于本地部署的 Microsoft SharePoint Server 中的远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。未经授权的攻击者可以通过网络利用此漏洞执行任意代码。

**有效性评估：**

根据漏洞库信息，此漏洞已被积极利用（“exploit for CVE-2025-53770 exists in the wild”），并且 CISA 已将其添加到已知被利用的漏洞目录 (KEV)。提供的PoC代码针对的是 SharePoint Server 的 `ToolPane.aspx` 页面，利用 `Scorecard:ExcelDataSet` 控件中不安全的反序列化漏洞。PoC 通过 POST 请求发送包含恶意序列化数据的 payload，从而实现 RCE。

搜索引擎结果也证实了该漏洞的严重性以及已被利用的事实。多个安全厂商和组织发布了关于此漏洞的警告和分析报告。

因此，提供的 PoC 代码很可能有效。

**投毒风险分析：**

PoC 代码主要功能是利用已知的反序列化漏洞。Payload 部分，即 `CompressedDataTable` 字段的内容，是经过压缩和 Base64 编码的序列化数据。

投毒的潜在风险主要在于：

1.  **payload 内容：** 攻击者可能会修改 payload，使其在利用漏洞的同时，执行一些恶意操作，例如安装后门、窃取数据、破坏系统等。
2.  **代码逻辑：**  虽然PoC代码比较简短，但依然存在被植入恶意代码的可能。例如，在成功利用漏洞后，悄悄地下载并执行额外的恶意程序。

尽管存在这些风险，但 PoC 代码本身看起来主要是为了演示漏洞利用，而非恶意行为。风险评估为10%。

**利用方式分析：**

1.  攻击者构造恶意的序列化数据，并将其压缩和 Base64 编码。
2.  攻击者向目标 SharePoint 服务器的 `/_layouts/15/ToolPane.aspx` 页面发送 POST 请求，其中包含 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数。`MSOTlPn_DWP` 参数的值是包含恶意序列化数据的 payload。
3.  SharePoint 服务器在处理请求时，会反序列化 `CompressedDataTable` 中的数据，由于数据是恶意的，会导致 RCE。
4.  攻击者可以在目标服务器上执行任意代码。

**项目地址:** [Agampreet-Singh/CVE-2025-53770](https://github.com/Agampreet-Singh/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)