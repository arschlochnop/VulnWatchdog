## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要满足多个条件，包括：默认Servlet开启写入 (默认关闭)，支持Partial PUT (默认开启)，存在安全敏感文件的目标URL是公共上传目标URL的子目录，攻击者知晓敏感文件名，安全敏感文件通过Partial PUT上传，或应用程序使用Tomcat文件会话持久性（默认位置），应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞。该漏洞允许攻击者通过精心构造的包含内部点（file.Name）的文件名，利用默认Servlet中启用的写入功能和Partial PUT支持，进行远程代码执行、信息泄露和恶意内容注入。根据漏洞描述，攻击成功的关键在于Tomcat的配置以及应用程序是否使用了易受攻击的组件。

**有效性：** 从搜索结果来看，该漏洞已被确认存在并且有在野利用。但是，漏洞利用需要满足多个非默认配置条件，因此并非所有Tomcat实例都易受攻击。提供的POC代码 `/tmp/9a20e2370d216dc00af3f4d6145c600e/README.md` 内容过于简单，仅包含CVE编号，并不能直接用于漏洞利用，需要根据具体情况编写特定的利用代码，例如构造恶意的PUT请求。

**投毒风险：** 提供的POC代码非常简单，主要就是包含 CVE-2025-24813 的 README.md 文件。因此，投毒风险很低，但是不排除作者在其他相关文件中隐藏恶意代码的可能性，只是没有在此次提交中呈现，考虑到文件数量极少,故判断存在10%的投毒风险。

**利用方式：** 漏洞利用主要通过以下步骤：

1.  **利用Partial PUT上传恶意文件：** 攻击者构造包含内部点的文件名，并通过Partial PUT请求将其上传到目标服务器。
2.  **绕过路径检查：** 由于路径等价性问题，Tomcat可能无法正确处理包含内部点的文件名，导致绕过路径检查。
3.  **信息泄露/恶意内容注入：** 如果目标是信息泄露或恶意内容注入，攻击者需要知道目标敏感文件的名称和路径，然后通过覆盖或修改该文件来实现目的。
4.  **远程代码执行：** 如果应用程序使用了Tomcat的文件会话持久性，并且包含可用于反序列化攻击的库，攻击者可以利用该漏洞将恶意序列化对象写入会话文件，从而实现远程代码执行。攻击者可能会覆盖session文件，然后触发反序列化。

**总结：** CVE-2025-24813 是一个高危漏洞，但是利用条件较为苛刻。 提供的POC代码过于简单，无法直接用于攻击，需要根据目标环境进行定制。在实际环境中，需要仔细评估Tomcat的配置和应用程序的安全性，以确定是否存在被利用的风险。同时需要关注针对该漏洞的攻击尝试并及时采取缓解措施，例如禁用默认Servlet的写入功能或升级到修复版本。

**项目地址:** [AlperenY-cs/CVE-2025-24813](https://github.com/AlperenY-cs/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)