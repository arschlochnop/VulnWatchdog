## CVE-2025-31486-Vite-任意文件读取

**漏洞编号:** CVE-2025-31486

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.12, >=5.0.0, < 5.4.17, >=6.0.0, < 6.0.14, >=6.1.0, < 6.1.4, >=6.2.0, < 6.2.5

**利用条件:** Vite 开发服务器需要通过 `--host` 参数或者 `server.host` 配置项暴露到网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-31486 允许未经身份验证的攻击者绕过 `server.fs.deny` 限制，读取服务器上的任意文件。漏洞利用方式是通过构造特殊的 URL，包含 `?.svg` 或 `?.wasm?init` 后缀，来欺骗服务器跳过安全检查。漏洞利用代码中提供了一个 Dockerized 的模拟环境，方便研究人员复现漏洞。

**有效性：**
根据漏洞描述，POC 代码旨在模拟 CVE-2025-31486 漏洞，允许攻击者读取任意文件，因此有效。

**投毒风险：**
提供的 Dockerfile 和 docker-compose.yml 文件看起来是标准的开发环境配置，没有明显的恶意代码。但是，任何来自第三方的代码都存在一定的风险。可能的风险点包括：

1.  **依赖项风险：** `package.json` 文件中可能包含恶意的依赖项，这些依赖项可能会在 `npm install` 阶段引入恶意代码。但这种情况比较隐蔽，需要进一步分析 `package.json` 文件。
2.  **镜像投毒：** 虽然 Dockerfile 使用官方 Node.js 镜像作为基础镜像，但仍存在基础镜像本身被篡改的风险。

考虑到以上风险，我估计该仓库中存在作者隐藏的投毒代码的可能性为10%。

**利用方式：**
1.  启动存在漏洞的 Vite 开发服务器，并确保它通过 `--host` 或 `server.host` 暴露到网络。
2.  构造包含 `?.svg` 或 `?.wasm?init` 后缀的特殊 URL，例如：`http://<vite_server_address>:<port>/path/to/sensitive/file?.svg`。
3.  如果目标文件小于 `build.assetsInlineLimit` (默认 4KB)，则 Vite 会将文件内容作为 Base64 编码的字符串内联到响应中。
4.  攻击者解码 Base64 字符串，即可获取敏感文件内容。

**项目地址:** [hackmelocal/CVE-2025-31486-Simulation](https://github.com/hackmelocal/CVE-2025-31486-Simulation)

**漏洞详情:** [CVE-2025-31486](https://nvd.nist.gov/vuln/detail/CVE-2025-31486)