## CVE-2025-30208-Vite-文件读取漏洞

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:**  < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite dev server 显式暴露到网络（使用 `--host` 或 `server.host` 配置选项），需要目标存在/root/.bash_history文件，且其中包含'-P'字符串

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Vite中，由于对URL的处理不当，攻击者可以通过在URL中添加`?raw??`或`?import&raw??`来绕过`server.fs.deny`限制，读取服务器上的任意文件。PoC代码通过批量请求目标URL加上`?raw`后缀来尝试读取`/root/.bash_history`文件，并通过检查响应内容中是否包含`-P`来判断漏洞是否存在。

**有效性：**
根据漏洞描述和PoC代码，该PoC代码是有效的。它能够利用漏洞读取服务器上的文件。

**投毒风险：**
PoC代码本身并没有明显的投毒行为。代码逻辑相对简单，主要功能是发送HTTP请求并检查响应。不过需要注意的是，该脚本读取.bash_history文件，如果攻击者能够控制该文件的内容，可能通过修改.bash_history文件，在管理员执行命令的时候，触发恶意代码的执行。

**利用方式：**
1.  攻击者需要找到运行了存在漏洞版本的Vite，并且将Vite dev server暴露在公网上的服务器。
2.  攻击者构造包含`?raw??`或`?import&raw??`的URL，尝试读取服务器上的敏感文件，例如`/root/.bash_history`文件。
3.  如果服务器存在漏洞，并且目标文件可读，服务器将返回文件内容，导致敏感信息泄露。

**项目地址:** [YuanBenSir/CVE-2025-30208_POC](https://github.com/YuanBenSir/CVE-2025-30208_POC)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)