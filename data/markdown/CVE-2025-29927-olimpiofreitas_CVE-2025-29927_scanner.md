## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了存在漏洞的Next.js版本，并且授权检查依赖于中间件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中存在的一个授权绕过漏洞。攻击者可以通过发送包含`x-middleware-subrequest`标头的特制HTTP请求绕过身份验证检查。漏洞利用方式如下：

1.  **漏洞描述：** Next.js应用如果使用中间件进行授权检查，且版本在受影响范围内，则可能存在此漏洞。
2.  **利用方式：** 攻击者发送包含`x-middleware-subrequest`标头的HTTP请求，该请求会被不正确地处理，导致绕过中间件的授权检查。
3.  **POC有效性：** 提供的Python脚本尝试检测目标URL是否使用了Next.js，获取版本信息，并尝试通过访问受保护的路由来验证漏洞是否存在。脚本通过检查服务器头和页面内容来确定Next.js版本，并使用默认路由列表或自定义路由列表测试授权绕过。
4.  **投毒风险：** 脚本主要功能是检测漏洞，但存在轻微的投毒风险，因为它可以被修改为尝试利用该漏洞进行攻击。但从现有代码来看，其风险点主要在于：
    * 创建`routes.txt`文件：如果脚本被放置在具有写入权限的目录中，可能会创建文件，这可能导致小的权限问题，但不太可能构成严重的投毒。
    * 依赖外部库（requests, urllib3）：虽然这些是常见的库，但恶意修改可能会导致请求重定向到恶意站点或执行其他恶意操作。
    * 忽略SSL证书验证（`verify=False`）：这本身不是投毒，但会使脚本更容易受到中间人攻击，从而可能被篡改。
5.  **缓解措施：** 升级Next.js版本到14.2.25或15.2.3及以上，或者阻止包含`x-middleware-subrequest`标头的外部用户请求到达Next.js应用。

**项目地址:** [olimpiofreitas/CVE-2025-29927_scanner](https://github.com/olimpiofreitas/CVE-2025-29927_scanner)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)