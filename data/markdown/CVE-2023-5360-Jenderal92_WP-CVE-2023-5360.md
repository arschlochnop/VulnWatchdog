## CVE-2023-5360-Royal Elementor Addons and Templates-任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件中，版本低于 1.3.79。该漏洞允许未经身份验证的用户上传任意文件，包括 PHP 文件，从而可能导致远程代码执行(RCE)。

**有效性分析：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高。
*   漏洞库信息表明，该插件存在未授权任意文件上传漏洞，且已公开。
*   搜索结果中多个来源确认了该漏洞的存在和严重性，甚至有报告指出该漏洞已被积极利用。
*   提供的漏洞利用代码（`cve-2023-5360.py`）针对该漏洞，尝试上传包含恶意代码的 PHP 文件。

**投毒风险分析：**
*   代码中包含从 `https://raw.githubusercontent.com/ajibarangxploit/shinx/main/shin.php` 下载 shell 的行为。这引入了潜在的投毒风险。如果该远程文件被篡改，攻击者可能会执行非预期代码。
*   尽管如此，主利用逻辑在于利用文件上传漏洞，后门下载可以被视为一种额外的功能，增加了风险，但并非核心利用方式。
*   `scanner.py`的功能主要是版本检测，判断目标是否存在漏洞，没有发现恶意代码。
*   考虑到远程下载的风险，并结合作者的信誉无法评估，因此评估投毒风险为10%。主要的风险还是在于漏洞利用本身，而非代码作者的恶意行为。

**利用方式分析：**
1.  **版本检测：** 使用`scanner.py` 通过访问目标网站的 `readme.txt` 文件，检查 Royal Elementor Addons and Templates 插件的版本。
2.  **Nonce 获取：** 通过请求目标网站页面，利用正则表达式提取 WprConfig 对象的 nonce 值，该值用于后续的上传请求。
3.  **文件上传：** 构造包含恶意 PHP 代码的上传请求，其中 `action` 参数设置为 `wpr_addons_upload_file`，`wpr_addons_nonce` 参数设置为获取的 nonce 值，`uploaded_file` 参数设置为包含恶意 PHP 代码的文件。漏洞利用代码中的恶意 PHP 代码会尝试从远程 URL 下载 shell 文件，然后执行它。文件名被混淆为`shin.ph$p`。
4.  **Shell 访问：** 上传成功后，通过访问上传的文件（`/wp-content/uploads/wpr-addons/forms/shin.php`）来执行恶意代码，从而获得服务器的控制权。

该利用方式利用了插件的文件上传功能，绕过了文件类型验证，从而上传恶意 PHP 文件并执行，最终实现远程代码执行。

**项目地址:** [Jenderal92/WP-CVE-2023-5360](https://github.com/Jenderal92/WP-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)