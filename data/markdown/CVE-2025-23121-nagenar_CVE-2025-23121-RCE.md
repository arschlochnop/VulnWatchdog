## CVE-2025-23121-Veeam Backup & Recovery-远程代码执行

**漏洞编号:** CVE-2025-23121

**漏洞类型:** 远程代码执行

**影响应用:** Veeam Backup & Recovery

**危害等级:** 高危，可能导致数据泄露、系统入侵和备份数据破坏

**影响版本:** <= 12.3.1

**利用条件:** 需要有效的域用户凭据和对备份服务器的网络访问(TCP/6060)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-23121是一个存在于Veeam Backup & Recovery 12.3.1版本及更早版本中的远程代码执行漏洞。根据漏洞信息和搜索结果，此漏洞被评为严重级别（CVSS 9.9）。攻击者通过使用有效的域用户凭据进行身份验证后，可以通过API注入恶意任务来执行任意代码。 

**有效性：**
提供的POC代码（`backuprceauth.py`）旨在利用此漏洞。根据README.md，POC利用了经过身份验证的会话进行远程代码执行，并提供了一个示例，说明如何使用有效的域凭据来执行系统命令。搜索结果表明该漏洞已在Veeam Backup & Replication中修复，因此，针对未修补的系统，该POC很可能是有效的。

**投毒风险：**
分析POC代码（仅提供了README和LICENSE），无法直接评估代码层面的投毒风险。但有几点需要注意：
1.  **下载链接：** README中提供了一个缩短的下载链接（`http://bit.ly/46339rr`）。这增加了潜在的投毒风险，因为无法直接审查下载文件的内容。恶意作者可能会用包含后门或恶意软件的修改版本替换原始漏洞利用代码。
2.  **权限要求：** 该漏洞需要有效的域凭据才能利用。如果攻击者将后门植入POC中，并诱使安全研究人员或红队成员使用其拥有的域帐户运行该后门，则可能导致凭据泄露，从而扩大攻击范围。
3.  **第三方依赖：**  虽然提供的代码片段没有明确显示，但实际的`backuprceauth.py`脚本可能依赖于第三方库。恶意作者可以通过修改脚本以包含恶意依赖项来引入投毒风险。

综合来看，虽然提供的文件本身不包含明显的恶意代码，但考虑到下载链接的风险以及潜在的第三方依赖项，投毒风险估计在10%左右。

**利用方式：**
漏洞的利用方式如下：
1.  攻击者首先需要获得有效的域用户凭据。
2.  攻击者使用`backuprceauth.py`脚本，通过提供的域凭据向Veeam Backup Server进行身份验证。
3.  成功身份验证后，脚本通过API接口注入恶意任务，从而在服务器上执行任意代码。 
4.  命令执行的结果通过脚本返回给攻击者。

**项目地址:** [nagenar/CVE-2025-23121-RCE](https://github.com/nagenar/CVE-2025-23121-RCE)

**漏洞详情:** [CVE-2025-23121](https://nvd.nist.gov/vuln/detail/CVE-2025-23121)