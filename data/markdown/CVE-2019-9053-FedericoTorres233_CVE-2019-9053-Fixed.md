## CVE-2019-9053 - CMS Made Simple - Time-based Blind SQL Injection

**漏洞编号:** CVE-2019-9053

**漏洞类型:** Time-based Blind SQL Injection

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露

**影响版本:** < 2.2.10

**利用条件:** 需要可访问的CMS Made Simple实例，并且News模块已安装。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.10之前版本中存在的一个时间盲注SQL注入漏洞。攻击者可以通过构造恶意的URL，特别是`m1_idlist`参数，利用News模块执行未经身份验证的盲注SQL注入。由于是时间盲注，攻击者需要通过观察服务器响应时间来推断数据库中的信息。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且有公开的PoC代码（Exploit-DB 46635）。提供的漏洞利用代码（cve.py和cve.diff）是对原始PoC的修复，主要修复了Python 2到Python 3的兼容性问题，以及一些编码问题。因此，可以认为修复后的PoC代码是有效的。

**投毒风险：**
该仓库包含一个README.md文件和一个cve.diff文件，用于修补原始的cve.py文件（来自Exploit-DB）。
*   **README.md:**  包含免责声明，提示用户承担使用该工具的责任。包含如何克隆仓库、创建cve.py文件、应用补丁和执行命令的说明。虽然包含了免责申明，但是不能排除有投毒代码的可能性。
*   **cve.diff:**  这是一个补丁文件，用于修复原始cve.py文件。它修改了print语句以适应Python 3，修复了密码破解部分中的编码问题，以及打开文件的方式。

主要的投毒风险在于用户需要从外部源（Exploit-DB）获取原始的`cve.py`文件，并应用提供的补丁。攻击者可能通过篡改`cve.py`原始文件或者`cve.diff`文件来引入恶意代码，例如反弹shell或者信息窃取。但是考虑到仓库本身提供的只是补丁, 并且补丁的代码量较少，容易审查，**投毒风险较低，约为5%**。

**利用方式：**
1.  **目标识别：** 找到运行着CMS Made Simple 2.2.10之前版本的web应用，并且安装了News模块。
2.  **漏洞触发：** 通过构造包含恶意SQL语句的URL，特别是修改`moduleinterface.php?mact=News,m1_,default,0` 中的 `m1_idlist` 参数，发送到目标服务器。
3.  **数据提取：** 利用时间盲注的特性，通过观察服务器响应时间，逐步推断数据库中的敏感信息，例如用户名、密码哈希等。
4.  **密码破解（可选）：** 如果获取了密码哈希和salt，可以使用字典攻击或暴力破解来获取明文密码。漏洞利用代码中包含了密码破解的功能。

总而言之，该漏洞利用依赖于时间盲注技术，利用难度相对较高，需要一定的渗透测试经验。修复后的PoC代码有效，但用户需要注意从可信源获取原始的`cve.py`文件，以避免潜在的投毒风险。

**项目地址:** [FedericoTorres233/CVE-2019-9053-Fixed](https://github.com/FedericoTorres233/CVE-2019-9053-Fixed)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)