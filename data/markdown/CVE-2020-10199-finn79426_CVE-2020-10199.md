## CVE-2020-10199-Sonatype Nexus Repository-JavaEL注入

**漏洞编号:** CVE-2020-10199

**漏洞类型:** JavaEL注入

**影响应用:** Sonatype Nexus Repository

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 3.21.2

**利用条件:** 需要具有Nexus Repository的低权限账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-10199 存在于Sonatype Nexus Repository 3.21.2 之前的版本中，是一个 JavaEL 注入漏洞。攻击者通过利用此漏洞，可以在 Nexus Repository 服务器上执行任意代码。从搜索引擎的结果和漏洞库信息来看，该漏洞影响较大，且存在公开的利用代码。提供的漏洞利用代码`/tmp/547598de0cb3f7935aa8f51a6f8d6fb6/README.md`内容非常简单，只包含了漏洞的CVE编号，是一个漏洞声明的文件，并非可直接执行的PoC脚本，但表明漏洞存在可利用性。真正的利用方式是，攻击者通过已认证的低权限账号，构造恶意的JavaEL表达式并注入到Nexus Repository服务器中，服务器在解析该表达式时执行了恶意代码，最终导致远程代码执行。从提供的POC代码来看，投毒风险极低，几乎可以忽略，因为只是一个声明文件，无法执行任何恶意操作，但仍存在人工植入恶意代码的可能性。该漏洞的利用方式包括：

1.  **漏洞定位：** 确定目标 Nexus Repository 服务器的版本是否在受影响范围内（< 3.21.2）。
2.  **权限获取：**  需要具有 Nexus Repository 的低权限账户，例如 reader 权限。
3.  **漏洞触发：** 构造包含恶意 JavaEL 表达式的请求，发送到 Nexus Repository 服务器。具体请求的位置和参数需要根据 Nexus Repository 的具体实现而定。
4.  **代码执行：** Nexus Repository 服务器解析 JavaEL 表达式时，执行攻击者注入的恶意代码，从而实现远程代码执行。

此漏洞已被CISA列入已知被利用的漏洞目录中，说明该漏洞具有较高的实战价值。

**项目地址:** [finn79426/CVE-2020-10199](https://github.com/finn79426/CVE-2020-10199)

**漏洞详情:** [CVE-2020-10199](https://nvd.nist.gov/vuln/detail/CVE-2020-10199)