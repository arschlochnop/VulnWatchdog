## CVE-2018-10933-libssh认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.7.6, 0.8.4

**利用条件:** 目标系统运行libssh服务，且版本为受影响版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933 存在于 libssh 0.6 及以上版本中，允许未经身份验证的远程攻击者绕过身份验证。通过向服务器发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，攻击者可以创建通道而无需进行身份验证。提供的POC代码首先检查目标SSH服务器的banner信息，判断是否存在漏洞风险，然后尝试通过发送特制的`SSH2_MSG_USERAUTH_SUCCESS`消息来绕过认证，并执行指定命令。代码中没有发现明显的投毒行为，主要是利用Paramiko库进行SSH连接和消息构造。

**漏洞利用方式：**

1.  **连接目标SSH服务器：**  使用socket连接目标服务器的SSH端口。
2.  **启动SSH客户端：**  使用Paramiko库启动SSH客户端。
3.  **绕过认证：**  发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，欺骗服务器认为客户端已通过身份验证。
4.  **执行命令：**  创建新的SSH会话并执行任意命令。
5.  **获取输出：**  从标准输出和标准错误流中读取命令执行结果。

**项目地址:** [xFreed0m/CVE-2018-10933](https://github.com/xFreed0m/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)