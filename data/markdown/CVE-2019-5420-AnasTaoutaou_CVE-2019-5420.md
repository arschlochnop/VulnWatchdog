## CVE-2019-5420 - Rails Development Mode Remote Code Execution

**漏洞编号:** CVE-2019-5420

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Rails

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** <5.2.2.1, <6.0.0.beta3

**利用条件:** Rails 应用运行在开发模式下

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5420 是一个影响 Rails 应用程序在开发模式下的远程代码执行漏洞。漏洞原因是 Rails 在开发模式下自动生成的 secret token 具有可预测性。攻击者可以通过猜测 secret token，结合 Rails 内部机制，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码具有有效性。漏洞库信息明确指出此漏洞的存在，搜索结果中也提供了相关的漏洞描述和利用分析。提供的Python脚本，用于解密加密的cookie，这正是利用此漏洞的第一步。脚本通过应用程序名称生成密钥，然后使用该密钥解密cookie的内容，进而获取敏感信息或者执行恶意操作。通过修改`APP-NAME-HERE`和`COOKIE-HERE`值，运行此POC可以用于在目标系统验证漏洞的存在。

**投毒风险分析：**

查看提供的POC代码，并未发现明显的恶意代码或后门。此Python脚本功能相对单一，主要是用于解密cookie。`README.md`文件也表明该POC仅用于学习目的。所以该存储库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式分析：**

利用此漏洞的典型方式如下：

1.  **猜测或获取 secret token：**  由于 Rails 在开发模式下 secret token 的生成方式存在缺陷，攻击者可以尝试猜测或通过其他方式获取该 token。
2.  **构造恶意请求：**  攻击者利用获取的 secret token，结合 Rails 内部机制（例如，session hijacking或cookie操作），构造包含恶意代码的请求。
3.  **远程代码执行：**  Rails 服务器接收到恶意请求后，执行其中的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2019-5420 是一个严重的安全漏洞，可能导致 Rails 应用程序被完全控制。为了避免此漏洞带来的风险，请确保 Rails 应用程序不在开发模式下运行于生产环境，并及时更新 Rails 版本。

**项目地址:** [AnasTaoutaou/CVE-2019-5420](https://github.com/AnasTaoutaou/CVE-2019-5420)

**漏洞详情:** [CVE-2019-5420](https://nvd.nist.gov/vuln/detail/CVE-2019-5420)