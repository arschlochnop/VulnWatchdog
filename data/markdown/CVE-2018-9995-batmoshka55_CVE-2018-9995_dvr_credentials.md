## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 (以及 re-branded 版本)

**危害等级:** 高危，可能允许未经授权的远程访问和控制设备

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 设备，以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，它们运行原始 TBK DVR4104 和 DVR4216 系列的重新品牌版本。

**利用条件:** 需要网络可达性，以及设备未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过发送包含 `Cookie: uid=admin` 头的 HTTP 请求绕过身份验证。例如，通过发送 `device.rsp?opt=user&cmd=list` 请求，攻击者可以获取设备上的用户信息，因为响应会包含 JSON 格式的凭据信息。

**有效性：**
根据漏洞描述和可用的 Exploit-DB 条目 (https://www.exploit-db.com/exploits/44577/)，该漏洞利用是有效的。攻击者只需在 HTTP 请求中设置特定的 Cookie 即可绕过身份验证。

**投毒风险：**
提供的代码段是 GNU GPL 许可证文本，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标设备是否为受影响的 TBK DVR4104 或 DVR4216 系列，或者这些系列的重新品牌版本。
2.  构造一个 HTTP 请求，并在请求头中添加 `Cookie: uid=admin`。
3.  将此请求发送到 DVR 的 Web 接口，例如 `device.rsp?opt=user&cmd=list`。
4.  如果漏洞存在，服务器将返回未经授权通常无法访问的信息，例如用户信息列表或设备配置。

**项目地址:** [batmoshka55/CVE-2018-9995_dvr_credentials](https://github.com/batmoshka55/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)