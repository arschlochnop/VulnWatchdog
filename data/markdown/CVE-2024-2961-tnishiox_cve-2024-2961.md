## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致应用程序崩溃或覆盖相邻变量，理论上可实现远程代码执行。

**影响版本:** < 2.40

**利用条件:** 需要应用程序使用 iconv 函数进行字符集转换，且目标字符集为 ISO-2022-CN-EXT。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-2961 是 glibc 中 iconv 函数的一个缓冲区溢出漏洞。具体来说，当使用 iconv 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果输出缓冲区太小，可能会发生最多 4 字节的溢出。漏洞影响 glibc 2.39 及更早版本。

**有效性：**
提供的 POC 代码是一个简单的漏洞检测器，它尝试使用 iconv 函数将包含中文字符的字符串从 UTF-8 转换为 ISO-2022-CN-EXT。如果 `iconv` 返回值小于0，则说明系统存在漏洞。代码通过检查 `soutput` 的值来确定是否发生溢出。根据搜索结果，此漏洞确实存在可利用性。

**投毒风险：**
该仓库的代码非常简单，主要就是一个C文件和一个README。C文件仅仅实现了漏洞验证的功能，没有发现恶意代码。README 提供了漏洞相关信息的链接。因此，投毒风险非常低，大约为 1%。argv可以从外部传入参数，用于设置 sleep 的时间。

**利用方式：**
攻击者需要控制应用程序的输入，使其能够调用 iconv 函数，并将字符串转换为 ISO-2022-CN-EXT 字符集。同时，攻击者还需要精心构造输入字符串，以便在溢出时覆盖关键内存区域，例如函数返回地址或其它重要的变量。搜索结果中的网页1提到“ This issue may allow an attacker to craft a malicious characters sequence that will trigger the out-of-bounds write and perform remote code execution.”

简单来说，利用方式如下：
1.  确定目标应用程序使用 iconv 函数进行字符集转换，且容易受到该漏洞的影响。
2.  构造恶意的输入字符串，触发溢出。
3.  控制溢出内容，覆盖目标内存区域，实现攻击目的，例如代码执行。

**项目地址:** [tnishiox/cve-2024-2961](https://github.com/tnishiox/cve-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)