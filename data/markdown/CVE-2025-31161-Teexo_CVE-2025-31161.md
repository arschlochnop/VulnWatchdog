## CVE-2025-31161 CrushFTP Authentication Bypass

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 严重，可能导致完全系统接管

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务器必须在受影响版本范围内，且可通过HTTP(S)访问，非DMZ代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中的一个身份验证绕过漏洞。攻击者可以通过构造畸形的 AWS4-HMAC 头部来绕过身份验证，从而以任何已知或可猜测的用户身份进行身份验证（例如 crushadmin），从而完全控制系统。漏洞存在于HTTP组件的AWS4-HMAC授权方法中，存在竞态条件，通过发送只包含用户名和斜杠的请求，服务器会成功找到用户名，但后续SignedHeaders验证失败，导致索引越界错误，阻止清理会话，从而绕过身份验证。

漏洞利用方式：
1.  向目标 CrushFTP 服务器发送特制的 HTTP 请求，该请求包含畸形的 AWS4-HMAC 头部，仅提供用户名和斜杠。
2.  服务器尝试使用提供的用户名进行身份验证，由于畸形的头部，身份验证过程中的某些检查会被绕过。
3.  攻击者成功以指定用户身份（如 crushadmin）进行身份验证。
4.  攻击者可以利用获得的管理员权限来执行任意操作，例如上传恶意文件、修改系统配置等，从而完全控制系统。

根据提供的POC代码，该代码是一个扫描器，用于检测目标是否存在CVE-2025-31161漏洞，而不是一个直接的利用工具。因此，投毒风险较低，主要集中在代码的扫描行为可能被用于恶意目的，如扫描大量目标进行信息收集。README.md中的`git clone https://github.com/yourusername/CVE-2025-31161.py`表明原始仓库可能并不存在，存在一定的钓鱼风险，诱导用户访问恶意仓库。

综合搜索结果，表明此漏洞已经在野外被利用，并且多个安全厂商提供了缓解措施和检测方法。

投毒风险分析：
* LICENSE文件声明了MIT许可，表明代码开源。
* README.md 文件描述了漏洞和使用方法，提示用户安装依赖`requirements.txt`。
* requirements.txt 文件中定义了requests和urllib3的版本要求，未发现恶意依赖。

可能的投毒点在于：
1.  作者可能在 CVE-2025-31161.py 文件中加入恶意代码，比如反弹shell，信息收集等。
2.  诱导用户访问恶意仓库，下载包含恶意代码的扫描器。

综合判断，该仓库本身投毒概率较低，但用户仍需谨慎分析 CVE-2025-31161.py 脚本，以及避免从不可信的来源下载工具，并且注意代码的潜在恶意行为。并且，该扫描器本身也可能被用于非授权的漏洞扫描。

**项目地址:** [Teexo/CVE-2025-31161](https://github.com/Teexo/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)