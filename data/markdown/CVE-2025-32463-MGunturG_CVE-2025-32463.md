## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= 版本 < 1.9.17p1

**利用条件:** 本地用户能够执行sudo命令，且sudo版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞存在于Sudo 1.9.14 到 1.9.17p1 之前的版本中。该漏洞允许本地用户通过 `--chroot` 选项，利用用户可控目录下的 `/etc/nsswitch.conf` 文件，从而获得 root 权限。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的本地提权漏洞，并且有公开的PoC存在 (github.com/kh4sh3i/CVE-2025-32463)。提供的PoC代码 `/tmp/b9e1aeeae10b3284680a578235614d86/README.md` 只是一个README文件，本身不包含任何利用代码，因此该文件本身不能证明POC的有效性。但是根据其他搜索结果表明漏洞的POC有效。

**投毒风险：**
提供的POC代码仅仅包含一个README文件，投毒风险较低。但是考虑到攻击者可能在其他的相关文件中添加恶意代码，因此不能完全排除投毒的可能。总体而言，投毒风险较低，大约10%。这个评估基于README文件内容简单，缺乏可疑的行为。如果仓库中存在其他脚本或者二进制文件，则需要进行更加细致的分析。

**利用方式：**
利用方式大致如下：
1.  **创建恶意 `/etc/nsswitch.conf`:** 在用户可控的目录下，创建一个恶意的 `/etc/nsswitch.conf` 文件，该文件配置了恶意的服务查找顺序，例如，指向一个由攻击者控制的共享库。
2.  **使用 `sudo --chroot`:**  使用 `sudo` 命令，并带上 `--chroot` 选项，指定将 chroot 目录设置为攻击者控制的目录。
3.  **触发共享库加载：**  当 `sudo` 在 chroot 环境中尝试执行名称服务查找时，会加载攻击者提供的恶意共享库。
4.  **权限提升：**  恶意共享库中的代码会在 root 权限下执行，从而允许攻击者获得 root 权限。

**参考资料:**
*   CVE-2025-32463 漏洞描述
*   相关的安全公告和博客文章。

**项目地址:** [MGunturG/CVE-2025-32463](https://github.com/MGunturG/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)