## CVE-2025-47226

**漏洞编号:** CVE-2025-47256

**漏洞类型:** 栈缓冲区溢出

**影响应用:** libxmp

**危害等级:** 高危，可能导致拒绝服务（DoS）或远程代码执行（RCE）

**影响版本:** 受影响版本未知，但存在于libxmp库中

**利用条件:** 需要能够加载恶意PHA或MOD文件，通常通过应用程序利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于libxmp库的`depack_pha()`函数中，当解析恶意的Pha Packer (PHA)模块文件时，由于对栈缓冲区的不正确边界检查，导致栈缓冲区溢出。攻击者可以构造一个恶意的.mod或.pha文件，并将其提供给任何链接了libxmp的应用程序，从而触发漏洞。POC代码通过`xmp_load_module_from_memory()`函数加载精心构造的恶意模块数据`poc_crash_mod`，触发栈溢出，导致程序崩溃或潜在的远程代码执行。虽然POC主要用于演示崩溃，但在真实攻击场景中，攻击者可能尝试覆盖返回地址或其他关键数据，以实现代码执行。投毒风险评估为10%，因为`poc_data.h`文件中包含十六进制数据，理论上存在被篡改的可能性，但概率较低，因为漏洞利用的有效性依赖于特定格式的文件结构。

**漏洞利用方式：**
1.  **漏洞定位：**  漏洞存在于`src/loaders/prowizard/pha.c`文件的`depack_pha()`函数中。
2.  **攻击向量：**  通过构造恶意的.mod或.pha文件，诱使用户使用受影响的应用程序打开。
3.  **利用过程：**  受影响的应用程序使用libxmp库解析恶意文件，在`depack_pha()`函数中触发栈缓冲区溢出。
4.  **攻击后果：**  可能导致应用程序崩溃（DoS），在某些情况下，可能导致远程代码执行（RCE）。
5.  **POC验证：**  提供的POC代码通过加载预先构造的恶意模块数据来触发漏洞，验证漏洞的存在性和影响。

**有效性评估：**
根据POC代码和描述，此漏洞利用是有效的，可以导致程序崩溃，并可能在特定条件下实现远程代码执行。


**项目地址:** [SexyShoelessGodofWar/CVE-2025-47256](https://github.com/SexyShoelessGodofWar/CVE-2025-47256)

**漏洞详情:** [CVE-2025-47256](https://nvd.nist.gov/vuln/detail/CVE-2025-47256)