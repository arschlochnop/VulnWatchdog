## CVE-2023-27350 - PaperCut NG/MF 身份验证绕过及远程代码执行

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 / 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 严重，允许未经身份验证的远程攻击者以 SYSTEM 权限执行任意代码。

**影响版本:** < 22.0.8

**利用条件:** 目标系统运行受影响版本的 PaperCut NG/MF，且攻击者可访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 漏洞存在于 PaperCut NG/MF 软件中，允许未经身份验证的攻击者绕过身份验证并远程执行代码。根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用方式如下：

1.  **身份验证绕过:** 攻击者利用 `SetupCompleted` Java类中的不当访问控制漏洞，通过构造特定的 HTTP 请求绕过身份验证，从而以管理员身份访问 PaperCut 服务器。
2.  **配置修改:** 绕过身份验证后，攻击者通过修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置项，启用打印脚本功能，并禁用沙盒环境。这为执行任意代码创造了条件。
3.  **远程代码执行:** 攻击者利用 PaperCut 软件自身提供的脚本执行功能，执行恶意的脚本代码，从而在服务器上执行任意命令。由于 PaperCut 服务器进程以 SYSTEM 或 root 权限运行，因此执行的命令也具有相应的权限。

**有效性:**

提供的POC代码通过发送特定的POST请求到 `/app?service=page/SetupCompleted` 绕过身份验证。成功后，它禁用打印脚本沙箱并启用打印和设备脚本，允许远程代码执行。PoC 包含检测漏洞是否存在的功能。

**投毒风险评估:**

该漏洞利用代码的 `README.md` 文件中包含警告信息，提示用户谨慎执行该脚本，因为它会重新配置服务器设置以执行命令。虽然脚本在退出时会尝试恢复更改，但在进程被错误终止时可能无法完全恢复。`exploit.py`没有发现恶意行为。但存在极小风险，脚本可能包含隐蔽的、难以检测的恶意代码，或者利用脚本执行远程恶意文件下载和执行。因此，投毒风险评估为 5%。建议在隔离环境中运行和分析该脚本。

**搜索引擎结果补充:**

搜索结果表明 CVE-2023-27350 漏洞被广泛利用，并已被 CISA 列入已知被利用的漏洞目录 (KEV)。多个安全厂商发布了相关的安全公告和分析报告，证实了该漏洞的严重性和利用价值。此外，有报告指出，Bloody 勒索软件团伙也利用该漏洞进行攻击。

**项目地址:** [monke443/CVE-2023-27350](https://github.com/monke443/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)