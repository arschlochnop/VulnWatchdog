## CVE-2020-9483-Apache SkyWalking-SQL注入

**漏洞编号:** CVE-2020-9483

**漏洞类型:** SQL注入

**影响应用:** Apache SkyWalking

**危害等级:** 高危，可能导致数据泄露和未授权访问

**影响版本:** 6.0.0 to 6.6.0, 7.0.0

**利用条件:** 需要使用H2/MySQL/TiDB作为存储，并且可通过GraphQL协议访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-9483是Apache SkyWalking在特定配置下存在的SQL注入漏洞。当SkyWalking使用H2/MySQL/TiDB作为存储，并通过GraphQL协议进行元数据查询时，由于未正确处理SQL参数，攻击者可以通过构造恶意的GraphQL查询语句执行任意SQL命令，从而访问未经授权的数据甚至可能执行代码。该漏洞影响SkyWalking 6.0.0到6.6.0以及7.0.0版本。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已确认的SQL注入漏洞，并且存在公开的PoC（例如，GitHub上的Neko-chanQwQ/CVE-2020-9483）。因此，可以判定存在有效的PoC代码。

**投毒风险：**
提供的漏洞利用代码是CHANGES.md和CODE_OF_CONDUCT.md文件，这些文件本身不包含任何恶意代码，不属于PoC代码，无法直接用于漏洞利用，因此投毒风险极低，仅为10%的可能性在于项目仓库的其他部分可能存在恶意代码，但从目前提供的信息无法判断。

**利用方式：**
利用方式如下：
1.  **环境确认：** 确认目标SkyWalking服务使用的存储为H2/MySQL/TiDB。
2.  **GraphQL接口：** 找到SkyWalking服务的GraphQL接口。
3.  **构造Payload：** 构造包含恶意SQL注入语句的GraphQL查询。例如，通过在查询参数中插入SQL片段，绕过验证或执行额外SQL命令。
4.  **发送请求：** 将构造好的GraphQL查询发送到目标接口。
5.  **获取结果：** 根据注入语句的不同，可能导致数据泄露，未授权访问，甚至在特定情况下执行任意代码。

**项目地址:** [shanika04/apache_skywalking](https://github.com/shanika04/apache_skywalking)

**漏洞详情:** [CVE-2020-9483](https://nvd.nist.gov/vuln/detail/CVE-2020-9483)