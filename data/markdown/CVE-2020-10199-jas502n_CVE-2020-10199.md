## CVE-2020-10199-Sonatype Nexus Repository-JavaEL注入导致远程代码执行

**漏洞编号:** CVE-2020-10199

**漏洞类型:** JavaEL注入

**影响应用:** Sonatype Nexus Repository

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.21.2

**利用条件:** 需要用户权限，低权限用户即可触发

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-10199是Sonatype Nexus Repository 3.21.2之前版本中存在的JavaEL注入漏洞。攻击者可以通过注入恶意的JavaEL表达式，利用Nexus Repository的功能（如创建仓库、更新用户）执行任意代码。从提供的漏洞利用代码来看，存在无需回显和需要回显的两种POC，利用`/service/rest/beta/repositories/go/group`路径，普通用户权限即可利用。CVE详情中提到了CWE-917，即表达式语言注入漏洞。

**有效性：** 根据提供的漏洞信息、搜索结果（尤其是Exploit-DB和Vulhub的描述）和漏洞利用代码，可以判断提供的POC代码是有效的。多个来源证实了该漏洞的存在以及利用的可行性。

**投毒风险：** 提供的漏洞利用代码中，简单命令执行`touch /tmp/cve-2020-10199`是用于验证漏洞的，不属于恶意投毒代码。提供的POC没有发现明显的恶意代码，因此可以判断投毒风险较低，约0%。

**利用方式：**

1.  **普通用户权限利用 (CVE-2020-10199):**
    *   通过向`/service/rest/beta/repositories/go/group`发送包含恶意JavaEL表达式的请求，触发远程代码执行。
    *   可以通过构造包含`''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('command')`的payload执行命令。

2.  **需要管理员权限利用 (CVE-2020-10204):**
    *   创建CleanupPolicy（`/service/extdirect`）。
    *   创建repositories（`/service/rest/beta/repositories/apt/hosted`）。
    *   利用更新用户接口（`/service/extdirect`）。
    *   利用创建角色接口（`/service/extdirect`）。

3. **权限绕过 (CVE-2020-11444):**
   * 调用更新role接口 `/service/rest/beta/security/users/admin/change-password` 修改密码。

**项目地址:** [jas502n/CVE-2020-10199](https://github.com/jas502n/CVE-2020-10199)

**漏洞详情:** [CVE-2020-10199](https://nvd.nist.gov/vuln/detail/CVE-2020-10199)