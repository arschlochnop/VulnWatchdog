## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 到 1.9.17p1 (不包含1.9.17p1)

**利用条件:** 需要本地用户权限，并且Sudo配置中使用了受限制的主机名或模式 (根据部分搜索结果)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463是Sudo中的一个本地提权漏洞，影响版本为1.9.14到1.9.17p1。该漏洞允许本地用户通过`--chroot`选项，利用用户可控目录下的`/etc/nsswitch.conf`文件获取root权限。

**有效性分析：**
根据漏洞描述和搜索结果，以及提供的POC代码，该漏洞利用是有效的。POC脚本创建了一个临时的目录结构，并在该结构中放置了一个恶意的`nsswitch.conf`文件和一个共享库`woot1337.so.2`。当`sudo -R woot woot` 命令被执行时，它会使用`--chroot`选项切换到临时目录，并加载恶意的`nsswitch.conf`文件，该文件指定使用`libnss_/woot1337.so.2`。这个共享库包含一个构造函数`woot()`，该函数将当前用户的UID和GID设置为0，并执行一个shell，从而实现提权。

**投毒风险分析：**
分析提供的POC代码后，没有发现明显的投毒代码。该脚本的行为与其漏洞利用的目的相符，即通过创建一个恶意的chroot环境并利用nsswitch.conf来加载恶意共享库以获取root权限。脚本的主要功能是创建一个临时目录，生成恶意文件，然后调用sudo来触发漏洞。

**利用方式：**
1.  **准备环境：** 创建一个临时目录，并在其中创建`woot/etc/nsswitch.conf`文件。这个文件指定了自定义的密码数据库查找顺序，指向恶意共享库`libnss_/woot1337.so.2`。
2.  **创建恶意共享库：** 编译一个包含`woot()`函数的共享库。该函数的功能是将用户的UID和GID设置为0，然后执行一个shell。
3.  **触发漏洞：** 使用`sudo -R woot woot`命令，该命令会使用`--chroot`选项切换到临时目录，并加载恶意的`nsswitch.conf`文件，从而加载恶意共享库，执行提权操作。

简而言之，该漏洞允许攻击者通过精心构造的`nsswitch.conf`文件劫持Sudo的库加载过程，从而执行任意代码并获取root权限。

**项目地址:** [ChetanKomal/sudo_exploit](https://github.com/ChetanKomal/sudo_exploit)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)