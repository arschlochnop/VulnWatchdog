## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过 RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令。

**影响版本:** BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于 11.6.5)

**利用条件:** 目标系统运行存在漏洞的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是 F5 BIG-IP 设备中的一个严重漏洞，允许未经身份验证的攻击者绕过 iControl REST API 的身份验证，并在目标系统上执行任意命令。根据漏洞信息和搜索结果，该漏洞已被积极利用。提供的POC代码展示了利用该漏洞的一种方法。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断提供的POC代码是有效的。POC代码通过向`/mgmt/tm/util/bash`端点发送精心构造的POST请求，绕过身份验证，执行任意bash命令。`X-F5-Auth-Token`和`Authorization`头被用来绕过身份验证。

**投毒风险：**
该漏洞利用代码直接发送bash命令，未发现作者隐藏其他恶意代码，投毒可能性为0%。

**利用方式：**
1.  攻击者构造一个包含要执行的命令的POST请求，目标是`/mgmt/tm/util/bash`端点。
2.  在请求头中设置`X-F5-Auth-Token: Exploit`以尝试绕过身份验证检查。
3.  如果目标系统存在漏洞，iControl REST API将允许执行请求中的bash命令。
4.  攻击者可以利用此漏洞执行任意系统命令，例如添加用户、安装后门或窃取敏感信息。

**项目地址:** [Vulnmachines/F5-Big-IP-CVE-2022-1388](https://github.com/Vulnmachines/F5-Big-IP-CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)