## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2 之前, 4.x 4.1.14.2 之前, 和 4.2.x 4.2.5.2 之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，并且应用程序允许使用render方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails Action Pack 中，由于其 render 方法对用户输入未做严格限制，导致远程攻击者可以利用此漏洞执行任意 Ruby 代码，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。漏洞库信息，搜索引擎结果以及利用代码都表明可以通过`render`方法执行任意ruby代码。例如，可以使用`curl`发送包含恶意代码的请求，服务器会执行该代码。

**投毒风险：**
查看提供的 POC 代码 `/tmp/fb84a5f2be1c3ed581440d890e43983b/ruby-on-rail-RCE.sh`，该脚本主要功能是发送包含ruby代码的curl请求，执行用户指定的命令。脚本本身没有明显的恶意行为，例如反弹shell或下载其他恶意文件。因此，投毒风险较低，但考虑到脚本的执行环境和权限，以及可能被用于自动化攻击，存在一定风险。`/tmp/fb84a5f2be1c3ed581440d890e43983b/README.md`文件只是漏洞描述和使用说明，不存在投毒代码。总体评估风险比例为5%。

**利用方式：**
1.  攻击者需要找到一个使用了存在漏洞的Rails版本，并且允许使用render方法的应用程序。
2.  攻击者通过构造恶意的URL，将payload传递给`render`方法。 Payload形式是 `%3C%25=%20%25x('command')%20%25%3E`。 其中`command`参数是要在目标服务器上执行的命令。
3.  目标服务器在处理请求时，会执行该恶意Ruby代码，从而执行攻击者指定的命令。

**项目地址:** [Debalinax64/CVE-2016-2098](https://github.com/Debalinax64/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)