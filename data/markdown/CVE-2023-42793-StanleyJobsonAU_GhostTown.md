## CVE-2023-42793-JetBrains TeamCity-RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个身份验证绕过漏洞，允许未经身份验证的攻击者远程执行代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8（严重），并且已被积极利用。搜索结果表明，包括APT29、朝鲜黑客组织以及俄罗斯对外情报局（SVR）等多个威胁组织都在利用此漏洞。提供的POC代码 `GhostTown.py` 旨在利用此漏洞。利用方式如下：

1.  **生成管理员Token：** POC首先尝试通过 `/app/rest/users/id:1/tokens/RPC2` 接口创建一个管理员Token。这将绕过身份验证。
2.  **检索内部配置：** 使用生成的管理员Token，POC尝试从 `/get/file/dataDir/config/internal.properties` 接口检索TeamCity的内部配置。
3.  **更新配置：** POC会检查配置项中是否包含 `rest.debug.processes.enable=true`，如果不存在，则将其添加到配置项中，并通过 `/get/file/dataDir/config/internal.properties` 接口更新配置。`rest.debug.processes.enable=true` 配置的目的是允许执行调试进程，这为远程代码执行铺平了道路。(这部分未在提供的代码片段中。)
4. **远程代码执行：** 启用调试进程允许攻击者通过构造特定的请求来执行任意命令。

**有效性：** 根据漏洞信息和搜索结果，此POC代码有效，能够利用CVE-2023-42793漏洞实现RCE。

**投毒风险：** 检查提供的代码，主要逻辑集中在利用漏洞上，没有发现明显的恶意代码或后门。该代码是为了验证漏洞存在，并帮助安全研究人员和管理员修复漏洞，存在投毒代码的可能性较低。


**项目地址:** [StanleyJobsonAU/GhostTown](https://github.com/StanleyJobsonAU/GhostTown)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)