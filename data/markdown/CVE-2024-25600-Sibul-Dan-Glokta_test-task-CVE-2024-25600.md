## CVE-2024-25600 - WordPress Bricks Builder 远程代码执行

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WordPress Bricks Builder

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要安装并启用 Bricks Builder 插件，且版本低于或等于 1.9.6。目标WordPress实例需要能够被网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25600 是 WordPress Bricks Builder 插件中的一个未经身份验证的远程代码执行 (RCE) 漏洞。攻击者可以利用此漏洞注入并执行任意 PHP 代码。漏洞存在于插件处理用户输入的方式中，允许攻击者绕过安全检查并执行恶意代码。

**有效性分析：**

提供的 POC 代码看起来有效。漏洞库信息和搜索结果都确认了该漏洞的存在，并且提供了可用的利用代码的 GitHub 链接。POC 代码 `exploit.py` 尝试利用该漏洞，通过构造特制的请求来触发代码注入。

**投毒风险分析：**

提供的代码仓库主要包含 Docker 部署配置和一个用于利用漏洞的 Python 脚本 `exploit.py`。经过对 `exploit.py` 的检查，没有发现明显的投毒代码。脚本的主要功能是利用漏洞执行命令，没有额外恶意行为。因此，投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞定位：** 漏洞存在于 Bricks Builder 插件中，允许未经身份验证的攻击者执行远程代码。
2.  **Nonce 获取：** POC 首先尝试从目标网站获取 nonce 值，该值用于绕过某些安全检查。通过请求网站首页并解析 HTML 中的 `bricks-scripts-js-extra` 脚本标签来提取 nonce。
3.  **Payload 构造：** POC 构造一个包含恶意 PHP 代码的 JSON payload。这个 payload 利用了 Bricks Builder 插件在处理特定元素（如 carousel, container, generic, code）的配置时存在的漏洞。
4.  **请求发送：** POC 将构造的 JSON payload 发送到 `/wp-json/bricks/v1/render_element` 或 `/?rest_route=/bricks/v1/render_element` 端点。这个请求会触发插件处理 payload 中的恶意代码。
5.  **代码执行：** 插件在处理请求时，会执行 payload 中的 PHP 代码，从而允许攻击者在服务器上执行任意命令。
6.  **结果获取：** POC 会捕获执行命令后的输出，并将其显示给攻击者。`exploit.py` 通过命令 `whoami` 来验证漏洞利用是否成功。

总之，该漏洞允许未经身份验证的攻击者通过构造特制请求，在受影响的 WordPress 站点上执行任意代码，从而完全控制服务器。

**项目地址:** [Sibul-Dan-Glokta/test-task-CVE-2024-25600](https://github.com/Sibul-Dan-Glokta/test-task-CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)