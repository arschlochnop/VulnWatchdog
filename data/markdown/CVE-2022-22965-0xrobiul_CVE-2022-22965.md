## CVE-2022-22965 Spring4Shell RCE

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat WAR deployment, Spring MVC or Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和漏洞利用代码，评估如下：

**有效性：**
CVE-2022-22965 (Spring4Shell) 是一个远程代码执行漏洞，影响运行在 JDK 9+ 上的 Spring MVC 或 Spring WebFlux 应用，并且这些应用需要部署为 Tomcat WAR 包。搜索引擎结果表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含 GNU GPL 协议，不包含任何与漏洞利用相关的代码。无法通过此代码分析是否存在投毒风险。由于提供的代码并非实际的POC代码，因此投毒风险评估为0%。实际环境中利用代码可能存在投毒，但需进一步分析具体POC代码才能判断。

**利用方式：**
漏洞利用方式主要涉及利用数据绑定机制，通过构造恶意的 HTTP 请求，修改 Tomcat 的日志配置，将日志输出到 Web 目录，然后写入恶意 JSP 代码，最终实现远程代码执行。攻击者通过精心构造的请求参数，利用 Spring 框架的数据绑定功能，修改 `class.module.classLoader.resources.context.parent.pipeline.first.pattern` 和其他相关属性来实现 RCE。一些利用方式还涉及 Spring Expression Language (SpEL) 注入。

**排序优先级理由：**
*   **搜索引擎结果：** 优先级最高，因为它们提供了关于该漏洞的实际利用情况和影响的最新信息，包括已被积极利用的证据。
*   **漏洞利用代码：** 优先级第二，因为真实的POC代码能提供最直接的漏洞利用方式验证，但本次提供的不是有效POC代码，无法有效分析漏洞。
*   **漏洞库信息：** 优先级最低，因为它们通常只提供漏洞的概要描述，而不提供实际的利用细节。


**项目地址:** [0xrobiul/CVE-2022-22965](https://github.com/0xrobiul/CVE-2022-22965)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)