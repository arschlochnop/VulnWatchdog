## CVE-2014-6271 Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或通过其他方式设置环境变量并调用Bash

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过特制的通过环境变量执行任意命令。利用方式如下：

1.  **有效性：** 提供的Python和Bash脚本都是有效的PoC代码。它们通过设置包含恶意代码的环境变量，然后尝试通过HTTP请求触发漏洞。
2.  **投毒风险：** 尽管代码主要用于利用Shellshock漏洞，但仍然存在轻微的投毒风险。具体分析如下：
    *   **README.md:**  该文件仅包含使用说明，无投毒代码。
    *   **shellshock.py:** Python脚本通过`requests`库发送HTTP请求，如果攻击者的服务器被攻陷，或者服务器返回恶意重定向，那么可能存在风险。但是代码本身没有明显的恶意代码。
    *   **shellshock.sh:** Bash脚本使用`curl`命令，同样存在curl命令被其他程序劫持，或者DNS投毒的风险。
    *  脚本接受用户提供的URL、LHOST和LPORT，如果用户使用了恶意的URL，可能会被服务器端记录或者进行其他攻击。这些不是脚本投毒，而是用户使用不当造成的。
    综合分析，主要风险在于依赖的外部命令(`curl`,`requests`)可能存在风险，以及用户使用脚本不当的风险,投毒风险较低，初步判定为10%。
3.  **利用方式：**
    *   **通过User-Agent头：**  PoC代码通过修改HTTP请求的User-Agent头，将包含恶意代码的环境变量发送到目标服务器。如果目标服务器上的CGI脚本或其他应用程序调用Bash来处理该请求，那么恶意代码就会被执行。
    *   **反弹Shell：**  PoC代码可以配置LHOST和LPORT参数，用于接收目标服务器的反弹Shell。攻击者可以在自己的机器上监听指定的端口，当目标服务器执行恶意代码时，会主动连接攻击者的机器，从而建立反弹Shell连接。
    *   **交互式命令执行：**  PoC代码也支持交互式命令执行。攻击者可以输入任意命令，PoC代码会将命令注入到环境变量中，并发送到目标服务器执行。

**搜索引擎结果补充：** 搜索引擎结果证实了该漏洞的严重性和广泛影响，并提供了一些检测和利用该漏洞的资源。

**项目地址:** [Gurguii/cgi-bin-shellshock](https://github.com/Gurguii/cgi-bin-shellshock)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)