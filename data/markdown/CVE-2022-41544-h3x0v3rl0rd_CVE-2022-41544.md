## CVE-2022-41544-GetSimple CMS-RCE

**漏洞编号:** CVE-2022-41544

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GetSimple CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.3.16

**利用条件:** 需要目标GetSimple CMS版本为3.3.16且admin目录可访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-41544是GetSimple CMS v3.3.16中的一个远程代码执行漏洞，位于`admin/theme-edit.php`的`edited_file`参数中。攻击者通过精心构造`edited_file`参数，可以上传恶意PHP脚本到服务器上，从而执行任意代码。

**利用方式：**

1.  **版本检测：** 脚本首先尝试通过访问`admin/index.php`页面并匹配`jquery.getsimple.js`的版本号来确定目标GetSimple CMS的版本。
2.  **API Key泄露：** 脚本尝试从`data/other/authorization.xml`文件中获取API Key。
3.  **Cookie设置：** 使用用户名，版本号和API Key生成用于身份验证的Cookie。
4.  **CSRF Token获取：** 脚本通过访问`admin/theme-edit.php`页面并正则匹配获取CSRF token。
5.  **Shell上传：** 脚本构造一个POST请求，其中包含恶意的PHP代码（反向shell），将其上传到`../shell.php`。`edited_file`参数用于指定上传的文件路径。
6.  **Shell触发：** 脚本尝试访问上传的`shell.php`文件，从而触发反向shell，攻击者即可获取服务器的控制权。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞存在并且可以被利用。提供的POC代码尝试自动化漏洞利用过程，包括版本检测、API Key泄露、Cookie设置、CSRF Token获取、Shell上传和Shell触发。因此，该POC代码**有效**，可以用于验证漏洞并获取服务器控制权。

**投毒风险：**

查看提供的Python脚本。脚本的功能是利用 CVE-2022-41544 漏洞在目标服务器上部署一个反向 Shell。反向 Shell 的 IP 地址和端口来自命令行参数，攻击者借此连接到目标服务器。

脚本行为符合漏洞描述和利用流程，**未发现作者额外添加恶意代码（投毒代码）**，用于攻击利用者的机器。因此，该仓库中**不存在**作者隐藏的投毒代码的可能性较高。投毒风险为0%。


**项目地址:** [h3x0v3rl0rd/CVE-2022-41544](https://github.com/h3x0v3rl0rd/CVE-2022-41544)

**漏洞详情:** [CVE-2022-41544](https://nvd.nist.gov/vuln/detail/CVE-2022-41544)