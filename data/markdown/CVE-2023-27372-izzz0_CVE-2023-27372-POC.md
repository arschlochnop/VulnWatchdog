## CVE-2023-27372-SPIP远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1

**利用条件:** 目标服务器运行存在漏洞的SPIP版本，且漏洞利用发生在公共区域，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372是SPIP 4.2.1之前版本中的一个远程代码执行漏洞。该漏洞是由于SPIP处理表单值中的序列化数据不当造成的。攻击者可以通过在公共区域提交包含恶意序列化数据的表单值来利用此漏洞，从而执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码通过构造特定的POST请求，向`spip.php?page=spip_pass`页面提交包含恶意PHP代码的序列化字符串，利用SPIP的反序列化漏洞执行代码。如果服务器返回包含`phpinfo()`结果的页面，则表明存在漏洞。

**投毒风险：**
代码主体逻辑是漏洞验证，风险较低。但仍然存在一定的投毒风险，因为攻击者可能修改POC代码，使其包含恶意操作，例如：

*   **植入后门:** POC中可以加入执行任意系统命令的代码，从而在目标服务器上植入后门。
*   **数据窃取:** POC可以被修改为窃取服务器上的敏感数据，例如数据库凭据或配置文件。
*   **拒绝服务攻击:** POC可以被修改为发送大量请求，导致目标服务器过载，从而造成拒绝服务攻击。
POC 使用 phpinfo() 验证，比较安全，但潜在风险依然存在。因此，投毒风险评估为10%。

**利用方式：**
1.  确定目标网站运行的SPIP版本低于4.2.1。
2.  向`spip.php?page=spip_pass`页面发送包含以下参数的POST请求：
    *   `formulaire_action=oubli`
    *   `formulaire_action_args`：从页面中提取的`formulaire_action_args`字段的值，进行URL编码。
    *   `oubli`: 包含恶意PHP代码的序列化字符串，例如`s:19:"<?php phpinfo(); ?>";`
    *   `nobot`：任意值，用于绕过反爬机制
3.  如果服务器返回包含恶意PHP代码执行结果的页面，则表明漏洞利用成功。例如，如果使用`phpinfo()`，则会返回phpinfo页面，或者反序列化任意类的函数，执行恶意代码。

**项目地址:** [izzz0/CVE-2023-27372-POC](https://github.com/izzz0/CVE-2023-27372-POC)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)