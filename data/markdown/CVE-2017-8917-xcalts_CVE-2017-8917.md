## CVE-2017-8917 - Joomla! SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla!

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 需要目标Joomla!站点版本在受影响范围内，且网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8917是Joomla! 3.7.x版本（在3.7.1之前）中存在的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用未充分过滤的输入参数，执行任意SQL命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码是有效的。搜索引擎结果中多个来源确认了漏洞的存在，并提供了相关的描述和缓解措施。漏洞利用代码是一个Python脚本，它利用时间盲注技术来提取数据库信息。

**投毒风险：**
POC代码本身主要实现了SQL注入漏洞的验证与利用，用于提取数据库名称、用户、表等信息。风险点主要集中在以下几个方面：
* **代理设置（PROXIES）：**POC代码中包含代理设置，如果攻击者修改代理地址指向恶意服务器，可能会导致信息泄露。
* **请求头修改：**如果POC代码被修改为添加恶意请求头，可能导致服务器端受到攻击。
* **代码执行：**如果POC代码被修改为包含恶意代码，例如执行系统命令，将会产生严重危害。
* **依赖库投毒：**攻击者可能通过篡改requests等依赖库来达到恶意目的。
虽然存在风险，但未发现明显的恶意代码。综合评估，投毒风险估计为10%。

**利用方式：**
1.  **获取CSRF Token:** 脚本首先从登录页面获取CSRF token，用于后续的请求。
2.  **时间盲注:** 脚本使用时间盲注技术来确认SQL注入漏洞的存在。它通过构造包含`SLEEP()`函数的SQL语句，并观察响应时间来判断条件是否成立。
3.  **信息提取:** 脚本通过逐个字符地猜测数据库名称、用户、表名等信息。它构造包含`substring()`和`ascii()`函数的SQL语句，并结合时间盲注来判断猜测是否正确。
4.  **漏洞点:** 漏洞位于`com_fields`组件中，通过`list[fullordering]`参数传递恶意SQL语句。

**项目地址:** [xcalts/CVE-2017-8917](https://github.com/xcalts/CVE-2017-8917)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)