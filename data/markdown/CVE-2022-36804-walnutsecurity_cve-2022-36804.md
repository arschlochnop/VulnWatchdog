## CVE-2022-36804-Atlassian Bitbucket Server/Data Center-命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server/Data Center

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <7.6.17, <7.17.10, <7.21.4, <8.0.3, <8.1.3, <8.2.2, and <8.3.1

**利用条件:** 需要对公共仓库的访问权限，或对私有仓库的读取权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-36804 是 Atlassian Bitbucket Server 和 Data Center 中多个 API 接口存在的一个命令注入漏洞。攻击者通过发送恶意的HTTP请求，可以执行任意代码。漏洞利用方式为：

1.  **漏洞原理：**  由于Bitbucket Server和Data Center在处理特定API请求时，未对用户可控的输入进行充分的过滤，导致攻击者可以在操作系统层面执行恶意命令。
2.  **利用方式：**
    *   攻击者需要具有对公共仓库的访问权限，或者对私有仓库的读取权限。
    *   攻击者构造包含恶意命令的HTTP请求，发送到存在漏洞的API接口。
    *   服务器在处理该请求时，由于输入未经过滤，将恶意命令传递给操作系统执行，从而导致远程代码执行。
3.  **POC有效性：** 提供的POC代码通过docker环境搭建了存在漏洞的Bitbucket Server，并提供了Python脚本，可以通过HTTP请求执行命令，证明该漏洞利用代码有效。
4.  **投毒风险分析：**
该漏洞利用代码本身的功能是验证和利用漏洞，并未发现明显的恶意代码或后门。 但是因为此漏洞是RCE类型漏洞，可以通过命令注入的方式植入后门，所以存在一定的风险。
*Dockerfile* 用于搭建漏洞环境，脚本用于测试漏洞是否可以利用，所以该项目投毒风险较低.

  **搜索引擎结果佐证：**  多个搜索结果(Rapid7, AssetNote, Sangfor等)都证实了该漏洞的存在以及远程代码执行的能力。

**项目地址:** [walnutsecurity/cve-2022-36804](https://github.com/walnutsecurity/cve-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)