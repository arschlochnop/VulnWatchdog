## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并且CGI脚本已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。攻击者可以通过构造包含特殊字符（如 URL 编码的 '..', 即 '%2e' 或 '%32%65'）的恶意 URL，绕过 Alias-like 指令配置的目录限制，访问服务器上的任意文件。如果服务器配置允许 CGI 脚本执行，攻击者还可以利用该漏洞执行任意代码。

**利用方式：**

1.  **路径遍历（LFI）:** 攻击者可以使用包含编码后的 '..' 序列的 URL 来访问服务器上的敏感文件，例如 `/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
2.  **远程代码执行（RCE）:** 如果目标服务器的 `/cgi-bin/` 目录启用了 CGI 脚本执行，攻击者可以通过上传恶意脚本并使用路径遍历漏洞来执行它们，例如 `curl 'http://localhost:81/cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh' --data 'echo Content-Type: text/plain; echo; whoami'`。

**有效性：**

根据漏洞库信息和搜索结果，提供的 POC 代码是有效的。漏洞库信息中明确指出此漏洞已被在野利用，搜索结果中也提供了大量关于该漏洞的分析和利用方法，POC可以复现LFI和RCE。

**投毒风险：**

此仓库存在轻微的投毒风险（5%），因为攻击者可能会修改 Dockerfile 或 httpd.conf 文件，例如添加恶意的反弹shell脚本到CGI目录，或修改httpd.conf 允许所有目录可访问。 正常的POC验证不会有这种行为, 但是总体上，该仓库主要用于漏洞演示和利用，恶意代码的可能性较低，用户在搭建环境和使用POC时，应该注意检查 Dockerfile 和 httpd.conf 文件。

**项目地址:** [0xc4t/CVE-2021-41773](https://github.com/0xc4t/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)