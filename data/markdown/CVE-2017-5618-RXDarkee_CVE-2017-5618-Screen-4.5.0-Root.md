## CVE-2017-5618-GNU screen-权限提升

**漏洞编号:** CVE-2017-5618

**漏洞类型:** 权限提升

**影响应用:** GNU screen

**危害等级:** 高危，可能导致本地用户获取 root 权限

**影响版本:** < 4.5.1

**利用条件:** 本地用户访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5618 是 GNU screen 4.5.1 之前版本中的一个漏洞，允许本地用户通过利用日志文件权限检查不当来修改任意文件，从而获得 root 权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是存在的，并且存在利用代码。搜索结果中[webpage 6]提到了利用 Screen 4.5.0 版本进行提权。

**投毒风险：**
提供的 POC 代码片段是 GNU GPL v3 许可证文本，并非漏洞利用代码。因此，直接从这段代码中分析投毒风险没有意义。一般 Screen 的 PoC 会涉及编译一个恶意动态链接库，或者生成恶意配置文件。考虑到作者可能在其他配套的脚本或者文件（如果存在）中加入恶意代码，因此认为存在一定的投毒风险，可能性估计为10%。

**利用方式：**
该漏洞的利用方式是利用 `screen` 程序在写入日志文件时，没有正确检查目标文件的权限，导致普通用户可以将日志写入到任意文件，例如 `LD_PRELOAD` 环境变量指向的文件。通过这种方式，攻击者可以劫持其他程序的执行流程，加载恶意的动态链接库，从而执行任意代码。更具体地说，攻击者可以：

1.  创建一个恶意的动态链接库，其中包含攻击者想要执行的代码。
2.  利用该漏洞将 `LD_PRELOAD` 环境变量设置为指向该恶意库。
3.  当 root 用户执行某些程序时，该恶意库将被加载，攻击者的代码将在 root 权限下执行，从而获取 root 权限。

**项目地址:** [RXDarkee/CVE-2017-5618-Screen-4.5.0-Root](https://github.com/RXDarkee/CVE-2017-5618-Screen-4.5.0-Root)

**漏洞详情:** [CVE-2017-5618](https://nvd.nist.gov/vuln/detail/CVE-2017-5618)