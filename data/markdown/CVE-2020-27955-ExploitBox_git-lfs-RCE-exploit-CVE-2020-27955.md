## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中。攻击者可以通过构造包含恶意`.gitattributes`文件和恶意LFS对象的Git仓库，当受害者clone该仓库时，会导致远程代码执行。

**有效性分析：** 提供的POC代码有效。`git.bat`脚本中，首先创建了一个名为`GITHACKED`的测试文件，证明了代码执行。随后，脚本尝试执行`revsh_powersh.ps1`，这是一个PowerShell反向Shell脚本，攻击者可以通过修改`revsh_powersh.ps1`中的IP地址和端口来接收shell。

**投毒风险分析：** `revsh_powersh.ps1` 脚本存在一定投毒风险，因为它直接执行了远程shell连接。尽管提供了`calc.exe`作为测试，但是作者鼓励使用反向shell。 这种风险占比大约 10%。 如果用户没有意识到，可能会在受害者主机上植入恶意程序。

**利用方式：**
1.  攻击者创建一个包含`.gitattributes`文件的恶意Git仓库，`.gitattributes`文件将特定文件类型与`git lfs`关联。
2.  攻击者创建一个恶意LFS对象，该对象实际上是一个可执行脚本 (例如，`git.bat` 或 `revsh_powersh.ps1`)，当`git lfs`尝试处理该对象时，会执行该脚本。
3.  攻击者将恶意仓库上传到公共或私有Git服务器。
4.  受害者克隆该仓库，如果受害者安装了Git LFS 2.12.0版本，并且系统是Windows，LFS会尝试处理恶意LFS对象，从而触发远程代码执行。
5.  如果`revsh_powersh.ps1`中的反向shell成功执行，攻击者可以获得受害者主机的控制权。

**项目地址:** [ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955](https://github.com/ExploitBox/git-lfs-RCE-exploit-CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)