## CVE-2024-38063-Windows TCP/IP 远程代码执行

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，允许远程攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, 以及 Windows Server 2008 到 2022 的多个版本，详见CVE描述中的受影响版本范围。

**利用条件:** 目标系统需要启用IPv6。攻击者需要能够通过网络发送特制的IPv6数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38063 是一个 Windows TCP/IP 远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分高达9.8，属于危急漏洞，允许未经身份验证的远程攻击者在受影响的系统上执行任意代码。利用方式是通过构造恶意的IPv6数据包，该数据包包含特殊的IPv6扩展头部和分片，当目标系统解析这些数据包时，会导致整数下溢，进而触发内存损坏，最终导致远程代码执行。

提供的漏洞利用代码（`2.py`和`rce.py`）均使用了`scapy`库来构造并发送恶意IPv6数据包。代码通过设置IPv6扩展头部（IPv6ExtHdrDestOpt和IPv6ExtHdrFragment）和包含shellcode的payload，来触发漏洞。代码通过循环发送大量构造好的数据包，增加漏洞触发的概率。

**有效性：**
根据漏洞描述和POC代码的实现，该漏洞利用代码具备较高的有效性，能够触发目标系统的远程代码执行。

**投毒风险：**
提供的两个Python脚本，`2.py`和`rce.py`，基本相同，功能都是生成并发送恶意IPv6数据包来利用CVE-2024-38063漏洞。它们都使用`scapy`库构造数据包，并在数据包中嵌入shellcode。该shellcode本身的功能是连接到`https://www.youtube.com` ，该操作可能只是用于演示，并没有发现任何明显的投毒代码。脚本的行为符合漏洞利用的预期，没有发现额外的恶意行为。虽然shellcode可以被替换为任何代码，但这不属于投毒行为，而是漏洞利用本身的一部分。因此，投毒风险较低。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址和MAC地址（如果需要，根据代码中的`mac_addr`变量判断）。
2.  攻击者配置POC脚本，指定目标IP地址、MAC地址（如果需要）和网络接口。
3.  攻击者运行POC脚本，脚本会生成并发送大量的恶意IPv6数据包。
4.  目标系统接收到恶意数据包后，TCP/IP协议栈在处理这些数据包时触发漏洞，导致远程代码执行。
5.  嵌入在数据包中的shellcode在目标系统上执行，实现攻击者的目的（例如，执行恶意命令、植入后门等）。

**项目地址:** [AliHj98/cve-2024-38063-Anonyvader](https://github.com/AliHj98/cve-2024-38063-Anonyvader)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)