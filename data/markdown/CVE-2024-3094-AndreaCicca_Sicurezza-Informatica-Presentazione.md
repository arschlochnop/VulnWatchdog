## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 高危，允许未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统需使用受影响的XZ Utils版本，且SSHD链接到libsystemd并作为systemd服务运行在x86-64 Linux系统上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 描述了在XZ Utils 5.6.0和5.6.1版本中发现的后门。攻击者通过精心构造的恶意代码，在liblzma的构建过程中插入预编译的对象文件，从而修改了liblzma的代码。该后门主要影响使用SSH服务的系统，通过替换OpenSSH的RSA_decrypt函数，攻击者可以验证并执行使用其私钥签名的命令，从而实现未经授权的远程访问。

**有效性：**
漏洞利用代码（提供的md文档）本身并不是直接可执行的exploit代码，而是对漏洞事件的描述、分析和总结，因此不能直接用于验证漏洞。但是，根据漏洞库信息和搜索引擎结果，确认该漏洞是真实存在的，且具有严重的危害。

**投毒风险：**
提供的漏洞利用代码（md文档）是对漏洞的描述和分析，并非后门代码本身，因此不存在投毒风险。仓库中作者隐藏投毒代码的可能性极低 (0%)，因为这个md文件更像是一个分析报告。

**利用方式：**
该漏洞的利用方式非常复杂，攻击者首先通过社会工程学手段获取了XZ Utils项目的贡献权限，然后逐步引入恶意代码，并利用一系列复杂的混淆技术隐藏了后门。后门通过修改liblzma的构建过程，在OpenSSH的RSA_decrypt函数中插入恶意代码，从而允许攻击者绕过SSH身份验证，执行任意命令。

**总结：**
CVE-2024-3094是一个典型的供应链攻击案例，攻击者利用了开源项目的脆弱性，成功地将恶意代码注入到广泛使用的软件库中。该漏洞具有极高的危害性，可能导致大量系统被远程控制。尽管该漏洞已被发现并修复，但它也提醒我们，需要加强对开源软件的安全性审计和供应链安全管理。

**项目地址:** [AndreaCicca/Sicurezza-Informatica-Presentazione](https://github.com/AndreaCicca/Sicurezza-Informatica-Presentazione)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)