## CVE-2023-44487 - HTTP/2 Rapid Reset 攻击

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议实现

**危害等级:** 高危，可能导致服务器资源耗尽，服务不可用

**影响版本:** 受影响的 HTTP/2 协议实现，具体版本取决于实现

**利用条件:** 目标服务器必须支持 HTTP/2 协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-44487 是一种针对 HTTP/2 协议的拒绝服务攻击，也称为 Rapid Reset 攻击。攻击者通过快速建立和重置 HTTP/2 流，使服务器消耗大量资源，最终导致服务不可用。该漏洞的利用方式如下：

1.  **建立 HTTP/2 连接：** 攻击者首先与目标服务器建立一个 HTTP/2 连接。
2.  **快速创建和重置流：** 攻击者在单个 HTTP/2 连接上，不断地创建新的流，并立即发送 `RST_STREAM` 帧来重置这些流。由于流的创建速度极快，服务器需要分配大量的资源来处理这些流，即使它们很快就被重置了。
3.  **资源耗尽：** 大量快速创建和重置的流会导致服务器的 CPU、内存和网络资源被迅速耗尽，从而导致服务器性能下降，最终拒绝服务。

**有效性：**

提供的 PoC 代码看起来是有效的。它通过模拟 Rapid Reset 攻击的行为，即快速发送 `RST_STREAM` 帧，来测试目标服务器是否容易受到 CVE-2023-44487 的影响。

根据漏洞库信息和搜索结果，此漏洞已经在野外被利用过，并且多个厂商发布了安全公告和补丁。因此，该漏洞的利用是有效的，可以对未修复的服务器造成拒绝服务。

**投毒风险：**

该 PoC 代码的投毒风险较低，约为 10%。

*   **代码逻辑：** 代码主要功能是发送构造好的HTTP/2请求，快速创建和重置stream，没有发现明显的恶意操作，例如：反弹shell、上传文件等高危操作。
*   **依赖分析：** PoC依赖的库包括httpx, h2, tqdm, xlsxwriter。这些库都是常见的python库，被篡改投毒的可能性较低。
*   **作者信息：** 作者提供了联系方式和组织信息，增加了一定的可信度。
*   **安全免责声明：** PoC代码中声明了仅用于安全测试，禁止用于非法用途，一定程度上降低了恶意使用的可能性。

但仍存在一定风险：

*   **滥用风险：** 即使代码本身没有恶意代码，攻击者仍然可以使用此 PoC 对未经授权的服务器进行拒绝服务攻击。
*   **隐藏的细微恶意代码：** 代码仍然有可能包含一些不易察觉的恶意代码，例如，在特定条件下触发的资源消耗型操作，或信息搜集代码。由于代码量较大，人工审计难以保证完全发现。
*   **供应链投毒风险：** 尽管直接依赖的库风险较低，但这些库本身可能依赖其他库，存在供应链投毒的潜在风险。

**利用方式总结：**

该漏洞的利用方式是攻击者与目标服务器建立 HTTP/2 连接，然后在该连接上快速创建新的流并立即重置这些流。这种快速的创建和重置流的操作会消耗服务器资源，导致拒绝服务。攻击者可以利用此 PoC 来测试服务器是否存在此漏洞，如果存在，则可能遭受拒绝服务攻击。

**项目地址:** [threatlabindonesia/CVE-2023-44487-HTTP-2-Rapid-Reset-Exploit-PoC](https://github.com/threatlabindonesia/CVE-2023-44487-HTTP-2-Rapid-Reset-Exploit-PoC)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)