## CVE-2025-31644-F5 BIG-IP-命令注入

**漏洞编号:** CVE-2025-31644

**漏洞类型:** 命令注入

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 17.1.2.2, < 16.1.6, < 15.1.10.7 (Appliance Mode)

**利用条件:** 需要在Appliance模式下运行，且攻击者需具有管理员权限，能够访问iControl REST API或执行tmsh命令。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2025-31644 是 F5 BIG-IP 中存在的一个命令注入漏洞，当 BIG-IP 在 Appliance 模式下运行时，经过身份验证且具有管理员权限的攻击者可以通过向 iControl REST API 或 SSH "tmsh" shell 中 "save" 命令的 "file" 参数注入恶意命令，从而以 "root" 用户身份在目标系统上执行任意系统命令。漏洞存在于未公开的iControl REST API 和 BIG-IP TMOS Shell (tmsh) 命令中。

**有效性：**根据漏洞信息和提供的POC代码，该漏洞利用是有效的。POC 明确指出通过操作 "save" 命令的 "file" 参数进行命令注入，从而获得 root 权限。Vendor Disclosure 也确认了该漏洞的存在并提供了修复方案，进一步佐证了漏洞的有效性。

**投毒风险：**提供的POC代码（README.md 和 PDF 文档链接）本身看起来是漏洞的描述和利用说明，直接包含恶意代码的可能性很小。风险点主要在于提供的 PDF 文档链接指向外部资源，理论上文档内容可能会被篡改，但考虑到漏洞披露者（Deloitte 的 Matei "Mal" Badanoiu）的信誉以及 F5 官方的确认，这种风险较低。此外，github的链接如果被攻击，有可能被投毒。综合评估，投毒风险较低，约为2%。

**利用方式：**

1.  **身份验证：** 攻击者首先需要获得具有管理员权限的 BIG-IP 系统的有效用户凭据。
2.  **定位漏洞点：**  在 Appliance 模式下，利用 iControl REST API 或 tmsh shell，找到可利用的 "save" 命令的 "file" 参数。
3.  **命令注入：**  在 "file" 参数中构造恶意命令，例如反弹 shell 或执行任意系统命令。
4.  **触发执行：**  发送构造好的请求或执行包含恶意命令的 tmsh 命令，触发漏洞。
5.  **获得权限：**  成功利用漏洞后，攻击者将以 "root" 用户身份在目标系统上执行任意命令，实现远程代码执行。

搜索引擎结果主要是对该漏洞的描述性信息，指向NVD, CVE, F5官方安全公告等，没有直接提供可利用的EXP，主要起辅助验证漏洞和提供背景信息的作用。

**项目地址:** [mbadanoiu/CVE-2025-31644](https://github.com/mbadanoiu/CVE-2025-31644)

**漏洞详情:** [CVE-2025-31644](https://nvd.nist.gov/vuln/detail/CVE-2025-31644)