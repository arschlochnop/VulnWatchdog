## CVE-2025-55315-ASP.NET Core-HTTP请求走私

**漏洞编号:** CVE-2025-55315

**漏洞类型:** HTTP Request Smuggling

**影响应用:** ASP.NET Core

**危害等级:** 高危，允许授权攻击者绕过网络上的安全功能

**影响版本:** ASP.NET Core 8.0 (不包含8.0.21), 9.0 (不包含9.0.10), 2.3 (不包含2.3.6); Visual Studio 2022 version 17.12 (不包含17.12.13), 17.10 (不包含17.10.20), 17.14 (不包含17.14.17)

**利用条件:** 需要目标服务未打补丁，并可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-55315 是一个 ASP.NET Core 的安全特性绕过漏洞，其根本原因是 HTTP 请求处理中的不一致性解释，导致HTTP请求走私。攻击者可以利用这个漏洞绕过安全措施。漏洞利用代码展示了如何通过构造特定的 HTTP 请求（Transfer-Encoding: chunked），在未打补丁的 Kestrel 服务器上保持连接打开，而在打过补丁的服务器上触发错误或关闭连接。具体来说，POC代码利用了分块传输编码的解析差异。通过发送包含错误块大小格式的请求，可以使未打补丁的服务器持续等待后续数据，从而导致请求走私。docker-compose.yml 文件用于构建包含受漏洞影响版本和已修复版本的ASP.NET Core应用程序的容器，以便进行测试。Dockerfile 和 Program.cs 定义了简单的 Web 应用，用于验证漏洞的存在。

**有效性：**
提供的 POC 代码看起来是有效的，它能够区分已打补丁和未打补丁的 Kestrel 服务器，验证了 HTTP 请求走私漏洞。

**投毒风险：**
该仓库中的代码主要用于演示和验证漏洞，没有发现明显的投毒代码。所有Dockerfile和Program.cs文件都清晰地定义了应用程序的行为，不存在隐藏恶意功能的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者构造恶意的 HTTP 请求，利用 chunked 编码的解析差异。
2.  将该请求发送到目标服务器。
3.  未打补丁的服务器会错误地处理请求，导致连接保持打开，允许攻击者发送后续的恶意请求。
4.  攻击者可以利用此漏洞绕过安全认证，或者进行其他恶意行为，例如访问未授权的资源。

**项目地址:** [nickcopi/CVE-2025-55315-detection-playground](https://github.com/nickcopi/CVE-2025-55315-detection-playground)

**漏洞详情:** [CVE-2025-55315](https://nvd.nist.gov/vuln/detail/CVE-2025-55315)