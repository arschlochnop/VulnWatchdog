## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，并且sudo版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463是Sudo中的一个本地权限提升漏洞。该漏洞允许本地用户通过`--chroot`选项和用户控制的`/etc/nsswitch.conf`文件来获取root权限。 

**漏洞利用方式：**

1.  **漏洞成因：** Sudo 在使用 `--chroot` 选项时，没有正确处理 `nsswitch.conf` 文件的加载，导致可以加载用户控制的 `nsswitch.conf`。
2.  **利用步骤：**
    *   攻击者创建一个包含恶意配置的目录（例如，`woot`）。
    *   在这个目录下，攻击者创建一个恶意的 `nsswitch.conf` 文件，并将其配置为加载一个恶意的 NSS 模块（共享对象）。
    *   攻击者创建一个恶意的 NSS 模块（共享对象），该模块在加载时执行提权操作（例如，通过 `setreuid(0,0)` 和 `setregid(0,0)`）。
    *   攻击者使用 `sudo -R woot woot` 命令，其中 `woot` 是包含恶意 `nsswitch.conf` 文件的目录。
    *   Sudo 在 `--chroot` 环境中加载恶意的 `nsswitch.conf` 文件，从而加载恶意的 NSS 模块，最终导致提权。

**有效性评估：**

提供的PoC代码有效。Dockerfile 构建了一个包含漏洞版本的 Sudo 的 Ubuntu 24.04 环境。`sudo-chwoot.sh` 脚本执行了上述利用步骤，成功提权到 root。

**投毒风险评估：**

在所提供的Dockerfile和shell脚本中，没有发现明显的投毒代码。该脚本直接利用漏洞，构造恶意nsswitch.conf和so文件,在chroot环境下实现提权。因此，投毒风险较低，为0%。


**项目地址:** [Adonijah01/cve-2025-32463-lab](https://github.com/Adonijah01/cve-2025-32463-lab)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)