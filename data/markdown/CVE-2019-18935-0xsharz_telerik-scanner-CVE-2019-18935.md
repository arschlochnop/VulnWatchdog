## CVE-2019-18935 - Telerik UI for ASP.NET AJAX 反序列化漏洞

**漏洞编号:** CVE-2019-18935

**漏洞类型:** .NET 反序列化

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 目标系统使用了受影响版本的Telerik UI for ASP.NET AJAX，且攻击者需要能够访问/Telerik.Web.UI.WebResource.axd?type=rau或者/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau, 同时需要结合CVE-2017-11317或CVE-2017-11357来获取加密密钥，或者通过其他方式获取加密密钥。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18935是Telerik UI for ASP.NET AJAX中的一个.NET反序列化漏洞，存在于RadAsyncUpload功能中。该漏洞允许攻击者在服务器上执行任意代码。要成功利用此漏洞，攻击者通常需要知道加密密钥，这可以通过利用CVE-2017-11317或CVE-2017-11357等其他漏洞来获得。提供的漏洞利用代码是一个Python脚本，用于检测目标是否存在此漏洞。脚本会检查目标是否暴露了RadAsyncUpload的handler，并且根据版本信息判断是否存在漏洞。漏洞利用方式主要分为几个步骤：1. **检测RAU模块**: 扫描`/Telerik.Web.UI.WebResource.axd?type=rau` 和 `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau`是否存在。2. **版本分析**: 通过正则表达式 `20[0-9]{2}(?:\.[0-9]*)+`从HTML源代码中提取版本信息。3. **漏洞评估**: 根据版本信息判断漏洞是否存在。例如，版本小于2020认为是存在漏洞的。关于投毒风险，虽然这个scanner本身的目的是检测漏洞，但如果攻击者修改scanner脚本，加入恶意代码，例如在检测到漏洞后，自动上传webshell，那么就存在投毒的风险。但是根据代码本身的内容，并没有发现明显的恶意代码，只有版本检测和漏洞扫描相关的功能，因此推测投毒风险较低，给出的百分比是10%。需要注意的是，由于利用该漏洞需要配合其他漏洞利用或密钥泄露，漏洞利用链相对复杂。

**项目地址:** [0xsharz/telerik-scanner-CVE-2019-18935](https://github.com/0xsharz/telerik-scanner-CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)