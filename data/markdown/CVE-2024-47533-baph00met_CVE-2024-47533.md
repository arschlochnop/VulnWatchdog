## CVE-2024-47533-Cobbler-不当身份验证

**漏洞编号:** CVE-2024-47533

**漏洞类型:** 不当身份验证

**影响应用:** Cobbler

**危害等级:** 严重，可能导致完全控制服务器

**影响版本:** 3.0.0 <= version < 3.2.3, 3.3.0 <= version < 3.3.7

**利用条件:** 需要网络访问Cobbler XML-RPC端口（默认25151）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-47533 存在于 Cobbler 中，由于 `utils.get_shared_secret()` 总是返回 `-1`，导致可以通过用户名 `''` 和密码 `-1` 绕过身份验证，以未授权身份连接到 Cobbler XML-RPC 服务器并进行任意更改，从而完全控制服务器。

**漏洞利用分析：**

1.  **有效性：** 提供的 PoC 代码有效。它利用了硬编码的用户名和密码绕过身份验证。
2.  **投毒风险：** PoC 代码本身没有发现明显的投毒代码。该代码的功能是利用漏洞，执行指定的命令。`README.md` 文件中给出的示例命令是良性的，没有发现任何恶意行为。投毒风险评估为 0%。
3.  **利用方式：**
    *   PoC 代码首先使用 `xmlrpc.client` 连接到 Cobbler XML-RPC 接口。
    *   使用用户名 `''` 和密码 `-1` 调用 `srv.login()` 绕过身份验证，获得一个 token。
    *   PoC 自动选取第一个可用的发行版。
    *   构造一个包含 Cheetah 表达式的 payload。该 payload 使用 `__import__('os').system()` 执行任意命令。命令的内容来自 `--cmd` 参数。
    *   使用 `srv.write_autoinstall_template()` 将包含恶意 payload 的 kickstart 模板写入 Cobbler 服务器。
    *   创建一个新的 profile 或者重用一个已存在的 profile。
    *   将 profile 的 distro 设置为之前选取的发行版。
    *   将 profile 的 autoinstall 和 kickstart 设置为包含恶意 payload 的模板。
    *   调用 `srv.generate_profile_autoinstall()` 触发模板渲染，执行 payload 中的命令。

**总结：**
该漏洞的利用非常简单，PoC 代码清晰地展示了如何利用该漏洞执行任意命令。由于身份验证绕过，攻击者无需任何凭据即可完全控制受影响的 Cobbler 服务器。  没有发现明显的投毒代码。

**项目地址:** [baph00met/CVE-2024-47533](https://github.com/baph00met/CVE-2024-47533)

**漏洞详情:** [CVE-2024-47533](https://nvd.nist.gov/vuln/detail/CVE-2024-47533)