## CVE-2025-59230 - Windows Remote Access Connection Manager Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-59230

**漏洞类型:** 权限提升

**影响应用:** Windows Remote Access Connection Manager (RasMan)

**危害等级:** 高危，本地权限提升至SYSTEM

**影响版本:** 受影响的Windows版本包括 Windows 10 (版本 1507, 1607, 1809, 21H2, 22H2), Windows 11 (版本 22H2, 22H3, 23H2, 24H2, 25H2), Windows Server 2016, 2019, 2022 (包括 23H2), 2025。

**利用条件:** 需要本地用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59230 是 Windows Remote Access Connection Manager (RasMan) 服务中的一个高危漏洞，允许经过身份验证的本地用户通过操纵服务参数将权限提升到 SYSTEM 级别。漏洞源于 RasMan 服务中不正确的访问控制机制。 

**利用方式：**
1.  攻击者首先需要拥有一个有效的本地用户账户。
2.  攻击者运行提供的 `rasmanesc.exe` 漏洞利用程序，或通过 `start_exp.bat` 脚本。
3.  该漏洞利用程序获取 RasMan 服务的句柄。
4.  利用程序发送特制的 IOCTL 缓冲区来覆盖服务参数。
5.  通过令牌模拟提升到 SYSTEM 权限。
6.  注入 payload (例如 `payload.dll`) 以生成 SYSTEM 级别的 shell。
7.  攻击者现在可以执行恶意操作，例如添加新的管理员用户。

**投毒风险分析：**
提供的POC代码包含一个预编译的二进制文件 `rasmanesc.exe` 和一个 DLL 文件 `payload.dll`。 在没有源代码的情况下，无法完全确定是否存在恶意代码，但有以下几点需要注意：

*   `rasmanesc.exe`:  该文件是主要漏洞利用程序，可能包含隐藏的后门或恶意功能。 由于未提供源代码，因此需要进一步分析才能确定其安全性。 如果程序有联网行为或执行意料之外的文件操作，则存在投毒风险。但根据描述，其行为符合漏洞利用的预期，风险降低。
*   `payload.dll`:  这是一个 DLL payload，在成功利用后会被注入到进程中。 恶意 payload 可能会执行任意代码，例如安装后门或窃取敏感数据。 需要对其行为进行动态分析以确定是否存在恶意行为。 但根据描述，其目的是为了演示反向shell，风险降低。
*   缺少源代码使得分析变得困难，因此存在一定的投毒风险。 
*   `README.md` 文件描述了利用过程以及免责声明，在一定程度上降低了投毒的概率。

因此，综合评估投毒风险为 10%。建议在隔离环境中分析这些文件，以确保安全。

**项目地址:** [stalker110119/CVE-2025-59230](https://github.com/stalker110119/CVE-2025-59230)

**漏洞详情:** [CVE-2025-59230](https://nvd.nist.gov/vuln/detail/CVE-2025-59230)