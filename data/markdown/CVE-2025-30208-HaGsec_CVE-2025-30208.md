## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite dev server 显式暴露到网络 (使用 `--host` 或 `server.host` 配置)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208 漏洞允许攻击者绕过 Vite 的 `server.fs.deny` 限制，读取任意文件。漏洞存在于 Vite 的 transformMiddleware 中，攻击者可以通过在 URL 中添加 `?raw??` 或 `?import&raw??` 来绕过文件访问限制，从而读取服务器上的敏感文件，例如 `/etc/passwd`。只有当 Vite 开发服务器通过 `--host` 或 `server.host` 选项显式暴露于网络时，此漏洞才可利用。

**有效性：** 提供的 POC 代码通过发送带有 `?raw` 的请求来验证漏洞，尝试读取 `/etc/passwd` 文件。如果服务器返回文件内容，则表明漏洞存在。POC 看起来有效，因为它遵循了漏洞描述中提到的利用方式。

**投毒风险：** 查看提供的文件列表，主要文件是python脚本POC_CVE-2025-30208.py，requirements.txt和README.md. POC代码的主要功能是发送HTTP请求，并根据响应判断目标是否存在漏洞，并没有发现可疑的后门代码，requirements.txt文件只包含了requests和urllib3两个常用的python库. 因此，此仓库中不存在作者隐藏的投毒代码的可能性接近0%.

**利用方式：**
1.  目标系统需运行存在漏洞版本的 Vite 开发服务器，并已通过 `--host` 或 `server.host` 将其暴露到网络。
2.  攻击者构造包含 `?raw??` 或 `?import&raw??` 的恶意 URL，例如 `http://target.com/path/to/file?raw??`，尝试读取目标文件。
3.  Vite 服务器在处理该 URL 时，会因逻辑错误绕过文件访问限制，将目标文件的内容返回给攻击者。
4.  攻击者从响应中提取敏感信息。

**项目地址:** [HaGsec/CVE-2025-30208](https://github.com/HaGsec/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)