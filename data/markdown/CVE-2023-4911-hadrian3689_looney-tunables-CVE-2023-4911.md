## CVE-2023-4911 - Glibc ld.so 缓冲区溢出

**漏洞编号:** CVE-2023-4911

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc (ld.so)

**危害等级:** 高危，本地权限提升

**影响版本:** glibc 2.34 到 2.39 之前版本

**利用条件:** 本地用户，需要目标系统存在具有SUID权限的可执行文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4911 漏洞存在于 glibc 动态链接器 ld.so 中，源于处理 GLIBC_TUNABLES 环境变量时的缓冲区溢出。攻击者可以通过设置恶意的 GLIBC_TUNABLES 环境变量，在启动具有 SUID 权限的二进制文件时，以提升的权限执行代码，从而实现本地权限提升。

**漏洞利用方式：**

1.  利用GLIBC_TUNABLES 环境变量，触发ld.so中的缓冲区溢出。
2.  覆盖关键数据结构，例如 `link_map` 结构，修改 `l_info[DT_RPATH]`，使其指向攻击者控制的内存区域。
3.  创建伪造的 libc.so.6，包含恶意代码。
4.  通过 RPATH 机制，加载伪造的 libc.so.6，执行恶意代码。

**有效性分析：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的，搜索结果中多个链接都表明该漏洞已经存在公开的PoC，并被积极利用。
提供的PoC代码也包含完整的利用流程，包括环境准备、编译和利用。

**投毒风险分析：**

PoC代码整体结构清晰，主要功能集中在利用缓冲区溢出实现权限提升，**但仍存在一定的低风险投毒可能性（5%）**，理由如下：

*   **对fork函数的调用及wait状态判断：**  exp.c中使用了fork函数创建子进程，父进程等待子进程结束。如果子进程的行为稍微有些偏差，可能导致父进程进入意外的状态或执行未预期的操作。虽然代码中对`WIFSIGNALED`和执行时间进行了判断，但仍然存在一定的风险。
*   **编译依赖和环境配置：** 虽然PoC主要依赖gcc，但仍然存在极小的通过Makefile或其他方式引入恶意依赖的可能。

尽管存在上述微小风险，综合来看，该PoC主要为漏洞验证和权限提升的利用，投毒的可能性较低。

**结论：**

CVE-2023-4911 是一个严重的安全漏洞，利用难度较低，影响范围广泛。系统管理员应尽快升级 glibc 版本，或采取缓解措施，例如使用提供的 SystemTap 脚本。

**项目地址:** [hadrian3689/looney-tunables-CVE-2023-4911](https://github.com/hadrian3689/looney-tunables-CVE-2023-4911)

**漏洞详情:** [CVE-2023-4911](https://nvd.nist.gov/vuln/detail/CVE-2023-4911)