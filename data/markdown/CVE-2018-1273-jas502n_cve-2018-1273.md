## CVE-2018-1273 Spring Data Commons RCE

**漏洞编号:** CVE-2018-1273

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Data Commons

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** Versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5, and older unsupported versions

**利用条件:** 目标应用使用了受影响版本的Spring Data Commons，并且暴露了Spring Data REST接口或使用了Spring Data的projection-based request payload binding机制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-1273是Spring Data Commons中的一个属性绑定漏洞，由于对特殊字符的过滤不当导致。未经身份验证的远程攻击者可以构造恶意请求参数，通过Spring Data REST支持的HTTP资源或Spring Data基于投影的请求负载绑定，从而执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。搜索结果中多个链接都确认了该漏洞的存在和严重性，并提供了利用细节。POC代码提供了一个Python脚本和一个BurpSuite请求示例，展示了如何利用该漏洞。

**投毒风险：**
虽然POC本身展示了漏洞利用，但代码仓库中可能存在投毒风险。分析`cve-2018-1273.py`脚本，其中使用了代理`proxies = {"http":"http://127.0.0.1:8080/"}`。如果攻击者修改这个代理地址指向恶意服务器，则可能会捕获用户的敏感信息或进行中间人攻击。另外，如果攻击者修改脚本，在执行命令后进行额外的操作（例如上传恶意文件），也属于投毒行为。`README.md`中虽然仅为漏洞说明，但如果被篡改，也可能引导用户下载恶意软件。综合判断，存在10%的投毒风险，主要来自POC使用者的不当使用或恶意修改。

**利用方式：**
1.  **确定目标：** 找到使用存在漏洞的Spring Data Commons版本的应用程序，并且该程序暴露了Spring Data REST接口，或者使用了Spring Data的projection-based request payload binding机制。
2.  **构造恶意请求：** 构造包含SpEL表达式的HTTP POST请求，利用Spring Data Commons的属性绑定功能执行任意代码。例如，可以使用如下的payload：
    `name[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('command')] = test`
3.  **发送请求：** 将构造好的请求发送到目标应用程序的REST接口。`cve-2018-1273.py` 展示通过POST 请求的`name`参数注入SpEL表达式，利用`java.lang.Runtime`执行系统命令。
4.  **执行命令：** 如果漏洞利用成功，目标应用程序将执行SpEL表达式中的代码，从而实现远程代码执行。可以通过检查目标系统上的文件或网络连接来验证漏洞是否成功利用。

**项目地址:** [jas502n/cve-2018-1273](https://github.com/jas502n/cve-2018-1273)

**漏洞详情:** [CVE-2018-1273](https://nvd.nist.gov/vuln/detail/CVE-2018-1273)