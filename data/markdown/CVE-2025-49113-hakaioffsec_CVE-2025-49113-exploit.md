## CVE-2025-49113-Roundcube-反序列化RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** 反序列化RCE

**影响应用:** Roundcube Webmail

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** < 1.5.10 和 1.6.x < 1.6.11

**利用条件:** 需要已经通过身份验证的用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113 允许经过身份验证的用户通过在 URL 中构造恶意的 `_from` 参数，触发 `program/actions/settings/upload.php` 中的 PHP 对象反序列化漏洞，从而导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分为 9.9，被认为是高危漏洞，并且存在可利用的 POC。多个来源证实了该漏洞的存在以及远程代码执行的可能性。提供的代码尝试利用此漏洞。代码首先检查Roundcube版本，判断目标是否存在漏洞,然后进行登录,登录成功后,通过构造包含恶意序列化对象的_from参数来触发反序列化。

**投毒风险：**
POC代码中存在一定的投毒风险，代码中`Crypt_GPG_Engine`类会执行任意shell命令，所以该POC本身就会在成功利用漏洞后,执行任意shell命令，其中`$this->_gpgconf = "echo \"{$_gpgconf}\"|base64 -d|sh;#";`这行代码就是将经过base64编码的恶意代码，解码后通过`sh`执行。投毒风险评估为 10%，因为虽然PoC本身包含执行任意命令的部分，但恶意行为是其漏洞利用的核心逻辑，而不是额外添加的隐藏功能。

**利用方式：**
1.  **身份验证：** 攻击者需要首先获得 Roundcube Webmail 的有效用户凭据才能登录。
2.  **版本检查：** 通过User-Agent头，脚本会尝试检查Roundcube版本以确认目标是否在受影响的版本范围内。
3.  **构造恶意请求：** 登录后，攻击者构造包含恶意序列化 PHP 对象的 `_from` 参数的 URL，并发送到 `program/actions/settings/upload.php`。
4.  **触发反序列化：** Roundcube Webmail 在处理请求时，由于未对 `_from` 参数进行充分验证，导致 PHP 反序列化操作。
5.  **远程代码执行：** 恶意 PHP 对象被反序列化后，其 `__wakeup` 或 `__destruct` 等魔术方法中的恶意代码会被执行，从而实现远程代码执行。

**项目地址:** [hakaioffsec/CVE-2025-49113-exploit](https://github.com/hakaioffsec/CVE-2025-49113-exploit)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)