## CVE-2023-21716 Microsoft Word RTF 字体表堆损坏漏洞

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，允许攻击者在受害者计算机上执行任意代码

**影响版本:** 受影响的版本包括Microsoft Office、SharePoint和365 Apps的多个版本，具体参见CVE描述。

**利用条件:** 用户需要打开恶意的RTF文档。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-21716 是一个 Microsoft Word 远程代码执行漏洞，当 Word 解析 RTF 文件时，`wwlib.dll` 中存在堆损坏漏洞。攻击者可以通过构造包含恶意字体表的 RTF 文件来触发此漏洞。具体来说，当字体表包含过多的字体时，在处理字体 ID 时会出现整数溢出，导致向堆内存的负偏移地址写入数据，从而破坏堆结构。利用方式是通过精心构造的 RTF 文件，其中包含大量的字体定义 `\f###` 在 `\fonttbl` 标签中。这个poc文件触发了堆损坏。由于提供的 POC 代码主要是为了演示漏洞原理，并没有发现明显的投毒代码，所以投毒风险较低。根据漏洞信息和漏洞代码，利用方式为：攻击者创建包含恶意构造的字体表的 RTF 文件，诱使用户打开该文件，导致堆损坏，最终实现远程代码执行。

**项目地址:** [gyaansastra/CVE-2023-21716](https://github.com/gyaansastra/CVE-2023-21716)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)