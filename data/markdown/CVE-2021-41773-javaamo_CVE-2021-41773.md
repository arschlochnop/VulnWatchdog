## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的Apache HTTP Server 2.4.49版本，并启用了cgi-bin目录，且该目录下的文件没有被'require all denied'保护

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-41773 漏洞是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞。攻击者可以通过构造包含特殊字符的 URL，绕过 Alias 类似的指令配置的目录限制，访问到服务器上的任意文件。如果服务器同时启用了 CGI 脚本支持，攻击者甚至可以执行任意代码。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果也表明该漏洞已被公开利用。

**投毒风险：**
提供的漏洞利用代码主要由一个shell脚本和一个README文件组成。shell脚本的功能是向目标服务器发送包含恶意路径的HTTP请求，读取指定文件或执行命令。README文件是对漏洞利用代码的说明。
脚本本身存在投毒的可能性较低，风险预估1%。主要风险点在于targets.txt文件，如果攻击者替换了targets.txt中的目标，可能会导致非授权的扫描或者攻击。需要注意的是，该PoC本身就是用于攻击的，因此不能将利用漏洞的代码判定为投毒。

**利用方式：**
1.  准备：准备一个包含目标服务器地址列表的 `targets.txt` 文件。
2.  路径遍历：使用`./50383.sh targets.txt /etc/passwd`尝试读取敏感文件，例如`/etc/passwd`。
3.  远程代码执行：如果目标服务器启用了 CGI，则可以通过类似`./50383.sh targets.txt /bin/sh whoami`的方式执行命令。
   需要注意的是，该POC代码尝试利用路径遍历漏洞，将请求发送到`/cgi-bin/`目录，从而触发CGI脚本的执行，最终达到远程代码执行的目的. 如果CGI未开启，则只能进行文件读取。

**项目地址:** [javaamo/CVE-2021-41773](https://github.com/javaamo/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)