## CVE-2023-21716 Microsoft Word RCE

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Word

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响版本包括但不限于：Microsoft Office 365, Microsoft Office 2016, Microsoft Office 2013, Microsoft Office 2010, Microsoft Office 2007，具体版本范围参考漏洞库信息。

**利用条件:** 用户需要打开恶意的RTF文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-21716是Microsoft Word中的一个远程代码执行漏洞，源于RTF文件解析过程中的堆损坏。当Word处理包含过多字体（超过32760个）的字体表（*fonttbl*）时，会触发此漏洞。攻击者可以构造一个恶意的RTF文档，通过电子邮件或其他方式发送给受害者。当受害者打开该文档时，漏洞被触发，攻击者可以执行任意代码，完全控制受害者的系统。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码能够有效触发该漏洞。POC代码生成一个包含大量字体定义的RTF文件，当Microsoft Word解析此文件时，会发生堆损坏，从而可能导致代码执行。

**投毒风险：**

分析提供的文件，包括Python脚本和YARA规则，没有发现明显的投毒代码。Python脚本的功能是生成利用漏洞的RTF文件，YARA规则用于检测恶意RTF文件。作者的信息属实，且声明参考了已知的漏洞利用方式。

**利用方式：**

1.  攻击者构造一个恶意的RTF文件，其中包含大量的字体定义（例如，超过32760个）。
2.  攻击者将此文件通过电子邮件或其他方式发送给受害者。
3.  受害者使用Microsoft Word打开该RTF文件。
4.  Word尝试解析RTF文件中的字体表，由于字体数量过多，导致堆损坏。
5.  攻击者利用堆损坏漏洞执行任意代码，从而控制受害者的系统。

YARA规则提供了两种检测方式，一种针对小于6位数字的ID，另一种更加密集扫描。


**项目地址:** [JMousqueton/CVE-2023-21716](https://github.com/JMousqueton/CVE-2023-21716)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)