## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得 root 权限

**影响版本:** Linux kernel 2.x to 4.x before 4.8.3

**利用条件:** 目标系统内核版本在受影响范围内，且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞争条件漏洞，存在于`mm/gup.c`文件中。该漏洞允许本地用户利用写时复制（COW）机制中的不正确处理，写入只读内存映射，从而获得特权提升。 

**漏洞利用方式：**

1.  **内存映射：** 攻击者首先使用`mmap()`系统调用将一个只读文件映射到内存中。
2.  **线程竞争：** 攻击者创建两个线程：一个线程通过`madvise()`系统调用触发COW机制，另一个线程通过`pwrite()`系统调用尝试写入映射的内存区域。
3.  **竞争条件：** 由于COW机制的竞争条件，写入操作可能会在内存页被正确设置为可写之前发生，从而允许攻击者修改只读内存。
4.  **权限提升：** 攻击者可以利用此漏洞修改系统文件（如`/etc/passwd`），从而获得root权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞在2016年被广泛利用，存在多个公开的POC代码。因此，该漏洞利用的有效性较高。

**投毒风险：**

提供的C#代码 `AdbHelper.cs` 主要功能是辅助进行安卓调试，从代码角度看，主要进行adb环境配置和设备连接管理，不涉及高危行为。但是，由于是自动化工具，存在以下潜在风险：

*   **依赖项风险：** 该工具依赖于从资源文件提取的 ADB 二进制文件。如果这些资源文件被篡改，则可能引入恶意代码。因此，存在将恶意ADB二进制文件嵌入到资源中的风险。
*   **网络连接风险：**尽管代码本身不直接发起网络请求，但 ADB 协议本身涉及与安卓设备的通信，如果设备被恶意控制，可能导致间接风险。
*    **文件篡改风险:** 具有删除和创建目录、文件权限等操作。虽然本意是释放adb执行文件，也存在被恶意利用修改其他系统文件的风险。

  因此，该代码的投毒风险较低，估计为10%。这个评估是基于对代码功能的分析，以及对可能的恶意行为的推测。实际的风险需要根据具体的实现和使用环境进行评估。


**项目地址:** [LiEnby/PSSRoot](https://github.com/LiEnby/PSSRoot)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)