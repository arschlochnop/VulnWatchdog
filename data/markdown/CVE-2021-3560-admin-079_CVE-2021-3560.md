## CVE-2021-3560 - Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致未经授权的本地用户获取 root 权限，影响数据机密性、完整性和系统可用性。

**影响版本:** polkit 0.119 及更早版本 (根据漏洞库信息，POC 针对 0.113 及更高版本)

**利用条件:** 本地用户访问受影响的 Polkit 服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 是 Polkit 中的一个权限提升漏洞，攻击者可以通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升到 root 用户。提供的 POC 代码利用了此漏洞，通过 dbus-send 命令与 Polkit 服务进行交互，创建用户并修改密码，从而获得 root 权限。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个已知的且被积极利用的漏洞。提供的 POC 代码旨在利用此漏洞。github blog的搜索结果也佐证了这一点，github上也有相关的复现仓库，快速利用可以获得系统ROOT权限.

**投毒风险：**
分析 POC 代码，代码主要功能是利用 dbus-send 命令创建用户并修改密码。代码中没有发现任何明显的恶意代码或后门。该脚本的功能就是创建一个新用户并通过漏洞提权，并不存在植入恶意程序或者其他恶意行为。因此，投毒风险较低，估计为 0%。代码的作者署名信息明确，并且提供了参考链接，可以追溯漏洞的来源和原理，进一步降低了投毒的可能性。

**利用方式：**
1.  **创建用户：** 使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.CreateUser` 方法创建一个新用户（默认为 flash）。
2.  **设置密码：** 获取新创建用户的 UID，然后使用 `dbus-send` 命令，通过 `org.freedesktop.Accounts.User.SetPassword` 方法设置用户的密码。由于漏洞的存在，可以绕过身份验证，直接设置密码。
3.  **提权：** 多次运行密码修改的命令，利用竞争条件，可以利用polkit缺陷将用户权限提升为ROOT。
4.  **登录：** 使用新创建的用户和设置的密码登录系统，此时该用户拥有 root 权限。

**优先级排序依据：**
按照题目要求，搜索引擎结果的优先级最高，漏洞利用代码次之，漏洞库信息最低。
搜索结果中，GitHub 博客文章详细描述了漏洞的原理和利用方法。漏洞利用代码展示了具体的利用步骤。漏洞库信息提供了漏洞的基本信息和影响。


**项目地址:** [admin-079/CVE-2021-3560](https://github.com/admin-079/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)