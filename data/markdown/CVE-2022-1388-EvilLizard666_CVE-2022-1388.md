## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，且可通过网络访问其iControl REST API（通常是443或8443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-1388 漏洞存在于 F5 BIG-IP 设备的 iControl REST API 中。攻击者可以发送特制的 HTTP 请求，绕过身份验证，从而执行未授权的操作。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者远程执行代码。

**有效性：**
提供的 Python 脚本 `CVE-2022-1388-V1.1.py` 和 `cve-2022-1388-scanner.py` 旨在扫描目标系统是否存在此漏洞。它们通过向目标系统的 `/mgmt/tm/util/bash` 路径发送包含特定 Header 的 POST 请求，来尝试利用身份验证绕过漏洞。脚本会检测响应状态码和响应内容，以确定目标是否容易受到攻击。利用代码本身看起来是有效的，并且被设计为检测漏洞而不是直接执行恶意操作。

**投毒风险：**
查看提供的Python脚本，脚本本身的主要功能是漏洞检测，通过发送包含特定Header的POST请求尝试绕过认证并执行命令。虽然脚本会执行`cat /etc/passwd`命令来验证漏洞，但没有发现明显的恶意代码，如反弹shell，植入后门等。但是, 代码作者可以在目标机器上执行任意命令, 风险依然存在. 脚本包含发起HTTP请求的部分，如果脚本的维护者被攻击，或者人为恶意篡改了脚本，可能导致脚本被用于传播恶意软件或执行其他恶意活动。
综合评估，投毒风险较低，大约为5%，主要来自于未来脚本被篡改的可能性。

**利用方式：**
1.  攻击者构造包含特定 Header 的 HTTP POST 请求，目标 URL 为 `/mgmt/tm/util/bash`。
2.  这些特殊的 Header 绕过了 iControl REST API 的身份验证机制。
3.  POST 请求的 JSON 数据中包含要执行的命令，例如 `{'command': 'run', 'utilCmdArgs': '-c <command>'}`。
4.  BIG-IP 系统会执行该命令，并将结果返回给攻击者。

此漏洞的成功利用可使攻击者完全控制受影响的 BIG-IP 系统。

**项目地址:** [EvilLizard666/CVE-2022-1388](https://github.com/EvilLizard666/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)