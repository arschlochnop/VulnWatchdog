## CVE-2025-21298 - Windows OLE 远程代码执行漏洞

**漏洞编号:** CVE-2025-21298

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows OLE (ole32.dll)

**危害等级:** 高危，远程代码执行，可能导致完全系统控制

**影响版本:** 受影响的Windows版本：Windows 10 (1507 - 22H2), Windows 11 (Up to 24H2), Windows Server (2008 - 2025) 在漏洞库信息中有详细的版本说明，请查阅。

**利用条件:** 需要目标系统运行受影响的Windows版本，并通过Outlook、Word等OLE组件加载恶意的RTF文件。利用方式为零点击，在预览时触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21298 是一个存在于 Microsoft Windows OLE 组件中的远程代码执行漏洞。该漏洞是由于 `ole32.dll` 中的 `UtOlePresStmToContentsStm` 函数处理 OLE 对象时存在double-free内存错误。攻击者可以构造恶意的 RTF 文件，当受害者在 Outlook 或其他支持 OLE 的应用程序中预览该文件时，无需用户交互即可触发漏洞，执行任意代码。

**有效性分析：**
提供的PoC 代码看起来有效。`README.md` 文件详细描述了漏洞原理、影响范围、利用方式和缓解措施。RTF文件包含嵌入的OLE对象，可以触发`ole32.dll`中存在的 double-free 漏洞。

**投毒风险分析：**
投毒风险评估为 10%。该漏洞的利用依赖于构造恶意的 RTF 文件。仓库中可能存在的投毒风险在于，作者可能在 RTF 文件中嵌入了额外的恶意代码，例如，利用漏洞成功执行后，植入后门或执行其他未经授权的操作。但是，从提供的代码来看，RTF的代码部分很短，只包含触发漏洞的基础代码，实际漏洞触发后的恶意行为需要更多的数据和指令。当然，不排除作者使用了混淆或者隐藏技巧。

**利用方式：**
1.  攻击者创建一个包含恶意 OLE 对象的 RTF 文件。
2.  攻击者通过电子邮件或其他方式将该 RTF 文件发送给受害者。
3.  受害者在 Outlook 或其他支持 OLE 的应用程序中预览该邮件。
4.  RTF 渲染器调用 `ole32.dll` 中的 OLE 处理函数。
5.  `UtOlePresStmToContentsStm` 函数中的 double-free 漏洞被触发，导致内存损坏。
6.  攻击者利用内存损坏执行任意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-21298](https://github.com/B1ack4sh/Blackash-CVE-2025-21298)

**漏洞详情:** [CVE-2025-21298](https://nvd.nist.gov/vuln/detail/CVE-2025-21298)