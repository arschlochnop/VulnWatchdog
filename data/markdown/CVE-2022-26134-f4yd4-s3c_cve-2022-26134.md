## CVE-2022-26134-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的攻击者可以执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果（Rapid7, NVD, Qualys, CISA等）和提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被广泛利用。提供的Python POC 代码尝试利用 OGNL 注入漏洞来执行命令。

**投毒风险：**
提供的代码包含一个完整的 C2 框架 (MBEUBEU)。这意味着除了提供的 exploit.py 文件之外，还有大量的其他代码。虽然 `exploit.py` 本身看起来很简单并且实现了漏洞利用，但整个仓库的复杂性增加了存在隐藏恶意代码的可能性。例如，C2 框架可能包含后门或收集凭据的功能。

*   `README.md` 包含了免责声明，说明该工具仅用于教育目的和授权渗透测试。 这不能保证没有恶意代码，因为免责声明很容易添加。
*   C2 框架具有多种功能，例如文件传输、凭据转储和横向移动。 这些功能如果被滥用，可能会对目标系统造成严重损害。
*   对加沙受害者的捐款呼吁是真实的，不能用作投毒的指标。但是，它显示了作者的动机和意识形态，这可能影响代码的编写方式。

考虑到 C2 框架的复杂性和作者的背景，存在一些投毒风险，但风险不是特别高。因此，保守的估计投毒概率为10%。

**利用方式：**
漏洞利用方式是 OGNL 注入。攻击者通过构造恶意的 OGNL 表达式，并将其注入到 Confluence Server 或 Data Center 的某个请求参数中。服务器在解析 OGNL 表达式时，会执行攻击者注入的恶意代码，从而导致远程代码执行。

`exploit.py` 脚本发送带有恶意 OGNL 表达式的 HTTP 请求，尝试在目标服务器上执行命令。成功利用漏洞后，攻击者可以完全控制受影响的 Confluence 服务器。

**项目地址:** [f4yd4-s3c/cve-2022-26134](https://github.com/f4yd4-s3c/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)