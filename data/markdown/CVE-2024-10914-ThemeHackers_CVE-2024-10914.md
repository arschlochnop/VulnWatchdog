## CVE-2024-10914 - D-Link NAS 设备远程命令执行

**漏洞编号:** CVE-2024-10914

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** <= 20241028 (多个型号受影响)

**利用条件:** 需要网络访问目标设备的80端口，设备开启Web服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10914 是 D-Link NAS 设备中的一个关键命令注入漏洞，影响多个型号。攻击者可以通过构造恶意的 HTTP 请求，向 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 端点的 `name` 参数注入操作系统命令。该漏洞无需身份验证即可利用。根据搜索引擎结果，该漏洞已经被公开讨论且有活跃的利用。提供的POC代码包含利用该漏洞的Python脚本，可以执行任意命令并获得交互式shell。鉴于目标设备已经EOL,官方不太可能修复,利用价值高。

**漏洞利用方式：**

1.  **目标识别：** 通过FOFA等搜索引擎，利用 `app="D_Link-DNS-ShareCenter" && server=="lighttpd/1.4.25-devel-fb150ff"` 等关键词筛选出潜在的受害者。
2.  **漏洞触发：**  向目标设备的 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=';{};'` 发送包含恶意命令的HTTP请求。
3.  **命令执行：**  服务器执行注入的命令。
4.  **交互式Shell (可选):** POC代码提供交互式shell功能,方便攻击者执行更多命令。

**投毒风险分析：**

代码分析主要集中在 `exploit.py` 脚本。`README.md` 和 `LICENSE` 文件没有可疑之处。脚本使用了常见的库，如 `requests`，`alive-progress`，`prompt_toolkit` 和 `argparse`，未发现恶意代码。但由于代码执行任意命令，存在潜在的风险：攻击者可能修改脚本，添加恶意payload，例如植入后门、发起DDoS攻击等。因此，在使用任何公开的exploit代码时，必须仔细审查，确保其安全性。漏洞研究员需要关注代码的来源和信誉，以及代码本身是否存在可疑行为，如访问敏感文件、建立未授权连接等。

考虑到POC作者为ds_zct,在github中可信度一般,脚本逻辑简单, 投毒风险较低,初步判断投毒风险为10%。

**项目地址:** [ThemeHackers/CVE-2024-10914](https://github.com/ThemeHackers/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)