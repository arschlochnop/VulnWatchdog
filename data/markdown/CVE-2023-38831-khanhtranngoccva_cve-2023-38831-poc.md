## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞源于WinRAR处理ZIP压缩包时，对文件名和文件夹名区分不当。攻击者可以创建一个ZIP压缩包，其中包含一个良性文件（例如JPG）和一个同名的文件夹。该文件夹中包含恶意可执行文件。当用户尝试在WinRAR中打开该良性文件时，WinRAR会错误地执行文件夹中的恶意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，证明了其有效性。提供的POC代码片段（package-lock.json）显示使用了jszip库，表明该POC可能用于创建恶意的ZIP压缩包，进一步验证漏洞的可利用性。

**投毒风险：**
提供的POC代码片段是`package-lock.json`文件，主要描述了项目依赖。要判断是否存在投毒风险，需要检查实际的利用代码（例如 index.ts/index.js）。
*   这个`package-lock.json`文件本身不包含恶意代码，只是依赖声明。
*   **风险点在于开发者可能在其他代码文件中（如index.ts等，此文件未提供）包含恶意代码**。
*   jszip 库本身是一个常用的 ZIP 文件操作库，被投毒的可能性较低。
*   tsx和typescript是typescript相关工具，本身被投毒的可能性也比较低

由于缺乏实际的利用代码，无法确定是否存在投毒行为，只能根据现有信息进行推测，因此将投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包。
2.  该ZIP压缩包包含一个良性文件（例如JPG）和一个同名的文件夹。
3.  该文件夹中包含恶意可执行文件（例如EXE、BAT、CMD等）。
4.  攻击者诱骗用户使用受影响的WinRAR版本打开该ZIP压缩包。
5.  用户尝试在WinRAR中打开该良性文件。
6.  WinRAR错误地执行文件夹中的恶意代码，导致远程代码执行。

**项目地址:** [khanhtranngoccva/cve-2023-38831-poc](https://github.com/khanhtranngoccva/cve-2023-38831-poc)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)