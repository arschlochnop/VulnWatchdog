## CVE-2017-7921-Hikvision摄像机认证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需要存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7921存在于特定版本的海康威视IP摄像头中，允许未经过身份验证的攻击者通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）下载包含敏感信息的配置文件。该配置文件使用弱加密，攻击者可以使用提供的python脚本进行解密，获取用户名和密码等敏感信息。

**有效性：**
提供的POC代码 `decrypt_configurationFile.py` 用于解密通过漏洞下载的配置文件，因此是有效的。

**投毒风险：**
代码主要功能是解密配置文件，没有发现明显的恶意代码或后门。代码结构清晰，逻辑简单，依赖的库 `pycryptodome` 是一个常见的密码学库。因此，投毒风险较低。

**利用方式：**
1.  构造包含特定base64字符串的URL，例如 `/System/configurationFile?auth=YWRtaW46MTEK`，向目标设备发送请求，下载配置文件。
2.  使用提供的 `decrypt_configurationFile.py` 脚本解密下载的配置文件。
3.  从解密后的配置文件中提取敏感信息，例如用户名和密码。
4.  使用提取的凭据登录设备，或利用其他漏洞进行进一步的攻击。

**项目地址:** [p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/p4tq/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)