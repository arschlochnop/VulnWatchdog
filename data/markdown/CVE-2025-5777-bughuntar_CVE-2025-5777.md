## CVE-2025-5777 NetScaler ADC/Gateway 内存泄露漏洞 (CitrixBleed 2)

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存泄露

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** NetScaler ADC 和 Gateway 13.1 < 58.32, 14.1 < 43.56 (需配置为Gateway或AAA虚拟服务器)

**利用条件:** 需要目标服务器配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或 AAA virtual server

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5777，又名CitrixBleed 2，是一个NetScaler ADC和Gateway设备上的内存泄露漏洞。由于输入验证不足，当NetScaler配置为Gateway或AAA虚拟服务器时，可能导致内存过读取。

**有效性评估：**

*   漏洞库信息确认了该漏洞的存在，并指出影响的版本和受影响的组件 (ADC/Gateway)。
*   搜索引擎结果中多个来源 (Horizon3.ai, Wiz.io, Watchtowr, Picus Security, Stormshield, csoonline) 表明该漏洞已被公开披露，且存在利用方式，并将其与之前的CitrixBleed漏洞进行比较。 其中某些文章还指出该漏洞正在被野外利用
*   提供的PoC代码（`citrix_memory_leak.py`）明确说明了如何利用该漏洞：通过发送畸形的POST请求到`/p/u/doAuthentication.do`，具体来说是利用login参数缺少等号 (`login` 而不是 `login=`)来触发服务器的内存泄露。 PoC代码通过解析XML响应中的`<InitialValue>`标签来提取泄露的内存内容，并以十六进制和ASCII格式显示。
*   该PoC代码的`README.md`文件和免责声明明确指出其仅用于教育和授权安全研究目的，并强烈警告用户不要在未经授权的系统上使用。

综合以上信息，可以判断该PoC代码是有效的，可以成功利用CVE-2025-5777漏洞泄露内存。

**投毒风险分析：**

*   PoC代码本身相对简单，主要功能是发送畸形请求并解析响应。 但是,仍存在细微的投毒风险。
*   `DISCLAIMER.md`文件和`README.md`文件都强调了合法使用和免责声明，这在一定程度上降低了作者故意投毒的可能性。
*  风险点在于脚本可能存在潜在的后门代码（虽然从提供的代码片段中无法直接看出），例如，收集目标信息并暗中发送给攻击者。 但是，考虑到作者在安全社区的身份（`@bughuntar`），以及明确的免责声明，这种可能性较低。

因此，综合评估投毒风险为 **5%**。主要风险在于细微的后门代码，但作者的声明和代码的简单性降低了这种风险。

**利用方式：**

1.  **配置要求：** 目标NetScaler ADC或Gateway需要配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) 或 AAA virtual server。
2.  **发送畸形请求：**  攻击者通过发送畸形的POST请求到`/p/u/doAuthentication.do`，使用`login`参数但不带等号（`login`而非`login=`），触发内存泄露。
3.  **提取泄露内容：**  服务器响应的XML数据中，`<InitialValue>`标签包含泄露的内存内容。
4.  **分析泄露数据：**  泄露的内存数据可能包含敏感信息，如session token, 认证凭据或之前的http请求片段。攻击者可以利用这些信息进行会话劫持、MFA绕过等恶意行为。
5.  **持续利用：** 单次请求泄露的内存有限，攻击者需要发送多次请求以获得足够的敏感信息。

简而言之，该漏洞利用方式简单，只需要发送一个畸形的HTTP POST请求即可，但需要目标系统满足特定的配置条件，且需要多次请求才能泄露足够的敏感信息。

**项目地址:** [bughuntar/CVE-2025-5777](https://github.com/bughuntar/CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)