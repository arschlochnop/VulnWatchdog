## CVE-2025-53770-SharePoint-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可完全控制SharePoint服务器并横向渗透

**影响版本:** SharePoint Enterprise Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (不包含 SharePoint Online)

**利用条件:** 需要能够发送HTTP请求到SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个影响本地部署的 Microsoft SharePoint Server 2016, 2019 和订阅版的远程代码执行漏洞。该漏洞利用链（ToolShell）包含以下步骤：

1.  **身份验证绕过：** 攻击者通过发送带有伪造 `Referer` 头的 HTTP POST 请求到 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit` 页面，绕过身份验证。
2.  **反序列化RCE：** 利用特权端点提交包含恶意序列化数据的Payload, 实现远程代码执行。通常通过上传恶意 ASPX WebShell（例如 `spinstall0.aspx`）。
3.  **WebShell部署和秘钥窃取:** 执行上传的webshell，窃取SharePoint配置中的`ValidationKey` 和 `DecryptionKey`。
4.  **完全控制和持久化：** 使用窃取的密钥构造有效的签名Payload，实现持久化RCE。即使应用补丁后，攻击者仍然可以通过窃取的密钥保持访问，除非密钥被轮换。

**利用有效性：**

根据漏洞描述和POC代码，此漏洞利用方法是有效的，因为已经有在野利用的证据。搜索引擎结果也证实了这一点。

**投毒风险：**

POC代码本身主要描述漏洞原理和利用方式，并未发现明显的恶意代码或者后门。然而，存在一定投毒风险 (10%)。这是因为:

1.  **Web Shell 的不确定性：** POC代码中提到了Web Shell的上传。虽然没有直接给出Web Shell的代码，但攻击者可能会使用包含恶意功能的Web Shell，从而引入风险。
2.  **依赖外部资源：** 该漏洞利用依赖于特定的SharePoint配置和库，攻击者可能通过修改这些依赖来引入恶意行为。
3. **README.md中的外部链接:** 引用了外部链接, 存在引用内容被恶意篡改的风险.

**漏洞利用方式总结：**

1.  发送带有伪造Referer的POST请求绕过身份验证。
2.  上传并执行包含恶意反序列化数据的ASPX webshell。
3.  通过WebShell窃取SharePoint服务器的machine keys(ValidationKey和DecryptionKey)。
4.  使用窃取的密钥构造恶意Payload，实现持久化远程代码执行。

**项目地址:** [bharath-cyber-root/sharepoint-toolshell-cve-2025-53770](https://github.com/bharath-cyber-root/sharepoint-toolshell-cve-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)