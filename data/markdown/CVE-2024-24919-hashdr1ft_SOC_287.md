## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备已连接到互联网，并启用了远程访问VPN或移动访问软件模块。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-24919 是一个 Check Point Security Gateway 的信息泄露漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取受影响设备上的任意文件。漏洞利用代码（SOC287 - Arbitrary File Read on Checkpoint Security Gateway）提供了一个安全分析的场景，演示了如何检测和分析利用此漏洞的攻击。 

**有效性：**
根据CISA KEV和rapid7等厂商的分析，该漏洞已被积极利用。该POC通过模拟攻击场景，成功读取了/etc/passwd等敏感文件，因此该漏洞的有效性很高。

**投毒风险：**
提供的漏洞利用代码主要是一个安全分析场景，描述了如何检测和分析针对 CVE-2024-24919 的攻击。其中不包含任何恶意代码或后门程序。 该文档的目的是为了帮助安全分析师了解攻击过程，而不是提供可直接使用的恶意利用程序，因此投毒风险评估为0%。

**利用方式：**
1.  **漏洞原理：** 漏洞是由于 Check Point Security Gateway 在处理特定请求时，未对用户输入进行充分的验证和过滤，导致路径遍历漏洞。
2.  **攻击步骤：** 攻击者通过构造包含恶意路径的 HTTP 请求，发送给受影响的 Check Point Security Gateway 设备。
3.  **Payload示例：** 根据分析，攻击者可能构造包含"/etc/passwd" 或 "/etc/shadow"等敏感文件路径的请求，以读取系统文件。
4.  **成功利用：** 如果漏洞利用成功，攻击者可以获取到未经授权的敏感信息，如用户名、密码哈希等。 

总结：CVE-2024-24919 是一个高危漏洞，利用简单，影响严重。需要及时安装补丁以避免被利用。

**项目地址:** [hashdr1ft/SOC_287](https://github.com/hashdr1ft/SOC_287)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)