## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite dev server 必须使用 `--host` 或者 `server.host` 暴露到网络

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30208 是 Vite 开发服务器中的一个任意文件读取漏洞。由于 Vite 在处理 URL 时对 `?raw??` 的处理不当，导致攻击者可以绕过 `@fs` 的文件访问限制，读取服务器上的任意文件。

**有效性：**
根据漏洞描述、搜索结果（存在多个PoC）和提供的漏洞利用代码，该漏洞利用是有效的。提供的Python脚本实现了对该漏洞的扫描和利用，通过构造带有 `?raw??` 或 `?import&raw??` 的 URL，尝试读取目标服务器上的 `/etc/passwd` 文件来验证漏洞是否存在。

**投毒风险：**
分析提供的漏洞利用代码，发现投毒的概率较低。代码主要功能是扫描和利用 CVE-2025-30208 漏洞，没有发现明显的恶意代码或后门。但是依然存在一定的风险，因为脚本可以访问任意 URL，如果黑客可以控制扫描的URL列表，可能诱导用户扫描包含恶意代码的服务器，从而达到投毒的目的。

**利用方式：**
1.  **环境要求：** 目标 Vite dev server 需要开启 `--host` 或者 `server.host` 允许外部访问。
2.  **构造Payload：** 构造包含 `?raw??` 或 `?import&raw??` 的 URL，例如 `http://example.com/index.js?raw??`。
3.  **发送请求：** 将构造好的 URL 发送到目标服务器。
4.  **读取文件：** 如果服务器存在漏洞，将返回目标文件的内容。PoC中使用`/etc/passwd?raw??` 作为测试，尝试读取系统敏感文件，攻击者可以替换为其他文件。

**缓解措施：**
*   升级 Vite 到 >= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3 版本。
*   避免将 Vite dev server 暴露到公共网络。
*   限制对 Vite dev server 的访问。

**项目地址:** [0xshaheen/CVE-2025-30208](https://github.com/0xshaheen/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)