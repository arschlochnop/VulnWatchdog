## CVE-2025-32462

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，本地权限提升

**影响版本:** 1.8.8 <= Sudo < 1.9.17p1

**利用条件:** 需要存在特定的sudoers配置，即定义了既非当前主机也非ALL的主机别名。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32462 漏洞存在于 Sudo 1.9.17p1 之前的版本中。当 sudoers 文件中配置了主机别名，并且该别名不是当前主机也不是 ALL 时，经过身份验证的用户可以在不应该执行命令的机器上执行命令，从而导致权限提升。

**有效性：**

根据提供的漏洞库信息、搜索结果以及漏洞利用代码，POC 代码是有效的。漏洞利用代码提供了一个 Dockerfile 来构建一个包含存在漏洞的 Sudo 版本的环境，并且提供了利用 CVE-2025-32462 的具体步骤。

**投毒风险：**

根据提供的代码，投毒风险较低。风险主要来自于 Dockerfile 中下载 Sudo 源码的步骤。理论上，如果 sudo.ws 网站被攻破，下载的源码可能被篡改，从而引入恶意代码。此外，`cve_2025_32463.c` 是一个利用代码,用于提权,不能算投毒代码. 但是，考虑到作者声明“For educational purposes only”，并提供了详细的漏洞信息，因此判定投毒的可能性较低，风险占比约为 5%。

**利用方式：**

1.  **环境准备:** 使用 Dockerfile 构建一个包含存在漏洞的 Sudo 版本的环境 (Sudo 1.9.16p2)。
2.  **配置Sudoers:** 在容器内部，修改 `/etc/sudoers` 文件，定义主机别名 `HIGH` 和 `LOW`，并配置用户 `pwn` 在 `HIGH` 主机上可以以 root 权限执行所有命令，但在 `LOW` 主机上不行（`!LOW` 表示排除）。
3.  **漏洞触发:** 用户 `pwn` 使用 `sudo -h highpriv.test.local id` 命令，尝试在 `lowpriv.test.local` 主机上以 `highpriv.test.local` 主机的身份执行 `id` 命令。由于漏洞的存在，Sudo 会错误地允许该命令执行，从而导致权限提升。
4.  **权限提升:** 通过以上步骤，原本在 `lowpriv.test.local` 主机上无法使用 sudo 的用户 `pwn`，成功以 root 权限执行了 `id` 命令。

**项目地址:** [MAAYTHM/CVE-2025-32462_32463-Lab](https://github.com/MAAYTHM/CVE-2025-32462_32463-Lab)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)