## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致身份冒用和NTLM relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021 和 Microsoft 365 Apps for Enterprise的特定版本。

**利用条件:** 攻击者需要向受害者发送包含特制ReminderSoundFile属性的电子邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是 Microsoft Outlook 中的一个权限提升漏洞。该漏洞源于 Outlook 在处理提醒声音文件路径时存在缺陷。攻击者可以通过创建一个包含指向恶意 UNC 路径的 ReminderSoundFile 属性的电子邮件或会议邀请来利用此漏洞。当 Outlook 客户端尝试加载该声音文件时，会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希，攻击者可以利用该哈希进行 NTLM relay 攻击，从而冒充受害者。

**有效性：** 提供的 PowerShell POC 代码利用了 Outlook 的 ReminderSoundFile 属性来触发漏洞。该代码创建一个带有特定设置的会议邀请，并将 ReminderSoundFile 设置为指向攻击者控制的 UNC 路径。当受害者的 Outlook 客户端处理此会议邀请时，会尝试访问该 UNC 路径，从而暴露 Net-NTLMv2 哈希。

**投毒风险：** 提供的 POC 代码本身不包含任何明显的恶意代码或后门。它只是一个简单的漏洞演示脚本，用于验证漏洞的存在。README.md 文件也只是解释了漏洞原理和POC代码的使用方法。因此，投毒风险为0%。

**利用方式：**

1.  攻击者创建一个恶意的电子邮件或会议邀请，其中包含特制的 ReminderSoundFile 属性，指向攻击者控制的 UNC 路径（例如：\\attacker.com\share\sound.wav）。
2.  攻击者将该电子邮件或会议邀请发送给受害者。
3.  当受害者的 Outlook 客户端收到并处理该邮件时，会尝试访问 ReminderSoundFile 中指定的 UNC 路径。
4.  Outlook 客户端会向攻击者的 SMB 服务器发送用户的 Net-NTLMv2 哈希。
5.  攻击者截获该哈希并使用它进行 NTLM relay 攻击，从而冒充受害者访问网络资源或执行其他恶意操作。

根据搜索引擎结果，此漏洞已被积极利用，CISA 已将其添加到已知被利用的漏洞目录中。因此，及时修补 Outlook 至关重要。

**项目地址:** [ka7ana/CVE-2023-23397](https://github.com/ka7ana/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)