## CVE-2023-36802 Microsoft Streaming Service Proxy Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-36802

**漏洞类型:** 权限提升

**影响应用:** Microsoft Streaming Service Proxy

**危害等级:** 高危，本地权限提升到SYSTEM

**影响版本:** 见漏洞库信息中的受影响版本

**利用条件:** 需要本地访问权限，目标系统版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-36802 是 Microsoft Streaming Service Proxy 的权限提升漏洞。根据漏洞库信息，此漏洞是一个 Use-After-Free 漏洞。搜索引擎结果显示，该漏洞被实际利用（in the wild）。提供的漏洞利用代码是一个 Visual Studio 工程，包含一个可执行程序 `Windows_MSKSSRV_LPE_CVE-2023-6802.exe`，需要编译后使用。使用方法是 `Windows_MSKSSRV_LPE_CVE-2023-6802.exe <pid>`，其中 `<pid>` 是目标进程的进程ID。成功利用后，目标进程将被提升到 SYSTEM 权限。POC代码中提及使用I/O Ring LPE, 结合`securityintelligence.com`的报告，漏洞利用可能涉及到通过操纵I/O Ring机制来实现Use-After-Free。 

**有效性：** 提供的POC代码在特定版本（Windows 11 22H2）上完整可用，其它版本需要修改适配，因此初步判断POC有效。

**投毒风险：** 投毒风险评估为10%。虽然POC代码的注释中提到“For demonstration purposes only”和“Adapting the exploit to all vulnerable systems is left as an exercise to the reader”，这可能意味着该POC并未实现完全通用的利用。但是代码引用了I/O Ring R/W的PoC，考虑到完整的利用需要结合具体的系统环境进行调整，且作者明确说明了部分限制，初步判断不存在明显的恶意投毒代码，但依然需要仔细审查编译后的二进制文件。风险主要来自于用户自己修改代码或者使用未经验证的编译版本，增加了潜在风险，无法完全排除被植入后门的可能。 

**利用方式：** 
1.  攻击者需要获取目标系统上的本地访问权限。
2.  确定目标系统是否在受影响的版本范围内。
3.  编译提供的 Visual Studio 工程。
4.  找到要提升权限的目标进程的进程ID。
5.  运行 `Windows_MSKSSRV_LPE_CVE-2023-6802.exe <pid>`。
6.  如果利用成功，目标进程将以 SYSTEM 权限运行。

**项目地址:** [chompie1337/Windows_MSKSSRV_LPE_CVE-2023-36802](https://github.com/chompie1337/Windows_MSKSSRV_LPE_CVE-2023-36802)

**漏洞详情:** [CVE-2023-36802](https://nvd.nist.gov/vuln/detail/CVE-2023-36802)