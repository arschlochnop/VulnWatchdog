## CVE-2016-6210 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 信息泄露/用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举系统上的有效用户名

**影响版本:** OpenSSH 7.3 之前版本

**利用条件:** 目标系统使用 SHA256 或 SHA512 进行用户密码哈希

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6210 漏洞存在于 OpenSSH 7.3 之前的版本中。当 OpenSSH 使用 SHA256 或 SHA512 对用户密码进行哈希时，如果提供的用户名不存在，sshd 会使用 BLOWFISH 算法对一个静态密码进行哈希。由于 BLOWFISH 算法的计算时间相对较长，攻击者可以通过测量响应时间来区分用户名是否存在，从而实现用户枚举。

**有效性评估：**

提供的 POC 代码（/tmp/617d0360b00dd111dff7f3cc45a81e2e/main.py）通过测量 SSH 认证的耗时来判断用户是否存在。代码首先建立 SSH 连接池，然后对一系列不存在的用户进行认证，以建立基线耗时。接着，代码对目标用户进行认证，如果认证耗时明显高于基线耗时，则认为用户存在。该方法利用了 CVE-2016-6210 漏洞的 timing 特性，因此该 POC 代码是有效的。

搜索引擎结果中，也存在大量关于 CVE-2016-6210 的信息，包括漏洞描述、影响范围、修复方案以及相关的 Exploit-DB 链接。例如，rapid7 上的漏洞描述页面确认了该漏洞的存在，并提供了相关的漏洞分析。GitHub 上也有该漏洞的利用代码。

**投毒风险评估：**

经过对 POC 代码的分析，未发现任何恶意代码或后门。代码的功能是利用 timing 侧信道来枚举用户，不涉及任何提权或其他恶意行为。因此，该 POC 代码的投毒风险为 0%。

**利用方式：**

1.  攻击者首先需要确定目标系统运行的是 OpenSSH 7.3 之前的版本，并且使用了 SHA256 或 SHA512 进行用户密码哈希。
2.  攻击者使用提供的 POC 代码，指定目标主机的 IP 地址、端口、用户名列表等参数。
3.  POC 代码会建立 SSH 连接池，并对用户名列表中的每个用户进行认证尝试。
4.  代码会测量每次认证尝试的耗时，并与基线耗时进行比较。
5.  如果认证耗时明显高于基线耗时，则认为该用户存在。
6.  最终，POC 代码会输出所有存在的用户名。

**项目地址:** [nicoleman0/CVE-2016-6210-OpenSSHd-7.2p2](https://github.com/nicoleman0/CVE-2016-6210-OpenSSHd-7.2p2)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)