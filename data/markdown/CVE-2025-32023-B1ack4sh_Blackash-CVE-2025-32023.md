## CVE-2025-32023-Redis-RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Redis

**危害等级:** 高危，可导致完全控制 Redis 服务器

**影响版本:** 2.8.0 < version < 8.0.3 (具体受影响版本见漏洞库信息)

**利用条件:** 需要 Redis 服务运行，且用户具有一定权限（ACL 限制可能影响利用）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-32023 是 Redis 中 HyperLogLog (HLL) 操作中的越界写入漏洞，可能导致远程代码执行。漏洞存在于多个 Redis 版本中（2.8 到 8.0.3 之前的一些版本，具体请参考漏洞库信息）。

**有效性：**
根据漏洞利用代码，该漏洞利用通过构造畸形的 sparse HLL 数据结构，触发 `hllMerge` 和 `hllSparseToDense` 操作中的整数溢出，从而导致堆越界写入。利用过程包括：
1.  创建 malformed sparse hll
2.  使用 pfmerge 触发漏洞利用
3.  利用 jemalloc 堆分配机制，在堆上喷射大量对象
4.  在堆中搜索特定标记，以确定目标对象地址，并最终实现RCE. 
从代码逻辑来看，该POC是有效的。

**投毒风险：**
分析代码，主要的利用逻辑集中在提供的三个`.py`文件中，其中一个用于创建畸形数据，一个用于触发漏洞，另一个（solver-CVE-2025-32023.py）则包含更完整的利用链，包括堆喷射、地址泄露等。`README.md`文件仅为漏洞的描述和利用条件。

虽然代码本身实现了漏洞利用，但仍存在一定的投毒风险。风险主要在于：
1.  **依赖复杂性：**`solver-CVE-2025-32023.py` 的成功利用依赖于堆喷射、地址泄露，以及与特定 Redis 版本的 jemalloc 堆布局的兼容性。攻击者可能在代码中加入一些细微的修改，使得该 EXP 仅在特定条件下才能成功运行，或者依赖于一些不易察觉的系统配置，使得其他研究人员难以复现，从而掩盖其真实目的。
2.  **后门植入：** 攻击者可能在堆喷射过程中，向内存中写入恶意的 shellcode 或者其他后门代码。虽然当前的 POC 中没有直接发现后门代码，但这种可能性仍然存在。

因此，综合来看，投毒风险大约为 10%。这主要是因为，尽管代码功能相对明确，但由于漏洞利用的复杂性，攻击者仍然存在通过精心构造利用条件，或者植入隐蔽后门的方式进行攻击的可能性。

**利用方式：**
利用方式为：
1.  攻击者首先需要能够与 Redis 服务器建立连接，并具有执行 HyperLogLog 相关命令的权限（可能需要绕过 ACL 限制）。
2.  利用 Python 脚本构造畸形的 sparse HLL 数据结构，并将其存储在 Redis 中。
3.  执行 `pfmerge` 或 `pfcount` 等 HLL 命令，触发漏洞。
4.  成功触发漏洞后，攻击者可以实现任意代码执行，例如加载恶意模块，控制 Redis 服务器。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-32023](https://github.com/B1ack4sh/Blackash-CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)