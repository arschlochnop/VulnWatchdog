## CVE-2019-9978-Social-Warfare-Stored-XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致会话劫持、恶意重定向、网页内容篡改

**影响版本:** < 3.5.3

**利用条件:** 需要安装存在漏洞版本的Social Warfare插件，并且目标WordPress站点的`swp_debug`参数未被禁用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是一个存在于WordPress Social Warfare插件3.5.3版本之前的存储型XSS漏洞。该漏洞允许攻击者通过`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`参数注入恶意JavaScript代码，这些代码将存储在服务器上，并在用户访问包含此恶意代码的页面时执行。PoC代码通过启动一个简单的HTTP服务器，然后将包含恶意代码的URL发送到目标站点。目标站点获取恶意代码并存储，最终在其他用户访问站点的时候触发XSS。

根据提供的漏洞利用代码，脚本通过构造包含恶意代码的HTTP请求发送到目标WordPress站点。恶意代码通过GET参数`swp_url`传递，并且通过设置`swp_debug=load_options`来触发漏洞。

在评估投毒风险时，审查提供的Python脚本 `cve-2019-9978.py` 和 `README.md` 文件后，没有发现任何明显的恶意代码或后门。 该脚本的功能集中于利用已知的XSS漏洞，而不是试图引入任何有害功能。 脚本的功能是创建一个HTTP服务器以提供Payload，然后使用payload发起请求，脚本没有发现任何隐藏或不必要的功能，也没有执行任何可疑的操作。 漏洞利用代码的意图明确，仅用于概念验证和测试， 因此，代码中包含恶意投毒的可能性很低。

漏洞利用方式：
1.  攻击者需要找到安装了Social Warfare插件且版本低于3.5.3的WordPress站点。
2.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://target.com/wp-admin/admin-post.php?swp_debug=load_options&swp_url=<script>alert('XSS')</script>`
3.  攻击者将构造的URL发送给目标站点。
4.  目标站点处理请求，并将恶意代码存储在数据库中。
5.  当管理员或其他用户访问包含恶意代码的页面时，恶意代码将在用户的浏览器中执行。

**项目地址:** [0xMoonrise/cve-2019-9978](https://github.com/0xMoonrise/cve-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)