## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1

**利用条件:** Web UI 功能已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞创建一个具有 15 级权限（完全访问所有命令）的本地用户。攻击者首先利用 CVE-2023-20198 获得初始访问权限，然后执行权限 15 命令来创建本地用户和密码组合，允许该用户以普通用户身份登录。 然后攻击者利用 web UI 功能的另一个组件，利用新的本地用户将权限提升到 root 并将植入程序写入文件系统，cve-2023-20273。

**有效性：**
根据搜索引擎结果（例如Horizon3.ai的博客），已经存在公开可用的PoC，并且漏洞被积极利用。提供的Ansible剧本并不是直接的漏洞利用代码，而是用于检测并禁用HTTP/HTTPS服务器以缓解漏洞。它也能检测是否已经遭受攻击，通过分析syslog。

**投毒风险：**
提供的Ansible剧本的主要目的是缓解漏洞，而不是利用漏洞。虽然其中包含连接到Cisco设备的凭据（developer/lastorangerestoreball8876），但这些是 Cisco Always On Sandbox 的公开凭据，用于测试目的。 投毒风险较低，但仍然存在一些风险：

1.  **凭据滥用：**  即使凭据是公开的，也可能有人修改剧本以使用不同的凭据尝试访问其他Cisco设备。
2.  **远程执行：**  Ansible 剧本在目标设备上执行命令。如果剧本被恶意修改，可能会导致设备配置更改或执行其他恶意操作。 鉴于此，大约有10%的可能性存在投毒风险。

**利用方式：**
1.  **初始访问：**  攻击者利用 CVE-2023-20198 中的漏洞，绕过身份验证。
2.  **创建高权限用户：**  攻击者利用未授权访问，创建一个具有 15 级权限的本地用户。
3.  **权限提升(CVE-2023-20273):** 攻击者利用本地用户权限和Web UI的另一个漏洞，将权限提升到 root。
4.  **植入后门：**  攻击者利用 root 权限，在设备上植入后门，以便长期控制。

**项目地址:** [emomeni/Simple-Ansible-for-CVE-2023-20198](https://github.com/emomeni/Simple-Ansible-for-CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)