## CVE-2025-24813-Apache Tomcat-RCE/信息泄露

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= 9.0.98, 10.1.0-M1 <= 10.1.34, 11.0.0-M1 <= 11.0.2

**利用条件:** 需要满足以下全部条件：1. DefaultServlet 写入功能已启用 (默认关闭)；2. 支持 partial PUT 请求 (默认开启)；3. 使用 Tomcat 文件会话持久化和默认存储位置；4. 应用包含存在反序列化漏洞的库。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者可以通过 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或将恶意内容添加到上传的文件中。利用此漏洞需要DefaultServlet开启写入，支持partial PUT，且应用使用了Tomcat的文件会话保持，并包含可被利用的反序列化库。提供的POC首先上传包含恶意序列化数据的分块文件到会话文件存储位置，然后通过访问触发反序列化。

**漏洞利用方式：**

1.  **前提条件检查：** 确保目标Tomcat实例满足漏洞利用的全部条件，包括DefaultServlet启用写入，支持partial PUT，使用了默认的文件会话存储位置，以及包含可利用的反序列化库。
2.  **会话ID获取：** 访问Tomcat应用获取JSESSIONID Cookie，用于后续的会话文件操作。
3.  **恶意序列化数据准备：** 构造包含恶意代码的序列化对象，该对象利用目标应用中的反序列化漏洞执行任意代码。
4.  **分块上传恶意数据：** 使用PUT请求，通过Content-Range头部指定分块大小，将恶意序列化数据分块上传到Tomcat的会话文件存储位置，文件名通常与JSESSIONID相关。
5.  **触发反序列化：** 通过发送包含特定JSESSIONID Cookie的GET请求或其他HTTP请求，触发Tomcat加载和反序列化之前上传的恶意会话文件，从而执行恶意代码。

**投毒风险分析：**

该仓库主要提供复现环境和PoC，本身的代码较为简单，但存在一定的投毒风险：
* **复现环境配置修改：** 作者为了方便漏洞复现，提供的环境配置可能包含潜在的安全风险，例如，默认开启了DefaultServlet的写入功能，这本身就是一个不安全的配置。
* **恶意序列化数据构造：** PoC的关键在于恶意序列化数据的构造，攻击者可能在构造过程中引入隐藏的后门代码，例如，通过ClassLoader加载远程恶意类，从而实现更隐蔽的远程代码执行。PoC中需要自行构造反序列化文件内容，作者可能并未提供完整的反序列化利用链，需要自行寻找或构造，存在一定门槛，因此投毒的概率较低，估计在20%左右。

总的来说，该漏洞利用的有效性取决于目标环境的配置和应用依赖，利用方式相对复杂，需要一定的技术积累。虽然该复现环境主要用于学习研究，但依然存在一定的投毒风险，需要谨慎使用。

**项目地址:** [x1ongsec/CVE-2025-24813](https://github.com/x1ongsec/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)