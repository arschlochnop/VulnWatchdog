## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的恶意 ZIP 压缩文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 是 WinRAR 在处理 ZIP 压缩文件时存在的远程代码执行漏洞。当 WinRAR 版本低于 6.23 时，如果用户尝试打开一个包含恶意构造的 ZIP 文件，攻击者可以利用此漏洞执行任意代码。该 ZIP 文件包含一个良性文件（例如 JPG 文件）和一个与其同名的文件夹。攻击者可以将可执行文件放置在该文件夹中，当用户尝试访问良性文件时，WinRAR 会错误地执行文件夹中的可执行文件。

**有效性：**
提供的 POC 代码（winDED）通过生成恶意 ZIP 文件来演示漏洞利用。它创建了一个良性文件和一个同名文件夹，并将恶意脚本放入文件夹中。用户双击压缩包中的 PDF 文件时，实际上会执行该恶意脚本，从而证明漏洞的可利用性。

**投毒风险：**
根据提供的 POC 代码，投毒风险较低。代码主要是为了演示漏洞而设计的，虽然存在执行恶意 `super_sneaky_evil_script.bat` 的可能性，但该脚本本身是由用户提供的，或者可以通过查看代码本身来确认其行为。 然而，仍然存在一些细微的风险，例如，如果 `super_sneaky_evil_script.bat` 本身是从其他来源下载的，则可能包含恶意代码。  总的来说, 投毒风险约 10%。

**利用方式：**
1.  创建一个包含良性文件 (例如，`BILLION_DOLLAR_SECRET.pdf`) 和一个同名文件夹 (`BILLION_DOLLAR_SECRET.pdf`) 的 ZIP 压缩文件。
2.  将恶意脚本 (例如，`super_sneaky_evil_script.bat`) 放入同名文件夹中。
3.  诱骗目标用户使用 WinRAR 打开该 ZIP 文件。
4.  当用户尝试打开良性文件时，WinRAR 错误地执行同名文件夹中的恶意脚本，从而实现远程代码执行。

**项目地址:** [r1yaz/winDED](https://github.com/r1yaz/winDED)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)