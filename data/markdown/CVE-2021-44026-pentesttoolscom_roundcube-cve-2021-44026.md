## CVE-2021-44026-Roundcube-SQL注入

**漏洞编号:** CVE-2021-44026

**漏洞类型:** SQL注入

**影响应用:** Roundcube

**危害等级:** 高危，可能导致数据泄露、会话劫持、远程代码执行

**影响版本:** 1.3.x (before 1.3.17), 1.4.x (before 1.4.12)

**利用条件:** 需要能够访问存在漏洞的Roundcube实例，并能够发送电子邮件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-44026 是 Roundcube Webmail 中存在的 SQL 注入漏洞，位于 search 或 search_params 参数中。该漏洞允许未经身份验证的攻击者通过构造恶意的 SQL 语句来执行任意 SQL 代码，从而可能泄露数据库中的敏感信息，如用户凭据、电子邮件内容等，甚至可能导致远程代码执行。

**有效性：**

根据漏洞信息、搜索结果，特别是 pentest-tools.com 的博客和GitHub仓库，可以确定此漏洞真实存在且有可用的PoC。该PoC结合了 CVE-2020-35730（XSS漏洞）和 CVE-2021-44026（SQL注入漏洞）利用链，通过发送包含XSS Payload的邮件，在目标用户会话中执行JavaScript代码，进而利用SQL注入漏洞窃取会话信息和邮件。

**投毒风险：**

分析提供的 POC 代码，投毒风险极低。主要基于以下几点：

*   **代码意图明确：** README.md 中明确声明代码仅用于教育目的和安全测试，并强调了合法授权的重要性。
*   **利用方式清晰：** 代码逻辑较为清晰，通过 XSS 注入 JavaScript 代码，然后利用 SQL 注入窃取数据。没有发现隐藏的、与漏洞利用无关的恶意行为。
*   **外部依赖较少：**  代码依赖的外部库都是常见的 Python 库，且代码量不大，易于审计。
*   **C2 服务器可控：** C2 服务器的 URL 在代码中显式指定，用户可以控制 C2 服务器，从而降低被恶意利用的风险。

虽然代码本身没有明显的投毒行为，但仍需注意：

*   **二次利用风险：**  攻击者可能修改该 PoC 代码，加入恶意功能，例如植入后门或进行大规模数据窃取。
*   **C2 服务器安全：**  C2 服务器本身可能存在安全漏洞，攻击者可能利用 C2 服务器控制受害者系统。

因此，尽管 PoC 代码本身的投毒风险较低，但用户在使用时仍需保持警惕，确保 C2 服务器的安全，并对代码进行必要的安全审计。

**利用方式：**

1.  **XSS 注入：**  发送一封包含特殊构造的邮件，该邮件利用 CVE-2020-35730 XSS 漏洞，在目标用户的 Roundcube 会话中执行 JavaScript 代码（fetcher.js）。
2.  **SQL 注入：**  JavaScript 代码构造恶意的 SQL 查询，利用 CVE-2021-44026 SQL 注入漏洞，从 Roundcube 数据库中提取会话信息（例如，`session_id`）。
3.  **数据提取：**  JavaScript 代码将提取的会话信息和最近的邮件数据，通过 HTTP 请求发送到 C2 服务器。
4.  **会话劫持/数据泄露：**  攻击者在 C2 服务器上获取会话信息后，可以劫持目标用户的会话，并访问其电子邮件。

该漏洞利用链需要结合 XSS 和 SQL 注入，并且需要用户交互（打开包含恶意 XSS 的邮件）。

**项目地址:** [pentesttoolscom/roundcube-cve-2021-44026](https://github.com/pentesttoolscom/roundcube-cve-2021-44026)

**漏洞详情:** [CVE-2021-44026](https://nvd.nist.gov/vuln/detail/CVE-2021-44026)