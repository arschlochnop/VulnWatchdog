## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要获得Exchange用户的有效凭据（用户名和密码）和目标Exchange服务器的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，原因是 Exchange 在安装时未能正确创建唯一的密钥。攻击者可以利用已知密钥对 ViewState 数据进行反序列化，从而在服务器上执行任意代码。

**漏洞利用方式：**

1.  **获取凭据：** 攻击者首先需要获取一个有效的 Exchange 用户名和密码。这可以通过网络钓鱼、密码猜测或其他凭据窃取技术实现。
2.  **身份验证：** 使用获取的凭据登录 Exchange 的 OWA (Outlook Web App) 或 ECP (Exchange Control Panel)。
3.  **ViewState 反序列化：** 攻击者构造一个恶意的 ViewState，其中包含要执行的命令。该 ViewState 使用已知的 MachineKeySection 密钥进行签名和加密。
4.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`default.aspx`）。
5.  **远程代码执行：** Exchange 服务器使用已知的密钥解密和反序列化 ViewState。由于 ViewState 包含恶意代码，因此服务器会在当前进程的上下文中执行该代码。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用是有效的。搜索引擎结果中包含了多个利用案例和警告，表明该漏洞已被广泛利用。

**投毒风险：**

提供的 POC 代码片段主要用于检测漏洞是否存在，并执行简单的命令。 虽然代码的目的是为了检测而非恶意活动， 但是仍需要注意。由于该漏洞允许远程代码执行，攻击者有可能可以替换检测 payload 为恶意 payload，从而进行投毒。因此存在一定的投毒风险。 由于代码相对简单，且目标明确，因此投毒风险较低，约10%。


**项目地址:** [chudamax/CVE-2020-0688-Exchange2010](https://github.com/chudamax/CVE-2020-0688-Exchange2010)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)