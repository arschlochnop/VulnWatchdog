## CVE-2025-48799 Windows Update Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-48799

**漏洞类型:** 特权提升

**影响应用:** Windows Update Service

**危害等级:** 高危，允许本地攻击者提升权限。

**影响版本:** 受影响的Windows 10, Windows 11 和 Windows Server 版本详见漏洞库信息。

**利用条件:** 需要至少两个硬盘驱动器，且Storage Sense已配置将新的应用程序保存到辅助驱动器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-48799 是 Windows Update 服务中的一个特权提升漏洞。该漏洞源于 Windows Update 服务在执行文件操作前未正确解析链接（符号链接）。当系统拥有多个硬盘，并且配置了 Storage Sense 将应用程序安装到第二个硬盘时，攻击者可以通过创建符号链接指向受保护的系统目录，利用 wuauserv 服务在安装应用程序时执行任意文件删除操作，从而实现本地特权提升。

**漏洞利用方式：**

1.  **环境准备：** 目标系统需要至少两个硬盘驱动器，并在Storage Sense设置中将应用安装位置设定在第二个硬盘。
2.  **创建符号链接：** 在非系统盘(例如第二个硬盘)上，创建指向系统目录的符号链接（例如，指向 `C:\Windows\System32`）。
3.  **触发安装：** 触发Windows Update安装新的应用或者更新。由于Storage Sense配置，安装过程会将文件写入（或者删除）到第二个硬盘上。
4.  **利用删除：** Windows Update服务尝试删除第二个硬盘上的目录时，由于符号链接的存在，会尝试删除系统目录下的文件，由于权限不足以删除任意文件，因此需要精心构造符号链接指向的特定文件，实现特权提升。

**有效性：**

根据漏洞描述，搜索引擎结果以及PoC代码，此漏洞利用是有效的。PoC代码仓库中提供了漏洞的利用说明和PoC代码。

**投毒风险：**

代码库中的风险较低，但是不排除作者可能隐藏一些恶意代码,例如搜集用户电脑信息等,虽然概率较低，但仍需保持警惕，因此投毒风险评估为 5%。 务必仔细检查和审计代码，确保在实际环境中使用前，代码没有被篡改或植入恶意逻辑。

总体来说，此漏洞风险较高，需要及时修复，在利用此PoC前务必进行代码审计。

**项目地址:** [painoob/CVE-2025-48799](https://github.com/painoob/CVE-2025-48799)

**漏洞详情:** [CVE-2025-48799](https://nvd.nist.gov/vuln/detail/CVE-2025-48799)