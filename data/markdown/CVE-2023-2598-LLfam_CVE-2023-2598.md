## CVE-2023-2598 - Linux Kernel io_uring Out-of-bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598是Linux Kernel io_uring子系统中的一个漏洞，位于`io_sqe_buffer_register`函数中。该函数在注册固定缓冲区时存在缺陷，导致可以越界访问物理内存。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据NVD、RedHat等漏洞库信息以及GitHub上的POC代码（`ysanatomic/io_uring_LPE-CVE-2023-2598`），可以判断此漏洞POC代码有效。github上的POC也已经验证了漏洞的存在。

**投毒风险：**
查看给出的POC代码，发现代码主要实现了以下功能：定义了大量的结构体偏移，以便于进行内存篡改；设置了socket buffer size，并进行了io_uring的初始化。通过覆写内核函数指针最终实现了本地权限提升。从代码逻辑来看，该POC代码实现的是漏洞验证和利用，主要功能是利用漏洞提升权限。考虑到github上已经存在公开的POC代码，并且该漏洞影响较大，攻击者更容易从其他来源获取可靠的利用代码。因此，虽然代码本身较长，存在一定隐藏恶意代码的可能，但是没有发现明显的恶意投毒行为,例如植入后门或远程控制等行为。只是单纯的提权操作,所以认为投毒风险较低，约为10%。

**利用方式：**
1.  利用`io_uring_register`系统调用注册固定缓冲区。
2.  由于`io_sqe_buffer_register`函数中的缺陷，注册的缓冲区可以超出实际分配的内存范围，导致越界访问。
3.  通过越界写操作，覆盖内核数据结构中的关键字段，如函数指针等。
4.  触发被覆盖的函数指针，执行恶意代码，从而实现本地权限提升。
5.  具体来说，POC代码通常会覆盖`sock_def_readable`或者`call_usermodehelper_exec`等关键函数指针，执行预先准备好的payload，达到root权限。

**项目地址:** [LLfam/CVE-2023-2598](https://github.com/LLfam/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)