## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可使本地低权限用户获得root权限

**影响版本:** Polkit 0.119

**利用条件:** 本地用户，目标系统安装并运行存在漏洞的Polkit版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 允许攻击者通过绕过 D-Bus 请求的凭据检查，将请求者的权限提升为 root 用户。漏洞利用方式如下：

1.  **漏洞描述：** Polkit 在处理 D-Bus 请求时，存在身份验证绕过漏洞，攻击者可以利用该漏洞以 root 身份执行操作。
2.  **利用方式分析：**
    *   提供的`exploit.sh`脚本尝试利用该漏洞添加用户和设置密码。
    *   脚本通过`dbus-send`命令与`org.freedesktop.Accounts`服务进行交互，尝试创建用户和修改密码。
    *   脚本的实现利用了一个竞争条件，尝试在服务响应前终止连接，从而绕过权限验证。
3.  **有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且有公开的利用代码。提供的POC脚本尝试利用时间竞争，如果目标环境满足竞争条件的要求，则POC可能是有效的。
4.  **投毒风险：**
    *   `README.md`文件只包含漏洞名称和CTF的描述，未发现任何可疑代码。
    *   `exploit.sh`脚本本身没有发现明显的恶意代码，其行为符合漏洞利用的预期。虽然脚本尝试利用竞争条件，但这不是恶意投毒行为，而是利用漏洞的手段。
    *   因此，判断该仓库中不存在作者隐藏的投毒代码的可能性为0%。
5.  **利用方式总结：** 攻击者利用Polkit的身份验证绕过漏洞，通过构造特定的D-Bus请求，在请求处理过程中利用竞争条件，绕过权限验证，从而创建具有root权限的用户或者执行其他需要root权限的操作，最终提升到root权限。

总体而言，此漏洞是一个严重的安全问题，应该尽快修补。

**项目地址:** [cpu0x00/CVE-2021-3560](https://github.com/cpu0x00/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)