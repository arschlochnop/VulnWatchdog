## CVE-2025-57819 - FreePBX Unauthenticated SQL Injection to RCE

**漏洞编号:** CVE-2025-57819

**漏洞类型:** SQL Injection, Authentication Bypass, RCE

**影响应用:** FreePBX

**危害等级:** Critical，未授权远程代码执行

**影响版本:** < 15.0.66, < 16.0.89, < 17.0.3

**利用条件:** 目标FreePBX实例存在漏洞，且可从攻击者控制的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57819是一个FreePBX中的严重漏洞，它允许未经身份验证的攻击者绕过身份验证，执行任意SQL注入攻击，并最终可能导致远程代码执行（RCE）。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞是有效的。搜索引擎结果中多个来源（NVD、Watchtowr、Ionix、CISA等）确认了该漏洞的存在，并将其描述为身份验证绕过和SQL注入，最终导致RCE。POC代码`poc_admin.py`通过构造恶意的SQL查询来创建一个新的FreePBX管理员用户，证明了攻击的可行性。`poc_auto_get_username_pass.py` 利用sqlmap自动化批量提取用户名和密码哈希值，进一步验证了漏洞的危害。

**投毒风险分析：**

查看了给出的poc_admin.py代码，代码逻辑清晰，主要功能是利用SQL注入创建管理员用户。没有发现明显的后门代码或者恶意逻辑。但是考虑到安全风险，仍然不能完全排除投毒的可能性，主要基于以下几点：

*   **依赖风险：** `poc_auto_get_username_pass.py` 依赖外部工具 `sqlmap`，如果用户使用的 `sqlmap` 版本被篡改，则存在风险。
*   **网络风险：** PoC需要通过网络发送请求，存在中间人攻击的风险，攻击者可能篡改请求或响应。
*   **隐蔽后门：** 即使当前代码看起来安全，也不能排除作者未来更新版本时添加恶意代码的可能性。
*   **代码审查不足：** 尽管进行了初步审查，但可能存在审查人员未发现的隐蔽后门。

综合考虑，投毒风险较低，估计为 10%。

**利用方式：**

1.  **身份验证绕过：** 攻击者利用未充分过滤的用户输入，绕过FreePBX的身份验证机制。
2.  **SQL注入：** 成功绕过身份验证后，攻击者可以执行任意SQL查询，例如创建新的管理员账户或提取敏感数据。
3.  **远程代码执行（RCE）：** 通过SQL注入，攻击者可以修改数据库中的数据，例如添加恶意配置或执行系统命令，最终实现RCE。

**POC的使用方式：**

*   `poc_admin.py`：此脚本通过向目标FreePBX服务器发送特制的SQL注入查询来创建一个新的管理员用户。用户需要提供目标URL作为参数。
*   `poc_auto_get_username_pass.py`：此脚本使用SQLMap自动从多个目标提取用户名和密码哈希。它需要一个包含目标URL列表的文件。同时该脚本需要在本地安装sqlmap，增加了依赖风险。


**项目地址:** [orange0Mint/CVE-2025-57819_FreePBX](https://github.com/orange0Mint/CVE-2025-57819_FreePBX)

**漏洞详情:** [CVE-2025-57819](https://nvd.nist.gov/vuln/detail/CVE-2025-57819)