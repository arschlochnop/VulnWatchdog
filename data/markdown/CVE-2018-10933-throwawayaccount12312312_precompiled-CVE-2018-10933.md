## CVE-2018-10933-libssh-认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问

**影响版本:** < 0.7.6, < 0.8.4

**利用条件:** 目标服务器运行存在漏洞的libssh版本，且对外开放SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-10933 是 libssh 库中存在的一个认证绕过漏洞。攻击者可以通过在未经身份验证的情况下发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息来绕过身份验证，从而创建通道并执行未授权操作。漏洞影响 libssh 0.6 及以上版本，直到 0.7.6 和 0.8.4 之前的版本。漏洞利用方式主要为：

1.  与目标服务器建立SSH连接。
2.  发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，欺骗服务器认为用户已通过身份验证。
3.  创建新的通道并执行任意操作。

**有效性：** 根据漏洞信息和搜索结果，此漏洞是真实存在的，并且存在公开的漏洞利用代码（参考Exploit-DB 45638）。因此，利用是有效的。

**投毒风险：** 提供的POC代码只有README.md文件,无法确定漏洞利用后门代码。但考虑到漏洞利用的敏感性，以及攻击者可能修改利用代码植入恶意逻辑，仍存在一定的投毒风险。这里给出一个相对较低的百分比估计，因为只看到了README文件，没有实际的利用代码内容。如果代码仓库中包含编译后的二进制文件，需要进行反编译分析，才能判断是否存在恶意后门。如果代码仓库中包含完整的源代码，则投毒风险主要来自构建过程，例如修改Makefile，添加恶意编译选项等。该仓库仅包含README.md，判断投毒风险10%。

**利用方式：**
1. 建立SSH连接。
2. 发送`SSH2_MSG_USERAUTH_SUCCESS`消息绕过认证。
3.  后续可以创建channel，然后执行任意命令，比如执行系统命令等操作。

**项目地址:** [throwawayaccount12312312/precompiled-CVE-2018-10933](https://github.com/throwawayaccount12312312/precompiled-CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)