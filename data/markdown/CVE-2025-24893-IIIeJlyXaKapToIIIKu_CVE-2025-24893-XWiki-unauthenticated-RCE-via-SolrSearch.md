## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** >= 5.3-milestone-2, < 15.10.11 和 >= 16.0.0-rc-1, < 16.4.1

**利用条件:** 需要网络访问XWiki实例，且实例未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24893 是一个 XWiki 平台的远程代码执行漏洞。未经身份验证的攻击者可以通过向 SolrSearch 宏发送特制的请求来利用此漏洞，从而执行任意 Groovy 代码。该漏洞源于 SolrSearch 宏中对用户提供的文本输入的不充分转义，攻击者通过构造特定的payload，提前闭合 Freemarker 模板，并注入 Groovy 代码。提供的 PoC 利用了这一缺陷，通过 URL 参数 `text` 传递恶意 Groovy 代码，最终导致 RCE。PoC 代码中没有发现明显的恶意或投毒代码。利用方式如下：

1.  **漏洞定位：** 漏洞存在于 `/xwiki/bin/get/Main/SolrSearch` 接口。
2.  **Payload构造：** 构造包含恶意 Groovy 代码的 URL， 例如：`/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7d%7d%7d%7b%7basync%20async%3dfalse%7d%7d%7b%7bgroovy%7d%7dprintln(%22cat%20/etc/passwd%22.execute().text)%7b%7b%2fgroovy%7d%7d%7b%7b%2fasync%7d%7d`。
3.  **发送请求：**  向存在漏洞的 XWiki 实例发送构造好的 HTTP GET 请求。
4.  **代码执行：** XWiki 服务端执行 Groovy 代码，攻击者可借此执行任意系统命令。

**有效性：** 根据漏洞库信息，搜索引擎结果，漏洞利用代码分析，此漏洞的POC代码有效。

**投毒风险：** 经过对提供的 PoC 代码 `CVE-2025-24893.py` 和 `README.md` 的内容分析，没有发现作者隐藏的恶意代码或后门，因此判断投毒风险为 0%。PoC 代码的功能集中于漏洞的利用和验证。


**项目地址:** [IIIeJlyXaKapToIIIKu/CVE-2025-24893-XWiki-unauthenticated-RCE-via-SolrSearch](https://github.com/IIIeJlyXaKapToIIIKu/CVE-2025-24893-XWiki-unauthenticated-RCE-via-SolrSearch)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)