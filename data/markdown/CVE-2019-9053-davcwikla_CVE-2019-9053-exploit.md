## CVE-2019-9053-CMS Made Simple-时间盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 2.2.9

**利用条件:** 目标系统安装了CMS Made Simple并且开启了News模块，攻击者可以无需身份验证利用漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对漏洞进行评估如下：

**1. 有效性：**
根据漏洞库信息，CVE-2019-9053是CMS Made Simple 2.2.8版本中的一个漏洞，攻击者可以通过构造恶意的URL，利用News模块中的`m1_idlist`参数进行未授权的时间盲注SQL注入攻击。搜索结果中的Exploit-DB链接(https://www.exploit-db.com/exploits/46635/)和GitHub仓库(https://github.com/Mahamedm/CVE-2019-9053-Exploit-Python-3)表明该漏洞是可利用的，并且存在公开的PoC代码。提供的PoC代码`exploit.py`验证了这一点，它通过改变payload来sleep不同的时间进行盲注。

**2. 投毒风险：**
查看提供的`exploit.py`脚本，主要功能是利用时间盲注SQL注入漏洞提取数据和破解密码。脚本结构相对简单，包含以下几个主要功能：

*   **参数解析：** 使用`optparse`模块解析命令行参数，包括目标URL、字典文件和是否进行密码破解。
*   **Payload构造：**  构造SQL注入payload，利用`sleep()`函数进行时间盲注。
*   **数据提取：**  循环遍历字符集，通过时间延迟判断SQL查询结果，逐步提取数据库信息，如salt和password。
*   **密码破解：**  如果指定了字典文件，则使用提取到的salt和password进行暴力破解。

虽然该脚本主要目的是进行漏洞利用，但仍存在一定的投毒风险。风险点在于：

*   **依赖外部字典文件：** 如果攻击者提供恶意的字典文件，可能会导致拒绝服务或执行恶意代码（虽然这种可能性较低，因为脚本只是比较MD5值）。
*   **代码修改风险：**  脚本执行了密码破解的功能。如果攻击者修改了密码破解的部分，可能加入恶意代码，例如将破解的密码发送到攻击者服务器，或者在目标系统上执行恶意操作。
*   **未授权访问：** 尽管脚本本身没有明显的恶意代码，但其利用SQL注入漏洞获取敏感信息（如用户名、密码）的行为本身就是一种严重的威胁。

综合分析，该PoC脚本的投毒风险较低，约为10%。主要风险在于攻击者可以利用该脚本进行未授权访问，获取敏感信息。另外的风险在于如果使用者不小心使用了恶意构造的字典文件。

**3. 利用方式：**

1.  **确定目标：** 找到存在漏洞的CMS Made Simple网站，并且该网站运行着存在漏洞的News模块（版本 <= 2.2.9）。
2.  **构造Payload：**  使用`exploit.py`脚本，指定目标URL，并设置适当的`TIME`值（即sleep时间，根据网络状况调整）。
3.  **提取Salt和Password：** 运行脚本，脚本会自动构造SQL注入payload，通过时间盲注方式，逐个字符地提取salt和password的MD5哈希值。
4.  **密码破解（可选）：**  如果成功提取到salt和password，可以指定字典文件，使用脚本进行离线密码破解。

**总结：**

CVE-2019-9053是一个高危漏洞，攻击者可以利用该漏洞在未经授权的情况下，通过时间盲注SQL注入获取数据库中的敏感信息。PoC代码有效，但使用时需要注意潜在的投毒风险，尤其是需要谨慎选择和验证使用的字典文件。该漏洞的利用方式较为简单，易于实施。

**项目地址:** [davcwikla/CVE-2019-9053-exploit](https://github.com/davcwikla/CVE-2019-9053-exploit)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)