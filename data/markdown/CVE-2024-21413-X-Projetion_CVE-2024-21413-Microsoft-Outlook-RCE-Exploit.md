## CVE-2024-21413-Microsoft-Outlook-RCE

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，无需用户交互即可远程执行任意代码

**影响版本:** 受影响版本包括 Microsoft Office 2016、2019、LTSC 2021 和 Microsoft 365 Apps for Enterprise，具体版本请参考CVE详情。

**利用条件:** 攻击者需要通过发送特制的电子邮件给受害者。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-21413 漏洞，又名 MonikerLink bug，是一个 Microsoft Outlook 远程代码执行漏洞。攻击者可以通过发送包含恶意链接的电子邮件，在受害者未进行任何交互的情况下执行任意代码。该漏洞的根本原因是 Outlook 在处理 Moniker 链接时存在不当的输入验证。攻击者可以利用此漏洞绕过 Outlook 的安全策略，执行恶意代码。

**有效性：**
从提供的搜索引擎结果和漏洞库信息来看，该漏洞是一个已知的、高危的远程代码执行漏洞，并且有公开的 PoC 代码可用。参考链接 [https://github.com/ThemeHackers/CVE-2024-21413](https://github.com/ThemeHackers/CVE-2024-21413)。因此，提供的 PoC 代码很可能有效。

**投毒风险：**
提供的 PoC 代码包含一个 `exp.sh` 脚本和一个 README.md 文件。
*   `exp.sh` 脚本：该脚本的功能是发送包含恶意链接的电子邮件。其中包含 display_banner函数，send_email函数。`send_email`函数用于发送包含base64编码图片的HTML邮件，邮件内容包含一个URL。从代码本身来看，没有明显的恶意代码或后门，但存在潜在的风险：
    *   该脚本依赖于外部 SMTP 服务器，如果攻击者控制了 SMTP 服务器，可以篡改邮件内容。
    *   base64_image_string 变量中，包含一个PNG图片的Base64编码。攻击者可能会伪造图片内容，嵌入恶意代码，或者使用其他手段达到攻击的目的。
    *   link_url 变量，攻击者可以插入恶意链接，诱导用户点击。
    *   从经验判断，该漏洞的PoC更可能存在于精心构造的link_url, base64_image_string，或者其他的HTML代码片段中，通过某种方式绕过Outlook的安全检查，最终实现RCE，因此存在一定的投毒风险，但直接在exp.sh脚本里投毒的可能性较低。

    考虑到脚本的复杂性，且存在多种潜在的攻击方式，因此认为存在20%的投毒风险。

**利用方式：**
1.  攻击者准备好恶意的`link_url`和`base64_image_string`等变量内容。
2.  攻击者配置`exp.sh` 脚本，指定 SMTP 服务器、端口、用户名、密码、发件人邮箱、收件人邮箱和恶意链接。
3.  攻击者运行 `exp.sh` 脚本，向受害者发送包含恶意链接的电子邮件。
4.  受害者打开电子邮件，Outlook 处理邮件内容时，由于 MonikerLink 漏洞，恶意代码在受害者机器上执行。

综上所述，CVE-2024-21413 是一个高危的远程代码执行漏洞，利用方式简单，但需要精心构造恶意链接和邮件内容才能成功利用，同时要警惕PoC 代码中可能存在的投毒风险。

**项目地址:** [X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit](https://github.com/X-Projetion/CVE-2024-21413-Microsoft-Outlook-RCE-Exploit)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)