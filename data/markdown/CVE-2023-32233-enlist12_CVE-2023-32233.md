## CVE-2023-32233

**漏洞编号:** CVE-2023-32233

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel (Netfilter nf_tables)

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** <= 6.3.1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-32233是一个Linux内核中的use-after-free漏洞，存在于Netfilter nf_tables子系统中，当处理批量请求时可能被触发。根据漏洞库信息和搜索结果，该漏洞允许未经授权的本地用户通过利用此漏洞在内核内存中执行任意读写操作，从而获得root权限。

**有效性：** 根据搜索结果（例如，来自NSFOCUS CERT的通知），漏洞的PoC代码已被公开披露，表明该漏洞是可以被成功利用的。提供的POC代码片段（myconfig）显示了内核配置选项，例如启用`CONFIG_NETFILTER`，`CONFIG_NF_TABLES`和`User namespaces`，并禁用`CONFIG_WERROR`和`CONFIG_RETPOLINE`。这些配置都是为了便于漏洞的利用，并关闭一些缓解措施。综上，提供的POC代码有效。

**投毒风险：** 分析提供的代码片段：

*   `/README.md`： 包含启用和禁用某些内核配置选项的说明。 这些本身不是恶意代码，而是指示如何配置内核以重现或利用漏洞。
*   `/myconfig`： 这是内核配置文件的摘录，用于构建易受攻击的内核。 它本身也不是恶意代码，但它指定了使系统容易受到攻击的配置。

虽然这些文件本身并没有明显的恶意代码，但是有可能在完整的利用代码中隐藏了某些后门。 由于只提供了部分代码（配置文件和README），因此无法完全排除这种可能性。 这里给出一个较低的概率(5%)表示可能存在投毒代码，但缺乏充分证据。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造恶意的Netfilter nf_tables批量请求。
2.  **Use-After-Free：**  由于匿名集合处理不当，这会导致use-after-free情况。
3.  **任意读写：** 利用UAF漏洞在内核内存中执行任意读写操作。
4.  **权限提升：**  攻击者可以通过修改内核数据结构来提升自己的权限，最终获得root权限。

**项目地址:** [enlist12/CVE-2023-32233](https://github.com/enlist12/CVE-2023-32233)

**漏洞详情:** [CVE-2023-32233](https://nvd.nist.gov/vuln/detail/CVE-2023-32233)