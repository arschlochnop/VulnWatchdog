## CVE-2023-34362-MOVEit Transfer-SQL注入

**漏洞编号:** CVE-2023-34362

**漏洞类型:** SQL注入

**影响应用:** MOVEit Transfer

**危害等级:** 高危，可能导致未经授权的数据库访问、信息泄露、数据篡改和远程代码执行

**影响版本:** 所有版本（例如2020.0和2019x）在明确提到的五个版本之前都受影响，包括较旧的不受支持的版本，以及2021.0.6 (13.0.6), 2021.1.4 (13.1.4), 2022.0.4 (14.0.4), 2022.1.5 (14.1.5), 和 2023.0.1 (15.0.1)

**利用条件:** 未经身份验证的远程攻击，可通过HTTP或HTTPS进行利用。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34362是MOVEit Transfer Web应用程序中发现的SQL注入漏洞。未经身份验证的攻击者可以利用此漏洞访问MOVEit Transfer的数据库。根据使用的数据库引擎（MySQL，Microsoft SQL Server或Azure SQL），攻击者可能能够推断有关数据库结构和内容的信息，并执行SQL语句以更改或删除数据库元素。该漏洞已在野外被利用，Clop勒索软件组织声称对此负责。提供的POC代码是一个CSV文件，包含入侵指标（IOC），如文件路径、HTTP请求、IP地址、域名和SHA256哈希值。这些IOC可以帮助检测和响应针对MOVEit Transfer的攻击。

**有效性评估：** 从搜索结果和漏洞库信息来看，此漏洞的利用是真实且有效的。POC代码提供的IOC列表能够帮助安全分析人员识别潜在的攻击行为。因此，提供的IOC文件本身是有效的，可以作为检测和防御此漏洞攻击的依据。

**投毒风险分析：** 该代码主要是一个包含IOC的CSV文件和一个README文件。其中README文件是一个免责声明。CSV文件中包含了HTTP请求的路径、可疑IP地址，以及可能被利用的ASP.NET文件，以及一些user agent和hash。虽然列出的IP地址可能包含恶意IP，但把IP地址加入IOC列表的行为属于漏洞利用信息的共享，不属于投毒行为。综上，这个仓库本身包含作者隐藏的恶意投毒代码的概率较低，仅存在一些IP地址未来被错误标记的低概率风险。评估风险百分比为5%。

**利用方式分析：** 攻击者利用该漏洞通常通过发送特制的HTTP请求，该请求包含恶意的SQL代码。此SQL代码会被MOVEit Transfer应用解析，并传递给后端的数据库服务器执行。成功利用此漏洞可能允许攻击者：
1.  **数据泄露：** 提取敏感信息，如用户名、密码、用户数据等。
2.  **数据篡改：** 修改数据库中的数据，例如提升权限、篡改文件等。
3.  **远程代码执行：** 在某些数据库配置下，攻击者可能执行操作系统命令，从而完全控制服务器。

从POC代码来看，利用方式主要依赖于构造恶意的HTTP请求，例如`POST /moveitisapi/moveitisapi.dll`，`POST /guestaccess.aspx`， `POST /api/v1/folders/[random]/files`，并通过SQL注入来操纵数据库。

**项目地址:** [deepinstinct/MOVEit_CVE-2023-34362_IOCs](https://github.com/deepinstinct/MOVEit_CVE-2023-34362_IOCs)

**漏洞详情:** [CVE-2023-34362](https://nvd.nist.gov/vuln/detail/CVE-2023-34362)