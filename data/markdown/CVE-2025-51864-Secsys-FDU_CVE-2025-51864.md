## CVE-2024-51864-AIBOX-XSS

**漏洞编号:** CVE-2025-51864

**漏洞类型:** XSS

**影响应用:** AIBOX

**危害等级:** 高危，可能导致JWT token泄露和远程账户劫持

**影响版本:** 未知，影响https://chat.aibox365.cn

**利用条件:** 需要用户访问AIBOX chat界面并粘贴恶意代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索结果和提供的POC代码，该漏洞是一个存在于AIBOX chat组件中的反射型跨站脚本（XSS）漏洞(CVE-2024-51864)。攻击者可以通过诱使用户复制并粘贴包含恶意JavaScript代码的文本到聊天框中来利用此漏洞。AIBOX后端可能存在XSS过滤，但POC表明可以通过多种方式绕过，例如在payload前后插入字符，或利用LLM生成payload。成功利用后，攻击者可以窃取用户的JWT token，从而劫持用户的账户。

**有效性：**
提供的POC代码是有效的，它展示了如何通过构造特定的输入，触发XSS漏洞，从而执行任意JavaScript代码。

**投毒风险：**
该漏洞利用代码本身未发现明显的恶意行为。`/tmp/3666628cf98862399b873430d4a0925e/README.md`仅包含漏洞描述和利用示例，主要风险在于利用此POC的人员可能会将XSS payload传播到其他地方，导致更多用户受到攻击，或者利用此漏洞进行恶意活动。但从代码本身来看，投毒风险较低，大约为10%。主要考虑的是`figure1.png`图片是否存在隐写或其他潜在的风险，但由于无法直接分析图片内容，因此风险评估较低。

**利用方式：**
1.  攻击者构造一个包含恶意JavaScript代码（XSS payload）的文本。
2.  攻击者诱使受害者复制此文本。
3.  受害者将复制的文本粘贴到AIBOX chat界面。
4.  AIBOX未正确过滤XSS payload，导致恶意JavaScript代码在受害者浏览器中执行。
5.  恶意代码窃取受害者的cookie（包含session和token）。
6.  攻击者使用窃取的cookie冒充受害者，劫持账户。

**项目地址:** [Secsys-FDU/CVE-2025-51864](https://github.com/Secsys-FDU/CVE-2025-51864)

**漏洞详情:** [CVE-2025-51864](https://nvd.nist.gov/vuln/detail/CVE-2025-51864)