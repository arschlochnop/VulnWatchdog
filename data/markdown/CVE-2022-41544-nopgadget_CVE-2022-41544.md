## CVE-2022-41544 - GetSimple CMS 远程代码执行

**漏洞编号:** CVE-2022-41544

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GetSimple CMS

**危害等级:** 高危，攻击者可以在目标系统上执行任意代码。

**影响版本:** <= 3.3.16

**利用条件:** 需要能够访问GetSimple CMS安装路径，以及有效的管理员用户名。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41544是GetSimple CMS v3.3.16版本中存在的一个远程代码执行漏洞。该漏洞位于`admin/theme-edit.php`文件的`edited_file`参数。根据漏洞利用代码，攻击者需要一个有效的管理员用户名，然后通过以下步骤利用此漏洞：

1.  **版本检测:** 检测目标CMS版本是否在受影响范围内。
2.  **API Key提取:** 从`authorization.xml`文件中提取API Key。
3.  **认证绕过:** 使用提取的API Key伪造认证cookie。
4.  **CSRF Token检索:** 从主题编辑器中获取CSRF Token。
5.  **Shell上传:** 通过主题编辑器上传PHP反向Shell。
6.  **Shell执行:** 触发上传的Shell以建立反向连接。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定此漏洞是有效的。搜索引擎结果中提到了多个关于此漏洞的报告和利用脚本，表明该漏洞已被广泛研究和利用。提供的POC代码也描述了详细的利用步骤，并提供了可执行的Python脚本。

**投毒风险评估：**

分析提供的POC代码，主要关注以下几个方面：

*   **代码逻辑：** 代码的主要功能是利用漏洞执行命令或上传shell。代码逻辑相对清晰，没有明显的恶意或隐藏功能。
*   **网络请求：** 代码会发起网络请求与目标系统交互，需要关注请求的目标地址和请求内容。代码中使用了requests库，需要确保没有将敏感信息泄露到恶意服务器。
*   **文件操作：** 代码会读取和写入文件，需要关注文件路径和文件内容。代码中读取`authorization.xml`文件，写入shell文件，需要确保没有进行恶意的文件操作。
*   **telnet_shell函数:** exploit.py中包含telnet_shell函数，允许通过telnet连接到目标系统。虽然这是一个可选功能，但是如果被滥用，可能会对目标系统造成安全风险。

综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，但不能完全排除，例如反弹shell的IP端口被替换成黑客的，或者植入其他的后门。因此，评估的投毒风险为 **10%**。

**利用方式总结：**

攻击者通过向`admin/theme-edit.php`发送包含恶意PHP代码的请求，利用`edited_file`参数执行任意代码。攻击者通常会上传一个webshell，以便长期控制目标系统。利用的前提是需要获取管理员权限，或者绕过身份验证。

**项目地址:** [nopgadget/CVE-2022-41544](https://github.com/nopgadget/CVE-2022-41544)

**漏洞详情:** [CVE-2022-41544](https://nvd.nist.gov/vuln/detail/CVE-2022-41544)