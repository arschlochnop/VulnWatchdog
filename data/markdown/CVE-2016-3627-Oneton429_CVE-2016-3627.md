## CVE-2016-3627-libxml2-DoS

**漏洞编号:** CVE-2016-3627

**漏洞类型:** 拒绝服务（DoS）

**影响应用:** libxml2

**危害等级:** 高危，导致应用崩溃

**影响版本:** <= 2.9.3

**利用条件:** 需要目标程序使用libxml2 2.9.3及更早版本，并且以recovery模式解析XML文档。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-3627 存在于 libxml2 2.9.3及更早版本中。当 libxml2 在 recovery 模式下解析 XML 文件时，tree.c 中的 xmlStringGetNodeList 函数存在无限递归的风险，导致堆栈耗尽并最终崩溃。

**有效性：**
提供的POC代码 `CVE-2016-3627.xml` 利用了XML entity expansion。 通过定义一个 entity `YN` 并递归调用自身， XML 解析器会尝试无限扩展该实体，从而迅速消耗服务器资源并导致拒绝服务攻击。 由于漏洞描述中提到了“crafted XML document”，并且POC利用了实体展开，因此POC是有效的，可以触发漏洞。

**投毒风险：**
提供的`README.md` 文件和 `CVE-2016-3627.xml` 文件没有发现任何可疑的或恶意的代码。 该 XML 文件本身就是一个PoC，旨在触发漏洞，而不是执行任何恶意操作。 因此，该存储库中不存在投毒代码的风险。

**利用方式：**
1.  目标程序需要使用易受攻击的 libxml2 版本（<= 2.9.3）。
2.  目标程序需要以 recovery 模式解析 XML 文档，即在解析过程中尝试从格式错误的 XML 中恢复。
3.  攻击者将恶意 XML 文档（例如提供的 POC）提交给目标程序。
4.  libxml2 在解析 XML 时，由于递归实体扩展，导致堆栈溢出。
5.  目标程序崩溃，导致拒绝服务。

**项目地址:** [Oneton429/CVE-2016-3627](https://github.com/Oneton429/CVE-2016-3627)

**漏洞详情:** [CVE-2016-3627](https://nvd.nist.gov/vuln/detail/CVE-2016-3627)