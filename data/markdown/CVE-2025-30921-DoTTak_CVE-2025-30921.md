## CVE-2025-30921-Newsletters-SQL注入

**漏洞编号:** CVE-2025-30921

**漏洞类型:** SQL注入

**影响应用:** Newsletters

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 4.9.9.7

**利用条件:** 需要管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Newsletters 插件 4.9.9.7 及更早版本中。攻击者需要具备管理员权限，通过构造恶意的 SQL 语句，注入到 `history_id` URL 参数中，可以提取数据库信息，例如数据库名称和版本。

**有效性评估：**
根据提供的漏洞信息和漏洞利用代码，该漏洞利用是有效的。POC 提供了详细的重现步骤，包括如何找到 `security` 值，以及如何构造包含 SQL 注入 payload 的 URL。漏洞利用代码中详细的解释了漏洞的根源，参数history_id 没有经过任何过滤,直接被拼接到SQL语句中。

**投毒风险评估：**
仓库中的投毒风险较低，约为10%。主要基于以下几个原因：
1.  代码仓库主要包含漏洞描述文档(README.md), 漏洞存在的原因是插件本身的代码缺陷，而不是作者的恶意注入代码。
2.  POC 的目的是演示漏洞利用，代码逻辑清晰，主要为重现漏洞，没有发现任何后门或恶意行为。
3.  虽然在利用过程中，攻击者可以执行任意 SQL 查询，但这属于漏洞的固有风险，而非投毒行为。
但依然存在轻微风险。例如文档中的链接，虽然都指向了官方站点或者漏洞披露站点，依然需要谨慎访问，防范钓鱼风险。另外，虽然目前代码没有明显恶意行为，也应该对代码的行为进行详细审计后使用。

**利用方式分析：**
1.  **权限要求：** 攻击者需要具备 WordPress 管理员权限。
2.  **漏洞位置：** 漏洞存在于 `/wp-admin/admin-ajax.php` 接口的 `history_id` 参数中。
3.  **利用过程：**
    *   攻击者首先访问 Newsletters 插件的 dashboard 页面。
    *   通过浏览器开发者工具获取 `security` 参数的值。
    *   构造包含 SQL 注入 payload 的 URL，将 payload 注入到 `history_id` 参数中。
    *   发送构造好的 URL 请求，利用 SQL 注入漏洞提取数据库信息。

**修复方案：**
升级 Newsletters 插件到 4.9.9.8 或更高版本。

**项目地址:** [DoTTak/CVE-2025-30921](https://github.com/DoTTak/CVE-2025-30921)

**漏洞详情:** [CVE-2025-30921](https://nvd.nist.gov/vuln/detail/CVE-2025-30921)