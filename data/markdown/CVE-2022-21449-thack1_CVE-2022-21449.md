## CVE-2022-21449 Psychic Signatures

**漏洞编号:** CVE-2022-21449

**漏洞类型:** ECDSA 签名绕过

**影响应用:** Oracle Java SE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，可能导致身份验证绕过和未授权访问

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 需要目标使用受影响的 Java 版本，并且使用 ECDSA 进行签名验证。可以通过网络访问利用，例如通过 TLS 连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21449，又名 'Psychic Signatures'，是一个存在于 Java ECDSA 签名验证实现中的严重漏洞。攻击者可以构造一个具有特定属性（例如，r=s=0 或者 r=n, s=0 或者 r=0, s=n，n是椭圆曲线的阶）的恶意 ECDSA 签名，从而绕过签名验证。由于签名验证逻辑的缺陷，受影响的 Java 版本会错误地将这些无效签名视为有效。  

提供的 POC 代码（Zeek 脚本）不是一个直接的利用程序，而是一个用于检测 CVE-2022-21449 漏洞利用尝试的网络入侵检测系统 (NIDS) 规则。它通过检查 TLS 连接中的 ECDSA 签名，寻找具有空值或等于椭圆曲线阶的 r 和 s 值的签名来工作。如果检测到此类签名，则会生成一个通知。

**漏洞利用方式：**

1.  攻击者需要与使用存在漏洞的 Java 版本的服务器建立连接，例如通过 TLS 连接。
2.  攻击者在需要提供 ECDSA 签名的地方，提供一个精心构造的恶意签名（例如，r=s=0 或 r=n，s=0 或 r=0, s=n，其中 n 是椭圆曲线的阶）。
3.  由于 Java 签名验证的缺陷，服务器会将此恶意签名误认为有效，从而导致身份验证绕过或权限提升。

**投毒风险分析：**

该仓库的目的是为了检测漏洞利用,代码内容主要是特征匹配,没有发现潜在的恶意代码或者后门。因此，投毒风险极低（0%）。

**项目地址:** [thack1/CVE-2022-21449](https://github.com/thack1/CVE-2022-21449)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)