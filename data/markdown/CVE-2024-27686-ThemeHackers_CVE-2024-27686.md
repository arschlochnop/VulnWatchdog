## CVE-2024-27686 - MikroTik RouterOS SMB DoS

**漏洞编号:** CVE-2024-27686

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** MikroTik RouterOS

**危害等级:** 中危，可能导致设备不可用

**影响版本:** 6.40.5 - 6.44, 6.48.1 - 6.49.10

**利用条件:** 需要网络访问目标设备的SMB端口 (通常是445)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27686是一个存在于MikroTik RouterOS中的拒绝服务漏洞。根据搜索结果，漏洞原因是未能充分处理特制的SMB请求。提供的PoC代码是一个Python脚本，它发送特定的SMB数据包到目标设备的SMB端口，从而导致设备崩溃或停止响应。

**有效性：**
PoC代码通过发送畸形的SMB数据包来触发漏洞，利用目标主机SMB服务处理异常时导致的资源耗尽，最终实现拒绝服务，是有效的。

**投毒风险：**
PoC代码相对简单，主要是发送预定义的恶意数据包。代码中包含HTTP状态检查部分，用于判断目标是否已经崩溃，辅助用户判断攻击效果，并询问是否继续攻击。检查源代码,代码整体结构清晰,功能集中在DoS攻击上。因此，投毒风险较低，但不能完全排除作者在代码中添加恶意功能的可能性（例如，在特定条件下执行某些恶意操作）。但从代码逻辑和功能来看，投毒风险较低，估计为5%。

**利用方式：**
1.  选择目标MikroTik RouterOS的版本范围（6.40.5 - 6.44 或 6.48.1 - 6.49.10）。
2.  运行PoC脚本，指定目标IP地址和SMB端口（默认为445）。
3.  脚本会循环发送恶意SMB数据包到目标设备，导致其SMB服务崩溃或资源耗尽。
4.  脚本会检查目标主机的HTTP服务状态，辅助用户判断是否DoS成功。
5.  攻击者可以利用这个漏洞使目标路由器不可用，影响网络服务。

**项目地址:** [ThemeHackers/CVE-2024-27686](https://github.com/ThemeHackers/CVE-2024-27686)

**漏洞详情:** [CVE-2024-27686](https://nvd.nist.gov/vuln/detail/CVE-2024-27686)