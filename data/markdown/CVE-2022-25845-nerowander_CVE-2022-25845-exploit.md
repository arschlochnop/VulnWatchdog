## CVE-2022-25845-Fastjson-反序列化漏洞

**漏洞编号:** CVE-2022-25845

**漏洞类型:** 反序列化漏洞

**影响应用:** com.alibaba:fastjson

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.2.83

**利用条件:** 目标系统使用了受影响版本的Fastjson，且未启用safeMode

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-25845 是一个Fastjson反序列化漏洞，攻击者可以绕过默认的autoType shutdown限制，在特定条件下实现远程代码执行。漏洞存在于1.2.83之前的版本中。根据搜索引擎结果和提供的POC代码，该漏洞利用的有效性较高。POC代码通过构造包含恶意类的JSON字符串，利用`JSON.parseObject`方法进行反序列化，从而执行任意代码。  

**有效性分析:**
根据漏洞库信息和搜索引擎结果，确认了该漏洞的存在以及利用方式。提供的POC代码使用了`java.lang.Exception`作为类型，并定义了一个`org.example.Poc`类，该类中的`setName`方法可以执行系统命令。POC中构造的JSON字符串`{"@type":"java.lang.Exception","@type":"org.example.Poc","name":"calc.exe"}`尝试利用`@type`指定类，然后通过setName方法调用`Runtime.getRuntime().exec()`执行calc.exe，证明了该漏洞的有效性。  

**投毒风险分析:**
仔细分析了提供的POC代码仓库中的所有文件，未发现任何明显的投毒代码。所有代码都与漏洞利用相关，没有发现恶意行为，所以投毒风险评估为0%。

**利用方式:**
1.  攻击者需要确定目标系统使用了受影响版本的Fastjson（< 1.2.83）。
2.  攻击者构造包含恶意类的JSON字符串，利用`@type`关键字指定类名，并利用setter/getter方法调用链执行任意代码。
3.  将构造的JSON字符串发送给目标系统。
4.  目标系统使用Fastjson进行反序列化操作，触发漏洞，执行攻击者预设的恶意代码。

**项目地址:** [nerowander/CVE-2022-25845-exploit](https://github.com/nerowander/CVE-2022-25845-exploit)

**漏洞详情:** [CVE-2022-25845](https://nvd.nist.gov/vuln/detail/CVE-2022-25845)