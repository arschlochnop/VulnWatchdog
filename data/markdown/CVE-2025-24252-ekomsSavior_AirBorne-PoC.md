## CVE-2025-24252-AirPlay-UAF远程代码执行

**漏洞编号:** CVE-2025-24252

**漏洞类型:** Use-After-Free (UAF)

**影响应用:** Apple AirPlay

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < macOS Sequoia 15.4, tvOS 18.4, macOS Ventura 13.7.5, iPadOS 17.7.6, macOS Sonoma 14.7.5, iOS 18.4 and iPadOS 18.4, visionOS 2.4

**利用条件:** 位于同一本地网络，目标设备开启AirPlay服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24252是一个存在于Apple AirPlay中的Use-After-Free漏洞。根据搜索引擎结果，该漏洞可能允许未经身份验证的远程攻击者通过发送恶意构造的mDNS TXT记录或AirPlay配对请求来执行任意代码（Zero-Click RCE）。

**有效性：**
提供的漏洞利用代码包含两个PoC，分别针对CVE-2025-24252和CVE-2025-24132。
*   `CVE-2025-24132_RCE.py` 尝试通过伪造AirPlay配对请求并在XML payload中嵌入反向shell命令来利用漏洞。脚本尝试连接到目标设备的7000端口（AirPlay端口），然后发送包含恶意payload的HTTP POST请求。
*   `PoC_CVE-2025-24132` 通过发送畸形的AirPlay配对初始化包，包含一个超大缓冲区溢出，以此来触发漏洞。

结合漏洞信息和搜索结果，这些PoC代码看起来是有效的，能够触发漏洞并可能实现远程代码执行。

**投毒风险：**
PoC代码中存在一定程度的投毒风险，主要体现在以下几个方面：

1.  **反向Shell地址：** `CVE-2025-24132_RCE.py` 脚本中包含了反向shell的IP地址和端口。如果攻击者分享了修改过的代码，并将反向shell指向自己的服务器，那么任何使用该脚本的人都会无意中将目标设备的控制权交给攻击者。这是一个潜在的风险。
2.  **持续性后门：**虽然`CVE-2025-24132_RCE.py`中默认使用一次性反向shell，但代码中包含一个注释掉的“Persistent launch daemon”选项。如果用户不小心启用了此选项，可能会在目标设备上安装一个恶意启动守护进程，从而实现持久控制。
3. **LICENSE**: 作者可以恶意更改LICENSE文件, 植入一些恶意代码在正常用户使用时触发一些后门逻辑。

尽管这些风险存在，但可以通过仔细审查代码并在运行前进行适当的修改来降低风险。

综合来看，投毒风险的可能性估计为10%。这部分风险主要来源于脚本可能被修改以指向恶意攻击者的服务器，或者用户可能无意中部署持久性后门。

**利用方式：**
该漏洞的利用方式主要涉及以下步骤：

1.  **网络扫描：** 攻击者扫描本地网络，查找运行易受攻击的AirPlay服务的Apple设备。
2.  **构建恶意请求：** 攻击者构建一个包含恶意payload的AirPlay配对初始化请求。Payload可以包含shell命令（例如，用于建立反向shell）或用于触发UAF漏洞的特定数据。
3.  **发送恶意请求：** 攻击者通过TCP连接将恶意请求发送到目标设备的AirPlay端口（通常是7000端口）。
4.  **代码执行：** 如果漏洞利用成功，目标设备将执行payload中的代码，从而允许攻击者控制设备。

**项目地址:** [ekomsSavior/AirBorne-PoC](https://github.com/ekomsSavior/AirBorne-PoC)

**漏洞详情:** [CVE-2025-24252](https://nvd.nist.gov/vuln/detail/CVE-2025-24252)