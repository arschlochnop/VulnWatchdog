## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户凭据泄露或恶意脚本执行

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212是OURPHP <= 7.2.0中的一个反射型XSS漏洞，存在于/client/manage/ourphp_out.php文件中。攻击者可以构造包含恶意JavaScript代码的URL，当用户点击该URL时，恶意代码将在用户浏览器中执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，此漏洞利用是有效的。POC代码展示了如何在/ourphp_out.php中注入JavaScript代码，并通过修改URL参数触发XSS。

**投毒风险分析：**

尽管提供的Replicating-CVE-2023-30212.md文件主要描述了如何搭建漏洞环境和复现漏洞，但仍然存在一定的投毒风险。以下是风险分析：

1.  **环境配置复杂性：** 该文档引导用户通过Docker搭建包含XAMPP和OURPHP的环境，步骤繁琐。在这个过程中，攻击者可能会在XAMPP配置或OURPHP源码中插入恶意代码。 用户在不检查所有步骤的情况下，有可能会运行有害命令。
2.  **第三方资源依赖：** 文档中使用了多个`wget`命令下载XAMPP和OURPHP，这些链接指向第三方服务器。如果这些服务器被攻陷，下载的文件可能被替换为包含恶意代码的版本。并且，文档引用了其他github仓库的图片，如果图片被替换也可能会导致恶意代码。
3.  **权限设置：**  `chmod -R 777 .`命令赋予了所有文件和目录完全的读写执行权限，这本身就是一个安全风险，方便攻击者后续植入后门。
4.  **POC本身：** 虽然POC目的是验证XSS，但恶意用户可能用此POC构造更具危害性的攻击，例如重定向用户到恶意网站或窃取用户敏感信息。

总体而言，虽然该仓库主要目的是复现漏洞，但由于环境配置的复杂性，第三方资源依赖以及不安全的权限配置，存在一定的投毒风险。风险占比约为10%。主要是环境部署过程比较繁琐，可能存在人为引入恶意代码的风险，但直接投毒概率较低。风险评估主要集中在用户按照指导操作时可能引入的潜在威胁，而不是POC本身直接包含后门的情况。

**利用方式：**

1.  **构造恶意URL：** 攻击者构造包含XSS payload的URL，例如`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=%3C/script%3E%3Cscript%3Ealert(%60xss%60)%3C/script%3E`。
2.  **诱骗用户点击：** 攻击者通过邮件、社交媒体等方式诱骗用户点击该恶意URL。
3.  **触发XSS：** 当用户点击URL后，服务器会将恶意payload返回给用户浏览器，浏览器执行其中的JavaScript代码，从而触发XSS。
4.  **恶意行为：** 攻击者可以通过XSS执行各种恶意行为，例如窃取用户cookie、重定向用户到钓鱼网站、篡改网页内容等。

**项目地址:** [MaThEw-ViNcEnT/CVE-2023-30212-OURPHP-Vulnerability](https://github.com/MaThEw-ViNcEnT/CVE-2023-30212-OURPHP-Vulnerability)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)