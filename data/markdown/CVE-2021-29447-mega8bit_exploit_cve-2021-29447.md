## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可读取服务器文件

**影响版本:** >= 5.6.0, < 5.7.1 (with PHP 8)

**利用条件:** 需要WordPress版本在5.6.0到5.7.1之间，且运行在PHP 8环境下，需要具有上传文件的权限（如Author角色）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WordPress媒体库中存在的XXE漏洞，当WordPress运行在PHP 8上时，具有上传文件权限的用户可以通过上传包含恶意XML的WAV文件，触发XXE漏洞，读取服务器上的任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC是有效的。多个来源都确认了该漏洞的存在，以及利用方式。

**利用方式：**
1.  攻击者需要具备WordPress的Author权限（或能够上传文件的权限）。
2.  攻击者使用提供的PoC代码，指定目标文件路径和本地服务器的IP地址和端口。
3.  PoC代码会生成一个包含恶意XML的WAV文件。
4.  攻击者将生成的WAV文件上传到WordPress的媒体库。
5.  WordPress解析该WAV文件时，会触发XXE漏洞，向攻击者指定的本地服务器发起请求，请求中包含目标文件的内容。
6.  PoC代码中的本地服务器会接收到请求，提取目标文件的内容，并将其保存到指定的文件中。

**投毒风险：**
分析PoC代码，主要功能是生成payload和启动一个简单的http server。payload可以读取服务器文件发送到攻击者控制的http server上，但是没有发现明显的恶意代码。例如删除服务器文件等。但是`exploit_cve-2021-29447`程序需要执行`hostname -I`来获取本机IP,在某些环境下可能造成问题。由于该工具涉及监听端口，以及构造恶意文件，仍旧存在一定的风险，判定投毒概率为10%。


**项目地址:** [mega8bit/exploit_cve-2021-29447](https://github.com/mega8bit/exploit_cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)