## CVE-2025-6019-libblockdev-LPE

**漏洞编号:** CVE-2025-6019

**漏洞类型:** 本地权限提升

**影响应用:** libblockdev/udisks

**危害等级:** 高危，允许低权限用户获取root权限

**影响版本:** Red Hat Enterprise Linux 7/8/9/10等受影响版本

**利用条件:** 需要本地访问权限，并且Polkit的"allow_active"设置允许用户执行某些操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6019是一个libblockdev中的本地权限提升漏洞。攻击者可以利用该漏洞，通过精心构造的XFS镜像和一个SUID-root shell，欺骗udisks调整镜像大小，从而以root权限挂载恶意文件系统，最终获得系统root权限。

**有效性评估：**
根据漏洞描述、搜索结果和提供的PoC代码，此漏洞利用的有效性较高。PoC代码详细地展示了如何创建包含SUID-root shell的XFS镜像，并通过udisks进行利用。搜索结果中多个链接也表明这是一个真实存在的、影响广泛的漏洞。

**投毒风险评估：**
PoC代码中存在一定程度的投毒风险，大约为10%。风险主要体现在以下几个方面：
1. **依赖外部资源：** PoC代码依赖`/bin/bash`的存在和可执行权限，如果目标系统中的`bash`被替换或者权限被修改，则PoC无法正常工作，这可能会导致利用失败，并留下痕迹。
2. **SUID-root shell的潜在风险：** 虽然PoC明确是为了利用漏洞，但生成的SUID-root shell本身就是一个安全隐患。如果攻击者在利用漏洞后，没有及时清理这个shell，可能会被其他恶意用户利用。
3. **预先存在的xfsbundle tarball** 该脚本依赖于 `xfsbundle.tar.gz` 解压出的文件来执行mkfs.xfs等命令。攻击者可能替换 `xfsbundle.tar.gz` 来执行恶意代码.

总体而言，该PoC的目的是为了验证漏洞，但编写者可能有意或无意地加入一些不易察觉的代码，在成功提权后进行恶意操作（如安装后门），或者使提权过程存在潜在风险。

**利用方式：**
1.  **创建恶意XFS镜像：** 攻击者首先需要创建一个包含SUID-root shell的XFS镜像。PoC代码中使用了mkfs.xfs来格式化镜像，然后复制/bin/bash并设置SUID权限。
2.  **触发udisks调整镜像大小：** 攻击者需要诱使udisks对该XFS镜像进行调整大小的操作。漏洞描述中提到，可以通过某些方式（如调整分区大小）来触发此操作。
3.  **利用SUID-root shell提权：** 一旦udisks以root权限挂载了恶意XFS镜像，攻击者就可以执行其中的SUID-root shell，从而获得系统root权限。

**总结：**
该漏洞利用流程清晰，PoC代码提供了详细的利用步骤。但使用者需要注意清理利用过程中产生的临时文件和SUID-root shell，以避免潜在的安全风险。同时也需要注意PoC的依赖和执行环境，确保PoC能够正常工作。

**项目地址:** [harshitvarma05/CVE-2025-6019](https://github.com/harshitvarma05/CVE-2025-6019)

**漏洞详情:** [CVE-2025-6019](https://nvd.nist.gov/vuln/detail/CVE-2025-6019)