## CVE-2025-53770-SharePoint-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行，完全控制受影响的SharePoint服务器

**影响版本:** SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要能够访问SharePoint服务器，可能需要一定的权限才能触发漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个存在于Microsoft SharePoint Server的远程代码执行漏洞。该漏洞源于对不可信数据的反序列化。未经授权的攻击者可以通过网络利用此漏洞在受影响的服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，CVE-2025-53770是一个已经被积极利用的漏洞，具有高危风险。提供的PoC代码尝试利用此漏洞。该PoC代码的工作方式是：首先从target.txt文件中读取目标SharePoint服务器的URL列表。然后，对于每个URL，它构造一个特殊的POST请求，发送到`/_layouts/15/ToolPane.aspx`端点，并在POST数据中包含精心构造的`MSOTlPn_DWP`参数。这个参数包含一个序列化的对象，其中包含一个恶意`Scorecard:ExcelDataSet`标记，该标记包含压缩和base64编码的数据，一旦反序列化，就可以执行任意代码。PoC代码会尝试解码和解压缩响应，然后搜索特定的字符串，如果找到，则表明服务器存在漏洞。

**投毒风险分析：**
该PoC代码的投毒风险较低，约为10%。 代码的主要功能是利用漏洞，没有明显的恶意行为，例如删除文件、传播恶意软件等。 但仍然存在细微的投毒风险， 例如：作者可以将解码后的内容保存到`/tmp`目录，这是一个公共目录，可能会造成一些信息泄露或者被其他恶意程序利用。

**利用方式：**
1.  **目标识别：** 首先需要识别存在漏洞的SharePoint服务器，可以通过版本信息或者漏洞扫描工具来完成。
2.  **构造Payload：** 攻击者需要构造一个恶意的序列化对象，该对象在反序列化时可以执行任意代码。这通常涉及到使用`Scorecard:ExcelDataSet`等SharePoint组件，并嵌入压缩和base64编码的恶意数据。
3.  **发送请求：** 将构造好的Payload通过POST请求发送到目标SharePoint服务器的`/_layouts/15/ToolPane.aspx`端点。Referer设置为目标站点的SignOut.aspx页面。
4.  **代码执行：** 如果服务器存在漏洞，并且Payload构造正确，服务器在处理请求时会对Payload进行反序列化，从而执行攻击者预先设定的恶意代码。
5.  **结果验证:** PoC通过正则匹配返回包中的特定字符串来判断漏洞是否存在，实际利用中，回显可能被屏蔽，需要使用其他方式验证。

**缓解措施：**
*   应用Microsoft提供的安全更新。
*   实施缓解措施，例如禁用不安全的反序列化功能，或者限制对`/_layouts/15/ToolPane.aspx`端点的访问。

**项目地址:** [r3xbugbounty/CVE-2025-53770](https://github.com/r3xbugbounty/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)