## CVE-2011-2523 - vsftpd 2.3.4 Backdoor Command Execution

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门程序

**影响应用:** vsftpd

**危害等级:** 高危，可获取目标系统root权限

**影响版本:** 2.3.4 (下载时间在20110630和20110703之间)

**利用条件:** 目标系统运行受影响版本的vsftpd，且6200端口未被防火墙阻止

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523 漏洞存在于 vsftpd 2.3.4 版本中，该版本在特定时间段内（20110630和20110703之间）下载的版本包含一个后门。该后门会在目标系统上打开 6200 端口，允许攻击者通过 telnet 连接执行任意命令，从而获得 root 权限。

**有效性分析：**

*   漏洞库信息和搜索引擎结果均表明该漏洞存在且影响特定版本的 vsftpd 2.3.4。
*   提供的 POC 代码是一个 Python 脚本，它尝试利用该漏洞连接到目标系统的 6200 端口，并通过 telnet 发送命令来修改 SSH 配置（允许 root 用户通过 SSH 登录），并添加公钥到 authorized_keys 文件，从而实现免密码 SSH 登录。
*   POC 代码通过 `socket` 模块建立连接，使用 `pexpect` 模块进行 telnet 交互，使用 `paramiko` 模块进行 SSH 连接。

**投毒风险分析：**

*   该 POC 代码的主要功能是利用已知的 vsftpd 后门漏洞，风险较低。但存在潜在的投毒风险，例如：
    *   **恶意修改 SSH 配置：** 代码修改了 `/etc/ssh/sshd_config` 文件，允许 root 用户通过 SSH 登录，这在某些情况下可能降低系统安全性。
    *   **Cronjob 滥用：** 如果目标系统原本未运行SSH，该EXP添加了cronjob来启用SSH服务和禁用UFW防火墙，会增加目标系统的攻击面。
    *   **公钥植入风险：** 如果攻击者的私钥泄露，可能导致其他攻击者也能利用该公钥登录目标系统。
    *   **依赖包篡改：** requirements.txt 文件可能包含恶意或被篡改的依赖包，导致安装后执行恶意代码。
    *   **后门依赖：** 该脚本依赖于目标系统存在 CVE-2011-2523 后门，而无法自主安装后门，恶意性相对低。
*   综合来看，该 POC 代码存在一定的投毒风险，主要集中在对 SSH 配置和 cronjob 的修改上。**投毒风险预估为 10%。**

**利用方式：**

1.  **检查目标系统是否运行受影响的 vsftpd 2.3.4 版本。**
2.  **确保目标系统的 6200 端口未被防火墙阻止。**
3.  **运行 POC 代码，指定目标 IP 地址，公钥文件路径和密钥口令。**
4.  **POC 代码会尝试连接到目标系统的 6200 端口，并通过 telnet 发送命令，修改 SSH 配置，并添加公钥到 authorized_keys 文件。**
5.  **如果成功，攻击者可以使用私钥通过 SSH 登录目标系统，获得 root 权限。**
6.  **（可选）在利用完成后，可以使用POC中的removeCronjob() 函数删除之前添加的cronjob任务,确保环境安全**

**项目地址:** [Gill-Singh-A/vsFTP-2.3.4-Remote-Root-Shell-Exploit](https://github.com/Gill-Singh-A/vsFTP-2.3.4-Remote-Root-Shell-Exploit)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)