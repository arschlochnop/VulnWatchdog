## CVE-2025-2294-Kubio AI Page Builder-LFI

**漏洞编号:** CVE-2025-2294

**漏洞类型:** 本地文件包含(LFI)

**影响应用:** Kubio AI Page Builder

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 2.5.1

**利用条件:** 目标WordPress站点安装了受影响版本的Kubio AI Page Builder插件，且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2294是Kubio AI Page Builder插件中的一个未经身份验证的本地文件包含漏洞。攻击者可以通过`__kubio-site-edit-iframe-classic-template`参数，读取服务器上的任意文件。漏洞利用代码 `lfi.py` 脚本通过构造包含恶意文件路径的URL，并检查响应内容是否包含敏感信息（如 `root:x:`、`<?php` 等）来判断目标是否易受攻击。如果成功读取了 `etc/passwd` 文件，则确认漏洞存在。

**有效性评估：**

提供的POC代码看起来是有效的，因为它尝试利用 `__kubio-site-edit-iframe-classic-template` 参数读取目标服务器上的文件。搜索引擎结果表明此漏洞确实存在且可被利用。POC代码通过检查响应中常见的敏感信息来判断利用是否成功。

**投毒风险评估：**

分析POC代码 `lfi.py`，发现其主要功能是发送HTTP请求并分析响应。代码中存在潜在的风险点:

1.  **`is_vulnerable` 函数:**  这个函数通过匹配一些关键词来判断漏洞是否存在。如果攻击者修改了这些关键词，可能会导致误判或者绕过检测，但这不是直接的投毒行为。
2.  **`fetch_url` 函数:** 这个函数负责发送HTTP请求。虽然看起来没有明显的恶意代码，但如果攻击者修改了这个函数，使其在特定条件下执行额外的操作，例如发送额外的数据到攻击者的服务器，就有可能存在投毒。
3.  **依赖问题:** 该脚本依赖 `requests`，`argparse`，`urllib3` 和 `termcolor` 等第三方库。如果这些库被恶意篡改，脚本就可能被投毒。 虽然存在潜在的风险，但当前代码片段本身没有明显的投毒特征。 考虑到安全研究员的署名和代码的复杂性，初步评估投毒的可能性为10%。

**利用方式：**

1.  攻击者构造包含恶意文件路径的URL，例如 `https://target-website.com/?__kubio-site-edit-iframe-preview=true&__kubio-site-edit-iframe-classic-template=../../../../../../../etc/passwd`。
2.  受影响的Kubio AI Page Builder插件会尝试加载指定的文件。
3.  由于缺乏适当的输入验证和路径限制，攻击者可以读取服务器上的任意文件。
4.  攻击者可以利用此漏洞读取敏感配置文件、源代码或其他敏感数据，甚至可能上传恶意PHP文件并执行，从而完全控制服务器。

**项目地址:** [0xWhoami35/CVE-2025-2294](https://github.com/0xWhoami35/CVE-2025-2294)

**漏洞详情:** [CVE-2025-2294](https://nvd.nist.gov/vuln/detail/CVE-2025-2294)