## CVE-2023-4911-Glibc-本地提权

**漏洞编号:** CVE-2023-4911

**漏洞类型:** 本地提权

**影响应用:** Glibc

**危害等级:** 高危，允许本地用户提升权限至root

**影响版本:** 2.34 <= Glibc < 2.39

**利用条件:** 需要目标系统glibc版本在受影响范围内，且存在具有SUID/SGID权限的可执行文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4911 漏洞（又名Looney Tunables）是 GNU C 库 (glibc) 动态加载器 ld.so 中的一个缓冲区溢出漏洞。该漏洞是由于在处理 GLIBC_TUNABLES 环境变量时，ld.so 没有正确地进行边界检查造成的。当一个设置了SUID/SGID权限的程序启动时，ld.so 会加载程序依赖的动态链接库。攻击者可以通过设置一个过长的GLIBC_TUNABLES环境变量，导致缓冲区溢出，从而覆盖 ld.so 的内存，最终执行任意代码。由于 ld.so 在加载 SUID/SGID 程序时具有提升的权限，因此攻击者可以利用此漏洞获得 root 权限。

**漏洞利用方式：**

1.  **设置 GLIBC_TUNABLES 环境变量：** 攻击者需要构造一个恶意的 GLIBC_TUNABLES 环境变量，使其长度超过预期缓冲区的大小。
2.  **运行 SUID/SGID 程序：** 攻击者需要运行一个具有 SUID 或 SGID 权限的程序。当程序启动时，ld.so 将会加载并解析 GLIBC_TUNABLES 环境变量。
3.  **触发缓冲区溢出：** 如果 GLIBC_TUNABLES 环境变量的长度超过了 ld.so 中缓冲区的限制，就会发生缓冲区溢出。
4.  **执行恶意代码：** 攻击者可以通过缓冲区溢出覆盖 ld.so 的内存，从而执行任意代码，获得提升的权限。

**有效性：**
根据漏洞描述、搜索引擎结果和提供的POC代码仓库信息，该漏洞是有效的。 多个来源都确认了该漏洞的存在，并且提供了PoC代码。

**投毒风险分析：**
提供的POC代码仓库中包含了 LICENSE、README.md等文件，README.md 中引用了多个相关的链接，包括 Qualys 的博客文章，技术细节，exploit POC python脚本的链接(haxx.in)，GLIBC源码和 tunables 文档。仓库本身看起来像是一个教育目的的漏洞复现环境。
虽然仓库本身没有明显的恶意代码，但是引用了一个外部的Python Exploit脚本链接(haxx.in/files/gnu-acme.py)。这个链接可能会存在风险，因为该脚本不在当前提供的仓库中，无法直接分析其内容。 考虑到这一点，存在一定的投毒风险，但几率较低，主要风险在于外部脚本的不可控性。 因此，投毒风险评估为 10%。 谨慎使用和审查引用的外部脚本是必要的。

**项目地址:** [KernelKrise/CVE-2023-4911](https://github.com/KernelKrise/CVE-2023-4911)

**漏洞详情:** [CVE-2023-4911](https://nvd.nist.gov/vuln/detail/CVE-2023-4911)