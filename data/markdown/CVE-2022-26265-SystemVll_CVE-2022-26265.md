## CVE-2022-26265-Contao Managed Edition-RCE

**漏洞编号:** CVE-2022-26265

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Contao Managed Edition

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 1.5.0

**利用条件:** 需要目标服务器运行Contao Managed Edition 1.5.0，且攻击者能够访问`/api/server/config`接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26265 漏洞存在于 Contao Managed Edition v1.5.0 中，允许远程攻击者通过 `php_cli` 参数执行任意命令。攻击者可以发送包含恶意命令的POST请求到 `/api/server/config` 接口，服务器会将该命令传递给 PHP CLI 执行。

**有效性：**
提供的POC代码看起来是有效的。它构造了一个带有 `php_cli` 参数的POST请求，并发送到目标服务器的 `/api/server/config` 接口。根据漏洞描述，这会导致远程代码执行。

**投毒风险：**
POC代码本身比较直接，主要功能是发送构造好的请求。 但仍然存在一些小的投毒风险：
*   **依赖项风险：** 使用了 `requests` 和 `colored` 等第三方库，理论上这些库可能被篡改，但这种风险较低。
*   **代码逻辑风险：**  `randomString` 函数虽然简单，但理论上可以被替换为更复杂的恶意行为，比如在某些特定条件下执行有害操作，概率较低。
*   **参数控制风险:**  `Cookie` 是硬编码的，这降低了利用的灵活性，但如果用于大规模扫描，也可能被滥用。

综合来看，投毒风险较低，约为10%。主要风险集中在第三方库和潜在的恶意代码植入，但现有代码比较简洁，大幅修改容易被发现，因此投毒的意愿较低。

**利用方式：**
1.  攻击者需要找到运行 Contao Managed Edition v1.5.0 的目标服务器。
2.  攻击者构造一个包含恶意命令的 JSON 数据，该数据通过 `php_cli` 参数传递。
3.  攻击者向目标服务器的 `/api/server/config` 接口发送 POST 请求，并将构造的 JSON 数据作为请求体。
4.  目标服务器执行 `php_cli` 参数中的命令，从而实现远程代码执行。

**搜索引擎结果重要性：** 搜索引擎结果证实了该漏洞的存在，并提供了有关受影响版本和利用方式的额外信息。这些信息增强了对漏洞的理解，并有助于验证 POC 代码的有效性。特别是github上的POC代码仓库链接，验证了该漏洞的可利用性。

**项目地址:** [SystemVll/CVE-2022-26265](https://github.com/SystemVll/CVE-2022-26265)

**漏洞详情:** [CVE-2022-26265](https://nvd.nist.gov/vuln/detail/CVE-2022-26265)