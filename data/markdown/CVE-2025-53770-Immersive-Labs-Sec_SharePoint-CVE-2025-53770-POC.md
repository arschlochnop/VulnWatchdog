## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经授权的攻击者可以通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 目标系统需运行受影响版本的 SharePoint Server，且攻击者能够通过网络访问该服务器。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞通过网络在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用。提供的POC代码通过构造包含恶意 payload 的 .NET DataSet，并将其序列化、压缩和 Base64 编码，旨在复现该漏洞。利用 ysoserial.net 生成的 payload 嵌入到 DataSet 中，从而绕过 SharePoint 的安全限制，实现 RCE。

**投毒风险：**
该仓库的主要目的是为了生成payload，从 `README.md` 的描述来看，作者明确声明该工具不对 payload 进行任何的校验或检查。因此代码本身的功能比较独立，不太容易隐藏恶意代码， 投毒风险较低。但依旧建议使用者在使用第三方工具时，进行代码审查，以确保安全。所以投毒概率很低，接近于0。这里给出1%的概率。

**利用方式：**
1.  使用 ysoserial.net 工具，选择 `LosFormatter` 格式，`TypeConfuseDelegate` 利用链，并指定要执行的命令（例如 `cmd /c calc.exe`），生成 Base64 编码的 payload。
2.  使用提供的 `OurSharePointBuilder.exe` 工具，将 ysoserial.net 生成的 payload 作为输入，嵌入到 .NET DataSet 中，并进行序列化、GZip 压缩和 Base64 编码，生成最终的 payload。
3.  将生成的 payload 发送到存在漏洞的 SharePoint Server。SharePoint Server 在处理该 payload 时，会触发反序列化漏洞，执行嵌入的恶意代码。

**总结：**
该漏洞是一个高危漏洞，利用过程较为复杂，但 POC 代码的出现降低了利用难度。建议受影响的用户尽快安装 Microsoft 提供的安全更新，并采取其他缓解措施，例如限制对 SharePoint Server 的网络访问。

**项目地址:** [Immersive-Labs-Sec/SharePoint-CVE-2025-53770-POC](https://github.com/Immersive-Labs-Sec/SharePoint-CVE-2025-53770-POC)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)