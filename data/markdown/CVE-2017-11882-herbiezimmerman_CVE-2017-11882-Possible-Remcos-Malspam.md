## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏漏洞/远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

**利用条件:** 用户打开包含恶意构造的Office文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-11882 存在于 Microsoft Office 的 Equation Editor 组件中，是一个内存破坏漏洞，允许攻击者在当前用户上下文中执行任意代码。攻击者可以通过构造恶意的Office文档，利用该漏洞执行 shellcode。提供的POC代码 `/tmp/65250b75898e0f55503cec339fa547e9/password.txt` 仅仅包含字符串 `herbiegoesbananas`，并非漏洞利用代码，可能是用于后续攻击的凭据或者诱饵。漏洞利用通常涉及构造包含恶意Equation Editor对象的Office文档，当Office软件尝试解析该对象时，触发内存破坏，从而执行预先设定的恶意代码。根据搜索引擎结果，该漏洞在野外被广泛利用，常被用于传播Agent Tesla等恶意软件。

**有效性：** 该漏洞真实有效，存在公开的利用代码和exp。
**投毒风险：** 提供的 `password.txt` 文件本身不构成投毒，仅仅是一个可能用于其他目的的密码或字符串。因此，投毒风险为0%。
**利用方式：**

1.  攻击者创建一个特制的Office文档，其中包含恶意的Equation Editor对象。
2.  当受害者打开该文档时，Office应用程序尝试解析该Equation Editor对象。
3.  由于漏洞存在于Equation Editor的内存处理过程中，解析过程会导致内存损坏。
4.  攻击者精心设计的恶意数据会覆盖内存中的关键区域，使得程序执行流程跳转到攻击者预先注入的shellcode。
5.  Shellcode执行后，可以下载和执行其他恶意软件，或者执行其他恶意操作。

**项目地址:** [herbiezimmerman/CVE-2017-11882-Possible-Remcos-Malspam](https://github.com/herbiezimmerman/CVE-2017-11882-Possible-Remcos-Malspam)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)