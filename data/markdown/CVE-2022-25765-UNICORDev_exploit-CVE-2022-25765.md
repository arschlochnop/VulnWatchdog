## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 需要pdfkit处理包含恶意URL的输入

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25765是pdfkit gem中的一个命令注入漏洞。当pdfkit处理URL时，没有进行充分的过滤，导致攻击者可以通过构造恶意的URL，在服务器上执行任意命令。漏洞存在于0.8.7.2之前的版本。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。漏洞库信息明确指出该漏洞是由于URL未正确过滤导致的命令注入。搜索引擎结果也提供了关于该漏洞的详细信息和利用方式。漏洞利用代码（exploit-CVE-2022-25765.py）提供了利用该漏洞的脚本，并且README.md中也包含了详细的使用说明和示例。

**投毒风险：**
虽然提供的POC代码主要功能是利用命令注入漏洞，但是仍然存在一定投毒的风险。例如，攻击者可能会在生成payload的过程中，或者在反弹shell的阶段，引入一些恶意代码，窃取敏感信息或者破坏系统。考虑到此POC较为完善，功能明确，可以推断投毒概率较低，大约10%。

**利用方式：**
利用方式主要有以下几种：

1.  **自定义命令模式：** 攻击者可以使用 `-c` 参数指定要执行的命令。该命令会被嵌入到恶意的URL中，当pdfkit处理该URL时，就会执行该命令。
2.  **反弹Shell模式：** 攻击者可以使用 `-s` 参数指定本地IP地址和端口号。该脚本会生成一个反弹shell的payload，当pdfkit处理包含该payload的URL时，就会反弹shell到攻击者的机器上。
3.  **结合目标网站：** 如果目标网站正在使用易受攻击的pdfkit版本，则可以使用 `-w` 参数指定目标网站的URL，`-p`参数指定POST参数。该脚本会将恶意URL发送到目标网站，触发漏洞。

总的来说，该漏洞利用方式简单，危害性高，攻击者可以利用该漏洞在服务器上执行任意命令，甚至完全控制服务器。

**项目地址:** [UNICORDev/exploit-CVE-2022-25765](https://github.com/UNICORDev/exploit-CVE-2022-25765)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)