## CVE-2025-48384-Git任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库或初始化包含恶意配置的子模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 描述了 Git 中由于配置引用解析错误导致的任意代码执行漏洞。当 Git 读取配置值时，会去除末尾的回车符和换行符。当写入配置项时，带有末尾回车符的值不会被引用，导致回车符丢失。在初始化子模块时，如果子模块路径包含末尾回车符，则读取的路径会被更改，导致子模块检出到错误的位置。如果存在一个符号链接将更改后的路径指向子模块钩子目录，并且子模块包含一个可执行的 post-checkout 钩子，则在检出后可能会意外执行该脚本。

**有效性：**

提供的POC代码是一个简单的 `post-checkout` 钩子脚本，用于打开一个网页 `https://github.com/kallydev`。利用方式是通过精心构造的子模块路径和符号链接，使得该脚本在 `git checkout` 操作后被执行。该POC代码有效，能够触发任意代码执行。

**投毒风险：**

该POC代码本身比较简单，只是打开一个网页，**不存在明显的恶意投毒代码**。因此，投毒风险较低，为 0%。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitmodules`文件的仓库，该文件中的子模块路径包含尾部回车符()。
2.  攻击者在仓库中创建一个符号链接，指向子模块目录下的 `.git/modules/<子模块名>/hooks` 目录，如 `evil_link -> .git/modules/<子模块名>/hooks/post-checkout`。
3.  攻击者在子模块中创建一个恶意的 `post-checkout` 钩子脚本。
4.  受害者克隆该仓库并初始化子模块 (`git submodule init` 和 `git submodule update`)。
5.  当受害者执行 `git checkout` 命令时，由于子模块路径包含尾部回车符，Git 会将子模块检出到错误的位置。由于符号链接的存在，`post-checkout` 钩子脚本会被执行，从而导致任意代码执行。

**项目地址:** [kallydev/cve-2025-48384-hook](https://github.com/kallydev/cve-2025-48384-hook)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)