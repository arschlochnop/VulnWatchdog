## CVE-2025-6218-WinRAR目录遍历远程代码执行

**漏洞编号:** CVE-2025-6218

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** 7.11 (64-bit) 及更早版本

**利用条件:** 用户需要打开恶意的RAR压缩包并解压到特定目录

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6218是一个WinRAR中的目录遍历漏洞，允许远程攻击者执行任意代码。攻击者可以通过构造恶意压缩包，在解压时将文件写入到任意目录，例如Windows的启动目录，从而在用户下次登录时执行恶意代码。

**有效性评估：**
根据漏洞描述、搜索结果以及提供的PoC代码，该漏洞的PoC代码是有效的。PoC代码创建了一个压缩包，其中包含一个批处理文件（POC.bat），该批处理文件会启动计算器程序（calc.exe）。利用目录遍历漏洞，这个批处理文件会被解压到启动目录，从而在用户下次登录时自动执行。

**投毒风险评估：**
PoC代码本身非常简单，仅包含一个批处理文件，用于创建恶意压缩包，并将一个简单的calc.exe启动脚本放置到系统启动目录。对PoC代码分析后，发现其中存在轻微的投毒风险。PoC脚本中指定了WinRAR的默认安装路径`C:\Program Files\WinRAR\WinRAR.exe`，如果用户的WinRAR安装在其他位置，则PoC无法正常工作。此外，PoC假设当前工作目录向上两级目录即为用户主目录,在特殊部署环境中,可能会失效.但总体而言，代码结构清晰，功能单一，隐藏恶意代码的可能性较低。投毒风险评估为10%。

**利用方式：**
1.  攻击者创建一个恶意的RAR压缩包，该压缩包包含一个或多个批处理文件或其他可执行文件。
2.  压缩包中的文件路径被精心构造，利用目录遍历漏洞，指向目标系统上的敏感目录，如启动目录或系统目录。
3.  攻击者诱使用户打开该RAR压缩包，并通过WinRAR的"Extract to {folder}"选项将其解压到当前目录。
4.  WinRAR在解压过程中，由于目录遍历漏洞，会将恶意文件写入到指定目录，从而实现任意代码执行。

**利用缓解措施：**
*   升级WinRAR到最新版本 (>=7.12),官方已经修复此漏洞。
*   不要打开来自不可信来源的RAR压缩包。
*   谨慎处理RAR压缩包，特别是文件名和目录结构。
*   使用杀毒软件扫描RAR压缩包。


**项目地址:** [skimask1690/CVE-2025-6218-POC](https://github.com/skimask1690/CVE-2025-6218-POC)

**漏洞详情:** [CVE-2025-6218](https://nvd.nist.gov/vuln/detail/CVE-2025-6218)