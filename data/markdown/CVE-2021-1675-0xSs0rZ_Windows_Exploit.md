## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，允许远程代码执行，可能导致系统完全被控制

**影响版本:** 受影响的Windows版本众多，包括Windows 7, 8.1, 10以及多个Windows Server版本，具体版本号参考漏洞库信息。

**利用条件:** 需要Print Spooler服务运行，攻击者需要具有一定的权限或者利用其他漏洞进行提权。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个Windows Print Spooler服务中的远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞影响多个Windows版本。攻击者可以通过利用该漏洞在目标系统上执行任意代码，从而完全控制系统。利用方式是，攻击者可以上传一个恶意的打印机驱动程序，Print Spooler服务在安装驱动程序时会以SYSTEM权限运行其中的代码。提供的PoC代码 `CVE-2021-1675.ps1` 是一个PowerShell脚本，它通过 `AddPrinterDriverEx` 函数添加恶意的打印机驱动程序，从而执行DLL中的代码。代码中包含添加新用户并将其加入管理员组的功能，也可以指定自定义的DLL。虽然PoC中包含了修改用户密码等功能，但主要风险是允许执行任意DLL，因此存在一定投毒风险，例如在提供的DLL中加入恶意代码。投毒风险评估为10%是因为大部分代码逻辑是为了实现漏洞利用，但理论上可以通过替换DLL来执行恶意操作。

**项目地址:** [0xSs0rZ/Windows_Exploit](https://github.com/0xSs0rZ/Windows_Exploit)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)