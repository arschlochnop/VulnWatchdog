## CVE-2023-37979-Ninja Forms Contact Form-Reflected XSS

**漏洞编号:** CVE-2023-37979

**漏洞类型:** Reflected XSS

**影响应用:** Ninja Forms Contact Form

**危害等级:** 高危，可能导致任意代码执行，权限提升等

**影响版本:** <= 3.6.25

**利用条件:** 需要用户交互，目标站点存在漏洞插件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是Ninja Forms Contact Form插件中的一个未经授权的反射型跨站脚本（XSS）漏洞。攻击者可以通过构造恶意的URL，诱使用户点击，从而在用户的浏览器中执行任意JavaScript代码。

**有效性：**

根据漏洞库信息和搜索结果，POC代码的有效性较高。github存在可利用的POC脚本。

**投毒风险：**

查看提供的POC脚本，`exploit.py` 脚本首先通过`check_vulnerable()`函数检查目标网站是否安装了易受攻击版本的Ninja Forms插件。如果是，则通过 `exploit()`函数构造包含恶意JavaScript代码的HTTP POST请求，并将请求发送到 `/wp-admin/admin-ajax.php` 端点。从代码本身来看，投毒风险较低，主要风险在于利用成功后，恶意脚本可能被用于恶意目的。例如窃取用户cookie或者进行恶意跳转等等。

评估的投毒风险是10%。 这个评估基于以下假设：
*   虽然脚本主要功能是利用漏洞，但存在一些微小的、不太明显的代码修改空间，这些修改可能会导致意外行为。
*   脚本的使用者可能不完全理解代码的含义，从而在无意中执行恶意操作。
*   作者可能存在隐藏意图，但没有直接证据表明存在恶意代码。

**利用方式：**

1.  **检查漏洞：** 使用`check_vulnerable()`函数检查目标WordPress站点上安装的Ninja Forms插件版本是否低于或等于3.6.25。
2.  **构造Payload：**  在`exploit()`函数中，可以构造XSS payload，如注入`<script>alert("XSS")</script>`或其他恶意JS。
3.  **发送请求：** 使用`requests.post`向`/wp-admin/admin-ajax.php`发送一个POST请求，其中包含以下参数：
    *   `action`: `nf_batch_process`
    *   `batch_type`: `import_form_template`
    *   `security`: `e29f2d8dca` (硬编码的nonce值，可能需要根据实际情况修改)
    *   `extraData[template]`: `formtemplate-contactformd`
    *   `method_override`: `_respond`
    *   `data`:  包含XSS payload的变量，该变量会被注入到页面的某个位置，当用户访问包含该payload的页面时，XSS漏洞就会触发。

**总结：**

该漏洞是一个反射型XSS漏洞，攻击者需要诱骗用户访问包含恶意payload的URL才能触发。成功利用该漏洞可以允许攻击者在受害者浏览器中执行恶意代码，从而可能窃取敏感信息，劫持用户会话或执行其他恶意操作。

**项目地址:** [d0rb/CVE-2023-37979](https://github.com/d0rb/CVE-2023-37979)

**漏洞详情:** [CVE-2023-37979](https://nvd.nist.gov/vuln/detail/CVE-2023-37979)