## CVE-2025-32463 - Sudo chroot 权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户需要具有sudo权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 中一个严重的权限提升漏洞，允许本地用户利用 `--chroot` 选项获得 root 权限。该漏洞存在于 1.9.14 到 1.9.17p1 之间的 Sudo 版本中。

**漏洞利用方式：**

1.  **受影响版本：** 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之间。
2.  **漏洞点：** 该漏洞利用了 Sudo 在使用 `--chroot` 选项时，会使用用户可控目录下的 `/etc/nsswitch.conf` 文件。
3.  **攻击步骤：**
    *   攻击者创建一个包含恶意配置的 `/etc/nsswitch.conf` 文件。
    *   攻击者使用 `sudo --chroot` 选项，指定包含恶意配置文件的目录。
    *   Sudo 使用攻击者控制的 `/etc/nsswitch.conf` 文件，可能导致权限提升。
4.  **PoC代码分析：**
	* README.md 提供了下载地址和使用说明，但是并没有直接给出利用代码。只说明了利用方式为sudo ./exploit
	* get_root.py 给出了python3脚本。但是只给出了脚本的头文件，并没有实际的代码部分。因此无法得知是否有效和存在投毒代码。
5.  **风险评估：** 由于漏洞允许本地用户提升到 root 权限，因此风险极高。成功利用此漏洞可能导致系统完全受损。
6.  **投毒风险：**
	* 由于提供的get_root.py不完整，无法判断投毒风险。README.md中给出github的下载地址。存在植入后门的可能性，但是无法确定github作者是否可信。
	* 根据经验，此类 PoC 中可能存在后门，如反弹 shell 或添加恶意用户。因此，投毒风险评估为10%，主要是考虑到代码的不完整性和对远程代码的依赖。建议下载后检查代码，再执行。

**项目地址:** [no-speech-to-text/CVE-2025-32463](https://github.com/no-speech-to-text/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)