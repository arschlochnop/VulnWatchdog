## CVE-2016-10006-OWASP AntiSamy-XSS

**漏洞编号:** CVE-2016-10006

**漏洞类型:** XSS

**影响应用:** OWASP AntiSamy

**危害等级:** 中危，可能导致跨站脚本攻击

**影响版本:** < 1.5.5

**利用条件:** 需要提交恶意构造的HTML输入

**POC 可用性:** 否

**投毒风险:** 10%

## 详情

CVE-2016-10006 是 OWASP AntiSamy 1.5.5 之前版本中的一个 XSS 漏洞。攻击者可以提交一个特殊构造的输入（一个支持 style 属性并包含 active content 的标签），从而绕过 AntiSamy 的保护并注入可执行代码。该漏洞是由于 CSS 验证不当导致的。 

**有效性：** 提供的漏洞利用代码主要是 AntiSamy 库的 Maven 项目文件和测试文件，并没有直接体现漏洞的利用 Payload，因此无法直接判断其有效性。但是，CVE 描述和搜索结果确认了该漏洞的存在，所以如果找到合适的 Payload，漏洞应该是可以利用的。

**投毒风险：**提供的代码库是 AntiSamy 项目的源码，从 `pom.xml` 和测试文件来看，主要目的是构建和测试 AntiSamy 库本身的功能。虽然没有发现明显的恶意代码，但考虑到以下几点，仍然存在一定的投毒风险：

1.  **间接投毒：** 攻击者可能通过提交精心构造的 PR，修改 CSS 解析逻辑，使得在特定情况下允许执行恶意代码。这种投毒方式较为隐蔽，难以直接检测。
2.  **依赖项风险：** 项目依赖的第三方库（如 `xml-apis`、`batik-css` 等）如果存在安全漏洞，也可能间接影响 AntiSamy 的安全性。

因此，综合来看，投毒风险较低，但不能完全排除，预估为 10%。

**利用方式：** 利用此 XSS 漏洞，攻击者需要找到一个 AntiSamy 允许的标签，该标签可以支持 `style` 属性，并且能在 `style` 属性中嵌入 JavaScript 代码。例如，早期版本的 AntiSamy 可能允许使用 `<div style="...">` 标签，攻击者可以在 `style` 属性中使用类似 `expression(alert('XSS'))` 的 CSS 表达式来执行 JavaScript 代码。修复后的 AntiSamy 会更严格地过滤 `style` 属性中的内容，防止此类攻击。

**项目地址:** [shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3](https://github.com/shoucheng3/nahsra__antisamy_CVE-2016-10006_1-5-3)

**漏洞详情:** [CVE-2016-10006](https://nvd.nist.gov/vuln/detail/CVE-2016-10006)