## CVE-2025-45346 - Bacula-Web SQL 注入

**漏洞编号:** CVE-2025-45346

**漏洞类型:** SQL注入

**影响应用:** Bacula-Web

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < v9.7.1

**利用条件:** 需要有效的Bacula-Web会话cookie和对目标Bacula-Web实例的网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是Bacula-Web在处理jobfiles路由时存在的SQL注入漏洞。攻击者可以通过构造恶意的HTTP GET请求，特别是利用时间盲注，来执行任意SQL代码，如提取数据库版本等敏感信息。漏洞利用代码通过在HTTP GET请求中插入包含 `pg_sleep()` 函数的SQL payload来实现时间延迟。如果服务器响应时间超过预设阈值，则表明SQL注入存在。然后，脚本通过二分查找的方法，逐个字符地提取PostgreSQL数据库的版本信息。经过分析，未发现明显的投毒代码，但恶意代码可能被隐藏在看似无害的字符串中。因此，投毒风险较低，但是需要人工审核所有代码。

**项目地址:** [0xsu3ks/CVE-2025-45346](https://github.com/0xsu3ks/CVE-2025-45346)

**漏洞详情:** [CVE-2025-45346](https://nvd.nist.gov/vuln/detail/CVE-2025-45346)