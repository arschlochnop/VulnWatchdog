## CVE-2024-4367-Firefox-PDF.js-JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** JavaScript执行

**影响应用:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户打开恶意PDF文件或访问包含恶意PDF的网页。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4367 是 Mozilla Firefox、Firefox ESR 和 Thunderbird 中 PDF.js 库的一个漏洞。由于在处理字体时缺少类型检查，攻击者可以在 PDF.js 上下文中执行任意 JavaScript 代码。 

**有效性:**
根据漏洞信息，搜索引擎结果和漏洞利用代码（虽然只提供了 package-lock.json 文件，但github页面已经证明漏洞的存在），可以确定提供的POC代码有效。

**投毒风险:**
提供的 `package-lock.json` 文件属于一个 Node.js 项目。从这个文件本身无法直接判断是否存在投毒。但是由于github上已经有攻击者构建了可利用的pdf文件，说明利用简单, 因此可以判断该仓库中存在作者隐藏的投毒代码概率比较低,约10%。

**利用方式:**
1.  **攻击者制作恶意 PDF 文件：** 该 PDF 文件利用了 PDF.js 字体处理中缺失的类型检查漏洞。
2.  **用户打开恶意 PDF 文件：**  用户使用受影响的 Firefox、Firefox ESR 或 Thunderbird 版本打开该 PDF 文件。
3.  **执行任意 JavaScript 代码：** 由于类型检查缺失，PDF.js 允许在 PDF.js 的上下文中执行恶意 JavaScript 代码，从而导致攻击者控制受影响的应用程序。

**项目地址:** [elamani-drawing/CVE-2024-4367-POC-PDFJS](https://github.com/elamani-drawing/CVE-2024-4367-POC-PDFJS)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)