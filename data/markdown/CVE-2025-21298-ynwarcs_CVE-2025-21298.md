## CVE-2025-21298-Windows OLE Remote Code Execution

**漏洞编号:** CVE-2025-21298

**漏洞类型:** 远程代码执行

**影响应用:** Windows OLE

**危害等级:** 高危，远程代码执行

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户交互(虽然是zero-click，但仍然需要用户打开包含恶意OLE对象的文档)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21298 是一个Windows OLE远程代码执行漏洞，CVSS评分高达9.8，定性为Critical。根据漏洞信息和搜索结果，该漏洞允许攻击者通过精心构造的OLE对象在受害者系统上执行任意代码。该漏洞存在于`ole32.dll!UtOlePresStmToContentsStm`函数中。 

**有效性:**

根据提供的POC代码（`README.md`），该POC是一个**内存损坏PoC**，而不是一个完整的exploit。这意味着它可能只能触发漏洞，但不能直接执行任意代码，需要进一步的开发才能实现完整的RCE。

**投毒风险:**

虽然该存储库提供了一个POC，但存在一定的投毒风险。风险评估如下:

*   **License文件:** MIT许可证允许修改和重新分发代码，这本身增加了潜在的投毒风险。攻击者可以修改POC代码，添加恶意功能，并重新发布它。
*   **POC的性质:**  POC本身只是为了触发漏洞，这意味着攻击者可以修改它以用于更恶意的目的，例如植入后门。
*   **代码审查难度:** 即使对代码进行审查，也可能难以发现隐藏的恶意代码，尤其是如果攻击者使用了代码混淆或其他技术。攻击者可能添加看似无害的代码，但在特定条件下触发恶意行为。
*   **wil::details::FeatureImpl的使用:** diff中的`wil::details::FeatureImpl` 调用表明可能存在特性开关或功能标志，这些标志可能被用于有条件地激活恶意代码。

综上所述，虽然表面上是漏洞利用代码，但仍然存在被投毒的风险。由于POC的性质以及MIT许可证的开放性，攻击者可以相对容易地修改代码并添加恶意功能，所以存在10%的投毒可能性。

**利用方式:**

利用方式如下:

1.  **构造恶意的OLE对象:** 攻击者需要创建一个包含恶意OLE对象的文档（例如，RTF文档）。根据搜索结果，该漏洞可以通过发送包含恶意RTF文档的电子邮件来触发。
2.  **触发漏洞:** 当受害者打开包含恶意OLE对象的文档时，`ole32.dll!UtOlePresStmToContentsStm`函数会被调用。
3.  **内存损坏:**  如果OLE对象构造不当，或者`UtOlePresStmToContentsStm`函数处理OLE对象时存在缺陷，则可能导致内存损坏，例如堆溢出或use-after-free。
4.  **代码执行:** 攻击者可以利用内存损坏漏洞来执行任意代码。这通常需要精心构造的shellcode并覆盖关键的内存区域。

根据搜索结果，该漏洞是一个“zero-click”漏洞，这意味着它可能不需要用户进行任何交互即可触发。但是，通常来说，仍然需要用户打开包含恶意OLE对象的文档或电子邮件。


**项目地址:** [ynwarcs/CVE-2025-21298](https://github.com/ynwarcs/CVE-2025-21298)

**漏洞详情:** [CVE-2025-21298](https://nvd.nist.gov/vuln/detail/CVE-2025-21298)