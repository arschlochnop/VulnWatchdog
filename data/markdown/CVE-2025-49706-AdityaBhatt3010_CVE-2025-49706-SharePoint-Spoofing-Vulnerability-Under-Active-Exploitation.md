## CVE-2025-49706 - Microsoft SharePoint Server Spoofing Vulnerability

**漏洞编号:** CVE-2025-49706

**漏洞类型:** 身份验证绕过/欺骗 (Spoofing)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 中危，但结合其他漏洞可升级为高危，可能导致信息泄露、权限提升甚至远程代码执行

**影响版本:** SharePoint Server 2016 (< 16.0.5508.1000), SharePoint Server 2019 (< 16.0.10417.20027), SharePoint Server Subscription Edition (< 16.0.18526.20424)

**利用条件:** 需要经过身份验证的低权限 SharePoint 用户，且目标服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49706 是一个 Microsoft SharePoint Server 中的身份验证绕过漏洞。经过身份验证的攻击者可以通过网络欺骗请求。漏洞本身CVSS评分为中危，但实际利用中，常与其他漏洞（如 CVE-2025-53770）组合利用，形成“ToolShell”攻击链，导致远程代码执行。 

**利用方式：**

1.  攻击者首先需要拥有一个经过身份验证的 SharePoint 用户账户（不需要管理员权限）。
2.  使用 Burp Suite 或类似的 MITM 代理拦截发送到易受攻击端点的合法请求，例如 `SignOut.aspx` 或 `UserProfileService.asmx`。
3.  修改 HTTP 头部，例如 `X-UserToken` 和 `X-Ms-Client-Request-Id`，以欺骗服务器。
4.  将恶意 payload 嵌入到请求中。例如，可以使用 POST 参数上传 webshell (如 `webshell.aspx`)。
5.  导航到上传的 webshell 并通过查询参数触发系统命令执行。

**潜在投毒风险分析：**

提供的漏洞利用代码主要包含一个 README 文件，描述了漏洞原理和利用步骤，以及一个 License 文件。

*   README.md 中包含利用漏洞的步骤，但需要攻击者自行构造 payload，例如 webshell。这意味着投毒者可以在示例代码的基础上添加恶意 payload。文件上传的表单` <form action="/_layouts/15/upload.aspx" method="POST" enctype="multipart/form-data">` 本身是合法的，但webshell的内容可以是恶意的。
*  虽然代码库本身没有明显恶意代码，webshell的生成和上传部分具有潜在风险，因为用户可能会使用包含后门或恶意功能的webshell。因此判断存在10%的投毒风险。

**项目地址:** [AdityaBhatt3010/CVE-2025-49706-SharePoint-Spoofing-Vulnerability-Under-Active-Exploitation](https://github.com/AdityaBhatt3010/CVE-2025-49706-SharePoint-Spoofing-Vulnerability-Under-Active-Exploitation)

**漏洞详情:** [CVE-2025-49706](https://nvd.nist.gov/vuln/detail/CVE-2025-49706)