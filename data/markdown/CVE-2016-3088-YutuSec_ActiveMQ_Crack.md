## CVE-2016-3088 - Apache ActiveMQ 任意文件上传/写入漏洞

**漏洞编号:** CVE-2016-3088

**漏洞类型:** 任意文件上传/写入

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Apache ActiveMQ 5.x < 5.14.0

**利用条件:** 目标服务器运行存在漏洞的Apache ActiveMQ版本，且Fileserver web application未被禁用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache ActiveMQ的Fileserver Web应用中。攻击者可以通过首先发送一个HTTP PUT请求上传任意文件，然后使用HTTP MOVE请求将该文件移动到Web目录，从而实现任意代码执行。  

**利用方式：**  
1.  **PUT请求：**  攻击者构造一个HTTP PUT请求，将恶意文件（例如JSP webshell）上传到`/fileserver/` 目录下，文件名可以是任意的，例如 `123.txt`。
2.  **MOVE请求：**  攻击者构造一个HTTP MOVE请求，将刚上传的文件从`/fileserver/123.txt` 移动到Web应用可访问的目录，例如`/webapps/api/s.jsp`。`Destination`头指定了目标路径。
3.  **访问恶意文件：**  攻击者通过Web浏览器访问移动后的文件（例如`http://target/api/s.jsp`），服务器会解析并执行该文件中的恶意代码。

**POC有效性：**  
根据漏洞信息和提供的利用代码，可以判断该POC代码是有效的。代码首先检查ActiveMQ的默认口令是否存在，若存在，则尝试利用PUT和MOVE方法上传并移动jsp文件到web目录，并进行访问，判断是否存在漏洞。

**投毒风险评估：**  
经过分析，此仓库中的代码主要功能是检测和利用CVE-2016-3088漏洞，没有发现明显的恶意代码或后门。`DataHandle/Check.go`中存在对`activemq.home` 和 `user.dir` 系统属性的判断，以确定ActiveMQ的安装路径，这是漏洞利用的一部分，不是投毒。因此，投毒风险评估为0%。

**项目地址:** [YutuSec/ActiveMQ_Crack](https://github.com/YutuSec/ActiveMQ_Crack)

**漏洞详情:** [CVE-2016-3088](https://nvd.nist.gov/vuln/detail/CVE-2016-3088)