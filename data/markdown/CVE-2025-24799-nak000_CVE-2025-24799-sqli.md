## CVE-2025-24799 GLPI 未授权SQL注入

**漏洞编号:** CVE-2025-24799

**漏洞类型:** SQL注入

**影响应用:** GLPI

**危害等级:** 高危，可能导致数据泄露

**影响版本:** >= 10.0.0, < 10.0.18

**利用条件:** 目标GLPI实例可网络访问，且版本符合漏洞影响范围

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24799 漏洞是 GLPI 软件中存在的一个未经身份验证的 SQL 注入漏洞，位于 inventory endpoint。根据漏洞库信息和搜索结果，攻击者无需身份验证即可通过构造恶意的 SQL 语句，利用该漏洞从数据库中提取敏感信息。提供的漏洞利用代码 `exploit.py` 是一个 SQL 注入扫描器，它通过时间延迟技术来检测目标 URL 是否存在此漏洞。该脚本通过发送包含 sleep 函数的恶意 XML 请求，观察服务器响应时间来判断是否存在 SQL 注入。如果服务器响应时间显著增加，则表明存在漏洞。

**有效性：**

根据漏洞信息和提供的利用代码，该POC代码是有效的。它利用了时间型盲注来验证漏洞存在。

**投毒风险：**

该代码的投毒风险较低，评估为10%。主要基于以下几点考虑：

*   代码较为简单，主要功能是发送带有时间延迟的 SQL 注入 payload 并检测响应时间，功能相对明确。
*   代码中没有发现明显的恶意行为，例如反弹 shell、上传文件、删除数据等。
*   代码使用了 `requests` 和 `colorama` 库，这两个库是常用的 Python 库，没有发现可疑的第三方依赖。
*   虽然作者标注了 User-Agent, 并使用了时间盲注, 可以判断作者具备一定的安全知识.

然而，仍然存在一些潜在的风险：

*   该脚本未经充分测试，可能存在未知的错误或漏洞。
*   攻击者可能修改该脚本，添加恶意代码。
*   脚本可能被用于非法目的，例如扫描和攻击未经授权的系统。
*    该代码依赖网络请求，可能存在远程依赖被篡改的风险。

**利用方式：**

1.  使用提供的 `exploit.py` 脚本，指定目标 URL。可以使用 `-u` 参数指定单个 URL，或使用 `-f` 参数指定包含多个 URL 的文件。
2.  脚本会向目标 URL 发送包含时间延迟的 SQL 注入 payload。
3.  如果目标 URL 存在漏洞，脚本会输出 "[VULN]" 标记，并显示延迟时间。
4. 攻击者可以根据延迟时间判断漏洞的存在，并进一步利用 SQL 注入漏洞提取敏感数据。

**项目地址:** [nak000/CVE-2025-24799-sqli](https://github.com/nak000/CVE-2025-24799-sqli)

**漏洞详情:** [CVE-2025-24799](https://nvd.nist.gov/vuln/detail/CVE-2025-24799)