## CVE-2019-10392-Jenkins Git Client Plugin-OS Command Injection

**漏洞编号:** CVE-2019-10392

**漏洞类型:** OS Command Injection

**影响应用:** Jenkins Git Client Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.8.4, 3.0.0-rc

**利用条件:** 需要Jenkins用户认证，需要目标安装存在漏洞的Git Client Plugin版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10392 存在于 Jenkins Git Client Plugin 2.8.4 及更早版本和 3.0.0-rc 中。该漏洞是由于插件未正确限制传递给 'git ls-remote' 调用的 URL 参数值，导致操作系统命令注入。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，确认该漏洞存在且为高危。github上存在可利用的poc代码，证明该漏洞可以被成功利用。

**投毒风险分析：**

提供的PoC代码（Jenkins Git RCE CVE-2019-10392.py）主要功能是：

1.  登录Jenkins。
2.  获取Jenkins Crumb（CSRF 令牌）。
3.  创建一个新的Jenkins Job。
4.  通过构造恶意的URL参数，利用`git ls-remote`命令的漏洞，执行任意系统命令。

代码分析中发现，存在如下风险：
*   **默认用户名密码：** 脚本默认使用 admin/admin 作为用户名和密码。如果用户没有修改默认凭据，攻击者可以直接使用此脚本进行攻击。
*   **正则表达式匹配：**  用于提取命令执行结果的正则表达式 `r'&quot; &#039;HEAD&#039;: (1: ){0,1}(.*?):.*?( not found|: Permission denied){0,1}<br>fatal'` 在某些情况下可能无法正确解析命令执行结果，这可能导致输出错误或信息泄露。
*   **异常处理：** 代码中的异常处理部分较为简单，可能会遗漏某些错误情况，导致脚本运行中断或产生误导性信息。
*   **交互模式潜在风险:** 交互模式下，如果攻击者能够控制受害者执行脚本，可能会引导受害者执行恶意命令。

  综合评估，该代码存在一定的投毒风险。主要是利用默认用户名密码、不完善的异常处理、正则表达式匹配以及交互模式等进行潜在攻击。但代码的主要功能仍然是漏洞利用。所以，投毒风险评估为10%。

**利用方式：**

1.  **认证：** 首先，攻击者需要具有 Jenkins 实例的有效用户名和密码，或者利用未授权访问漏洞。
2.  **获取 Crumb：** 获取 Jenkins 的 CSRF 保护令牌 (Crumb)，用于绕过 CSRF 保护。
3.  **创建 Job：**  创建一个新的 Jenkins Job。
4.  **命令注入：**  利用 `hudson.plugins.git.UserRemoteConfig/checkUrl` 端点，通过构造包含恶意命令的 URL 参数，触发命令注入。
5.  **执行命令：**  恶意命令被执行，攻击者可以控制 Jenkins 服务器。


**项目地址:** [ftk-sostupid/CVE-2019-10392_EXP](https://github.com/ftk-sostupid/CVE-2019-10392_EXP)

**漏洞详情:** [CVE-2019-10392](https://nvd.nist.gov/vuln/detail/CVE-2019-10392)