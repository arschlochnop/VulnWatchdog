## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而可能导致远程代码执行

**影响版本:** < 2.442, < LTS 2.426.3

**利用条件:** 目标Jenkins实例运行在受影响的版本且允许未授权访问CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 存在于 Jenkins 的 CLI 命令解析器中，该解析器默认启用了一个特性，会将参数中以 `@` 字符开头的路径替换为文件内容。未授权的攻击者可以通过该特性读取 Jenkins 控制器文件系统上的任意文件。根据搜索引擎结果，该漏洞已经被广泛利用。提供的 exploit.py 脚本首先检查 Jenkins 版本，然后通过构造包含 `@file_path` 的 CLI 命令，从目标服务器读取文件内容。存在投毒风险的原因主要在于，exploit.py 脚本具有写入日志文件的功能，攻击者可以在日志文件中嵌入恶意代码或信息，如果这些日志文件被其他系统或用户读取，可能会造成进一步的危害，同时此脚本可以随意读取目标文件，有进行恶意代码嵌入的可能, 所以给出10%的投毒风险。

**项目地址:** [hybinn/CVE-2024-23897](https://github.com/hybinn/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)