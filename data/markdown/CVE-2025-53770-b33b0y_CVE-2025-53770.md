## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要能够访问SharePoint服务器，并具有一定的身份验证权限（ToolPane.aspx 需要身份验证）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个存在于 Microsoft SharePoint Server (on-premises) 中的反序列化漏洞。未经授权的攻击者可以通过网络远程执行任意代码，漏洞利用难度较低，CVSS评分为9.8 (Critical)。

**漏洞分析:**

该漏洞源于 SharePoint Server 在处理 `ToolPane.aspx` 页面时，对用户提供的 `MSOTlPn_DWP` 参数中的 WebPart 数据进行不安全的反序列化。具体来说，攻击者可以构造恶意的 `Scorecard:ExcelDataSet` WebPart，并在其 `CompressedDataTable` 属性中嵌入经过压缩的 .NET 序列化对象。当 SharePoint Server 反序列化该对象时，攻击者可以利用已知的 .NET gadget chains（例如使用 `LosFormatter` 或 `ObjectDataProvider`）来执行任意代码。

**利用方式:**

1.  攻击者需要具备一定的权限来访问 `/layouts/15/ToolPane.aspx?DisplayMode=Edit` 页面。
2.  攻击者构造包含恶意 `Scorecard:ExcelDataSet` WebPart 的 POST 请求，并将序列化的 payload 放置在 `CompressedDataTable` 属性中。Payload 需要先使用GZIP压缩。
3.  SharePoint Server 反序列化 `CompressedDataTable` 中的数据，执行恶意代码。

**有效性评估:**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。漏洞库信息明确指出该漏洞已在野外被利用 (Exploit exists in the wild)，多个搜索结果也证实了这一点。提供的POC代码 (exploit.py) 针对 `ToolPane.aspx` 页面中的 `MSOTlPn_DWP` 参数，利用 `Scorecard:ExcelDataSet` WebPart 的 `CompressedDataTable` 属性进行反序列化攻击，符合漏洞描述。

**投毒风险分析:**

虽然提供的漏洞利用代码包含对目标服务器执行命令的代码，但这是漏洞利用的必要组成部分，不能简单地将其视为“投毒”。投毒风险主要在于作者可能在代码中隐藏了额外的恶意功能，例如：

*   收集目标系统信息并发送到外部服务器。
*   在目标系统上安装后门。
*   篡改目标系统上的数据。

基于提供的代码，难以确定是否存在上述恶意功能。需要对 `exploit.py` 脚本和所使用的 payload 生成工具（例如 `ysoserial.net`）进行深入分析。但是，由于使用了公开的ysoserial.net工具生成payload，以及代码本身相对简单，判定投毒风险较低，大约为10%。用户在使用该 POC 代码时，仍需要仔细审查代码，并确保在隔离环境中进行测试。

**项目地址:** [b33b0y/CVE-2025-53770](https://github.com/b33b0y/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)