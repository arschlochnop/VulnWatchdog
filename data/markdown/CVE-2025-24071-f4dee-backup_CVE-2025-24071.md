## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM劫持

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和身份冒用

**影响版本:** 受影响的Windows版本请参见漏洞库信息

**利用条件:** 攻击者需要能够访问目标网络，并诱使用户打开恶意文件或访问恶意SMB共享。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071 是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞诱使用户连接到恶意的SMB共享，从而捕获用户的NTLM凭据。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞允许攻击者通过构造特殊的`.library-ms`文件，当用户打开该文件时，Windows文件资源管理器会尝试连接到攻击者控制的SMB共享。
2.  **利用方式：**
    *   攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL。
    *   攻击者将此文件通过各种方式（例如，钓鱼邮件、恶意网站等）发送给受害者。
    *   当受害者打开此文件时，Windows文件资源管理器会自动尝试连接到指定的SMB共享。
    *   如果受害者计算机配置为自动使用其Windows凭据，则攻击者可以捕获受害者的NTLM凭据。
3.  **POC分析：** 提供的shell脚本 `CVE-2025-24071.sh` 实现了上述攻击流程。
    *   该脚本首先检查是否安装了 `zip` 和 `smbclient` 工具，如果没有则尝试安装。
    *   然后，它会创建一个恶意的`.library-ms`文件（`pwn3d.library-ms`），该文件包含指向攻击者指定IP地址的SMB共享的URL。
    *   脚本将`.library-ms`文件压缩成ZIP文件 (`OPEN_ME.zip`)。
    *   最后，该脚本使用 `smbclient` 工具将ZIP文件上传到目标机器上指定的共享目录。
    *   当受害者解压并打开`.library-ms`文件后，文件资源管理器会尝试连接攻击者控制的SMB服务器，从而泄露NTLM凭据。

4.  **有效性：** 根据漏洞描述和POC代码，该漏洞利用方法是有效的。

5.  **投毒风险：** 虽然POC的主要目的是演示漏洞利用，但仍然存在一定的投毒风险。该脚本需要用户提供目标系统的用户名和密码才能上传恶意文件。如果攻击者修改脚本，在上传ZIP文件到目标机器之前,加入恶意Payload,则可能会造成更大的危害。因此判断存在5%的投毒风险,主要集中在恶意修改脚本植入Payload的潜在可能性上,该Payload会在上传到目标系统前被加入,从而扩大攻击范围。

**项目地址:** [f4dee-backup/CVE-2025-24071](https://github.com/f4dee-backup/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)