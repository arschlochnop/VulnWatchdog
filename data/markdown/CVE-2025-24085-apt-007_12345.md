## CVE-2025-24085-Apple-Use-After-Free-Privilege-Escalation

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free权限提升

**影响应用:** Apple visionOS, iOS, iPadOS, macOS, tvOS, watchOS (CoreMedia)

**危害等级:** 高危，允许恶意应用程序提升权限

**影响版本:** < visionOS 2.3, < iOS/iPadOS 18.3, < macOS Sequoia 15.3, < watchOS 11.3, < tvOS 18.3

**利用条件:** 需要恶意应用程序在受害者设备上运行，且用户需要与该应用交互（如点击按钮）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085 是 Apple CoreMedia 框架中的一个使用后释放（Use-After-Free）漏洞，攻击者可以利用该漏洞提升权限。漏洞存在于visionOS, iOS, iPadOS, macOS, tvOS, 和 watchOS 等多个 Apple 操作系统中。根据漏洞信息，该漏洞可能已被实际利用攻击 iOS 17.2 之前的版本。

**漏洞利用方式：**

根据提供的漏洞利用代码（AppDelegate.swift 和 ContentView.swift），该POC尝试利用 XNU VM_BEHAVIOR_ZERO_WIRED_PAGES 漏洞，该漏洞允许对只读页面进行写入，从而实现权限提升。具体利用步骤可能包括：

1.  将目标文件映射到只读内存。
2.  设置特殊的内存行为标志（VM_BEHAVIOR_ZERO_WIRED_PAGES）。
3.  锁定内存页面。
4.  解除内存映射。

通过这些步骤，攻击者可以修改系统只读文件的内容，从而可能实现权限提升。

**有效性评估：**

漏洞库信息和搜索引擎结果都表明 CVE-2025-24085 是一个真实存在的，且已被修复的漏洞。由于有实际利用案例的报告，该漏洞的利用是可行的。提供的POC代码似乎尝试实现上述利用方式，因此判断POC代码可能有效，但需要实际测试验证。

**投毒风险评估：**

POC 代码中存在投毒的风险较低，大约为 10%。 代码结构较为简单，主要功能是创建测试文件并在该文件上尝试利用 UAF 漏洞。潜在的风险点在于`ExploitCore`类中 `prepareExploit`和`runExploit`方法的实现，这些方法可能包含恶意代码。但是代码中作者的注释和简单的代码结构降低了投毒的可能性。需要进一步检查`ExploitCore`的具体实现，以确定是否存在恶意行为。

**项目地址:** [apt-007/12345](https://github.com/apt-007/12345)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)