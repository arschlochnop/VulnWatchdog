## CVE-2019-18935 - Telerik UI for ASP.NET AJAX Deserialization RCE

**漏洞编号:** CVE-2019-18935

**漏洞类型:** .NET Deserialization Remote Code Execution

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** <= 2019.3.1023

**利用条件:** 目标系统运行存在漏洞版本的Telerik UI for ASP.NET AJAX，且攻击者能够访问 /Telerik.Web.UI.WebResource.axd 或 /aspnet-ajax/Telerik.Web.UI.WebResource.axd 端点，同时需要已知或可破解的加密密钥（依赖于CVE-2017-11317或CVE-2017-11357，或其他方式）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18935 存在于 Progress Telerik UI for ASP.NET AJAX 中，是一个 .NET 反序列化漏洞。具体来说，`RadAsyncUpload` 功能存在安全缺陷，允许通过构造特制的 JSON 对象，在服务器端执行任意代码。该漏洞的利用通常需要已知或可破解的加密密钥（CVE-2017-11317、CVE-2017-11357），用于解密上传的文件配置数据。

提供的漏洞利用代码包含一个 Python 扫描器 (`telerik_rce_scan.py`) 和一个 Nmap NSE 脚本 (`http-telerik-vuln.nse`)。

*   **有效性：** 从漏洞库信息和搜索引擎结果来看，该漏洞是一个已经公开且被广泛利用的漏洞，具有较高有效性。提供的漏洞利用代码中，Nmap NSE脚本用于检测目标是否存在漏洞，Python扫描器则用于漏洞验证。
*   **投毒风险：** 查看提供的代码，`http-telerik-vuln.nse` 主要功能是发送 HTTP 请求，检测是否存在漏洞页面,代码逻辑清晰，风险较低。`telerik_rce_scan.py` 根据提供的参数进行扫描，也未发现存在后门代码。 但是由于没有提供 `telerik_rce_scan.py` 完整代码，假设存在一定的风险，给出的投毒风险评估为 10%。
*   **利用方式：** 
    1.  **密钥获取：** 如果目标使用了加密功能，攻击者需要先获取加密密钥。这可以通过利用 CVE-2017-11317 或 CVE-2017-11357 等漏洞，或者通过其他方式获取密钥。
    2.  **构造恶意请求：** 攻击者构造包含恶意 .NET 对象的 JSON 数据，并使用已知的加密密钥进行加密（如果需要）。
    3.  **发送请求：** 攻击者将构造的恶意请求发送到 `/Telerik.Web.UI.WebResource.axd?type=rau` 或 `/aspnet-ajax/Telerik.Web.UI.WebResource.axd?type=rau` 端点。
    4.  **代码执行：** Telerik UI 组件在处理请求时，会反序列化 JSON 数据，从而导致恶意代码在服务器端执行。

搜索引擎结果显示，该漏洞已被多个威胁组织利用，攻击目标包括政府机构等。CISA 也发布了相关警告。

**项目地址:** [becrevex/Telerik_CVE-2019-18935](https://github.com/becrevex/Telerik_CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)