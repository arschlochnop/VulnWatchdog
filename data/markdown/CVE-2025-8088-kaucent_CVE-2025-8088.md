## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 75%

## 详情

CVE-2025-8088是一个WinRAR的路径遍历漏洞，攻击者可以构造恶意的RAR压缩包，当用户解压时，恶意文件会被释放到任意位置，例如Windows启动目录，从而实现任意代码执行。

**有效性分析：**

*   漏洞库信息表明该漏洞真实存在，并且已经被野外利用。
*   提供的PoC代码包含生成恶意RAR文件的Python脚本，并通过路径遍历将payload写入启动目录，表明PoC代码有效。

**投毒风险分析：**

PoC代码中存在以下可疑行为，增加了投毒的风险：

*   **checkUpdates() 函数:**  尝试使用 `mshta.exe` 执行来自 `https://node1-py-store.com` 的内容。`mshta.exe`可以执行HTML应用程序，允许远程执行任意代码，具有极高的风险。
*   **bu(), nu(), main() 函数:**  这些函数涉及生成URL，从该URL请求数据，并执行下载的数据。虽然没有给出dp函数功能，无法知道对请求回来的数据做了什么处理，增加了投毒的可能性。从github下载py脚本执行，也有一定的风险。

因此，该仓库存在较高的投毒风险，约75%。使用前务必仔细审查代码，并在隔离环境中运行。

**利用方式：**

1.  攻击者构造一个恶意的RAR压缩包，该压缩包包含精心设计的目录结构，利用路径遍历漏洞。
2.  压缩包中的文件包括一个payload（例如，一个批处理文件或可执行文件），该payload会被释放到Windows启动目录。
3.  用户如果使用存在漏洞的WinRAR版本解压该压缩包，payload会被释放到启动目录，并在下次系统启动时自动执行。
4.  `config.py` 文件中定义了`DROP_PATH`，指定了payload释放的目标路径为启动目录。 `PAYLOAD` 变量定义了实际执行的命令。
5.  `README.md`描述了生成恶意rar的步骤和免责申明。
6.  `extract.py` 是一个独立的文件，似乎和主漏洞利用脚本无关。它主要用于发送和接收数据，可能用于横向渗透或信息收集，但其功能和目标主机`TARGET_HOST`以及`TARGET_PORT`在缺失定义的情况下无法确定。

**项目地址:** [kaucent/CVE-2025-8088](https://github.com/kaucent/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)