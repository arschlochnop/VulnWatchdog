## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 严重，可能导致远程代码执行和系统崩溃

**影响版本:** Windows 10 版本 1903 和 1909, Windows Server 版本 1903 和 1909

**利用条件:** 目标系统需要启用 SMBv3 协议并存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名 SMBGhost，是 Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理特定请求时存在的一个远程代码执行漏洞。该漏洞存在于Windows 10 版本 1903和1909以及Windows Server 版本 1903和1909中。根据漏洞库信息和搜索结果，该漏洞是可利用的，并且存在公开可用的PoC代码。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断该漏洞的PoC代码是有效的。漏洞库信息中提到了多个PacketStorm Security链接，指向了该漏洞的PoC代码。搜索引擎结果中也出现了多个关于该漏洞的分析和PoC代码的链接，例如GitHub上的“CVE-2020-0796 Remote Code Execution POC”。提供的漏洞利用代码仓库也演示了如何利用该漏洞进行攻击，并成功获取了目标机器的shell。

**投毒风险：**
分析提供的POC代码，投毒风险较低，大概在10%。该PoC主要通过构造恶意的SMB数据包来触发漏洞，利用方式较为直接。主要的风险点在于：
1.  **依赖外部资源：** PoC依赖ly4k/SMBGhost和jamf/CVE-2020-0796-RCE-POC仓库，如果这些仓库被篡改，可能会引入恶意代码。虽然目前PoC的代码只是调用了这些库，但是理论上存在被替换的风险。
2.  **利用方式本身的副作用：**  利用成功后会导致目标系统蓝屏并自动重启，这本身就具有一定的破坏性，但并非有意植入的恶意代码。

总体来看，该PoC代码主要的目的是演示漏洞利用，而不是传播恶意软件。但用户在使用时需要谨慎，确保从可信的来源获取代码，并了解利用可能造成的风险。

**利用方式：**
根据提供的资料，漏洞的利用方式如下：

1.  **侦察目标：** 使用Nmap等工具扫描目标网络，确定存在漏洞的目标机器，特别是开放445端口的机器。
2.  **漏洞验证：** 使用Nmap脚本（`smb-protocols`）或现有的PoC脚本（如`SMBGhost.py`）验证目标机器是否存在CVE-2020-0796漏洞。
3.  **漏洞利用：**
    *   攻击者使用Netcat等工具监听指定端口，等待目标机器的反向连接。
    *   攻击者运行PoC脚本，指定目标IP地址和攻击者自身的IP地址和监听端口。
    *   PoC脚本构造恶意的SMB数据包发送给目标机器，触发漏洞，执行攻击者指定的shellcode。
    *   目标机器反向连接攻击者的监听端口，攻击者获得目标机器的shell控制权。
4.  **权限维持/横向移动 (可选):**  获得shell控制权后，攻击者可以执行任意命令，包括安装后门程序、收集敏感信息、横向移动到其他机器等。

需要注意的是，成功利用该漏洞会导致目标系统蓝屏并自动重启。

**项目地址:** [hungdnvp/POC-CVE-2020-0796](https://github.com/hungdnvp/POC-CVE-2020-0796)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)