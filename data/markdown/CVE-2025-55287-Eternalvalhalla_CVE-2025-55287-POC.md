## CVE-2025-55287-Genealogy-Stored XSS

**漏洞编号:** CVE-2025-55287

**漏洞类型:** Stored XSS

**影响应用:** Genealogy

**危害等级:** 高危，可能导致会话劫持、数据窃取和UI操纵

**影响版本:** < 4.4.0

**利用条件:** 需要编辑器（Editor）或更高级别的用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-55287是Genealogy应用程序中一个存储型XSS漏洞。攻击者通过在人员的firstname或lastname字段中注入恶意JavaScript代码，当高权限用户（例如管理员）尝试删除包含恶意代码的人员时，该恶意脚本将在管理员的会话中执行。利用方式如下：

1.  **攻击者身份：** 具有编辑器或更高级别权限的已认证用户。
2.  **注入点：** 人员的firstname或lastname字段。
3.  **恶意代码：**  PoC代码包含一个JavaScript脚本(poc.js)，该脚本首先获取CSRF token，然后构造一个POST请求，目的是添加一个管理员角色用户到团队，Email地址为攻击者可控。
4.  **触发条件：** 高权限用户尝试删除包含恶意代码的人员。
5.  **影响：**  攻击者可以在管理员的会话中执行任意JavaScript代码，从而可能劫持会话，窃取数据，或者提升自己的权限（例如，通过PoC添加管理员权限用户）。
6. **投毒风险评估:** PoC代码的主要目的是添加管理员，但是其中使用了 `fetch` 函数，可以被修改成执行任意的恶意行为，例如向攻击者的服务器发送敏感信息，或进行其他未授权操作。虽然PoC的主要功能是权限提升，但由于js代码的灵活性，存在一定投毒的可能性，例如在payload中加入额外的请求。代码结构相对清晰，主要的风险集中在email地址的控制和fetch请求上，判断投毒风险较低，10%。

**项目地址:** [Eternalvalhalla/CVE-2025-55287-POC](https://github.com/Eternalvalhalla/CVE-2025-55287-POC)

**漏洞详情:** [CVE-2025-55287](https://nvd.nist.gov/vuln/detail/CVE-2025-55287)