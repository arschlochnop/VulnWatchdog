## CVE-2022-0492-Linux内核cgroup_release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升和容器逃逸

**影响版本:** < kernel 5.17 rc3

**利用条件:** 需要cgroups v1支持且release_agent可写

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0492是Linux内核中cgroup子系统的一个权限提升漏洞。该漏洞存在于`kernel/cgroup/cgroup-v1.c`文件中的`cgroup_release_agent_write`函数中。攻击者可以利用此漏洞，通过修改`release_agent`文件，并触发cgroup的release机制，从而执行任意代码，最终实现权限提升甚至是容器逃逸。

**漏洞有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞确实存在，且有公开的利用代码。漏洞影响kernel 5.17 rc3之前的版本。

**投毒风险：**
提供的漏洞利用代码只包含`CNAME`和`LICENSE`文件，看起来像是git仓库的配置信息，并没有实际的exp代码。因此，无法分析其是否包含恶意代码。但通常情况下，如果从非官方途径获得的POC，存在投毒的风险。

**利用方式：**
1.  **查找可写的cgroup v1目录:** 找到可以写入的cgroup v1目录。
2.  **修改release_agent:** 将cgroup的`release_agent`文件设置为攻击者可控的脚本路径。
3.  **触发release:** 触发cgroup的release机制，例如删除一个cgroup，导致内核执行`release_agent`中指定的脚本。通常是创建一个新的cgroup，然后删除它。
4.  **执行恶意代码:** 攻击者可以在`release_agent`指定的脚本中执行任意代码，例如反弹shell，从而获得更高的权限。如果目标环境是容器，则可能导致容器逃逸。

**风险评估：**
由于漏洞允许权限提升和容器逃逸，因此风险等级较高。如果系统启用了cgroups v1并且没有进行适当的配置，则可能受到攻击。推荐尽快升级内核版本或采取缓解措施，如禁用cgroups v1的`release_agent`功能。

**关于投毒风险比例的说明：**
尽管提供的代码片段看起来安全，但考虑到来源未知，仍然存在小概率的投毒风险（5%）。实际漏洞利用代码需要进一步审查才能确定是否存在恶意行为。

**项目地址:** [SofianeHamlaoui/CVE-2022-0492-Checker](https://github.com/SofianeHamlaoui/CVE-2022-0492-Checker)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)