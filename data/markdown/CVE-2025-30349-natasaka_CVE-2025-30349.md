## CVE-2025-30349-Horde-XSS

**漏洞编号:** CVE-2025-30349

**漏洞类型:** XSS

**影响应用:** Horde IMP

**危害等级:** 高危，可能导致账户劫持和信息泄露

**影响版本:** <= 6.2.27 (Horde IMP), <= 5.2.23 (Horde Application Framework)

**利用条件:** 需要受害者使用存在漏洞的Horde IMP版本，并查看攻击者发送的恶意邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

漏洞CVE-2025-30349存在于Horde IMP 6.2.27及更早版本，以及Horde Application Framework 5.2.23及更早版本中。这是一个跨站脚本（XSS）漏洞，允许攻击者通过构造包含恶意JavaScript代码的HTML电子邮件，在受害者浏览器中执行任意代码，从而可能导致账户劫持。

**利用方式：**

1.  攻击者构造一封包含恶意HTML的电子邮件。该HTML包含一个`<img>`标签，其`onerror`属性包含经过base64编码的JavaScript代码。
2.  当受害者使用存在漏洞的Horde IMP版本查看这封邮件时，浏览器会尝试加载`<img>`标签中不存在的图片，触发`onerror`事件。
3.  `onerror`事件处理程序中的JavaScript代码会被执行，从而实现XSS攻击。
4.  攻击者可以使用JavaScript代码来窃取受害者的cookie，获取受害者的会话信息，或者在受害者的账户下执行其他恶意操作，从而导致账户劫持。

PoC代码有效性分析：

提供的PoC代码 `PoC.py` 演示了如何构造包含恶意HTML的电子邮件。该脚本使用`smtplib`库发送电子邮件，并使用`MIMEMultipart`类构造包含文本和HTML部分的邮件。HTML部分包含一个带有`onerror`事件处理程序的`<img>`标签，该事件处理程序执行base64编码的`console.log()`函数，从而验证XSS漏洞的存在。该POC使用console.log验证了XSS, 证明了POC的有效性.

投毒风险分析：

在`PoC.py`和`Details.md`以及`README.md`文件中，没有发现明显的恶意代码或后门。`PoC.py`主要用于发送包含XSS payload的邮件，其目的是触发漏洞，而不是执行恶意操作。代码中使用了`console.log()`来验证漏洞，这是一个常见的做法，不会对系统造成损害。考虑到邮件发送需要邮箱账户和密码，作者如果恶意使用账户密码，则会暴露自身，因此投毒风险较低。考虑到作者可能在base64编码的js代码中加入恶意代码, 故投毒风险为5%。

搜索引擎结果分析：

*   多个来源（NVD, CISA, Red Hat, Vulmon, Redpacketsecurity等）确认了CVE-2025-30349漏洞的存在和影响。
*   搜索结果表明，该漏洞允许攻击者通过恶意电子邮件利用XSS漏洞进行账户劫持。


**项目地址:** [natasaka/CVE-2025-30349](https://github.com/natasaka/CVE-2025-30349)

**漏洞详情:** [CVE-2025-30349](https://nvd.nist.gov/vuln/detail/CVE-2025-30349)