## CVE-2023-52927-Linux Kernel Netfilter Expectation Handling

**漏洞编号:** CVE-2023-52927

**漏洞类型:** 逻辑错误/拒绝服务

**影响应用:** Linux Kernel Netfilter

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** < 6.1.130, < 6.6

**利用条件:** 需要配置Netfilter conntrack expectation规则

**POC 可用性:** 部分

**投毒风险:** 0%

## 详情

CVE-2023-52927 漏洞存在于 Linux 内核的 netfilter 子系统中，具体来说是在 `nf_ct_find_expectation` 函数中处理 conntrack expectation 的逻辑存在问题。漏洞描述表明，在某些场景下，期望的连接不应从哈希表中移除，但在受影响的代码中，`nf_ct_find_expectation` 会移除 expectation。此漏洞允许攻击者通过构造特定的数据包和 expectation 规则，导致 expectation 被错误地移除或重复创建，进而导致资源耗尽或连接跟踪出现异常，最终导致拒绝服务。根据漏洞库信息和搜索结果，此漏洞在较新版本的内核中已得到修复（>=6.1.130 和 >= 6.6）。

**有效性评估：**
根据提供的信息,漏洞POC代码有效性未知. 提供的代码仓库中仅包含一个 README.md 文件，描述为 `Reproduce-CVE-2023-52927`，但没有提供实际的利用代码。因此，无法直接判断提供的 POC 代码是否有效。

**投毒风险评估：**
由于提供的POC代码仅包含一个空的 README.md 文件，因此投毒风险很低，可以评估为 0%。没有可执行的代码可以被利用来植入恶意代码。

**利用方式分析：**
1.  **设置 Conntrack Expectation:** 攻击者需要首先设置一个 Netfilter conntrack expectation 规则。这通常涉及到使用 `iptables` 或 `nftables` 命令来配置规则。
2.  **触发漏洞：** 然后，攻击者发送与 expectation 匹配的数据包。在受影响的代码中，`nf_ct_find_expectation` 函数会被调用，并且会错误地移除 expectation。
3.  **资源耗尽/拒绝服务：** 通过重复上述步骤，攻击者可以导致 expectation 被重复创建或移除，最终耗尽系统资源或导致连接跟踪出现异常，从而实现拒绝服务攻击。

**项目地址:** [HoangNhoo/Reproduce-CVE-2023-52927](https://github.com/HoangNhoo/Reproduce-CVE-2023-52927)

**漏洞详情:** [CVE-2023-52927](https://nvd.nist.gov/vuln/detail/CVE-2023-52927)