## CVE-2018-13379 Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal功能，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中存在的路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求下载系统文件，从而可能泄露敏感信息，例如 VPN 凭据。根据提供的漏洞利用代码，攻击者通过构造包含路径遍历的 URL，例如 `https://<target_ip>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，来访问并下载 `sslvpn_websession` 文件，该文件可能包含用户的会话信息和凭据。该脚本会对目标IP进行检测，读取返回内容，并检查是否包含 `var fgt_lang =` 字符串，如果存在则将内容写入本地文件，然后解析这个本地文件并尝试提取可打印字符。代码通过多线程来加速扫描过程。投毒风险较低，主要风险点在于保存websession到本地文件，存在被其他恶意程序利用的可能，属于验证poc的正常行为。

**项目地址:** [milo2012/CVE-2018-13379](https://github.com/milo2012/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)