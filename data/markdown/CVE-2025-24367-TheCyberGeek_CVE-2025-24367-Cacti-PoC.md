## CVE-2025-24367 - Cacti Authenticated Graph Template RCE

**漏洞编号:** CVE-2025-24367

**漏洞类型:** 任意文件创建导致RCE

**影响应用:** Cacti

**危害等级:** 高危，允许经过身份验证的用户在服务器上创建任意 PHP 脚本，从而导致远程代码执行

**影响版本:** <= 1.2.28

**利用条件:** 需要 Cacti 实例的有效用户凭据，以及网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24367 存在于 Cacti 的 Graph Template 功能中。经过身份验证的低权限用户可以利用此漏洞创建恶意的 PHP 文件到 Cacti 的 Web 根目录，从而导致任意代码执行。

**漏洞利用方式：**

1.  **身份验证：** 使用提供的用户名和密码登录 Cacti 实例。
2.  **写入 Payload：** 攻击脚本首先在本地写入反弹shell的bash脚本。
3.  **获取 Template ID：** 获取目标 Graph Template 的 ID（例如，Unix - Logged In Users）。
4.  **创建恶意 Graph Template Item：**  通过构造特定的请求数据，将包含恶意 PHP 代码的 Graph Template Item 添加到目标 Graph Template 中。恶意 PHP 代码会被写入到 Cacti 的 web 根目录，导致任意文件创建。
5.  **触发 RCE：** 访问创建的恶意 PHP 文件，从而执行其中的代码，实现远程代码执行（RCE）。

**投毒风险分析：**

该代码的投毒风险较低，约为10%。主要基于以下几点：

*   **免责声明：** 仓库包含明确的免责声明，强调仅用于教育和研究目的，禁止未经授权的使用。
*   **代码可读性：**  Python 脚本代码结构清晰，易于阅读和理解，可以审核其功能。
*   **功能限制：**  脚本的主要功能是利用 CVE-2025-24367 漏洞实现 RCE，没有发现任何其他恶意或隐藏功能，例如收集用户信息或传播恶意软件。
*   **依赖项：** 脚本仅依赖于 `requests` 和 `beautifulsoup4` 库，这些都是常用的 Python 库，不太可能包含恶意代码。

但是，仍然存在一定的风险，例如：

*   **自定义 HTTP 请求：** 脚本使用 `requests` 库发送自定义 HTTP 请求，如果请求构造不当，可能会导致意外的服务器行为。
*   **Bash 脚本执行：**  脚本会生成并执行 Bash 脚本，如果 Bash 脚本本身被篡改，可能会导致恶意代码执行。
*   **Web 服务器功能：** 脚本集成了简单的HTTP服务器，用于传输反弹shell的Payload，可能存在被滥用的风险，但总体风险较低。

**总结：**

提供的漏洞利用代码可以有效利用 CVE-2025-24367 漏洞，但是必须在授权的环境下使用。由于代码结构清晰，并且作者声明只用于教育用途，投毒的可能性较低，但仍然需要小心，务必仔细审查代码。

**项目地址:** [TheCyberGeek/CVE-2025-24367-Cacti-PoC](https://github.com/TheCyberGeek/CVE-2025-24367-Cacti-PoC)

**漏洞详情:** [CVE-2025-24367](https://nvd.nist.gov/vuln/detail/CVE-2025-24367)