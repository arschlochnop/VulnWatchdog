## CVE-2019-19781-Citrix ADC/Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露、服务器控制

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-19781是一个存在于Citrix ADC和Gateway的目录遍历漏洞，利用该漏洞，未经身份验证的远程攻击者可以通过构造特殊的URL来读取任意文件或执行任意命令。提供的POC代码通过修改`NSC_USER`头和利用`newbm.pl`脚本的模板功能，实现命令注入。具体来说，POC上传一个包含恶意代码的XML文件到服务器，然后通过访问该XML文件触发命令执行。虽然主POC功能是利用已知漏洞，但存在轻微投毒风险，例如:作者可能在执行命令的结果时做了手脚，悄悄收集目标系统信息或植入不易察觉的后门，但可能性不高，主要目的是为了简化利用流程，提高成功率。投毒风险的判定依据是：

1.  **POC功能本身：**POC主要功能是利用已知漏洞实现RCE，本身不属于投毒。
2.  **额外的恶意行为：** 代码中没有发现明显收集信息或植入后门的逻辑。
3.  **依赖性分析：** 代码依赖于标准库，没有引入其他可疑的第三方库。

利用方式：

1.  **构造恶意请求:** 攻击者需要构造一个包含目录遍历payload的HTTP请求。
2.  **利用`newbm.pl`:** 通过修改`NSC_USER`头，利用该脚本的模板功能执行命令。
3.  **触发命令执行:** 访问上传的XML文件触发其中包含的命令。

**项目地址:** [qiong-qi/CVE-2019-19781-poc](https://github.com/qiong-qi/CVE-2019-19781-poc)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)