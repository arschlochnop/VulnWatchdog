## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露或远程代码执行 (取决于配置)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行 Apache HTTP Server 2.4.49，且 Alias 指令配置不当或 CGI 脚本启用。需要可以发送 HTTP 请求的网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在路径规范化方面存在缺陷，攻击者可以利用该漏洞将 URL 映射到 Alias 指令配置目录之外的文件。如果这些目录之外的文件没有受到 "require all denied" 等默认配置的保护，请求就可以成功。如果为这些 Aliased 路径启用了 CGI 脚本，则可能导致远程代码执行。

**漏洞利用方式：**

攻击者通过构造包含特殊编码（如 `%2e`）的路径的 HTTP 请求，绕过 Apache HTTP Server 的路径检查，从而访问受限目录之外的文件。例如，`GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd HTTP/1.1` 这样的请求可以尝试读取服务器上的 `/etc/passwd` 文件。

根据提供的 Dockerfile 和 README.md，PoC 的有效性依赖于两个关键步骤：

1.  **Dockerfile:** 使用 `httpd:2.4.49` 镜像，确保存在漏洞的 Apache 版本。
2.  **httpd.conf:**  修改 `httpd.conf` 文件，将 `<Directory />` 部分的 `Require all denied` 更改为 `Require all granted`。这一步**至关重要**，因为 `Require all denied` 配置会阻止对根目录的访问，从而阻止漏洞利用。如果未修改此配置，即使存在漏洞，也无法读取文件。

**投毒风险分析：**

分析提供的 Dockerfile 和 httpd.conf 文件，发现投毒代码的风险较低，估计为 5%。主要风险在于以下可能性：

*   **`httpd.conf` 修改的误导性:**  虽然 README.md 中明确说明了修改 `Require all denied` 的原因，但如果用户盲目复制粘贴配置文件，可能会在无意中降低服务器的安全性。
*   **CGI脚本的滥用:** 虽然PoC本身不包含恶意CGI脚本，但如果服务器上存在未授权或存在漏洞的CGI脚本，攻击者可能会利用该漏洞执行恶意代码。

总体来说，该 PoC 主要用于演示漏洞，但使用者应该意识到其潜在的安全风险。

**项目地址:** [mightysai1997/CVE-2021-41773-i-](https://github.com/mightysai1997/CVE-2021-41773-i-)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)