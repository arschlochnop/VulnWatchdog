## CVE-2025-8359-AdForest-身份验证绕过

**漏洞编号:** CVE-2025-8359

**漏洞类型:** 身份验证绕过

**影响应用:** AdForest WordPress Theme

**危害等级:** 高危，可能导致任意用户登录，包括管理员

**影响版本:** <= 6.0.9

**利用条件:** 需要目标网站安装了存在漏洞的AdForest主题，并且能够访问WordPress的登录页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8359是AdForest WordPress主题中存在的身份验证绕过漏洞。攻击者可以通过提供伪造的身份信息，绕过身份验证机制，并以任意用户的身份登录系统，包括管理员。根据提供的漏洞利用代码，该漏洞利用方式如下：

1.  **目标确定：** 确定目标WordPress网站，以及该网站上安装的AdForest主题的版本是否小于等于6.0.9。
2.  **手机号码处理：** 漏洞利用脚本首先会生成不同格式的手机号码变体，包括带有空格、不带空格、带有`+`号、url编码后的`+`号等，以增加攻击的成功率。
3.  **登录检查：** 脚本会向`wp-admin/admin-ajax.php`发送`sb_login_check_user`动作的POST请求，该请求携带手机号码参数，用于检查用户是否存在。
4.  **用户ID提取：** 如果服务器返回`success: true`，表明手机号码存在，脚本会尝试从响应中提取用户ID。
5.  **登录请求：** 脚本会向`wp-admin/admin-ajax.php`发送`sb_login_user_with_otp`动作的POST请求，该请求携带用户ID和用户名参数，模拟用户通过OTP登录。
6.  **Cookie获取：** 如果服务器成功处理了登录请求，脚本会从响应的Cookie中提取`wordpress_logged_in`开头的Cookie，该Cookie表示用户已成功登录。

**有效性：** 根据提供的POC代码和漏洞描述，该POC代码有效，可以成功利用漏洞绕过身份验证。

**投毒风险：** 审查提供的python脚本，该脚本主要实现了漏洞利用的功能，未发现明显的恶意代码。但是license文件限制了该软件的使用场景，如果使用者违反了相关条款，可能会存在法律风险。可以判断该仓库存在一定的投毒风险。 这里的poison值设为10%，主要考虑License的限制，虽然技术上脚本本身没有明显的恶意代码，但使用不当可能带来风险。

**注意：**  利用该漏洞进行未授权的访问是违法的，请在获得授权的情况下进行安全测试。

**项目地址:** [Nxploited/CVE-2025-8359](https://github.com/Nxploited/CVE-2025-8359)

**漏洞详情:** [CVE-2025-8359](https://nvd.nist.gov/vuln/detail/CVE-2025-8359)