## CVE-2025-48384-Git-RCE

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户克隆包含恶意配置的仓库或初始化包含恶意配置的子模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384是Git中的一个高危漏洞，源于Git在处理包含回车符的配置值时，读取和写入方式不一致。攻击者可以利用这个漏洞，通过构造包含恶意配置（例如，带有尾随回车符的子模块路径）的Git仓库，诱导受害者克隆该仓库，从而实现远程代码执行。具体利用方式是：

1.  **恶意仓库创建：** 攻击者创建一个包含恶意`.gitmodules`文件的Git仓库。该文件中的子模块路径包含一个尾随的回车符(`\r`)。
2.  **符号链接利用：** 当受害者使用`git submodule init`初始化子模块时，Git会错误地解析子模块路径。攻击者在仓库中创建一个符号链接，将错误的子模块路径指向`.git/hooks`目录。
3.  **恶意钩子：**  攻击者在子模块中包含一个恶意的`post-checkout`钩子脚本。该脚本会在`git checkout`操作后自动执行。
4.  **诱导受害者：** 攻击者诱导受害者克隆恶意仓库并初始化子模块（例如，通过`git clone --recursive`或手动执行`git submodule init`和`git submodule update`）。
5.  **代码执行：** 当受害者检出（checkout）仓库时，`post-checkout`钩子脚本会被执行，从而导致远程代码执行。

提供的PoC代码是一个反弹shell的`post-checkout`钩子脚本，如果成功执行，将允许攻击者控制受害者的系统。由于提供的poc代码功能单一,仅仅是反弹shell,没有进行额外的恶意代码操作,判定投毒风险为0%。根据搜索引擎结果，该漏洞已经被CISA添加到已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用。


**项目地址:** [wzx5002/totallynotsuspicious](https://github.com/wzx5002/totallynotsuspicious)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)