## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标服务器运行Rejetto HFS 2.3m，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 中存在的模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的HTTP请求来执行任意命令。

**有效性分析：**

根据漏洞库信息和搜索结果，该漏洞被广泛确认存在并且有公开的PoC。提供的PoC代码（CVE-2024-23692.py）尝试利用该漏洞，发送包含恶意模板注入payload的HTTP GET请求，如果服务器存在漏洞，将执行`ipconfig /all` 命令 (windows系统)或者 `systeminfo` 命令。PoC通过检查响应文本中“RESULT”字符串的出现次数来判断漏洞是否存在。 Burp Suite的POC也验证了此漏洞. 因此，PoC代码是有效的。

**投毒风险分析：**

查看提供的python POC代码，没有发现任何恶意代码，例如反弹shell或下载执行其他文件的行为。也没有发现任何试图修改本地文件或窃取敏感信息的代码。PoC脚本功能相对简单，主要用于验证目标是否存在漏洞。 `README.md` 文件中仅包含 HTTP 请求的 PoC 示例和截图，没有发现潜在的投毒代码。综合判断，该仓库中存在作者隐藏的投毒代码的可能性极低。因此，投毒风险为 0%。

**利用方式分析：**

1.  **漏洞原理：** 漏洞出现在HFS处理模板时，没有对用户输入进行充分的过滤和转义，导致攻击者可以通过构造恶意的模板代码来执行任意命令。
2.  **攻击方式：** 攻击者通过发送包含特定payload的HTTP请求到目标服务器。
3.  **Payload构造：** PoC中使用的payload是`/?s=%0A&cmd=ipconfig+/all&search=%25xxx%25url:%password%}{.exec|{.?cmd.}|timeout=15|out=abc.}{.?n.}{.?n.}RESULT:{.?n.}{.^abc.}===={.?n.}`。该payload利用了HFS的模板引擎，`{.exec|{.?cmd.}`部分会执行`cmd`参数指定的命令，并将结果输出。
4.  **命令执行：**  服务器在解析该请求时，会执行`cmd`参数指定的命令（例如 `ipconfig /all`），并将命令执行的结果嵌入到响应中返回给攻击者。
5.  **漏洞验证：**  PoC通过检查响应中特定字符串（例如 `RESULT`）的出现次数来判断漏洞是否存在。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-23692](https://github.com/k3lpi3b4nsh33/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)