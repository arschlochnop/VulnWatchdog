## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 到 8.3.0 (未打补丁的版本)

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本，并且至少安装了一个插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是 Grafana 中的一个目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。漏洞位于 `/public/plugins/<plugin_id>/` 路径下，通过构造包含目录遍历字符（如 `../`）的 URL，可以绕过对文件路径的限制，访问系统中的其他文件。提供的 exploit.py 脚本通过指定目标 Grafana 实例的 URL 和要读取的文件路径，自动构造包含恶意路径的 URL，并发送 HTTP 请求来读取文件内容。脚本会随机选择一个已安装的插件来利用此漏洞。如果找到文件，内容将被打印到标准输出，或者写入到指定的文件中。根据漏洞库信息和搜索引擎结果，此漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 之间的版本。分析提供的 exploit.py 脚本, 未发现存在任何恶意投毒代码。

**项目地址:** [hupe1980/CVE-2021-43798](https://github.com/hupe1980/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)