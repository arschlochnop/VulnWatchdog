## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够通过HTTP、WebSocket或SSH访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器未禁用一个特性，该特性会将参数中以'@'字符开头的，后跟文件路径的内容替换为文件的实际内容。未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。

**利用方式：**

1.  **下载jenkins-cli.jar:** 攻击者首先需要下载`jenkins-cli.jar`文件，该文件用于与Jenkins CLI进行交互。
2.  **构造Payload:**  攻击者构造包含`@`字符和目标文件路径的payload。例如，`@{/etc/passwd}`用于读取`/etc/passwd`文件。
3.  **连接节点:** 攻击者使用`connect-node`命令，并将包含恶意payload的参数传递给Jenkins CLI。Jenkins CLI在解析参数时，会将`@`符号后的文件内容读取并返回给攻击者。

**有效性：**
提供的PoC代码有效。代码首先下载`jenkins-cli.jar`，然后构造包含目标文件路径的payload，并使用`connect-node`命令触发漏洞。

**投毒风险：**
分析提供的PoC代码，没有发现作者隐藏的恶意代码，用于在目标系统上执行恶意操作或植入后门。PoC代码的功能仅限于利用漏洞读取文件内容，没有超出漏洞利用范围的行为。风险评估为0%。

**项目地址:** [Maalfer/CVE-2024-23897](https://github.com/Maalfer/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)