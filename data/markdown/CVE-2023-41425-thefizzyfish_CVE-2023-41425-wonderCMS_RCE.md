## CVE-2023-41425 Wonder CMS XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** Wonder CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 3.2.0 - 3.4.2

**利用条件:** 需要受害者访问恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41425 是 Wonder CMS 3.2.0 到 3.4.2 版本中存在的跨站脚本 (XSS) 漏洞。 攻击者可以利用此漏洞通过上传精心制作的脚本到 installModule 组件来执行任意代码。

**利用方式：**

1.  攻击者构造包含恶意 JavaScript 代码的 URL。
2.  诱导受害者（通常是管理员）访问该 URL。
3.  恶意 JavaScript 代码利用 Wonder CMS 的 installModule 功能，从攻击者控制的服务器上下载并安装包含 PHP webshell 的 zip 文件 (shell.zip)。
4.  攻击者通过访问webshell，执行任意命令。

**代码分析：**

*   `CVE-2023-41425.py` 是 PoC 脚本，用于自动化漏洞利用过程。
*   脚本首先创建包含 PHP webshell 的 zip 文件 (shell.zip)。
*   脚本生成包含 XSS 向量的 URL，该 URL 触发从攻击者的服务器下载和安装 shell.zip。
*   脚本启动一个 HTTP 服务器，用于托管 shell.zip 和 xss.js。
*   xss.js 脚本用于安装恶意模块。
*   `send_payload` 函数用于利用上传的 webshell 执行命令（反弹shell）。
*   PoC 的流程是，先通过XSS安装恶意模块，模块包含webshell。然后利用webshell执行命令。

**投毒风险分析：**

PoC 代码的主要目的是演示漏洞利用，但仍然存在一些潜在的投毒风险。PoC 本身会部署一个webshell，这是一个后门。但是该webshell是为了验证漏洞的存在，不算作者投毒。代码中存在以下微小风险：

*   **HTTP服务器：**  PoC 脚本启动一个简单的 HTTP 服务器。如果攻击者修改脚本，可能会引入恶意文件或配置不当，导致额外的安全风险。但是考虑到脚本的简短，可能性较低。
*   **反弹 Shell：** 脚本创建反弹 shell。 虽然是payload的一部分，但恶意攻击者可以将受害者的服务器连接到其控制的服务器，并进一步威胁受害者的系统。

考虑到上述风险，该仓库中存在作者隐藏的投毒代码的风险约为5%。主要是对反弹shell的滥用，和http服务器可能存在安全隐患。

**项目地址:** [thefizzyfish/CVE-2023-41425-wonderCMS_RCE](https://github.com/thefizzyfish/CVE-2023-41425-wonderCMS_RCE)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)