## CVE-2024-23692-Rejetto HFS 2.3m 远程命令执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入导致的远程命令执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行受影响版本的Rejetto HTTP File Server，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本及以下存在的模板注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意命令。利用方式如下：

1.  **漏洞描述：** 漏洞位于服务器处理模板的环节，攻击者通过构造恶意输入，将命令注入到模板中，由服务器执行。
2.  **漏洞利用方式：** 攻击者发送包含恶意模板代码的HTTP GET请求，服务器解析该请求时，会将恶意代码作为命令执行。
3.  **POC分析：** 提供的Go代码通过`zmap`扫描指定端口，然后使用HTTP GET请求，通过在URL中拼接经过编码的恶意命令来利用漏洞。POC首先检测目标是否为HFS服务，如果是则执行预定义的命令，例如 `ping wlccwlc.dnslog.cn` 和 `whoami`。
4.  **投毒风险分析：** 风险较低。主要风险来自以下几点：
    *   POC中执行的命令可以被修改，攻击者可以利用该POC执行任意恶意命令。
    *   `hfs.go`本身没有发现明显的投毒代码。代码逻辑相对清晰，主要功能是发送HTTP请求并处理响应。
    *   `README.md`文件中包含TG链接，存在一定的恶意引流风险，诱导用户加入恶意社群。

**项目地址:** [WanLiChangChengWanLiChang/CVE-2024-23692-RCE](https://github.com/WanLiChangChengWanLiChang/CVE-2024-23692-RCE)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)