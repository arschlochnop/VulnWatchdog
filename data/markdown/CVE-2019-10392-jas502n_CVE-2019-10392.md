## CVE-2019-10392 Jenkins Git Client Plugin OS 命令注入

**漏洞编号:** CVE-2019-10392

**漏洞类型:** OS 命令注入

**影响应用:** Jenkins Git Client Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.8.4 及更早版本, 3.0.0-rc

**利用条件:** 需要 Jenkins 用户具有执行 Git Client Plugin 相关操作的权限（例如，配置 Git 仓库）。攻击者需要能控制传递给 'git ls-remote' 命令的 URL 参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10392 存在于 Jenkins Git Client Plugin 中，由于插件没有正确限制传递给 `git ls-remote` 的 URL 参数，导致了 OS 命令注入漏洞。攻击者可以通过构造恶意的 URL，在 Jenkins 服务器上执行任意系统命令。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞确实存在并且影响指定的 Jenkins Git Client Plugin 版本。提供的 POC 代码 `https://github.com/jas502n/CVE-2019-10392` 验证了该漏洞利用。

**投毒风险：**
查看提供的POC代码，主要包含Dockerfile和一些截图，用于演示漏洞的利用过程。README.md 文件本身没有发现直接的投毒代码。docker启动命令`docker run -p 8080:8080 -p 50000:50000 jenkins/jenkins:lts-alpine`拉取的是官方镜像。但是，任何从第三方来源获取的代码（包括 docker 镜像）都存在潜在的风险。代码仓库包含的图片文件，如果图片文件经过特殊处理，有可能存在隐蔽的恶意代码。考虑到POC 主要目的是演示漏洞利用，且依赖官方镜像以及已知漏洞，因此判断投毒风险较低。

**利用方式：**
1.  攻击者需要具有在 Jenkins 中配置 Git 仓库的权限。
2.  在配置 Git 仓库时，攻击者在 Git 仓库 URL 字段中插入恶意命令。该 URL 将被传递给 `git ls-remote` 命令。
3.  当 Jenkins 执行构建或相关操作时，`git ls-remote` 命令会被调用，恶意命令得到执行，从而实现远程代码执行。

**搜索引擎结果总结:**
搜索引擎结果确认了漏洞的存在，并提供了漏洞描述，受影响的版本，以及相关缓解措施的链接。`https://github.com/jas502n/CVE-2019-10392`链接直接指向了一个包含POC的Github仓库。

**项目地址:** [jas502n/CVE-2019-10392](https://github.com/jas502n/CVE-2019-10392)

**漏洞详情:** [CVE-2019-10392](https://nvd.nist.gov/vuln/detail/CVE-2019-10392)