## CVE-2018-10933 - libssh Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** Authentication Bypass

**影响应用:** libssh

**危害等级:** Critical, allows unauthorized access to SSH servers.

**影响版本:** < 0.7.6, < 0.8.4

**利用条件:** Server must be running a vulnerable version of libssh and expose an SSH port.

**POC 可用性:** Yes

**投毒风险:** 5%

## 详情

CVE-2018-10933 is a critical authentication bypass vulnerability in libssh. A malicious client can send an `SSH2_MSG_USERAUTH_SUCCESS` message to the server *before* proper authentication has taken place, tricking the server into thinking the client is authenticated. 

**有效性评估:**

根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码（尤其是Exploit-DB上的45638），可以确认该漏洞的POC是有效的。搜索结果中的链接 (如 fluidattacks.com, rapid7.com, cybrary.it) 都描述了利用此漏洞绕过身份验证的过程。漏洞利用代码库中的`README.md`和`rapport/rapport.tex`也提供了漏洞的描述和利用参考。

**投毒风险评估:**

提供的代码仓库主要包含以下内容：

*   `README.md`: 包含漏洞描述、参考链接以及Shodan搜索示例。
*   `rapport/rapport.tex`: 一个LaTeX文档，详细描述了漏洞，包括受影响的服务、漏洞描述、目标、架构示例和安全建议。

**分析：**

*   代码本身（README和rapport.tex）不包含任何可执行的payload或恶意代码。
*   `README.md`中提供的Shodan搜索链接旨在帮助寻找潜在的受害者，本身没有恶意。
*   `rapport.tex` 只是漏洞分析报告，提供了漏洞的详细信息和修复建议。

**结论：**

该仓库本身存在投毒代码的风险较低，大约5%。这是因为漏洞利用代码主要是分析文档和一些参考链接，没有直接包含恶意payload。投毒风险主要来源于用户可能错误地使用Shodan搜索结果，攻击未经授权的目标，或者修改利用代码引入恶意功能。用户应当谨慎使用相关信息，并遵守法律法规。

**漏洞利用方式:**

1.  **连接到目标SSH服务器:** 使用SSH客户端或自定义脚本连接到运行易受攻击的libssh版本的SSH服务器。
2.  **绕过身份验证:** 在正常的SSH身份验证过程开始之前，发送`SSH2_MSG_USERAUTH_SUCCESS`消息。
3.  **建立未经授权的会话:** 如果服务器容易受到攻击，它将接受此消息，而无需任何进一步的身份验证，从而允许攻击者执行命令并访问服务器资源。


**项目地址:** [ensimag-security/CVE-2018-10933](https://github.com/ensimag-security/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)