## CVE-2024-44871-moziloCMS-任意文件上传

**漏洞编号:** CVE-2024-44871

**漏洞类型:** 任意文件上传

**影响应用:** moziloCMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.0

**利用条件:** 需要目标系统运行moziloCMS 3.0版本，且攻击者需要管理员权限（用户名密码）。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-44871是moziloCMS v3.0中的一个任意文件上传漏洞，位于`/admin/index.php`组件。攻击者可以利用此漏洞上传恶意文件，从而执行任意代码。漏洞利用过程如下：

1.  **身份验证：** 首先，攻击者需要使用管理员用户名和密码登录到moziloCMS后台管理面板。
2.  **文件上传：** 成功登录后，攻击者可以通过`/admin/index.php`上传恶意文件。POC代码中，上传的文件伪装成jpg图片，但实际包含PHP代码。
3.  **文件重命名：** 上传成功后，攻击者需要将上传的文件从`.jpg`扩展名更改为`.php`，以便服务器能够执行其中的PHP代码。
4.  **命令执行：** 最后，攻击者可以通过访问上传的PHP文件，并传递`cmd`参数来执行任意系统命令。

**漏洞利用有效性评估：** 提供的POC代码看起来有效，因为它模拟了上述步骤，并使用了必要的HTTP请求头和参数。该脚本首先尝试登录，然后上传包含PHP Webshell的文件，重命名文件为.php，最后提供一个交互式shell界面。

**投毒风险分析：**  代码主体功能清晰，主要为利用漏洞上传webshell并执行命令。经过分析，该POC代码的投毒风险较低，约为1%。虽然任何代码都存在潜在风险，但未发现任何恶意代码，例如隐蔽的反向shell或其他后门。  需要注意的是，该脚本本身就是一种攻击工具，用于测试漏洞利用，应仅在授权环境下使用。

**总结：** CVE-2024-44871漏洞允许经过身份验证的攻击者通过上传和重命名文件来执行任意代码。提供的POC代码提供了一种有效的方法来利用此漏洞，但存在微小的投毒风险。漏洞利用的关键在于绕过文件类型检查和允许执行上传的PHP文件。

**项目地址:** [vances25/CVE-2024-44871](https://github.com/vances25/CVE-2024-44871)

**漏洞详情:** [CVE-2024-44871](https://nvd.nist.gov/vuln/detail/CVE-2024-44871)