## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行（取决于权限）

**影响版本:** <= 6.42

**利用条件:** 目标主机运行受影响的RouterOS版本，且Winbox服务启用并可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847 允许未经身份验证的远程攻击者读取任意文件，并允许经过身份验证的远程攻击者写入任意文件。漏洞位于 WinBox 界面中，由于目录遍历漏洞导致。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的利用是有效的。存在公开的利用代码和Metasploit模块，证明其可利用性。

**投毒风险：** 提供的代码中`MACServerDiscover.py` 脚本用于在局域网内发现Mikrotik设备，`MACServerExploit.py` 主要用于利用该漏洞，从中发现明显的恶意或后门代码的可能性较低，代码的功能逻辑基本符合漏洞利用的需要。`extract_user.py`未提供完整内容，无法判断投毒风险。

需要注意的是，使用任何漏洞利用代码都存在风险，包括代码的质量和可能存在的潜在问题。此处评估的投毒风险基于对提供的代码片段的分析，并不能保证绝对安全。因此，在使用前应进行充分的代码审查和安全测试。
`LICENSE`文件指明了代码的版权归属，并以MIT协议开源。

综合考虑，将投毒风险评估为10%。主要考虑隐藏恶意逻辑的细微可能性以及未完整提供的`extract_user.py`脚本。

**利用方式：**

1.  **信息收集：** 使用 `MACServerDiscover.py` 脚本发现局域网内的 Mikrotik 设备，获取其 MAC 地址。
2.  **漏洞利用：** 使用 `MACServerExploit.py` 脚本，利用 Winbox 协议中的目录遍历漏洞，通过构造恶意请求读取 `/flash/rw/store/user.dat` 文件，该文件包含用户凭据。
3.  **提取凭据：** 使用 `extract_user.py` (如果存在并可用)从 `user.dat` 文件中提取用户名和密码。

通过该漏洞，攻击者可以获取 Mikrotik 路由器的管理员权限，进而控制整个网络。

**项目地址:** [hacker30468/Mikrotik-router-hack](https://github.com/hacker30468/Mikrotik-router-hack)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)