## CVE-2020-17530-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 - 2.5.25

**利用条件:** 需要目标系统运行受影响版本的Apache Struts2，并且存在可利用的OGNL表达式注入点，通常在tag属性中

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2020-17530 (S2-061) 是一个Apache Struts2的远程代码执行漏洞。漏洞原因是由于Struts2框架在处理tag属性时，如果对用户输入未进行充分验证，可能导致OGNL表达式被强制执行。攻击者可以通过构造恶意的OGNL表达式，注入到tag属性中，从而执行任意代码。

**有效性评估：**

*   提供的README.md文件包含了一个Python代码片段，看似一个POC，用于检测是否存在S2-061漏洞。该POC通过构造一个包含OGNL表达式的URL，并尝试访问目标服务器。如果服务器返回包含"0.0.0.0"的内容，则认为存在漏洞。
*   提供的poc.go文件仅输出"xiangpichine?"，没有任何漏洞利用相关的代码。

因此，README.md中的Python代码片段更有可能是用于漏洞验证的，但缺乏必要的requests库导入，无法直接运行。poc.go文件基本无效。

**投毒风险评估：**

该代码仓库中，poc.go文件没有任何实际功能，属于无用代码。虽然README.md中提供的Python代码片段可以用于检测漏洞，但本身并不具备恶意功能。但是考虑到该仓库同时包含Go和Python代码，且Go代码命名为poc.go，存在混淆的可能性，诱导用户执行恶意代码。此外，网安人员在复现漏洞时,通常会复制粘贴漏洞利用代码,存在一定风险, 因此评估投毒风险为60%。

**漏洞利用方式：**

1.  **找到OGNL表达式注入点：** 在Struts2应用程序中，找到能够接受用户输入并将其作为tag属性值处理的地方。
2.  **构造恶意OGNL表达式：** 构造包含恶意代码的OGNL表达式。例如，可以使用`new java.lang.ProcessBuilder(new java.lang.String[]{'command', 'arg'}).start()`来执行系统命令。
3.  **发送Payload：** 将构造好的OGNL表达式作为参数发送给Struts2应用程序。
4.  **执行代码：** Struts2框架在处理tag属性时，会执行OGNL表达式，从而导致恶意代码被执行。

**总结：**
该漏洞的利用方式是通过构造恶意的OGNL表达式，并将其注入到Struts2应用程序的tag属性中，从而执行任意代码。虽然提供的POC代码可能存在一些问题，但总体上可以判断漏洞利用的可能性。投毒风险主要来自代码混淆的可能性。

**项目地址:** [phil-fly/CVE-2020-17530](https://github.com/phil-fly/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)