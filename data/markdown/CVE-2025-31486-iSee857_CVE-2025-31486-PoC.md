## CVE-2025-31486-Vite-服务器端文件读取

**漏洞编号:** CVE-2025-31486

**漏洞类型:** 服务器端文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.12, >=5.0.0 < 5.4.17, >=6.0.0 < 6.0.14, >=6.1.0 < 6.1.4, >=6.2.0 < 6.2.5

**利用条件:** Vite dev server必须暴露在网络上 (使用 --host 或 server.host 配置项)，用户需要点击恶意链接或以某种方式被诱导发送特制的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31486 允许攻击者绕过 Vite 的 server.fs.deny 限制，读取服务器上的任意文件。该漏洞利用的关键在于使用 `.svg` 或相对路径，并结合 `?.wasm?init` 或 `sec-fetch-dest: script` 头部。此绕过仅在文件小于 `build.assetsInlineLimit`（默认为 4kB）且使用 Vite 6.0+ 时有效。只有显式将 Vite dev server 暴露到网络的应用程序才会受到影响。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的 PoC 代码，此漏洞的 PoC 具有有效性。漏洞库中 CISA ADP 的标记也显示其存在PoC。

**投毒风险评估：**
PoC 代码本身主要功能是发送 HTTP 请求并检查响应，用于验证漏洞是否存在。其中 `parse_payload` 函数用于解析 payload，支持使用 `??` 分隔 payload 和成功指示符。`check_url` 函数构造请求并发送，`process_result` 函数处理结果，并打印到控制台。`export_to_excel` 函数用于将扫描结果导出到 Excel 文件，方便分析。整个脚本的目的是检测目标是否存在漏洞，没有发现明显的恶意代码或后门。但是，依然存在极低的风险，因为：

1.  **依赖风险：** 脚本使用了 requests 和 openpyxl 库，理论上这些依赖包可能存在被投毒的风险，但这不是 PoC 代码本身的问题。
2.  **结果处理：** 脚本会将请求和响应信息保存到 Excel 文件，这可能包含敏感信息，若此 Excel 文件被恶意方获取，可能造成信息泄露。
3.  **网络请求：** 该脚本发起网络请求，如果目标服务器本身存在安全问题，可能会被 PoC 触发。

基于以上分析，PoC 本身的投毒风险较低，但使用过程中仍然需要注意潜在的风险因素。 风险概率大概为 10%。

**利用方式：**

1.  **目标准备：** 找到运行在存在漏洞的 Vite 版本上，并且将开发服务器暴露在公网上的应用。
2.  **构造 Payload：** 构造包含 `.svg` 或相对路径以及 `?.wasm?init` 或 `sec-fetch-dest: script` 头部信息的恶意 URL。
3.  **发送请求：**  使用PoC脚本或手动发送构造好的 HTTP 请求到目标服务器。
4.  **验证结果：**  检查响应内容，确认是否成功读取了目标文件。如果成功读取，说明漏洞存在。

**项目地址:** [iSee857/CVE-2025-31486-PoC](https://github.com/iSee857/CVE-2025-31486-PoC)

**漏洞详情:** [CVE-2025-31486](https://nvd.nist.gov/vuln/detail/CVE-2025-31486)