## CVE-2019-5591-FortiOS-LDAP MITM

**漏洞编号:** CVE-2019-5591

**漏洞类型:** MITM

**影响应用:** FortiOS

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** <= 6.2.0

**利用条件:** 攻击者需要在与FortiOS设备相同的子网内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5591 是一个 FortiOS 中的默认配置漏洞，允许未经身份验证的攻击者在同一子网内通过模拟 LDAP 服务器来拦截敏感信息。漏洞存在于 FortiOS 6.2.0 及更早版本中。

**利用方式：**
攻击者通过运行 `ldap_honeypot.py` 脚本来模拟一个恶意的 LDAP 服务器。当 FortiOS 设备尝试连接到 LDAP 服务器进行身份验证时，由于 FortiOS 默认配置不检查服务器身份，攻击者可以拦截到 LDAP 绑定的用户名和密码。

**有效性：**
提供的 PoC 代码 `ldap_honeypot.py` 似乎有效。它实现了 LDAP 协议的基本功能，能够处理 BIND 和 SEARCH 请求，并记录捕获的凭据。`README.md` 描述了漏洞原理和影响的版本。

**投毒风险：**
PoC 代码中存在投毒风险的可能性较低，大约 10%。 主要风险点在于 `ldap_honeypot.py` 脚本可以修改为收集更多信息或执行恶意操作。例如，攻击者可以将捕获的凭据发送到远程服务器，或者在受害者主机上执行任意代码，但是从目前的代码来看，仅仅是捕获LDAP认证的账号密码信息, 风险极低。


**项目地址:** [ayewo/fortios-ldap-mitm-poc-CVE-2019-5591](https://github.com/ayewo/fortios-ldap-mitm-poc-CVE-2019-5591)

**漏洞详情:** [CVE-2019-5591](https://nvd.nist.gov/vuln/detail/CVE-2019-5591)