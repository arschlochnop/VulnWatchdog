## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要应用程序使用受影响版本的PHPMailer，并且允许控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 存在于 PHPMailer 5.2.18 之前的版本中。该漏洞源于 `mailSend` 函数在 `isMail` 传输方式中，允许远程攻击者通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性来传递额外的参数给 `mail` 命令，从而导致任意代码执行。

**有效性：**
根据漏洞信息、搜索结果和多个Exploit-DB 链接 (例如：40968, 40969, 40970, 40974, 40986, 41962, 41996, 42024, 42221)显示，该漏洞是真实存在的，并且存在可用的利用代码。

**投毒风险：**
提供的漏洞利用代码段是 GPL 许可，仅包含许可协议文本。其中没有发现任何恶意代码或者后门，因此投毒风险为0%。

**利用方式：**
攻击者通过控制 PHPMailer 的 `Sender` 属性，注入恶意的 shell 命令参数。由于 `mailSend` 函数在使用 `mail` 命令发送邮件时，没有正确过滤 `Sender` 属性中的特殊字符，导致注入的命令参数被执行。 例如，攻击者可以将 `Sender` 设置为 `" -X/tmp/evil.php -OQueueDirectory=/tmp` 来将PHP webshell写入/tmp/evil.php文件，如果网站可访问/tmp/evil.php 文件，webshell就可以使用了。利用的本质是参数注入。

**优先级排序依据:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息
搜索引擎结果中明确指出了该漏洞的存在以及远程代码执行的风险。漏洞利用代码验证了漏洞的存在以及参数注入的方式。


**项目地址:** [sealldeveloper/CVE-2016-10033-PoC](https://github.com/sealldeveloper/CVE-2016-10033-PoC)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)