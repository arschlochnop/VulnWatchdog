## CVE-2025-10351-SQL注入

**漏洞编号:** CVE-2025-10351

**漏洞类型:** SQL注入

**影响应用:** 未知

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 未知

**利用条件:** 需要目标服务器开启且存在SQL注入漏洞的URL，可能需要有效的PHPSESSID cookie

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该Python脚本尝试利用SQL注入漏洞。它首先尝试通过注入单引号来检测漏洞，然后使用基于时间的盲注来确认和利用漏洞。如果检测到重定向到登录页面，脚本会提示用户输入cookie。该脚本包含以下功能：

*   **基于错误的SQL注入检测：** 通过检测响应中是否存在MySQL错误消息（例如“You have an error in your SQL syntax”）或xpath语法错误来判断是否存在基于错误的SQL注入。
*   **基于时间的SQL注入检测：** 通过比较包含`sleep`函数的payload的响应时间和不包含`sleep`函数的payload的响应时间，来判断是否存在基于时间的SQL注入。`is_time_based_sqli`函数执行此操作。
*   **Cookie处理：** 如果初始请求重定向到登录页面，脚本会提示用户输入Cookie，并使用该Cookie重新检查漏洞。
*   **代理支持：** 脚本支持通过代理服务器发送请求。
*   **SSL验证控制：** 脚本允许禁用SSL证书验证。
*   **URL列表支持：** 脚本可以从文件中读取URL列表并检查每个URL是否存在漏洞。

**投毒风险分析：**

脚本本身的功能看起来是用于SQL注入检测和利用，但在`ask_for_cookies()`这里可能存在风险。如果脚本作者有意在`ask_for_cookies()`中添加恶意代码（例如，将cookie发送到恶意服务器），则存在投毒的风险。此外, 虽然脚本表面上是在利用SQL注入，但是也可能在请求头中加入隐藏的恶意载荷,不过可能性较低。

综合来看，虽然该脚本的功能相对明确，但仍存在一定的投毒风险，尤其是与用户交互部分(`ask_for_cookies()`)。因此，在使用前需要仔细审查代码。

**项目地址:** [ivansmc00/CVE-2025-10351](https://github.com/ivansmc00/CVE-2025-10351)

**漏洞详情:** [CVE-2025-10351](https://nvd.nist.gov/vuln/detail/CVE-2025-10351)