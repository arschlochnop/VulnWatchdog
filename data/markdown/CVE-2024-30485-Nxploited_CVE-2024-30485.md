## CVE-2024-30485 - WordPress Finale Lite 插件未授权插件安装/激活漏洞

**漏洞编号:** CVE-2024-30485

**漏洞类型:** 未授权访问/插件安装/插件激活

**影响应用:** WordPress Finale Lite

**危害等级:** 高危，可能导致网站被控制

**影响版本:** <= 2.18.0

**利用条件:** 需要目标WordPress站点安装了Finale Lite插件，且版本低于等于2.18.0，以及具有Subscriber权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是由于 WordPress Finale Lite 插件中存在未授权的插件安装和激活漏洞。攻击者可以通过已登录的用户，绕过权限验证，安装和激活恶意插件，从而控制整个WordPress网站。\n\n**有效性分析：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞利用代码首先检查目标站点是否易受攻击，然后尝试使用提供的用户名和密码登录到WordPress站点。登录成功后，它会提取一个nonce值，用于绕过某些安全检查。最后，它使用nonce安装并激活指定的插件。搜索引擎结果也指向存在可利用的POC。
\n**投毒风险分析：**
提供的POC代码本身的主要功能是利用漏洞安装和激活插件，但其中存在一些小的投毒风险。\n1. **默认插件:** 脚本默认尝试安装`hello-dolly`插件。虽然`hello-dolly`本身不是恶意插件，但攻击者可以修改脚本，使其安装和激活任意其他插件，这构成了一种潜在的投毒方式。安装恶意插件会导致网站被完全控制。\n2. **依赖关系：**POC需要requests和beautifulsoup4库，如果用户通过非官方渠道安装这些库，可能会引入包含恶意代码的版本。\n3. **更新风险：** 虽然当前的脚本没有明显的恶意行为，但攻击者可能会发布修改后的版本，其中包含后门或恶意功能。使用未经审核的第三方POC具有一定的风险。\n因此，综合考虑，认为该POC存在较低的投毒风险，约为5%。主要的风险在于使用者可能被诱导安装恶意插件。
\n**利用方式：**
1.  **版本检测：** 首先检查目标网站上安装的 Finale Lite 插件的版本。
2.  **身份验证：** 使用提供的用户名和密码尝试登录到WordPress站点。
3.  **Nonce 获取：** 登录后，从XL Payments设置页面提取 nonce 值。此 nonce 值用于绕过安装和激活插件的身份验证检查。
4.  **插件安装：** 使用提取的 nonce 值安装指定的插件。
5.  **插件激活：** 安装插件后，使用提取的 nonce 值激活该插件。
\n**缓解措施：**
*   将 Finale Lite 插件更新到 2.18.1 或更高版本。
*   限制用户注册，并对用户权限进行严格管理。
*   监控插件安装和激活活动，以检测未经授权的更改。

**项目地址:** [Nxploited/CVE-2024-30485](https://github.com/Nxploited/CVE-2024-30485)

**漏洞详情:** [CVE-2024-30485](https://nvd.nist.gov/vuln/detail/CVE-2024-30485)