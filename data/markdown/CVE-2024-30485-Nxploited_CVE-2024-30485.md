## CVE-2024-30485 - WordPress Finale Lite插件任意插件安装/激活漏洞

**漏洞编号:** CVE-2024-30485

**漏洞类型:** 权限绕过/任意插件安装激活

**影响应用:** WordPress Finale Lite

**危害等级:** 高危，可能导致网站被完全控制

**影响版本:** <= 2.18.0

**利用条件:** 需要WordPress账号密码 (Subscriber+)

**POC 可用性:** 是

**投毒风险:** 90%

## 详情

CVE-2024-30485 是 WordPress Finale Lite 插件中存在的权限绕过漏洞。该漏洞允许拥有 Subscriber 或更高权限的恶意用户在未经授权的情况下安装和激活任意插件。

**利用方式：**

1.  **漏洞验证：** 脚本首先检查目标网站是否运行着易受攻击版本的 Finale Lite 插件。它通过访问 `readme.txt` 文件并检查 "Stable tag" 来确定插件版本。
2.  **登录：** 使用提供的用户名和密码登录 WordPress 后台。
3.  **获取 Nonce：** 成功登录后，脚本从 `wp-admin/admin.php?page=xl-payments` 页面提取一个 nonce 值。此 nonce 用于绕过某些安全检查。
4.  **安装插件：** 脚本使用提取的 nonce 和插件 slug (默认为hello-dolly)通过 `admin-ajax.php` 端点安装指定插件。如果插件已经安装，则跳过此步骤。
5.  **激活插件：** 脚本再次使用 nonce 通过 `admin-ajax.php` 端点激活已安装的插件。

**有效性：**

提供的PoC代码看起来是有效的。它包含漏洞利用所需的必要步骤，例如版本检查、登录、nonce提取以及插件安装/激活。

**投毒风险：**

PoC代码存在很高的投毒风险（90%）。

*   **恶意插件：** 该漏洞允许攻击者安装任何插件，这意味着他们可以安装包含后门、恶意软件或其他有害代码的插件。
*   **依赖性问题：**  PoC可能会添加不兼容或者有漏洞的插件，导致目标系统出现异常。
*   **供应链攻击：** 通过该漏洞，攻击者可以上传一个恶意版本的常用插件，替换服务器上的正常插件，实现供应链攻击。
*   **后门：** 恶意插件可以被设计为创建一个持久性的后门，允许攻击者在以后重新访问系统，即使漏洞已被修复。

由于存在上述潜在的风险，使用此PoC代码时需要谨慎，并仅在授权的渗透测试环境中使用。

**项目地址:** [Nxploited/CVE-2024-30485](https://github.com/Nxploited/CVE-2024-30485)

**漏洞详情:** [CVE-2024-30485](https://nvd.nist.gov/vuln/detail/CVE-2024-30485)