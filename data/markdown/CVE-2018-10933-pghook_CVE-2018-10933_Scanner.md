## CVE-2018-10933-libssh身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问，完全控制受影响的系统

**影响版本:** 0.6.0及以上，0.7.6之前和0.8.4之前的版本

**利用条件:** 目标服务器运行存在漏洞的libssh版本，且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-10933是libssh库中的一个身份验证绕过漏洞。通过向服务器发送SSH2_MSG_USERAUTH_SUCCESS消息，恶意客户端可以在未经身份验证的情况下创建通道，从而绕过身份验证并获得未经授权的访问权限。

**漏洞利用有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的影响是严重的，利用起来相对简单。提供的POC代码是一个扫描器，用于检测目标主机是否运行着易受攻击的libssh版本。该扫描器通过连接到目标SSH端口(默认22)，发送一个 \0 字符，并检查返回的banner是否包含字符串 '0.6.0'。如果banner包含该字符串，则会将目标标记为易受攻击。

**投毒风险分析：**

对提供的POC代码进行分析后，发现该代码主要功能是扫描存在漏洞的libssh版本，并尝试进行地理位置定位（如果指定）。代码中没有明显的恶意代码或后门。以下是风险点和评估:

*   **依赖项：** requirements.txt文件列出了脚本的依赖项，但只声明了库名，没有指定版本，这可能导致安装了存在漏洞或恶意版本的库。但是，提供的依赖项都是python自带的，或常用的库,风险相对较低。
*   **Geolocation功能：**Geolocation功能使用http://ipinfo.io/ API。虽然这是一个常用的IP地址信息服务，但依赖于第三方API始终存在一定的风险。ipinfo.io本身若被攻破，可能造成投毒。
*   **版本检测误报风险:** 该扫描器仅检查banner中是否存在 '0.6.0' 字符串。这可能会导致误报，因为某些服务器可能修改了banner，或者即使不是0.6.0, 但受到了该漏洞影响。
*   **目标列表：**提供的target_list.txt包含了一些IP地址，扫描这些地址可能会引起一些安全问题，比如被目标系统识别为恶意扫描。
*   **其他文件：**README.md文件包含指向github的图片，但该github的图片可能包含恶意链接，或者被篡改。

综合评估，此仓库中存在作者隐藏的投毒代码的可能性较低，约为10%。 主要风险在于依赖项的安全性，geolocation服务本身的安全风险，以及扫描行为可能引起的警告。

**漏洞利用方式：**

1.  **扫描易受攻击的服务器：** 使用提供的扫描器代码识别运行易受攻击的libssh版本的服务器。
2.  **建立SSH连接：** 连接到易受攻击的SSH服务器。
3.  **发送SSH2_MSG_USERAUTH_SUCCESS消息：** 在身份验证之前，发送SSH2_MSG_USERAUTH_SUCCESS消息。
4.  **创建通道：** 成功绕过身份验证后，创建通道并执行任意命令，从而完全控制受影响的系统。

**项目地址:** [pghook/CVE-2018-10933_Scanner](https://github.com/pghook/CVE-2018-10933_Scanner)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)