## CVE-2024-4157 - Contact Form Plugin by Fluent Forms - PHP Object Injection

**漏洞编号:** CVE-2024-4157

**漏洞类型:** PHP Object Injection

**影响应用:** Contact Form Plugin by Fluent Forms for WordPress

**危害等级:** 高危，可能导致任意文件删除、敏感数据泄露或远程代码执行

**影响版本:** <= 5.1.15

**利用条件:** 需要Contributor或以上权限，或者与CVE-2024-2771联动。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4157是WordPress Contact Form Plugin by Fluent Forms插件中的一个PHP对象注入漏洞。攻击者可以通过在extractDynamicValues函数中反序列化不可信的输入来注入PHP对象。如果目标系统上安装了其他的插件或主题，并且存在POP链，则可能允许攻击者删除任意文件、检索敏感数据或执行代码。

**有效性:**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且影响版本<=5.1.15。POC的存在进一步证实了其有效性。

**投毒风险:**
提供的漏洞利用代码(exploit.py)是针对Havoc C2框架的SSRF漏洞(CVE-2024-41570)和RCE漏洞的利用。虽然文件名包含CVE-2024-4157，但实际利用的漏洞是Havoc C2框架的漏洞。代码主要功能是模拟agent注册和checkin与Havoc C2服务端进行交互，没有发现明显的投毒代码。

分析了 exploit.py 和 README.md 的内容，该代码的目的是利用 Havoc C2 框架中的漏洞，实现 SSRF 攻击和 RCE。代码主要用于渗透测试和安全研究，用于获取目标系统的反向 shell。代码逻辑较为清晰，没有发现任何明显的恶意或隐藏的后门代码。因此，可以认为该仓库中存在作者隐藏的投毒代码的风险非常低。

**利用方式:**
1.  **前提条件:** 攻击者需要拥有WordPress Contributor或以上权限。或者通过与其他漏洞（如CVE-2024-2771）进行联动来绕过权限限制。
2.  **漏洞点:** `extractDynamicValues`函数存在反序列化漏洞。
3.  **攻击步骤:** 攻击者构造恶意的序列化PHP对象，将其作为输入传递给`extractDynamicValues`函数。
4.  **利用:** 如果目标系统存在可用的POP链，则在反序列化恶意对象时会触发POP链，从而实现任意代码执行等恶意操作。

总结：Fluent Forms插件的CVE-2024-4157本身是一个PHP对象注入漏洞，需要配合POP链才能实现RCE。提供的exploit.py文件并非直接利用该漏洞，而是利用了Havoc C2框架的其他漏洞（SSRF和RCE），用于获取C2服务器的shell，因此该代码的重点不在于攻击Fluent Forms插件本身。

**项目地址:** [Ch4os1/CVE-2024-4157-SSRF-RCE](https://github.com/Ch4os1/CVE-2024-4157-SSRF-RCE)

**漏洞详情:** [CVE-2024-4157](https://nvd.nist.gov/vuln/detail/CVE-2024-4157)