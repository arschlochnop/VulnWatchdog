## CVE-2019-9978 - Social Warfare WordPress Plugin RCE/XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** RCE/Stored XSS

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和恶意脚本注入

**影响版本:** < 3.5.3

**利用条件:** 需要安装存在漏洞的Social Warfare插件，并且目标WordPress站点开启了`swp_debug`参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9978是Social Warfare WordPress插件3.5.3之前的版本中存在的一个漏洞，它允许未经身份验证的攻击者通过`wp-admin/admin-post.php?swp_debug=load_options&swp_url=`参数注入恶意代码。通过设置`swp_debug=load_options`并指定一个包含恶意PHP代码的远程URL作为`swp_url`的值，攻击者可以利用`file_get_contents`函数读取该远程文件，并使用`eval`函数执行其中的代码，从而实现远程代码执行。此外，该漏洞也包含存储型XSS，恶意代码存储在数据库中，当管理员访问包含该代码的页面时，XSS payload会被触发。补丁移除了`SWP_Database_Migration.php`文件中与`load_options`相关的代码。

**有效性：**
提供的PoC代码是有效的。通过发送带有`swp_debug=load_options`和`swp_url`参数的请求，可以触发远程代码执行。

**投毒风险：**
此仓库存在一定的投毒风险，可能性约为10%。
*   虽然PoC本身是为了演示漏洞利用，但如果用户不小心使用了修改过的exploit.php，则存在潜在的风险。
*   README.md中提供的PoC利用链接到外部`exploit.php`文件，如果该文件被恶意修改，则会存在投毒行为。

**利用方式：**
1.  攻击者构造包含恶意PHP代码的远程文件，例如`exploit.php`。
2.  攻击者向目标WordPress站点的`wp-admin/admin-post.php`发送包含`swp_debug=load_options`和`swp_url`参数的请求，其中`swp_url`参数指向包含恶意PHP代码的远程文件。
3.  目标站点上的Social Warfare插件会使用`file_get_contents`函数读取远程文件，并使用`eval`函数执行其中的代码。
4.  攻击者从而实现远程代码执行，控制目标WordPress站点。

**项目地址:** [mpgn/CVE-2019-9978](https://github.com/mpgn/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)