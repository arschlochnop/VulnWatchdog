## CVE-2024-48990-needrestart-特权提升

**漏洞编号:** CVE-2024-48990

**漏洞类型:** 特权提升

**影响应用:** needrestart

**危害等级:** 高危，允许本地用户以root权限执行任意代码

**影响版本:** < 3.8

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-48990 漏洞存在于 needrestart 3.8 之前的版本。该漏洞允许本地攻击者通过操纵 `PYTHONPATH` 环境变量来欺骗 `needrestart` 运行 Python 解释器，从而以 root 权限执行任意代码。漏洞利用方式：攻击者创建一个包含恶意 Python 模块的目录，然后设置 `PYTHONPATH` 环境变量指向该目录，当 `needrestart` 扫描解释器时，会加载该恶意模块，从而执行攻击者提供的代码。根据提供的漏洞利用代码，该POC声称是针对此漏洞的完整利用，可获得root权限的shell。虽然代码仓库中仅包含一个README.md文件，看起来风险不大，但是，不能完全排除攻击者在其他地方（例如，编译好的二进制文件）中隐藏恶意代码的可能，因此判断存在较低的投毒风险。

**项目地址:** [mladicstefan/CVE-2024-48990](https://github.com/mladicstefan/CVE-2024-48990)

**漏洞详情:** [CVE-2024-48990](https://nvd.nist.gov/vuln/detail/CVE-2024-48990)