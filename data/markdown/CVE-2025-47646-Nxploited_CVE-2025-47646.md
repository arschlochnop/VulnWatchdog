## CVE-2025-47646 - PSW Front-end Login & Registration 权限绕过

**漏洞编号:** CVE-2025-47646

**漏洞类型:** 权限绕过

**影响应用:** PSW Front-end Login & Registration WordPress插件

**危害等级:** 高危，可能导致账户被恶意注册甚至管理员权限被获取

**影响版本:** <= 1.12

**利用条件:** WordPress站点的default_role被错误配置为管理员或其他高权限角色

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于PSW Front-end Login & Registration WordPress插件的注册功能中。攻击者可以通过未授权的AJAX请求 `/wp-admin/admin-ajax.php`，利用`register_user_front_end` action注册用户。如果WordPress的`default_role`设置不当（例如设置为`administrator`），则新注册的用户将直接拥有管理员权限，造成严重的安全风险。

**有效性：**

根据提供的PoC代码，该漏洞利用方式是有效的。攻击者构造特定的POST请求发送到`/wp-admin/admin-ajax.php`，绕过身份验证并成功注册用户。

**投毒风险：**

PoC代码本身看起来比较直接，旨在利用漏洞。其中涉及到的nonce字段 `psw_form` 需要从前端获取，增加了一定的攻击难度，但是不属于投毒行为。整体分析，投毒风险极低，约为1%。主要风险在于利用该漏洞本身进行恶意注册。

**利用方式：**

1.  **发现注册表单：** 找到包含`[psw_registration]`短代码的页面，这将渲染一个包含nonce的注册表单。
2.  **获取Nonce值：** 从注册表单的HTML源码中提取`psw_form` (nonce)的值。
3.  **构造恶意请求：** 使用Burp Suite或curl等工具构造POST请求，将`action`设置为`register_user_front_end`，并包含必要的用户注册信息（如用户名、密码、邮箱）以及之前获取的`psw_form`值。
4.  **发送请求：** 将构造好的请求发送到`/wp-admin/admin-ajax.php`。
5.  **权限提升：** 如果WordPress的`default_role`设置为`administrator`，则注册的新用户将自动获得管理员权限。

**缓解措施：**

*   限制未经身份验证的AJAX注册。
*   在服务器端强制执行角色分配。
*   监控并将`default_role`锁定为安全值（例如`subscriber`）。
*   如果无法更新插件，请应用虚拟补丁。

**项目地址:** [Nxploited/CVE-2025-47646](https://github.com/Nxploited/CVE-2025-47646)

**漏洞详情:** [CVE-2025-47646](https://nvd.nist.gov/vuln/detail/CVE-2025-47646)