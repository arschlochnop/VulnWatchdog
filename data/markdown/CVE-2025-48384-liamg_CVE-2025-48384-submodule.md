## CVE-2025-48384-Git Config 注入 RCE

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码注入/命令执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0 and < 2.44.4, >= 2.45.0-rc0 and < 2.45.4, >= 2.46.0-rc0 and < 2.46.4, >= 2.47.0-rc0 and < 2.47.3, >= 2.48.0-rc0 and < 2.48.2, >= 2.49.0-rc0 and < 2.49.1, >= 2.50.0-rc0 and < 2.50.1

**利用条件:** 需要用户进行`git clone --recursive`操作

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞是 Git 中的一个代码注入漏洞，源于 Git 在处理 config 文件时，没有正确处理carriage return ()字符。攻击者可以通过在 submodule 的路径中注入 \r 字符，使得 submodule 被检出到错误的位置。如果精心构造一个 symlink 链接到 submodule 钩子目录，并使 submodule 包含一个可执行的 post-checkout 钩子，那么这个钩子脚本就会在检出后被执行，从而实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞已经公开，并且存在可利用的POC代码。从github搜索结果[webpage 6 begin]和[webpage 7 begin]可以知道，已经有开发者提供了复现代码。提供的POC代码包含两个文件：`README.md` 和 `post-checkout`。
  *   `README.md` 文件指向了GitHub的POC地址，说明这是一个漏洞验证示例。
  *   `post-checkout` 文件包含 `echo "Uh-oh, this is an RCE!"`，这是一个简单的命令执行示例，用于验证漏洞是否成功利用。
因此，提供的POC代码是有效的，可以用来验证此漏洞。

**投毒风险分析：**

提供的 POC 代码非常简单，只包含一个输出字符串的命令。**没有发现任何隐藏的、恶意的代码**，因此投毒风险较低。可以认为投毒风险为0%。虽然这是一个 RCE 漏洞的验证代码，在真实场景下，`post-checkout` 脚本会包含更复杂的恶意代码，但这不属于仓库投毒的范畴，POC 本身是为了验证漏洞的存在，而不是进行恶意攻击。

**利用方式：**

1.  **构造恶意的Git仓库：** 攻击者需要创建一个包含恶意配置的Git仓库，其中 submodule 的路径包含 \r 字符。
2.  **创建Symlink：** 在仓库中创建一个符号链接，将带有 \r 字符的路径链接到 `.git/modules/<submodule>/hooks` 目录。
3.  **添加恶意钩子：** 在 submodule 中创建一个可执行的 `post-checkout` 钩子脚本，这个脚本包含攻击者想要执行的任意代码。
4.  **诱导用户克隆仓库：** 攻击者需要诱导受害者执行 `git clone --recursive <malicious_repo>` 命令。
5.  **触发漏洞：** 当用户执行 `git clone --recursive` 命令时，Git 会读取恶意的配置，将 submodule 检出到错误的位置，并且由于 symlink 的存在，触发执行 `post-checkout` 钩子脚本，从而执行攻击者的代码。


**项目地址:** [liamg/CVE-2025-48384-submodule](https://github.com/liamg/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)