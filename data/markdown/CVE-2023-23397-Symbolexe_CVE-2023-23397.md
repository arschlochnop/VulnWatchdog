## CVE-2023-23397 Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM relay攻击，获取用户身份

**影响版本:** 受影响版本包括Microsoft Outlook 2013 Service Pack 1, Microsoft Outlook 2016, Microsoft Office 2019, Microsoft Office LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本号请参考漏洞库信息。

**利用条件:** 攻击者需要向受害者发送特制的邮件，受害者无需交互，只需预览或打开邮件即可触发。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个存在于 Microsoft Outlook 中的权限提升漏洞。攻击者可以构造特殊的邮件，利用扩展 MAPI (Messaging Application Programming Interface)属性，特别是 `PidLidReminderFileParameter` 属性，指向一个攻击者控制的 UNC 路径。当 Outlook 处理这封邮件时（无需用户点击任何链接，预览或打开邮件即可），会尝试连接到该 UNC 路径，触发 NTLM 认证过程，从而将用户的 NTLM hash 发送到攻击者控制的服务器。攻击者可以通过 NTLM relay攻击冒充用户身份。

**漏洞利用方式：**
1.  攻击者构造包含恶意 `PidLidReminderFileParameter` 属性的邮件，该属性指向攻击者控制的 UNC 路径。
2.  攻击者向受害者发送邮件。
3.  受害者使用 Outlook 预览或打开邮件。
4.  Outlook 尝试连接到 UNC 路径，触发 NTLM 认证。
5.  攻击者捕获 NTLM hash 并利用它进行身份验证。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞已被广泛利用，因此可以判断POC代码是有效的。

**投毒风险：**
提供的POC代码仅包含LICENSE和README.md文件。README.md描述了漏洞原理和利用方法，没有发现明显的恶意代码。但是，实际的漏洞利用工具可能包含额外的功能（例如，自动化的 NTLM relay 攻击等），这些功能可能被滥用于恶意目的。因此，从仓库本身来看，投毒的概率较低，但使用未经审核的第三方工具仍然存在风险。所以投毒风险为10%。

**漏洞库信息摘要：**
*   漏洞类型：权限提升
*   CVSS 评分：9.8 (严重)
*   受影响产品：Microsoft Outlook
*   修复方案：安装 Microsoft 提供的安全更新

**搜索引擎结果摘要：**
*   CVE-2023-23397 已经被 CISA 列入已知被利用漏洞目录。
*   该漏洞允许攻击者窃取 Net-NTLM hash。
*   Microsoft 提供了检测脚本。
*   有针对该漏洞的攻击样本分析报告。

**项目地址:** [Symbolexe/CVE-2023-23397](https://github.com/Symbolexe/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)