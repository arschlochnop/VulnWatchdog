## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，允许从应用程序到Linux内核的权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络暴露应用程序中的单独漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是Android Binder中binder.c文件中的一个use-after-free漏洞，允许恶意应用程序提升权限到Linux内核级别。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的、被广泛讨论的漏洞，并且有在野利用的报告。提供的PoC代码尝试利用`BINDER_THREAD_EXIT` ioctl命令来触发漏洞。代码中包含的内核调试信息表明作者正在尝试理解和复现漏洞，并已经确认在特定内核版本(例如，S3Neo+ LineageOS Kernel 3.4.0)上存在潜在的可利用性。

**投毒风险：**
PoC代码主要是为了演示和调试漏洞，用于触发和分析 use-after-free 的内核状态。代码包含对binder.c和eventpoll.c的修改以进行调试输出，例如打印链表信息，用于分析内核行为。 虽然此 PoC 本身看起来没有直接的投毒代码，但是任何利用内核漏洞的代码都可能被滥用。 考虑到代码中调试信息和尝试理解漏洞的行为，判断作者在POC验证和调试，存在投毒风险较低，大约为10%。

**利用方式：**
1.  **触发漏洞：** PoC代码首先打开`/dev/binder`设备，然后调用`BINDER_THREAD_EXIT` ioctl。这个ioctl命令用于释放与当前线程关联的binder_thread结构。
2.  **Use-After-Free：** 在binder_thread结构被释放后，如果内核中仍然存在对该结构的引用，并且尝试访问该结构的成员，就会触发use-after-free漏洞。具体触发位置通常在与binder线程相关的wait queue操作中。
3.  **权限提升：** 成功利用use-after-free漏洞后，攻击者可以通过精心构造的内核内存布局，控制被释放的内存区域，并将其用于执行恶意代码，从而获得内核权限。
4.  **攻击前提：**  利用此漏洞需要首先在设备上安装一个恶意的应用程序。此外，还可以结合网络侧的漏洞一起利用，通过网络攻击触发漏洞。

**总结：**
CVE-2019-2215是一个高危的Android内核漏洞，PoC代码展示了漏洞触发的基本原理。虽然提供的代码更偏向调试和分析，但是考虑到该漏洞的性质和在野利用的历史，该漏洞的利用对Android设备构成严重威胁。

**项目地址:** [ATorNinja/CVE-2019-2215](https://github.com/ATorNinja/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)