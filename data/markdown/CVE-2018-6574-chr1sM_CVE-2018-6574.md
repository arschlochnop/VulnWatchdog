## CVE-2018-6574

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程代码执行

**影响应用:** Go

**危害等级:** 高危，允许远程命令执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 使用受影响的Go版本，且执行`go get`命令获取恶意代码仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574漏洞允许攻击者在`go get`命令执行过程中进行远程命令执行。漏洞原理是由于受影响的Go版本未正确过滤`-fplugin`和`-plugin`参数，攻击者可以构造包含恶意插件的Go项目，当用户使用`go get`获取并构建该项目时，恶意插件会被执行，从而实现远程命令执行。

**有效性评估：**
提供的PoC代码由两部分组成：`attack.c`和`golan.go`。`attack.c`包含一个`malicious()`函数，该函数使用`__attribute__((constructor))`修饰，表明该函数会在程序加载时自动执行。该函数的功能是执行`/usr/local/bin/score 3b9e2681-04f3-4771-b576-05baa2a7523f`命令。`golan.go` 是一个简单的 Go 程序，它调用 C 代码。通过组合这两个文件，攻击者可以创建一个恶意的 Go 包，当用户使用易受攻击的 `go get` 版本获取该包时，`attack.c` 中的恶意代码将被编译并执行，从而导致命令执行。

**投毒风险评估：**
提供的代码片段中，`attack.c` 执行了一个特定的命令`/usr/local/bin/score 3b9e2681-04f3-4771-b576-05baa2a7523f`，可以判定为漏洞验证代码，目的是为了验证漏洞是否存在。此命令本身可能与漏洞作者相关，但它不属于隐藏的、未公开的恶意行为，可以认为不存在投毒。因此投毒风险为0%。

**利用方式：**
1.  攻击者创建一个恶意的Go项目，其中包含`attack.c`和`golan.go`文件。
2.  `attack.c`包含恶意代码，例如执行任意命令。
3.  在Go项目的构建过程中，通过`-fplugin`或`-plugin`参数指定`attack.c`编译生成的插件。
4.  攻击者将恶意Go项目托管在公开的代码仓库中。
5.  诱导用户使用受影响的Go版本执行`go get`命令获取该恶意Go项目。
6.  当`go get`构建项目时，恶意插件会被加载并执行，从而实现远程命令执行。

**项目地址:** [chr1sM/CVE-2018-6574](https://github.com/chr1sM/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)