## CVE-2025-43864-react-router-缓存投毒DoS

**漏洞编号:** CVE-2025-43864

**漏洞类型:** 缓存投毒导致的拒绝服务(DoS)

**影响应用:** React Router

**危害等级:** 高危，可能导致应用不可用

**影响版本:** >= 7.2.0, < 7.5.2

**利用条件:** 应用使用SSR，并且配置了缓存系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-43864 存在于 React Router 7.2.0 到 7.5.1 版本中。该漏洞允许攻击者通过发送包含特定 header 的请求，强制应用程序进入 SPA 模式。如果应用程序原本使用 SSR (Server-Side Rendering)，强制切换到 SPA 模式会导致页面渲染错误。如果应用使用了缓存系统，这个包含错误的响应会被缓存，导致缓存投毒，最终导致用户无法正常访问应用。

**漏洞利用方式：**

1.  攻击者向目标网站发送恶意请求，该请求包含特定的header，目的是强制react-router进入SPA模式。
2.  如果目标网站使用SSR，并且存在缓存，服务器会因为模式切换产生异常页面，并且缓存服务器会缓存该异常页面。
3.  当正常用户访问时，会命中缓存，获取到错误的页面，导致拒绝服务。

**POC有效性：**

根据漏洞信息和搜索结果，该漏洞的POC是有效的。CVE库和搜索引擎结果都确认了该漏洞的存在和影响。

**投毒风险分析：**

提供的 Dockerfile 和 `package-lock.json` 文件看起来是一个标准的 React Router 应用配置。虽然不能完全排除投毒的可能性，但从代码内容来看，没有明显的恶意代码存在。`package-lock.json` 中列出的依赖项都是常见的 React 和前端相关的库。代码仓库中，存在被植入后门的风险,初步判断风险为10%，主要是因为代码量较大，需要人工review所有代码才能确认，目前只能基于表面特征进行判断。


**项目地址:** [pouriam23/DoS-via-cache-poisoning-by-forcing-SPA-mode-CVE-2025-43864-](https://github.com/pouriam23/DoS-via-cache-poisoning-by-forcing-SPA-mode-CVE-2025-43864-)

**漏洞详情:** [CVE-2025-43864](https://nvd.nist.gov/vuln/detail/CVE-2025-43864)