## CVE-2023-38831 - WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用 WinRAR 打开特制的 ZIP 压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过特制的 ZIP 压缩包在受害者系统上执行任意代码。漏洞利用方式是创建一个 ZIP 压缩包，其中包含一个良性文件（例如 .jpg 或 .pdf）以及一个同名的文件夹。该文件夹包含恶意的可执行文件（例如 .cmd 或 .exe）。当用户尝试打开良性文件时，WinRAR 会错误地执行文件夹中的恶意代码。

**有效性：** 根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码分析，该漏洞确实存在并且已经被野外利用。提供的代码描述了一个利用工具 "DR. GANDALF"，它允许用户创建包含此漏洞的 ZIP 文件，表明POC的有效性。

**投毒风险：** 提供的 README.md 文件主要描述了漏洞原理和利用工具的使用方法。但是，由于此工具允许用户自定义注入的代码和二进制文件，因此存在投毒风险。如果用户下载了包含恶意注入代码的ZIP文件，那么这个工具本身可能被利用来传播恶意软件。评估投毒风险为 10%，因为该描述文件本身不包含可以直接执行的后门代码，但生成的ZIP文件可以包含。

**利用方式：**
1.  攻击者创建一个包含恶意 ZIP 压缩包。
2.  ZIP 压缩包中包含一个良性文件（例如，`image.jpg`）和一个同名的文件夹（例如，`image.jpg`）。
3.  `image.jpg` 文件夹包含恶意的可执行文件（例如，`evil.cmd`）。
4.  攻击者诱骗受害者使用存在漏洞的 WinRAR 版本打开该 ZIP 压缩包并尝试访问良性文件 `image.jpg`。
5.  WinRAR 在处理该 ZIP 文件时，会错误地执行 `image.jpg` 文件夹中的恶意代码 `evil.cmd`，从而导致远程代码执行。

**项目地址:** [elefantesagradodeluzinfinita/cve-2023-38831](https://github.com/elefantesagradodeluzinfinita/cve-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)