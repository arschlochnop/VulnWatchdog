## CVE-2025-24203-macOS/iPadOS 文件系统修改漏洞

**漏洞编号:** CVE-2025-24203

**漏洞类型:** 文件系统修改

**影响应用:** macOS, iPadOS

**危害等级:** 中危，可能导致本地权限提升和文件系统破坏

**影响版本:** < macOS Ventura 13.7.5, iPadOS 17.7.6, macOS Sequoia 15.4, macOS Sonoma 14.7.5

**利用条件:** 需要本地应用程序执行权限，以及用户交互。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24203 漏洞允许应用程序修改受保护的文件系统部分。该漏洞存在于 macOS 和 iPadOS 中，由于缺乏足够的权限检查导致。攻击者可以利用该漏洞修改只读文件。

**漏洞利用有效性：**

根据漏洞库信息和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息指出，通过改进的检查解决了此问题，说明该漏洞确实存在并已被修复。提供的C代码 `VM_BEHAVIOR_ZERO_WIRED_PAGES.c` 是一个针对该漏洞的POC，它详细描述了如何利用 `VM_BEHAVIOR_ZERO_WIRED_PAGES` 机制绕过只读保护，从而修改文件内容。关键步骤包括：打开只读文件，使用 mmap 映射文件，设置 `VM_BEHAVIOR_ZERO_WIRED_PAGES` 标志，锁定页面到物理内存，最后通过 vm_deallocate 解除映射，触发内核清零页面。

**投毒风险分析：**

查看漏洞利用代码，特别是`VM_BEHAVIOR_ZERO_WIRED_PAGES.c`，初步评估发现有潜在投毒风险。代码中包含作者的联系方式 "pxx917144686"，这可能暗示作者有意引导使用者。尽管代码本身的功能是利用漏洞修改只读文件，但是没有发现直接的后门代码，因此，投毒风险评估为较低，大约10%。潜在的投毒方式可能包括：

*   **依赖项陷阱：**  虽然`Podfile` 文件中注释掉了 `DeviceKit` 和 `Combine` 依赖项，但未来可能在这些依赖项中引入恶意代码。
*   **配置信息泄露：**`ExportOptions.plist` 文件中需要用户填写 `teamID` 和 `provisioningProfile`，如果使用者不了解代码原理，可能会错误配置导致信息泄露或者应用签名失败。
*   **隐藏的编译选项：** 通过修改 Makefile 或者其他编译配置，在编译过程中植入恶意代码（未提供 Makefile）。
*  **代码逻辑误导:** 代码的注释或说明可能存在误导，引导使用者执行错误的操作，从而造成安全风险。
*  **联系信息钓鱼:** 作者的联系方式可能被用于钓鱼攻击，诱导使用者泄露敏感信息。

综合以上，尽管POC代码主要用于漏洞验证，但存在潜在的风险，需要谨慎使用。

**漏洞利用方式：**

1.  **准备：** 创建一个只读文件，并确保当前用户拥有读取权限。
2.  **编译：** 使用 `clang` 编译 `VM_BEHAVIOR_ZERO_WIRED_PAGES.c` 文件。
3.  **执行：** 运行编译后的可执行文件，并传入只读文件的路径作为参数。
4.  **触发：** 程序会利用 `VM_BEHAVIOR_ZERO_WIRED_PAGES` 机制，修改只读文件中的部分内容。

**修复方案：**

升级到 macOS Ventura 13.7.5, iPadOS 17.7.6, macOS Sequoia 15.4, macOS Sonoma 14.7.5 或更高版本。

**项目地址:** [pxx917144686/iDevice_ZH](https://github.com/pxx917144686/iDevice_ZH)

**漏洞详情:** [CVE-2025-24203](https://nvd.nist.gov/vuln/detail/CVE-2025-24203)