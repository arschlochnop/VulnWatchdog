## CVE-2023-4220-Chamilo-Unrestricted File Upload

**漏洞编号:** CVE-2023-4220

**漏洞类型:** Unrestricted File Upload

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致远程代码执行和存储型XSS

**影响版本:** <= 1.11.24

**利用条件:** 无需身份验证，目标Chamilo LMS实例允许未授权访问/main/inc/lib/javascript/bigupload/inc/bigUpload.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中存在的一个未授权文件上传漏洞。该漏洞位于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件的 big file upload 功能中。攻击者可以通过上传包含恶意代码（例如 Web Shell）的文件，实现远程代码执行 (RCE) 和存储型跨站脚本攻击 (XSS)。

**有效性：** 提供的 PoC 代码显示了攻击者如何利用此漏洞上传恶意文件。`CVE-2023-4220.py` 脚本通过 `requests` 库向目标 URL 的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传名为 `bigUploadFile` 的文件。上传成功后，脚本会尝试访问上传的文件，如果返回状态码为 200，则表示利用成功。`Reverse-shell.php` 文件包含一个 PHP 反向 Shell 脚本，用于在服务器上执行任意命令。

**投毒风险：** 提供的 PoC 代码主要用于验证漏洞的存在，并通过上传反向 Shell 来获取远程代码执行权限。`Reverse-shell.php` 脚本本身可以被认为是具有恶意功能的后门代码，但从仓库代码整体来看，并没有发现明显的投毒行为。投毒的概率较低，估计为10%。需要关注点在于，下载此PoC的用户如果直接使用或者修改reverse shell脚本，可能会不小心引入其他的恶意代码，但这不是原作者的投毒意图。

**利用方式：**

1.  攻击者构造一个包含恶意代码的 Web Shell 文件（例如 `Reverse-shell.php`）。
2.  攻击者使用 PoC 脚本（例如 `CVE-2023-4220.py`）向目标 Chamilo LMS 实例的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送 POST 请求，上传 Web Shell 文件。
3.  如果上传成功，攻击者可以通过访问上传的 Web Shell 文件来执行任意命令。
4.  利用 `Reverse-shell.php`，攻击者可以获得服务器的反向 Shell，从而完全控制服务器。

**项目地址:** [numaan911098/CVE-2023-4220](https://github.com/numaan911098/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)