## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击和权限提升

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise 的特定版本

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件、日历邀请或任务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以利用此漏洞窃取受害者的 Net-NTLM 哈希，然后使用该哈希进行 NTLM 中继攻击，从而冒充受害者。漏洞原理是Outlook在处理某些MAPI属性（如ReminderSoundFile）时，会尝试访问指定的 UNC 路径，而无需用户交互。这导致Outlook向该 UNC 路径指向的服务器发送 NTLM 身份验证请求。攻击者可以通过控制这个 UNC 路径，将身份验证请求重定向到攻击者控制的服务器，从而捕获 Net-NTLM 哈希。

**有效性评估：**
提供的 POC 代码尝试创建一个包含特定 ReminderSoundFile 路径的 Outlook 日历项。该路径指向一个攻击者控制的 UNC 路径（`\\192.168.70.222\test.wav`）。通过设置该属性，当 Outlook 处理此日历项时，会尝试访问该路径，从而触发 NTLM 身份验证请求。因此，提供的 POC 代码基本有效，可以用于触发该漏洞。

**投毒风险分析：**
该代码片段的主要功能是创建并配置 Outlook 日历项，并未发现任何与投毒相关的恶意代码。例如，没有下载或执行其他文件的操作，也没有修改系统配置或窃取用户数据的行为。README文件也只是说明了如何使用 Microsoft.Office.Interop.Outlook 实现 POC，并没有任何恶意内容。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意属性（ReminderSoundFile）的 Outlook 日历项、邮件或者任务。
2.  攻击者将包含该恶意属性的 Outlook 日历项发送给受害者。
3.  受害者打开或预览该日历项（无需进一步交互）。
4.  Outlook 尝试访问 ReminderSoundFile 属性中指定的 UNC 路径。
5.  Outlook 向攻击者控制的服务器发送 NTLM 身份验证请求。
6.  攻击者捕获 Net-NTLM 哈希。
7.  攻击者使用捕获的 Net-NTLM 哈希进行 NTLM 中继攻击，提升权限。

**项目地址:** [ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook](https://github.com/ahmedkhlief/CVE-2023-23397-POC-Using-Interop-Outlook)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)