## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，未认证的远程攻击者通过在设定的时间内认证失败触发

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全回归漏洞(CVE-2006-5051)。它存在一个竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，进而导致远程代码执行(RCE)或拒绝服务(DoS)。

根据搜索结果和漏洞信息，该漏洞影响glibc-based Linux系统，利用需要发起大量连接尝试来触发竞争条件。

提供的漏洞利用代码 `scanner.py` 是一个版本扫描器，并非直接利用 CVE-2024-6387。它用于检测目标 SSH 服务器的版本，并根据预定义的 CVE 列表判断是否存在已知的漏洞。该脚本通过创建 socket 连接到目标主机的 SSH 端口，然后发送一个空字节并接收服务器的响应，从中提取 OpenSSH 的版本信息。然后将提取的版本与易受攻击的版本列表进行比较。

**漏洞利用方式：**

1.  攻击者需要向目标 OpenSSH 服务器发起大量的连接请求。
2.  在连接建立后，故意触发认证失败，从而在信号处理过程中创建竞争条件。
3.  竞争条件允许攻击者在某些 glibc Linux 发行版中将指令插入堆中，进而实现远程代码执行。

**投毒风险：**

虽然脚本本身是一个版本扫描器，而不是直接的漏洞利用程序，但仍需谨慎评估其潜在的投毒风险。 代码中存在创建日志目录并记录扫描结果的行为，存在恶意修改扫描逻辑或在日志中写入恶意数据，但可能性极低。因此，评估投毒风险为1%。

**项目地址:** [ThatNotEasy/CVE-2024-6387](https://github.com/ThatNotEasy/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)