## CVE-2018-9995 - TBK DVR Authentication Bypass

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104/DVR4216 (及多个re-branded版本)

**危害等级:** 高危，可能导致未授权访问、视频泄露和设备控制

**影响版本:** 受影响设备版本未知，但漏洞于2018年4月被发现

**利用条件:** 目标DVR设备的网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置 'Cookie: uid=admin' HTTP头部绕过身份验证。漏洞利用代码中的`DVR-Exploiter.sh`脚本通过`curl`命令发送带有`/device.rsp?opt=user&cmd=list`参数的HTTP请求，从而获取设备上的用户信息，实现未授权访问。从提供的代码来看，该脚本仅仅发送了一个HTTP请求来获取凭据，并未发现存在可疑的后门或恶意代码，因此投毒风险较低。利用方式包括：

1.  使用dorks (例如 `intitle:'DVR Login'`, `html:'/login.rsp'`, `'Server: GNU rsp/1.1'`)在搜索引擎中查找目标设备。
2.  运行`DVR-Exploiter.sh`脚本，选择目标类型（IP或域名）。
3.  输入目标设备的IP地址和端口（如果适用）。
4.  脚本发送带有特定参数的HTTP请求，绕过身份验证并获取用户信息。

**项目地址:** [Cyb0r9/DVR-Exploiter](https://github.com/Cyb0r9/DVR-Exploiter)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)