## CVE-2024-21182 - Oracle WebLogic Server JNDI注入

**漏洞编号:** CVE-2024-21182

**漏洞类型:** JNDI注入

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致未授权访问敏感数据

**影响版本:** 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问WebLogic Server的T3或IIOP端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21182是一个存在于Oracle WebLogic Server的JNDI注入漏洞。未授权的攻击者可以通过T3或IIOP协议利用此漏洞，获取对WebLogic Server上敏感数据的未授权访问。 

**有效性：**
根据提供的漏洞信息、搜索结果和POC代码，此漏洞利用很可能有效。

*   漏洞库信息表明该漏洞容易被利用，且影响受支持的WebLogic Server版本。
*   搜索结果表明存在公开的POC代码，进一步证实了漏洞的可利用性。
*   POC代码利用JNDI注入，通过构造恶意的JNDI查询来利用漏洞。

**利用方式：**
POC代码的利用方式如下：

1.  使用T3协议连接到目标WebLogic Server。
2.  创建一个`MessageDestinationReference`对象，该对象包含一个指向恶意LDAP服务器的URL (`ldapUrl`)。
3.  创建一个`AggregatableOpaqueReference`对象，并将`MessageDestinationReference`对象设置为其`referent`字段的值。 这步是关键，因为`AggregatableOpaqueReference`通常用于处理序列化数据，而设置`referent`允许攻击者将恶意的JNDI引用传递给WebLogic Server。
4.  使用JNDI将`AggregatableOpaqueReference`对象绑定到WebLogic Server的JNDI树。
5.  使用JNDI查找绑定的对象，触发漏洞。WebLogic Server尝试从恶意LDAP服务器检索对象，从而导致远程类加载或代码执行。

**投毒风险：**
根据提供的代码，没有发现明显的投毒代码。该代码旨在利用JNDI注入漏洞。
*   代码的目的是创建一个JNDI绑定，该绑定指向一个LDAP服务器。LDAP服务器控制着payload，如果LDAP服务器被黑客控制，可能会有其他的安全风险。
*  README.md中声明For educational purpose only。

因此，投毒的可能性评估为0%。代码本身的行为就是漏洞利用，而不是隐藏的恶意功能。

**项目地址:** [k4it0k1d/CVE-2024-21182](https://github.com/k4it0k1d/CVE-2024-21182)

**漏洞详情:** [CVE-2024-21182](https://nvd.nist.gov/vuln/detail/CVE-2024-21182)