## CVE-2024-1086 Linux Kernel Use-After-Free 特权提升

**漏洞编号:** CVE-2024-1086

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 3.15 to < 6.8

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-1086 是 Linux Kernel netfilter nf_tables 组件中的一个 use-after-free 漏洞，攻击者可以利用此漏洞将普通用户的权限提升到 root 权限。

**有效性分析：**
根据漏洞库信息、搜索结果，以及提供的 checker 脚本，可以确认此漏洞的 POC 是有效的。Checker 脚本可以检测目标系统是否满足漏洞利用的配置条件，多个搜索结果表明该漏洞存在公开的利用代码，且已被积极利用。

**投毒风险分析：**
提供的代码是一个checker脚本，用于检测系统是否存在漏洞，而不是漏洞利用代码本身。 检查器脚本本身功能单一,通过读取多个`/proc`文件和`/boot/config-*`文件,来判断当前内核配置是否容易受到攻击。

*   `LICENSE` 和 `README.md` 文件内容正常，没有发现恶意代码。
*   `check_cve_2024_1086.py` 脚本主要用于检测内核版本和配置，以确定系统是否容易受到 CVE-2024-1086 攻击。脚本逻辑相对简单，主要是读取 `/proc` 和 `/boot/config-*` 文件，没有发现明显的恶意行为。

因此，该仓库中存在投毒代码的可能性较低，大约为 5%。

**利用方式分析：**
1.  **触发漏洞：**  `nft_verdict_init()` 函数允许将正值作为 hook verdict 中的 drop 错误，导致 `nf_hook_slow()` 函数在 NF_DROP 与类似于 NF_ACCEPT 的 drop 错误一起发出时，可能发生双重释放漏洞。
2.  **利用UAF：** 攻击者通过精心构造的 netfilter 规则，触发 use-after-free 漏洞。当释放后的内存被再次访问时，攻击者可以控制该内存的内容。
3.  **权限提升：**  通过控制释放后内存的内容，攻击者可以覆盖内核数据结构，从而劫持内核控制流，最终实现本地权限提升。

总而言之，此漏洞利用难度较高，需要对内核网络协议栈 netfilter 以及内存管理机制有深入的了解，但由于存在公开的 POC 且已被实际利用，因此风险等级较高。

**项目地址:** [kevcooper/CVE-2024-1086-checker](https://github.com/kevcooper/CVE-2024-1086-checker)

**漏洞详情:** [CVE-2024-1086](https://nvd.nist.gov/vuln/detail/CVE-2024-1086)