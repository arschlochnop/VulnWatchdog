## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 目标服务器运行存在漏洞的Request Baskets版本，攻击者可以访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets <= 1.2.1 版本中存在的一个服务器端请求伪造 (SSRF) 漏洞，位于 `/api/baskets/{name}` 组件。攻击者可以通过构造特制的 API 请求，迫使服务器向攻击者控制的或内部网络中的任意 URL 发起请求，从而获取敏感信息或者利用内部服务。

**有效性：**
提供的 PoC 代码看起来是有效的。它包含了一个 exploit.sh 脚本，该脚本首先创建一个新的 basket，并在创建 basket 的请求中，将 `forward_url` 设置为攻击者的 URL。然后，它访问该 basket，这将导致 Request Baskets 服务器向攻击者的 URL 发起请求。

**投毒风险：**
该 PoC 代码本身并没有明显的投毒行为。脚本的功能很明确，就是利用 SSRF 漏洞。`exploit.sh` 脚本首先创建一个 basket，将 `forward_url` 设置为攻击者提供的 URL，然后访问该 basket，触发 SSRF。因此，可以认为投毒风险为0%。

**利用方式：**
1.  攻击者首先需要部署存在漏洞的 Request Baskets 服务。
2.  攻击者执行 `exploit.sh` 脚本，并提供目标 Request Baskets 服务的 URL 和攻击者自己的服务器 URL。
3.  脚本将创建一个新的 basket，并设置其 `forward_url` 为攻击者的服务器 URL。
4.  脚本访问新创建的 basket，这将触发 Request Baskets 服务器向攻击者的服务器 URL 发起请求。
5.  攻击者可以在自己的服务器上捕获来自 Request Baskets 服务器的请求，并获取相关信息。

**项目地址:** [rvizx/CVE-2023-27163](https://github.com/rvizx/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)