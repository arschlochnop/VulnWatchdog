## CVE-2025-0108 PAN-OS 身份验证绕过漏洞

**漏洞编号:** CVE-2025-0108

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto PAN-OS

**危害等级:** 高危，可能导致未授权访问和信息泄露

**影响版本:** 受影响版本：PAN-OS 10.1.0 - 10.1.14 (低于 10.1.14-h9); PAN-OS 10.2.0 - 10.2.13 (低于 10.2.13-h3); PAN-OS 11.1.0 - 11.1.6 (低于 11.1.6-h1); PAN-OS 11.2.0 - 11.2.4 (低于 11.2.4-h4)

**利用条件:** 需要网络访问 PAN-OS 管理 Web 界面（通常在端口 443 或 4443 上）。如果管理界面暴露在互联网上，风险最高。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-0108 是 Palo Alto Networks PAN-OS 软件中管理 Web 界面存在的一个身份验证绕过漏洞。未经身份验证的攻击者如果能够访问管理 Web 界面，就可以绕过身份验证并调用某些 PHP 脚本。虽然调用这些 PHP 脚本本身不能实现远程代码执行，但可能会对 PAN-OS 的完整性和保密性产生负面影响。

**有效性：**

提供的 Nuclei PoC 代码通过发送包含路径遍历的恶意 HTTP GET 请求来检测漏洞是否存在。该请求的目标是 `{{BaseURL}}/unauth/%252e%252e/php/ztp_gate.php/PAN_help/x.css`。如果服务器返回包含 "Zero Touch Provisioning" 的 200 OK 响应，则表明存在漏洞。
根据漏洞描述，该PoC是有效的。

**投毒风险：**

该PoC由三个文件组成：
* `CVE-2025-0108.yaml`: Nuclei 模板，用于检测漏洞。
* `LICENSE`: MIT 许可证，允许自由使用、复制、修改和分发代码。
* `README.md`: 包含漏洞描述、PoC 说明和使用方法。

代码分析表明，PoC 代码本身的功能是检测漏洞，主要通过发送特定的HTTP请求并根据响应判断漏洞是否存在。`LICENSE`文件使用的是MIT协议，比较通用。`README.md`文件是对漏洞和PoC的描述。

根据以上分析，该仓库中存在恶意投毒代码的可能性较低，风险约为 5%。

**利用方式：**

1.  攻击者利用未经身份验证的访问权限，构造包含路径遍历的 URL，例如 `/unauth/%252e%252e/php/ztp_gate.php/PAN_help/x.css`。
2.  该路径遍历绕过身份验证机制，允许攻击者访问受保护的 PHP 脚本。
3.  虽然不能直接执行任意代码，但攻击者可以通过这些 PHP 脚本执行某些操作，例如修改配置或读取敏感信息，从而损害系统的完整性和保密性。

**缓解措施：**

*   限制对管理 Web 界面的访问，只允许受信任的内部 IP 地址访问。
*   升级到已修复漏洞的 PAN-OS 版本 (10.1.14-h9 或更高版本, 10.2.13-h3 或更高版本, 11.1.6-h1 或更高版本, 11.2.4-h4 或更高版本)。
*   启用威胁防御订阅，并阻止威胁 ID 510000 和 510001。

**项目地址:** [FOLKS-iwd/CVE-2025-0108-PoC](https://github.com/FOLKS-iwd/CVE-2025-0108-PoC)

**漏洞详情:** [CVE-2025-0108](https://nvd.nist.gov/vuln/detail/CVE-2025-0108)