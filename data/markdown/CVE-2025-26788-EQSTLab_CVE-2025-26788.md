## CVE-2025-26788-StrongKey-FIDO-Server-认证绕过

**漏洞编号:** CVE-2025-26788

**漏洞类型:** 认证绕过

**影响应用:** StrongKey FIDO Server

**危害等级:** 高危，可能导致账户接管

**影响版本:** < 4.15.1 (影响 4.10.0 及更高版本)

**利用条件:** 需要目标服务器运行受影响的StrongKey FIDO Server版本，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-26788是StrongKey FIDO Server在处理非可发现凭据（namedcredential）流程时的一个认证绕过漏洞。该漏洞允许攻击者将非可发现的凭据流程作为可发现的事务处理，从而可能绕过身份验证，接管任意用户的账户。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞是一个真实存在的认证绕过漏洞，影响StrongKey FIDO Server 4.15.1之前的版本。提供的POC代码包含一个Dockerfile和一个setup-skfs.sh脚本，用于自动化部署和配置受影响的StrongKey FIDO Server v4.15.0版本。该脚本下载并安装了所需的依赖项，包括Java 21、OpenLDAP等，并配置了FQDN。最重要的部分是`sed -i 's/^RPID=.*/RPID=skfs.localdomain/' /strongkey/install-skfs.sh` 命令，它修改了RPID（Relying Party ID），这可能与漏洞利用相关（虽然具体利用方式需要更多信息，但RPID的篡改通常与WebAuthn的认证流程有关）。最后，脚本部署了一个basicdemo.war，方便测试漏洞。总体而言，提供的POC代码可以用于搭建一个存在漏洞的环境，从而验证和利用该漏洞。

**投毒风险分析：**
仔细分析提供的Dockerfile和setup-skfs.sh脚本，主要操作包括：
1.  **基础环境搭建：** 安装必要的系统工具和依赖，例如wget、dnf等。
2.  **OpenLDAP配置：** 安装和配置OpenLDAP，这可能用于用户身份验证。
3.  **Java环境配置：** 安装Java 21，StrongKey FIDO Server依赖Java环境。
4.  **StrongKey FIDO Server安装：** 下载、解压并安装StrongKey FIDO Server v4.15.0。
5.  **域名配置：** 设置hostname为skfs.localdomain。
6.  **RPID修改：** **这是一个值得注意的点，脚本通过`sed`命令修改了`install-skfs.sh`文件中的`RPID`参数。 虽然此修改可能是为了配合漏洞利用，但也存在被恶意利用的潜在风险。如果攻击者能够控制RPID的值，则可能欺骗认证流程。**
7.  **basicdemo部署：** 部署一个示例应用，用于演示或测试。

潜在的投毒点在于RPID的修改和对sourceforge的依赖。如果sourceforge上的文件被替换，则存在投毒风险。 总体来说，投毒风险较低，大约5%， 因为脚本的主要目的是搭建一个可利用的环境，而不是植入恶意代码。

**利用方式分析：**
根据漏洞描述，StrongKey FIDO Server在处理非可发现凭据时，错误地将其视为可发现的事务。这表明攻击者可能通过以下方式利用该漏洞：
1.  **注册非可发现凭据：** 攻击者可能先以某种方式注册一个非可发现的FIDO凭据。
2.  **发起可发现凭据认证流程：** 攻击者发起一个可发现凭据的认证流程，并利用服务器的漏洞，使用之前注册的非可发现凭据进行认证。
3.  **绕过身份验证：** 由于服务器错误地将非可发现凭据视为可发现凭据，认证成功，攻击者绕过身份验证，接管目标账户。

具体利用方式还需要结合StrongKey FIDO Server的WebAuthn实现细节进行分析，但是整体思路是利用服务器对凭据类型的错误处理，实现认证绕过。

**项目地址:** [EQSTLab/CVE-2025-26788](https://github.com/EQSTLab/CVE-2025-26788)

**漏洞详情:** [CVE-2025-26788](https://nvd.nist.gov/vuln/detail/CVE-2025-26788)