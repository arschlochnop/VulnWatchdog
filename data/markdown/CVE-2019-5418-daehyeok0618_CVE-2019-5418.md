## CVE-2019-5418 - Rails File Content Disclosure

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**利用条件:** 需要目标应用使用存在漏洞的Rails版本，且允许通过Accept头控制渲染过程

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5418是Rails Action View中存在的一个文件内容泄露漏洞。攻击者可以通过构造特制的Accept头，结合`render file:`调用，读取目标服务器上的任意文件。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式是通过操纵HTTP请求的Accept头，诱导Rails渲染任意文件内容。提供的POC代码`README.md`文件仅包含简单的项目描述，本身不具备漏洞利用能力，可能是用于配合其他利用代码的说明文档或者项目初始化信息。但是仍然存在10%的投毒风险，因为该代码仓库中可能包含其他未公开的恶意代码或依赖项，或者作者有意引导使用者下载恶意依赖。

**利用方式：**
1.  构造包含恶意payload的Accept头。Payload通常包含指向目标文件系统的路径，例如`../../../../etc/passwd`。
2.  向目标Rails应用发送HTTP请求，包含构造的Accept头。
3.  如果应用存在漏洞，将会把目标文件的内容渲染到响应中，从而导致信息泄露。

**项目地址:** [daehyeok0618/CVE-2019-5418](https://github.com/daehyeok0618/CVE-2019-5418)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)