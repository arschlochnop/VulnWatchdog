## CVE-2025-31324 - SAP NetWeaver Visual Composer 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统运行受影响版本的 SAP NetWeaver Visual Composer，且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-31324 是 SAP NetWeaver Visual Composer Metadata Uploader 中存在的未授权文件上传漏洞。攻击者无需身份验证即可上传恶意可执行二进制文件，从而严重危害主机系统，影响保密性、完整性和可用性。 

**有效性分析：**
提供的漏洞利用代码（scanner）是一个 Python 脚本，旨在检测目标系统是否存在 CVE-2025-31324 漏洞，并扫描已知的恶意 `.jsp` 文件（webshell）。它通过检查是否存在可利用的 Visual Composer 端点来实现。脚本本身并不直接利用该漏洞上传文件，而是侧重于检测。

**投毒风险分析：**

1.  **依赖风险**：
    *   `requirements.txt` 文件列出了脚本所需的 Python 依赖项。虽然 `requests` 是一个常用的库，但攻击者可能通过修改 `requirements.txt` 文件，引入包含恶意代码的虚假或受污染的依赖项。用户安装依赖项时，恶意代码会被植入到环境中。 可能性：5%
2.  **IOC 列表风险**：
    *   `ioc_list.txt` 用于检测已知的恶意 `.jsp` 文件。攻击者可能篡改此文件，添加看似无害但实际会触发恶意行为的模式，或者排除某些已知恶意文件的检测，从而绕过检测。可能性：3%
3. **本地测试**: 
	*  本地测试模拟了一个简易的HTTP服务器，提供了一个`cache.jsp`的文件，如果用户没有仔细检查，可能没有发现`cache.jsp`的内容是一个fake webshell，具有一定的误导性。

总体而言，该POC本身投毒的概率较低，主要风险在于使用者可能忽略依赖的安全性以及IOC列表可能存在的问题，导致检测结果不准确。最终`poison`定为10%。

**利用方式：**

1.  攻击者利用未授权的文件上传漏洞，上传包含恶意代码的 `.jsp` 文件或其他可执行文件到 SAP NetWeaver Visual Composer 服务器。
2.  上传的文件通常会被放置在 Web 服务器可访问的目录下。
3.  攻击者通过构造特定的 URL 访问上传的恶意文件，触发恶意代码的执行。
4.  恶意代码执行后，攻击者可以获取系统权限，执行任意命令，窃取敏感数据，或者进行其他恶意活动。

**项目地址:** [JonathanStross/CVE-2025-31324](https://github.com/JonathanStross/CVE-2025-31324)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)