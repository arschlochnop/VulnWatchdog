## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要目标系统运行Webmin且版本小于等于1.920，并且可以通过网络访问password_change.cgi页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107 是 Webmin 1.920 及更早版本中 password_change.cgi 文件中存在的一个命令注入漏洞。攻击者可以通过在 `old` 参数中注入恶意命令来执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断此漏洞利用是有效的。

*   漏洞库信息明确指出 `password_change.cgi` 文件的 `old` 参数存在命令注入漏洞。
*   搜索引擎结果中多个链接 (例如 Rapid7, Tenable, Pentest-tools) 都证实了该漏洞的存在以及其远程代码执行的特性。
*   提供的 PoC 代码 `CVE-2019-15107.py` 利用 `password_change.cgi` 文件的漏洞，通过构造包含恶意命令的 `payload` 发送请求，从而实现远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，投毒风险较低。

*   `CVE-2019-15107.py` 脚本本身的功能是利用漏洞执行命令。代码虽然使用了perl反弹shell, 但本身是POC利用的一部分,不能被判定为投毒代码。
*   `README.md` 文件只是提供了漏洞的简单描述以及使用方法，并没有包含任何恶意代码。
*   整个仓库看起来是对现有公开漏洞的利用脚本，没有发现作者主动引入恶意代码的迹象。

**利用方式分析：**

1.  攻击者首先需要确定目标系统运行的 Webmin 版本小于等于 1.920。
2.  使用提供的 PoC 脚本，修改 `LHOST` 和 `LPORT` 为攻击者的 IP 地址和端口。
3.  运行 PoC 脚本，向目标系统的 `password_change.cgi` 发送包含恶意命令的请求。
4.  如果漏洞利用成功，目标系统会反弹一个 shell 给攻击者，从而实现远程控制。

总的来说，该漏洞的利用较为简单，攻击者只需要使用提供的 PoC 脚本，并根据实际情况修改相关参数即可。鉴于该漏洞的危害性较高，建议及时升级 Webmin 版本到安全版本，或者采取其他缓解措施。

**项目地址:** [cdedmondson/Modified-CVE-2019-15107](https://github.com/cdedmondson/Modified-CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)