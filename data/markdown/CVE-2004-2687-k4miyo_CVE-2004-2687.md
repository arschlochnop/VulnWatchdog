## CVE-2004-2687-distccd-RCE

**漏洞编号:** CVE-2004-2687

**漏洞类型:** 远程代码执行

**影响应用:** distcc

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 2.x, XCode 1.5及其他

**利用条件:** distcc未配置为限制对服务器端口的访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2004-2687 存在于 distcc 2.x 中，当 distcc 未配置为限制对服务器端口的访问时，远程攻击者可以通过编译任务执行任意命令。该漏洞利用方式为：攻击者向 distccd 发送特制的编译请求，该请求中包含要执行的恶意命令。由于 distccd 没有进行充分的授权检查，它会执行请求中的命令，从而导致远程代码执行。提供的 Python 脚本 `CVE-2004-2687.py` 实现了这一攻击。脚本构造包含反向 shell 命令的 payload，并将其发送到目标 distccd 服务器。如果目标服务器存在漏洞且可访问，则该脚本将在目标系统上执行反向 shell，允许攻击者远程访问目标系统。该漏洞的有效性取决于目标 distcc 服务器的配置。如果 distcc 配置为仅允许来自可信来源的连接，则攻击将失败。投毒风险较低，代码目的是发送特制的编译请求以执行反向 shell，主要目的是利用漏洞，而非隐藏恶意代码，只是复用了其他作者的exp。

**项目地址:** [k4miyo/CVE-2004-2687](https://github.com/k4miyo/CVE-2004-2687)

**漏洞详情:** [CVE-2004-2687](https://nvd.nist.gov/vuln/detail/CVE-2004-2687)