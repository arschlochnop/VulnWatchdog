## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进而发展为RCE

**影响版本:** 受影响版本: Jenkins 2.441及更早版本, LTS 2.426.2及更早版本 (不受影响的版本: >= 1.606, >= 2.442, >= 2.426.3, >= 2.440.1)

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中存在一个特性，该特性会将参数中的'@'字符后跟文件路径替换为文件的内容。攻击者可以通过构造包含目标文件路径的特制 CLI 命令，利用此特性读取文件内容。

**有效性：**
从漏洞描述和搜索结果来看，该漏洞影响一定范围内的Jenkins版本，并且已经存在公开的利用方法。

**投毒风险：**
提供的漏洞利用代码主要是一个`README.md`文件，内容是关于如何使用 Jenkins CLI 客户端以及漏洞的相关信息。直接判断该文件本身是否包含恶意投毒代码的可能性较低。`README.md`中提到的jenkins-cli.jar客户端是官方的，如果下载源被篡改则存在风险，该风险无法直接评估，但存在远程投毒的可能，客户端本身没有直接的投毒风险，因此综合评估投毒风险为10%。

**利用方式：**
1.  攻击者使用 Jenkins CLI 客户端。
2.  攻击者构造包含`@`符号和目标文件路径的 CLI 命令参数，例如：`java -jar jenkins-cli.jar command @/path/to/target/file`。
3.  Jenkins CLI 解析器会将`/path/to/target/file`的内容读取并作为命令参数传递给 Jenkins 控制器。
4.  如果 Jenkins 控制器允许该命令执行，则攻击者可以通过某种方式（例如命令的输出）获取目标文件的内容。

总而言之，攻击者通过滥用 Jenkins CLI 的 `@` 扩展功能，能够读取服务器上的任意文件。

**项目地址:** [B4CK4TT4CK/CVE-2024-23897](https://github.com/B4CK4TT4CK/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)