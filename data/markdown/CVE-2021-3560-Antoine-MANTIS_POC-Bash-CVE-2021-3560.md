## CVE-2021-3560-Polkit本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 本地提权

**影响应用:** Polkit

**危害等级:** 高危，可能导致本地用户获取root权限

**影响版本:** <= 0.119

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560是一个Polkit的本地提权漏洞。根据漏洞库信息、搜索结果以及提供的POC代码，可以得出以下结论：

**有效性：**

POC代码的有效性很高。漏洞描述表明，未授权的本地用户可以通过利用D-Bus请求中的凭据检查绕过，从而获得root权限。 提供的PoC脚本正是通过D-Bus接口来创建用户并设置密码，利用竞态条件来绕过权限验证。

**投毒风险：**

POC代码的投毒风险很低，为0%。 代码主要完成以下操作：

1.  **创建用户：** 使用`dbus-send`命令尝试创建新用户。利用竞态条件，在polkit正确验证权限之前完成用户创建。
2.  **设置密码：** 创建用户后，脚本尝试设置新用户的密码。同样利用竞态条件，尝试绕过权限验证。
3. **循环尝试:** 脚本使用循环尝试创建用户和设置密码，直到成功或达到最大尝试次数。

代码中没有发现任何恶意或隐藏的代码。虽然脚本的目的是利用漏洞进行提权，但它本身不包含任何超出漏洞利用范围的恶意功能，如安装后门、删除文件或传播恶意软件。

**利用方式：**

利用方式如下：

1.  **竞态条件：** 该漏洞的核心在于竞态条件。攻击者通过快速、重复地发送D-Bus请求，尝试在Polkit完成权限验证之前执行操作。
2.  **创建用户：** POC通过`org.freedesktop.Accounts.CreateUser`接口尝试创建一个新用户，目标是绕过权限验证直接创建具有管理权限的用户。
3.  **设置密码：** 创建用户后，PoC尝试通过`org.freedesktop.Accounts.User.SetPassword`接口设置密码，使得创建的用户可以使用该密码登录。
4.  **本地提权：** 成功利用该漏洞后，攻击者可以使用新创建的用户登录，并利用`sudo`命令执行需要root权限的操作，从而实现本地提权。

**排序优先级说明：**

按照任务要求，排序优先级为：搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。 虽然漏洞库信息提供了漏洞的基本描述，但搜索引擎结果提供了更全面的信息，包括漏洞的发现者、利用方法和缓解措施。 漏洞利用代码则直接展示了漏洞的利用方式。


**项目地址:** [Antoine-MANTIS/POC-Bash-CVE-2021-3560](https://github.com/Antoine-MANTIS/POC-Bash-CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)