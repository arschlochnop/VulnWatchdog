## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和RCE

**影响版本:** <=2.441, LTS <=2.426.2

**利用条件:** 需要能够访问Jenkins CLI

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器中的一个特性，该特性允许将以'@'字符开头的参数替换为文件内容。攻击者可以通过构造包含'@'字符和目标文件路径的CLI命令，读取Jenkins控制器文件系统上的任意文件。

**有效性：**
提供的POC代码有效。它通过docker的方式搭建了一个存在漏洞的jenkins环境，并指出了漏洞代码位于`Args4j`库的`CmdLineParser.java`中。PoC利用了`expandAtFiles`方法，该方法会将参数中以`@`开头的文件路径替换为文件内容，从而实现任意文件读取。

**投毒风险：**
该代码仓库的投毒风险较低，大约为10%。主要风险在于 Dockerfile 中可能存在的恶意指令，或者 README.md 中链接的外部资源被篡改。但是，核心的漏洞利用代码本身是直接展示了漏洞原理，没有发现明显用于投毒的代码。

**利用方式：**
1.  攻击者需要能够访问Jenkins CLI（可以通过HTTP, WebSocket, SSH等方式）。
2.  攻击者构造一个CLI命令，该命令的参数包含'@'字符和目标文件的路径。例如，使用`connect-node`命令，并传入`@/path/to/file`作为节点名称。
3.  Jenkins CLI解析器将`@/path/to/file`替换为`/path/to/file`的内容。
4.  如果攻击者具有`Overall/Read`权限，则可以读取整个文件。否则，攻击者可能只能读取文件的前几行，具体取决于可用的CLI命令。
5.  通过读取敏感配置文件（例如，包含管理员密码的文件），攻击者可能可以进一步提升权限并执行远程代码。

**项目地址:** [murataydemir/CVE-2024-23897](https://github.com/murataydemir/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)