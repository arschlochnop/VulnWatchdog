## CVE-2021-43798 Grafana目录遍历漏洞

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** 需要Grafana实例可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Grafana的插件路径处理中，攻击者可以通过构造包含目录遍历的URL，例如`/public/plugins/<plugin>/../../../../../../etc/passwd`，来读取服务器上的任意文件。漏洞利用代码`exploit.py`首先尝试一系列预定义的插件路径，然后通过发送HTTP GET请求读取`/etc/passwd`文件来确认漏洞是否存在。如果漏洞存在，脚本会进入交互模式，允许用户指定要读取的文件。

**有效性：** 根据漏洞库信息、搜索引擎结果和漏洞利用代码，提供的POC代码是有效的。漏洞库信息明确指出受影响的版本范围，搜索引擎结果中也有关于该漏洞的利用和检测的文章。POC代码通过目录遍历读取`/etc/passwd`文件来验证漏洞，是常用的验证方法。

**投毒风险：** 漏洞利用代码`exploit.py`本身较为简单，主要功能是发送HTTP请求和处理响应。代码中没有发现任何可疑的或恶意的操作，例如执行系统命令、修改文件等。因此，可以认为该POC代码不存在投毒风险。

**利用方式：** 攻击者首先需要确定目标Grafana实例的版本是否在受影响范围内。然后，攻击者可以使用POC代码提供的URL路径，如`/public/plugins/alertGroups/../../../../../../../etc/passwd`，来尝试读取`/etc/passwd`文件。如果成功读取，则表示漏洞存在，攻击者可以继续尝试读取其他敏感文件，例如Grafana的配置文件，其中可能包含数据库连接信息等敏感数据。通过泄露的数据库信息，攻击者可进一步渗透。

**排序优先级:** 搜索引擎结果和漏洞利用代码均证实了漏洞的有效性和利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本范围。

**项目地址:** [monke443/CVE-2021-43798](https://github.com/monke443/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)