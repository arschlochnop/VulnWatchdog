## CVE-2022-1388 - F5 BIG-IP iControl REST Authentication Bypass

**漏洞编号:** CVE-2022-1388

**漏洞类型:** Authentication Bypass / Remote Code Execution

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 受影响版本：16.1.x (< 16.1.2.2), 15.1.x (< 15.1.5.1), 14.1.x (< 14.1.4.6), 13.1.x (< 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 需要网络访问到BIG-IP的管理界面（iControl REST API）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 是一个存在于 F5 BIG-IP iControl REST API 中的身份验证绕过漏洞。未经身份验证的攻击者可以通过特制的 HTTP 请求绕过 iControl REST 的身份验证机制，从而执行任意代码。提供的漏洞利用代码 `cve.py` 包含单目标和批量利用模式。它通过发送带有特定头部（如 `Host: 127.0.0.1`, `Authorization: Basic YWRtaW46aG9yaXpvbjM=`, `X-F5-Auth-Token: asdf`, `Connection: X-F5-Auth-Token`, `Content-Type: application/json`）的请求到 `/mgmt/tm/util/bash` 端点来实现远程代码执行。从代码逻辑和功能来看，没有发现明显的投毒代码。`api_command.txt` 提供了一些常用的命令，可以用于执行系统命令。

**利用方式：**
1.  攻击者构造包含特定 HTTP 头的恶意请求。
2.  请求发送到 BIG-IP 设备的 iControl REST API 端点，通常是 `/mgmt/tm/util/bash`。
3.  通过 `utilCmdArgs` 参数指定要执行的命令。
4.  由于身份验证绕过，BIG-IP 设备会执行攻击者提供的命令，从而导致远程代码执行。

根据 CISA 的安全公告 (AA22-138A) 显示，此漏洞已被威胁参与者积极利用。因此，利用的有效性很高，并且应该优先修复。

**项目地址:** [revanmalang/CVE-2022-1388](https://github.com/revanmalang/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)