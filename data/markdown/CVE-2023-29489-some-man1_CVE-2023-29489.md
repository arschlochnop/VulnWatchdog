## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** XSS

**影响应用:** cPanel

**危害等级:** 中危，可能导致账户劫持、恶意重定向等

**影响版本:** cPanel 版本低于 11.109.9999.116

**利用条件:** 需要目标 cPanel 存在漏洞，且用户访问攻击者构造的恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29489 是 cPanel 中存在的一个跨站脚本 (XSS) 漏洞。该漏洞位于 cpsrvd 错误页面，通过一个无效的 webcall ID 触发。攻击者可以构造包含恶意 JavaScript 代码的 URL，当受害者访问此 URL 时，恶意代码将在受害者浏览器中执行。

**有效性：**
根据漏洞信息、搜索结果和提供的 POC 代码，可以判断该 POC 代码是有效的。POC 代码通过向目标 cPanel 的 `/cpanelwebcall/` 路径发送请求，并附加一个 XSS payload（`<img src=x onerror="prompt(1)">`）来测试漏洞是否存在。如果服务器返回包含 "HTTP error 400" 的响应，则表明目标存在漏洞。

**投毒风险：**
经分析，提供的 POC 代码中没有明显的恶意投毒代码。脚本的功能主要是批量检测目标是否存在 CVE-2023-29489 漏洞，并将存在漏洞的 URL 保存到文件中。README.md 文件也只是提供了脚本的使用说明和作者的 Telegram 频道链接，没有发现任何可疑的代码。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，例如：`https://example.com/cpanelwebcall/%3Cimg%20src=x%20onerror=%22prompt(1)%22%3Eaaaaaaaaaaaa`。
2.  攻击者诱导受害者点击此 URL，例如通过电子邮件、社交媒体等方式。
3.  当受害者访问此 URL 时，cPanel 的 cpsrvd 错误页面会返回包含恶意 JavaScript 代码的 HTML。 
4.  受害者的浏览器执行恶意 JavaScript 代码，导致 XSS 攻击。

攻击者可以通过 XSS 漏洞执行恶意操作，例如：
*   窃取用户的 cookie，从而冒充用户登录 cPanel。
*   修改 cPanel 页面内容，欺骗用户。
*   重定向用户到恶意网站。
*   执行其他恶意操作。

**项目地址:** [some-man1/CVE-2023-29489](https://github.com/some-man1/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)