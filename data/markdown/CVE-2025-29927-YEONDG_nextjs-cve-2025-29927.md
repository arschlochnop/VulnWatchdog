## CVE-2025-29927-Next.js中间件绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** Next.js 15.x < 15.2.3, Next.js 14.x < 14.2.25, Next.js 13.x < 13.5.9

**利用条件:** 应用程序使用了Next.js中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中存在的权限绕过漏洞。攻击者可以利用`x-middleware-subrequest`头部来绕过中间件的认证检查，从而访问受保护的资源。

**有效性：**
根据漏洞信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的。PoC代码演示了如何通过设置`x-middleware-subrequest`头部来绕过身份验证中间件，从而访问`/api/protected`端点。搜索引擎结果中的多个博客文章和安全公告都确认了此漏洞的存在和利用方式。

**投毒风险：**
提供的代码仓库主要包含用于演示和验证漏洞的组件以及相关的配置文件。代码逻辑较为简单，主要用于搭建两个版本的Next.js应用（一个易受攻击，一个已修复）。
* `README.md`: 提供了漏洞的描述、复现步骤和参考链接，未发现可疑代码。
* `package.json`: 列出了项目依赖项，都是常见的开发和构建工具，没有发现恶意依赖。
* `pnpm-lock.yaml`:  锁定了依赖版本，有助于确保构建的可重复性。检查依赖项的完整性十分重要，这里假设 pnpm-lock.yaml 文件是干净的。
* `/apps/next15_1_7/` 和 `/apps/next15_2_4/`:  包含了Next.js应用程序的代码。 需要审计这些应用程序的代码，以查找潜在的后门或恶意代码。通常，应该关注以下几个方面：
   * 不常见的或者混淆的代码
   *  动态代码执行 (`eval`, `Function` 构造函数等)
   *  未经检查的用户输入
   *  与外部服务的可疑交互

虽然仔细检查了提供的文件，并没有发现明显的投毒代码，但仍然无法完全排除风险。因此，建议进行彻底的代码审查，以确认不存在恶意代码。
总体而言，该存储库中存在恶意代码的风险较低，估计为5%。

**利用方式：**
1.  目标应用程序必须使用受影响版本的Next.js，并且使用中间件进行身份验证/授权。
2.  攻击者发送带有`x-middleware-subrequest`头部的HTTP请求。
3.  如果头部的值构造得当（例如，多次重复`middleware:`），Next.js的中间件逻辑会被绕过。
4.  攻击者成功访问受保护的资源，例如API端点或页面，而无需提供有效的身份验证凭据。

**项目地址:** [YEONDG/nextjs-cve-2025-29927](https://github.com/YEONDG/nextjs-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)