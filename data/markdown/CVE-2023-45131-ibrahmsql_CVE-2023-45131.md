## CVE-2023-45131-Discourse未授权访问聊天消息

**漏洞编号:** CVE-2023-45131

**漏洞类型:** 信息泄露

**影响应用:** Discourse

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 3.1.2 (stable), < 3.2.0.beta2 (beta)

**利用条件:** 目标Discourse实例版本在受影响范围内，且MessageBus功能启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45131 允许未经身份验证的攻击者通过 MessageBus 访问 Discourse 的私有聊天消息。利用方式是向 `/message-bus/poll` 发送请求，获取 `clientId`，然后使用该ID订阅聊天频道，从而窃取聊天信息。根据NVD，攻击复杂度低，无需用户交互。PoC 利用 Ruby 编写，验证 MessageBus 的未授权访问，枚举聊天频道，并尝试访问私有消息。代码存在投毒的风险较低，但不能完全排除，主要存在于以下几点: 1. 代码逻辑比较复杂,攻击者可能会利用某些分支逻辑来执行恶意操作。2. 代码中存在一些外部依赖,如 Net::HTTP, URI, JSON, OpenSSL, 和 Base64, 这些依赖本身可能存在安全问题。3. 代码没有做严格的输入验证, 攻击者可能会通过构造特殊的URL或者请求数据来执行恶意操作。

**项目地址:** [ibrahmsql/CVE-2023-45131](https://github.com/ibrahmsql/CVE-2023-45131)

**漏洞详情:** [CVE-2023-45131](https://nvd.nist.gov/vuln/detail/CVE-2023-45131)