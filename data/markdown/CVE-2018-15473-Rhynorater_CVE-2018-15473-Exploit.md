## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能泄露系统用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够建立到目标SSH服务器的连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送无效用户的认证请求，根据服务器响应时间的差异来判断用户是否存在。OpenSSH 7.7及更早版本在处理认证请求时，不会延迟对无效用户的 bailout，导致响应时间存在差异。

**有效性：**

根据提供的漏洞利用代码和搜索结果，该漏洞利用代码是有效的。多个来源（Exploit-DB，Red Hat Customer Portal等）确认了此漏洞的存在，并且提供了可利用的PoC代码。提供的Dockerfile构建了一个包含所需依赖项（paramiko）的Alpine Linux环境，并执行`sshUsernameEnumExploit.py`脚本。

**投毒风险：**

分析`sshUsernameEnumExploit.py`脚本内容，该脚本的主要功能是利用Paramiko库尝试连接SSH服务，并根据响应时间来判断用户名是否存在。 代码逻辑相对简单，没有发现明显的恶意代码，例如反弹shell，文件读写等。`random_username_list`变量用于测试目标，降低了误报率。 但是，考虑到任何未经授权的扫描行为都可能被视为恶意行为，且代码可能被修改为更具攻击性的payload，因此仍然存在一定的投毒风险。综合评估，投毒风险为10%。

**利用方式：**

1.  **构建环境：** 使用提供的Dockerfile构建包含Python和Paramiko库的Docker镜像。
2.  **准备用户名列表：**  准备一个包含待测试用户名的文件，例如`exampleInput.txt`。
3.  **运行漏洞利用脚本：** 运行`sshUsernameEnumExploit.py`脚本，指定目标SSH服务器的IP地址和用户名列表文件。
4.  **分析结果：** 脚本会尝试连接目标服务器，并根据响应时间判断用户名是否存在，将结果输出为列表、JSON或CSV格式。

总体来说，该漏洞的利用方式相对简单，但需要对目标SSH服务器进行扫描，可能留下日志记录，因此在使用时需要谨慎。

**项目地址:** [Rhynorater/CVE-2018-15473-Exploit](https://github.com/Rhynorater/CVE-2018-15473-Exploit)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)