## CVE-2025-52078 - Writebot AI Content Generator SaaS React Template Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-52078

**漏洞类型:** Unauthenticated Arbitrary File Upload

**影响应用:** Writebot AI Content Generator SaaS React Template

**危害等级:** 中危，可能导致远程代码执行，权限提升

**影响版本:** thru 4.0.0

**利用条件:** 需要网络访问，目标存在/file-upload接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Writebot AI Content Generator SaaS React Template 4.0.0及更早版本中。攻击者可以通过向/file-upload接口发送精心构造的POST请求，上传恶意文件（例如PHP shell），从而获得服务器的控制权限。由于缺乏身份验证和充分的文件类型验证，攻击者可以绕过安全限制。

**漏洞利用方式：**

1.  **漏洞定位：** 漏洞存在于`/file-upload` 接口，该接口允许未经身份验证的用户上传文件。
2.  **绕过方法：** 上传的文件通过伪造成`image/jpeg`的MIME类型，绕过简单的文件类型检查。
3.  **恶意代码植入：** 上传的文件实际是PHP代码（`bq.php`），其中包含攻击者希望执行的恶意命令。
4.  **远程执行：** 上传成功后，攻击者可以通过访问上传文件的URL来执行PHP代码，从而控制服务器。

**有效性评估：**

提供的PoC代码针对该漏洞，利用了未授权的文件上传功能，并且绕过了基本的文件类型验证。PoC使用`requests`和`BeautifulSoup4`库来模拟HTTP请求，获取CSRF token（如果存在），并将恶意PHP文件作为`image/jpeg`上传。如果上传成功，PoC会从响应中提取上传文件的URL，并将其保存到`result.txt`中。根据漏洞描述和提供的代码，该PoC应该是有效的。

**投毒风险评估：**

代码主要功能是利用漏洞，投毒风险较低，`bq.php` 本身就是后门文件，不属于投毒代码。但是，mass_uploader.py具有批量上传的功能，有可能被修改为传播恶意软件。

1.  **bq.php潜在风险：**虽然`bq.php`文件本身就是攻击载荷，但有可能被修改为包含更具破坏性的代码，例如删除文件、篡改数据等。
2.  **域名列表（list.txt）风险：** 攻击者可能会使用该PoC扫描大量网站，并将受感染的URL添加到`result.txt`中，形成一个恶意链接库，用于进一步的攻击活动。
3.  **依赖库风险:** 依赖的库例如`requests`，`beautifulsoup4`本身没有发现存在投毒行为,但是如果被替换成恶意版本也存在一定的风险。

综合来看，该仓库中存在一定的投毒风险，主要体现在`mass_uploader.py`脚本可能被用于大规模攻击以及bq.php可能被替换成更具破坏性的恶意代码。概率较低，约为5%。

**项目地址:** [Yucaerin/CVE-2025-52078](https://github.com/Yucaerin/CVE-2025-52078)

**漏洞详情:** [CVE-2025-52078](https://nvd.nist.gov/vuln/detail/CVE-2025-52078)