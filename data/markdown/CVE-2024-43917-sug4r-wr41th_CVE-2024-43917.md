## CVE-2024-43917-TI WooCommerce Wishlist-SQL注入

**漏洞编号:** CVE-2024-43917

**漏洞类型:** SQL注入

**影响应用:** TI WooCommerce Wishlist

**危害等级:** 严重，未经授权的数据库访问，敏感信息泄露

**影响版本:** <= 2.8.2

**利用条件:** 需要安装并启用TI WooCommerce Wishlist插件，且知道或能猜测到wishlist的share key。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于TI WooCommerce Wishlist插件中，允许未经身份验证的攻击者执行SQL注入。攻击者可以利用`wp-json/wc/v3/wishlist/{args.SHARE_KEY}/get_products`接口，通过构造恶意的`order`参数，将恶意SQL语句注入到数据库查询中。PoC脚本通过`requests`库发送带有恶意SQL命令的HTTP GET请求。脚本首先通过注入`OR 1=1 -- `测试目标是否易受攻击，如果返回200，则确认存在漏洞，然后执行用户指定的SQL命令。搜索引擎结果也确认了该漏洞的存在和严重性。

**漏洞利用方式：**

1.  确定目标网站使用了易受攻击版本的TI WooCommerce Wishlist插件（<= 2.8.2）。
2.  获取或猜测到Wishlist的share key。
3.  使用PoC脚本，通过修改`COMMAND`参数来执行任意SQL查询。
4.  通过分析返回的结果，获取数据库中的敏感信息。

**投毒风险分析：**

提供的PoC代码和README文件没有发现明显的投毒代码。PoC脚本的功能单一，仅用于利用SQL注入漏洞。README文件提供了漏洞信息和使用说明。因此，投毒风险评估为0%。

**项目地址:** [sug4r-wr41th/CVE-2024-43917](https://github.com/sug4r-wr41th/CVE-2024-43917)

**漏洞详情:** [CVE-2024-43917](https://nvd.nist.gov/vuln/detail/CVE-2024-43917)