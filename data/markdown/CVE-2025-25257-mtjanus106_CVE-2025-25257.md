## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，允许未经身份验证的攻击者执行任意SQL命令，可能导致远程代码执行

**影响版本:** 6.3.0 to 6.3.5, 6.2.0 to 6.2.6

**利用条件:** 需要网络访问FortiWeb GUI界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索结果和提供的漏洞利用代码，CVE-2025-25257是FortiWeb中的一个未经身份验证的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，在受影响的FortiWeb设备上执行任意SQL命令，最终可能导致远程代码执行（RCE）。

**有效性分析：**

提供的POC代码 `exp.py` 尝试利用SQL注入漏洞，通过修改HTTP请求头中的 `Authorization` 字段，向 `/api/fabric/device/status` API端点注入SQL代码。代码中包含利用该漏洞上传webshell，执行系统命令的尝试。根据搜索结果，已经有公开的PoC可以实现RCE，因此该POC具有较高的有效性。

**投毒风险分析：**

`README.md` 文件指示从GitHub Releases下载必要文件，这存在一定的风险。虽然代码本身（`exp.py`）看起来是利用SQL注入漏洞，但是不排除在releases中放置恶意编译文件或者脚本。

代码片段`exp.py` 中存在对webshell的上传，以及对文件权限修改的操作。
```python
        self._chmod_file = ""
        self._chmod_file += "import os # \r\n"
        self._chmod_file += "os.system('chmod +x /migadmin/cgi-bin/x.cgi && rm -f /var/log/lib/python3.10/pylab.py') #"

        self._webshell = ''
        self._webshell += '#!/bin/sh -- \r\n'
        self._webshell += 'printf "Content-Type: text/html\\r\\n";printf "\\r\\n";eval $HTTP_USER_AGENT'
```
攻击者可能利用此webshell进行后渗透，或进行数据窃取等恶意行为。

综合分析，投毒风险的评估如下：
* 高度依赖用户下载 release 里的内容，如果用户只关注代码，风险较低。
* `exp.py` 代码本身包含webshell上传，以及修改文件权限，在利用成功后，可能成为后门。这部分是否是作者植入的恶意代码难以区分。

因此，评估存在 10% 的投毒风险，主要集中在GitHub Release可能包含的恶意文件，以及成功利用后的webshell可能被滥用。

**利用方式分析：**

1.  **确定目标：** 确定要攻击的FortiWeb设备的IP地址。
2.  **构造恶意SQL注入：** 修改HTTP请求头中的 `Authorization` 字段，向 `/api/fabric/device/status` API端点注入SQL代码。注入的SQL代码旨在执行系统命令，例如上传webshell和修改文件权限。
3.  **上传Webshell：** 利用SQL注入漏洞，将webshell上传到服务器。  根据代码，webshell的内容是通过`HTTP_USER_AGENT`传递的命令，并由shell执行。
4.  **执行任意命令：** 通过访问上传的webshell，利用`HTTP_USER_AGENT`传递恶意代码，从而在服务器上执行任意命令，实现远程代码执行。

**项目地址:** [mtjanus106/CVE-2025-25257](https://github.com/mtjanus106/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)