## CVE-2025-54962 - OpenPLC Runtime Webserver Insecure File Upload

**漏洞编号:** CVE-2025-54962

**漏洞类型:** 文件上传漏洞

**影响应用:** OpenPLC Runtime

**危害等级:** 中危，可能导致存储型XSS、CSRF和恶意内容托管

**影响版本:** <= 9cd8f1b53a50f9d38708096bfc72bcbb1ef47343

**利用条件:** 需要OpenPLC Runtime服务运行，并具有经过身份验证的用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54962是OpenPLC Runtime Webserver中的一个文件上传漏洞。经过身份验证的用户可以通过`/edit-user`接口上传任意文件(如.html或.svg)作为头像。这些文件存储在`/static/`目录下，并且无需身份验证即可公开访问。攻击者可以通过上传包含恶意JavaScript代码的HTML文件来执行存储型XSS攻击。此外，该漏洞还允许攻击者托管恶意内容，并可能通过CSRF利用。

**有效性：**
提供的PoC代码有效。它展示了如何通过构造一个包含恶意JavaScript代码的HTML文件，并将其作为头像上传，成功触发存储型XSS攻击。同时PoC也演示了CSRF利用。

**投毒风险：**
提供的PoC代码中潜在的投毒风险较低，大约10%。主要风险在于：

*   **文件内容：** 上传的文件 (`poc cve.html`) 包含一个指向 `http://127.0.0.1:8080/delete-user?user_id=[User ID]` 的隐藏图像标签，用于触发CSRF。如果开发者直接复制并使用此PoC，可能会无意中删除自己的用户或测试用户。当然这种风险很低，因为user_id是需要攻击者进行替换才可以成功删除用户，所以风险较低。 

**利用方式：**

1.  攻击者需要一个有效的OpenPLC Runtime用户账户。如果未启用注册限制，攻击者可以轻松创建一个。 
2.  攻击者使用PoC代码中的HTTP请求，构造一个包含恶意JavaScript代码的HTML文件。  
3.  攻击者通过`/edit-user`接口，将构造的HTML文件作为头像上传。需要绕过前端的文件类型检查，比如选择`All Files`。
4.  上传成功后，攻击者可以访问`/static/`目录下的该文件，触发存储型XSS攻击。任何访问该链接的用户都将受到攻击。
5.  攻击者也可以诱导其他用户访问包含恶意文件链接的页面，从而触发XSS攻击。
6.  攻击者还可以利用CSRF漏洞，诱导其他用户点击恶意链接，执行诸如删除用户等操作。

**搜索引擎结果分析：**
虽然搜索引擎结果中没有直接针对 CVE-2025-54962 的具体利用细节，但其他CVE漏洞的相关信息表明，攻击者正在积极利用各种漏洞，包括SharePoint和Ivanti EPMM等。这说明了及时修补漏洞的重要性，避免被恶意利用。

综合来看，该漏洞利用难度较低，影响范围广，需要及时修复。

**项目地址:** [Eyodav/CVE-2025-54962](https://github.com/Eyodav/CVE-2025-54962)

**漏洞详情:** [CVE-2025-54962](https://nvd.nist.gov/vuln/detail/CVE-2025-54962)