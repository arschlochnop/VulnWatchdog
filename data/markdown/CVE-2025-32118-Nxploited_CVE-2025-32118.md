## CVE-2025-32118-CMP-Coming-Soon-Maintenance-RCE

**漏洞编号:** CVE-2025-32118

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** CMP – Coming Soon & Maintenance WordPress 插件

**危害等级:** 严重，可能导致完全控制受影响的 WordPress 站点

**影响版本:** <= 4.1.13

**利用条件:** 需要具有管理员权限的 WordPress 用户账号

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32118 是一个存在于 CMP – Coming Soon & Maintenance WordPress 插件中的远程代码执行漏洞。该漏洞源于插件允许具有高权限的用户上传任意文件类型，包括包含恶意 PHP 代码的 ZIP 文件。攻击者可以利用此漏洞上传包含后门的 WordPress 主题，然后激活该主题以执行任意 PHP 代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有具有管理员权限的 WordPress 用户账号，以便登录到 WordPress 后台。
2.  **生成恶意 ZIP 文件：** 攻击者创建一个包含恶意 PHP 代码的 WordPress 主题 ZIP 文件。POC代码中的`create_zip`函数实现了这一点，它创建了一个包含`nxploitedshell.php`文件的ZIP压缩包，此文件包含允许通过`cmd`参数执行系统命令的PHP代码。
3.  **获取 Nonce：** 攻击者需要获取一个一次性使用的 Nonce 值，用于绕过 WordPress 的 CSRF 保护机制。POC代码中的`get_nonce`函数从插件的管理页面提取此值。
4.  **上传恶意 ZIP 文件：** 攻击者使用获取的 Nonce 值和恶意 ZIP 文件，通过插件的上传功能上传该文件。POC代码中的`upload_zip`函数执行此操作。
5.  **激活主题：** 插件会将上传的ZIP文件解压，攻击者可以通过访问`shell_url = f"{url}/wp-content/plugins/cmp-premium-themes/nxploitedshell/nxploitedshell.php?cmd=whoami"` ，并利用`cmd`参数执行任意系统命令。

**有效性：**

提供的 POC 代码似乎是有效的，因为它模拟了利用此漏洞所需的步骤，包括登录、获取 Nonce 值、上传恶意 ZIP 文件和执行命令。

**投毒风险：**

该 POC 代码本身不包含明显的投毒代码。它会创建一个包含后门的 PHP 文件，但这属于漏洞利用的一部分，而不是隐藏的恶意功能。因此，投毒风险评估为 0%。 所有操作都是明确的，且与漏洞利用的目的相符，没有发现隐藏的或未声明的功能。

**搜索引擎结果分析：**

搜索结果证实了 CVE-2025-32118 漏洞的存在，并指出它允许具有高权限访问权限的攻击者上传危险类型的文件，从而可能危及整个系统。然而，搜索结果中出现了与CVE-2024-32118（Fortinet产品中的OS命令注入漏洞）和CVE-2025-29927 (Next.js 授权绕过)等其他CVE编号的混淆，以及与Kubernetes Ingress Nginx相关的CVE-2025-1974的信息，这些信息与当前漏洞无关。

**项目地址:** [Nxploited/CVE-2025-32118](https://github.com/Nxploited/CVE-2025-32118)

**漏洞详情:** [CVE-2025-32118](https://nvd.nist.gov/vuln/detail/CVE-2025-32118)