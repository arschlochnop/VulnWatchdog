## CVE-2023-50257 - eProsima Fast DDS RTPS 数据包断开连接漏洞

**漏洞编号:** CVE-2023-50257

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** eProsima Fast DDS (SROS2)

**危害等级:** 高危，可导致服务中断

**影响版本:** < 2.13.0, < 2.12.2, < 2.11.3, < 2.10.3, < 2.6.7

**利用条件:** 需要与目标系统处于同一网络邻接范围

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50257 存在于 eProsima Fast DDS 中，该漏洞允许攻击者通过发送特制的 RTPS 数据包，强制断开 Subscriber 与 Publisher 之间的连接，导致拒绝服务。由于用于断开节点连接的数据（`p[UD]`）和 `guid` 值未加密，攻击者可以伪造这些数据包。攻击者首先需要捕获或推断 Publisher 的 ID，然后构造包含伪造断开连接信息的 RTPS 数据包，并将其发送到全局数据空间（`239.255.0.1:7400`）。接收到该数据包的 Subscriber 将会断开与 Publisher 的连接。持续发送此类数据包会阻止 Subscriber 重新连接，从而实现持续的拒绝服务攻击。

**有效性分析：**

从提供的漏洞信息和POC代码来看，此漏洞利用代码**有效**。漏洞库信息和搜索引擎结果均表明，这是一个已知的、可利用的漏洞。POC代码提供了一个 Dockerfile，用于搭建包含漏洞版本的 Fast DDS 环境；README.md 提供了构建和运行环境的步骤，以及利用 `ex.py` 脚本进行攻击的说明。`ex.py` 脚本利用 Scapy 库捕获 RTPS 数据包，解析 GUID 值，然后构造并发送恶意的 DoS 数据包。

**投毒风险分析：**

评估此仓库的投毒风险约为 **10%**。理由如下：

*   **公开的 PoC 目的：** 该仓库明确声明其目的是为了复现 CVE-2023-50257 漏洞，并提供了一个简单的 DoS 攻击 PoC。
*   **代码的可读性：** `ex.py` 脚本的代码相对简单，主要功能是数据包捕获、解析和发送，没有明显的恶意代码。
*   **依赖库：** 使用了 `scapy` 库，这是网络安全分析常用的库，本身没有恶意。
*   **Dockerfile：** Dockerfile 主要用于构建 ROS2 和 Fast DDS 环境，没有发现异常操作。
*   **潜在风险：**  虽然代码本身看起来没有直接的恶意行为，但理论上，攻击脚本可以被修改为执行更具破坏性的操作。例如，可以修改脚本以扫描网络中的其他 DDS 节点，并尝试利用该漏洞进行大规模攻击。或者，可以修改脚本以在目标系统上执行任意代码。因此，在运行此 PoC 时，仍然需要保持警惕，确保在受控环境中进行，并仔细审查代码。

**利用方式：**

1.  **环境搭建：** 使用 Dockerfile 构建包含漏洞版本的 Fast DDS 环境。
2.  **运行 Talker 和 Listener 节点：** 在 Docker 容器中运行 ROS2 Talker 和 Listener 节点，模拟正常的 ROS2 通信。
3.  **数据包捕获：** 运行 `ex.py` 脚本，该脚本会捕获网络中的 RTPS 数据包，特别是来自 Talker 节点的包含 Publisher ID 的数据包。
4.  **GUID 解析：**  `ex.py` 脚本会解析捕获到的数据包，提取 Publisher 的 GUID。
5.  **构造恶意数据包：**  `ex.py` 脚本使用提取到的 GUID 构造包含伪造断开连接信息的恶意 RTPS 数据包。
6.  **发送攻击数据包：**  `ex.py` 脚本将构造的恶意数据包发送到全局数据空间（`239.255.0.1:7400`）。
7.  **拒绝服务：**  接收到恶意数据包的 Listener 节点会断开与 Talker 节点的连接，实现拒绝服务攻击。

**项目地址:** [Jminis/CVE-2023-50257](https://github.com/Jminis/CVE-2023-50257)

**漏洞详情:** [CVE-2023-50257](https://nvd.nist.gov/vuln/detail/CVE-2023-50257)