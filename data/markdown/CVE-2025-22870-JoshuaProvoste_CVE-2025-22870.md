## CVE-2025-22870-golang.org/x/net-HTTP代理绕过

**漏洞编号:** CVE-2025-22870

**漏洞类型:** HTTP代理绕过

**影响应用:** golang.org/x/net/http/httpproxy

**危害等级:** 中危，可能导致SSRF

**影响版本:** < 0.36.0

**利用条件:** 需要配置HTTP_PROXY和NO_PROXY环境变量

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22870 漏洞存在于 golang.org/x/net/http/httpproxy 包中，允许攻击者通过操纵 IPv6 zone ID 来绕过 HTTP 代理。当 NO_PROXY 环境变量设置为例如 "*.example.com" 时，向 "[::1%25.example.com]:80" 的请求会被错误地匹配，从而不会通过代理。提供的POC代码设置了 HTTP_PROXY 和 NO_PROXY 环境变量，然后尝试向一个特制的 IPv6 地址发送请求，验证代理是否被绕过。根据提供的POC代码分析,存在很低的投毒风险,主要风险在于攻击者可能修改目标地址,例如修改为内网地址,测试时需要注意.利用方式是设置特定的环境变量并向包含特定格式的 IPv6 地址发送 HTTP 请求.

**项目地址:** [JoshuaProvoste/CVE-2025-22870](https://github.com/JoshuaProvoste/CVE-2025-22870)

**漏洞详情:** [CVE-2025-22870](https://nvd.nist.gov/vuln/detail/CVE-2025-22870)