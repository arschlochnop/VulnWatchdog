## CVE-2025-57819-FreePBX-身份验证绕过与SQL注入导致RCE

**漏洞编号:** CVE-2025-57819

**漏洞类型:** 身份验证绕过 + SQL注入 + RCE

**影响应用:** FreePBX

**危害等级:** 严重，未经身份验证的攻击者可以执行任意数据库操作和远程代码执行

**影响版本:** < 15.0.66, < 16.0.89, < 17.0.3

**利用条件:** 需要目标FreePBX实例可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57819 影响 FreePBX 15, 16 和 17 版本。漏洞源于对用户提供的数据未进行充分的清理，导致未经身份验证的攻击者能够访问 FreePBX 管理员界面，进而允许任意数据库操作和远程代码执行。

**有效性分析：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用是有效的。证据如下：
*   漏洞库信息明确指出存在身份验证绕过和SQL注入漏洞，最终导致RCE。
*   搜索结果中多个链接（如watchTowr的博客，CISA的Known Exploited Vulnerabilities Catalog）确认该漏洞的存在和被利用。
*   提供的漏洞利用代码（`watchTowr-vs-FreePBX-CVE-2025-57819.py`）是一个检测脚本，如果目标易受攻击，它可以上传一个webshell或添加一个新用户，从而验证漏洞的存在。

**投毒风险分析：**

在提供的POC代码中，存在一定程度的投毒风险，风险占比约为10%。具体分析如下：
*   该POC主要目的是检测漏洞是否存在，webshell是验证漏洞存在的手段，会留下webshell后门, 存在安全风险.

**利用方式分析：**

1.  **身份验证绕过：** 攻击者利用漏洞绕过FreePBX的身份验证机制，直接访问管理员界面。
2.  **SQL注入：** 通过注入恶意的SQL代码，攻击者可以执行任意数据库操作。利用代码中的`INSERT INTO cron_jobs`语句用于创建一个计划任务，该任务会执行攻击者指定的命令。
3.  **远程代码执行（RCE）：**  计划任务执行包含恶意代码的命令，例如，使用`base64 -d`解码一段经过base64编码的PHP代码，并将其写入到Web服务器的Web根目录下，形成webshell，从而实现远程代码执行。如果上传webshell失败，则会尝试添加一个新用户。
4.  **清理（可选）：**  该POC还包含清理webshell以及添加的计划任务的逻辑，但这并不一定能完全清除所有痕迹，也可能存在恶意攻击者利用此清理逻辑来隐藏更深层次的恶意行为。

**项目地址:** [watchtowrlabs/watchTowr-vs-FreePBX-CVE-2025-57819](https://github.com/watchtowrlabs/watchTowr-vs-FreePBX-CVE-2025-57819)

**漏洞详情:** [CVE-2025-57819](https://nvd.nist.gov/vuln/detail/CVE-2025-57819)