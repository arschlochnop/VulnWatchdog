## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，间接可能导致RCE

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本

**利用条件:** 需要满足以下至少一个条件： 1. 启用旧版模式授权。 2. 在“登录用户可以做任何事情”授权模式下选中“允许匿名读取访问”配置。 3. 启用注册功能。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 是一个 Jenkins 中的任意文件读取漏洞，该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能允许将参数中以 '@' 字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞的PoC代码有效。搜索引擎结果中多个条目都提到了该漏洞的严重性以及被利用的可能性。PoC代码实现通过`connect-node`命令和双线程处理来读取目标文件。

**投毒风险：**
PoC代码的投毒风险较低，约为 5%。主要风险可能来自以下几点：
*   **依赖项：**虽然PoC 代码本身只使用了标准库`http.client`, `argparse`,`urllib.parse`, `threading`, `uuid`, `re`, `sys`，不存在引入恶意第三方库的风险，但攻击者可能修改 PoC 使其依赖恶意库。
*   **误用：**该PoC可能被用于非法目的，例如未经授权的访问和数据窃取，这本身不是投毒，但属于PoC被滥用。
*   **篡改：**分发或复制的 PoC 可能被篡改以包含恶意代码。但原始代码本身并没有明显的恶意行为。
总体而言，直接的投毒风险较低，但需要警惕PoC被滥用或修改。

**利用方式：**
1.  **确定目标 Jenkins 实例版本：** 确认目标 Jenkins 实例的版本是否在受影响的范围内（2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **检查访问权限：** 确保目标 Jenkins 实例满足以下至少一个条件：启用旧版模式授权、允许匿名读取访问或启用注册功能。
3.  **运行 PoC 代码：** 使用提供的 PoC 代码，指定目标 Jenkins 实例的 URL 和要读取的目标文件路径。
4.  **分析输出：** PoC 代码将尝试读取指定的文件，并将文件内容打印到控制台。如果成功读取，则说明目标存在漏洞。否则，可能需要检查目标版本、访问权限或 PoC 代码的正确性。
5.  **利用方式详解：**PoC脚本首先构造一个包含`connect-node`命令和目标文件路径的payload。该payload通过HTTP POST请求发送到Jenkins服务器的`/cli?remoting=false`端点。Jenkins服务器解析该请求，并由于漏洞的存在，会将`@`符号后面的文件路径的内容读取出来，并返回给攻击者。PoC脚本使用了双线程来加速利用过程，一个线程负责发送payload，另一个线程负责接收响应。

**项目地址:** [Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability](https://github.com/Praison001/CVE-2024-23897-Jenkins-Arbitrary-Read-File-Vulnerability)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)