## CVE-2020-3452 Cisco ASA/FTD 路径遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用了WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452是Cisco ASA和Firepower Threat Defense (FTD)软件中的一个路径遍历漏洞。由于对HTTP请求中的URL缺乏适当的输入验证，未经身份验证的远程攻击者可以通过构造包含目录遍历序列的HTTP请求，读取目标系统上Web服务文件系统中的任意文件。该漏洞影响启用了WebVPN或AnyConnect功能的设备。提供的POC代码是一个Python脚本，它通过构造包含路径遍历的URL来尝试读取一系列已知的文件。脚本首先指定目标主机，然后循环遍历`FILES`列表中的文件名，构造包含`../`的URL，并发送HTTP GET请求。如果服务器返回200状态码，则将响应内容写入本地文件。 

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，且有公开的POC。提供的POC代码实现了利用该漏洞读取文件的功能，因此是有效的。

**投毒风险：**
提供的代码主要功能是利用路径遍历漏洞读取文件。经过代码分析，没有发现明显的恶意或隐藏的投毒代码。脚本的功能是明确的，即发送请求并保存响应。因此，投毒风险评估为0%。

**利用方式：**
1.  目标设备需要运行受影响的Cisco ASA或FTD软件版本，并且启用了WebVPN或AnyConnect功能。
2.  攻击者使用POC脚本或类似工具，构造包含路径遍历序列（如`../`）的HTTP GET请求，发送到目标设备的Web服务接口。
3.  如果目标设备存在漏洞，它将允许攻击者读取Web服务文件系统中的文件，例如配置文件、HTML页面和其他敏感信息。
4.  攻击者分析读取到的文件，以获取进一步入侵的凭据或其他有价值的信息。

**项目地址:** [grim3/CVE-2020-3452](https://github.com/grim3/CVE-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)