## CVE-2025-31324-SAP NetWeaver Visual Composer-未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统安装有SAP NetWeaver Visual Composer development server，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31324 漏洞存在于SAP NetWeaver Visual Composer Metadata Uploader组件中。由于缺乏适当的授权检查，未经身份验证的攻击者可以上传任意文件，包括恶意可执行文件，到服务器上。

**利用方式：**

1.  攻击者利用漏洞，通过`/VC/metaDataUploader` 路径上传恶意 Python 脚本（例如 `rev.py`，一个反向shell脚本）。`app.py` 脚本中`/VC/metaDataUploader`路由处理文件上传，且未进行任何身份验证或文件类型验证。
2.  上传后，通过访问 `/trigger/<filename>?ip=<attacker_ip>&port=<attacker_port>` 路径触发上传的脚本执行。`app.py`脚本中`/trigger/<filename>`路由会执行上传的`.py`文件，并将攻击者的IP和端口作为参数传递给脚本。
3.  `rev.py` 脚本会尝试连接攻击者指定的IP和端口，建立一个反向shell连接。

**有效性分析：**

POC 代码通过模拟有漏洞的 SAP NetWeaver Visual Composer 环境，展示了未授权文件上传和远程代码执行的过程。代码的结构清晰，通过 Flask 框架搭建了一个简单的 Web 应用，包含文件上传、文件服务和文件触发执行三个核心功能。未经授权的文件上传是漏洞的根本原因，而文件触发执行则将漏洞的危害性提升到远程代码执行级别。结合搜索引擎结果，该漏洞被积极利用，POC代码有效。

**投毒风险分析：**

提供的代码片段中，`app.py` 模拟了存在漏洞的服务，用于接收和执行上传的脚本。`rev.py` 是一个反向 shell 脚本，其本身功能就是建立反向连接，为攻击者提供shell访问权限，不能算作投毒代码。`flag_gen.py`用于生成包含一定熵值的字符串,不是后门或者恶意代码。整个代码仓库未发现明显的投毒行为，但是恶意的使用rev.py，将会是灾难性的。虽然有上传文件限制，只允许上传`.py`文件，但是可以通过修改文件后缀等方式绕过限制，造成更大的危害。综上所述，该仓库中隐藏的投毒代码的风险为0%。

**项目地址:** [harshitvarma05/CVE-2025-31324-Exploits](https://github.com/harshitvarma05/CVE-2025-31324-Exploits)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)