## CVE-2023-29201-xwiki-commons-xml-XSS

**漏洞编号:** CVE-2023-29201

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** xwiki-commons

**危害等级:** 高危，允许攻击者执行任意JavaScript代码，可能导致信息泄露、会话劫持甚至远程代码执行

**影响版本:** 4.2-milestone-1 <= version < 14.6-rc-1

**利用条件:** 需要用户交互，攻击者可以利用评论或其他用户可编辑的页面注入恶意代码。需要目标XWiki实例运行在受影响的版本范围内，且HTML cleaner的"restricted"模式被使用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29201 是 XWiki Commons 中的一个跨站脚本漏洞。受影响的版本使用了存在缺陷的 HTML cleaner "restricted" 模式，该模式未能充分转义所有危险的 HTML 标签和属性，导致攻击者可以注入恶意 JavaScript 代码。攻击者通常通过在评论、wiki 页面或其他用户可编辑的内容中插入恶意脚本来实现攻击。当具有编程权限的用户访问包含恶意代码的页面时，脚本将在该用户的会话上下文中执行，从而允许攻击者执行服务器端代码，影响 XWiki 实例的保密性、完整性和可用性。

根据提供的漏洞利用代码（Jenkinsfile），可以看出这是一个 Jenkins 脚本，用于构建和测试 XWiki Commons 项目。虽然Jenkinsfile 本身不是直接的漏洞利用代码，但它指示了如何构建和测试 xwiki-commons，可能包含用于验证漏洞是否存在的payload。**这里提供的Jenkinsfile代码本身不包含任何明显的恶意投毒代码。**

**有效性：**
根据漏洞描述和搜索结果，确认漏洞的有效性。XWiki官方已确认该漏洞并发布了补丁。利用代码（Jenkinsfile）可能用于自动化测试或构建过程，辅助验证漏洞是否存在。

**利用方式：**
1.  攻击者在 XWiki 页面（如评论）中注入包含 XSS Payload 的恶意代码（例如，使用 `<iframe>` 或其他未被充分过滤的 HTML 标签和属性）。
2.  当具有编程权限的用户访问该页面时，恶意 JavaScript 代码将在该用户的浏览器中执行。
3.  恶意代码可以窃取用户的会话信息、篡改页面内容，甚至利用 XWiki 的编程权限在服务器端执行任意代码。

**投毒风险：**
提供的 Jenkinsfile 代码主要用于构建、测试和质量检查，未发现明显的投毒行为。 脚本的主要目的是自动化构建流程，包括编译代码、运行测试、执行代码质量检查（如 Checkstyle 和 SonarQube）等。它还模拟发布过程。脚本中定义的构建步骤和参数看似合理，与构建 XWiki Commons 项目的常见做法一致。
因此，可以认为 Jenkinsfile 自身被投毒的风险较低（0%）。

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2023-29201_14-5](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2023-29201_14-5)

**漏洞详情:** [CVE-2023-29201](https://nvd.nist.gov/vuln/detail/CVE-2023-29201)