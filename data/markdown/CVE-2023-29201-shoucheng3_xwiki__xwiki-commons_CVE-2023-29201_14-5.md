## CVE-2023-29201-xwiki-commons-XSS

**漏洞编号:** CVE-2023-29201

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** xwiki-commons

**危害等级:** 高危，可导致敏感信息泄露，权限提升，远程代码执行

**影响版本:** >= 4.2-milestone-1, < 14.6-rc-1

**利用条件:** 需要用户交互，攻击者需要诱导具有编程权限的用户访问包含恶意代码的页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29201是XWiki Commons中的一个跨站脚本漏洞。漏洞存在于受限模式的HTML清理器中，该清理器未能正确转义或过滤可能导致JavaScript注入的属性和其他危险的HTML标签。攻击者可以通过在XWiki页面或评论中插入恶意的HTML代码来利用此漏洞。当具有编程权限的特权用户访问包含恶意代码的页面时，恶意JavaScript代码将在用户的会话上下文中执行，从而可能导致服务器端代码执行，影响XWiki实例的保密性、完整性和可用性。

**有效性：**
根据漏洞描述，漏洞利用需要用户交互。只要目标XWiki版本在受影响范围内，且有用户（最好是具有编程权限的用户）访问包含恶意XSS代码的页面，漏洞即可成功利用。漏洞库信息中提到CISA将此漏洞标记为高危且存在POC。

**投毒风险：**
提供的代码是Jenkinsfile，用于自动化构建和测试XWiki Commons项目。它本身不是漏洞利用代码，而是构建流程的配置。但是，如果攻击者能够篡改此Jenkinsfile（例如，通过提交恶意PR），他们可以在构建过程中引入恶意代码。虽然 Jenkinsfile 本身不直接包含漏洞利用代码，但存在通过修改构建配置引入恶意依赖项或执行恶意构建步骤的潜在风险。 构建过程可能会引入隐藏的恶意代码。因此，存在一定的投毒风险，保守估计为10%。

**利用方式：**
1.  攻击者首先需要在XWiki页面或评论中插入包含恶意JavaScript代码的HTML。
2.  恶意HTML代码可能包含`<iframe>`标签或利用HTML属性（例如`onerror`）来执行JavaScript代码。
3.  攻击者诱导具有编程权限的用户访问包含恶意代码的页面。
4.  当用户访问页面时，恶意JavaScript代码将在用户的会话上下文中执行。
5.  恶意代码可以执行服务器端代码，例如，安装后门程序，更改系统设置或窃取敏感数据。

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2023-29201_14-5](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2023-29201_14-5)

**漏洞详情:** [CVE-2023-29201](https://nvd.nist.gov/vuln/detail/CVE-2023-29201)