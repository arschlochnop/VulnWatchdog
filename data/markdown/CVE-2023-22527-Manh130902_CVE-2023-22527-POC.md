## CVE-2023-22527 - Atlassian Confluence RCE

**漏洞编号:** CVE-2023-22527

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22527 是 Atlassian Confluence Data Center 和 Server 中存在的一个模板注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的实例上实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞的POC代码有效。CISA已将此漏洞添加到已知被利用漏洞目录(KEV)，表明该漏洞已被积极利用。

**投毒风险：**
对提供的Python POC代码和相关文件进行分析后，未发现明显的投毒代码。
*   `CVE-2023-22527.py`: 此脚本用于检测 Confluence 版本并发送包含 OGNL 表达式的 POST 请求，以执行任意命令。该脚本本身不包含恶意代码，但如果被利用，可能导致目标系统受损。
*   `CVE-2023-22527.yaml`: 这是一个 Nuclei 模板，用于检测目标系统是否存在此漏洞。它也不包含恶意代码。
*   `README.md`: 这是一个简单的说明文件，不包含任何可执行代码。
虽然该漏洞本身具有高危性，但提供的代码未发现作者隐藏的恶意逻辑，因此投毒风险为 0%。需要注意的是，使用该POC进行测试或攻击具有潜在风险，应在授权环境下进行。

**利用方式：**
1.  **确定目标 Confluence 版本：** POC代码首先尝试获取目标 Confluence 实例的版本信息，以确认其是否在受影响的范围内（8.0.0 <= version < 8.5.4）。
2.  **发送恶意请求：** 如果版本在受影响范围内，POC 将构造一个包含 OGNL 表达式的 POST 请求，发送到 `/template/aui/text-inline.vm` 端点。 OGNL 表达式允许攻击者执行任意 Java 代码。
3.  **命令执行：**  POC代码使用`freemarker.template.utility.Execute`类执行cmd参数指定的命令，命令执行结果通过HTTP Header `X-Cmd-Response`返回。
4.  **利用前提** 攻击者不需要任何身份验证即可发送请求。

**项目地址:** [Manh130902/CVE-2023-22527-POC](https://github.com/Manh130902/CVE-2023-22527-POC)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)