## CVE-2023-25813-Sequelize-SQL注入

**漏洞编号:** CVE-2023-25813

**漏洞类型:** SQL注入

**影响应用:** Sequelize

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 6.19.1

**利用条件:** 需要网络访问，并且应用程序使用了存在漏洞的Sequelize版本和不安全的查询方式

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Sequelize ORM的查询参数处理中，具体是当使用 `replacements` 参数时，参数未被正确转义，导致SQL注入。在提供的POC代码中，`/login` 路由和 `/post` 路由都存在SQL注入漏洞。

**有效性分析：**

*   **`/login` 路由：**  使用了字符串拼接的方式构造SQL查询，直接将用户名和密码拼接到SQL语句中，攻击者可以通过构造包含恶意SQL代码的用户名或密码来执行任意SQL命令，例如绕过身份验证或获取数据库中的敏感信息。
*   **`/post` 路由：**  使用了字符串拼接的方式构造INSERT语句，允许攻击者通过`title`和`content`字段注入恶意SQL代码，进而修改数据库结构或执行其他恶意操作。

**投毒风险分析：**

查看了提供的`app.js`和`package-lock.json`文件。`app.js`文件主要演示了如何利用CVE-2023-25813漏洞，存在明显的SQL注入点，但不存在额外的恶意代码。`package-lock.json`只是依赖包的锁定文件，也没有发现任何可疑之处。因此，该POC代码本身不存在投毒风险。

**利用方式：**

1.  **登录绕过：**  在 `/login` 路由中，攻击者可以在用户名或密码字段中注入SQL代码，例如：`' OR '1'='1`，从而绕过身份验证。
2.  **数据篡改：**  在 `/post` 路由中，攻击者可以在标题或内容字段中注入SQL代码，例如：`'; DROP TABLE Posts; --`，从而删除Posts表。

**总结：**

提供的POC代码有效地演示了CVE-2023-25813漏洞的利用方式，包括登录绕过和数据篡改。代码本身不包含任何投毒内容。应用程序应升级Sequelize版本至6.19.1或更高版本，并避免使用字符串拼接的方式构造SQL查询，应采用参数化查询或预编译语句。

**项目地址:** [sea-middle/cve-2023-25813](https://github.com/sea-middle/cve-2023-25813)

**漏洞详情:** [CVE-2023-25813](https://nvd.nist.gov/vuln/detail/CVE-2023-25813)