## CVE-2024-55591-FortiOS/FortiProxy-身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 严重，可能导致超级管理员权限获取

**影响版本:** FortiOS 7.0.0 <= 7.0.16; FortiProxy 7.0.0 <= 7.0.19, 7.2.0 <= 7.2.12

**利用条件:** 需要网络访问到受影响的FortiOS/FortiProxy设备的WebSocket服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-55591 是一个 FortiOS 和 FortiProxy 中的身份验证绕过漏洞。攻击者可以通过向 Node.js WebSocket 模块发送特制的请求，绕过身份验证并获得超级管理员权限。 

**有效性:**
根据漏洞信息和搜索结果，此漏洞已被积极利用，且 CVSS 评分高达 9.6，表明其严重性。提供的 POC 代码尝试利用 WebSocket 连接，并发送包含用户名和其他信息的特定格式的 Payload。 如果目标设备存在漏洞，则攻击者可以通过此Payload获得超级管理员权限，然后执行任意命令。

**投毒风险:**
阅读POC代码后，代码本身实现了漏洞利用，没有明显的投毒行为。代码存在Debug模式，会打印通信过程中的数据，方便使用者分析。该POC通过WebSocket连接并发送构造的Payload数据，没有发现主动删除日志、植入后门或者篡改系统配置的恶意行为。
但是，需要注意的是，如果成功利用此漏洞，攻击者可以获得超级管理员权限，从而可以进行任意恶意操作，例如植入后门、窃取数据等。因此，在使用此 POC 进行测试时，必须在隔离的环境中进行，并采取适当的安全措施。
总体评估，此 POC 代码本身的投毒风险较低，但是利用此漏洞可能导致严重的后果。因此，在使用时需要谨慎。

**利用方式:**
1.  攻击者首先需要确定目标 FortiOS 或 FortiProxy 设备的 WebSocket 服务是否可访问。
2.  利用提供的 POC 代码，指定目标 IP 地址、端口、用户名和要执行的命令。
3.  POC 代码会建立与目标设备的 WebSocket 连接。
4.  POC 代码会发送精心构造的 Payload，绕过身份验证。
5.  攻击者可以通过发送命令来获得超级管理员权限，并在目标设备上执行任意操作。

**项目地址:** [virus-or-not/CVE-2024-55591](https://github.com/virus-or-not/CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)