## CVE-2025-4404-FreeIPA-权限提升

**漏洞编号:** CVE-2025-4404

**漏洞类型:** 权限提升

**影响应用:** FreeIPA

**危害等级:** 高危，可能导致域管理员权限被窃取

**影响版本:** < 4.12.4

**利用条件:** 需要已存在的域计算机账户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4404 漏洞存在于 FreeIPA 中，允许拥有域计算机账户的攻击者通过创建具有与 REALM 管理员相同 canonical name 的服务，从而提升权限至域管理员。\n\n**利用方式：**\n1.  利用域计算机账户获取 Kerberos 票据（`kinit host/pc1.test.local@TEST.LOCAL -k -t /etc/krb5.keytab`）。\n2.  在 LDAP 中添加服务账户，关键步骤是设置 `krbCanonicalName` 属性为 `admin@REALM`（`ldapadd -H ldap://dc1.test.local ... krbCanonicalName: admin@TEST.LOCAL`）。\n3.  使用 `ipa-getkeytab` 获取该服务账户的 keytab。\n4.  使用该 keytab 请求票据（`kinit --no-request-pac -k -t ./test.keytab test/pc1.test.local@TEST.LOCAL`）。\n5.  成功后，攻击者即可利用管理员权限执行操作，例如使用 `ldapwhoami -H ldap://dc1.test.local` 验证权限。\n\n**有效性：** 提供的POC代码有效，可以利用该漏洞提升权限。根据漏洞描述，FreeIPA 4.12.4之前版本在默认配置下存在此问题。\n\n**投毒风险：** POC 本身没有明显的恶意代码，但存在一定的投毒风险。ldapadd命令和ipa-getkeytab都存在被替换成恶意程序或指向恶意配置文件的风险,此外,该仓储的贡献者可能上传恶意代码分支。 估计投毒风险在10%左右。

**项目地址:** [Cyxow/CVE-2025-4404-POC](https://github.com/Cyxow/CVE-2025-4404-POC)

**漏洞详情:** [CVE-2025-4404](https://nvd.nist.gov/vuln/detail/CVE-2025-4404)