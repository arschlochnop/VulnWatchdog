## CVE-2023-25813-Sequelize-SQL注入

**漏洞编号:** CVE-2023-25813

**漏洞类型:** SQL注入

**影响应用:** Sequelize

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 6.19.1

**利用条件:** 应用程序使用受影响版本的Sequelize，并且使用 replacements 参数构建SQL查询

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25813是Sequelize库中存在的一个SQL注入漏洞。该漏洞源于在处理 replacements 参数时，Sequelize没有正确地对用户输入进行转义，导致攻击者可以通过构造恶意的SQL语句注入到查询中，从而执行未经授权的数据库操作。

**有效性：**

从漏洞库信息和搜索引擎结果来看，此漏洞的危害等级为“CRITICAL”，且POC已公开，说明该漏洞可利用。漏洞利用代码部分，package-lock.json 显示项目 `search_student` 依赖 `sequelize@^6.19.0`，说明存在受影响的版本。

**投毒风险：**

提供的 `package-lock.json` 文件本身不包含恶意代码，但并不能完全排除投毒风险。`package-lock.json` 文件仅仅记录了项目依赖的版本信息。如果作者在其他文件中（例如，JavaScript 代码）存在恶意代码，则仍然存在投毒的可能。

`package-lock.json` 展示了项目所依赖的 npm 包。虽然快速浏览没有发现明显的异常，但仅凭 `package-lock.json` 文件无法断定是否存在投毒行为。需要检查项目中的源代码文件，查看是否存在可疑的或恶意的逻辑。根据目前的`package-lock.json`文件，评估投毒风险为10%，因为无法确定其他代码是否被篡改。

**利用方式：**

根据漏洞描述，攻击者可以通过在 Sequelize 查询的 replacements 参数中注入恶意 SQL 代码来利用此漏洞。攻击者可以修改数据库中的数据，读取敏感信息，甚至执行任意代码。

具体来说，如果应用程序使用以下类似的代码：

```javascript
sequelize.query('SELECT * FROM users WHERE username = :username', {
 replacements: { username: userInput }
});
```

攻击者可以将 `userInput` 设置为类似 `' OR 1=1 --'` 的值，从而绕过身份验证或其他安全检查。

**项目地址:** [platypus-perry03/CVE-2023-25813](https://github.com/platypus-perry03/CVE-2023-25813)

**漏洞详情:** [CVE-2023-25813](https://nvd.nist.gov/vuln/detail/CVE-2023-25813)