## CVE-2024-10914 - D-Link NAS OS 命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS 命令注入

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 20241028 及之前版本

**利用条件:** 需要网络访问，目标设备开启web服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10914 是 D-Link NAS 设备中 account_mgr.cgi 文件的 cgi_user_add 函数存在的一个 OS 命令注入漏洞。攻击者可以通过操纵 'name' 参数来执行任意系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞的 PoC 已经公开，并且在野利用情况可能存在。PoC 代码的功能完整，包括漏洞验证和利用（反弹 shell）。经验证，POC代码是有效的.

**投毒风险：**
PoC 代码主要包含以下功能：
1.  漏洞验证: 通过注入包含`echo` 命令的payload验证漏洞是否存在，并将输出与预期值进行比较。
2.  反弹Shell: 提供多种反弹shell的类型，包括Bash, Python, Netcat, PowerShell，允许用户选择。
3.  命令执行: 允许执行任意命令。
代码中存在一定风险，比如在输入IP和端口时，可能会造成错误，但是没有发现明显的恶意投毒代码，风险主要来自使用者对命令的滥用。但是不排除作者在代码中添加了不易察觉的后门，因此投毒风险评定为 5%。

**利用方式：**
1.  **漏洞验证：** 使用 PoC 代码中的 `hedefi_yoxla` 函数，通过发送包含特定字符串的请求到目标设备的 `/cgi-bin/account_mgr.cgi` 路径，检查返回的响应中是否包含该字符串，以此判断漏洞是否存在。
2.  **反弹 Shell：**  使用 `reverse_shell` 函数，允许攻击者选择反弹 shell 的类型（Bash、Python、Netcat、PowerShell），并指定 IP 地址和端口。PoC 代码会生成相应的命令，并通过 `exploit_komandasi` 函数注入到目标设备。
3.  **任意命令执行：** 使用 `exploit_et` 函数，允许攻击者在目标设备上执行任意命令。该函数提供了一个简单的交互式 shell 界面，用户可以输入命令，PoC 代码会将其注入到目标设备并显示执行结果。为了简化操作，还内置了 `ls`, `cd`, `cat`, `pwd`, `download` 等命令。
4.  **漏洞位置:** 漏洞位于`/cgi-bin/account_mgr.cgi?cmd=cgi_user_add`，name参数存在漏洞。

**项目地址:** [silverxpymaster/CVE-2024-10914-Exploit](https://github.com/silverxpymaster/CVE-2024-10914-Exploit)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)