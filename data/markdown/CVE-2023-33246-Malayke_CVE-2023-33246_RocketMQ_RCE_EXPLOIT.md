## CVE-2023-33246-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-33246

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 5.1.0

**利用条件:** RocketMQ NameServer、Broker 或 Controller 组件暴露在公网，且未进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-33246 是 Apache RocketMQ 中的一个远程代码执行漏洞。根据漏洞信息和搜索结果，该漏洞是由于 RocketMQ 的某些组件（NameServer、Broker、Controller）暴露在公网且缺乏权限验证，攻击者可以通过更新配置功能或伪造 RocketMQ 协议内容来执行任意命令，获得服务器的控制权限。

**有效性:**
提供的 POC 代码 `CVE-2023-33246_RocketMQ_RCE_EXPLOIT.py` 通过 socket 连接到目标 RocketMQ 服务，构造包含恶意命令的 payload 并发送，从而实现远程代码执行。根据搜索结果，该漏洞已经被积极利用，POC 代码的有效性较高。

**投毒风险:**
查看提供的 POC 代码，该脚本主要功能是构造并发送恶意 payload，执行指定的命令。经过分析，未发现明显的投毒代码，例如下载执行恶意文件或篡改系统配置等操作。因此，认为该仓库中存在作者隐藏的投毒代码的概率较低，约为 0%。

**利用方式:**
1.  **目标确定:** 确定目标 RocketMQ 服务的 IP 地址和端口（默认端口可能为 9876）。
2.  **Payload 构造:** 使用 POC 脚本，指定要执行的命令。POC 脚本会将命令嵌入到特定的 RocketMQ 协议格式中，构造恶意的 payload。
3.  **发送 Payload:** POC 脚本通过 socket 连接到目标 RocketMQ 服务，并将构造的 payload 发送过去。
4.  **命令执行:** 如果目标 RocketMQ 服务存在漏洞且未进行修复，它将解析并执行 payload 中的命令，从而实现远程代码执行。

**项目地址:** [Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT](https://github.com/Malayke/CVE-2023-33246_RocketMQ_RCE_EXPLOIT)

**漏洞详情:** [CVE-2023-33246](https://nvd.nist.gov/vuln/detail/CVE-2023-33246)