## CVE-2024-38820 - Spring Framework DataBinder Locale Bypass

**漏洞编号:** CVE-2024-38820

**漏洞类型:** 数据绑定绕过

**影响应用:** Spring Framework

**危害等级:** 低危，可能导致数据篡改

**影响版本:** Spring Framework 5.3.x (before 5.3.40), 6.0.x (before 6.0.24), 6.1.x (before 6.1.13)

**利用条件:** 需要应用使用Spring Framework DataBinder，并且配置了`disallowedFields`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38820 漏洞存在于 Spring Framework 的 DataBinder 组件中。该漏洞是由于 CVE-2022-22968 的修复方案中使用了 `String.toLowerCase()` 方法进行大小写不敏感的匹配，但该方法在不同的 Locale 下表现不同。例如，在土耳其语 Locale (tr_TR) 下，`ADMINID`.toLowerCase() 的结果是 `adminıd`，而不是 `adminid`，从而导致 `disallowedFields` 的保护机制被绕过。

**有效性：**
提供的 PoC 代码是有效的。它演示了如何在特定 Locale（例如 tr_TR）下，利用大小写转换的差异绕过 `disallowedFields` 的限制，从而修改本应受到保护的字段。

**投毒风险：**
PoC 代码本身看起来没有明显的投毒风险。它只是一个用于演示漏洞的示例。所有代码都易于阅读和理解，没有发现恶意行为或隐藏的后门代码。因此，投毒风险为 0%。

**利用方式：**
1.  应用程序必须使用受影响版本的Spring Framework，并且使用`DataBinder`配置了`disallowedFields`来保护某些字段。
2.  攻击者需要确定应用程序使用的Locale或者能够控制Locale设置为土耳其语 (tr_TR)或其他受影响的Locale。
3.  攻击者通过构造包含大小写混合或特定Locale下转换不同的字段名称的HTTP请求，例如使用`ADMINID`而不是`adminId`，来绕过`disallowedFields`的限制。
4.  如果成功，攻击者可以修改本应受到保护的字段的值，从而可能导致权限提升或其他安全问题。

**项目地址:** [kadamnayan/POC-CVE-2024-38820](https://github.com/kadamnayan/POC-CVE-2024-38820)

**漏洞详情:** [CVE-2024-38820](https://nvd.nist.gov/vuln/detail/CVE-2024-38820)