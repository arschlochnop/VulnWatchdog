## CVE-2024-28995 - SolarWinds Serv-U 目录遍历漏洞

**漏洞编号:** CVE-2024-28995

**漏洞类型:** 目录遍历

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，允许未经身份验证的远程攻击者读取主机上的敏感文件

**影响版本:** <= 15.4.2 HF 1

**利用条件:** 目标系统运行SolarWinds Serv-U，且受影响版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是一个存在于SolarWinds Serv-U中的目录遍历漏洞(CVE-2024-28995)。

**有效性：**

提供的Python POC代码 `CVE-2024-28995.py` 看起来是有效的。代码尝试通过构造包含目录遍历序列的URL来读取服务器上的文件。 它尝试读取多个常见文件，例如`Serv-U-StartupLog.txt`，`/etc/passwd`和`win.ini`。POC代码还检查响应内容，以确认是否成功读取了目标文件（例如，检查是否存在"root:"、"bin:x:" 等字符串以确认是否读取到`/etc/passwd`文件）。搜索结果也表明该漏洞已被积极利用。

**投毒风险：**

经过分析提供的Python脚本，`requirements.txt`和`README.md`文件，没有发现任何明显的投毒迹象。该脚本的目的是利用目录遍历漏洞，没有发现恶意代码或后门。`requirements.txt` 只列出了 `requests`, `colorama` 和 `urllib3` 这些常用的python库。因此，投毒风险为0%。

**利用方式：**

利用方式如下：

1.  **确定目标：** 确定运行SolarWinds Serv-U且版本<=15.4.2 HF 1的目标服务器。
2.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`/?InternalDir=/./../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`
3.  **发送请求：** 使用HTTP GET请求将恶意URL发送到目标服务器。
4.  **分析响应：** 如果漏洞存在，服务器将返回请求的文件内容。检查返回的内容以确认漏洞是否成功利用。

POC代码中使用了多个路径，尝试读取不同的文件，提高了利用成功率。

该漏洞允许未经身份验证的远程攻击者读取服务器上的任意文件，可能会泄露敏感信息，例如用户名、密码、配置文件等。

**项目地址:** [gotr00t0day/CVE-2024-28995](https://github.com/gotr00t0day/CVE-2024-28995)

**漏洞详情:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)