## CVE-2023-7028 - GitLab 弱密码恢复机制漏洞

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制漏洞

**影响应用:** GitLab

**危害等级:** 高危，可能导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例版本受影响，且未启用双因素认证或使用LDAP登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-7028 存在于 GitLab 的密码重置功能中。攻击者可以通过在密码重置请求中提供两个不同的邮箱地址（受害者邮箱和攻击者邮箱），从而将密码重置邮件发送到攻击者的邮箱，最终实现账户接管。

**漏洞利用方式：**
1. 攻击者访问 GitLab 的密码重置页面。
2. 攻击者在密码重置请求中，同时填写受害者的邮箱地址和攻击者自己的邮箱地址。
3. GitLab 服务器验证不严谨，会将密码重置邮件发送到攻击者的邮箱。
4. 攻击者通过邮件中的链接重置受害者的密码，从而控制受害者的账户。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，该 POC 代码有效。漏洞利用代码模拟了上述攻击流程，通过构造包含两个邮箱地址的 POST 请求来触发密码重置。

**投毒风险：**
分析提供的 POC 代码，未发现明显的恶意代码或后门。POC 代码主要功能是利用 GitLab 的密码重置漏洞，没有发现额外执行系统命令、上传文件或其他恶意行为的代码。但是，任何代码都存在一定的风险，例如依赖库的潜在安全问题。因此投毒风险较低，评估为1%。这个评估是主观的，因为对代码的解释和理解会因人而异。


**项目地址:** [RandomRobbieBF/CVE-2023-7028](https://github.com/RandomRobbieBF/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)