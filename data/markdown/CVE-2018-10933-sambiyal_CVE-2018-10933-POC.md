## CVE-2018-10933-libssh身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程命令执行

**影响版本:** 0.6 - 0.7.5, 0.8.0 - 0.8.3

**利用条件:** 目标服务器运行受影响的libssh版本并且允许网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933是libssh服务器端状态机中的一个漏洞，存在于0.7.6之前和0.8.4之前的版本中。恶意客户端可以在未先执行身份验证的情况下创建通道，从而导致未经授权的访问。

**有效性：**
提供的POC代码看起来有效。它使用`paramiko`库直接发送`SSH2_MSG_USERAUTH_SUCCESS`消息，绕过正常的身份验证流程。搜索引擎结果也证实了该漏洞的存在和利用方式。

**投毒风险：**
查看提供的POC代码`libsshBypass.py`，代码功能简单直接，就是利用漏洞绕过身份验证并执行`id`命令。`README.md`文件也只是简单说明，没有隐藏恶意代码的迹象。因此，该仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  建立到目标服务器的SSH连接。
2.  启动`paramiko`传输层。
3.  发送`SSH2_MSG_USERAUTH_SUCCESS`消息，模拟成功身份验证。
4.  打开一个会话。
5.  执行任意命令（示例中为`id`）。
6.  读取命令输出。

**漏洞原理：**
libssh在服务器端状态机中，在身份验证完成之前错误地处理了`SSH2_MSG_USERAUTH_SUCCESS`消息，导致攻击者可以伪造身份验证成功，而无需提供任何凭据。

**项目地址:** [sambiyal/CVE-2018-10933-POC](https://github.com/sambiyal/CVE-2018-10933-POC)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)