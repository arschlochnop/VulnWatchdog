## CVE-2025-53770-Microsoft SharePoint Server远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行，控制服务器

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问，目标系统存在漏洞且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞评估：**

基于提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下评估：

*   **有效性：** 提供的POC代码是有效的。该代码通过向目标SharePoint服务器发送特制的HTTP POST请求，利用反序列化漏洞在服务器上执行代码。POC代码本身设计为无害的，旨在验证漏洞的存在，通过在SharePoint ToolBox widget中注入一个marker来判断目标是否易受攻击。如果服务器响应中找到该marker，则表明目标存在漏洞。

*   **投毒风险：** 该代码仓库的投毒风险极低（0%）。提供的代码主要是用于扫描漏洞是否存在，其核心功能是发送一个包含特定XML Payload的HTTP请求，并在响应中查找特定的marker。虽然实际利用中该Payload可以包含恶意代码，但提供的PoC代码本身只包含无害的marker。

*   **利用方式：**

1.  **漏洞原理：** CVE-2025-53770 是一个由于在本地部署的 Microsoft SharePoint Server 中反序列化不可信数据而导致的远程代码执行漏洞。
2.  **攻击过程：** 攻击者通过向`/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送特制的HTTP POST请求来触发此漏洞。该请求包含一个经过GZIP压缩和BASE64编码的XML payload。 XML payload 中包含一个`System.DelegateSerializationHolder`对象，攻击者可以利用此对象执行任意代码。
3.  **Payload结构：** Payload 包含一个`Scorecard:ExcelDataSet` 标签,该标签利用 `CompressedDataTable` 属性接收经过压缩和编码的数据。
4.  **RCE实现：** 攻击者可以在payload中嵌入恶意代码，例如 PowerShell 命令，从而在 SharePoint 服务器上执行任意代码。

*   **总结：**

CVE-2025-53770 是一个严重的安全漏洞，影响 Microsoft SharePoint Server。攻击者可以利用此漏洞在未经授权的情况下远程执行代码。 建议尽快应用 Microsoft 提供的安全更新。

**项目地址:** [hazcod/CVE-2025-53770](https://github.com/hazcod/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)