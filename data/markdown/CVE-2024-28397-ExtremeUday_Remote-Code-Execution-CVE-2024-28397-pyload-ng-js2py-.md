## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入

**影响应用:** js2py (pyload-ng)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标pyload-ng实例的/run_code端点可访问，并已知用户名和密码（或可注册）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397是js2py 0.74版本及之前版本中js2py.disable_pyimport()组件存在的一个问题，允许攻击者通过精心制作的API调用执行任意代码。该漏洞允许攻击者逃逸js2py沙箱，并在目标系统上执行任意命令。利用方式是，首先注册并登录pyload-ng实例，然后利用POC代码中的JavaScript payload，该payload通过`Object.getOwnPropertyNames`等方法获取Python对象引用，并找到`subprocess.Popen`类，最终执行反弹shell的命令。根据代码分析，没有发现明显的投毒代码。代码逻辑主要是利用漏洞，实现反弹shell的功能。

**项目地址:** [ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-](https://github.com/ExtremeUday/Remote-Code-Execution-CVE-2024-28397-pyload-ng-js2py-)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)