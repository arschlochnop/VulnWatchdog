## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例运行，且攻击者可以发送HTTP请求到该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163是Request-Baskets 1.2.1及更早版本中的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过`api/baskets/{name}`组件构造恶意API请求，从而访问内部网络资源和敏感信息。 

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞是有效的。 搜索引擎结果显示，存在多个PoC利用代码，表明该漏洞已被广泛研究。PoC代码通过创建basket，然后修改basket的forward_url，使其指向内部网络地址，从而实现SSRF。 

**投毒风险分析：**
分析提供的PoC代码`CVE-2023-27163.py`，其主要功能是利用SSRF漏洞进行内部端口扫描。代码逻辑清晰，未发现明显的恶意代码或后门。但依然存在轻微的投毒风险, 例如端口列表文件存在加入恶意端口的风险, 攻击者可以利用扫描结果进一步攻击内网服务。README.md文件未发现异常。

**利用方式分析：**
1.  **创建Basket：** 使用PoC脚本首先需要在目标Request-Baskets实例上创建一个新的basket，获得token。
2.  **修改Forward URL：**  PoC脚本利用PUT请求修改basket的`forward_url`，将其设置为攻击者想要访问的内部网络地址。利用`proxy_response`参数可以获取内部服务的响应，`insecure_tls`参数可以忽略证书错误。
3.  **触发请求：**  通过访问创建的basket的URL，触发Request-Baskets实例向内部网络地址发起请求。  
4.  **端口扫描:** PoC代码主要目的为端口扫描,判断内网端口是否开启。

总而言之，该PoC代码主要利用SSRF漏洞进行内网探测，未发现明显的恶意代码，但仍然需要谨慎使用，防止被用于非法用途。

**项目地址:** [theopaid/CVE-2023-27163-Request-Baskets](https://github.com/theopaid/CVE-2023-27163-Request-Baskets)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)