## CVE-2024-3094-xz-utils-后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 目标系统使用受影响的 xz-utils 版本，并且 OpenSSH 链接到 liblzma 和 systemd

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是 xz-utils 库中的一个供应链后门漏洞。恶意代码被插入到 liblzma 库的构建过程中，该库被 OpenSSH 使用。该后门允许攻击者绕过 SSH 身份验证并执行任意代码。 

**有效性：**
提供的漏洞利用代码实际上是威胁情报报告和 IOC 列表，用于检测和缓解该漏洞，而非直接利用漏洞的代码。漏洞的有效性在于受影响的 xz-utils 版本确实包含恶意代码，允许未经授权的访问。

**投毒风险：**
该仓库主要包含漏洞信息、IOC 指标和缓解措施。虽然可以用于安全研究，但直接利用后门的代码并未包含在内。尽管如此，仍然存在轻微的投毒风险（10%），原因如下：
1.  报告中的信息可能被攻击者用于改进其攻击方法。
2.  如果用户不小心，可能错误地修改或使用 IOC 列表中的内容，导致误报或配置错误。

**利用方式：**
1.  **供应链投毒：** 攻击者通过篡改 xz-utils 的构建过程，将恶意代码插入到 liblzma 库中。
2.  **SSH 身份验证绕过：** 受感染的 liblzma 库修改了 OpenSSH 的行为，允许攻击者绕过身份验证。
3.  **远程代码执行：** 成功绕过身份验证后，攻击者可以在目标系统上以 root 权限执行任意代码。

简单来说，漏洞利用的关键在于构建时植入的后门代码，而非提供的这些文件。 提供的文件更多的是分析和检测的辅助工具。 攻击者需要做的就是找到存在后门的版本，并通过SSH连接，利用后门绕过验证。

**项目地址:** [24Owais/threat-intel-cve-2024-3094](https://github.com/24Owais/threat-intel-cve-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)