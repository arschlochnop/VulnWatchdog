## CVE-2017-10004

**漏洞编号:** CVE-2017-10004

**漏洞类型:** Solaris Kernel权限提升

**影响应用:** Solaris Operating System

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 10 和 11

**利用条件:** 需要高权限用户登录Solaris系统

**POC 可用性:** 否

**投毒风险:** 95%

## 详情

根据提供的漏洞信息，CVE-2017-10004是Oracle Sun Systems Products Suite (Solaris组件)中的一个漏洞，影响Solaris 10和11。该漏洞允许具有高权限的攻击者通过登录Solaris系统来完全控制系统。CVSS评分高达6.7，表明这是一个严重的安全问题。

**有效性：**
根据已提供信息，没有找到直接针对CVE-2017-10004的POC代码。提供的Dockerfile和README.md似乎与CVE-2017-1000486相关，这是一个不同的漏洞，影响Tomcat环境。因此，提供的POC代码对于CVE-2017-10004无效。搜索引擎结果也主要指向漏洞描述和缓解措施，没有可用的利用代码。

**投毒风险：**
提供的Dockerfile文件显示了构建Tomcat镜像的过程，虽然没有直接利用CVE-2017-10004漏洞，但仍可能存在投毒风险。例如，Dockerfile中可能会包含恶意软件、后门程序或配置不当，导致镜像被恶意利用。由于是从第三方获取的Dockerfile, 无法验证其安全性，投毒风险较高。该Dockerfile执行了移除Tomcat默认webapps的操作，并复制了名为`showcase.war`的文件到Tomcat的webapps目录。虽然这些操作本身没有问题，但如果`showcase.war`文件包含恶意代码，则会导致安全问题。README.md指向了github的仓库地址，如果github仓库内容被篡改，则会存在很高的投毒风险。综上，本仓库存在的投毒风险为95%。

**利用方式：**
CVE-2017-10004的利用方式需要高权限用户首先登录到目标Solaris系统。成功利用此漏洞可导致Solaris系统的完全控制。由于漏洞细节没有公开，因此无法提供更具体的利用步骤。只能确定是内核相关的漏洞。

总而言之，提供的漏洞利用代码与CVE-2017-10004不相关，但该Dockerfile自身可能存在投毒风险。CVE-2017-10004需要高权限用户登录Solaris系统才能利用，成功利用可以完全控制系统。


**项目地址:** [cved-sources/cve-2017-1000486](https://github.com/cved-sources/cve-2017-1000486)

**漏洞详情:** [CVE-2017-10004](https://nvd.nist.gov/vuln/detail/CVE-2017-10004)