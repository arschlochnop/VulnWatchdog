## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c中。攻击者可以利用此漏洞将权限从应用程序提升到Linux内核级别。漏洞利用无需用户交互，但需要安装恶意本地应用程序或利用网络应用中的其他漏洞。

**有效性：**

提供的PoC代码库看起来是有效的。它包含构建利用程序所需的Android.mk和Application.mk文件，以及一些C源代码文件（cve_2019_2215.c、dac.c、kernel_rw.c、seccomp.c、selinux.c）。README.md文件描述了如何构建和使用该漏洞利用程序，并提供了指向其他相关资源的链接，例如Project Zero的漏洞分析报告。该项目针对特定设备(Huawei P20lite)及其Android版本，表明已经过验证和调整。

**投毒风险：**

评估投毒风险时，我们需要分析提供的PoC代码的内容。代码库中存在潜在的风险，因为其功能是绕过安全机制(SELinux),如果作者在代码中隐藏了恶意行为（例如，在提权后安装后门或收集用户信息），那么风险就会增加。代码中使用了libsepol绕过SELinux，这本身并不是恶意行为，但可能会被滥用。项目描述中提到了“The exploit makes all SELinux types permissive so it might allow other apps to bypass SELinux.”。综合考虑，投毒风险较低，估计为10%。该数字反应POC的开发者可能在利用过程中植入后门的可能性。

**利用方式：**

1.  **漏洞触发：** 通过精心构造的Binder IPC调用触发`binder.c`中的use-after-free漏洞。
2.  **内存布局控制：** 通过内存分配和释放操作，控制释放后内存的内容，以便后续的利用。
3.  **提权：** 利用use-after-free漏洞，覆盖内核数据结构，修改进程的权限信息（例如，将进程的UID设置为0，从而获得root权限）。
4.  **SELinux绕过：**  使用libsepol库，使得SELinux策略变为permissive，允许提权后的进程执行特权操作。或者直接修改内核中关于SELinux策略的数据。
5.  **Payload执行：** 在获得root权限后，执行任意payload，例如安装后门程序。

**项目地址:** [willboka/CVE-2019-2215-HuaweiP20Lite](https://github.com/willboka/CVE-2019-2215-HuaweiP20Lite)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)