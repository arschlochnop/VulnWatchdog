## CVE-2023-0386 Linux Kernel OverlayFS 特权提升漏洞

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 特权提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户权限提升

**影响版本:** Linux kernel 6.2-rc6 (以及可能存在的其他受影响版本，需要进一步验证)

**利用条件:** 需要本地用户权限，并开启 OverlayFS

**POC 可用性:** 是 (根据搜索结果)

**投毒风险:** 2%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-0386 是 Linux 内核 OverlayFS 子系统中存在的一个权限提升漏洞。该漏洞允许本地用户利用 OverlayFS 的不当权限处理，将具有 capabilities 的 setuid 文件从 nosuid 挂载点复制到另一个挂载点，从而获得未经授权的访问权限并提升其在系统上的权限。

**有效性：**
根据搜索结果，漏洞利用代码是存在的，并且被多个安全厂商提及。由于提供漏洞利用代码只有`README.md`文件，无法验证漏洞的真实利用效果，需要完整的 POC 代码才能验证其有效性。

**投毒风险：**
提供的漏洞利用代码只包含一个 `README.md` 文件，内容仅为 CVE 编号，无法进行投毒分析。假设存在完整的漏洞利用代码，则投毒风险较低，原因如下：

*   漏洞利用代码通常较为复杂，容易被发现潜在的恶意行为。
*   该漏洞本身是权限提升漏洞，利用目的是获取 root 权限，如果加入恶意代码，可能会增加利用难度，甚至导致利用失败。
*   安全研究人员通常会对漏洞利用代码进行严格审查，以确保其安全性。
*   但仍然不能排除存在一些不明显的投毒方式，比如在成功提权后执行恶意操作。所以，即便只是一个简单的README文件，依然有被篡改，被植入恶意链接的可能性。因此，综合考虑，投毒风险定为2%。

**利用方式：**
1.  攻击者利用OverlayFS创建一个overlay文件系统。
2.  攻击者复制一个具有capabilities的setuid文件到overlay文件系统中。
3.  由于OverlayFS的权限处理不当，攻击者可以绕过权限检查，执行该setuid文件，从而获得root权限。

**优先级排序：**
搜索引擎结果提供了漏洞利用的相关信息和链接，漏洞库信息提供了漏洞的描述和受影响的版本，漏洞利用代码（仅 `README.md`）无法提供具体的利用方式或验证信息，因此排序为：搜索引擎结果 > 漏洞库信息 > 漏洞利用代码。


**项目地址:** [letsr00t/CVE-2023-0386](https://github.com/letsr00t/CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)