## CVE-2025-53770 SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** Microsoft SharePoint Enterprise Server 2016; Microsoft SharePoint Server 2019; Microsoft SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标系统运行受影响的 SharePoint Server 版本，且攻击者能够通过网络访问 SharePoint Server。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过向 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送特制的请求，利用此漏洞在服务器上执行任意代码。该漏洞利用涉及构造包含恶意序列化对象的 XML payload，并将其作为 `MSOTlPn_DWP` 参数的值传递给目标 URL。PoC 脚本 `CVE-2025-53770-Checker.sh` 旨在检测目标 SharePoint 服务器是否存在此漏洞。该脚本构造一个包含恶意序列化数据的 XML payload，并将其通过 POST 请求发送到目标服务器的 ToolPane.aspx 页面。脚本通过检查服务器响应是否包含预期的特征字符串来判断目标是否存在漏洞。由于该脚本的目的是验证漏洞的存在，因此它包含验证漏洞的后门代码，但这不属于投毒代码。PoC代码中静态XML数据中包含了硬编码的`Sharepoint_CVE-2025-53770_Vulnerability_CheckEr_By_BehnamVanda`字符串，该字符串用做验证漏洞的标志。投毒风险评估为10%，因为虽然脚本的主要目的是验证漏洞，但攻击者可以修改脚本，将恶意代码注入到构造的 XML payload 中，从而利用经过修改的脚本攻击其他系统。

**利用方式：**

1.  攻击者构造包含恶意序列化对象的 XML payload。
2.  攻击者向目标 SharePoint 服务器的 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx` 发送包含恶意 payload 的 POST 请求，并将 payload 作为 `MSOTlPn_DWP` 参数的值传递。
3.  SharePoint Server 反序列化 payload 中的数据，导致在服务器上执行任意代码。

**项目地址:** [behnamvanda/CVE-2025-53770-Checker](https://github.com/behnamvanda/CVE-2025-53770-Checker)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)