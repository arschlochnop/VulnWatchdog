## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可读取敏感信息

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark Gateway)

**利用条件:** 目标Check Point安全网关已连接到互联网，并启用了远程访问VPN或移动访问软件 Blades。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-24919是一个存在于Check Point Quantum Gateway、Spark Gateway 和 CloudGuard Network中的信息泄露漏洞。攻击者可以通过发送特制的HTTP POST请求到`/clients/MyCRL`端点，利用路径遍历读取目标设备上的任意文件，如`/etc/shadow`等敏感文件。漏洞利用代码通过构造包含`aCSHELL/../../../../../../../etc/shadow`的payload，尝试读取shadow文件。由于漏洞存在路径遍历，理论上可以读取任意文件。 

**漏洞利用方式:**

1.  **目标确认:** 确认目标Check Point安全网关是否启用远程访问VPN或移动访问软件 Blades。
2.  **构造Payload:**  使用包含路径遍历的payload，例如`aCSHELL/../../../../../../../etc/shadow`。
3.  **发送请求:**  向目标URL（`target + '/clients/MyCRL'`）发送POST请求，并附带构造的payload。
4.  **分析响应:**  检查响应内容，如果成功读取到`/etc/shadow`或其他敏感文件，则表明漏洞存在。

**投毒风险评估:**

代码主要功能是发送包含路径遍历的POST请求以尝试读取文件，并检查响应内容以确定漏洞是否存在。 代码中存在 `-f` 参数允许用户自定义payload文件，这增加了潜在的风险。恶意用户可以通过该参数传递包含恶意指令的payload，理论上存在一定的投毒风险，但是由于代码本身只是读取文件内容，没有执行相关指令，因此实际的投毒风险很小。 
分析后认为投毒风险约为1%。

**项目地址:** [geniuszly/CVE-2024-24919](https://github.com/geniuszly/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)