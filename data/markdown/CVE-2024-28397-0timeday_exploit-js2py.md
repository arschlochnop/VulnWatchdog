## CVE-2024-28397-js2py-Sandbox-Escape

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要目标系统运行存在漏洞的js2py版本，且允许执行JavaScript代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-28397 存在于 js2py 0.74 版本及之前的版本中。js2py 是一个将 JavaScript 代码转换为 Python 代码并在 Python 解释器中执行的库。该漏洞源于 `disable_pyimport()` 方法的实现缺陷，该方法本应阻止 JavaScript 代码访问 Python 对象。但是，由于该方法未能正确阻止访问，攻击者可以绕过此限制，获得对 JavaScript 环境中 Python 对象的引用，从而允许在主机上执行任意代码。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞的利用是有效的。PoC代码旨在通过js2py执行JavaScript代码，利用沙箱逃逸漏洞来执行任意命令。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。该代码主要包含利用漏洞的JavaScript Payload和执行Payload的PHP脚本。JavaScript Payload目的是通过访问受限制的Python对象来执行命令。PHP脚本用于向目标发送POST请求，其中包含带有恶意JavaScript代码的JSON数据。综上，投毒风险评估为0%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 Payload，利用 `js2py.disable_pyimport()` 的缺陷绕过沙箱限制。
2.  恶意 JavaScript 代码通过内置的 Python 对象引用，获取执行系统命令的能力。
3.  攻击者通过网络请求（例如 POST 请求）将 Payload 发送到目标系统上运行的 js2py 应用程序。
4.  js2py 执行 Payload 中的恶意 JavaScript 代码，从而在目标系统上执行任意命令，例如反弹 shell。

该漏洞的关键在于 `disable_pyimport()` 方法未能正确阻止 JavaScript 代码访问 Python 对象。攻击者可以利用这一缺陷，通过 JavaScript 代码获得 Python 对象的引用，并最终执行任意代码。

**项目地址:** [0timeday/exploit-js2py](https://github.com/0timeday/exploit-js2py)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)