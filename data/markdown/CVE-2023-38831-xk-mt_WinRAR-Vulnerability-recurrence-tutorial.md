## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。该漏洞允许攻击者通过构造恶意的ZIP压缩包，在用户尝试查看压缩包内的文件时执行任意代码。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞已被广泛利用，POC代码的存在也表明其有效性。多个安全厂商和研究人员都对此漏洞进行了分析并提供了相应的缓解措施。

**投毒风险分析：**
提供的POC代码包含以下文件：
*   `README.md`: 漏洞复现教程，包含漏洞信息和参考链接。
*   `执行命令.bat`: 一个简单的批处理文件，用于执行`calc.exe`（计算器程序），用于演示代码执行。
*   `文本.txt`: 包含一个URL地址。
*   `生成压缩包.py`: 一个Python脚本，用于生成包含漏洞的ZIP压缩包。

该脚本的主要功能是：
1.  创建临时目录，并将`执行命令.bat`复制到该目录。
2.  复制`文本.txt`文件到另一个目录。
3.  将上述两个目录打包成ZIP文件。
4.  修改ZIP文件中的文件名，利用漏洞的原理。
从代码本身来看，该脚本并没有明显的恶意代码，但是存在一定的投毒风险。
*   执行命令.bat： 虽然只是简单的calc.exe，但如果攻击者替换成其他恶意命令，则可能造成更大的危害。
*   脚本的依赖： 该脚本依赖Python环境，攻击者可能会通过修改脚本，引入恶意的Python依赖包，从而实现投毒。

综合来看，该仓库中存在一定的投毒风险，但不高。主要是因为演示的`执行命令.bat`内容比较简单，容易被识别。如果使用者直接运行此仓库的代码，有可能会被植入恶意程序。因此，投毒风险评定为10%。

**利用方式：**
1.  攻击者构造一个恶意的ZIP压缩包，该压缩包包含一个良性文件（例如，图片文件`文本.txt`）和一个与该文件同名的文件夹。
2.  该文件夹包含一个恶意可执行文件（例如，`执行命令.bat`并更名为`文本.txtA.cmd`）。
3.  当用户使用受影响的WinRAR版本打开该ZIP压缩包，并尝试查看良性文件时，WinRAR会错误地执行该文件夹中的恶意可执行文件，从而导致任意代码执行。

**项目地址:** [xk-mt/WinRAR-Vulnerability-recurrence-tutorial](https://github.com/xk-mt/WinRAR-Vulnerability-recurrence-tutorial)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)