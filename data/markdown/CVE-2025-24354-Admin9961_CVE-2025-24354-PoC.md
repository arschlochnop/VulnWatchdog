## CVE-2025-24354-imgproxy-SSRF

**漏洞编号:** CVE-2025-24354

**漏洞类型:** SSRF

**影响应用:** imgproxy

**危害等级:** 中危，可能暴露内网服务信息

**影响版本:** < 3.27.2

**利用条件:** imgproxy服务未配置IMGPROXY_ALLOW_LOOPBACK_SOURCE_ADDRESSES为false或版本低于3.27.2

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24354是imgproxy中的一个服务器端请求伪造（SSRF）漏洞。由于imgproxy未正确阻止对0.0.0.0地址的请求，攻击者可以利用此漏洞向内部服务发起请求，即使IMGPROXY_ALLOW_LOOPBACK_SOURCE_ADDRESSES设置为false。

**有效性：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。POC代码通过构造包含0.0.0.0地址的URL，并将其作为imgproxy的目标地址，来测试是否存在SSRF漏洞。

**投毒风险：**

对提供的POC代码进行分析，发现其主要功能是枚举内部服务，没有发现明显的恶意代码。代码主要功能包括：

*   定义了默认扫描的端口、路径和协议。
*   规范化目标URL，生成包含0.0.0.0的URL。
*   通过requests库发送HTTP/HTTPS请求。
*   根据响应状态码和内容判断服务是否可达。

虽然代码本身没有明显的投毒行为，但使用者可以修改`DEFAULT_PORTS`，`DEFAULT_PATHS`，`DEFAULT_SCHEMES`变量,引入恶意代码，或者在扫描时对特定服务进行恶意操作，比如尝试利用已知漏洞。

综合评估，此POC代码本身存在投毒的概率非常低，大约为1%。

**利用方式：**

1.  攻击者利用存在漏洞的imgproxy服务。
2.  攻击者构造一个恶意的URL，该URL的目标地址为`0.0.0.0`加上内部服务的端口和路径（例如：`http://0.0.0.0:8080/`）。
3.  攻击者将构造的URL发送给imgproxy服务，使其向内部服务发起请求。
4.  如果imgproxy服务存在漏洞，它将允许向`0.0.0.0`地址发起请求，从而暴露内部服务的信息。攻击者根据HTTP响应判断端口是否开放，如果开放则可以进一步探测服务类型和版本。
5.  攻击者可以利用此漏洞探测内部网络中的敏感服务，例如数据库、管理后台等。如果内部服务存在其他漏洞，攻击者可以通过SSRF漏洞进一步利用这些漏洞。

**项目地址:** [Admin9961/CVE-2025-24354-PoC](https://github.com/Admin9961/CVE-2025-24354-PoC)

**漏洞详情:** [CVE-2025-24354](https://nvd.nist.gov/vuln/detail/CVE-2025-24354)