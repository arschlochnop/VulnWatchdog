## CVE-2025-1094-PostgreSQL-SQL注入到RCE

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标系统存在漏洞版本的PostgreSQL，并且存在可利用的SQL注入点，WebSocket服务也需要开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1094是一个存在于PostgreSQL的SQL注入漏洞。该漏洞是由于 `PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()` 和 `PQescapeStringConn()` 函数在处理特定编码时未能正确转义引号语法导致的。 攻击者首先利用SQL注入漏洞，读取服务器上的敏感文件（例如/etc/passwd）并将其保存到服务器上的一个可访问的位置。 然后，攻击者会劫持一个WebSocket连接，并利用该连接在服务器上执行任意代码，从而获得反向shell。该PoC中，虽然有执行系统命令的操作，需要用户自行替换IP和端口，但整体逻辑符合漏洞描述，可以判定为有效的PoC。投毒风险评估为10%，主要风险点在于需要用户替换REVERSE_IP和REVERSE_PORT，如果用户不小心使用了错误的IP地址或端口，可能会将反向shell发送到错误的地址。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-1094](https://github.com/B1ack4sh/Blackash-CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)