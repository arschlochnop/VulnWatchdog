## CVE-2024-27499 - Bagisto v1.5.1 存储型XSS

**漏洞编号:** CVE-2024-27499

**漏洞类型:** 存储型XSS (Cross-Site Scripting)

**影响应用:** Bagisto

**危害等级:** 中危，可能导致管理员会话劫持、恶意页面跳转等

**影响版本:** 1.5.1

**利用条件:** 需要用户账户，并能够上传包含恶意代码的PNG文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27499 存在于 Bagisto v1.5.1 版本中，是一个存储型XSS漏洞。攻击者可以通过在产品评论中上传包含恶意 JavaScript 代码的 PNG 文件来利用此漏洞。当管理员打开包含恶意代码的评论图片时，恶意 JavaScript 代码将在管理员的浏览器中执行。\n\n**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞是有效的。POC代码清晰地展示了如何利用 PNG 文件上传功能注入 XSS 代码。
\n**投毒风险：**
提供的POC代码中，仅仅包含一个简单的 `alert(1)` 用于验证 XSS 是否成功执行，并未发现存在其他恶意代码或者后门，因此投毒风险较低。该存储库旨在演示漏洞，而不是进行恶意攻击。投毒风险评估为0%。
\n**利用方式：**
1.  攻击者登录 Bagisto 平台的账户。
2.  找到一个商品，并提交商品评论。
3.  在评论中上传一个特制的 PNG 文件，该文件实际上是一个包含 HTML 和 JavaScript 代码的文本文件，被伪装成 PNG 文件。
4.  管理员查看该评论时，恶意 JavaScript 代码在管理员的浏览器上下文中执行。
5.  攻击者可以利用这个 XSS 漏洞进行会话劫持、页面重定向等恶意行为。

**项目地址:** [auspicious7/CVE-2024-27499](https://github.com/auspicious7/CVE-2024-27499)

**漏洞详情:** [CVE-2024-27499](https://nvd.nist.gov/vuln/detail/CVE-2024-27499)