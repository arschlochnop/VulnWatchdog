## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致本地权限提升和拒绝服务

**影响版本:** < 6.0~rc1

**利用条件:** 需要User Namespaces支持。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-2588 是 Linux 内核 cls_route 过滤器实现中的一个 Use-After-Free 漏洞。当具有句柄值 0 的旧过滤器从哈希表中删除之前被释放时，就会发生此漏洞。漏洞利用代码显示，通过创建句柄为0的过滤器，然后替换它，可以触发 double-free，如果启用了 CONFIG_NET_CLS_ACT，则会导致 route4_filter 对象和 route4_filter->exts.action 对象上的 double-free。这种double free可能导致提权。鉴于代码来自公开的漏洞报告和利用示例，并且只包含标准利用代码，因此投毒风险较低，但也需要人工审计。搜索引擎结果也印证了该漏洞的存在性和提权的可能性。漏洞利用方式为本地用户利用，首先创建一个句柄为0的 cls_route 过滤器，然后通过再次创建同句柄过滤器来替换旧过滤器，触发 use-after-free 漏洞，最终导致 double free。


**项目地址:** [Igr1s-red/CVE-2022-2588](https://github.com/Igr1s-red/CVE-2022-2588)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)