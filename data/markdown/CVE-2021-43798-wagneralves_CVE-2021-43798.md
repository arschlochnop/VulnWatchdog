## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0

**利用条件:** 需要Grafana实例运行在受影响的版本，且存在可访问的插件目录

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798 是一个 Grafana 中的目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 Grafana 8.0.0-beta1 到 8.3.0 版本。漏洞位于 `/public/plugins/<plugin ID>/` 路径下，攻击者可以通过构造包含目录遍历字符（如 `../`）的 URL 来访问受限目录之外的文件。

**有效性：**
提供的POC代码 `ExploitGrafana.sh` 的目的是通过构造包含目录遍历的URL来读取指定文件。 它通过循环遍历 Grafana 实例中的已知插件列表，并尝试使用每个插件 ID 构建恶意 URL。如果服务器返回 200 OK 状态码，则认为漏洞存在，并打印响应内容。根据提供的漏洞信息和搜索结果，该PoC代码大概率有效，能够在未修复的Grafana实例上实现任意文件读取。

**投毒风险：**
查看`ExploitGrafana.sh`脚本，该脚本的功能是利用已知的漏洞读取文件，没有发现任何尝试在目标系统上安装后门或者执行恶意操作的代码。`README.md` 文件只是提供了漏洞的描述和利用方式，也没有包含任何恶意代码。因此，该仓库的投毒风险较低，为0%。

**利用方式：**
1.  确定目标 Grafana 实例的版本是否在受影响范围内（8.0.0-beta1 到 8.3.0）。
2.  使用 PoC 脚本 `ExploitGrafana.sh`，指定目标 Grafana 实例的 URL (`-h` 参数) 和要读取的文件路径 (`-f` 参数)。
3.  脚本会尝试使用不同的插件 ID 构造恶意 URL，并发送请求。
4.  如果漏洞存在，且目标文件可读，脚本将打印文件的内容。

**项目地址:** [wagneralves/CVE-2021-43798](https://github.com/wagneralves/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)