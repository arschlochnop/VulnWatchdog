## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab

**危害等级:** 高危，可导致账户完全控制，包括管理员账户

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，攻击者能够通过网络访问目标，并且知晓目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 是一个 GitLab CE/EE 的账号接管漏洞。根据漏洞描述和搜索结果，攻击者可以在用户忘记密码时，通过在密码重置请求中提供两个邮箱地址，将密码重置邮件发送到未验证的邮箱地址，从而控制目标账户。利用方式是通过修改密码重置流程，利用未验证的邮箱地址接收重置链接。提供的POC代码是使用Docker搭建一个存在漏洞的GitLab环境，方便进行漏洞验证和学习。虽然没有发现明显的恶意代码，但使用任何来源的代码都需要谨慎，需要仔细检查代码是否存在恶意行为。特别是`docker-compose.yml` 中涉及到了SMTP的配置， 如果配置不当可能导致敏感信息泄露或者被恶意利用。因此投毒风险评定为10%.

**项目地址:** [Trackflaw/CVE-2023-7028-Docker](https://github.com/Trackflaw/CVE-2023-7028-Docker)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)