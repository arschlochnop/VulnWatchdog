## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户才能触发，依赖插件或主题以特定方式使用WP_Query

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21661是WordPress核心中WP_Query类中由于不正确的输入清理导致的SQL注入漏洞。漏洞存在于WordPress 5.8.3之前的版本。攻击者需要具备高权限，并且需要精心构造的恶意SQL查询，通过特定的插件或主题才能触发此漏洞。根据漏洞信息，攻击复杂度较高。漏洞利用代码（Dockerfile）主要用于搭建存在漏洞的WordPress环境（5.8.2版本），方便漏洞复现和验证，而非直接的漏洞利用payload。因此，这个Dockerfile本身不构成直接的攻击，而是用于创建一个易受攻击的环境。存在的风险是，如果这个Dockerfile被恶意修改，例如添加后门代码，那么基于这个Dockerfile构建的WordPress实例就会被植入后门。Dockerfile的内容主要是安装和配置WordPress 5.8.2，以及一些PHP扩展和Apache模块。虽然看起来没有明显的恶意代码，但是不能排除在安装过程中或者配置过程中插入恶意代码的可能性。例如，替换WordPress的安装包，或者修改WordPress的核心文件。但是总的来说直接投毒的可能性比较低，因为代码非常规范，而且大部分操作都是标准的安装步骤。考虑到其构建环境的特殊性，恶意代码难以隐藏，因此投毒风险评估为10%。根据搜索引擎结果和漏洞库信息，该漏洞的利用方式主要是通过构造恶意的SQL查询，利用WP_Query中的缺陷执行未授权的数据库操作。虽然漏洞的利用需要高权限用户，但一旦成功，可能导致敏感数据泄露，甚至远程代码执行。

**项目地址:** [0x4E0x650x6F/Wordpress-cve-CVE-2022-21661](https://github.com/0x4E0x650x6F/Wordpress-cve-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)