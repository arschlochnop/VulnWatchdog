## CVE-2024-5932 - GiveWP Unauthenticated PHP Object Injection to Remote Code Execution

**漏洞编号:** CVE-2024-5932

**漏洞类型:** PHP Object Injection

**影响应用:** GiveWP WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.14.1

**利用条件:** 需要目标网站安装GiveWP插件且版本低于或等于3.14.1，允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-5932是GiveWP WordPress插件中的一个PHP对象注入漏洞，未经身份验证的攻击者可以通过反序列化'give_title'参数中的不可信输入来注入PHP对象。如果存在可利用的POP链，攻击者可以远程执行代码并删除任意文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞POC已经存在并且被广泛讨论，该漏洞被多个厂商收录，证明了该漏洞的有效性。从检索结果来看，很多厂商都已发布了该漏洞的利用方式以及缓解方案。因此，提供的POC代码具有较高的有效性。

**投毒风险：**
从提供的POC代码来看，该脚本的主要功能是利用漏洞进行远程代码执行。脚本中包含以下模块：requests (发送HTTP请求), BeautifulSoup (解析HTML), Faker (生成随机数据), urllib.parse (解析URL), hashlib (哈希), time, sys, rich_click。并没有发现明显恶意代码。同时, 作者已在Github上开源该POC。该POC没有发现任何明显的投毒行为, 经过人工审核该POC投毒概率小于1%。

**利用方式：**
利用方式主要分为以下步骤：
1.  攻击者发送包含恶意序列化PHP对象的HTTP请求到存在漏洞的WordPress网站，该请求的目标是GiveWP插件。
2.  恶意PHP对象通过`give_title`参数传递。
3.  GiveWP插件在处理请求时，由于未正确验证或清理输入，导致PHP对象被反序列化。
4.  如果反序列化的对象包含可利用的POP链，攻击者可以执行任意代码。
5.  攻击者可以利用该漏洞执行诸如创建或修改文件、执行系统命令等恶意操作，最终实现远程代码执行。

总而言之，该漏洞利用依赖于PHP对象注入和POP链的结合，攻击者通过精心构造的序列化数据，最终达到远程控制服务器的目的。

**项目地址:** [EQSTLab/CVE-2024-5932](https://github.com/EQSTLab/CVE-2024-5932)

**漏洞详情:** [CVE-2024-5932](https://nvd.nist.gov/vuln/detail/CVE-2024-5932)