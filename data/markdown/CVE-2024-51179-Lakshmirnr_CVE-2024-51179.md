## CVE-2024-51179 - Open 5GS NFV Denial of Service

**漏洞编号:** CVE-2024-51179

**漏洞类型:** Denial of Service (DoS)

**影响应用:** Open 5GS

**危害等级:** 高危，可能导致网络服务中断

**影响版本:** 2.7.1

**利用条件:** 需要知道UPF的IP地址、端口和SEID，或者能够拦截用户平面流量以获取这些信息。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-51179是Open 5GS v2.7.1版本中存在的一个拒绝服务漏洞。攻击者可以通过构造恶意的PFCP数据包并大量发送到User Plane Function (UPF)的特定端口，导致UPF崩溃，进而影响Session Management Function (SMF)的正常运行，最终导致网络服务中断。 

**有效性评估:**

提供的POC代码使用Python的`scapy`库构造并发送恶意的PFCP数据包。代码中定义了UPF的IP地址、端口和SEID，并构造了包含特定IE类型（150）和标志位的PFCP消息。通过循环发送大量这样的数据包，攻击者可以快速耗尽UPF的资源，导致其崩溃。根据漏洞描述和代码逻辑，POC代码是有效的。

**投毒风险评估:**

仔细分析了提供的POC代码，发现其中没有明显的恶意代码或后门。代码主要功能是构造和发送PFCP数据包，虽然可能存在细微的混淆或误导，但没有发现作者故意植入的能够执行任意代码或泄露敏感信息的片段。投毒风险较低，但不能完全排除（比如利用相似域名进行钓鱼）。

**利用方式分析:**

1.  **信息收集:** 攻击者需要获取目标UPF的IP地址、PFCP端口（通常是8805）和SEID。可以通过网络扫描、流量分析或者其他方式获取这些信息。
2.  **数据包构造:** 使用`scapy`库，攻击者可以构造包含恶意负载的PFCP数据包。
3.  **流量洪泛:** 攻击者将构造好的恶意数据包大量发送到目标UPF的端口，使其不堪重负，最终导致服务崩溃。
4.  **拒绝服务:** UPF崩溃后，新的PDU会话将无法建立，从而影响用户的正常网络使用。

**缓解措施:**

*   升级到已修复漏洞的Open 5GS版本。
*   部署入侵检测系统（IDS）或入侵防御系统（IPS），以检测和阻止恶意PFCP流量。
*   实施流量整形和速率限制，以防止攻击者发送大量数据包。

**项目地址:** [Lakshmirnr/CVE-2024-51179](https://github.com/Lakshmirnr/CVE-2024-51179)

**漏洞详情:** [CVE-2024-51179](https://nvd.nist.gov/vuln/detail/CVE-2024-51179)