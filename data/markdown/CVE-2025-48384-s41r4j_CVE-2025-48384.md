## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户clone包含恶意配置的仓库，并执行包含submodule的操作，例如git submodule update --init --recursive

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 是 Git 中一个高危漏洞，源于 Git 在处理配置文件时，对包含回车符 (CR) 的配置值的处理不一致。当 Git 读取配置值时，它会删除任何尾部的回车符和换行符 (CRLF)。但是，当写入配置条目时，如果值包含尾部的 CR，则不会被引用，导致在稍后读取配置时 CR 丢失。该漏洞利用方式为：

1.  **恶意仓库构建：** 攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件包含一个 submodule 的路径，该路径以回车符结尾（例如，`submodule_path\r`）。
2.  **符号链接：** 攻击者在仓库中创建一个符号链接，将修改后的 submodule 路径（由于回车符被删除，变为 `submodule_path`）指向 `.git/hooks/post-checkout` 目录。
3.  **恶意钩子：** 攻击者在 submodule 中包含一个可执行的 `post-checkout` 钩子脚本，该脚本包含恶意代码。
4.  **诱导用户 clone：** 攻击者诱导受害者克隆该恶意仓库，并执行 `git submodule update --init --recursive` 命令。
5.  **代码执行：** 当执行 `git submodule update` 时，由于符号链接的存在，`post-checkout` 钩子脚本将被执行，从而导致任意代码执行。

**有效性评估：**
根据漏洞信息和搜索结果，该漏洞确实存在，并且有公开的 PoC。提供的 Dockerfile 用于构建存在漏洞的 Git 版本（2.47.2），从而创建一个可用于验证漏洞的环境。README.md 文件详细解释了该漏洞，佐证了漏洞的存在。因此，该PoC有效。

**投毒风险评估：**
Dockerfile 仅用于构建易受攻击的 Git 环境，LICENSE 文件采用 MIT 许可，较为宽松，存在一定的风险。README.md 只是漏洞说明。整体评估投毒风险较低，约为10%。风险主要来源于LICENSE协议。

**利用方式总结：**
利用该漏洞需要攻击者精心构造一个恶意 Git 仓库，并诱导受害者克隆和执行特定命令。攻击的复杂性在于需要理解 Git 的配置处理机制和钩子机制，并巧妙地利用符号链接来实现代码执行。攻击者需要利用git config的解析缺陷，在submodule路径后添加\r字符，使submodule被clone到错误的位置，并使用软链接，将错误位置链接到.git/hooks目录下，在post-checkout阶段执行恶意代码

**项目地址:** [s41r4j/CVE-2025-48384](https://github.com/s41r4j/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)