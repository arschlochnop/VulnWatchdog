## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1903/1909 和 Windows Server, version 1903/1909

**利用条件:** 目标系统开启SMB服务，且未使用缓解措施（禁用压缩）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft SMBv3协议处理特定请求时存在远程代码执行漏洞。该漏洞存在于Windows 10版本1903和1909以及Windows Server版本1903和1909中。漏洞是由于SMBv3压缩功能中的不当处理造成的。攻击者可以利用此漏洞通过发送特制的SMBv3数据包到目标服务器来执行任意代码。

**有效性：**
提供的POC代码 `eternalghost.py` 用于检测目标服务器是否存在CVE-2020-0796漏洞。它通过发送一个协商请求，检查服务器是否支持SMB 3.1.1协议以及是否启用了压缩功能。如果两个条件都满足，则目标很可能易受攻击。但是，此POC仅用于检测，不包含实际的漏洞利用代码，其他搜索引擎结果显示存在利用代码可实现远程代码执行。

**投毒风险：**
该存储库主要包含检测脚本和一个README文件。LICENSE采用MIT许可证，允许自由使用。`eternalghost.py` 脚本功能较为简单，主要是检查SMB版本和压缩是否启用，本身不太可能包含恶意代码。README文件主要提供漏洞信息和缓解措施。但是，任何代码库都存在一定程度的风险，例如，攻击者可能会修改脚本以进行信息收集或进行其他恶意活动。因此，将投毒风险评估为10%。

**利用方式：**
1.  攻击者利用该漏洞需要向目标系统发送特制的SMBv3请求。
2.  该请求利用SMBv3协议中的压缩功能存在的漏洞，触发缓冲区溢出。
3.  通过缓冲区溢出，攻击者可以在目标系统上执行任意代码。
4.  攻击者可以通过远程代码执行获取系统控制权。

**项目地址:** [awareseven/eternalghosttest](https://github.com/awareseven/eternalghosttest)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)