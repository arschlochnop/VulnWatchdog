## CVE-2025-29306-FoxCMS-代码执行

**漏洞编号:** CVE-2025-29306

**漏洞类型:** 代码执行

**影响应用:** FoxCMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.2.5

**利用条件:** 需要网络访问目标FoxCMS站点

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29306 漏洞存在于 FoxCMS v1.2.5 版本中，允许未经身份验证的远程攻击者通过 `index.html` 页面的 case display 功能执行任意代码。利用方式如下：

1.  **漏洞分析：** 该漏洞属于代码注入漏洞（CWE-94）。攻击者通过构造包含恶意代码的请求发送到目标服务器。
2.  **利用方式：** POC 脚本 `CVE-2025-29306.sh` 接受两个参数：目标 URL 和要执行的命令。脚本使用 `urllib.parse.quote` 对命令进行 URL 编码，然后将其作为 `id` 参数附加到目标 URL。最终通过 `curl` 发送请求。
3.  **命令执行：** 服务器端接收到请求后，由于未对 `id` 参数进行充分的过滤或验证，导致 URL 解码后的恶意代码被执行。
4. **输出提取**: 脚本使用 `xmllint` 解析返回的HTML,并提取XPath `/html/body/header/div[1]/div[2]/div[1]/ul`位置的内容，然后去除 HTML 标签并输出命令执行结果。
5.  **有效性：** 根据漏洞描述和提供的 POC 代码，该漏洞利用方式有效，因为 CVSS 评分为 9.8，表明其严重性。
6.  **投毒风险：**
    *  POC 脚本本身主要功能是利用漏洞，未发现明显的恶意代码。
    *  投毒风险主要在于：脚本依赖 `curl` 和 `xmllint` 命令，如果这些命令被恶意替换，可能导致安全问题。
    *  另一风险点在于，脚本使用 `python3` 执行 URL 编码，攻击者可能利用此点，结合二次注入绕过waf。
    * README.md中存在引导用户使用fofa搜索目标的语句，存在一定风险，可能被滥用。
    *  综合评估，投毒风险较低，约为10%。

**项目地址:** [verylazytech/CVE-2025-29306](https://github.com/verylazytech/CVE-2025-29306)

**漏洞详情:** [CVE-2025-29306](https://nvd.nist.gov/vuln/detail/CVE-2025-29306)