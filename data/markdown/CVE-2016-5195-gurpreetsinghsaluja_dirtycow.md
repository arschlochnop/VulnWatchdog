## CVE-2016-5195 - Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户获取 root 权限

**影响版本:** 2.x to 4.x before 4.8.3

**利用条件:** 本地用户访问，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195 (Dirty COW) 是一个 Linux 内核中的竞争条件漏洞，存在于 mm/gup.c 文件中。该漏洞允许本地用户利用写时复制 (COW) 机制的不正确处理，向只读内存映射写入数据，从而提升权限。具体利用方式如下：

1.  **漏洞原理：** 当多个线程同时读写同一块内存区域时，可能发生竞争条件。Dirty COW 漏洞利用了 COW 机制的缺陷，在内核尝试进行写时复制时，恶意线程可以修改只读内存映射。
2.  **利用步骤：**
    *   攻击者首先找到一个目标只读文件。
    *   攻击者使用 `mmap` 系统调用将此文件映射到内存。
    *   攻击者创建一个线程，该线程使用 `madvise` 系统调用告诉内核放弃相关的内存页，从而触发 COW。
    *   攻击者创建一个或多个线程并发地写入映射的内存区域。由于竞争条件，这些写入操作可能会绕过只读保护，直接修改文件内容。
3.  **影响：** 成功利用此漏洞的攻击者可以修改任何只读文件，包括系统二进制文件，从而获得 root 权限。

**有效性：** 提供的漏洞利用代码描述了该漏洞的利用过程，表明该漏洞是有效的。

**投毒风险：** 提供的 README.md 文件主要用于介绍 Dirty COW 漏洞以及相关的技术概念，没有直接提供可执行的漏洞利用代码。但是，该文件包含从外部网站（imgur.com、wikimedia.org、geeksforgeeks.org等）引用的图片。如果这些图片托管的网站被攻破或者存在恶意内容，那么查看该 README.md 文件的用户可能会受到攻击，存在一定的风险。此外，由于利用代码可能从其他地方获得，因此可能存在被篡改的风险，并执行恶意操作。但就该文件本身而言，投毒风险较低。根据这个README.md分析，投毒风险约为10%。主要的风险来源于外部链接和可能存在的篡改。

**利用方式总结：** 利用该漏洞主要通过竞争条件和写时复制机制，实现在只读内存区域写入数据，进而修改系统文件，提升权限。该漏洞利用需要一定的并发编程知识和对 Linux 内核内存管理机制的了解。

**项目地址:** [gurpreetsinghsaluja/dirtycow](https://github.com/gurpreetsinghsaluja/dirtycow)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)