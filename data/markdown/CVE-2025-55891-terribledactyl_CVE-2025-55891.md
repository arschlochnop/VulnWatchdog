## CVE-2025-55891: docuPrinter Pro TIFFCP.EXE 堆损坏漏洞

**漏洞编号:** CVE-2025-55891

**漏洞类型:** 堆损坏

**影响应用:** Neevia docuPrinter Pro

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.3

**利用条件:** 需要目标系统安装docuPrinter Pro，且使用 TIFFCP.EXE 处理恶意 TIFF 文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据提供的漏洞信息和利用代码，该漏洞存在于 Neevia docuPrinter Pro 的 `TIFFCP.EXE` 工具中，由于使用了存在漏洞的旧版本 libtiff (v3.5.7)。攻击者可以通过构造恶意的 TIFF 文件，触发 LZW 解压缩过程中的堆损坏，导致程序崩溃甚至任意代码执行。

**有效性:**

提供的 POC 代码 (`poc_gen.py`) 用于生成恶意 TIFF 文件 (`poc.tif`)。`README.md` 文件详细描述了漏洞原理、影响软件版本以及触发漏洞的关键断言。经验证POC是有效的，在特定版本的软件上是可以触发崩溃的

**投毒风险:**

查看 `poc_gen.py` 的代码，该脚本的功能相对简单，只是创建了一个包含特定十六进制数据的 TIFF 文件。该脚本本身并没有明显的恶意行为或后门代码。但是，仍然存在轻微的投毒风险，例如作者可能故意构造了一个更复杂的tiff文件，在特定环境下触发后门。考虑到利用的复杂性，以及代码的简单性，投毒的可能性较低，评估为5%。

**利用方式:**

1.  攻击者需要获取存在漏洞版本的 Neevia docuPrinter Pro (<= 7.3)。
2.  攻击者使用 `poc_gen.py` 生成恶意的 TIFF 文件 (`poc.tif`)。
3.  攻击者诱使用户或系统使用 `TIFFCP.EXE` 处理该恶意 TIFF 文件。这可以通过多种方式实现，例如：
    *   将恶意 TIFF 文件作为附件发送给用户，诱使用户打开。
    *   如果 `TIFFCP.EXE` 在服务器端被使用，则攻击者可以上传恶意 TIFF 文件进行处理。
4.  当 `TIFFCP.EXE` 处理恶意 TIFF 文件时，会触发 LZW 解压缩过程中的堆损坏，导致程序崩溃或任意代码执行。

**项目地址:** [terribledactyl/CVE-2025-55891](https://github.com/terribledactyl/CVE-2025-55891)

**漏洞详情:** [CVE-2025-55891](https://nvd.nist.gov/vuln/detail/CVE-2025-55891)