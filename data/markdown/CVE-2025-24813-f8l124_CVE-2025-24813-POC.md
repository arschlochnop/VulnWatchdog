## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要Tomcat开启了Default Servlet的写入功能(默认关闭),支持partial PUT(默认开启), 应用使用了Tomcat基于文件的session持久化，并且包含可用于反序列化攻击的库。或者满足敏感文件可被上传的条件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个Apache Tomcat中的路径等价漏洞，允许未经身份验证的攻击者在特定条件下执行任意代码。根据漏洞库信息和搜索结果，该漏洞的利用依赖于以下几个关键条件：

1.  **Default Servlet 开启写入 (writes enabled for the default servlet)**：默认情况下，Tomcat的Default Servlet的写入功能是禁用的，如果管理员手动开启了该功能，则会增加漏洞被利用的风险。
2.  **支持 Partial PUT (support for partial PUT)**：Tomcat默认开启了对Partial PUT请求的支持，这是漏洞利用的前提条件。
3.  **特定应用场景**：
    *   **远程代码执行 (RCE)**：需要应用程序使用Tomcat基于文件的session持久化，并且包含一个可以被反序列化攻击利用的库。
    *   **信息泄露/恶意内容注入**：需要存在一个用于公共上传的目标URL，以及位于其子目录的安全敏感上传目标URL，攻击者需要知道安全敏感文件的名称，并且也通过partial PUT上传这些文件。

**漏洞利用方式：**

1.  **发送 Partial PUT 请求**：攻击者通过发送特制的 Partial PUT 请求，利用Tomcat处理文件路径时的缺陷，将恶意JSP文件上传到服务器上的特定位置。
2.  **绕过路径检查**：通过构造包含内部点(`.`)的文件名，攻击者可以绕过某些路径检查，将文件写入到目标目录。
3.  **触发代码执行/信息泄露**：
    *   **RCE**：上传包含恶意反序列化payload的JSP文件，当Tomcat尝试加载并反序列化session数据时，触发远程代码执行。
    *   **信息泄露/恶意内容注入**：利用路径等价，覆盖或修改服务器上的敏感文件。

**POC有效性：**

提供的POC代码是一个非破坏性的概念验证，旨在演示漏洞的存在。该POC上传一个无害的JSP文件 (`proof.jsp`) 并尝试访问它，以验证是否可以执行任意代码。从readme可以看出来，这个POC的重点是验证漏洞，而不会做任何破坏。

**投毒风险：**

虽然POC本身声明是无害的，但仍然存在一定的投毒风险。作者有可能在代码中隐藏了一些恶意逻辑，例如：

1.  **不明显的后门代码**：尽管`proof.jsp`本身是无害的，但Python脚本可能包含其他代码，用于在服务器上植入后门或执行其他恶意操作。风险较低，因为代码相对简单且经过了检查，但不能完全排除。
2.  **依赖项投毒**：脚本可能依赖于存在已知漏洞或包含恶意代码的第三方库。但根据描述，需要的依赖非常少。
3.  **元数据欺骗**：作者可能在仓库的元数据（例如，提交历史、作者信息）中隐藏了恶意信息，以误导安全研究人员。风险极低。

综合分析，该仓库存在投毒代码的概率较低，但仍然建议在受控环境中仔细审查代码后再使用。

**结论：**
总的来说，CVE-2025-24813是一个高危漏洞，需要及时修复。虽然提供的POC代码旨在演示漏洞，但使用前务必进行安全审查，以防潜在的投毒风险。

**项目地址:** [f8l124/CVE-2025-24813-POC](https://github.com/f8l124/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)