## CVE-2025-60751 - Geographiclib Stack Buffer Overflow

**漏洞编号:** CVE-2025-60751

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Geographiclib

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.5.1

**利用条件:** 需要能够运行GeoConvert二进制文件，可能需要特定的输入格式触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Geographiclib库的GeoConvert程序中，当GeoConvert接收到精心构造的输入时，会发生栈缓冲区溢出。漏洞原因是程序没有正确验证内部索引，导致栈上的越界写入。攻击者可以通过覆盖返回地址来劫持程序的控制流，并利用ROP链执行任意代码。PoC代码利用了ret2libc技术。  

**漏洞利用方式：**

1.  **构造恶意输入：** 攻击者需要构造一个特定的输入，该输入能够触发GeoConvert程序中的栈缓冲区溢出。
2.  **覆盖返回地址：** 通过溢出，攻击者可以覆盖栈上的返回地址。
3.  **ROP链执行：** 将返回地址覆盖为ROP链的起始地址，ROP链通常包括一系列gadget，用于执行任意代码，例如调用`system("/bin/sh")`来获得shell。
4.  **利用ASLR绕过：** 由于地址空间布局随机化（ASLR）的存在，攻击者需要找到libc库和其他必要gadget的基地址。这可以通过信息泄露漏洞或爆破来完成。PoC代码中假设了这些地址，在实际利用中需要根据目标环境进行调整。

**投毒风险评估：**

PoC代码本身实现了漏洞利用，但存在轻微的投毒风险，主要是因为以下几点：

*   **地址硬编码：** 代码中的`system_addr`、`binsh_addr`和`exit_addr`等地址是硬编码的，这意味着PoC只能在具有相同libc版本的系统上工作。如果攻击者修改了这些地址，使其指向恶意代码而不是真正的libc函数，则可能会导致程序崩溃或执行非预期行为。
*   **Payload构造：**虽然提供的EXP利用的是常规的栈溢出，但恶意攻击者可以构造Payload的时候可以加入额外的后门代码,提高攻击性。
*   **Disclaimer免责声明:** 其中免责声明可能存在误导或者推卸责任的内容。

综合考虑，投毒的概率较低，因为 PoC 的主要目的是演示漏洞利用本身。攻击者更有可能直接修改PoC以适应目标环境，而不是试图添加隐藏的恶意代码。

**项目地址:** [zer0matt/CVE-2025-60751](https://github.com/zer0matt/CVE-2025-60751)

**漏洞详情:** [CVE-2025-60751](https://nvd.nist.gov/vuln/detail/CVE-2025-60751)