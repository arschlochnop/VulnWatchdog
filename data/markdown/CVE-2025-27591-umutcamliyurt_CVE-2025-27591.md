## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** < 0.9.0

**利用条件:** 需要本地用户权限，且安装了低于0.9.0版本的below服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27591 漏洞是 Meta Platforms, Inc 的 below 服务在 0.9.0 版本之前存在的一个权限提升漏洞。由于服务会在 /var/log/below 目录下创建一个世界可写的目录，导致本地非特权用户可以通过符号链接攻击来操纵文件，从而提升到 root 权限，例如修改 /etc/shadow 文件。

**漏洞利用方式：**

1.  **创建 Payload 文件：** 创建一个包含恶意用户行的临时文件 (TMP_PAYLOAD)，例如添加一个具有 root 权限的新用户。
2.  **检查日志目录权限：** 确保 /var/log/below 目录存在且世界可写。如果不可写，则无法利用此漏洞。
3.  **删除日志文件：** 如果存在目标日志文件 (LOG_FILE)，则将其删除，以防止干扰。
4.  **创建符号链接：** 创建从日志文件路径 (LOG_FILE) 到 /etc/passwd 的符号链接。这样，任何写入日志文件的操作实际上都会写入 /etc/passwd。
5.  **触发日志写入：** 使用 `sudo below record` 命令触发 below 服务写入日志。由于第4步中创建的符号链接，实际上数据会被写入 /etc/passwd 文件。
6.  **附加 Payload：** 将先前创建的包含恶意用户的 Payload 附加到 /etc/passwd 文件。这会将恶意用户添加到系统中。
7.  **完成利用：** 现在可以使用新添加的用户登录系统，从而获得 root 权限。例如使用 `su nemesis` 命令。

**有效性：**

提供的 POC 代码有效。该代码通过利用世界可写目录和符号链接漏洞，将恶意用户添加到 /etc/passwd 文件中，从而实现权限提升。

**投毒风险：**

该 POC 代码未发现明显的投毒代码。代码的主要功能是利用漏洞提升权限，没有发现其他恶意行为。因此，投毒风险较低，可认为是 0%。代码的主要作用在于演示漏洞利用过程，旨在教育用户了解安全风险。

**项目地址:** [umutcamliyurt/CVE-2025-27591](https://github.com/umutcamliyurt/CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)