## CVE-2024-25600 - WordPress Bricks Builder RCE

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WordPress Bricks Builder

**危害等级:** 严重，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.9.6

**利用条件:** 目标网站必须安装并启用存在漏洞的Bricks Builder插件，且版本低于或等于1.9.6。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是一个存在于WordPress Bricks Builder插件中的未授权远程代码执行漏洞。 

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC（漏洞利用代码）。提供的PoC代码利用了插件中代码生成的不当控制，允许攻击者注入并执行PHP代码。

**投毒风险分析：**

PoC代码主要功能是利用漏洞执行命令，并通过Exception信息回显结果，实现一个简易的webshell。代码中存在以下可能的投毒风险：

*   **Payload篡改：** 攻击者可能修改`queryEditor`中的payload，执行恶意代码，例如下载并执行恶意脚本。虽然代码本身没有明显的投毒行为，但用户在使用时需要注意payload的安全性。
*   **依赖项风险：** 该PoC依赖`httpx`、`asyncio`、`beautifulsoup4`和`re`等Python库。攻击者可能通过提供包含恶意依赖项的PoC来实施供应链攻击。本项目直接从github引用，存在一定的风险
*  **利用方式分析：** 代码中存在clear命令,sys.stdout.write("\x1b[2J\x1b[H")，该方式可能存在高危风险
综合考虑，该PoC的投毒风险为10%。

**利用方式：**

1.  **获取Nonce：**  PoC首先尝试从目标网站的HTML源代码中提取一个nonce值。这是通过查找包含`bricks-scripts-js-extra` ID的`<script>`标签，然后使用正则表达式提取nonce来实现的。
2.  **发送Payload：**  PoC构造一个包含恶意PHP代码的JSON payload，并将其发送到`/wp-json/bricks/v1/render_element`端点。payload中的关键部分是`queryEditor`字段，该字段包含要执行的PHP代码。PoC尝试使用两种不同的payload结构（`fst_payload`和`snd_payload`），以增加利用成功的机会。
3.  **执行命令：**  如果payload成功注入，服务器将执行payload中的PHP代码，并将结果返回给攻击者。PoC解析服务器的响应，并提取执行结果。攻击者可以通过交互式shell执行任意命令。

总体来说，该漏洞利用方式相对简单，只需要目标网站存在漏洞即可进行利用。

**项目地址:** [wh6amiGit/CVE-2024-25600](https://github.com/wh6amiGit/CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)