## CVE-2022-4065-testng-路径遍历

**漏洞编号:** CVE-2022-4065

**漏洞类型:** 路径遍历

**影响应用:** testng

**危害等级:** 中危，可能导致敏感文件泄露

**影响版本:** 7.5.0/7.6.0/7.6.1/7.7.0

**利用条件:** 需要用户运行包含恶意testng.xml配置的JAR包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-4065 存在于 TestNG 7.5.0 到 7.7.0 版本中。该漏洞位于 `org.testng.JarFileUtils.testngXmlExistsInJar` 函数，允许攻击者通过构造恶意的 JAR 包，利用路径遍历漏洞读取 JAR 包外部的文件。攻击者需要让受害者运行包含恶意 `testng.xml` 配置文件的 JAR 包。从漏洞利用代码来看，它只是一些发布公告和更新日志，与路径遍历漏洞无关。虽然漏洞利用代码本身不构成直接威胁，但仓库的其他部分可能存在恶意代码。因此判断存在10%的投毒风险。利用方式：攻击者创建一个包含恶意 testng.xml 文件的 JAR 包，其中 testng.xml 文件包含指向文件系统上任意位置的路径。当 TestNG 尝试加载该 testng.xml 文件时，路径遍历漏洞会被触发，允许攻击者读取受限制的文件。

**项目地址:** [shoucheng3/testng-team__testng_CVE-2022-4065_7-5](https://github.com/shoucheng3/testng-team__testng_CVE-2022-4065_7-5)

**漏洞详情:** [CVE-2022-4065](https://nvd.nist.gov/vuln/detail/CVE-2022-4065)