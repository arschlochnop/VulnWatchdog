## CVE-2021-22911-Rocket.Chat-NoSQL注入

**漏洞编号:** CVE-2021-22911

**漏洞类型:** NoSQL注入

**影响应用:** Rocket.Chat

**危害等级:** 高危，可能导致RCE（远程代码执行）

**影响版本:** 3.11, 3.12, 3.13 (修复版本: 3.13.2, 3.12.4, 3.11.4)

**利用条件:** 需要网络访问，且目标服务器运行存在漏洞的Rocket.Chat版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22911是Rocket.Chat服务器中存在的NoSQL注入漏洞。由于不正确的输入清理，攻击者可以通过未经身份验证的API端点进行NoSQL注入，从而可能导致远程代码执行（RCE）。

**有效性：**根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中包含了多个指向expolit-db和github的链接，表明存在公开的POC，可以验证该漏洞。

**投毒风险：**提供的代码片段是`Cargo.lock`文件，它只是用于记录Rust项目依赖项的版本信息，本身不包含任何可执行代码。因此，直接从这个文件判断投毒风险是不可行的。需要分析完整的POC代码才能进行评估。鉴于缺乏完整POC源码，假设部分依赖项存在潜在风险，投毒风险评估为10%。

**利用方式：**

1.  **确定目标版本：** 首先需要确定目标Rocket.Chat服务器的版本是否在受影响的范围内（3.11, 3.12, 3.13）。
2.  **构造恶意请求：** 攻击者构造包含恶意NoSQL查询语句的HTTP请求，发送到存在漏洞的API端点。攻击者利用不正确的输入验证，将恶意的NoSQL代码注入到查询语句中。
3.  **执行任意代码：** 成功注入后，恶意NoSQL查询被执行，导致服务器执行攻击者预先设定的任意代码。这通常通过利用MongoDB的JavaScript执行功能实现，例如 `$where` 操作符。
4.  **远程代码执行：** 通过执行任意代码，攻击者可以获取服务器的控制权，进行诸如数据窃取、恶意软件安装等恶意操作。

**项目地址:** [ChrisPritchard/CVE-2021-22911-rust](https://github.com/ChrisPritchard/CVE-2021-22911-rust)

**漏洞详情:** [CVE-2021-22911](https://nvd.nist.gov/vuln/detail/CVE-2021-22911)