## CVE-2025-29306-FoxCMS-代码注入

**漏洞编号:** CVE-2025-29306

**漏洞类型:** 代码注入

**影响应用:** FoxCMS

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 1.2.5

**利用条件:** 需要网络访问目标FoxCMS服务器，且服务器存在漏洞页面（index.html）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29306是FoxCMS 1.2.5版本中的一个代码注入漏洞。远程攻击者可以通过`index.html`组件中的案例展示页面，利用`id`参数执行任意代码。PoC代码通过构造包含PHP代码的URL，发送GET请求到目标服务器的`/images/index.html`，利用`urllib.parse.quote`函数对命令进行URL编码，使用`requests`库发送HTTP请求，然后使用`BeautifulSoup`解析HTML响应，提取命令执行结果。PoC利用了PHP的`system()`函数来执行操作系统命令，并通过`print_r()`函数将结果输出到页面上，再通过解析HTML提取结果。脚本使用多线程来加速漏洞扫描。

**有效性：** 根据提供的漏洞信息和PoC代码，该漏洞的利用应该是有效的。PoC代码针对特定版本的FoxCMS，并提供了执行任意命令的能力。

**投毒风险：** 投毒风险较低，约为10%。PoC代码主要功能是验证漏洞的存在和利用，逻辑较为清晰，没有明显的恶意代码。但是，任何代码都存在潜在的风险，例如，如果该PoC被攻击者修改，加入恶意功能（如反弹shell，植入后门），则可能被用于投毒。另外，PoC中禁用SSL证书验证(verify=False)在生产环境中存在风险。需要人工进行代码审计，才能完全排除投毒的可能性。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含要执行的命令，该命令会被URL编码后作为`id`参数传递给`/images/index.html`。
2.  服务器端，`index.html`页面没有对`id`参数进行充分的过滤和验证，导致`id`参数的值被当作PHP代码执行。
3.  服务器执行攻击者提供的PHP代码，例如，使用`system()`函数执行操作系统命令。
4.  命令执行的结果会被输出到页面上。
5.  攻击者通过解析页面的HTML内容来获取命令执行的结果。

总的来说，该漏洞是一个典型的代码注入漏洞，利用方式相对简单，但危害性很高，可能导致服务器被完全控制。

**项目地址:** [Mattb709/CVE-2025-29306-PoC-FoxCMS-RCE](https://github.com/Mattb709/CVE-2025-29306-PoC-FoxCMS-RCE)

**漏洞详情:** [CVE-2025-29306](https://nvd.nist.gov/vuln/detail/CVE-2025-29306)