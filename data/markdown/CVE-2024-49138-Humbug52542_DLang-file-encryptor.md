## CVE-2024-49138 Windows CLFS Elevation of Privilege

**漏洞编号:** CVE-2024-49138

**漏洞类型:** 权限提升

**影响应用:** Windows Common Log File System (CLFS) Driver

**危害等级:** 高危，允许本地攻击者提升权限至SYSTEM

**影响版本:** 受影响的Windows版本众多，请参考CVE信息中的版本范围

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-49138是一个Windows CLFS驱动的权限提升漏洞。攻击者可以利用此漏洞将权限提升到SYSTEM级别，从而完全控制受影响的系统。CISA已将此漏洞添加到已知被利用漏洞目录中，表明该漏洞已经被积极利用。

分析提供的漏洞利用代码，发现代码仓库内容显示为"SCRAPPED"，且只有一个名为"Encrypter.d"的文件，其中包含一些import语句，如`core.stdc.stdlib`、`core.simd`、`core.thread`、`std.base64`等，代码并不完整，无法直接判断其是否能够有效利用该漏洞。此外，LICENSE文件显示版权归属于"Humbug!!"，这暗示了代码可能并不来源于官方或可信的来源。由于代码不完整且项目状态为"SCRAPPED"，因此提供的PoC代码可能无效。

投毒风险方面，虽然代码仓库标明"SCRAPPED"，但`Encrypter.d` 文件引入了一些标准库，虽然命名为"Encrypter"，但其中引入了 `std.process`, `core.sys.windows.windows`, `core.sys.windows.psapi`, `core.sys.windows.ntdll` 等库，有一定的可能性被用于执行系统命令或进行其他恶意操作。需要更深入的分析才能确定是否存在后门或恶意行为。由于代码的目的是提权，所以仓库内可能包含一些可以用于提权，但同时也被杀毒软件认为是恶意代码的内容，所以这里判断其存在一定的投毒风险，大概为10%。

根据搜索结果和漏洞库信息，漏洞利用方式通常涉及到构造特定的CLFS日志条目，触发驱动程序中的堆缓冲区溢出(CWE-122)，从而允许攻击者执行任意代码并提升权限。

**项目地址:** [Humbug52542/DLang-file-encryptor](https://github.com/Humbug52542/DLang-file-encryptor)

**漏洞详情:** [CVE-2024-49138](https://nvd.nist.gov/vuln/detail/CVE-2024-49138)