## CVE-2022-26134-Atlassian Confluence-OGNL注入RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入导致远程代码执行

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 需要网络可达Confluence服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的严重漏洞。该漏洞允许未经身份验证的攻击者通过注入 OGNL 表达式在受影响的 Confluence 实例上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（Rapid7, Qualys, NVD, Unit 42, Darktrace, Trend Micro, Akamai, Splunk, Datadog等均报道此漏洞存在，并且有积极利用的案例）和提供的POC代码，该漏洞是有效的。POC代码利用Java的Nashorn引擎执行任意命令，并提供了反弹shell的示例。

**投毒风险：**

虽然提供的POC代码本身是用于演示漏洞利用，并未发现明显的恶意代码，但任何远程代码执行漏洞都存在被植入恶意代码的风险。POC中的反弹shell地址可以被替换成攻击者控制的服务器，进而执行任意恶意操作。此处的投毒风险主要来自于用户修改POC执行恶意操作, 本身代码风险较低。
仓库中直接嵌入恶意代码的可能性较低（10%），但是下载的用户可能自行修改反弹shell地址到恶意地址,或者修改执行的bash命令。

**利用方式：**

1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  OGNL 表达式被 Confluence 服务器解析并执行。
3.  利用 Java Nashorn 引擎，攻击者可以执行任意 Java 代码，包括执行系统命令。
4.  攻击者通常会利用此漏洞反弹 shell，从而完全控制受影响的服务器。

该漏洞利用简单，影响范围广，危害巨大。务必及时更新 Confluence 版本。

**项目地址:** [Khalidhaimur/CVE-2022-26134](https://github.com/Khalidhaimur/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)