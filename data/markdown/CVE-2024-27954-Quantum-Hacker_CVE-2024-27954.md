## CVE-2024-27954-WP Automatic-路径遍历和SSRF

**漏洞编号:** CVE-2024-27954

**漏洞类型:** 路径遍历和SSRF

**影响应用:** WP Automatic

**危害等级:** 高危，可能导致敏感文件泄露和内部网络探测

**影响版本:** <= 3.92.0

**利用条件:** 无需认证，需要WP Automatic插件版本小于等于3.92.0

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27954是WP Automatic插件中存在的路径遍历和SSRF漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者通过构造恶意请求，读取服务器上的任意文件（路径遍历），以及发起服务器端请求伪造（SSRF）攻击。提供的POC代码（wprce.yaml）是一个Nuclei模板，它尝试利用路径遍历漏洞读取/etc/passwd文件。 

**有效性：**
根据POC代码中的匹配条件，如果响应体包含`"link":"file:`和`root:.*:0:0:`，则认为漏洞存在。这意味着该POC尝试通过`wp_automatic=download&link=file:///etc/passwd`参数读取/etc/passwd文件，并通过正则表达式确认文件内容是否包含root用户信息，从而验证路径遍历漏洞的存在。因此，提供的POC代码应该是有效的。

**投毒风险：**
该存储库中存在投毒代码的可能性较低，大约为10%。主要理由如下：
*   存储库结构简单，只有README.md和wprce.yaml两个文件。
*   wprce.yaml是一个Nuclei模板，其作用是发送HTTP请求并根据响应进行匹配，功能相对明确。
*   README.md文件提供了漏洞描述、检测方法和使用说明，内容与漏洞相关。
*   投毒代码通常会隐藏在看似无害的代码中，或通过复杂的逻辑来执行恶意操作，而该存储库中的代码相对简单直观。但是，仍然存在一种可能性，即模板本身可能设计为指向恶意服务器以进行SSRF攻击，或者模板可能包含旨在造成拒绝服务或数据损坏的恶意参数。

**利用方式：**
1.  **路径遍历：** 攻击者可以利用`wp_automatic=download&link=file://`参数读取服务器上的任意文件，例如配置文件、数据库文件等，从而获取敏感信息。
2.  **SSRF：** 攻击者可以利用该漏洞发起SSRF攻击，扫描内网端口、访问内部服务、甚至执行命令。例如，攻击者可以利用`wp_automatic=download&link=http://internal-server/`参数访问内部服务器。

**修复建议：**
将WP Automatic插件升级到3.92.1或更高版本。

**项目地址:** [Quantum-Hacker/CVE-2024-27954](https://github.com/Quantum-Hacker/CVE-2024-27954)

**漏洞详情:** [CVE-2024-27954](https://nvd.nist.gov/vuln/detail/CVE-2024-27954)