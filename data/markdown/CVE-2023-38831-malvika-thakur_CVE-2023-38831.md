## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831 漏洞存在于 WinRAR 6.23 之前的版本中。攻击者可以通过创建一个特制的 ZIP 压缩包，其中包含一个良性文件和一个与该良性文件同名的文件夹，文件夹中包含恶意可执行文件。当用户尝试在 WinRAR 中查看该良性文件时，由于 WinRAR 处理逻辑的缺陷，会错误地执行文件夹中的恶意代码，从而导致远程代码执行。

**有效性：**

提供的 POC 代码 `poc.py`  可以生成利用此漏洞的 ZIP 文件。代码首先检查恶意脚本和良性文件是否存在，然后创建一个目录，将脚本和良性文件复制到特定结构中，最后将该目录压缩成 ZIP 文件。用户只需双击压缩包内的良性文件即可触发漏洞，执行恶意脚本。因此，POC 代码有效。

**投毒风险：**

分析提供的 `poc.py` 代码，没有发现明显的投毒代码。该脚本的主要功能是生成利用 CVE-2023-38831 漏洞的恶意 ZIP 文件。它需要用户提供恶意脚本和良性文件，然后按照特定目录结构进行组织并压缩。代码中没有发现任何会执行额外恶意操作的逻辑。`README.md` 文件也仅包含漏洞描述和使用说明，没有发现恶意内容。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含良性文件（如 JPG 图片）和一个同名文件夹的 ZIP 压缩包。
2.  该文件夹中包含恶意可执行文件（如 BAT 脚本）。
3.  攻击者将该 ZIP 压缩包发送给目标用户。
4.  目标用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包。
5.  目标用户双击 ZIP 压缩包中的良性文件。
6.  WinRAR 错误地执行同名文件夹中的恶意可执行文件，导致远程代码执行。

**项目地址:** [malvika-thakur/CVE-2023-38831](https://github.com/malvika-thakur/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)