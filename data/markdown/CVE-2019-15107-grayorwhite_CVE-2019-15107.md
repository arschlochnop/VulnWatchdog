## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要网络访问Webmin服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-15107是Webmin 1.920及更早版本中的一个命令注入漏洞。该漏洞存在于 `password_change.cgi` 脚本中，`old` 参数未经过充分过滤，导致攻击者可以通过构造恶意的请求，在服务器上执行任意命令。

**有效性：**
根据漏洞信息和搜索结果，该漏洞存在有效的POC，可以实现远程代码执行。

**投毒风险：**
提供的POC代码只是一个README.md文件，描述了针对Webmin漏洞构建服务器和攻击结果的信息。 它本身不包含可执行代码，因此直接投毒的风险较低，但不能排除存储库中的其他文件(未提供)包含恶意代码的可能性。估计投毒风险为10%，主要考虑到可能存在的隐藏恶意payload的情况，需要进一步检查其他未提供的代码文件。

**利用方式：**
1.  攻击者构造包含恶意命令的HTTP POST请求，目标是`password_change.cgi`脚本。
2.  将恶意命令注入到`old`参数中。
3.  Webmin服务器在处理请求时，由于未正确过滤`old`参数，会将恶意命令传递给系统shell执行。
4.  攻击者从而在服务器上执行任意命令，例如反弹shell，添加后门等。

**利用细节补充:**
根据Rapid7的分析，`expired`参数同样存在命令注入漏洞。
攻击不需要身份验证，即未授权远程命令执行。
多个漏洞利用脚本在 Exploit-DB 和 Packet Storm Security 等平台上可用。

**项目地址:** [grayorwhite/CVE-2019-15107](https://github.com/grayorwhite/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)