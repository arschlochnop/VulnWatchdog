## CVE-2024-0204-GoAnywhere MFT-身份验证绕过

**漏洞编号:** CVE-2024-0204

**漏洞类型:** 身份验证绕过

**影响应用:** GoAnywhere MFT

**危害等级:** 高危，允许未经授权的用户创建管理员帐户，可能导致完全控制系统

**影响版本:** < 7.4.1

**利用条件:** 目标系统运行GoAnywhere MFT 6.0.1到7.4.0版本，且初始设置向导未被删除或禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0204是一个存在于Fortra GoAnywhere MFT 7.4.1之前版本中的身份验证绕过漏洞。未经身份验证的攻击者可以通过访问`InitialAccountSetup.xhtml`页面创建管理员帐户。POC代码利用路径遍历漏洞访问此页面，并提交包含新管理员用户信息的POST请求。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已得到确认，并且存在公开可用的POC代码。该POC代码通过模拟创建管理员用户的HTTP请求来利用漏洞。参考GitHub上的POC，该漏洞可以被成功利用，有效性高。

**投毒风险：**
该POC代码主要通过构造HTTP请求来创建管理员用户。代码中存在变量`PRIMARY_EXPLOIT_PATH`和`SECONDARY_EXPLOIT_PATH`，尝试不同的路径遍历方式，以增加漏洞利用成功的概率。虽然代码存在检查目标是否可达的步骤，但是并没有发现明显的后门或恶意代码。投毒风险较低，约为10%。这个评估主要是基于代码的功能和目的，以及缺乏任何明显的恶意行为。但任何代码都存在潜在的风险，需要进行代码审计和安全测试。

**利用方式：**
1.  攻击者首先确定目标系统是否运行易受攻击的GoAnywhere MFT版本。
2.  攻击者使用POC代码，该代码会尝试通过不同的路径遍历技术访问初始帐户设置页面（`InitialAccountSetup.xhtml`）。
3.  如果成功访问该页面，POC代码会构造一个包含新管理员用户名和密码的POST请求，并将其发送到目标系统。
4.  如果请求成功，则会在目标系统上创建一个新的管理员帐户，从而允许攻击者完全控制该系统。

**项目地址:** [ibrahimsql/CVE-2024-0204](https://github.com/ibrahimsql/CVE-2024-0204)

**漏洞详情:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)