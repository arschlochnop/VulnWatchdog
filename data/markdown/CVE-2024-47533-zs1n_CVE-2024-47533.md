## CVE-2024-47533 - Cobbler XMLRPC Authentication Bypass RCE

**漏洞编号:** CVE-2024-47533

**漏洞类型:** 身份验证绕过

**影响应用:** Cobbler

**危害等级:** 高危，远程代码执行

**影响版本:** 3.0.0 <= version < 3.2.3 和 3.3.0 <= version < 3.3.7

**利用条件:** 目标 Cobbler 服务器开放 XMLRPC API 端口（默认为 25151），攻击者可以网络访问该端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-47533 是 Cobbler Linux 安装服务器中的一个身份验证绕过漏洞。`utils.get_shared_secret()` 函数始终返回 -1，导致可以通过用户名 '' 和密码 -1 连接到 XML-RPC 接口，无需任何有效凭据即可执行任意代码。

**有效性：**

根据漏洞描述和提供的 PoC 代码，该漏洞利用的有效性非常高。PoC 代码明确指出如何利用此漏洞，并且提供了执行任意命令和获取反向 shell 的方法。漏洞库信息也表明该漏洞的影响是严重的，未经身份验证的攻击者可以完全控制服务器。

**投毒风险：**

评估 PoC 代码的投毒风险较低，大约 10%。提供的文件是 README.md，主要描述漏洞信息和利用方法，没有直接包含恶意代码的迹象。风险主要来自于下载和运行 exploit 脚本本身，用户应当仔细审查下载的脚本。此外，仓库里可能存在其它文件，因此存在一定风险。

**利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 Cobbler 版本的服务器，且 XMLRPC API 端口（通常是 25151）对外开放。
2.  **准备攻击机：** 准备一台可以访问目标服务器的攻击机，并确保安装了 Python 3 和必要的库（如果 exploit 脚本需要）。
3.  **启动监听器：** 在攻击机上启动一个 Netcat 监听器，等待反向 shell 连接（例如，`nc -lvnp 4444`）。
4.  **运行 exploit 脚本：** 使用提供的 exploit 脚本（`CVE-2024-47533.py`），指定目标服务器的地址和端口，以及监听器的 IP 地址和端口。选择一个合适的 payload （例如，`bash`，`nc`，`curl`）。
5.  **获取 shell：** 如果 exploit 成功，攻击机将收到一个反向 shell，攻击者可以在目标服务器上执行任意命令。

**项目地址:** [zs1n/CVE-2024-47533](https://github.com/zs1n/CVE-2024-47533)

**漏洞详情:** [CVE-2024-47533](https://nvd.nist.gov/vuln/detail/CVE-2024-47533)