## CVE-2019-9978-Social-Warfare-WordPress-Stored-XSS-RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS / Remote Code Execution

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** <= 3.5.2

**利用条件:** 目标网站安装了Social Warfare插件，并且版本低于或等于3.5.2, 存在wp-admin目录可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Social Warfare插件中，攻击者可以通过`swp_url`参数，在`wp-admin/admin-post.php?swp_debug=load_options` 页面注入恶意的JavaScript代码，导致存储型XSS。更严重的，结合RCE漏洞，攻击者可以通过上传恶意PHP脚本实现远程代码执行。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞在野外已被利用，并且存在公开的POC代码。该漏洞允许攻击者利用`wp-admin/admin-post.php?swp_debug=load_options&swp_url`参数注入恶意代码。

**投毒风险分析：**

POC代码的主要功能是检查目标是否存在漏洞，如果存在则上传webshell。其中从`https://hastebin.com/raw/iropememif`下载webshell上传。这个连接存在潜在的风险，仓库维护者或者黑客可以修改`https://hastebin.com/raw/iropememif`的内容，如果修改为恶意代码则存在投毒风险。但是从代码逻辑来看，主要还是执行RCE, 所以我评估投毒风险为5%。

**利用方式：**

1.  **检查插件版本：** 确认目标网站安装了Social Warfare插件，并且版本低于或等于3.5.2。
2.  **构造恶意请求：** 使用如下URL构造恶意请求：
    `目标网站/wp-admin/admin-post.php?swp_debug=load_options&swp_url=[恶意代码]`
    其中`[恶意代码]`是经过URL编码的恶意JavaScript代码，用于XSS攻击，或者是一个指向恶意PHP文件的URL，用于RCE攻击。
3.  **触发XSS：** 诱导管理员访问包含恶意代码的页面，触发XSS攻击。
4.  **RCE攻击：** 如果利用RCE漏洞，攻击者将webshell上传到服务器，然后通过访问webshell执行任意代码。
5.  **利用EXP:** 通过执行脚本 `python script.py list-of-sites.txt`, 即可批量上传webshell.

**项目地址:** [KTN1990/CVE-2019-9978](https://github.com/KTN1990/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)