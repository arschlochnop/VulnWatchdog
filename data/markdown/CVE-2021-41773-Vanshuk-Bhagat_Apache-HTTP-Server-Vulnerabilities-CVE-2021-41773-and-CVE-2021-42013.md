## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，且Alias-like指令配置不当或未启用"require all denied"保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49中存在的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造特殊的URL，访问服务器上Alias-like指令配置以外的文件。如果这些文件没有被“require all denied”等默认安全配置保护，攻击者就可以成功读取它们。更进一步，如果CGI脚本在这些aliased路径上启用，攻击者甚至可以执行远程代码。

**有效性：**
漏洞库信息和搜索引擎结果都表明该漏洞是真实存在的，并且被广泛利用。提供的漏洞利用代码主要是一个README.md文件，描述了一个渗透测试项目，该项目评估了CVE-2021-41773和CVE-2021-42013漏洞。虽然这个README.md文件本身不是直接可用的exp代码，但是它暗示了利用该漏洞进行渗透测试是可行的。搜索引擎结果中也提到存在公开的PoC。

**投毒风险：**
README.md文件描述的是一个渗透测试过程的文档，其中包含使用Nmap、Gobuster等工具进行信息收集和漏洞评估，并没有发现直接的恶意代码。但是考虑到安全风险，该文档存在10%的投毒的可能性，因为不排除作者在文档中故意遗漏或隐藏了某些关键信息，从而误导使用者。例如,引导使用者下载特定版本的工具,该工具已经被植入后门等.

**利用方式：**
1.  **路径遍历：** 攻击者利用`..`等路径遍历字符，绕过服务器的目录限制，访问任意文件。
2.  **文件读取：**  如果目标文件未被`require all denied`等配置保护，攻击者可以读取文件内容，获取敏感信息，如配置文件、源代码等。
3.  **远程代码执行：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并执行任意命令。

利用方式通常涉及构造包含路径遍历字符的URL，例如：
`/%2e%2e/%2e%2e/%2e%2e/etc/passwd`
或
`..%2f..%2f..%2fetc/passwd`

攻击者需要根据服务器的具体配置和文件系统结构，调整路径遍历的深度和目标文件名，以成功利用该漏洞。

**项目地址:** [Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013](https://github.com/Vanshuk-Bhagat/Apache-HTTP-Server-Vulnerabilities-CVE-2021-41773-and-CVE-2021-42013)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)