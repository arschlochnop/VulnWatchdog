## CVE-2023-38831-WinRAR-任意代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 任意代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的WinRAR版本打开恶意构造的ZIP文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-38831是WinRAR 6.23之前版本中的一个漏洞，该漏洞允许攻击者通过特制的ZIP档案执行任意代码。漏洞利用方式如下：

1.  **漏洞原理：** 当WinRAR尝试访问ZIP归档中的良性文件时，如果存在与该良性文件同名的文件夹，WinRAR会处理该文件夹的内容（可能包含可执行内容）。
2.  **利用方式：**
    *   攻击者创建一个恶意的ZIP档案，该档案包含一个良性文件（例如.JPG文件）和一个与该良性文件同名的文件夹。
    *   该文件夹包含恶意可执行文件。
    *   当受害者尝试在WinRAR中查看良性文件时，WinRAR会执行该文件夹中的恶意代码。
3.  **POC有效性：** 提供的POC代码 (CVE-2023-38831-WinRar-Exploit.py) 的目的是生成包含利用此漏洞的恶意 ZIP 文件。根据代码逻辑和漏洞原理，该 POC 可以有效利用该漏洞。
4.  **投毒风险：** 经过对POC代码的分析，发现代码本身实现了漏洞利用过程，但同时也存在一定的投毒风险。`clean_up()`函数会删除临时文件，但不能保证完全清除所有痕迹。攻击者可能通过修改代码，在生成恶意 ZIP 文件后，在目标系统上留下后门或执行其他恶意操作。考虑到实际利用场景中可能存在的恶意修改，投毒风险估计为5%。 主要风险点在于，虽然POC主要目的是生成exploit，但如果恶意人员修改，完全可以添加其他恶意payload，并伪装成CVE-2023-38831的POC进行传播。
5. **搜索引擎结果:** 搜索引擎结果表明此漏洞已被广泛利用，包括政府背景的黑客组织。 多个安全厂商发布了相关的分析和防御措施。

**项目地址:** [technicalcorp0/CVE-2023-38831-Exploit](https://github.com/technicalcorp0/CVE-2023-38831-Exploit)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)