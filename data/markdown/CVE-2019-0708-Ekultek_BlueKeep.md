## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Remote Desktop Services

**危害等级:** 高危，允许未经身份验证的攻击者在目标系统上远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1 等

**利用条件:** 目标系统需要启用RDP服务，且攻击者能够通过网络访问3389端口（默认）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。从搜索引擎结果和漏洞库信息来看，该漏洞影响多个版本的Windows操作系统，包括Windows 7和Windows Server 2008。漏洞利用代码显示，该PoC利用了RDP服务在处理Channel ID时可能存在的内存损坏漏洞。通过发送特制的RDP数据包，攻击者可以设置RDP服务不期望的值，从而导致内存损坏，为远程代码执行创造条件。此PoC本身不包含Payload，但可以很容易地添加payload进行利用。

**有效性：** 该PoC代码具备一定的有效性，因为它能够触发漏洞，导致内存损坏。虽然提供的PoC没有直接执行恶意代码，但它已经为进一步的利用铺平了道路。根据代码描述，作者成功在Windows XP上执行了命令。

**投毒风险：** 投毒风险评估为10%。 代码本身似乎专注于漏洞触发，而没有明显的恶意后门。主要风险点在于第三方依赖`requirements.txt`，如果该文件中的某个依赖源被篡改，则可能存在投毒风险。另外，需要注意代码的安全性，避免在不可信的环境中执行。

**利用方式：**
1.  攻击者通过网络连接到目标系统的RDP服务（通常在3389端口）。
2.  攻击者发送特制的RDP数据包，该数据包包含一个特制的Channel ID。
3.  目标系统的RDP服务在处理该数据包时，由于Channel ID的异常值而发生内存损坏。
4.  攻击者可以进一步利用此内存损坏来执行任意代码，从而完全控制目标系统。
5.  该漏洞的利用不需要身份验证，因此任何能够访问目标系统RDP服务的攻击者都可以尝试利用。

**项目地址:** [Ekultek/BlueKeep](https://github.com/Ekultek/BlueKeep)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)