## CVE-2024-10924 - Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress plugins

**危害等级:** 严重，允许未经身份验证的攻击者以任何现有用户身份登录，例如管理员

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标网站安装了受影响版本的 Really Simple Security 插件，且启用了Two-Factor Authentication设置 (尽管默认是禁用)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10924 是 Really Simple Security 插件中的一个身份验证绕过漏洞。该漏洞源于 'check_login_and_get_user' 函数中不正确的用户检查错误处理，特别是在双因素身份验证REST API actions中。攻击者可以发送特制的请求绕过双因素身份验证，以任意用户身份（包括管理员）登录。

**利用方式：**

1.  攻击者首先利用 `/reallysimplessl/v1/two_fa/skip_onboarding` endpoint 尝试绕过双因素身份验证。
2.  PoC脚本首先构造一个POST请求到该endpoint，并携带 user_id，login_nonce，redirect_to 等参数。目的是获取服务器返回的 Set-Cookie 值。
3.  从返回的响应头中提取 Set-Cookie 值。
4.  使用捕获的 Cookie，构造一个新的 POST 请求到 `/wp-admin/profile.php`，并包含用户的登录凭据（用户名和密码）。
5.  服务器在验证 Cookie 后，错误地验证了用户身份，允许攻击者以用户身份登录。
6.  PoC 使用 webbrowser 模块自动在浏览器中打开包含身份验证 Cookie 的 WordPress 管理面板。

**有效性：**

根据漏洞描述和提供的PoC代码，该PoC代码**有效**。它利用了漏洞中的身份验证绕过机制，允许攻击者在没有双因素身份验证的情况下登录。

**投毒风险：**

查看提供的`poc.py`脚本，该脚本的功能是为了验证和利用漏洞。虽然可以修改脚本以注入恶意代码，但目前提供的脚本本身**不包含任何明显的投毒代码**，风险为 **0%** 。它主要实现漏洞利用的功能，并没有发现任何尝试在目标系统上安装后门、收集信息或执行其他恶意活动的代码。

README.md 文件提供的是漏洞利用的说明和演示，以及一个用于快速部署漏洞环境的 Docker 镜像，没有投毒风险。

**项目地址:** [Hunt3r850/CVE-2024-10924-PoC](https://github.com/Hunt3r850/CVE-2024-10924-PoC)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)