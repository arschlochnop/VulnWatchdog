## CVE-2025-30065-Apache Parquet-RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Parquet Java (parquet-avro module)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.15.0

**利用条件:** 需要目标系统处理来自不受信任来源的Parquet文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30065 存在于 Apache Parquet Java 库的 parquet-avro 模块中。该漏洞允许攻击者通过恶意构造的 Parquet 文件，利用 Avro schema 解析过程中的反序列化漏洞执行任意代码。根据漏洞库信息，受影响的版本为 1.15.0 及之前的版本。搜索引擎结果显示，此漏洞被评为最高危等级，CVSS 评分为 10.0，易于利用。漏洞利用代码（Canary Exploit Generator）提供了一种生成恶意 Parquet 文件的便捷方式，通过在 Avro schema 中嵌入恶意代码，当目标系统解析该 Parquet 文件时，即可触发远程代码执行。该 PoC 通过 `javax.swing.JEditorPane` 对象尝试访问指定的回调 URL 来验证漏洞。虽然 PoC 本身较为 benign，但攻击者可以替换成更具破坏性的 payload，比如执行系统命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和 PoC 代码，此漏洞利用的有效性很高。PoC 代码已经证实可以触发回调，表明可以通过构造恶意的 Parquet 文件来利用该漏洞。

**投毒风险：**
PoC 代码本身提供的功能是生成恶意 parquet 文件，用于验证目标系统是否存在漏洞。主要的风险点在于攻击者可能会修改 PoC 代码，在生成的 parquet 文件中嵌入更具破坏性的 payload，例如执行系统命令，或者进行恶意文件读写。仔细分析了提供的LICENSE文件,作者有免责声明.  此外，PoC 代码的 README 文件也明确指出了这一点。因此，不能完全排除投毒风险，但鉴于 F5 发布的意图以及PoC相对清晰的逻辑，投毒风险较低，估算为10%。主要的风险在于使用者在没有充分理解代码的情况下，修改了 payload 部分，引入了恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意 Avro schema 的 Parquet 文件。
2.  攻击者将恶意 Parquet 文件发送给目标系统。
3.  目标系统使用 Apache Parquet Java 库（parquet-avro 模块）解析该 Parquet 文件。
4.  解析 Avro schema 时，恶意代码被执行，导致远程代码执行。

缓解措施：
1.  升级到 Apache Parquet Java 库的 1.15.1 或更高版本。
2.  避免处理来自不受信任来源的 Parquet 文件。
3.  如果必须处理不受信任的 Parquet 文件，请使用沙箱环境或者容器进行隔离。
4.  仔细检查`org.apache.parquet.avro.SERIALIZABLE_PACKAGES`配置，避免设置为过于宽泛的值，如 `*`。

**项目地址:** [F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065](https://github.com/F5-Labs/parquet-canary-exploit-rce-poc-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)