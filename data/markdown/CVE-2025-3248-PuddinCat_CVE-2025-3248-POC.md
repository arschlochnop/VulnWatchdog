## CVE-2025-3248-langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** langflow

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 目标系统运行langflow 1.2.0或更早版本，且/api/v1/validate/code 接口对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248 是 Langflow 1.3.0 之前版本中 /api/v1/validate/code 端点存在的代码注入漏洞。未经身份验证的远程攻击者可以发送特制的 HTTP 请求来执行任意代码。POC 代码通过构造包含恶意代码的payload, 发送到 /api/v1/validate/code 接口。payload 中的代码会首先尝试在受害者机器上写入一个文本文件以“提醒”受害者计算机已被入侵，然后执行攻击者指定的命令。  虽然 POC 的作者在文件中写了一段“留一些爱在受害者电脑上”的话，但实际的恶意代码可以被任意命令替换，存在潜在的风险。

**有效性：**根据漏洞库信息和搜索结果，该漏洞可以未经身份验证进行利用，风险极高，且PoC已经发布，因此PoC有效。

**投毒风险：**该仓库的主要目的是展示CVE-2025-3248的PoC利用，但其中包含以下潜在的投毒风险：

*   **写入文件:**  POC代码会尝试在目标系统上写入文件`/tmp/ello_ur_computa_has_virus.txt`和`~/ello_ur_computa_has_virus.txt`。虽然内容目前是无害的警告信息，但攻击者可能修改POC，写入恶意文件，例如webshell或启动脚本。
*   **命令执行:** POC直接执行用户提供的命令，这意味着如果用户下载并使用未修改的POC，他们可能会无意中在自己的系统上执行恶意命令，具体风险取决于攻击者提供的命令。
*   **依赖风险：** 尽管POC代码很短，但它依赖于`requests`库。如果攻击者控制了`requests`库的镜像源，则可能通过依赖注入引入恶意代码。

**利用方式：**

1.  确定目标系统运行的是 Langflow 1.2.0 或更早版本。
2.  构造包含恶意 Python 代码的 payload。此代码会被注入到 `/api/v1/validate/code` 接口，利用 Python 的 `exec` 函数执行。
3.  发送包含 payload 的 HTTP POST 请求到 `/api/v1/validate/code` 接口。
4.  恶意代码在目标系统上执行，允许攻击者执行任意命令。

综上所述，该漏洞的利用方式简单，未经身份验证，风险极高。虽然当前 POC 的直接威胁有限，但存在被修改和滥用的风险。

**项目地址:** [PuddinCat/CVE-2025-3248-POC](https://github.com/PuddinCat/CVE-2025-3248-POC)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)