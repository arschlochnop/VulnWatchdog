## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 是 PHPUnit 框架中存在的一个远程代码执行漏洞。该漏洞位于 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到存在漏洞的 `eval-stdin.php` 文件，从而执行任意 PHP 代码。漏洞利用的关键在于目标服务器是否允许外部访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径。根据提供的漏洞利用代码，该脚本通过构造包含恶意 PHP 代码的 POST 请求，发送到目标 URI，如果目标存在漏洞且URI可访问，即可执行任意命令。

**有效性：**

提供的PoC代码是有效的，它通过发送包含 PHP 代码的 POST 请求来利用漏洞，如果目标存在漏洞，则允许远程执行代码。

**投毒风险：**

该仓库代码主要是用于检测和利用 CVE-2017-9841 漏洞，代码本身功能比较清晰，未发现存在恶意代码，用于植入后门的嫌疑。投毒风险评估为0%。

**利用方式：**

1.  **检测是否存在漏洞：**
    *   通过脚本扫描目标URL，判断是否存在 `vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 文件。
    *   发送包含简单PHP代码（如 `<?php echo 'test'; ?>`）的POST请求，检查响应结果。
2.  **远程代码执行：**
    *   发送包含恶意PHP代码的POST请求，执行系统命令。
    *   使用交互式shell模式，方便地执行多个命令。

利用过程需要确保目标服务器的 `/vendor` 目录没有被正确配置，允许外部访问 `eval-stdin.php` 文件。否则，无法成功利用该漏洞。

**项目地址:** [Chocapikk/CVE-2017-9841](https://github.com/Chocapikk/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)