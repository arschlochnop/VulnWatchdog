## CVE-2023-0386-Linux Kernel OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户提升权限

**影响版本:** Linux kernel 6.2-rc6 (可能影响其他版本，需要根据补丁判断)

**利用条件:** 需要本地用户权限，目标系统使用 OverlayFS 文件系统。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 漏洞存在于 Linux 内核的 OverlayFS 子系统中。漏洞描述指出，当用户从一个 nosuid 的挂载点复制一个具有 capability 的文件到另一个挂载点时，存在权限映射错误。这使得本地用户能够提升他们在系统上的权限。

**有效性：** 根据搜索结果，存在公开的漏洞利用代码（例如 vicarius.io），证明该漏洞可以被利用。 虽然提供的代码段本身不是完整的PoC，但搜索结果指向了可用的完整PoC，所以判断是有效的。

**投毒风险：** 提供的代码段是Linux内核的COPYING和CREDITS文件，它们是许可信息和贡献者列表，而非可执行代码。 这些文件本身不包含恶意代码。虽然这些文件本身不是漏洞利用程序，但如果将恶意代码伪装成贡献者添加到CREDITS文件中，从理论上讲，可以将恶意代码混入到源代码管理系统中。因为这假设有恶意的人员对代码库提交被篡改的CREDITS文件，概率极低,因此判断投毒风险极低。

**利用方式：** 该漏洞的利用方式涉及以下步骤：
1.  利用OverlayFS文件系统特性，将一个具有 setuid 权限的文件从 nosuid 挂载点复制到其他挂载点。
2.  由于权限映射错误，新复制的文件在目标挂载点上保留了 setuid 权限，但是用户ID 映射不正确。
3.  攻击者可以执行这个具有 setuid 权限的文件，从而以更高的权限运行代码。

搜索引擎结果和漏洞库信息都表明该漏洞允许本地权限提升，所以漏洞利用是有效的。

**项目地址:** [Satheesh575555/linux-4.19.72_CVE-2023-0386](https://github.com/Satheesh575555/linux-4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)