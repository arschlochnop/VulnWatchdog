## CVE-2025-29632 - free5gc AMF拒绝服务

**漏洞编号:** CVE-2025-29632

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** free5gc AMF

**危害等级:** 高危，导致5G网络AMF组件崩溃，影响用户连接

**影响版本:** v4.0.0 (根据free5gc.log)

**利用条件:** 需要能够向AMF发送特定格式的InitialUEMessage消息

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞利用代码和日志文件，CVE-2025-29632 漏洞存在于 free5gc 的 AMF (Access and Mobility Management Function) 组件中。当 AMF 处理 InitialUEMessage 时，如果 nASPDU 内容为空，会导致程序在后续的 nas_security.DecodePlainNasNoIntegrityCheck 函数调用中发生错误并崩溃，从而造成拒绝服务。

**有效性评估：**
提供的 `poc.py` 脚本和 `ngap.pcap` 数据包以及 `free5gc.log` 日志文件表明，该漏洞利用代码是有效的。日志显示，在执行攻击后，AMF 组件在 2025-03-07T00:48:15.913618097+08:00 时崩溃。

**投毒风险分析：**
该仓库中可能存在的投毒代码风险较低，大约为10%。主要基于以下几点：
1.  文件内容主要是漏洞的描述、POC脚本（`poc.py`）、流量包（`ngap.pcap`）以及日志文件（`free5gc.log`）。这些文件主要用于证明漏洞的存在和利用。
2.  虽然无法直接审查 `poc.py` 和 `ngap.pcap` 的内容（未提供），但从漏洞描述来看，POC 似乎是构造一个特殊的 InitialUEMessage，其中 nASPDU 的内容为空。这种类型的攻击更像是利用已知的漏洞，而不是植入后门或恶意代码。
3.  高风险在于如果攻击者修改了 `poc.py` 脚本，使其在触发漏洞的同时执行其他恶意操作，例如收集系统信息或尝试提权。然而，在这种特定情况下，可能性较低，因为主要目的是触发 AMF 的崩溃。
4.  `ngap.pcap` 中也可能包含恶意流量，但这取决于攻击者的意图。如果攻击者只是简单地重放一个触发漏洞的数据包，那么风险较低；但如果攻击者在数据包中注入了其他恶意负载，那么风险会增加。

**利用方式：**
1.  攻击者构造一个恶意的 InitialUEMessage，其中 nASPDU 字段存在，但是内容为空。
2.  将该消息发送给 free5gc 的 AMF 组件。
3.  AMF 在处理该消息时，会调用 `nas_security.DecodePlainNasNoIntegrityCheck(nASPDU.Value)` 函数，由于 nASPDU.Value 为空，导致访问 NAS 消息安全头失败。
4.  AMF 发生错误并崩溃，造成拒绝服务。

**项目地址:** [OHnogood/CVE-2025-29632](https://github.com/OHnogood/CVE-2025-29632)

**漏洞详情:** [CVE-2025-29632](https://nvd.nist.gov/vuln/detail/CVE-2025-29632)