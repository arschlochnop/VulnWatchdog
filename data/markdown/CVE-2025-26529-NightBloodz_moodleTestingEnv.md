## CVE-2025-26529-Moodle-Stored XSS

**漏洞编号:** CVE-2025-26529

**漏洞类型:** Stored XSS

**影响应用:** Moodle

**危害等级:** 高危，可能导致账户劫持和恶意代码执行

**影响版本:** 4.5.0 to 4.5.1, 4.4.0 to 4.4.5, 4.3.0 to 4.3.9, 4.1.0 to 4.1.15

**利用条件:** 需要能够向管理日志注入恶意代码，通常需要一定权限或欺骗管理员操作

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26529是Moodle管理界面实时日志中的一个存储型XSS漏洞。攻击者可以利用此漏洞将恶意JavaScript代码注入到管理日志中。当管理员查看日志时，这些恶意代码将被执行，从而可能导致管理员账户被劫持或执行其他恶意操作。

**有效性：**
提供的Dockerfile和docker-compose.yml文件配置了一个易受攻击的Moodle环境（版本4.4.5），明确声明其易受CVE-2025-26529攻击。exploit.py 脚本似乎旨在通过 Web 服务器提供payload，然后通过登录和其他操作来利用该漏洞。该脚本使用requests库与目标Moodle服务器交互，并使用正则表达式来提取登录令牌，这表明有效性较高。

**投毒风险：**
该代码仓库主要目的是搭建一个存在漏洞的环境，并提供一个简单的利用框架。虽然主要的漏洞利用脚本 (exploit.py) 和提供的JavaScript payload（alert(1)）本身没有明显的恶意行为，但仍然存在一些轻微的风险点:
*   服务器组件： Python脚本需要绑定到 IP 地址和端口，增加了暴露在恶意网络流量中的风险，除非谨慎使用，否则可能会被其他攻击者利用。虽然脚本的目的是为了方便漏洞利用，但也有可能被用于恶意目的。
*   依赖性风险：Dockerfile安装了一些不必要的组件, 增加了潜在攻击面。
*   第三方库风险: Python脚本依赖的requests库，存在被供应链攻击的风险。如果requests库被恶意篡改，可能会导致Python脚本执行恶意代码。
总体而言，投毒风险较低，约为10%。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建一个存在漏洞的Moodle环境 (版本4.4.5)。
2.  **准备Payload：**  准备一个恶意的JavaScript payload，例如修改管理员权限或执行其他恶意操作的代码。
3.  **启动攻击服务器：** 运行 exploit.py 脚本，设置适当的IP地址、端口和JavaScript文件路径。这个脚本会启动一个Web服务器来提供payload。
4.  **获取登录token:** 通过目标服务器获取login token。
5.  **注入XSS：**  构造包含恶意JavaScript代码的请求，将其注入到Moodle的管理日志中，可能通过伪造管理员身份、或者欺骗管理员点击链接的方式实现。
6.  **触发漏洞：**  等待管理员查看包含恶意代码的日志条目，或者诱导管理员查看。当管理员访问该日志条目时，恶意JavaScript代码将在管理员的浏览器中执行。

**项目地址:** [NightBloodz/moodleTestingEnv](https://github.com/NightBloodz/moodleTestingEnv)

**漏洞详情:** [CVE-2025-26529](https://nvd.nist.gov/vuln/detail/CVE-2025-26529)