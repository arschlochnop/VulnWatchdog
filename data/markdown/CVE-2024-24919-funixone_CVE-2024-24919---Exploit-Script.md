## CVE-2024-24919-CheckPoint安全网关信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** Check Point Security Gateway已连接到互联网，并启用了远程访问VPN或移动访问软件 blades

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919是一个存在于Check Point安全网关产品中的信息泄露漏洞。攻击者可以利用此漏洞，通过构造恶意的HTTP请求，读取目标系统上的任意文件。根据Truesec的博客，这是一个路径遍历漏洞，允许远程攻击者访问Gaia OS上的所有文件。Rapid7的博客也指出，攻击者可以读取受影响设备上的任意文件内容。提供的漏洞利用代码 `eploit.py` 是一个Python脚本，它接受一个目标列表文件作为输入，并尝试利用该漏洞读取 `/etc/shadow` 文件（或其他指定的文件）。它通过发送包含路径遍历payload的POST请求到 `/clients/MyCRL` 路径来实现。脚本检查响应内容是否包含 `root:` 或 `nobody:` 字符串，以判断漏洞是否成功利用。存在投毒风险的原因是：攻击者可能会在目标文件中写入恶意脚本，如果读取的文件被系统执行，则会造成更大的危害，虽然此处的脚本仅仅是读取文件，但不能排除攻击者将恶意代码加入到目标列表或自定义读取的文件中的可能性。 另外，POC代码中使用了 `verify=False` 禁用了SSL证书验证，这在生产环境中是不安全的，可能导致中间人攻击。User-Agent等Header字段虽然可以绕过一些简单的WAF，但同时也暴露了攻击者的特征。

**项目地址:** [funixone/CVE-2024-24919---Exploit-Script](https://github.com/funixone/CVE-2024-24919---Exploit-Script)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)