## CVE-2019-5418 Rails Action View 文件内容泄露漏洞

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1 和 v3

**利用条件:** 需要目标系统运行受影响的Rails版本，并存在可访问的控制器使用render file。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418 漏洞是 Rails Action View 组件中的一个文件内容泄露漏洞。攻击者可以通过构造特制的 Accept Header，结合 'render file:' 调用，读取目标服务器上的任意文件。从漏洞库信息和搜索结果来看，该漏洞是由于 Rails 在处理 Accept Header 时存在缺陷，导致可以绕过文件访问限制。提供的POC代码尝试通过修改 Accept Header 并发送请求，来读取/robots文件，以验证漏洞是否存在。通过分析 POC 代码，未发现任何恶意代码，该POC只是用来验证文件是否可以读取，因此投毒风险为0%。利用方式：攻击者通过修改HTTP请求的Accept Header，包含恶意路径，例如使用'../../../../'进行目录穿越，然后利用Rails的render file功能将目标文件作为模板渲染，从而读取文件内容。

**项目地址:** [kailing0220/CVE-2019-5418](https://github.com/kailing0220/CVE-2019-5418)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)