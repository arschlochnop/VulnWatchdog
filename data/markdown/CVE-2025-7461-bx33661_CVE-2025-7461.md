## CVE-2025-7461-ModernBag-SQL注入

**漏洞编号:** CVE-2025-7461

**漏洞类型:** SQL注入

**影响应用:** Modern Bag

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** 1.0

**利用条件:** 需要网络访问，并且用户已经登录 (存在Session)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Modern Bag V1.0的`/action.php`文件中，通过`proId`参数传递恶意SQL代码导致SQL注入漏洞。攻击者可以利用此漏洞执行任意SQL查询，包括读取、修改甚至删除数据库中的数据。从提供的POC代码来看，存在Boolean-based盲注、Error-based注入和Time-based盲注三种利用方式。

**有效性:** 提供的POC代码有效，可以成功利用该漏洞。

**投毒风险:** 仓库中的投毒风险较低。虽然无法完全排除作者恶意植入后门的可能，但是提供的代码主要是漏洞利用的演示，且代码逻辑相对简单，隐藏恶意代码的难度较高。主要风险来自于依赖的第三方库或组件中可能存在的恶意代码，但此分析只针对提供的POC。

**利用方式:**

1.  **Boolean-based Blind SQL 注入:**  通过构造`proId`参数，例如`1' RLIKE (SELECT (CASE WHEN (7142=7142) THEN 1 ELSE 0x28 END))-- jeVr`，根据页面返回结果的不同来判断SQL语句的执行结果，从而逐步获取数据库信息。
2.  **Error-based SQL 注入:**  通过构造`proId`参数，例如`1' OR (SELECT 7784 FROM(SELECT COUNT(*),CONCAT(0x716a716271,(SELECT (ELT(7784=7784,1))),0x717a6b7871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- yVDw`，利用数据库的错误信息来获取敏感数据。
3.  **Time-based Blind SQL 注入:**  通过构造`proId`参数，例如`1' AND (SELECT 9674 FROM (SELECT(SLEEP(5)))YLuC)-- ZZFJ`，使数据库执行SLEEP函数，通过响应时间来判断SQL语句的执行结果，从而逐步获取数据库信息。

**项目地址:** [bx33661/CVE-2025-7461](https://github.com/bx33661/CVE-2025-7461)

**漏洞详情:** [CVE-2025-7461](https://nvd.nist.gov/vuln/detail/CVE-2025-7461)