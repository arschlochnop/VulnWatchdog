## CVE-2025-28915-ThemeEgg ToolKit-任意文件上传

**漏洞编号:** CVE-2025-28915

**漏洞类型:** 任意文件上传

**影响应用:** ThemeEgg ToolKit

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** <= 1.2.9

**利用条件:** 需要具有 WordPress 后台管理权限的账户（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-28915 存在于 WordPress ThemeEgg ToolKit 插件中，允许具有足够权限的攻击者上传任意文件，包括 PHP Web Shell。利用方式如下：

1.  **版本检测：** 脚本首先检查目标 WordPress 站点是否安装了易受攻击的 ThemeEgg ToolKit 插件版本（<= 1.2.9）。通过访问 `readme.txt` 文件并解析版本号来实现。
2.  **身份验证：** 脚本尝试使用提供的用户名和密码登录 WordPress 后台。
3.  **Nonce 获取：** 登录成功后，脚本会访问 ThemeEgg ToolKit 的设置页面，并解析 HTML 源码，提取一个名为 `ajax_nonce` 的安全令牌（nonce 值）。这个 nonce 值用于绕过 CSRF 保护。
4.  **Web Shell 上传：** 脚本构造一个包含 Web Shell 代码的 POST 请求，目标是 WordPress 的 `admin-ajax.php` 文件。这个请求包含 `action`、`security` (nonce 值) 和 `customizer_file` (包含 Web Shell 代码的文件) 等参数。
5.  **利用：** 上传成功后，脚本会打印出 Web Shell 的潜在路径，并提供一个示例命令，允许攻击者通过 Web 浏览器执行任意命令。攻击者通过访问 `shell.php?cmd=恶意命令` 即可执行服务器命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断提供的POC代码是有效的。搜索引擎结果中多个链接都描述了该漏洞的细节，以及`web shell`上传的描述。POC代码本身实现了版本检测、登录、Nonce获取、Web Shell上传等步骤。

**投毒风险：**

该漏洞利用代码的主要功能是上传一个简单的 Web Shell，允许攻击者执行任意命令。评估投毒风险时，我们需要考虑以下几个方面：

*   **显式恶意代码：** 代码中包含 `<?php system($_GET['cmd']); ?>` 这样的 Web Shell 代码，这是一个后门，但它是漏洞利用本身的一部分，并非隐藏的恶意代码。
*   **隐蔽性：** 该POC代码相对清晰，主要功能是利用漏洞，没有明显的隐藏恶意行为或超出漏洞利用范围的操作。
*   **作者信誉：** 由于作者信息有限，难以评估作者的信誉。但漏洞利用代码的功能与漏洞描述相符，没有明显的投毒迹象。
*   **依赖性：** 漏洞利用代码依赖于 `requests` 和 `BeautifulSoup4` 库，这些库本身是常用的 Python 库，被投毒的概率较低。

综合以上分析，虽然该代码包含一个 Web Shell 后门，但这属于漏洞利用的必要组成部分，并非额外的投毒行为。作者隐藏其他恶意代码的可能性较低。因此，投毒风险估计为 **10%**。

**项目地址:** [Nxploited/CVE-2025-28915](https://github.com/Nxploited/CVE-2025-28915)

**漏洞详情:** [CVE-2025-28915](https://nvd.nist.gov/vuln/detail/CVE-2025-28915)