## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版中，且系统使用SSH。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094是XZ Utils中的一个供应链攻击，攻击者通过恶意代码修改了liblzma库，该库被广泛用于数据压缩。攻击者通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的目标文件，然后使用该文件来修改liblzma代码中的特定函数。最终导致修改后的liblzma库可以被任何链接到该库的软件使用，从而拦截和修改与该库的数据交互。

**有效性：**
根据漏洞描述和搜索结果，该漏洞的POC是有效的，已经证实存在于XZ Utils 5.6.0和5.6.1版本中。成功利用会导致远程代码执行。

**投毒风险：**
提供的漏洞利用代码是 `CC0 1.0 Universal` 协议的许可证文本。这个文件本身**不是**漏洞利用代码，而是开源协议，不包含恶意代码或者后门。这个代码只是说明了这个代码仓库使用的许可证。因此，根据提供的代码片段,投毒风险为0%。实际的恶意代码位于XZ Utils的构建过程中，通过复杂的混淆技术植入。

**利用方式：**
攻击者首先需要获得对XZ Utils项目源代码的贡献权限。然后，通过精心构造的恶意代码和混淆技术，将后门植入到源代码中。在构建过程中，恶意代码会被提取并注入到liblzma库中。当其他软件链接到这个被篡改的liblzma库时，攻击者就可以通过SSH等服务进行未经授权的远程访问。具体来说，后门会修改SSH的认证过程，允许攻击者绕过身份验证并执行任意代码。

**参考资料：**
*   CVE-2024-3094 Detail - NVD: [https://nvd.nist.gov/vuln/detail/cve-2024-3094](https://nvd.nist.gov/vuln/detail/cve-2024-3094)
*   CVE-2024-3094 XZ Backdoor: All you need to know: [https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/](https://jfrog.com/blog/xz-backdoor-attack-cve-2024-3094-all-you-need-to-know/)
*   CVE-2024-3094: A Backdoor in XZ Utils Leads to Remote ...: [https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution](https://www.picussecurity.com/resource/blog/cve-2024-3094-a-backdoor-in-xz-utils-leads-to-remote-code-execution)

**项目地址:** [przemoc/xz-backdoor-links](https://github.com/przemoc/xz-backdoor-links)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)