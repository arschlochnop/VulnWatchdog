## CVE-2025-29927-Next.js-中间件鉴权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 鉴权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据和功能

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** Next.js 应用使用了存在漏洞的中间件配置，且允许外部请求包含 'x-middleware-subrequest' 头部。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件鉴权绕过漏洞。该漏洞源于 Next.js 对 `x-middleware-subrequest` 头部处理不当。当请求包含该头部时，中间件中的鉴权逻辑可能被绕过，导致攻击者可以未经授权访问受保护的资源。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有多个报告和分析文章佐证。提供的 POC 代码 `exploit.py` 利用了 `x-middleware-subrequest` 头部来绕过鉴权，因此 POC 代码有效。

**投毒风险：**
提供的代码主要是一个简单的 HTTP 代理服务器，用于添加 `X-Middleware-Subrequest` 头部以及其他自定义头部（通过环境变量 `PROXY_HEADERS` 设置）。代码本身功能清晰，没有发现隐藏的恶意代码。虽然可以通过环境变量 `PROXY_HEADERS` 添加任意 Header, 但这是脚本的正常功能, 不能算作投毒。因此，投毒风险评估为 0%。

**利用方式：**
1.  运行 `exploit.py` 脚本，启动一个代理服务器。
2.  配置浏览器或其他 HTTP 客户端使用该代理。
3.  向 Next.js 应用发送请求，代理会自动添加 `X-Middleware-Subrequest` 头部（以及通过环境变量指定的其他头部）。
4.  如果 Next.js 应用存在漏洞且中间件鉴权逻辑存在缺陷，请求将绕过鉴权，攻击者可以访问本应受到保护的资源。

**项目地址:** [hed1ad/my-CVE-2025-29927](https://github.com/hed1ad/my-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)