## CVE-2025-29927-Next.js中间件权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标网站使用受影响版本的 Next.js，并且权限验证逻辑在中间件中实现。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是一个 Next.js 中间件的权限绕过漏洞。攻击者可以通过发送包含特制 `x-middleware-subrequest` 头的请求，绕过中间件中的身份验证检查，从而访问受保护的资源。

**有效性：** 提供的 PoC 代码看起来是有效的，它通过检查目标网站的 Next.js 版本来判断是否存在漏洞。它使用了 `puppeteer` 模拟浏览器行为，并且通过 `window.next?.version` 获取 Next.js 版本信息，这个方法是可行的。如果检测到 Next.js 版本在受影响范围内，则认为目标网站存在漏洞。

**投毒风险：** 代码中存在一定的低风险投毒可能性。例如，`checkFrameWork`函数中存在console输出，如果被攻击者利用，可能会进行迷惑，但影响有限。

更重要的是，该PoC的主要功能是漏洞检测，而不是漏洞利用。其目的是帮助安全研究人员和开发人员识别潜在的漏洞，并采取相应的修复措施。该代码本身不包含任何可以直接利用漏洞的代码。因此，将该PoC用于非授权的渗透测试或攻击行为是非法的。因此，整体投毒风险为10%。

**利用方式：**
1.  攻击者确定目标网站使用的 Next.js 版本是否在受影响范围内。
2.  如果目标网站存在漏洞，攻击者构造包含 `x-middleware-subrequest` 头的 HTTP 请求。
3.  将构造的请求发送到目标网站。由于中间件的权限验证存在缺陷，攻击者可以绕过验证，访问受保护的资源。

**搜索引擎结果：** 搜索结果表明这是一个关键漏洞，许多安全厂商都对此进行了分析和报告，进一步验证了该漏洞的有效性和严重性。

**项目地址:** [ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927](https://github.com/ferpalma21/Automated-Next.js-Security-Scanner-for-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)