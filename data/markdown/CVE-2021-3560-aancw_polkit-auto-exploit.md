## CVE-2021-3560-polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，可导致本地普通用户获取root权限

**影响版本:** polkit 0.119及更早版本，受影响发行版包括RHEL 8、Ubuntu 20.04等

**利用条件:** 本地用户可以访问D-Bus

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过绕过 polkit 的身份验证检查来提升权限，最终获得 root 权限。根据提供的漏洞信息和搜索引擎结果，此漏洞影响多个 Linux 发行版。利用方式是攻击者通过 D-Bus 向 polkit 发送特权操作请求，利用 polkit 验证逻辑中的缺陷，绕过身份验证，从而执行特权操作。

**漏洞利用的有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞利用是有效的。搜索引擎结果中包含大量关于该漏洞的分析、利用方法和受影响的发行版的信息，表明该漏洞具有实际可利用性。提供的 PoC 代码也证实了这一点。

**投毒风险：**

提供的 PoC 代码包含以下文件：LICENSE, README.md, go.mod 和一个可执行文件。 README.md 文件描述了漏洞的利用方法，并提供了示例用法。代码使用 `accountsservice` 的两个特权方法 `CreateUser` 和 `SetPassword` 来创建一个具有 sudo 权限的新用户，然后使用新用户登录并获得 root 权限。代码逻辑本身并没有明显的恶意行为。然而，仍存在一定的投毒风险：

1.  **隐藏的后门：** 虽然快速浏览代码没有发现明显后门，但由于 PoC 代码是用 Go 语言编写的，且未提供完整的源代码，无法完全排除在编译后的二进制文件中植入后门的可能。后门可能会在用户不知情的情况下执行恶意操作，例如收集系统信息、安装恶意软件等。
2.  **依赖风险：** `go.mod` 文件表明代码使用了 Go 语言的模块管理系统。如果 PoC 代码依赖了不安全的第三方模块，攻击者可能会通过篡改这些模块来引入恶意代码。
3. **延时触发:** 可能存在一些延时触发的恶意代码，这些代码可能需要满足特定条件才会执行。

因此，虽然直接证据不多，但考虑到安全风险，仍然认为此 PoC 存在一定比例的投毒风险。更完整的代码分析和代码审计才能对此做出更准确的评估。

**漏洞利用方式：**

1.  **利用 D-Bus 接口：** 攻击者利用 polkit 提供的 D-Bus 接口发送特权操作请求。
2.  **绕过身份验证：** 通过某种手段绕过 polkit 的身份验证检查。
3.  **执行特权操作：** 成功绕过身份验证后，攻击者可以执行原本需要授权才能执行的特权操作，例如创建用户、修改密码等。
4.  **提升权限：** 通过创建具有 sudo 权限的用户，或者修改现有用户的权限，最终获得 root 权限。

**项目地址:** [aancw/polkit-auto-exploit](https://github.com/aancw/polkit-auto-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)