## CVE-2025-26794-Exim-SQL注入

**漏洞编号:** CVE-2025-26794

**漏洞类型:** SQL注入

**影响应用:** Exim

**危害等级:** 高危，可能导致信息泄露和远程命令执行

**影响版本:** 4.98 (不含 4.98.1)

**利用条件:** 需要开启SQLite hints和ETRN序列化

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26794是Exim 4.98版本（低于4.98.1）中存在的一个SQL注入漏洞。当Exim同时使用SQLite hints和ETRN序列化时，攻击者可以通过构造恶意的SQL语句，注入到SQLite数据库查询中，从而执行未授权的SQL命令。根据漏洞库信息，CVSS 3.1评分为7.5，属于高危漏洞。

**漏洞利用有效性：**

根据提供的漏洞利用代码（Dockerfile和相关配置文件），该代码创建了一个Exim 4.98的Docker镜像，并配置了SQLite支持。Dockerfile主要作用是搭建漏洞环境，包含以下关键步骤：

*   从Debian镜像构建。
*   安装Exim所需的依赖库（包括libsqlite3-dev和sqlite3）。
*   克隆Exim的git仓库，并checkout到4.98版本。
*   修改`Local/Makefile`以启用SQLite支持（`USE_SQLITE = yes`和`DBMLIB = -lsqlite3`）。
*   编译并安装Exim。

这些步骤表明PoC代码是有效的，因为它创建了一个存在漏洞的环境，方便研究和验证。

根据搜索引擎结果，[webpage 6] 提到“The SQL parameters, when SQLite is used as the DBM, are not properly sanitized. This results in the possibility of a remote user to craft custom SQLite queries.”，进一步确认了漏洞的可利用性。

**投毒风险分析：**

分析Dockerfile和Makefile-Linux，没有发现明显的恶意代码或后门，但存在潜在的风险：

*   PoC为了简化过程，可能关闭了一些安全选项，这本身就引入了安全风险。
*   `start-exim.sh` 文件内容缺失，无法评估其安全性，存在一定风险。
*   虽然启用了SQLite，但`configure`文件内容并不完整，缺少关于SQLite hints和ETRN序列化如何配置的细节，如果配置不当可能导致其他安全问题。
*   PoC中对EXIM_USER进行了修改，可能导致权限问题。

综合来看，投毒的可能性较低，大约为10%。主要风险在于PoC环境的安全性可能低于生产环境，容易被攻击者利用进行进一步渗透。

**利用方式：**

该漏洞的利用方式是通过向Exim发送特制的ETRN请求，其中包含恶意的SQL代码。当Exim处理该请求并将其插入到SQLite数据库查询中时，恶意SQL代码将被执行。攻击者可以通过这种方式读取、修改甚至删除数据库中的数据，或者执行其他恶意操作。常见的攻击方法包括：

*   **信息泄露：** 攻击者可以通过注入SQL查询，获取数据库中的敏感信息，例如用户凭据、邮件内容等。
*   **权限提升：** 如果Exim以高权限用户身份运行，攻击者可以通过SQL注入执行系统命令，从而获得服务器的控制权。
*   **拒绝服务：** 攻击者可以通过注入SQL查询，导致数据库崩溃或Exim进程挂起，从而造成拒绝服务攻击。

**项目地址:** [ishwardeepp/CVE-2025-26794-Exim-Mail-SQLi](https://github.com/ishwardeepp/CVE-2025-26794-Exim-Mail-SQLi)

**漏洞详情:** [CVE-2025-26794](https://nvd.nist.gov/vuln/detail/CVE-2025-26794)