## CVE-2021-3560 - Polkit Local Privilege Escalation

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地非特权用户获取root权限，导致数据泄露、完整性破坏和系统不可用。

**影响版本:** Polkit 0.0 - 0.118

**利用条件:** 本地访问，目标系统安装了存在漏洞的Polkit版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许本地非特权用户通过绕过D-Bus请求的凭据检查来提升权限至root。提供的PoC代码通过利用此漏洞，创建一个具有指定用户名和密码的新的本地管理员。 

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出 Polkit 可以被欺骗绕过凭据检查，从而提升权限。搜索引擎结果也证实了该漏洞的存在，并提供了相关的利用文章和修复方案。提供的 PoC 代码也展示了如何利用该漏洞创建一个新的本地管理员。

**投毒风险：**

评估PoC代码，风险主要体现在以下几个方面：

*   **依赖安装风险：** PoC代码需要安装一些依赖，例如`gnome-control-center`, `openssl`, `sudo`，而这些依赖的安装过程可能存在风险。
*   **脚本执行风险：**  直接执行未经验证的PoC脚本始终存在潜在风险。攻击者可能在脚本中添加恶意代码，例如，删除系统关键文件、安装后门程序等。尽管目前代码没有发现恶意行为，但需要保持警惕。
*   **github仓库风险：** git clone仓库时，如果github仓库被攻陷，可能下载到被投毒的代码。

综合考虑，投毒风险评定为10%。这个百分比反应的是执行未经审查的第三方PoC代码的固有风险，而不是代码中存在明显恶意行为的确定性。

**利用方式：**

1.  **克隆PoC代码：** 从GitHub仓库克隆漏洞利用代码。
2.  **安装依赖：**  安装脚本所需的依赖项，例如 `gnome-control-center`、`openssl` 和 `sudo`。
3.  **执行漏洞利用脚本：** 运行 `exploit-CVE-2021-3560.py` 脚本，并指定要创建的用户名和密码。脚本将利用 Polkit 的漏洞绕过权限验证，创建一个新的具有 root 权限的用户。
4.  **验证：**  使用新创建的用户登录系统，并验证是否具有 root 权限。

**项目地址:** [asepsaepdin/CVE-2021-3560](https://github.com/asepsaepdin/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)