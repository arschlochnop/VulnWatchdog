## CVE-2025-0411-7-Zip-Mark-of-the-Web绕过

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web绕过

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** 24.08 (x64)

**利用条件:** 用户需要下载并使用7-Zip解压恶意构造的双重嵌套压缩包

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-0411是一个7-Zip的Mark-of-the-Web (MotW) 绕过漏洞。攻击者可以构造一个双重嵌套的恶意压缩包，当用户使用受影响的7-Zip版本（例如24.08 x64）解压该压缩包时，其中的恶意文件会失去MotW标记，从而允许执行而不会显示安全警告。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的C++ POC代码本身是一个简单的 shellcode 加载器，它分配内存、将shellcode复制到该内存，然后将该内存标记为可执行并执行。其有效性取决于提供的shellcode是否是针对目标的有效 payload。如果替换成有效的shellcode,则可以利用该漏洞。

**投毒风险：**

虽然POC中包含shellcode加载器，且shellcode部分为空。但考虑到`README.md` 文件中警告用户不要在未经授权的系统上运行POC，且代码功能明确，没有隐藏的恶意行为，初步评估投毒风险较低。但因为shellcode需要用户自行添加,且没有对shellcode做任何安全校验,需要用户自行承担风险，可以将投毒风险评估为极低（1%）。

**利用方式：**
1.  攻击者制作一个包含恶意文件的双重嵌套压缩包。
2.  攻击者诱骗用户下载并使用7-Zip解压该压缩包。
3.  7-Zip在解压过程中未能正确传递MotW标记，导致恶意文件失去安全警告。
4.  用户执行该恶意文件，攻击者即可在用户上下文中执行任意代码。在`CVE-2025-0411.cpp`文件中，需要替换掉`unsigned char p[]` 中的注释 `//calc.exe shellcode` 为攻击者自己的shellcode, 例如打开计算器或者反弹shell的payload。然后进行编译，生成恶意程序，然后配合双重压缩包进行攻击。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-0411](https://github.com/B1ack4sh/Blackash-CVE-2025-0411)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)