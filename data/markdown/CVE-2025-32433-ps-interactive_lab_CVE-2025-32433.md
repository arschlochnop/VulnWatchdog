## CVE-2025-32433-Erlang/OTP-SSH远程代码执行

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** OTP-25.3.2.20之前，OTP-26.0-rc1到OTP-26.2.5.11，以及OTP-27.0-rc1到OTP-27.3.3

**利用条件:** 目标系统运行受影响版本的Erlang/OTP SSH服务，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32433是Erlang/OTP SSH服务器中的一个严重漏洞，允许未经身份验证的攻击者执行远程代码。该漏洞源于SSH协议消息处理中的缺陷。攻击者可以通过发送特制的SSH消息，在目标系统上执行任意命令，而无需提供有效的身份凭证。

**利用方式分析：**

该漏洞的利用方式如下：

1.  **建立连接：** 攻击者首先与目标Erlang/OTP SSH服务器建立TCP连接。
2.  **发送恶意KEXINIT数据包：** 攻击者发送一个包含恶意信息的SSH_MSG_KEXINIT数据包，该数据包用于密钥交换。
3.  **发送恶意CHANNEL_OPEN数据包：** 攻击者发送一个恶意的SSH_MSG_CHANNEL_OPEN数据包，要求打开一个通道。
4.  **发送恶意CHANNEL_REQUEST数据包：** 攻击者发送一个包含要执行的命令的SSH_MSG_CHANNEL_REQUEST数据包，该数据包在身份验证之前发送。

提供的PoC代码通过以下步骤利用该漏洞：

*   连接到目标SSH服务器。
*   发送包含受支持算法的SSH_MSG_KEXINIT包。
*   发送SSH_MSG_CHANNEL_OPEN包以打开通道。
*   发送SSH_MSG_CHANNEL_REQUEST包，其中包含要执行的Erlang命令`file:write_file("/lab.txt", <<"pwned">>).`。此命令将在目标系统上创建一个名为/lab.txt的文件，并将"pwned"写入该文件。

**有效性评估：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。搜索引擎结果中的多个页面都确认了该漏洞的存在和严重性。PoC代码实现了未经身份验证的远程代码执行，符合漏洞描述。

**投毒风险评估：**

该PoC代码主要目的是演示漏洞利用，而非进行恶意投毒。代码的功能比较直接，即建立连接并发送特定的SSH消息来触发漏洞。尽管攻击者可以修改PoC代码以执行其他恶意操作，但原始代码本身不包含任何隐藏的恶意功能。

Dockerfile用于构建存在漏洞的Erlang/OTP环境，ssh_server.erl是用于启动ssh服务的代码，不包含恶意代码。

综合分析，PoC代码本身投毒的概率非常低，大约为1%。主要是因为代码的目的是验证漏洞存在性，而不是植入后门或者进行恶意攻击。


**项目地址:** [ps-interactive/lab_CVE-2025-32433](https://github.com/ps-interactive/lab_CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)