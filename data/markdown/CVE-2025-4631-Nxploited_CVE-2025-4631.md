## CVE-2025-4631-Profitori-权限提升

**漏洞编号:** CVE-2025-4631

**漏洞类型:** 权限提升

**影响应用:** Profitori WordPress Plugin

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** 2.0.6.0 - 2.1.1.3

**利用条件:** WordPress 站点安装了受影响版本的 Profitori 插件，并且可以未经身份验证访问 stocktend_object 端点。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Profitori WordPress插件中，由于stocktend_object端点缺少权限验证，未经身份验证的攻击者可以通过构造包含 '_datatype': 'users' 的恶意请求，使用 save_object_as_user() 函数修改用户 wp_capabilities 元数据字段，从而将现有用户或新创建的用户提升为管理员权限。

**有效性分析：**
根据漏洞信息和提供的漏洞利用代码，该漏洞利用代码有效。它首先检查插件版本，然后构造一个包含要修改的用户ID和新的wp_capabilities的JSON有效负载，并将其发送到stocktend_object端点。如果成功，它将打印更新后的用户信息，包括新的角色。

**投毒风险分析：**
分析了提供的漏洞利用代码和许可证文件，发现存在潜在的轻微投毒风险。虽然核心漏洞利用代码本身似乎是干净的，旨在利用已知的安全漏洞，但存在一些需要考虑的因素：

*   **依赖外部资源：** 该脚本依赖于 `requests` 库，这是一个常见的 Python 库，用于发起 HTTP 请求。 但是，攻击者可能会尝试通过替换或修改此依赖项（如果用户从非官方来源安装）来引入恶意代码。
*   **作者信息：** 该脚本包含作者的联系信息（GitHub 链接和电子邮件地址）。虽然这本身并不一定是恶意的，但它可能被利用来分发包含恶意修改的脚本的更新版本。
*   **MIT 许可证：** 该许可证允许修改和分发代码。 虽然这促进了代码共享和改进，但也意味着攻击者可以修改脚本以包含恶意代码并将其重新分发。
*   **版本检查旁路：**脚本包含一个版本检查，但也有一个后备方案，如果版本检查失败，脚本会尝试利用该漏洞。 虽然这对于处理版本检查失败是必要的，但这也可能被滥用，因为绕过这个检查可能会导致意外行为。
*   **用户输入：** 该脚本接受多个用户输入（URL、用户ID、电子邮件、名称、URL字段）。 如果这些输入未经过正确验证或清理，则可能会导致其他漏洞（例如，如果URL字段被用来重定向到恶意网站或执行客户端攻击）。

**利用方式：**
1.  **确定目标网站：** 找到安装了受影响版本 Profitori 插件的 WordPress 网站。
2.  **确定用户ID：** 找到要提升权限的用户的ID。这通常可以通过枚举用户或通过其他漏洞获取。
3.  **构造请求：** 使用提供的漏洞利用代码，替换目标 URL 和用户 ID。还可以选择性地修改电子邮件、显示名称和 URL 字段。
4.  **发送请求：** 运行漏洞利用代码，该代码将向 stocktend_object 端点发送 POST 请求，其中包含构造的 JSON 有效负载，该负载将用户的 wp_capabilities 设置为“administrator”。
5.  **验证：** 成功执行漏洞利用后，使用提升的权限登录到 WordPress 网站。

**项目地址:** [Nxploited/CVE-2025-4631](https://github.com/Nxploited/CVE-2025-4631)

**漏洞详情:** [CVE-2025-4631](https://nvd.nist.gov/vuln/detail/CVE-2025-4631)