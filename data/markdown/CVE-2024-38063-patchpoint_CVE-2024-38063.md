## CVE-2024-38063: Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 严重，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息。

**利用条件:** 需要启用IPv6。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-38063是一个Windows TCP/IP协议栈中的远程代码执行漏洞。该漏洞存在于IPv6处理过程中。PoC代码显示，攻击者可以通过发送特制的IPv6数据包（包含IPv6扩展头DestOpt和Fragment）来触发漏洞。利用方式是：

1.  **发送特制的IPv6包：** 攻击者需要构造包含特定格式的IPv6包，包括`IPv6ExtHdrDestOpt`和`IPv6ExtHdrFragment`扩展头。
2.  **触发整数下溢：**  漏洞描述中提到CWE-191（整数下溢）。推测漏洞发生在处理IPv6包长度或偏移量时，由于整数下溢导致缓冲区溢出或其他内存错误，最终造成RCE。
3.  **远程代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码。

**有效性：** 根据搜索结果和提供的PoC代码，此PoC代码的有效性高。许多安全研究人员已经发布了关于此漏洞的分析和PoC。

**投毒风险：** 分析PoC代码，代码本身较为简洁，仅构造并发送了两个IPv6数据包。从代码本身来看，没有明显的投毒迹象。但考虑到安全风险, 仍然存在一定的投毒风险，可能性为10%。例如，该脚本可能依赖特定版本的`scapy`库，如果安装了恶意修改的`scapy`版本，则可能存在隐患。虽然几率较小，依旧存在被植入后门的风险。

**项目地址:** [patchpoint/CVE-2024-38063](https://github.com/patchpoint/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)