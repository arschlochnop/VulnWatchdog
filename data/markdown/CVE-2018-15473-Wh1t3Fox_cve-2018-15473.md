## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可作为攻击链的一部分

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务开启且版本小于等于7.7

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞允许未经授权的攻击者通过发送无效的身份验证请求来枚举OpenSSH服务器上的有效用户名。漏洞存在于OpenSSH 7.7及更早版本中，原因是服务器在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的退出。

**漏洞利用有效性：**
提供的POC代码（ssh-username-enum.py）旨在利用此漏洞。它使用Paramiko库与目标SSH服务器建立连接，并尝试使用不同的用户名进行身份验证。根据服务器响应时间的差异，可以判断用户名是否存在。

**投毒风险：**
仔细检查了提供的POC代码和相关文件（LICENSE, README.md, requirements.txt）。没有发现任何明显的恶意代码或后门。代码结构清晰，功能明确，主要依赖于Paramiko库进行SSH连接和身份验证尝试。requirements.txt 文件中列出的依赖库都是常见的Python库，没有发现可疑的库。因此，投毒风险评估为0%。

**利用方式：**
1.  **安装依赖：** 使用`pip install -r requirements.txt`安装所需的Python库，主要是`paramiko`。
2.  **运行脚本：**
    *   使用`-u`参数指定单个用户名进行测试，例如：`./ssh-username-enum.py -u testuser 192.168.1.100`
    *   使用`-w`参数指定用户名字典文件进行批量测试，例如：`./ssh-username-enum.py -w usernames.txt 192.168.1.100`
    *   使用`-t`参数指定线程数以加快枚举速度，例如：`./ssh-username-enum.py -t 10 -w usernames.txt 192.168.1.100`
    *   `-6` 参数指定IPv6地址。
    *   `-p` 参数指定非默认SSH端口。
    *   `-v` 参数增加输出信息的详细程度。
3.  **分析结果：** 脚本会根据服务器的响应判断用户名是否存在，并输出结果。

该漏洞本身并不能直接导致系统被攻陷，但它可以作为攻击链中的一个环节，帮助攻击者收集信息，为后续的攻击做准备，例如密码破解等。

**项目地址:** [Wh1t3Fox/cve-2018-15473](https://github.com/Wh1t3Fox/cve-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)