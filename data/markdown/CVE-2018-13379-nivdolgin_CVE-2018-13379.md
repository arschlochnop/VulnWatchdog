## CVE-2018-13379-Fortinet-Path Traversal

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7, 5.4.6 to 5.4.12; FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要启用SSL VPN web portal且目标设备存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-13379 存在于 Fortinet FortiOS 和 FortiProxy 的 SSL VPN web portal 中，是一个典型的路径遍历漏洞。未经身份验证的攻击者可以构造恶意的 HTTP 请求，下载系统文件。从提供的漏洞库信息和搜索引擎结果来看，该漏洞影响多个版本的 FortiOS 和 FortiProxy。漏洞利用代码提供了一个 CSV 文件，列出了攻击者可能会部署的恶意软件的路径和哈希值，例如 Mimikatz 和 Cobalt Strike 相关组件。由于文件列表本身并不包含恶意代码，并且其目的是为了检测攻击是否发生，所以投毒的可能性较低，但存在被误导的可能性，例如将正常使用的工具判定为恶意软件。

**有效性：**
提供的 CSV 文件本身不是漏洞利用代码，而是入侵威胁指标 (IOCs)。它用于检测受害者是否已经被攻击，而不是进行漏洞利用。因此，提供的 "POC 代码" 并非实际的漏洞利用脚本，而是用于威胁检测的。
根据漏洞描述和搜索结果，实际的漏洞利用是通过构造包含路径遍历的 HTTP 请求来实现的。例如：`https://<fortigate_ip>/dana-na/../../../../../etc/passwd` 这样的请求可能用于读取 `/etc/passwd` 文件。

**投毒风险：**
提供的 IOC 文件列出了常见的攻击工具，例如 Mimikatz 和 Cobalt Strike。这些工具本身并非恶意软件，而是合法的渗透测试工具。如果将这些工具全部标记为恶意，可能会导致误报，属于广义上的“投毒”，使得安全分析人员花费大量时间调查并非真正恶意的活动。所以投毒风险为10%。

**利用方式：**
1.  攻击者通过发送特制的 HTTP 请求到 FortiOS/FortiProxy 设备的 SSL VPN web portal。
2.  该请求包含路径遍历字符（如 `../`），用于绕过文件访问限制。
3.  攻击者可以读取任意系统文件，例如包含 VPN 用户凭据的配置文件。
4.  获取凭据后，攻击者可以进一步访问内部网络。
5.  攻击者可能会部署额外的恶意软件，例如 Mimikatz 或 Cobalt Strike，用于横向移动和持久化。

简单来说，利用方式是利用未经身份验证的路径遍历漏洞读取敏感文件。

**项目地址:** [nivdolgin/CVE-2018-13379](https://github.com/nivdolgin/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)