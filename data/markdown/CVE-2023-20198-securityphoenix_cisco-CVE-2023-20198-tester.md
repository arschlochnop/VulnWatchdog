## CVE-2023-20198-Cisco IOS XE Web UI权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，允许未授权的攻击者创建具有特权15的本地用户，从而完全控制设备

**影响版本:** 受影响的版本包括 16.1.1 到 17.12.1 以及其他版本

**利用条件:** Web UI 功能必须已启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据漏洞信息和搜索结果，CVE-2023-20198 允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建具有 privilege level 15 （最高权限）的本地用户。漏洞利用涉及向 Web UI 发送特制的 HTTP POST 请求，绕过身份验证机制。创建具有最高权限的用户后，攻击者可以使用该账户执行任意命令，并完全控制设备。提供的 `cisco_tester.py` 脚本旨在检测目标设备是否受到 CVE-2023-20198 的影响。它通过向 `/webui/logoutconfirm.html?logon_hash=1` 发送 POST 请求，并检查响应中是否包含特定的字符串 `1a80b7389ccd0a5dab` 来判断设备是否已被入侵。该字符串很可能是一个被利用的设备的特征。

**有效性:**

根据漏洞库信息、搜索结果（特别是 https://www.horizon3.ai/attack-research/attack-blogs/cisco-ios-xe-cve-2023-20198-deep-dive-and-poc/）和漏洞利用代码，该漏洞的利用是有效的，已经有公开可用的PoC。

**投毒风险:**

提供的Python脚本本身主要是一个检测工具，用于检查Cisco设备是否受到CVE-2023-20198的影响，它通过检测特定Hash值判断系统是否已经被植入后门。该脚本逻辑比较简单，主要功能为发送HTTP请求并匹配特定字符串。风险点可能在于脚本对异常的处理不够严谨，如果目标存在其他漏洞，可能被利用，但从代码本身来看，投毒的可能性较低，例如作者没有隐藏恶意的代码执行、数据窃取等行为。可以认为投毒风险极低，可能性约为1%。

**利用方式:**

1.  **未经身份验证的权限提升:**  攻击者利用 CVE-2023-20198 在 Cisco IOS XE 设备上创建一个具有最高权限 (privilege level 15) 的本地用户。
2.  **初始访问:**  利用漏洞绕过 Web UI 的身份验证机制。
3.  **命令执行:**  使用新创建的特权用户账户登录并执行任意命令，实现对设备的完全控制。
4.  **植入后门:** 利用CVE-2023-20273，提升权限至root,写入后门文件。

总而言之，此漏洞允许攻击者完全控制受影响的Cisco设备，风险极高。

**项目地址:** [securityphoenix/cisco-CVE-2023-20198-tester](https://github.com/securityphoenix/cisco-CVE-2023-20198-tester)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)