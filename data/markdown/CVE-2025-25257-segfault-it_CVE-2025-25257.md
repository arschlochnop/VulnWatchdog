## CVE-2025-25257-FortiWeb-SQL注入到RCE

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** 7.6.0 <= version <= 7.6.3
7.4.0 <= version <= 7.4.7
7.2.0 <= version <= 7.2.10
7.0.0 <= version <= 7.0.10

**利用条件:** 需要网络访问FortiWeb的GUI组件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个SQL注入漏洞。未经身份验证的攻击者可以通过精心设计的HTTP或HTTPS请求执行未经授权的SQL代码或命令。

**有效性：**
根据漏洞信息、搜索结果和提供的POC代码，此漏洞是有效的。多个来源 (NVD, FortiGuard Labs, Arctic Wolf, Greenbone, CISecurity, waterisac, watchtowr, Red Hat, SOC Prime) 确认了该漏洞的存在，并且公开了POC。

**投毒风险：**
虽然此POC主要功能是复现漏洞，但仍然存在一些投毒风险，主要体现在以下几点：

1.  **硬编码IP地址和端口：**  POC代码中硬编码了反向shell的IP地址和端口 (`192.168.18.1/4444`)。如果未经修改直接使用此POC，攻击者可能会连接到错误的IP，导致攻击失败或暴露攻击者的IP地址。 这是一种潜在的蜜罐陷阱或者误导行为。占比：5%
2.  **依赖特定的环境：**  POC依赖于特定的python库，如果目标环境缺少这些库，POC可能无法执行。占比：3%
3.  **潜在的后门代码：** 尽管主要目的是PoC，理论上作者可以在SQL注入过程中注入恶意代码，例如添加用户账户等，但从当前代码来看，没有明显的后门功能。占比：2%

因此，综合来看，投毒风险较低，为10%。使用者应该仔细审查代码，修改硬编码的IP地址和端口，并确保目标环境满足POC的依赖。

**利用方式：**
1.  **SQL注入：**  攻击者利用`Authorization` header中的SQL注入点，通过构造恶意的SQL语句执行未经授权的数据库操作。
2.  **写入文件：**  攻击者使用`SELECT ... INTO OUTFILE`语句将恶意payload写入到文件系统中，特别是`/var/log/lib/python3.10/site-packages/k.pth`。由于此路径在python的启动路径中，因此可以执行恶意的python代码
3.  **远程代码执行 (RCE)：**  通过访问`/cgi-bin/ml-draw.py`触发恶意`.pth`文件的执行，从而获得服务器的远程代码执行权限。
4.  **反向shell：**  写入的Payload是一个反向shell，攻击者可以监听指定的端口，从而控制受害服务器。

**项目地址:** [segfault-it/CVE-2025-25257](https://github.com/segfault-it/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)