## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE (XML External Entity)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1 (运行于 PHP 8)

**利用条件:** 需要 WordPress 运行于 PHP 8，且攻击者具备上传文件的权限（如 Author 角色）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是 WordPress 在处理媒体库上传文件时存在的 XXE 漏洞。攻击者可以上传包含恶意 XML 内容的文件（例如特制的 WAV 文件），利用 XML 解析器的缺陷读取服务器上的敏感文件。漏洞触发条件是 WordPress 运行在 PHP 8 环境下。提供的 Go 语言 POC 代码可以自动生成恶意文件（mal.wav, mal.dtd），并可以选择自动登录 WordPress 站点并上传触发漏洞。如果指定了 `-d` 参数，还会生成一个 deflate.php 用于解压缩某些被压缩的内容。根据代码分析，主要的风险在于它连接外部的C2服务器,存在极低的投毒风险,即作者利用C2服务器可以获取攻击目标的敏感信息。但是，因为C2服务器需要在攻击者本地运行，因此这个风险可以忽略不计。此漏洞的利用方式为：

1.  生成恶意 WAV 文件和 DTD 文件。
2.  攻击者需要具有 WordPress 的 Author 权限（或其他可以上传文件的权限）。
3.  上传恶意 WAV 文件到 WordPress 媒体库。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，向攻击者指定的 C2 服务器发起请求，泄露目标文件内容。
5.  如果目标文件内容被压缩，可以使用提供的 deflate.php 进行解压缩。

搜索引擎结果中也提到了该漏洞的利用方式，并提供了相关的 TryHackMe 挑战链接。


**项目地址:** [thomas-osgood/CVE-2021-29447](https://github.com/thomas-osgood/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)