## CVE-2024-55656 - RedisBloom Integer Overflow Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-55656

**漏洞类型:** Integer Overflow

**影响应用:** RedisBloom (Redis Stack)

**危害等级:** 高危，可能导致信息泄露和OOB写入，最终可能导致远程代码执行

**影响版本:** RedisBloom v2.6.12 shipped with Redis Stack 7.2.0-v10 (其他受影响版本见漏洞库信息)

**利用条件:** 需要Redis客户端权限（知道密码）且RedisBloom模块已加载

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于RedisBloom模块的`CMS.INITBYDIM`命令中。攻击者可以通过构造特定的`width`和`depth`参数，触发整数溢出，导致`NewCMSketch()`函数分配的内存小于实际所需。随后，通过`CMS.QUERY`命令实现OOB读取，通过`CMS.INCRBY`命令实现OOB写入，从而实现信息泄露或远程代码执行。

**利用方式：**
1.  使用存在漏洞的Redis Stack版本。
2.  使用Redis客户端连接到Redis服务器，并进行身份验证（如果需要）。
3.  使用`CMS.INITBYDIM`命令，传入精心构造的`width`和`depth`参数，触发整数溢出。例如，使用`width`和`depth`的值，使得`width * depth`的结果发生溢出。
4.  使用`CMS.QUERY`命令读取溢出后的内存区域，或者使用`CMS.INCRBY`命令写入溢出后的内存区域。

**投毒风险评估：**
根据对POC代码的分析，存在轻微的投毒风险。虽然代码主要展示了漏洞利用过程，但其中可能包含隐蔽的后门代码或恶意逻辑，例如篡改关键数据结构以达到持久控制的目的。这些后门代码可能隐藏在诸如`murmurhash2_input`等参数初始化或内存操作的细节中。由于缺乏足够的上下文以及代码的不完整性（例如，`load_murm`函数未完成），准确评估投毒风险的难度较高。因此，保守估计投毒风险为10%。


**项目地址:** [rick2600/redis-stack-CVE-2024-55656](https://github.com/rick2600/redis-stack-CVE-2024-55656)

**漏洞详情:** [CVE-2024-55656](https://nvd.nist.gov/vuln/detail/CVE-2024-55656)