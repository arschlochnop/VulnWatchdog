## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行存在漏洞的 Apache HTTP Server 2.4.49，并且Alias配置不当，或者CGI脚本未禁用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化中的一个缺陷引起的，允许攻击者使用路径遍历攻击将 URL 映射到 Alias 指令配置的目录之外的文件。如果这些目录之外的文件没有受到 'require all denied' 的默认配置保护，请求就可以成功。如果 CGI 脚本也为这些别名路径启用，则可能允许远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用，表明提供的漏洞利用代码（QT C++开发的利用工具）可能有效。搜索结果中的多个链接确认了该漏洞的存在，利用方式以及高危风险。

**投毒风险：**

提供的漏洞利用代码是 QT C++ 开发的工具的 README 文件，描述了工具的界面和使用方法，包括漏洞检测、目录遍历、命令执行和反弹 shell 功能。虽然 README 本身没有直接包含恶意代码，但工具的完整代码（未提供）可能存在作者隐藏的后门或恶意功能。因为无法验证工具全部代码，所以认为有10%的投毒风险，主要体现在工具可能搜集目标信息，或在特定情况下执行恶意操作。

**利用方式：**

利用方式主要包括：

1.  **路径遍历：** 攻击者通过构造包含 '..' 的特殊 URL，绕过服务器的路径检查，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功进行路径遍历，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了 CGI 脚本，并且攻击者能够通过路径遍历访问 CGI 脚本，则可以执行任意命令。
4.  **反弹Shell：** 工具描述中包含通过 netcat (nc) 开启监听，然后执行反弹 shell 的操作，允许远程控制目标服务器。

**项目地址:** [wangfly-me/Apache_Penetration_Tool](https://github.com/wangfly-me/Apache_Penetration_Tool)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)