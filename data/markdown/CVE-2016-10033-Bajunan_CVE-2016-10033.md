## CVE-2016-10033 - PHPMailer远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的PHPMailer版本，且允许通过邮件发送功能传递参数。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。通过在 Sender 属性中使用 `\"` (反斜杠双引号)构造恶意输入，攻击者可以将额外参数传递给 mail 命令，从而执行任意代码。提供的POC代码 `wordpress-rce-exploit.sh` 针对 WordPress 4.6 进行了测试，它利用了 PHPMailer 的漏洞。该脚本通过构造包含恶意命令的 Host Header，来触发远程代码执行。具体而言，脚本首先定义了反弹shell的主机 `rev_host`。然后，`prep_host_header` 函数将要执行的命令进行编码，替换斜杠 `/` 和空格 ` ` 为特殊字符串，以便绕过过滤。最终生成的恶意 Host Header 被用于发送邮件，触发漏洞，导致服务器执行攻击者指定的命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以确认该漏洞是有效的，并且存在公开可用的利用代码。

**投毒风险：**
POC 代码中存在一定投毒风险。代码中使用了经过base64编码的intro和intro2变量，虽然表面上是一些ASCII Art，但可能隐藏着潜在的恶意代码或后门。例如，将`rev_host`设置为攻击者控制的服务器，可能导致受害者在不知情的情况下连接到恶意服务器。 因此，评估投毒风险为 10%。虽然整体代码看起来是利用漏洞，但是植入后门的可能性是存在的，需要进行进一步分析。

**利用方式：**
1.  目标系统必须运行存在漏洞的 PHPMailer 版本（低于 5.2.18）。
2.  攻击者需要找到或利用目标应用程序中调用 PHPMailer 发送邮件的功能。
3.  通过构造包含恶意 `\"` 的 Sender 属性，注入额外的 mail 命令参数。
4.  注入的命令将在服务器上执行，例如反弹 shell 给攻击者。

**项目地址:** [Bajunan/CVE-2016-10033](https://github.com/Bajunan/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)