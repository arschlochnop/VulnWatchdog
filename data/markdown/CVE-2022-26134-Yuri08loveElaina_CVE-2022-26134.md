## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器开放网络访问，且存在漏洞版本的 Confluence Server/Data Center

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-26134 是一个存在于 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已被积极利用。提供的漏洞利用代码 `exploit26134_pro.py` 是一个 Python 脚本，它利用该漏洞执行命令。该脚本提供了多种利用选项，例如指定目标 URL、执行命令、批量扫描目标、使用 stealth 模式、使用代理和输出 JSON 结果。

**投毒风险：**
分析提供的`exploit26134_pro.py`脚本和`README.html`文件，发现以下潜在风险点：
1.  **作者可信度：** 作者`Yuri08`在GitHub上的活动和声誉需要进一步验证。虽然提供了GitHub链接，但并不能完全保证作者的可靠性。
2.  **代码混淆或隐藏：** 脚本可能包含难以察觉的恶意代码，例如反向 shell 或数据收集功能。需要对代码进行深入分析。
3.  **依赖风险：** 该脚本可能依赖于外部库或模块，这些库或模块可能包含漏洞或恶意代码。
虽然脚本本身看起来像是用于漏洞利用，作者可能会在脚本中添加一些不易察觉的后门或者信息收集代码。`README.html` 主要描述如何使用该漏洞利用工具，其中没有任何明显的投毒迹象。
因此，考虑到以上风险因素，该POC的投毒风险为20%。在实际使用前，务必进行代码审计和安全评估。

**利用方式：**
1.  **发送恶意请求：** 攻击者向目标 Confluence 服务器发送包含恶意 OGNL 表达式的 HTTP 请求。
2.  **OGNL 注入：** Confluence 服务器在处理请求时，会将恶意 OGNL 表达式作为代码执行。
3.  **远程代码执行：** 通过执行恶意 OGNL 表达式，攻击者可以在 Confluence 服务器上执行任意代码。

**项目地址:** [Yuri08loveElaina/CVE-2022-26134](https://github.com/Yuri08loveElaina/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)