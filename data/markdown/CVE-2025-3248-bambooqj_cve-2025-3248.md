## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 需要目标Langflow实例的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248 存在于 Langflow 的 /api/v1/validate/code 接口中，允许未经身份验证的攻击者发送特制的 HTTP 请求来执行任意代码。POC代码提供单目标扫描、批量扫描、命令执行和交互式shell模式，表明漏洞利用的有效性较高。

**有效性评估：**

根据漏洞描述和提供的POC代码，该漏洞是有效的。POC代码已经实现了针对该漏洞的利用，并提供了多种利用方式。

**投毒风险评估：**

该POC脚本存在一定的投毒风险，约为10%。主要依据如下：

*   **资源下载:** 虽然没有发现直接的恶意资源下载行为，但攻击者可能修改脚本，添加从恶意源下载payload的功能。
*   **动态代码执行:** 脚本中存在使用 `requests` 库发送 POST 请求，如果服务器返回恶意构造的响应，可能导致客户端执行恶意代码。虽然脚本对响应进行了Content-Type检查以及HTML页面的判断，但仍然存在被绕过的可能。
*   **命令执行:**  脚本主要功能为远程命令执行，命令执行本身具有高危性，恶意使用者可以通过修改`command`参数执行任意恶意指令。

**利用方式分析：**

1.  **漏洞点：**/api/v1/validate/code 接口
2.  **利用方式：**
    *   攻击者发送包含恶意代码的 POST 请求到 /api/v1/validate/code 接口。
    *   Langflow 未对请求进行充分的身份验证和代码安全检查。
    *   恶意代码被执行，从而实现远程代码执行。
3.  **POC 代码利用方式：**
    *   单目标扫描：通过指定目标URL，测试目标是否存在漏洞。
    *   单目标命令执行：通过指定目标URL和命令，在目标上执行特定命令。
    *   批量扫描：通过指定包含URL列表的文件，批量测试目标是否存在漏洞。
    *   批量命令执行：通过指定包含URL列表的文件和命令，在多个目标上执行特定命令。
    *   交互式Shell：可以进入交互式shell模式进行更方便的命令执行

**项目地址:** [bambooqj/cve-2025-3248](https://github.com/bambooqj/cve-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)