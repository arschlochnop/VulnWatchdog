## CVE-2024-42007 - php-spx 目录遍历

**漏洞编号:** CVE-2024-42007

**漏洞类型:** 目录遍历

**影响应用:** php-spx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** <= 0.4.15

**利用条件:** 需要目标系统运行php-spx，且可以通过HTTP/HTTPS访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-42007是php-spx 0.4.15及更早版本中的一个目录遍历漏洞。攻击者可以通过操纵`SPX_UI_URI`参数，利用目录遍历漏洞读取服务器上的任意文件。 

**有效性:** 提供的POC代码有效。它通过构造包含多个`%2f..`的URL，尝试绕过路径限制，然后访问指定的文件。如果目标服务器存在此漏洞且文件可读，POC将成功读取文件内容。

**投毒风险:** POC代码本身看起来比较直接，没有明显的恶意行为。`README.md`文件也没有任何可疑内容。投毒风险较低，但仍然存在，需要人工代码审计。风险评估为5%,主要考虑到以下情况：
*   作者可能在代码中添加了不易察觉的后门，例如收集目标系统信息的代码。
*   作者可能通过其他方式（例如恶意域名解析、篡改依赖库等）进行投毒。

**利用方式:**
1.  攻击者首先需要确定目标系统是否运行着存在漏洞的php-spx版本。
2.  攻击者构造恶意的URL，其中包含目标服务器的地址、`SPX_KEY=dev`、`SPX_UI_URI`参数，以及包含多个`%2f..`的目录遍历字符串和目标文件的路径。
3.  攻击者发送构造好的HTTP请求到目标服务器。
4.  如果目标服务器存在漏洞，且请求成功，服务器将返回目标文件的内容。

**项目地址:** [BubblyCola/CVE_2024_42007](https://github.com/BubblyCola/CVE_2024_42007)

**漏洞详情:** [CVE-2024-42007](https://nvd.nist.gov/vuln/detail/CVE-2024-42007)