## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Langflow

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.3.0

**利用条件:** 目标Langflow实例可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3248 存在于 Langflow 1.3.0 之前的版本中，是一个未经身份验证的远程代码执行漏洞。攻击者可以通过向 `/api/v1/validate/code` 端点发送特制的 HTTP 请求来执行任意代码。漏洞原因是 Langflow 在验证代码时存在代码注入。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已被积极利用，并且存在公开的漏洞利用代码，表明该漏洞利用的有效性很高。

**投毒风险：**

检查提供的漏洞利用代码，发现该代码主要功能是利用 Langflow 的 `/api/v1/validate/code` 接口执行任意命令。Payload 构造了一个包含恶意代码的 Python 函数，通过 `subprocess.check_output` 执行命令。虽然代码本身看起来是直接的漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **命令执行的隐蔽性：** 攻击者可以将恶意命令隐藏在 base64 编码或其他混淆技术中，使其难以被发现。
2.  **依赖项劫持：** 虽然未在代码中发现，但理论上，如果 Langflow 依赖于第三方库，攻击者可能会尝试劫持这些库以执行恶意代码。
3. **Readme文件投毒：**虽然readme文件看起来没有什么，如果下载量过大，有可能被不法分子利用，攻击github服务器。

综合考虑，该漏洞利用代码本身的投毒风险较低（约为5%），主要是潜在的命令混淆和第三方依赖风险。

**利用方式：**

1.  **确定目标：** 找到运行 Langflow 1.3.0 之前版本的实例，且可以通过网络访问。
2.  **构造 Payload：** 创建一个包含要执行的命令的 JSON Payload。
3.  **发送请求：** 将 Payload 发送到 `/api/v1/validate/code` 端点。
4.  **执行命令：** Langflow 将执行 Payload 中的命令，并将结果返回给攻击者。攻击者可以使用该漏洞获取服务器的控制权，安装恶意软件，或窃取敏感数据。

根据搜索结果，该漏洞已被用于传播 Flodrix 僵尸网络，表明该漏洞的危害性很高。

**项目地址:** [dennisec/Mass-CVE-2025-3248](https://github.com/dennisec/Mass-CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)