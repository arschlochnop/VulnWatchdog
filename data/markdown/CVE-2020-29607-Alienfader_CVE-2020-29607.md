## CVE-2020-29607-Pluck CMS-文件上传绕过导致远程代码执行

**漏洞编号:** CVE-2020-29607

**漏洞类型:** 文件上传绕过

**影响应用:** Pluck CMS

**危害等级:** 高危，允许攻击者上传恶意webshell并执行任意代码

**影响版本:** < 4.7.13

**利用条件:** 需要管理员权限，网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-29607 是 Pluck CMS 4.7.13 之前版本中存在的一个文件上传限制绕过漏洞。 具有管理员权限的用户可以通过“管理文件”功能上传恶意文件，从而获得对主机的访问权限，可能导致远程代码执行。

**利用方式：**

1.  **身份验证：** 利用脚本首先需要使用管理员密码进行身份验证。该脚本会构造一个POST请求到 `/login.php` 页面。
2.  **获取Cookie：**  脚本先从目标URL获取session cookie,为后续的身份验证和文件上传做准备.
3.  **上传 Webshell：** 成功通过身份验证后，该脚本会构造一个包含 PHP webshell 的 multipart/form-data POST 请求，尝试绕过文件上传限制将 webshell (shell.phar) 上传到服务器的 `/files/` 目录下。
4.  **远程代码执行：** 成功上传webshell后，攻击者可以通过访问`http://<target_ip>:<target_port>/<pluckcmspath>/files/shell.phar`来执行任意PHP代码。

**有效性：**

提供的POC代码看起来是有效的，因为它模拟了攻击者利用该漏洞所需的步骤：身份验证和 Webshell 上传。

**投毒风险：**

评估投毒风险较低 (5%)。以下是评估依据：

*   **代码可读性：** 提供的 Python 脚本相对简单，易于理解。代码的每个步骤都有注释，这降低了隐藏恶意代码的可能性。
*   **修改痕迹：** 脚本声明修改了 branding 信息，这表明作者确实修改了原始代码，增加了风险，但不足以判断存在恶意投毒代码。
*   **依赖项：** 该脚本仅依赖于 `requests` 模块，这是一个常见的 Python 库，降低了引入恶意依赖项的风险。
*   **自定义 ASCII 艺术：** 脚本在 Webshell 中包含自定义 ASCII 艺术的可能性极小。

尽管如此，仍然需要谨慎。如果使用此脚本，请仔细审查代码，确保没有隐藏的恶意功能。 建议在隔离环境中运行该脚本以降低潜在风险。

**项目地址:** [Alienfader/CVE-2020-29607](https://github.com/Alienfader/CVE-2020-29607)

**漏洞详情:** [CVE-2020-29607](https://nvd.nist.gov/vuln/detail/CVE-2020-29607)