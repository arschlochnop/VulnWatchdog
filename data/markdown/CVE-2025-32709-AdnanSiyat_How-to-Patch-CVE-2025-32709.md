## CVE-2025-32709 Windows Ancillary Function Driver for WinSock Use-After-Free 提权漏洞

**漏洞编号:** CVE-2025-32709

**漏洞类型:** Use-After-Free

**影响应用:** Windows Ancillary Function Driver for WinSock (afd.sys)

**危害等级:** 高危，允许本地授权的攻击者提升权限

**影响版本:** 受影响的Windows版本众多，详见CVE描述中的版本范围

**利用条件:** 本地权限，需要攻击者在目标系统上拥有一个账户

**POC 可用性:** 是，存在公开的利用信息

**投毒风险:** 5%

## 详情

CVE-2025-32709 是 Windows Ancillary Function Driver for WinSock (afd.sys) 中的一个Use-After-Free漏洞，攻击者可以通过利用此漏洞提升权限。根据搜索结果，该漏洞在野外被积极利用。提供的代码库实际上是一个**补丁指南**，展示了如何通过安装 Microsoft 的 2025 年 5 月累积更新来修复此漏洞。因此，该代码本身**不是漏洞利用代码**，而是**漏洞缓解措施的演示**。投毒风险很低，因为提供的代码库主要关注如何应用官方补丁。但是github依旧存在恶意行为的可能，比如图片链接被替换成恶意链接，或者文档被修改，所以判定投毒风险为5%。

**利用方式分析：**

1.  **漏洞类型：** Use-After-Free，即释放后重用。
2.  **影响组件：** Windows Ancillary Function Driver for WinSock (afd.sys)。
3.  **攻击目标：** 本地提权，攻击者需要先获得目标机器的访问权限。
4.  **利用流程：** 攻击者需要构造特定的网络请求，触发afd.sys中的UAF漏洞，从而控制程序执行流程，最终获得系统权限。
5.  **修复方式：** 安装Microsoft发布的补丁，即May 2025 Cumulative Update。

根据CISA的记录，该漏洞已被添加到已知被利用的漏洞目录中，表明其具有实际的威胁。

**项目地址:** [AdnanSiyat/How-to-Patch-CVE-2025-32709](https://github.com/AdnanSiyat/How-to-Patch-CVE-2025-32709)

**漏洞详情:** [CVE-2025-32709](https://nvd.nist.gov/vuln/detail/CVE-2025-32709)