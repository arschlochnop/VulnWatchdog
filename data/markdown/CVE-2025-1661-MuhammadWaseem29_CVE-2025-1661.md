## CVE-2025-1661 - HUSKY WooCommerce插件未授权本地文件包含漏洞

**漏洞编号:** CVE-2025-1661

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** HUSKY – Products Filter Professional for WooCommerce

**危害等级:** 高危，可导致敏感信息泄露甚至远程代码执行

**影响版本:** <= 1.3.6.5

**利用条件:** 需要目标网站安装存在漏洞版本的HUSKY WooCommerce插件，且攻击者能够发送HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1661是HUSKY – Products Filter Professional for WooCommerce WordPress插件中一个未经身份验证的本地文件包含(LFI)漏洞。漏洞存在于1.3.6.5及更早版本中。攻击者可以通过`woof_text_search` AJAX action的`template`参数，包含服务器上的任意文件，从而导致敏感信息泄露，在某些情况下甚至可以执行任意PHP代码。

**有效性分析:**

提供的PoC代码看起来是有效的。它使用POST请求，并将包含路径遍历的payload注入到`template`参数中。如果插件存在漏洞，服务器将返回`/etc/passwd`文件的内容。

**投毒风险分析:**

虽然该漏洞本身允许包含和执行文件，但是仓库本身也存在一定的投毒风险。虽然README.md文件提供的PoC没有明显的恶意代码，但仓库中其他文件可能存在潜在的恶意代码。经过分析，投毒风险评估为10%。这个风险来自于以下几个方面：

*   **潜在的后门代码：** 虽然提供的 PoC 只是利用 LFI 读取文件，但是如果攻击者获得了更高的权限，比如写入权限，则可以上传恶意文件，然后通过LFI执行。
*   **依赖风险：** 项目可能依赖于其他的恶意库或代码，引入安全风险。
*   **供应链风险：** 仓库维护者可能被攻击，导致仓库被植入恶意代码。

**漏洞利用方式:**

1.  确定目标网站是否安装了存在漏洞版本的HUSKY – Products Filter Professional for WooCommerce插件（版本<= 1.3.6.5）。
2.  构造包含路径遍历的HTTP POST请求，将恶意payload作为`template`参数的值发送到`/wp-admin/admin-ajax.php`。
3.  检查服务器的响应，确认是否成功包含了指定的文件。
4.  如果目标文件包含敏感信息，则攻击成功，例如可以读取/etc/passwd文件泄露用户信息。
5.  如果目标系统允许上传文件(例如图片),则可以上传包含恶意PHP代码的文件，然后利用LFI执行该文件，从而实现远程代码执行。

**项目地址:** [MuhammadWaseem29/CVE-2025-1661](https://github.com/MuhammadWaseem29/CVE-2025-1661)

**漏洞详情:** [CVE-2025-1661](https://nvd.nist.gov/vuln/detail/CVE-2025-1661)