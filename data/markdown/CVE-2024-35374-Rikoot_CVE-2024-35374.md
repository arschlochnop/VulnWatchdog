## CVE-2024-35374-Mocodo Online-命令注入

**漏洞编号:** CVE-2024-35374

**漏洞类型:** 命令注入

**影响应用:** Mocodo Online

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 4.2.6

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Mocodo Online 4.2.6及以下版本。由于`/web/generate.php`中的`sql_case`输入字段未经过适当的过滤和清理，攻击者可以通过构造恶意的输入数据，执行任意命令，从而导致远程代码执行（RCE）。

**有效性分析：**
提供的Metasploit模块代码（`cve_2024_35374.rb`）旨在利用此漏洞。它包含漏洞描述、作者信息、CVE编号、参考链接、目标平台、payload设置、Privileged标志、披露日期、默认目标等信息。代码中定义了check方法来检查目标是否易受攻击，以及exploit方法（目前为空）。提供的Dockerfile可以用来构建一个易受攻击的Mocodo环境，方便测试验证。

**投毒风险分析：**
分析提供的Dockerfile, README.md 和 Metasploit 模块代码(`cve_2024_35374.rb`)，没有发现明显的恶意代码或后门。Dockerfile用于构建Mocodo Online的特定版本, README.md提供漏洞利用说明，Metasploit模块旨在利用该漏洞进行攻击。因此，投毒风险评估为0%。

**利用方式：**
1.  目标系统上运行Mocodo Online 4.2.6或以下版本。
2.  攻击者构造包含恶意命令的`sql_case`参数。
3.  将构造的请求发送到`/web/generate.php`。
4.  由于未经过滤，恶意命令会被执行，导致RCE。
5.  使用Metasploit模块可以简化利用过程，自动完成漏洞检测和利用。

**项目地址:** [Rikoot/CVE-2024-35374](https://github.com/Rikoot/CVE-2024-35374)

**漏洞详情:** [CVE-2024-35374](https://nvd.nist.gov/vuln/detail/CVE-2024-35374)