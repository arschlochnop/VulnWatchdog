## CVE-2025-30406-Gladinet CentreStack-反序列化RCE

**漏洞编号:** CVE-2025-30406

**漏洞类型:** 反序列化导致远程代码执行

**影响应用:** Gladinet CentreStack

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** < 16.4.10315.56368

**利用条件:** 需要目标服务器运行存在漏洞的CentreStack版本，并且攻击者需要知道或获取machineKey

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30406是Gladinet CentreStack中的一个关键反序列化漏洞。该漏洞是由于CentreStack门户使用了硬编码的machineKey。知道machineKey的攻击者可以构造一个序列化payload，该payload可以在服务器端反序列化，从而实现远程代码执行。

**利用方式：**

1.  **获取machineKey：** 这是利用此漏洞的关键步骤。根据漏洞描述，该machineKey是硬编码的，因此可能存在于公开的配置文件或可以通过其他方式泄露。
2.  **生成恶意Payload：** 使用ysoserial.net等工具，根据目标.NET框架版本和漏洞利用链，生成恶意的ViewState payload。该payload包含执行任意代码的指令。
3.  **发送Payload：** 将生成的payload作为`__VIEWSTATE`参数发送到CentreStack门户的页面，例如`/portal/loginpage.aspx`。
4.  **执行代码：** CentreStack服务器反序列化ViewState，执行payload中包含的恶意代码，从而实现远程代码执行。

**有效性：**

提供的POC代码似乎是有效的。漏洞利用代码包括以下几个部分：

*   一个Visual Studio解决方案文件（`CVE-2025-30406.sln`）和一个C#项目文件（`CVE-2025-30406\CVE-2025-30406.csproj`），表明这是一个.NET项目，用于生成恶意payload。
*   一个`README.md`文件，包含漏洞利用的说明，包括测试版本，ysoserial.net命令示例，和一个C#代码片段 `class E`，用于在目标服务器上执行任意命令。 该 C# 代码片段使用 `System.Web.HttpContext.Current` 获取当前 HTTP 请求的上下文，允许通过请求头 `cmd` 传递命令来执行。
*   一个名为 `rce.txt` 的文件，包含一个 ResourceDictionary，其中包含一个ObjectDataProvider，用于执行远程命令。此文件包含一个用于触发计算器的payload `mspaint`

`README.md` 文件中提供的ysoserial.net命令示例，结合C#代码片段，可以直接用于生成和发送恶意payload。

**投毒风险：**

存在一定的投毒风险（10%）。虽然该仓库主要是为了利用已知的漏洞，但恶意作者仍然可能尝试通过以下方式引入投毒代码：

*   **混淆的恶意代码：** 在C#代码片段中插入难以察觉的恶意代码，例如，收集目标服务器信息的代码，并将这些信息发送到攻击者的服务器。
*   **依赖项劫持：** 通过修改项目文件，引入包含恶意代码的第三方依赖项。
*   **不必要的权限请求：** 在代码中请求不必要的权限，例如，访问本地文件系统或注册表，这些权限可能被用于执行恶意操作。

 但是根据提供的代码和信息，这个概率比较小，`rce.txt`中仅包含触发计算器的`mspaint`命令，相对安全。

**排序优先级:**
该回答遵循搜索引擎结果 > 漏洞利用代码 > 漏洞库信息的优先级顺序。
搜索引擎结果用于验证漏洞的真实性和危害性，漏洞利用代码用于分析漏洞的利用方式，漏洞库信息作为补充参考。

**项目地址:** [W01fh4cker/CVE-2025-30406](https://github.com/W01fh4cker/CVE-2025-30406)

**漏洞详情:** [CVE-2025-30406](https://nvd.nist.gov/vuln/detail/CVE-2025-30406)