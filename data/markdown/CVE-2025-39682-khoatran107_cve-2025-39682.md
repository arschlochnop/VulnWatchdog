## CVE-2025-39682-Linux Kernel TLS零长度记录处理漏洞

**漏洞编号:** CVE-2025-39682

**漏洞类型:** 内存破坏/提权

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致内核崩溃或权限提升

**影响版本:** Linux Kernel 6.0 - 6.17 (不包含已修复版本)

**利用条件:** 需要建立TLS连接并发送特定的零长度记录

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-39682 是一个 Linux 内核 TLS 实现中的漏洞，存在于 `net/tls/tls_sw.c` 文件中。该漏洞与处理 rx_list 上的零长度记录有关。当内核处理 TLS 记录时，每个 `recvmsg()` 调用必须处理连续的 DATA 记录或一个非 DATA 记录。问题在于，如果从 rx_list 中获取的初始记录是零长度的，则在零拷贝解密后，内核没有正确处理这种情况。这可能导致内核崩溃或内存破坏。\n\n**漏洞利用有效性：**\n提供的漏洞利用代码包括一个README，表明该漏洞利用代码是基于CVE-2024-58239的修改，并且在 kernelCTF mitigation-v4-6.6 实例上进行了测试，成功率为79/100。因此，该POC代码看起来是有效的，至少在特定的kernelCTF环境中是有效的。提供的脚本 `calc_AC_rate.py`  用于计算利用成功率,  `local_runner.sh`  用于在本地运行qemu虚拟机来测试漏洞，`qemu.sh` 用于启动qemu虚拟机。`compile.sh` 用于编译漏洞利用程序。\n\n**投毒风险：**\n虽然提供的代码看起来主要是用于漏洞利用，但仍然存在一定的投毒风险，约10%。以下是原因：\n1. **未知依赖：** `local_runner.sh`脚本从外部IP地址下载client程序，存在恶意程序替换client的风险。\n2. **复杂性：**  利用涉及多个脚本和组件，增加了隐藏恶意代码的可能性。尤其是在二进制的client中，可能存在不期望的行为。\n3. **权限提升：** 该漏洞本身用于权限提升，如果攻击者成功利用该漏洞，他们可以获得系统 root 权限，从而可以执行任何操作，包括部署后门或恶意软件。`calc_AC_rate.py`脚本执行`./client --ip {ip} --port {port}`存在参数注入的风险，如果IP和端口参数可控，可能造成命令执行。\n\n**利用方式：**\n利用方式涉及以下步骤：\n1.  设置 TLS 连接。\n2.  发送一个零长度的 TLS 记录。\n3.  触发内核中的漏洞，可能导致内核崩溃或权限提升。\n\n该利用方式针对kernelCTF Mitigation-v4-6.6环境，利用的是TLS零长度记录处理的缺陷。通过发送特定的数据包，触发内核错误处理逻辑，从而实现提权。具体实现细节可能涉及到内存布局的操纵，需要深入分析漏洞利用代码。

**项目地址:** [khoatran107/cve-2025-39682](https://github.com/khoatran107/cve-2025-39682)

**漏洞详情:** [CVE-2025-39682](https://nvd.nist.gov/vuln/detail/CVE-2025-39682)