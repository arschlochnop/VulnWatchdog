## CVE-2025-24893-XWiki-远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 高危，允许未授权用户执行任意代码

**影响版本:** < 15.10.11, < 16.4.1, 16.5.0RC1之前版本

**利用条件:** 需要目标XWiki实例未打补丁，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24893是XWiki Platform中的一个远程代码执行漏洞，位于SolrSearchMacros中。攻击者可以通过构造包含恶意Groovy代码的URL，利用`media=rss`参数和`text`参数，在目标系统上执行任意代码。利用该漏洞不需要身份验证，因此风险极高。提供的Python POC代码通过构造特定的URL，将命令注入到XWiki服务器，并通过正则表达式提取命令执行结果。由于payload可控,因此风险极高。 

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有公开的PoC。提供的Python脚本可以利用该漏洞执行任意命令，因此判断POC有效。

**投毒风险：**
查看了提供的Python脚本及相关文件，主要功能是构造payload并发送请求以利用漏洞。虽然作者Github主页没有太多信息，但该脚本代码量不大，逻辑清晰，主要依赖于`requests`和`urllib.parse`库。其中正则表达式用于提取结果，没有发现明显的恶意代码或后门，但依然需要用户自行审计以确保安全。但仍然存在风险，如果代码仓库被劫持，或者作者更新了恶意代码，存在投毒风险。 评估投毒风险为5%，主要因为脚本较为简单。

**利用方式：**
1.  **确定目标：** 找到存在漏洞的XWiki实例。
2.  **构造Payload：** 使用提供的Python脚本或手动构造包含恶意Groovy代码的URL。例如：
    `http://target/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln(%27id%27.execute().text)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D`
3.  **发送请求：** 将构造的URL发送到目标XWiki实例。
4.  **提取结果：** 从响应中提取命令执行的结果。提供的Python脚本使用了正则表达式提取结果。
5.  **反弹shell:** 根据实际情况，构造反弹shell的payload。

**项目地址:** [Retro023/CVE-2025-24893-POC](https://github.com/Retro023/CVE-2025-24893-POC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)