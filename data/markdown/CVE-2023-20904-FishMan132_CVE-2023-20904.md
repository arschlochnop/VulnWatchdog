## CVE-2023-20904-Android-权限提升

**漏洞编号:** CVE-2023-20904

**漏洞类型:** 权限提升

**影响应用:** Android

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** Android-12L, Android-13

**利用条件:** 需要本地访问权限，无需用户交互

**POC 可用性:** 部分

**投毒风险:** 10%

## 详情

CVE-2023-20904是Android系统中SettingsActivity.java的getTrampolineIntent函数中的一个Intent不匹配漏洞，可能导致任意Activity的启动，从而实现本地权限提升。漏洞存在于Android-12L和Android-13版本中。

**有效性：**
根据漏洞描述和搜索结果，该漏洞确实存在，并且可能被利用进行本地权限提升。漏洞利用无需用户交互。

**投毒风险：**
提供的POC代码片段是Gradle构建相关的，包含build.gradle.kts，gradle.properties和gradlew，用于构建Android项目，不是直接漏洞利用代码。从代码本身来看，存在投毒的可能性较低，但依然存在一定的风险。

*   `build.gradle.kts`: 是一个构建配置文件，恶意插件可能被添加到构建文件中，执行恶意代码。
*   `gradle.properties`: 可以设置JVM参数，可能会修改编译参数，影响APP的安全性
*   `gradlew`: 是Gradle的Wrapper脚本，用于在没有Gradle环境的机器上执行Gradle命令。该脚本可能被替换为恶意脚本。

由于代码片段不包含漏洞利用相关的代码，且多为构建配置，因此认为投毒风险较低，大约为10%。

**利用方式：**
1.  攻击者需要获取目标Android设备的本地访问权限。
2.  攻击者构造恶意的Intent，利用getTrampolineIntent函数中的Intent不匹配漏洞，启动任意Activity。
3.  通过启动具有更高权限的Activity，攻击者可以执行特权操作，从而提升本地权限。

**项目地址:** [FishMan132/CVE-2023-20904](https://github.com/FishMan132/CVE-2023-20904)

**漏洞详情:** [CVE-2023-20904](https://nvd.nist.gov/vuln/detail/CVE-2023-20904)