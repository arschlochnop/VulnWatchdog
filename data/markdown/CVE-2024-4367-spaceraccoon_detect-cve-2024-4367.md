## CVE-2024-4367-PDF.js-任意JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript执行

**影响应用:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**危害等级:** 中危，可能导致敏感信息泄露或跨站脚本攻击

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户打开恶意的PDF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4367 是 PDF.js 中的一个漏洞，由于缺少字体处理时的类型检查，允许在 PDF.js 上下文中执行任意 JavaScript 代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC可用（[webpage 6] 提到了 `exfil0/WEAPONIZING-CVE-2024-4367`，提供了利用代码）。提供的YARA规则可以用于检测利用此漏洞的PDF文件，表明POC的有效性。

**投毒风险：**

提供的代码包含一个YARA规则，用于检测利用CVE-2024-4367的PDF文件。LICENSE和README文件是标准的开源项目文件，没有迹象表明存在恶意代码。因此，投毒风险极低，为0%。

**利用方式：**

1.  攻击者构造一个恶意的PDF文件，该文件包含特制的字体数据，利用了 PDF.js 中字体处理时缺失的类型检查。
2.  当用户使用受影响的 Firefox、Firefox ESR 或 Thunderbird 版本打开该PDF文件时，PDF.js 会解析该文件。
3.  由于缺少类型检查，恶意的字体数据会导致任意 JavaScript 代码在 PDF.js 的上下文中执行。
4.  执行的 JavaScript 代码可以访问 PDF.js 的内部对象和函数，从而可能导致敏感信息泄露，或执行其他恶意操作，如跨站脚本攻击(如果PDF.js被嵌入在网页中)。

总的来说，利用方式是通过构造包含恶意字体的PDF文件，绕过类型检查，触发 JavaScript 代码执行。

**项目地址:** [spaceraccoon/detect-cve-2024-4367](https://github.com/spaceraccoon/detect-cve-2024-4367)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)