## CVE-2025-51867 - Deepfiction AI IDOR

**漏洞编号:** CVE-2025-51867

**漏洞类型:** IDOR (Insecure Direct Object Reference)

**影响应用:** Deepfiction AI

**危害等级:** 高危，可能导致未经授权的LLM访问和资源滥用

**影响版本:** 所有版本（未明确指定受影响版本，根据描述推断）

**利用条件:** 需要能够访问Deepfiction AI网站和API，并能获取其他用户的treatment_id和user_id

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-51867是Deepfiction AI平台上的一个IDOR漏洞，存在于其聊天组件中。攻击者可以利用公开的`treatment_id`和`user_id`来冒充其他用户，使用他们的信用额度与LLM进行交互。

**有效性：**

提供的README.md文件描述了漏洞原理和利用方式。该文档阐述了如何通过替换`create-story-part` API请求中的`treatment_id`和`user_id`字段来实现未授权访问。文档中还包含了漏洞验证过程的截图。

**投毒风险：**

README.md文件和截图本身不包含可执行代码，因此直接投毒的风险较低。但是，不能完全排除作者在其他未公开的文件或后续更新中引入恶意代码的可能性，因此风险评估为10%。需要注意的是，这个比例是基于提供的信息进行评估的，实际风险可能更高。

**利用方式：**

1.  **信息收集：** 攻击者需要访问`https://www.deepfiction.ai/browse/stories`，从中获取其他用户的`treatment_id`（对应API中的`id`）和`user_id`（对应API中的`author_id`）。
2.  **API请求篡改：** 攻击者构造`https://www.deepfiction.ai/api/story/create-story-part`请求，并将请求体中的`treatment_id`和`user_id`替换为收集到的其他用户的信息。
3.  **LLM交互：** 通过发送篡改后的请求，攻击者可以以其他用户的身份与LLM进行交互，消耗他们的信用。
4.  **敏感数据泄露：** 分析网络流量可能暴露出每个角色的特定角色配置（字符设置），这等同于系统提示，并代表LLM ChatBot的重要系统资源。

**总结：**

该漏洞利用较为简单，只需要替换API请求中的参数即可。其危害在于允许攻击者盗用其他用户的资源，并可能泄露LLM系统的内部配置信息。需要Deepfiction AI及时修复。

**项目地址:** [Secsys-FDU/CVE-2025-51867](https://github.com/Secsys-FDU/CVE-2025-51867)

**漏洞详情:** [CVE-2025-51867](https://nvd.nist.gov/vuln/detail/CVE-2025-51867)