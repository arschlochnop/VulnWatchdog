## CVE-2025-24271 - AirPlay 未授权命令执行

**漏洞编号:** CVE-2025-24271

**漏洞类型:** 访问控制漏洞

**影响应用:** AirPlay (tvOS, iOS, iPadOS, macOS, visionOS)

**危害等级:** 中危，可能导致未授权的AirPlay命令执行

**影响版本:** tvOS < 18.4, iOS and iPadOS < 18.4, iPadOS < 17.7, macOS < 15.4, macOS < 14.7, macOS < 13.7, visionOS < 2.4

**利用条件:** 与目标设备处于同一网络

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24271 允许未经身份验证的用户在与已登录 Mac 相同的网络上发送 AirPlay 命令。POC 代码通过 mDNS 发现 AirPlay 设备，然后向发现的设备发送伪造的 AirPlay 请求，试图强制设备播放攻击者控制的 URL (http://attacker.local/evil.mov)。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用的有效性较高，因为无需配对即可发送AirPlay命令。

**投毒风险：**
查看了提供的POC代码，没有发现任何明显的恶意代码或者后门。该脚本目的是模拟AirPlay请求，并尝试在目标设备上播放指定的URL。因此，可以判断投毒风险为0%。

**利用方式：**
1.  **网络扫描：** 利用 mDNS (Bonjour) 协议在本地网络中发现 AirPlay 设备。
2.  **构造恶意请求：** 构造一个包含恶意 URL 的 AirPlay POST 请求，目标是 `/play`。
3.  **发送请求：** 将构造的请求发送到目标 AirPlay 设备，尝试使其播放恶意 URL。
4.  **结果：** 如果漏洞存在，设备将尝试播放该恶意 URL，可能导致远程代码执行或者其他恶意行为（虽然漏洞描述里没有明确指出RCE，但结合搜索结果的 "AirPlay Zero-Click RCE Vulnerability Enables Remote ..."推测存在RCE的可能性）。需要注意的是，POC中使用的URL `http://attacker.local/evil.mov` 指向攻击者控制的服务器，需要攻击者自己搭建并提供恶意文件。

**项目地址:** [moften/CVE-2025-24271](https://github.com/moften/CVE-2025-24271)

**漏洞详情:** [CVE-2025-24271](https://nvd.nist.gov/vuln/detail/CVE-2025-24271)