## CVE-2025-42957-SAP S/4HANA-ABAP代码注入

**漏洞编号:** CVE-2025-42957

**漏洞类型:** ABAP代码注入

**影响应用:** SAP S/4HANA

**危害等级:** 严重，可能导致完全系统控制，数据泄露，业务流程篡改，拒绝服务

**影响版本:** S4CORE 102, 103, 104, 105, 106, 107, 108

**利用条件:** 需要具有用户权限的网络访问SAP系统，并且目标系统存在受影响版本的S4CORE

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-42957是SAP S/4HANA中存在的一个严重的ABAP代码注入漏洞。攻击者利用具有用户权限的账户，可以通过RFC（远程函数调用）接口调用存在漏洞的函数模块，向其中注入恶意的ABAP代码，绕过权限验证，从而完全控制SAP系统。根据搜索结果和漏洞描述，该漏洞的CVSS评分为9.9，属于严重级别，并且已经在野外被利用。

**漏洞利用有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，该漏洞的利用是有效的。POC代码提供了一个名为`ZVULN_EXPL`的函数模块示例，该模块接受用户名、角色和密码作为参数，并在`USR02`表中创建一个新的用户，并赋予指定的角色和密码。攻击者通过构造恶意的RFC调用，将包含恶意ABAP代码的参数传递给该函数模块，从而实现代码注入，提升权限并控制系统。

**投毒风险分析：**
分析POC代码本身，其主要功能是在SAP系统中创建用户。虽然这段代码的目的是验证漏洞的存在和利用，但客观上的确具备创建后门用户的功能，因此可以被认为是一种潜在的"投毒"代码，尽管它本身是为了验证漏洞而存在。

进一步评估仓库的投毒风险，需要考虑以下因素：

1.  **代码作者的信誉：** 代码作者署名为Mark Mallia，没有更多关于其背景的信息，无法评估其信誉。 
2.  **代码的复杂性：**  代码较为简单，易于理解和审计，这降低了隐藏恶意代码的难度。  
3.  **代码的意图：** 代码的意图明确，是用于演示和验证漏洞利用的。  
4.  **存在的风险：** 尽管代码本身是为了演示漏洞，但如果未经授权就被部署到生产环境中，那么将会造成安全风险。

基于以上分析，认为该仓库中存在作者隐藏的恶意代码的风险较低，约10%。 这主要是因为代码的功能比较直接，易于审查，并且作者声明的目的是为了漏洞演示。 然而，仍然存在代码被恶意修改或滥用的可能性，因此需要谨慎使用。

**漏洞利用方式：**

1.  **找到易受攻击的函数模块：** 确定可以通过RFC调用的，并且存在代码注入漏洞的函数模块。CVE-2025-42957漏洞描述中指出漏洞存在于通过RFC暴露的函数模块中。
2.  **构造恶意的RFC调用：** 构造一个包含恶意ABAP代码的RFC调用，该代码可以创建新的管理员用户，修改现有用户的权限，或执行其他恶意操作。
3.  **执行RFC调用：** 使用具有足够权限的SAP用户帐户执行构造的RFC调用。
4.  **验证漏洞利用：** 验证恶意代码是否已成功执行，例如，检查是否已创建新的管理员用户。

根据漏洞利用代码, 漏洞利用方式是通过函数模块 `ZVULN_EXPL` , 通过传递用户、角色、密码，创建恶意用户，从而获得系统控制权。

**项目地址:** [mrk336/CVE-2025-42957-SAP-S-4HANA-Under-Siege](https://github.com/mrk336/CVE-2025-42957-SAP-S-4HANA-Under-Siege)

**漏洞详情:** [CVE-2025-42957](https://nvd.nist.gov/vuln/detail/CVE-2025-42957)