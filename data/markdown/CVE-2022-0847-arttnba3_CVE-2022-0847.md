## CVE-2022-0847 (Dirty Pipe)

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致任意代码执行和完全系统控制

**影响版本:** Linux Kernel 5.17 rc6 及以下（具体受影响版本范围需进一步分析，参考漏洞库信息）

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于内核在处理管道缓冲区时，没有正确初始化`flags`成员，导致该成员可能包含过时的值。利用此漏洞，非特权本地用户可以写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断此POC是有效的，已经有公开的exp。

**投毒风险：**

分析提供的 `exp_suid.c` 代码：

*   该代码通过覆盖SUID程序（例如`/bin/passwd`）来获取root权限。
*   它将目标文件的前几个字节替换为一个小的ELF文件，该文件包含执行shell的shellcode。
*   shellcode本身没有明显的恶意行为，它只是启动一个shell。
* 代码功能是比较完善的EXP, 提供了静态编译的方式，可以有效提权。

漏洞利用本身是具有破坏性的，因为SUID文件被覆盖了。但是，从代码层面看，没有发现隐藏的后门或恶意行为。

**利用方式：**

1.  **查找目标文件：** 选择一个SUID文件作为攻击目标（例如`/bin/passwd`）。
2.  **利用Dirty Pipe覆盖目标文件：** 使用漏洞利用代码，通过`pipe`和`splice`系统调用，将恶意shellcode写入目标文件。
3.  **运行被覆盖的文件：** 执行被覆盖的SUID文件，触发shellcode，从而获得root shell。

**项目地址:** [arttnba3/CVE-2022-0847](https://github.com/arttnba3/CVE-2022-0847)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)