## CVE-2025-0133-PAN-OS-Reflected XSS

**漏洞编号:** CVE-2025-0133

**漏洞类型:** Reflected XSS

**影响应用:** PAN-OS GlobalProtect Gateway/Portal

**危害等级:** 中危，可能导致凭据窃取和钓鱼攻击

**影响版本:** PAN-OS 10.1.0 to 11.2.7 (受影响版本详见漏洞库信息)

**利用条件:** 需要目标系统启用GlobalProtect Gateway或Portal功能，且用户已通过Captive Portal认证。如果启用了Clientless VPN，风险更高。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0133 是 Palo Alto Networks PAN-OS GlobalProtect Gateway 和 Portal 功能中的一个反射型跨站脚本 (XSS) 漏洞。攻击者可以构造包含恶意 JavaScript 代码的特殊链接，诱使用户点击。如果用户已通过 Captive Portal 认证，恶意代码将在用户浏览器上下文中执行，从而可能导致会话劫持、凭据窃取或执行其他恶意操作。

**有效性分析：**

提供的 POC 代码（cve-2025-0133_scan.py）是一个扫描器，用于检测目标系统是否存在 CVE-2025-0133 漏洞。它首先发送一个正常的 HTTP 请求到 `/ssl-vpn/getconfig.esp` 端点，验证是否为 Palo Alto 设备。然后，它构造一个包含 XSS payload 的请求，如果响应中包含该 payload，则判断目标系统存在漏洞。根据漏洞库信息和搜索结果，该漏洞的利用方式是通过构造特定的 URL 参数，将恶意 JavaScript 代码注入到响应中。POC 代码通过模拟这种攻击方式来验证漏洞的存在，因此POC代码是有效的。

**投毒风险分析：**

仔细检查了提供的 `cve-2025-0133_scan.py` 脚本和 README.md 文件后，没有发现任何明显的投毒代码或恶意行为。脚本的主要功能是发送 HTTP 请求并分析响应，以检测 XSS 漏洞。它没有尝试修改系统文件、安装后门或执行任何其他未经授权的操作。因此，认为此仓库中存在作者隐藏的投毒代码的风险很低（0%）。

**利用方式总结：**

1.  **确定目标：** 找到运行受影响 PAN-OS 版本的 Palo Alto Networks 设备，且启用了 GlobalProtect Gateway 或 Portal 功能。
2.  **构造恶意链接：** 构造包含 XSS payload 的 URL，该 URL 指向 `/ssl-vpn/getconfig.esp` 端点，并将恶意 JavaScript 代码作为 `user` 参数的值。
3.  **诱骗用户点击：** 通过钓鱼邮件、社交媒体或其他方式，诱骗已通过 Captive Portal 认证的用户点击恶意链接。
4.  **执行 XSS：** 当用户点击链接时，恶意 JavaScript 代码将在用户浏览器上下文中执行。攻击者可以使用该代码来窃取 cookie、重定向用户到恶意网站或执行其他恶意操作。
5. **Clientless VPN风险:** 如果目标启用了Clientless VPN，攻击者窃取凭据的风险更高。

**项目地址:** [shawarkhanethicalhacker/CVE-2025-0133-exploit](https://github.com/shawarkhanethicalhacker/CVE-2025-0133-exploit)

**漏洞详情:** [CVE-2025-0133](https://nvd.nist.gov/vuln/detail/CVE-2025-0133)