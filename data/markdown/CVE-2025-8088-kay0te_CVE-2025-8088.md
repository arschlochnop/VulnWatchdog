## CVE-2025-8088-WinRAR路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个WinRAR的路径遍历漏洞，攻击者可以构造恶意的RAR压缩包，当用户解压该压缩包时，恶意文件会被释放到指定目录（如Windows启动目录），从而实现任意代码执行。

**有效性分析：**
根据漏洞信息和搜索引擎结果，该漏洞是真实存在的，并且已经被利用在实际攻击中。提供的POC代码尝试利用该漏洞，通过创建包含路径遍历payload的恶意RAR文件，将payload放置到Windows启动目录。从代码逻辑上看，POC代码是有效的，能够生成利用该漏洞的恶意压缩包。

**投毒风险分析：**
分析POC代码，存在一定的投毒风险。主要风险点在于以下几个方面：
1.  **恶意文件下载：**  POC代码首先会从`http://176.65.132.123/file_cache.exe` 下载一个exe文件，该文件的功能未知，可能是恶意程序，存在潜在的远程代码执行风险。 这部分代码非常可疑，属于高危行为。
2. **Payload可定制性：** 脚本允许创建自定义payload，虽然当前payload只是启动`notepad.exe`，但攻击者可以修改`generate_payload`函数，生成更具破坏性的payload，例如下载和执行恶意程序，或修改系统设置。
3. **配置文件的潜在风险：** 虽然提供的`config.py`文件较为简单，但如果攻击者修改该文件，可能会引入其他恶意行为。

综合评估，POC代码存在一定的投毒风险，尤其是exe下载部分需要高度关注。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的RAR压缩包，该压缩包中包含payload（例如一个.bat脚本或一个exe文件）。
2.  恶意路径利用`..\`进行目录遍历，将payload指向Windows启动目录（`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup`）。
3.  用户如果使用存在漏洞的WinRAR版本解压该压缩包，payload会被释放到启动目录。
4.  当用户下次启动计算机时，启动目录中的payload会被执行，从而实现攻击者预期的恶意行为。

**缓解措施：**
1.  尽快升级到最新版本的WinRAR，以修复该漏洞。
2.  避免解压来源不明的RAR压缩包。
3.  使用安全软件对RAR压缩包进行扫描，以检测潜在的恶意文件。

根据分析，我给出的投毒风险评定为 **10%**。 主要风险在于未经分析的exe下载行为, 考虑到代码主要逻辑仍然是漏洞利用，而非完全为了投放恶意软件而编写，所以给出了这个百分比。

**项目地址:** [kay0te/CVE-2025-8088](https://github.com/kay0te/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)