## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal / Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** Apache HTTP Server 版本为2.4.49，并且存在Alias-like指令配置，且这些目录下的文件未被"require all denied"保护，CGI脚本被启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。

**有效性：**

提供的POC代码（`cve-2021-41773.py`, `cve-2021-41773_RCE.py`, `cve-2021-41773_manual.py`）旨在利用此漏洞。 `cve-2021-41773.py` 尝试读取 `/etc/passwd` 文件以验证漏洞的存在。`cve-2021-41773_RCE.py` 尝试通过 CGI 脚本执行命令。

根据搜索结果，该漏洞在野外被积极利用，因此，提供的POC代码很可能有效，但成功利用取决于目标服务器的配置。

**投毒风险：**

审查提供的POC代码，没有发现明显的恶意代码或后门。代码的功能是扫描目标是否存在漏洞，并尝试利用漏洞读取文件或执行命令。`cve-2021-41773.py`的第49行给出了可以添加常见目录的提示，但本身不具备投毒性。

**利用方式：**

1.  **路径遍历：** 攻击者使用特殊的 URL 编码序列（例如 `/.%2e/%2e%2e/`）来绕过路径规范化，从而访问 Alias-like 指令配置目录之外的文件。
2.  **文件读取：** 如果目标文件没有被 "require all denied" 保护，攻击者可以读取任意文件，例如 `/etc/passwd`，从而获取敏感信息。
3.  **远程代码执行：** 如果 CGI 脚本被启用，攻击者可以通过构造恶意的 URL 和 POST 数据来执行任意代码。例如，`cve-2021-41773_RCE.py` 使用 `/cgi-bin/` 目录，并尝试执行 `uname` 命令。

总而言之，此漏洞的利用需要特定的配置条件，但如果满足条件，则风险非常高。

**项目地址:** [FakesiteSecurity/CVE-2021-41773](https://github.com/FakesiteSecurity/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)