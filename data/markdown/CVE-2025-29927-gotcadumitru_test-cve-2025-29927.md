## CVE-2025-29927-Next.js-AuthorizationBypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行权限验证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中的一个权限绕过漏洞。攻击者可以通过操纵`x-middleware-subrequest` header 绕过中间件的身份验证。提供的漏洞利用代码是一个标准的Next.js项目结构，`middleware.ts` 文件模拟了一个简单的权限验证，但是缺少对 `x-middleware-subrequest` 头的处理，容易被绕过. 仓库中的投毒风险较低，主要体现在 package-lock.json 中存在一些依赖，但是没有发现明显的恶意代码。

**利用方式：**

1.  攻击者发送一个带有 `x-middleware-subrequest: anything` 头的HTTP请求到受保护的路由。
2.  Next.js应用如果没有正确验证或移除该header，中间件的权限验证会被绕过。
3.  攻击者可以未经授权访问受保护资源。

**项目地址:** [gotcadumitru/test-cve-2025-29927](https://github.com/gotcadumitru/test-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)