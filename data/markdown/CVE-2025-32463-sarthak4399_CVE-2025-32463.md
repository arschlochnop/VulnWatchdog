## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 是一个 Sudo 提权漏洞，允许本地用户利用 `--chroot` 选项和用户控制的 `/etc/nsswitch.conf` 文件获取 root 权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以判断此漏洞利用方法有效。搜索引擎结果中多个链接证实了该漏洞的存在，并说明了该漏洞允许本地用户通过 `--chroot` 选项提升权限。漏洞库信息也明确指出该漏洞影响 Sudo 1.9.14 到 1.9.17p1 之前的版本。
提供的 PoC 代码通过创建临时的 chroot 环境，并在该环境中放置恶意的 `nsswitch.conf` 文件和一个包含构造函数的共享库来实现提权。当 `sudo -R` 命令执行时，会加载恶意的共享库，执行其中的构造函数，该函数将当前用户的 UID 和 GID 设置为 0 (root)，从而获得 root 权限。

**投毒风险分析：**

分析 PoC 代码后，未发现明显的投毒代码。PoC 代码的主要功能是利用 Sudo 的 `--chroot` 选项加载恶意的共享库以提升权限。代码中唯一可疑的部分是执行任意命令的功能，通过`${CMD_C_ESCAPED}`传递，该变量来自用户提供的参数。但这个行为是 PoC 的预期功能，用于指定提权后执行的命令，不算恶意投毒，因此投毒风险评估为0%。

**漏洞利用方式分析：**

1.  **创建临时目录：** PoC 首先创建一个临时目录，用于存放后续生成的文件。
2.  **生成恶意共享库：** PoC 生成一个 C 语言源文件，该文件包含一个构造函数 (`__attribute__((constructor))`)。构造函数在共享库加载时自动执行，用于将当前用户的 UID 和 GID 设置为 0，从而获取 root 权限。此外，构造函数还执行用户指定的命令。
3.  **创建 chroot 环境：** PoC 创建一个 chroot 环境，包含必要的目录结构 `/etc` 和 `libnss_`，以及文件 `/etc/nsswitch.conf`。`nsswitch.conf` 文件被修改为指向恶意的共享库。
4.  **触发漏洞：** PoC 使用 `sudo -R` 命令，指定 chroot 目录为之前创建的临时目录。由于 `nsswitch.conf` 文件被修改，`sudo` 会加载恶意的共享库，执行其中的构造函数，从而提升权限。
5.  **执行命令：** 提权成功后，执行用户指定的命令（默认为 `/bin/bash`，即启动一个 root shell）。

**项目地址:** [sarthak4399/CVE-2025-32463](https://github.com/sarthak4399/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)