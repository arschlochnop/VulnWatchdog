## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标SSH服务器建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473是一个OpenSSH的用户名枚举漏洞。OpenSSH 7.7及更早版本存在此漏洞，原因是它在完全解析包含请求的数据包之前，没有延迟无效身份验证用户的退出，导致可以根据响应时间来判断用户是否存在。

**漏洞利用方式：**

1.  **发送畸形请求：**  利用该漏洞，攻击者可以发送包含无效公钥认证请求的畸形SSH数据包到目标服务器。由于漏洞的存在，OpenSSH服务器在验证用户是否存在之前就开始处理该数据包，因此可以根据服务器的响应时间来区分有效的用户名和无效的用户名。
2.  **时间差分析：**  有效的用户名会比无效的用户名返回不同的响应或响应时间稍有不同。通过多次尝试和测量响应时间，攻击者可以识别出目标系统上存在的用户名。
3.  **POC代码分析：**  提供的POC代码（`exploit.py`）通过monkey patch `paramiko` 库，篡改SSH认证过程，故意发送无效的认证请求，并捕获服务器的响应。如果服务器返回特定的错误，则脚本会判断用户名无效。脚本还使用了多线程来加速枚举过程。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，可以判断此漏洞利用是有效的。POC代码已经实现了利用该漏洞进行用户名枚举的功能。

**投毒风险：**

检查`exploit.py`和`README.md`文件，虽然主要功能是实现用户名枚举，但依然存在一定的投毒风险。主要集中在以下几个方面：

1.  **依赖项风险：** 虽然代码本身依赖项较少，主要为`paramiko`，但是如果使用者不小心安装了恶意版本的`paramiko`，则可能引入恶意代码。
2.  **网络钓鱼风险：** README中提供的使用方式，可能诱导用户在不了解代码的情况下直接运行，如果代码被篡改，可能执行恶意操作。
3.  **日志泄露风险：** 脚本可能会将尝试的用户名和服务器响应写入日志文件，如果日志文件被攻击者获取，可能会泄露信息。

总体来说，直接的恶意代码注入风险较低，但社会工程学和供应链投毒的风险依然存在。因此，判断投毒风险为10%。

**项目地址:** [0xNehru/ssh_Enum_vaild](https://github.com/0xNehru/ssh_Enum_vaild)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)