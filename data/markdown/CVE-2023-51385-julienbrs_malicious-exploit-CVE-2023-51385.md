## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名或主机名包含Shell元字符，并且在特定情况下被扩展令牌引用

**POC 可用性:** 是，但提供的POC代码不完整

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中，允许在特定情况下进行操作系统命令注入。如果用户名或主机名包含 Shell 元字符，并且该名称被某些扩展令牌引用，则可能发生此漏洞。例如，不受信任的 Git 存储库可能具有一个子模块，其用户名或主机名中包含 shell 元字符。提供的漏洞利用代码只是一个 README 文件，本身不包含任何利用逻辑。因此，实际利用还需要构造恶意用户名/主机名并通过特定的 OpenSSH 功能（如 ProxyCommand）触发命令注入。

**有效性：** 提供的POC代码 (README.md) 本身无效，仅为占位符，不具备漏洞利用能力。需要结合漏洞描述构造特定的利用场景才能触发漏洞。

**投毒风险：** 由于提供的代码仅仅是 README 文件，所以认为存在投毒代码的可能性较低，但是不排除作者在其他未提供的代码中隐藏恶意Payload，因此投毒风险评估为 10%。

**利用方式：** 漏洞利用方式如下：
1.  攻击者需要控制包含恶意 Shell 元字符的用户名或主机名。
2.  攻击者诱使用户使用受影响的 OpenSSH 版本连接到恶意服务器或克隆包含恶意配置的Git仓库，触发包含shell元字符的用户名或主机名被引用。
3.  OpenSSH 在处理这些包含 Shell 元字符的名称时，由于不正确的转义或过滤，导致命令注入。
4.  攻击者可以在目标系统上执行任意命令。

**项目地址:** [julienbrs/malicious-exploit-CVE-2023-51385](https://github.com/julienbrs/malicious-exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)