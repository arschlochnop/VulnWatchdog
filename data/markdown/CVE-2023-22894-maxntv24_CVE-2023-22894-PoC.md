## CVE-2023-22894-Strapi敏感信息泄露

**漏洞编号:** CVE-2023-22894

**漏洞类型:** 信息泄露

**影响应用:** Strapi

**危害等级:** 中危，可能导致敏感用户信息泄露

**影响版本:** <= 4.5.5

**利用条件:** 需要访问Strapi管理面板或公共API端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22894允许攻击者（需要访问管理面板或特定API端点）通过利用查询过滤器来发现敏感用户信息。攻击者可以根据包含敏感信息的列来过滤用户，并从API响应中推断出值。漏洞利用方式如下：

1.  **访问权限：** 攻击者需要具有访问 Strapi 管理面板或具有与用户关联的公共API端点的权限。
2.  **目标API端点：** 攻击者需要确定暴露用户数据的API端点，例如`/api/users`或者自定义的关联用户的端点。
3.  **构造恶意查询：** 攻击者通过构造包含特定过滤器的恶意查询来利用漏洞。例如，使用`filters[$and][0][createdBy][password][$startsWith]`参数尝试匹配用户密码哈希的开头字符。
4.  **信息泄露：** 通过不断尝试不同的字符，攻击者可以逐步推断出完整的密码哈希或密码重置令牌。

**关于投毒风险：**

POC代码主要功能是利用多线程爆破密码hash以及重置token,代码量不大,人工review,发现
  *   代码可能存在的风险点：
    1.  **依赖风险：**  代码依赖`requests`库，如果开发者在安装该库时使用了非官方源，存在被供应链攻击的风险。这是一个间接的风险。
    2.  **资源消耗：**  多线程爆破操作会消耗大量服务器资源，如果被恶意利用，可能导致目标服务器拒绝服务。
    3.  **错误处理：**  代码的错误处理机制相对简单，如果API端点出现异常，可能导致程序崩溃或泄露敏感信息。

 综合考虑，该POC代码本身**直接包含恶意投毒代码的可能性较低**，约为5%。但是不能排除通过依赖引入间接投毒的风险，使用时应注意。


**项目地址:** [maxntv24/CVE-2023-22894-PoC](https://github.com/maxntv24/CVE-2023-22894-PoC)

**漏洞详情:** [CVE-2023-22894](https://nvd.nist.gov/vuln/detail/CVE-2023-22894)