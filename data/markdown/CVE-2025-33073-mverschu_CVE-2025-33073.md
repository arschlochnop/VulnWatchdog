## CVE-2025-33073 Windows SMB Client 权限提升漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，允许经过身份验证的攻击者通过网络提升权限。

**影响版本:** 受影响的Windows版本众多，详见CVE描述。

**利用条件:** 攻击者需要能够访问目标网络，并拥有有效的域用户凭据。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是Windows SMB客户端中的不当访问控制漏洞，允许经过身份验证的攻击者通过网络提升权限。根据搜索结果，该漏洞利用了NTLM中继，通过操纵DNS记录和PetitPotam强制身份验证。攻击者首先使用`dnstool.py`添加恶意的DNS记录，指向攻击者控制的IP地址。然后，启动`ntlmrelayx`监听器，准备中继收到的NTLM认证。使用PetitPotam强制目标系统通过SMB协议向攻击者控制的服务器进行身份验证。`ntlmrelayx`会将收到的NTLM认证中继到目标系统，从而提升权限。 

**漏洞利用有效性：**
提供的PoC代码看起来是有效的。它包含利用此漏洞所需的关键步骤，包括DNS记录操纵、NTLM中继和PetitPotam强制身份验证。该PoC已经整合了exp，并且包含相关readme，可以较快的进行复现。

**投毒风险：**
该仓库中存在作者隐藏的投毒代码的可能性较低，大约1%。主要原因是该漏洞信息已被公开披露，并且有多个来源确认了漏洞的存在和利用方式。PoC代码本身执行的操作与漏洞描述和搜索结果一致，没有发现明显的可疑代码或后门。不过，使用任何第三方代码都存在风险，建议在使用前进行仔细的代码审查。代码中可能存在细微的逻辑错误，或者一些不明显的恶意行为。

**漏洞利用方式：**
1.  **DNS 欺骗：** 攻击者使用 `dnstool.py` 工具添加一条指向攻击者控制的服务器的恶意 DNS 记录。
2.  **NTLM 中继：** 攻击者运行 `ntlmrelayx` 监听器，等待接收 NTLM 认证信息。
3.  **PetitPotam 强制认证：** 攻击者使用 PetitPotam 强制目标机器向攻击者的服务器进行身份验证。
4.  **权限提升：** `ntlmrelayx` 将收到的 NTLM 认证信息中继到目标服务器，从而允许攻击者提升权限。

综上所述，该漏洞的利用需要一定的技术水平和对NTLM协议的理解。尽管存在一定的风险，但该PoC代码的有效性较高。

**项目地址:** [mverschu/CVE-2025-33073](https://github.com/mverschu/CVE-2025-33073)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)