## CVE-2020-3452 Cisco ASA/FTD 路径遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA Software, Cisco Firepower Threat Defense (FTD) Software

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 受影响版本：< 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452 是 Cisco ASA 和 FTD 软件中的一个高危路径遍历漏洞。由于对 HTTP 请求中的 URL 缺乏适当的输入验证，未经身份验证的远程攻击者可以利用此漏洞执行目录遍历攻击，并读取目标系统上的敏感文件。漏洞存在于web服务接口，只有在启用 WebVPN 或 AnyConnect 功能时才可被利用。

**有效性分析：**
提供的PoC代码 `PoC.py` 旨在利用 CVE-2020-3452 漏洞，经验证有效。它通过构造包含目录遍历字符序列的特制 HTTP 请求，尝试从目标设备读取文件。

**投毒风险分析：**
检查提供的 `PoC.py` 文件，主要功能是发送特制的 HTTP 请求以利用路径遍历漏洞，并尝试下载预定义的文件列表。脚本限制了成功下载的数量 (`MAX_SUCCESS_WRITES`)，并对文件名进行清理以避免目录遍历问题。没有发现明显的恶意代码或后门，因此投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行受影响的 Cisco ASA 或 FTD 软件版本且启用了 WebVPN 或 AnyConnect 功能的目标设备。
2.  **漏洞利用：** 使用提供的 PoC 脚本（`PoC.py`），指定目标设备的 IP 地址或 URL。
3.  **请求构造：** 脚本构造包含目录遍历字符序列的 HTTP GET 请求。该请求发送到目标设备的 `/+CSCOT+/translation-table` 端点。
4.  **文件读取：** 如果目标设备存在漏洞，它将返回被请求的文件内容。
5.  **结果保存：** 脚本会将成功检索的文件保存到本地 `output` 目录中。

**缓解措施：**
将 Cisco ASA 或 FTD 软件升级到不受漏洞影响的版本。

**项目地址:** [abrewer251/CVE-2020-3452_Cisco_ASA_PathTraversal](https://github.com/abrewer251/CVE-2020-3452_Cisco_ASA_PathTraversal)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)