## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和权限提升

**影响版本:** <= 2.2.9

**利用条件:** 需要目标系统运行CMS Made Simple 2.2.9或更早版本，并且News模块已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.8中发现的一个问题。通过精心设计的URL，攻击者可以利用News模块中的m1_idlist参数实现未经身份验证的盲注时间型SQL注入。

**有效性：**
根据漏洞库信息、搜索引擎结果（尤其是Exploit-DB）和提供的漏洞利用代码，该漏洞的POC代码应该是有效的。多个来源都提到了该漏洞的存在和可利用性，并且存在公开可用的利用代码。

**投毒风险：**
代码主要逻辑是进行盲注时间型SQL注入，逐步dump出salt, password, username等信息，并尝试破解密码。
虽然整体代码的功能是实现漏洞利用，但存在一定的投毒风险。

*   **风险点分析：**  虽然整体框架正常，但作者可能在以下位置植入恶意代码：
    1.  **字典文件：** `crack_password`函数使用字典进行密码破解。如果攻击者控制了字典文件，可以在其中添加恶意条目，例如尝试执行系统命令的payload，虽然md5加密会一定程度限制恶意payload,但是无法完全杜绝。
    2.  **Payload构造：**  虽然Payload的构造方式较为直接，但是攻击者有可能通过修改payload的构造方式在dump数据的过程中执行其他操作。
    3.  **TIME变量：** TIME变量的值影响攻击的效率和准确性。攻击者可以通过设置过小的TIME值来降低攻击的成功率，或者设置过大的TIME值导致目标系统的拒绝服务。
    4.  **网络请求参数篡改：** 脚本中使用了`requests`库发送网络请求。虽然代码中没有直接体现，但攻击者可能会在请求中添加或修改header，进行恶意操作，例如跨站请求伪造。
   基于以上分析，存在一定投毒风险，我给出的百分比为10%。

**利用方式：**
1.  **确定目标：**  找到运行着CMS Made Simple 2.2.9或更早版本的网站。
2.  **准备工作：**  准备好漏洞利用脚本（例如提供的Python脚本），并根据需要配置目标URL、字典文件等参数。
3.  **漏洞利用：**  运行脚本，脚本会通过构造恶意的URL，利用News模块中的SQL注入漏洞，逐步提取数据库中的敏感信息。
4.  **密码破解：**  如果成功提取到密码哈希值和salt，可以使用字典文件进行离线破解。
5.  **权限提升：**  使用破解出的管理员密码登录后台，从而控制整个网站。


**项目地址:** [SUNNYSAINI01001/46635.py_CVE-2019-9053](https://github.com/SUNNYSAINI01001/46635.py_CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)