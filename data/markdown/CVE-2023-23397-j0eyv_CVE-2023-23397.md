## CVE-2023-23397-Microsoft Outlook Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致NTLM Relay攻击，控制受害者账号

**影响版本:** 受影响版本：Microsoft Outlook 2013 SP1, 2016, 2019, Office LTSC 2021, Microsoft 365 Apps for Enterprise (具体版本参考漏洞库信息)

**利用条件:** 攻击者需要向受害者发送包含恶意属性的邮件。受害者无需打开邮件，只需预览或接收即可触发漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞，攻击者可以利用该漏洞通过发送特制的电子邮件窃取受害者的 Net-NTLM 哈希值，从而发起 NTLM Relay 攻击。攻击者在邮件中设置一个指向攻击者控制的SMB服务器的`PidLidReminderFileParameter`属性。当Outlook处理该邮件时，会尝试连接该SMB服务器进行身份验证，从而将受害者的 Net-NTLM 哈希值发送给攻击者。此漏洞利用无需用户交互，只需预览或接收邮件即可触发，风险极高。

提供的两个 PowerShell 脚本 (`Detect-M365-Update.ps1` 和 `Remediate-M365-Update.ps1`) 并非直接的漏洞利用代码，而是用于检测和修复漏洞的脚本。 `Detect-M365-Update.ps1` 脚本用于检查 Outlook 是否已安装受影响的版本，而 `Remediate-M365-Update.ps1` 脚本尝试更新 Outlook 以修复漏洞。因此，提供的脚本本身不是漏洞利用，而是补丁检测/修复工具。 

投毒风险评估：虽然脚本本身是用于检测和修复漏洞，但脚本修改了注册表以及执行了更新操作。 如果脚本被篡改，可能存在投毒风险，例如，将更新服务器指向恶意地址，从而安装恶意软件。考虑到这种可能性，投毒风险评估为10%。脚本本身不包含明显的恶意代码，但是任何脚本都可能被篡改，所以存在风险。

**项目地址:** [j0eyv/CVE-2023-23397](https://github.com/j0eyv/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)