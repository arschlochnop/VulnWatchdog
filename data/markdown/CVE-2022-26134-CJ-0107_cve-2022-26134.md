## CVE-2022-26134-Confluence-OGNL注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 <= version < 7.13.7, 7.14.0 <= version < 7.14.3, 7.15.0 <= version < 7.15.2, 7.16.0 <= version < 7.16.4, 7.17.0 <= version < 7.17.4, 7.18.0 <= version < 7.18.1

**利用条件:** Confluence服务可访问，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的攻击者执行任意代码。该漏洞是由于 OGNL 注入造成的。根据搜索引擎结果，该漏洞已被积极利用，并用于部署恶意软件，如加密货币挖矿程序。提供的PoC代码使用pocsuite3框架编写，通过构造特定的URL，其中包含恶意的OGNL表达式，来利用此漏洞。此表达式尝试执行系统命令（如 'id'），并通过 HTTP 响应头 'X-Cmd-Response' 返回命令执行的结果，从而验证漏洞的存在。虽然PoC本身是为了验证漏洞而设计，但任何允许远程代码执行的漏洞都存在被滥用的风险，可能被用于植入后门、窃取数据或进行其他恶意活动。 

**有效性：**
PoC代码有效，可以用于检测目标Confluence服务器是否存在CVE-2022-26134漏洞。

**投毒风险：**
PoC代码主要功能是执行命令并获取响应，虽然作者声明免责，但是代码中如果被替换恶意命令，存在一定投毒风险，主要体现在：
1.  **依赖第三方库：** PoC使用了`pocsuite3`框架，该框架本身依赖多个第三方库，如果第三方库被恶意篡改，可能引入安全风险。
2.  **命令执行的灵活性：** PoC中执行的命令可以通过修改URL中的OGNL表达式来改变，如果攻击者控制了PoC的使用环境，可以将`id`命令替换为更具破坏性的命令。

综合以上因素，投毒风险评定为10%。 主要风险来自于使用者的非安全使用。仓库本身代码逻辑没有发现明显后门代码，需要使用者自己review代码。

**利用方式：**
1.  攻击者构造包含恶意OGNL表达式的URL，发送到目标Confluence服务器。
2.  Confluence服务器解析OGNL表达式，执行其中的命令。
3.  命令执行结果通过HTTP响应头返回，攻击者可以获取执行结果。
4.  攻击者可以利用此漏洞执行任意系统命令，从而控制Confluence服务器。

**项目地址:** [CJ-0107/cve-2022-26134](https://github.com/CJ-0107/cve-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)