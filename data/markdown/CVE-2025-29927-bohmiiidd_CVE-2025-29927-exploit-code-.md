## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是一个存在于 Next.js 中间件的授权绕过漏洞。当 Next.js 应用的授权检查逻辑实现在中间件中时，攻击者可以通过发送包含 `x-middleware-subrequest`  header 的恶意请求绕过这些检查。该漏洞源于 Next.js 对 `x-middleware-subrequest` 头部处理不当。  

**有效性：**
提供的 PoC 代码有效。它通过构造包含 `x-middleware-subrequest` 头的 HTTP 请求来尝试绕过中间件的授权检查，访问受保护的 `/dashboard` 路径。如果服务器返回 200 状态码，则表明绕过成功。根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的 PoC。

**投毒风险：**
PoC 代码本身比较简单，主要功能是发送带有特定 header 的 HTTP 请求。在给定的代码中，没有明显的投毒代码。例如，没有执行系统命令、修改文件系统或进行其他恶意操作的代码。风险主要来自对 PoC 代码的修改。因此，此处投毒风险较低，大约为 5%。潜在的风险可能是修改 PoC，使其在成功绕过认证后，执行恶意操作，但原始 PoC 仅旨在验证漏洞的存在。

**利用方式：**
1.  确定目标 Next.js 应用使用了中间件进行授权检查。
2.  确定目标应用使用的 Next.js 版本在受影响的范围内 (13.x < 13.5.9, 14.x < 14.2.25, 15.x < 15.2.3)。
3.  向目标应用发送包含 `x-middleware-subrequest: middleware` 头的 HTTP 请求，尝试访问受保护的资源（例如 `/dashboard`）。
4.  如果服务器返回 200 状态码，则表明授权绕过成功。
5.  如果授权绕过成功，攻击者可以访问通常需要身份验证才能访问的资源，从而可能导致数据泄露或其他安全问题。

**项目地址:** [bohmiiidd/CVE-2025-29927-exploit-code-](https://github.com/bohmiiidd/CVE-2025-29927-exploit-code-)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)