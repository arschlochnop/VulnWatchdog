## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要启用HTTP PUT方法 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617漏洞允许攻击者通过上传恶意JSP文件到启用了HTTP PUT的Tomcat服务器上执行任意代码。漏洞利用需要以下条件：

1.  Tomcat版本在受影响范围内 (9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81).
2.  `readonly` 初始化参数在 Default servlet 中设置为 `false`，从而启用 HTTP PUT 方法。

**利用方式：**

1.  攻击者发送一个特制的 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。
2.  上传的文件通常包含可以执行系统命令的恶意Java代码。
3.  攻击者随后通过 HTTP GET 请求访问上传的 JSP 文件。
4.  Tomcat服务器执行JSP文件中的代码，从而允许攻击者在服务器上执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞的POC是有效的。Exploit-DB 提供了相关的利用代码 (42966, 43008)，表明该漏洞可以被成功利用。

**投毒风险：**

提供的漏洞利用代码只是一个`README.md`文件，描述为“Network forensics example”。 仅凭这个文件**很难直接判定存在投毒代码**。因为其本身不具备任何可执行或者恶意指令。该仓库可能包含网络取证相关的分析脚本或数据，但不能明确是恶意代码，所以初步估计**投毒风险较低，约为10%**。需要进一步分析该仓库中的其他文件才能更准确地评估投毒风险。存在一种可能性，即作者可能在其他的分析脚本中隐藏了恶意指令，诱导用户在分析网络流量时执行，从而感染用户系统。谨慎起见，在使用任何来自不可信来源的脚本之前，都应该仔细检查其代码。

**项目地址:** [ducknuts/network-forensics-cve-2017-12617](https://github.com/ducknuts/network-forensics-cve-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)