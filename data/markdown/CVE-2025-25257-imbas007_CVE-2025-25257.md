## CVE-2025-25257 - FortiWeb GUI SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本未知，但漏洞已于2025年7月8日发布补丁

**利用条件:** 目标FortiWeb设备可通过网络访问，并且存在漏洞的API接口未被阻止。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-25257是FortiWeb设备GUI组件中的一个未经身份验证的SQL注入漏洞。攻击者可以通过构造恶意的SQL语句，利用存在漏洞的`/api/fabric/device/status` API接口，在`Authorization`头中注入恶意代码。成功利用此漏洞可能导致攻击者执行任意SQL命令，上传webshell，并最终实现远程代码执行。

**漏洞利用方式：**

1.  **SQL注入：** 攻击者构造包含恶意SQL语句的`Authorization`头，发送到`/api/fabric/device/status`接口。
2.  **Webshell上传：** 利用SQL注入漏洞，向`/cgi-bin/x.cgi`路径写入webshell。
3.  **命令执行：** 通过访问上传的webshell（`/cgi-bin/x.cgi`），并在User-Agent头中传递要执行的命令，实现远程代码执行。
4.  **exp.py:**  exp.py脚本通过向webshell_url发送请求,并且将需要执行的命令放置在请求头User-Agent中,webshell代码会将请求头中的User-Agent作为命令执行.

**有效性：**

根据搜索结果和提供的漏洞利用代码，此POC的有效性较高。多个安全厂商和研究人员都确认了该漏洞的存在，并发布了相关的补丁和分析报告。漏洞利用代码提供了一个完整的攻击链，包括漏洞检测、webshell上传和命令执行。

**投毒风险：**

该存储库中存在恶意投毒代码的风险较低。主要风险在于利用该漏洞对目标系统进行恶意攻击，而不是POC代码本身包含恶意功能。`vuln_check.py` 会上传webshell文件到目标服务器。需要注意`vuln_check.py`脚本中的`_chmod_file`和`_webshell`变量，确保上传的webshell代码符合预期，并没有被篡改。

**总结：** 该漏洞是一个严重的安全问题，攻击者可以利用它完全控制受影响的FortiWeb设备。建议尽快应用Fortinet提供的补丁。

**项目地址:** [imbas007/CVE-2025-25257](https://github.com/imbas007/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)