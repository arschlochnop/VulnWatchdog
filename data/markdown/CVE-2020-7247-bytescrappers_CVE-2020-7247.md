## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，允许远程攻击者以root权限执行任意命令

**影响版本:** 6.6

**利用条件:** 目标系统运行存在漏洞的OpenSMTPD 6.6，并且配置为默认的“uncommented”配置，允许未授权的SMTP连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7247 漏洞存在于 OpenSMTPD 6.6 的 smtp_session.c 文件中的 smtp_mailaddr 函数中。攻击者可以通过在 MAIL FROM 字段中注入 shell 元字符，利用不正确的输入验证返回值来执行任意命令，从而实现远程代码执行。根据提供的POC代码，攻击者首先建立与目标SMTP服务器的连接，然后发送 HELO 命令，接着发送包含恶意 shell 命令的 MAIL FROM 命令，该命令利用了漏洞。然后发送 RCPT TO、DATA 命令，再发送包含一段特殊格式的payload, 最后发送 QUIT 命令结束会话。漏洞利用的关键在于MAIL FROM命令中的shell命令注入，利用 OpenSMTPD 未正确处理的漏洞点，执行任意命令。因为漏洞利用代码中的payload部分是接受命令行的参数，没有发现额外的后门代码，所以判定投毒风险为0%。搜索引擎结果确认该漏洞的存在，并指出利用该漏洞可以执行任意shell命令。

**项目地址:** [bytescrappers/CVE-2020-7247](https://github.com/bytescrappers/CVE-2020-7247)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)