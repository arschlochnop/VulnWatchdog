## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 目标设备已连接互联网，并启用远程接入VPN或移动接入软件 Blades

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个高危信息泄露漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的远程攻击者读取 Check Point Security Gateway 设备上的任意文件。利用方式是通过构造包含路径遍历的恶意请求，发送到 `/clients/MyCRL` 接口。PoC 代码通过遍历 `critical_paths` 列表中的敏感文件路径，尝试读取这些文件。该代码首先发送一个包含恶意路径的 POST 请求到目标服务器。如果服务器返回状态码 200，则返回响应内容，否则返回错误信息。代码中未发现明显的投毒行为，因此投毒风险为0%。

**有效性评估:** PoC 代码基于漏洞描述，实现了路径遍历攻击，可以读取目标设备上的文件，因此是有效的。

**利用方式总结:**
1.  攻击者构造包含路径遍历的 URL，例如 `https://<target_ip>/clients/MyCRL`，并在 POST 请求的数据中包含恶意路径。例如：`aCSHELL/../../../../../../../../../../..{path}`
2.  目标设备在处理请求时，未对路径进行充分验证，导致攻击者可以访问任意文件。
3.  攻击者通过读取敏感配置文件（例如 `/etc/passwd`、`/etc/shadow`）或日志文件（例如 `/var/log/auth.log`），获取敏感信息。

**项目地址:** [H3KEY/CVE-2024-24919](https://github.com/H3KEY/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)