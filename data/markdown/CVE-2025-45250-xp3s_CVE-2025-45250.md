## CVE-2025-45250-MrDoc-SSRF

**漏洞编号:** CVE-2025-45250

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** MrDoc

**危害等级:** 中危，可能导致信息泄露，内网探测，甚至远程代码执行 (如果内网服务存在漏洞)

**影响版本:** <= 0.95

**利用条件:** 需要登录权限以获取cookie值，目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-45250是MrDoc v0.95及之前版本中存在的服务器端请求伪造（SSRF）漏洞，位于`app_doc/utils.py`文件的`validate_url`函数中。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。POC通过向`/upload_doc_img/`端点发送包含恶意URL的POST请求，利用`validate_url`函数对用户提供的URL进行验证时未进行充分过滤的缺陷，实现SSRF攻击。

**投毒风险：**

提供的POC代码本身只包含漏洞利用的必要信息，没有发现明显的恶意代码。该仓库中README.md文件主要描述了漏洞信息和利用方法, 因此投毒的概率较低。需要注意的是，任何从公共来源获取的代码都存在一定的风险，应进行代码审计。

**利用方式：**

1.  攻击者首先需要登录MrDoc系统，获取有效的cookie值。
2.  构造一个包含恶意URL的JSON数据，例如`{"url": "http://127.0.0.2"}`，其中URL指向攻击者想要访问的内部或外部资源。
3.  使用POST请求将JSON数据发送到`/upload_doc_img/`端点，同时附带获取的cookie。
4.  MrDoc服务器的`validate_url`函数会解析并尝试访问攻击者提供的URL，从而实现SSRF攻击。

该漏洞允许攻击者利用MrDoc服务器作为跳板，探测内网服务，读取敏感信息，甚至在特定情况下执行任意命令（如果内网服务存在相关漏洞）。

**项目地址:** [xp3s/CVE-2025-45250](https://github.com/xp3s/CVE-2025-45250)

**漏洞详情:** [CVE-2025-45250](https://nvd.nist.gov/vuln/detail/CVE-2025-45250)