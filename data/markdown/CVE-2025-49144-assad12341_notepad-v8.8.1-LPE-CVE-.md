## CVE-2025-49144-Notepad++-权限提升

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户获得SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 需要用户下载并运行包含恶意regsvr32.exe的Notepad++安装包，用户需要具有运行安装程序的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49144是Notepad++ 8.8.1及之前版本安装程序中的一个权限提升漏洞。该漏洞源于安装过程中对可执行文件搜索路径的不安全控制。攻击者可以通过社会工程学诱使用户下载Notepad++安装程序，并在**同一目录下放置一个恶意的`regsvr32.exe`文件**。当用户运行安装程序时，安装程序会调用该恶意的`regsvr32.exe`，由于安装程序通常以SYSTEM权限运行，因此恶意代码也会以SYSTEM权限执行，从而导致权限提升。 

**利用方式：**
1.  攻击者制作恶意的`regsvr32.exe`文件，该文件包含攻击者想要执行的恶意代码（例如，反向shell）。
2.  攻击者通过社会工程学或其他方式，诱使用户下载Notepad++安装程序和恶意的`regsvr32.exe`文件，并将它们放置在同一目录下（通常是用户的Downloads目录）。
3.  用户运行Notepad++安装程序。
4.  安装程序在执行过程中，由于搜索路径问题，会错误地执行攻击者放置的恶意的`regsvr32.exe`文件，并赋予其SYSTEM权限。
5.  攻击者的恶意代码以SYSTEM权限执行，从而完成权限提升。

**有效性：**
提供的POC代码是有效的。它描述了如何使用`msfvenom`生成shellcode，并将其嵌入到`regsvr32_loader.c`中，然后编译成`regsvr32.exe`。当Notepad++安装程序调用`regsvr32.exe`时，实际执行的是攻击者编译的恶意程序，从而获得SYSTEM权限的meterpreter shell。

**投毒风险：**
仓库中存在投毒代码的可能性较低。代码主要是用于生成恶意`regsvr32.exe`的loader, 虽然有恶意利用的性质, 但是作者的意图是提供漏洞验证, 且代码本身功能明确，没有发现隐藏的恶意逻辑或者后门。给出的百分比是基于代码的用途进行评估, 主要还是以漏洞验证的思路编写。

**建议：**
用户应尽快升级到Notepad++ 8.8.2或更高版本，并避免从不受信任的来源下载软件。同时，建议使用AppLocker等安全工具来限制可执行文件的运行路径，防止恶意程序在用户可写目录下执行。

**项目地址:** [assad12341/notepad-v8.8.1-LPE-CVE-](https://github.com/assad12341/notepad-v8.8.1-LPE-CVE-)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)