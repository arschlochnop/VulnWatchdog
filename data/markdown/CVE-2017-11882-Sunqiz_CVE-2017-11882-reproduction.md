## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者在当前用户上下文中执行任意代码

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 需要用户打开包含漏洞利用的恶意文档（如 RTF 或 DOC 文件）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882 是一个 Microsoft Office 公式编辑器（EQNEDT32.EXE）中的内存损坏漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。该漏洞存在于公式编辑器处理 MTEF 数据流中的 font 类型记录时，由于未对 font name 的长度进行判断，导致栈缓冲区溢出。

**利用方式：**

1.  攻击者创建一个包含恶意公式对象的 Office 文档（如 RTF 或 DOC 文件）。该公式对象嵌入了特制的 MTEF 数据流，其中包含一个带有过长 font name 的 font 类型记录。
2.  当受害者打开该文档时，Office 会调用 EQNEDT32.EXE 来处理公式对象。
3.  EQNEDT32.EXE 在解析 MTEF 数据流时，会将过长的 font name 复制到栈缓冲区中，导致缓冲区溢出，覆盖返回地址。
4.  攻击者通过控制溢出数据，可以将返回地址修改为指向恶意代码的地址。
5.  当 EQNEDT32.EXE 函数返回时，程序会跳转到攻击者指定的恶意代码处执行，从而实现远程代码执行。

**投毒风险分析：**

虽然漏洞利用代码本身专注于展示漏洞原理和复现过程，但潜在的投毒风险在于：

*   **后门植入：** 攻击者可能在生成的恶意文档中嵌入额外的恶意代码，例如下载器或信息窃取程序。虽然提供的代码没有直接体现，但此类攻击是存在的。

根据搜索结果，此漏洞已被广泛利用于恶意软件分发，例如 Agent Tesla 和其他信息窃取恶意软件。因此，尽管提供的 POC 仅演示了计算器弹窗，但实际威胁场景中可能包含更复杂的恶意负载。

**项目地址:** [Sunqiz/CVE-2017-11882-reproduction](https://github.com/Sunqiz/CVE-2017-11882-reproduction)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)