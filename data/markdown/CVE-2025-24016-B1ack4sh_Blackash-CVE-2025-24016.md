## CVE-2025-24016-Wazuh-RCE

**漏洞编号:** CVE-2025-24016

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Wazuh

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 4.4.0 <= version < 4.9.1

**利用条件:** 需要API访问权限（可能来自受损的dashboard、集群中的Wazuh服务器，甚至某些配置下的受损Agent）

**POC 可用性:** 是，但提供的POC信息不足以验证

**投毒风险:** 1%

## 详情

CVE-2025-24016是Wazuh服务器中的一个反序列化漏洞，影响版本4.4.0到4.9.0。攻击者可以利用此漏洞在服务器上执行任意代码。该漏洞存在于DistributedAPI组件中，该组件使用`as_wazuh_object`反序列化JSON数据。如果攻击者能够注入恶意构造的字典到DAPI请求/响应中，则可以伪造一个未处理的异常(`__unhandled_exc__`)来执行任意Python代码。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且被广泛关注。CISA的Known Exploited Vulnerabilities Catalog也收录了该漏洞。然而，提供的POC代码仅包含一个README.md文件，该文件只提供了漏洞ID，没有任何实际的利用代码。因此，仅凭此POC代码无法验证漏洞的有效性。

**投毒风险：**
由于提供的POC代码只包含一个README.md文件，没有可执行的代码，因此几乎不存在投毒风险。可以判定投毒概率极低,为1%。

**利用方式：**
根据漏洞库信息和搜索结果，漏洞的利用方式如下：

1.  攻击者需要具有Wazuh API的访问权限。这可能通过多种方式实现，例如攻击受损的Wazuh dashboard，控制Wazuh集群中的另一台服务器，或者在某些配置下，控制受损的Agent。
2.  攻击者构造一个包含恶意字典的DAPI请求或响应。
3.  攻击者通过API发送该恶意请求/响应到Wazuh服务器。
4.  Wazuh服务器使用`as_wazuh_object`反序列化该JSON数据。
5.  恶意字典中的特定字段（`__unhandled_exc__`）被触发，导致服务器执行攻击者注入的任意Python代码。

**修复建议：**
建议尽快升级到Wazuh 4.9.1或更高版本，该版本已修复此漏洞。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24016](https://github.com/B1ack4sh/Blackash-CVE-2025-24016)

**漏洞详情:** [CVE-2025-24016](https://nvd.nist.gov/vuln/detail/CVE-2025-24016)