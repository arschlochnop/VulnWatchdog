## CVE-2025-48384 Git config quoting vulnerability

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行/任意文件写入

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互，克隆包含恶意配置的Git仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384是Git中的一个漏洞，当读取配置值时，Git会删除任何尾部的回车符和换行符（CRLF）。当写入配置条目时，带有尾部CR的值不会被引用，导致CR在稍后读取配置时丢失。在初始化子模块时，如果子模块路径包含尾部CR，则读取更改后的路径，导致子模块被检出到错误的位置。如果存在一个符号链接，将更改后的路径指向子模块的hooks目录，并且子模块包含一个可执行的post-checkout hook，则该脚本可能在检出后被意外执行，从而导致任意代码执行。

根据提供的漏洞利用代码，包含一个Exploit脚本和一个README.md文件。Exploit脚本只打印了一段ASCII艺术，并没有任何实际的漏洞利用代码。因此，提供的POC代码**本身**是无效的，仅仅是一个占位符。但漏洞本身是存在的，并且有公开的PoC。

由于提供的POC代码仅仅是ASCII艺术，没有任何恶意代码，因此**不存在投毒风险**。投毒风险概率为0%。

**漏洞利用方式：**

1.  攻击者创建一个恶意的Git仓库，该仓库包含一个子模块。
2.  子模块的路径包含一个尾部CR字符。
3.  仓库中包含一个符号链接，该符号链接将子模块路径指向子模块的hooks目录。
4.  子模块包含一个可执行的post-checkout hook脚本。
5.  受害者克隆该恶意仓库。
6.  Git在处理子模块时，由于CR字符被删除，子模块被检出到错误的位置，并执行了post-checkout hook脚本。
7.  攻击者可以通过post-checkout hook脚本执行任意代码。

**项目地址:** [fluoworite/CVE-2025-48384_sub](https://github.com/fluoworite/CVE-2025-48384_sub)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)