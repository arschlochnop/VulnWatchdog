## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致完全控制受影响的 Drupal 站点

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，又名 Drupalgeddon2，是一个存在于 Drupal 多个子系统中的远程代码执行漏洞。该漏洞源于 Drupal 在处理用户提供的输入时，没有进行充分的验证，攻击者可以通过精心构造的恶意请求，在服务器上执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是一个经过验证的远程代码执行漏洞，并且存在公开可用的利用代码。大量的安全厂商和研究人员对此漏洞进行了分析和验证，证明其有效性。 

**投毒风险分析：**
提供的Python代码是一个网络数据包捕获脚本，主要用于分析网络流量，特别是HTTP流量，并检测其中是否存在CVE-2018-7600漏洞的利用尝试。 

*   **功能：** 该脚本使用 `pyshark` 库捕获网络接口上的数据包，并分析HTTP请求的URI和POST数据。它查找包含特定关键字（如`exec`, `passthru`, `system`等）的请求，这些关键字通常与远程代码执行攻击相关。  该脚本主要用于检测已知的攻击模式，而不是发起攻击。

*   **潜在投毒风险：** 虽然该脚本本身主要是用于流量分析，但仍然存在一些潜在的风险：
    *   **性能影响：** 在高流量环境下，该脚本可能会消耗大量的CPU和内存资源，导致系统性能下降。 这种消耗如果被恶意利用，可以作为一种拒绝服务攻击。
    *   **数据泄露：** 该脚本会捕获网络数据包，其中可能包含敏感信息，例如用户名、密码、API密钥等。 如果脚本的输出被不当存储或泄露，可能会导致数据泄露。
    *   **依赖风险：** `pyshark` 依赖 `tshark`，如果 `tshark` 本身存在安全漏洞，可能会影响该脚本的安全性。
    *  **后门代码：**代码中没有明显的恶意后门代码，但捕获流量到`csv`文件中可能导致信息泄露，如果该文件可以被外部访问，或者被攻击者替换，则存在风险。

**利用方式：**
根据搜索结果和漏洞描述，攻击者可以通过以下方式利用该漏洞：

1.  发送包含恶意代码的特制HTTP请求，恶意代码通常会嵌入到URL参数或POST数据中。
2.  Drupal 的某些子系统（例如节点创建、用户注册等）在处理这些请求时，由于输入验证不足，会将恶意代码传递给PHP的 `eval()` 函数或其他类似函数执行，从而导致远程代码执行。
3.  攻击者可以利用执行的代码在服务器上安装后门、窃取数据或执行其他恶意操作。

综上，该漏洞利用的有效性很高，但提供的POC代码本身更多是流量分析工具，直接投毒风险较低(5%), 但需要注意潜在的性能影响、数据泄露和依赖风险。攻击者主要通过构造恶意 HTTP 请求来触发漏洞。

**项目地址:** [vphnguyen/ANM_CVE-2018-7600](https://github.com/vphnguyen/ANM_CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)