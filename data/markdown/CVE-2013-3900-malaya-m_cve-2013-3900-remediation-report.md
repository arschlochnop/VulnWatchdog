## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Microsoft Windows

**危害等级:** 中危/高危，取决于用户权限，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，包括但不限于Windows 10、Windows Server 2019、Windows 11等 (详见漏洞库信息)

**利用条件:** 需要用户或应用程序运行或安装被篡改过的、但带有有效签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数处理 PE 文件 Authenticode 签名验证的方式中。攻击者可以通过修改已签名可执行文件，利用未验证的部分向文件中添加恶意代码，而不会使签名失效，从而绕过签名验证。该漏洞利用方式主要依赖于篡改PE文件并在其中嵌入恶意代码。提供的漏洞利用代码实际上是一个 remediation report，描述了如何通过修改注册表来缓解此漏洞（启用 `EnableCertPaddingCheck`），而不是实际的利用代码。根据搜索引擎结果，修复方法也是通过设置注册表键值来实现。因此，该代码本身不包含任何投毒代码。漏洞利用方式为：

1.  **攻击者篡改已签名的 PE 文件**：在未验证的部分添加恶意代码。
2.  **诱骗用户运行该文件**：通过各种手段，使用户或应用程序运行或安装被篡改过的PE文件。
3.  **恶意代码执行**：由于签名仍然有效，系统会信任该文件，从而执行其中的恶意代码。

该漏洞的严重性取决于用户的权限。如果用户具有管理员权限，攻击者可以完全控制受影响的系统。

**项目地址:** [malaya-m/cve-2013-3900-remediation-report](https://github.com/malaya-m/cve-2013-3900-remediation-report)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)