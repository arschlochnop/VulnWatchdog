## CVE-2025-31161 CrushFTP 身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** CrushFTP 10 before 10.8.4 and 11 before 11.3.1

**利用条件:** 目标 CrushFTP 服务器可通过 HTTP(S) 访问，且未部署 DMZ 代理实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 是 CrushFTP 中 WebInterface 组件的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过操纵特定的 cookie 和授权标头值来执行管理功能。

**漏洞利用方式:**

1.  **身份验证绕过:** 攻击者通过发送特制的 HTTP 请求，其中包含特定的 cookie 值 (`currentAuth=31If; CrushAuth=1744110584619_p38s3LvsGAfk4GvVu0vWtsEQEv31If`) 和授权标头 (`AWS4-HMAC-SHA256 Credential=crushadmin/`)，来绕过身份验证控制。
2.  **创建管理员账户:**  成功绕过身份验证后，攻击者可以利用用户管理功能创建一个新的管理员账户，从而获得对 CrushFTP 服务器的完全控制权限。

**投毒风险评估：**

虽然提供的漏洞利用代码看起来功能完善，但仍存在一定的投毒风险。具体来说，`requirements.txt` 文件中可能包含恶意依赖项，或者 `cve_2025_31161.py` 脚本本身可能包含隐藏的后门代码，例如数据窃取或远程代码执行功能。此外，截图`https://github.com/user-attachments/assets/c278226c-a5f8-452a-a1e8-96062b226dd7` 存在钓鱼风险,诱导用户点击恶意链接.虽然代码本身的功能是利用漏洞创建管理员用户,并不能直接判断为投毒代码,考虑到github账号创建时间,代码编写质量等原因综合评估投毒风险为10%。

**有效性:**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。多个来源都证实了 CVE-2025-31161 漏洞的存在以及被实际利用的情况。提供的 POC 代码也给出了明确的利用方法，即通过构造特定的 HTTP 请求来绕过身份验证并创建新的管理员账户。但实际利用时，务必对代码进行审计，确保不存在恶意代码。

**项目地址:** [ibrahimsql/CVE-2025-31161](https://github.com/ibrahimsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)