## CVE-2024-23692-Rejetto HFS-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程未授权执行任意代码

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HFS 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过构造特制的HTTP请求，在受影响的系统上执行任意命令。

**有效性评估：**
提供的POC代码（poc.py）通过构造包含恶意命令的HTTP请求，利用模板引擎的缺陷来执行系统命令。该POC使用`curl`命令发送HTTP请求，并解析响应以提取命令执行的结果。从代码结构来看，POC的基本逻辑是正确的，应该能够有效利用该漏洞。

**投毒风险分析：**
POC代码本身主要功能是发送请求并提取回显，没有发现明显的恶意代码。 但是，`Readme.md` 文件中含有韩文，提示用户使用该代码的法律责任由用户承担，且提示该代码仅用于教育目的，这可能暗示作者对潜在的恶意使用行为不负责任。需要注意的是，POC代码利用了powershell执行命令，如果服务器安全配置较弱，存在被滥用的可能。因此存在较小投毒风险，可能性约为10%。

**利用方式：**
1.  攻击者首先需要找到运行着Rejetto HFS 2.3m或更早版本的服务器，并且该服务器对外开放了HTTP服务端口。
2.  然后，攻击者可以使用POC脚本（poc.py），指定目标URL和要执行的命令。
3.  POC脚本会构造一个包含恶意命令的HTTP GET请求，该请求利用了HFS的模板注入漏洞。
4.  HFS服务器在处理该请求时，会将恶意命令传递给底层操作系统执行。
5.  POC脚本会解析服务器的响应，提取命令执行的结果并输出。

**项目地址:** [999gawkboyy/CVE-2024-23692_Exploit](https://github.com/999gawkboyy/CVE-2024-23692_Exploit)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)