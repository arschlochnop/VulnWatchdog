## CVE-2018-15473 - OpenSSH Username Enumeration

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名。

**影响版本:** <= 7.7

**利用条件:** 目标系统运行易受攻击的OpenSSH版本，并且允许未经身份验证的连接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许未经身份验证的攻击者枚举目标系统上的有效用户名。该漏洞源于OpenSSH在处理无效用户身份验证请求时没有延迟 bailout。这意味着攻击者可以通过观察服务器响应时间的差异来区分有效用户名和无效用户名。  

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，此漏洞是有效的。存在公开可用的PoC利用程序，如Exploit-DB上的45233.py。搜索结果也确认了该漏洞的存在以及受影响的OpenSSH版本。

**投毒风险：**

漏洞利用代码（45233.py）主要用于用户名枚举，它通过修改 paramiko 库的行为来观察服务器对不同用户名的响应。代码通过修改`paramiko.auth_handler.AuthHandler._client_handler_table` 和 `paramiko.message.Message.add_boolean`实现漏洞利用，并没有发现明显的恶意代码或后门。
代码中存在多线程处理，socket连接，可能存在资源耗尽的风险，导致拒绝服务，但这不是典型的后门或恶意投毒。
由于脚本修改了 paramiko 库，如果使用不当，可能会影响其他依赖 paramiko 库的应用程序。
综合分析，投毒风险较低，估计约为5%。

**利用方式：**

1.  **安装依赖：** 确保安装了`paramiko` Python库。
2.  **运行PoC脚本：**  使用提供的PoC脚本，指定目标主机名或IP地址，以及用户名或用户名列表。
3.  **分析结果：**  脚本会尝试使用给定的用户名进行身份验证，并根据服务器的响应时间判断用户名是否有效。
4.  **输出：** 脚本可以输出为列表，JSON或CSV格式，有效用户名和无效用户名。

该漏洞的利用不需要任何身份验证，攻击者可以利用此漏洞来构建字典攻击或其他类型的攻击，因为他们可以预先知道哪些用户名是有效的。

**项目地址:** [philippedixon/CVE-2018-15473](https://github.com/philippedixon/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)