## CVE-2017-10271-WebLogic-RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问 T3 协议端口(漏洞库信息描述)。实际利用中，通常是HTTP协议。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个远程代码执行漏洞。攻击者可以通过发送特制的 XML 消息到存在漏洞的 WebLogic Server 实例，利用 T3 协议（漏洞库信息中提及，但实际HTTP应用更广）或 HTTP 协议执行任意代码，从而完全控制服务器。 

根据提供的文件内容：
* `Dockerfile`: 用于构建一个基于 Python 2 的 Alpine Linux 镜像，安装了 `click` 依赖。这表明该 POC 是一个 Python 脚本。
* `LICENSE`: 使用 MIT 许可证，表明该代码是开源的。
* `README.md`: 描述了该代码是一个用于检测 CVE-2017-10271 的 WebLogic honeypot。该蜜罐模拟了 WebLogic 服务器，允许攻击者利用该漏洞尝试执行代码，并报告此类尝试。
* `requirements.txt`: 列出了该 POC 依赖的 Python 包，即 `click`。
* `weblogic_server.py`: 这是该 POC 的主要 Python 脚本。它创建了一个简单的 HTTP 服务器，模拟 WebLogic 服务器的行为。它检查传入的请求是否包含特定的 XML 模式 (`</void>`)，如果包含，则将其识别为 CVE-2017-10271 漏洞的利用尝试并记录下来。

**有效性：**
该代码是一个蜜罐，旨在检测 CVE-2017-10271 的利用尝试，而不是实际利用该漏洞。因此，其有效性在于能否成功模拟易受攻击的 WebLogic 服务器的行为并检测到恶意请求。

**投毒风险：**
该代码的主要目的是创建一个蜜罐，用于检测 CVE-2017-10271 漏洞的利用。虽然不直接包含恶意代码，但是作为蜜罐，可能会记录攻击者的 IP 地址、尝试执行的命令等信息，并将其发送到指定的服务器或日志文件中。 如果攻击者能够控制蜜罐的配置或者获取蜜罐收集的数据，可能会导致信息泄露。蜜罐本身的代码相对简单，依赖的 `click` 库风险较低，故投毒风险较低。

**利用方式：**
CVE-2017-10271 是一个反序列化漏洞，攻击者通过发送恶意的 XML 数据，可以在 WebLogic 服务器上执行任意代码。该 XML 数据通常包含一个序列化的 Java 对象，该对象包含要执行的命令。WebLogic Server 在反序列化该对象时，会执行其中的命令，从而导致远程代码执行。

该漏洞利用的关键在于构造恶意的 XML 数据。攻击者需要了解 WebLogic Server 使用的 XML 反序列化库，并找到可以利用的 Java 类来执行任意代码。常用的利用链包括 `org.springframework.context.support.ClassPathXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`，它们可以从指定的 URL 加载 XML 配置文件，从而执行任意代码。

该蜜罐代码通过检查请求中是否存在 `</void>` 字符串来判断是否存在利用尝试。更复杂的蜜罐可能会模拟反序列化过程，并记录攻击者尝试执行的命令。


**项目地址:** [Cymmetria/weblogic_honeypot](https://github.com/Cymmetria/weblogic_honeypot)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)