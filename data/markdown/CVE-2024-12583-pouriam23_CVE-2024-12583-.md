## CVE-2024-12583-Dynamics 365 Integration-RCE

**漏洞编号:** CVE-2024-12583

**漏洞类型:** 远程代码执行

**影响应用:** Dynamics 365 Integration

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.3.23

**利用条件:** 需要 Contributor 级别或更高权限的 WordPress 账户

**POC 可用性:** 否

**投毒风险:** 10%

## 详情

根据漏洞信息，CVE-2024-12583 是 Dynamics 365 Integration WordPress 插件中存在的 Twig 服务端模板注入漏洞，允许具有 Contributor 权限或更高权限的认证攻击者执行远程代码或读取任意文件。提供的漏洞利用代码是 `docker-compose.yml` 和 `uploads.ini` 文件，用于搭建一个包含 WordPress 和 MySQL 数据库的 Docker 环境，并且修改了上传文件大小的限制。**有效性分析：**提供的代码无法直接利用该漏洞。它只是一个用于搭建WordPress测试环境的docker-compose文件，用于方便测试。虽然增加了上传文件大小的限制，但这与利用服务端模板注入漏洞无关。该漏洞需要构造恶意的 Twig 模板才能触发远程代码执行或任意文件读取。**投毒风险分析：** `docker-compose.yml` 文件本身用于搭建 WordPress 环境，`uploads.ini` 用于配置上传大小限制，没有发现明显的恶意代码。但仍然存在一定的投毒风险（估计10%），攻击者可能在提供的基础环境上做手脚，例如预先安装一些包含后门的插件或者修改 WordPress 核心文件。**利用方式分析：**根据漏洞描述，需要利用 Twig 服务端模板注入。攻击者需要找到插件中使用了 Twig 模板引擎，且未对用户输入进行充分过滤的地方，然后构造包含恶意代码的 Twig 表达式。这些表达式可以执行系统命令，或者读取服务器上的任意文件。例如 `{{system('whoami')}}` 可以执行 `whoami` 命令。由于需要Contributor权限才能利用，一般会是通过wordpress后台进行配置注入或者修改模板文件，最终触发twig模板渲染执行恶意代码。

**项目地址:** [pouriam23/CVE-2024-12583-](https://github.com/pouriam23/CVE-2024-12583-)

**漏洞详情:** [CVE-2024-12583](https://nvd.nist.gov/vuln/detail/CVE-2024-12583)