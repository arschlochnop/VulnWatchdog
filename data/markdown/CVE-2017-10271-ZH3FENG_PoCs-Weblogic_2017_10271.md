## CVE-2017-10271-WebLogic-反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** WebLogic Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2

**利用条件:** 需要网络访问T3协议端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个反序列化漏洞。攻击者可以通过发送特制的XML数据，利用`XMLDecoder`进行反序列化操作，从而执行任意代码。漏洞存在于WLS Security组件中，通过T3协议进行攻击。提供的POC代码是一个简化版的示例，它使用Spring Boot模拟了一个接受POST请求的接口，该接口接收XML数据并使用`XMLDecoder`进行处理。由于`XMLDecoder`可以反序列化任意Java对象，因此攻击者可以在XML数据中构造恶意对象，从而执行任意代码。由于需要攻击者构造恶意的XML数据，而作者可能在代码中提前包含可以执行恶意命令的代码,因此存在一定的投毒风险。虽然主体代码是演示漏洞，但攻击者可以进行修改，添加恶意后门。

**有效性分析：**
POC代码模拟了漏洞触发点，通过向`/index`接口发送包含恶意代码的XML数据即可触发漏洞。

**投毒风险分析：**
该仓库中的投毒风险较低，代码结构清晰，主要演示了漏洞原理。但依然存在作者添加后门的风险，因此评估投毒风险为10%。

**利用方式：**
1.  攻击者构造包含恶意代码的XML数据。
2.  攻击者向WebLogic服务器的`/index`接口发送POST请求，并将XML数据作为请求体。
3.  WebLogic服务器使用`XMLDecoder`反序列化XML数据，执行其中的恶意代码，导致远程代码执行。

**项目地址:** [ZH3FENG/PoCs-Weblogic_2017_10271](https://github.com/ZH3FENG/PoCs-Weblogic_2017_10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)