## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致任意文件读取

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，并且ImageMagick进程具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick 7.1.0-49版本中存在的一个信息泄露漏洞。当ImageMagick解析PNG图像时，恶意构造的PNG文件可能导致ImageMagick读取任意文件内容，并将其嵌入到处理后的图像中，从而造成信息泄露。 

**有效性：**
根据漏洞描述、搜索结果和提供的POC代码来看，此POC代码旨在生成一个包含指定`Profile_Value`的PNG文件，该值会被添加到PNG文件的`profile`文本信息中。虽然POC本身没有直接读取任意文件，但是它构造了一个包含用户控制数据的PNG文件。这个PNG文件如果被有漏洞的ImageMagick版本处理，可能会触发漏洞，导致任意文件读取，进而将文件内容嵌入到输出图像中。因此，POC配合存在漏洞的ImageMagick版本，可以有效验证和利用该漏洞。

**投毒风险：**
提供的POC代码本身看起来没有明显的投毒行为。代码的功能是生成PNG文件并添加文本信息，没有执行任何恶意操作或包含任何恶意代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG文件，其中包含特定格式的`profile`文本信息或其他PNG元数据，以触发ImageMagick的漏洞。
2.  将该PNG文件发送给目标系统，并诱导或迫使目标系统使用ImageMagick处理该PNG文件（例如，通过上传功能、图像处理服务等）。
3.  如果目标系统使用的ImageMagick版本存在漏洞（<=7.1.0-49），并且ImageMagick进程具有读取目标文件的权限，则ImageMagick会读取攻击者指定的文件内容。
4.  ImageMagick将读取到的文件内容嵌入到处理后的图像中（可能作为像素数据或元数据）。
5.  攻击者获取处理后的图像，并从中提取被泄露的文件内容。

**项目地址:** [chairat095/CVE-2022-44268_By_Kyokito](https://github.com/chairat095/CVE-2022-44268_By_Kyokito)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)