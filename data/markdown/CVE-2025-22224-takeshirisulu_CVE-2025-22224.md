## CVE-2025-22224-VMware-TOCTOU漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Race Condition -> Out-of-Bounds Write

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸和宿主机代码执行

**影响版本:** ESXi 7.0/8.0 未修复版本，Workstation 17.6.3 之前版本

**利用条件:** 需要虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22224是一个 VMware ESXi 和 Workstation 中的TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，导致越界写入。利用方式：攻击者需要在虚拟机内具有本地管理员权限。PoC代码通过并发执行两个线程来触发漏洞。Thread A重复触发VM内存在漏洞的系统调用，Thread B尝试在权限检查之后、资源使用之前交换内存区域或文件描述符。这种竞争导致宿主机VMX进程中出现损坏的指针解引用，允许攻击者覆盖敏感结构并提升权限，最终在宿主机上以 root 身份执行任意代码。投毒风险较低，因为利用方式依赖于精确的竞争条件和对VMware内部机制的理解，但仍有可能通过修改下载链接或在PoC代码中添加恶意代码来实现投毒。

**项目地址:** [takeshirisulu/CVE-2025-22224](https://github.com/takeshirisulu/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)