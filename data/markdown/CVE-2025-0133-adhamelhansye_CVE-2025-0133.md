## CVE-2025-0133-PAN-OS-Reflected XSS

**漏洞编号:** CVE-2025-0133

**漏洞类型:** Reflected XSS

**影响应用:** PAN-OS GlobalProtect Gateway/Portal

**危害等级:** 中危，可能导致凭据盗窃和客户端攻击

**影响版本:** PAN-OS 11.2 < 11.2.8, PAN-OS 11.1 < 11.1.11, PAN-OS 10.2 < 10.2.17, PAN-OS 10.1 < 10.2.17

**利用条件:** 需要目标系统启用了GlobalProtect网关或门户功能, 并且用户已认证进入Captive Portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0133是一个存在于Palo Alto Networks PAN-OS的GlobalProtect网关和门户功能中的反射型跨站脚本（XSS）漏洞。攻击者可以通过构造包含恶意JavaScript代码的特殊链接，诱骗已经通过Captive Portal认证的用户点击，从而在用户的浏览器上下文中执行任意JavaScript代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，该漏洞的POC代码**有效**。POC代码演示了如何通过在URL中注入SVG格式的JavaScript代码来触发XSS漏洞。当用户访问包含恶意代码的URL时，JavaScript代码将在用户的浏览器中执行。

**投毒风险：**
分析提供的POC代码和README文件，没有发现任何作者隐藏的恶意代码。提供的代码只是一个简单的XSS Payload，用于验证漏洞的存在。因此，此仓库的投毒风险为**0%**。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，该URL利用了`/ssl-vpn/getconfig.esp`接口的参数`user`。
2.  攻击者通过钓鱼或其他方式，诱骗目标用户点击该URL。
3.  如果目标用户已经通过GlobalProtect Captive Portal认证，当用户点击该URL时，恶意JavaScript代码将在用户的浏览器中执行。
4.  攻击者可以利用执行的JavaScript代码来窃取用户的会话信息、凭据，或者执行其他客户端攻击。

**缓解措施：**
*   升级到受支持的已修复PAN-OS版本。
*   应用威胁防御签名510003和510004（在Applications and Threats内容版本8970中引入）。
*   禁用Clientless VPN（如果未使用）。

**项目地址:** [adhamelhansye/CVE-2025-0133](https://github.com/adhamelhansye/CVE-2025-0133)

**漏洞详情:** [CVE-2025-0133](https://nvd.nist.gov/vuln/detail/CVE-2025-0133)