## CVE-2023-4357-Google Chrome File Access Vulnerability

**漏洞编号:** CVE-2023-4357

**漏洞类型:** File Access Restriction Bypass

**影响应用:** Google Chrome

**危害等级:** 中危，可能允许远程攻击者绕过文件访问限制

**影响版本:** < 116.0.5845.96

**利用条件:** 需要用户访问恶意HTML页面，Chrome版本低于116.0.5845.96

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4357 漏洞是 Google Chrome 中 XML 处理时，由于对不可信输入验证不足导致的文件访问限制绕过漏洞。攻击者可以通过构造恶意的 HTML 页面，诱导用户访问，从而绕过文件访问限制。从提供的漏洞利用代码来看，攻击者尝试利用 XML 外部实体注入 (XXE) 读取目标用户 `~/.ssh/id_rsa` 文件。`cve.php` 脚本首先获取用户的IP地址，操作系统和浏览器信息。然后，它会尝试创建一个包含恶意 XML 内容的文件 `getotherthings.xml`。这个XML文件使用 `file:///home/[username]/.ssh/id_rsa` 试图读取 SSH 私钥。服务器端php脚本最后利用 file_put_content 将受害者信息写入文件,存在一定的恶意行为。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞存在且影响特定版本的 Chrome。提供的漏洞利用代码尝试通过 XXE 读取文件，具备一定的利用可能性。结合github仓库代码来看，存在利用此漏洞的可能性。

**投毒风险：**
提供的PHP代码主要功能是尝试利用XXE漏洞窃取SSH密钥。虽然脚本本身实现了漏洞利用，但也包含一些值得怀疑的行为，例如收集用户信息并写入文件，存在被用作进一步恶意行为的可能性。

风险评估:
1. 漏洞利用代码会尝试读取用户的SSH私钥，如果成功，可能会导致严重的权限提升和远程访问。
2. 代码中包含收集用户信息（IP地址、操作系统、浏览器）的部分，这本身可能被视为一种侵犯隐私的行为，并且收集的信息可能被用于其他恶意目的。
3. `file_put_content` 函数可能被用于在服务器上创建或修改文件，如果配置不当，可能会导致服务器被控制。
4. 脚本缺少适当的输入验证和安全处理，容易受到其他攻击，如代码注入等。


**利用方式：**

1.  攻击者创建一个恶意的 HTML 页面，该页面包含触发 XXE 的 XML 代码。
2.  攻击者诱导用户使用受影响的 Chrome 版本访问该页面。
3.  当 Chrome 解析该页面中的 XML 时，由于输入验证不足，攻击者可以利用 XXE 漏洞尝试读取服务器上的文件，例如 `~/.ssh/id_rsa`。
4.  如果攻击成功，攻击者可以获得用户的 SSH 私钥，从而可以远程访问服务器。

**项目地址:** [passwa11/CVE-2023-4357-APT-Style-exploitation](https://github.com/passwa11/CVE-2023-4357-APT-Style-exploitation)

**漏洞详情:** [CVE-2023-4357](https://nvd.nist.gov/vuln/detail/CVE-2023-4357)