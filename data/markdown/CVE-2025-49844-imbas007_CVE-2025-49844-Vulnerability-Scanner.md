## CVE-2025-49844-Redis Lua Use-After-Free RCE

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务开启Lua脚本支持，并且攻击者需要具有 EVAL 或 EVALSHA 命令的权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49844 是一个 Redis 中的 Use-After-Free 漏洞，存在于 Lua 脚本执行过程中。攻击者可以利用特制的 Lua 脚本操纵垃圾回收器，触发 use-after-free 漏洞，最终可能导致远程代码执行。

**有效性:**

根据漏洞信息和利用代码，该漏洞的利用是有效的。漏洞库信息明确指出该漏洞存在于 Redis 8.2.2 之前的版本中，且 PoC 代码旨在扫描目标 Redis 服务器，检测其版本是否在受影响范围内，并验证 Lua 脚本是否启用，通过模拟漏洞触发条件来验证漏洞是否存在。

**投毒风险:**

提供的 Python 脚本主要功能是检测 Redis 服务器是否存在 CVE-2025-49844 漏洞。虽然脚本本身看起来是无害的，但是代码中存在一些潜在的风险点，因此投毒风险定为1%。例如，如果目标 Redis 服务器是蜜罐或者监控系统，执行该脚本可能会被识别为恶意行为。

**利用方式:**

1.  **漏洞检测:** 使用提供的 Python 脚本扫描目标 Redis 服务器，判断其版本是否在受影响范围内，以及 Lua 脚本是否启用。
2.  **漏洞触发:** 如果目标服务器存在漏洞，攻击者可以构造恶意的 Lua 脚本，操纵垃圾回收器，触发 use-after-free 漏洞。
3.  **远程代码执行:** 成功触发 use-after-free 漏洞后，攻击者可以利用该漏洞执行任意代码，从而完全控制 Redis 服务器。

**项目地址:** [imbas007/CVE-2025-49844-Vulnerability-Scanner](https://github.com/imbas007/CVE-2025-49844-Vulnerability-Scanner)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)