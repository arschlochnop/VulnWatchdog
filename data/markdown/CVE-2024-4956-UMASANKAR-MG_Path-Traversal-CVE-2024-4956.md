## CVE-2024-4956 - Sonatype Nexus Repository 3 - 路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，允许未经身份验证的攻击者读取系统文件

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问目标Nexus Repository Manager 3实例

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

根据CVE-2024-4956的描述，Sonatype Nexus Repository Manager 3存在一个路径遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。该漏洞已在3.68.1版本中修复。

**有效性评估：**

从提供的搜索引擎结果来看，多个来源证实了该漏洞的存在和影响。网页0、1、2、3、5、6、7和8均提到了CVE-2024-4956是一个路径遍历漏洞，允许未经身份验证的攻击者读取系统文件。网页9提供了包含PoC代码的GitHub链接，证明了该漏洞的可利用性。

提供的PoC代码包含几个文件：
* `LICENSE`：MIT许可证。
* `cve/README.md`：漏洞描述、免责声明、PoC视频链接、帮助菜单、作者信息和反馈方式。
* `cve/main.py`：主程序入口，包含命令行参数解析和漏洞利用逻辑。
* `cve/setup.py`：用于打包和安装PoC工具的setup文件。
* `cve/includes/__init__.py`：一个空的初始化文件
* `cve/includes/file.py`：一个文件读取相关的功能，但是代码不完整

从`cve/main.py`的代码结构来看，该脚本接受URL或文件列表作为输入，并调用相应的模块进行漏洞扫描。它使用了`argparse`库来处理命令行参数，并根据参数调用scan.cvescan(args.url,args.output) 或者 file.reader(args.list,args.output)进行后续处理。
虽然file.reader代码不完整，但是结合github上的其他信息可以推测出其基本的功能是发送含有../的请求到目标服务器。

**投毒风险分析：**

初步分析，PoC代码的主要功能是利用路径遍历漏洞读取文件，但存在一定的投毒风险，因为作者UMASANKAR-MG在`README.md`中加入免责声明，可能暗示存在未公开的恶意功能。`setup.py`使用简单的'Path Traversal = cve.main:main' 入口点, 降低了分析的难度.

*   **可疑点：** 免责声明和作者信息可能掩盖真实目的。
*   **风险点：**  `cve/includes/file.py` 代码不完整，可能包含恶意代码，需要进一步检查。`scan.cvescan`函数也需要进一步分析，以确定是否存在恶意行为。

综合评估，存在一定的投毒风险，但风险程度不高，大约为30%。

**利用方式：**

1.  攻击者构造包含路径遍历字符（例如`../`）的恶意URL。
2.  攻击者发送该恶意URL到目标Nexus Repository Manager 3服务器。
3.  服务器未正确验证URL，导致攻击者能够读取任意文件。
4.  攻击者获取敏感信息，例如配置文件、源代码等。

**PoC使用方式：**

从cve/main.py可以看到，主要由两种方式使用这个POC。
1.  `-u/--url`：指定目标URL，用于对单个目标进行扫描
2.  `-l/--list`：指定包含目标URL列表的文件，用于批量扫描
3.  `-o/--output`：指定输出文件名，将扫描结果保存到文件中
4.  `-b/--blog`：打开包含关于该漏洞的更多信息的博客页面

例如：
`python main.py -u http://example.com/ -o output.txt`

**总结：**

CVE-2024-4956是一个高危的路径遍历漏洞，未经身份验证的攻击者可以利用它读取服务器上的任意文件。PoC代码的存在证明了该漏洞的可利用性，但需要注意潜在的投毒风险，使用时应谨慎。

**项目地址:** [UMASANKAR-MG/Path-Traversal-CVE-2024-4956](https://github.com/UMASANKAR-MG/Path-Traversal-CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)