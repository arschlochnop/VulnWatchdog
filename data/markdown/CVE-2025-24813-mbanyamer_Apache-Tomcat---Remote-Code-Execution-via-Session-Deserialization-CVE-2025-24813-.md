## CVE-2025-24813-Apache Tomcat-RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可完全控制服务器

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 默认Servlet开启写入(disabled by default), 支持Partial PUT(默认开启), 使用Tomcat文件Session持久化默认位置，应用包含可用于反序列化的库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过构造包含内部点（例如 file.Name）的文件名，结合启用的默认Servlet写入和部分PUT支持，可能导致远程代码执行和/或信息泄露。POC利用方式如下：

1.  **检查先决条件：** 检查目标Tomcat实例是否满足利用条件：默认Servlet的写入是否开启，Partial PUT是否支持（默认开启），是否使用了基于文件的Session持久化，以及是否包含可利用的反序列化库。
2.  **构造恶意Payload：** 使用 ysoserial 工具生成恶意的序列化 Java Payload，该 Payload 包含要执行的命令。
3.  **上传Payload：** 通过 PUT 请求将Payload上传到Tomcat服务器的Session存储目录。利用路径遍历(../)绕过上传限制，将恶意Session文件上传到 `uploads/../sessions/` 目录下.
4.  **触发反序列化：**  向服务器发送包含特定Session ID的请求，触发Tomcat加载恶意的Session文件，导致反序列化漏洞被触发，执行Payload中的命令。
5. **验证和清理：** 验证命令是否成功执行，并清理上传的恶意Session文件。

**有效性评估：**
根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索结果显示该漏洞已被积极利用。

**投毒风险评估：**
仔细分析了提供的POC代码，没有发现作者有意隐藏的投毒代码。代码逻辑清晰，功能明确，主要是利用ysoserial生成payload，然后通过PUT请求上传，最后触发。



**项目地址:** [mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-](https://github.com/mbanyamer/Apache-Tomcat---Remote-Code-Execution-via-Session-Deserialization-CVE-2025-24813-)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)