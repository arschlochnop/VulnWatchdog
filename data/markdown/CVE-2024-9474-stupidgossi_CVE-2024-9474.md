## CVE-2024-9474 PAN-OS Web管理界面权限提升漏洞

**漏洞编号:** CVE-2024-9474

**漏洞类型:** 权限提升/OS命令注入

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 中危/高危 (取决于管理界面是否暴露在公网)

**影响版本:** PAN-OS 10.1.0到10.1.14-h6, 10.2.0到10.2.12-h2, 11.0.0到11.0.6-h1, 11.1.0到11.1.5-h1, 11.2.0到11.2.4-h1

**利用条件:** 需要PAN-OS管理员账户的Web管理界面访问权限，且管理界面能被访问到。

**POC 可用性:** 是

**投毒风险:** 15%

## 详情

CVE-2024-9474是一个Palo Alto Networks PAN-OS软件中的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。漏洞根源是OS命令注入 (CWE-78)。

**有效性评估:**

根据漏洞库信息和搜索结果，该漏洞已经被积极利用。提供的POC代码（Go语言编写）表明漏洞利用工具已经存在，并可以进行单目标或批量模式的利用。因此，该漏洞的利用具有较高的有效性。

**投毒风险分析:**

分析提供的POC代码文件：`main.go`，`go.mod`，`go.sum` 和 `README.md`.

*   `README.md`: 简单的使用说明,没有风险。
*   `go.mod` 和 `go.sum`:  Go modules 的依赖声明和校验文件，用于管理项目依赖，本身不包含恶意代码，但恶意篡改可能导致引入存在漏洞的依赖。
*   `main.go`：

    仔细分析 `main.go` 代码，发现此代码的功能是，利用PAN-OS软件的权限提升漏洞，允许具有Web管理界面访问权限的PAN-OS管理员以root权限在防火墙上执行操作。此代码主要用户漏洞验证和利用。由于此为漏洞利用代码，所有无法排除代码作者在代码中隐藏恶意代码的可能。虽然未发现明显的恶意行为，但依旧存在一定风险。

综上，代码本身直接包含恶意投毒代码的可能性较低，主要风险在于供应链投毒（篡改依赖）或者利用该漏洞进行恶意活动。因此，投毒风险评估为15%。

**利用方式分析:**

1.  **前提条件:** 攻击者需要拥有PAN-OS Web管理界面的管理员账户凭据，并且管理界面需要能够被访问（可能是内网或公网）。
2.  **漏洞利用:** 攻击者使用POC代码提供的工具，通过Web管理界面发送特制的请求，利用OS命令注入漏洞。
3.  **结果:**  成功利用后，攻击者可以以root权限在PAN-OS设备上执行任意命令，从而完全控制设备。这可能导致配置篡改、数据泄露、拒绝服务等严重后果。

**缓解措施：**

*   尽快升级到已修复的PAN-OS版本。
*   限制Web管理界面的访问，仅允许来自受信任的IP地址访问。
*   实施最小权限原则，避免不必要的管理员账户。
*   加强安全监控，及时发现和响应可疑活动。

**项目地址:** [stupidgossi/CVE-2024-9474](https://github.com/stupidgossi/CVE-2024-9474)

**漏洞详情:** [CVE-2024-9474](https://nvd.nist.gov/vuln/detail/CVE-2024-9474)