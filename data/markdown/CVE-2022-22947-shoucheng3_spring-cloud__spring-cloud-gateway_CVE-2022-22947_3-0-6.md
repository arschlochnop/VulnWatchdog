## CVE-2022-22947-Spring Cloud Gateway-代码注入

**漏洞编号:** CVE-2022-22947

**漏洞类型:** 代码注入

**影响应用:** Spring Cloud Gateway

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Spring cloud gateway versions 3.1.x prior to 3.1.1+, 3.0.x prior to 3.0.7+ and all old and unsupported versions

**利用条件:** Gateway Actuator endpoint is enabled, exposed and unsecured.

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22947 是一个 Spring Cloud Gateway 的代码注入漏洞。当 Gateway Actuator 端点启用、公开且未受保护时，攻击者可以通过构造恶意请求来执行任意远程代码。漏洞利用方式是发送精心设计的 SpEL 表达式到 actuator 端点，导致服务器执行攻击者提供的代码。

**有效性:** 根据漏洞库信息、搜索结果(特别是 rapid7 的博客提到了 Metasploit 模块)，以及CISA KEV, 此漏洞利用是有效的。

**投毒风险:** 提供的漏洞利用代码只是 Apache License 2.0 许可协议，没有实际的漏洞利用代码，因此不存在投毒代码。投毒风险为 0%。

**利用方式:**
1.  目标系统运行 Spring Cloud Gateway 且版本低于 3.1.1 或 3.0.7。
2.  Gateway Actuator 端点必须启用，并且可以通过网络访问。
3.  Actuator 端点必须未进行身份验证或授权保护。
4.  攻击者构造包含恶意 SpEL 表达式的 HTTP 请求，发送到 Actuator 端点。
5.  Spring Cloud Gateway 解析 SpEL 表达式，执行攻击者指定的代码，实现远程代码执行。

**项目地址:** [shoucheng3/spring-cloud__spring-cloud-gateway_CVE-2022-22947_3-0-6](https://github.com/shoucheng3/spring-cloud__spring-cloud-gateway_CVE-2022-22947_3-0-6)

**漏洞详情:** [CVE-2022-22947](https://nvd.nist.gov/vuln/detail/CVE-2022-22947)