## CVE-2024-53677-Apache Struts文件上传路径遍历/RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统开启文件上传功能，并且使用存在漏洞的FileuploadInterceptor。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677是Apache Struts框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数来实现路径遍历，进而上传恶意文件，最终导致远程代码执行。根据漏洞库信息，该漏洞影响2.0.0到6.4.0之前的版本。升级到6.4.0或更高版本，并迁移到新的文件上传机制是主要的修复建议。

搜索引擎结果表明，该漏洞已被广泛讨论，并被认为对使用Apache Struts的企业构成重大威胁。多个来源强调了远程代码执行的潜在风险，并将其与过去的Struts漏洞（例如，Equifax breach）联系起来。利用的难易程度为中等，CVSS评分为9.5。

POC代码提供了一个检测脚本，该脚本尝试通过修改上传文件名来触发路径遍历。它通过设置`top.uploadFileName`参数来实现，并检查服务器响应中是否存在被覆盖的文件名。如果检测到文件名覆盖，则表明目标可能存在漏洞。

**漏洞利用方式：**
1.  攻击者构造包含恶意路径的文件上传请求，例如使用`../../`来尝试写入Web目录之外的文件。
2.  服务器在处理文件上传时，未正确验证或清理上传的文件名或路径。
3.  攻击者成功将恶意文件（例如JSP webshell）上传到服务器的Web可访问目录。
4.  攻击者通过Web浏览器访问上传的恶意文件，从而执行任意代码。

**投毒风险评估：**

代码库中包含一个检测漏洞的脚本和一个简单的上传文件示例。没有发现任何明显的恶意代码，例如反向shell、下载并执行任意程序的代码等。文件上传漏洞本身可能被用于投毒，但提供的脚本本身不包含额外的、作者隐藏的恶意功能。因此，投毒风险评估为0%。

**项目地址:** [TAM-K592/CVE-2024-53677-S2-067](https://github.com/TAM-K592/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)