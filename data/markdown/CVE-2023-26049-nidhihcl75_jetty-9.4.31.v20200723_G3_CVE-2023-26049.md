## CVE-2023-26049 - Eclipse Jetty Cookie Smuggling

**漏洞编号:** CVE-2023-26049

**漏洞类型:** 信息泄露

**影响应用:** Eclipse Jetty

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 9.4.51, >= 10.0.0, < 10.0.14, >= 11.0.0, < 11.0.14, >= 12.0.0.alpha0, < 12.0.0.beta0

**利用条件:** 需要目标系统使用存在漏洞的Jetty版本，并且存在敏感信息存储在cookie中，且存在将包含恶意cookie的特定cookie值渲染到页面的行为。

**POC 可用性:** 是，根据漏洞描述和搜索结果，可以构造POC。

**投毒风险:** 0%

## 详情

CVE-2023-26049是Eclipse Jetty中的一个cookie解析漏洞。当Jetty遇到以双引号`"`开头的cookie值时，它会持续读取cookie字符串，直到遇到下一个双引号，即使在此期间遇到了分号`;`。这导致可以将多个cookie值组合成一个cookie。攻击者可以利用这一点，将敏感的`HttpOnly` cookie（例如`JSESSIONID`）嵌入到另一个cookie中，如果该cookie的值被渲染到页面上，则可能被攻击者窃取。 

**漏洞利用方式：**

1.  **构造恶意Cookie：** 攻击者构造一个包含恶意数据的Cookie，例如：`DISPLAY_LANGUAGE="b; JSESSIONID=sensitive_session_id; c=d"`。这里`JSESSIONID`是攻击者试图窃取的敏感Cookie。
2.  **发送Cookie：** 将构造的恶意Cookie发送到存在漏洞的Jetty服务器。
3.  **服务器解析：** Jetty服务器错误地将整个字符串解析为一个名为`DISPLAY_LANGUAGE`的cookie，其值为`b; JSESSIONID=sensitive_session_id; c=d`。
4.  **信息泄露：** 如果服务器将`DISPLAY_LANGUAGE` cookie的值输出到页面上，攻击者就可以通过查看页面源代码来获取`JSESSIONID`。

**有效性：**

根据漏洞库信息和搜索结果，可以判断该漏洞是真实存在的，并且可以利用。 攻击者只需要发送特制的cookie，服务器如果将包含恶意cookie的特定cookie值渲染到页面，那么攻击就成功了。

**投毒风险：**

提供的代码片段主要是Jetty的贡献指南和Jenkins构建文件，与漏洞利用本身没有直接关系。这些文件看起来是正常的项目文件，**没有发现任何隐藏的恶意代码**。因此，投毒风险评估为0%。

**项目地址:** [nidhihcl75/jetty-9.4.31.v20200723_G3_CVE-2023-26049](https://github.com/nidhihcl75/jetty-9.4.31.v20200723_G3_CVE-2023-26049)

**漏洞详情:** [CVE-2023-26049](https://nvd.nist.gov/vuln/detail/CVE-2023-26049)