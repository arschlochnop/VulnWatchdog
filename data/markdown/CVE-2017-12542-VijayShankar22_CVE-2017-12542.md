## CVE-2017-12542-HP iLO 4-身份验证绕过和代码执行

**漏洞编号:** CVE-2017-12542

**漏洞类型:** 身份验证绕过和代码执行

**影响应用:** HP Integrated Lights-out 4 (iLO 4)

**危害等级:** 高危，允许未经授权的远程访问和控制服务器。

**影响版本:** Prior to 2.53

**利用条件:** 目标服务器运行易受攻击的HP iLO 4固件版本，并且可以网络访问 iLO 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-12542 存在于 HP Integrated Lights-out 4 (iLO 4) 的早期版本中，允许未经身份验证的攻击者绕过身份验证并执行代码。漏洞利用方式是利用特制的 HTTP 请求，绕过身份验证机制，然后通过创建具有管理员权限的新用户来获得对 iLO 接口的完全控制权。提供的 exploit.py 脚本首先检查目标 iLO 服务器是否存在漏洞，然后尝试创建一个新的管理员用户。该脚本通过发送带有特制 'Connection' 头的 GET 请求到 `/rest/v1/AccountService/Accounts` 端点来检测漏洞。如果服务器返回用户帐户列表，则表明存在漏洞。然后，脚本使用 POST 请求和包含新用户名、密码和权限的 JSON 有效负载创建新的管理员用户。投毒风险评估：代码主要逻辑是利用漏洞添加管理员用户，功能明确。检测投毒代码主要从以下几个方面入手：1. 检查是否存在隐藏的网络请求，向外部服务器发送信息；2. 检查是否存在尝试修改或删除系统文件的操作；3. 检查是否存在恶意代码执行的函数调用。经过分析，该脚本可能存在极小的投毒风险，因为攻击者可以在创建用户后执行其他操作，例如安装后门，但这部分代码未直接包含在提供的脚本中。因此，投毒风险评估为 5%。

**项目地址:** [VijayShankar22/CVE-2017-12542](https://github.com/VijayShankar22/CVE-2017-12542)

**漏洞详情:** [CVE-2017-12542](https://nvd.nist.gov/vuln/detail/CVE-2017-12542)