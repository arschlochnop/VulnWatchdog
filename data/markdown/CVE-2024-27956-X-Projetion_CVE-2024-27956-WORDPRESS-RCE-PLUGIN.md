## CVE-2024-27956-WORDPRESS-RCE-PLUGIN

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，允许未经身份验证的攻击者执行任意SQL命令，可能导致数据泄露、权限提升甚至远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标WordPress站点安装了受影响版本的wp-automatic插件，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27956 是 WordPress Automatic 插件 <= 3.92.0 版本中存在的一个未经身份验证的 SQL 注入漏洞。根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以分析如下：

**1. 有效性：**

*   漏洞利用代码提供了一个 `exploit.sh` 脚本，该脚本尝试利用该漏洞创建一个具有管理员权限的新用户（Lutfifakee）。
*   脚本通过构造特定的 SQL 注入 payload，向 `wp-content/plugins/wp-automatic/inc/csv.php` 发送 POST 请求。
*   脚本会验证服务器响应，如果响应包含 "Tampered query" 或 "invalid login" 或 "login required"则认为payload有误,利用失败,如果包含"DATE"字符串，则认为该站点存在漏洞。
*   如果第一个请求成功（创建用户），则脚本会发送第二个请求来授予该用户管理员权限。
*   搜索结果显示该漏洞已经被积极利用，这也佐证了该漏洞利用代码的有效性。

**2. 投毒风险：**

*   查看提供的 `README.md` 和 `exploit.sh` 文件，没有发现任何明显的恶意代码或者后门。
*   该脚本的功能明确，即利用 SQL 注入漏洞在 WordPress 站点上创建一个具有管理员权限的用户，并没有执行其他未声明的操作。
*   `exploit.sh` 中使用 curl 发送请求，虽然存在中间人攻击的风险，但这不是脚本作者引入的投毒。
*   因此，该代码仓库中存在作者隐藏的投毒代码的风险较低， 评估为0%。

**3. 利用方式：**

*   攻击者首先需要找到一个安装了受影响版本的 WordPress Automatic 插件的 WordPress 站点。
*   攻击者需要通过构造恶意的 SQL 语句作为 POST 请求参数 `q` 的值，利用 `csv.php` 文件中的 SQL 注入漏洞执行任意 SQL 命令。
*   利用方式是分两步：
    1.  首先，创建一个新的 WordPress 用户，用户名为 `Lutfifakee`，密码为 `admin`。
    2.  然后，将该用户的角色设置为管理员。
*   成功利用该漏洞后，攻击者可以使用新创建的管理员帐户登录 WordPress 后台，从而完全控制该站点。

**项目地址:** [X-Projetion/CVE-2024-27956-WORDPRESS-RCE-PLUGIN](https://github.com/X-Projetion/CVE-2024-27956-WORDPRESS-RCE-PLUGIN)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)