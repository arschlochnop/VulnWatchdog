## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** Next.js 应用使用了中间件进行权限校验,且受影响版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 中间件的权限校验逻辑中。攻击者可以通过在请求头中设置 `x-middleware-subrequest` 字段为特定值，绕过中间件的权限校验，从而访问受保护的资源。根据漏洞库信息，该漏洞影响多个 Next.js 版本。搜索结果中多个链接也证实了漏洞的存在和利用方式，并指出漏洞是由于不正确处理 `x-middleware-subrequest` 头部造成的。

提供的PoC 代码是一个交互式的漏洞扫描器，它通过尝试不同的 `x-middleware-subrequest` 值来检测目标应用是否存在漏洞。代码的有效性较高，因为它模拟了攻击者利用漏洞的方式。代码中使用了 `requests` 库发送 HTTP 请求，`BeautifulSoup` 库解析 HTML 响应，并根据响应状态码和内容判断是否存在绕过。它还检测了meta refresh跳转和一些关键词来智能判断是否重定向到登陆页面，减少了误报的可能性。

投毒风险分析：PoC 代码主要功能是检测漏洞，虽然代码尝试不同的头部进行测试，但没有发现明显的恶意行为，例如植入后门或篡改数据。代码可能存在的风险点在于，如果目标应用存在其他未知的漏洞，PoC 代码的请求可能会触发这些漏洞。此外，PoC 代码的作者来自 Telegram，虽然不能直接断定存在投毒行为，但需要保持一定的警惕。因此，综合考虑，投毒风险较低，估计为10%。

利用方式总结：攻击者可以通过发送带有特定 `x-middleware-subrequest` 头的 HTTP 请求，绕过 Next.js 中间件的权限校验，访问受保护的资源。攻击的关键在于构造正确的 `x-middleware-subrequest` 值，使其能够被中间件错误地处理，从而跳过权限验证。

**项目地址:** [sagsooz/CVE-2025-29927](https://github.com/sagsooz/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)