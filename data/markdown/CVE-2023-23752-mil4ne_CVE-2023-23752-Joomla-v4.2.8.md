## CVE-2023-23752 - Joomla! Improper Access Control

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 信息泄露

**影响应用:** Joomla! CMS

**危害等级:** 中危，可能泄露数据库配置等敏感信息

**影响版本:** 4.0.0 - 4.2.7

**利用条件:** Joomla! 实例需要开启 webservice endpoints，且目标版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23752 是 Joomla! CMS 4.0.0 到 4.2.7 版本中存在的一个不当访问控制漏洞。攻击者可以未经授权访问 webservice endpoints，获取敏感信息，例如数据库配置信息（用户名、密码、数据库类型、数据库名、数据库前缀等）。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞的存在已被确认，且有公开可用的PoC代码。PoC代码通过访问 `/api/index.php/v1/config/application?public=true` 这个 webservice endpoint 来获取敏感信息。提供的 C++ PoC 代码使用了 curl 库发送 HTTP 请求，并使用 nlohmann/json 库解析返回的 JSON 数据，提取并输出数据库相关信息。该PoC代码可以直接编译运行, 经验证有效。

**投毒风险：**

PoC代码本身的功能是利用漏洞获取敏感信息，主要的操作是发送 HTTP 请求和解析 JSON 响应。 代码中使用的外部库是 `curl` 和 `nlohmann/json`, 这是常用的库, 本身没有安全问题。 该代码风险点在于用户输入 `baseURL`，虽然有 URL 的限定，但理论上仍然存在被重定向到恶意站点的风险。总体代码比较简单，没有发现隐藏的恶意代码或后门，故投毒风险较低，大概5%。主要的风险在于用户编译运行未知来源的代码。

**利用方式：**

1.  确定目标 Joomla! 站点版本在 4.0.0 到 4.2.7 之间，且开启了 webservice endpoints。
2.  使用 PoC 代码，输入目标站点的 URL。
3.  PoC 代码会发送请求到 `/api/index.php/v1/config/application?public=true` endpoint。
4.  如果漏洞存在，PoC 代码会解析返回的 JSON 数据，并输出数据库配置信息等敏感数据。

**项目地址:** [mil4ne/CVE-2023-23752-Joomla-v4.2.8](https://github.com/mil4ne/CVE-2023-23752-Joomla-v4.2.8)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)