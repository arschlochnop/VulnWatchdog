## CVE-2021-26855-Microsoft Exchange Server-SSRF

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft Exchange Server 2013 Cumulative Update 21, 2013 Cumulative Update 22, 2013 Cumulative Update 23, 2016 Cumulative Update 8, 2016 Cumulative Update 9, 2016 Cumulative Update 10, 2016 Cumulative Update 11, 2016 Cumulative Update 12, 2016 Cumulative Update 13, 2016 Cumulative Update 14, 2016 Cumulative Update 15, 2016 Cumulative Update 16, 2016 Cumulative Update 17, 2016 Cumulative Update 18, 2016 Cumulative Update 19, 2019 Cumulative Update 1, 2019 Cumulative Update 2, 2019 Cumulative Update 3, 2019 Cumulative Update 4, 2019 Cumulative Update 5, 2019 Cumulative Update 6, 2019 Cumulative Update 7, 2019 Cumulative Update 8

**利用条件:** 需要目标Exchange服务器存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。根据搜索结果和漏洞描述，未经验证的远程攻击者可以利用此漏洞发送任意 HTTP 请求并模拟 Exchange 服务器进行身份验证。该漏洞是 ProxyLogon 攻击链的关键组成部分。提供的POC代码尝试通过 `POST /ecp/poc-2021-26855.js HTTP/1.1` 发送 SOAP 请求，通过修改 `X-BEResource` cookie 绕过身份验证，进而执行其他操作。由于请求的目标是 EWS (Exchange Web Services)，这允许攻击者访问和操作邮箱数据。分析代码中,没有发现作者隐藏的投毒代码。

**利用方式：**

1.  **SSRF 攻击：** 利用 CVE-2021-26855，攻击者可以向 Exchange 服务器发送伪造的 HTTP 请求。
2.  **身份验证绕过：** 通过操纵 `X-BEResource` cookie，攻击者可以绕过身份验证，冒充合法用户。
3.  **邮箱访问：** 一旦成功绕过身份验证，攻击者可以使用 EWS 接口访问和操作邮箱数据，例如读取邮件、联系人等。
4.  **链式利用：** CVE-2021-26855 通常与其他 Exchange 漏洞（如 CVE-2021-26857、CVE-2021-26858、CVE-2021-27065）结合使用，形成 ProxyLogon 攻击链，最终实现远程代码执行。

**项目地址:** [timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt](https://github.com/timb-machine-mirrors/testanull-CVE-2021-26855_read_poc.txt)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)