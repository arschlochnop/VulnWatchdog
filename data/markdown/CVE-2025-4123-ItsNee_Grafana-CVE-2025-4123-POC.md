## CVE-2025-4123-Grafana-XSS和SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) 和服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账户接管、敏感信息泄露、远程代码执行（通过SSRF）

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互（点击恶意链接），匿名访问需要开启，Grafana Image Renderer插件需安装才能利用SSRF

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4123 是 Grafana 中的一个高危漏洞，它结合了客户端路径遍历和开放重定向。这允许攻击者将用户重定向到托管前端插件的网站，该插件将执行任意 JavaScript。 如果启用了匿名访问，则 XSS 将起作用。 如果安装了 Grafana Image Renderer 插件，则可以利用开放重定向来实现完全读取的 SSRF。

**漏洞利用方式：**

1.  **XSS 利用:**
    *   攻击者构造包含恶意路径的 URL，该路径利用客户端路径遍历和开放重定向将用户重定向到攻击者控制的服务器。
    *   攻击者服务器托管包含恶意 JavaScript 代码的前端插件。
    *   当受害者点击恶意链接时，Grafana 会将用户重定向到攻击者服务器。
    *   恶意 JavaScript 代码在受害者的浏览器上下文中执行，允许攻击者窃取 cookie、劫持会话或执行其他恶意操作。

2.  **SSRF 利用（需要 Grafana Image Renderer 插件）：**
    *   攻击者利用开放重定向将 Grafana 服务器重定向到内部资源或外部服务器。
    *   Grafana Image Renderer 插件尝试呈现重定向到的 URL，从而允许攻击者读取内部文件或扫描内部网络。

**POC 代码分析：**

POC代码展示了一个Grafana反射型XSS漏洞的影响，它模拟了用户被重定向到攻击者控制的服务器后的情况。代码本身不执行重定向，而是展示了如果攻击成功，攻击者可以进行的操作，如执行JavaScript、劫持会话、进行钓鱼等。

**投毒风险分析：**

提供的 POC 代码（index.html）主要用于演示 XSS 漏洞的影响，并非直接的漏洞利用代码。 该 HTML 文件本身旨在提醒用户该漏洞的危害。

代码中存在投毒的可能性很低，因为该代码只是一个 HTML 页面，用于展示漏洞的影响。它不包含任何可执行的服务器端代码或恶意脚本。即使它包含了恶意的 javascript, 也只能在前端执行.

**有效性分析：**

POC 展示的是漏洞利用的*结果*，也就是用户被重定向之后会发生什么。这个POC代码证明了如果重定向成功，攻击者能控制用户浏览器并造成危害。它展示了攻击者可以如何利用重定向后的页面来进行攻击，例如，通过 JavaScript 窃取用户凭据或者植入恶意插件。

**项目地址:** [ItsNee/Grafana-CVE-2025-4123-POC](https://github.com/ItsNee/Grafana-CVE-2025-4123-POC)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)