## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** Authorization Bypass

**影响应用:** Next.js

**危害等级:** Critical，未经授权访问敏感信息和功能

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** Next.js 应用使用 middleware 进行权限验证，且未修复此漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。攻击者可以通过发送包含 `x-middleware-subrequest` 头的特制 HTTP 请求绕过身份验证。提供的 POC 代码演示了如何通过 `curl` 命令发送包含该标头的请求来利用此漏洞。

**有效性:**
根据漏洞描述和提供的 POC 代码，可以确定该漏洞利用是有效的。POC 提供了一个简单的步骤来重现该漏洞，即发送带有特定 `x-middleware-subrequest` 头的请求到受保护的页面。

**投毒风险:**
代码仓库中发现潜在投毒代码的可能性估计为 10%。原因是：
  *  `eslint.config.mjs`、`next.config.ts`、`package-lock.json`主要是配置文件，投毒概率较低
  *  `middleware.ts` 文件定义了中间件逻辑，可能存在恶意修改权限验证逻辑的风险。
  *  `README.md`文件提供了如何利用该漏洞的信息，但本身不包含恶意代码。
  *  需要注意的是，POC 本身利用漏洞进行验证，不应将其视为投毒。

**利用方式:**
1.  目标 Next.js 应用必须使用 middleware 进行授权检查。
2.  应用版本必须在受影响的范围内（>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3）。
3.  攻击者构造包含 `x-middleware-subrequest` 头的 HTTP 请求。对于 Next.js 15.x 版本，该header的值需要将 middleware name 重复 5 次以上使用":" 分割。旧版本可能只需一个middleware name。
4.  发送构造的请求到受保护的路由，绕过授权检查。

**项目地址:** [t3tra-dev/cve-2025-29927-demo](https://github.com/t3tra-dev/cve-2025-29927-demo)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)