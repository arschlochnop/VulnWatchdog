## CVE-2018-9995 - TBK DVR身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及多个重命名版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问设备及其视频流

**影响版本:** 受影响的TBK DVR4104和DVR4216设备及重命名版本

**利用条件:** 需要能够通过网络访问DVR设备

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许远程攻击者通过设置 `Cookie: uid=admin` header来绕过身份验证。利用方式如下：

1.  攻击者构造一个HTTP请求，在请求头中包含 `Cookie: uid=admin`。
2.  攻击者发送该请求到目标DVR设备。
3.  DVR设备错误地将攻击者识别为管理员，允许其访问受限功能，如用户列表 (`device.rsp?opt=user&cmd=list`)，并可能控制设备。

**利用方式分析：**

根据漏洞库信息和提供的Python POC代码，利用方式非常直接。POC代码创建了一个带有 `Cookie: uid=admin` 的HTTP请求头，并发送到目标DVR设备。如果设备存在漏洞，则会返回管理员权限的信息，证明绕过身份验证成功。

**有效性评估：**

根据漏洞库信息和提供的POC代码，该漏洞利用的有效性较高。多个来源证实了该漏洞的存在，并且POC代码简单易懂，能够快速验证漏洞。

**投毒风险评估：**

分析提供的Python POC代码 `DVR.py`，该代码的功能是发送一个带有特定Cookie的HTTP请求到指定的DVR设备，用于测试CVE-2018-9995漏洞。代码中没有发现任何可疑的、与漏洞利用无关的操作，例如修改系统文件、执行恶意命令或收集敏感信息等。因此，可以认为该代码不存在投毒风险。投毒风险为0%。

**项目地址:** [A-Alabdoo/CVE-DVr](https://github.com/A-Alabdoo/CVE-DVr)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)