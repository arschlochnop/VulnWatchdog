## CVE-2014-6271-Bash-Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 需要目标系统存在Bash并且可以通过某种方式设置环境变量。常见的攻击场景包括：OpenSSH的ForceCommand、Apache HTTP Server的mod_cgi/mod_cgid、DHCP客户端等。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为“Shellshock”，是GNU Bash中的一个严重漏洞。该漏洞源于Bash处理环境变量中函数定义后尾随字符串的方式存在缺陷，这使得攻击者可以通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果，以及常见利用方式，该漏洞的PoC是有效的。漏洞库信息中列出了多个Expolit-DB的链接,以及许多厂商的确认信息,证明该漏洞的真实性。搜索结果也显示了大量的关于该漏洞的分析和利用案例。提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`，从文件名和路径来看，仅仅是一个README文件，内容只有`# CVE-2014-6271`，没有可执行的代码，但可以作为漏洞存在的标志。

**投毒风险：**
提供的POC代码`/tmp/c7baa98dd966ca6db5937f8832eb7ff6/README.md`的内容非常简单，几乎没有投毒代码的可能性。但是，由于该仓库本身存在于`/tmp`目录下，存在被恶意替换或者植入恶意脚本的可能性，因此具有一定的投毒风险。但是从代码本身来看，投毒风险极低,给出的预估值为10%。

**利用方式：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/bash -c "恶意命令"`。
2.  **触发漏洞：** 将构造的环境变量传递给存在漏洞的Bash实例。这可以通过多种方式实现，例如：
    *   **HTTP请求：** 如果目标系统使用CGI脚本，可以通过修改HTTP请求头（如User-Agent）来设置环境变量。
    *   **SSH：** 如果OpenSSH启用了`ForceCommand`，可以通过设置环境变量来执行命令。
    *   **DHCP：** 某些DHCP客户端在执行脚本时会使用环境变量。
3.  **代码执行：** 当Bash解析包含恶意代码的环境变量时，会执行其中的命令，从而实现远程代码执行。

**总结：**
Shellshock是一个严重的安全漏洞，利用方式简单，影响范围广泛。虽然漏洞本身发布时间较早，但仍然可能存在于未及时更新的系统中。由于PoC的特殊性，直接利用README.md是不可能的，需要配合其他可执行的EXP进行测试。

**项目地址:** [Dilith006/CVE-2014-6271](https://github.com/Dilith006/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)