## CVE-2025-9983 - GALAYOU G2 RTSP 无认证访问

**漏洞编号:** CVE-2025-9983

**漏洞类型:** 信息泄露

**影响应用:** GALAYOU G2

**危害等级:** 高危，未经授权的视频流访问

**影响版本:** 11.100001.01.28

**利用条件:** 目标设备开放554端口且位于同一网络或可被访问的网络

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-9983 漏洞存在于 GALAYOU G2 摄像头中，允许未经身份验证的攻击者访问 RTSP 视频流。漏洞描述表明，即使设置了用户名和密码，也无法阻止未经身份验证的访问。提供的 POC 代码 `CVE-2025-9983_v1.py` 尝试通过一系列常见的 RTSP 路径扫描目标设备，并使用 `ffprobe` 工具检查这些路径是否可以未经身份验证地访问。如果找到可访问的流，脚本将使用 `ffmpeg` 捕获一小段视频。利用方式是：

1.  **扫描 RTSP 流:**  脚本通过扫描常见的 RTSP 路径，例如 `/live/main`、`/stream1` 等，来寻找可用的视频流。
2.  **验证绕过:** 脚本首先尝试无用户名和密码的URL，如果能访问成功，就认为存在漏洞。
3.  **流捕获:**  如果验证成功，则使用 ffmpeg 捕获一小段流视频。

**有效性：** 根据漏洞描述和提供的 POC 代码，可以判断该漏洞利用是有效的，因为它直接针对 RTSP 流的身份验证缺陷。

**投毒风险：** POC代码本身没有发现明显的恶意行为。`check_stream`函数使用subprocess执行外部命令ffprobe检查stream，`capture_stream`函数使用subprocess执行ffmpeg命令捕获stream。subprocess具有一定的安全风险。需要注意license是GPL v3，对于使用者有一定的约束。

投毒风险较低，约为1%。

**项目地址:** [sohaibeb/CVE-2025-9983](https://github.com/sohaibeb/CVE-2025-9983)

**漏洞详情:** [CVE-2025-9983](https://nvd.nist.gov/vuln/detail/CVE-2025-9983)