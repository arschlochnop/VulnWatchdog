## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 目标系统启用IPv6

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2024-38063是一个Windows TCP/IP协议栈中的远程代码执行漏洞，CVSS评分为9.8，属于严重级别。漏洞位于IPv6协议处理中，允许攻击者通过发送特制的IPv6数据包，在目标系统上执行任意代码。受影响的系统包括Windows 10、Windows 11以及Windows Server 2008到2022的多个版本。该漏洞的利用需要目标系统启用IPv6，而IPv6通常是默认启用的。提供的PoC代码是一个Python脚本，利用Scapy库构造并发送恶意IPv6数据包。脚本允许用户指定目标IPv6地址、MAC地址、网络接口以及可选的Shellcode文件。

**有效性评估：**
根据搜索结果和PoC代码，该漏洞是真实存在的，并且存在公开可用的PoC。多个安全厂商已经发布了关于此漏洞的分析和缓解措施，表明该漏洞具有实际的威胁。

**投毒风险评估：**
PoC代码本身主要功能是构造并发送恶意IPv6数据包以触发漏洞，可以根据shellcode参数来执行任意代码，风险在于如果利用了公开可信的shellcode，攻击者可能嵌入恶意代码，例如反向shell、文件上传下载等，执行未授权的操作。PoC代码中包含读取shellcode文件的功能，如果提供的shellcode文件包含恶意代码，则存在潜在的投毒风险。从代码本身来看，作者直接隐藏恶意代码的可能性较低，主要是提供了一个灵活的框架。

**利用方式分析：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者运行PoC代码，指定目标IPv6地址和网络接口。
3.  PoC代码构造并发送包含特定格式的IPv6数据包到目标系统。
4.  目标系统TCP/IP协议栈处理恶意数据包时，触发整数下溢漏洞。
5.  攻击者利用漏洞执行任意代码，实现远程控制。

**项目地址:** [KernelKraze/CVE-2024-38063_PoC](https://github.com/KernelKraze/CVE-2024-38063_PoC)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)