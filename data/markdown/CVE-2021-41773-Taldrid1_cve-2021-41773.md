## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49版本，且存在Alias-like配置，目录未配置'require all denied'，开启CGI脚本支持（RCE利用场景）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用此漏洞，通过构造包含特殊字符的 URL，访问服务器上受限目录之外的文件。

**有效性：**

提供的 Nmap NSE 脚本 `cve-2021-41773.nse` 似乎有效。它通过发送包含路径遍历字符（`/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`）的 HTTP GET 请求来检测漏洞。如果服务器返回状态码 200 并且响应体包含 `/etc/passwd` 文件的内容（`root:x:0:0:root`），则该脚本将报告目标为易受攻击。

搜索引擎结果也表明此漏洞已被积极利用，并且存在公开的 PoC 代码。

**投毒风险：**

在提供的 Nmap NSE 脚本中，没有明显的投毒代码。脚本的主要功能是发送 HTTP 请求并检查响应内容。该脚本允许用户指定扫描的子网范围和输出文件，但这些参数本身不会引入任何恶意行为。脚本通过判断/etc/passwd文件是否存在root账户判断是否漏洞存在，不会造成其他影响。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（例如，`/.%2e/.%2e/.%2e/`）的 URL，试图绕过服务器的路径规范化逻辑，访问受限目录之外的文件。
2.  **信息泄露：** 如果成功，攻击者可以读取服务器上的敏感文件，例如配置文件、源代码或用户数据。
3.  **远程代码执行（可选）：** 如果服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问并执行任意 CGI 脚本，从而实现远程代码执行。这通常需要结合其他漏洞或配置错误。

**优先级排序理由：**

*   **搜索引擎结果：** 提供了关于漏洞是否被利用的背景信息，以及缓解措施的链接。 *   **漏洞利用代码：** 提供了直接验证漏洞的手段，使我们能够评估其有效性。 *   **漏洞库信息：** 提供了漏洞的官方描述，受影响的版本以及参考链接。

**项目地址:** [Taldrid1/cve-2021-41773](https://github.com/Taldrid1/cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)