## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至root

**影响版本:** Android 8.x, 9.0, early 10

**利用条件:** 需要安装恶意本地应用或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，允许从应用程序提升权限到 Linux Kernel。

**有效性：**
根据提供的漏洞库信息和搜索引擎结果，CVE-2019-2215 是一个已知的、被广泛讨论和利用的漏洞。很多安全厂商和研究人员已经对其进行了分析，并提供了利用示例。POC代码的可用性高。

**投毒风险：**
提供的代码仓库是一个exploit lab，旨在引导用户学习如何利用该漏洞。虽然主要目的是学习和实验，但仍然存在一定的投毒风险。 该代码仓库的TODO列表中存在一些未完成的功能,比如syzkaller配置问题和ssh连接问题,可能存在被植入后门的风险. 同时考虑到作者声明这还是一个work in progress 的项目，完整性不高,增加了潜在的风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
利用方式主要涉及以下步骤：
1.  将 Binder 文件描述符添加到 epoll 实例。
2.  调用 BINDER_THREAD_EXIT ioctl，这会释放 binder_thread 对象。
3.  通过 epoll 访问被释放的 binder_thread 对象。
4.  触发 use-after-free 条件，从而可以利用该漏洞进行权限提升。

**项目地址:** [0xbinder/android-kernel-exploitation-lab](https://github.com/0xbinder/android-kernel-exploitation-lab)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)