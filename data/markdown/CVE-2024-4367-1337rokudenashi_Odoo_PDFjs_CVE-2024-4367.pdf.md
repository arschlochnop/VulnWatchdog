## CVE-2024-4367-Firefox-PDF.js-JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** JavaScript执行

**影响应用:** Firefox/Thunderbird (通过PDF.js)

**危害等级:** 高危，可能导致跨站脚本攻击（XSS）和信息泄露

**影响版本:** < Firefox 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户需要打开恶意的PDF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-4367 是 Mozilla PDF.js 中的一个漏洞，由于在处理字体时缺少类型检查，导致攻击者可以在 PDF.js 上下文中执行任意 JavaScript 代码。\n\n**有效性评估：**\n提供的 POC 代码是一个 PDF 文件，它通过构造恶意的 Type1 字体，在 `FontMatrix` 字段中注入 JavaScript 代码 `prompt("1337rokudenashi");`。当 PDF.js 解析该 PDF 文件并处理该字体时，这段 JavaScript 代码会被执行。 根据漏洞库信息和搜索结果，该 POC 代码应该有效，可以触发漏洞。\n\n**投毒风险分析：**\n查看提供的 POC 代码，其中 `prompt("1337rokudenashi");` 这段代码的功能是弹出一个对话框，可以确认POC有效，但本身并没有恶意行为，不属于后门代码。其余的PDF结构代码是漏洞利用的必要组成部分，也没有发现隐藏的恶意代码或后门。 因此，可以认为该 POC 代码不存在投毒风险。\n\n**利用方式分析：**\n1.  **构造恶意 PDF 文件：** 攻击者需要创建一个包含恶意 Type 1 字体的 PDF 文件。关键在于 `FontMatrix` 字段，攻击者在该字段中插入 JavaScript 代码。\n2.  **诱导用户打开 PDF 文件：** 攻击者需要诱使用户使用受影响的 Firefox、Firefox ESR 或 Thunderbird 版本打开该 PDF 文件。\n3.  **执行 JavaScript 代码：** 当用户打开 PDF 文件时，PDF.js 会解析该文件。在处理到恶意 Type 1 字体时，`FontMatrix` 字段中的 JavaScript 代码会被执行。\n4.  **潜在影响：** 成功利用此漏洞后，攻击者可以在用户的浏览器或邮件客户端中执行任意 JavaScript 代码，例如窃取 Cookie、获取敏感信息，甚至执行跨站脚本攻击（XSS）。

**项目地址:** [1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf](https://github.com/1337rokudenashi/Odoo_PDFjs_CVE-2024-4367.pdf)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)