## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要网络访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 是一个 Jenkins 任意文件读取漏洞，由于 Jenkins CLI 命令解析器中的 args4j 库未禁用文件内容替换功能，攻击者可以通过在参数中使用 `@` 符号后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。根据提供的漏洞信息、搜索结果和漏洞利用代码，漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI 使用 args4j 库解析命令行参数。Args4j 库有一个特性，即会将参数中以 `@` 开头的文件路径替换为文件内容。Jenkins 未禁用此特性，导致未授权的攻击者可以通过 CLI 读取服务器上的任意文件。

2.  **利用方式：**
    *   攻击者首先需要获取目标 Jenkins 实例的 URL。
    *   利用漏洞的PoC脚本，通过 `wget` 命令下载 `jenkins-cli.jar` 文件，该文件是与 Jenkins 实例交互的命令行工具。
    *   然后，使用 `java -jar jenkins-cli.jar` 命令，结合 `-s` 参数指定 Jenkins URL，并使用 `connect-node` 命令连接到节点。在 `connect-node` 命令的参数中使用 `@` 符号后跟要读取的文件路径。
    *   例如，要读取 `/etc/passwd` 文件，可以使用命令：`java -jar jenkins-cli.jar -s <Jenkins URL> connect-node '@ /etc/passwd'`。  这里务必注意空格,

3.  **有效性：**  根据提供的 PoC 代码和漏洞描述，该 PoC 代码是有效的，可以利用 CVE-2024-23897 漏洞读取 Jenkins 服务器上的任意文件。

4.  **投毒风险：**  分析 PoC 代码，没有发现作者隐藏的恶意代码。PoC 代码的主要功能是下载 `jenkins-cli.jar` 并利用其 `connect-node` 命令读取指定文件。因此，投毒风险为 0%。

5.  **搜索结果优先级：** 搜索结果显示多个安全厂商和漏洞库都确认了 CVE-2024-23897 漏洞的存在，并提供了相关的分析和缓解措施。CISA KEV 中也包含此漏洞，表明该漏洞已被广泛利用，因此，根据搜索结果，确定该漏洞的风险级别为高危。


**项目地址:** [mil4ne/CVE-2024-23897-Jenkins-4.441](https://github.com/mil4ne/CVE-2024-23897-Jenkins-4.441)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)