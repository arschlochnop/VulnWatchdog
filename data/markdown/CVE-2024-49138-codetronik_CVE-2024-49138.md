## CVE-2024-49138

**漏洞编号:** CVE-2024-49138

**漏洞类型:** 权限提升

**影响应用:** Windows Common Log File System Driver (clfs.sys)

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本和版本号范围详见漏洞库信息

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的POC，该漏洞利用方式如下：

1.  **环境准备：**
    *   下载受影响的Windows版本 (例如 Windows 11 23H2 22621.2428)。
    *   下载相应的累积更新 (例如 KB5033375)。
    *   下载存在漏洞的`clfs.sys`驱动程序。
2.  **系统替换：**
    *   安装Windows和累积更新。
    *   使用`takeown`和`icacls`命令获取`C:\Windows\System32\drivers\clfs.sys`文件的所有权和完全控制权限。
    *   将下载的有漏洞的`clfs.sys`替换系统中的`clfs.sys`文件。
    *   重启系统。
3.  **验证：**
    *   检查替换后的`clfs.sys`文件的哈希值，确保与POC提供的哈希值一致。
4.  **漏洞利用：**
    *   运行`CVE-2024-49138.exe` (POC代码)。

**漏洞利用分析：**

该漏洞是Windows Common Log File System (CLFS) 驱动程序中的权限提升漏洞。通过替换有漏洞的`clfs.sys`文件，攻击者可以在本地利用该漏洞提升权限。

**有效性：**

该POC代码的有效性较高，前提是严格按照说明文档中的步骤进行操作，包括Windows版本、累积更新和`clfs.sys`文件的版本。如果哈希值不匹配，则利用可能失败。

**投毒风险：**

该仓库存在一定投毒风险。主要体现在：

1.  **需要替换系统文件：** POC 要求替换系统关键文件`clfs.sys`，这意味着恶意作者可以修改提供的`clfs.sys`文件，使其包含后门代码。虽然文档中提供了SHA256哈希值供验证，但用户可能忽略验证，或者作者提供虚假哈希值。
2. **CVE-2024-49138.exe来源不明:** 该文件中可能被植入后门

因此，在没有充分的信任和安全审计的情况下，使用该POC存在一定的风险。


**项目地址:** [codetronik/CVE-2024-49138](https://github.com/codetronik/CVE-2024-49138)

**漏洞详情:** [CVE-2024-49138](https://nvd.nist.gov/vuln/detail/CVE-2024-49138)