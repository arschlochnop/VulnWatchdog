## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 5.3-milestone-2 <= version < 15.10.11, 16.0.0-rc-1 <= version < 16.4.1

**利用条件:** 需要目标XWiki实例存在漏洞，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893是XWiki平台中的一个远程代码执行漏洞，存在于SolrSearch宏中。由于输入验证不足，未经身份验证的攻击者可以通过构造恶意的请求，在目标服务器上执行任意Groovy代码。漏洞利用方式如下：

1.  **漏洞原理：** XWiki的SolrSearch宏在处理用户提供的`text`参数时，未能充分过滤和转义，导致可以注入Groovy代码。
2.  **利用步骤：**
    *   攻击者构造包含恶意Groovy代码的URL。
    *   该URL指向XWiki的SolrSearch端点，并使用`text`参数传递恶意代码。
    *   XWiki服务器解析并执行注入的Groovy代码，从而导致远程代码执行。
3.  **POC分析：** 提供的`poc.py`脚本实现以下功能：
    *   首先测试目标是否存在漏洞，通过注入一个简单的Groovy代码片段并检查响应中是否包含预期输出来判断。
    *   如果目标存在漏洞，则提供一个交互式shell，允许攻击者执行任意命令。
    *   `send_payload`函数负责构造包含恶意Groovy代码的URL，并发送请求。
    *   `extract_command_output`函数负责从响应中提取命令执行结果。
4.  **投毒风险：** 代码中主要的风险是利用漏洞本身进行恶意操作，而非代码仓库作者引入恶意代码。代码本身相对简洁，主要功能是利用漏洞。尽管如此，仍然存在小概率风险（10%），例如作者可能在代码逻辑中隐藏了某些特定条件下的后门，或者在后续版本中引入恶意功能。但从目前的代码来看，主要风险还是在于漏洞本身的利用。需要进一步的代码审计和动态分析才能确定是否存在隐藏的投毒代码。

综上，该POC的有效性较高，可以用于验证和利用CVE-2025-24893漏洞。 但依然需要代码审计，来降低安全风险。

**项目地址:** [Kai7788/CVE-2025-24893-RCE-PoC](https://github.com/Kai7788/CVE-2025-24893-RCE-PoC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)