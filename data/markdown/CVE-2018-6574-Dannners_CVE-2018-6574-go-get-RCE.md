## CVE-2018-6574-go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 1.8.7, 1.9.x < 1.9.4, 1.10 pre-releases < 1.10rc2

**利用条件:** 目标系统使用存在漏洞的Go版本，且使用`go get`命令获取包含恶意代码的包

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-6574漏洞允许攻击者在受害者构建源代码时执行任意命令。漏洞根源在于`go get`命令没有正确过滤`-fplugin`和`-plugin`参数，导致可以加载恶意的gcc或clang插件。攻击者可以通过创建一个包含恶意插件的Go包，并诱使受害者使用`go get`命令获取该包来触发漏洞。

**有效性：**
根据提供的漏洞信息和搜索引擎结果，该漏洞确实存在，并且有公开的PoC。

**投毒风险：**
提供的PoC代码本身只是一个简单的示例，用于证明漏洞的存在。它通过CGO调用`printf`函数打印一段文字。代码中使用了`-fplugin=./plugin.so`，这意味着需要同时存在一个名为`plugin.so`的恶意插件才能实现远程命令执行。虽然提供的代码本身不包含恶意行为，但是如果攻击者创建一个包含更复杂恶意逻辑的`plugin.so`，则可能造成严重危害。因此，存在一定的投毒风险。

对仓库投毒风险评估：此代码本身无明显风险，风险点在于配套的plugin.so文件，如果plugin.so存在恶意代码，则存在远程代码执行的风险，因为plugin.so不在代码中，需要依赖外部提供，作者可以在plugin.so加入任意代码，风险最高，因此投毒风险为5%。

**利用方式：**
1.  攻击者创建一个包含恶意gcc或clang插件（`plugin.so`）的Go包。
2.  该插件会在编译时执行攻击者预设的命令。
3.  攻击者将该恶意Go包托管在公开的代码仓库（例如GitHub）或私有服务器上。
4.  攻击者诱使受害者使用`go get`命令获取该恶意Go包。
5.  当受害者构建该Go包时，恶意插件会被加载并执行，从而实现远程命令执行。

根据 pentesterlab 网站的描述，通过托管恶意包诱导用户安装是主要的利用方式。

**项目地址:** [Dannners/CVE-2018-6574-go-get-RCE](https://github.com/Dannners/CVE-2018-6574-go-get-RCE)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)