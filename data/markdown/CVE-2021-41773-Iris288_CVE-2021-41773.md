## CVE-2021-41773 - Apache HTTP Server Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和执行任意代码。

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且存在Alias-like指令配置不当，CGI脚本已启用，且文件系统权限配置不当，未启用'require all denied'。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，由于路径规范化中的更改不当所致。攻击者可以利用此漏洞将 URL 映射到 Alias-like 指令配置目录之外的文件。如果这些目录之外的文件没有受到默认配置 "require all denied" 的保护，这些请求可能会成功。如果还为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者通过构造包含特殊字符（如`.%2e`或`..`）的恶意 URL，绕过服务器的安全检查，访问受限目录之外的文件。
2.  **文件读取：** 成功利用路径遍历后，攻击者可以读取服务器上的任意文件，包括配置文件、源代码等敏感信息。
3.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本，攻击者可以通过上传或修改 CGI 脚本，执行任意系统命令。

**POC代码分析：**

提供的POC代码是一个 Python 脚本，它利用了路径遍历漏洞来实现远程代码执行。

1.  **目标指定：** 脚本接受目标服务器的 IP 地址或域名作为参数。
2.  **命令执行：** 脚本允许用户输入要执行的命令，并通过构造包含路径遍历的 URL 将命令发送到目标服务器。
3.  **CGI利用：** 脚本假设目标服务器存在一个名为 `s3cret-cgi-bin` 的 CGI 目录，并使用该目录来执行命令。通过POST请求发送经过编码的命令，利用了`bin/sh`执行。
4.  **回显结果：** 脚本将目标服务器返回的结果打印到屏幕上。

**有效性分析：**

提供的漏洞信息和搜索结果表明，该漏洞确实存在且已被公开利用。提供的 POC 代码基本符合该漏洞的利用方式，因此可以认为该 POC 代码是有效的。需要满足相应的环境条件（如 Alias 指令配置、CGI 脚本启用、文件权限配置等）

**投毒风险分析：**

检查了提供的 Python 脚本，没有发现任何明显的恶意代码或后门。脚本的功能仅限于利用漏洞执行用户指定的命令。`README.md` 文件也只是对漏洞的简单描述，未包含恶意内容。可以认为该仓库存在投毒代码的风险非常低，风险为0%。

**排序优先级：**
搜索引擎结果提供了漏洞被广泛利用和分析的信息，漏洞利用代码验证了漏洞利用的可行性，漏洞库信息提供了漏洞的基础信息。因此，搜索引擎结果的优先级高于漏洞利用代码，漏洞利用代码的优先级高于漏洞库信息。

**项目地址:** [Iris288/CVE-2021-41773](https://github.com/Iris288/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)