## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且`follow_symlinks=True`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果设置了`follow_symlinks=True`，则可能允许攻击者通过构造包含`../`的URL来访问静态文件根目录之外的文件，从而导致敏感信息泄露。

**有效性：**
提供的PoC代码利用curl工具，通过构造带有多个`../`的URL来尝试访问`/root/root.txt`文件。代码通过检查HTTP响应状态码是否为200来判断漏洞利用是否成功。PoC有效，可以验证漏洞的存在。

**投毒风险：**
分析提供的PoC代码，包括`README.md`、`exploit.py`和`requirements.txt`，没有发现任何明显的投毒代码。代码逻辑清晰，功能明确，主要用于发送包含`../`的请求以进行目录遍历，没有发现执行恶意操作的迹象。脚本只包含打印输出和subprocess调用，没有涉及任何隐藏或潜在的恶意代码。所以，投毒风险为0%。

**利用方式：**
1.  目标服务器使用aiohttp作为Web服务器，并配置了静态文件服务。
2.  静态文件服务的配置中`follow_symlinks=True`。
3.  攻击者构造包含多个`../`的URL，例如`http://localhost:8081/assets/../../../../etc/passwd`。
4.  服务器在处理请求时，由于没有正确验证路径，允许攻击者访问到`/etc/passwd`文件，从而导致敏感信息泄露。

**项目地址:** [Arc4he/CVE-2024-23334-PoC](https://github.com/Arc4he/CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)