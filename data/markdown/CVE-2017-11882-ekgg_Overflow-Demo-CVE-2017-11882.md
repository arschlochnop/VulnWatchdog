## CVE-2017-11882 Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者在当前用户上下文中执行任意代码

**影响版本:** Microsoft Office 2007 SP3, Office 2010 SP2, Office 2013 SP1, Office 2016

**利用条件:** 需要用户打开恶意的Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882是一个Microsoft Office的内存破坏漏洞，存在于Equation Editor中。攻击者可以构造特殊的Office文档，利用EQNEDT32.EXE中的栈缓冲区溢出漏洞执行任意代码。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞是有效的。漏洞库中存在多个利用该漏洞的POC链接，搜索结果也显示该漏洞被广泛利用于恶意软件传播，例如Agent Tesla等。

**投毒风险:**
提供的代码是一个Visual Studio解决方案，包含一个名为`OF-DEMO`的C++项目和一个名为`OF-GUI`的C#项目。`README.md`中描述了如何编译和配置该项目，并禁用了一些安全特性。审查了所有提供的代码文件后，发现该代码本身是一个漏洞演示，旨在通过`strcpy`函数造成缓冲区溢出，模拟CVE-2017-11882的利用。虽然作者提供了禁用安全特性的编译选项（/GS-, /DYNAMICBASE:NO, /NXCOMPAT:NO），但这是为了让演示更容易成功，方便用户理解漏洞原理,没有发现隐藏的恶意代码或后门。然而，由于该POC涉及到禁用安全特性，如果用户在实际环境中直接使用，可能会降低系统的安全性。
因此，我评估的投毒风险为10%，主要来自于用户可能误用该POC，在不了解潜在风险的情况下，禁用安全特性。

**利用方式:**
1.  **构造恶意Office文档:** 攻击者创建一个包含特殊公式的Office文档，该公式利用了Equation Editor的漏洞。
2.  **触发漏洞:** 当用户打开包含恶意公式的Office文档时，Equation Editor（EQNEDT32.EXE）会被调用。
3.  **缓冲区溢出:** 恶意的公式数据会造成EQNEDT32.EXE中的栈缓冲区溢出。
4.  **执行任意代码:** 攻击者通过覆盖返回地址或利用其他内存破坏技术，控制程序的执行流程，从而执行任意代码。

**项目地址:** [ekgg/Overflow-Demo-CVE-2017-11882](https://github.com/ekgg/Overflow-Demo-CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)