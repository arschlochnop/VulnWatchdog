## CVE-2019-0708-BlueKeep

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等

**利用条件:** 目标系统开启远程桌面服务(3389端口)，且未安装相关补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。

**有效性：**

提供的PoC代码（crashpoc.py）旨在触发BlueKeep漏洞，导致目标系统崩溃。从代码结构和逻辑来看，它构建了恶意的RDP数据包并发送到目标服务器的3389端口，从而触发漏洞。根据漏洞库信息和搜索结果，该漏洞利用是可行的。

**投毒风险：**

检查提供的PoC代码，发现其主要功能是发送特定格式的数据包以利用漏洞。代码中存在一些硬编码的值，这些值可能与漏洞利用的成功率有关。作者有可能通过修改这些硬编码参数来降低漏洞利用成功率，但总体上该代码的主要功能是尝试触发漏洞。

投毒风险评估：5%。 原因是该代码主要用于使目标系统崩溃，而不是植入恶意代码。虽然可能存在细微的改动降低利用成功率，但基本功能是触发崩溃，不属于典型的后门或数据窃取行为。

**利用方式：**

1.  **连接目标RDP服务：** 利用PoC脚本，首先建立与目标系统3389端口的连接。
2.  **发送初始RDP协商数据包：**  发送包含RDP协议协商信息的初始数据包。
3.  **建立TLS连接：** 漏洞利用过程包含TLS握手过程.
4.  **发送恶意RDP数据包：**  发送精心构造的恶意RDP数据包，触发Use-After-Free漏洞。
5.  **系统崩溃或执行恶意代码：** 成功利用漏洞可能导致目标系统崩溃（如PoC所示），或者在更复杂的利用场景下，执行攻击者预期的恶意代码。

**项目地址:** [AaronCaiii/CVE-2019-0708-POC](https://github.com/AaronCaiii/CVE-2019-0708-POC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)