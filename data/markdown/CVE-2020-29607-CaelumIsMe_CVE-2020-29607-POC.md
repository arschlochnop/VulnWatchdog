## CVE-2020-29607-Pluck CMS-文件上传绕过导致RCE

**漏洞编号:** CVE-2020-29607

**漏洞类型:** 文件上传绕过

**影响应用:** Pluck CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 4.7.13

**利用条件:** 需要管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-29607 是 Pluck CMS 4.7.13 之前版本中的一个文件上传限制绕过漏洞。攻击者需要具备管理员权限，通过 "manage files" 功能上传恶意文件，从而实现远程代码执行。

**漏洞利用方式：**

1.  **身份验证：** 使用提供的管理员凭据登录 Pluck CMS 后台。
2.  **文件上传：** 利用文件管理功能，上传包含恶意代码的 webshell 文件（例如，`.phar` 文件）。漏洞利用的关键在于绕过文件上传的限制。
3.  **远程代码执行：** 成功上传 webshell 后，通过访问该文件，并利用 GET 参数执行系统命令。

**有效性评估：**

提供的 Python 脚本 `pluck_exploit.py` 实现了上述漏洞利用流程。它首先尝试连接到目标 Pluck CMS 实例，然后使用提供的管理员密码进行身份验证。成功登录后，该脚本会上传一个简单的 PHP webshell（`shell.phar`）。最后，它会打印出访问 webshell 的 URL，攻击者可以通过该 URL 执行任意命令。

根据漏洞描述和 POC 代码，可以判断该漏洞利用的有效性较高，因为该漏洞允许经过身份验证的管理员上传任意文件，进而执行任意代码。

**投毒风险评估：**

尽管此 POC 脚本主要是为了验证漏洞，但仍然存在潜在的投毒风险。在 `pluck_exploit.py` 脚本中，webshell 的内容被硬编码为 `<?php system($_GET['cmd']); ?>`。这是一个非常简单的 webshell，只允许执行 `cmd` 参数中指定的命令。但如果攻击者修改了这个 webshell 的内容，例如，添加下载和执行其他恶意文件的代码，那么该脚本就可以被用来传播恶意软件。例如，可以将webshell修改为从特定URL下载并执行恶意payload,进一步扩大攻击范围和提升攻击复杂度。所以，有一定比例的投毒风险。

此外，虽然作者声明该脚本仅用于教育目的，但如果攻击者在未经授权的情况下使用此脚本攻击目标系统，则可能导致严重的安全问题。

根据POC 代码分析，投毒风险评估为10%。主要考虑点是webshell代码的简易性与可修改性。

**项目地址:** [CaelumIsMe/CVE-2020-29607-POC](https://github.com/CaelumIsMe/CVE-2020-29607-POC)

**漏洞详情:** [CVE-2020-29607](https://nvd.nist.gov/vuln/detail/CVE-2020-29607)