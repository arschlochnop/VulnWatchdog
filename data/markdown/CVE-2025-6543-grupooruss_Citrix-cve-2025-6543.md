## CVE-2025-6543-NetScaler ADC/Gateway-内存溢出

**漏洞编号:** CVE-2025-6543

**漏洞类型:** 内存溢出

**影响应用:** NetScaler ADC/Gateway

**危害等级:** 高危，可导致拒绝服务和控制流劫持

**影响版本:** 14.1 < 47.46, 13.1 < 59.19, 13.1 FIPS and NDcPP < 37.236

**利用条件:** 需要配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6543是一个NetScaler ADC和NetScaler Gateway的内存溢出漏洞。当设备配置为Gateway或AAA虚拟服务器时，攻击者可以通过发送特制的请求来触发内存溢出，可能导致拒绝服务（DoS）或控制流劫持，从而执行任意代码。该漏洞CVSS v4.0评分为9.2，属于严重级别。

**有效性：**
根据搜索结果，该漏洞正在被积极利用，并且Citrix发布了紧急补丁。漏洞利用代码(citrix-cve-2025-6543-check.py)是一个版本检测脚本，它通过SNMP或SSH来确定目标NetScaler ADC/Gateway设备是否受到漏洞影响。该脚本本身不会触发漏洞，只是用于验证漏洞是否存在。因此，漏洞检测脚本是有效的，但不能直接用于漏洞利用。

**投毒风险：**
分析提供的Python脚本 citrix-cve-2025-6543-check.py 和 README.md，脚本的主要目的是检测目标系统是否存在 CVE-2025-6543 漏洞。它通过 SNMP 或 SSH 获取目标系统的版本信息，然后与已知受影响的版本进行比较。脚本本身没有发现明显的恶意代码或后门。但仍存在一定的风险，因为脚本会执行外部命令（snmpget 和 ssh），如果这些命令本身被篡改，或者攻击者能够控制脚本的参数，则可能存在投毒风险。

尽管存在这种风险，但考虑到脚本的功能主要是进行版本检测，并且执行的外部命令相对安全，因此总体投毒风险较低。脚本在设计上遵循了一定的安全最佳实践，例如限制了外部命令的参数，并对输入进行了验证。但是，用户仍然需要谨慎使用该脚本，并确保执行环境的安全性。

综合评估，投毒风险约为5%。

**利用方式：**
根据漏洞信息，该漏洞是一个内存溢出漏洞。攻击者需要发送特制的网络请求到目标NetScaler ADC/Gateway设备，才能触发该漏洞。利用该漏洞可能需要构造特定的payload，溢出缓冲区，并覆盖关键内存区域，如返回地址，以便控制程序流程。由于缺乏完整的漏洞利用代码，具体的利用方式尚不清楚，但通常涉及以下步骤：

1.  **漏洞检测：** 使用版本检测脚本或手动检查设备版本。
2.  **Payload构造：** 构造恶意的网络请求，包含溢出payload。
3.  **漏洞触发：** 将构造好的payload发送到目标设备。
4.  **控制流劫持：** 利用溢出覆盖返回地址，将程序控制权转移到攻击者指定的代码。
5.  **执行恶意代码：** 在目标设备上执行任意代码。

根据描述，此漏洞需要配置为 Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server 才能被利用，所以利用条件较为苛刻。

**项目地址:** [grupooruss/Citrix-cve-2025-6543](https://github.com/grupooruss/Citrix-cve-2025-6543)

**漏洞详情:** [CVE-2025-6543](https://nvd.nist.gov/vuln/detail/CVE-2025-6543)