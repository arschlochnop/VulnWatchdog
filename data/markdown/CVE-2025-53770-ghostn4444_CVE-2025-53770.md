## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致远程代码执行，完全控制服务器

**影响版本:** 受影响版本：SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition (16.0.0 < Version < 16.0.18526.20508)

**利用条件:** 需要目标SharePoint服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个Microsoft SharePoint Server中的远程代码执行漏洞，原因是未授权的攻击者可以通过网络执行代码，利用了不安全的反序列化。该漏洞CVSS评分为9.8，表明其严重性很高，且已知存在在野利用。

**有效性评估：**
提供的PoC代码有效。首先，利用CVE-2025-53771绕过身份验证（通过操纵Referer头）。其次，利用CVE-2025-53770执行任意代码（通过上传包含恶意序列化数据的.aspx文件）。PoC包含提取MachineKey的代码，然后使用ysoserial.net等工具生成恶意ViewState。

**利用方式：**
1.  **身份验证绕过 (CVE-2025-53771):** 通过向`/layouts/15/ToolPane.aspx`发送POST请求，并设置`Referer: /_layouts/SignOut.aspx`来绕过身份验证。
2.  **上传恶意ASPX文件 (CVE-2025-53770):**  上传包含C#代码的`.aspx`文件，该代码用于读取SharePoint服务器的MachineKey。然后，使用ysoserial.net等工具，利用获取的MachineKey生成恶意的ViewState。
3.  **远程代码执行:**  通过发送包含恶意ViewState的请求，触发反序列化漏洞，执行任意代码。

**投毒风险分析：**
虽然主要目的是展示漏洞，但仍存在一定的投毒风险。PoC中提供了一个提取MachineKey信息的aspx文件。这段代码本身不是恶意代码，但如果攻击者将提取的MachineKey用于其他恶意目的，例如解密或签名数据，则存在潜在的风险。另外，由于使用了base64编码和gzip压缩来隐藏payload，存在隐藏更复杂恶意代码的可能性，因此投毒风险评估为10%。主要因为代码只是为了证明漏洞存在，没有直接植入后门或者恶意行为的代码。

**项目地址:** [ghostn4444/CVE-2025-53770](https://github.com/ghostn4444/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)