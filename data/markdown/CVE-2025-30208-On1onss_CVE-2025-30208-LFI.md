## CVE-2025-30208-Vite-文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:**  < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** 需要Vite dev server 显式暴露到网络(使用 --host 或 server.host 配置选项)且目标应用存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30208是Vite框架中的一个文件读取漏洞，存在于多个版本中。该漏洞允许攻击者通过构造特殊的URL，绕过`server.fs.deny`的限制，读取Vite服务器允许列表之外的任意文件内容。具体而言，通过在URL中添加`?raw??`或`?import&raw??`，可以绕过文件系统限制。

**有效性：**
提供的POC代码看起来是有效的。它通过构造包含`?import&raw??`的URL来利用该漏洞，并尝试读取指定的文件。如果Vite服务器存在漏洞且配置允许从外部访问，该POC应该能够成功读取文件内容。

**投毒风险：**
该仓库存在极低的投毒风险。主要风险点在于，安装依赖项时可能引入恶意包。但是，检查了`CVE-2025-30208.py`的内容，它主要包含漏洞利用的代码，没有发现明显的恶意代码。`LICENSE`是标准的公共领域许可证，`README.md` 包含了漏洞描述，安装和使用说明。因此，投毒风险预估为5%。

**利用方式：**
1.  **确定目标Vite版本：** 确认目标应用程序使用的Vite版本是否在受影响的范围内。
2.  **确认Vite dev server配置：** 漏洞利用需要Vite dev server配置为允许外部访问 (使用 `--host` 或 `server.host` 配置).
3.  **构造恶意URL：** 构造包含`?raw??`或`?import&raw??`的URL，例如`http://target.com/@fs/etc/passwd?import&raw??`。
4.  **发送请求：**  向Vite服务器发送构造的URL请求。
5.  **读取文件内容：**  如果服务器存在漏洞，则会返回请求的文件内容。

**项目地址:** [On1onss/CVE-2025-30208-LFI](https://github.com/On1onss/CVE-2025-30208-LFI)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)