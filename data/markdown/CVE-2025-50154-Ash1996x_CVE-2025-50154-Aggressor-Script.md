## CVE-2025-50154-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-50154

**漏洞类型:** 信息泄露/NTLM Hash Extraction

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本众多，详见漏洞库信息

**利用条件:** 需要攻击者能够诱使用户访问恶意构造的LNK文件或Library-MS文件，并确保目标系统可以访问攻击者的SMB服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-50154 是一个 Windows 文件资源管理器欺骗漏洞，攻击者可以通过构造恶意的 LNK 文件或 Library-MS 文件，诱使用户访问，从而在用户不知情的情况下触发 NTLM 身份验证，并将 NTLM 哈希发送到攻击者控制的 SMB 服务器。攻击者可以利用收集到的 NTLM 哈希进行进一步的攻击，例如离线破解密码或进行中继攻击。

**有效性分析：**

根据搜索结果，此漏洞在发布后不久就被发现存在绕过补丁的方法，可以通过精心设计的请求触发 NTLM 身份验证，并泄露敏感凭据。漏洞利用代码（LNK Weaponizer v2.0）提供了一种自动化生成恶意 LNK 和 Library-MS 文件的工具，可以简化漏洞利用过程，并支持 Cobalt Strike 集成，进一步提高利用效率。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

LNK Weaponizer v2.0 本身是一个红队工具，用于渗透测试和漏洞利用。虽然工具本身可能不包含恶意代码，但使用该工具生成的 LNK 文件或 Library-MS 文件本身就是恶意的，用于欺骗用户并窃取 NTLM 哈希。

仓库中可能存在投毒代码的风险较低，估计为10%。主要是考虑到以下几点：

1.  **工具性质：** 该工具的主要功能是生成恶意文件，本身就带有一定的攻击性。
2.  **潜在后门：** 作者可能在 CNA 脚本中添加后门，例如在特定条件下执行恶意代码，或者将收集到的 NTLM 哈希发送到指定的服务器。但这些后门主要服务于攻击，并不能算作严格意义上的投毒。
3.  **社工攻击：** 攻击者可能会通过伪装成正常用户，诱骗其他用户下载并使用被篡改的 LNK Weaponizer，从而实现投毒攻击。但这种风险与工具本身无关。

**利用方式：**

1.  **环境搭建：** 攻击者需要搭建一个 SMB 服务器（例如使用 Responder 或 Metasploit），用于捕获 NTLM 哈希。
2.  **生成恶意文件：** 使用 LNK Weaponizer v2.0 生成恶意的 LNK 文件或 Library-MS 文件。攻击者可以通过命令行或 Cobalt Strike 界面指定文件路径、SMB 服务器 IP 地址和共享名。
3.  **传播恶意文件：** 攻击者需要将生成的恶意文件传播给目标用户。常用的方法包括：
    *   **鱼叉式网络钓鱼：** 将恶意文件作为附件发送给特定目标。
    *   **水坑攻击：** 将恶意文件上传到目标用户经常访问的网站。
    *   **社交工程：** 诱骗用户从共享目录或网络位置下载恶意文件。
4.  **捕获 NTLM 哈希：** 当用户点击恶意的 LNK 文件或 Library-MS 文件时，Windows 文件资源管理器会尝试连接到攻击者控制的 SMB 服务器进行身份验证，并将 NTLM 哈希发送到服务器。
5.  **利用 NTLM 哈希：** 攻击者可以使用捕获到的 NTLM 哈希进行进一步的攻击，例如：
    *   **离线破解密码：** 使用 John the Ripper 或 Hashcat 等工具离线破解 NTLM 哈希，获取用户的明文密码。
    *   **NTLM 中继攻击：** 将 NTLM 哈希中继到其他服务或系统，冒充用户进行身份验证。

**项目地址:** [Ash1996x/CVE-2025-50154-Aggressor-Script](https://github.com/Ash1996x/CVE-2025-50154-Aggressor-Script)

**漏洞详情:** [CVE-2025-50154](https://nvd.nist.gov/vuln/detail/CVE-2025-50154)