## CVE-2020-3452 Cisco ASA/FTD Read-Only Path Traversal

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA 和 Firepower Threat Defense (FTD) 软件

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 受影响版本小于 9.6.4.42, 9.8.4.20, 9.9.2.74, 9.10.1.42, 9.13.1.10, 9.14.1.10

**利用条件:** 目标设备启用 WebVPN 或 AnyConnect 功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-3452 是 Cisco ASA 和 FTD 软件中的一个只读路径遍历漏洞。未经身份验证的远程攻击者可以通过构造包含目录遍历字符序列的 HTTP 请求，读取目标系统上的敏感文件。漏洞的根源在于设备对 HTTP 请求中 URL 的输入验证不足。成功利用此漏洞可允许攻击者查看目标设备上 Web 服务文件系统中的任意文件。Web 服务文件系统在配置了 WebVPN 或 AnyConnect 功能后启用。该漏洞无法用于获取对 ASA 或 FTD 系统文件或底层操作系统（OS）文件的访问权限。

**利用方式：**
攻击者构造包含`../`序列的恶意HTTP GET请求，发送到受影响的Cisco ASA/FTD设备的Web服务接口。请求的参数`lang`或`name`被用于操纵文件路径。

提供的PoC代码包含两个示例HTTP GET请求：
1.  利用`translation-table`接口：
    ```
    GET /+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../ HTTP/1.1
    ```
2.  利用`oem-customization`接口：
    ```
    GET /+CSCOT+/oem-customization?app=AnyConnect&type=oem&platform=..&resource-type=..&name=%2bCSCOE%2b/portal_inc.lua HTTP/1.1
    ```

**有效性：**
根据漏洞描述和PoC代码，此PoC代码有效，可用于读取特定文件。

**投毒风险：**
该仓库主要是一个漏洞利用的演示，直接的恶意代码（如反弹shell）的可能性较小。PoC本身是用来读取文件的，因此不包含直接的投毒代码。但是，如果被攻击者修改，可能会添加恶意功能。考虑到Github仓库被篡改的可能性，以及PoC代码中可能存在的细微恶意修改，投毒风险评估为10%。

**项目地址:** [murataydemir/CVE-2020-3452](https://github.com/murataydemir/CVE-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)