## CVE-2025-42957 SAP S/4HANA ABAP 代码注入

**漏洞编号:** CVE-2025-42957

**漏洞类型:** ABAP 代码注入

**影响应用:** SAP S/4HANA (Private Cloud or On-Premise)

**危害等级:** 高危，可完全控制系统，导致数据泄露、篡改和拒绝服务

**影响版本:** S4CORE 102, 103, 104, 105, 106, 107, 108

**利用条件:** 需要低权限用户账号，可通过 SAP GUI, RFC 客户端或集成系统进行攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-42957 漏洞存在于 SAP S/4HANA 的 RFC 接口暴露的功能模块中。由于对用户输入参数的验证不足，攻击者可以构造恶意的 RFC 请求，注入任意 ABAP 代码，绕过权限验证并在 SAP 系统上执行。从搜索结果和提供的漏洞利用代码来看，该漏洞利用的有效性极高，多个来源都证实了该漏洞的严重性和可利用性。

**投毒风险分析：**

POC 代码本身是一个 Python 脚本，用于生成和发送恶意的 RFC payload。虽然脚本本身的功能是利用漏洞，但仍然存在潜在的投毒风险，例如：

*   **Payload 篡改：** 脚本可能包含隐藏的逻辑，在生成 payload 时插入额外的恶意代码，例如植入后门、收集系统信息或进行其他未授权操作。虽然从描述上看，POC是为了创建超级用户，但是无法完全保证。需要对`cve-2025-42957.py`脚本进行代码审计确认。
*   **依赖项风险：** 脚本可能依赖于外部库或模块，这些依赖项可能包含漏洞或恶意代码。特别是脚本中使用了`tinyurl.com`短链接，打开后重定向到了一个未知的网盘链接，风险极高。

鉴于以上风险，我们给出10%的投毒风险评估。

**利用方式：**

1.  攻击者需要拥有一个 SAP S/4HANA 系统的低权限用户账号。
2.  攻击者使用提供的 Python 脚本 (`cve-2025-42957.py`)，配置目标 SAP 系统的连接信息（主机、端口、用户名、密码）。
3.  脚本生成恶意的 RFC payload，该 payload 包含要注入的 ABAP 代码。
4.  脚本通过 RFC 协议连接到目标 SAP 系统，并发送恶意 payload。
5.  SAP 系统接收到 payload 后，由于漏洞的存在，会执行 payload 中包含的 ABAP 代码，导致攻击者可以执行任意操作，例如创建超级用户、读取敏感数据、执行操作系统命令等。

总而言之，CVE-2025-42957 是一个非常严重的安全漏洞，利用简单，影响广泛。需要尽快安装 SAP 官方提供的补丁。

**项目地址:** [callinston/CVE-2025-42957](https://github.com/callinston/CVE-2025-42957)

**漏洞详情:** [CVE-2025-42957](https://nvd.nist.gov/vuln/detail/CVE-2025-42957)