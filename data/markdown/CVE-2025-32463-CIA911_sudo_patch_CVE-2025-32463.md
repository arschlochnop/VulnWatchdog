## CVE-2025-32463-Sudo本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 - 1.9.17p1 (不包含1.9.17p1)

**利用条件:** 需要本地用户权限，sudo版本符合漏洞影响范围

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo中的本地权限提升漏洞。攻击者可以利用`--chroot`选项和用户控制的`/etc/nsswitch.conf`文件，绕过权限检查并获得root权限。漏洞影响Sudo 1.9.14到1.9.17p1版本。从搜索结果和漏洞库信息来看，这是一个严重的漏洞，可以被利用来提升本地权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的PoC存在并且有效。多个来源（如Red Hat、NVD、SOC Prime、Wiz、helpnetsecurity等）都确认了该漏洞的存在和严重性。GitHub上也有相关的PoC代码 (kh4sh3i/CVE-2025-32463)，说明该漏洞是可利用的。

**投毒风险：**
提供的漏洞利用代码实际上是一个手动补丁指南，并非直接的exploit。虽然提供了安装build-essential的指令，但总体来说，代码本身进行恶意投毒的可能性较低。风险主要在于用户在执行这些指令时是否完全理解其含义，以及是否从可信的来源获取了这些指令。例如引导用户安装其他恶意的构建工具等，但从提供的代码来看，直接投毒的概率不高，因此投毒风险评估为10%。风险主要集中在用户是否信任该指南，并正确理解和执行其中的命令。

**利用方式：**
1.  攻击者需要拥有本地用户权限。
2.  攻击者创建一个恶意的`/etc/nsswitch.conf`文件。
3.  攻击者使用`sudo`命令，并结合`--chroot`选项，指定包含恶意`/etc/nsswitch.conf`文件的目录。
4.  `sudo`在`chroot`环境下加载恶意的`/etc/nsswitch.conf`，导致权限提升，攻击者获得root权限。

利用的核心在于`--chroot`选项允许`sudo`在指定根目录下运行命令，而如果攻击者能够控制该根目录下的`/etc/nsswitch.conf`，则可以影响名称服务切换的行为，从而达到提权的目的。

**项目地址:** [CIA911/sudo_patch_CVE-2025-32463](https://github.com/CIA911/sudo_patch_CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)