## CVE-2011-2523-vsftpd 2.3.4 Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可远程代码执行

**影响版本:** 2.3.4 downloaded between 20110630 and 20110703

**利用条件:** 目标服务器运行存在后门的vsftpd 2.3.4版本，并且6200端口未被防火墙阻止。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523 是 vsftpd 2.3.4 版本中的一个后门漏洞。该后门在 2011 年 6 月 30 日到 2011 年 7 月 3 日之间提供的版本中被发现。攻击者可以通过发送包含 ":)" 的用户名触发后门，导致服务器在 6200 端口打开一个 shell。 

**有效性：** 根据漏洞信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息、搜索引擎结果和漏洞利用代码都指向相同的漏洞和利用方式。提供的 Python 脚本 `vsftpd_exploit.py` 实现了利用该后门的完整流程。

**投毒风险：** 代码中存在 `signal.signal(signal.SIGINT, handler)`，该函数用于捕获 `SIGINT` 信号（通常是 Ctrl+C），并在接收到信号时执行 `handler` 函数，该函数会打印 "[!] Saliendo..." 并退出程序，正常功能。其余代码逻辑围绕漏洞本身，没有发现明显的恶意代码或后门。
虽然没有直接的投毒代码，但pwntools 库本身可能存在安全问题，这是一个潜在的风险，给予 10% 的投毒可能。

**利用方式：**
1.  **连接FTP服务器：** 脚本首先连接到目标服务器的 FTP 端口（默认 21 端口）。
2.  **发送恶意用户名：** 脚本发送一个包含 ":)" 的恶意用户名（例如，"anonymous:)"）。
3.  **发送任意密码：** 脚本发送一个任意密码，因为后门并不验证密码。
4.  **连接后门端口：** 如果服务器存在漏洞，则会在 6200 端口打开一个 shell。脚本尝试连接到该端口。
5.  **获得交互式Shell：** 成功连接后，脚本将获得一个交互式的 shell，允许攻击者在服务器上执行任意命令。

综上，该漏洞利用代码利用了 vsftpd 2.3.4 版本中的已知后门，具有较高的有效性。投毒风险较低，但需要注意 pwntools 库本身可能存在的风险。

**项目地址:** [Lychi3/vsftpd-backdoor](https://github.com/Lychi3/vsftpd-backdoor)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)