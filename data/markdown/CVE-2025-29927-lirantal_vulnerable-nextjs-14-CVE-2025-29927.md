## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了Next.js中间件进行授权验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927 存在于 Next.js 中，允许攻击者绕过中间件中的授权检查。漏洞利用方式是，通过在请求头中设置 `x-middleware-subrequest` 字段，并重复 `middleware` 字符串，可以欺骗 Next.js 绕过授权。漏洞利用代码中的 `middleware.js` 文件展示了一个简单的授权逻辑，需要 `Authorization` 头为 `my-jwt-token-here`。攻击者可以通过发送带有构造的 `x-middleware-subrequest` 头的请求绕过此检查。对于旧版本的 Next.js，中间件文件名可能不同（例如，`_middleware.js`），因此需要调整 `x-middleware-subrequest` 的值。代码仓库中未发现明显的恶意投毒代码，jsconfig.json，next.config.mjs 和 package-lock.json 都比较常规，README.md 只是漏洞利用说明，middleware.js 本身只是验证中间件绕过的功能，没有发现额外后门，因此判断投毒风险极低，大约为1%。

**项目地址:** [lirantal/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/lirantal/vulnerable-nextjs-14-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)