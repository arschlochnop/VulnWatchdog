## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的进程具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 存在的一个任意文件读取漏洞。当 ImageMagick 解析恶意的 PNG 图片时，攻击者可以嵌入指令，使得 ImageMagick 在处理图片的过程中读取服务器上的任意文件内容，并将这些内容嵌入到输出的图片中。从搜索结果和漏洞库信息来看，该漏洞影响 ImageMagick 7.1.0-49 及之前的版本。漏洞利用代码仅仅是 `LICENSE` 文件，这表示攻击者需要自己构造特殊的PNG图片，利用ImageMagick的解析缺陷来读取文件。因此，提供的 `LICENSE` 文件本身并非漏洞利用代码，而是某个仓库的文件。由于提供的代码片段只包含许可证信息，没有任何恶意代码，因此投毒风险为 0%。利用方式为：攻击者构造一个包含恶意指令的 PNG 图片，当目标系统使用 ImageMagick 处理该图片时，ImageMagick 会读取攻击者指定的文件，并将文件内容嵌入到处理后的图片中，从而实现任意文件读取。

**项目地址:** [adhikara13/CVE-2022-44268-MagiLeak](https://github.com/adhikara13/CVE-2022-44268-MagiLeak)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)