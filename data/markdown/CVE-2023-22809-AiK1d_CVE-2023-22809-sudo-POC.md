## CVE-2023-22809-sudo权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** sudo

**危害等级:** 高危，允许本地攻击者获得root权限

**影响版本:** 1.8.0 到 1.9.12p1

**利用条件:** 用户需要具有使用sudoedit或sudo -e的权限，并且sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 存在于 sudo 1.9.12p2 之前的版本中，sudoedit (或 -e) 功能错误地处理了用户提供的环境变量（SUDO_EDITOR、VISUAL 和 EDITOR）中传递的额外参数，允许本地攻击者将任意条目附加到要处理的文件列表中，导致权限提升。漏洞利用方式是，攻击者可以通过设置恶意的环境变量，例如 EDITOR='vim -- /etc/sudoers'，当使用 sudoedit 编辑文件时，会将 /etc/sudoers 附加到 vim 的命令行参数中，从而允许攻击者以 root 权限编辑 /etc/sudoers 文件。PoC代码首先检查sudo版本是否在受影响的范围内，然后检查当前用户是否具有以root身份运行sudoedit的权限。如果条件满足，PoC会提示用户将包含提权信息的行添加到/etc/sudoers文件中，然后利用漏洞打开sudoers文件。

**项目地址:** [AiK1d/CVE-2023-22809-sudo-POC](https://github.com/AiK1d/CVE-2023-22809-sudo-POC)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)