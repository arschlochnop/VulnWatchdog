## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 6.23

**利用条件:** 用户需要使用WinRAR打开特制的恶意ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本的代码执行漏洞。该漏洞允许攻击者在用户尝试查看ZIP存档中的看似无害的文件时执行任意代码。攻击者通过构造一个包含同名文件和文件夹的恶意ZIP文件，利用WinRAR处理文件路径时的逻辑缺陷，使得文件夹中的恶意可执行文件得以运行。提供的POC代码通过Vagrant自动化部署了一个易受攻击的WinRAR 6.22环境，并向虚拟机桌面添加了一个恶意的rar文件。该rar文件被设计为当用户点击其中的“无害”文件时，执行预先设定的恶意代码。尽管POC的主要目的是演示漏洞，但其中`ChocolateyInstall.ps1`脚本从外部源下载并安装软件包（Chocolatey和WinRAR），存在被篡改从而引入恶意代码的风险，这构成了潜在的投毒风险。虽然这个脚本很常见，但还是存在一定的风险，因此这里给出了10%的投毒风险。

**漏洞利用方式：**

1.  攻击者创建一个恶意的ZIP压缩包，其中包含一个看似无害的文件（例如.jpg），以及一个与该文件同名的文件夹。
2.  该文件夹包含恶意可执行文件，例如.exe或.cmd脚本。
3.  当用户尝试使用WinRAR打开ZIP压缩包并查看“无害”文件时，WinRAR会错误地执行同名文件夹中的恶意可执行文件，从而导致任意代码执行。
4.  攻击者可以利用此漏洞在受害者系统上安装恶意软件、窃取敏感数据或执行其他恶意操作。

**项目地址:** [Nielk74/CVE-2023-38831](https://github.com/Nielk74/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)