## CVE-2017-0143 - Windows SMB 远程代码执行漏洞

**漏洞编号:** CVE-2017-0143

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者能够进行网络访问。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2017-0143 存在于 Windows SMBv1 服务器中，允许未经身份验证的远程攻击者通过发送特制的 SMB 数据包在目标系统上执行任意代码。该漏洞常与 EternalBlue 漏洞利用框架和 DoublePulsar 后门相关联。利用过程一般为：

1.  使用 EternalBlue 漏洞利用框架攻击存在漏洞的 SMBv1 服务。
2.  成功利用后，通常会安装 DoublePulsar 后门，允许后续执行任意代码。
3.  通过 DoublePulsar 执行恶意载荷，例如反向 Shell 或其他恶意软件。

提供的漏洞利用代码（README.md）描述了如何使用 Metasploit 的 `msfvenom` 生成恶意载荷（反向 TCP shell），以及如何利用 `send_and_execute.py` 脚本通过 SMB 协议将该载荷发送到目标系统并执行。 其中提到了使用Docker来避免环境依赖问题.

**投毒风险分析：**

由于该漏洞影响范围广，且利用代码容易被修改以植入恶意载荷，因此存在较高的投毒风险。攻击者可能修改 `send_and_execute.py` 脚本或生成的恶意载荷，从而在受害者系统上执行恶意操作，例如安装勒索软件（如 WannaCry，搜索引擎结果中提到）。 因此，该漏洞如果未经验证，可能存在极大投毒风险。

**项目地址:** [n3rdh4x0r/MS17-010_CVE-2017-0143](https://github.com/n3rdh4x0r/MS17-010_CVE-2017-0143)

**漏洞详情:** [CVE-2017-0143](https://nvd.nist.gov/vuln/detail/CVE-2017-0143)