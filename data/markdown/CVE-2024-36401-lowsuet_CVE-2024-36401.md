## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.x < 2.22.6, 2.23.x < 2.23.6, 2.24.x < 2.24.4, 2.25.x < 2.25.2

**利用条件:** 目标GeoServer实例在受影响版本范围内，且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是一个 GeoServer 中的远程代码执行漏洞，源于 GeoTools 库在处理要素类型属性名称时，不安全地将其传递给 commons-jxpath 库，导致在评估 XPath 表达式时可以执行任意代码。该漏洞影响所有 GeoServer 实例，无需身份验证即可利用。攻击者可以通过构造恶意的 WFS GetPropertyValue 请求，在目标服务器上执行任意命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意 XPath 表达式的 WFS GetPropertyValue 请求。
2.  GeoServer 将属性名称传递给 commons-jxpath 库进行评估。
3.  commons-jxpath 库执行恶意 XPath 表达式，导致远程代码执行。

根据提供的漏洞利用代码，该 POC 使用 Go 语言编写，提供了一个图形化界面，允许用户指定目标 GeoServer URL 和要执行的命令，可以通过设置代理访问目标。该POC 代码通过构造恶意的`wfs:GetPropertyValue`请求，将命令传递给目标服务器执行。代码中使用了 `java.lang.Runtime.getRuntime()` 来执行命令，confirm 该方法是漏洞利用的关键。

**投毒风险分析：**

*   代码中存在网络请求功能，允许从远程服务器获取资源，增加了潜在的投毒风险。
*   代码中存在执行系统命令的功能，如果被篡改，可能被用于执行恶意操作。
*   虽然代码主要功能是利用漏洞，但如果作者植入恶意代码（例如，反弹 Shell 或下载执行恶意程序），则可能在使用者不知情的情况下感染目标系统。

考虑到以上风险，给与10%的投毒风险，请使用者在运行前仔细检查代码逻辑。

**项目地址:** [lowsuet/CVE-2024-36401](https://github.com/lowsuet/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)