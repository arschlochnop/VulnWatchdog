## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露、远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781是一个Citrix ADC和Gateway中的目录遍历漏洞。攻击者可以通过构造恶意的URL，绕过身份验证，读取服务器上的敏感文件，或者执行任意代码。

**有效性分析:**

漏洞库信息显示，CVE-2019-19781存在于多个版本的Citrix ADC和Gateway中，允许目录遍历。搜索结果表明，该漏洞在野外被积极利用，可能导致远程代码执行。Packetstorm Security上提供了相关的利用代码。

**投毒风险分析:**

提供的“漏洞利用代码”实际上是FireEye发布的IOC扫描器，用于检测是否已遭入侵。它本身不是漏洞利用代码，而是用于检测漏洞利用痕迹的工具。因此，将该工具本身视为投毒代码的可能性较低，但也不排除作者在扫描器中加入后门的可能，例如搜集目标系统信息，或者留下可以被利用的漏洞。考虑到FireEye的声誉，这种情况发生的概率较低，但并非完全为0。因此，投毒风险估计为10%。

**利用方式分析:**

根据漏洞库信息和搜索结果，利用方式通常如下：

1.  攻击者发送特制的HTTP请求到Citrix ADC或Gateway服务器。
2.  请求包含目录遍历序列（例如`../`），用于访问受限目录。
3.  服务器错误地处理这些请求，允许攻击者读取或写入服务器上的任意文件。
4.  攻击者可以利用该漏洞读取敏感配置文件、上传恶意脚本或执行其他恶意操作。
5.  攻击者通过写入webshell到web目录，实现RCE。

例如，攻击者可以利用该漏洞读取`/etc/passwd`文件，获取系统用户信息。攻击者也可以上传一个webshell到Web服务器的某个目录下，然后通过Web浏览器访问该webshell，从而在服务器上执行任意命令。

总之，CVE-2019-19781是一个严重的安全漏洞，需要及时修复。

**项目地址:** [citrixgitoff/-ioc-scanner-CVE-2019-19781](https://github.com/citrixgitoff/-ioc-scanner-CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)