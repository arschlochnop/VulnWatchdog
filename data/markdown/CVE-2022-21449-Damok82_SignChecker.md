## CVE-2022-21449-Java ECDSA 签名绕过

**漏洞编号:** CVE-2022-21449

**漏洞类型:** 签名绕过

**影响应用:** Java SE JDK and JRE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，允许未授权的创建、删除或修改关键数据或所有可访问的数据。

**影响版本:** Oracle Java SE: 17.0.2 和 18; Oracle GraalVM Enterprise Edition: 21.3.1 和 22.0.0.2

**利用条件:** 需要目标系统运行受影响的 Java 版本，且通常存在于运行沙盒 Java Web Start 应用程序或沙盒 Java applet 的客户端，这些客户端加载并运行不受信任的代码（例如，来自互联网的代码），并依赖 Java 沙箱进行安全保护。或者利用使用了相关API的Web服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21449 漏洞，又名 "Psychic Signatures"，是一个存在于 Java ECDSA 签名验证算法中的严重漏洞，该漏洞在 Java 15 中引入。攻击者可以通过提供一个特制的、全零的签名来绕过 ECDSA 签名验证。这意味着攻击者可以在没有有效私钥的情况下伪造签名，从而可能导致各种安全问题，如身份验证绕过。提供的 POC 代码 `SignChecker.java` 旨在演示此漏洞，它会生成签名和验证签名，并允许你提供自定义消息和签名进行验证。 根据描述，POC 代码的功能是模拟漏洞利用，用于验证提供的签名在有漏洞的 Java 版本上是否被错误地验证为有效。

**有效性：** 根据搜索结果和 POC 代码描述，该 POC 代码是有效的，可以用于在受影响的 Java 版本上验证 CVE-2022-21449 漏洞。搜索结果中指向 Github 上的 PoC 项目，也佐证了这一点。

**投毒风险：**  分析POC代码内容，没有发现任何潜在的恶意或后门代码，目的是重现和演示漏洞，而不是植入恶意软件。因此，投毒风险很低。即使存在，也可能是一些不明显的隐蔽后门，但从目前的分析来看概率极低，所以风险为0%。

**利用方式：**

1.  **攻击者构造恶意请求/数据：** 攻击者创建一个恶意请求或数据包，其中包含要签名的数据以及一个伪造的全零 ECDSA 签名。
2.  **利用有漏洞的 Java 应用：** 将此请求发送到运行受影响 Java 版本的应用程序。该应用程序必须使用 Java 的 ECDSA 签名验证功能。
3.  **绕过签名验证：** 由于 CVE-2022-21449 漏洞的存在，应用程序会错误地将伪造的全零签名视为有效签名。
4.  **执行未授权操作：** 成功绕过签名验证后，攻击者可以执行未经授权的操作，例如修改数据、提升权限或访问受保护的资源。

**缓解措施：** 将 Java Development Kit (JDK) 升级到至少 17.0.3 或 18.0.1。

**项目地址:** [Damok82/SignChecker](https://github.com/Damok82/SignChecker)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)