## CVE-2025-24071-Windows File Explorer Spoofing

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 中危，可能导致信息泄露和网络欺骗

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统运行受影响的Windows版本，攻击者需要能够通过网络访问目标系统，且目标用户需要解压恶意zip文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以利用此漏洞通过网络共享泄露NTLM哈希。 

**漏洞利用方式：**

1.  攻击者创建一个恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的服务器的网络路径（`\\攻击者IP\shared`）。
2.  攻击者将此`.library-ms`文件打包成ZIP文件。
3.  攻击者诱骗受害者下载并解压此ZIP文件。
4.  当受害者尝试通过文件资源管理器访问ZIP中的`.library-ms`文件时，Windows文件资源管理器会尝试访问`.library-ms`文件中指定的网络路径。
5.  此操作会导致受害者的系统向攻击者的服务器发送NTLM认证请求，其中包含受害者的NTLM哈希。
6.  攻击者可以使用获得的NTLM哈希进行进一步的攻击，例如NTLM中继攻击。

**POC代码分析：**

提供的Java代码用于生成恶意的`.library-ms`文件，并将其打包成ZIP文件。 代码首先要求用户输入文件名和攻击者IP地址。 然后，它创建一个包含指向指定IP地址的网络共享的`.library-ms`文件。 最后，它将此文件打包成名为`exploit.zip`的ZIP文件。

**有效性评估：**

根据漏洞描述和POC代码，此POC利用方式是有效的。 成功利用此漏洞需要用户交互（解压ZIP文件）。

**投毒风险分析：**

代码本身的功能是生成利用CVE-2025-24071漏洞的文件，其主要目的是欺骗用户访问恶意网络共享以泄露NTLM哈希。但是`README.md`文件中提示“不要做违法的事情，仅作为学习用途”。

潜在的投毒风险点：
*   **IP地址硬编码：** 攻击者可能修改代码，将IP地址硬编码到代码中，并伪装成其他有用的工具进行传播。
*   **文件权限：** 攻击者可能在生成的`.library-ms`文件中添加恶意代码，例如设置文件权限，导致用户执行其他操作。

该仓库的投毒风险较低，约为5%。 风险主要来自攻击者可能修改代码以适应其恶意目的。

**排序优先级解释：**

由于搜索引擎结果提供了对漏洞的总体描述和利用场景，因此优先级最高。漏洞利用代码提供了实际操作的细节，但必须结合漏洞描述才能理解其目的。漏洞库信息提供了官方的漏洞描述和受影响的版本，是验证其他信息的基础。

**项目地址:** [shacojx/CVE-2025-24071-Exploit](https://github.com/shacojx/CVE-2025-24071-Exploit)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)