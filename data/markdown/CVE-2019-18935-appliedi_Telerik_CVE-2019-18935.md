## CVE-2019-18935 - Telerik UI for ASP.NET AJAX 反序列化RCE

**漏洞编号:** CVE-2019-18935

**漏洞类型:** 反序列化RCE

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 需要目标系统存在Telerik UI for ASP.NET AJAX，且攻击者需要获取或破解加密密钥（可能通过CVE-2017-11317或CVE-2017-11357）。如果使用了2020.1.114及以后版本，并且采用了默认安全设置，则漏洞被缓解。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18935 是一个存在于 Progress Telerik UI for ASP.NET AJAX (<= 2019.3.1023) 中的 .NET 反序列化漏洞。它位于 RadAsyncUpload 功能中。如果攻击者可以获取或破解加密密钥 (例如，利用 CVE-2017-11317 或 CVE-2017-11357)，则可以利用此漏洞执行远程代码。 从搜索引擎结果和漏洞库信息可以得知，该漏洞被广泛利用，并且CISA KEV收录了该漏洞。

**漏洞利用方式：**

1.  **密钥获取/破解：**  攻击者需要首先获得用于加密 RadAsyncUpload 配置的密钥。这可以通过利用其他漏洞（如 CVE-2017-11317 或 CVE-2017-11357，它们允许攻击者读取配置文件从而获取密钥）或者通过暴力破解来完成（如果密钥强度不足）。
2.  **构造恶意请求：**  使用获得的密钥，攻击者可以构造一个恶意的 RadAsyncUpload 请求，其中包含精心设计的 .NET 对象，该对象在反序列化时会执行任意代码。这个恶意对象通常是一个利用 .NET Framework 中存在的Gadget Chain来执行命令的 Payload. 
3.  **发送恶意请求：**  攻击者将构造好的恶意请求发送到易受攻击的 Telerik UI for ASP.NET AJAX 应用程序。
4.  **远程代码执行：**  服务器在处理 RadAsyncUpload 请求时，会对攻击者提供的恶意对象进行反序列化，从而导致服务器执行攻击者预先设定的任意代码。

**关于POC代码的有效性：**

提供的POC代码包含一个 Python 扫描器 (telerik_rce_scan.py) 和一个 Nmap NSE 脚本 (http-telerik-vuln.nse)。这些工具的目的是检测目标系统是否存在 CVE-2019-18935 漏洞。虽然代码本身没有直接利用漏洞，但它验证了漏洞是否存在，并且依赖其他工具（如 bao7uo 的 RAU_crypto）进行实际的漏洞利用。根据代码的说明和参考资料，这些工具依赖于可以利用此漏洞的先前研究和代码，所以初步判断POC是有效的。

**关于投毒风险的分析：**

*   **Python 扫描器 (telerik_rce_scan.py):** 这个脚本的主要功能是扫描目标是否存在漏洞，通过检测特定的URL路径是否存在以及是否存在相应的组件来判断。投毒的风险较低，因为其目的是检测，而不是直接利用。 *   **Nmap NSE 脚本 (http-telerik-vuln.nse):** 同样，这个脚本也主要是用于检测漏洞是否存在。它通过发送HTTP请求并检查响应来判断。代码中存在调用`http.get`的http请求, 存在潜在的风险,如果作者植入恶意链接或者重定向, 可能会导致信息泄露或者其他安全问题, 初步估计投毒风险为10%。

总体来说，由于POC代码的核心功能是检测漏洞，而不是直接执行恶意操作，因此投毒风险较低。但是，仍然需要仔细审查代码，特别是网络请求部分，以确保没有隐藏的恶意行为，例如重定向到恶意网站或者泄露敏感信息。

**项目地址:** [appliedi/Telerik_CVE-2019-18935](https://github.com/appliedi/Telerik_CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)