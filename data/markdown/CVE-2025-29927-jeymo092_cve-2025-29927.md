## CVE-2025-29927-Next.js Middleware 授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问，数据泄露和权限提升

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 存在于 Next.js 中间件的授权绕过漏洞。攻击者可以通过特定的请求头 (`x-middleware-subrequest`) 来绕过中间件中的身份验证检查，未经授权访问受保护的资源。根据NVD和多个安全博客的信息，该漏洞CVSS评分为9.1，属于高危漏洞。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞确实存在，且影响多个版本的 Next.js。 该漏洞利用代码只有`README.md`文件，表明这是一个空的 POC 仓库，所以提供的POC代码本身无效，仅仅提供一个占位符。

**投毒风险评估：**

由于提供的漏洞利用代码只有 `README.md` 文件，内容是关于漏洞的信息，不包含任何可执行的代码，因此投毒的可能性很低。但是，不能完全排除未来向此仓库添加恶意代码的可能性。因此，投毒风险评估为 5%。

**利用方式分析：**

1.  **漏洞触发：** 漏洞的触发点在于 Next.js 中间件对 `x-middleware-subrequest` 请求头的处理不当。
2.  **攻击步骤：** 攻击者构造包含 `x-middleware-subrequest` 请求头的恶意请求。
3.  **绕过授权：** Next.js 中间件错误地处理或忽略该请求头，导致授权检查被绕过。
4.  **未授权访问：** 攻击者成功访问原本需要授权才能访问的资源，例如管理后台或敏感数据。
5.  **缓解措施：** 漏洞描述中建议，如果无法升级到安全版本，可以阻止包含 `x-middleware-subrequest` 请求头的外部用户请求到达 Next.js 应用程序。

**项目地址:** [jeymo092/cve-2025-29927](https://github.com/jeymo092/cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)