## CVE-2023-21716-Microsoft Word远程代码执行

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括 Microsoft Office 2019, Microsoft Office Online Server, Microsoft Office LTSC 2021, Microsoft Office LTSC for Mac 2021, Microsoft Word 2013 SP1, Microsoft Word 2016, Microsoft SharePoint Server 2019, Microsoft SharePoint Enterprise Server 2013 SP1, Microsoft SharePoint Enterprise Server 2016, Microsoft SharePoint Foundation 2013 SP1, Microsoft SharePoint Server Subscription Edition Language Pack, Microsoft SharePoint Server Subscription Edition, Microsoft Office Web Apps Server 2013 SP1, Microsoft 365 Apps for Enterprise。

**利用条件:** 用户需要打开恶意的RTF文件或在Outlook预览窗格中预览该文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-21716 是一个 Microsoft Word 远程代码执行漏洞，源于程序处理 RTF 文件中的 \fonttbl 控制字的方式。当字体数量超过一定限制（POC表明是32760），会导致堆缓冲区溢出，覆盖返回指令指针（RIP），最终导致程序崩溃，攻击者可以通过构造包含大量字体的恶意 RTF 文件触发此漏洞，实现远程代码执行。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 CVSS 评分高达 9.8，表明其严重性很高。POC 代码的存在也进一步证实了漏洞的可利用性。

**投毒风险：**

查看提供的文件列表`/tmp/98d27f62fcb72a5581b0eca1252f4b44/README.md`，只包含漏洞说明文档，未发现任何后门、木马或恶意脚本。因此，投毒风险较低，估计为 0%。

**利用方式：**

1.  **构造恶意 RTF 文件：** 攻击者需要创建一个特制的 RTF 文件，其中包含一个 \fonttbl 控制字，并在其中定义超过 32760 个字体。
2.  **诱骗用户打开文件：** 攻击者通过电子邮件、网络下载等方式，诱骗目标用户使用 Microsoft Word 打开该 RTF 文件，或者通过Outlook预览窗格。
3.  **触发漏洞：** 当 Microsoft Word 解析该 RTF 文件时，由于字体数量过多，导致 wwlib.dll 中发生堆缓冲区溢出，覆盖返回地址。
4.  **执行恶意代码：**  攻击者可以利用堆溢出覆盖返回地址，将程序执行流程重定向到攻击者预先设定的恶意代码区域，从而实现远程代码执行。

**项目地址:** [RonF98/CVE-2023-21716-POC](https://github.com/RonF98/CVE-2023-21716-POC)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)