## CVE-2025-59246 Azure Entra ID 权限提升漏洞

**漏洞编号:** CVE-2025-59246

**漏洞类型:** 权限提升

**影响应用:** Microsoft Entra ID

**危害等级:** 极高危，可能导致租户完全受损、数据泄露和服务中断

**影响版本:** 所有版本

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-59246 是一个 Azure Entra ID 的权限提升漏洞，该漏洞允许未经身份验证的攻击者获得更高的访问权限。根据漏洞库信息，该漏洞的 CVSS 评分为 9.8，属于严重级别。漏洞类型为 CWE-306，即“关键功能的身份验证缺失”。

**有效性评估：**

提供的 POC 代码描述了一个 Python 脚本，该脚本旨在利用此漏洞将用户提升为全局管理员。它声称能够绕过身份验证检查，并直接通过向遗留 Graph 端点分配角色来提升权限。由于缺少搜索引擎结果，无法直接验证该漏洞的真实性和 POC 代码的有效性。但根据漏洞描述和CVSS评分判断此漏洞存在较高概率。

**投毒风险评估：**

POC 代码通过 `tinyurl.com` 提供下载链接，这本身就存在极大的风险。攻击者可能利用短链接服务隐藏恶意软件或经过篡改的漏洞利用代码。尽管描述中包含了免责声明，并声称该工具仅用于道德的渗透测试，但该风险依然存在。另外，该脚本通过外部链接下载 payload (malicious-plugin.zip), 也可能存在投毒风险。

**利用方式分析：**

利用方式的核心是绕过身份验证，直接调用 Azure Entra ID 的管理接口来提升用户权限。具体的利用步骤包括：

1.  连接到遗留 Graph 端点。
2.  绕过 `/beta/admin/roles/sync` 路径上的身份验证检查。
3.  将 Global Administrator 角色分配给目标用户。
4.  通过检查 HTTP 状态码验证角色分配是否成功。

总体而言，该漏洞的利用方式较为简单，但潜在的危害极大。未授权访问可能导致整个 Azure Entra ID 租户的完全受损。


**项目地址:** [Mpokes/CVE-2025-59246-Exploit](https://github.com/Mpokes/CVE-2025-59246-Exploit)

**漏洞详情:** [CVE-2025-59246](https://nvd.nist.gov/vuln/detail/CVE-2025-59246)