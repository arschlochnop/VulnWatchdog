## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux Kernel

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android内核中的Binder驱动程序中的use-after-free漏洞。攻击者可以通过利用此漏洞，将权限从应用程序提升到Linux内核。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是一个已知的且被广泛利用的漏洞。提供的POC代码包含利用此漏洞来获取root权限并执行Ransomware的完整流程，表明其有效性较高。搜索结果中提及此漏洞已被APT组织利用，进一步验证了其有效性。

**投毒风险：**
虽然该项目声明是为了教育目的，并利用了已知的漏洞利用代码，但仍存在一定的投毒风险。风险分析如下：

*   **README.md**: 仓库的README.md文件声明其目的是用于教育，并且使用已知的漏洞利用和加密代码。但这并不意味着其中没有隐藏的恶意代码。
*   **cve-2019-2215.c**: 这是漏洞利用的核心代码，虽然基于已知的POC，但可能存在细微修改，植入后门或者用于检测目的的代码。
*   **dropper_server.py**:  该脚本用于C2服务器，负责下发payload、获取MasterKey和接收被窃取的数据。恶意代码可能隐藏在此脚本中，用于收集额外信息或执行其他恶意操作。
*   **install.sh和rs.elf**: 这些文件在获得root权限后执行，用于建立反向shell。`rs.elf`是由`msfvenom`生成的，理论上是干净的，但是`install.sh` 脚本可能包含恶意命令，或者使用`rs.elf`建立反向shell后，C2服务器可以执行任意命令。
*   **2048-Game Android Project**: 将漏洞利用和勒索软件嵌入到一个看似无害的游戏中，这种做法本身就是一种伪装。恶意代码可能隐藏在其他游戏逻辑中。

综合以上分析，虽然大部分代码是已知的或可以通过检查来验证，但C2服务器脚本和install.sh存在被植入恶意代码的风险。由于利用过程较为复杂，存在多个可能被隐藏恶意代码的点，因此投毒风险初步估计为10%。这个百分比反应的是存在潜在风险，但不能确定一定存在恶意代码的情况。

**利用方式：**

1.  **安装恶意应用：** 用户需要从Google Play或其他渠道安装包含漏洞利用代码的恶意应用程序。根据搜索结果，存在伪装成正常应用的恶意程序利用此漏洞。
2.  **权限请求：** 应用程序请求必要的权限（例如存储权限）。
3.  **文件加密：** Ransomware会使用AES加密`/sdcard/Pictures` 目录中的所有文件，每个文件使用随机生成的密钥，并将文件路径：密钥保存在`/sdcard/keys.json`。
4.  **C2通信：** 应用程序通过HTTP GET请求 C2 服务器的 `/get_mk` 路由，获得victimID和主密钥，然后使用主密钥加密 `/sdcard/keys.json`，将victimID写入`/sdcard/victimID.txt`。
5.  **漏洞利用：** 应用程序解压`shells.zip`，执行其中的`cve-2019-2215`二进制文件，触发use-after-free漏洞，获得root权限。
6.  **反向Shell：** 利用root权限执行`install.sh`脚本，该脚本会运行`rs.elf`，建立与攻击者服务器的反向shell连接。
7.  **数据窃取：** 应用程序窃取设备的gmail账号、用户信息和联系人，并通过POST请求发送到C2服务器的`/postData`路由。
8.  **勒索：** 用户设备上的文件被加密，攻击者通过反向shell控制设备，或者通过其他方式向用户勒索赎金。

**项目地址:** [nicchongwb/Rootsmart-v2.0](https://github.com/nicchongwb/Rootsmart-v2.0)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)