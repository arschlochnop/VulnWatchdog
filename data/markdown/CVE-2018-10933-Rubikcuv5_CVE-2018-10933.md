## CVE-2018-10933-libssh-身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.7.6, 0.8.4

**利用条件:** 目标系统运行存在漏洞的libssh版本且SSH服务对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-10933是libssh中的一个身份验证绕过漏洞。攻击者可以在未经身份验证的情况下创建通道，从而获得未经授权的访问权限。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞是有效的。PoC代码通过发送`SSH2_MSG_USERAUTH_SUCCESS`消息绕过身份验证，然后执行命令或打开交互式shell。

**投毒风险：**
PoC代码主要包含以下几个文件：
* `README.md`: 包含漏洞描述、利用方法和示例。
* `main.py`: 包含漏洞利用的核心代码。

对`main.py`代码进行分析，代码的功能是利用`paramiko`库连接到目标SSH服务器，然后发送`SSH2_MSG_USERAUTH_SUCCESS`消息绕过身份验证，并执行命令或打开交互式shell。虽然代码本身实现了漏洞利用的功能，但存在潜在的投毒风险。

具体分析如下：

* **依赖项风险：** `requirements.txt` 文件中可能包含恶意或被篡改的依赖项，这些依赖项可能在安装时引入恶意代码。但是从提供的文件看，没有发现特别的依赖库。
* **代码逻辑风险：** 作者可能在代码中隐藏后门，例如收集用户信息、植入恶意程序等。尽管从提供的代码中没有直接发现明显的后门，但不能完全排除这种可能性。 需要进一步进行代码审计,才能确定是否存在更加隐蔽的恶意代码。
* **远程连接风险：** 代码中包含连接远程服务器的功能，如果目标服务器被攻击者控制，可能会被利用进行恶意活动。

综合考虑，PoC代码存在一定的投毒风险，建议在使用前进行详细的代码审计和安全评估。

**利用方式：**
1.  **版本检测:** 使用PoC中的`-t`参数检测目标系统上运行的libssh版本是否受漏洞影响。
2.  **命令执行:** 使用PoC中的`-c`参数执行任意命令。攻击者可以利用此功能在目标系统上执行恶意操作，例如窃取敏感数据、修改系统配置或植入恶意软件。
3.  **交互式Shell:** 使用PoC中的`-i`参数打开交互式shell。攻击者可以利用此shell完全控制目标系统。

**项目地址:** [Rubikcuv5/CVE-2018-10933](https://github.com/Rubikcuv5/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)