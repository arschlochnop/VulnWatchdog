## CVE-2025-48384 - Git Config 注入导致任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户克隆包含恶意配置的仓库，并初始化包含恶意配置的子模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 是一个 Git 漏洞，源于 Git 对配置项中回车符（CR）处理不当。具体来说，当 Git 读取配置值时，会去除尾部的 CRLF。但当写入配置项时，如果值包含尾部 CR，则不会被引用，导致 CR 在后续读取时丢失。这个漏洞可以被利用于子模块初始化过程中。如果子模块的路径包含尾部 CR，修改后的路径会被读取，导致子模块被检出到错误的位置。如果存在一个符号链接将修改后的路径指向子模块的钩子目录，并且子模块包含可执行的 post-checkout 钩子，那么在检出后，该脚本可能会被意外执行，从而导致任意代码执行。

**POC 分析：**

提供的 POC 包含以下文件：

*   `/tmp/c0992c92d79d1fe84e0bde5daf2c172b/README.md`：一个普通的 README 文件，可能用于描述 PoC 的用途。
*   `/tmp/c0992c92d79d1fe84e0bde5daf2c172b/post-checkout`：一个 bash 脚本，当子模块检出后会被执行。脚本的功能很简单，就是创建一个 `/tmp/fishsucks` 文件。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件中的子模块路径包含尾部 CR。
2.  攻击者在该仓库中创建一个子模块，并在该子模块的 `.git/hooks` 目录下放置一个名为 `post-checkout` 的可执行脚本（如提供的POC）。
3.  攻击者创建一个符号链接，将包含尾部 CR 的子模块路径指向该子模块的 `.git/hooks` 目录。
4.  受害者克隆该仓库，并执行 `git submodule init` 和 `git submodule update` 命令。
5.  由于 Git 对尾部 CR 的处理不当，子模块会被检出到错误的位置，并且 `post-checkout` 脚本会被执行，从而导致任意代码执行。

**有效性：**

根据漏洞描述和 POC 代码，该 POC 是有效的。它可以利用 Git 的配置解析漏洞，在受害者机器上执行任意代码。

**投毒风险：**

该POC的目的是创建一个`/tmp/fishsucks`文件,根据POC内容来看，此代码的目的是演示该漏洞，没有发现隐藏的恶意代码，因此投毒风险较低，可以认为是 0%。

**项目地址:** [beishanxueyuan/CVE-2025-48384](https://github.com/beishanxueyuan/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)