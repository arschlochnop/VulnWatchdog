## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite dev server 显式暴露到网络 (使用 `--host` 或 `server.host` 配置选项). 需要用户交互 (用户需要访问恶意构造的 URL).

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30208 漏洞存在于 Vite 的文件服务中。当 Vite dev server 显式暴露到网络时，攻击者可以通过构造包含 `?raw??` 或 `?import&raw??` 的恶意 URL，绕过 `server.fs.deny` 限制，读取服务器上的任意文件内容。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且已经有公开的 PoC 存在。提供的 Python 脚本 `Vite-CVE-2025-30208-ReadAnyFile.py` 实现了漏洞的检测功能。脚本通过发送带有特定 payload 的 HTTP 请求，判断目标服务器是否存在漏洞。脚本支持自定义 payload 和代理，方便进行漏洞验证和调试。从代码逻辑和漏洞描述来看，该PoC是有效的。

**投毒风险分析：**

查看提供的 `Vite-CVE-2025-30208-ReadAnyFile.py` 脚本，主要功能是发送 HTTP 请求，判断目标服务器是否存在 CVE-2025-30208 漏洞。脚本本身不包含任何恶意代码，例如反弹 shell、下载执行恶意程序等。但使用该脚本进行大规模扫描可能会被视为恶意行为。README文件仅供安全研究与教育目的，并且声明使用者需要对自己的行为负责, 同时代码逻辑较为简单,投毒风险较低。考虑到免责申明和代码功能，投毒风险较低，约为 5%。

**利用方式：**

1.  **漏洞原理：** Vite 在处理 URL 时，对 `?raw??` 等特殊字符串处理不当，导致绕过 `server.fs.deny` 限制。
2.  **攻击步骤：**
    *   确定目标 Vite 应用的版本是否在受影响范围内。
    *   如果目标应用将 Vite dev server 暴露到网络，则可以尝试利用该漏洞。
    *   构造包含 `?raw??` 或 `?import&raw??` 的 URL，例如：`http://example.com/@fs/etc/passwd?import&raw??`。
    *   发送构造的 URL 到目标服务器。
    *   如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。
3.  **修复建议：** 升级 Vite 到最新版本，或避免将 Vite dev server 暴露到公共网络。

**项目地址:** [iSee857/CVE-2025-30208-PoC](https://github.com/iSee857/CVE-2025-30208-PoC)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)