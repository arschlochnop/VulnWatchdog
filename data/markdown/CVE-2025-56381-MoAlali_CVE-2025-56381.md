## CVE-2025-56381 - ERPNext/Frappe Authenticated SQL Injection

**漏洞编号:** CVE-2025-56381

**漏洞类型:** SQL注入

**影响应用:** ERPNext / Frappe

**危害等级:** 高危，可能导致数据泄露、数据库枚举、权限提升、任意SQL代码执行

**影响版本:** Frappe 15.72.4, ERPNext 15.67.0

**利用条件:** 需要有效的ERPNext/Frappe实例访问权限（已认证）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-56381 是 ERPNext 和 Frappe 框架中存在的一个认证后的SQL注入漏洞。该漏洞存在于`frappe.desk.reportview.get` API 端点，攻击者可以通过操纵 `order_by` 和 `group_by` 参数，注入恶意 SQL 代码。由于 Frappe 以及 ERPNext 框架广泛应用于企业资源管理和相关领域，该漏洞一旦被利用，可能导致敏感数据泄露、数据库信息泄露，甚至完全控制数据库，对业务造成严重影响。

**有效性评估：**

根据提供的漏洞利用代码（README.md），该漏洞利用 PoC 使用 Error-based SQL 注入方法，通过构造恶意的 `order_by` 参数，如 `(select updatexml(null,concat(0x7e,database(),0x7e),null))`，来触发数据库错误，从而验证 SQL 注入的存在。PoC 中提供了详细的漏洞描述、受影响的版本、利用方式和修复建议。从 PoC 的完整性和详细程度来看，该 PoC 具有较高的有效性。

**投毒风险评估：**

仔细检查提供的 README.md 文件，没有发现明显的恶意代码或后门程序。但考虑到攻击者可能在其他文件中隐藏恶意代码的可能性，例如在图片资源链接中嵌入恶意链接，或在文档中插入不可见的字符等。因此，不能完全排除投毒风险。综合评估，投毒风险约为 10%。

**利用方式：**

1.  **身份认证：** 攻击者需要首先获得 ERPNext/Frappe 实例的有效用户凭证。
2.  **构造恶意请求：** 攻击者构造一个 POST 请求，目标 URL 为 `/api/method/frappe.desk.reportview.get`，请求体中包含 JSON 数据，其中 `doctype` 字段指定要查询的文档类型，`order_by` 或 `group_by` 字段包含恶意的 SQL 注入 payload。
3.  **发送请求：** 攻击者发送构造好的 POST 请求到目标服务器。
4.  **利用 SQL 注入：** 服务器端未对 `order_by` 和 `group_by` 参数进行充分的验证和过滤，直接将其拼接进 SQL 查询语句中，导致 SQL 注入漏洞。
5.  **数据泄露/代码执行：** 攻击者利用 SQL 注入漏洞，可以执行任意 SQL 查询，从而获取数据库中的敏感数据，或者通过执行恶意 SQL 语句来操控数据库，甚至执行系统命令，提升权限。

**项目地址:** [MoAlali/CVE-2025-56381](https://github.com/MoAlali/CVE-2025-56381)

**漏洞详情:** [CVE-2025-56381](https://nvd.nist.gov/vuln/detail/CVE-2025-56381)