## CVE-2022-21449-Java-Psychic Signatures

**漏洞编号:** CVE-2022-21449

**漏洞类型:** ECDSA签名绕过

**影响应用:** Java SE JDK and JRE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，可能导致未授权的数据创建、删除或修改

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 需要受影响的Java版本，以及网络访问相关API或沙箱环境（Web Start应用或Applet）。可能需要目标服务器使用TLS。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21449，也被称为“Psychic Signatures”，是一个存在于Java ECDSA签名验证算法中的漏洞。该漏洞允许攻击者使用无效签名（例如，所有字节都为零）绕过身份验证。具体来说，Java 15及更高版本中引入的实现未能正确处理某些边界情况下的ECDSA签名。攻击者可以利用此漏洞伪造签名，从而冒充其他用户或服务。从搜索引擎结果来看，该漏洞利用简易，影响广泛。

漏洞利用代码分析：提供的代码是一个Apache License 2.0协议的LICENSE文件，本身不包含任何漏洞利用代码，因此无法直接判断漏洞利用的有效性。但是，搜索引擎结果中提到了一个名为"notkmhn/CVE-2022-21449-TLS-PoC"的GitHub仓库，其中包含演示如何通过恶意的TLS服务器利用此漏洞的PoC代码。因此，可以认为存在有效的漏洞利用代码。

投毒风险分析：提供的LICENSE文件不包含任何可执行代码或恶意逻辑，可以判断其投毒风险为0%。

利用方式：攻击者可以通过以下方式利用此漏洞：

1.  **TLS中间人攻击：** 攻击者可以作为TLS中间人，修改服务器发送的ECDSA签名，将其替换为无效签名，从而绕过客户端的身份验证。
2.  **直接调用API：** 如果应用程序使用受影响的Java版本提供的ECDSA签名验证API，攻击者可以直接向API提供无效签名，从而绕过验证。
3.  **篡改数据：** 攻击者可以篡改需要进行签名验证的数据，并附上伪造的签名，从而绕过数据的完整性校验。

由于CVSS评分为7.5，攻击复杂度低，且无需用户交互，因此该漏洞的威胁程度较高，建议尽快升级Java版本。

**项目地址:** [HeyMrSalt/AIS3-2024-Project-D5Team](https://github.com/HeyMrSalt/AIS3-2024-Project-D5Team)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)