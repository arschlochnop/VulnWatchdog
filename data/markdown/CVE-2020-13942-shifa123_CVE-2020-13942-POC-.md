## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并能够访问其/context.json端点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞存在于 Apache Unomi 1.5.2 之前的版本中。PoC 代码通过发送包含恶意脚本的 POST 请求到 `/context.json` 端点来利用此漏洞。 

**有效性：**
根据漏洞描述和搜索结果，该漏洞是一个远程代码执行漏洞，利用代码的目的是验证目标是否存在该漏洞，通过执行`id`命令并判断返回结果中是否包含特定的字符串来判断。因此，提供的PoC代码是有效的，可以用于检测目标系统是否存在CVE-2020-13942漏洞。

**投毒风险：**
分析提供的PoC代码，未发现明显的投毒代码。脚本主要功能是读取 targets.txt 文件中的目标地址，然后向这些地址的 `/context.json` 端点发送包含恶意 OGNL/MVEL 表达式的 POST 请求，并根据返回结果判断目标是否存在漏洞。虽然攻击者可能利用此漏洞执行恶意操作，但该脚本本身并没有植入后门或进行其他恶意行为。因此，投毒风险为 0%。

**利用方式：**
1.  **目标枚举：**  收集目标Unomi实例的URL。
2.  **构造恶意请求：**  构建一个包含恶意OGNL或MVEL表达式的JSON数据，并将其作为POST请求发送到 `/context.json` 端点。
3.  **代码执行：**  Unomi服务器在处理请求时，会执行注入的恶意脚本，从而实现远程代码执行。
4.  **验证：** 通过检查执行命令的结果来验证漏洞是否成功利用。 

该漏洞的根本原因是Apache Unomi对用户输入的数据没有进行充分的验证和过滤，导致攻击者可以注入恶意脚本并执行。

**项目地址:** [shifa123/CVE-2020-13942-POC-](https://github.com/shifa123/CVE-2020-13942-POC-)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)