## CVE-2020-26217-XStream-RCE

**漏洞编号:** CVE-2020-26217

**漏洞类型:** 远程代码执行

**影响应用:** XStream

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.4.14

**利用条件:** 目标系统使用了XStream，并且依赖于黑名单机制而非白名单机制进行安全过滤

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-26217是XStream在1.4.14版本之前存在的一个远程代码执行漏洞。攻击者可以通过构造恶意的XML输入，利用XStream反序列化过程中存在的问题，执行任意系统命令。

**有效性：**
提供的POC代码有效。POC通过构造特殊的XML数据，利用`jdk.nashorn.internal.objects.NativeString`，`com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data`， `com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource`等类，最终触发`java.lang.ProcessBuilder`执行任意命令，实现了远程代码执行。

**投毒风险：**
经过分析，该POC仓库主要包含POC代码示例和说明文档。`POC`文件本身是为了演示漏洞利用，其目的是启动计算器（`calc`）。`README.md`文件只是提供了POC的使用示例代码。根据现有信息，未发现作者故意隐藏的恶意后门代码。但是,用户仍然需要从可信来源下载或复制此代码，以降低风险.投毒风险较低。

**利用方式：**
1.  **确定目标：** 确认目标系统使用了存在漏洞的XStream版本（< 1.4.14）。
2.  **构造恶意XML：** 构造包含恶意payload的XML数据。该payload利用了XStream反序列化漏洞，通过特定的类和方法调用链，最终执行系统命令。
3.  **发送Payload：** 将构造好的恶意XML数据发送给目标系统，由XStream进行反序列化。
4.  **触发RCE：** 如果目标系统存在漏洞且安全配置不当（依赖黑名单而非白名单），则XStream在反序列化过程中会执行payload中的系统命令，导致远程代码执行。在给定的POC中，命令是启动计算器。
5.  **修复建议:** 升级到XStream 1.4.14或更高版本，并采用白名单机制进行安全过滤。

**项目地址:** [novysodope/CVE-2020-26217-XStream-RCE-POC](https://github.com/novysodope/CVE-2020-26217-XStream-RCE-POC)

**漏洞详情:** [CVE-2020-26217](https://nvd.nist.gov/vuln/detail/CVE-2020-26217)