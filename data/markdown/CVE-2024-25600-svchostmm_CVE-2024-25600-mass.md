## CVE-2024-25600-BricksBuilder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标网站安装并启用了Bricks Builder插件，且版本低于或等于1.9.6，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是一个存在于WordPress Bricks Builder插件中的代码注入漏洞。攻击者可以通过发送特制的HTTP请求，利用插件中对用户输入验证不足的缺陷，注入并执行任意PHP代码，从而完全控制目标网站。

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断提供的POC代码是有效的。漏洞库信息中明确指出该漏洞允许代码注入，并且存在多个公开的POC代码（如`https://github.com/K3ysTr0K3R/CVE-2024-25600-EXPLOIT`和`https://github.com/Chocapikk/CVE-2024-25600`）。搜索引擎结果也验证了这一点，多个安全厂商和漏洞库都记录了该漏洞的存在和高危风险。

**投毒风险：**

对提供的POC代码`exploit.py`进行分析：

*   **功能：** 该脚本通过构造特定的JSON payload，利用Bricks Builder插件的`/wp-json/bricks/v1/render_element`端点触发代码注入。
*   **行为：**  脚本可以执行任意命令，默认行为是下载一个名为`up.php`的webshell到目标服务器，并执行`ls -la`命令。它还包含一个交互式shell。
*   **风险点：**  
    * 下载webshell `up.php`：这是最明显的风险点。如果`up.php`的内容被篡改，攻击者可能被诱导执行恶意代码。但是当前代码指定了github的 raw 文件，投毒者无法直接修改原始文件。因此，需要进一步分析脚本中是否存在其他潜在的投毒代码。
    * 交互式shell：虽然交互式shell本身不是投毒行为，但如果攻击者在不了解代码的情况下直接运行，可能会暴露敏感信息或执行不希望的操作。
*   **结论：** 脚本本身的主要目的是利用漏洞，下载webshell并非必须，只是默认行为，可以修改为执行其他命令。风险主要在于webshell的内容，如果webshell是恶意的，则存在投毒风险。`exploit.py`主要功能是漏洞利用,不属于投毒,因此投毒风险较低。

综合考虑，该仓库中存在作者隐藏的投毒代码的可能性较低，但用户需要注意webshell的内容，避免执行恶意代码。因此，投毒风险评估为10%。

**利用方式：**

1.  **获取nonce：**  攻击者首先需要从目标网站的HTML源码中提取nonce值。POC代码会自动尝试获取。
2.  **构造payload：**  攻击者构造包含恶意PHP代码的JSON payload。POC代码中使用了`queryEditor`参数进行代码注入。
3.  **发送请求：**  攻击者将构造好的payload发送到`/wp-json/bricks/v1/render_element`端点。POC代码提供了两种发送请求的方式：一种是使用`pretty=True`，另一种是使用`pretty=False`。
4.  **执行代码：**  如果漏洞利用成功，恶意PHP代码将在目标服务器上执行。POC代码默认下载`up.php`webshell文件，并执行`ls -la`命令，也可以进入交互式shell执行其他命令。
5.  **访问webshell：**webshell成功上传后，可以通过浏览器访问webshell，从而控制网站。


**项目地址:** [svchostmm/CVE-2024-25600-mass](https://github.com/svchostmm/CVE-2024-25600-mass)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)