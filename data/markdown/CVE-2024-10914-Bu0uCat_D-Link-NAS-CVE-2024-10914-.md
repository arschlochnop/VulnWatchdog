## CVE-2024-10914 D-Link NAS OS 命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS 命令注入

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可能导致远程代码执行和设备控制

**影响版本:** <= 20241028

**利用条件:** 需要网络访问，目标设备开启web服务，且可访问/cgi-bin/account_mgr.cgi

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于D-Link NAS设备的`/cgi-bin/account_mgr.cgi`文件中`cgi_user_add`函数，通过对`name`参数进行恶意构造，可以实现OS命令注入。根据搜索引擎结果和漏洞库信息，该漏洞已被公开披露并存在可用的Exploit。提供的POC代码通过构造包含系统命令的`name`参数，发送GET请求到目标URL，如果服务器返回包含`uid`的文本，则判断漏洞存在。

**有效性：** 根据漏洞库信息，搜索引擎信息，以及提供的PoC代码，可以判断此PoC代码是有效的, 因为已经有公开的exp可以利用。

**投毒风险：** PoC代码的主要功能是发送包含恶意命令的HTTP请求，并判断响应结果。代码本身没有明显的恶意行为，例如植入后门或传播恶意软件。但存在一定的投毒风险，例如，攻击者可以修改POC代码，使其在检测漏洞的同时执行其他恶意操作。此代码相对简洁，风险较低，因此估计投毒风险在5%。主要的风险在于使用者在未经充分审查的情况下直接运行POC代码，导致潜在的风险。

**利用方式：**
1.  **确定目标：** 通过网络测绘或扫描，确定存在漏洞的D-Link NAS设备。
2.  **构造Payload：** 构造包含系统命令的`name`参数。例如：`name=%27;id;%27`，其中`id`命令用于获取当前用户的UID、GID等信息。
3.  **发送请求：** 使用PoC代码或手动发送GET请求到`/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=[PAYLOAD]`。
4.  **验证漏洞：** 分析服务器响应，如果响应包含`uid`等信息，则说明命令执行成功，漏洞存在。
5.  **进一步利用：** 在确认漏洞存在后，可以进一步利用该漏洞执行更具危害性的操作，如读取敏感文件、添加恶意用户、或执行任意代码。

**项目地址:** [Bu0uCat/D-Link-NAS-CVE-2024-10914-](https://github.com/Bu0uCat/D-Link-NAS-CVE-2024-10914-)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)