## CVE-2023-38831 WinRAR 远程代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 远程代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者在用户尝试查看 ZIP 压缩包中的文件时执行任意代码。

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响的 WinRAR 版本打开特制的 ZIP 压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831 允许攻击者通过构造恶意的 ZIP 压缩包实现远程代码执行。该压缩包包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。当用户尝试访问良性文件时，WinRAR 会错误地执行同名文件夹中的内容，从而执行攻击者放置的恶意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被广泛利用。 提供的POC代码描述的是在压缩文件中嵌入恶意payload，并触发反向shell的实验环境验证过程。虽然该代码本身没有包含恶意代码，但描述了如何构建利用该漏洞的压缩文件。

**投毒风险：**
提供的 POC 代码仓库中只包含 PDF 报告和截图，并没有可执行的恶意代码。 但是,README中说明了该仓库展示了恶意payload的嵌入方式，存在一定的潜在风险。 因此，存在一定的投毒风险，但风险较低。根据readme描述和文件结构，投毒风险评估为10%，

**利用方式：**
1.  **创建恶意 ZIP 压缩包：** 攻击者创建一个 ZIP 压缩包，其中包含一个良性文件（例如 JPG）和一个与良性文件同名的文件夹。
2.  **放置恶意代码：** 将恶意可执行文件放置在与良性文件同名的文件夹中。
3.  **诱骗用户：** 诱骗用户使用受影响的 WinRAR 版本打开该 ZIP 压缩包并尝试查看良性文件。
4.  **执行恶意代码：** WinRAR 错误地执行同名文件夹中的恶意代码，从而实现远程代码执行。

根据搜索结果，该漏洞已经被政府支持的攻击者利用，用于投放 RAT（远程访问木马）等恶意软件。

**项目地址:** [Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution](https://github.com/Tolu12wani/Demonstration-of-CVE-2023-38831-via-Reverse-Shell-Execution)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)