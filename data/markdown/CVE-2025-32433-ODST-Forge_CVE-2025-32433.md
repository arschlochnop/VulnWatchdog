## CVE-2025-32433 Erlang/OTP SSH 预认证RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** OTP-25.3.2.20之前, OTP-26.0-rc1到OTP-26.2.5.11, OTP-27.0-rc1到OTP-27.3.3

**利用条件:** 目标系统运行受影响版本的Erlang/OTP SSH服务，攻击者可以访问该服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32433是Erlang/OTP SSH服务中存在的一个预认证远程代码执行漏洞。该漏洞源于SSH协议消息处理中的缺陷，允许未经身份验证的远程攻击者通过发送特制的SSH协议消息，在目标系统上执行任意代码。利用过程如下：

1.  **建立TCP连接：** 攻击者首先与目标Erlang/OTP SSH服务建立TCP连接。
2.  **发送SSH Banner和KEXINIT：** 攻击者发送SSH协议版本标识（Banner）和密钥交换初始化（KEXINIT）数据包，模拟SSH客户端的握手过程。
3.  **通道类型暴力破解：** 攻击者尝试发送不同的SSH通道打开（CHANNEL_OPEN）请求，例如session、direct-tcpip等，来寻找服务端可接受的通道类型。
4.  **命令注入：** 一旦成功打开通道（无需认证），攻击者便可以发送包含恶意命令的通道请求（CHANNEL_REQUEST）。这些命令将在服务器上执行。示例代码中使用 `os:cmd("id").`  来执行`id`命令。

**漏洞利用代码分析：**

提供的Python脚本 `erLang.py` 旨在测试CVE-2025-32433漏洞。它模拟了SSH客户端的行为，发送特定的SSH协议消息，试图在未经身份验证的情况下执行命令。脚本的关键功能包括：

*   **目标枚举：** 从命令行参数或文件中读取目标IP地址和端口。
*   **SSH协议模拟：** 构建并发送SSH Banner、KEXINIT等协议消息。
*   **通道打开尝试：** 尝试不同的通道类型，以寻找漏洞利用点。
*   **命令执行：** 发送包含命令的通道请求。
*   **多线程：** 使用多线程加速扫描。

**投毒风险评估：**

该脚本本身旨在进行漏洞测试，而非恶意攻击。但是，恶意使用者可以修改该脚本，使其包含恶意命令（例如，植入后门、删除数据等）。 因此该脚本存在一定的投毒风险，风险评估为5%。主要基于以下考虑：

*   该代码没有明显的恶意功能，例如数据擦除或隐藏的后门。脚本功能围绕漏洞利用展开，而非恶意行为。
*   脚本明确声明用于测试漏洞，并提供了MIT许可证，降低了恶意使用的可能性。

总而言之，该漏洞影响较大，易于利用，应尽快修复。提供的PoC代码可以有效验证漏洞的存在，但使用者需要注意潜在的恶意使用风险。

**项目地址:** [ODST-Forge/CVE-2025-32433](https://github.com/ODST-Forge/CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)