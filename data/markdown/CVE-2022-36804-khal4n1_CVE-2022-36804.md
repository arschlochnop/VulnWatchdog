## CVE-2022-36804-Bitbucket命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server/Data Center

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 7.0.0 <= version < 7.6.17, 7.7.0 <= version < 7.17.10, 7.18.0 <= version < 7.21.4, 8.0.0 <= version < 8.0.3, 8.1.0 <= version < 8.1.3, 8.2.0 <= version < 8.2.2, 8.3.0 <= version < 8.3.1

**利用条件:** 需要对公共仓库或者私有仓库有读取权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-36804是Atlassian Bitbucket Server和Data Center中多个API端点存在的一个命令注入漏洞。具有公共存储库访问权限或对私有Bitbucket存储库具有读取权限的攻击者可以通过发送恶意HTTP请求来执行任意代码。漏洞利用方式为：利用git archive命令的`--exec`参数进行命令注入。POC代码中，`mexploit.py`脚本通过构造特定的URL，将恶意命令注入到`--exec`参数中，从而在目标服务器上执行任意命令。`README.md`文件仅包含漏洞描述和脚本使用说明，未发现恶意代码。初步判断投毒风险较低，但仍需谨慎评估脚本执行的命令是否安全，以及脚本是否存在其他隐藏的恶意行为。`walnutsecurity/cve-2022-36804`等仓库也提供了此漏洞的POC，可作为参考对比。

**项目地址:** [khal4n1/CVE-2022-36804](https://github.com/khal4n1/CVE-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)