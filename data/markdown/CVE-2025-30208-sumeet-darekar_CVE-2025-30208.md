## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite dev server 显式暴露到网络（使用 `--host` 或 `server.host` 配置选项），需要用户交互（用户点击恶意链接）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30208 是 Vite 中存在的任意文件读取漏洞。由于 Vite 在处理 URL 时，对 query string 的处理存在缺陷，攻击者可以通过在 URL 中添加 `?raw??` 或 `?import&raw??` 来绕过 `@fs` 的访问控制限制，读取服务器上的任意文件内容。

**有效性评估：**

根据漏洞描述、搜索结果（如securityonline.info/millions-at-risk-poc-exploit-releases-for-vite-arbitrary-file-read-flaw-cve-2025-30208/）和提供的 PoC 代码，该漏洞利用是有效的。PoC代码自动化了漏洞检测和扫描过程。

**投毒风险分析：**

提供的 PoC 代码由三个文件组成：`script.sh`、`detect_vite.py` 和 `scan_vite.py`。`script.sh` 只是一个简单的脚本，用于执行其他两个 Python 脚本。`detect_vite.py` 脚本用于检测目标 URL 是否运行 Vite，而 `scan_vite.py` 脚本用于扫描目标 URL 是否存在 CVE-2025-30208 漏洞。

代码中检测到存在发送Discord通知的功能，这可能被滥用泄露扫描目标。但是整体代码功能符合漏洞利用的逻辑，投毒风险较低，约为10%。

**利用方式：**

1.  **检测Vite服务器：** 使用 `detect_vite.py` 脚本从 `urls.txt` 文件中的 URL 列表中识别 Vite 服务器，并将结果保存到 `hosts.txt` 文件中。
2.  **漏洞扫描：** 使用 `scan_vite.py` 脚本扫描 `hosts.txt` 文件中列出的 Vite 服务器，以查找 CVE-2025-30208 漏洞。该脚本通过构造包含 `?raw??` 或 `?import&raw??` 的恶意 URL 来尝试读取服务器上的任意文件。
3.  **单URL扫描：** 将单个 URL 添加到 `hosts.txt` 文件中，然后运行 `python3 scan_vite.py` 来扫描该 URL。
4.  **绕过 `@fs` 限制：** 漏洞利用的核心在于使用 `?raw??` 或 `?import&raw??` 绕过 Vite 的 `@fs` 访问控制限制，从而读取受保护的文件。

**缓解措施：**

升级到 Vite 的修复版本（>= 6.2.3, >= 6.1.2, >= 6.0.12, >= 5.4.15, >= 4.5.10）。避免将 Vite dev server 暴露到公网。


**项目地址:** [sumeet-darekar/CVE-2025-30208](https://github.com/sumeet-darekar/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)