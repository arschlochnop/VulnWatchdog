## CVE-2018-16621-Nexus Repository Manager-Java表达式语言注入

**漏洞编号:** CVE-2018-16621

**漏洞类型:** Java表达式语言注入

**影响应用:** Nexus Repository Manager

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 3.14

**利用条件:** 需要对目标Nexus Repository Manager的网络访问，并且通常需要管理员权限才能成功利用。默认用户名密码admin/admin123.

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-16621是Sonatype Nexus Repository Manager 3在3.14之前的版本中存在的Java表达式语言注入漏洞。攻击者可以通过构造恶意的EL表达式，在服务器端执行任意代码，从而控制服务器。该漏洞的利用方式通常涉及以下步骤：

1.  **身份验证：** 首先，攻击者需要登录到Nexus Repository Manager的控制台。根据代码，默认使用账号密码尝试爆破。
2.  **构造Payload：** 攻击者利用EL表达式注入漏洞，将恶意代码嵌入到Nexus Repository Manager的配置或参数中。漏洞利用代码中使用了BCEL (Byte Code Engineering Library) 加载恶意的java类,实现远程命令执行。
3.  **触发漏洞：** 攻击者通过发送包含恶意EL表达式的请求，触发漏洞。例如，可以通过更新用户角色等操作触发。
4.  **执行代码：** Nexus Repository Manager在处理包含恶意EL表达式的请求时，会执行其中的代码，从而导致远程代码执行。

**投毒风险分析：**

该POC代码的主要功能是利用漏洞反弹shell。其中存在一定投毒风险，主要体现在以下几个方面：

*   **硬编码的IP地址和端口：** 脚本中需要用户输入目标IP、端口以及反弹shell的IP和端口，这本身看起来是正常的交互式参数。但是，如果攻击者发布一个修改过的版本，在用户不知情的情况下，将反弹shell地址更改为攻击者控制的服务器，则可能被用于建立僵尸网络或者窃取用户凭据，存在一定的后门风险。
*   **BCEL代码的复杂性：** BCEL代码本身是经过编码的，不容易直接阅读和理解。攻击者可能会在BCEL代码中隐藏恶意行为，例如下载和执行额外的恶意payload。

因此，在使用该POC代码时，用户需要仔细检查代码，确保没有恶意行为。同时，建议从可信的来源下载POC代码，并使用最新的安全工具对代码进行扫描，以检测潜在的威胁。

总的来说，该POC代码的投毒风险为10%，主要来自于潜在的BCEL代码植入后门和硬编码IP地址。

**项目地址:** [Loucy1231/Nexus-Repository-Manager3-EL-CVE-2018-16621-https-www.cve.org-CVERecord-id-CVE-2018-16621-](https://github.com/Loucy1231/Nexus-Repository-Manager3-EL-CVE-2018-16621-https-www.cve.org-CVERecord-id-CVE-2018-16621-)

**漏洞详情:** [CVE-2018-16621](https://nvd.nist.gov/vuln/detail/CVE-2018-16621)