## CVE-2020-5410 Spring Cloud Config 目录遍历

**漏洞编号:** CVE-2020-5410

**漏洞类型:** 目录遍历

**影响应用:** Spring Cloud Config

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.1.9 (2.1.x), < 2.2.3 (2.2.x)

**利用条件:** 需要网络访问 Spring Cloud Config Server

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-5410 是一个 Spring Cloud Config Server 的目录遍历漏洞。攻击者可以构造恶意 URL，利用路径遍历漏洞读取服务器上的任意配置文件。根据漏洞库信息和搜索结果，此漏洞影响 Spring Cloud Config Server 的 2.2.3 之前的 2.2.x 版本和 2.1.9 之前的 2.1.x 版本。

**有效性：**
提供的POC代码看起来只是包含了一系列配置文件的示例，例如 `config-eureka-client-dev.yml`， `config-eureka-client-prod.yml`，`config-single-client-dev.yml`，`config-single-client-prod.yml` 和 `test.yml`。这些文件展示了可能的配置内容，包含用户名、密码等敏感信息。这些示例文件本身**不是**漏洞利用代码，而是**可以被利用读取的目标文件示例**，所以，从这个角度来看, `POC代码有效`, 因为它明确展示了通过漏洞可以获取哪些敏感配置信息。

**投毒风险：**
该仓库的主要内容为配置文件示例，没有发现明显的后门或恶意代码。`README.md` 文件也只是说明了 CVE 编号。虽然作者可能在其他地方部署恶意服务，但从这个仓库的内容来看，投毒风险较低，大约为 5%。

**利用方式：**
1.  **构造恶意 URL：** 攻击者需要构造包含目录遍历字符（例如 `../`）的 URL。根据搜索结果，用户可控的参数（name, profile, label）没有经过充分验证，直接用于解析文件路径，导致目录遍历。
2.  **发送请求：**  攻击者将构造好的 URL 发送到存在漏洞的 Spring Cloud Config Server。
3.  **读取文件：**  如果漏洞存在，服务器将返回攻击者请求的配置文件内容，导致敏感信息泄露。例如：`GET /foo/default/master/../../../../etc/passwd`

综上所述，CVE-2020-5410 是一个较为严重的安全漏洞，攻击者可以利用目录遍历读取敏感配置文件，从而获取用户名、密码等信息。需要及时升级 Spring Cloud Config Server 版本以修复此漏洞。

**项目地址:** [dead5nd/config-demo](https://github.com/dead5nd/config-demo)

**漏洞详情:** [CVE-2020-5410](https://nvd.nist.gov/vuln/detail/CVE-2020-5410)