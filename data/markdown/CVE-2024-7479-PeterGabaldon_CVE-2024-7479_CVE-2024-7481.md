## CVE-2024-7479 TeamViewer VPN驱动安装签名验证不当导致权限提升

**漏洞编号:** CVE-2024-7479

**漏洞类型:** 权限提升

**影响应用:** TeamViewer Remote Client/Host

**危害等级:** 高危，本地权限提升，允许低权限用户安装恶意驱动

**影响版本:** 11.0.0 ~ 15.58.4 之前的版本

**利用条件:** 需要本地访问权限，目标系统安装了受影响版本的TeamViewer

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7479 漏洞存在于 TeamViewer Windows 客户端和 Host 版本中，是由于在安装VPN驱动时，TeamViewer_service.exe 组件对加密签名的验证不当造成的。攻击者利用此漏洞，能够在Windows系统上以低权限用户身份提升权限，并安装任意驱动程序。漏洞利用方式如下：

1.  **漏洞原理：** TeamViewer 在安装 VPN 驱动时，没有正确验证驱动程序的数字签名，导致攻击者可以伪造签名，欺骗系统安装恶意的驱动程序。
2.  **攻击步骤：**
    *   攻击者首先需要拥有目标系统的本地访问权限。
    *   攻击者利用提供的PoC代码，该PoC代码通过不正确的签名验证，允许加载恶意的内核驱动程序。
    *   恶意的驱动程序被安装后，攻击者即可利用该驱动程序获取系统的高级权限。
3.  **PoC分析：**
    *   提供的代码库包含一个 Visual Studio 解决方案文件 `CVE-2024-7479_CVE-2024-7481.sln`，表明这是一个 C++ 项目。
    *   `README.md` 文件中包含有关该漏洞的详细信息，包括受影响的版本、漏洞描述以及 PoC 执行截图，并且引用了外部链接，指向了漏洞的 CVE 记录、Zero Day Initiative 的公告和 TeamViewer 的安全公告。
4.  **投毒风险评估：** 
    *   虽然提供的代码库本身似乎是为了演示漏洞利用，但仍然存在一定的投毒风险。攻击者可能会修改 PoC 代码，使其在提升权限的同时，执行额外的恶意操作，例如安装后门程序、窃取敏感信息或破坏系统。此风险主要体现在攻击者修改后的PoC上，原始PoC作为研究和验证目的，投毒风险较低，约为10%。

总之，CVE-2024-7479 是一个高危漏洞，攻击者可以利用该漏洞在受影响的系统上获得管理员权限。建议 TeamViewer 用户尽快升级到最新版本，以修复此漏洞。

**项目地址:** [PeterGabaldon/CVE-2024-7479_CVE-2024-7481](https://github.com/PeterGabaldon/CVE-2024-7479_CVE-2024-7481)

**漏洞详情:** [CVE-2024-7479](https://nvd.nist.gov/vuln/detail/CVE-2024-7479)