## CVE-2018-14714-ASUS RT-AC3200-命令注入

**漏洞编号:** CVE-2018-14714

**漏洞类型:** 命令注入

**影响应用:** ASUS RT-AC3200

**危害等级:** 高危，允许远程代码执行

**影响版本:** 3.0.0.4.382.50010

**利用条件:** 需要目标设备的用户凭据

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-14714 存在于 ASUS RT-AC3200 路由器的 appGet.cgi 文件中。攻击者可以通过 load_script 参数进行系统命令注入。漏洞利用方式如下：

1.  **身份验证绕过/会话获取：** PoC 脚本首先尝试通过提供的用户名和密码，使用 base64 编码进行身份验证，从`/login.cgi`获取有效的会话 Cookie。
2.  **页面存在性检查：** 脚本检查 `/appGet.cgi` 页面是否存在，确认漏洞利用的入口点。
3.  **命令注入：** PoC 脚本通过构造包含恶意命令的 `load_script` URL 参数，利用 `appGet.cgi` 页面执行系统命令。 命令被编码在URL中。特别注意，脚本使用 `urllib.parse.quote` 对payload进行URL编码，然后将其插入到`load_script()`函数调用中。
4.  **命令执行验证 (时间延迟)：** PoC 脚本使用基于时间的注入技术来验证漏洞是否存在，通过执行 `sleep 3` 命令并检查执行时间是否大于或等于3秒来确认漏洞。
5.  **交互式Shell (可选)：**  如果提供了 `shell` 参数，PoC 脚本会进入一个交互式 shell，允许攻击者执行任意命令。 命令执行的结果不会直接返回，脚本通过`time.time()`记录执行的时间。

**有效性：** 提供的 PoC 代码有效。它包含了身份验证绕过（假设凭据已知），漏洞页面检查，基于时间的命令注入验证，以及一个交互式 shell 功能，可用于执行任意命令。

**投毒风险：**
PoC 代码中存在轻微的投毒风险的可能性（5%）。 虽然该脚本主要用于漏洞利用，但它依赖于用户提供的用户名和密码。 恶意攻击者可能会使用该脚本自动化漏洞利用过程，攻击大量目标。此外，PoC 代码并未明确限制命令执行的范围，可能被滥用于执行潜在的恶意命令。


**项目地址:** [BTtea/CVE-2018-14714-RCE-exploit](https://github.com/BTtea/CVE-2018-14714-RCE-exploit)

**漏洞详情:** [CVE-2018-14714](https://nvd.nist.gov/vuln/detail/CVE-2018-14714)