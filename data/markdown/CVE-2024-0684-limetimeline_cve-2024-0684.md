## CVE-2024-0684-coreutils-堆溢出

**漏洞编号:** CVE-2024-0684

**漏洞类型:** 堆溢出

**影响应用:** coreutils

**危害等级:** 中危，可能导致拒绝服务或程序崩溃

**影响版本:** v9.2, v9.3, v9.4

**利用条件:** 需要本地用户权限

**POC 可用性:** 部分

**投毒风险:** 5%

## 详情

CVE-2024-0684是GNU coreutils中split程序的一个堆溢出漏洞，存在于`line_bytes_split()`函数中。攻击者可以通过构造超长行的数据，利用`split --line-bytes`命令触发该漏洞，导致程序崩溃或拒绝服务。

**有效性评估：**
根据漏洞信息和搜索结果，确认漏洞存在于coreutils的split程序中，影响版本为v9.2、v9.3和v9.4。漏洞利用需要本地用户权限，利用复杂性较低。提供的POC代码`/tmp/438dbe12d4bf672bd4e8976e7260ac4a/readme.md`，仅包含简单的文本内容，并非直接的漏洞利用代码，缺少触发漏洞的必要参数和指令。根据现有信息判断，提供的代码**无效**。

**投毒风险评估：**
给定的POC代码文件`readme.md`内容非常简单，仅包含“hi”字样，初步判断，其本身**不包含明显的投毒代码**。但是, 该POC代码可能是一个更大攻击链中的一部分，例如，攻击者可能诱导用户下载包含恶意代码的其他文件或执行恶意命令。考虑到存在此类可能性，因此判断存在较低的投毒风险，估算为5%。

**利用方式分析：**
根据漏洞库信息和搜索结果，该漏洞的利用方式为：
1.  攻击者需要具有本地用户权限。
2.  攻击者需要使用`split`命令的`--line-bytes`选项处理包含超长行的输入数据。
3.  超长行数据会导致`line_bytes_split()`函数发生堆溢出。
4.  堆溢出可能导致程序崩溃（拒绝服务）。

虽然目前POC不完整，但漏洞原理较为清晰，可进一步研究构造有效的POC代码。

**项目地址:** [limetimeline/cve-2024-0684](https://github.com/limetimeline/cve-2024-0684)

**漏洞详情:** [CVE-2024-0684](https://nvd.nist.gov/vuln/detail/CVE-2024-0684)