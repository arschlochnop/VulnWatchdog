## CVE-2025-49113-Roundcube-PHP对象反序列化-RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.5.10 和 1.6.0 <= version < 1.6.11

**利用条件:** 需要Roundcube Webmail的有效用户凭据（已认证用户）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49113 是 Roundcube Webmail 中的一个严重的远程代码执行 (RCE) 漏洞，影响 1.5.10 之前的版本以及 1.6.0 到 1.6.10 的版本。该漏洞由 URL 中的 _from 参数在 program/actions/settings/upload.php 中未经过充分验证而导致 PHP 对象反序列化。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，该漏洞是有效的。PoC 代码展示了如何利用此漏洞执行任意命令。

**投毒风险：**
PoC代码的投毒风险极低，约1%。PoC代码结构清晰，主要功能是利用漏洞执行命令。 虽然`file_get_contents`函数可能会被利用于包含远程文件，但目前来看，此处的目的是获取页面内容和发送请求，而非包含恶意代码。

**利用方式：**
1.  **获取 CSRF Token 和 Cookie：** PoC 首先向目标 Roundcube Webmail 实例发送一个 GET 请求，以获取 CSRF token 和初始 session cookie。
2.  **用户身份验证：** 使用提供的用户名、密码和 CSRF token 向 Roundcube 进行身份验证。成功后，会获得一个有效的 session cookie。
3.  **构造和注入 Payload：**PoC 会根据要执行的命令构造一个恶意的 PHP 对象，并将其序列化。然后，将此序列化的对象作为 `_from` 参数的值，通过 POST 请求发送到 `program/actions/settings/upload.php`。
4.  **触发 Payload 并清理：** 发送一个请求来触发反序列化漏洞，从而执行命令。最后，清理用于利用的临时文件（如果适用）。

总的来说，此漏洞利用链依赖于经过身份验证的用户，通过构造恶意的请求来触发 PHP 对象反序列化，最终在服务器上实现任意代码执行。

**项目地址:** [punitdarji/roundcube-cve-2025-49113](https://github.com/punitdarji/roundcube-cve-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)