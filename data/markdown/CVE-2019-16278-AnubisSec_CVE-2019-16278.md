## CVE-2019-16278 - Nostromo nhttpd 目录遍历远程代码执行

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致的远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标服务器运行Nostromo nhttpd <= 1.9.6，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-16278 是 Nostromo nhttpd 1.9.6 及更早版本中 `http_verify` 函数中存在的目录遍历漏洞。攻击者可以通过构造包含目录遍历序列的 HTTP 请求，绕过身份验证，执行任意命令。

**有效性分析：**
根据漏洞描述、搜索引擎结果和提供的 POC 代码，可以确认该漏洞利用的有效性。多个来源（NVD, CVE details, Exploit-DB）都确认了该漏洞的存在和利用的可能性。POC 代码 `nostroSploit.py` 实现了利用该漏洞执行任意命令的功能，该脚本通过发送包含目录遍历序列的 POST 请求，利用 `/bin/sh` 执行命令。

**投毒风险分析：**
通过分析 `nostroSploit.py` 脚本，没有发现明显的投毒代码。该脚本的主要功能是构造恶意的 HTTP 请求并发送到目标服务器，执行指定的命令。脚本从命令行接收目标 IP、端口和要执行的命令，没有包含任何未经授权的恶意行为。脚本的`README.md`给出了使用方法，也没有可疑之处。因此，投毒风险评估为0%。

**利用方式分析：**
1.  攻击者使用 `nostroSploit.py` 脚本，指定目标服务器的 IP 地址、端口号以及要执行的命令。
2.  脚本构造一个 POST 请求，请求的 URL 包含目录遍历序列（`/.%0d./.%0d./.%0d./.%0d./bin/sh`），`%0d` 代表回车符，用于绕过对点号的过滤。
3.  请求体包含 `echo` 命令，用于执行后续的命令。
4.  目标服务器在处理该请求时，由于目录遍历漏洞，会将请求发送到 `/bin/sh` 执行，从而执行攻击者指定的命令。
5.  命令执行的结果会作为 HTTP 响应返回给攻击者。

**项目地址:** [AnubisSec/CVE-2019-16278](https://github.com/AnubisSec/CVE-2019-16278)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)