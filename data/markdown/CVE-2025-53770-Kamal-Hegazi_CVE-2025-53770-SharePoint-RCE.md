## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经授权的攻击者可以通过网络执行代码。

**影响版本:** SharePoint Server 2016 (before KB5002760), SharePoint Server 2019 (before KB5002754), SharePoint Subscription Edition (before KB5002768)

**利用条件:** 需要目标系统运行受影响版本的 SharePoint Server，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

**漏洞利用有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的利用是有效的。漏洞库信息中明确指出“Microsoft is aware that an exploit for CVE-2025-53770 exists in the wild.”搜索结果也显示了该漏洞正在被积极利用。漏洞利用代码 (README.md) 中也详细描述了利用过程，并提供了PoC验证脚本。

**投毒风险：**

虽然提供了Python PoC脚本 (exploit.py)，但没有直接提供内容。 README.md文件中展示了payload生成方式(通过ysoserial.net生成恶意ViewState)，如果ysoserial.net存在恶意payload或者文件生成被篡改，则存在投毒的可能性。由于PoC的主要逻辑依赖于ysoserial.net，且没有提供exploit.py的具体内容，因此仓库中本身存在投毒的可能性较低，估计为10%。 剩余的风险可能来自于下载的第三方库或工具的安全性。

**漏洞利用方式：**

该漏洞是由于 Microsoft SharePoint Server 在处理未信任数据时存在反序列化漏洞造成的，具体利用方式如下：

1.  **身份验证绕过:** 利用 `Referer: /_layouts/SignOut.aspx` 绕过 `/layouts/15/ToolPane.aspx?DisplayMode=Edit` 上的安全检查 (CVE-2025-53771)。
2.  **构造恶意 ViewState:** 使用 `ysoserial.net` 等工具生成包含恶意 gadget chains 的序列化 `__VIEWSTATE` payload。
3.  **发送 Payload:** 通过 HTTP POST 请求将构造的恶意 `__VIEWSTATE` 数据发送到 `/layouts/15/ToolPane.aspx`。
4.  **远程代码执行:** SharePoint Server 反序列化该 payload 并执行攻击者控制的代码，从而获得 w3wp.exe (IIS worker) 进程的权限。
5.  **持久化 (可选):** 攻击者可能会上传 webshell (例如 spinstall0.aspx) 并窃取 machine keys，以便将来生成签名 payload 并实现持久化。

总而言之，该漏洞利用流程涉及一个未经身份验证的请求，其中恶意 ViewState 负载被发送到易受攻击的 SharePoint Server，从而允许远程代码执行。

**项目地址:** [Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE](https://github.com/Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)