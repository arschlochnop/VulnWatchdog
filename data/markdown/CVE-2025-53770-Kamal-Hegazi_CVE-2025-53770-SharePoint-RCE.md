## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016 (before KB5002760), SharePoint Server 2019 (before KB5002754), SharePoint Subscription Edition (before KB5002768)

**利用条件:** 目标SharePoint服务器可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞在目标服务器上执行任意代码。该漏洞不需要身份验证，如果SharePoint服务器暴露在公网上，风险极高。

**利用方式：**
1.  攻击者通过向 `/_layouts/15/ToolPane.aspx?DisplayMode=Edit` 发送带有恶意 `__VIEWSTATE` 数据的 HTTP POST 请求来触发该漏洞。
2.  请求头中需要包含 `Referer: /_layouts/SignOut.aspx` 以绕过身份验证检查 (CVE-2025-53771)。
3.  `__VIEWSTATE` 数据包含使用 `ysoserial.net` 等工具生成的 gadget chains，这些链在反序列化时会执行攻击者控制的代码。
4.  成功利用漏洞后，攻击者通常会上传 webshell (例如 `spinstall0.aspx`) 并窃取 machine keys，以便后续生成签名的恶意payload并保持持久性。

**有效性评估：**
提供的 PoC 代码看起来是有效的。它演示了利用 CVE-2025-53770 的基本步骤：向易受攻击的端点发送包含恶意 `__VIEWSTATE` 数据的 HTTP POST 请求，并包含必要的 `Referer` 头。但是，提供的 `VIEWSTATE_PAYLOAD` 只是一个无害的占位符，要实现真正的 RCE，需要用 `ysoserial.net` 生成的 payload 替换它。

**投毒风险评估：**
PoC 代码本身并无明显的恶意行为，但存在轻微的投毒风险。风险在于，如果用户直接使用 PoC，而不理解其工作原理，他们可能会盲目地使用从不可信来源获得的 `__VIEWSTATE` payload，从而可能在自己的环境中引入恶意代码。此外，代码可能并非完全适合所有 SharePoint 环境，可能需要修改才能成功利用。因此，评估的投毒风险约为 5%。这个风险主要体现在用户可能会因为不了解ysoserial生成 payload的原理，从而引入恶意的payload.

**项目地址:** [Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE](https://github.com/Kamal-Hegazi/CVE-2025-53770-SharePoint-RCE)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)