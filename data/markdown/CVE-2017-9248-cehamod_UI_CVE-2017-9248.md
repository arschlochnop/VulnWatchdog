## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 密码学漏洞/信息泄露/任意文件上传/XSS/ViewState Compromise

**影响应用:** Telerik UI for ASP.NET AJAX, Sitefinity

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行、跨站脚本攻击

**影响版本:** Telerik UI for ASP.NET AJAX before R2 2017 SP1, Sitefinity before 10.0.6412.0

**利用条件:** 需要目标系统使用存在漏洞版本的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞源于 Telerik UI for ASP.NET AJAX 组件未能正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。这使得远程攻击者更容易破解加密保护机制，从而导致 MachineKey 泄露，进而可能实现任意文件上传或下载，跨站脚本攻击（XSS），或 ASP.NET ViewState Compromise。 

**有效性：** 漏洞利用代码存在（参考搜索引擎结果和漏洞库信息，以及Exploit-DB上的POC）。许多报告表明该漏洞已在野外被积极利用。 

**投毒风险：** 提供的漏洞利用代码仅包含 Apache 2.0 许可协议。分析表明，当前提供的代码段本身不包含任何恶意或投毒代码，投毒风险为0%。

**利用方式：**

1.  **密钥泄露：** 攻击者利用该漏洞获取 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey。
2.  **ViewState 解密：** 获得 MachineKey 后，攻击者可以解密 ASP.NET ViewState，篡改页面数据。
3.  **XSS 攻击：** 利用解密后的 ViewState 或其他方式注入恶意脚本，执行 XSS 攻击。
4.  **任意文件上传/下载：** 利用泄露的密钥绕过文件上传限制，上传恶意文件（如 webshell），或下载敏感文件。
5.  **远程代码执行：** 结合其他漏洞（如反序列化漏洞）或利用上传的 webshell 执行任意代码。

**搜索引擎结果佐证：** 搜索引擎结果中，CISA 分析报告（MAR-10443863-1.v1）表明 CVE-2017-9248 漏洞已用于部署 webshell。HackerOne 报告 (https://hackerone.com/reports/491668) 提及通过该漏洞暴力破解 MachineKey 并获取访问权限。 SRLabs博客文章 (https://www.srlabs.de/blog-post/telerik-100-times-faster) 描述了在大型企业中成功利用此漏洞的案例。


**项目地址:** [cehamod/UI_CVE-2017-9248](https://github.com/cehamod/UI_CVE-2017-9248)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)