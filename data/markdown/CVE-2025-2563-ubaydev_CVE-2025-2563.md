## CVE-2025-2563 - User Registration & Membership 插件未授权权限提升

**漏洞编号:** CVE-2025-2563

**漏洞类型:** 权限提升

**影响应用:** WordPress User Registration & Membership 插件

**危害等级:** 高危，可导致完全控制受影响的WordPress站点

**影响版本:** <= 4.1.1

**利用条件:** 需要启用 membership add-on 并且注册用户无需确认

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据提供的漏洞利用代码和搜索结果，该漏洞存在于 WordPress User Registration & Membership 插件的 4.1.1 及更早版本中。攻击者可以通过未授权的方式，利用 `prepare_members_data()` 函数中角色类型限制不足的漏洞，在满足插件已激活 membership add-on 并且注册用户无需确认的条件下，创建具有 'administrator' 角色的新用户帐户，从而实现权限提升。

**有效性：**

根据漏洞利用代码中的POC，该漏洞利用方法有效，利用步骤清晰，包括注册普通用户，然后构造特定的POST请求到 `/wp-admin/admin-ajax.php`，其中包含 `action=user_registration_membership_register_member`，并利用 `members_data` 参数设置 `role` 为 `administrator`。如果满足前提条件，服务器将返回成功消息，并且新注册的用户将拥有管理员权限。

搜索结果也确认了该漏洞的存在和高危性，例如， securityonline.info 的文章 "WordPress Plugin CVE-2025-2563 Scores 9.8, Threatens Thousands of Membership Sites" 和 vuldb.com 的报告都描述了此漏洞。

**投毒风险：**

评估仓库中的投毒代码风险较低，大约为5%。原因如下：

*   该漏洞利用代码的主要内容是关于漏洞的描述和利用方法（PoC）。
*   代码中包含免责声明，表明其用途仅为教育和信息目的。
*   PoC 部分清晰地展示了如何构造 HTTP 请求来利用该漏洞，没有发现任何隐藏的、恶意的代码。
*   README.md 文件格式简单，主要包含漏洞描述、PoC、参考链接和作者信息，没有发现可疑的代码或命令执行。
*   虽然存在风险，但考虑到作者公布了自己的收款链接，并详细描述了漏洞利用步骤，恶意投毒的可能性较低。

但是，仍存在极小的投毒风险。例如，作者可能会在其他相关文件中包含恶意代码，或者在描述中留下误导性信息，诱导用户执行危险操作。此外，用户在复制和粘贴 PoC 代码时，可能会引入额外的错误或恶意代码。

**利用方式：**

1.  攻击者首先需要在启用了Membership Add-on的 WordPress 站点上注册一个普通用户账号。
2.  然后，攻击者构造一个 POST 请求到 `/wp-admin/admin-ajax.php`，设置 `action` 参数为 `user_registration_membership_register_member`。
3.  POST 请求的 `members_data` 参数需要包含一个 JSON 对象，其中 `membership` 字段设置为有效的 membership ID，`payment_method` 设置为 `free`，`start_date` 设置为日期，`username` 设置为已注册的用户名，最关键的是 `role` 字段设置为 `administrator`。
4.  `security` 字段需要设置为一个有效的 nonce 值，用于绕过 CSRF 保护。
5.  如果一切顺利，服务器将返回一个 JSON 响应，其中包含 `success: true` 和一条成功消息。
6.  攻击者现在可以使用新注册的管理员帐户登录 WordPress 后台，完全控制该站点。

**项目地址:** [ubaydev/CVE-2025-2563](https://github.com/ubaydev/CVE-2025-2563)

**漏洞详情:** [CVE-2025-2563](https://nvd.nist.gov/vuln/detail/CVE-2025-2563)