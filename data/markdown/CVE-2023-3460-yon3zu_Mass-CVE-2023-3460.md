## CVE-2023-3460 - Ultimate Member Unauthenticated Privilege Escalation

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress 插件

**危害等级:** 高危，允许未经验证的攻击者创建管理员账户，完全控制网站

**影响版本:** < 2.6.7

**利用条件:** 目标网站安装了Ultimate Member插件，并且版本低于2.6.7，注册页面对外开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-3460 是 Ultimate Member WordPress 插件中的一个权限提升漏洞。该漏洞允许未经身份验证的攻击者注册用户时，指定任意用户权限，包括管理员权限。漏洞利用代码通过以下步骤实现：

1.  **版本检测：** 脚本首先尝试通过访问 `readme.txt` 文件来确定目标 Ultimate Member 插件的版本。
2.  **漏洞验证：** 如果版本低于 2.6.7，则认为目标易受攻击。
3.  **获取 Nonce：** 脚本访问注册页面，提取 `_wpnonce` 值，这是一个防止跨站请求伪造 (CSRF) 攻击的安全令牌。
4.  **注册恶意用户：** 脚本构造一个 POST 请求，其中包含新用户的用户名、密码、电子邮件和其他详细信息，以及 `wp_capabilities[administrator]` 参数设置为 1。这会在 WordPress 中创建一个具有管理员权限的新用户。
5.  **发送请求：** 脚本向注册页面发送 POST 请求。
6.  **检查是否成功：** 脚本检查响应状态码是否为 302，如果是，则表明注册成功，攻击者已经创建了一个管理员账户。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞库信息表明该漏洞正在被积极利用。搜索结果也证实了这一点，并提供了多个关于该漏洞的分析和警告。提供的漏洞利用代码尝试自动执行利用过程，成功创建一个管理员账户。

**投毒风险：**
该仓库存在轻微的投毒风险(5%)。漏洞利用代码本身实现了漏洞利用功能，能够创建管理员账户，主要风险在于以下几点：

*   **依赖关系：** 该脚本依赖于 `requests` 和 `colorama` 库，如果这些库被恶意替换，可能会引入恶意代码。
*   **URL修改：** 攻击者可能会修改脚本中的URL，指向恶意的 WordPress 站点。
*   **不安全的URL：** 脚本通过HTTP协议和 `verify=False`来访问URL，容易被中间人攻击,造成信息泄露或者篡改。

**利用方式：**

1.  攻击者运行提供的Python脚本,指定包含目标URL的文件。
2.  脚本针对每个目标URL，尝试检测Ultimate Member插件的版本。
3.  如果版本低于2.6.7，脚本会尝试注册一个具有管理员权限的新用户。
4.  注册成功后，攻击者可以使用新创建的管理员账户登录WordPress后台，并完全控制网站。

**项目地址:** [yon3zu/Mass-CVE-2023-3460](https://github.com/yon3zu/Mass-CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)