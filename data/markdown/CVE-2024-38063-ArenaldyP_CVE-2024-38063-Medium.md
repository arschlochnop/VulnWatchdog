## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2008 through 2022， 具体版本参考漏洞库信息

**利用条件:** 目标系统启用 IPv6，攻击者需要能够发送 IPv6 数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38063 是一个 Windows TCP/IP 远程代码执行漏洞。攻击者通过发送特制的 IPv6 数据包到目标系统，利用 IPv6 协议栈中的整数下溢漏洞触发内存破坏，从而执行任意代码。\n\n**有效性：**\n根据搜索结果（特别是 webpage 4 和 webpage 8）表明，此漏洞存在PoC代码，且已被分析和利用。提供的POC代码是一个基于 Scapy 的 Python 脚本，它构造并发送恶意的 IPv6 数据包来触发该漏洞。脚本包含必要的 IPv6 扩展头部，包括目标选项头部和分片头部。该脚本旨在通过多次发送这些数据包来增加触发漏洞的可能性。\n\n**投毒风险：**\n分析提供的 POC 代码（CVE-2024-38063.py）：\n*   **依赖项：** 依赖于 `scapy` 库，这是一个常用的网络数据包处理库，本身没有恶意行为。\n*   **代码逻辑：** 代码的主要功能是构造并发送特定的 IPv6 数据包，目的是触发目标系统 TCP/IP 协议栈中的漏洞。代码中没有发现任何明显的后门或者恶意行为，例如执行系统命令、上传数据等。脚本只是利用已知漏洞，并没有尝试植入任何额外恶意代码。\n*   **LICENSE 和 README：** LICENSE 文件是 MIT 许可证，允许自由使用、复制、修改和分发代码。README 文件提供了漏洞的简要描述，使用说明，以及如何运行脚本。这些信息看起来是标准且无害的。\n\n综合来看，该 POC 代码的投毒风险较低，估计为 0%。\n\n**利用方式：**\n1.  **环境准备：** 安装 Scapy 库 (`pip3 install scapy`)。\n2.  **配置脚本：** 根据目标系统的 IPv6 地址配置脚本中的 `ip_addr` 变量。如果 Scapy 无法自动获取 MAC 地址，则需要手动配置 `mac_addr` 变量。如果存在多个网络接口，需要配置 `iface` 变量以指定使用的接口。\n3.  **运行脚本：** 运行 Python 脚本 (`python3 CVE-2024-38063.py`)。脚本会构造并发送一系列恶意的 IPv6 数据包。\n4.  **触发漏洞：** 如果目标系统存在漏洞且未打补丁，恶意数据包将触发内存破坏，最终导致远程代码执行。\n\n**缓解措施：**\n*   应用 Microsoft 发布的补丁程序。\n*   禁用 IPv6，但这可能影响某些应用程序的功能。\n*   使用防火墙或入侵检测系统 (IDS) 过滤恶意的 IPv6 数据包。

**项目地址:** [ArenaldyP/CVE-2024-38063-Medium](https://github.com/ArenaldyP/CVE-2024-38063-Medium)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)