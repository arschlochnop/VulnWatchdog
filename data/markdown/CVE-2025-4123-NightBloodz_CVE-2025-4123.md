## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** XSS/SSRF

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，SSRF，以及任意JavaScript执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互，匿名访问开启或攻击者知晓用户身份并诱导点击。安装Grafana Image Renderer插件可以触发SSRF

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-4123是一个存在于Grafana中的跨站脚本(XSS)漏洞，由客户端路径遍历和开放重定向组合导致。攻击者可以利用此漏洞将用户重定向到恶意网站，该网站托管一个可以执行任意JavaScript的前端插件。如果启用了匿名访问，则此漏洞无需编辑权限即可利用。如果安装了Grafana Image Renderer插件，则可以利用开放重定向来实现完整的读取SSRF。

**有效性：**

根据漏洞信息和搜索结果，提供的POC代码旨在利用CVE-2025-4123。它包含一个看似用于创建恶意插件的JSON配置文件 (`data2.json`) 和一段JavaScript代码 (`js.js`)，该代码尝试通过 `PUT` 请求修改Grafana用户的账号信息（name, email, login）。`readme.md` 文件中提供了漏洞描述和利用方式，指向了相关的漏洞报告和复现信息。

**投毒风险：**

`js.js`文件中的代码尝试修改用户信息，这本身就是一种恶意行为，但不是典型的“投毒”。然而，代码的目的是尝试修改用户的帐户信息，例如“pwned”，这可以被认为是轻微的破坏行为。此外,恶意插件本身就可以被认为是投毒的一种方式。从插件设计上来说,存在一定风险. 综合评估投毒风险约为10%。

**利用方式：**

1.  **XSS：** 攻击者首先利用开放重定向漏洞，诱使用户访问构造好的恶意URL。
2.  **插件安装（模拟）：** 该URL会将用户重定向到一个包含恶意插件的页面（或模拟该过程），恶意插件包含JavaScript代码。
3.  **JavaScript执行：** 恶意插件中的JavaScript代码会在用户的浏览器中执行，`js.js` 中的代码尝试修改用户账户信息，并且弹窗显示"account pwned"。
4.  **SSRF（可选）：** 如果目标Grafana实例安装了Grafana Image Renderer插件，攻击者可以利用开放重定向漏洞触发SSRF，读取服务器上的敏感信息。

**总结：** 该漏洞的利用方式涉及XSS、开放重定向和可能的SSRF。攻击者通过诱使用户访问恶意链接，执行恶意JavaScript代码，达到攻击目的。

**项目地址:** [NightBloodz/CVE-2025-4123](https://github.com/NightBloodz/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)