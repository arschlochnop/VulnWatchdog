## CVE-2020-0688 Microsoft Exchange Server 远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** MS Exchange Server 2010 SP3 up to 2019 CU4

**利用条件:** 需要有效的Exchange用户凭证或者能够绕过身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个存在于 Microsoft Exchange Server 的远程代码执行漏洞。该漏洞源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过向服务器发送特制的序列化对象，利用 ViewState 机制进行反序列化操作，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭证：** 攻击者需要拥有Exchange服务器上一个有效用户的用户名和密码。这可以通过多种方式实现，例如网络钓鱼。
2.  **构造恶意 ViewState：** 攻击者构造一个包含恶意代码的 ViewState。该 ViewState 利用 .NET 反序列化漏洞，在服务器上执行攻击者指定的命令。
3.  **发送请求：** 攻击者将包含恶意 ViewState 的请求发送到 Exchange 服务器的 ECP 页面（例如，`/ecp/default.aspx`）。
4.  **执行代码：** Exchange 服务器反序列化 ViewState，执行攻击者提供的恶意代码。

**有效性：** 根据漏洞信息和搜索结果，以及提供的PoC代码，此漏洞是有效的，并且在野外被积极利用。

**投毒风险：** PoC 代码本身包含利用漏洞的代码，主要功能是发送构造好的恶意请求以执行命令。  虽然PoC的目的是展示漏洞利用，但仍需检查是否存在隐藏的后门或恶意功能。 提供的PoC代码来自Packet Storm，并经过了Python3的兼容性修改。代码本身没有明显的恶意行为，但仍存在潜在风险，无法完全排除投毒的可能性。风险评估在10%的原因是，代码中包含从外部站点获取的信息，存在潜在的不确定性。

**利用方式：** 攻击者首先需要获取有效的Exchange用户凭证。然后，利用这些凭证登录到Exchange控制面板，并发送包含恶意构造的ViewState的POST请求。  该ViewState会触发.NET反序列化漏洞，从而允许攻击者在Exchange服务器上执行任意代码。常见的利用方式是添加新的管理员用户，或者执行系统命令来控制服务器。

**项目地址:** [1337-llama/CVE-2020-0688-Python3](https://github.com/1337-llama/CVE-2020-0688-Python3)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)