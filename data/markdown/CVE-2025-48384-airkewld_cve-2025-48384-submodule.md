## CVE-2025-48384-Git配置注入与RCE

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/远程代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户克隆包含恶意配置的Git仓库，且安装的Git版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 漏洞源于Git在处理配置文件时的不一致性，具体来说，是Git在读取和写入包含控制字符（如回车符CR）的配置值时的方式存在差异。当初始化子模块时，如果子模块路径包含尾随CR，则修改后的路径会被读取，导致子模块被检出到错误的位置。如果存在一个符号链接将修改后的路径指向子模块钩子目录，并且子模块包含一个可执行的post-checkout钩子，则该脚本可能会在检出后被意外执行，从而导致任意代码执行。

**有效性分析：**

根据提供的漏洞利用代码，`post-checkout` 文件包含 shell 命令 `echo "RCE"` 和 `touch /tmp/rce.txt`。 该 POC 通过在恶意 Git 仓库中设置恶意的 `post-checkout` 钩子，当存在漏洞的 Git 客户端克隆包含该恶意仓库并递归初始化子模块时，就会触发该钩子，从而在目标系统上执行任意命令，验证 POC 的有效性。

**投毒风险分析：**

在提供的POC代码中，`README.md` 文件主要用于描述仓库，本身不包含恶意代码。`post-checkout` 文件中包含 `echo` 和 `touch` 命令，用于验证 RCE 是否成功。虽然这两个命令本身没有危害，但如果攻击者在 `post-checkout` 脚本中添加更复杂的恶意代码（例如下载并执行其他恶意程序），则可能存在投毒风险。评估当前代码，投毒风险较低，初步估计为10%。

**利用方式：**

1.  攻击者创建一个包含恶意配置和子模块的Git仓库。
2.  恶意配置包含带有尾随CR的子模块路径，该路径被符号链接指向`.git/hooks`目录。
3.  子模块包含一个名为 `post-checkout` 的可执行钩子，其中包含要执行的恶意代码。
4.  攻击者诱使用户克隆并递归初始化该仓库（例如，使用`git clone --recursive`）。
5.  当 Git 处理子模块时，由于配置处理的缺陷，恶意 `post-checkout` 钩子会被触发，导致在用户计算机上执行任意代码。

**优先级依据：**

在漏洞分析过程中，搜索引擎结果提供了漏洞的概况、影响、利用情况等信息，有助于全面了解漏洞。漏洞利用代码提供了直接的利用方法，有助于验证漏洞的有效性并深入理解漏洞原理。漏洞库信息提供了漏洞的官方描述和修复方案，有助于确认漏洞的存在和修复方法。综合考虑这些信息来源，可以更准确地评估漏洞的风险和利用方式。

**项目地址:** [airkewld/cve-2025-48384-submodule](https://github.com/airkewld/cve-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)