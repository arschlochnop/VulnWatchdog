## CVE-2025-24054-NTLM Hash Disclosure Spoofing

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM哈希泄露欺骗

**影响应用:** Windows NTLM

**危害等级:** 中危，可能导致凭据泄露和网络欺骗

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要诱使用户访问恶意.library-ms文件，并监听攻击者服务器上的NTLM认证请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24054是一个Windows NTLM哈希泄露欺骗漏洞。该漏洞源于Windows NTLM处理文件路径的方式，允许未经授权的攻击者通过网络执行欺骗攻击，从而捕获受害者的NTLM哈希。攻击者可以通过精心制作的`.library-ms`文件诱使用户访问，当用户打开该文件时，Windows将尝试访问文件中指定的UNC路径，从而触发NTLM认证。攻击者可以在自己的服务器上监听此NTLM认证请求，进而捕获用户的NTLM哈希。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已在野外被积极利用，PoC代码有效。

**投毒风险：**
PoC代码本身相对简单，主要用于生成包含恶意UNC路径的`.library-ms`文件。 投毒风险较低，约为5%。潜在的风险可能来自于：

1.  **UNC路径指向恶意服务器：** 攻击者可以修改UNC路径，使其指向一个包含恶意软件的服务器，当受害者尝试访问该路径时，可能会下载并执行恶意软件。
2.  **文件名欺骗：** 攻击者可以精心构造文件名，例如使用与常用文件名相似的名称，诱骗用户打开。

**利用方式：**
1.  **准备攻击环境：** 攻击者需要设置一个服务器，例如使用Responder或Impacket的`smbserver.py`，用于监听NTLM认证请求。
2.  **生成恶意`.library-ms`文件：** 使用PoC代码，指定攻击者服务器的IP地址或域名，生成包含恶意UNC路径的`.library-ms`文件。
3.  **诱骗受害者打开文件：** 攻击者需要通过某种方式（例如，钓鱼邮件、社交工程）诱骗受害者打开`.library-ms`文件。受害者可以通过文件共享，U盘或者web下载等方式获取该文件。
4.  **捕获NTLM哈希：** 当受害者打开文件时，Windows将尝试访问恶意UNC路径，攻击者的服务器将接收到NTLM认证请求，并捕获用户的NTLM哈希。
5.  **利用NTLM哈希：** 攻击者可以使用捕获的NTLM哈希进行后续攻击，例如，进行密码破解或者传递哈希攻击（Pass-the-Hash）。

**项目地址:** [S4mma3l/CVE-2025-24054](https://github.com/S4mma3l/CVE-2025-24054)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)