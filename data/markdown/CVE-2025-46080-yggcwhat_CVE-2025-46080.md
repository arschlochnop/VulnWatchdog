## HuoCMS <=V3.5.1 任意文件重命名导致任意代码执行漏洞

**漏洞编号:** CVE-2025-46080

**漏洞类型:** 任意文件重命名导致任意代码执行

**影响应用:** HuoCMS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <=V3.5.1

**利用条件:** 需要后台权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于HuoCMS的AttachmentController.php的editFileUrl方法中。

**利用方式：**

1.  攻击者首先上传一个后缀在白名单内的文件，该文件包含恶意代码 (例如，PHP webshell)，并记录上传后的文件ID。
2.  攻击者构造一个POST请求到/attachment/editFileUrl，修改该文件的名称，通过`suffix_url`参数将文件后缀改为恶意后缀（例如`.php`）。由于`copy`函数没有对`suffix_url`进行充分的校验，恶意后缀可以被写入。
3. 访问重命名后的文件，执行其中的恶意代码。

**有效性：**

提供的POC代码有效，详细描述了如何利用该漏洞进行攻击。

**投毒风险：**

该漏洞利用代码本身展示的是文件上传和重命名功能，但是，文件上传部分的代码可能被用于上传包含恶意Payload的文件，因此存在一定的投毒风险，但主要风险在于利用漏洞本身，而非POC代码内嵌恶意代码，因此，投毒风险较低。风险主要在于使用者是否会使用该POC上传恶意的文件。尽管如此，仍然存在作者在代码中加入隐蔽后门的可能性，例如，通过修改上传路径或添加隐藏参数来执行恶意操作。 但是从代码分析来看，直接后门可能性较低，所以判定投毒风险为10%。

**项目地址:** [yggcwhat/CVE-2025-46080](https://github.com/yggcwhat/CVE-2025-46080)

**漏洞详情:** [CVE-2025-46080](https://nvd.nist.gov/vuln/detail/CVE-2025-46080)