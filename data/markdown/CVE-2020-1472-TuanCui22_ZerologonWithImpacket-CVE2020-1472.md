## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控被完全控制

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2等。

**利用条件:** 攻击者需要位于与域控制器相同的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon远程协议（MS-NRPC）中的特权提升漏洞。攻击者可以利用此漏洞通过将域控制器的计算机账号密码置零来接管域。 

**有效性：**
根据漏洞库信息、搜索结果和提供的impacket代码仓库信息来看，此漏洞的POC代码是有效的。大量公开的POC和利用脚本存在，并且该漏洞已被广泛利用。

**投毒风险：**
提供的代码片段是impacket的ChangeLog.md文件，它记录了impacket项目的更新日志。Impacket是一个常用的Python库，被安全研究人员和渗透测试人员广泛使用，用于处理网络协议。虽然Impacket本身是一个合法的安全工具，但如果从不可信的来源下载或使用修改过的版本，则可能存在投毒风险。分析提供的ChangeLog.md，并没有发现直接的投毒代码。但是由于该项目代码量巨大，并且可以通过引入恶意模块进行投毒，所以存在一定的投毒风险。综合考虑，风险值大约在10%。

**利用方式：**
1.  **连接域控制器：** 攻击者使用MS-NRPC协议连接到目标域控制器。
2.  **密码置零：** 攻击者通过精心构造的Netlogon请求，将域控制器的计算机账号密码重置为空。
3.  **获取域管理员权限：** 密码置零后，攻击者可以使用该计算机账号来请求Kerberos票据，并最终获得域管理员权限。
4.  **完全控制域：** 攻击者获得域管理员权限后，可以执行任何操作，包括窃取数据、安装恶意软件、创建新的账号等。

**项目地址:** [TuanCui22/ZerologonWithImpacket-CVE2020-1472](https://github.com/TuanCui22/ZerologonWithImpacket-CVE2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)