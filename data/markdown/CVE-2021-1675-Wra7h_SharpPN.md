## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本：Windows 7, Windows 8.1, Windows 10 (多个版本), Windows Server (多个版本)，具体版本和补丁信息参考漏洞库信息

**利用条件:** 需要网络可访问目标系统的Print Spooler服务，部分利用方式可能需要域环境。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-1675，又名PrintNightmare，是一个Windows Print Spooler服务的远程代码执行漏洞。攻击者可以通过未经授权的方式调用 `RpcAddPrinterDriverEx()` 函数，上传恶意驱动程序，从而在目标系统上以SYSTEM权限执行任意代码。

**漏洞利用方式：**

1.  **DLL注入：** 攻击者利用漏洞上传并加载恶意的DLL文件到Print Spooler服务进程中。该DLL文件包含攻击者的payload，一旦加载，payload将在SYSTEM权限下执行。
2.  **远程添加打印机驱动：** 攻击者通过网络，利用 `RpcAddPrinterDriverEx()` 函数，远程向目标系统添加恶意的打印机驱动程序。由于Print Spooler服务以SYSTEM权限运行，因此恶意驱动程序的安装过程也将在SYSTEM权限下进行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞存在有效的POC代码。多个安全研究人员和组织已经确认了该漏洞的可利用性，并发布了相应的利用代码。

**投毒风险：**

提供的代码片段是GPL协议，虽然不是直接的漏洞利用代码，但是间接的说明此项目是开源项目，任何人都可以修改并分发。因此存在潜在的投毒风险。评估如下：

*   **POC代码审查：** 即使是POC代码，也可能存在恶意修改。需要仔细审查代码逻辑，确保其行为符合预期，不存在隐藏的后门或恶意功能。

*   **依赖项审查：** POC代码可能依赖于其他库或组件。需要审查这些依赖项的来源和安全性，确保它们没有被篡改或包含恶意代码。

*   **代码来源审查：**  需要确认代码托管平台的信誉。如果代码来自不知名的来源或可疑的开发者，则需要格外警惕。

基于以上分析，**投毒风险预估为10%**。 主要是因为提供的代码片段并非直接的利用代码，而是一个license文件，只能推断存在一定的风险，但风险较低。需要对完整的POC代码进行安全审计，才能准确评估投毒风险。

**项目地址:** [Wra7h/SharpPN](https://github.com/Wra7h/SharpPN)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)