## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名，为后续攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要能够与目标 OpenSSH 服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 是 OpenSSH 7.7 及之前版本中的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户认证请求时，没有延迟 bailout，这使得攻击者可以通过观察服务器响应时间的差异来判断用户名是否存在。

**有效性：**
提供的 Python 脚本（openssh.py）是利用 CVE-2018-15473 漏洞的 PoC 代码。它通过修改 `paramiko` 库中的认证处理逻辑，构造特殊的认证请求。根据目标服务器对有效和无效用户的响应差异，来判断用户名是否存在。 根据描述，该代码已经被修改为兼容 Python3，并修复了 `paramiko` 库版本更新后导致的问题，因此更具有有效性。

**投毒风险：**
代码主要逻辑是修改 `paramiko` 的认证流程并探测用户名是否存在，虽然修改了 `paramiko` 库内部的处理函数，但没有发现明显的恶意代码。虽然 `paramiko` 是一个第三方库，存在被供应链攻击的风险，但是这段代码本身主要是为了利用这个漏洞进行枚举用户，没有发现执行任意代码或者植入后门的逻辑。但是也存在一定的风险，作者有可能通过细微的修改来收集用户信息，所以综合评估投毒风险为 10%。

**利用方式：**
1.  **环境准备：** 确保目标 OpenSSH 服务器版本低于或等于 7.7，安装 Python 和 `paramiko` 库。
2.  **脚本配置：** 修改脚本中的目标主机和端口。
3.  **用户名列表：** 提供一个用户名列表，可以是单个用户名或包含多个用户名的文件。
4.  **执行脚本：** 运行脚本，脚本将尝试使用提供的用户名进行认证，并根据服务器响应判断用户是否存在。
5.  **结果分析：** 脚本输出有效的用户名列表。

搜索结果也证实了这个漏洞的存在以及受影响的版本范围，多个安全厂商发布了相关的安全公告。

**项目地址:** [Dirty-Racoon/CVE-2018-15473-py3](https://github.com/Dirty-Racoon/CVE-2018-15473-py3)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)