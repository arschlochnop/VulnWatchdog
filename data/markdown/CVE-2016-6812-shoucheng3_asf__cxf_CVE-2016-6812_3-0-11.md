## CVE-2016-6812-Apache CXF-XSS

**漏洞编号:** CVE-2016-6812

**漏洞类型:** XSS

**影响应用:** Apache CXF

**危害等级:** 中危，可能导致客户端受到恶意脚本攻击

**影响版本:** prior to 3.0.12, 3.1.x prior to 3.1.9

**利用条件:** 需要目标服务器运行存在漏洞的Apache CXF版本，并能够访问服务列表页面

**POC 可用性:** 否

**投毒风险:** 5%

## 详情

CVE-2016-6812 是 Apache CXF 中的一个跨站脚本 (XSS) 漏洞。该漏洞存在于 HTTP 传输模块中，具体来说是 FormattedServiceListWriter 类。当 FormattedServiceListWriter 用于生成服务端点列表的 HTML 页面时，它会使用 HttpServletRequest 来计算基本 URL，然后使用此基本 URL 构建服务端点的绝对 URL。如果攻击者能够在请求 URL 中注入恶意的 matrix 参数，这些参数将会被包含在生成的 HTML 页面中的服务列表 URL 中，从而导致 XSS 攻击。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响特定版本的 Apache CXF。但是，提供的“漏洞利用代码” 实际上是 Apache CXF 的构建说明文件 (`BUILDING.txt`) 和 Jenkinsfile 文件, 并不是用于直接利用 CVE-2016-6812 的 POC 代码。因此，从提供的文件来看，不存在有效的直接可用的POC。

**投毒风险：**
提供的构建说明文件 (`BUILDING.txt`) 和 Jenkinsfile 文件，本身不包含任何恶意代码，主要用于构建 Apache CXF 项目。Jenkinsfile 主要用于自动化构建和测试流程。 投毒风险较低, 评估为5%。

**利用方式：**
要利用 CVE-2016-6812，攻击者需要：

1.  找到一个运行着受影响的 Apache CXF 版本的应用程序。
2.  确定服务列表页面的 URL。
3.  构造包含恶意 matrix 参数的 URL，例如 `http://example.com/services;x=<script>alert('XSS')</script>`
4.  诱导用户访问此恶意 URL。

当用户访问恶意 URL 时，恶意脚本将被执行，从而导致 XSS 攻击。

**项目地址:** [shoucheng3/asf__cxf_CVE-2016-6812_3-0-11](https://github.com/shoucheng3/asf__cxf_CVE-2016-6812_3-0-11)

**漏洞详情:** [CVE-2016-6812](https://nvd.nist.gov/vuln/detail/CVE-2016-6812)