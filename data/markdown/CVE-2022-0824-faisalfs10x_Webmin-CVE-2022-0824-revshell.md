## CVE-2022-0824 - Webmin Improper Access Control to RCE

**漏洞编号:** CVE-2022-0824

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高危，攻击者可利用此漏洞在受影响的系统上执行任意代码。

**影响版本:** < 1.990

**利用条件:** 需要Webmin登录凭据 (低权限用户即可)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-0824是Webmin中的一个权限控制漏洞，存在于1.990版本之前。根据漏洞信息和搜索结果，该漏洞允许已经通过身份验证的低权限用户，在未配置File Manager模块限制的情况下，利用File Manager访问并执行具有root权限的文件，从而实现远程代码执行。利用方式为：

1.  攻击者需要拥有Webmin的有效登录凭据 (低权限用户即可)。
2.  攻击者利用File Manager模块的权限绕过漏洞。
3.  攻击者通过上传恶意`.cgi`脚本到服务器（该脚本包含反弹shell的payload）。
4.  攻击者修改该脚本的权限，使其可执行。
5.  攻击者执行该脚本，建立一个反弹shell连接到攻击者控制的服务器，并获得root权限。

**有效性：** 提供的POC代码通过模拟上述步骤，自动化了漏洞利用过程，因此是有效的。

**投毒风险：** 虽然POC代码本身旨在利用漏洞，但仍存在微小的投毒风险，约5%。这种风险主要来源于以下几个方面：

*   **恶意Payload：** 攻击者可能在`.cgi`脚本中嵌入其他恶意代码，例如后门或数据窃取程序，从而扩大攻击范围。
*   **依赖项风险：** POC代码依赖于第三方库，如果这些库被恶意修改，可能会导致POC执行恶意行为。
*   **基础设施风险：** 托管`.cgi`脚本的HTTP服务器可能被攻陷，导致提供恶意payload。

然而，考虑到该POC的主要功能是实现RCE，并且代码结构相对简单，核心功能集中在利用漏洞和执行命令上，因此直接在POC代码中加入大规模、隐蔽的投毒代码的可能性较低。更可能的投毒方式是替换或修改`.cgi` payload。

**搜索引擎结果补充：** 搜索引擎结果提供了漏洞的更多信息，包括NVD的漏洞细节、Broadcom的安全公告、Wiz的漏洞分析、以及GitHub上的POC等。这些信息进一步证实了漏洞的存在和可利用性，以及其潜在的风险。

**项目地址:** [faisalfs10x/Webmin-CVE-2022-0824-revshell](https://github.com/faisalfs10x/Webmin-CVE-2022-0824-revshell)

**漏洞详情:** [CVE-2022-0824](https://nvd.nist.gov/vuln/detail/CVE-2022-0824)