## CVE-2025-8088 WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** Path Traversal

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意构造的RAR压缩包

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-8088是一个WinRAR中的路径遍历漏洞。攻击者可以利用特制的RAR压缩文件，将恶意payload写入任意目录，最常见的利用方式是写入启动目录以实现持久化。提供的漏洞利用代码包含一个Python脚本（CVE-2025-8088.py），它会创建一个恶意的RAR文件。该RAR文件利用路径遍历漏洞将payload放置到Windows启动文件夹，从而实现开机自启动。此外，还使用了ADS（Alternate Data Streams）来隐藏payload。从给定的代码来看，该漏洞利用方式比较直接，但是也存在一定的投毒风险，主要体现在:

1.  **installers 目录:** `BIN_PATH = os.path.join(BASE_DIR, "bin", "installers", "MyAppInstaller.exe")` 存在一个名为`MyAppInstaller.exe`的文件, 这个文件没有在代码中体现任何功能, 存在恶意代码的可能性。
2.  **配置文件的灵活性：**`config.py` 文件允许用户自定义`PAYLOAD`变量。如果用户不小心使用了恶意payload，可能会导致自身系统受到感染。
3.  **依赖外部程序：** 利用需要目标系统安装WinRAR。如果WinRAR版本高于受影响版本，则漏洞可能无法利用。

漏洞利用过程大致如下：

1.  利用 `CVE-2025-8088.py` 生成恶意的RAR文件。
2.  该RAR文件包含利用路径遍历漏洞构造的文件结构。
3.  当用户使用WinRAR解压该RAR文件时，其中的payload会被释放到指定的启动目录，例如`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`。
4.  Payload利用`ADS`技术隐藏到文件流中，迷惑性较强。
5.  Payload（例如payload.bat）会被执行，从而实现恶意代码的执行。

虽然脚本声明用于教育目的，但如果用户不小心运行或配置错误，仍可能导致安全风险。MyAppInstaller.exe存在未知风险,因此存在20%投毒的可能性。

**项目地址:** [aldisakti2/CVE-2025-8088-BUILDER-Winrar-Tool](https://github.com/aldisakti2/CVE-2025-8088-BUILDER-Winrar-Tool)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)