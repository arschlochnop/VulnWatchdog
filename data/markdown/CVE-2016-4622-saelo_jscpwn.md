## CVE-2016-4622 - WebKit 内存损坏导致任意代码执行

**漏洞编号:** CVE-2016-4622

**漏洞类型:** 内存损坏

**影响应用:** Apple iOS, Safari, tvOS (WebKit)

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** iOS < 9.3.3, Safari < 9.1.2, tvOS < 9.2.2

**利用条件:** 受害者需要访问包含恶意 JavaScript 代码的网页

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-4622 是 Apple WebKit 中的一个内存损坏漏洞，允许远程攻击者通过精心设计的网站执行任意代码或造成拒绝服务。根据漏洞库信息，此漏洞与 CVE-2016-4589, CVE-2016-4623 和 CVE-2016-4624 不同。搜索结果表明，该漏洞是 JavaScriptCore 引擎中的一个问题，特别与 `Array.prototype.slice` 相关。该漏洞允许绕过同源策略（SOP），使得攻击者可以访问其他域的数据。提供的POC代码利用了这个漏洞，目标是绕过同源策略以获取用户的 Gmail 收件箱内容。代码通过操作 JavaScriptCore 的内部对象（例如 `JSXMLHttpRequest`, `XMLHttpRequest`, `ScriptExecutionContext`, `SecurityOriginPolicy`, `SecurityOrigin`）来修改 `m_universalAccess` 标志，从而禁用同源策略。代码包含详细的内存地址打印，展示了漏洞利用的过程。有效性：根据提供的代码和搜索结果（特别是来自 github 的分析），POC代码应该是有效的，如果目标环境满足漏洞存在的版本条件。投毒风险：在代码中，`LICENSE` 和 `README.md` 文件看起来是标准的，未发现可疑代码。`email.html`, `int64.js` 和 `pwn.js` 文件都专注于利用该漏洞。`utils.js` 未提供，无法分析。在所提供的代码中未发现明显的后门，但考虑到攻击者可能在未提供的依赖文件中植入恶意代码，或者利用其他的 side effect 执行恶意操作，因此仍然存在一定的投毒风险，估计为10%。利用方式：
1.  攻击者创建一个恶意网页，其中包含利用 CVE-2016-4622 漏洞的 JavaScript 代码。
2.  受害者使用受影响版本的 Safari 或其他使用 WebKit 的浏览器访问该网页。
3.  JavaScript 代码利用 `Array.prototype.slice` 的漏洞，在内存中读写数据，获得对 JavaScriptCore 内部对象的控制权。
4.  通过修改 `SecurityOrigin` 对象的 `m_universalAccess` 标志，禁用同源策略。
5.  攻击者现在可以向其他域发送请求（例如 Gmail），并读取响应数据，从而窃取敏感信息。

**项目地址:** [saelo/jscpwn](https://github.com/saelo/jscpwn)

**漏洞详情:** [CVE-2016-4622](https://nvd.nist.gov/vuln/detail/CVE-2016-4622)