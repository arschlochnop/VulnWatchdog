## CVE-2023-26360 - Adobe ColdFusion Improper Access Control Arbitrary code execution

**漏洞编号:** CVE-2023-26360

**漏洞类型:** 代码执行

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** CF2018U15 及更早版本, CF2021U5 及更早版本

**利用条件:** 目标服务器运行存在漏洞的 ColdFusion 版本，并且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于不当的访问控制导致的任意代码执行。利用过程如下：

1.  **利用方式：**
    *   首先，攻击者利用漏洞将恶意 CFML 代码注入到 `coldfusion-out.log` 文件中。POC提供了一个工具来自动化生成包含反弹shell代码的Java字节码文件，并通过web服务提供下载。
    *   第一步是通过发送特定的POST请求到 `/cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/iedit.cfc?method=zfgea&_cfclient=true`，其中`_variables`参数包含恶意的CFML代码，该代码的功能是尝试从攻击者控制的URL下载一个class文件 (`http://192.168.191.58:8888/GjfZgo`) 并执行。
    *   然后，攻击者通过发送另一个 POST 请求到相同端点，但这次的 `_variables` 参数包含了指向 `coldfusion-out.log` 文件的 `classname`。ColdFusion 将会尝试加载并执行该日志文件中的代码，从而执行攻击者注入的恶意 CFML 代码。
2.  **有效性：**
    *   根据提供的漏洞库信息和利用代码，该漏洞利用方法看起来是有效的。漏洞库信息表明该漏洞在野外被积极利用，CISA也将其添加到已知被利用的漏洞目录中。
3.  **投毒风险：**
    *   POC利用需要先启动web服务提供payload的下载，然后利用注入将payload写入日志，最后通过指定日志方式进行加载，作者可能在提供下载的class文件中植入后门。
    *   `投毒风险：10%`  该数值代表对此代码的风险评估较低，代码的功能比较明确，只是作为一个自动化的生成工具，但无法完全排除开发者植入其他恶意代码的可能性。

**项目地址:** [CuriousLearnerDev/ColdFusion_EXp](https://github.com/CuriousLearnerDev/ColdFusion_EXp)

**漏洞详情:** [CVE-2023-26360](https://nvd.nist.gov/vuln/detail/CVE-2023-26360)