## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor或/phpunit目录，且允许外部访问Util/PHP/eval-stdin.php文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。该文件允许通过 HTTP POST 请求执行任意 PHP 代码，前提是 POST 数据以 "<?php " 开头。漏洞利用方式如下：

1.  **漏洞定位：** 攻击者需要找到目标服务器上暴露的 `eval-stdin.php` 文件，常见路径包括 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 或其他在提供的 POC 代码中列出的路径。
2.  **构造 Payload：** 攻击者构造一个 HTTP POST 请求，将包含恶意 PHP 代码的数据发送到 `eval-stdin.php` 文件。Payload 必须以 `<?php` 开头。
3.  **执行代码：** 服务器会执行 POST 请求中的 PHP 代码，从而允许攻击者在服务器上执行任意操作。 

**有效性评估：**

根据漏洞描述和提供的 POC 代码，该漏洞利用方式是有效的。POC 代码通过发送包含 `<?php die(@md5(Apri1));?>` 的 POST 请求来验证漏洞是否存在。如果服务器返回 `c0eb89e1d7f2982390f96603e66f2b6b` (Apri1 的 MD5 值)，则表示漏洞存在。

**投毒风险评估：**

提供的 POC 代码主要功能是验证漏洞是否存在，并没有发现明显的恶意或隐藏代码。该脚本旨在检测目标是否存在漏洞，而非植入恶意后门。因此，投毒风险评估为 0%。脚本行为符合其声称的功能，即检查目标服务器上是否存在 CVE-2017-9841 漏洞。

**项目地址:** [ludy-dev/PHPUnit_eval-stdin_RCE](https://github.com/ludy-dev/PHPUnit_eval-stdin_RCE)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)