## CVE-2019-5418 - Rails 文件内容泄露

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 and v3

**利用条件:** 需要目标应用程序调用 `render file:` 且没有指定 accept format。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418 是一个 Rails Action View 组件中的文件内容泄露漏洞。攻击者可以通过构造特殊的 `Accept` 头，结合应用程序中存在的 `render file:` 调用，读取服务器上的任意文件内容。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果以及漏洞利用代码，可以确认该漏洞利用的有效性。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中也包含多个关于此漏洞的描述、分析和利用方法。POC 代码展示了如何通过修改 `Accept` 头来利用该漏洞，读取 `/etc/passwd` 文件。

**投毒风险:**
检查提供的 POC 代码，没有发现任何明显的投毒代码。提供的代码包括：
*   README.md：描述了漏洞信息、技术分析和安全建议。
*   Action View 的修复补丁：显示了如何修复该漏洞。
*   demo 文件夹：包含一个易受攻击的 Rails 应用程序，以及利用步骤
这些代码片段的目的是演示和重现该漏洞，而不是引入恶意代码。因此，投毒风险评估为 0%。

**利用方式:**
1.  运行一个受影响版本的 Rails 应用程序，且应用程序代码中存在使用 `render file:` 但未明确指定 accept format 的调用。
2.  构造一个 HTTP 请求，修改 `Accept` 头为包含路径遍历字符串，例如 `Accept: ../../../../../../../../../../etc/passwd{{`。
3.  发送该请求到存在漏洞的路由。
4.  服务器将返回指定文件的内容，从而导致敏感信息泄露。

简单来说，利用方式是利用Rails处理`Accept` Header的缺陷，通过路径遍历读取任意文件。

**项目地址:** [mpgn/CVE-2019-5418](https://github.com/mpgn/CVE-2019-5418)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)