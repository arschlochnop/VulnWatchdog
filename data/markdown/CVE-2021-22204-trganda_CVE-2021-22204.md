## CVE-2021-22204-ExifTool-DjVu-代码执行

**漏洞编号:** CVE-2021-22204

**漏洞类型:** 代码执行

**影响应用:** ExifTool

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** >=7.44, <12.24

**利用条件:** 需要用户使用受影响版本的 ExifTool 处理恶意 DjVu 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-22204 漏洞存在于 ExifTool 的 DjVu 文件解析模块中。攻击者可以构造恶意的 DjVu 文件，当 ExifTool 解析该文件时，其中的恶意代码会被执行。该漏洞的利用方式是通过在 DjVu 文件的特定字段中注入 Perl 代码，由于 ExifTool 在处理 DjVu 文件时使用了 `eval` 函数来动态执行这些字段中的内容，从而导致代码执行。从提供的漏洞信息来看，该漏洞的攻击向量为 LOCAL，攻击复杂度为LOW，无需用户交互即可触发。提供的漏洞利用代码是一个Apache License 2.0协议文件，不是漏洞利用代码，因此无法判断其有效性，但是漏洞库信息中提到存在公开可用的PoC。检查提供的LICENSE文件，未发现任何恶意或投毒代码，因此投毒风险为0%。漏洞利用方式总结：上传恶意构造的DjVu文件到使用了存在漏洞版本ExifTool的服务器/客户端，通过ExifTool解析该文件，触发代码执行。

**项目地址:** [trganda/CVE-2021-22204](https://github.com/trganda/CVE-2021-22204)

**漏洞详情:** [CVE-2021-22204](https://nvd.nist.gov/vuln/detail/CVE-2021-22204)