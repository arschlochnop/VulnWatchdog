## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问 SharePoint Server

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于反序列化不可信数据导致。攻击者可以通过网络发送恶意构造的请求，利用此漏洞在目标服务器上执行任意代码。

**漏洞有效性评估：**

*   漏洞库信息显示，该漏洞 CVSS 评分为 9.8，属于严重级别，并且已知存在在野利用。
*   搜索引擎结果证实了该漏洞正在被积极利用，并且 CISA 已发布了相关的恶意软件分析报告。
*   虽然提供的漏洞利用代码是关于一个用于检测漏洞利用的honeypot， 但`README.md`中明确指出覆盖了CVE-2025-53770，说明此漏洞是真实存在的，可以通过构造请求触发。

因此，可以确定该漏洞是有效的。

**投毒风险分析：**

提供的代码是一个honeypot，其目的是捕获针对 SharePoint 漏洞的攻击尝试。虽然代码本身不包含直接的恶意负载，但存在以下潜在风险：

1.  **误报/漏报：** YARA 规则或检测逻辑可能存在缺陷，导致误报或漏报攻击尝试。这可能会影响对威胁的准确评估。
2.  **信息泄露：** Honeypot 可能会收集敏感信息，例如 IP 地址、请求内容等。如果honeypot本身存在安全漏洞，这些信息可能会被泄露。
3.  **资源消耗：** 如果honeypot部署不当，可能会消耗大量资源，例如 CPU、内存和磁盘空间，从而影响正常业务。

代码中构建的YARA规则存在被绕过的可能性,攻击者可以通过构造特定的payload绕过检测，从`README.md`描述来看，该honeypot不模拟完整的SharePoint环境，因此攻击者在初始响应后可能会意识到这是一个蜜罐。

综合考虑，投毒风险较低，约10%。

**利用方式：**

根据漏洞描述，该漏洞是由于在本地 Microsoft SharePoint Server 中反序列化不可信数据而导致的。因此，利用方式主要涉及以下步骤：

1.  **确定目标：** 找到存在漏洞的 SharePoint Server 实例。
2.  **构造恶意负载：** 创建包含恶意代码的反序列化 payload。这通常涉及使用 .NET 反序列化漏洞利用工具，例如 ysoserial.net。
3.  **发送请求：** 将恶意负载作为 HTTP 请求的一部分发送到 SharePoint Server。请求的具体 endpoint 可能需要根据具体的漏洞利用链确定，根据搜索引擎结果分析，可能和ToolPane有关。
4.  **代码执行：** 如果漏洞利用成功，服务器将反序列化恶意负载并执行其中的代码。

总而言之，CVE-2025-53770 是一个严重的安全漏洞，需要及时修复。部署honeypot可以帮助检测针对该漏洞的攻击尝试，但需要注意潜在的风险。

**项目地址:** [bitsalv/ToolShell-Honeypot](https://github.com/bitsalv/ToolShell-Honeypot)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)