## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务器运行存在漏洞的Request-Baskets实例，且攻击者可以访问该实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及以前版本中存在的服务器端请求伪造 (SSRF) 漏洞。通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，攻击者可以强制服务器向任意目标发起请求。根据漏洞利用代码，攻击者通过创建一个包含 `forward_url` 参数的 basket，该参数指向攻击者控制的服务器或内部网络资源。服务器会代理所有发送到该 basket 的请求到 `forward_url` 指定的地址。

**有效性：**
根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以判断该漏洞是有效的，并且存在公开的POC。

**投毒风险：**
提供的脚本 `CVE-2023-27163.sh` 主要功能是创建具有转发功能的“basket”。虽然脚本本身没有明显的恶意代码，但用户在使用时需要注意以下几点：

1.  **目标服务器：**  脚本允许指定任意 `TARGET` 作为转发目标。如果攻击者控制了公共 Request-Baskets 实例，并将其转发到恶意服务器，则可能窃取用户的请求数据。
2.  **依赖外部命令：**  脚本依赖于 `curl` 和 `jq` 命令。如果这些命令被恶意替换，则可能执行恶意代码。但这种风险并非脚本本身引入，而是系统环境的风险。
3.  **创建的 Basket 长期存在：**  一旦创建了具有转发功能的 Basket，它将一直存在，除非被手动删除。如果攻击者创建了一个长期存在的恶意 Basket，可能会持续地捕获用户的请求。

由于脚本功能本身是利用漏洞进行请求转发，因此不能简单地将所有风险都归结为“投毒”。投毒风险主要来自于用户对脚本使用的环境和目标的信任程度。如果用户从不可信的来源下载脚本，或者将其应用于不可信的 Request-Baskets 实例，则存在一定的风险。此外，README.md 文件中的示例命令没有问题。

**利用方式：**
1.  攻击者使用 PoC 脚本创建一个恶意的 basket，并指定内部服务（例如，只能从本地访问的数据库管理界面）的 URL 作为 `forward_url`。
2.  当受害者（例如，管理员）访问该 basket 的 URL 时，Request-Baskets 服务器会向内部服务发起请求，并将响应返回给攻击者。
3.  通过这种方式，攻击者可以绕过防火墙或其他访问控制机制，访问内部网络资源。
4.  攻击者还可以使用该漏洞来探测内部网络，发现潜在的攻击目标。

**项目地址:** [MasterCode112/CVE-2023-27163](https://github.com/MasterCode112/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)