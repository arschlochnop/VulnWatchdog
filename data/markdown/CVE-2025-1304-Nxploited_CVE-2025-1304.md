## CVE-2025-1304-NewsBlogger-Arbitrary File Upload

**漏洞编号:** CVE-2025-1304

**漏洞类型:** Arbitrary File Upload

**影响应用:** NewsBlogger Theme for WordPress

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.2.5.1

**利用条件:** 需要subscriber或以上权限的WordPress账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1304是WordPress NewsBlogger主题中的一个任意文件上传漏洞。由于`newsblogger_install_and_activate_plugin()`函数缺少权限检查，经过身份验证的攻击者（subscriber级别及以上）可以上传任意文件到服务器，可能导致远程代码执行。

**漏洞利用方式：**

1.  攻击者需要拥有受影响WordPress站点的subscriber或以上权限的账户。
2.  攻击者使用提供的Python脚本，该脚本执行以下操作：
    *   使用提供的用户名和密码登录WordPress站点。
    *   从welcome页面提取nonce值，用于绕过CSRF保护。
    *   构造一个包含恶意插件URL的POST请求，发送到`admin-ajax.php`，触发`newsblogger_install_activate_plugin`操作。
    *   如果服务器返回成功消息，则表示漏洞利用成功，恶意插件已上传并激活，攻击者可以通过访问上传的恶意插件执行任意代码。

**有效性评估：**
提供的POC代码看起来是有效的，因为它模拟了攻击者利用漏洞所需的步骤，包括登录、提取nonce和发送恶意请求。代码中包含了多个nonce的提取规则，增加了成功率。

**投毒风险评估：**
该漏洞利用代码的主要目的是上传和激活恶意插件，从而实现远程代码执行。该脚本本身并不包含明显的恶意代码，如反向shell或数据窃取。但是，用户提供的`shellweb`参数指向的恶意插件可能包含各种恶意功能。代码作者在Github的开源项目里，有一定几率存在投毒，但是该代码主要的风险来自用户提供的恶意zip包。License文件为MIT，作者声明拥有该代码的版权，有一定的投毒风险。

*   **潜在的投毒风险：** 代码本身没有发现明显的投毒代码，主要的风险在于用户提供的shellweb参数，该参数指向的远程zip文件可能包含恶意代码。因此，投毒的概率取决于zip文件的来源和内容，而不是代码本身。

**结论：**
该漏洞利用代码的有效性较高，但投毒风险主要取决于用户提供的恶意ZIP文件，以及作者上传恶意zip包的可能，因此投毒风险相对较低。

**项目地址:** [Nxploited/CVE-2025-1304](https://github.com/Nxploited/CVE-2025-1304)

**漏洞详情:** [CVE-2025-1304](https://nvd.nist.gov/vuln/detail/CVE-2025-1304)