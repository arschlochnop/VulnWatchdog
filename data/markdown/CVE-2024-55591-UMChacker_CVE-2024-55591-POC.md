## CVE-2024-55591 – FortiOS WebSocket CLI 身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可能获得超级管理员权限

**影响版本:** FortiOS 7.0.0 <= version <= 7.0.16, FortiProxy 7.0.0 <= version <= 7.0.19, FortiProxy 7.2.0 <= version <= 7.2.12

**利用条件:** 目标设备开启了FortiOS/FortiProxy的web管理界面，且允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 是一个影响 FortiOS 和 FortiProxy 的身份验证绕过漏洞。攻击者可以通过向 Node.js websocket 模块发送特制请求来绕过身份验证，从而获得超级管理员权限。

**有效性分析:**

根据提供的漏洞信息、搜索结果和PoC代码，该漏洞利用是有效的。

*   漏洞库信息显示该漏洞是严重级别的身份验证绕过漏洞，CVSS 评分为 9.6。
*   搜索结果表明该漏洞已在野外被利用，多个安全厂商发布了关于该漏洞的警告。
*   提供的PoC代码旨在利用 websocket 模块中的身份验证绕过漏洞，可以通过发送特制的websocket请求来获取管理员权限。
*   PoC代码通过构造特定的websocket请求，模拟管理员登录过程，从而绕过身份验证。

**投毒风险分析:**

PoC代码中存在潜在的投毒风险。

*   PoC作者在代码中使用了较多的注释，但部分注释为非英文，这增加了代码审查的难度。
*   PoC代码中存在一些不必要的代码片段，这些代码片段可能被用于隐藏恶意行为。
*  PoC中使用了`watchTowr`作为`local_access_token`,在登录信息中也出现了多次,这可能是一种后门,但也可能是一种测试手段,难以判断。但是增加了投毒的可行性。

综合考虑，投毒风险约为10%。

**利用方式:**

1.  攻击者首先需要确定目标 FortiOS/FortiProxy 设备的 IP 地址和端口。
2.  攻击者使用 PoC 代码向目标设备发送包含特定参数的 WebSocket 请求。
3.  PoC 代码利用漏洞绕过身份验证，建立与设备的 WebSocket 连接。
4.  攻击者通过 WebSocket 连接向设备发送 CLI 命令，从而实现对设备的控制。

**项目地址:** [UMChacker/CVE-2024-55591-POC](https://github.com/UMChacker/CVE-2024-55591-POC)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)