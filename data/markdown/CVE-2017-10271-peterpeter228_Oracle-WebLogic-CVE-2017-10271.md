## CVE-2017-10271 / CVE-2017-3506 Oracle WebLogic wls-wsat RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 和 CVE-2017-3506 是 Oracle WebLogic Server 中的 wls-wsat 组件远程代码执行漏洞。

**有效性：**
根据漏洞库信息，该漏洞利用简单，未经身份验证的攻击者可以通过 T3 协议进行网络访问，从而破坏 Oracle WebLogic Server。提供的POC代码利用 XMLDecoder 反序列化漏洞，通过构造恶意的 SOAP 请求，可以在服务器上写入任意 JSP 文件，进而执行任意命令。因此，该POC代码**有效**。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是利用 XMLDecoder 反序列化漏洞在目标服务器上部署一个 webshell，webshell的功能是接收command参数并执行，然后将执行结果返回。代码本身未发现隐藏的恶意功能或后门，因此，投毒风险评估为**0%**。

**利用方式：**
1.  攻击者发送包含恶意 XML 数据的 SOAP 请求到 WebLogic Server 的 wls-wsat 组件。
2.  WebLogic Server 使用 XMLDecoder 反序列化 XML 数据。
3.  恶意 XML 数据构造一个 java.io.PrintWriter 对象，用于在 WebLogic Server 的 Web 应用目录下写入一个 JSP 文件（webshell）。
4.  攻击者通过访问部署的 webshell，可以执行任意命令。

**项目地址:** [peterpeter228/Oracle-WebLogic-CVE-2017-10271](https://github.com/peterpeter228/Oracle-WebLogic-CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)