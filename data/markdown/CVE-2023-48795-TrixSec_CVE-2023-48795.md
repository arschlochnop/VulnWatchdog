## CVE-2023-48795 - SSH Terrapin攻击

**漏洞编号:** CVE-2023-48795

**漏洞类型:** 中间人攻击/协议降级

**影响应用:** OpenSSH和其他SSH实现

**危害等级:** 中危，可能导致安全特性被降级或禁用，从而降低连接的安全性。

**影响版本:** OpenSSH < 9.6, 以及其他受影响的软件版本 (详见CVE描述)

**利用条件:** 攻击者需要位于客户端和服务器之间的网络路径上，能够拦截和修改SSH流量。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-48795，又名Terrapin攻击，允许中间人攻击者通过截断SSH握手过程中的重要部分来绕过完整性检查。攻击者通过操纵序列号，可以删除初始消息，从而导致客户端和服务器最终建立的连接在某些安全功能上被降级或禁用。该漏洞主要影响使用ChaCha20-Poly1305和CBC加密算法的SSH连接。提供的PoC代码 `/tmp/64496ee6e927cde596b3149a14aa5037/CVE-2023-48795.py` 实际上是一个SSH版本扫描器，用于检测目标SSH服务器是否运行着易受攻击的OpenSSH版本。它通过尝试建立SSH连接并解析返回的版本字符串来实现这一点。PoC本身不包含主动利用漏洞的代码，而是用于识别潜在的脆弱目标。 由于PoC代码主要用于版本检测，其**投毒风险为0%**。 代码本身没有发现任何恶意行为，例如执行任意命令或回连恶意服务器等。

**利用方式:**
1.  **中间人位置:** 攻击者必须能够拦截客户端和服务器之间的SSH通信。
2.  **握手截断:** 在SSH握手期间，攻击者会操纵数据包，截断或删除部分信息，特别是与密钥交换和算法协商相关的消息。
3.  **序列号操纵:**  攻击者通过修改序列号来达到截断信息的目的。
4.  **降级攻击:**  通过截断握手信息，攻击者可以迫使客户端和服务器使用较弱的加密算法或禁用某些安全功能，例如前向安全性。
5.  **数据篡改/窃取:**  一旦连接的安全级别降低，攻击者就可以更容易地篡改或窃取传输的数据。

**项目地址:** [TrixSec/CVE-2023-48795](https://github.com/TrixSec/CVE-2023-48795)

**漏洞详情:** [CVE-2023-48795](https://nvd.nist.gov/vuln/detail/CVE-2023-48795)