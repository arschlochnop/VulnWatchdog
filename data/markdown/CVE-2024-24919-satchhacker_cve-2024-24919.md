## CVE-2024-24919-CheckPoint-信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备开启远程Access VPN或Mobile Access Software Blades，且可被互联网访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个高危信息泄露漏洞。攻击者可以通过发送特制的 HTTP 请求，读取目标设备上的任意文件。根据搜索引擎结果，该漏洞是未经身份验证的远程攻击，可以通过构造包含路径遍历的URL来读取文件内容，例如`/etc/passwd`。该漏洞已被CISA添加到已知可被利用漏洞目录（KEV）。

提供的 POC 代码是一个 bash 脚本 `cve-2024-24919.sh`，它接受一个包含目标域名/IP 地址列表的文件作为输入。脚本循环读取文件中的每个域名/IP，并构造一个包含路径遍历的 POST 请求，尝试读取 `/etc/passwd` 文件。如果 HTTP 状态码为 200，则认为目标存在漏洞，并输出响应内容。这个脚本的逻辑与搜索引擎结果中描述的利用方式一致，因此POC代码是有效的。

**投毒风险分析：**

分析脚本 `cve-2024-24919.sh`， 主要功能是发送一个包含恶意payload的请求，判断目标是否存在漏洞。虽然脚本包含安装curl的功能，可以方便使用者，但是脚本主体功能是漏洞验证。该脚本本身不包含任何恶意代码，不会在目标系统上执行任何有害操作。但存在极小的投毒风险：
1.  **curl安装风险：** `sudo apt install curl` 在某些特殊配置环境下可能被替换为恶意源，但几率极低。
2.  **域名/IP 文件篡改：** 攻击者可能诱骗用户使用包含恶意域名/IP的文件进行扫描，但这不属于POC本身的问题。
3. **依赖脚本是否存在恶意代码**: 本次分析仅限于提供的2个脚本，如果作者在其他辅助脚本中存在恶意代码，本次分析无法发现，但是概率很低。 

综合考虑，认为此仓库的投毒风险较低，约为5%。

**利用方式：**

1.  攻击者准备包含目标Check Point Security Gateway的域名或IP地址列表。
2.  运行 `cve-2024-24919.sh` 脚本，并提供域名/IP地址列表文件。
3.  脚本会向每个目标发送构造好的HTTP POST 请求，尝试读取 `/etc/passwd` 文件。
4.  如果目标存在漏洞，且成功读取到 `/etc/passwd` 文件，脚本会将其输出。

**项目地址:** [satchhacker/cve-2024-24919](https://github.com/satchhacker/cve-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)