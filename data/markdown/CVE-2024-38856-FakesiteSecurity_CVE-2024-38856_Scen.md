## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38856是Apache OFBiz中的一个不正确的授权漏洞。未认证的端点可能允许执行屏幕渲染代码，如果满足某些前提条件（例如，当屏幕定义没有明确检查用户权限，因为它们依赖于端点的配置时）。提供的Python脚本 `cve-2024-38856_Scanner.py` 通过利用 `/webtools/control/main/ProgramExport` 端点，向目标发送包含恶意 Groovy 代码的 POST 请求。恶意 Groovy 代码被编码为 Unicode 字符串并作为 `groovyProgram` 参数的值发送。服务器执行此 Groovy 代码，导致远程代码执行。脚本中存在一个 `README.md`文件提示只做Etis使用，任何恶意活动作者不负责.脚本执行命令时，会将命令进行base64编码，然后用unicode转义payload，这种方式可以绕过一些WAF的检测，但也有可能被其他安全设备识别为恶意请求。投毒风险主要存在于脚本本身可能存在未知的后门或者恶意行为，但目前代码逻辑主要关注漏洞利用，因此投毒风险较低，预估为10%。

**项目地址:** [FakesiteSecurity/CVE-2024-38856_Scen](https://github.com/FakesiteSecurity/CVE-2024-38856_Scen)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)