## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，存在D-Bus总线和polkitd服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560是一个Polkit中的权限提升漏洞。该漏洞允许未经授权的本地用户通过欺骗Polkit绕过D-Bus请求的凭据检查，从而将权限提升为root用户。

**有效性：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的利用代码。CISA的已知被利用漏洞目录中也包含此漏洞，表明该漏洞在野外被积极利用。提供的利用代码分析显示，利用方式是利用Polkit在处理D-Bus请求时的一个条件竞争漏洞，当D-Bus总线调用异常时，Polkit没有正确处理错误，导致将请求者的UID错误地设置为0（root用户），从而绕过权限验证。

**投毒风险：**

评估提供的POC代码是否存在投毒风险需要仔细审查代码实现。考虑到代码主要关注利用条件竞争绕过权限验证，直接植入恶意后门的概率较低。但是，仍然存在一些潜在的投毒方式，例如：

*   **微妙的修改：** 作者可能在利用代码中添加了看似无害但实际上会执行恶意操作的代码片段。例如，在权限提升后执行某些系统命令，或者修改某些配置文件。
*   **依赖项：** 作者可能引入了包含恶意代码的第三方库。
*   **触发条件：** 恶意代码可能只在特定条件下才会触发，从而避免被轻易检测到。

由于无法直接运行和调试代码，因此只能进行静态分析。根据目前的信息，评估投毒风险为10%，主要考虑的是潜在的隐蔽后门或恶意修改。

**利用方式：**

1.  **触发漏洞：** 攻击者需要构造一个特定的D-Bus请求，该请求会被Polkit处理。
2.  **竞争条件：** 攻击者需要利用条件竞争，使D-Bus总线调用失败并返回错误。
3.  **权限提升：** 由于Polkit未能正确处理错误，导致将请求者的UID错误地设置为0（root用户）。
4.  **执行恶意操作：** 攻击者现在拥有root权限，可以执行任何操作，例如创建新的管理员帐户，修改系统文件，或者安装恶意软件。

总而言之，CVE-2021-3560是一个严重的安全漏洞，应该尽快修补。在使用任何公开的利用代码之前，都应该仔细审查代码，以确保其安全性。

**项目地址:** [chenaotian/CVE-2021-3560](https://github.com/chenaotian/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)