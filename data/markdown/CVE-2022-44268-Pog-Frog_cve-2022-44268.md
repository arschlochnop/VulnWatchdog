## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 目标系统安装了ImageMagick，并且Magick二进制文件具有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 是 ImageMagick 中的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像（例如，为了调整大小）时，如果该 Magick 二进制文件具有读取权限，则生成的图像可能会嵌入任意文件的内容。利用方式如下：

1.  **生成恶意PNG：** 使用 `generate.py` 脚本创建一个包含要读取的目标文件路径的PNG图像。该脚本会将目标文件路径作为文本信息嵌入到PNG图像中。

2.  **触发漏洞：** 将恶意PNG图像发送给目标系统，并由 ImageMagick 处理（例如，用于调整大小）。

3.  **提取文件内容：** 使用 `extract.py` 脚本从处理后的PNG图像中提取嵌入的文件内容。`extract.py` 从PNG图像的元数据中提取文件内容，并将其输出。

**有效性评估：**

提供的PoC代码有效，可以成功读取目标系统上的任意文件（需要权限）。

**投毒风险评估：**

经过分析，该仓库中没有明显的投毒代码。`generate.py` 和 `extract.py` 脚本的功能相对简单，主要是创建和提取PNG图像中的元数据，没有发现恶意行为。`readme.md` 文件也只包含漏洞描述和使用说明。

**漏洞利用方式总结：**

该漏洞利用方式是通过在PNG图像中嵌入目标文件路径，然后利用 ImageMagick 处理图像时读取该文件，并将文件内容嵌入到输出图像中，最后通过提取输出图像中的元数据来获取文件内容。这种利用方式依赖于 ImageMagick 处理 PNG 图像时对元数据的不安全处理。

**排序优先级说明:**

本分析遵循了 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息的优先级。


**项目地址:** [Pog-Frog/cve-2022-44268](https://github.com/Pog-Frog/cve-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)