## CVE-2020-17530-Apache Struts-远程代码执行

**漏洞编号:** CVE-2020-17530

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Struts 2.0.0 - Struts 2.5.25

**利用条件:** 目标系统运行受影响版本的Apache Struts，且允许通过HTTP POST请求访问存在漏洞的Action。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞（CVE-2020-17530）是由于Apache Struts框架在处理OGNL表达式时，对用户输入未进行充分的验证，导致可以执行双重OGNL表达式评估。攻击者可以通过在tag属性中注入恶意的OGNL表达式，从而在服务器上执行任意代码。 

**有效性：**
提供的POC代码利用了OGNL表达式注入漏洞。`s2-061.py`脚本通过POST请求向目标URL发送包含恶意OGNL表达式的`name`参数。`README.md`中也提供了POC的payload示例。

**投毒风险：**
查看提供的python脚本，该脚本主要功能是发送含有恶意payload的http请求,从代码角度看，没有发现明显的恶意行为或者后门，因此投毒风险较低。提供的payload 也是常规的漏洞验证payload，旨在调用计算器程序。因此，投毒风险评估为0%。

**利用方式：**
1.  **漏洞定位：** 确定目标系统运行的是受影响版本的Apache Struts (2.0.0 - 2.5.25)。
2.  **构造Payload：**  构造包含恶意OGNL表达式的HTTP请求。POC中使用的payload旨在执行计算器应用程序作为概念验证。可以修改payload来执行其他命令。
3.  **发送请求：**  使用POST请求将payload发送到易受攻击的Struts Action。通常，这涉及到向Struts Action的某个参数（如`name`参数）注入OGNL表达式。
4.  **代码执行：**  如果漏洞利用成功，服务器将执行payload中包含的命令。在POC的情况下，会启动计算器应用程序。在实际攻击中，攻击者可以执行更危险的命令，例如安装后门、窃取数据或控制系统。

**项目地址:** [ka1n4t/CVE-2020-17530](https://github.com/ka1n4t/CVE-2020-17530)

**漏洞详情:** [CVE-2020-17530](https://nvd.nist.gov/vuln/detail/CVE-2020-17530)