## CVE-2025-49113-Roundcube-RCE-PHP对象反序列化

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，远程代码执行

**影响版本:** 1.5.0 - 1.5.9, 1.6.0 - 1.6.10

**利用条件:** 需要经过身份验证的用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113是一个存在于Roundcube Webmail 1.5.10之前版本和1.6.x至1.6.11之前的版本中的远程代码执行漏洞。该漏洞允许经过身份验证的用户通过操纵URL中的`_from`参数，在`program/actions/settings/upload.php`中触发PHP对象反序列化漏洞，从而执行任意代码。

**利用方式：**
1.  攻击者首先需要获取Roundcube Webmail的有效用户凭据，成功登录系统。
2.  构造恶意的PHP对象，该对象在反序列化时会执行任意代码。该POC使用了`Crypt_GPG_Engine`类，构造函数中包含恶意代码，利用base64编码绕过检测。
3.  将构造的恶意对象序列化，并通过`_from`参数传递到`program/actions/settings/upload.php`。
4.  Roundcube Webmail在处理上传请求时，由于没有充分验证`_from`参数，导致恶意对象被反序列化，从而触发远程代码执行。

**有效性：**
根据漏洞信息和漏洞利用代码，该POC代码有效。漏洞信息明确指出`_from`参数未经验证导致PHP对象反序列化，POC代码中利用`Crypt_GPG_Engine`类构建恶意payload并通过`_from`参数发送，符合漏洞描述。

**投毒风险：**
该漏洞利用代码包含以下潜在的投毒风险：
1. **`Crypt_GPG_Engine`构造函数中的代码执行:** 构造函数中的`echo "{$_gpgconf}"|base64 -d|sh;#`。这部分代码首先对`$_gpgconf`进行base64解码，然后通过`sh`命令执行。这意味着攻击者可以在`$_gpgconf`中插入任意shell命令。虽然进行了base64编码，但这只是简单的混淆，很容易被解码和利用。
2. **不明显的后门:** `uploadImage`函数中使用了硬编码的`_uploadid`和`_unlock`参数，以及`edit-!xxx`作为`_from`的前缀。虽然这部分看起来像是占位符，但也可能隐藏一些未知的逻辑，将来可能会被利用。由于该利用需要上传图片,有可能图片本身被植入恶意代码
3. **User-Agent欺骗:** 在检查版本和登录时，使用了自定义的User-Agent，这可能用于追踪或者绕过某些安全策略，但也可能隐藏一些不易察觉的恶意行为。

综合以上分析，存在一定投毒风险，判断为 **10%**。大部分代码看起来是直接利用漏洞，但部分参数和User-Agent的自定义可能隐藏未知后门或恶意行为。

**项目地址:** [SteamPunk424/CVE-2025-49113-Roundcube-RCE-PHP](https://github.com/SteamPunk424/CVE-2025-49113-Roundcube-RCE-PHP)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)