## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 15.10.11, < 16.4.1 (且 >= 5.3-milestone-2, >= 16.0.0-rc-1)

**利用条件:** 目标XWiki实例可从网络访问，且未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 是 XWiki Platform 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过向 `SolrSearch` 发送特制的请求来执行任意 Groovy 代码。漏洞存在于`Main.SolrSearchMacros` 中，由于未充分进行输入验证，导致代码注入。

**有效性：**
根据漏洞库信息、搜索结果和提供的 POC 代码，该漏洞利用的有效性较高。漏洞库信息将其评为严重级别 (CRITICAL)，并提供了PoC的验证方式，多个搜索结果也表明存在公开可用的漏洞利用代码，并且漏洞已经被利用。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2025-24893.py`) 主要功能是发送恶意请求以触发远程代码执行，并建立反向 shell。代码中包含检测目标协议（HTTP/HTTPS）、发送测试命令、发送反向 shell payload 以及处理交互式 shell 的逻辑。

**风险评估：**
*   **风险点：** 代码从 github 仓库下载，如果作者在其他地方添加了恶意代码，例如在反向连接建立之后执行恶意命令，或者收集目标系统信息并发送到恶意服务器，则存在投毒风险。
*   **缓解措施：**
    *   在执行脚本前，仔细审查代码，特别是反向连接建立后的处理逻辑。
    *   使用安全工具对代码进行静态分析，检测潜在的恶意行为。
    *   在隔离环境中测试代码，监控网络流量和系统行为，以识别任何异常活动。
    *   从可信来源获取漏洞利用代码，并验证代码的完整性。

**综合判断：**
代码本身主要实现了漏洞利用的功能，但是考虑到代码来源的风险，存在一定程度的投毒风险。结合代码审查的难度和潜在的危害，我们给出的投毒风险百分比是 10%。

**利用方式：**
1.  **漏洞触发：**  攻击者构造包含恶意 Groovy 代码的 URL，发送到 XWiki 服务器的 `/xwiki/bin/get/Main/SolrSearch` 端点。
2.  **代码注入：**  `SolrSearchMacros` 宏处理请求时，由于未充分过滤 `text` 参数，直接将恶意代码传递给 Groovy 引擎执行。
3.  **远程执行：**  Groovy 引擎执行恶意代码，攻击者可以执行任意命令，如创建反向 shell 连接到攻击者的服务器。
4.  **反向 Shell：**  攻击者监听指定端口，等待目标服务器建立反向连接，从而获得对目标系统的控制权。

总结：此漏洞利用方式简单，危害严重，利用代码公开，因此应尽快修复。

**项目地址:** [nopgadget/CVE-2025-24893](https://github.com/nopgadget/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)