## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要Flink JobManager的REST接口对外暴露

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口利用目录遍历漏洞读取 JobManager 进程本地文件系统上的任何文件。漏洞利用方式为构造包含目录遍历字符的URL，发送GET请求至JobManager的logs接口。漏洞利用代码通过指定目标URL、遍历深度以及目标文件路径或包含多个文件路径的文件，可以并发地发送恶意请求，探测并下载服务器上的文件内容。根据漏洞信息，只有JobManager进程有权限访问的文件才可被读取。利用代码中存在保存下载文件的功能。鉴于POC代码的功能主要是读取文件，保存到本地，且代码量不大，人工 review 之后发现仅仅存在一处输出文件夹名称写死的低级错误，所以代码中存在投毒的可能性较低，给出了1%的概率。

**项目地址:** [GazettEl/CVE-2020-17519](https://github.com/GazettEl/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)