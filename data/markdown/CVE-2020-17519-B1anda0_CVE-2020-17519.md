## CVE-2020-17519-Apache Flink 目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** JobManager进程的REST接口对外开放，且目标Flink版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Flink 1.11.0到1.11.2版本中，允许未经身份验证的攻击者通过JobManager的REST接口读取JobManager进程可访问的本地文件系统上的任何文件。攻击者可以通过构造包含目录遍历序列（如`..%252f`）的恶意URL来访问系统文件。提供的POC代码通过发送包含特定payload的GET请求到`/jobmanager/logs`端点，尝试读取`/etc/passwd`文件来验证漏洞的存在。

**有效性：**
根据漏洞描述和POC代码，该POC能够有效验证漏洞的存在。POC通过构造包含URL编码的目录遍历字符的payload，尝试读取`/etc/passwd`文件。如果服务器返回200状态码并且响应内容包含`root:x`，则确认漏洞存在。

**投毒风险：**
该POC代码主要功能是发送HTTP请求并检查响应，以验证漏洞是否存在。代码包含以下操作：
1.  导入必要的库（requests, sys, colorama）。
2.  定义banner信息。
3.  定义verify函数，用于发送HTTP请求并检查响应。
4.  在主函数中，读取包含URL的文本文件，并对每个URL执行verify函数。
5.  如果检测到漏洞，则将URL写入vul.txt文件。

没有发现任何可疑的或恶意的代码，例如执行系统命令、修改文件或上传恶意文件等。因此，可以认为此仓库不存在作者隐藏的投毒代码，投毒风险为0%。

**利用方式：**
1.  确定目标Flink实例的版本是否在受影响的范围内（1.11.0到1.11.2）。
2.  通过网络访问JobManager进程的REST接口。
3.  构造包含目录遍历序列的URL，指向要读取的文件。例如：
    ```
    /jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd
    ```
    其中`..%252f`是`../`的URL编码形式，用于进行目录遍历。
4.  发送GET请求到构造的URL。
5.  如果服务器返回文件内容，则表示漏洞利用成功。攻击者可以读取JobManager进程有权访问的任何文件，包括配置文件、日志文件等。
6.  利用获取的敏感信息，可以进一步攻击系统。

**项目地址:** [B1anda0/CVE-2020-17519](https://github.com/B1anda0/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)