## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要目标网站安装了存在漏洞版本的Bricks Builder插件，且允许未授权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是WordPress Bricks Builder插件中的一个代码注入漏洞。攻击者可以通过构造包含恶意PHP代码的请求，发送到易受攻击的端点（`/?bricks=run&bricksforge_execute=php`），从而在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源确认了该漏洞的存在，并提供了可用的PoC代码。PoC代码通过发送包含PHP代码的POST请求到特定URL，验证了代码注入漏洞。

**投毒风险：**
PoC代码本身主要是用于检测目标是否受到漏洞影响。它通过发送包含`echo md5('bricks_check');`的PHP代码的请求，如果响应中包含预期的MD5哈希值，则认为目标易受攻击。PoC本身风险不高，但仍有以下几点需要注意：

*   **LICENSE文件:** MIT许可证允许修改和分发该代码。如果有人修改了代码并添加恶意功能，重新发布，可能会造成投毒风险。
*   **Payload:** 原始PoC代码的目的是检查漏洞是否存在，但如果攻击者修改`payload`变量，则可能造成恶意操作。
*   **其他文件:**  `README.md`只包含基本描述，无恶意代码。

因此，虽然PoC代码本身看起来安全，但存在被修改和滥用的潜在风险，投毒风险评估为10%。

**利用方式：**
1.  **确定目标：** 找到安装了Bricks Builder插件的WordPress网站，并且版本小于等于1.9.6。
2.  **发送恶意请求：** 使用PoC代码或者类似工具，构造一个POST请求，将恶意的PHP代码包含在`code`参数中，发送到`/?bricks=run&bricksforge_execute=php`端点。
3.  **执行代码：** 如果目标存在漏洞，服务器将执行POST请求中包含的PHP代码。
4.  **控制服务器：** 通过执行任意PHP代码，攻击者可以读取敏感信息、修改文件、创建后门，甚至完全控制服务器。

**项目地址:** [DedsecTeam-BlackHat/Poleposph](https://github.com/DedsecTeam-BlackHat/Poleposph)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)