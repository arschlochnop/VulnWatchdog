## CVE-2025-24893 - XWiki Platform Remote Code Execution

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 高危，允许未授权的远程代码执行，可能导致完全的服务器控制、数据泄露和破坏以及内网渗透。

**影响版本:** < 15.10.11, < 16.4.1

**利用条件:** 目标 XWiki 实例的 SolrSearch 宏未打补丁，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 是 XWiki Platform 中的一个严重漏洞，允许未经身份验证的攻击者通过向 `SolrSearch` 发送恶意请求来执行任意远程代码。漏洞利用方式如下：

1.  **漏洞原理:** 该漏洞源于 `SolrSearch` 宏中对用户输入的不充分的清理，导致可以注入恶意的 Groovy 代码。
2.  **利用方式:**  攻击者可以通过构造包含恶意 Groovy 代码的 URL，利用 `SolrSearch` 宏执行任意系统命令。
3.  **POC分析:** 提供的 POC 代码是一个 Python 脚本，它首先检测目标是否支持 HTTPS，如果不支持则回退到 HTTP。然后，它构造一个包含 `println("cat /etc/shadow".execute().text)` 的恶意 URL，并向目标发送请求。如果返回的响应包含 `root:`，则表示漏洞利用成功，`/etc/shadow` 文件的内容已被泄露。
4.  **投毒风险评估:**
    *   该POC的主要功能是利用漏洞，从代码上看，该脚本逻辑清晰，主要功能是发送包含恶意代码的请求并获取响应。
    *   投毒风险点在于，脚本可以接受URL列表文件作为输入，如果攻击者诱导用户使用包含恶意URL的列表文件，则可能导致批量攻击。
    *   虽然LICENSE文件声明使用 MIT License，但README.md文件中关于漏洞描述过于简单，并且存在诱导用户进行漏洞利用的倾向。
    *   综合来看，该仓库存在一定的投毒风险，但主要集中在使用者误用或被诱导使用恶意URL列表上，而POC代码本身隐藏恶意后门的概率较低，估计投毒风险为10%。

**项目地址:** [Hex00-0x4/CVE-2025-24893-XWiki-RCE](https://github.com/Hex00-0x4/CVE-2025-24893-XWiki-RCE)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)