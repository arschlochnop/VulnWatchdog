## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** Lua脚本功能已启用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49844 是 Redis 中 Lua 解释器中的一个使用后释放漏洞，存在于所有启用了 Lua 脚本支持的 Redis 版本中，直到 8.2.2 版本修复。攻击者可以利用精心构造的 Lua 脚本操纵垃圾回收器，触发 UAF 漏洞，从而可能导致远程代码执行。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞利用是有效的。搜索引擎结果中很多文章都表明这是一个高危漏洞，并且已经有公开的 PoC 利用代码。PoC 代码包含 Dockerfile 和 exploit_poc.py，用于搭建易受攻击的 Redis 环境并验证漏洞。

**投毒风险：**
提供的 Dockerfile 看起来是安全的，它仅仅是配置一个易受攻击版本的 Redis。`README.md` 也明确声明了风险，并警告用户不要在生产环境中使用。`exploit_poc.py`是漏洞验证代码，没有发现明显的投毒行为。需要仔细检查`exploit_poc.py`，但是，基于这些信息，初步判断投毒风险较低，大约5%。

**利用方式：**
1.  攻击者连接到 Redis 服务器（可能需要身份验证，也可能不需要，取决于 Redis 的配置）。
2.  攻击者通过 EVAL 命令发送恶意构造的 Lua 脚本。
3.  Lua 脚本利用 Redis Lua 解释器中的 UAF 漏洞，操纵垃圾回收器。
4.  成功利用后，攻击者可以绕过 Lua 沙箱的限制，执行任意本地代码。
5.  最终，攻击者可以获得对主机的完全访问权限，进行数据泄露、恶意软件安装等恶意活动。

**项目地址:** [lastvocher/redis-CVE-2025-49844](https://github.com/lastvocher/redis-CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)