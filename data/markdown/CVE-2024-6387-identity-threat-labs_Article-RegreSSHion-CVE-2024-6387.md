## CVE-2024-6387-OpenSSH-regreSSHion

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** <= 9.7p1 (OpenSSH)

**利用条件:** 需要glibc-based Linux系统，以及OpenSSH服务开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（regreSSHion）是OpenSSH服务器中的一个竞争条件漏洞。漏洞源于OpenSSH服务器处理信号的方式存在问题，具体来说，当用户认证失败时，可能触发不安全的信号处理。远程攻击者可以通过在短时间内发起大量SSH连接尝试，并故意触发认证失败，从而引发竞争条件，最终可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性：**
根据搜索结果（webpage 1, 3, 4, 5, 7, 8）和漏洞库信息，该漏洞已被确认为一个高危漏洞，并且存在公开的PoC（Proof of Concept）代码。虽然提供的POC代码只是一个包含漏洞描述的README.md文件，**不能直接运行，但是，github上存在可利用的POC**。该POC的有效性取决于目标系统是否满足漏洞利用的条件，即：
1.  使用受影响的OpenSSH版本（<= 9.7p1）。
2.  目标系统是基于glibc的Linux发行版。
3.  系统配置允许一定数量的并发连接。

**投毒风险：**
提供的POC代码（README.md）本身不包含任何可执行代码，因此直接的投毒风险很低。但需要注意的是，任何从互联网上下载的代码都存在潜在的风险。即使是看似无害的文档，也可能包含恶意链接或指令，引导用户下载或执行恶意代码。因此，下载和使用任何PoC代码时，都应该保持警惕，并进行充分的安全审查。

虽然提供的README.md文件本身投毒风险较低,但是考虑到实际利用中需要依赖其他EXP, 因此其他仓库被投毒的可能性相对较高。
风险评估：10%

**利用方式：**
根据漏洞描述和搜索结果，利用方式主要包括以下几个步骤：
1.  **大量连接请求：** 攻击者向目标OpenSSH服务器发起大量的并发连接请求。
2.  **触发认证失败：**  在连接请求中，故意提供错误的用户名或密码，触发认证失败事件。
3.  **竞争条件利用：**  通过大量认证失败事件，触发OpenSSH服务器中的竞争条件漏洞。
4.  **代码执行或DoS：** 成功利用漏洞后，攻击者可以执行任意代码（RCE）或导致服务器崩溃（DoS）。

需要注意的是，利用该漏洞需要一定的资源和技术，并且成功率可能不高。Red Hat 在其安全公告中指出，实现RCE需要相当多的资源投入。同时，修改sshd_config,设置LoginGraceTime为0可以有效避免远程代码执行，但仍存在拒绝服务风险.

**项目地址:** [identity-threat-labs/Article-RegreSSHion-CVE-2024-6387](https://github.com/identity-threat-labs/Article-RegreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)