## CVE-2024-3094-xz-utils后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils (liblzma5)

**危害等级:** 极危，允许未经授权的远程SSH访问，可能导致系统完全控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统已安装受感染的xz-utils版本，且SSH服务链接到liblzma库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个存在于xz-utils 5.6.0和5.6.1版本中的供应链后门攻击。攻击者通过一系列复杂的混淆手段，将预编译的恶意代码注入到liblzma库的构建过程中。这个被篡改的库允许攻击者拦截和修改与该库交互的数据，从而实现未经授权的远程SSH访问。该漏洞利用过程复杂，涉及多个步骤，包括从伪装的测试文件中提取恶意对象文件，修改liblzma代码，以及劫持SSH服务器的认证过程。提供的POC代码（`check_xz_utils_CVE-2024-3094.sh`）是一个检测脚本，用于检查系统上安装的xz-utils版本是否易受攻击，并提示用户进行更新。它本身并不包含漏洞利用代码，而是一个简单的版本检查工具。 投毒风险评估：该仓库的投毒风险较低（5%）。该仓库提供的脚本主要作用是检测系统中的 `liblzma5` 版本，并提示用户是否需要升级，功能比较简单。 虽然可能存在作者恶意修改检测脚本使其失效，或提供恶意更新源的风险，但整体风险可控。

**项目地址:** [Bella-Bc/xz-backdoor-CVE-2024-3094-Check](https://github.com/Bella-Bc/xz-backdoor-CVE-2024-3094-Check)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)