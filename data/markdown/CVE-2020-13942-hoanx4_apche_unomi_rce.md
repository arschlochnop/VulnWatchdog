## CVE-2020-13942 - Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution (RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器运行Apache Unomi，且版本低于1.5.2，并且`/context.json`端点对外开放。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-13942 允许攻击者通过向 `/context.json` 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。该漏洞是由于 Apache Unomi 未能充分验证用户输入造成的。

**利用方式：**

1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 构造包含恶意 OGNL 或 MVEL 表达式的 HTTP POST 请求，并将其发送到 `/context.json` 端点。提供的 POC 代码中包含了 MVEL 和 OGNL 两种利用方式的示例。
    *   **MVEL POC：** 将 MVEL 表达式嵌入到 `parameterValues` 中，利用 `script::` 前缀执行任意系统命令。
    *   **OGNL POC：** 使用 Java 反射 API 绕过类加载器限制，然后执行系统命令。
3.  **执行代码：** 如果漏洞存在且利用成功，服务器将执行攻击者提供的恶意代码。提供的 POC 示例中执行了 `gnome-calculator` 命令，攻击者可以将其替换为任何其他命令。

**投毒风险分析：**

提供的代码仓库主要包含漏洞的说明文档和两种利用方式的 POC 代码（MVEL 和 OGNL）。代码的目的是演示漏洞，其中执行的`gnome-calculator`只是一个PoC验证手段，不能称之为后门代码。总体而言，仓库的内容是围绕漏洞利用展开的，**没有发现明显的恶意代码或后门**。

代码中是否存在作者隐藏的投毒代码的可能性较低，约为1%。主要原因如下：

*   代码相对简单，容易审计。
*   主要目的是演示漏洞利用，添加恶意代码可能会影响 POC 的有效性，降低其可信度。
*   虽然存在Perl脚本,但是仅仅作为辅助利用，本身未发现存在投毒代码的可能。通过上述分析，可以判断该代码仓库的投毒风险较低。

**项目地址:** [hoanx4/apche_unomi_rce](https://github.com/hoanx4/apche_unomi_rce)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)