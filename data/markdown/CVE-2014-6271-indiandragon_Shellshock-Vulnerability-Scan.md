## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，且攻击者能够通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271（ShellShock）是一个存在于GNU Bash中的高危漏洞。该漏洞允许攻击者通过构造特制的包含恶意代码的环境变量，在目标系统上执行任意命令。漏洞利用方式主要依赖于Bash处理函数定义后尾随字符串的方式。攻击者可以将恶意代码嵌入到环境变量中，当Bash解析这些变量时，尾随的恶意代码会被执行。

**有效性评估：**
漏洞库信息和搜索结果均表明该漏洞真实存在且危害严重，存在大量可利用的场景。利用代码库中提供的文件看起来是GNU GPL许可证，本身不包含攻击代码，但实际漏洞利用需要构造特定的环境变量。

**投毒风险评估：**
提供的漏洞利用代码片段（LICENSE文件）本身不具备投毒性，它只是一个开源协议文件。投毒风险主要存在于漏洞利用的上下文和攻击者构造的恶意环境变量中。如果攻击者散布包含恶意代码的环境变量构造方法，可能会诱导用户执行有害操作。但仅分析提供的LICENSE文件，投毒风险极低，约为1%。

**利用方式分析：**
1.  **环境变量注入：** 攻击者构造包含恶意代码的环境变量，例如：`(){ :; }; /bin/eject`。
2.  **触发Bash解析：** 寻找能够触发Bash解析这些环境变量的入口点。常见的入口点包括：
    *   OpenSSH的`ForceCommand`。
    *   Apache HTTP Server的`mod_cgi`和`mod_cgid`模块。
    *   DHCP客户端脚本。
    *   其他任何跨越权限边界并设置环境变量的Bash执行场景。
3.  **远程代码执行：** 当Bash解析包含恶意代码的环境变量时，嵌入的命令会被执行，导致远程代码执行。

根据搜索结果，该漏洞已存在多年，但由于其影响范围广泛，仍然值得关注。应及时更新Bash版本，并检查系统配置，避免受到攻击。

**项目地址:** [indiandragon/Shellshock-Vulnerability-Scan](https://github.com/indiandragon/Shellshock-Vulnerability-Scan)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)