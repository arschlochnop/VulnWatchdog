## CVE-2025-48384

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行/任意文件写入

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互 (克隆包含恶意配置的仓库)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-48384 漏洞是 Git 中由于对配置项中回车符处理不当导致的代码执行漏洞。当 Git 读取配置值时，会删除任何尾部的回车符和换行符 (CRLF)。但是，当写入配置条目时，带有尾部 CR 的值不会被引用，导致 CR 在以后读取配置时丢失。在初始化子模块时，如果子模块路径包含尾部 CR，则会读取更改后的路径，导致子模块被检出到错误的位置。如果存在一个符号链接，将更改后的路径指向子模块的 hooks 目录，并且子模块包含一个可执行的 post-checkout hook，则该脚本可能会在检出后被意外执行，导致代码执行。

**有效性：**
根据漏洞库信息和搜索结果, 此漏洞确实存在并且被多个安全厂商标记为高危, 并已经发布了PoC.
提供的PoC代码看似简单，它展示了漏洞利用的核心思路，即通过恶意构造包含回车符的子模块路径，结合符号链接和子模块钩子，实现任意代码执行。因此，PoC代码在原理上是有效的。但是, 此PoC只是框架, 需要补充完成exp。

**投毒风险：**
提供的PoC代码较为简单，主要包含一个README.md文件，一个子模块配置路径，以及子模块hooks目录的占位符。直接分析来看，没有明显的投毒代码。
然而，考虑到攻击者可能利用该漏洞进行供应链攻击，在更复杂的场景下，攻击者可能在子模块的post-checkout钩子中植入恶意代码，或者在其他配置文件中隐藏恶意配置。这种可能性是存在的。
基于以上分析，投毒风险评估为20%。这个百分比表示存在一定的风险，但直接证据不足。

**利用方式：**
1.  **恶意仓库构造：** 攻击者创建一个 Git 仓库，其中包含一个子模块，并且该子模块的路径在 `.gitmodules` 文件中包含尾部回车符 (``)。
2.  **符号链接创建：** 攻击者在仓库中创建一个符号链接，将包含尾部回车符的子模块路径指向 `.git/modules/<submodule_name>/hooks` 目录。
3.  **恶意钩子植入：** 攻击者在子模块的 `.git/hooks/post-checkout` 目录中放置恶意脚本。
4.  **用户交互：** 诱使用户克隆恶意仓库并初始化子模块 (`git submodule init && git submodule update`)。
5.  **代码执行：** 当用户执行 `git submodule update` 命令时，由于路径中的回车符，子模块会被检出到错误的位置，但由于符号链接的存在，实际上会将子模块的 hooks 目录链接到 `.git/hooks` 目录。检出后，`post-checkout` 钩子会被执行，从而执行恶意代码。

**项目地址:** [fluoworite/CVE-2025-48384](https://github.com/fluoworite/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)