## CVE-2022-1388 F5 BIG-IP iControl REST 身份验证绕过漏洞

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，允许未经身份验证的攻击者执行任意命令

**影响版本:** 受影响版本：16.1.x (小于16.1.2.2), 15.1.x (小于15.1.5.1), 14.1.x (小于14.1.4.6), 13.1.x (小于13.1.5), 12.1.x (小于等于 12.1.6), 11.6.x (小于等于11.6.5)

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，且暴露 iControl REST 接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。攻击者可以通过发送特制的 HTTP 请求，利用 BIG-IP 设备的 iControl REST 接口，执行任意的 bash 命令。

**有效性：**
提供的 Python POC 代码利用了该漏洞，通过构造包含特定 Header 的 HTTP POST 请求到 `/mgmt/tm/util/bash` 路径，从而绕过身份验证并执行 `id` 命令。如果目标系统存在漏洞，POC 能够成功执行命令并返回结果，证明了 POC 的有效性。

**投毒风险：**
查看提供的Python脚本和文本文件，未发现明显的恶意代码。脚本的功能符合漏洞利用的描述，主要用于发送HTTP请求，执行命令，没有发现额外的文件写入、网络连接或其他可疑行为。 ip.txt为空文件,可以判定投毒风险较低。

**利用方式：**
1.  攻击者发送带有特定Header（`X-F5-Auth-Token: a`, `Authorization: Basic YWRtaW46`, `Connection: keep-alive, x-F5-Auth-Token`）的 HTTP POST 请求到目标 F5 BIG-IP 设备的 `/mgmt/tm/util/bash` 路径。
2.  POST 请求的 body 中包含一个 JSON 对象，该对象指定要执行的 bash 命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
3.  由于身份验证绕过漏洞，BIG-IP 设备会执行请求中指定的命令，并将结果返回给攻击者。
4.  攻击者可以利用此漏洞执行任意 bash 命令，从而完全控制受影响的 BIG-IP 设备。

**项目地址:** [Henry4E36/CVE-2022-1388](https://github.com/Henry4E36/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)