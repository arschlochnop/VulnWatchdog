## CVE-2023-27163-request-baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF（服务器端请求伪造）

**影响应用:** request-baskets

**危害等级:** 中危，可升级为高危，可能导致内部网络信息泄露和远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 需要目标服务存在且可访问，攻击者需要能访问目标服务器的网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163是request-baskets 1.2.1版本及之前版本中存在的一个服务器端请求伪造(SSRF)漏洞。该漏洞位于`/api/baskets/{name}`组件中。利用方式如下：

1.  **创建恶意Basket:** 攻击者可以利用SSRF漏洞，通过`forward_url`参数指定内部网络的URL，欺骗服务器向内部服务发起请求。PoC中的`ssrf_forward`函数用于创建或重用一个basket，指定`forward_url`为内部地址（例如`http://127.0.0.1`），从而设置SSRF攻击的目标。

2.  **触发RCE:** PoC代码尝试通过修改`/login`接口的username字段来执行系统命令。 具体做法是把bash反弹shell命令注入到username参数中。`trigger_rce`函数构造包含恶意payload的POST请求，发送到目标URL。如果目标系统存在命令注入漏洞，该payload将会被执行。

3.  **反弹Shell:** PoC代码中的`shell.sh`文件包含一个反弹shell的命令。这个脚本会将目标机器的shell反弹到攻击者的机器上。攻击者需要先在自己的机器上监听相应的端口。

**有效性:** 根据漏洞描述、搜索结果以及提供的PoC代码，可以判断该PoC具有较高的有效性。搜索结果中多个链接指向了漏洞的细节和利用代码，表明这是一个公开且经过验证的漏洞。PoC代码完整，实现了SSRF和RCE的利用流程，并且提供了反弹shell的payload示例。

**投毒风险:** 分析提供的PoC代码，未发现明显的投毒代码。该代码的目的是利用SSRF漏洞执行命令，本身就是一个攻击行为。其中没有发现额外植入后门或者恶意代码的痕迹，因此投毒风险为0%。PoC中需要用户自己提供payload file，例如shell.sh，如果用户使用不安全的shell.sh，责任在于用户。

**总结:** 该漏洞的利用方式是通过构造包含内部网络地址的请求，欺骗服务器向内部服务发起请求，并结合命令注入漏洞执行恶意代码。攻击者可以通过反弹shell获取目标系统的控制权。该漏洞的风险在于攻击者可以通过SSRF探测内部网络，并利用命令注入漏洞控制服务器。


**项目地址:** [lukehebe/CVE-2023-27163](https://github.com/lukehebe/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)