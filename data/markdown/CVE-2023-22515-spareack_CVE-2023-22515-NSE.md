## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 高危，可能导致未经授权的管理员账户创建和系统完全控制

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** 目标Confluence实例必须公开可访问且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，允许未经身份验证的远程攻击者创建未经授权的管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**

提供的 Nmap NSE 脚本 POC 代码有效。它通过发送请求到易受攻击的端点并分析响应来检查漏洞的存在。

**投毒风险：**

投毒风险评估为10%。虽然提供的代码主要用于检测漏洞，但存在细微的风险，恶意攻击者可能修改该脚本以包含在成功利用后执行恶意操作的代码。 例如，该脚本可能会被修改为静默地安装后门或收集敏感信息。然而，这种风险较低，因为核心功能是漏洞检测。

**利用方式：**

1.  **绕过身份验证：** 攻击者无需任何凭据即可与 Confluence 服务器进行交互。
2.  **重置安装状态：** 攻击者发送一个请求到 `bootstrapStatusProvider.applicationConfig.setupComplete=false`  端点，有效地将 Confluence 实例重置到未安装状态。
3.  **创建管理员账户：** 攻击者发送一个 POST 请求到 `/setup/setupadministrator.action` 端点，创建一个新的管理员账户。
4.  **完全控制：** 使用新创建的管理员账户，攻击者可以登录并完全控制 Confluence 服务器，包括访问敏感数据，修改配置以及执行任意代码。

**总结：**

该漏洞的利用非常简单，只需要几个 HTTP 请求即可。POC 代码的存在使得利用更加容易。 由于该漏洞允许完全控制受影响的系统，因此具有很高的风险。 建议受影响的用户尽快升级到已修复的版本。

**参考资料：**

*   CISA 建议：[https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a](https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-289a)
*   Rapid7 分析：[https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/](https://www.rapid7.com/blog/post/2023/10/04/etr-cve-2023-22515-zero-day-privilege-escalation-in-confluence-server-and-data-center/)
*   Qualys 分析：[https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515](https://blog.qualys.com/vulnerabilities-threat-research/2023/11/15/atlassian-confluence-broken-access-control-vulnerability-cve-2023-22515)


**项目地址:** [spareack/CVE-2023-22515-NSE](https://github.com/spareack/CVE-2023-22515-NSE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)