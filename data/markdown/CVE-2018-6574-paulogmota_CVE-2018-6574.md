## CVE-2018-6574 - Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 目标系统需要安装存在漏洞的Go版本，并运行 `go get` 命令尝试获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 漏洞存在于 Go 语言的 `go get` 命令中，允许远程命令执行。攻击者可以通过创建一个包含恶意 `.c` 文件的 Go 项目，并利用 `// #cgo CFLAGS: -fplugin=./attack.so` 指令，在目标系统执行任意命令。

**利用方式：**

1.  攻击者创建一个包含 `main.go` 和 `attack.c`（编译后的 `attack.so`）的恶意 Go 项目，其中 `attack.c` 包含要执行的恶意代码。
2.  `attack.c` 文件使用 `__attribute__((constructor))`  修饰 `malicious()` 函数，使其在动态链接库加载时自动执行。
3.  `main.go` 文件使用 `#cgo CFLAGS: -fplugin=./attack.so` 指令，告诉 `go` 命令使用 `attack.so` 作为 GCC 插件。
4.  攻击者将该项目托管到 GitHub 等代码仓库。
5.  诱骗目标用户使用 `go get github.com/<your-handle>/<your-hepo>` 命令获取该项目。
6.  当 `go get` 构建项目时，会调用 GCC 并加载 `attack.so` 插件，导致 `malicious()` 函数执行，从而执行攻击者预设的任意命令。

**有效性：**

提供的 POC 代码有效，可以复现该漏洞。

**投毒风险：**

根据提供的代码，没有发现作者隐藏的投毒代码。`attack.c` 中明确包含恶意代码，是漏洞利用的一部分，不应将其视为投毒代码。 因此，投毒风险为 0%。

**搜索引擎结果印证：**

搜索结果中，[webpage 4] 链接指向 pentesterlab 的练习，明确指出该漏洞允许攻击者通过欺骗用户安装恶意包来执行任意代码。其他的搜索结果也都表明了该漏洞的严重性。

**项目地址:** [paulogmota/CVE-2018-6574](https://github.com/paulogmota/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)