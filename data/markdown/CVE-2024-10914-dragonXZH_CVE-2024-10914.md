## CVE-2024-10914 - D-Link NAS 设备命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS 命令注入

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 固件版本 <= 20241028 (具体版本见漏洞描述)

**利用条件:** 目标设备需开启web服务，攻击者需要能够通过网络访问到受影响的D-Link NAS设备的`account_mgr.cgi`接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10914 存在于 D-Link DNS-320、DNS-320LW、DNS-325 和 DNS-340L NAS 设备中，是一个关键的命令注入漏洞。受影响的函数是 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 中的 `cgi_user_add`，通过操作 `name` 参数，可以执行任意操作系统命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意命令的HTTP GET请求，发送到目标设备的 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 接口，并将恶意命令注入到 `name` 参数中。
2.  服务器解析请求时，由于未正确过滤 `name` 参数，导致恶意命令被执行。

**POC代码有效性：**

提供的Go语言POC代码尝试利用此漏洞。它首先检查目标是否易受攻击，然后允许用户在目标系统上执行任意命令。

**投毒风险分析：**

提供的Go代码主要功能是发送HTTP请求，并解析响应。检查代码，发现`InsecureSkipVerify: true`会跳过TLS证书验证，这存在中间人攻击的风险。但是主要功能是实现漏洞验证和利用。没有明显的恶意代码植入或者后门代码，因此投毒风险较低，大约为5%（主要来自非安全编码实践）。风险来自于代码中的非安全TLS配置，可能允许中间人攻击，而不是直接在payload中插入恶意代码。

**项目地址:** [dragonXZH/CVE-2024-10914](https://github.com/dragonXZH/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)