## CVE-2023-37908-XWiki Rendering-XSS

**漏洞编号:** CVE-2023-37908

**漏洞类型:** XSS

**影响应用:** XWiki Rendering

**危害等级:** 高危，可能导致远程代码执行，信息泄露

**影响版本:** >= 14.6-rc-1, < 14.10.4

**利用条件:** 需要用户交互（鼠标悬停或点击恶意链接），且用户需要登录XWiki系统。

**POC 可用性:** 否

**投毒风险:** 10%

## 详情

CVE-2023-37908是XWiki Rendering的一个XSS漏洞。漏洞存在于XHTML渲染过程中，由于对属性的清理不当，允许攻击者通过构造包含恶意JavaScript代码的链接等方式，在受害者用户的浏览器中执行任意代码。如果受害者是具有编程权限的管理员，则可能导致服务器端代码执行，从而完全控制XWiki实例。提供的POC代码是一个Jenkinsfile，用于构建和测试XWiki项目，与该漏洞的直接利用无关。但是，恶意用户可能会利用此漏洞在XWiki页面中插入恶意链接，诱骗其他用户点击，从而触发XSS攻击。

**有效性：** 根据漏洞信息和搜索结果，该漏洞是真实存在的，并且具有高危风险。但是提供的Jenkinsfile代码与直接利用该漏洞无关，它主要用于构建测试XWiki项目。

**投毒风险：** Jenkinsfile本身是用于自动化构建和测试的脚本。虽然它本身不是漏洞利用代码，但存在一定的投毒风险。一个恶意贡献者可能会修改Jenkinsfile，使其在构建过程中引入恶意依赖项或执行恶意操作。但是，根据对Jenkinsfile内容的分析，它主要执行构建、测试和质量检查等操作，没有明显的恶意代码。因此，判定存在投毒风险的概率为10%。

**利用方式：** 攻击者可以利用XWiki语法在任何支持XWiki语法的页面（例如评论）中插入包含恶意JavaScript代码的链接。当用户将鼠标悬停在恶意链接上时，恶意JavaScript代码将在用户的会话上下文中执行。如果用户具有编程权限，攻击者可以执行服务器端代码，从而完全控制XWiki实例。

**项目地址:** [shoucheng3/xwiki__xwiki-rendering_CVE-2023-37908_14-10-3](https://github.com/shoucheng3/xwiki__xwiki-rendering_CVE-2023-37908_14-10-3)

**漏洞详情:** [CVE-2023-37908](https://nvd.nist.gov/vuln/detail/CVE-2023-37908)