## CVE-2025-56380 - Frappe/ERPNext 时间型盲注

**漏洞编号:** CVE-2025-56380

**漏洞类型:** SQL注入 (时间盲注)

**影响应用:** Frappe Framework / ERPNext

**危害等级:** 高危，可能导致数据泄露、拒绝服务和数据篡改

**影响版本:** Frappe 15.72.4, ERPNext 15.67.0

**利用条件:** 需要身份验证和访问 reporting/client API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-56380 是 Frappe Framework 和 ERPNext 中的一个时间型盲 SQL 注入漏洞。该漏洞位于 `frappe.client.get_value` API 端点，允许经过身份验证的用户通过 `fieldname` 参数注入 SQL 代码。 

**有效性：**
提供的 PoC 代码是有效的。它通过在 `fieldname` 参数中插入时间延迟函数（例如 `sleep(15)`）来利用该漏洞。如果服务器响应时间延迟了约 15 秒，则表明注入成功。

**投毒风险：**
该 PoC 代码看起来比较安全，主要展示了如何利用时间型盲注漏洞进行验证。没有明显的恶意代码或后门。但任何公开的漏洞利用代码都存在被修改并加入恶意代码的风险，因此不能完全排除投毒的可能。作者展示的PoC是sleep函数，较为温和，也没有发现其他恶意代码，因此投毒风险较低，估计为1%。

**利用方式：**
1.  攻击者需要拥有 Frappe/ERPNext 实例的有效帐户，并且该帐户需要有权访问 reporting/client API。
2.  攻击者构造一个包含恶意 SQL 代码的 GET 请求到 `/api/method/frappe.client.get_value`，并将 SQL 代码注入到 `fieldname` 参数中。
3.  通过观察服务器响应时间来判断 SQL 注入是否成功。如果响应时间有明显延迟，则表明注入成功。
4.  利用时间型盲注技术，攻击者可以逐步提取数据库中的敏感数据，或者进行其他恶意操作，如拒绝服务攻击。

**项目地址:** [MoAlali/CVE-2025-56380](https://github.com/MoAlali/CVE-2025-56380)

**漏洞详情:** [CVE-2025-56380](https://nvd.nist.gov/vuln/detail/CVE-2025-56380)