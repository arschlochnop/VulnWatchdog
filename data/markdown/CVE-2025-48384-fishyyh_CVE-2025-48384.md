## CVE-2025-48384 Git配置注入导致任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/符号链接攻击

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0 and < 2.44.4, >= 2.45.0-rc0 and < 2.45.4, >= 2.46.0-rc0 and < 2.46.4, >= 2.47.0-rc0 and < 2.47.3, >= 2.48.0-rc0 and < 2.48.2, >= 2.49.0-rc0 and < 2.49.1, >= 2.50.0-rc0 and < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库或初始化包含恶意配置的子模块。用户需要使用受影响的Git版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理配置文件时，未正确处理和转义回车符（CR）。当 Git 读取配置值时，会删除任何尾部的 CRLF。当写入配置条目时，带有尾部 CR 的值不会被引用，导致配置稍后读取时 CR 丢失。当初始化子模块时，如果子模块路径包含尾部 CR，更改后的路径将被读取，导致子模块被检出到错误的位置。如果存在符号链接将更改后的路径指向子模块的钩子目录，并且子模块包含可执行的 post-checkout 钩子，则在检出后可能会意外执行该脚本。

**有效性：**
提供的POC代码 `/tmp/60afff46543494eb5516e8104e00d576/README.md` 仅包含一个README文件，其内容是关于 CVE-2025-48384 的简单描述。这个文件本身并没有利用漏洞的能力。根据漏洞描述，真正的PoC 需要包含一个具有特定结构的 Git 仓库，包括带尾部CR的子模块路径以及指向钩子目录的符号链接，以及一个恶意的 post-checkout 钩子。因此，仅凭提供的README.md文件无法验证漏洞的有效性，需要进一步的Payload和利用步骤。

**投毒风险：**
提供的POC代码仅为一个README.md文件，不包含任何可执行代码或恶意脚本，因此可以认为投毒风险较低，约为10%。但需要注意，实际的漏洞利用可能涉及其他文件和步骤，不能完全排除恶意代码存在的可能性。

**利用方式：**
1.  **创建恶意仓库：** 创建一个 Git 仓库，其中包含一个子模块。
2.  **构造恶意配置：** 在`.gitmodules`文件中，子模块的路径包含尾部回车符（CR）。例如：`path = submodule_path\r`
3.  **创建符号链接：** 创建一个符号链接，将由于回车符导致错误解析后的子模块路径，指向`.git/modules/<submodule_name>/hooks`目录。
4.  **添加恶意钩子：** 在子模块的`.git/hooks/post-checkout`中添加可执行的恶意脚本。
5.  **诱导用户克隆：** 诱导用户克隆包含恶意配置的仓库。当用户克隆或更新子模块时，由于配置解析错误和符号链接的存在，恶意的 post-checkout 钩子将被执行，从而实现任意代码执行。

**排序优先级说明:**
尽管搜索引擎结果提供了有关漏洞的更多上下文信息，但漏洞库信息提供了最直接的漏洞描述和受影响的版本。POC代码本身不包含利用逻辑，因此优先级最低。综合考虑，应该优先关注漏洞库信息和搜索引擎结果，并结合实际的利用场景进行分析。

**项目地址:** [fishyyh/CVE-2025-48384](https://github.com/fishyyh/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)