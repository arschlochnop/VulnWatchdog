## CVE-2019-9053 - CMS Made Simple News Module 盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和服务器控制

**影响版本:** <= 2.2.9 (受影响的版本为 2.2.8)

**利用条件:** 需要目标CMS安装了News模块，且存在可以通过URL访问的页面，允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053 漏洞存在于 CMS Made Simple 2.2.8 版本中，攻击者可以通过 News 模块中的 `m1_idlist` 参数，构造恶意 URL 实现未授权的盲注 SQL 注入。

**有效性评估：**
根据漏洞信息、搜索结果和提供的漏洞利用代码（`cve.py`），可以判断该漏洞是有效的。漏洞库信息中明确指出存在此漏洞，搜索引擎结果中也提供了相关的漏洞详情和利用代码的链接。提供的 Python 脚本 `cve.py` 是一个用于利用该漏洞的 PoC（Proof of Concept）代码，它通过 time-based 的方式判断 SQL 注入是否成功，从而提取数据库信息。

**投毒风险分析：**
分析 `cve.py` 代码，存在以下几点潜在的投毒风险：

*   **依赖项风险：** 脚本依赖 `requests` 和 `termcolor` 库。如果攻击者替换了这些库的安装源，可能导致安装恶意版本。
*   **Wordlist风险：** 脚本使用了提供的 `best110.txt` 密码字典进行密码破解。攻击者可能会修改这个字典，使其包含恶意payload，例如用于植入后门的恶意代码。
*   **编码问题：** Python 2 和 Python 3 的编码存在差异，这个脚本最初是python2的，后来修复为python3，如果使用不当，例如编码处理不当，可能导致脚本行为异常。
*   **`eval` 或 `exec` 的使用：** 代码中没有直接使用 `eval` 或 `exec` 函数，这降低了直接执行恶意代码的风险。但是，攻击者可能会通过构造 SQL 注入语句来间接执行系统命令，例如写入恶意文件。

综合以上分析，投毒风险较低，大概10%。

**利用方式：**

1.  **确定目标：** 找到安装了 CMS Made Simple 且 News 模块启用的目标站点。
2.  **构造恶意 URL：** 构造包含恶意 SQL 注入语句的 URL，利用 `m1_idlist` 参数进行注入。
3.  **执行盲注：** 通过 time-based 的方式判断 SQL 注入是否成功，从而提取数据库信息。
4.  **密码破解（可选）：** 如果需要破解管理员密码，可以使用提供的 `best110.txt` 密码字典进行暴力破解。
5.  **利用提取的信息：** 攻击者可以使用提取的数据库信息，例如管理员用户名和密码，登录后台并控制整个 CMS 系统。

**缓解措施：**

*   升级 CMS Made Simple 到最新版本 (>= 2.2.10)，该版本修复了此 SQL 注入漏洞。
*   限制对 `moduleinterface.php` 的未授权访问。
*   使用 Web 应用防火墙（WAF）来过滤恶意的 SQL 注入请求。
*   定期检查系统文件，确保没有被篡改。
*   使用强密码，并定期更换密码。

**项目地址:** [ELIZEUOPAIN/CVE-2019-9053-CMS-Made-Simple-2.2.10---SQL-Injection-Exploit](https://github.com/ELIZEUOPAIN/CVE-2019-9053-CMS-Made-Simple-2.2.10---SQL-Injection-Exploit)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)