## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历（Path Traversal）/远程代码执行（RCE）

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，并可能需要启用`mod_cgi`模块且存在`Require all granted`配置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。该漏洞源于 `ap_normalize_path` 函数在路径规范化处理上的缺陷，允许攻击者通过构造包含 URL 编码字符（如 `.%2e`）的恶意 URL，绕过路径遍历保护机制，访问服务器文件系统上受限目录之外的文件。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者利用 `.%2e` 绕过路径规范化，构造恶意 URL 以访问任意文件。例如，`http://target/cgi-bin/.%2e/.%2e/.%2e/etc/passwd` 可以用来尝试读取 `/etc/passwd` 文件。

2.  **远程代码执行（RCE）：** 如果服务器启用了 `mod_cgi` 模块，攻击者可以通过上传恶意 CGI 脚本并利用路径遍历漏洞执行该脚本，从而实现远程代码执行。这通常需要结合服务器配置中 `cgi-bin` 目录的 `Require all granted` 指令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已在野外被利用，POC 代码的存在进一步验证了其有效性。提供的 README.md 文件详细解释了漏洞原理和利用方法，并提供了搭建漏洞环境的步骤。

**投毒风险：**

虽然提供的 README.md 文件主要包含漏洞说明和环境搭建指导，但是依然存在一定的投毒风险。主要考虑到，如果攻击者修改了环境搭建脚本，例如在安装过程中植入后门，则可能导致受害者搭建一个包含恶意代码的 Apache 服务器。所以需要人工审核确认脚本的安全性，这里认为存在10%的投毒风险。

**总结：**

该漏洞的利用依赖于特定的 Apache 版本和服务器配置。成功利用该漏洞可能导致严重的后果，包括敏感信息泄露和远程代码执行。用户应尽快升级 Apache HTTP Server 版本以修复此漏洞。

**项目地址:** [ashique-thaha/CVE-2021-41773-POC](https://github.com/ashique-thaha/CVE-2021-41773-POC)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)