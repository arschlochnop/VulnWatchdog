## CVE-2018-1273-Spring Data Commons-远程代码执行

**漏洞编号:** CVE-2018-1273

**漏洞类型:** 远程代码执行

**影响应用:** Spring Data Commons

**危害等级:** 高危，可能导致远程代码执行和完全控制受影响的系统

**影响版本:** Versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5, and older unsupported versions

**利用条件:** 需要Spring Data REST暴露HTTP资源或使用Spring Data的projection-based request payload binding，且应用程序使用受影响的Spring Data Commons版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-1273是一个存在于Spring Data Commons中的属性绑定漏洞，由于对特殊元素未进行适当的中和处理导致。未经身份验证的远程恶意用户（或攻击者）可以针对Spring Data REST支持的HTTP资源提供特制的请求参数，或者使用Spring Data的基于projections的请求有效负载绑定，从而导致远程代码执行攻击。

**有效性：**
根据漏洞信息和搜索结果，此漏洞的POC代码是存在的，且可以利用。搜索结果中多次提到POC的存在，并有GitHub链接指向POC代码。

**投毒风险：**
提供的代码片段仅仅是Apache License 2.0的许可证文本，不包含任何可执行代码，因此不存在投毒代码。投毒风险为0%。

**利用方式：**
1.  **定位攻击入口点：** 找到使用了Spring Data REST或projection-based request payload binding的HTTP资源。
2.  **构造恶意请求：** 构造包含SpEL表达式的恶意请求参数。这些表达式会被Spring Data Commons解析，从而执行攻击者控制的任意代码。
3.  **触发代码执行：**  发送构造的恶意请求到目标应用程序。如果应用程序使用了存在漏洞的Spring Data Commons版本，且没有进行适当的输入验证和过滤，SpEL表达式将被执行，从而导致远程代码执行。

攻击者通常会利用该漏洞执行系统命令，部署恶意软件，或获取对受影响系统的完全控制。

**项目地址:** [wearearima/poc-cve-2018-1273](https://github.com/wearearima/poc-cve-2018-1273)

**漏洞详情:** [CVE-2018-1273](https://nvd.nist.gov/vuln/detail/CVE-2018-1273)