## CVE-2024-50562 - FortiOS SSL-VPN 会话过期不足漏洞

**漏洞编号:** CVE-2024-50562

**漏洞类型:** 会话管理漏洞

**影响应用:** FortiOS, FortiPAM, FortiProxy SSL-VPN

**危害等级:** 中危，可能允许未经授权的访问 SSL-VPN 资源

**影响版本:** FortiOS 7.6.0, 7.4.6 及以下, 7.2.10 及以下, 7.0 所有版本, 6.4 所有版本；FortiPAM 1.4.0-1.4.1, 1.3.0, 1.2.0, 1.1.0-1.1.2, 1.0.0-1.0.3；FortiProxy 7.6.0, 7.4.0-7.4.5, 7.2.0-7.2.14, 7.0.0-7.0.20, 2.0.0-2.0.14

**利用条件:** 攻击者需要事先获得有效的 SSL-VPN 会话 cookie

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50562 是 Fortinet SSL-VPN 门户中的一个会话管理漏洞，其中经过身份验证的用户会话在注销操作期间未被正确地失效。这使得会话 cookie 在显式注销后仍然有效并可以重复使用，从而可能导致会话劫持攻击。漏洞利用方式如下：

1.  **获取会话 Cookie**：攻击者首先需要获得一个有效的 SSL-VPN 会话 cookie。这可以通过多种方式实现，例如：
    *   拦截用户的网络流量。
    *   从用户处窃取 Cookie。
2.  **用户注销**：用户正常注销 SSL-VPN。
3.  **会话重用**：攻击者使用先前捕获的会话 Cookie，尝试访问 SSL-VPN 门户。由于漏洞的存在，服务器未能正确失效之前的会话，攻击者可以成功绕过身份验证。

POC 代码通过模拟完整的身份验证生命周期来重现该漏洞，包括身份验证、会话 Cookie 分析、显式注销和会话重用验证。它会检查注销后会话 Cookie 是否仍然有效，如果有效，则表明系统存在漏洞。

根据代码分析，未发现明显的投毒代码。

**项目地址:** [Shahid-BugB/fortinet-cve-2024-50562](https://github.com/Shahid-BugB/fortinet-cve-2024-50562)

**漏洞详情:** [CVE-2024-50562](https://nvd.nist.gov/vuln/detail/CVE-2024-50562)