## CVE-2024-25600-WordPress Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** WordPress Bricks Builder

**危害等级:** 高危，允许未经身份验证的远程代码执行（RCE）

**影响版本:** <= 1.9.6

**利用条件:** 目标系统安装了受影响版本的 Bricks Builder 插件，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2024-25600 是 WordPress Bricks Builder 插件中存在的一个未经身份验证的远程代码执行漏洞。攻击者可以利用此漏洞注入并执行任意 PHP 代码。提供的漏洞利用代码 (CVE-2024-25600.py) 首先尝试获取一个 nonce 值，然后构造一个包含恶意 PHP 代码的 POST 请求，发送到 /wp-json/bricks/v1/render_element 或 /?rest_route=/bricks/v1/render_element 端点。如果服务器返回包含 'KHABuhwxnUHDDW' 的响应，则表示漏洞存在。从代码本身来看，没有发现明显的投毒代码。它只是利用已知的漏洞来执行预期的代码注入。

**有效性：** 根据NVD、Red Hat、Sangfor等机构以及github信息，提供的POC代码应该是有效的。

**投毒风险：** 在提供的利用代码中，未发现明显的恶意代码或者后门植入行为。代码的目的是利用漏洞执行预期的代码注入操作，而不是进行其他恶意活动。因此，投毒风险评估为0%。

**利用方式：**
1.  **获取 Nonce (可选):** 某些情况下，可能需要先从目标网站获取一个 nonce 值。POC 代码尝试从 HTML 页面中提取 nonce 值，但根据实际情况可能不需要此步骤。根据https://snicco.io/vulnerability-disclosure/bricks/unauthenticated-rce-in-bricks-1-9-6的披露，nonce验证可以绕过。  
2.  **构造恶意请求:** 构造一个包含 `element` 参数的 JSON payload，该参数包含要执行的 PHP 代码。将 `executeCode` 设置为 `true` 以启用代码执行。
3.  **发送请求:** 将构造的 JSON payload 通过 POST 请求发送到 WordPress 站点的 `/wp-json/bricks/v1/render_element` 或 `/?rest_route=/bricks/v1/render_element` 端点。
4.  **验证结果:** 检查响应中是否包含预期的输出 (例如，POC 中的 'KHABuhwxnUHDDW')，以确认代码已成功执行。

**项目地址:** [k3lpi3b4nsh33/CVE-2024-25600](https://github.com/k3lpi3b4nsh33/CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)