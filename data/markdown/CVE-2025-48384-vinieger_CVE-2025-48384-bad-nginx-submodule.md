## CVE-2025-48384-Git配置注入导致任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 配置注入/符号链接攻击

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互(克隆恶意仓库或初始化恶意子模块)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞允许攻击者通过在 Git 配置中注入包含回车符的恶意数据来执行任意代码。该漏洞的核心在于 Git 处理配置文件中带有尾随回车符的值时存在缺陷。具体来说，当 Git 写入包含尾随回车符的配置条目时，它不会对该值进行引用，导致回车符在后续读取时丢失。这会影响子模块的初始化过程，如果子模块路径包含尾随回车符，则会导致子模块被检出到错误的位置。攻击者可以利用这一点，通过创建一个指向子模块 hooks 目录的符号链接，并在子模块中包含一个可执行的 post-checkout hook。当用户克隆包含恶意配置的仓库或初始化恶意子模块时，`post-checkout` 钩子会被执行，从而导致任意代码执行。

提供的POC利用代码通过`post-checkout` hook 替换系统中的nginx程序，连接攻击者的服务器，反弹shell。 

**漏洞利用方式：**

1.  攻击者创建一个包含恶意 `.gitmodules` 文件的 Git 仓库。该文件包含一个子模块定义，其路径包含一个尾随回车符。
2.  攻击者在仓库中创建一个符号链接，将带有回车符的子模块路径指向 `.git/modules/<submodule>/hooks` 目录。
3.  攻击者在子模块的 hooks 目录中创建一个 `post-checkout` 钩子脚本，该脚本包含要执行的恶意代码。
4.  攻击者将恶意仓库托管在公共平台上或通过其他方式分发给目标用户。
5.  当目标用户克隆恶意仓库或初始化恶意子模块时，Git 会尝试将子模块检出到错误的位置，由于存在符号链接，实际上会将子模块检出到 `.git/modules/<submodule>/hooks` 目录。
6.  在子模块检出后，`post-checkout` 钩子脚本会被执行，从而导致攻击者指定的任意代码在目标系统上运行。

**有效性：**

该POC代码是有效的，可以用于利用 CVE-2025-48384 漏洞执行任意代码。

**投毒风险：**

该POC代码的功能明确，旨在利用该漏洞。从代码逻辑来看，并没有发现隐藏的恶意功能或者后门，可以判定没有投毒风险。

**搜索引擎结果分析：**

搜索结果表明该漏洞是Git配置注入/符号链接攻击漏洞，并且得到了安全社区的广泛关注，各大厂商都发布了安全更新。

**项目地址:** [vinieger/CVE-2025-48384-bad-nginx-submodule](https://github.com/vinieger/CVE-2025-48384-bad-nginx-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)