## CVE-2025-31125-Vite-任意文件读取

**漏洞编号:** CVE-2025-31125

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 受影响版本：>= 6.2.0, < 6.2.4, >= 6.1.0, < 6.1.3, >= 6.0.0, < 6.0.13, >= 5.0.0, < 5.4.16, < 4.5.11

**利用条件:** Vite开发服务器需暴露在网络中（通过--host或server.host配置），且存在用户交互（用户访问恶意URL）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31125是Vite框架中的一个任意文件读取漏洞。该漏洞源于Vite开发服务器对`server.fs.deny`配置的绕过，攻击者可以通过`?inline&import`或`?raw?import`构造恶意URL，读取未授权访问的文件。

**有效性评估：**
提供的POC代码尝试读取`/etc/passwd`和`/etc/hosts`文件。POC代码中包含请求头，base64解码，以及保存输出的功能。根据漏洞描述和POC代码，如果目标Vite服务器存在漏洞且配置允许网络访问，该POC代码**可能有效**。

**投毒风险评估：**
代码整体结构是围绕给定的漏洞进行利用展开的，主要功能集中在构造和发送HTTP请求，解析和解码响应，以及保存结果。  风险点在于：

*   **依赖项风险：** 使用了`requests`, `colorama`, `urllib3`,依赖库本身存在安全问题时，可能引入风险。
*   **输出保存：**  `save_output`函数将数据写入文件，如果目标文件路径被篡改，可能导致意外的文件写入，虽然可能性较低。

总的来说，代码中没有明显的恶意行为，但依赖项的安全性需要考虑，以及输出保存功能可能存在一定的风险。 投毒风险较低，估计为**5%**。

**利用方式：**
1.  攻击者需要找到一个运行着Vite开发服务器，并且该服务器允许从外部网络访问。
2.  攻击者构造包含`?inline&import`或`?raw?import`的恶意URL，例如：`http://target.com/@fs/../../../../etc/passwd?inline&import`。
3.  攻击者诱使用户点击该URL，或者通过其他方式让用户的浏览器向该URL发起请求。
4.  Vite服务器处理该请求时，由于漏洞存在，会绕过文件访问限制，读取`/etc/passwd`文件内容，并将其以base64编码的形式返回给用户浏览器。
5.  攻击者使用base64解码工具，即可获取`/etc/passwd`文件内容，从而可能获取敏感用户信息。

**总结：**
该漏洞的利用需要满足一定的条件，并且需要用户交互，攻击难度较高。漏洞本身可能导致敏感信息泄露，但直接导致远程代码执行的可能性较低。 建议及时升级Vite到安全版本，并避免将开发服务器暴露在公网上。

**项目地址:** [MuhammadWaseem29/Vitejs-exploit](https://github.com/MuhammadWaseem29/Vitejs-exploit)

**漏洞详情:** [CVE-2025-31125](https://nvd.nist.gov/vuln/detail/CVE-2025-31125)