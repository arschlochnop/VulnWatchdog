## CVE-2020-0796-SMBGhost

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可导致远程代码执行，可能导致系统完全控制

**影响版本:** Windows 10 Version 1903, 1909; Windows Server Version 1903, 1909

**利用条件:** 目标系统开启SMBv3服务，攻击者可发起网络请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft Server Message Block 3.1.1 (SMBv3)协议处理特定请求时存在远程代码执行漏洞。漏洞存在于Windows 10 1903和1909版本以及Windows Server 1903和1909版本中。该漏洞是由于SMBv3压缩功能中的一个整数溢出导致的缓冲区溢出。利用方式是通过构造恶意的SMBv3数据包，其中包含特制的压缩转换大小，导致接收方在解压数据时发生缓冲区溢出，从而执行攻击者预先设定的代码。

根据搜索结果，存在公开可用的PoC代码，CISA也警告存在未修补系统容易受到攻击。漏洞的CVSS评分高达10.0，被认为是“wormable”，意味着它有可能在网络中自我复制和传播。

提供的漏洞利用代码是一个批量扫描脚本，目的是利用奇安信的扫描工具对指定IP列表进行扫描。由于其他扫描工具的误报率较高，且奇安信工具不支持批量指定IP，因此编写此脚本实现批量扫描。脚本本身不包含漏洞利用代码，而是用于自动化扫描过程。因此，投毒风险较低，主要风险在于使用的奇安信扫描工具本身可能存在后门或漏洞，或者脚本的使用方式不当可能导致目标系统拒绝服务。但鉴于脚本的目的是为了方便使用商业扫描工具，因此投毒风险主要来自于对商业软件本身安全性的考量，此处评估为10%。

**项目地址:** [F6JO/CVE-2020-0796-Batch-scanning](https://github.com/F6JO/CVE-2020-0796-Batch-scanning)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)