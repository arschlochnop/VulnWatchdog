## CVE-2024-11234-PHP HTTP Request Smuggling

**漏洞编号:** CVE-2024-11234

**漏洞类型:** HTTP请求走私

**影响应用:** PHP

**危害等级:** 中危，可能导致未经授权的资源访问

**影响版本:** 8.1.* before 8.1.31, 8.2.* before 8.2.26, 8.3.* before 8.3.14

**利用条件:** 需要配置代理和开启 "request_fulluri" 选项

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-11234 漏洞存在于 PHP 的 stream 上下文中，当配置了代理并启用 `request_fulluri` 选项时，URI 未被正确过滤，可能导致 HTTP 请求走私。攻击者可以利用此漏洞通过代理发送任意 HTTP 请求，从而访问通常无法从外部访问的资源。

**有效性:**
根据漏洞描述和搜索结果，该漏洞是真实存在的，并且影响了多个 PHP 版本。提供的漏洞利用代码只有 LICENSE 和 README.md 文件，描述了使用汇编语言重现Python编写的漏洞利用程序。因此，当前并没有直接可用的exp，需要自行实现。故`poc_available` 为 `是`，表示存在可利用的可能。

**投毒风险:**
提供的代码仓库只包含LICENSE和README文件。说明文档表示作者正在尝试使用汇编语言重写一个用Python编写的漏洞利用程序。没有实际的攻击代码，因此，该仓库中存在作者隐藏的投毒代码的风险极低，判断投毒风险为0%。

**利用方式:**
1.  **配置代理:** 首先，PHP 应用需要配置使用代理服务器。通常通过 stream 上下文选项进行配置。
2.  **启用 `request_fulluri`:** 确保 stream 上下文中的 `request_fulluri` 选项被设置为 true。这会导致 PHP 在发送请求时包含完整的 URI。
3.  **注入恶意 URI:**  攻击者构造包含恶意字符 (例如 CRLF 序列，如 `\r\n`) 的 URI。由于 PHP 没有正确过滤 URI，这些字符会被传递到代理服务器。
4.  **HTTP 请求走私:**  恶意字符被解释为 HTTP 请求的分隔符，攻击者可以在同一连接中注入额外的 HTTP 请求。这些请求可以 направлены 到不同的服务器或资源，从而实现未授权的访问，进行HTTP请求走私攻击。

该漏洞的利用需要满足特定的配置条件，并且攻击复杂性较高，属于中危漏洞。

**项目地址:** [cyivor/CVE-2024-11234](https://github.com/cyivor/CVE-2024-11234)

**漏洞详情:** [CVE-2024-11234](https://nvd.nist.gov/vuln/detail/CVE-2024-11234)