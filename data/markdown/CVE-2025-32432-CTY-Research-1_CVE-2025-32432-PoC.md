## CVE-2025-32432-CraftCMS-远程代码执行

**漏洞编号:** CVE-2025-32432

**漏洞类型:** 远程代码执行

**影响应用:** CraftCMS

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** 3.0.0-RC1 to 3.9.15, 4.0.0-RC1 to 4.14.15, and 5.0.0-RC1 to 5.6.17

**利用条件:** 无需身份验证，需要网络访问CraftCMS实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32432是CraftCMS中的一个远程代码执行漏洞，存在于资产转换（asset-transform）端点。攻击者可以通过发送特制的请求到`actions/assets/generate-transform`来利用此漏洞。攻击分为两个阶段：首先，利用`FnStream`小工具将任意PHP代码写入`/tmp/sess_<ID>`。然后，利用`FieldLayoutBehavior → PhpManager`小工具强制CraftCMS `require()`这个会话文件，从而执行恶意代码。PoC代码包含两个脚本：`craftcms_rce_php_check.py`用于快速验证PHP代码是否可执行（通过`phpinfo()`），而`craftcms_final_payload.py`包含完整的利用链，允许执行任意shell命令。PoC通过自动化的assetId爆破功能简化了利用过程。投毒风险较低，主要是因为PoC本身需要连接目标服务器，并执行恶意代码，这意味着必须具备一定程度的访问权限才能利用此漏洞进行投毒。主要的风险点在于用户可能在未充分审查代码的情况下直接使用PoC，如果攻击者修改了PoC，例如添加了反向shell或数据窃取功能，那么用户可能会在不知情的情况下执行这些恶意操作。因此，虽然直接投毒风险不高，但修改后的PoC可能被用于传播恶意软件。

**项目地址:** [CTY-Research-1/CVE-2025-32432-PoC](https://github.com/CTY-Research-1/CVE-2025-32432-PoC)

**漏洞详情:** [CVE-2025-32432](https://nvd.nist.gov/vuln/detail/CVE-2025-32432)