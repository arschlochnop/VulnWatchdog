## CVE-2025-8088-WinRAR路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是WinRAR中的一个路径遍历漏洞，允许攻击者通过精心构造的RAR压缩包将恶意文件写入任意目录，包括Windows启动目录，从而实现任意代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用PoC是有效的。搜索引擎结果表明该漏洞已被在野利用，影响广泛，多家安全厂商都发布了相关报告。PoC代码演示了如何创建包含ADS (Alternate Data Stream) payload的RAR压缩包，并利用路径遍历将payload放置在目标目录。

**投毒风险分析：**
PoC代码本身看起来比较直接，目的是演示漏洞利用。但是，由于PoC需要执行系统命令和写入文件，仍然存在一定的投毒风险。具体来说，作者可能在以下几个方面植入恶意代码：

*   **_run_command函数：**  该函数执行shell命令，如果作者在command字符串中插入恶意代码，则可能被执行。
*   **_generate_traversal_path函数：**  该函数生成路径遍历的payload，作者可以在其中插入恶意路径，导致文件写入到非预期位置。
*   **ADS payload：**虽然PoC的README描述了payload通过ADS传递，但main.py代码可能会通过其他方式将恶意代码写入ADS中,从而实现后门.
*   **其他函数：** 代码中还有一些其它的函数也可能会被植入恶意代码。

由于代码量较大，且没有进行完整的代码审计，这里保守估计投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意的RAR压缩包，该压缩包包含一个或多个诱饵文件和一个payload。
2.  Payload通过ADS附加到第一个诱饵文件。
3.  RAR压缩包被构造为使用路径遍历漏洞，将payload写入目标系统的启动目录。
4.  用户解压该RAR压缩包。
5.  Payload（通常是一个可执行文件）被写入启动目录。
6.  当用户下次启动系统时，恶意payload会被执行，导致任意代码执行。


**项目地址:** [walidpyh/CVE-2025-8088](https://github.com/walidpyh/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)