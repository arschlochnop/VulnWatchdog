## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和权限提升

**影响版本:** <= 2.2.9 (根据漏洞利用代码), <= 2.2.8 (根据漏洞库信息), < 2.2.10 (根据搜索引擎结果)

**利用条件:** 需要能够访问存在漏洞的CMS Made Simple实例，并且News模块启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.8（根据漏洞库信息显示）及更早版本（漏洞利用代码显示<=2.2.9,搜索引擎结果显示<2.2.10）中的一个漏洞，存在于News模块中。通过构造恶意的URL，攻击者可以利用`m1_idlist`参数执行未经身份验证的盲注时间型SQL注入。

**有效性:**

提供的POC代码是有效的，因为它利用了时间盲注的原理，通过构造包含`sleep()`函数的SQL查询语句，根据响应时间判断注入是否成功。脚本通过不断尝试字符来dump数据库的salt和管理员密码的哈希值，并可以利用字典进行密码破解。

**投毒风险:**

该POC代码主要功能是利用漏洞，虽然未发现明显的恶意代码或后门植入，但仍存在轻微的风险。

*   **高CPU消耗：**  时间盲注本身依赖于大量的请求和延时，长时间运行可能导致目标服务器的CPU资源耗尽，属于一种拒绝服务攻击。
*   **数据泄露风险：**  成功利用此漏洞可能导致敏感信息（例如，数据库凭据，用户密码哈希）泄露。
*   **依赖外部资源：**  脚本依赖外部的字典文件进行密码破解，如果字典文件本身被篡改，可能会导致破解出的密码不正确，但不会直接危害攻击者或目标系统。

综合考虑，该POC代码的投毒风险较低，约为10%。主要风险在于误用或滥用可能造成的拒绝服务。

**利用方式:**

1.  **确定目标：**  找到运行CMS Made Simple 2.2.9或更早版本的网站，并且News模块已启用。
2.  **构造恶意URL：**  利用POC代码，指定目标URL。POC会构造包含`sleep()`和SQL注入的payload，注入到`moduleinterface.php`的`m1_idlist`参数中。
3.  **信息收集：**  通过时间盲注，脚本会逐步提取数据库信息，例如salt值和管理员密码哈希。
4.  **密码破解：**  如果提供了字典，脚本会使用提取出的salt值和密码哈希进行离线破解。
5.  **权限提升：**  成功破解管理员密码后，攻击者可以登录CMS后台，获得管理员权限，从而控制整个网站。

**缓解措施:**

*   升级CMS Made Simple到2.2.10或更高版本，该版本修复了此漏洞。
*   限制对`moduleinterface.php`的访问。
*   使用Web应用防火墙（WAF）检测和阻止SQL注入攻击。
*   定期审查和更新CMS系统及其模块。

**项目地址:** [byrek/CVE-2019-9053](https://github.com/byrek/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)