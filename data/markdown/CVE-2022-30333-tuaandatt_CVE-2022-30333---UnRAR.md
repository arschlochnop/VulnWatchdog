## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** < 6.12 (Linux/UNIX)

**利用条件:** 目标系统使用受影响的UnRAR版本，并且在解压恶意RAR文件时没有进行适当的安全检查

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-30333是一个存在于RARLAB UnRAR 6.12之前版本(Linux/UNIX)中的目录穿越漏洞。该漏洞允许攻击者通过构造恶意的RAR压缩包，在解压时写入任意文件到目标系统的任意位置。利用方式是，恶意RAR压缩包中包含精心构造的符号链接，该链接在UnRAR进行路径安全检查时，可以绕过检查，但是在后续的路径转换过程中，将Windows路径转换成Unix路径时，`..\..\..\tmp\file` 会被转换为 `../../../tmp/file`，从而实现目录穿越。 攻击者可以利用此漏洞覆盖系统文件，例如`~/.ssh/authorized_keys`，或者结合其他漏洞实现远程代码执行。根据漏洞利用代码的描述，该漏洞被利用于Zimbra Collaboration Suite，通过邮件发送恶意RAR文件，Amavisd自动调用unrar解压，从而实现攻击。

根据提供的漏洞利用代码分析，该代码主要描述了漏洞的原理和利用过程，展示了如何构造恶意的RAR压缩包以及如何通过Zimbra利用该漏洞。 代码本身不包含任何可执行的恶意代码，因此判定投毒风险为0%。

**项目地址:** [tuaandatt/CVE-2022-30333---UnRAR](https://github.com/tuaandatt/CVE-2022-30333---UnRAR)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)