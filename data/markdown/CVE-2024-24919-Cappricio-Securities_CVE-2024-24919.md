## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark versions)

**利用条件:** 需要目标设备已连接到互联网，并且启用了远程访问VPN或移动接入软件模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919是一个存在于Check Point Quantum Gateway、Spark Gateway和CloudGuard Network中的信息泄露漏洞。攻击者可以通过发送特制的HTTP请求，利用路径遍历漏洞读取目标系统上的任意文件。该漏洞的CVSS评分为8.6，属于高危漏洞。CISA已将其添加到已知被利用的漏洞目录(KEV)中，表明该漏洞正在被积极利用。

**漏洞利用方式：**

1.  **利用路径遍历:** 漏洞利用代码表明可以通过构造包含恶意路径的URL来访问受保护的文件。根据搜索结果，攻击者可能使用`../`来逃逸出Web根目录，并访问Gaia OS中的所有文件，从而获取敏感信息。

2.  **发送特制HTTP请求:** 攻击者向存在漏洞的Check Point安全网关发送经过特殊构造的HTTP请求，请求中包含恶意路径。由于网关没有正确验证和过滤用户输入，导致攻击者能够读取任意文件。

**投毒风险分析：**

提供的漏洞利用代码主要包含以下文件：

*   `LICENSE`: MIT许可证，允许自由使用、复制、修改和分发代码。
*   `README.md`: 包含漏洞描述、安装说明、使用方法、免责声明等信息。
漏洞利用代码本身看起来是比较正常的，但集成了Telegram API来实现漏洞检测通知。这部分存在一定的风险，如果攻击者控制了CappricioSecuritiesTools_bot的 Telegram 机器人，则可以通过该机器人推送恶意信息或者收集攻击目标信息。虽然Cappricio Securities声明不对非法使用负责，但用户仍需谨慎。
因此，综合评估，投毒风险约为10%。

**项目地址:** [Cappricio-Securities/CVE-2024-24919](https://github.com/Cappricio-Securities/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)