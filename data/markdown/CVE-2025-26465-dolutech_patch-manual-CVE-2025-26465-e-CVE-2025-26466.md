## CVE-2025-26465 & CVE-2025-26466 - OpenSSH 中间人攻击和DoS漏洞缓解脚本分析

**漏洞编号:** CVE-2025-26465

**漏洞类型:** 中间人攻击 & DoS缓解

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致SSH连接被窃听或服务不可用

**影响版本:** <= 9.9p1 (CVE-2025-26465), 所有版本 (CVE-2025-26466)

**利用条件:** 需要客户端启用VerifyHostKeyDNS（CVE-2025-26465），服务器暴露在公网（CVE-2025-26466）

**POC 可用性:** 是，提供的是缓解脚本

**投毒风险:** 10%

## 详情

提供的脚本并非漏洞利用代码，而是针对CVE-2025-26465和CVE-2025-26466的缓解措施。

**有效性：**

该脚本通过禁用客户端的`VerifyHostKeyDNS`选项来缓解CVE-2025-26465，并调整服务器的`MaxStartups`设置来缓解CVE-2025-26466。根据漏洞信息，CVE-2025-26465允许中间人攻击者在`VerifyHostKeyDNS`启用时冒充合法服务器。因此，禁用此选项是一种有效的缓解措施。调整`MaxStartups`则是通过限制并发连接数量来降低预认证DoS攻击的影响，同样是合理的缓解手段。脚本在修改配置前会备份`sshd_config`，并在重启SSH服务失败时尝试恢复配置，增强了安全性。

**投毒风险：**

尽管脚本的主要功能是缓解漏洞，但仍然存在一定的投毒风险。脚本尝试修改SSH客户端和服务端配置文件，如果恶意修改例如将`MaxStartups`调整为非常小的值，可能会导致正常用户无法连接。虽然脚本会备份配置文件并在重启失败时尝试恢复，但恢复过程可能存在问题，例如权限问题，导致SSH服务无法启动。另外，脚本的作者信息表明来自小型组织，代码质量难以保证。所以投毒风险评估为10%是认为存在很小的被投毒的风险,例如仓库作者后期推送恶意commit。

**利用方式：**

*   **CVE-2025-26465：** 此漏洞的利用方式是中间人攻击。攻击者需要能够拦截客户端和服务器之间的SSH连接，并冒充服务器。如果客户端启用了`VerifyHostKeyDNS`选项，并且攻击者控制了DNS服务器或能够进行DNS欺骗，那么客户端可能会接受攻击者的公钥，从而允许攻击者窃听或篡改SSH连接。攻击的复杂性在于需要满足中间人攻击的条件，并使客户端信任伪造的服务器。
*   **CVE-2025-26466：** 此漏洞的利用方式是拒绝服务攻击（DoS）。攻击者通过发送大量的SSH连接请求，耗尽服务器的资源，导致服务器无法响应正常的连接请求。通过调整`MaxStartups`设置，可以限制服务器可以同时处理的未认证连接数，从而降低DoS攻击的影响。

**项目地址:** [dolutech/patch-manual-CVE-2025-26465-e-CVE-2025-26466](https://github.com/dolutech/patch-manual-CVE-2025-26465-e-CVE-2025-26466)

**漏洞详情:** [CVE-2025-26465](https://nvd.nist.gov/vuln/detail/CVE-2025-26465)