## CVE-2021-30047-VSFTPD-DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 目标FTP服务端口开放且可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-30047是VSFTPD 3.0.3版本中的一个拒绝服务漏洞，由于服务器允许的连接数有限，攻击者可以通过建立大量并发连接耗尽服务器资源，导致服务不可用。PoC代码通过创建多个线程并使用`ftp`命令与目标FTP服务器建立连接来实现。脚本会持续尝试建立连接，直到手动停止或达到预设的15分钟超时时间。超时后，脚本会使用`pkill ftp`命令结束所有ftp进程。关于投毒风险，代码中存在`subprocess.Popen`函数，理论上存在被植入恶意命令的可能，但经过分析，相关代码主要用于启动ftp连接和结束进程，投毒可能性较低。同时`README.md`文件也声明此脚本仅用于教育目的和授权的bug bounty测试。

**项目地址:** [Freitandrey/CVE-2021-30047](https://github.com/Freitandrey/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)