## CVE-2017-7921-Hikvision摄像机未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision摄像机

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞版本，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是海康威视摄像机中存在的一个不当身份验证漏洞。攻击者可以利用此漏洞在未经授权的情况下访问摄像机信息，甚至提升权限。根据漏洞库信息，多个型号和版本的摄像机受到影响。搜索结果表明该漏洞允许未经身份验证的信息泄露，甚至允许访问摄像机快照。提供的POC代码是一个Go语言编写的工具，可以用于检测漏洞、爆破密码和进行漏洞利用（Exp）。

**有效性评估：**
根据提供的漏洞信息，搜索引擎结果和漏洞利用代码，可以判断POC代码有效。因为漏洞库和搜索引擎结果都确认了漏洞的存在，并且提供了相关的分析和利用方法。POC代码提供了验证漏洞、密码爆破的功能，如果能够成功利用，则能够证明该漏洞是有效的。

**投毒风险分析：**
该POC代码存在一定的投毒风险，约10%。主要基于以下几点：
1.  代码中包含密码爆破模块，可能被用于非法用途。
2.  虽然代码提供了POC和EXP，但EXP部分代码未全部展示，存在隐藏恶意行为的可能。但是从代码整体来看，该项目更偏向于漏洞验证和利用，恶意投毒的可能性不高。

**利用方式：**
1.  **信息收集：** 使用POC中的扫描模块，确定目标设备是否存在CVE-2017-7921漏洞。
2.  **未授权访问：** 利用POC代码尝试直接访问受影响的摄像机，获取敏感信息或快照。
3.  **密码爆破：** 如果直接利用失败，则使用POC中的密码爆破模块，尝试破解摄像机的管理员密码。
4.  **权限提升：** 成功破解密码后，登录摄像机管理界面，提升用户权限，获取更高的控制权。

**项目地址:** [BurnyMcDull/CVE-2017-7921](https://github.com/BurnyMcDull/CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)