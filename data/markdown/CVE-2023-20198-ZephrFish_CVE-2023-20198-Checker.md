## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15权限的本地用户，随后可能被用于植入后门和完全控制设备

**影响版本:** 受影响版本：16.1.1 到 17.12.1，以及其他相关版本（详见漏洞库信息）

**利用条件:** 目标设备启用了Web UI功能，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在受影响的 Cisco IOS XE 设备上创建一个具有特权 15 权限（最高权限）的本地用户。该漏洞存在于 Web UI 功能中。根据搜索引擎结果和漏洞库信息，此漏洞已被积极利用。提供的漏洞利用代码 `XEImplantScanner.py` 主要用于扫描目标系统是否存在漏洞以及是否被植入后门。该脚本通过发送特定的 HTTP 请求到 `/webui/logoutconfirm.html` 端点来检测漏洞和后门的存在。

**利用方式：**

1.  **初始访问：** 未经身份验证的攻击者发送特制的 HTTP 请求到目标设备的 Web UI。
2.  **权限提升：** 利用 CVE-2023-20198，创建一个具有特权 15 权限的本地用户。
3.  **后门植入（CVE-2023-20273）：** 使用新创建的具有特权的用户，攻击者可以进一步利用另一个漏洞（CVE-2023-20273）来提升权限至 root，并将植入体写入文件系统，实现持久化控制。

**有效性：**

根据搜索引擎结果（例如，horizon3.ai 的文章）和漏洞库信息，CVE-2023-20198 漏洞已被成功利用。提供的 POC 代码 `XEImplantScanner.py` 旨在检测漏洞的存在以及后门的植入，本身不包含直接利用漏洞进行权限提升的代码，需要结合 CVE-2023-20273 来完全控制。

**投毒风险：**

POC 代码 `XEImplantScanner.py` 主要功能是扫描，相对安全。可能的投毒风险在于：

*   **结果误导：** 扫描结果可能被篡改，导致用户误判系统的安全状态。
*   **依赖风险：** 脚本依赖于 `requests` 库，如果 `requests` 库被恶意版本替换，可能导致代码执行。
*   **网络钓鱼:** 脚本可能被用于钓鱼，诱导用户扫描恶意服务器，泄露信息。

因此，评估的投毒风险为 10%。主要是考虑到其扫描器性质，以及依赖库被投毒的可能性。

**项目地址:** [ZephrFish/CVE-2023-20198-Checker](https://github.com/ZephrFish/CVE-2023-20198-Checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)