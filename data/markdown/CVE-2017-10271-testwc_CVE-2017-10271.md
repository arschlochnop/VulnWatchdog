## CVE-2017-10271 - Oracle WebLogic Server WLS Security 远程命令执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程命令执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可完全控制 WebLogic Server

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的WebLogic，且 T3 端口开放（默认 7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 的一个远程命令执行漏洞，存在于 WLS Security 组件中。未经身份验证的攻击者可以通过 T3 协议发送特制的 XML 消息，利用 WLS Security 组件中的反序列化漏洞，执行任意代码，从而完全控制 WebLogic Server。提供的漏洞利用代码包含两个主要脚本：

1.  `weblogic_wls_wsat_exp.py`：这是主要的漏洞利用脚本，它使用 T3 协议向目标 WebLogic 服务器发送恶意 XML 消息，触发反序列化漏洞，从而执行命令或上传 Webshell。
2.  `weblogic_check_version.py`：此脚本用于检测目标 WebLogic 服务器的版本。它通过发送 HTTP 请求或使用 T3 协议获取版本信息。

利用方式：

1.  使用 `weblogic_check_version.py` 脚本检测目标 WebLogic 服务器的版本，确认目标服务器是否存在漏洞。
2.  使用 `weblogic_wls_wsat_exp.py` 脚本执行命令或上传 Webshell。该脚本需要指定目标 IP 地址和端口，以及要执行的命令或要上传的 JSP 文件。

投毒风险分析：

*   `weblogic_wls_wsat_exp.py`: 该脚本的功能是利用漏洞执行命令或上传webshell，本身是为了验证漏洞的存在和利用方式，不存在明显的恶意代码。
*   `exec.jsp`：该JSP文件用于执行命令，如果被成功上传到目标服务器，攻击者可以通过发送 HTTP 请求来执行任意命令，所以存在一定风险。但是，该文件是漏洞利用的一部分，并非作者故意添加的恶意代码。上传后门存在风险。
*   `weblogic_check_version.py`: 该脚本用于检查目标Weblogic的版本，通过请求头和t3协议进行判断，没有发现恶意代码。

综上所述，该仓库中可能存在的投毒风险较低（约为5%），主要风险在于`exec.jsp`被成功上传后可能带来的安全问题。大部分代码是漏洞利用的必要组成部分，用于验证和利用漏洞，并非隐藏的恶意代码。

**项目地址:** [testwc/CVE-2017-10271](https://github.com/testwc/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)