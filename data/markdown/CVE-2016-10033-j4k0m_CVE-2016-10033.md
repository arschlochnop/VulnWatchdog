## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 需要目标服务器使用存在漏洞的PHPMailer版本，并且使用isMail传输方式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033是PHPMailer 5.2.18之前版本中mailSend函数的一个远程代码执行漏洞。该漏洞允许远程攻击者通过在Sender属性中构造包含\\\"（反斜杠双引号）的恶意参数，向mail命令传递额外的参数，从而执行任意代码。

**有效性：**

提供的POC代码（exploit.sh）看起来是有效的。它利用了`Sender`参数中的注入点，尝试将PHP代码写入到目标服务器的`/var/www/she_l.php`文件中，然后通过访问该文件执行命令。  `--data-raw`参数中构造了恶意的`email`参数，该参数包含用于命令注入的特殊字符和标志。利用curl工具发送精心构造的HTTP请求到目标服务器,如果目标服务器存在此漏洞, 那么就可以利用成功。

**投毒风险：**

*   **POC验证代码：** `/var/www/she_l.php` 是一个简单的webshell后门，允许执行任意命令。虽然这本身是一种恶意行为，但在这个上下文中，它更像是漏洞验证的一部分，而不是作者尝试植入的独立后门。
*   **潜在风险：**  虽然主体的利用代码是用于利用漏洞的，但shell脚本在利用成功后会在目标机器上留下一个webshell。攻击者可以使用这个webshell进一步控制系统。因此，存在一定的被恶意利用的风险。

总的来说，考虑到以上几点，将此仓库判定为**投毒**的可能性较低，但存在一定的风险，所以风险比例为 **10%**。

**利用方式：**

1.  **目标确认：** 确定目标服务器正在运行易受攻击的PHPMailer版本（低于5.2.18）且使用isMail作为邮件传输方式。
2.  **构建Payload：**  构建包含恶意代码的Payload，Payload的核心是`email`参数，需要使用反斜杠双引号`\"`来转义双引号，以便将额外的参数传递给底层的`mail`命令。
3.  **发送请求：**  使用curl或其他HTTP客户端，发送包含Payload的POST请求到目标服务器上调用PHPMailer的接口。
4.  **命令执行：**  如果利用成功，恶意PHP代码将被写入`/var/www/she_l.php`，并通过访问该文件执行指定的命令。然后可以通过webshell执行任意系统命令。

**项目地址:** [j4k0m/CVE-2016-10033](https://github.com/j4k0m/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)