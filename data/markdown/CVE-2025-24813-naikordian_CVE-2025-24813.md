## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，敏感信息泄露以及文件被恶意篡改

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** RCE：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. application was using Tomcat's file based session persistence with the default storage location; 4. application included a library that may be leveraged in a deserialization attack.
信息泄露/文件篡改：1. writes enabled for the default servlet (disabled by default); 2. support for partial PUT (enabled by default); 3. a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads; 4. attacker knowledge of the names of security sensitive files being uploaded; 5. the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，利用 'file.Name' (内部点) 导致远程代码执行 (RCE) 和/或信息泄露和/或通过在 Apache Tomcat 中启用写入的默认 Servlet 将恶意内容添加到上传的文件中。

**有效性：** 根据搜索引擎结果以及漏洞库信息，该漏洞存在PoC，并且已经被利用，因此判断PoC有效。

**投毒风险：** 提供的漏洞利用代码只包含一个`README.md`文件，仅包含 CVE-2025-24813 的名称信息，无法进行漏洞利用。但根据其他的搜索结果，已经存在公开可用的PoC，因此投毒风险较低，但也存在被替换成恶意PoC的可能，估计投毒风险为10%。

**利用方式：**

1.  **信息泄露/文件篡改：**
    *   首先，需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   存在一个安全敏感文件上传的目标 URL，该 URL 是公共文件上传目标 URL 的子目录。
    *   攻击者需要知道安全敏感文件的名称。
    *   安全敏感文件通过 partial PUT 进行上传。
    *   利用路径等效（'file.Name' 中的内部点）来访问和修改安全敏感文件。

2.  **远程代码执行 (RCE)：**
    *   需要启用 Default Servlet 的写入功能（默认禁用）。
    *   Tomcat 必须支持 partial PUT（默认启用）。
    *   应用需要使用 Tomcat 基于文件的会话持久性，并使用默认存储位置。
    *   应用程序需要包含一个可用于反序列化攻击的库。
    *   通过上传包含恶意序列化数据的会话文件，实现远程代码执行。

**项目地址:** [naikordian/CVE-2025-24813](https://github.com/naikordian/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)