## CVE-2025-49113 - Roundcube Webmail RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP 对象反序列化导致远程代码执行

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** <= 1.5.9 和 <= 1.6.10

**利用条件:** 需要目标 Roundcube Webmail 版本存在漏洞且攻击者拥有有效的用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113 是一个存在于 Roundcube Webmail 1.5.10 之前版本以及 1.6.0 到 1.6.11 版本的漏洞。该漏洞允许经过身份验证的用户通过 PHP 对象反序列化执行远程代码。攻击者利用 `_from` 参数在 `program/actions/settings/upload.php` 中未经验证，从而导致 PHP 对象反序列化。 

**有效性评估:**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认此漏洞利用的有效性。

*   漏洞库信息明确指出 `_from` 参数未经验证导致 PHP 对象反序列化。
*   搜索引擎结果提供了大量关于该漏洞的分析和报告，表明该漏洞已被广泛关注和研究。
*   PoC 代码通过构造恶意的序列化对象，并将其作为图片文件名通过上传功能传递到服务器，从而触发反序列化漏洞，执行任意命令。

**投毒风险分析:**

检查提供的 Python PoC 代码后，主要关注以下几个方面：

*   **依赖项:** `requests`, `re`, `sys`, `urllib3`, `base64` 这些都是常见的 Python 库，本身不存在明显的投毒风险。
*   **代码逻辑:**  代码主要功能是登录 Roundcube，构造恶意序列化数据，并作为文件名上传。没有发现明显的后门或者恶意代码。
*   **命令执行:**  PoC 利用反序列化执行用户指定的命令。如果用户执行了恶意命令，那不是 PoC 投毒，而是用户自己的问题。

尽管如此，仍然存在轻微的投毒风险:
* 在Crypt_GPG_Engine类中，command参数没有进行严格的过滤，虽然通过base64编码，一定程度上降低了风险，但还是存在一定可能性，用户在输入command时被注入恶意代码,导致执行其他危险操作。因此，投毒风险评估为10%。

**利用方式:**

1.  **身份验证:**  攻击者需要拥有有效的 Roundcube Webmail 用户名和密码。
2.  **构造恶意序列化数据:**  攻击者使用 `Crypt_GPG_Engine` 类生成包含恶意命令的 PHP 序列化对象。
3.  **上传 Gadget:** 将生成的恶意序列化对象作为图片文件名，通过文件上传功能上传到服务器。
4.  **触发反序列化:**  服务器处理上传的文件时，由于 `_from` 参数未经验证，导致文件名被反序列化，从而执行攻击者指定的命令。
5.  **远程代码执行:** 成功利用该漏洞后，攻击者可以在服务器上执行任意代码，从而获取服务器的控制权。

**项目地址:** [00xCanelo/CVE-2025-49113](https://github.com/00xCanelo/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)