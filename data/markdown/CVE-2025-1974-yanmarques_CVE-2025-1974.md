## CVE-2025-1974-ingress-nginx-RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的权限提升和数据泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问 pod 网络，目标集群使用了受影响版本的 ingress-nginx 且启用了 Validating Admission Controller

**POC 可用性:** 是，但截至2025年3月25日14:00 GMT，已知的RCE利用是未验证的。

**投毒风险:** 20%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 组件中。攻击者如果能够访问 pod 网络，则可能在 ingress-nginx 控制器的上下文中执行任意代码。这可能导致泄露控制能够访问的 Secrets（默认安装情况下，控制器可以访问整个集群的 Secrets）。

**漏洞利用方式：**

根据搜索结果，该漏洞与 ingress-nginx 的配置验证有关，允许攻击者向 Nginx 配置注入恶意指令，从而执行任意代码。

**有效性：**

虽然 rapid7 提到存在未经确认的 POC，但提供的代码仓库只包含 LICENSE 和 README.md 文件，没有实际的漏洞利用代码。因此，无法确定提供的 POC 代码是否有效。有效性取决于是否存在其他的，经过验证的 POC 代码。

**投毒风险：**

提供的代码仓库只包含 LICENSE 和 README.md 文件。LICENSE文件是MIT许可，属于通用许可，没有投毒风险。README.md 文件只包含 CVE 编号，也没有投毒风险。

但考虑到 rapid7 提到存在未经确认的 RCE 利用，且该漏洞允许注入任意 Nginx 指令，如果攻击者发布了包含恶意配置的利用代码，有可能存在投毒风险。例如，攻击者可能在利用代码中包含旨在窃取密钥、修改配置或执行其他恶意操作的指令。因此，在应用任何来自不可信来源的利用代码之前，需要进行彻底的安全审查。

综合考虑，虽然目前提供的代码不存在直接的投毒行为，但是考虑到漏洞本身的特性，以及存在未经确认的POC，所以推测存在20%的投毒风险。

**项目地址:** [yanmarques/CVE-2025-1974](https://github.com/yanmarques/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)