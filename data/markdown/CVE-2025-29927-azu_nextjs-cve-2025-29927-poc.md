## CVE-2025-29927-Next.js Middleware 授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用存在漏洞版本的Next.js，并且授权检查依赖于Middleware。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927 是 Next.js 中间件的一个授权绕过漏洞。当 Next.js 应用的授权检查逻辑位于中间件中时，攻击者可以通过发送包含 `x-middleware-subrequest` 头的请求来绕过这些检查。根据提供的 POC 代码，可以通过设置 `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware` 头来复现此漏洞。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过添加特定的 HTTP 头来绕过中间件的授权检查。

**投毒风险：**
仔细检查了提供的所有文件，包括 README.md、eslint.config.mjs、next.config.ts 和 package-lock.json。未发现任何明显的恶意代码或后门。所有文件都与 Next.js 项目的标准结构和配置相符。

*   README.md 提供了漏洞的描述和复现步骤，看起来是合法的 POC 文档。
*   eslint.config.mjs 定义了 ESLint 的配置，用于代码检查。
*   next.config.ts 是 Next.js 的配置文件，目前是空的，没有包含任何可疑的代码。
*   package-lock.json 锁定了项目依赖的版本，可以验证依赖的完整性。虽然存在依赖投毒的理论可能，但该风险较低。文件本身无问题。

综合所有分析，投毒的可能性非常低，估计为 1%。

**利用方式：**
1.  目标应用必须使用受影响的 Next.js 版本，并且授权逻辑位于中间件中。
2.  攻击者向目标应用发送 HTTP 请求，并在请求头中添加 `X-Middleware-Subrequest: middleware:middleware:middleware:middleware:middleware`。
3.  Next.js 应用在处理请求时，由于漏洞的存在，会错误地认为这是一个内部子请求，从而跳过中间件中的授权检查。
4.  攻击者成功绕过授权，可以访问受保护的资源。

**项目地址:** [azu/nextjs-cve-2025-29927-poc](https://github.com/azu/nextjs-cve-2025-29927-poc)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)