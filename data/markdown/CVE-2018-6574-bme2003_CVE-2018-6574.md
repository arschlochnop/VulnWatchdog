## CVE-2018-6574-go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.8.7, 1.9.x < 1.9.4, 1.10 pre-releases < 1.10rc2

**利用条件:** 目标系统使用存在漏洞的Go版本，且执行了`go get`命令获取包含恶意代码的包。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 允许攻击者通过 `go get` 命令执行任意代码。漏洞原因是 Go 在构建源代码时，没有正确阻止 `-fplugin=` 和 `-plugin=` 参数，攻击者可以利用 gcc 或 clang 的插件功能执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意代码的 Go 包，其中包含一个 `attack.c` 文件和一个 `main.go` 文件。
2.  `attack.c` 文件包含一个 `malicious()` 函数，该函数使用 `system()` 函数执行任意命令。在给定的POC中，执行的命令是`/usr/local/bin/score a10c7b12-8910-4f65-8cd4-a6e57d90686b`。  这个命令很可能是用于提交漏洞利用结果的评分系统。
3.  `main.go` 文件使用 `// #cgo CFLAGS: -fplugin=./attack.so` 指令告诉 Go 编译器将 `attack.c` 编译为共享库 `attack.so`，并将其作为插件加载。
4.  当用户使用 `go get` 命令获取该恶意包时，Go 编译器会自动编译并加载插件，从而执行 `malicious()` 函数中的恶意代码。

**有效性：**

提供的POC代码有效。`main.go`文件中的`// #cgo CFLAGS: -fplugin=./attack.so`指示了利用方式，即通过`go get`拉取代码时，会编译并加载`attack.so`，从而执行预设的恶意代码。

**投毒风险：**

分析POC代码后，没有发现明显的投毒代码。`attack.c` 中的 `system()` 函数执行的命令是明确的，该POC没有包含其他隐藏的恶意行为。因此，投毒风险评估为0%。虽然执行了恶意命令，但这属于漏洞验证所需的操作，不应被视为投毒。


**项目地址:** [bme2003/CVE-2018-6574](https://github.com/bme2003/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)