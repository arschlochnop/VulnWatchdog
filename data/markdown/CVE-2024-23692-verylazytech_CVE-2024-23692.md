## CVE-2024-23692 Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令。

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HTTP File Server 2.3m，且网络可达。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在私有漏洞利用，搜索结果中也包含了利用该漏洞的攻击案例和检测规则。提供的POC代码也证明了可以执行任意命令。

**投毒风险：**
分析提供的POC代码(`/tmp/39e8ac14437cd2343ad255450790e37a/CVE-2024-23692.sh`)，主要功能是构造并发送包含恶意命令的HTTP请求，并解析响应结果。代码中使用了`iconv`和`base64`对命令进行编码，以绕过可能的过滤。代码的目的是利用模板注入漏洞执行系统命令，没有发现明显的恶意投毒代码。LICENSE文件也声明了是MIT开源协议，作者是允许对代码进行修改的。但是, 鉴于任何从互联网下载的代码都存在潜在风险，因此应该谨慎使用，并在受控环境中进行测试，以及对代码进行审查。

**利用方式：**
利用方式是通过向目标 Rejetto HTTP File Server 发送特制的 HTTP GET 请求。这个请求的 `n` 参数和 `cmd` 参数包含经过编码的恶意命令。服务器会解析这些参数，并通过模板注入漏洞执行命令。POC代码中的关键步骤如下：

1.  构造包含命令的payload，使用powershell执行命令。
2.  使用`iconv -t UTF-16LE` 将命令转换为UTF-16LE编码，防止乱码。
3.  使用 `base64 -w 0` 对UTF-16LE编码后的命令进行Base64编码。
4.  构造完整的URL，包含服务器地址和payload。
5.  使用 `curl` 发送请求。
6.  从响应中提取命令执行结果，提取开始和结束标识符`[S]`之间的内容。
7.  输出提取到的命令执行结果。

综上所述，该漏洞利用有效，但使用时应注意潜在风险。

**项目地址:** [verylazytech/CVE-2024-23692](https://github.com/verylazytech/CVE-2024-23692)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)