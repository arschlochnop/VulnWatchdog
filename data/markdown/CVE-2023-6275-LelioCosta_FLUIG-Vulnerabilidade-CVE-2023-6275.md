## CVE-2023-6275 - TOTVS Fluig Platform XSS Vulnerability

**漏洞编号:** CVE-2023-6275

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** TOTVS Fluig Platform

**危害等级:** 中危，CVSS v3.1 评分 6.1，可能导致信息泄露和篡改

**影响版本:** 1.6.x, 1.7.x, 1.8.0, 1.8.1

**利用条件:** 需要用户交互，用户访问包含恶意脚本的URL

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-6275 是 TOTVS Fluig Platform 1.6.x 到 1.8.1 版本中发现的一个反射型跨站脚本漏洞。该漏洞存在于 `/mobileredir/openApp.jsp` 文件中，攻击者可以通过操纵 `redirectUrl` 和 `user` 参数，注入恶意 JavaScript 代码。攻击者可以通过构造包含恶意payload的URL，诱骗用户点击，从而在用户的浏览器中执行恶意脚本。根据提供的POC代码，攻击向量为 `https://fluig.host.com/mobileredir/openApp.jsp?redirectUrl=PAYLOAD` 和 `https://fluig.host.com/mobileredir/openApp.jsp?user=PAYLOAD`，Payload示例为 `"><script>alert(document.domain)</script>` 。

**有效性:** 提供的POC代码有效，可以触发XSS漏洞。

**投毒风险:** 分析POC代码内容，仓库中只包含漏洞描述和利用方法，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，例如：`https://fluig.host.com/mobileredir/openApp.jsp?redirectUrl="><script>alert(document.domain)</script>`
2.  攻击者通过钓鱼或其他方式诱使用户点击该 URL。
3.  用户点击 URL 后，恶意 JavaScript 代码将在用户的浏览器中执行，攻击者可以窃取用户的 Cookie 或执行其他恶意操作。

漏洞修复建议是升级到 1.7.1-231128, 1.8.0-231127 和 1.8.1-231127 版本。

**项目地址:** [LelioCosta/FLUIG-Vulnerabilidade-CVE-2023-6275](https://github.com/LelioCosta/FLUIG-Vulnerabilidade-CVE-2023-6275)

**漏洞详情:** [CVE-2023-6275](https://nvd.nist.gov/vuln/detail/CVE-2023-6275)