## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE), 信息泄露, 文件覆盖

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意文件上传

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 以下条件全部满足时，可导致信息泄露和/或文件覆盖：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），安全敏感上传的目标URL是公共上传目标URL的子目录，攻击者知道安全敏感文件的名称，且安全敏感文件也通过部分PUT上传。以下条件全部满足时，可导致远程代码执行：默认Servlet的写入已启用（默认禁用），支持部分PUT（默认启用），应用程序使用Tomcat基于文件的会话持久化和默认存储位置，应用程序包含可能在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-24813 存在于 Apache Tomcat 的路径等价处理中，攻击者可以通过利用 'file.Name' (内部点) 绕过安全检查。此漏洞可能导致远程代码执行、信息泄露，或通过启用了写入功能的默认Servlet将恶意内容添加到已上传的文件中。根据漏洞库信息和搜索结果，利用条件较为苛刻，需要特定的配置，如启用默认Servlet写入、支持部分PUT等。漏洞利用代码 `CVE_2025_24813.py` 尝试通过 PUT 请求上传恶意 payload 到会话文件存储目录，如果成功，可以触发反序列化漏洞，实现远程代码执行。代码包含检查 Servlet 是否可写的函数 `check_writable_servlet`，以及生成 ysoserial payload 的函数 `generate_ysoserial_payload`或者Java Payload的函数 `generate_java_payload`。该利用方式依赖于 Tomcat 的文件型 session 持久化机制，以及服务器上存在可被利用的反序列化 gadget。 鉴于代码可能包含恶意 payload 生成和上传功能，存在高风险的投毒可能性。

**项目地址:** [absholi7ly/POC-CVE-2025-24813](https://github.com/absholi7ly/POC-CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)