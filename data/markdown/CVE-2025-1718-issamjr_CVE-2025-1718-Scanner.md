## CVE-2025-1718-Hitachi Energy Relion/SAM600-IO FTP 拒绝服务

**漏洞编号:** CVE-2025-1718

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Hitachi Energy Relion 670/650, SAM600-IO

**危害等级:** 高危，可导致设备重启

**影响版本:** <= 2.2.6.3, <= 2.2.5.7, <= 2.2.4.5, <= 2.2.3.7, <= 2.2.2.6, <= 2.2.1.8, <= 2.2.0.13, < 2.1.*, < 2.0.*, < 1.*

**利用条件:** 需要FTP服务开启，以及有效的FTP用户名和密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1718 漏洞存在于 Hitachi Energy Relion 670/650 和 SAM600-IO 系列设备中。经过身份验证的用户，通过FTP访问，可以通过耗尽磁盘空间导致设备重启，造成拒绝服务。

**有效性：**
根据漏洞描述和POC代码，该漏洞利用的有效性较高。POC代码模拟了文件上传，试图耗尽目标设备的磁盘空间。如果目标设备存在此漏洞且磁盘空间管理不当，则极有可能导致设备重启。

**投毒风险：**
分析了提供的 `scanner.py` 和 `requirements.txt` 文件，未发现明显的恶意代码或依赖项。`requirements.txt` 只包含 `termcolor` 一个用于终端输出着色的库，比较常见和安全。`scanner.py` 的主要功能是连接 FTP 服务器，进行身份验证，然后上传一个文件（自身代码文件），尝试填满磁盘空间。虽然理论上可以通过修改上传的文件内容来植入后门，但提供的代码本身并没有这样的行为。`trigger.txt` 只是一个空文件，用于触发漏洞。

风险评估：
*   `scanner.py`：未发现直接的恶意代码，但攻击者如果拿到此代码，可以自行修改 `scanner.py`，在上传的文件中加入恶意代码，达到植入后门的目的。需要注意，提供的scanner.py中上传的文件是其自身，攻击者可以修改为任意文件，加入恶意payload。
*   `requirements.txt`：`termcolor` 库本身没有已知的严重安全问题，风险较低。

由于存在修改上传文件植入恶意代码的可能性，因此投毒风险不能完全排除，此处评估投毒风险为10%。

**利用方式：**
1.  获取目标设备的FTP访问权限，包括用户名和密码。
2.  运行POC脚本，指定目标IP地址、端口、用户名和密码。
3.  POC脚本会连接到目标设备的FTP服务器，进行身份验证。
4.  身份验证成功后，POC脚本会上传一个文件，尝试占用大量磁盘空间。
5.  如果目标设备存在漏洞，并且磁盘空间耗尽，设备将会重启，造成拒绝服务。

**项目地址:** [issamjr/CVE-2025-1718-Scanner](https://github.com/issamjr/CVE-2025-1718-Scanner)

**漏洞详情:** [CVE-2025-1718](https://nvd.nist.gov/vuln/detail/CVE-2025-1718)