## CVE-2018-6789-Exim-base64d缓冲区溢出

**漏洞编号:** CVE-2018-6789

**漏洞类型:** 缓冲区溢出

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.90.1

**利用条件:** 需要能够通过SMTP协议与Exim服务建立连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6789 是 Exim 4.90.1 之前版本中 `base64d` 函数中存在的一个缓冲区溢出漏洞。攻击者可以通过发送特制的 SMTP 消息来触发此漏洞，从而可能导致远程代码执行。

**利用方式：**

1.  利用漏洞需要与 Exim 服务器建立 SMTP 连接。
2.  发送 `EHLO` 命令进行握手。
3.  发送 `MAIL FROM` 和 `RCPT TO` 命令指定发件人和收件人。
4.  发送精心构造的字符串到服务器，触发 `base64d` 函数中的缓冲区溢出。`poc.py` 和 `poc2.py` 脚本都尝试通过发送长字符串（包含大量 'a' 字符）来利用该漏洞。`poc.py` 和 `poc2.py` 首先发送一个较长的'a'字符串，后面跟一个\x7f字符。然后，它们发送`BDAT 1` 命令，接着是另一个字符串，其中包含用 `0xdeadbeef` 填充的区域。 最后，发送 \r\n 和换行符来完成利用。

**有效性：**

根据漏洞信息和利用代码来看，提供的 POC 代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都指向该漏洞的存在以及远程代码执行的可能性。Exploit-DB 上存在公开的 Exploit，进一步佐证了漏洞的可利用性。

**投毒风险：**

分析提供的 `poc.py` 和 `poc2.py` 代码，没有发现明显的恶意代码或后门。代码的主要目的是利用缓冲区溢出漏洞，通过发送特制的输入来覆盖内存，最终实现远程代码执行。虽然利用本身具有恶意性，但脚本本身没有额外的投毒行为。 `README.md` 文件只包含CVE编号, 无任何恶意行为。

因此，投毒风险评估为 0%。

**项目地址:** [c0llision/exim-vuln-poc](https://github.com/c0llision/exim-vuln-poc)

**漏洞详情:** [CVE-2018-6789](https://nvd.nist.gov/vuln/detail/CVE-2018-6789)