## CVE-2022-1388-F5 BIG-IP iControl REST 身份验证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令，完全控制系统

**影响版本:** BIG-IP 16.1.x 版本 < 16.1.2.2, 15.1.x 版本 < 15.1.5.1, 14.1.x 版本 < 14.1.4.6, 13.1.x 版本 < 13.1.5, 以及所有 12.1.x 和 11.6.x 版本

**利用条件:** 目标系统运行受影响的 F5 BIG-IP 版本，并且可以通过网络访问 iControl REST API

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388 是 F5 BIG-IP iControl REST API 中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。利用方式：

1.  **漏洞描述：** 未披露的请求可能绕过 iControl REST 身份验证。
2.  **利用方法：** 攻击者可以通过构造特定的 HTTP 请求，包含特定的头部（例如 `X-F5-Auth-Token: anything` 和 `Authorization: Basic YWRtaW46`），绕过身份验证。
3.  **攻击步骤：**
    *   向 `/mgmt/tm/util/bash` 端点发送 POST 请求。
    *   在请求头中包含上述特定头部。
    *   在请求体中包含要执行的命令，例如 `{"command": "run", "utilCmdArgs": "-c id"}`。
4.  **POC有效性：** 提供的 POC 代码通过发送包含特定头部和命令的 POST 请求来验证漏洞，并执行任意命令。
5.  **投毒风险评估：** 经检查，该POC代码未发现明显的恶意代码或后门，主要功能是利用漏洞进行验证和命令执行。但是，在使用任何第三方提供的代码时，始终存在潜在的风险。非常规判断，判定投毒的概率为1%。

**搜索引擎结果印证：**

*   CISA 已经发布了关于此漏洞的警告，并指出该漏洞已被利用。
*   多个安全厂商（如 Palo Alto Networks 的 Unit 42、Bishop Fox、Cygogito）都发布了关于此漏洞的分析和缓解措施。
*   Splunk 提供了检测此漏洞利用尝试的分析方法。

综上所述，此漏洞风险极高，且POC有效，攻击者可以利用此漏洞完全控制受影响的 F5 BIG-IP 系统。

**项目地址:** [0xf4n9x/CVE-2022-1388](https://github.com/0xf4n9x/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)