## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且使用默认或常见模块配置

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些用户输入时，未进行充分的验证和过滤，导致攻击者可以通过构造恶意的请求，将恶意代码注入到系统，从而实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果以及大量的公开利用代码来看，该漏洞的利用具有很高的有效性。 搜索结果中，许多文章都讨论了该漏洞的利用方法，Metasploit中也有相应的利用模块，Exploit-DB上也有相关的exploit。

**投毒风险：**

提供的漏洞利用代码仅包含GNU GPL许可协议，没有发现直接的恶意代码。但是，任何从不可信来源获取的代码都存在潜在的投毒风险。即使代码本身看起来无害，也可能存在细微的缺陷或依赖关系，这些缺陷或依赖关系可能会被恶意利用。因此，对下载的POC代码进行代码审计是必要的。

考虑到仅仅是LICENSE文件，投毒概率极低，仅为5%。

**利用方式：**

利用方式通常涉及以下步骤：

1.  **发送恶意请求：** 攻击者构造包含恶意代码的特殊请求，该请求通常通过URL参数或POST数据发送。
2.  **利用漏洞：** Drupal在处理该请求时，由于输入验证不足，会将恶意代码传递给PHP的`exec()`或类似函数执行。
3.  **执行任意代码：** 恶意代码在服务器上执行，攻击者可以控制服务器，例如安装后门、窃取数据等。

攻击者可以利用该漏洞执行任意系统命令，从而完全控制受影响的Drupal服务器。该漏洞影响多个Drupal版本，因此影响范围非常广泛。

**项目地址:** [ruthvikvegunta/Drupalgeddon2](https://github.com/ruthvikvegunta/Drupalgeddon2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)