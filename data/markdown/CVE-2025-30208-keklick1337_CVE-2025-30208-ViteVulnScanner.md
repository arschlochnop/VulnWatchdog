## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 受影响版本：< 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** 需要目标应用开启Vite开发服务器并允许网络访问（使用`--host`或`server.host`配置项）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208 是 Vite 中的一个漏洞，允许攻击者绕过 `server.fs.deny` 配置的限制，读取任意文件内容。攻击者通过在 URL 中添加 `?raw??` 或 `?import&raw??`  绕过文件系统访问限制。该漏洞存在的原因是 Vite 在处理 URL 时，对查询字符串的处理存在缺陷。

**有效性分析：**

根据漏洞信息，搜索引擎结果以及漏洞利用代码，可以判断该漏洞存在并且POC代码有效。漏洞利用代码通过构造特殊的URL（包含 `@fs` 和 `?raw??` 或 `?import&raw??`）尝试读取目标服务器上的文件。代码会检查返回的状态码和内容，判断是否成功读取文件。

**投毒风险分析：**

提供的Python脚本主要用于检测目标是否存在CVE-2025-30208漏洞。脚本的功能包括：

1.  **检查虚假路径：**  `check_fake_path` 函数用于初步判断目标服务器是否可能存在漏洞。它尝试访问一个不存在的路径，并根据返回的状态码和内容判断目标是否容易受到攻击。
2.  **漏洞验证：**  `check` 函数尝试利用漏洞读取预定义的路径列表中的文件。它使用不同的URL构造方式（`?raw??` 和 `?import&raw??`）进行尝试。
3.  **多线程扫描：**  `worker` 函数使用多线程加速扫描过程，从队列中获取域名，并调用 `check` 函数进行漏洞验证。
4.  **结果输出：**  `main` 函数解析命令行参数，读取域名列表，并启动多线程扫描。结果会以文本或 JSON 格式输出。

代码没有发现任何用于植入后门或执行恶意操作的片段。所有的操作都是为了验证漏洞的存在。

**利用方式：**

1.  **目标环境准备：** 目标Vite应用需要运行开发服务器，并且允许通过网络访问（通过 `--host` 或 `server.host` 选项）。
2.  **构造恶意URL：** 攻击者构造包含 `@fs` 和 `?raw??` 或 `?import&raw??` 的URL，例如：`http://target.com/@fs/etc/passwd?raw??`。
3.  **发送请求：** 攻击者将构造的URL发送到目标服务器。
4.  **读取文件：** 如果目标存在漏洞，Vite会绕过文件系统限制，将`/etc/passwd`文件的内容返回给攻击者。

**缓解措施：**

1.  升级Vite到安全版本（>= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3）。
2.  避免在生产环境暴露 Vite 开发服务器，尤其不要使用 `--host 0.0.0.0` 或 `server.host: true`。

**项目地址:** [keklick1337/CVE-2025-30208-ViteVulnScanner](https://github.com/keklick1337/CVE-2025-30208-ViteVulnScanner)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)