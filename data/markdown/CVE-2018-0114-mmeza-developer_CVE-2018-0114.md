## CVE-2018-0114 - Node-jose Library JWT 签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 签名伪造

**影响应用:** Node-jose Library

**危害等级:** 高危，允许未授权的远程攻击者使用嵌入在 token 中的密钥重新签名 token，可能导致权限提升和数据篡改。

**影响版本:** < 0.11.0

**利用条件:** 应用程序使用存在漏洞的 Node-jose 库来处理 JWT。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-0114 漏洞存在于 Cisco node-jose 开源库 0.11.0 之前的版本中。由于 node-jose 遵循 JSON Web Signature (JWS) 标准处理 JSON Web Tokens (JWTs)，攻击者可以利用 JWT 规范中允许在 JWS 头部嵌入 JSON Web Key (JWK) 的特性，该 JWK 代表一个公钥，并被信任用于验证。利用方式如下：

1.  攻击者获取一个合法的 JWT。
2.  攻击者移除原始签名。
3.  攻击者在 JWT 头部添加一个新的 JWK，其中包含攻击者控制的公钥。
4.  攻击者使用与头部 JWK 中公钥对应的私钥对修改后的 JWT 进行签名。
5.  应用程序使用存在漏洞的 node-jose 库验证 JWT 时，会信任嵌入的 JWK，从而接受伪造的签名。

提供的 POC 代码旨在演示如何生成包含恶意 JWK 头的 JWT，并使用攻击者的私钥对其进行签名。代码包含生成 RSA 密钥对、构造 JWT 头部和 payload、以及使用私钥进行签名的功能。代码片段存在不完整的部分，例如jwtSign函数未完成，可能需要补充完整才能正常工作。投毒风险评估基于以下几点：

*   代码主要功能是生成和签名 JWT，没有明显的恶意行为。
*   代码依赖的第三方库（如 pycryptodome、PyJWT、PyOpenSSL）本身可能存在安全问题，但这不是代码作者直接引入的。
*   需要注意的是，代码中的密钥生成和使用需要谨慎处理，不安全的密钥管理可能导致安全风险。PATH_PUBLIC_KEY 和 PATH_PRIVATE_KEY 是硬编码路径，如果作者有恶意，可能在其他地方使用这些密钥。

因此，综合考虑，代码存在一定的投毒风险，但可能性较低，约为10%。主要的风险在于不安全的编码实践和对第三方库的依赖。

**项目地址:** [mmeza-developer/CVE-2018-0114](https://github.com/mmeza-developer/CVE-2018-0114)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)