## CVE-2025-29927-Next.js-中间件权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问、数据泄露和权限提升

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用了Next.js中间件进行权限验证，且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件存在的一个权限绕过漏洞。攻击者可以通过发送包含 `x-middleware-subrequest` 标头的特制请求，绕过中间件中的权限验证。漏洞利用方式如下：

1.  **漏洞原理：** Next.js 中间件在处理带有 `x-middleware-subrequest` 标头的请求时，存在校验缺陷，导致权限验证失效。
2.  **攻击步骤：** 攻击者构造包含 `x-middleware-subrequest` 标头的恶意请求，发送到 Next.js 应用程序。
3.  **利用效果：** 成功绕过中间件的权限验证，从而访问受保护的资源或执行未授权操作。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞被认为是真实存在的，并且具有较高的风险等级（CVSS 9.1）。多个安全厂商和研究人员已发布相关报告和分析。

**投毒风险：**
提供的 POC 代码 `NextSploit.py` 主要功能是扫描目标网站，检测 React 版本，并利用 Wappalyzer 工具识别网站技术栈。虽然代码本身没有明显的恶意行为，但存在以下潜在的投毒风险：

*   **依赖项安装：** 代码会自动安装 `wappalyzer`、`requests`、`colorama` 和 `selenium` 等 Python 包。这些包本身是合法的，但如果黑客篡改 `NextSploit.py` 并替换成恶意包，则可能存在安全风险。
*   **subprocess.run 使用：** 代码使用 `subprocess.run` 执行外部命令（如 `wappalyzer`）。如果攻击者能够控制 `scan_command` 变量，就可以执行任意系统命令。
*   **输出文件处理：** 代码将 Wappalyzer 的输出保存到 `output.json` 文件中。如果攻击者能够修改或覆盖此文件，可能会导致信息泄露或拒绝服务。

虽然存在潜在风险，但总体来看，`NextSploit.py` 的投毒风险较低。 代码主要用于信息收集，并没有发现明显的恶意行为。 根据分析,投毒风险约为 10%。

**利用方式：**
攻击者利用该漏洞绕过中间件的身份验证，访问本应受到保护的资源。具体利用方式取决于应用程序的业务逻辑和中间件的配置。例如，攻击者可以绕过身份验证，访问管理员页面、修改用户数据或执行其他敏感操作。

**项目地址:** [AnonKryptiQuz/NextSploit](https://github.com/AnonKryptiQuz/NextSploit)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)