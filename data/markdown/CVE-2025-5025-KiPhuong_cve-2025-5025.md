## CVE-2025-5025 - curl wolfSSL QUIC 证书校验绕过

**漏洞编号:** CVE-2025-5025

**漏洞类型:** 证书校验绕过

**影响应用:** curl

**危害等级:** 中危，可能导致中间人攻击

**影响版本:** <= 8.13.0

**利用条件:** 需要curl使用wolfSSL作为TLS后端，并且使用QUIC协议

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5025 漏洞存在于 libcurl 中，当使用 wolfSSL 作为 TLS 后端并通过 QUIC 协议进行 HTTPS 连接时，证书 pinning 功能失效。这意味着 curl 不会验证服务器证书的公钥是否与预期的 pin 值匹配，攻击者可以利用中间人攻击，使用伪造的证书与客户端通信。

**有效性：**

根据提供的漏洞利用代码，该 POC 看起来有效。它包含以下组件：

*   `docker-compose.yml`：使用 Docker 容器设置了一个测试环境，包括一个真实的服务器（`real-server`）、一个伪造的服务器（`fake-server`）和一个客户端（`client`）。
*   `client/Dockerfile`：构建客户端容器，其中包含构建 curl 所需的步骤，包括克隆和编译 wolfSSL、nghttp3 和 ngtcp2，以及使用这些库构建 curl。
*   `certs/fake.crt`、`certs/fake.csr`：伪造服务器的证书和证书签名请求。
*   `certs/real.crt`、`certs/real.key`：真实服务器的证书和私钥(虽然文件未给出，但是从docker-compose.yml可推断存在)
*   `certs/pinnedkey.pem`：用于 pinning 的证书。客户端会尝试连接到真实服务器并进行证书 pinning。

该 POC 的目的是演示 curl 在使用 wolfSSL 和 QUIC 时，由于证书 pinning 功能失效，客户端能够成功连接到伪造的服务器。

**投毒风险：**

该 POC 具有一定的投毒风险。虽然代码本身似乎是为了演示漏洞，但可能存在作者隐藏的恶意代码。例如：

*   客户端 Dockerfile 中从 GitHub 克隆的 wolfSSL、nghttp3 和 ngtcp2 仓库，以及下载的 curl 压缩包。 如果作者控制了这些仓库或者可以进行中间人攻击篡改下载链接和文件内容，则可以在构建过程中引入恶意代码。

此外，镜像仓库 `kiphong/real-server:latest`、`kiphong/fake-server:latest`、`kiphong/client:latest`本身可能存在风险。但如果使用者自行构建镜像，风险可以大大降低。

综合评估，该 POC 的投毒风险约为 10%。

**利用方式：**

1.  **环境搭建：** 使用 `docker-compose.yml` 构建包含真实服务器、伪造服务器和客户端的测试环境。
2.  **配置 curl：** 客户端使用 Dockerfile 构建，其中配置了 curl 使用 wolfSSL 作为 TLS 后端，并启用了 HTTP/3 和 QUIC 支持。
3.  **证书 Pinning：** 客户端配置了证书 pinning，用于验证服务器证书的公钥。
4.  **中间人攻击：** 由于 CVE-2025-5025 漏洞，当 curl 使用 wolfSSL 和 QUIC 时，证书 pinning 功能失效。攻击者可以部署一个伪造的服务器，并使用伪造的证书与客户端通信。
5.  **数据窃取/篡改：** 客户端在连接到伪造服务器后，可能会发送敏感数据，攻击者可以窃取这些数据。或者，攻击者可以篡改客户端接收到的数据。

该漏洞的成功利用需要攻击者能够拦截客户端与服务器之间的 QUIC 连接，并提供一个伪造的证书。在实际环境中，这可以通过 DNS 欺骗、ARP 欺骗或其他中间人攻击技术来实现。

**项目地址:** [KiPhuong/cve-2025-5025](https://github.com/KiPhuong/cve-2025-5025)

**漏洞详情:** [CVE-2025-5025](https://nvd.nist.gov/vuln/detail/CVE-2025-5025)