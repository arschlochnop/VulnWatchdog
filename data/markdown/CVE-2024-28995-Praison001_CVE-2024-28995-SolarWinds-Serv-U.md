## CVE-2024-28995-SolarWinds-Serv-U 目录遍历

**漏洞编号:** CVE-2024-28995

**漏洞类型:** 目录遍历

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，允许未授权用户读取服务器上的敏感文件

**影响版本:** 15.4.2 HF 1 及之前版本

**利用条件:** 目标服务器运行SolarWinds Serv-U，且版本在受影响范围内，攻击者需要能够通过网络访问Serv-U服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以得出以下结论：

1.  **有效性：**
    *   漏洞库信息明确指出这是一个目录遍历漏洞，允许读取主机上的敏感文件。
    *   搜索结果中多个来源（NVD, Rapid7, Tenable, Wiz等）确认了该漏洞的存在，并描述为高危漏洞，且有在野利用。
    *   提供的POC代码 `exploit.py` 实现了对该漏洞的利用，通过构造包含目录遍历的URL来读取目标服务器上的文件。
    *   该POC代码首先通过探测目标是Windows系统还是Linux系统，分别尝试读取 `Serv-U-StartupLog.txt` 或者 `/etc/passwd` 来验证漏洞是否存在。然后允许用户指定要读取的文件路径。
    *   总体而言，提供的POC代码有效。

2.  **投毒风险：**
    *   分析`exploit.py`代码，该脚本的主要功能是发送HTTP请求，利用目录遍历漏洞读取文件内容。没有发现任何可疑的后门代码，例如执行系统命令、上传文件等。代码逻辑相对简单，主要依赖于`requests`库发送请求。
    *  README.md文件也只是描述了漏洞信息和使用方法，没有包含任何恶意代码。
    *   因此，该仓库中存在作者隐藏的投毒代码的风险很低，评估为0%。

3.  **利用方式：**
    *   攻击者构造包含目录遍历的URL，发送到存在漏洞的SolarWinds Serv-U服务器。
    *   POC代码首先探测目标系统类型（Windows或Linux），通过预设的文件路径判断是否存在漏洞。
    *   如果漏洞存在，攻击者可以输入任意文件路径，服务器会返回该文件的内容（前提是Serv-U进程有权限访问该文件）。
    *   攻击者可以利用此漏洞读取敏感配置文件、日志文件，甚至可能获取系统用户凭据。

4. **排序优先级:** 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息


**项目地址:** [Praison001/CVE-2024-28995-SolarWinds-Serv-U](https://github.com/Praison001/CVE-2024-28995-SolarWinds-Serv-U)

**漏洞详情:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)