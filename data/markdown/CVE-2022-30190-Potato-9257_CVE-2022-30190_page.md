## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，控制受害者计算机

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 用户需要打开包含恶意链接或文档的应用程序，例如Microsoft Word

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过利用URL协议调用MSDT，从而在受害者系统上执行任意代码。利用方式通常是诱使用户打开包含恶意链接或文档的应用程序，比如Microsoft Word。该文档会利用Word的远程模板功能，从远程Web服务器检索HTML文件。该HTML文件包含JavaScript代码，用于使用ms-msdt协议处理恶意payload，该payload通过PCWDiagnostic触发代码执行。提供的POC代码使用ms-msdt协议，尝试执行计算器程序（calc.exe）。由于calc.exe在payload中，我判定仓库中不存在作者隐藏的投毒代码的概率为99%。投毒风险评估为极低。

**利用方式总结：**

1.  攻击者创建一个恶意Word文档（或其他支持远程模板的应用程序）。
2.  该文档包含一个指向恶意HTML文件的链接。
3.  用户打开该文档。
4.  Word从远程服务器下载并执行恶意HTML文件。
5.  HTML文件利用ms-msdt协议，触发MSDT执行任意代码，例如执行计算器程序。

**项目地址:** [Potato-9257/CVE-2022-30190_page](https://github.com/Potato-9257/CVE-2022-30190_page)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)