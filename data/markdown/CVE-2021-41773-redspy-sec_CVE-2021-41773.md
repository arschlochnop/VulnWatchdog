## CVE-2021-41773-Apache HTTP Server-Path Traversal & Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal & Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且配置允许CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。这是一个路径遍历漏洞，攻击者可以利用该漏洞读取服务器上的任意文件，甚至执行任意命令。根据漏洞信息和搜索结果，该漏洞在野外已被积极利用。提供的 POC 代码 `CVE-2021-41773.py` 利用了URL路径遍历漏洞，允许攻击者通过构造特殊的URL访问受限目录之外的文件。如果目标服务器启用了 CGI 脚本执行，攻击者可以通过路径遍历绕过访问控制，执行任意代码。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e` (或等效的 URL 编码) 的 URL，以绕过 Apache 的路径规范化安全检查，从而访问位于 Alias 指令配置目录之外的文件。
2.  **CGI 执行：** 如果目标服务器的配置允许在被 Alias 指令映射的路径上执行 CGI 脚本，则攻击者可以通过 POST 请求将 shell 命令传递给 CGI 脚本来执行任意代码。攻击者发送包含命令的 POST 请求到构造的URL，例如 `http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh`，并在 POST 数据中包含要执行的命令。

**投毒风险：**

代码分析显示，POC脚本主要用于利用漏洞，没有发现任何明显的恶意或隐藏的投毒代码。脚本的功能是利用路径遍历漏洞执行命令，其行为与漏洞利用预期一致。因此，投毒风险评估为 0%。该脚本依赖于目标服务器配置，成功利用需要目标服务器存在漏洞，并开启 CGI 支持。

**项目地址:** [redspy-sec/CVE-2021-41773](https://github.com/redspy-sec/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)