## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中被允许以ALL权限运行命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287 漏洞允许拥有 Runas ALL 权限的攻击者绕过某些策略黑名单和会话 PAM 模块，并导致不正确的日志记录。攻击者可以通过使用精心设计的用户ID（例如 `sudo -u \#$((0xffffffff))`）调用 sudo 来利用此漏洞。根据搜索结果和漏洞库信息，该漏洞存在于 Sudo 1.8.28 之前的版本中。漏洞利用代码（POC）仓库中只包含一个README.md文件，没有发现直接可执行的利用代码，但是提供了漏洞的CVE编号，可以依据该编号构造exp。由于只包含一个说明文件，投毒风险较低，仅为作者添加恶意说明或链接的可能性，因此评估投毒风险为10%。利用方式主要为通过`-u`指定用户ID为`0xffffffff`，从而绕过对root用户的限制，最终以root权限执行任意命令。

**项目地址:** [DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights](https://github.com/DularaAnushka/Linux-Privilege-Escalation-using-Sudo-Rights)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)