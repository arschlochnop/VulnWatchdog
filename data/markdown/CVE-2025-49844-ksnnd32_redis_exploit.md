## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，且攻击者具有执行Lua脚本的权限 (ACL 允许 EVAL/EVALSHA)

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2025-49844 是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。根据漏洞库信息，该漏洞允许经过身份验证的用户，通过构造特制的 Lua 脚本操纵垃圾回收器，从而触发 Use-After-Free 漏洞，最终可能导致远程代码执行。

**有效性分析：**
提供的代码片段与 Redis Lua 脚本漏洞利用无关。这些Python脚本用于音频处理和CSV文件链接，主要功能是：
1.  `csv_linker.py`: 将一个 CSV 文件（`dev_raw.csv`）中的每一行与一个特征文件路径连接起来，生成一个新的 CSV 文件（`dev_linked.csv`）。提取文件名，并将文件名插入到指定的`train-feature/cv-valid`路径下。它假设文件名为 `sample_name`，且相应的特征文件位于 `train-feature/cv-valid/{sample_name}.csv`。
2.  `data_gen.py`: 用于从音频文件（`.mp3`）提取 MFCC 特征，并将特征保存到 CSV 文件中。
3.  `mfcc.py`: 包含用于计算音频文件 MFCC 特征的函数。
4.  `dev_linked.csv`: 展示了 csv_linker.py 脚本的输出。
由于提供的代码与漏洞描述不符，因此提供的POC代码不能用于利用 CVE-2025-49844。

**投毒风险分析：**
提供的 Python 脚本主要功能是处理音频数据和生成CSV文件。脚本本身不存在明显的恶意行为，例如执行系统命令、连接外部服务器或修改系统配置。`data_gen.py` 中用于生成音频特征的算法 (`mfcc.py`) 使用了 `librosa` 库，如果`librosa`库本身存在安全问题，则可能引入间接风险，但这些风险并非脚本作者直接引入的。
因此，判断此仓库中存在作者隐藏的投毒代码的可能性为 0%。

**利用方式分析：**
根据漏洞库信息，利用该漏洞需要构造恶意的 Lua 脚本。攻击者需要具备以下条件：
1.  能够连接到 Redis 服务器。
2.  拥有执行 Lua 脚本的权限（默认情况下，如果未配置 ACL，所有连接都可以执行脚本）。

利用步骤：
1.  编写一个 Lua 脚本，该脚本可以操纵 Redis 的垃圾回收器，并在对象被释放后再次访问该对象。
2.  使用 `EVAL` 或 `EVALSHA` 命令将脚本发送到 Redis 服务器执行。
3.  如果脚本成功触发 Use-After-Free 漏洞，则可能导致 Redis 服务器崩溃或执行任意代码。

缓解措施：
1.  升级到 Redis 8.2.2 或更高版本。
2.  使用 ACL 限制用户执行 `EVAL` 和 `EVALSHA` 命令的权限。

**项目地址:** [ksnnd32/redis_exploit](https://github.com/ksnnd32/redis_exploit)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)