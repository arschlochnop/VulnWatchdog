## CVE-2025-57819-FreePBX-SQL注入

**漏洞编号:** CVE-2025-57819

**漏洞类型:** SQL注入

**影响应用:** FreePBX

**危害等级:** 严重，可能导致未授权访问、数据库操纵和远程代码执行

**影响版本:** < 15.0.66, < 16.0.89, < 17.0.3

**利用条件:** 需要网络访问FreePBX管理界面

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-57819是FreePBX 15、16和17版本中的一个漏洞，它允许未经身份验证的攻击者绕过管理员登录，从而导致任意数据库操作和远程代码执行（RCE）。

**有效性：**

提供的POC代码看起来有效，因为它包含：

*   一个`docker-compose.yml`文件，用于搭建一个包含易受攻击的FreePBX版本的MariaDB + FreePBX 15环境。
*   一个`Makefile`，其中包含用于启动、停止、检查和测试漏洞利用的命令。
*   一个Nuclei模板 (`CVE-2025-57819.yaml`)，用于检测漏洞。该模板通过发送带有SQL注入的请求，并检查响应时间来验证SQL注入漏洞。
*   `scripts/test.sh` 脚本用于快速验证。

具体来说，`Makefile`中的`check`命令通过比较正常请求和注入`SLEEP`函数的请求的响应时间来验证是否存在SQL注入。`test-nuclei`命令使用Nuclei扫描器和提供的模板自动执行此过程。

**投毒风险：**

代码中存在投毒风险的可能性较低，约为5%。虽然存在通过RCE进行更深入的恶意操作的可能性，但提供的代码仓库本身专注于漏洞验证和利用，而非直接的恶意活动。主要原因如下：

*   **漏洞验证性质:** 该仓库的主要目的是提供一个可重现的FreePBX环境来验证CVE-2025-57819。重点在于演示漏洞的存在和利用，而不是部署恶意软件。
*   **社区参与:**  该仓库由多个PoC的引用，意味着有社区监督。恶意代码的存在更容易被发现。
*   **清晰的文档:** `README.md`文件清晰地解释了漏洞利用过程和目的，并包含免责声明，这降低了作者试图隐藏恶意代码的可能性。
*   **docker-compose.yml配置风险:** docker-compose.yml直接对外暴露端口，这可能存在一定的安全风险。

**利用方式：**

该漏洞的利用方式如下：

1.  **未经身份验证的访问：** 攻击者不需要提供任何有效的凭据即可访问FreePBX管理界面。
2.  **SQL注入：** 攻击者利用`userman`模块的AJAX端点（例如`/admin/ajax.php?module=userman&command=checkPasswordReminder`或`/ucp/ajax.php?module=userman&command=checkPasswordReminder`）中的SQL注入漏洞，通过在`username`参数中插入恶意SQL代码来执行任意SQL查询。
3.  **RCE：** 成功利用SQL注入后，攻击者可以进一步利用该漏洞执行远程代码。这通常涉及到写入webshell或修改系统配置文件等操作。

总的来说，该漏洞的利用链条是：未经身份验证的访问 -> SQL注入 -> 远程代码执行。

**项目地址:** [ImBIOS/lab-cve-2025-57819](https://github.com/ImBIOS/lab-cve-2025-57819)

**漏洞详情:** [CVE-2025-57819](https://nvd.nist.gov/vuln/detail/CVE-2025-57819)