## CVE-2020-13942-Apache Unomi-RCE

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要可以访问/context.json接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942是Apache Unomi中存在的一个远程代码执行漏洞。该漏洞是由于Apache Unomi未对/context.json公共端点接收的输入进行充分验证，攻击者可以通过注入恶意的OGNL或MVEL脚本来执行任意代码。

**有效性：**
提供的POC代码通过向/context.json端点发送包含恶意OGNL表达式的POST请求来利用此漏洞。该POC通过检查响应中是否存在特定的字符串（"boom"）来判断目标是否易受攻击，验证了漏洞的有效性。由于1.5.1版本只是部分修复，所以这个POC可以绕过1.5.1版本的修复。

**投毒风险：**
分析提供的漏洞利用代码，该代码主要功能是读取目标列表，并对每个目标发送包含恶意payload的HTTP请求，检查返回结果，判断目标是否存在漏洞，没有发现任何恶意代码，因此推断仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造包含恶意OGNL或MVEL表达式的JSON数据。
2.  攻击者将构造的JSON数据通过POST请求发送到/context.json端点。
3.  Apache Unomi服务端在处理请求时，由于未充分验证输入，导致恶意表达式被执行，从而实现远程代码执行。

**缓解措施：**
*   升级到Apache Unomi 1.5.2或更高版本。
*   限制对/context.json端点的访问。

**项目地址:** [blackmarketer/CVE-2020-13942](https://github.com/blackmarketer/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)