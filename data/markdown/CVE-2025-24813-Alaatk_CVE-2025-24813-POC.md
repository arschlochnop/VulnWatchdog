## CVE-2025-24813 Apache Tomcat 远程代码执行/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露，文件被篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足特定配置条件，包括启用Default Servlet的写入功能，启用partial PUT支持，存在安全敏感文件上传的目标URL位于公共上传目标URL的子目录中，攻击者已知安全敏感文件的名称，以及安全敏感文件通过partial PUT上传。或者，启用Default Servlet的写入功能，启用partial PUT支持，应用程序使用Tomcat基于文件的会话持久性与默认存储位置，应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2025-24813 涉及 Apache Tomcat 的路径等效问题，可能导致远程代码执行、信息泄露或恶意内容添加到上传的文件中。利用条件包括Default Servlet启用了写入，支持partial PUT，以及应用程序的特定配置。搜索引擎结果显示，该漏洞已被公开并被积极利用。

提供的 POC 代码尝试利用该漏洞。它首先使用 `argparse` 处理目标 URL 参数。然后，它包含一段 base64 编码的 payload，该 payload 是一个经过序列化的 Java 对象，旨在执行命令 `touch /tmp/RCE-success`。  该脚本将解码后的payload保存到`decoded_chain.bin`文件中。 然后，使用 `requests.put` 函数，通过构造包含 'Content-Range' 头部的 PUT 请求，利用 Tomcat 的 partial PUT 功能，将payload上传到目标服务器。PUT请求的目标URL是`TARGET_IP/payload.session`。脚本上传完成后删除临时文件。 最后使用Cookie进行getSession。

**有效性评估：** POC 的有效性取决于目标 Tomcat 服务器是否满足漏洞利用的全部条件。如果 Default Servlet 的写入已启用，并且启用了 partial PUT 支持，并且满足其他条件，则 POC 可能有效。

**投毒风险评估：** 仔细检查提供的 POC 代码，没有发现明显的投毒代码。该代码旨在利用已知的 Tomcat 漏洞，而不是在目标系统上植入后门或执行恶意操作。 代码中包含的base64编码的payload部分是最有可能存在风险的部分，但是payload中的命令是`touch /tmp/RCE-success`，该命令仅仅是创建一个文件，用于验证漏洞是否存在，并非恶意操作。

**利用方式总结：**

1.  **条件确认:** 确认目标 Tomcat 服务器启用了 Default Servlet 的写入功能，并启用了 partial PUT 支持，以及是否满足其他相关条件。
2.  **Payload 生成:**  生成一个恶意 Java 序列化对象，该对象可以执行任意代码，或者读取敏感文件。
3.  **Partial PUT 上传:**  使用 HTTP PUT 请求，通过设置 `Content-Range` 头部，将恶意 payload 分块上传到目标服务器上的特定路径（例如，`payload.session`）。
4.  **触发反序列化：**  Tomcat 尝试反序列化上传的文件，从而触发恶意代码的执行。


**项目地址:** [Alaatk/CVE-2025-24813-POC](https://github.com/Alaatk/CVE-2025-24813-POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)