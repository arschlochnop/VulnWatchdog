## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 以及多个重新贴牌版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login)

**危害等级:** 高危，可能导致未授权访问 DVR 设备和视频流

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列及其重新贴牌版本

**利用条件:** 需要网络可达 DVR 设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞允许远程攻击者通过在 HTTP 请求中设置 `Cookie: uid=admin` 头部来绕过身份验证。攻击者可以发送包含此 Cookie 的 `device.rsp?opt=user&cmd=list` 请求，从而获取设备上的用户凭据（用户名和密码）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞的有效性较高。漏洞利用代码通过发送带有特定 Cookie 头的 HTTP 请求来尝试绕过身份验证，并提取返回的凭据信息。

**投毒风险分析：**

提供的 Python 脚本主要功能是利用 CVE-2018-9995 漏洞进行身份验证绕过，没有明显的恶意代码或后门。代码主要用于扫描目标 URL 列表，如果目标存在漏洞则提取用户名和密码。

但是，存在一些潜在的风险：

*   **信息泄露风险：** 该脚本用于提取用户名和密码，如果脚本本身被恶意用户获取，可能会造成进一步的危害。
*   **依赖风险：** 该脚本依赖于 `requests` 等第三方库，如果这些库被篡改，可能会引入安全风险。

由于代码功能相对单一，主要用于漏洞验证和信息提取，因此投毒风险较低，估计在 5% 左右。这个百分比主要考虑到第三方库被篡改的可能性。

**利用方式：**

1.  攻击者构造包含 `Cookie: uid=admin` 头的 HTTP 请求。
2.  将该请求发送到目标 DVR 设备的 `/device.rsp?opt=user&cmd=list` 端点。
3.  如果设备存在漏洞，则会返回包含用户凭据的 JSON 数据。
4.  攻击者解析 JSON 数据，提取用户名和密码。
5.  攻击者可以使用提取到的凭据登录设备或执行其他恶意操作。

**项目地址:** [K3ysTr0K3R/CVE-2018-9995-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2018-9995-EXPLOIT)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)