## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致特权提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或利用网络应用程序中的其他漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 驱动中的一个 use-after-free 漏洞，攻击者可以通过安装恶意应用程序来利用此漏洞，无需用户交互即可获得 root 权限。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞是有效的。漏洞利用代码库（sharif-dev/AndroidKernelVulnerability）提供了触发漏洞并获得 root 权限的 PoC 代码。搜索结果也证实了该漏洞的严重性和实际利用案例，例如 APT 组织 SideWinder 利用此漏洞。

**投毒风险分析：**
提供的 README.md 文件中包含的 PoC 代码（cloudfuzz/android-kernel-exploitation）旨在演示如何触发漏洞并获取 root 权限。虽然此代码本身是为了安全研究目的而创建，但存在被滥用的风险。风险点在于:

1.  **完整性风险：** 任何人都可以 fork 该仓库并添加恶意代码，然后再传播给他人。因此，用户需要仔细检查代码，确保下载和使用的代码没有被篡改。
2.  **滥用风险：** 即使代码本身没有恶意投毒，也可能被恶意用户用于攻击 Android 设备。

基于以上分析，投毒风险评估为10%。这主要是考虑到代码的开源性质和被滥用的可能性。

**漏洞利用方式：**

1.  **漏洞原理：** 该漏洞是 Binder 驱动中的 use-after-free 漏洞，发生在 `binder_thread` 结构体中的 `wait` 成员被释放后，仍然被访问。
2.  **利用步骤：**
    *   打开 `/dev/binder` 设备。
    *   创建一个 epoll 实例，并将 binder 文件描述符添加到 epoll 实例中。
    *   调用 `BINDER_THREAD_EXIT` ioctl，导致 `binder_thread` 结构体被释放。
    *   在 `binder_thread` 结构体释放后，仍然对其进行访问，触发 use-after-free 漏洞。
3.  **特权提升：** 成功利用该漏洞后，攻击者可以在内核上下文中执行任意代码，从而获得 root 权限。

**项目地址:** [sharif-dev/AndroidKernelVulnerability](https://github.com/sharif-dev/AndroidKernelVulnerability)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)