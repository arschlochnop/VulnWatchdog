## CVE-2012-2982 - Webmin file/show.cgi 命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的远程认证用户权限,File Manager模块可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2012-2982漏洞存在于Webmin 1.590及更早版本的`/file/show.cgi`文件中。远程已认证用户可以通过在路径名中使用无效字符（例如`|`管道符）来执行任意命令。根据提供的漏洞利用代码，攻击者首先需要通过Webmin认证，然后利用`/file/show.cgi`文件中的漏洞，在文件路径中注入命令，例如`| 命令`，导致Webmin执行该命令。漏洞利用代码提供了一个Python脚本，可以自动化身份验证、会话ID提取和payload执行。 

**有效性评估：**
根据漏洞信息、搜索引擎结果以及提供的POC代码，该漏洞利用的有效性较高。搜索引擎结果中提到了Metasploit模块和Python脚本，表明存在可用的利用方式。

**投毒风险评估：**
该POC代码主要功能是利用漏洞执行命令，但存在以下潜在的投毒风险：

1.  **后门植入**: 代码中虽然没有明显的后门代码，但攻击者可以轻易地修改payload部分，植入持久化的后门程序，例如修改 Webmin 的配置文件，添加恶意用户等。
2.  **资源消耗**: 攻击脚本可能被修改为消耗目标服务器资源的拒绝服务攻击。
3.  **信息窃取**: 虽然主要功能是命令执行，但可以修改payload窃取敏感信息。

因此，综合评估投毒风险为10%。该风险主要来自于用户在不清楚代码具体功能的情况下，直接使用或者修改该代码，可能被作者植入的恶意代码所利用。

**利用方式：**
1.  **认证：** 使用有效的Webmin用户名和密码进行身份验证。
2.  **会话获取：** 提取经过身份验证的会话ID。
3.  **漏洞触发：** 构造包含恶意命令的请求，通过`file/show.cgi`传递，利用`|`管道符执行任意命令。
4.  **反弹shell：** 提供的PoC中，会反弹shell到攻击者的机器，攻击者需要在攻击机上设置netcat监听端口。

**项目地址:** [SieGer05/CVE-2012-2982-Webmin-Exploit](https://github.com/SieGer05/CVE-2012-2982-Webmin-Exploit)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)