## CVE-2023-4911-glibc-本地权限提升

**漏洞编号:** CVE-2023-4911

**漏洞类型:** 本地权限提升

**影响应用:** glibc

**危害等级:** 高危，允许低权限本地用户提升到root权限

**影响版本:** 2.34 到 2.39 (不包含2.39)

**利用条件:** 目标系统使用受影响的glibc版本，并且存在具有SUID权限的可执行文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4911是一个glibc动态链接器ld.so中的缓冲区溢出漏洞，该漏洞是由于处理GLIBC_TUNABLES环境变量时存在缺陷引起的。利用此漏洞，本地攻击者可以利用恶意构造的GLIBC_TUNABLES环境变量，在启动具有SUID权限的二进制文件时执行具有提升权限的代码，从而获得root权限。

**漏洞利用方式：**

1.  **设置GLIBC_TUNABLES环境变量：** 攻击者需要设置GLIBC_TUNABLES环境变量，该变量包含精心构造的字符串，以便在动态链接器ld.so处理时触发缓冲区溢出。
2.  **执行SUID程序：** 攻击者需要执行一个具有SUID权限的程序。当程序启动时，动态链接器ld.so会加载并处理共享库以及GLIBC_TUNABLES环境变量。
3.  **缓冲区溢出：**  当ld.so处理恶意的GLIBC_TUNABLES值时，会发生缓冲区溢出，允许攻击者覆盖内存中的数据，包括函数指针或其他关键数据结构。
4.  **权限提升：** 通过覆盖内存，攻击者可以将程序执行流程重定向到攻击者控制的代码，这些代码将以root权限执行，从而导致权限提升。

**有效性：**
根据漏洞信息、搜索结果和提供的利用代码，该漏洞利用是有效的。搜索结果中多个链接（例如，Qualys博客，Uptycs博客）确认了该漏洞的存在以及可利用性。

**投毒风险：**
分析提供的POC代码，主要包含一个README.md文件，一个exploit.c文件和一个genlib.py文件。
*   `README.md`: 包含漏洞描述，影响，缓解措施和利用步骤说明，未发现恶意代码。
*   `exploit.c`: 是一个C程序，用于利用该漏洞，检查该文件，主要逻辑是构造恶意GLIBC_TUNABLES，没有发现隐藏的恶意代码，
*   `genlib.py`: 是一个python脚本，用于生成利用该漏洞所需的库文件，检查该文件，没有发现有恶意投毒代码的迹象

总体而言，投毒风险较低。该代码的目的在于演示和利用该漏洞，虽然存在极小的作者出于某种目的添加后门的可能，但整体代码功能符合漏洞利用逻辑，判定投毒风险为1%。

**项目地址:** [NishanthAnand21/CVE-2023-4911-PoC](https://github.com/NishanthAnand21/CVE-2023-4911-PoC)

**漏洞详情:** [CVE-2023-4911](https://nvd.nist.gov/vuln/detail/CVE-2023-4911)