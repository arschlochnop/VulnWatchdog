## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49或2.4.50，并启用CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013漏洞是CVE-2021-41773修复不完全导致的。攻击者可以利用路径遍历漏洞，访问Alias指令配置目录之外的文件。如果这些文件没有被"require all denied"等默认配置保护，请求就会成功。如果CGI脚本也为此路径启用，则可能导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都表明CVE-2021-42013是一个已知的、可利用的漏洞，并且存在公开的PoC。

**利用方式：**
利用方式是构造包含路径遍历的URL，结合CGI脚本执行命令。PoC中的`exploit.sh`脚本使用curl发送包含恶意命令的POST请求到目标服务器。关键点在于使用`--path-as-is`参数，以及双URL编码的路径遍历字符串`%%32%65`，绕过Apache的路径检查。如果目标服务器开启了CGI，并且未对/bin/sh等命令进行限制，则可以执行任意命令。

**投毒风险评估：**
分析提供的Dockerfile、httpd.conf、exploit.sh和README.md文件。

*   Dockerfile： 使用了官方的httpd:2.4.50镜像作为基础镜像,并复制httpd.conf和index.html,未发现恶意行为。
*   httpd.conf：正常的Apache配置文件，用于配置服务器基本信息,没有发现不正常的配置。
*   exploit.sh：这是一个漏洞利用脚本，它本身就是用来执行恶意操作的，**不能算作** 投毒代码。脚本的目的是利用漏洞，而非在目标系统植入后门或者进行其他恶意活动。
*   README.md: 只是说明了如何使用Docker环境来运行漏洞利用代码的步骤.

虽然没有明显的投毒代码，但是利用漏洞本身就可以在目标服务器上执行恶意操作。比如，攻击者可以利用这个漏洞上传webshell，从而长期控制服务器。这种通过漏洞植入后门的风险依然存在，但是从代码本身来看，并没有发现作者预先植入的、非漏洞利用目的的恶意代码。
 综合评估，认为存在10%的投毒风险，主要是因为利用成功后，攻击者可以自行植入恶意代码。

**项目地址:** [jas9reet/CVE-2021-42013-LAB](https://github.com/jas9reet/CVE-2021-42013-LAB)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)