## CVE-2024-11972-Hunk Companion-未授权插件安装

**漏洞编号:** CVE-2024-11972

**漏洞类型:** 未授权插件安装

**影响应用:** Hunk Companion WordPress 插件

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 1.9.0

**利用条件:** 目标 WordPress 站点安装了 Hunk Companion 插件，且版本低于 1.9.0，并且REST API未授权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-11972 允许未经身份验证的攻击者利用不安全的 REST API 端点来安装和激活 WordPress.org 存储库中的任意插件。这可能包括已关闭的有漏洞插件，从而导致远程代码执行。 

**有效性：**
根据提供的漏洞信息、搜索结果以及漏洞利用代码，此漏洞利用是有效的。漏洞库信息明确指出 Hunk Companion WordPress 插件在 1.9.0 之前的版本存在未授权 REST API 端点的问题，允许未经身份验证的请求安装和激活任意插件。搜索结果中也证实了这一点，多个来源 (NVD, Wiz.io, Recorded Future, WPScan, The Hacker News, avleonov.com) 都描述了该漏洞。提供的 POC 代码旨在利用此漏洞，通过发送包含插件名称的特制请求，绕过身份验证，从而安装指定的插件。

**投毒风险：**
检查提供的 Python 脚本 `CVE-2024-11972.py` 和 `README.md` ，初步判断投毒风险较低，约为10%。理由如下：
*   代码功能明确：该脚本旨在利用 CVE-2024-11972 漏洞，功能相对集中。脚本的核心在于构造特定的 HTTP 请求，利用 REST API 接口安装插件。
*   请求的准备函数 (prepare_request_data) 清晰地定义了需要发送的参数,没有发现其他恶意代码。
*   错误处理：脚本包含了一些基本的错误处理机制，例如捕获 HTTPError, ConnectionError, Timeout 和 RequestException。
*   依赖： 脚本主要依赖 `requests` 库，这使得它相对安全。代码本身主要是漏洞利用。
*   检查版本和目标URL参数：代码包含检查目标站点版本的功能，并在版本低于1.9.0的情况下才继续进行攻击. 需要提供URL和plugin两个参数。

虽然总体风险较低，但仍需谨慎：
*   网络请求：该脚本会发送网络请求，可能存在被中间人攻击或重定向到恶意服务器的风险。
*  依赖库风险：requests库如果被篡改则存在极大的风险

**利用方式：**
1.  **确定目标站点：** 攻击者首先需要确定一个运行 Hunk Companion 插件且版本低于 1.9.0 的 WordPress 站点。
2.  **构造请求：** 攻击者使用 POC 代码，指定目标站点的 URL 和要安装的插件名称。
3.  **发送请求：** POC 代码构造一个包含插件信息的 JSON 数据，并通过 POST 请求发送到 WordPress 站点的 `wp-json/hc/v1/themehunk-import` 端点。
4.  **插件安装：** 如果目标站点存在漏洞，且请求成功发送，指定的插件将被安装和激活。
5.  **后续利用：** 攻击者可以安装包含恶意代码的插件，从而控制整个 WordPress 站点，执行任意代码，例如植入后门、篡改内容或窃取数据。

**项目地址:** [Nxploited/CVE-2024-11972-PoC](https://github.com/Nxploited/CVE-2024-11972-PoC)

**漏洞详情:** [CVE-2024-11972](https://nvd.nist.gov/vuln/detail/CVE-2024-11972)