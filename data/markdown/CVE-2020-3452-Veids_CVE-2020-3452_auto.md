## CVE-2020-3452 Cisco ASA/FTD 路径遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 路径遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 需要目标设备启用WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-3452 是一个 Cisco ASA/FTD 软件中的路径遍历漏洞，允许未经身份验证的远程攻击者通过构造恶意 HTTP 请求读取目标系统上的敏感文件。

**有效性：**
提供的POC代码看起来有效。`enum.py` 脚本通过 `file_list.json` 端点递归地枚举目标文件系统，然后使用 `translation-table` 端点下载文件。这种方法与漏洞描述一致，并参考了多个公开的漏洞报告。

**投毒风险：**
*   `README.md`: 包含漏洞利用的说明，没有发现恶意代码。
*   `convert.sh`:  脚本用于将 Lua 字节码文件反编译为可读的 Lua 代码。虽然这个脚本本身不是恶意的，但如果被利用去查看非预期的文件，存在一定的风险，如果该文件后续会被上传到目标，则可能构成潜在的攻击向量。脚本逻辑是：查找所有Lua字节码文件，备份原文件，反编译备份文件，然后用反编译后的内容替换原文件。这个过程可能引入错误或不稳定因素，但从代码本身来看，没有明显的恶意投毒行为。虽然存在利用反编译结果进行进一步攻击的可能，但是该脚本本身进行投毒的风险较低。
*   `enum.py`:  Python 脚本负责枚举文件和下载文件。代码中使用了 `requests` 库发送 HTTP 请求，并禁用了 SSL 证书验证 ( `verify = False`)，虽然这在PoC中很常见，但如果用于实际攻击，则存在中间人攻击的风险。脚本逻辑没有明显的恶意代码，但其目的在于读取目标系统上的文件，可能泄露敏感信息。没有发现直接的投毒行为，只是利用漏洞获取文件。

总的来说，投毒风险较低（约 10%）。主要风险在于下载和反编译的文件可能被恶意利用。

**利用方式：**
1.  运行 `enum.py` 脚本，指定目标 ASA/FTD 设备的 IP 地址或域名。
2.  脚本会利用路径遍历漏洞，递归地枚举目标设备上的文件系统，并将文件列表保存在 `dump` 目录下。
3.  然后脚本会下载枚举到的文件，并保存在 `dump` 目录中，文件名以 `.` 开头，以隐藏文件。
4.  运行 `convert.sh` 脚本，将下载的 Lua 字节码文件反编译为可读的 Lua 代码。
5.  检查下载的文件，查找敏感信息，如用户名、密码、配置信息等。

**项目地址:** [Veids/CVE-2020-3452_auto](https://github.com/Veids/CVE-2020-3452_auto)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)