## CVE-2024-7954 - SPIP porte_plume Plugin 远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意PHP代码。

**影响版本:** 受影响版本：SPIP 4.3.0-alpha (小于 4.3.0-alpha2), 4.2.0 (小于 4.2.13), 4.1.0 (小于 4.1.16)

**利用条件:** 目标系统运行受影响版本的SPIP，并且 porte_plume 插件已启用。攻击者需要能够通过网络访问 SPIP 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以得出以下结论：

**1. 有效性：**

提供的漏洞利用代码看起来是有效的。它针对 SPIP CMS 的 `porte_plume_previsu` 端点，利用该端点的漏洞允许未经身份验证的攻击者通过构造的图像标签注入 PHP 代码，从而执行任意系统命令。提供的 README 文件包含利用示例和截图，展示了执行 `whoami`、`id` 和 `uname -a` 命令的结果，并提供了 Burp Suite 请求/响应的截图，进一步证实了漏洞利用的有效性。搜索引擎结果也表明该漏洞是一个关键的远程代码执行漏洞 (RCE)。

**2. 投毒风险：**

投毒风险评估为10%。虽然漏洞利用代码本身看起来是直接了当的，并且提供了清晰的示例，但仍然存在一些潜在的投毒风险。主要风险在于：
    * **隐蔽的后门：** POC代码本身未检测到明显的后门植入代码，主要风险在于该漏洞本身是RCE，如果其他人修改了POC，并悄悄在利用代码中添加了恶意代码（例如，下载并执行其他恶意脚本或添加系统用户），那么攻击者就可以在受害者系统上建立持久的访问权限。但提供的代码本身不含，因此风险较低。
    * **依赖项：** 该POC依赖于Python环境，是否存在恶意的依赖关系也需要评估。但是根据提供的信息和经验判断，风险较低。

**3. 利用方式：**

漏洞利用方式如下：

1.  **目标确定：** 攻击者首先需要确定运行受影响 SPIP 版本的系统，并且该系统启用了 `porte_plume` 插件。
2.  **漏洞触发：** 攻击者通过发送特制的 HTTP 请求到 `porte_plume_previsu` 端点，在请求中构造包含恶意 PHP 代码的图像标签。
3.  **代码执行：** SPIP 在处理该请求时，会执行注入的 PHP 代码，从而允许攻击者执行任意系统命令。
4.  **命令执行与结果获取：** 攻击者通过 `--cmd` 参数指定要执行的命令，并从响应中获取命令输出。
5.  **代理支持：**  可以使用 `--proxy` 参数通过 Burp Suite 或 ZAP 等代理工具来拦截和修改请求，或者隐藏攻击源。

总而言之，CVE-2024-7954 是一个严重的安全漏洞，允许未经身份验证的远程攻击者在受影响的 SPIP 系统上执行任意代码。虽然提供的 POC 代码看起来是有效的，并且主要用于教育和授权安全测试目的，但用户应该谨慎使用，注意潜在的投毒风险，并确保从可信来源获取代码。该漏洞的利用非常简单，只需构造特定的HTTP请求即可，因此影响较大。

**项目地址:** [r0otk3r/CVE-2024-7954](https://github.com/r0otk3r/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)