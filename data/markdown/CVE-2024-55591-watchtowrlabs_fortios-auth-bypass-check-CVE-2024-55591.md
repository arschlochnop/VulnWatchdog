## CVE-2024-55591-FortiOS/FortiProxy 认证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 认证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可能获得超级管理员权限

**影响版本:** FortiOS 7.0.0 - 7.0.16, FortiProxy 7.0.0 - 7.0.19, FortiProxy 7.2.0 - 7.2.12

**利用条件:** 需要目标设备开放HTTPS端口（通常是443端口）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-55591 存在于 FortiOS 和 FortiProxy 中，允许未经身份验证的远程攻击者通过构造特殊的请求到 Node.js websocket 模块来绕过身份验证，并获得超级管理员权限。 

**漏洞利用方式：**

根据提供的PoC代码，攻击者首先向`/login?redir=/ng`端点发送GET请求，模拟登录行为。然后，向一个包含随机后缀的端点（例如`/watchTowr-{random_suffix}`）发送带有特定WebSocket头的GET请求。如果满足特定条件（例如，HTTP状态码、响应体内容、响应头等），则认为目标存在漏洞。

**有效性分析：**

PoC代码通过模拟特定的HTTP请求交互来验证漏洞的存在。它检查响应的状态码、响应体和响应头，以确定目标是否受到攻击。 根据搜索结果，此漏洞已被在野利用，这表明提供的 PoC 代码具有潜在的有效性。

**投毒风险分析：**

PoC 代码本身的功能是检测目标是否存在 CVE-2024-55591 漏洞，并没有发现明显的恶意代码。投毒的风险较低，大约为5%。但需要注意：
* 该脚本会禁用SSL证书验证，虽然这是为了方便测试，但也可能导致中间人攻击的风险。用户应该意识到这一点，并在生产环境中谨慎使用。
* 攻击者可能会修改该PoC代码，添加恶意功能，然后传播它。因此，从不受信任的来源下载的代码需要仔细审查。

**项目地址:** [watchtowrlabs/fortios-auth-bypass-check-CVE-2024-55591](https://github.com/watchtowrlabs/fortios-auth-bypass-check-CVE-2024-55591)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)