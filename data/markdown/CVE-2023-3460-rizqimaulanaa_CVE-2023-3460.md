## CVE-2023-3460 - Ultimate Member Plugin Unauthenticated Privilege Escalation

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress Plugin

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制网站

**影响版本:** < 2.6.7

**利用条件:** 目标网站安装了存在漏洞版本的Ultimate Member插件，且注册功能开启。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-3460 漏洞存在于 Ultimate Member WordPress 插件 2.6.7 之前的版本中。该漏洞允许未认证的攻击者创建具有任意权限的用户账户，实际上允许攻击者随意创建管理员账户。该漏洞利用方式如下：

1.  **版本检测：**  首先，利用代码会尝试访问 `readme.txt` 文件来确定 Ultimate Member 插件的版本。如果版本低于 2.6.7，则认为存在漏洞。
2.  **获取 Nonce：**  利用代码会访问注册页面，提取注册表单中的 `_wpnonce` 值。这个 nonce 用于防止跨站请求伪造（CSRF）攻击。
3.  **创建管理员账户：**  利用代码构造一个包含管理员权限的注册请求。该请求包括用户名、密码、邮箱以及一个关键参数 `wp_capabilities[administrator]` 设置为 1。通过POST请求发送到注册页面，从而创建一个新的管理员用户。
4.  **利用有效性：**根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞PoC代码是有效的。原因是漏洞信息指出该漏洞被积极利用，PoC代码也提供了一种创建管理员账户的方法。PoC中可以修改用户名、密码、邮箱等，具有一定的灵活性。
5. **投毒风险评估：** 在检查了提供的exp.py和README.md文件后，发现其中可能存在的投毒代码的可能性较低，估计为5%。exp.py主要功能是验证目标版本，并发送POST请求以注册管理员账户，并无发现恶意代码或后门。但始终存在一种风险，即代码中可能存在一些细微的隐藏漏洞，可以被攻击者利用来执行恶意操作。
6. **其他说明：** PoC代码使用了`urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)`禁用了SSL证书验证警告，虽然方便了测试，但在实际环境中应当注意验证目标站点的SSL证书。

**总结：** 漏洞利用方式简单，风险高，利用代码清晰易懂。虽然代码本身看起来没有明显的投毒，但建议在使用任何公开的漏洞利用代码时都要谨慎，并进行代码审计。

**项目地址:** [rizqimaulanaa/CVE-2023-3460](https://github.com/rizqimaulanaa/CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)