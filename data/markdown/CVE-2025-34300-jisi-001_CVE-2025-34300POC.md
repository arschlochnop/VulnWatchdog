## CVE-2025-34300-Sawtooth Lighthouse Studio-模板注入

**漏洞编号:** CVE-2025-34300

**漏洞类型:** 模板注入

**影响应用:** Sawtooth Lighthouse Studio

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.16.14

**利用条件:** 需要网络访问到Lighthouse Studio的ciwweb.pl页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-34300是Sawtooth Software Lighthouse Studio版本9.16.14之前的版本中，由于`ciwweb.pl` Perl web应用程序存在模板注入漏洞所致。未经身份验证的攻击者可以通过构造包含恶意代码的请求，利用该漏洞执行任意命令。

**有效性分析：**

根据漏洞库信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息明确指出存在未授权RCE，搜索结果中也有大量关于该漏洞的讨论和扫描器。POC代码通过向`ciwweb.pl`发送包含特定payload的GET请求进行检测，如果返回结果包含特定的字符串（'39483'），则认为存在漏洞。

**投毒风险分析：**

POC代码本身主要用于检测漏洞是否存在，没有发现明显的恶意代码。代码功能是发送一个包含模板注入payload的HTTP GET请求，并根据响应的内容判断是否存在漏洞。虽然利用成功会导致远程代码执行，但POC本身并不包含任何在目标系统上植入后门或其他恶意组件的代码。因此，投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞点：** `ciwweb.pl` 脚本接受请求参数，并且没有对`hid_Random_ACARAT`参数进行充分的过滤和验证。
2.  **利用方法：** 攻击者构造包含恶意代码的`hid_Random_ACARAT`参数，例如`[%25123*321%25]`。服务器在处理该参数时，会将payload作为模板进行解析，从而执行攻击者注入的命令。
3.  **请求构造：** 攻击者通过发送包含恶意`hid_Random_ACARAT`参数的HTTP GET请求到`/cgi-bin/ciwweb.pl`，触发模板注入。
4.  **结果：** 如果利用成功，服务器将执行攻击者注入的命令，攻击者可以控制服务器。

POC代码的检测原理是通过注入`[%25123*321%25]`，如果服务器返回的结果包含`39483`，则说明注入成功，漏洞存在。

**项目地址:** [jisi-001/CVE-2025-34300POC](https://github.com/jisi-001/CVE-2025-34300POC)

**漏洞详情:** [CVE-2025-34300](https://nvd.nist.gov/vuln/detail/CVE-2025-34300)