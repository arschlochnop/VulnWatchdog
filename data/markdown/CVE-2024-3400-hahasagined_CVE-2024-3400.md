## CVE-2024-3400 PAN-OS GlobalProtect Command Injection

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 严重，未经身份验证的攻击者可以在防火墙上以 root 权限执行任意代码

**影响版本:** PAN-OS 10.2 (< 10.2.9-h1), 11.0 (< 11.0.4-h1), and 11.1 (< 11.1.2-h3)

**利用条件:** 需要目标PAN-OS设备配置了GlobalProtect网关或GlobalProtect门户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建漏洞的存在，未经身份验证的攻击者可以在特定 PAN-OS 版本和配置下，利用此漏洞以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞信息，已经存在公开可用的POC代码，并且该漏洞已被积极利用。搜索结果也表明了这一点，多个安全厂商和研究人员已经发布了关于该漏洞的分析和利用信息，例如Unit 42、Volexity、Zscaler和CrowdStrike。

**投毒风险：**
提供的“漏洞利用代码”实际上是一个IP地址列表（EDL）。虽然看似无害，但如果攻击者将恶意命令注入过程与此列表结合使用，则该列表可以作为攻击基础设施的一部分。此列表本身不包含任何恶意代码，因此直接的“投毒风险”为0%。但是，它可能会被用于后续的攻击活动中，例如建立C&C通信。

**利用方式：**
1.  **任意文件创建：** 攻击者利用 GlobalProtect 功能中存在的漏洞，在目标系统上创建任意文件。
2.  **命令注入：** 攻击者通过构造恶意请求，将恶意命令注入到服务器的操作系统中。
3.  **代码执行：** 注入的命令以 root 权限执行，允许攻击者完全控制受影响的防火墙。例如安装后门。

根据漏洞库信息和搜索结果，成功利用此漏洞需要满足以下条件：
*   目标设备必须运行受影响的 PAN-OS 版本（10.2、11.0 或 11.1）。
*   设备必须配置了 GlobalProtect 网关或 GlobalProtect 门户。

漏洞利用通常涉及发送特制的 HTTP 请求，利用URL中的参数进行命令注入，从而在目标系统上执行任意代码。

**项目地址:** [hahasagined/CVE-2024-3400](https://github.com/hahasagined/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)