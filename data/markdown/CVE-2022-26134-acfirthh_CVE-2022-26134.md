## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** Confluence 服务可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中的一个关键漏洞，允许未经身份验证的攻击者通过 OGNL 注入执行任意代码。漏洞存在于受影响版本的 Confluence 中。根据提供的漏洞利用代码，该 PoC 脚本利用 OGNL 注入漏洞，通过构造特定的 HTTP GET 请求，在目标系统上执行指定的命令。脚本首先检查目标是否可访问，然后尝试获取 Confluence 版本。如果成功，它会构建一个包含恶意 OGNL 表达式的 URL，并发送请求。服务器的响应头中会包含命令执行的结果。

**有效性:** 根据搜索结果和漏洞库信息，该漏洞在野外被积极利用，提供的 PoC 代码能够有效利用该漏洞。

**投毒风险:** 漏洞利用代码本身比较直接，主要就是命令执行，没有发现明显的恶意代码，比如反向shell连接特定IP的情况。但是，任何公开的漏洞利用代码都有可能被修改后用于恶意目的。该PoC本身目的是漏洞验证，如果被滥用，则有投毒的可能性。

**利用方式:**

1.  **目标确定:** 确定运行着受影响版本 Confluence Server 或 Data Center 的目标系统。
2.  **构造Payload:** 使用 PoC 代码或类似工具，构造包含 OGNL 表达式的恶意 URL，URL中包含要执行的命令。
3.  **发送请求:**  向目标系统发送构造好的 HTTP GET 请求。
4.  **命令执行:**  目标系统执行 OGNL 表达式中的命令。
5.  **获取结果:**  从响应头中提取命令执行的结果。

**关于投毒风险补充说明：** PoC 代码中存在一定程度的风险，攻击者可能修改 PoC 代码以进行恶意活动，例如植入后门或进行数据窃取。因此，PoC 代码的使用者应该保持警惕，并采取适当的安全措施。

**项目地址:** [acfirthh/CVE-2022-26134](https://github.com/acfirthh/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)