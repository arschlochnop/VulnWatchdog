## CVE-2025-54782 - NestJS DevTools 远程代码执行

**漏洞编号:** CVE-2025-54782

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** @nestjs/devtools-integration

**危害等级:** 严重，可能导致远程代码执行和系统完全控制

**影响版本:** <= 0.2.0

**利用条件:** 需要开发者本地运行启用了 @nestjs/devtools-integration 的 NestJS 应用，且开发者访问了恶意网站。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 @nestjs/devtools-integration 包中。当启用该包时，它会暴露一个本地开发 HTTP 服务器，该服务器带有一个 API 端点，该端点使用不安全的 JavaScript 沙箱。由于不正确的沙箱处理和缺少跨域保护，恶意网站可以利用此漏洞在开发者的本地机器上执行任意代码。

**漏洞利用方式：**

1.  攻击者诱导开发者访问一个恶意网站。
2.  该恶意网站向开发者本地运行的 NestJS DevTools 服务器的 `/inspector/graph/interact` 端点发送一个 POST 请求。
3.  该请求包含一段精心构造的 JavaScript 代码，该代码可以绕过沙箱限制，并执行任意系统命令。
4.  由于缺少跨域保护，浏览器允许该请求发送到本地服务器。
5.  成功执行后，攻击者可以在开发者机器上执行任意命令，从而可能完全控制系统。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的 POC 代码，该漏洞利用是有效的。POC 代码展示了如何绕过沙箱并执行 `whoami` 命令。多个来源（包括 NVD、Wiz、Socket.dev 等）确认了此漏洞的存在和严重性。

**投毒风险评估：**

提供的 POC 代码本身就是一个利用漏洞的例子，用于验证漏洞的存在。检查 `README.md` 文件，主要用于描述漏洞和提供修复建议，没有发现明显的恶意或隐藏代码。但是，仍然存在以下风险：

*   **依赖风险：** 构建 POC 的过程中可能引入了包含恶意代码的依赖项。
*   **误导性描述：** 代码描述可能存在误导，实际行为与描述不符。
*   **未来修改：** 仓库所有者未来可能添加恶意代码。

综合评估，投毒风险较低，约 10%。风险主要来自于潜在的依赖项风险和未来的代码修改，而非直接存在于当前提供的 `README.md` 文件中。

**项目地址:** [nitrixog/CVE-2025-54782](https://github.com/nitrixog/CVE-2025-54782)

**漏洞详情:** [CVE-2025-54782](https://nvd.nist.gov/vuln/detail/CVE-2025-54782)