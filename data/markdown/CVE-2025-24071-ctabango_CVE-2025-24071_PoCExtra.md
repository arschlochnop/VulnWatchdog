## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 欺骗漏洞 (Spoofing)

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致敏感信息泄露和SMB relay攻击

**影响版本:** 受影响版本包括 Windows 10, Windows Server 2019, Windows Server 2022, Windows 11 等，具体版本范围参见漏洞库信息。

**利用条件:** 攻击者需要能够诱骗用户打开特制的 .searchconnector-ms 文件，并与攻击者控制的SMB服务器建立连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 是一个 Windows 文件资源管理器欺骗漏洞。该漏洞允许未经授权的攻击者通过网络执行欺骗攻击，从而暴露敏感信息。PoC代码利用`.searchconnector-ms`文件格式，该文件包含指向网络共享的URL。当用户在文件资源管理器中访问此类文件时，Windows会自动尝试连接到指定的共享。攻击者可以通过在`.searchconnector-ms`文件中嵌入指向恶意SMB服务器的URL，诱使用户的计算机自动向该服务器进行身份验证，从而可能窃取用户的NTLM哈希或进行SMB relay攻击。PoC代码`poc2.py`用于生成包含恶意SMB服务器IP地址的`.searchconnector-ms`文件。通过分析代码，未发现明显的投毒代码。该漏洞的利用方式是诱骗目标用户打开攻击者构造的 `.searchconnector-ms` 文件，导致 Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器，从而泄露用户的网络身份验证信息。

根据搜索结果和漏洞库信息，此漏洞的严重程度评级为高危 (CVSS 7.5)，但利用起来需要一定的社会工程学技巧。尽管 CVSS 分数较高，实际利用的威胁相对较低，因为它需要用户交互，并非远程代码执行。

**有效性：** 提供的 PoC 代码有效，可以用于生成恶意 `.searchconnector-ms` 文件，从而触发漏洞。

**投毒风险：** 通过检查提供的代码，未发现明显的投毒风险。该代码功能简单，仅用于创建具有指定 IP 地址的 `.searchconnector-ms` 文件。但是，始终建议在受控环境中运行 PoC 代码。

**利用方式：**
1.  攻击者创建一个恶意的 `.searchconnector-ms` 文件，其中包含指向攻击者控制的 SMB 服务器的链接。
2.  攻击者通过电子邮件、即时消息或其他方式将该文件发送给受害者。
3.  受害者打开该文件。
4.  Windows 文件资源管理器尝试连接到攻击者控制的 SMB 服务器。
5.  如果受害者使用其 Windows 帐户进行身份验证，则攻击者可以捕获受害者的 NTLM 哈希，或者利用 SMB relay攻击。

**项目地址:** [ctabango/CVE-2025-24071_PoCExtra](https://github.com/ctabango/CVE-2025-24071_PoCExtra)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)