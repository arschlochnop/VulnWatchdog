## CVE-2025-9074 - Docker API 未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危，可导致主机文件系统完全控制

**影响版本:** 4.25 直到 4.44.3之前

**利用条件:** Linux容器能够访问Docker Engine API的默认配置子网 (192.168.65.7:2375)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-9074 允许本地运行的Linux容器通过配置的Docker子网访问Docker Engine API，默认位于192.168.65.7:2375。此漏洞的利用方式如下：

1.  **漏洞描述：** Docker Desktop暴露了Docker Engine API，且默认配置下未进行身份验证。这意味着任何能够访问该API的进程（包括容器内的进程）都可以执行特权操作。

2.  **利用方式：**
    *   攻击者首先需要在目标Docker Desktop环境中运行一个Linux容器。
    *   在该容器内部，攻击者利用PoC脚本，该脚本会尝试连接到Docker Engine API (192.168.65.7:2375)。
    *   由于API未进行身份验证，攻击者可以利用API执行任意操作，例如：
        *   拉取恶意镜像。
        *   创建新的容器，并将主机的根文件系统挂载到容器内部。这将允许容器内的进程读取和修改主机上的任何文件。
        *   控制其他容器，包括停止、启动、删除等。

3.  **有效性评估：** 提供的PoC代码是有效的，因为它实现了上述利用过程。代码主要通过`requests`库与Docker API交互，创建并运行一个可以访问主机文件系统的容器。

4.  **投毒风险评估：** PoC代码本身是为了演示漏洞利用，虽然作者声明与Gemini AI共同开发，但是其拉取的镜像以及创建的容器行为都是可能被利用进行恶意操作的，例如在挂载的宿主机目录写入后门程序等。 投毒风险评估约为10%，主要是利用了用户对PoC的信任，并引导用户执行恶意操作。

5. **缓解措施:**
    * 禁用 `Expose daemon on tcp://localhost:2375 without TLS` 选项。
    * 使用 TLS 证书保护 Docker API。
    * 限制对Docker daemon的网络访问，使用防火墙规则。


**项目地址:** [OilSeller2001/PoC-for-CVE-2025-9074](https://github.com/OilSeller2001/PoC-for-CVE-2025-9074)

**漏洞详情:** [CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)