## CVE-2017-5941-node-serialize远程代码执行

**漏洞编号:** CVE-2017-5941

**漏洞类型:** 反序列化漏洞

**影响应用:** node-serialize

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 0.0.4

**利用条件:** 需要目标应用使用存在漏洞的node-serialize版本，并且允许控制反序列化的数据

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5941 是 node-serialize 包 0.0.4 版本中的一个反序列化漏洞。攻击者可以构造包含立即调用函数表达式（IIFE）的恶意 JavaScript 对象，通过 `unserialize()` 函数进行反序列化，从而实现远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞利用是有效的。搜索引擎结果中多个链接指向了漏洞的细节分析和利用方法，并包含EXP。

**投毒风险分析：**

分析提供的POC代码，代码主要功能是扫描IP列表（从ip.txt读取），然后针对每个IP构造恶意的cookie（profile）发送HTTP请求。恶意cookie的内容是经过base64编码的，其中包含一个JavaScript IIFE。这个IIFE的作用是执行 `ping` 命令，将当前用户名通过 DNS 查询发送到攻击者的 DNSLog 服务器。

代码本身的功能就是漏洞利用，用于测试目标是否存在漏洞，没有发现隐藏的恶意或非预期的行为。

README.md只是一个链接，指向漏洞分析文章，可以忽略。

**利用方式：**

1.  目标应用使用易受攻击的 `node-serialize` 0.0.4 版本。
2.  应用从请求中读取数据，并使用 `unserialize()` 函数对其进行反序列化。例如，许多案例是从cookie中读取profile变量进行反序列化。
3.  攻击者将包含恶意 JavaScript 对象的序列化字符串（包含 IIFE）作为输入（例如，通过HTTP请求的Cookie）发送给目标应用。
4.  `unserialize()` 函数执行 IIFE，从而在目标服务器上执行任意代码。POC代码中，执行的是ping命令，更严重的情况可以执行任意代码。


**项目地址:** [Frivolous-scholar/CVE-2017-5941-NodeJS-RCE](https://github.com/Frivolous-scholar/CVE-2017-5941-NodeJS-RCE)

**漏洞详情:** [CVE-2017-5941](https://nvd.nist.gov/vuln/detail/CVE-2017-5941)