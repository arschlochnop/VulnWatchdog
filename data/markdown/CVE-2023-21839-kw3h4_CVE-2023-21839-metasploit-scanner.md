## CVE-2023-21839 Oracle WebLogic Server 远程代码执行

**漏洞编号:** CVE-2023-21839

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，未经授权访问敏感数据或完全访问所有Oracle WebLogic Server可访问数据

**影响版本:** 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要通过T3或IIOP协议进行网络访问，且目标端口开放(默认7001)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21839 漏洞存在于 Oracle WebLogic Server 的 Core 组件中。该漏洞允许未经身份验证的攻击者通过 T3 或 IIOP 协议进行网络访问，从而导致 Oracle WebLogic Server 被入侵。成功利用此漏洞可能导致未经授权访问关键数据或完全访问所有 Oracle WebLogic Server 可访问数据。

**利用方式：**

1.  攻击者通过 T3/IIOP 协议发送特制的请求。
2.  该请求利用了 WebLogic Server 中存在的反序列化漏洞。
3.  通过该漏洞，攻击者可以在服务器上执行任意代码。
4.  提供的 Metasploit 辅助模块通过发送特定的 IIOP 请求来触发漏洞，并通过 DNSLog 来验证漏洞的存在性。具体来说，该脚本首先尝试连接目标 WebLogic Server，然后根据响应的版本信息，发送包含恶意数据的请求。通过验证 DNSLog 域名是否被访问，判断漏洞是否成功利用。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且已经被公开利用。提供的 POC 代码是一个 Metasploit 辅助模块，用于扫描和验证漏洞。

**投毒风险：**

对提供的 POC 代码进行了分析。该代码主要功能是发送特定的 IIOP 请求，并根据 DNSLog 的结果来判断漏洞是否存在。并未发现明显的后门或者恶意代码。但是，攻击者可能修改此脚本，在成功利用漏洞后植入恶意代码。此外,由于是metasploit模块,本身就具备执行任意代码的能力,存在一定的风险,故评判为10%。虽然该脚本没有直接投毒，但使用者应当注意，在实际渗透测试中，攻击者可能会利用该漏洞部署其他恶意程序。


**项目地址:** [kw3h4/CVE-2023-21839-metasploit-scanner](https://github.com/kw3h4/CVE-2023-21839-metasploit-scanner)

**漏洞详情:** [CVE-2023-21839](https://nvd.nist.gov/vuln/detail/CVE-2023-21839)