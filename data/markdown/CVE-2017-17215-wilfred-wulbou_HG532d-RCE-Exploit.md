## CVE-2017-17215-Huawei-HG532-RCE

**漏洞编号:** CVE-2017-17215

**漏洞类型:** 远程代码执行

**影响应用:** Huawei HG532

**危害等级:** 高危，可完全控制路由器

**影响版本:** 定制版本

**利用条件:** 需要与目标路由器在同一网络，或者目标路由器端口37215对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-17215 存在于 Huawei HG532 路由器的 UPnP 服务中。认证后的攻击者可以发送恶意数据包到37215端口利用此漏洞，最终导致远程代码执行。从提供的漏洞利用代码来看，该漏洞利用方式是通过向 `/ctrlt/DeviceUpgrade_1` 路径发送特制的 SOAP 请求，其中 `NewStatusURL` 字段包含待执行的命令。代码中使用了 `requests` 库发送带有 HTTPDigestAuth 认证的POST请求。由于是较老的漏洞，并且EXP仓库中存在 `busybox-mips` 下载和执行的命令，需要警惕下载的busybox是否为恶意程序。index.html 与 poc_iframe.html 页面目的是为了在Web页面实现攻击。投毒风险评估为10%，主要来自可能被植入恶意busybox二进制文件。

**项目地址:** [wilfred-wulbou/HG532d-RCE-Exploit](https://github.com/wilfred-wulbou/HG532d-RCE-Exploit)

**漏洞详情:** [CVE-2017-17215](https://nvd.nist.gov/vuln/detail/CVE-2017-17215)