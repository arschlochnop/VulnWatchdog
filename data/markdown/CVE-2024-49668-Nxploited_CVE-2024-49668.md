## CVE-2024-49668 - WordPress Verbalize WP Plugin Arbitrary File Upload

**漏洞编号:** CVE-2024-49668

**漏洞类型:** 任意文件上传

**影响应用:** WordPress Verbalize WP

**危害等级:** 高危，允许上传Web Shell并执行任意代码

**影响版本:** <= 1.0

**利用条件:** 需要 WordPress 站点安装了 Verbalize WP 插件且版本小于等于1.0

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-49668 漏洞存在于 WordPress Verbalize WP 插件中，允许未经身份验证的攻击者上传任意文件，包括 Web Shell。攻击者可以通过构造包含恶意代码的 PHP 文件，并利用插件的文件上传功能将其上传到服务器。上传成功后，攻击者可以通过访问上传的 Web Shell 来执行任意代码，从而控制整个 WordPress 站点。

**漏洞利用方式：**

1.  **检查目标站点是否存在漏洞：** 脚本首先检查目标站点是否存在 verbalize-wp 插件, 并检查readme.txt文件中的插件版本是否小于等于1.0。
2.  **构造恶意请求：**  脚本构造一个 multipart/form-data 请求，其中包含要上传的 PHP Web Shell 代码。重要字段包括：
    *   `action`: 设置为 `generate_code`，触发插件中的文件上传功能。
    *   `theFile`:  包含 Web Shell 代码的 PHP 文件，文件名为 `shell.php`，Content-Type 为 `application/x-php`。
3.  **发送恶意请求：** 使用 `requests.Session()` 对象发送构造好的 POST 请求到 `/wp-admin/admin-ajax.php` 端点。
4.  **提取 Shell 路径：**  解析服务器返回的 JSON 响应，提取上传的 Web Shell 的 ID 和文件名。然后，构造 Web Shell 的完整路径 `shell_path`，通常位于 `/wp-content/uploads/audio-text/{shell_id}/{shell_name}`。此路径可用于访问和执行 Web Shell。
5.  **代码分析与投毒风险评估:** 脚本主要功能是利用漏洞上传webshell，并无其他恶意代码，仅包含一些常用的HTTP头，例如User-Agent，Accept等。上传的shell代码可以通过`-s`参数指定，因此有一定投毒的风险，但属于正常使用功能，故投毒风险概率较低.

**防范措施：**

*   将 Verbalize WP 插件升级到最新版本（如果官方发布了修复版本）。
*   禁用或卸载 Verbalize WP 插件。
*   加强服务器的文件上传安全策略，例如限制上传文件类型、进行文件内容安全检查等。

**项目地址:** [Nxploited/CVE-2024-49668](https://github.com/Nxploited/CVE-2024-49668)

**漏洞详情:** [CVE-2024-49668](https://nvd.nist.gov/vuln/detail/CVE-2024-49668)