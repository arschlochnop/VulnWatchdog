## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标网站使用Bricks Builder插件，且版本在1.9.6及以下。无需身份验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-25600是Bricks Builder WordPress主题插件中的一个未经验证的远程代码执行(RCE)漏洞。通过发送特制的请求，攻击者可以在服务器上执行任意PHP代码。 

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞利用是有效的。漏洞库和搜索结果都表明这是一个RCE漏洞，并且存在公开的PoC。PoC代码通过利用`Bricks Builder`插件对用户输入处理不当的缺陷，将恶意PHP代码注入到特定参数中，从而实现远程代码执行。

**投毒风险：**
PoC代码本身主要用于验证和利用该漏洞。审查了提供的`LICENSE`、`README.md`、`exploit.py`文件，未发现明显的恶意代码或后门。`README.md`中明确声明了该工具仅用于教育和授权安全测试目的，并免除了作者的法律责任。`exploit.py`的核心功能是提取`nonce`值并构建payload执行命令。其中`exploit.py`中存在一个邮箱地址'tojitiktok@proton.me'，可能被用于安全研究交流，但也存在一定的风险，无法完全排除潜在的投毒行为的可能性。总体来看，投毒风险较低。

**利用方式：**
1.  **获取Nonce：** 首先，攻击者需要访问目标WordPress网站，并从HTML源代码中提取`nonce`值。PoC代码通过解析`<script id="bricks-scripts-js-extra">`标签中的JavaScript代码来提取nonce。提取nonce是利用该漏洞的关键步骤之一。
2.  **构造恶意请求：** 攻击者使用获取到的`nonce`构造一个包含恶意PHP代码的POST请求。PoC代码将payload放入`queryEditor`字段中。该payload通常包含要执行的系统命令。例如`whoami`。
3.  **发送请求：** 将构造好的请求发送到存在漏洞的`Bricks Builder`插件的特定endpoint。攻击者可以直接通过发送精心构造的HTTP请求来触发漏洞。
4.  **代码执行：** 如果目标网站存在漏洞，服务器将执行payload中的恶意PHP代码，攻击者从而实现远程代码执行。PoC代码将命令执行的结果返回给攻击者，实现交互式shell。

**项目地址:** [so1icitx/CVE-2024-25600](https://github.com/so1icitx/CVE-2024-25600)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)