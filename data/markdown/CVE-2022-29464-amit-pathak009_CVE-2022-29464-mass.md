## CVE-2022-29464 - WSO2 Unrestricted File Upload

**漏洞编号:** CVE-2022-29464

**漏洞类型:** 文件上传/远程代码执行

**影响应用:** WSO2 API Manager, Identity Server, Enterprise Integrator, Open Banking AM/KM

**危害等级:** 高危，可导致未经授权的远程代码执行

**影响版本:** WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0.

**利用条件:** 目标服务器存在/fileupload endpoint，且未进行严格的文件类型和路径验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29464 是 WSO2 产品中的一个严重漏洞，允许未经身份验证的攻击者通过`/fileupload` 端点上传任意文件，从而实现远程代码执行。攻击者利用路径遍历漏洞，将恶意 JSP 文件上传到 Web 应用可访问的目录下，例如 `repository/deployment/server/webapps`。上传的 JSP 文件会被服务器解析执行，从而允许攻击者执行任意命令。提供的 POC 代码通过构造包含路径遍历的请求，上传一个包含 WebShell 的 JSP 文件 `trkn0x.jsp` 到 `authenticationendpoint` 目录下，从而实现远程代码执行。代码未发现明显的投毒行为。

**项目地址:** [amit-pathak009/CVE-2022-29464-mass](https://github.com/amit-pathak009/CVE-2022-29464-mass)

**漏洞详情:** [CVE-2022-29464](https://nvd.nist.gov/vuln/detail/CVE-2022-29464)