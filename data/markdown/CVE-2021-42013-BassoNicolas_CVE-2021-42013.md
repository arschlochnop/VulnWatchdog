## CVE-2021-42013 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的远程攻击者读取任意文件和执行任意代码

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache 版本，并且启用 cgi 脚本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-42013 是一个 Apache HTTP Server 中的路径遍历和远程代码执行漏洞。此漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用该漏洞，通过构造包含路径遍历序列（例如 `/.%%32%65`）的 URL，访问服务器上受限目录之外的文件。如果目标启用了 CGI 脚本，攻击者可以利用该漏洞执行任意代码。

**有效性：** 提供的 PoC 代码尝试利用该漏洞。它首先尝试提取目标 URL 的域名或 IP 地址，然后发送一个包含路径遍历序列的 POST 请求到 `/cgi-bin/` 目录，尝试执行指定的 RCE 命令。如果服务器返回 HTTP 状态码 200，则认为 Payload 执行成功，并打印返回结果，否则显示Payload执行失败。

**投毒风险：** 漏洞利用代码本身未发现明显的投毒代码。它执行的操作与漏洞描述一致，即尝试利用路径遍历漏洞执行命令。代码逻辑简单直接，没有发现恶意篡改或隐藏行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **确定目标：** 确定运行 Apache HTTP Server 2.4.49 或 2.4.50 的目标服务器。
2.  **检查配置：** 确认目标服务器是否启用了 CGI 脚本。
3.  **构造 Payload：** 使用包含路径遍历序列的 URL，例如 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，构造恶意请求。
4.  **发送请求：** 向目标服务器发送 POST 请求，其中包含构造的 URL 和要执行的命令。
5.  **分析结果：** 分析服务器的响应，判断命令是否执行成功。

**项目地址:** [BassoNicolas/CVE-2021-42013](https://github.com/BassoNicolas/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)