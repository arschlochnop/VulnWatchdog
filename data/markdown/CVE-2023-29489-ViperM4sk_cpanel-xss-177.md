## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** XSS（跨站脚本）

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户会话劫持、恶意代码执行等

**影响版本:** < 11.109.9999.116

**利用条件:** 需要用户访问包含恶意链接的页面

**POC 可用性:** 是

**投毒风险:** 90%

## 详情

CVE-2023-29489是cPanel的一个反射型XSS漏洞。该漏洞存在于 `cpsrvd` 错误页面，通过构造包含恶意 JavaScript 代码的 `webcall ID`，当用户访问该错误页面时，恶意脚本将在用户浏览器中执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC是有效的。搜索结果中多个来源都确认了该漏洞的存在，并描述了其利用方式。提供的代码仓库包含利用此漏洞的Python脚本。

**投毒风险：**
提供的Python脚本 `cpanel-xss-177.py` 代码经过Base64编码和一些混淆处理。经过分析，该脚本存在投毒风险。原因是经过编码后的内容包含恶意代码的可能性较高。该代码已经被高度混淆，很难直接判断其行为，而且代码仓库包含了安装依赖 `requirements.txt`,需要安装额外第三方库，进一步加大了风险。

**利用方式：**
1.  攻击者构造一个包含恶意JavaScript代码的URL，该URL指向cPanel的 `cpsrvd` 错误页面，并在 `webcall ID` 参数中注入XSS Payload。
2.  攻击者诱骗用户点击该恶意URL，例如通过钓鱼邮件或在其他网站上发布。
3.  当用户点击该URL时，cPanel服务器会生成一个包含XSS Payload的错误页面。
4.  用户的浏览器会执行嵌入在错误页面中的恶意JavaScript代码。

该恶意代码可以执行各种操作，例如：

*   窃取用户的cookie，从而劫持用户的会话。
*   修改页面内容，诱骗用户输入敏感信息。
*   将用户重定向到恶意网站。
*   在用户的计算机上安装恶意软件。

由于该漏洞是反射型XSS，因此攻击依赖于用户点击恶意链接。为了成功利用该漏洞，攻击者需要使用社会工程学技巧来诱骗用户点击该链接。

**项目地址:** [ViperM4sk/cpanel-xss-177](https://github.com/ViperM4sk/cpanel-xss-177)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)