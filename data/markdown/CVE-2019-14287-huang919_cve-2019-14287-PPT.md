## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升/安全策略绕过

**影响应用:** Sudo

**危害等级:** 高危，允许攻击者以root权限执行命令，绕过安全策略和审计日志。

**影响版本:** < 1.8.28

**利用条件:** 需要攻击者拥有Runas ALL sudoer账号的访问权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-14287允许拥有 Runas ALL 权限的sudoer用户通过指定一个特殊的UID（例如 -1 或 0xffffffff）来绕过某些安全策略和PAM会话模块。 

**有效性：**
根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，且有公开的利用方法。搜索结果中多个链接提到了该漏洞以及其危害，并有exp示例（参考链接：https://www.exploit-db.com/exploits/47502），漏洞库中也包含了修复方案。

**投毒风险：**
提供的漏洞利用代码包含两个markdown文档，分别提供了一个外部链接，指向一个“shellshock”漏洞的参考文章，以及sudoers文件的编写方法。sudoers文件编写方法指导包含一个账户创建的命令，虽然建议按照学号创建账户，但是也存在创建恶意账户的可能性。文件本身没有直接的后门代码，但是参考链接可能存在引导用户执行恶意操作的风险。 综合来看，投毒风险较低，约为10%。

**利用方式：**
利用方式是：
1.  攻击者需要拥有一个配置为 `Runas ALL` 的 sudoer 账户。
2.  攻击者使用 `sudo -u \#$((0xffffffff))` 或类似的命令（指定用户ID为-1或0xffffffff），后跟要执行的命令。
3.  Sudo会错误地处理此用户ID，绕过`!root`配置以及用户身份验证模块，从而允许攻击者以root权限执行任意命令。日志记录也可能不正确，从而掩盖攻击者的行为。

简单来说，就是通过指定特殊的UID让sudo误判，从而绕过权限检查。

**项目地址:** [huang919/cve-2019-14287-PPT](https://github.com/huang919/cve-2019-14287-PPT)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)