## CVE-2021-1675 PrintNightmare

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 需要目标系统启用Print Spooler服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

PrintNightmare (CVE-2021-1675) 是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以通过该漏洞在受影响的系统上以SYSTEM权限执行任意代码。根据漏洞库信息，多个Windows版本都受到影响，需要及时安装补丁。

**有效性：**
根据搜索引擎结果和漏洞库信息，该漏洞是真实存在的，并且存在公开的PoC代码。

**投毒风险：**
提供的PoC代码主要用于检测漏洞和日志分析，风险较低。TryHackMe的介绍性文档，主要用于漏洞检测，投毒风险较低，代码中本身没有直接执行恶意操作的部分，但用户可能被诱导执行恶意操作，所以存在极低的投毒风险。

**利用方式：**
利用方式通常涉及以下步骤：
1.  利用`RpcAddPrinterDriverEx`函数安装恶意的打印机驱动程序。
2.  打印机服务会尝试加载该驱动程序，从而执行攻击者提供的代码。
3.  攻击者可以利用该代码获得SYSTEM权限。

**排序优先级:**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

搜索引擎结果表明该漏洞已被广泛利用，CISA将其列入已知被利用漏洞目录，并与 CVE-2021-34527 关联。漏洞利用代码提供了一种检测漏洞的方式，并展示了如何分析相关事件日志。漏洞库信息提供了受影响的Windows版本范围。

请注意及时应用补丁，并采取缓解措施，如禁用Print Spooler服务等，以降低风险。

**项目地址:** [r1skkam/PrintNightmare](https://github.com/r1skkam/PrintNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)