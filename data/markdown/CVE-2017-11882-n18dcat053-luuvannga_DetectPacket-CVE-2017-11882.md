## CVE-2017-11882 Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者在当前用户的上下文中运行任意代码

**影响版本:** Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

**利用条件:** 用户需要打开包含恶意公式的 Office 文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882 是一个 Microsoft Office 内存破坏漏洞，存在于 Equation Editor 组件中。攻击者可以通过构造包含恶意公式的 Office 文档来触发此漏洞，成功利用此漏洞可以允许攻击者在当前用户的上下文中执行任意代码。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，多个安全厂商都有相关的分析报告和检测规则。漏洞利用代码仓库中提供了一个名为 `detect.py` 的 Python 脚本，该脚本使用 `pyshark` 库捕获网络数据包，并分析数据包的内容是否包含攻击特征，比如包含特定的字符串（如 `rtf1`，`VBScript` 和 `powershell.exe`）。从提供的 `lognew.txt` 文件可以看出，脚本成功检测到了疑似攻击流量。

**投毒风险分析：**
检测脚本 `detect.py` 的主要功能是捕获网络数据包并检测恶意流量。脚本本身依赖于 `pyshark` 库，如果 `pyshark` 库被篡改，则可能存在投毒风险。此外，该脚本会将检测到的可疑流量信息写入 `result-traffic.csv` 和 `lognew.txt` 文件，如果这些文件被用于后续分析，则存在被篡改的风险。例如，攻击者可能通过修改日志文件来隐藏攻击痕迹或插入虚假信息。

**利用方式分析：**
1.  攻击者创建一个包含恶意公式的 Office 文档 (通常是Word文档)。
2.  恶意公式利用 Equation Editor 中的漏洞。
3.  当用户打开文档时，Equation Editor 尝试解析该公式，触发内存破坏漏洞。
4.  攻击者利用该漏洞执行任意代码，通常是下载并执行恶意程序，例如信息窃取器 (Agent Tesla) 或其他恶意软件。从搜索结果来看，该漏洞经常被用于传播恶意软件。

**排序优先级：**
搜索引擎结果提供了关于该漏洞在野外利用的最新信息，因此优先级最高。漏洞利用代码提供了检测漏洞的脚本，优先级次之。漏洞库信息提供了漏洞的基本信息，优先级最低。

**项目地址:** [n18dcat053-luuvannga/DetectPacket-CVE-2017-11882](https://github.com/n18dcat053-luuvannga/DetectPacket-CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)