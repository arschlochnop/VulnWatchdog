## CVE-2020-17519-Apache Flink-目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** 需要目标Flink实例暴露REST API且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 存在于 Apache Flink 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 的 REST 接口读取 JobManager 进程可以访问的本地文件系统上的任何文件，利用方式如下：

1.  **漏洞描述：** 由于 Apache Flink 在处理 REST API 请求时，没有充分过滤目录遍历字符，导致攻击者可以通过构造包含 `..%252f` 的恶意 URL 来访问系统上的任意文件。
2.  **POC有效性：** 提供的 Go 代码通过向目标 Flink JobManager 的 REST API 发送包含目录遍历payload的GET请求来验证漏洞是否存在。该POC通过检查响应体中是否存在类似 `root` 等关键字判断是否成功读取 `/etc/passwd` 文件，如果存在且状态码为200则判断目标存在漏洞，因此POC代码有效。
3.  **投毒风险：** 提供的EXP代码主要功能是通过目录遍历漏洞读取目标服务器上的文件，没有发现任何恶意或隐藏的投毒代码，因此投毒风险为0%。
4.  **利用方式：**
    *   攻击者构造包含目录遍历字符的 URL，例如：`/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
    *   攻击者将构造好的 URL 发送到目标 Flink JobManager 的 REST API。
    *   如果目标 Flink 版本在受影响范围内，且 JobManager 进程对目标文件具有读取权限，则攻击者可以成功读取该文件。
    *   通过读取敏感配置文件等，攻击者可以获取更多信息，为进一步攻击做准备。

从CISA的信息来看，该漏洞已经被积极利用，需要引起重视。

**项目地址:** [radbsie/CVE-2020-17519-Exp](https://github.com/radbsie/CVE-2020-17519-Exp)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)