## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权15的用户，进而完全控制受影响的设备。

**影响版本:** 受影响版本包括 16.1.1 到 17.12.1 等多个版本

**利用条件:** Web UI 功能已启用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的系统上创建一个具有特权 15 访问权限的帐户，从而完全控制设备。利用方式如下：

1.  **漏洞触发点：** Cisco IOS XE 软件的 Web UI 组件存在漏洞。
2.  **利用过程：** 攻击者通过发送特制的 SOAP 请求到 `/%%77ebui_wsma_https` 或 `/%%77ebui_wsma_Http` URI (具体取决于是否使用 HTTPS) 绕过身份验证。
3.  **命令执行：** 攻击者使用 `urn:cisco:wsma-config` 命名空间执行 CLI 命令，创建新的具有特权 15 的用户。
4.  **后续利用 (CVE-2023-20273):** 在获得初始访问权限后，攻击者可以利用 CVE-2023-20273 将权限提升为 root 并在文件系统中写入植入程序。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞已被积极利用，提供的 PoC 代码有效，可以用于创建具有特权 15 的用户。

**投毒风险：**

PoC 代码主要功能是利用漏洞，创建新用户，从代码本身来看，存在一些潜在的投毒点，例如：

*   **随机用户名/密码生成：**  虽然代码中包含随机用户名生成函数，但实际使用中，攻击者可能会替换为预设的用户名和密码，方便后续控制。
*   **代理服务器使用：**  PoC 代码支持使用代理服务器，攻击者可以借此隐藏真实 IP 地址，增加溯源难度。
*   **异常处理：**  代码中包含异常处理模块，可能用于隐藏利用过程中的错误信息，避免被发现。
*   **User-Agent:** 使用了常见的User-Agent，但是依然存在替换或者增加其他User-Agent进行恶意攻击.

总体来说，PoC 代码的投毒风险较低，主要集中在以上几点，但需要使用者谨慎使用。

**总结：**

该漏洞利用的有效性很高，并且在野外被广泛利用。PoC 代码可以用来验证漏洞的存在并创建管理员用户，但需要注意潜在的投毒风险。利用方式是发送特制的 SOAP 请求，绕过身份验证，然后执行 CLI 命令。

**项目地址:** [W01fh4cker/CVE-2023-20198-RCE](https://github.com/W01fh4cker/CVE-2023-20198-RCE)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)