## CVE-2023-29489 cPanel XSS漏洞

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户账户被盗用、恶意代码执行。

**影响版本:** 低于 11.109.9999.116

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29489是cPanel中的一个跨站脚本漏洞。该漏洞位于 `cpsrvd` 错误页面，可以通过一个无效的 `webcall ID`触发。攻击者可以构造包含恶意JavaScript代码的链接，如果用户点击此链接，恶意代码将在用户的浏览器中执行，从而可能导致会话劫持、信息窃取或者恶意操作。

**有效性：**
根据漏洞信息，搜索引擎结果以及提供的漏洞利用代码(`cpanel_xss_2023`)，可以判定该漏洞的POC代码是有效的，因为它能够扫描目标cPanel是否存在该漏洞，并检测是否可被利用。

**投毒风险：**
提供的代码包含了一个Python脚本`cpanel_xss_2023`，其功能是扫描指定URL或从文件读取多个URL，检测是否存在CVE-2023-29489漏洞，并可选择将结果输出到文件或者通过Telegram发送通知。
仔细检查代码后，发现存在以下潜在风险点，但并不构成直接的投毒：
1.  **依赖安装：** 需要安装多个Python包 (`click`, `requests`, `PyYAML`)。如果这些包的来源被篡改，可能引入恶意代码。但是，这属于供应链攻击，而非直接的投毒。
2.  **Telegram通知功能：** 依赖用户的Telegram Bot Token和Chat ID。如果用户泄露这些信息，可能被攻击者利用。
3.  **文件读取：**  如果用户提供包含大量URL的恶意文件，可能导致拒绝服务攻击。但代码本身并没有主动进行恶意操作。
4.  **PyPi模块链接：** 仓库中包含一个PyPi的链接，指向cpanel-xss-2023模块。如果该模块被恶意人员篡改，可能存在投毒风险。

因此，该仓库中的投毒风险主要来自于潜在的供应链攻击（通过恶意PyPI包或篡改的依赖），以及滥用Telegram通知功能，大约估算其风险为10%。

**利用方式：**
1.  **构造恶意链接：**  攻击者构造一个包含恶意JavaScript代码的URL，该URL利用了`cpsrvd`错误页面上未正确处理的 `webcall ID`。
2.  **诱骗用户点击：** 攻击者通过各种方式（例如，电子邮件、社交媒体）诱骗用户点击该恶意链接。
3.  **执行XSS攻击：** 当用户点击恶意链接时，cPanel服务器返回包含恶意JavaScript代码的页面。用户的浏览器执行这些代码，从而实现XSS攻击。
4.  **攻击效果：** 攻击者可以利用XSS漏洞窃取用户的会话Cookie，冒充用户执行操作，或者篡改页面内容，传播恶意信息。

**项目地址:** [mdaseem03/cpanel_xss_2023](https://github.com/mdaseem03/cpanel_xss_2023)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)