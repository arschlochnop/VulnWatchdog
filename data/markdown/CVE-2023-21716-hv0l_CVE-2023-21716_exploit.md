## CVE-2023-21716-Microsoft Word RCE

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响版本包括 Microsoft Office, SharePoint, 365 Apps 等多个产品，具体版本范围见漏洞库信息

**利用条件:** 需要目标用户打开恶意RTF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞为 Microsoft Word 远程代码执行漏洞，编号为 CVE-2023-21716。根据搜索引擎结果和漏洞库信息，该漏洞的 CVSS 评分高达 9.8，属于严重级别。漏洞存在于wwlib.dll中，RTF解析器在处理包含过多字体定义的字体表时会触发堆损坏漏洞。攻击者可以构造恶意的RTF文件，当用户使用Microsoft Word打开该文件时，可能导致远程代码执行。提供的PoC代码 exploit.py 首先生成一个恶意的 exploit.rtf 文件，其中包含大量字体定义，旨在触发漏洞。然后，该脚本将该 RTF 文件作为附件通过电子邮件发送给目标用户。用户打开附件后，触发漏洞，理论上可以实现远程代码执行。该POC利用的原理是通过生成大量字体定义来触发整数溢出导致堆损坏。

**有效性:** 该 PoC 代码基本有效，但成功利用取决于目标环境和 Word 版本。该PoC的简易性很高，易于复现。

**投毒风险:** 经过对 PoC 代码的分析，未发现明显的恶意代码或后门。代码主要功能是生成恶意 RTF 文件并发送邮件。因此，投毒风险较低，可判定为 0%。

**利用方式:**
1.  攻击者构造恶意的 RTF 文件，该文件包含大量字体定义。
2.  攻击者将该 RTF 文件通过电子邮件或其他方式发送给目标用户。
3.  目标用户使用 Microsoft Word 打开该 RTF 文件。
4.  Word 解析 RTF 文件时，由于字体表包含过多字体定义，触发堆损坏漏洞。
5.  攻击者利用该漏洞执行任意代码，从而完全控制系统。

**项目地址:** [hv0l/CVE-2023-21716_exploit](https://github.com/hv0l/CVE-2023-21716_exploit)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)