## CVE-2024-50623 - Cleo Unrestricted File Upload

**漏洞编号:** CVE-2024-50623

**漏洞类型:** 未限制文件上传

**影响应用:** Cleo Harmony, VLTrader, LexiCom

**危害等级:** 高危，远程代码执行

**影响版本:** < 5.8.0.21

**利用条件:** 需要网络访问Cleo服务器的Synchronization接口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-50623是一个存在于Cleo Harmony, VLTrader和LexiCom 5.8.0.21之前版本中的未限制文件上传漏洞，允许未经身份验证的攻击者上传恶意文件（如webshell），并最终导致远程代码执行。

**有效性评估：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果表明，该漏洞已被积极利用，存在实际攻击案例。PoC代码提供了文件读取和写入的功能，验证了漏洞的可利用性。

**投毒风险评估：**
PoC 代码本身相对简单，主要功能是读取和写入文件。虽然PoC的功能是按照预期实现漏洞利用，但也存在一定的投毒风险。该脚本可能被修改，添加恶意功能，例如在上传文件时执行额外的恶意操作，或将读取的文件内容发送到外部服务器。此外，即使是原版的 PoC，如果被攻击者利用，也会对目标系统造成严重损害。因此，认为存在 5%的投毒风险。

**利用方式：**
1.  **版本检测：** PoC首先通过访问`/Synchronization`接口获取服务器版本。该版本信息用于构造后续的请求头。
2.  **构造恶意请求头：** 根据`--action`参数，PoC构造包含`VLSync`头的HTTP请求。
    *   **文件读取：** 如果`--action`设置为`read`，则`VLSync`头包含`Retrieve`指令，指定要读取的文件路径（`--where`参数）。
    *   **文件写入：** 如果`--action`设置为`write`，则`VLSync`头包含`ADD`指令，指定要写入的文件路径（`--where`参数）和本地文件（`--what`参数）的内容。
3.  **发送请求：** PoC发送GET（读取）或POST（写入）请求到`/Synchronization`接口，并将构造的请求头和文件内容包含在请求中。
4.  **远程代码执行：** 成功上传恶意文件后，攻击者可以通过访问该文件来执行任意代码。例如，上传一个JSP webshell，并通过浏览器访问该webshell执行系统命令。

**项目地址:** [watchtowrlabs/CVE-2024-50623](https://github.com/watchtowrlabs/CVE-2024-50623)

**漏洞详情:** [CVE-2024-50623](https://nvd.nist.gov/vuln/detail/CVE-2024-50623)