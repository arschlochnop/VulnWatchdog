## CVE-2012-2982 - Webmin file/show.cgi 命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的账号密码进行认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982 漏洞存在于 Webmin 1.590 及更早版本的 `file/show.cgi` 文件中。远程认证用户可以通过在路径名中使用无效字符（如 `|` 管道符）来执行任意命令。

**利用方式：**

1.  **认证：** 首先，需要获得Webmin的有效用户名和密码。从提供的漏洞利用代码可以看出，有些脚本直接使用了硬编码的凭据 `agent47:videogamer124` 或 `user1:1user`，或者通过POST请求登录。
2.  **构造恶意请求：** 漏洞存在于 `file/show.cgi` 脚本中，通过在URL中传递包含管道符的路径名，可以将命令注入到服务器执行。例如：`http://localhost:10000/file/show.cgi/bin/%s|%s|`。
3.  **命令注入：** 通过管道符 `|` 将随机字符与需要执行的shell命令连接起来，利用系统执行shell命令的特性。
4.  **反弹Shell：** POC代码利用反弹shell技术,在服务器上执行命令，将shell连接到攻击者的监听端口。攻击者使用 `nc -nlvp <端口号>` 等工具监听指定端口，即可获得服务器的shell控制权。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，该漏洞是有效的。多个来源证实了该漏洞的存在，并且提供了可用的PoC代码（Python脚本）。

**投毒风险评估：**

分析提供的POC代码，未发现明显的投毒代码。
*   `gamezone.py` 首先尝试使用硬编码的凭据 `agent47:videogamer124` 登录 Webmin，登录成功后，构建包含反弹 shell payload 的 URL，该 payload 将连接到攻击者的 IP 地址和端口。这个脚本需要 SSH 隧道连接到目标机器的 localhost 才能访问 Webmin。
*   `web.py` 与 `gamezone.py` 类似，首先尝试使用硬编码的凭据 `user1:1user` 登录 Webmin，登录成功后，构建包含反弹 shell payload 的 URL，该 payload 将连接到攻击者的 IP 地址和端口。这个脚本可以通过命令行参数指定目标IP.
两个POC脚本的代码逻辑都比较清晰，主要目的是验证和利用 CVE-2012-2982 漏洞，未发现其他恶意行为。因此，投毒风险评估为 **0%**。

**项目地址:** [cd6629/CVE-2012-2982-Python-PoC](https://github.com/cd6629/CVE-2012-2982-Python-PoC)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)