## CVE-2022-24897-xwiki-commons-文件系统写入

**漏洞编号:** CVE-2022-24897

**漏洞类型:** 文件系统写入

**影响应用:** xwiki-commons

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** >= 2.3, < 12.6.7 和 12.7-rc-1, < 12.10.3

**利用条件:** 需要 Script 权限，并且找到一个 XWiki API 返回 File 对象

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2022-24897 是一个存在于 XWiki Commons 的漏洞，允许攻击者利用 Velocity 脚本进行任意文件系统写入。漏洞原因是 Velocity 脚本没有被正确地沙盒化，导致攻击者可以使用 Java File API 对文件系统执行读写操作。攻击者需要拥有 Script 权限，并找到一个 XWiki API 返回 File 对象才能利用此漏洞。从搜索结果来看，该漏洞已被多个安全机构收录并评估。提供的漏洞利用代码是一个 Jenkinsfile 配置文件，用于构建和测试 XWiki Commons 项目。虽然 Jenkinsfile 本身不直接包含漏洞利用代码，但如果构建环境存在漏洞版本的 XWiki Commons，则 Jenkinsfile 可能会触发该漏洞，通过 Velocity 脚本执行恶意操作。由于Jenkinsfile目的是自动化构建流程，且只包含合法的Maven命令，因此投毒风险评估为0%。利用方式是攻击者首先需要获得XWiki的Script权限，然后编写包含恶意Java File API调用的Velocity脚本，并通过找到一个能够返回File对象的XWiki API来触发该脚本，从而实现任意文件写入。 

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2022-24897_12-6-6](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2022-24897_12-6-6)

**漏洞详情:** [CVE-2022-24897](https://nvd.nist.gov/vuln/detail/CVE-2022-24897)