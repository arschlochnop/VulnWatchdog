## CVE-2021-32099-Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Pandora FMS

**危害等级:** 高危，未经身份验证的攻击者可以提升权限并绕过登录。

**影响版本:** 742

**利用条件:** 需要能够访问 Pandora FMS 742 实例的 `/include/chart_generator.php` 页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 版本中 pandora_console 组件的 SQL 注入漏洞。该漏洞位于 `/include/chart_generator.php` 文件，攻击者可以通过操纵 `session_id` 参数，注入恶意的 SQL 代码。利用方式如下：

1.  **漏洞利用：** 攻击者发送包含恶意 SQL 代码的请求到 `/include/chart_generator.php`，篡改 `session_id` 参数。
2.  **SQL 注入：** 恶意 SQL 代码允许攻击者修改 `tsessions_php` 表中的会话数据，特别是 `id_usuario` 字段。
3.  **权限提升：** 攻击者将 `id_usuario` 设置为 "admin"，从而将自己的会话提升为管理员权限，绕过登录。

**POC 有效性：**

提供的 POC 代码演示了如何利用该漏洞。攻击者只需将 URL 中的 `session_id` 参数替换为恶意 SQL 注入语句，即可提升权限。`UNION SELECT` 语句被用于从 `tsessions_php` 表中选择数据，并将当前会话的 `id_usuario` 字段更新为 "admin"。成功利用后，攻击者就可以使用此会话绕过身份验证，以管理员身份访问系统。

**投毒风险分析：**

查看提供的仓库内容，只包含了一个 `README.md` 文件，其中仅描述了如何利用该漏洞，并未发现任何恶意代码。因此，本仓库中存在作者隐藏的投毒代码的可能性为 0%。该仓库目的在于方便使用者验证漏洞是否有效，其危害在于如果使用者未授权进行POC验证，将会面临恶意攻击的风险。

**项目地址:** [akr3ch/CVE-2021-32099](https://github.com/akr3ch/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)