## CVE-2024-1709-ConnectWise ScreenConnect-身份验证绕过

**漏洞编号:** CVE-2024-1709

**漏洞类型:** 身份验证绕过

**影响应用:** ConnectWise ScreenConnect

**危害等级:** 高危，允许未经身份验证的攻击者直接访问敏感信息或关键系统，并可能导致远程代码执行。

**影响版本:** <= 23.9.7

**利用条件:** 目标系统运行ConnectWise ScreenConnect，且版本为受影响版本，攻击者能够通过网络访问目标。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-1709 是 ConnectWise ScreenConnect 23.9.7 及之前版本中存在的身份验证绕过漏洞。该漏洞允许未经身份验证的攻击者利用备用路径或通道绕过身份验证，从而获得对系统资源的访问权限。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及漏洞利用代码，可以判断该POC代码有效。漏洞库信息中CVSS评分为10分（CRITICAL），表明危害程度极高。搜索引擎结果中，多个链接提到该漏洞被积极利用，并且存在公开的POC。漏洞利用代码提供了检查目标是否易受攻击的功能，以及尝试利用漏洞访问管理端点的功能，进一步验证了该漏洞的可利用性。

**投毒风险分析：**

对提供的漏洞利用代码进行分析，发现其主要功能为检测漏洞是否存在以及尝试访问管理端点。代码中没有发现明显的恶意行为或后门植入行为。但是，需要注意以下几点：

*   该工具尝试访问管理端点，如果成功，可能会修改系统配置或执行其他恶意操作。这取决于攻击者的后续行为。
*   代码的LICENSE声明版权为2025年，与现在的时间2024年不符，代码作者声明为Security Researcher，并非漏洞披露的机构或个人，存在一定的可疑。
*   代码中使用了`verify=False` 参数，禁用SSL证书验证。这可能会使攻击者更容易进行中间人攻击，拦截或篡改通信。

综合考虑，认为该POC存在较低的投毒风险，大约为10%。

**利用方式分析：**

利用方式主要分为以下几个步骤：

1.  **漏洞检测：** 使用POC代码中的`check_vulnerability`函数，通过发送特制的HTTP请求到目标`/SetupWizard.aspx/RemoteSupport`路径，检测目标是否存在身份验证绕过漏洞。
2.  **管理端点发现：** 如果漏洞存在，利用代码会尝试访问常见的管理端点，例如`/Admin`、`/Administration`、`/SetupWizard.aspx`，以确定哪些端点可以未经身份验证访问。
3.  **利用：** 如果目标处于初始设置模式（SetupWizard.aspx），攻击者可以通过访问该页面创建管理员账户，进而完全控制系统。

总的来说，该漏洞利用相对简单，但危害巨大。成功利用该漏洞可以导致敏感信息泄露、系统配置被篡改，甚至远程代码执行。

**项目地址:** [Teexo/ScreenConnect-CVE-2024-1709-Exploit](https://github.com/Teexo/ScreenConnect-CVE-2024-1709-Exploit)

**漏洞详情:** [CVE-2024-1709](https://nvd.nist.gov/vuln/detail/CVE-2024-1709)