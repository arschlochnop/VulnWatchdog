## CVE-2025-29927 Next.js Middleware 权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** 11.1.4 <= version <= 13.5.6, 14.0.0 < version < 14.2.25, 15.0.0 < version < 15.2.3

**利用条件:** 目标应用使用了 Next.js 中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是一个 Next.js 中间件权限绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` HTTP Header，绕过中间件中实现的身份验证机制，从而未经授权访问受保护的资源。

**有效性：**
根据漏洞描述、搜索结果和提供的 PoC 代码，该漏洞是有效的。PoC 代码演示了如何使用 `x-middleware-subrequest` header 绕过中间件的身份验证。

**投毒风险：**
查看提供的文件列表，主要包含：
* `README.md`: 漏洞复现说明文档
* `jsconfig.json`:  JS配置
* `middleware.js`: 中间件权限验证，验证authorization是否为`my-jwt-token-here`，否则返回401
* `next.config.mjs`: Next.js 配置文件
* `package-lock.json`:  依赖包信息

PoC代码中没有发现明显的恶意代码或者后门。验证逻辑比较清晰，主要是通过修改 `x-middleware-subrequest` Header绕过验证。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  目标应用需要使用 Next.js 中间件来进行身份验证。
2.  攻击者通过发送带有特定格式 `x-middleware-subrequest` header 的 HTTP 请求， 例如：`curl -H "x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware" http://localhost:3000/api/hello`。
3.  如果Next.js版本小于14.2.25和15.2.3，且符合受影响的版本范围，则中间件的身份验证逻辑将被绕过。
4.  攻击者从而可以访问原本需要授权才能访问的资源。

**项目地址:** [SugiB3o/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/SugiB3o/vulnerable-nextjs-14-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)