## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** mod_cgi 必须启用，目标服务器运行 Apache HTTP Server 2.4.49 且相关目录未配置 "require all denied"

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中的一个路径遍历漏洞。该漏洞源于 Apache HTTP Server 在处理 URL 路径时存在缺陷，攻击者可以利用 `/.%2e/` 序列绕过路径规范化检查，从而访问受限目录之外的文件。如果服务器配置允许执行 CGI 脚本，攻击者可以通过构造包含恶意命令的 HTTP 请求执行任意代码，导致远程代码执行（RCE）。

**有效性：**
提供的 POC 代码 (`CVE-2021-42013.py`) 旨在利用此漏洞。它通过 `curl` 命令发送包含路径遍历序列和 shell 命令的 HTTP 请求，从而在目标服务器上执行命令。`README.md` 文件描述了漏洞细节和利用方法，包括依赖项（Python 3 和 `curl`），执行命令的示例，增强了漏洞利用的有效性。

**投毒风险：**
虽然提供的代码旨在利用漏洞，但仍存在轻微的投毒风险的可能性。例如，`README.md` 中可能存在误导信息，导致用户以非预期的方式使用该脚本，或者脚本本身可能包含某些不明显或未记录的功能，但考虑到作者主要目的是复现该漏洞，以及代码整体比较简单，所以推测投毒的可能性为10%。 

**利用方式：**
1.  **路径遍历：** 攻击者利用 URL 中的 `/.%2e/` 序列，尝试访问服务器文件系统上的任意文件。
2.  **CGI 脚本执行：** 如果目标服务器启用了 `mod_cgi` 模块，攻击者可以构造包含恶意命令的 HTTP 请求，并将其发送到 CGI 脚本处理程序。
3.  **远程代码执行：** 服务器执行 CGI 脚本时，会执行攻击者提供的命令，从而实现远程代码执行。

**项目地址:** [Ask-os/CVE-2021-41773](https://github.com/Ask-os/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)