## CVE-2021-3560-polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** polkit

**危害等级:** 高危，允许本地普通用户获取root权限

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的polkit，且使用systemd。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3560 漏洞允许本地未经授权的用户通过绕过 D-Bus 请求的凭据检查，将权限提升为 root 用户。从提供的漏洞库信息和搜索结果来看，该漏洞影响 polkit 0.119 版本。提供的漏洞利用代码 `CVE-2021-3560.py` 利用了 accountsservice 提供的 D-Bus 接口的 `CreateUser` 和 `SetPassword` 方法，通过竞争条件（race condition）绕过 polkit 的权限验证，创建一个具有 root 权限的新用户（ahmed），然后设置该用户的密码，并通过 `su ahmed -c 'sudo su'` 命令切换到该用户，最终获得 root 权限。

**有效性：**
根据提供的 README 和代码中的注释以及搜索结果，该PoC代码是有效的，能够在受影响的系统上成功提权。

**投毒风险：**
分析提供的 PoC 代码，未发现明显的恶意或隐藏代码，该代码的目的是利用漏洞实现权限提升，该利用方式与漏洞描述相符，没有发现其他恶意行为，投毒风险为 0%。

**利用方式：**
1.  利用竞争条件尝试创建用户'ahmed'，绕过polkit的认证。
2.  成功创建用户后，设置用户'ahmed'的密码，同样利用竞争条件绕过polkit的认证。
3.  使用新创建的用户登录，并尝试使用`sudo su`命令提升到root权限。

**项目地址:** [Almorabea/Polkit-exploit](https://github.com/Almorabea/Polkit-exploit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)