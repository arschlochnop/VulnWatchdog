## CVE-2022-46166-Spring Boot Admin-代码注入

**漏洞编号:** CVE-2022-46166

**漏洞类型:** 代码注入

**影响应用:** Spring Boot Admin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 2.6.10, < 2.7.8

**利用条件:** 需要启用 Notifier（如 Teams-Notifier）和具有通过 UI 写入环境变量的权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46166 存在于 Spring Boot Admin 中，由于 Notifier 实现中 SpEL 表达式的错误评估上下文配置导致。攻击者可以通过 UI 修改环境变量，注入恶意 SpEL 表达式，当 Notifier 处理这些环境变量时，表达式会被执行，从而实现远程代码执行。 

**有效性：**根据漏洞库信息、搜索结果和利用方式描述，该漏洞的POC存在并且有效。

**投毒风险：** 提供的漏洞利用代码是 Spring Boot Admin 项目的 CONTRIBUTING.md 和 LICENSE.txt 文件， 主要是项目贡献指南和许可证信息，不包含恶意代码。 投毒代码的可能性非常低，约为 1%。主要的风险在于，如果攻击者能够控制受害者环境，那么他们可以直接利用该漏洞进行攻击，而不需要在代码仓库中引入恶意代码。

**利用方式：**
1.  攻击者需要访问 Spring Boot Admin Server 的 UI。
2.  目标系统必须启用 Notifier，例如 Teams-Notifier。
3.  攻击者需要具有通过 UI 写入环境变量的权限。
4.  攻击者通过 UI 创建或修改环境变量，并注入包含恶意 SpEL 表达式的字符串。
5.  当 Spring Boot Admin Server 的 Notifier 处理这些环境变量时，恶意的 SpEL 表达式会被解析和执行，导致远程代码执行。

**项目地址:** [shoucheng3/codecentric__spring-boot-admin_CVE-2022-46166_2-6-9](https://github.com/shoucheng3/codecentric__spring-boot-admin_CVE-2022-46166_2-6-9)

**漏洞详情:** [CVE-2022-46166](https://nvd.nist.gov/vuln/detail/CVE-2022-46166)