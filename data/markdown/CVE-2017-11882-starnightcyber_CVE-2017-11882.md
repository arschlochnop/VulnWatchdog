## CVE-2017-11882 Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者以当前用户权限执行任意代码

**影响版本:** Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

**利用条件:** 用户需要打开包含恶意公式的Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882 是一个 Microsoft Office 公式编辑器 (EQNEDT32.EXE) 中的内存破坏漏洞，允许攻击者通过构造特制的 RTF 文档来执行任意代码。攻击者通常会将恶意代码嵌入在公式对象中，当 Office 应用程序尝试解析该公式时，会触发栈缓冲区溢出，从而允许攻击者控制程序执行流程。搜索结果显示，此漏洞在野外被广泛利用，常用于传播 Agent Tesla 等恶意软件。提供的 POC 代码 `Command_CVE-2017-11882.py` 是一个 Python 脚本，用于生成包含漏洞利用代码的 RTF 文档。该脚本通过构造特定的 RTF 结构和嵌入的 Equation.3 对象来实现漏洞触发。由于脚本可以自定义执行的命令，因此存在一定的投毒风险，例如，如果脚本被修改为下载和执行其他恶意程序，那么生成的 RTF 文档也会包含恶意代码。分析该脚本发现，OBJDATA_TEMPLATE 变量包含大量填充数据，可能被用于隐藏恶意代码或绕过检测。脚本本身并不直接包含恶意代码，但是恶意代码通常由嵌入的Equation.3对象在目标机器上触发下载和运行，或者直接写入系统文件，具有一定的后渗透能力。由于此脚本的目的是生成漏洞触发的RTF文档,具有很强的后渗透可操作性,因此认为存在10%的投毒风险。

**项目地址:** [starnightcyber/CVE-2017-11882](https://github.com/starnightcyber/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)