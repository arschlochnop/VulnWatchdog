## CVE-2023-24249-laravel-admin-任意文件上传

**漏洞编号:** CVE-2023-24249

**漏洞类型:** 任意文件上传

**影响应用:** laravel-admin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.8.19

**利用条件:** 需要管理员权限或可访问上传接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-24249是laravel-admin 1.8.19版本中存在的任意文件上传漏洞。攻击者可以通过上传恶意PHP文件来执行任意代码。漏洞利用代码提供了一个可行的PoC，它首先登录到管理后台，然后通过修改头像处上传包含恶意代码的PHP文件，成功上传后，攻击者可以通过访问上传的文件来执行任意系统命令。

**有效性：**
PoC代码有效，根据描述和代码逻辑，能够利用该漏洞上传webshell。

**投毒风险：**
分析PoC代码，未发现明显的投毒代码。该代码功能明确，只包含登录、上传和webshell访问三个步骤，功能都是为了验证漏洞，没有发现隐藏的恶意逻辑。

**利用方式：**
1.  使用提供的用户名和密码登录laravel-admin后台管理界面(需要先找到登录页面).
2.  获取登录后的Token，用于后续操作的身份验证。
3.  构造包含恶意PHP代码的文件，例如`<?php system($_REQUEST["c"]);?>`，用于执行系统命令。
4.  将恶意PHP文件作为头像上传到服务器，利用头像上传功能绕过文件类型检查(如果存在)。
5.  获取上传文件的路径，并通过访问该路径并附加参数来执行任意系统命令。

攻击者通过精心构造的PHP文件，可以获取服务器的控制权，从而造成严重的损失。

**项目地址:** [ldb33/CVE-2023-24249-PoC](https://github.com/ldb33/CVE-2023-24249-PoC)

**漏洞详情:** [CVE-2023-24249](https://nvd.nist.gov/vuln/detail/CVE-2023-24249)