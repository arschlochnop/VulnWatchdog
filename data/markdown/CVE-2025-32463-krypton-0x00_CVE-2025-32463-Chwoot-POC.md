## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取Root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32463 是 Sudo 软件中一个严重的安全漏洞，允许本地用户通过操纵 `chroot` 选项和利用用户可控目录中的 `/etc/nsswitch.conf` 文件来获得 root 权限。以下是对此漏洞的详细分析：

**有效性：**

*   漏洞库信息表明该漏洞影响 Sudo 1.9.14 到 1.9.17p1 之前的版本，且 CVSS 评分为 9.3，属于严重级别。漏洞描述指出，通过 `--chroot` 选项，可以利用用户控制目录下的 `/etc/nsswitch.conf` 文件来提权。
*   搜索引擎结果中，多个网页（例如 NVD、Red Hat、Oligo Security、Wiz.io、ZeroPath）确认了该漏洞的存在和严重性。GitHub 上也存在相关的 POC 代码仓库，表明漏洞已被公开验证。
*   提供的代码段 `Cargo.lock` 像是 Rust 项目的依赖锁定文件，与其仓库名“CVE-2025-32463-Chwoot-POC”相符。虽然仅仅是依赖信息，但是结合其他信息，说明POC代码是存在的，且是rust代码，且项目名称表明它是一个POC

综合上述信息，可以判断该漏洞的 POC 代码有效，并且利用比较简单。

**投毒风险：**

*   提供的代码片段 `Cargo.lock` 本身不包含任何可执行代码，因此直接投毒的可能性较低。 `Cargo.lock` 文件只是用于锁定依赖项版本，确保构建的可重复性。但是，攻击者可能尝试替换或篡改依赖项，引入恶意代码。考虑到 `Cargo.lock` 文件主要用于管理项目依赖，以及潜在的供应链攻击风险，我们认为存在极低的投毒可能性，大约为 1%。
*   真正的投毒风险应该存在于其他源文件，但未提供，无法分析。

**利用方式：**

1.  **创建恶意 `nsswitch.conf` 文件：** 攻击者需要在自己控制的目录下创建一个恶意的 `/etc/nsswitch.conf` 文件，用于劫持 Sudo 的名称服务解析。
2.  **使用 `sudo` 命令和 `--chroot` 选项：** 攻击者需要使用 `sudo` 命令，并结合 `--chroot` 选项，将根目录切换到攻击者控制的目录。然后，Sudo 将会加载攻击者提供的恶意 `nsswitch.conf` 文件。
3.  **提权：** 通过恶意 `nsswitch.conf` 文件的配置，攻击者可以执行任意代码，从而获得 root 权限。

**总结：**

CVE-2025-32463 是一个高危的 Sudo 本地提权漏洞，利用方式相对简单，攻击者可以通过控制 `/etc/nsswitch.conf` 文件来获得 root 权限。虽然提供的 `Cargo.lock` 文件本身不具备投毒性，但仍需警惕供应链攻击的风险。建议受影响的用户尽快升级到 Sudo 1.9.17p1 或更高版本。

**项目地址:** [krypton-0x00/CVE-2025-32463-Chwoot-POC](https://github.com/krypton-0x00/CVE-2025-32463-Chwoot-POC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)