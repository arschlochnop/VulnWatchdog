## CVE-2024-3121 - lollms create_conda_env 远程代码执行

**漏洞编号:** CVE-2024-3121

**漏洞类型:** 远程代码执行

**影响应用:** parisneo/lollms

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 5.9.0 及之前版本

**利用条件:** 需要能够控制create_conda_env函数的env_name和python_version参数

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于`parisneo/lollms`项目的`create_conda_env`函数中。由于`subprocess.Popen`函数使用了`shell=True`，并且直接将用户提供的`env_name`和`python_version`参数拼接进shell命令中，导致了命令注入漏洞。攻击者可以通过修改`env_name`参数，插入恶意的shell命令，从而实现远程代码执行。POC代码通过将`env_name`设置为`test_env; whoami`来演示了该漏洞。`whoami`命令会在目标机器上执行，泄露当前用户的身份信息。搜索引擎结果和漏洞库信息均确认了漏洞的存在，并指出该漏洞的危害性。由于POC的创建者dark-ninja10在GitHub上有其他项目，存在一定的投毒风险，但也可能是安全研究人员。

**项目地址:** [dark-ninja10/CVE-2024-3121](https://github.com/dark-ninja10/CVE-2024-3121)

**漏洞详情:** [CVE-2024-3121](https://nvd.nist.gov/vuln/detail/CVE-2024-3121)