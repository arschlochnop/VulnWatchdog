## CVE-2025-53772-Web Deploy Remote Code Execution

**漏洞编号:** CVE-2025-53772

**漏洞类型:** 反序列化漏洞导致的远程代码执行

**影响应用:** Microsoft Web Deploy 4.0

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** 10.0.2000 (不包含10.0.2001)

**利用条件:** 需要攻击者能够通过网络访问Web Deploy服务，且具备一定的用户权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53772 是 Microsoft Web Deploy 4.0 中存在的一个高危远程代码执行漏洞。该漏洞源于 Web Deploy 在处理反序列化数据时存在缺陷，允许经过身份验证的攻击者通过发送特制的请求，在目标服务器上执行任意代码。

**漏洞分析：**

*   **漏洞类型：** 反序列化漏洞 (CWE-502)。
*   **影响组件：** Microsoft Web Deploy 4.0 版本 10.0.2000 (不包含 10.0.2001).
*   **攻击向量：** 网络。
*   **利用条件：** 需要攻击者能够通过网络访问 Web Deploy 服务，并且需要一定的用户权限来执行部署操作。

**漏洞利用方式：**

1.  **构造恶意序列化数据：** POC代码 `poc.cs` 首先构造一个包含恶意负载的序列化对象。POC中使用了 `SortedSet` 和 `Comparison<string>` 委托，并通过反射修改委托的调用列表，将 `Process.Start` 函数注入到序列化数据中。当反序列化时，会导致执行任意代码。
2.  **压缩和编码：**  POC将序列化的数据进行 GZip 压缩，然后进行 Base64 编码，生成最终的Payload。这段Base64编码的字符串即为攻击载荷。
3.  **发送恶意请求：** 攻击者将构造好的恶意载荷通过 Web Deploy 接口发送到目标服务器。目标服务器在处理该请求时，会对载荷进行反序列化，从而触发远程代码执行。

**有效性：**

根据漏洞描述和POC代码，该POC应该是有效的。POC代码构造了恶意的序列化数据，利用反序列化漏洞执行任意命令。

**投毒风险：**

POC 代码本身的主要目的是演示漏洞利用，但依旧存在一些潜在的投毒风险。

*   **硬编码的Webhook地址：** 代码中硬编码了 `https://webhook.site/16a4d8d1-c492-4f7b-8d75-895085a81d61` 作为接收反向shell或者数据的地址。虽然这可能是用于演示，但也可能被用于收集受害者信息。
*   **命令执行的隐蔽性：**  `cmd.exe /c`  可以执行任意命令，攻击者可以替换成更具隐蔽性的恶意操作。
*   **依赖外部服务：** POC依赖 `curl` 命令来获取公网IP，如果目标环境没有 `curl` 命令，则Payload可能无法正常工作，但这不属于投毒范畴。

  综合来看，存在一定的投毒风险，但主要是由于演示POC的性质决定的。 风险大概在10%。核心代码是反序列化漏洞的利用，而非恶意代码的投放。

**修复建议：**

*   升级 Web Deploy 到不受影响的版本（>= 10.0.2001）。
*   限制 Web Deploy 服务的访问权限，仅允许授权用户访问。
*   使用安全的序列化/反序列化机制。

**项目地址:** [Momollax/CVE-2025-53772-IIS-WebDeploy-RCE](https://github.com/Momollax/CVE-2025-53772-IIS-WebDeploy-RCE)

**漏洞详情:** [CVE-2025-53772](https://nvd.nist.gov/vuln/detail/CVE-2025-53772)