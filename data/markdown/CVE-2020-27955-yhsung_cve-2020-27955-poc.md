## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** RCE

**影响应用:** Git LFS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者clone包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，Git LFS 2.12.0存在远程代码执行漏洞（CVE-2020-27955）。漏洞利用代码包含`git.cmd`和`large.dat`两个文件。

*   `git.cmd`包含`calc.exe`，说明这个POC的目的是在目标机器上执行`calc.exe`。
*   `large.dat`文件包含`Junk`，可能是一个占位文件，用于满足Git LFS对大文件的要求。

**利用方式：**攻击者创建一个包含恶意Git LFS对象的Git仓库。当受害者克隆该仓库时，Git LFS会尝试下载并处理这些对象。通过精心构造`.gitattributes`文件和LFS对象的内容，攻击者可以使`git lfs pull`命令执行任意命令。本例中，`git.cmd`会被执行，从而启动计算器程序。

**有效性：**  提供的POC代码看起来是有效的，因为`git.cmd`包含执行计算器的命令。如果能成功触发`git lfs pull`并执行该文件，则可以证明漏洞的存在。

**投毒风险：** 此仓库存在一定的投毒风险，约为10%。虽然主要目的是执行`calc.exe`，但是`git.cmd`文件的内容可以被修改为其他恶意命令。如果攻击者在`git.cmd`中放置更隐蔽的恶意代码，例如下载并执行其他Payload，则可能实现更严重的攻击，且不易被察觉。  `large.dat`文件本身不太可能存在投毒行为，因为它只是一个占位文件。


**项目地址:** [yhsung/cve-2020-27955-poc](https://github.com/yhsung/cve-2020-27955-poc)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)