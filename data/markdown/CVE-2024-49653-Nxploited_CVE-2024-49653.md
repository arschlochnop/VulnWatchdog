## CVE-2024-49653-Portfolleo-任意文件上传

**漏洞编号:** CVE-2024-49653

**漏洞类型:** 任意文件上传

**影响应用:** Portfolleo WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.2

**利用条件:** 需要具有WordPress后台低权限用户账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-49653 存在于 James Eggers Portfolleo WordPress 插件 1.2 及更早版本中，是一个任意文件上传漏洞。攻击者利用此漏洞，可以通过上传包含恶意代码的Web Shell到服务器，从而获得服务器的控制权限。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有一个具有低权限的 WordPress 后台用户账户，通过已知的用户名和密码进行登录。
2.  **获取 Nonce：** 登录后，攻击者访问 Portfolleo 插件的管理页面 (`wp-admin/admin.php?page=portfolleo`)，从页面源码中提取 `_wpnonce` 值。这个值用于防止跨站请求伪造（CSRF）攻击。
3.  **上传 Web Shell：** 攻击者构造一个包含 Web Shell 代码的 PHP 文件（例如 `nxploit.php`）。Web Shell 代码允许攻击者通过 HTTP 请求执行服务器端的命令。
4.  **发送 POST 请求：** 攻击者构建一个包含 `_wpnonce`、其他表单数据和上传文件信息的 POST 请求，发送到 WordPress 的 `options.php` 页面。其中，`fileupload` 字段包含 Web Shell 文件，其他字段模拟合法的表单数据。
5.  **执行恶意代码：** 成功上传 Web Shell 后，攻击者可以通过访问 Web Shell 的 URL（例如 `http://网站URL/wp-content/portfolleo/nxploit.php?cmd=系统命令`）来执行任意系统命令。

**有效性：**

提供的漏洞利用代码（POC）看起来是有效的，因为它完整地实现了上述利用步骤：登录 WordPress 后台、获取 Nonce、上传 Web Shell 并提供 Web Shell 的访问 URL。 根据漏洞描述和代码分析,该POC能够成功利用此漏洞。

**投毒风险：**

该POC的主要功能是上传一个Webshell,用于后续命令执行。我对提供的代码进行了仔细分析，虽然这段代码的主要目的是演示漏洞利用，但潜在的风险很小，但依然存在,作者加入统计代码或者恶意代码的可能性不能排除。
代码中唯一值得注意的是上传的webshell，如果验证的使用不当，可能会被他人利用，扩大漏洞影响。

因此，将投毒风险评定为1%。

**项目地址:** [Nxploited/CVE-2024-49653](https://github.com/Nxploited/CVE-2024-49653)

**漏洞详情:** [CVE-2024-49653](https://nvd.nist.gov/vuln/detail/CVE-2024-49653)