## CVE-2022-30190-Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可能导致远程代码执行，系统被完全控制

**影响版本:** 受影响的Windows版本范围广泛，包括Windows 7至Windows 11及多个Server版本，详见漏洞库信息。

**利用条件:** 用户需要打开包含恶意链接或文档（如Word文档）的应用程序。攻击依赖于MSDT通过URL协议被调用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。攻击者可以通过精心构造的恶意文档，诱使用户打开，该文档利用Word的远程模板功能从远程服务器检索HTML文件，通过MSDT协议执行任意代码。该漏洞的利用方式是：

1.  **攻击者创建一个恶意的Word文档或其他支持远程模板的文档。**
2.  **该文档包含一个指向恶意服务器的链接，用于下载一个HTML文件。**
3.  **当用户打开该文档时，Word会尝试从远程服务器下载HTML文件。**
4.  **HTML文件包含恶意的JavaScript代码，该代码使用`ms-msdt:`协议调用MSDT，并执行任意命令。**
5.  **攻击者利用MSDT的漏洞执行系统命令，实现远程代码执行。**

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞利用的有效性较高，已被积极利用。

**投毒风险：**
提供的漏洞利用代码只包含GNU GPL协议的许可证，属于开源协议声明，不具备实际的漏洞利用代码。无法直接用于评估是否存在后门或恶意代码。但考虑到实际漏洞利用中可能存在复杂的攻击链，且攻击者可能修改或添加额外的恶意代码，仍然存在一定的投毒风险。此处预估投毒风险为10%，主要考虑实际利用中攻击者可能的定制行为。

**搜索引擎结果补充：** 搜索引擎结果中提到漏洞利用需要调用URL协议和MSDT。同时，参考 Qualys 的博客，表明此漏洞影响范围广泛。Arctic Wolf的博客也指出此漏洞已经被积极利用。这些都增加了漏洞利用的有效性评估。


**项目地址:** [ar2o3/FollinaXploit](https://github.com/ar2o3/FollinaXploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)