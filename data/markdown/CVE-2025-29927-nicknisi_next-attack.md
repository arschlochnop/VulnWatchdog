## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞版本的Next.js，并且在中间件中进行了权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 的中间件中，允许攻击者绕过授权检查。漏洞的根源在于 Next.js 对 `x-middleware-subrequest` 头的处理不当。该漏洞影响 Next.js 11.1.4 到 13.5.6、14.0.0 到 14.2.25 以及 15.0.0 到 15.2.3 版本。

**有效性：**

根据提供的漏洞信息和利用代码，该漏洞的 POC 代码是有效的。POC 通过设置特定的 `x-middleware-subrequest` 头来绕过中间件中的授权检查，允许未授权用户访问受保护的资源（例如 `/api/admin`）。

**投毒风险：**

提供的代码仓库主要是演示漏洞的利用，存在恶意投毒代码的风险较低。`package-lock.json`文件可能存在投毒风险，但概率较低。`next.config.ts`是一个基本的配置文件，包含恶意代码的可能性很小。而提供的 POC 代码主要目的是演示漏洞，而不是执行恶意操作。虽然无法完全排除风险，但可以认为该代码仓库的投毒风险较低，约为5%。

**利用方式：**

1.  攻击者构造包含特定 `x-middleware-subrequest` 头的 HTTP 请求。
2.  Next.js 应用在处理该请求时，由于漏洞存在，未能正确验证 `x-middleware-subrequest` 头的有效性，导致中间件的授权检查被绕过。
3.  攻击者因此可以访问原本需要授权才能访问的资源，例如管理页面或 API 端点。

简单来说，攻击者通过伪造内部子请求绕过中间件的权限验证。

**缓解措施:**

*   升级到 Next.js 14.2.25 或 15.2.3 或更高版本。
*   阻止包含 `x-middleware-subrequest` 头的外部用户请求。

**项目地址:** [nicknisi/next-attack](https://github.com/nicknisi/next-attack)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)