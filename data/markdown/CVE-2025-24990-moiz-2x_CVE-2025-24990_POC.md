## CVE-2025-24990 - Windows Agere Modem Driver 权限提升漏洞

**漏洞编号:** CVE-2025-24990

**漏洞类型:** 权限提升

**影响应用:** Windows Agere Modem Driver (ltmdm64.sys)

**危害等级:** 高危，允许低权限用户提升至系统权限

**影响版本:** 受影响的Windows版本请参考CVE描述

**利用条件:** 需要目标系统存在受影响的Agere Modem Driver，且版本在受影响范围内。需要在受影响的Windows版本上，且驱动没有被移除的情况下。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24990是Windows Agere Modem Driver (ltmdm64.sys) 中的一个权限提升漏洞。该漏洞是由于驱动程序中的一些IOCTL处理函数(如0x802b200f)在使用`METHOD_NEITHER`方式时不验证用户提供的缓冲区地址是否为内核地址导致的。攻击者可以利用这一点，通过`DeviceIoControl` API向驱动程序传递内核地址，导致任意地址读写。

**利用方式：**

1.  **信息泄露 (绕过KASLR):** 利用`EnumDeviceDrivers` API (Windows 24H2 需要SeDebugPriv权限)泄露内核地址，绕过KASLR。
2.  **空指针解引用:** 利用IOCTL `0x802b200f` (`ud_response`) 触发`ll_load_diagnostics`函数中的空指针解引用，导致拒绝服务。 通过VirtualAlloc分配地址，然后利用0x802b2003改写eeprom地址，让其指向可控的地址，从而修复NULL指针解引用。
3.  **任意地址写4字节:** 利用IOCTL `0x802b2003` (`IOCTL_GET_VERSION`) 将驱动版本字符串"8.36"转换为DWORD `0x836`，写入用户指定的内核地址，实现任意地址写4字节。
4.  **任意地址减1:** 利用`IOCTL_SET_LtMsgEvent` 和 `IOCTL_DEREF_LtMsgEvent` 最终调用 `ObfReferenceObject` API 实现任意地址减1。

**投毒风险分析：**

从提供的`README.md`来看，漏洞利用代码主要集中在对`ltmdm64.sys`驱动的利用上，没有发现直接的恶意代码植入或后门行为。但是，考虑到以下几点，仍然存在一定的投毒风险：

*   **BYOVD场景：** 该利用需要在Bring Your Own Vulnerable Driver (BYOVD) 场景下，这意味着攻击者需要首先将存在漏洞的驱动加载到目标系统上。攻击者可能会使用一个修改过的、包含恶意代码的`ltmdm64.sys`驱动。但README中仅提供了利用思路，并没有直接提供被修改的驱动。
*   **利用链复杂性：** 该漏洞利用涉及多个IOCTL调用和内存操作，攻击者可能在利用链中插入恶意代码，例如在修改内核变量时执行特定操作。
*   **代码可读性差：** 提供的代码片段可读性一般，难以全面评估其安全性。缺乏完整的源代码，增加了分析难度。
*   **社会工程学：** 攻击者可能通过社会工程学手段诱骗用户下载并运行包含恶意代码的漏洞利用程序。

综合以上分析， 投毒风险较低，风险值约为5%。主要风险在于攻击者是否会替换原始的`ltmdm64.sys`驱动为恶意版本，或者在复杂的利用链中插入恶意操作。 由于利用方式较为复杂，需要一定的内核调试经验， 普通用户难以进行二次开发。故判断投毒风险为5%。

**有效性：**

提供的POC代码看起来是有效的，因为它描述了如何利用该漏洞实现权限提升，并提供了相关的IOCTL调用和内存操作细节。利用了多个IOCTL实现信息泄漏、地址改写和指针操作，最终达成目的。但由于只有代码片段，缺少完整的可执行POC， 无法直接验证其有效性。但原理上是可行的。

**项目地址:** [moiz-2x/CVE-2025-24990_POC](https://github.com/moiz-2x/CVE-2025-24990_POC)

**漏洞详情:** [CVE-2025-24990](https://nvd.nist.gov/vuln/detail/CVE-2025-24990)