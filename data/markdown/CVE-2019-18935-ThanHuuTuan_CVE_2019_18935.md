## CVE-2019-18935-Telerik UI for ASP.NET AJAX-反序列化漏洞

**漏洞编号:** CVE-2019-18935

**漏洞类型:** 反序列化

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 需要目标系统存在Telerik UI for ASP.NET AJAX，且未启用缓解措施或更新到2020.1.114及以上版本；需要已知加密密钥（通过CVE-2017-11317或CVE-2017-11357或其他方式获取）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-18935是Telerik UI for ASP.NET AJAX中的一个.NET反序列化漏洞，存在于RadAsyncUpload功能中。当加密密钥已知时（由于CVE-2017-11317或CVE-2017-11357的存在，或者通过其他方式），该漏洞可被利用。利用成功可导致远程代码执行。

**有效性分析：**

从提供的漏洞库信息、搜索引擎结果和漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库信息明确指出该漏洞的存在以及利用条件，搜索引擎结果中也包含了多个安全厂商的分析报告和利用示例，CISA也将其列入已知被利用漏洞目录(KEV)。漏洞利用代码提供了完整的利用流程，包括加密、构造请求和触发反序列化等步骤。

**投毒风险分析：**

对提供的Python POC代码进行了分析，发现以下潜在的风险点，但不足以判定为恶意投毒行为：

1.  **RAU_crypto 依赖**: POC代码依赖于一个名为`RAU_crypto`的本地库。虽然代码中包含了对该库的引用和使用，但没有提供该库的源代码。攻击者可能通过修改`RAU_crypto`库的内容，例如替换其中的加密算法或添加恶意代码，从而影响漏洞利用的可靠性或引入新的安全风险。因此，必须小心审查依赖的 `RAU_crypto` 库，确保它的安全性和可信度。
2.  **SMB Server**: POC代码的`-s`参数允许指定一个远程SMB服务器。攻击者可能利用这个参数，将恶意代码放置在SMB服务器上，并通过反序列化漏洞在目标系统上执行。
3.  **文件上传路径**: 如果攻击者能控制 `temp_target_folder` 变量，便可以将任意文件上传到服务器的指定目录，为后续攻击，如webshell植入创造条件。

综上，该POC代码存在一定的投毒风险，但这些风险更偏向于利用该POC进行二次攻击的可能性。该POC代码的投毒风险评估为10%。

**利用方式：**

1.  **密钥获取：** 首先，攻击者需要获取Telerik UI的加密密钥。这可以通过利用CVE-2017-11317或CVE-2017-11357等漏洞，或者通过其他方式获取。
2.  **上传Payload：** 攻击者使用RadAsyncUpload功能上传一个恶意的Payload。Payload可以是包含恶意代码的混合模式程序集DLL。
3.  **反序列化触发：** 攻击者构造一个恶意的rauPostData，其中包含System.Configuration.Install.AssemblyInstaller对象，并将其Path属性设置为Payload的路径。然后，攻击者将该rauPostData发送到服务器，触发反序列化漏洞。
4.  **远程代码执行：** 服务器在反序列化AssemblyInstaller对象时，会加载并执行Payload中的恶意代码，从而实现远程代码执行。

**项目地址:** [ThanHuuTuan/CVE_2019_18935](https://github.com/ThanHuuTuan/CVE_2019_18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)