## CVE-2024-6536 - Zephyr Project Manager 插件 Editor+ XSS

**漏洞编号:** CVE-2024-6536

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** Zephyr Project Manager WordPress plugin

**危害等级:** 中危，可能导致账户劫持、恶意代码执行

**影响版本:** < 3.3.99

**利用条件:** 需要 WordPress 编辑者（Editor）或更高权限用户，且目标站点安装了 Zephyr Project Manager 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6536 是 Zephyr Project Manager WordPress 插件中的一个存储型 XSS 漏洞。该漏洞存在于插件的设置中，允许具有较高权限的用户（例如编辑者和管理员）执行存储型跨站脚本攻击，即使 unfiltered_html 功能被禁用（例如在多站点设置中）。

**有效性分析：**

根据漏洞信息、搜索引擎结果和提供的 POC 代码，可以判断该漏洞是有效的。

*   **漏洞信息：** CVE 描述明确指出 Zephyr Project Manager WordPress plugin 在 3.3.99 版本之前存在 XSS 漏洞，由于未能充分 sanitise 和 escape 设置。
*   **搜索引擎结果：** 搜索结果证实了 CVE-2024-6536 的存在，并描述了该漏洞的影响和风险。
*   **漏洞利用代码：** 提供的 POC 代码演示了如何利用该漏洞。该脚本首先尝试使用提供的用户名和密码进行身份验证，然后获取 nonce 值，最后创建一个包含恶意 JavaScript 代码的项目名称。当其他用户访问包含恶意项目名称的页面时，JavaScript 代码将被执行。

**投毒风险分析：**

检查了提供的 POC 代码，没有发现作者隐藏的投毒代码。代码逻辑清晰，主要功能是利用漏洞创建包含 XSS payload 的项目。所有操作都与漏洞利用相关，没有发现任何可疑行为，例如反向 shell、恶意文件上传等。因此，投毒风险为 0%。

**利用方式分析：**

1.  **身份验证：** 使用 WordPress 管理员或者编辑者账户进行身份验证。
2.  **获取 Nonce：** 获取 Zephyr Project Manager 插件的 nonce 值，用于绕过 CSRF 保护。
3.  **创建包含 XSS Payload 的项目：** 通过向 WordPress 的 admin-ajax.php 端点发送 POST 请求，创建一个新的 Zephyr 项目。其中，项目名称包含 XSS Payload（例如 `<script>alert(1)</script>` 或者更复杂的恶意代码）。
4.  **触发 XSS：** 当其他用户（包括管理员）访问包含恶意项目名称的页面时，XSS Payload 被执行。例如，当管理员查看项目列表或编辑项目时，恶意 JavaScript 代码可能会被执行。

**综上所述，** CVE-2024-6536 是一个有效的存储型 XSS 漏洞，攻击者可以利用该漏洞在 Zephyr Project Manager 插件中注入恶意 JavaScript 代码，从而进行恶意操作，例如账户劫持、页面重定向等。 提供的POC代码没有发现存在投毒风险。


**项目地址:** [apena-ba/CVE-2024-6536](https://github.com/apena-ba/CVE-2024-6536)

**漏洞详情:** [CVE-2024-6536](https://nvd.nist.gov/vuln/detail/CVE-2024-6536)