## CVE-2025-49844 Redis Lua Use-After-Free Remote Code Execution

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** Critical，远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本支持，且攻击者能够执行 EVAL 和 EVALSHA 命令（通常需要较低权限）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、漏洞利用代码，以及结合搜索助理和网络漏洞研究员的角色，对漏洞进行评估如下：

**有效性：**
提供的POC代码（Dockerfile、README.md）描述了CVE-2025-49844漏洞的利用环境搭建和利用方法。通过 Dockerfile 搭建了一个存在漏洞的 Redis 7.2.0 版本环境，并通过 README.md 提供了详细的利用说明和示例命令。POC代码的README显示，该漏洞利用程序包含了检查漏洞是否存在、触发基本UAF、测试沙箱逃逸和执行内存破坏模式等功能。综合漏洞描述信息，该POC代码是有效的。

**投毒风险：**
*   **分析：** 查看Dockerfile以及README.md，其中主要的工作是搭建一个存在漏洞的redis环境，并指导使用者如何使用exploit_poc.py 验证漏洞。从提供的文件来看，主要关注exploit_poc.py是否存在风险。根据描述文档，exploit_poc.py只是用来验证漏洞，并没有发现任何后门或者恶意代码，主要用于演示该漏洞的利用。但是，任何未经审查的代码都存在一定的潜在风险，尤其是涉及到远程代码执行漏洞的利用。如果攻击者修改了`exploit_poc.py`文件，例如，在内存破坏步骤中插入恶意代码，可能会导致服务器被植入后门。
*   **风险评估：** 考虑到dockerfile与README.md文件本身的性质,以及分析， 此仓库中存在作者隐藏的投毒代码的风险较低，评估为10%。

**利用方式：**
1.  **环境准备：** 使用Dockerfile构建一个包含漏洞版本的Redis实例。
2.  **连接Redis：** 使用redis客户端连接到目标Redis服务器（可能需要身份验证）。
3.  **发送恶意Lua脚本：** 使用`EVAL`命令将特制的Lua脚本发送到Redis服务器。
4.  **触发Use-After-Free：** Lua脚本通过操纵垃圾回收机制触发UAF漏洞。
5.  **沙箱逃逸（可选）：** 某些利用方法可能包含绕过Lua沙箱的步骤，以便执行更广泛的操作。
6.  **代码执行：** 成功触发UAF并可能绕过沙箱后，攻击者可以执行任意代码，从而控制Redis服务器。

**总结：**
CVE-2025-49844是一个高危漏洞，攻击者利用精心构造的Lua脚本，可以造成Redis服务器的远程代码执行。即使攻击者权限较低，仍然可以成功利用。使用提供的POC代码可以复现该漏洞，但也需要注意代码审查，以降低投毒风险。

**项目地址:** [raminfp/redis_exploit](https://github.com/raminfp/redis_exploit)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)