## CVE-2024-32113 - Apache OFBiz 路径遍历导致RCE

**漏洞编号:** CVE-2024-32113

**漏洞类型:** 路径遍历导致远程代码执行 (Path Traversal to RCE)

**影响应用:** Apache OFBiz

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 18.12.13

**利用条件:** 需要网络访问，目标系统运行存在漏洞版本的Apache OFBiz

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2024-32113是一个Apache OFBiz中的路径遍历漏洞，攻击者可以利用该漏洞读取或写入受限目录之外的文件，从而可能导致远程代码执行。CISA已将其加入已知被利用漏洞目录 (KEV)。提供的漏洞利用代码（`exploit.py`和 `README.md`）针对的是CVE-2024-38856，描述的是未经授权访问`/webtools/control/forgotPassword/ProgramExport`端点导致的RCE，与CVE-2024-32113有所不同，但都是Apache OFBiz的RCE漏洞。`exploit.py`通过向`/webtools/control/forgotPassword/ProgramExport`发送包含Groovy代码的POST请求，并将Groovy代码转换为Unicode编码进行绕过，从而执行系统命令。利用方式是将命令注入到 `throw new Exception('{command}'.execute().text);` 语句中，通过异常处理机制获取命令执行结果。存在投毒风险的可能性较低 (10%)，主要来自对第三方库的依赖以及Unicode编码的处理，但是作者在代码中加入后门的概率不大。由于脚本明确说明是Linux环境，若在非Linux环境下运行，可能会出现未预期的行为。脚本使用`requests`库发送HTTP请求，若目标服务器存在自签名证书，脚本会禁用SSL验证。总体来看，利用代码的有效性较高，但针对的是 CVE-2024-38856 而不是 CVE-2024-32113。

**项目地址:** [guinea-offensive-security/Ofbiz-RCE](https://github.com/guinea-offensive-security/Ofbiz-RCE)

**漏洞详情:** [CVE-2024-32113](https://nvd.nist.gov/vuln/detail/CVE-2024-32113)