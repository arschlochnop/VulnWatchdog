## CVE-2023-45866-BlueZ-蓝牙HID注入

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 蓝牙HID注入

**影响应用:** BlueZ

**危害等级:** 高危，可能导致键盘注入攻击，远程命令执行

**影响版本:** bluez <= 5.64 (Ubuntu 22.04LTS)

**利用条件:** 攻击者需在蓝牙通信范围内，目标设备蓝牙开启且易受攻击

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙HID外围设备发起和建立加密连接，并接受HID键盘报告，从而可能注入HID消息。攻击者可以伪装成蓝牙键盘，在目标设备未授权的情况下发送键盘输入，实现远程命令执行等恶意操作。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞允许攻击者在未经用户授权的情况下，通过蓝牙连接并模拟键盘输入，具有较高的利用价值。提供的POC代码似乎包含多种攻击场景，如暴力破解密码、相机劫持（camphish）、恶意APK下载和安装、文件上传以及发送WhatsApp消息。虽然具体效果取决于目标设备和配置，但整体来看，这些POC代码具备一定的有效性。

**投毒风险评估：**

提供的POC代码主要利用键盘输入模拟用户操作，实现特定功能。虽然这些功能本身可能被滥用，但代码本身并未发现明显的恶意后门或植入行为，判断该仓库的投毒风险为10%。

**利用方式分析：**

1.  **连接阶段绕过：** 漏洞核心在于绕过蓝牙HID连接时的身份验证或授权机制，允许攻击者控制的设备未经许可建立连接。
2.  **HID消息注入：** 成功建立连接后，攻击者可以发送任意HID消息，模拟键盘输入、鼠标点击等操作。
3.  **利用场景：**
    *   **密码暴力破解：** 通过模拟键盘输入，尝试不同的密码组合。
    *   **恶意链接打开：** 注入URL，诱导用户访问恶意网站，例如下载恶意APK。
    *   **摄像头劫持：** 通过注入特定URL，利用WebRTC等技术访问摄像头，拍摄照片。
    *   **文件上传：** 打开文件上传页面，模拟用户操作选择并上传文件。
    *   **发送消息：** 打开WhatsApp网页版，模拟用户输入并发送消息。
4.  **攻击流程示例（恶意APK安装）：**
    *   攻击者伪装成蓝牙键盘，连接目标设备。
    *   注入包含恶意APK下载链接的URL，打开浏览器。
    *   模拟键盘输入，点击下载按钮。
    *   模拟键盘输入，允许安装未知来源应用。
    *   模拟键盘输入，完成APK安装。

**优先级：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [AvishekDhakal/CVE-2023-45866_EXPLOITS](https://github.com/AvishekDhakal/CVE-2023-45866_EXPLOITS)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)