## CVE-2024-27956-WordPress Automatic Plugin-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标WordPress站点安装了受影响版本的WP-Automatic插件，且未进行修复

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-27956 存在于 WordPress Automatic 插件 3.92.0 及更早版本中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过向 `wp-content/plugins/wp-automatic/inc/csv.php` 文件发送特制的 POST 请求，利用 `q` 参数注入恶意 SQL 代码。 

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。CVE 详细信息表明该漏洞是 SQL 注入，而搜索引擎结果也显示该漏洞已被积极利用。提供的 POC 代码通过创建恶意管理员用户来利用此漏洞，这最终可能导致远程代码执行。

**投毒风险分析：**

POC 代码包含两个主要的请求：

1.  创建用户 'eviladmin'，密码哈希为 '$P$BASbMqW0nlZRux/2IhCw7AdvoNI4VT0'，邮箱为 'eviladmin@gmail.com'。
2.  赋予 'eviladmin' 管理员权限。

检查 `exploit.py` 代码，可以发现：
*  代码结构简单，主要功能是发送带有 SQL 注入 payload 的 POST 请求。没有发现明显的恶意代码或后门。
*  硬编码了 SQL 注入 payload 和用于请求完整性校验的 hash 值。这两个 hash 值如果目标站点使用了WAF策略可能会拦截,不属于恶意代码,是POc验证代码必须的部分. 如果不是这个哈希，payload 会被服务器拒绝执行。

因此，初步评估认为该 POC 代码的投毒风险较低。该库看起来是一个利用 CVE-2024-27956的PoC，目标是创建一个名为eviladmin的用户并赋予其管理员权限。

**利用方式总结：**

1.  攻击者利用未经身份验证的 SQL 注入漏洞。
2.  攻击者构造恶意的 SQL 语句，并通过 `q` 参数发送到目标服务器。
3.  第一个 SQL 语句在 `wp_users` 表中创建一个新的管理员用户（'eviladmin'）。
4.  第二个 SQL 语句将该新用户的权限提升为管理员。
5.  成功利用后，攻击者可以使用新创建的管理员帐户登录 WordPress 后台，并执行恶意操作，如安装恶意插件或修改主题文件，从而实现远程代码执行。
6.  需要注意的是, PoC 中使用的密码哈希 '$P$BASbMqW0nlZRux/2IhCw7AdvoNI4VT0' 对应明文密码 "admin"。

**项目地址:** [diego-tella/CVE-2024-27956-RCE](https://github.com/diego-tella/CVE-2024-27956-RCE)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)