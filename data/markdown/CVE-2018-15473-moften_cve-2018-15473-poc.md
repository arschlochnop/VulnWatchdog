## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续暴力破解或密码猜测攻击提供便利

**影响版本:** <= 7.7

**利用条件:** 需要目标SSH服务器开放22端口，并且允许未授权连接。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。该漏洞源于 OpenSSH 在处理无效用户身份验证请求时，没有延迟到完全解析完数据包之后再进行处理。攻击者可以通过发送特制的 SSH 请求，根据服务器的响应时间或错误信息来判断用户名是否存在。

**漏洞利用方式：**

1.  攻击者向目标 SSH 服务器发送包含特定用户名的认证请求（通常使用无效密码）。
2.  如果用户名存在，服务器会执行一部分认证流程，然后返回认证失败的信息。
3.  如果用户名不存在，服务器会立即拒绝连接，从而在响应时间上产生差异。
4.  攻击者通过分析服务器的响应，区分用户名是否存在，从而实现用户名枚举。

提供的 POC 代码 `cve-2018-15473-poc.py` 利用了 `paramiko` 库模拟 SSH 客户端，通过尝试使用无效密码对目标用户名进行身份验证，根据服务器的返回结果判断用户名是否有效。

**有效性：**

根据漏洞描述和提供的 POC 代码，可以判断该 POC 有效，可以用来枚举 OpenSSH 服务器上的用户名。

**投毒风险：**

查看提供的 POC 代码，该代码主要功能是建立 SSH 连接，并尝试使用无效密码进行身份验证，根据返回结果判断用户是否存在。没有发现任何恶意代码或后门，用于执行恶意操作或收集用户数据。因此，评估认为投毒风险为0%。


**项目地址:** [moften/cve-2018-15473-poc](https://github.com/moften/cve-2018-15473-poc)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)