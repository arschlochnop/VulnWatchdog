## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造（SSRF）漏洞。该漏洞存在于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意的 API 请求，使服务器代表其向任意 URL 发起请求，从而访问内部网络资源或获取敏感信息。

**利用方式：**

1.  攻击者创建一个包含 `forward_url` 参数的恶意请求，该参数指向攻击者想要访问的内部或外部 URL。
2.  攻击者将此请求发送到 `/api/baskets/{name}` 端点，其中 `{name}` 是一个任意的 basket 名称。
3.  Request-Baskets 服务会向 `forward_url` 指定的 URL 发起请求，并将响应返回给攻击者。

提供的 PoC 代码 `CVE-2023-27163.py` 演示了如何利用此漏洞。它通过以下步骤工作：

1.  使用 `argparse` 处理命令行参数，包括目标 Request-Baskets 服务的 URL、目标 URL 和字典文件路径。
2. 从字典文件读取URL, 使用提供的目标 URL 和 wordlist 中的每一行来构建要fuzzing的 URL.
3.  构造一个包含 `forward_url` 的 JSON payload，并将其发送到 `/api/baskets/{name}` 端点以创建一个新的 basket。
4.  提取创建 basket 时返回的 token。
5.  再次使用该Payload进行Post请求.
6.  发送带有 token 的 GET 请求到创建的 basket，触发 SSRF。
7.  检查响应状态码。如果状态码为 200，则打印响应内容，表示攻击成功。
8.  删除创建的 basket。

**投毒风险：**

虽然代码主要功能是利用 SSRF 漏洞，但仍存在少量投毒风险。

*   **依赖管理风险：** PoC代码依赖 `requests` 库，恶意维护者可能通过植入后门版本导致攻击者受到攻击。此类风险概率较低，但后果严重，故评估为 5%。
*   **潜在的恶意 Wordlist：** PoC 使用了用户提供的 wordlist 文件。如果 wordlist 文件被篡改，包含恶意 URL，则可能导致攻击者在扫描内部网络时意外触发其他漏洞或服务，造成不必要的损害。

总体来说，该 PoC 代码的主要功能是 SSRF 利用，投毒风险较低，主要集中在依赖项和 wordlist 上。

**项目地址:** [ThickCoco/CVE-2023-27163-POC](https://github.com/ThickCoco/CVE-2023-27163-POC)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)