## CVE-2025-29927 - Next.js Middleware 授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问、权限提升和数据泄露

**影响版本:** 受影响版本：11.1.4 <= 版本 <= 13.5.6, 14.0.0 < 版本 < 14.2.25, 15.0.0 < 版本 < 15.2.3

**利用条件:** 应用程序使用 Next.js 中间件进行授权检查，并运行在 `next start` 或独立模式下。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件中存在的一个授权绕过漏洞。攻击者可以通过在 HTTP 请求中包含 `x-middleware-subrequest` 头部来绕过中间件执行的授权检查。对于 15.x 版本，需要重复该头部的值五次以达到最大递归深度限制。漏洞利用的有效性较高，因为该漏洞利用简单，只需添加一个特制的HTTP头部即可。根据提供的漏洞利用代码，仓库中没有发现任何隐藏的投毒代码。漏洞的利用方式如下：

1.  **基本绕过（v15 之前）:**  向目标 `/admin` 或其他受保护的路由发送 GET 请求，并在 HTTP 头部中添加 `x-middleware-subrequest: middleware`。
2.  **递归深度绕过（v15.x）:** 向目标 `/admin` 或其他受保护的路由发送 GET 请求，并在 HTTP 头部中添加 `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`。

成功利用此漏洞后，攻击者可以绕过身份验证、访问控制和重定向，从而访问未经授权的资源，导致潜在的权限提升和数据泄露。

**项目地址:** [Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass](https://github.com/Kamal-Hegazi/Next.js-Middleware-Exploit-CVE-2025-29927-Authorization-Bypass)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)