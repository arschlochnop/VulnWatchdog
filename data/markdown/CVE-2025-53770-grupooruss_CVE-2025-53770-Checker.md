## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标SharePoint服务器可网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个严重的反序列化漏洞。攻击者可以通过向 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit` 发送特制的 POST 请求，利用恶意的 ViewState 数据触发反序列化，从而在服务器上执行任意代码。漏洞利用的先决条件是目标服务器未安装相应的安全补丁。根据搜索结果，该漏洞已在野外被利用，并且是 “ToolShell” 攻击链的一部分。提供的 POC 代码 `check_sp_cve2025_53770.py` 旨在检测目标 SharePoint 服务器是否存在此漏洞。它首先尝试获取 SharePoint 的构建版本信息（通过 `/_vti_pvt/buildversion.xml` 或 HTTP 头部），然后将其与已知的已修补版本进行比较。如果版本低于已修补版本，则脚本会发送一个测试 POST 请求到 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit`，以检测是否存在反序列化错误。虽然checker本身不是利用代码，但可以用来判断是否存在被利用的可能性。由于该漏洞可以通过发送恶意数据进行利用，所以存在一定投毒风险，例如，攻击者可能修改检测脚本，使其在检测漏洞的同时，植入后门。代码主要为检测，未发现恶意行为，但有网络请求，存在被篡改风险，所以认为存在10%投毒风险。

**利用方式：**

1.  **漏洞检测：** 使用 `check_sp_cve2025_53770.py` 脚本检测目标 SharePoint 服务器是否存在漏洞。
2.  **构建恶意 Payload：** 构造包含恶意代码的 ViewState payload。由于信息有限，具体构造方式需要进一步分析。
3.  **发送请求：** 将构造好的恶意 payload 通过 POST 请求发送到 `/ _layouts/15/ToolPane.aspx?DisplayMode=Edit`。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意代码。

**项目地址:** [grupooruss/CVE-2025-53770-Checker](https://github.com/grupooruss/CVE-2025-53770-Checker)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)