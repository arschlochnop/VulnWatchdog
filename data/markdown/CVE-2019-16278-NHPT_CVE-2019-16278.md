## CVE-2019-16278 - Nostromo nhttpd 目录遍历 RCE

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，可直接远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** Nostromo nhttpd 服务运行且目标端口开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Nostromo nhttpd 的 `http_verify` 函数中。攻击者可以通过构造包含目录遍历的 HTTP 请求，绕过权限验证，执行任意命令。根据提供的漏洞利用代码，攻击者使用`/.%0d./`绕过路径验证, 向上跳转目录, 最终执行`/bin/sh`，并将命令结果返回。攻击者通过POST请求向目标服务器发送恶意构造的payload，该payload包含目录遍历序列以及要执行的命令。代码中payload构造方式为 `POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n{} 2>&1`，其中 `{}` 会被替换为攻击者指定的命令。接收返回结果时，代码会跳过 HTTP 头部信息。该POC代码没有发现任何投毒的迹象。漏洞利用的有效性较高，因为多个来源 (NVD, Exploit-DB, Packetstorm) 证实了该漏洞的存在和利用方式。

**项目地址:** [NHPT/CVE-2019-16278](https://github.com/NHPT/CVE-2019-16278)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)