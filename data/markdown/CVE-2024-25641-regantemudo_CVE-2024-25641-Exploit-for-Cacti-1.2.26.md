## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** Cacti

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.2.27

**利用条件:** 需要具有“Import Templates”权限的已认证用户。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中存在的一个任意文件写入漏洞。具有“Import Templates”权限的已认证用户可以通过“Package Import”功能，上传包含恶意代码的XML包，由于`/lib/import.php` 中的 `import_package()` 函数未对文件名和文件内容进行充分验证，导致攻击者可以写入任意文件（包括PHP文件），从而实现远程代码执行。漏洞利用代码库 Safarchand/CVE-2024-25641 提供了PoC，表明该漏洞可被利用。

**有效性：** 该漏洞的有效性高，多个来源证实了该漏洞的存在以及可被利用。

**投毒风险：**
分析提供的漏洞利用代码 `/tmp/e2115b20ea29ebccb8a2515b468ae36e/README.md`，该文件仅包含漏洞描述信息，没有发现恶意代码，但并不代表此漏洞的其余PoC不存在风险。由于攻击者可能在XML文件中插入恶意PHP代码，因此在利用过程中存在一定风险（约为10%），需要对XML包的内容进行审查。

**利用方式：**
1.  攻击者需要拥有 Cacti 系统的账号，并且该账号需要具有 “Import Templates” 权限。
2.  攻击者构造一个恶意的 XML 包，该 XML 包中包含用于写入任意文件的配置信息以及恶意 PHP 代码。
3.  攻击者通过 Cacti 的 “Package Import” 功能上传该 XML 包。
4.  `import_package()` 函数会将 XML 包中的文件写入到服务器的任意位置（由于缺乏验证），写入恶意 PHP 代码。
5.  攻击者访问写入的 PHP 文件，触发恶意代码执行，从而控制服务器。

**项目地址:** [regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26](https://github.com/regantemudo/CVE-2024-25641-Exploit-for-Cacti-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)