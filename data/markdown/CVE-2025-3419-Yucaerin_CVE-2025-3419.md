## CVE-2025-3419 - WordPress Eventin 任意文件读取

**漏洞编号:** CVE-2025-3419

**漏洞类型:** 任意文件读取

**影响应用:** WordPress Eventin 插件

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 4.0.26

**利用条件:** 目标站点安装了Eventin插件，且版本小于等于4.0.26，无需身份验证即可访问wp-admin/admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3419是WordPress Eventin插件中存在的一个未经身份验证的任意文件读取漏洞。攻击者通过构造包含`file:///`协议的URL参数到`proxy_image` action，可以读取服务器上的任意文件，例如`/etc/passwd`，`wp-config.php`等敏感文件。

**有效性:**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞利用代码是有效的。POC代码通过发送精心构造的HTTP请求，利用 `proxy_image()` 函数中的漏洞，读取`/etc/passwd`文件，如果响应中包含`root:x:0:0:`则判断存在漏洞。同时，脚本还会检测服务器类型（Apache或Nginx），并将结果保存到不同的文件中。

**投毒风险:**
对提供的POC代码进行了分析，发现潜在的投毒风险较低，约为10%。主要风险点在于：
*   **依赖的外部文件:** 脚本依赖`list.txt`文件，如果该文件被恶意篡改，可能导致扫描错误的目标，但不会直接危害攻击者。
*   **异常处理:** 脚本包含异常处理，能捕获一些错误，但不能保证所有异常情况都能正确处理，可能导致程序崩溃或产生误报。
*  **扫描结果的存储:** 扫描结果会保存到本地文件。尽管提供了apache和nginx服务器类型的分类，但如果服务器header被伪造，结果可能会被误导。

总体而言，没有发现明显的恶意代码，例如反向shell或信息窃取等。但是，作为漏洞利用工具，任何人都可能利用它进行未授权的渗透测试，从而带来潜在的危害。因此，使用时需要谨慎。

**利用方式:**
1.  准备包含目标域名的`list.txt`文件，每个域名一行。
2.  运行POC脚本 `python3 CVE-2025-3419.py`。
3.  脚本会并发地对目标域名进行检测，发送包含恶意`url`参数的HTTP请求，尝试读取`/etc/passwd`文件。
4.  如果成功读取，则将目标域名添加到`result.txt`文件中，并根据服务器类型添加到`passwd_server_apache.txt`或`passwd_server_nginx.txt`中。
5.  查看结果文件，确认存在漏洞的目标。

**项目地址:** [Yucaerin/CVE-2025-3419](https://github.com/Yucaerin/CVE-2025-3419)

**漏洞详情:** [CVE-2025-3419](https://nvd.nist.gov/vuln/detail/CVE-2025-3419)