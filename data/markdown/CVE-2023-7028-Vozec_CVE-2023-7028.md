## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028是GitLab CE/EE中的一个漏洞，影响多个版本。该漏洞允许攻击者通过提供两个邮箱地址（一个是目标用户的邮箱，一个是攻击者控制的邮箱）来重置目标用户的密码。GitLab会将密码重置邮件同时发送到这两个邮箱。由于某些版本GitLab没有正确验证邮箱地址，攻击者可以利用这一点来接管目标用户的账户。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的POC代码，可以判断该漏洞利用代码的有效性较高。搜索引擎结果中多个链接都指出该漏洞是一个严重的安全问题，并且已经被公开利用。POC代码通过模拟密码重置流程，向目标用户和攻击者控制的邮箱发送密码重置请求，从而验证漏洞的存在。

**投毒风险分析：**
检查POC代码，发现其主要功能是利用1secmail.com提供的临时邮箱服务，构造包含目标用户邮箱和临时邮箱的密码重置请求。代码中存在一些小的潜在风险，例如对1secmail.com的依赖，如果该服务不可用，则POC无法正常工作。此外，代码中使用的正则表达式可能不够健壮，在某些情况下可能无法正确提取authenticity_token。考虑到这些依赖关系，投毒风险较低，大概为10%。

**利用方式：**
1.  攻击者需要知道目标用户的邮箱地址。
2.  攻击者构造一个包含目标用户邮箱和攻击者控制的邮箱的密码重置请求。
3.  攻击者发送密码重置请求到GitLab服务器。
4.  GitLab服务器将密码重置邮件同时发送到目标用户和攻击者控制的邮箱。
5.  攻击者从其控制的邮箱中获取密码重置链接，并重置目标用户的密码。
6.  攻击者使用新密码登录目标用户的账户，完成账户接管。

**项目地址:** [Vozec/CVE-2023-7028](https://github.com/Vozec/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)