## CVE-2021-42013-Apache HTTP Server-Path Traversal 和 Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal 和 Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和服务器被完全控制

**影响版本:** 2.4.49 和 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，并且存在Alias-like配置，CGI脚本开启，且目录权限配置不当（缺少 'require all denied'）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013是CVE-2021-41773的不完整修复，允许攻击者利用路径遍历漏洞读取Alias配置以外的文件，如果CGI脚本被启用，可能导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。提供的PoC代码包含Dockerfile用于搭建漏洞环境，以及Python脚本用于验证Path Traversal和Remote Code Execution，因此PoC代码有效。

**投毒风险：**
检查了提供的PoC代码，包括Dockerfile和Python脚本。Dockerfile用于搭建包含漏洞的Apache HTTP Server环境，其中包含了从Apache官网下载httpd-2.4.50.tar.gz的步骤，以及添加了httpd.conf配置文件的步骤，还包括了index.php和login.php页面的添加步骤，并未发现明显的恶意代码或后门。

Python脚本cve-2021-42013.py主要是利用requests库发送HTTP请求，进行Path Traversal和Remote Code Execution的验证。脚本本身没有发现包含恶意代码的行为。虽然理论上，可以修改此脚本来执行恶意操作，但在提供的代码中并没有发现这种行为。因此，投毒风险较低，大概在5%左右。

**利用方式：**
利用方式主要有两种：

1.  **Path Traversal（路径遍历）：** 攻击者通过构造包含“../”的恶意URL，绕过Alias配置的限制，读取服务器上的任意文件。前提是这些文件没有被 'require all denied' 保护。

2.  **Remote Code Execution（远程代码执行）：** 如果服务器启用了CGI，攻击者可以通过路径遍历漏洞访问到CGI脚本，并执行任意系统命令。通常需要先上传一个包含恶意代码的CGI脚本，然后通过路径遍历漏洞来执行它。提供的代码中，RCE的利用依赖于CGI的启用和适当的权限配置。

综上所述，此漏洞的利用，通常需要结合服务器的具体配置情况，如Alias配置、CGI是否启用、目录权限等。提供的PoC代码可以帮助验证漏洞的存在，但也需要根据实际情况进行调整。


**项目地址:** [bananoname/cve-2021-42013](https://github.com/bananoname/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)