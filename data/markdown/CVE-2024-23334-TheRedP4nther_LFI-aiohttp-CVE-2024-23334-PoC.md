## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器开启静态文件服务，且配置follow_symlinks=True

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-23334 存在于 aiohttp 3.9.2 之前的版本中。当 aiohttp 作为 Web 服务器使用时，如果静态路由配置不当，且 `follow_symlinks` 选项设置为 True，则可能导致目录遍历漏洞。攻击者可以通过构造包含 `../` 的恶意 URL，访问服务器上任意文件。 

**利用方式：**

1.  确定目标服务器使用的 aiohttp 版本小于 3.9.2，并且静态文件服务开启了 `follow_symlinks` 选项。
2.  构造包含目录遍历的 URL，例如 `http://target/static/../../../../etc/passwd`。
3.  发送请求到目标服务器，如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容。

**POC 分析：**

提供的 POC 是一个 Bash 脚本，它通过 curl 发送包含目录遍历的 HTTP 请求来利用该漏洞。该脚本允许指定要读取的文件路径。

**投毒风险：**

该 POC 代码存在较高的投毒风险，主要有以下几个原因：

1.  该脚本需要用户手动修改 `main_url` 和 `payload` 变量，如果用户不小心将 `main_url` 设置为恶意网站，可能会导致信息泄露。
2.  脚本中的 curl 命令可以直接执行，存在命令注入的风险,攻击者可以修改该脚本，添加恶意命令，在目标机器上执行。
3.  脚本本身可能会被恶意修改，例如添加后门或病毒。
4.  利用成功的前提依赖特定的服务器配置，如果盲目执行，可能导致非预期行为甚至破坏服务器。

**项目地址:** [TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC](https://github.com/TheRedP4nther/LFI-aiohttp-CVE-2024-23334-PoC)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)