## CVE-2018-10933 - libssh Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** Authentication Bypass

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程命令执行

**影响版本:** 0.7.6 and 0.8.4 (服务器端)

**利用条件:** 目标服务器运行受影响的libssh版本并且开放SSH端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933是libssh服务器端状态机中的一个身份验证绕过漏洞。在libssh 0.7.6和0.8.4之前的版本中，恶意客户端可以在未经身份验证的情况下创建通道，从而导致未经授权的访问。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开可用的PoC。
提供的PoC代码 (`test3.py`) 看起来有效，其利用方式如下：
1.  建立到目标服务器SSH端口的TCP连接。
2.  启动paramiko传输层。
3.  发送`SSH2_MSG_USERAUTH_SUCCESS`消息，欺骗服务器认为已经成功通过身份验证。
4.  打开一个新的会话通道。
5.  执行任意命令（由`--command`参数指定）。
6.  读取并打印命令输出。

**投毒风险：**
检查提供的PoC代码，没有发现任何明显的恶意代码或后门。该脚本的功能仅限于利用身份验证绕过漏洞执行命令。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标识别：** 扫描网络以查找运行易受攻击的libssh版本的服务器，通常是22端口。
2.  **连接建立：** 与目标服务器建立TCP连接。
3.  **认证绕过：** 向服务器发送伪造的`SSH2_MSG_USERAUTH_SUCCESS`消息，绕过正常的身份验证流程。
4.  **命令执行：** 创建一个会话并执行任意命令。
5.  **结果获取：** 获取命令执行的结果。

总体而言，该漏洞的利用非常简单，危害巨大，允许未经授权的攻击者完全控制受影响的系统。

**项目地址:** [kristyna-mlcakova/CVE-2018-10933](https://github.com/kristyna-mlcakova/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)