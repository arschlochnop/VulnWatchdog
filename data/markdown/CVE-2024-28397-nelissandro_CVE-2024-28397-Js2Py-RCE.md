## CVE-2024-28397-js2py-Sandbox-Escape-RCE

**漏洞编号:** CVE-2024-28397

**漏洞类型:** 代码注入/沙箱逃逸

**影响应用:** js2py

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.74

**利用条件:** 需要能够执行 JavaScript 代码的环境，并使用了存在漏洞版本的js2py

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28397 是 js2py (<=0.74) 中的一个沙箱逃逸漏洞，js2py 是一个流行的 Python 包，可以在 Python 解释器中评估 JavaScript 代码。该漏洞位于 `js2py.disable_pyimport()` 组件中，攻击者可以通过精心设计的 API 调用执行任意代码。利用方式是，攻击者构造特殊的JavaScript代码，通过js2py执行，该JavaScript代码能够绕过js2py的沙箱限制，获得对底层Python对象的访问权限，从而执行任意Python代码，最终实现远程代码执行。

根据提供的漏洞信息，搜索引擎结果，以及漏洞利用代码，可以得出以下结论：

1. **有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞已经确认存在，并且有POC代码可用 (参见 Marven11/CVE-2024-28397-js2py-Sandbox-Escape)。因此，利用是有效的。

2. **投毒风险：** 提供的漏洞利用代码只有README.md文件，无法直接分析是否存在投毒代码，但是通过分析github项目：Marven11/CVE-2024-28397-js2py-Sandbox-Escape, 作者的提交记录是公开的, 因此投毒的可能性较低. 考虑到github项目仍然存在被篡改的风险, 给出10%的投毒风险。当然如果实际利用过程中，需要下载并运行其他脚本，则需要仔细检查是否存在恶意代码。

3. **利用方式：** 攻击者利用`js2py.disable_pyimport()` 的缺陷，构造恶意的 JavaScript 代码，该代码能够获取对底层 Python 对象的引用，从而绕过沙箱。 之后，攻击者可以利用获得的 Python 对象执行任意 Python 代码，达到远程代码执行的目的。

需要注意的是，成功利用该漏洞需要满足一定的条件，例如：目标系统上安装了存在漏洞版本的 js2py，并且攻击者能够向 js2py 传递恶意 JavaScript 代码。

**项目地址:** [nelissandro/CVE-2024-28397-Js2Py-RCE](https://github.com/nelissandro/CVE-2024-28397-Js2Py-RCE)

**漏洞详情:** [CVE-2024-28397](https://nvd.nist.gov/vuln/detail/CVE-2024-28397)