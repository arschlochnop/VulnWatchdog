## CVE-2025-30208-Vite-文件读取漏洞

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite 开发服务器需要通过 `--host` 或 `server.host` 暴露到网络

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208 是 Vite 框架中的一个文件读取漏洞。该漏洞源于 Vite 在处理 `server.fs.deny` 配置时，未正确过滤包含 `?raw??` 或 `?import&raw??` 的 URL 请求，导致攻击者可以绕过文件访问限制，读取服务器上的任意文件。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。漏洞利用代码通过构造包含 `?import&raw?&`的特殊 URL，尝试读取 `/etc/passwd` (Linux) 和 `C:\windows\win.ini` (Windows) 文件。如果目标服务器存在漏洞且满足利用条件（Vite 开发服务器暴露到网络），则可以成功读取文件内容。

**投毒风险分析：**

分析提供的漏洞利用代码，未发现明显的投毒代码。代码的主要功能是发送 HTTP 请求并检查响应内容，以验证漏洞是否存在。该漏洞利用代码只包含PoC验证代码，并没有发现任何后门或者恶意代码行为，因此投毒风险较低，可以认为投毒风险为 0%。

**利用方式：**

1.  **漏洞定位：** 确定目标系统上运行的 Vite 版本是否在受影响的范围内。
2.  **环境准备：** 确认 Vite 开发服务器是否已通过 `--host` 或 `server.host` 暴露到网络。
3.  **构造恶意 URL：** 构造包含 `?import&raw?&` 的 URL，例如：`http://example.com/@fs/etc/passwd?import&raw?&` 或 `http://example.com/@fs/C://windows/win.ini?import&raw?&`。
4.  **发送请求：** 使用 HTTP 客户端（如 curl、wget 或浏览器）发送构造的 URL 请求。
5.  **验证漏洞：** 检查响应内容。如果成功读取到 `/etc/passwd` 或 `C:\windows\win.ini` 的内容，则说明目标系统存在漏洞。

**修复建议：**

将 Vite 升级到安全版本（>= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3）。


**项目地址:** [xaitx/CVE-2025-30208](https://github.com/xaitx/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)