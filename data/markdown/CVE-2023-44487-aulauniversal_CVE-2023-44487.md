## CVE-2023-44487 HTTP/2 Rapid Reset 拒绝服务攻击

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议实现

**危害等级:** 高危，可能导致服务器资源耗尽和拒绝服务

**影响版本:** 受影响的HTTP/2协议实现版本

**利用条件:** 目标服务器必须支持HTTP/2协议

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-44487，又称“Rapid Reset”攻击，是HTTP/2协议中的一个拒绝服务漏洞。攻击者通过快速建立和重置大量HTTP/2流，消耗服务器资源，最终导致服务器崩溃或无法响应正常请求。

**有效性：**

提供的漏洞利用代码（Rapid Reset Client）通过创建大量HTTP/2流并立即重置它们来模拟此攻击。代码中包含一个 README.md 文件，描述了该工具的使用方法以及如何测试服务器对此漏洞的缓解措施。同时，提供了 Windows 下编译好的 `cve.bat` 脚本和跨平台 Python 执行脚本 `cve_python.bat`，使用户可以方便地进行漏洞验证。

根据搜索引擎结果，此漏洞在2023年8月至10月期间已被广泛利用，导致了大规模的DDoS攻击事件。因此，提供的POC代码**有效**。

**投毒风险：**

查看提供的文件列表，主要包含以下文件：

*   `README.md`: 包含漏洞描述、利用方法和缓解措施等信息，未发现可疑代码。
*   `cve.bat`: Windows 批处理脚本，用于执行 `rapidresetclient.exe` 并接收用户输入参数。可能存在投毒风险的地方在于批处理脚本执行额外的恶意命令，但经过分析，该脚本主要功能是设置参数并执行 `rapidresetclient.exe`，没有发现恶意代码。
*   `cve_python.bat`: 用于在其他系统上通过 Python 执行的脚本，主要用于启动rapidresetclient工具，未发现恶意代码。

根据代码分析，该仓库中存在作者隐藏的投毒代码的可能性较低，大约为 **5%**。 主要风险可能存在于用户下载了非官方来源的修改版代码，其中可能包含恶意Payload。

**利用方式：**

1.  攻击者与目标服务器建立HTTP/2连接。
2.  攻击者通过该连接快速创建大量的HTTP/2流。
3.  对于每个新建的流，攻击者立即发送RST_STREAM帧来重置该流，而无需完成请求。
4.  通过高速率地重复步骤2和3，攻击者可以耗尽服务器的资源，例如CPU、内存和连接数，从而导致拒绝服务。
5.  攻击可以通过单个TCP连接进行，也可以通过多个连接同时发起，以进一步增加攻击的强度。

**缓解措施：**

正如README文件中提到的，一种快速缓解方案是临时禁用Apache服务器中的HTTP/2模块。更全面的解决方案涉及限制每个连接允许的最大流数量，并实施速率限制机制，以防止攻击者快速创建大量流。许多厂商已经发布了针对此漏洞的补丁。


**项目地址:** [aulauniversal/CVE-2023-44487](https://github.com/aulauniversal/CVE-2023-44487)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)