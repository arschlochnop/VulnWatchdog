## CVE-2023-35078-Ivanti EPMM-身份验证绕过

**漏洞编号:** CVE-2023-35078

**漏洞类型:** 身份验证绕过

**影响应用:** Ivanti Endpoint Manager Mobile (EPMM)

**危害等级:** 高危，可能导致未经授权的API访问，潜在的数据泄露和控制

**影响版本:** 受影响版本包括11.10.0.1（低于11.10.0.2），11.9.1.0（低于11.9.1.1），11.8.1.0（低于11.8.1.1）以及所有小于等于11.8.1.0的版本。

**利用条件:** 需要网络访问Ivanti EPMM服务器，且服务器运行在受影响的版本上。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-35078是Ivanti Endpoint Manager Mobile (EPMM)中的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过发送特制的请求到`/mifs/aad/api/v2/ping`端点，绕过身份验证并访问受限制的API功能。根据Rapid7的博客文章，这是一个严重的安全漏洞，攻击者可以利用它来访问API路径，从而获得未经授权的访问权限。CISA将其列入已知被利用漏洞目录(KEV)。

提供的POC代码通过向目标EPMM服务器的`/mifs/aad/api/v2/ping`端点发送GET请求来验证漏洞的存在。 如果服务器返回HTTP 200状态码并且响应包含`vspVersion`，则表明目标服务器可能存在漏洞。 该脚本旨在检测漏洞，而不是进行利用。

**有效性：** 该POC代码有效，因为它能够检测目标系统是否容易受到CVE-2023-35078攻击。通过检查`/ping`端点的响应，该脚本可以确定系统是否在未授权的情况下暴露了版本信息，从而确认漏洞的存在。 

**投毒风险：** 通过检查给定的python脚本，此脚本的功能是发送一个GET请求到目标服务器的特定URL，并检查响应状态码和内容。脚本没有发现任何恶意代码或后门。该脚本只是一个简单的漏洞检测工具，其目的仅仅是验证目标服务器是否存在CVE-2023-35078漏洞。

**利用方式：**
1.  **发送请求：** 攻击者发送一个GET请求到受影响的Ivanti EPMM服务器上的`/mifs/aad/api/v2/ping`端点。
2.  **绕过认证：** 由于身份验证绕过漏洞，此请求不需要任何身份验证凭据。
3.  **访问API：** 成功绕过身份验证后，攻击者可以访问其他受限制的API端点，从而可能执行未经授权的操作或访问敏感数据。具体取决于攻击者进一步利用哪些API端点。根据CISA的公告，此漏洞已被实际利用。

**项目地址:** [synfinner/CVE-2023-35078](https://github.com/synfinner/CVE-2023-35078)

**漏洞详情:** [CVE-2023-35078](https://nvd.nist.gov/vuln/detail/CVE-2023-35078)