## CVE-2017-5487-WordPress-REST API 用户枚举

**漏洞编号:** CVE-2017-5487

**漏洞类型:** 信息泄露

**影响应用:** WordPress

**危害等级:** 低危，泄露用户名信息

**影响版本:** 4.7之前

**利用条件:** 目标WordPress站点开启了REST API，且版本低于4.7.1

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-5487 存在于 WordPress 4.7 版本之前的 REST API 实现中。该漏洞允许未经授权的远程攻击者通过访问 `wp-json/wp/v2/users` 端点获取网站用户的用户名等敏感信息。该漏洞的利用方式非常简单，只需向目标网站的 REST API 端点发送一个 GET 请求即可。

**有效性：**
根据漏洞信息和搜索结果，该漏洞确实存在于WordPress 4.7之前的版本中。POC代码通过请求 `/wp-json/wp/v2/users/` 接口，来获取用户信息。如果目标站点存在漏洞，POC代码应该能够成功枚举出用户名。

**投毒风险：**
代码中存在一些潜在的风险，但判定为恶意投毒的可能性较低。主要风险点在于：

*   `urllib3.disable_warnings(InsecureRequestWarning)`：禁用HTTPS证书验证警告，可能导致中间人攻击风险。
*   `verify=False, allow_redirects=False`：在requests请求中禁用SSL验证和禁止自动重定向，进一步增加了中间人攻击风险。
*   Thread数量为55,可能会造成DDOS的行为.

代码本身的主要功能是枚举用户名，如果目标站点修复了漏洞，则无法成功利用。但由于代码中包含上述安全风险，从安全角度来说，在使用前应该进行仔细审查。

综合考虑，代码存在一些潜在的安全风险，但恶意投毒的可能性较低，推测占比为5%。

**利用方式：**
1.  确定目标WordPress站点版本低于4.7.1。
2.  运行提供的Python脚本，脚本会尝试通过 REST API 端点 `/wp-json/wp/v2/users/` 获取用户名信息。
3.  如果站点存在漏洞，脚本将输出枚举到的用户名。

修复方案：
升级WordPress到4.7.1或更高版本。

**项目地址:** [K3ysTr0K3R/CVE-2017-5487-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-5487-EXPLOIT)

**漏洞详情:** [CVE-2017-5487](https://nvd.nist.gov/vuln/detail/CVE-2017-5487)