## CVE-2023-21839 Oracle WebLogic Server 远程信息泄露漏洞

**漏洞编号:** CVE-2023-21839

**漏洞类型:** 信息泄露

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致未经授权访问关键数据

**影响版本:** 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问目标WebLogic服务器的T3或IIOP端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-21839 是 Oracle WebLogic Server 中 Core 组件的一个漏洞。攻击者可以通过 T3 或 IIOP 协议进行网络访问，未经身份验证即可利用此漏洞。成功利用此漏洞可能导致未经授权访问关键数据或完全访问所有 Oracle WebLogic Server 可访问数据。

**有效性:**
提供的POC代码 `CVE-2023-21839.py` 旨在利用该漏洞。它首先尝试确定 WebLogic Server 的版本，然后构造特定的请求来利用未授权访问漏洞。代码逻辑包含了基于 WebLogic 版本(12 或 14)生成不同payload的逻辑，并且利用LDAP服务，表明poc利用了JNDI注入。

**投毒风险:**
代码中存在一定的投毒风险，为5%。虽然代码主要是为了利用漏洞，但攻击者可以通过修改 `self.ldap` 变量来控制 LDAP 服务器的地址。如果攻击者控制了 LDAP 服务器，则可能引导受害者连接到恶意的 LDAP 服务器，从而执行任意代码或泄露敏感信息。例如,通过恶意的LDAP服务器返回一个恶意的序列化对象，利用Weblogic的JNDI注入漏洞，达到RCE。

**利用方式:**
1.  **版本探测:** POC首先尝试确定目标WebLogic服务器的版本(12或14)。
2.  **构造恶意请求:**  根据探测到的版本，构造包含恶意JNDI引用的特定T3协议请求。
3.  **JNDI注入:** 通过T3协议发送恶意请求，触发WebLogic服务器尝试通过JNDI查找LDAP服务。
4.  **LDAP重定向(潜在风险):** 如果`self.ldap`被设置为攻击者控制的LDAP服务器，该服务器可以返回一个恶意的序列化对象，当WebLogic服务器尝试反序列化该对象时，会导致任意代码执行。
5.  **信息泄露:** 即使LDAP服务器不是恶意的，成功利用该漏洞也可能导致未经授权的信息泄露。

**项目地址:** [houqe/POC_CVE-2023-21839](https://github.com/houqe/POC_CVE-2023-21839)

**漏洞详情:** [CVE-2023-21839](https://nvd.nist.gov/vuln/detail/CVE-2023-21839)