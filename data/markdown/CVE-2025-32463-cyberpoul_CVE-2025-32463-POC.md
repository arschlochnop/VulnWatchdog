## CVE-2025-32463-Sudo本地提权漏洞

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取Root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，以及sudo -R命令的执行权限。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32463 是一个本地提权漏洞，影响 Sudo 1.9.14 到 1.9.17p1 版本。该漏洞允许本地用户通过 `--chroot` 选项，利用用户可控目录中的恶意 `nsswitch.conf` 文件，加载恶意的 NSS 库，从而以 root 权限执行任意代码。具体利用方式如下：

1.  **漏洞原理:** Sudo 在使用 `--chroot` 选项时，会切换到指定目录作为根目录。如果用户可以控制这个目录，就可以在其中放置一个特制的 `nsswitch.conf` 文件。当 Sudo 尝试解析 `nsswitch.conf` 文件时，它可能会加载由用户提供的 NSS 库，并执行其中的代码。
2.  **PoC 利用步骤:**
    *   创建一个临时目录作为 chroot 环境。
    *   在该目录下，创建必要的目录结构 `root/etc` 和 `root/libnss_`。
    *   创建一个恶意的 `nsswitch.conf` 文件，指向攻击者构造的 NSS 库。
    *   创建一个 C 文件 `pwn.c`，包含一个构造函数 `pwn()`，该函数会设置进程的 uid 和 gid 为 0 (root)，并执行 `/bin/bash`。
    *   使用 gcc 将 `pwn.c` 编译成一个共享库 `root/libnss_/pwn.so.2`。
    *   使用 `sudo -R root pwn` 命令，Sudo 会 chroot 到 `root` 目录，并执行 `pwn` (实际上不存在，触发 nsswitch 查询)。由于 `nsswitch.conf` 的配置，Sudo 会加载 `pwn.so.2` 库，从而执行 `pwn()` 函数，获得 root 权限。

**投毒风险分析：**

代码中检查是否存在gcc和sudo，但并未使用任何网络功能或下载行为。pwn.c中的代码功能明确，是执行提权操作。LICENSE文件和README.md文件内容正常。基于代码分析，投毒的概率极低,主要代码逻辑是为了利用漏洞进行提权，虽然存在安全风险，但并非作者故意植入的恶意后门。

**有效性分析：**
根据漏洞信息，搜索结果和漏洞利用代码，此POC代码的有效性很高。该代码针对特定版本的Sudo，利用其chroot选项的缺陷进行提权，如果目标系统满足漏洞存在的条件，该PoC很可能成功利用该漏洞。

**项目地址:** [cyberpoul/CVE-2025-32463-POC](https://github.com/cyberpoul/CVE-2025-32463-POC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)