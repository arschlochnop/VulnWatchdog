## CVE-2019-5736-runc容器逃逸

**漏洞编号:** CVE-2019-5736

**漏洞类型:** 容器逃逸

**影响应用:** runc/Docker

**危害等级:** 高危，可获取主机Root权限

**影响版本:** <= 1.0-rc6 (runc), Docker < 18.09.2

**利用条件:** 需要能够在容器内以root权限执行命令，可以是新建的恶意镜像容器，或者已有写入权限的容器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-5736 漏洞允许攻击者通过恶意构造的容器镜像或已获得写入权限的容器，覆盖宿主机的 runc 二进制文件，从而在后续容器启动或执行 docker exec 时获得宿主机的 root 权限。

**利用方式：**

1.  **准备阶段：** 攻击者需要能够控制一个容器的环境。这可以通过创建一个包含恶意代码的新容器镜像或者攻击一个已存在的容器，并获得该容器的写入权限来实现。
2.  **覆盖runc:** 在容器内，攻击者利用文件描述符处理不当的漏洞，将恶意代码写入到宿主机上的 `/proc/self/exe` 所指向的 runc 二进制文件。
3.  **触发执行：** 下一次启动容器或执行 `docker exec` 命令时，宿主机将执行被覆盖的恶意 runc 二进制文件，从而允许攻击者在宿主机上以 root 权限执行任意命令。

**关于投毒风险的分析：**

提供的Dockerfile 基于 `https://github.com/Frichetten/CVE-2019-5736-PoC.git` 构建。主要的风险点在于该git仓库中的 `main.go` 文件。虽然POC本身旨在演示漏洞利用，但作者有可能在其中添加恶意代码，例如植入后门。代码需要进一步分析，目前初步判断存在较小风险，因为该POC已经被广泛使用，如果存在明显恶意行为，应该会被发现。但是，仍存在隐藏的、不明显的恶意代码的可能，所以判断存在5%的投毒风险。

**项目地址:** [panzouh/Docker-Runc-Exploit](https://github.com/panzouh/Docker-Runc-Exploit)

**漏洞详情:** [CVE-2019-5736](https://nvd.nist.gov/vuln/detail/CVE-2019-5736)