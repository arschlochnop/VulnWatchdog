## CVE-2025-2266 Checkout Mestres do WP for WooCommerce Unauthenticated Arbitrary Options Update

**漏洞编号:** CVE-2025-2266

**漏洞类型:** 权限提升/配置修改

**影响应用:** Checkout Mestres do WP for WooCommerce

**危害等级:** 高危，可能导致未授权访问和权限提升

**影响版本:** 8.6.5 - 8.7.5

**利用条件:** 目标网站安装并启用了受影响版本的Checkout Mestres do WP for WooCommerce插件，且未进行修复

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-2266 漏洞存在于 Checkout Mestres do WP for WooCommerce 插件的 `cwmpUpdateOptions()` 函数中，该函数缺少权限验证。未经身份验证的攻击者可以通过构造恶意请求，修改 WordPress 的配置选项，例如启用用户注册，并将默认角色设置为管理员，从而注册一个管理员账户并获得网站的完全控制权。

**有效性评估：**

漏洞库信息、搜索引擎结果和提供的漏洞利用代码均表明该漏洞存在且危害严重。漏洞利用代码通过未经身份验证的 POST 请求，直接调用 `cwmpUpdateOptions` 函数来修改配置，利用方式清晰，有效性高。

**投毒风险分析：**

检查提供的漏洞利用代码 `CVE-2025-2266.py`，代码主要功能是：

1.  检查目标是否安装受影响的插件版本（通过读取 `readme.txt`）。
2.  通过 `cwmpUpdateOptions` action 修改 WordPress 配置，启用用户注册并将默认角色设置为 administrator。
3.  注册一个新的用户。

该脚本没有明显的恶意代码，如反弹shell，安装后门等，但存在一些潜在的风险：

*   依赖外部库 `requests`。虽然 `requests` 库本身很常用，但如果安装了被篡改的 `requests` 库，可能会引入恶意代码。
*   脚本中的 User-Agent 可以被追踪。

考虑到代码的简单性和主要功能与漏洞描述一致，投毒风险较低，约为5%。

**利用方式：**

1.  **确定目标：** 找到安装了 Checkout Mestres do WP for WooCommerce 插件的 WordPress 网站。
2.  **验证版本：**  通过访问 `/wp-content/plugins/checkout-mestres-wp/readme.txt` 确认插件版本在 8.6.5 到 8.7.5 之间。
3.  **执行漏洞：** 运行提供的 Python 脚本，指定目标网站的 URL。
4.  **注册用户：** 如果漏洞利用成功，脚本将启用用户注册并将默认角色设置为管理员。之后，脚本会自动尝试注册一个新用户，或者你需要手动注册。
5.  **登录后台：** 使用新注册的管理员账户登录 WordPress 后台。

总而言之，此漏洞风险极高，利用简单，应尽快修复。

**项目地址:** [Nxploited/CVE-2025-2266](https://github.com/Nxploited/CVE-2025-2266)

**漏洞详情:** [CVE-2025-2266](https://nvd.nist.gov/vuln/detail/CVE-2025-2266)