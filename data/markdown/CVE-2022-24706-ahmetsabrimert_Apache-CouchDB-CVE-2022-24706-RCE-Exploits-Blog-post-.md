## CVE-2022-24706-Apache CouchDB远程代码执行

**漏洞编号:** CVE-2022-24706

**漏洞类型:** 远程代码执行

**影响应用:** Apache CouchDB

**危害等级:** 高危，未经授权的远程代码执行和权限提升

**影响版本:** <= 3.2.1

**利用条件:** CouchDB安装未安全配置，默认Erlang cookie未更改，且端口对外开放

**POC 可用性:** 部分可用

**投毒风险:** 10%

## 详情

CVE-2022-24706 漏洞存在于 Apache CouchDB 3.2.1 及更早版本中。由于 CouchDB 默认安装不安全，攻击者可以在未经身份验证的情况下访问并获得管理员权限，最终实现远程代码执行。漏洞主要原因是默认 Erlang cookie 的使用，以及 CouchDB 分布式端口的开放。 

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的，并且存在公开的漏洞利用代码。搜索结果中提到了利用该漏洞安装 Kinsing 恶意软件的案例，证明该漏洞已被积极利用。

**投毒风险：**
提供的 POC 代码 `/tmp/94600f7fc08951a87ec54c0b06e31f4b/README.md` 只是一个 README 文件，内容简单，仅包含博客文章的描述，不包含任何可执行代码或恶意操作。因此，直接的投毒风险较低。但是，仍然存在风险，因为 README 文件可能引导用户下载其他包含恶意代码的资源，或者提供错误的利用方法导致系统不稳定，所以判断投毒风险为10%。

**利用方式：**
1.  **身份验证绕过：** 利用默认的 Erlang cookie 绕过身份验证，获取 CouchDB 管理员权限。
2.  **远程代码执行：**  获得管理员权限后，攻击者可以执行任意命令，实现远程代码执行。
3.  **恶意软件安装：**  攻击者可以利用 RCE 安装恶意软件，如 Kinsing。

**防范措施：**
*   升级到 CouchDB 3.2.2 或更高版本。
*   更改默认的 Erlang cookie。
*   使用防火墙限制对 CouchDB 端口的访问。
*   确保 CouchDB 安装的安全配置。

**项目地址:** [ahmetsabrimert/Apache-CouchDB-CVE-2022-24706-RCE-Exploits-Blog-post-](https://github.com/ahmetsabrimert/Apache-CouchDB-CVE-2022-24706-RCE-Exploits-Blog-post-)

**漏洞详情:** [CVE-2022-24706](https://nvd.nist.gov/vuln/detail/CVE-2022-24706)