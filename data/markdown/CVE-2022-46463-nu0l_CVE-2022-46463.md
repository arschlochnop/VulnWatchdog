## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-46463 允许未经身份验证的攻击者访问 Harbor 实例中的公共和私有镜像仓库。根据漏洞描述和提供的搜索引擎结果，该漏洞的利用方式是利用 Harbor 的访问控制缺陷，直接访问 API 接口获取镜像仓库列表和镜像信息。提供的 POC 代码 `cve-2022-46463.py` 脚本首先通过 `/api/v2.0/search?q=/` 接口获取所有镜像仓库列表，然后针对每个仓库，通过 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 接口获取该仓库下的镜像 artifacts 信息，最后构造 `docker pull` 命令。从代码分析来看，没有发现任何投毒行为。 脚本本身只实现了漏洞验证的功能，即未经授权获取 Harbor 实例中的仓库和镜像信息。

**利用方式总结：**

1.  **利用API：** 利用未授权的API接口，主要是 `/api/v2.0/search?q=/` 和 `/api/v2.0/projects/{project}/repositories/{name}/artifacts` 。
2.  **获取仓库列表：**  首先通过搜索API获取所有仓库列表。
3.  **获取镜像信息：**  针对每个仓库，获取该仓库下所有镜像的 digest。
4.  **构造命令：** 构造 `docker pull` 命令，下载镜像。

**投毒风险评估：**

提供的python脚本的功能主要是枚举镜像仓库和构造 docker pull 命令，没有发现任何可疑的或恶意的行为，因此投毒风险为0%。作者除了github之外的来源为微信公众号，考虑到语言环境，投毒风险进一步降低。

**项目地址:** [nu0l/CVE-2022-46463](https://github.com/nu0l/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)