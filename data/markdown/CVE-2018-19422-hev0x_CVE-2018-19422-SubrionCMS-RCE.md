## CVE-2018-19422-SubrionCMS-RCE

**漏洞编号:** CVE-2018-19422

**漏洞类型:** 远程代码执行

**影响应用:** Subrion CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.2.1

**利用条件:** 需要Subrion CMS 4.2.1版本，以及有效的管理员账号密码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-19422 漏洞存在于 Subrion CMS 4.2.1 的 /panel/uploads 目录。由于 .htaccess 文件没有阻止对 .pht 和 .phar 文件的执行，远程攻击者可以通过上传包含恶意 PHP 代码的 .pht 或 .phar 文件来执行任意 PHP 代码。

**有效性：**
提供的 POC 代码 `SubrionRCE.py` 旨在利用此漏洞。它首先尝试登录到 Subrion CMS 的后台管理面板，获取 CSRF token，然后使用提供的用户名和密码进行身份验证。如果登录成功，脚本会生成一个随机名称的webshell，并尝试通过文件上传功能上传该webshell，webshell的后缀名为.pht或.phar，因为目标系统的.htaccess配置不阻止此类型的文件执行。如果上传成功，攻击者可以通过访问 webshell 的 URL 来执行任意 PHP 代码。 根据漏洞描述和 exploit-db 上的信息，此PoC的有效性高.

**投毒风险：**
检查了提供的 POC 代码 `SubrionRCE.py`。 该代码主要实现了漏洞利用逻辑，包括登录、上传webshell和执行命令等步骤。  代码中没有发现明显的恶意或隐藏功能，例如未经授权的数据收集、传播恶意软件或修改系统设置等。
 因此，此仓库中作者隐藏的投毒代码的可能性为0%。POC 仅包含用于验证和利用漏洞的代码，不包含其他恶意功能。

**利用方式：**
1.  **身份验证：** 使用提供的用户名和密码登录 Subrion CMS 的后台管理面板。
2.  **上传 Webshell：** 上传一个包含恶意 PHP 代码的 .pht 或 .phar 文件到 /panel/uploads 目录。
3.  **远程代码执行：** 通过访问上传的 webshell 的 URL 来执行任意 PHP 代码。

漏洞利用的关键是 Subrion CMS 4.2.1 版本的 .htaccess 配置不阻止对 .pht 和 .phar 文件的执行，这允许攻击者上传并执行包含恶意 PHP 代码的文件。

**项目地址:** [hev0x/CVE-2018-19422-SubrionCMS-RCE](https://github.com/hev0x/CVE-2018-19422-SubrionCMS-RCE)

**漏洞详情:** [CVE-2018-19422](https://nvd.nist.gov/vuln/detail/CVE-2018-19422)