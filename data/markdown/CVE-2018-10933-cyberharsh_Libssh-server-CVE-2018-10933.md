## CVE-2018-10933-libssh-认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程命令执行

**影响版本:** 0.6 - 0.7.5, 0.8.0 - 0.8.3

**利用条件:** 目标服务器运行存在漏洞的libssh服务端，且监听SSH端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-10933是libssh库中的一个认证绕过漏洞，存在于0.6到0.7.5版本以及0.8.0到0.8.3版本中。攻击者可以在未经身份验证的情况下，通过向服务器发送`SSH2_MSG_USERAUTH_SUCCESS`消息来绕过身份验证过程，从而建立未授权的SSH会话并执行任意命令。

**有效性：**
提供的POC代码利用了此漏洞，通过直接发送`MSG_USERAUTH_SUCCESS`消息来绕过认证。根据漏洞描述和搜索结果，该POC代码应能成功绕过身份验证，从而在目标服务器上执行任意命令。Dockerfile中`FROM vulhub/libssh:0.8.1`指明了存在漏洞的版本，验证了poc有效性。

**投毒风险：**
*   Dockerfile：将flagA文件添加到/etc/目录，这并非恶意行为，而是为漏洞演示提供一个可以读取的文件目标。
*   README.md和README.zh-cn.md：仅包含漏洞描述、环境搭建和POC代码说明，无恶意代码。
*   docker-compose.yml：用于启动漏洞环境，无恶意代码。
*   POC代码（Python）：该脚本直接利用漏洞绕过身份验证并执行命令，目的是为了验证漏洞的存在，但如果攻击者使用该脚本攻击其他服务器，则属于恶意行为。
*   flagA：包含字符串 `logicalvulnerability`，这不是一个恶意代码，而是一个供演示的flag。

综合来看，该仓库本身主要目的是为了演示CVE-2018-10933漏洞，从代码来看，投毒风险较低。但如果使用者利用该POC脚本进行非法入侵，则使用者本身的行为具有恶意性，因此仓库本身存在被恶意利用的风险。

**利用方式：**
1.  攻击者首先需要确定目标服务器上运行着存在漏洞的libssh版本（0.6 - 0.7.5, 0.8.0 - 0.8.3）。
2.  攻击者与目标服务器建立TCP连接，发起SSH握手。
3.  攻击者跳过正常的身份验证步骤，直接发送`SSH2_MSG_USERAUTH_SUCCESS`消息。
4.  如果服务器存在漏洞，则会错误地认为客户端已通过身份验证，允许攻击者建立SSH会话。
5.  攻击者可以使用此会话执行任意命令，从而控制目标系统。

**项目地址:** [cyberharsh/Libssh-server-CVE-2018-10933](https://github.com/cyberharsh/Libssh-server-CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)