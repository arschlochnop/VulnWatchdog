## CVE-2025-29927-Next.js-中间件绕过

**漏洞编号:** CVE-2025-29972

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息，例如用户数据、管理页面等。

**影响版本:** 受影响的版本包括早于 14.2.25 和 15.2.3 的 Next.js 版本

**利用条件:** 目标应用程序需要使用 Next.js 中间件来执行授权检查。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索引擎结果（例如 jfrog.com, socprime.com, strobes.co, picussecurity.com, sec.okta.com 等）显示，CVE-2025-29927 是 Next.js 中间件中存在的一个授权绕过漏洞。攻击者可以通过构造包含 `x-middleware-subrequest` 头的请求来绕过中间件的安全检查，从而访问受保护的资源。提供的漏洞利用代码 `exploit.py` 似乎旨在利用此漏洞。它通过发送带有特定header（`x-middleware-subrequest`）的 HTTP 请求来尝试绕过授权。代码包含基本的请求发送功能和结果保存功能。代码中存在错误处理机制，对主机名解析失败、连接超时和连接被拒绝等情况进行了处理。同时，代码的 `README.md` 文件也描述了漏洞的细节和利用方法。

**有效性评估：**

根据漏洞描述和提供的利用代码，该漏洞利用的有效性较高，如果目标应用使用了受影响版本的Next.js，并采用了中间件进行权限控制，那么大概率可以成功利用。

**投毒风险评估：**

代码本身主要功能是发送HTTP请求，并没有发现明显的恶意代码或后门。虽然使用了第三方库`colorama`，但该库主要用于美化输出，风险较低。但是，由于是第三方提供的代码，仍然存在一定的风险，例如作者可能在代码中插入隐蔽的恶意逻辑。代码库中引用的git仓库地址声称是CVE-2025-29972，这与实际漏洞CVE-2025-29927不符，可能存在混淆行为。所以投毒风险评估为10%。建议在使用前仔细审查代码。

**利用方式：**

1.  **漏洞定位：** 确认目标 Next.js 应用程序使用的版本低于 14.2.25 或 15.2.3，并且使用了中间件进行权限控制。
2.  **请求构造：** 使用 `exploit.py` 脚本或手动构造包含 `x-middleware-subrequest` 头的 HTTP 请求。
3.  **绕过测试：** 将构造的请求发送到受保护的资源，观察是否成功绕过授权检查。
4.  **结果验证：** 检查响应状态码和内容，确认是否成功访问了未授权的资源。
5.  **修复建议：** 升级 Next.js 版本到 14.2.25 或 15.2.3 或更高版本。

**项目地址:** [ThemeHackers/CVE-2025-29972](https://github.com/ThemeHackers/CVE-2025-29972)

**漏洞详情:** [CVE-2025-29972](https://nvd.nist.gov/vuln/detail/CVE-2025-29972)