## CVE-2022-1388-F5 BIG-IP iControl REST Authentication Bypass RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过、远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 严重，未经身份验证的攻击者可以执行任意命令

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (<= 12.1.6), 11.6.x (<= 11.6.5)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以通过网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-1388是F5 BIG-IP iControl REST API中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行任意命令。 

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。漏洞库信息显示该漏洞的CVSS评分为9.8（严重），并且已被CISA列入已知被利用的漏洞目录。搜索结果也表明该漏洞已被广泛利用。提供的POC代码能够成功绕过身份验证并执行任意命令，例如`id`和`cat /etc/passwd`。

**投毒风险：**

从提供的POC代码来看，投毒风险较低。该POC的主要功能是利用漏洞绕过身份验证并执行命令。代码中没有发现明显的恶意或隐藏的功能。`Authorization: Basic YWRtaW46` 只是尝试使用默认的管理员凭据，并非恶意行为。尽管如此，依然存在极低的投毒风险，因为攻击者可以修改POC代码以包含恶意功能，例如上传后门或删除文件。但是，由于其功能相对简单且目标明确，因此可能性很小，投毒风险占比1%。

**利用方式：**

1.  攻击者向目标系统的iControl REST API端点（`/mgmt/tm/util/bash`）发送POST请求。
2.  请求头包含`X-F5-Auth-Token: anything`和`Authorization: Basic YWRtaW46`，这些头用于绕过身份验证。
3.  请求体包含一个JSON对象，其中指定要执行的命令，例如`{"command": "run", "utilCmdArgs": "-c id"}`。
4.  目标系统执行该命令并将结果返回给攻击者。
5.  通过修改`utilCmdArgs`参数，攻击者可以执行任意命令，从而完全控制受影响的系统。

**项目地址:** [amitlttwo/CVE-2022-1388](https://github.com/amitlttwo/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)