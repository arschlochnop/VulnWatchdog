## CVE-2022-21449 - Java ECDSA Psychic Signatures

**漏洞编号:** CVE-2022-21449

**漏洞类型:** 身份验证绕过

**影响应用:** Java SE JDK and JRE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，允许未授权的攻击者执行操作，修改数据

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 受影响的Java应用程序必须使用有缺陷的ECDSA签名验证代码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-21449，也被称为"Psychic Signatures"，是Java ECDSA签名验证中的一个严重漏洞。该漏洞允许攻击者通过提供一个有效的，但实际上是伪造的ECDSA签名来绕过身份验证。根本原因是Java 15中引入的ECDSA签名验证算法实现不正确，导致它接受零值的's'参数，有效地使签名验证无效。

**有效性:** 根据搜索结果，存在公开可用的PoC代码（例如，GitHub上的`notkmhn/CVE-2022-21449-TLS-PoC`），证明了该漏洞的可利用性。

**投毒风险:** 提供的代码段是Apache 2.0许可协议，不包含可执行代码，因此直接的投毒风险很低。但是，git仓库的提交记录等信息可能存在隐藏的风险，考虑到github仓库的复杂性，这里保守估计为5%.

**利用方式:**
1.  攻击者构造一个包含零值的's'参数的ECDSA签名。
2.  将此伪造的签名提供给受影响的Java应用程序，用于身份验证或其他需要ECDSA签名验证的操作。
3.  由于漏洞，Java应用程序会错误地将此签名视为有效，从而允许攻击者绕过身份验证并执行未经授权的操作。
4.  该漏洞可以通过多种协议进行利用，包括但不限于TLS，也可以通过Web服务API利用。

**项目地址:** [jfrog/jfrog-CVE-2022-21449](https://github.com/jfrog/jfrog-CVE-2022-21449)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)