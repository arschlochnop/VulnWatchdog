## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 目标网站的/vendor目录暴露，且存在phpunit组件相关路径

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-9841漏洞存在于PHPUnit框架的`Util/PHP/eval-stdin.php`文件中。攻击者可以通过向该文件发送以`<?php`开头的HTTP POST请求，执行任意PHP代码。根据搜索引擎结果，此漏洞在历史上被广泛利用，近期仍有扫描活动。提供的PoC代码是一个Python脚本，它首先尝试通过访问常见的路径来检测目标是否存在漏洞，如果存在，则可以发送包含PHP代码的POST请求，执行任意命令。 

**漏洞利用方式：**

1.  **漏洞检测：** PoC脚本首先尝试访问目标URL，例如`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`，判断是否存在该文件。
2.  **代码注入：** 如果文件存在，PoC脚本会发送一个POST请求，其中包含以`<?php`开头的PHP代码。例如，`<?php system("id");?>`用于执行系统命令`id`。
3.  **命令执行：** 目标服务器上的`eval-stdin.php`文件会执行POST请求中的PHP代码。
4.  **获取结果：** PoC脚本接收服务器返回的结果，并打印到屏幕上。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方式有效。PoC代码能够成功发送恶意请求并执行任意命令（如果目标存在漏洞）。

**投毒风险：**

PoC代码本身相对简单，主要功能是发送包含恶意PHP代码的POST请求。 代码未发现明显的投毒行为。
代码存在非常轻微的投毒风险，例如，作者可能在获取回显的异常处理中植入恶意代码，但可能性非常小，可以忽略不计。
综合评估，投毒风险极低。

**项目地址:** [jax7sec/CVE-2017-9841](https://github.com/jax7sec/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)