## CVE-2025-2294 - Kubio AI Page Builder LFI

**漏洞编号:** CVE-2025-2294

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Kubio AI Page Builder WordPress 插件

**危害等级:** 严重，未经身份验证的攻击者可以读取服务器上的任意文件，甚至执行PHP代码。

**影响版本:** <= 2.5.1

**利用条件:** 目标WordPress站点安装了受影响版本的Kubio AI Page Builder插件，且允许未经身份验证的HTTP请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2294 是 Kubio AI Page Builder WordPress 插件中存在的本地文件包含(LFI)漏洞。根据漏洞描述，未经身份验证的攻击者可以通过 `thekubio_hybrid_theme_load_template` 函数包含和执行服务器上的任意文件。这使得攻击者可以绕过访问控制、获取敏感数据，或者在可以上传图像和其他“安全”文件类型的情况下实现代码执行。

**有效性分析：**

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，该漏洞的POC代码是有效的。 漏洞库信息明确指出该漏洞是一个LFI，并给出了受影响的版本范围。搜索引擎结果也印证了漏洞的存在，并说明该漏洞被广泛关注。提供的漏洞利用代码 `cve-2025-2994.py` 实现了漏洞的利用，包括版本检测和LFI攻击。 代码中的 `exploit_lfi` 函数通过构造包含恶意文件路径的GET请求参数 `__kubio-site-edit-iframe-classic-template` 来实现任意文件读取。

**投毒风险分析：**

虽然提供的POC代码看似是良性的漏洞利用程序，但仍然存在一定的投毒风险。具体分析如下：

*   **requests.Session().verify = False 和 requests.packages.urllib3.disable_warnings()：** 这两行代码禁用了SSL证书验证，降低了脚本安全性，可能被用于中间人攻击。虽然禁用SSL验证在测试环境中很常见，但在实际攻击中可能会被滥用。
*   **异常处理：** 代码中存在一些异常处理，可能会隐藏某些错误信息。 此外，该脚本设计为可以读取任意文件，如果攻击者利用该脚本读取包含恶意代码的文件（例如，上传的后门图片），然后执行，就可能实现远程代码执行。
*   **依赖库：** 脚本依赖 `requests` 和 `packaging` （可选） 库。 如果攻击者能够控制这些依赖库，就能实现投毒。
*   **代码作者：** 虽然该脚本的目的是展示漏洞利用，但恶意攻击者可能会修改该脚本以添加恶意功能，例如上传后门、窃取数据等。
考虑到以上风险， 评估投毒的可能性为10%。

**利用方式：**

1.  **确定目标：** 找到安装了受影响版本Kubio AI Page Builder插件的WordPress站点。
2.  **版本检测：** 使用POC代码中的版本检测函数 (`check_version`) 检查目标站点是否易受攻击。该函数通过读取 `readme.txt` 文件来判断插件版本。
3.  **构造LFI请求：** 利用POC代码中的 `exploit_lfi` 函数构造包含恶意文件路径的GET请求。将恶意文件路径作为 `__kubio-site-edit-iframe-classic-template` 参数的值发送给目标站点。
4.  **读取文件：** 如果漏洞利用成功，目标站点将返回被包含文件的内容。
5.  **代码执行（可选）：** 如果攻击者能够上传包含PHP代码的文件（例如，通过媒体上传功能），他们可以通过LFI漏洞执行该代码，从而实现远程代码执行。

**项目地址:** [mrrivaldo/CVE-2025-2294](https://github.com/mrrivaldo/CVE-2025-2294)

**漏洞详情:** [CVE-2025-2294](https://nvd.nist.gov/vuln/detail/CVE-2025-2294)