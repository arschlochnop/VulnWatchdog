## CVE-2017-0143-Windows SMB Remote Code Execution

**漏洞编号:** CVE-2017-0143

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，允许远程攻击者通过特制的SMB数据包执行任意代码

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统开启SMBv1服务，且攻击者可以访问445端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0143 是一个存在于 Microsoft Windows SMBv1 服务器中的远程代码执行漏洞。 攻击者可以通过发送特制的 SMB 数据包利用此漏洞在目标系统上执行任意代码。 该漏洞也被称为 EternalBlue，并被 WannaCry 勒索软件利用。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已被广泛利用，且存在公开的POC代码(例如：Exploit-DB上的利用代码)。提供的漏洞利用代码描述了一个使用Metasploit框架利用EternalBlue漏洞的过程，包括配置RHOST、PAYLOAD和LHOST，并成功建立Meterpreter会话。因此，提供的POC代码具有有效性。

**投毒风险：**
分析提供的POC代码，主要是一个实验报告，描述了如何使用公开的EternalBlue漏洞利用攻击Windows 7虚拟机，并无发现明显的恶意代码。其中提及的Metasploit模块、payload配置（如windows/x64/meterpreter/reverse_tcp）都是常见的渗透测试工具。截图信息展示了利用成功后的提权、信息搜集、hashdump等操作。考虑到报告中包含flag文件，进一步说明这是一个实验性质的复现。代码仓库中包含LICENSE，README.md和实验报告，综合评估认为仓库本身存在较高风险，可能被用于恶意目的，因此判断投毒风险为10%。

**利用方式：**
利用方式主要分为以下几个步骤：
1.  **侦察：** 使用 `arp-scan` 和 `nmap` 发现目标主机和开放端口。`nmap -sS -sV` 用于确定目标系统开放的端口和服务版本。
2.  **漏洞检测：** 使用 `nmap --script vuln` 或手动枚举，识别目标系统 SMB 服务存在的 CVE-2017-0143 漏洞。
3.  **漏洞利用：** 使用 Metasploit 框架中的 `exploit/windows/smb/ms17_010_eternalblue` 模块。
4.  **配置：** 配置 RHOST（目标 IP 地址），PAYLOAD（例如 `windows/x64/meterpreter/reverse_tcp`），以及 LHOST（攻击者 IP 地址）。
5.  **执行：** 运行 exploit，成功建立 Meterpreter 会话。
6.  **后渗透：** 收集系统信息，提取密码哈希，并进行其他后渗透活动，比如flag获取。

**项目地址:** [Mafiosohack/offensive-security-lab-1](https://github.com/Mafiosohack/offensive-security-lab-1)

**漏洞详情:** [CVE-2017-0143](https://nvd.nist.gov/vuln/detail/CVE-2017-0143)