## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.2.0

**利用条件:** 目标部署了Langflow，并且可以从攻击者控制的网络访问其/api/v1/validate/code端点。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-3248是Langflow 1.2.0及更早版本中存在的一个未经身份验证的远程代码执行漏洞。该漏洞位于/api/v1/validate/code端点，允许未经身份验证的攻击者通过构造恶意的HTTP请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞利用的有效性非常高。多个来源确认了该漏洞的存在和严重性，并且存在公开可用的PoC代码。

**利用方式：**

1.  攻击者发送一个POST请求到`/api/v1/validate/code`端点。
2.  POST请求的body中包含一个JSON对象，其中`code`字段包含恶意的Python代码。此代码将会被Langflow服务器执行。
3.  PoC代码使用`subprocess.check_output`来执行操作系统命令，并将结果作为异常抛出（`raise Exception(...)`），这是一种绕过某些限制的方法。

**投毒风险：**
PoC代码中存在极低的投毒风险（约为1%）。

1.  PoC代码本身较为简洁，主要功能是利用`subprocess.check_output`执行命令并将其结果作为异常抛出，没有明显的恶意操作。
2.  PoC的代码引用了其他仓库的代码，需要注意那些仓库是否存在恶意代码。如果其他仓库的代码被篡改，可能导致投毒。

**总结：**
CVE-2025-3248是一个严重的安全漏洞，攻击者可以利用它在Langflow服务器上执行任意代码。强烈建议Langflow用户尽快升级到1.3.0或更高版本以修复此漏洞。

**项目地址:** [EQSTLab/CVE-2025-3248](https://github.com/EQSTLab/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)