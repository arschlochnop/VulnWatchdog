## CVE-2018-1273-Spring Data Commons-远程代码执行

**漏洞编号:** CVE-2018-1273

**漏洞类型:** 远程代码执行

**影响应用:** Spring Data Commons

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5, and older unsupported versions

**利用条件:** 需要Spring Data REST支持的HTTP资源或使用Spring Data的基于projection的请求payload绑定

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-1273是一个Spring Data Commons中的远程代码执行漏洞，源于对特殊元素的不当处理。未经身份验证的远程攻击者可以构造恶意请求参数，针对Spring Data REST支持的HTTP资源或使用Spring Data的基于projection的请求payload绑定，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果（特别是github上的POC链接）和提供的Dockerfile来看，提供的POC代码是有效的。Dockerfile构建了一个基于OpenJDK 8的环境，并将包含漏洞的`spring-data-commons.jar`部署到容器中。`main.sh`脚本会持续运行该jar文件。

**投毒风险：**
检查提供的POC代码，投毒风险较低。虽然`main.sh`脚本会无限循环运行jar包，但这本身是用于维持服务运行，便于漏洞验证。Dockerfile中没有发现恶意代码，只是简单的环境配置和jar包复制。`README.md`也只是说明漏洞和镜像来源信息。但是，因为使用了第三方提供的jar包，依然存在一定的风险，因此判断投毒风险为10%。

**利用方式：**
利用方式是通过构造特殊的请求参数，利用Spring Data REST或基于projection的请求payload绑定机制，注入SpEL表达式，最终执行任意代码。攻击者需要找到使用了Spring Data REST暴露的端点，然后构造恶意的HTTP请求。具体利用方式参考gosecure.ai的博客文章（搜索结果4）及其他相关的PoC。

总结：CVE-2018-1273是Spring Data Commons的一个严重漏洞，利用难度相对较低，影响范围广。已存在公开的POC，攻击者可以利用它执行任意代码。建议尽快升级到安全版本。

**项目地址:** [cved-sources/cve-2018-1273](https://github.com/cved-sources/cve-2018-1273)

**漏洞详情:** [CVE-2018-1273](https://nvd.nist.gov/vuln/detail/CVE-2018-1273)