## CVE-2025-3248-Langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 目标运行Langflow，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248是Langflow 1.3.0之前版本中/api/v1/validate/code端点存在的一个未经身份验证的远程代码执行漏洞。攻击者可以通过构造恶意的HTTP请求，向目标/api/v1/validate/code端点发送包含恶意代码的请求，从而在目标服务器上执行任意代码。

**有效性：**
提供的漏洞利用代码（Langflow Vulnerability Scanner）是一个Python脚本，它利用了CVE-2025-3248漏洞。脚本允许扫描单个目标或使用FOFA API扫描多个目标，并在易受攻击的系统上执行系统命令。 从README.md中的示例payload可以看出，可以通过构造包含subprocess.check_output的python代码来执行任意命令，所以有效性高。

**投毒风险：**
代码仓库的主要功能是漏洞扫描和利用，但在漏洞利用的Custom Payloads部分，引导用户使用自定义Python文件作为payload。如果用户使用了不可信的payload文件，可能导致执行恶意代码，例如反弹shell等。此外，该漏洞利用代码依赖一些第三方库，如`requirements.txt`中指定的库。虽然看起来是常规库，但存在供应链投毒的理论可能性，攻击者可能篡改这些库，在用户安装依赖时植入恶意代码。
综合考虑，投毒风险较低，但存在，估计为10%。

**利用方式：**
1.  **确定目标：** 找到运行Langflow 1.2.0或更早版本的实例。
2.  **构造Payload：**  构造一个恶意的Python代码片段，利用`exec`函数执行任意命令，例如：
    ```python
    def test(cd=exec('raise Exception(__import__("subprocess").check_output("your_command", shell=True))')):
        pass
    ```
3.  **发送请求：**  将构造的Payload发送到`/api/v1/validate/code`端点。
4.  **执行代码：**  Langflow服务器会执行Payload中的代码，从而导致远程代码执行。

总的来说，此漏洞利用方式简单，风险极高，利用代码有效。

**项目地址:** [xuemian168/CVE-2025-3248](https://github.com/xuemian168/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)