## CVE-2023-1389-TP-Link Archer AX21-命令注入

**漏洞编号:** CVE-2023-1389

**漏洞类型:** 命令注入

**影响应用:** TP-Link Archer AX21 (AX1800)

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 固件版本低于 1.1.4 Build 20230219

**利用条件:** 需要与目标路由器在同一网络内，或可直接访问其Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1389 是一个TP-Link Archer AX21 路由器上的命令注入漏洞。未经身份验证的攻击者可以通过向 `/cgi-bin/luci/;stok=/locale` 端点的 `country` 参数发送恶意POST请求来执行任意命令，命令以root权限运行。根据搜索引擎结果，该漏洞已被广泛利用于传播僵尸网络。提供的PoC代码通过设置 `country` 参数来注入命令，并通过 netcat (nc) 将命令输出重定向到攻击者控制的服务器。漏洞利用过程通常需要两次请求，一次用于设置命令，另一次用于触发执行。PoC代码的主要功能是简化漏洞利用过程，包括参数设置、命令执行和结果检索。投毒风险评估为10%，理由是：

1.  **网络依赖性**：PoC使用 `nc` 命令回传数据，如果目标路由器无法访问攻击者的 `nc` 监听端口，利用将会失败。
2.  **命令执行方式**：PoC选择将命令结果写入文件 `/tmp/out`，再通过 `nc` 传输，这增加了文件操作的步骤，也存在文件权限或空间不足的风险。更为隐蔽的利用方式可以直接通过管道将命令输出通过 `nc` 回传。
3.  **错误处理**：PoC中的错误处理机制相对简单，可能无法应对复杂的网络环境或目标系统的异常情况。
4.  **明确的利用痕迹**：使用 `/tmp/out` 这种硬编码的文件名，容易被检测到。

这些因素降低了PoC的隐蔽性和可靠性，增加了被检测和防御的概率。虽然该 PoC 本身没有发现恶意代码，但通过修改PoC代码可以植入后门，例如修改回连IP地址，执行恶意脚本等。因此存在一定的投毒风险。

**项目地址:** [ibrahimsql/CVE2023-1389](https://github.com/ibrahimsql/CVE2023-1389)

**漏洞详情:** [CVE-2023-1389](https://nvd.nist.gov/vuln/detail/CVE-2023-1389)