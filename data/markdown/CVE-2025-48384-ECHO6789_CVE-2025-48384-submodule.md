## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0 < 2.44.4, >= 2.45.0-rc0 < 2.45.4, >= 2.46.0-rc0 < 2.46.4, >= 2.47.0-rc0 < 2.47.3, >= 2.48.0-rc0 < 2.48.2, >= 2.49.0-rc0 < 2.49.1, >= 2.50.0-rc0 < 2.50.1

**利用条件:** 需要用户交互，克隆包含恶意配置的Git仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理配置时对回车符（CR）处理不当。攻击者可以构造包含恶意配置的 Git 仓库，其中子模块路径包含尾随 CR。当用户克隆该仓库并初始化子模块时，Git 会错误地将子模块检出到错误的位置。如果攻击者在错误的位置设置了一个指向子模块 hooks 目录的符号链接，并且子模块包含一个可执行的 post-checkout hook，那么在检出后，该 hook 脚本就会被执行，从而导致任意代码执行。

**POC分析：**

提供的 POC 代码 `/tmp/569f31ff6b5166501e6218f8839f5620/post-checkout` 是一个 post-checkout hook 脚本。该脚本的作用是 ping `wtt0rkb926c0mj6tsxmzfr2xlorff53u.test-burp.huidoumeng.com`。这个行为本身用于验证漏洞是否被成功利用，攻击者可以通过监测 DNS 请求判断 hook 是否被执行。这个hook仅是验证，不能算恶意代码。

**有效性：**

根据搜索结果，该漏洞的PoC已经公开，并被标记为高危漏洞，利用代码结合漏洞描述，可以判断POC有效。

**投毒风险：**

提供的POC代码仅包含一个简单的ping命令，用于验证漏洞是否触发。它本身不包含任何恶意代码或后门，因此投毒风险较低，可以认为是0%。然而，实际攻击中，攻击者可能会将此 hook 替换为更具破坏性的代码。

**利用方式：**

1.  攻击者创建一个包含恶意配置的Git仓库。
2.  恶意配置包括带有尾随回车符的子模块路径。
3.  攻击者在错误的位置创建一个指向子模块 hooks 目录的符号链接。
4.  攻击者在子模块中包含一个可执行的 post-checkout hook。
5.  攻击者诱使用户克隆该恶意仓库并初始化子模块。
6.  用户执行 `git clone --recurse-submodules` 或 `git submodule update --init --recursive`。
7.  Git将子模块检出到错误的位置，并执行 post-checkout hook，从而导致任意代码执行。

**项目地址:** [ECHO6789/CVE-2025-48384-submodule](https://github.com/ECHO6789/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)