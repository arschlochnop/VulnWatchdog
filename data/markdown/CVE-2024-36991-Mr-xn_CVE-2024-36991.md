## CVE-2024-36991-Splunk Enterprise on Windows-路径遍历

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 受影响版本：9.2.x (低于 9.2.2), 9.1.x (低于 9.1.5), 9.0.x (低于 9.0.10)

**利用条件:** Splunk Enterprise 运行在 Windows 操作系统上，且目标服务器存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36991 是 Splunk Enterprise 在 Windows 平台上的一个路径遍历漏洞。攻击者可以通过构造特殊的 URL，利用 `/modules/messaging/` 接口，读取服务器上的任意文件。

**有效性：**
提供的 POC 代码显示了构造包含 `C:../` 序列的 URL 来进行路径遍历的方法。这种方法利用了 Python `os.path.join` 函数在处理 Windows 路径时的特性，即如果后续路径片段中包含驱动器号，则会移除之前构建路径中的驱动器号部分，从而允许攻击者跳出预期的目录。

**投毒风险：**
提供的代码仓库中包含 LICENSE、README.md 文件。没有发现任何隐藏的恶意代码或后门。因此，投毒风险评估为 0%。

**利用方式：**
1.  确定目标 Splunk Enterprise 服务器正在运行受影响的版本，并且运行在 Windows 操作系统上。
2.  构造包含路径遍历序列的 URL，例如：`/en-US/modules/messaging/C:../C:../C:../C:../C:../C:../C:../C:../Windows/win.ini` 或 `/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd` 。
3.  向目标服务器发送构造的 HTTP GET 请求。
4.  如果漏洞存在，服务器将返回被请求文件的内容。需要注意的是，由于 Splunk 默认运行权限，可能只能读取部分文件。

**项目地址:** [Mr-xn/CVE-2024-36991](https://github.com/Mr-xn/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)