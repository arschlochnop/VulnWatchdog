## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet的写入启用(readonly=false, allowPut=true, allowPartialPut=true)，应用使用Tomcat的文件Session持久化存储，应用包含可用于反序列化攻击的library

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个远程代码执行漏洞，该漏洞允许攻击者在满足特定条件的情况下执行任意代码。

**漏洞利用有效性分析：**

根据搜索引擎结果，该漏洞在发布后不久就出现了在野利用，多个安全厂商也发布了相关的分析报告和检测规则，表明该漏洞具有较高的实际威胁性。POC代码中，通过修改`web.xml`文件，开启了默认Servlet的写入权限和PUT方法，然后利用ysoserial生成反序列化payload，通过分块PUT请求上传payload，最后访问特定URL触发反序列化，从而执行反弹shell命令。如果目标环境符合漏洞描述中的所有条件（Default Servlet 开启写入、支持 partial PUT、使用文件session存储、存在可利用的反序列化库），那么该POC代码可以有效实现RCE。

**投毒风险分析：**

POC代码主要由shell脚本和Dockerfile组成。脚本负责构建、运行Tomcat镜像、生成payload、上传payload、触发漏洞等操作。Dockerfile用于构建包含漏洞环境的Tomcat镜像。仔细检查这些文件，发现潜在的投毒点可能在于:

*   **ysoserial payload生成：** 脚本使用`ysoserial.jar`生成payload，如果攻击者替换了`ysoserial.jar`文件，可能会植入恶意代码。但是脚本中包含了直接从`https://jitpack.io/com/github/frohoff/ysoserial/master-b7d0f27b46-1/ysoserial-master-b7d0f27b46-1.jar`下载`ysoserial.jar` 的代码，除非该链接被篡改，否则可以排除。虽然存在该风险，但因为是从已知源下载，所以该风险相对较低。
*   **Dockerfile修改：** Dockerfile通过sed命令修改`web.xml`文件，开启了`readonly=false`。如果`sed`命令被篡改，可能导致其他恶意配置。

总体来说，该POC代码的投毒风险较低，因为所有操作都相对透明，且依赖已知的工具和配置。最主要的风险在于ysoserial的下载源被篡改的可能性。因此，投毒风险评估为5%。

**漏洞利用方式：**

1.  **环境准备：** 构建包含漏洞版本的Apache Tomcat环境。Dockerfile中配置了允许PUT请求，这是一个关键的先决条件。
2.  **Payload生成：** 使用ysoserial工具，结合CommonsBeanutils1链，生成包含反弹shell命令的序列化payload。
3.  **Payload上传：** 通过分块PUT请求，将payload上传到服务器。
4.  **触发反序列化：** 访问特定的URL，触发反序列化漏洞，执行payload中的命令，从而获得反弹shell。

**项目地址:** [beyond-devsecops/CVE-2025-24813](https://github.com/beyond-devsecops/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)