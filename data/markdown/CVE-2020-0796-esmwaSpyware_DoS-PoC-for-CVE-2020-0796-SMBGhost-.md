## CVE-2020-0796 - SMBGhost 远程代码执行漏洞

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可导致远程代码执行和系统崩溃

**影响版本:** Windows 10 Version 1903/1909, Windows Server, version 1903/1909 (Server Core installation)

**利用条件:** 目标系统未打CVE-2020-0796补丁，开启SMBv3协议，且攻击者能与目标SMB端口(通常是445)通信。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-0796，又名SMBGhost，是 Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理特定请求时存在远程代码执行漏洞。该漏洞存在于SMBv3压缩功能中，允许未经身份验证的攻击者通过发送特制的压缩数据包导致内存损坏，进而实现远程代码执行或拒绝服务。

**有效性分析：**

根据提供的漏洞库信息、搜索引擎结果以及漏洞利用代码，此漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞的存在，并将其描述为远程代码执行漏洞。搜索引擎结果也表明存在公开可用的PoC代码，可以利用该漏洞进行攻击。提供的PoC代码通过构造畸形的SMBv3压缩数据包，尝试触发目标系统的内存损坏，从而实现拒绝服务攻击。虽然提供的PoC代码是DoS，但是根据参考链接可以实现RCE。

**投毒风险分析：**

分析提供的PoC代码，该代码主要功能是构造一个SMBv3压缩数据包，并通过socket发送到目标IP的445端口。代码本身比较简单，没有发现明显的恶意代码或后门。代码的主要功能是触发拒绝服务攻击，因此不存在主动植入后门的行为。基于代码的分析，投毒的风险非常低，几乎为0%。

**利用方式分析：**

利用方式主要包括以下步骤：

1.  **目标确认：** 确定目标系统运行的是受影响的Windows版本（Windows 10 Version 1903/1909, Windows Server, version 1903/1909）。
2.  **端口确认：** 确保目标系统的445端口（SMB协议默认端口）是开放的，并且攻击者可以访问。
3.  **PoC利用：** 运行PoC代码，输入目标IP地址。PoC代码会构造一个特制的SMBv3压缩数据包，并将其发送到目标系统。
4.  **结果判断：** 如果目标系统存在漏洞且未打补丁，则可能会崩溃或无响应。

根据搜索结果，一些PoC可以实现远程代码执行，攻击者可以通过修改PoC代码，将shellcode注入到压缩数据包中，从而在目标系统上执行任意代码。该漏洞无需身份验证，具有蠕虫传播的潜力，因此危害性极高。

**项目地址:** [esmwaSpyware/DoS-PoC-for-CVE-2020-0796-SMBGhost-](https://github.com/esmwaSpyware/DoS-PoC-for-CVE-2020-0796-SMBGhost-)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)