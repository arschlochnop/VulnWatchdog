## CVE-2025-24252 AirPlay Use-After-Free RCE

**漏洞编号:** CVE-2025-24252

**漏洞类型:** Use-After-Free

**影响应用:** Apple AirPlay

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** tvOS < 18.4, iOS and iPadOS < 18.4, iPadOS < 17.7, macOS < 15.4, visionOS < 2.4, macOS < 14.7, macOS < 13.7

**利用条件:** 与目标设备在同一本地网络，需要开启AirPlay服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24252是一个存在于Apple AirPlay中的use-after-free漏洞。攻击者可以通过发送特制的mDNS TXT记录利用此漏洞，实现在目标设备上的远程代码执行（RCE）。根据搜索引擎结果和漏洞利用代码，攻击者利用scapy库构建恶意mDNS包，其中包含过大的TXT记录，触发AirPlay服务中的内存管理错误，导致use-after-free。该PoC通过循环发送恶意数据包，达到crash的效果，进而可用于构建完整的RCE利用。虽然POC本身是为了崩溃目标，但该漏洞允许潜在的任意代码执行，因此存在被利用执行恶意行为的风险。由于仓库代码量较少，且大部分是PoC相关代码，仅有少部分辅助脚本,投毒风险较低，判断为5%。虽然存在投毒的可能性，但主要体现在构建恶意利用链时，攻击者可能会加入后门代码，但这与PoC本身无关。

利用方式：
1. 攻击者需要在与目标设备相同的本地网络中。
2. 攻击者使用PoC代码构建包含恶意mDNS TXT记录的数据包。
3. 攻击者将此数据包发送到目标设备的AirPlay服务。
4. 目标设备的AirPlay服务处理恶意数据包时，由于use-after-free漏洞，可能导致进程崩溃或被利用执行任意代码。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-24252](https://github.com/B1ack4sh/Blackash-CVE-2025-24252)

**漏洞详情:** [CVE-2025-24252](https://nvd.nist.gov/vuln/detail/CVE-2025-24252)