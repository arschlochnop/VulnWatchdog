## CVE-2020-29204-XXL-JOB-存储型XSS

**漏洞编号:** CVE-2020-29204

**漏洞类型:** 存储型XSS

**影响应用:** XXL-JOB

**危害等级:** 中危，可能导致用户凭据泄露、页面重定向或恶意代码执行

**影响版本:** 2.2.0

**利用条件:** 需要具有添加用户的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-29204是XXL-JOB 2.2.0版本中存在的一个存储型XSS漏洞，位于添加用户的功能中。通过在添加用户时，绕过用户名或其它字段的20字符限制，可以注入恶意JavaScript代码。当管理员或其他用户查看受影响的用户信息时，这些恶意代码会被执行。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在XXL-JOB 2.2.0版本中确实存在，并且可以通过绕过长度限制注入XSS代码。因此，利用是有效的。

**投毒风险：** 提供的漏洞利用代码只是GNU GPL许可证文本，不是实际的漏洞利用Payload。因此，不存在投毒风险。

**利用方式：**
1.  登录到XXL-JOB管理后台。
2.  导航到添加用户页面。
3.  在用户名或其他允许输入的字段中，输入超出20个字符的XSS Payload，例如：`<script>alert('XSS')</script>`。
4.  提交表单，成功添加用户。
5.  当其他用户（如管理员）查看包含此恶意用户的列表或详细信息时，XSS Payload将被触发。

**总结：** 该漏洞利用方式简单，风险在于可能被利用于窃取管理员或其他用户的Session信息，或进行恶意页面重定向。由于提供的代码并非实际的exploit，因此判断不存在投毒。

**项目地址:** [shoucheng3/xuxueli__xxl-job_CVE-2020-29204_2-2-0](https://github.com/shoucheng3/xuxueli__xxl-job_CVE-2020-29204_2-2-0)

**漏洞详情:** [CVE-2020-29204](https://nvd.nist.gov/vuln/detail/CVE-2020-29204)