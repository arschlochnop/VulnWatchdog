## CVE-2025-29927-Next.js-授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6 | > 14.0.0, < 14.2.25 | > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞的 Next.js 版本，且授权检查位于中间件中。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 存在于 Next.js 中，是一个授权绕过漏洞。攻击者可以通过某种方式绕过中间件中的授权检查，从而访问未授权的资源。根据漏洞库信息，受影响的版本包括 >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, 和 > 15.0.0, < 15.2.3。搜索引擎结果表明该漏洞是一个严重的问题，可能导致严重的后果。

**有效性评估：**
提供的 POC 代码包含一个 Next.js 项目的框架代码，包括 `middleware.ts`。这个文件设置了一些简单的header，但本身并没有展示如何利用 `x-middleware-subrequest` 头部绕过身份验证。所以POC本身不包含直接的攻击代码，但是这个项目可以用来复现漏洞。

**投毒风险分析：**
查看提供的文件列表，发现该代码主要是 Next.js 项目的基础配置和中间件示例，并没有明显的恶意代码存在。其中 `package-lock.json`  文件列出了项目依赖，但都是常见的 Next.js 依赖项。`middleware.ts`设置了一些响应头，例如 `x-test-used-middleware` 和 `x-test-used-next-version`。`netlify.toml` 是 Netlify 部署配置文件。
因此，初步判断该代码仓库存在恶意投毒代码的可能性较低，大约为 5%，主要考虑到供应链投毒的可能性，依赖库可能存在潜在风险，但从提供的内容无法直接判断。

**利用方式：**
根据漏洞库信息和搜索结果，利用方式通常涉及构造包含 `x-middleware-subrequest` 头的 HTTP 请求。如果 Next.js 应用的中间件授权逻辑存在缺陷，未能正确处理或验证带有此头的请求，攻击者即可绕过授权检查。具体绕过方式需要根据目标应用中间件的实现细节来确定，比如可以通过修改请求头、请求体等方式来欺骗授权逻辑。

**项目地址:** [serhalp/test-cve-2025-29927](https://github.com/serhalp/test-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)