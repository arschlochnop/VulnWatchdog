## CVE-2014-6287-Rejetto HTTP File Server-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标系统运行着存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 漏洞存在于 Rejetto HTTP File Server (HFS) 2.3x 版本到 2.3c 之前的版本中。该漏洞位于 parserLib.pas 文件的 findMacroMarker 函数。攻击者可以通过在搜索操作中利用 %00 序列，远程执行任意程序。

**利用方式：**

1.  攻击者构造包含恶意 PowerShell 命令的 HTTP GET 请求。
2.  该命令经过 Base64 编码，以绕过潜在的安全过滤。
3.  攻击者发送包含恶意负载的 HTTP 请求到目标 HFS 服务器。
4.  HFS 服务器解析请求，解码并执行 PowerShell 命令，从而在攻击者机器上建立反向 Shell。

**有效性：**

提供的漏洞利用代码（POC）描述了一种可行的攻击方法。搜索引擎结果和漏洞库信息都确认了该漏洞的存在以及可以通过发送特制的HTTP请求来执行任意代码。该POC代码描述了如何构造并发送包含反向shell的恶意请求，所以验证有效。

**投毒风险：**

该仓库中存在投毒代码的可能性较低，约为10%。原因如下：

*   该项目提供了一个详细的自述文件，解释了漏洞的原理和利用步骤。
*   该漏洞已公开存在多年，且 Metasploit 框架中也存在相应的利用模块，因此，添加恶意代码并隐藏其目的比较困难。
*   但仍存在一定风险，攻击者可能篡改了代码，添加了额外的恶意功能，例如收集用户信息或进行其他恶意活动。用户在使用该代码前应仔细审查代码，并确保从可信的来源下载。

**缓解措施：**

*   将 Rejetto HTTP File Server (HFS) 升级到 2.3c 或更高版本。
*   使用防火墙限制对 HFS 服务的访问。
*   监控 HFS 服务的异常活动。

**项目地址:** [francescobrina/hfs-cve-2014-6287-exploit](https://github.com/francescobrina/hfs-cve-2014-6287-exploit)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)