## CVE-2025-2907-Order Delivery Date Pro for WooCommerce-未授权任意选项更新

**漏洞编号:** CVE-2025-2907

**漏洞类型:** 未授权任意选项更新/CSRF

**影响应用:** Order Delivery Date Pro for WooCommerce

**危害等级:** 高危，可能导致权限提升和网站控制

**影响版本:** < 12.3.1

**利用条件:** 需要目标网站安装了Order Delivery Date Pro for WooCommerce插件，且版本低于12.3.1，无需用户交互。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-2907 漏洞存在于 Order Delivery Date Pro for WooCommerce 插件中，版本低于 12.3.1。该插件在导入设置时缺少授权和 CSRF 检查，并且缺乏适当的检查以限制仅更新与该插件相关的选项。攻击者可以利用此漏洞修改 WordPress 的 `default_user_role` 和 `users_can_register` 选项，从而允许攻击者注册为管理员并完全控制网站。

**漏洞利用方式：**

1.  攻击者利用未经身份验证的 `/wp-admin/admin-ajax.php` 端点，该端点处理 `orddd_import` 操作。
2.  攻击者上传包含恶意配置的 `malicious_settings.json` 文件。该文件包含将 `users_can_register` 设置为 `True` 和 `default_role` 设置为 `administrator` 的配置。
3.  由于缺少授权和 CSRF 检查，WordPress 会更新数据库中的这些选项。
4.  攻击者随后可以注册一个新用户，该用户将自动被分配管理员角色，从而获得对网站的完全控制权。

**POC有效性：**
提供的 POC 代码（`CVE-2025-2907.py`）似乎有效。它通过发送一个包含恶意配置的 POST 请求到 `/wp-admin/admin-ajax.php` 来利用该漏洞。代码还检查目标站点是否已启用注册，这表明漏洞利用成功。搜索引擎结果也表明该漏洞可以被利用。

**投毒风险：**

*   `requirements.txt` 文件只包含 `requests` 库，没有其他可疑依赖项。
*   `readme.md` 文件中描述的漏洞信息和利用方式与漏洞库信息和搜索引擎结果一致，没有发现恶意篡改。
*   Python脚本中的Payload是符合逻辑的利用，用于提升权限，并未发现用于隐藏后门或者恶意行为。

**综合判断，投毒风险较低，判断为 1%。风险主要来源于代码质量和使用不当，而非恶意投毒。**


**项目地址:** [Yucaerin/CVE-2025-2907](https://github.com/Yucaerin/CVE-2025-2907)

**漏洞详情:** [CVE-2025-2907](https://nvd.nist.gov/vuln/detail/CVE-2025-2907)