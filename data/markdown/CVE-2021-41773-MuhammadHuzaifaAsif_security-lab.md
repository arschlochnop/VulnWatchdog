## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要Apache HTTP Server版本为2.4.49，Alias配置不当，且CGI脚本启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773是Apache HTTP Server 2.4.49中的一个路径遍历漏洞。由于路径规范化处理存在缺陷，攻击者可以利用该漏洞将URL映射到Alias指令配置目录之外的文件。如果这些目录之外的文件没有被"require all denied"等默认配置保护，攻击者就可以成功访问这些文件。更严重的是，如果为这些Alias路径启用了CGI脚本，攻击者还可以执行远程代码。

**有效性：**
根据漏洞描述，该漏洞利用较为直接，通过构造包含".."的URL进行路径遍历。从搜索结果来看，存在大量的漏洞分析和利用文章，表明该漏洞利用的有效性较高。

**投毒风险：**
漏洞利用代码仅提供了漏洞分析文档、CVSS评分、环境信息、影响评估和缓解措施。其中`steps_performed.md`缺失，无法得知作者是否进行了真实的漏洞利用和测试。代码仓库主要目的是漏洞分析和缓解建议，并声明未在目标VM上安装Apache，因此实际利用代码缺失。综合判断，该仓库中存在作者隐藏恶意代码进行投毒的概率较低，预估为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造恶意的HTTP请求，包含特殊编码的路径，例如`..%2f`或`..\`，绕过服务器的路径检查，访问服务器上的任意文件。
2.  **文件泄露：** 成功利用路径遍历后，攻击者可以读取服务器上的敏感文件，如配置文件、源代码等。
3.  **远程代码执行：** 如果服务器启用了CGI，攻击者可以通过路径遍历访问CGI脚本，并执行恶意代码。攻击者可以上传包含恶意代码的CGI脚本，并通过路径遍历执行，从而获取服务器的控制权。

**项目地址:** [MuhammadHuzaifaAsif/security-lab](https://github.com/MuhammadHuzaifaAsif/security-lab)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)