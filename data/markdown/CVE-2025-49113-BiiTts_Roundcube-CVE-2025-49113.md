## CVE-2025-49113-Roundcube-RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** 远程代码执行

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.10 和 1.6.0 <= version < 1.6.11

**利用条件:** 需要已认证的用户身份

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49113 是 Roundcube Webmail 中的一个远程代码执行 (RCE) 漏洞。该漏洞允许经过身份验证的用户通过操纵 URL 中的 `_from` 参数来执行任意代码。具体来说，`program/actions/settings/upload.php` 文件中对 `_from` 参数的验证不足，导致 PHP 对象反序列化漏洞的产生。 

**有效性分析：**
根据漏洞信息和提供的利用代码，可以判断POC代码有效。漏洞库信息明确指出存在未授权的PHP对象反序列化漏洞，搜索引擎结果也显示该漏洞已被广泛关注，并且存在公开的PoC。提供的PoC代码利用了 `Crypt_GPG_Engine` 类中的 `_gpgconf` 属性来执行命令。`generate_gadget.php` 脚本生成恶意的序列化对象，`roundcube_exploit.py` 脚本负责发送包含恶意序列化数据的请求。

**利用方式：**
1.  **身份验证：** 攻击者需要先获得一个有效的 Roundcube Webmail 用户账号。
2.  **生成 Gadget：** 使用 `generate_gadget.php` 脚本生成包含恶意命令的序列化数据。该脚本将命令进行base64编码后注入到`Crypt_GPG_Engine` 对象的`_gpgconf` 属性，然后序列化该对象。
3.  **发送请求：** `roundcube_exploit.py` 脚本将生成的序列化数据作为 `_from` 参数的值，构造恶意的URL，并发送给 `program/actions/settings/upload.php`。 
4.  **代码执行：** Roundcube Webmail 在处理请求时，反序列化 `_from` 参数，导致恶意代码执行。

**投毒风险分析：**
查看了 `roundcube_exploit.py` ， `generate_gadget.php`，`requirements.txt` 三个文件。
*   `roundcube_exploit.py`：该脚本的主要功能是利用漏洞，但存在风险，可能被用于恶意目的。脚本本身存在可疑代码。
*   `generate_gadget.php`：该脚本的功能是生成payload，用于RCE，相对安全。
*    `requirements.txt`：该文件定义了脚本所需的依赖项。但攻击者可能通过替换这些依赖项为恶意版本来实施供应链攻击。

虽然主要逻辑是利用漏洞，没有明显植入后门的代码，但考虑到攻击者可能利用此仓库传播恶意软件，因此存在较低的投毒风险。
综合判断，投毒风险为 5%。主要是考虑到利用该代码进行攻击的风险，以及可能被替换依赖包的风险。

**项目地址:** [BiiTts/Roundcube-CVE-2025-49113](https://github.com/BiiTts/Roundcube-CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)