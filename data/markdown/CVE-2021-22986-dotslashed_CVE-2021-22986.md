## CVE-2021-22986 F5 BIG-IP/BIG-IQ iControl REST API 远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行 (RCE)

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，未经身份验证的远程命令执行

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且可访问 iControl REST API 接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经身份验证的远程命令执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**根据漏洞库信息、搜索引擎结果（特别是NCC Group的分析）和已知的利用情况，此漏洞利用的有效性很高。有报告表明该漏洞已被积极利用于Mirai僵尸网络攻击。

**投毒风险：**提供的POC代码（README.md）本身只是一个使用说明，用于检测批量IP地址是否受到此漏洞影响。因此，它本身不包含任何恶意代码，因此投毒的风险较低，但是如果使用者下载了其他的POC代码，则需要对代码进行分析，以保证没有投毒代码。 这里给出的投毒风险百分比是根据POC代码本身进行评估的，考虑到使用者可能会从其他来源获取恶意POC，这里给出的投毒概率为10%。

**利用方式：**

1.  确定目标F5 BIG-IP/BIG-IQ设备的IP地址和端口。
2.  向 iControl REST API 发送特制的HTTP请求，其中包含要执行的命令。由于漏洞未经身份验证，因此攻击者不需要提供任何凭据。
3.  服务器执行请求中包含的命令，并将结果返回给攻击者。 

漏洞利用的关键是构造恶意的HTTP请求，该请求能够绕过任何现有的安全检查，并在服务器上执行任意命令。Packet Storm Security提供了相关的漏洞利用细节，可用于构造此类请求。

**总结：**该漏洞非常危险，因为它允许未经身份验证的攻击者在受影响的F5设备上执行任意命令。由于该漏洞已经被积极利用，因此强烈建议受影响的用户尽快升级到修补后的版本。

**项目地址:** [dotslashed/CVE-2021-22986](https://github.com/dotslashed/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)