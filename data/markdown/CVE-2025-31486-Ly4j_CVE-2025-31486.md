## CVE-2025-31486-Vite-任意文件读取

**漏洞编号:** CVE-2025-31486

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.12, >=5.0.0 < 5.4.17, >=6.0.0 < 6.0.14, >=6.1.0 < 6.1.4, >=6.2.0 < 6.2.5

**利用条件:** Vite dev server 必须暴露在网络上 (使用 --host 或 server.host 配置选项)。文件大小小于 build.assetsInlineLimit (默认：4kB)，且版本为Vite 6.0+。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-31486 是一个 Vite 框架的任意文件读取漏洞。攻击者可以通过构造特定的 URL，绕过 server.fs.deny 限制，读取服务器上的任意文件。该漏洞利用条件较为苛刻，需要 Vite dev server 暴露在网络上，并且目标文件大小需要小于 build.assetsInlineLimit。提供的PoC代码 `CVE-2025-31486-PoC.py` 尝试利用该漏洞读取 `/etc/passwd` (Linux) 和 `C:\windows\win.ini` (Windows)。PoC通过构造包含 `.svg` 或相对路径的URL，并设置 `Sec-Fetch-Dest: script` header来尝试绕过文件访问限制。PoC代码中没有发现明显的投毒代码，只是实现了漏洞验证的功能。`README.md` 提供了一个博客链接，展示了复现漏洞和环境搭建的细节。因此，判断PoC代码本身没有投毒风险，但是由于漏洞本身可以读取任意文件，如果被恶意利用，则存在严重的安全风险。

**漏洞利用方式：**

1.  **条件:** 目标Vite应用需要满足：
    *   运行在受影响的版本。
    *   Vite的开发服务器通过 `--host` 或 `server.host` 暴露在网络上。
    *   目标文件小于 `build.assetsInlineLimit`（默认为4KB，Vite 6.0+）。
2.  **攻击步骤:**
    *   构造包含目标文件路径的特殊URL，例如：`/{filepath}?.svg?.wasm?init` 或 `/@fs/x/x/x/vite-project/?/../../../../../{filepath}?import&?raw`。
    *   设置 `Sec-Fetch-Dest` 请求头为 `script`。
    *   发送构造的HTTP请求到Vite服务器。
    *   如果服务器返回状态码200，并且响应内容包含 `import initWasm from`，则可能存在漏洞。
    *   从响应内容中提取 Base64 编码的数据，进行解码。
    *   验证解码后的文件内容是否与预期一致。
3.  **利用效果:** 成功利用漏洞后，攻击者可以读取服务器上任意文件内容，可能包括敏感配置文件、源代码等。

**项目地址:** [Ly4j/CVE-2025-31486](https://github.com/Ly4j/CVE-2025-31486)

**漏洞详情:** [CVE-2025-31486](https://nvd.nist.gov/vuln/detail/CVE-2025-31486)