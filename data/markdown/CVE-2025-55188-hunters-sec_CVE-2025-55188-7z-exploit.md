## CVE-2025-55188-7-Zip符号链接任意文件写入漏洞

**漏洞编号:** CVE-2025-55188

**漏洞类型:** 符号链接攻击/任意文件写入

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致权限提升或拒绝服务，具体取决于被覆盖文件的敏感程度。

**影响版本:** < 25.01

**利用条件:** 用户必须使用受影响版本的7-Zip提取恶意构造的压缩包，并且提取位置允许符号链接解析到目标文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-55188 存在于 7-Zip 25.01之前的版本中。此漏洞是由于7-Zip在提取文件时没有正确处理符号链接造成的。攻击者可以创建一个包含指向系统关键文件的符号链接的恶意压缩包。当用户使用有漏洞的 7-Zip 版本提取此压缩包时，符号链接会被解析，攻击者可以利用此漏洞将恶意内容写入受害者系统上的任意文件，比如覆盖`.bashrc`文件以获得代码执行能力或者覆盖`~/.ssh/authorized_keys`添加公钥以实现未授权访问。 

**有效性分析：**

提供的PoC代码看起来是有效的。它利用了7-Zip在处理符号链接时的漏洞，创建了一个包含指向目标文件的符号链接的压缩包，以及包含恶意内容的payload文件。当用户提取该压缩包时，payload会覆盖目标文件。

**投毒风险分析：**

PoC 代码本身主要由一个 shell 脚本和一个 README.md 文件组成。Shell 脚本的目的是创建恶意压缩包，并没有明显的投毒行为。脚本会创建临时目录，创建符号链接，将 Payload 复制到该符号链接，然后打包并压缩，最后删除临时文件，整个流程看起来比较直接。可能的投毒点可能存在于打包和压缩命令中，但这两个命令是标准的系统命令，被篡改的可能性较低。

尽管代码本身没有明显的投毒行为，但是用户仍然需要谨慎，尤其是在下载和使用来自未知来源的 PoC 代码时。 因此，存在极低的潜在投毒风险，概率约为 1%。

**利用方式：**

1.  攻击者创建一个包含指向目标文件的符号链接的恶意压缩包。符号链接指向系统上攻击者希望覆盖的敏感文件。
2.  攻击者将该恶意压缩包分发给受害者。
3.  受害者使用受影响版本的 7-Zip 提取该压缩包。
4.  7-Zip 在提取过程中，会解析压缩包中的符号链接，并将压缩包中包含的 payload 写入到符号链接指向的目标文件，从而覆盖该文件。
5.  攻击者可以通过覆盖敏感文件来达到恶意目的，例如：
    *   覆盖 `.bashrc` 文件，在用户下次登录时执行恶意命令。
    *   覆盖 `~/.ssh/authorized_keys` 文件，添加攻击者的 SSH 公钥，从而实现未授权访问。
    *   覆盖其他配置文件，篡改系统行为。

根据搜索结果，该漏洞已经被公开披露，并且已经有相关的漏洞利用信息可用。这进一步证实了该漏洞的有效性。

**项目地址:** [hunters-sec/CVE-2025-55188-7z-exploit](https://github.com/hunters-sec/CVE-2025-55188-7z-exploit)

**漏洞详情:** [CVE-2025-55188](https://nvd.nist.gov/vuln/detail/CVE-2025-55188)