## CVE-2022-46604-Responsive FileManager 远程代码执行

**漏洞编号:** CVE-2022-46604

**漏洞类型:** 文件上传漏洞

**影响应用:** Responsive FileManager

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 9.9.5

**利用条件:** 需要认证（登录），并且有上传文件的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-46604 存在于 Tecrail Responsive FileManager 9.9.5 及以下版本中。攻击者可以绕过文件扩展名检查机制，上传精心构造的 PHP 文件，从而导致任意代码执行。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞已被确认存在并被利用。漏洞利用代码仓库的存在也表明 POC 是可用的。

**投毒风险：**

提供的漏洞利用代码仅包含一个 README.md 文件，其中只有关于漏洞本身的描述。没有实际的攻击代码，因此投毒的概率较低。但是，由于存在其他包含利用代码的仓库，使用者需要谨慎，从可信的来源获取代码，并仔细审查代码内容。给出 10% 投毒风险评估，主要是基于无法确认所有相关仓库内容，存在被恶意修改的风险。

**利用方式：**

1.  **漏洞描述：** Responsive FileManager 在处理上传文件时，对文件扩展名的验证存在缺陷，允许攻击者上传包含恶意代码的文件。
2.  **利用步骤：**
    *   攻击者需要首先通过认证登录 Responsive FileManager。
    *   攻击者构造一个包含恶意 PHP 代码的文件，例如webshell。
    *   攻击者通过某种绕过技术（例如双扩展名、修改 Content-Type 等）绕过文件扩展名验证。
    *   成功上传包含恶意代码的文件。
    *   攻击者通过访问上传的文件，触发恶意代码执行，从而控制服务器。

根据搜索结果，已经有公开的利用脚本（Python）和利用方法。攻击者可以利用这些信息快速构建攻击payload。

**项目地址:** [CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager](https://github.com/CyberQuestor-infosec/CVE-2022-46604-Responsive-File-Manager)

**漏洞详情:** [CVE-2022-46604](https://nvd.nist.gov/vuln/detail/CVE-2022-46604)