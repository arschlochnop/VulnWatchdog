## CVE-2017-10004

**漏洞编号:** CVE-2017-10004

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** Oracle Solaris

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 10和11

**利用条件:** 需要具有高权限用户权限并已登录Solaris系统

**POC 可用性:** 否（提供的POC代码与此CVE无关）

**投毒风险:** 0%

## 详情

CVE-2017-10004是Oracle Solaris操作系统中的一个内核漏洞，允许高权限的本地攻击者完全控制系统。根据漏洞信息，该漏洞易于利用。 然而，提供的漏洞利用代码（primefaces.py）实际上是针对PrimeFaces 5.x EL注入漏洞（CVE-2017-1000486）的PoC，它与Solaris内核漏洞CVE-2017-10004无关。提供的`primefaces.py`脚本利用了PrimeFaces框架中的EL（Expression Language）注入漏洞，允许攻击者执行任意代码。攻击者通过构造包含恶意EL表达式的请求，可以利用Java的JavaScript引擎执行系统命令。 

**利用方式：**

1.  攻击者需要找到运行存在漏洞的PrimeFaces 5.x的应用。
2.  通过构造包含恶意EL表达式的HTTP POST请求，向目标URL（`/javax.faces.resource/dynamiccontent.properties.<extension>`）发送payload。
3.  Payload中包含经过加密的JavaScript代码或OS命令，这些代码会被服务器端的JavaScript引擎执行。

**有效性：**

提供的PoC代码对PrimeFaces EL注入漏洞（CVE-2017-1000486）有效，但与Solaris内核漏洞（CVE-2017-10004）无关。

**投毒风险：**

分析`primefaces.py`、`payload.js`和`README.md`，未发现明显的恶意代码。脚本的功能与描述一致，即利用EL注入执行命令。`payload.js`就是一个简单的ping命令。加密函数也只是为了绕过一些安全检查。所以，投毒风险为0%。

**项目地址:** [mogwailabs/CVE-2017-1000486](https://github.com/mogwailabs/CVE-2017-1000486)

**漏洞详情:** [CVE-2017-10004](https://nvd.nist.gov/vuln/detail/CVE-2017-10004)