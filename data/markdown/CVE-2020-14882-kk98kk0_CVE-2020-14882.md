## CVE-2020-14882-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问WebLogic控制台，且目标版本存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-14882是一个Oracle WebLogic Server控制台组件中的未授权远程代码执行漏洞。攻击者可以通过构造特殊的HTTP请求，绕过身份验证，利用`com.tangosol.coherence.mvel2.sh.ShellSession` gadget执行任意代码。提供的POC代码展示了如何利用该漏洞部署冰蝎内存马。该方法首先通过双重URL编码绕过访问控制，然后使用`URLClassLoader`远程加载恶意JAR包，从而在WebLogic服务器上注入内存马，实现持久化控制。漏洞利用代码中，存在通过远程加载jar包的方式，存在一定的投毒风险，比如jar包来源不明，或者在加载过程中被篡改，因此存在一定的风险，但整体代码的目的是为了注入内存马，所以投毒风险占比不高，可能存在的风险点在于恶意jar包本身。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，可以判断该漏洞是有效的，并且存在公开的利用代码。

**投毒风险：**
POC的主要目的是部署内存马，但是通过URLClassLoader远程加载JAR包存在投毒风险，例如：

*   恶意JAR包：攻击者可能提供一个包含恶意代码的JAR包，在目标服务器上执行恶意操作。

因此，判断投毒风险占比为10%。

**利用方式：**
1.  **绕过认证：**利用`console/images/%252e%252e/console.portal`或者`console/css/%25%32%65%25%32%65%25%32%66consolejndi.portal` 类似的URL，通过双重URL编码绕过WebLogic的身份验证机制，未授权访问WebLogic控制台。
2.  **执行任意代码：** 使用`com.tangosol.coherence.mvel2.sh.ShellSession` gadget，构造恶意MVEL表达式，在服务器上执行任意Java代码。
3.  **部署内存马：** 利用`URLClassLoader`动态加载远程JAR包，该JAR包含冰蝎或其他恶意webshell的内存马代码，将其注入到WebLogic服务器的内存中，实现持久化控制。加载指定URL的恶意类，注入Filter或者Servlet类型的内存马，达到控制服务器的目的。
4.  **远程JAR包部署:** 在自己的服务器上部署恶意jar包，通过Weblogic服务器加载该jar包部署内存马。

**项目地址:** [kk98kk0/CVE-2020-14882](https://github.com/kk98kk0/CVE-2020-14882)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)