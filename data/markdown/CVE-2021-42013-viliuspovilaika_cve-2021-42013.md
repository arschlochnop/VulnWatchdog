## CVE-2021-42013 Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-42013

**漏洞类型:** Path Traversal and Remote Code Execution

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许攻击者读取任意文件和执行任意命令

**影响版本:** 2.4.49 and 2.4.50

**利用条件:** 目标服务器运行受影响的 Apache HTTP Server 版本，且启用了 CGI 脚本支持，Alias-like 指令配置不当。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42013 是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上任意文件，如果服务器配置允许执行 CGI 脚本，则可以通过构造恶意请求执行任意命令。

**有效性：**

提供的 POC 代码是有效的。搜索引擎结果和漏洞库信息均表明 CVE-2021-42013 允许路径遍历和远程代码执行，POC 代码本身也实现了利用该漏洞进行命令执行的功能。

**投毒风险：**

代码本身的功能是利用漏洞进行攻击，不属于恶意投毒代码，但是作者有可能通过其他方式进行投毒，比如修改下载链接，放置引流信息等，几率较低，大约为 5%。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含特殊字符（如`/.%%%%32%%65`，用于绕过 Apache 的路径规范化）的 URL，利用 Apache HTTP Server 在处理 Alias-like 指令时的缺陷，突破目录限制，访问服务器上的任意文件。
2.  **远程代码执行：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过路径遍历访问到 CGI 脚本的目录，然后构造包含恶意命令的请求体，利用 CGI 脚本执行任意命令。
3.  **具体步骤：**
    *   构造 URL：`{host}/cgi-bin/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/.%%%%32%%65/bin/sh`
    *   构造 POST 数据：`echo Content-Type: text/plain; echo; {command}`
    *   发送 HTTP 请求，服务器执行命令并将结果返回。

**项目地址:** [viliuspovilaika/cve-2021-42013](https://github.com/viliuspovilaika/cve-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)