## CVE-2021-32099-Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Pandora FMS

**危害等级:** 高危，允许未授权访问和权限提升

**影响版本:** 742

**利用条件:** 需要网络访问 Pandora FMS 控制台

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-32099 是 Artica Pandora FMS 742 版本中 pandora_console 组件存在的一个 SQL 注入漏洞。根据漏洞描述和搜索结果，该漏洞允许未经身份验证的攻击者通过操纵 `/include/chart_generator.php` 文件的 `session_id` 参数来升级他们的会话权限，从而绕过登录验证。提供的 POC 代码显示，通过在 `session_id` 参数中注入 SQL 语句，攻击者可以修改 session 数据，将用户身份设置为 "admin"。  

**有效性：**  
根据漏洞信息、搜索结果和 POC 代码，可以判断该漏洞的利用是有效的。POC 代码构造了一个包含 SQL 注入的 URL，用于修改 session 数据，从而实现登录绕过。

**投毒风险：**
POC本身的功能是验证漏洞，并不会引入恶意代码。`/tmp/6e3e51a32dedf3468374abbb2ba88f38/README.md` 文件中只有简单的漏洞描述和POC链接，从目前提供的信息分析，投毒风险较低，但也无法完全排除作者在其他地方隐藏恶意代码的可能性。例如，存在同作者其他仓库存在后门，诱导受害者使用。因此，给出10%的风险评估。

**利用方式：**
1.  攻击者无需身份验证。
2.  攻击者构造恶意的 URL，其中包含 SQL 注入代码，该代码位于 `/include/chart_generator.php` 文件的 `session_id` 参数中。
3.  SQL 注入代码用于更新数据库中的 session 数据，将攻击者的会话与管理员权限关联。
4.  攻击者使用被篡改的会话访问 Pandora FMS 控制台，从而获得未经授权的访问权限。

**项目地址:** [zjicmDarkWing/CVE-2021-32099](https://github.com/zjicmDarkWing/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)