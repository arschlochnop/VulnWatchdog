## CVE-2025-1974 - Ingress Nginx Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，并且ingress-nginx启用了Validating Admission Controller功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1974是一个存在于Kubernetes Ingress Nginx Controller中的远程代码执行漏洞。未经身份验证的攻击者如果可以访问Pod网络，并且目标集群启用了Validating Admission Controller，就可以通过构造恶意的Ingress配置，注入恶意的nginx配置指令到Ingress Controller中，从而执行任意代码，最终导致集群接管。漏洞利用代码通过构建一个包含反向shell payload的恶意共享对象，并使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。通过这种方式，可以加载恶意so文件作为SSL引擎，最终获取反向shell。

**有效性评估:**
根据漏洞库信息，搜索引擎结果以及提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息显示该漏洞为高危漏洞，CVSS评分高达9.8。搜索引擎结果中多篇文章都提到该漏洞的严重性，并确认了存在可用的POC。

**投毒风险评估:**
漏洞利用代码仓库中存在一定的投毒风险，但风险较低，大约为5%。主要依据是该仓库声称实现了CVE-2025-1974的利用，但部分细节描述较为含糊。poc.py中存在变量定义未完成的情况。虽然存在远程执行代码的行为，但这属于漏洞利用的正常流程。

**利用方式：**
1.  攻击者需要能够访问目标Kubernetes集群的Pod网络。
2.  目标集群的ingress-nginx需要启用Validating Admission Controller功能。
3.  攻击者构建一个包含反向shell payload的恶意共享对象（.so文件）。
4.  攻击者通过提交恶意的Ingress配置，使用`nginx.ingress.kubernetes.io/auth-url` annotation引用该共享对象。
5.  Ingress Controller加载该恶意共享对象，执行其中的反向shell payload。
6.  攻击者获得目标集群的反向shell访问权限，从而可以控制整个集群。

**项目地址:** [zwxxb/CVE-2025-1974](https://github.com/zwxxb/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)