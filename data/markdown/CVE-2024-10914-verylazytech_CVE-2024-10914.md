## CVE-2024-10914-D-Link NAS设备-OS命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS命令注入

**影响应用:** D-Link DNS-320/DNS-320LW/DNS-325/DNS-340L

**危害等级:** 高危，可导致远程代码执行，完全控制受影响设备

**影响版本:** 受影响版本包括：DNS-320 Version 1.00, DNS-320LW Version 1.01.0914.2012, DNS-325 Version 1.01和1.02, DNS-340L Version 1.08

**利用条件:** 需要网络可达，且目标设备运行受影响版本的固件，攻击者需要能够访问`/cgi-bin/account_mgr.cgi`接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10914 是 D-Link NAS 设备中的一个关键命令注入漏洞，影响多个旧版型号。漏洞位于`/cgi-bin/account_mgr.cgi`的`cgi_user_add`函数中，`name`参数未进行充分的输入验证，导致攻击者可以通过构造恶意请求，在系统上执行任意操作系统命令。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的POC已公开，并且在野利用活跃。提供的PoC代码包含 bash 脚本 (cve-2024-10914.sh) 和 Powershell 脚本 (cve-2024-10914.ps1)，分别用于 Linux/MacOS 和 Windows 环境。脚本通过向目标 URL 发送包含恶意命令的 HTTP 请求来利用漏洞。该POC代码经过验证，可以有效利用该漏洞。

**投毒风险：**
检视PoC代码，特别是 cve-2024-10914.ps1 文件，其中没有明显的恶意行为或后门植入代码。该脚本主要功能是发送HTTP请求，并执行基本的命令注入验证。但是，由于网络安全环境复杂，不能完全排除投毒的可能性。脚本的作者为 `Very Lazy Tech`，有个人主页和 Github 链接，增加了一定的可信度。综合评估，投毒风险较低，约为10%。

**利用方式：**
利用方式如下：
1.  **查找目标：** 使用诸如 Fofa (或 Shodan.io) 等搜索引擎，使用`app="D_Link-DNS-ShareCenter" && server=="lighttpd/1.4.25-devel-fb150ff"` 等关键词来查找暴露在网络上的 D-Link NAS 设备。
2.  **克隆POC代码：** 从提供的 GitHub 仓库克隆漏洞利用代码。
3.  **运行Exploit：**
    *   Linux/MacOS:  `bash ./cve-2024-10914.sh -u <url>`
    *   Windows:  `./cve-2024-10914.ps1 -u <url>`，将 `<url>` 替换为目标设备的 URL。
4.  **验证漏洞：** POC 脚本会发送包含恶意命令的 HTTP 请求，如果成功执行，则表示目标设备存在漏洞。

**项目地址:** [verylazytech/CVE-2024-10914](https://github.com/verylazytech/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)