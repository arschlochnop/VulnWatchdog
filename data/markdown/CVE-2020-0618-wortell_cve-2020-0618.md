## CVE-2020-0618 Microsoft SQL Server Reporting Services RCE Honeypot

**漏洞编号:** CVE-2020-0618

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SQL Server Reporting Services (SSRS)

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 受影响版本包括但不限于：Microsoft SQL Server 2012, 2014, 2016

**利用条件:** 需要能够访问存在漏洞的SSRS服务，通常是Web服务端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-0618是一个Microsoft SQL Server Reporting Services (SSRS) 中的远程代码执行漏洞，源于SSRS未能正确处理页面请求。该漏洞是由于.NET ViewState反序列化时未进行充分的输入验证导致的。攻击者可以利用此漏洞在服务器上执行任意代码。

**有效性评估：**
根据提供的漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的PoC（Proof of Concept）代码可用。提供的代码是一个蜜罐，旨在检测利用CVE-2020-0618的攻击尝试，而不是直接利用该漏洞。蜜罐通过模拟SSRS服务，记录所有请求，特别是那些试图触发漏洞的请求。

**利用方式：**
利用方式通常涉及构造恶意的.NET ViewState，将其作为请求的一部分发送到SSRS服务器。服务器在反序列化ViewState时，会执行攻击者预先设定的恶意代码，从而实现远程代码执行。攻击者可能需要先找到有效的ViewState，然后替换其中的部分内容，或者生成全新的恶意ViewState。

**投毒风险分析：**
该代码库主要是一个蜜罐，其目的是**检测**而非**利用**漏洞。 代码包含用于模拟SSRS服务器行为的部分，以及用于记录请求和错误的日志记录功能。 但是,仍然存在一些潜在的投毒风险，例如：

*   **虚假日志：** 攻击者可以修改日志记录部分，使其报告虚假信息，误导安全分析人员。
*   **资源消耗：** 攻击者可能修改代码，使其在接收到特定类型的请求时消耗大量资源，导致拒绝服务。

考虑到代码库的蜜罐性质和现有功能，判定投毒风险较低，但不能完全排除。 风险评估在5%。

**项目地址:** [wortell/cve-2020-0618](https://github.com/wortell/cve-2020-0618)

**漏洞详情:** [CVE-2020-0618](https://nvd.nist.gov/vuln/detail/CVE-2020-0618)