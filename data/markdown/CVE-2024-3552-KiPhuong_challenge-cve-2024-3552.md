## CVE-2024-3552-Web Directory Free-SQL注入

**漏洞编号:** CVE-2024-3552

**漏洞类型:** SQL注入

**影响应用:** Web Directory Free WordPress plugin

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 1.7.0

**利用条件:** 目标WordPress网站安装了Web Directory Free插件，且版本低于1.7.0，无需认证即可利用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3552 是 Web Directory Free WordPress 插件（版本低于 1.7.0）中的一个 SQL 注入漏洞。

**漏洞利用有效性:**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞的PoC代码是有效的。漏洞库信息明确指出存在未授权的SQL注入漏洞，搜索引擎结果也证实了该漏洞的存在，并提供了相关链接。

提供的`docker-compose.yml`文件用于搭建一个包含存在漏洞的WordPress环境，其中WordPress的版本为5.8。脚本`script.py`和`script2.py` 演示了如何利用时间盲注来提取数据库信息。

**投毒风险评估:**

经过对提供的文件进行分析，未发现明显的投毒代码。

*   `README.md`: 仅包含启动挑战的说明。
*   `docker-compose.yml`: 定义了 WordPress 和 MySQL 服务的配置，没有恶意代码。
*   `script.py`: 实现了基于时间盲注的 SQL 注入，用于提取数据库信息，本身是漏洞利用脚本。
*   `script2.py`: 也是时间盲注，用于判断表中列的数量。
*   `plugins/hello.php`: 这是 WordPress 默认的 Hello Dolly 插件，没有恶意代码。

因此，投毒风险评估为 0%。

**利用方式:**

1.  **环境搭建：** 使用 `docker-compose up` 启动包含漏洞插件的 WordPress 环境。
2.  **插件激活：** 激活 Web Directory Free 插件。
3.  **漏洞利用：**  通过向 `wp-admin/admin-ajax.php` 发送包含恶意 SQL 代码的 POST 请求，利用 `w2dc_get_map_marker_info` action 执行 SQL 注入。
4.  **信息获取：**  使用时间盲注技术（`script.py` 和 `script2.py`）从数据库中提取敏感信息，如数据库名、表名、列名和 `wp_flag` 表中的 `flag` 值。

**总而言之,此漏洞的利用方式是未授权的攻击者,通过发送恶意的http请求到WordPress站点的admin-ajax.php接口,利用时间盲注获取数据库中的敏感信息。**

**项目地址:** [KiPhuong/challenge-cve-2024-3552](https://github.com/KiPhuong/challenge-cve-2024-3552)

**漏洞详情:** [CVE-2024-3552](https://nvd.nist.gov/vuln/detail/CVE-2024-3552)