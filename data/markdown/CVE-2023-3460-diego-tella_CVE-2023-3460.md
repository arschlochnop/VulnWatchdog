## CVE-2023-3460-Ultimate Member-权限提升

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress插件

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制网站

**影响版本:** < 2.6.7

**利用条件:** Ultimate Member插件版本低于2.6.7，并且注册功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-3460是一个存在于Ultimate Member WordPress插件2.6.7之前版本的权限提升漏洞。未经身份验证的攻击者可以通过构造恶意的注册请求，创建具有管理员权限的用户账户，从而完全控制受影响的WordPress网站。

**有效性：**

提供的PoC代码似乎是有效的。它包含以下功能：

*   **版本检查：** 脚本首先检查目标站点上Ultimate Member插件的版本，如果版本低于2.6.7，则确认目标易受攻击。
*   **Nonce获取：** 脚本尝试从注册页面获取`_wpnonce`值，这是一个WordPress用于防止跨站请求伪造（CSRF）的安全令牌。然而，根据漏洞描述，该漏洞允许绕过nonce验证，所以实际利用时可能不需要。
*   **管理员账户创建：** 脚本构造一个POST请求，模拟用户注册过程，并将`wp_capabilities[administrator]`参数设置为1，从而创建一个管理员账户。

**投毒风险：**

虽然PoC的主要功能是利用漏洞，但仍存在一定的投毒风险。以下是风险评估：

*   **依赖项风险：** 该脚本依赖于requests库。虽然requests本身是一个常用的库，但是如果攻击者修改了PoC代码，引入了恶意依赖，或者利用了requests库的已知漏洞，那么可能会导致投毒攻击。虽然可能性较低，但不能完全排除。（5%）
*   **后门植入：** 攻击者可能在脚本中添加额外的代码，例如，在成功创建管理员账户后，植入一个Web Shell，方便后续的控制。（5%）

总体投毒风险评估：10%。

**利用方式：**

1.  **检查目标版本：** 使用PoC脚本检查目标WordPress站点上Ultimate Member插件的版本。
2.  **获取Nonce (可能不需要):**  PoC尝试获取nonce值，但实际利用可能不需要。
3.  **构造恶意注册请求：** 构造一个包含管理员权限的注册请求，其中`wp_capabilities[administrator]`参数设置为1。
4.  **发送请求：** 将构造好的请求发送到WordPress站点的注册页面。
5.  **创建管理员账户：** 如果漏洞利用成功，将创建一个新的管理员账户，攻击者可以使用该账户登录并完全控制网站。

**项目地址:** [diego-tella/CVE-2023-3460](https://github.com/diego-tella/CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)