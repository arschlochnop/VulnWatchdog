## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit 必须启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ISPConfig 3.2.11及更早版本的language_edit.php中。当admin_allow_langedit启用时，具有管理员权限的用户可以通过修改语言文件，利用 `records[]` 参数注入恶意的PHP代码，从而在服务器上执行任意命令。PoC利用脚本首先登录ISPConfig后台，然后通过构造包含恶意PHP代码的POST请求发送到language_edit.php，将webshell写入服务器。最后，通过webshell执行命令。投毒风险较低，主要体现在脚本在部署webshell后，交互式shell执行命令时会将响应内容与预定义的`____`标记进行比对，若输出内容不是预期格式，会输出原始响应，增加了一些分析难度。虽然有webshell上传，但是webshell的payload不是直接执行恶意代码而是创建一个命令执行的接口，给使用者更多的控制空间。

**项目地址:** [engranaabubakar/CVE-2023-46818](https://github.com/engranaabubakar/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)