## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 15.10.11, < 16.4.1, 受影响版本包括 5.3-milestone-2 及更高版本

**利用条件:** 目标XWiki实例必须存在漏洞，攻击者需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 存在于 XWiki 平台的 SolrSearch 宏中，由于输入验证不足，允许未经身份验证的攻击者执行任意 Groovy 代码。攻击者可以通过构造包含恶意 Groovy 代码的特殊 URL 来触发此漏洞。从搜索结果和漏洞库信息来看，该漏洞的严重性被评为 CRITICAL。提供的PoC代码是一个基于Bun的exploit，它接收目标URL、IP地址、端口号和命令作为参数，支持执行命令和反向shell。该POC的有效性较高，因为多个来源都确认了此漏洞的存在和可利用性。关于投毒风险，README.md 中包含免责声明，但是index.ts代码并没有提供，bun.lock 中包含一些依赖项例如chalk，figlet，ora等，这些库本身可能存在安全风险，因此存在一定的投毒可能性，预估为10%，主要风险在于项目依赖项可能被篡改，或者作者在index.ts中可能添加恶意代码。

利用方式：
1.  攻击者构造包含恶意 Groovy 代码的 URL，例如：`<host>/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20`。
2.  攻击者使用提供的 PoC 代码，指定目标 URL 和要执行的命令，或者设置反向 shell 的 IP 地址和端口号。
3.  XWiki 平台在处理 SolrSearch 宏时，由于没有正确验证输入，将执行攻击者提供的 Groovy 代码，导致远程代码执行。
4.  建议用户尽快升级到修复后的版本，或者按照漏洞库信息中的建议修改 `Main.SolrSearchMacros`。

**项目地址:** [Th3Gl0w/CVE-2025-24893-POC](https://github.com/Th3Gl0w/CVE-2025-24893-POC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)