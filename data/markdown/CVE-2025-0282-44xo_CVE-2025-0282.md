## CVE-2025-0282-Ivanti Connect Secure-Stack-based Buffer Overflow

**漏洞编号:** CVE-2025-0282

**漏洞类型:** Stack-based Buffer Overflow

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，允许远程未认证的攻击者执行任意代码。

**影响版本:** Ivanti Connect Secure <= 22.7R2.4, Ivanti Policy Secure <= 22.7R1.2, Ivanti Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 目标主机开启了 Ivanti Connect Secure, Policy Secure, 或者 Neurons for ZTA gateways服务，且攻击者可以进行网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282 是一个存在于 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中的栈溢出漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经验证的远程攻击者通过构造恶意的请求在目标系统上执行任意代码。\n\n**有效性：**\n提供的 POC 代码尝试利用该漏洞。它首先获取目标产品的版本信息，然后根据版本选择相应的内存地址偏移。POC 尝试构造溢出缓冲区，覆盖返回地址，并利用已知的代码片段 (gadgets) 来绕过安全措施并最终执行命令。漏洞利用代码中包含对版本信息的判断以及相应的gadget，存在利用成功的可能性。\n\n**投毒风险：**\n代码中存在一定的投毒风险，可能性估计为10%。虽然代码的主要逻辑是利用漏洞，但以下几点值得注意：\n1.  循环次数: 代码中有一个循环尝试利用漏洞，循环次数为 2048 次。如果利用失败，可能会对目标系统造成拒绝服务攻击，或者留下大量的临时文件。虽然`touch /var/tmp/haxor_{attempt}`本身没有危害，但大量创建会占用磁盘空间。\n2.  硬编码地址: `libdsplibs_base = 0xf6492000` 是一个硬编码的库地址。如果该地址不正确，会导致利用失败。而错误利用尝试，可能会导致服务崩溃或产生其他不可预测的结果。代码的实际效果取决于具体的环境配置。\n3.  版本检测不全:  `targets` 字典中的版本信息可能不全，如果目标版本不在字典中，利用会失败。\n4.  后门植入:  虽然代码的主要目的是执行 `touch /var/tmp/haxor_{attempt}` 命令，但攻击者完全可以修改这个命令来植入更复杂的后门。\n\n**利用方式：**\n1.  **版本检测：** 首先，POC 代码尝试通过发送 HTTP 请求到目标服务器的 `/dana-na/auth/url_admin/welcome.cgi?type=inter` 路径来获取目标产品的版本信息。\n2.  **漏洞利用：** 根据获取到的版本信息，POC 代码选择相应的偏移地址和 gadget。然后，构造一个包含恶意代码的 payload，通过 IF-T 协议发送到目标服务器。\n3.  **代码执行：** 如果 payload 成功发送到目标服务器，攻击者可以利用栈溢出漏洞覆盖返回地址，并执行恶意代码。代码中利用了 ROP (Return-Oriented Programming) 技术，通过串联多个 gadget 来绕过安全措施并执行任意命令。POC 中默认执行的命令是 `touch /var/tmp/haxor_{attempt}`，用于在目标服务器上创建一个临时文件。攻击者可以修改这个命令来执行其他操作，例如植入后门、窃取数据等。\n
**排序优先级说明:** 根据您的指示，我优先考虑了搜索结果（特别是关于在野利用的报道），然后是漏洞利用代码，最后是漏洞库信息。

**项目地址:** [44xo/CVE-2025-0282](https://github.com/44xo/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)