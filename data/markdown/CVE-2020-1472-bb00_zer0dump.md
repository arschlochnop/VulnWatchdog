## CVE-2020-1472 (Zerologon) 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，也被称为Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过将域控制器的Netlogon密码重置为零，从而冒充域控制器并接管整个域。利用方式如下：

1.  **漏洞原理：** 该漏洞源于MS-NRPC协议中使用AES加密算法时，没有正确验证初始化向量（IV）。攻击者可以发送大量精心构造的认证请求，这些请求的IV均为零。由于加密算法的特性，这会导致认证过程中的某些步骤失效，使得攻击者能够成功建立与域控制器的安全通道。
2.  **利用步骤：**
    *   使用POC工具（如Zer0Dump）连接到目标域控制器。
    *   通过修改Netlogon安全通道的密码（通常设置为全零），来利用该漏洞。
    *   利用Impacket等工具，使用已修改的密码来获取域控制器的权限。
    *   导出域用户的哈希值，或者直接执行其他恶意操作。

3.  **有效性：** 搜索引擎结果和漏洞库信息都表明此漏洞危害极大，且存在公开可用的POC代码。因此，提供的POC代码（Zer0Dump）很可能有效，可以被用于利用该漏洞。

4.  **投毒风险：** 分析提供的`psexec.py`代码，该文件是Impacket套件中的一个工具，用于在远程系统上执行命令。虽然`psexec.py`本身不是漏洞利用代码，但它可以被用于在成功利用Zerologon漏洞后，在域控制器上执行恶意代码。`README.md`提及了Zer0dump，并感谢了相关人员，看起来像是正常的漏洞利用工具说明。
    *   **潜在风险点：** `psexec.py`需要配置用户名、密码等敏感信息，如果攻击者修改了`psexec.py`，可能会加入后门，例如将输入的凭据发送到远程服务器。此外，`Zer0dump`本身也有可能存在恶意代码，但从目前的代码来看，风险较低。
   总的来说，由于`psexec.py`需要用户提供凭据，且可以被篡改，以及`Zer0dump`本身可能存在未知风险，我判断此仓库存在 10% 的投毒风险。

请注意，成功利用该漏洞后，攻击者可以完全控制域环境，因此务必及时修补该漏洞。

**项目地址:** [bb00/zer0dump](https://github.com/bb00/zer0dump)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)