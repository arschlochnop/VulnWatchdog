## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS) / 服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号劫持，敏感信息泄露，服务器端任意文件读取，甚至远程代码执行

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，或者安装了 Grafana Image Renderer 插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4123 是一个存在于 Grafana 中的 XSS 和 SSRF 漏洞。该漏洞通过结合客户端路径遍历和开放重定向实现。攻击者可以诱导用户访问包含恶意构造的 URL，从而重定向用户到攻击者控制的网站，该网站可以托管一个恶意的前端插件，执行任意 JavaScript 代码。如果启用了匿名访问，则 XSS 攻击可以直接生效。如果安装了 Grafana Image Renderer 插件，则可以通过利用开放重定向实现完整的读取 SSRF。 

**利用方式：**

1.  **XSS：** 攻击者构造包含恶意重定向的 URL，诱骗用户点击。URL 包含路径遍历序列，指向一个攻击者控制的域名。
2.  **SSRF：** 如果 Grafana Image Renderer 插件已安装，攻击者可以通过开放重定向将渲染请求重定向到任意内部或外部地址，实现 SSRF，读取敏感信息。

**POC 分析：**

*   `README.md` 提供了 FOFA 和 Shodan 的搜索语法，用于查找 Grafana 实例。同时提供了 SSRF 和 Open Redirect 的利用payload，需要替换其中的 `{OpenRedirectURL}` 和 `{website.com}`。
*   `docker-compose.yml` 用于搭建一个存在漏洞的 Grafana 环境。使用了 `grafana/grafana:11.6.0` 作为 Grafana 镜像，`grafana/grafana-image-renderer:3.10.0` 作为 Image Renderer 镜像。
*   Dockerfile没有发现任何恶意代码，主要是构建可复现的漏洞环境。

**投毒风险分析：**

代码本身主要用于搭建和复现漏洞，并无明显的恶意代码或后门，该仓库代码的投毒风险较低，约为 0%。

**项目地址:** [punitdarji/Grafana-cve-2025-4123](https://github.com/punitdarji/Grafana-cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)