## CVE-2024-21182-Oracle WebLogic Server JNDI 注入

**漏洞编号:** CVE-2024-21182

**漏洞类型:** JNDI注入

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致未经授权访问敏感数据或完全控制 Oracle WebLogic Server

**影响版本:** 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要通过 T3 或 IIOP 协议进行网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Oracle WebLogic Server 中，允许未经身份验证的攻击者通过 T3 或 IIOP 协议进行网络访问，从而导致 JNDI 注入攻击。成功利用此漏洞可能导致未经授权访问敏感数据或完全控制 Oracle WebLogic Server。POC 代码通过构造恶意的 JNDI 查询，利用`AggregatableOpaqueReference`和`MessageDestinationReference`来触发远程类加载，最终执行恶意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞被标记为容易利用，并且已存在 POC 代码。提供的 POC 代码尝试通过 T3 协议利用 JNDI 注入漏洞，创建 `AggregatableOpaqueReference` 对象，并利用反射设置其 `referent` 字段为 `MessageDestinationReference` 对象，然后通过 JNDI 绑定和查找来触发漏洞。

**投毒风险评估：**
查看 `CVE_2024_21182.java` 文件的代码，没有发现任何明显的投毒代码。该代码的功能是利用 WebLogic 的 JNDI 漏洞，并没有额外的恶意操作。因此，投毒风险为 0%。

**利用方式分析：**
1.  攻击者通过 T3 或 IIOP 协议与目标 WebLogic Server 建立连接。
2.  攻击者构造恶意的 JNDI 查询，其中包含指向恶意 LDAP 服务器的 URL（例如，ldap://192.168.xx.xx:1389/Evil）。
3.  攻击者利用 WebLogic 的 JNDI 注入漏洞，通过`AggregatableOpaqueReference`和`MessageDestinationReference`，使目标服务器从恶意 LDAP 服务器加载并执行恶意类。
4.  成功利用漏洞后，攻击者可以未经授权地访问敏感数据或完全控制 Oracle WebLogic Server。

**项目地址:** [kursadalsan/CVE-2024-21182](https://github.com/kursadalsan/CVE-2024-21182)

**漏洞详情:** [CVE-2024-21182](https://nvd.nist.gov/vuln/detail/CVE-2024-21182)