## CVE-2025-25257-Fortinet FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** Fortinet FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.10, 7.2.0 to 7.2.10, 7.4.0 to 7.4.7, 7.6.0 to 7.6.3

**利用条件:** 需要网络访问，目标存在漏洞版本的FortiWeb，未打补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个关键SQL注入漏洞，未经身份验证的攻击者可以通过构造的HTTP(S)请求利用该漏洞执行任意SQL命令，甚至远程代码执行。根据搜索结果，漏洞评分CVSS为9.6，属于高危漏洞。

**有效性分析：**

提供的PoC代码看起来有效。PoC包含漏洞检测和利用两部分，
*   `detect_vulnerability` 函数用于检测目标是否存在漏洞，通过发送包含特定payload的请求到`/api/fabric/device/status`，并解析返回的JSON数据，根据版本号判断是否存在漏洞。
*   `exploit_vulnerability` 函数尝试利用SQL注入漏洞。它首先重置表，然后通过SQL注入上传webshell，并利用chmod gadget和CGI trigger执行任意代码。

**投毒风险分析：**

代码中可能存在投毒风险。虽然代码作者声明仅用于教育目的，且修改数据库/文件系统，但在实际利用中，该PoC可以被恶意利用。以下是潜在风险点：

*   **webshell植入：** 代码会尝试在目标机器上植入webshell，这本身就是一个恶意行为，可以被用于长期控制目标系统。
*   **参数修改：**  利用代码中可进行数据库表重置和修改，这可能导致目标系统崩溃或者数据丢失。
*   **后门：**  虽然主要功能是SQL注入，作者可以在SQL注入语句中添加后门，例如创建一个具有特定权限的用户。

考虑到以上风险，POC代码的投毒风险约为10%。 代码结构清晰，未发现明显的恶意代码，风险主要来自webshell本身的利用。

**利用方式：**

1.  **漏洞检测：**  使用`detect_vulnerability`函数检测目标FortiWeb是否存在漏洞。
2.  **SQL注入：**  如果目标存在漏洞，则使用`inject_sql`函数，通过在Authorization头部构造恶意SQL语句，执行SQL注入。
3.  **webshell上传：**  利用SQL注入漏洞，将webshell上传到目标服务器的可执行目录。
4.  **RCE：**  通过CGI trigger和chmod gadget，触发webshell，执行任意代码。

**项目地址:** [adilburaksen/CVE-2025-25257-Exploit-Tool](https://github.com/adilburaksen/CVE-2025-25257-Exploit-Tool)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)