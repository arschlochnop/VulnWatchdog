## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services

**危害等级:** 严重，未经身份验证的攻击者可以远程执行代码

**影响版本:** Windows 7 SP1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1等

**利用条件:** 目标系统开启RDP服务 (默认端口3389)，且未打CVE-2019-0708补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-0708，又名BlueKeep，是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求到目标系统，从而远程执行任意代码。根据漏洞库信息，该漏洞影响包括Windows 7 SP1、Windows Server 2008 SP2和Windows Server 2008 R2 SP1等多个版本。搜索结果表明该漏洞影响范围广且危害严重，存在多个可用的利用代码。

提供的漏洞利用代码包含一个Python脚本（`cve-2019-0708_v1.py`）和一个360 RDP漏洞无损扫描器（`0708detector.exe`）。该脚本使用`0708detector.exe`进行批量扫描，判断目标主机是否存在CVE-2019-0708漏洞。脚本首先通过telnet判断目标端口3389是否开放，然后调用360的扫描器进行检测。脚本支持单个IP、CIDR格式的IP段以及IP地址文件作为目标。

**利用方式：**

1.  使用Python脚本 `cve-2019-0708_v1.py`，指定目标IP地址或IP地址列表文件。
2.  脚本首先尝试通过Telnet连接目标主机的3389端口，判断RDP服务是否开启。
3.  如果端口开放，脚本会调用360无损扫描器`0708detector.exe`对目标主机进行漏洞检测。
4.  扫描器返回结果，脚本会判断目标主机是否存在CVE-2019-0708漏洞，并将结果输出到屏幕和`result.txt`文件中。
5.  还可以使用Metasploit的 auxiliary/scanner/rdp/cve_2019_0708_bluekeep 模块进行检测。

**有效性：**

提供的POC代码，尤其是360的扫描器，主要用于检测漏洞的存在，而不是直接进行利用。根据搜索结果，存在其他可用于实际利用该漏洞的代码，但这里提供的代码主要是为了确认目标是否易受攻击。因此，该POC代码的有效性在于其检测能力。

**投毒风险：**

投毒风险较低，约为5%。

*   Python脚本 `cve-2019-0708_v1.py` 代码较为简单，主要功能是调用外部程序，没有明显的恶意代码。
*   `0708detector.exe` 是360公司提供的扫描器，虽然需要信任第三方提供的二进制文件，但根据描述其为无损扫描器，理论上不会对系统造成破坏。但仍存在被篡改的风险。建议校验MD5和SHA256值。
*   脚本中subprocess.getoutput可能存在命令注入风险，但结合脚本逻辑，风险较低。
*   脚本中没有发现明显的恶意代码，但仍需谨慎使用，避免在生产环境中直接运行未经验证的POC代码。

**项目地址:** [Pa55w0rd/CVE-2019-0708](https://github.com/Pa55w0rd/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)