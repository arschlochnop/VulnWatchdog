## CVE-2022-22978: Spring Security RegexRequestMatcher 身份验证绕过

**漏洞编号:** CVE-2022-22978

**漏洞类型:** 身份验证绕过

**影响应用:** Spring Security

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Spring Security versions 5.4.x prior to 5.4.11+, 5.5.x prior to 5.5.7+, 5.6.x prior to 5.6.4+ and all earlier unsupported versions

**利用条件:** 应用程序使用 RegexRequestMatcher 并且正则表达式中包含 `.`

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-22978 漏洞是 Spring Security 中的 RegexRequestMatcher 类的一个身份验证绕过漏洞。当应用程序使用 RegexRequestMatcher 并使用包含 `.` 的正则表达式时，攻击者可以通过在 URL 中插入换行符 (`\n` 或 `%0a`) 或回车符 (`\r` 或 `%0d`) 来绕过身份验证。这是因为默认情况下，`.` 不匹配换行符和回车符。漏洞利用代码演示了如何通过修改 URL 来绕过身份验证，从而访问受保护的资源。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，可以确认该漏洞是有效的。PoC 代码清晰地展示了如何利用该漏洞绕过身份验证。

**投毒风险分析：**
分析 PoC 代码，主要包括 `README.md` 和 `build.gradle` 两个文件。
*   `README.md` 文件包含漏洞的描述、分析、演示和使用说明，没有发现恶意代码。
*   `build.gradle` 文件是 Gradle 构建脚本，指定了 Spring Boot 和 Spring Security 的版本以及其他依赖项。其中，`ext['spring-security.version'] = '5.6.3'` 指定了存在漏洞的 Spring Security 版本，但这只是为了演示漏洞，不是投毒行为。
总体来说，该 PoC 代码的投毒风险很低，约为 1%。主要风险可能在于下载和运行第三方代码本身带来的潜在风险，但就代码本身内容而言，未发现明显的投毒迹象。

**利用方式分析：**
1.  应用程序使用 Spring Security，并配置了使用 RegexRequestMatcher 进行身份验证。
2.  RegexRequestMatcher 的正则表达式中包含 `.`。
3.  攻击者构造包含 `%0a` 或 `%0d` 的恶意 URL。
4.  应用程序错误地将恶意 URL 视为已通过身份验证，从而允许攻击者访问受保护的资源。

**项目地址:** [umakant76705/CVE-2022-22978](https://github.com/umakant76705/CVE-2022-22978)

**漏洞详情:** [CVE-2022-22978](https://nvd.nist.gov/vuln/detail/CVE-2022-22978)