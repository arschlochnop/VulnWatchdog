## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 及以上，未安装相应补丁

**利用条件:** 需要目标系统开启 IPv6 且与攻击者处于同一网络或攻击者可发送 ICMPv6 报文到目标。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞。该漏洞源于 Windows TCP/IP 协议栈在处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，没有正确处理 RDNSS 选项（递归 DNS 服务器）。攻击者可以通过发送特制的 ICMPv6 路由器通告报文，利用 Option Type 25 触发缓冲区溢出，从而导致蓝屏死机 (BSOD) 或者远程代码执行。

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断此POC代码是有效的，因为该代码能够触发蓝屏死机（BSOD）。但是否能执行任意代码取决于目标系统的具体配置和缓解措施。

**投毒风险：**
分析提供的 `bsod-poc.py` 脚本，该脚本主要用于发送精心构造的 ICMPv6 报文，以触发目标系统的漏洞。代码主要使用了 `scapy` 库来构建和发送网络报文。代码逻辑相对清晰，没有发现明显的恶意代码或者后门，因此判断投毒风险较低。

**漏洞利用方式：**
1.  攻击者首先需要确定目标系统的 IPv6 地址。
2.  攻击者使用 `scapy` 库构建一个恶意的 ICMPv6 路由器通告报文。
3.  该报文中包含一个畸形的 RDNSS 选项，特别是 Option Type 25。
4.  通过 `fragment6` 函数对报文进行分片，然后将分片后的报文发送到目标系统。
5.  目标系统接收到这些报文后，由于 TCP/IP 协议栈处理 RDNSS 选项时存在漏洞，导致缓冲区溢出。
6.  攻击者可导致目标系统蓝屏死机，可能情况下实现远程代码执行。

**总而言之，提供的POC主要目的是触发BSOD，没有发现植入恶意代码的痕迹，投毒风险为0%。**

**项目地址:** [jiansiting/cve-2020-16898](https://github.com/jiansiting/cve-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)