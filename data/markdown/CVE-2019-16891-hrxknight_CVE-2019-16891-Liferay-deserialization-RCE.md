## CVE-2019-16891-Liferay-反序列化-RCE

**漏洞编号:** CVE-2019-16891

**漏洞类型:** 反序列化漏洞

**影响应用:** Liferay Portal CE

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.2.5

**利用条件:** 需要能够向存在漏洞的Liferay Portal发送JSON payload

**POC 可用性:** 部分，需要进一步开发

**投毒风险:** 10%

## 详情

CVE-2019-16891 漏洞存在于 Liferay Portal CE 6.2.5 版本中，由于其处理 JSON payload 时存在反序列化漏洞，导致攻击者可以利用此漏洞执行远程命令。根据漏洞库信息、搜索结果，可以确认漏洞的存在和危害。提供的漏洞利用代码只有 `README.md` 文件，内容是关于漏洞的名称，不包含实际的利用代码。因此，提供的POC代码本身无效，有效性低。虽然`README.md`本身不具备投毒的能力，但考虑到攻击者可能将恶意代码伪装成文档的其他格式或在其他相关资源中进行投毒，因此存在一定风险，但风险较低。利用方式是通过构造恶意的 JSON payload，发送到存在漏洞的 Liferay Portal 服务器，触发反序列化过程，从而执行攻击者预设的恶意代码。根据搜索结果，利用可能需要Liferay账户，也可能存在无需认证的利用方式，需进一步研究。

投毒风险分析：
提供的代码仓库只包含一个README.md文件，理论上直接投毒的可能性极低。但是，不能完全排除攻击者使用以下手段进行投毒：

*   **伪装成其他文件：**  攻击者可能创建看似无害的其他类型的文件(例如图片、配置文件)，但在其中嵌入恶意代码。
*   **利用供应链攻击：**  如果该仓库被其他项目依赖，攻击者可能通过修改该仓库，间接影响依赖它的项目，造成供应链投毒。
*   **社会工程学攻击：**  攻击者可能通过其他渠道(例如论坛、邮件)散布修改过的代码，诱导用户下载并使用。

考虑到以上可能性，这里给出一个相对保守的投毒风险评估。因为目前只看到README.md文件，因此投毒风险较低，大约10%。


**项目地址:** [hrxknight/CVE-2019-16891-Liferay-deserialization-RCE](https://github.com/hrxknight/CVE-2019-16891-Liferay-deserialization-RCE)

**漏洞详情:** [CVE-2019-16891](https://nvd.nist.gov/vuln/detail/CVE-2019-16891)