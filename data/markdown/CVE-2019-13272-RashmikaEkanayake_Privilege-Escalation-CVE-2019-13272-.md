## CVE-2019-13272 Linux Kernel PTRACE_TRACEME 本地提权漏洞

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于 5.1.17

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核 5.1.17 之前的 ptrace_link 函数中，该函数在处理进程创建 ptrace 关系时，对进程凭据的记录存在问题。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve（可能允许攻击者控制），从而获得 root 权限。利用方式是使用 PTRACE_TRACEME，例如结合 Polkit 的 pkexec helper。提供的 POC 代码只是一个 README 文件，用于描述该漏洞，并没有实际的利用代码。因此，虽然漏洞本身是存在的，但提供的 POC 文件本身并不能直接利用。不过，根据搜索引擎结果，存在公开的利用代码，可以用于进行本地提权。

**有效性：** 提供的POC代码无效，仅包含漏洞描述信息，需要其他利用代码配合。

**投毒风险：** 该仓库中的 POC 代码主要是一个 README.md 文件，描述了漏洞信息。投毒风险较低，但是不能排除作者未来添加恶意代码的可能性，因此评估投毒风险为10%。需要注意的是，真正的利用代码可能会被误判为投毒代码，需要仔细分析其行为。

**利用方式：** 该漏洞的利用方式通常涉及以下步骤：
1.  利用 PTRACE_TRACEME 使目标进程成为被追踪者。
2.  通过父子进程关系以及execve调用，操控进程执行流程。
3.  利用权限验证的缺陷，提升权限，最终获取 root 权限。

搜索引擎结果显示，存在利用该漏洞的exp，可以使用该exp来验证漏洞。

**项目地址:** [RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-](https://github.com/RashmikaEkanayake/Privilege-Escalation-CVE-2019-13272-)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)