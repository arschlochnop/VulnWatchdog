## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行，敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 需要网络访问，无需用户交互

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-34102是一个存在于Adobe Commerce（Magento）的XXE漏洞。根据漏洞库信息和搜索结果，攻击者可以通过发送精心构造的XML文档，引用外部实体，从而利用此漏洞。这可能导致服务器端敏感信息泄露，甚至任意代码执行。漏洞影响的版本包括2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8及更早版本。该漏洞的CVSS评分为9.8，属于严重级别。

**有效性：** 根据搜索结果，此漏洞存在公开的利用方法，并且被广泛讨论，因此漏洞利用的有效性高。

**投毒风险：** 提供的漏洞利用代码实际上是开源软件许可证（OSL 3.0）和版权声明，并非实际的利用代码，因此没有直接的投毒代码。但是，不能排除在其他渠道获取的利用代码可能存在投毒风险。由于提供的代码仅为许可证，因此投毒风险评估为0%。

**利用方式：**

1.  **构造恶意XML文档：** 攻击者需要创建一个包含外部实体引用的恶意XML文档。这个XML文档会被发送到存在漏洞的Adobe Commerce服务器。
2.  **利用外部实体引用：** XML文档中的外部实体引用可以指向本地文件、远程URL或其他资源。攻击者可以利用这些引用来读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **信息泄露或代码执行：** 如果成功读取了敏感文件，攻击者可以获得有价值的信息，如数据库凭据、API密钥等。某些情况下，攻击者甚至可以利用XXE漏洞执行任意代码，完全控制服务器。

根据搜索结果，该漏洞的利用通常涉及读取服务器上的密钥文件，从而获得管理员权限。

**搜索引擎结果分析：**

*   多个来源（NVD, Tenable, INCIBE, Vicarius, Acunetix, Assetnote）都确认了该漏洞的存在和严重性。
*   Vicarius的博客文章（CosmicSting）详细描述了该漏洞的技术细节和潜在影响。
*   Assetnote的文章提到了嵌套反序列化在此漏洞中的作用。
*   Adobe官方发布了安全公告，建议用户尽快更新。
*   Splunk博客讨论了此漏洞的潜在影响。
*   CISA将此漏洞添加到已知被利用的漏洞列表中 (KEV)。

**项目地址:** [wubinworks/magento2-cosmic-sting-patch](https://github.com/wubinworks/magento2-cosmic-sting-patch)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)