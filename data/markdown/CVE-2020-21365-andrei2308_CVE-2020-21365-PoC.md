## CVE-2020-21365-wkhtmltopdf-目录遍历

**漏洞编号:** CVE-2020-21365

**漏洞类型:** 目录遍历

**影响应用:** wkhtmltopdf

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 0.12.5

**利用条件:** 需要wkhtmltopdf以默认配置运行，并能够加载恶意HTML文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-21365 是 wkhtmltopdf 0.12.5 及更早版本中的一个目录遍历漏洞。攻击者可以构造恶意的 HTML 文件，利用 `file:///` 协议读取本地文件。提供的 POC 代码使用 JavaScript 和 XMLHttpRequest 对象从本地文件系统中读取 `/etc/passwd` 文件。由于该代码仅包含读取文件内容的功能，没有发现任何后门或恶意代码，因此投毒风险为0%。

**有效性评估：**

根据漏洞描述和搜索引擎结果，该漏洞是有效的。POC 代码利用了 `file:///` 协议和 XMLHttpRequest 对象，可以读取本地文件。如果 wkhtmltopdf 以默认配置运行并且能够加载恶意 HTML 文件，则攻击者可以利用此漏洞读取服务器上的敏感信息，例如配置文件、私钥等。

**利用方式：**

1.  攻击者创建一个包含恶意 JavaScript 代码的 HTML 文件，该代码使用 `file:///` 协议和 XMLHttpRequest 对象读取本地文件。
2.  攻击者将此 HTML 文件提供给 wkhtmltopdf 处理。可以通过多种方式，例如，如果wkhtmltopdf被用作Web应用的一部分，用户可以上传恶意HTML文件。或者，攻击者可以诱使用户打开包含恶意HTML文件的链接。
3.  当 wkhtmltopdf 加载并执行此 HTML 文件时，JavaScript 代码将尝试读取指定的文件，例如 `/etc/passwd`。
4.  如果 wkhtmltopdf 允许此操作，则攻击者可以获取文件的内容，从而泄露敏感信息。

**缓解措施：**

*   升级到 wkhtmltopdf 的最新版本。
*   禁用或限制 wkhtmltopdf 的 `file:///` 协议访问。
*   对 wkhtmltopdf 处理的 HTML 文件进行严格的输入验证和过滤。

**项目地址:** [andrei2308/CVE-2020-21365-PoC](https://github.com/andrei2308/CVE-2020-21365-PoC)

**漏洞详情:** [CVE-2020-21365](https://nvd.nist.gov/vuln/detail/CVE-2020-21365)