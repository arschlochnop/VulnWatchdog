## CVE-2019-8978-Ellucian Banner Web Tailor-不当身份验证

**漏洞编号:** CVE-2019-8978

**漏洞类型:** 不当身份验证/竞态条件

**影响应用:** Ellucian Banner Web Tailor 和 Banner Enterprise Identity Services

**危害等级:** 高危，可能导致会话劫持和拒绝服务

**影响版本:** Web Tailor 8.8.3, 8.8.4, 8.9；Enterprise Identity Services 8.3, 8.3.1, 8.3.2, 8.4

**利用条件:** 需要目标系统使用SSO Manager认证机制，且攻击者需要知道受害者的UDCID（在某些情况下，UDCID可能是机构ID，容易获取）。受害者需要正在尝试登录。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-8978 漏洞是 Ellucian Banner Web Tailor 和 Banner Enterprise Identity Services 中存在的一个不当身份验证漏洞。该漏洞利用了在 SSO Manager 集成使用时的竞态条件。攻击者通过使用受害者的 UDCID （通常是机构ID）作为 IDMSESSID cookie 的值，并向 Banner Web Tailor 主页发送大量请求，从而尝试窃取受害者的会话。当受害者尝试登录时，攻击者可以利用竞态条件来获得分配给受害者的 SESSID，从而冒充受害者并执行未经授权的操作，例如修改课程注册、拒绝经济资助、更改个人信息等。提供的 exploit.py 代码片段表明利用方式是发送大量并发请求，这符合漏洞描述中的竞态条件利用方法。

**有效性：** 从漏洞描述和代码片段来看，该漏洞利用方法是有效的，可以通过竞争获得会话ID从而劫持用户会话。

**投毒风险：** 提供的代码片段只是exploit.py的开头部分，缺少完整上下文，无法完全评估投毒风险。但从现有的代码来看，风险较低。需要关注 `selenium` 和 `requests_threads` 库的使用情况，是否存在恶意代码注入。此外，需要注意的是，完整的exploit代码可能包含其他恶意行为，例如收集用户信息、进行恶意操作等。假设完整代码中存在潜在的恶意代码的可能性为10%。

**利用方式：**
1.  **前提条件：** 目标系统使用 SSO Manager 进行身份验证，攻击者需要知道目标用户的 UDCID，且目标用户正在尝试登录。
2.  **设置 Cookie：** 攻击者将 IDMSESSID cookie 设置为受害者的 UDCID。
3.  **发送请求：** 攻击者通过多线程或异步方式，向 Banner Web Tailor 主页发送大量并发请求。
4.  **竞态条件：** 在受害者登录过程中，攻击者利用竞态条件，尝试获取分配给受害者的 SESSID。
5.  **会话劫持：** 如果攻击者成功获得 SESSID，就可以使用该 SESSID cookie 来冒充受害者，并访问受害者账户。

**项目地址:** [SecKatie/CVE-2019-8978](https://github.com/SecKatie/CVE-2019-8978)

**漏洞详情:** [CVE-2019-8978](https://nvd.nist.gov/vuln/detail/CVE-2019-8978)