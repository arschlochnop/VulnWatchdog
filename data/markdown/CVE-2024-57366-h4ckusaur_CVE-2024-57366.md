## CVE-2024-57366 - Fisher Price 路由器远程代码执行

**漏洞编号:** CVE-2024-57366

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Fisher Price 路由器

**危害等级:** 高危，允许攻击者完全控制受影响的路由器。

**影响版本:** 未知，根据描述可能影响多个型号。

**利用条件:** 需要启用路由器的“远程控制”功能，并且需要知道管理密码，管理用户名硬编码为“admin”。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-57366漏洞存在于Fisher Price路由器中，允许通过MAC地址验证绕过和命令注入实现远程代码执行。

**漏洞利用方式：**

1.  **身份验证：** 利用代码首先尝试从路由器提取身份验证令牌。
2.  **WiFi密码重置：** 然后，它将路由器WiFi密码重置为与管理员密码匹配。
3.  **MAC地址注册：** 连接到WiFi以使用有效MAC地址在路由器上注册。
4.  **命令注入：** 漏洞利用的核心在于通过注册的MAC地址，在`/protocol.csp`端点的`mac`参数中注入恶意命令。该参数存在命令注入漏洞。
5.  **网络保持：** 漏洞利用尝试保持现有的网络连接。

**有效性评估：**

根据漏洞利用代码的描述，该漏洞利用已被证实有效，可以绕过MAC地址验证并在受影响的路由器上执行任意代码。

**投毒风险评估：**

虽然该利用代码的目标是执行远程命令，但仍然存在一定的投毒风险。风险点包括：

*   **潜在的后门安装：** 漏洞利用代码可以被修改以在路由器上安装持久性后门，允许攻击者在漏洞修复后仍然可以访问路由器。虽然给出的代码没有明确的后门，但是很容易添加。
*   **恶意软件传播：** 漏洞利用代码可以被修改以将受感染的路由器变成恶意软件传播的载体，感染连接到同一网络的其他设备。
*   **信息窃取：** 漏洞利用代码可以被修改以窃取敏感信息，例如WiFi密码，银行凭据等。

考虑到代码中包含网络连接和命令执行功能，存在被滥用于恶意目的的可能，因此，评估投毒风险为10%。需要人工review代码，才能降低投毒风险。


**项目地址:** [h4ckusaur/CVE-2024-57366](https://github.com/h4ckusaur/CVE-2024-57366)

**漏洞详情:** [CVE-2024-57366](https://nvd.nist.gov/vuln/detail/CVE-2024-57366)