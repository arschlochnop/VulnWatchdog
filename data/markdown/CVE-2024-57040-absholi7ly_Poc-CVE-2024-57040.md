## CVE-2024-57040-TP-Link路由器硬编码密码漏洞

**漏洞编号:** CVE-2024-57040

**漏洞类型:** 硬编码密码

**影响应用:** TP-Link TL-WR845N(UN)路由器

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** V4_200909, V4_190219, V4_201214

**利用条件:** 目标路由器开启SSH服务，且存在网络连通性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-57040漏洞存在于TP-Link TL-WR845N(UN) V4系列路由器中，固件版本包括V4_200909、V4_190219和V4_201214。该漏洞源于路由器中存在一个硬编码的root账户密码。攻击者可以通过网络连接到路由器，使用该硬编码的密码进行SSH登录，从而获得对路由器的完全控制权。

**有效性评估：**

根据漏洞信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出存在硬编码密码，搜索引擎结果也确认了该漏洞的存在，并提供了受影响的型号和版本。POC代码通过SSH连接尝试使用硬编码的用户名和密码进行身份验证，如果成功，则可以执行任意命令。

**投毒风险评估：**

对提供的Python代码进行分析后，发现代码主要功能是利用paramiko库通过SSH协议，使用硬编码的用户名密码连接目标路由器。主要的风险点在于：

1.  **`ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())`**:  这行代码会自动添加未知的SSH host key，可能导致中间人攻击的风险，攻击者可以伪装成目标路由器。
2.  **`shell.recv(65535).decode('utf-8')`**: 这行代码在接收shell输出时，没有对接收到的数据进行充分的安全性检查，可能存在缓冲区溢出的风险。

考虑到代码的主要功能是验证漏洞，并且没有发现明显的恶意行为，投毒风险较低，大约为10%。需要注意的是，使用该脚本时仍然存在一定的安全风险，建议在受控环境中进行测试，并注意检查目标路由器的真实性，防止中间人攻击。

**利用方式：**

1.  **确定目标：** 确定目标TP-Link TL-WR845N(UN) V4系列路由器的IP地址，并确认其固件版本在受影响范围内。
2.  **执行POC代码：** 运行提供的Python脚本，输入目标路由器的IP地址。
3.  **建立SSH连接：** 脚本会尝试使用硬编码的用户名（admin）和密码（1234）通过SSH连接到路由器。
4.  **获取控制权：** 如果连接成功，攻击者可以执行任意命令，从而完全控制路由器。

**项目地址:** [absholi7ly/Poc-CVE-2024-57040](https://github.com/absholi7ly/Poc-CVE-2024-57040)

**漏洞详情:** [CVE-2024-57040](https://nvd.nist.gov/vuln/detail/CVE-2024-57040)