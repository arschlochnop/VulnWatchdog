## CVE-2022-1386 - Fusion Builder SSRF

**漏洞编号:** CVE-2022-1386

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Fusion Builder (WordPress plugin)

**危害等级:** 高危，可能导致内网信息泄露、端口扫描、甚至远程代码执行（如果内网存在未授权的服务）

**影响版本:** < 3.6.2

**利用条件:** 目标网站使用存在漏洞的Fusion Builder插件，且存在可访问的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1386 是 Fusion Builder WordPress 插件中存在的一个未经身份验证的 SSRF 漏洞。攻击者可以通过构造恶意的 `fusionAction` 参数，发起任意 HTTP 请求。由于请求是由服务器发起的，因此可以绕过防火墙和访问控制措施，访问内部网络资源。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞影响 Fusion Builder 3.6.2 之前的版本。提供的 POC 代码利用了 `fusion_form_submit_form_to_url` action，通过修改 `fusionAction` 参数，可以控制服务器发起请求。POC 代码首先尝试获取 `fusion_id`，如果本地不存在则通过访问 `/wp-admin/admin-ajax.php` 来获取，并保存到本地文件。然后，它构造一个包含恶意 URL 的 POST 请求，发送到 `/wp-admin/admin-ajax.php`。如果目标服务器存在漏洞，服务器会向攻击者指定的 URL 发起请求，并将响应返回给攻击者。 因此，提供的POC代码应该是有效的。

**投毒风险分析：**
分析提供的`exploit.py`脚本，发现大部分代码用于构建和发送 SSRF 请求，以及处理 WordPress 的认证绕过。其中存在以下潜在的投毒风险：

1. **`make_folder()` 函数:** 创建名为 `output` 的文件夹及其子文件夹。虽然这本身不是恶意行为，但攻击者可能会利用这个文件夹来存储其他恶意文件，例如 webshell。风险较低。
2. **`save_fusion_id()` 和 `load_fusion_id()` 函数:**  用于保存和加载 `fusion_id`。 如果攻击者修改了这些函数，可能会导致程序行为异常，但不会直接构成安全威胁。 风险较低。
3. **Payload的构建:** 攻击者可能会在构造payload时引入恶意代码，例如尝试执行命令或写入文件。虽然POC本身没有展示，但是利用的时候需要注意。风险中等。

总体而言，该仓库存在投毒的可能性较低。主要是利用现有的SSRF漏洞。

**利用方式：**
1.  确定目标网站是否使用 Avada 主题和 Fusion Builder 插件，并且版本低于 3.6.2。
2.  运行 POC 代码，指定目标网站的 URL 和要访问的内部资源 (例如：`http://127.0.0.1:8080`) 作为 payload。
3.  如果漏洞存在，服务器将向指定的内部资源发起请求，并将响应返回给攻击者。
4.  攻击者可以利用此漏洞扫描内部网络，查找开放的端口和服务，或者利用内部服务中的漏洞进行进一步攻击。

**项目地址:** [satyasai1460/CVE-2022-1386](https://github.com/satyasai1460/CVE-2022-1386)

**漏洞详情:** [CVE-2022-1386](https://nvd.nist.gov/vuln/detail/CVE-2022-1386)