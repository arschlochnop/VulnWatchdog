## CVE-2024-45195-Apache OFBiz-强制浏览/远程代码执行

**漏洞编号:** CVE-2024-45195

**漏洞类型:** 强制浏览/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** < 18.12.16

**利用条件:** 需要网络访问OFBiz实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2024-45195是Apache OFBiz的一个直接请求（强制浏览）漏洞。搜索结果表明，该漏洞可能导致未经身份验证的远程代码执行。提供的漏洞利用代码包含两个文件：rcereport.csv 和 rceschema.xml。

*   **有效性：**

    漏洞利用代码利用了Apache OFBiz的数据导入功能。`rceschema.xml` 定义了一个数据文件 schema，指定如何解析 `rcereport.csv`。`rcereport.csv` 包含一个 JSP payload，该 payload 允许执行任意命令。当 OFBiz 尝试导入这个恶意数据时，JSP payload会被解析并执行，从而允许攻击者在服务器上执行任意命令。因此提供的POC代码是有效的。

*   **投毒风险：**

    `rcereport.csv` 中的 JSP 代码的功能是接收名为 `cmd` 的参数，然后使用 `/bin/sh -c` 执行该参数，并将结果输出到页面上。虽然这段代码本身就是一个后门，但它与漏洞利用直接相关，用于验证RCE，不能判定为投毒代码。`rceschema.xml` 文件定义了如何解析 CSV 文件，没有可疑之处。因此，此仓库中不存在作者隐藏的投毒代码的可能性为0%。

*   **利用方式：**

    1.  攻击者构造包含恶意 JSP payload 的 `rcereport.csv` 文件。
    2.  攻击者创建描述 CSV 文件结构的 `rceschema.xml` 文件。
    3.  攻击者利用 OFBiz 的数据导入功能上传这两个文件。
    4.  OFBiz 解析 CSV 文件，执行嵌入在 JSP 中的恶意代码。
    5.  攻击者通过 `cmd` 参数执行任意系统命令。

搜索引擎结果表明,利用方式可能与不正确的授权有关，攻击者通过发送特制请求利用该漏洞，从而获得未经授权的访问和执行命令的能力。

**项目地址:** [wyyazjjl/CVE-2024-45195](https://github.com/wyyazjjl/CVE-2024-45195)

**漏洞详情:** [CVE-2024-45195](https://nvd.nist.gov/vuln/detail/CVE-2024-45195)