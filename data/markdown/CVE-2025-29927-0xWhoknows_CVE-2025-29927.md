## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行授权校验。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。攻击者可以通过发送包含 `X-Middleware-Subrequest`  header 的恶意请求绕过中间件中的身份验证，从而访问受保护的资源。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，此漏洞的POC是有效的。漏洞利用代码尝试通过设置 `X-Middleware-Subrequest`  header 来绕过中间件。

**投毒风险：**
分析POC代码，代码主要功能是检测目标URL是否存在中间件授权绕过漏洞，并利用该漏洞尝试访问资源。代码中存在以下潜在的风险点:

*   **依赖管理：** 代码使用了`aiohttp`、`asyncio`、`aiofiles`等第三方库，如果这些库本身存在安全漏洞，或者在安装过程中被篡改，则可能引入恶意代码。
*   **结果保存：** 代码会将扫描结果保存到文件中，如果攻击者控制了文件系统，可能会篡改此文件。
*   **异常处理：** 代码中存在异常处理，但可能不够完善，某些未捕获的异常可能会导致程序崩溃或执行流程异常。
*   **扫描行为：** 大规模扫描可能被目标系统识别为恶意行为，导致IP被封禁或其他安全措施。

 综合分析，此POC代码**存在较低的投毒风险，大约为10%**。主要风险在于依赖库的安全性以及不完善的异常处理。

**利用方式：**
1.  确定目标 Next.js 应用的版本是否在受影响的范围内。
2.  扫描目标应用，发现存在中间件保护的路由。
3.  发送带有`X-Middleware-Subrequest` header的请求到目标路由，尝试绕过授权。
4.  如果返回 200 OK 状态码，则表示漏洞存在，攻击者可以访问未授权的资源。

**项目地址:** [0xWhoknows/CVE-2025-29927](https://github.com/0xWhoknows/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)