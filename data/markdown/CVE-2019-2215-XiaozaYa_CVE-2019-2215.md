## CVE-2019-2215 Android Binder Use-After-Free

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，权限提升

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络 facing 应用程序中的单独漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215 是 Android Binder 中一个 use-after-free 漏洞，允许攻击者将权限从应用程序提升到 Linux Kernel。漏洞位于`binder.c`中。根据漏洞库信息和搜索结果，利用此漏洞无需用户交互，但需要安装恶意本地应用程序或与一个网络应用程序漏洞结合利用。Project Zero 的分析表明，此漏洞已被在野利用。提供的漏洞利用代码仓库包含一个 README 文件，其中描述了测试环境和一些重要的配置选项，包括`CONFIG_SLUB_DEBUG=y`和`CONFIG_SLUB=y`，这些配置与调试和利用 slab 分配器有关。`config`文件包含内核配置信息。该代码库的目的是在模拟器上进行测试。由于 UAF 漏洞的复杂性，以及其对特定内核配置和版本的高度依赖性，此POC代码的有效性很大程度上依赖于目标环境。投毒风险评估为10%，因为提供的信息主要包含漏洞利用的环境配置说明，以及内核配置，并没有发现明显的恶意代码，只有潜在的利用过程存在一定风险。

**利用方式：**

1.  **触发漏洞：** 通过特定的 Binder 交互触发 use-after-free。
2.  **控制释放对象：** 攻击者需要控制被释放的内存对象，以便在释放后重新分配。
3.  **利用UAF：** 在对象被释放后再次访问它，从而允许攻击者修改内核内存或执行任意代码。
4.  **提权：** 通过修改内核内存，攻击者可以获得 root 权限。

**项目地址:** [XiaozaYa/CVE-2019-2215](https://github.com/XiaozaYa/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)