## CVE-2021-41773-Apache HTTP Server-路径遍历和文件泄露

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行Apache HTTP Server 2.4.49，且Alias配置存在缺陷，允许访问受限目录外的文件，并且可能开启了CGI脚本执行。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**有效性分析：**

根据漏洞库信息和搜索引擎结果，CVE-2021-41773 是 Apache HTTP Server 2.4.49 版本中存在的路径遍历漏洞，且已被公开利用。搜索引擎结果显示该漏洞允许未经验证的攻击者访问敏感信息，甚至执行任意代码。漏洞库信息也证实了这一点，并指出该漏洞允许攻击者绕过 Alias 指令配置的目录限制，访问未受 "require all denied" 保护的文件。如果目标配置允许，还可能执行 CGI 脚本。

**投毒风险分析：**

提供的“漏洞利用代码”实际上包含两个文件：README.md 和 index.html。

*   **README.md：**  只是一个简单的文本文件，描述了该漏洞和远程代码执行。
*   **index.html：** 是由 pdf2htmlEX 生成的 HTML 文件，用于显示 PDF 内容。这个HTML 文件看起来是正常的，没有任何明显的恶意代码，它的作用仅仅是将PDF转换成了HTML，并没有什么可疑的js或者链接。

因此，提供的代码仓库中**没有**发现任何明显的投毒代码。 投毒风险极低，几乎为0%的可能性

**利用方式：**

利用 CVE-2021-41773 的基本方式是通过构造包含路径遍历字符（如`..%2f`）的 URL 来访问目标服务器上的任意文件。攻击者可以尝试以下步骤：

1.  **确定目标服务器是否运行 Apache HTTP Server 2.4.49。**
2.  **尝试使用路径遍历payload访问敏感文件，例如`/../../../../etc/passwd`。** 使用URL编码来绕过一些常见的安全过滤。
3.  **如果服务器配置允许，尝试执行任意 CGI 脚本。**  这通常涉及到上传恶意脚本并使用路径遍历漏洞来访问和执行它。

**漏洞利用的关键点：**

*   **Alias配置：**  该漏洞依赖于 Apache HTTP Server 的 Alias 指令配置不当。
*   **权限控制：**  被访问的文件必须没有受到 "require all denied" 的保护。
*   **CGI支持：**  如果开启了 CGI 支持，则可能导致远程代码执行。

**项目地址:** [jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773](https://github.com/jkska23/Additive-Vulnerability-Analysis-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)