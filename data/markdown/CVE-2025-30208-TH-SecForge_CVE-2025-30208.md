## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite 开发服务器需要通过 `--host` 或 `server.host` 暴露到网络，且目标Vite版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30208 漏洞允许未经身份验证的攻击者通过构造包含 `?raw??` 或 `?import&raw??` 的特殊 URL，绕过 Vite 服务器的 `server.fs.deny` 限制，读取服务器上的任意文件。该漏洞存在于 Vite 的 `transformMiddleware` 中，由于对 URL 查询字符串的处理不当导致。利用方式：攻击者构造包含 `?raw??` 或 `?import&raw??`的URL，例如 `http://target:port/@fs/../../../../etc/passwd?raw??`，如果目标服务器存在漏洞，则服务器会将 `/etc/passwd` 文件的内容返回给攻击者。

**POC代码分析：**
提供的Python POC代码框架完整，具备如下功能：
*   目标验证：验证目标主机和端口的有效性。
*   代理支持：支持通过代理服务器进行请求。
*   请求重试：具有请求重试机制，增强了脚本的稳定性。
*   Payloads管理：从`payloads.py`和`sensitive_files.py`导入Payloads，便于扩展。
*   错误处理：包含详细的错误处理机制

**投毒风险分析：**
通过对提供的部分POC代码的分析，未发现明显的恶意代码，但仍存在潜在的投毒风险：
*   `payloads.py` 和 `sensitive_files.py`文件内容未知，存在植入恶意Payloads的风险，例如包含反弹shell的JavaScript代码，一旦读取到客户端浏览器中执行，可能导致远程代码执行。虽然目前只涉及到文件读取，但如果`payloads.py`被篡改，风险会显著增加。
*   该PoC依赖于远程payloads，存在一定的风险，如果攻击者修改了payloads，可能会导致意料之外的结果，因此投毒风险为10%。

**项目地址:** [TH-SecForge/CVE-2025-30208](https://github.com/TH-SecForge/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)