## CVE-2025-22457-Ivanti Connect Secure-堆栈缓冲区溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 堆栈缓冲区溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** 受影响版本：Ivanti Connect Secure 22.7R2.6之前, Ivanti Policy Secure 22.7R1.4之前, Ivanti ZTA Gateways 22.8R2.2之前

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure、Policy Secure 和 Neurons for ZTA gateways 中存在的堆栈缓冲区溢出漏洞。远程未经身份验证的攻击者可以通过发送特制的请求利用此漏洞实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2025-22457是一个关键漏洞，已被积极利用。 搜索结果表明，多个安全机构（如Mandiant、Rapid7、CISA）都发布了关于该漏洞的报告，并确认了该漏洞在野外被利用的事实。提供的PoC代码包括Python脚本和Metasploit模块，表明该漏洞具有较高的可利用性。 然而，需要注意的是，watchtowr.labs的搜索结果中提到利用X-Forwarded-For头可能不可行（受限于字符）。 但总体上，由于存在公开可用的PoC和在野利用报告，漏洞的有效性较高。

**投毒风险分析：**
提供的PoC下载链接指向一个短链接（bit.ly），这本身就存在一定的风险，因为无法直接确定链接指向的文件的真实性和安全性。虽然PoC说明中声明“yet no public exploit is developed/disclosed and most probably it wont in near future cause of the impact.”暗示PoC的稀缺性,存在钓鱼嫌疑，但是根据CISA的报告该漏洞已经被利用，所以这一句话的可信度需要降低。
README.md文件内容表明包含Python脚本和Metasploit模块，增加了分析复杂性。因为Metasploit模块可能包含复杂恶意载荷，通过分析短链接的下载链接（若可获得）和详细的代码行为分析可以较为准确判断投毒风险，但目前信息有限。假设下载的文件中存在被篡改的代码，例如植入后门或恶意载荷，则存在投毒风险。但鉴于该漏洞影响较大且在野利用，公开的PoC很可能已经被安全研究人员分析过，因此投毒代码被发现的可能性较高。综合考虑，给出60%的投毒风险评估。

**利用方式：**
该漏洞是堆栈缓冲区溢出，攻击者通过发送特制的网络请求，导致缓冲区溢出，覆盖堆栈上的返回地址或其他关键数据，从而劫持程序的控制流，最终执行任意代码。PoC利用可能涉及到以下步骤：

1.  发送包含恶意payload的HTTP请求，通常利用`X-Forwarded-For` header (但根据一部分搜索结果该方式可能不可行，具体情况需要进一步验证)。
2.  Payload溢出堆栈缓冲区，覆盖返回地址。
3.  返回地址被替换为攻击者控制的地址，指向 shellcode 或 ROP 链。
4.  执行 shellcode 或 ROP 链，实现远程代码执行。

由于此漏洞无需身份验证，攻击者可以远程直接发起攻击。

**项目地址:** [N4SL1/CVE-2025-22457-PoC](https://github.com/N4SL1/CVE-2025-22457-PoC)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)