## CVE-2024-38063 - Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, 以及Windows Server 2008至2022的多个版本。具体版本范围参见漏洞库信息。

**利用条件:** 需要目标系统启用IPv6，且攻击者能够发送网络数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38063 是一个Windows TCP/IP 协议栈中的远程代码执行漏洞。根据搜索结果，该漏洞影响启用了IPv6的Windows系统。攻击者可以通过发送特制的IPv6数据包来触发漏洞，从而在目标系统上执行任意代码。漏洞利用代码通过 scapy 库构造包含特制的IPv6扩展头（Destination Options Header 和 Fragment Header）的数据包序列。这些数据包被设计用于触发内核中的整数下溢或其他内存损坏，从而实现远程代码执行。

**漏洞利用方式：**
1.  攻击者需要确定目标系统的IPv6地址和MAC地址。
2.  使用 scapy 库构造一系列包含恶意IPv6扩展头的数据包，包括 Destination Options Header 和 Fragment Header。
3.  将这些数据包发送到目标系统。恶意的数据包会触发Windows内核TCP/IP协议栈中的漏洞。
4.  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。

**投毒风险评估：**
代码中存在轻微的投毒风险，大约为5%。因为`Documentation.md` 文档中存在不完整的方法定义，但是缺少方法体，可能造成误导。
代码中，涉及网络接口、IPv6地址、MAC地址、发送数据包数量和批次的设置，这些参数如果被恶意修改或用于非授权目标，可能被错误利用。但是整体代码的逻辑和功能与漏洞描述和PoC目的相符，没有发现明显的恶意代码或后门。

**项目地址:** [Dragkob/CVE-2024-38063](https://github.com/Dragkob/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)