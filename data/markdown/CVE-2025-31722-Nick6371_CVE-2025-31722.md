## CVE-2025-31722-Jenkins Templating Engine Plugin-代码注入

**漏洞编号:** CVE-2025-31722

**漏洞类型:** 代码注入

**影响应用:** Jenkins Templating Engine Plugin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 2.5.3

**利用条件:** 需要Jenkins的Item/Configure权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31722 存在于 Jenkins Templating Engine Plugin 2.5.3 及更早版本中。由于在文件夹中定义的库不受沙箱保护，攻击者如果具有 Item/Configure 权限，则可以在 Jenkins 控制器 JVM 的上下文中执行任意代码。

**有效性:**
提供的POC代码 `/tmp/95b2206dbb65627a9fda75710942c5df/vars/demo-exploit.groovy` 只是一个简单的打印语句，用于演示目的，**本身不具备直接的漏洞利用能力**。它仅显示了可以在 Jenkins 控制器 JVM 上下文中执行代码的可能性。真正的利用需要构造更复杂的 Groovy 脚本来执行恶意操作。

**投毒风险:**
当前提供的 POC 代码十分简单，只包含一个警告打印，因此**不存在明显的投毒风险 (0%)**。 除非在其他地方存在依赖关系, 或者该Demo是更高一级的Payload 的其中一部分。

**利用方式:**
1.  攻击者需要具备 Jenkins 的 Item/Configure 权限。
2.  攻击者在Jenkins中创建一个使用Jenkins Templating Engine Plugin的项目或修改现有项目。
3.  攻击者将包含恶意代码的 Groovy 脚本（例如，通过定义在文件夹中的库）注入到模板中。
4.  由于这些库不受沙箱保护，当 Jenkins 构建项目时，恶意 Groovy 脚本将在 Jenkins 控制器 JVM 的上下文中执行任意代码，例如安装后门，执行系统命令等。

**总结：**
尽管提供的 POC 代码本身不具备直接的攻击能力，但它揭示了漏洞的存在，并展示了攻击者如何利用该漏洞在 Jenkins 服务器上执行任意代码。利用的关键在于绕过沙箱保护，并注入恶意的 Groovy 脚本。

**项目地址:** [Nick6371/CVE-2025-31722](https://github.com/Nick6371/CVE-2025-31722)

**漏洞详情:** [CVE-2025-31722](https://nvd.nist.gov/vuln/detail/CVE-2025-31722)