## CVE-2019-1010298 (与CVE-2019-10102相关)

**漏洞编号:** CVE-2019-10102

**漏洞类型:** 不安全通信/中间人攻击 (基于CVE-2019-10102描述)

**影响应用:** JetBrains Ktor framework (可能影响相关应用)

**危害等级:** 中危，可能允许中间人攻击窃取构建过程中的凭据或替换artifact。

**影响版本:** < 1.1.0

**利用条件:** 构建系统使用HTTP连接解析artifact依赖，且攻击者能够进行中间人攻击。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-10102描述了JetBrains Ktor framework在构建过程中使用HTTP连接解析artifact依赖的问题，这使得中间人攻击成为可能。攻击者可以拦截HTTP流量，并替换artifact或窃取构建过程中使用的凭据。

提供的代码`CVE-2019-1010298`似乎是与OP-TEE相关的漏洞，与CVE-2019-10102本身描述的漏洞没有直接关系，容易混淆。基于`README.md`中提到的`OP-TEE-2018-0011`和其链接，这实际上指向的是OP-TEE操作系统中的一个漏洞（具体参考[https://github.com/OP-TEE/optee_os/issues/2268](https://github.com/OP-TEE/optee_os/issues/2268)）。此POC代码用于在OP-TEE环境下利用`TA_ASYMM_VERIFY`命令进行测试，验证签名过程。利用方式涉及TEE客户端与TA的会话建立以及命令调用。

**有效性：**
虽然提供的代码与CVE-2019-10102描述的Ktor框架漏洞无关，但其本身作为一个OP-TEE漏洞利用的POC是有效的，如果在存在该漏洞的OP-TEE环境下编译和运行，预计可以触发预期的行为。

**投毒风险：**
 代码中没有明显的投毒迹象。它是一个相对简单的POC，主要目的是演示如何在OP-TEE环境下调用TA进行签名验证。然而，由于代码涉及底层系统调用，如果被恶意修改，可能会导致安全问题。但就目前提供的代码而言，直接植入后门的可能性较低。但无法保证作者未来是否加入恶意的代码，因此，将投毒风险设置为5%。

**利用方式：**
CVE-2019-10102（Ktor框架漏洞）的利用方式是中间人攻击。攻击者需要能够拦截构建系统的HTTP流量，然后替换artifact或窃取凭据。

`CVE-2019-1010298`(OP-TEE漏洞)的利用方式：首先，需要在支持OP-TEE的环境中编译和运行host程序。host程序会与TA建立会话，并通过`TEEC_InvokeCommand`调用`TA_ASYMM_VERIFY`命令进行签名验证。

**项目地址:** [RKX1209/CVE-2019-1010298](https://github.com/RKX1209/CVE-2019-1010298)

**漏洞详情:** [CVE-2019-10102](https://nvd.nist.gov/vuln/detail/CVE-2019-10102)