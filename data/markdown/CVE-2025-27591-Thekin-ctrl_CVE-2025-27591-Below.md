## CVE-2025-27591-Below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** Below

**危害等级:** 高危，可能导致本地用户提升为root权限

**影响版本:** < 0.9.0

**利用条件:** 需要本地访问权限，并且运行低于0.9.0版本的Below服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27591是一个存在于Below服务0.9.0版本之前的权限提升漏洞。该漏洞的根源在于Below服务在/var/log/below目录下创建了一个全局可写的目录，导致本地非特权用户可以通过符号链接攻击将权限提升到root。

**有效性：**
根据漏洞信息和搜索引擎结果，以及提供的POC代码，该漏洞的利用是有效的。POC代码展示了如何通过创建指向/etc/passwd的符号链接，然后触发Below服务写入日志，从而将恶意用户条目注入到/etc/passwd中，进而创建一个具有root权限的用户。

**投毒风险：**
该仓库中存在投毒代码的风险较低，大约为10%。
*   大部分代码逻辑清晰地展示了漏洞利用过程，包括创建符号链接、触发服务、写入payload和检查注入结果。这些都是漏洞利用的必要步骤。
*   代码中存在sudo调用，可能会有潜在的风险。 
*   该漏洞利用的目的是为了创建一个root用户,这可以认为是验证POC的后门代码。

**利用方式：**
1.  **创建符号链接：** 利用os.symlink()函数，创建一个名为error_root.log的符号链接，指向/etc/passwd文件。由于/var/log/below目录是全局可写的，非特权用户可以创建此符号链接。
2.  **触发服务：** 使用subprocess.run()函数调用/usr/bin/below record，触发Below服务向/var/log/below/error_root.log（实际为/etc/passwd）写入日志信息。这会将恶意用户条目追加到/etc/passwd文件中。
3.  **写入Payload：** 将恶意用户条目写入到/etc/passwd中,完成用户的添加。
4.  **检查注入结果：** 验证恶意用户是否成功添加到/etc/passwd文件中。
5.  **Spawn root shell：** 利用新创建的root用户登录系统。

**项目地址:** [Thekin-ctrl/CVE-2025-27591-Below](https://github.com/Thekin-ctrl/CVE-2025-27591-Below)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)