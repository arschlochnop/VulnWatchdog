## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** < 6.23

**利用条件:** 用户需要使用受影响版本的WinRAR打开恶意的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前版本中的代码执行漏洞。攻击者可以通过构造特制的ZIP压缩包来利用此漏洞。该ZIP压缩包包含一个良性文件（如.jpg）和一个同名文件夹，该文件夹内包含恶意可执行文件（如.cmd或.exe）。当用户尝试通过WinRAR打开良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码。从搜索引擎结果和漏洞库信息可以看出，此漏洞在野外已被积极利用。提供的POC代码`exploit.py`通过创建包含恶意脚本的同名文件夹，并将良性文件和恶意脚本复制到相应位置，然后替换文件名中的占位符来生成恶意的RAR压缩包。该压缩包在旧版本 WinRAR 中打开时，会执行恶意脚本。从提供的代码来看，`exploit.py` 只是生成恶意的zip压缩文件，不包含任何后门或者其他恶意代码，`script.bat`只是简单的调用`calc.exe`弹出计算器程序，同样不包含投毒代码。因此，该仓库中不存在作者隐藏的投毒代码的风险。

**利用方式：**

1.  攻击者构造一个恶意的ZIP压缩包，其中包含一个良性文件（例如，`document.pdf`）和一个同名文件夹（例如，`document.pdf`）。
2.  在同名文件夹中，攻击者放置恶意可执行文件（例如，`document.pdf.cmd`或`document.pdf.exe`）。
3.  攻击者诱骗受害者使用受影响版本的WinRAR打开此ZIP压缩包。
4.  当受害者尝试打开良性文件时，WinRAR会错误地执行同名文件夹中的恶意代码，从而导致任意代码执行。

**项目地址:** [HDCE-inc/CVE-2023-38831](https://github.com/HDCE-inc/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)