## CVE-2025-24085 - Core Media Privilege Escalation

**漏洞编号:** CVE-2025-24085

**漏洞类型:** Use-After-Free Privilege Escalation

**影响应用:** Apple iOS, iPadOS, macOS, tvOS, watchOS, visionOS

**危害等级:** 高危，可导致提权至root，完全控制设备，数据窃取，甚至设备变砖

**影响版本:** < 18.3 (iOS & iPadOS), < 15.3 (macOS), < 18.3 (tvOS), < 11.3 (watchOS), < 2.3 (visionOS)

**利用条件:** 受害者需要接收并处理恶意构造的PNG图像，通常通过iMessage，无需用户交互（Zero-Click）。需要目标设备运行受影响的操作系统版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24085是一个存在于Apple Core Media框架中的use-after-free漏洞，可被利用进行权限提升。根据漏洞信息、搜索结果以及提供的漏洞利用代码（Glass Cage），漏洞利用方式如下：

1.  **恶意PNG图像创建：** 攻击者创建一个特制的PNG图像，该图像包含恶意的HEIF负载和畸形的EXIF字段，用于触发`ATXEncoder`中的堆损坏。
2.  **Silent触发：** 通过iMessage发送恶意PNG图像。`MessagesBlastDoorService`会自动处理接收到的文件，无需用户交互。
3.  **远程代码执行（RCE）：** 通过WebKit漏洞（CVE-2025-24201）实现RCE。该漏洞与CVE-2025-24085一起构成完整的攻击链。
4.  **沙箱逃逸：** WebKit绕过资源隔离，访问私有资源。
5.  **权限提升：** 利用Core Media的use-after-free漏洞（CVE-2025-24085）获得内核访问权限，该漏洞会利用`mediaplaybackd`、`codecctl`和`IOHIDInterface`。
6.  **持久化和破坏：** 注入恶意守护进程通过`launchd`，劫持网络通过`wifid`，通过修改IORegistry值来使设备变砖。

**有效性：**
提供的POC代码（`poc/malicious_png_generator.py`）旨在生成触发漏洞的恶意PNG图像。根据描述，此漏洞利用链（Glass Cage）已经在野外被发现并利用，因此提供的POC代码具有很高的有效性。

**投毒风险：**
虽然提供的自述文件没有明显的投毒迹象，但需要注意的是，`poc/malicious_png_generator.py`脚本本身就具有潜在风险。 攻击者可能会修改该脚本，添加额外功能，例如，在成功利用漏洞后，偷偷安装后门程序或收集敏感信息。 由于无法直接审查脚本代码，因此将投毒风险评估为10%。 这主要考虑了以下因素：
    *   自述文件仅提供了利用漏洞的总体描述，实际的漏洞利用代码可能包含隐藏的恶意功能。
    *   攻击者可能会利用人们对POC代码的信任，在代码中添加难以察觉的后门。

总体而言，虽然此POC代码能够重现该漏洞，但在使用时务必谨慎，并在受控环境中运行，以避免潜在的风险。

**项目地址:** [JGoyd/glass-cage-ios18-cve-2025-24085-cve-2025-24201](https://github.com/JGoyd/glass-cage-ios18-cve-2025-24085-cve-2025-24201)

**漏洞详情:** [CVE-2025-24085](https://nvd.nist.gov/vuln/detail/CVE-2025-24085)