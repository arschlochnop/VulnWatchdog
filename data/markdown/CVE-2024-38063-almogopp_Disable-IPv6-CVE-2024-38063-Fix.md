## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞缓解脚本

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行漏洞缓解

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本见CVE信息

**利用条件:** 需要目标系统存在IPv6网络配置

**POC 可用性:** 部分（缓解脚本非完整POC）

**投毒风险:** 10%

## 详情

CVE-2024-38063是一个Windows TCP/IP远程代码执行漏洞，允许攻击者通过发送特制的IPv6数据包在目标系统上执行任意代码。该漏洞影响多个Windows版本。从搜索引擎结果来看，这是一个高危漏洞，多个安全厂商都发布了相关的分析和缓解措施。提供的漏洞利用代码实际上是一个PowerShell脚本，用于禁用IPv6以缓解此漏洞，而并非直接利用漏洞的PoC。脚本的工作原理是通过修改注册表来禁用IPv6功能。由于禁用IPv6可能影响某些网络功能，因此不建议长期使用此方法，而应尽快安装微软官方补丁。虽然该脚本主要目的是缓解漏洞，但仍存在一定的投毒风险，主要体现在以下几点：

1.  **修改注册表的潜在风险：** 脚本会修改Windows注册表，如果脚本被恶意修改，可能导致系统不稳定或损坏。
2.  **依赖外部命令：** 脚本调用了`reg.exe`，如果`reg.exe`被替换为恶意程序，可能导致恶意代码执行。
3.  **默认路径问题：** 脚本中使用了`C:\Path\To\DisableIPv6.reg`作为默认路径，如果用户没有修改这个路径，可能会导致脚本运行失败或者将注册表文件保存在不安全的位置。
4.  **脚本执行权限：** 脚本需要管理员权限才能执行，如果攻击者欺骗用户运行恶意修改后的脚本，可能会获取系统控制权。

尽管存在上述风险，但从代码本身来看，该脚本的主要功能是禁用IPv6，因此投毒风险相对较低，约为10%。需要注意的是，在运行任何来自不可信来源的脚本之前，务必仔细审查代码，并确保了解其功能和潜在风险。

**漏洞利用方式：** 攻击者发送特制的IPv6数据包到存在漏洞的Windows系统，触发TCP/IP协议栈中的整数下溢漏洞，导致远程代码执行。缓解方式是禁用IPv6或安装微软发布的补丁。

**项目地址:** [almogopp/Disable-IPv6-CVE-2024-38063-Fix](https://github.com/almogopp/Disable-IPv6-CVE-2024-38063-Fix)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)