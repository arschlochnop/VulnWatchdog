## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于Jenkins CLI命令解析器存在缺陷，未禁用参数扩展功能。攻击者可以利用`@`字符后跟文件路径的方式，让Jenkins读取服务器上的任意文件。根据漏洞描述，攻击者无需认证即可利用此漏洞读取文件内容。提供的POC脚本`scraping.py`的工作方式是：

1.  **下载Jenkins CLI:** 脚本首先尝试从目标Jenkins服务器下载`jenkins-cli.jar`，如果本地不存在的话。
2.  **读取字典:** 然后，它读取一个字典文件（由`-l`参数指定），该文件包含要尝试读取的文件路径或目录名（作为`/var/jenkins_home/{variable}`的一部分）。
3.  **构造并执行命令:**  对于字典中的每一个条目，它构建一个Jenkins CLI命令，该命令利用`connect-node`命令和`@`字符来尝试读取文件。例如，如果字典文件包含`/etc/passwd`，则构造的命令将是`java -jar jenkins-cli.jar -s <jenkins_url> connect-node "@/var/jenkins_home//etc/passwd"`。
4.  **检查错误并保存输出:** 脚本执行此命令，并检查标准错误输出中是否包含“ERROR: No such file”。 如果没有出现此错误，则假定读取成功，并将命令和标准输出写入到输出文件（由`-o`参数指定）。

**有效性:**  根据漏洞信息和POC代码，此POC应有效，只要目标Jenkins实例的版本易受攻击，并且攻击者可以访问Jenkins CLI接口。搜索结果中多个网页都表明了该漏洞的存在和利用方式。

**投毒风险:**  该代码的主要功能是扫描并尝试读取文件。虽然代码本身没有明显的恶意功能（如执行任意代码），但如果使用者不小心，可能会意外地将敏感信息泄露到输出文件中。 然而，**代码本身不包含任何故意隐藏的投毒代码**。所有操作都是明确的，因此投毒风险可以认为是**0%**。

**项目地址:** [Nebian/CVE-2024-23897](https://github.com/Nebian/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)