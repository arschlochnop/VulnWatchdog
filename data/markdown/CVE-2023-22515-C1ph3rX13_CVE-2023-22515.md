## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** Critical，未经身份验证的远程攻击者可以创建 Confluence 管理员账户并访问 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，属于 Broken Access Control。未经身份验证的攻击者可以通过发送特制的请求绕过身份验证机制，从而创建未经授权的 Confluence 管理员账户。漏洞利用方式如下：

1.  **利用方式：**
    *   攻击者首先访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` 路径，该路径用于判断 Confluence 是否完成设置。
    *   如果未完成设置（即 `setupComplete=false`），攻击者可以访问 `/setup/setupadministrator.action` 路径，创建一个新的管理员账户。
    *   POC 代码通过生成随机用户名和密码，然后使用 POST 请求将这些信息发送到 `/setup/setupadministrator.action`。
    *   创建管理员账户后，POC 代码尝试访问 `/setup/finish` 完成安装。

2.  **有效性评估：**
    *   根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞利用方式是有效的。多个来源都证实了该漏洞的存在和利用方式，并且 CISA 已将其列入已知被利用的漏洞目录。

3.  **投毒风险评估：**
    *   提供的 Go 语言 POC 代码主要功能是利用该漏洞创建管理员账户。投毒风险评估较低，但是依旧存在风险.
    *  `generateRandomString` 函数，虽然目的是生成随机用户名和密码，理论上存在被替换为恶意字符串的可能。虽然看似无害，但如果生成的用户名或密码被恶意构造，例如包含特定字符以触发后续的漏洞(例如SQL注入，虽然该CVE本身不是SQL注入), 这也是一种投毒方式。 这方面可能性评估：5%
    *  日志记录和错误处理：如果日志记录被修改，可能会隐藏攻击痕迹或者泄漏敏感信息。虽然可能性较小，但仍然需要注意。这方面可能性评估：5%
    *   总体评估：10%

4.  **结论：**
    *   CVE-2023-22515 是一个关键漏洞，需要立即修补。提供的 POC 代码可以有效利用该漏洞，但也需要仔细审查以确保其安全性。

**项目地址:** [C1ph3rX13/CVE-2023-22515](https://github.com/C1ph3rX13/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)