## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 版本 1903 和 1909, Windows Server 版本 1903 和 1909 (Server Core 安装)

**利用条件:** 目标系统开启SMB服务，且未安装KB4551762补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理特定请求时存在的一个远程代码执行漏洞。该漏洞存在于Windows 10版本1903和1909以及Windows Server版本1903和1909（Server Core安装）中。攻击者可以利用此漏洞在目标系统上执行任意代码。漏洞利用通常涉及发送特制的SMBv3数据包，触发缓冲区溢出或其他内存损坏错误。

**有效性：** 根据搜索结果，存在公开可用的PoC代码，并且已被CISA列为已知被利用的漏洞，因此该漏洞的利用是有效的。

**投毒风险：** 提供的PowerShell脚本`CVE-2020-0796-Smbv3-checker.ps1`主要用于检查和禁用SMBv3压缩，这是CVE-2020-0796的缓解措施。脚本功能包括：

1.  检查Windows版本是否受影响。
2.  检查是否安装了KB4551762补丁。
3.  检查和设置SMBv3压缩设置（启用或禁用）。

虽然此脚本本身旨在提供缓解措施而非利用漏洞，但任何脚本都存在被修改或滥用的风险。经过分析，脚本中直接包含恶意利用代码的可能性较低，主要功能集中在检测和缓解上。但仍存在一定风险，例如作者可能植入后门，允许远程修改SMBv3压缩设置。因此，投毒风险评估为10%。

**利用方式：** CVE-2020-0796 的利用方式涉及以下步骤：

1.  **目标识别：** 确定运行受影响Windows版本的系统，且未安装KB4551762补丁。
2.  **SMBv3协商：** 与目标系统建立SMB连接，并协商使用SMBv3协议。
3.  **恶意数据包发送：** 发送特制的SMBv3数据包，其中包含精心构造的压缩转换标头，利用整数溢出导致缓冲区溢出。
4.  **代码执行：** 溢出数据覆盖内存中的关键区域，从而实现任意代码执行。通常，攻击者会利用此漏洞来获得对系统的完全控制权，例如执行shellcode或安装恶意软件。

此漏洞是“蠕虫级”的，意味着它有可能在网络中自动传播，进一步加剧其威胁。

**项目地址:** [T13nn3s/CVE-2020-0796](https://github.com/T13nn3s/CVE-2020-0796)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)