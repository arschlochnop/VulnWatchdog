## CVE-2024-7120-Raisecom设备-OS命令注入

**漏洞编号:** CVE-2024-7120

**漏洞类型:** OS命令注入

**影响应用:** Raisecom MSG1200/MSG2100E/MSG2200/MSG2300

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 3.90

**利用条件:** 需要能够通过网络访问目标设备的Web界面，可能需要登录权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-7120是Raisecom MSG1200、MSG2100E、MSG2200和MSG2300 3.90版本中Web界面list_base_config.php文件存在的一个OS命令注入漏洞。攻击者可以通过操纵`template`参数来执行任意操作系统命令。

**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经公开了利用代码。提供的Python脚本`CVE-2024-7120-exploit.py`似乎是一个有效的PoC，它通过构造恶意URL，将包含操作系统命令的payload注入到`template`参数中。脚本尝试在目标服务器上写入一个包含特定字符串的HTML文件来验证漏洞是否成功利用。

**投毒风险分析：**
对提供的Python脚本`CVE-2024-7120-exploit.py`进行分析，没有发现明显的恶意代码或后门。脚本的功能相对简单，主要是构造HTTP请求来触发漏洞。但是，任何从互联网上获取的代码都存在一定的风险，建议在使用前仔细审查。

**利用方式：**
1.  **确定目标：** 找到运行受影响Raisecom设备（MSG1200、MSG2100E、MSG2200或MSG2300）3.90版本的设备。
2.  **准备PoC脚本：** 使用提供的Python脚本`CVE-2024-7120-exploit.py`。
3.  **构造Payload：** 脚本中PAYLOAD变量包含要执行的命令，默认情况下，它会在`/www/tmp/info.html`文件中写入`Hacked By Dark 07x`。可以根据需要修改PAYLOAD变量来执行其他命令。但是，应该小心使用，避免执行破坏性的命令。
4.  **运行脚本：** 运行脚本，并提供目标设备的URL作为参数。例如：`python3 CVE-2024-7120-exploit.py targets.txt`，其中targets.txt为目标URL列表。
5.  **验证漏洞：** 如果漏洞利用成功，脚本会显示成功消息，并指出包含特定字符串的HTML文件的URL。通过访问该URL可以验证命令是否已成功执行。

**缓解措施：**
*   升级Raisecom设备的固件到不受漏洞影响的版本。
*   限制对Raisecom设备Web界面的访问，只允许受信任的IP地址访问。
*   监控Raisecom设备的日志，检测是否存在异常的HTTP请求或命令执行。

**项目地址:** [jokeir07x/CVE-2024-7120-Exploit-by-Dark-07x](https://github.com/jokeir07x/CVE-2024-7120-Exploit-by-Dark-07x)

**漏洞详情:** [CVE-2024-7120](https://nvd.nist.gov/vuln/detail/CVE-2024-7120)