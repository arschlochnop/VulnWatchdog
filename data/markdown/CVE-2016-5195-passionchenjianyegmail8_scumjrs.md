## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统kernel版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是一个存在于Linux内核中的竞争条件漏洞。该漏洞存在于`mm/gup.c`文件中，由于内核在处理copy-on-write (COW) 时存在缺陷，允许本地用户利用此漏洞写入只读内存映射，从而获得提升的权限。利用方式通常涉及以下步骤：

1.  **找到一个具有写权限的文件。** 漏洞利用需要一个可以读取但通常不允许写入的文件，例如`/etc/passwd`。这个文件作为目标。
2.  **创建一个只读的内存映射。** 将目标文件映射到内存中，以只读方式进行。
3.  **触发竞争条件。**  使用`madvise`系统调用将内存区域设置为`MADV_DONTNEED`，从而强制内核重新加载内存页。同时，使用`pthread_create`创建线程，快速循环地写入目标内存地址。
4.  **利用COW机制。**  当写入发生时，由于内存映射是只读的，COW机制会创建内存页的副本。竞争条件确保写入操作与内核的COW处理同时发生，导致写入操作绕过只读保护，直接修改物理内存。
5.  **验证。** 经过一段时间的竞争后，如果成功利用了漏洞，目标文件（如`/etc/passwd`）的内容将被修改，从而提升了用户的权限。

提供的POC代码`scumjrs/README.md`表明存在漏洞利用代码，但仅从`README.md`本身无法判断漏洞利用的有效性或是否存在投毒。需要分析整个代码仓库才能确定。基于信息不完全，无法100%排除存在投毒代码的可能性。实际风险取决于代码的具体实现。

根据搜索结果，该漏洞影响广泛，并且存在大量的公开可用的POC。Red Hat和其它厂商都发布了安全公告来缓解此漏洞。CISA 已将 CVE-2016-5195 列入已知被利用的漏洞目录，表明该漏洞在野外被积极利用。


**项目地址:** [passionchenjianyegmail8/scumjrs](https://github.com/passionchenjianyegmail8/scumjrs)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)