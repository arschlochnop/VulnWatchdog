## CVE-2022-0847 Dirty Pipe 本地提权漏洞检测脚本

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户覆盖只读文件并提升权限

**影响版本:** Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102

**利用条件:** 需要在存在漏洞的Linux内核版本上运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的代码包含一个用于检测系统是否受 CVE-2022-0847 Dirty Pipe 漏洞影响的 Bash 脚本 (dpipe.sh)。

**有效性:**
脚本通过检查内核版本来判断系统是否存在漏洞。根据提供的漏洞信息，该漏洞影响 Linux Kernel < 5.16.11, < 5.15.25, < 5.10.102。脚本会提取内核版本号，并与已知的易受攻击的版本进行比较。test.sh 用于测试不同内核版本下的 dpipe.sh 的行为。

**投毒风险:**
脚本代码较为简洁，主要是进行版本比较，没有发现明显的恶意代码或后门。脚本功能单一，用于检测漏洞是否存在，不涉及敏感操作，因此投毒风险较低。

**利用方式:**
根据漏洞信息和搜索引擎结果，CVE-2022-0847 允许未经授权的本地用户覆盖只读文件。攻击者可以利用此漏洞修改 SUID 可执行文件（例如 `passwd` 命令），从而提升权限。利用步骤通常如下：

1.  利用 `pipe()` 创建一个管道。
2.  向管道写入数据。
3.  使用 `splice()` 将目标文件的数据复制到管道中，但指定一个偏移量，该偏移量对应于要覆盖文件的位置。
4.  覆盖管道中的数据，然后将其写回目标文件。

这个脚本本身是检测工具，不是漏洞利用代码，所以需要其他的利用代码来配合才能完成攻击。

**项目地址:** [basharkey/CVE-2022-0847-dirty-pipe-checker](https://github.com/basharkey/CVE-2022-0847-dirty-pipe-checker)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)