## CVE-2016-10033 - PHPMailer 远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用存在漏洞的 PHPMailer 版本，且 PHP `mail` 函数的配置允许执行外部命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2016-10033 允许远程攻击者通过构造特殊的 `Sender` 属性，在 `mail` 命令中注入额外的参数，从而执行任意代码。漏洞存在于 PHPMailer 5.2.18 之前的版本中，利用方式是构造包含 `\"` (反斜杠双引号) 的 `Sender` 属性。提供的漏洞利用代码包含多个 shell 脚本，利用了该漏洞。`exploit.sh` 通过发送包含恶意代码的 multipart/form-data 请求，在目标服务器上创建一个后门文件 `backdoor.php`，然后通过访问该文件执行任意命令。`deface.sh` 脚本与 `exploit.sh` 类似，但它创建的后门的功能是修改目标网站的首页。`legalhackers.py` 是另一个利用脚本，用于验证漏洞。投毒风险评估：该仓库中存在docker文件，可能在docker构建过程中存在投毒风险，以及脚本中创建的后门文件可能被滥用，因此存在一定的投毒风险，大约为10%。

**项目地址:** [pedro823/cve-2016-10033-45](https://github.com/pedro823/cve-2016-10033-45)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)