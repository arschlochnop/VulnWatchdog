## CVE-2021-3560 Polkit 本地提权

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，本地用户可获得Root权限

**影响版本:** polkit 0.119 及之前版本（部分已打补丁）

**利用条件:** 本地用户权限，目标系统存在未修复的Polkit漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞允许未经授权的本地用户通过操纵 D-Bus 请求绕过 Polkit 的身份验证检查，从而获得 Root 权限。提供的 Python 脚本通过检测目标系统 Polkit 版本，如果确认存在漏洞，则尝试利用该漏洞。该脚本首先检查当前用户是否为 Root 用户，然后检测操作系统信息和 Polkit 版本。根据版本信息判断是否存在漏洞。如果存在，则可以利用此漏洞获得root权限。

**有效性：**
提供的PoC代码看起来是有效的，它包含检测 Polkit 版本，检查是否为易受攻击的版本，以及进行利用的代码框架。参考链接（github.blog）也证实了该漏洞的存在以及利用方法。

**投毒风险：**
PoC代码本身逻辑清晰，主要用于检测和利用漏洞，未发现明显的恶意代码。可能的风险在于，脚本在执行某些命令时可能会受到环境变量的影响，导致执行意外的代码。脚本的目的是提升权限，因此在执行后可能留下后门或者修改系统设置，需要谨慎使用。

**利用方式：**
1.  脚本首先检测目标系统 Polkit 版本。
2.  如果版本属于易受攻击的范围，则利用漏洞绕过身份验证。
3.  利用成功后，攻击者可以执行需要 Root 权限的操作，例如创建新的管理员帐户或修改系统文件。

**项目地址:** [SeimuPVE/CVE-2021-3560_Polkit](https://github.com/SeimuPVE/CVE-2021-3560_Polkit)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)