## CVE-2020-14882-Oracle WebLogic Server 远程代码执行

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问 WebLogic Server 的 HTTP 端口，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-14882 是 Oracle WebLogic Server 中 Console 组件的一个远程代码执行漏洞。未经身份验证的攻击者可以通过 HTTP 协议利用此漏洞，完全控制 WebLogic Server。

**有效性：**
提供的 POC 代码是一个 GUI 程序，使用 QT 框架编写。通过分析 `mainwindow.cpp` 文件中的 `on_pushButton_clicked` 函数，可以看到该 POC 的工作方式：

1.  从 GUI 界面获取目标 WebLogic Server 的 URL 地址 (`ui->lineEdit->text()`) 和要执行的命令 (`ui->lineEdit_2->text()`)。
2.  构造一个包含特定 Payload 的 URL。该 Payload 旨在利用 WebLogic 的 Console 路径遍历漏洞和 JNDI 注入来执行任意代码。
3.  设置 HTTP 请求头 `CMD` 为要执行的命令。
4.  发送 GET 请求到构造的 URL。
5.  如果服务器返回 200 OK，则从响应中提取 Base64 编码的数据，进行解码，并在 GUI 界面的 `textEdit` 组件中显示结果。

根据漏洞库信息和搜索结果，此漏洞非常容易利用，并且存在公开的 POC 代码。因此，提供的 POC 代码很可能有效。

**投毒风险：**
分析提供的代码，主要的风险点在于：

1.  **远程命令执行：** 该POC允许用户在目标服务器上执行任意命令。这是漏洞本身的特性，而非作者恶意添加的代码。
2.  **GUI程序依赖：** GUI程序本身依赖Qt运行库，如果Qt库被篡改,存在一定风险。 但鉴于Qt本身较为成熟，此风险较低。
3.  **Github仓库篡改:** 通过Github仓库投毒,概率较低， 但如果有人恶意篡改仓库,存在引入恶意代码的可能.

综合考虑，该代码的投毒风险较低，大概在10%左右。 主要风险还是在于利用漏洞本身带来的远程命令执行能力。作者没有明显添加恶意代码的意图，主要的风险在于运行任意命令的潜在危害，以及GUI程序的依赖风险。

**利用方式：**
1.  攻击者获取目标 WebLogic Server 的 URL。
2.  攻击者构造包含恶意 JNDI Payload 的 URL，其中 Payload 包含要执行的命令。
3.  攻击者发送带有 `CMD` 请求头的 HTTP GET 请求到目标 URL。
4.  WebLogic Server 解析 Payload 并执行指定的命令。
5.  命令执行的结果通过 Base64 编码后作为响应返回给攻击者。
6.  攻击者解码响应，获取命令执行结果。

**项目地址:** [Ormicron/CVE-2020-14882-GUI-Test](https://github.com/Ormicron/CVE-2020-14882-GUI-Test)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)