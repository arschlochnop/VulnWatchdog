## CVE-2025-44823-Nagios Log Server-API密钥泄露

**漏洞编号:** CVE-2025-44823

**漏洞类型:** API密钥泄露

**影响应用:** Nagios Log Server

**危害等级:** 高危，可能导致权限提升和系统完全控制

**影响版本:** < 2024R1.3.2

**利用条件:** 需要已认证的低权限用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Nagios Log Server 2024R1.3.2之前的版本中。经过身份验证的用户可以通过访问`/nagioslogserver/index.php/api/system/get_users`端点，并提供一个有效的API token，从而检索到所有用户的明文API密钥，包括管理员帐户的密钥。这使得攻击者可以使用泄露的管理员密钥来执行未经授权的操作，从而完全控制系统。

**有效性：**
提供的POC代码是有效的。它使用curl命令向`/nagioslogserver/index.php/api/system/get_users`端点发送GET请求，并提供一个有效的API token作为参数。如果服务器存在漏洞，则会返回包含所有用户及其明文API密钥的JSON响应。

**投毒风险：**
查看漏洞利用代码的内容，只包含了漏洞描述、利用方法和示例。没有发现任何恶意代码或隐藏的后门。因此，投毒风险可以认为是0%。

**利用方式：**
1.  攻击者首先需要获得一个有效的Nagios Log Server用户的API token。这可以通过合法的用户帐户或通过其他漏洞获得。
2.  攻击者使用curl或其他HTTP客户端，向`/nagioslogserver/index.php/api/system/get_users`端点发送GET请求，并在请求中包含有效的API token。
3.  服务器返回一个JSON响应，其中包含所有用户及其明文API密钥。攻击者可以提取管理员帐户的API密钥。
4.  攻击者可以使用泄露的管理员API密钥来执行任何管理员权限的操作，从而完全控制Nagios Log Server系统。

**项目地址:** [skraft9/CVE-2025-44823](https://github.com/skraft9/CVE-2025-44823)

**漏洞详情:** [CVE-2025-44823](https://nvd.nist.gov/vuln/detail/CVE-2025-44823)