## CVE-2023-1698-WAGO-RCE

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO PFC100, PFC200, CC100, Edge Controller, Touch Panel 600 Standard, Advanced and Marine Line

**危害等级:** 高危，允许未授权远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统破坏

**影响版本:** <= FW22 (FW20, FW23也受影响)

**利用条件:** 需要网络访问目标WAGO PLC设备

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2023-1698是一个WAGO产品中的远程代码执行漏洞。未经身份验证的远程攻击者可以利用此漏洞创建新用户并更改设备配置，从而导致拒绝服务或完全系统入侵。

**有效性：**
提供的PoC代码 `wago_exploit.py` 旨在利用 CVE-2023-1698，通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送包含恶意命令的 POST 请求来执行任意命令。代码使用 `requests` 库发送 HTTP 请求，并通过正则表达式提取命令执行的结果。根据描述和代码结构，PoC 有效。

**投毒风险：**
PoC代码主要功能是发送包含恶意命令的payload，并提取返回结果。该代码结构相对简单，主要功能是发送恶意请求，提取结果，因此投毒风险较低。但仍存在潜在风险：

*   **依赖项投毒：** `requirements.txt` 文件中存在 `requests` 和 `colorama` 依赖。存在依赖包被恶意篡改的可能，但需要攻击者替换官方源或进行中间人攻击，概率较低。
*   **命令注入风险：** PoC允许用户自定义命令，若用户输入不当命令可能造成自身系统损害。
*   **代码逻辑混淆：** 代码中存在一定量的注释和字符串，可以隐藏恶意代码。但当前代码逻辑比较清晰，恶意代码隐藏的难度较大。

基于以上分析，投毒风险较低，约为 10%。

**利用方式：**
1.  攻击者首先需要确定目标WAGO设备的IP地址和端口。
2.  攻击者运行 `wago_exploit.py` 脚本，并指定目标设备的URL。
3.  脚本会构造一个包含恶意命令的POST请求，并将其发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 接口。
4.  目标设备执行恶意命令。
5.  脚本解析响应，提取命令执行的结果并显示给攻击者。

通过此方法，攻击者可以在目标设备上执行任意命令，包括创建新用户、更改设备配置、读取敏感信息等。

**结论：**
CVE-2023-1698 是一个严重的安全漏洞，利用门槛低，危害性高。提供的 PoC 代码可以有效地利用此漏洞。虽然投毒风险较低，但在使用任何公开的漏洞利用代码时，都应谨慎评估风险。

**项目地址:** [X3RX3SSec/CVE-2023-1698](https://github.com/X3RX3SSec/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)