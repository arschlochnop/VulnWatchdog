## CVE-2019-6447 - ES File Explorer 远程文件读取/应用执行

**漏洞编号:** CVE-2019-6447

**漏洞类型:** 远程文件读取/应用执行

**影响应用:** ES File Explorer

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 4.1.9.7.4

**利用条件:** 设备已安装 ES File Explorer 且在同一 Wi-Fi 网络下，端口59777开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-6447 漏洞存在于 ES File Explorer File Manager 4.1.9.7.4 及更早版本中。该漏洞允许位于同一 Wi-Fi 网络下的远程攻击者通过 TCP 端口 59777 发送未经过身份验证的 application/json 数据，从而读取任意文件或执行应用程序。  

**有效性分析：**

*   提供的 POC 代码 `exploit.py` 看起来有效。它通过 HTTP POST 请求向目标设备的 59777 端口发送 JSON 数据，利用该漏洞执行命令。
*   POC 代码实现了多个功能，包括列出文件、图片、视频、音频、应用等，以及下载指定文件和获取设备信息。  
*   从搜索结果来看，多个安全网站和研究论文都证实了该漏洞的存在和可利用性。

**投毒风险分析：**

*   `README.md` 文件包含漏洞描述和截图，没有发现可疑代码。
*   `exploit.py` 文件本身主要功能是利用漏洞，但需要注意以下几点：
    *   代码中使用了 `ast.literal_eval()` 函数，这在解析来自不可信来源的数据时可能存在安全风险。虽然这里解析的是 HTTP 响应，但仍然需要谨慎。
    *   代码允许下载任意文件，如果攻击者利用此功能下载恶意文件并诱导用户执行，可能造成进一步的危害。
    *   代码依赖用户提供的IP地址和文件名，如果用户不小心提供了错误的IP地址，可能会向错误的设备发送请求。
*   **综合判断投毒风险较低，约为5%。** 主要风险点在于用户可能误用该工具造成安全事件，以及`ast.literal_eval`潜在的风险。

**利用方式分析：**

1.  **确定目标设备 IP 地址：**  攻击者需要知道运行 ES File Explorer 的 Android 设备的 IP 地址，该设备必须与攻击者位于同一 Wi-Fi 网络。
2.  **发送恶意请求：**  攻击者使用 POC 代码 `exploit.py` 向目标设备的 59777 端口发送精心构造的 HTTP POST 请求，其中包含要执行的命令（例如，读取文件或列出目录）。
3.  **读取文件/执行应用：** 如果是读取文件，服务器返回文件内容，攻击者将其保存到本地。如果是执行应用，服务器执行应用。
4.  **利用方式多样：** 例如，攻击者可以下载包含敏感信息的配置文件，或者列出已安装的应用并获取其信息。

总之，该漏洞利用简单，危害较高，需要引起重视。建议用户尽快更新 ES File Explorer 到最新版本或卸载该应用。

**项目地址:** [h3x0v3rl0rd/CVE-2019-6447](https://github.com/h3x0v3rl0rd/CVE-2019-6447)

**漏洞详情:** [CVE-2019-6447](https://nvd.nist.gov/vuln/detail/CVE-2019-6447)