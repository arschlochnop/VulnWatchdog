## CVE-2025-29927-Next.js Middleware 权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了Next.js中间件进行权限校验，且存在漏洞版本的Next.js应用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 中间件的权限校验逻辑中。当应用使用 Next.js 中间件进行权限校验时，可以通过构造包含特定字符串（'admin'）的请求头（x-token）来绕过权限验证，从而访问受保护的资源。

**有效性分析：**

提供的POC代码明确地模拟了该漏洞的利用。`middleware.js` 文件中的权限校验逻辑存在缺陷，它错误地使用了 `includes()` 方法来检查 `x-token` 头是否包含 'admin' 字符串。这使得攻击者可以通过发送包含 'admin' 子字符串的任意 `x-token` 头来绕过身份验证。

`exploit.sh` 脚本演示了如何通过发送带有 `x-token: ZADMINZ` 头的请求来绕过中间件验证并访问 `/admin` 路由。

**投毒风险分析：**

此仓库的目的是为了教育演示 CVE-2025-29927 漏洞，`DISCLAIMER.md` 文件也强调了这一点。代码库本身没有发现恶意代码，例如反向 shell 或其他恶意功能。所有脚本和配置文件都用于演示和利用漏洞。

**利用方式：**

1.  目标应用必须使用存在漏洞版本的Next.js。
2.  目标应用必须使用Next.js中间件进行权限校验，且中间件的实现方式存在缺陷，例如使用了 `includes()` 方法来检查请求头。
3.  攻击者发送一个HTTP请求到受保护的路由，并在请求头中包含一个 `x-token` 头，该头的值包含 'admin' 字符串。
4.  由于中间件的错误实现，攻击者成功绕过身份验证，访问受保护的资源。

搜索引擎结果也表明了此漏洞的严重性和利用的简易性，多个文章强调了可以通过此漏洞绕过身份验证并可能导致缓存投毒。

**项目地址:** [amalpvatayam67/day10-nextjs-middleware-lab](https://github.com/amalpvatayam67/day10-nextjs-middleware-lab)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)