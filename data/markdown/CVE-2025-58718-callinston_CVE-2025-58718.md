## CVE-2025-58718: Remote Desktop Client RCE

**漏洞编号:** CVE-2025-58718

**漏洞类型:** Use-After-Free

**影响应用:** Microsoft Remote Desktop Client

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码。

**影响版本:** 受影响的版本包括 Windows 10 (1607, 1809, 21H2, 22H2), Windows 11 (22H2, 23H2, 24H2, 25H2), Windows Server (2008 SP2/R2 SP1, 2012/R2, 2016, 2019, 2022/23H2, 2025) 以及 Remote Desktop App Client的特定版本。

**利用条件:** 目标系统需要启用远程桌面并对外开放TCP 3389端口，且可能不需要身份验证即可触发。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

该漏洞是一个存在于Microsoft Remote Desktop Client的use-after-free漏洞，攻击者可以通过构造恶意的RDP数据包，在建立连接握手期间触发此漏洞。漏洞利用方式是精心构造RDP数据包以触发use-after-free，从而覆盖堆结构并执行shellcode。提供的POC利用代码包含一个反向TCP shell payload，该payload会连接回攻击者的Netcat监听器，从而允许远程访问目标系统。

**有效性评估：**
根据漏洞库信息和POC代码，该漏洞是有效的。POC代码明确说明了漏洞利用的步骤和所需条件。

**投毒风险分析：**
该POC代码的投毒风险为30%。虽然作者声明该工具仅用于授权安全测试，并提供了详细的使用说明，降低了直接恶意使用的可能性。但是，提供了一个外部链接`[href](https://tinyurl.com/yjbh9pbc)`，指向未经审计的远程代码，存在一定风险。同时，反向Shellcode连接到攻击者控制的服务器，在真实渗透测试中，可以替换为其他更隐蔽的payload。

**利用方式：**
1.  攻击者通过网络向目标系统发送特制的RDP数据包。
2.  目标系统的远程桌面客户端在处理这些数据包时触发use-after-free漏洞。
3.  攻击者通过漏洞利用覆盖内存，并注入shellcode。
4.  Shellcode执行，建立与攻击者Netcat监听器的反向TCP连接。
5.  攻击者获得目标系统的远程命令执行权限，通常具有SYSTEM权限。

**项目地址:** [callinston/CVE-2025-58718](https://github.com/callinston/CVE-2025-58718)

**漏洞详情:** [CVE-2025-58718](https://nvd.nist.gov/vuln/detail/CVE-2025-58718)