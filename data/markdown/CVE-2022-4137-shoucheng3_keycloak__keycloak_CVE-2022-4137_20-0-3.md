## CVE-2022-4137-Keycloak-Reflected XSS

**漏洞编号:** CVE-2022-4137

**漏洞类型:** Reflected XSS

**影响应用:** Keycloak

**危害等级:** 高危，可能导致用户凭据泄露和会话劫持

**影响版本:** Red Hat Single Sign-On 7.6 (受影响版本小于 0:18.0.6-1.redhat_00001.1.el*)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是，但需要构造恶意链接

**投毒风险:** 0%

## 详情

CVE-2022-4137 是 Keycloak 'oob' OAuth 端点中发现的一个反射型跨站脚本 (XSS) 漏洞，原因是错误地处理了空字节。攻击者可以构造包含恶意 JavaScript 代码的 URL。当用户点击这个恶意链接时，Keycloak 的错误页面会渲染这个恶意代码，从而导致 XSS 攻击。此漏洞需要用户交互才能被触发，攻击者诱导用户访问构造好的恶意链接。 

**有效性:**  
根据漏洞库信息和搜索结果，此漏洞的 PoC 是可利用的，因为描述中说明了由于不正确的空字节处理，可以在 'oob' OAuth 端点注入恶意 URI 到 Keycloak 错误页面。

**投毒风险:**
提供的漏洞利用代码是 `ADOPTERS.md` 和 `CONTRIBUTING.md` 文件内容，主要描述了 Keycloak 的采用者和贡献方式，不包含任何恶意代码，因此投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，该 URL 触发 Keycloak 的 'oob' OAuth 端点的错误。
2.  攻击者诱骗受害者点击该恶意链接（例如，通过电子邮件、社交媒体等）。
3.  受害者点击链接后，Keycloak 生成包含恶意 JavaScript 代码的错误页面。
4.  受害者的浏览器执行恶意 JavaScript 代码，从而使攻击者能够执行诸如窃取 cookie、会话劫持或重定向用户到恶意网站等操作。

**项目地址:** [shoucheng3/keycloak__keycloak_CVE-2022-4137_20-0-3](https://github.com/shoucheng3/keycloak__keycloak_CVE-2022-4137_20-0-3)

**漏洞详情:** [CVE-2022-4137](https://nvd.nist.gov/vuln/detail/CVE-2022-4137)