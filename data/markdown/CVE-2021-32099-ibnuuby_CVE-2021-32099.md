## CVE-2021-32099-Artica Pandora FMS-SQL注入

**漏洞编号:** CVE-2021-32099

**漏洞类型:** SQL注入

**影响应用:** Artica Pandora FMS

**危害等级:** 高危，允许未授权用户绕过身份验证并获得管理员权限

**影响版本:** 742

**利用条件:** 目标系统运行Pandora FMS 742且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-32099是Artica Pandora FMS 742版本中pandora_console组件的/include/chart_generator.php文件存在的一个SQL注入漏洞。 

**有效性：**
提供的POC代码通过`session_id`参数注入恶意的SQL语句。该SQL语句使用`UNION SELECT`来构造一个新的结果集，该结果集包含一个伪造的`tsessions_php`表中的数据，从而将当前会话的用户ID设置为`admin`，实现登录绕过。

**投毒风险：**
该仓库主要包含漏洞的POC和描述信息，没有发现明显的恶意代码。但是，任何从公开来源获取的代码都存在一定的风险。在实际使用POC之前，建议进行代码审查，以确保其安全性。投毒风险评估为5%，主要来自于对第三方代码仓库的固有风险，以及作者可能在描述文件中加入恶意链接或者指令的可能性。

**利用方式：**
1.  攻击者向目标系统的`/pandora_console/include/chart_generator.php`发送一个包含恶意`session_id`参数的HTTP请求。
2.  恶意的`session_id`参数包含一个SQL注入payload，该payload旨在修改当前用户的会话数据，将其权限提升为管理员。
3.  目标系统执行包含恶意代码的SQL查询，更新会话信息。
4.  攻击者刷新页面或访问需要管理员权限的功能，即可绕过身份验证，以管理员身份登录系统。

**项目地址:** [ibnuuby/CVE-2021-32099](https://github.com/ibnuuby/CVE-2021-32099)

**漏洞详情:** [CVE-2021-32099](https://nvd.nist.gov/vuln/detail/CVE-2021-32099)