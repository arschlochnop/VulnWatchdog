## CVE-2025-61156 - ThreatFire System Monitor Arbitrary Process Termination

**漏洞编号:** CVE-2025-61156

**漏洞类型:** 权限提升/拒绝服务

**影响应用:** ThreatFire System Monitor

**危害等级:** 高危，可绕过EDR，导致拒绝服务

**影响版本:** <= v4.7.0.53

**利用条件:** 需要安装存在漏洞的ThreatFire System Monitor驱动，且驱动未被微软阻止

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ThreatFire System Monitor (TfSysMon.sys) 内核模式组件中，允许攻击者利用特定IOCTL（ZWTERM_IOCTL）向驱动发送目标进程ID，从而终止任意进程，包括受保护的系统进程和反恶意软件。POC代码演示了如何获取驱动句柄，找到MsMpEng.exe（Windows Defender）的进程ID，然后通过ZWTERM_IOCTL终止该进程，实现EDR绕过和拒绝服务。代码本身没有明显的投毒迹象，主要功能是利用漏洞终止进程。漏洞利用方式为：
1.  打开设备驱动程序 `\\.\TfSysMon`。
2.  查找目标进程的进程ID（例如，MsMpEng.exe）。
3.  构造一个包含目标进程ID的`ZWTERM_STRUCT`结构体。
4.  调用`DeviceIoControl`发送`ZWTERM_IOCTL`，将构造的结构体作为输入。
5.  驱动程序接收到IOCTL后，终止指定ID的进程。

由于驱动程序签名有效且不在微软的阻止列表中，该漏洞可能被攻击者利用进行BYOVD攻击。

**项目地址:** [D7EAD/CVE-2025-61156](https://github.com/D7EAD/CVE-2025-61156)

**漏洞详情:** [CVE-2025-61156](https://nvd.nist.gov/vuln/detail/CVE-2025-61156)