## CVE-2025-29927-Next.js-Middleware 权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问、数据泄露和潜在的远程代码执行

**影响版本:** >= 11.1.4, <= 13.5.6，> 14.0.0, < 14.2.25，> 15.0.0, < 15.2.3

**利用条件:** 应用使用了Next.js中间件进行权限验证，并且未修复此漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件中存在的权限绕过漏洞。根据漏洞库信息和搜索结果，该漏洞源于 Next.js 对 `x-middleware-subrequest` 标头处理不当。攻击者可以通过操纵该标头绕过中间件中的身份验证检查，从而访问受保护的资源，如管理页面。提供的POC代码包含一个简单的 Next.js 应用，其中 `/admin` 页面受中间件保护。中间件检查是否存在名为 `token` 的 cookie，如果 token 不是 `CYBERUS`，则重定向到 `/login` 页面。漏洞利用方式是，在受影响的版本中，通过某种方式发送带有 `x-middleware-subrequest` 标头的请求，即可绕过token的验证访问`/admin`页面。考虑到仓库中包含 Dockerfile, docker-compose.yml 以及完整的Next.js项目文件，包括中间件逻辑，可以判定POC是有效的。关于投毒风险：POC代码主要用于演示漏洞，但`README.md` 中缺少清晰的利用payload和利用方式，仅提示DIEGO，增加了攻击者理解和使用的难度。这种模糊性可能被恶意利用，诱导用户修改或添加恶意代码。另外，此示例使用 Next.js 12.0.7 版本，虽然属于受影响版本，但版本较低，某些依赖可能存在已知漏洞，增加投毒的可能性。综合考虑，投毒风险较低，大概为10%。

**项目地址:** [l1uk/nextjs-middleware-exploit](https://github.com/l1uk/nextjs-middleware-exploit)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)