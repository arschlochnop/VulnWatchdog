## CVE-2024-36991 Splunk Enterprise on Windows Path Traversal

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 9.2.x (< 9.2.2), 9.1.x (< 9.1.5), 9.0.x (< 9.0.10)

**利用条件:** Splunk Enterprise 运行在Windows操作系统上，且版本为受影响版本。需要网络访问Splunk服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36991 是 Splunk Enterprise 在 Windows 平台上的一个路径遍历漏洞。攻击者可以通过 `**/modules/messaging/**` 端点构造恶意请求，读取服务器上的任意文件。根据漏洞库信息和搜索结果，此漏洞影响Splunk Enterprise的9.2.2之前的9.2版本，9.1.5之前的9.1版本以及9.0.10之前的9.0版本。

**利用方式：**

1.  攻击者构造包含路径遍历字符（如`../`）的URL，发送到 `/modules/messaging/` 端点。
2.  Splunk Enterprise 没有正确验证或过滤输入，导致可以访问受限目录之外的文件。
3.  服务器返回被请求文件的内容，导致敏感信息泄露。

**POC有效性：**

提供的POC代码是一个Python脚本，旨在扫描和利用此漏洞。脚本包含以下功能：

*   **URL扫描：** 允许扫描单个URL，检测漏洞是否存在。
*   **批量扫描：** 允许从文件中读取URL列表，进行批量扫描。
*   **Telegram通知：** 可以配置Telegram Bot，在发现漏洞时发送通知。
*   **文件读取：** 通过构造payload读取目标文件。

从代码结构来看，该POC具备漏洞验证和利用的能力，因此判定为有效。

**投毒风险：**

代码中 `includes/bot.py` 包含向远程服务器发送数据的代码段，存在一定风险。
```python
import requests
from utils import const
from utils import configure


def sendmessage(vul):

    data = {"Tname": "CVE-2024-36991", "chatid": configure.get_chatid(), "data": vul,
            "Blog": const.Data.blog, "bugname": const.Data.bugname, "Priority": "High"}

    headers = {
        "Content-Type": "application/json",
    }

    try:
        response = requests.put(const.Data.api, json=data, headers=headers)
    except:
        print("Bot Error")
```

这里，`const.Data.api` 定义了用于发送漏洞信息的API端点。`const.Data` 的具体内容需要进一步检查，以确认是否存在恶意端点。用户配置的 `chatid` 也会被发送，如果 `const.Data.api` 被恶意控制，可能导致用户隐私泄露。
`configure.get_chatid()`函数也需要审查，确定其行为是否安全。
总的来说，这个库本身的功能是实现漏洞的利用，并把结果通知给用户，方便漏洞挖掘。

**投毒风险评估：**

尽管存在信息泄露的潜在风险，但该POC的主要目的是为了方便漏洞扫描和验证。并没有发现直接执行恶意代码或破坏系统的功能。因此，投毒风险较低，大约为 10%。

**项目地址:** [Cappricio-Securities/CVE-2024-36991](https://github.com/Cappricio-Securities/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)