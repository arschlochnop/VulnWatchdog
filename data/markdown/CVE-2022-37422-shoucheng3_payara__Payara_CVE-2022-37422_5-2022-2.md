## CVE-2022-37422-Payara-目录遍历

**漏洞编号:** CVE-2022-37422

**漏洞类型:** 目录遍历

**影响应用:** Payara Server, Payara Micro, Payara Server Embedded

**危害等级:** 高危，可能导致敏感文件泄露和远程代码执行

**影响版本:** <= 5.2022.2

**利用条件:** 需要网络访问 Payara 服务

**POC 可用性:** 否 (提供的代码并非直接PoC，而是Jenkinsfile)

**投毒风险:** 1%

## 详情

CVE-2022-37422 是 Payara <= 5.2022.2 版本中存在的未经身份验证的目录遍历漏洞。攻击者可以通过构造特定的 URL，利用此漏洞读取服务器上的任意文件。提供的 `Jenkinsfile` 代码是一个持续集成/持续交付 (CI/CD) 配置文件，用于构建、测试和部署 Payara 项目。它本身不是漏洞利用代码，而是一个构建流程的描述，攻击者可能会利用此构建流程的缺陷（例如，配置不当或依赖项漏洞）来间接利用 Payara 的目录遍历漏洞。

**有效性评估：** 漏洞本身是已知的，并且有多个来源证实了其存在。但是，提供的 `Jenkinsfile` 不是一个直接的漏洞利用 PoC。因此，评估其直接有效性不适用。

**投毒风险评估：**`Jenkinsfile` 代码本身看起来是构建和测试 Payara 项目的标准流程，没有明显的恶意代码或后门。它执行 Maven 构建、运行测试，并将构建产物归档。但是，`Jenkinsfile` 中的 Maven 构建过程依赖于从 Maven 仓库下载的依赖项。如果攻击者能够控制或污染 Maven 仓库中的依赖项，他们可以将恶意代码注入到构建过程中。此外，Jenkins 本身的配置也可能存在安全风险，例如未经授权的访问或代码执行。由于 `Jenkinsfile` 依赖于 Maven 仓库和 Jenkins 配置，存在一定的投毒风险。假设构建环境安全，代码本身并无明显投毒行为，风险较低。因此估算投毒风险为1%。

**利用方式分析：**
1.  **构造恶意 URL：** 攻击者需要构造包含目录遍历序列（例如 `../`）的 URL，发送到 Payara 服务器。
2.  **绕过身份验证：** 此漏洞的严重性在于它不需要身份验证，这意味着任何未经授权的用户都可以利用它。
3.  **读取敏感文件：** 成功利用后，攻击者可以读取 Payara 服务器上的任何可访问文件，例如配置文件、源代码或密钥。
4.  **Jenkins间接利用:** 虽然 Jenkinsfile 不是直接的PoC，但它可能被攻击者用来构建包含恶意组件的 Payara 版本，或者利用 Jenkins 的其他安全漏洞来攻击 Payara 服务器。

**缓解措施：**
1.  升级到 Payara 的最新版本（>= 5.42.0），此版本已修复此漏洞。
2.  实施严格的输入验证和清理，以防止目录遍历攻击。
3.  限制对 Payara 服务器上敏感文件的访问权限。
4.  审查和加固 Jenkins 的安全配置，以防止未经授权的访问和代码执行。

**项目地址:** [shoucheng3/payara__Payara_CVE-2022-37422_5-2022-2](https://github.com/shoucheng3/payara__Payara_CVE-2022-37422_5-2022-2)

**漏洞详情:** [CVE-2022-37422](https://nvd.nist.gov/vuln/detail/CVE-2022-37422)