## CVE-2022-37422-Payara-目录穿越

**漏洞编号:** CVE-2022-37422

**漏洞类型:** 目录穿越

**影响应用:** Payara Server, Payara Micro, Payara Server Embedded

**危害等级:** 高危，可能导致未经授权的文件访问

**影响版本:** <= 5.2022.2

**利用条件:** 需要网络访问Payara Server，默认context root

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-37422是一个未经身份验证的目录遍历漏洞，影响Payara Server, Payara Micro和Payara Server Embedded的5.2022.2及更早版本。攻击者可以利用此漏洞通过构造包含"../"序列的恶意URL来访问服务器上的任意文件。根据搜索结果，漏洞存在于默认context root下。

**有效性:** 根据漏洞库信息和搜索结果，此漏洞的POC是有效的，因为多个来源都确认了此漏洞的存在和影响。

**投毒风险:** 提供的代码片段是一个Jenkinsfile，用于自动化构建、测试和部署Payara项目的流程。它主要涉及构建源码、运行测试、检出MicroProfile TCK Runners等。代码中存在一些与构建相关的Maven命令，其中包含从Nexus仓库下载依赖项。尽管该Jenkinsfile本身不直接包含漏洞利用代码,但是Jenkinsfile可以被恶意修改，从而导致从不可信的源下载依赖项或者执行恶意命令。但是正常的Jenkinsfile代码投毒风险较低，仅仅是项目构建和测试流程。

**利用方式:**
1.  **构建恶意URL:** 攻击者可以构造包含"../"序列的URL，尝试访问Payara服务器上的敏感文件。 例如：`http://<服务器地址>/../../../../etc/passwd`
2.  **发送HTTP请求:** 攻击者通过HTTP客户端发送构造好的URL请求。
3.  **读取文件:** 如果漏洞存在且利用成功，服务器将返回请求的文件内容。

**修复建议:**
升级到Payara Server 5.42.0或更高版本，该版本已修复此漏洞。

**项目地址:** [shoucheng3/payara__Payara_CVE-2022-37422_5-2022-2](https://github.com/shoucheng3/payara__Payara_CVE-2022-37422_5-2022-2)

**漏洞详情:** [CVE-2022-37422](https://nvd.nist.gov/vuln/detail/CVE-2022-37422)