## CVE-2010-1240 Adobe Reader PDF Embedded Executable Execution

**漏洞编号:** CVE-2010-1240

**漏洞类型:** 文件格式漏洞

**影响应用:** Adobe Reader

**危害等级:** 高危，允许远程攻击者执行任意本地程序

**影响版本:** <= 9.3.2 (9.x), <= 8.2.2 (8.x)

**利用条件:** 用户必须同意安全提示框，即点击允许执行嵌入的可执行文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2010-1240 漏洞存在于 Adobe Reader 和 Acrobat 9.x (9.3.3 之前) 和 8.x (8.2.3 之前) 的 Windows 和 Mac OS X 版本中。该漏洞允许远程攻击者通过特制的 PDF 文档欺骗用户执行任意本地程序。漏洞的根本原因是 Adobe Reader 在“启动文件”警告对话框中没有限制一个文本字段的内容。攻击者可以利用此漏洞，通过修改该文本字段，诱使用户点击“打开”按钮，从而执行嵌入在 PDF 文档中的恶意程序。 

**有效性：**
根据漏洞信息和POC代码，该漏洞利用的有效性较高，漏洞库信息和搜索引擎结果均证实了该漏洞的存在和危害。POC代码提供了利用 Metasploit 生成包含嵌入式可执行文件的恶意 PDF 文档的详细步骤，并通过社工诱使用户点击“允许”以执行恶意代码，从而获得 Meterpreter 会话。

**投毒风险：**
POC代码主要描述了漏洞利用过程，未发现明显的恶意或隐藏代码，但仍存在一定的投毒风险，具体分析如下：

*   **风险点：** POC 使用了 Metasploit 框架，而 Metasploit 本身可能包含一些后门或漏洞，但这些属于 Metasploit 框架本身的风险，而非 POC 作者引入的风险。另一个风险点在于，攻击者可能在生成的 PDF 文档中嵌入恶意程度更高的 payload，例如，下载和执行其他恶意程序，或者窃取用户敏感信息。
*   **缓解措施：** 仔细检查 Metasploit 配置，确保下载的 payload 是可信的。使用杀毒软件扫描生成的 PDF 文档，以检测潜在的恶意代码。对目标系统进行安全加固，限制用户权限，减少攻击面。

因此，考虑到上述风险点和缓解措施，将投毒风险评估为10%。

**利用方式：**
1.  **准备：** 攻击者需要准备一个受影响版本的 Adobe Reader 或 Acrobat，并确保目标系统允许执行本地程序。
2.  **生成恶意 PDF：** 使用 Metasploit 框架中的 `exploit/windows/fileformat/adobe_pdf_embedded_exe` 模块，设置 payload (例如 `windows/meterpreter/reverse_tcp`)，LHOST (攻击者 IP 地址) 和 LPORT (监听端口)。然后，设置 `INFILENAME` 为一个正常的PDF文件，以及 `FILENAME` 来设置生成的恶意PDF文件的名字。
3.  **发送恶意 PDF：** 将生成的恶意 PDF 文档通过电子邮件、社交媒体或其他方式发送给目标用户。
4.  **诱骗用户：**  攻击者会诱使用户打开 PDF 文档，并在弹出的安全警告对话框中点击“允许”按钮。通过精心设计的文本信息诱骗用户相信这是一个无害的操作，例如声称“点击打开以阅读加密信息”。
5.  **执行 Payload：**  一旦用户点击“允许”，嵌入在 PDF 文档中的恶意程序就会被执行，攻击者即可获得 Meterpreter 会话，从而控制目标系统。


**项目地址:** [Jasmoon99/Embedded-PDF](https://github.com/Jasmoon99/Embedded-PDF)

**漏洞详情:** [CVE-2010-1240](https://nvd.nist.gov/vuln/detail/CVE-2010-1240)