## CVE-2023-30212-OURPHP-反射型XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型跨站脚本(XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户凭据泄露、会话劫持等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息和搜索引擎结果，CVE-2023-30212是OURPHP 7.2.0版本中的一个反射型XSS漏洞，位于`/client/manage/ourphp_out.php`文件。攻击者可以通过构造包含恶意JavaScript代码的URL，当用户点击该URL时，恶意代码会在用户的浏览器中执行。

**POC有效性：**

提供的POC代码是一个Dockerfile和一个README.md文件，用于搭建一个包含漏洞OURPHP 7.2.0的Docker环境。README.md文件给出了利用该漏洞的步骤，其中包括一个URL：`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert("bug")</script>`。该URL中的`out`参数包含一段JavaScript代码，当用户访问该URL时，会弹出一个包含"bug"的警告框，证明POC是有效的。

**投毒风险：**

分析提供的代码，主要关注Dockerfile和admin.php。Dockerfile用于构建Docker镜像，包含了安装依赖、配置数据库、复制文件等操作，未发现恶意代码。init.sql只包含数据库权限的赋予，my.cnf包含mysql 初始化文件路径。admin.php是后台管理文件，负责用户验证，日志记录，没有明显的投毒代码。

提供的POC代码主要用于演示CVE-2023-30212漏洞的利用，没有发现明显的恶意代码或后门。虽然存在通过XSS漏洞植入恶意脚本的风险，但是该风险并非POC本身带来的，而是XSS漏洞本身的特性。因此，投毒风险较低，我给出的投毒风险是10%，主要是考虑到开发者可能会在代码中添加一些隐蔽的后门。

**利用方式：**

1.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert("bug")</script>`。
2.  攻击者通过各种方式诱骗用户点击该URL，例如：通过电子邮件、社交媒体等。
3.  当用户点击该URL时，恶意代码会在用户的浏览器中执行，攻击者可以利用该漏洞进行各种恶意操作，例如：获取用户的Cookie、重定向用户到恶意网站、篡改网页内容等。

**项目地址:** [AAsh035/CVE-2023-30212](https://github.com/AAsh035/CVE-2023-30212)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)