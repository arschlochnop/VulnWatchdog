## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露 (NTLM Hash Leak)

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致身份冒用

**影响版本:** 受影响的Windows版本及补丁前版本（详见漏洞库信息）

**利用条件:** 攻击者需要让受害者提取包含恶意.library-ms文件的rar/zip压缩包。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许远程攻击者通过诱导受害者提取包含特制的`.library-ms`文件的压缩包（rar或zip），触发Windows Explorer的SMB认证请求，从而泄露受害者的NTLM哈希。攻击者可以通过搭建SMB服务器来捕获哈希。 

**有效性分析：**
根据漏洞描述和POC代码，利用方式是可行的。POC代码的功能是：
1.  接收用户输入的攻击者IP地址和文件名。
2.  创建一个包含指向攻击者IP地址的共享路径的`.library-ms`文件。
3.  将该`.library-ms`文件压缩到zip文件中。

当受害者提取该zip文件时，Windows Explorer会自动尝试访问`.library-ms`文件中指定的SMB共享，从而触发NTLM认证，并将哈希发送到攻击者的SMB服务器。

**投毒风险分析：**
POC代码本身比较简单，主要功能是生成包含恶意SMB路径的.library-ms文件并压缩，看起来并没有明显的投毒代码。

投毒的可能方式：
1.  **博客链接：** README.md文件包含一个博客链接。此链接可能会重定向到恶意网站。
2. **视频链接:** README.md文件包含一个github用户附件链接，无法确认该链接的安全性
3.  **代码执行环境：** 运行POC代码需要在本地创建和删除文件，如果攻击者篡改了代码，可能会导致删除错误的文件。

综合考虑，代码本身直接投毒的可能性较低，但存在通过外部链接和篡改代码实现投毒的风险。因此，投毒风险评估为10%。

**利用方式总结：**
1.  攻击者搭建SMB服务器，用于捕获NTLM哈希。
2.  攻击者运行POC脚本，生成包含指向攻击者SMB服务器的`.library-ms`文件的zip压缩包。
3.  攻击者诱骗受害者下载并提取该zip压缩包。
4.  受害者提取压缩包后，Windows Explorer自动尝试连接攻击者的SMB服务器，泄露NTLM哈希。
5.  攻击者使用捕获的NTLM哈希进行进一步的攻击，例如破解哈希或进行Pass-the-Hash攻击。

**项目地址:** [0x6rss/CVE-2025-24071_PoC](https://github.com/0x6rss/CVE-2025-24071_PoC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)