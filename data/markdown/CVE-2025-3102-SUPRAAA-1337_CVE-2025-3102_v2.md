## CVE-2025-3102 - SureTriggers WordPress 插件未授权管理员创建

**漏洞编号:** CVE-2025-3102

**漏洞类型:** 身份验证绕过

**影响应用:** SureTriggers WordPress 插件

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制受影响的WordPress站点

**影响版本:** <= 1.0.78

**利用条件:** 插件已安装并激活，但未配置 API 密钥

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 SureTriggers WordPress 插件中，由于 `autheticate_user` 函数在处理 `secret_key` 值时缺少空值检查，导致未经身份验证的攻击者可以创建管理员帐户。攻击者可以通过发送特定的 HTTP 请求绕过身份验证，创建一个新的管理员帐户，从而完全控制受影响的 WordPress 站点。

**有效性评估:**

漏洞库信息显示，该漏洞的 CVSS 评分为 8.1 (高危)，描述中明确指出由于缺少空值检查，未经身份验证的攻击者可以创建管理员账户。搜索引擎结果中，包括 Wordfence 的文章和 CISA 的公告都证实了该漏洞的存在和影响。

提供的 POC 代码是一个 nuclei 模板，用于检测目标 WordPress 站点上安装的 SureTriggers 插件版本是否易受攻击。该模板通过读取 `readme.txt` 文件并提取 `Stable tag` 来确定插件版本，然后使用 `compare_versions` 函数将版本与 `1.0.78` 进行比较。如果版本小于等于 `1.0.78`，则认为该站点易受攻击。这个 nuclei 模板 **不是** 直接利用漏洞的代码，而是用于检测漏洞是否存在。

从搜索引擎结果 `https://medium.com/@Cyber-AppSec/attack-chain-analysis-cve-2025-3102-in-ottokit-wordpress-plugin-88515c446d58` 可以获取更加详细的漏洞利用信息。

**投毒风险评估:**

提供的nuclei模版主要目的是探测漏洞，没有发现任何可疑的恶意代码或行为，因此评估投毒风险为0%。

**利用方式:**

1.  **版本检测:** 使用 nuclei 模板检测目标 WordPress 站点是否安装了易受攻击的 SureTriggers 插件版本（<= 1.0.78）。
2.  **漏洞触发:** 向目标站点发送带有恶意构造的 `secret_key` 参数的请求到 `autheticate_user` 函数。由于缺少空值检查，攻击者可以绕过身份验证。
3.  **管理员账户创建:** 通过成功绕过身份验证，创建一个新的管理员账户。
4.  **完全控制:** 使用新创建的管理员账户登录 WordPress 后台，并完全控制该站点。

**项目地址:** [SUPRAAA-1337/CVE-2025-3102_v2](https://github.com/SUPRAAA-1337/CVE-2025-3102_v2)

**漏洞详情:** [CVE-2025-3102](https://nvd.nist.gov/vuln/detail/CVE-2025-3102)