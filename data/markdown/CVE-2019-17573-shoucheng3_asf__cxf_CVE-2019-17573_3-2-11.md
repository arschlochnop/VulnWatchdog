## CVE-2019-17573-Apache CXF-Reflected XSS

**漏洞编号:** CVE-2019-17573

**漏洞类型:** Reflected XSS

**影响应用:** Apache CXF

**危害等级:** 中危，可能导致用户凭据泄露、会话劫持等

**影响版本:** All versions of Apache CXF prior to 3.3.5 and 3.2.12

**利用条件:** 目标系统运行存在漏洞版本的Apache CXF，且`/services`页面对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-17573是一个存在于Apache CXF的反射型跨站脚本（XSS）漏洞。该漏洞位于默认创建的`/services`页面，该页面列出了可用的端点名称和地址。攻击者可以通过在URL中注入恶意JavaScript代码来利用此漏洞。根据漏洞描述，现代浏览器通常会移除URL中的点分段，从而减轻此漏洞的影响，但移动应用可能仍然容易受到攻击。

**有效性评估：**
漏洞库信息和搜索结果均确认了该漏洞的存在及其影响。提供的“漏洞利用代码”实际上是Apache CXF的构建说明和GPG密钥，**并不是直接可用的POC代码**。真正的POC需要构造包含恶意JavaScript代码的URL。

**投毒风险评估：**
提供的代码中包含构建说明和GPG密钥。构建说明本身不包含恶意代码，GPG密钥用于验证Apache CXF发布的软件的完整性。因此，可以判断该仓库中隐藏投毒代码的可能性较低，但仍然存在一定的风险，主要是因为构建过程中可能依赖其他未审计的外部资源，以及构建环境本身可能被污染。 构建流程及maven依赖存在潜在风险，这里我将投毒风险评估为 **10%** 。

**利用方式：**
1.  **确定目标：** 找到运行有Apache CXF且版本低于3.3.5或3.2.12的服务器，并确认`/services`页面可以访问。
2.  **构造恶意URL：**  构造包含JavaScript代码的URL，该代码将在`/services`页面上执行。例如：`http://example.com/services/../../%3Cscript%3Ealert('XSS')%3C/script%3E`。`styleSheetPath`参数也可能被利用 (参考CVE-2020-13954)。
3.  **诱导用户访问：**  将构造的URL发送给目标用户，诱导其点击。
4.  **执行恶意代码：** 当用户访问该URL时，恶意JavaScript代码将在用户的浏览器中执行，攻击者可以利用此漏洞窃取用户的Cookie、会话信息，或者将用户重定向到恶意网站。

**项目地址:** [shoucheng3/asf__cxf_CVE-2019-17573_3-2-11](https://github.com/shoucheng3/asf__cxf_CVE-2019-17573_3-2-11)

**漏洞详情:** [CVE-2019-17573](https://nvd.nist.gov/vuln/detail/CVE-2019-17573)