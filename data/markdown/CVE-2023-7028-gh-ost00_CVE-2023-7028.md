## CVE-2023-7028-GitLab-账号接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账号接管

**影响应用:** GitLab

**危害等级:** 高危，攻击者可以完全控制受影响的GitLab账户

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞，攻击者需要知道目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 是一个存在于GitLab CE/EE中的账号接管漏洞。漏洞源于找回密码功能存在缺陷，允许攻击者向未验证的邮箱地址发送密码重置邮件，从而重置目标用户的密码并接管其账户。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个GitLab版本，且危害性较高。提供的POC代码通过利用有缺陷的密码重置流程，向目标用户和攻击者控制的邮箱发送重置密码的邮件。若目标用户使用的GitLab版本存在漏洞，则POC代码的有效性很高。

**投毒风险：**
POC代码中使用了`1secmail.com`提供的临时邮箱API。虽然代码本身的功能是实现漏洞利用，但理论上存在一定的投毒风险。攻击者可能会修改代码，在重置密码后植入后门或者进行其他恶意操作。但是查看代码，没有发现特别明显的恶意代码，不过使用临时邮箱客观上增加了溯源难度, 具有一定的风险。综合考虑，投毒风险大约在10%左右。

**利用方式：**
1.  攻击者需要知道目标用户的邮箱地址。
2.  攻击者构造包含目标用户邮箱和攻击者控制邮箱的请求，发送到GitLab的密码重置接口。
3.  GitLab会向目标用户的邮箱和攻击者控制的邮箱发送密码重置邮件。
4.  攻击者通过点击攻击者邮箱中的重置链接，设置新的密码。
5.  攻击者使用新密码登录目标用户的GitLab账户，完成账号接管。

**项目地址:** [gh-ost00/CVE-2023-7028](https://github.com/gh-ost00/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)