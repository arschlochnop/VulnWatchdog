## CVE-2025-1639-Animation Addons for Elementor Pro-任意插件安装/激活

**漏洞编号:** CVE-2025-1639

**漏洞类型:** 任意插件安装/激活

**影响应用:** Animation Addons for Elementor Pro

**危害等级:** 高危，可能导致远程代码执行，权限提升

**影响版本:** <= 1.6

**利用条件:** 需要WordPress Subscriber级别或以上的账户权限，且目标站点安装了Animation Addons for Elementor Pro插件。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-1639 存在于 WordPress 插件 Animation Addons for Elementor Pro 1.6 及更早版本中。该漏洞由于 `install_elementor_plugin_handler()` 函数缺少权限验证，导致具有 Subscriber 级别或以上权限的认证攻击者可以安装和激活任意插件。攻击者可以利用此漏洞上传恶意插件，从而实现远程代码执行，完全控制受攻击的 WordPress 站点。

**有效性评估：**

*   漏洞库信息表明该漏洞影响所有版本至 1.6 版本(包含)。
*   搜索引擎结果确认了该漏洞的存在，并提供了相关细节链接。
*   提供的漏洞利用代码包含完整的漏洞利用流程，包括登录、版本检查、安全令牌提取和插件安装/激活。该代码逻辑清晰，针对性强，可以判断为有效。

**投毒风险评估：**

存在很高的投毒风险 (95%)，原因如下：

*   **任意插件安装：** 攻击者可以安装任何插件，包括恶意插件。
*   **权限要求低：** 只需要 Subscriber 权限即可利用，权限获取难度低。
*   **代码可修改性：** 攻击者可以修改利用代码，将恶意插件的安装集成到利用代码中，诱导用户运行。
*   **默认插件：** 脚本指定了默认安装的插件 `wp-maintenance-mode`，如果攻击者修改该默认插件为恶意插件，用户在不注意的情况下可能会安装恶意插件。
*   **依赖关系：** 漏洞利用的成功与Elementor是否激活有关，攻击者有可能利用该漏洞安装需要Elementor环境的恶意插件，诱导管理员激活Elementor，进而控制整个网站。

**利用方式分析：**

1.  **登录：** 利用脚本提供的用户名和密码尝试登录 WordPress 站点。
2.  **版本检查：** 检查目标站点是否安装了受影响版本的 Animation Addons for Elementor Pro 插件。通过访问`readme.txt`文件检查`Stable tag`确定插件版本
3.  **安全令牌提取：** 从 `edit.php?post_type=pafe` 页面提取用于执行插件安装操作的安全令牌 (nonce)。使用BeautifulSoup进行HTML解析,并通过正则表达式从页面中提取安全令牌。
4.  **插件安装/激活：** 使用提取的安全令牌，通过 `admin-ajax.php` 接口调用 `vayu_blocks_install_and_activate_callback` action，安装并激活指定的插件。在发送的POST请求中,包含了`plugin_slug`和`security`字段. `plugin_slug` 指定要安装的插件的 slug，`security` 包含提取到的安全令牌。

总而言之，该漏洞利用 PoC 代码有效，且存在极高的投毒风险。攻击者可以利用该漏洞在未经授权的情况下安装并激活恶意插件，从而完全控制受攻击的 WordPress 站点。

**项目地址:** [Nxploited/CVE-2025-1639](https://github.com/Nxploited/CVE-2025-1639)

**漏洞详情:** [CVE-2025-1639](https://nvd.nist.gov/vuln/detail/CVE-2025-1639)