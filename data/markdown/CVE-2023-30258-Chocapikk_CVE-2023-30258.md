## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.x 和 7.x

**利用条件:** 目标服务器运行存在漏洞的MagnusBilling版本，且攻击者可以发起HTTP请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过构造恶意的HTTP请求来执行任意操作系统命令。

**有效性：**

根据提供的漏洞信息和搜索引擎结果，该漏洞的POC代码是有效的。POC代码通过向目标URL发送包含恶意命令的HTTP请求，利用`icepay.php`文件中的命令注入漏洞执行命令。

**投毒风险：**

POC 代码本身非常简单，主要功能是测试目标是否存在漏洞并执行指定的命令。代码中没有发现明显的投毒代码。url_encode 函数看似没有问题,但是可能存在未知的编码绕过漏洞. 风险较低，因此投毒风险评估为1%。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于`icepay.php`文件中，`democ`参数可能存在命令注入。
2.  **构造Payload：** 攻击者需要构造包含恶意命令的HTTP请求。Payload的关键在于利用URL编码绕过服务器的输入验证。
3.  **发送请求：** 攻击者向目标服务器发送构造好的HTTP请求。
4.  **命令执行：** 如果服务器存在漏洞，恶意命令将在服务器上执行。

**总结：**

CVE-2023-30258是一个严重的安全漏洞，攻击者可以利用该漏洞完全控制受影响的服务器。建议用户尽快升级到安全版本或采取其他缓解措施。POC代码的实现较为直接，主要目的在于验证漏洞和执行命令，但是仍然不建议在生产环境运行未经过充分测试的POC。

**项目地址:** [Chocapikk/CVE-2023-30258](https://github.com/Chocapikk/CVE-2023-30258)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)