## CVE-2024-21006

**漏洞编号:** CVE-2024-21006

**漏洞类型:** 信息泄露/未授权访问

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致未经授权访问关键数据

**影响版本:** 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问WebLogic Server的T3或IIOP端口，且目标版本为受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21006是一个Oracle WebLogic Server中的高危漏洞，影响版本12.2.1.4.0和14.1.1.0.0。该漏洞允许未经身份验证的攻击者通过T3或IIOP协议进行网络访问，从而可能泄露敏感信息，CVSS评分为7.5。

**有效性评估：**
根据漏洞库信息和搜索结果，该漏洞容易被利用。提供的POC代码利用JNDI注入，通过IIOP协议与WebLogic Server进行交互。它通过构造恶意的`MessageDestinationReference` 对象，并将其绑定到JNDI树中，从而触发反序列化漏洞，进而执行远程代码。POC代码中使用了IIOP协议。

**投毒风险分析：**
查看POC代码，主要是利用JNDI注入，代码本身相对简单，并没有发现明显的投毒代码的痕迹。主要风险在于利用过程中依赖的LDAP服务。如果攻击者控制了LDAP服务器，或者LDAP服务器本身被投毒，则可能导致更大的安全风险。当前分析显示，直接POC代码的投毒风险较低。

**利用方式：**
1.  **确定目标：** 确定目标WebLogic Server的版本是否在受影响范围内（12.2.1.4.0 或 14.1.1.0.0）。
2.  **网络访问：** 确保可以从攻击者机器访问目标WebLogic Server的T3或IIOP端口(默认7001, 可能需要根据实际配置进行调整)。
3.  **JNDI注入：** 利用JNDI注入漏洞，通过IIOP协议向WebLogic Server发送恶意的JNDI请求。
4.  **LDAP服务：** 攻击者需要部署一个恶意的LDAP服务，该服务指向包含恶意代码的远程类。
5.  **反序列化：** WebLogic Server在处理JNDI请求时，会从LDAP服务获取远程类，并进行反序列化，从而执行攻击者提供的恶意代码。
6.  **代码执行：** 成功利用漏洞后，攻击者可以在WebLogic Server上执行任意代码，从而获取敏感信息或控制整个服务器。

综上，该漏洞利用方式较为直接，且存在公开的POC代码，利用难度较低。但需要注意的是，攻击者需要搭建恶意的LDAP服务配合利用。


**项目地址:** [dadvlingd/CVE-2024-21006](https://github.com/dadvlingd/CVE-2024-21006)

**漏洞详情:** [CVE-2024-21006](https://nvd.nist.gov/vuln/detail/CVE-2024-21006)