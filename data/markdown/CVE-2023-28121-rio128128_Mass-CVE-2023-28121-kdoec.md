## CVE-2023-28121-WooCommerce Payments插件-权限绕过

**漏洞编号:** CVE-2023-28121

**漏洞类型:** 权限绕过

**影响应用:** WooCommerce Payments WordPress Plugin

**危害等级:** 高危，可能导致管理员权限获取

**影响版本:** <= 5.6.1

**利用条件:** 需要安装并启用受影响版本的WooCommerce Payments插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-28121是WooCommerce Payments插件中一个严重的权限绕过漏洞。未经身份验证的攻击者可以冒充具有提升权限的用户（例如管理员）发送请求，从而获得对受影响站点的管理员访问权限。

**有效性:**
根据漏洞信息、搜索结果和RCE Security的文章（https://www.rcesecurity.com/2023/07/patch-diffing-cve-2023-28121-to-compromise-a-woocommerce/）可知，此漏洞可以被利用。

**投毒风险:**
提供的漏洞利用代码仅包含GNU通用公共许可证文本，不包含任何实际的漏洞利用代码，因此不存在投毒风险。投毒风险为0%。

**利用方式:**
1.  确定目标网站正在运行受影响版本的WooCommerce Payments插件（<= 5.6.1）。
2.  利用`determine_current_user`函数中的漏洞，绕过身份验证。
3.  构造恶意请求，冒充管理员执行管理操作，例如创建新管理员用户、修改现有用户权限等。
4.  通过RCE Security的文章，可以深入了解利用该漏洞的详细步骤。

根据Wordfence的报告（https://www.wordfence.com/blog/2023/07/massive-targeted-exploit-campaign-against-woocommerce-payments-underway/），该漏洞已被大规模利用。

**项目地址:** [rio128128/Mass-CVE-2023-28121-kdoec](https://github.com/rio128128/Mass-CVE-2023-28121-kdoec)

**漏洞详情:** [CVE-2023-28121](https://nvd.nist.gov/vuln/detail/CVE-2023-28121)