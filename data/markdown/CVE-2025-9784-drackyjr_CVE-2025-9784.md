## CVE-2025-9784 MadeYouReset HTTP/2 DoS

**漏洞编号:** CVE-2025-9784

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Undertow

**危害等级:** 高危，可能导致服务中断

**影响版本:** 受影响的Undertow版本（参见漏洞库信息）

**利用条件:** 目标服务器支持HTTP/2且运行受影响的Undertow版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞是Undertow中一个HTTP/2的DoS漏洞，被称为“MadeYouReset”。 攻击者可以通过发送畸形的请求，导致服务器端不断重置stream，消耗服务器资源，最终导致拒绝服务。

**有效性：**
提供的PoC代码是一个Bash脚本，用于检测目标服务器是否存在CVE-2025-9784漏洞。该脚本的步骤如下：
1.  检查是否提供了URL参数。
2.  检查curl是否支持HTTP/2。
3.  检查目标服务器是否支持HTTP/2。
4.  测量baseline响应时间。
5.  发起20个并发请求，模拟MadeYouReset攻击。
6.  分析服务器的响应时间，如果响应时间显著增加，则可能存在漏洞。

**投毒风险：**
PoC代码主要执行以下操作：
*   发送HTTP/2请求到目标服务器。
*   测量响应时间。
该脚本本身没有明显的恶意行为。可能的风险在于，如果攻击者修改了脚本，例如，将`curl`替换为恶意程序，或者在脚本中添加恶意代码，可能会导致投毒。由于脚本相对简单，且主要依赖于`curl`命令，因此投毒风险较低，估计在5%左右。当然风险取决于脚本的来源和使用环境，需要人工审核脚本的安全性。

**利用方式：**
1.  攻击者向目标服务器发送大量的畸形HTTP/2请求，这些请求会触发服务器端的stream reset。
2.  服务器为了处理这些stream reset，会消耗大量的CPU和内存资源。
3.  当服务器资源耗尽时，就会导致拒绝服务。

**项目地址:** [drackyjr/CVE-2025-9784](https://github.com/drackyjr/CVE-2025-9784)

**漏洞详情:** [CVE-2025-9784](https://nvd.nist.gov/vuln/detail/CVE-2025-9784)