## CVE-2025-3248-Langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 需要网络访问Langflow服务，且服务版本低于1.3.0

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3248是Langflow 1.3.0之前的版本中存在的代码注入漏洞，位于/api/v1/validate/code端点。未经身份验证的远程攻击者可以发送特制的HTTP请求，通过注入恶意代码来执行任意命令。

**有效性：**
根据漏洞信息和搜索结果，以及提供的PoC代码，可以判断此漏洞是有效的，并且存在可用的PoC利用代码。多个来源都证实了该漏洞的存在和严重性。

**投毒风险：**
PoC代码中存在轻微的投毒风险。代码中`commandPayload = ' '.join(command)`处存在潜在风险，如果用户输入的命令包含恶意字符，可能会被注入到`subprocess.check_output`中执行。虽然PoC本身是为了利用漏洞，但如果攻击者修改PoC，可能会引入更多恶意行为。
具体分析如下：

*   **优点:** 代码结构清晰，功能明确，旨在利用漏洞执行命令，未发现明显恶意代码。
*   **缺点:** `commandPayload = ' '.join(command)`处存在注入风险，用户输入不当可能导致问题。
*   **缓解措施:** 建议对用户输入进行严格的过滤和验证，避免执行不安全的命令。

综合来看，投毒风险较低，主要在于用户使用时的不当操作，而非PoC本身携带恶意代码。因此，投毒风险评定为5%。

**利用方式：**
利用方式如下：

1.  攻击者向Langflow服务器的/api/v1/validate/code端点发送POST请求。
2.  请求体中包含一个JSON对象，其中`code`字段包含恶意Python代码。
3.  Langflow服务器在未进行充分验证的情况下，使用`exec`函数执行该Python代码。
4.  攻击者通过构造恶意的Python代码，可以执行任意系统命令，实现远程代码执行。

PoC代码的利用方式如下：

1.  用户输入Langflow服务器的URL。
2.  用户选择执行命令或反弹shell。
3.  PoC代码构造包含恶意Python代码的JSON payload。
4.  PoC代码向/api/v1/validate/code端点发送POST请求。
5.  PoC代码解析服务器返回的结果，并显示执行结果。

**项目地址:** [Vip3rLi0n/CVE-2025-3248](https://github.com/Vip3rLi0n/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)