## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据和功能

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞的Next.js版本，并且授权检查位于middleware中

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 漏洞是 Next.js 中间件授权绕过漏洞。攻击者可以通过构造包含特定 `x-middleware-subrequest` 头的 HTTP 请求来绕过中间件中的授权检查，从而访问受保护的资源。根据提供的POC代码，通过多次嵌套middleware到`x-middleware-subrequest`头中可以绕过认证。漏洞利用代码中还提到了针对不同 Next.js 版本，该header的参数有多种形式，例如`middleware`、`src/middleware`、`_middleware`等，需要根据实际情况进行调整。从目前代码来看，该代码仓库的投毒风险为0%, 未发现恶意代码，主要提供了漏洞复现方法和不同版本Next.js的payload。根据搜索引擎结果，确认了该漏洞的存在和严重性，以及受到影响的Next.js版本范围。多个来源强调了`x-middleware-subrequest` header在漏洞利用中的作用。

**项目地址:** [adjscent/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/adjscent/vulnerable-nextjs-14-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)