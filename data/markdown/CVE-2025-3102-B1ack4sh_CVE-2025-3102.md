## CVE-2025-3102 - SureTriggers Authentication Bypass

**漏洞编号:** CVE-2025-3102

**漏洞类型:** 认证绕过

**影响应用:** SureTriggers (现已更名为 OttoKit)

**危害等级:** 高危，允许未授权用户创建管理员账户

**影响版本:** <= 1.0.78

**利用条件:** SureTriggers插件已安装但未配置API密钥

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3102 是 WordPress SureTriggers 插件（<= 1.0.78）中的一个认证绕过漏洞。该漏洞由于在 'autheticate_user' 函数中缺少对 'secret_key' 值的空值检查，允许未经身份验证的攻击者在目标网站上创建管理员帐户。利用方式如下：

1.  **漏洞原理：** 插件在未配置API密钥时，`autheticate_user` 函数未正确验证 `secret_key`，导致可以绕过认证。
2.  **利用方法：** 攻击者可以使用提供的PoC脚本，指定目标WordPress站点的URL，以及要创建的管理员账户的邮箱、用户名和密码。脚本会构造一个包含这些信息的JSON payload，并将其发送到 `/wp-json/sure-triggers/v1/automation/action` 端点。由于认证绕过，插件会创建具有指定凭据的管理员账户。
3.  **有效性：** 根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞是有效的。该PoC代码针对该漏洞的利用方式是准确的。
4.  **投毒风险：** PoC 代码本身比较直接，主要功能是利用漏洞创建管理员用户。经过分析，投毒风险较低，大约为5%。可能存在的风险点在于：
    *   **参数默认值：** 脚本中newmail参数默认值为`Test@gmail.com`，大量使用此PoC可能造成信息泄露，攻击者可以根据邮箱反推站点等信息。
    *   **异常处理：** 异常处理部分不够完善，可能在特定环境下导致脚本执行失败，暴露更多信息。
    *   **Payload修改:** 虽然 PoC 看起来直接，但攻击者可能会修改 payload 增加其他恶意功能，但这并非 PoC 本身的投毒，而是利用 PoC 进行了恶意扩展。

**项目地址:** [B1ack4sh/CVE-2025-3102](https://github.com/B1ack4sh/CVE-2025-3102)

**漏洞详情:** [CVE-2025-3102](https://nvd.nist.gov/vuln/detail/CVE-2025-3102)