## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意lfs对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 是 Git LFS 2.12.0 版本中的一个远程代码执行漏洞。根据提供的漏洞利用代码，攻击者可以通过创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库来触发此漏洞。当受害者克隆（clone）该仓库时，Git LFS 会尝试处理这些 LFS 对象，恶意 `.gitattributes` 文件中可以包含命令，使得执行任意命令。

**有效性：**
提供的POC代码包含一个批处理文件（git.bat）和一个PowerShell脚本(revsh_powersh.ps1), 批处理文件会先创建一个名为GITHACKED的文件, 然后执行powershell脚本，反弹shell。该利用方式是有效的，受害者clone仓库后即可触发。

**投毒风险：**
此仓库中存在潜在的投毒风险。虽然主要目的是演示CVE-2020-27955漏洞，但攻击者可能在提供的反弹shell脚本`revsh_powersh.ps1`中加入其他恶意代码，例如安装后门、窃取信息等。此外，`git.bat` 本身也可以被修改为执行更具破坏性的操作。例如, 修改`git.bat`在反弹shell之前或者之后执行其他的恶意指令。因此，存在一定的投毒可能性，但主要功能还是为了验证漏洞。 风险比例预估为10%。

**利用方式：**
1.  攻击者创建一个包含恶意 `.gitattributes` 文件和 LFS 对象的 Git 仓库。
2.  恶意 `.gitattributes` 文件包含指向恶意 LFS 对象的配置，并嵌入命令执行。
3.  受害者克隆（clone）该恶意仓库。
4.  当 Git LFS 尝试处理恶意 LFS 对象时，会执行 `.gitattributes` 文件中嵌入的命令，导致远程代码执行。
5.  PoC包含反弹shell的powershell脚本，执行后攻击者可以获取shell.

**项目地址:** [whitetea2424/CVE-2020-27955-LFS-main](https://github.com/whitetea2424/CVE-2020-27955-LFS-main)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)