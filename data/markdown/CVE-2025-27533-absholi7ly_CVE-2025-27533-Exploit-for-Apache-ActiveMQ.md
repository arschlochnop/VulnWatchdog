## CVE-2025-27533-Apache ActiveMQ-内存分配拒绝服务

**漏洞编号:** CVE-2025-27533

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** Apache ActiveMQ

**危害等级:** 中危，可能导致服务中断

**影响版本:** 6.0.0 < 6.1.6, 5.18.0 < 5.18.7, 5.17.0 < 5.17.7, < 5.16.8

**利用条件:** 需要网络访问ActiveMQ Broker，且未使用mutual TLS连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-27533是Apache ActiveMQ中的一个内存分配漏洞，攻击者可以通过发送包含过大缓冲区大小值的OpenWire命令，导致ActiveMQ Broker分配大量内存，从而耗尽服务器资源，造成拒绝服务攻击。

**有效性：**
提供的PoC代码尝试利用此漏洞。它通过创建一个包含巨大缓冲区大小的恶意数据包，并将其发送到目标ActiveMQ Broker来实现。代码会循环发送数据包，试图耗尽Broker的内存资源。根据漏洞描述，该PoC应该是有效的。

**投毒风险：**
代码中存在少量投毒的风险，评估为1%。主要是因为：
*   代码的目的是进行拒绝服务攻击，本身具有一定的攻击性。
*   虽然代码有检查服务器可用性的函数,但目标服务器依然存在被Dos的风险
*   虽然存在端口扫描和连接功能,但属于正常的连接功能,非恶意投毒代码

**利用方式：**
1.  **确定目标：** 确定目标Apache ActiveMQ Broker的IP地址和端口。
2.  **配置PoC：** 设置PoC代码中的目标IP地址、端口和数据包大小。
3.  **发送恶意数据包：** PoC代码会创建并发送包含过大缓冲区大小值的OpenWire命令数据包到目标Broker。
4.  **资源耗尽：** 目标Broker在处理恶意数据包时，会分配大量内存，导致资源耗尽。
5.  **拒绝服务：** Broker因资源耗尽而无法正常处理其他请求，导致拒绝服务。

**漏洞缓解措施：**
*   升级到Apache ActiveMQ 6.1.6+, 5.19.0+, 5.18.7+, 5.17.7, or 5.16.8。
*   实施Mutual TLS连接。

**项目地址:** [absholi7ly/CVE-2025-27533-Exploit-for-Apache-ActiveMQ](https://github.com/absholi7ly/CVE-2025-27533-Exploit-for-Apache-ActiveMQ)

**漏洞详情:** [CVE-2025-27533](https://nvd.nist.gov/vuln/detail/CVE-2025-27533)