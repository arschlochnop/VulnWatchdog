## CVE-2023-23397-Microsoft Outlook 权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致NTLM Relay攻击

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, 2016, 2019, Microsoft 365 Apps for Enterprise 和 Microsoft Office LTSC 2021

**利用条件:** 攻击者需要向受害者发送包含特制日历邀请的电子邮件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397 是一个 Microsoft Outlook 权限提升漏洞。攻击者可以通过发送包含特制日历邀请的电子邮件来利用此漏洞。漏洞利用的关键在于 `ReminderSoundFile` 字段，攻击者可以设置一个指向恶意 SMB 服务器的 UNC 路径。当 Outlook 处理这个日历邀请时，会尝试访问这个 UNC 路径，导致受害者的 Net-NTLM 哈希被发送到攻击者的服务器。这个哈希可以被用于 NTLM Relay 攻击，使攻击者能够冒充受害者。

根据提供的漏洞利用代码，POC.ps1 文件创建了一个 Outlook 日历邀请，并设置了 `ReminderSoundFile` 属性为一个 UNC 路径。攻击者需要修改第 11 行和第 12 行，分别设置攻击者控制的 UNC 路径和目标电子邮件地址。 README.md 文件提供了简单的使用说明。

有效性：提供的 POC 代码有效，可以触发漏洞，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的服务器。

投毒风险：分析 POC 代码内容，并未发现作者隐藏的投毒代码。该仓库中的代码主要用于验证漏洞和安全测试，没有发现任何恶意行为。因此投毒风险为 0%。

利用方式：
1.  攻击者创建一个恶意的日历邀请，其中 `ReminderSoundFile` 属性设置为指向攻击者控制的 SMB 服务器的 UNC 路径。
2.  攻击者将此日历邀请发送给受害者。
3.  当受害者使用 Outlook 打开并处理此日历邀请时，Outlook 会尝试访问 `ReminderSoundFile` 中指定的 UNC 路径。
4.  此操作会触发 SMB 身份验证，导致受害者的 Net-NTLM 哈希被发送到攻击者控制的 SMB 服务器。
5.  攻击者可以使用获得的 Net-NTLM 哈希进行 NTLM Relay 攻击，冒充受害者访问网络资源。

**项目地址:** [jacquesquail/CVE-2023-23397](https://github.com/jacquesquail/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)