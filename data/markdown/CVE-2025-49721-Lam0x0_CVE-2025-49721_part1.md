## CVE-2025-49721-Windows Fast FAT File System Driver-权限提升

**漏洞编号:** CVE-2025-49721

**漏洞类型:** 权限提升

**影响应用:** Windows Fast FAT File System Driver

**危害等级:** 高危，允许本地未授权的攻击者提升权限

**影响版本:** 受影响的Windows版本和build号范围见CVE描述

**利用条件:** 本地访问权限，用户交互 (UI:R) 

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49721是一个Windows Fast FAT文件系统驱动中的堆缓冲区溢出漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性评估：**

根据漏洞库信息和搜索结果，该漏洞真实存在，并且有POC代码可用。从POC代码来看，利用似乎依赖于`FatPrepareWriteVolumeFile`等函数的特定调用链，并且提到了微软在2025年7月补丁星期二修复了部分相关函数。POC代码特别指出在特定版本的Windows 22H2（2025年6月build）和Windows 24H2 (未安装7月补丁)上测试通过。

**投毒风险分析：**

提供的代码片段主要是漏洞利用的准备步骤说明，并非完整的可执行代码。因此，无法直接判断是否存在恶意代码。`README.md` 文件中提示"Please Be Careful!!!!"，这可能暗示了该漏洞利用的潜在风险，但不一定是投毒。由于只提供了漏洞利用说明，而没有提供可以直接运行的利用程序，所以投毒的概率较低，但也不能完全排除作者在其他未提供的代码中隐藏恶意行为，比如植入后门，因此将投毒风险评估为10%。

**利用方式分析：**

1.  **漏洞点：** 漏洞存在于`FatPrepareWriteVolumeFile`函数中，该函数在处理文件偏移量和长度时存在堆缓冲区溢出的风险。
2.  **触发条件：** 利用FAT12文件系统，通过构造特定的文件偏移和大小，绕过`Feature_673774907__private_IsEnabledDeviceUsageNoInline`函数中的检查。
3.  **利用链：** 通过`FatSetFatRun`或其他函数调用链，最终调用到`FatPrepareWriteVolumeFile`。
4.  **补丁绕过：** 在未安装2025年7月补丁的系统上，可以直接利用此漏洞。安装了补丁的系统，可能需要寻找其他绕过方法。
5.  **权限提升：** 成功利用该漏洞后，攻击者可以执行任意代码，从而提升本地权限。

**项目地址:** [Lam0x0/CVE-2025-49721_part1](https://github.com/Lam0x0/CVE-2025-49721_part1)

**漏洞详情:** [CVE-2025-49721](https://nvd.nist.gov/vuln/detail/CVE-2025-49721)