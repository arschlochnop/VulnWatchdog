## CVE-2025-49113-Roundcube-PHP对象反序列化

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.5.10, 1.6.0 <= version < 1.6.11

**利用条件:** 需要有效的Roundcube会话ID (已认证用户)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49113是Roundcube Webmail中存在的一个PHP对象反序列化漏洞。受影响的版本是1.5.10之前的1.5.x版本和1.6.11之前的1.6.x版本。该漏洞位于`program/actions/settings/upload.php`文件中，由于程序没有对URL中的`_from`参数进行充分验证，导致经过身份验证的用户可以通过构造恶意的PHP对象，并将其序列化后作为`_from`参数的值发送给服务器，从而触发PHP对象反序列化漏洞，最终导致远程代码执行。

**漏洞利用方式：**

1.  攻击者需要拥有一个有效的Roundcube Webmail会话（即已成功登录）。
2.  攻击者构造一个恶意的PHP对象，该对象包含需要执行的任意代码。在本PoC中，恶意对象的功能是向指定文件写入内容。
3.  攻击者将构造的PHP对象序列化，并URL编码。
4.  攻击者构造一个包含恶意payload的URL，将序列化后的payload作为`_from`参数的值。
5.  攻击者向目标服务器发送包含恶意URL的请求。
6.  服务器在处理请求时，反序列化`_from`参数中的数据，从而触发恶意代码的执行。
7.  PoC代码使用curl发送包含恶意payload的请求，最终在服务器上写入文件。

**投毒风险评估：**

分析提供的PoC代码，没有发现明显的投毒代码。该PoC的目的是演示漏洞利用，通过反序列化对象在目标服务器上写入文件。代码中包含详细的注释和警告信息，说明该PoC仅用于授权环境下的测试。

**总结：**

该漏洞利用有效，风险等级高危，利用条件相对简单，只需要一个有效的会话即可。


**项目地址:** [rasool13x/exploit-CVE-2025-49113](https://github.com/rasool13x/exploit-CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)