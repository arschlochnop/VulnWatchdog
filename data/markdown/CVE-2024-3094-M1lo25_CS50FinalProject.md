## CVE-2024-3094 XZ Utils Backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务间接链接到liblzma。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3094是一个供应链攻击，恶意代码被植入到XZ Utils的5.6.0和5.6.1版本中。这个后门通过一系列复杂的混淆手段，在构建过程中从伪装的测试文件中提取预编译的目标文件，用于修改liblzma库中的特定函数。受影响的liblzma库会被链接到其他软件，包括sshd，从而允许攻击者在SSH认证过程中进行拦截和修改数据，从而可能实现未经授权的远程访问。

**有效性：** 根据漏洞信息，这个漏洞利用依赖于恶意代码存在于XZ Utils的特定版本中。提供的“漏洞利用代码”实际上是关于该漏洞的描述、参考资料和一个演示文稿。 它本身不包含可执行的利用代码，但提供了理解漏洞原理和缓解措施的背景信息。因此，提供的代码本身不直接可用作POC，但确认了漏洞的存在和影响。

**投毒风险：** 该仓库的主要目的是提供关于XZ Utils后门的学习材料。虽然仓库本身可能不包含直接的恶意代码（与XZ Utils tarball 中的后门不同），但是仓库内的信息可能被恶意行为者利用。此外，任何通过不可信渠道下载的软件包都存在被篡改的风险，但这个风险和仓库本身的投毒风险不是一回事，这里主要分析作者在这个仓库中是否留下了投毒代码。考虑到作者在演示中明确表明了漏洞发现者的贡献，且内容主要是信息汇总和演示，主观判定其存在投毒代码的可能性较低，但不能完全排除，例如在链接中故意包含恶意链接等情况，因此投毒风险评估为 5%。这个百分比主要衡量的是该仓库被用于传播其他恶意软件或信息的可能性。

**利用方式：** 漏洞利用方式的核心在于：
1.  **恶意代码注入：** 攻击者通过复杂的构建过程，将恶意代码注入到liblzma库中。
2.  **SSH 拦截：** 修改后的liblzma库被sshd等程序链接后，攻击者能够拦截并修改SSH认证过程中的数据。
3.  **未经授权访问：** 通过篡改认证过程，攻击者可能绕过身份验证，获得对受害系统的远程访问权限。

简单来说，利用方式是：受感染的XZ Utils -> 恶意liblzma -> sshd -> 未授权远程访问。

**项目地址:** [M1lo25/CS50FinalProject](https://github.com/M1lo25/CS50FinalProject)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)