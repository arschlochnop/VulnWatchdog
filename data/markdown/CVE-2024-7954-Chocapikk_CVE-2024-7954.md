## CVE-2024-7954-SPIP-porte_plume-RCE

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 4.3.0-alpha2, < 4.2.13, < 4.1.16

**利用条件:** 目标服务器运行受影响的SPIP版本，且porte_plume插件已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求，以SPIP用户的身份执行任意PHP代码。漏洞位于`echappe_retour()`函数对模板数据的处理，最终导致`traitements_previsu_php_modeles_eval()`函数执行包含`eval()`的恶意代码。

**漏洞利用方式：**

1.  攻击者发送包含恶意PHP代码的特制HTTP请求到SPIP服务器。
2.  `echappe_retour()`函数处理请求中的恶意代码。
3.  `traitements_previsu_php_modeles_eval()`函数执行`eval()`，从而执行攻击者注入的PHP代码。
4.  攻击者获得服务器的远程代码执行权限。

**关于POC的有效性：**

根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且存在公开的PoC利用代码。提供的PoC代码包含Dockerfile，表明其可以搭建一个存在漏洞的环境。提供的Python脚本`exploit.py`具备利用该漏洞的能力，因此该PoC代码是有效的。

**关于投毒风险：**

代码存在一定的投毒风险，概率为10%。尽管PoC本身是为了演示漏洞利用，但攻击者可能会在PoC中加入恶意代码，例如反向Shell、植入后门等。需要对PoC代码进行仔细审查，以确保其安全性。在没有完全理解代码逻辑的情况下，直接运行PoC代码存在风险。

**风险评估：**

由于该漏洞是未经身份验证的远程代码执行漏洞，CVSS评分高达9.8，风险极高。攻击者可以利用此漏洞完全控制受影响的SPIP服务器，造成数据泄露、服务中断等严重后果。

**缓解措施：**

*   尽快将SPIP升级到不受影响的版本（>= 4.3.0-alpha2, >= 4.2.13, >= 4.1.16）。
*   如果无法立即升级，可以禁用porte_plume插件。
*   部署Web应用程序防火墙（WAF），以检测和阻止恶意HTTP请求。

**项目地址:** [Chocapikk/CVE-2024-7954](https://github.com/Chocapikk/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)