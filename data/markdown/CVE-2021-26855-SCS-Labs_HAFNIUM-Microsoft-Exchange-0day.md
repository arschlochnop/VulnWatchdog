## CVE-2021-26855 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 严重，可导致远程代码执行

**影响版本:** 受影响的版本包括 Microsoft Exchange Server 2013 Cumulative Update 21/22/23, 2016 Cumulative Update 8/9/10/11/12/13/14/15/16/17/18/19, 和 2019 Cumulative Update 1/2/3/4/5/6/7/8

**利用条件:** 需要目标 Exchange Server 存在漏洞，攻击者通常需要能够访问 Exchange Server 的网络端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是一个存在于 Microsoft Exchange Server 中的服务器端请求伪造（SSRF）漏洞。该漏洞允许未经身份验证的远程攻击者发送任意 HTTP 请求并以 Exchange 服务器的身份进行身份验证。该漏洞通常与其他漏洞（如 CVE-2021-26857, CVE-2021-26858, CVE-2021-27065）组合利用，形成完整的攻击链（ProxyLogon）。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是微软官方博客和第三方安全公司的分析）和提供的漏洞利用代码（描述了与其他漏洞的配合），可以判断该漏洞的POC代码是有效的。许多公开报告表明该漏洞已被积极利用。

**投毒风险：**
提供的漏洞利用代码主要是关于漏洞信息的收集整理，包括受影响版本、漏洞描述、时间线等。虽然不能完全排除投毒的可能，但从代码内容来看，直接包含恶意代码的可能性较低。风险主要在于：

1.  **信息误导：** 文档中的缓解措施、检测方法可能存在偏差，导致防御效果不佳。
2.  **利用链依赖：** 该漏洞通常需要与其他漏洞配合利用，整理的利用链信息可能不完整或者存在错误引导。
3.  **后期更新：** 该文档后期可能被恶意修改，加入恶意代码或者篡改关键信息。

因此，综合判断投毒风险为 10%。

**利用方式：**
1.  **SSRF 攻击：** 攻击者利用 CVE-2021-26855 发送恶意的 HTTP 请求到 Exchange 服务器。
2.  **身份验证绕过：** 通过 SSRF 漏洞，攻击者可以绕过 Exchange Server 的身份验证机制，冒充 Exchange 服务器本身。
3.  **漏洞链利用：** 结合其他漏洞 (如 CVE-2021-26857 统一消息服务中的不安全的反序列化漏洞，以及 CVE-2021-26858 和 CVE-2021-27065 身份验证后的任意文件写入漏洞) ，最终实现远程代码执行。
4.  **写入 Webshell：** 利用文件写入漏洞，攻击者可以将恶意的 Webshell 文件写入到 Exchange 服务器的 Web 目录下。
5.  **远程代码执行：** 攻击者通过访问 Webshell 执行任意代码，控制 Exchange 服务器。

总而言之，CVE-2021-26855 是 ProxyLogon 攻击链中的关键一步，攻击者利用该漏洞实现身份验证绕过，为后续的漏洞利用铺平道路。

**项目地址:** [SCS-Labs/HAFNIUM-Microsoft-Exchange-0day](https://github.com/SCS-Labs/HAFNIUM-Microsoft-Exchange-0day)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)