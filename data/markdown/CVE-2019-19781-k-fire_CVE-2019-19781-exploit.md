## CVE-2019-19781-Citrix ADC和Gateway目录遍历及远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 存在于Citrix ADC和Gateway中，是一个目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件。结合其他漏洞，例如文件上传，可能导致远程代码执行。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被广泛利用。Rapid7、Palo Alto Networks等安全公司均发布了关于此漏洞的分析报告和利用示例，证明其有效性。CISA也将该漏洞列入已知被利用漏洞目录。

**投毒风险：**
提供的漏洞利用代码中仅包含一个`README.md`文件和一个图片链接，没有发现直接的投毒代码。图片链接本身可能存在风险，例如追踪IP等，但直接投毒的可能性较小。因此，投毒风险较低，估计为5%。主要的风险可能来自于下载和运行其他未知的恶意脚本或程序。

**利用方式：**
利用方式主要包括：
1.  **目录遍历：** 通过构造特殊的URL，绕过Citrix ADC和Gateway的访问控制，读取服务器上的敏感文件，例如配置文件、日志文件等。
2.  **远程代码执行：** 结合目录遍历，可以上传恶意文件（例如Webshell）到服务器上，然后通过目录遍历漏洞访问上传的文件，从而执行任意代码。

根据搜索结果，实际的漏洞利用过程通常涉及到精心构造的HTTP请求，利用`..`进行目录穿越，最终达到读取敏感文件或执行恶意代码的目的。

此外，需要注意的是，该漏洞已被多个恶意软件利用，例如NOTROBIN。

**建议：**
尽快升级Citrix ADC和Gateway到最新版本，或采取Citrix官方提供的缓解措施。

**项目地址:** [k-fire/CVE-2019-19781-exploit](https://github.com/k-fire/CVE-2019-19781-exploit)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)