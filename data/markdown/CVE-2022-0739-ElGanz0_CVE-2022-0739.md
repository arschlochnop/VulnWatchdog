## CVE-2022-0739 - BookingPress - Unauthenticated SQL Injection

**漏洞编号:** CVE-2022-0739

**漏洞类型:** SQL注入

**影响应用:** BookingPress WordPress Plugin

**危害等级:** 高危，可能导致数据泄露和服务器控制

**影响版本:** < 1.0.11

**利用条件:** 目标wordpress站点安装了存在漏洞的BookingPress插件，且可以访问/wp-admin/admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于BookingPress WordPress插件1.0.11之前的版本中。未经身份验证的攻击者可以通过向`bookingpress_front_get_category_services` AJAX action发送包含恶意SQL代码的POST请求来利用此漏洞。漏洞位于`category_id`和`total_service`参数的SQL查询构造中，攻击者通过SQL注入可以读取数据库中的敏感信息，如用户名、密码哈希等，甚至可能控制整个服务器。提供的POC代码首先通过GET请求获取_wpnonce值，然后构造包含SQL注入payload的POST请求发送到/wp-admin/admin-ajax.php。Payload利用UNION ALL SELECT语句从wp_users表中提取user_login, user_email, user_pass等信息。分析了POC代码，没有发现任何明显的投毒行为，该代码仅用于利用该SQL注入漏洞。

**项目地址:** [ElGanz0/CVE-2022-0739](https://github.com/ElGanz0/CVE-2022-0739)

**漏洞详情:** [CVE-2022-0739](https://nvd.nist.gov/vuln/detail/CVE-2022-0739)