## CVE-2024-0204 GoAnywhere MFT Authentication Bypass

**漏洞编号:** CVE-2024-0204

**漏洞类型:** Authentication Bypass

**影响应用:** GoAnywhere MFT

**危害等级:** Critical，未经授权的用户可以创建管理员用户，完全控制系统

**影响版本:** < 7.4.1

**利用条件:** 需要能够访问GoAnywhere MFT的管理门户。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0204 是 Fortra GoAnywhere MFT 中存在的一个身份验证绕过漏洞。未经身份验证的攻击者可以通过访问 `InitialAccountSetup.xhtml` 页面来创建一个新的管理员用户。此漏洞影响 GoAnywhere MFT 7.4.1 之前的版本。

**有效性：**
提供的POC代码看起来是有效的。它通过以下步骤利用该漏洞：

1.  构造请求来访问 `InitialAccountSetup.xhtml` 页面。
2.  提取页面中的 `javax.faces.ViewState` 值，这是 JSF 框架用于维护服务器端状态的隐藏字段。
3.  构造 POST 请求，其中包含新管理员用户的用户名和密码，以及上一步提取的 `ViewState` 值。
4.  发送此 POST 请求到 `InitialAccountSetup.xhtml` 页面。
5.  如果成功，则会创建一个新的管理员用户。

**投毒风险：**
代码本身看起来相对简单和直接。`generate_random_string`函数用于生成随机的用户名和密码，降低了利用的确定性，但是提高了隐蔽性。`ensure_https`函数强制使用HTTPS协议，这通常是安全最佳实践，但可能被解释为一种强制流量加密从而隐藏恶意行为的方式。对`InsecureRequestWarning`的禁用可能被利用,但属于poc代码验证环节必要操作,不是投毒行为.

*   **低概率投毒：** 代码中唯一可疑的地方是强制HTTPS和禁用`InsecureRequestWarning`，尽管这不是直接的投毒行为，但可能使某些恶意利用场景更难被检测。总的来说，投毒风险较低，大约为5%。

**利用方式：**

1.  **目标识别：** 找到运行着易受攻击版本的 GoAnywhere MFT 的服务器。
2.  **页面访问：** 访问 `InitialAccountSetup.xhtml` 页面，通常无需身份验证。
3.  **ViewState 获取：** 从页面HTML源码提取 `javax.faces.ViewState` 参数。
4.  **用户创建：** 使用 POST 请求，将包含 ViewState 和新管理员帐户详细信息的 payload 发送到 `InitialAccountSetup.xhtml`。
5.  **权限获取：** 使用新创建的管理员帐户登录 GoAnywhere MFT 管理控制台并获取完全控制权。

**项目地址:** [m-cetin/CVE-2024-0204](https://github.com/m-cetin/CVE-2024-0204)

**漏洞详情:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)