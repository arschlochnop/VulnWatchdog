## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化漏洞

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和/或信息泄露和/或信息篡改

**影响版本:** 9.0.0.M1 <= 版本 <= 9.0.98, 10.1.0-M1 <= 版本 <= 10.1.34, 11.0.0-M1 <= 版本 <= 11.0.2

**利用条件:** Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 目标 URL 是公共上传 URL 的子目录, 攻击者知道安全敏感文件的名称, 安全敏感文件也通过 partial PUT 上传。或者 Default Servlet 启用了写入 (默认禁用), 支持 partial PUT (默认启用), 应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置, 应用程序包含一个可以在反序列化攻击中利用的库。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，通过 ‘file.Name’ (Internal Dot) 导致远程代码执行和/或信息泄露和/或恶意内容添加到通过启用写入的 Default Servlet 上传的文件中。

**漏洞利用方式：**

根据漏洞描述，利用方式有两种：

1.  **信息泄露/内容篡改：** 如果满足以下条件，攻击者可以查看安全敏感文件和/或将内容注入到这些文件中：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件也通过 partial PUT 上传。

2.  **远程代码执行 (RCE)：** 如果满足以下条件，攻击者可以执行远程代码：
    *   启用了 default servlet 的写入功能（默认禁用）。
    *   支持 partial PUT（默认启用）。
    *   应用程序正在使用 Tomcat 的基于文件的会话持久性，且使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**POC代码分析:**

提供的POC代码是一个 Go 语言编写的利用脚本，尝试利用该漏洞上传JSP webshell。

*   **有效性：**
    *   POC代码通过PUT请求上传一个JSP webshell（`SHELL_JSP`）到多个可能的目录（`DIR_List`），文件名为`update_log.jsp`。
    *   POC代码会检测服务器返回的状态码是否为200, 201 或者 204, 并且尝试通过GET请求验证JSP webshell是否成功上传，检查返回内容是否包含 `java.lang.NullPointerException` 或者 webshell内容.
    *   如果上传成功，将 URL 写入 `Shelled.txt` 文件。
    *   代码实现了协议探测函数`DetectProtocol`，尝试使用HTTP和HTTPS访问目标。

    因此，POC代码在特定配置下是有效的。

*   **投毒风险：**

    POC代码的主要目的是利用漏洞上传 webshell，没有发现明显的恶意代码，主要的操作是PUT和GET请求。
    代码中唯一可以算作风险的地方是它会尝试连接目标服务器并上传 webshell。但这些是漏洞利用的必要步骤,没有发现任何作者的私有后门或者恶意代码行为。
    投毒风险极低，可以认为是1%。

**搜索引擎结果:**

搜索引擎结果表明 CVE-2025-24813 漏洞正在被积极利用，攻击者利用该漏洞执行远程代码。

总体而言，CVE-2025-24813 是一个严重的安全漏洞，攻击者可以利用该漏洞执行恶意代码或泄露敏感信息。该漏洞利用的有效性较高，但默认配置下，写入功能是禁用的，漏洞利用条件较为苛刻。

**项目地址:** [drcrypterdotru/Apache-GOExploiter](https://github.com/drcrypterdotru/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)