## CVE-2025-1974-ingress-nginx RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群范围内的 Secrets 泄露和完全控制。

**影响版本:** <= 1.11.4 和 1.12.0

**利用条件:** 需要访问 Kubernetes Pod 网络。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1974 是 Kubernetes ingress-nginx 中的一个严重漏洞，允许未经身份验证的攻击者通过 Pod 网络实现远程代码执行。攻击者能够利用 Validating Admission Controller 的缺陷，通过模板注入执行任意代码。从搜索引擎的返回结果来看，这是一个广为人知的漏洞，被称为“IngressNightmare”，多个安全厂商都发布了关于该漏洞的分析和缓解措施。提供的漏洞利用代码仅包含一个 README.md 文件，说明它可能是一个实验环境，用于演示漏洞，或者是一个不完整的 PoC。由于PoC代码只有说明文件，无法判断其是否存在后门，因此推测投毒的概率为0%。根据漏洞描述和搜索结果，利用方式是攻击者需要能够访问 Kubernetes 集群的 Pod 网络。利用方式大致如下:

1.  **访问 Pod 网络:** 攻击者需要某种方式进入 Pod 网络，例如通过已有的 compromised pod。 
2.  **利用 Admission Controller:** 攻击者构造特定的请求，利用 ingress-nginx 的 Validating Admission Controller 中的模板注入漏洞。 
3.  **远程代码执行:**  成功利用漏洞后，攻击者可以在 ingress-nginx controller 的上下文中执行任意代码。 
4.  **获取 Secrets:**  由于 ingress-nginx controller 通常具有访问集群中所有 Secrets 的权限（默认安装），攻击者可以窃取敏感信息。

修复建议是升级到不受影响的版本，或者禁用 Validating Admission Controller 功能作为临时缓解措施。

**项目地址:** [Armand2002/Exploit-CVE-2025-1974-Lab](https://github.com/Armand2002/Exploit-CVE-2025-1974-Lab)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)