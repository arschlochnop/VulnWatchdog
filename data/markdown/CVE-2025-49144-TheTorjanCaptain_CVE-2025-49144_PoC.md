## CVE-2025-49144 Notepad++ 本地提权漏洞

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 本地提权

**影响应用:** Notepad++

**危害等级:** 高危，允许低权限用户获取SYSTEM权限

**影响版本:** < 8.8.2

**利用条件:** 用户需要下载并运行恶意程序和存在漏洞的Notepad++安装程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49144是Notepad++ 8.8.1及更早版本中存在的一个本地提权漏洞。该漏洞源于安装程序中不安全的可执行文件搜索路径。攻击者可以将恶意regsvr32.exe文件与合法的Notepad++安装程序放在同一目录下，当用户运行安装程序时，由于Windows搜索路径的机制，安装程序会调用恶意的regsvr32.exe而不是系统自带的，从而以SYSTEM权限执行攻击者的代码。 

**有效性：**

根据提供的漏洞库信息，搜索引擎结果，以及漏洞利用代码，该漏洞的POC代码有效。

**投毒风险：**

POC 代码中存在一定投毒风险，主要体现在以下几个方面：

1.  **shellcode.txt的来源：** POC 依赖于用户自行生成 shellcode (msfvenom)。用户需要自行确保生成的shellcode来源安全，存在被植入恶意代码的可能性。
2.  **regsvr32_loader.c的修改：** POC 需要用户下载并修改 regsvr32_loader.c 文件，并将shellcode粘贴到其中。 这给攻击者留下了植入恶意代码的机会。
3.  **免责声明和MIT许可证：**  虽然POC代码包含MIT许可证和免责声明，但这并不能完全保证代码的安全性。 许可证表明代码可以被修改和分发，但恶意行为者可能会利用这一点来传播包含恶意软件的修改版本。
4.  **漏洞利用方式需要禁用Windows Defender：**  POC中提到需要在禁用Windows Defender和实时保护的情况下进行测试。这本身就是一种警告信号，表明攻击可能需要绕过安全措施，这本身就增加了风险。

虽然核心的漏洞利用逻辑相对直接，但集成的 shellcode 和对代码的修改步骤引入了风险。所以说有10%的风险。

**利用方式：**

1.  攻击者生成恶意shellcode，例如使用`msfvenom`。
2.  攻击者下载`regsvr32_loader.c`文件并编辑该文件，将shellcode插入其中。
3.  攻击者将`regsvr32_loader.c`编译为`regsvr32.exe`。
4.  攻击者将恶意的`regsvr32.exe`文件和存在漏洞的Notepad++安装程序放在同一目录下，诱导用户运行Notepad++安装程序。
5.  当用户运行安装程序时，恶意的`regsvr32.exe`会以SYSTEM权限执行，从而实现提权。


**项目地址:** [TheTorjanCaptain/CVE-2025-49144_PoC](https://github.com/TheTorjanCaptain/CVE-2025-49144_PoC)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)