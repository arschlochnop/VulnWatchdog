## CVE-2025-3969-News Publishing Site Dashboard-Unrestricted Upload

**漏洞编号:** CVE-2025-3969

**漏洞类型:** Unrestricted Upload

**影响应用:** News Publishing Site Dashboard

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.0

**利用条件:** 需要登录后台并具有编辑分类权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3969 存在于 codeprojects News Publishing Site Dashboard 1.0 的编辑分类页面（edit-category.php），允许经过身份验证的攻击者上传任意文件，导致远程代码执行。攻击者需要首先登录后台，然后利用 category_image 参数上传恶意的 PHP 文件。由于 Content-Type 验证不完善，可以绕过限制。漏洞利用代码首先尝试登录后台，然后构造包含恶意 PHP 代码的 multipart/form-data 请求，上传到服务器的 upload/category/ 目录下。通过访问上传的 PHP 文件，攻击者可以执行任意命令。搜索引擎结果也表明该漏洞允许未经验证的远程文件上传。

**有效性：**提供的POC代码有效，它完整地实现了漏洞利用的流程，包括登录、构造恶意请求和执行上传。

**投毒风险：** 风险较低。代码本身结构清晰，主要功能是利用漏洞，但仍然存在一定的投毒风险。 代码作者链接的Github以及buymeacoffee链接可能存在一定的风险。 代码中随机选择MIME_TYPES，可能绕过一些简单的文件类型验证，但不是恶意行为。因此，我评估投毒风险为10%。

**利用方式：**
1.  使用提供的脚本 CVE-2025-3969.py。
2.  指定目标 URL、用户名和密码。
3.  脚本将尝试登录到 News Publishing Site Dashboard。
4.  如果登录成功，脚本将构造一个包含恶意 PHP 代码的 multipart/form-data 请求，其中 category_image 参数包含恶意代码。
5.  脚本使用随机选择的 MIME 类型绕过文件类型验证。
6.  恶意文件上传到服务器的 upload/category/ 目录下，文件名为时间戳加 .php 后缀。
7.  脚本尝试从category页面解析上传的文件路径，并打印访问恶意文件的 URL。
8.  攻击者可以通过浏览器访问此 URL 来执行上传的 PHP 代码，从而实现远程代码执行。

**项目地址:** [Stuub/CVE-2025-3969-Exploit](https://github.com/Stuub/CVE-2025-3969-Exploit)

**漏洞详情:** [CVE-2025-3969](https://nvd.nist.gov/vuln/detail/CVE-2025-3969)