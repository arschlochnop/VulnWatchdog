## CVE-2025-31125-Vite-文件读取

**漏洞编号:** CVE-2025-31125

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 受影响版本：< 4.5.11, >= 5.0.0, < 5.4.16, >= 6.0.0, < 6.0.13, >= 6.1.0, < 6.1.3, >= 6.2.0, < 6.2.4

**利用条件:** Vite dev server 需暴露在网络中 (使用 --host 或 server.host 配置)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31125 漏洞允许攻击者绕过 Vite 的 `server.fs.deny` 限制，通过 `?inline&import` 或 `?raw?import` 查询参数读取未授权的文件。根据漏洞描述和搜索引擎结果，利用成功的关键在于 Vite 的开发服务器需要显式地暴露在网络上。POC 代码 `main.py` 尝试读取 `/etc/passwd` (Linux) 和 `C://windows/win.ini` (Windows) 文件，如果返回包含 `data:application/octet-stream;base64` 的内容，则判断为存在漏洞。 

**有效性评估:**
提供的 POC 代码利用了漏洞描述中提到的 `?import` 和 `?inline` 参数来尝试读取敏感文件，并检查响应内容中是否存在特定特征。根据漏洞描述，只有当 Vite 的开发服务器暴露在网络上时，漏洞才可被利用。因此，在满足该条件的情况下，POC 代码应该是有效的。

**投毒风险分析:**
代码中存在投毒的可能性较低，大约5%。
*   `requirements.txt` 文件缺失，无法判断是否存在恶意依赖。
*   `main.py` 脚本的功能相对简单，主要就是发送HTTP请求并判断响应。虽然存在通过修改请求头，User-Agent等方式来隐藏恶意行为的可能性，但目前的代码来看，并没有明显的恶意行为。
*   脚本会连接目标服务器，存在信息泄露的可能，目标服务器可能记录IP，User-Agent等信息

**利用方式：**
1.  目标 Vite 应用需配置为将开发服务器暴露到网络，或者攻击者位于可访问开发服务器的网络中。
2.  攻击者构造包含 `?inline&import` 或 `?raw?import` 查询参数的 URL，指向要读取的目标文件。
3.  Vite 服务器处理请求，绕过 `server.fs.deny` 限制，将目标文件的内容作为模块返回。
4.  攻击者检查响应内容，提取目标文件的内容。

**项目地址:** [sunhuiHi666/CVE-2025-31125](https://github.com/sunhuiHi666/CVE-2025-31125)

**漏洞详情:** [CVE-2025-31125](https://nvd.nist.gov/vuln/detail/CVE-2025-31125)