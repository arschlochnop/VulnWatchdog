## CVE-2015-3306-ProFTPD-任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 1.3.5

**利用条件:** 目标系统运行 ProFTPD 1.3.5，且开启 mod_copy 模块

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 的 mod_copy 模块中。攻击者可以通过发送 `SITE CPFR` 和 `SITE CPTO` 命令，利用该模块中的缺陷，实现对服务器上任意文件的读取和写入。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的 Dockerfile，可以判断此漏洞是真实存在的，并且存在公开的利用代码。提供的Dockerfile构建了一个存在漏洞的环境，因此POC验证的有效性较高。

**投毒风险分析：**
分析提供的 Dockerfile 和 shell 脚本，代码本身的功能是构建包含漏洞的 ProFTPD 1.3.5 环境，没有发现明显的恶意代码。Dockerfile 从官方 FTP 服务器下载 ProFTPD 1.3.5 的源代码进行编译安装，`main.sh` 脚本只是启动了 Apache 和 ProFTPD 服务。虽然没有发现直接的投毒代码，但存在以下潜在风险：

1.  **依赖风险：** Dockerfile 使用 wget 从 `ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz` 下载 ProFTPD 的源码。如果该 FTP 服务器被攻陷，恶意攻击者可能会篡改该压缩包，植入后门。
2.  **配置风险：** `main.sh` 中启动了 Apache 服务，并且使用了 `chmod 777 -R /var/www/html/` 命令，赋予了 `/var/www/html/` 目录及其所有子目录和文件完全的读写执行权限。这会导致 Apache 目录下的文件（例如 PHP 文件）可以被任意用户修改，可能被用于上传 Webshell。

综上，该 Dockerfile 本身没有明显的投毒代码，主要风险在于对外部依赖的信任和不安全的配置。因此，投毒风险判断为10%。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径。
3.  攻击者使用 `SITE CPTO` 命令指定复制的目标文件路径。
4.  通过构造恶意的源文件或目标文件路径，攻击者可以读取或写入服务器上的任意文件，从而可能执行任意代码。

**项目地址:** [cved-sources/cve-2015-3306](https://github.com/cved-sources/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)