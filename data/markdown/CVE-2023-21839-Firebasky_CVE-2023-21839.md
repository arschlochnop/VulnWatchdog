## CVE-2023-21839 Oracle WebLogic Server 未授权访问漏洞

**漏洞编号:** CVE-2023-21839

**漏洞类型:** 未授权访问

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致数据泄露或完全控制服务器

**影响版本:** 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问，目标WebLogic Server的T3或IIOP端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-21839是Oracle WebLogic Server中的一个未授权访问漏洞。未经身份验证的攻击者可以通过T3或IIOP协议利用此漏洞，访问敏感数据。根据漏洞利用代码分析，该漏洞发生在WebLogic Server处理JNDI lookup/list操作时，`getObjectInstance`方法被调用，导致攻击者可以控制JNDI绑定对象，从而执行恶意代码。利用方式是通过JNDI注入，利用LDAP服务器返回恶意对象，进而执行任意代码。

**有效性：**
从漏洞库信息和搜索引擎结果来看，此漏洞容易被利用且危害较高。提供的漏洞利用代码也给出了详细的利用方法和调用栈分析，验证了漏洞的有效性。

**投毒风险：**
该漏洞利用代码主要包含一个`readme.md`文件和一个`CVE-2023-21839.jar`，其中`readme.md`仅为漏洞分析和利用说明。`CVE-2023-21839.jar`的安全性无法仅从提供的资料直接判断，需要进行反编译和代码审计，才能确认是否存在隐藏的恶意代码。考虑到攻击者可能为了提高漏洞利用的成功率或植入后门，存在一定的投毒风险，但根据目前的信息，无法确定`CVE-2023-21839.jar` 是否包含恶意后门，暂定投毒风险为10%。

**利用方式：**
1.  攻击者通过T3或IIOP协议连接到目标WebLogic Server。
2.  攻击者利用JNDI注入，通过`foreignOpaqueRef`, `foreignOpaqueRef2`, `AggtableOpaqueRef`, `linkRef`等对象，指定恶意的LDAP服务器地址。
3.  WebLogic Server尝试从攻击者控制的LDAP服务器获取对象。
4.  LDAP服务器返回一个恶意的Java对象，该对象在被WebLogic Server反序列化时执行恶意代码。
5.  攻击者从而获得服务器的控制权。

**项目地址:** [Firebasky/CVE-2023-21839](https://github.com/Firebasky/CVE-2023-21839)

**漏洞详情:** [CVE-2023-21839](https://nvd.nist.gov/vuln/detail/CVE-2023-21839)