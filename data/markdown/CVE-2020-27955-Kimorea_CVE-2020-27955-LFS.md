## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 受害者需要clone包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Git LFS 2.12.0版本中，允许远程代码执行。攻击者可以通过创建一个包含恶意`.gitattributes`文件和精心构造的LFS对象的Git仓库来利用此漏洞。当受害者克隆该仓库时，Git LFS会尝试处理恶意对象，触发`.gitattributes`中定义的命令执行。根据POC代码，利用方式为：

1.  **创建恶意仓库：** 仓库包含 `.gitattributes` 文件，该文件定义了如何处理特定的文件类型。攻击者会在 `.gitattributes` 中插入恶意命令，例如执行脚本或系统命令。
2.  **创建LFS对象：** 创建一个伪装成 LFS 对象的文件。文件的内容可以是任意的，但重要的是与`.gitattributes`中定义的文件类型相匹配，以便触发 LFS 处理流程。
3.  **诱导受害者克隆仓库：** 攻击者将恶意仓库分享给受害者，诱导其克隆。
4.  **触发RCE：** 当受害者克隆仓库时，Git LFS 会根据 `.gitattributes` 文件的配置尝试处理 LFS 对象，从而执行攻击者预设的恶意命令。

漏洞利用代码中，`git.bat` 脚本展示了如何在Windows环境下触发漏洞。它首先创建一个简单的测试文件，然后尝试执行 `powershell -NoProfile -NonInteractive -ExecutionPolicy Bypass .\revsh_powersh.ps1`，这是一个反向shell脚本。 `revsh_powersh.ps1` 尝试连接到 `192.168.254.128:1111`。

**有效性分析：**  根据漏洞描述和提供的POC代码，该漏洞利用方法是有效的。视频PoC也佐证了其有效性。POC代码已经给出了完整的利用链，包括恶意仓库的构建和RCE的触发。

**投毒风险分析：**

虽然提供的POC代码主要展示了如何利用漏洞进行RCE，但仍然存在一定的投毒风险。例如：

*   `revsh_powersh.ps1` 如果被替换成其他恶意脚本，那么接收反向shell的主机可能会受到进一步的攻击。
*   `.gitattributes` 中的命令可以被精心构造，以执行更隐蔽或破坏性更强的操作，例如删除关键文件、篡改系统配置等。

 总体评估，投毒风险较低，大约10%，因为主要的攻击向量是RCE，而POC相对清晰。潜在的投毒风险主要集中在攻击者替换反向shell脚本或修改`.gitattributes`中的命令上。

**项目地址:** [Kimorea/CVE-2020-27955-LFS](https://github.com/Kimorea/CVE-2020-27955-LFS)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)