## CVE-2022-21449 Psychic Signatures Java Vulnerability

**漏洞编号:** CVE-2022-21449

**漏洞类型:** ECDSA签名绕过

**影响应用:** Oracle Java SE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，允许未授权的创建、删除或修改关键数据

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 需要受影响的Java版本以及能够利用API或沙盒环境加载恶意代码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21449，又名"Psychic Signatures"，是一个存在于Java ECDSA签名验证算法中的高危漏洞。根据搜索结果和漏洞利用代码，该漏洞利用方式如下：

1.  **漏洞原理：** 漏洞源于Java 15引入的ECDSA签名验证实现不当。攻击者可以通过提供特定的、格式错误的签名（例如，将签名中的r和s值设置为零）来绕过签名验证。
2.  **利用方式：**
    *   利用代码 `accessControl.java` 模拟了受影响的Java应用，使用ECDSA签名进行访问控制。
    *   `configClass.java` 包含了UI界面信息和源代码，似乎是展示漏洞利用的场景，模拟一个需要验证的锁。
    *   `mainClass.java` 和 `mainWindow.java` 构建了一个GUI界面，用于演示漏洞利用。
    *   攻击者利用此漏洞可以通过网络访问存在漏洞的Java应用程序，并提交伪造的签名，无需有效密钥即可通过身份验证并执行未授权的操作，例如修改数据，访问资源等。
    *   参考 `notkmhn/CVE-2022-21449-TLS-PoC`,此漏洞可以通过构造恶意的TLS服务器来进行利用，客户端Java应用在TLS握手期间会验证服务器的证书签名，通过构造特殊的签名可以绕过验证。

3.  **有效性：** 提供的PoC代码似乎有效，它演示了在受影响的Java版本上如何绕过ECDSA签名验证。漏洞利用代码中的注释 `USE JDK 17.0.0, otherwise the exploit won't work` 表明PoC的有效性依赖于特定的Java版本。

4.  **投毒风险：**  虽然漏洞利用代码主要是用于演示漏洞，但仍存在一定的投毒风险。`configClass.java` 文件中包含一些HTML代码, 这些代码中存在通过着色来隐藏恶意代码的可能。`screenshot.png`的存在也可能隐藏恶意代码，尽管可能性较低，考虑到安全因素，给于10%的投毒风险。

总之，CVE-2022-21449是一个严重的安全漏洞，允许未经身份验证的攻击者绕过签名验证并执行恶意操作。提供的PoC代码可以有效地演示该漏洞，但需要注意潜在的投毒风险。

**项目地址:** [Skipper7718/CVE-2022-21449-showcase](https://github.com/Skipper7718/CVE-2022-21449-showcase)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)