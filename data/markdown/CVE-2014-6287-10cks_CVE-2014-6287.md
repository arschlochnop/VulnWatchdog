## CVE-2014-6287-Rejetto HFS-远程代码执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 目标服务器运行受影响版本的Rejetto HFS，且攻击者可以访问该服务器。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 直到 2.3c 版本的 `parserLib.pas` 文件中的 `findMacroMarker` 函数。攻击者可以通过在 search action 中使用 %00 序列来执行任意程序。 

**利用方式：**

1.  攻击者构造一个包含恶意命令的 URL，该 URL 利用了 HFS 在处理 search 请求时对 %00 序列处理不当的问题。
2.  恶意命令通常会使用 Powershell (在Windows系统上) 执行，Powershell 命令会被 Base64 编码以绕过某些过滤。
3.  攻击者将包含恶意命令的 URL 发送给目标服务器。
4.  目标服务器解析 URL，执行恶意命令，例如下载并执行额外的恶意软件，或者建立反向 shell。

**POC代码分析：**

提供的 exploit.py 和 exploit.sh 脚本旨在自动化漏洞利用过程。它们允许攻击者指定目标 URL、监听 IP 地址 (LHOST) 和监听端口 (LPORT)。脚本会生成一个包含恶意 Powershell 命令的 URL，该命令经过 Base64 编码后注入到 search 参数中。当目标服务器处理此 URL 时，它会执行 Powershell 命令，从而在攻击者机器上建立一个反向 shell。

**投毒风险评估：**

代码中没有明显的恶意行为，例如擦除磁盘或安装后门。但是，此代码的目的是执行任意命令，因此有被滥用的风险。 投毒风险评估为5%, 主要考量点在于此POC本身就是用来执行任意命令，本身目的就是恶意的，作者如果想进一步投毒，空间有限，概率较低。

**有效性：**
根据漏洞信息和POC代码，此漏洞利用是有效的。多个来源 (包括 NVD、Exploit-DB 和 Metasploit) 都证实了此漏洞的存在和可利用性。

**项目地址:** [10cks/CVE-2014-6287](https://github.com/10cks/CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)