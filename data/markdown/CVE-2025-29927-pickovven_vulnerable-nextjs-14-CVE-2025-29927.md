## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行授权检查，并且版本存在漏洞。

**POC 可用性:** 是，但提供的代码不完整

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js框架中的一个授权绕过漏洞，影响多个版本。该漏洞出现在Next.js中间件中，如果应用使用中间件进行身份验证或授权检查，则攻击者可以通过操纵`x-middleware-subrequest`请求头绕过这些检查。漏洞利用的关键在于Next.js对该请求头的处理不当。

**有效性：**
提供的POC代码`README.md`仅包含标题，是一个不完整的POC，无法直接用于漏洞利用。需要更详细的利用脚本或步骤。

**投毒风险：**
由于提供的POC代码只有一个`README.md`文件，内容很少，基本可以排除直接投毒的可能性。但这并不意味着绝对安全，作者仍然可能在其他地方隐藏恶意代码（比如完整的利用脚本）。因此，假设存在**10%** 的投毒风险，主要考虑到未来可能出现更完整的POC，需要保持警惕。

**利用方式：**
根据漏洞信息和搜索结果，该漏洞的利用方式是向Next.js应用发送包含特定`x-middleware-subrequest`请求头的HTTP请求。通过构造恶意的请求，攻击者可以绕过中间件中的授权检查，从而访问受保护的资源或执行未授权的操作。修复此漏洞的方法是升级到Next.js 14.2.25或15.2.3及以上版本，或者在middleware层对`x-middleware-subrequest`请求头进行校验。

**项目地址:** [pickovven/vulnerable-nextjs-14-CVE-2025-29927](https://github.com/pickovven/vulnerable-nextjs-14-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)