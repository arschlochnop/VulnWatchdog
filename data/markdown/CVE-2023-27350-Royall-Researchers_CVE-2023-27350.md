## CVE-2023-27350 PaperCut NG/MF 身份验证绕过远程代码执行漏洞

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 22.0.5 (Build 63914) 及 PaperCut MF 或 NG version 8.0 或 later (excluding patched versions) on all OS platforms.

**利用条件:** 目标服务器运行PaperCut NG/MF，且可以通过网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个严重漏洞，允许未经身份验证的远程攻击者绕过身份验证并以 SYSTEM 权限执行任意代码。漏洞存在于 `SetupCompleted` 类中，由于不正确的访问控制导致。

**利用方式：**

1.  **身份验证绕过：** 攻击者通过访问 `/app?service=page/SetupCompleted` 页面，然后发送特定的 POST 请求绕过身份验证。
2.  **配置修改：** 利用绕过的身份验证，攻击者修改 `print-and-device.script.enabled` 和 `print.script.sandboxed` 配置，启用脚本执行并禁用沙箱。
3.  **远程代码执行：** 攻击者通过修改打印机设置，插入恶意的 Groovy 脚本，从而在服务器上执行任意代码。脚本功能被滥用。

**POC 有效性：**
提供的 POC 代码通过模拟上述步骤，可以有效利用该漏洞，在目标服务器上执行任意命令。

**投毒风险：**
代码中存在投毒的风险较低。分析POC代码作者的目的是进行漏洞验证，其中`execute`函数中包含了执行命令的代码。通过对脚本的分析，未发现明显的恶意代码。curl命令中存在IP，可能会导致被收集。但总的来说风险较低。

**项目地址:** [Royall-Researchers/CVE-2023-27350](https://github.com/Royall-Researchers/CVE-2023-27350)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)