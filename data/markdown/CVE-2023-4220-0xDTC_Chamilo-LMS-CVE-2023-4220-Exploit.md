## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可导致完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且攻击者能够通过网络访问该系统

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-4220 是 Chamilo LMS <= v1.11.24 中的一个远程代码执行漏洞。该漏洞源于 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 文件中的不设限的文件上传功能。攻击者可以上传恶意文件（例如 webshell），从而执行任意代码。

**有效性：**

根据漏洞描述、搜索结果和提供的POC代码，此漏洞利用是有效的。多个来源确认了该漏洞的存在和可利用性，POC代码也提供了利用该漏洞的脚本。

**投毒风险：**

该POC代码的主要功能是从 `revshells.com` 下载一个反弹shell脚本并执行，代码比较简单，逻辑清晰。风险点在于revshells.com提供的脚本可能被篡改,导致漏洞利用失败或植入恶意代码,如果revshells.com被攻击，脚本存在被替换的风险。虽然作者 Divine Clown 进行了优化，但代码结构并没有改变。

*   **脚本来源风险：**`revshells.com`的脚本有一定的不可控性，如果该网站被入侵，可能导致下载恶意脚本。
*   **代码混淆的风险：** 虽然脚本本身未发现明显混淆，但不排除Divine Clown在完善脚本时插入恶意代码。 但是readme.md中做了相关免责声明,降低了作者植入恶意代码的概率.

综合考虑，投毒风险较低，大约为5%。

**利用方式：**

1.  **准备：** 攻击者需要准备一个具有公网IP的服务器，并确保服务器上的指定端口未被占用。
2.  **反弹Shell生成：** 使用提供的脚本，指定攻击者的IP地址和端口，脚本会自动从`revshells.com`生成一个反弹shell的PHP脚本。
3.  **文件上传：** 脚本通过POST请求，将反弹shell的PHP脚本上传到 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。
4.  **触发反弹Shell：** 脚本通过访问上传的PHP脚本的URL，触发反弹shell。
5.  **建立连接：** 攻击者在自己的服务器上使用Netcat监听指定的端口，等待目标服务器的反弹shell连接。

总而言之，攻击者利用Chamilo LMS中不设限的文件上传漏洞，上传并执行恶意PHP脚本，从而获得目标服务器的控制权。

**项目地址:** [0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit](https://github.com/0xDTC/Chamilo-LMS-CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)