## CVE-2025-58180 OctoPrint RCE via Unsanitized Filename

**漏洞编号:** CVE-2025-58180

**漏洞类型:** 远程代码执行

**影响应用:** OctoPrint

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 1.11.2

**利用条件:** 需要文件上传权限，例如有效的API密钥或会话

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于OctoPrint的文件上传功能中，由于文件名未经过充分的过滤，攻击者可以构造包含恶意代码的文件名，通过OctoPrint的事件系统执行，从而实现远程代码执行。POC代码提供了详细的复现步骤，包括环境搭建、配置事件订阅以及发送恶意请求。利用方式是上传一个文件名包含shell命令的gcode文件，Octoprint会触发FileAdded事件，如果系统命令订阅了这个事件，则恶意文件名中的命令会被执行。

**有效性评估：**
根据提供的POC代码和搜索引擎结果，该漏洞利用的有效性较高，POC步骤清晰，易于复现。

**投毒风险评估：**
虽然POC的主要目的是演示漏洞利用，但考虑到攻击者可能将恶意代码隐藏在gcode文件中，或者通过精心构造的shell命令下载并执行恶意脚本，存在一定的投毒风险。由于上传的文件类型是gcode,且POC代码中使用的命令较为简单, 判定投毒风险为10%。

**漏洞利用方式：**
1.  攻击者需要获得OctoPrint的文件上传权限，例如通过已知的API密钥或有效的用户会话。
2.  攻击者构造一个包含恶意shell命令的文件名，例如`octo;touch${IFS}/tmp/test123;#.gcode`。
3.  攻击者上传一个文件，并将恶意文件名设置为该文件的文件名。
4.  OctoPrint接收文件后，会触发`FileAdded`事件。
5.  如果系统命令订阅了该事件，OctoPrint会将包含恶意代码的文件名传递给shell执行，从而实现远程代码执行。

**项目地址:** [prabhatverma47/CVE-2025-58180-RCE-in-OctoPrint-via-Unsanitized-Filename](https://github.com/prabhatverma47/CVE-2025-58180-RCE-in-OctoPrint-via-Unsanitized-Filename)

**漏洞详情:** [CVE-2025-58180](https://nvd.nist.gov/vuln/detail/CVE-2025-58180)