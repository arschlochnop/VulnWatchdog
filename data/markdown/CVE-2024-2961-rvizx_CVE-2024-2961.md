## CVE-2024-2961-glibc-iconv缓冲区溢出

**漏洞编号:** CVE-2024-2961

**漏洞类型:** 缓冲区溢出

**影响应用:** glibc

**危害等级:** 高危，可能导致程序崩溃或远程代码执行

**影响版本:** < 2.40

**利用条件:** 需要目标系统使用受影响的glibc版本，并且程序使用iconv函数转换到ISO-2022-CN-EXT字符集

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-2961 存在于 GNU C 库 (glibc) 的 iconv() 函数中。当应用程序使用 iconv() 函数将字符串转换为 ISO-2022-CN-EXT 字符集时，如果 glibc 版本低于 2.40，则可能发生缓冲区溢出，溢出量最多为 4 字节。这可能导致应用程序崩溃或覆盖相邻变量，攻击者可能利用此漏洞执行远程代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且存在PoC。提供的脚本 `fix.sh` 并非直接的利用代码，而是用于缓解该漏洞的脚本。它通过禁用有问题的字符集来阻止漏洞被触发，因此该脚本本身不是PoC，但验证了漏洞的可利用性。

**投毒风险：**

分析 `fix.sh` 脚本，它主要执行以下操作：

1.  检查系统是否存在受影响的字符集。
2.  查找 `gconv-modules-extra.conf` 文件。
3.  禁用 `gconv-modules-extra.conf` 中与 `ISO-2022-CN-EXT` 相关的编码。
4.  重新生成 gconv 模块缓存。
5.  验证缓解措施是否成功。

脚本中潜在的投毒点可能在于：

*   在禁用编码的部分，`sed` 命令可能被修改为删除其他重要的字符集，导致应用程序无法正常处理某些字符，虽然可能性不大，考虑到这个脚本的目的是缓解漏洞，恶意修改 `sed` 命令会适得其反，更容易被检测到。 *   替换 `gconv-modules-extra.conf` 或者注入恶意内容，导致系统无法正常工作。但是会影响全局导致应用异常。

总体而言，该脚本的风险较低，因为其主要功能是禁用特定的字符集，而不是执行任意代码。考虑到作者的信息和脚本内容，可以初步判断存在恶意投毒的可能性较低，估算投毒风险为 5%。

**利用方式：**

漏洞的利用方式是：

1.  攻击者需要找到一个应用程序，该应用程序使用 glibc 的 iconv() 函数进行字符集转换。
2.  应用程序必须使用 iconv() 函数将输入转换为 ISO-2022-CN-EXT 字符集。
3.  攻击者构造恶意的字符串，当该字符串被 iconv() 函数转换时，会导致输出缓冲区溢出。
4.  如果成功利用，攻击者可以控制程序的执行流程，甚至执行任意代码。具体利用效果取决于程序内存布局以及溢出造成的破坏。

**项目地址:** [rvizx/CVE-2024-2961](https://github.com/rvizx/CVE-2024-2961)

**漏洞详情:** [CVE-2024-2961](https://nvd.nist.gov/vuln/detail/CVE-2024-2961)