## CVE-2025-24813 Apache Tomcat Path Equivalence and Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价及反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 <= Apache Tomcat <= 9.0.98, 10.1.0-M1 <= Apache Tomcat <= 10.1.34, 11.0.0-M1 <= Apache Tomcat <= 11.0.2

**利用条件:** DefaultServlet 写入功能启用 (readonly=false), Partial PUT 请求支持 (默认开启), 文件会话持久化启用 (PersistentManager 和 FileStore 配置), 存在反序列化利用链

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中的一个路径等价漏洞，结合反序列化漏洞，可能导致远程代码执行。利用方式是攻击者通过 Partial PUT 请求上传恶意序列化 payload，覆盖 session 文件，从而触发反序列化漏洞，执行任意代码。

**漏洞利用过程：**
1.  **配置条件：** 确保 Tomcat 启用了 DefaultServlet 的写入功能，支持 Partial PUT 请求，并且开启了文件会话持久化。
2.  **上传Payload：** 攻击者构造一个包含恶意代码的序列化对象，并将其分块通过 Partial PUT 请求上传到 Tomcat 服务器上的 session 存储目录。
3.  **触发反序列化：** 当 Tomcat 尝试反序列化该 session 文件时，恶意代码会被执行，从而导致远程代码执行。

**投毒风险分析：**
由于该漏洞利用涉及上传恶意序列化数据，存在一定的投毒风险。攻击者可能在序列化数据中植入恶意代码，导致受害者在不知情的情况下运行这些代码。此外，公开的POC可能被篡改并传播，从而导致更多人受到攻击。

**缓解措施：**
1.  升级到 Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
2.  禁用 DefaultServlet 的写入功能 (readonly=true)。
3.  避免使用文件会话持久化。
4.  限制上传文件类型，并对上传文件进行安全检查。

**项目地址:** [charis3306/CVE-2025-24813](https://github.com/charis3306/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)