## CVE-2024-23897: Jenkins 任意文件读取漏洞

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够通过网络访问Jenkins服务器的CLI接口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中存在的一个任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器未禁用一个特性，该特性会将参数中 `@` 字符后跟的文件路径替换为文件内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经有公开的PoC代码。漏洞库信息明确指出受影响的版本范围，并提供了参考链接。搜索引擎结果也提供了多个关于该漏洞的分析报告和利用示例。因此，提供的PoC代码应是有效的。

**投毒风险分析：**

PoC代码本身主要包含以下几个部分：

1.  参数解析：使用argparse处理命令行参数，例如目标URL、要读取的文件路径、超时时间等。
2.  文件读取逻辑：利用 requests 库发送HTTP请求到Jenkins服务器，利用 `@file` 语法触发文件读取。
3.  交互式Shell：提供一个简单的命令行界面，允许用户输入要读取的文件路径。

仔细检查提供的PoC代码，未发现明显的恶意代码。PoC代码的功能在于利用漏洞读取指定文件，没有发现上传恶意文件，执行系统命令等后门代码。

代码中定义了一些操作码(Op)，但主要用于处理CLI交互，与恶意行为无关。

**利用方式：**

1.  攻击者需要找到一个存在漏洞的Jenkins服务器，且版本在受影响范围内。
2.  攻击者通过Jenkins CLI接口，构造包含 `@/path/to/file` 语法的命令，`/path/to/file` 为要读取的文件路径。
3.  Jenkins服务器在解析命令时，会将 `@/path/to/file` 替换为文件 `/path/to/file` 的内容。
4.  攻击者可以读取服务器上的任意文件，例如 `/etc/passwd`、`/var/jenkins_home/secrets/master.key` 等，从而获取敏感信息。

**修复建议：**

1.  升级Jenkins到不受影响的版本(>= 2.442, >= 2.426.3)。
2.  禁用Jenkins CLI的 `@file` 扩展功能。

**项目地址:** [godylockz/CVE-2024-23897](https://github.com/godylockz/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)