## CVE-2025-49132 Pterodactyl Panel 远程代码执行

**漏洞编号:** CVE-2025-49132

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Pterodactyl Panel

**危害等级:** 严重，允许未经身份验证的攻击者执行任意代码，可能导致完全控制服务器，窃取敏感数据，访问服务器文件等。

**影响版本:** < 1.11.11

**利用条件:** 需要网络访问 Pterodactyl Panel 实例。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49132 是 Pterodactyl Panel 中存在的一个未经身份验证的远程代码执行漏洞。该漏洞存在于 `/locales/locale.json` 接口，攻击者可以通过 `locale` 和 `namespace` 查询参数进行路径遍历攻击，读取到敏感配置文件，例如 `config/app.php` 。通过读取包含 `APP_KEY` 的配置文件，攻击者可以进一步利用此密钥进行更深层次的攻击，例如伪造用户身份或执行任意代码。

**有效性：**
根据漏洞信息和PoC代码，该漏洞利用是有效的。PoC代码构造特定的URL，通过路径遍历读取配置文件，验证了漏洞的存在。

**投毒风险：**
PoC代码本身主要功能是检测漏洞是否存在，并提取 `APP_KEY` 。代码中包含requests库发送请求，以及参数处理、颜色输出等功能。潜在的投毒风险较低，但仍然存在一些需要注意的地方：

*   **依赖风险：** 使用了 `requests` 库，存在requests库本身被投毒的可能性。
*   **输出风险：** PoC会将提取的 `APP_KEY` 等敏感信息输出到屏幕或者文件，如果攻击者控制了运行PoC的环境，可能存在信息泄露风险。
*   **资源消耗：** 批量扫描时可能导致目标服务器拒绝服务。
综合判断，PoC代码的投毒风险较低，约为5%。

**利用方式：**

1.  **确定目标：**  找到运行 Pterodactyl Panel 且版本低于 1.11.11 的目标实例。
2.  **构造 Payload：**  构造包含路径遍历的恶意 URL，例如：`https://<目标URL>/locales/locale.json?locale=..%2F..%2Fconfig&namespace=app`。
3.  **发送请求：**  使用 HTTP GET 请求发送构造好的 URL。
4.  **提取 APP_KEY：**  如果服务器存在漏洞，会返回包含 `APP_KEY` 的 JSON 响应。从响应中提取 `APP_KEY`。
5.  **进一步利用：**  利用 `APP_KEY` 进行后续攻击，例如伪造用户身份、解密数据或执行任意代码。

**项目地址:** [qiaojojo/CVE-2025-49132_poc](https://github.com/qiaojojo/CVE-2025-49132_poc)

**漏洞详情:** [CVE-2025-49132](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)