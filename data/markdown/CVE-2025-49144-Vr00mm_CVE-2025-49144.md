## CVE-2025-49144-Notepad++-Privilege Escalation

**漏洞编号:** CVE-2025-49144

**漏洞类型:** 权限提升

**影响应用:** Notepad++

**危害等级:** 高危，可导致系统完全控制

**影响版本:** < 8.8.2

**利用条件:** 需要用户运行恶意构造的Notepad++安装程序

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49144是Notepad++安装程序中的一个权限提升漏洞。该漏洞是由于安装程序在搜索可执行文件时使用了不安全的搜索路径造成的(CWE-427)。攻击者可以通过社会工程学或点击劫持等手段，诱使用户将恶意构造的`regsvr32.exe`（或其他系统二进制文件）与官方的Notepad++安装程序放在同一个目录下（通常是下载目录）。当用户运行安装程序时，由于安装程序会优先搜索当前目录下的`regsvr32.exe`，从而执行攻击者放置的恶意程序，并以SYSTEM权限运行，最终导致攻击者获得系统控制权。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该漏洞是有效的。PoC代码详细描述了漏洞的利用方式和技术细节，包括利用CGO技术实现Go语言和C语言的互操作，以及如何通过窃取SYSTEM令牌创建具有SYSTEM权限的进程。

**投毒风险：**

PoC代码本身是为了演示漏洞，但存在被恶意修改的风险。虽然代码中包含了一些安全特性（如字符串混淆、分离进程、令牌模拟），但这些技术也可以被用于隐藏恶意代码。因此，虽然代码描述看起来合理，但仍然存在作者可能隐藏的投毒代码。根据对代码的初步分析，主要风险集中在CGO调用和PowerShell脚本执行部分，这里最容易被插入恶意代码。 综合考虑，给予10%的投毒风险。

**利用方式：**

1.  攻击者诱骗受害者下载官方的Notepad++安装程序。
2.  攻击者同时诱骗受害者下载并放置一个伪装成`regsvr32.exe`的恶意程序到相同的目录下（通常是“下载”目录）。
3.  受害者运行Notepad++安装程序。
4.  安装程序启动时，由于存在不安全的可执行文件搜索路径，优先执行了攻击者放置的恶意`regsvr32.exe`程序。
5.  恶意程序利用SYSTEM权限执行预先设定的恶意行为，如反弹shell、安装后门等，最终导致攻击者控制受害者的系统。

**项目地址:** [Vr00mm/CVE-2025-49144](https://github.com/Vr00mm/CVE-2025-49144)

**漏洞详情:** [CVE-2025-49144](https://nvd.nist.gov/vuln/detail/CVE-2025-49144)