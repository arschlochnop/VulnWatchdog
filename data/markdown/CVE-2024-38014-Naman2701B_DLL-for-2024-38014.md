## CVE-2024-38014-Windows Installer Elevation of Privilege

**漏洞编号:** CVE-2024-38014

**漏洞类型:** 权限提升

**影响应用:** Windows Installer

**危害等级:** 高危，攻击者可以利用此漏洞获取SYSTEM权限

**影响版本:** 见CVE信息中的受影响版本范围

**利用条件:** 本地低权限用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38014是一个Windows Installer权限提升漏洞。攻击者可以利用此漏洞，通过精心设计的 MSI 文件或者修复功能，以 SYSTEM 权限执行任意代码。根据搜索结果，该漏洞存在于 MSI 安装程序的修复功能中，低权限用户可以执行该功能，但该功能以 NT AUTHORITY\SYSTEM 权限运行，这为权限提升创造了条件。

**有效性：**
提供的漏洞利用代码是 Visual Studio solution 文件，包含一个名为 "evil" 的 DLL 项目。这个 DLL 很可能被设计成利用该漏洞，通过 Windows Installer 以 SYSTEM 权限执行恶意代码。

**投毒风险：**
虽然提供的代码片段主要定义了项目结构，但具体恶意代码位于 `evil.cpp` 或类似源文件中，此处未提供。因此，无法完全排除投毒的可能性。投毒风险评估为 10%。风险主要体现在：
*   **Payload 植入：** DLL 内部可能包含恶意 payload，例如执行 shellcode、添加后门用户或修改系统配置等。
*   **远程连接：** 恶意代码可能尝试连接到外部服务器，以下载更多 payload 或泄露信息。
*   **破坏性操作：** 可能包含删除文件、停止服务等破坏性操作。

**利用方式：**
1.  攻击者创建一个恶意的 MSI 安装包，该安装包在安装或修复过程中会加载并执行 "evil.dll"。
2.  或者，攻击者可以利用现有的已安装应用程序的修复功能，诱导系统加载和执行 "evil.dll"。
3.  "evil.dll" 在 SYSTEM 权限下执行，从而允许攻击者执行任意操作，例如添加具有管理员权限的用户。



**项目地址:** [Naman2701B/DLL-for-2024-38014](https://github.com/Naman2701B/DLL-for-2024-38014)

**漏洞详情:** [CVE-2024-38014](https://nvd.nist.gov/vuln/detail/CVE-2024-38014)