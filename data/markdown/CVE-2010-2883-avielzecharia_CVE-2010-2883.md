## CVE-2010-2883 Adobe Reader CoolType SING Table 栈缓冲区溢出

**漏洞编号:** CVE-2010-2883

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Adobe Reader and Acrobat

**危害等级:** 高危，可导致远程代码执行或拒绝服务

**影响版本:** 9.x before 9.4, and 8.x before 8.2.5 on Windows and Mac OS X

**利用条件:** 用户需要打开恶意的PDF文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Adobe Reader和Acrobat的CoolType.dll库中，由于在解析PDF文档中TTF字体SING表时，对uniqueName字段长度验证不足，导致栈缓冲区溢出。攻击者可以通过构造包含恶意TTF字体的PDF文档，利用此漏洞执行任意代码或导致程序崩溃。

**有效性：**
根据漏洞描述、搜索结果和POC代码，可以确定该漏洞是真实存在的，并且已经有公开的利用代码。POC代码基于Metasploit框架，实现了绕过ASLR和DEP等保护机制，并执行任意代码。因此，该漏洞的POC代码应该是有效的。

**投毒风险：**
提供的代码段主要集中在漏洞利用逻辑，包括构造恶意TTF数据和JavaScript代码以绕过安全保护。虽然不能完全排除作者在代码中植入恶意后门的可能性，但现有信息和漏洞利用的复杂性表明，代码主要目的是为了实现漏洞利用，而非隐藏恶意功能。因此，代码存在投毒风险的可能性较低，估计在10%左右。

**利用方式：**
1.  **构造恶意PDF文档：** 攻击者需要构造一个恶意的PDF文档，该文档包含一个特制的TTF字体文件。
2.  **SING表溢出：**  在TTF字体文件中，SING表的"uniqueName"字段被设计为过长，当Adobe Reader解析该字段时，会发生栈缓冲区溢出。
3.  **ROP链：**  利用ROP（Return-Oriented Programming）技术，攻击者可以在栈上构建ROP链，通过一系列精心构造的返回地址，执行特定的指令序列。
4.  **绕过DEP和ASLR：**  POC代码中使用了JavaScript堆喷射和ROP链技术，以绕过DEP（数据执行保护）和ASLR（地址空间布局随机化）等安全保护机制。
5.  **执行Shellcode：**  最终，攻击者可以通过ROP链执行shellcode，从而实现远程代码执行。

**项目地址:** [avielzecharia/CVE-2010-2883](https://github.com/avielzecharia/CVE-2010-2883)

**漏洞详情:** [CVE-2010-2883](https://nvd.nist.gov/vuln/detail/CVE-2010-2883)