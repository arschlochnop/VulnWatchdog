## CVE-2025-32433 Erlang/OTP SSH Pre-Authentication RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** OTP-25.3.2.20 之前, OTP-26.0-rc1 到 OTP-26.2.5.11, OTP-27.0-rc1 到 OTP-27.3.3

**利用条件:** 目标系统运行受影响版本的Erlang/OTP SSH服务，且攻击者可以网络访问该服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32433 是 Erlang/OTP SSH 服务器中的一个未经身份验证的远程代码执行漏洞。攻击者可以通过发送特制的 SSH 协议消息，利用 SSH 协议处理中的缺陷，无需有效凭据即可在受影响的系统上执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为严重级别(CVSS 10.0)，并且存在公开可用的POC。提供的POC代码包含 Dockerfile 和 Python 脚本。Dockerfile 用于构建包含易受攻击的 Erlang/OTP 版本的环境，Python 脚本 `cve-2025-32433.py` 实现了漏洞利用，通过发送特制的 SSH 消息来执行命令。README.md提供了构建和运行POC的说明，验证了其可行性。

**投毒风险：**

分析提供的代码，主要的风险点在于 `cve-2025-32433.py` 脚本中的 `escape_shell_command_for_erlang` 函数，以及Dockerfile下载的Erlang版本。尽管脚本本身旨在利用漏洞，但存在通过以下方式引入恶意代码的可能性：

1.  **`escape_shell_command_for_erlang` 函数:** 这个函数用于转义 shell 命令，如果转义不当，可能允许攻击者注入额外的命令。当前实现看起来比较简单，风险较低，但是需要仔细审计以确保没有漏洞。
2.  **Dockerfile 下载的 Erlang版本:** 虽然Dockerfile指定下载特定commitID的Erlang版本，但是仍然有版本投毒的可能性，即github上的0xPThree账户被入侵，然后替换掉之前的commit id对应的代码.或者github仓库被入侵.风险存在，但较低
3.  **`ssh_server.erl` 文件:** 用于在受害者机器上启动 SSH 服务的 Erlang 代码可能被篡改，以包含恶意功能。需要对该文件进行人工审计,确认没有其他行为.

综合考虑，评估投毒风险为10%。主要是考虑到目前没有看到明确的投毒代码，但是不排除上述潜在风险的存在。

**利用方式：**

1.  **目标环境准备：** 使用Dockerfile构建包含漏洞版本的Erlang/OTP的Docker镜像。
2.  **SSH服务启动：** 在Docker容器中运行包含漏洞的Erlang/OTP SSH服务。
3.  **漏洞利用：** 运行 `cve-2025-32433.py` 脚本，指定目标主机的IP地址和端口。
4.  **远程代码执行：** 脚本会发送恶意的 SSH 消息，利用漏洞在目标系统上执行命令。POC中，执行的命令是反弹shell，从而获得目标系统的控制权。

该漏洞的利用方式较为直接，利用了SSH协议处理的缺陷，绕过了身份验证，实现了远程代码执行。

**项目地址:** [0xPThree/cve-2025-32433](https://github.com/0xPThree/cve-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)