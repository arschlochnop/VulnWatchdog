## CVE-2022-25226 - ThinVNC 1.0b1 Authentication Bypass to Remote Code Execution

**漏洞编号:** CVE-2022-25226

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** ThinVNC

**危害等级:** 高危，可导致远程代码执行并完全控制服务器

**影响版本:** 1.0b1

**利用条件:** 目标ThinVNC服务需要运行在目标IP的8080端口 (默认端口) 并且攻击者需要能访问该端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-25226 存在于 ThinVNC 1.0b1 版本中。未经身份验证的攻击者可以通过访问 `http://thin-vnc:8080/cmd?cmd=connect` 绕过身份验证，获取有效的 SID，然后利用该 SID 模拟键盘和鼠标事件，最终实现远程代码执行。

**利用方式：**
1.  **获取 SID：**  向 `/cmd?cmd=connect` 发送未经验证的请求，获取有效的 SID。
2.  **启动会话：**  使用获取的 SID，通过 `/cmd?cmd=start` 启动会话，开启键盘和鼠标控制。
3.  **打开开始菜单：**  发送 `Ctrl+Esc` 组合键，打开开始菜单。
4.  **启动 PowerShell：**  利用键盘模拟，输入命令启动 PowerShell，并绕过 AMSI。
5.  **执行恶意 PowerShell 脚本：**  通过剪贴板注入，执行攻击者服务器上的 PowerShell 脚本（rev.ps1），该脚本会建立反向 shell 连接。

**投毒风险分析：**
代码主要功能是利用漏洞实现RCE。`rev.ps1` 脚本的反连IP和端口由用户指定，本身不包含恶意代码。 主要风险在于攻击者替换`rev.ps1` 脚本，但是用户可以自行审查该脚本。POC代码本身看起来是安全的，但仍然存在一些微小的风险。假设原作者在某些不常用的函数或者分支中添加了后门代码，这种后门代码难以被检测到，因此存在一定的投毒风险。整体投毒风险较低，约为 5%。

**搜索引擎结果分析：**
 搜索结果确认了该漏洞的存在和基本信息, 并且提供了可用于检测该漏洞的扫描器链接。

**项目地址:** [krill-x7/CVE-2022-25226](https://github.com/krill-x7/CVE-2022-25226)

**漏洞详情:** [CVE-2022-25226](https://nvd.nist.gov/vuln/detail/CVE-2022-25226)