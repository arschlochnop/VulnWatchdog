## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x before 2.3.32, 2.5.x before 2.5.10.1

**利用条件:** 目标服务器运行存在漏洞的Apache Struts2版本，且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。攻击者可以通过构造恶意的Content-Type、Content-Disposition或Content-Length HTTP头，利用OGNL表达式注入执行任意命令。该漏洞利用的有效性高，因为网上存在大量公开的POC。提供的strustxp.py脚本通过构造包含恶意OGNL表达式的Content-Type头来实现远程代码执行。该脚本模拟了一个简单的shell环境，允许攻击者在目标服务器上执行命令。 

**漏洞利用方式：**

1.  攻击者发送包含恶意Content-Type头的HTTP请求到存在漏洞的Struts2应用。
2.  恶意Content-Type头包含一个OGNL表达式，该表达式会被Struts2解析并执行。
3.  OGNL表达式执行任意命令，例如反弹shell、读取文件等。

**投毒风险分析：**

分析提供的strustxp.py脚本，该脚本主要功能是利用CVE-2017-5638漏洞，远程执行命令。脚本本身并未发现明显的恶意代码或后门，其行为符合漏洞利用的预期。仓库中只有自述文件和exp脚本，没有其他可疑文件。因此，投毒风险评估为0%。

**总结：**

该漏洞利用的有效性高，风险等级为高危，但提供的POC代码本身不包含投毒风险。

**项目地址:** [un4ckn0wl3z/CVE-2017-5638](https://github.com/un4ckn0wl3z/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)