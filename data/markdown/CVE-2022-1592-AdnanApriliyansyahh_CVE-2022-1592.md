## CVE-2022-1592 - clinical-genomics/scout SSRF

**漏洞编号:** CVE-2022-1592

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** clinical-genomics/scout

**危害等级:** 高危，可能导致敏感信息泄露、内部服务访问和潜在的XSS

**影响版本:** < v4.42

**利用条件:** 需要网络访问目标应用，并且目标应用存在可以控制URL参数的功能点。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1592 是 clinical-genomics/scout 中存在的服务器端请求伪造 (SSRF) 漏洞，影响版本低于 v4.42。攻击者可以利用此漏洞使应用程序执行任意请求。根据漏洞描述，可能的攻击场景包括：

*   **Cookie 窃取：** 攻击者可以诱使服务器向攻击者控制的外部服务器发出请求，从而窃取服务器的 Cookie。
*   **私有区域请求：** 攻击者可以使服务器向内部网络发出请求，访问原本无法直接访问的私有资源。
*   **XSS：** 漏洞描述中提到可能导致 XSS，这可能是由于服务器在处理外部请求的响应时未进行充分的过滤，将恶意代码注入到页面中。

**漏洞利用方式分析：**

从提供的漏洞利用代码来看，该脚本尝试利用 SSRF 漏洞执行 XSS。它通过构造包含 JavaScript 代码的 URL 并将其作为参数传递给易受攻击的应用程序来实现此目的。具体来说，脚本通过 `url` 参数注入不同的 XSS payload，例如 `javascript:alert(1)` 或 `<script>alert(document.domain)</script>`。  然后脚本检查服务器的响应中是否包含注入的 payload，以确定漏洞是否存在。  脚本使用的是 `quote` 函数对 payload 进行 URL 编码，这对于确保 payload 正确地传递到服务器至关重要。

**有效性评估：**

根据漏洞信息和提供的 POC 代码，该 POC 代码的有效性较高，只要目标应用程序存在此漏洞且版本低于 v4.42，则利用成功率较高。该脚本针对 extension-info 端点进行测试，利用 url 参数进行payload注入，通过检测返回的响应中是否存在payload来判断是否存在XSS。

**投毒风险评估：**

经过对 POC 代码的分析，该代码主要用于检测 SSRF 漏洞，并尝试通过 SSRF 触发 XSS。该 POC 代码仅仅是尝试将不同的 JavaScript payload 注入到 `url` 参数中，并且验证是否能在响应中看到。因此，可以认为此仓库中不存在作者隐藏的投毒代码的可能性为 0%。

**项目地址:** [AdnanApriliyansyahh/CVE-2022-1592](https://github.com/AdnanApriliyansyahh/CVE-2022-1592)

**漏洞详情:** [CVE-2022-1592](https://nvd.nist.gov/vuln/detail/CVE-2022-1592)