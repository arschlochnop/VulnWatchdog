## CVE-2017-5638-Apache Struts2-远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts2

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.3.x before 2.3.32，2.5.x before 2.5.10.1

**利用条件:** 目标系统运行存在漏洞版本的Apache Struts2，攻击者需要能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5638是Apache Struts2 Jakarta Multipart parser中的一个远程代码执行漏洞。该漏洞源于Struts2在处理文件上传时，对Content-Type等HTTP头部的异常处理不当，导致OGNL表达式注入，从而允许攻击者执行任意命令。

**有效性：**

提供的POC代码有效。它利用了Content-Type头部中的OGNL表达式注入漏洞，通过修改OGNL的上下文，清空ExcludedPackageNames和ExcludedClasses，绕过沙盒限制，执行任意命令。

**投毒风险：**

分析POC代码，未发现明显的恶意代码或后门。所有操作都围绕着利用已知的漏洞进行远程命令执行。该漏洞利用代码主要通过构造特定的Payload，其核心功能是执行给定的命令，代码片段：`payload += "(#cmd='" + command + "')."` ， 意味着任何命令都必须由攻击者明确指定。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者构造恶意的HTTP请求，特别是Content-Type头部，其中包含精心设计的OGNL表达式。
2.  该OGNL表达式用于绕过Struts2的安全机制，并执行攻击者指定的系统命令。
3.  Struts2在解析Content-Type头部时，会执行该OGNL表达式，从而导致远程代码执行。
4.  攻击者可以通过`-r`参数指定目标URL，通过`-c`参数指定要执行的命令。
5.  服务器执行命令的结果会返回到攻击者。

**项目地址:** [mritunjay-k/CVE-2017-5638](https://github.com/mritunjay-k/CVE-2017-5638)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)