## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request Baskets

**危害等级:** 中危，可能导致访问内部网络资源和敏感信息

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request Baskets服务，且Request Baskets服务没有进行适当的访问控制。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞。该漏洞位于 `/api/baskets/{name}` 组件中。攻击者可以利用此漏洞通过构造恶意 API 请求来访问网络资源和敏感信息。

**有效性：**
根据漏洞描述和提供的 PoC 代码，该 PoC 代码是有效的。脚本首先创建一个名为 'carrot' 的 basket，并设置 `forward_url` 为 `http://127.0.0.1:80/`。然后，它使用 Firefox 打开 `${URL}/carrot`，导致 Request Baskets 服务尝试请求 `http://127.0.0.1:80/`。如果成功请求本地地址，证明存在SSRF漏洞。

**投毒风险：**
查看脚本内容，该脚本主要利用 curl 发送 payload，然后使用 firefox 打开一个URL。 整个脚本没有发现任何可疑代码，没有执行额外操作，没有下载其他文件或执行命令，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式：**
利用方式如下：
1.  攻击者需要一个可访问的 Request Baskets 实例。
2.  攻击者使用 PoC 脚本或类似的 HTTP 请求构造特定的 payload，指定 `forward_url` 为目标内部网络地址或服务，如 `http://127.0.0.1:80` 或其他内部服务地址。
3.  Request Baskets 服务收到请求后，会尝试访问攻击者指定的 `forward_url`，从而导致 SSRF。
4.  攻击者可以利用该 SSRF 读取内部服务的信息，甚至可能执行某些内部操作，具体取决于内部服务的配置和权限。

**项目地址:** [overgrowncarrot1/CVE-2023-27163](https://github.com/overgrowncarrot1/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)