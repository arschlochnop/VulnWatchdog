## CVE-2024-36401-GeoServer-远程代码执行

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 2.22.6之前, 2.23.0 - 2.23.6, 2.24.0 - 2.24.4, 2.25.0 - 2.25.2

**利用条件:** 需要网络访问，GeoServer实例运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于不安全地将属性名称作为 XPath 表达式进行评估，导致未经身份验证的用户可以通过构造的输入执行远程代码。该漏洞利用了 GeoTools 库 API 对要素类型属性名称的处理方式，使其能够被传递到 commons-jxpath 库并执行任意代码。漏洞利用代码提供了一个图形化界面，允许用户指定目标 URL 和要执行的命令。它构造一个恶意的 WFS GetPropertyValue 请求，其中 valueReference 属性包含一个执行命令的表达式 (例如, `exec(java.lang.Runtime.getRuntime(),"command")`)。然后，通过 HTTP POST 请求将该请求发送到目标 GeoServer 实例。漏洞利用代码还包括代理设置功能，允许用户通过代理服务器发送请求。该漏洞可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求触发。

**投毒风险分析：**

代码中存在一定程度的投毒风险的可能性（约10%），主要体现在以下几个方面：

*   **依赖项：** `go.mod` 文件中存在一些第三方依赖项，例如 `fyne.io/fyne/v2` 用于图形界面。虽然这些依赖项本身是常用的，但它们可能会引入潜在的安全漏洞或后门，尤其是在构建过程中。
*   **图形界面：** 图形界面本身可能存在安全问题，例如，如果界面中的某些组件没有得到正确的安全处理，攻击者可能会利用这些组件来执行恶意代码。
*   **网络请求：** 代码中包含发起 HTTP 请求的代码。如果攻击者能够控制这些请求的内容，他们可能会利用这些请求来执行恶意操作。但是考虑到此项目是为了进行漏洞利用测试,因此远程请求是免不了的.
*   **内存马注入功能:** 代码声明包含内存马注入功能,虽然是为了漏洞利用,但也存在风险,可能被滥用。
*   **免责声明缺失:** 仓库中缺少明确的免责声明，可能导致使用者在未充分了解风险的情况下使用该工具，从而承担不必要的法律责任。

综上所述，该仓库中存在一定程度的投毒风险，但总体来说风险较低。使用者在使用该工具时应保持警惕，并仔细审查代码，以确保其安全性。

**项目地址:** [netuseradministrator/CVE-2024-36401](https://github.com/netuseradministrator/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)