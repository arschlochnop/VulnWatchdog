## CVE-2023-4220-Chamilo LMS Unauthenticated RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可能导致服务器完全控制，数据泄露，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且能够通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220 是 Chamilo LMS 中的一个关键漏洞，攻击者可以通过未经身份验证的文件上传功能（`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`）上传恶意文件（如 webshell）。

**漏洞利用方式：**

1.  攻击者使用提供的 PoC 脚本（`CVE-2023-4220.sh`或`script.sh`）进行利用。
2.  脚本通过 curl 命令将恶意文件（reverse shell）上传到 `/main/inc/lib/javascript/bigupload/files/` 目录。
3.  脚本然后尝试访问上传的文件，从而执行恶意代码。
4.  脚本还尝试使用`nc`命令监听目标端口，用于接收反向 shell 连接。

**有效性：**

根据漏洞描述和 PoC 代码，该漏洞利用是有效的。多个搜索结果表明该漏洞允许未经身份验证的远程代码执行。

**投毒风险分析：**

分析提供的 PoC 代码，没有发现明显的投毒代码。脚本的功能是上传文件并尝试触发执行，没有发现恶意修改目标系统或进行其他未声明操作的代码。代码主要通过curl和netcat进行远程利用，没有发现可疑行为，故判定投毒风险为0%。

**项目地址:** [oxapavan/CVE-2023-4220-HTB-PermX](https://github.com/oxapavan/CVE-2023-4220-HTB-PermX)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)