## CVE-2025-32756-Fortinet-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2025-32756

**漏洞类型:** 栈溢出

**影响应用:** FortiVoice, FortiRecorder, FortiMail, FortiNDR, FortiCamera

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启了HTTP/HTTPS服务，且可从攻击者控制的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32756是Fortinet产品中的一个栈溢出漏洞，允许未经身份验证的远程攻击者通过发送特制的HTTP请求（特别是`hash` cookie）来执行任意代码。根据漏洞库信息，多个Fortinet产品（FortiVoice, FortiRecorder, FortiMail, FortiNDR, FortiCamera）的多个版本都受到影响。搜索结果表明，该漏洞已在野外被利用。

**利用方式：**

1.  攻击者构造包含恶意代码的HTTP请求，特别是`hash` cookie字段，利用该字段的内容覆盖栈上的返回地址。
2.  发送构造的HTTP请求到目标设备上运行的Fortinet产品。
3.  目标设备解析HTTP请求时，由于未正确验证`hash` cookie的长度和内容，导致栈溢出。
4.  栈溢出覆盖返回地址，使得程序跳转到攻击者指定的地址，执行恶意代码。
5.  恶意代码执行，攻击者获得目标设备的控制权。

**POC有效性：**

提供的PoC代码（`forti_poc.py`和`config.json`）看起来是有效的，并且有以下特征：

*   **`config.json`：** 包含目标IP地址、端口、路径（`/remote/login`）、架构（amd64）、缓冲区偏移、ROP链配置（调用`/bin/sh`）、以及验证方法（连接到bind shell）。
*   **`forti_poc.py`：** 是利用脚本，包含创建恶意payload（ROP链）、发送HTTP请求、以及验证漏洞是否成功的逻辑。
    *   使用`pwntools`库简化了payload的构建过程。
    *   实现了bind shell连接验证。
    *   具有随机User-Agent，使其更隐蔽。
    *   可以执行后渗透模块（`execute_command`），例如执行`id > /pwned.html`。

**投毒风险：**

代码中存在投毒的可能性很低，大概为1%。原因如下：

*   该PoC的主要目的是利用漏洞，实现远程代码执行。恶意代码已在Payload中有所定义
*   该PoC中没有发现明显的恶意或隐藏的逻辑，例如收集用户信息、传播恶意软件等。
*   PoC代码利用标准库（`pwntools`、`requests`等），没有包含可疑的自定义函数或模块。

综上所述，该PoC代码的投毒风险较低。但安全研究人员仍需要仔细审查代码，并进行充分的测试，以确保其安全性。

**项目地址:** [shan0ar/cve-2025-32756](https://github.com/shan0ar/cve-2025-32756)

**漏洞详情:** [CVE-2025-32756](https://nvd.nist.gov/vuln/detail/CVE-2025-32756)