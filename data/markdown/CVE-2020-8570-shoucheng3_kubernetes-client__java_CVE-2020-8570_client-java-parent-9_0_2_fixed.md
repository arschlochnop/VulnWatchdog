## CVE-2020-8570 Kubernetes Java Client Path Traversal

**漏洞编号:** CVE-2020-8570

**漏洞类型:** 路径遍历

**影响应用:** Kubernetes Java Client

**危害等级:** 高危，可能导致文件覆盖和系统妥协

**影响版本:** < 9.0.2, 10.0.0, < 10.0.1

**利用条件:** 需要能够控制从Pod复制文件的过程，并发送恶意构造的tarball

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-8570 存在于 Kubernetes Java client libraries 中，受影响的版本包括10.0.0以及9.0.1之前的版本。当从远程 Pod 复制多个文件时，如果 Pod 发送恶意构造的归档文件（tarball），则可能允许写入到当前目录之外的路径，导致潜在的文件覆盖。攻击者可以利用此漏洞覆盖系统上运行客户端代码的进程的文件。

**有效性：**
根据漏洞描述和搜索结果，可以确定该漏洞是有效的。PoC 的有效性取决于能否控制 pod 返回的 tar 文件内容。

**投毒风险：**
提供的漏洞利用代码是 `CHANGELOG.md` 和 `CONTRIBUTING.md` 文件，它们仅包含软件更新日志和贡献指南。因此，直接从这些文件中发现投毒代码的风险很低。但是，仍然存在极小的风险（估计为1%），即代码仓库的其他部分可能存在作者隐藏的后门或恶意代码，这些后门或恶意代码可能与此漏洞无关，但会被利用。必须对整个仓库进行安全审计以发现任何恶意代码。

**利用方式：**
1.  攻击者需要部署一个恶意的 Pod。
2.  攻击者构造一个包含恶意路径的 tar 文件，例如 `../../../../etc/passwd`。
3.  当使用存在漏洞的 Kubernetes Java client 尝试从该 Pod 复制文件时，`Copy` 函数没有正确验证 tar 文件中的路径。
4.  恶意路径被用于写入文件，导致覆盖了目标系统上的 `/etc/passwd` 文件或其他敏感文件，从而导致提权或拒绝服务。

总结：该漏洞利用的有效性较高，投毒风险较低，但仍然不能排除。漏洞利用方式是通过发送包含恶意构造的 tar 文件的 Pod 来实现的。

**项目地址:** [shoucheng3/kubernetes-client__java_CVE-2020-8570_client-java-parent-9_0_2_fixed](https://github.com/shoucheng3/kubernetes-client__java_CVE-2020-8570_client-java-parent-9_0_2_fixed)

**漏洞详情:** [CVE-2020-8570](https://nvd.nist.gov/vuln/detail/CVE-2020-8570)