## CVE-2015-8351-Gwolle Guestbook-RFI

**漏洞编号:** CVE-2015-8351

**漏洞类型:** 远程文件包含(RFI)

**影响应用:** WordPress Gwolle Guestbook插件

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** < 1.5.4

**利用条件:** 需要目标WordPress安装了存在漏洞的Gwolle Guestbook插件，且`allow_url_include`开启，或允许本地文件包含

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-8351是一个存在于WordPress Gwolle Guestbook插件1.5.4之前版本中的远程文件包含漏洞。当PHP配置`allow_url_include`启用时，未经身份验证的远程攻击者可以通过`abspath`参数向`frontend/captcha/ajaxresponse.php`传递URL来执行任意PHP代码。 漏洞利用代码`gwolle_buster.py` 提供了一个自动化的利用方式，它会生成一个PHP反向shell脚本，并在目标服务器上执行它。  

**漏洞利用方式：**

1.  运行`gwolle_buster.py`，提供目标WordPress URL、攻击者IP地址和监听端口。
2.  脚本将生成一个包含反向shell的PHP文件`wp-load.php`，并启动一个简单的HTTP服务器来托管此文件。
3.  脚本会生成curl命令，攻击者复制curl 命令执行，利用漏洞包含`wp-load.php`文件，从而执行反向shell。
4.  攻击者需要使用netcat监听指定的端口，接收反向shell连接。

**投毒风险分析：**

该POC代码的主要功能是生成一个PHP反向shell并利用RFI漏洞执行。 其中最主要风险在于生成的反向shell，但这是为了验证漏洞的有效性，因此不应将其视为“投毒”。
虽然无法完全排除作者恶意修改代码，例如将shell连接到其他服务器的风险，但是经过代码审计，并没有发现明显的恶意行为，只是代码质量不高。 因此，投毒风险较低，估计在5%左右。 主要风险来自使用者对代码的信任和直接执行，而未进行充分的代码审查。

**项目地址:** [G01d3nW01f/CVE-2015-8351](https://github.com/G01d3nW01f/CVE-2015-8351)

**漏洞详情:** [CVE-2015-8351](https://nvd.nist.gov/vuln/detail/CVE-2015-8351)