## CVE-2022-33679 Windows Kerberos 权限提升漏洞

**漏洞编号:** CVE-2022-33679

**漏洞类型:** 权限提升

**影响应用:** Windows Kerberos

**危害等级:** 高危，允许未经身份验证的攻击者提升权限

**影响版本:** 受影响的Windows Server版本见漏洞库信息

**利用条件:** 目标系统必须允许未经过预身份验证的Kerberos请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-33679 是一个Windows Kerberos权限提升漏洞。攻击者可以通过发送特制的AS-REQ（认证服务请求）消息到KDC（密钥分发中心），利用Kerberos协议中的加密降级攻击，绕过身份验证并获得提升的权限。

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的POC代码有效。搜索结果中的多个链接指向了对此漏洞的技术分析和利用，包括攻击利用方式
提供的POC代码是一个Python脚本，用于检测目标系统是否存在CVE-2022-33679漏洞。它通过构造一个不包含预身份验证信息的AS-REQ消息，并将其发送到KDC。如果KDC返回AS-REP（认证服务回复）消息而没有要求预身份验证，则表明系统易受攻击。

**利用方式:**
1.  攻击者构造一个恶意的AS-REQ消息，其中包含降级的加密类型。
2.  攻击者将此消息发送到KDC。
3.  如果KDC没有正确处理降级的加密类型，它会返回一个AS-REP消息，而无需进行预身份验证。
4.  攻击者可以使用此AS-REP消息来获得Kerberos票证，并提升权限。

**投毒风险评估:**
对提供的POC代码进行了分析，主要功能是检测漏洞是否存在，并无恶意行为。不过由于代码经过base64编码，并且存在动态执行行为，存在一定的风险。整体评估投毒的可能性较低，风险评估值为1%。

**项目地址:** [soy-oreocato/CVE-2022-33679_Checker](https://github.com/soy-oreocato/CVE-2022-33679_Checker)

**漏洞详情:** [CVE-2022-33679](https://nvd.nist.gov/vuln/detail/CVE-2022-33679)