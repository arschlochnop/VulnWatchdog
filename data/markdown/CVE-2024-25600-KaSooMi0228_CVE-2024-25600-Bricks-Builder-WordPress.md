## CVE-2024-25600 - WordPress Bricks Builder RCE

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行

**影响应用:** Bricks Builder

**危害等级:** 极高，可能完全控制服务器

**影响版本:** <= 1.9.6

**利用条件:** Bricks Builder插件版本 <= 1.9.6，且目标WordPress站点可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600是WordPress Bricks Builder插件中的一个远程代码执行漏洞。攻击者可以通过向 `/wp-json/bricks/v1/render_element` 端点发送特制的POST请求来利用此漏洞，无需身份验证。请求体包含一个 'queryEditor' 字段，该字段的内容被不安全地执行，导致代码注入。 

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源表明这是一个未经身份验证的远程代码执行漏洞，并且存在公开可用的POC代码。给出的`curl`命令PoC和Python脚本都可以用来验证和利用该漏洞。

**投毒风险分析：**
提供的Python脚本（`exploit.py`）具有一定的投毒风险。虽然脚本的主要功能是利用漏洞，但存在以下潜在的投毒点：
1.  **`command` 参数：** 脚本允许用户自定义执行的命令。如果攻击者能够控制此参数，他们可以执行任意恶意命令。虽然提供的示例命令是 `whoami`，但实际使用中可以替换为任何系统命令。
2.  **隐蔽后门：** 代码中没有明显的后门，但考虑到脚本的功能，攻击者可以修改脚本以在目标系统上植入持久性后门，例如添加计划任务或修改系统文件。需要进一步分析代码以确认是否存在此类后门。
   因此，该POC代码存在大约10%的投毒风险。

**利用方式分析：**
1.  **Nonce获取：** 脚本首先尝试从目标网站的HTML源码中提取nonce值。Nonce用于绕过某些安全检查。
2.  **构造恶意请求：** 脚本构造一个POST请求，将其发送到`/wp-json/bricks/v1/render_element`端点。请求体包含一个精心构造的JSON对象，其中`queryEditor`字段包含要执行的恶意代码。
3.  **代码执行：** Bricks Builder插件在处理请求时，没有对`queryEditor`字段的内容进行充分的验证和过滤，导致其中的代码被执行，从而实现远程代码执行。
4. **命令执行** 脚本允许执行系统命令，从而控制受影响的服务器。

总而言之，此漏洞的利用方式是利用Bricks Builder插件中对用户输入验证不足的缺陷，通过构造恶意请求注入并执行任意PHP代码，最终达到控制目标服务器的目的。

**项目地址:** [KaSooMi0228/CVE-2024-25600-Bricks-Builder-WordPress](https://github.com/KaSooMi0228/CVE-2024-25600-Bricks-Builder-WordPress)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)