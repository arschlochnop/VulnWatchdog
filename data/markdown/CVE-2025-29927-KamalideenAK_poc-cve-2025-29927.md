## CVE-2025-29927-Next.js 中间件绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 11.1.4 - 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要Next.js应用使用中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是 Next.js 中一个权限绕过漏洞，影响版本包括 11.1.4 到 13.5.6，大于 14.0.0 小于 14.2.25，以及大于 15.0.0 小于 15.2.3。 漏洞原因是 Next.js 中间件对于 `x-middleware-subrequest` 头部处理不当，导致可以绕过中间件中实现的授权检查。

**有效性评估：**

*   提供的 POC 代码通过设置 `x-middleware-subrequest` 头部来模拟内部子请求，从而绕过中间件的权限检查。代码通过比较有无该头部时的响应状态来判断是否存在漏洞。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和利用方式，所以提供的POC代码有效。

**投毒风险分析：**

*   POC 代码主要功能是测试目标应用是否存在漏洞，其核心是构造带有 `x-middleware-subrequest` 头部的 HTTP 请求。代码中包含 `rejectUnauthorized: false` 用于测试自签名证书站点，这降低了代码的安全性，但本身不是投毒代码。总体而言，代码逻辑相对简单，没有发现明显的恶意行为，投毒风险较低，评估为5%。

**利用方式：**

1.  攻击者向目标 Next.js 应用发送 HTTP 请求，请求访问受保护的路由。
2.  在请求头中添加 `x-middleware-subrequest: 1` 头部，伪装成 Next.js 内部子请求。
3.  由于 Next.js 对带有该头部的请求处理不当，导致中间件的权限检查被绕过。
4.  攻击者成功访问受保护的资源，绕过身份验证。

**项目地址:** [KamalideenAK/poc-cve-2025-29927](https://github.com/KamalideenAK/poc-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)