## CVE-2021-42013-Apache HTTP Server-路径遍历和远程代码执行

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 服务器运行受影响的Apache版本，存在Alias-like指令配置，且允许CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013是Apache HTTP Server 2.4.49和2.4.50版本中存在的路径遍历和远程代码执行漏洞。该漏洞是CVE-2021-41773的不完整修复。攻击者可以通过构造包含路径遍历序列（如`..`）的恶意URL，绕过Alias-like指令的限制，访问服务器上的任意文件。如果服务器配置允许在这些别名路径上执行CGI脚本，攻击者还可以利用该漏洞执行任意代码。

**有效性评估：**
根据漏洞信息、搜索结果和提供的Dockerfile和docker-compose.yml，提供的POC代码旨在搭建一个存在漏洞的Apache HTTP Server 2.4.50环境。因此，该POC代码是有效的，可以用于验证和复现该漏洞。

**投毒风险评估：**
仔细分析了Dockerfile，httpd.conf和suricata.yaml文件，该文件用于部署一个可利用的Apache服务器。然而，无法保证其中没有任何隐藏的恶意代码。虽然主要目的是重现CVE-2021-42013，但仍存在细微的投毒风险。尽管可能性较低，但在未充分审查每个组件的情况下，无法完全排除风险。
httpd.conf可能存在非默认配置，方便漏洞利用。

**利用方式分析：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml搭建存在漏洞的Apache HTTP Server 2.4.50环境。
2.  **路径遍历：**  构造包含路径遍历序列的URL，例如：`http://<服务器IP>:8080/icons/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/etc/passwd`，尝试访问服务器上的`/etc/passwd`文件。
3.  **远程代码执行：** 如果服务器配置允许CGI脚本执行，可以构造包含恶意代码的URL，例如：`http://<服务器IP>:8080/cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh`，并执行系统命令。

成功利用此漏洞需要满足特定条件，包括存在易受攻击的Apache版本、适当的服务器配置和网络可访问性。

**项目地址:** [vudala/CVE-2021-42013](https://github.com/vudala/CVE-2021-42013)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)