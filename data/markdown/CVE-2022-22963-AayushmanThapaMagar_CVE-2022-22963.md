## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致完全控制服务器

**影响版本:** Spring Cloud Function versions 3.1.6, 3.2.2 and older unsupported versions

**利用条件:** 目标应用程序使用了Spring Cloud Function的路由功能，且允许外部用户通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-22963 漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造恶意的SpEL表达式作为路由表达式，从而导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索结果，该漏洞被评为高危，且存在公开可用的PoC（漏洞利用代码）。提供的Python脚本尝试利用该漏洞，通过发送包含恶意SpEL表达式的HTTP POST请求到`/functionRouter`路径，来执行任意命令。脚本通过`java.lang.Runtime.getRuntime().exec()`方法来执行命令。

**投毒风险分析：**

提供的Python脚本主要功能是利用漏洞，没有发现恶意代码，如文件上传、反弹shell到未知服务器等。LICENSE文件声明为公共领域，降低了恶意作者植入后门的可能。因此，可以认为投毒风险较低，评估为0%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本的Spring Cloud Function的应用程序。
2.  **发送恶意请求：** 使用PoC脚本，指定目标URL、攻击者IP地址和端口。脚本会构造一个包含恶意SpEL表达式的HTTP POST请求，其中SpEL表达式会执行反弹shell命令。
3.  **监听端口：** 在攻击者机器上监听指定的端口，等待反弹shell连接。
4.  **获取Shell：** 如果漏洞利用成功，攻击者将获得目标服务器的shell访问权限，从而可以执行任意命令。

**项目地址:** [AayushmanThapaMagar/CVE-2022-22963](https://github.com/AayushmanThapaMagar/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)