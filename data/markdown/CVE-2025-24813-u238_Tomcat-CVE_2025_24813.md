## CVE-2025-24813-Apache Tomcat-路径遍历/反序列化RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/反序列化RCE

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet开启写入(disabled by default), 支持partial PUT(enabled by default), application 使用了Tomcat基于文件的session持久化，使用了默认的存储位置，并且application包含可被反序列化攻击利用的library。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，可能导致远程代码执行和/或信息泄露。该漏洞的根源在于对文件名的处理方式，特别是内部点（'file.Name'）。

**漏洞利用方式分析：**

根据漏洞库信息和搜索结果，该漏洞存在两种利用方式：

1.  **信息泄露/恶意内容注入：** 如果满足以下条件，攻击者能够查看敏感文件或注入恶意内容：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   目标URL是公共上传URL的子目录。
    *   攻击者知道敏感文件名。
    *   使用 partial PUT 上传敏感文件。

2.  **远程代码执行（RCE）：** 如果满足以下条件，攻击者能够执行任意代码：
    *   默认Servlet开启写入。
    *   支持partial PUT。
    *   应用程序使用Tomcat的基于文件的session持久化，并使用默认存储位置。
    *   应用程序包含一个可以用于反序列化攻击的library。

**POC 代码分析：**

POC代码`CVE_2025_24813.py`实现了以下功能：

1.  **检查Servlet是否可写：** 使用PUT请求向目标URL上传文件，检查HTTP响应状态码，以确定服务器是否允许写入。
2.  **生成ysoserial payload：** 使用ysoserial工具生成反序列化payload，需要指定命令、ysoserial路径和gadget。
3.  **生成Java payload：**  生成一个简单的java文件, 然后通过javac编译为class文件, 再打包为jar文件。
4.  **上传和验证payload：** 上传生成的payload到Tomcat服务器, 利用路径穿越漏洞，覆盖session文件，从而执行代码。

**有效性评估：**

根据搜索结果，CVE-2025-24813漏洞正在被积极利用。POC代码涵盖了漏洞利用的关键步骤，包括写入性验证、payload生成和上传，因此可以认为是有效的，但利用成功与否取决于目标环境是否满足利用条件。

**投毒风险评估：**

通过分析POC代码，发现存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖外部工具ysoserial：**  POC代码依赖于ysoserial工具生成反序列化payload。虽然ysoserial是一个常用的漏洞利用工具，但如果用户下载了被篡改的ysoserial版本，可能会执行恶意代码。虽然POC本身没有直接植入恶意代码，但依赖的外部资源存在被投毒的风险。
2.  **执行任意命令：**  该脚本允许执行任意命令。如果攻击者控制了用户运行脚本的环境，可以修改脚本，执行恶意的系统命令，从而控制目标系统。

综合考虑，该POC代码的投毒风险较低，约为5%。大部分代码是用于漏洞利用，风险主要来源于对外部依赖的信任和对执行环境的控制。


**项目地址:** [u238/Tomcat-CVE_2025_24813](https://github.com/u238/Tomcat-CVE_2025_24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)