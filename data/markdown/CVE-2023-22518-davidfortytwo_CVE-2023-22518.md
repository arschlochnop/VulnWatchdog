## CVE-2023-22518 - Confluence Server/Data Center Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Confluence Server/Data Center

**危害等级:** 高危，完全丧失保密性、完整性和可用性

**影响版本:** All versions of Confluence Data Center and Server are affected except versions >= 7.19.16, >= 8.3.4, >= 8.4.4, >= 8.5.3, >= 8.6.1

**利用条件:** 需要网络访问未打补丁的Confluence实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22518是一个Confluence Server和Data Center的严重漏洞，允许未经身份验证的攻击者重置Confluence并创建Confluence实例管理员帐户。根据漏洞库信息和搜索结果，该漏洞已被积极利用，甚至被用于部署Cerber勒索软件。提供的PoC代码通过以下步骤利用漏洞：

1.  **触发漏洞：** 通过发送GET请求到`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，将Confluence置于未设置完成的状态。
2.  **创建管理员账户：** 向`/setup/setupadministrator.action`发送POST请求，创建一个新的管理员账户，用户名、密码等信息由用户提供。
3.  **验证：** 使用新创建的管理员账户登录，验证漏洞是否成功利用。

**有效性：** 根据漏洞描述、搜索结果以及PoC代码的逻辑，该PoC代码是有效的。 漏洞库信息和搜索结果也表明该漏洞已被积极利用。

**投毒风险：** PoC代码中未发现明显的恶意投毒代码。PoC的功能是利用漏洞创建管理员账户。需要关注的是，攻击者在使用PoC时可能修改账户相关配置，但PoC本身没有发现后门或其他恶意操作。PoC里存在一些可以被利用的点，比如可以修改默认创建的用户配置信息,该用户密码可能被作者提前记录,所以PoC存在一定的风险,综合考虑判断投毒风险为5%。

**利用方式：** 攻击者利用此漏洞，无需任何凭据，通过两次HTTP请求即可创建一个Confluence管理员帐户，从而完全控制Confluence实例。

**项目地址:** [davidfortytwo/CVE-2023-22518](https://github.com/davidfortytwo/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)