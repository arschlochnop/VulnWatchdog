## CVE-2025-34077 - WordPress Pie Register Plugin Authentication Bypass RCE

**漏洞编号:** CVE-2025-34077

**漏洞类型:** 身份验证绕过 + 远程代码执行

**影响应用:** WordPress Pie Register Plugin

**危害等级:** 严重，未经身份验证的攻击者可以完全控制WordPress站点

**影响版本:** <= 3.7.1.4

**利用条件:** 目标站点安装了存在漏洞的Pie Register插件，并且版本为3.7.1.4或更低

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 WordPress Pie Register 插件中，允许未经身份验证的攻击者通过向 /wp-login.php 发送特制的 POST 请求来模拟任意用户。通过设置 social_site=true 并操纵 user_id_social_site 参数，攻击者可以为任何用户ID（包括管理员）生成有效的 WordPress 会话 cookie。身份验证成功后，攻击者可以利用插件上传功能安装包含任意 PHP 代码的恶意插件，从而在底层服务器上实现远程代码执行。

**有效性分析：**
提供的POC代码 (`pie.py`) 似乎有效。它模拟了漏洞描述中提到的POST请求，并尝试获取管理员会话cookie。代码清晰易懂，直接发送包含`user_id_social_site`和`social_site`参数的POST请求到目标站点的根目录，根据漏洞描述，这应该能绕过身份验证并返回管理员cookie。

**投毒风险分析：**
POC代码没有发现明显的投毒代码。脚本的功能仅限于发送恶意请求并解析响应中的cookie。所有操作都是围绕利用已知的身份验证绕过漏洞展开的。虽然脚本可以用来非法获取管理员权限，但它本身并没有包含任何额外的恶意功能或后门，因此可以认为投毒风险为0%。

**利用方式：**
1.  **身份验证绕过：** 攻击者发送一个POST请求到目标 WordPress 站点的 /wp-login.php 或根目录，其中包含以下参数：`social_site=true` 和 `user_id_social_site=1` (或其他目标用户ID)。
2.  **获取管理员权限：** 如果漏洞存在，服务器会返回包含有效管理员会话cookie的响应。
3.  **远程代码执行：** 攻击者使用获取的管理员cookie登录 WordPress 后台，利用插件上传功能上传一个包含恶意 PHP 代码的插件。
4.  **控制服务器：** 恶意插件被激活后，其中的 PHP 代码将在服务器上执行，使攻击者获得对服务器的完全控制。

**项目地址:** [MrjHaxcore/CVE-2025-34077](https://github.com/MrjHaxcore/CVE-2025-34077)

**漏洞详情:** [CVE-2025-34077](https://nvd.nist.gov/vuln/detail/CVE-2025-34077)