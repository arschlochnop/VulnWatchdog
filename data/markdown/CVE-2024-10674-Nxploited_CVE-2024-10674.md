## CVE-2024-10674-Th_Shop_Mania-任意插件安装/激活

**漏洞编号:** CVE-2024-10674

**漏洞类型:** 任意插件安装/激活

**影响应用:** Th Shop Mania

**危害等级:** 高危，可能导致远程代码执行和权限提升

**影响版本:** <= 1.4.9

**利用条件:** 需要WordPress Subscriber+ 权限

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2024-10674是Th Shop Mania WordPress主题中的一个漏洞，允许具有Subscriber或更高级别权限的经过身份验证的攻击者安装任意插件。漏洞存在于`th_shop_mania_install_and_activate_callback()`函数中，缺少权限检查。

**利用方式：**

1.  **漏洞检测：** 脚本首先检查目标站点是否运行易受攻击的Th Shop Mania主题版本（<= 1.4.9），通过访问readme.txt文件并解析版本号。
2.  **身份验证：** 脚本使用提供的用户名和密码登录到WordPress站点。
3.  **Nonce提取：** 登录后，脚本访问主题设置页面，提取用于插件安装和激活的nonce值。这些nonce用于绕过CSRF保护。
4.  **插件安装：** 脚本构造一个POST请求，将指定的插件安装到WordPress站点。攻击者可以指定要安装的插件。默认插件是 `th-all-in-one-woo-cart`。
5.  **插件激活：** 脚本构造另一个POST请求以激活安装的插件。成功激活后，恶意插件可以用于进一步的攻击，例如远程代码执行。

**投毒风险：**

该漏洞利用代码存在极高的投毒风险。攻击者可以通过修改`plugin`参数来安装恶意插件。由于脚本允许安装任意插件，攻击者可以上传包含后门或恶意功能的插件，从而完全控制受感染的WordPress站点。此外，该脚本的作者信息显示 `# By Nxploit | Khaled alenazi,`，虽然不能直接证明投毒，但增加了额外的风险因素。

**项目地址:** [Nxploited/CVE-2024-10674](https://github.com/Nxploited/CVE-2024-10674)

**漏洞详情:** [CVE-2024-10674](https://nvd.nist.gov/vuln/detail/CVE-2024-10674)