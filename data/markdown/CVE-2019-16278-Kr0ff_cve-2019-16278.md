## CVE-2019-16278-Nostromo nhttpd-目录遍历导致RCE

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 需要目标主机运行存在漏洞的 Nostromo nhttpd 服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-16278 是 Nostromo nhttpd 1.9.6 版本及更早版本中 http_verify 函数存在的一个目录遍历漏洞。攻击者可以通过构造恶意的 HTTP 请求，利用 `/.%0d./` 绕过路径检查，从而执行任意命令。提供的漏洞利用代码 `cve2019_16278.py` 通过发送包含精心构造的路径的 POST 请求到目标服务器的 `/bin/sh` 路径，并在请求体中包含要执行的命令来实现远程代码执行。 代码使用 `%0d` (CR) 进行编码来绕过目录遍历的限制。虽然代码本身的功能是利用该漏洞，但需要人工确认目标机器是否已经安装了后门，由于执行的是任意命令，存在被植入后门的风险，但代码本身没有明显的投毒行为，只能说使用这个POC存在一定的潜在风险，所以投毒风险较低。

**漏洞利用方式：**

1.  攻击者发送特制的 HTTP POST 请求到目标服务器，请求的 URL 中包含 `/.%0d./` 序列，目的是进行目录遍历。
2.  该请求尝试访问 `/bin/sh`，并执行请求体中指定的命令。
3.  服务器的 `http_verify` 函数在处理请求时，由于目录遍历漏洞，未能正确限制请求的路径，导致攻击者可以访问和执行系统命令。
4.  攻击者通过在请求体中插入恶意命令（例如反弹 shell），从而实现远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该 POC 代码有效。CVE 详情页面和 Exploit-DB 上的信息都表明该漏洞可以被利用进行远程代码执行。

**投毒风险分析：**
检查提供的 Python 脚本 `cve2019_16278.py`，没有发现明显的恶意代码，该脚本的主要功能是发送格式化的 HTTP 请求来利用该漏洞。该漏洞本身允许执行任意命令，这意味着攻击者 *可以* 使用此漏洞来部署后门或其他恶意软件。 因此，虽然提供的利用代码本身不是恶意软件，但是使用此漏洞存在引入恶意代码的风险，因此给出一个较低的投毒风险评估。

**项目地址:** [Kr0ff/cve-2019-16278](https://github.com/Kr0ff/cve-2019-16278)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)