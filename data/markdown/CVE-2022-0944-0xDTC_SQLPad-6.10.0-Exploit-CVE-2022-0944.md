## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行

**影响应用:** SQLPad

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户才能进行数据库连接测试

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0944是SQLPad中存在的一个模板注入漏洞，存在于连接测试端点。未经授权的攻击者可以通过构造恶意请求，在`host`和`database`字段中注入恶意代码，利用Node.js的`child_process`模块执行任意系统命令，从而实现远程代码执行（RCE）。

**有效性:**

提供的PoC代码看起来有效。它利用了SQLPad未正确过滤用户输入，导致模板引擎执行了恶意代码。该PoC代码构造了一个包含反弹shell的payload，并将其注入到POST请求的`host`和`database`字段中，发送到`/api/test-connection`端点。成功利用后，目标服务器会向攻击者的机器发起反弹shell连接。

**投毒风险:**

分析提供的Bash脚本和README文件，未发现明显的投毒代码。脚本的主要功能是利用漏洞，并没有执行任何恶意操作，例如篡改系统文件或安装恶意软件。README文件仅包含漏洞描述、使用方法和免责声明。因此，可以认为此仓库的投毒风险很低（0%）。

**利用方式:**

1.  攻击者需要搭建一个netcat监听器 (`nc -lvnp 9001`)，用于接收目标服务器的反弹shell。
2.  攻击者需要修改PoC脚本中的`TARGET`变量，设置为目标SQLPad服务器的地址。
3.  攻击者需要修改PoC脚本中的`REVERSE_IP`变量，设置为攻击者机器的IP地址。
4.  运行PoC脚本，脚本会构造一个包含恶意payload的POST请求，并将其发送到目标服务器的`/api/test-connection`端点。
5.  如果漏洞利用成功，目标服务器会执行payload中的反弹shell命令，攻击者将在其netcat监听器上获得一个shell，从而实现远程代码执行。

**项目地址:** [0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944](https://github.com/0xDTC/SQLPad-6.10.0-Exploit-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)