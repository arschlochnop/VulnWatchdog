## CVE-2025-54309 - CrushFTP AS2 Validation Authentication Bypass

**漏洞编号:** CVE-2025-54309

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，允许未经授权的远程攻击者获得管理员访问权限

**影响版本:** < 10.8.5 和 < 11.3.4_23（未启用DMZ代理时）

**利用条件:** 目标CrushFTP实例运行在受影响的版本范围内，且DMZ代理功能未被启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-54309是CrushFTP中的一个身份验证绕过漏洞。当DMZ代理功能未被使用时，CrushFTP未能正确处理AS2验证，允许远程攻击者通过构造特制的AS2 HTTPS请求绕过身份验证并获得管理员权限。

**漏洞利用分析：**

1.  **漏洞原理：** 漏洞源于AS2验证处理不当，允许攻击者在没有有效凭据的情况下冒充管理员用户。
2.  **POC分析：**
    *   提供的`crushedftp.py`脚本是一个利用此漏洞的POC（概念验证）脚本。
    *   该脚本使用竞态条件攻击（race condition）绕过身份验证。
    *   它并发发送两个HTTP请求：一个带有`AS2-TO`头（`as2_worker`），另一个没有（`reg_worker`）。
    *   这些请求试图同时创建一个新用户，利用服务器端的处理差异来突破身份验证。
    *   `create_user_payload` 函数构建用于创建用户的 XML Payload，该 Payload 会设置用户名和密码。
    *   `send_payload` 函数负责发送带有构造Payload 的 HTTP 请求。
    *   `new_c2f_cookie` 函数生成 c2f_cookie， 用于绕过验证。
    *   `race_requests` 函数负责进行多线程并发请求。
3.  **利用方式：**
    *   攻击者需要指定目标CrushFTP服务器的URL。
    *   通过运行POC脚本，并发发送精心构造的HTTP请求，尝试创建一个新的管理员用户。
    *   如果竞态条件成功，脚本将创建一个具有指定用户名和密码的管理员帐户。
    *   攻击者随后可以使用新创建的管理员帐户登录并控制CrushFTP服务器。
4.  **投毒风险评估：**
    *   分析提供的python脚本，没有发现任何恶意或隐藏的代码，该脚本只是实现了POC的功能，用于验证漏洞的存在。因此投毒风险为0%。

综上所述，提供的POC代码有效，可以利用竞态条件绕过CrushFTP的身份验证，从而获得管理员访问权限。该代码经过检查，没有发现潜在的投毒行为。

**项目地址:** [chin-tech/CrushFTP_CVE-2025-54309](https://github.com/chin-tech/CrushFTP_CVE-2025-54309)

**漏洞详情:** [CVE-2025-54309](https://nvd.nist.gov/vuln/detail/CVE-2025-54309)