## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要开启`follow_symlinks=True`的静态文件服务，且目标服务器存在可利用的文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23334是aiohttp框架中存在的一个目录遍历漏洞。当使用aiohttp作为Web服务器并配置静态路由时，如果启用了`follow_symlinks=True`选项，则可能允许攻击者通过构造包含`../`的URL来访问静态文件目录之外的文件。

**有效性：**
提供的POC代码 (`exploit.sh`) 是有效的。它通过`curl`命令构造包含多层`../`的URL，尝试读取目标服务器上的任意文件。脚本接受主机、端口和文件名作为参数，并首先检查服务器是否可访问。

**投毒风险：**
查看提供的文件列表，其中包含`README.md`和`exploit.sh`，没有发现任何明显的恶意代码。脚本的功能明确且直接，没有隐藏的后门或恶意行为。因此，判断此仓库中存在作者隐藏的投毒代码的可能性较低，评估为0%。

**利用方式：**
1.  **配置环境：** 受害者使用`aiohttp`作为web server，并开启了静态资源服务，设置了`follow_symlinks=True`。
2.  **构造恶意URL：** 攻击者构造包含多个`../`的URL，例如：`http://<host>:<port>/static/../../../../etc/passwd`，尝试访问`/etc/passwd`文件。
3.  **发送请求：** 攻击者将构造的URL发送给服务器。
4.  **读取文件：** 如果漏洞存在且利用成功，服务器将返回`/etc/passwd`文件的内容。

POC中`folder`变量值如果和实际部署不一致，需要修改该变量。


**项目地址:** [Pylonet/CVE-2024-23334](https://github.com/Pylonet/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)