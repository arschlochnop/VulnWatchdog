## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本众多，参见漏洞库信息

**利用条件:** 需要用户或应用程序运行或安装被修改的、经过签名的PE文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2013-3900是一个WinVerifyTrust函数处理Windows Authenticode签名验证时存在的远程代码执行漏洞。攻击者可以修改已签名的PE文件，在不破坏签名的情况下添加恶意代码。 

**有效性：**
提供的PowerShell代码实际上是一个缓解措施，而不是漏洞利用代码。它通过设置注册表键`EnableCertPaddingCheck`来启用证书填充检查，从而修复该漏洞。根据微软的描述，此注册表键在受影响的Windows版本中可用，但默认情况下未启用。因此，提供的代码本身并不能用来利用漏洞，而是用于修复漏洞。

**投毒风险：**
该PowerShell脚本的目的是缓解CVE-2013-3900漏洞，通过修改注册表并重启CryptSvc服务来启用更严格的证书填充检查。尽管该脚本本身是为了安全目的，但仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **篡改注册表：** 恶意修改注册表键值可能导致系统不稳定或其他应用程序出现问题。例如，将`EnableCertPaddingCheck`设置为非预期值，或修改CAPI2日志相关的配置，可能干扰正常的系统运行或调试。
2.  **服务重启风险：** 强制重启`CryptSvc`服务可能导致依赖该服务的应用程序中断或数据丢失。
3.  **Verbose日志配置：** 过度启用Verbose日志可能导致磁盘空间快速耗尽。
4.  **权限提升：** 脚本需要管理员权限运行，如果攻击者欺骗用户运行恶意修改后的脚本，可能提升权限并执行恶意操作。

因此，虽然该脚本的主要意图是缓解漏洞，但仍需谨慎使用，并确保来源可信。投毒风险评估为10%，主要考虑到潜在的误用或恶意修改，而非脚本本身的设计目的。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者获得一个合法的、已签名的PE文件。
2.  攻击者修改该PE文件，在签名数据填充区域添加恶意代码。由于WinVerifyTrust函数在默认情况下没有执行严格的填充检查，所以恶意代码不会使签名失效。
3.  攻击者诱骗用户或应用程序运行被修改的PE文件。这可以通过多种方式实现，例如通过鱼叉式网络钓鱼、恶意软件捆绑、或利用其他漏洞。
4.  当用户运行被修改的PE文件时，恶意代码将在用户的系统上执行，攻击者可以控制受影响的系统。

**项目地址:** [Securenetology/CVE-2013-3900](https://github.com/Securenetology/CVE-2013-3900)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)