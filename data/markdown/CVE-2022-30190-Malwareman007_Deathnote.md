## CVE-2022-30190-Microsoft Windows MSDT 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 见漏洞库信息中受影响的版本

**利用条件:** 用户需要打开一个恶意构造的文档（例如 Word 文档）。攻击者可以通过鱼叉式网络钓鱼活动传播恶意文档。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，也被称为“Follina”，是一个存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**利用方式：**该漏洞通过以下方式利用：

1.  攻击者创建一个恶意 Word 文档或其他支持外部链接的文档。
2.  该文档包含一个指向远程服务器上 HTML 文件的链接，该链接使用 `ms-msdt:` 协议。
3.  当用户打开文档时，Word 会尝试检索该 HTML 文件。
4.  `ms-msdt:` 协议处理程序被调用，执行 HTML 文件中包含的恶意代码。
5.  攻击者通过精心构造的 HTML 文件，利用 MSDT 的漏洞执行任意命令。

**有效性：**根据提供的漏洞库信息和搜索结果，该漏洞已经过积极利用，且PoC 代码可用，因此可以判断提供的POC代码是有效的。

**投毒风险：**PoC代码中存在潜在的投毒风险的可能性较低，约为10%。 代码中，通过`Invoke-WebRequest`从GitHub下载`nc64.exe`可能存在风险，如果github仓库被污染，攻击者可以直接执行任意代码。其他的风险较低。

**项目地址:** [Malwareman007/Deathnote](https://github.com/Malwareman007/Deathnote)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)