## CVE-2018-25031-Swagger UI-远程OpenAPI定义欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和XSS攻击

**影响版本:** <= 4.1.2 (也可能存在于更高版本)

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者进行欺骗攻击。攻击者通过诱使用户打开一个特制的URL，可以利用此漏洞显示远程OpenAPI定义。根据搜索结果和漏洞信息，该漏洞的PoC是有效的。攻击者可以利用此漏洞，通过加载恶意的OpenAPI定义文件（例如xss.yaml）来欺骗用户，甚至可能执行跨站脚本攻击(XSS)。

**有效性：**

提供的PoC代码是有效的，因为它包含一个README.md文件、用于定义远程OpenAPI定义的JSON文件（poc.json），以及两个YAML文件（poc.yaml和xss.yaml）。其中，xss.yaml包含恶意的JavaScript代码，可以触发XSS攻击。

**投毒风险：**

代码仓库的投毒风险较低，约为10%。虽然xss.yaml文件包含潜在的XSS攻击代码，但它属于PoC的一部分，用于演示漏洞。其他文件看起来是合法的OpenAPI定义文件或配置文件，没有发现明显的恶意代码。但仍需谨慎，因为攻击者可能在OpenAPI定义中嵌入其他类型的恶意行为，例如SSRF攻击。

**利用方式：**

1.  攻击者创建一个包含恶意内容的OpenAPI定义文件(例如xss.yaml，包含`<noscript>`标签尝试注入XSS)。
2.  攻击者将此文件托管在远程服务器上。
3.  攻击者构造一个包含特定参数的URL，诱使用户打开，该URL指向受影响的Swagger UI实例，并指定加载恶意OpenAPI定义文件的URL作为参数。
4.  当用户打开该URL时，Swagger UI会加载并显示恶意OpenAPI定义文件，从而可能导致欺骗或XSS攻击。

总结来说，该漏洞的利用方式是通过欺骗用户加载恶意的OpenAPI定义文件，从而控制Swagger UI的显示内容，甚至执行恶意脚本。

**项目地址:** [hev0x/CVE-2018-25031-PoC](https://github.com/hev0x/CVE-2018-25031-PoC)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)