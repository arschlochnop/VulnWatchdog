## CVE-2025-1653-uListing-权限提升

**漏洞编号:** CVE-2025-1653

**漏洞类型:** 权限提升

**影响应用:** Directory Listings WordPress plugin – uListing

**危害等级:** 高危，可使订阅者级别用户提升为管理员

**影响版本:** <= 2.1.7

**利用条件:** 需要已登录的订阅者级别或以上权限的用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1653是WordPress uListing插件2.1.7及更早版本中存在的权限提升漏洞。攻击者利用该漏洞，通过`stm_listing_profile_edit` AJAX action，修改`user_role`等用户元数据，将自己的角色提升为管理员。

**有效性评估：**

提供的PoC代码看起来有效，因为它模拟了具有必要参数（`action`、`user_id`、`user_role`）的AJAX请求，并设置了必要的cookie（`PHPSESSID`、`wordpress_logged_in_*`）。代码逻辑清晰，首先尝试将用户角色设置为管理员，然后验证角色是否已成功更改。根据漏洞信息，这正是利用此漏洞所需的步骤。搜索引擎结果提供了漏洞的描述和一些参考链接，这进一步增强了该PoC的有效性。

**投毒风险分析：**

该代码存在少量投毒风险，风险评估为10%。以下是分析依据：
*   **t.me/uncodeboss和t.me/realcodeb0ss推广链接：**PoC代码中包含Telegram频道链接，暗示作者可能希望通过该代码推广其频道或服务。虽然这本身不是恶意行为，但增加了代码被作者控制或修改的可能性，以及通过该渠道分发恶意代码的可能性。诱导用户加入这些频道存在潜在风险。
*   **VIP用户和折扣代码：**提供VIP用户和折扣代码，暗示作者有盈利目的，也存在潜在的风险。
*   **代码的潜在修改风险：** 虽然PoC代码本身看起来直接实现了权限提升，但将来作者可能会修改代码，添加额外的恶意功能，例如植入后门或窃取用户数据。

**漏洞利用方式：**

1.  **前提条件：** 攻击者需要拥有一个WordPress网站上的有效帐户，该帐户至少具有订阅者级别或更高的权限。目标站点安装了易受攻击版本的uListing插件（<= 2.1.7）。
2.  **漏洞利用：**
    *   攻击者使用PoC脚本，指定目标WordPress网站的URL、目标用户ID、PHPSESSID和wordpress_logged_in cookie。
    *   脚本向`/wp-admin/admin-ajax.php`端点发送一个POST请求，其中包含`action=stm_listing_profile_edit`，以及要提升权限的`user_id`和`user_role=administrator`。
    *   服务器端未充分验证用户的权限，允许已登录的用户修改其他用户的`user_role`元数据。
    *   攻击者成功将自己的帐户权限提升为管理员。
3.  **验证：** 脚本通过发送`action=get_user_meta`的请求来验证用户是否已成功提升为管理员。如果响应中包含`administrator`，则表示攻击成功。


**项目地址:** [realcodeb0ss/CVE-2025-1653-poc](https://github.com/realcodeb0ss/CVE-2025-1653-poc)

**漏洞详情:** [CVE-2025-1653](https://nvd.nist.gov/vuln/detail/CVE-2025-1653)