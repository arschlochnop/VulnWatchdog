## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS) 导致远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致任意代码执行和服务器控制

**影响版本:** 3.2.0 到 3.4.2

**利用条件:** 需要目标WonderCMS实例运行在受影响的版本范围内，攻击者能够诱导用户点击恶意链接，并且目标服务器允许通过`installModule`安装主题。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞是Wonder CMS v3.2.0 到 v3.4.2版本中的一个跨站脚本漏洞（XSS），允许远程攻击者通过精心设计的脚本，利用`installModule`组件执行任意代码。具体利用方式如下：

1.  **漏洞原理：**
    *   WonderCMS允许通过URL参数`installModule`安装主题，且未充分验证来源，导致XSS。

2.  **利用步骤：**
    *   攻击者首先需要创建一个包含恶意PHP Web Shell的ZIP文件，命名为`malicious.zip`。
    *   攻击者搭建一个HTTP服务器，用于托管`malicious.js`和`malicious.zip`文件。
    *   攻击者构造一个包含恶意JavaScript的URL，该JavaScript通过`installModule`参数从攻击者的服务器下载并安装包含Web Shell的`malicious.zip`主题。
    *   攻击者将该URL发送给受害者，诱导受害者点击。
    *   受害者点击该URL后，恶意JavaScript会在受害者的浏览器中执行，下载并安装恶意主题。
    *   攻击者通过访问Web Shell的URL，执行任意命令，从而控制服务器。

3.  **POC代码分析：**
    *   `exploit.py`脚本自动化了上述过程，包括创建Web Shell、生成恶意JavaScript URL、启动HTTP服务器等。
    *   脚本首先创建一个简单的PHP Web Shell，将其打包成`malicious.zip`。
    *   然后，脚本生成一个包含恶意JavaScript代码的URL。该URL利用了WonderCMS的`installModule`功能，从攻击者的服务器下载并安装`malicious.zip`。
    *   最后，脚本启动一个HTTP服务器，监听指定的IP地址和端口，用于托管`malicious.js`和`malicious.zip`文件。
4. **投毒风险分析:**
    代码中检查了'malicious'目录是否存在，这有可能是简单的目录存在性检查，也可能通过修改目录名称，存在一个非常隐蔽的后门风险，当然这个是极小概率的，因此判断投毒风险为1%。代码的主要功能是生成恶意payload，并启动http服务，诱导用户点击payload，从而下载恶意zip文件，最终达到RCE的目的，整体代码逻辑清晰，未发现明显的投毒行为。

**总结：**
该漏洞利用较为简单，但需要诱导用户点击恶意链接。成功利用后，攻击者可以完全控制服务器。该POC代码能够有效利用该漏洞。由于XSS需要在浏览器中执行，服务器端投毒的可能性较低。

**项目地址:** [xpltive/CVE-2023-41425](https://github.com/xpltive/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)