## CVE-2024-4956-Sonatype Nexus Repository Manager 3-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经验证的攻击者可以通过构造包含路径遍历的 URL 来读取服务器上的任意文件。根据搜索引擎结果和漏洞库信息，此漏洞的利用相对简单，只需发送特制的 HTTP 请求即可。提供的漏洞利用代码 `shirocrack` 本身并不是直接利用路径遍历漏洞的PoC，而是利用路径遍历读取到的用户密码哈希进行破解的工具。该工具是为了破解 Apache Shiro 框架使用的密码哈希。投毒风险分析：该仓库主要包含一个密码破解工具，其本身功能比较明确，没有发现明显的恶意代码。`shirocrack.go` 只是一个使用字典进行暴力破解的工具，但存在作者添加后门的风险，考虑到该工具的用途，以及作者可能出于某些目的植入恶意代码，因此存在一定的投毒风险, 百分比为10%。利用方式：攻击者首先利用 CVE-2024-4956 路径遍历漏洞读取 Nexus Repository Manager 服务器上的敏感文件，比如包含密码哈希的 `.pcl` 文件。然后，使用提供的 `shirocrack` 工具破解这些密码哈希。如果破解成功，攻击者就可以使用破解的密码登录 Nexus Repository Manager，或者利用泄露的其他信息进行进一步的攻击。

**项目地址:** [An00bRektn/shirocrack](https://github.com/An00bRektn/shirocrack)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)