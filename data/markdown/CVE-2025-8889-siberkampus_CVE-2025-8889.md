## CVE-N/A-WordPress Compress Then Upload Plugin Arbitrary File Upload to RCE

**漏洞编号:** CVE-2025-8889

**漏洞类型:** 任意文件上传导致远程代码执行

**影响应用:** WordPress Compress Then Upload Plugin

**危害等级:** 高危，允许未经授权的用户执行任意代码

**影响版本:** 1.0.3

**利用条件:** 需要具有媒体上传权限的认证用户（Author角色或更高）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

提供的漏洞利用代码针对 WordPress Compress Then Upload Images 插件 1.0.3 版本。该插件存在一个任意文件上传漏洞，攻击者可以通过绕过客户端验证，上传包含恶意 PHP 代码的文件，从而在服务器上执行任意命令。漏洞利用步骤如下：

1.  首先上传一个合法的图片文件 (例如 regular.jpg)。
2.  使用 Burp Suite 等工具拦截上传请求。
3.  修改上传请求中的文件名，将 "regular.jpg" 修改为 "evil.php"。
4.  将文件内容替换为包含恶意 PHP 代码的 WebShell，例如 ```GIF89a;<?php if (isset($_GET['cmd'])) { system($_GET['cmd']); } ?>```。GIF89a 是 GIF 文件的头部，用于绕过简单的服务端图片验证。
5.  保持 Content-Type 为 image/jpeg，以绕过 MIME 类型检查。
6.  发送修改后的请求。
7.  成功上传后，通过访问上传的 PHP 文件并传递 cmd 参数来执行系统命令 (例如 http://target-site.com/wp-content/uploads/2025/07/evil.php?cmd=id )。

**有效性：**
根据提供的 PoC 代码，利用方法清晰，步骤详细，如果目标环境满足条件（存在该插件，版本为 1.0.3，攻击者具有 Author 或更高权限），则漏洞利用应该是有效的。

**投毒风险：**
提供的代码主要包含漏洞利用的说明和 PoC 代码本身。PoC 代码的功能是在目标服务器上创建一个 WebShell，允许通过 GET 请求执行系统命令。该 WebShell 本身是攻击性的，但并非是作者植入的额外后门或投毒代码。仓库里只有README.md, 没有发现额外的恶意脚本或配置。
因此，该仓库本身直接存在投毒代码的可能性较低，可以认为投毒风险为0%。

**利用方式：**
该漏洞利用方式为：
1.  **认证：** 首先需要一个具有 Author 或更高权限的 WordPress 用户账号。
2.  **上传：** 使用该账号登录 WordPress 后台，通过插件的上传界面上传任意文件。
3.  **拦截与修改：** 使用 Burp Suite 等中间人工具拦截上传请求，将文件名修改为具有 .php 扩展名的文件，并将文件内容替换为恶意 PHP 代码。
4.  **绕过：** 通过设置 Content-Type 为 image/jpeg 和在文件内容中添加 GIF 头部来绕过服务器端的文件类型检查。
5.  **执行：** 成功上传后，通过 Web 浏览器或 curl 等工具访问上传的 PHP 文件，并利用 GET 参数执行任意系统命令。

**项目地址:** [siberkampus/CVE-2025-8889](https://github.com/siberkampus/CVE-2025-8889)

**漏洞详情:** [CVE-2025-8889](https://nvd.nist.gov/vuln/detail/CVE-2025-8889)