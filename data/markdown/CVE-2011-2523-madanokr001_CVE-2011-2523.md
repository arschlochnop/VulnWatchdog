## CVE-2011-2523-vsftpd-Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.4 (在20110630和20110703之间下载的版本)

**利用条件:** 目标系统运行受影响的vsftpd版本，且攻击者可以访问21端口和6200端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-2523是vsftpd 2.3.4版本中的一个后门漏洞。该版本的vsftpd在特定时间段内下载的版本被植入了恶意代码。攻击者可以通过发送包含 ":)" 的用户名到21端口触发后门，后门会在6200端口打开一个shell。提供的Python POC代码首先连接到vsftpd服务器的21端口，发送包含 ":)" 的USER命令和任意PASS命令，然后尝试连接到目标主机的6200端口。如果连接成功，则表明后门已经激活，攻击者可以发送命令到6200端口执行任意系统命令。 

**有效性：** 提供的POC代码有效，可以直接利用该漏洞。

**投毒风险：**  POC代码本身看起来比较直接，功能是利用已知的后门，没有发现明显的恶意或隐藏代码。但是，任何代码都可能存在潜在的风险。评估为10%的投毒风险，主要考虑到以下几点：

*   代码来源的安全性无法完全保证。尽管代码看起来简单直接，但无法完全排除作者植入不易察觉的恶意代码的可能性，比如通过编码混淆或者利用socket进行隐蔽操作等。
*   依赖项风险：代码中用到了socket和time库,这些库本身是安全的,但是如果被篡改或者替换，可能会引入恶意功能。
*   github作者权限被盗用或者被入侵的风险。

**利用方式：**

1.  连接目标服务器的21端口（FTP默认端口）。
2.  发送包含 ":)" 的用户名到USER命令，例如 `USER cybermad:)`。
3.  发送任意密码到PASS命令，例如 `PASS pass`。
4.  连接目标服务器的6200端口。
5.  通过6200端口发送命令，在目标系统上执行任意操作。

总而言之，该漏洞利用方式简单，危害性高，但需要目标系统存在受影响的vsftpd版本。

**项目地址:** [madanokr001/CVE-2011-2523](https://github.com/madanokr001/CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)