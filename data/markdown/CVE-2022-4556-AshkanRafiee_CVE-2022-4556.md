## CVE-2022-4556 - Alinto SOGo Stored XSS

**漏洞编号:** CVE-2022-4556

**漏洞类型:** Stored Cross-Site Scripting (XSS)

**影响应用:** Alinto SOGo Webmail

**危害等级:** 中危，可能导致账户劫持、恶意重定向、窃取敏感信息

**影响版本:** <= 5.7.1

**利用条件:** 需要已认证的用户权限, 且目标用户访问邮件模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于 Alinto SOGo Webmail 5.7.1 及更早版本中，允许经过身份验证的攻击者通过修改IMAP账户的“全名 (fullName)”字段，注入恶意 JavaScript 代码。当任何用户（包括攻击者自身）访问邮件模块时，这些恶意脚本将被执行，从而实现跨站脚本攻击。

**有效性分析：**

根据提供的漏洞库信息、搜索引擎结果以及漏洞利用代码，该漏洞利用是有效的。PoC 代码清晰地描述了复现漏洞的步骤，并提供了具体的 XSS payload，该payload经过验证可以触发 stored XSS。

**投毒风险分析：**

该 PoC 的 README.md 文件主要包含漏洞描述、复现步骤、根本原因分析、修复建议以及作者信息。该PoC本身看起来并不包含任何恶意代码，目的是演示漏洞的存在并提供修复建议。作者也在文章中标明了验证步骤和漏洞修复方式。因此，该仓库中作者隐藏的投毒代码的风险较低，评定为0%。

**利用方式分析：**

1.  **身份验证：** 攻击者首先需要拥有 SOGo Webmail 用户的有效凭据并成功登录。
2.  **导航：** 登录后，攻击者导航至“Preferences → Mail → IMAP Accounts → Edit Identity”设置。
3.  **Payload 注入：** 在“Full Name”字段中，攻击者输入恶意的 XSS payload，例如 `</script><svg onload=alert(1)>`。
4.  **保存设置：** 攻击者保存修改后的设置。
5.  **触发漏洞：** 当其他用户或攻击者自己访问“Mail”选项卡时，由于应用未能正确地转义或过滤“Full Name”字段的内容，浏览器将执行注入的 JavaScript 代码，导致 XSS 攻击。

**漏洞缓解措施：**

升级到 SOGo v5.8.0 或更高版本，该版本已修复此漏洞。此外，在输入和输出时对所有用户可控的输入进行适当的清理或转义，以防止 XSS 攻击。

**项目地址:** [AshkanRafiee/CVE-2022-4556](https://github.com/AshkanRafiee/CVE-2022-4556)

**漏洞详情:** [CVE-2022-4556](https://nvd.nist.gov/vuln/detail/CVE-2022-4556)