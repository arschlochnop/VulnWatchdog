## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 跨站脚本漏洞 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户凭据泄露、页面重定向、恶意软件传播等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于OURPHP v7.2.0 版本的 /client/manage/ourphp_out.php 文件中。通过构造包含恶意 JavaScript 代码的 URL，攻击者可以在受害者浏览器中执行任意脚本。

**有效性:**
根据提供的漏洞利用代码和搜索结果（特别是Github仓库和Youtube视频），该POC代码有效，可以直接利用。

**投毒风险:**
提供的POC代码主要包含：
1.  Docker环境搭建脚本，用于快速部署包含漏洞的OURPHP v7.2.0环境。
2.  漏洞利用的payload示例：`</script><script>alert('xss')</script>`
3.  利用URL示例：`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert('xss')</script>`

虽然部署了XAMPP环境，允许上传和执行PHP脚本，但未发现明显的恶意PHP后门代码，投毒风险较低。但是，为了进一步分析，需要审查所有文件，特别是由`wget`命令下载和`unzip`命令解压的文件。 由于漏洞利用代码包含了 Dockerfile 和利用步骤，方便搭建环境验证漏洞，提升了学习和复现效率，恶意投毒的可能性较低。 另外，安装XAMPP本身存在一定风险，如果XAMPP配置不当，可能引入其他安全问题。

**利用方式:**
该漏洞是反射型XSS，利用方式如下：
1.  攻击者构造包含恶意 JavaScript 代码的 URL，该URL中`ourphp_admin`参数设置为`logout`，`out` 参数包含 XSS payload。
2.  攻击者将该 URL 通过各种方式（例如，电子邮件、社交媒体）发送给受害者。
3.  受害者点击该 URL，恶意 JavaScript 代码将在受害者浏览器中执行。
4.  恶意代码可以窃取用户的 Cookie、重定向到恶意网站、篡改页面内容等。

**风险评估:**
虽然该漏洞的 CVSS 评分为中危，但如果利用成功，可能造成严重危害。建议尽快修复该漏洞。

**项目地址:** [arunsnap/CVE-2023-30212-POC](https://github.com/arunsnap/CVE-2023-30212-POC)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)