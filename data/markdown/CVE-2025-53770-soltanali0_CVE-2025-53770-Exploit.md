## CVE-2025-53770-Microsoft SharePoint Server-远程代码执行

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要身份验证的用户访问SharePoint服务器，并能够发送POST请求到/ToolPane.aspx

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以通过向 `/layouts/15/ToolPane.aspx` 发送包含恶意序列化 .NET 对象的特制 POST 请求来利用此漏洞。PoC 代码通过构造一个包含 `Scorecard:ExcelDataSet` WebPart 的恶意 XML 负载来实现。`CompressedDataTable` 属性包含一个 GZIP 压缩的序列化 .NET DataSet 对象，该对象利用 gadget chain（例如 `LosFormatter` 和 `ObjectDataProvider`）来执行任意代码。由于PoC 代码主要利用已知的反序列化技术和 gadget chain，因此投毒风险较低，主要风险在于部署环境的配置错误和疏忽。PoC 中 C2 地址参数的设置可能存在风险，但整体上，PoC 的恶意程度较低。投毒风险评估为 5%。漏洞利用步骤如下：

1.  攻击者需要具有经过身份验证的用户权限。
2.  攻击者构造一个包含恶意 `Scorecard:ExcelDataSet` WebPart 的 XML 负载，其中 `CompressedDataTable` 属性包含恶意的序列化 .NET 对象。
3.  攻击者将此负载通过 POST 请求发送到 `/layouts/15/ToolPane.aspx?DisplayMode=Edit`。
4.  SharePoint Server 反序列化该对象，导致执行攻击者指定的任意代码。

**项目地址:** [soltanali0/CVE-2025-53770-Exploit](https://github.com/soltanali0/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)