## CVE-2025-4601 - WordPress RealHomes Theme 权限提升

**漏洞编号:** CVE-2025-4601

**漏洞类型:** 权限提升

**影响应用:** WordPress RealHomes Theme

**危害等级:** 高危，可导致管理员权限被获取，网站完全控制

**影响版本:** <= 4.4.0

**利用条件:** 需要目标网站安装 RealHomes Theme 且版本小于等于4.4.0, 需具备 subscriber 或更高权限的账号。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WordPress RealHomes Theme 中，允许低权限用户（如订阅者）提升为管理员权限。漏洞位于`inspiry_update_profile`函数，由于其未正确限制用户可以更新的角色。攻击者可以通过构造包含 `realhomes_user_role` 参数的 POST 请求到 `admin-ajax.php` 端点，将其值设置为 `administrator`，从而提升权限。

**有效性评估：**

根据漏洞信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞是权限提升，影响 RealHomes Theme 4.4.0 及更早版本。搜索引擎结果也确认了该漏洞的存在以及其高危性。漏洞利用代码提供了一个清晰的PoC，展示了如何利用此漏洞将低权限用户提升为管理员。

**投毒风险评估：**

该仓库中的投毒风险较低。虽然存在一定风险，因为任何代码都可能被修改，但该 PoC 相对简单，主要功能是构造一个 POST 请求来修改用户角色。经过分析，PoC 主要功能与漏洞描述一致，没有发现明显的恶意代码。风险评估为10%的原因在于需要人工审核代码，确保没有隐藏的恶意行为，例如：

*   **隐蔽的后门：** 检查是否存在在成功提权后植入后门的逻辑。
*   **数据窃取：** 检查是否存在未经授权的数据收集或传输。
*   **远程代码执行：** 检查是否存在允许攻击者执行任意代码的漏洞利用。

**利用方式：**

1.  **登录目标网站：** 使用订阅者或其他低权限账户登录存在漏洞的 WordPress 网站。
2.  **构造 POST 请求：** 使用 PoC 中提供的 HTTP 请求模板，构造一个包含 `realhomes_user_role` 参数的 POST 请求，将其值设置为 `administrator`，并发送到 `/wp-admin/admin-ajax.php`。
3.  **发送请求：** 通过工具（如 curl、Burp Suite 等）发送构造好的 POST 请求。
4.  **验证结果：** 检查响应，如果成功，则访问 `/wp-admin/` 页面，确认是否已获得管理员权限。

总体来说，该漏洞利用方式简单有效，风险较高，应尽快修复。

**项目地址:** [Yucaerin/CVE-2025-4601](https://github.com/Yucaerin/CVE-2025-4601)

**漏洞详情:** [CVE-2025-4601](https://nvd.nist.gov/vuln/detail/CVE-2025-4601)