## CVE-2021-26855 Microsoft Exchange Server SSRF 漏洞

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 需要能够访问存在漏洞的 Exchange Server 的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求来利用此漏洞，从而冒充管理员身份。该漏洞是 ProxyLogon 攻击链的一部分，与 CVE-2021-27065 (身份验证后任意文件写入漏洞) 结合使用，可以实现远程代码执行。

**漏洞利用方式：**

1.  攻击者利用 CVE-2021-26855，发送特制的 HTTP 请求到 Exchange Server，绕过身份验证并获得管理员权限。
2.  利用获得的管理员权限，攻击者可以进一步利用 CVE-2021-27065 将恶意代码写入服务器。
3.  执行写入的恶意代码，最终实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码 `proxylogscan` 是一个 Go 语言编写的工具，用于大规模扫描存在 CVE-2021-26855 漏洞的 Microsoft Exchange Server。它通过发送特定的 HTTP 请求来检测目标服务器是否存在漏洞。

**投毒风险分析：**

代码主要功能是扫描漏洞，用于检测目标是否存在漏洞。 考虑到工具的用途和代码的简洁性，投毒的可能性较低，但是需要对代码进行仔细的审查，特别是涉及网络请求的部分，以确保没有隐藏的恶意逻辑。 投毒的可能性较低，但是依然存在一定的风险。代码使用go get安装，存在一定的依赖风险,需要注意.


**项目地址:** [dwisiswant0/proxylogscan](https://github.com/dwisiswant0/proxylogscan)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)