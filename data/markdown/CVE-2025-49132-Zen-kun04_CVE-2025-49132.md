## CVE-2025-49132-Pterodactyl Panel-未授权远程代码执行

**漏洞编号:** CVE-2025-49132

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Pterodactyl Panel

**危害等级:** 高危，可能导致服务器完全控制、数据泄露和恶意代码执行

**影响版本:** < 1.11.11

**利用条件:** 目标 Pterodactyl Panel 版本低于 1.11.11，且无需身份验证即可访问 `/locales/locale.json` 接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49132 漏洞允许未经身份验证的攻击者通过 `locales/locale.json` 接口，利用 `locale` 和 `namespace` 参数读取任意PHP文件，从而导致远程代码执行。攻击者可以读取包含敏感信息的配置文件（例如数据库凭据）。提供的 PoC 代码通过构造恶意请求，尝试读取 `config/database.php` 文件，并提取数据库连接信息。成功利用此漏洞后，攻击者可以获得数据库访问权限，并进一步提升权限，甚至完全控制服务器。虽然PoC看起来较为直接，但仍存在一些小的投毒风险，例如改变请求头，使其在特定环境下才触发，或者包含一些看似无害但实则具有隐蔽功能的代码，此风险较低。

**利用方式:**

1.  **发送恶意请求:** 攻击者向目标 Pterodactyl Panel 的 `/locales/locale.json` 接口发送 GET 请求，并在请求中包含 `locale` 和 `namespace` 参数。`locale` 参数用于指定要读取的文件路径，`namespace` 参数用于指定文件的命名空间。
2.  **读取敏感信息:** 攻击者通过构造恶意的 `locale` 和 `namespace` 参数，可以读取 Pterodactyl Panel 的配置文件，例如 `config/database.php`。这些配置文件通常包含数据库连接信息，例如数据库主机、端口、用户名和密码。
3.  **控制服务器:** 攻击者在获得数据库连接信息后，可以使用这些信息连接到数据库，并执行任意 SQL 查询。攻击者还可以利用获得的数据库权限，创建新的管理员用户，或者修改现有用户的权限。最终导致服务器被完全控制。

**缓解措施:**

1.  **升级到最新版本:** 将 Pterodactyl Panel 升级到 1.11.11 或更高版本，该版本已修复此漏洞。
2.  **使用 WAF:** 使用 Web 应用防火墙 (WAF) 来阻止恶意请求。
3.  **限制文件访问权限:** 限制 Pterodactyl Panel 配置文件 (例如 `config/database.php`) 的访问权限，只允许授权用户访问。

**项目地址:** [Zen-kun04/CVE-2025-49132](https://github.com/Zen-kun04/CVE-2025-49132)

**漏洞详情:** [CVE-2025-49132](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)