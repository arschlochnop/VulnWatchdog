## CVE-2025-25705 - ProApps Enterprise Appliance 远程代码执行

**漏洞编号:** CVE-2025-25705

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ProApps - Enterprise Appliance

**危害等级:** 高危，可能导致完全系统接管、数据泄露、横向移动、恶意软件部署以及声誉和财务损失

**影响版本:** 未知，根据利用代码显示Product Vendor: freebsdbrasil, PHP Version 7.3.18, Jquery UI 1.6 | Jquery 1.2.6, Server: NGINX, Operational System: FreeBDS Unix

**利用条件:** 需要身份验证，用户必须属于“Status”权限组并具有“Modified”权限；需要绕过前端输入验证，例如通过网络代理发送请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 ProApps Enterprise Appliance 的 `sta_rede.diagnostico_ping` 页面，允许经过身份验证的攻击者通过在 `host` 参数中注入操作系统命令来执行任意代码。应用程序使用 `ping` 命令，攻击者可以通过在 `host` 参数中添加命令分隔符（如 `;`, `&&`, 或 `|`）来注入额外的命令。利用步骤如下：

1.  **身份验证：** 首先需要通过身份验证，且用户需要拥有相应的权限（属于'Status'权限组且具有'Modified'权限）。
2.  **访问页面：** 访问 `sta_rede.diagnostico_ping` 页面 (http(s)://vulnerablepage.index.php?page=sta_rede.diagnostico_ping&task=view)。
3.  **构造恶意请求：** 使用网络代理绕过前端验证，构造包含恶意命令的 POST 请求，将命令注入到 `host` 参数中。
4.  **发送请求：** 将构造的 POST 请求发送到服务器。
5.  **执行命令：** 服务器执行 `ping` 命令以及注入的恶意命令。

**投毒风险分析：**

虽然提供的利用代码本身看起来是直接利用，但存在一定投毒风险。例如，`Reverse Shell POC` 中使用的 `maliciousfile.sh` 的内容是通过 `curl` 从攻击者服务器下载的。如果攻击者的服务器被攻陷，或者恶意文件被替换，那么下载的 `maliciousfile.sh` 文件可能包含额外的恶意代码，从而实现投毒。因此，不能完全排除投毒的可能性。这里评估为 10% 是考虑到需要远程下载脚本，脚本内容可控。

**搜索引擎结果关联性分析：**

搜索引擎结果中，没有直接关联 CVE-2025-25705 的信息。但是，提供的信息表明可能与其他漏洞信息混淆，真实性待验证。漏洞代码中显示 freebsdbrasil 厂商的 ProApps 产品， 但是搜索结果中并没有直接关于此产品或者厂商的漏洞信息，需要进一步验证。

**总结：**

提供的 POC 代码显示该漏洞利用方式简单直接，但实际环境中，绕过输入验证可能需要更多技巧。代码中reverse shell的后门代码也增加了被投毒的可能性。

**项目地址:** [Cotherm/CVE-2025-25705](https://github.com/Cotherm/CVE-2025-25705)

**漏洞详情:** [CVE-2025-25705](https://nvd.nist.gov/vuln/detail/CVE-2025-25705)