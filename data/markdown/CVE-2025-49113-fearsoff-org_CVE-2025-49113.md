## CVE-2025-49113-Roundcube-PHP对象反序列化RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP 对象反序列化导致远程代码执行

**影响应用:** Roundcube Webmail

**危害等级:** 严重，未经授权的远程代码执行

**影响版本:** <= 1.6.10 和 1.6.x < 1.6.11

**利用条件:** 需要已认证的用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113 存在于 Roundcube Webmail 1.5.10 之前版本和 1.6.x 版本小于 1.6.11 中。这是一个经过身份验证的远程代码执行漏洞，由于 program/actions/settings/upload.php 中 URL 的 _from 参数未经过验证，导致 PHP 对象反序列化。

**有效性评估：**

根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码（README.md 和 rc_install.sh），该漏洞的POC代码具有有效性。README.md 提供了利用步骤和参考链接。搜索引擎结果也证实了漏洞的存在以及其严重性。

**投毒风险评估：**

尽管提供的rc_install.sh脚本用于快速搭建一个存在漏洞的Roundcube环境，方便POC的验证。但代码中存在一些潜在的风险点：

1.  **不安全的默认配置：** 脚本设置了MariaDB的默认用户和密码 (roundcube@localhost identified by 'fearsoff.org')。如果在生产环境中直接使用，会导致数据库安全风险。
2.  **强制更新和安装：** 脚本通过`apt install -yq --no-install-recommends`强制安装多个组件，可能会导致一些不必要的依赖或者冲突。
3. **域名劫持风险:** rc_install.sh通过修改/etc/hosts文件, 将`roundcube.local` 域名指向本地,存在一定的域名劫持风险.

尽管存在上述风险，但没有发现明显的恶意代码或者后门。因此，投毒风险评估为10%，主要来自于不安全的默认配置。

**利用方式分析：**

1.  **身份验证：** 攻击者首先需要获得一个有效的 Roundcube 用户帐户。
2.  **构造恶意请求：** 攻击者构造包含恶意序列化 PHP 对象的 URL，并将该对象作为 `_from` 参数的值传递给 program/actions/settings/upload.php。
3.  **触发反序列化：** Roundcube 在处理 `upload.php` 时，由于未对 `_from` 参数进行充分验证，会触发 PHP 对象反序列化。
4.  **远程代码执行：** 恶意的序列化对象在反序列化过程中执行任意 PHP 代码，导致远程代码执行。

简单的说，该漏洞利用方式是通过向存在漏洞的Roundcube服务器发送含有恶意序列化对象的请求，从而达到远程代码执行的目的。

**项目地址:** [fearsoff-org/CVE-2025-49113](https://github.com/fearsoff-org/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)