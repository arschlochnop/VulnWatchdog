## CVE-2022-1388 F5 BIG-IP iControl REST 认证绕过远程代码执行

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 受影响版本：16.1.x (低于 16.1.2.2), 15.1.x (低于 15.1.5.1), 14.1.x (低于 14.1.4.6), 13.1.x (低于 13.1.5), 12.1.x (所有版本), 11.6.x (所有版本)

**利用条件:** 目标系统存在漏洞版本的F5 BIG-IP，攻击者可以访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-1388 是一个 F5 BIG-IP iControl REST API 的认证绕过漏洞，攻击者可以通过构造特定的 HTTP 请求头来绕过身份验证，从而执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响多个版本的 F5 BIG-IP 设备，包括 16.1.x、15.1.x、14.1.x、13.1.x、12.1.x 和 11.6.x。CISA 已将该漏洞列入已知被利用的漏洞目录中，表明该漏洞已被广泛利用。

**有效性：**

提供的 POC 代码有效。它利用了 iControl REST API 的认证绕过漏洞。通过设置特定的 HTTP 头，例如 `Host`、`Authorization`、`X-F5-Auth-Token` 和 `Connection`，可以绕过身份验证并执行命令。 `Authorization` 字段中的 base64 编码值可以是任意值，不需要是有效的凭据。

**投毒风险：**

提供的 POC 代码主要用于验证漏洞是否存在以及执行任意命令。该代码本身没有发现明显的恶意行为，如植入后门或恶意软件。但是，使用该 POC 可能会带来以下风险：

*   **滥用：**未经授权的使用可能会对目标系统造成损害。
*   **信息泄露：** 执行命令可能会导致敏感信息泄露。
*   **权限提升：** 攻击者可以利用该漏洞获取系统管理员权限。

尽管代码本身看起来没有被投毒，但使用者可能会修改代码以包含恶意功能。考虑到这种可能性，投毒风险评估为 10%。主要风险在于使用者在使用过程中引入恶意代码，而不是代码本身预先存在恶意代码。

**利用方式：**

1.  **构造 HTTP 请求：** 使用 cURL 或其他 HTTP 客户端，构造包含特定 HTTP 头的请求。这些头包括：
    *   `Host: 127.0.0.1`
    *   `Authorization: Basic YWRtaW46YWRtaW4=` (base64 编码的用户名和密码，可以是任意值)
    *   `X-F5-Auth-Token: asdf`
    *   `Connection: X-F5-Auth-Token`
    *   `Content-Type: application/json`
2.  **指定要执行的命令：** 在请求正文中，使用 JSON 格式指定要执行的命令。例如，要执行 `id` 命令，可以使用以下 JSON：
    ```json
    {
        "command":"run",
        "utilCmdArgs":"-c id"
    }
    ```
3.  **发送请求：** 将构造的 HTTP 请求发送到目标 F5 BIG-IP 设备的 iControl REST API 端点 `/mgmt/tm/util/bash`。
4.  **执行任意命令：** 成功利用该漏洞后，攻击者可以执行任意命令，例如读取文件、写入文件、启动/停止服务等。这使得攻击者可以完全控制受影响的系统。

**项目地址:** [forktheplanet/CVE-2022-1388](https://github.com/forktheplanet/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)