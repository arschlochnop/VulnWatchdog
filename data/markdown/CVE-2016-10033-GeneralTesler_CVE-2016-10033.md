## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标网站使用了存在漏洞的PHPMailer版本，且允许用户修改Sender属性（例如通过密码找回功能）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，由于对用户提供的Sender属性过滤不严，攻击者可以通过在Sender属性中注入恶意参数，传递给底层的mail命令，从而执行任意代码。该漏洞的利用方式如下：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式发送邮件时，会将 Sender 属性的值传递给 mail 命令，如果 Sender 属性中包含恶意参数，就可以执行任意命令。
2.  **利用方式：** 攻击者通过构造特殊的 Sender 属性，例如 `" -oQ/tmp -X/tmp/shell.php mail@example.com`，就可以将恶意代码写入到`/tmp/shell.php`文件中。
3.  **POC 分析：** 提供的 Python POC 脚本利用了 WordPress 的密码找回功能，通过修改 HTTP 请求头中的 Host 字段，将包含恶意代码的 Sender 属性注入到 PHPMailer 中。脚本首先在本地启动一个 HTTP 服务器，用于托管恶意 payload，然后通过 WordPress 的密码找回功能触发 PHPMailer 发送邮件，并将 payload 下载到目标服务器，最后执行该 payload，从而获取目标服务器的 shell。
4.  **有效性分析：** 根据漏洞描述和 POC 代码，该漏洞利用的有效性较高，如果目标系统满足漏洞利用条件，攻击者可以成功执行任意代码。
5.  **投毒风险分析：** 仔细检查了提供的 POC 代码和 README 文件，没有发现明显的投毒代码。脚本的功能主要是生成 payload、启动 HTTP 服务器、发送恶意请求以及启动反向 shell 监听器。因此，可以认为该仓库的投毒风险较低，为0%。

**总结：** 该漏洞是一个严重的安全问题，攻击者可以利用该漏洞远程执行任意代码，完全控制目标服务器。建议受影响的用户尽快升级到 PHPMailer 5.2.18 或更高版本，以修复该漏洞。

**项目地址:** [GeneralTesler/CVE-2016-10033](https://github.com/GeneralTesler/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)