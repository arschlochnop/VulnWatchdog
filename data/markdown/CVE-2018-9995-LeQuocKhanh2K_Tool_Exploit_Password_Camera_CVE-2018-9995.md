## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104/DVR4216 及相关品牌 DVR 设备

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** TBK DVR4104 和 DVR4216 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, and MDVR Login 等品牌的 DVR 设备

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-9995 允许远程攻击者通过构造包含 `Cookie: uid=admin` 的 HTTP 请求头绕过认证。提供的 Python 脚本通过发送带有该 Cookie 的 GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而获取设备上的用户名和密码信息。  

**有效性：**

根据漏洞描述和提供的利用代码，可以判断该 POC 代码有效。它利用了设备认证机制的缺陷，允许未经授权的访问。

**投毒风险：**

代码本身的功能是利用漏洞，未发现明显的恶意投毒代码。该脚本的功能相对明确，主要就是发送特定构造的 HTTP 请求并解析返回的 JSON 数据。其中, time.sleep(9000) 作用是休眠9000秒, 疑似隐藏运行，或者程序退出后门代码的可能性, 这里可以忽略.

**利用方式：**

1.  确定目标 DVR 设备的 IP 地址和端口。
2.  运行提供的 Python 脚本，输入目标设备的 IP 地址和端口。
3.  脚本构造带有 `Cookie: uid=admin` 的 HTTP GET 请求，发送到 `/device.rsp?opt=user&cmd=list` 路径。
4.  设备返回包含用户列表信息的 JSON 数据，脚本解析并输出用户名、密码和角色信息。
5.  攻击者可以使用获取的用户名和密码登录 DVR 设备，执行未授权操作。

**项目地址:** [LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995](https://github.com/LeQuocKhanh2K/Tool_Exploit_Password_Camera_CVE-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)