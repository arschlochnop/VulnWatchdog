## CVE-2023-22527 Atlassian Confluence 远程代码执行

**漏洞编号:** CVE-2023-22527

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可实现远程代码执行

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22527 是一个 Atlassian Confluence Server 和 Data Center 中的模板注入漏洞。未经身份验证的攻击者可以通过注入恶意的 OGNL 表达式来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的利用是有效的。漏洞库信息明确指出这是一个远程代码执行漏洞，并给出了受影响的版本范围。搜索结果中也存在多个页面表明该漏洞已被广泛利用。
提供的 Go 语言 PoC 代码通过构造包含恶意 OGNL 表达式的 HTTP POST 请求，发送到`/template/aui/text-inline.vm` 路径，实现命令执行。

**投毒风险：**
提供的代码库包含一个 Go 语言的 PoC、一个 MIT 许可证和一个 README 文件。PoC 代码本身相对简单，主要功能是发送包含 OGNL 表达式的 HTTP 请求。代码结构清晰，没有明显的恶意代码，但仍然存在一定的投毒风险，因为:

1.  **依赖风险:** 该PoC使用了第三方依赖库`github.com/go-resty/resty/v2`，如果该依赖库被篡改，可能引入恶意代码。尽管如此，这并非作者直接投毒。
2.  **命令执行风险:**  PoC 允许执行任意命令，如果攻击者使用该 PoC 执行恶意命令，可能会对目标系统造成损害。但是，这是漏洞本身的风险，而非 PoC 作者投毒。
3.  **网络安全风险:** PoC 代码中默认禁用了 TLS 验证 (`InsecureSkipVerify: true`)。 在生产环境中，这可能会导致中间人攻击。虽然这简化了测试，但也降低了安全性。
4.  **不完善的错误处理:** PoC 代码中虽然有错误处理，但可能不够完善，存在潜在的崩溃或未捕获异常的风险。

综合考虑，该代码库中存在作者直接投毒的可能性较低，主要是因为代码功能简单，且作者明确声明代码仅供学习使用。PoC 的主要风险在于其允许执行任意命令，以及潜在的依赖库风险。投毒风险评估为 10%。

**利用方式：**
1.  确定目标 Confluence Server 或 Data Center 的版本是否在受影响的范围内 (8.0.0 <= version < 8.5.4)。
2.  使用提供的 Go 语言 PoC 代码，指定目标 URL 和要执行的命令。
3.  PoC 代码将构造一个包含恶意 OGNL 表达式的 HTTP POST 请求，发送到`/template/aui/text-inline.vm` 路径。
4.  如果目标存在漏洞，Confluence 将执行 OGNL 表达式中的命令，并将结果添加到响应头 `X-Cmd-Response` 中。
5.  PoC 代码将从响应头中提取命令执行结果并显示。
6. 或者，可以使用 README 文件中提供的 HTTP 请求方法。修改 HTTP 请求中的命令，发送到目标地址。

**项目地址:** [C1ph3rX13/CVE-2023-22527](https://github.com/C1ph3rX13/CVE-2023-22527)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)