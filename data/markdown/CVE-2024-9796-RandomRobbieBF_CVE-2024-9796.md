## CVE-2024-9796-WP-Advanced-Search-SQL注入

**漏洞编号:** CVE-2024-9796

**漏洞类型:** SQL注入

**影响应用:** WP-Advanced-Search

**危害等级:** 高危，可能导致数据泄露和未授权访问

**影响版本:** < 3.3.9.2

**利用条件:** 需要安装存在漏洞版本的WP-Advanced-Search插件的WordPress站点，且允许未经身份验证的HTTP请求访问包含漏洞的`autocompletion-PHP5.5.php`文件。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WP-Advanced-Search插件的 `autocompletion-PHP5.5.php` 文件中，由于对`t`参数未进行充分的过滤和转义，导致未经身份验证的攻击者可以通过构造恶意的SQL语句执行SQL注入攻击。 

**利用方式：**
攻击者可以向 `autocompletion-PHP5.5.php` 发送包含恶意SQL代码的GET请求，利用 `t` 参数执行SQL注入。

**有效性：**
根据提供的POC，攻击者可以使用 `ghauri` 工具，通过构造特定的Payload进行时间盲注攻击，验证漏洞的存在。

**投毒风险：**
提供的漏洞利用代码仓库主要包含漏洞描述信息、下载链接和POC示例，并没有发现直接可疑的投毒代码。虽然存在通过篡改下载链接植入后门插件的可能性，但直接在仓库中添加恶意代码的概率较低。因此，投毒风险较低，但不能完全排除，建议下载插件时校验hash。

虽然提供的POC在URL上，使用了`wpscan-vulnerability-test-bench.ddev.site`这个域名。但是并没有直接证据表明，作者通过验证漏洞，在代码中植入后门，进行漏洞投毒。所以此处不做投毒处理。

**总结：**
此漏洞允许未经身份验证的攻击者执行SQL注入，可能导致数据库信息泄露或其他恶意行为。建议及时更新插件到最新版本。

**项目地址:** [RandomRobbieBF/CVE-2024-9796](https://github.com/RandomRobbieBF/CVE-2024-9796)

**漏洞详情:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)