## CVE-2022-30190-Microsoft MSDT RCE-Follina

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码，控制系统。

**影响版本:** 见漏洞库信息

**利用条件:** 需要用户打开恶意构造的文档或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（Follina）是一个Microsoft Office漏洞，攻击者通过Word等程序调用MSDT，并利用URL协议从远程Web服务器检索HTML文件。该HTML文件包含恶意代码，从而在受害者系统上执行任意命令。漏洞利用涉及诱使用户打开恶意构造的文档（例如，通过电子邮件附件）。

**有效性：**
提供的Python POC代码看起来是有效的，它生成恶意文档或利用方式，并设置一个Web服务器来托管payload。代码包含从用户收集必要信息（如目标IP、端口、文件扩展名等）的部分，并创建所需的文件结构，表明具有利用该漏洞的能力。

**投毒风险：**
代码中可能存在投毒风险。虽然代码的主要功能是生成漏洞利用所需的文件，但攻击者可能在以下方面进行投毒：

*   **Web服务器payload：** 托管在Web服务器上的实际payload可能包含恶意代码，不仅执行预期的命令，还执行其他恶意操作，例如安装后门、窃取敏感信息等。
*   **生成的文档：**  生成的文档本身可能包含超出漏洞利用范围的恶意内容。

因此，存在一定风险，但代码整体结构看似为生成漏洞利用文件，投毒风险较低，预估投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意构造的Word文档（或其他支持的文档类型）。
2.  该文档包含一个链接或引用，指向攻击者控制的Web服务器上的一个HTML文件。
3.  当用户打开该文档时，Word会尝试通过MSDT和URL协议检索该HTML文件。
4.  恶意HTML文件包含执行任意代码的payload。
5.  该payload在受害者系统上执行，从而允许攻击者控制系统。

**项目地址:** [michealadams30/Cve-2022-30190](https://github.com/michealadams30/Cve-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)