## CVE-2011-2523-vsftpd-Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.4 (20110630-20110703)

**利用条件:** 目标系统运行存在漏洞的vsftpd 2.3.4版本，并且是20110630到20110703之间下载的版本。需要网络可达，并且防火墙没有阻止对6200端口的访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2011-2523是vsftpd 2.3.4版本中存在的一个后门漏洞。该后门是在2011年6月30日至2011年7月3日期间下载的版本中被植入的。当用户连接到FTP服务器时，如果用户名包含“:)”，则会在目标的6200端口上打开一个shell。攻击者可以通过Telnet等工具连接到6200端口，从而控制目标系统。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞利用是有效的。提供的漏洞利用代码试图利用此后门。代码首先连接到FTP服务器的21端口，然后发送包含“:)”的用户名，触发后门。然后，它尝试连接到目标主机的6200端口，以获得一个shell。

代码分为两个版本，第一个版本使用telnet，但是存在一些问题使得它不能直接工作，作者提供了修改后的python3代码，使用了socket，更加稳定。

**投毒风险：**

分析POC代码，投毒风险较低。尽管代码经过修改以实现反向shell，但核心逻辑是利用已知的后门漏洞。主要的风险点在于，该代码可能被恶意修改，例如，在shell连接后执行额外的恶意命令，或者将shell重定向到攻击者控制的服务器。考虑到代码的功能明确且修改痕迹可追溯，投毒的概率估计为5%。

**利用方式：**

1.  **目标确认：** 确定目标系统运行的是存在漏洞的vsftpd 2.3.4版本（20110630-20110703）。可以通过nmap等工具扫描目标系统的21端口，并检查FTP服务器的版本信息。
2.  **FTP连接：** 使用提供的Python脚本，指定目标IP地址，脚本将尝试连接到FTP服务器的21端口，并发送包含“:)”的用户名和任意密码。
3.  **后门触发：** 成功发送特制的用户名后，后门将被触发，在目标系统的6200端口上打开一个shell。
4.  **Shell连接：** 脚本将尝试连接到目标系统的6200端口。如果连接成功，攻击者就可以执行任意命令。
5.  **命令执行：** 在shell中，攻击者可以执行系统命令，例如查看文件、修改配置、安装恶意软件等。

**缓解措施：**

*   升级到vsftpd的最新版本。
*   如果不使用FTP服务，禁用或卸载vsftpd。
*   使用防火墙阻止对6200端口的访问。
*   使用入侵检测系统（IDS）监视对6200端口的连接尝试。

**项目地址:** [hklabCR/CVE-2011-2523](https://github.com/hklabCR/CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)