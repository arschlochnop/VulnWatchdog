## CVE-2023-34598-Gibbon-LFI

**漏洞编号:** CVE-2023-34598

**漏洞类型:** LFI

**影响应用:** Gibbon

**危害等级:** 高危，可能导致敏感信息泄露，如数据库凭据、源代码等

**影响版本:** v25.0.0

**利用条件:** 需要网络访问，目标应用为Gibbon v25.0.0 并且存在该漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-34598是Gibbon v25.0.0中的一个本地文件包含(LFI)漏洞。攻击者可以利用此漏洞包含服务器上安装目录中的多个文件内容。根据漏洞利用代码，该漏洞通过访问`/?q=gibbon.sql`触发，如果页面包含“SQL Dump”，则认为目标易受攻击。该脚本会尝试提取SQL转储，提取`-- phpMyAdmin`和`AUTO_INCREMENT=8;`之间的内容，并将其保存到本地文件`gibbon.sql`。脚本使用requests库发送HTTP请求，并忽略SSL证书验证。FOFA查询`icon_hash="-165631681"`可用于查找潜在的易受攻击目标。 

**有效性:** 该POC代码有效，它能够通过LFI漏洞读取`gibbon.sql`文件的内容。

**投毒风险:**  投毒风险较低。代码主要功能是利用LFI读取文件，并没有发现明显的恶意代码或后门。存在的微小风险是，攻击者可能会修改此脚本，例如，在成功利用后向指定服务器发送通知，但目前的脚本本身不具备这种行为。脚本会创建目录并写入文件，这些操作本身就可能被滥用，但不能直接判定为投毒行为。因此评估投毒风险为5%。

**利用方式:**
1.  **目标识别:** 使用FOFA查询或其他方式识别运行Gibbon v25.0.0的潜在目标。
2.  **漏洞验证:** 向目标URL发送包含`?q=gibbon.sql`的GET请求。
3.  **数据提取:** 如果响应包含指示SQL转储的内容（例如，“SQL Dump”），则从响应中提取SQL转储的相关部分。
4.  **本地存储:** 将提取的SQL转储保存到本地文件`gibbon.sql`中以供进一步分析。

**项目地址:** [Zer0F8th/CVE-2023-34598](https://github.com/Zer0F8th/CVE-2023-34598)

**漏洞详情:** [CVE-2023-34598](https://nvd.nist.gov/vuln/detail/CVE-2023-34598)