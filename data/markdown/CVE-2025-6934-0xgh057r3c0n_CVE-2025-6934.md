## CVE-2025-6934 - Opal Estate Pro 未授权提权

**漏洞编号:** CVE-2025-6934

**漏洞类型:** 权限提升

**影响应用:** WordPress Opal Estate Pro Plugin

**危害等级:** 高危，未授权用户可以创建管理员账户，完全控制 WordPress 站点

**影响版本:** <= 1.7.5

**利用条件:** 目标 WordPress 站点安装并启用了 Opal Estate Pro 插件，且版本低于或等于 1.7.5

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6934 是 WordPress Opal Estate Pro 插件中的一个严重漏洞，允许未经身份验证的攻击者通过插件的注册功能创建管理员账户。漏洞存在于 'on_regiser_user' 函数中，该函数在用户注册期间缺乏角色限制，导致攻击者可以任意选择角色，包括管理员角色。 

**利用方式：**

1.  攻击者发送一个特制的 HTTP 请求到 WordPress 站点的注册接口，通常是利用插件提供的 AJAX 端点。
2.  请求中包含攻击者希望创建的管理员账户的用户名、邮箱和密码。
3.  最关键的是，请求中需要包含指定的角色参数，将其设置为 'administrator'。
4.  由于漏洞的存在，插件在处理注册请求时，不会验证用户的身份，直接将新用户创建为管理员。

**有效性：**

根据漏洞库信息、搜索结果（特别是 GitHub 上的 PoC 链接），以及提供的漏洞利用代码，该漏洞是有效的。PoC 代码通过自动检测插件版本、提取注册所需的 nonce 值、并利用存在漏洞的 AJAX 端点，创建新的管理员账户，验证了该漏洞的可利用性。

**投毒风险：**

分析提供的 PoC 代码，其中包含一个 `LICENSE` 文件，明确了项目使用的 MIT 许可证，并声明用于教育和安全研究目的。`README.md` 文件详细描述了漏洞、利用方法、安装步骤和使用示例。代码结构清晰，逻辑简单，主要功能是发送特定的 HTTP 请求来利用漏洞。依赖项 `requests`、`beautifulsoup4` 和 `colorama` 都是常见的 Python 库，分别用于发送 HTTP 请求、解析 HTML 和美化终端输出。  

 综合评估，虽然不能完全排除作者在代码中隐藏恶意代码的可能性，但从代码结构、功能描述、以及声明的用途来看，**投毒的可能性较低，约为 10%**。需要注意的是，任何漏洞利用代码都存在潜在风险，使用前务必进行详细的代码审计和安全评估。

**项目地址:** [0xgh057r3c0n/CVE-2025-6934](https://github.com/0xgh057r3c0n/CVE-2025-6934)

**漏洞详情:** [CVE-2025-6934](https://nvd.nist.gov/vuln/detail/CVE-2025-6934)