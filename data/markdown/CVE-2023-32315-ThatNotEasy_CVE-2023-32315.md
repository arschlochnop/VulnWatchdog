## CVE-2023-32315-Openfire-身份验证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 身份验证绕过/路径遍历

**影响应用:** Openfire

**危害等级:** 高危，可能导致未经授权的访问和潜在的远程代码执行

**影响版本:** 3.10.0 <= version < 4.6.8, 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务运行，目标端口开放，且Openfire版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32315 是一个 Openfire 中的路径遍历漏洞。未经身份验证的攻击者可以通过向 `/setup/setup-s/%u002e%u002e/%u002e%u002e/user-groups.jsp` 发送特制的 HTTP 请求来绕过身份验证，访问受限的管理控制台页面。

**漏洞利用方式：**
1.  攻击者发送包含路径遍历序列（`%u002e%u002e/%u002e%u002e`）的恶意请求到 Openfire 服务器的 `/setup/setup-s/` 路径。
2.  路径遍历序列使得攻击者能够访问 `/user-groups.jsp` 等原本需要身份验证才能访问的管理页面。
3.  POC 代码首先尝试访问目标URL，如果成功获取JSESSIONID和CSRF token，则表明漏洞存在。代码会继续尝试利用该漏洞创建一个新的管理员用户。

**投毒风险评估：**
该 POC 代码主要包含以下功能：

*   发送包含路径遍历的 HTTP 请求。
*   提取服务器返回的 JSESSIONID 和 CSRF token。
*   构造并发送创建管理员用户的请求。

在提供的代码片段中，`generate_rando` 函数未完整定义，可能存在漏洞作者未公开的恶意行为。代码尝试从cookie中获取`JSESSIONID`和`csrf`,如果获取失败就无法继续利用。此外，该脚本依赖于 `HackRequests` 库，攻击者可能会篡改此库来植入恶意代码。虽然代码的主要目的是利用漏洞，但仍然存在一定的投毒风险，例如：

*   **潜在的后门创建：** 除了创建用户之外，攻击者可能添加额外的请求来执行其他恶意操作，例如部署 webshell 或修改系统配置。
*   **恶意库依赖：** `HackRequests` 库可能被替换为包含恶意代码的版本。
*   **信息收集：** 代码可能包含额外的逻辑来收集目标服务器的信息并发送给攻击者。

考虑到上述因素，该 POC 代码的投毒风险评估为 10%。需要人工审计整个代码才能完全确定是否存在恶意行为。

**项目地址:** [ThatNotEasy/CVE-2023-32315](https://github.com/ThatNotEasy/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)