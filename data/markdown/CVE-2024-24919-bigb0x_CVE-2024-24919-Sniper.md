## CVE-2024-24919-CheckPoint-信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能允许攻击者读取Check Point安全网关上的某些信息

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备连接互联网并启用远程访问VPN或移动接入软件刀片

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919 是 Check Point 安全网关中的一个信息泄露漏洞。攻击者可以通过发送特制的 HTTP 请求，利用路径遍历漏洞读取目标系统上的任意文件。根据 Truesec 的报告，攻击者可以访问 Gaia OS 的所有文件（即 expert mode）。

**有效性：**
提供的 Python 脚本 `cve-2024-24919-sniper.py` 实现了该漏洞的扫描和利用。脚本通过构造包含路径遍历的 URL，向目标服务器发送请求，尝试读取指定文件。

**投毒风险：**
代码中存在微小的投毒风险，主要基于以下几点：

1.  **依赖项：** `requirements.txt` 文件可能包含恶意软件包，尽管风险较低，但仍需注意。
2.  **远程路径：** 脚本允许用户指定要读取的远程文件路径。如果攻击者能够控制此路径，可能会利用它来读取敏感信息或执行其他恶意操作。 脚本在获取用户输入作为文件读取路径时,没有做严格过滤。 
3.  **HTTPS 证书验证：** 脚本默认禁用 SSL 证书验证（`requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`），这使得攻击者可能通过中间人攻击截获或篡改数据。尽管这不是直接的投毒，但会增加攻击成功的几率。

考虑到这些因素，我评估投毒风险为 10%。

**利用方式：**
1.  **确定目标：** 攻击者需要确定存在漏洞且启用了相关服务的 Check Point 安全网关。
2.  **构造恶意 URL：** 攻击者构造包含路径遍历的 URL，例如 `https://<target_ip>/clients/MyCRL?aCSHELL/../../../../../../../../../../../etc/passwd`。
3.  **发送请求：** 攻击者使用 HTTP 客户端（如 curl、wget 或 Python 脚本）向目标服务器发送构造的 URL。
4.  **读取文件：** 如果漏洞存在且利用成功，目标服务器将返回指定文件的内容。

**缓解措施：**
*   安装 Check Point 提供的安全补丁。
*   禁用或限制远程访问 VPN 和移动接入软件刀片。
*   配置防火墙规则以阻止来自不受信任来源的流量。

**项目地址:** [bigb0x/CVE-2024-24919-Sniper](https://github.com/bigb0x/CVE-2024-24919-Sniper)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)