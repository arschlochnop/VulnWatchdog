## CVE-2025-20281-Cisco ISE ERS API未授权RCE

**漏洞编号:** CVE-2025-20281

**漏洞类型:** 远程代码执行

**影响应用:** Cisco Identity Services Engine (ISE)

**危害等级:** 高危，未授权远程代码执行，获取root权限

**影响版本:** 3.3.0, 3.3 Patch 1, 3.3 Patch 2, 3.3 Patch 3, 3.3 Patch 4, 3.3 Patch 5, 3.4.0, 3.4 Patch 1

**利用条件:** 需要网络访问ISE的9060端口，且ERS API已启用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-20281是Cisco ISE ERS API中的一个未授权远程代码执行漏洞。攻击者无需任何凭据，通过向`/ers/sdk#_`端点发送特制的API请求，即可在目标系统上以root权限执行任意代码。

**有效性分析：**
根据漏洞描述和提供的PoC代码，该PoC利用了Cisco ISE ERS API中对用户提供输入验证不足的漏洞。PoC通过构造包含恶意命令的`InternalUser`对象，并将其作为JSON数据发送到`/ers/sdk#_`端点，成功实现远程代码执行。

**投毒风险分析：**
PoC代码本身实现了漏洞利用功能，但依旧存在一定的投毒风险。投毒风险点在于：
1.  **依赖库：** PoC依赖requests和urllib3库，如果requests或urllib3安装源被篡改，可能引入恶意代码。
2.  **用户自定义命令：** PoC允许用户自定义要执行的命令。攻击者可能在不知情的情况下执行恶意命令，导致系统受损。
3.  **README.md中的免责声明:** 虽然声明了代码是免费提供的，但是也可能被恶意修改。虽然此代码目前未发现任何投毒代码，但是依然存在风险。
4. **许可证MIT**: 使用MIT协议, 允许修改,复制,分发，所以增加了风险。

综合分析，该PoC存在10%的投毒风险，主要集中在使用依赖库和允许用户自定义命令上。

**利用方式：**
1.  确定目标Cisco ISE服务器的IP地址或主机名。
2.  确保目标服务器的9060端口可访问，并且ERS API已启用。
3.  运行PoC脚本，指定目标IP地址/主机名和要执行的命令。
4.  如果目标存在漏洞，PoC将执行指定的命令并返回结果（或建立反向shell）。

**项目地址:** [ill-deed/Cisco-CVE-2025-20281-illdeed](https://github.com/ill-deed/Cisco-CVE-2025-20281-illdeed)

**漏洞详情:** [CVE-2025-20281](https://nvd.nist.gov/vuln/detail/CVE-2025-20281)