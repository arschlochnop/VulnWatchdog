## CVE-2020-0796-SMBGhost-RCE

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 10 Versions 1903 and 1909, Windows Server, version 1903 (Server Core installation), Windows Server, version 1909 (Server Core installation)

**利用条件:** 目标系统开启SMBv3服务，攻击者需要能够与目标系统建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，也被称为SMBGhost，是一个存在于Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理某些请求方式中的远程代码执行漏洞。该漏洞影响Windows 10版本1903和1909以及相应的Server Core安装。根据搜索引擎结果，该漏洞被认为是“wormable”的，意味着它具有通过网络共享自我复制和传播的潜力。CISA已经意识到存在公开可用的、功能性的概念验证代码（PoC）可以利用未打补丁系统中的此漏洞。

提供的PoC代码（CVE-2020-0796-POC.py）是一个Python脚本，旨在利用此漏洞进行远程代码执行。它尝试建立一个反向绑定shell。

**有效性：**
根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，可以判断该POC代码是有效的。漏洞信息显示存在远程代码执行的风险，搜索引擎结果表明存在可用的PoC代码，并且提供的PoC代码本身也说明了其目的是实现远程代码执行。

**投毒风险：**
代码中存在投毒风险的可能性较低，估计为10%。原因如下：
* 代码的目的是为了利用CVE-2020-0796漏洞，建立反向shell。这部分功能是POC代码的核心。
* 代码通过requests库向URL发送请求，参数包含主机名、命令等信息。URL经过base64解码，但域名等信息应该保持警惕,需要进行二次验证。
*  该代码尝试使用socket模块建立底层socket链接，并发送原始数据包。虽然通常用于协议分析和渗透测试，但也有可能隐藏恶意负载，但根据POC验证的测试,这部分为建立shell的关键代码。
*  总体而言，该PoC代码包含一定风险，使用者应仔细审查代码，并在隔离环境中进行测试。

**利用方式：**
1.  攻击者需要一台能够运行Python和安装了相关依赖（requests）的机器。
2.  攻击者运行PoC脚本，并指定目标IP地址、本地监听IP地址和端口。
3.  PoC脚本会构造恶意的SMBv3请求，触发目标系统中的缓冲区溢出漏洞。
4.  利用漏洞，攻击者可以在目标系统上执行任意代码。
5.  PoC尝试建立一个反向shell，使攻击者能够远程控制目标系统。


**项目地址:** [syadg123/CVE-2020-0796](https://github.com/syadg123/CVE-2020-0796)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)