## CVE-2025-23167-Node.js HTTP Request Smuggling

**漏洞编号:** CVE-2025-23167

**漏洞类型:** HTTP请求走私

**影响应用:** Node.js

**危害等级:** 中危，可能绕过代理访问控制，导致未授权请求

**影响版本:** Node.js 20.x < 20.19.2

**利用条件:** 目标服务器使用Node.js 20.x版本，且位于代理服务器之后。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-23167 是一个影响 Node.js 20.x 版本的 HTTP 请求走私漏洞。由于 Node.js 的 HTTP 解析器允许使用 `\r\n\rX` 替代 `\r\n\r\n` 来终止 HTTP/1 头的解析，攻击者可以利用此漏洞来绕过代理服务器的访问控制，并发送未经授权的请求。

**有效性评估：**
提供的 PoC 代码（`exploit.py`）通过发送一个包含恶意构造的 HTTP 请求，利用不正确的头部终止序列 `\rX`，来尝试进行 HTTP 请求走私。Lab环境 (`lab.js`) 是一个简单的Node.js服务器，目的是模拟一个存在漏洞的环境来测试此PoC。从搜索结果和漏洞描述来看，此PoC的思路与漏洞原理相符，因此PoC**有效**。

**投毒风险评估：**
经过对 `exploit.py` 和 `lab.js` 的代码审查，未发现明显的恶意代码或后门。`exploit.py` 的目的是构造并发送恶意HTTP请求，而 `lab.js` 只是一个用于测试的简单服务器。因此，**投毒风险评估为 0%**。

**利用方式：**
1.  **确定目标：** 找到运行在 Node.js 20.x（低于 20.19.2） 且位于代理服务器后面的目标。
2.  **构造恶意请求：** 使用 `exploit.py` 脚本，指定目标主机和端口，构造包含 `\r\n\rX` 终止符的 HTTP 请求。该请求包含一个伪造的请求头，导致代理服务器和后端服务器对请求边界的理解不一致。
3.  **发送恶意请求：**  `exploit.py` 会将构造的恶意请求发送到目标服务器。
4.  **请求走私：**  由于头部终止符不正确，部分请求会被代理服务器认为是合法的，而部分请求会被走私到后端服务器，从而绕过代理的访问控制，执行攻击者期望的恶意操作（例如，访问受限资源）。
5.  **验证攻击：**  观察服务器的响应，如果返回多个 HTTP 响应，则表示漏洞利用成功。

**项目地址:** [abhisek3122/CVE-2025-23167](https://github.com/abhisek3122/CVE-2025-23167)

**漏洞详情:** [CVE-2025-23167](https://nvd.nist.gov/vuln/detail/CVE-2025-23167)