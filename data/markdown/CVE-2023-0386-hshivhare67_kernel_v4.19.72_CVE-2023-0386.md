## CVE-2023-0386-Linux Kernel-OverlayFS权限提升

**漏洞编号:** CVE-2023-0386

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可利用该漏洞提升权限

**影响版本:** Linux kernel 6.2-rc6以及可能存在的其他版本

**利用条件:** 本地用户需要能够创建和挂载OverlayFS文件系统

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-0386 是一个Linux内核OverlayFS文件系统中的权限提升漏洞。漏洞存在于用户将具有capabilities的setuid文件从 nosuid 挂载复制到另一个挂载中的方式。利用该漏洞，本地用户可以获得系统上的特权。 

**有效性:** 根据搜索结果（尤其是vsociety的文章），该漏洞存在可利用性，并且已经有公开的PoC。

**投毒风险:** 提供的代码片段是Linux内核的COPYING和CREDITS文件，不包含任何可执行代码或恶意逻辑。因此，这些文件本身不构成投毒风险。但不能排除完整的利用代码中可能包含投毒的可能,根据经验判断,投毒风险较低。风险预估：1%。

**利用方式:**
1.  攻击者需要具有创建和挂载OverlayFS文件系统的权限。
2.  攻击者创建一个具有capabilities的setuid文件在一个nosuid挂载点上。
3.  攻击者利用漏洞，将该文件复制到另一个挂载点，导致权限提升。
4.  通过执行复制后的文件，攻击者可以获得root权限。

**项目地址:** [hshivhare67/kernel_v4.19.72_CVE-2023-0386](https://github.com/hshivhare67/kernel_v4.19.72_CVE-2023-0386)

**漏洞详情:** [CVE-2023-0386](https://nvd.nist.gov/vuln/detail/CVE-2023-0386)