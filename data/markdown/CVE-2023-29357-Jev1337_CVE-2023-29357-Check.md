## CVE-2023-29357 - Microsoft SharePoint Server 权限提升漏洞

**漏洞编号:** CVE-2023-29357

**漏洞类型:** 权限提升

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** 16.0.0 <= version < 16.0.10399.20005

**利用条件:** 需要目标SharePoint服务器URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29357 是一个 Microsoft SharePoint Server 中的权限提升漏洞。攻击者可以通过伪造 JWT 令牌来绕过身份验证，从而获取更高的权限。根据搜索引擎结果和漏洞利用代码，该漏洞已被积极利用。漏洞利用代码提供了一个简单的脚本来检测目标是否容易受到攻击，它首先获取目标的Realm，然后创建一个伪造的 JWT 令牌，并使用该令牌来请求用户信息。如果请求成功，则表明目标易受攻击。

**有效性：**
提供的POC代码的有效性较高，因为它利用了未经身份验证的访问漏洞，允许攻击者模拟经过身份验证的用户。多个搜索结果表明该漏洞已被积极利用，并且存在公开可用的PoC。

**投毒风险：**
该POC代码主要用于检测漏洞是否存在。代码本身相对简单，主要功能是生成 JWT 令牌并发送请求。潜在的投毒风险较低，大约10%。但仍然存在一些细微的风险：

1.  **依赖项风险：** 虽然代码只依赖requests模块，但任何依赖项都可能被投毒。用户需要确认requests库的来源可靠。
2.  **结果误判：**  脚本的结果可能存在误判，导致用户对系统的安全性产生错误的认知。
3.  **滥用风险：**  即使脚本本身没有恶意代码，也可能被用于未经授权的渗透测试。

**利用方式：**
1.  **确定目标SharePoint服务器的URL。**
2.  **使用脚本获取目标服务器的Realm。**
3.  **脚本会创建一个伪造的 JWT 令牌。**
4.  **使用伪造的 JWT 令牌向 SharePoint 服务器发送请求，例如获取用户信息。**
5.  **如果请求成功，则攻击者可以利用该漏洞执行未经授权的操作。**

**项目地址:** [Jev1337/CVE-2023-29357-Check](https://github.com/Jev1337/CVE-2023-29357-Check)

**漏洞详情:** [CVE-2023-29357](https://nvd.nist.gov/vuln/detail/CVE-2023-29357)