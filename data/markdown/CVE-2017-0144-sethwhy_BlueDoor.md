## CVE-2017-0144 (EternalBlue)

**漏洞编号:** CVE-2017-0144

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可导致系统完全控制

**影响版本:** Windows Vista SP2; Windows Server 2008 SP2 and R2 SP1; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; and Windows 10 Gold, 1511, and 1607; Windows Server 2016

**利用条件:** 目标系统启用SMBv1，且攻击者与目标系统网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0144，也被称为EternalBlue，是一个存在于Microsoft Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过发送特制的报文利用此漏洞在目标系统上执行任意代码，无需身份验证。漏洞利用通常涉及使用Metasploit等工具生成恶意payload，然后通过SMB协议发送到目标系统。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实且高危的，存在可用的Exploit-DB条目（如42031, 42030, 41891, 41987）。搜索结果也表明该漏洞被广泛讨论，并存在多种利用方式和工具。

**投毒风险：**
提供的POC代码是一个CTF挑战赛的说明文档，包含环境搭建，扫描，利用步骤。其主要内容包括：

*   虚拟机镜像下载链接
*   网络配置说明
*   使用Nmap进行漏洞扫描的指令
*   使用Metasploit或Python脚本进行漏洞利用的说明
*   挑战的重置方法

从代码本身来看，其主要目的是为了引导用户完成CTF挑战，但存在以下潜在的投毒风险：

1.  **OVA文件来源不明：** 指向Google Drive的链接，如果恶意攻击者替换或篡改了OVA文件，可能导致用户下载包含恶意软件的虚拟机镜像。
2.  **Metasploit Payloads：** 指示用户使用`msfvenom`生成payload。如果用户不了解Metasploit，可能会错误地配置payload，导致自身系统受到威胁。
3.  **依赖外部链接：** CTF提交站点如果被攻破，用户提交的信息可能泄露。

因此，尽管代码的主要意图是提供CTF指导，但由于依赖外部资源和用户操作，仍然存在一定的投毒风险，约10%。

**利用方式：**

1.  **扫描：** 使用`nmap`扫描目标系统，确认是否开启了SMBv1服务，以及是否存在MS17-010漏洞。
2.  **Payload生成：** 使用`msfvenom`等工具生成反向shell的payload。
3.  **漏洞利用：** 使用Metasploit的`exploit/windows/smb/ms17_010_eternalblue`模块，或Python脚本利用该漏洞，将payload发送到目标系统。
4.  **权限提升：** 成功利用漏洞后，可能需要进行权限提升操作，以获取管理员权限。
5.  **Flag获取：** 在提升权限后，查找并读取`C:\Windows\System32`目录下的flag.txt文件。

**项目地址:** [sethwhy/BlueDoor](https://github.com/sethwhy/BlueDoor)

**漏洞详情:** [CVE-2017-0144](https://nvd.nist.gov/vuln/detail/CVE-2017-0144)