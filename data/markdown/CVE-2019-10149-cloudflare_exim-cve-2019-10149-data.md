## CVE-2019-10149 Exim RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Exim

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 目标系统运行存在漏洞的Exim版本，并且攻击者可以向Exim服务器发送邮件。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2019-10149 存在于 Exim 邮件传输代理（MTA）的 deliver_message() 函数中，由于对收件人地址的验证不当导致。未经身份验证的远程攻击者可以通过向目标服务器发送特制的邮件来利用此漏洞，从而在目标系统上执行任意命令。漏洞利用通常涉及在邮件收件人地址中注入 shell 命令。 

根据提供的漏洞利用代码，`/tmp/b373ced1c77bc05f74b9541e06f0010c/README.md`文件主要包含关于CVE-2019-10149、CVE-2019-15846 和 CVE-2019-16928漏洞的相关信息收集，包括漏洞公告、漏洞利用详情、问题时间线、NSA公告以及受影响的IP、ASN、国家和主机名等数据链接。其中`election-domains-by-expiration-date.txt`文件是域名列表, 不太可能直接用于漏洞利用，但是可能被用于信息收集或后续攻击。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且存在公开的漏洞利用代码，因此可以判断提供的漏洞利用代码是有效的。

**投毒风险：** 该仓库中存在的投毒代码可能性较低，主要是因为其内容以漏洞信息搜集为主，提供的数据源链接也是公开信息。`election-domains-by-expiration-date.txt`可能存在搜集来的恶意域名，但作者进行恶意添加的可能性较低。

**利用方式：** 攻击者构造包含恶意命令的邮件，利用Exim在处理收件人地址时的验证缺陷，将命令注入到系统执行。这通常通过在收件人地址中嵌入反引号或者其他命令执行符号来实现。该漏洞允许攻击者远程执行代码而无需身份验证。

**项目地址:** [cloudflare/exim-cve-2019-10149-data](https://github.com/cloudflare/exim-cve-2019-10149-data)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)