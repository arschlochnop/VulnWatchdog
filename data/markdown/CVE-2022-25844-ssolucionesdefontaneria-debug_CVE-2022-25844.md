## CVE-2022-25844 - angular Regular Expression Denial of Service (ReDoS)

**漏洞编号:** CVE-2022-25844

**漏洞类型:** ReDoS

**影响应用:** angular

**危害等级:** 中危，可能导致服务拒绝

**影响版本:** 1.7.0及以上

**利用条件:** 需要能够控制或影响angular应用中使用的locale规则

**POC 可用性:** 是（存在FastJSON模拟利用的PoC，但漏洞本身与Angular有关）

**投毒风险:** 30%

## 详情

CVE-2022-25844 是 Angular 中的一个 ReDoS 漏洞。该漏洞存在于1.7.0及以上版本中。攻击者可以通过提供恶意的locale规则，具体来说，通过设置NUMBER_FORMATS.PATTERNS[1].posPre为一个包含大量重复空格的字符串，导致正则表达式引擎消耗大量资源，从而导致拒绝服务。

虽然提供的漏洞利用代码主要针对FastJSON漏洞的模拟，与Angular ReDoS漏洞本身没有直接关系，但可以作为理解ReDoS漏洞利用思路的参考。该代码包含一个漏洞生成器，它会生成各种JSON payload，模拟各种攻击场景，包括类型处理、RCE模拟、嵌套对象利用和数组利用。 这些负载旨在演示如何利用FastJSON中存在的反序列化漏洞。此 PoC 的主要用途似乎是教育和安全测试目的，而不是直接用于攻击 angular 组件。PoC代码中未发现明显的恶意代码，但代码中存在利用subprocess.Popen执行命令的PAYLOAD，虽然有警告，但仍可能被用于恶意目的。

利用方式：
1. 构造包含大量重复空格的恶意的locale规则。
2. 将恶意的locale规则提供给Angular应用。
3. Angular应用使用恶意的locale规则进行处理，导致正则表达式引擎消耗大量资源，从而导致拒绝服务。

关于投毒风险：
虽然代码库的主要目的是演示漏洞，但`exploit_generator.py`中`generate_python_specific_payloads`函数包含一个 YAML 反序列化 payload，该 payload 执行 `echo 'YAML RCE Simulation'` 命令。虽然这个命令本身是无害的，但它表明代码能够执行任意命令，可能被利用于注入恶意代码。此外，rce_simulation payload 中含有执行计算器的命令，也存在风险。因此存在一定投毒风险，但主要集中在演示目的命令执行payload中。代码库中也引入了 colorama 库，这个库的安全性也需要进一步评估，但目前没有发现直接证据表明存在投毒。 总的来说，投毒风险评估在30% 左右。

**项目地址:** [ssolucionesdefontaneria-debug/CVE-2022-25844](https://github.com/ssolucionesdefontaneria-debug/CVE-2022-25844)

**漏洞详情:** [CVE-2022-25844](https://nvd.nist.gov/vuln/detail/CVE-2022-25844)