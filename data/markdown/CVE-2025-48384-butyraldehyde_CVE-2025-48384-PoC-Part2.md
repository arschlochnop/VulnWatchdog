## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户执行递归克隆包含恶意.gitmodules文件的不受信任的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384是Git中的一个高危漏洞，允许攻击者通过构造恶意的.gitmodules文件和post-checkout钩子执行任意代码。该漏洞源于Git在处理带有回车符的配置值时存在差异，导致 submodule 被检出到错误的位置。如果攻击者在 submodule hooks 目录中放置一个符号链接，指向一个包含可执行的 post-checkout 钩子的子模块，那么在检出后可能会意外执行该脚本。

**有效性：**

提供的POC代码是一个简单的 post-checkout 钩子，它会在 `/tmp/exploited` 目录下创建一个文件。如果目标系统存在此漏洞并且成功利用，那么这个文件将被创建，表明漏洞利用成功。因此，该POC代码对于验证漏洞的存在是有效的。

**投毒风险：**

提供的POC代码本身非常简单，只是创建了一个文件。没有迹象表明代码中存在隐藏的恶意功能，因此投毒风险为0%。但是，这并不意味着包含此POC的仓库没有投毒风险。攻击者可能会在仓库的其他部分添加恶意代码，或者修改其他钩子来执行恶意操作。

**利用方式：**

漏洞利用方式如下：

1.  攻击者创建一个包含恶意.gitmodules文件的Git仓库。该文件包含带有尾随回车符的submodule路径。
2.  攻击者在submodule hooks目录中创建一个符号链接，将更改后的路径指向包含恶意 post-checkout 钩子的子模块。
3.  攻击者诱使用户递归克隆该仓库 (`git clone --recursive <repository_url>`)。
4.  当 Git 初始化 submodule 时，由于回车符处理不一致，submodule 会被检出到错误的位置。
5.  由于符号链接的存在，恶意的 post-checkout 钩子会被执行，导致任意代码执行。

总而言之，这是一个客户端漏洞，需要用户执行特定的操作才能被利用。攻击者需要诱使用户克隆包含恶意配置的仓库，并且用户需要使用受影响的 Git 版本。

**项目地址:** [butyraldehyde/CVE-2025-48384-PoC-Part2](https://github.com/butyraldehyde/CVE-2025-48384-PoC-Part2)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)