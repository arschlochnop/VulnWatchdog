## CVE-2018-10001

**漏洞编号:** CVE-2018-10001

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** FFmpeg

**危害等级:** 中危，可能导致程序崩溃

**影响版本:** <= 3.4.2

**利用条件:** 需要解析特制的AVI文件

**POC 可用性:** 否 (针对CVE-2018-10001，提供的POC是针对另一个漏洞CVE-2018-1000199)

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2018-10001 存在于 FFmpeg 3.4.2 及更早版本中，libavcodec/utvideodec.c 文件的 decode_init 函数存在缺陷。攻击者可以通过提供特制的 AVI 文件，触发数组越界读取，导致拒绝服务。

提供的漏洞利用代码（PoC.c）和 README.md 实际上是关于另一个漏洞 CVE-2018-1000199，该漏洞与 Linux kernel 的 ptrace 系统调用有关，允许攻击者通过设置特定的调试寄存器来影响内核行为。这个PoC和FFmpeg的CVE-2018-10001漏洞无关。代码用于设置调试寄存器DR0和DR7，然后触发中断。通过向 DR0 写入非法值，可能导致内核的断点跟踪状态损坏。

根据代码分析，PoC.c 中没有发现明显的恶意投毒代码。该代码主要功能是利用 ptrace 系统调用来设置调试寄存器，虽然可以用来攻击内核漏洞，但代码本身是用于演示和验证漏洞的，并没有额外的恶意行为。

由于提供的PoC与CVE-2018-10001不对应，因此无法直接利用该PoC复现CVE-2018-10001。针对CVE-2018-10001的利用方式是构造恶意的AVI文件，诱使FFmpeg解析，从而触发漏洞。此PoC仅能验证CVE-2018-1000199。

**项目地址:** [dsfau/CVE-2018-1000199](https://github.com/dsfau/CVE-2018-1000199)

**漏洞详情:** [CVE-2018-10001](https://nvd.nist.gov/vuln/detail/CVE-2018-10001)