## CVE-2025-31324 - SAP NetWeaver Visual Composer 未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统运行受影响版本的SAP NetWeaver Visual Composer，并且developmentserver/metadatauploader接口对外开放。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-31324 漏洞存在于 SAP NetWeaver Visual Composer 的 Metadata Uploader 组件中。由于缺乏适当的身份验证，未经授权的攻击者可以上传恶意文件到服务器，最终导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码是一个 Python 脚本，用于上传一个 JSP webshell。如果目标系统存在漏洞并且可以访问，POC 代码应该能够成功利用。

**投毒风险：**
提供的 POC 代码主要功能是上传和删除 webshell。代码中包含一个 webshell 的内容，以及上传和删除的逻辑。没有发现其他恶意行为或隐藏代码，因此投毒风险评估为 0%。

**利用方式：**
1.  攻击者构造一个包含恶意代码的 JSP webshell 文件（例如，通过 `request.getParameter("cmd")` 执行系统命令）。
2.  攻击者使用 POC 脚本向 `http://{domain}/developmentserver/metadatauploader?CONTENTTYPE=MODEL&CLIENT=1` 发送 POST 请求，上传 webshell 文件。
3.  由于缺少身份验证，服务器允许上传该文件。
4.  攻击者通过访问上传的 webshell，并传递 `pass` 和 `cmd` 参数来执行任意系统命令（例如，`http://{domain}/irj/{WEBSHELL}?pass={PASS}&cmd=whoami`）。
5.  POC 脚本提供了一个简单的交互式 shell，允许攻击者在目标系统上执行命令。

**项目地址:** [Pengrey/CVE-2025-31324](https://github.com/Pengrey/CVE-2025-31324)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)