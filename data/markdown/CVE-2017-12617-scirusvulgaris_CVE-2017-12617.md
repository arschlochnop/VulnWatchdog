## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要Tomcat开启HTTP PUT方法（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞存在于 Apache Tomcat 中，当配置允许使用 HTTP PUT 方法上传文件时，攻击者可以通过构造特殊的请求上传包含恶意代码的 JSP 文件，然后通过访问该文件来执行任意代码，从而完全控制服务器。

**有效性分析：**
根据漏洞描述和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息、搜索引擎结果以及提供的POC代码都明确指出该漏洞的存在以及利用方式。多个搜索引擎结果(例如：rapid7, alphabot, broadcom)都确认漏洞的存在, 并且漏洞已经被CISA加入到Known Exploited Vulnerabilities Catalog。

**投毒风险分析：**
提供的POC代码主要包含以下几个部分：
1.  **漏洞检测：** 用于检测目标URL是否存在漏洞。
2.  **Payload生成：** 生成用于执行命令的JSP webshell。
3.  **文件上传：** 通过HTTP PUT方法将JSP webshell上传到服务器。
4.  **命令执行：** 访问上传的JSP webshell，执行任意命令。

虽然POC的核心功能是利用漏洞进行攻击，但是对整个仓库进行分析，存在少量增加攻击者风险的可能性，例如：
*   **不必要的依赖:** 引入了requests库，这本身很常见，但是如果作者故意使用存在漏洞或者恶意代码的requests版本，就可能引入风险. 这部分风险占10%。

因此，整体来看，投毒风险较低，主要集中在作者可能引入的第三方恶意依赖上。

**漏洞利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在受影响的版本范围内，并且 `readonly` 初始化参数设置为 `false`，允许使用 HTTP PUT 方法上传文件。
2.  **上传恶意JSP文件：** 攻击者构造包含恶意代码的JSP文件，例如执行系统命令的webshell。
3.  **发送PUT请求：** 攻击者使用特制的HTTP PUT请求，将恶意JSP文件上传到目标服务器的Web目录中。通常会使用诸如`/shell.jsp/`或`/shell.jsp.`之类的URI绕过某些安全检查。
4.  **执行恶意代码：** 攻击者通过Web浏览器访问上传的JSP文件，服务器执行该文件中的恶意代码，从而实现远程代码执行。

**项目地址:** [scirusvulgaris/CVE-2017-12617](https://github.com/scirusvulgaris/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)