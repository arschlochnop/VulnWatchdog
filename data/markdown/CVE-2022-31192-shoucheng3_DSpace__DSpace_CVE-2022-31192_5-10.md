## CVE-2022-31192-DSpace-XSS

**漏洞编号:** CVE-2022-31192

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** DSpace JSPUI

**危害等级:** 中危，可能导致用户信息泄露和恶意脚本执行

**影响版本:** >= 6.0, < 6.4 和 >= 4.0, < 5.11

**利用条件:** 需要用户交互，访问包含恶意代码的“Request a Copy”页面

**POC 可用性:** 否 (根据搜索引擎结果，没有可用的公开漏洞利用)

**投毒风险:** 10%

## 详情

CVE-2022-31192 存在于 DSpace JSPUI 的 "Request a Copy" 功能中。由于对用户提交的数据未进行充分的转义，攻击者可以通过在 “Request a Copy” 表单中注入恶意 JavaScript 代码，当其他用户访问包含该请求的页面时，恶意脚本会被执行。根据漏洞库信息，该漏洞影响 DSpace 6.0 到 6.4 以及 4.0 到 5.11 版本。搜索引擎结果显示该漏洞已经公开，但没有可利用的exploit。提供的代码片段是 `CONTRIBUTING.md` 和 `Dockerfile`，与漏洞利用无关，因此不能直接用于验证漏洞。`CONTRIBUTING.md` 描述了如何向 DSpace 项目贡献代码，`Dockerfile` 用于构建 DSpace 的 Docker 镜像。其中`CONTRIBUTING.md`文件，可能存在作者加入恶意链接的情况，例如指向钓鱼网站，具有一定的投毒风险，但可能性不高。虽然代码本身不是恶意代码，但间接存在风险，判定为10%投毒风险。

**利用方式：**

1.  攻击者构造包含恶意 JavaScript 代码的 “Request a Copy” 请求，并通过 DSpace JSPUI 提交。
2.  恶意代码会被存储在服务器端。
3.  当其他用户（例如管理员或普通用户）访问包含该 “Request a Copy” 请求的页面时，服务器会返回包含恶意代码的 HTML 页面。
4.  用户的浏览器执行恶意 JavaScript 代码，可能导致会话劫持、信息窃取或恶意页面重定向等攻击。

由于漏洞需要用户交互（需要用户访问包含恶意代码的页面），因此 CVSS 评分中的 User Interaction 被设置为 Required。

**项目地址:** [shoucheng3/DSpace__DSpace_CVE-2022-31192_5-10](https://github.com/shoucheng3/DSpace__DSpace_CVE-2022-31192_5-10)

**漏洞详情:** [CVE-2022-31192](https://nvd.nist.gov/vuln/detail/CVE-2022-31192)