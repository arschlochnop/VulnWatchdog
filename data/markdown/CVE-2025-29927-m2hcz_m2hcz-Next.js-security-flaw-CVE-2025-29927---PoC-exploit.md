## CVE-2025-29927-Next.js-中间件认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用Next.js中间件进行认证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是 Next.js 中间件的一个认证绕过漏洞。攻击者可以通过发送包含特定 `x-middleware-subrequest` 头的 HTTP 请求绕过中间件的认证检查，从而访问受保护的路由。

**有效性：**
提供的 Python 脚本是一个有效的 POC，它通过设置 `x-middleware-subrequest` 头来尝试绕过认证。如果目标 Next.js 应用存在此漏洞，并且版本在受影响范围内，则该脚本可以成功访问通常需要认证的 `/admin` 路径（或其他受保护路由）。

**投毒风险：**
该 POC 代码的投毒风险极低，代码非常简洁，主要功能是构造带有特定 HTTP 头的请求并检查响应状态码。没有发现任何隐藏的恶意代码或后门。所有操作都集中于利用已知的认证绕过漏洞。

**利用方式：**
1.  攻击者确定目标 Next.js 应用使用的 Next.js 版本在受影响范围内。
2.  攻击者构造一个 HTTP 请求，并在请求头中包含 `x-middleware-subrequest` 字段，并设置特定的值，例如 "middleware:middleware:middleware:middleware:middleware"。
3.  攻击者将该请求发送到受保护的路由（例如 `/admin`）。
4.  如果漏洞存在，Next.js 中间件将无法正确验证请求，从而允许攻击者未经授权访问受保护的资源。
5.  搜索引擎结果也证实了该漏洞的存在，并提供了相关的修复信息。

综上所述，利用该漏洞的关键在于构造包含特定 `x-middleware-subrequest` 头的 HTTP 请求。

**项目地址:** [m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit](https://github.com/m2hcz/m2hcz-Next.js-security-flaw-CVE-2025-29927---PoC-exploit)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)