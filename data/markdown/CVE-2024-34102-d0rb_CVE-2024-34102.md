## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.4-p8, 2.4.7, 2.4.6-p5, 2.4.5-p7

**利用条件:** 目标服务器存在漏洞版本的Adobe Commerce且允许外部网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于Adobe Commerce (Magento) 中的 XML 外部实体注入 (XXE) 漏洞。未经验证的攻击者可以通过发送特制的 XML 文档来利用此漏洞，该文档引用外部实体，从而导致任意代码执行或敏感信息泄露，例如读取服务器上的文件（包括包含加密密钥的 `app/etc/env.php` 文件）。

**有效性:**
提供的POC代码利用了该XXE漏洞，通过构造包含外部实体引用的XML payload，尝试读取目标服务器上的文件并通过HTTP请求将文件内容发送到攻击者控制的服务器上。根据漏洞信息和搜索结果（例如：vicarius.io, assetnote.io），该漏洞利用方法是有效的。

**投毒风险:**
分析提供的POC代码，主要风险点在于`exfil_url`参数，如果攻击者使用恶意的URL作为exfil_url，可能导致受害者访问恶意网站。同时README.md中包含的`git clone https://github.com/yourusername/CVE-2024-34102-exploit.git`暗示了替换用户名存在风险。总体而言，投毒风险较低，主要集中在使用者引入不信任的外部资源。README.md 中的 #BringThemHome 信息不构成投毒。

**利用方式:**
1.  攻击者首先需要找到存在漏洞版本的Adobe Commerce (Magento) 实例。
2.  攻击者构造一个恶意的XML payload，该payload包含外部实体引用，指向攻击者控制的服务器。
3.  攻击者通过发送包含恶意XML payload的HTTP POST请求到`/rest/all/V1/guest-carts/test-assetnote/estimate-shipping-methods`端点来触发漏洞。
4.  Magento服务器解析XML时，会尝试解析外部实体引用，从而读取攻击者指定的文件。
5.  攻击者控制的服务器接收到包含文件内容的HTTP请求，完成数据泄露。

**项目地址:** [d0rb/CVE-2024-34102](https://github.com/d0rb/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)