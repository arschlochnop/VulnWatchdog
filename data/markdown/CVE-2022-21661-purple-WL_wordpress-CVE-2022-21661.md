## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21661 是 WordPress 中的一个 SQL 注入漏洞，存在于 WP_Query 类中，由于不正确的清理，攻击者可以通过插件或主题以特定的方式利用该漏洞，向 `tax_query` 传入恶意参数，导致执行任意 SQL 查询。根据漏洞库信息，成功利用该漏洞可能导致未经授权的数据访问，修改甚至远程代码执行。

**有效性评估：**

根据提供的 POC 代码，攻击者需要构造一个包含恶意 SQL 语句的 POST 请求，并将其发送到 `/wp-admin/admin-ajax.php` 接口。POC 使用了 DNSLog 技术，通过 `load_file` 函数尝试将数据库版本信息发送到攻击者控制的域名 (`ceye.io`)，以此来验证漏洞的存在。搜索引擎结果也表明该漏洞存在公开的利用方法，证明POC代码的有效性。

**投毒风险分析：**

提供的漏洞利用代码只包含一个 `README.md` 文件，其中描述了漏洞的利用方法和 POC 代码。该文件中没有发现任何可疑的或恶意代码，因此，可以认为该仓库中不存在作者隐藏的投毒代码。投毒风险为0%。

**利用方式分析：**

1.  **漏洞位置：** `WP_Query` 类中的 SQL 语句构造。
2.  **攻击向量：** 通过 `admin-ajax.php` 接口，发送包含恶意 `tax_query` 参数的 POST 请求。
3.  **攻击目标：** WordPress 数据库。
4.  **攻击效果：** 执行任意 SQL 查询，可能导致数据泄露，数据篡改，甚至远程代码执行。
5.  **利用条件：** 需要高权限用户账户，插件或主题以特定方式使用 WP_Query，攻击复杂度较高 (CVSS Attack Complexity: HIGH)。
6. **防御措施：** 升级WordPress版本到5.8.3或更高，启用自动更新，使用Web应用防火墙（WAF）以及对输入进行严格的过滤和验证。

**项目地址:** [purple-WL/wordpress-CVE-2022-21661](https://github.com/purple-WL/wordpress-CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)