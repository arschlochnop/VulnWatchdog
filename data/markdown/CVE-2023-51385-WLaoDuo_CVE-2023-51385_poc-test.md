## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 目标用户使用了受影响的OpenSSH版本，并且配置了ProxyCommand，clone包含恶意配置的git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。POC利用方式是通过精心构造包含恶意配置的Git仓库，当用户clone该仓库时，其中的子模块配置会触发ProxyCommand中的命令注入，从而执行攻击者预设的恶意命令。用户需要编辑ssh config，添加proxycommand，然后clone指定的git仓库，触发弹窗。投毒风险主要来自于作者可能在仓库中添加额外的恶意代码，例如在README.md中嵌入恶意链接，或者在其他看似无害的文件中隐藏Payload，但是从作者公布的演示视频和简单的代码来看，概率较低。

**项目地址:** [WLaoDuo/CVE-2023-51385_poc-test](https://github.com/WLaoDuo/CVE-2023-51385_poc-test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)