## CVE-2023-5561 - WordPress Unauthenticated Post Author Email Disclosure

**漏洞编号:** CVE-2023-5561

**漏洞类型:** 敏感信息泄露

**影响应用:** WordPress

**危害等级:** 中危，泄露用户邮箱信息

**影响版本:** 4.7.0 - 6.3.1

**利用条件:** 目标WordPress站点开启REST API，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5561 允许未经身份验证的攻击者通过 WordPress REST API 泄露用户邮箱地址。漏洞源于 WordPress 对 REST API 中可搜索用户字段的限制不足。攻击者可以通过构造特定的 REST API 查询，利用Oracle风格攻击，枚举并获取发布过公开文章的用户的邮箱地址。提供的PoC 代码 `CVE-2023-5561.py` 通过以下步骤利用此漏洞：

1.  **获取用户列表:** 首先，脚本尝试通过 `/wp-json/wp/v2/users` 接口获取用户 slug 列表。
2.  **暴力破解域名:** 然后，对于每个用户 slug，脚本使用多进程池 `multiprocessing.Pool` 尝试暴力破解域名。它构造包含用户 slug 的邮箱地址，并不断添加字符进行搜索。
3.  **验证邮箱/slug:** 脚本检查 API 返回的结果，如果用户 slug 匹配，并且返回的邮箱地址以猜测的邮箱地址开头，或者没有邮箱地址返回，则认为找到了一个匹配项。
4.  **输出结果:** 脚本输出找到的邮箱地址。

**有效性评估：**
根据漏洞描述和PoC代码，该漏洞利用有效，攻击者可以通过构造恶意请求获取邮箱信息。

**投毒风险分析：**
PoC代码主要功能是利用WordPress REST API的信息泄露漏洞来枚举邮箱地址。代码使用了 `requests` 库发送HTTP请求，`multiprocessing`库进行暴力破解。代码本身没有发现明显的恶意行为，如执行系统命令、上传恶意文件等。但是，任何从未知来源获取的代码都存在一定的风险，包括:

*   **依赖项风险:** `requests` 库本身可能存在安全漏洞，或者被替换为恶意版本。
*   **逻辑漏洞:** 代码中可能存在未知的逻辑漏洞，导致意外行为。
*   **数据泄露:** 脚本会将目标站点的用户信息打印到控制台，如果控制台日志被泄露，可能会导致信息泄露。
*   **资源消耗:**  该脚本会进行大量的HTTP请求，可能会对目标服务器造成一定的负载。

综上，虽然没有明显的后门或恶意代码，但仍然存在一定的投毒风险，建议在受控环境中运行，并对代码进行安全审计。风险百分比评估为10%。

**利用方式总结：**
1.  攻击者向WordPress REST API的 `/wp-json/wp/v2/users` 端点发送请求。
2.  利用 `search` 参数进行 Oracle 风格的攻击，逐步推断出用户的完整邮箱地址。
3.  由于漏洞存在于未授权访问的API端点，攻击无需任何凭据即可进行。


**项目地址:** [dthkhang/CVE-2023-5561-PoC](https://github.com/dthkhang/CVE-2023-5561-PoC)

**漏洞详情:** [CVE-2023-5561](https://nvd.nist.gov/vuln/detail/CVE-2023-5561)