## CVE-2024-27956 - WordPress Automatic Plugin SQL 注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL 注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可能导致数据库泄露、数据篡改和任意代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标网站安装了 WordPress Automatic Plugin 并且版本小于等于 3.92.0，攻击者需要能够访问目标网站的 /wp-content/plugins/wp-automatic/inc/csv.php 路径

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性评估:**

根据漏洞库信息和提供的POC代码，该漏洞是 WordPress Automatic 插件中的 SQL 注入漏洞（CVE-2024-27956），影响版本小于等于 3.92.0。POC代码尝试通过构造恶意的 SQL 查询语句，向 `wp_users` 表中插入一个新的管理员用户，并赋予其管理员权限。如果成功，攻击者可以使用新创建的管理员账户登录 WordPress 后台，从而控制整个网站。

POC 代码中，首先测试目标站点是否存在漏洞。 如果测试通过，则利用该漏洞创建恶意的管理员账户。

**投毒风险分析:**

在提供的POC代码中，没有发现明显的恶意投毒代码。代码的目的是利用 SQL 注入漏洞在目标WordPress网站上创建一个新的管理员账户。虽然这种行为本身是恶意的，但它属于漏洞利用的范畴，而不是指在代码中隐藏一些额外的、与漏洞利用无关的恶意行为。例如，没有发现代码尝试修改系统文件、安装后门程序或收集用户信息等。因此，可以认为投毒风险为 0%。

**漏洞利用方式分析:**

1.  **漏洞点:** 漏洞位于 `wp-content/plugins/wp-automatic/inc/csv.php` 文件中，攻击者可以直接访问该文件。
2.  **利用方式:**
    *   攻击者构造包含恶意 SQL 语句的 POST 请求，发送到 `csv.php` 文件。请求包含 `q` 参数（SQL 语句）和 `auth` 参数（通常为空）。
    *   通过 SQL 注入，攻击者可以执行任意 SQL 查询，例如插入新的管理员账户或修改现有账户的权限。
    *   POC 代码首先执行一个测试查询`SELECT 1`来确认漏洞是否存在。如果站点返回了期望的结果,就尝试插入一个eviladmin用户。
    *   创建管理员账户后，进一步赋予这个账户 administrator 权限，完整控制网站。
3.  **绕过机制:** 代码中看似使用了 hash 验证机制，但实际上传递的是空字符串的md5值,所以形同虚设,可被绕过。

**总结:**

该漏洞是一个严重的安全问题，因为未经身份验证的攻击者可以利用它完全控制受影响的 WordPress 网站。提供的 POC 代码似乎能够成功利用此漏洞创建管理员账户。

**项目地址:** [0axz-tools/CVE-2024-27956](https://github.com/0axz-tools/CVE-2024-27956)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)