## CVE-2025-29927-Next.js-Middleware-认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行认证，且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是一个 Next.js 中间件认证绕过漏洞，由于 Next.js 对 `x-middleware-subrequest` 标头的处理不当导致。攻击者可以通过构造包含该标头的恶意请求绕过中间件中的认证检查，从而未经授权访问受保护的资源。

**有效性：**根据漏洞库信息和搜索结果，该漏洞是一个真实存在的、高危的漏洞。提供的POC代码（middleware-auth-bypass）表明该漏洞是可利用的。

**投毒风险：** 提供的POC代码只包含LICENSE和README.md文件，从目前的代码来看没有明显的投毒代码。由于缺少漏洞利用的exp代码，无法做更深度的分析。但是仓库中可能存在隐藏的投毒风险，例如在安装或配置过程中引入恶意依赖或执行恶意脚本。 故投毒风险评定为5%。

**利用方式：**
1.  攻击者发送一个包含 `x-middleware-subrequest` 标头的 HTTP 请求。
2.  如果Next.js应用使用了中间件进行认证，并且版本在受影响范围内，则中间件的认证检查可能被绕过。
3.  攻击者可以未经授权地访问受保护的资源。
4.  缓解措施包括升级Next.js版本到14.2.25或15.2.3及以上，或者阻止包含`x-middleware-subrequest`标头的外部请求。

**项目地址:** [ValGrace/middleware-auth-bypass](https://github.com/ValGrace/middleware-auth-bypass)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)