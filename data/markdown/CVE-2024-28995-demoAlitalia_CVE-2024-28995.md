## CVE-2024-28995-SolarWinds Serv-U-目录遍历

**漏洞编号:** CVE-2024-28995

**漏洞类型:** 目录遍历

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** <= 15.4.2 HF 1

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的SolarWinds Serv-U版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-28995 是 SolarWinds Serv-U 中的一个目录遍历漏洞。未经身份验证的远程攻击者可以利用此漏洞读取目标服务器磁盘上的任意文件。根据Rapid7的博客文章，该漏洞利用起来非常简单。给定的POC代码（CVE-2024-28995.go）通过发送包含目录遍历payload的HTTP请求，尝试读取Windows服务器上的`Serv-U-StartupLog.txt`文件或Linux服务器上的`/etc/passwd`文件，从而验证目标是否易受攻击。PoC代码首先从 `ips.txt` 文件中读取目标IP地址列表，然后并发地向每个IP地址发送恶意请求。如果服务器返回包含特定字符串（例如，'Operating System: Windows Server' 或 'root:x'）的响应，则认为该服务器易受攻击。风险评估：

*   **有效性：** 根据漏洞描述和搜索结果，该POC代码的有效性较高，因为该漏洞已被积极利用。
*   **投毒风险：** 该POC代码主要功能是验证漏洞是否存在，没有发现明显的恶意代码，但仍然存在一定的潜在风险。如程序可以读取任意文件，可能被修改为上传恶意脚本或执行其他恶意操作。因此，投毒风险评估为5%。
*   **利用方式：** 攻击者可以通过发送特制的HTTP请求，在URL中包含目录遍历序列（如`/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`），从而访问受限制的目录和文件。由于该漏洞不需要身份验证，因此任何能够访问Serv-U服务器的攻击者都可以利用它。

**项目地址:** [demoAlitalia/CVE-2024-28995](https://github.com/demoAlitalia/CVE-2024-28995)

**漏洞详情:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)