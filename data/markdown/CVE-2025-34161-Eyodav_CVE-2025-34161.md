## CVE-2025-34161 - Coolify Git Repository Field Command Injection

**漏洞编号:** CVE-2025-34161

**漏洞类型:** 命令注入

**影响应用:** Coolify

**危害等级:** 高危，可导致远程代码执行和完全服务器接管

**影响版本:** <= v4.0.0-beta.420.6

**利用条件:** 需要 Coolify 实例，低权限用户账号，且 Coolify 版本小于等于 v4.0.0-beta.420.6。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Coolify 的项目部署工作流程中。经过身份验证的低权限用户可以通过在项目创建期间的 Git 存储库 URL 字段中注入恶意 shell 命令来利用此漏洞。攻击者可以通过提交包含命令注入语法的精心设计的存储库字符串，在底层主机系统上执行任意命令，从而导致服务器完全被控制。

**有效性：**
提供的 POC 代码是有效的，因为它清晰地描述了利用步骤和受影响的版本。POC 描述了如何通过在 Git 存储库 URL 字段中插入恶意 payload（例如 `git@github.com:fake/repo.git; cat /etc/passwd #;`）来触发命令执行。

**投毒风险：**
该 POC 仓库本身只包含一个 README.md 文件，描述了漏洞的利用方法。直接的投毒风险较低。虽然攻击者可能会修改利用代码以包含恶意功能，但该仓库本身目前看起来没有明显的投毒迹象。这里投毒风险评估为10%，主要考虑到用户在实际使用漏洞的时候，可能会从其他地方下载或者拷贝漏洞利用代码，如果不是官方来源，则可能存在被投毒的风险。

**利用方式：**
1.  以低权限用户身份登录 Coolify。
2.  创建一个新项目。
3.  选择私有 GIT。
4.  在 `Git Repository URL` 字段中插入恶意 payload，例如 `git@github.com:fake/repo.git; <command> #;`，其中 `<command>` 是要执行的任意 shell 命令。
5.  部署项目。攻击者可以在日志中观察任意命令的执行结果。

**项目地址:** [Eyodav/CVE-2025-34161](https://github.com/Eyodav/CVE-2025-34161)

**漏洞详情:** [CVE-2025-34161](https://nvd.nist.gov/vuln/detail/CVE-2025-34161)