## CVE-2025-6058-WPBookit-任意文件上传

**漏洞编号:** CVE-2025-6058

**漏洞类型:** 任意文件上传

**影响应用:** WPBookit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.4

**利用条件:** 目标网站安装并启用了WPBookit插件，且版本不高于1.0.4

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6058漏洞存在于WPBookit WordPress插件中，允许未经身份验证的攻击者上传任意文件。漏洞原因是`image_upload_handle()`函数缺少文件类型验证。利用方式如下：

1.  **漏洞分析：** 漏洞出现在插件的`add_booking_type`路由处理图片上传时，`image_upload_handle()`函数没有对上传的文件类型进行严格校验。
2.  **利用步骤：**
    *   攻击者首先构造一个包含恶意代码的PHP Shell文件，例如本例中的`ghost_shell.php`，该文件包含允许执行系统命令的代码。
    *   攻击者通过POST请求将该Shell文件上传到服务器，绕过任何文件类型限制。
    *   利用脚本首先会获取插件版本，确认是否是受影响的版本，然后通过构造特定的POST请求，将包含恶意代码的PHP文件上传到服务器。
    *   上传成功后，攻击者可以通过访问上传的Shell文件执行任意系统命令，从而控制服务器。
3.  **有效性评估：**
    *   根据漏洞库信息、搜索引擎结果和提供的POC代码，此漏洞利用是有效的。POC代码实现了漏洞利用的完整流程，包括版本检测和Shell文件上传。
4.  **投毒风险评估：**
    *   在提供的POC代码中，没有发现明显的投毒代码。POC代码的功能主要是利用漏洞上传webshell,实现远程代码执行，没有发现其他的恶意行为。因此，投毒风险评估为0%。但需要注意的是，任何下载的POC代码都应进行安全审计，以防止被植入恶意代码。
5.  **搜索引擎信息补充：**
    *   搜索引擎结果表明，该漏洞是高危漏洞，影响广泛，需要及时修复。

**总结：**
CVE-2025-6058是一个严重的任意文件上传漏洞，攻击者可以利用它上传恶意文件并获得服务器的控制权。网站管理员应尽快将WPBookit插件更新到安全版本，以避免受到攻击。

**项目地址:** [0xgh057r3c0n/CVE-2025-6058](https://github.com/0xgh057r3c0n/CVE-2025-6058)

**漏洞详情:** [CVE-2025-6058](https://nvd.nist.gov/vuln/detail/CVE-2025-6058)