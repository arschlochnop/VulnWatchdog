## CVE-2020-17519-Apache Flink目录遍历

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager的REST接口对外开放且运行在受影响版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-17519 是 Apache Flink 1.11.0 到 1.11.2 版本中存在的一个目录遍历漏洞。攻击者可以通过 JobManager 的 REST 接口，利用目录遍历读取 JobManager 进程可以访问的本地文件系统上的任意文件。 

**有效性：**

提供的 POC 代码有效。它通过构造包含 `..%252f` (双重URL编码的 `../`) 的恶意 URL 发送 HTTP GET 请求到 `/jobmanager/logs/` 路径，尝试读取 `/etc/passwd` 文件。如果服务器返回状态码 200 且响应内容包含 `root:x`，则确认漏洞存在。

**投毒风险：**

提供的 POC 代码未发现明显的投毒代码。代码功能简单，仅用于验证漏洞是否存在，没有执行恶意操作或安装后门。该仓库的作者没有隐藏任何投毒代码, 投毒风险为 0%。

**利用方式：**

1.  确定目标 Apache Flink JobManager 的 REST 接口 URL。
2.  构造包含目录遍历的 URL，例如：`http://<target_url>/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd`。
3.  发送 HTTP GET 请求到构造的 URL。
4.  如果服务器返回状态码 200 且响应内容为目标文件内容，则漏洞利用成功。请注意JobManager进程的权限决定了能够读取的文件。

**项目地址:** [zhangweijie11/CVE-2020-17519](https://github.com/zhangweijie11/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)