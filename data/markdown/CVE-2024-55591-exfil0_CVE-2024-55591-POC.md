## CVE-2024-55591-Fortinet身份验证绕过

**漏洞编号:** CVE-2024-55591

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，攻击者可以获得超级管理员权限

**影响版本:** FortiOS: 7.0.0 to 7.0.16, FortiProxy: 7.0.0 to 7.0.19, 7.2.0 to 7.2.12

**利用条件:** 需要网络访问目标设备的WebSocket/Telnet管理端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-55591 漏洞是一个严重的身份验证绕过漏洞，影响 FortiOS 和 FortiProxy。根据漏洞描述，攻击者可以通过构造特制的请求到 Node.js WebSocket 模块，绕过身份验证，获得超级管理员权限。\n\n**有效性分析：**\n\n*   漏洞库信息显示该漏洞CVSS评分为9.6，属于严重级别，且已被CISA列入已知被利用漏洞目录 (KEV)。\n*   搜索引擎结果表明该漏洞已被野外利用，影响大量设备，多个安全厂商发布了分析报告。\n*   提供的PoC代码是一个Python脚本，旨在自动化利用该漏洞。PoC 具有依赖安装、端口扫描、版本检测、漏洞利用和命令执行等功能。该PoC脚本的存在进一步佐证了该漏洞的可利用性。\n\n综合以上信息，可以得出结论：CVE-2024-55591 漏洞**有效且危害严重**。\n\n**投毒风险分析：**\n\nPoC代码主要功能集中在漏洞检测和利用上，未发现明显的恶意代码，用于植入后门或进行其他恶意行为。但是，任何未经审核的代码都存在一定的风险。\n\nPoC脚本执行的命令，如 `diag sys top`、`diag debug crashlog read`、`execute shell` 可用于收集敏感信息，如果攻击者修改了这些命令，可能会造成更大的危害。脚本集成了从互联网下载依赖的行为，如果作者在托管的依赖中加入恶意代码，则可能存在投毒风险。\n\n综合分析，认为该PoC脚本存在**较低的投毒风险（10%）**。用户在使用该脚本时，应仔细审核代码，并采取必要的安全措施。\n\n**利用方式：**\n\n1.  **端口扫描：** 使用 Nmap 扫描目标设备，发现开放的 WebSocket/Telnet 管理端口。\n2.  **版本检测：** 尝试获取目标设备的 FortiOS/FortiProxy 版本信息，确认是否存在漏洞。\n3.  **WebSocket 连接：** 与目标设备的 WebSocket 接口建立连接。\n4.  **身份验证绕过：** 发送特制的请求到 WebSocket 接口，绕过身份验证。\n5.  **命令执行：** 成功绕过身份验证后，执行任意命令，获取超级管理员权限。

**项目地址:** [exfil0/CVE-2024-55591-POC](https://github.com/exfil0/CVE-2024-55591-POC)

**漏洞详情:** [CVE-2024-55591](https://nvd.nist.gov/vuln/detail/CVE-2024-55591)