## CVE-2019-10219-Hibernate-Validator-XSS

**漏洞编号:** CVE-2019-10219

**漏洞类型:** XSS

**影响应用:** Hibernate Validator

**危害等级:** 中危，可能导致用户信息泄露和恶意脚本执行

**影响版本:** 6.0.0.Alpha1 <= version <= 6.0.17.Final 或 6.1.0.Alpha1 <= version <= 6.1.0.Alpha6

**利用条件:** 需要应用程序使用存在漏洞的Hibernate Validator版本，且允许用户输入HTML内容并通过SafeHtml验证器进行处理。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10219 漏洞存在于 Hibernate Validator 中，由于 `SafeHtml` 验证器未能正确地过滤包含恶意代码的 HTML 注释和指令，导致跨站脚本攻击 (XSS)。攻击者可以通过提交恶意的 HTML payload 绕过验证，并在受害者的浏览器中执行任意 JavaScript 代码。利用方式为：首先应用程序需使用受影响版本的 Hibernate Validator，其次攻击者需找到应用程序中使用了 `@SafeHtml` 注解的字段，然后构造包含恶意 HTML 注释或指令的 payload，例如 `<!--<script>alert("XSS")</script>-->`。由于提供的代码仓库主要是关于贡献指南和项目说明，直接的漏洞利用代码并不存在于这些文件中，因此投毒风险较低，但仍有可能在贡献的代码中存在恶意注入，风险大约为10%。

漏洞利用有效性取决于目标应用程序是否使用了受影响版本的Hibernate Validator，以及是否允许用户输入HTML内容，并使用了`@SafeHtml`注解进行验证。

搜索引擎结果表明该漏洞是一个XSS漏洞，并影响多个应用程序，包括Oracle WebLogic和IBM TRIRIGA。


**项目地址:** [shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed](https://github.com/shoucheng3/hibernate__hibernate-validator_CVE-2019-10219_6_0_18_Final_fixed)

**漏洞详情:** [CVE-2019-10219](https://nvd.nist.gov/vuln/detail/CVE-2019-10219)