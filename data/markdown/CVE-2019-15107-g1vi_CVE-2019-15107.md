## CVE-2019-15107 - Webmin password_change.cgi 命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 目标服务器运行Webmin <= 1.920，且攻击者可以访问Webmin的password_change.cgi页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107 是 Webmin 1.920 及更早版本中 password_change.cgi 文件存在的一个命令注入漏洞。攻击者可以通过在 `old` 或 `expired` 参数中注入恶意命令来执行任意系统命令。

**有效性：**
提供的POC代码是一个 bash 脚本 (exploit.sh)，它利用了 password_change.cgi 中的命令注入漏洞。脚本会提示用户输入目标 IP 地址、端口、本地监听端口和网络接口。然后，它构造一个包含反向 shell payload 的 HTTP POST 请求，并使用 curl 发送到目标 Webmin 服务器。如果漏洞存在且利用成功，攻击者会在其监听端口上收到一个反向 shell，证明POC的有效性。

**投毒风险：**
仔细检查了提供的 exploit.sh 脚本和 README.md 文件。脚本的逻辑相对简单，主要目的是利用 CVE-2019-15107 漏洞，在目标系统上建立反向 shell。脚本中没有发现任何明显的恶意或隐藏代码，比如删除关键文件、植入后门或者执行其他未经授权的操作。Payload直接是构建反向shell,并没有其他的恶意代码,因此，代码被投毒的风险较低，可认为是 0%。

**利用方式：**
1.  **确定目标：** 找到运行 Webmin <= 1.920 的服务器。
2.  **运行漏洞利用脚本：** 运行 exploit.sh 脚本，并按照提示输入目标 IP 地址、端口、监听端口和接口。
3.  **监听端口：** 使用 `rlwrap -cAr nc -lvp <监听端口>` 等命令在本地监听指定端口，等待目标服务器建立反向 shell 连接。
4.  **获取 Shell：** 成功利用漏洞后，攻击者将获得目标服务器的 shell 访问权限，从而可以执行任意命令。

**项目地址:** [g1vi/CVE-2019-15107](https://github.com/g1vi/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)