## CVE-2020-16898 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务（蓝屏）

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 和 Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 攻击者需要能够向目标 Windows 计算机发送特制的 ICMPv6 路由器通告数据包，需要知道目标的 IPv6 地址（包括本地链路 IPv6 地址，全球 IPv6 地址，临时 IPv6 地址）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Windows TCP/IP栈中，由于对ICMPv6路由器通告报文处理不当导致。攻击者通过发送特制的ICMPv6报文，利用Option Type 25 触发漏洞。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的PoC已经公开，并且已被证实可以触发蓝屏死机（BSOD），表明漏洞利用是有效的。提供的漏洞利用代码中存在两个exp， exp1可以直接远程代码执行,exp2可以直接导致目标系统崩溃。

**投毒风险：**
检查了提供的PoC代码，未发现明显的恶意代码，但是，考虑到攻击者可能修改代码以进行恶意活动，例如植入后门或执行其他恶意操作，仍然存在一定的风险。

**利用方式：**
1.  攻击者需要确定目标系统的IPv6地址。
2.  攻击者使用PoC代码（例如，`CVE-2020-16898-exp1.py` 或 `CVE-2020-16898.py`），修改目标IP地址为攻击目标的IPv6地址。
3.  攻击者运行PoC代码，发送特制的ICMPv6路由器通告报文到目标系统。
4.  如果目标系统存在漏洞，可能会触发远程代码执行或者导致系统崩溃（BSOD）。

**缓解措施：**
*   及时安装Microsoft发布的补丁。
*   禁用IPv6，如果不需要使用IPv6网络。
*   配置防火墙规则，限制ICMPv6流量。

**项目地址:** [komomon/CVE-2020-16898-EXP-POC](https://github.com/komomon/CVE-2020-16898-EXP-POC)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)