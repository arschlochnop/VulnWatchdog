## CVE-2021-30181-Apache Dubbo-RCE

**漏洞编号:** CVE-2021-30181

**漏洞类型:** 远程代码执行

**影响应用:** Apache Dubbo

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.6.9 和 < 2.7.9

**利用条件:** 攻击者需要能够控制或影响Dubbo的路由规则配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2021-30181是Apache Dubbo中的一个远程代码执行漏洞，源于Dubbo的脚本路由功能使用`ScriptEngine`来评估不受信任的脚本。如果攻击者能够控制或影响Dubbo的路由规则配置（例如，通过访问配置中心），则可以注入恶意的Nashorn脚本，从而在Dubbo客户端上执行任意代码。

**有效性评估：**

根据漏洞描述，如果Dubbo实例使用了脚本路由并且允许执行脚本，POC应该有效。搜索结果中的多个链接（例如，阿里巴巴云的描述）也证实了这一点。

**投毒风险分析：**

提供的漏洞利用代码（`CHANGES.md`文件）是Apache Dubbo的更改日志，并非实际的漏洞利用代码，因此几乎不存在投毒风险。这个文件只是一些历史版本的信息，不能直接用于攻击。投毒风险很低，估计为1%。

**利用方式分析：**

1.  **攻击者获取配置中心访问权限：** 这是最常见的攻击场景。攻击者需要能够修改Dubbo的配置，特别是路由规则。
2.  **注入恶意脚本：** 攻击者在路由规则中注入恶意的Nashorn脚本。该脚本可以执行任意Java代码。
3.  **Dubbo客户端执行脚本：** 当Dubbo客户端根据受污染的路由规则路由请求时，`ScriptEngine`会执行恶意脚本，导致远程代码执行。

**总结：**

CVE-2021-30181是一个高危漏洞，利用条件较为苛刻，需要攻击者能够修改Dubbo的配置。但是，一旦利用成功，攻击者可以在Dubbo客户端上执行任意代码，造成严重的后果。提供的`CHANGES.md`文件本身不包含漏洞利用代码，因此不存在直接的投毒风险。

**项目地址:** [shoucheng3/apache__incubator-dubbo_CVE-2021-30181_2-6-8](https://github.com/shoucheng3/apache__incubator-dubbo_CVE-2021-30181_2-6-8)

**漏洞详情:** [CVE-2021-30181](https://nvd.nist.gov/vuln/detail/CVE-2021-30181)