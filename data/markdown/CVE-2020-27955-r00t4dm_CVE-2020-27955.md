## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了存在漏洞的 Git LFS 版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 允许通过克隆包含特制 `.gitattributes` 文件的仓库来执行远程代码。漏洞利用方式如下：

1.  **创建包含恶意 `.gitattributes` 文件的 Git 仓库:**  `.gitattributes` 文件中定义了 Git LFS 如何处理特定类型的文件。恶意文件会配置LFS来调用`git.cmd`文件。
2.  **`git.cmd` 文件:** POC中，`git.cmd` 内容为 `calc.exe`，用于在Windows系统上启动计算器。
3.  **`large.dat` 文件:** 这是一个示例文件，它的存在是为了满足 LFS 的基本要求，内容无关紧要。
4.  **克隆仓库触发漏洞:** 当受害者克隆包含这些恶意文件的仓库时，Git LFS 会尝试处理 `large.dat` 文件，并根据 `.gitattributes` 中的配置执行 `git.cmd`，从而执行 `calc.exe`。

**有效性评估:** 提供的 POC 代码是有效的，如果目标系统存在漏洞，克隆该仓库将导致 `calc.exe` 被执行，证明了远程代码执行。

**投毒风险评估:** 此仓库中没有发现明显的投毒代码。 `git.cmd` 文件的内容很直接，就是执行 `calc.exe`，没有隐藏其他恶意行为。`large.dat` 文件仅包含 “junk”，没有可执行代码。 `.gitattributes` 是漏洞利用的关键，但也只是配置 LFS 执行 `git.cmd` 。 因此，投毒风险评估为 0%。

**利用方式总结:** 攻击者创建一个包含恶意 `.gitattributes` 文件的 Git 仓库，受害者克隆该仓库时，会触发远程代码执行漏洞。

**项目地址:** [r00t4dm/CVE-2020-27955](https://github.com/r00t4dm/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)