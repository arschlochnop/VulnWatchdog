## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本 (XSS) 到 远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 3.2.0 到 3.4.2

**利用条件:** 需要受害者访问包含恶意代码的页面；需要WonderCMS的管理权限进行模块安装。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425 是 WonderCMS 3.2.0 到 3.4.2 版本中的一个跨站脚本漏洞。攻击者可以通过上传包含恶意 JavaScript 代码的模块（主题），利用该漏洞执行任意代码。漏洞利用过程如下：

1.  **准备恶意模块：** 攻击者创建一个包含恶意 PHP 反向 Shell 脚本的 ZIP 文件。提供的 exploit_CVE-2023-41425.py 脚本自动化了这个过程，生成包含反向 shell 的主题模块，并修改 PHP 文件中的 IP 地址和端口。
2.  **XSS 注入：** 攻击者利用 XSS 漏洞，将包含恶意 JavaScript 代码的页面注入到 WonderCMS 中。该 JavaScript 代码负责自动安装上传的恶意模块。
3.  **模块安装：**  利用JavaScript脚本自动从攻击者控制的服务器上下载并安装包含恶意 PHP 脚本的 ZIP 文件作为主题模块。脚本通过构造包含 ZIP 文件 URL 的 `installModule` GET 请求来完成此操作。这个请求需要有效的 CSRF token，脚本会尝试从页面中提取。
4.  **触发反向 Shell：** 模块安装后，JavaScript代码会再次发送请求，通过访问 themes/{dir_name}/reverseShell.php 执行 ZIP 包中的 PHP 反向 Shell 脚本,从而在攻击者的服务器上建立反向 Shell 连接，允许攻击者远程控制受影响的 WonderCMS 服务器。

**有效性：** 根据漏洞信息和利用代码，该漏洞利用是有效的。漏洞库信息、搜索引擎结果以及漏洞利用代码都指向了攻击者可以通过上传恶意模块执行任意代码的事实。提供的 POC 代码自动化了整个利用过程，包括生成恶意模块、配置反向 shell 以及触发漏洞。

**投毒风险：** POC 代码本身的主要功能是生成恶意payload，自动化漏洞利用，但仍然存在一定的投毒风险。风险主要来自于作者可能在脚本中添加额外的恶意代码，例如：

*   **信息收集：** 脚本可能在后台收集受害者系统的信息并发送给攻击者。
*   **持久化后门：** 脚本可能在受害者系统中安装持久化的后门，即使漏洞修复后仍然可以访问系统。
*   **传播恶意软件：** 脚本可能下载并执行其他恶意软件。

该代码存在连接外部资源，下载恶意文件的行为，需要提防被替换的风险，所以判断该仓库中存在作者隐藏的投毒代码的可能性为10%。

**利用方式总结：** 该漏洞的利用方式是 XSS 结合恶意模块上传导致的 RCE。攻击者首先利用 XSS 漏洞注入恶意 JavaScript 代码，然后通过该代码自动安装包含反向 shell 的恶意模块，最后通过访问恶意模块中的 PHP 脚本来触发反向 shell，实现远程代码执行。

**项目地址:** [Tea-On/CVE-2023-41425-RCE-WonderCMS-4.3.2](https://github.com/Tea-On/CVE-2023-41425-RCE-WonderCMS-4.3.2)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)