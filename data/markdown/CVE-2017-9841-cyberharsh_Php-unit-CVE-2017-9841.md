## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器的/vendor目录暴露在web访问下，可以访问到/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-9841是一个存在于PHPUnit框架中的远程代码执行漏洞。根据漏洞描述，如果PHPUnit的`vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以通过Web访问，攻击者可以通过发送包含PHP代码的POST请求来执行任意代码。

**有效性：** 提供的POC代码有效。Dockerfile构建了一个包含漏洞版本的PHPUnit的环境。docker-compose文件用于启动环境，并暴露8080端口。README.md文件详细说明了如何利用漏洞，即向`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送包含PHP代码的POST请求。

**投毒风险：** 代码仓库中，flagA文件看似用于存放flag，可能在CTF或者漏洞演练中使用。Dockerfile中从官方源下载composer和PHPUnit，没有明显的恶意代码植入。但仍存在微小的投毒风险，例如构建镜像时，网络环境可能被劫持，下载恶意composer包。但是整体风险较低。

**利用方式：**
1.  **环境搭建：** 使用提供的Dockerfile和docker-compose.yml构建并运行一个包含漏洞版本的PHPUnit的Web服务器。
2.  **漏洞触发：** 向`http://your-ip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`发送POST请求。
3.  **代码执行：** 在POST请求的Body中包含要执行的PHP代码，例如`<?php phpinfo(); ?>`。服务器会将POST Body的内容作为PHP代码执行。

漏洞利用的关键在于目标服务器的`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件必须可以通过Web访问。通常，`/vendor`目录应该被保护起来，防止未经授权的访问。

**项目地址:** [cyberharsh/Php-unit-CVE-2017-9841](https://github.com/cyberharsh/Php-unit-CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)