## CVE-2019-16278 - Nostromo 1.9.6 目录遍历导致远程代码执行

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，可导致远程代码执行，完全控制服务器

**影响版本:** <= 1.9.6

**利用条件:** 需要目标服务器运行Nostromo nhttpd 1.9.6或更早版本，且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Nostromo nhttpd服务器的`http_verify`函数中。攻击者可以通过构造包含目录遍历字符的HTTP请求，绕过权限验证，执行任意系统命令。

**利用方式：**

1.  **构造恶意HTTP请求：** 攻击者发送一个POST请求，其中URL包含目录遍历序列（`/.%0d./.%0d./.%0d./.%0d./`）来尝试访问`/bin/sh`。
2.  **注入命令：**  在请求体中通过`echo`命令构造shell命令，例如`echo\necho\nwhoami 2>&1`。`2>&1`将标准错误重定向到标准输出，以便在响应中获取命令执行结果。
3.  **发送请求：**  将构造好的HTTP请求发送到目标Nostromo服务器。
4.  **接收响应：**  服务器执行注入的命令，并将结果返回给攻击者。

**有效性分析：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。漏洞信息明确指出，通过目录遍历可以实现远程代码执行。搜索引擎结果也证实了该漏洞的存在和严重性，并提供了相关的漏洞分析和利用文章。提供的Python POC代码实现了上述利用过程，构造恶意的HTTP请求，并通过目录遍历执行命令。

**投毒风险分析：**

提供的POC代码和README文件没有明显的投毒代码。代码的功能集中于利用已知的漏洞，执行指定的命令并返回结果。没有发现任何尝试安装后门、修改系统配置或进行其他恶意行为的代码。

*   代码结构清晰，主要功能是构建HTTP请求并发送。
*   使用的模块都是标准的Python库（`argparse`, `socket`），没有引入外部的、可能包含恶意代码的模块。
*   命令执行结果通过标准输出返回，没有隐蔽的通信或持久化行为。

因此，可以认为该仓库的投毒风险较低，大约为0%。

**项目地址:** [aN0mad/CVE-2019-16278-Nostromo_1.9.6-RCE](https://github.com/aN0mad/CVE-2019-16278-Nostromo_1.9.6-RCE)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)