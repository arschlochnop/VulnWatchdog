## CVE-2023-1698-WAGO-远程代码执行

**漏洞编号:** CVE-2023-1698

**漏洞类型:** 远程代码执行

**影响应用:** WAGO Compact Controller CC100, Edge Controller, PFC100, PFC200, Touch Panel 600系列

**危害等级:** 高危，允许未经验证的远程攻击者创建新用户并更改设备配置，可能导致拒绝服务和完全系统入侵。

**影响版本:** Compact Controller CC100 (FW20 <= FW <= FW22, FW23), Edge Controller (FW22), PFC100 (FW20 <= FW <= FW22, FW23), PFC200 (FW20 <= FW <= FW22, FW23), Touch Panel 600 (FW22)

**利用条件:** 目标设备必须存在漏洞，攻击者需要能够通过网络访问目标设备的Web管理界面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-1698 存在于 WAGO 的多个产品中，是一个未经身份验证的远程命令注入漏洞。攻击者可以通过向 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 发送特制的 POST 请求，在 `package` 参数中注入恶意代码来执行任意命令。从搜索结果和漏洞利用代码来看，该漏洞存在公开可用的 PoC 并且已经被积极利用。该PoC利用了wbm-legal-information插件中的命令注入漏洞，通过修改package的值来执行系统命令。投毒风险评估为10%，原因是代码中直接硬编码了请求路径和参数，降低了攻击者修改Payload后进行更大规模恶意传播的可能性，且代码中未发现明显的后门或恶意行为，只有可能攻击者在exp文件中加入恶意代码。

利用方式：
1.  攻击者构造包含恶意命令的 POST 请求，发送到目标设备的 `/wbm/plugins/wbm-legal-information/platform/pfcXXX/licenses.php` 路径，其中 XXX 需要根据目标设备的型号进行调整。
2.  恶意命令被服务器执行，攻击者从而控制设备。
3. 攻击者可以创建新用户，修改配置，甚至完全控制系统。

参考信息：
*   漏洞库信息表明该漏洞影响多个 WAGO 产品，CVSS 评分为 9.8，属于严重漏洞。
*   搜索结果表明存在公开的漏洞细节和 PoC 代码。
*   漏洞利用代码验证了该漏洞的存在，通过修改`package`参数实现了命令执行。

**项目地址:** [deIndra/CVE-2023-1698](https://github.com/deIndra/CVE-2023-1698)

**漏洞详情:** [CVE-2023-1698](https://nvd.nist.gov/vuln/detail/CVE-2023-1698)