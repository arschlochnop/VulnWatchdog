## CVE-2024-7971-Google Chrome-V8类型混淆

**漏洞编号:** CVE-2024-7971

**漏洞类型:** 类型混淆

**影响应用:** Google Chrome

**危害等级:** 高危，可能导致堆腐败和远程代码执行

**影响版本:** < 128.0.6613.84

**利用条件:** 需要用户访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7971是Google Chrome浏览器V8引擎中的一个类型混淆漏洞。该漏洞允许远程攻击者通过精心制作的HTML页面利用堆腐败。漏洞存在于128.0.6613.84之前的Chrome版本中。

**有效性：** 根据漏洞库信息和搜索引擎结果，此漏洞已被积极利用，并且CISA KEV中也收录了该漏洞，表明漏洞真实存在且危害较高。提供的POC代码声称只是一个PoC而非完整的exploit，验证了漏洞的可利用性。因此，POC代码具备一定的有效性，可以触发类型混淆，但可能不直接实现任意代码执行。

**投毒风险：** 提供的代码主要包含两个js文件：`poc-original.js`和`poc.js`，以及一个README.md文件。
*   **README.md：** 提供漏洞的简要说明，风险较低。
*   **poc-original.js：** 原始的PoC代码，引用了wasm模块构建器，旨在触发漏洞，风险相对较低。
*   **poc.js：** 修改后的PoC，作者提供了构建d8的指令。代码利用WebAssembly模块的特性，旨在触发V8引擎中的类型混淆漏洞。虽然作者提供了详细的调试信息和编译方法，方便复现漏洞，但存在隐藏恶意代码的可能性。

综合分析，投毒的风险主要在于`poc.js`中可能包含作者有意或无意引入的恶意代码。但从代码结构和注释来看，该代码的目的是为了重现和理解漏洞，因此，判定为投毒的概率较低,但不可完全排除，风险估计为10%。投毒风险主要是利用用户对漏洞分析的信任，在看似无害的代码中添加恶意操作，例如窃取用户信息或执行其他恶意行为。

**利用方式：** 

1.  **类型混淆：** 漏洞的根本原因是V8引擎在处理JavaScript和WebAssembly代码时，未能正确地验证类型信息，导致类型混淆。
2.  **堆腐败：** 攻击者利用类型混淆，写入错误类型的数据到堆上，从而覆盖堆上的其他对象，造成堆腐败。
3.  **远程代码执行：** 攻击者利用堆腐败，控制程序的执行流程，最终实现远程代码执行。通过构造特定的JavaScript和WebAssembly代码，可以覆盖函数指针或其他关键数据结构，从而劫持程序的控制流。
4.  **攻击流程：**
    *   攻击者创建一个恶意的HTML页面，其中包含触发类型混淆漏洞的JavaScript和WebAssembly代码。
    *   用户使用存在漏洞的Chrome浏览器访问该页面。
    *   浏览器解析并执行页面中的代码，触发V8引擎中的类型混淆漏洞。
    *   攻击者利用堆腐败，最终实现远程代码执行。

**项目地址:** [mistymntncop/CVE-2024-7971](https://github.com/mistymntncop/CVE-2024-7971)

**漏洞详情:** [CVE-2024-7971](https://nvd.nist.gov/vuln/detail/CVE-2024-7971)