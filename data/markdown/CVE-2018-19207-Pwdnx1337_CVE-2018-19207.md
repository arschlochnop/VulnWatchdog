## CVE-2018-19207-WP GDPR Compliance-远程代码执行

**漏洞编号:** CVE-2018-19207

**漏洞类型:** 远程代码执行

**影响应用:** WP GDPR Compliance Plugin

**危害等级:** 高危，允许未授权用户修改管理员邮箱，可能导致权限提升和进一步的攻击

**影响版本:** < 1.4.3

**利用条件:** WordPress站点启用了WP GDPR Compliance插件，且版本低于1.4.3

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-19207是WP GDPR Compliance插件中一个严重的远程代码执行漏洞。漏洞原因是插件在处理`$wpdb->prepare()`输入时存在问题，导致攻击者可以绕过安全检查，执行任意代码。

**利用方式：**

1.  **未授权访问:** 攻击者无需任何身份验证，可以直接访问存在漏洞的WordPress站点。
2.  **修改管理员邮箱:** 利用漏洞，攻击者可以修改WordPress站点的管理员邮箱地址。
3.  **权限提升:** 修改管理员邮箱后，攻击者可以利用“忘记密码”功能，重置管理员密码，从而获得管理员权限。
4.  **执行恶意操作:** 获得管理员权限后，攻击者可以执行任意恶意操作，例如上传恶意插件、修改网站内容等。

**POC代码分析：**

提供的Python脚本通过以下步骤利用该漏洞：

1.  **构造Payload:** 脚本构造一个包含新管理员邮箱地址的JSON payload。
2.  **获取Nonce:** 脚本从WordPress站点获取一个名为`ajaxSecurity`的nonce值，用于绕过安全检查。
3.  **发送请求:** 脚本向`/wp-admin/admin-ajax.php`发送POST请求，其中包含构造的payload和nonce值。
4.  **验证结果:** 脚本检查响应，判断是否成功修改管理员邮箱。
5.  **保存结果:** 脚本将利用结果保存到本地文件中。

**投毒风险分析：**

该代码存在投毒风险的可能性极低，为0%。原因是:

1.  代码逻辑清晰： 代码功能简单，主要实现发送HTTP请求和解析响应，没有发现任何隐藏的恶意代码或后门。
2.  依赖外部库： 代码只依赖于`requests`、`re`、`json`、`sys`和`os`这些常用的Python标准库或第三方库，不太可能通过这些库引入恶意代码。
3.  代码可读性高： 代码结构良好，注释清晰，易于阅读和理解，降低了隐藏恶意代码的难度。

**有效性分析：**

根据漏洞描述和POC代码，该漏洞利用方式是有效的。搜索引擎结果也表明该漏洞确实存在，并且已经被公开利用。

**项目地址:** [Pwdnx1337/CVE-2018-19207](https://github.com/Pwdnx1337/CVE-2018-19207)

**漏洞详情:** [CVE-2018-19207](https://nvd.nist.gov/vuln/detail/CVE-2018-19207)