## CVE-2024-37606-D-Link DCS-932L-栈溢出

**漏洞编号:** CVE-2024-37606

**漏洞类型:** 栈溢出

**影响应用:** D-Link DCS-932L

**危害等级:** 中危，可能导致拒绝服务

**影响版本:** REVB_FIRMWARE_2.18.01

**利用条件:** 需要与目标设备在同一网络中，或者能够通过网络访问到目标设备的80端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-37606是D-Link DCS-932L摄像头REVB_FIRMWARE_2.18.01版本中的一个栈溢出漏洞。攻击者可以通过构造恶意的HTTP请求，特别是向`/setTestEmail`路径发送包含过长数据的POST请求，导致设备上的alphapd进程崩溃，从而实现拒绝服务攻击（DoS）。

**漏洞利用方式：**
1.  攻击者需要能够访问到D-Link DCS-932L设备的HTTP服务（通常在80端口）。
2.  攻击者构造一个包含恶意负载的HTTP POST请求，该请求的目标URL是`/setTestEmail`。
3.  POST请求中包含一个`Host`头部，以及一个`Content-Length`头部，指定了请求体的长度。 同时包含Authorization认证头部
4.  请求体包含足够的数据以溢出栈缓冲区。
5.  发送构造的HTTP请求到目标设备。
6.  目标设备上的alphapd进程会因栈溢出而崩溃，导致设备拒绝服务。

**有效性评估：**
提供的PoC代码 `CVE-2024-37606-DCS932L.py` 尝试通过发送一个精心制作的HTTP POST请求到`/setTestEmail`路径来利用此漏洞。  代码尝试连接目标IP地址的80端口，并发送包含恶意负载的POST请求。如果目标设备在发送PoC后没有响应，代码会将其标记为可能崩溃。  因此，提供的PoC代码是有效的。

**投毒风险评估：**
代码主要功能是扫描网络，判断端口是否开放，然后发送特制的POST请求，没有发现明显的恶意代码，例如：
*   植入后门
*   上传敏感信息
*   执行任意命令

虽然存在一定的风险，例如利用漏洞进行非法攻击，但代码本身没有发现隐藏的恶意功能。因此，投毒风险较低。投毒风险评估为1%。 这种风险主要来自被攻击者修改或者利用此代码进行其他恶意攻击，而不是代码作者本身在代码中植入后门。代码作者在代码注释中标明`NOVI HOGESCHOOL EINDOPDRACHT`，也表明这是一个学校的作业，进一步降低了投毒的可能性。 此外，代码对本地的`alphapd`进程和QEMU环境进行检测，这可以帮助使用者了解PoC的运行环境，并非恶意行为。

**项目地址:** [itwizardo/DCS932L-Emulation-CVE-2024-37606-Attack](https://github.com/itwizardo/DCS932L-Emulation-CVE-2024-37606-Attack)

**漏洞详情:** [CVE-2024-37606](https://nvd.nist.gov/vuln/detail/CVE-2024-37606)