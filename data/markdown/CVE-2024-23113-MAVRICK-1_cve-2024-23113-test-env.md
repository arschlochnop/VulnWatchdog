## CVE-2024-23113 Fortinet Format String Vulnerability

**漏洞编号:** CVE-2024-23113

**漏洞类型:** 格式化字符串漏洞

**影响应用:** FortiOS, FortiProxy, FortiPAM, FortiSwitchManager

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13
FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.15
FortiPAM: 1.2.0, 1.1.0-1.1.2, 1.0.0-1.0.3
FortiSwitchManager: 7.2.0-7.2.3, 7.0.0-7.0.3

**利用条件:** 需要网络访问，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23113是一个存在于Fortinet FortiOS、FortiProxy、FortiPAM和FortiSwitchManager中的格式化字符串漏洞。攻击者可以通过发送特制的网络数据包来利用此漏洞，从而执行未经授权的代码或命令。根据CISA的信息，该漏洞已被积极利用。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是有效的。搜索引擎结果表明，多个安全研究团队和机构已经确认了该漏洞的存在，并认为其具有高危性和易于利用性。漏洞利用代码提供了一个Docker环境，用于模拟易受攻击的FortiOS实例，并使用Nuclei模板进行测试。该测试环境包括易受攻击和已修补的版本，以及多个易受攻击的版本，用于验证漏洞检测。

**投毒风险评估：**
提供的代码主要是一个测试环境，用于验证Nuclei模板是否能够检测到CVE-2024-23113漏洞。Dockerfile构建了一个包含模拟的FortiOS服务的容器，server.py（未提供）负责模拟FortiOS的行为。README.md文件提供了使用说明和测试示例。

虽然代码本身看起来是为了测试漏洞，但仍存在一定的投毒风险：
1.  `server.py`内容未知：如果server.py模拟FortiOS服务时，引入了后门或者恶意行为，可能存在投毒的风险。此风险是最高的。
2.  Nuclei模板的依赖：如果Nuclei模板本身被篡改，可能导致误报或漏报，甚至可能执行恶意操作。
3.  构建过程：构建Docker镜像的过程中，如果引入了不信任的外部资源，可能存在投毒的风险。

综上所述，投毒风险较低，因为代码主要用于漏洞验证，但仍不能完全排除。大约10%的风险。

**利用方式：**
1.  **攻击向量：** 远程网络攻击，无需身份验证。
2.  **漏洞类型：** 格式化字符串漏洞（CWE-134）。
3.  **利用方式：** 攻击者构造包含格式化字符串的特制数据包，发送到目标设备。
4.  **漏洞影响：** 成功利用漏洞可导致远程代码执行，攻击者可以完全控制受影响的设备。

**项目地址:** [MAVRICK-1/cve-2024-23113-test-env](https://github.com/MAVRICK-1/cve-2024-23113-test-env)

**漏洞详情:** [CVE-2024-23113](https://nvd.nist.gov/vuln/detail/CVE-2024-23113)