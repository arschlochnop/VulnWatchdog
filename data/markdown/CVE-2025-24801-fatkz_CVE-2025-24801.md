## CVE-2025-24801-GLPI-RCE

**漏洞编号:** CVE-2025-24801

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GLPI

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** >= 0.85, < 10.0.18

**利用条件:** 需要有效的 GLPI Technician 账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24801 存在于 GLPI 软件中，允许经过身份验证的用户通过上传恶意 PHP 文件来执行远程代码。漏洞利用过程如下：

1.  **身份验证：** 攻击者需要具备一个有效的 GLPI Technician 账户才能登录系统。
2.  **修改文档类型设置：** 登录后，攻击者利用 `poc.py` 脚本，修改 GLPI 的文档类型设置，允许上传 `.php` 文件。默认情况下，GLPI 可能不允许上传 PHP 文件，该脚本会修改相关配置绕过此限制。
3.  **上传 PHP Webshell：** 攻击者利用 `poc.py` 脚本，上传包含恶意代码的 PHP webshell 文件。此脚本使用 AJAX 文件上传端点上传webshell.
4.  **触发 RCE：** 上传 webshell 后，攻击者**手动**通过PDF font include触发LFI，执行上传的恶意 PHP 文件，从而在服务器上执行任意代码。利用方式是报告导出功能里的PDF字体包含参数。需要指定上传shell的文件名。

**有效性评估：**

根据漏洞描述和 PoC 代码，此漏洞是有效的。PoC 代码演示了如何自动化登录、修改文档类型设置和上传 webshell。**但是，触发 RCE 的步骤需要手动操作，并非完全自动化。**

**投毒风险评估：**

*   `poc.py` 脚本本身的目的就是利用漏洞，因此不应将其内部的 RCE 代码视为投毒。此脚本用于验证和利用已知的安全漏洞，而不是用于传播恶意软件。
*   经过检查，脚本主要功能是自动化漏洞利用过程，没有发现明显的恶意代码，例如收集用户信息或在目标系统上安装持久性后门。`exploit.py`的作用是上传一个反向shell，这个行为本身是漏洞验证的一部分。
*   风险主要在于脚本本身可能存在未知的漏洞或错误，导致利用失败或意外的系统行为。
*   仓库中存在的投毒风险较低，大约为10%。这个风险主要来自于下载和运行任何第三方脚本的固有风险，以及脚本可能被篡改的可能性。

**利用方式总结：**

该漏洞的利用方式是通过利用 GLPI 的文件上传功能和LFI漏洞，上传并执行恶意 PHP 代码，从而获得服务器的远程代码执行权限。攻击者首先需要通过身份验证，然后修改文档类型设置以允许上传 PHP 文件，再上传webshell，最后手动触发LFI以执行shell。

**项目地址:** [fatkz/CVE-2025-24801](https://github.com/fatkz/CVE-2025-24801)

**漏洞详情:** [CVE-2025-24801](https://nvd.nist.gov/vuln/detail/CVE-2025-24801)