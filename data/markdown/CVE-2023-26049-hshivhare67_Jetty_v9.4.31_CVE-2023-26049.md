## CVE-2023-26049-Eclipse Jetty Cookie 注入

**漏洞编号:** CVE-2023-26049

**漏洞类型:** 信息泄露

**影响应用:** Eclipse Jetty

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 9.4.51, >= 10.0.0, < 10.0.14, >= 11.0.0, < 11.0.14, >= 12.0.0.alpha0, < 12.0.0.beta0

**利用条件:** 需要目标系统运行存在漏洞的Jetty版本，且攻击者能够设置Cookie

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26049是Eclipse Jetty中的一个漏洞，源于其对带引号的Cookie值的解析方式不符合标准。当 Jetty 遇到以双引号 `"` 开头的 cookie VALUE 时，它会持续读取 cookie 字符串，直到遇到结束引号，即使遇到分号也是如此。因此，攻击者可以通过在cookie中注入其他cookie，例如将`JSESSIONID`等敏感cookie嵌入到另一个cookie中。如果嵌入cookie的value被渲染到页面，攻击者可以通过该方式窃取`HttpOnly`的`JSESSIONID`等敏感cookie。

**有效性：**
根据漏洞描述，该漏洞是由于Jetty的Cookie解析逻辑错误导致的，通过构造特殊的Cookie可以利用该漏洞。漏洞库信息和搜索引擎结果都指向了该漏洞的存在和风险。因此，如果目标系统运行着受影响的Jetty版本，漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是Jetty项目的`CONTRIBUTING.md` 和 `Jenkinsfile`文件，并非漏洞利用代码。`CONTRIBUTING.md`文件介绍了如何为Jetty项目做贡献，包括贡献者协议、联系方式、bug搜索和安全问题报告等信息。`Jenkinsfile`是Jenkins的pipeline配置文件，用于自动化构建和测试流程。这些文件本身不包含任何可执行代码，因此不存在直接的投毒风险。 但jenkins file 间接存在一定风险,比如依赖的container存在恶意代码,所以投毒风险较低。

**利用方式：**
1.  **构造恶意Cookie：** 攻击者构造包含嵌入cookie的恶意Cookie。例如，设置一个名为`DISPLAY_LANGUAGE`的Cookie，其值为`"b; JSESSIONID=1337; c=d"`。攻击者需要确保`JSESSIONID`是目标服务器的敏感cookie。
2.  **发送Cookie：** 将构造的Cookie发送到目标服务器。这可以通过HTTP请求的`Cookie`头部完成。
3.  **Cookie解析：** 目标服务器使用存在漏洞的Jetty版本解析Cookie。
4.  **信息泄露：** 如果`DISPLAY_LANGUAGE` Cookie的值被渲染到页面上，攻击者可以通过查看页面源代码获取`JSESSIONID`的值，从而窃取用户的会话。


**项目地址:** [hshivhare67/Jetty_v9.4.31_CVE-2023-26049](https://github.com/hshivhare67/Jetty_v9.4.31_CVE-2023-26049)

**漏洞详情:** [CVE-2023-26049](https://nvd.nist.gov/vuln/detail/CVE-2023-26049)