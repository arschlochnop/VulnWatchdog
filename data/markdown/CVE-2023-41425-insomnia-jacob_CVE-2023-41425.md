## CVE-2023-41425-WonderCMS-XSS导致RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击(XSS)导致远程代码执行(RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 3.2.0 <= 版本 <= 3.4.2

**利用条件:** 目标运行受影响版本的WonderCMS，攻击者可以访问登录页面，无需管理员密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425是WonderCMS v3.2.0到v3.4.2版本中存在的跨站脚本(XSS)漏洞。攻击者可以通过上传恶意构造的模块到installModule组件来利用此漏洞，最终实现远程代码执行。该漏洞利用流程大致如下：

1.  **漏洞触发：** 攻击者通过`installModule`参数注入恶意JavaScript代码。
2.  **XSS Payload:**  `exploit.py`脚本生成一个包含恶意JavaScript代码的`xss.js`文件，该文件会被WonderCMS加载。
3.  **远程ZIP下载：** 恶意JavaScript代码指示目标服务器从攻击者控制的远程主机下载包含后门代码的ZIP文件（默认从`https://github.com/prodigiousMind/revshell/archive/refs/heads/main.zip`下载，也可以通过`-r`参数指定）。
4.  **后门部署：**  下载的ZIP文件被解压到`themes`目录下，其中包含一个`rev.php`文件，这个文件包含反弹shell的代码。
5.  **RCE实现：**  恶意JavaScript代码进一步访问`rev.php`文件，并传递攻击者的IP地址和端口号，从而在目标服务器上执行反弹shell，攻击者从而获得服务器的控制权。

**有效性：**

根据漏洞描述和利用代码分析，该POC是有效的。它通过XSS漏洞结合模块安装功能实现RCE。

**投毒风险：**

该仓库存在一定的投毒风险，因为：

*   **远程ZIP下载：** 漏洞利用依赖于从远程主机下载ZIP文件。攻击者可以修改`-r`参数，指向一个恶意ZIP文件，其中包含更危险的payload，例如删除服务器上的关键文件。
*   **rev.php内容：** 作者可以控制 revshell-main/rev.php 的内容，如果 revshell-main/rev.php 被篡改为恶意代码，下载恶意代码的受害者将受到攻击。

虽然`exploit.py`本身的代码看起来比较直接，主要是生成XSS payload和发送HTTP请求，但是远程ZIP文件的内容和攻击者指定的远程地址存在潜在的风险。考虑到这一点，我估计投毒风险为10%。

**利用方式：**

1.  设置监听端口：攻击者使用`nc -nvlp <端口号>`在本地监听指定的端口。
2.  运行`exploit.py`脚本，指定目标URL、攻击者IP地址和监听端口号。
3.  脚本生成`xss.js`文件，包含恶意JavaScript代码。
4.  脚本尝试利用WonderCMS的XSS漏洞，使目标服务器下载并执行恶意代码，从而建立反弹shell连接。

**项目地址:** [insomnia-jacob/CVE-2023-41425](https://github.com/insomnia-jacob/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)