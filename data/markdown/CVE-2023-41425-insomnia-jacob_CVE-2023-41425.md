## CVE-2023-41425-WonderCMS-XSS导致RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本（XSS）

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.2.0 到 3.4.2

**利用条件:** 目标系统运行受影响的WonderCMS版本，攻击者能够通过网络访问，并且WonderCMS实例允许安装模块。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-41425是WonderCMS 3.2.0到3.4.2版本中存在的跨站脚本漏洞，攻击者可以通过上传包含恶意JavaScript代码的模块（zip文件）到`installModule`组件来利用此漏洞。漏洞利用不需要知道管理员密码，利用过程如下：

1.  **上传恶意模块：** 攻击者创建一个包含恶意JavaScript代码的zip文件，该代码可以执行任意命令。
2.  **利用XSS漏洞：** 攻击者通过构造特殊的URL，触发XSS漏洞，该URL指向包含恶意JavaScript的`xss.js`文件。`xss.js` 文件会下载并安装之前上传的包含恶意代码的模块。
3.  **远程代码执行：** 恶意模块安装后，其中的JavaScript代码会被执行，攻击者可以借此执行任意命令，例如，部署反向shell。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该漏洞是有效的。POC代码提供了一个自动化的利用脚本，通过指定目标URL、攻击者IP地址和端口，可以上传恶意模块并触发XSS漏洞，最终实现远程代码执行。

**投毒风险：**

对提供的`exploit.py`和`README.md`文件进行了分析。`exploit.py`脚本的主要功能是：

*   接收命令行参数，包括目标URL、攻击者IP地址、端口和远程zip文件URL。
*   生成包含恶意JavaScript代码的`xss.js`文件，该文件用于利用XSS漏洞。
*   通过构造包含恶意模块URL的请求，触发`installModule`组件的安装过程。
*   触发反向shell的执行。

虽然脚本本身的功能是利用漏洞，但可能存在以下投毒风险：

*   **默认下载地址：** 脚本默认从`https://github.com/prodigiousMind/revshell/archive/refs/heads/main.zip`下载zip文件，如果该zip文件被篡改，攻击者可能会执行非预期的代码。但这个是revshell仓库，验证完POC后，确定不是投毒。该仓库由POC作者提供，用于生成反向shell。
*   **其他潜在风险：** 代码中没有发现明显的后门或者恶意代码，主要功能是利用XSS漏洞进行RCE。

综合以上分析，认为此仓库中存在作者隐藏的投毒代码的可能性很低，风险概率评估为1%。

**利用方式总结：**

利用CVE-2023-41425漏洞的步骤如下：

1.  **准备：** 准备一个包含反向shell或其他恶意代码的zip文件，并将其托管在一个可以通过HTTP访问的服务器上。
2.  **配置：** 使用提供的`exploit.py`脚本，指定目标WonderCMS实例的URL、攻击者IP地址、监听端口和恶意zip文件的URL。
3.  **执行：** 运行`exploit.py`脚本，脚本会自动生成包含恶意JavaScript代码的`xss.js`文件，并通过构造特殊的URL触发XSS漏洞，实现远程代码执行。
4.  **监听：** 在攻击者机器上使用`nc -nvlp <port>`监听指定的端口，等待反向shell连接。

**项目地址:** [insomnia-jacob/CVE-2023-41425](https://github.com/insomnia-jacob/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)