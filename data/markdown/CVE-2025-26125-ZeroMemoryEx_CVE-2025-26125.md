## CVE-2025-26125 - IObit Malware Fighter IMFForceDelete 驱动程序权限提升

**漏洞编号:** CVE-2025-26125

**漏洞类型:** 权限提升

**影响应用:** IObit Malware Fighter

**危害等级:** 高危，可导致系统完全控制

**影响版本:** 12.1.0

**利用条件:** 需要本地访问，目标系统安装IObit Malware Fighter v12.1.0

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-26125 存在于 IObit Malware Fighter v12.1.0 的 IMFForceDelete 驱动中。该漏洞是由于 `IMFForceDelete` 驱动程序中暴露了一个 `ioctl`，允许未经授权的用户删除文件和文件夹。PoC 代码利用这一点，结合 MSI 回滚机制，将文件删除漏洞转化为权限提升漏洞。具体利用方式如下：

1.  **利用任意文件删除：** PoC首先利用暴露的 `ioctl` 删除特定的系统文件/文件夹。
2.  **MSI 回滚机制：** PoC 巧妙地利用了 MSI 安装程序的rollback机制. 该机制用于在安装失败时恢复系统到原始状态。
3.  **弱 ACL 创建：**  删除目标文件/文件夹后，PoC 使用弱访问控制列表（DACL）重新创建它们。这使得普通用户可以修改这些文件。
4.  **替换 RBF/RBS 文件：**  PoC 包含伪造的 RBF (rollback script file) 和 RBS (rollback script) 文件。这些文件被设计为在回滚期间执行恶意操作。
5.  **权限提升：**  通过上述步骤，PoC 在 MSI 回滚期间获得以 `NT AUTHORITY\SYSTEM` 身份执行代码的能力，从而实现权限提升。

**有效性：**  根据漏洞信息和 PoC 代码，以及GitHub上的相关信息（https://github.com/ZeroMemoryEx/IObit-EoP 和 https://github.com/ZeroMemoryEx/CVE-2025-26125），该 PoC 代码很可能有效，能够成功利用该漏洞。

**投毒风险：**  虽然提供的代码片段看起来像是漏洞利用的必要组成部分，但仍存在一定的投毒风险。仔细检查发现，PoC 代码使用了外部的 `SystemCmdLauncher.dll`，且`FolderOrFileDeleteToSystem.rc`中也包含`Msi_EoP.msi` 和 `5eeabb3.rbs`等文件资源。如果这些外部资源被篡改，可能会引入恶意代码。因此，投毒风险预估为 10%.

**项目地址:** [ZeroMemoryEx/CVE-2025-26125](https://github.com/ZeroMemoryEx/CVE-2025-26125)

**漏洞详情:** [CVE-2025-26125](https://nvd.nist.gov/vuln/detail/CVE-2025-26125)