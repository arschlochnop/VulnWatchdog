## CVE-2024-21413-Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 严重，允许攻击者在目标机器上执行任意代码

**影响版本:** 受影响版本包括Microsoft Office 2016, 2019, LTSC 2021, Microsoft 365 Apps for Enterprise等，具体版本范围参考漏洞库信息。

**利用条件:** 攻击者需要诱使用户打开包含恶意链接或内容的邮件。无需用户交互（zero-click NTLM leak）或仅需单次点击（one-click RCE）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个Microsoft Outlook远程代码执行漏洞，也被称为“MonikerLink”漏洞。根据漏洞库信息和搜索结果，此漏洞允许攻击者通过构造特殊的链接，在受害者无需交互或仅需极少交互的情况下，执行任意代码。利用方式主要有两种：

1.  **Zero-click NTLM Leak:** 攻击者可以诱使受害者打开包含恶意链接的邮件，该链接会触发NTLM凭据泄露，而无需受害者进行任何点击操作。
2.  **One-click RCE:** 攻击者可以诱使受害者点击邮件中的恶意链接，从而实现远程代码执行。

POC代码提供了一个Python脚本，该脚本利用SMTP认证发送包含恶意URL的电子邮件，模拟实际攻击场景。脚本需要SMTP服务器地址、端口、用户名、密码、发送者和接收者邮箱地址、恶意URL以及邮件主题等参数。

关于投毒风险，虽然POC代码本身旨在演示漏洞利用，但考虑到网络安全威胁的复杂性，以及攻击者可能对公开代码进行修改和传播，存在一定的投毒风险。例如，攻击者可能在POC代码中添加额外的恶意代码，用于窃取用户凭据或执行其他恶意操作。虽然提供的POC代码看起来比较简单，主要功能是发送包含恶意链接的邮件，但无法完全排除作者或其他人修改该代码并添加后门或恶意功能的可能性。因此，评估投毒风险为10%。使用前务必仔细审查代码，并在隔离环境中进行测试。

**请务必注意：**  该漏洞已在野外被利用，并已被CISA添加到已知被利用的漏洞目录中。强烈建议用户尽快安装Microsoft提供的安全更新。

**项目地址:** [ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability](https://github.com/ahmetkarakayaoffical/CVE-2024-21413-Microsoft-Outlook-Remote-Code-Execution-Vulnerability)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)