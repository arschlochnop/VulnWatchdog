## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许未授权网络访问SSH端口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387 (regreSSHion) 是 OpenSSH 服务器 (sshd) 中发现的安全回归漏洞，源于 CVE-2006-5051。这是一个竞争条件漏洞，可能导致 sshd 以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内身份验证失败来触发此漏洞。 

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞的PoC是有效的，并且已经公开。多个安全厂商和研究人员已经发布了关于此漏洞的分析和PoC代码。

**投毒风险分析：**

提供的Checker.py脚本的主要功能是检测目标SSH服务器是否存在CVE-2024-6387漏洞。它通过连接到目标服务器的SSH端口并获取SSH banner信息，然后将其与已知易受攻击和已修补的版本进行比较来确定漏洞状态。 代码中没有发现任何明显的恶意或后门代码。

投毒风险评估：0%。该脚本主要用于漏洞检测，不包含任何主动利用漏洞的代码，也没有发现作者隐藏的恶意代码。

**利用方式分析：**

1.  **漏洞原理：** 漏洞是由于 OpenSSH 在处理信号时存在竞争条件，允许在身份验证失败期间执行恶意代码。
2.  **攻击步骤：** 攻击者需要向目标服务器发起大量的SSH连接尝试。
3.  **触发条件：** 在连接尝试期间，攻击者故意使身份验证失败，触发竞争条件。
4.  **利用结果：** 成功利用此漏洞可能允许攻击者在目标系统上执行任意代码，以root权限运行，或者造成拒绝服务攻击。
5.  **缓解措施：** 通过设置 `LoginGraceTime 0` 禁用 `LoginGraceTime` 参数可以缓解远程代码执行的风险，但仍然存在拒绝服务的风险。更新到OpenSSH 9.8或更高版本是完整的修复方案。

**项目地址:** [anhvutuan/CVE-2024-6387-poc-1](https://github.com/anhvutuan/CVE-2024-6387-poc-1)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)