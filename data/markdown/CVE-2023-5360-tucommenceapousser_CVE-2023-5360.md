## CVE-2023-5360 - Royal Elementor Addons and Templates - 未经验证的任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标网站安装了Royal Elementor Addons and Templates插件，且版本低于1.3.79，攻击者可以未经身份验证直接上传恶意文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 存在于 Royal Elementor Addons and Templates WordPress 插件的 1.3.79 版本之前。该插件未正确验证上传的文件，允许未经身份验证的用户上传任意文件，包括PHP文件，从而导致远程代码执行（RCE）。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞利用代码有效。漏洞库和搜索结果都明确指出该插件存在未授权的任意文件上传漏洞，且漏洞利用代码尝试上传包含恶意PHP代码的文件。

**投毒风险分析：**
在提供的漏洞利用代码中，主要功能是上传一个包含PHP后门代码的文件，暂未发现明显的恶意投毒行为。虽然代码中包含从目标服务器执行任意命令的部分，但这是利用漏洞的预期行为，而不是额外的、与漏洞利用无关的恶意代码。代码结构比较简单，主要由颜色控制，文件上传，表单显示构成。但代码冗余行数比较多，不排除作者隐藏简单后门的可能性，因此判断存在轻微的投毒风险。保守估计投毒风险为10%。

**利用方式分析：**
1.  攻击者利用该漏洞，无需身份验证，直接向存在漏洞的WordPress网站上传恶意PHP文件。
2.  上传的PHP文件包含后门代码，例如webshell，允许攻击者在服务器上执行任意命令。
3.  攻击者通过访问上传的PHP文件，执行恶意代码，从而控制服务器。
4.  利用代码首先生成一个随机文件名，然后构造一个包含PHP代码的文件上传请求，该PHP代码的功能是允许用户上传任意文件。上传成功后，攻击者可以通过浏览器访问上传的文件，从而执行PHP代码。

**项目地址:** [tucommenceapousser/CVE-2023-5360](https://github.com/tucommenceapousser/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)