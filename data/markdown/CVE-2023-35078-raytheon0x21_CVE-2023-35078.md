## CVE-2023-35078-Ivanti EPMM 身份验证绕过

**漏洞编号:** CVE-2023-35078

**漏洞类型:** 身份验证绕过

**影响应用:** Ivanti Endpoint Manager Mobile (EPMM)

**危害等级:** 严重，允许未经授权的远程API访问，可能导致数据泄露和完全系统控制

**影响版本:** <= 11.8.1.0, 11.9.1.0 < 11.9.1.1, 11.10.0.1 < 11.10.0.2

**利用条件:** 目标系统需要运行受影响的Ivanti EPMM版本，且漏洞API端口对外开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-35078 是 Ivanti Endpoint Manager Mobile (EPMM) 中的一个身份验证绕过漏洞。攻击者可以通过未经身份验证的远程API访问来利用此漏洞。漏洞利用方式包括：

1.  **版本检测:**  通过访问目标URL，解析HTML内容，检查`ui.login.css`引用的版本号，确认目标是否在受影响的版本范围内。
2.  **API访问:** 构造特定的URL (`/mifs/aad/api/v2/authorized/users?adminDeviceSpaceId=1`)来绕过身份验证，访问受保护的API接口。
3.  **数据提取:** 如果目标易受攻击，攻击者可以提取用户数据，例如用户名和其他敏感信息。 

 **投毒风险分析:** 

代码分析表明，该POC的主要功能是利用身份验证绕过漏洞，并从目标系统提取用户数据。虽然POC本身旨在演示漏洞利用，但仍然存在轻微的投毒风险（估计为5%），原因如下：

*   **依赖项风险：** `go.mod` 文件中声明的依赖项可能会被恶意修改或替换，从而引入恶意代码。然而，当前的提供的代码片段中不包含 `go.mod` 文件，因此此风险较低。 
*   **潜在的日志泄露风险：**  在实际使用中，如果将此PoC集成到自动化扫描工具中，可能会无意中将敏感信息（如目标URL、提取的数据等）记录到日志文件中，增加泄露风险。
*   **滥用风险：** PoC本身的存在就可能被恶意行为者利用，对未经授权的目标发起攻击。

尽管存在上述风险，但从提供的代码来看，它主要侧重于漏洞利用本身，并没有明显的恶意代码或后门。因此，可以认为投毒风险较低。

**利用方式总结:** 攻击者通过构造特殊的URL，绕过身份验证，从而访问并提取Ivanti EPMM系统中的敏感信息。POC代码的功能是利用该漏洞，并提供了自动化的利用脚本。

**项目地址:** [raytheon0x21/CVE-2023-35078](https://github.com/raytheon0x21/CVE-2023-35078)

**漏洞详情:** [CVE-2023-35078](https://nvd.nist.gov/vuln/detail/CVE-2023-35078)