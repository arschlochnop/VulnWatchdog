## CVE-2025-55752 - Apache Tomcat 目录遍历/RCE

**漏洞编号:** CVE-2025-55752

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 11.0.0-M1 到 11.0.10, 10.1.0-M1 到 10.1.44, 9.0.0-M11 到 9.0.108, 8.5.6 到 8.5.100

**利用条件:** 需要存在将查询参数重写到URL的重写规则，并且启用HTTP PUT方法。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-55752 是 Apache Tomcat 中的一个相对路径遍历漏洞，由修复 bug 60013 引入的回归导致。当存在将查询参数重写到 URL 的重写规则时，URL 在解码之前被规范化，允许攻击者通过构造包含 `../` 的恶意路径来绕过安全限制，例如访问 `/WEB-INF/` 和 `/META-INF/` 目录。如果同时启用了 HTTP PUT 方法，攻击者可以上传恶意文件，导致远程代码执行。

**有效性：**
提供的 POC 代码看起来有效，因为它提供了检查路径遍历漏洞和上传 JSP 文件的功能。它也提供了自定义文件名和payload的功能。

**投毒风险：**
该 README.md 文件本身不太可能包含恶意代码，但其提供的 python3 脚本存在一定的风险，考虑到文件类型和目标，这里预估投毒风险在1%左右，主要体现在，在实际利用过程中，恶意攻击者可能会对脚本进行修改，加入后门代码或者其他恶意行为，以达到长期控制的目的。此评估是基于代码审查和常识，并不能保证100%准确。

**利用方式：**
1.  **利用前提：** Tomcat服务器存在将查询参数重写到URL的重写规则，并且启用了HTTP PUT 方法。
2.  **绕过保护：** 攻击者构造包含 `../` 的恶意 URL，绕过对 `/WEB-INF/` 和 `/META-INF/` 等敏感目录的保护。
3.  **上传恶意文件：** 利用 HTTP PUT 方法上传包含恶意代码的 JSP 文件或其他可执行文件。
4.  **远程代码执行：** 访问上传的恶意文件，触发其中的恶意代码，实现远程代码执行。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-55752](https://github.com/B1ack4sh/Blackash-CVE-2025-55752)

**漏洞详情:** [CVE-2025-55752](https://nvd.nist.gov/vuln/detail/CVE-2025-55752)