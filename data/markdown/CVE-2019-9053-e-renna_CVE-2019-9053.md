## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 2.2.9

**利用条件:** 需要目标系统安装了CMS Made Simple，并且News模块开启。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中的一个未经身份验证的盲注时间型SQL注入漏洞。该漏洞位于News模块中，通过精心构造的URL，可以利用`m1_idlist`参数进行注入。攻击者通过发送包含恶意SQL语句的HTTP请求，并观察服务器响应时间来推断数据库信息。 

**有效性:**

根据漏洞信息，搜索引擎结果，以及提供的漏洞利用代码，此漏洞是有效的。Exploit-DB和GitHub上都存在公开的PoC，表明该漏洞可以被利用。

**投毒风险:**

提供的PoC代码本身功能是利用时间盲注来dump salt 和 password 然后利用字典进行破解密码，功能比较明确，没有发现明显恶意代码。虽然PoC代码主要功能没有问题，但存在如下潜在风险：

*   **依赖项安装风险:** 代码中包含`subprocess.call([ "pip3", "install", "subprocess" ])`，虽然本意可能是安装缺失的termcolor库,但如果termcolor安装失败，且攻击者可以控制目标服务器，则可能通过修改此调用来安装恶意包。 这是一个潜在的投毒点。
*   **字典攻击风险:**  PoC需要用户提供字典文件进行密码破解, 如果攻击者使用了恶意构造的字典文件，可能会在目标系统上留下痕迹或触发其他安全问题。
*   **UTF-8编码风险:**  PoC提及了Wordlist需要UTF-8编码，如果编码不正确，可能导致破解失败，但不会直接造成安全风险。

基于上述分析，投毒风险较低，大约在10%左右。

**利用方式:**

1.  **确定目标:** 找到运行CMS Made Simple <= 2.2.9且启用了News模块的网站。
2.  **构造恶意URL:**  构造包含时间盲注SQL语句的URL，将恶意SQL注入到`m1_idlist`参数中。 URL通常形式为：`http://target/moduleinterface.php?mact=News,m1_,default,0&m1_idlist=[SQL注入 Payload]`
3.  **提取Salt和Password:**  利用时间盲注，逐步提取管理员密码的Salt和哈希值。
4.  **密码破解:**  使用字典和提取到的Salt，对哈希密码进行破解。
5.  **权限获取:**  使用破解的密码登录后台，获得管理员权限。

**项目地址:** [e-renna/CVE-2019-9053](https://github.com/e-renna/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)