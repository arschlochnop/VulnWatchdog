## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` HTTP Header 来绕过中间件中的授权检查。根据提供的漏洞利用代码，发送带有特定 `x-middleware-subrequest` 头的请求可以直接绕过原本应该返回 403 错误的访问限制，返回 200 OK。漏洞利用方式简单，只需要发送带有特定header的HTTP请求。

**有效性：**  提供的POC代码有效，可以通过发送带有 `x-middleware-subrequest` 头的请求来绕过授权。

**投毒风险：**  提供的漏洞利用代码主要包含Demo程序，license，说明文档和一些配置文件，用于重现漏洞，风险较低。其中虽然包含一些依赖，但是在 package-lock.json 文件中都被锁定到特定版本，所以投毒风险较低， 评估为10%。

**利用方式：**
1.  攻击者发送包含特定 `x-middleware-subrequest` 头的HTTP请求。
2.  Next.js 应用的中间件处理请求时，由于漏洞的存在，未能正确执行授权检查。
3.  攻击者成功绕过授权，访问原本受保护的资源。

**项目地址:** [fourcube/nextjs-middleware-bypass-demo](https://github.com/fourcube/nextjs-middleware-bypass-demo)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)