## CVE-2022-21449 - Java ECDSA Psychic Signatures

**漏洞编号:** CVE-2022-21449

**漏洞类型:** 身份验证绕过

**影响应用:** Oracle Java SE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，可能导致未经授权的数据访问、修改或删除

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 应用程序使用受影响的Java版本进行ECDSA签名验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21449 漏洞源于 Java ECDSA (Elliptic Curve Digital Signature Algorithm) 签名验证算法中的缺陷，被称为 "Psychic Signatures"。攻击者可以构造一个特殊的、无效的签名（例如，所有字节都为零的签名），Java 在验证时会错误地将其视为有效的签名，从而绕过身份验证。

**有效性：**
提供的POC代码使用 `elliptic` 这个nodejs 库生成 ECDSA 签名，看起来是用于生成利用此漏洞所需的特定格式的签名。它通过 `npm install` 安装依赖，然后执行 `node index.js` 生成签名。  README 指向了一个可能存在漏洞的示例应用 Datadog security lab pocs。因此该POC是有一定效力的。

**投毒风险：**
查看提供的`index.js`、`package-lock.json`和`README.md` 文件，有潜在的投毒风险。

1.  **依赖项修改:** `package-lock.json`文件明确显示依赖于`davwwwx/elliptic`的fork版本，而不是官方的`elliptic`包。虽然作者在README中也指出了这一点，但是这仍然是一个值得关注的点，因为攻击者可能已经修改了这个fork的版本，以便在不知情的情况下引入后门或其他恶意代码。

2.  **代码审查难度增加：** 使用非官方的库会增加代码审查的难度，因为审查人员需要检查这个fork版本的代码，以确保它没有包含任何恶意代码。此外，这个fork版本的代码可能与官方版本存在差异，这可能会导致一些意想不到的问题。

3.  **维护问题：** 使用非官方的库可能会导致维护问题，因为这个库可能不会像官方库那样及时更新和维护。这可能会导致一些安全问题或兼容性问题。

但是综合来看，该漏洞的利用依赖于 java 本身的漏洞，而非依赖包，所以投毒风险较低

**利用方式：**

1.  **网络访问：** 漏洞描述说明攻击者可以通过网络访问触发漏洞。
2.  **构造恶意请求：**  攻击者需要构造包含恶意ECDSA签名的请求，该签名会被Java应用程序错误地验证通过。
3.  **身份验证绕过：** 通过成功利用该漏洞，攻击者可以绕过身份验证，并以未经授权的身份执行操作。
4.  **数据篡改/访问：**  成功利用该漏洞可能导致未经授权的创建、删除或修改关键数据。

**项目地址:** [davwwwx/CVE-2022-21449](https://github.com/davwwwx/CVE-2022-21449)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)