## CVE-2023-41425 - WonderCMS XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本攻击 (XSS) -> 远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 3.2.0 - 3.4.2

**利用条件:** 需要管理员用户访问恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425 是 WonderCMS 3.2.0 到 3.4.2 版本中的一个跨站脚本漏洞，可以通过上传恶意脚本来执行任意代码。攻击者可以通过诱骗管理员访问包含恶意 XSS 代码的链接来利用此漏洞，窃取 CSRF token, 然后安装恶意主题，主题包含反向 shell,最终获取服务器的控制权。

**有效性:**
根据漏洞库信息、搜索结果以及漏洞利用代码，提供的PoC代码是有效的，可以成功利用此漏洞实现远程代码执行。

**投毒风险:**
查看 exploit.py , xss.js 和 rev.php, 代码功能正常，未发现明显的恶意代码或后门。

exploit.py：该脚本用于生成 XSS payload、创建恶意链接，并启动一个 HTTP 服务器来托管 payload 和 ZIP 文件。
xss.js：该 JavaScript payload 用于窃取 CSRF token，并使用它来安装包含反向 shell 的恶意主题。
rev.php：这是一个 PHP 反向 shell，用于建立与攻击者机器的连接，接受 lhost 和 lport 参数。

但是，由于 rev.php 最终会在目标机器上执行任意PHP代码，因此存在一定风险：攻击者可能会在 rev.php 文件中植入额外的恶意代码。

综合评估，投毒风险较低（10%），主要集中在 rev.php 文件中，该文件可能包含额外的后门代码。

**利用方式:**
1.  攻击者构造包含恶意XSS代码的URL。
2.  诱骗WonderCMS管理员访问该URL。
3.  XSS代码窃取管理员的CSRF token。
4.  利用窃取的CSRF token，攻击者通过installModule组件安装包含PHP反向shell的恶意主题。
5.  通过访问恶意主题中的反向shell，攻击者触发反向连接，获得服务器的控制权。

**项目地址:** [heraclitan/CVE-2023-41425-WonderCMS-XSS-RCE](https://github.com/heraclitan/CVE-2023-41425-WonderCMS-XSS-RCE)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)