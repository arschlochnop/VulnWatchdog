## CVE-2024-10673-Top_Store-任意插件安装/激活

**漏洞编号:** CVE-2024-10673

**漏洞类型:** 任意插件安装/激活

**影响应用:** Top Store WordPress主题

**危害等级:** 高危，可能导致远程代码执行和权限提升

**影响版本:** <= 1.5.4

**利用条件:** 需要subscriber或更高权限的WordPress账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10673 存在于 Top Store WordPress 主题中，允许具有 Subscriber 权限或更高权限的已认证攻击者安装和激活任意插件。该漏洞是由于 `top_store_install_and_activate_callback()` 函数中缺少权限检查所致。 

**利用方式：**

1.  **登录：** 使用 Subscriber 权限或更高权限的 WordPress 帐户登录到目标网站。
2.  **获取Nonce：** 访问 WordPress 后台的 themes.php 页面以获取用于安装插件的 nonce 值。该POC使用正则表达式从响应中提取nonce。
3.  **版本检测：** 通过访问 `readme.txt` 文件检测主题版本,判断是否小于等于1.5.4
4.  **安装插件：** 使用 admin-ajax.php 接口和 install-plugin 操作，以及获取的 nonce 值，安装恶意插件。
5.  **激活插件：** 使用 admin-ajax.php 接口和 th_activeplugin 操作激活已安装的恶意插件。

**有效性评估：**

提供的PoC代码似乎有效。它实现了漏洞描述中提到的步骤：登录、获取 nonce、安装插件和激活插件。该PoC 利用了 `top_store_install_and_activate_callback` 函数中缺失的权限检查。

**投毒风险分析：**

PoC 代码存在轻微的投毒风险。风险点主要在于：

*   **插件选择：** PoC 允许攻击者安装任意插件。如果攻击者选择的插件本身包含恶意代码，则存在投毒的可能。
*   **网络请求：** 虽然代码本身没有明显的恶意行为，但它依赖于外部网络请求（例如，从 WordPress 插件库下载插件）。如果网络请求被篡改，可能会导致安装恶意插件。

综合考虑，投毒风险约为 10%。


**项目地址:** [Nxploited/CVE-2024-10673](https://github.com/Nxploited/CVE-2024-10673)

**漏洞详情:** [CVE-2024-10673](https://nvd.nist.gov/vuln/detail/CVE-2024-10673)