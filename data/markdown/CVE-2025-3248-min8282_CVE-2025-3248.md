## CVE-2025-3248-Langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 需要网络访问 Langflow 实例，无需身份验证

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-3248 是 Langflow 1.2.0 及更早版本中存在的一个代码注入漏洞。攻击者可以通过向 `/api/v1/validate/code` 端点发送特制的 HTTP 请求来执行任意代码。该漏洞无需身份验证，CVSS 评分为 9.8，属于严重漏洞。根据搜索引擎结果，该漏洞已被积极利用，并被用于部署 Flodrix 僵尸网络。

**有效性分析：**

*   漏洞库信息表明该漏洞允许未经身份验证的远程代码执行。
*   搜索引擎结果确认了该漏洞的存在和积极利用。
*   提供的 PoC 代码尝试利用 `/api/v1/validate/code` 端点，通过构造包含恶意代码的请求来执行系统命令。

综合来看，该漏洞的利用是有效的。

**投毒风险分析：**

PoC 代码中存在一定的投毒风险。尽管代码的主要目的是利用漏洞执行命令，但以下几点值得关注：

1.  **代码混淆：** PoC 代码利用了 Python 的 `exec` 函数和 `raise Exception` 的组合来执行命令，这使得代码的意图可能不太容易被立即理解。攻击者可能利用类似的技术来隐藏恶意代码。
2.  **依赖外部资源：** 尽管没有明确的外部资源依赖，但如果攻击者修改 PoC 代码，使其依赖于外部资源（例如，从远程服务器下载恶意 payload），则可能会引入投毒风险。
3.  **后门植入：** 攻击者可能会修改 PoC 代码，使其在成功利用漏洞后，在目标系统上植入后门，以便后续访问。
4.  **作者署名中的潜在风险：** 署名作者列出引用的代码库。需要进一步确认这些代码库本身是否存在安全风险。

综上所述，PoC 代码存在一定的投毒风险，大约为20%。需要仔细审查代码，确保其安全性，并避免使用来自不可信来源的 PoC 代码。

**利用方式：**

1.  **目标确定：** 找到运行 Langflow 1.2.0 或更早版本的实例。
2.  **构造 Payload：** 构造一个包含恶意 Python 代码的 JSON payload。Payload 需要发送到 `/api/v1/validate/code` 端点。
3.  **发送请求：** 使用 `requests` 库或其他 HTTP 客户端，向目标 Langflow 实例发送 POST 请求，并将构造的 payload 作为请求体。
4.  **代码执行：** Langflow 会执行 payload 中的 Python 代码，从而实现远程代码执行。

PoC 代码中的 payload 如下所示：

```python
"code": f'def eqst_lab(cmd=exec("raise Exception(__import__(\\\"subprocess\\\").check_output(\\\"{cmd}\\\", shell=True))")):\n  pass'
```

该 payload 利用 `exec` 函数执行包含命令的字符串。命令的输出会被捕获，并作为异常信息抛出。

攻击者可以将 `cmd` 变量替换为他们想要执行的任意命令。

**项目地址:** [min8282/CVE-2025-3248](https://github.com/min8282/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)