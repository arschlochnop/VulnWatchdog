## CVE-2019-9978 - Social Warfare WordPress Plugin RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了Social Warfare插件且版本低于或等于3.5.2，攻击者可以访问wp-admin/admin-post.php。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于Social Warfare WordPress插件中，允许未经身份验证的远程攻击者执行任意代码。攻击者利用`swp_debug=load_options`和`swp_url`参数，通过`admin-post.php`向服务器发送包含恶意PHP代码的文件URL。服务器会执行该PHP代码，从而允许攻击者获得服务器的控制权。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，该POC代码是有效的。多个来源表明此漏洞已被公开利用。该POC代码利用了`swp_debug`和`swp_url`参数，通过包含远程文件的方式执行恶意代码，从而获得反向shell。

**投毒风险：**
POC代码中几乎不存在明显的投毒风险，风险值约为1%。代码主要功能是利用漏洞，建立反向shell连接，并没有发现隐藏的恶意功能。主要关注点是用户需要自行配置`ATTACKER_IP`和`LISTEN_PORT`，如果从不可信的来源下载未经审查的POC，仍然存在一定的风险，比如被替换成其他恶意payload。

**利用方式：**
1.  **环境准备：**
    *   攻击者需要一台具有公网IP或可以被目标服务器访问的服务器。
    *   目标服务器上安装了Social Warfare插件，且版本低于或等于3.5.2。
    *   攻击者需要安装Python 3.x和Netcat。
2.  **配置POC代码：**
    *   修改`exploit.py`文件中的`TARGET_URL`为目标WordPress网站的URL。
    *   修改`ATTACKER_IP`为攻击者服务器的IP地址。
    *   修改`LISTEN_PORT`为攻击者服务器监听的端口。
3.  **创建Payload：**
    *   `create_payload()` 函数会在当前目录生成 payload.txt， 包含反向shell payload。
4.  **启动HTTP服务器：**
    *   运行`start_http_server()`函数，在攻击者服务器上启动一个HTTP服务器，用于托管恶意PHP代码文件。
5.  **启动Netcat监听器：**
    *   运行`start_listener()`函数，在攻击者服务器上启动一个Netcat监听器，等待反向shell连接。
6.  **发送Exploit：**
    *   运行`send_exploit()`函数，构造包含恶意PHP代码文件URL的HTTP请求，通过`admin-post.php`发送到目标服务器。 漏洞利用代码会构造一个包含`swp_debug=load_options`和`swp_url`参数的URL，该URL指向攻击者服务器上托管的恶意PHP文件。
7.  **获取Shell：**
    *   如果漏洞利用成功，目标服务器会执行恶意PHP代码，并向攻击者服务器发起反向shell连接。攻击者可以在Netcat监听器中获得一个shell，从而控制目标服务器。

**项目地址:** [Housma/CVE-2019-9978-Social-Warfare-WordPress-Plugin-RCE](https://github.com/Housma/CVE-2019-9978-Social-Warfare-WordPress-Plugin-RCE)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)