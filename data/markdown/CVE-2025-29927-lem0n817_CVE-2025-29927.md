## CVE-2025-29927-Next.js-中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行身份验证，且受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。攻击者可以通过发送包含 `x-middleware-subrequest` 头的特制请求来绕过中间件中的身份验证检查。漏洞存在于Next.js 11.1.4 到 13.5.6，大于 14.0.0 小于 14.2.25，以及大于 15.0.0 小于 15.2.3 的版本。

**利用方式：**

1.  攻击者构造包含 `x-middleware-subrequest: anything` 请求头的HTTP请求。
2.  Next.js应用在中间件中检查用户身份验证。
3.  由于漏洞存在，中间件错误地处理了`x-middleware-subrequest`头，导致身份验证检查被绕过。
4.  攻击者可以访问受保护的资源，而无需进行正确的身份验证。

**有效性：**

提供的代码是一个用于测试此漏洞的环境。它包含一个 Next.js 应用程序，该应用程序使用中间件来保护某些路由。 通过设置cookie判断用户是否登陆.攻击者可以修改请求头 `x-middleware-subrequest` 绕过身份验证。

**投毒风险：**

代码库主要用于演示漏洞，没有明显的恶意代码。潜在的投毒风险较低，大约10%。 风险主要在于该测试环境可能被滥用，修改成攻击载荷，造成更大范围的攻击。例如，在测试环境中添加额外的后门路由或恶意脚本。

**项目地址:** [lem0n817/CVE-2025-29927](https://github.com/lem0n817/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)