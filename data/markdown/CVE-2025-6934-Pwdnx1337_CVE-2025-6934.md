## CVE-2025-6934-Opal Estate Pro-未授权提权

**漏洞编号:** CVE-2025-6934

**漏洞类型:** 未授权提权

**影响应用:** Opal Estate Pro

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员帐户并完全控制 WordPress 站点。

**影响版本:** <= 1.7.5

**利用条件:** Opal Estate Pro 插件版本 <= 1.7.5 且目标 WordPress 站点存在未正确配置的访问控制策略。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6934 是 WordPress Opal Estate Pro 插件（≤ v1.7.5）中的一个严重漏洞。此漏洞允许未经身份验证的攻击者通过向 `/wp-admin/admin-ajax.php?action=opalestate_register_form` 发送特制请求来创建新的管理员帐户。根本原因是注册过程中 **nonce parsing (`opalestate-register-nonce`)** 未被正确验证。这使得攻击者可以绕过正常的注册流程，并直接创建一个具有**管理员权限**的新帐户。

**有效性：**

根据漏洞描述，搜索引擎结果以及漏洞利用代码，该漏洞利用代码是有效的。漏洞利用代码通过发送精心构造的 POST 请求到 `/wp-admin/admin-ajax.php` endpoint，绕过身份验证和权限检查，直接创建一个管理员帐户。

**投毒风险：**

代码中存在一些潜在的风险点，但将其完全判定为“投毒”是不准确的。以下是一些分析：

*   **依赖安装：**  该PoC脚本依赖requests、beautifulsoup4以及urllib3库。安装这些依赖可能存在一定的风险，如果pip源被篡改，可能会安装恶意软件包。但这并非PoC代码本身携带的投毒。
*   **错误处理：**  虽然代码包含 `try...except` 块，但异常处理可能不够完善。某些错误可能导致脚本崩溃，或者无法正常清理临时文件，造成一定程度的混乱。
*   **信息泄露：**  脚本会将成功利用的 URL、用户名、密码和电子邮件保存到 `save.txt` 文件中。如果攻击者的机器被入侵，这些信息可能会被泄露。
*   **User-Agent:** 使用自定义的 User-Agent 可能帮助攻击者识别目标，但是，这并非恶意代码，而是一种常见的渗透测试技术手段。
*  **版本验证绕过:** 攻击者可能会修改PoC脚本，绕过版本验证环节,对高版本进行攻击.版本验证函数`is_vulnerable`存在被绕过的风险.

虽然存在一些潜在风险，但该PoC代码主要功能是实现漏洞利用，没有发现明显的恶意代码（如反弹 shell、植入后门等）。因此，投毒风险较低，大概在5%左右。

**利用方式：**

1.  **确定目标 WordPress 站点运行了受影响的 Opal Estate Pro 插件版本（<= 1.7.5）。**
2.  **构造包含目标站点 URL、管理员用户名、密码和电子邮件地址的 POST 请求。**
3.  **发送 POST 请求到 `/wp-admin/admin-ajax.php?action=opalestate_register_form`。**
4.  **如果请求成功，则使用新创建的管理员帐户登录 WordPress 站点。**

**项目地址:** [Pwdnx1337/CVE-2025-6934](https://github.com/Pwdnx1337/CVE-2025-6934)

**漏洞详情:** [CVE-2025-6934](https://nvd.nist.gov/vuln/detail/CVE-2025-6934)