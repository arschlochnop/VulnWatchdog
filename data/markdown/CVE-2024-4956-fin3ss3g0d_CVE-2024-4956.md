## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问，目标服务器运行受影响版本的 Nexus Repository Manager。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞读取服务器上的任意文件。根据漏洞库信息和搜索结果，该漏洞影响 3.68.1 之前的 Sonatype Nexus Repository Manager 3.x 版本。

**有效性：**
提供的POC代码 `cve-2024-4956.py` 是一个Python脚本，旨在自动化利用此漏洞。它通过构造包含目录遍历序列的URL，尝试访问服务器上的敏感文件。脚本包含以下功能：
    *   指定目标服务器的URL。
    *   指定包含要测试的文件路径列表的文本文件。
    *   使用HTTP代理（可选）。
    *   测试模式以验证漏洞的存在。
    *   指定用于遍历测试的相对路径。
脚本通过替换 `/` 为 `%2F` 来绕过URL编码限制，然后发送HTTP GET请求。根据其设计，该POC代码是有效的。

**投毒风险：**
检查提供的Python代码，发现该脚本主要功能是利用路径遍历漏洞读取文件。脚本本身没有明显的恶意代码，例如反向shell、恶意文件上传等。但是，脚本的作者在README中提供了一个Apache Shiro 1 的Hashcat 模块，并提供了git链接。虽然该模块本身是用于密码破解的工具，但存在被滥用的风险。该repository中LICENSE文件是标准的MIT license，更趋向于正常利用.
代码中存在投毒代码的可能性极低，风险评估为 1%。主要风险来自使用者利用此工具进行非授权的渗透测试。

**利用方式：**
1.  攻击者构造包含路径遍历序列的恶意URL，例如 `http://target/service/local/artifact/maven/content?r=central&g=org.apache.shiro&a=shiro-core&v=1.2.2&p=jar&filepath=../../../../../../etc/passwd`。
2.  Nexus Repository Manager 未正确验证URL中的文件路径，导致攻击者能够访问受限目录之外的文件。
3.  攻击者可以使用此漏洞读取系统文件、配置文件和其他敏感信息。
4.  可以结合其他漏洞，例如shiro的漏洞，来扩大攻击面。

**项目地址:** [fin3ss3g0d/CVE-2024-4956](https://github.com/fin3ss3g0d/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)