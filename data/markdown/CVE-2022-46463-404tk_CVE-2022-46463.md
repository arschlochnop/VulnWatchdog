## CVE-2022-46463-Harbor-未授权访问

**漏洞编号:** CVE-2022-46463

**漏洞类型:** 未授权访问

**影响应用:** Harbor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.X.X to v2.5.3

**利用条件:** Harbor实例可公开访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-46463是Harbor的一个未授权访问漏洞，允许攻击者在未经身份验证的情况下访问公共和私有镜像仓库。根据漏洞库信息和搜索结果，该漏洞影响Harbor v1.X.X到v2.5.3版本。

**有效性：**
提供的POC代码 (`harbor.py`) 旨在利用此漏洞，通过列举public镜像并支持dump操作（类似`docker pull`），从而方便从公开暴露的镜像中查找敏感信息。该代码通过发送未授权的HTTP请求来获取镜像信息，证明了漏洞的有效性。

**投毒风险：**
阅读提供的`harbor.py`代码，主要功能是镜像仓库的枚举与下载，代码功能较为简单，主要是利用未授权访问漏洞。存在少量风险是，如果Harbor实例被攻陷，攻击者可能会篡改镜像内容进行供应链投毒。综合考虑，此仓库本身投毒风险较低。

**利用方式：**
1.  攻击者使用POC代码指定Harbor实例的URL。
2.  POC代码发送HTTP请求到 `/api/search` 或 `/api/v2.0/search` API端点，以列出所有公共镜像。
3.  攻击者可以选择dump特定的镜像或者所有镜像。
4.  POC代码下载镜像的layer。
5.  攻击者可以在下载的镜像中查找敏感信息，如密钥、密码等。
6.  通过 `--tags` 参数可以列出镜像的所有tag，通过 `--history` 从构建历史中获取敏感信息，无需下载镜像。


**项目地址:** [404tk/CVE-2022-46463](https://github.com/404tk/CVE-2022-46463)

**漏洞详情:** [CVE-2022-46463](https://nvd.nist.gov/vuln/detail/CVE-2022-46463)