## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH服务，并允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，从而可能导致远程代码执行 (RCE) 或拒绝服务 (DoS)。

**有效性:**
根据搜索结果和漏洞库信息，此漏洞的PoC是存在的，并且已经被公开。多个来源证实了该漏洞的存在，以及它可能导致远程代码执行。提供的“漏洞利用代码”实际上是一个缓解脚本，旨在通过升级OpenSSH版本或禁用LoginGraceTime来降低风险，而不是一个实际的利用程序。

**投毒风险:**
提供的脚本主要功能是检测并修复漏洞，但仍然存在一定的投毒风险：
*   **依赖外部源：** 脚本使用`apt-get update`和`apt-get install`命令，依赖外部软件源。如果软件源被恶意篡改，可能导致安装恶意软件包。
*   **配置修改：** 脚本会修改`/etc/ssh/sshd_config`文件，存在被恶意利用修改配置的风险。
*   **权限提升：** 脚本需要root权限运行，如果脚本被篡改，可能导致提权攻击。
综合考虑，该脚本存在一定的投毒风险，但主要风险在于依赖的外部源和配置修改，因此投毒风险评估为10%。

**利用方式:**
此漏洞的利用方式是利用 sshd 进程处理信号时的竞争条件。攻击者需要发起大量连接尝试，并在身份验证失败时触发竞争条件。成功触发后，攻击者能够在目标系统上执行任意代码。根据 offsec.com 的博客文章，此漏洞利用机会在某些 glibc Linux 发行版中，能将指令插入堆中。

**项目地址:** [almogopp/OpenSSH-CVE-2024-6387-Fix](https://github.com/almogopp/OpenSSH-CVE-2024-6387-Fix)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)