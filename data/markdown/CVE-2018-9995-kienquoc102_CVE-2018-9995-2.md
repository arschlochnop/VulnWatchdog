## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104 和 DVR4216 设备以及相关品牌 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未经授权的远程访问

**影响版本:** 受影响的 TBK DVR4104 和 DVR4216 系列设备以及其他重新贴牌版本

**利用条件:** 设备需要暴露在网络上，且允许HTTP访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 允许远程攻击者通过发送包含 'Cookie: uid=admin' 头的 HTTP 请求来绕过身份验证。提供的 exploit.py 脚本通过发送带有特制 Cookie 头的 HTTP GET 请求到 `/device.rsp?opt=user&cmd=list` 路径，从而利用此漏洞。成功利用后，脚本会从响应中提取用户名和密码。 虽然主要功能是利用漏洞，但存在轻微的投毒风险，因为脚本来源不明，可能包含未公开的恶意行为，例如搜集额外信息或植入后门。安装脚本需要执行git clone 和 pip install，存在引入恶意依赖的风险。截图展示了成功利用后的信息，但脚本本身的可靠性取决于目标设备的配置和网络环境。

**利用方式：**

1.  **目标识别：** 确定使用受影响的 TBK DVR 或重新贴牌设备的 IP 地址和端口。
2.  **漏洞利用：** 运行 `exploit.py` 脚本，并输入目标设备的 IP 地址和端口。
3.  **身份验证绕过：** 脚本会发送带有 `Cookie: uid=admin` 头的 HTTP 请求，绕过身份验证。
4.  **凭据获取：** 脚本解析响应，提取管理员用户名和密码。
5.  **访问控制：** 使用获得的凭据访问 DVR 设备。

**投毒风险分析：**

虽然该脚本的主要功能似乎是利用 CVE-2018-9995 漏洞，但考虑到脚本来源的可靠性和依赖项潜在的风险，仍存在一定程度的投毒风险。脚本执行未经验证的网络请求，可能导致数据泄露或远程代码执行。因此，在受控环境中进行测试并审查代码是至关重要的。

**项目地址:** [kienquoc102/CVE-2018-9995-2](https://github.com/kienquoc102/CVE-2018-9995-2)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)