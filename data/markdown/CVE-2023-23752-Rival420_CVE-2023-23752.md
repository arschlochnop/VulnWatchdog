## CVE-2023-23752-Joomla-未授权访问

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 未授权访问

**影响应用:** Joomla

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 4.0.0 - 4.2.7

**利用条件:** Joomla网站开启了webservice endpoints且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23752 是 Joomla! 4.0.0 到 4.2.7 版本中存在的一个未授权访问漏洞。由于 webservice endpoints 存在不正确的访问控制，未经身份验证的攻击者可以访问敏感信息。

**有效性：**

根据漏洞信息和搜索引擎结果，提供的 POC 代码是有效的。多个来源（例如 SentinelOne 的博客、Acunetix 的漏洞描述和 GitHub 上的 exploit-CVE-2023-23752 仓库）证实了此漏洞的存在以及利用的可能性。

**利用方式：**

1.  **确定目标 Joomla! 网站的版本：** 确认目标网站是否运行着受影响的 Joomla! 版本（4.0.0 到 4.2.7）。
2.  **利用未授权访问漏洞：** 使用提供的 Python 脚本 `exploit.py`，通过构造特定的 URL（`{url}/api/index.php/v1/{endpoint}?public=true`），访问 webservice endpoints，无需身份验证即可获取用户和配置信息。
3.  **获取敏感信息：** 脚本会尝试获取并显示用户数据（ID、名称、用户名、电子邮件、用户组）和配置数据（站点名称、编辑器、验证码设置、数据库连接信息等）。数据库密码会以高亮形式显示。

**投毒风险：**

查看POC代码,发现部分代码存在风险
*   **`exploit.py`:** 该脚本的主要功能是利用漏洞，获取信息，其主要风险在于未经授权的访问，而不是植入后门或恶意代码。但是因为可以获取数据库密码,所以如果目标数据库使用了弱口令或者默认口令,风险会增加
*   **投毒分析:** 根据对提供的 `exploit.py` 脚本的分析，投毒风险较低，评估为5%。风险主要存在于以下可能性：
    *   **依赖包风险：** `README.md` 中要求安装 `requests` 和 `colorama` 库，如果用户从非官方源安装，可能会引入包含恶意代码的软件包。但是通过pip安装正常情况下不会有问题
    *   **配置信息泄露:** 脚本获取的信息可能包含数据库凭据，如果攻击者成功利用此漏洞，可能会泄露这些凭据。
    *   **潜在的远程代码执行:** 虽然漏洞本身是信息泄露，但如果泄露的数据库凭据被用于进一步的攻击，例如通过数据库执行恶意操作，可能会导致远程代码执行。
    *   **其他风险:** 如果该脚本在使用过程中被修改或与其他恶意脚本结合使用，可能会增加投毒风险。但是就这个脚本本身而言，代码功能简单，逻辑清晰，没有发现明显的恶意代码或后门。

**项目地址:** [Rival420/CVE-2023-23752](https://github.com/Rival420/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)