## CVE-2023-28121 - WooCommerce Payments 插件权限提升漏洞

**漏洞编号:** CVE-2023-28121

**漏洞类型:** 权限提升

**影响应用:** WooCommerce Payments WordPress Plugin

**危害等级:** 高危，允许未授权攻击者获取管理员权限

**影响版本:** <= 5.6.1

**利用条件:** 目标WordPress站点安装并启用了受影响版本的WooCommerce Payments插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-28121 是 WooCommerce Payments WordPress 插件中的一个权限提升漏洞。未经身份验证的攻击者可以利用此漏洞代表提升后的用户（如管理员）发送请求，从而获得对网站的管理员访问权限。

**有效性分析：**

提供的PoC代码通过向 `/wp-json/wp/v2/users` 端点发送POST请求来利用此漏洞。它设置了 `X-WCPAY-PLATFORM-CHECKOUT-USER` header，并包含一个JSON有效负载，该负载定义了新用户的电子邮件、用户名、密码和角色。PoC代码检查HTTP响应代码，如果响应代码为201，则表明已成功创建具有管理员角色的新用户。

根据漏洞描述和PoC代码的逻辑，该PoC代码是有效的，因为它模拟了未经身份验证的攻击者创建管理员帐户的过程。

**投毒风险分析：**

查看提供的PoC代码和README.md文件，未发现任何明显的投毒代码。该代码仅包含用于利用CVE-2023-28121漏洞所需的必要步骤。PoC代码旨在创建具有管理员权限的用户, 本身具有一定的风险,但不是代码投毒。

**利用方式分析：**

1.  **确定目标：** 攻击者首先需要确定一个正在运行且易受攻击的 WooCommerce Payments 插件（版本 5.6.1 及更低版本）的 WordPress 网站。
2.  **发送恶意请求：** 攻击者使用 PoC 代码或类似工具向目标网站的 `/wp-json/wp/v2/users` 端点发送特制的 POST 请求。
3.  **绕过身份验证：** `X-WCPAY-PLATFORM-CHECKOUT-USER` header 允许攻击者绕过身份验证检查。
4.  **创建管理员帐户：**  POST 请求中的 JSON 有效负载定义了新的管理员帐户详细信息（电子邮件、用户名、密码和角色）。
5.  **获得管理员访问权限：** 成功执行此漏洞后，攻击者可以使用新创建的管理员帐户登录 WordPress 网站并完全控制该网站。

**项目地址:** [sug4r-wr41th/CVE-2023-28121](https://github.com/sug4r-wr41th/CVE-2023-28121)

**漏洞详情:** [CVE-2023-28121](https://nvd.nist.gov/vuln/detail/CVE-2023-28121)