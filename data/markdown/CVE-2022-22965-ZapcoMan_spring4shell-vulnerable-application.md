## CVE-2022-22965-Spring4Shell

**漏洞编号:** CVE-2022-22965

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Framework

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** Spring Framework versions 5.3.X prior to 5.3.18+, 5.2.x prior to 5.2.20+ and all old and unsupported versions

**利用条件:** JDK 9+, Tomcat 作为 WAR 部署, 使用Spring MVC或Spring WebFlux

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，评估如下：

**有效性：**
该漏洞利用代码提供了一个可 docker 化的应用程序，容易受到 Spring4Shell 漏洞 (CVE-2022-22965) 的攻击。Dockerfile 使用了特定版本的 Tomcat 镜像 (lunasec/tomcat-9.0.59-jdk11)，该版本在漏洞修复之前。pom.xml 文件配置了 Spring Boot 版本 2.6.3，该版本可能受漏洞影响（具体取决于 Spring Framework 的版本）。构建过程包括使用 Maven 打包应用程序为 WAR 文件，并将其部署到 Tomcat 的 webapps 目录。描述文件也描述这是一个POC。

**投毒风险：**
该 POC 仓库的主要目的是演示 CVE-2022-22965 漏洞。然而，始终存在代码中包含恶意或后门代码的风险，即使作者的意图是良性的。代码中检测到投毒代码的风险较低。风险估计为 10%，原因如下：

*   Dockerfile：它下载了一个指定的tomcat版本，如果该docker存在后门，则存在风险
*   `README.md` 推荐了LunaSec的分支，可以推断是官方的。

**利用方式：**
该漏洞允许未经身份验证的远程代码执行。利用方式涉及操纵类加载器和 servlet 上下文以写入恶意 JSP 文件到 Tomcat 的 webapp 目录中，然后攻击者可以通过发送特定构造的 HTTP 请求来触发该 JSP 文件。

总体而言，该 POC 代码似乎有效，但使用和部署 POC 需要谨慎，尤其是在生产环境中。始终建议在安全隔离的环境中进行测试，并仔细审查代码是否存在潜在的恶意代码。

**项目地址:** [ZapcoMan/spring4shell-vulnerable-application](https://github.com/ZapcoMan/spring4shell-vulnerable-application)

**漏洞详情:** [CVE-2022-22965](https://nvd.nist.gov/vuln/detail/CVE-2022-22965)