## CVE-2018-15473 - OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举目标系统上的有效用户名

**影响版本:** <= 7.7

**利用条件:** 需要网络访问目标SSH服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 存在于 OpenSSH 7.7 及更早版本中，是一个用户枚举漏洞。该漏洞的产生原因是 OpenSSH 在验证用户身份时，对于无效用户的处理存在差异，未及时退出，导致可以通过时间差来判断用户名是否存在。攻击者可以通过发送大量包含不同用户名的认证请求，根据服务器响应时间的不同，来判断哪些用户名是有效的。

**有效性：**
提供的 PoC 代码利用了 CVE-2018-15473 漏洞，其基本原理是使用用户名字典，向目标 SSH 服务发送认证请求，并通过判断响应时间来确定用户是否存在。搜索结果中也存在与此漏洞相关的 Exploit-DB 链接，进一步证明了 PoC 的有效性。

**投毒风险：**
`userenum.py` 脚本的主要功能是循环读取用户名文件，并调用 `45939.py`（一个已知的漏洞利用脚本）来尝试对每个用户进行身份验证。虽然主要功能是利用已知的漏洞，但仍然存在一定的投毒风险，例如：

*   **字典文件替换：** 用户可能使用脚本作者提供的 `usr.txt` 字典文件，该文件可能包含恶意或不常见的用户名，这些用户名如果被大量扫描，可能会触发目标系统的安全警报，或被用来进行其他类型的攻击，例如暴力破解。
*   **脚本修改：** 用户可能修改 `userenum.py` 脚本，例如更改目标 IP 地址或端口，但如果用户在不理解代码的情况下进行修改，可能会引入新的漏洞或错误。
*   **对45939.py的修改：**由于没有`45939.py` 的具体内容, 不能确定是否存在后门。

综合考虑，该仓库中直接包含恶意代码的可能性较低，主要风险在于用户使用不当或未验证的第三方资源。因此，投毒风险评估为 10%。

**利用方式：**
1.  **准备用户名字典：** 攻击者需要准备一个包含常见用户名或目标系统可能使用的用户名的字典文件。
2.  **运行 PoC 脚本：** 使用 `userenum.py` 脚本，指定目标 SSH 服务器的 IP 地址和用户名字典文件。
3.  **分析结果：** 脚本会尝试使用字典中的每个用户名进行身份验证，并根据响应时间或其他特征来判断用户是否存在。
4.  **利用有效用户名：** 攻击者可以利用枚举到的有效用户名进行后续攻击，例如暴力破解密码或其他类型的攻击。

**项目地址:** [GaboLC98/userenum-CVE-2018-15473](https://github.com/GaboLC98/userenum-CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)