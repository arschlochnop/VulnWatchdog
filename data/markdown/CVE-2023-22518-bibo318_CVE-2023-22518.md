## CVE-2023-22518-Atlassian Confluence-未授权重置与管理员创建

**漏洞编号:** CVE-2023-22518

**漏洞类型:** 未授权访问

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，完全丧失机密性、完整性和可用性

**影响版本:** 所有受影响版本 (参考漏洞库信息)

**利用条件:** 需要网络访问Confluence实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518是一个存在于Atlassian Confluence Server和Data Center中的未授权漏洞。未经身份验证的攻击者可以通过此漏洞重置Confluence并创建Confluence实例管理员帐户。利用此帐户，攻击者可以执行Confluence实例管理员可执行的所有管理操作，导致完全丧失机密性、完整性和可用性。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，此漏洞影响所有Confluence Data Center和Server版本，除了已修复的版本。Rapid7等机构也确认了该漏洞正在被利用。提供的PoC代码描述了一种利用方式，通过向`/json/setup-restore.action`端点发送特制的POST请求，可以绕过身份验证并重置Confluence实例。PoC中特别提到了将`synchronous`参数设置为`true`的重要性，这可能是在早期利用尝试中被忽略的一个关键因素。

**利用方式分析：**

1.  **目标端点：**/json/setup-restore.action
2.  **HTTP方法：**POST
3.  **绕过：**利用/json命名空间绕过WebSudoInterceptor的身份验证要求。
4.  **参数：**
    *   `synchronous=true`:  使恢复操作同步执行，这对于成功利用至关重要。
    *   `buildIndex=false`
    *   `file`: 包含恶意恢复数据的ZIP文件，用于创建管理员帐户。
    *   `edit=Upload and import`
5.  **结果：**成功利用此漏洞将允许攻击者创建Confluence实例管理员帐户，从而完全控制Confluence系统。

**投毒风险分析：**

提供的漏洞利用代码主要是一个漏洞分析报告，包含了利用该漏洞的原理和方法，还提供了基于发现的漏洞的利用示例 YAML。其中利用方式是通过上传 ZIP 数据控制confluence。因此，投毒风险主要集中在 ZIP_DATA 文件中，可能包含恶意代码（例如 webshell）。由于无法直接分析 ZIP_DATA 的内容，因此无法给出准确的投毒百分比。给出的10%是基于`exploit-restore.zip` 可能包含恶意代码的可能性进行评估的，即ZIP文件中可能包含植入后门的恶意脚本。


**项目地址:** [bibo318/CVE-2023-22518](https://github.com/bibo318/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)