## CVE-2025-24893 - XWiki Platform 远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** XWiki Platform

**危害等级:** 严重，允许未经身份验证的攻击者执行任意代码

**影响版本:** 5.3-milestone-2 到 15.10.10 和 16.0.0-rc-1 到 16.4.0

**利用条件:** XWiki平台实例可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24893 是 XWiki Platform 中的一个严重漏洞，允许未经身份验证的远程攻击者执行任意代码。根据漏洞库信息和搜索结果，该漏洞位于 `SolrSearchMacros` 中，由于对用户提供的输入验证不足，导致可以注入 Groovy 代码。  

**有效性:**  提供的POC代码 `/tmp/722492d9cb9f99570cb71248ee1260f1/README.md`  表明这是一个远程代码执行漏洞的PoC，针对 XWiki Platform 15.10.10。 根据搜索结果（例如 `https://github.com/ibrahimsql/cve-2025-24893`），存在更完善的利用代码，表明该漏洞是可被利用的。

**投毒风险:** 提供的PoC代码只是一个 `README.md` 文件，没有可执行的代码。但是，`github.com/ibrahimsql/cve-2025-24893` 这样的完整利用仓库可能存在投毒风险。风险评估如下：

*   **低：** 直接投毒，例如恶意修改执行的代码，可能性较低，因为这很容易被发现。但是仍需要review其具体代码。
*   **中：** 依赖项投毒，例如使用包含恶意代码的第三方库，可能性中等。需要检查依赖项列表及其来源的可靠性。
*   **高：** 后门，在正常利用代码之外，添加隐蔽的后门，可能性相对较低，因为维护成本高，且容易暴露。 

由于提供的代码只是一个 README 文件，因此投毒风险较低，评估为 10%。

**利用方式:**

1.  攻击者构造恶意的 HTTP 请求，目标是 XWiki Platform 的 `SolrSearch` 资源。该请求包含经过编码的 Groovy 代码，作为 `text` 参数的一部分。
2.  XWiki Platform 在处理 `SolrSearchMacros` 时，没有正确地对用户提供的 `text` 参数进行过滤或转义，导致 Groovy 代码被执行。
3.  攻击者通过执行 Groovy 代码，可以在 XWiki Platform 服务器上执行任意命令，从而控制整个系统。
4. 搜索结果中的链接给出了可以复现漏洞的URL，例如 `<host>/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28"Hello%20from"%20%2B%20"%20search%20text%3A"%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20`


**项目地址:** [zs1n/CVE-2025-24893](https://github.com/zs1n/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)