## CVE-2025-51482 - Letta RCE

**漏洞编号:** CVE-2025-51482

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Letta-AI Letta

**危害等级:** 高危，允许远程攻击者执行任意Python代码和系统命令

**影响版本:** 0.7.12

**利用条件:** 需要网络访问/v1/tools/run端点，用户交互（需要用户访问恶意链接）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-51482 存在于 Letta-AI Letta 0.7.12 的 letta.server.rest_api.routers.v1.tools.run_tool_from_source 模块中，允许远程攻击者通过精心构造的payload 向 /v1/tools/run 端点发送恶意请求，绕过预期的沙箱限制，执行任意Python代码和系统命令。漏洞利用方式是通过向/v1/tools/run端点提交包含恶意代码的请求。根据CVE描述和搜索结果(gecko.security blog)，该漏洞无需身份验证，但需要用户交互(高危)。

根据漏洞利用代码，其中只包含一个README.md文件，无法直接证明漏洞有效性。但是考虑到CVE描述的明确性以及gecko.security blog描述的存在，漏洞的有效性较高。

README.md文件内容简单，只包含标题，恶意投毒的可能性很低, 但是不排除作者在其他地方隐藏恶意代码，或者该代码依赖其他恶意仓库。因此，存在一定的投毒风险，估计为10%。需要进一步分析项目依赖和代码。

利用方式总结：

1.  攻击者构造包含恶意Python代码的payload。
2.  攻击者将payload发送到letta-ai Letta服务器的/v1/tools/run端点。
3.  服务器执行payload中的恶意代码，导致远程代码执行。

修复建议：参考letta-ai/letta/pull/2630。

**项目地址:** [Kai-One001/Letta-CVE-2025-51482-RCE](https://github.com/Kai-One001/Letta-CVE-2025-51482-RCE)

**漏洞详情:** [CVE-2025-51482](https://nvd.nist.gov/vuln/detail/CVE-2025-51482)