## CVE-2020-16012-Chrome-侧信道信息泄露

**漏洞编号:** CVE-2020-16012

**漏洞类型:** 侧信道信息泄露

**影响应用:** Chrome

**危害等级:** 中危，可能导致跨域数据泄露

**影响版本:** < 87.0.4280.66

**利用条件:** 需要用户访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16012是Google Chrome浏览器中存在的一个侧信道信息泄露漏洞，影响版本低于87.0.4280.66。该漏洞源于图形处理中drawImage()函数的实现缺陷，允许远程攻击者通过精心设计的HTML页面泄露跨域数据。

**有效性：**

根据搜索结果和提供的漏洞利用代码，此漏洞的POC是有效的。aleksejspopovs/cve-2020-16012 GitHub仓库（搜索结果[9]）包含针对此漏洞的POC，该POC通过侧信道攻击CanvasRenderingContext2D.drawImage()函数的实现来提取信息。

提供的代码片段也印证了这一点，它通过测量drawImage()操作的时间来推断信息。它通过反复绘制图像的一小部分，然后测量绘制操作所花费的时间。由于不同像素绘制时间差异，攻击者可以通过分析这些时间差异来重建原始图像，从而实现跨域数据窃取。

**投毒风险：**

评估POC代码中是否存在投毒风险，需要关注以下几个方面：

*   **服务器端脚本（server.py）：** 该脚本接收来自客户端的像素数据，并将其保存到图像中。潜在的投毒点可能包括恶意修改接收到的数据、向服务器写入恶意文件，或执行其他未授权的操作。
*   **客户端脚本（exploit.html）：** 该脚本负责测量drawImage()操作的时间并将数据发送到服务器。潜在的投毒点可能包括窃取用户的其他信息、执行恶意脚本或将用户重定向到恶意网站。

仔细分析代码后，发现以下几点：

*   客户端（`exploit.html`）通过POST请求将像素数据发送到服务器，服务器端（`server.py`）将这些数据拼接到一起形成图片。
*   客户端和服务端都相对简单，主要功能是复现漏洞，没有明显恶意代码，但仍存在被利用的可能。
*   服务端缺乏对上传数据的严格校验，可能存在被恶意利用的空间。

综合来看，**投毒风险较低，约为10%**。主要风险集中在服务器端对接收到的数据缺乏严格验证，可能被用于执行拒绝服务攻击，或者写入恶意构造的图像文件，但这些风险可以通过安全编码实践来降低。

**利用方式：**

1.  攻击者搭建一个恶意网站，其中包含利用CVE-2020-16012漏洞的HTML页面（exploit.html）。
2.  用户使用受影响的Chrome版本（低于87.0.4280.66）访问该恶意网站。
3.  恶意网站上的JavaScript代码利用drawImage()函数的侧信道信息泄露漏洞，通过测量绘制操作的时间来提取目标网站上的像素信息。
4.  提取到的像素信息被发送到攻击者控制的服务器（server.py）。
5.  攻击者通过分析接收到的像素信息来重建原始图像，从而窃取跨域数据。

**项目地址:** [helidem/CVE-2020-16012-PoC](https://github.com/helidem/CVE-2020-16012-PoC)

**漏洞详情:** [CVE-2020-16012](https://nvd.nist.gov/vuln/detail/CVE-2020-16012)