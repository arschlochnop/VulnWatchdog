## CVE-2019-7139-Magento-SQL注入

**漏洞编号:** CVE-2019-7139

**漏洞类型:** SQL注入

**影响应用:** Magento

**危害等级:** 高危，可能导致数据泄露

**影响版本:** Magento Open Source <= 1.9.4.0, Magento Commerce <= 1.14.4.0, Magento 2.1 <= 2.1.16, Magento 2.2 <= 2.2.7, Magento 2.3.0

**利用条件:** 需要未授权网络访问到Magento实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-7139 存在于 Magento 多个版本中，是一个未经身份验证的 SQL 注入漏洞。攻击者可以通过访问 `/catalog/product_frontend_action/synchronize` 路径，并构造恶意的 `type_id` 和 `ids` 参数，将恶意 SQL 语句注入到数据库查询中。漏洞利用代码首先通过 `find_test_method` 函数尝试判断是否存在报错注入或者时间注入，然后根据判断结果选择相应的注入方法。攻击者可以利用此漏洞读取数据库中的敏感信息，例如用户名、密码等。POC代码的LICENSE作者声明为2025年,但是漏洞是2019年,存在一定的可疑性,该POC可能存在恶意的重定向请求或者文件篡改，因此评定有10%的投毒风险。

**漏洞利用方式：**

1.  **确定目标 Magento 版本：** 通过服务器指纹或 Magento 版本识别信息确定目标版本。
2.  **构造恶意请求：** 构造包含 SQL 注入 payload 的 HTTP GET 请求，发送到 `/catalog/product_frontend_action/synchronize` 接口。
3.  **提取数据：** 根据报错信息或时间延迟判断注入是否成功，并逐步提取数据库中的敏感数据。

**防范措施：**

*   升级 Magento 版本到安全版本（>= 2.1.18, >= 2.2.9, >= 2.3.2）。
*   安装官方安全补丁。

**项目地址:** [adhammedhat111/Magento-CVE-2019-7139-SQLi-PoC](https://github.com/adhammedhat111/Magento-CVE-2019-7139-SQLi-PoC)

**漏洞详情:** [CVE-2019-7139](https://nvd.nist.gov/vuln/detail/CVE-2019-7139)