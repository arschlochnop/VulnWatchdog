## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，未授权远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标网站安装了Bricks Builder插件，并且版本小于等于1.9.6，无需用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-25600是WordPress Bricks Builder插件中的一个代码注入漏洞，影响版本小于等于1.9.6。该漏洞允许未经身份验证的攻击者远程执行代码。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的POC代码，可以判断该漏洞利用代码是有效的。漏洞信息明确指出该漏洞为未授权远程代码执行（RCE），并且存在公开的POC代码。搜索引擎结果中也包含了多个关于该漏洞的描述和利用示例。提供的POC代码描述了利用步骤，包括获取nonce，构造恶意请求，以及执行任意命令。

**投毒风险：** 分析POC代码，主要集中在`exploit.py`和`README.md`中的安装和使用说明。`LICENSE`是MIT许可证，本身没有危害。仓库的目的是为了方便利用此RCE，代码逻辑较为清晰，主要功能是发送精心构造的HTTP请求。潜在的投毒风险可能存在于以下方面：

1.  **恶意依赖：** `requirements.txt` 文件可能包含恶意的第三方库，这些库在执行过程中可能被利用进行投毒。但是检查了常用库，没有发现特别之处。
2.  **隐藏的后门：** 虽然代码看起来很简单，但可能存在一些隐藏的后门，例如在处理响应时，插入额外的恶意代码。
3.  **供应链攻击：** 作者可能通过其他方式，例如通过 compromised 的开发环境或工具引入恶意代码。

综合分析，该POC的投毒风险较低，约为5%。这主要是基于以下原因：

*   漏洞利用逻辑相对简单直接，没有复杂的代码结构。
*   公开的漏洞信息和POC代码使得潜在的恶意行为更容易被发现。
*   该漏洞已经公开，许多安全研究人员都在关注和分析该漏洞，恶意行为很难隐藏。

**利用方式：** 利用方式是，攻击者首先访问目标网站，获取nonce。然后，构造包含恶意PHP代码的POST请求，发送到`/wp-json/bricks/v1/render_element`端点。服务器在处理请求时，由于没有充分过滤用户输入，导致恶意PHP代码被执行，从而实现远程代码执行。攻击者可以利用该漏洞执行任意系统命令，控制服务器。

**项目地址:** [ivanbg2004/0BL1V10N-CVE-2024-25600-Bricks-Builder-plugin-for-WordPress](https://github.com/ivanbg2004/0BL1V10N-CVE-2024-25600-Bricks-Builder-plugin-for-WordPress)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)