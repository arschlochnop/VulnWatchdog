## CVE-2015-1635

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft HTTP.sys

**危害等级:** 高危，远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold 和 R2

**利用条件:** 目标服务器需要运行受影响版本的Windows，并且开启HTTP服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-1635 是 Microsoft Windows HTTP.sys 中的一个远程代码执行漏洞。攻击者可以通过构造恶意的 HTTP 请求来触发该漏洞，导致任意代码执行。根据漏洞库信息，该漏洞影响多个 Windows 版本，包括 Windows 7 SP1、Windows Server 2008 R2 SP1、Windows 8、Windows 8.1 和 Windows Server 2012 Gold 和 R2。CISA将该漏洞收录在已知被利用的漏洞目录中（KEV）。

提供的漏洞利用代码是一个 Webbased 并发扫描器，用于检测目标是否存在 CVE-2015-1635 漏洞。它主要是一个测试工具，而不是一个直接的漏洞利用代码。它通过发送特定的HTTP请求来检查服务器是否响应，从而判断服务器是否存在该漏洞。这个工具是使用Erlang编写的，主要功能是并发扫描大量主机。

**有效性：**
该漏洞的PoC代码是有效的，用于检测目标是否存在CVE-2015-1635漏洞。它通过发送特定HTTP请求，来验证服务器是否响应，从而判断服务器是否存在该漏洞。

**投毒风险：**
虽然代码本身主要是一个扫描器，但仍然存在一定的投毒风险。代码中可能隐藏一些恶意功能，例如收集扫描目标的信息、植入后门等。但从提供的代码片段来看，主要功能是扫描，投毒风险较低，估计为 10%。

**利用方式：**
利用方式是，攻击者通过发送特制的 HTTP 请求，请求头中包含一个带有非法范围值的 Range 字段。受影响的 HTTP.sys 组件在处理这个 Range 字段时，会发生整数溢出，导致缓冲区溢出，最终可以执行任意代码。PoC 通过发送特定的 Range 值来触发这个溢出，从而验证漏洞的存在。实际利用中，攻击者可以替换溢出代码为 shellcode，从而实现远程代码执行。

**项目地址:** [technion/erlvulnscan](https://github.com/technion/erlvulnscan)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)