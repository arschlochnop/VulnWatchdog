## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本漏洞(XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户会话劫持、信息泄露或恶意代码执行

**影响版本:**  < 11.109.9999.116

**利用条件:** 需要目标cPanel存在漏洞，且用户访问攻击者构造的恶意链接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-29489是cPanel 11.109.9999.116之前版本中发现的一个跨站脚本(XSS)漏洞。该漏洞源于`cpsrvd`错误页面对`webcall ID`参数的输入验证不足，导致攻击者可以通过构造包含恶意JavaScript代码的URL，当受害者访问该URL时，恶意脚本会在受害者的浏览器中执行。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞的POC代码有效。搜索结果中多个来源确认了该漏洞的存在，并指出可以通过`cpanelwebcall`端点利用XSS漏洞。POC代码通过向目标URL发送包含XSS Payload的请求来验证漏洞是否存在。

**投毒风险：**
代码主要功能为XSS扫描，但存在一定的投毒风险，风险约为5%。
1.  **依赖安装风险：** 引导用户安装`requirements.txt`中的依赖，虽然大部分是常用库，但存在引入恶意依赖的潜在风险，取决于`requirements.txt`文件的内容。
2.  **扫描结果的潜在滥用：** 将扫描到的存在漏洞的站点信息保存在`CVE-2023-29489_Vuln.txt`文件中，如果落入恶意人员手中，可能会被利用进行大规模攻击。
3. **Banner作者署名：** 作者署名AnonGhost + Muslim Hackers，存在一定的政治敏感性，被用于非法用途的可能性相对较高。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，该URL的`cpanelwebcall`参数包含XSS payload，例如`<img src=x onerror="prompt(1)">`。
2.  攻击者诱使用户点击该恶意URL，例如通过钓鱼邮件或社交媒体。
3.  当用户访问该URL时，cPanel的`cpsrvd`处理请求，由于未正确过滤`webcall ID`参数，恶意JavaScript代码会被嵌入到错误页面中。
4.  用户的浏览器执行恶意JavaScript代码，攻击者可以利用XSS漏洞执行各种恶意操作，如窃取Cookie、重定向用户到恶意网站或篡改页面内容。

**项目地址:** [S4muraiMelayu1337/CVE-2023-29489](https://github.com/S4muraiMelayu1337/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)