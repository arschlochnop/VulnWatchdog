## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行（RCE）

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 2.22.x (<2.22.6), 2.23.x (>=2.23.0 <2.23.6), 2.24.x (>=2.24.0 <2.24.4), 2.25.x (>=2.25.0 <2.25.2)

**利用条件:** 默认 GeoServer 安装，可通过网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36401 允许未经身份验证的用户通过构造特制的 OGC 请求来执行远程代码。漏洞原因是 GeoServer 使用的 GeoTools 库不安全地将属性名称作为 XPath 表达式进行评估。攻击者可以通过 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute 请求来利用此漏洞。

提供的POC代码 `CVE-2024-36401.py` 通过发送特制的 WFS GetPropertyValue 请求来利用漏洞。该请求包含一个 `valueReference` 参数，其中包含一个 `exec` 函数，该函数允许执行任意命令。默认POC代码使用 `nc` 命令来反弹 shell。代码中未发现明显的投毒行为。

利用方式：

1.  攻击者向存在漏洞的 GeoServer 实例发送特制的 WFS GetPropertyValue 请求。
2.  请求中的 `valueReference` 参数包含要执行的恶意代码。
3.  GeoServer 将 `valueReference` 中的属性名称传递给 commons-jxpath 库进行评估。
4.  commons-jxpath 库执行恶意代码，导致远程代码执行。

根据搜索引擎结果，此漏洞已经被积极利用，因此POC的有效性非常高。

综上，该POC有效，且未发现明显的投毒风险。利用方式清晰，风险等级为严重。

**项目地址:** [kkhackz0013/CVE-2024-36401](https://github.com/kkhackz0013/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)