## CVE-2022-25173 - Jenkins Pipeline: Groovy Plugin OS 命令注入

**漏洞编号:** CVE-2022-25173

**漏洞类型:** OS 命令注入

**影响应用:** Jenkins Pipeline: Groovy Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2648.va9433432b33c

**利用条件:** 需要 Item/Configure 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-25173 漏洞存在于 Jenkins Pipeline: Groovy Plugin 插件中，受影响版本为 2648.va9433432b33c 及更早版本。该漏洞是由于插件在读取 Pipeline 的脚本文件（通常是 Jenkinsfile）时，对不同的 SCM 使用相同的 checkout 目录，允许攻击者通过精心设计的 SCM 内容，在 Jenkins 控制器上执行任意操作系统命令。攻击者需要拥有 Item/Configure 权限才能利用此漏洞。

**有效性:** 根据漏洞描述和搜索结果，攻击者如果具有 Item/Configure 权限，就可以通过构造恶意的 SCM 内容，在 Jenkins 控制器上执行任意操作系统命令，该漏洞利用的有效性较高。

**投毒风险:** 提供的漏洞利用代码是 workflow-cps-plugin 的 CHANGELOG.md 文件，记录了插件的版本更新日志和修复的bug，其中并没有发现任何恶意代码。因此，可以判断此仓库中不存在作者隐藏的投毒代码的风险较低。

**利用方式:**
1.  攻击者需要拥有 Jenkins 中 Item/Configure 权限。
2.  攻击者创建一个 Pipeline 项目，并配置 SCM (例如 Git)。
3.  攻击者在 SCM 仓库中创建一个包含恶意 OS 命令的 Jenkinsfile。
4.  Jenkins 构建 Pipeline 项目时，会 checkout SCM 仓库中的 Jenkinsfile，并执行其中的恶意 OS 命令。由于漏洞的存在，Jenkins 使用了相同的 checkout 目录，这导致恶意的Jenkinsfile可能会覆盖其他项目的check out目录，导致其它项目也受到攻击。
5.  恶意命令在 Jenkins 控制器上执行，从而导致远程代码执行。

**项目地址:** [shoucheng3/jenkinsci__workflow-cps-plugin_CVE-2022-25173_2646-v6ed3b5b01ff1](https://github.com/shoucheng3/jenkinsci__workflow-cps-plugin_CVE-2022-25173_2646-v6ed3b5b01ff1)

**漏洞详情:** [CVE-2022-25173](https://nvd.nist.gov/vuln/detail/CVE-2022-25173)