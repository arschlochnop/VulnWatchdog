## CVE-2024-4367-PDF.js字体处理类型检查缺失导致任意JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript执行

**影响应用:** Firefox, Firefox ESR, Thunderbird (PDF.js)

**危害等级:** 高危，允许在PDF.js上下文中执行任意JavaScript代码

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 需要用户打开恶意的PDF文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-4367漏洞源于PDF.js在处理字体时缺少类型检查，导致攻击者可以构造恶意的PDF文件，利用该漏洞在PDF.js的上下文中执行任意JavaScript代码。漏洞影响Firefox, Firefox ESR, Thunderbird。 根据搜索结果，GitHub上存在利用此漏洞的POC代码。 提供的漏洞利用代码(README.md)比较简单，仅仅描述了CVE-2024-4367的复现，从该文件来看，投毒的概率较低。但考虑到实际的漏洞利用代码可能在其他文件中，需要进一步分析才能确定是否存在投毒行为。漏洞利用方式是通过精心构造的PDF文件触发字体处理过程中的类型检查缺失，从而执行恶意JavaScript代码。CVSS评分根据NVD的变更记录，从原来的CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L修改为了NIST AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H, 这表明利用条件变的容易，危害性更高了。另外，有讨论表明115.19.0esr仍然受此漏洞影响，需要进一步验证。

**项目地址:** [Scivous/CVE-2024-4367-npm](https://github.com/Scivous/CVE-2024-4367-npm)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)