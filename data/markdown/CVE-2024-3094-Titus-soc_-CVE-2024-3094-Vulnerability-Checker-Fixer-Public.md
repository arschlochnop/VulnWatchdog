## CVE-2024-3094-xz-utils-供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 极高危，可能导致未经授权的远程访问和控制

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 受影响的版本被集成到Linux发行版，且sshd等服务链接到受感染的liblzma库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094是xz-utils工具中的一个供应链后门漏洞。攻击者通过复杂的混淆手段，将恶意代码注入到xz-utils的tarball中。该恶意代码会在构建过程中被提取并修改liblzma库的关键函数。受感染的liblzma库可能被sshd等服务链接，导致未经授权的远程访问。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且影响严重。提供的脚本尝试通过升级或降级xz-utils来缓解风险。然而，脚本本身并不能直接验证后门是否被成功利用，它主要目标是移除或替换存在后门的版本。

**投毒风险：**
该脚本本身看起来像是用于缓解CVE-2024-3094的工具。虽然脚本尝试从sourceforge下载xz-5.4.6.tar.bz2，存在一定的潜在风险（如果sourceforge被攻陷或镜像被篡改）。此外，脚本还包含升级xz-utils到最新版本的逻辑，如果软件源本身包含恶意软件，则脚本会将系统升级到被投毒的版本。总的来说，投毒的风险较低，约为10%。

**利用方式：**
1.  **恶意代码注入：** 攻击者通过社交工程等手段，将包含恶意构建脚本和预编译目标文件的受污染的xz-utils源码提交到上游仓库。
2.  **构建过程劫持：**  受污染的构建脚本在构建liblzma库时，会将预编译的恶意目标文件链接到liblzma库中，修改ssh的认证流程。
3.  **SSH后门：**  当sshd等服务链接到受感染的liblzma库时，攻击者可以通过特定的加密连接触发后门，实现未授权的远程访问。
4.  **供应链传播：** 受污染的xz-utils库被打包到Linux发行版中，进一步扩大了攻击范围。

**项目地址:** [Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public](https://github.com/Titus-soc/-CVE-2024-3094-Vulnerability-Checker-Fixer-Public)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)