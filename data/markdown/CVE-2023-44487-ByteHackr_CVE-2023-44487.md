## CVE-2023-44487 HTTP/2 Rapid Reset 拒绝服务攻击

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议实现

**危害等级:** 高危，导致服务器资源耗尽，服务不可用

**影响版本:** 受影响的HTTP/2协议实现，具体版本取决于组件供应商。

**利用条件:** 目标服务器启用了HTTP/2协议，且未采取缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-44487 漏洞是 HTTP/2 协议中的一种拒绝服务攻击，被称为 Rapid Reset。攻击者通过快速建立和重置大量 HTTP/2 流，导致服务器消耗大量资源（CPU、内存），从而使其无法处理正常请求，最终导致服务不可用。

**漏洞利用方式：**

1.  攻击者与目标服务器建立 HTTP/2 连接。
2.  攻击者通过该连接，以极高的速率创建新的 HTTP/2 流 (stream)。
3.  在发送完整请求之前，攻击者立即重置 (reset) 这些流 (发送 RST_STREAM 帧)。
4.  重复步骤 2 和 3，持续发送大量的 RST_STREAM 帧。
5.  服务器在处理这些快速创建和重置的流时，会消耗大量资源，最终导致拒绝服务。

**POC代码分析：**

提供的 C++ 代码尝试进行以下操作：

1.  读取 URL 列表：从输入文件读取需要测试的 URL 列表。
2.  检查 HTTP/2 支持：使用 curl 库检查目标 URL 是否支持 HTTP/2 协议。
3.  发送 RST_STREAM 帧（未完全实现）：代码中 `sendRstStreamH2` 函数未给出具体实现，根据注释，目的是发送 `RST_STREAM` 帧。
4.  输出结果：将测试结果（是否支持 HTTP/2，是否易受攻击）写入输出文件。

**有效性：**

代码的有效性取决于 `sendRstStreamH2` 函数的实现。如果该函数能够按照 HTTP/2 协议规范正确地发送 `RST_STREAM` 帧，并且能够以足够高的速率发送，那么该 POC 代码可以用于验证目标服务器是否存在 CVE-2023-44487 漏洞。

**投毒风险：**

代码本身包含的风险较低，但存在以下几点需要考虑：

*   **缺乏 sendRstStreamH2 函数实现：** 由于缺少关键的攻击载荷，因此需要使用者自行实现，如果使用者在实现过程中引入了恶意代码，则会造成投毒风险。
*   **依赖外部库 curl：** curl 库本身是一个成熟的开源库，但仍然需要关注其是否存在安全漏洞。
*   **代码逻辑简单：** 代码主要用于检测 HTTP/2 支持并尝试发送 RST_STREAM 帧，逻辑较为简单，难以隐藏复杂的恶意代码。

综合来看，投毒风险较低，大约10%。 主要是由使用者自行实现的 sendRstStreamH2 函数部分存在引入恶意代码的风险。


**项目地址:** [ByteHackr/CVE-2023-44487](https://github.com/ByteHackr/CVE-2023-44487)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)