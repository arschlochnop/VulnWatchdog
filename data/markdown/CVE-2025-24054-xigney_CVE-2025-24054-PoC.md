## CVE-2025-24054-NTLM Hash Disclosure Spoofing

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM Hash Disclosure Spoofing

**影响应用:** Microsoft Windows NTLM

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本参见CVE信息

**利用条件:** 需要诱使用户访问恶意共享

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24054是一个Windows NTLM哈希泄露欺骗漏洞。该漏洞允许攻击者通过诱使用户访问攻击者控制的网络共享来捕获用户的NTLM哈希。从搜索结果和漏洞库信息可知，该漏洞正在被积极利用。攻击者通常会使用恶意制作的`.library-ms`文件，当用户打开此文件时，Windows资源管理器会尝试访问指定的网络共享，从而将用户的NTLM哈希发送到攻击者控制的服务器。

**有效性分析：**
提供的Python PoC脚本 `PoC.py` 创建一个恶意的`.library-ms`文件，该文件包含指向攻击者控制的IP地址的共享路径。当受害者打开这个文件时，他们的系统会尝试连接到这个共享，从而暴露出他们的NTLM哈希。
脚本的有效性基于以下几点：
1.  脚本创建了一个格式正确的`.library-ms`文件，其中包含XML描述，指示Windows Explorer尝试连接到指定的UNC路径。
2.  脚本使用`zipfile`模块将`.library-ms`文件压缩到ZIP文件中，这是一种常用的传递payload的方式。

因此，提供的PoC代码是有效的，可以用来触发NTLM哈希泄露。

**投毒风险分析：**
通过对提供的PoC代码进行分析，没有发现任何隐藏的恶意或后门代码。该脚本的功能仅限于创建包含恶意共享路径的`.library-ms`文件。因此，该脚本的投毒风险为0%。

**利用方式分析：**
1.  **攻击者搭建SMB服务器：** 攻击者需要设置一个SMB服务器，该服务器的IP地址将被嵌入到恶意`.library-ms`文件中。
2.  **创建恶意.library-ms文件：** 攻击者使用PoC脚本创建恶意的`.library-ms`文件，指定攻击者的SMB服务器地址。
3.  **诱骗受害者打开文件：** 攻击者通过网络钓鱼或其他社会工程学技巧，诱骗受害者打开创建的`.library-ms`文件。
4.  **捕获NTLM哈希：** 当受害者打开该文件时，Windows资源管理器会尝试连接到攻击者的SMB服务器，并将受害者的NTLM哈希发送过去。
5.  **破解或利用哈希：** 攻击者可以使用哈希破解工具（如Hashcat）尝试破解捕获的NTLM哈希，或者使用Pass-the-Hash技术来冒充受害者。

**项目地址:** [xigney/CVE-2025-24054-PoC](https://github.com/xigney/CVE-2025-24054-PoC)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)