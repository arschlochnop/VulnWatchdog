## CVE-2025-32433-Erlang/OTP SSH 远程代码执行

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行

**影响应用:** Erlang/OTP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** OTP-25.3.2.20之前版本, OTP-26.0-rc1到OTP-26.2.5.11, OTP-27.0-rc1到OTP-27.3.3

**利用条件:** 目标系统运行着受影响版本的Erlang/OTP SSH服务器，且攻击者能够通过网络访问该SSH服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32433是一个存在于Erlang/OTP SSH服务器中的未经身份验证的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码，而无需提供任何凭据。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，此漏洞利用的有效性非常高。漏洞库信息明确指出这是一个未经身份验证的RCE漏洞，CVSS评分为10.0（Critical）。搜索引擎结果中也多次提到该漏洞的严重性以及利用的简易性，多个安全厂商都确认了该漏洞的存在和危害。提供的PoC代码通过模拟SSH协议消息交互，在未进行身份验证的情况下，直接发送包含恶意命令的`SSH_MSG_CHANNEL_OPEN`和`SSH_MSG_CHANNEL_REQUEST`消息，从而实现远程代码执行。

**投毒风险：**
经过对PoC代码的分析，投毒风险较低，但不能完全排除，预估风险10%。
*   `Makefile`：该文件用于交叉编译Go代码到多个平台，本身不包含恶意代码。
*   `README.md`：该文件提供了漏洞的描述、利用方法、环境设置以及漏洞原理的简要说明，其中引用了ProDefense的PoC，未发现恶意内容。
*   `exploit.go`：Go语言编写的漏洞利用代码，用于发送构造的SSH协议消息以触发漏洞，并在目标系统上执行命令。主要功能是将命令行参数传递给`os:cmd`函数执行，存在被滥用的可能。虽然代码本身实现了漏洞利用的功能，但利用过程中可以执行任意命令，如果攻击者替换了`command`变量的内容，可能会造成投毒攻击，例如删除文件、修改配置等。

**利用方式：**
1.  **建立TCP连接:** 首先，攻击者需要与目标Erlang/OTP SSH服务器建立TCP连接。
2.  **SSH Banner交换:**  进行SSH banner信息交换。
3.  **发送SSH_MSG_KEXINIT:** 发送密钥交换初始化消息。
4.  **发送SSH_MSG_CHANNEL_OPEN（预认证）:**  发送通道打开请求消息，绕过身份验证。
5.  **发送SSH_MSG_CHANNEL_REQUEST（预认证）:**  发送通道请求消息，该消息包含要在目标系统上执行的恶意命令。利用`os:cmd()`函数执行命令。

通过构造特定的SSH协议消息，攻击者可以在未经身份验证的情况下，利用`os:cmd()`函数在目标系统上执行任意命令，从而实现远程代码执行。PoC代码提供了两种利用方式：直接执行命令和反向shell。攻击者可以根据实际需求选择合适的利用方式。

**项目地址:** [meloppeitreet/CVE-2025-32433-Remote-Shell](https://github.com/meloppeitreet/CVE-2025-32433-Remote-Shell)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)