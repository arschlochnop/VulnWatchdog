## CVE-2014-6271 - Shellshock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 4.3

**利用条件:** 目标系统使用存在漏洞的Bash版本，且允许通过环境变量影响Bash执行，例如CGI脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271（Shellshock）漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。当Bash执行程序（例如，通过CGI脚本在Web服务器上）时，它会解析这些环境变量，从而导致代码注入。 

**有效性：**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库中明确指出该漏洞允许远程攻击者执行任意代码，搜索结果中也包含大量关于该漏洞的描述、利用案例和补丁信息。提供的Python POC代码也表明该漏洞可以被利用于获取目标系统的反向shell。

**投毒风险：**

分析提供的Python POC代码，风险较低。代码主要功能是构建带有恶意环境变量的HTTP请求，并发送到目标CGI脚本。代码中存在可以植入恶意代码的风险点在于payload的构建部分，但是目前的代码相对简单，仅用于执行反向shell。该仓库的 README 中有明确的测试目标和使用说明，相对比较安全。综上，认为此仓库存在10%的作者隐藏的投毒代码的可能性，该投毒代码可能为隐蔽的下载和执行其他恶意脚本。

**利用方式：**

1.  **确定目标：** 找到运行Bash且容易受到环境变量影响的应用程序或服务。常见的例子包括Web服务器上的CGI脚本。
2.  **构建Payload：** 构造一个包含恶意代码的环境变量。Payload通常包含一个函数定义，后跟要执行的命令。例如：`(){ :; }; echo vulnerable`
3.  **发送Payload：** 将构造的环境变量作为HTTP请求头或其他方式发送到目标应用程序。对于CGI脚本，可以通过User-Agent或其他HTTP头来传递。
4.  **执行代码：** 当目标应用程序调用Bash执行某些操作时，Bash会解析环境变量，从而执行注入的恶意代码。
5.  **反向Shell:** 本次提供的POC中,攻击者设置监听端口,通过漏洞利用,目标主机反弹shell给攻击者,达到控制目标主机的目的.

**风险缓解：**

*   升级Bash到已修复的版本。
*   限制对CGI脚本和其他易受攻击应用程序的访问。
*   验证和清理所有输入，特别是来自环境变量的输入。
*   使用入侵检测系统（IDS）和入侵防御系统（IPS）来检测和阻止Shellshock攻击。

**项目地址:** [b4keSn4ke/CVE-2014-6271](https://github.com/b4keSn4ke/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)