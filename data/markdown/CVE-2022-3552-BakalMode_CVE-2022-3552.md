## CVE-2022-3552-boxbilling-文件上传RCE

**漏洞编号:** CVE-2022-3552

**漏洞类型:** 文件上传RCE

**影响应用:** boxbilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.0.1, 4.22.1.5 (根据 Exploit-DB)

**利用条件:** 需要管理员权限（根据CVE描述），或已认证的会话(根据Exploit-DB)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息，CVE-2022-3552 是 boxbilling/boxbilling 0.0.1 版本之前的 Unrestricted Upload of File with Dangerous Type 漏洞。搜索引擎结果显示，exploit-db 上有针对此漏洞的利用代码，编号为 51108，说明该漏洞存在于 boxbilling <= 4.22.1.5 版本中，并且需要管理员权限或已认证的会话。提供的 Python POC 代码尝试利用此漏洞。代码首先尝试使用提供的用户名和密码登录 BoxBilling 后台。登录成功后，它会构造一个包含 PHP 反向 shell 代码的文件，并尝试将其上传到服务器，从而实现远程代码执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用的有效性较高。漏洞库和搜索结果都确认了此漏洞的存在，并且存在公开的利用代码。POC 代码逻辑清晰，实现了一个完整的利用流程：登录 -> 上传恶意文件 -> 执行反向shell。

**投毒风险评估：**

对提供的 POC 代码进行了详细的分析，未发现明显的投毒代码。该脚本的主要功能是利用文件上传漏洞执行远程命令。风险主要集中在反向 shell 的配置，如果攻击者的 IP 地址被错误配置，可能导致连接失败，但不存在恶意篡改服务器或者窃取信息的行为。因此,可以判断投毒风险较低。

**利用方式分析：**

1.  **登录后台：** 利用提供的用户名和密码，通过 `api/guest/staff/login` 接口尝试登录 BoxBilling 后台。
2.  **构造恶意文件：** 构建一个包含 PHP 反向 shell 代码的文件。反向 shell 会连接到攻击者指定的 IP 地址和端口。
3.  **上传恶意文件：** 利用文件上传功能，将构造的包含反向 shell 的 PHP 文件上传到服务器。
4.  **执行反向 Shell：** 通过访问上传的 PHP 文件，触发反向 shell，从而在服务器上执行任意命令。攻击者可以在其指定的 IP 地址和端口上获得一个 shell，从而控制服务器。

**项目地址:** [BakalMode/CVE-2022-3552](https://github.com/BakalMode/CVE-2022-3552)

**漏洞详情:** [CVE-2022-3552](https://nvd.nist.gov/vuln/detail/CVE-2022-3552)