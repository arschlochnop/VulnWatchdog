## CVE-2019-9053-CMS Made Simple-未授权盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 未授权盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露和权限提升

**影响版本:** <= 2.2.9

**利用条件:** 需要网络访问 CMS Made Simple 并且 News 模块开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中发现的一个漏洞。攻击者可以通过News模块中构造的URL，利用`m1_idlist`参数实现未经身份验证的基于时间的盲注SQL注入。

**漏洞利用有效性：**

*   根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码。
*   PoC代码利用了时间盲注，通过构造特定的SQL查询语句，根据服务器响应时间来判断SQL语句是否执行成功，从而逐步获取数据库中的信息。

**投毒风险：**

*   PoC代码本身主要功能是利用时间盲注提取数据库信息（用户名，密码hash，salt等）。
*   代码存在一定风险，例如使用了`os.system`直接拼接用户输入的命令，虽然本POC中没有直接使用，但如果被修改则可能存在风险。
*   `termcolor`库在显示颜色时可能存在终端兼容性问题，但在安全角度上不构成威胁。
*   总体来看，该PoC的投毒风险较低，主要风险在于被他人修改利用。

**利用方式：**

1.  **确定目标CMS Made Simple版本：** 确保目标版本在受影响的范围内 (<=2.2.9)。
2.  **定位News模块：** CMS Made Simple必须安装并启用了News模块。
3.  **构造恶意URL：** 使用PoC脚本构造包含恶意SQL语句的URL，该SQL语句利用`m1_idlist`参数进行注入。
4.  **执行攻击：** 将构造的URL发送到目标服务器。
5.  **分析响应时间：** 根据服务器的响应时间来判断SQL注入是否成功，并逐步提取数据库中的敏感信息，例如用户名、密码哈希值和salt值。
6.  **破解密码：** 利用提取到的salt值，可以使用字典攻击或彩虹表等方法来破解管理员密码。
7.  **提权：** 获得管理员权限后，攻击者可以控制整个CMS系统，执行任意操作。

**缓解措施：**

*   升级CMS Made Simple到最新版本（>=2.2.10），该版本已经修复了此漏洞。
*   限制对`moduleinterface.php`的访问，或者禁用News模块。
*   使用Web应用防火墙（WAF）来过滤恶意SQL注入请求。

**项目地址:** [zmiddle/Simple_CMS_SQLi](https://github.com/zmiddle/Simple_CMS_SQLi)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)