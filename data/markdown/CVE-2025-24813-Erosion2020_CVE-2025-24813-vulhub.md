## CVE-2025-24813-Apache Tomcat 路径等价和反序列化漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和敏感信息泄露

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 写入已启用默认Servlet,支持部分PUT,针对敏感上传的URL是公共上传URL的子目录,攻击者了解正在上传的安全敏感文件的名称,安全敏感文件也通过部分PUT上传. 或 写入已启用默认Servlet,支持部分PUT,应用程序使用Tomcat基于文件的会话持久化，使用默认存储位置,应用程序包含可能在反序列化攻击中被利用的库

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞（CWE-44）和一个反序列化漏洞(CWE-502)。 根据漏洞库信息和搜索结果，漏洞利用涉及利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 请求处理机制中的缺陷。 

**有效性分析：**
 根据搜索结果，CVE-2025-24813 漏洞已被积极利用。 多个来源（Rapid7, Recorded Future, Akamai, Zscaler, 西オアフ大学, XM Cyber, SonicWall, Esri）证实了这一点。Unit42 的报告也提供了测试该漏洞的信息。 提供的 POC 代码描述简单，是 vulhub 环境的搭建说明，但考虑到其他来源指出漏洞已被积极利用，可以认为存在可用的利用代码。

**投毒风险分析：**
 POC代码仅提供了一个用于搭建vulhub环境的README文档，内容非常简单，只包含 CVE-2025-24813 的 vulhub 环境的 POC 脚本说明。 这种情况下，作者进行恶意代码投毒的可能性很低。 因此，投毒风险评估为1%。

**利用方式分析：**
 根据漏洞描述，存在两种主要的利用方式：
 1. **信息泄露/恶意内容注入：** 如果满足以下所有条件，攻击者能够查看安全敏感文件和/或将内容注入这些文件：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   安全敏感上传的目标 URL 是公共上传目标 URL 的子目录。
    *   攻击者了解正在上传的安全敏感文件的名称。
    *   安全敏感文件也通过部分 PUT 上传。
 2.  **远程代码执行：** 如果满足以下所有条件，攻击者能够执行远程代码：
    *   写入已启用默认 Servlet（默认禁用）。
    *   支持部分 PUT（默认启用）。
    *   应用程序使用 Tomcat 基于文件的会话持久化，使用默认存储位置。
    *   应用程序包含可能在反序列化攻击中被利用的库。

总而言之，漏洞利用依赖于对 Tomcat 服务器的配置和应用程序的特定环境的利用，包括启用的写入权限、对部分 PUT 请求的支持以及应用程序中存在的潜在反序列化漏洞。

**项目地址:** [Erosion2020/CVE-2025-24813-vulhub](https://github.com/Erosion2020/CVE-2025-24813-vulhub)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)