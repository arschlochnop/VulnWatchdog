## CVE-2016-6210-OpenSSH-用户名枚举

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，允许攻击者枚举有效的用户名

**影响版本:** < 7.3

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-6210 存在于OpenSSH 7.3 之前的版本中。当OpenSSH配置为使用 SHA256 或 SHA512 进行用户密码哈希时，对于不存在的用户名，它会使用 BLOWFISH 哈希算法和一个静态密码。攻击者可以通过测量不同用户名的响应时间差异来枚举有效的用户名。由于有效用户名验证过程需要更多计算，所以响应时间会更长。PoC代码 `/tmp/ee73172f02c3f7f43022d33fbf03e286/PoC.py` 通过paramiko库连接到目标SSH服务器，并尝试使用用户名字典中的用户名进行身份验证，发送一个很长的密码。通过多次尝试并计算平均响应时间，可以区分存在的用户和不存在的用户。 `/tmp/ee73172f02c3f7f43022d33fbf03e286/cuangta.py` 也是利用同样的原理进行攻击。

**有效性：**
提供的PoC代码是有效的。它们利用了时间差来枚举用户名。 搜索引擎结果和漏洞库信息都确认了漏洞的存在和利用方式。

**投毒风险：**
`PoC.py` 主要功能是进行时间侧信道攻击以枚举用户名，没有发现明显的恶意代码或后门。
`cuangta.py` 文件同样是利用时间差进行用户名枚举，也没有发现明显的恶意代码或后门。
由于两个脚本都需要用户提供目标IP地址和用户名列表，所以攻击范围受限。

投毒风险评估为5%，主要考虑到以下因素：
* 代码中可能存在不易察觉的漏洞，被攻击者利用。
*  作者可能在代码更新中添加恶意功能。

**利用方式：**
1.  攻击者需要一个目标IP地址和端口，以及一个潜在用户名列表。
2.  攻击者运行PoC代码，指定目标IP地址、端口和用户名列表。
3.  PoC代码会尝试使用用户名列表中的每个用户名连接到目标SSH服务器，并发送一个长密码。
4.  PoC代码测量每个用户名的响应时间，并计算平均响应时间。
5.  通过比较不同用户名的响应时间，攻击者可以确定哪些用户名是有效的。


**项目地址:** [KiPhuong/cve-2016-6210](https://github.com/KiPhuong/cve-2016-6210)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)