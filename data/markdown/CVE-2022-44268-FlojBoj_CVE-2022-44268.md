## CVE-2022-44268-ImageMagick-信息泄露

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露

**影响应用:** ImageMagick

**危害等级:** 中危，可能泄露敏感信息

**影响版本:** 7.1.0-49

**利用条件:** 需要ImageMagick处理恶意构造的PNG图片，且ImageMagick进程有权读取目标文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268 漏洞存在于 ImageMagick 7.1.0-49 版本中。当 ImageMagick 解析恶意构造的 PNG 图片时，可能导致信息泄露。攻击者可以通过构造包含指向任意文件的文本块的 PNG 图片，使 ImageMagick 在处理该图片时将目标文件的内容嵌入到输出图片中。根据POC代码，`exploit.sh`脚本使用 `pngcrush` 工具将 `/etc/hosts` 文件的内容添加到输入的PNG图片中，然后使用 `exiv2` 工具打印输出PNG文件的元数据，从而显示嵌入的文件内容。 `get_data.sh` 脚本则尝试提取嵌入在图像中的数据，并使用 `xxd` 将其转换为原始形式。搜索引擎结果显示该漏洞允许攻击者读取服务器上的任意文件。基于分析，提供的POC代码能够利用此漏洞读取服务器上ImageMagick进程有权限读取的文件，并将内容嵌入到输出的PNG图像中。经分析，提供的脚本和文件内容未发现明显的恶意投毒代码，脚本的目的明确，主要用于利用漏洞读取指定文件内容。

**项目地址:** [FlojBoj/CVE-2022-44268](https://github.com/FlojBoj/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)