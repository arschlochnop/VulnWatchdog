## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 - 1.9.17 (不含1.9.17p1)

**利用条件:** 本地用户权限，sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 存在于 Sudo 1.9.14 到 1.9.17 版本中，允许本地用户通过 `--chroot` 选项和精心构造的 `/etc/nsswitch.conf` 文件来获取 root 权限。

**利用方式：**
1.  创建一个临时目录，作为 chroot 的根目录。
2.  在临时目录下创建 `etc` 目录，并在其中放置恶意的 `nsswitch.conf` 文件。此文件配置了如何解析用户名和组名，攻击者可以利用它来加载任意共享库。
3.  编译一个共享库（`woot1337.so.2`），该库包含在加载时执行的恶意代码（构造函数 `woot()`）。此代码将当前进程的 UID 和 GID 设置为 0（root），然后执行 `/bin/bash`，从而产生一个 root shell。
4.  使用 `sudo -R <chroot目录> <命令>` 命令，其中 `<chroot目录>` 是临时目录的路径，`<命令>` 是任意命令。由于 `nsswitch.conf` 被篡改，sudo 在 chroot 环境中加载恶意共享库，导致代码执行。

**有效性：**
提供的 PoC 代码 `priv_esc.sh` 利用了该漏洞。该脚本创建必要的目录和文件，编译恶意共享库，并使用 `sudo -R` 命令触发漏洞，从而允许本地用户获得 root 权限。搜索引擎结果也表明该漏洞存在公开的 PoC 代码，进一步验证了其有效性。

**投毒风险：**
PoC 代码本身的功能是利用漏洞，并没有明显植入后门的行为。不过，任何代码都存在潜在的投毒风险，特别是当它涉及权限提升时。例如，编译的共享库 `woot1337.so.2` 中的代码可以被修改为执行其他恶意操作，而不仅仅是启动一个 root shell。在`priv_esc.sh`脚本中,`cat > woot1337.c<<EOF`写入的`woot1337.c`文件中,如果作者在`execl("/bin/bash", "/bin/bash", NULL);`中做手脚,例如将shell命令替换成下载运行其他恶意脚本,或者直接写入恶意账户等等.考虑到共享库需要在root上下文中加载,如果成功的话,权限非常高。因此，虽然目前的 PoC 主要演示漏洞利用，但存在潜在的投毒可能性，比如利用 root 权限安装后门、收集信息等。考虑到利用的便捷性, 投毒概率评定为10%.

**项目地址:** [junxian428/CVE-2025-32463](https://github.com/junxian428/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)