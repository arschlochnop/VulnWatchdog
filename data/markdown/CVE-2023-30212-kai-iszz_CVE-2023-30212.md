## CVE-2023-30212 - OURPHP <= 7.2.0 反射型XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户信息泄露、会话劫持等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索结果和漏洞利用代码，该漏洞是一个反射型XSS漏洞，存在于OURPHP <= 7.2.0 版本的 `/client/manage/ourphp_out.php` 文件中。

**有效性：**
提供的POC代码`/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert('xss')</script>` 是有效的。当 `ourphp_admin` 参数设置为 `logout` 时，`out` 参数的值会被直接输出到页面上，而没有经过适当的过滤，导致攻击者可以注入JavaScript代码。

**投毒风险：**
查看提供的漏洞利用代码，主要是Docker镜像的配置和Ourphp的安装步骤，以及XSS漏洞的利用方式。风险点在于getXampp安装包的地址以及Ourphp安装包的地址，如果这些地址被替换为恶意软件包，可能存在投毒的风险。考虑到代码的整体流程是为了复现漏洞，判定存在一定投毒风险，但主要集中在步骤描述以及URL上，恶意代码执行的可能性较低，因此投毒风险估计为10%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，例如 `http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert('xss')</script>`。
2.  攻击者诱导用户点击该URL。这可以通过多种方式实现，例如通过电子邮件、社交媒体等。
3.  用户点击该URL后，恶意JavaScript代码会在用户的浏览器中执行，从而可以实现各种攻击，例如窃取用户的Cookie、重定向用户到恶意网站等。

**项目地址:** [kai-iszz/CVE-2023-30212](https://github.com/kai-iszz/CVE-2023-30212)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)