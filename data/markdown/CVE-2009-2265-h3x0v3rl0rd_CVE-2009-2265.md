## CVE-2009-2265-FCKeditor-目录遍历文件上传

**漏洞编号:** CVE-2009-2265

**漏洞类型:** 目录遍历/任意文件上传

**影响应用:** FCKeditor (Adobe ColdFusion 8.0.1)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.6.4.1 (适用于集成了FCKeditor的Adobe ColdFusion 8.0.1)

**利用条件:** 需要FCKeditor的上传功能开启且未正确配置，以及服务器存在目标目录的写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2009-2265 漏洞是 FCKeditor 2.6.4.1 之前版本中存在的目录遍历漏洞。攻击者可以通过在上传文件的路径中构造包含 `../` 的目录遍历序列，绕过服务器的文件上传限制，将恶意文件上传到任意目录，如果上传的文件是可执行的脚本文件（如 JSP），则可能导致远程代码执行。

**漏洞利用方式：**

1.  **利用点：** FCKeditor 的文件管理器中的 `upload.cfm` 文件处理上传请求时，未正确过滤用户提供的目录参数。
2.  **攻击过程：** 攻击者构造恶意的 POST 请求，其中的 `CurrentFolder` 参数包含目录遍历序列，例如 `/exploit.jsp%00` 绕过后缀检测和文件类型检查，将包含恶意代码的 JSP 文件（shell.jsp）上传到服务器的 `/userfiles/file/` 目录下，然后通过访问 `http://target/userfiles/file/exploit.jsp` 执行恶意代码。
3.  **POC 代码分析：** `upload.py` 脚本自动化了上述攻击过程。它接受目标 IP、端口和 JSP 文件路径作为参数，向目标服务器发送包含恶意目录的 POST 请求，上传 JSP 文件。`README.md` 提供了生成 JSP shell 的命令以及利用脚本的示例。
4.  **有效性评估：** 提供的 POC 代码可以有效利用该漏洞，实现任意文件上传和远程代码执行。
5. **投毒风险:** 查看POC代码内容,代码简单,没有发现作者隐藏的投毒代码,但**不排除**服务器环境部署后被植入后门

**项目地址:** [h3x0v3rl0rd/CVE-2009-2265](https://github.com/h3x0v3rl0rd/CVE-2009-2265)

**漏洞详情:** [CVE-2009-2265](https://nvd.nist.gov/vuln/detail/CVE-2009-2265)