## CVE-2019-19781-Citrix ADC和Gateway目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 需要网络访问Citrix ADC或Gateway服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中的一个目录遍历漏洞。攻击者可以利用此漏洞未经身份验证访问受限目录中的文件。

**有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的PoC代码是有效的。 搜索引擎结果显示该漏洞已被积极利用，并且存在公开可用的exp。

**投毒风险评估：**

提供的PoC代码主要功能是扫描器，通过Shodan API获取Citrix ADC和Gateway的IP地址，然后检查是否存在CVE-2019-19781漏洞。代码中存在以下风险点：

*   依赖于Shodan API，如果API Key被滥用或泄露，可能导致Shodan账户被封禁或产生不必要的费用。
*   `search_query`变量，攻击者可能通过修改此变量来扫描特定目标。

代码本身的功能是验证漏洞，没有发现直接植入后门或恶意代码的痕迹。但是，使用者滥用此代码进行非法扫描或攻击的可能性是存在的。因此，投毒风险较低，约为5%。

**漏洞利用方式：**

1.  攻击者使用Shodan API或其他方法发现暴露在互联网上的Citrix ADC和Gateway实例。
2.  攻击者构造包含目录遍历的恶意URL，例如：`http://<target>/vpn/../vpns/cfg/smb.conf`。
3.  如果目标系统存在漏洞，服务器将返回`smb.conf`文件的内容，攻击者可以读取该文件或其他敏感文件。
4.  通过目录遍历，攻击者可能进一步利用其他漏洞（例如远程代码执行）来控制目标系统。

**项目地址:** [andripwn/CVE-2019-19781](https://github.com/andripwn/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)