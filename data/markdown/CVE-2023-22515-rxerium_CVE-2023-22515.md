## CVE-2023-22515 - Atlassian Confluence 权限绕过/未授权管理员创建

**漏洞编号:** CVE-2023-22515

**漏洞类型:** 权限绕过/未授权访问

**影响应用:** Atlassian Confluence Data Center/Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例公开可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中一个严重的权限绕过漏洞。未经身份验证的攻击者可以利用此漏洞创建未经授权的 Confluence 管理员帐户，从而完全控制受影响的 Confluence 实例。

**有效性：**
根据漏洞信息和搜索结果，该漏洞已被积极利用，并且存在公开可用的PoC利用代码。提供的Nuclei模板用于检测易受攻击的Confluence版本，可以辅助验证漏洞的存在。

**投毒风险：**
提供的Nuclei模板主要用于漏洞检测，其目的是确定Confluence实例是否运行着易受攻击的版本。该模板通过发送HTTP GET请求到Confluence服务器的不同端点（/dologin.action, /, /pages, /confluence, /wiki），并从响应体中提取版本信息。然后，它会将提取的版本与已知的易受攻击的版本列表进行匹配。如果版本匹配，则认为该实例存在漏洞。

分析了该代码，发现投毒风险较低，约为 5%。主要原因如下：
*   **Nuclei 模板的性质：** Nuclei 模板主要设计用于检测漏洞，而不是利用漏洞。它的核心功能是发送请求并根据响应进行匹配，而不是执行恶意操作。
*   **代码的可见性：** 模板代码是公开的，易于审查。任何潜在的恶意代码都会很容易被发现。
*   **模板的简单性：** 该模板的功能相对简单，主要涉及发送 HTTP 请求和进行正则匹配。这降低了隐藏恶意代码的可能性。

然而，仍然存在一些微小的风险：
*   **依赖风险：** Nuclei 依赖于外部库和环境。如果 Nuclei 本身存在漏洞，或者其依赖项被篡改，可能会导致恶意代码的执行。
*   **配置错误风险：** 如果用户配置 Nuclei 不当，例如允许其执行任意代码，可能会增加风险。

总的来说，提供的 Nuclei 模板用于检测 CVE-2023-22515 漏洞的风险相对较低，因为它主要用于漏洞检测，而不是利用。

**利用方式：**
1.  **漏洞发现：** 使用提供的Nuclei模板或其他漏洞扫描工具识别存在CVE-2023-22515漏洞的Confluence实例。
2.  **管理员账户创建：** 攻击者发送特制的HTTP请求到Confluence服务器，绕过身份验证机制，创建一个新的管理员账户。
3.  **权限获取：** 使用新创建的管理员账户登录Confluence，获得对系统的完全控制权。
4.  **恶意行为：** 攻击者可以利用管理员权限执行任意操作，例如：
    *   窃取敏感数据
    *   篡改数据
    *   安装恶意软件
    *   进行拒绝服务攻击

**项目地址:** [rxerium/CVE-2023-22515](https://github.com/rxerium/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)