## CVE-2023-32315-Openfire-认证绕过与RCE

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历/认证绕过/远程代码执行

**影响应用:** Openfire

**危害等级:** 高危，未经授权访问管理控制台并执行任意代码

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务需要运行，并且攻击者需要能够通过网络访问Openfire的管理端口（通常是9090）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞CVE-2023-32315是Openfire管理控制台中存在的路径遍历漏洞，允许未经身份验证的用户绕过身份验证，访问受限页面。利用方式主要分为以下几个步骤：

1.  **认证绕过：** 攻击者利用路径遍历漏洞，通过访问Openfire的Setup Environment绕过认证，访问管理控制台。
2.  **获取JSESSIONID和CSRFToken：** 访问设置页面获取JSESSIONID和CSRFToken, 用于后续创建用户的请求。
3.  **创建管理员用户：**  构造恶意请求，创建一个新的管理员用户。
4.  **插件上传：**  攻击者编译或下载恶意插件。该插件包含一个JSP页面，该页面允许执行任意命令。
5.  **远程代码执行：**  通过管理界面上传恶意插件，然后访问该JSP页面，实现远程代码执行。

**投毒风险分析：**

该POC主要由三部分构成：
*   `CVE-2023-32315-Openfire-Bypass/scan_all` 目录下的 go 代码，用于扫描和验证目标是否存在漏洞。
*   `pom.xml`、`src/` 目录下的代码用于编译恶意的 Openfire 插件，其中包含一个 Webshell，密码为123，功能是执行命令。
*   `README.md` 文件描述了漏洞利用的步骤。

其中 `scan_all` 目录下的 go 代码可能存在投毒风险，例如在扫描过程中执行恶意代码。`src/main/web/cmd.jsp` 是一个webshell，如果被植入恶意代码，也会造成安全风险。但是，从代码本身来看，大部分是漏洞利用代码，少部分代码有可能被用于投毒，因此判定投毒风险为10%。

**项目地址:** [tangxiaofeng7/CVE-2023-32315-Openfire-Bypass](https://github.com/tangxiaofeng7/CVE-2023-32315-Openfire-Bypass)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)