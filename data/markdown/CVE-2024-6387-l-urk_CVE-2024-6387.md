## CVE-2024-6387 OpenSSH regreSSHion 远程代码执行漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** OpenSSH

**危害等级:** 高危，未授权的远程攻击者可以利用此漏洞以 root 权限执行任意代码，或者造成拒绝服务。

**影响版本:** 8.5p1 ~ 9.7p1

**利用条件:** 目标系统使用受影响的 OpenSSH 版本, 并且基于 glibc 的 Linux 系统。需要网络连通性, 且攻击者需要能够发起大量的 SSH 连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387，又名 regreSSHion，是 OpenSSH 服务器中的一个安全回归漏洞，源于 CVE-2006-5051。它是一个信号处理竞争条件漏洞，允许未经身份验证的远程攻击者在基于 glibc 的 Linux 系统上执行任意代码。漏洞的利用方式涉及发起大量的 SSH 连接尝试，触发 sshd 进程中的竞争条件，从而允许攻击者将指令插入堆中，最终实现 RCE。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞是真实存在的，并且存在公开可用的 PoC 代码。PoC 代码的描述也与漏洞描述一致，表明其具有较高的有效性。

**投毒风险：**
提供的 POC 代码库中的 `LISCENCE` 文件声明了严格的权限限制，这在一定程度上增加了投毒的可能性。虽然无法通过现有信息完全确定是否存在投毒代码，但需要对脚本进行仔细审查，特别注意以下几个方面：

*   **shellcode:**  分析 shellcode 的行为，确保其功能与漏洞利用目的相符，没有恶意行为。
*   **网络连接:**  检查代码中是否存在额外的网络连接，特别是连接到未知或可疑的 IP 地址。
*   **文件操作:**  检查代码中是否存在对系统文件的修改或删除操作。
*   **依赖项:**  审查 `requirements.txt` 文件中的依赖项，确保没有引入恶意的第三方库。

考虑到需要大量连接尝试和对堆的操纵，以及许可证的严格声明，综合评估投毒风险为10%。这部分代码逻辑比较复杂，存在隐藏恶意代码的可能性。

**利用方式：**
1.  攻击者通过网络向目标 OpenSSH 服务器发起大量的连接请求。
2.  利用 OpenSSH 服务器处理连接请求时存在的竞争条件，特别是在信号处理方面。
3.  通过精心构造的数据包，将恶意代码注入到服务器的堆内存中。
4.  触发执行注入的恶意代码，从而获得对目标系统的控制权 (RCE) 或导致拒绝服务 (DoS)。
5.  默认的shellcode打开9999端口,并使用nc进行监听。

**项目地址:** [l-urk/CVE-2024-6387](https://github.com/l-urk/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)