## CVE-2024-25641-Cacti-RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.2.27

**利用条件:** 需要具有 "Import Templates" 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-25641 是 Cacti 1.2.27 之前版本中存在的一个远程代码执行漏洞。该漏洞位于 `/lib/import.php` 脚本的 `import_package()` 函数中。具有 "Import Templates" 权限的已认证用户可以通过“Package Import”功能利用此漏洞，在 web 服务器上执行任意 PHP 代码。 

**漏洞利用方式：**

1.  攻击者需要具有 Cacti 实例的有效帐户，并且该帐户必须具有 "Import Templates" 权限。
2.  攻击者构造一个包含恶意 PHP 代码的特制 XML 数据包。该 XML 数据包包含一个指向恶意 php 文件的文件路径，绕过了输入验证。
3.  攻击者使用 Cacti 的“Package Import”功能上传构造的 XML 数据包。
4.  `import_package()` 函数不正确地处理 XML 数据包中的文件内容和文件名，允许攻击者将任意 PHP 代码写入 Cacti 服务器的文件系统。
5.  攻击者可以通过访问上传的 PHP 文件来触发恶意代码的执行，从而在服务器上实现远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的利用已被证实，并且存在公开可用的 PoC 代码 (https://github.com/Safarchand/CVE-2024-25641)。提供的 PoC 代码 `CVE-2024-25641.py` 实现了漏洞利用的完整流程，包括:

*   获取 CSRF token
*   登录 Cacti
*   生成包含恶意 PHP 代码的 XML 数据包
*   上传恶意 XML 数据包

**投毒风险：**

分析 PoC 代码后，发现投毒风险极低。代码的主要功能是生成恶意 XML 文件并上传，目的是为了执行命令。虽然任何代码都存在潜在的风险，但根据目前的分析来看，该仓库的投毒风险较低。主要是因为以下几点：

*   代码功能相对集中且清晰，主要目标是利用漏洞实现 RCE。
*   未发现任何隐藏的恶意功能，如收集用户信息、传播恶意软件等。
*  该PoC 的目的是为了验证漏洞，而不是为了长期潜伏。

 综合评估，该仓库存在的投毒风险极低，但仍需要保持警惕。

**项目地址:** [StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26](https://github.com/StopThatTalace/CVE-2024-25641-CACTI-RCE-1.2.26)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)