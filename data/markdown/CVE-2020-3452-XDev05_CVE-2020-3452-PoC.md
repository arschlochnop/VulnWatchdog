## CVE-2020-3452 Cisco ASA/FTD 目录遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA Software/Cisco Firepower Threat Defense Software

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用了WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-3452 是 Cisco ASA 和 FTD 软件中的一个高危目录遍历漏洞。由于对HTTP请求中的URL输入验证不足，未经身份验证的远程攻击者可以通过发送包含目录遍历字符序列的特制HTTP请求来读取目标设备上Web服务文件系统中的任意文件。该漏洞影响启用了 WebVPN 或 AnyConnect 功能的设备。

**有效性分析：**

根据漏洞库信息和搜索结果，此漏洞是一个经过确认的、高危的目录遍历漏洞，并且存在公开的PoC利用代码。

提供的PoC代码（CVE-2020-3452-PoC.sh）的功能是：

1.  下载一个名为http-vuln-cve2020-3452.nse的Nmap NSE脚本。
2.  将该脚本复制到Nmap的脚本目录（/usr/share/nmap/scripts/）。
3.  从list.txt文件中读取目标IP地址列表，并使用Nmap和下载的NSE脚本对目标IP地址进行扫描，以检测是否存在CVE-2020-3452漏洞。

从代码逻辑来看，该PoC代码是有效的，可以用于检测和利用CVE-2020-3452漏洞。

**投毒风险分析：**

1.  `CVE-2020-3452-PoC.sh`：该脚本主要用于下载并安装Nmap NSE脚本，然后使用该脚本扫描目标主机。虽然存在下载外部脚本的行为，存在一定的风险，但脚本本身没有发现明显的恶意代码。
2.  `README.md`：该文件仅包含脚本的简单说明，没有发现恶意代码。

综合来看，该仓库存在潜在的投毒风险，主要来自下载的`http-vuln-cve2020-3452.nse` 脚本。如果该脚本被篡改，可能包含恶意代码。 下载的脚本会被复制到`/usr/share/nmap/scripts/`，可能会影响其他Nmap扫描行为。 风险较低，约为5%。用户在使用前应仔细审查下载的脚本，以确保其安全性。

**利用方式分析：**

1.  **漏洞触发：** 攻击者需要发送包含目录遍历字符序列的特制HTTP请求。
2.  **利用条件：** 目标设备需要启用WebVPN或AnyConnect功能，否则Web服务文件系统不会启用，漏洞无法利用。
3.  **攻击结果：** 成功利用该漏洞后，攻击者可以读取目标设备上Web服务文件系统中的任意文件，从而获取敏感信息。 但无法访问ASA或FTD系统文件或底层操作系统（OS）文件。

总体来说，该漏洞利用方式简单，风险较高，需要及时进行修复。

**项目地址:** [XDev05/CVE-2020-3452-PoC](https://github.com/XDev05/CVE-2020-3452-PoC)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)