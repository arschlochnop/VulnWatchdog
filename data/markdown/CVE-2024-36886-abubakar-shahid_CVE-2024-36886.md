## CVE-2024-36886

**漏洞编号:** CVE-2024-36886

**漏洞类型:** UAF（Use-After-Free）

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致敏感信息泄露、数据篡改或拒绝服务，甚至远程代码执行

**影响版本:** Linux kernel 4.1 至 6.8.9版本受影响，但已被修复

**利用条件:** 需要目标系统运行受影响的 Linux Kernel 版本，并且攻击者能够发送恶意的 TIPC 消息

**POC 可用性:** 是，但提供的代码仅为漏洞研究报告，需自行编写利用代码

**投毒风险:** 10%

## 详情

CVE-2024-36886 是 Linux Kernel 中 TIPC (Transparent Inter-Process Communication) 模块 reassembly 过程中存在的 UAF 漏洞，位于 `tipc_buf_append()` 函数的错误处理路径中。攻击者可以通过构造恶意的分片 TIPC 消息，触发错误处理流程，导致已经释放的 skb 结构体被再次访问，从而造成 UAF 漏洞。 

**有效性评估：** 根据漏洞信息和搜索结果，此漏洞已经确认存在，并且有利用的可能性。但是，提供的漏洞利用代码实际上是一个 N-Day 漏洞研究报告，并未提供直接可用的 PoC 代码。因此，需要根据漏洞细节自行编写利用代码才能验证。

**投毒风险分析：** 提供的代码仓库主要包含 README.md 和一些文档，用于描述漏洞研究过程。其中并**没有发现明显的恶意代码或后门**。评估投毒风险较低，约为10%。主要风险在于研究报告可能存在不准确或不完整的描述，导致研究人员在复现漏洞时引入错误，或者攻击者在参考该报告开发exp时，因为细节理解偏差而导致攻击失败或者产生其他问题，但并非代码层面的投毒。

**利用方式：** 漏洞的利用方式主要涉及以下步骤：

1.  **触发错误**:  构造恶意的 TIPC 分片消息，例如分片大小错误、分片顺序错误等，目的是触发 `tipc_buf_append()` 函数中的错误处理逻辑。
2.  **释放 skb**: 在错误处理路径中，`skb_release_data` 或 `kfree_skb` 等函数会被调用，释放与该消息关联的 skb 结构体。
3.  **UAF**:  在 skb 结构体释放后，代码中仍存在对其的引用。再次访问该 skb 结构体，导致 UAF 漏洞。
4.  **控制流劫持**:  通过内存布局和堆喷射等技术，在 skb 结构体被释放后，重新分配该内存区域，并填充恶意数据，从而控制程序执行流程，最终实现任意代码执行。

**项目地址:** [abubakar-shahid/CVE-2024-36886](https://github.com/abubakar-shahid/CVE-2024-36886)

**漏洞详情:** [CVE-2024-36886](https://nvd.nist.gov/vuln/detail/CVE-2024-36886)