## CVE-2017-7921-Hikvision摄像头未授权访问

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露、设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启HTTP服务且存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 是 Hikvision 摄像头中存在的未授权访问漏洞。漏洞利用代码显示，攻击者可以通过构造特定的URL（`/System/configurationFile?auth=YWRtaW46MTEK`）绕过身份验证，直接访问设备的配置文件。`download.py` 脚本通过读取 IP 地址列表，循环尝试利用该漏洞下载配置文件。`decrypt.py`脚本用于解密下载的配置文件。攻击者可以从中获取敏感信息，如用户名、密码等。

**利用方式：**

1.  准备目标 IP 地址列表。
2.  运行 `download.py` 脚本，该脚本会尝试下载每个 IP 地址对应的摄像头的配置文件。
3.  如果成功下载了配置文件，则使用 `decrypt.py` 脚本进行解密，获取敏感信息。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的POC代码，可以判断该POC代码是有效的。

**投毒风险：**

虽然主要功能是实现漏洞利用，但是依旧存在一定的投毒风险。例如:

*   `download.py`脚本中的`dowloadSnapshotImg`函数的功能是下载快照图片，存在被修改为下载恶意文件并执行的风险。
*   脚本中使用的硬编码密钥，存在被替换为恶意密钥的风险，导致解密后的配置文件包含恶意内容。
*   `ip` 文件中IP地址的真实性未知。

因此，综合评估，投毒风险为10%。

**项目地址:** [yousouf-Tasfin/cve-2017-7921-Mass-Exploit](https://github.com/yousouf-Tasfin/cve-2017-7921-Mass-Exploit)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)