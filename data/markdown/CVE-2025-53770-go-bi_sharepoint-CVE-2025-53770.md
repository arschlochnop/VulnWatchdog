## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Microsoft SharePoint Enterprise Server 2016, Microsoft SharePoint Server 2019, Microsoft SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中一个严重的反序列化漏洞，攻击者可以通过网络发送特制的请求到存在漏洞的SharePoint服务器，从而执行任意代码。

**有效性：**
根据漏洞描述和搜索结果，该漏洞已在野外被利用，并且存在公开可用的POC代码，证明其有效性。提供的nuclei模板和python上传脚本可以验证漏洞的存在，并上传恶意webshell。

**投毒风险：**
尽管提供的代码看起来主要是利用漏洞，但仍存在一定的投毒风险（10%）。
*   `README.md`中包含多个外部链接，指向不同的博客和教程，这些链接可能包含恶意内容或引导用户执行恶意操作。虽然这些链接本身不构成投毒，但用户在查阅这些资料时需要保持警惕。
* 上传webshell的脚本，可以被修改为上传更加隐蔽的后门代码, 此类投毒难以检测. 建议在使用POC前进行代码审计，确保其行为符合预期。

**利用方式：**
利用方式主要分为以下几步：
1.  **漏洞检测：** 使用 nuclei 模板检测目标 SharePoint 服务器是否存在 CVE-2025-53770 漏洞。检查`/_layouts/15/ToolPane.aspx` 页面是否存在漏洞。
2.  **构建Payload：** 使用提供的 Python 脚本 (`BuildPayload`) 构建恶意 Payload，该 Payload 包含经过多重编码和压缩的 PowerShell 命令，用于在目标服务器上写入 ASPX Webshell。
    *   第一步将上传的webshell进行base64编码。
    *   第二步将第一步生成的base64编码的webshell，嵌入到powershell代码中，对powershell代码进行base64编码。
    *   第三步将第二步生成的powershell代码, 构造为反序列化payload, 进行gzip压缩和base64编码。
    *   第四步将第三步生成payload, 嵌入到aspx代码中，进行URL编码，得到最终的payload。
3.  **发送请求：** 将构建好的 Payload 嵌入到特制的 HTTP 请求中，发送到目标 SharePoint 服务器的 `ToolPane.aspx` 页面。  `DisplayMode=Edit&a=/ToolPane.aspx`
4.  **代码执行：** 服务器在处理该请求时，会反序列化 Payload 中的数据，导致 PowerShell 命令执行，从而将 Webshell 写入到服务器的指定目录（`C:\PROGRA~1\COMMON~1\MICROS~1\WEBSER~1\16\TEMPLATE\LAYOUTS\spinstall0.aspx`）。
5.  **控制服务器：** 攻击者可以通过访问上传的 Webshell，执行任意命令，从而控制目标 SharePoint 服务器。

**项目地址:** [go-bi/sharepoint-CVE-2025-53770](https://github.com/go-bi/sharepoint-CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)