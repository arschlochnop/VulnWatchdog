## CVE-2025-24893-XWiki-SSTI

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 服务器端模板注入 (SSTI)

**影响应用:** XWiki

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 5.3-milestone-2 <= version < 15.10.11, 16.0.0-rc-1 <= version < 16.4.1

**利用条件:** 需要网络访问目标XWiki实例，且未应用补丁或缓解措施。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24893 是 XWiki 平台中的一个服务器端模板注入漏洞 (SSTI)。未经身份验证的攻击者可以通过构造恶意的请求到 SolrSearch 接口来执行任意代码。该漏洞的利用方式是通过向 `/xwiki/bin/view/Main/SolrSearch` 或类似的端点发送包含精心构造的 Groovy 代码的 `text` 参数的 `media=rss` 请求。PoC 代码表明它通过编码恶意 Groovy 脚本来实现远程代码执行。脚本使用 `{{async async=false}}{{groovy}}println("COMMAND".execute().text){{/groovy}}{{/async}}` 这样的 payload 结构，其中 `COMMAND` 是要执行的系统命令。从提供的漏洞库信息来看，该漏洞的 CVSS 评分为 9.8，属于严重级别，表明它很容易被利用，并且影响很大。提供的 PoC 代码包含测试目标是否容易受到攻击的选项、执行单个命令的选项以及启动交互式 shell 的选项。该 exploit 脚本看起来相对简单，旨在有效执行命令。关于投毒风险的评估：在分析 `xwiki_exploit.py` 脚本时，注意到存在对 `/bin/sh` 的调用，用于执行命令，理论上存在通过环境变量污染或其他 shell 注入方式引入恶意行为的可能性。然而，在当前的代码中，没有明显的证据表明作者故意隐藏了投毒代码。投毒的风险可能来自于该漏洞被恶意利用，而非代码本身，或在之后被其他人恶意修改并传播，但就目前提供的代码和信息来看，投毒的可能性较低，因此评估为5%。利用方式总结：

1.  **确定目标 XWiki 实例。**
2.  **使用 PoC 代码（`xwiki_exploit.py`）构造恶意请求。**
3.  **将包含 SSTI payload 的请求发送到 `/xwiki/bin/view/Main/SolrSearch?media=rss&text=[PAYLOAD]` 端点。**
4.  **服务器执行 payload 中的 Groovy 代码。**
5.  **从 RSS 响应中提取命令执行结果。**
6.  **利用执行结果进行后续操作，例如获取敏感信息或建立反向 shell。**

**项目地址:** [gotr00t0day/CVE-2025-24893](https://github.com/gotr00t0day/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)