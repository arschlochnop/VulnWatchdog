## CVE-2025-40778: DNS Cache Poisoning via Additional Records Injection

**漏洞编号:** CVE-2025-40778

**漏洞类型:** DNS Cache Poisoning

**影响应用:** BIND 9

**危害等级:** 高危，可能导致透明钓鱼、企业网络入侵等

**影响版本:** 9.11.0 <= version <= 9.16.50, 9.18.0 <= version <= 9.18.39, 9.20.0 <= version <= 9.20.13, 9.21.0 <= version <= 9.21.12, 9.11.3-S1 <= version <= 9.16.50-S1, 9.18.11-S1 <= version <= 9.18.39-S1, 9.20.9-S1 <= version <= 9.20.13-S1

**利用条件:** 需要目标递归解析器存在漏洞(缺乏严格的bailiwick检查)，且攻击者能够控制或影响权威名称服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-40778 是一个 DNS 缓存投毒漏洞。攻击者可以通过控制的权威名称服务器向递归解析器注入额外的、不属于其授权区域的 DNS 记录。如果递归解析器没有进行严格的 bailiwick 检查，这些恶意记录就会被缓存，导致后续对被投毒域名的查询被重定向到攻击者控制的服务器。利用方式是：

1.  用户查询域名 (例如 www.test.local)。
2.  递归解析器向被攻击者控制的权威名称服务器 (例如 127.0.0.2:5301) 查询。
3.  恶意名称服务器在响应中包含正确的答案 (例如 www.test.local -> 192.168.0.136) 以及额外的恶意记录 (例如 www.bank.com -> 192.168.0.100)。
4.  如果递归解析器未进行严格的 bailiwick 检查，它将缓存这两个记录。
5.  后续对 www.bank.com 的查询将被解析到攻击者控制的 IP 地址 (192.168.0.100)。

攻击场景包括透明钓鱼（用户访问银行网站但被重定向到恶意克隆站点）和企业网络入侵（通过投毒内部域名，拦截凭据、OAuth令牌，或分发恶意软件）。

此markdown文件中未发现明显的投毒代码，但实际利用时需要谨慎验证权威服务器的安全性，避免引入其他风险。

**项目地址:** [nehkark/CVE-2025-40778](https://github.com/nehkark/CVE-2025-40778)

**漏洞详情:** [CVE-2025-40778](https://nvd.nist.gov/vuln/detail/CVE-2025-40778)