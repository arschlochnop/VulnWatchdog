## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，允许远程攻击者执行任意PHP代码

**影响版本:** PHPUnit < 4.8.28 和 PHPUnit 5.x < 5.6.3

**利用条件:** 需要目标服务器运行存在漏洞的PHPUnit版本，并且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 `Util/PHP/eval-stdin.php` 文件中。攻击者可以通过发送以 `<?php` 开头的 HTTP POST 数据到该文件，从而执行任意 PHP 代码。根据搜索引擎结果，此漏洞在过去曾被广泛利用。提供的漏洞利用代码仅包含一个 `README.md` 文件，其中描述了漏洞名称，并没有包含任何可执行的POC代码，因此判断有效性需要其他更详细的POC代码配合验证. 因为没有发现任何除漏洞名称描述外的其他代码，因此判断不存在投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用易受攻击 PHPUnit 版本的 Web 应用程序，并确认 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 路径可以公开访问。
2.  **构造 Payload：** 构造一个包含 PHP 代码的 HTTP POST 请求，该请求以 `<?php` 开头。
3.  **发送请求：** 将构造的 HTTP POST 请求发送到 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`。
4.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。

**项目地址:** [K3ysTr0K3R/CVE-2017-9841-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-9841-EXPLOIT)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)