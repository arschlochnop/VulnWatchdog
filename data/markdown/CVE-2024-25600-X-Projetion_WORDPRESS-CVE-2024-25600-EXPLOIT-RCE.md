## CVE-2024-25600-Bricks Builder-代码注入

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 代码注入

**影响应用:** Bricks Builder

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.6

**利用条件:** 目标WordPress站点安装了受影响的Bricks Builder插件，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25600是一个存在于Bricks Builder插件中的代码注入漏洞。未经身份验证的攻击者可以利用此漏洞注入并执行任意PHP代码，从而完全控制受影响的WordPress站点。

**漏洞利用方式：**

1.  **漏洞触发点：** 漏洞存在于Bricks Builder的`render_element`端点。
2.  **攻击流程：**
    *   攻击者首先需要获取一个nonce值，该值用于绕过初步的安全检查，EXP通过`fetch_nonce`函数获取。
    *   EXP使用`create_element`函数构造一个包含恶意PHP代码的JSON数据。这个JSON数据利用了具有`hasLoop`功能的容器元素，并将恶意的PHP代码插入到`queryEditor`字段中。
    *   攻击者使用POST请求将构造的JSON数据发送到`/wp-json/bricks/v1/render_element` 或 `/?rest_route=/bricks/v1/render_element`端点。
    *   服务器在处理请求时，由于未对`queryEditor`字段进行充分的验证和过滤，导致恶意PHP代码被执行。
3.  **EXP分析：** 提供的`exp.sh`脚本自动化了漏洞利用过程。
    *   `fetch_nonce()` 函数用于从目标URL中提取nonce值。
    *   `create_element()` 函数创建包含恶意代码的JSON payload。
    *   `exploit_successful()` 函数通过发送带有恶意payload的POST请求来验证目标是否易受攻击，成功会返回“Lutfifakee”字符串。
    *   `exploit()`函数遍历paths数组，直到漏洞利用成功。
    *   `interactive_shell()` 函数可以执行交互式命令。

**投毒风险评估：**

该POC脚本主要包含以下功能：

*   获取Nonce
*   构造包含恶意代码的Payload
*   发送Payload到目标端点
*   验证漏洞是否存在
*   执行交互式Shell

EXP 通过Exception的方式输出“Lutfifakee”字符串来验证漏洞，没有发现隐藏的恶意代码，因此投毒风险较低，为0%。

**项目地址:** [X-Projetion/WORDPRESS-CVE-2024-25600-EXPLOIT-RCE](https://github.com/X-Projetion/WORDPRESS-CVE-2024-25600-EXPLOIT-RCE)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)