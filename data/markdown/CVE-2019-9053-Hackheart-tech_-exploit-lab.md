## CVE-2019-9053 - CMS Made Simple - 时间盲注SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS存在News模块，以及能通过URL访问 moduleinterface.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是一个存在于CMS Made Simple 2.2.9及更早版本中的时间盲注SQL注入漏洞。该漏洞位于News模块的`moduleinterface.php`文件中，攻击者可以通过构造恶意的`m1_idlist`参数，利用时间延迟来推断数据库中的信息。

**有效性：**
提供的POC代码是有效的，它使用时间盲注技术来提取数据库中的敏感信息，例如salt、用户名、邮箱和密码哈希。POC代码通过构造包含`SLEEP()`函数的SQL查询，并根据响应时间来判断注入是否成功，从而逐个字符地提取目标数据。

**投毒风险：**
该仓库的投毒风险较低，约为10%。主要风险在于：
1.  README.md 中提到将Python2代码迁移到Python3，并对socket操作进行了修改，虽然说明目的是为了兼容性，但可能存在潜在的恶意代码注入或数据篡改。
2.  由于该漏洞需要与目标CMS进行交互才能确定其是否存在，因此在未经许可的情况下，利用POC进行扫描可能构成非法入侵。

**利用方式：**
1.  攻击者构造包含恶意SQL代码的URL，该URL的目标是CMS Made Simple的`moduleinterface.php`文件，并指定了News模块。
2.  恶意SQL代码被注入到`m1_idlist`参数中，利用SQL的`SLEEP()`函数来引入时间延迟。
3.  攻击者通过观察响应时间来判断SQL注入是否成功。如果响应时间超过预设的阈值，则表明注入成功，反之则失败。
4.  攻击者使用二分法或类似的方法，逐个字符地提取数据库中的信息，例如用户名、密码哈希等。
5.  如果攻击者拥有密码字典，可以使用提取出的salt和密码哈希来破解管理员密码。

**项目地址:** [Hackheart-tech/-exploit-lab](https://github.com/Hackheart-tech/-exploit-lab)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)