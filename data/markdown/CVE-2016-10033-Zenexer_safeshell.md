## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统使用了存在漏洞的PHPMailer版本，并且邮件发送功能使用了受影响的isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-10033 是 PHPMailer 5.2.18 之前版本中 `isMail` 传输方式下 `mailSend` 函数的一个参数注入漏洞。攻击者可以通过构造带有 `\"` (反斜杠双引号) 的 `Sender` 属性，将额外的参数传递给 `mail` 命令，从而执行任意代码。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有多个公开的漏洞利用代码。

**投毒风险：**
提供的漏洞利用代码仓库 `safeshell` 旨在 *预防* 类似于 CVE-2016-10033 和 CVE-2016-10045 的漏洞，而不是利用它们。因此，该仓库本身不存在投毒风险。其提供的文件包括 BSD 2-Clause License 和 README.md，描述了其目的。

**利用方式：**
1.  **确定目标系统使用的PHPMailer版本是否低于5.2.18。**
2.  **找到应用程序中使用PHPMailer发送邮件的地方。**
3.  **构造一个包含恶意代码的 Sender 属性。**  Payload需要包含 `\"` 来进行参数注入，从而执行系统命令。
4.  **触发邮件发送功能，将包含恶意代码的 Sender 属性传递给 vulnerable 的 mailSend 函数，进而通过 shell 命令执行任意代码。**

例如，一个 Payload 看起来可能是这样的: `attacker@example.com -oQ/tmp/ -X/tmp/shell.php`。 这会在 `/tmp/` 目录下创建一个名为 `shell.php` 的文件，其中包含邮件的内容，可能包含webshell或者其他恶意代码。

总而言之，此漏洞允许远程攻击者在目标服务器上执行任意代码，前提是服务器运行的 PHPMailer 版本易受攻击，并且应用程序的配置允许攻击者控制`Sender`属性。

**项目地址:** [Zenexer/safeshell](https://github.com/Zenexer/safeshell)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)