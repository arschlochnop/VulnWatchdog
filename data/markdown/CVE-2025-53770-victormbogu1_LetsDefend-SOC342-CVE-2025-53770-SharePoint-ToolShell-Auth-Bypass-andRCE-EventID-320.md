## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016、SharePoint Server 2019、SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要目标系统运行受影响版本的SharePoint Server，且攻击者能够发送特制的POST请求到`/\_layouts/15/ToolPane.aspx`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个反序列化远程代码执行漏洞。攻击者可以利用此漏洞，通过向 `/\_layouts/15/ToolPane.aspx` 发送特制的 POST 请求，在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞库信息，微软已经意识到此漏洞正在被利用。搜索引擎结果也证实了这一点，多个安全厂商和CISA都发布了关于此漏洞的分析报告和警告。提供的漏洞利用代码（LetsDefend SOC342案例）展示了攻击者如何利用此漏洞，通过发送包含恶意序列化数据的POST请求，绕过身份验证，执行 PowerShell 命令，窃取密钥，并部署WebShell，从而完全控制 SharePoint 服务器。综合来看，提供的POC代码有效。

**投毒风险分析：**
提供的漏洞利用代码来自LetsDefend的实验环境，主要目的是为了安全分析和学习。其中存在少量的投毒风险,主要来自于WebShell(spinstall0.aspx)可能被用于持续控制系统，并执行其他恶意操作。风险占比估计为10%。

**漏洞利用方式：**
1.  攻击者构造恶意的POST请求，目标地址为 `/\_layouts/15/ToolPane.aspx`，该请求包含精心设计的序列化数据。
2.  SharePoint Server 在处理该请求时，由于反序列化漏洞，导致攻击者可以执行任意代码。
3.  攻击者利用执行代码的能力，首先执行PowerShell命令，窃取MachineKeySection密钥。
4.  攻击者使用窃取的密钥编译payload.exe，该payload可能包含恶意代码。
5.  攻击者部署一个WebShell (spinstall0.aspx)，以便后续的控制和利用。

**项目地址:** [victormbogu1/LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320](https://github.com/victormbogu1/LetsDefend-SOC342-CVE-2025-53770-SharePoint-ToolShell-Auth-Bypass-andRCE-EventID-320)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)