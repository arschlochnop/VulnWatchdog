## CVE-2018-13379 - Fortinet FortiOS/FortiProxy SSL VPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标系统开启SSL VPN web portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经过身份验证的攻击者可以通过构造特制的HTTP资源请求下载系统文件。根据漏洞库信息和搜索结果,该漏洞影响多个FortiOS和FortiProxy版本，并且已经被公开利用。提供的Metasploit模块利用代码通过发送包含路径遍历的HTTP请求，尝试读取`/dev/cmdb/sslvpn_websession`文件，该文件包含VPN用户的登录凭证。模块配置选项包括目标主机、端口、SSL设置以及是否保存凭证。漏洞利用的有效性很高，因为该漏洞已被广泛利用且有可用的POC。分析提供的POC代码，未发现任何明显的投毒代码，所有代码都围绕漏洞利用展开，没有发现恶意代码或后门，所以投毒风险评估为0%。利用方式为:攻击者构造包含恶意路径的HTTP请求，发送到目标系统的SSL VPN web portal，从而绕过访问限制，读取敏感系统文件。

**项目地址:** [Zeop-CyberSec/fortios_vpnssl_traversal_leak](https://github.com/Zeop-CyberSec/fortios_vpnssl_traversal_leak)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)