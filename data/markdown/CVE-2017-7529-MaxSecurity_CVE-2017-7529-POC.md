## CVE-2017-7529-Nginx 整数溢出导致信息泄露

**漏洞编号:** CVE-2017-7529

**漏洞类型:** 整数溢出

**影响应用:** Nginx

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 0.5.6 - 1.13.2

**利用条件:** Nginx 开启了 proxy_cache 且受影响版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7529 是 Nginx 范围过滤器模块中的一个整数溢出漏洞，攻击者可以通过构造特殊的 Range 请求头，触发整数溢出，导致 Nginx 返回缓存文件的部分内容，从而泄露敏感信息，比如后端真实IP或者其他缓存内容。

**有效性：**
提供的POC代码 `CVE-2017-7529-POC.py` 看起来有效。它构造了恶意的 Range 请求头，旨在触发整数溢出，利用方式基本符合漏洞原理。代码包含检查目标是否漏洞存在的check函数和执行hexdump查看泄露数据的execute函数。

**投毒风险：**
代码总体来说比较简洁，主要功能是发送恶意请求并解析响应。通读代码，没有发现明显的恶意代码或后门。`buffer = set()` 是用于去重的，避免重复打印相同的内容。`length = int(requests.get(url).headers.get("Content-Length", 0)) + 623` 这里+623的原因大概率是为了溢出。
风险评估：1%。

**利用方式：**
1.  **目标确认：** 确定目标 Nginx 服务器的版本在 0.5.6 到 1.13.2 之间，且启用了代理缓存。
2.  **发送恶意请求：** 使用 POC 代码，指定目标 URL。 POC 代码会构造包含恶意 Range 头的 HTTP 请求。
3.  **获取泄露信息：** 如果服务器存在漏洞，Nginx 会返回状态码为 206 (Partial Content) 的响应，其中包含泄露的缓存文件片段。POC代码会将泄露的数据使用hexdump打印出来。

总的来说，该漏洞利用难度较低，但危害在于可能泄露敏感信息，例如后端服务器 IP 地址或其他缓存的敏感数据。

**项目地址:** [MaxSecurity/CVE-2017-7529-POC](https://github.com/MaxSecurity/CVE-2017-7529-POC)

**漏洞详情:** [CVE-2017-7529](https://nvd.nist.gov/vuln/detail/CVE-2017-7529)