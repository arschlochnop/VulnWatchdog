## CVE-2023-22518 - Atlassian Confluence Improper Authorization

**漏洞编号:** CVE-2023-22518

**漏洞类型:** Improper Authorization

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，可能导致完全的机密性、完整性和可用性丧失

**影响版本:** 所有受影响版本（低于 7.19.16, 8.3.4, 8.4.4, 8.5.3, 8.6.1）

**利用条件:** 目标Confluence服务器未打补丁，且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22518 是一个严重的权限绕过漏洞，影响 Atlassian Confluence Data Center 和 Server 的多个版本。未经身份验证的攻击者可以利用此漏洞重置 Confluence 实例并创建管理员帐户。利用此管理员权限，攻击者可以执行所有管理操作，从而导致完全的信息泄露、数据篡改和拒绝服务。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的利用是有效的。搜索引擎结果显示该漏洞已被积极利用，并与勒索软件攻击相关联（如 C3RB3R 勒索软件）。Rapid7 也确认了漏洞的利用情况。

POC 代码提供了一个 Python 脚本，可以利用该漏洞。它包含必要的参数，如目标域、输出文件、代理和超时，允许用户测试和验证漏洞。

**投毒风险分析：**

代码中可能存在一些细微的投毒风险，尽管作者已经声明仅用于合法目的。例如，`exploit.py` 脚本在没有充分验证目标的情况下发送请求，这可能被滥用以进行未经授权的访问。此外，虽然代码本身没有明显的恶意功能，但攻击者可以修改该代码以包含后门或其他恶意有效负载。

风险评估：10%。风险较低是由于该POC结构比较简单，容易阅读和审计，不容易隐藏恶意代码。

**利用方式分析：**

1.  **权限绕过：** 漏洞允许未经身份验证的攻击者绕过身份验证机制。
2.  **实例重置：** 攻击者可以利用漏洞重置 Confluence 实例到初始状态。
3.  **管理员帐户创建：** 在重置后，攻击者可以创建一个新的管理员帐户。
4.  **完全控制：** 使用新创建的管理员帐户，攻击者获得对 Confluence 实例的完全控制权，能够访问和修改数据、安装恶意软件等。
5. **攻击方式:** 通过发送特定的恶意请求到未授权的接口，触发Confluence实例的重置流程。

**缓解措施：**

*   立即将 Confluence Server 和 Data Center 升级到不受影响的版本（7.19.16 或更高版本，8.3.4 或更高版本，8.4.4 或更高版本，8.5.3 或更高版本，8.6.1 或更高版本）。
*   如果无法立即升级，请应用 Atlassian 提供的临时缓解措施。
*   监控 Confluence 服务器是否存在可疑活动。

**项目地址:** [RevoltSecurities/CVE-2023-22518](https://github.com/RevoltSecurities/CVE-2023-22518)

**漏洞详情:** [CVE-2023-22518](https://nvd.nist.gov/vuln/detail/CVE-2023-22518)