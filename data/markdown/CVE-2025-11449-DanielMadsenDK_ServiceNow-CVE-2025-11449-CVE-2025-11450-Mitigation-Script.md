## CVE-2025-11449-ServiceNow AI Platform-Reflected XSS

**漏洞编号:** CVE-2025-11449

**漏洞类型:** Reflected XSS

**影响应用:** ServiceNow AI Platform

**危害等级:** 中危，可能导致用户浏览器中执行任意代码，窃取敏感信息或进行恶意操作

**影响版本:** Washington DC Patch 10 Hot Fix 7b之前, Xanadu Patch 10 Hot Fix 1a之前, Xanadu Patch 11之前, Yokohama Patch 7 Hot Fix 2a之前, Yokohama Patch 8之前, Yokohama Patch 9之前, Zurich Patch 1 Hot Fix 1a之前, Zurich Patch 2之前, Zurich Patch 3之前, Australia General Availability (GA)之前

**利用条件:** 需要用户点击恶意构造的链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-11449是ServiceNow AI Platform中的一个反射型跨站脚本（XSS）漏洞。该漏洞允许攻击者通过构造包含恶意JavaScript代码的链接，当用户点击该链接时，恶意代码将在用户浏览器中执行。该漏洞影响多个ServiceNow版本，包括Washington DC、Xanadu、Yokohama和Zurich等版本的早期补丁。

提供的POC代码是一个JavaScript脚本，用于检测ServiceNow实例中是否存在受影响的宏（macros）。该脚本会检查`sys_ui_macro`表中是否存在名为`$pwd_verify_email`和`$pwd_verify_personal_data_ui`的宏，并分析这些宏的XML代码，以查找潜在的XSS漏洞模式。

具体来说，脚本会查找以下两种模式：

1.  在`<g:evaluate>`标签之外，使用`${sysparm_...}`、`${HTML:sysparm_...}`或`${JS:sysparm_...}`等模式。
2.  在`<g:evaluate>`标签之内，使用任何`${...sysparm_...}`模式，无论是否有前缀。

如果脚本检测到这些模式，则会认为该宏受到XSS漏洞影响，并记录相关信息。脚本还会尝试生成“修复”后的XML代码，通过使用`${JS,HTML:sysparm_<XYZ>}`来转义`<g:evaluate>`标签外部的输入，并将`<g:evaluate>`内部的`sysparm_`引用替换为`jelly.variable`。

**有效性：**
POC代码**有效**，可以检测目标ServiceNow实例是否受CVE-2025-11449漏洞的影响，并输出受影响的宏的信息。

**投毒风险：**
该POC代码**没有发现投毒代码**。该脚本的主要目的是检测和修复XSS漏洞，而不是注入恶意代码或后门。代码的逻辑清晰，目标明确，功能与漏洞描述一致，没有发现任何可疑或恶意行为。

**利用方式：**
该漏洞的利用方式如下：

1.  攻击者构造一个包含恶意JavaScript代码的URL，并将该URL发送给ServiceNow用户。
2.  用户点击该URL。
3.  ServiceNow服务器将恶意JavaScript代码嵌入到响应页面中，并将该页面发送给用户的浏览器。
4.  用户的浏览器执行恶意JavaScript代码，从而导致XSS漏洞。

攻击者可以通过XSS漏洞执行各种恶意操作，例如窃取用户的cookie、重定向用户到恶意网站、篡改页面内容等。

**修复建议：**
建议ServiceNow用户及时应用官方发布的补丁或升级到不受影响的版本，以修复该漏洞。

**项目地址:** [DanielMadsenDK/ServiceNow-CVE-2025-11449-CVE-2025-11450-Mitigation-Script](https://github.com/DanielMadsenDK/ServiceNow-CVE-2025-11449-CVE-2025-11450-Mitigation-Script)

**漏洞详情:** [CVE-2025-11449](https://nvd.nist.gov/vuln/detail/CVE-2025-11449)