## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1903, 1909 和 Windows Server, version 1903, 1909 (Server Core installation)

**利用条件:** 目标系统开启SMBv3协议，攻击者需要能够访问目标系统的445端口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft Server Message Block 3.1.1 (SMBv3)协议处理特定请求时存在的一个远程代码执行漏洞。该漏洞源于SMBv3协议的压缩功能中存在的缓冲区溢出漏洞。攻击者可以发送特制的SMBv3数据包到目标服务器，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索引擎结果，存在公开可用的PoC代码，且CISA已发出警告，表明未打补丁的系统容易受到攻击。提供的漏洞利用代码描述了一个较为完整的利用流程，包括漏洞扫描、Crash测试、偏移获取、Payload构造和执行等步骤，因此该PoC代码具有较高的有效性。

**投毒风险分析：**
提供的PoC代码主要包含攻击计划和利用步骤的描述文档，没有直接的可执行代码，而是在步骤中引用了GitHub仓库(abdullah098/CVE-2020-0796-Scanner and ZecOps/CVE-2020-0796-RCE-POC)。因此，投毒风险主要存在于被引用的GitHub仓库中，尤其是Payload构建和执行阶段。攻击者可能在Payload中嵌入恶意代码，例如植入后门、窃取敏感信息等。由于无法直接分析这些外部仓库的代码，这里假设存在一定的投毒风险（10%）。实际风险取决于对引用仓库代码的审计结果。

**利用方式：**
1.  **漏洞扫描:** 使用Nmap等工具扫描目标系统，确认445端口开放，且系统版本为受影响版本。
2.  **漏洞验证:**  使用CVE-2020-0796扫描器验证目标系统是否存在漏洞。
3.  **Crash测试:** 发送特制的SMB数据包，触发缓冲区溢出，导致目标系统蓝屏崩溃，验证漏洞的可利用性。
4.  **偏移获取:** 在目标系统上运行特定的脚本，获取适用于该系统版本的内存偏移地址。
5.  **Payload构造:**  根据目标系统的内存偏移地址，构造包含恶意代码的Payload。
6.  **Payload执行:**  通过SMB协议发送构造好的Payload，触发漏洞，在目标系统上执行恶意代码。
7.  **反弹Shell:**  Payload通常包含反弹Shell的代码，攻击者可以通过Netcat等工具监听指定端口，获取目标系统的控制权。

**项目地址:** [maqeel-git/CVE-2020-0796-SMBGhost](https://github.com/maqeel-git/CVE-2020-0796-SMBGhost)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)