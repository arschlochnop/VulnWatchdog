## CVE-2019-9053 - CMS Made Simple SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据库信息泄露

**影响版本:** <= 2.2.9

**利用条件:** 需要目标存在News模块，且允许未授权访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053 存在于 CMS Made Simple 2.2.9 及更早版本的 News 模块中。攻击者可以通过构造包含恶意 SQL 语句的 URL，利用 `m1_idlist` 参数进行未授权的基于时间的盲注 SQL 注入攻击。 

**有效性:**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。多个来源（如 Exploit-DB 和 GitHub 上的公开 exploit）表明该漏洞存在，并且有可用的利用代码。

**投毒风险:**

分析提供的 `exploit.py` 代码，该脚本的功能是利用 SQL 注入漏洞提取 CMS 管理员的 salt、用户名、电子邮件和密码哈希值。如果启用了 `--crack` 选项，它还会尝试使用提供的字典破解密码。 代码较为直接，主要通过构造特殊的URL并分析响应时间来判断SQL注入的结果。

尽管如此，仍然存在一些轻微的投毒风险：

1.  **Wordlist 依赖:** 密码破解功能依赖于用户提供的字典。如果攻击者提供了一个包含恶意条目的字典，可能会误导使用者。
2.  **编码问题:** 虽然脚本尝试处理编码错误，但如果用户提供的字典使用了一种未知的或不兼容的编码，可能会导致脚本崩溃或产生错误的结果。
3.  **时间盲注的复杂性:** 基于时间的盲注容易受到网络延迟和服务器负载的影响。攻击者可能故意引入干扰，使攻击过程变得不可靠。

总的来说，该脚本的投毒风险较低（约为10%），但用户在使用时应谨慎，确保使用可信的字典，并在稳定的网络环境下运行。

**利用方式:**

1.  攻击者构造包含恶意 SQL 语句的 URL，其中 `m1_idlist` 参数是注入点。
2.  脚本发送带有恶意 `m1_idlist` 参数的 HTTP 请求到目标 CMS 系统的 News 模块。
3.  由于是时间盲注，脚本会根据服务器响应的时间长短来判断 SQL 语句的执行结果。例如，使用 `SLEEP()` 函数来引入延迟。
4.  脚本通过不断发送请求，并根据响应时间推断出管理员的 salt、用户名、密码哈希等敏感信息。
5.  如果提供了字典且启用了密码破解选项，脚本会使用提取到的 salt 和密码哈希，尝试进行暴力破解。

**项目地址:** [Azrenom/CMS-Made-Simple-2.2.9-CVE-2019-9053](https://github.com/Azrenom/CMS-Made-Simple-2.2.9-CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)