## CVE-2024-38819-Spring Framework路径遍历

**漏洞编号:** CVE-2024-38819

**漏洞类型:** 路径遍历

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** Spring Framework 5.3.0 - 5.3.40, 6.0.0 - 6.0.24, 6.1.0 - 6.1.13

**利用条件:** 应用程序使用WebMvc.fn或WebFlux.fn提供静态资源

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38819是一个存在于Spring Framework的路径遍历漏洞。受影响的应用程序使用WebMvc.fn或WebFlux.fn来提供静态资源。攻击者可以通过构造恶意的HTTP请求，利用`../`绕过目录限制，访问服务器文件系统中未经授权的文件。  

**漏洞利用方式：**

1.  **确定目标：** 找到使用Spring Framework且启用了静态资源服务的应用程序。
2.  **构造恶意请求：**  发送包含路径遍历序列（例如`..%2F`或`../`）的HTTP请求，尝试访问目标文件。例如，`GET /static/file/../Windows/System32/drivers/etc/hosts`。
3.  **利用限制：**  漏洞利用代码分析表明，某些版本的Spring Framework可能存在过滤规则，例如要求路径遍历序列出现一次。
4. **验证利用:** 根据利用代码提供的linux symbolic link方式，验证漏洞。

**投毒风险分析：**

提供的漏洞利用代码本身主要展示了漏洞原理和PoC，但存在一些潜在的投毒风险：

1.  **依赖项风险：** 如果PoC依赖于外部库，这些库可能包含恶意代码。
2.  **修改PoC：** 攻击者可能修改PoC代码，添加恶意功能，例如反向shell或数据窃取。
3.  **误导性信息：** PoC可能包含误导性信息，导致用户在不了解风险的情况下运行代码。代码作者可能存在隐藏的恶意行为，但概率较低，根据代码和文件内容，投毒风险评估为10%。此10%主要来源于被修改过的POC存在潜在风险。

**总结：**

该漏洞利用PoC有效，因为已经明确展示了在特定配置下如何利用路径遍历漏洞读取任意文件。虽然PoC本身看起来没有明显的恶意代码，但用户在使用任何公开的漏洞利用代码时，始终需要谨慎，仔细审查代码，并确保从可信的来源获取。考虑到依赖风险，二次修改风险和误导性风险, 投毒风险评估为10%。

**项目地址:** [skrkcb2/cve-2024-38819](https://github.com/skrkcb2/cve-2024-38819)

**漏洞详情:** [CVE-2024-38819](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)