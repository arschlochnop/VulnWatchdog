## CVE-2024-34102-Adobe Commerce-XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE

**影响应用:** Adobe Commerce

**危害等级:** 高危，可能导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 需要网络访问，目标服务器需存在未修复的Adobe Commerce实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是 Adobe Commerce 中的一个 XML 外部实体 (XXE) 漏洞。攻击者可以通过发送特制的 XML 文档，其中包含对外部实体的引用，来利用此漏洞。漏洞利用无需用户交互。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞的 CVSS 评分高达 9.8，属于严重级别，并且已经有公开的PoC代码。许多安全厂商和研究人员都确认了该漏洞的存在。CISA 已将此漏洞添加到已知被利用的漏洞列表中，表明此漏洞在现实世界中被积极利用。

**投毒风险：**
PoC 代码中存在一定的投毒风险。主要风险点在于PoC脚本可能包含恶意代码，比如在访问外部实体时，利用恶意服务器进行反向连接或者植入后门等。虽然初步分析未发现明显的恶意行为，但仍需谨慎使用。因为PoC主要目的是为了验证漏洞，可能不会考虑到所有潜在的恶意利用场景。随机字符串生成部分，以及回调url设置和base64编码可能存在隐藏的后门。经过分析，存在投毒代码的概率为10%。

**利用方式：**
1.  攻击者构造恶意的 XML 文档，其中包含对外部实体的引用。
2.  将该 XML 文档发送到存在漏洞的 Adobe Commerce 服务器。
3.  服务器解析 XML 文档时，会尝试解析外部实体。
4.  通过外部实体，攻击者可以读取服务器上的任意文件，甚至执行任意代码。
5.  常见的利用方式是读取服务器上的加密密钥，进而获取管理员权限。

参考信息:
*   漏洞库信息描述了该漏洞的严重性和影响。
*   搜索结果中包含多个安全厂商和研究人员对此漏洞的分析和报告，以及CISA的警告。
*   漏洞利用代码提供了一个PoC，展示了如何利用此漏洞。

**项目地址:** [EQSTLab/CVE-2024-34102](https://github.com/EQSTLab/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)