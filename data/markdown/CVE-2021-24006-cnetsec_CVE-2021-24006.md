## CVE-2021-24006 - FortiManager 权限绕过

**漏洞编号:** CVE-2021-24006

**漏洞类型:** 权限绕过

**影响应用:** Fortinet FortiManager

**危害等级:** 中危，可能导致敏感信息泄露和配置更改

**影响版本:** 6.4.0 to 6.4.3

**利用条件:** 需要受限制权限的已认证用户账号，以及FortiManager启用了SD-WAN Orchestrator功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-24006是FortiManager 6.4.0到6.4.3版本中存在的一个权限绕过漏洞。具有受限用户权限的已认证攻击者可以通过直接访问SD-WAN Orchestrator面板的URL来绕过访问控制。漏洞利用方式如下：

1.  **漏洞描述：** 漏洞库信息和搜索引擎结果表明，该漏洞允许具有受限制权限的用户通过直接访问特定的URL绕过权限验证，访问SD-WAN Orchestrator面板。
2.  **POC有效性：** 提供的Python POC代码尝试模拟此漏洞。它首先使用受限制权限的帐户登录FortiManager。然后，它尝试直接访问SD-WAN Orchestrator页面的URL。如果访问成功，则打印确认消息以及页面内容的开头部分。
3.  **利用方式：** 攻击者利用该漏洞，首先需要拥有一个具有受限制权限的FortiManager账户。然后，他们直接构造并访问`https://<IP>/fortiwan/maintenance/controller_configuration` URL，绕过正常的访问控制，访问SD-WAN Orchestrator面板。
4.  **投毒风险分析：**
    *   `README.md` 文件描述了漏洞和利用方法，没有发现恶意代码。
    *   `exploit.py` 脚本的功能是登录FortiManager并尝试访问受限页面。潜在的风险是，如果脚本在生产环境中运行，并且用户名和密码硬编码在脚本中，则可能导致凭据泄露。脚本使用了 `verify=False` 禁用了SSL证书验证，这可能使脚本容易受到中间人攻击。除此之外，没有明显的恶意代码。因此，投毒风险较低，约为5%。主要风险在于不安全的编码实践可能导致的其他安全问题，而不是故意植入的恶意代码。

综上所述，该漏洞利用的有效性较高，但投毒风险较低，需要注意脚本使用过程中的安全性。

**项目地址:** [cnetsec/CVE-2021-24006](https://github.com/cnetsec/CVE-2021-24006)

**漏洞详情:** [CVE-2021-24006](https://nvd.nist.gov/vuln/detail/CVE-2021-24006)