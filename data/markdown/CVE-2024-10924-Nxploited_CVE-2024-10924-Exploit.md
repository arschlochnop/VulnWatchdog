## CVE-2024-10924-ReallySimpleSecurity-AuthenticationBypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress plugin

**危害等级:** 严重，未经身份验证的攻击者可以利用此漏洞以任何现有用户的身份（包括管理员）登录网站，导致完全控制受影响的WordPress网站。

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点安装了受影响版本的Really Simple Security插件，并且启用了Two-Factor Authentication功能（尽管默认情况下是禁用状态）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10924 存在于 Really Simple Security WordPress 插件中，允许未经身份验证的攻击者绕过身份验证并以任何现有用户的身份登录，包括管理员。 该漏洞源于 `check_login_and_get_user` 函数在 Two-Factor Authentication API 中的不当用户检查错误处理。提供的PoC代码首先检查目标网站是否安装了受影响版本的插件，然后向 `/wp-json/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送带有伪造 `user_id` 和 `login_nonce` 的 POST 请求。如果请求成功，服务器将设置包含身份验证信息的 Cookie。PoC代码使用 Selenium 启动 Chrome 浏览器，将获取的 Cookie 注入浏览器会话，并导航到 WordPress 管理仪表板 `/wp-admin/`。如果成功登录，则表明漏洞存在。  

**投毒风险分析:**

虽然PoC的主要功能是利用漏洞，但仍然存在轻微的投毒风险。以下是一些潜在的风险点：

*   **依赖项风险:** PoC脚本依赖于 `webdriver-manager` 自动下载和管理 ChromeDriver。虽然 `webdriver-manager` 本身是一个流行的库，但任何依赖项都存在供应链攻击的风险。攻击者可能会compromise `webdriver-manager` 仓库,植入恶意代码,例如下载被篡改的ChromeDriver,进而窃取用户信息或执行恶意操作。
*   **自动化浏览器操作风险:** 该PoC使用Selenium自动打开浏览器并注入cookie。虽然这种方法方便演示，但也存在安全风险。恶意网站可能会利用Selenium执行跨站脚本攻击(XSS)或者其他浏览器攻击。
*   **参数欺骗风险:** PoC代码中的`user_id`被硬编码为“1”。 在某些情况下，攻击者可能会尝试修改此参数，以尝试使用其他用户ID进行身份验证，但PoC代码本身并没有添加额外恶意代码。
*   **恶意代码替换:** 作者可能在发布后修改了代码仓库，例如添加了反向shell或其他恶意功能。  然而，根据提供的代码片段来看，并未发现明显的恶意代码，风险较低。

综合评估，该PoC代码的主要目的是演示漏洞利用，但由于其依赖项和自动化浏览器操作，仍然存在较低的投毒风险 (约为5%)。

**利用方式总结:**

1.  **版本检测:** 检查目标 WordPress 站点上 Really Simple Security 插件的版本。
2.  **漏洞利用:** 如果插件版本在受影响范围内 (9.0.0 - 9.1.1.1)，则向 `/wp-json/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送带有伪造参数的 POST 请求，绕过身份验证。
3.  **会话劫持:** 从响应头中提取包含身份验证信息的 Cookie。
4.  **权限提升:** 使用提取的 Cookie 登录 WordPress 管理仪表板 `/wp-admin/`，从而获得管理员权限。

**项目地址:** [Nxploited/CVE-2024-10924-Exploit](https://github.com/Nxploited/CVE-2024-10924-Exploit)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)