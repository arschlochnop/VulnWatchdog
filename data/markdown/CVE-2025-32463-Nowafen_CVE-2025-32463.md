## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，sudo版本在受影响范围内，且sudo的--chroot选项未被禁用，SELinux/AppArmor未限制共享库加载。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463 是 Sudo 在处理 `--chroot` 选项时的一个严重漏洞。该漏洞允许本地用户通过控制的目录下的 `/etc/nsswitch.conf` 文件，欺骗 Sudo 加载恶意的共享库，从而提升至 root 权限。

**漏洞利用方式：**

1.  **创建恶意环境：** 在 `/tmp/sudowoot.stage.*` 创建临时目录，并在其中构造恶意的 `nsswitch.conf` 文件和一个用于提权的 C 语言共享库（`woot1337.c`）。这个 C 语言共享库通常会包含设置用户 ID 和组 ID 为 0 (root) 的代码，并执行 `/bin/bash`，从而获得 root shell。
2.  **伪造 chroot 环境：** 利用 `nsswitch.conf` 和 `/etc/group` 模拟 chroot 环境。
3.  **编译恶意共享库：** 将 C 代码编译成共享库 `libnss_/woot1337.so`。
4.  **利用 Sudo 提权：** 使用 `sudo --chroot` 选项，指定攻击者控制的目录作为 chroot 根目录。由于 `nsswitch.conf` 文件被篡改，Sudo 会加载恶意的共享库，执行其中的代码，从而提升权限。

**有效性：**

根据漏洞信息和搜索引擎结果，此漏洞的 CVSS 评分为 9.3，属于严重级别，利用代码的存在进一步证明了其有效性。

**投毒风险：**

尽管 POC 代码描述中包含了代码混淆的步骤，这增加了分析的难度。该POC的大部分内容都集中在利用漏洞上，但不能排除作者在代码中隐藏恶意后门的可能。风险评估较低，但仍然存在。虽然该代码主要是为了演示漏洞利用过程，代码中 `woot1337.c` 执行 `/bin/bash` 这本身就是利用行为，因此判定投毒风险在5%。需要人工审核才能确定是否存在其他恶意代码。

**项目地址:** [Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)