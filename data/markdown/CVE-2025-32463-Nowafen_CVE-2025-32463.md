## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限，sudo版本符合漏洞影响范围

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.14到1.9.17p1版本中的本地提权漏洞。漏洞的根本原因是Sudo在处理`--chroot`选项时，允许使用用户可控目录下的`/etc/nsswitch.conf`文件。攻击者可以通过创建一个恶意的`/etc/nsswitch.conf`文件，并利用`sudo --chroot`命令加载它，从而控制名称服务查找的行为，最终获得root权限。

**有效性：** 根据漏洞信息和搜索结果，该漏洞已被证实存在，并且存在公开的PoC代码(https://github.com/pr0v3rbs/CVE-2025-32463_chwoot)。提供的POC代码描述也符合该漏洞影响的版本范围。

**投毒风险：** 提供的PoC代码只有README.md文件，其内容仅为CVE的简单描述，不包含任何可执行的代码。但是，考虑到漏洞利用本身需要构造恶意配置文件，该仓库中可能存在一些辅助利用的恶意文件，例如恶意的`nsswitch.conf`，这些文件可能被用于更隐蔽的攻击，故存在10%的投毒风险。

**利用方式：**
1.  本地用户需要首先创建一个恶意的`/etc/nsswitch.conf`文件。该文件会指示系统从攻击者控制的位置加载恶意模块。
2.  然后，攻击者使用`sudo --chroot <user_controlled_directory>`命令，其中`<user_controlled_directory>`包含攻击者创建的`/etc/nsswitch.conf`文件。
3.  当Sudo以chroot方式运行时，它会加载攻击者提供的`/etc/nsswitch.conf`，该文件会指示系统加载恶意模块。
4.  恶意模块执行，提升攻击者权限至root。

**项目地址:** [Nowafen/CVE-2025-32463](https://github.com/Nowafen/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)