## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 11.1.4 <= 版本 <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**利用条件:** 目标Next.js应用使用了存在漏洞的中间件，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 中间件中，允许攻击者绕过授权检查。该漏洞是由于 Next.js 在处理包含 `x-middleware-subrequest` 标头的请求时存在缺陷。 攻击者可以通过发送带有特定payload的 `x-middleware-subrequest` 标头的恶意请求来绕过身份验证，访问受保护的路由。漏洞利用代码 `ghost-route.py` 通过发送带有不同payload的 `x-middleware-subrequest` 标头的 HTTP GET 请求来测试目标是否存在漏洞。 代码中没有发现任何明显的投毒行为。 它只是发送带有恶意header的请求，并检查响应状态码，判断是否成功绕过中间件，访问受保护资源.  如果状态码不是 403, 401, 302 或 404，则报告存在漏洞。 

**利用方式:**
1.  **发送带有 `x-middleware-subrequest` 标头的请求：** 攻击者构造一个 HTTP 请求，其中包含 `x-middleware-subrequest` 标头，并设置恶意payload。不同的Next.js版本Payload不同，poc代码提供多种payloads尝试。
2.  **绕过授权检查：** Next.js 应用的中间件在处理请求时，由于漏洞的存在，未能正确地执行授权检查。
3.  **访问受保护的资源：** 攻击者成功地绕过了授权，从而可以访问原本受保护的路由或资源。

**项目地址:** [takumade/ghost-route](https://github.com/takumade/ghost-route)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)