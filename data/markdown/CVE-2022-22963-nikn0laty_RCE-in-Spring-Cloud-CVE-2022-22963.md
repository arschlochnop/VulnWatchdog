## CVE-2022-22963-Spring Cloud Function-远程代码执行

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可导致完全控制受影响的服务器

**影响版本:** 3.1.6, 3.2.2 及更早的不受支持版本

**利用条件:** 需要Spring Cloud Function使用了路由功能，并且可以通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Spring Cloud Function框架中，当使用路由功能时，攻击者可以构造特定的SpEL表达式作为路由表达式，从而导致远程代码执行。漏洞利用方式是向`/functionRouter`端点发送POST请求，并在请求头中设置`spring.cloud.function.routing-expression`，其值为包含恶意SpEL表达式的字符串。该表达式利用`java.lang.Runtime.getRuntime().exec()`来执行任意命令。提供的PoC代码`exploit.sh`通过curl命令发送包含恶意SpEL表达式的POST请求，实现反向shell。关于投毒风险，虽然该脚本本身功能明确，但仍然存在一定的风险。例如，攻击者可能会修改`exploit.sh`脚本，在反弹shell之前或之后执行额外的恶意操作，例如下载和执行其他恶意文件，或修改系统配置。这些操作可能会在用户不知情的情况下发生，导致系统被植入后门或被进一步攻击。因此，该脚本存在潜在的投毒风险，但可能性相对较低，约为5%。谨慎使用，并在生产环境中使用前进行安全审计是非常重要的。

**项目地址:** [nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963](https://github.com/nikn0laty/RCE-in-Spring-Cloud-CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)