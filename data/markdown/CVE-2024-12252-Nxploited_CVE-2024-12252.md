## CVE-2024-12252-SEO LAT Auto Post-远程代码执行

**漏洞编号:** CVE-2024-12252

**漏洞类型:** 远程代码执行

**影响应用:** SEO LAT Auto Post WordPress 插件

**危害等级:** 高危，允许未授权用户通过文件覆盖实现远程代码执行

**影响版本:** <= 2.2.1

**利用条件:** 目标WordPress站点安装了存在漏洞的SEO LAT Auto Post插件，且插件版本小于等于2.2.1。攻击者需要能够访问目标站点的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-12252是SEO LAT Auto Post WordPress插件中的一个漏洞，允许未授权的攻击者通过`remote_update` AJAX action覆盖`seo-beginner-auto-post.php`文件，从而实现远程代码执行。漏洞原因是插件缺少对`remote_update` action的权限检查。\n\n**有效性：**\n提供的POC代码是有效的，它首先检查插件的版本，如果版本小于等于2.2.1，则会利用漏洞，通过`remote_update` action上传恶意PHP shell到`seo-beginner-auto-post.php`。\n\n**投毒风险：**\n代码本身主要功能是利用漏洞，但仍存在一定投毒风险，可能性约为10%。风险点在于：\n1.  `attack_url`参数，该参数直接指定了恶意shell的URL。攻击者可能会在shell中植入恶意代码。\n2.  该POC依赖于外部的恶意PHP shell，如果攻击者提供了一个包含恶意功能的shell，比如反向shell、信息窃取、主机扫描等，则会对目标系统造成更大的危害。\n\n**利用方式：**\n1.  确定目标WordPress站点安装了SEO LAT Auto Post插件，且版本小于等于2.2.1。\n2.  准备一个恶意PHP shell，该shell可以执行系统命令。\n3.  使用提供的POC代码，指定目标站点的URL和恶意PHP shell的URL。\n4.  POC代码会利用漏洞，通过`remote_update` action上传恶意PHP shell到`seo-beginner-auto-post.php`。\n5.  攻击者可以通过访问`seo-beginner-auto-post.php`文件，并传递`cmd`参数来执行系统命令。

**项目地址:** [Nxploited/CVE-2024-12252](https://github.com/Nxploited/CVE-2024-12252)

**漏洞详情:** [CVE-2024-12252](https://nvd.nist.gov/vuln/detail/CVE-2024-12252)