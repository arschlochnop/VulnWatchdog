## CVE-2020-1472 Zerologon 本地提权漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限

**影响版本:** 受影响的Windows Server版本，参见漏洞库信息

**利用条件:** 攻击者需要位于目标网络的内部

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。攻击者可以通过建立到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞，从而在网络设备上运行特制的应用程序，最终获取域管理员权限。

**有效性:**
提供的POC代码（zerologon_tester.py）是一个检测脚本，用于测试目标域控制器是否存在Zerologon漏洞。脚本通过尝试执行Netlogon身份验证绕过操作来验证漏洞是否存在。如果绕过成功，脚本将立即终止。如果域控制器已修补，脚本会在多次尝试后放弃并报告目标未受攻击。

**投毒风险:**
检查提供的文件列表，其中包括`LICENSE`，`README.md`，`requirements.txt`和`zerologon_tester.py`。没有明显的恶意代码，例如故意引入的后门或数据泄露。然而，任何下载和运行的代码都存在一定风险，因此这里给出一个较低的投毒风险值。该脚本主要依赖于Impacket库，这是一个常用的渗透测试工具，降低了投毒可能性。

**利用方式:**
1.  攻击者使用POC代码中的`zerologon_tester.py`脚本尝试将域控制器的机器密码置零。
2.  如果攻击成功，域控制器的机器密码将被重置为空。
3.  攻击者可以使用例如`secretsdump.py`之类的工具，使用空的机器帐户密码从域控制器转储域凭据（包括域管理员帐户）。
4.  攻击者现在可以使用获得的域管理员凭据来控制整个域。

**搜索引擎结果分析:**
搜索引擎结果表明，该漏洞影响重大，可以被利用来完全控制Windows域，并允许攻击者窃取凭据。

**项目地址:** [Fa1c0n35/SecuraBV-CVE-2020-1472](https://github.com/Fa1c0n35/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)