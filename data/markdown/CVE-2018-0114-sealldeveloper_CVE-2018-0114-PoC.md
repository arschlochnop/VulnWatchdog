## CVE-2018-0114-Node-jose-JWT 签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 签名伪造

**影响应用:** Node-jose Library

**危害等级:** 高危，可能导致身份验证绕过和权限提升

**影响版本:** < 0.11.0

**利用条件:** 需要目标应用使用存在漏洞的 node-jose 库处理 JWT

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-0114 漏洞存在于 Cisco node-jose 0.11.0 之前的版本。该漏洞允许未经身份验证的远程攻击者使用嵌入在令牌中的密钥重新签名令牌。该漏洞是由于 node-jose 遵循 JSON Web Signature (JWS) 标准 for JSON Web Tokens (JWTs) 造成的。该标准指定 JSON Web Key (JWK)（表示公钥）可以嵌入在 JWS 的标头中。然后信任此公钥进行验证。攻击者可以通过以下方式利用此漏洞：删除原始签名，将新的公钥添加到标头，然后使用与嵌入在该 JWS 标头中的公钥关联的（攻击者拥有的）私钥对对象进行签名。

**利用方式：**

1.  获取一个合法的 JWT 令牌。
2.  修改 JWT 头部，添加 `jwk` 字段，该字段包含攻击者控制的公钥。
3.  移除原始签名。
4.  使用攻击者控制的私钥对修改后的 JWT 进行签名。
5.  将伪造的 JWT 发送给服务器。由于服务器信任 `jwk` 中提供的公钥，因此会验证通过，从而绕过身份验证。

**投毒风险分析：**

提供的代码片段是 GNU GPL 许可协议，并非漏洞利用代码。根据搜索结果，github上存在此漏洞的POC代码，因此需要单独进行分析。当前提供的代码片段不包含任何可疑的恶意代码，因此，**投毒风险为 0%**。

**项目地址:** [sealldeveloper/CVE-2018-0114-PoC](https://github.com/sealldeveloper/CVE-2018-0114-PoC)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)