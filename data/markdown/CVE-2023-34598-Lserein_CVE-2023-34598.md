## CVE-2023-34598-Gibbon-本地文件包含

**漏洞编号:** CVE-2023-34598

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Gibbon

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v25.0.0

**利用条件:** 需要网络访问Gibbon服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-34598 是 Gibbon v25.0.0 中的一个本地文件包含（LFI）漏洞。攻击者可以通过操纵 URL 中的 `q` 参数，包含服务器上 Gibbon 安装目录中的文件内容。

**有效性：**
提供的 Python 脚本 `CVE-2023-34598.py` 似乎能够有效利用此漏洞。它接受一个 URL 或一个包含 URL 列表的文件，然后将 Payload `/q=./gibbon.sql` 附加到每个 URL。如果服务器响应包含字符串 "sql"，则该脚本将报告该 URL 存在漏洞。虽然这个POC只验证了`gibbon.sql`的存在，但攻击者可以尝试包含其他敏感文件。

**投毒风险：**
查看提供的 `CVE-2023-34598.py` 脚本和 `README.md` 文件后，没有发现任何明显的恶意代码或后门。该脚本的功能很简单，就是发送 HTTP 请求并检查响应中的特定字符串。`README.md` 文件仅包含有关漏洞的描述。因此，评估的投毒风险为 0%。

**利用方式：**
1.  确定目标 Gibbon v25.0.0 实例的 URL。
2.  使用提供的 Python 脚本 `CVE-2023-34598.py`，并将目标 URL 作为参数传递给脚本（例如，`python CVE-2023-34598.py -u https://target.com`）。
3.  如果目标存在漏洞，该脚本将打印出包含漏洞的 URL。
4.  可以修改脚本中的 payload 以尝试包含其他文件，例如配置文件，包含 `../` 来进行目录遍历，可能导致读取服务器上其他敏感文件, 比如 `/etc/passwd`。例如，可以将payload更改为 `/q=../../../../etc/passwd`， 但是由于这个LFI 漏洞限制在安装文件夹, 利用难度较大。攻击者还可以尝试利用 LFI 漏洞读取源代码，从而进一步了解应用程序的内部工作原理并发现其他漏洞。

**建议：**
*   尽快升级 Gibbon 到不受影响的版本。
*   限制对 Gibbon 安装目录的访问权限。

**项目地址:** [Lserein/CVE-2023-34598](https://github.com/Lserein/CVE-2023-34598)

**漏洞详情:** [CVE-2023-34598](https://nvd.nist.gov/vuln/detail/CVE-2023-34598)