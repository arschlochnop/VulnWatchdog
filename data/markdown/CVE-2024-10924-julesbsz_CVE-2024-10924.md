## CVE-2024-10924-Really Simple Security-Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress插件

**危害等级:** 严重，允许未经身份验证的攻击者以任何现有用户的身份登录，包括管理员

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点已安装受影响版本的Really Simple Security插件，并且启用了双因素身份验证（Two-Factor Authentication）设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924 存在于Really Simple Security WordPress 插件的 REST API 中。当启用了双因素身份验证时，由于 'check_login_and_get_user' 函数中不正确的用户检查错误处理，未经身份验证的攻击者可以通过发送特制的 POST 请求到 `/reallysimplessl/v1/two_fa/skip_onboarding` 路由，并提供目标用户ID和随机生成的login_nonce, 绕过身份验证，以该用户身份登录。

**漏洞利用方式：**
1.  目标站点安装并启用了受影响的 Really Simple Security 插件版本 (9.0.0 - 9.1.1.1)，并且开启了双因素认证。
2.  攻击者运行提供的 `exploit.py` 脚本，指定目标站点的URL和要冒充的用户ID（或者使用默认的ID 1）。
3.  脚本会构造包含 `user_id` 和随机 `login_nonce` 的 POST 请求，发送到目标站点的 `/reallysimplessl/v1/two_fa/skip_onboarding` 路由。
4.  如果利用成功，服务器会返回包含身份验证 cookie 的 `Set-Cookie` 响应头，攻击者可以使用此 cookie 冒充目标用户。

**有效性：**
提供的PoC代码有效，可以利用该漏洞绕过身份验证。

**投毒风险：**
PoC代码本身主要功能是实现漏洞利用，但仍存在潜在的低度投毒风险，例如：
*   **依赖项风险：** `requirements.txt` 文件中指定的依赖项版本可能存在安全风险。 虽然指定了明确的版本，但这些版本本身可能包含已知漏洞，利用脚本在安装这些依赖时就引入了风险。
*   **HTTPS 欺骗风险：**  `requests.post(..., verify=False)` 禁用 SSL 证书验证。 在真实的渗透测试中，这可能会让攻击者更容易受到中间人攻击。
*   **其他潜在风险：** 作者在README.md中声称不对任何事情负责，这暗示作者可能隐藏一些不为人知的风险。
考虑到以上风险，结合作者声明，综合评估该仓库存在10%的潜在投毒风险。


**项目地址:** [julesbsz/CVE-2024-10924](https://github.com/julesbsz/CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)