## CVE-2025-48799 Windows Update Service 提权漏洞

**漏洞编号:** CVE-2025-48799

**漏洞类型:** 本地提权 (Elevation of Privilege)

**影响应用:** Windows Update Service

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows 10, Windows 11, Windows Server版本（详见漏洞库信息）

**利用条件:** 需要至少两个硬盘驱动器，且已更改Storage Sense的默认存储位置

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48799 存在于 Windows Update Service 中，允许经过身份验证的攻击者在本地提升权限。根据 PoC 代码，利用方法如下：

1.  **前提条件：** 系统需要至少有两个硬盘驱动器。使用 Storage Sense 将新应用程序的默认存储位置更改为辅助驱动器。
2.  **漏洞原理：** 在安装新应用程序期间，`wuauserv` 服务会执行任意文件夹删除操作，但不会检查符号链接（如果遇到文件，则服务会使用 `GetFinalPathByHandle` 检查最终路径）。
3.  **利用方式：** PoC 利用了 ZDI 博客文章中描述的方法，滥用任意文件删除来提升权限。通过精心构造的目录结构和符号链接，攻击者可以诱导 `wuauserv` 删除受保护的文件或目录，从而获得更高的权限。
4.  **PoC 代码分析：**  PoC代码利用`FileOpLock.cpp`文件创建一个文件操作锁,目的是为了在特定时刻触发漏洞.利用文件操作锁控制文件删除的时机。这种方法通常用于在文件系统操作期间创建竞争条件或进行精确的时间控制，以便更容易地触发漏洞。
5.  **搜索引擎结果分析：** 搜索结果中其他的CVE信息与本次漏洞无关, Microsoft Patch Tuesday July 2025 说明该月发布了大量的漏洞修复，而本次漏洞是其中一个。其他页面提及了teamviewer漏洞，lorex摄像头漏洞，sap漏洞等等，均与本次CVE无关。

**关于投毒风险：**

PoC代码中，`FileOpLock.cpp` 看起来是标准的文件操作锁的实现，没有明显的恶意代码。 但是，依旧存在一些风险：

*   **复杂性隐藏：** 漏洞利用代码通常比较复杂，可能在不显眼的地方隐藏恶意行为。
*   **依赖项风险：** PoC 可能依赖于其他库或组件，这些依赖项可能包含恶意代码。

因此，综合考虑，认为存在10%的投毒风险。需要进一步的安全审计才能确定是否存在隐藏的恶意代码。

**项目地址:** [Wh04m1001/CVE-2025-48799](https://github.com/Wh04m1001/CVE-2025-48799)

**漏洞详情:** [CVE-2025-48799](https://nvd.nist.gov/vuln/detail/CVE-2025-48799)