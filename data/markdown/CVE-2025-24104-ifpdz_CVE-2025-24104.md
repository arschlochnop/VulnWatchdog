## CVE-2025-24104-iOS/iPadOS备份文件符号链接读取漏洞

**漏洞编号:** CVE-2025-24104

**漏洞类型:** 符号链接

**影响应用:** iOS/iPadOS

**危害等级:** 中危，可能导致敏感数据泄露

**影响版本:** iOS and iPadOS < 18.3, iPadOS < 17.7.4

**利用条件:** 需要用户恢复恶意制作的备份文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24104 漏洞是由于在恢复备份文件时，对符号链接处理不当造成的。恶意攻击者可以构造包含指向系统敏感文件的符号链接的备份文件，当用户恢复这个恶意备份后，系统会读取符号链接指向的文件内容，从而导致敏感信息泄露。根据提供的漏洞利用代码，漏洞作者描述了利用此漏洞读取沙盒之外任意文件的方法，而苹果的修复并不彻底，作者声称存在绕过方法，但未公开。

**有效性评估：**

根据漏洞描述和PoC代码，该漏洞是有效的。PoC 展示了如何创建一个包含指向敏感文件的符号链接的恶意备份，并在恢复后读取这些文件。漏洞已在 iOS 18.3 和 iPadOS 18.3 中修复，但修复可能不完整。

**投毒风险评估：**

投毒风险较低，约为 10%。 代码仓库主要包含漏洞的描述、时间线、利用方法和修复方案。虽然作者声称存在绕过补丁的方法但并没有公布，这暗示着可能存在未公开的利用方式。license文件和readme文件均属于常规的开源代码仓库内容，未发现明显的恶意代码或后门。风险主要来自作者未公开的绕过方法。

**利用方式：**

1.  **创建恶意备份：** 攻击者创建一个备份文件，其中`/private/var/containers/Shared/SystemGroup/systemgroup.com.apple.configurationprofiles/Library/ConfigurationProfiles/CloudConfigurationDetails.plist` 文件被替换为指向目标文件的符号链接。
2.  **恢复备份：** 诱使用户在受影响的 iOS/iPadOS 设备上恢复该恶意备份。
3.  **触发漏洞：** 通过lockdown连接向 `com.apple.mobile.MCInstall` 服务发送 `GetCloudConfiguration` 命令。由于符号链接未被正确处理，服务会返回符号链接指向的文件内容，而不是预期的 `CloudConfigurationDetails.plist` 内容。
4.  **读取敏感信息：** 攻击者可以利用此漏洞读取沙盒之外的敏感文件，例如系统配置文件等。

**项目地址:** [ifpdz/CVE-2025-24104](https://github.com/ifpdz/CVE-2025-24104)

**漏洞详情:** [CVE-2025-24104](https://nvd.nist.gov/vuln/detail/CVE-2025-24104)