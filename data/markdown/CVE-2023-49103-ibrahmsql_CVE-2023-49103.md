## CVE-2023-49103-ownCloud-敏感信息泄露

**漏洞编号:** CVE-2023-49103

**漏洞类型:** 信息泄露

**影响应用:** ownCloud

**危害等级:** 高危，可能导致敏感信息泄露，如管理员密码、邮件服务器凭据、license key等

**影响版本:** owncloud/graphapi 0.2.x before 0.2.1 and 0.3.x before 0.3.1

**利用条件:** 目标系统安装了受影响版本的ownCloud，并且启用了graphapi应用。容器化部署风险更高，但非容器化部署也可能存在风险。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2023-49103是ownCloud graphapi组件中的一个信息泄露漏洞。攻击者可以通过访问特定的URL，利用第三方库GetPhpInfo.php暴露PHP环境的配置信息（phpinfo）。在容器化部署中，这些配置信息可能包含敏感环境变量，例如管理员密码、邮件服务器凭据和license key。即使禁用了graphapi应用，漏洞仍然存在。搜索结果显示该漏洞已被积极利用。

提供的漏洞利用代码（CVE-2023-49103.rb）实际上是另一个漏洞的POC，它针对的是Discourse的管理员面板认证绕过漏洞，与CVE-2023-49103毫无关联。它试图通过各种HTTP头、session操纵、JWT令牌、API密钥和权限提升等方法绕过Discourse的认证。

由于提供的代码是Discourse的漏洞，与目标漏洞完全无关，并且尝试绕过身份验证， 因此存在极高的投毒风险，攻击者利用该代码进行渗透测试, 会完全误导使用者, 浪费大量时间, 并且可能无法成功，甚至攻击其他不相干系统。 

真正的CVE-2023-49103利用方式是，未经身份验证的攻击者通过访问GetPhpInfo.php暴露的URL来获取phpinfo信息，从而窃取敏感配置数据。

**项目地址:** [ibrahmsql/CVE-2023-49103](https://github.com/ibrahmsql/CVE-2023-49103)

**漏洞详情:** [CVE-2023-49103](https://nvd.nist.gov/vuln/detail/CVE-2023-49103)