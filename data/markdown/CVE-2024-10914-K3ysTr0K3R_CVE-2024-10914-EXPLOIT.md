## CVE-2024-10914-D-Link-RCE

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS Command Injection

**影响应用:** D-Link DNS-320/DNS-320LW/DNS-325/DNS-340L

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 20241028

**利用条件:** 目标设备需开启Web服务，攻击者需要能够访问设备的Web接口，可能需要绕过身份验证(根据实际配置).

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10914 存在于 D-Link DNS-320、DNS-320LW、DNS-325 和 DNS-340L 设备中，是一个命令注入漏洞。攻击者通过操纵 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 接口的 `name` 参数，可以在目标设备上执行任意操作系统命令。根据漏洞信息，攻击可以在网络上远程发起，漏洞利用难度较高，但是公开了EXP。

**漏洞利用方式：**
1.  **漏洞定位：** 漏洞位于 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 文件的 `cgi_user_add` 函数中。
2.  **参数注入：** 通过构造恶意的 `name` 参数，将操作系统命令注入到该参数中。
3.  **命令执行：**  服务器端未对 `name` 参数进行充分的过滤，导致注入的命令被执行。

**POC 分析：**
提供的 Python 脚本是一个 PoC 利用程序，具有以下功能：
*   **漏洞检测：**  通过发送包含 `id` 命令的请求来检测目标是否存在漏洞，并根据响应判断是否存在漏洞。
*   **交互式 Shell：**  如果目标存在漏洞，则启动一个交互式 shell，允许攻击者在目标设备上执行任意命令。
*   **批量扫描：**  可以从文件中读取目标 URL 列表，并使用多线程进行批量漏洞扫描。

**投毒风险分析：**
对提供的PoC代码进行分析，存在一定的投毒风险，风险评估为10%。主要基于以下几点：
*  **未做详细的命令过滤:** 虽然PoC代码的功能主要是利用命令注入漏洞，但未严格过滤用户输入的命令，攻击者可利用此特性执行恶意操作，比如下载恶意文件，反弹shell等。
*  **User-Agent伪装:** 使用常见的User-Agent头可以隐藏攻击行为，但如果被滥用，可能被恶意行为发现。
*  **忽略SSL证书验证:**  `verify=False` 选项会忽略SSL证书验证，这可能使攻击者更容易进行中间人攻击。

总体来说，虽然PoC的主要目的是验证漏洞，但攻击者可以修改PoC以包含恶意代码，从而对目标系统造成更大的危害。在实际使用PoC时，需要仔细审查代码，确保没有隐藏的恶意功能。

**项目地址:** [K3ysTr0K3R/CVE-2024-10914-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2024-10914-EXPLOIT)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)