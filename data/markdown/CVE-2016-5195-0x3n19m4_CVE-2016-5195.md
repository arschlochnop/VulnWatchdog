## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** 2.x ~ 4.x before 4.8.3

**利用条件:** 本地用户权限，目标系统内核版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-5195（Dirty COW）是一个Linux内核中的竞争条件漏洞，存在于mm/gup.c文件中。该漏洞允许本地用户利用写时复制（COW）机制的不当处理，写入只读内存映射，从而获得特权。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞在野外被广泛利用，并且有公开的PoC代码可用。因此，在未经修补的系统上，该漏洞的利用是有效的。

**投毒风险：**
提供的PoC代码只包含一个MIT协议的LICENSE文件，该文件只声明了版权信息和使用许可，**没有发现任何可疑的恶意代码**。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式：**
Dirty COW漏洞的利用方式通常包括以下步骤：
1.  找到一个具有root权限，但允许普通用户读取的文件（例如：/etc/passwd）。
2.  将该文件映射到内存中。
3.  创建一个单独的线程或进程，使用`madvise`系统调用触发写时复制（COW）。
4.  在原始文件映射的内存区域中，通过`/proc/self/mem` 映射进行写入。
5.  快速重复步骤3和4，造成竞争条件，使写入操作绕过权限检查，从而修改只读内存映射的文件内容。

成功利用此漏洞后，攻击者可以修改/etc/passwd文件，添加一个新的具有root权限的用户，或者修改现有root用户的密码，从而获得系统的完全控制权。

**项目地址:** [0x3n19m4/CVE-2016-5195](https://github.com/0x3n19m4/CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)