## CVE-2025-29927-Next.js中间件绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问、数据泄露或篡改

**影响版本:** 11.1.4 <= version <= 13.5.6, > 14.0.0 < 14.2.25, > 15.0.0 < 15.2.3

**利用条件:** 目标Next.js应用使用了存在漏洞的版本，并且使用了中间件进行权限验证。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Next.js的中间件实现中，允许攻击者通过操纵`x-middleware-subrequest` header绕过权限验证。根据漏洞利用代码，攻击者首先探测服务器是否支持`X-Nextjs-Data`header,如果支持，就发送精心构造的包含`X-Middleware-Subrequest`头的请求。此header包含一长串`src/middleware`字符串,导致中间件处理逻辑出现问题，从而绕过身份验证,读取未授权的资源。投毒风险较低，因为该POC主要是利用特定的header绕过验证，没有明显的后门代码，但是存在极低的风险，如果Next.js应用开发者使用了某些不安全的第三方中间件或者自定义中间件逻辑存在漏洞，攻击者可能利用此漏洞作为跳板进行进一步的攻击。

**项目地址:** [Slvignesh05/CVE-2025-29927](https://github.com/Slvignesh05/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)