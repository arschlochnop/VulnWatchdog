## CVE-2023-4220-Chamilo-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行受影响版本的Chamilo LMS，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 1.11.24 及更早版本中的一个漏洞，允许未经身份验证的攻击者通过 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 中的大文件上传功能上传任意文件，从而导致远程代码执行。 

**有效性：**
提供的POC代码利用了该漏洞，通过POST请求上传一个名为`shell.php`的webshell到服务器，然后通过GET请求访问该webshell执行任意命令。

**投毒风险：**
分析提供的文件：
* `README.md`: 描述了漏洞和利用方法。
* `exploit.py`:  主要的利用脚本，用于上传 webshell 并执行命令。该脚本首先上传 `shell.php` 文件，然后通过 GET 请求向 `shell.php` 传递 `cmd` 参数来执行命令。 这个脚本功能明确，没有发现隐藏的恶意代码。
* `shell.php`:  一个简单的 webshell，接收 `cmd` 参数并通过 `system()` 函数执行。这是一个典型的 webshell，但本身并**不**构成投毒，而是漏洞利用的一部分。
由于`exploit.py`和`shell.php`的代码功能都比较直接，目的是上传webshell并执行命令，没有发现额外的恶意行为，因此投毒风险很低。

**利用方式：**
1.  攻击者首先需要找到一个运行着 Chamilo LMS 1.11.24 或更早版本的服务器。
2.  攻击者运行`exploit.py`脚本，指定目标URL。
3.  `exploit.py`脚本会上传一个名为`shell.php`的webshell到`/main/inc/lib/javascript/bigupload/files/`目录。
4.  脚本验证webshell是否成功上传。
5.  攻击者可以通过访问`shell.php`并传递`cmd`参数来执行任意系统命令。

**优先级排序：**
搜索引擎结果强调了未授权的RCE，漏洞利用代码提供了具体的利用方式，漏洞库信息提供了漏洞的详细描述和受影响的版本。

**项目地址:** [Al3xGD/CVE-2023-4220-Exploit](https://github.com/Al3xGD/CVE-2023-4220-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)