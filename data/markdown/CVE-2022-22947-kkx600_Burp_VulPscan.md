## CVE-2022-22947-Spring Cloud Gateway 代码注入

**漏洞编号:** CVE-2022-22947

**漏洞类型:** 代码注入

**影响应用:** Spring Cloud Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 3.1.x (prior to 3.1.1+), 3.0.x (prior to 3.0.7+), 以及所有旧的和不支持的版本

**利用条件:** Gateway Actuator 端点已启用、暴露且未进行安全保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22947 影响 Spring Cloud Gateway。当 Gateway Actuator 端点启用、暴露且未进行安全保护时，攻击者可以利用 SpEL 表达式注入执行任意代码。

**有效性：**
根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。存在公开的漏洞利用代码和关于漏洞利用的详细分析。

**投毒风险：**
提供的代码片段不完整，无法进行全面的投毒分析。BurpExtender.java调用了 spring_CVE_2022_22947.poc，这部分代码是POC实现的核心，未提供，因此无法分析该部分的安全性。HttpsRequest.java 提供了一个发送 HTTP/HTTPS 请求的功能，本身不存在明显的恶意代码。Burp扩展通常需要授予较高的权限，如果POC代码中包含恶意逻辑，如未经授权的数据收集或篡改，则存在投毒风险。目前根据现有的代码片段，只能初步判断存在较低的投毒风险。

**利用方式：**
1.  **确定目标：** 找到运行 Spring Cloud Gateway 且 Actuator 端点已启用、暴露且未进行安全保护的实例。
2.  **构造恶意请求：** 构造包含恶意 SpEL 表达式的 HTTP 请求，该表达式将在 Actuator 端点被解析和执行。通常攻击方式是向/actuator/gateway/routes接口发送包含恶意SpEL表达式的请求，修改路由配置。
3.  **执行代码：** 成功利用后，攻击者可以在目标服务器上执行任意代码。

**优先级：**
根据搜索结果，确认这是一个已知且被积极利用的漏洞。漏洞利用代码的存在进一步证实了其可利用性。

**项目地址:** [kkx600/Burp_VulPscan](https://github.com/kkx600/Burp_VulPscan)

**漏洞详情:** [CVE-2022-22947](https://nvd.nist.gov/vuln/detail/CVE-2022-22947)