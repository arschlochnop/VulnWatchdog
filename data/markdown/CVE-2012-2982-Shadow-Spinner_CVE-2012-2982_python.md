## CVE-2012-2982-Webmin-命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.590

**利用条件:** 需要Webmin的访问权限，且目标版本低于或等于1.590，需要有效的Webmin用户名和密码。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2012-2982是Webmin 1.590及更早版本中的file/show.cgi文件存在的一个命令执行漏洞。根据漏洞信息和搜索引擎结果，确认该漏洞允许远程认证用户通过在路径名中使用无效字符（例如管道符“|”）来执行任意命令。

**有效性：**
根据提供的PoC代码（mal.py），利用流程如下：
1.  首先，通过session_login.cgi进行身份验证，需要提供用户名和密码。PoC代码中默认用户名为user1，密码为1user，需要修改为目标Webmin实例的有效凭据。
2.  如果登录成功，服务器会设置一个sid cookie。PoC代码会提取这个sid cookie。
3.  PoC构建一个包含管道符“|”的恶意URL，利用file/show.cgi的漏洞执行命令。PoC中使用的命令是反弹shell到攻击者的机器。
4.  PoC发送包含sid cookie的POST请求到恶意URL，触发漏洞。

根据漏洞信息和PoC代码，可以判断该漏洞是有效的，PoC代码可以直接用来验证漏洞。

**投毒风险：**
PoC代码本身的主要功能是利用漏洞，但存在一些潜在的投毒风险：
1.  **硬编码凭据：** PoC代码中硬编码了用户名（user1）和密码（1user）。如果用户不修改这些凭据直接使用PoC，可能导致未授权访问。
2.  **反弹Shell：** PoC代码包含一个反弹shell的payload。攻击者可以修改payload来执行恶意操作，例如下载恶意文件、修改系统配置等。

综合考虑，PoC代码本身的投毒风险较低，主要是用户使用不当可能导致安全问题。大约5%的风险来源于用户不修改默认凭据，以及可能存在的恶意payload。

**利用方式：**
漏洞利用方式如下：
1.  **身份认证：** 使用有效的Webmin用户名和密码登录Webmin。
2.  **构建恶意URL：** 构造包含管道符“|”的URL，利用file/show.cgi的漏洞执行命令。例如：`http://targetIP/file/show.cgi/bin/random|command|`。
3.  **发送请求：** 发送包含sid cookie的请求到恶意URL，触发漏洞。

总而言之，利用此漏洞需要在存在漏洞的Webmin实例上进行身份验证，然后构造包含管道符的恶意URL，从而在服务器上执行任意命令。

**项目地址:** [Shadow-Spinner/CVE-2012-2982_python](https://github.com/Shadow-Spinner/CVE-2012-2982_python)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)