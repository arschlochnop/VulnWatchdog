## CVE-2025-52413 — Particle Device OS BLE Buffer Overflow

**漏洞编号:** CVE-2025-52413

**漏洞类型:** 缓冲区溢出

**影响应用:** Particle Device OS

**危害等级:** 高危，可导致任意代码执行

**影响版本:** 5.6.0

**利用条件:** 需要通过蓝牙与目标设备建立连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Particle Device OS v5.6.0的`ble_control_request_channel.cpp`组件中，是一个缓冲区溢出漏洞。攻击者可以通过构造特制的BLE控制消息，利用`memcpy()`函数将数据写入一个64字节的缓冲区，由于缺少边界检查，当`handshake_header_size`超过64字节时，会覆盖相邻的`ThreadRunner::eventHandler_`函数指针。当`eventHandler_`回调函数被调用时，会执行攻击者控制的代码。

**有效性:**
提供的PoC代码是有效的，它展示了如何利用缓冲区溢出覆盖函数指针并重定向控制流。虽然提供的代码只是概念验证，没有包含完整的攻击载荷，但它清晰地说明了漏洞利用方式。

**投毒风险:**
PoC代码本身并未发现明显的投毒代码。该PoC主要提供漏洞验证和原理说明，而非直接可用的攻击脚本。但是，由于漏洞利用涉及修改内存中的函数指针并执行任意代码，如果攻击者修改或替换了`rop_shell`函数的内容，则可能存在投毒风险，例如将受害者重定向到恶意网站或执行其他恶意操作。评估的投毒风险为10%，主要考虑的是如果实际攻击中替换掉`rop_shell`，可能引入其他恶意行为。

**利用方式:**
1.  攻击者通过蓝牙与目标Particle设备建立连接。
2.  攻击者构造一个恶意的BLE控制消息，其中`handshake_header_size`大于64字节。
3.  目标设备在处理BLE控制消息时，使用`memcpy()`函数将攻击者控制的数据写入缓冲区，导致缓冲区溢出。
4.  溢出的数据覆盖了相邻的`ThreadRunner::eventHandler_`函数指针。
5.  当`eventHandler_`回调函数被调用时，控制流被重定向到攻击者控制的代码，从而实现任意代码执行。

**项目地址:** [GoldenTicketLabs/CVE-2025-52413](https://github.com/GoldenTicketLabs/CVE-2025-52413)

**漏洞详情:** [CVE-2025-52413](https://nvd.nist.gov/vuln/detail/CVE-2025-52413)