## CVE-2025-1793-llama_index-SQL注入

**漏洞编号:** CVE-2025-1793

**漏洞类型:** SQL注入

**影响应用:** run-llama/llama_index

**危害等级:** 高危，可能导致数据泄露、数据篡改和拒绝服务

**影响版本:** < 0.12.28 (影响 v0.12.21)

**利用条件:** 需要目标系统使用了存在漏洞的llama_index版本，并且允许用户提供输入作为向量存储的查询条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1793是run-llama/llama_index中多个向量存储集成中存在的SQL注入漏洞。根据漏洞库信息和搜索结果，攻击者可以通过构造恶意的SQL语句，利用受影响的llama_index版本中的漏洞，对底层数据库进行读写操作，从而可能导致未经授权的数据访问、数据篡改，甚至完全控制数据库服务器。POC代码展示了如何通过`filters`参数注入恶意SQL语句。代码尝试通过`malicious_filter` 模拟用户输入，在向量存储查询中执行`DROP TABLE documents;`来删除表。虽然POC看起来主要演示了SQL注入漏洞的利用，但其中存在一定的风险，即如果该向量数据库被用于处理一些关键数据，恶意用户有可能通过注入代码篡改或者删除相关数据，对整个应用产生较大影响，因此存在一定的投毒风险。

**利用方式：**

1.  **确定目标：** 找到使用存在漏洞的llama_index版本（<0.12.28，特别是v0.12.21）的应用程序。
2.  **识别注入点：** 找到应用程序中允许用户提供输入作为向量存储查询条件的地方（例如，查询参数、API输入等）。
3.  **构造恶意SQL：**  构造包含恶意SQL代码的输入，例如`'; DROP TABLE documents; --`，并将其注入到查询条件中。
4.  **发送请求：**  向应用程序发送包含恶意输入的请求。
5.  **利用结果：**  如果漏洞成功利用，攻击者可以执行任意SQL命令，例如读取敏感数据、修改数据或删除数据。

**投毒风险分析：**

POC代码本身主要用于演示SQL注入漏洞，但它模拟了用户输入，这本身就存在一定的风险。如果攻击者能够成功利用此漏洞，他们可以篡改或删除向量数据库中的数据，从而影响依赖这些数据的应用程序的行为。例如，如果向量数据库用于存储知识库，攻击者可以通过篡改数据来传播虚假信息，或者通过删除数据来破坏应用程序的功能。

因此，虽然POC代码的主要目的是演示SQL注入，但它也暴露了应用程序遭受数据投毒攻击的风险。


**项目地址:** [Usama-Figueira/-CVE-2025-1793-poc](https://github.com/Usama-Figueira/-CVE-2025-1793-poc)

**漏洞详情:** [CVE-2025-1793](https://nvd.nist.gov/vuln/detail/CVE-2025-1793)