## CVE-2025-29927-Next.js-中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用了Next.js中间件进行权限验证,且未对`x-middleware-subrequest`请求头进行正确处理。

**POC 可用性:** 是，但提供的POC代码仅为README文件，需要自行构造利用代码。

**投毒风险:** 5%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。该漏洞源于 Next.js 对 `x-middleware-subrequest` 请求头处理不当。攻击者可以通过构造包含该请求头的恶意请求，绕过中间件中的身份验证和授权检查，从而访问受保护的资源。 漏洞影响 Next.js 版本 >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3。根据搜索结果，可以通过发送带有 `x-middleware-subrequest` 头的请求绕过身份验证。 由于提供的漏洞利用代码只有一个README.md文件，因此实际利用的有效性取决于自行构造的Payload。README.md文件本身不包含恶意代码，但仓库的创建者有可能在其他地方植入恶意代码(比如git hooks)，因此存在极低的投毒风险。 利用方式： 1. 目标应用使用Next.js中间件进行权限校验。 2. 攻击者发送带有 `x-middleware-subrequest` 请求头的HTTP请求。 3. Next.js 应用未正确验证该请求头，导致中间件的身份验证逻辑被绕过。 4. 攻击者成功访问未经授权的资源。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-29927](https://github.com/B1ack4sh/Blackash-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)