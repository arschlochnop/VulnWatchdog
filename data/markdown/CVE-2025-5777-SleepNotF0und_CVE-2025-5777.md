## CVE-2025-5777-NetScaler-内存信息泄露

**漏洞编号:** CVE-2025-5777

**漏洞类型:** 内存信息泄露

**影响应用:** NetScaler ADC 和 NetScaler Gateway

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 受影响版本：NetScaler ADC 和 NetScaler Gateway 14.1版本低于43.56，13.1版本低于58.32

**利用条件:** 目标系统需配置为Gateway (VPN virtual server, ICA Proxy, CVPN, RDP Proxy) OR AAA virtual server，且网络可达

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-5777是NetScaler ADC和Gateway中由于输入验证不足导致的内存越界读取漏洞。当NetScaler配置为Gateway或AAA虚拟服务器时，攻击者可以通过发送特制的HTTP请求，触发对未初始化内存的读取，从而泄露服务器内存中的敏感信息。根据搜索结果，此漏洞也被称为CitrixBleed 2，并已在野外被利用。

漏洞利用方式：

1.  发送包含特定内容的POST请求到`/p/u/doAuthentication.do`端点。
2.  服务器返回包含`<InitialValue>`标签的XML响应，其中包含泄露的内存信息。
3.  PoC代码解析`<InitialValue>`标签中的内容，并以十六进制和ASCII格式打印出来。

代码分析：

提供的PoC代码是一个Python脚本，利用`requests`和`BeautifulSoup`库。

*   脚本接受一个URL作为参数，或者使用`-l`参数指定一个包含URL列表的文件。
*   脚本向目标URL的`/p/u/doAuthentication.do`端点发送POST请求，请求体为`login`。
*   脚本解析服务器返回的XML响应，查找`<InitialValue>`标签，并提取其内容。
*   如果`<InitialValue>`标签存在且内容不为空，则脚本认为目标易受攻击，并打印泄露的内存内容，并以十六进制和ASCII格式输出。

有效性评估：

根据漏洞库信息和搜索结果，提供的PoC代码应能有效利用该漏洞，因为其基本原理是发送特制的请求来触发内存泄露，且PoC中构造请求的方式与漏洞描述相符。多个搜索结果表明该漏洞已被公开利用。

投毒风险评估：

分析提供的PoC代码，未发现明显的恶意代码。脚本功能明确，即发送请求并解析响应以提取内存信息。 存在投毒代码的可能性较低，估计为1%。主要是考虑到网络资源获取过程中的潜在风险。


**项目地址:** [SleepNotF0und/CVE-2025-5777](https://github.com/SleepNotF0und/CVE-2025-5777)

**漏洞详情:** [CVE-2025-5777](https://nvd.nist.gov/vuln/detail/CVE-2025-5777)