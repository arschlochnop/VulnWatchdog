## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `sudo` 命令的 `--chroot` 选项来获取 root 权限。漏洞原因是 `sudo` 在使用 `--chroot` 时，会使用用户可控目录下的 `/etc/nsswitch.conf` 文件。攻击者可以构造恶意的 `nsswitch.conf` 文件，劫持动态链接库的加载，从而执行恶意代码。

**利用方式：**
1.  创建一个临时目录。
2.  在临时目录下，创建 `woot/etc` 和 `libnss_` 目录。
3.  在 `woot/etc` 目录下，创建恶意的 `nsswitch.conf` 文件，将 `passwd` 数据库指向 `/woot`。
4.  在 `libnss_` 目录下，编译一个共享库 `woot.so.2`，该共享库会在加载时执行提权操作（`setreuid(0,0); setregid(0,0); execl("/bin/bash","/bin/bash",NULL);`）。
5.  使用 `sudo -R woot woot` 命令，该命令会使用临时目录作为 chroot 的根目录，并加载恶意的 `nsswitch.conf` 和 `woot.so.2`，从而执行提权操作，获得 root shell。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞利用是有效的。搜索结果中CISA已经将此漏洞列入已知被利用的漏洞目录，说明其具有实际的威胁性。

**投毒风险：**
PoC 代码的主要功能是利用漏洞进行提权。虽然代码本身是为了利用漏洞，但潜在的投毒风险较低，大概在5%左右。
可能的风险点在于：
*   `woot.c` 中可以插入其他恶意代码，例如植入后门，收集用户信息等。虽然当前代码只是简单的提权，但理论上可以进行修改。
*   脚本本身可能会检查特定条件，例如特定的用户名或文件是否存在，然后才执行提权操作，从而有选择性地利用漏洞。

考虑到PoC的目的是为了验证漏洞，其重点在于提权，因此，更倾向于认为是一个功能完备的漏洞利用，而不是一个恶意的投毒代码。但潜在的风险依然存在，需要进行代码审计来确认是否存在隐藏的恶意行为。

**项目地址:** [r3dBust3r/CVE-2025-32463](https://github.com/r3dBust3r/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)