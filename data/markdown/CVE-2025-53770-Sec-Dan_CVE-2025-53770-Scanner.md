## CVE-2025-53770 Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致的远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition < 16.0.18526.20508

**利用条件:** 需要网络访问SharePoint服务器，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770是一个影响本地Microsoft SharePoint Server的反序列化漏洞，允许未经授权的攻击者通过网络执行代码。漏洞利用过程通常涉及以下几个步骤：

1.  **身份验证绕过：** 利用CVE-2025-53771通过头部欺骗绕过身份验证。
2.  **Web Shell 上传：** 上传恶意的ASPX Web Shell（例如`spinstall0.aspx`）到服务器。
3.  **密钥提取：** 从`web.config`文件中提取加密密钥。
4.  **ViewState反序列化：** 利用不安全的反序列化技术，通过ViewState执行远程代码。

提供的POC代码是一个扫描器，而非漏洞利用程序。它通过子域名枚举和HTTP请求来识别潜在的易受攻击的SharePoint服务器。该扫描器不执行实际的漏洞利用，仅用于识别潜在的攻击目标。

**关于投毒风险分析：**

提供的代码主要是一个扫描工具，其主要功能是检测目标是否存在漏洞，而不是直接利用该漏洞进行攻击。虽然代码本身没有明显的恶意行为，例如植入后门或删除数据，但仍然存在一定的投毒风险，主要体现在以下几个方面：

*   **依赖风险：** 该扫描器依赖于第三方库，如 `sublist3r`、`requests` 和 `rich`。这些库如果被恶意篡改，可能导致扫描器执行恶意代码。虽然这种风险较低，但不能完全排除。
*   **结果误导：** 扫描结果可能不准确，将未受漏洞影响的系统标记为易受攻击，从而误导用户采取不必要的措施，或将真实的受害者暴露出来。
*   **扫描行为滥用：** 尽管作者声明该工具仅用于授权测试，但恶意用户可能利用此扫描器大规模扫描网络，收集潜在的攻击目标信息，用于后续的攻击活动。

因此，虽然代码本身看起来没有直接的恶意行为，但考虑到其潜在的滥用风险和对第三方库的依赖，仍然存在一定的投毒风险。我估计投毒风险为10%。

**总结：**
该漏洞利用方式是利用SharePoint服务器的反序列化漏洞，通过上传恶意Web Shell，提取密钥并ViewState反序列化最终执行远程代码。


**项目地址:** [Sec-Dan/CVE-2025-53770-Scanner](https://github.com/Sec-Dan/CVE-2025-53770-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)