## CVE-2025-2825-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-2825

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致数据泄露、未授权文件访问和系统控制

**影响版本:** 10.0.0 - 10.8.3, 11.0.0 - 11.3.0

**利用条件:** 需要目标 CrushFTP 实例开放网络访问且在受影响的版本范围内，已知用户名

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-2825 是 CrushFTP 的一个严重身份验证绕过漏洞，CVSS 评分为 9.8。受影响的版本包括 10.0.0 到 10.8.3 和 11.0.0 到 11.3.0。该漏洞源于 S3 授权头部处理中的缺陷，允许未经身份验证的远程攻击者通过构造特定的 HTTP 请求来模拟已知用户，从而执行未经授权的操作，包括管理操作和数据检索。

**有效性：**

根据漏洞描述和搜索引擎结果，POC 代码很可能有效。 漏洞库信息和搜索结果都表明这是一个可以被利用的认证绕过漏洞，并且有可用的 POC。

**投毒风险：**

提供的 POC 仓库包含一个 README.md 文件和一个名为 payload 的文件。payload 文件包含一个精心制作的 HTTP GET 请求。该请求利用了 CrushFTP 的 /WebInterface/function/ 接口，尝试通过 'getUserList' 命令获取用户列表。关键在于 'Authorization: AWS4-HMAC-SHA256 Credential=crushadmin/' 头部，它试图通过伪造 S3 授权头来绕过身份验证。Cookie 头部也可能被用于会话维持或者其他目的，'c2f=zE1G'参数可能于绕过有关。

通过分析仓库文件，没有发现任何恶意代码或后门。代码的目的是利用身份验证绕过漏洞。因此，**投毒风险为 0%**。如果仓库包含执行额外操作（例如下载文件、执行系统命令）的代码，则会增加投毒的可能性，但目前的代码看起来是直接的漏洞利用。

**利用方式：**

1.  **确定目标 CrushFTP 实例版本：** 首先，攻击者需要确定目标 CrushFTP 实例是否在受影响的版本范围内（10.0.0 - 10.8.3 或 11.0.0 - 11.3.0）。
2.  **获取有效用户名：** 攻击者需要知道 CrushFTP 实例上的至少一个有效用户名（例如 crushadmin）。用户名可能通过信息泄露或其他途径获得。
3.  **构造恶意 HTTP 请求：** 攻击者需要构造一个包含伪造的 S3 授权头的 HTTP GET 请求。该请求的 Authorization 头部包含一个 Credential 字段，其中包含要模拟的用户名。请求的目标接口是 /WebInterface/function/，并指定一个命令（如 getUserList）。
4.  **发送请求并绕过身份验证：** 攻击者将构造的 HTTP 请求发送到目标 CrushFTP 实例。如果漏洞存在，CrushFTP 将错误地验证 S3 授权头，允许攻击者以指定用户的身份执行请求的操作。
5.  **执行未授权操作：** 成功绕过身份验证后，攻击者可以执行各种未授权操作，包括:
    *   获取敏感信息（例如用户列表、文件列表）。
    *   上传恶意文件。
    *   修改系统配置。
    *   执行管理命令。


**项目地址:** [punitdarji/crushftp-CVE-2025-2825](https://github.com/punitdarji/crushftp-CVE-2025-2825)

**漏洞详情:** [CVE-2025-2825](https://nvd.nist.gov/vuln/detail/CVE-2025-2825)