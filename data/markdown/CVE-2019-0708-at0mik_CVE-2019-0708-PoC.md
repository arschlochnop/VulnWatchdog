## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 需要目标系统开启RDP服务，且未打CVE-2019-0708补丁，无需身份验证。

**POC 可用性:** 半功能性

**投毒风险:** 70%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经验证的攻击者可以通过RDP连接到目标系统并发送特制的请求来利用此漏洞。根据提供的漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1和Windows Server 2008 R2 SP1等版本。

**有效性：**
提供的POC代码（`exp.py`和`README.md`）声称是“半功能性”的。`README.md`表明它提供了一些关于如何完成攻击的提示和伪代码，但并非一个可以直接使用的完整漏洞利用程序。`exp.py`包含RDP协议的初始化代码，但缺少实际的漏洞触发部分。根据README中的描述，需要用户自行构建shellcode并将其注入到RDP会话中。

**投毒风险：**
仓库中存在投毒风险，主要体现在以下几个方面：

1.  **不完整性：** POC代码是不完整的，需要用户自行添加shellcode。这意味着攻击者可以很容易地在shellcode中植入恶意代码。
2.  **误导性提示：** `README.md`中提供的关于如何完成攻击的提示可能存在误导，引导用户执行危险的操作。
3.  **依赖外部资源：** 完成漏洞利用需要用户在RDP目标机器上运行调试器，并进行堆喷等操作。这些操作本身就具有很高的风险，如果用户不具备充分的知识和经验，很容易导致系统崩溃或被恶意利用。

综合来看，此POC的投毒风险较高，大约为70%。

**利用方式：**

1.  **RDP连接：** 攻击者首先需要通过RDP连接到目标系统。
2.  **协议协商：** POC代码中的`exp.py`负责处理RDP协议的初始化和协商。
3.  **漏洞触发：** 攻击的核心在于发送精心构造的RDP请求，以触发RDP服务中的Use-After-Free漏洞。
4.  **堆喷：** 攻击者需要进行堆喷操作，以便将shellcode放置在可预测的内存地址上。
5.  **代码执行：** 成功触发漏洞后，程序控制流将被劫持，shellcode将被执行，从而实现远程代码执行。

从搜索结果中可以看到，Palo Alto Networks的Unit 42团队曾发布过关于此漏洞的分析报告，其中提到了多种利用此漏洞的方法。因此，此漏洞的利用方式是比较灵活的，攻击者可以根据实际情况选择合适的利用方法。

**项目地址:** [at0mik/CVE-2019-0708-PoC](https://github.com/at0mik/CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)