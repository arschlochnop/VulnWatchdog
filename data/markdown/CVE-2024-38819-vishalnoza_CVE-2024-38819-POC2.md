## CVE-2024-38819 - Spring Framework Path Traversal

**漏洞编号:** CVE-2024-38819

**漏洞类型:** Path Traversal

**影响应用:** Spring Framework

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Spring Framework 5.3.0 - 5.3.40, 6.0.0 - 6.0.24, 6.1.0 - 6.1.13

**利用条件:** 应用程序必须使用 WebMvc.fn 或 WebFlux.fn 提供静态资源。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38819 存在于 Spring Framework 的 WebMvc.fn 或 WebFlux.fn 功能组件中，当应用程序使用这些组件提供静态资源时，攻击者可以通过构造包含路径遍历字符（如 `..`）的恶意 HTTP 请求，访问服务器上未经授权的文件。

**漏洞利用方式：**

1.  **目标确认：** 确定目标应用程序是否使用 Spring Framework 的 WebMvc.fn 或 WebFlux.fn 组件提供静态资源。
2.  **构造恶意请求：** 构造包含路径遍历字符的 HTTP 请求，例如 `/static/link/%2e%2e/etc/passwd`，其中 `/static/link` 是静态资源映射的路径。
3.  **发送请求：** 将构造的请求发送到目标应用程序。
4.  **验证结果：** 如果攻击成功，服务器将返回 `/etc/passwd` 文件的内容，表明存在路径遍历漏洞。

**有效性分析：**

提供的 POC 代码利用了 Spring Boot 应用中使用 `RouterFunctions.resources` 处理静态资源时，由于对路径的校验不足，导致可以进行路径穿越读取文件。 POC 代码提供了一个 Dockerfile 来构建一个存在漏洞的 Spring Boot 应用，并提供了一个简单的 curl 命令来验证漏洞的存在，有效性高。

**投毒风险分析：**

分析了提供的代码仓库，包括 `LICENSE`，`README.md`，`Dockerfile`，`build.gradle`，以及 `PathTraversalDemoApplication.java`。没有发现任何可疑代码，例如执行恶意操作或连接外部服务器的代码。代码的目的是为了复现 CVE-2024-38819 漏洞。因此，投毒风险评估为 0%。

**项目地址:** [vishalnoza/CVE-2024-38819-POC2](https://github.com/vishalnoza/CVE-2024-38819-POC2)

**漏洞详情:** [CVE-2024-38819](https://nvd.nist.gov/vuln/detail/CVE-2024-38819)