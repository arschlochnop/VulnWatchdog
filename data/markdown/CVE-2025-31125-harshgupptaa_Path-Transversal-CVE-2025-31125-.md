## CVE-2025-31125-Vite-任意文件读取

**漏洞编号:** CVE-2025-31125

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 受影响版本：>= 6.2.0, < 6.2.4, >= 6.1.0, < 6.1.3, >= 6.0.0, < 6.0.13, >= 5.0.0, < 5.4.16, < 4.5.11

**利用条件:** Vite 开发服务器暴露在网络上，并且使用了受影响的版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31125 存在于 Vite 的开发服务器中，允许攻击者通过 `?inline&import` 或 `?raw?import` 绕过 `server.fs.deny` 配置，读取未授权的文件。 

**有效性：**
从漏洞库信息和搜索结果来看，该漏洞允许攻击者读取任意文件。提供的 POC 代码尝试读取 `/etc/passwd` 和 `/etc/hosts` 文件，并通过 base64 解码获取文件内容，根据代码逻辑判断POC的有效性较高。

**投毒风险：**
该POC 脚本主要功能是发送 HTTP 请求并解码响应，未发现明显的恶意行为。 `decode_base64`函数存在异常处理，但未执行任何恶意操作。`save_output`函数仅仅是保存结果到本地文件。代码中使用了 `urllib3.disable_warnings()` 来抑制 SSL 警告，这在渗透测试中比较常见，但可能隐藏了中间人攻击的风险。脚本作者在免责声明中声明仅用于授权的安全测试，但这并不排除被滥用的可能性。综合考虑，投毒风险较低，估计在10%。

**利用方式：**
1.  **目标确认：** 确认目标系统运行着受影响版本的 Vite 开发服务器，并且该服务器暴露在网络上（通过 `--host` 或 `server.host` 配置）。
2.  **构造 URL：** 构造包含 `?inline&import` 或 `?raw?import` 的特殊 URL，以绕过 `server.fs.deny` 配置。
3.  **发送请求：** 使用构造的 URL 向目标服务器发送 HTTP 请求。
4.  **获取文件内容：** 如果服务器存在漏洞，将会返回目标文件的内容，通常以 base64 编码的形式。 
5.  **解码内容：** 使用 base64 解码工具或脚本解码获取的文件内容。

**项目地址:** [harshgupptaa/Path-Transversal-CVE-2025-31125-](https://github.com/harshgupptaa/Path-Transversal-CVE-2025-31125-)

**漏洞详情:** [CVE-2025-31125](https://nvd.nist.gov/vuln/detail/CVE-2025-31125)