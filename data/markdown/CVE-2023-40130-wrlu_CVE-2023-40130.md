## CVE-2023-40130-Android-权限提升

**漏洞编号:** CVE-2023-40130

**漏洞类型:** 权限提升

**影响应用:** Android Telecomm 服务

**危害等级:** 高危，可能导致本地权限提升和后台活动启动

**影响版本:** Android 11, 12, 12L, 13

**利用条件:** 本地访问，低权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-40130 存在于 Android Telecomm 服务的 CallRedirectionProcessor.java 中，`onBindingDied` 函数存在逻辑错误，导致权限绕过。攻击者可以利用此漏洞提升权限，并在后台启动活动，而无需额外的执行权限。漏洞利用无需用户交互。

**有效性分析：**
从搜索结果和漏洞描述来看，漏洞是真实存在的，并且影响多个Android版本。漏洞利用代码部分提供了构建Android项目的基本文件（`build.gradle`, `gradle.properties`, `gradlew`），但并没有直接提供漏洞触发和利用的代码。因此，提供的代码片段本身**不直接**构成POC，但可以作为构建利用程序的基础。

**投毒风险分析：**
提供的build.gradle, gradle.properties, gradlew文件是标准的Android项目构建文件，本身不包含恶意代码。但是,任何build.gradle都可以配置为从外部仓库下载依赖项，并且执行任意代码，所以存在一定的风险，虽然是标准文件，但是依然存在隐蔽的风险。

*   `build.gradle`: 用于配置 Gradle 构建，例如依赖项、编译选项等。可能存在通过引入恶意依赖项进行投毒的风险。需要检查所有依赖项的来源和完整性。
*   `gradle.properties`: 用于配置 Gradle 的属性，例如 JVM 参数、并行构建等。一般不会包含恶意代码，但如果被篡改，可能会影响构建过程。
*   `gradlew`: Gradle Wrapper 脚本，用于在没有安装 Gradle 的情况下构建项目。本身是二进制文件和脚本文件，存在被替换为恶意脚本的风险，但通常会做完整性校验。

因此，这些文件**本身**直接包含恶意代码的可能性较低，但需要谨慎检查，特别是外部依赖项和gradlew的完整性，谨防被篡改。

**利用方式：**
1.  **构建利用程序：** 基于提供的`build.gradle`等文件，构建一个Android应用程序。
2.  **利用 CallRedirectionProcessor 的 onBindingDied 函数逻辑错误：**  需要进一步分析 `CallRedirectionProcessor.java` 的代码，找到导致权限绕过的具体逻辑错误。
3.  **触发漏洞：**  通过特定的方式触发 `onBindingDied` 函数，并利用其逻辑错误来提升权限，启动后台活动。

总而言之，提供的漏洞利用代码更多是搭建环境的基础，并非直接可用的 POC。需要结合漏洞原理和具体代码，进一步开发利用程序。

**项目地址:** [wrlu/CVE-2023-40130](https://github.com/wrlu/CVE-2023-40130)

**漏洞详情:** [CVE-2023-40130](https://nvd.nist.gov/vuln/detail/CVE-2023-40130)