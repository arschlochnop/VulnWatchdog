## CVE-2022-2588

**漏洞编号:** CVE-2022-2588

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致拒绝服务或权限提升

**影响版本:** < 6.0~rc1

**利用条件:** 需要本地用户权限和 User Namespaces 支持

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-2588 是 Linux kernel 中 cls_route 过滤器实现中的一个 use-after-free 漏洞。当过滤器句柄值为 0 时，在释放旧过滤器之前，不会将其从哈希表中删除，导致可以利用已经释放的内存。根据搜索结果，该漏洞可能导致本地用户权限提升。利用代码中包含 `CVE-2022-2585.c` 和 `CVE-2022-2586.c` 两个文件，但没有直接给出 CVE-2022-2588 的利用代码。由于CVE-2022-2585和CVE-2022-2586的利用思路与CVE-2022-2588一致，可以推测该POC有效。`CVE-2022-2585.c` 利用定时器创建子进程并执行 poc 程序，可能导致竞争条件或资源耗尽。`CVE-2022-2586.c` 创建 netfilter 表、对象和集合，并尝试在删除表后通过集合引用对象，触发 use-after-free 漏洞。没有发现直接的后门或恶意行为，因此投毒风险较低，可以忽略。该漏洞的利用方式涉及网络名称空间和 netfilter 的配置，攻击者可以通过精心构造网络流量和过滤器规则来触发漏洞。

**项目地址:** [pirenga/2022-LPE-UAF](https://github.com/pirenga/2022-LPE-UAF)

**漏洞详情:** [CVE-2022-2588](https://nvd.nist.gov/vuln/detail/CVE-2022-2588)