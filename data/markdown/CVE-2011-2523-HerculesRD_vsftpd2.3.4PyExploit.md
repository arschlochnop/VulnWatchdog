## CVE-2011-2523-vsftpd-Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可远程代码执行

**影响版本:** 2.3.4 (仅限20110630至20110703下载的版本)

**利用条件:** 目标主机运行存在后门的vsftpd 2.3.4，且攻击者可以访问目标主机的21端口和6200端口。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2011-2523 是 vsftpd 2.3.4 版本中的一个后门漏洞。该后门存在于 2011 年 6 月 30 日至 2011 年 7 月 3 日期间下载的特定版本中。 

**有效性:**

根据提供的漏洞库信息、搜索结果和漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出存在后门，搜索引擎结果也确认了该漏洞的存在，并提供了多个相关的链接，包括漏洞详情、利用代码等。

**利用方式:**

1.  **端口 21 (FTP):** 攻击者连接到目标主机上的 FTP 端口 (默认为 21)。
2.  **用户名:** 使用包含 `nergal:)` 的用户名进行身份验证。  后门代码会检测到 `:)` 结尾的用户名。
3.  **密码:** 使用任意密码。身份验证的目的是触发后门，而不是真正进行身份验证。
4.  **端口 6200 (反向 Shell):** 成功进行上述步骤后，后门将在目标主机上打开端口 6200，并监听连接。攻击者连接到目标主机的 6200 端口，获得一个 shell。

**投毒风险:**

分析提供的 `vsftpd234exploit.py` 脚本：

*   该脚本使用 `telnetlib` 连接到目标主机的 21 端口和 6200 端口。
*   它发送一个特殊的用户名 `nergal:)` 和任意密码来触发后门。
*   成功连接到 6200 端口后，它使用 `tn2.interact()` 允许攻击者与 shell 交互。
*   README.md 中也明确说明了攻击成功后会打开一个 shell，需要手动建立反向 shell。

该脚本的逻辑与漏洞描述一致，主要功能是利用已知的后门。脚本本身比较简洁，没有发现明显的恶意代码或者后门。

但是，仍然存在一定的投毒风险（虽然概率较低），可以从以下几个方面考虑：

*   **依赖项:** 脚本依赖于 `telnetlib`，虽然是 Python 标准库，但理论上存在被替换的风险（例如，通过修改 Python 环境）。
*   **网络环境:** 攻击者可能在网络环境中部署中间人攻击，篡改脚本内容。
*   **作者的信誉:** 无法完全信任代码作者，即使代码现在看起来没有问题，也不能保证作者将来不会发布恶意版本。

因此，我给出的投毒风险为1%。

**项目地址:** [HerculesRD/vsftpd2.3.4PyExploit](https://github.com/HerculesRD/vsftpd2.3.4PyExploit)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)