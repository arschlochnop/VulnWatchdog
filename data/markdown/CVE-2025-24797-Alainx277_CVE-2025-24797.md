## CVE-2025-24797-Meshtastic-缓冲区溢出

**漏洞编号:** CVE-2025-24797

**漏洞类型:** 缓冲区溢出

**影响应用:** Meshtastic

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.6.2

**利用条件:** 目标设备需广播数据包在默认信道

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24797是Meshtastic固件中的一个缓冲区溢出漏洞。该漏洞位于处理包含无效protobuf数据的mesh数据包时。攻击者可以通过发送包含恶意protobuf数据的mesh数据包，触发目标设备的缓冲区溢出，从而劫持程序执行流程，最终实现远程代码执行。从提供的ASAN日志来看，`RadioInterface::beginSending`函数中的`memcpy`操作是导致缓冲区溢出的根本原因。攻击者可以控制`payloadlen`的大小，使其大于分配的缓冲区，从而造成溢出。漏洞利用不需要身份验证或用户交互，只要目标设备在默认信道上重新广播数据包即可被利用。根据已有的信息，利用方式主要为：

1.  **构造恶意的Mesh数据包：** 攻击者需要构造一个包含无效protobuf数据的Mesh数据包，其中`payloadlen`字段需要设置为一个很大的值，超过目标缓冲区的大小。
2.  **发送恶意数据包：** 攻击者将构造好的恶意数据包发送到Meshtastic设备。
3.  **触发缓冲区溢出：** 当Meshtastic设备接收到恶意数据包并尝试处理时，由于`payloadlen`过大，`memcpy`操作会导致缓冲区溢出。
4.  **远程代码执行：** 攻击者通过控制溢出的内容，劫持程序执行流程，最终实现远程代码执行。

**投毒风险分析：**
提供的漏洞利用代码中，主要是漏洞的说明和ASAN的crash log，并没有实际的利用代码，因此无法直接判断是否存在恶意代码。但考虑到以下几点，仍然存在一定的投毒风险：

*   **潜在的利用代码：** README.md文件通常会包含漏洞的简要描述和利用方法。虽然当前只包含崩溃日志，但可能存在后续更新中添加利用代码的风险。
*   **依赖项风险：** 实际的利用可能依赖于其他库或工具，这些依赖项可能包含恶意代码。
*   **信息误导：** 即使代码本身没有恶意行为，攻击者也可能利用README中的信息来误导其他研究人员，使其在不知情的情况下运行恶意程序。

根据这些因素，我估计该漏洞利用代码库存在10%的投毒风险。这个风险主要来自于潜在的恶意依赖、未来代码更新的可能性以及被攻击者利用进行信息误导的可能性。


**项目地址:** [Alainx277/CVE-2025-24797](https://github.com/Alainx277/CVE-2025-24797)

**漏洞详情:** [CVE-2025-24797](https://nvd.nist.gov/vuln/detail/CVE-2025-24797)