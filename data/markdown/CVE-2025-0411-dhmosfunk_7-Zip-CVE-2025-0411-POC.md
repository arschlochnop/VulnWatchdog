## CVE-2025-0411-7-Zip Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) 绕过

**影响应用:** 7-Zip

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** < 24.09

**利用条件:** 用户需要下载并解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0411 是 7-Zip 中存在的 Mark-of-the-Web (MotW) 绕过漏洞。攻击者可以利用此漏洞，通过创建恶意压缩包，绕过 Windows 的安全警告，从而在用户不知情的情况下执行恶意代码。

**有效性：**
提供的 POC 代码是有效的。它演示了如何通过双重压缩文件来绕过 MotW。当用户使用易受攻击的 7-Zip 版本解压此类压缩包时，其中的可执行文件不会被标记为来自不受信任的来源，从而允许直接执行，而不会显示 Windows SmartScreen 警告。

**投毒风险：**
在提供的代码中，`loader.cpp` 文件包含了 calc.exe 的 shellcode。虽然这是一个简单的 payload，用于验证漏洞的存在，但它本身不包含任何恶意或隐藏的代码。此仓库的投毒风险评估为 0%。

**利用方式：**
1.  **创建恶意压缩包：** 攻击者首先需要创建一个包含恶意可执行文件的压缩包，然后再次将该压缩包进行压缩 (双重压缩)。
2.  **传播恶意压缩包：** 攻击者可以通过钓鱼邮件、恶意网站等方式，诱使用户下载该恶意压缩包。
3.  **用户解压：** 用户使用易受攻击的 7-Zip 版本解压该压缩包。
4.  **执行恶意代码：** 由于 MotW 被绕过，解压后的可执行文件可以直接运行，执行攻击者预设的恶意代码，如安装后门、窃取数据等。

**总结：**
CVE-2025-0411 是一个严重的安全漏洞，允许攻击者绕过 Windows 的安全机制，执行任意代码。用户应尽快升级到 7-Zip 24.09 或更高版本，并避免打开来自不明来源的压缩包。

**项目地址:** [dhmosfunk/7-Zip-CVE-2025-0411-POC](https://github.com/dhmosfunk/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)