## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** PAN-OS

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** PAN-OS 10.2, 11.0, 11.1, 11.2受影响版本

**利用条件:** 需要网络可以访问PAN-OS管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012 是 Palo Alto Networks PAN-OS 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者如果具有对管理 Web 界面的网络访问权限，则可以获得 PAN-OS 管理员权限，从而执行管理操作、篡改配置或利用其他经过身份验证的权限提升漏洞。根据搜索结果和漏洞描述，该漏洞的风险在于允许未经授权的访问和控制。漏洞利用代码通过构造特定的HTTP请求绕过身份验证，然后在目标系统上执行任意命令。由于攻击者可以执行任意命令，因此存在植入后门的风险。 

**漏洞利用方式：**

1.  **利用createRemoteAppwebSession.php 创建初始会话:** 通过构造包含命令注入Payload的POST请求发送到`/php/utils/createRemoteAppwebSession.php/watchTowr.js.map`，其中`X-PAN-AUTHCHECK` header设置为 `off`，并在`user`字段中注入恶意命令。该请求会将命令执行的结果写入`/var/appweb/htdocs/unauth/watchTowr.php`。
2.  **触发命令执行:**  利用index.php页面来触发执行`/var/appweb/htdocs/unauth/watchTowr.php`中的命令。

**投毒风险分析:**
代码本身是漏洞利用的PoC，实现了利用漏洞执行命令的功能。
*   PoC 中有向`/var/appweb/htdocs/unauth/`写入php文件的操作，如果服务器本身存在文件写入的权限问题，可能导致扩大攻击面。
*   PoC允许执行任意命令，如果攻击者在`--command`或者`--reverse-shell`中构造恶意的指令，可能会对目标造成更大的危害。
因此，存在一定的投毒风险，评估为10%。

**项目地址:** [0xjessie21/CVE-2024-0012](https://github.com/0xjessie21/CVE-2024-0012)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)