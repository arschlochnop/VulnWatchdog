## CVE-2017-10271-WebLogic Server-远程代码执行

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 远程代码执行

**影响应用:** WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问目标WebLogic Server的T3协议或HTTP协议端口(根据漏洞库信息和现有代码判断,HTTP可能性更大)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-10271是Oracle WebLogic Server中的一个远程代码执行漏洞。攻击者可以通过发送特制的SOAP请求到`/wls-wsat/CoordinatorPortType`端点，利用XMLDecoder反序列化漏洞，在目标服务器上执行任意命令。

**有效性：**
根据提供的漏洞信息和漏洞利用代码，该POC代码**有效**。漏洞库信息描述了未授权的攻击者可以通过T3协议利用该漏洞接管WebLogic Server，而提供的python脚本通过构造恶意的SOAP请求，利用`java.beans.XMLDecoder`进行反序列化操作，最终执行任意命令。

**投毒风险：**
分析提供的Python脚本，Payload中主要利用了java.beans.XMLDecoder，将XML格式的数据反序列化为java对象，并执行其中的命令。该脚本的主要功能是发送构造好的包含命令的payload，没有发现明显的后门或恶意代码，但仍存在一定风险：

1.  **命令执行的任意性：** 该脚本允许用户输入任意命令，这意味着攻击者可以通过该脚本执行恶意操作。虽然脚本本身不包含恶意代码，但用户的恶意使用可能会导致严重后果。
2.  **依赖外部组件：** 该脚本依赖于requests库。如果requests库本身存在漏洞或者被篡改，可能会导致安全问题。

综上所述，该POC脚本本身被投毒的可能性较低，但使用者可能存在恶意行为，因此**投毒风险为10%**。

**利用方式：**
1.  攻击者需要确定目标WebLogic Server存在CVE-2017-10271漏洞，且版本位于受影响范围内（10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0）。
2.  攻击者使用提供的Python脚本，指定目标WebLogic Server的URL，例如：`python CVE-2017-10271.py http://target_ip:7001`
3.  攻击者在脚本运行时，输入要执行的命令，例如：`whoami` 或 `touch /tmp/success`
4.  脚本构造包含恶意命令的SOAP请求，并发送到WebLogic Server的`/wls-wsat/CoordinatorPortType`端点。
5.  WebLogic Server解析SOAP请求，`java.beans.XMLDecoder`执行反序列化操作，从而执行攻击者指定的命令。
6.  如果命令执行成功，攻击者可以在目标服务器上执行任意操作。

**项目地址:** [s3xy/CVE-2017-10271](https://github.com/s3xy/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)