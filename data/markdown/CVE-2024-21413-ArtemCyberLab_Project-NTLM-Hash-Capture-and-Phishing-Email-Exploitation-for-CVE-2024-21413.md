## CVE-2024-21413 Microsoft Outlook Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致远程代码执行和系统被完全控制

**影响版本:** Office 2016版本小于 16.0.5435.1001，Office 2019、Microsoft 365 Apps for Enterprise、Office LTSC 2021 版本小于 https://aka.ms/OfficeSecurityReleases 指示的版本

**利用条件:** 受害者需要点击攻击者发送的包含恶意链接的邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413 是 Microsoft Outlook 中的一个远程代码执行漏洞，也被称为 'MonikerLink' 漏洞。攻击者可以通过发送包含特制 `file://` URL 的电子邮件来利用此漏洞，当用户点击该链接时，Outlook 会尝试访问该 URL 指向的文件，如果该 URL 指向攻击者控制的服务器，攻击者可以捕获 NTLM 哈希或触发其他恶意行为，甚至实现远程代码执行。

**漏洞利用有效性：**
根据提供的漏洞利用代码，该 POC 利用了 `file://` 协议处理不当的问题。POC 包含两个部分：使用 Responder 捕获 NTLM 哈希和使用 Python 脚本发送包含恶意 `file://` 链接的电子邮件。该方法利用了 Outlook 对 `file://` 协议的处理缺陷，在无需用户交互的情况下触发漏洞，因此判断POC具有有效性。

**投毒风险：**
该漏洞利用代码主要包含一个 Python 脚本，用于发送包含恶意链接的电子邮件。虽然脚本本身的功能是发送电子邮件，但其中包含的恶意链接可能导致受害者系统遭受攻击。Responder 工具用于捕获网络中的 NTLM 哈希，本身属于安全工具，但也被攻击者用于非法目的。该漏洞利用代码的主要风险在于利用邮件进行社工欺骗，诱导用户点击恶意链接。攻击者可以替换链接指向的恶意文件，执行任意命令，或者植入后门。该 POC 存在一定的投毒风险，评估为10%。

**利用方式：**
1.  攻击者使用 Responder 等工具监听网络，准备捕获 NTLM 哈希。
2.  攻击者构造包含恶意 `file://` 链接的电子邮件。链接指向攻击者控制的服务器或共享目录。
3.  攻击者将电子邮件发送给受害者。
4.  受害者打开电子邮件并点击恶意链接。
5.  Outlook 尝试访问该链接，导致 NTLM 认证信息泄露或触发其他恶意行为。
6. 攻击者可以利用捕获的 NTLM 哈希进行进一步的攻击，例如破解哈希或利用 Pass-the-Hash 技术。

**项目地址:** [ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413](https://github.com/ArtemCyberLab/Project-NTLM-Hash-Capture-and-Phishing-Email-Exploitation-for-CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)