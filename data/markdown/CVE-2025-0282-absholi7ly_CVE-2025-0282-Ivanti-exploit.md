## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问目标设备的443端口，目标设备运行受影响的Ivanti Connect Secure, Policy Secure, 或 Neurons for ZTA gateways 版本，且未应用补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0282是Ivanti Connect Secure, Policy Secure和Neurons for ZTA gateways中存在的栈溢出漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞在目标设备上执行任意代码。

**有效性分析：**

提供的Python POC代码尝试利用该漏洞。代码首先创建一个包含溢出数据的payload，其中包括覆盖返回地址的system()函数地址和要执行的命令地址。然后，它通过HTTPS连接到目标IP，发送包含payload的POST请求到`/dana-na/auth/url_default/welcome.cgi`端点。最后，它接收响应。

根据漏洞描述和搜索结果，该漏洞存在于IF-T连接的处理方式中，POC代码利用了`/dana-na/auth/url_default/welcome.cgi`这个url，与搜索结果中提及的信息一致。因此，该POC代码看起来有效。

**投毒风险分析：**

仔细检查提供的POC代码，发现以下潜在的风险点：

*   **Web Shell 上传：** 代码中包含上传Web Shell的功能，虽然这本身是漏洞利用的一部分，但如果攻击者上传恶意Web Shell，可能会导致持续性的后门访问。
*   **修改系统配置：** 代码包含禁用SELinux，阻止syslog转发，以及修改文件系统挂载方式的功能。这些操作会降低系统的安全性，方便攻击者进行进一步的恶意行为。
*   **日志清除：** 代码包含清除日志的功能，这会隐藏攻击痕迹，增加检测和溯源的难度。
*   **停止和禁用自动更新：**代码包含停止和禁用自动更新的功能。这会使系统无法及时获得安全补丁，长期处于脆弱状态。

虽然这些功能在渗透测试中可能被用作提权或维持权限的手段，但是存在被恶意滥用的风险。这些操作可以视为攻击者在成功利用漏洞后，为了维持访问、隐藏踪迹和进一步控制系统而采取的措施。因此，综合判断，存在10%的投毒风险，主要体现在这些功能可能被用于恶意目的，而非POC本身直接包含恶意代码。

**利用方式：**

1.  攻击者构造包含恶意代码的payload，该payload利用栈溢出漏洞覆盖返回地址，指向system()函数。
2.  攻击者将payload嵌入到发往`/dana-na/auth/url_default/welcome.cgi`端点的HTTP POST请求中。
3.  目标设备接收到请求，由于存在栈溢出漏洞，payload中的恶意代码被执行，导致远程代码执行。
4.  POC中进一步利用WebShell进行远程命令执行，以及禁用SELinux, 阻止日志转发等操作进一步控制和隐藏攻击行为。

**项目地址:** [absholi7ly/CVE-2025-0282-Ivanti-exploit](https://github.com/absholi7ly/CVE-2025-0282-Ivanti-exploit)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)