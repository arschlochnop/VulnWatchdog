## CVE-2018-6574-go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 目标机器使用受影响的Go版本，并尝试使用`go get`获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 漏洞允许攻击者在 `go get` 命令执行期间利用 gcc 或 clang 插件功能执行远程命令。漏洞原因是 Go 语言未阻止 `-fplugin=` 和 `-plugin=` 参数。提供的POC代码包含一个 `attack.c` 文件，该文件定义了一个名为 `malicious` 的函数，该函数在库加载时自动执行，执行 `/usr/local/bin/score 42689c33-83ff-47d2-b538-ac6931adc5d3` 命令。`main.go` 文件使用 cgo 来编译和链接 `attack.c` 文件，并通过 `#cgo CFLAGS: -fplugin=./attack.so` 指定了 gcc 插件。当执行 `go get` 获取包含此代码的仓库时，`attack.so` 会被编译并加载，导致 `malicious` 函数执行。由于 POC 代码的功能是执行预期的后门命令，因此**没有证据表明存在额外的投毒代码**。POC 的意图是展示漏洞，而不是隐藏恶意行为。

**漏洞利用方式：**
1.  攻击者创建一个包含恶意 `attack.c` 和 `main.go` 的 Go 项目。
2.  攻击者将该项目托管在可公开访问的仓库中。
3.  攻击者诱使用户（开发者）使用受影响的 Go 版本执行 `go get <attacker_repo>` 命令。
4.  当 `go get` 执行时，cgo 编译并链接 `attack.c`，导致 `malicious` 函数执行，从而在目标机器上执行任意命令。


**项目地址:** [elw0od/PentesterLab](https://github.com/elw0od/PentesterLab)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)