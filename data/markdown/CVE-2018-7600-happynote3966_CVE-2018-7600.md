## CVE-2018-7600-Drupal-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点需要存在漏洞且未打补丁，并且需要网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个Drupal核心的远程代码执行漏洞。由于Drupal对用户输入验证不足，导致攻击者可以通过构造特殊的请求，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码来看，该漏洞的POC代码是有效的。漏洞库和搜索结果中均提到该漏洞允许远程代码执行，并且存在多个可用的Exploit-DB条目。提供的Python脚本和Ruby脚本均为该漏洞的POC代码，可以被用来验证漏洞的存在。

**投毒风险：**
对提供的POC代码进行分析，发现其中可能存在投毒风险的可能性较低，约为10%。以下是分析结果：
*   Python脚本：该脚本较为简单，主要是发送一个包含恶意payload的POST请求，并在目标服务器上创建一个文件（hello.txt）。没有发现明显的恶意代码。
*   Ruby脚本：该脚本功能更为复杂，包含尝试写入PHP Webshell等功能，相较于Python脚本，风险略高，如果被篡改，可能存在植入恶意PHP代码的可能性。

总的来说，直接运行提供的代码风险较低，但从信誉未知的来源获取的任何代码，在执行之前都应该进行仔细的审查，因为攻击者可能修改这些代码以包含恶意功能。

**利用方式：**
利用方式主要是通过构造恶意的HTTP请求，利用Drupal的某些存在漏洞的参数（例如`element_parents`），将恶意代码注入到Drupal的后端处理流程中，从而实现远程代码执行。具体步骤如下：
1.  确定目标Drupal站点使用的版本是否在受影响的范围内。
2.  根据Drupal版本选择合适的POC代码（Python或Ruby）。
3.  修改POC代码中的目标URL和要执行的命令。
4.  运行POC代码，发送恶意请求。
5.  验证代码是否成功执行（例如，检查目标服务器上是否创建了指定的文件）。

攻击者可利用该漏洞获取服务器的控制权，从而进行恶意活动，例如：数据窃取、恶意软件传播、DDoS攻击等。

**项目地址:** [happynote3966/CVE-2018-7600](https://github.com/happynote3966/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)