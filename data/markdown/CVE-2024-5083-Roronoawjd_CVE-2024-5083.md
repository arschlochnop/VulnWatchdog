## CVE-2024-5083-Nexus Repository 2-存储型XSS

**漏洞编号:** CVE-2024-5083

**漏洞类型:** 存储型跨站脚本 (XSS)

**影响应用:** Sonatype Nexus Repository Manager 2

**危害等级:** 中危，可能导致账户劫持或恶意代码执行

**影响版本:** <= 2.15.1

**利用条件:** 需要有权限向 Nexus 仓库上传恶意构造的 Maven 组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-5083 是 Sonatype Nexus Repository Manager 2 中存在的存储型 XSS 漏洞。攻击者可以通过上传包含恶意 JavaScript 代码的 Maven 组件（例如 POM 文件）来触发此漏洞。当管理员或其他用户在 Nexus 界面中查看或操作此组件时，恶意 JavaScript 代码将被执行。

**有效性：**

提供的 POC 代码 `xss.pom` 看起来是有效的。它包含一个 XML 文件，其中 `project:script` 元素的内容是 `alert(document.location)`。当此 POM 文件被 Nexus Repository Manager 解析并显示时，这段 JavaScript 代码将被执行，弹出一个包含当前页面 URL 的警告框，证明 XSS 漏洞的存在。

**投毒风险：**

提供的 POC 代码片段本身不包含任何明显的投毒代码。它只是一个简单的 XSS payload，用于验证漏洞的存在。因此，投毒风险评估为 0%。

**利用方式：**

利用方式如下：

1.  攻击者构造一个包含恶意 JavaScript 代码的 Maven 组件 (POM 文件)。例如，将提供的 `xss.pom` 文件作为组件的一部分。
2.  攻击者将此恶意组件上传到 Nexus Repository Manager。
3.  当管理员或其他用户通过 Nexus 界面浏览、查看或操作该组件时（例如，查看 POM 文件内容），嵌入的恶意 JavaScript 代码将被执行。
4.  恶意 JavaScript 代码可以执行各种恶意操作，例如窃取 Cookie、重定向用户到恶意网站、修改页面内容，或者执行其他未经授权的操作。

**项目地址:** [Roronoawjd/CVE-2024-5083](https://github.com/Roronoawjd/CVE-2024-5083)

**漏洞详情:** [CVE-2024-5083](https://nvd.nist.gov/vuln/detail/CVE-2024-5083)