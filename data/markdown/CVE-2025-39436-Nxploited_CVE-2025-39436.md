## CVE-2025-39436-I Draw-任意文件上传

**漏洞编号:** CVE-2025-39436

**漏洞类型:** 任意文件上传

**影响应用:** I Draw WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0

**利用条件:** 需要WordPress后台具有高权限用户账号密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-39436 存在于 I Draw WordPress 插件 1.0 及更早版本中，是一个任意文件上传漏洞。攻击者需要具备WordPress后台高权限账号密码，通过登录后台，利用插件中的 idraw_upload.php 接口上传恶意 PHP 文件，从而实现远程代码执行。PoC 代码首先尝试登录 WordPress 后台，如果登录成功，则将一段 PHP 代码进行 Base64 编码，然后通过 POST 请求发送到 idraw_upload.php 接口。如果文件上传成功，攻击者就可以通过访问上传的 PHP 文件来执行任意代码。

**有效性：**
根据漏洞信息和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞库信息、搜索引擎结果以及提供的 PoC 代码都表明存在任意文件上传漏洞。

**投毒风险：**
PoC代码的投毒风险较低，约 10%。主要风险可能来自于以下几点：
1.  `session.verify = False`: PoC 代码中设置 `session.verify = False` 禁用了 SSL 证书验证，这在实际环境中可能导致中间人攻击，但不属于PoC本身的投毒。
2.  默认上传的php代码：默认情况下，PoC 上传的 PHP 代码仅输出一段字符串，风险较低。但如果攻击者修改了上传的 PHP 代码，可能会植入恶意后门。
3.  依赖库：`requirements.txt` 中声明了 `requests` 库，虽然该库本身没有明显投毒风险，但如果用户从非官方源安装，可能会引入被篡改的版本。

**利用方式：**
1.  **登录 WordPress 后台：** 使用提供的用户名和密码，通过 `wp-login.php` 登录 WordPress 后台。
2.  **获取 Session Cookie：** 成功登录后，从响应中提取 `wordpress_logged_in` cookie，该 cookie 用于后续的身份验证。
3.  **构造上传 Payload：** 将要执行的 PHP 代码进行 Base64 编码，并构造包含 `dataurl` (Base64 编码后的 PHP 代码)、`filename` (上传的文件名，后缀为 .php) 和 `logged_in_cookie` 的 POST 请求。
4.  **上传文件：** 将构造的 POST 请求发送到 `/wp-content/plugins/idraw/idraw_upload.php` 接口。
5.  **执行代码：** 如果文件上传成功，通过访问上传的文件 (例如 `/wp-content/uploads/2025/4/19/nxploit.php`) 来执行 PHP 代码。

**项目地址:** [Nxploited/CVE-2025-39436](https://github.com/Nxploited/CVE-2025-39436)

**漏洞详情:** [CVE-2025-39436](https://nvd.nist.gov/vuln/detail/CVE-2025-39436)