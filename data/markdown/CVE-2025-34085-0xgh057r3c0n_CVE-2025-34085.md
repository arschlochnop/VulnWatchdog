## CVE-2025-34085-Simple File List-RCE

**漏洞编号:** CVE-2025-34085

**漏洞类型:** 远程代码执行

**影响应用:** Simple File List WordPress Plugin

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 4.2.3

**利用条件:** 需要目标WordPress站点安装了Simple File List插件，且版本低于4.2.3，并且插件的上传目录可写。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Simple File List WordPress插件中，允许未经身份验证的远程攻击者执行任意代码。攻击者可以首先上传一个伪装成.png文件的PHP payload，然后利用插件的文件重命名功能将扩展名更改为.php，绕过上传限制，从而在服务器上执行上传的payload。

**有效性：**
提供的POC代码是有效的，因为它实现了漏洞描述中的利用步骤：上传伪装的文件，然后重命名为PHP文件。

**投毒风险：**
该POC代码的投毒风险较低，约为5%。主要风险点在于：
1.  `generate_payload` 函数，如果 `COMMAND` 或 `INLINE` 变量被恶意修改，可能导致执行非预期的命令。
2.  输出的内容可能被重定向或记录到外部服务器，虽然代码本身没有直接实现这个功能，但存在这种可能性。
3.  代码使用了 `verify=False` 禁用了SSL证书验证，可能存在中间人攻击的风险。但是这个是通用的payload调试选项，不算做投毒代码。

**利用方式：**
1.  **上传Payload：** 攻击者构造一个包含恶意PHP代码的文件，并将文件扩展名伪装成`.png`。
2.  **绕过验证：** 通过multipart/form-data POST请求，将伪装的PHP文件上传到`ee-upload-engine.php`。
3.  **重命名文件：** 利用`ee-file-engine.php`的重命名功能，将上传的`.png`文件重命名为`.php`，`.phtml`，`.php5`或者`.php3`等PHP可执行的扩展名。
4.  **执行代码：** 访问重命名后的PHP文件，服务器将执行其中的恶意代码，实现远程代码执行。

**项目地址:** [0xgh057r3c0n/CVE-2025-34085](https://github.com/0xgh057r3c0n/CVE-2025-34085)

**漏洞详情:** [CVE-2025-34085](https://nvd.nist.gov/vuln/detail/CVE-2025-34085)