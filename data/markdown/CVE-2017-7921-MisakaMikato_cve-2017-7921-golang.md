## CVE-2017-7921-Hikvision摄像机身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530等多个系列产品

**利用条件:** 目标设备需位于网络中，且漏洞版本存在。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921是Hikvision摄像机中发现的一个身份验证绕过漏洞。攻击者可以利用此漏洞，在无需提供有效凭据的情况下，获取设备的未授权访问权限，从而提升权限并访问敏感信息，甚至可能篡改设备配置。漏洞存在于多个系列的Hikvision摄像机固件版本中。根据漏洞利用代码，该漏洞可以通过发送特制的请求绕过身份验证。

**有效性：**
根据漏洞信息和搜索结果显示，此漏洞已经公开披露，并且存在可用的PoC代码。该PoC代码提供了一个Golang实现的利用程序，支持CVE-2017-7921漏洞利用模式和暴力破解模式，说明该漏洞利用的有效性较高。

**投毒风险：**
分析提供的PoC代码，主要功能是漏洞利用和密码爆破。其中，`README.md` 文件提供了详细的构建和使用说明，`go.mod` 和 `go.sum` 文件是Go语言的依赖管理文件，`LICENSE`文件是MIT开源协议。 代码本身看起来像是为了利用这个漏洞而设计的，用于测试和渗透目的。虽然PoC代码本身的功能是实现漏洞利用，但是任何来源不明的代码都存在潜在的风险。 漏洞利用代码使用了github.com上的第三方库，如果这些库被投毒，也可能会影响使用此exp的使用者。综合评估，投毒风险为10%。

**利用方式：**
利用方式主要有两种：
1.  **CVE-2017-7921漏洞利用模式：** 通过发送特定的恶意构造的请求，绕过身份验证，直接获取设备的访问权限。PoC代码中`-e`参数指定此模式，需要指定目标IP和端口。
2.  **暴力破解模式：** 如果直接利用漏洞不可行，PoC代码也支持通过暴力破解来尝试破解设备的密码。PoC代码中`-b`参数指定此模式，需要提供密码字典文件或单个密码，以及目标IP和端口。

攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Hikvision摄像机的IP地址和端口。
2.  使用PoC代码，选择CVE-2017-7921模式或者暴力破解模式。
3.  如果选择CVE-2017-7921模式，直接运行PoC代码即可尝试绕过身份验证。
4.  如果选择暴力破解模式，需要准备密码字典文件，并指定密码字典的路径。
5.  运行PoC代码，等待破解结果。

**项目地址:** [MisakaMikato/cve-2017-7921-golang](https://github.com/MisakaMikato/cve-2017-7921-golang)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)