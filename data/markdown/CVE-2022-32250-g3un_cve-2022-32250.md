## CVE-2022-32250-Linux Kernel Netfilter Use-After-Free

**漏洞编号:** CVE-2022-32250

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel Netfilter

**危害等级:** 高危，可导致权限提升至 root

**影响版本:** <= 5.18.1

**利用条件:** 需要创建 user/net 命名空间的能力

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-32250 是 Linux 内核 netfilter 子系统中的一个 use-after-free 漏洞。根据漏洞库信息和搜索结果，攻击者如果能够创建 user/net 命名空间，就可以利用此漏洞将权限提升到 root。

**有效性：**
根据搜索结果，已经有相关的利用代码和分析文章公开（例如：https://github.com/theori-io/CVE-2022-32250-exploit 和 https://www.nccgroup.com/us/research-blog/settlers-of-netlink-exploiting-a-limited-uaf-in-nf_tables-cve-2022-32250/ ）。这表明该漏洞是可以被利用的。

但是，提供的 POC 代码 `/tmp/f2ab93d92009870f2107b6f0c402dd40/README.md` 仅仅是一个 README 文件，没有实际的漏洞利用代码。因此，**不能直接验证POC的有效性**，需要获取实际可执行的PoC代码才行。尽管如此，考虑到已经有公开可用的漏洞利用，可以判定存在有效的POC。

**投毒风险：**
提供的文件 `/tmp/f2ab93d92009870f2107b6f0c402dd40/README.md` 仅仅包含 `# CVE-2022-32250`，**是一个空的 README 文件，不包含任何可执行的代码，因此直接的投毒风险较低。** 但考虑到可能被其他恶意文件覆盖，或被用作后续投毒的占位符，风险不可忽略。因此，投毒风险评估为10%。更高概率在于，下载利用代码时引入了未知的恶意代码。

**利用方式：**
根据漏洞库信息和搜索结果，漏洞利用方式大致如下：
1.  攻击者需要具备创建 user/net 命名空间的能力。
2.  漏洞位于 `net/netfilter/nf_tables_api.c` 文件中，由于 `NFT_STATEFUL_EXPR` 检查不正确，导致 use-after-free。
3.  通过精心构造的 netfilter 规则，触发 use-after-free 漏洞。
4.  利用 use-after-free 漏洞进行内存操作，最终实现权限提升。

总体而言，CVE-2022-32250 是一个严重的安全漏洞，攻击者可以利用该漏洞获得 root 权限。及时更新内核版本是防范此漏洞的有效方法。

**项目地址:** [g3un/cve-2022-32250](https://github.com/g3un/cve-2022-32250)

**漏洞详情:** [CVE-2022-32250](https://nvd.nist.gov/vuln/detail/CVE-2022-32250)