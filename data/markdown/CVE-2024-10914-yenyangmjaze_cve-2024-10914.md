## CVE-2024-10914-D-Link NAS 设备命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** 操作系统命令注入 (OS Command Injection)

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可远程执行任意命令，完全控制设备

**影响版本:** 受影响版本包括：DNS-320 Version 1.00, DNS-320LW Version 1.01.0914.2012, DNS-325 Version 1.01, Version 1.02, DNS-340L Version 1.08

**利用条件:** 需要网络可达目标设备，且目标设备运行受影响的版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10914 是 D-Link NAS 设备中 account_mgr.cgi 脚本中 cgi_user_add 命令的 name 参数存在命令注入漏洞。攻击者可以通过构造包含恶意命令的 name 参数，在目标设备上执行任意操作系统命令。 

**有效性:**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码（PowerShell 脚本），可以判断该漏洞利用是有效的。漏洞库信息明确指出存在命令注入漏洞，且有公开可用的利用代码。搜索引擎结果也表明该漏洞已被广泛讨论，并有实际利用案例。

**投毒风险:**

查看提供的powershell脚本，脚本主要由`Print-Banner`、`Verify-Vulnerability`、`Exploit-Target`三个函数组成，其中`Print-Banner`函数负责打印banner信息，`Verify-Vulnerability`函数负责验证是否存在漏洞，`Exploit-Target`函数负责漏洞利用。脚本中不存在任何恶意代码，用于在目标机器植入后门，或者进行恶意操作。

因此，投毒风险为0%。

**利用方式:**

1.  **查找目标:** 使用 Fofa (或 Shodan) 等搜索引擎，使用`app="D_Link-DNS-ShareCenter" && server=="lighttpd/1.4.25-devel-fb150ff"` dork 查找暴露在互联网上的 D-Link NAS 设备。
2.  **克隆 PoC 代码:** 从 GitHub 仓库克隆漏洞利用代码。
3.  **运行 PoC 代码:** 使用 PowerShell 脚本（cve-2024-10914.ps1）。需要提供目标设备的 URL 作为参数。
4.  **漏洞验证:**  PoC 脚本首先会验证目标设备是否存在漏洞，通过发送包含特定字符串的请求，检查响应中是否包含该字符串。
5.  **命令执行:** 如果目标存在漏洞，PoC 代码会进入交互模式，允许攻击者输入要执行的命令。PoC 代码会对命令进行 URL 编码，并将其插入到 /cgi-bin/account_mgr.cgi 请求的 name 参数中。目标设备执行该命令，并将结果返回给攻击者。

简而言之，攻击者通过向 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 发送包含恶意 `name` 参数的 GET 请求，实现在目标设备上执行任意命令。 例如：`/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=' ; 命令; '`

**项目地址:** [yenyangmjaze/cve-2024-10914](https://github.com/yenyangmjaze/cve-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)