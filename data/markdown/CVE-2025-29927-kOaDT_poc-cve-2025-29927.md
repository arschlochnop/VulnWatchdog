## CVE-2025-29927-Next.js中间件绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问

**影响版本:** 受影响版本：11.1.4 - 13.5.6, 14.0.0 - 14.2.25, 15.0.0 - 15.2.3

**利用条件:** 目标应用使用Next.js中间件进行授权检查，且运行于受影响的版本范围内。 需要网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927是Next.js中间件中的一个授权绕过漏洞。攻击者可以通过发送包含`x-middleware-subrequest`头部的恶意请求，绕过中间件的授权检查，从而访问受保护的资源。 

**漏洞有效性评估：**

根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以确认该漏洞的有效性。漏洞库信息明确指出该漏洞存在于特定版本的Next.js中，并提供了修复版本。搜索引擎结果中也包含了多个安全厂商和研究人员对该漏洞的分析和警告。PoC代码提供了一种利用该漏洞的具体方法，即通过发送带有`x-middleware-subrequest`头部的请求来绕过中间件。

**投毒风险评估：**

提供的PoC代码主要包含两个文件：README.md 和 exploit.js。

*   **README.md：** 描述了漏洞的细节、影响、修复版本以及PoC的使用方法。该文件主要用于提供信息和指导，不包含可执行代码，因此不存在投毒风险。
*   **exploit.js：** 是PoC的核心代码，用于发送带有`x-middleware-subrequest`头部的恶意请求。该代码相对简单，主要功能是构造和发送HTTP/HTTPS请求，并根据响应判断是否存在漏洞。仔细检查后，发现exploit.js本身没有明显的恶意代码或后门。所有操作都是围绕着测试漏洞是否存在。但依然需要人工审核确保代码没有隐藏的风险。

综合考虑，此仓库中存在作者隐藏的投毒代码的风险较低，大约为5%。此处的风险主要来自对代码的信任问题，以及可能存在的编码缺陷带来的安全风险。

**利用方式：**

1.  攻击者识别出目标Next.js应用，并确认其版本在受影响范围内。
2.  攻击者构造包含`x-middleware-subrequest`头部的HTTP/HTTPS请求。
3.  攻击者将构造的请求发送到目标应用的受保护路由。
4.  如果应用存在漏洞，中间件的授权检查将被绕过，攻击者可以成功访问受保护的资源。

**缓解措施：**

1.  升级Next.js版本到安全版本（>= 14.2.25 或 >= 15.2.3）。
2.  如果无法升级，可以阻止包含`x-middleware-subrequest`头部的外部请求到达Next.js应用。
3.  在中间件中添加额外的验证逻辑，以确保请求的合法性。

**项目地址:** [kOaDT/poc-cve-2025-29927](https://github.com/kOaDT/poc-cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)