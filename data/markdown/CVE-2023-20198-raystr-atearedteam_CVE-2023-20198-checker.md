## CVE-2023-20198-Cisco IOS XE Software Web UI Privilege Escalation

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响的设备

**影响版本:** 16.1.1 to 17.12.1a 等多个版本 (参考漏洞库信息)

**利用条件:** Web UI功能必须启用，且设备可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-20198 允许未经身份验证的攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。根据搜索引擎的结果，该漏洞已被积极利用。利用方式是，攻击者首先利用此漏洞获得初始访问权限，然后发出特权 15 命令来创建本地用户和密码组合。然后，攻击者利用另一个漏洞 (CVE-2023-20273) ，利用新创建的本地用户将权限提升为 root 并在文件系统中写入植入程序。 

提供的POC代码尝试通过向 `/webui/logoutconfirm.html` 发送带有 `logon_hash=1` 的POST请求来探测漏洞。如果响应状态码为200，并且响应内容的长度小于32个字符，则可能存在漏洞。POC代码扫描指定的子网，并尝试利用漏洞。 

关于投毒风险，POC代码本身相对简单，主要是网络扫描和HTTP请求。虽然不能完全排除恶意修改的可能性，但代码结构清晰，功能直接，隐藏恶意代码的概率较低。 投毒风险评估较低，大约5%。主要的风险点在于：
1.  **依赖未验证的requests库**：如果requests库本身被投毒，则会影响此脚本。
2.  **成功标志的判断**: 响应内容长度小于32可能是判断依据不足，如果恶意修改，可能导致误报或者漏报，将正常设备标记为存在漏洞，引导使用者进行进一步的恶意操作。

**项目地址:** [raystr-atearedteam/CVE-2023-20198-checker](https://github.com/raystr-atearedteam/CVE-2023-20198-checker)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)