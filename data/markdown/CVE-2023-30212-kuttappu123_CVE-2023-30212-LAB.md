## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** XSS

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户cookie泄露和网页内容篡改

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212是OURPHP <= 7.2.0版本中的一个跨站脚本漏洞，存在于/client/manage/ourphp_out.php文件中。攻击者可以通过构造包含恶意JavaScript代码的URL参数，诱使用户点击，从而执行XSS攻击。

**有效性：**

提供的POC代码有效。从README.md中可以看到，攻击者构造了如下URL：

`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(`xss`)</script>`

该URL将导致在受害者浏览器中执行alert(`xss`)，证明存在XSS漏洞。

**投毒风险：**

从提供的Dockerfile、README.md和admin.php代码来看，存在一定的投毒风险，但可能性较低。

*   Dockerfile主要用于构建包含OURPHP环境的Docker镜像，没有发现明显的恶意代码。
*   README.md提供了一个漏洞利用的演示，虽然描述了如何设置数据库密码，但是密码过于简单，可能被恶意利用。
*   admin.php是后台管理页面，存在登录验证逻辑，但是代码可读性较差，可能存在未知的安全问题。

考虑到这是一个漏洞演示环境，作者可能为了方便演示而简化了某些安全措施，因此不能完全排除投毒的可能性，但概率较低，估计为10%。

**利用方式：**

1.  攻击者构造包含恶意JavaScript代码的URL，例如：
    `http://example.com/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(`xss`)</script>`
2.  攻击者通过各种手段（例如，钓鱼邮件、社交媒体）诱使用户点击该URL。
3.  用户点击URL后，恶意JavaScript代码将在用户的浏览器中执行，攻击者可以利用该漏洞窃取用户的cookie，或者篡改网页内容。

**项目地址:** [kuttappu123/CVE-2023-30212-LAB](https://github.com/kuttappu123/CVE-2023-30212-LAB)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)