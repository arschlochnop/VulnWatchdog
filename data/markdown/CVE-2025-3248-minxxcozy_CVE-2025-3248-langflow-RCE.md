## CVE-2025-3248-Langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 需要网络访问Langflow实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-3248是Langflow 1.3.0之前版本中存在的代码注入漏洞。攻击者可以利用`/api/v1/validate/code`端点，通过发送特制的HTTP请求来执行任意代码，无需身份验证。

**有效性：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的POC代码是有效的。漏洞描述和搜索结果都表明，Langflow 1.3.0之前的版本容易受到此代码注入漏洞的影响。提供的POC代码利用Python装饰器或默认参数表达式在函数定义时执行代码的特性，成功实现了远程代码执行。

**投毒风险：**

分析了提供的POC代码（包括`README.md`, `docker-compose.yml`, 和 `payload.json`），没有发现明显的投毒代码。`docker-compose.yml`文件只是用于启动一个易受攻击的Langflow 1.2.0实例，方便复现漏洞。`payload.json`包含的PoC代码仅仅是执行`id`命令，用于验证漏洞的存在，没有包含任何后门或者恶意行为。`README.md`文件详细描述了漏洞原理和复现步骤。因此，可以认为此仓库的投毒风险为0%。

**利用方式：**

1.  攻击者向 `/api/v1/validate/code` 端点发送 POST 请求。
2.  请求体中包含一个 JSON 对象，其中 `code` 字段包含恶意的 Python 代码，这段代码利用了 Python 装饰器或默认参数表达式的特性，在函数定义时执行。
3.  Langflow 服务器在收到请求后，尝试使用 `ast` 模块解析并使用 `exec` 执行这段代码。由于装饰器和默认参数表达式在函数定义时执行，攻击者可以借此注入任意代码。
4.  服务器执行恶意代码，攻击者从而获得服务器的控制权。

**项目地址:** [minxxcozy/CVE-2025-3248-langflow-RCE](https://github.com/minxxcozy/CVE-2025-3248-langflow-RCE)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)