## CVE-2025-32429 - XWiki Platform SQL 注入

**漏洞编号:** CVE-2025-32429

**漏洞类型:** SQL 注入

**影响应用:** XWiki Platform

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 9.4-rc-1 到 16.10.5 和 17.0.0-rc-1 到 17.2.2

**利用条件:** 需要网络访问 XWiki 平台，并且目标系统存在漏洞版本的 XWiki。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32429 是 XWiki Platform 中的一个 SQL 注入漏洞，存在于 `getdeleteddocuments.vm` 模板的 `sort` 参数中。攻击者可以通过构造恶意的 SQL 语句，利用 `sort` 参数作为 ORDER BY 的值进行注入。

**有效性：**
提供的 PoC 代码尝试利用该漏洞。代码使用 curl 发送带有恶意 payload 的 HTTP 请求，payload 包含 SQL 注入语句。如果目标 XWiki 平台存在漏洞，则注入可能会成功。

**投毒风险：**
PoC 代码本身是用 C 编写的，主要功能是发送 HTTP 请求。代码包含了一些看似多余的汇编代码，例如`exitAssembly`函数，这个函数看起来是为了直接通过系统调用退出程序,但这个函数并没有被调用,并且在curl初始化失败的情况下通过系统调用来执行ping命令。虽然这段汇编代码本身没有明显的恶意行为，但它增加了代码复杂性，存在潜在的隐藏恶意行为的可能性。因此, 投毒风险评定为10%。

**利用方式：**
1.  **确定目标 XWiki 平台版本：** 确认目标 XWiki 平台版本在漏洞影响范围内 (9.4-rc-1 到 16.10.5 和 17.0.0-rc-1 到 17.2.2)。
2.  **构造恶意 URL：**  构造包含 SQL 注入 payload 的 URL，该 payload 附加到 `getdeleteddocuments.vm` 模板的 `sort` 参数。
3.  **发送 HTTP 请求：** 使用 curl 或其他 HTTP 客户端发送包含恶意 URL 的 HTTP 请求。
4.  **分析响应：**  根据响应判断注入是否成功。可能的成功标志包括错误信息、延迟或数据泄露。

**项目地址:** [amir-othman/CVE-2025-32429](https://github.com/amir-othman/CVE-2025-32429)

**漏洞详情:** [CVE-2025-32429](https://nvd.nist.gov/vuln/detail/CVE-2025-32429)