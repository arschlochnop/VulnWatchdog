## CVE-2018-15473 OpenSSH 用户枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 目标系统运行受影响的OpenSSH版本，且允许SSH连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞是 OpenSSH 7.7 及更早版本中存在的一个用户枚举漏洞。由于 OpenSSH 在完全解析包含请求的数据包之前，不会延迟对无效身份验证用户的 bailout，攻击者可以通过发送特制的请求，根据服务器响应时间的不同来判断用户是否存在。

**有效性:**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果都确认了该漏洞的存在，并且给出了受影响的版本范围。提供的 Python 脚本 `CVE-2018-15473.py` 实现了利用该漏洞进行用户枚举的 POC 代码，并且README描述了如何使用它来验证单个用户或者用户列表是否存在于目标主机上。

**投毒风险:**
该 POC 代码的投毒风险较低，约为 10%。主要原因是：
*   代码相对简单，功能明确，主要用于用户枚举，不太可能隐藏恶意代码。
*   代码中包含了一些异常处理机制，防止程序崩溃。
*   原作者已经公开了代码。
可能的投毒风险在于，攻击者可能会修改脚本，例如：
*  添加额外的网络请求，在枚举用户的同时收集其他信息。
*  修改错误处理逻辑，在特定情况下隐藏错误信息，导致用户无法察觉枚举失败。
*  在用户枚举成功时执行某些恶意操作，如尝试使用默认密码登录等。
需要对代码进行仔细审查，确保没有隐藏的恶意行为。

**利用方式:**
1.  攻击者运行 `CVE-2018-15473.py` 脚本，指定目标 IP 地址和用户名或用户名字典。
2.  脚本会尝试与目标 SSH 服务建立连接。
3.  对于每个用户名，脚本发送一个特制的 SSH 认证请求。
4.  根据服务器响应时间或返回的错误信息，判断用户名是否存在。
5.  脚本输出存在的用户名列表。

利用此漏洞进行用户枚举后，攻击者可以结合其他攻击手段，例如密码破解、漏洞利用等，来进一步入侵目标系统。

**项目地址:** [Sait-Nuri/CVE-2018-15473](https://github.com/Sait-Nuri/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)