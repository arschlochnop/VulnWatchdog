## CVE-2017-11882-Microsoft Office Memory Corruption

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存损坏

**影响应用:** Microsoft Office

**危害等级:** 高危，允许攻击者在当前用户上下文中执行任意代码

**影响版本:** Microsoft Office 2007 SP3, 2010 SP2, 2013 SP1, 2016

**利用条件:** 需要用户打开包含恶意Equation Editor对象的Office文档

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-11882 是一个 Microsoft Office 的内存损坏漏洞，存在于 Equation Editor 组件中。攻击者可以通过构造包含恶意 Equation Editor 对象的 RTF 文档来触发此漏洞。当用户打开该文档时，Office 在处理 Equation Editor 对象时发生内存损坏，允许攻击者执行任意代码。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞已被广泛利用，存在公开的 PoC 代码，并且在野外有实际攻击案例。因此，提供的 PoC 代码很可能有效。

**投毒风险：** 分析提供的 Python 脚本 `Command109b_CVE-2017-11882.py`：

*   脚本的功能是生成一个利用 CVE-2017-11882 的 RTF 文档，该文档包含一个嵌入的 Equation.3 对象，该对象被构造为执行指定的命令。
*   脚本限制了命令的长度为 109 字节，这是因为作者无法修改结构体中的长度参数。
*   脚本通过 `regsvr32` 命令远程加载 SCT 文件。

从代码本身来看，没有明显的恶意代码或后门。但是，脚本依赖于用户提供的命令，如果用户提供的命令是恶意的，例如下载和执行恶意软件，那么生成的 RTF 文档也会是恶意的。

脚本的投毒风险评估为 1%，这个低百分比是因为代码本身没有直接包含任何恶意的功能或者后门，而风险主要在于用户提供的命令可能被利用于执行恶意操作。虽然存在这种间接风险，但不是直接的投毒。

**利用方式：**

1.  攻击者构造一个恶意的 RTF 文档，其中包含一个特制的 Equation Editor 对象。
2.  该 Equation Editor 对象利用 CVE-2017-11882 漏洞，在内存中执行攻击者指定的命令。
3.  攻击者通常使用 `regsvr32` 命令从远程服务器下载并执行 SCT 文件，SCT 文件包含 PowerShell 脚本或其他恶意代码。
4.  攻击者可以利用执行的恶意代码来安装恶意软件、窃取凭据或执行其他恶意操作。
5.  攻击者通过电子邮件、网络钓鱼或其他方式诱骗用户打开该 RTF 文档。
6.  当用户打开该文档时，Equation Editor 组件会尝试处理该对象，从而触发漏洞并执行攻击者的代码。

**项目地址:** [tzwlhack/CVE-2017-11882](https://github.com/tzwlhack/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)