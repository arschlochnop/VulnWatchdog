## CVE-2019-9978 Social Warfare Plugin Stored XSS

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS

**影响应用:** WordPress Social Warfare Plugin

**危害等级:** 中危，可能导致用户凭据泄露，恶意脚本执行

**影响版本:** < 3.5.3

**利用条件:** 需要WordPress管理员权限或能够影响插件设置的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是一个存储型XSS漏洞，存在于WordPress Social Warfare插件3.5.3之前的版本中。攻击者可以通过`wp-admin/admin-post.php?swp_debug=load_options`的`swp_url`参数注入恶意JavaScript代码。由于漏洞位于插件设置中，因此需要具备管理员权限或能够修改插件设置的权限。利用方式如下：

1.  攻击者构造包含恶意JavaScript代码的`swp_url`参数。
2.  攻击者通过`wp-admin/admin-post.php?swp_debug=load_options`提交包含恶意代码的请求。
3.  恶意代码被存储在插件的设置中。
4.  当管理员或其他用户访问包含受影响插件设置的页面时，恶意JavaScript代码被执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及利用代码`https://www.exploit-db.com/exploits/46794/`，该漏洞的利用是有效的，并且已经在野外被利用。

**投毒风险：**
提供的代码片段是Apache 2.0 License的声明，不包含任何可执行代码或恶意代码。因此，该代码片段本身不构成投毒风险。但是，不能排除在完整的漏洞利用代码（例如Exploit-DB上的代码）中存在其他恶意代码的可能性，但根据目前的信息，没有发现明显的投毒迹象。

**利用方式：**
利用方式主要通过构造恶意的`swp_url`参数，该参数未经过充分的过滤，导致恶意JavaScript代码被存储到数据库中。当管理员或用户访问相关页面时，恶意代码被执行，从而实现XSS攻击。这种攻击的危害包括但不限于：窃取用户Cookie、重定向用户到恶意网站、篡改网页内容等。


**项目地址:** [hash3liZer/CVE-2019-9978](https://github.com/hash3liZer/CVE-2019-9978)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)