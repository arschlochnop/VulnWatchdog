## CVE-2015-1635 HTTP.sys 远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2

**利用条件:** 目标系统需要运行存在漏洞的HTTP.sys服务，攻击者需要能够发送HTTP请求到目标服务器。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Microsoft Windows系统的HTTP.sys驱动中。攻击者通过发送特制的HTTP Range请求，导致整数溢出，从而可能触发远程代码执行。

**有效性：**
提供的Python POC代码通过发送包含特定Range头的HTTP请求来检测目标是否存在MS15-034漏洞。它首先发送一个简单的GET请求来确认目标是否是IIS服务器，然后发送包含恶意Range头的请求。如果服务器返回"Requested Range Not Satisfiable"，则表示存在漏洞。

**投毒风险：**
查看提供的POC代码、LICENSE和README文件。POC代码主要用于检测漏洞是否存在，代码逻辑相对简单，未发现任何用于植入后门或者执行恶意操作的迹象。 LICENSE文件为MIT License，允许自由使用和修改。 README文件仅仅是POC的使用说明。

因此，此仓库中存在作者隐藏的投毒代码的风险为0%。

**利用方式：**
1.  攻击者构造一个恶意的HTTP请求，其中包含畸形的Range头，该Range头的值会导致HTTP.sys驱动在处理时发生整数溢出。
2.  当HTTP.sys驱动尝试处理该Range头时，整数溢出会导致缓冲区溢出或其他内存损坏。
3.  攻击者可以利用此内存损坏漏洞来执行任意代码，从而完全控制目标系统。

POC通过检测服务器对恶意Range请求的响应来判断漏洞是否存在，但真正的利用需要更复杂的payload来执行代码。

**项目地址:** [aedoo/CVE-2015-1635-POC](https://github.com/aedoo/CVE-2015-1635-POC)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)