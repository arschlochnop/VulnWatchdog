## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias配置的目录没有配置 "require all denied"，CGI scripts如果开启也可能导致远程代码执行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773是Apache HTTP Server 2.4.49版本中存在的路径遍历漏洞。该漏洞源于Apache HTTP Server在处理URL路径时存在缺陷，允许攻击者通过构造包含`%2e`编码的`..`（点点斜杠）的恶意请求，绕过Alias配置的目录限制，访问服务器上的任意文件。如果目标服务器上Alias配置的目录没有配置 "require all denied"，且开启了CGI脚本执行功能，攻击者可以利用该漏洞读取敏感文件，甚至执行任意代码。

**有效性分析：**

提供的POC代码通过docker-compose搭建了包含漏洞的Apache HTTP Server 2.4.49环境，并提供了Python脚本来验证漏洞。`no-cgid/exploit.py`脚本构造了包含`%2e%2e`编码的路径遍历URL，尝试读取`/etc/passwd`文件。从代码结构来看，该POC能够有效验证漏洞的存在，实现任意文件读取。

**投毒风险分析：**

分析仓库中的代码，可以得出以下结论：

*   **`README.md`：** 描述了漏洞信息和POC的使用方法，未发现恶意代码。
*   **`docker-compose.yml`：** 定义了Docker容器的配置，用于搭建漏洞环境，未发现恶意代码。
*   **`no-cgid/Dockerfile`：** 使用httpd:2.4.49镜像，并拷贝了`httpd.conf`文件，未发现恶意代码。
*   **`no-cgid/exploit.py`：** 用于验证漏洞的Python脚本，功能是发送包含路径遍历的HTTP请求，未发现恶意代码。
*   **`no-cgid/httpd.conf`：** Apache的配置文件，没有配置 "require all denied"，未发现恶意代码。

综合来看，仓库中主要包含漏洞环境搭建和验证代码，**但仍然存在一定的投毒风险，约为10%**。可能的投毒方式包括：

1.  在`httpd.conf`中插入恶意配置，例如开启不安全的功能或设置错误的权限，导致其他安全问题。
2.  在`exploit.py`中添加恶意代码，例如在成功利用漏洞后执行其他操作，例如反弹shell等。
3. 镜像来源存在风险，Docker Hub上的镜像可能被篡改。虽然使用了官方的 `httpd:2.4.49`镜像，但依旧存在潜在的风险。

**利用方式：**

1.  **路径遍历：** 攻击者构造包含`%2e%2e`编码的路径遍历URL，例如`/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`，尝试读取服务器上的任意文件。
2.  **信息泄露：** 如果路径遍历成功，攻击者可以读取敏感配置文件、源代码等信息，进一步了解系统架构和安全策略。
3.  **远程代码执行 (如果CGI启用)：** 如果服务器启用了CGI，攻击者可以利用路径遍历上传恶意脚本，并通过CGI执行，从而获取服务器的控制权。
4.  **权限绕过：** 如果Alias配置不当，攻击者可能绕过访问控制，访问受保护的资源。

**项目地址:** [skentagon/CVE-2021-41773](https://github.com/skentagon/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)