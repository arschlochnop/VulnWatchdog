## CVE-2023-4220 - Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以上传WebShell，从而完全控制服务器，窃取机密信息，安装勒索软件

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行 Chamilo LMS 且版本低于或等于 1.11.24，并且未进行漏洞修复

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4220 存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传恶意文件（WebShell），从而实现远程代码执行。POC 代码通过构造包含恶意 PHP 代码的文件，并利用 bigUpload 功能上传该文件。上传成功后，攻击者可以通过访问该文件来执行任意命令。代码中存在轻微的投毒风险，因为攻击者可能会修改上传的文件内容，例如，在 WebShell 中加入恶意代码，用于收集用户信息或者进行其他恶意活动。但仓库中LICENSE文件是标准的MIT协议,文件结构简单,基本可以排除作者投毒风险,该风险主要存在于使用者,如果使用者修改了代码，那投毒风险会提升。

**利用方式：**
1.  攻击者利用未经身份验证的文件上传漏洞，将包含恶意 PHP 代码的 Webshell 文件上传到 `/main/inc/lib/javascript/bigupload/files/` 目录下。
2.  攻击者通过构造特定的 URL 请求，访问上传的 Webshell 文件，并传递要执行的命令。
3.  服务器执行 Webshell 中的 PHP 代码，从而执行攻击者指定的命令。
4.  攻击者利用执行的命令获取服务器的控制权，例如，反弹 Shell。

**POC 代码分析：**
*   `CVE-2023-4220.py`: 该 Python 脚本实现了漏洞利用的自动化，它首先构造包含反弹 Shell 代码的 Webshell 文件，然后将其上传到目标服务器，最后通过发送 GET 请求触发 Webshell 的执行。
*   `README.md`: 包含漏洞的简要描述和利用方法。
*   `LICENSE`: 使用 MIT 许可证。

**项目地址:** [thefizzyfish/CVE-2023-4220_Chamilo_RCE](https://github.com/thefizzyfish/CVE-2023-4220_Chamilo_RCE)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)