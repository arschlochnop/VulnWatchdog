## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat服务器开启HTTP PUT方法（readonly参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过发送特制的HTTP PUT请求上传包含恶意代码的JSP文件到服务器上。上传的JSP文件随后可以被访问并执行，从而导致远程代码执行。该漏洞存在于Apache Tomcat 7.0.0 to 7.0.81, 8.0.0.RC1 to 8.0.46, 8.5.0 to 8.5.22, 9.0.0.M1 to 9.0.0 版本中，**利用方式如下：**

1.  **前提条件：** 目标Tomcat服务器的`readonly`初始化参数必须设置为`false`，即允许HTTP PUT请求。
2.  **漏洞利用：** 攻击者构造一个HTTP PUT请求，将包含恶意代码的JSP文件上传到服务器。JSP文件中的代码会在服务器上执行。
3.  **代码分析：** 提供的PoC代码上传一个包含反弹shell的JSP文件，一旦JSP文件被访问，它将尝试建立一个与攻击者控制机器的反向TCP连接，从而允许攻击者在受害服务器上执行任意命令。
4.  **有效性：** 根据漏洞信息和提供的PoC代码，此PoC大概率有效,需目标服务器满足漏洞利用条件。
5.  **投毒风险：**  PoC代码主要功能是上传和执行JSP后门。虽然主逻辑是反弹shell，但存在一定的投毒风险，比如修改反弹shell的目标地址、端口或者添加额外的恶意代码，可能性为10%。这个比例评估了作者在反弹shell之外偷偷插入其它恶意行为的可能性。通常来说，公开的PoC为了提高可用性，会尽量避免明显的恶意行为，但不能完全排除。
6.  **缓解措施：** 升级Tomcat版本到不受影响的版本，或者将`readonly`初始化参数设置为`true`，禁用HTTP PUT方法。

**项目地址:** [LongWayHomie/CVE-2017-12617](https://github.com/LongWayHomie/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)