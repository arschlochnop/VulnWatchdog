## CVE-2022-0824 - Webmin Improper Access Control RCE

**漏洞编号:** CVE-2022-0824

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Webmin

**危害等级:** 高危，允许未经授权的远程代码执行

**影响版本:** < 1.990

**利用条件:** 需要已认证的低权限用户访问Webmin，无需File Manager模块的访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0824 漏洞是 Webmin 1.990 版本之前存在的一个权限绕过导致的远程代码执行漏洞。攻击者通过利用文件管理器模块中的权限控制缺陷，即使是未授权访问文件管理器的低权限用户，也可以执行文件管理器的功能，例如从远程 URL 下载文件和更改文件权限 (chmod)。利用方式是攻击者可以上传一个精心设计的 .cgi 文件，然后通过文件管理器功能更改其权限使其可执行，从而实现远程代码执行。

**有效性分析：**
根据漏洞信息和搜索结果，该漏洞的POC是可用的，并且已经被公开。提供的 Dockerfile 和 docker-compose.yaml 文件描述了如何快速部署一个存在漏洞的 Webmin 1.984 实例，方便漏洞验证和利用。 README.md 描述了漏洞的利用方式，表明利用该漏洞需要已认证的低权限用户。

**投毒风险分析：**
提供的 Dockerfile 中，镜像来源明确，安装的 Webmin 版本是 1.984，符合漏洞描述。虽然存在通过echo命令向entrypoint.sh文件写入命令,但该命令是为了启动webmin服务和设置cron任务，属于POC本身需要的环境配置，不属于投毒代码。风险主要在于使用该镜像的人是否会更改Dockerfile，例如引入其他来源的deb包或执行恶意脚本。因此，推测存在约10%的投毒风险，主要来源于用户对环境的自行修改。

**利用方式总结：**
1.  攻击者需要拥有 Webmin 的低权限账户。
2.  攻击者利用文件管理器模块中的权限绕过漏洞，即使没有文件管理器访问权限也可以执行相关操作。
3.  攻击者上传一个包含恶意代码的 .cgi 文件。
4.  攻击者使用文件管理器功能更改上传的 .cgi 文件的权限，使其可执行。
5.  攻击者通过访问该 .cgi 文件，触发恶意代码的执行，实现远程代码执行。

**项目地址:** [honypot/CVE-2022-0824](https://github.com/honypot/CVE-2022-0824)

**漏洞详情:** [CVE-2022-0824](https://nvd.nist.gov/vuln/detail/CVE-2022-0824)