## CVE-2025-47227 - ScriptCase 管理员密码重置漏洞

**漏洞编号:** CVE-2025-47227

**漏洞类型:** 身份验证绕过

**影响应用:** ScriptCase

**危害等级:** 高危，可导致管理员账户接管和远程代码执行

**影响版本:** <= 9.12.006 (23)

**利用条件:** 需要访问ScriptCase Production Environment模块的网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-47227 存在于 Netmake ScriptCase 9.12.006 (23) 及更早版本的 Production Environment 扩展中。该漏洞允许未经身份验证的攻击者通过不当处理的管理员密码重置机制来绕过身份验证，从而接管管理员帐户。漏洞利用方式为：

1.  **密码重置 (CVE-2025-47227):**  攻击者可以向 `login.php` 发送 GET 和 POST 请求来重置管理员密码，绕过身份验证。
2.  **远程命令执行 (CVE-2025-47228):**  与密码重置漏洞结合使用，攻击者可以通过修改 SSH 连接设置中的 shell 注入漏洞来执行系统命令。需要注意的是，该命令执行是经过身份验证的，因此需要先利用密码重置漏洞。

**POC有效性：**
提供的 POC 代码通过结合密码重置漏洞（CVE-2025-47227）和命令执行漏洞（CVE-2025-47228）来实现预身份验证的远程命令执行。

**投毒风险：**
对提供的 `exploit.py` 代码进行了分析，发现其主要功能是利用漏洞，并没有明显的恶意投毒代码。代码包含处理验证码的部分,较为复杂,存在一定概率作者在验证码处理流程中留下后门或者隐蔽的恶意代码，但是概率极低。`README.md` 文件描述了漏洞利用方式和使用方法，没有发现可疑内容。因此，投毒的风险较低，但是依旧需要关注请求地址以及命令执行函数的安全性, 防止回连等恶意操作。

基于以上分析，判定投毒风险为 **1%**

**利用方式：**

1.  使用 `python exploit.py -u http://example.org/scriptcase -c "command"` 命令利用密码重置漏洞并执行命令。
2.  使用 `python exploit.py -u http://example.org/scriptcase` 命令仅重置密码。
3.  使用 `python exploit.py -u http://example.org/scriptcase -c "command" -p 'Password123*'` 命令在已知密码的情况下执行命令。
4.  使用 `python exploit.py -u http://example.org/ -d` 命令检测部署路径。

**项目地址:** [synacktiv/CVE-2025-47227_CVE-2025-47228](https://github.com/synacktiv/CVE-2025-47227_CVE-2025-47228)

**漏洞详情:** [CVE-2025-47227](https://nvd.nist.gov/vuln/detail/CVE-2025-47227)