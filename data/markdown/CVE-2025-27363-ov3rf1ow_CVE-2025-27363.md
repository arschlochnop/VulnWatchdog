## CVE-2025-27363-FreeType-OOB写入

**漏洞编号:** CVE-2025-27363

**漏洞类型:** OOB写入

**影响应用:** FreeType

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.13.0

**利用条件:** 需要FreeType处理恶意构造的字体文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27363 是 FreeType 2.13.0 及以下版本中的一个越界写入漏洞。攻击者可以利用特制的 TrueType GX 或可变字体文件触发该漏洞。漏洞的根本原因是 signed short 类型的值被赋值给 unsigned long 类型，然后加上一个静态值，导致回绕，进而分配了过小的堆缓冲区。代码随后将最多 6 个 signed long 整数写入此缓冲区之外，从而导致越界写入。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且修复已发布在 Android 中。提供的 POC 代码尝试通过 `<script>` 标签加载恶意字体文件 `mal.ttf`。如果FreeType版本易受攻击，并且`mal.ttf`包含精心设计的利用代码的字体数据，则该POC有效。

**投毒风险：**
提供的 POC 代码仅包含 HTML 和 JavaScript 代码，用于加载和应用字体文件。该代码本身不包含任何明显的恶意代码或后门。风险在于 `mal.ttf` 字体文件本身可能包含恶意代码。但是，在当前提供的证据中，无法判断mal.ttf的内容。因此, 无法判断此代码库中是否存在作者隐藏的投毒代码。

**利用方式：**
1.  攻击者制作一个恶意的 TrueType GX 或可变字体文件（`mal.ttf`）。
2.  攻击者诱使用户加载包含恶意字体文件的网页。这可以通过多种方式完成，例如通过网络钓鱼攻击或利用另一个网站上的 XSS 漏洞。
3.  当 FreeType 尝试解析字体文件时，它会触发越界写入漏洞，攻击者可以利用它来执行任意代码。根据搜索结果显示，Android设备也受到了影响，因此该漏洞利用可能发生在Android应用中加载恶意字体的场景。
4. 该漏洞利用可能会通过远程方式进行，在无需用户交互的情况下触发代码执行（根据某些搜索结果）。

**项目地址:** [ov3rf1ow/CVE-2025-27363](https://github.com/ov3rf1ow/CVE-2025-27363)

**漏洞详情:** [CVE-2025-27363](https://nvd.nist.gov/vuln/detail/CVE-2025-27363)