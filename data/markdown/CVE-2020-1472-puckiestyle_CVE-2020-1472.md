## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 20H2，在未安装相应补丁的服务器上存在。

**利用条件:** 攻击者需要位于与域控制器相同的网络中，且能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Netlogon Remote Protocol (MS-NRPC) 中的权限提升漏洞。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞。成功利用该漏洞的攻击者可以在网络上的设备上运行特制应用程序，从而获得域管理员权限，完全控制域控制器。

**有效性：**
提供的POC代码（zerologon_tester.py）用于检测目标域控制器是否存在Zerologon漏洞。它尝试通过将Netlogon安全通道的客户端凭据设置为全零来绕过身份验证。如果成功绕过身份验证，则表明目标易受攻击。

**投毒风险：**
该代码主要用于检测漏洞，但存在潜在的投毒风险，约为10%。虽然主要功能是漏洞验证，但攻击者可以修改此代码，在成功利用漏洞后植入后门或执行其他恶意操作。由于代码使用Impacket库，并且涉及网络通信和身份验证绕过，因此潜在的恶意修改可能会难以检测。

**利用方式：**
1.  **身份验证绕过：** 攻击者使用 zerologon_tester.py 脚本，通过将Netlogon安全通道的客户端凭据设置为全零，来尝试绕过身份验证。
2.  **重置域控制器密码：** 如果身份验证绕过成功，攻击者可以使用其他工具（例如Impacket中的secretsdump.py）重置域控制器的密码。
3.  **获取域管理员权限：** 通过重置域控制器密码，攻击者可以获得域管理员权限，从而完全控制域。

综上所述，该漏洞的利用方式非常直接，风险极高，利用难度相对较低，但需要攻击者位于目标网络内部。

**项目地址:** [puckiestyle/CVE-2020-1472](https://github.com/puckiestyle/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)