## CVE-2022-0824 - Webmin Improper Access Control Remote Code Execution

**漏洞编号:** CVE-2022-0824

**漏洞类型:** 远程代码执行

**影响应用:** Webmin

**危害等级:** 高危，允许低权限用户远程执行任意代码

**影响版本:** < 1.990

**利用条件:** 需要Webmin实例运行，以及低权限用户账号密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0824是一个存在于Webmin 1.990之前版本中的权限控制不当漏洞。该漏洞允许已经通过身份验证的低权限用户访问本应受限的File Manager模块，从而上传恶意CGI脚本并执行任意代码。利用方式如下：

1.  **身份验证：** 使用低权限用户的用户名和密码登录Webmin。
2.  **文件上传：** 利用File Manager模块的`/file-manager/http_download.cgi`接口，从攻击者控制的服务器下载恶意perl脚本（反弹shell）。攻击者需要运行一个HTTP服务器来托管该文件。
3.  **权限修改：** 利用`/file-manager/chmod.cgi`接口，修改上传的perl脚本的权限为可执行。
4.  **命令执行：** 访问上传的perl脚本，执行其中的反弹shell代码，从而获得目标服务器的shell访问权限。

**有效性：** 根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞利用是有效的。多个来源证实了该漏洞的存在和利用方法。

**投毒风险：** 代码中主要使用了requests库发送HTTP请求，以及os.system函数执行系统命令。虽然主要功能是漏洞利用，但也存在一定投毒风险。生成CGI脚本的部分允许插入恶意代码，可能存在作者隐藏后门代码的风险，评定为10%。需要注意的是，perl脚本本身就是为了反弹shell，所以该脚本的内容不能算作投毒代码。


**项目地址:** [gokul-ramesh/WebminRCE-exploit](https://github.com/gokul-ramesh/WebminRCE-exploit)

**漏洞详情:** [CVE-2022-0824](https://nvd.nist.gov/vuln/detail/CVE-2022-0824)