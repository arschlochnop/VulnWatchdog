## CVE-2025-6440-WooCommerce Designer Pro-任意文件上传

**漏洞编号:** CVE-2025-6440

**漏洞类型:** 任意文件上传

**影响应用:** WooCommerce Designer Pro

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.9.26

**利用条件:** 无需身份验证，需要目标服务器运行受影响的插件版本

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-6440是WooCommerce Designer Pro插件中的一个任意文件上传漏洞。根据漏洞库信息，攻击者可以利用`wcdp_save_canvas_design_ajax`函数中缺失的文件类型验证，上传恶意文件到服务器上，从而可能导致远程代码执行。POC代码显示利用方式如下：

1.  **目标确定：**  脚本首先需要指定目标WordPress站点的URL和包含恶意PHP代码的文件。
2.  **构造请求：**  脚本构造一个POST请求到`wp-admin/admin-ajax.php`，`action`参数设置为`wcdp_save_canvas_design_ajax`。请求包含一个`params`字段，其中包含了`uniq`（一个随机字符串，用于唯一标识上传的文件）和文件基本信息，同时将恶意文件包含在`files`字段中。
3.  **文件上传：**  使用`requests.post`函数发送构造好的POST请求，将恶意文件上传到服务器。
4.  **访问恶意文件：**  成功上传后，脚本并没有直接验证上传文件的路径或者访问上传后的文件。需要手动拼接上传路径进行访问。

**有效性评估：**  根据漏洞描述和提供的POC代码，该漏洞利用的有效性较高。该POC利用了未授权的任意文件上传漏洞，结合漏洞库信息中的CVSS评分（9.8），该漏洞影响严重。

**投毒风险评估：**  该POC代码主要功能是实现任意文件上传，没有发现作者故意植入的后门代码或者其他恶意行为。代码主要功能集中在构造HTTP请求和处理响应上，没有发现可疑的恶意逻辑。因此，可以认为投毒风险较低。 风险为0。

**漏洞利用方式总结：**

1.  未经身份验证的攻击者发送恶意构造的请求。
2.  利用`wcdp_save_canvas_design_ajax`函数。
3.  服务器端没有正确的文件类型验证。
4.  成功上传恶意PHP文件，可导致远程代码执行。

**项目地址:** [Pwdnx1337/CVE-2025-6440](https://github.com/Pwdnx1337/CVE-2025-6440)

**漏洞详情:** [CVE-2025-6440](https://nvd.nist.gov/vuln/detail/CVE-2025-6440)