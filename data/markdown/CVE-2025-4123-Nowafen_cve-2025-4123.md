## CVE-2025-4123-Grafana-Open Redirect to evil.com and XSS

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 开放重定向 & XSS

**影响应用:** Grafana

**危害等级:** 高危，可能导致账号接管和SSRF

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户点击恶意链接，匿名访问开启时危害更大, 安装 Grafana Image Renderer 插件时可能导致 SSRF

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是由于 Grafana 存在客户端路径遍历和开放重定向漏洞组合导致的 XSS。攻击者可以构造恶意 URL，诱导用户点击后重定向到恶意网站（如 evil.com），该网站可以托管恶意前端插件，执行任意 JavaScript 代码。如果 Grafana Image Renderer 插件已安装，则可能利用开放重定向实现完整的读取SSRF。

**有效性分析：**
根据漏洞描述和提供的 POC 代码，该 POC 旨在验证是否存在开放重定向漏洞。通过构造包含路径遍历和恶意域名（evil.com）的 URL，检测 Grafana 是否会将用户重定向到恶意域名。如果返回 301 或 302 重定向状态码，并且 Location 标头包含 evil.com，则说明存在开放重定向漏洞，POC 有效。

**投毒风险分析：**
POC 代码本身不包含任何恶意代码，只是用于验证是否存在开放重定向漏洞。该 YAML 文件仅定义了漏洞的基本信息和 HTTP 请求，没有执行任何系统命令或文件操作。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者构造包含恶意 URL 的链接，例如：`{{BaseURL}}/public/.%2F%5cevil.com%2F%3f%2F..`。
2.  攻击者通过钓鱼邮件、社交媒体等方式诱导用户点击该链接。
3.  用户点击链接后，Grafana 将用户重定向到恶意网站（evil.com）。
4.  恶意网站托管包含 XSS Payload 的前端插件。
5.  用户的浏览器执行恶意 JavaScript 代码，攻击者可以窃取用户的 Session Cookie，或者利用 Session Cookie 冒充用户执行操作，例如更改密码，添加管理员账号等。
6. 如果 Grafana Image Renderer 插件已安装，则可能利用开放重定向实现完整的读取SSRF

**优先级排序依据：**搜索引擎结果 (包含利用细节) > 漏洞利用代码 (验证开放重定向) > 漏洞库信息 (提供漏洞基本信息)。

**项目地址:** [Nowafen/cve-2025-4123](https://github.com/Nowafen/cve-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)