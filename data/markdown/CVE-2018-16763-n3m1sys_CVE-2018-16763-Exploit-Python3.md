## CVE-2018-16763 - Fuel CMS 1.4.1 远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Fuel CMS

**危害等级:** 高危，可以导致服务器被完全控制

**影响版本:** <= 1.4.1

**利用条件:** 无需身份验证，需要网络访问Fuel CMS页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-16763 允许未经身份验证的攻击者在 Fuel CMS 1.4.1 上执行任意 PHP 代码。漏洞存在于 `pages/select/` 的 `filter` 参数中。攻击者可以通过构造包含 PHP 代码的恶意 URL 来利用此漏洞。PoC 代码通过构造特定的 URL，利用 `filter` 参数中的 PHP 代码执行功能，将用户输入的命令传递给 `system` 函数来执行。原始利用方式通过 `preview/data`参数同样可以触发漏洞, 但是PoC代码中使用了`pages/select/`的`filter`参数. 

**有效性：** PoC 代码有效，可以利用该漏洞在目标系统上执行任意命令。

**投毒风险：** 仓库中存在轻微的投毒风险，因为 `exploit.py` 脚本依赖于用户提供的 URL 和命令。恶意用户可能诱导其他人针对其自身网络或系统运行该脚本，从而造成损害。此外，脚本本身的代码相对简洁，未发现明显的后门或其他恶意代码。但是，存在修改 `command` 变量，达到攻击目的的可能性. `README.md` 文件描述了如何使用该脚本，以及脚本基于哪个漏洞利用。没有发现任何明显的投毒企图。

**利用方式：**
1.  修改`exploit.py`脚本中的`url`变量为目标 Fuel CMS 实例的URL。
2.  （可选）根据需要设置代理。
3.  运行脚本。
4.  脚本会提示输入要执行的命令。
5.  脚本会将命令编码后插入到恶意的 URL 中，然后发送请求。
6.  服务器执行命令并将结果返回给攻击者。

**搜索结果分析：** 搜索引擎结果验证了漏洞的存在和严重性，并提供了更多关于漏洞利用的信息，包括其他可能的利用方法和缓解措施。例如，https://0xd0ff9.wordpress.com/2019/07/19/from-code-evaluation-to-pre-auth-remote-code-execution-cve-2018-16763-bypass/  提到绕过方法。


**项目地址:** [n3m1sys/CVE-2018-16763-Exploit-Python3](https://github.com/n3m1sys/CVE-2018-16763-Exploit-Python3)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)