## CVE-2024-26229-Windows CSC Service Elevation of Privilege

**漏洞编号:** CVE-2024-26229

**漏洞类型:** 权限提升

**影响应用:** Windows CSC Service

**危害等级:** 高危，允许低权限用户提升至SYSTEM权限

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 本地访问

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

CVE-2024-26229是Windows客户端侧缓存（CSC）服务中的一个高危权限提升漏洞。攻击者可以利用此漏洞获得Windows系统上的SYSTEM权限。漏洞位于CSC服务中，利用了堆溢出。

**利用方式：**

1.  漏洞利用代码显示，该漏洞涉及与`NtWriteVirtualMemory`，`NtQuerySystemInformation`等NTDLL函数交互的本地权限提升。
2.  PoC代码首先加载必要的NTDLL函数，然后利用`NtQuerySystemInformation`来获取系统句柄信息。
3.  利用方式可能涉及到对CSC服务中的某些结构进行内存操作，从而实现权限提升。
4.  根据PoC的`README.md`，该代码使用了RalfHacker的漏洞利用代码，并进行了重写，避免了额外的依赖。
5.  利用过程可能涉及精心构造的输入，发送到存在漏洞的CSC服务，触发堆溢出，最终实现权限提升。
6.  编译后的可执行文件，攻击者可以修改powershell脚本中的base64，进行恶意代码投毒。

**有效性：**

根据搜索结果和PoC代码，该漏洞存在有效的利用方法，michredteam和RalfHacker在Github上都提供了PoC。微软已经发布补丁修复此漏洞。

**投毒风险：**

由于提供的PoC代码包含通过PowerShell执行Base64编码的payload的功能，攻击者可以轻松地将恶意代码嵌入到payload中，从而实现投毒攻击。因此，存在很高的投毒风险，为100%。

**项目地址:** [shinspace92/cve-2024-26229](https://github.com/shinspace92/cve-2024-26229)

**漏洞详情:** [CVE-2024-26229](https://nvd.nist.gov/vuln/detail/CVE-2024-26229)