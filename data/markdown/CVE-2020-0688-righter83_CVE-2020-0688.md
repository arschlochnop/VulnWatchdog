## CVE-2020-0688

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要获取Exchange用户的凭据，或者能够访问Exchange控制面板(ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。利用方式通常涉及以下步骤：1. 获取Exchange用户的凭据或者能够访问Exchange控制面板(ECP)。2. 使用已知密钥生成恶意的 ViewState 数据。3. 将生成的 ViewState 数据作为请求的一部分发送到 Exchange 服务器。4. 服务器反序列化 ViewState 数据，执行攻击者预设的恶意代码。提供的 POC 脚本 `scanner.php` 仅用于检测目标 Exchange 服务器是否安装了受影响的版本，以及是否安装了修复补丁。该脚本通过检查 OWA 页面中的版本信息来进行判断。虽然该脚本本身的功能是良性的，但存在一定的投毒风险，例如，作者可能在脚本中植入恶意代码，以便在扫描目标服务器时执行其他操作。由于只是版本检测，恶意代码可能性较小。该漏洞的利用需要具备一定的Exchange知识和 .NET 反序列化知识，相对复杂。根据CISA已将此漏洞添加到了已知可利用漏洞目录，表明该漏洞在野外被广泛利用。

**项目地址:** [righter83/CVE-2020-0688](https://github.com/righter83/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)