## CVE-2024-21533-ggit-参数注入

**漏洞编号:** CVE-2024-21533

**漏洞类型:** 参数注入

**影响应用:** ggit

**危害等级:** 中危，可能导致任意命令执行

**影响版本:** <= 2.4.12

**利用条件:** 需要安装ggit npm包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于ggit的cloneRepo API中。由于该API没有对用户输入的URL进行充分的验证和过滤，攻击者可以通过构造恶意的URL，例如`--upload-pack=$(touch /tmp/pwned)`，注入额外的git命令行参数。`--upload-pack`选项允许指定一个自定义的命令来处理上传的包，攻击者可以利用这个选项执行任意命令。例如，上述POC代码会在/tmp目录下创建一个名为pwned的文件。漏洞利用的有效性高，POC代码简单易懂，容易复现。POC验证代码本身不属于投毒代码，但由于任何可以执行命令的情况都可能存在被篡改的风险，因此存在一定投毒的概率，但根据目前的信息，投毒风险较低。该仓库的投毒风险评估为10%。利用方式是构造恶意的URL参数传递给cloneRepo函数，从而执行任意命令。

**项目地址:** [lirantal/CVE-2024-21533-PoC-ggit](https://github.com/lirantal/CVE-2024-21533-PoC-ggit)

**漏洞详情:** [CVE-2024-21533](https://nvd.nist.gov/vuln/detail/CVE-2024-21533)