## CVE-2024-6387-OpenSSH-信号处理竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，并且攻击者能够建立SSH连接并触发竞争条件。攻击者需要尝试大量连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 是 OpenSSH 服务器 (sshd) 中发现的一个安全漏洞，源于信号处理中的竞争条件。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：** 根据漏洞库信息和搜索结果，此漏洞存在PoC。该漏洞的利用依赖于触发竞争条件，因此需要进行大量的连接尝试。

**投毒风险：** 分析提供的PoC代码，主要包含一个检测脚本（detection-script.py）和一个README。检测脚本尝试建立到目标SSH服务器的连接，并发送SSH协议版本字符串，然后读取服务器的响应。LICENSE文件和README.md文件是标准格式，描述了漏洞信息。由于检测脚本本身较为简单，且没有发现明显的恶意代码，因此投毒的风险较低，约为10%。 但是需要人工review所有代码.特别是二进制文件.

**利用方式：** 利用此漏洞需要：
1.  攻击者向目标服务器上的sshd服务发起大量的连接请求。
2.  在连接建立但身份验证尚未完成时，利用竞争条件触发信号处理错误。
3.  如果成功利用，攻击者可以在目标系统上执行任意代码，获得root权限（根据漏洞描述和搜索结果）。

利用的复杂性在于需要精确地控制时序，以触发竞争条件。这通常需要大量的计算资源和对目标系统行为的深入了解。同时该漏洞在glibc-based Linux systems更有效,可能无法在所有系统上利用。

**项目地址:** [s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH](https://github.com/s1d6point7bugcrowd/CVE-2024-6387-Race-Condition-in-Signal-Handling-for-OpenSSH)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)