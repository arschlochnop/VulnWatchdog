## CVE-2024-45496 - OpenShift Node Compromise via Crafted .gitconfig

**漏洞编号:** CVE-2024-45496

**漏洞类型:** 权限提升/命令执行

**影响应用:** OpenShift Container Platform

**危害等级:** 严重，可能导致节点被完全控制

**影响版本:** 4.12.0 - 4.18.0 (受影响)

**利用条件:** 需要开发者级别的OpenShift权限

**POC 可用性:** 不确定

**投毒风险:** 0%

## 详情

CVE-2024-45496 漏洞存在于 OpenShift Container Platform 的构建过程中。当构建初始化时，`git-clone` 容器以特权安全上下文运行，允许不受限制地访问节点。攻击者利用方式如下：

1.  攻击者需要拥有开发者级别的OpenShift权限，能够创建和执行构建。
2.  攻击者创建一个包含恶意 `.gitconfig` 文件的 Git 仓库。
3.  恶意 `.gitconfig` 文件包含在 git clone 期间执行的命令，这允许在 worker 节点上执行任意命令。
4.  OpenShift 构建系统克隆该恶意仓库，导致 `.gitconfig` 中的命令以特权身份在节点上执行，最终导致节点权限被提升。

**有效性：**

根据漏洞描述，该漏洞利用的关键在于精心构造的 `.gitconfig` 文件。提供的POC代码 `/tmp/b23d26318b611c1a55a7e92f5fd49298/README.md` 仅仅包含一个README.md文件，并没有提供实际的`.gitconfig` 文件或者构建触发方式，因此无法直接判断其有效性。需要进一步搜索或分析具体的 `.gitconfig` 构造方法才能确定。

**投毒风险：**

由于 POC 代码仅包含 `README.md` 文件，不包含任何可执行的代码或恶意配置，因此不存在投毒风险。可能性为 0%。

**利用方式：**

利用方式总结如下：

1.  **先决条件：** 攻击者需要具备 OpenShift 中开发者级别的权限。
2.  **准备恶意仓库：** 攻击者创建一个 Git 仓库，其中包含一个特制的 `.gitconfig` 文件。
3.  **构造恶意 `.gitconfig`：** 该文件包含在 `git clone` 操作期间执行的恶意命令。例如，可以利用 `core.sshCommand` 或 `alias` 来执行命令。
4.  **触发构建：** 攻击者配置 OpenShift 构建任务，从包含恶意 `.gitconfig` 文件的仓库中克隆代码。
5.  **权限提升：** 当构建任务执行 `git clone` 时，`.gitconfig` 中的恶意命令将以特权身份在 OpenShift 节点上执行，从而导致节点被攻陷。

**项目地址:** [fatcatresearch/cve-2024-45496](https://github.com/fatcatresearch/cve-2024-45496)

**漏洞详情:** [CVE-2024-45496](https://nvd.nist.gov/vuln/detail/CVE-2024-45496)