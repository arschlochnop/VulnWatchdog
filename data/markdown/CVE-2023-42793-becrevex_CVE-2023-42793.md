## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问TeamCity服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793是JetBrains TeamCity中存在的一个认证绕过漏洞，攻击者无需认证即可利用此漏洞在TeamCity服务器上执行任意代码。根据漏洞库信息和搜索结果，该漏洞的CVSS评分为9.8，属于高危漏洞，并且已被积极利用。多家安全公司和组织（例如Rapid7，Fortinet，Microsoft，CISA）都发布了关于该漏洞的分析和利用报告，甚至有APT组织（APT29，北朝鲜黑客组织）利用该漏洞进行攻击。

提供的POC代码是一个Nmap脚本，用于检测目标TeamCity服务器是否存在CVE-2023-42793漏洞。该脚本通过向`/app/rest/users/id:1/tokens/RPC2`路径发送POST请求，尝试创建一个新的用户令牌，如果服务器返回200状态码且包含一个令牌，则表明服务器存在漏洞。该脚本本身的行为是良性的，只是用于验证漏洞的存在，没有发现任何投毒代码。

**有效性：**
根据提供的漏洞信息和POC代码，该POC代码有效，可以用于检测目标是否存在CVE-2023-42793漏洞。

**投毒风险：**
对提供的Nmap脚本进行了分析，没有发现任何明显的投毒代码。脚本的功能明确，即检测TeamCity服务器上的漏洞，没有发现任何恶意行为。风险评估为0%

**利用方式：**
1.  攻击者利用未授权访问漏洞，绕过身份验证。
2.  攻击者发送特制请求，例如向`/app/rest/users/id:1/tokens/RPC2`路径创建用户Token。
3.  成功创建Token后，攻击者获得管理员权限。
4.  利用管理员权限执行任意代码，实现远程代码执行。

该漏洞利用简单，影响严重，建议TeamCity用户尽快升级到2023.05.4或更高版本。

**项目地址:** [becrevex/CVE-2023-42793](https://github.com/becrevex/CVE-2023-42793)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)