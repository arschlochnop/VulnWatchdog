## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 目标 WordPress 站点安装了 Royal Elementor Addons and Templates 插件且版本低于 1.3.79，攻击者无需身份验证即可利用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件的早期版本中（< 1.3.79）。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 脚本，从而可能导致远程代码执行。

**漏洞利用方式：**

1.  **上传恶意文件：** 攻击者利用漏洞上传包含恶意代码的 PHP 文件或其他可执行文件到 WordPress 服务器。
2.  **执行恶意代码：** 成功上传后，攻击者可以通过访问上传的文件来执行其中的恶意代码，从而控制服务器。

**POC代码分析：**

提供的 POC 代码是一个 Python 脚本，旨在利用该漏洞。主要步骤如下：

1.  **获取 Nonce 值：** 脚本首先尝试从目标站点获取 Nonce 值，这可能用于绕过某些安全检查。
2.  **上传 PHP Shell：** 脚本构造一个包含 PHP Shell 代码的 POST 请求，并将其发送到目标站点的上传接口。
3.  **验证上传：** 脚本验证文件是否成功上传，并尝试访问上传的文件以触发恶意代码的执行。

**投毒风险分析：**

代码中主要功能是利用漏洞上传webshell,用于漏洞验证,初步判断，该POC代码存在投毒代码的可能性较低。其中包含以下几点：

*   **免责声明：** 代码包含免责声明，表明开发者不负责任。
*   **PHP Shell 代码：** 使用了标准的 PHP Shell 代码，功能是文件上传。
*   **日志记录：** exploit.log会记录漏洞利用过程。
*   **Nonce 获取：** 脚本尝试获取 Nonce 值，增加了攻击的成功率，但同时也暴露了攻击行为。

虽然主要功能是漏洞利用，但是仍然不能排除作者植入后门代码的可能性,比如搜集目标服务器IP等信息,投毒风险评估为1%。

**项目地址:** [Pushkarup/CVE-2023-5360](https://github.com/Pushkarup/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)