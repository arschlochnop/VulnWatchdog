## CVE-2023-32784-KeePass-内存泄漏

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 内存泄漏

**影响应用:** KeePass

**危害等级:** 高危，可能导致主密码泄露

**影响版本:** < 2.54

**利用条件:** 需要访问运行KeePass的系统，例如获得内存镜像文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32784 允许攻击者从 KeePass 2.x (2.54 之前版本) 的内存转储中恢复明文主密码。即使工作区已锁定或不再运行，此漏洞仍然存在。攻击者可以通过分析 KeePass 进程的转储文件、交换文件 (pagefile.sys)、休眠文件 (hiberfil.sys) 或整个系统的 RAM 转储来提取主密码。但是，无法恢复第一个字符。提供的 POC 代码 `keepass-password-dumper`  是一个用于搜索内存转储中 KeePass 使用的 SecureTextBoxEx 控件中写入的密码（例如主密码）的简单脚本。该脚本读取内存转储文件，搜索密码字符（"●"），并尝试识别密码的其余部分。投毒风险评估： 代码主要功能是搜索内存中的特定模式，并根据找到的模式推断密码。虽然可以修改代码以执行恶意操作，但提供的代码本身看起来并没有明显的恶意行为。 存在极低的投毒风险，推测是因为作者如果想植入后门，可能会通过复杂的代码混淆或者其他更隐蔽的方式进行。目前代码过于简单，不易隐藏恶意代码。 利用方式：

1.  **获取内存转储：** 攻击者需要首先获得运行 KeePass 的系统的内存转储。这可以通过多种方式实现，例如：
    *   直接访问系统并创建内存转储。
    *   访问交换文件或休眠文件。
    *   通过恶意软件或漏洞利用程序远程获取内存转储。
2.  **运行 POC 代码：** 攻击者使用提供的 POC 代码 `keepass-password-dumper` 分析内存转储文件。
3.  **提取主密码：** POC 代码会搜索内存中的密码模式，并尝试恢复 KeePass 的主密码。需要注意的是，该工具无法恢复密码的第一个字符。
4.  **访问 KeePass 数据库：** 攻击者使用提取的主密码来解锁 KeePass 数据库并访问其中存储的所有密码和其他敏感信息。

**项目地址:** [vdohney/keepass-password-dumper](https://github.com/vdohney/keepass-password-dumper)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)