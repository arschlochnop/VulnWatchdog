## CVE-2020-1472 - Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取，控制整个域

**影响版本:** 受影响的Windows Server版本包括：2004, 2019, 1909, 1903, 2016, 2008 R2, 2012, 2012 R2, 20H2

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-1472 (Zerologon) 漏洞存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过 MS-NRPC 连接到域控制器，利用加密算法中的缺陷来冒充域控制器，并最终获得域管理员权限。

**有效性：**
提供的PoC代码 `zerologon_tester.py` 旨在检测目标域控制器是否存在 Zerologon 漏洞。它通过尝试使用全零的challenge和credential进行Netlogon身份验证绕过来实现检测。如果成功绕过身份验证，则表明目标存在漏洞。

**投毒风险：**
分析提供的 Dockerfile, requirements.txt, LICENSE, README.md, zerologon_tester.py 文件，并未发现明显的恶意代码或后门。该代码主要依赖于 `impacket` 库实现 Netlogon 协议的交互和漏洞利用。但仍存在极低的投毒风险，例如:

*   `impacket` 库本身被篡改或使用恶意版本（虽然可能性较低，但需要考虑）。
*   代码中存在细微的逻辑错误，可能导致程序在特定环境下执行非预期操作（比如拒绝服务），虽然这些错误并非有意的，但属于一种潜在的风险。
*   `zerologon_tester.py` 本身虽然是漏洞检测工具，但攻击者可能会修改该工具，使其在检测漏洞的同时执行其他恶意操作。此脚本依赖第三方库,若第三方库被劫持,则存在风险。

综上，该仓库本身存在投毒的可能性较低，约为5%，但用户在使用该代码时仍需谨慎，仔细审查代码，确保使用的第三方库是可信的。

**利用方式：**
1.  攻击者使用 `zerologon_tester.py` 脚本检测目标域控制器是否存在漏洞。
2.  如果存在漏洞，攻击者可以重置域控制器的机器帐户密码。
3.  攻击者使用重置后的密码进行身份验证，获得域管理员权限。
4.  攻击者可以导出域内用户凭据、安装恶意软件、横向移动等，最终控制整个域。

**缓解措施：**
1.  及时安装 Microsoft 发布的 CVE-2020-1472 安全更新。
2.  监控网络流量，检测是否存在 Zerologon 攻击。
3.  强制执行签名和加密的 Netlogon 通信。

搜索引擎结果中，提供了关于 CVE-2020-1472 的漏洞概述、利用步骤、检测工具和缓解措施等信息，进一步验证了该漏洞的严重性和利用方式。

**项目地址:** [SecuraBV/CVE-2020-1472](https://github.com/SecuraBV/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)