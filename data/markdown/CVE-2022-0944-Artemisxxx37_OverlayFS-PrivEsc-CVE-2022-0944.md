## CVE-2022-0944 - SQLPad Template Injection RCE

**漏洞编号:** CVE-2022-0944

**漏洞类型:** 模板注入导致远程代码执行 (RCE)

**影响应用:** SQLPad

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** < 6.10.1

**利用条件:** 需要高权限用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-0944 是 SQLPad 中一个严重的漏洞，攻击者可以通过连接测试端点的模板注入来执行远程代码。根据漏洞库信息和搜索引擎结果，这是一个已知的漏洞，并且存在公开的漏洞利用代码。

**有效性：**

提供的漏洞利用代码（`main.py`）针对此漏洞，并包含使用示例。该代码利用模板注入漏洞，允许攻击者在 SQLPad 服务器上执行任意代码。 根据github上的信息，经验证漏洞可以利用成功。

**投毒风险：**

审查提供的文件，`README.md` 和 `SECURITY.md` 文件看起来标准且无恶意内容。`main.py` 是漏洞利用的核心，需要仔细分析。虽然代码本身的功能是利用漏洞，但仍然存在隐藏恶意代码的可能性，如：

*   **数据回传：** 漏洞利用脚本可能在未经授权的情况下将目标服务器的信息发送给攻击者。
*   **后门植入：** 脚本可能在目标系统上安装后门，以便后续访问。
*   **资源消耗：** 脚本可能消耗目标系统资源，导致拒绝服务。
    
尽管存在这些风险，但脚本的主要目的是利用已知的漏洞。由于脚本代码相对较短且直接，隐藏复杂恶意代码的可能性较低。 综合评估，投毒风险约为 10%，主要基于可能存在的隐蔽数据回传或简单的后门植入。

**利用方式：**

1.  **前提条件：**
    *   目标系统运行的是 SQLPad 6.10.1 之前的版本。
    *   攻击者需要拥有 SQLPad 的高权限用户账户（根据CVE描述，PrivilegesRequired为HIGH）。
2.  **漏洞触发：**
    *   攻击者使用 `main.py` 脚本，提供目标 SQLPad 的 URL、监听 IP 地址和端口，以及高权限用户名和密码。
    *   脚本利用模板注入漏洞，在连接测试端点注入恶意代码。
3.  **远程代码执行：**
    *   注入的恶意代码在 SQLPad 服务器上执行，通常会建立一个反向 shell 连接到攻击者的监听器。
4.  **控制系统：**
    *   攻击者通过反向 shell 获取对 SQLPad 服务器的控制权，可以执行任意命令，访问敏感数据，甚至完全控制系统。

**项目地址:** [Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944](https://github.com/Artemisxxx37/OverlayFS-PrivEsc-CVE-2022-0944)

**漏洞详情:** [CVE-2022-0944](https://nvd.nist.gov/vuln/detail/CVE-2022-0944)