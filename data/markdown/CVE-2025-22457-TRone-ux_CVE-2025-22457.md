## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, ZTA Gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，未经身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是一个存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 中的栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，从而在目标设备上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（特别是Rapid7的分析以及attackerkb的评估）和提供的PoC代码，可以确定该漏洞是有效的。PoC代码本身提供了针对易受攻击的 Ivanti Connect Secure 目标 (版本 22.7r2.4) 的利用示例，包括 ASLR 绕过和获取反向 shell。搜索结果也表明该漏洞已被野外利用 (UNC5221, 中国背景的威胁行为者)。

**投毒风险：**

PoC代码的 `README.md` 文件中包含完整的利用说明和参数解释，结构清晰，目的是为了方便用户理解和复现漏洞。该PoC利用的是栈溢出漏洞，通过控制返回地址来执行恶意代码，获取反向shell。虽然利用本身会造成系统损害，但代码本身没有发现故意引入的恶意行为或者后门。

投毒风险评估为5%。考虑到公开 PoC 的性质，作者可能试图通过微妙的修改引入后门，例如，虽然没有明显的迹象,例如将反向 shell 连接到未知 IP 地址或执行其他未经授权的操作，但仍然存在一些可能性。例如，shellcode 可能会被修改为包含额外的恶意操作，或者依赖项可能被篡改。 但PoC的重心放在演示漏洞利用上。

**利用方式：**

1.  **漏洞定位：** 栈溢出漏洞存在于 Ivanti Connect Secure、Policy Secure 和 ZTA Gateways 的特定版本中。
2.  **攻击入口：** 远程、未经身份验证的网络访问。
3.  **漏洞利用：** 攻击者发送特制的请求，利用栈溢出覆盖返回地址，执行恶意代码。
4.  **ASLR绕过：** PoC代码使用暴力破解ASLR来定位`libdsplibs.so`的基址，或者通过参数 `--libdsplibs` 直接指定基址。
5.  **Payload：** PoC代码使用反向 shell 作为 payload，允许攻击者在目标系统上执行命令。
6.  **控制系统：** 成功利用漏洞后，攻击者可以获得目标系统的控制权（如，获得shell），从而可能进行数据窃取、恶意软件安装或其他恶意活动。

**项目地址:** [TRone-ux/CVE-2025-22457](https://github.com/TRone-ux/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)