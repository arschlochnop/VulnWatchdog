## CVE-2024-10924-Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress plugins

**危害等级:** 严重，允许未经验证的攻击者以任何现有用户身份（包括管理员）登录

**影响版本:** 9.0.0 <= version <= 9.1.1.1

**利用条件:** 目标网站使用受影响版本的Really Simple Security插件，并且启用了两因素身份验证（尽管默认禁用）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924是一个存在于Really Simple Security (Free, Pro, and Pro Multisite) WordPress插件中的身份验证绕过漏洞。该漏洞源于`check_login_and_get_user`函数中不正确的用户检查错误处理，该函数用于双因素身份验证REST API操作。

**利用方式：**

1.  攻击者无需身份验证，即可利用漏洞。
2.  攻击者可以利用此漏洞，以任何现有用户身份登录 WordPress 网站，包括管理员。
3.  该漏洞利用需要目标网站安装并启用了受影响版本的 Really Simple Security 插件，且启用了双因素身份验证功能（虽然默认是关闭的）。

**POC分析：**

提供的 Dockerfile, docker-compose.yml 和其他文件用于创建一个易受攻击的 WordPress 环境，其中安装了存在漏洞的 Really Simple Security 插件版本。用户可以通过运行 `docker compose up --build` 命令来启动该环境，并重现漏洞。

**投毒风险分析：**

虽然该代码库的主要目的是提供一个可重现漏洞的环境，但仍然存在一些轻微的投毒风险。

*   **Dockerfile:** Dockerfile 安装了 `less`， `mariadb-client` 和 `curl` 这些工具，本身没有问题。下载 `wp-cli.phar` 也没有发现任何问题。
*   **docker-compose.yml:** docker-compose 文件配置了 WordPress 和 MySQL 数据库，没有明显的恶意配置。
*   **entrypoint.sh:**（未提供，假设存在）如果`entrypoint.sh` 被修改为自动创建恶意用户或者更改配置，则存在风险。
*   **wordpress/index.php & wordpress/license.txt**：这两个文件属于 WordPress 核心文件，没有发现任何问题。

基于以上分析，主要的风险点在于隐藏的或者被篡改的 `entrypoint.sh`脚本，该脚本有可能执行未知的操作，存在一定的投毒风险。因为缺少 `entrypoint.sh` 文件的内容，这里给出一个保守的估计值：10% 的投毒风险。

**项目地址:** [Trackflaw/CVE-2024-10924-Wordpress-Docker](https://github.com/Trackflaw/CVE-2024-10924-Wordpress-Docker)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)