## CVE-2023-28121-WooCommerce Payments-未授权提权

**漏洞编号:** CVE-2023-28121

**漏洞类型:** 未授权提权

**影响应用:** WooCommerce Payments WordPress Plugin

**危害等级:** 高危，可使未授权的攻击者获得管理员权限

**影响版本:** <= 5.6.1

**利用条件:** 目标网站安装了受影响版本的WooCommerce Payments插件，且允许未授权访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-28121 漏洞存在于 WooCommerce Payments 插件 5.6.1 及更早版本中。该漏洞允许未经身份验证的攻击者以管理员等特权用户的身份发送请求，从而获得对网站的管理员访问权限。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，该漏洞的POC代码有效。搜索结果表明该漏洞已被积极利用。

**投毒风险：**
提供的Python脚本 `mass-exploit-v1.py` 旨在利用 CVE-2023-28121。脚本会检查目标网站 WooCommerce Payments 插件的版本，如果版本易受攻击，则尝试通过发送带有特定header的POST请求来添加新的管理员用户。代码中没有明显的恶意行为或隐藏后门。脚本只是利用了已知的漏洞。

因此，投毒风险评估为0%。

**利用方式：**
1.  **版本检测：** 脚本首先尝试通过访问 `/wp-content/plugins/woocommerce-payments/readme.txt` 来确定目标网站上 WooCommerce Payments 插件的版本。
2.  **漏洞利用：** 如果检测到的版本低于 5.6.2，脚本会构造一个包含新管理员用户名、密码和电子邮件的 POST 请求，并设置 `X-WCPAY-PLATFORM-CHECKOUT-USER: 1` header。该请求被发送到 WordPress 的 REST API 端点 `/wp/v2/users`。
3.  **权限提升：** 如果请求成功（状态代码 201），则会在 WordPress 网站上创建一个新的管理员用户，从而使攻击者能够完全控制该网站。

**项目地址:** [im-hanzou/Mass-CVE-2023-28121](https://github.com/im-hanzou/Mass-CVE-2023-28121)

**漏洞详情:** [CVE-2023-28121](https://nvd.nist.gov/vuln/detail/CVE-2023-28121)