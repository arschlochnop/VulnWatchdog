## CVE-2025-24011-Umbraco CMS-用户枚举

**漏洞编号:** CVE-2025-24011

**漏洞类型:** 用户枚举

**影响应用:** Umbraco CMS

**危害等级:** 中危，可能暴露系统中的用户名，为后续攻击提供信息

**影响版本:** 14.0.0 <= version < 14.3.2, 15.0.0 <= version < 15.1.2

**利用条件:** 需要网络访问Umbraco CMS的管理API接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24011是Umbraco CMS中的一个用户枚举漏洞。攻击者可以通过分析管理API的响应代码和响应时间，来判断某个用户名是否存在。提供的POC代码 `poc.py` 首先检查Umbraco的版本，然后通过多次尝试使用随机密码登录不存在的用户，建立一个基准的响应时间模型。 接着，POC会读取用户名字典文件，并尝试使用随机密码进行登录。通过对比登录尝试的响应时间与基准模型，来判断用户名是否存在。漏洞利用的有效性依赖于网络延迟的稳定性以及Umbraco服务器的处理负载。  

**有效性：** 根据漏洞库信息和POC代码，该漏洞利用方法是有效的，能够在特定版本的Umbraco CMS上枚举用户名。  

**投毒风险：** 代码中存在一些潜在的风险点，但整体投毒概率较低，推测为10%。

*   **依赖关系：**POC代码依赖于`requests`库, 存在被篡改的风险，如果`requests`被替换成恶意版本，可能导致信息泄露或者其他恶意行为。
*   **错误处理：**代码中的错误处理部分可能不够完善，如果服务器返回非预期状态码，可能会导致程序崩溃，攻击者可以通过控制输入来触发这些错误。
*   **版本检测：**POC通过检测API端点是否存在来判断Umbraco的版本，但是攻击者可能利用这一点，诱导用户针对错误的版本进行攻击。

**利用方式：**  

1.  **确定Umbraco CMS版本：**  POC脚本会尝试访问两个不同的API端点(`/umbraco/management/api/v1/security/back-office/login` 和 `/umbraco/backoffice/UmbracoApi/Authentication/PostLogin`)，通过返回的HTTP状态码来确定目标站点运行的Umbraco版本。
2.  **建立时间模型：**  POC会发送100个使用随机用户名和密码的无效登录请求，记录每次请求的响应时间，以此来建立一个基准的时间模型。这个模型用于后续判断用户名是否存在。
3.  **枚举用户名：**  POC会读取用户名字典文件，并对每个用户名发送登录请求（使用随机密码）。
4.  **判断用户是否存在：**  通过比较每个用户名登录请求的响应时间与之前建立的时间模型，来判断用户是否存在。如果响应时间明显长于时间模型，则认为该用户存在。

**项目地址:** [Puben/CVE-2025-24011-PoC](https://github.com/Puben/CVE-2025-24011-PoC)

**漏洞详情:** [CVE-2025-24011](https://nvd.nist.gov/vuln/detail/CVE-2025-24011)