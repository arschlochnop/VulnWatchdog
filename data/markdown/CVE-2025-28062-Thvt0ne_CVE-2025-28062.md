## Frappe框架潜在的CSRF漏洞

**漏洞编号:** CVE-2025-28062

**漏洞类型:** 跨站请求伪造 (CSRF)

**影响应用:** Frappe框架

**危害等级:** 中危，可能导致未授权的用户数据修改或删除

**影响版本:** 未知，需要进一步分析Frappe框架版本

**利用条件:** 需要用户已登录Frappe框架，并诱导用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

POC代码提供了一个HTML页面，其中包含多个指向`localhost:8080`的链接，这些链接用于执行敏感操作，例如删除用户、添加角色到用户、以及用户接管。如果用户在登录Frappe框架后点击了这些链接，攻击者可以利用CSRF漏洞，冒充用户执行这些操作。

**利用方式：**

1.  **删除用户：**  `http://localhost:8080/api/method/frappe.desk.reportview.delete_items?items=%5B%221%401.com%22%5D&doctype=User`  此链接尝试删除用户 '1@1.com'。
2.  **添加角色到用户：** `http://localhost:8080/api/method/frappe.desk.form.save.savedocs?doc=...`  此链接尝试向用户 '1@1.com' 添加 'CEO' 角色。完整的URL包含一个JSON编码的文档，其中包含了用户的详细信息和要添加的角色。
3.  **获取用户修改值请求:** `http://localhost:8080/api/resource/User/test@test.test` 此链接获取`test@test.test`用户的信息.
4.  **用户接管：** `http://localhost:8080/api/method/frappe.desk.form.save.savedocs?doc=...` 此链接尝试更新 `test@test.test` 用户的信息，可能导致用户接管。

**有效性：**

POC代码的有效性取决于目标Frappe框架是否存在CSRF漏洞，以及是否缺乏适当的CSRF保护机制。如果Frappe框架没有实施CSRF token验证或其他防御措施，则攻击可能成功。

**投毒风险：**

代码本身看起来像是有效的CSRF PoC，但可能存在细微的投毒风险。例如,  攻击者可能会修改这些链接，指向恶意服务器，或者在JSON数据中插入恶意代码。但从目前的信息来看，投毒风险较低，约为10%。因为代码的核心功能是利用已知的API端点进行操作，而非执行任意代码。

**注意：**

*   POC代码针对的是`localhost:8080`，意味着它需要在本地运行Frappe框架。
*   攻击能否成功取决于目标Frappe框架的配置和安全措施。

**项目地址:** [Thvt0ne/CVE-2025-28062](https://github.com/Thvt0ne/CVE-2025-28062)

**漏洞详情:** [CVE-2025-28062](https://nvd.nist.gov/vuln/detail/CVE-2025-28062)