## CVE-2025-7340 - HT Contact Form Widget 未授权任意文件上传

**漏洞编号:** CVE-2025-7340

**漏洞类型:** 任意文件上传

**影响应用:** HT Contact Form Widget For Elementor Page Builder & Gutenberg Blocks & Form Builder

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.2.1

**利用条件:** 目标 WordPress 站点安装了受影响版本的 HT Contact Form Widget 插件，且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-7340 漏洞存在于 HT Contact Form Widget 插件中，允许未经身份验证的攻击者上传任意文件，最终可导致远程代码执行。漏洞位于 `temp_file_upload` 函数中，缺乏足够的文件类型验证。攻击者可以通过构造恶意请求，绕过限制，上传包含恶意代码的 PHP 文件（或其他服务器端脚本），然后在Web端访问上传的文件，执行恶意代码。\n\n**利用方式:**\n1. 查找目标站点是否安装了受影响版本的 HT Contact Form Widget 插件。\n2. 访问包含该插件的页面，提取 nonce, ajaxurl, form_id 等参数。这些参数可以通过查看页面源代码获得，POC代码已经包含了提取这些参数的正则表达式。\n3. 构造包含恶意 PHP 代码的 shell.php 文件。\n4. 使用 POST 请求将 shell.php 文件上传到目标站点的指定目录。请求中需要包含提取到的 nonce, ajaxurl, form_id 等参数。\n5. 访问上传的 shell.php 文件，执行恶意代码。\n\n**投毒风险评估:**\n分析提供的 POC 代码，该代码的功能是利用漏洞上传 webshell，以便远程执行命令。代码本身没有发现恶意或隐藏的功能，没有添加额外的后门或恶意代码的迹象。因此，投毒风险评估为 0%。\n\n**搜索引擎结果确认:**\n搜索引擎结果显示该漏洞是一个高危的任意文件上传漏洞，可以导致远程代码执行。多个网页 (NVD, Wiz.io, vulmon.com, ameba.com, vulners.com) 都对此漏洞进行了描述和分析。这些信息验证了漏洞的存在性和严重性。

**项目地址:** [Kai-One001/WordPress-HT-Contact-CVE-2025-7340-RCE](https://github.com/Kai-One001/WordPress-HT-Contact-CVE-2025-7340-RCE)

**漏洞详情:** [CVE-2025-7340](https://nvd.nist.gov/vuln/detail/CVE-2025-7340)