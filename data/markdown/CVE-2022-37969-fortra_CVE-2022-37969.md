## CVE-2022-37969 Windows CLFS 驱动程序提权漏洞

**漏洞编号:** CVE-2022-37969

**漏洞类型:** 本地提权

**影响应用:** Windows Common Log File System Driver (CLFS.SYS)

**危害等级:** 高危，允许低权限用户提升到SYSTEM权限

**影响版本:** 受影响的Windows版本：Windows 7 SP1, Windows 8.1, Windows Server 2008 SP2, Windows Server 2008 R2 SP1, Windows Server 2012, Windows Server 2012 R2, Windows 10 (所有版本直到指定的build号), Windows 11 Version 21H2, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2022-37969 是 Windows Common Log File System (CLFS) 驱动程序中的一个特权提升漏洞。攻击者可以利用此漏洞在本地系统上获得更高的权限（SYSTEM）。

**漏洞利用方式：**

1.  该漏洞的根本原因是 CLFS 驱动程序对数据边界检查不当。
2.  提供的POC代码利用了 CLFS 驱动程序中的漏洞，通过精心构造的输入，导致越界写入或其他内存损坏。
3.  PoC首先通过`GetOSversion()`函数获取操作系统版本信息，以确定Token偏移量，从而进行提权操作。
4.  PoC包含查找EPROCESS地址，写入token等敏感操作。

**有效性：**

根据搜索结果和代码，存在可用的PoC，并且已经被公开利用。Zscaler 和 CoreSecurity 等机构已经发布了漏洞分析和PoC开发文章。

**投毒风险：**

虽然该PoC代码可以在受影响的系统上实现提权，但存在一定的投毒风险。由于攻击者可以修改代码以包含恶意负载，例如安装后门或执行其他恶意操作。通过快速阅读代码，发现作者在获取OS版本过程中，从注册表读取数据，理论上攻击者可以修改注册表来做文章，但是可能性不高，因为代码主要集中于漏洞利用本身。

分析后，该仓库中存在作者隐藏的投毒代码的可能性为20%。

**项目地址:** [fortra/CVE-2022-37969](https://github.com/fortra/CVE-2022-37969)

**漏洞详情:** [CVE-2022-37969](https://nvd.nist.gov/vuln/detail/CVE-2022-37969)