## CVE-2019-13272 - Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，目标系统内核版本小于5.1.17，可能需要关闭SELinux。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-13272 是一个 Linux 内核中的本地提权漏洞，存在于 `kernel/ptrace.c` 的 `ptrace_link` 函数中。该漏洞源于内核在处理进程创建 ptrace 关系时，未正确记录进程的凭据。攻击者可以利用此漏洞，通过利用父子进程关系，在父进程放弃权限并调用 `execve` 时获得 root 权限。利用方式通常涉及使用 `PTRACE_TRACEME` 标志，例如，结合 Polkit 的 `pkexec` 辅助程序。漏洞利用代码描述文件显示了利用此漏洞提权的可行性。鉴于网络上存在大量公开可用的利用代码和关于该漏洞的讨论，可以认为提供的利用代码相对有效。

**投毒风险分析：**
提供的漏洞利用代码只有一份 `README.md` 文件，描述了漏洞和作者选择不同漏洞的原因。虽然文件中没有直接的恶意代码，但不能完全排除投毒的可能。由于仅有一个描述性文件，存在代码被篡改或加入恶意指令的可能性较低。因此，评估投毒风险为10%。

**利用方式总结：**
1.  **父子进程关系：** 创建一个父进程和一个子进程。
2.  **权限放弃：** 父进程放弃权限（例如，通过设置用户 ID）。
3.  **PTRACE_TRACEME：** 子进程使用 `PTRACE_TRACEME` 请求被追踪。
4.  **EXECVE：** 父进程调用 `execve`，执行目标程序，此时子进程可以利用该漏洞提升权限。
5.  **PKEXEC 辅助程序（可选）：** 可以结合 Polkit 的 `pkexec` 辅助程序触发该漏洞。

**项目地址:** [Tharana/vulnerability-exploitation](https://github.com/Tharana/vulnerability-exploitation)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)