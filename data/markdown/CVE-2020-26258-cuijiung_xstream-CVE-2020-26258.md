## CVE-2020-26258 XStream Server-Side Request Forgery

**漏洞编号:** CVE-2020-26258

**漏洞类型:** Server-Side Request Forgery (SSRF)

**影响应用:** XStream

**危害等级:** 中危，可能允许远程攻击者请求内部资源

**影响版本:** < 1.4.15

**利用条件:** 应用程序使用XStream库，且未配置白名单或运行Java 15+

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-26258是XStream库中存在的一个服务器端请求伪造（SSRF）漏洞。攻击者可以通过构造恶意的XML输入，利用XStream的反序列化功能，发起对内部资源的请求。此漏洞的利用需要目标应用使用了存在漏洞的XStream版本，并且没有使用白名单来限制可以反序列化的类。提供的POC代码仅包含一个README.md文件，表明这是一个初始的项目仓库，并没有直接可用的漏洞利用代码。因此需要自行构造恶意的XML数据进行利用。根据github仓库的信息，存在一定的投毒风险，但由于文件数量较少，仅判断存在低概率的投毒，例如作者在`README.md`文件中插入恶意链接等。漏洞利用方式如下：

1.  攻击者构造恶意的XML数据，其中包含用于触发SSRF的特定类和属性。
2.  应用程序使用XStream库反序列化该XML数据。
3.  XStream尝试实例化XML中指定的类，如果该类可以发起网络请求，则会触发SSRF。
4.  应用程序代表攻击者向内部资源发起请求，从而导致信息泄露或其他安全问题。
5.  如果目标应用运行Java 15或更高版本，或配置了XStream的安全框架并使用了白名单，则可以缓解此漏洞。

**项目地址:** [cuijiung/xstream-CVE-2020-26258](https://github.com/cuijiung/xstream-CVE-2020-26258)

**漏洞详情:** [CVE-2020-26258](https://nvd.nist.gov/vuln/detail/CVE-2020-26258)