## CVE-2025-29927-Next.js Middleware Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 15.0.0, <= 15.2.2 (也影响其他版本)

**利用条件:** 目标应用使用了Next.js middleware进行权限验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927 存在于 Next.js 的 middleware 实现中，允许攻击者通过操纵 `x-middleware-subrequest` header 来绕过身份验证和授权检查。攻击者可以构造特定的 header 值，欺骗 middleware 将请求视为已经处理过，从而跳过安全控制。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个真实存在且被广泛关注的漏洞。提供的 PoC 代码旨在验证该漏洞，并包含版本检测和利用步骤。因此，该 PoC 代码在理论上是有效的，但实际利用效果取决于目标应用程序的具体配置和环境。

**投毒风险：**

PoC 代码本身的主要目的是漏洞验证，并没有发现明显的恶意代码。代码包括版本检测，header 构造，和结果验证等部分。但是，考虑到安全风险，仍然存在极低的投毒风险。PoC代码的作者身份未知，代码的功能是进行安全测试。所以，保守估计存在1%的可能性，作者隐藏了某些后门或恶意功能。

**利用方式：**

1.  **版本检测：** PoC首先尝试通过访问 `_next/static/development/_buildManifest.js` 或 `_next/static/` 目录，或者server timing headers来确定目标 Next.js 应用的版本。
2.  **漏洞触发：** 如果检测到易受攻击的版本（15.0.0 到 15.2.2），PoC 会构造一个带有特制的 `x-middleware-subrequest` header 的 HTTP 请求。
3.  **绕过验证：**  该 header 的目的是欺骗 Next.js middleware，使其认为请求已经被处理，从而跳过身份验证和授权检查。
4.  **访问受保护资源：** 如果利用成功，攻击者将能够未经授权地访问受保护的资源，例如管理面板或其他需要身份验证的页面。

**修复建议：**

升级 Next.js 到 15.2.3 或更高版本可以修复此漏洞。同时，建议在 middleware 中进行更严格的 header 验证，防止恶意篡改。

**项目地址:** [Heimd411/CVE-2025-29927-PoC](https://github.com/Heimd411/CVE-2025-29927-PoC)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)