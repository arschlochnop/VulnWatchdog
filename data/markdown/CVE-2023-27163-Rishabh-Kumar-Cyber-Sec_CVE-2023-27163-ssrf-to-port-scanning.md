## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致信息泄露和内部网络访问

**影响版本:** <= 1.2.1

**利用条件:** 需要访问Request-Baskets服务的权限，利用需要目标服务的域名或者IP地址。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 版本及之前版本中存在的一个服务器端请求伪造（SSRF）漏洞，位于 `/api/baskets/{name}` 组件中。攻击者可以通过构造恶意 API 请求来访问内部网络资源和敏感信息。

**有效性：**
提供的 Python 脚本 `ssrf-to-port-scan.py` 利用了该漏洞，通过修改指定 Basket 的 `forward_url` 参数来触发 SSRF。脚本尝试扫描目标主机（默认为 `127.0.0.1`）的 1 到 65535 端口。如果端口关闭，则响应包含 "Failed to forward request" 字符串，脚本会打印 "Port closed"。否则，脚本会打印 "Port Open"。根据漏洞描述和脚本逻辑，可以判断该POC代码是有效的。

**投毒风险：**
审阅提供的 Python 脚本后，没有发现明显的恶意代码或后门。脚本的功能主要集中在利用 SSRF 漏洞进行端口扫描。代码行为符合预期，没有发现隐藏的、非预期的网络连接、文件操作或其他可疑行为。脚本注释中有少量需要修改的行数，以及对漏洞利用方式的简单解释，都是正常的提示信息。脚本存在明显的漏洞利用行为，但没有发现投毒代码。

**利用方式：**
1.  攻击者需要先获得对 Request-Baskets 服务的访问权限。
2.  攻击者需要创建一个 Basket 或者利用已存在的 Basket (例如，代码中使用的 `xfnq3md`)。
3.  攻击者通过 PUT 请求修改 Basket 的配置，将 `forward_url` 设置为攻击者想要访问的内部网络地址和端口。payload 可以通过json格式传递.
4.  当有用户访问该 Basket 时（例如，通过 GET 请求 `http://10.10.11.224:55555/xfnq3md`），Request-Baskets 服务会尝试将请求转发到 `forward_url` 指定的地址。
5.  如果 `forward_url` 指向内部服务，攻击者就可以通过 Request-Baskets 服务作为跳板来访问这些服务，从而实现 SSRF 攻击。

脚本使用 `proxy_response=True` 使得响应内容也会返回，因此可以判断端口是否开放。

**总结：**
该漏洞利用方式清晰，POC 代码有效，用于端口扫描。没有发现明显的投毒风险。攻击者需要能够访问 Request-Baskets 服务，并且能够操纵 Basket 的配置才能成功利用该漏洞。

**项目地址:** [Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning](https://github.com/Rishabh-Kumar-Cyber-Sec/CVE-2023-27163-ssrf-to-port-scanning)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)