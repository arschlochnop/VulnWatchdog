## CVE-2019-9978-Social Warfare-Stored XSS/RCE

**漏洞编号:** CVE-2019-9978

**漏洞类型:** Stored XSS/RCE

**影响应用:** Social Warfare WordPress Plugin

**危害等级:** 高危，可能导致远程代码执行和权限提升

**影响版本:** <= 3.5.2

**利用条件:** 需要目标网站安装了受影响版本的Social Warfare插件，并且攻击者能够通过网络访问 `wp-admin/admin-post.php` 页面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-9978是WordPress Social Warfare插件3.5.3之前版本中存在的存储型XSS漏洞，该漏洞可以通过 `wp-admin/admin-post.php?swp_debug=load_options&swp_url=` 参数利用。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已在野外被利用。提供的PoC代码尝试通过修改 `swp_url` 参数，加载远程payload.txt文件，实现RCE。
从代码来看，如果服务器返回500错误，则认为payload执行成功，这是一种简化的判断方式，实际情况可能需要更精确的验证。
因此，提供的POC代码是有效的，但可能需要根据目标环境进行调整，特别是payload.txt文件的内容。

**投毒风险：**
分析提供的PoC代码仓库，`/tmp/ce3f3c0f62eab3e0c5d7a8e346044fef/exploit.py`  代码的功能是利用漏洞，没有发现任何隐藏的恶意代码。代码逻辑清晰，主要用于发送包含恶意URL的HTTP请求。
`/tmp/ce3f3c0f62eab3e0c5d7a8e346044fef/README.md` 只是说明文档，没有可执行代码，因此投毒风险可以认为是 **0%**。

**利用方式：**
1.  攻击者构造包含恶意代码的 `payload.txt` 文件，该文件包含PHP代码，可以执行任意系统命令。
2.  攻击者向目标WordPress网站的 `wp-admin/admin-post.php` 发送请求，并设置 `swp_debug=load_options` 和 `swp_url` 参数为 `payload.txt` 文件的URL。
3.  Social Warfare插件在处理请求时，会加载并执行 `swp_url` 参数指定的远程文件，从而执行攻击者预设的恶意代码，实现RCE。执行恶意脚本导致存储型XSS, 在后台任何管理员用户访问插件设置时触发。

需要注意的是，该漏洞利用需要目标网站安装了受影响版本的Social Warfare插件，并且攻击者需要能够访问 `wp-admin/admin-post.php` 页面。

**项目地址:** [h8handles/CVE-2019-9978-Python3](https://github.com/h8handles/CVE-2019-9978-Python3)

**漏洞详情:** [CVE-2019-9978](https://nvd.nist.gov/vuln/detail/CVE-2019-9978)