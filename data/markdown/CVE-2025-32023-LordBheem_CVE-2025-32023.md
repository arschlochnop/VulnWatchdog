## CVE-2025-32023-Redis-HyperLogLog-RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Redis

**危害等级:** 高危，可能导致系统完全控制和数据泄露

**影响版本:** 2.8 到 8.0.3 之前, 7.4.5 之前, 7.2.10 之前, 6.2.19 之前

**利用条件:** 需要已认证的用户身份。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-32023 漏洞存在于 Redis 的 HyperLogLog 操作中。经过身份验证的用户可以利用特制的字符串触发堆栈或堆上的越界写入，可能导致远程代码执行。漏洞根源在于稀疏 HyperLogLog 编码处理中的整数溢出。

**有效性：**

提供的POC代码看起来有效。它给出了漏洞利用的基本步骤，即克隆包含exploit的git仓库，更改权限并执行exploit脚本，并提供了针对host和port的参数。

**投毒风险：**

虽然POC 描述中提到要替换占位符，但由于没有提供 exploit 脚本的实际内容, 且需要使用者从 git clone 仓库下载可执行文件，因此存在一定的投毒风险。风险点在于git仓库本身可能包含恶意代码。因此，推测投毒风险为20%。

**利用方式：**

1.  攻击者需要拥有 Redis 实例的有效用户身份。
2.  攻击者发送特制的 HyperLogLog 命令，触发整数溢出。
3.  整数溢出导致越界写入，覆盖堆栈或堆上的内存。
4.  通过精心构造的内存覆盖，攻击者可以执行任意代码。

**缓解措施：**

*   升级到已修复的版本 (8.0.3, 7.4.5, 7.2.10, 或 6.2.19)。
*   使用 ACL 阻止 HyperLogLog 相关命令的执行。
*   限制对 Redis 实例的网络访问。
*   监控 Redis 日志中可疑的 HyperLogLog 命令使用情况。

**项目地址:** [LordBheem/CVE-2025-32023](https://github.com/LordBheem/CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)