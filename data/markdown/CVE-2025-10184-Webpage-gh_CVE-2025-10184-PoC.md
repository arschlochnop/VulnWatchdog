## CVE-2025-10184-OnePlus OxygenOS-Telephony provider权限绕过与SQL注入

**漏洞编号:** CVE-2025-10184

**漏洞类型:** 权限绕过, SQL注入

**影响应用:** OnePlus OxygenOS

**危害等级:** 高危，可导致SMS/MMS数据泄露，破坏SMS-based MFA

**影响版本:** 12.*, 13.*, 14.*, 15.*

**利用条件:** 安装恶意应用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-10184漏洞存在于OnePlus OxygenOS中，允许任何已安装的应用程序在未经用户许可的情况下读取系统提供的Telephony provider中的SMS/MMS数据和元数据。漏洞根源在于多个内容提供器（com.android.providers.telephony.PushMessageProvider, com.android.providers.telephony.PushShopProvider, com.android.providers.telephony.ServiceNumberProvider）中缺少写操作的权限，以及这些提供程序的update方法中的盲SQL注入。 

**有效性：**
漏洞库信息和搜索结果都表明该漏洞确实存在，并且具有可利用性。Rapid7的博客也指出了该漏洞。漏洞库中提供了POC的链接，因此可以认为POC是有效的。

**投毒风险：**
提供的漏洞利用代码是Android Gradle项目的基本框架，包括build.gradle、gradle.properties和gradlew文件。这些文件本身没有明显的恶意代码，它们主要用于构建Android应用。风险在于，恶意开发者可能会在实际的Android应用代码（例如Java或Kotlin源代码）中加入窃取SMS信息的代码，然后利用这个gradle项目进行打包。因为没有app目录的源代码，所以无法判断是否存在投毒代码。仅从提供的代码来看，投毒风险较低，约为10%。gradlew文件可能存在被替换成恶意脚本的风险，但鉴于其内容相对标准，风险较低。因此判定投毒风险为10%。

**利用方式：**
1.  攻击者需要创建一个Android应用程序，该应用程序利用未授权访问Telephony provider的漏洞。
2.  该应用程序利用`ContentResolver`类，通过构造恶意的SQL查询，从`PushMessageProvider`、`PushShopProvider`或`ServiceNumberProvider`读取SMS/MMS数据。
3.  攻击者可以利用SQL注入漏洞来绕过权限检查，从而无需`READ_SMS`权限即可访问敏感信息。
4.  应用程序可以在后台静默执行，用户不会收到任何提示。
5.  获取的SMS/MMS数据可以被发送到攻击者的服务器。

**项目地址:** [Webpage-gh/CVE-2025-10184-PoC](https://github.com/Webpage-gh/CVE-2025-10184-PoC)

**漏洞详情:** [CVE-2025-10184](https://nvd.nist.gov/vuln/detail/CVE-2025-10184)