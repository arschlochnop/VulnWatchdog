## CVE-2024-31317-Android-Zygote反序列化漏洞

**漏洞编号:** CVE-2024-31317

**漏洞类型:** 反序列化漏洞

**影响应用:** Android

**危害等级:** 高危，可能导致任意应用代码执行

**影响版本:** 12, 12L, 13, 14

**利用条件:** 需要`android.permission.WRITE_SECURE_SETTINGS`权限，用户交互不是必须的

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31317是一个Android系统中的特权提升漏洞，存在于ZygoteProcess.java的多个函数中。由于不安全的反序列化，攻击者可以通过拥有`WRITE_SECURE_SETTINGS`权限的应用程序，以任何应用程序的身份执行代码，导致本地提权。根据NVD的描述，该漏洞的CVSS 3.1评分为7.8，属于高危漏洞。

**漏洞利用方式：**
攻击者利用`WRITE_SECURE_SETTINGS`权限，通过构造恶意的序列化数据，传递给Zygote进程处理。Zygote进程在反序列化这些数据时，由于缺乏足够的安全检查，导致可以执行任意代码，从而提升权限到其他应用。

**POC代码分析：**
提供的POC代码包含`build.gradle`、`gradle.properties`和`gradlew`文件，这是一个标准的Android Gradle项目的基本文件。它们主要用于构建Android应用程序，本身不包含直接利用CVE-2024-31317漏洞的代码。这个库本身只是安卓项目gradle构建文件，要利用漏洞还需要更多信息。

**投毒风险评估：**
虽然提供的代码片段本身不直接构成漏洞利用，但作为一个Android项目，它可以被用来构建包含漏洞利用代码的恶意应用。`gradlew`脚本可能被修改为包含下载和执行恶意代码的步骤，或者`build.gradle`文件可能被修改为引入包含恶意代码的依赖项。考虑到这种可能性，投毒风险估计为10%。这个概率主要来自于作者可能会在构建过程中添加恶意依赖或者执行恶意脚本，但是从目前的代码来看，并没有直接的证据表明存在恶意代码。

**项目地址:** [jmywh1/CVE-2024-31317](https://github.com/jmywh1/CVE-2024-31317)

**漏洞详情:** [CVE-2024-31317](https://nvd.nist.gov/vuln/detail/CVE-2024-31317)