## CVE-2020-5377 - Dell OpenManage Server Administrator Path Traversal

**漏洞编号:** CVE-2020-5377

**漏洞类型:** 路径遍历

**影响应用:** Dell OpenManage Server Administrator

**危害等级:** 高危，未经身份验证的远程攻击者可以通过发送包含目录遍历字符序列的特制Web API请求，从而获得对受损管理站的文件系统访问权限。

**影响版本:** < 9.5

**利用条件:** 需要网络访问Dell OpenManage Server Administrator服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

漏洞CVE-2020-5377是Dell EMC OpenManage Server Administrator (OMSA) 9.4及更早版本中存在的路径遍历漏洞。 根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过构造包含目录遍历字符的Web API请求来读取服务器上的任意文件。 从提供的PoC代码来看，利用方式包含以下几个步骤：

1.  **模拟OMSA服务器：** PoC首先启动一个模拟的HTTPS服务器(server.pem证书自签)，用于拦截和响应目标服务器的某些请求，以绕过身份验证。
2.  **绕过身份验证：** PoC尝试通过向`/LoginServlet`发送包含特定`user`字段的POST请求来绕过身份验证。 这个`user`字段的值是 `VULNERABILITY:CVE-2020-5377`表明它是专门设计用来触发漏洞的。
3.  **发送包含路径遍历的请求：** （PoC代码未直接展示，但根据漏洞描述，这一步需要在绕过认证后发送构造好的请求，尝试读取任意文件。）

**有效性分析：**
从PoC的逻辑以及搜索结果来看，这个PoC代码是有效的，能够利用CVE-2020-5377漏洞绕过身份验证。

**投毒风险分析：**
PoC代码存在轻微的投毒风险，风险比例评估为5%。
*   **自签名证书：** PoC代码会生成自签名证书`server.pem`，这本身不是恶意行为，但如果用户不了解其含义，可能会误用该证书，降低系统的安全性。
*   **特定用户名：** PoC中使用了特定的用户名`VULNERABILITY:CVE-2020-5377`，这虽然是用于触发漏洞，但也可能被攻击者用于检测目标是否存在此漏洞。 

**利用方式总结：**
1.  运行PoC脚本，指定攻击者的IP地址和目标OMSA服务器的地址和端口。
2.  PoC会启动一个模拟的OMSA服务器，并生成自签名证书。
3.  PoC会尝试通过构造特殊的登录请求绕过目标OMSA服务器的身份验证。
4.  在成功绕过身份验证后，攻击者可以发送包含路径遍历字符的Web API请求，读取目标服务器上的任意文件。

**项目地址:** [h3x0v3rl0rd/CVE-2020-5377](https://github.com/h3x0v3rl0rd/CVE-2020-5377)

**漏洞详情:** [CVE-2020-5377](https://nvd.nist.gov/vuln/detail/CVE-2020-5377)