## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码。

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600，也被称为Drupalgeddon2，是一个存在于Drupal核心中的远程代码执行漏洞。漏洞原因是由于Drupal在处理某些请求时，未对用户输入进行充分验证，导致攻击者可以在未经身份验证的情况下，通过构造特制的请求来执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞是有效的，并且存在公开可用的POC。

**投毒风险：**
提供的POC代码主要包含两个Python脚本：

*   `CVE-2018-7600-Drupal7-EXP.py`: 该脚本接收目标URL、命令、执行函数、代理等参数，通过构造恶意请求，向目标Drupal站点发送包含命令的payload，从而执行任意代码。
*   `CVE-2018-7600-Drupal7.py`: 该脚本通过读取`target.txt`文件中的目标URL，批量执行`whoami`命令，并将结果保存到`result.txt`文件中。
*   `README.md`: 描述了脚本的使用方法。

仔细分析这些代码，未发现明显的恶意行为或后门。`CVE-2018-7600-Drupal7.py` 脚本批量扫描是封装了`whoami`的exp。

但是，仍然存在一定的投毒风险，主要体现在以下几个方面：

1.  **依赖风险：** 脚本可能依赖于特定的第三方库，如果这些库被恶意修改，可能会导致脚本执行恶意代码。
2.  **命令注入风险：**  虽然脚本主要执行的是 `whoami` 命令，但是攻击者可以修改脚本，执行其他更具危害性的命令，比如删除文件、修改配置等。EXP.py允许自定义执行命令，存在风险。在使用时需要注意目标和命令。

总体而言，该仓库中作者隐藏的投毒代码的风险较低，大约为5%。

**利用方式：**

1.  **目标探测：**  使用`CVE-2018-7600-Drupal7.py` 脚本,通过提供包含目标URL的 `target.txt` 文件，批量扫描存在漏洞的Drupal站点。
2.  **漏洞利用：**  使用`CVE-2018-7600-Drupal7-EXP.py` 脚本，指定目标URL和要执行的命令，通过构造恶意请求，在目标Drupal站点上执行任意代码。 EXP.py允许自定义执行函数passthru，同样存在风险。
3.  **结果验证：**  检查命令执行的结果，确认漏洞是否成功利用。

**总结：**
CVE-2018-7600是一个高危的远程代码执行漏洞，攻击者可以利用该漏洞在Drupal站点上执行任意代码。虽然提供的POC代码本身不存在明显的恶意行为，但是仍然存在一定的投毒风险。在使用这些代码时，需要谨慎评估风险，并采取相应的安全措施。

**项目地址:** [rabbitmask/CVE-2018-7600-Drupal7](https://github.com/rabbitmask/CVE-2018-7600-Drupal7)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)