## CVE-2019-18935 - Progress Telerik UI for ASP.NET AJAX RadAsyncUpload .NET 反序列化漏洞

**漏洞编号:** CVE-2019-18935

**漏洞类型:** .NET反序列化漏洞

**影响应用:** Progress Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 需要目标系统安装了存在漏洞的Telerik UI for ASP.NET AJAX组件，并且需要已知加密密钥或者绕过加密的手段（如CVE-2017-11317或CVE-2017-11357）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-18935 是一个存在于 Progress Telerik UI for ASP.NET AJAX 组件中的 .NET 反序列化漏洞。该漏洞存在于 RadAsyncUpload 功能中，攻击者通过构造恶意的序列化数据，利用 .NET Framework 的反序列化机制，可以在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出CVE-2019-18935 允许通过 RadAsyncUpload 组件进行 .NET 反序列化攻击，搜索结果中也有多个链接指向该漏洞的利用方法和受影响的版本。提供的漏洞利用代码（README.md）详细说明了如何检测漏洞是否存在，并提供了两种验证方式：
1.  **安全模式 (Sleep())**: 通过让服务器睡眠一段时间来验证漏洞是否成功利用。该方法比较安全，不会对服务器造成实质性的危害。
2.  **攻击模式 (Reverse Shell)**:  通过在服务器上执行反向 Shell 代码，来获取服务器的控制权。该方法具有攻击性，可能对服务器造成危害。

**投毒风险：**
提供的漏洞利用代码主要包含一个 README.md 文件和两个 C 代码文件（sleep.c 和 reverse-shell.c）。
*   README.md 文件主要介绍了漏洞的利用步骤和受影响的版本列表，不包含任何可疑的代码。
*   sleep.c 文件是一个简单的 DLL，其功能是让服务器睡眠一段时间，用于验证漏洞是否存在，不包含任何恶意代码。
*   reverse-shell.c 文件包含反向 Shell 代码，其功能是连接到攻击者的服务器，并执行攻击者发送的命令。该代码本身是漏洞利用的一部分，不是投毒代码。该文件需要使用者自己定义HOST和PORT，因此不属于作者植入的后门。

综上所述，该仓库中不存在作者隐藏的投毒代码。

**利用方式：**
1.  **检测漏洞：** 发送 GET 请求到 `/Telerik.Web.UI.WebResource.axd?type=rau` 检查 RadAsyncUpload 是否启用。如果返回包含 "RadAsyncUpload handler is registered succesfully, however, it may not be accessed directly." 的 JSON 响应，则表示可能存在漏洞。
2.  **准备恶意 DLL：**
    *   **安全模式：** 编译 sleep.c 文件生成 sleep.dll，用于验证漏洞。
    *   **攻击模式：** 修改 reverse-shell.c 文件中的 HOST 和 PORT 变量，编译生成 reverse-shell.dll，用于获取反向 Shell。
3.  **利用漏洞：**
由于 CVE 信息中说明，漏洞需要已知加密密钥或者绕过加密手段。 具体利用方式需要根据目标系统的具体情况，构造包含恶意 DLL 路径的 JSON 序列化数据，并将其发送到 RadAsyncUpload 处理程序。服务器在反序列化该数据时，会加载并执行恶意 DLL，从而实现远程代码执行。

**总结：**
CVE-2019-18935 是一个高危的 .NET 反序列化漏洞，攻击者可以利用该漏洞在目标服务器上执行任意代码。虽然利用该漏洞需要一定的条件（已知加密密钥或者绕过加密），但一旦成功利用，危害极大。提供的漏洞利用代码可以帮助安全研究人员验证漏洞是否存在，并进行渗透测试。


**项目地址:** [murataydemir/CVE-2019-18935](https://github.com/murataydemir/CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)