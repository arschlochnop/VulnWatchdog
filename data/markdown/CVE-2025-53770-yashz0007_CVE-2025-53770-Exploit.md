## CVE-2025-53770-SharePoint远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于16.0.18526.20508)

**利用条件:** 目标系统存在漏洞版本的SharePoint服务且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 中存在的反序列化漏洞。未经授权的攻击者可以利用此漏洞通过网络执行远程代码。漏洞的利用方式是攻击者发送特制的序列化数据到存在漏洞的 SharePoint 服务器，服务器在反序列化该数据时执行攻击者注入的恶意代码。

**有效性评估：**

*   漏洞库信息显示，CVE-2025-53770 已经被公开利用（"exploit for CVE-2025-53770 exists in the wild."）。
*   搜索引擎结果也表明该漏洞已被积极利用（"Active Exploitation of Microsoft SharePoint Vulnerabilities"）。
*   提供的漏洞利用代码（`exploit.py`）的描述是“Ultimate SharePoint Exploit Tool Combines Detection + Version Check + WebPart Injection (CVE-2025-53770)”，表明该代码旨在利用此漏洞进行WebPart注入。
*   综合以上信息，可以判断提供的POC代码有效。

**投毒风险分析：**

*   `README.md` 文件只是一个简单的使用说明文档，主要介绍如何下载、安装和使用该工具，没有发现任何可疑代码。
*   `compress.py` 文件用于压缩和编码有效载荷（payload）。该脚本首先读取 `base64.txt` 文件，对其进行 Base64 解码，然后使用 gzip 压缩，最后再次进行 Base64 编码，并将结果写入 `payload-final.txt` 文件。虽然该脚本本身没有明显的恶意代码，但它处理的数据来源 `base64.txt` 存在潜在风险。攻击者可能会在 `base64.txt` 中嵌入恶意代码，从而在压缩和编码后隐藏其真实目的。
*   `exploit.py` 文件是漏洞利用的主脚本。粗略浏览来看，代码结构相对清晰，主要功能是检测 SharePoint 版本，然后尝试进行 WebPart 注入。代码可能包含隐藏的后门或者恶意行为，因为该代码结合了检测、版本检查和 WebPart 注入等多个功能，且代码中存在从外部文件读取数据的情况，如果外部文件被篡改，可能会导致恶意行为。因此，投毒的风险存在，但需要进一步详细分析代码逻辑才能确定。
*   综合考虑，`base64.txt` 文件和 `exploit.py` 脚本是主要的潜在投毒点。

**利用方式分析：**

该漏洞利用方式涉及以下步骤：

1.  **目标确认：** 攻击者需要确定目标 SharePoint 服务器是否存在漏洞（版本在受影响范围内）。
2.  **有效载荷准备：** 攻击者需要准备恶意的序列化数据，该数据在反序列化时可以执行任意代码。
3.  **WebPart注入：**  利用 SharePoint 的 WebPart 功能，将包含恶意序列化数据的 WebPart 注入到 SharePoint 页面中。
4.  **触发反序列化：** 当用户访问包含恶意 WebPart 的页面时，SharePoint 服务器会尝试反序列化 WebPart 中的数据，从而触发远程代码执行。

**项目地址:** [yashz0007/CVE-2025-53770-Exploit](https://github.com/yashz0007/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)