## CVE-2019-13272 - Linux Kernel Improper Privilege Management

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获取 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要在存在漏洞的 Linux 内核版本上运行，且可能需要满足特定的父子进程关系以及权限设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux 内核的 `ptrace_link` 函数中，该函数在处理进程创建 ptrace 关系时，没有正确处理凭据记录，导致权限错误。攻击者可以利用具有父子进程关系的特定场景，例如父进程降权后调用 `execve`，从而获得 root 权限。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞是有效的。漏洞库信息和搜索结果都确认了该漏洞的存在，并指出其可能导致本地用户获取 root 权限。漏洞利用代码包含一个 `CVE-2019-13272.c` 文件，说明存在公开的 POC 利用程序。根据文本记录来看，作者尝试复现漏洞，但遇到了一些困难，最终通过下载 `raw.githubusercontent.com` 上的 `.c` 文件并编译成功。

**投毒风险：**
评估提供的代码仓库的投毒风险大约为10%。

*   仓库中包含一些个人实验记录,存在部分编译失败的情况,且未看到明确的恶意代码,初步判断不存在恶意投毒行为。
*  作者提供的信息链接是可靠的,例如NVD, PacketstormSecurity等等。
*   作者明确说明了如何从可靠来源下载漏洞利用代码(raw.githubusercontent.com)，降低了投毒的可能。
*  作者尝试过从github下载利用,说明作者具备一定的安全意识。

**利用方式：**
根据漏洞信息和提供的漏洞利用代码，漏洞的利用方式大致如下：

1.  攻击者需要在一个存在漏洞的 Linux 内核版本上执行攻击。
2.  利用父子进程关系，创建一个父进程，该父进程会降低自身权限，并调用 `execve` 执行一个新的程序。
3.  利用 `PTRACE_TRACEME` 功能，攻击者控制的子进程可以追踪父进程。
4.  由于内核在处理 ptrace 关系时存在漏洞，攻击者可以利用该漏洞提升权限，最终获得 root 权限。
5.  一种常见的利用方式是结合 `pkexec` 工具，`pkexec` 允许普通用户以 root 权限执行命令，但由于 ptrace 漏洞的存在，攻击者可以通过控制 `pkexec` 的行为来获得 root 权限。

**项目地址:** [GgKendall/secureCodingDemo](https://github.com/GgKendall/secureCodingDemo)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)