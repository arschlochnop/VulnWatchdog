## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户凭据泄露，会话劫持和恶意代码执行

**影响版本:** < 11.109.9999.116

**利用条件:** 需要用户点击恶意链接或访问包含恶意代码的页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29489 是一个 cPanel 漏洞，涉及通过无效 webcall ID 在 cpsrvd 错误页面上发生的跨站脚本攻击 (XSS)。该漏洞允许攻击者通过精心构造的 URL 注入恶意 JavaScript 代码。如果用户点击了该恶意链接，则 JavaScript 代码将在用户的浏览器上下文中执行，从而可能导致各种攻击，包括窃取敏感信息、劫持用户会话或操纵网页内容。

**有效性:**

提供的漏洞利用代码（tool-29489）是一个Python工具，旨在扫描目标URL是否存在CVE-2023-29489漏洞。它通过发送带有payload的请求来判断漏洞是否存在。从README.md中的描述和代码结构来看，该POC代码应该有效，可以用于检测漏洞，验证cPanel是否受此漏洞影响。

**投毒风险:**

分析POC代码内容：

*   **目录结构：** 代码仓库包含一个README.md文件，说明了工具的用途和使用方法，一个src目录，其中包含`__init__.py`（空文件）, input.txt（包含多个URL，用于测试）, 和main.py (主程序).
*   **main.py:** `main.py`文件包含了命令行参数解析，从includes目录中导入了 `filereader` 和 `scanner` 模块，并定义了一个banner函数。这些基本结构没有明显恶意行为。
*   **input.txt**: 包含多个URL，用于测试，其中包含google.com，因此可以判断此工具不仅用于特定URL的检测，也可以用于通用URL的检测

由于没有提供 `filereader.py`和 `scanner.py` 文件的代码，无法对这些文件中的代码进行分析。初步评估投毒的可能性较低，但不能完全排除。假设 `filereader.py` 和 `scanner.py` 包含恶意代码，例如收集用户信息、植入后门或进行其他恶意操作，则投毒风险的存在。但是考虑到这是一个漏洞扫描工具，并且`input.txt` 包含了 `google.com`, 作者更有可能是想创建一个通用的漏洞扫描工具。

**利用方式:**

1.  **漏洞触发:** 攻击者构造包含恶意 JavaScript 代码的 URL。该 URL 包含一个无效的 webcall ID，导致 cPanel 服务器返回一个错误页面。
2.  **XSS 攻击:** 由于错误页面没有正确转义 webcall ID，攻击者注入的 JavaScript 代码将包含在 HTML 响应中。
3.  **代码执行:** 当受害者访问包含恶意代码的 URL 时，其浏览器将执行 JavaScript 代码。
4.  **攻击后果:** 攻击者可以利用执行的 JavaScript 代码来窃取 cookie、重定向用户到恶意网站、更改页面内容或执行其他恶意操作。

总而言之，利用方式是诱使用户点击包含恶意构造的 URL，从而触发 XSS 漏洞。

**项目地址:** [prasad-1808/tool-29489](https://github.com/prasad-1808/tool-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)