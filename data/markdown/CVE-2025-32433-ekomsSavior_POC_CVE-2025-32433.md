## CVE-2025-32433 - Erlang/OTP SSH Pre-Authentication RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < OTP-25.3.2.20, >= OTP-26.0-rc1, < OTP-26.2.5.11, >= OTP-27.0-rc1, < OTP-27.3.3

**利用条件:** 目标系统运行受影响的Erlang/OTP版本，并且SSH服务对外开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32433 是一个存在于 Erlang/OTP SSH 服务器中的远程代码执行漏洞。攻击者可以在无需身份验证的情况下，通过发送特制的 SSH 协议消息，利用 SSH 协议处理中的缺陷执行任意代码。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞被评为严重级别 (CVSS 10.0)，并且存在公开可用的PoC 代码。提供的PoC代码模拟了攻击过程，包括连接到目标 SSH 端口，发送伪造的 SSH 版本字符串和恶意数据包。PoC代码还包括了模拟反向shell和执行基本系统命令以进行后渗透的步骤，例如`whoami`，`uname -a`以及模拟凭据泄露。

**投毒风险：**

尽管PoC代码声明仅用于教育和研究目的，但仍然存在一定程度的投毒风险。风险评估如下：

*   **PoC代码本身：** 代码包含触发反向shell的函数`trigger_reverse_shell()`，以及模拟数据渗透的函数`simulate_post_exploitation()`。虽然这些函数本身不是恶意代码，但如果攻击者修改这些函数，例如将反向shell指向恶意服务器，或者执行更具破坏性的命令，则可能被滥用。
*   **README.md文件：**  README 文件中提到了一个外部链接 `https://github.com/m0usem0use/erl_mouse`，该链接指向一个用于查找易受攻击目标的脚本。虽然该脚本本身可能不是恶意的，但如果攻击者提供修改后的版本，用于扫描并攻击大量目标，则可能被滥用。 另外存在C2服务器搭建以及回调，但这些属于poc利用，不算作投毒.

总体来说，投毒风险较低（10%）。主要风险在于用户可能无意中使用了修改后的PoC代码或相关工具，这些代码可能包含额外的恶意功能。

**利用方式：**

1.  **连接目标SSH服务：**  PoC代码首先尝试连接目标服务器的22端口（SSH默认端口）。
2.  **发送伪造的SSH版本字符串：**  攻击者发送一个自定义的SSH版本字符串，例如 `SSH-2.0-ErlangTest_0.1`，可能用于绕过某些安全检查或触发漏洞。
3.  **发送特制的恶意数据包：**  这是漏洞利用的关键步骤。攻击者发送一个经过特殊构造的数据包，利用Erlang/OTP SSH实现中的缺陷。该数据包的目的是破坏SSH协议消息处理流程，从而导致远程代码执行。
4.  **触发反向shell：**  一旦成功利用漏洞，攻击者会尝试在目标系统上执行任意代码。PoC代码中模拟了通过bash反向连接到攻击者控制的服务器，从而建立一个反向shell。
5.  **模拟后渗透：**  在获得shell访问权限后，攻击者可以执行各种命令，例如收集系统信息、访问敏感文件或安装恶意软件。PoC代码模拟了这些操作，例如执行 `whoami`、`uname -a` 等命令，并将结果写入 `/tmp/exfil.log` 文件。

总而言之，CVE-2025-32433 允许未经身份验证的远程代码执行，攻击者可以通过网络发送特制的SSH数据包来利用该漏洞，从而完全控制受影响的系统。

**项目地址:** [ekomsSavior/POC_CVE-2025-32433](https://github.com/ekomsSavior/POC_CVE-2025-32433)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)