## CVE-2019-16278-Nostromo-nhttpd-目录遍历导致远程代码执行

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** Nostromo nhttpd

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意命令

**影响版本:** <= 1.9.6

**利用条件:** 目标服务器运行Nostromo nhttpd <= 1.9.6，且允许HTTP POST请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-16278 是 Nostromo nhttpd 1.9.6 及之前版本中 `http_verify` 函数存在目录遍历漏洞，攻击者通过构造特制的 HTTP 请求，利用目录遍历绕过身份验证或者访问限制，最终执行任意命令。根据提供的漏洞利用代码，攻击者通过发送包含特殊构造的URL（包含多个`.%0d./`）的POST请求，绕过路径验证，最终执行在`-c`参数中指定的命令。该漏洞利用代码的主要流程是：

1.  使用 argparse 模块解析命令行参数，包括目标 IP 地址、端口、要执行的命令等。
2.  构造恶意 URL，利用目录遍历漏洞。
3.  创建 socket 连接到目标服务器。
4.  发送包含恶意 URL 和命令的 POST 请求。
5.  接收并打印服务器响应。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是真实存在的，并且存在可用的PoC代码，证明了其有效性。

**投毒风险：**

提供的漏洞利用代码（exploit.py）比较简洁，主要功能是发送构造好的HTTP请求，执行指定命令并返回结果。README.md文件也只是描述了漏洞信息和使用方法。粗略看没有发现明显的恶意代码，但需要进行动态分析，静态分析可能存在疏漏。

主要风险在于:
*   **依赖风险:** `exploit.py`依赖于`argparse`和`socket`标准库，恶意代码可能潜藏于此，但这种可能性较低。

**综上，投毒风险较低，大约为1%。**

**利用方式：**

1.  攻击者需要一台可以访问目标服务器的机器。
2.  攻击者使用提供的 Python 脚本 `exploit.py`，并指定目标 IP 地址、端口和要执行的命令。
3.  脚本构造包含目录遍历的 HTTP POST 请求。
4.  脚本将请求发送到目标服务器。
5.  目标服务器上的 Nostromo nhttpd 接收到请求后，由于 `http_verify` 函数的漏洞，会执行攻击者指定的命令。
6.  命令执行的结果将作为 HTTP 响应返回给攻击者。
7.  攻击者可以利用此漏洞执行任意命令，例如获取敏感信息、修改服务器配置或植入恶意软件。

**项目地址:** [CybermonkX/CVE-2019-16278_Nostromo-1.9.6---Remote-Code-Execution](https://github.com/CybermonkX/CVE-2019-16278_Nostromo-1.9.6---Remote-Code-Execution)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)