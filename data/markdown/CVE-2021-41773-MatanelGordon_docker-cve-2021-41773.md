## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 2.4.49 版本，并启用 cgi-bin 或类似 Alias 指令配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含特殊编码的 URL，例如 `/.%2e/%2e%2e/`，来绕过服务器对路径的规范化处理，从而访问到 Alias 指令配置以外的文件。如果目标服务器同时启用了 CGI 脚本支持，则可能导致远程代码执行。

**漏洞利用有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞的 POC 已被公开，并且在野外被发现利用。提供的 Postman 集合中包含了一个用于获取 `/etc/passwd` 文件的请求，验证了路径遍历的可能性。因此，提供的 POC 代码是有效的。

**投毒风险分析：**

*   `/tmp/04092c8b1881911c9b0f88964abf9b52/CVE-2021-41773.postman_collection.json`：Postman 集合文件，定义了用于测试漏洞的 HTTP 请求。不存在投毒代码。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/Dockerfile`：Dockerfile 用于构建包含漏洞环境的 Docker 镜像。 其中 `RUN ln -sf /bin/bash /bin/sh` 这一行可能存在争议，它将 `/bin/sh` 符号链接强制指向 `/bin/bash`。在某些系统中，`/bin/sh` 可能是 `dash` 或其他更轻量级的 shell。 强制指向 bash 可能会引入一些细微的兼容性问题，但这不是一个明显的恶意行为，更可能是一种为了方便某些脚本执行的措施。此外创建目录 `/etc/httpd/logs`也并不是恶意代码, 综合来看，投毒风险较低。
*   `/tmp/04092c8b1881911c9b0f88964abf9b52/LICENSE`：Apache 许可证，与漏洞利用无关，不存在投毒代码。

综合分析，该仓库中可能存在的投毒代码的可能性较低，主要集中在Dockerfile 脚本中，将`/bin/sh` 符号链接强制指向 `/bin/bash`,但可能性只有5%，其余的代码都是正常的。

**漏洞利用方式：**

1.  **路径遍历：** 攻击者构造包含 `/.%2e/%2e%2e/` 序列的 URL，利用 Apache HTTP Server 对路径的规范化处理缺陷，尝试访问受限目录之外的文件。
2.  **敏感信息泄露：** 如果成功绕过权限验证，攻击者可以读取服务器上的敏感文件，如配置文件、密码文件等。
3.  **远程代码执行（如果 CGI 启用）：** 如果目标服务器启用了 CGI 脚本支持，攻击者可以通过上传或执行恶意 CGI 脚本，实现远程代码执行。

**项目地址:** [MatanelGordon/docker-cve-2021-41773](https://github.com/MatanelGordon/docker-cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)