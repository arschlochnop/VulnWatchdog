## CVE-2025-40634 - TP-Link Archer AX50 栈溢出

**漏洞编号:** CVE-2025-40634

**漏洞类型:** 栈溢出

**影响应用:** TP-Link Archer AX50

**危害等级:** 高危，允许远程代码执行

**影响版本:** < 1.0.15 build 241203 rel61480

**利用条件:** LAN 或 WAN 网络可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-40634是TP-Link Archer AX50路由器中`conn-indicator`二进制文件中的一个基于栈的缓冲区溢出漏洞。该漏洞存在于固件版本低于1.0.15 build 241203 rel61480的版本中。 攻击者可以通过发送特制的DNS响应数据包来利用此漏洞，从而在设备上执行任意代码。

**有效性：**
根据漏洞库信息和POC代码，该漏洞是有效的，并且存在可利用的POC。

**投毒风险：**
根据提供的POC代码分析，其中主要描述了漏洞的原理和利用方式，没有明显的恶意代码植入行为。但是，任何来源不明的代码都存在潜在的风险，建议在受控环境下进行测试。对给定的POC进行简单的静态分析,判断投毒风险为10%， 考虑到可能存在的隐蔽后门代码，风险难以完全排除。

**利用方式：**
1.  攻击者向目标TP-Link Archer AX50路由器发送DNS查询。
2.  路由器上的`conn-indicator`二进制文件会尝试解析DNS响应。
3.  攻击者发送特制的DNS响应数据包到路由器随机开放的UDP端口 (32000 - 61000)。
4.  `TPDns_RecvAndResolve()`函数接收数据包并将数据存储在`buf`中。
5.  `process_resolved_IP()`函数调用`DNS_answer_parser()`来解析DNS响应中的域名。
6.  在`DNS_answer_parser()`函数中，通过控制域名长度字段`<len>`，可以触发`memcpy`函数将过长的数据复制到`current_answer`缓冲区，导致栈溢出，从而覆盖返回地址，实现任意代码执行。

**其他信息：**
*   该漏洞与CVE-2020-10881类似，但利用过程略有不同，需要编写新的exploit。
*   漏洞影响`conn-indicator`二进制文件，该文件以root权限运行。
*   漏洞可以在LAN和WAN网络上被利用。
*   TP-Link已在固件版本1.0.15 build 241203 rel61480中修复了该漏洞。

**项目地址:** [hacefresko/CVE-2025-40634](https://github.com/hacefresko/CVE-2025-40634)

**漏洞详情:** [CVE-2025-40634](https://nvd.nist.gov/vuln/detail/CVE-2025-40634)