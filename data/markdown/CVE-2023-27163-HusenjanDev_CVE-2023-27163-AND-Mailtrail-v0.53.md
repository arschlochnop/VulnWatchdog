## CVE-2023-27163 - Request Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request Baskets

**危害等级:** 高危，可泄露内部信息，甚至可能造成远程代码执行

**影响版本:** <= 1.2.1

**利用条件:** 目标Request Baskets服务可访问，且内部可能存在其他服务（如Mailtrail v0.53）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者通过构造恶意的 API 请求到 `/api/baskets/{name}`，可以强制服务器向任意 URL 发起请求，从而访问内部网络资源。 

**漏洞利用方式：**

1.  **创建Basket并配置转发：**  利用 Request Baskets 的 API 创建一个新的 basket (例如 `pwned`)，并配置其 `forward_url` 指向内部服务 (如 `http://127.0.0.1:80/`，这里指向的是 Mailtrail)。
2.  **触发转发：**  访问创建的 basket (例如 `/pwned`)，这将导致 Request Baskets 服务器将请求转发到内部服务。
3.  **结合其他漏洞进行利用：**  如果内部服务存在其他漏洞（如Mailtrail v0.53 的远程代码执行漏洞），则可以进一步利用 SSRF 漏洞，例如通过访问 `/pwned/login` 并注入恶意payload来执行任意命令。
4.  **反弹shell：**  POC代码中，攻击者首先通过SSRF将内部Mailtrail服务暴露到`/pwned`，然后通过构造特定的URL，触发Mailtrail的RCE漏洞，从而反弹shell。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此POC代码**有效**。它演示了如何利用 Request Baskets 的 SSRF 漏洞，结合 Mailtrail 的漏洞，实现远程代码执行。

**投毒风险：**

POC代码相对清晰，主要逻辑是利用SSRF和RCE进行攻击。但是，`exploit.py`中直接使用`os.system(command)`执行命令存在一定风险。虽然当前command是为了反弹shell，但理论上如果`LISTENING_IP`和`LISTENING_PORT`被恶意修改，依然可以通过该命令执行其他任意操作，造成潜在的风险。

因此，判断投毒风险为10%。主要考虑是`os.system()`执行命令的潜在危险，以及代码来源的不可完全信任性。

**项目地址:** [HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53](https://github.com/HusenjanDev/CVE-2023-27163-AND-Mailtrail-v0.53)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)