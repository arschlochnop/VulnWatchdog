## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可能导致完全控制受影响设备

**影响版本:** 受影响版本包括16.1.1到17.12.1以及其他版本

**利用条件:** 目标设备启用了Web UI功能并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于Cisco IOS XE Software的Web UI中，允许未经身份验证的远程攻击者创建一个具有特权级别15（完全访问权限）的本地用户帐户。该漏洞利用方式是通过发送特制的HTTP请求到`/webui/create_user`路径来创建用户。攻击者随后可利用创建的用户并通过另一个漏洞CVE-2023-20273提升权限至root并写入植入程序。提供的POC代码尝试模拟此过程，包括创建用户、安装植入程序、重启Web服务器、检查植入程序状态以及清理创建的用户。 

**有效性：**根据漏洞信息、搜索结果和提供的POC代码，该漏洞是有效的。搜索引擎结果表明该漏洞已被积极利用，并且存在公开可用的POC代码。CISA的已知被利用漏洞目录也收录了该漏洞。

**投毒风险：**POC代码本身存在一定的风险。虽然代码的主要功能是利用漏洞，但`config_content`变量表明存在植入恶意配置的可能性。 用户需要手动插入植入配置,存在被植入后门的风险。
该仓库readme描述，POC仅用于测试和学习，有免责声明。存在一定概率作者未充分测试。

**利用方式：**
1.  **初始访问：** 未经身份验证的攻击者发送特制HTTP请求到存在漏洞的Cisco IOS XE设备的Web UI接口。
2.  **用户创建：**  利用CVE-2023-20198，攻击者通过`/webui/create_user`接口创建一个具有管理员权限的新用户。
3.  **权限提升（CVE-2023-20273）：** 利用新创建的用户，攻击者可以进一步利用Web UI中的另一个漏洞（CVE-2023-20273）来提升权限至root。
4.  **植入后门：** 攻击者可以写入植入程序到文件系统。
5.  **持久化：** 植入程序可以用于维持对受感染设备的访问。
6.  **清理（可选）：** 攻击者可以选择删除他们创建的后门账户，以隐藏其踪迹。

**项目地址:** [Tounsi007/CVE-2023-20198](https://github.com/Tounsi007/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)