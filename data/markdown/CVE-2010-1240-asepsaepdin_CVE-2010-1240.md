## CVE-2010-1240 - Adobe Reader/Acrobat 文件执行漏洞

**漏洞编号:** CVE-2010-1240

**漏洞类型:** 文件执行

**影响应用:** Adobe Reader/Acrobat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 9.x before 9.3.3, 8.x before 8.2.3

**利用条件:** 用户需要打开恶意的PDF文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2010-1240 漏洞存在于 Adobe Reader 和 Acrobat 软件中，允许攻击者通过特制的 PDF 文档欺骗用户执行任意本地程序。漏洞原因是程序未限制 Launch File 警告对话框中的某个文本字段的内容，攻击者可以利用此漏洞，在 PDF 文档中嵌入恶意程序，并通过伪造的警告信息诱使用户点击“打开”按钮来执行该程序。从提供的漏洞利用代码来看，这是一个利用 Metasploit 框架生成包含恶意 payload 的 PDF 文档的脚本。该脚本通过 `exploit/windows/fileformat/adobe_pdf_embedded_exe` 模块，将指定的 payload (例如 `windows/meterpreter/reverse_tcp`) 嵌入到 PDF 文件中。利用过程主要涉及生成恶意PDF，诱骗用户打开，并建立反向连接。

**有效性：** 提供的POC代码有效，因为该代码是基于 Metasploit 框架的，并且在之前的漏洞分析报告中确认可以使用。

**投毒风险：** 投毒风险较低，约为5%。主要基于以下几点：

*   代码的主要功能是利用已知的漏洞，而非引入新的恶意功能。
*   该仓库看起来是一个漏洞演示和教学项目，作者的目的在于演示漏洞利用过程，而不是传播恶意软件。
*   使用Metasploit生成payload本身就存在风险,用户需要自己设置payload,作者的恶意投毒行为很难实现

**利用方式：**

1.  使用 Metasploit 框架的 `exploit/windows/fileformat/adobe_pdf_embedded_exe` 模块。
2.  设置 `INFILENAME` 为原始 PDF 文件的路径。
3.  设置 `FILENAME` 为恶意 PDF 文件的名称。
4.  设置 `payload` 为希望执行的恶意代码 (例如 `windows/meterpreter/reverse_tcp`)。
5.  设置 `LHOST` 为攻击者的 IP 地址。
6.  生成恶意 PDF 文件。
7.  启动 Metasploit 的监听模块 (`exploit/multi/handler`)，设置相同的 payload 和 LHOST。
8.  诱骗用户打开恶意 PDF 文件。
9.  当用户点击“打开”按钮时，嵌入的恶意程序将被执行，攻击者将获得对受害者机器的控制权。

**项目地址:** [asepsaepdin/CVE-2010-1240](https://github.com/asepsaepdin/CVE-2010-1240)

**漏洞详情:** [CVE-2010-1240](https://nvd.nist.gov/vuln/detail/CVE-2010-1240)