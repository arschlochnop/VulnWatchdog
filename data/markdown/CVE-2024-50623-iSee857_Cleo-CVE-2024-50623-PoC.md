## CVE-2024-50623 - Cleo Harmony/VLTrader/LexiCom 任意文件上传漏洞

**漏洞编号:** CVE-2024-50623

**漏洞类型:** 任意文件上传

**影响应用:** Cleo Harmony, VLTrader, LexiCom

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 5.8.0.21

**利用条件:** 需要网络访问Cleo产品服务端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-50623 是 Cleo Harmony, VLTrader 和 LexiCom 产品中存在的一个任意文件上传漏洞。攻击者可以利用此漏洞上传恶意文件，例如 webshell，从而实现远程代码执行。

**漏洞分析：**
漏洞的根本原因是软件对上传的文件类型没有进行充分的验证和限制。通过构造特定的 HTTP 请求，可以绕过上传限制，将恶意文件上传到服务器上。

**利用方式：**
POC 代码的利用方式如下：

1.  **版本检测：** 首先，通过访问 `/Synchronization` 路径，获取服务器的 `Server` 头部信息，从中提取 Cleo 产品名称和版本号。
2.  **版本判断：** 将提取的版本号与 `5.8.0.24` 进行比较，如果版本号小于 `5.8.0.24`，则认为目标系统可能存在漏洞。
3.  **任意文件读取：** 通过构造带有 `VLSync` Cookie 的 GET 请求，读取服务器上的任意文件。POC 代码尝试读取 `windows\system.ini` 文件来验证漏洞是否存在。
4.  **任意文件上传：** 如果任意文件读取成功，则构造带有恶意 payload 的 POST 请求，上传 `test.txt` 文件。
5.  **验证上传：** 再次通过构造带有 `VLSync` Cookie 的 GET 请求，读取上传的 `test.txt` 文件，验证是否上传成功，如果读取成功，则说明漏洞存在，可以执行任意代码。

**有效性：**
提供的 POC 代码看起来是有效的，因为它能够检测目标系统是否存在漏洞，并能够上传和读取文件。

**投毒风险：**
代码本身看起来是安全的，没有明显的投毒代码。它只是利用漏洞进行验证。投毒风险评估为0%。

**搜索引擎结果补充：**
根据搜索引擎的结果，该漏洞已经被广泛利用，存在实际的攻击案例。CISA 已将其添加到已知被利用的漏洞列表中，表明该漏洞的威胁程度较高，应尽快修复。

**项目地址:** [iSee857/Cleo-CVE-2024-50623-PoC](https://github.com/iSee857/Cleo-CVE-2024-50623-PoC)

**漏洞详情:** [CVE-2024-50623](https://nvd.nist.gov/vuln/detail/CVE-2024-50623)