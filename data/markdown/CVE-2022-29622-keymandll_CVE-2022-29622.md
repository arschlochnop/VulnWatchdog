## CVE-2022-29622-formidable-任意文件上传

**漏洞编号:** CVE-2022-29622

**漏洞类型:** 任意文件上传

**影响应用:** formidable

**危害等级:** 中危（取决于应用场景和配置）

**影响版本:** 3.1.4

**利用条件:** 允许用户上传文件的Web应用，使用formidable 3.1.4。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-29622是formidable v3.1.4中存在的一个任意文件上传漏洞。攻击者可以通过构造恶意文件名来执行任意代码。但是，许多第三方对此问题存在争议，因为该产品在上传任意文件是预期行为的常见用例。此外，所有版本中都存在可以更改文件处理方式默认行为的配置选项。Strapi 认为这不是一个有效的漏洞。

**有效性分析：**

根据漏洞库信息和搜索引擎结果，该漏洞的有效性存在争议。尽管NVD和一些安全厂商将其标记为任意文件上传漏洞，但formidable的维护者和其他一些安全研究人员认为，在某些使用场景下，上传任意文件本身就是期望的行为，并且可以通过配置来限制文件上传。

提供的POC代码实际上是一个“非漏洞分析”，旨在反驳 CVE-2022-29622 的有效性。作者提供了一个使用formidable v3.1.4的服务器，并挑战使用者通过上传恶意文件或文件名来执行任意代码。作者声明，只有在严格遵守规则（例如，不修改服务器端代码）的情况下成功利用，才能证明 formidable 存在漏洞。

**投毒风险分析：**

POC代码本身是为了演示“非漏洞”，因此不太可能包含直接的恶意代码。但是，任何代码库都存在潜在的投毒风险。 风险点在于该代码可能不安全，可能会被黑客利用，或者被黑客更改成恶意代码，如果被用在产品环境中会造成危害。 虽然作者旨在证明该库没有漏洞，但该代码仍然可能存在其他未知的安全问题，因此不能完全排除投毒的可能性。 考虑到代码作者试图反驳漏洞存在，并且代码相对简单，投毒风险相对较低，但不能完全排除。风险评估大约是10%。

**利用方式分析：**

标准的利用方式应该是，通过精心构造包含恶意代码的文件名（例如，包含JavaScript代码），并上传到使用formidable处理文件上传的服务器上。如果服务器没有进行充分的验证和清理，恶意文件名可能会被解析和执行，从而导致任意代码执行。然而，正如漏洞描述中所述，许多应用场景中，服务器可能需要接收任意文件名，或者可以通过配置来禁用潜在的危险文件名处理。

总的来说，CVE-2022-29622的利用方式取决于具体的应用场景和服务器配置。在某些情况下，它可以被利用来执行任意代码，但在其他情况下，它可能不会构成真正的安全风险。

**项目地址:** [keymandll/CVE-2022-29622](https://github.com/keymandll/CVE-2022-29622)

**漏洞详情:** [CVE-2022-29622](https://nvd.nist.gov/vuln/detail/CVE-2022-29622)