## CVE-2019-12185-eLabFTW-Arbitrary File Upload

**漏洞编号:** CVE-2019-12185

**漏洞类型:** 任意文件上传

**影响应用:** eLabFTW

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.8.5

**利用条件:** 需要目标系统安装eLabFTW 1.8.5，并具有一个用户账号（用于登录）。攻击者需要能够通过POST请求与目标服务器通信。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-12185 是 eLabFTW 1.8.5 中的一个漏洞，允许攻击者通过 `/app/controllers/EntityController.php` 组件上传任意文件，从而导致远程代码执行。根据漏洞库信息和搜索结果，利用此漏洞，攻击者可以利用具有有效用户帐户的身份验证绕过或利用上传功能中的缺陷。PoC代码 (`elabftw-185.py`) 自动化了此过程：

1.  **登录:** PoC首先尝试使用提供的电子邮件和密码登录到eLabFTW实例。
2.  **上传恶意文件:** 成功登录后，PoC会发送一个包含恶意PHP代码的文件上传请求到易受攻击的`/app/controllers/EntityController.php`端点。该文件伪装成图片文件，但实际上包含PHP代码，允许在服务器上执行任意命令。
3.  **远程代码执行:** 上传的文件存储在`/uploads/[random 2 alphanum]/[random long alphanumeric].php5`中，可以通过URL访问。访问此URL将执行上传的PHP代码。

**投毒风险评估：**

虽然提供的PoC代码本身似乎直接实现了漏洞利用，但依然存在轻微的投毒风险，大约10%。风险主要体现在以下几个方面：

*   **依赖项风险:** PoC依赖`requests`和`BeautifulSoup4`库。虽然这些是常用的库，但攻击者可能通过替换或修改这些库来引入恶意代码。
*   **变量传递风险:** PoC依赖于命令行参数传递目标URL、用户名、密码和目录名。攻击者可能诱导用户使用包含恶意参数的脚本，例如指向恶意服务器或包含有害命令的目录名。
*   **后门植入风险:** 攻击者可能在PoC的某个位置植入额外的代码，用于在目标系统上安装后门，收集敏感信息或执行其他恶意活动。这种植入可能隐藏在代码的混淆部分或不常用的函数中。

为了降低投毒风险，建议在使用PoC代码之前进行彻底的代码审查和安全分析，确保代码的完整性和安全性。此外，建议从官方渠道或可信来源获取PoC代码，并定期更新依赖项，以修复已知的安全漏洞。

**利用方式总结：**

1.  获取有效的eLabFTW用户凭据。
2.  使用PoC脚本或手动构造恶意POST请求，将包含PHP代码的文件上传到服务器。
3.  通过访问上传文件的URL触发远程代码执行。
4.  利用执行的PHP代码获得对服务器的控制。

**项目地址:** [fuzzlove/eLabFTW-1.8.5-EntityController-Arbitrary-File-Upload-RCE](https://github.com/fuzzlove/eLabFTW-1.8.5-EntityController-Arbitrary-File-Upload-RCE)

**漏洞详情:** [CVE-2019-12185](https://nvd.nist.gov/vuln/detail/CVE-2019-12185)