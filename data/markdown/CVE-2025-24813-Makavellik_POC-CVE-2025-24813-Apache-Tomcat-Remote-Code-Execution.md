## CVE-2025-24813 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行，信息泄露或恶意内容注入

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要满足以下条件:
1. 默认Servlet开启了写入功能（默认关闭）
2. 支持部分PUT请求（默认开启）
3. (RCE) 应用使用Tomcat的文件session持久化，且为默认存储位置，应用包含可用于反序列化攻击的库。
4. (信息泄露/内容注入) 存在安全敏感文件上传的目标URL，该URL是公开上传目标URL的子目录，攻击者知道被上传的安全敏感文件的名称，且安全敏感文件也是通过部分PUT上传的。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 漏洞是 Apache Tomcat 中由于路径等效性问题，以及部分 PUT 功能的缺陷导致的远程代码执行或信息泄露漏洞。攻击者可以通过构造恶意的部分 PUT 请求，上传恶意文件覆盖或注入到服务器上的敏感文件，或者在特定条件下利用反序列化漏洞执行任意代码。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞存在活跃的利用案例，并且有公开的 PoC 代码。提供的 PoC 代码描述看起来也比较完整，包括了利用步骤、所需依赖、payload生成方式，以及WAF绕过等功能。因此，可以认为该 PoC 代码具有较高的有效性。

**投毒风险分析：** PoC 代码中存在一定的投毒风险。风险点包括:

1.  **`ysoserial.jar` 依赖：** 该工具本身是用于生成 Java 反序列化 payload 的，如果下载的 `ysoserial.jar` 被篡改，则可能执行恶意代码。
2.  **自定义 Java Payload：** PoC 允许使用自定义的 Java 代码来生成 payload，如果攻击者不小心使用了包含恶意代码的 Java 源文件，也可能导致被攻击。
3.  **代码本身:** 仓库中作者可能在`POC-Exploit_CVE_2025_24813.py`隐藏了后门，导致使用者在不知情的情况下执行了恶意代码。

基于上述分析，投毒风险评估为 10%。

**利用方式总结：**

1.  **漏洞利用入口：** 通过构造恶意的 HTTP PUT 请求，利用 Tomcat 默认 Servlet 的写入功能和部分 PUT 特性。
2.  **路径等效性：** 攻击者利用路径等效性问题（例如，`file.Name` 中的内部点），访问或操作受保护的文件。
3.  **信息泄露/内容注入：** 如果攻击者能够满足上述条件，则可以覆盖或注入恶意代码到服务器的敏感文件中。
4.  **远程代码执行：** 如果目标应用使用了 Tomcat 的文件 session 持久化，并且存在可利用的反序列化库，攻击者可以通过上传恶意 session 文件，触发反序列化漏洞，从而执行任意代码。
5.  **绕过WAF：** PoC 代码中包含 WAF 绕过功能，通过修改 Headers 或者对 Payload 进行拆分等方式，尝试绕过 WAF 的检测。

**项目地址:** [Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution](https://github.com/Makavellik/POC-CVE-2025-24813-Apache-Tomcat-Remote-Code-Execution)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)