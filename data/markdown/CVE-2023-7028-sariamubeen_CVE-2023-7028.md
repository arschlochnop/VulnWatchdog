## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱口令找回机制漏洞

**影响应用:** GitLab

**危害等级:** 高危，可导致任意用户账户接管，包括管理员账户

**影响版本:** 16.1之前到16.1.6, 16.2之前到16.2.9, 16.3之前到16.3.7, 16.4之前到16.4.5, 16.5之前到16.5.6, 16.6之前到16.6.4, 和 16.7之前到16.7.2

**利用条件:** 需要知道目标用户的邮箱地址，并且GitLab实例存在漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028是GitLab中一个严重的漏洞，攻击者可以利用该漏洞通过伪造密码重置请求来接管任何用户的帐户。该漏洞存在于密码重置功能中，允许攻击者在重置密码时提供两个电子邮件地址：受害者电子邮件地址和攻击者控制的电子邮件地址。GitLab会将密码重置链接同时发送到这两个地址。攻击者可以点击发送到其邮箱的链接，设置新密码，从而控制受害者的帐户。

**漏洞利用方式：**

1.  **目标锁定：** 攻击者需要确定目标GitLab实例和受害者的电子邮件地址。
2.  **构造恶意请求：** 攻击者使用提供的POC代码（`attack.py`）构造一个包含两个电子邮件地址的密码重置请求：一个是受害者的电子邮件地址，另一个是攻击者控制的电子邮件地址。
3.  **发送请求：**  攻击者将构造的恶意请求发送到GitLab服务器的 `/users/password` 端点。
4.  **接管账户：** GitLab服务器会向两个电子邮件地址发送密码重置链接。攻击者访问自己邮箱中的链接，设置新的密码，然后使用新密码登录受害者的帐户。

**有效性：**
根据漏洞信息、搜索引擎结果以及提供的PoC代码，可以判断该PoC代码是有效的。漏洞库信息显示该漏洞危害严重，CVSS评分高达10。搜索引擎结果中大量的文章和讨论也验证了该漏洞的真实性和可利用性。PoC代码的结构清晰，逻辑简单，易于理解和使用，验证了其有效性。

**投毒风险：**
对PoC代码进行了分析，没有发现任何明显的投毒代码。代码的功能是模拟密码重置过程，向指定的邮箱发送重置链接。虽然攻击者可以利用此代码进行恶意攻击，但代码本身并没有包含任何隐藏的、非预期的恶意行为。从代码的实现来看，主要功能是发送包含target和evil邮箱的密码重置请求，没有其他恶意操作，比如植入后门，收集信息等。因此投毒风险较低，评估为0%。需要注意的是，使用该PoC进行未授权的渗透测试属于非法行为。

**项目地址:** [sariamubeen/CVE-2023-7028](https://github.com/sariamubeen/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)