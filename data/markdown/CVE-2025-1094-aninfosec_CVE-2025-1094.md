## CVE-2025-1094-PostgreSQL-SQL注入

**漏洞编号:** CVE-2025-1094

**漏洞类型:** SQL注入

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 17.3, < 16.7, < 15.11, < 14.16, < 13.19

**利用条件:** 需要目标应用程序使用受影响的PostgreSQL版本，并且使用libpq函数或psql命令行工具处理用户提供的、经过编码转换（BIG5到EUC_TW或MULE_INTERNAL）的输入。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-1094是PostgreSQL中的一个SQL注入漏洞，影响多个版本。漏洞根源在于PostgreSQL的`PQescapeLiteral()`、`PQescapeIdentifier()`、`PQescapeString()`和`PQescapeStringConn()`等libpq函数，以及psql命令行工具在处理编码转换时，未能正确转义引号语法。如果应用程序使用这些函数的结果来构造传递给psql的输入，或者psql处理来自命令行参数的输入时，存在被SQL注入的风险。

**有效性：**
根据漏洞描述、搜索结果和提供的PoC代码，该漏洞是有效的。搜索结果表明，Rapid7的研究人员发现了这个漏洞，并且已经有针对性的攻击发生。PoC代码通过设置`PGCLIENTENCODING`环境变量为`BIG5`，并构造恶意的SQL注入payload，利用`COPY ... TO PROGRAM`语句执行任意shell命令，从而获得反向shell。

**投毒风险：**
PoC代码分析：
* `exploit.py`脚本的目的是利用CVE-2025-1094漏洞。它通过构造特定的SQL payload，该payload包含`COPY ... TO PROGRAM`语句来执行系统命令，从而获得反向shell。
* `README.md`文件只包含CVE编号。
结论：
该仓库中**没有发现**明显的投毒代码。该脚本的目的是利用漏洞，而不是安装恶意软件或执行其他恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  **环境配置：** 设置环境变量`PGCLIENTENCODING`为`BIG5`，模拟编码转换的环境。
2.  **构造Payload：** 构造包含恶意SQL代码的payload。PoC中使用了`COPY ... TO PROGRAM`语句，允许执行系统命令。
3.  **发送请求：** 将payload作为参数发送到目标应用程序，触发SQL注入。
4.  **反向Shell：** 如果利用成功，目标服务器会连接到攻击者的IP地址和端口，建立反向shell连接。

**项目地址:** [aninfosec/CVE-2025-1094](https://github.com/aninfosec/CVE-2025-1094)

**漏洞详情:** [CVE-2025-1094](https://nvd.nist.gov/vuln/detail/CVE-2025-1094)