## CVE-2023-2598-Linux内核io_uring本地提权

**漏洞编号:** CVE-2023-2598

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可以提升到root权限

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-2598 存在于Linux内核的io_uring子系统中，`io_sqe_buffer_register` 函数中存在一个缺陷，允许越界访问物理内存。这个缺陷发生在固定缓冲区注册过程中。攻击者可以利用此漏洞实现本地权限提升。

**有效性：**
根据提供的漏洞库信息、搜索结果和漏洞利用代码，该漏洞的POC是有效的。搜索结果中直接包含指向GitHub上POC代码的链接 (ysanatomic/io_uring_LPE-CVE-2023-2598)。漏洞库信息也表明这是一个可利用的漏洞。

**投毒风险：**
分析提供的POC代码，投毒风险较低。主要风险点在于：
*   `exploit.c`： 这是一个相对完整的提权利用代码，主要通过 io_uring 机制进行内存操作。其中包含设置CPU亲和性、初始化io_uring、创建sockets、创建memfds等操作，最终目的是利用越界访问漏洞读取内核内存，并修改内核结构，实现提权。虽然代码逻辑较为复杂，但主要集中在漏洞利用本身，没有明显的后门或恶意代码。
考虑到作者已经公开了漏洞分析和利用代码，潜在的投毒行为会增加被发现的概率，因此判断存在轻微的投毒风险，主要是为了防止被检测。

**利用方式：**
1.  **漏洞触发：** 该漏洞利用`io_uring`子系统的固定缓冲区注册功能，通过`io_sqe_buffer_register`函数注册固定缓冲区时，存在越界访问漏洞。
2.  **内存布局：** 漏洞利用代码通过创建大量sockets和memfds来控制内核内存布局，为后续的利用创造条件。
3.  **信息泄露：** 利用越界访问漏洞，读取内核内存中的敏感信息，例如内核地址(`kaslr_base`)。
4.  **权限提升：** 通过修改内核结构体(如`cred`结构体)中的`uid`、`gid`等字段，将当前进程的权限提升到root权限。具体的利用手法涉及到 ROP (Return-Oriented Programming)，通过执行一系列预先构造好的指令序列来完成权限提升。
5.  **清理工作：** 清理现场，恢复被修改的内核状态，避免系统崩溃。

综上，此漏洞利用方式较为复杂，需要对`io_uring`子系统和内核内存管理有深入的理解。攻击者需要精心构造`io_uring`请求，控制内存布局，才能成功实现权限提升。

**项目地址:** [ysanatomic/io_uring_LPE-CVE-2023-2598](https://github.com/ysanatomic/io_uring_LPE-CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)