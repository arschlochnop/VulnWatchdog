## CVE-2018-0114-Node-jose-JWT 签名伪造

**漏洞编号:** CVE-2018-0114

**漏洞类型:** JWT 签名伪造

**影响应用:** Node-jose Library

**危害等级:** 高危，可能导致身份伪造和未授权访问

**影响版本:** < 0.11.0

**利用条件:** 目标系统使用存在漏洞的 Node-jose 库进行 JWT 验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-0114 漏洞存在于 Cisco node-jose 开源库 0.11.0 之前的版本中。攻击者可以利用该漏洞，通过在 JWT 头部嵌入恶意构造的 JSON Web Key (JWK)，然后使用与该 JWK 关联的私钥重新签名，从而伪造 JWT 令牌。漏洞利用方式如下：

1.  **获取原始 JWT 令牌：** 首先，攻击者需要获取一个由目标系统签发的 JWT 令牌。
2.  **构造恶意 JWK：** 攻击者生成一对新的公钥和私钥。然后，攻击者创建一个包含公钥信息的 JWK 对象，并将其添加到 JWT 头部。
3.  **移除原始签名并重新签名：** 攻击者移除原始 JWT 签名，使用攻击者生成的私钥对修改后的 JWT 头部和载荷进行签名。
4.  **发送伪造的 JWT 令牌：** 攻击者将伪造的 JWT 令牌发送到目标系统。

由于存在漏洞的 Node-jose 库信任 JWT 头部中提供的 JWK，因此它会使用攻击者的公钥验证伪造的签名，从而允许攻击者绕过身份验证。

根据提供的漏洞利用代码 `jwt-cisco-node-exploit.py`，该脚本实现了上述步骤，可以生成带有攻击者控制的签名的恶意 JWT 令牌。该代码没有发现明显的投毒风险，主要功能是生成密钥对，构造包含公钥信息的header，然后对header和payload进行签名，最终生成伪造的 JWT 令牌。

搜索引擎结果也确认了该漏洞的存在和利用方式，并提供了相关的 PoC 和练习。因此，提供的 POC 代码是有效的。


**项目地址:** [Pandora-research/CVE-2018-0114-Exploit](https://github.com/Pandora-research/CVE-2018-0114-Exploit)

**漏洞详情:** [CVE-2018-0114](https://nvd.nist.gov/vuln/detail/CVE-2018-0114)