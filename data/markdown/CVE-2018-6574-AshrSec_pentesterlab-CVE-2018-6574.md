## CVE-2018-6574-Go远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 目标系统需要安装受影响版本的Go，并且执行 `go get` 命令获取包含恶意代码的包。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574漏洞存在于Go语言的`go get`命令中，允许远程命令执行。当使用`go get`构建包含恶意代码的Go项目时，攻击者可以利用gcc或clang插件功能，通过`-fplugin=`或`-plugin=`参数执行任意命令。提供的PoC代码包含一个C文件（`exploit.c`）和一个Go文件（`main.go`）。

`exploit.c` 文件定义了一个在加载时自动执行的 `malicious` 函数。这个函数调用 `system` 函数执行 `/usr/local/bin/score 2c03d8c2-7038-402d-ae28-03a4d2ed9f42` 命令。这个命令是用于上报漏洞利用成功的信息，是测试环境常用的方法。所以这里的投毒风险很低。

`main.go` 文件通过 cgo 技术，允许 Go 代码调用 C 代码。 `#cgo CFLAGS: -fplugin=./exploit.so`  这行代码指示编译器将 `exploit.so` 作为 gcc/clang 插件加载，从而执行 `exploit.c` 中的恶意代码。

利用方式如下：
1.  攻击者创建一个包含恶意 `exploit.c` 和 `main.go` 的Go项目。
2.  攻击者将该项目托管到公共代码仓库。
3.  受害者在安装了受影响Go版本的机器上使用 `go get <攻击者项目>` 命令。
4.  `go get` 在构建项目时，会加载 `exploit.so` 插件，从而执行 `exploit.c` 中的恶意代码。

结论：该PoC代码有效，可以用于验证CVE-2018-6574漏洞。代码本身没有明显的隐藏投毒代码的迹象。

**项目地址:** [AshrSec/pentesterlab-CVE-2018-6574](https://github.com/AshrSec/pentesterlab-CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)