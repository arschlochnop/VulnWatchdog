## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露、权限提升、甚至远程代码执行

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS Made Simple实例存在News模块，且版本小于等于2.2.9

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于CMS Made Simple的News模块中，攻击者可以通过构造包含恶意SQL语句的URL，利用`m1_idlist`参数进行未经身份验证的盲注攻击。该POC代码通过时间盲注的方式，逐个字符地dump出数据库中的敏感信息，包括用户名、密码salt和hash。利用方式如下：

1.  **漏洞定位：**  漏洞存在于News模块的`moduleinterface.php`文件中，通过`m1_idlist`参数传递SQL注入payload。
2.  **Payload构造：**  POC利用时间盲注，构造包含`sleep()`函数的SQL语句，根据响应时间判断字符是否匹配。例如，`... AND+(SELECT+sleep({TIME})+FROM+{table}+WHERE+{field_name}+LIKE+0x{hex_attempt}25+AND+{condition})--+`
3.  **信息提取：**  POC循环遍历字符集，通过时间盲注逐个字符地提取用户名、salt和密码哈希等敏感信息。
4.  **密码破解(可选)：**  如果提供了字典，POC会尝试使用提取的salt和密码哈希破解管理员密码。

**有效性：**  根据漏洞库信息、搜索结果以及提供的POC代码，该漏洞是真实存在的，并且POC代码可以有效利用该漏洞提取敏感信息。

**投毒风险：** POC代码主体是SQL注入利用代码，未发现明显恶意操作，但存在潜在风险，例如:

*   `clear_screen()`函数可能在特定环境下导致问题,但这并不是明显的投毒代码。
*   可以修改`time_based_sqli`函数来执行其他操作，例如发送额外请求到恶意服务器，或者修改`dump_field`函数来dump出其他恶意数据，但当前POC代码只是专注于SQL注入利用。`beautify_print_try`函数虽然会输出正在尝试的值，但是这主要是为了显示进度，不是投毒行为。
*  使用`eval()`或`exec()`函数执行动态代码可能存在风险，但此POC中没有使用，总体投毒风险较低。脚本中引用`rich`模块，这本身并不存在投毒风险。利用`os.system`执行系统命令虽然存在潜在风险，但这里的目的是清屏，因此主要风险在于如果目标系统存在安全漏洞，攻击者可能会利用该漏洞执行恶意命令，但这种风险与该漏洞本身无关。密码破解部分依赖于用户提供的字典文件，如果用户提供恶意字典文件，则可能导致安全问题，但这不是POC代码本身的问题。基于以上分析,投毒风险约为10%。

**项目地址:** [kaizoku73/CVE-2019-9053](https://github.com/kaizoku73/CVE-2019-9053)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)