## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修补版本)

**利用条件:** 需要网络访问Grafana实例

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是一个Grafana的目录遍历漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。根据漏洞库信息，受影响的版本为8.0.0-beta1到8.3.0（除了已修补的版本）。漏洞的利用方式是构造包含目录遍历序列的URL，访问`/public/plugins/<plugin_id>/`下的文件。 

**有效性：**

提供的POC代码是有效的。它通过发送带有精心构造的URL的HTTP GET请求来利用该漏洞。URL中的`%2e%2e/`用于进行目录遍历，从而尝试读取`/etc/passwd`文件。

**投毒风险：**

分析提供的POC代码仓库，没有发现明显的投毒代码。`CVE-2021-43798.py` 文件主要功能是发送请求利用目录遍历漏洞读取文件，`docker-compose.yml` 文件定义了Grafana的运行环境，`README.md` 提供了如何运行POC的说明。总体来说，该仓库的投毒风险较低。

**利用方式：**

1.  **确定目标Grafana实例的版本：** 确定目标Grafana实例是否在受影响的版本范围内 (8.0.0-beta1 to 8.3.0，不包括补丁版本8.0.7, 8.1.8, 8.2.7, 8.3.1)。
2.  **选择一个已安装的插件：** 确定Grafana实例中安装了哪些插件。`alertlist`是一个常用的插件，POC中使用了它作为示例。
3.  **构造恶意URL：** 构造包含目录遍历序列的URL，例如：`http://<grafana_host_url>/public/plugins/<plugin_id>/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。
4.  **发送HTTP请求：** 使用curl、wget或Python脚本（如提供的POC）发送HTTP GET请求到构造的URL。
5.  **分析响应：** 如果漏洞存在且利用成功，响应将包含目标文件的内容（例如，`/etc/passwd`文件的内容）。

**项目地址:** [ticofookfook/CVE-2021-43798](https://github.com/ticofookfook/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)