## CVE-2019-16278-nostromo-nhttpd-目录遍历导致RCE

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历导致远程代码执行

**影响应用:** nostromo nhttpd

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 1.9.6

**利用条件:** 目标服务器运行存在漏洞的nostromo nhttpd服务，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-16278 存在于 nostromo nhttpd 1.9.6 及更早版本中。该漏洞是由于 `http_verify` 函数中存在目录遍历漏洞，允许攻击者通过精心构造的 HTTP 请求实现远程代码执行。  

**有效性:**  提供的 exploit.py 代码看起来有效。它构造了一个包含目录遍历序列的 POST 请求，利用了`http_verify`函数中的漏洞。该PoC 使用了 `/.%0d./` 绕过路径检查，将请求发送到 `/bin/sh` 并执行命令。

**投毒风险:**  代码仓库中未发现明显的投毒代码。 exploit.py 主要功能是利用漏洞执行命令。 README.md 只是简单的使用说明。因此，评估投毒风险为 0%。

**利用方式:**
1.  攻击者发送一个特制的 HTTP POST 请求到存在漏洞的 nostromo nhttpd 服务器。
2.  该 POST 请求的 URL 包含目录遍历序列 (`/.%0d./`)，绕过 `http_verify` 函数的路径检查。
3.  通过目录遍历，请求指向 `/bin/sh`，允许执行系统命令。
4.  POST 请求的内容包含要执行的命令（通过`cmd`参数传入），并通过管道传递给 `/bin/sh` 执行。
5.  命令执行的结果会返回给攻击者。

**项目地址:** [darkerego/Nostromo_Python3](https://github.com/darkerego/Nostromo_Python3)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)