## CVE-2023-35078 - Ivanti EPMM 远程未授权API访问

**漏洞编号:** CVE-2023-35078

**漏洞类型:** 身份验证绕过

**影响应用:** Ivanti Endpoint Manager Mobile (EPMM)

**危害等级:** 严重，可能导致敏感数据泄露和完全系统控制

**影响版本:** 11.2 (prior to 11.2 CU21), 11.3 (prior to 11.3 CU18), 11.4 (prior to 11.4 CU8)

**利用条件:** 需要网络访问目标Ivanti EPMM服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-35078 是 Ivanti Endpoint Manager Mobile (EPMM) 中的一个身份验证绕过漏洞，允许未经身份验证的攻击者访问受限 API 路径，从而访问敏感信息和执行未经授权的操作。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码（POC），此漏洞利用是有效的。CISA的已知可利用漏洞目录(KEV)中包含了此漏洞，并且已经有公开可用的漏洞利用代码。

**投毒风险：**

根据提供的漏洞利用代码，初步分析发现潜在的投毒风险较低，预估为10%。投毒风险主要来自于以下几个方面：

1.  **依赖项风险：** `requirements.txt` 文件中可能包含恶意或被攻陷的第三方库。虽然代码本身看起来直接利用了漏洞，但间接依赖的库可能存在后门。
2.  **结果篡改：** 漏洞利用代码可能会在保存结果时进行篡改，例如，在提取的用户数据中插入恶意条目，或者泄露用户数据的同时上传其他信息到攻击者的服务器。
3.  **隐蔽后门：** 漏洞利用脚本可能包含执行额外恶意操作的代码，例如安装后门、收集系统信息或进行其他未经授权的活动。虽然目前的README文件描述看起来比较直接，但需要进一步审计实际的Python脚本 `cve_2023_35078.py` 来确定是否存在任何恶意代码。
4.  **作者声誉：** 虽然README文件提供了一些信息，但需要评估代码作者的信誉。如果作者的信誉不佳，或者之前有发布恶意软件的历史，那么投毒的风险会更高。

综上所述，虽然漏洞利用代码表面上看起来是无害的，但仍然需要进行全面的安全审计，以确保其不包含任何恶意代码或后门。

**利用方式：**

1.  **确定目标：** 识别运行存在漏洞的 Ivanti EPMM 版本的系统。
2.  **配置利用代码：** 下载提供的漏洞利用代码，安装所需的依赖项，并根据需要配置目标 URL。
3.  **执行攻击：** 运行漏洞利用代码，该代码将绕过身份验证机制，并访问`/mifs/aad/api/v2/authorized/users`API端点。
4.  **提取数据：** 漏洞利用成功后，代码将提取敏感用户信息，例如用户名、密码哈希、电子邮件地址等，并将数据保存到本地文件。
5.  **持久化（如果可能）：** 攻击者可能会利用泄露的凭据或其他信息来进一步渗透系统，并建立持久访问权限。

**项目地址:** [0nsec/CVE-2023-35078](https://github.com/0nsec/CVE-2023-35078)

**漏洞详情:** [CVE-2023-35078](https://nvd.nist.gov/vuln/detail/CVE-2023-35078)