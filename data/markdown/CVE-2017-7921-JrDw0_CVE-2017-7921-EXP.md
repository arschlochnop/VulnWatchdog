## CVE-2017-7921-Hikvision摄像头身份验证绕过

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备必须运行受影响的Hikvision摄像头固件版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于特定 Hikvision IP 摄像头中，允许未经身份验证的访问。攻击者可以利用 `auth` 参数绕过身份验证，例如通过构造 `http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK`  来下载包含用户名和密码的摄像头配置文件。PoC 代码尝试使用此漏洞读取配置文件并提取用户名和密码。利用方式是发送带有特定`auth`参数的HTTP GET请求，该参数包含base64编码的"admin:11\n"。如果成功，服务器将返回加密的配置文件，PoC对其进行解密并提取用户名和密码。虽然PoC的主要目的是演示漏洞，但存在轻微的投毒风险的可能性，例如包含恶意链接或旨在收集目标信息的代码，因此投毒风险估计为10%。

**有效性：** 根据漏洞描述和提供的PoC代码，该PoC代码有效。它利用了身份验证绕过漏洞，通过构造包含base64编码凭据的URL来访问敏感信息。

**投毒风险：**PoC代码本身看起来主要是利用漏洞，没有明显的恶意行为。但是，仍然需要警惕，因为存在以下风险：

*   **依赖项风险：** PoC代码依赖于外部库（例如`requests`、`Crypto.Cipher`、`fire`）。恶意作者可能会修改这些库以包含后门。
*   **信息收集：** 该PoC可能无意中收集有关目标系统的信息，并将其发送给攻击者。
*   **代码执行：** 虽然不太可能，但如果PoC代码被修改为执行任意代码，则可能存在投毒风险。

考虑到这些因素，PoC投毒风险评估为10%。

**利用方式：**

1.  **目标确定：** 确定运行易受攻击的Hikvision摄像头固件版本的IP地址。
2.  **漏洞利用：** 使用PoC代码，通过构造的URL（例如`http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK`）发送HTTP GET请求。
3.  **配置数据解密：** PoC代码解密返回的配置文件。
4.  **凭据提取：** PoC代码提取用户名和密码。
5.  **权限提升/信息泄露：** 使用提取的凭据以管理员权限访问摄像头，或利用泄露的信息进行其他攻击。

**项目地址:** [JrDw0/CVE-2017-7921-EXP](https://github.com/JrDw0/CVE-2017-7921-EXP)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)