## CVE-2024-24919-CheckPoint安全网关信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径穿越

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，允许未授权远程攻击者读取受影响设备上的任意文件

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备已连接互联网，并启用远程访问 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919 是 Check Point 安全网关中存在的一个高危信息泄露漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取 Check Point 安全网关设备上的任意文件。漏洞位于启用了远程访问 VPN 或 Mobile Access Software Blades 的设备上。

**有效性：**

提供的漏洞利用代码 (exploit.py) 看起来是有效的。它通过 HTTP 请求下载指定的文件，因此可以推断漏洞类型为路径遍历漏洞。从README文件可以看到该exp的使用方法，且从描述和搜索结果可知，已经存在在野利用，因此判定提供的POC是有效的。

**投毒风险：**

分析提供的POC代码，未发现明显的恶意代码，例如反弹 shell 或其他有害操作。`exploit.py`主要功能是发送HTTP请求读取文件内容，没有发现其他恶意操作。`README.md`文件中包含ShodanX工具，该工具为信息收集工具，本身不具备攻击性。但需要谨慎对待从第三方来源下载的代码，因为存在作者隐藏后门的风险。风险评估为10%。

**利用方式：**

1.  **漏洞定位：** 该漏洞存在于 Check Point 安全网关的 Web 服务中，具体位置可能在处理 VPN 或移动访问请求的模块中。
2.  **构造恶意请求：** 攻击者构造包含路径遍历Payload的HTTP请求，发送到目标 Check Point 安全网关。
3.  **读取任意文件：** Check Point 安全网关在处理该请求时，由于存在路径遍历漏洞，攻击者可以读取系统上的任意文件。
4.  **信息泄露：** 攻击者可以利用该漏洞读取敏感配置文件、用户凭据或其他有价值的信息。

**总结：**

CVE-2024-24919 是一个严重的信息泄露漏洞，利用难度低，影响范围广。攻击者可以利用该漏洞获取敏感信息，从而进一步攻击内部网络。建议尽快安装 Check Point 提供的补丁。

**项目地址:** [RevoltSecurities/CVE-2024-24919](https://github.com/RevoltSecurities/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)