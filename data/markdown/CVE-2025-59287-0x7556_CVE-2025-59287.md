## CVE-2025-59287 - Windows Server Update Service (WSUS) 远程代码执行漏洞

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 反序列化

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019, 2022, 2025, 23H2 版本的受影响范围。

**利用条件:** 需要能访问WSUS服务器的端口 (通常是8530)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287 是一个 Windows Server Update Service (WSUS) 中的远程代码执行漏洞，源于对不可信数据的反序列化。攻击者可以利用此漏洞通过网络在目标服务器上执行任意代码。该漏洞的利用方法是向 WSUS 服务器发送特制的 Ysoserial.net 反序列化 payload，当管理员打开 WSUS 控制台时，payload 会被触发，从而执行恶意代码。

**有效性：**
提供的POC代码有效。它演示了如何将 WolfShell 内存马注入到目标服务器。示例用法显示了如何通过发送 ysoserial.net 反序列化 payload 来实现 RCE。当管理员打开 WSUS 控制台时，内存马会触发。

**投毒风险：**
该POC代码的主要目的是演示漏洞利用，植入内存马。风险在于攻击者可能修改 payload 文件（例如 `wolfshell.txt`）以包含恶意代码，从而在目标系统上执行未经授权的操作。另外allow7556.txt为ysoserial.net的序列化数据,里面含有payload数据,如果作者替换payload可以达到攻击效果,因此存在一定的投毒风险，大概在10%。

**利用方式：**
1.  **漏洞利用:** 攻击者构造恶意的ysoserial.net payload,并将其保存到`wolfshell.txt`文件中
2.  **利用漏洞:** 攻击者使用提供的 `CVE-2025-59287` 工具，指定目标 WSUS 服务器的 URL 和 payload 文件路径作为参数。
3.  **触发漏洞:**  工具会发送 payload 到 WSUS 服务器，并在 WSUS 服务器上创建一个事件。该事件包含恶意的反序列化数据。
4.  **执行恶意代码:** 当管理员打开 WSUS 控制台时，WSUS 会尝试处理该事件，导致反序列化漏洞被触发，从而执行 payload 中的恶意代码（即植入的内存马）。
5.  **控制系统:**  通过植入的内存马，攻击者可以进一步控制受影响的系统，例如执行任意命令。

**项目地址:** [0x7556/CVE-2025-59287](https://github.com/0x7556/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)