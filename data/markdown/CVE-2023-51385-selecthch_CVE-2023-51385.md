## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统使用受影响的OpenSSH版本，并且攻击者可以控制用户名或主机名中的shell元字符。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符并且这些名称在某些情况下被扩展标记引用时，可能会发生操作系统命令注入。

**有效性：**

根据漏洞信息和搜索引擎结果，该漏洞是有效的，允许远程攻击者执行任意操作系统命令。

**投毒风险：**

提供的 POC 代码包含一个 `.gitmodules` 格式的文件，该文件定义了一个名为 "cves" 的子模块，该子模块的 URL 包含命令 `gnome-calculator`。当 `git submodule update --init --recursive` 被执行时，`gnome-calculator`命令就会被执行。这可能存在投毒风险。如果攻击者将恶意命令嵌入到子模块 URL 中，当用户克隆包含此子模块的恶意仓库并尝试初始化和更新子模块时，就会执行这些命令。风险评估为10%，主要是因为这个POC比较明显，容易被发现，且`gnome-calculator`本身无恶意，如果替换成更隐蔽的恶意命令，投毒性会更高。

**利用方式：**

1.  攻击者创建一个恶意的 Git 仓库，并在 `.gitmodules` 文件中，将子模块的 URL 设置为包含 shell 元字符和恶意命令的字符串。
2.  受害者克隆该恶意 Git 仓库。
3.  受害者执行 `git submodule update --init --recursive` 命令以初始化和更新子模块。
4.  由于 URL 中的 shell 元字符未被正确转义，OpenSSH 将执行 URL 中的恶意命令，导致远程代码执行。

**项目地址:** [selecthch/CVE-2023-51385](https://github.com/selecthch/CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)