## CVE-2025-49132-Pterodactyl Panel-RCE

**漏洞编号:** CVE-2025-49132

**漏洞类型:** 远程代码执行

**影响应用:** Pterodactyl Panel

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.11.11

**利用条件:** 目标Pterodactyl Panel版本低于1.11.11且可通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49132 存在于 Pterodactyl Panel 的 /locales/locale.json 端点，允许未经身份验证的攻击者执行任意代码。根据漏洞信息和搜索引擎结果，此漏洞的CVSS评分为10.0，属于危急级别，影响版本小于1.11.11。提供的PoC代码利用了 locale 和 namespace 查询参数，首先在目标服务器上创建一个包含恶意代码的PHP文件 (payload.php)，然后通过访问该文件执行命令。

**有效性：**
根据提供的漏洞信息、搜索结果以及PoC代码，该漏洞利用是有效的。PoC代码经过改进，使用了requests库，增强了稳定性和可读性，并且增加了命令行参数解析和错误处理。

**投毒风险：**
PoC代码主要功能是利用漏洞执行指定的命令。代码首先构造一个包含恶意PHP代码的URL，用于在目标服务器上创建一个临时文件payload.php。然后，它再次构造URL来执行这个文件。没有发现任何会向攻击者或其他第三方发送额外信息的恶意代码，也没有发现任何擦除或修改目标系统数据的代码，因此，投毒风险评估为0%。

**利用方式：**
1.  **利用前提：** 目标Pterodactyl Panel的版本小于1.11.11，且可以通过网络访问。
2.  **攻击步骤：**
    *   攻击者使用PoC脚本，指定目标主机的IP地址或域名，以及要执行的命令。
    *   PoC脚本首先构造一个包含PHP代码的URL，该PHP代码会将指定的命令传递给`system()`函数执行，并将结果写入`/tmp/payload.php`文件。
    *   PoC脚本发送GET请求到目标服务器的`/locales/locale.json`端点，其中包含精心构造的查询参数（`locale`和`namespace`），利用`config-create`功能在特定位置创建恶意的PHP文件。
    *   PoC脚本然后构造另一个GET请求到`/locales/locale.json`，利用先前创建的`/tmp/payload.php`文件执行任意命令。
    *   服务器执行命令，并将结果返回给攻击者。
3.  **缓解措施：**
    *   升级Pterodactyl Panel到1.11.11或更高版本。
    *   使用Web应用防火墙（WAF）来缓解攻击。

**项目地址:** [GRodolphe/CVE-2025-49132_poc](https://github.com/GRodolphe/CVE-2025-49132_poc)

**漏洞详情:** [CVE-2025-49132](https://nvd.nist.gov/vuln/detail/CVE-2025-49132)