## CVE-2021-27905 Apache Solr ReplicationHandler SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致信息泄露、内网探测等

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例开放/replication接口且未配置访问限制

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-27905是Apache Solr ReplicationHandler组件中的一个服务器端请求伪造(SSRF)漏洞。攻击者可以通过构造恶意的masterUrl或leaderUrl参数，使Solr服务器向任意URL发起请求。漏洞利用的有效性较高，因为POC代码清晰地展示了如何通过/replication接口和fetchindex命令以及masterUrl参数触发SSRF。首先，攻击者需要通过/solr/admin/cores接口获取Solr core的名称。然后，构造包含恶意URL的请求，例如`GET /solr/{core_name}/replication/?command=fetchindex&masterUrl={ssrf_here}`，发送到目标Solr服务器。服务器会根据攻击者提供的URL发起请求，从而实现SSRF攻击。投毒风险较低，但不能完全排除。虽然提供的POC代码主要是用于SSRF验证，但攻击者可能在其他文件中或在下载的依赖中加入恶意代码，比如监听特定端口、上传敏感信息等。需要人工审核其他的代码文件，以及依赖包来确认是否存在恶意代码，这里给出10%的风险评估是基于该README.md文件本身进行风险评估。

**项目地址:** [murataydemir/CVE-2021-27905](https://github.com/murataydemir/CVE-2021-27905)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)