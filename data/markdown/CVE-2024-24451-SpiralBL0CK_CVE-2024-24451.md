## CVE-2024-24451-OpenAirInterface CN5G AMF-栈溢出

**漏洞编号:** CVE-2024-24451

**漏洞类型:** 栈溢出

**影响应用:** OpenAirInterface CN5G AMF (oai-cn5g-amf)

**危害等级:** 高危，可导致拒绝服务（DoS）

**影响版本:** <= v2.0.0

**利用条件:** 需要网络访问AMF的N2接口

**POC 可用性:** 是

**投毒风险:** 90%

## 详情

CVE-2024-24451是OpenAirInterface CN5G AMF (oai-cn5g-amf) up to v2.0.0中的sctp_server::sctp_receiver_thread组件中的一个栈溢出漏洞。攻击者可以通过重复建立与N2接口的SCTP连接，并发送特制的NGAP消息，触发栈溢出，导致拒绝服务。PoC代码通过创建大量SCTP连接并发送畸形的NGAP消息来利用此漏洞。虽然PoC本身旨在演示漏洞利用，但存在潜在的投毒风险，因为攻击者可以修改PoC代码以包含恶意负载，例如尝试执行任意代码或进行其他未经授权的活动。此外，PoC代码中使用了os.urandom()来生成数据，如果种子不安全或者生成的随机数可预测，可能导致进一步的安全问题。

**漏洞利用方式：**
1.  建立与AMF N2接口的SCTP连接。
2.  发送畸形的NGAP消息，特别是`NGSetupRequest`和`InitialUEMessage`。
3.  通过重复建立连接和发送恶意消息来触发`sctp_receiver_thread`中的栈溢出。
4.  最终导致AMF服务崩溃，实现拒绝服务。

**项目地址:** [SpiralBL0CK/CVE-2024-24451](https://github.com/SpiralBL0CK/CVE-2024-24451)

**漏洞详情:** [CVE-2024-24451](https://nvd.nist.gov/vuln/detail/CVE-2024-24451)