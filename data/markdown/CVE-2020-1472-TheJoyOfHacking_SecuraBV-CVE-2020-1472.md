## CVE-2020-1472 (Zerologon): Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，可能导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2004, 2019, 1909, 1903, 2016, 2008 R2 SP1, 2012, 2012 R2, 和 20H2。具体版本参考漏洞库信息。

**利用条件:** 攻击者需要位于与域控制器相同的网络，并能够与其进行通信。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472（Zerologon）是一个Netlogon协议中的严重漏洞，允许未经身份验证的攻击者通过建立到域控制器的脆弱Netlogon安全通道连接来提升权限，最终获取域管理员权限。漏洞的根源在于Netlogon协议在身份验证过程中使用了存在缺陷的加密算法（AES-CFB8）。攻击者可以利用该漏洞将域控制器的机器帐户密码重置为空，从而完全控制域。提供的漏洞利用代码 `zerologon_tester.py`  使用 Impacket 库尝试执行 Netlogon 身份验证绕过。如果成功绕过，脚本将立即终止。如果域控制器已修补，脚本会在发送 2000 对 RPC 调用后放弃，并认为目标不易受攻击。Dockerfile 用于构建包含所需依赖项（包括 Impacket）的 Alpine Linux 容器，从而简化漏洞利用脚本的部署和执行。requirements.txt 文件指定了脚本的依赖项，例如 `impacket==0.9.23`。LICENSE文件是MIT许可证,表明代码是开源的。通过分析提供的 Dockerfile，requirements.txt，LICENSE，README.md 和 Python 脚本，我发现投毒代码的可能性极低(约1%)。虽然始终存在人为引入恶意代码的可能性，但是该代码库的结构和内容表明其主要目的是为了验证漏洞是否存在。

**项目地址:** [TheJoyOfHacking/SecuraBV-CVE-2020-1472](https://github.com/TheJoyOfHacking/SecuraBV-CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)