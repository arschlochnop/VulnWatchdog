## CVE-2025-6018-SUSE-PAM-LPE

**漏洞编号:** CVE-2025-6018

**漏洞类型:** 本地提权(LPE)

**影响应用:** SUSE Linux (pam-config, udisks2, libblockdev)

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** openSUSE Leap 15, SUSE Linux Enterprise

**利用条件:** 需要本地用户权限，udisks2服务运行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据搜索结果，CVE-2025-6018是一个Linux PAM配置中的本地提权漏洞，影响SUSE Linux发行版。它与CVE-2025-6019结合使用可形成漏洞利用链，最终获得root权限。Qualys的研究表明，该漏洞与libblockdev和udisks相关。POC代码的`attacker.sh`脚本生成一个SUID-root的shell，创建XFS镜像，并将该shell嵌入到镜像中，然后通过Python的HTTP服务器托管该镜像。`victem.sh`脚本通过设置环境变量来欺骗Polkit会话，然后下载攻击者托管的镜像。脚本使用udisksctl挂载该镜像，并执行镜像中的SUID-root shell。这个过程利用了udisks2在处理挂载点时的权限验证问题。该利用方式依赖于udisks2允许已经通过身份验证的用户挂载镜像，从而执行SUID程序。

**有效性：**提供的POC代码看起来是有效的。它通过生成SUID root shell，并结合udisks的挂载功能，达到了本地提权的目的。

**投毒风险：**我对提供的POC代码进行了分析，没有发现明显的投毒代码。脚本的功能清晰，旨在利用CVE-2025-6018漏洞进行提权，没有植入恶意后门或执行其他有害操作。因此，投毒风险较低，估计为0%。

**利用方式：**
1.  攻击者使用`attacker.sh`脚本生成包含SUID root shell的XFS镜像，并将其托管在HTTP服务器上。
2.  受害者机器运行`victem.sh`脚本。
3.  `victem.sh`脚本首先设置环境变量，模拟Polkit会话。
4.  脚本下载攻击者托管的XFS镜像。
5.  脚本使用udisksctl以允许活动的（allow_active）用户身份挂载该镜像。
6.  由于udisksctl的权限验证问题，允许非特权用户挂载包含SUID root shell的镜像。
7.  脚本执行挂载镜像中的SUID root shell，从而获得root权限。

**项目地址:** [iamgithubber/CVE-2025-6018-19-exploit](https://github.com/iamgithubber/CVE-2025-6018-19-exploit)

**漏洞详情:** [CVE-2025-6018](https://nvd.nist.gov/vuln/detail/CVE-2025-6018)