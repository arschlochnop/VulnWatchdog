## CVE-2020-16898 "Bad Neighbor" Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP Stack

**危害等级:** 高危，允许远程代码执行

**影响版本:** 受影响的Windows版本包括 Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004 以及 Windows Server 2019, version 1903, version 2004

**利用条件:** 攻击者需要能够发送特制的ICMPv6 Router Advertisement数据包到目标Windows计算机。目标系统需要启用IPv6 RDNSS。

**POC 可用性:** 是，但提供的代码仅为检测脚本

**投毒风险:** 0%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是一个存在于Windows TCP/IP栈中的远程代码执行漏洞。此漏洞是由于Windows TCP/IP栈未能正确处理ICMPv6 Router Advertisement数据包中的Option Type 25字段造成的。攻击者可以发送特制的ICMPv6 Router Advertisement数据包来触发此漏洞，从而在目标系统上执行任意代码。

**漏洞利用方式：**

1.  攻击者需要构造恶意的ICMPv6 Router Advertisement数据包，该数据包的Option Type 25字段包含畸形或过长的数据。
2.  攻击者将构造的数据包发送到目标Windows系统。
3.  目标系统在处理该数据包时，TCP/IP栈会发生错误，导致缓冲区溢出或内存损坏。
4.  攻击者可以利用此漏洞执行任意代码。

**提供的POC代码分析：**

提供的PowerShell脚本 `CVE-2020-16898_Checker.ps1` 并不是一个漏洞利用代码，而是一个检测脚本，用于检查目标系统的网络接口是否容易受到CVE-2020-16898和CVE-2020-16899的影响。它通过检查网络接口的配置，特别是IPv6 6106选项是否启用，来判断接口是否存在漏洞。该脚本本身不包含任何恶意代码，因此不存在投毒风险。

**投毒风险评估：**

根据对提供的POC代码的分析，未发现任何恶意或隐藏的代码，因此投毒风险为0%。该脚本仅用于检测漏洞的存在，而不是利用漏洞。

**项目地址:** [CPO-EH/CVE-2020-16898_Checker](https://github.com/CPO-EH/CVE-2020-16898_Checker)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)