## CVE-2025-47812 - Wing FTP Server 远程代码执行

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行

**影响应用:** Wing FTP Server

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** < 7.4.4

**利用条件:** 需要网络访问，目标服务器运行存在漏洞的Wing FTP Server版本，且web管理界面开启

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-47812 是 Wing FTP Server 7.4.4 之前版本中存在的一个远程代码执行漏洞。该漏洞源于程序未正确处理用户和管理 web 界面中的 null 字节（`\0`），允许攻击者将任意 Lua 代码注入到用户会话文件中。由于 FTP 服务通常以 root 或 SYSTEM 权限运行，因此攻击者可以利用此漏洞执行任意系统命令，从而完全控制服务器。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞已被公开披露并被积极利用。提供的Nuclei模板PoC，通过检测web管理页面返回的Wing FTP Server版本号，判断是否存在漏洞。因此，提供的PoC代码是有效的，可以用来检测目标服务器是否存在漏洞。

**投毒风险分析：**

提供的代码主要包括两个文件：README.md 和 template.yaml。README.md 包含漏洞描述、利用方法和免责声明，template.yaml 是 Nuclei 模板，用于检测漏洞。该模板仅仅通过 GET 请求 `/login.html?lang=english` 页面，并从中提取版本号，然后与 7.4.4 进行比较，判断是否存在漏洞。从漏洞利用代码来看，没有发现任何潜在的后门或恶意代码。风险较低。
因此，评估投毒风险为1%。

**利用方式：**

1.  **Null 字节注入：** 攻击者通过构造包含 null 字节的恶意输入，绕过 Wing FTP Server 对用户会话数据的安全检查。
2.  **Lua 代码注入：** 成功绕过安全检查后，攻击者可以将恶意的 Lua 代码注入到用户会话文件中。
3.  **远程代码执行：** 当服务器加载并执行包含恶意 Lua 代码的用户会话文件时，攻击者即可在服务器上执行任意系统命令，获取服务器的控制权。

该漏洞可以利用匿名 FTP 账户进行攻击，进一步降低了攻击难度。

**项目地址:** [rxerium/CVE-2025-47812](https://github.com/rxerium/CVE-2025-47812)

**漏洞详情:** [CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)