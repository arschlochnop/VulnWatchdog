## CVE-2020-14882-Oracle WebLogic Server-远程代码执行

**漏洞编号:** CVE-2020-14882

**漏洞类型:** 远程代码执行

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0

**利用条件:** 需要网络访问WebLogic Server的console控制台，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-14882是Oracle WebLogic Server控制台中存在的一个未经身份验证的远程代码执行漏洞。攻击者可以通过构造特殊的HTTP请求，利用`console.portal`绕过身份验证，并利用`com.tangosol.coherence.mvel2.sh.ShellSession`或`com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext`等类执行任意代码。 

**有效性分析：**
提供的POC代码包含两种利用方式 (method1, method2)：
*   `method1` 使用`com.tangosol.coherence.mvel2.sh.ShellSession`执行任意命令，命令通过HTTP头`cmd`传递。
*   `method2` 使用`com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext`加载远程XML配置，触发远程代码执行。该方法需要一个HTTP服务器来提供XML文件。

根据漏洞描述和搜索结果，该漏洞利用代码有效，可以实现远程代码执行。

**投毒风险分析：**
代码本身主要功能是漏洞利用，没有发现明显的恶意行为。 但是，存在以下潜在风险：
1.  `method2` 使用远程XML配置，如果攻击者控制了XML服务器，可以植入恶意代码，但这不是代码本身投毒，是XML服务器的风险。
2.  POC代码为了方便利用，可能会直接执行命令，存在被恶意利用的风险，但这不是POC代码的投毒。

因此，该POC代码本身的投毒风险很低，判断为 1%。

**利用方式：**

1.  **确定目标WebLogic Server版本：** 访问`/console/login/LoginForm.jsp`页面，查看页面源代码或HTTP响应头，获取WebLogic Server的版本信息。
2.  **选择合适的利用方式：** 根据目标WebLogic Server版本选择合适的利用方式，通常`method1`通用性更高，但某些版本可能需要`method2`。
3.  **执行任意命令 (method1)：**
    *   设置`cmd` HTTP头为要执行的命令。
    *   向`/console/css/%252e%252e%252fconsole.portal`发送POST请求，数据为：`_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession(...)` (参见POC代码)。
4.  **利用远程XML配置 (method2)：**
    *   搭建一个HTTP服务器，提供包含恶意代码的XML配置文件 (例如，使用`java.lang.ProcessBuilder`执行命令)。
    *   修改POC代码中的`listeningIP`变量为HTTP服务器的IP地址。
    *   向`/console/css/%252e%252e%252fconsole.portal`发送POST请求，数据为：`_nfpb=true&_pageLabel=&handle=com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext(...)` (参见POC代码)。

**项目地址:** [milo2012/CVE-2020-14882](https://github.com/milo2012/CVE-2020-14882)

**漏洞详情:** [CVE-2020-14882](https://nvd.nist.gov/vuln/detail/CVE-2020-14882)