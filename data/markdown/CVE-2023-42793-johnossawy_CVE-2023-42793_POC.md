## CVE-2023-42793-JetBrains TeamCity-认证绕过RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 认证绕过导致远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** < 2023.05.4

**利用条件:** 目标TeamCity服务器开启且可网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-42793是JetBrains TeamCity中的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证并执行远程代码。该漏洞影响2023.05.4之前的版本。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞是有效的，并且已被广泛利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果中多个安全厂商的博客也证实了该漏洞的有效性。

**投毒风险：**
提供的PoC代码本身的功能是利用漏洞创建新的管理员用户。`README.md`文件描述了脚本的功能，与代码行为一致。代码中对创建的用户名称添加了随机数，并会写入 `vulnerable.txt` 文件。 `vulnerable.txt`文件可能存在信息泄露的风险,如果被攻击者获取，可能结合其他漏洞使用。总体来看，该PoC代码存在投毒风险的可能性较低，约为10%。

**利用方式：**
1.  **删除用户令牌：** PoC首先尝试删除ID为1的用户令牌 (通常是管理员)。
2.  **创建用户令牌：** 如果删除成功或不存在，PoC会尝试为ID为1的用户创建一个新的用户令牌。
3.  **创建管理员用户：** 使用新创建的用户令牌，PoC会创建一个具有`SYSTEM_ADMIN`权限的新用户，用户名和密码是硬编码的（用户名以 `_secops` 开头，加上随机数，密码是 `changeme`）。
4.  **利用新用户登录：** 攻击者可以使用新创建的管理员帐户登录TeamCity服务器，从而完全控制该服务器。
5.  **自动化攻击:** 通过-u指定url或者-l指定url列表，实现批量攻击。

**项目地址:** [johnossawy/CVE-2023-42793_POC](https://github.com/johnossawy/CVE-2023-42793_POC)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)