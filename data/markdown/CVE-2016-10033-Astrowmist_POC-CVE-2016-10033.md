## CVE-2016-10033 - PHPMailer Remote Code Execution

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，且可以通过Web应用程序（如联系表单）发送邮件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，攻击者可以通过构造恶意的Sender属性，在邮件命令中注入额外的参数，从而执行任意代码。利用方式是：

1.  **漏洞原理：** PHPMailer 在使用 isMail 传输方式时，没有正确地过滤 Sender 属性，导致攻击者可以注入额外的参数到 mail 命令。
2.  **攻击方式：** 攻击者通过修改 Sender 属性，添加 `-X/tmp/shell.php` 这样的参数，将恶意代码写入到 /tmp/shell.php 文件中。然后，通过访问该文件，即可执行恶意代码。
3.  **POC 代码分析：** 提供的 POC 代码 `PwnScriptum_RCE_exploit-MODIFIED.py` 旨在利用此漏洞以及其他 PHPMailer/SwiftMailer/Zend-mail 相关的漏洞，通过 Web 应用程序的联系表单发送恶意邮件，从而在目标服务器上执行反向 Shell。

**有效性：**
根据漏洞信息和搜索结果，提供的 POC 代码是有效的，可以利用 CVE-2016-10033 漏洞执行远程代码。

**投毒风险：**
POC代码存在一定的投毒风险，因为攻击者可以在反向Shell中插入恶意代码，用于进一步攻击或控制目标系统。代码中存在从外部获取IP和端口的行为，这些IP和端口可能会被攻击者用于恶意目的。此外，该POC可能还会尝试利用其他邮件库的漏洞，扩大攻击范围。虽然此POC的主要功能是利用漏洞，但作者有可能隐藏了其他恶意功能，因此风险评级为 10%。

**利用方式：**
1.  确定目标 Web 应用程序使用了存在漏洞的 PHPMailer 版本（< 5.2.18）。
2.  找到 Web 应用程序中使用了 PHPMailer 发送邮件的功能，例如联系表单。
3.  使用 POC 代码，构造包含恶意 Sender 属性的请求，发送到联系表单。
4.  如果漏洞利用成功，攻击者将在目标服务器上获得一个反向 Shell，从而可以执行任意命令。

**项目地址:** [Astrowmist/POC-CVE-2016-10033](https://github.com/Astrowmist/POC-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)