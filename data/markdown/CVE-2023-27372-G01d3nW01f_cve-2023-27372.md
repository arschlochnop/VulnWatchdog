## CVE-2023-27372 - SPIP Remote Code Execution

**漏洞编号:** CVE-2023-27372

**漏洞类型:** Remote Code Execution

**影响应用:** SPIP

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 4.2.1

**利用条件:** SPIP 实例需要可公开访问，并且运行在受影响的版本上

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27372 是 SPIP CMS 中的一个远程代码执行漏洞，源于对反序列化数据处理不当。攻击者可以利用此漏洞通过在公共区域的表单值中注入恶意序列化数据来执行任意代码。

**有效性分析：**
提供的 exploit.py 脚本利用了此漏洞。它首先从目标 URL 的 `/spip/spip.php?page=spip_pass` 获取 `formulaire_action_args` 参数。然后，它构造一个包含恶意 PHP 代码的 POST 请求，该代码使用 `system()` 函数执行攻击者提供的命令。该恶意 PHP 代码被序列化并作为 `oubli` 参数传递。脚本的成功执行表明漏洞是可利用的。

**投毒风险分析：**
查看 exploit.py 脚本，其主要功能是利用 CVE-2023-27372 漏洞实现远程代码执行。脚本首先获取目标 URL，然后构造恶意 payload 并发送 POST 请求。脚本本身没有明显的恶意行为，如植入后门或传播恶意软件。
但是，该脚本本身依赖于用户提供的命令来执行 RCE。如果用户不小心执行了包含恶意命令的脚本，可能会导致目标系统受到损害。
在 readme.md 文件中，声明了 “education purpose only!!!!!”，降低了投毒的可能性。
仓库中，可能存在投毒代码的风险较低，约为 10%。

**利用方式：**
1.  攻击者向 SPIP 站点的 `/spip/spip.php?page=spip_pass` 发送 GET 请求。
2.  攻击者解析响应，提取 `formulaire_action_args` 参数。
3.  攻击者构造一个 POST 请求，将 `formulaire_action` 设置为 `oubli`，`formulaire_action_args` 设置为提取的值，并将恶意 PHP 代码序列化后作为 `oubli` 参数的值发送。
4.  SPIP 在处理 POST 请求时，反序列化 `oubli` 参数的值，导致恶意 PHP 代码被执行，从而实现远程代码执行。

**项目地址:** [G01d3nW01f/cve-2023-27372](https://github.com/G01d3nW01f/cve-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)