## CVE-2020-13942 Apache Unomi Remote Code Execution

**漏洞编号:** CVE-2020-13942

**漏洞类型:** Remote Code Execution

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 目标服务器运行Apache Unomi，且版本低于1.5.2，需要能够访问/context.json endpoint。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 是 Apache Unomi 中存在的一个远程代码执行漏洞。攻击者可以通过向 /context.json 端点注入恶意的 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**

提供的POC代码 `UnomiExp.py` 看起来有效。它利用了OGNL表达式注入漏洞，允许攻击者执行系统命令或反弹shell。代码通过构造包含恶意 OGNL 表达式的 JSON 数据，并将其发送到 `/context.json` 端点来实现 RCE。

**投毒风险：**

分析提供的 `UnomiExp.py` 脚本和 `README.md` 文件，没有发现明显的投毒代码。脚本的功能集中在利用漏洞执行命令或反弹 shell 上，没有额外的恶意行为。图片文件路径仅为相对路径，没有引用外部链接，因此判断投毒风险为 0%。

**利用方式：**

1.  **确定目标：** 找到运行 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **构造Payload：**  使用提供的脚本 `UnomiExp.py`，指定目标 URL 和要执行的命令。命令可以使用常规命令，也可以是编码后的反弹 shell 命令。
3.  **发送请求：**  脚本会将构造好的包含恶意 OGNL 表达式的 JSON 数据发送到目标服务器的 `/context.json` 端点。
4.  **执行命令：**  目标服务器在处理请求时，会执行 OGNL 表达式，从而执行攻击者指定的命令。
5.  **获取结果：** 如果执行的是系统命令，结果会显示在响应中。如果是反弹 shell，则攻击者可以在监听端口上接收 shell 连接。

**项目地址:** [yaunsky/Unomi-CVE-2020-13942](https://github.com/yaunsky/Unomi-CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)