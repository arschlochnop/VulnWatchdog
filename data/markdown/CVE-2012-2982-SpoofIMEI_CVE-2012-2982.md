## CVE-2012-2982 - Webmin file/show.cgi 命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.590

**利用条件:** 需要Webmin后台的已认证用户权限，目标系统运行Webmin且版本低于或等于1.590，存在/file/show.cgi文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2012-2982漏洞存在于Webmin 1.590及更早版本的file/show.cgi中。该漏洞允许远程认证用户通过在路径名中使用无效字符（如 | 管道符）执行任意命令。

**有效性:**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经有公开的Metasploit模块和Python POC脚本可用。提供的Python POC代码尝试利用此漏洞，通过在/file/show.cgi的路径中注入管道符`|`来执行任意命令。

**投毒风险:**
分析提供的webmin.py脚本，该脚本首先尝试使用提供的用户名和密码登录Webmin。成功登录后，它会构造一个包含管道符的URL，并将命令注入到/file/show.cgi的路径中。该脚本本身没有明显的投毒代码，除了MYIP和PORT需要用户修改外。但理论上存在微小的投毒风险，比如：
1.  **依赖库:**  `requests`库本身是否存在安全问题。
2.  **代码逻辑缺陷:** 脚本本身的错误可能导致利用失败甚至对目标系统造成其他影响，虽然不属于恶意投毒，但也是风险。
3.  **变量覆盖:**  虽然概率很小，但存在利用逻辑上的不严谨导致变量被覆盖的风险。

所以风险评估较低,但不是完全没有,因此评估为5%。

**利用方式:**
1.  **身份验证:** 首先，攻击者需要具有Webmin后台的有效用户名和密码。
2.  **登录:** 使用用户名和密码通过/session_login.cgi登录Webmin。
3.  **构造Payload:** 构造包含恶意命令的URL，例如`/file/show.cgi/bin/<random_string>|<command>|`。这里的`<command>`是要执行的命令，利用管道符`|`将命令注入到路径中。
4.  **发送请求:**  向构造的URL发送POST请求，利用/file/show.cgi的漏洞执行命令。
5.  **反弹shell:** poc中利用反弹shell的方式，将执行结果反弹回攻击者的机器。

**项目地址:** [SpoofIMEI/CVE-2012-2982](https://github.com/SpoofIMEI/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)