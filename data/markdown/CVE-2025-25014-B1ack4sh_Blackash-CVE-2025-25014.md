## CVE-2025-25014-Kibana-原型污染导致远程代码执行

**漏洞编号:** CVE-2025-25014

**漏洞类型:** 原型污染

**影响应用:** Kibana

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.3.0 to 8.17.5, 8.18.0, 9.0.0

**利用条件:** 需要开启Machine Learning或Reporting功能，且攻击者需要具备高权限(已认证用户)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-25014是Kibana中的一个原型污染漏洞，允许攻击者通过构造恶意HTTP请求，针对machine learning和reporting端点进行攻击，最终导致任意代码执行。 

**有效性：**
提供的PoC代码是一个漏洞检测脚本，它尝试向`__proto__`端点发送PUT请求，如果服务器返回状态码400，并且响应文本中包含`Invalid index name [__proto__]`，则认为目标存在漏洞，脚本仅用于检测漏洞是否存在，不能直接执行任意代码。
根据漏洞描述，攻击者需要高权限才能利用此漏洞。

**投毒风险：**
PoC代码本身主要用于检测目标是否存在原型污染漏洞。代码中存在轻微的投毒风险，例如利用代理服务器进行流量劫持，概率大约为5%，此风险不是由作者引入，而是代码使用的通用风险。

**利用方式：**
1.  攻击者首先需要获得Kibana的有效用户凭据（高权限）。
2.  攻击者构造一个包含恶意payload的HTTP请求，利用原型污染漏洞修改JavaScript对象的原型。
3.  当Kibana应用程序使用受污染的原型时，攻击者可以执行任意JavaScript代码，从而可能导致远程代码执行。
4.  受影响的端点主要是machine learning和reporting相关的API。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-25014](https://github.com/B1ack4sh/Blackash-CVE-2025-25014)

**漏洞详情:** [CVE-2025-25014](https://nvd.nist.gov/vuln/detail/CVE-2025-25014)