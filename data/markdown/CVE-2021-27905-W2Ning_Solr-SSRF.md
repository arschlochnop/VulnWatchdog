## CVE-2021-27905-Apache Solr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器敏感信息泄露，内网探测，甚至远程代码执行（结合其他漏洞）

**影响版本:** < 8.8.2

**利用条件:** Solr实例暴露在公网上，并且目标版本小于8.8.2

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-27905是Apache Solr中的一个SSRF漏洞，存在于ReplicationHandler中。攻击者可以通过`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，Solr服务器会向该URL发起请求，从而导致SSRF。提供的POC利用了这一点，首先通过`/solr/admin/cores`接口获取core名称，然后利用`/solr/{core}/config`接口设置`requestDispatcher.requestParsers.enableRemoteStreaming`为true，最后调用`/solr/{core}/debug/dump`去dump一些配置信息，虽然这些操作本身不一定是高危操作，但开了`enableRemoteStreaming`这个口子，可能会结合其他利用方式，比如远程配置文件加载，达成RCE. 仓库中存在的投毒风险较低，主要风险在于该POC本身可能被滥用，攻击未授权的Solr实例。但是，Xray的检测插件代码本身并没有发现明显的恶意行为，只是一些配置的修改。

**项目地址:** [W2Ning/Solr-SSRF](https://github.com/W2Ning/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)