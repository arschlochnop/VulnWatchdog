## CVE-2025-30065 Apache Parquet 反序列化RCE

**漏洞编号:** CVE-2025-30065

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Apache Parquet Java (parquet-avro)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.15.0

**利用条件:** 需要能够向系统提供恶意的Parquet文件，并被目标系统使用Apache Parquet Java库读取。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-30065是Apache Parquet Java的parquet-avro模块中存在的一个反序列化漏洞。攻击者可以构造一个包含恶意Avro schema的Parquet文件，当目标系统使用受影响版本的Apache Parquet Java库读取该文件时，会触发反序列化漏洞，导致任意代码执行。

**漏洞利用方式：**
1.  攻击者创建一个恶意的Parquet文件，该文件包含一个特制的Avro schema。这个schema包含一个可被利用的类的引用，如`javax.swing.JEditorPane`，利用其副作用。
2.  `ParquetExploitGenerator.java` 用于生成包含恶意schema的Parquet文件，它创建一个名为`exploit-jeditorpane.parquet`的文件。
3.  `ParquetVictim.java` 模拟受害者系统，它读取恶意的Parquet文件。在读取过程中，Avro schema会被解析，导致`javax.swing.JEditorPane`类的实例化，从而触发漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用是有效的。POC代码能够生成包含恶意schema的Parquet文件，并在读取该文件时触发代码执行。搜索引擎结果中多个来源也证实了该漏洞的存在和严重性，以及POC的可用性。

**投毒风险评估：**
虽然总体来说，提供的代码看起来像是合法的漏洞利用代码，但仍然存在一些潜在的投毒风险。`PayloadRecord.java`尝试根据操作系统执行不同的命令，对于Linux系统，它会尝试通过`curl`向`attacker.example.com`发送包含主机名的请求，这本身可以被认为是payload的一部分。不过，由于目标非常明显，而且代码也相对简单，隐藏更隐蔽的恶意代码比较困难。

对`PayloadRecord.java`文件分析发现，如果系统为Linux或Unix，恶意代码会尝试使用`curl`命令向`http://attacker.example.com/ping?host=`发送受害主机的hostname。这段代码的目的是为了进行漏洞验证和主机探测，但同时也可能被用于恶意目的。其他的投毒风险可能存在于不明显的代码混淆或依赖项中，但就提供的代码而言，投毒风险较低，估计约为5%。绝大多数代码功能明确，用于漏洞演示。

请注意，为了完全排除投毒的可能性，应该对代码进行全面的安全审计，包括检查所有依赖项和执行代码的行为。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-30065](https://github.com/B1ack4sh/Blackash-CVE-2025-30065)

**漏洞详情:** [CVE-2025-30065](https://nvd.nist.gov/vuln/detail/CVE-2025-30065)