## CVE-2024-27388-Linux Kernel-SUNRPC内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel

**危害等级:** 中危，可能导致系统性能下降或拒绝服务

**影响版本:** 3.10 <= version < 4.19.311, 3.10 <= version < 5.4.273, 3.10 <= version < 5.10.214, 3.10 <= version < 5.15.153, 3.10 <= version < 6.1.83, 3.10 <= version < 6.6.23, 3.10 <= version < 6.7.11, 3.10 <= version < 6.8.2, 3.10 <= version < 6.9

**利用条件:** 需要触发SUNRPC GSSAPI代码路径，需要网络访问以及可利用的SUNRPC服务配置

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-27388 存在于Linux内核的SUNRPC模块的`gssx_dec_option_array`函数中。该漏洞是由于在错误处理路径中缺少对已分配的`creds`和`oa->data`的释放导致的内存泄漏。 

**利用方式：**

攻击者可以通过构造恶意的RPC请求，触发`gssx_dec_option_array`函数中的内存泄漏代码路径，导致内核内存泄漏。通过持续发送恶意请求，攻击者可以耗尽系统资源，导致系统性能下降甚至拒绝服务。

**有效性：**

提供的POC代码是来自kernel源码中的片段，展示了存在内存泄漏的`gssx_dec_option_array`函数。虽然给出的代码片段本身不是一个完整的可执行的利用程序，但它证实了漏洞描述中提到的内存泄漏点，可以作为开发完整利用程序的基础。

**投毒风险：**

提供的POC代码片段直接来自受影响的源代码文件，主要用于展示漏洞点。 代码片段本身不太可能包含任何故意的恶意或后门代码。由于只是一个修复漏洞之前的代码，风险极低。

基于以上分析，该代码库中存在投毒代码的可能性极低，判断存在投毒代码的可能性约为 1%。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterPatch](https://github.com/Mahesh-970/CVE-2024-27388_afterPatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)