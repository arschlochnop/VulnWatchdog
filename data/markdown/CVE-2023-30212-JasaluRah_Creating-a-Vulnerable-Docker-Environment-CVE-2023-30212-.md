## CVE-2023-30212-OURPHP-反射型XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型XSS

**影响应用:** OURPHP

**危害等级:** 中危，可能导致cookie窃取、页面重定向等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212是OURPHP <= 7.2.0版本中存在的一个反射型跨站脚本漏洞（XSS）。漏洞位于`/client/manage/ourphp_out.php` 文件。攻击者可以通过构造包含恶意JavaScript代码的URL，诱使用户点击，从而在用户浏览器中执行恶意脚本，例如窃取用户的cookie或将用户重定向到恶意网站。

**利用方式：**

1.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=<script>alert("xss")</script>`。
2.  攻击者通过电子邮件、社交媒体或其他方式将此URL发送给受害者。
3.  如果受害者点击此URL，恶意JavaScript代码将在受害者浏览器中执行。

**有效性评估：**

根据提供的漏洞信息、搜索结果以及漏洞利用代码，可以判断此漏洞利用代码有效。README.md 文件中提供了验证漏洞的URL示例，经验证可以触发XSS。

**投毒风险分析：**

提供的代码包括 Dockerfile、README.md、init.sql、my.cnf 以及 file/admin.php。Dockerfile 用于构建包含漏洞OURPHP 7.2.0 版本的Docker镜像，用于漏洞演示和测试。init.sql 初始化数据库用户密码,便于测试。 admin.php文件是OURPHP 的管理后台登录入口。这些文件本身是为了方便漏洞复现，但存在一定的投毒风险。

*   **风险点：** Dockerfile 中安装了 MySQL 并允许远程连接，如果配置不当，可能被恶意利用。
*   **评估：**  总体风险较低，因为提供的代码主要是用于搭建漏洞环境，恶意代码不太可能直接隐藏在这些文件中。`file/admin.php`内容看起来像是CMS正常的代码. 虽然不太可能存在后门，但始终需要人工审计以确保。

**投毒风险：10%**。风险主要在于环境配置的安全性，而非代码本身携带恶意payload。

**搜索引擎结果：**
搜索引擎结果验证了漏洞的存在，并提供了相关的漏洞信息和POC链接。

**项目地址:** [JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-](https://github.com/JasaluRah/Creating-a-Vulnerable-Docker-Environment-CVE-2023-30212-)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)