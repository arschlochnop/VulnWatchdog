## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Config Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 身份验证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备位于网络上且可访问,并且运行受影响的固件版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于多个Hikvision IP摄像头型号中，是一个身份验证绕过漏洞。攻击者可以利用该漏洞，通过构造特定的URL（例如`/System/configurationFile?auth=YWRtaW46MTEK`）来下载摄像头的配置文件。这个配置文件包含加密的用户信息。提供的Python脚本`decrypt_configurationFile.py`旨在解密下载的配置文件。脚本首先使用AES算法（ECB模式）和一个硬编码的密钥`279977f62f6cfd2d91cd75b889ce0c9a`来解密配置文件内容，然后使用一个简单的异或操作进行进一步解密。最后，它提取解密后的字符串。虽然核心的解密逻辑看似合理，但存在一些潜在的风险。脚本中硬编码了解密密钥，这使得攻击者可以轻松解密任何通过该漏洞获取的配置文件。投毒风险较低，因为脚本主要功能是解密，但依赖于固定的密钥和算法，如果密钥被替换，则可能被用来收集解密信息或进行其他恶意活动。`strings` 函数在提取字符串时，采用了一个相当宽泛的字符集，这可能导致提取出一些不必要的或潜在的恶意数据。 漏洞利用方式是首先利用未经身份验证的配置下载漏洞，然后使用提供的脚本解密配置文件。尽管如此，该脚本的作者可能通过更改 `strings` 函数来匹配特定格式或者使用不同编码来影响解密结果。

**项目地址:** [lastvocher/Hikvision-CVE-2017-7921-decryptor](https://github.com/lastvocher/Hikvision-CVE-2017-7921-decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)