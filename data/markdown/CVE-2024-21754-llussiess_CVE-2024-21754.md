## CVE-2024-21754

**漏洞编号:** CVE-2024-21754

**漏洞类型:** 密码哈希算法强度不足

**影响应用:** FortiOS/FortiProxy

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** FortiOS: <= 7.4.3, 7.2所有版本, 7.0所有版本, 6.4所有版本; FortiProxy: <= 7.4.2, 7.2所有版本, 7.0所有版本, 2.0所有版本

**利用条件:** 需要超级管理员权限和CLI访问

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2024-21754漏洞是由于FortiOS和FortiProxy使用的密码哈希算法强度不足导致的。攻击者如果拥有超级管理员权限和CLI访问权限，则可以利用此漏洞通过破解备份文件中的密码哈希值来获取敏感信息，例如配置信息和凭据。PoC代码利用了这一弱点，尝试自动化解密过程。然而，PoC代码中给出的下载链接（https://bit.ly/3G7Ec3d）存在潜在风险，因为这是一个短链接，无法直接确定其指向的目标。因此，存在该链接被投毒，指向恶意文件或钓鱼网站的风险。此外，代码仓库的其他图片链接也存在风险，由于缺乏上下文，不能保证下载内容的安全。因此，下载和运行此PoC代码具有较高的投毒风险。漏洞的利用方式是首先获得目标系统的备份文件，然后使用PoC代码尝试破解其中的密码哈希值，从而获取敏感信息。

**项目地址:** [llussiess/CVE-2024-21754](https://github.com/llussiess/CVE-2024-21754)

**漏洞详情:** [CVE-2024-21754](https://nvd.nist.gov/vuln/detail/CVE-2024-21754)