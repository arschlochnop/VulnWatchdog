## CVE-2024-38063-Windows TCP/IP远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码。

**影响版本:** 受影响的Windows版本包括Windows 10, Windows 11, Windows Server 2008至2022等，具体版本范围参见CVE描述。

**利用条件:** 目标系统需要启用IPv6。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38063是一个Windows TCP/IP远程代码执行漏洞，影响多个Windows版本。攻击者可以通过发送特制的IPv6数据包利用此漏洞在目标系统上执行任意代码。漏洞源于TCP/IP协议栈处理IPv6分片数据包时存在的整数下溢漏洞。 

**有效性评估：**

根据提供的漏洞信息和搜索结果，CVE-2024-38063漏洞是一个关键级别的远程代码执行漏洞，CVSS评分为9.8。搜索结果表明已经有公开的PoC代码。

提供的Python脚本（`Cve-2024-37063-poc.py`， `Cve-2024-38063-rce.py`， `Cve-rce2.py`）使用Scapy库来构造和发送特制的IPv6数据包。这些数据包包含IPv6扩展头和分片，旨在触发目标系统上的漏洞，从而导致内存损坏或远程代码执行。脚本的关键参数包括目标IP地址、MAC地址（如果需要）、网络接口，以及数据包发送的次数。
`Cve-2024-37063-poc.py` 脚本的名称存在错误，应该是CVE-2024-38063，根据代码分析此脚本利用IPv6分片和扩展头进行攻击，有一定概率导致内存损坏。`Cve-2024-38063-rce.py` 脚本修改了 `Cve-2024-37063-poc.py` 脚本，加入了shellcode，旨在于触发漏洞后执行预设的shellcode，实现远程代码执行。`Cve-rce2.py` 代码片段不完整，无法分析。

总体来看，提供的PoC代码具备一定的有效性，但成功利用可能取决于目标系统的配置和缓解措施。

**投毒风险分析：**

仔细检查提供的PoC代码，没有发现明显的恶意代码或后门。所有脚本都专注于构造和发送特定的网络数据包。`Cve-2024-38063-rce.py` 脚本中虽然包含shellcode，但是shellcode是由使用者提供的，不是代码作者预先设定的恶意代码。但仍然存在一定的投毒风险，例如：

1.  **隐蔽的参数修改：** 攻击者可能会修改脚本中的默认参数，例如增加数据包发送次数，以增加目标系统的负担或导致拒绝服务。
2.  **依赖项风险：** 脚本依赖于Scapy库，如果Scapy库本身被篡改，可能会引入恶意代码。
3.  **Shellcode风险:** 虽然`Cve-2024-38063-rce.py` 脚本中的shellcode 由用户提供，但是使用者可能并不了解shellcode的具体功能，从而执行了恶意的操作。

综合评估，投毒风险较低，约为5%。风险主要来自于使用者对shellcode的不了解，和运行环境的安全性。

**利用方式：**

1.  **环境配置：** 攻击者需要配置攻击环境，包括安装Scapy库，并根据目标系统设置目标IP地址、MAC地址（如果需要）和网络接口。
2.  **数据包构造：** 攻击者使用Scapy库构造包含IPv6扩展头和分片的数据包。这些数据包的特定字段被设置为触发目标系统上的漏洞。
3.  **数据包发送：** 攻击者将构造的数据包发送到目标系统。如果漏洞利用成功，目标系统可能会崩溃、或执行攻击者预设的shellcode。
4.  **远程代码执行（可选）：** 如果攻击者在数据包中嵌入了shellcode，成功利用漏洞后，shellcode将在目标系统上执行，从而实现远程代码执行。

总而言之，该漏洞利用方式涉及到构造恶意的IPv6数据包，并发送到目标系统以触发漏洞，从而实现远程代码执行。

**项目地址:** [brownpanda29/Cve-2024-38063](https://github.com/brownpanda29/Cve-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)