## CVE-2025-26240-pdfkit-SSRF/LFI

**漏洞编号:** CVE-2025-26240

**漏洞类型:** SSRF/LFI

**影响应用:** pdfkit

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 未明确指定，但可能影响使用了from_string方法的pdfkit版本

**利用条件:** 需要目标系统安装了存在漏洞的pdfkit库，并且允许通过from_string方法解析恶意HTML内容

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-26240 漏洞存在于 pdfkit 库的 from_string 方法中。根据提供的 POC 代码，攻击者可以构造包含特定 meta 标签的 HTML 内容，利用 pdfkit 将 HTML 转换为 PDF 的过程中执行 SSRF (Server-Side Request Forgery) 或 LFI (Local File Inclusion) 攻击。

**有效性：**
POC 代码提供了 SSRF 和 LFI 两种利用方式。SSRF 通过 XMLHttpRequest 发送请求到攻击者控制的服务器，LFI 则通过 pdfkit 的文件访问功能读取本地文件。

**利用方式：**
*   **SSRF：** 攻击者构造包含 JavaScript 代码的 HTML 内容，该代码使用 XMLHttpRequest 向攻击者服务器发送 POST 请求。攻击者可以监控服务器日志，验证 SSRF 是否成功。
*   **LFI：** 攻击者构造包含 `pdfkit---enable-local-file-access` 和 `pdfkit-file--a` meta 标签的 HTML 内容。`pdfkit---enable-local-file-access` 允许访问本地文件，`pdfkit-file--a` 指定要读取的文件。攻击者可以通过 `pdfkit-{attacker_server}?LFI-TEST=--` 间接将读取的文件内容发送到攻击者服务器。攻击者通过服务器端点接收文件内容。

根据搜索结果，CVE-2024-26240是关于Secure Boot Security Feature Bypass Vulnerability (漏洞链接: https://nvd.nist.gov/vuln/detail/cve-2024-26240 和 https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-26240)，这与提供的pdfkit的漏洞利用代码不符。因此，代码描述的漏洞可能是假的，或者POC作者使用了错误的CVE编号。

**投毒风险：**
由于提供的POC代码与搜索结果中的CVE描述不符，存在投毒的风险。攻击者可能故意使用错误的CVE编号来混淆安全研究人员，或者传播包含恶意代码的 POC。 此外，POC本身就包含访问和发送本地文件的逻辑，存在很高的隐私泄露风险。


**项目地址:** [Habuon/CVE-2025-26240](https://github.com/Habuon/CVE-2025-26240)

**漏洞详情:** [CVE-2025-26240](https://nvd.nist.gov/vuln/detail/CVE-2025-26240)