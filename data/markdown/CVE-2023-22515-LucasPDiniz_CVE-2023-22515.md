## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22515是一个存在于Atlassian Confluence Server和Data Center版本中的严重漏洞。未经身份验证的攻击者可以利用此漏洞重新进入Confluence的设置阶段，并创建一个新的管理员帐户，从而完全控制受影响的Confluence实例。

**漏洞利用方式：**

1.  攻击者向目标Confluence服务器发送特制的HTTP请求，该请求包含恶意的URL参数，以重置Confluence的安装状态。具体来说，攻击者访问`server-info.action`端点，并使用链式getter/setter操作将`bootstrapStatusProvider.applicationConfig.setupComplete`设置为`false`。

    ```
    http://<Confluence_URL>/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false
    ```

2.  成功执行此请求后，Confluence服务器将返回到初始设置页面，允许攻击者创建一个新的管理员帐户。
3.  攻击者访问`/setup/setupadministrator-start.action`端点，并按照设置流程创建一个新的管理员账户。
4.  使用新创建的管理员账户登录Confluence实例，并获得完全控制权限。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判断此漏洞的POC代码是有效的。 搜索引擎结果中明确指出存在CVE-2023-22515的公开可用的利用脚本，并且多个安全厂商的文章和CISA的公告都确认了该漏洞的严重性和利用的广泛性。 提供的POC代码的README文件也详细描述了漏洞原理和利用方法。

**投毒风险：**

代码仓库`/tmp/9ac8e2d80e235c23c13ad9b691c524a1/README.md` 仅包含漏洞的描述和利用说明。漏洞本身不需要上传恶意文件，也没有迹象表明作者在利用代码中加入了隐藏的、恶意的功能。但仍需注意，从非官方渠道下载的任何漏洞利用代码都存在一定的风险。 由于只是一个说明文件，没有可以执行的代码。因此，投毒风险较低，大约为10%。 这个风险主要来自下载来源的不确定性，以及将来可能被替换或修改为恶意版本。

**项目地址:** [LucasPDiniz/CVE-2023-22515](https://github.com/LucasPDiniz/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)