## CVE-2024-6387 - OpenSSH regreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 信号处理竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.5p1 <= OpenSSH < 9.8p1

**利用条件:** 默认配置下，未认证的远程攻击者可以通过大量连接尝试触发竞争条件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（又名 regreSSHion）是 OpenSSH 服务器中的一个漏洞，它允许在基于 glibc 的 Linux 系统上进行未经身份验证的远程代码执行。该漏洞源于 OpenSSH 服务器 (sshd) 中的信号处理竞争条件。当客户端在 LoginGraceTime 秒内未通过身份验证时，sshd 的 SIGALRM 处理程序会被异步调用，但此信号处理程序调用各种非异步信号安全函数（例如，syslog()）。

**有效性：**
根据漏洞库信息和搜索引擎结果，已经存在针对该漏洞的POC（Proof of Concept）代码。多个来源表明该漏洞可以被利用实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞解释和相关链接，实际的exp内容需要进一步分析。但从文本内容分析，投毒风险较低，约10%。需要进一步审计完整exp代码才能确定。

**利用方式：**
1.  攻击者发起大量连接尝试，目的是触发信号处理竞争条件。
2.  在身份验证超时（LoginGraceTime）之前不进行身份验证，导致 `SIGALRM` 信号触发。
3.  `SIGALRM` 信号处理程序调用非异步信号安全函数 `syslog()`，导致内存损坏或者其他不稳定状态。
4.  攻击者利用这个不稳定状态，将恶意代码注入到堆中。
5.  成功利用该漏洞可导致以 root 权限执行任意代码。

**项目地址:** [zql-gif/CVE-2024-6387](https://github.com/zql-gif/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)