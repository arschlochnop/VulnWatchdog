## CVE-2019-5418 - Rails File Content Disclosure

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1, v3

**利用条件:** 目标应用使用受影响的Rails版本，并且使用了`render file:`调用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418 存在于 Rails Action View 中，由于对 Accept header 处理不当，导致可以读取服务器上的任意文件。攻击者通过构造特殊的 Accept header，例如包含文件路径，可以绕过 Rails 的安全检查，从而读取文件内容。 

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，并且有公开的利用代码。提供的`Bandit.py`脚本利用了该漏洞，通过修改 HTTP Accept header 来读取目标文件。

**投毒风险分析：**
分析提供的`Bandit.py`脚本内容，没有发现明显的恶意代码或后门。脚本的主要功能是发送带有特定 Accept header 的 HTTP 请求，并打印服务器的响应。`common.txt`如果被篡改，可能会导致尝试读取不存在的文件，但不会直接造成投毒。
`demo/Gemfile` 是一个标准的 Rails 应用 Gemfile，用于声明项目依赖，未发现投毒。
综合来看，该仓库投毒的风险较低。

**利用方式分析：**
1.  攻击者需要确定目标服务器上运行的 Rails 版本是否在受影响的范围内。
2.  攻击者使用脚本（如`Bandit.py`）或手动构造 HTTP 请求，在 Accept header 中指定要读取的文件路径。
3.  目标服务器在处理请求时，由于漏洞存在，会将指定文件的内容返回给攻击者。

例如，攻击者可以尝试读取 `/etc/passwd` 文件，或者 Rails 应用的 `config/database.yml` 文件，以获取数据库连接信息。

**项目地址:** [Bad3r/RailroadBandit](https://github.com/Bad3r/RailroadBandit)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)