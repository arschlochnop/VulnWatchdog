## CVE-2018-17229-Exiv2-堆缓冲区溢出

**漏洞编号:** CVE-2018-17229

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Exiv2

**危害等级:** 高危，可能导致拒绝服务或代码执行

**影响版本:** v0.26

**利用条件:** 需要处理特制的图像文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-17229 存在于 Exiv2 v0.26 的 `types.cpp` 文件的 `Exiv2::d2Data` 函数中。该漏洞允许远程攻击者通过特制的图像文件造成拒绝服务（堆缓冲区溢出）。

**有效性：**

根据提供的漏洞信息和搜索结果，此漏洞是真实存在的，并且影响 Exiv2 v0.26 版本。漏洞利用代码虽然没有直接提供利用 `Exiv2::d2Data` 函数的完整Payload，但提供的代码片段包含了 Exiv2 库的部分实现，为漏洞利用提供了基础。

**投毒风险：**

提供的代码片段 `deps.cpp` 看上去像是 Exiv2 库的依赖代码的简化版本，主要定义了一些类和结构体，如 `ExifData`，`BasicIo`，`Image` 等，这些类和结构体是解析图像元数据的基础。 代码中没有明显的恶意代码，如后门或反弹 shell 等。但是，此代码是原始 Exiv2 库的简化版本。 如果将此简化版本替换原始库，可能会导致功能不完整或者引入新的安全问题，但这不属于传统意义上的“投毒”。 投毒风险较低，约为1%，主要来自于替换组件可能带来的潜在未知风险。

**利用方式：**

1.  **漏洞点：** `Exiv2::d2Data` 函数（具体位置未在提供的代码中，但根据漏洞描述确定）。
2.  **触发条件：**  处理特制的图像文件，该文件会触发 `Exiv2::d2Data` 函数中的缓冲区溢出。
3.  **利用过程：** 攻击者需要构造一个特殊的图像文件，当 Exiv2 尝试解析该文件时，`Exiv2::d2Data` 函数会将数据写入堆缓冲区，由于缓冲区大小计算不正确或者缺少边界检查，导致数据写入超出缓冲区边界，从而覆盖相邻的内存区域。攻击者可以通过控制溢出的内容来修改程序的行为，例如覆盖函数指针，从而实现代码执行。不过，根据目前的信息，更可能的结果是导致程序崩溃（拒绝服务）。
4.  **修复方法：** 升级到 Exiv2 的修复版本，或者应用补丁程序，修复 `Exiv2::d2Data` 函数中的缓冲区溢出漏洞。

**项目地址:** [zeeshangondal/c-cpp_CVE-2018-17229](https://github.com/zeeshangondal/c-cpp_CVE-2018-17229)

**漏洞详情:** [CVE-2018-17229](https://nvd.nist.gov/vuln/detail/CVE-2018-17229)