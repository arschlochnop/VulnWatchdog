## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 4.87 to 4.91 (inclusive), 4.92受影响

**利用条件:** 目标系统运行存在漏洞的Exim版本，且允许接收邮件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 存在于 Exim 邮件服务器的 `deliver_message()` 函数中，由于对收件人地址验证不当，导致攻击者可以通过构造特殊的邮件，在目标服务器上执行任意命令。

**有效性：**

提供的POC代码是有效的，它展示了如何利用此漏洞执行命令。POC中的 `payload.txt` 文件构造了一个包含嵌入命令的收件人地址。`rcpt to:` 字段包含一个`${run{...}}` 块，Exim 会执行该块中的命令。

**投毒风险：**

此仓库存在一定的投毒风险。虽然 `payload.txt` 文件展示了漏洞利用方法，但 `README.md` 文件内容过于简单，缺乏漏洞的详细说明和利用注意事项。此外，POC代码中包含反弹shell的操作，可能被用于恶意目的，如果攻击者替换了原有的反弹shell代码，风险较高。
综合评估投毒风险为10%。

**利用方式：**

1.  攻击者发送一封精心构造的邮件到目标 Exim 服务器。
2.  邮件的 `RCPT TO` 字段包含一个特殊的字符串，其中嵌入了要执行的命令。`${run{...}}`是一个常见的Exim宏扩展结构。
3.  当 Exim 处理该邮件时，由于漏洞的存在，它会执行嵌入在 `RCPT TO` 字段中的命令，该命令将执行反弹shell或其它恶意操作。
4.  命令执行结果被通过 `nc` 命令发送到攻击者的服务器。

**项目地址:** [qlusec/CVE-2019-10149](https://github.com/qlusec/CVE-2019-10149)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)