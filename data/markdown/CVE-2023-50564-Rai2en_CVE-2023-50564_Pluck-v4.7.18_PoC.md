## CVE-2023-50564 Pluck-CMS v4.7.18 任意文件上传

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck-CMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.7.18

**利用条件:** 需要Pluck-CMS v4.7.18实例，具有后台模块安装权限的低权限用户。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50564 存在于 Pluck-CMS v4.7.18 的 `/inc/modules_install.php` 组件中。攻击者可以通过上传特制的 ZIP 文件来执行任意代码。

**有效性：**
提供的 POC 代码看起来有效，因为它模拟了登录过程，然后使用会话上传包含 PHP shell 的 ZIP 文件。 成功上传后，它会尝试通过访问上传的 shell.php 来执行代码。 搜索引擎结果也表明存在可利用的 POC。

**投毒风险：**
该POC代码本身没有明显的恶意投毒代码。`poc.py`脚本的主要功能是登录Pluck CMS后台，上传一个包含webshell的zip文件，然后尝试访问webshell。脚本中使用的库是常见的`requests`和`requests_toolbelt`，用于HTTP请求和处理multipart表单数据。虽然使用第三方库总是存在潜在风险，但在这里没有发现任何异常行为。

仓库的其他文件，如`README.md`和`LICENSE`，都是标准文档，没有包含恶意代码。

**利用方式：**
1.  攻击者首先需要拥有 Pluck-CMS v4.7.18 实例的低权限账户，该账户具备安装模块的权限。
2.  攻击者使用提供的 `poc.py` 脚本，首先替换`replace_with_your_hostname`、`replace_with_your_username`、`replace_with_your_password`为目标CMS地址，用户名密码。
3.  攻击者需要创建一个包含恶意 PHP shell（例如 `shell.php`）的 ZIP 文件 `payload.zip`，该 PHP shell 允许执行任意命令。强烈建议使用反向shell,保证命令回显.
4.  运行该脚本，该脚本将首先尝试登录到 Pluck-CMS 后台。
5.  如果登录成功，脚本将上传 `payload.zip` 文件到服务器。
6.  脚本尝试通过 HTTP 请求访问上传的 `shell.php` 文件，从而执行其中的恶意代码。如果一切顺利，攻击者将能够执行服务器上的任意命令。


**项目地址:** [Rai2en/CVE-2023-50564_Pluck-v4.7.18_PoC](https://github.com/Rai2en/CVE-2023-50564_Pluck-v4.7.18_PoC)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)