## CVE-2018-1002204/CVE-2018-1002208-node-unzipper/SharpZipLib目录遍历漏洞

**漏洞编号:** CVE-2018-10022

**漏洞类型:** 目录遍历

**影响应用:** node-unzipper/SharpZipLib

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** node-unzipper < 0.4.9/SharpZipLib < 1.0 RC1

**利用条件:** 需要上传zip文件，且zip文件包含恶意构造的路径

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索结果，CVE-2018-1002204是`adm-zip` npm库在0.4.9之前的版本中存在的目录遍历漏洞。CVE-2018-1002208是SharpZipLib在1.0 RC1之前的版本中存在的目录遍历漏洞。两个漏洞都允许攻击者通过在zip归档中使用`../`（点点斜杠）来写入任意文件。提供的漏洞利用代码是`node-unzipper`的一个仓库信息，表明该库是`node-unzip`的一个fork，并修复了一些bug。但是，**由于`node-unzipper`库版本小于0.4.9，所以可能存在目录遍历漏洞**。利用方式为：构造包含恶意路径（如`../../../../tmp/evil.txt`）的zip文件，上传并使用存在漏洞的`node-unzipper`版本解压，即可将文件写入到服务器任意位置。关于投毒风险，该仓库的`README.md`中包含大量npm包的使用方法,但license文件没有发现明显的可疑行为, 但是作为辅助工具,存在被恶意使用的风险, 代码本身投毒的可能性较低，但存在被滥用风险，因此设置为10%。

**项目地址:** [ossf-cve-benchmark/CVE-2018-1002203](https://github.com/ossf-cve-benchmark/CVE-2018-1002203)

**漏洞详情:** [CVE-2018-10022](https://nvd.nist.gov/vuln/detail/CVE-2018-10022)