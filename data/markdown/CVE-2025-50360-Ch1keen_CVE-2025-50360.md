## CVE-UNKNOWN-Pepper-Heap-Buffer-Overflow

**漏洞编号:** CVE-2025-50360

**漏洞类型:** Heap Buffer Overflow

**影响应用:** Pepper Language

**危害等级:** 高危，可能导致拒绝服务，代码执行

**影响版本:** <= 0.1.1

**利用条件:** 需要目标系统安装存在漏洞的Pepper Language版本，并能够执行Pepper脚本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

Pepper Language 0.1.1及之前版本存在堆缓冲区溢出漏洞。该漏洞位于`compiler.c`的`add_constant`函数中。当程序尝试编译包含超过64个常量（数字）的Pepper脚本时，`compiler`结构体中的`scopes`数组（固定大小为64）会发生溢出，导致程序崩溃。攻击者可以通过构造包含大量常量的恶意Pepper脚本来触发此漏洞。

**有效性评估：**
提供的PoC代码清晰地展示了如何复现该漏洞。通过创建一个包含超过64个数字的Pepper脚本，即可触发堆缓冲区溢出，导致程序崩溃。因此，PoC代码是有效的。

**投毒风险评估：**
虽然PoC本身是为了证明漏洞的存在，但它也存在被恶意利用的风险。以下是一些考虑因素：

*   **代码审查：** 代码相对简单，主要展示了如何触发漏洞。经过快速的人工审查，未发现明显的恶意后门代码。但不能排除作者在其他提交或构建过程中引入恶意代码的可能性。
*   **供应链风险：** 如果用户从不可信的来源下载Pepper Language或其依赖项，则存在供应链投毒的风险。虽然提供的PoC代码本身看起来是安全的，但用户仍然需要谨慎，确保从官方或可信的来源获取软件。
*   **模糊测试利用：** 该PoC可能由模糊测试生成。fuzz工具旨在发现漏洞，如果攻击者使用fuzz生成PoC，可能包含难以察觉的恶意片段。

考虑到以上因素，以及当前对Pepper Language项目本身的安全态势认知不足，初步估计投毒风险在10%左右。这主要来自于潜在的供应链投毒风险，以及无法完全排除的作者恶意植入的可能性。

**利用方式：**
1.  **准备恶意Pepper脚本：** 创建一个包含超过64个常量的Pepper脚本文件（例如，`overflow.pp`）。
2.  **执行脚本：** 使用存在漏洞的`pepper`编译器编译并执行该脚本：`pepper overflow.pp`。
3.  **触发漏洞：** 编译器在处理脚本时，由于堆缓冲区溢出，程序将崩溃。

**进一步利用：**
虽然PoC仅导致程序崩溃，但通过精心构造的输入，攻击者可能能够利用此漏洞执行任意代码。这需要更深入的分析和利用技术，例如控制溢出后的内存内容，覆盖函数指针等。但是考虑到Pepper语言的普及程度和项目维护状态，进一步利用的价值相对较低。

**与其他CVE关联的分析：**
搜索结果中列出了多个CVE，但没有一个直接与Pepper Language的这个堆缓冲区溢出漏洞相关。这些CVE涉及不同的软件和安全问题（如IBM QRadar SIEM信息泄露、Campcodes Online Hospital Management System漏洞、Chrome Loader跨域数据泄露、SAP零日漏洞、.NET远程代码执行漏洞、Microsoft Copilot AI漏洞、Visual Studio命令注入漏洞），因此与本PoC的评估无关。

**项目地址:** [Ch1keen/CVE-2025-50360](https://github.com/Ch1keen/CVE-2025-50360)

**漏洞详情:** [CVE-2025-50360](https://nvd.nist.gov/vuln/detail/CVE-2025-50360)