## CVE-2025-9090-TendaAC20-命令注入

**漏洞编号:** CVE-2025-9090

**漏洞类型:** 命令注入

**影响应用:** Tenda AC20

**危害等级:** 中危，可远程执行命令

**影响版本:** 16.03.08.12

**利用条件:** 需要登录权限才能利用该漏洞

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-9090是Tenda AC20路由器16.03.08.12版本中Telnet服务中的一个命令注入漏洞。具体来说，漏洞存在于`/goform/telnet`文件的`websFormDefine`函数中。攻击者可以通过发送特制的POST请求到`/goform/telnet`端点，在其中注入恶意命令，从而在路由器上执行任意代码。

**有效性：**

根据漏洞描述，POC代码利用了该漏洞，并通过发送包含恶意命令的POST请求到`/goform/telnet`来触发命令注入。POC代码验证了漏洞的存在，通过检查响应字符串"load telnetd success"并尝试连接Telnet服务来确认漏洞是否被成功利用。搜索引擎结果表明该漏洞已被公开，并且存在可用的exploit，进一步验证了该漏洞利用的有效性。

**投毒风险：**

代码主要功能是利用漏洞，但存在极小的投毒风险。
*   `exit64bit()`函数使用内联汇编执行系统调用，虽然目前是用于退出程序，但理论上可以修改为执行其他恶意操作。但从目前代码来看，是正常退出。
*   `write_cb()`函数用于接收服务器的响应。如果服务器返回恶意构造的超长响应，可能导致内存溢出。但由于该函数对响应大小进行了限制，并且通过`realloc`动态分配内存，降低了内存溢出风险。

综合来看，投毒的可能性较低，大约为5%。

**利用方式：**

利用方式如下：

1.  **构建URL：** 构造完整的目标URL，即`http://<IP>/goform/telnet`。
2.  **准备POST数据：** 准备包含恶意命令的POST数据。具体注入点在`websFormDefine`函数的参数中。
3.  **发送POST请求：** 使用libcurl库向目标URL发送POST请求，将恶意命令注入到目标设备。
4.  **验证漏洞：** 检查响应，如果返回"load telnetd success"，则表明Telnet服务已成功启动。同时尝试连接Telnet服务(23或2323端口)来验证命令是否成功执行。

该漏洞需要登录权限才能触发，CVSS评分也表明需要低权限才能利用。攻击者首先需要通过某种方式获取路由器的登录凭据，才能成功利用该漏洞。

**项目地址:** [byteReaper77/CVE-2025-9090](https://github.com/byteReaper77/CVE-2025-9090)

**漏洞详情:** [CVE-2025-9090](https://nvd.nist.gov/vuln/detail/CVE-2025-9090)