## CVE-2025-32421-Next.js-缓存投毒

**漏洞编号:** CVE-2025-32421

**漏洞类型:** 缓存投毒

**影响应用:** Next.js

**危害等级:** 中危，可能导致敏感信息泄露或页面内容篡改

**影响版本:** < 14.2.24 或 >= 15.0.0, < 15.1.6

**利用条件:** Pages Router，特定的错误配置，自托管Next.js部署，未使用显式缓存控制，存在竞态条件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32421是Next.js框架中的一个竞态条件漏洞，可能导致缓存投毒。漏洞出现在Pages Router中，影响版本低于14.2.24和15.0.0到15.1.6的版本。该漏洞的利用需要满足特定条件：自托管的Next.js部署，以及缺乏显式的缓存控制。漏洞利用的核心在于利用竞态条件，使得正常的端点提供`pageProps`数据而不是标准的HTML，从而影响缓存的内容。根据漏洞库信息，Vercel平台不受此漏洞影响，因为该平台不会仅基于`200 OK`状态缓存响应。提供的POC代码尝试模拟一个容易受到攻击的场景，但更侧重于验证堆栈对齐，而不是实际的缓存投毒。它使用了混淆的通信通道，向一个URL发送请求，并期望验证失败。POC的目的是帮助分析人员了解漏洞利用过程中的堆栈行为，而不是提供一个可以直接使用的攻击载荷。POC代码中未发现明显的投毒代码。

**项目地址:** [zeroc00I/CVE-2025-32421](https://github.com/zeroc00I/CVE-2025-32421)

**漏洞详情:** [CVE-2025-32421](https://nvd.nist.gov/vuln/detail/CVE-2025-32421)