## CVE-2025-53652 - Jenkins Git Parameter Plugin 命令注入漏洞

**漏洞编号:** CVE-2025-53652

**漏洞类型:** 命令注入

**影响应用:** Jenkins Git Parameter Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 439.vb_0e46ca_14534

**利用条件:** 需要 Item/Build 权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-53652 存在于 Jenkins Git Parameter Plugin 439.vb_0e46ca_14534 及更早版本中。该插件没有验证提交给构建的 Git 参数值是否与提供的选项匹配，这允许具有 Item/Build 权限的攻击者将任意值注入到 Git 参数中，导致命令注入。漏洞利用方式如下：

1.  **漏洞原理：**攻击者可以通过修改 Git 参数的值，注入恶意的 shell 命令。
2.  **利用过程：**
    *   用户输入（恶意命令）作为构建参数，未经清理直接传递给 `GitParameterValue` 对象。
    *   `GitParameterValue` 将用户输入作为环境变量传递到构建上下文中。
    *   在 SCM 检出过程中，Jenkins 通过 `build.getEnvironment()` 加载构建环境变量，包括恶意的环境变量。
    *   从环境变量中获取的分支名称 (localBranchName) 直接传递给 `CheckoutCommand.branch()` 方法。
    *   `CheckoutCommand.execute()` 方法执行 Git CLI 命令，将分支名称直接连接到命令中，从而实现命令注入。
3.  **有效性：** 根据提供的漏洞信息和利用代码，该漏洞利用方式有效，因为代码展示了如何将用户输入注入到 Git 命令中，并最终执行。
4.  **投毒风险：** 提供的 POC 代码主要是对漏洞的分析和利用说明，以及相关的截图展示，没有发现隐藏的投毒代码。因此，投毒风险为0%。
5.  **利用方式总结：** 攻击者通过修改 Git 参数，注入恶意 shell 命令，由于 Jenkins 没有对 Git 参数进行验证，导致恶意命令被作为环境变量传递到 Git CLI 命令中执行，最终导致远程代码执行。

**项目地址:** [pl4tyz/CVE-2025-53652-Jenkins-Git-Parameter-Analysis](https://github.com/pl4tyz/CVE-2025-53652-Jenkins-Git-Parameter-Analysis)

**漏洞详情:** [CVE-2025-53652](https://nvd.nist.gov/vuln/detail/CVE-2025-53652)