## CVE-2023-4220 Chamilo LMS Unauthenticated Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 未授权文件上传导致远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS <= 1.11.24，并且可以网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Chamilo LMS的bigupload功能中。攻击者可以通过未授权的文件上传，将恶意webshell上传到服务器，然后通过访问webshell执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，且危害严重。提供的PoC代码基本完整，能够实现未经身份验证的webshell上传和命令执行。PoC通过发送multipart/form-data请求，上传包含PHP代码的文件到`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`处理，然后通过访问上传的文件触发webshell执行。

**投毒风险评估：**
PoC代码主要功能是上传webshell和执行命令，检查了`poc.py`脚本，发现存在一定的投毒风险。风险点包括：

1.  **revshell代码：** PoC中包含上传反向shell的代码，如果攻击者不小心或者不理解代码，直接运行，可能会在自己的机器上打开端口，等待被连接，增加了风险。
2.  **URL参数：** PoC需要指定目标URL，如果攻击者不小心将URL指向自己的机器，可能会将webshell上传到自己的服务器上。
3.  **文件名：** PoC可以自定义上传的文件名，如果攻击者使用一些敏感的文件名，可能会引起管理员的注意。

总体来说，PoC代码本身投毒的概率较低，但使用不当可能会带来一定的安全风险。因此，需要在使用PoC代码时，仔细阅读代码，理解代码的逻辑，并采取必要的安全措施。

**漏洞利用方式：**
1.  攻击者利用未授权文件上传漏洞，上传webshell（例如PHP脚本）到Chamilo LMS服务器。
2.  攻击者通过构造特定的URL，访问上传的webshell，触发webshell执行。
3.  Webshell执行后，攻击者可以在服务器上执行任意代码，例如窃取数据、篡改网站内容、控制服务器等。

**缓解措施：**
1.  升级Chamilo LMS到最新版本，修复此漏洞。
2.  限制上传文件类型，禁止上传PHP等可执行文件。
3.  加强服务器安全配置，防止webshell执行。

**项目地址:** [HO4XXX/cve-2023-4220-poc](https://github.com/HO4XXX/cve-2023-4220-poc)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)