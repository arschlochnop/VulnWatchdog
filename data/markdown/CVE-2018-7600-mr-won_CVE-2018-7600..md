## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致网站完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且允许外部网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal 7.x和8.x的远程代码执行漏洞。攻击者可以通过构造特定的HTTP请求，利用Drupal的多个子系统中的缺陷，在目标服务器上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞的利用是有效的。搜索结果中多个链接表明该漏洞已被广泛利用，并且存在公开的Exploit。

**投毒风险：**
提供的PoC代码相对简单，主要功能是发送一个包含恶意payload的POST请求到`/user/register`，并在目标服务器上创建一个名为`r3dxploit.txt`的文件，内容为“vulnerable to cve-7600-2018 exploit”。代码本身没有明显的恶意行为，如删除文件、上传恶意文件或执行其他危险操作。但是，在实际使用中，攻击者可以将payload修改为更具破坏性的命令，例如下载和执行恶意脚本。此外，代码作者信息中包含了一些可能与恶意活动相关的标识，例如使用“R3DXPLOIT”作为用户名和涉及Root权限的字眼。综合考虑，PoC代码本身存在一定潜在风险，但主要取决于使用者如何修改payload，因此投毒风险初步评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意payload的POST请求，该payload利用`user_register_form`的ajax功能注入恶意代码。
2.  请求发送到`/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax`端点。
3.  Drupal处理请求时，由于输入验证不足，导致恶意代码被执行。
4.  PoC代码中，恶意代码的功能是在目标服务器上创建一个文件，表明漏洞存在。
5.  攻击者可以修改payload执行任意命令，例如反弹shell，从而完全控制目标服务器。

**项目地址:** [mr-won/CVE-2018-7600.](https://github.com/mr-won/CVE-2018-7600.)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)