## CVE-2025-43960 - Adminer PHP Object Injection DoS

**漏洞编号:** CVE-2025-43960

**漏洞类型:** PHP 对象注入

**影响应用:** Adminer

**危害等级:** 高危，可能导致拒绝服务

**影响版本:** < 4.8.1

**利用条件:** 需要 Adminer 实例使用 Monolog 进行日志记录，并且可以向 Adminer 发送 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-43960 是 Adminer 4.8.1 版本之前存在的一个 PHP 对象注入漏洞。该漏洞允许未经身份验证的远程攻击者利用 Monolog 组件导致拒绝服务（DoS）。攻击者通过发送一个精心构造的、包含超大字符串的序列化 PHP 对象到 Adminer，触发 `unserialize()` 函数进行反序列化，从而导致服务器消耗大量内存，使 Adminer 变得无响应，甚至导致服务器崩溃。

**有效性：**
提供的 PoC 代码看起来是有效的。它利用了 PHP 对象注入漏洞，通过构造一个包含巨大字符串的序列化对象，发送给 Adminer，导致 Adminer 消耗大量内存而拒绝服务。

**投毒风险：**
PoC 代码中存在一定程度的投毒风险。虽然主要目的是触发 DoS，但攻击者可能会尝试在填充的字符串中插入恶意代码，例如 PHP 代码，以尝试进行远程代码执行（RCE）。然而，由于 Monolog 组件通常不会直接执行反序列化后的对象，直接 RCE 的可能性较低。更可能的投毒方式是利用反序列化过程中的其他漏洞，或者影响日志的完整性。 评估投毒风险为 10%。 主要的 PoC 逻辑是生成大的字符串并将其插入到序列化对象中，并没有明显的后门代码，因此判定为10%。

**利用方式：**
1.  **Payload 生成：** 首先，利用 shell 命令生成一个包含大量重复字符的填充文件（例如，1GB 的 'D' 字符）。
2.  **构造序列化对象：** 将填充文件的内容嵌入到一个精心构造的 PHP 序列化对象中。该对象通常是 `Monolog\Handler\SyslogUdpHandler` 类的一个实例，其 `handler` 属性被设置为包含填充文件内容的字符串。
3.  **发送请求：** 将包含序列化对象的 payload 通过 HTTP 请求发送到目标 Adminer 实例。具体发送方式取决于 Adminer 的配置和漏洞暴露点，可能通过 GET 或 POST 参数。
4.  **触发漏洞：** Adminer 接收到请求后，如果使用 Monolog 进行日志记录，并且没有对输入进行适当的验证和过滤，则会调用 `unserialize()` 函数对 payload 进行反序列化。反序列化过程会尝试创建包含巨大字符串的对象，从而消耗大量内存。
5.  **拒绝服务：** 内存耗尽最终导致 Adminer 变得无响应，甚至使整个服务器崩溃，实现拒绝服务攻击。

总而言之，该漏洞是一个典型的 PHP 对象注入漏洞，利用了 `unserialize()` 函数处理不可信数据时可能导致的问题。 通过发送精心构造的序列化数据，攻击者可以控制反序列化的过程，从而达到拒绝服务的目的。

**项目地址:** [far00t01/CVE-2025-43960](https://github.com/far00t01/CVE-2025-43960)

**漏洞详情:** [CVE-2025-43960](https://nvd.nist.gov/vuln/detail/CVE-2025-43960)