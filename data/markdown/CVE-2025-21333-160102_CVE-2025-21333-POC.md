## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致权限提升

**影响版本:** 受影响的Windows版本包括Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等。

**利用条件:** 需要本地访问，在Hyper-V环境中。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-21333是一个Windows Hyper-V NT Kernel Integration VSP（Virtual Service Provider）权限提升漏洞。根据漏洞信息和搜索结果，该漏洞存在于Hyper-V的NT内核集成组件中，允许攻击者提升权限。漏洞利用代码显示这是一个C++项目，利用了WNF（Windows Notification Facility）状态数据和I/O ring IOP_MC_BUFFER_ENTRY来触发堆缓冲区溢出。该POC的Visual Studio解决方案文件表明它是一个可编译的项目，但存在投毒风险，因为从github下载zip存在未知风险。从代码来看，大量使用了Windows API，直接与内核交互，存在恶意修改内核的可能性，投毒风险评估为20%。利用方式通常包括：

1.  **触发漏洞：** 通过精心构造的WNF状态数据和I/O ring操作，触发NT内核集成组件中的堆缓冲区溢出。
2.  **控制执行流：** 覆盖堆上的关键数据结构，以控制内核的执行流程。
3.  **权限提升：** 通过修改当前进程的Token，将其权限提升到SYSTEM级别。

从搜索结果来看，该漏洞已经被CISA列入已知被利用漏洞目录，表明该漏洞具有较高的实际威胁。

**有效性评估：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的，因为存在可编译的POC，并且CISA已经确认该漏洞被利用。

**投毒风险评估：** 该POC代码存在一定的投毒风险。因为需要下载压缩包，压缩包内部可能包含恶意代码，但主要代码是利用windows api进行操作，函数功能明确，没有发现明显的恶意行为，风险较低。


**项目地址:** [160102/CVE-2025-21333-POC](https://github.com/160102/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)