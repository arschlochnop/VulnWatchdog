## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，允许远程代码执行

**影响版本:** 2.12.0

**利用条件:** 需要受害者克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。漏洞利用方式是攻击者创建一个包含恶意配置的 Git 仓库，该仓库会在受害者克隆时执行任意代码。 

**有效性：**
提供的 POC 代码 `/tmp/05242692056c38f909a2dee933ea6fc4/1.bat` 内容为 `calc.exe`，这意味着当受害者克隆包含此文件的恶意仓库时，`calc.exe` 将会被执行。因此，如果 Git LFS 存在漏洞并且这个 `.bat` 文件能够被执行，那么 POC 代码是有效的，可以验证 RCE 漏洞。

**投毒风险：**
虽然提供的 POC 仅仅执行 `calc.exe`，但攻击者可以将此替换为更具破坏性的命令。因此，在实际利用中，存在攻击者在公开仓库中放置恶意代码，诱导用户克隆，从而进行投毒攻击的风险。这里`calc.exe`只是验证漏洞的PoC，不能算作投毒代码，但是如果作者在仓库中隐藏了其他后门代码,则存在投毒风险。 这里假设作者有隐藏代码，风险占比10%。

**利用方式：**
1.  攻击者创建一个恶意 Git 仓库，该仓库包含一个恶意的 Git LFS 对象，该对象配置执行恶意命令（例如，`.bat` 文件或其他脚本）。
2.  攻击者将该仓库上传到公共 Git 托管平台，例如 GitHub 或 GitLab。
3.  攻击者诱骗受害者克隆该仓库（例如，通过社交工程）。
4.  当受害者克隆仓库时，Git LFS 会尝试下载和处理恶意 LFS 对象。
5.  由于存在漏洞，恶意 LFS 对象会执行攻击者指定的代码，从而导致远程代码执行。


**项目地址:** [FrostsaberX/CVE-2020-27955](https://github.com/FrostsaberX/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)