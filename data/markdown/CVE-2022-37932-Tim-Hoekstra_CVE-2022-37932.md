## CVE-2022-37932-HP OfficeConnect 身份验证绕过

**漏洞编号:** CVE-2022-37932

**漏洞类型:** 身份验证绕过

**影响应用:** Hewlett Packard Enterprise OfficeConnect 1820, 1850, and 1920S Network switches

**危害等级:** 高危，可完全控制受影响设备并可能影响整个网络

**影响版本:** Prior to PT.02.14; Prior to PC.01.22; Prior to PO.01.21; Prior to PD.02.22

**利用条件:** 目标设备位于攻击者可访问的相邻网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-37932 存在于 HP OfficeConnect 1820、1850 和 1920S 网络交换机中，是一个身份验证绕过漏洞。未经身份验证的攻击者可以通过向 `/login/default_password_cfg.lua` 发送特制的 HTTP POST 请求来更改管理员密码。漏洞利用代码显示，该脚本没有进行身份验证检查，仅验证 `oldPwd` 参数是否与默认密码（为空）匹配。成功利用此漏洞的攻击者可以获得设备的完全管理控制权限，并修改网络设置，从而可能危及整个网络。

**有效性：** 根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码清晰地展示了如何通过构造特定的 HTTP POST 请求来绕过身份验证并更改管理员密码。

**投毒风险：** 提供的漏洞利用代码（README.md 文件）主要包含漏洞描述、技术细节、利用方法和免责声明，没有发现任何明显的恶意代码。但仍需谨慎，因为攻击者可能会在实际的利用过程中加入恶意代码，例如在修改密码后添加后门用户。虽然 README.md 本身不太可能包含投毒代码，但用户在使用时需要保持警惕，验证工具和网络流量，防止被植入恶意软件或其他后门。投毒风险评估为10%, 因为理论上可能存在代码审查不仔细或者攻击者篡改的可能。

**利用方式：**
1.  定位位于相邻网络中的易受攻击的 HP 1920 系列交换机。
2.  向交换机的 `/login/default_password_cfg.lua` 路径发送构造的 HTTP POST 请求。
3.  在 POST 请求中，设置 `username` 为 `admin`，`oldPwd` 为空，`newPwd` 和 `confirmPwd` 为攻击者选择的新密码。
4.  成功发送请求后，管理员密码将被更改为攻击者指定的值。
5.  攻击者可以使用新密码登录，获得完全管理权限。

**项目地址:** [Tim-Hoekstra/CVE-2022-37932](https://github.com/Tim-Hoekstra/CVE-2022-37932)

**漏洞详情:** [CVE-2022-37932](https://nvd.nist.gov/vuln/detail/CVE-2022-37932)