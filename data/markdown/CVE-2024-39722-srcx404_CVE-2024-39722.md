## CVE-2024-39722-Ollama-路径遍历

**漏洞编号:** CVE-2024-39722

**漏洞类型:** 路径遍历

**影响应用:** Ollama

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 0.1.46

**利用条件:** 需要网络访问 Ollama 服务的 api/push 路由

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-39722 是 Ollama 0.1.46 之前版本中发现的一个路径遍历漏洞。该漏洞位于 api/push 路由中。攻击者可以通过构造包含恶意路径的请求，例如 `../../../../etc/passwd`，来访问 Ollama 服务器上的任意文件，从而可能导致敏感信息泄露。漏洞利用代码 `CVE_2024_39722.py` 首先爬取 Ollama 模型库，然后格式化目标 URL，并尝试通过 `/api/version` 接口获取 Ollama 版本信息，从而验证漏洞的存在。由于代码中涉及爬取模型信息和版本检查，存在极低的概率被用于扫描或进一步攻击前的准备工作，例如筛选特定版本或模型进行攻击，故投毒风险评估为1%。 搜索结果和漏洞库信息均表明该漏洞存在且危害较高。

**利用方式：**

1.  确定目标 Ollama 服务的 URL。
2.  构造包含恶意路径的 HTTP 请求，发送到 Ollama 服务的 `/api/push` 路由，例如：`POST /api/push?name=模型名称&file=../../../../etc/passwd`。
3.  如果 Ollama 服务存在漏洞，服务器将返回指定文件的内容，攻击者可以利用该信息进行进一步的攻击，例如读取配置文件、密钥等。

**有效性：**

根据漏洞描述和搜索结果，提供的 POC 代码主要用于爬取模型信息以及检测版本，不包含直接利用路径遍历漏洞的代码，但爬取结果可以辅助漏洞利用。 因此，该POC的利用有效性较低，需要结合其他手段才能有效利用此漏洞。


**项目地址:** [srcx404/CVE-2024-39722](https://github.com/srcx404/CVE-2024-39722)

**漏洞详情:** [CVE-2024-39722](https://nvd.nist.gov/vuln/detail/CVE-2024-39722)