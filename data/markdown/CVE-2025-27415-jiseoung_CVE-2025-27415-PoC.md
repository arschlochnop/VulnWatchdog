## CVE-2025-27415-Nuxt3缓存投毒

**漏洞编号:** CVE-2025-27415

**漏洞类型:** 缓存投毒

**影响应用:** Nuxt3

**危害等级:** 高危，可能导致拒绝服务（DoS）

**影响版本:** >=3.0.0, <3.16.0

**利用条件:** Nuxt服务器位于CDN之后，且CDN对URL的缓存策略忽略查询字符串

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-27415 描述了 Nuxt3 框架中的一个缓存投毒漏洞。当 Nuxt 服务器位于 CDN 之后，且 CDN 的缓存策略忽略 URL 中的查询字符串时，攻击者可以利用此漏洞。攻击者可以通过构造带有 `/_payload.json` 路径的恶意请求，例如 `/?/_payload.json`。如果CDN忽略查询字符串，此请求的响应（JSON数据）会被 CDN 缓存，并错误地提供给后续访问根路径 `/` 的用户，导致所有访问 `/` 的用户都获得恶意JSON内容，从而实现缓存投毒。

**有效性：**
提供的 POC 代码包含 Dockerfile 和 docker-compose.yml 文件，表明这是一个可以快速搭建漏洞环境的 PoC。`README.md` 文件也解释了漏洞的原理和利用方法。`nuxt-app` 文件夹包含一个简单的 Nuxt3 应用，用于演示该漏洞。`pages/ex.vue` 页面提供了一个自动触发缓存投毒攻击的界面，允许用户指定目标Origin和缓存刷新时间，从而验证了该poc的有效性。

**投毒风险：**
虽然代码提供了攻击页面，但是在服务器端的exploit代码部分缺失，只展示了前端部分的vue代码，攻击payload需要用户进行自行构造。经过检查，`docker-compose.yml`中定义了一个 `exploit` 服务，其 `context` 为 `./exploit`，但具体 `exploit` 目录下的代码未提供，因此缺少关键攻击逻辑。攻击脚本需要手动部署。提供的代码片段本身没有发现明显的恶意后门或隐蔽代码。`pages/ex.vue` 中提交origin和cacheSec两个参数，存在一定风险，可以结合其他漏洞进行利用，但是投毒的可能性较低。综上所述，可以初步评估认为几乎不存在作者隐藏的投毒代码，投毒风险在1%。

**利用方式：**
1.  **环境搭建：** 使用 `docker-compose up --build` 命令搭建包含存在漏洞的 Nuxt3 应用和 Nginx CDN 的测试环境。
2.  **构造恶意请求：** 构造包含 `/?/_payload.json` 形式的 URL，该 URL 会返回 JSON 数据。
3.  **缓存投毒：** 如果 CDN 忽略查询字符串，该 JSON 响应会被 CDN 缓存为 `/` 的内容，后续用户访问 `/` 时会获取到被投毒的 JSON 数据。
4.  **持续攻击（可选）：** 编写脚本定时发送恶意请求，保持缓存被持续投毒，实现 DoS 攻击。

该漏洞的修复方法是升级到 Nuxt3 >= 3.16.0 版本。

**项目地址:** [jiseoung/CVE-2025-27415-PoC](https://github.com/jiseoung/CVE-2025-27415-PoC)

**漏洞详情:** [CVE-2025-27415](https://nvd.nist.gov/vuln/detail/CVE-2025-27415)