## CVE-2023-22515-Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建管理员帐户并完全控制Confluence实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence实例可以公开访问。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center的严重漏洞，属于权限控制缺陷。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞被广泛利用，允许未经身份验证的攻击者创建Confluence管理员帐户。搜索结果[6]指向GitHub上存在利用此漏洞的公开PoC。

**投毒风险：**
提供的漏洞利用代码描述了一种在获得后台权限后进行RCE的方式，通过上传恶意插件实现。此代码本身描述的是后渗透阶段的利用方法，不是漏洞触发点。其中展示了上传插件的截图，并访问特定的servlet来执行命令。该利用方式依赖于已经获取的管理员权限，漏洞利用代码仓库本身只包含图片和说明文档，通过上传恶意插件从而达到了RCE目的，投毒风险较低。由于利用方式较为直接，可以判断没有显著的投毒行为，但是不排除图片中引用的插件中包含恶意代码的可能性，因此存在一定风险。

**利用方式：**
1.  攻击者利用未授权访问漏洞(CVE-2023-22515)创建一个管理员账号。
2.  使用创建的管理员账号登录Confluence后台。
3.  在Confluence后台，攻击者上传一个恶意插件。
4.  通过访问恶意插件提供的Servlet接口（例如 `plugins/servlet/com.jsos.shell/ShellServlet`），执行任意代码。

此漏洞利用的核心在于首先获得管理员权限，然后通过上传恶意插件实现RCE。提供的代码只是RCE的步骤，而非获取管理员权限的PoC。

**项目地址:** [youcannotseemeagain/CVE-2023-22515_RCE](https://github.com/youcannotseemeagain/CVE-2023-22515_RCE)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)