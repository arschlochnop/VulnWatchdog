## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建特权用户，进而完全控制系统。

**影响版本:** 受影响的版本包括16.1.1到17.12.1以及其他一系列17.x版本 (详见漏洞库信息)

**利用条件:** 目标设备启用Web UI功能，并且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。根据漏洞库信息和搜索引擎结果，未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有 15 级权限（最高权限）的帐户。随后攻击者再利用CVE-2023-20273，将权限提升至root，并写入植入体。该漏洞的利用方式如下：

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到Cisco IOS XE设备的Web UI接口，绕过身份验证。
2.  **创建特权用户：** 请求中包含特定的XML内容，该内容允许攻击者创建一个新的本地用户，并分配最高权限（privilege level 15）。
3.  **权限提升：** 攻击者利用创建的特权用户登录系统。
4.  **植入后门：** 攻击者通过Web UI的另一个组件（CVE-2023-20273）将权限提升至root并写入植入体。

**有效性：** 根据搜索引擎结果（特别是horizon3.ai的POC）以及提供的漏洞利用代码，此漏洞利用是有效的。漏洞利用代码仓库提供了一个Python脚本，可以检测和利用此漏洞。

**投毒风险：** 漏洞利用代码仓库的投毒风险评估为10%。虽然该仓库提供了看似合理的漏洞利用脚本，但存在以下潜在风险点：

*   **自定义配置内容：** 脚本允许用户提供自定义的配置内容（`-cfc` 或 `--config-content` 参数），这可能被滥用以注入恶意代码或配置。
*   **隐蔽后门：** 虽然主要功能是利用漏洞，但作者可能在代码中添加了不易察觉的后门，例如收集目标信息、执行任意命令等。代码量较少，通读代码可以降低风险。

**防范措施：**

*   立即更新Cisco IOS XE软件到已修复的版本。
*   禁用Web UI功能，如果不需要。
*   监控网络流量，检测异常的Web UI请求。
*   使用Cisco提供的软件检查工具来识别和移除潜在的植入体。

**项目地址:** [RevoltSecurities/CVE-2023-20198](https://github.com/RevoltSecurities/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)