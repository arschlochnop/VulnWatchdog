## CVE-2025-3248-Langflow-代码注入

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 代码注入

**影响应用:** Langflow

**危害等级:** 高危，远程代码执行

**影响版本:** <= 1.2.0

**利用条件:** 需要网络访问Langflow服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248是Langflow 1.3.0之前版本中/api/v1/validate/code端点存在的一个未经身份验证的远程代码执行漏洞。攻击者可以发送特制的HTTP请求执行任意代码。

**有效性：**

提供的PoC代码利用了/api/v1/validate/code端点的代码注入漏洞，通过发送恶意构造的HTTP请求，可以在目标系统上执行任意Python代码。该PoC包含了一个反向shell的功能，可以方便地获取目标系统的控制权。搜索引擎结果中也多次提到该漏洞的利用，证明其有效性。

**投毒风险：**

该PoC代码主要功能是利用漏洞进行反向shell连接，从而控制目标机器。虽然存在一定的风险，比如攻击者可以修改反向shell的地址，或者添加其他恶意代码，但总的来说投毒风险较低。PoC代码中使用了`pwn`库，这个库本身功能强大，如果使用不当，可能存在安全隐患，但这不属于投毒。

**利用方式：**

1.  **漏洞点：**/api/v1/validate/code
2.  **攻击方式：** 发送包含恶意Python代码的HTTP POST请求到/api/v1/validate/code端点
3.  **利用过程：**
    *   利用PoC脚本，指定目标Langflow服务器的地址，以及反向shell监听的地址和端口。
    *   PoC脚本会自动检测目标服务器的协议(http/https)。
    *   PoC脚本构造包含恶意Python代码的HTTP请求，并发送给目标服务器。
    *   恶意Python代码在目标服务器上执行，建立反向shell连接。
    *   攻击者通过反向shell获得目标服务器的控制权。

从代码可以看出，漏洞的触发点在`validate/code`接口，由于对用户提交的代码验证不充分，直接使用`exec`执行，导致了任意代码执行。


**项目地址:** [vigilante-1337/CVE-2025-3248](https://github.com/vigilante-1337/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)