## CVE-2025-8088-WinRAR路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-8088 是一个WinRAR的路径遍历漏洞，攻击者可以构造恶意的RAR压缩包，利用`..\` 进行目录穿越，将恶意文件写入到任意目录。从漏洞库信息和搜索引擎结果来看，该漏洞已经在野外被利用，常见的攻击方式是将恶意文件写入到Windows启动目录，实现开机自启动，从而执行任意代码。

**有效性评估：**
提供的POC代码尝试利用该漏洞，其原理是通过创建包含特制RAR头的压缩包，在压缩包中构造包含多层`..\`的路径，当用户解压该压缩包时，恶意Payload（payload.bat）会被解压到指定的启动目录（AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup），从而实现开机自启动。
从代码逻辑上看，该POC能够有效地利用此漏洞。

**投毒风险评估：**

POC代码中存在一定的投毒风险。具体分析如下：

1.  **下载可执行文件：** `CVE-2025-8088.py`脚本首先尝试从`http://176.65.132.63/file_cache.exe`下载一个名为`cache_register.exe`的可执行文件并执行。该可执行文件的来源未知，具有潜在的恶意行为风险。如果该可执行文件包含恶意代码，那么运行该脚本会导致用户系统受到感染。这部分代码可能是作者植入的后门或者恶意payload。

2.  **硬编码的IP地址：** 该IP地址`176.65.132.63` 存在被攻击者替换为恶意服务器的风险，如果攻击者控制该服务器，则可以传播恶意软件。

3.  **payload.bat内容：**  `payload.bat` 的默认行为是启动 `notepad.exe`， 在实际攻击场景中，`payload.bat`的内容可能被修改为执行其他恶意操作，例如下载和执行恶意软件，或者窃取用户敏感信息。`config.py`脚本中定义了`PAYLOAD`变量，允许自定义`payload.bat`的内容，这增加了攻击的灵活性和潜在危害。

4. **缺失的清理逻辑**: 代码中虽然有`os.remove(local_path)`尝试删除下载的exe文件，但是由于各种原因，比如权限问题，文件被占用等，可能会导致删除失败，留下恶意文件。

**结论：**
由于POC代码会下载并执行未知的可执行文件，并允许自定义Payload内容，该POC存在较高的投毒风险，风险值预估为70%。强烈建议在隔离环境中运行该POC，并仔细审查下载的可执行文件的行为。

**利用方式：**

1.  **生成Payload：**  首先，需要生成一个Payload，可以是任何可以在Windows上执行的程序或脚本。例如，`payload.bat` 文件，用于执行特定的命令。
2.  **构造恶意RAR压缩包：**  使用POC脚本，该脚本会创建包含多个目录遍历层级（`..\`）的RAR压缩包。这些目录遍历层级旨在将Payload文件写入到目标目录，通常是Windows启动目录。
3.  **诱骗用户解压：**  攻击者需要诱骗用户下载并解压这个恶意的RAR压缩包。这通常通过社会工程学手段实现，例如伪装成重要的文档或软件更新。
4.  **执行Payload：**  一旦用户解压了恶意RAR压缩包，Payload文件就会被写入到启动目录。当下一次系统启动时，Payload会被自动执行，从而允许攻击者在目标系统上执行任意代码。

**项目地址:** [Osinskitito499/CVE-2025-8088](https://github.com/Osinskitito499/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)