## CVE-2015-3306 ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露，甚至远程代码执行

**影响版本:** 1.3.5

**利用条件:** mod_copy模块已启用，且攻击者可以访问ProFTPD服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-3306 存在于 ProFTPD 1.3.5 的 mod_copy 模块中。远程攻击者可以通过 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入任意文件。

**有效性：**
根据漏洞信息和搜索结果，该漏洞是真实存在的，并且有公开的漏洞利用代码和 Metasploit 模块可用。提供的 Dockerfile 构建了包含漏洞的 ProFTPD 1.3.5 环境，可以用于验证漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 用于构建易受攻击的环境以进行漏洞验证和利用。提供的`Dockerfile`和`LICENSE`文件本身不包含任何明显的恶意代码或后门。`main.sh`文件内容缺失，如果存在恶意代码，将会在该脚本中。因此，存在投毒的可能性很低。

**利用方式：**
1.  攻击者连接到存在漏洞的 ProFTPD 服务器。
2.  攻击者使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
3.  攻击者使用 `SITE CPTO` 命令指定目标文件路径（可以是任意文件）。
4.  ProFTPD 服务器会复制指定的文件，从而允许攻击者读取或写入任意文件。
5.  通过写入特定文件（例如 `.htaccess`）或上传恶意脚本，攻击者可以进一步执行任意代码。

**项目地址:** [t0kx/exploit-CVE-2015-3306](https://github.com/t0kx/exploit-CVE-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)