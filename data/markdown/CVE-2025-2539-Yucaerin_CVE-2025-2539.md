## CVE-2025-2539-File-Away-未授权任意文件读取

**漏洞编号:** CVE-2025-2539

**漏洞类型:** 未授权任意文件读取

**影响应用:** File Away WordPress 插件

**危害等级:** 高危，可能导致敏感信息泄露，数据库凭据泄露，甚至远程代码执行

**影响版本:** <= 3.9.9.0.1

**利用条件:** 需要目标网站存在File Away插件，且版本小于等于3.9.9.0.1

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2539 存在于 WordPress File Away 插件中，是一个未授权的任意文件读取漏洞。该漏洞是由于插件的 ajax() 函数缺少权限检查，允许未经身份验证的攻击者读取服务器上的任意文件。利用方式如下：

1.  **获取Nonce:** POC代码首先尝试从目标网站的页面中获取nonce值，这是通过正则表达式搜索`fileaway_stats`变量中的`nonce`字段实现的。
2.  **构造Payload:** 攻击者构造一个包含 `action=fileaway-stats`, `nonce=<nonce>`, `file=<filepath>` 的POST请求，发送到 WordPress 的 `admin-ajax.php` 端点。
3.  **利用弱加密算法:** 漏洞描述提到使用了可逆的弱加密算法，但POC代码没有直接体现。攻击者通过指定目标文件，服务器返回加密后的文件内容，该内容可通过该算法进行解密。 
4.  **读取敏感文件:** 攻击者可以利用此漏洞读取 `wp-config.php` 等敏感文件，从而获取数据库凭据。
5.  **数据库连接测试:** POC代码提取数据库用户名、密码和主机名，然后尝试远程连接数据库，验证凭据是否有效。
6.  **PhpMyAdmin 检测:** POC代码会检查目标网站是否存在 phpMyAdmin，并尝试访问，如果存在则记录。

**有效性：**
根据漏洞描述，搜索引擎结果，以及提供的POC代码，可以判断该POC代码是有效的，可以利用该漏洞实现未授权的任意文件读取，并获取数据库凭据。

**投毒风险：**
POC代码存在一定的投毒风险，风险大约为10%。
*   代码中包含远程数据库连接测试，如果目标数据库设置不当，可能会被恶意利用。
*   该脚本会自动检查目标是否存在phpMyAdmin，如果存在则会将地址记录下来，可能会为后续攻击提供信息。
*   result_database.txt，result_phpmyadmin_and_config_valid.txt , result_databaseremotevalid.txt 有可能泄露给其他人,造成信息泄露。
*   该脚本会对目标发起大量请求，可能被目标感知。

**利用方式：**
1.  目标网站必须运行受影响版本的 File Away 插件。
2.  攻击者运行POC脚本，指定目标网站域名列表。
3.  脚本会自动获取nonce，并构造恶意请求，读取指定文件。
4.  脚本会自动提取数据库配置，并尝试连接数据库。
5.  如果成功读取到 `wp-config.php` 并成功连接数据库，则将相关信息保存到文件中。

**项目地址:** [Yucaerin/CVE-2025-2539](https://github.com/Yucaerin/CVE-2025-2539)

**漏洞详情:** [CVE-2025-2539](https://nvd.nist.gov/vuln/detail/CVE-2025-2539)