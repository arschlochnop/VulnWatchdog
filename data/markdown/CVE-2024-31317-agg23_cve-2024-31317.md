## CVE-2024-31317-Android Zygote Deserialization

**漏洞编号:** CVE-2024-31317

**漏洞类型:** 特权提升

**影响应用:** Android

**危害等级:** 高危，可能导致任意代码执行和权限提升

**影响版本:** 12, 12L, 13, 14

**利用条件:** 需要`WRITE_SECURE_SETTINGS`权限和用户执行权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31317 是一个 Android 系统中的特权提升漏洞，存在于 `ZygoteProcess.java` 的多个函数中。由于不安全的反序列化，攻击者可以通过拥有 `WRITE_SECURE_SETTINGS` 权限的应用执行任意代码，模拟任何其他应用程序的身份。

**漏洞利用有效性：**
根据漏洞信息和搜索结果，该漏洞被认为是 Android 用户态中最有价值的漏洞之一。多个来源（如Meta安全博客、dawnslab、flanker017博客）都提供了漏洞分析和利用方法，表明该漏洞的PoC是有效的。

**投毒风险：**
提供的 PoC 代码主要包含漏洞的解释、Zygote 参数说明以及模拟器设置指南，并没有明显的恶意代码。但考虑到代码中可能存在隐藏的后门或未公开的利用方式，例如对系统属性的恶意修改，因此存在一定的投毒风险。风险评估为10%，风险较低但不可忽视。主要风险点在于利用`system`权限执行未知的操作，可能存在隐蔽的恶意行为。

**漏洞利用方式：**
1.  攻击者利用具有 `WRITE_SECURE_SETTINGS` 权限的应用程序。
2.  通过构造特定的 Zygote 启动参数，利用不安全的反序列化漏洞。
3.  使 Zygote 进程以目标应用程序的 UID 和 SELinux 上下文启动一个新的进程。
4.  在新进程中执行恶意代码，从而获得目标应用程序的权限。比如利用`shell`权限可以执行adb shell命令，利用`system`权限可以修改系统属性。

总而言之，漏洞利用依赖于对 Zygote 启动参数的精确构造以及目标 Android 版本的特性。

**项目地址:** [agg23/cve-2024-31317](https://github.com/agg23/cve-2024-31317)

**漏洞详情:** [CVE-2024-31317](https://nvd.nist.gov/vuln/detail/CVE-2024-31317)