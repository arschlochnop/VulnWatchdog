## CVE-2024-57376 - D-Link DSR系列路由器 缓冲区溢出

**漏洞编号:** CVE-2024-57376

**漏洞类型:** 缓冲区溢出

**影响应用:** D-Link DSR-150, DSR-150N, DSR-250, DSR-250N, DSR-500N, DSR-1000N

**危害等级:** 高危，允许未经身份验证的用户执行远程代码执行。

**影响版本:** 3.13 to 3.17B901C

**利用条件:** 需要与受影响的D-Link DSR系列路由器在同一网络，并且可以访问其Web界面。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-57376是D-Link DSR系列路由器中的一个缓冲区溢出漏洞，存在于`duaCP.logout`函数调用的`duaCP.parse_logoutInfo`函数中。`duaCP.parse_logoutInfo`调用了`captivePortalLib.duaLogoutInfoGet`，而`captivePortalLib.duaLogoutInfoGet`中使用`strcpy`将用户提供的`extCpResult`参数复制到栈上的一个固定大小的缓冲区中，没有进行边界检查，导致缓冲区溢出。攻击者可以通过发送特制的HTTP请求，包含精心构造的`extCpResult`参数，覆盖栈上的返回地址，劫持程序执行流程，从而执行任意代码。POC代码通过指定目标主机的IP地址、端口和要执行的命令来利用此漏洞。由于漏洞利用代码直接调用系统命令，如果目标设备允许，可以用来进行渗透测试。仓库中只包含漏洞的说明文档和漏洞利用脚本，没有发现恶意代码或后门，因此投毒风险评估为0%。该漏洞需要相邻网络访问，利用难度低，危害程度高，可能导致路由器被完全控制。

**项目地址:** [DelspoN/CVE-2024-57376](https://github.com/DelspoN/CVE-2024-57376)

**漏洞详情:** [CVE-2024-57376](https://nvd.nist.gov/vuln/detail/CVE-2024-57376)