## CVE-2024-10924-Really Simple Security-身份验证绕过

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress插件

**危害等级:** 高危，未经身份验证的攻击者可以利用此漏洞以任何现有用户的身份（包括管理员）登录。

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点已安装受影响版本的Really Simple Security插件，并且启用了“Two-Factor Authentication”设置（默认为禁用）。即使2FA被禁用，漏洞仍然存在。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10924 是 WordPress Really Simple Security 插件中的一个身份验证绕过漏洞。该漏洞位于两个因素身份验证 (2FA) REST API 操作的 `check_login_and_get_user` 函数中，由于不正确的用户检查错误处理导致。

**利用方式：**

1.  攻击者可以发送特制的 REST API 请求到 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点。
2.  请求中包含目标用户的 `user_id`，一个无效的 `login_nonce`，以及重定向目标 `/wp-admin/`。
3.  由于不正确的错误处理，插件会错误地认为身份验证已成功。
4.  插件设置必要的 cookie，允许攻击者以目标用户的身份登录 WordPress 管理面板。

**投毒风险分析：**

*   `exploit.py` 脚本的功能是利用漏洞，通过发送特制的 POST 请求来绕过身份验证。它没有包含任何明显的恶意代码，例如反向 shell 或数据窃取。
*   `readMe.md` 文件提供了漏洞的概述和使用脚本的说明，没有发现任何可疑内容。
*   投毒风险较低，估计为 5%。 剩余5%的风险来自于作者可能会使用一些比较隐蔽的代码, 例如请求其他远程服务器来执行一些操作, 为了保证分析的准确性, 所以设置了5%的风险值。

**结论：**

提供的漏洞利用代码有效，能够绕过身份验证并允许攻击者以任意用户身份登录。 投毒风险较低。 建议用户尽快升级到 Really Simple Security 插件的最新版本 (9.1.2) 以修复此漏洞。

**项目地址:** [cy3erdr4g0n/CVE-2024-10924](https://github.com/cy3erdr4g0n/CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)