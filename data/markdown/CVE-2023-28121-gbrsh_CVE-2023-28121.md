## CVE-2023-28121-WooCommerce Payments-权限提升

**漏洞编号:** CVE-2023-28121

**漏洞类型:** 权限提升

**影响应用:** WooCommerce Payments WordPress Plugin

**危害等级:** 高危，可使未经身份验证的攻击者获得管理员权限

**影响版本:** <= 5.6.1

**利用条件:** 需要目标站点安装并启用受影响版本的WooCommerce Payments插件，且插件版本低于5.6.2

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-28121 存在于 WooCommerce Payments 插件 5.6.1 及更早版本中。攻击者可以利用此漏洞，通过构造特定的HTTP请求，绕过身份验证，冒充管理员身份执行操作，无需任何凭据即可在 WordPress 站点上创建一个新的管理员账户。根据漏洞利用代码 `exploit.py`，该脚本首先检查目标站点 WooCommerce Payments 插件的版本，如果版本低于 5.6.2，则利用漏洞创建一个新的管理员用户，用户名、密码和邮箱硬编码在脚本中，默认用户名为secragon，密码为OffensiveSecurity123。 该漏洞的利用方式主要是通过 `X-WCPAY-PLATFORM-CHECKOUT-USER` header 绕过身份验证，然后通过 `rest_route` 添加管理员账户。 漏洞利用代码未发现包含恶意或隐藏的投毒代码。

**项目地址:** [gbrsh/CVE-2023-28121](https://github.com/gbrsh/CVE-2023-28121)

**漏洞详情:** [CVE-2023-28121](https://nvd.nist.gov/vuln/detail/CVE-2023-28121)