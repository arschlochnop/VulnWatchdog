## CVE-2021-22986-F5-BIG-IP-iControl-REST-RCE

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP / BIG-IQ

**危害等级:** 高危，可导致完全控制受影响的系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备 iControl REST 接口中的一个未经验证的远程命令执行漏洞。攻击者无需身份验证即可通过构造恶意请求在目标系统上执行任意命令。

**利用方式：**

1.  **直接RCE (poc_1):** 利用PoC代码中的 `poc_1` 函数，通过构造包含恶意命令的 JSON 数据包，发送到目标设备的 `/mgmt/tm/util/bash` 接口。由于漏洞未授权，攻击者可以绕过身份验证，直接执行命令。

2.  **SSRF + RCE (ssrf_poc):** 利用PoC代码中的 `ssrf_poc` 函数，首先利用漏洞存在的SSRF漏洞，通过 `/mgmt/shared/authn/login` 接口获取一个有效的 Token。然后，使用该 Token，结合 `poc_1` 类似的 RCE 方法，在目标设备上执行任意命令。这种方式更隐蔽，也可能绕过一些简单的防御机制。

**投毒风险分析：**

该代码整体结构清晰，主要是实现了漏洞的复现和利用，代码的可读性较强。经过分析，PoC代码中并没有明显的恶意投毒行为。例如，没有发现反弹shell，持续驻留，或者信息搜集等恶意代码。但是该代码存在一定的风险，如果被恶意使用者修改，可能会被植入恶意代码，例如添加反弹shell等功能。因此，判定该仓库存在10%的投毒风险。

**搜索引擎结果印证：**

*   多个来源表明该漏洞在野外被积极利用（例如，Arctic Wolf 的报告）。
*   NCC Group 指出，存在不需要 SSRF 的 PoC，说明该漏洞的利用方式多样。
*   Imperva 的文章提到攻击活动在漏洞披露后激增。

综上所述，该漏洞利用代码有效，风险极高，攻击者可通过多种方式远程控制受影响的F5设备。

**项目地址:** [S1xHcL/f5_rce_poc](https://github.com/S1xHcL/f5_rce_poc)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)