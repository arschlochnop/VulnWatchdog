## CVE-2019-5736-runc容器逃逸

**漏洞编号:** CVE-2019-5736

**漏洞类型:** 容器逃逸

**影响应用:** runc/Docker

**危害等级:** 高危，可导致宿主机root权限获取

**影响版本:** <= 1.0-rc6 (runc), Docker < 18.09.2

**利用条件:** 1. 受影响的runc版本
2. 攻击者可在容器内执行命令 (例如，通过 `docker exec` 访问现有容器或创建新容器)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5736 漏洞允许攻击者通过恶意容器覆盖宿主机上的 `runc` 二进制文件，从而获得宿主机的 root 权限。利用方式如下：

1.  **攻击准备：** 攻击者需要能够在一个存在漏洞的容器中执行代码，或者创建一个新的包含恶意代码的容器镜像。
2.  **文件描述符劫持：** 该漏洞源于 `runc` 在启动容器时对文件描述符的处理不当，特别是 `/proc/self/exe`。
3.  **二进制覆盖：** 容器内的恶意进程会尝试打开 `/proc/self/exe` 并覆盖宿主机上的 `runc` 二进制文件，使用包含恶意指令的payload替换。
4.  **宿主机提权：** 当宿主机执行被覆盖的 `runc` 二进制文件（例如，启动新的容器或执行 `docker exec`）时，攻击者的恶意代码将在宿主机上以 root 权限执行，从而实现容器逃逸。

**有效性评估：**
根据漏洞描述和搜索结果，此漏洞利用的有效性很高，多个PoC代码已被公开，并成功被利用于多种容器环境。

**投毒风险评估：**
提供的“漏洞利用代码”实际上是一个名为“DOSS LAB 02”的威胁建模文件（JSON格式），描述了一些安全威胁，但本身不包含任何可执行的代码。因此，该文件中不存在投毒风险。投毒风险为 0%。真正的漏洞利用代码不在提供的信息中，无法评估其投毒风险。

**利用方式总结：**
该漏洞的利用方式是通过容器内的恶意代码覆盖宿主机上的 `runc` 二进制文件，从而在宿主机上获得 root 权限。攻击者需要能够控制容器内的进程，并利用文件描述符劫持来覆盖 `runc` 二进制文件。

**项目地址:** [shen54/IT19172088](https://github.com/shen54/IT19172088)

**漏洞详情:** [CVE-2019-5736](https://nvd.nist.gov/vuln/detail/CVE-2019-5736)