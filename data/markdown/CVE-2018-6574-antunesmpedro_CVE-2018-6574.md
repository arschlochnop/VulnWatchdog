## CVE-2018-6574 - Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许远程命令执行

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 使用受影响的 Go 版本执行 `go get` 命令获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 允许攻击者通过特制的 Go 代码仓库在目标系统上执行任意命令。当用户使用 `go get` 命令获取包含恶意代码的仓库时，Go 构建系统会执行仓库中嵌入的恶意指令。

**有效性：**

提供的 POC 代码是有效的。`exploit.c` 文件包含一个名为 `malicious` 的函数，该函数使用 `system` 函数执行一个命令，在本例中是调用 `/usr/local/bin/score e105a311-4ea5-435a-89a8-770f2cdd2189`。 `main.go` 文件使用 `#cgo CFLAGS: -fplugin=./exploit.so` 指令，该指令指示 go 编译器将 `exploit.so` 编译为插件，并在程序运行时加载它。因为受影响的 Go 版本没有正确阻止 `-fplugin` 和 `-plugin` 参数，所以这允许执行 `exploit.c` 中的恶意代码。

**投毒风险：**

提供的代码片段本身没有明显的投毒行为。`exploit.c` 执行的命令 `/usr/local/bin/score e105a311-4ea5-435a-89a8-770f2cdd2189`  可能用于完成漏洞利用挑战或者其他目的。该命令不是一个常见的恶意行为，因此不应将其判定为投毒。
整个代码仓库的投毒风险评估为 0%，因为提供的代码段没有任何恶意行为，并且没有迹象表明作者试图隐藏恶意代码。

**利用方式：**

1.  攻击者创建一个包含恶意 `exploit.c` 和 `main.go` 文件的 Go 代码仓库。
2.  `exploit.c` 文件包含需要在目标系统上执行的恶意代码。
3.  `main.go` 文件包含 `#cgo CFLAGS: -fplugin=./exploit.so` 指令，从而利用漏洞。
4.  攻击者诱骗目标用户使用 `go get` 命令获取恶意仓库。
5.  当用户执行 `go get` 命令时，Go 构建系统会编译并加载 `exploit.so` 插件，从而执行 `exploit.c` 中的恶意代码。
6. 目标系统受到攻击，攻击者可以在目标系统上执行任意命令。

**项目地址:** [antunesmpedro/CVE-2018-6574](https://github.com/antunesmpedro/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)