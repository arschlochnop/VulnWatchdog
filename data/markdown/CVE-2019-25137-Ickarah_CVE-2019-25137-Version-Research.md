## CVE-2019-25137 - Umbraco CMS Remote Code Execution

**漏洞编号:** CVE-2019-25137

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Umbraco CMS

**危害等级:** 高危，允许经过身份验证的管理员执行任意代码

**影响版本:** 4.11.8 through 7.15.10, and 7.12.4

**利用条件:** 需要Umbraco CMS管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-25137 是 Umbraco CMS 中的一个 XSLT 注入漏洞。经验证，该漏洞存在于 4.11.8 到 7.15.10 以及 7.12.4 版本的 Umbraco CMS 中。攻击者需要具有管理员权限才能利用此漏洞。漏洞存在于 XSLT Visualizer 网页 (umbraco/developer/Xslt/xsltVisualize.aspx) 中。通过 `msxsl:script` 元素，攻击者可以在 XSLT 转换中嵌入 C# 代码，从而在目标系统上执行任意命令。

**利用方式：**

1.  攻击者需要登录到 Umbraco CMS，并具有管理员权限。
2.  攻击者访问 XSLT Visualizer 页面：`/umbraco/developer/Xslt/xsltVisualize.aspx`
3.  攻击者构造包含恶意 `msxsl:script` 元素的 XSLT Payload，例如提供的 PoC 代码。
4.  攻击者将 Payload 提交到 XSLT Visualizer，服务器会执行 Payload 中的 C# 代码，从而实现远程代码执行。

**投毒风险分析：**

尽管提供的代码片段本身旨在演示 RCE，但需要考虑潜在的投毒风险。由于攻击向量依赖于管理员权限，因此真正的威胁在于具有恶意意图的管理员可能会利用此漏洞进行恶意操作。该存储库本身并不能直接确定投毒风险，但潜在的利用方式可能会被滥用，因此投毒风险评估为 10%。主要风险在于，攻击者可能会修改 XSLT 模板，执行恶意活动，例如安装后门或窃取敏感数据。

**项目地址:** [Ickarah/CVE-2019-25137-Version-Research](https://github.com/Ickarah/CVE-2019-25137-Version-Research)

**漏洞详情:** [CVE-2019-25137](https://nvd.nist.gov/vuln/detail/CVE-2019-25137)