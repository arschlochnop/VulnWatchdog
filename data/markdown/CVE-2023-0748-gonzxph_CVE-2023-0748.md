## CVE-2023-0748 - BTCPayServer Open Redirect

**漏洞编号:** CVE-2023-0748

**漏洞类型:** 开放重定向

**影响应用:** BTCPayServer

**危害等级:** 中危

**影响版本:** < 1.7.6

**利用条件:** 需要用户登录并点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-0748 是 BTCPayServer 1.7.5 及更早版本中存在的开放重定向漏洞。根据提供的POC代码，攻击者可以通过构造包含恶意URL的链接，诱导已登录用户点击。当用户完成某些操作（例如，在恢复种子备份页面确认已备份）后，会被重定向到恶意网站（例如 evil.com）。

**有效性：**

提供的POC代码是有效的，它演示了如何构造一个恶意链接，利用 returnUrl 参数将用户重定向到任意网站。

**投毒风险：**

分析提供的POC代码，该代码主要包含一个README.md文件，其中描述了漏洞利用步骤和一个示例URL。该URL指向一个已知的演示站点，并将用户重定向到`evil.com`。没有发现任何隐藏的、试图在目标系统上执行恶意操作的代码。因此，投毒风险可以认为是0%。

**利用方式：**

1.  攻击者构造一个包含恶意`returnUrl`参数的URL。
2.  攻击者将该恶意URL发送给 BTCPayServer 的已登录用户。
3.  用户点击该恶意URL。
4.  用户在受影响的页面上完成某些操作（根据描述，是在恢复种子备份页面进行操作）。
5.  用户被重定向到 `returnUrl` 参数指定的恶意网站。

**搜索引擎结果分析：**

搜索引擎结果也确认了这是一个开放重定向漏洞，并提供了相关的信息来源（如NVD，Vulners，Aqua Security, CloudDefense.ai）。

**项目地址:** [gonzxph/CVE-2023-0748](https://github.com/gonzxph/CVE-2023-0748)

**漏洞详情:** [CVE-2023-0748](https://nvd.nist.gov/vuln/detail/CVE-2023-0748)