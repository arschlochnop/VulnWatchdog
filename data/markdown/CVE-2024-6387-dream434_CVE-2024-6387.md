## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，目标系统运行受影响的OpenSSH版本，且基于glibc的Linux系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞，可能导致远程代码执行（RCE）或拒绝服务（DoS）。

**有效性评估：**

根据漏洞信息和搜索结果，此漏洞的POC是可用的，并且已经被广泛讨论。漏洞利用代码的脚本主要用于检测目标主机是否运行存在漏洞的OpenSSH版本，利用方式是扫描目标IP的22端口，获取OpenSSH版本信息，并与已知的易受攻击版本进行比较，从而判断目标系统是否存在漏洞。

**投毒风险分析：**

提供的漏洞利用代码（CVE-2024-6387.py）主要用于版本检测，功能相对简单。虽然`README.md`中包含克隆GitHub仓库的操作，但直接分析提供的Python脚本，发现潜在的投毒点在于以下几个方面：

1.  **依赖包风险：** 脚本本身依赖较少，但如果`README.md`引导用户安装额外的依赖包（例如通过`pip install -r requirements.txt`，而`requirements.txt`包含恶意包），则可能存在投毒风险。
2.  **命令执行风险：** `README.md` 中的运行命令 `python CVE-2024-6387.py http://exemple.com` 虽然看起来无害，但如果 `CVE-2024-6387.py` 存在漏洞，允许通过命令行参数执行恶意代码，则存在风险。当前提供的代码没有直接利用命令行参数执行代码的逻辑。
3.  **文件包含风险：** 如果脚本尝试动态加载其他文件（例如配置文件），而这些文件被篡改，则可能存在风险。

鉴于以上分析，以及`README.md`中存在引导用户克隆github仓库的操作，综合判断，存在较低的投毒风险，约为10%。主要基于假设恶意代码可能存在于被克隆仓库的其他文件中，或者存在利用脚本漏洞执行恶意代码的可能。

**漏洞利用方式：**

1.  **版本检测：** 攻击者首先需要确定目标系统上运行的OpenSSH版本是否在受影响的范围内（8.5p1 <= version <= 9.7p1）。
2.  **触发竞争条件：** 攻击者通过与目标SSH服务器建立连接，并在身份验证过程中故意失败，以触发漏洞相关的竞争条件。
3.  **代码执行：** 成功触发竞争条件后，攻击者可以利用该漏洞在目标系统上执行任意代码，通常以root权限执行。

搜索结果也表明，此漏洞允许未经身份验证的远程代码执行，并且影响基于glibc的Linux系统。因此，利用方式的核心在于触发竞争条件并利用glibc的特性来执行恶意代码。

**项目地址:** [dream434/CVE-2024-6387](https://github.com/dream434/CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)