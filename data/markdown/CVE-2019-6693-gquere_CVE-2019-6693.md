## CVE-2019-6693 - FortiOS 硬编码密钥信息泄露

**漏洞编号:** CVE-2019-6693

**漏洞类型:** 信息泄露

**影响应用:** FortiOS

**危害等级:** 中危，可能导致敏感信息泄露，包括用户密码、私钥口令、高可用密码等

**影响版本:** 5.6.9 及以下, 6.0.5 及以下, 6.2.0

**利用条件:** 需要获取 FortiOS 配置备份文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-6693 漏洞源于 FortiOS 在加密配置备份文件中的敏感数据时使用了硬编码的密钥。攻击者如果能够获取到 FortiOS 的配置备份文件，就可以利用该硬编码密钥解密文件中的敏感信息，例如用户密码（管理员密码除外）、私钥口令以及高可用密码（如果设置了）。

**有效性分析：**

根据漏洞描述和提供的漏洞利用代码，该漏洞利用方法有效。`fortigate_decrypt.py` 脚本使用硬编码的密钥 `b'Mary had a littl'` 和从密文派生的 IV（Initialization Vector）来解密配置备份文件中的数据。漏洞影响的版本为 5.6.9 及以下、6.0.5 及以下以及 6.2.0。搜索结果也确认了该漏洞的存在和利用的可能。

**投毒风险分析：**

提供的 `fortigate_decrypt.py` 脚本相对简单，主要功能是使用硬编码密钥解密数据。 经过分析，没有发现作者隐藏的恶意代码或后门，因此认为该仓库的投毒风险较低。

**利用方式：**

1.  **获取配置备份文件：** 攻击者首先需要通过某种方式获取 FortiOS 设备的配置备份文件。这可能涉及未经授权的访问、网络嗅探或利用其他漏洞。
2.  **运行解密脚本：** 攻击者使用提供的 `fortigate_decrypt.py` 脚本，并将配置备份文件中加密的字符串作为参数传递给脚本。
3.  **解密敏感数据：** 脚本使用硬编码的密钥解密数据，并将解密后的内容打印到控制台。
4.  **提取敏感信息：** 攻击者从解密后的数据中提取敏感信息，例如用户密码、私钥口令或高可用密码。

**搜索引擎结果印证：**

搜索结果中，NVD, Rapid7, socradar.io等多个安全厂商都对该漏洞进行了描述和分析。CISA 已将 CVE-2019-6693 添加到其已知被利用漏洞目录（KEV），表明该漏洞已被积极利用。

**排序优先级说明：**

在分析过程中，优先考虑了搜索引擎的结果，因为它们提供了对漏洞的全面概述和验证。漏洞利用代码提供了实际操作的例子，而漏洞库信息提供了漏洞的基本描述和受影响的版本信息。

**项目地址:** [gquere/CVE-2019-6693](https://github.com/gquere/CVE-2019-6693)

**漏洞详情:** [CVE-2019-6693](https://nvd.nist.gov/vuln/detail/CVE-2019-6693)