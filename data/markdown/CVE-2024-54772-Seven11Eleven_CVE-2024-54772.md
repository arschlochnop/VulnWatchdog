## CVE-2024-54772-MikroTik RouterOS 用户名枚举

**漏洞编号:** CVE-2024-54772

**漏洞类型:** 信息泄露/用户名枚举

**影响应用:** MikroTik RouterOS

**危害等级:** 中危，允许攻击者枚举有效用户名

**影响版本:** v6.43.13 through v6.49.13 和 stable v6.43 through v7.17.2

**利用条件:** 需要与Winbox服务建立网络连接，默认端口8291

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-54772 存在于 MikroTik RouterOS 的 Winbox 服务中。此漏洞允许攻击者通过观察使用有效用户名和无效用户名进行连接尝试时的响应大小差异来枚举有效账户。漏洞利用代码（Rust）通过构造特定的请求包并连接到目标 RouterOS 设备的 Winbox 服务端口 (8291) 来实现。代码尝试使用用户名 "admin" 进行连接，并根据响应的字节数判断该用户名是否有效。有效的用户名响应大小为 51 字节，无效的用户名响应大小为 35 字节。 尽管该漏洞本身只是信息泄露，并不能直接执行任意代码，但枚举有效用户名可以为进一步的攻击（例如暴力破解密码）提供便利。 该POC代码只实现了用户名枚举的功能，代码相对简单，潜在的投毒风险较低，但仍然存在一定风险，例如代码作者可能通过其他途径在编译过程中引入恶意代码，或者在代码中加入隐蔽的逻辑，例如记录尝试过的用户名和IP地址等。 因此，投毒风险评估为10%。

**项目地址:** [Seven11Eleven/CVE-2024-54772](https://github.com/Seven11Eleven/CVE-2024-54772)

**漏洞详情:** [CVE-2024-54772](https://nvd.nist.gov/vuln/detail/CVE-2024-54772)