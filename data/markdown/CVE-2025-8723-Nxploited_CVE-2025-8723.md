## CVE-2025-8723-Cloudflare Image Resizing-远程代码执行

**漏洞编号:** CVE-2025-8723

**漏洞类型:** 远程代码执行

**影响应用:** Cloudflare Image Resizing WordPress插件

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.5.6

**利用条件:** 目标网站安装了Cloudflare Image Resizing WordPress插件，且版本小于等于1.5.6，并且允许外部网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-8723是Cloudflare Image Resizing WordPress插件中存在的一个远程代码执行漏洞。未经身份验证的攻击者可以通过向/wp-json/wp/v2/settings/ 端点发送包含恶意PHP代码的POST请求，利用 hook_rest_pre_dispatch() 方法中缺失的身份验证和不充分的清理，将恶意代码注入到服务器，从而执行任意命令。

**有效性分析：**
根据漏洞库信息，该漏洞是由于缺少身份验证和过滤不严造成的，而提供的漏洞利用代码利用了这一点，通过向特定API端点发送精心构造的POST请求来注入恶意PHP代码。代码结构清晰，通过`scan`函数检测目标是否存在漏洞，并使用`exploit_all`函数尝试多种方式进行利用，包括不同的请求头。因此，该POC代码的有效性较高。

**投毒风险分析：**
代码中存在一定投毒的风险，虽然主要逻辑是漏洞利用，但存在以下几点潜在的风险：
*   **随机 User-Agent 和其他 Header:** 虽然 User-Agent 随机化是为了更好地模拟正常请求，但如果恶意修改 User-Agent 列表，可能导致一些异常。
*   **`system()` 函数:**  POC 使用 `system()` 函数执行命令，该函数本身存在安全风险。如果攻击者利用该 POC 执行恶意命令，例如下载并执行其他恶意脚本，可能导致更严重的后果。
*   **尝试多种 Header 的方式:** 代码中尝试使用不同的请求头组合来绕过防御机制，这本身没有问题，但攻击者可以修改这些header增加恶意负载。综上所述，代码本身主要是漏洞利用，潜在的投毒风险主要在于使用时可能引入恶意负载，风险比例较低。占比估算5%。

**利用方式：**
1.  **漏洞检测：**  首先使用 `scan` 函数检测目标WordPress网站是否安装了易受攻击的Cloudflare Image Resizing插件，并且版本是否小于等于1.5.6。这是通过访问 `readme.txt` 文件并提取版本信息来实现的。
2.  **漏洞利用：**  如果目标易受攻击，则使用 `exploit_all` 函数尝试利用该漏洞。该函数会尝试不同的HTTP Header，并通过向 `/wp-json/wp/v2/settings/` 端点发送POST请求，在 `cf_image_resizing_fit` 参数中注入恶意PHP代码。注入的PHP代码使用 `system()` 函数来执行指定的命令。
3.  **代码执行：**  如果注入成功，服务器将执行恶意代码，并将结果返回到响应中。

**搜索结果分析：**
搜索结果中包含了一些其他的CVE，但只有标题为"CVE-2025-8723 Cloudflare Image Resizing Plugin ..."的条目与本次分析的漏洞相关。这表明该漏洞已经被公开披露，并且受到了一定的关注。

**项目地址:** [Nxploited/CVE-2025-8723](https://github.com/Nxploited/CVE-2025-8723)

**漏洞详情:** [CVE-2025-8723](https://nvd.nist.gov/vuln/detail/CVE-2025-8723)