## CVE-2025-20282-Cisco ISE API未授权远程代码执行

**漏洞编号:** CVE-2025-20282

**漏洞类型:** 远程代码执行

**影响应用:** Cisco Identity Services Engine

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** 3.4.0, 3.4 Patch 1

**利用条件:** 需要能够访问Cisco ISE设备的网络

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，该漏洞允许未经身份验证的远程攻击者向受影响的设备上传任意文件，并在底层操作系统上以root权限执行这些文件。POC代码（/tmp/8d021840fe1b3735f05de2adcae1b64e/CVE-2025-20282 - v2.py）通过利用文件上传漏洞，上传恶意文件到目标系统，并执行任意命令。

**有效性：**
POC代码看起来有效，因为它利用了未授权的文件上传和代码执行漏洞。该脚本接受目标IP地址和要执行的命令作为参数，表明其目的是实现远程代码执行。

**投毒风险：**
该代码包含一些可疑部分，增加了投毒的可能性。以下是详细的分析：

1.  代码首先导入了必要的库，如`os`, `base64`, `zipfile`, `subprocess`, 和 `argparse`。这本身没有问题。
2.  使用了`argparse`模块接收命令行参数，允许攻击者指定要执行的命令和目标IP地址。这也是正常的漏洞利用流程。
3.  `isehourlycron`变量包含一个看起来像是Cisco ISE的原始定时任务脚本的字符串。这个脚本本身看起来是良性的，用于执行一些清理任务，例如清理undo表空间。
4.  该脚本尝试清理数据库undo表空间。

**潜在的投毒点：**

*   脚本主要功能是上传恶意文件并执行命令, 但是脚本中包含了大量的oracle数据库操作的代码, 如果攻击者能通过此漏洞执行任意代码,那么也会获取数据库的控制权限.
*   脚本逻辑比较复杂，在undo表空间清理时, 存在一定的概率会清理失败, 造成数据库的数据丢失, 从而影响ISE的正常使用.

总的来说，尽管代码的大部分看起来与漏洞利用相关，但还是存在恶意代码的可能性。因此，投毒风险评估为10%。

**利用方式：**

1.  攻击者使用POC脚本，提供目标Cisco ISE设备的IP地址和要执行的恶意命令。
2.  POC脚本利用未授权的文件上传漏洞，将包含恶意命令的脚本上传到目标设备上的特权目录。
3.  脚本执行上传的恶意代码，以root权限运行指定的命令。
4.  攻击者获得对Cisco ISE设备的完全控制权，可以执行任意操作。

**项目地址:** [skadevare/CiscoISE-CVE-2025-20282-POC](https://github.com/skadevare/CiscoISE-CVE-2025-20282-POC)

**漏洞详情:** [CVE-2025-20282](https://nvd.nist.gov/vuln/detail/CVE-2025-20282)