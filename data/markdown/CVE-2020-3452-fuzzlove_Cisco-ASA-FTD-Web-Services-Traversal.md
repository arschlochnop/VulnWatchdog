## CVE-2020-3452 Cisco ASA/FTD Web Services Read-Only Path Traversal

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，允许未授权远程攻击者读取敏感文件

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用了WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452是一个存在于Cisco ASA和FTD软件Web服务接口中的只读路径遍历漏洞。由于缺乏对HTTP请求中URL的适当输入验证，未经身份验证的远程攻击者可以通过发送特制的HTTP请求，利用目录遍历字符序列读取目标系统上的敏感文件。该漏洞利用依赖于目标设备启用了WebVPN或AnyConnect功能，因为这会启用Web服务文件系统。攻击者无法通过此漏洞访问ASA或FTD系统文件或底层操作系统文件。

**有效性：** 提供的PoC代码似乎有效。它通过构造包含目录遍历序列的HTTP GET请求来尝试读取目标设备上的文件。PoC会读取`cisco_asa_file_list.txt`中定义的一系列文件。

**投毒风险：**  代码未发现存在明显的恶意行为或后门。该脚本的主要功能是利用漏洞，并且没有证据表明该脚本试图执行任何未经授权的操作，例如修改系统设置或传播恶意软件。其中文件读取操作是漏洞本身的性质。

**利用方式：** 攻击者需要向目标Cisco ASA/FTD设备的Web服务接口发送特制的HTTP GET请求，该请求的URL包含目录遍历序列（例如，`../`）。PoC代码通过构造`/+CSCOT+/translation-table` URL并使用`type`、`textdomain`、`default-language`和`lang`参数发送请求来实现这一点。`textdomain`参数包含要读取的文件名，`lang`参数包含目录遍历序列。如果目标设备易受攻击，攻击者将能够读取Web服务文件系统中的任意文件。

**项目地址:** [fuzzlove/Cisco-ASA-FTD-Web-Services-Traversal](https://github.com/fuzzlove/Cisco-ASA-FTD-Web-Services-Traversal)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)