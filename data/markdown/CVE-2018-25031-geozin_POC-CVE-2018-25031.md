## CVE-2018-25031-Swagger UI-信息泄露/欺骗

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 信息泄露/欺骗 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露和用户欺骗

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于Swagger UI 4.1.2及更早版本中。攻击者可以通过诱使用户打开特制的URL，从而显示远程的OpenAPI定义，达到欺骗的目的。该漏洞的利用方式主要是通过`configUrl`或`url`参数加载恶意的JSON或YAML文件，这些文件指向攻击者控制的服务器。当用户在Swagger UI界面中与API交互，例如输入授权码并点击“Execute”时，恶意YAML文件会将其发送到攻击者指定的URL，从而窃取用户的授权码。根据提供的POC代码，`doc.yaml`文件中的`host`字段被设置为`<ATTACKER URL>`，这就是攻击者接收用户数据的地方。

**有效性:** 提供的POC代码有效，可以重现该漏洞，实现攻击目标。

**投毒风险:** 代码本身是一个POC，用于演示漏洞利用。主要的风险在于，攻击者可能将恶意的YAML文件托管在看似可信的域名下，诱骗用户加载。`doc.yaml`文件中存在一个名为`<LINK>`的占位符。如果作者在示例中添加了恶意链接，可能会引导用户访问钓鱼网站或执行其他恶意操作。例如, 可以在描述中插入一段JavaScript代码，尝试窃取用户的Cookie或者执行其他客户端攻击。因此，存在轻微的投毒风险。因为该代码作者的主要目的是为了重现漏洞，展示攻击过程，而不是为了隐蔽地植入恶意代码。因此，投毒风险较低，估计为10%。

**利用方式:**
1.  攻击者构造包含恶意`configUrl`或`url`参数的URL，指向攻击者控制的JSON或YAML文件。
2.  攻击者将恶意URL发送给受害者，诱使其点击。
3.  受害者打开URL后，Swagger UI加载攻击者指定的OpenAPI定义。
4.  受害者在Swagger UI界面中输入授权码等敏感信息，并执行API调用。
5.  恶意YAML文件将受害者输入的敏感信息发送到攻击者指定的URL。
6.  攻击者获取受害者的敏感信息。

**项目地址:** [geozin/POC-CVE-2018-25031](https://github.com/geozin/POC-CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)