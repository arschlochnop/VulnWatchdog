## CVE-2023-32070-XWiki-XSS

**漏洞编号:** CVE-2023-32070

**漏洞类型:** XSS（跨站脚本）

**影响应用:** XWiki

**危害等级:** 高危，可能导致用户凭证泄露、恶意代码执行、页面内容篡改等

**影响版本:** < 14.6-rc-1, <= 3.0-milestone-2

**利用条件:** 需要用户交互（点击恶意链接或浏览包含恶意代码的页面），攻击者需要有权限在XWiki页面中插入恶意代码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32070 是 XWiki Rendering 模块中存在的跨站脚本漏洞。由于HTML渲染器未对危险属性/属性值进行充分检查，攻击者可以通过在属性和链接URL（例如，XWiki语法支持的）中插入恶意脚本来执行XSS攻击。

**有效性评估：**
根据漏洞信息，POC 的有效性较高，因为漏洞描述明确指出 HTML 渲染器未充分检查危险属性，允许 XSS 攻击。搜索引擎结果也证实了该漏洞的存在，并提供了相关细节。

**投毒风险评估：**
提供的漏洞利用代码看起来是 Jenkinsfile 和相关 LICENSE 文件，主要用于 XWiki 的构建、测试和质量检查流程。虽然此代码本身不是漏洞利用程序，但如果攻击者能够篡改此 Jenkinsfile 并将其用于构建过程，则有可能植入恶意代码。此外，`build job: "../xwiki-platform/${env.BRANCH_NAME}", wait: false`可能存在风险，如果`BRANCH_NAME`可控，则可能构建恶意的分支。该风险并非直接的 XSS 利用，而是供应链攻击的一种形式。 考虑到此仓库更多是构建脚本，因此投毒风险较低，估计为 10%。

**利用方式：**
1.  **攻击者需要有权限编辑 XWiki 页面或以某种方式将恶意代码注入到 XWiki 的存储中。**
2.  **攻击者在 XWiki 页面中插入包含恶意 JavaScript 代码的 HTML 标签或属性。** 例如，使用 `<a>` 标签的 `href` 属性，或者 `<img>` 标签的 `onerror` 属性。
3.  **当用户访问包含恶意代码的页面时，恶意脚本将在用户的浏览器中执行。** 这可能导致会话劫持、凭证窃取、页面重定向或其他恶意行为。

**修复建议：**
升级到 XWiki 14.6-rc-1 或更高版本，这些版本修复了此漏洞。

**项目地址:** [shoucheng3/xwiki__xwiki-rendering_CVE-2023-32070_14-5](https://github.com/shoucheng3/xwiki__xwiki-rendering_CVE-2023-32070_14-5)

**漏洞详情:** [CVE-2023-32070](https://nvd.nist.gov/vuln/detail/CVE-2023-32070)