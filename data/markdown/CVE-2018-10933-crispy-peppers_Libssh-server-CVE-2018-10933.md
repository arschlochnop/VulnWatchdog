## CVE-2018-10933 - libssh 认证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问

**影响版本:** 0.6 - 0.7.5, 0.8.0 - 0.8.3

**利用条件:** 目标服务器使用受影响的libssh版本且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-10933 是 libssh 中的一个认证绕过漏洞。攻击者可以通过向服务器发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，而无需进行实际的身份验证过程，从而绕过身份验证。从漏洞库信息和搜索引擎结果来看，该漏洞允许未经身份验证的远程攻击者在目标系统上执行操作。提供的 `exploit.py` 脚本利用了此漏洞。脚本通过建立socket连接, 发送特制的`SSH2_MSG_USERAUTH_SUCCESS`消息欺骗服务器，然后打开一个会话并执行命令。由于该脚本直接利用漏洞，没有发现隐藏的恶意代码，因此投毒风险较低。利用方式如下：

1.  建立与目标libssh服务器的TCP连接。
2.  初始化paramiko transport.
3.  发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息绕过认证。
4.  打开一个新的会话。
5.  执行任意命令。
6.  读取命令输出。

根据漏洞信息和利用代码分析，POC代码有效，该漏洞的利用主要依赖于向服务器发送特定的认证成功消息，从而绕过正常的身份验证流程。

**项目地址:** [crispy-peppers/Libssh-server-CVE-2018-10933](https://github.com/crispy-peppers/Libssh-server-CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)