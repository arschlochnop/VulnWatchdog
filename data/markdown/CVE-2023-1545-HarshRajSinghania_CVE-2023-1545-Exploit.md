## CVE-2023-1545-Teampass-SQL注入

**漏洞编号:** CVE-2023-1545

**漏洞类型:** SQL注入

**影响应用:** Teampass

**危害等级:** 高危，可能导致敏感信息泄露，如用户名和密码

**影响版本:** < 3.0.0.23

**利用条件:** 需要目标Teampass实例开启API功能且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2023-1545是Teampass 3.0.0.23之前的版本中存在的SQL注入漏洞。POC代码通过构造恶意的`login`参数，利用UNION SELECT语句将攻击者注入的SQL查询结果与合法查询结果合并，从而绕过身份验证，提取数据库中的敏感信息，如用户名和密码哈希。该POC首先检查API功能是否启用，然后构造一个包含恶意SQL注入的JSON payload发送到`/api/index.php/authorize`，利用`jq`和`base64`解码从响应中提取所需数据。对于投毒风险，该脚本主要功能是利用SQL注入漏洞提取用户名和密码哈希，并未发现明显的后门或恶意代码。但依然需要谨慎使用从网络获取的代码，存在极小可能性通过依赖引入恶意代码，因此预估投毒概率为10%。利用方式总结：

1.  **检测API状态：** 使用curl检测Teampass实例是否启用了API功能。
2.  **构造恶意SQL注入：** 通过修改`login`参数，注入SQL语句，绕过身份验证。
3.  **提取数据：** 使用curl发送构造好的JSON payload，然后利用`jq`和`base64`解码提取敏感信息。

**项目地址:** [HarshRajSinghania/CVE-2023-1545-Exploit](https://github.com/HarshRajSinghania/CVE-2023-1545-Exploit)

**漏洞详情:** [CVE-2023-1545](https://nvd.nist.gov/vuln/detail/CVE-2023-1545)