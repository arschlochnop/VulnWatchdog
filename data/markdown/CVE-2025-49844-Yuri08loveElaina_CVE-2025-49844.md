## CVE-2025-49844 - Redis Lua Use-After-Free Remote Code Execution

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** Critical，远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器开启Lua脚本功能，且攻击者拥有执行EVAL/EVALSHA命令的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Redis的Lua脚本解析器中。攻击者可以通过精心构造的Lua脚本，操纵垃圾回收器，触发use-after-free漏洞，最终导致远程代码执行。

**有效性：**
根据漏洞库信息和提供的POC代码，该漏洞的利用是可行的。POC代码提供了一个`redis_exploit.py`脚本，声称可以绕过安全保护机制，利用Lua解释器中的UAF漏洞执行任意shellcode并建立持久后门。漏洞库信息也确认了该漏洞的存在，并给出了修复版本。

**投毒风险：**
虽然POC自称可以绕过各种安全机制，但提供的代码片段并不完整，无法完全评估。初步分析`redis_exploit.py`代码片段，发现引入了`colorama`模块，虽然这个模块本身功能是用于控制台输出颜色，但如果作者在其他未提供的代码部分中，利用这个模块与其他库结合，实现一些隐蔽的操作，理论上存在一定的投毒风险。同时，作者ID“Yuri08loveElaina”略显可疑，有可能是故意使用二次元风格的ID来掩盖恶意行为。综合评估，投毒风险在10%左右。如果完整代码可用，可进行更详细的分析。

**利用方式：**
利用方式主要分为以下几个步骤：

1.  **连接目标Redis服务器：** 使用提供的`redis_exploit.py`脚本连接到目标Redis服务器，可能需要提供密码。
2.  **利用Lua脚本触发UAF漏洞：** 攻击者发送特制的Lua脚本到Redis服务器，这些脚本包含导致内存损坏的指令。这些特制的Lua脚本，通常会操纵Lua的垃圾回收机制。
3.  **执行任意代码：** 成功触发UAF漏洞后，攻击者可以控制程序执行流程，注入并执行shellcode，从而获得服务器的控制权。
4.  **建立持久后门（可选）：** 攻击者可以选择在服务器上建立持久后门，以便在将来重新获得访问权限。

**总结：**
CVE-2025-49844是一个严重的漏洞，允许攻击者远程执行代码。如果Redis服务器启用了Lua脚本功能，且没有进行适当的访问控制，则很容易受到攻击。建议尽快升级到修复版本或采取缓解措施，例如使用ACL限制EVAL和EVALSHA命令的执行。

**项目地址:** [Yuri08loveElaina/CVE-2025-49844](https://github.com/Yuri08loveElaina/CVE-2025-49844)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)