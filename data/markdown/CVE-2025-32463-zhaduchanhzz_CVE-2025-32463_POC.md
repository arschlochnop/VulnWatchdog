## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户访问权限，需要存在sudo命令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是Sudo中一个本地提权漏洞。该漏洞源于Sudo在处理`--chroot`选项时，允许用户控制的目录下的`/etc/nsswitch.conf`被使用。攻击者可以利用这个漏洞，通过创建一个恶意的`/etc/nsswitch.conf`文件，欺骗Sudo加载恶意共享对象，从而执行任意代码并获得root权限。

**有效性：**
提供的POC代码利用了该漏洞，通过创建一个包含恶意代码的动态链接库，并使用`--chroot`选项指定包含自定义`nsswitch.conf`文件的目录，成功实现了提权。Dockerfile构建了一个包含漏洞版本的Sudo和所需依赖的Ubuntu环境，验证代码的有效性。

**投毒风险：**
代码整体是为了利用漏洞进行提权，本身即为利用。存在一定的投毒风险，比如作者可以修改`woot1337.c`中的代码，在提权的同时执行一些恶意操作，如添加后门用户。但从目前的代码来看，主要目的是展示漏洞利用，相对干净。 投毒风险比例评估为10%， 因为作者可能在`woot1337.c`里面植入其他的后门代码.

**利用方式：**
1.  创建一个包含恶意代码的C文件 (`woot1337.c`)，该文件在被加载时会执行提权操作。
2.  将该C文件编译成动态链接库 (`libnss_/woot1337.so.2`)。
3.  创建一个包含指向恶意动态链接库的`nsswitch.conf`文件 (`woot/etc/nsswitch.conf`)。
4.  使用`sudo -R woot woot`命令，其中`woot`目录包含了恶意`nsswitch.conf`，使得Sudo在chroot环境下加载恶意动态链接库，从而执行提权代码。


**项目地址:** [zhaduchanhzz/CVE-2025-32463_POC](https://github.com/zhaduchanhzz/CVE-2025-32463_POC)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)