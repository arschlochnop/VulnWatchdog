## CVE-2025-54793-Astro-Open Redirect

**漏洞编号:** CVE-2025-54793

**漏洞类型:** Open Redirect

**影响应用:** Astro

**危害等级:** 中危，可能导致用户重定向到恶意网站，增加钓鱼和社会工程攻击的风险

**影响版本:** >= 5.2.0, < 5.12.8

**利用条件:** 需要站点使用on-demand rendering (SSR) with the Node或Cloudflare adapters，并且双斜杠功能未被禁用

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-54793是Astro框架中的一个开放重定向漏洞。当站点配置为使用Node或Cloudflare适配器的服务器端渲染(SSR)时，且未禁用双斜杠功能，攻击者可以通过构造包含双斜杠的URL（例如，`https://mydomain.com//malicious-site.com/`）将用户重定向到任意外部域名。

**有效性：**
从漏洞库信息来看，该漏洞已发布，并且提供了PoC的引用链接（github security advisories），表明该漏洞是真实存在的并且可以利用。 
根据检索结果，未发现与此CVE相关的更详细的利用方式，利用有效性难以确定。

**投毒风险：**
提供的PoC代码 `/tmp/c72b2c083f712831c80d02975000f120/README.md` 只是一个简单的README文件，描述了该项目的目的，即CVE-2025-54793的检测与缓解。 代码本身不包含任何恶意代码或者后门， 但不排除整个仓库中包含其他恶意代码的可能性，所以投毒风险较低，估计为5%。

**利用方式：**
1.  攻击者构造包含双斜杠的恶意URL：`https://mydomain.com//malicious-site.com/`。
2.  用户点击或访问该恶意URL。
3.  Astro应用程序在处理该URL时，由于trailing slash redirection逻辑缺陷，会将用户重定向到`malicious-site.com`。
4.  攻击者可以在`malicious-site.com`上进行钓鱼或其他恶意活动，例如窃取用户凭据。

**缓解措施：**
1.  升级Astro版本到5.12.8或更高版本。
2.  在网络层面，阻止以`//`开头的Location header值的传出重定向响应。


**项目地址:** [Bhuvanesh-Murdoch2005/ict279-cve-2025-54793](https://github.com/Bhuvanesh-Murdoch2005/ict279-cve-2025-54793)

**漏洞详情:** [CVE-2025-54793](https://nvd.nist.gov/vuln/detail/CVE-2025-54793)