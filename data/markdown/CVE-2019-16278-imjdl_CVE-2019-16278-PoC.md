## CVE-2019-16278-Nostromo-nhttpd-目录遍历和远程代码执行

**漏洞编号:** CVE-2019-16278

**漏洞类型:** 目录遍历和远程代码执行

**影响应用:** nostromo nhttpd

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.9.6

**利用条件:** 需要目标服务器运行nostromo nhttpd并且能够通过网络访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-16278 漏洞存在于 nostromo nhttpd 1.9.6 及更早版本中。该漏洞是由于 `http_verify` 函数中存在目录遍历漏洞，攻击者可以通过构造特制的 HTTP 请求，利用目录遍历读取服务器上任意文件，甚至执行任意命令。

**有效性：**
提供的PoC代码 `PoC.py` 利用了该目录遍历漏洞，通过构造包含 `/.%0d./` 的路径，绕过服务器的安全检查，最终执行命令。PoC代码通过发送特制的POST请求到目标服务器，在请求体中包含要执行的命令。通过socket连接目标服务器，然后构造payload发送，最后接受服务器返回的内容。

**投毒风险：**
虽然PoC代码本身的功能是利用漏洞，但仓库中存在投毒风险的可能性较低，大约为5%。风险主要来源于作者是否在代码中添加了额外的恶意功能。查看`PoC.py`脚本，该脚本没有明显的后门或者恶意代码。`README.md` 文件内容指向了漏洞的参考链接，没有发现异常。

**利用方式：**
1.  攻击者需要确定目标服务器正在运行受影响版本的 nostromo nhttpd。
2.  攻击者使用 PoC 代码，指定目标服务器的 IP 地址或域名，以及端口号。
3.  PoC 代码会构造一个包含目录遍历的 HTTP 请求，发送到目标服务器。
4.  服务器处理请求时，由于漏洞的存在，会执行攻击者指定的命令。
5.  攻击者可以获得命令执行的结果，从而控制服务器。

**项目地址:** [imjdl/CVE-2019-16278-PoC](https://github.com/imjdl/CVE-2019-16278-PoC)

**漏洞详情:** [CVE-2019-16278](https://nvd.nist.gov/vuln/detail/CVE-2019-16278)