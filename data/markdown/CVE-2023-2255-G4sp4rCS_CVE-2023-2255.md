## CVE-2023-2255-LibreOffice-远程资源加载

**漏洞编号:** CVE-2023-2255

**漏洞类型:** 权限、特权和访问控制

**影响应用:** LibreOffice

**危害等级:** 中危，可能导致信息泄露和远程代码执行

**影响版本:** 7.4 (小于 7.4.7), 7.5 (小于 7.5.3)

**利用条件:** 用户需要打开恶意构造的ODT文档

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-2255 漏洞存在于 LibreOffice 的编辑器组件中，由于不正确的访问控制，攻击者可以创建一个恶意文档，导致外部链接在未经提示的情况下加载。此漏洞利用方式为攻击者诱使用户打开一个包含恶意 Floating Frame 的 ODT 文档，该 Floating Frame 链接到外部资源。由于 LibreOffice 在受影响的版本中不会提示用户，外部资源会被自动加载，从而导致信息泄露或远程代码执行。

提供的 POC 代码包含两个 Python 脚本：`exploit.py` 和 `payload.py`。

*   `exploit.py` 脚本负责生成恶意的 ODT 文档。它将 `payload.py` 脚本的内容嵌入到 ODT 文档的 `content.xml` 文件中，并创建一个包含 `manifest.xml` 文件的 ZIP 压缩包，然后将压缩包重命名为 `.odt` 格式。

*   `payload.py` 脚本包含实际的攻击代码，该代码使用 `os.system` 函数执行系统命令。在本例中，它尝试创建一个名为“hacker”的用户，设置密码为“P@ssw0rd”，并将其添加到“Administrators”本地组。

**有效性：**
根据漏洞信息和提供的POC代码，可以判断POC代码有效。该POC利用了LibreOffice对外部链接处理的缺陷，在用户打开恶意ODT文档时，自动执行嵌入的Python脚本，从而可能实现远程命令执行。

**投毒风险：**
代码中没有发现明显的投毒行为。`payload.py` 脚本的功能是将用户添加到管理员组，虽然本身是恶意行为，但这是漏洞利用的一部分，而非额外的投毒代码。 `exploit.py` 的作用是构造包含payload的odt文件,也没有发现有额外的投毒代码。因此，投毒风险为0%。

**利用方式：**

1.  攻击者编写一个恶意 Python 脚本（payload），例如 `payload.py`，该脚本包含攻击代码（例如，下载恶意文件，执行命令等）。
2.  攻击者使用 `exploit.py` 脚本将 `payload.py` 的内容嵌入到 ODT 文档中。
3.  攻击者诱使用户打开生成的恶意 ODT 文档。
4.  当用户打开文档时，LibreOffice 会自动加载外部链接，执行嵌入的 Python 脚本，从而实现攻击。


**项目地址:** [G4sp4rCS/CVE-2023-2255](https://github.com/G4sp4rCS/CVE-2023-2255)

**漏洞详情:** [CVE-2023-2255](https://nvd.nist.gov/vuln/detail/CVE-2023-2255)