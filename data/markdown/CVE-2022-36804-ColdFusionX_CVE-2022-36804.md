## CVE-2022-36804-Bitbucket-命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server 和 Data Center

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 <= version < 7.6.17, 7.7.0 <= version < 7.17.10, 7.18.0 <= version < 7.21.4, 8.0.0 <= version < 8.0.3, 8.1.0 <= version < 8.1.3, 8.2.0 <= version < 8.2.2, 8.3.0 <= version < 8.3.1

**利用条件:** 需要对公共仓库的访问权限或对私有仓库的读取权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-36804 是 Atlassian Bitbucket Server 和 Data Center 中多个 API 端点存在的一个命令注入漏洞。攻击者通过发送特制的 HTTP 请求，可以利用 `git archive` 命令的 `--exec` 参数注入恶意命令，从而实现远程代码执行。根据漏洞利用代码，攻击者需要在URL中插入经过编码的恶意参数，从而执行任意命令。例如，可以使用 `id` 命令来验证漏洞，或者使用 `cat /etc/passwd` 命令来读取服务器上的敏感文件。风险在于POC中可能存在隐蔽的下载脚本,或者包含其他恶意连接. 因此评估投毒风险为5%。

**项目地址:** [ColdFusionX/CVE-2022-36804](https://github.com/ColdFusionX/CVE-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)