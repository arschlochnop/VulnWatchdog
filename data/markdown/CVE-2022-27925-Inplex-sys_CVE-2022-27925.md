## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/任意文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可导致任意文件写入和远程代码执行

**影响版本:** 8.8.15, 9.0

**利用条件:** 需要管理员权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925 漏洞存在于 Zimbra Collaboration Suite (ZCS) 8.8.15 和 9.0 的 mboximport 功能中。该功能允许经过身份验证并具有管理员权限的用户上传 ZIP 压缩包，并从中提取文件。由于未对压缩包中的文件名进行充分的路径验证，攻击者可以构造包含恶意路径的压缩包，从而将任意文件写入服务器的任意位置。根据搜索结果，该漏洞已被大规模利用，甚至存在绕过身份验证的利用方式（虽然漏洞描述本身需要管理员权限）。漏洞利用代码中仅包含Apache License 2.0许可协议，没有发现潜在的投毒代码。

**利用方式：**

1.  攻击者需要拥有 Zimbra ZCS 的管理员账户权限（原始漏洞描述）。但根据搜索结果，存在身份验证绕过方法，攻击者可能无需管理员权限即可利用。
2.  攻击者创建一个恶意的 ZIP 压缩包，该压缩包中的文件名包含路径遍历字符串 (例如 `../../../path/to/target/file`)。
3.  攻击者使用 mboximport 功能上传该 ZIP 压缩包。
4.  Zimbra ZCS 解压该压缩包，并将文件写入攻击者指定的任意位置。

通过写入恶意文件（例如 webshell）到 Web 服务器的可访问目录，攻击者可以实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-27925](https://github.com/Inplex-sys/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)