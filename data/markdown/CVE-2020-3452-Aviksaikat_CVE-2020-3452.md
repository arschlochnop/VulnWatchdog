## CVE-2020-3452 Cisco ASA/FTD 目录遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA 和 Firepower Threat Defense (FTD) 软件

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 受影响版本包括但不限于 9.6.4.42 之前, 9.8.4.20 之前, 9.9.2.74 之前, 9.10.1.42 之前, 9.13.1.10 之前, 以及 9.14.1.10 之前。

**利用条件:** 目标设备需要启用 WebVPN 或 AnyConnect 功能。需要网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452 存在于 Cisco ASA 和 FTD 软件的 Web 服务接口中。由于对 HTTP 请求中的 URL 缺乏适当的输入验证，未经身份验证的远程攻击者可以利用目录遍历攻击读取目标系统上的敏感文件。该漏洞存在于 Web 服务文件系统中，该系统在配置 WebVPN 或 AnyConnect 功能时启用。通过发送包含目录遍历字符序列的特制 HTTP 请求，攻击者可以读取 Web 服务文件系统中的任意文件，但无法访问 ASA 或 FTD 系统文件或底层操作系统文件。

该 POC 代码 `cve-2020-3452.py` 脚本通过构造包含目录遍历字符的 URL (`/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../`) 来尝试利用此漏洞。它发送带有特制 User-Agent 头的 HTTP GET 请求到目标，并检查响应状态码是否为 200 以及响应内容是否包含 `dofile` 和 `common.lua` 字符串，以判断目标是否存在漏洞。

投毒风险评估：该代码主要用于验证漏洞的存在，没有发现恶意后门或者植入木马行为，因此投毒风险评估为 0%。

利用方式总结：
1. 目标系统需启用 WebVPN 或 AnyConnect 功能。
2. 攻击者构造包含目录遍历字符的恶意 URL。
3. 攻击者发送 HTTP GET 请求到目标。
4. 如果目标存在漏洞，攻击者可以读取 Web 服务文件系统中的文件。

**项目地址:** [Aviksaikat/CVE-2020-3452](https://github.com/Aviksaikat/CVE-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)