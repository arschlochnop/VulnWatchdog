## CVE-2009-2265-FCKeditor文件上传/目录遍历

**漏洞编号:** CVE-2009-2265

**漏洞类型:** 文件上传/目录遍历

**影响应用:** FCKeditor (集成于ColdFusion)

**危害等级:** 高危，允许远程攻击者创建可执行文件并执行任意代码

**影响版本:** < 2.6.4.1

**利用条件:** 目标系统需要运行存在漏洞的FCKeditor版本，且允许通过web访问/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于FCKeditor 2.6.4.1之前的版本中，由于未充分过滤用户输入，允许远程攻击者通过目录遍历的方式，将恶意JSP文件上传到服务器的任意目录，从而执行任意代码。利用方式是通过修改HTTP请求中的`CurrentFolder`参数，使用`..`序列绕过文件上传路径的限制。POC代码`2265.py`首先接收目标IP、端口、payload文件路径以及ColdFusion的basepath作为参数。然后读取payload文件内容，payload通常是JSP shell。接着，构造一个包含恶意目录遍历的URL，并通过POST请求将payload文件上传到服务器。服务器会把上传的文件保存到`userfiles/file`目录下。最后，攻击者通过访问上传的JSP文件，触发恶意代码，实现远程代码执行。代码本身没有发现明显的投毒迹象, 因为该EXP的目的就是上传文件，所以payload是必需的，需要使用者自己构建，该EXP不会构建Payload，风险较小。

**项目地址:** [zaphoxx/zaphoxx-coldfusion](https://github.com/zaphoxx/zaphoxx-coldfusion)

**漏洞详情:** [CVE-2009-2265](https://nvd.nist.gov/vuln/detail/CVE-2009-2265)