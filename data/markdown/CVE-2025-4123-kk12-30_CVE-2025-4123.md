## CVE-2025-4123-Grafana-XSS/SSRF

**漏洞编号:** CVE-2025-4123

**漏洞类型:** 跨站脚本 (XSS)/服务器端请求伪造 (SSRF)

**影响应用:** Grafana

**危害等级:** 高危，可能导致任意JavaScript执行、SSRF、敏感信息泄露、账户接管

**影响版本:** < 10.4.19, < 11.2.10, < 11.3.7, < 11.4.5, < 11.5.5, < 11.6.2, < 12.0.1

**利用条件:** 需要用户交互 (点击恶意链接)，若匿名访问开启则无需身份验证。安装Grafana Image Renderer插件则可能触发SSRF。

**POC 可用性:** 是，但提供的POC代码过于简略，仅包含README，需要自行构造完整的POC

**投毒风险:** 10%

## 详情

CVE-2025-4123是Grafana中的一个高危漏洞，它结合了客户端路径遍历和开放重定向，导致跨站脚本攻击(XSS)。攻击者可以诱骗用户访问恶意链接，该链接将用户重定向到包含恶意JavaScript的网站，从而在用户的Grafana会话中执行任意JavaScript代码。如果开启了匿名访问，攻击将更加容易。此外，如果安装了Grafana Image Renderer插件，则可以利用开放重定向实现完整的服务器端请求伪造(SSRF)，从而读取服务器上的敏感信息。

**漏洞利用方式：**

1.  **构造恶意URL：** 攻击者需要构造一个包含客户端路径遍历和开放重定向的URL。例如，URL可能包含指向外部网站的重定向参数，该网站托管一个包含恶意JavaScript代码的Grafana前端插件。
2.  **诱骗用户点击：** 攻击者需要诱骗目标用户点击构造的恶意URL。这可以通过社会工程学或其他攻击手段来实现。
3.  **JavaScript执行：** 一旦用户点击恶意URL，Grafana会将用户重定向到攻击者控制的网站，该网站上的恶意JavaScript代码将在用户的Grafana会话中执行。
4.  **SSRF（如果安装了Image Renderer）：** 如果安装了Grafana Image Renderer插件，攻击者可以通过控制重定向目标来触发SSRF，从而读取服务器上的敏感文件或访问内部网络资源。

**投毒风险分析：**
提供的POC代码只是一个包含README.md文件的仓库，并没有实际的漏洞利用代码。因此，直接从该仓库投毒的可能性较低，但不能完全排除作者在其他地方发布了包含恶意代码的利用工具的可能性，因此风险预估为10%。实际利用中需要警惕下载的POC代码是否包含恶意payload。

**项目地址:** [kk12-30/CVE-2025-4123](https://github.com/kk12-30/CVE-2025-4123)

**漏洞详情:** [CVE-2025-4123](https://nvd.nist.gov/vuln/detail/CVE-2025-4123)