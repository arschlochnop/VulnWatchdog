## CVE-2022-1388-F5 BIG-IP-iControl REST身份验证绕过

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过

**影响应用:** F5 BIG-IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 11.6.x, 12.1.x, 13.1.x, 14.1.x, 15.1.x, 16.1.x (具体版本见漏洞描述)

**利用条件:** 需要网络访问BIG-IP的管理端口或自IP地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 存在于F5 BIG-IP的iControl REST接口中，允许未经身份验证的攻击者绕过身份验证，并执行任意系统命令。利用方式是发送特制的HTTP请求，其中包含特定的header，绕过iControl REST的身份验证机制。从提供的漏洞利用代码来看，该脚本构造了一个包含`X-F5-Auth-Token`和`X-Forwarded-Host` header的POST请求，发送到`/mgmt/tm/util/bash`端点，执行指定的bash命令。脚本没有发现任何恶意代码，因此投毒风险较低。

根据搜索结果，该漏洞已经被积极利用，并且有多种缓解和检测方法。

受影响的版本包括F5 BIG-IP 16.1.x (小于 16.1.2.2), 15.1.x (小于 15.1.5.1), 14.1.x (小于 14.1.4.6), 13.1.x (小于 13.1.5), 以及所有 12.1.x 和 11.6.x 版本。

利用步骤：
1.  使用提供的POC脚本，指定目标BIG-IP设备的IP地址。
2.  执行脚本，即可在目标设备上执行任意命令。

缓解措施包括升级到不受影响的版本。

**项目地址:** [jbharucha05/CVE-2022-1388](https://github.com/jbharucha05/CVE-2022-1388)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)