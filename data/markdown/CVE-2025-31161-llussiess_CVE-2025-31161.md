## CVE-2025-31161-CrushFTP身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统接管

**影响版本:** 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0)

**利用条件:** 目标系统运行受影响版本的CrushFTP，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码（仅包含README.md），分析如下：

**有效性：** 提供的POC代码仅仅包含一个README.md文件，没有实际的利用代码，因此无法直接验证漏洞的有效性。但是，漏洞库信息和搜索结果都表明该漏洞已在野外被利用，说明该漏洞是真实存在的。参考搜索结果[webpage 3]，Huntress公司观察到CVE-2025-31161 在野外被利用,验证该漏洞存在。

**投毒风险：** 提供的漏洞利用代码只包含一个README.md文件，其中仅包含CVE编号，没有发现任何恶意代码，因此投毒风险极低，评估为0%。

**利用方式：** 

1.  **漏洞概述：** CrushFTP 10 (10.0 - 10.8.3) 和 11 (11.0 - 11.3.0) 存在一个身份验证绕过漏洞，攻击者可以绕过身份验证并接管`crushadmin`账户（除非使用了DMZ代理实例）。
2.  **漏洞原理：** 漏洞的根源在于HTTP组件的AWS4-HMAC认证方法存在缺陷。服务器首先通过调用`login_user_pass()`验证用户是否存在，而不需要密码。攻击者可以通过发送带有用户名但缺少`SignedHeaders`条目的畸形AWS4-HMAC头部，触发索引越界错误，阻止会话清理，从而成功以任意已知或可猜测的用户（例如`crushadmin`）进行身份验证。参考漏洞库信息和搜索结果[webpage 4]。
3.  **利用步骤：** 
    *   构造一个畸形的AWS4-HMAC头部，只包含用户名和一个斜杠(`/`)。
    *   发送该头部到CrushFTP服务器。
    *   服务器会成功找到用户名，触发`anypass`身份验证过程。
    *   由于缺少`SignedHeaders`条目，服务器会发生索引越界错误，阻止会话清理。
    *   攻击者成功以指定用户身份登录。
4.  **缓解措施：** 升级CrushFTP到10.8.4或11.3.1及以上版本。参考漏洞库信息和搜索结果。

总之，该漏洞利用方式较为简单，危害严重，需要尽快修复。

**项目地址:** [llussiess/CVE-2025-31161](https://github.com/llussiess/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)