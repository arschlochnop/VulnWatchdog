## CVE-2025-32462 - Sudo主机选项权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，可能导致本地权限提升

**影响版本:** < 1.9.17p1 (受影响版本包括1.8.8)

**利用条件:** 需要存在特定的sudoers配置，允许用户在非当前主机或ALL的主机上执行命令

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32462是一个存在于Sudo中的权限提升漏洞。当sudoers文件中指定的主机既不是当前主机也不是ALL时，列出的用户可以在非预期的机器上执行命令。漏洞存在于1.9.17p1之前的Sudo版本中，包括1.8.8。 

**有效性分析：**
根据漏洞信息和搜索引擎结果，此漏洞POC有效。POC代码 `CVE-2025-32462.sh` 尝试利用 `-h` 参数绕过主机名限制。如果成功，它将尝试以root权限执行 `/bin/bash -p`，从而获得root shell。

**投毒风险分析：**
POC 代码本身看起来比较直接，主要功能是测试漏洞的存在并尝试利用它。LICENSE 文件和 README.md 文件没有发现异常。

*   `CVE-2025-32462.sh`：此脚本主要用于测试和利用该漏洞。它首先检查是否可以通过 `-h` 参数以 root 身份运行命令。如果成功，它将尝试启动一个具有 root 权限的 bash 会话。此脚本的目的是演示漏洞利用，没有明显的恶意代码。
*   `LICENSE`：MIT 许可证是很常见的开源许可证，没有发现包含恶意代码的迹象。
*   `README.md`：此文件提供了关于漏洞和 PoC 的基本信息。它描述了漏洞的性质、如何使用 PoC 以及一些相关的配置要求。

虽然代码本身看起来是安全的，但用户仍然需要谨慎使用来自不受信任来源的任何代码。在运行之前，应该仔细审查代码，并确保了解其功能。

**投毒风险较低 (5%)，原因是：**

*   代码功能单一，目的明确：PoC 主要用于演示漏洞利用，功能较为简单，没有明显的恶意代码。
*   代码量小，易于审查：代码行数不多，易于人工审查，降低了隐藏恶意代码的风险。
*   存在许可证和说明文档：LICENSE 文件的存在表明作者有一定的开源精神，而 README.md 文件则有助于用户理解和使用代码。

**利用方式：**

1.  **环境准备：** 目标系统必须运行受影响的 Sudo 版本（< 1.9.17p1），并且 `sudoers` 文件中存在允许用户在特定主机（非当前主机或 ALL）上执行命令的配置。
2.  **漏洞利用：** 运行 `CVE-2025-32462.sh` 脚本，指定要执行的命令（默认为 `id`）。脚本将尝试使用 `sudo -h localhost <command>` 绕过主机名限制。
3.  **权限提升：** 如果漏洞利用成功，脚本将尝试启动一个具有 root 权限的 bash 会话（`/bin/bash -p`）。

总结：利用方式主要是通过 `-h` 参数指定主机为 `localhost`，从而绕过 `sudoers` 配置文件中的主机限制，最终以 root 权限执行命令。

**项目地址:** [cyberpoul/CVE-2025-32462-POC](https://github.com/cyberpoul/CVE-2025-32462-POC)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)