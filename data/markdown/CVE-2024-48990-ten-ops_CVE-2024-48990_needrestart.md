## CVE-2024-48990-needrestart-权限提升

**漏洞编号:** CVE-2024-48990

**漏洞类型:** 权限提升

**影响应用:** needrestart

**危害等级:** 高危，本地用户可提升为root权限

**影响版本:** < 3.8

**利用条件:** 需要本地用户权限

**POC 可用性:** 不确定，提供的代码不是POC

**投毒风险:** 0%

## 详情

CVE-2024-48990 漏洞存在于 needrestart 3.8 之前的版本。攻击者可以通过设置 PYTHONPATH 环境变量，欺骗 needrestart 运行 Python 解释器，从而以 root 权限执行任意代码。从漏洞库信息来看，利用方式是攻击者控制 PYTHONPATH 环境变量，导致 needrestart 运行 Python 解释器时加载攻击者提供的恶意 Python 模块。提供的漏洞利用代码只是 Apache License 2.0 的文本内容，不是实际的漏洞利用代码，因此无法判断其有效性。根据提供的license文本，无法判断是否存在投毒风险，所以投毒风险为0%。

**项目地址:** [ten-ops/CVE-2024-48990_needrestart](https://github.com/ten-ops/CVE-2024-48990_needrestart)

**漏洞详情:** [CVE-2024-48990](https://nvd.nist.gov/vuln/detail/CVE-2024-48990)