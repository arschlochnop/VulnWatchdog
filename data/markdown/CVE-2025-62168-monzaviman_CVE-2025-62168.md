## CVE-2025-62168-Squid-信息泄露

**漏洞编号:** CVE-2025-62168

**漏洞类型:** 信息泄露

**影响应用:** Squid

**危害等级:** 高危，可能导致敏感凭据泄露，进而导致未授权访问

**影响版本:** < 7.2

**利用条件:** 需要Squid代理服务以及受信任客户端的认证请求

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2025-62168 漏洞存在于 Squid 7.2 之前的版本中，由于错误处理中未能正确地移除 HTTP 认证凭据，导致信息泄露。攻击者可以利用此漏洞绕过浏览器的安全保护，获取受信任客户端用于身份验证的凭据。此漏洞可能允许远程客户端识别 web 应用程序内部使用的安全令牌或凭据，这些应用程序使用 Squid 进行后端负载均衡。攻击不需要配置 HTTP 认证。

**POC有效性分析：**

提供的PoC代码（main.py）尝试通过代理发送请求，并解析 Squid 的错误页面。它会检测 Squid 的版本，如果版本低于 7.2，则解析错误页面以查找是否泄露了 JWT_TOKEN。如果 JWT_TOKEN 出现在错误页面中（例如，在管理员邮件地址中），则报告漏洞存在。

**投毒风险分析：**

虽然代码主要功能是漏洞验证，但存在以下投毒风险：

1.  **硬编码凭据：** PoC 代码中包含了 `JWT_TOKEN` 和 `X_AUTH_TOKEN`。攻击者可能将此PoC稍作修改，将这些硬编码凭据用于其他攻击。
2.  **潜在的后门利用：** 代码中可能存在不明显的后门，例如向外部服务器发送收集到的信息，或者植入恶意代码。由于未提供完整的代码依赖，无法进行全面分析，但应保持警惕。
3.  **非必要的代码引入：** 代码中包含一些与漏洞本身无关的功能，例如Webmin CVE-2022-36446的描述，这增加了代码复杂性，也增加了隐藏恶意代码的可能性。

综合来看，认为该POC存在较高的投毒风险 (80%)。

**利用方式：**

1.  攻击者搭建一个恶意的web服务器，或者控制一个已有的服务器。
2.  配置受害者客户端的浏览器或应用程序使用存在漏洞的Squid代理。
3.  当受害者客户端尝试访问需要身份验证的资源时，如果认证失败，Squid会生成包含认证凭据（例如，Authorization头信息）的错误页面。
4.  攻击者可以通过脚本或者手动分析Squid代理产生的错误页面，提取泄露的认证凭据。
5.  利用泄露的凭据冒充受害者，访问受保护的资源或执行恶意操作。

**项目地址:** [monzaviman/CVE-2025-62168](https://github.com/monzaviman/CVE-2025-62168)

**漏洞详情:** [CVE-2025-62168](https://nvd.nist.gov/vuln/detail/CVE-2025-62168)