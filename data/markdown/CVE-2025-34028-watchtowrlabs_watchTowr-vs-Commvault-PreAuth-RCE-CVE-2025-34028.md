## CVE-2025-34028 - Commvault Command Center Innovation Release Unauthenticated Path Traversal

**漏洞编号:** CVE-2025-34028

**漏洞类型:** 路径遍历导致的远程代码执行

**影响应用:** Commvault Command Center Innovation Release

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 11.38.0 - 11.38.19

**利用条件:** 目标 Commvault 服务未打补丁，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-34028 存在于 Commvault Command Center Innovation Release 11.38 版本中，是一个未经身份验证的路径遍历漏洞。攻击者可以通过上传包含恶意代码的 ZIP 文件，利用路径遍历漏洞将其解压到服务器的任意位置，从而执行恶意代码。PoC 代码通过上传包含一个 JSP shell 的 ZIP 文件到`/reports/MetricsUpload/2GfMIJdK/`目录，然后通过访问该 JSP 文件来获取系统用户信息，证明了漏洞的存在。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞的 PoC 代码是有效的。PoC 利用代码成功上传包含恶意 JSP 文件的 ZIP 包，并通过请求该文件获取系统用户信息，验证了远程代码执行。

**投毒风险：**
该 PoC 代码的主要功能是验证漏洞的存在，并获取系统用户信息。潜在的投毒风险在于以下几个方面：
1.  **JSP Shell 内容：** 当前 JSP shell 的功能比较简单，仅用于获取系统用户信息。攻击者可以修改 JSP shell 的内容，执行更具危害性的操作，例如反弹 shell、执行系统命令等。
2.  **ZIP 文件内容：** ZIP 文件中除了 JSP 文件之外，还包含其他文件，这些文件也可能被用于执行恶意操作。
3.  **上传路径：** PoC 代码中上传文件的路径是硬编码的，攻击者可以修改该路径，将恶意文件上传到服务器的任意位置。
4.  **依赖包：** PoC代码依赖`requests`, `re`, `argparse`, `urllib3`, `base64`, `random`, `string`等包,如果攻击者上传了修改过的代码,可能会通过篡改依赖的包内容，实现恶意目的

根据以上分析， PoC 本身被作者隐藏投毒代码的可能性较低，大约为10%。主要是考虑到，如果代码贡献者是恶意，其一可以直接修改JSP的内容，其二可以更改上传路径，实现更大范围的攻击。PoC的主要作用是验证和展示漏洞。

**利用方式：**
1.  **发送恶意 ZIP 文件：** 攻击者构造一个包含恶意 JSP 文件的 ZIP 文件，利用路径遍历漏洞，将 ZIP 文件上传到 Commvault 服务器的 `/reports/MetricsUpload/2GfMIJdK/` 目录下。
2.  **访问 JSP 文件：** 攻击者通过构造 URL，访问上传的 JSP 文件，触发恶意代码的执行。例如，访问 `https://192.168.1.1/reports/MetricsUpload/2GfMIJdK/.tmp/dist-cc/dist-cc/shell.jsp`。
3.  **远程代码执行：** 服务器执行 JSP 文件中的恶意代码，攻击者从而获得服务器的控制权。

**项目地址:** [watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028](https://github.com/watchtowrlabs/watchTowr-vs-Commvault-PreAuth-RCE-CVE-2025-34028)

**漏洞详情:** [CVE-2025-34028](https://nvd.nist.gov/vuln/detail/CVE-2025-34028)