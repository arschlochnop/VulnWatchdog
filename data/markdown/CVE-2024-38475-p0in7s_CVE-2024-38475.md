## CVE-2024-38475-Apache HTTP Server-mod_rewrite不当转义

**漏洞编号:** CVE-2024-38475

**漏洞类型:** 代码执行/源码泄露

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致代码执行和源码泄露

**影响版本:** <= 2.4.59

**利用条件:** 需要开启mod_rewrite模块且存在不安全的RewriteRule配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38475是Apache HTTP Server 2.4.59及更早版本中mod_rewrite模块存在的一个不当转义漏洞。攻击者可以利用此漏洞将URL映射到文件系统位置，这些位置可以由服务器提供服务，但并非有意或直接通过任何URL访问，从而导致代码执行或源代码泄露。

**有效性分析：**

提供的POC代码旨在利用此漏洞来查找敏感文件。脚本首先扫描常见的目录，然后结合webroot和文件字典，构造包含payload的URL，发送请求并检查HTTP响应代码。如果返回200，则表示找到了文件。

根据漏洞描述、搜索结果（特别是关于SonicWall利用此漏洞的信息）和POC代码来看，该POC代码是有效的。实际利用的成功率取决于目标服务器的mod_rewrite配置、文件系统结构和webroot配置。

**投毒风险分析：**

查看提供的POC代码、README和字典文件，没有发现明显的恶意代码。脚本的主要功能是发送HTTP请求并检查响应。字典文件包含常见的目录和文件名，用于探测潜在的敏感文件。作者声明所有功劳归于漏洞发现者Orange Tsai，进一步降低了投毒的可能性。

因此，投毒风险评估为0%。

**利用方式：**

1.  **确定目标服务器是否开启了mod_rewrite模块。**
2.  **识别存在漏洞的RewriteRule配置。** 漏洞存在于服务器上下文中，使用反向引用或变量作为替换的第一个段。
3.  **修改POC脚本中的`webroot`、`url_ip_domain`和`schema`变量，使其与目标服务器匹配。**
4.  **运行POC脚本，它将尝试通过构造特殊的URL来访问受保护的文件。** 攻击者可根据实际情况调整`directory_wordlist`、`file_wordlist`等参数以提高效率
5.  **如果成功，服务器将返回受保护文件的内容或执行恶意代码（如果服务器配置允许）。** 例如，如果`index.php`文件被成功访问，其源代码将被泄露。

**项目地址:** [p0in7s/CVE-2024-38475](https://github.com/p0in7s/CVE-2024-38475)

**漏洞详情:** [CVE-2024-38475](https://nvd.nist.gov/vuln/detail/CVE-2024-38475)