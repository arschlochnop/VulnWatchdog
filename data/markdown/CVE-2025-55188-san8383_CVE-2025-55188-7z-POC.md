## CVE-2025-55188-7-Zip Symbolic Link Arbitrary File Write

**漏洞编号:** CVE-2025-55188

**漏洞类型:** 符号链接文件写入

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致敏感文件覆盖和潜在的代码执行

**影响版本:** < 25.01

**利用条件:** 需要用户解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-55188 是一个存在于 7-Zip 25.01 之前版本的漏洞。由于 7-Zip 在提取文件时没有正确处理符号链接，攻击者可以通过构造恶意的压缩包，利用符号链接将文件写入到目标系统的任意位置。

**有效性分析：**
提供的 POC 代码通过创建指向目标文件的符号链接，然后将包含该链接和 payload 文件的目录打包成 tar 压缩包，最后再使用 7-Zip 将 tar 压缩包压缩为 7z 格式。当用户使用存在漏洞的 7-Zip 版本解压该 7z 压缩包时，符号链接会被跟随，payload 文件会覆盖目标文件。根据漏洞信息和代码分析，此PoC代码有效。

**投毒风险分析：**
对`exploit.sh`脚本进行了分析，该脚本的主要功能是创建临时目录、创建符号链接、将payload文件复制到临时目录，然后使用 tar 和 7z 命令创建恶意压缩包。脚本本身没有发现恶意代码或后门，只是实现了漏洞利用的功能。虽然攻击者可能修改payload文件以包含恶意代码，但这与脚本本身是否被投毒是不同的概念。因此，此仓库中作者隐藏投毒代码的风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意符号链接的压缩包。
2.  符号链接指向目标系统上的一个敏感文件（例如，`.bashrc`，`~/.ssh/authorized_keys`，配置文件等）。
3.  攻击者诱骗用户使用存在漏洞的 7-Zip 版本解压该压缩包。
4.  7-Zip 在解压过程中会跟随符号链接，将压缩包中的 payload 文件写入到符号链接指向的目标文件，从而覆盖目标文件。从而可能导致配置被修改，ssh被劫持等等。

**项目地址:** [san8383/CVE-2025-55188-7z-POC](https://github.com/san8383/CVE-2025-55188-7z-POC)

**漏洞详情:** [CVE-2025-55188](https://nvd.nist.gov/vuln/detail/CVE-2025-55188)