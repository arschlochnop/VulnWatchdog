## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要Jenkins CLI接口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 中一个严重的任意文件读取漏洞。该漏洞源于 Jenkins CLI 命令解析器中存在的一个特性，该特性会将参数中以'@'字符开头的后跟文件路径的内容替换为该文件的内容。未经身份验证的攻击者可以利用此漏洞读取 Jenkins 控制器文件系统上的任意文件。

**有效性：**
提供的Nuclei模板的目的是检测Jenkins版本是否易受攻击，而不是直接读取文件内容。根据漏洞信息和搜索结果，此漏洞影响Jenkins 2.441及更早版本，以及LTS 2.426.2及更早版本。Nuclei模板通过发送一个包含特殊构造的`help`命令的POST请求到`/cli`端点，然后检测响应头 `X-Jenkins` 和响应体中是否包含受影响的Jenkins版本信息。如果匹配到受影响的版本，则表示该Jenkins实例可能存在漏洞。因此，POC代码是有效的，可以用于检测漏洞是否存在。

**投毒风险：**
Nuclei模板本身主要用于漏洞检测，其核心是发送特定的HTTP请求并匹配响应中的版本信息。投毒风险主要来自于以下几个方面：
1.  模板可能被修改为尝试读取特定文件，从而泄露敏感信息。但是，从提供的代码来看，它并没有直接读取文件的功能，只是检测版本。
2.  模板的使用者可能被误导，认为检测结果是绝对准确的，而忽略了其他可能的安全风险。这可能导致使用者对系统的安全状况产生错误的判断。
3.  模板的维护者可能在未来的更新中引入恶意代码。但是，目前的代码没有明显的恶意行为。
综合来看，该POC的投毒风险较低，估计为10%。主要的风险在于模板可能被滥用，以及未来更新可能引入恶意代码。

**利用方式：**
1.  攻击者利用 Jenkins CLI 的 `@file` 扩展功能，构造包含 `@/path/to/file` 的命令参数。
2.  Jenkins 在解析 CLI 命令时，会将 `@/path/to/file` 替换为 `/path/to/file` 的内容。
3.  攻击者可以通过精心构造的文件路径，读取 Jenkins 控制器文件系统上的任意文件。
4.  该漏洞可以通过 HTTP、WebSocket 和 SSH 进行利用，其中 HTTP 和 WebSocket 的利用风险最高。
5.  从搜索结果来看, 漏洞利用的关键在于构建恶意的CLI命令，将目标文件的内容读取出来。



**项目地址:** [kaanatmacaa/CVE-2024-23897](https://github.com/kaanatmacaa/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)