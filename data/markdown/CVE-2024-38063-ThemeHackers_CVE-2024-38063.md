## CVE-2024-38063-Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 受影响的Windows版本众多，具体版本范围请参考CVE描述

**利用条件:** 需要目标系统启用IPv6，且存在网络可达性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38063 是一个 Windows TCP/IP 远程代码执行漏洞。攻击者可以通过发送特制的 IPv6 数据包来触发此漏洞，导致目标系统执行任意代码。此漏洞CVSS评分为9.8，属于严重级别。

**有效性评估：**

根据搜索结果，该漏洞存在PoC，且多个安全厂商进行了分析，表明该漏洞的PoC已存在，并可成功利用。提供的PoC代码尝试利用该漏洞。该PoC通过使用 Scapy 库构造恶意的 IPv6 数据包，并发送到目标系统。其中包含shellcode,尝试在目标机器上执行计算器程序。

**投毒风险评估：**

对提供的python代码进行分析，发现部分代码存在风险：
1. **安装v6disc:** PoC脚本自动尝试从GitHub克隆`v6disc`库。尽管看起来合法，但如果`v6disc`仓库本身被投毒，攻击者可能无意中引入恶意代码。风险评估为2%。
2. **shellcode的危险性:** 代码包含用于启动计算器的shellcode,如果攻击者修改此shellcode为恶意指令，可能造成更大危害。风险评估为3%。
3. **依赖包安装的风险:** 脚本自动安装依赖库。如果pip源被劫持，可能安装恶意版本。这种风险虽然存在，但概率较低。风险评估为5%。
因此，总体投毒风险较低，约为10%。

**利用方式：**

1.  **环境准备：** 攻击者需要一台可以发送 IPv6 数据包的机器，并安装 Scapy 库。 
2.  **目标确认：** 攻击者需要知道目标系统的 IPv6 地址。
3.  **数据包构造：** 攻击者使用 Scapy 库构造包含恶意负载的 IPv6 数据包。 根据PoC脚本，恶意数据包包含分片IPv6包，扩展头，以及shellcode。
4.  **数据包发送：** 攻击者将构造好的数据包发送到目标系统。
5.  **代码执行：** 如果目标系统存在漏洞，恶意代码将被执行。 PoC中是执行计算器程序，但攻击者可以替换shellcode为任意代码。

需要注意的是，成功利用此漏洞可能需要绕过各种安全机制，如防火墙和入侵检测系统。此外，漏洞利用的可靠性也可能受到目标系统配置的影响。

**项目地址:** [ThemeHackers/CVE-2024-38063](https://github.com/ThemeHackers/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)