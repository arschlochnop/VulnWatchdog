## CVE-2024-32113 Apache OFBiz 路径遍历导致RCE

**漏洞编号:** CVE-2024-32113

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 18.12.13

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-32113是Apache OFBiz中的一个路径遍历漏洞，允许未经身份验证的攻击者执行任意代码。漏洞存在于`/webtools/control/forgotPassword;/ProgramExport`接口，攻击者可以构造包含恶意Groovy脚本的POST请求，利用`groovyProgram`参数执行任意系统命令。

**有效性：**
提供的PoC代码有效。它使用requests库发送POST请求，并在`groovyProgram`参数中嵌入了命令执行代码。PoC代码还会通过正则表达式从响应中提取命令执行结果。

**投毒风险：**
经过分析，PoC代码本身没有发现明显的投毒行为。该代码主要功能是利用漏洞进行远程命令执行，并将存在漏洞的目标记录到`Out.txt`文件中。`README.md`文件也只是提供了PoC的使用说明和免责声明，没有发现恶意代码。

**利用方式：**
1.  攻击者向目标服务器的`/webtools/control/forgotPassword;/ProgramExport`路径发送POST请求。
2.  POST请求中包含`groovyProgram`参数，该参数的值是一个恶意的Groovy脚本，脚本使用`execute()`方法执行系统命令。
3.  服务器执行Groovy脚本，并将结果返回给攻击者。
4.  PoC脚本通过正则表达式解析返回结果，提取命令执行的输出。

**搜索引擎结果：**
由于未提供搜索引擎结果，因此分析主要基于漏洞库信息和漏洞利用代码。

**项目地址:** [YongYe-Security/CVE-2024-32113](https://github.com/YongYe-Security/CVE-2024-32113)

**漏洞详情:** [CVE-2024-32113](https://nvd.nist.gov/vuln/detail/CVE-2024-32113)