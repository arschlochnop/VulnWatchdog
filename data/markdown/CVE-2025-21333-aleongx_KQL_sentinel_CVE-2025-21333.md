## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，本地攻击者可利用该漏洞获得SYSTEM权限

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371), Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751), Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751), Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369), Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894), Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 本地访问，需要运行受影响的Windows Hyper-V。

**POC 可用性:** 是，根据搜索结果，存在可用的POC代码

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞。该漏洞是由于`vkrnlintvsp.sys`中存在堆缓冲区溢出导致的。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：** 根据漏洞库信息和搜索结果，该漏洞影响多个Windows版本，并且CISA已将其列入已知被利用的漏洞目录，表明该漏洞具有实际的利用价值。搜索引擎结果显示存在公开的POC代码，进一步佐证了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码是 KQL 查询语句，用于检测与 CVE-2025-21333 相关的可疑活动。代码本身用于安全事件的监控和分析，而非直接的漏洞利用。因此，可以认为该代码的投毒风险较低，但也需要人工审查代码的逻辑，判断是否存在恶意隐藏。例如，代码中可能会被利用来误报，影响正常的安全事件分析，所以投毒风险为 10%。

**利用方式：**  攻击者可以利用该漏洞通过与Hyper-V的NT内核集成VSP相关的组件，触发堆缓冲区溢出，最终获得SYSTEM权限。具体来说，`vkrnlintvsp.sys` 组件在处理来自虚拟机的数据时，如果没有进行充分的边界检查，可能导致缓冲区溢出。根据搜索结果，漏洞存在于主机操作系统和容器类型虚拟机之间的通信组件中。攻击者需要在受影响的系统上执行恶意代码，触发溢出，从而提升权限。实际的利用可能涉及到内存地址的计算、shellcode的注入等技术。

 简而言之，这是一个本地提权漏洞，攻击者通过精心构造的数据包与Hyper-V的内核集成服务进行交互，导致内核堆缓冲区溢出，从而覆盖关键数据并获得SYSTEM权限。

**项目地址:** [aleongx/KQL_sentinel_CVE-2025-21333](https://github.com/aleongx/KQL_sentinel_CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)