## CVE-2024-30088 Windows Kernel Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2024-30088

**漏洞类型:** 特权提升

**影响应用:** Windows Kernel

**危害等级:** 高危，本地攻击者可利用该漏洞获取SYSTEM权限

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 需要本地访问权限，且目标系统版本在受影响范围内

**POC 可用性:** 未知

**投毒风险:** 80%

## 详情

CVE-2024-30088是Windows Kernel中的一个特权提升漏洞，属于TOCTOU（Time-of-Check Time-of-Use）竞争条件。攻击者可以利用该漏洞在检查资源状态和实际使用资源之间的时间差，修改资源状态，从而获得更高的权限。根据搜索引擎结果，该漏洞已被APT组织OilRig利用于实际攻击中，表明漏洞具有较高的实际威胁。

**有效性：**
从提供的漏洞利用代码看，仅包含一些文件列表和描述性的文本信息，缺乏真正的利用代码，因此无法判断提供的POC代码是否有效。真正的利用代码应该包含能够触发漏洞并提升权限的程序。

**投毒风险：**
仓库中的文件主要是描述信息和一些看似Visual Studio项目的文件(sln, def, exp, lib)，但缺乏实际的C/C++或汇编代码，因此，直接判断该代码库中存在投毒代码比较困难，风险评估较高。没有可执行文件或明确的恶意载荷，但也不能完全排除，作者可能通过其他方式（例如，在编译过程中注入恶意代码）来隐藏恶意行为。

**利用方式：**
根据漏洞库信息和搜索结果，CVE-2024-30088的利用方式是利用TOCTOU竞争条件。具体来说，攻击者需要找到一个内核对象，该对象的状态在检查和使用之间可能发生变化。然后，攻击者需要创建一个竞争条件，使得在内核检查对象状态后，攻击者可以修改对象状态，从而绕过安全检查并获得更高的权限。

根据已有的信息，大致的利用步骤如下：

1.  **找到目标内核对象：** 确定一个内核对象，其状态在检查和使用之间可能发生变化。
2.  **创建竞争条件：** 设计一个多线程或多进程程序，使得一个线程/进程负责检查内核对象的状态，另一个线程/进程负责修改内核对象的状态。
3.  **触发漏洞：** 启动程序，并尝试触发竞争条件。如果成功，内核会在错误的状态下使用该对象，从而导致特权提升。
4.  **执行恶意代码：** 在获得更高的权限后，攻击者可以执行任意代码，例如安装后门程序或窃取敏感信息。

**项目地址:** [Justintroup85/exploits-forsale-collateral-damage](https://github.com/Justintroup85/exploits-forsale-collateral-damage)

**漏洞详情:** [CVE-2024-30088](https://nvd.nist.gov/vuln/detail/CVE-2024-30088)