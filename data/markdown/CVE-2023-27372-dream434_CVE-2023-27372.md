## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 4.2.1

**利用条件:** 需要目标SPIP站点存在漏洞页面且可公开访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-27372 是 SPIP 内容管理系统（CMS）中存在的一个远程代码执行漏洞。该漏洞源于 SPIP 在处理表单值时，由于对序列化数据处理不当，导致攻击者可以通过构造恶意的序列化数据，将其作为表单参数提交到存在漏洞的页面，从而在服务器端执行任意代码。

**有效性：**

根据漏洞信息和搜索结果，提供的 POC 代码是有效的。多个资源（如 Packet Storm 和 GitHub 上的 Chocapikk/CVE-2023-27372）都提供了可用于利用该漏洞的 POC 或扫描器。

**投毒风险：**

代码中存在轻微的投毒风险。主要风险点在于：

*   **依赖项安装错误引导:** README.md文件引导用户安装 `collorama` , 正确的安装包应该是 `colorama`，如果用户安装了恶意攻击者伪造的 `collorama` 包，则可能存在安全风险。 *   **执行任意命令：** POC 允许执行任意命令。如果攻击者修改了 POC 中的 `whoami` 命令，替换为恶意命令，可能会造成更大的危害。例如，删除服务器文件、安装恶意软件等。但这种风险主要取决于使用者如何使用 POC，而非 POC 本身包含恶意代码。

考虑到这些因素，我将投毒风险评估为 5%。主要是安装包名称拼写错误引导，存在被利用的可能性。

**利用方式：**

1.  **查找目标：** 寻找运行 SPIP 且版本低于 4.2.1 的站点。
2.  **构造Payload：** 攻击者构造包含恶意 PHP 代码的序列化数据。
3.  **获取CSRF Token：** 首先，向 `/spip.php?page=spip_pass` 页面发起 GET 请求，解析 HTML 响应，提取名为 `formulaire_action_args` 的隐藏输入字段中的 CSRF token。
4.  **发送恶意请求：** 将构造的序列化数据作为 `oubli` 参数的值，连同其他必要的表单参数（包括上一步获取的 CSRF token）通过 POST 请求发送到 `/spip.php?page=spip_pass` 页面。
5.  **代码执行：** SPIP 在处理表单数据时，反序列化 `oubli` 参数，从而执行攻击者注入的恶意 PHP 代码。

简而言之，利用方式是通过构造包含恶意代码的序列化数据，并将其作为表单参数提交到 SPIP 站点，从而实现远程代码执行。

**项目地址:** [dream434/CVE-2023-27372](https://github.com/dream434/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)