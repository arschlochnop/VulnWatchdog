## CVE-2017-7921-Hikvision摄像机-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备需开启web服务并且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921是一个存在于多个Hikvision摄像机型号和固件版本中的不当身份验证漏洞。攻击者可以利用此漏洞绕过身份验证，获取敏感信息或提升权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经有公开的PoC代码可用。`hikvision_identifier.py` 脚本用于识别存在漏洞的 Hikvision 设备，通过检查 HTTP 响应头中的 `Server` 字段或页面内容中是否包含 `/doc/page/login.asp?_` 来判断。 `hikvision_probe.py` 和 `CVE_2017_7921.py` 用于进一步探测是否存在漏洞，尝试访问一些包含默认认证信息的URL，例如 `/System/time?auth=YWRtaW46UEtTOHVpTWg1UUk4`。如果成功访问，则表明设备存在漏洞。

**投毒风险：**

我分析了提供的PoC代码，并未发现明显的恶意代码。主要功能是发送HTTP请求并检查响应。其中`hikvision_identifier.py`，`hikvision_probe.py`，`CVE_2017_7921.py`脚本中都存在发送网络请求, 存在一定的风险，即作者可以收集用户探测目标，但是从代码功能来看，更倾向于漏洞验证，综上，投毒风险较低。风险概率：5%。

**利用方式：**

1.  **设备识别：** 使用`hikvision_identifier.py`脚本扫描目标网络，识别存在漏洞的Hikvision设备。
2.  **漏洞探测：** 使用`hikvision_probe.py`脚本，它调用`CVE_2017_7921.py`中的`probe_keys`函数，尝试使用默认的`auth`参数访问敏感接口，例如`/System/time`、`/Security/users`、`/System/deviceInfo`等。这些接口返回的信息可能包含设备配置、用户信息等敏感数据。
3.  **权限提升/信息窃取：** 如果漏洞探测成功，攻击者可以使用已泄露的信息（如用户名密码），或者直接利用未授权访问的接口，来提升权限或窃取敏感信息。

总而言之，该漏洞的利用方式相对简单，只需发送特定的HTTP请求即可。因此，成功利用的可能性较高。

**项目地址:** [aengussong/hikvision_probe](https://github.com/aengussong/hikvision_probe)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)