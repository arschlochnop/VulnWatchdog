## CVE-2025-64720-libpng-缓冲区溢出

**漏洞编号:** CVE-2025-64720

**漏洞类型:** 缓冲区溢出

**影响应用:** libpng

**危害等级:** 高危，可能导致拒绝服务、信息泄露甚至远程代码执行

**影响版本:** < 1.6.51

**利用条件:** 目标应用使用了存在漏洞的libpng版本，并使用简化API处理特制的PNG图片。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于libpng库的`png_image_read_composite`函数中，由于在处理带有`PNG_FLAG_OPTIMIZE_ALPHA`标志的调色板图像时，调色板预乘代码在`png_init_read_transformations`中错误地应用了背景合成，违反了简化PNG API所需的 `component ≤ alpha × 257` 不变量，导致内存损坏。攻击者可以通过构造恶意的PNG文件，设置调色板条目为最大RGB值，并设置alpha值为零，从而触发越界读取。PoC代码详细描述了漏洞的触发条件、内存布局以及技术分析。没有发现任何可疑的、与漏洞利用无关的代码，因此判断投毒风险为0%。漏洞利用方式为：1. 创建包含tRNS块的调色板PNG；2. 将调色板条目设置为最大RGB值（255, 255, 255）；3. 将多个调色板条目的alpha值设置为零；4. 目标应用程序使用alpha格式处理PNG；5. 内部启用`PNG_FLAG_OPTIMIZE_ALPHA`；6. 调色板扩展违反组件不变性；7. 发生越界数组访问。

**项目地址:** [truediogo/CVE-2025-64720-PoC](https://github.com/truediogo/CVE-2025-64720-PoC)

**漏洞详情:** [CVE-2025-64720](https://nvd.nist.gov/vuln/detail/CVE-2025-64720)