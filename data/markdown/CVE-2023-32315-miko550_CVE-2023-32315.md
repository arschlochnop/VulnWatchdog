## CVE-2023-32315-Openfire-路径遍历导致认证绕过

**漏洞编号:** CVE-2023-32315

**漏洞类型:** 路径遍历导致认证绕过

**影响应用:** Openfire

**危害等级:** 高危，允许未授权访问管理控制台并创建管理员账户

**影响版本:** 3.10.0 <= version < 4.6.8 和 4.7.0 <= version < 4.7.5

**利用条件:** Openfire服务器需要运行在存在漏洞的版本，并且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32315 是一个存在于 Openfire 的路径遍历漏洞，它允许未经身份验证的攻击者通过 `setup` 目录访问受限的管理控制台页面，从而绕过身份验证。该漏洞的利用方式是利用`setup-s/%u002e%u002e/%u002e%u002e/` 路径，访问 `user-create.jsp` 页面，并创建一个新的管理员用户。提供的 Python 脚本通过构造包含恶意路径的 URL 来实现此攻击。该脚本首先尝试获取 JSESSIONID 和 csrf token，然后使用这些 token 创建一个新的管理员用户。脚本的`success.txt` 会记录成功创建管理员账户的URL,用户名和密码.投毒风险较低，因为该脚本的功能主要是利用漏洞，未发现恶意代码，但是创建管理员用户的行为本身具有一定的破坏性。

参考:
* [webpage 0]: NVD对该漏洞的描述
* [webpage 1]: Broadcom 对 Openfire Authentication Bypass Vulnerability的描述
* [webpage 2]: Rapid7 漏洞数据库描述
* [webpage 4]: Fortiguard 威胁信号报告，描述了该漏洞的影响
* [webpage 6]: VulnCheck blog 描述了该漏洞的利用方式
* [webpage 8]: Cybrary.it 描述了 Openfire (CVE-2023-32315) 的细节
* [webpage 9]: Acunetix 对 Openfire Path Traversal 的描述

漏洞利用有效性高，因为CVE库和搜索结果都确认了该漏洞的存在和可利用性。POC代码也提供了一个可行的利用方法。

由于CISA已将此漏洞添加到已知被利用漏洞目录，证明该漏洞已经在野外被利用。

**项目地址:** [miko550/CVE-2023-32315](https://github.com/miko550/CVE-2023-32315)

**漏洞详情:** [CVE-2023-32315](https://nvd.nist.gov/vuln/detail/CVE-2023-32315)