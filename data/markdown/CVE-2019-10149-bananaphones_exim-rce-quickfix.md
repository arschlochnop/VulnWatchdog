## CVE-2019-10149-Exim-RCE

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 4.87 to 4.91

**利用条件:** 目标系统运行受影响版本的Exim，且漏洞未被修复

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2019-10149 存在于 Exim 4.87 到 4.91 版本中，是由于 `deliver_message()` 函数中对接收者地址验证不当造成的远程命令执行漏洞。攻击者可以通过构造特殊的邮件，利用该漏洞在目标服务器上执行任意命令。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。搜索引擎结果显示该漏洞已被广泛利用，并且有活跃的Linux蠕虫利用此漏洞传播。漏洞利用代码中的 `exim_rce_fixer.sh` 脚本尝试更新 Exim 并移除恶意软件，表明存在利用该漏洞植入的恶意程序。

**投毒风险分析：**
提供的脚本 `exim_rce_fixer.sh` 旨在修复漏洞并清理恶意软件，但它本身可能存在投毒风险。脚本尝试删除与 `tor2web` 相关的恶意软件，更新 Exim，并删除可疑的 cron 任务和 authorized_keys 条目。但是，如果脚本未能完全清除恶意软件，或者脚本本身包含恶意代码，则可能导致系统受损。此外，脚本强制重启服务器，这可能导致数据丢失或服务中断。

`malware_do_not_run.sh` 脚本明确包含连接到 Tor 网络的行为，并尝试下载和执行恶意代码。尽管文件名暗示不要运行，但攻击者可以通过该脚本植入恶意软件。

综合考虑，脚本中清理恶意软件的部分看起来是合法的，但 `malware_do_not_run.sh` 脚本和`exim_rce_fixer.sh`脚本潜在的清理不完全和强制重启行为构成了投毒风险。

**利用方式：**
1.  攻击者构造包含恶意命令的特殊邮件。
2.  Exim 在处理邮件时，由于对接收者地址验证不当，将恶意命令传递给系统 shell 执行。
3.  攻击者从而在目标服务器上获得远程代码执行权限。
4.  攻击者可能利用该权限安装恶意软件，窃取数据，或控制服务器。

**项目地址:** [bananaphones/exim-rce-quickfix](https://github.com/bananaphones/exim-rce-quickfix)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)