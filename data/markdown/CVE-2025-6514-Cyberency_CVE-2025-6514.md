## CVE-2025-6514-mcp-remote-OS命令注入

**漏洞编号:** CVE-2025-6514

**漏洞类型:** OS命令注入

**影响应用:** mcp-remote

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.1.15

**利用条件:** 需要目标用户连接到恶意的MCP服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-6514 漏洞存在于 mcp-remote 软件包中，当连接到不受信任的 MCP 服务器时，由于来自 authorization_endpoint 响应 URL 的精心构造的输入，导致 OS 命令注入。漏洞影响版本小于等于 0.1.15。

**有效性:**
根据漏洞描述，攻击者可以控制 authorization_endpoint 返回的 URL，从而注入恶意命令。提供的代码看起来是项目文档和许可证，没有直接的漏洞利用代码。因此，需要构造恶意的 MCP 服务器响应才能触发漏洞。

**投毒风险:**
提供的代码片段主要是项目文档、LICENSE以及README，虽然没有明显的恶意代码，但仍存在微小的投毒风险。风险点在于：

*   **依赖项操纵：** 虽然此处未显示 `package.json`，攻击者可能尝试通过PR等方式修改依赖项版本，引入包含后门的恶意依赖项。
*   **构建脚本修改：** 攻击者也可能尝试修改构建脚本，例如 `pnpm build` 相关的脚本，在构建过程中植入恶意代码。这部分代码没有提供。

因此，综合评估，投毒风险较低，大约为10%。

**利用方式:**
1.  攻击者搭建一个恶意的 MCP 服务器。
2.  攻击者控制该恶意服务器的 authorization_endpoint，使其返回包含恶意命令的 URL。
3.  受害者（运行着易受攻击的 mcp-remote 版本）配置连接到该恶意 MCP 服务器。
4.  当 mcp-remote 处理 authorization_endpoint 响应时，URL中的恶意命令会被执行，导致远程代码执行。

**项目地址:** [Cyberency/CVE-2025-6514](https://github.com/Cyberency/CVE-2025-6514)

**漏洞详情:** [CVE-2025-6514](https://nvd.nist.gov/vuln/detail/CVE-2025-6514)