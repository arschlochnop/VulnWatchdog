## CVE-2019-18935-Telerik UI for ASP.NET AJAX-反序列化漏洞

**漏洞编号:** CVE-2019-18935

**漏洞类型:** 反序列化漏洞

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 2019.3.1023

**利用条件:** 需要目标系统存在有漏洞的Telerik UI 组件，且已知加密密钥（可通过CVE-2017-11317或CVE-2017-11357或其他方式获得）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-18935 是一个存在于 Telerik UI for ASP.NET AJAX 组件中的 .NET 反序列化漏洞。该漏洞位于 RadAsyncUpload 功能中。当攻击者已知加密密钥时，可以通过构造恶意的序列化数据，上传到服务器，利用 JavaScriptSerializer 进行反序列化，从而执行任意代码。CVE库信息中提到，已知漏洞利用在野。搜索结果也显示该漏洞经常被攻击者利用，尤其是在目标加密秘钥泄露的情况下。

**有效性：** 提供的POC代码看起来有效。它利用了 RadAsyncUpload 的反序列化漏洞，允许上传任意文件并执行代码。POC代码包括了加密和解密例程，以及构建和发送恶意请求的功能。

**投毒风险：**  POC代码中可能存在轻微的投毒风险的可能性较低 (5%)。主要考量是RAU_crypto文件夹下的加密算法可能存在后门，但这属于POC验证需要的后门代码，而且由于代码相对清晰，添加恶意代码的可能性较低。需要对RAU_crypto文件夹下的代码做进一步审计。

**利用方式：**
1.  **密钥获取：** 首先，攻击者需要获取用于加密 RadAsyncUpload 通信的密钥。 这可以通过利用其他漏洞（如 CVE-2017-11317 或 CVE-2017-11357）来完成，或者通过其他方式泄露。
2.  **构造恶意Payload：**  攻击者构造一个包含恶意代码的 .NET 对象，并使用 JavaScriptSerializer 将其序列化。
3.  **加密Payload：** 使用获取的密钥加密序列化的 Payload。
4.  **上传Payload：** 将加密的 Payload 作为文件上传到 RadAsyncUpload 组件。
5.  **反序列化触发：** RadAsyncUpload 组件在处理上传的文件时，会对其进行反序列化，从而触发恶意代码的执行，导致远程代码执行。

**项目地址:** [noperator/CVE-2019-18935](https://github.com/noperator/CVE-2019-18935)

**漏洞详情:** [CVE-2019-18935](https://nvd.nist.gov/vuln/detail/CVE-2019-18935)