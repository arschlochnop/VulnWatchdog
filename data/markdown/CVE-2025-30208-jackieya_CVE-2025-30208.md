## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite dev server 必须显式暴露到网络 (使用 `--host` 或 `server.host` 配置项)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30208是Vite框架中的一个任意文件读取漏洞。攻击者可以通过构造包含`?raw??`或`?import&raw??`的特殊URL，绕过Vite的`@fs`文件系统访问限制，读取服务器上的任意文件内容。漏洞存在的原因是Vite在处理URL时，对查询字符串的处理不当，导致可以利用trailing separators绕过文件访问控制。

**有效性：**
根据漏洞描述、搜索引擎结果以及提供的POC代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个条目提到了POC的存在，并且POC利用方式与漏洞描述相符。

**投毒风险：**
POC代码主要包含以下部分：
*   `README.md`: 描述了漏洞利用的信息。
*   `fofaSearch.go`: 使用Fofa API搜索互联网上暴露的Vite服务器。
*   `go.mod`和`go.sum`: Go modules依赖管理文件。

`fofaSearch.go` 代码存在潜在的风险，因为它会从互联网上搜索目标服务器。攻击者可能会修改 `fofaQuery` 来定位特定类型的服务器，或者将扫描结果发送到远程服务器。然而，这段代码主要用于发现潜在目标，本身不包含任何直接的恶意代码来修改目标服务器上的文件或执行恶意操作。因此判断投毒风险较低，约为10%。风险主要来自于使用者利用该工具进行大规模扫描行为。

**利用方式：**
1.  **确定目标：** 使用Fofa API或其他方式，发现暴露了Vite开发服务器的目标。
2.  **构造恶意URL：** 构造包含`?raw??`或`?import&raw??`的URL，指向要读取的文件。例如：
`http://target.com/@fs/etc/passwd?raw??`
3.  **发送请求：** 向目标服务器发送构造好的URL请求。
4.  **获取文件内容：** 如果目标服务器存在漏洞，将会返回`/etc/passwd`文件的内容。

**漏洞缓解措施：**
*   升级Vite版本到 >= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3 版本
*   避免将Vite开发服务器暴露到公网，除非绝对必要。

**项目地址:** [jackieya/CVE-2025-30208](https://github.com/jackieya/CVE-2025-30208)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)