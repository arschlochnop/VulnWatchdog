## CVE-2024-0204 GoAnywhere MFT 身份验证绕过

**漏洞编号:** CVE-2024-0204

**漏洞类型:** 身份验证绕过

**影响应用:** GoAnywhere MFT

**危害等级:** 严重，可导致完全控制系统

**影响版本:** < 7.4.1 (影响 6.0.1 及以上版本)

**利用条件:** 需要能够通过网络访问 GoAnywhere MFT 的管理控制台。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-0204 是 Fortra GoAnywhere MFT 软件中存在的一个严重身份验证绕过漏洞。未经身份验证的攻击者可以通过访问 `InitialAccountSetup.xhtml` 页面来创建一个新的管理员用户，从而完全控制系统。 

**有效性:**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用代码是有效的。搜索引擎结果中的多个条目 (Rapid7, Kroll, Arctic Wolf, Tenable, Wiz 等) 都确认了该漏洞的存在，以及利用该漏洞创建管理员账户的可能性。Horizon3.ai 在 GitHub 上提供的 POC 代码进一步证实了这一点。该POC代码通过直接向`/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml`发送精心构造的POST请求绕过认证，创建新的管理员账户。

**投毒风险:**

分析提供的 Python POC 代码 (`CVE-2024-0204.py`) 和 `README.md` 文件, 几乎没有发现投毒代码的迹象。该代码结构清晰，功能明确，主要用于发送 HTTP 请求并解析 HTML 响应。主要功能包括：

*   参数解析：使用 `argparse` 处理命令行参数，包括目标 URL、用户名和密码。
*   密码验证：`validate_password` 函数检查密码长度是否满足最小要求（至少 8 个字符），这是 GoAnywhere MFT 的密码复杂性要求。
*   Session 管理：使用 `requests.session()` 创建一个会话，以便在请求之间保持状态。
*   ViewState 处理：从初始页面获取 `javax.faces.ViewState` 参数，并在后续的 POST 请求中包含它，这对于 JSF 应用程序至关重要。
*   错误处理：检查 HTTP 状态码和响应内容，以检测漏洞利用是否成功。

代码中唯一值得注意的是 `requests.packages.urllib3.disable_warnings(InsecureRequestWarning)`，它禁用了 SSL 证书验证警告。虽然在测试环境下这很常见，但在生产环境中禁用 SSL 验证可能会带来安全风险。但是，这本身并不是投毒代码，而是一种潜在的安全隐患，在真实环境中应该避免。

`README.md` 文件提供了关于漏洞和脚本用法的基本信息，并链接到 Horizon3.ai 的博客文章，进一步增加了代码的可信度。免责声明也表明该工具仅用于学术研究和防御目的。

总体而言，该仓库中存在恶意或隐藏代码的可能性极低。但是, 仍然需要小心验证目标URL, 避免被中间人攻击。

**利用方式:**

1.  攻击者首先需要确定目标 GoAnywhere MFT 实例的版本低于 7.4.1。
2.  攻击者使用POC脚本，指定目标 URL、新管理员用户名和密码。密码必须至少包含 8 个字符。
3.  脚本首先向 `/goanywhere/images/..;/wizard/InitialAccountSetup.xhtml` 发送 GET 请求。
4.  脚本解析响应，提取 `javax.faces.ViewState` 参数。
5.  脚本使用提取的参数和提供的用户名、密码，向同一 URL 发送 POST 请求，创建新的管理员用户。
6.  如果一切顺利，攻击者现在可以使用新创建的管理员帐户登录并完全控制 GoAnywhere MFT 系统。

**项目地址:** [horizon3ai/CVE-2024-0204](https://github.com/horizon3ai/CVE-2024-0204)

**漏洞详情:** [CVE-2024-0204](https://nvd.nist.gov/vuln/detail/CVE-2024-0204)