## CVE-2025-25256-FortiSIEM-OS命令注入

**漏洞编号:** CVE-2025-25256

**漏洞类型:** OS命令注入

**影响应用:** FortiSIEM

**危害等级:** 高危，可能导致远程代码执行，完全控制系统

**影响版本:** 7.3.0 <= version <= 7.3.1, 7.2.0 <= version <= 7.2.5, 7.1.0 <= version <= 7.1.7, 7.0.0 <= version <= 7.0.3, 6.7.0 <= version <= 6.7.9, 6.6.0 <= version <= 6.6.5, 6.5.0 <= version <= 6.5.3, 6.4.0 <= version <= 6.4.4, 6.3.0 <= version <= 6.3.3, 6.2.0 <= version <= 6.2.1, 6.1.0 <= version <= 6.1.2, 5.4.0

**利用条件:** 目标系统开启7900端口且存在受影响的FortiSIEM版本，攻击者需要能够与目标网络通信

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-25256是FortiSIEM中的一个OS命令注入漏洞，未经身份验证的攻击者可以通过构造特制的CLI请求来执行未经授权的代码或命令。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞为未经身份验证的远程命令执行漏洞，CVSS评分为9.8，属于严重漏洞。多个安全厂商（如Arctic Wolf, Wiz, Tenable, esentire, Secpod）和CERT-EU都发布了相关信息，表明该漏洞影响广泛，且已经出现公开的利用代码。
提供的PoC代码`watchTowr-vs-FortiSIEM-CVE-2025-25256.py`利用了XML注入，通过修改`archive_nfs_archive_dir`的值，将用户提供的命令注入到操作系统中。PoC代码结构清晰，目标是检测目标系统是否存在漏洞。该脚本通过7900端口发送特制的XML请求来触发漏洞，并执行`whoami`命令来验证漏洞是否存在。

**投毒风险：**
代码中存在轻微的投毒风险，约5%。主要基于以下考虑：
1.  **依赖项风险:** 该脚本不依赖任何外部库，降低了供应链投毒的风险。
2.  **代码可读性:**  代码结构清晰，逻辑简单，易于审查，降低了隐藏恶意代码的可能。
3.  **作者信誉:** watchTowr是一家安全公司，发布PoC的目的是为了帮助用户检测漏洞，而非进行恶意攻击。
4.  **潜在风险:** 虽然整体风险较低，但仍然存在微小的可能性，例如，作者可能在命令执行后偷偷收集一些系统信息，或者在检测过程中留下后门。不过，这种可能性较低，因为PoC的主要目的是检测，而不是攻击。

**利用方式：**
1.  攻击者利用PoC脚本，指定目标IP地址和要执行的命令。
2.  脚本构建一个包含恶意命令的XML payload，并将其封装成符合FortiSIEM协议的消息格式。
3.  脚本通过SSL连接（7900端口）将消息发送到目标FortiSIEM服务器。
4.  FortiSIEM服务器解析XML payload，并将恶意命令注入到操作系统中执行。
5.  命令执行的结果可以通过某种方式返回给攻击者，或者直接对系统造成影响（例如，创建用户、安装后门等）。

**项目地址:** [watchtowrlabs/watchTowr-vs-FortiSIEM-CVE-2025-25256](https://github.com/watchtowrlabs/watchTowr-vs-FortiSIEM-CVE-2025-25256)

**漏洞详情:** [CVE-2025-25256](https://nvd.nist.gov/vuln/detail/CVE-2025-25256)