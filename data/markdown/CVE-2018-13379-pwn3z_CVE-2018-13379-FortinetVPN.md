## CVE-2018-13379-FortinetVPN 路径遍历

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历

**影响应用:** Fortinet FortiOS/FortiProxy SSL VPN

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2018-13379是Fortinet FortiOS和FortiProxy中SSL VPN web portal的一个路径遍历漏洞。未经身份验证的攻击者可以利用此漏洞通过特制的HTTP请求下载系统文件。 

**有效性:** 提供的PoC代码 `fortinet-ssl.sh` 通过以下步骤尝试利用该漏洞：
1. 从 `hosts` 文件中读取目标IP地址/域名列表。
2. 使用 `curl` 检查目标是否存在 `/remote/login` 页面，这通常是Fortinet SSL VPN的登录页面。如果存在，则继续下一步，否则判断为不存在漏洞。
3. 构造包含路径遍历的URL：`/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`，尝试下载 `sslvpn_websession` 文件，该文件可能包含VPN会话信息，包括凭据。
4. 检查响应状态码是否为200，如果是，则认为目标存在漏洞，并将IP地址/域名写入 `vulnerable.txt` 文件中。

综上，该PoC代码是有效的，能够检测目标是否存在CVE-2018-13379漏洞。

**投毒风险:** PoC代码 `fortinet-ssl.sh` 的主要功能是检测漏洞并保存存在漏洞的IP地址/域名。其中没有发现任何可疑的或恶意代码，因此投毒风险为0%。代码逻辑简单，执行的操作都是网络请求和文件写入，没有执行任何可能导致系统损害或信息泄露的操作。

**利用方式:**
1.  **确定目标:** 攻击者首先需要确定存在漏洞的Fortinet设备IP地址/域名。可以通过网络扫描或公开的IP地址列表来实现。
2.  **发送恶意请求:** 攻击者构造包含路径遍历的HTTP GET请求，例如：`https://<目标IP>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession`。
3.  **获取敏感信息:** 如果目标存在漏洞，攻击者将能够下载`sslvpn_websession`文件或其他敏感文件，从而获得VPN凭据或其他敏感信息。
4.  **进一步攻击:** 攻击者可以使用获取的VPN凭据登录VPN，从而访问内部网络并进行进一步攻击。

**项目地址:** [pwn3z/CVE-2018-13379-FortinetVPN](https://github.com/pwn3z/CVE-2018-13379-FortinetVPN)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)