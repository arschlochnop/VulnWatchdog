## CVE-2023-49103 - ownCloud graphapi 信息泄露

**漏洞编号:** CVE-2023-49103

**漏洞类型:** 信息泄露

**影响应用:** ownCloud graphapi

**危害等级:** 高危，可能泄露敏感凭据和配置信息

**影响版本:** 0.2.x before 0.2.1 and 0.3.x before 0.3.1

**利用条件:** 目标系统运行存在漏洞的ownCloud graphapi版本，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-49103 漏洞存在于 ownCloud graphapi 应用中，由于使用了存在信息泄露风险的第三方库 GetPhpInfo.php，攻击者可以通过未授权访问特定的URL（`/owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css` 或 `/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css`），绕过 .htaccess 限制，获取 PHP 环境的配置信息（`phpinfo()` 输出）。在容器化部署中，这些信息可能包含敏感数据，如 ownCloud 管理员密码、邮件服务器凭据和许可证密钥。该漏洞无需身份验证即可利用。

**有效性评估：**
根据漏洞描述和提供的POC代码，可以判断该POC代码**有效**。POC代码通过多线程方式，对一批URL进行检测，发送特制的请求，如果返回结果中包含 `OWNCLOUD_ADMIN_`，则认为存在漏洞。

**投毒风险评估：**
对提供的 exploit.py 代码进行分析，其主要功能是发送 HTTP 请求，检查响应内容。没有发现任何可疑的、与漏洞利用无关的代码，例如反弹shell、植入后门或篡改数据等操作。该脚本主要逻辑为发送请求并匹配特定字符串，属于漏洞验证而非恶意攻击行为。唯一需要注意的是，代码中的 `verify=False` 参数禁用了SSL证书验证，这在生产环境中可能存在一定的安全风险，但并非投毒行为。因此，评估认为投毒风险**较低，大约为1%**。

**利用方式分析：**
1.  准备包含目标 ownCloud 实例 URL 的文本文件。
2.  运行 exploit.py 脚本，指定输入文件和输出文件。
3.  脚本会向目标 URL 发送包含特定路径（`/owncloud/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css` 或 `/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css`）的 HTTP GET 请求。
4.  如果服务器返回状态码 200，并且响应内容中包含 `OWNCLOUD_ADMIN_` 字符串，则认为目标存在漏洞，并将 URL 写入输出文件。
5.  攻击者可以从输出文件中获取存在漏洞的 ownCloud 实例 URL，并通过访问相应的 phpinfo 页面来获取敏感信息，例如管理员密码、邮件服务器凭据等。

**项目地址:** [creacitysec/CVE-2023-49103](https://github.com/creacitysec/CVE-2023-49103)

**漏洞详情:** [CVE-2023-49103](https://nvd.nist.gov/vuln/detail/CVE-2023-49103)