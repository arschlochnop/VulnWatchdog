## CVE-2025-34138 Sitecore Experience Platform Unauthenticated RCE

**漏洞编号:** CVE-2025-34138

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Sitecore Experience Manager (XM), Experience Platform (XP), Experience Commerce (XC), Managed Cloud

**危害等级:** 高危，可导致完全控制受影响的 Sitecore 实例

**影响版本:** 9.2 Initial Release through 10.4 Initial Release

**利用条件:** 需要目标 Sitecore 实例可网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Sitecore Experience Platform 产品中的一个未经身份验证的远程代码执行漏洞，影响 Experience Manager (XM), Experience Platform (XP), Experience Commerce (XC) 和 Managed Cloud 产品，版本从 9.2 Initial Release 到 10.4 Initial Release。利用方式是通过发送特制的 HTTP POST 请求，其中包含使用 BinaryFormatter 序列化的恶意 payload，从而触发反序列化漏洞，最终实现远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞允许远程代码执行或未经授权的信息访问，并且 CVSS 评分高达 9.3，属于危急级别。搜索结果中也提到了该漏洞可能导致远程代码执行。漏洞利用代码提供了一个 PoC 脚本，旨在利用反序列化漏洞执行任意命令。该 PoC 脚本的描述详细说明了漏洞利用的步骤，包括漏洞测试、payload 交付、执行和响应处理。综合以上信息，可以判断提供的 PoC 代码具备较高的有效性。

**投毒风险分析：**

分析 PoC 代码内容，存在一定的投毒风险。虽然代码中明确声明了用于教育和授权测试目的，并警告禁止未经授权的使用，但代码中的链接 `https://tinyurl.com/mr2n46jd` 比较可疑。TinyURL 链接常用于隐藏真实的 URL 目标，可能指向包含恶意代码或后门的网站或资源。 另外ysoserial的使用也需要谨慎评估,以防产生其他的安全问题. 因此，虽然大部分代码看起来是标准的漏洞利用 PoC，这个链接的存在引入了潜在的投毒风险，综合评估，投毒风险的可能性约为 10%。

**利用方式总结：**

1.  **确定目标：**  选择一个运行受影响 Sitecore 版本的实例。
2.  **生成 Payload：** 使用 ysoserial.net 生成恶意的 BinaryFormatter payload，指定要执行的命令。
3.  **发送请求：**  使用提供的 exploit.py 脚本，将生成的 payload 封装在 HTTP POST 请求中，发送到目标 Sitecore 实例。
4.  **执行代码：**  如果目标存在漏洞，Sitecore 会反序列化 payload，从而执行 payload 中指定的命令。
5.  **验证结果：**  检查服务器的响应，确认代码是否成功执行。

**项目地址:** [allinsthon/CVE-2025-34138](https://github.com/allinsthon/CVE-2025-34138)

**漏洞详情:** [CVE-2025-34138](https://nvd.nist.gov/vuln/detail/CVE-2025-34138)