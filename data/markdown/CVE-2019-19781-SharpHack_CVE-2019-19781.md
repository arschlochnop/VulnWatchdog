## CVE-2019-19781-Citrix ADC和Gateway目录遍历与远程代码执行

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历/远程代码执行

**影响应用:** Citrix Application Delivery Controller (ADC) and Gateway

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** 10.5, 11.1, 12.0, 12.1, and 13.0

**利用条件:** 目标系统运行受影响版本的Citrix ADC或Gateway，且可通过网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-19781是一个存在于Citrix ADC和Gateway中的目录遍历漏洞，通过特制的URL请求可以绕过身份验证，读取或写入任意文件，最终导致远程代码执行。根据提供的漏洞利用代码，攻击者首先利用目录遍历漏洞，通过`newbm.pl`脚本写入恶意模板文件，其中包含待执行的命令。然后，攻击者通过访问该模板文件执行命令，并将结果写入到另一个文件中，最后通过访问该文件获取命令执行结果。POC代码中存在轻微投毒风险的可能性，可能在`COMMAND_TO_EXECUTE` 中执行恶意指令，或使写入的文件名包含恶意代码，但是从整体代码来看，主要功能是实现漏洞利用。

**有效性：**
根据漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码有效。漏洞库信息和搜索结果都表明该漏洞是真实存在的，并且已经被积极利用。POC代码提供了完整的攻击流程，可以直接用于验证和利用该漏洞。

**投毒风险：**
该POC的投毒风险较低，约为5%。虽然攻击者可能会在`COMMAND_TO_EXECUTE`参数中注入恶意代码，但这并非POC本身固有的投毒行为，而是取决于攻击者的输入。POC的主要功能是利用已知漏洞实现远程代码执行，而非恶意软件传播或持久化。

**利用方式：**
1.  利用目录遍历漏洞访问`newbm.pl`脚本。
2.  构造包含恶意命令的请求，并将其作为模板写入到服务器上的文件中。
3.  通过访问包含命令执行结果的文件，获取命令执行的输出。
4.  成功实现未经授权的远程代码执行。

**项目地址:** [SharpHack/CVE-2019-19781](https://github.com/SharpHack/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)