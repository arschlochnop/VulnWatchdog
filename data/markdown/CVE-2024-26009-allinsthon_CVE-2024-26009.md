## CVE-2024-26009 - Fortinet身份验证绕过漏洞

**漏洞编号:** CVE-2024-26009

**漏洞类型:** 身份验证绕过

**影响应用:** FortiOS, FortiProxy, FortiPAM

**危害等级:** 高危，允许未经身份验证的攻击者完全控制受管理的设备

**影响版本:** FortiOS: 6.4.0 - 6.4.15, 6.2.0 - 6.2.16, 6.0.0 - 6.0.18; FortiProxy: 7.4.0 - 7.4.2, 7.2.0 - 7.2.8, 7.0.0 - 7.0.15; FortiPAM: < 1.2.0

**利用条件:** 设备由FortiManager管理，且攻击者知道FortiManager的序列号

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2024-26009 允许未经身份验证的攻击者通过构造的 FGFM 请求来控制受管理的设备。根据漏洞信息和搜索结果，如果设备由 FortiManager 管理并且攻击者知道 FortiManager 的序列号，攻击者可以获得完全的管理员控制权限，无需有效凭据。

**有效性评估：**
提供的POC代码看起来有效。它描述了如何利用此漏洞，并提供了基本的使用示例以及一些选项。它还引用了 Fortinet 安全公告，这增加了它的可信度。

**投毒风险评估：**
虽然 README.md 文件本身没有明显的恶意代码，但其中包含一个 `[href](https://tinyurl.com/4puxhs3k)`  链接。该链接指向一个 `tinyurl` 短链接，无法直接确定其指向的内容。这意味着存在潜在的投毒风险，因为链接可能重定向到包含恶意payload的exploit代码。

综合考虑，考虑到`tinyurl` 的不确定性以及获取目标设备管理权限的诱惑，该利用代码存在**30%**的投毒风险。

**利用方式分析：**
利用方式是通过发送特制的 FGFM 请求绕过身份验证。攻击者需要知道目标设备的 IP 地址和 FortiManager 的序列号。POC代码提供了一个Python脚本示例，允许攻击者创建新的管理员帐户或在目标设备上运行自定义命令。它通过 `-c` 或 `--command` 参数实现。

**项目地址:** [allinsthon/CVE-2024-26009](https://github.com/allinsthon/CVE-2024-26009)

**漏洞详情:** [CVE-2024-26009](https://nvd.nist.gov/vuln/detail/CVE-2024-26009)