## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为后续攻击提供信息

**影响版本:** < 7.7

**利用条件:** 需要目标主机开放SSH端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举 OpenSSH 服务器上的有效用户名。该漏洞源于 OpenSSH 在身份验证早期阶段，未完全解析数据包之前，就对无效用户进行响应。攻击者可以发送特制的身份验证请求，根据服务器的响应时间来判断用户名是否存在。提供的 POC 代码利用了 Paramiko 库模拟 SSH 客户端，发送畸形的 SSH 数据包，并通过分析服务器的响应来判断用户是否存在。

**有效性：** 提供的 POC 代码是有效的。它通过修改 Paramiko 库中的认证处理函数，使其发送畸形的 SSH 数据包，然后根据服务器的响应来判断用户名是否存在。

**投毒风险：** 该代码的投毒风险很低，约为 1%。审查了提供的 LICENSE，README 和 Python 代码文件。虽然 `LICENSE` 文件中作者声明的年份是 2025 年，这是一个小瑕疵，可能只是笔误。其他的代码部分看起来是为了修复和改进原始漏洞利用代码，使其兼容更新的 Python 和 Paramiko 版本。虽然不能完全排除投毒的可能，但没有发现明显的恶意代码。考虑到代码逻辑相对简单，且目的是利用已知的用户名枚举漏洞，因此该代码的投毒风险较低。

**利用方式：**

1.  **准备用户名列表：** 攻击者需要一个包含潜在用户名的列表。
2.  **运行 POC 代码：** 运行提供的 Python 脚本，指定目标 SSH 服务器的 IP 地址和用户名列表。
3.  **分析输出结果：** 脚本会尝试使用列表中的用户名进行身份验证，并根据服务器的响应来判断用户名是否存在。脚本会输出有效用户名的列表。

**项目地址:** [makmour/open-ssh-user-enumeration](https://github.com/makmour/open-ssh-user-enumeration)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)