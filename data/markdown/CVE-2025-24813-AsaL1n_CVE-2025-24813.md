## CVE-2025-24813 - Apache Tomcat 路径等价性漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE) / 信息泄露 / 内容篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危 (取决于配置和利用方式，可能导致RCE、敏感信息泄露或文件内容篡改)

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** RCE需要满足以下条件：writes enabled for default servlet, support for partial PUT, 使用Tomcat文件session持久化默认位置, 应用包含可被反序列化攻击利用的库。信息泄露/内容篡改需要满足以下条件：writes enabled for default servlet, support for partial PUT, security sensitive上传URL是公共上传URL的子目录, 攻击者知道security sensitive文件的名字, security sensitive文件也是通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是一个Apache Tomcat中的路径等价性漏洞，源于对文件名中内部点（'file.Name'）处理不当。根据漏洞描述和搜索结果，此漏洞在特定配置下可能导致远程代码执行（RCE）、信息泄露或恶意内容被添加到上传文件中。

**有效性：**
根据搜索引擎结果和漏洞描述，该漏洞已被积极利用。提供的PoC代码利用了Tomcat的partial PUT特性以及session持久化机制（在满足一定条件下），尝试通过上传恶意序列化数据来实现RCE。

**利用方式：**
1.  **前提条件：**
    *   Tomcat的default servlet需要开启写入功能（默认关闭）。
    *   需要启用partial PUT支持（默认开启）。
    *   （RCE）应用使用Tomcat的文件session持久化，且为默认存储位置。
    *   （RCE）应用包含可被反序列化攻击利用的库，例如存在fastjson, jackson等。
    *   （信息泄露/内容篡改）存在安全敏感文件上传URL是公共上传URL的子目录， 且攻击者知道该敏感文件名。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的序列化对象，对其进行Base64编码（PoC中`-d/--data` 参数）。
    *   攻击者指定目标URL（PoC中`-u/--url` 参数）。
    *   PoC脚本首先向目标URL发送PUT请求，其中`Content-Range`头指定了上传的范围，利用Tomcat的partial PUT特性。
    *   如果服务器返回409状态码，则表示partial PUT已成功处理。
    *   之后，PoC脚本会发送GET请求，并携带包含恶意序列化数据的JSESSIONID cookie（`.{random_str}`）。
    *   Tomcat反序列化session数据，从而触发RCE (如果满足RCE条件)。

**投毒风险：**
分析提供的PoC代码和Readme，可以发现：
*   脚本本身的功能是利用漏洞进行攻击。
*   脚本中没有发现明显的恶意代码，例如植入后门、篡改系统文件等。
*   脚本需要用户提供Base64编码的序列化数据，这意味着攻击者需要自行生成payload，脚本只是负责发送payload。
*   Readme中指明了利用方式及所需条件，较为详细。

因此，该仓库中存在作者隐藏的恶意代码的可能性较低，但不能完全排除。投毒风险评估为 10%。风险主要在于用户可能下载了被篡改过的poc，或者运行了来历不明的payload, 这些payload可能包含恶意行为。

**项目地址:** [AsaL1n/CVE-2025-24813](https://github.com/AsaL1n/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)