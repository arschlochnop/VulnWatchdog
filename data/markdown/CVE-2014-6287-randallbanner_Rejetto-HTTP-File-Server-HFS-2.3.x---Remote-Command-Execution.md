## CVE-2014-6287-Rejetto HFS 2.3.x-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 2.3.x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6287 存在于 Rejetto HTTP File Server (HFS) 2.3x 版本 (2.3c 之前) 的 `parserLib.pas` 文件中的 `findMacroMarker` 函数中。漏洞的利用方式是通过在搜索操作中发送包含 `%00` 序列的恶意请求，这允许攻击者执行任意程序。提供的漏洞利用代码 `hfs-2-3-exploit.py` 针对该漏洞，通过构建一个包含 PowerShell 反向 shell 的 URL，利用 `%00` 截断，从而在目标服务器上执行恶意代码，实现远程命令执行。该脚本首先检查目标URL是否为HTTP FileServer 2.3，然后使用 Nishang 的 Invoke-PowerShellTcpOneLine.ps1 命令生成反向shell payload，接着对payload进行Base64编码和URL编码，并将其嵌入到URL中。最后，脚本发送带有恶意payload的HTTP GET请求到目标服务器。Payload中使用了绕过执行策略的方法。代码中存在一定的投毒风险，体现在payload可以被修改为执行任何命令，如果该脚本被恶意传播，攻击者可以在受害者不知情的情况下执行任意命令。因为PowerShell payload是从Nishang获取，并且有base64编码，因此投毒风险相对较低，大约10%。

**项目地址:** [randallbanner/Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution](https://github.com/randallbanner/Rejetto-HTTP-File-Server-HFS-2.3.x---Remote-Command-Execution)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)