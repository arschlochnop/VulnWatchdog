## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，目标系统安装了受影响的Sudo版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是Sudo的一个本地提权漏洞。该漏洞允许本地用户利用`--chroot`选项和一个用户可控的`/etc/nsswitch.conf`文件来获得root权限。漏洞利用方式如下：

1.  攻击者创建一个包含恶意配置的`/etc/nsswitch.conf`文件，该文件会将密码查找指向一个攻击者控制的共享库（.so文件）。
2.  攻击者使用`sudo -R`选项，指定一个chroot目录，并将上述恶意`/etc/nsswitch.conf`文件放置在该chroot目录下。
3.  当sudo尝试在chroot环境下解析用户名时，会加载攻击者提供的恶意共享库，从而执行攻击者控制的代码。
4.  攻击者可以在恶意共享库中执行提权操作，例如调用`setuid(0)`来获得root权限。

根据提供的PoC代码，该代码创建了一个临时目录，并在该目录下创建了包含恶意配置的`nsswitch.conf`文件和一个共享库`woot1337.so.2`。然后，它使用`sudo -R`选项来执行一个命令，从而触发漏洞。代码的`README.txt`也明确说明了它的目的和原理。

**投毒风险分析：**

PoC代码的主要功能是创建一个受控的chroot环境，利用`nsswitch.conf`加载恶意`.so`文件以提权。主要风险点在于：
*   **Base64编码的`.so`文件：** 恶意代码可能隐藏在其中，但在本次情况下，`.so`文件包含的内容较少，更像是漏洞验证的PoC而非完整的后门代码。
*   **脚本的潜在恶意行为：** 脚本本身会创建临时目录和文件，删除操作可能存在疏忽，或者可能在其他位置留下后门。

总的来说，由于脚本明确声明为PoC，主要功能集中在漏洞利用，并且`.so`文件内容简单，存在恶意投毒的可能性较低，估计投毒风险在10%左右。务必在隔离环境中运行此POC。

**有效性评估：**

根据漏洞描述和PoC代码，以及搜索引擎结果中的相关信息，该漏洞利用方法是有效的。多个来源都确认了该漏洞的存在和严重性，并提供了相关的分析和PoC代码。


**项目地址:** [aldoClau98/CVE-2025-32463](https://github.com/aldoClau98/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)