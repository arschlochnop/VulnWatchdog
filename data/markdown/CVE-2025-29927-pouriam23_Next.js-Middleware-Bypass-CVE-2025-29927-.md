## CVE-2025-29927-Next.js-中间件认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用了Next.js中间件进行权限验证，且未对`x-middleware-subrequest`请求头进行校验

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js框架中一个严重的认证绕过漏洞，存在于Next.js中间件中。当应用程序使用中间件执行授权检查时，攻击者可以通过操纵`x-middleware-subrequest`头部来绕过这些检查，从而获得对受限资源的未授权访问。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被确认存在，并且有多个安全厂商发布了相关的分析报告和缓解措施。漏洞利用代码中虽然没有直接体现漏洞利用的Payload，但其环境搭建说明（Next.js项目结构，依赖等）可用于搭建存在漏洞的环境，进而验证和复现漏洞，从而验证其有效性。

**投毒风险：**
提供的漏洞利用代码主要是一个 Next.js 项目的脚手架代码，包括项目结构、依赖配置和一些示例代码。仔细检查这些文件，并未发现明显的恶意代码或后门。`package-lock.json` 文件列出了项目依赖的所有包及其版本，虽然可以通过篡改该文件引入恶意依赖，但目前的文件内容是标准的，没有可疑之处。但任何项目都存在供应链攻击的风险，通过依赖包引入恶意代码的可能性总是存在。考虑到这一点，以及对项目构建过程的潜在影响，投毒风险评估为10%。

**利用方式：**
1.  **目标确认:** 确认目标 Next.js 应用使用了中间件进行权限验证，并且版本在受影响范围内。
2.  **请求构造:** 构造包含 `x-middleware-subrequest` 头的恶意 HTTP 请求。可以通过 Burp Suite 或其他 HTTP 代理工具修改请求头。
3.  **权限绕过:** 将构造的恶意请求发送到目标 Next.js 应用。如果应用未正确处理 `x-middleware-subrequest` 头，中间件的权限验证逻辑将被绕过。
4.  **资源访问:** 成功绕过权限验证后，攻击者可以访问原本需要授权才能访问的资源。

**项目地址:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)