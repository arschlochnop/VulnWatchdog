## CVE-2025-29927-Next.js Middleware 认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用使用了Next.js中间件进行权限验证，且暴露在公网

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是一个 Next.js 中间件认证绕过漏洞。根据漏洞描述，当 Next.js 应用的中间件执行认证检查时，攻击者可以通过某种方式绕过这些检查，获得未授权的访问权限。 漏洞利用方式主要围绕 `x-middleware-subrequest` 请求头展开。 

**有效性：**

根据漏洞库信息和搜索结果，该漏洞是真实存在的，且已被公开披露。提供的POC代码是一个包含故意存在漏洞的Next.js 应用，用于安全研究和CTF练习，因此该POC代码是有效的.

**投毒风险：**

提供的POC代码主要用于漏洞复现和学习，其本身就是一个漏洞环境，因此直接包含恶意投毒代码的可能性较低。但依旧存在一定风险，比如作者可能会在示例代码中隐藏一些不易察觉的后门，这些后门可能不会直接影响漏洞复现，但可能在其他情况下被利用。因为从风险角度出发，这里给出一个较低的概率，大约10%。

**利用方式：**

1.  **漏洞触发点:** 漏洞发生在 Next.js 中间件处理认证逻辑时。
2.  **攻击向量:**  攻击者构造包含特定 `x-middleware-subrequest` 请求头的恶意请求。
3.  **绕过原理:** Next.js 在处理带有 `x-middleware-subrequest` 头部的请求时，由于不正确的处理逻辑，导致中间件中的身份验证检查被绕过。
4.  **攻击效果:** 攻击者可以绕过身份验证，访问受保护的资源，执行未授权操作，造成数据泄露等危害。
5.  **缓解措施:**  升级 Next.js 到 >= 14.2.25 或 >= 15.2.3 版本，或阻止包含 `x-middleware-subrequest` 头部的外部请求。

**项目地址:** [pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-](https://github.com/pouriam23/Next.js-Middleware-Bypass-CVE-2025-29927-)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)