## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，允许远程攻击者在目标系统上执行任意代码

**影响版本:** 见漏洞库信息中受影响的版本列表

**利用条件:** 目标系统需要启用IPv6

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2024-38063 是一个 Windows TCP/IP 协议栈中的远程代码执行漏洞，影响多个 Windows 版本。漏洞CVSS评分高达9.8，表明其严重性。搜索结果表明该漏洞可以通过发送特制的 IPv6 数据包来触发，允许攻击者在目标系统上执行任意代码。利用方式是远程的，不需要身份验证。提供的漏洞利用代码实际上是两个 PowerShell 脚本：`Audit-PatchInstalled-ipv6Vuln.ps1` 用于检查目标系统是否已安装相关的补丁，`Install-Patch-ipv6Vuln.ps1` 用于安装相应的补丁。 这些脚本本身没有恶意代码，用于检测和修复漏洞。因此，投毒风险为0%。 漏洞利用流程通常涉及构造恶意的IPv6数据包并发送到目标系统，利用TCP/IP协议栈解析过程中的整数下溢漏洞（CWE-191）进而执行任意代码，安装补丁可以修复此漏洞。

**有效性评估：**
鉴于搜索结果中存在多个关于该漏洞PoC的讨论和分析，以及CISA ADP Vulnrichment中 Exploitation 项被标记为 "poc"，可以判断存在可用的漏洞利用代码。 然而，提供的 PowerShell 脚本并不是真正的 PoC， 它们仅用于检测和安装补丁。

**利用方式总结：**
1.  攻击者构造恶意的IPv6数据包。
2.  将数据包发送到目标 Windows 系统。
3.  Windows TCP/IP 协议栈在处理该数据包时触发整数下溢。
4.  攻击者利用该漏洞执行任意代码。

**项目地址:** [dweger-scripts/CVE-2024-38063-Remediation](https://github.com/dweger-scripts/CVE-2024-38063-Remediation)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)