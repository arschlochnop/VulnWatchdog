## CVE-2023-41064 - ImageIO 缓冲区溢出漏洞

**漏洞编号:** CVE-2023-41064

**漏洞类型:** 缓冲区溢出

**影响应用:** ImageIO (macOS, iOS, iPadOS)

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** macOS < 11.7.10, macOS < 12.6.9, macOS < 13.5.2, iOS/iPadOS < 15.7.9, iOS/iPadOS < 16.6.1

**利用条件:** 需要用户处理恶意构造的图像文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-41064 是 ImageIO 框架中的一个缓冲区溢出漏洞，攻击者可以通过构造恶意的图像文件，诱使用户打开该图像，从而触发漏洞，导致任意代码执行。漏洞存在于处理图像的过程中，由于未充分进行内存边界检查，导致缓冲区溢出。根据CISA KEV目录，该漏洞已被积极利用。

**有效性：** 根据搜索结果，此漏洞存在公开的PoC。但是，提供的代码并非直接的漏洞利用PoC，而是一个包含前端（React）和后端（FastAPI）的示例项目，可能用于搭建一个演示或测试环境来触发和验证该漏洞，缺少直接利用漏洞的图片文件和触发方式，所以利用有效性偏低。

**投毒风险：** 提供的代码是项目环境搭建说明文档，描述了如何设置前端和后端，并提供了一些常见问题和故障排除的步骤。主要操作为`npm install` 和 `pip install -r requirements.txt`，恶意代码可能存在于`requirements.txt`或 `package.json` 中。 风险较低，初步判断，投毒风险为5%。 这是因为虽然没有直接看到明显的恶意代码，但是依赖安装过程存在引入恶意依赖的可能。

**利用方式：** 利用方式是诱使用户打开恶意构造的图像文件。攻击者需要先创建一个特制的图像文件，该文件包含能够触发 ImageIO 缓冲区溢出的恶意数据。当受害者使用存在漏洞的 ImageIO 版本打开该图像文件时，缓冲区溢出发生，攻击者可以利用这个溢出执行任意代码。由于漏洞利用需要用户交互(打开恶意图片)，因此攻击向量为本地攻击，但结合社会工程学手段，仍可实现远程攻击。


**项目地址:** [K4Der11000/k4_cve-2023-41064](https://github.com/K4Der11000/k4_cve-2023-41064)

**漏洞详情:** [CVE-2023-41064](https://nvd.nist.gov/vuln/detail/CVE-2023-41064)