## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software Web UI

**危害等级:** 高危，可被未授权的攻击者利用创建高权限用户并控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier

**利用条件:** Web UI 功能已启用且可远程访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞在受影响的系统上创建一个具有特权级别 15 访问权限的帐户，即完全控制设备的权限。

**有效性：**
根据漏洞库信息和搜索引擎结果，此漏洞已被积极利用，POC 代码的存在进一步证实了其有效性。

**利用方式：**
1.  攻击者首先利用 CVE-2023-20198 漏洞，通过发送特制的 HTTP POST 请求到 `/create_user` 接口，在目标设备上创建一个具有最高权限（privilege 15）的本地用户帐户。POC 代码中使用了 `requests` 库来发送这些请求。
2.  利用创建的本地用户账户，结合另一个漏洞 CVE-2023-20273（POC中实际上并没有利用这个漏洞, 只是进行了名称上的混淆，代码中根本不存在和该漏洞相关的任何利用代码）将权限提升到 root，并将恶意 implant 写入文件系统。
3.  植入的 implant 可以执行各种恶意操作，如数据窃取、后门访问等。
4.  通过发送 POST 请求到 `/restart_server` 接口重启Web服务使植入生效
5.  通过Get请求 `/implant_status` 来确定植入是否存在
6.  最后，可选地，可以通过 DELETE 请求到 `/delete_user/{username}` 接口删除之前创建的用于提权的用户帐户，以清除痕迹。

**投毒风险分析：**
POC 代码中存在一定的投毒风险，可能性大约为 10%。

*   **植入配置内容：**  `config_content = "<insert implant configuration content here>"`  这部分代码要求用户插入植入的配置内容。如果用户不小心插入了恶意配置，则可能导致目标系统受到感染。
*  **免责声明:** 该漏洞利用代码需要用户自行输入配置，如果用户使用不当，例如植入恶意后门，那么责任需要自行承担。该行为不是来自作者主动投毒，而是用户在不知情的情况下引入的风险。 

**注意：** POC 代码中的 `CVE-2021-1435` 是一个名称混淆，实际利用的是 CVE-2023-20273 或者其它方式来进行提权，但实际代码并没有实现对应功能。实际利用过程中需要结合其他漏洞或者已知信息来实现提权。

**项目地址:** [sohaibeb/CVE-2023-20198](https://github.com/sohaibeb/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)