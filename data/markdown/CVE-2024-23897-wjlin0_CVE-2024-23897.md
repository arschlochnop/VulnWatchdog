## CVE-2024-23897-Jenkins 任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Jenkins 2.441 and earlier, LTS 2.426.2 and earlier

**利用条件:** 目标Jenkins实例存在CLI接口，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 漏洞是 Jenkins 中由于 args4j 库在解析 CLI 命令参数时存在缺陷而导致的任意文件读取漏洞。未经身份验证的攻击者可以通过 Jenkins CLI 接口，利用'@'字符后跟文件路径的方式读取 Jenkins 控制器文件系统上的任意文件。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞真实存在且已被积极利用。提供的PoC代码是一个 Go 语言编写的利用工具，从其 `README.md` 文件中的描述和参数来看，可以确认该工具能够实现任意文件读取，列出可用命令，甚至执行 Jenkins 命令。因此，可以判断提供的PoC代码是有效的。

**投毒风险：**  PoC代码主要由 `LICENSE` 和 `README.md` 组成。`LICENSE` 采用MIT许可，较为常见，没有隐藏恶意代码的风险。`README.md` 主要介绍了工具的安装、使用方法和参数，从内容来看，没有发现明显的投毒代码。该仓库存在极低的投毒的可能性，例如：在下载链接中替换为恶意二进制文件，但鉴于GitHub平台具有一定的安全机制，用户可以通过checksum进行校验，所以判定投毒风险较低。

**利用方式：** 攻击者可以通过以下步骤利用该漏洞：
1.  确定目标 Jenkins 实例的版本是否在受影响范围内。
2.  使用提供的 PoC 工具，指定目标 Jenkins 实例的 URL。
3.  使用 `-c` 参数指定 Jenkins 命令，`-a` 参数指定文件路径，例如 `-c reload-job -a /etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
4.  使用 `-lac` 参数列出可用的 Jenkins 命令，从而更好地进行利用。
5.  如果 Jenkins 实例配置不当，攻击者可能还可以利用该漏洞执行任意命令。

**项目地址:** [wjlin0/CVE-2024-23897](https://github.com/wjlin0/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)