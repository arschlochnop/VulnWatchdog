## CVE-2025-29927-Next.js-Middleware认证绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 认证绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** Next.js 15.x < 15.2.3, 14.x < 14.2.25, Next.js 13.x < 13.5.9

**利用条件:** 应用程序使用Middleware进行认证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js中间件中的一个认证绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` 头来绕过中间件的认证检查，从而访问受保护的路由。根据漏洞描述和搜索引擎结果，该漏洞是由于Next.js对`x-middleware-subrequest` 头处理不当造成的。

**有效性分析：**

提供的POC代码似乎有效，因为它演示了如何使用带有特定值的`x-middleware-subrequest`头来发送请求，从而绕过认证。

**投毒风险分析：**

虽然大部分代码看起来是标准的 Next.js 项目结构，但是考虑到：

1.  POC中的 `x-middleware-subrequest` 的值非常长且重复， `src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware` 这种重复可能触发未知的代码行为，从而达到注入恶意代码的目的。
2.  POC使用了ChatGPT生成，这有一定概率掺入不安全的代码。

综合来看，存在一定的投毒可能性，但可能性较低。初步估计为10%。

**利用方式：**

1.  目标应用需要使用Next.js，并且使用了middleware来做认证。
2.  攻击者构造一个HTTP请求，其中包含`x-middleware-subrequest`头，并将该头的值设置为特定的字符串，例如`src/middleware:src/middleware:src/middleware:src/middleware:src/middleware:src/middleware`。
3.  将构造的请求发送到目标应用的受保护路由。
4.  如果漏洞存在，攻击者将能够绕过认证，访问受保护的资源。

**项目地址:** [ethanol1310/POC-CVE-2025-29927-](https://github.com/ethanol1310/POC-CVE-2025-29927-)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)