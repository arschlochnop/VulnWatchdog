## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 用户名称或主机名称包含shell元字符，并且该名称在某些情况下被扩展令牌引用。需要能够触发使用了这些名称的SSH操作。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-51385 是 OpenSSH 9.6 之前版本中的一个命令注入漏洞。当用户名或主机名包含shell元字符时，如果这个名字被某些情况下的扩展令牌引用，就可能发生操作系统命令注入。例如，一个不受信任的 Git 仓库可能有一个子模块，其用户名或主机名中包含 shell 元字符。利用方式是构造包含恶意 shell 元字符的用户名或主机名，并触发 OpenSSH 使用该名称的操作，例如通过包含恶意子模块的 Git 仓库。提供的POC代码只是一个README.md文件，不包含任何可执行代码，因此，不存在投毒风险。

**有效性：** 提供的POC代码只是一个README文件，本身不具备漏洞利用能力，因此本身提供的POC无效，需要结合其他方式触发。但是漏洞本身是存在的，搜索结果表明该漏洞存在并且可以利用。

**投毒风险：** 提供的 POC 代码仅包含一个 README.md 文件，没有任何可执行代码，因此不存在投毒风险。

**利用方式：** 漏洞的利用方式是构造包含恶意 shell 元字符的用户名或主机名，然后让 OpenSSH 在处理 SSH 连接或相关操作时引用这些名字。例如，可以通过创建一个包含恶意用户名或主机名的 Git 子模块，然后当用户尝试克隆或更新该 Git 仓库时，触发命令注入。ProxyCommand也是一个常见的攻击点，在ssh config中可以使用ProxyCommand执行任意命令。攻击者可以在用户名或主机名中嵌入恶意命令，这些命令会在 ProxyCommand 被调用时执行。

**项目地址:** [julienbrs/exploit-CVE-2023-51385](https://github.com/julienbrs/exploit-CVE-2023-51385)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)