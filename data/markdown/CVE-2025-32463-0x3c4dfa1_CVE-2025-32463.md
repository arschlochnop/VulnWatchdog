## CVE-2025-32463-Sudo-Chroot权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 到 1.9.17p1之前

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞允许本地用户通过`sudo -R` 和 `--chroot`选项，指定用户可控的`/etc/nsswitch.conf`文件，从而影响名称服务解析。攻击者可以创建一个恶意的`nsswitch.conf`文件，指向一个恶意的共享库。Sudo在chroot环境下会加载这个恶意库，恶意库在加载时执行代码，因为是在chroot环境下执行的，所以需要创建一个临时的chroot目录，并将恶意的`nsswitch.conf` 和 恶意共享库放入该目录。漏洞利用代码首先创建一个临时目录，编译一个共享库`libnss_/woot1337.so.2`，其包含一个constructor函数`woot()`，该函数会设置UID和GID为0，然后执行`/bin/bash`。接着，创建 `woot/etc/nsswitch.conf`文件，内容为 `passwd: /woot1337`，指向恶意的共享库。最后，使用 `sudo -R woot woot` 命令，触发漏洞。由于用户提供的`/etc/nsswitch.conf` 文件会被使用，系统会加载恶意的共享库，执行`woot()`函数，从而获得root权限。

**有效性：**
提供的POC代码有效，能够利用该漏洞获取root权限。

**投毒风险：**
POC代码中存在一定的投毒风险，大约为10%。虽然主要功能是利用漏洞提权，但恶意作者可能在`woot1337.c`或`exploit.sh`中加入其他恶意行为，比如上传用户信息、安装后门等。此处的投毒风险评估较低，因为代码相对简单，容易审计。真正的风险在于，如果攻击者修改了这个POC并广泛传播，那么恶意代码可能会被隐藏在更复杂的逻辑中，难以被发现。

**利用方式：**
1.  创建一个包含恶意代码的共享库（`.so`文件）。
2.  创建一个恶意的`nsswitch.conf`文件，指向该共享库。
3.  使用 `sudo -R woot woot` 命令，指定使用用户创建的 chroot 目录和 `nsswitch.conf` 文件。
4.  当 Sudo 加载恶意 `nsswitch.conf` 时，共享库中的恶意代码会被执行，从而获取 root 权限。

**项目地址:** [0x3c4dfa1/CVE-2025-32463](https://github.com/0x3c4dfa1/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)