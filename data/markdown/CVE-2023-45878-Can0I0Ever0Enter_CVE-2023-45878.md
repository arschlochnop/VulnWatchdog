## CVE-2023-45878 - GibbonEdu Gibbon Arbitrary File Write

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu Gibbon

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 目标系统运行GibbonEdu Gibbon，且攻击者可以访问rubrics_visualise_saveAjax.phps接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu Gibbon 25.0.1 及更早版本中。攻击者可以未经身份验证地利用 `rubrics_visualise_saveAjax.phps` 接口中的任意文件写入漏洞。该接口接受 `img`、`path` 和 `gibbonPersonID` 参数。`img` 参数应为 base64 编码的图像，而 `path` 参数用于指定目标文件夹。漏洞利用方式如下：

1.  攻击者构造一个包含恶意 PHP 代码的 `img` 参数，并将其进行 base64 编码。
2.  攻击者构造一个 `path` 参数，指定文件写入的路径，通常指向Web可访问的目录。
3.  攻击者向 `rubrics_visualise_saveAjax.phps` 接口发送包含恶意 `img` 和 `path` 参数的 POST 请求。
4.  服务器将 `img` 参数的内容进行 base64 解码，并将其写入 `path` 参数指定的文件中。
5.  攻击者可以通过访问写入的 PHP 文件来执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞利用是有效的，因为 `rubrics_visualise_saveAjax.phps` 不需要身份验证，且允许写入任意文件。多个来源都证实了该漏洞的存在和利用方式。

**投毒风险：**

提供的漏洞利用代码 `/tmp/6b1d57c6d1772cd170f27ac4407e95a1/README.md`  只包含了一个README文件，内容仅为 CVE 编号。这本身不构成漏洞利用代码，更不包含任何恶意代码。风险评估主要是针对这个存储库中是否还存在其他隐藏的恶意内容。只包含README文件，没有实际的exp，投毒风险相对较低，但仍存在代码仓库作者在其他地方隐藏恶意代码的可能性，因此认为投毒风险为10%。

**利用方式：**

利用方式主要是通过构造恶意的POST请求，向`rubrics_visualise_saveAjax.phps`发送base64编码的PHP代码，并通过`path`参数指定写入路径，从而在服务器上写入恶意PHP文件，最终实现远程代码执行。

**项目地址:** [Can0I0Ever0Enter/CVE-2023-45878](https://github.com/Can0I0Ever0Enter/CVE-2023-45878)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)