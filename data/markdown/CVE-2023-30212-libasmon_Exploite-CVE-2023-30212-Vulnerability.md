## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户信息泄露、会话劫持等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户访问恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212是一个存在于OURPHP <= 7.2.0中的反射型XSS漏洞，位于`/client/manage/ourphp_out.php`。攻击者可以通过构造包含恶意JavaScript代码的URL，诱导用户点击，从而在用户浏览器中执行任意脚本。 

**有效性：**
根据漏洞信息和提供的POC代码，该漏洞利用是有效的。POC代码中的URL `http://localhost:8080/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert(`xss`)</script>` 演示了如何通过 `out` 参数注入XSS代码。

**投毒风险：**
提供的Docker环境和相关文件主要用于漏洞复现，投毒风险较低。虽然其中可能存在作者为了快速搭建环境而使用的简化或不安全配置，但没有明显的证据表明存在故意隐藏的恶意代码。

具体分析：
* `README.md` 文件主要包含Docker环境的搭建步骤和漏洞利用的说明，没有发现可疑代码。
* `admin.php` 文件是OURPHP的后台登录验证文件，用于验证管理员身份，未发现恶意代码。

当然，任何从非官方渠道下载的代码都存在一定风险，建议在安全环境中进行测试和分析。总体评估，投毒风险约为10%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://example.com/client/manage/ourphp_out.php?ourphp_admin=logout&out=</script><script>alert('XSS')</script>`。
2.  攻击者通过各种手段（如邮件、社交媒体等）诱导用户点击该URL。
3.  用户点击URL后，恶意JavaScript代码会在用户浏览器中执行，攻击者可以利用该代码进行各种恶意操作，例如窃取用户Cookie、篡改页面内容等。

**项目地址:** [libasmon/Exploite-CVE-2023-30212-Vulnerability](https://github.com/libasmon/Exploite-CVE-2023-30212-Vulnerability)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)