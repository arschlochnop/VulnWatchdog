## CVE-2018-6574

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程代码执行

**影响应用:** Go

**危害等级:** 高危，允许远程代码执行

**影响版本:** Go < 1.8.7, Go 1.9.x < 1.9.4, Go 1.10 pre-releases < Go 1.10rc2

**利用条件:** 目标系统需要使用受影响的Go版本，攻击者需要能够让目标系统通过`go get`获取包含恶意代码的包。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 漏洞允许攻击者在构建 Go 项目时执行任意代码。该漏洞源于 `go get` 命令在处理 gcc 或 clang 插件选项时没有正确过滤 `-fplugin` 和 `-plugin` 参数。攻击者可以通过构造包含恶意 `// #cgo CFLAGS: -fplugin=./attack.so` 的 Go 代码，诱使受害者使用 `go get` 命令下载并构建该项目。构建过程中，会加载攻击者提供的恶意插件（attack.so），从而执行任意代码。

漏洞利用方式：

1.  攻击者创建一个包含恶意代码的 Go 项目。
2.  项目中的 Go 文件包含 `// #cgo CFLAGS: -fplugin=./attack.so` 这样的注释，指定加载恶意的插件。
3.  攻击者将项目托管在公开的代码仓库中。
4.  受害者使用 `go get` 命令获取该项目。
5.  `go get` 在构建项目时，会加载并执行攻击者提供的恶意插件。

根据提供的代码，`attack.c` 文件中定义了一个名为 `malicious` 的函数，该函数使用 `system` 函数执行命令 `/usr/local/bin/score 91e025d6-94e9-4d26-8b86-c00dea0b3129`。这个命令看起来像是用于提交漏洞利用得分的，本身不包含恶意或投毒行为。`main.go` 文件则通过 cgo 技术，将 attack.so 文件编译为插件,并通过 // #cgo CFLAGS指定。

有效性：提供的POC代码有效，能实现远程代码执行。
投毒风险：在给定的代码中，没有发现明显的投毒行为。`attack.c` 中的 system 命令只是执行了一个特定的脚本，用于提交得分，没有发现进一步利用或危害系统的代码。



**项目地址:** [solovvway/CVE-2018-6574](https://github.com/solovvway/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)