## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞 (Follina)

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本和Office版本见漏洞库信息

**利用条件:** 需要用户打开恶意Word文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190（又名Follina）是一个远程代码执行漏洞，存在于Microsoft Windows Support Diagnostic Tool (MSDT)中。攻击者可以利用此漏洞通过特制的Word文档，使用Word的远程模板功能从远程Web服务器检索HTML文件，从而在受害者系统上执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用是有效的。漏洞库信息和搜索结果都表明这是一个真实存在的、被广泛利用的漏洞。POC代码（虽然只是一个README.md文件）指向了一个实际的利用项目，说明了利用方式和受影响的系统版本，证明了漏洞的可利用性。

**投毒风险：** 分析提供的仓库内容，风险评估如下：

*   **README.md文件：** 本身不包含任何可执行代码，因此直接的投毒风险较低。
*   **外部链接：**  主要风险在于指向的`Hrishikesh7665/Follina_Exploiter_CLI`仓库。虽然原作者注明了License，但是仍然存在投毒的可能性。

综合分析，考虑到代码仓库可能存在恶意修改的风险，虽然直接投毒可能性较低，但间接风险不可忽视，因此评估投毒风险为10%。

**利用方式：** 漏洞的利用方式通常包括以下步骤：

1.  **构造恶意Word文档：** 攻击者创建一个包含恶意链接的Word文档。该链接指向一个由攻击者控制的远程Web服务器，并使用`ms-msdt:` URL协议调用MSDT。
2.  **诱骗受害者打开文档：** 攻击者通过电子邮件、社交媒体或其他方式将恶意文档发送给受害者。
3.  **执行恶意代码：** 当受害者打开文档时，Word会尝试从远程服务器检索HTML文件。该HTML文件包含恶意JavaScript代码，该代码利用MSDT执行任意命令。
4.  **控制系统：** 通过执行的命令，攻击者可以在受害者系统上安装恶意软件、窃取数据或执行其他恶意活动。

**项目地址:** [yeep1115/ICT287_CVE-2022-30190_Exploit](https://github.com/yeep1115/ICT287_CVE-2022-30190_Exploit)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)