## CVE-2025-21298 - Windows OLE 远程代码执行漏洞

**漏洞编号:** CVE-2025-21298

**漏洞类型:** 双重释放 (Use-After-Free)

**影响应用:** Windows OLE

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本包括Windows 10, Windows Server 2019, Windows Server 2022, Windows 11等，具体版本范围请参考漏洞库信息。

**利用条件:** 攻击者需要能够让目标系统处理恶意的OLE对象。根据搜索结果，可能通过发送包含恶意RTF文档的邮件进行攻击。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-21298 是一个 Windows OLE 远程代码执行漏洞，CVSS 评分为 9.8。根据漏洞利用代码（PoC）的描述，该漏洞存在于 `ole32.dll!UtOlePresStmToContentsStm` 函数中。 

**漏洞分析：**

1.  **漏洞原理：** 该漏洞是由于 `UtOlePresStmToContentsStm` 函数对 `pstmContents` 变量的处理不当造成的双重释放漏洞。函数首先创建一个 "CONTENTS" 流对象，并将其指针存储在 `pstmContents` 中。然后，立即释放该流对象，但 `pstmContents` 仍然包含指向已释放内存的指针。

2.  **触发条件：** 如果 `UtReadOlePresStmHeader` 函数失败，则 `pstmContents` 仍将指向已释放的内存，导致在清理代码中再次释放该指针，从而触发双重释放漏洞。

3.  **利用方式：**
    *   攻击者创建一个包含恶意 OLE 对象的文档（例如 RTF 文档）。
    *   当受害者打开该文档时，`ole32.dll!UtOlePresStmToContentsStm` 函数被调用。
    *   如果 `UtReadOlePresStmHeader` 函数失败，则会触发双重释放漏洞，从而导致程序崩溃或执行攻击者提供的恶意代码。

4. **有效性评估：** 提供的PoC代码旨在展示内存损坏，虽然不是完整的利用exp，但可用于验证该漏洞的存在及影响。通过触发双重释放，可以为进一步的利用铺平道路。

5.  **投毒风险评估：**  提供的代码仅为概念验证，旨在重现双重释放漏洞。代码的功能相对简单，没有发现作者隐藏的恶意代码或后门。因此，**投毒风险评估为 0%**。

**总结：**

CVE-2025-21298 是一个高危的 Windows OLE 远程代码执行漏洞，攻击者可以利用该漏洞在受害者系统上执行任意代码。尽管提供的 PoC 仅仅是展示内存破坏，但足以证明漏洞的存在。建议用户及时安装 Microsoft 提供的补丁。

**项目地址:** [Dit-Developers/CVE-2025-21298](https://github.com/Dit-Developers/CVE-2025-21298)

**漏洞详情:** [CVE-2025-21298](https://nvd.nist.gov/vuln/detail/CVE-2025-21298)