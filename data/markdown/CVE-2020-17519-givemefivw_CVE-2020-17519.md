## CVE-2020-17519 Apache Flink 任意文件读取

**漏洞编号:** CVE-2020-17519

**漏洞类型:** 目录遍历/文件读取

**影响应用:** Apache Flink

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 1.11.0 to 1.11.2

**利用条件:** Flink JobManager REST API 端口对外开放，且目标为受影响版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-17519 是一个 Apache Flink 中的目录遍历漏洞，存在于 1.11.0 到 1.11.2 版本中。攻击者可以通过 JobManager 进程的 REST 接口读取 JobManager 进程可访问的本地文件系统上的任何文件，无需身份验证。利用方式是通过构造包含目录遍历序列（如 `..%252f`）的 URL，向 JobManager 的特定端点（`/jobmanager/logs`）发送 HTTP GET 请求。提供的POC代码使用Cheetah语言编写，通过读取ip.txt文件中的IP地址列表，批量发送构造好的HTTP请求，检测目标是否存在漏洞，并通过判断响应内容中是否包含"root"字符串来验证/etc/passwd文件是否读取成功。虽然POC本身功能是验证漏洞，但脚本设计上存在潜在投毒风险：1. ip.txt文件可能被替换为包含恶意IP地址的列表，导致扫描行为扩散； 2. 读取到的文件内容可能会被上传到恶意服务器，导致信息泄露。根据代码文件和说明文档的分析,认为主要功能为漏洞探测,但存在小概率的潜在利用可能,因此判断投毒风险为10%。

**项目地址:** [givemefivw/CVE-2020-17519](https://github.com/givemefivw/CVE-2020-17519)

**漏洞详情:** [CVE-2020-17519](https://nvd.nist.gov/vuln/detail/CVE-2020-17519)