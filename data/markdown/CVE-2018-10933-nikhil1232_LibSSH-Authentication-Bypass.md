## CVE-2018-10933 - libssh Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** Authentication Bypass

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.6 - 0.7.5, 0.8 - 0.8.3 (修复于 0.7.6 和 0.8.4)

**利用条件:** 目标服务器运行存在漏洞的libssh版本且监听SSH端口

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-10933 存在于 libssh 的服务器端状态机中，允许未经身份验证的客户端创建通道并执行命令。利用方式是向服务器发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，绕过身份验证流程。提供的POC代码使用 `paramiko` 库连接到目标服务器，然后直接发送身份验证成功的消息，之后打开一个会话并执行指定的命令。

**有效性：**
根据漏洞描述和提供的POC代码，可以判断此POC代码是有效的。它模拟了未经身份验证的客户端行为，直接发送身份验证成功的消息，从而绕过正常的身份验证过程。

**投毒风险：**
在分析提供的Python脚本和README文件后，投毒风险较低。脚本本身实现了CVE-2018-10933漏洞的利用，功能较为直接。README文件提供了使用说明和参考链接，没有发现任何可疑或恶意的代码。5%的风险评估主要是考虑到任何代码都存在潜在的、未知的风险，例如编码错误或其他隐藏的依赖项。

**利用方式：**
1.  使用`socket`库建立与目标服务器的TCP连接。
2.  使用`paramiko`库创建一个SSH传输对象。
3.  启动客户端传输。
4.  构建一个包含`paramiko.common.cMSG_USERAUTH_SUCCESS`的消息，模拟身份验证成功。
5.  使用`transport._send_message(message)`方法将消息发送到服务器。
6.  打开一个新的会话 (`transport.open_session()`)。
7.  执行目标命令 (`cmd.exec_command(command)`)。
8.  读取命令输出并打印。

**项目地址:** [nikhil1232/LibSSH-Authentication-Bypass](https://github.com/nikhil1232/LibSSH-Authentication-Bypass)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)