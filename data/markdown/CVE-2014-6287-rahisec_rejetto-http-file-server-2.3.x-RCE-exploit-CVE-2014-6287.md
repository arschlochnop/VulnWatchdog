## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致远程命令执行，完全控制服务器

**影响版本:** 2.3x (before 2.3c)

**利用条件:** 目标系统运行存在漏洞的Rejetto HFS版本，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Rejetto HTTP File Server 2.3x版本中，具体是`parserLib.pas`文件中的`findMacroMarker`函数。攻击者可以通过在search动作中利用`%00`序列，绕过过滤，从而执行任意程序。

**利用方式：**

1.  攻击者首先需要在目标服务器上寻找或上传`nc.exe` (Netcat) 或者其他类似功能的程序，如果目标服务器上没有此类程序，漏洞利用脚本会尝试下载。
2.  攻击者利用`%00`截断漏洞，构造恶意的URL，将命令注入到HFS的查询参数中。
3.  注入的命令首先会下载`nc.exe`到目标服务器，然后执行该程序，反弹shell到攻击者控制的服务器。

**有效性：**

提供的PoC代码有效，利用了CVE-2014-6287漏洞。该代码包含一个Python脚本，可以自动执行漏洞利用过程，包括：

*   生成包含恶意命令的URL。
*   发送HTTP请求到目标服务器。
*   触发命令执行。

**投毒风险：**

该仓库存在一定的投毒风险，风险比例为10%。

*   `exploit.py`脚本本身没有明显的恶意代码，但它依赖于从攻击者控制的HTTP服务器下载`nc.exe`。这意味着，攻击者可以替换`nc.exe`为包含恶意代码的程序，从而在目标服务器上执行任意恶意操作。如果用户没有验证下载的`nc.exe`文件的安全性，就存在被投毒的风险。
*   `README.md`中提到“You may need to run the payload multiple time to get a reverse shell.” 这可能导致用户在不知情的情况下多次运行恶意代码，增加了被攻击的风险。

**项目地址:** [rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287](https://github.com/rahisec/rejetto-http-file-server-2.3.x-RCE-exploit-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)