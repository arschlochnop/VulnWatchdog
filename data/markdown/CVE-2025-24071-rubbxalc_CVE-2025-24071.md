## CVE-2025-24071 - Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** Spoofing / NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 高危，可能导致凭据泄露和网络渗透

**影响版本:** 受影响版本包括Windows 10, Windows Server 2019, Windows 11等，具体参见CVE描述中的版本范围

**利用条件:** 需要将恶意ZIP文件发送给目标用户，并诱导其解压

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以构造一个包含恶意`.library-ms`文件的ZIP压缩包，当受害者解压该ZIP文件时，Windows会自动尝试连接到`.library-ms`文件中指定的SMB共享，从而导致受害者的NetNTLMv2哈希值被泄露。利用方式如下：

1.  **漏洞原理：** Windows文件资源管理器在处理`.library-ms`文件时，会解析其中的SMB路径，并尝试连接。
2.  **攻击步骤：**
    *   攻击者编写一个Python脚本，该脚本会生成一个包含恶意`.library-ms`文件的ZIP文件。恶意`.library-ms`文件中的SMB路径指向攻击者的服务器。
    *   攻击者启动Responder之类的工具，监听网络上的SMB连接。
    *   攻击者将生成的ZIP文件发送给受害者。
    *   受害者解压ZIP文件，Windows文件资源管理器会自动尝试连接到恶意`.library-ms`文件中指定的SMB共享。
    *   Responder捕获到受害者的NetNTLMv2哈希值。
3.  **有效性：** 根据漏洞描述和POC代码，此漏洞利用方式是有效的，可以捕获受害者的NetNTLMv2哈希值。
4.  **投毒风险：** 经过分析，提供的POC代码的功能是按照描述生成包含恶意`.library-ms`文件的ZIP文件，没有发现作者隐藏的恶意代码或后门，因此投毒风险为0%。所有的操作都是围绕利用该漏洞进行。
5.  **利用方式总结：** 利用Windows Explorer解析`.library-ms`文件时自动尝试连接SMB共享的特性，诱导用户解压包含恶意文件的ZIP包，从而在用户无感知的情况下获取NetNTLMv2 hash。

**项目地址:** [rubbxalc/CVE-2025-24071](https://github.com/rubbxalc/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)