## CVE-2025-61301 - CAPEv2: 拒绝分析服务漏洞

**漏洞编号:** CVE-2025-61301

**漏洞类型:** 拒绝服务 (Denial-of-Service)

**影响应用:** CAPEv2

**危害等级:** 高危，导致无法进行恶意软件分析

**影响版本:** commit 52e4b43

**利用条件:** 需要能够向CAPEv2提交样本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

此漏洞存在于CAPEv2的`reporting/mongodb.py` 和 `reporting/jsondump.py` 中。攻击者可以通过提交恶意样本，样本执行时生成深度嵌套或过大的行为数据，触发MongoDB的BSON大小或嵌套深度限制，或者orjson的递归错误，导致CAPEv2分析报告不完整或丢失，从而实现拒绝分析服务。

**有效性：**

根据提供的漏洞利用代码（README.md），该漏洞的PoC是有效的。README.md详细描述了漏洞原理、利用方法和影响，并提供了证据表明，精心构造的恶意样本可以触发MongoDB和JSON序列化限制，导致报告生成失败。

**投毒风险：**

此漏洞利用代码主要描述了漏洞的原理和利用方法，并未发现明显的恶意代码或后门。 投毒风险较低。风险预估在5%左右，主要来自代码贡献者可能在未来提交包含恶意代码的更新，或者被攻击者控制后植入恶意代码。

**利用方式：**

1.  **构造恶意样本：** 攻击者需要构造一个恶意样本，该样本在沙箱环境中执行时，能够产生大量的进程、API调用或递归数据，从而生成非常大的行为报告。
2.  **触发MongoDB限制：** 行为报告超过MongoDB的16MB BSON大小限制或100层嵌套深度限制。
3.  **触发JSON序列化错误：** 行为报告的深度嵌套或递归结构导致orjson序列化器达到Python的递归限制。
4.  **导致分析失败：** 上述任何一种情况都会导致CAPEv2无法生成完整的分析报告，从而绕过行为检测，产生不完整或缺失的分析报告，最终达到拒绝分析服务的目的。

**项目地址:** [eGkritsis/CVE-2025-61301](https://github.com/eGkritsis/CVE-2025-61301)

**漏洞详情:** [CVE-2025-61301](https://nvd.nist.gov/vuln/detail/CVE-2025-61301)