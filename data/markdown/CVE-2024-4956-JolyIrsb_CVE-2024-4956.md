## CVE-2024-4956-Sonatype Nexus Repository 3-路径遍历

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，可读取任意文件

**影响版本:** <= 3.68.0

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造包含目录遍历序列的 URL 来读取服务器上的任意文件。 

**有效性分析：**
提供的 Python 脚本 `CVE-2024-4956-threads.py` 旨在利用此漏洞。 它通过构造包含多个 `/%2F` 和 `../` 序列的 URL 来尝试读取目标服务器上的 `/etc/passwd` 文件。如果响应状态码为 200，则脚本认为该主机存在漏洞。提供的nuclei模版可以用来验证漏洞的存在。

**投毒风险分析：**
代码本身实现的功能为读取目标机器上的文件，从代码功能上判断，存在一定的投毒风险，例如代码的作者可以在check_vulnerability函数中添加额外的恶意代码,用于收集目标主机的信息或者植入后门程序，但从目前的代码来看，没有发现直接的投毒代码。README.md 中的声明也暗示了风险的存在。综合考虑，投毒风险较低，约为10%。因为代码的功能相对简单，如果存在恶意代码容易被发现。 

**利用方式分析：**
1.  攻击者构造包含目录遍历序列（例如 `/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`）的 URL。
2.  Nexus Repository Manager 3 错误地处理该 URL，允许攻击者访问受限目录之外的文件。
3.  攻击者可以读取服务器上的敏感文件，例如配置文件、源代码和系统文件。
4.  使用提供的Python脚本,可以批量对目标进行扫描,识别存在漏洞的主机。
5.  漏洞利用代码中的nuclei模版，包含主动扫描和被动提取版本，方便漏洞验证

**项目地址:** [JolyIrsb/CVE-2024-4956](https://github.com/JolyIrsb/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)