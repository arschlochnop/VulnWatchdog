## CVE-2025-8518-Vvveb-代码注入

**漏洞编号:** CVE-2025-8518

**漏洞类型:** 代码注入

**影响应用:** Vvveb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.0.5

**利用条件:** 需要高权限（模板编辑权限）的用户身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8518是givanz Vvveb 1.0.5版本中Code Editor组件的admin/controller/editor/code.php文件的Save函数存在代码注入漏洞。攻击者需要拥有管理员权限或者具备模板编辑权限的用户才能利用此漏洞。提供的漏洞利用代码是一个Docker化的PoC，它首先部署了存在漏洞的Vvveb 1.0.5版本。根据Deployment-Instructions.md文件，该PoC通过以下步骤完成：

1.  **环境准备:** 使用Docker和Docker Compose来搭建环境。
2.  **下载Vvveb CMS:** 下载存在漏洞的Vvveb 1.0.5版本的压缩包，并解压。
3.  **配置Docker环境:**
    *   创建`.dockerignore`文件，用于排除不必要的文件，加快构建速度。
    *   修改`Dockerfile`，添加`libicu-dev`依赖，这是`intl` PHP扩展所需要的。
    *   修复Nginx配置，确保PHP请求能够正确路由到PHP-FPM容器。
4.  **启动应用:** 使用`docker-compose up -d --build`命令构建并启动Docker容器，然后在浏览器中访问`http://localhost:8080`，按照提示完成安装。

漏洞利用方式是，攻击者在成功部署并安装Vvveb 1.0.5后，利用具备模板编辑权限的账户登录后台，在代码编辑器中编辑模板文件，并插入恶意的PHP代码。保存后，当模板被调用时，恶意代码就会被执行，从而导致远程代码执行。

**有效性评估：**根据漏洞库信息和提供的PoC代码，此漏洞是有效的，并且已经公开了利用方式。

**投毒风险评估：**  PoC本身目的是为了验证漏洞的存在，本身就包含后门代码。但是，PoC中可能存在一些隐蔽的、非必要的操作，例如在修改Dockerfile或Nginx配置时，添加一些恶意代码或配置，从而在用户不知情的情况下植入后门。但是代码量相对较小，审查容易，所以判断投毒风险较低，为10%。这部分代码的目的是为了搭建环境，确保漏洞能够成功利用，不属于投毒代码。

总的来说，此漏洞利用的有效性高，但考虑到需要高权限用户配合，并且PoC需要部署，所以利用难度中等。投毒风险较低，但仍需要仔细审查PoC代码，确保没有隐藏的恶意行为。

**项目地址:** [maestro-ant/Vvveb-CMS-CVE-2025-8518](https://github.com/maestro-ant/Vvveb-CMS-CVE-2025-8518)

**漏洞详情:** [CVE-2025-8518](https://nvd.nist.gov/vuln/detail/CVE-2025-8518)