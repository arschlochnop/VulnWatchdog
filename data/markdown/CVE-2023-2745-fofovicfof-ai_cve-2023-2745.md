## CVE-2023-2745-WordPress-目录遍历

**漏洞编号:** CVE-2023-2745

**漏洞类型:** 目录遍历

**影响应用:** WordPress

**危害等级:** 中危，可能导致敏感信息泄露或XSS攻击

**影响版本:** <= 6.2.1

**利用条件:** 需要目标WordPress站点存在且未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-2745是一个WordPress核心的目录遍历漏洞，存在于6.2.1及之前的版本中。该漏洞源于对`wp_lang`参数的过滤不足，允许未经身份验证的攻击者访问和加载任意翻译文件。攻击者可以通过构造包含`../`的恶意`wp_lang`参数，读取服务器上的敏感文件，如`/etc/passwd`。如果攻击者能够上传恶意翻译文件到站点（例如通过上传表单），也可能被用于执行跨站脚本攻击（XSS）。

**有效性：**
提供的Python脚本`check_cve-2023-2745.py`尝试利用该漏洞。它首先尝试确定WordPress版本，如果版本高于6.2，则退出并显示漏洞已修复。否则，它会尝试通过`wp_lang`参数读取`/etc/passwd`文件，如果成功，则报告漏洞存在。

**投毒风险：**
代码本身看起来比较直接，没有明显的恶意行为。脚本的目的很明确，即检查目标站点是否存在CVE-2023-2745漏洞。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造一个包含恶意`wp_lang`参数的URL，例如`https://example.com/wp-login.php?wp_lang=../../../../../../../../etc/passwd%00`。
2.  攻击者向目标WordPress站点发送包含该恶意URL的HTTP请求。
3.  如果目标站点存在漏洞，则服务器会返回`/etc/passwd`文件的内容。
4.  攻击者可以利用读取到的信息，或者尝试读取其他敏感文件，或者上传恶意文件进行攻击。

总之，该漏洞的利用依赖于目标站点未打补丁，且攻击者可以构造恶意URL。提供的POC代码可以有效地检测目标站点是否存在该漏洞。

**项目地址:** [fofovicfof-ai/cve-2023-2745](https://github.com/fofovicfof-ai/cve-2023-2745)

**漏洞详情:** [CVE-2023-2745](https://nvd.nist.gov/vuln/detail/CVE-2023-2745)