## CVE-2025-8088-WinRAR-路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 需要用户主动解压恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞，攻击者可以利用该漏洞构造恶意 RAR 压缩文件，当用户解压该文件时，恶意文件会被释放到任意目录，包括 Windows 启动目录，从而实现任意代码执行。

**利用方式：**
1.  **构造恶意RAR文件：** 攻击者创建一个包含特制的 RAR 文件，该文件包含带有路径遍历字符（例如 "../"）的文件名。
2.  **诱导用户解压：** 通过社会工程学或其他手段，诱导用户使用受影响的 WinRAR 版本解压该恶意 RAR 文件。
3.  **执行恶意代码：** 当 WinRAR 解压该文件时，路径遍历字符会将恶意文件释放到预先设定的敏感目录（例如启动目录），恶意代码会在系统启动时自动执行。

**POC 分析：**
提供的 Python POC 脚本 `CVE-2025-8088.py` 旨在生成一个利用 CVE-2025-8088 漏洞的恶意 RAR 文件。

*   **路径遍历：** 脚本使用 `PATH_TRAVERSALS` 列表定义了不同的路径遍历模式，例如 "../"，用于在 RAR 压缩包中构造恶意路径。
*   **Payload 植入：** 脚本将 `PAYLOAD` 定义为要执行的恶意命令，默认情况下，它只是一个简单的 echo 命令，但可以修改为任何恶意代码。
*   **ADS 注入**: 脚本会生成`AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.bat`启动项来实现payload的执行。
*   **诱饵文件生成:** 脚本创建了一个名为`Alicia_Sheree_CV_{datetime.now().year}.pdf`的伪造的简历文件,用于诱骗用户。

**投毒风险分析：**
虽然 POC 脚本本身实现了漏洞利用，但其中也存在潜在的投毒风险。

*   **脚本复杂度：** 代码中包含生成看似专业的简历的功能，这部分代码与漏洞利用本身关系不大，增加了代码的复杂性，可能隐藏恶意行为。
*   **Payload 可定制性：** 脚本允许自定义 payload，攻击者可能会在 payload 中添加额外的恶意代码，例如下载器、后门等。
*   **网络连接：**  目前代码没有明显的网络连接行为。但是，如果对 `PAYLOAD` 变量进行修改，让其从远程服务器下载恶意文件，那就存在投毒风险了。

基于以上分析，我评估该仓库存在约 10% 的投毒风险。风险主要来自于 Payload 的可定制性和脚本复杂性，攻击者可能利用这些特点隐藏恶意代码。

**有效性：**
该POC脚本根据提供的漏洞信息和搜索结果来看是有效的，可以生成恶意RAR文件，成功利用该漏洞。


**项目地址:** [techcorp/CVE-2025-8088-Exploit](https://github.com/techcorp/CVE-2025-8088-Exploit)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)