## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口，默认无需认证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897是Jenkins中的一个任意文件读取漏洞。该漏洞源于Jenkins CLI命令解析器的一个特性，它会将参数中以'@'字符开头的路径替换为文件内容。未授权的攻击者可以利用这个特性读取Jenkins控制器文件系统上的任意文件。漏洞利用方式如下：

1.  **漏洞原理：** Jenkins CLI客户端在解析命令行参数时，会扩展以`@`符号开头的文件路径。例如，`java -jar jenkins-cli.jar help @/etc/passwd` 会尝试读取`/etc/passwd`文件的内容，并将其包含在CLI的帮助信息输出中。
2.  **攻击步骤：**
    *   下载`jenkins-cli.jar`客户端。
    *   使用`java -jar jenkins-cli.jar -s <jenkins_url> help @<file_path>` 命令，其中 `<jenkins_url>` 是Jenkins实例的URL，`<file_path>`是要读取的文件路径。
    *   由于漏洞利用会将文件内容包含在错误信息输出(stderr)中，因此可以通过捕获错误输出来获取文件内容(通常只显示第一行)。
3.  **POC有效性：** 提供的POC代码是有效的。`exploit.sh`脚本下载`jenkins-cli.jar`，然后利用`java -jar`命令读取`/etc/passwd`和`/opt/flag.txt`（容器内的flag）文件，并将结果显示在标准错误输出中。
4.  **投毒风险：** 提供的代码主要用于漏洞演示和教育目的，代码仓库声明了其仅用于教育目的，不要在真实环境中使用，没有任何明显的投毒代码。虽然代码中没有直接的恶意代码，但在实际使用时需要注意。
5.  **搜索引擎结果佐证：** 搜索引擎结果显示该漏洞已被广泛披露和讨论，并有相关的安全公告和分析文章。

**项目地址:** [amalpvatayam67/day03-jenkins-23897](https://github.com/amalpvatayam67/day03-jenkins-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)