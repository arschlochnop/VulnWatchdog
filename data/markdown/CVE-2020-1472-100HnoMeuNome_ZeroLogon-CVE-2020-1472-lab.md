## CVE-2020-1472 Zerologon

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Netlogon Remote Protocol (MS-NRPC)

**危害等级:** 高危，可能导致域管理员权限提升

**影响版本:** 受影响的Windows Server版本：2008 R2, 2012 / 2012 R2, 2016, 2019，以及2020年8月/9月补丁之前的版本

**利用条件:** 需要位于网络内部，能够与域控制器通信

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个存在于Microsoft Netlogon Remote Protocol (MS-NRPC)中的权限提升漏洞。未经身份验证的攻击者可以通过网络连接到域控制器，并利用该漏洞获取域管理员权限。 

**有效性分析：**
根据搜索结果，该漏洞利用的POC代码已经公开（例如packetstormsecurity.com上的POC）。漏洞库信息也表明该漏洞已被积极利用（`Exploitation: active` in CISA ADP Vulnrichment），所以提供的POC代码大概率是有效的。

**投毒风险分析：**
提供的漏洞利用代码实际上是一个`README.md`文件，该文件仅包含漏洞的描述、利用说明、缓解措施和参考链接。该文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，参考链接指向的POC代码，可能存在被篡改的风险，间接存在一定的投毒可能。考虑到该仓库只是一个说明文档，实际的漏洞利用需要用户自行下载其他POC代码，因此判定投毒风险为10%。

**利用方式分析：**
1.  **漏洞原理：** 漏洞利用了Netlogon协议中的一个加密缺陷，攻击者可以将Netlogon会话的客户端凭据设置为全零。
2.  **攻击步骤：**
    *   攻击者通过MS-NRPC与域控制器建立连接。
    *   利用漏洞将域控制器的机器帐户密码置零。
    *   使用置零后的密码更改域控制器的机器帐户密码。
    *   通过修改后的机器帐户密码获得域管理员权限。
3. **修复方式：** 安装Microsoft发布的更新补丁，并按照Microsoft的指南进行配置，以强制执行安全的Netlogon通道。

**项目地址:** [100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab](https://github.com/100HnoMeuNome/ZeroLogon-CVE-2020-1472-lab)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)