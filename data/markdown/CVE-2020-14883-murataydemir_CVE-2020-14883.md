## CVE-2020-14883 - Oracle WebLogic Server 远程代码执行

**漏洞编号:** CVE-2020-14883

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问目标WebLogic服务器控制台,高权限用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-14883 允许高权限攻击者通过HTTP协议利用WebLogic Server Console组件中的漏洞，实现未经授权的远程代码执行，从而完全控制服务器。

**有效性：**
提供的POC代码是有效的。PoC 1 和 PoC 2 使用 `tangosol.coherence.mvel2.sh.ShellSession()` 执行任意命令，分别针对Windows和Linux系统。PoC 3 和 PoC 4 使用 `com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext` 或 `com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext` 加载远程或本地的XML配置文件，从而触发代码执行。

**投毒风险：**
由于提供的代码仅仅是漏洞利用的payload，没有发现作者额外添加的恶意代码。因此，该仓库中作者隐藏投毒代码的可能性较低，判定为0%。

**利用方式：**
1.  **路径穿越:** 利用`console/css/%252e%252e%252fconsole.portal`进行路径穿越，访问受限资源。
2.  **MVEL表达式注入 (PoC 1 & 2):**  通过`handle`参数，注入包含MVEL表达式的`com.tangosol.coherence.mvel2.sh.ShellSession`对象，执行任意命令。例如，在Linux上创建`/tmp/CVE-2020-14883.txt`文件，或在Windows上启动`calc.exe`。
3.  **Spring XML 反序列化 (PoC 3 & 4):**  通过`handle`参数，注入`com.bea.core.repackaged.springframework.context.support.FileSystemXmlApplicationContext`或`com.bea.core.repackaged.springframework.context.support.ClassPathXmlApplicationContext`对象，加载恶意的Spring XML配置文件（如`poc.xml`），其中包含ProcessBuilder bean，用于执行任意命令。攻击者需要搭建一个HTTP服务器来托管该恶意XML文件。

总而言之，该漏洞利用主要依靠构造特殊的HTTP POST请求，利用WebLogic Console组件的反序列化漏洞执行恶意代码。

**项目地址:** [murataydemir/CVE-2020-14883](https://github.com/murataydemir/CVE-2020-14883)

**漏洞详情:** [CVE-2020-14883](https://nvd.nist.gov/vuln/detail/CVE-2020-14883)