## CVE-2025-9074 - Docker Desktop Container到Host写权限提升

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 权限提升

**影响应用:** Docker Desktop

**危害等级:** 高危，允许容器逃逸并完全控制宿主机

**影响版本:** < 4.44.3

**利用条件:** Docker Desktop for Windows运行，且Engine API未正确配置，允许容器访问192.168.65.7:2375

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-9074 漏洞存在于Docker Desktop for Windows中，允许本地运行的Linux容器通过配置的Docker子网（默认192.168.65.7:2375）访问Docker Engine API。此漏洞的利用方式是：

1.  **漏洞原理：** Docker Engine API 暴露在容器网络中，允许未授权访问。
2.  **攻击步骤：**
    *   容器内通过HTTP连接到Docker Engine API (http://192.168.65.7:2375)。
    *   利用API创建一个新的容器，并将宿主机的C盘（通过/mnt/host/c挂载）绑定到容器内的某个目录（例如/host_root）。
    *   在新容器内，向宿主机的C盘写入文件（例如C:\pwn.txt）。
3.  **有效性：** 提供的PoC代码有效，它通过requests库连接到Docker Engine API，创建一个包含宿主机挂载的容器，并在宿主机上创建文件。
4.  **投毒风险：** PoC代码本身的主要功能是利用漏洞，风险较低。 但是README中提及`Misuse may violate laws and policies.`具有误导性,可能存在潜在的法律责任，或者开发者本身对潜在的风险并不完全知情。由于作者声明免责申明。因此判定投毒风险较低，为5%。
5.  **缓解措施：** 升级Docker Desktop到4.44.3或更高版本，确保Docker Engine API不暴露给容器，使用TLS保护API访问，并配置网络策略/防火墙规则阻止容器访问Engine API。

**项目地址:** [zenzue/CVE-2025-9074](https://github.com/zenzue/CVE-2025-9074)

**漏洞详情:** [CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)