## CVE-2020-26259-XStream-任意文件删除

**漏洞编号:** CVE-2020-26259

**漏洞类型:** 任意文件删除

**影响应用:** XStream

**危害等级:** 中危，可能导致数据丢失

**影响版本:** < 1.4.15

**利用条件:** 需要目标应用使用存在漏洞的XStream版本并且允许解析恶意XML输入，执行进程需要具有删除目标文件的权限。需要在Java 15之前的版本运行。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-26259是XStream的一个任意文件删除漏洞。攻击者可以通过构造恶意的XML输入，利用`com.sun.xml.internal.ws.util.ReadAllStream$FileStream`类中的`tempFile`属性，指定要删除的文件路径。当XStream反序列化该XML时，会尝试删除指定的文件。  

**利用方式：**

1.  攻击者构造恶意的XML文件，其中包含`com.sun.xml.internal.ws.util.ReadAllStream$FileStream`类，并设置`tempFile`属性为目标文件路径。
2.  攻击者将恶意XML发送给使用XStream的应用。
3.  应用使用XStream对XML进行反序列化。
4.  XStream尝试删除`tempFile`属性指定的文件，如果应用进程具有相应权限，则文件被删除。

**有效性分析：**
提供的POC代码显示了如何利用此漏洞。`CVE-2020-26259.xml` 文件包含构造的恶意XML，用于触发文件删除漏洞。`Main.java` 文件演示了如何使用XStream反序列化该XML，从而触发漏洞。

**投毒风险分析：**

在提供的文件中，`pom.xml` 文件指定了XStream的版本为1.4.14，这是一个存在漏洞的版本。`CVE-2020-26259.xml` 包含了触发漏洞的payload。

代码中可能存在投毒的地方是，如果作者修改了Main.java，例如加入恶意代码在反序列化前后执行，或者在XML文件中包含其他恶意类，则可能存在投毒风险。

因此，投毒风险评估为 10%。 主要风险在于构建和运行此代码的潜在环境受到破坏而不是恶意利用代码本身。


**项目地址:** [cuijiung/xstream-CVE-2020-26259](https://github.com/cuijiung/xstream-CVE-2020-26259)

**漏洞详情:** [CVE-2020-26259](https://nvd.nist.gov/vuln/detail/CVE-2020-26259)