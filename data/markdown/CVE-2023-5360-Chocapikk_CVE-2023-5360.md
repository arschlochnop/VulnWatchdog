## CVE-2023-5360 - Royal Elementor Addons and Templates 未授权任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates WordPress插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** 需要WordPress实例运行Royal Elementor Addons and Templates插件且版本低于1.3.79，并且目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-5360 漏洞存在于 Royal Elementor Addons and Templates WordPress 插件 1.3.79 之前的版本中。该漏洞允许未经身份验证的攻击者上传任意文件，包括 PHP 文件，从而导致远程代码执行 (RCE)。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞利用的有效性较高。

*   漏洞库信息明确指出，Royal Elementor Addons and Templates 插件在 1.3.79 之前的版本存在未授权任意文件上传漏洞，且可能导致 RCE。
*   搜索引擎结果中，多个来源证实了该漏洞的存在，并提供了漏洞描述、影响和利用方式。
*   提供的漏洞利用代码（`exploit.py`）实现了利用该漏洞上传任意文件的功能。该代码通过构造恶意的请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。

**投毒风险分析：**

漏洞利用代码中存在一定的投毒风险，但风险较低。

*   代码中存在`custom_file`选项，允许攻击者指定自定义的 PHP 文件上传。如果攻击者上传包含恶意代码的 PHP 文件，可能会对目标服务器造成损害。
*   `_get_nonce`函数看似是为了绕过某些安全机制，实际上，攻击者可以利用这个过程中的漏洞进行攻击。
*    在文件上传部分，poc.ph$p的文件名，可能存在绕过文件上传检测，成功上传后执行恶意代码的风险。但这些文件上传通常会通过后缀检测，以及文件内容检测绕过。

总体来说，代码的大部分功能是实现漏洞利用的核心逻辑，投毒代码的可能性较低，估计在10%左右。

**利用方式：**

1.  克隆漏洞利用代码仓库：`git clone https://github.com/Chocapikk/CVE-2023-5360.git`
2.  安装依赖：`pip install -r requirements.txt`
3.  运行漏洞利用脚本：`python3 exploit.py -u <TARGET_URL> -v`
4.  漏洞利用脚本首先获取目标 WordPress 站点的 nonce 值，然后构造包含恶意 PHP 代码的文件上传请求，绕过文件上传验证，将恶意 PHP 文件上传到目标服务器。
5.  上传成功后，攻击者可以通过访问上传的 PHP 文件来执行任意代码，从而控制目标服务器。

**缓解措施：**

*   将 Royal Elementor Addons and Templates 插件升级到 1.3.79 或更高版本。
*   限制上传文件类型，仅允许上传安全的文件类型。
*   对上传的文件进行严格的安全检查，防止恶意代码执行。
*   加强服务器的安全防护，例如使用防火墙、入侵检测系统等。

**项目地址:** [Chocapikk/CVE-2023-5360](https://github.com/Chocapikk/CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)