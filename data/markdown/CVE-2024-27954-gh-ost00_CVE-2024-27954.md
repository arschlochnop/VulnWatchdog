## CVE-2024-27954 - WP Automatic Plugin - 任意文件下载和SSRF漏洞

**漏洞编号:** CVE-2024-27954

**漏洞类型:** 路径遍历 (Path Traversal) 和 SSRF (Server Side Request Forgery)

**影响应用:** WP Automatic WordPress 插件

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造，甚至在特定情况下可能导致远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标网站安装了受影响版本的 WP Automatic 插件，且漏洞利用路径未被防火墙或安全策略阻止

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-27954 漏洞是 WP Automatic WordPress 插件中存在的路径遍历和 SSRF 漏洞。根据漏洞库信息和搜索引擎结果，攻击者可以利用该漏洞读取服务器上的任意文件（路径遍历），或者发起服务器端请求（SSRF）。

**利用方式分析：**

1.  **路径遍历：** 攻击者可以构造包含恶意路径的 URL，例如 `/?p=3232&wp_automatic=download&link=file:///etc/passwd`，来读取服务器上的 `/etc/passwd` 文件。POC.yaml 文件中的代码验证了这一点。

2.  **SSRF：** 虽然漏洞描述中提到 SSRF，但提供的 YAML 文件和 Python 脚本主要关注路径遍历和创建管理员账户。SSRF 的具体利用方式没有直接在代码中体现，但攻击者理论上可以构造请求，让服务器作为跳板访问内部网络。

3.  **RCE 脚本分析：** `RCE_Exploit.py` 实际上并非直接利用路径遍历或SSRF，而是通过向数据库插入恶意数据来创建一个具有管理员权限的新用户。它利用 `wp-content/plugins/wp-automatic/inc/csv.php` 文件，该文件可能存在允许执行构造的 SQL 查询的漏洞。该脚本创建了一个用户名为 `eviladmin`，密码为 `admin` 的管理员账户，并尝试登录。

**有效性评估：**

POC.yaml 中的路径遍历部分是有效的，能够读取服务器上的文件。RCE_Exploit.py 脚本的有效性取决于 `csv.php` 文件是否存在允许执行任意 SQL 查询的漏洞。根据代码，脚本试图创建管理员用户，如果成功，可以进一步利用 WordPress 的功能。

**投毒风险评估：**

虽然RCE_Exploit.py看起来像一个直接的利用程序，但仔细分析可以发现潜在的投毒风险：

*   **硬编码凭据：** 脚本创建的 `eviladmin` 用户的密码是硬编码的 `admin`。如果攻击者在公开的代码中使用这个脚本，目标管理员很容易发现并删除该用户。这可能是一种误导性的行为，让使用者认为漏洞利用成功，但实际上只是留下一个容易被发现的后门。
*   **SQL 注入风险：**  脚本依赖于 `csv.php` 文件中的 SQL 注入漏洞。如果该注入点被修复，或者目标环境不允许执行特定的 SQL 命令（例如，权限不足），脚本将会失败。然而，即使失败，脚本仍可能对数据库造成轻微的干扰。
*   **隐蔽性较差：** 创建 `eviladmin` 用户非常明显，容易被管理员发现。如果目的是持久控制系统，攻击者可能会选择更隐蔽的方式。

**投毒风险百分比：**

综合以上分析，该仓库中可能存在作者隐藏的投毒代码的风险为20%。主要原因如下：

*   该代码的思路过于直白，容易被检测到。
*   依赖于特定的环境和漏洞存在，通用性较差。
*   没有明确的破坏性行为，仅仅是创建一个可被轻易删除的账号。
*   该脚本依赖WP数据库，在数据库被删除后，该后门将不存在。

真正的攻击者可能会利用更隐蔽和持久的方式控制系统。 

**项目地址:** [gh-ost00/CVE-2024-27954](https://github.com/gh-ost00/CVE-2024-27954)

**漏洞详情:** [CVE-2024-27954](https://nvd.nist.gov/vuln/detail/CVE-2024-27954)