## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全控制系统

**影响版本:** 10 (低于 10.8.4) 和 11 (低于 11.3.1)

**利用条件:** 目标CrushFTP实例必须暴露在公网上或可访问的网络中，且未启用DMZ代理

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161是CrushFTP中的一个认证绕过漏洞。攻击者可以通过构造特殊的HTTP请求头，绕过身份验证，并以任意用户（例如 crushadmin）的身份登录。漏洞的根本原因是AWS4-HMAC认证机制中的竞态条件和不完善的错误处理。通过发送畸形的AWS4-HMAC头，攻击者可以触发服务器的index-out-of-bounds错误，阻止会话清理，从而成功进行身份验证。

**有效性分析：**

*   根据漏洞库信息，搜索引擎结果（尤其是huntress的博客）以及提供的漏洞利用代码，可以确定该漏洞真实存在且已被在野利用，POC代码具有实际的有效性。
*   POC代码的`README.md`文件描述了漏洞原理和利用方法，提供了详细的参数说明和使用示例。`tx-crush.py`文件实现了漏洞利用的完整流程，包括版本检测、用户枚举、身份验证绕过等功能。

**投毒风险分析：**

*   通过阅读`tx-crush.py`的代码，未发现明显的恶意代码或后门。该脚本主要功能是利用漏洞进行认证绕过，没有发现额外的网络扫描，敏感信息收集或修改系统设置的操作。
*   但仍需注意，任何未经授权的漏洞利用都可能造成安全风险。如果用户在使用此POC时连接了不可信的网络，或者使用了恶意构造的用户名列表，仍然可能导致安全问题。
*   此外，虽然脚本本身没有明显的投毒代码，但下载的第三方库可能存在潜在的风险。建议在使用前对所有依赖项进行安全审计。
*   基于以上分析，认为该POC代码存在1%的投毒风险，主要来自于可能被恶意修改或依赖的第三方库。

**利用方式分析：**

1.  **版本检测：** 脚本首先通过发送HEAD请求检测目标CrushFTP服务器的版本。
2.  **用户名枚举：**  攻击者需要提供一个包含用户名列表的文件，脚本会尝试使用这些用户名进行身份验证绕过。
3.  **认证绕过：** 脚本通过构造特殊的HTTP Authorization header，利用CrushFTP的AWS4-HMAC认证机制中的漏洞，绕过身份验证。
4.  **会话获取：** 如果认证绕过成功，脚本会提取服务器返回的sessionID cookie，用于后续的会话维持。
5.  **结果输出：**  脚本将利用结果以JSON格式输出到指定的文件中，包括目标URL、用户名、是否成功绕过、认证方法、sessionID cookie等信息。


**项目地址:** [TX-One/CVE-2025-31161](https://github.com/TX-One/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)