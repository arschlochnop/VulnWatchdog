## CVE-2025-53770-SharePoint-Deserialization-RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可导致远程代码执行

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够通过网络访问SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个Microsoft SharePoint Server中的反序列化漏洞,允许未授权的攻击者通过网络执行远程代码。根据漏洞库信息，该漏洞已被公开利用 (Exploit exists in the wild)，CISA的已知被利用漏洞目录中也包含了此漏洞 (CVE-2025-53770 added to CISA KEV)。搜索引擎结果也表明，该漏洞正在被积极利用 (Active Exploitation)。

**有效性评估：**

根据POC代码，利用方式是通过发送特制的POST请求到 `/_layouts/15/ToolPane.aspx` 页面，该请求包含恶意的序列化数据，这些数据经过base64编码和gzip压缩。服务器在反序列化这些数据时，执行攻击者预先设定的代码，从而实现远程代码执行。

从提供的搜索结果来看，很多安全厂商的博客都提到了该漏洞以及利用方式，因此提供的POC是有效的。

**投毒风险评估：**

POC代码中包含一个经过base64和gzip编码的数据块。解码后的数据包含一些SharePoint相关的标签，比如`Scorecard:ExcelDataSet`，`asp:UpdateProgress`，`ProgressTemplate`，`divWaiting`。这些标签本身是合法的SharePoint组件。

风险点在于`CompressedDataTable`属性的值。这个值同样经过了Base64编码和Gzip压缩，攻击者可能将恶意代码隐藏在这个属性中。

虽然大部分代码都是SharePoint正常代码，不能排除攻击者在`CompressedDataTable` 属性值植入恶意代码的可能性，评估投毒风险为10%。

**利用方式总结：**

1.  攻击者构造一个恶意的序列化对象，该对象利用SharePoint的`ToolPane.aspx`页面进行反序列化。
2.  将序列化对象进行Gzip压缩和Base64编码。
3.  构造一个POST请求，将编码后的数据作为`MSOTlPn_DWP`参数的值发送到`/_layouts/15/ToolPane.aspx`页面。
4.  SharePoint服务器反序列化`MSOTlPn_DWP`参数中的数据，执行攻击者注入的恶意代码。
5.  由于此漏洞为未授权远程代码执行，未经身份验证的攻击者可以通过网络触发漏洞。

**项目地址:** [harryhaxor/CVE-2025-53770-SharePoint-Deserialization-RCE-PoC](https://github.com/harryhaxor/CVE-2025-53770-SharePoint-Deserialization-RCE-PoC)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)