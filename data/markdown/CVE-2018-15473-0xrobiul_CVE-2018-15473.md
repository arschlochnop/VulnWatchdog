## CVE-2018-15473 OpenSSH 用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，泄露有效的用户名信息，为后续的暴力破解或其他攻击提供信息。

**影响版本:** <= 7.7

**利用条件:** 需要目标主机开放SSH服务端口（通常是22端口），攻击者可以与目标建立TCP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-15473 漏洞允许攻击者通过发送特制的SSH请求，根据服务器响应时间上的差异来判断用户名是否存在于目标系统中，从而实现用户名枚举。该漏洞存在于OpenSSH 7.7及更早版本中。

**有效性：**
提供的Python脚本 `Exploit.py` 实现了该漏洞的利用，通过修改 `paramiko` 库的行为，使其能够根据服务器的响应来判断用户名是否有效。脚本通过尝试使用公钥认证（auth_publickey）但提供无效的公钥，如果用户存在，服务器会给出特定的响应，如果不存在，则响应不同。README.md 文件中也包含了如何运行和验证漏洞的步骤。

**投毒风险：**
代码本身主要是用于枚举用户名，并没有发现明显的恶意代码。投毒风险较低，评估为10%。主要的风险可能在于：
    *   **依赖项风险：** `requirements.txt` 中包含了 `paramiko`，需要保证下载的 `paramiko` 库没有被篡改。虽然可能性较低，但依然存在。
    *   **不当使用：** 该脚本可以被用于非授权的渗透测试，造成信息泄露，但这并非代码本身的投毒。
    *   **文件名欺骗：** 攻击者可能将该脚本伪装成其他正常文件，诱导用户执行。

**利用方式：**
1.  **环境准备：** 安装 `paramiko` 库：`pip3 install paramiko`。
2.  **目标确定：** 确定目标主机的IP地址和SSH端口（默认为22）。
3.  **用户名列表：** 准备一个用户名列表文件（如提供的 `username.txt`），或者指定单个用户名。
4.  **执行脚本：** 运行 `Exploit.py` 脚本，指定目标IP地址和用户名列表/用户名。例如：`./Exploit.py 192.168.1.20 -w username.txt` 或 `./Exploit.py 192.168.1.20 -u root`。
5.  **结果分析：** 脚本会输出哪些用户名是有效的，哪些是无效的。

**缓解措施：**
*   升级OpenSSH到7.7之后的版本。
*   配置SSH服务器，限制认证失败的尝试次数，以降低枚举的可能性。
*   使用强密码策略，并禁用不必要的账户。

**项目地址:** [0xrobiul/CVE-2018-15473](https://github.com/0xrobiul/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)