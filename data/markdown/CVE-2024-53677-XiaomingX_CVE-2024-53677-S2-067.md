## CVE-2024-53677-Apache Struts 文件上传路径遍历导致RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径遍历导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标系统使用基于FileuploadInterceptor的旧文件上传逻辑，且可通过网络访问上传接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是一个 Apache Struts 的文件上传漏洞，允许攻击者通过操纵文件上传参数实现路径遍历，从而上传恶意文件到任意目录，最终可能导致远程代码执行。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的 POC 代码，该漏洞的有效性较高。漏洞库信息明确指出该漏洞的存在，并提供了受影响的版本范围。搜索引擎结果中包含了多个安全厂商和研究人员对该漏洞的分析和利用案例，表明该漏洞已被广泛关注和验证。提供的 POC 代码通过修改上传文件名参数，尝试将文件上传到目标系统的任意目录，这是一种典型的路径遍历攻击方式。

**投毒风险分析：**

审查提供的 POC 代码，该脚本主要用于检测目标系统是否存在 CVE-2024-53677 漏洞，其核心功能是通过构造恶意的 multipart 请求，尝试上传一个包含特定内容的文件到目标系统的任意目录。脚本本身不包含任何用于执行恶意操作（如安装后门、窃取数据等）的代码，其目的仅在于验证漏洞的存在性。因此，该 POC 代码存在投毒代码的风险较低。

**利用方式分析：**

利用 CVE-2024-53677 漏洞的一般步骤如下：

1.  **确定目标系统：** 确定目标系统使用的 Apache Struts 版本在受影响范围内。
2.  **寻找上传接口：** 寻找目标系统提供的文件上传接口，这些接口通常基于 FileuploadInterceptor 实现。
3.  **构造恶意请求：** 构造包含恶意文件名的 multipart 请求，利用路径遍历将恶意文件上传到目标系统的任意目录，例如 Web 容器的部署目录。
4.  **执行恶意代码：** 通过访问上传的恶意文件，触发恶意代码的执行，实现远程代码执行。

该漏洞的利用需要目标系统存在基于 `FileuploadInterceptor` 的文件上传功能，且该功能存在缺陷，允许攻击者通过操纵文件名参数实现路径遍历。如果目标系统使用了新的文件上传机制，则不会受到该漏洞的影响。

**项目地址:** [XiaomingX/CVE-2024-53677-S2-067](https://github.com/XiaomingX/CVE-2024-53677-S2-067)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)