## CVE-2025-7771 – ThrottleStop.sys Privilege Escalation

**漏洞编号:** CVE-2025-7771

**漏洞类型:** 权限提升

**影响应用:** ThrottleStop

**危害等级:** 高危，允许本地攻击者在内核上下文中执行任意代码，导致权限提升和潜在的后续攻击，例如禁用安全软件或绕过内核级保护。

**影响版本:** 3.0.0.0 and possibly others

**利用条件:** 需要目标系统安装受影响版本的ThrottleStop.sys驱动，并且攻击者具有本地访问权限和管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-7771 是一个高危漏洞，存在于 TechPowerUp 的 ThrottleStop.sys 驱动中。该驱动暴露了两个不安全的 IOCTL 接口，允许未经授权的用户模式应用程序通过 MmMapIoSpace 函数任意读写物理内存。**利用方式：**
1.  攻击者首先需要获得对 `\\Device\\ThrottleStop` 设备的句柄。
2.  然后，攻击者可以使用 `DeviceIoControl` 函数以及以下两个 IOCTL 代码之一：`0x80006498`（读取物理内存）或 `0x8000649C`（写入物理内存）。
3.  利用这些 IOCTL，攻击者可以映射任意物理内存，然后通过写入操作来修改内核数据结构或函数指针。
4.  通过修改内核数据，攻击者可以执行任意内核代码，从而实现权限提升。

**有效性：** 提供的POC代码看起来完整且有效。它包含必要的步骤，例如获取驱动程序句柄，使用易受攻击的IOCTL执行物理内存读写操作。

**投毒风险：** 尽管POC看起来是合法的，但仍存在一定的投毒风险。以下是一些需要考虑的方面：
1.  **代码复杂性：** POC代码涉及内核级别的内存操作，这使得代码审查变得更加困难。攻击者可能会在代码中隐藏恶意逻辑，例如后门或数据窃取功能。
2.  **二进制依赖项：** 该POC依赖于特定的 ThrottleStop.sys 驱动程序。如果提供的驱动程序已被篡改，则可能会导致系统不稳定或被恶意利用。
3.  **权限要求：** 该POC需要管理员权限才能运行。这意味着，如果攻击者能够诱骗用户以管理员身份运行恶意代码，则他们可以利用此漏洞。

考虑到以上因素，此仓库中存在作者隐藏的投毒代码的可能性大约为10%。需要彻底的代码审查和安全测试才能确认是否存在恶意代码。

**项目地址:** [Demoo1337/ThrottleStop](https://github.com/Demoo1337/ThrottleStop)

**漏洞详情:** [CVE-2025-7771](https://nvd.nist.gov/vuln/detail/CVE-2025-7771)