## CVE-2024-3400 PAN-OS GlobalProtect 命令注入漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码

**影响版本:** PAN-OS 10.2 (小于10.2.9-h1), 11.0 (小于11.0.4-h1), 11.1 (小于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或Portal,并且能通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞，源于任意文件创建。攻击者可以利用此漏洞，在未经身份验证的情况下，以root权限在防火墙上执行任意代码。

**有效性：**
从搜索结果和漏洞库信息来看，此漏洞已经被积极利用，并且有公开的PoC。提供的Python脚本旨在检查防火墙上是否存在漏洞利用的痕迹，而不是直接利用该漏洞。脚本通过Netmiko库连接到防火墙，并执行特定的命令，从而检测是否存在与漏洞相关的日志记录。

**投毒风险：**
提供的代码仓库主要包含一个用于检测漏洞的Python脚本。该脚本使用`netmiko`连接到Palo Alto防火墙，并执行`grep`命令来检查特定的日志模式。其中，`firewall_hosts`、`firewall_username`、`firewall_password`和`command_to_run`都需要用户自行配置。由于脚本的目的是检查漏洞利用痕迹，而不是直接进行漏洞利用，因此投毒风险较低。但用户在使用脚本时，仍需注意脚本的来源和完整性，避免引入恶意代码。

**利用方式：**
根据漏洞库信息和搜索结果，攻击者利用此漏洞的方式可能包括：
1.  利用未授权的任意文件创建漏洞，在目标系统上创建恶意文件。
2.  通过构造特定的请求，触发命令注入，执行任意系统命令。
3.  通过GlobalProtect组件，利用命令注入漏洞，获取root权限。

该漏洞的利用需要特定的PAN-OS版本，以及GlobalProtect网关或Portal的配置。缓解措施包括升级到修复后的PAN-OS版本，或者使用威胁防御签名进行阻止。

**项目地址:** [swaybs/CVE-2024-3400](https://github.com/swaybs/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)