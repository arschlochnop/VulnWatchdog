## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息或执行未授权操作

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是一个 Next.js 中间件授权绕过漏洞。当 Next.js 应用的授权检查在中间件中进行时，攻击者可以通过发送包含 `x-middleware-subrequest` 头部的恶意请求来绕过授权检查。根据漏洞利用代码（README.md），只需使用拦截代理（如 ZAP 或 Burp）捕获请求，并在请求中注入以下头部即可实现绕过：`x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`。

**有效性：**
根据漏洞描述和提供的POC代码，该漏洞利用是有效的。多个搜索结果也证实了该漏洞的存在以及利用方式。

**投毒风险：**
分析提供的文件：
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `eslint.config.mjs`:  ESLint 配置文件，用于代码风格检查，不包含恶意代码。
*   `middleware.ts`:  定义 Next.js 中间件，用于授权检查。存在漏洞利用的逻辑，但本身不是投毒代码，而是漏洞的根源。
*   `next.config.ts`:  Next.js 配置文件，用于配置 Next.js 应用，不包含恶意代码。
*   `package-lock.json`:  记录项目依赖的版本信息，不包含恶意代码。

 虽然检查了所有提供的代码，但考虑到漏洞利用代码仓库中可能存在的潜在风险，例如作者可能在其他未直接展示的文件中隐藏恶意代码，或者在更新版本时引入恶意代码，因此，我们仍然需要保留一定的警惕性。我评估投毒风险为 10%，因为虽然没有明显的投毒迹象，但无法完全排除作者恶意行为的可能性。

**利用方式：**
1.  目标应用程序使用受影响版本的Next.js，并且授权逻辑位于中间件中。
2.  攻击者使用代理工具（如 Burp Suite）拦截请求。
3.  攻击者在请求头中添加 `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware`。
4.  攻击者发送修改后的请求，绕过中间件的授权检查，从而访问受保护的资源。

**项目地址:** [ricsirigu/CVE-2025-29927](https://github.com/ricsirigu/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)