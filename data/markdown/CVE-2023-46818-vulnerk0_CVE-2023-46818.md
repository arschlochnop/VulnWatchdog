## CVE-2023-46818-ISPConfig-PHP代码注入

**漏洞编号:** CVE-2023-46818

**漏洞类型:** PHP代码注入

**影响应用:** ISPConfig

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.2.11

**利用条件:** 需要管理员权限，且admin_allow_langedit选项开启

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-46818 漏洞存在于 ISPConfig 3.2.11p1 之前的版本中。攻击者（需要管理员权限）可以通过语言文件编辑器注入 PHP 代码。漏洞利用方式如下：

1.  **漏洞描述：**该漏洞允许经过身份验证的管理员用户，在启用了 `admin_allow_langedit` 选项的情况下，通过编辑语言文件注入恶意的 PHP 代码。
2.  **POC有效性：** 提供的 POC 代码 `exploit.py` 看起来是有效的。它首先尝试登录 ISPConfig 管理面板，然后通过编辑语言文件注入 PHP 代码，最后通过访问注入的 PHP 文件来执行任意命令。这个POC的有效性取决于目标ISPConfig实例是否满足漏洞前提条件：版本<=3.2.11，管理员权限，并且admin_allow_langedit选项被启用。
3.  **利用方式：**
    *   使用提供的用户名和密码登录 ISPConfig 管理面板。
    *   找到语言文件编辑功能，编辑一个语言文件。
    *   在语言文件中注入恶意的 PHP 代码，例如 `<?php system($_GET['cmd']); ?>`，这样可以通过 GET 请求传递命令参数来执行任意系统命令。
    *   通过访问包含恶意 PHP 代码的语言文件，执行任意命令。
4.  **投毒风险：** 查看了提供的 exploit.py 脚本和 README.md。该脚本的功能是利用 CVE-2023-46818 在 ISPConfig 系统中进行 PHP 代码注入。脚本的主要功能是：检查连接，尝试使用提供的用户名和密码登录，如果登录成功，则通过修改语言文件注入后门 PHP 代码，最后创建一个webshell，允许通过 GET 请求执行任意命令。该脚本本身没有发现明显的恶意代码，例如未经授权的数据收集、传播恶意软件等。README.md 也只包含漏洞描述和使用方法。
    因此，可以认为该仓库中存在作者隐藏的投毒代码的风险较低。


**项目地址:** [vulnerk0/CVE-2023-46818](https://github.com/vulnerk0/CVE-2023-46818)

**漏洞详情:** [CVE-2023-46818](https://nvd.nist.gov/vuln/detail/CVE-2023-46818)