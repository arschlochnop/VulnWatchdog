## CVE-2018-8097-pyeve-代码注入

**漏洞编号:** CVE-2018-8097

**漏洞类型:** 代码注入

**影响应用:** pyeve

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 0.7.5

**利用条件:** 目标应用程序使用受影响版本的pyeve，并且攻击者可以控制 'where' 参数。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-8097是pyeve 0.7.5之前版本中io/mongo/parser.py文件存在的一个代码注入漏洞。攻击者可以通过构造恶意的 'where' 参数，利用 `ObjectId` 的特性，在MongoDB查询中注入任意Python代码并执行。 

**有效性：** 

根据提供的漏洞信息、搜索结果和PoC代码，可以判断该漏洞的PoC代码有效。PoC代码使用 `requests` 库向目标URL发送GET请求，并在 `where` 参数中注入恶意代码。恶意代码使用 `ObjectId` 构造MongoDB查询条件，并利用 `__import__('os').system('{cmd}')` 执行系统命令。

**投毒风险：** 

分析提供的PoC代码，没有发现作者隐藏的投毒代码。PoC代码的功能明确，只是利用漏洞执行命令。因此，投毒风险为0%。

**利用方式：** 

1.  确定目标应用程序使用的pyeve版本低于0.7.5。
2.  找到一个可以使用 'where' 参数进行过滤的API端点。
3.  使用PoC代码生成包含恶意代码的payload。Payload的格式如下：
    ```
    ObjectId("507f1f77bcf86cd799439011') and __import__("os").system('{cmd}')
    ```
    其中， `{cmd}` 是要执行的系统命令。
4.  将payload作为 'where' 参数的值发送到目标API端点。
5.  如果漏洞存在，服务器将执行payload中的系统命令。

**项目地址:** [SilentVoid13/CVE-2018-8097](https://github.com/SilentVoid13/CVE-2018-8097)

**漏洞详情:** [CVE-2018-8097](https://nvd.nist.gov/vuln/detail/CVE-2018-8097)