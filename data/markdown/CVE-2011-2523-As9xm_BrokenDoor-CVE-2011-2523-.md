## CVE-2011-2523-vsftpd-Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可远程执行任意命令

**影响版本:** 2.3.4 (仅限20110630至20110703期间下载的版本)

**利用条件:** 目标系统运行存在后门的vsftpd 2.3.4，且防火墙未阻止6200端口的连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2011-2523是vsftpd 2.3.4版本中的一个后门漏洞。攻击者通过在FTP用户名后附加字符串':)'，即可触发后门，在目标系统上监听6200端口。连接到该端口后，攻击者可以执行任意命令。

**利用方式：**

1.  **漏洞检测：** 首先需要确定目标系统运行的vsftpd版本是否为存在后门的2.3.4版本（仅限特定日期下载的版本）。可以通过FTP banner信息或者其他方式进行判断。
2.  **后门触发：** 使用FTP客户端连接到目标FTP服务器，并使用包含':)'的用户名登录，密码随意。例如：`USER backdoor:)`，`PASS whatever`。
3.  **连接后门Shell：** 使用telnet或其他工具连接到目标系统的6200端口。连接成功后，即可执行任意命令。

**POC有效性：**

提供的Python脚本`BrokenDoor.py`实现了上述利用过程。脚本首先检查目标主机是否开放了21端口(FTP端口)，然后尝试使用包含':)'的用户名登录。如果成功，脚本会尝试连接6200端口，并提供一个交互式shell。

**投毒风险：**

代码整体逻辑是按照漏洞原理实现的，主要功能是连接目标系统的FTP服务，触发后门，然后连接到6200端口获得shell。虽然代码使用了`telnetlib`库，并执行了用户输入的命令，但这些都是漏洞利用的正常流程，而不是恶意代码。该仓库中可能存在细微投毒的概率较低。风险分析：
*   代码中使用`input()`函数获取用户输入的命令，并通过`shell.write(cmd.encode() + b"\n")`发送到目标系统执行。如果目标系统存在其他漏洞，用户输入的恶意命令可能会导致更严重的后果。
*   `README.md`文件提示仅用于教育目的，可能降低用户的防范意识。
*   `time.sleep()`函数可能被用来延迟恶意操作，但目前POC代码中没有发现可疑的恶意操作。
    综上评估, 该仓库存在投毒的概率较低，估计为1%。主要是因为该漏洞本身就是开启后门，利用代码的功能也是建立在这个后门的基础之上，很难区分是否是额外添加的恶意代码。

**项目地址:** [As9xm/BrokenDoor-CVE-2011-2523-](https://github.com/As9xm/BrokenDoor-CVE-2011-2523-)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)