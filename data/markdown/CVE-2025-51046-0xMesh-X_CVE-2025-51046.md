## CVE-2025-51046 - SourceCodeste Online Student Clearance System v1.0 远程文件上传漏洞

**漏洞编号:** CVE-2025-51046

**漏洞类型:** 远程文件上传

**影响应用:** SourceCodeste Online Student Clearance System

**危害等级:** 高危，可能导致远程代码执行和服务器完全控制

**影响版本:** 1.0

**利用条件:** 需要对目标服务器的edit-photo.php页面具有上传权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于SourceCodeste Online Student Clearance System v1.0 的`edit-photo.php`文件中，允许未授权用户上传任意文件，包括PHP脚本。由于缺少适当的文件类型验证和过滤，攻击者可以上传恶意的PHP web shell到`/uploads/`目录下，并通过访问该web shell执行任意系统命令。 

**有效性：** 提供的POC代码有效，可以通过`curl`命令上传一个简单的PHP web shell (`shell.php`)，然后通过GET请求执行系统命令，证明了远程代码执行漏洞的存在。

**投毒风险：** 在提供的漏洞利用代码中，`shell.php` 的内容为 `<?php system($_GET['cmd']); ?>`， 这本身就是一个后门。 但是，考虑到这部分是用于漏洞验证的，因此不应将其视作投毒代码。该 README.md 文件用于描述漏洞，并提供利用方式，该仓库本身存在被投毒的风险较低，只有很小一部分可能是作者隐藏的恶意代码，用于窃取用户凭据或其他恶意行为，估计占比约为1%。

**利用方式：**

1.  **上传恶意文件：** 使用`curl`命令或类似工具，通过`edit-photo.php`页面上传一个包含恶意代码的PHP文件。POC中使用的是一个简单的Web Shell，该Shell通过GET参数执行系统命令。
2.  **执行远程命令：** 通过浏览器访问上传的恶意文件，并附带要执行的命令作为GET参数。例如，`http://192.168.8.138/uploads/shell.php?cmd=id` 将在服务器上执行`id`命令。

利用的关键点在于服务器未对上传的文件类型进行严格的验证，并且上传目录`/uploads/`具有可执行权限。

**项目地址:** [0xMesh-X/CVE-2025-51046](https://github.com/0xMesh-X/CVE-2025-51046)

**漏洞详情:** [CVE-2025-51046](https://nvd.nist.gov/vuln/detail/CVE-2025-51046)