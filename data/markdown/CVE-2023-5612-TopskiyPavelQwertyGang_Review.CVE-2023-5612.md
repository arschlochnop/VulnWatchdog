## CVE-2023-5612-GitLab-SSRF

**漏洞编号:** CVE-2023-5612

**漏洞类型:** SSRF

**影响应用:** GitLab

**危害等级:** 中危，可能导致内部服务信息泄露或被利用

**影响版本:** 所有版本 < 16.6.6, 16.7 < 16.7.4, 16.8 < 16.8.1

**利用条件:** 需要具有可创建 Webhook 的权限（至少需要一个有效的 PRIVATE-TOKEN）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-5612 是 GitLab 中存在的一个 SSRF（服务器端请求伪造）漏洞。未经授权的用户可以通过 tags feed 读取用户电子邮件地址，即使该电子邮件地址在用户个人资料中的可见性已被禁用。POC 利用代码通过创建恶意的 Webhook，发送请求到内部网络。漏洞利用步骤如下：

1.  **准备：** 运行 `ssrf_listener.py` 脚本，监听 127.0.0.1:8888 端口，模拟内部服务。
2.  **利用：** 使用 `gitlab-ssrf.nse` 或 `gitlab-ssrf-brute.nse` Nmap 脚本，并提供 GitLab 的 PRIVATE-TOKEN。
3.  **攻击：** 脚本将尝试创建一个指向内部地址（例如，`http://127.0.0.1:8888`）的 Webhook。
4.  **验证：** 如果 Webhook 创建成功，`ssrf_listener.py` 脚本将会收到请求，表明 SSRF 漏洞存在。

该 POC 代码利用 GitLab Webhook 功能，注入恶意 URL，从而实现 SSRF。在提供的代码中，没有发现明显的投毒代码。`gitlab-ssrf-brute.nse` 只是尝试了几个常见的内部地址，以增加漏洞利用成功的概率，而 `json.lua` 只是一个简单的 JSON 编码器，没有恶意功能。`ssrf_listener.py` 是一个简单的 HTTP 服务器，用于验证 SSRF 是否成功。 因此投毒的可能性为0%。该漏洞的修复方案为升级到 GitLab 16.8.1, 16.7.4, 16.6.6 或更高版本。

**项目地址:** [TopskiyPavelQwertyGang/Review.CVE-2023-5612](https://github.com/TopskiyPavelQwertyGang/Review.CVE-2023-5612)

**漏洞详情:** [CVE-2023-5612](https://nvd.nist.gov/vuln/detail/CVE-2023-5612)