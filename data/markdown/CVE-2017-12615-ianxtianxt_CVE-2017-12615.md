## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而导致远程代码执行。

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows系统，开启HTTP PUT方法 (readonly初始化参数设置为false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许在满足特定条件的 Apache Tomcat 服务器上进行远程代码执行。攻击者可以通过发送特制的 HTTP PUT 请求上传包含恶意代码的 JSP 文件。由于 Tomcat 默认配置不允许 PUT 请求，因此需要目标服务器允许 PUT 请求（例如，将 readonly 参数设置为 false）。漏洞利用代码的有效性很高，因为有公开的漏洞利用代码和相关资料。

**漏洞利用方式：**

1.  **检查环境：** 确认目标服务器运行的是受影响的 Apache Tomcat 版本 (7.0.0 to 7.0.79)，并且运行在 Windows 环境下。还要确定服务器是否允许 HTTP PUT 请求。
2.  **上传JSP文件：** 使用 HTTP PUT 方法上传一个恶意的 JSP 文件到服务器。文件名需要经过特殊构造，例如使用`.jsp.` 或 `.jspx`后缀（该点搜索结果里有提及，是绕过上传限制的关键）。
3.  **执行恶意代码：** 成功上传 JSP 文件后，通过浏览器访问该文件，服务器会解析并执行其中的恶意代码，从而实现远程代码执行。

**投毒风险：**
提供的漏洞利用代码仓库中仅包含一个 README 文件，内容是 CVE 编号。因此，直接利用该仓库代码进行攻击不存在明显的投毒风险。但间接风险仍然存在：

*   **代码污染：** 攻击者可能基于此基础仓库，添加恶意代码，然后传播经过“增强”的漏洞利用工具，诱导其他用户使用。
*   **供应链攻击：** 如果该仓库被用作其他自动化工具或脚本的依赖，恶意用户可能会篡改仓库内容，导致下游用户受到攻击。

由于目前仅有 README 文件，投毒风险评定为较低，大约10%。需要注意的是，实际情况中需要对完整的POC代码进行分析才能更准确的评估。

**项目地址:** [ianxtianxt/CVE-2017-12615](https://github.com/ianxtianxt/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)