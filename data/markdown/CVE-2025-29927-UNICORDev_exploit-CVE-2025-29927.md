## CVE-2025-29927-Next.js-Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 11.1.4 - 12.3.4, 13.0.0 - 13.5.8, 14.0.0 - 14.2.24, 15.0.0 - 15.2.2

**利用条件:** 目标应用使用了Next.js中间件进行权限校验，并且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 框架中，允许攻击者绕过中间件中的授权检查。漏洞的根本原因是 Next.js 对 `x-middleware-subrequest` 标头的处理不当。 

**有效性评估：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用代码有效。漏洞库和搜索结果都表明该漏洞是一个关键的权限绕过漏洞，而提供的漏洞利用代码专门针对此漏洞，通过发送包含 `x-middleware-subrequest` 标头的特制请求来绕过中间件的授权检查。

**投毒风险分析：**

查看提供的 exploit-CVE-2025-29927.py 脚本，代码主要功能是：

1.  发送包含 `x-middleware-subrequest` 标头的请求。
2.  根据目标 URL 和可选的版本信息，构造特定的 HTTP 请求头。
3.  检测Next.js 版本，针对不同版本发送特制Header。

风险主要来自以下几个方面：

1.  **依赖风险:** 脚本依赖于 `requests` 库，如果用户通过非官方渠道安装该库，可能存在被篡改的风险。
2.  **目标环境风险:** 该脚本需要在目标 Next.js 应用存在漏洞的情况下才能生效。如果目标应用已经修复了该漏洞，运行该脚本不会产生预期效果，但仍可能留下攻击痕迹。

代码本身未发现恶意行为，如反弹 shell、植入后门等。但仍存在潜在的风险，例如作者可能在代码中添加隐蔽的恶意代码，利用该漏洞在目标服务器上执行任意命令。

综合评估，投毒风险较低，估计为 5%。

**利用方式：**

1.  **确定目标：** 确定使用 Next.js 且版本在受影响范围内的应用程序。
2.  **运行PoC脚本：** 使用提供的 `exploit-CVE-2025-29927.py` 脚本，指定目标 URL。
3.  **绕过认证：** 脚本会发送包含 `x-middleware-subrequest` 标头的特制请求，从而绕过中间件的权限检查。
4.  **未授权访问：** 成功绕过权限检查后，攻击者可以访问受保护的资源或执行未经授权的操作。

**项目地址:** [UNICORDev/exploit-CVE-2025-29927](https://github.com/UNICORDev/exploit-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)