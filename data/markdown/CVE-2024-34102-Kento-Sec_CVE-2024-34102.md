## CVE-2024-34102-Adobe Commerce XXE

**漏洞编号:** CVE-2024-34102

**漏洞类型:** XXE (XML External Entity)

**影响应用:** Adobe Commerce (Magento)

**危害等级:** 高危，可导致任意代码执行和敏感信息泄露

**影响版本:** <= 2.4.7, 2.4.6-p5, 2.4.5-p7, 2.4.4-p8

**利用条件:** 无需用户交互，网络可达即可利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-34102 是一个存在于 Adobe Commerce (Magento) 中的 XXE 漏洞。攻击者可以通过发送特制的 XML 文档，该文档引用外部实体，从而利用此漏洞。利用成功后，攻击者可以读取服务器上的任意文件，甚至执行任意代码。

**有效性:**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞的PoC代码是有效的。漏洞库信息明确指出该漏洞允许攻击者通过发送特制的 XML 文档来利用，而搜索结果中也包含对此漏洞的描述和利用分析。提供的PoC代码，即 `cosmic_sting.go` 文件，提供了一个可执行的漏洞利用工具，它通过构造包含外部实体引用的 XML 来读取目标文件。

**投毒风险:**

分析 `cosmic_sting.go` 发现存在以下潜在投毒风险：

*   **依赖第三方网站:** PoC 使用 `fars.ee` 来托管 DTD 文件，如果该网站被攻破或停止服务，攻击将失败。虽然这本身不算是恶意投毒，但依赖外部服务增加了攻击的不确定性。
*   **实例追踪:**  PoC使用了 `api.cvssadvisor.com`  来获取实例ID, 虽然是为了保证测试有效性,但是也存在安全风险。
*   **潜在的日志记录:** 代码可能会在服务器端留下攻击痕迹，如果作者有意为之，可以追踪攻击者。
*   **作者信息:** 作者在README.md 中要求follow推特, 存在潜在的社会工程学风险。

虽然存在上述风险，但并没有发现明显的恶意代码，例如反弹 shell 或其他后门。 总体评估投毒风险为 10%。这个概率考虑了对第三方服务的依赖，以及实例ID追踪可能带来的风险。

**利用方式:**

1.  **目标确定:** 确定运行受影响 Adobe Commerce (Magento) 版本的服务器。
2.  **Callback URL生成:** 使用`cosmic_sting.go`  生成payload.
3.  **发送恶意请求:**  向目标服务器发送包含恶意 XML 数据的 POST 请求。
4.  **文件读取/代码执行:**  如果漏洞利用成功，攻击者可以读取服务器上的任意文件，或执行任意代码。

**总结:**

CVE-2024-34102 是一个严重的安全漏洞，由于该漏洞利用无需身份验证且影响范围广泛，因此需要尽快修复。提供的 PoC 代码可以有效地利用此漏洞，但使用时需要注意潜在的风险。

**项目地址:** [Kento-Sec/CVE-2024-34102](https://github.com/Kento-Sec/CVE-2024-34102)

**漏洞详情:** [CVE-2024-34102](https://nvd.nist.gov/vuln/detail/CVE-2024-34102)