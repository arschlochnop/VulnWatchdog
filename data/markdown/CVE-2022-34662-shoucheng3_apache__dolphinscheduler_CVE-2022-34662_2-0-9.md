## CVE-2022-34662 - Apache DolphinScheduler Path Traversal

**漏洞编号:** CVE-2022-34662

**漏洞类型:** Path Traversal

**影响应用:** Apache DolphinScheduler

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** <= 3.0.0-beta-1

**利用条件:** 需要登录用户权限，能够向资源中心添加资源

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-34662 是 Apache DolphinScheduler 3.0.0-beta-1 之前的版本中存在的一个路径遍历漏洞。该漏洞允许已登录的用户通过在资源中心添加资源时使用包含相对路径的 relation path，从而访问受限目录中的文件。

**有效性：**
根据漏洞信息，此漏洞确实存在于 Apache DolphinScheduler 3.0.0 之前的版本中，并且需要登录的用户权限。搜索结果中的多个网页都确认了该漏洞的存在和描述。 漏洞库信息中也提到漏洞的存在，以及修复版本。

**投毒风险：**
提供的“漏洞利用代码”实际上是关于如何向 DolphinScheduler 贡献代码的开发文档和 Apache License 的内容。其中没有发现任何直接可利用的漏洞利用代码，更没有发现任何恶意投毒代码。
但是，攻击者可能利用该代码，诱导开发者clone包含恶意代码的分支，所以存在一定程度的投毒可能，概率较低。

**利用方式：**
1.  攻击者需要拥有 Apache DolphinScheduler 实例的有效用户帐户。
2.  攻击者登录到 DolphinScheduler。
3.  攻击者导航到资源中心，并尝试添加新资源。
4.  在指定资源路径时，攻击者可以构造包含 "../" 的路径，尝试访问受限目录，比如`/etc/passwd`。
5.  如果服务器没有进行充分的路径验证，攻击者可能成功读取任意文件，例如配置文件、密钥等敏感信息。

**项目地址:** [shoucheng3/apache__dolphinscheduler_CVE-2022-34662_2-0-9](https://github.com/shoucheng3/apache__dolphinscheduler_CVE-2022-34662_2-0-9)

**漏洞详情:** [CVE-2022-34662](https://nvd.nist.gov/vuln/detail/CVE-2022-34662)