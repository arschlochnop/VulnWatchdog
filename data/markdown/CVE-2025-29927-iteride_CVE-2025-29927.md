## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 11.1.4 <= version < 12.3.5, 13.0.0 <= version < 13.5.9, 14.0.0 <= version < 14.2.25, 15.0.0 <= version < 15.2.3

**利用条件:** 需要Next.js应用使用中间件进行授权检查，并且部署环境允许外部请求设置`x-middleware-subrequest`请求头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 存在于 Next.js 的中间件中，允许攻击者绕过授权检查。漏洞原因是 Next.js 没有正确处理 `x-middleware-subrequest` 标头。在受影响的版本中，如果授权检查发生在中间件中，攻击者可以通过在请求中设置该标头来绕过这些检查，获得对受保护路由或数据的未授权访问。

**利用方式：**
1.  攻击者构造包含 `x-middleware-subrequest` 标头的 HTTP 请求。
2.  `x-middleware-subrequest` 标头的值可以是一个字符串，用于欺骗 Next.js 运行时，使其跳过中间件的执行。
3.  发送构造好的请求到目标 Next.js 应用。
4.  如果目标应用存在此漏洞，且授权检查仅存在于中间件中，则攻击者将绕过授权，访问受保护的资源。

**有效性：**
根据漏洞库信息、搜索结果和提供的POC代码，此漏洞利用是有效的。漏洞库信息明确指出这是一个授权绕过漏洞，搜索结果中多个链接都提供了漏洞分析和利用说明。POC代码中详细描述了漏洞原理和利用方法，并提供了CPE和利用条件，进一步证实了漏洞的可利用性。

**投毒风险：**
POC代码本身主要是漏洞的原理说明和验证，以及检测脚本，没有发现明显的恶意代码。README.md文件主要包含漏洞介绍、影响版本、利用条件和验证方法。nuclei 模板和 Python/Go 扫描脚本用于检测漏洞是否存在，本身没有危害性。因此，投毒风险较低，大概在10%左右。此处的风险主要来自于 nuclei 模板或扫描脚本如果被恶意修改，可能会被用于进行拒绝服务攻击或其他恶意行为，但从目前的代码内容来看，投毒风险相对较低。

**项目地址:** [iteride/CVE-2025-29927](https://github.com/iteride/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)