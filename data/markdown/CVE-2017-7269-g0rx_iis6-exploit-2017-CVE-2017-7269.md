## CVE-2017-7269-IIS 6.0 WebDAV 缓冲区溢出

**漏洞编号:** CVE-2017-7269

**漏洞类型:** 缓冲区溢出

**影响应用:** Microsoft IIS 6.0

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Windows Server 2003 R2 上的 IIS 6.0

**利用条件:** 目标服务器运行存在漏洞的 IIS 6.0 WebDAV 服务，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-7269 漏洞是 Microsoft IIS 6.0 WebDAV 服务中 `ScStoragePathFromUrl` 函数的缓冲区溢出漏洞。攻击者可以通过发送包含特制的 `If:` 头部的 `PROPFIND` 请求，造成缓冲区溢出，从而执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已经存在公开的利用代码，并且在野外被利用过。Rapid7 Metasploit 框架中也包含该漏洞的利用模块，表明该漏洞的有效性较高。

**投毒风险：**

提供的 POC 代码是一个 Python 脚本，用于发送包含特定 shellcode 的 `PROPFIND` 请求。该 shellcode 的作用是建立反向 shell 连接。对 shellcode 的分析表明，它尝试连接到攻击者指定的 IP 地址和端口，执行 cmd.exe。 该代码没有发现明显的恶意行为，因此投毒风险较低. 根据人工review代码,未发现任何投毒代码. 

**利用方式：**

1.  攻击者构建一个包含超长 `If:` 头部的 `PROPFIND` 请求，头部的内容精心构造，用于触发 `ScStoragePathFromUrl` 函数的缓冲区溢出。
2.  在超长头部中，包含 shellcode，用于在目标系统上执行恶意代码。
3.  攻击者将构造的 `PROPFIND` 请求发送给存在漏洞的 IIS 6.0 服务器。
4.  服务器处理请求时，`ScStoragePathFromUrl` 函数发生缓冲区溢出，shellcode 被执行。
5.  Shellcode 建立与攻击者控制的 IP 地址和端口的反向 shell 连接，从而允许攻击者远程控制目标系统。

**项目地址:** [g0rx/iis6-exploit-2017-CVE-2017-7269](https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269)

**漏洞详情:** [CVE-2017-7269](https://nvd.nist.gov/vuln/detail/CVE-2017-7269)