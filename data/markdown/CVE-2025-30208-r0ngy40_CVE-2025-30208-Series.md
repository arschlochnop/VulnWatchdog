## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite 开发服务器需要暴露在网络上 (使用 `--host` 或 `server.host` 配置)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208 漏洞允许攻击者绕过 Vite 服务器的 `server.fs.deny` 限制，读取任意文件。该漏洞利用了 URL 中 `?raw??` 或 `?import&raw??` 附加参数处理不当的问题。由于对 URL 查询字符串的正则匹配存在缺陷，Vite 会错误地移除这些尾部参数，从而允许访问受限文件。

**利用方式：**

1.  **确定目标 Vite 服务器是否易受攻击：** 服务器必须运行受影响的版本，并且开发服务器已通过 `--host` 或 `server.host` 配置暴露在网络上。
2.  **构造恶意 URL：** 使用类似 `/@fs/etc/passwd?import&raw??`（Linux）或 `/@fs/C:/Windows/win.ini?import&raw??`（Windows）的 URL，尝试读取服务器上的敏感文件。
3.  **发送 HTTP 请求：** 向构造的 URL 发送 GET 请求。
4.  **分析响应：** 如果响应包含目标文件的内容，则表示漏洞利用成功。

**POC 代码分析：**

提供的 POC 代码 (`20250324_vite_vite_pre-auth_arbitrary_file_read_CVE-2025-30208.py`)  针对 CVE-2025-30208 漏洞，通过构造包含 `?import&raw??` 的 URL 来尝试读取 `/etc/passwd` (Linux) 或 `C:/Windows/win.ini` (Windows)。代码会检查响应内容是否包含文件内容，从而判断漏洞是否存在。

提供的 POC 代码 (`20250401_vite_vite_pre-auth_arbitrary_file_read_CVE-2025-31125.py`) 针对 CVE-2025-31125 漏洞，通过构造包含 `?inline=1.wasm?init` 的 URL 来尝试读取 `/etc/passwd` (Linux) 或 `C:/Windows/win.ini` (Windows)。代码会增加请求头 `sec-fetch-dest`: `script`,并采用base64解码的方式来尝试读取文件内容，从而判断漏洞是否存在。

**有效性评估：**

根据漏洞描述和 POC 代码，该漏洞利用方法是有效的，可以绕过文件访问限制并读取服务器上的任意文件。

**投毒风险评估：**

仔细检查了提供的 POC 代码，没有发现任何可疑或恶意的代码。该代码的功能仅限于验证漏洞的存在，没有执行任何可能损害目标系统的操作。因此，投毒风险评估为 0%。

**结论：**

CVE-2025-30208 漏洞是一个中危漏洞，允许未经授权的攻击者读取服务器上的任意文件。提供的 POC 代码是有效的，可以用于验证漏洞的存在。没有发现 POC 代码中包含任何投毒代码。

**项目地址:** [r0ngy40/CVE-2025-30208-Series](https://github.com/r0ngy40/CVE-2025-30208-Series)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)