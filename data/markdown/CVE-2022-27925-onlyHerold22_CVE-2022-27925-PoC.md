## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 and 9.0

**利用条件:** 需要管理员权限认证（但部分情况下存在认证绕过）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-27925是Zimbra Collaboration Suite (ZCS) 8.8.15和9.0版本中的一个路径遍历漏洞。该漏洞存在于mboximport功能中，该功能接收ZIP存档并从中提取文件。拥有管理员权限的经过身份验证的用户能够将任意文件上传到系统，从而导致目录遍历。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，可以判断该漏洞利用是有效的。搜索引擎结果中提到该漏洞已被大规模利用，且CISA已将其列入已知被利用漏洞目录。POC代码提供了利用此漏洞的Python脚本。

**投毒风险：**
查看提供的poc代码，未发现任何恶意投毒代码。POC代码主要功能是通过上传恶意的ZIP文件，利用路径遍历漏洞将webshell写入服务器，从而获得服务器的控制权限。代码本身较为清晰，没有隐藏的后门或恶意逻辑。

**利用方式：**
1.  **认证：** 首先，攻击者需要具有管理员权限的有效Zimbra帐户。然而，根据搜索结果，存在未经身份验证的RCE的利用方式，这意味着在某些情况下可以绕过身份验证。
2.  **构造恶意ZIP文件：**  攻击者需要构造一个包含恶意文件（例如，JSP webshell）的ZIP文件。ZIP文件中的文件名需要包含路径遍历序列（例如，`../../../../opt/zimbra/jetty_base/webapps/zimbraAdmin/cmd.jsp`）来指定目标文件写入位置。
3.  **上传ZIP文件：**  攻击者使用mboximport功能上传构造的恶意ZIP文件。POC代码中的`zimbra-exploit.py`脚本通过向`/service/extension/backup/mboximport`端点发送POST请求来完成上传，`account-name`参数指定一个有效的邮箱地址。
4.  **执行恶意代码：**  成功上传并解压ZIP文件后，攻击者可以通过访问上传的webshell（例如，`/zimbraAdmin/cmd.jsp`）来执行任意命令。POC代码中`checkShell`函数检查webshell是否成功上传，通过发送GET请求验证。
5.  **漏洞利用代码分析：** 代码中使用了两个不同的利用路径（`exploit_path`），并尝试了多个webshell名称（`shell_list`），以提高漏洞利用的成功率。还包含一个检查webshell是否成功部署的步骤。

**总结：** 该漏洞的利用涉及构造包含路径遍历payload的恶意ZIP文件，并通过Zimbra的mboximport功能上传。攻击者利用目录遍历将webshell写入Web目录，从而实现远程代码执行。虽然初始描述要求管理员权限，但搜索结果表明存在无需认证的利用方式。提供的PoC代码提供了一个可用的攻击框架。

**项目地址:** [onlyHerold22/CVE-2022-27925-PoC](https://github.com/onlyHerold22/CVE-2022-27925-PoC)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)