## CVE-2021-27568-json-smart-未捕获异常

**漏洞编号:** CVE-2021-27568

**漏洞类型:** 拒绝服务 (DoS)/信息泄露

**影响应用:** netplex json-smart-v1/v2

**危害等级:** 中危，可能导致程序崩溃或暴露敏感信息

**影响版本:** json-smart-v1 (<= 2015-10-23), json-smart-v2 (<= 2.4)

**利用条件:** 应用程序使用存在漏洞的json-smart库，并且解析恶意JSON数据

**POC 可用性:** 是，但提供的POC演示的是另一个问题

**投毒风险:** 0%

## 详情

CVE-2021-27568 是 netplex json-smart-v1 和 json-smart-v2 库中的一个漏洞，当函数抛出异常但未被捕获时，会导致程序崩溃或暴露敏感信息，原因是 NumberFormatException。根据搜索引擎结果显示，该漏洞会导致拒绝服务攻击 (DoS)。

提供的代码库与json-smart漏洞无关，描述的是另一个漏洞：不安全的随机数生成。该代码库包含一个 `InsecureTokenGenerator.java` 文件，它使用 `java.util.Random` 类来生成令牌，这是一个不安全的随机数生成器。`fix.sh` 脚本用于将 `java.util.Random` 替换为 `java.security.SecureRandom`，这是一个更安全的随机数生成器。`SecureTokenGenerator.java` 是修复后的代码。

**有效性：**
提供的 POC 代码 **无效** 于重现 CVE-2021-27568 漏洞，它演示的是不安全的随机数生成而不是json-smart库的异常未捕获。

**投毒风险：**
代码仓库中不存在作者隐藏的恶意代码。`fix.sh` 脚本的目的只是将不安全的随机数生成器替换为安全的随机数生成器。该仓库的投毒风险为0%。

**利用方式：**
1.  目标应用程序必须使用存在漏洞的 json-smart 库（json-smart-v1 <= 2015-10-23 或 json-smart-v2 <= 2.4）。
2.  攻击者需要构造一个恶意的 JSON 字符串，该字符串会导致 json-smart 库在解析时抛出 `NumberFormatException` 异常。
3.  如果应用程序没有捕获这个异常，则可能导致应用程序崩溃或泄露敏感信息，具体取决于应用程序如何处理 json-smart 库抛出的未捕获异常。

**项目地址:** [arsalanraja987/java-insecure-random-cve-2021-27568](https://github.com/arsalanraja987/java-insecure-random-cve-2021-27568)

**漏洞详情:** [CVE-2021-27568](https://nvd.nist.gov/vuln/detail/CVE-2021-27568)