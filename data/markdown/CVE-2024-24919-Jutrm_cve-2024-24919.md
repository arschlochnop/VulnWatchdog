## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露 (路径遍历)

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network) 和 R81.10, R80.20 (Spark versions)

**利用条件:** 需要目标设备连接到互联网，并启用远程访问 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2024-24919 是一种信息泄露漏洞，影响 Check Point Security Gateways。根据搜索引擎结果，该漏洞允许未经身份验证的远程攻击者读取受影响设备上的任意文件内容。漏洞利用方式是利用路径遍历漏洞，访问系统上的敏感文件，如`/etc/passwd`。

**有效性：**
根据CISA KEV记录以及其他搜索结果，该漏洞已被积极利用，POC有效。

**投毒风险：**
提供的POC代码中存在一定的投毒风险，风险大约为60%。具体分析如下：

1.  **电子钱包集成 (Twilio):** `main.js`包含了Twilio集成，用于发送WhatsApp消息。虽然Twilio本身是合法的服务，但恶意攻击者可能会在`config.json`中配置自己的Twilio账号，用于窃取受害者的信息或进行其他恶意活动。 用户在未经审查的情况下使用此代码，可能会泄露自己的 Twilio 密钥，或者被恶意攻击者利用。`config.json`默认包含`your sid`, `your token`等字样,可能存在新手用户没有替换掉的情况

2.  **Electron 应用:** 该代码是一个 Electron 应用，这意味着它可以被打包成一个可执行文件。如果攻击者能够诱骗用户运行恶意构建的版本，他们就可以在用户的计算机上执行任意代码。

3. **忽略证书错误:** `app.commandLine.appendSwitch("ignore-certificate-errors")` 这一行代码会使应用忽略证书错误，这在生产环境中是非常危险的，因为它会使应用容易受到中间人攻击。

4.  **append-to-file:**  `ipcMain.on('append-to-file', ...)` 允许JavaScript代码向`CVE-2024-24919.txt`文件中写入信息，如果被滥用，可以写入恶意信息。

**利用方式：**
1.  攻击者首先需要找到暴露在互联网上的 Check Point Security Gateway，且启用了远程访问 VPN 或 Mobile Access Software Blades。
2.  然后，攻击者发送包含路径遍历payload的HTTP POST请求，例如：`POST /clients/MyCRL HTTP/1.1
Content-Type: application/x-www-form-urlencoded

aCSHELL/../../../../../../../etc/passwd`
3.  如果网关存在漏洞，它会返回`/etc/passwd`文件的内容。
4.  攻击者可以利用泄露的信息进一步攻击系统。


**项目地址:** [Jutrm/cve-2024-24919](https://github.com/Jutrm/cve-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)