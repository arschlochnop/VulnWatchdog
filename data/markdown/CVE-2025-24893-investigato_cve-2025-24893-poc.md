## CVE-2025-24893 - XWiki Platform SolrSearchMacros 远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** XWiki Platform

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码

**影响版本:** >= 5.3-milestone-2, < 15.10.11 和 >= 16.0.0-rc-1, < 16.4.1

**利用条件:** 目标系统运行存在漏洞的XWiki Platform版本，且允许未经身份验证的网络访问。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2025-24893允许未经身份验证的攻击者通过向`SolrSearch`端点发送特制的请求来执行远程代码。该漏洞源于`SolrSearchMacros`宏中对用户输入的不充分的过滤，导致了代码注入漏洞。攻击者可以通过构造包含恶意Groovy代码的`text`参数，在服务器上执行任意代码。根据漏洞描述，只需访问`/<host>/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20` URL即可验证漏洞的存在。

漏洞利用方式：
1.  攻击者构造包含恶意Groovy代码的URL，并将该URL发送到目标XWiki Platform实例的`SolrSearch`端点。
2.  XWiki Platform实例在处理请求时，由于`SolrSearchMacros`宏中的漏洞，会将恶意Groovy代码作为服务器端代码执行。
3.  攻击者从而在服务器上执行任意代码，控制目标系统。

漏洞利用代码分析：
提供的漏洞利用代码（Cargo.lock）是Rust项目的依赖锁定文件，本身不包含任何可执行的漏洞利用代码。从搜索结果来看，`ibrahimsql/cve-2025-24893`仓库提供了一个Go语言编写的漏洞利用程序。但是，目前仅能分析Cargo.lock文件。该文件列出了项目的所有依赖及其版本和校验值，用于确保构建的可重复性。通过检查Cargo.lock文件，无法判断该项目是否存在投毒代码。需要进一步分析Go语言的源代码才能评估投毒风险。

投毒风险评估：
由于仅提供了Rust的依赖锁定文件，无法分析具体代码，因此投毒风险较低，初步判断风险在2%以下，主要是考虑到可能在其他相关文件中存在恶意代码，但无法直接从Cargo.lock判断。

**项目地址:** [investigato/cve-2025-24893-poc](https://github.com/investigato/cve-2025-24893-poc)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)