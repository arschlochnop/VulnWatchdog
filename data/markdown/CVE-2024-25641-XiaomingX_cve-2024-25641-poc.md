## CVE-2024-25641 - Cacti Package Import RCE

**漏洞编号:** CVE-2024-25641

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cacti

**危害等级:** 高危，可完全控制服务器

**影响版本:** < 1.2.27

**利用条件:** 需要拥有 'Import Templates' 权限的已认证用户

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-25641 是 Cacti 中存在的一个远程代码执行漏洞，位于 `import_package()` 函数 (`/lib/import.php`) 中。攻击者（需要具有 'Import Templates' 权限的已认证用户）可以利用 Package Import 功能上传恶意构造的 XML 文件，该 XML 文件包含恶意的文件名和文件内容，由于程序没有充分验证文件名和内容，导致任意文件写入漏洞。攻击者可以利用此漏洞在 Cacti web 服务器上写入或覆盖任意文件，包括 PHP 文件，从而执行任意 PHP 代码。漏洞利用方式如下：

1.  **认证：**  攻击者首先需要以具有 'Import Templates' 权限的用户身份登录 Cacti。
2.  **构造恶意 XML：**  攻击者构造一个恶意的 XML 文件，该文件定义了要写入的目标文件路径和文件内容。文件路径可以包含路径遍历序列（如 `../`）以尝试写入 Cacti 安装目录之外的文件。文件内容可以包含恶意的 PHP 代码。
3.  **上传恶意 XML：**  攻击者使用 Cacti 的 Package Import 功能上传构造的 XML 文件。
4.  **执行代码：**  Cacti 将根据 XML 文件中的定义，将文件写入到指定路径。如果攻击者成功地将包含恶意 PHP 代码的文件写入到 Web 可访问的目录下，就可以通过 Web 浏览器访问该文件，从而执行恶意代码。

根据提供的漏洞利用代码来看，它仅仅是一个开源协议，本身并不具备漏洞利用能力，因此，不存在投毒风险，Poison概率为0%.

**项目地址:** [XiaomingX/cve-2024-25641-poc](https://github.com/XiaomingX/cve-2024-25641-poc)

**漏洞详情:** [CVE-2024-25641](https://nvd.nist.gov/vuln/detail/CVE-2024-25641)