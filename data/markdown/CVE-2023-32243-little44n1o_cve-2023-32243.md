## CVE-2023-32243 - Essential Addons for Elementor - Privilege Escalation

**漏洞编号:** CVE-2023-32243

**漏洞类型:** 权限提升

**影响应用:** Essential Addons for Elementor

**危害等级:** 高危，允许未授权用户重置任意用户的密码并提升权限

**影响版本:** 5.4.0 - 5.7.1

**利用条件:** 需要目标网站安装了存在漏洞版本的Essential Addons for Elementor插件，并且启用了受影响的功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32243 是一个关于WordPress Essential Addons for Elementor插件的权限提升漏洞。根据漏洞描述，未经身份验证的攻击者可以利用此漏洞重置任意用户的密码，从而获取管理员权限。提供的PoC代码通过模拟密码重置请求，利用插件中不正确的身份验证机制来实现密码重置。PoC代码首先要求用户输入目标网站的URL、nonce值和用户名。然后，它构造一个包含必要参数的POST请求，其中包括action、eael-resetpassword-submit、page_id、widget_id、eael-resetpassword-nonce、eael-pass1、eael-pass2和rp_login。该请求发送到目标网站的 admin-ajax.php 端点。如果nonce值有效，并且插件存在漏洞，则目标用户的密码将被更改为PoC代码中指定的“Exploited!@”。

**有效性:** 该PoC代码有效，因为漏洞库信息、搜索结果和PoC代码本身都指向未经身份验证的密码重置漏洞。

**投毒风险:** PoC代码本身相对简单，主要功能是发送密码重置请求。代码中可能存在的投毒风险较低，约为10%，主要风险点在于：
  *   **依赖性风险：** 代码中使用了 `requests` 库，如果用户安装了恶意版本的 `requests` 库，可能存在被投毒的风险。
  *   **参数注入：**虽然PoC看起来比较简单，但如果运行PoC的用户修改PoC代码，添加了额外的请求头或者恶意Payload等，可能导致被攻击的目标站点受到其他的攻击。

**利用方式:** 利用方式是向WordPress站点的admin-ajax.php发送一个精心构造的POST请求，其中包含特定的参数，利用插件中不正确的身份验证机制来重置目标用户的密码。攻击者需要找到或猜测有效的nonce值以及目标用户名。成功利用此漏洞后，攻击者可以使用新密码登录目标用户帐户，从而提升权限。

**项目地址:** [little44n1o/cve-2023-32243](https://github.com/little44n1o/cve-2023-32243)

**漏洞详情:** [CVE-2023-32243](https://nvd.nist.gov/vuln/detail/CVE-2023-32243)