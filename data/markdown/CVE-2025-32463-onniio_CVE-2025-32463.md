## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获取root权限

**影响版本:** 1.9.14 <= Sudo < 1.9.17p1

**利用条件:** 本地用户权限，目标系统存在漏洞版本的Sudo

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞(CVE-2025-32463)允许本地用户通过操纵/etc/nsswitch.conf文件并在使用--chroot选项时利用它来获取root权限。PoC利用方式如下：

1.  **创建临时目录：** 创建一个临时目录用于存放exploit所需的文件。
2.  **构建恶意动态链接库 (libnss_errooe2025.so.2)：** 创建一个C源文件errooe2025.c，该文件包含一个构造函数，该构造函数在加载时将用户的UID和GID设置为0（root），然后执行指定的命令。该PoC默认执行/bin/bash，可以执行任意命令. 将其编译为动态链接库，并放置在特定的目录结构中。
3.  **创建自定义的nsswitch.conf：**  创建一个自定义的`nsswitch.conf`文件，该文件指示系统使用之前构建的恶意动态链接库来解析用户密码信息。具体来说，它将`passwd`数据库的查找指向`/errooe2025`，这会触发动态链接库的加载。
4.  **利用Sudo的--chroot选项：** 使用`sudo -R errooe errooe` 命令，将根目录更改为包含恶意`nsswitch.conf`文件的目录。这会导致Sudo使用该恶意配置文件，并加载恶意动态链接库。
5.  **权限提升：** 当恶意动态链接库被加载时，其构造函数会执行，从而将用户的UID和GID设置为0，从而获得root权限。
6.  **清理：** 删除临时目录。

**有效性评估：**根据漏洞描述和PoC代码，此PoC有效，能够利用该漏洞提升权限。

**投毒风险评估：** 代码中没有发现明显的恶意投毒代码。所有操作都是为了利用漏洞而进行的，虽然存在执行任意命令的行为，但这属于漏洞利用的范畴，PoC本身是良性的，目的是演示漏洞。因此，投毒风险评估为0%。

**利用方式总结：** 该漏洞利用的关键在于Sudo在`--chroot`模式下没有正确处理用户提供的`nsswitch.conf`文件，允许用户通过控制该文件加载恶意动态链接库，从而劫持程序执行流程并提升权限。

**项目地址:** [onniio/CVE-2025-32463](https://github.com/onniio/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)