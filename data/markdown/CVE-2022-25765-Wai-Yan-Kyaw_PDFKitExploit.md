## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 需要pdfkit库处理URL输入

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-25765是pdfkit库中的一个命令注入漏洞，存在于url参数未经过滤的情况下。

**有效性：**
根据漏洞库信息和搜索结果，POC代码是有效的。多个来源都证实了该漏洞的存在，并提供了可利用的POC。

**投毒风险：**
提供的POC代码（exploit.sh）主要功能是从命令行接收URL和脚本参数，然后构造恶意输入利用该命令注入漏洞。虽然POC本身的功能是直接执行提供的脚本，看起来不像是投毒代码，但仍然存在一定风险：
*   **恶意脚本执行：** 用户在使用该POC时，如果未仔细审查`-s`参数提供的脚本，可能会执行恶意操作。
*   **依赖项风险：** POC可能依赖于特定的环境或外部资源，如果这些依赖项被篡改，可能会导致意外行为或被用于投毒。

因此，评估投毒风险约为10%。

**利用方式：**
1.  攻击者需要找到一个使用易受攻击的pdfkit版本的应用程序。
2.  攻击者构造包含恶意命令的URL。
3.  应用程序使用pdfkit处理该URL，导致命令注入。
4.  恶意命令在服务器上执行，攻击者从而控制服务器。

**项目地址:** [Wai-Yan-Kyaw/PDFKitExploit](https://github.com/Wai-Yan-Kyaw/PDFKitExploit)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)