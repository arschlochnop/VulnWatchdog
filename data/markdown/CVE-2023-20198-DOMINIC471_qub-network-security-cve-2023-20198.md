## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别15的账户，完全控制受影响的设备。

**影响版本:** 受影响版本众多，包括16.1.1到17.12.1以及其他版本（详见漏洞库信息）。

**利用条件:** Web UI功能必须已启用。设备需要可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 漏洞允许未经身份验证的攻击者在Cisco IOS XE设备上创建具有特权级别15（最高权限）的本地用户。攻击者通过利用Web UI中的漏洞绕过身份验证，并执行特权命令创建用户。结合另一个漏洞CVE-2023-20273，攻击者可以进一步提升权限至root并写入植入程序到文件系统。 

**有效性评估：**
根据提供的漏洞库信息和搜索结果，CVE-2023-20198是一个严重漏洞，已被积极利用。

**投毒风险评估：**
查看提供的POC代码，包括README.md和IOC Summary.md文件。 README.md主要描述了如何分析、检测和缓解此漏洞。IOC Summary.md列出了攻击者IP，受害者IP，使用的header以及payload等。这些信息可以辅助蓝队进行防御。
总体来说，该仓库的目的是为了分析和缓解漏洞，并没有发现明显的投毒代码。但是，由于代码中可能包含攻击载荷或恶意命令示例，如果使用者不小心，可能会误用这些代码进行非授权的渗透测试，从而导致法律风险。因此，评估的投毒风险为10%。

**利用方式：**
1.  **未授权访问：** 攻击者利用漏洞，绕过Web UI的身份验证机制。
2.  **创建特权用户：** 攻击者通过发送特制的HTTP请求，执行CLI命令，创建一个具有特权级别15的本地用户。
3.  **持久化（结合CVE-2023-20273）：** 攻击者利用新创建的本地用户登录，并利用另一个漏洞（CVE-2023-20273）提升权限到root，并在文件系统中写入植入程序，实现持久化控制。

**缓解措施：**
*   禁用Web UI功能，如果不需要使用。
*   升级到已修复漏洞的IOS XE软件版本。
*   使用入侵检测/防御系统（IDS/IPS）检测和阻止利用此漏洞的攻击。
*   检查设备上是否存在异常用户和植入程序。

**项目地址:** [DOMINIC471/qub-network-security-cve-2023-20198](https://github.com/DOMINIC471/qub-network-security-cve-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)