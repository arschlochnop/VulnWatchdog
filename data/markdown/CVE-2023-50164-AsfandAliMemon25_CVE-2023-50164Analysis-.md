## CVE-2023-50164-Apache Struts 文件上传路径遍历与RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行和服务器控制

**影响版本:** 2.0.0 <= version <= 2.5.32, 6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要能够上传文件的入口点，通常是文件上传功能

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 2 中的一个严重漏洞，源于文件上传组件存在目录遍历缺陷。攻击者可以操纵文件上传参数，实现路径遍历，从而上传恶意文件。在特定情况下，这可能导致远程代码执行。 

**漏洞利用方式：**

1.  **路径遍历：** 攻击者修改文件上传请求中的文件名参数，使其包含目录遍历序列（如 `../`），从而绕过文件上传的限制，将文件上传到服务器的任意位置。
2.  **恶意文件上传：** 攻击者上传包含恶意代码的文件，例如 JSP webshell 或其他可执行文件。
3.  **远程代码执行：** 如果恶意文件上传到Web服务器的可执行目录下，攻击者可以通过访问该文件来执行其中的代码，从而控制服务器。

**POC有效性：**

根据提供的漏洞库信息和搜索结果，CVE-2023-50164是一个已公开的严重漏洞，存在公开的PoC利用代码。提供的POC代码包含Dockerfile，README.md，Maven Wrapper脚本和示例Struts应用程序，用于搭建一个易受攻击的环境，并且提供了python脚本可以利用该漏洞进行攻击，因此判断提供的POC代码有效。

**投毒风险分析：**

检查提供的文件内容，主要关注以下几个方面：

*   **Dockerfile:** 用于构建包含漏洞 Struts 应用程序的 Docker 镜像，其本身并无恶意行为。
*   **README.md:** 提供了如何构建和运行易受攻击的应用程序以及如何使用提供的 PoC 脚本的说明。
*   **struts-app:** 该应用程序包含了漏洞，是漏洞利用的基础，不是投毒。
*   **exploit.py:** 该脚本的目的是利用漏洞，执行文件上传路径遍历，上传webshell，进行RCE。

考虑到POC的目的是为了重现和利用漏洞，其中可能包含webshell上传等操作，这本身不是“投毒”，而是漏洞利用的必要步骤。但是仍需要人工审查该脚本，检查是否存在超出漏洞利用范围的恶意代码，例如反向shell等。考虑到作者在README中提及“This exploit script has been created for the purposes of research. It is not intended to be used for any malicious or unauthorized activities.” 以及“Its recommended to run the application and exploit on Windows host. The exploit may not work on *nix based system sometimes.”，因此可以推测代码可能存在一些限制条件或者本身兼容性不是很好，增加了分析难度。综合判断投毒风险为10%。

**项目地址:** [AsfandAliMemon25/CVE-2023-50164Analysis-](https://github.com/AsfandAliMemon25/CVE-2023-50164Analysis-)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)