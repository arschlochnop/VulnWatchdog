## CVE-2018-11776 - Apache Struts Remote Code Execution

**漏洞编号:** CVE-2018-11776

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3.x (2.3 to 2.3.34), 2.5.x (2.5 to 2.5.16)

**利用条件:** alwaysSelectFullNamespace 为 true，且存在无 namespace 或 wildcard namespace 的配置不当。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-11776 是一个 Apache Struts 2 的远程代码执行漏洞，当 `alwaysSelectFullNamespace` 设置为 true 时，且存在 namespace 配置不当，攻击者可以通过构造恶意的 OGNL 表达式到 URL 中来执行任意代码。

**有效性评估：**

提供的 PoC 代码详细描述了漏洞的利用步骤，包括环境搭建、配置修改、OGNL 表达式构造和 URL 编码等。该 PoC 代码直接可用，因此判断为有效。

**投毒风险评估：**

PoC 代码主要用于验证漏洞的存在，以及攻击方式。代码本身展示了如何部署一个存在漏洞的环境，以及如何构造和发送恶意请求。虽然代码包含下载和部署 struts2-showcase 的步骤,但这仅用于搭建漏洞环境，并非恶意代码。其中执行 `gnome-calculator` 命令只是为了验证 RCE 是否成功。代码目的是为了验证漏洞，并未发现隐藏的、与漏洞利用无关的恶意行为。

综合判断，投毒的可能性较低，大约为 1%。

**利用方式分析：**

1.  **前提条件：** Apache Struts 版本在 2.3.x (2.3 to 2.3.34) 或 2.5.x (2.5 to 2.5.16) 范围内，`alwaysSelectFullNamespace` 设置为 true。
2.  **漏洞点：**  Struts 框架在处理 namespace 时，如果配置不当，允许攻击者注入 OGNL 表达式。
3.  **攻击方法：** 攻击者构造包含恶意 OGNL 表达式的 URL，利用 Struts 的重定向机制或其他方式触发 OGNL 表达式的执行。
4.  **利用步骤：**
    *   查找存在漏洞的 Struts 应用。
    *   构造恶意 OGNL 表达式，例如执行系统命令。
    *   将 OGNL 表达式进行 URL 编码。
    *   将编码后的 OGNL 表达式插入到 URL 中，发送请求。
    *   如果漏洞存在，服务器将执行 OGNL 表达式，从而实现远程代码执行。

**参考搜索结果：**

搜索结果中的多个链接都确认了 CVE-2018-11776 的存在和高危性，并指出该漏洞已被广泛利用。例如，[webpage 6] 提到该漏洞已被用于 Monero 挖矿活动，[webpage 7] 强调该漏洞可以被未授权用户利用。

总之，CVE-2018-11776 是一个严重的漏洞，需要及时修复。提供的 PoC 代码可用于验证漏洞是否存在，但在实际利用时应注意安全风险。

**项目地址:** [xfox64x/CVE-2018-11776](https://github.com/xfox64x/CVE-2018-11776)

**漏洞详情:** [CVE-2018-11776](https://nvd.nist.gov/vuln/detail/CVE-2018-11776)