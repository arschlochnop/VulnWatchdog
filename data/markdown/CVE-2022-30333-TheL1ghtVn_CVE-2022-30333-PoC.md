## CVE-2022-30333-UnRAR目录穿越漏洞

**漏洞编号:** CVE-2022-30333

**漏洞类型:** 目录穿越

**影响应用:** UnRAR (Linux/Unix)

**危害等级:** 高危，允许攻击者写入任意文件，可能导致远程代码执行

**影响版本:** < 6.12

**利用条件:** 目标系统运行受影响版本的UnRAR，且执行UnRAR操作时未进行充分的安全检查。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30333 是 RARLAB UnRAR 在 Linux 和 UNIX 系统上 6.12 版本之前的目录穿越漏洞。此漏洞允许攻击者在提取（也称为解包）操作期间写入任意文件。通过构造恶意的 RAR 压缩包，攻击者可以控制解压路径，将文件写入到目标文件系统的任意位置，例如创建 `~/.ssh/authorized_keys` 文件以实现 SSH 密钥植入，或者在 Zimbra 邮件服务器的 webapps 目录下写入文件以实现远程代码执行。根据提供的POC代码，该漏洞在Linux和Zimbra环境下均可利用。Linux环境POC将文件写入`../../tmp/traversed`目录，Zimbra环境POC将文件写入`/opt/zimbra/jetty_base/webapps/zimbra/public/`，从而实现对Zimbra的攻击。关于投毒风险，由于提供的POC代码主要是演示漏洞利用，并且文件内容为简单的文本，将投毒风险评估为极低 (1%)。 搜索引擎结果也证实了漏洞的存在和利用方式，以及其对 Zimbra 的影响。漏洞利用方式是通过构造包含恶意路径的 RAR 文件，诱使 UnRAR 解压时写入恶意文件到指定位置。

**项目地址:** [TheL1ghtVn/CVE-2022-30333-PoC](https://github.com/TheL1ghtVn/CVE-2022-30333-PoC)

**漏洞详情:** [CVE-2022-30333](https://nvd.nist.gov/vuln/detail/CVE-2022-30333)