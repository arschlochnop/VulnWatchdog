## CVE-2024-27956-WordPress Automatic-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可导致数据库信息泄露、数据篡改以及未经授权的访问控制

**影响版本:** <= 3.92.0

**利用条件:** 目标网站安装了WordPress Automatic Plugin，且版本低于或等于3.92.0，攻击者可以从网络访问该插件的csv.php文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索结果和提供的POC代码，CVE-2024-27956是WordPress Automatic插件中的一个SQL注入漏洞。该漏洞允许未经身份验证的攻击者执行任意SQL命令。利用方式是通过向/wp-content/plugins/wp-automatic/inc/csv.php发送POST请求，并在请求体中构造恶意的SQL语句。提供的POC代码尝试创建一个新的管理员用户'eviladmin'。 

**有效性：**
提供的POC代码看起来是有效的，它包含了一个YAML文件，该文件定义了fscan扫描器要使用的规则。该规则指定了请求方法、路径、HTTP头部以及包含恶意SQL语句的请求体。成功利用漏洞的标志是服务器返回200状态码并且响应体包含"DATE"字符串，这表明SQL注入成功执行。

**投毒风险：**
*   该POC的目的是在WordPress数据库中创建一个名为`eviladmin`的具有默认密码的新用户。虽然这本身不是恶意代码，但如果攻击者使用此POC，则可能会在受害者系统上留下一个后门。
*   YAML文件本身结构清晰，没有发现明显的恶意代码或隐藏的payload。
*   投毒的风险在于，如果用户不理解SQL语句的含义，直接使用该POC，可能会在目标系统上创建不期望的用户。
*   另一个潜在的风险是，攻击者可能修改POC，将SQL语句更改为更具破坏性的操作，如删除数据或更改其他用户的权限。
考虑到以上因素，投毒风险评估为10%。主要风险集中在使用者的误用或恶意修改，而非POC本身携带恶意代码。

**利用方式：**
1.  攻击者向目标WordPress网站的/wp-content/plugins/wp-automatic/inc/csv.php发送POST请求。
2.  在POST请求的body中，攻击者构造包含恶意SQL语句的参数，例如`q`参数。
3.  由于插件未对`q`参数进行充分的过滤和转义，SQL语句会被直接执行。
4.  攻击者可以利用SQL注入漏洞执行任意SQL查询，从而读取、修改或删除数据库中的数据。 在提供的POC中，SQL语句旨在创建一个新的管理员用户。
5. 成功利用该漏洞，可以执行任意SQL命令，例如添加管理员帐户，获取数据库信息，或者执行其他恶意操作。

**项目地址:** [7aRanchi/CVE-2024-27956-for-fscan](https://github.com/7aRanchi/CVE-2024-27956-for-fscan)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)