## CVE-2023-27350-PaperCut NG/MF-身份验证绕过

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过

**影响应用:** PaperCut NG/MF

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 8.0 up to, but not including, 20.1.7, 21.2.11, and 22.0.9.  (CVE描述中明确指出22.0.5 Build 63914受影响)

**利用条件:** 目标PaperCut服务器可访问，端口9191开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27350 是 PaperCut NG/MF 软件中的一个身份验证绕过漏洞。未经身份验证的攻击者可以利用此漏洞绕过身份验证，直接访问管理控制面板，并最终执行远程代码。

**有效性分析：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断此漏洞利用的有效性较高。
*   漏洞库信息明确指出该漏洞允许远程攻击者绕过身份验证并在受影响的PaperCut NG版本上执行任意代码。
*   搜索结果中多个链接表明此漏洞已被积极利用，并导致了Ransomware攻击等严重后果。CISA也发布了相关的安全公告。
*   PoC代码的功能是首先检查目标是否存在漏洞（通过访问SetupCompleted页面并检查返回的版本信息），然后引导用户通过访问特定URL绕过身份验证。PoC验证了身份验证绕过的可行性。根据github说明，漏洞影响8.0到22.0.9之前的版本(不包含).

**投毒风险分析：**
提供的PoC代码主要功能是检测目标PaperCut服务器是否存在漏洞，并提供绕过身份验证的URL链接。代码本身只包含版本检测和URL构造，没有发现任何可疑的后门代码或者恶意操作。因此，投毒风险较低，评估为0%。

**利用方式：**
1.  攻击者首先访问目标PaperCut服务器的`http://<ip>:9191/app?service=page/SetupCompleted`页面。
2.  PoC脚本会自动访问此URL,然后通过解析返回的HTML内容来判断PaperCut的版本信息，以此确定目标是否存在漏洞。
3.  如果目标存在漏洞，PoC会引导攻击者访问`http://<ip>:9191/app?service=page/Dashboard` URL，该URL可以绕过身份验证。
4.  成功绕过身份验证后，攻击者可以访问PaperCut的管理控制面板，从而查看系统设置、日志，甚至更改配置，最终可能导致远程代码执行，控制整个系统。

**项目地址:** [0xB0y426/CVE-2023-27350-PoC](https://github.com/0xB0y426/CVE-2023-27350-PoC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)