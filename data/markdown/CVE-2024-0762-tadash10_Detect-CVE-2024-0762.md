## CVE-2024-0762 - Phoenix SecureCore UEFI 缓冲区溢出

**漏洞编号:** CVE-2024-0762

**漏洞类型:** 缓冲区溢出

**影响应用:** Phoenix SecureCore UEFI

**危害等级:** 高危，可能导致代码执行

**影响版本:** 受影响的Intel Kaby Lake, Coffee Lake, Ice Lake, Comet Lake, Tiger Lake, Jasper Lake, Alder Lake, Raptor Lake, Meteor Lake平台上特定版本的Phoenix SecureCore UEFI固件

**利用条件:** 需要高权限的本地访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-0762 是 Phoenix SecureCore UEFI 固件中一个潜在的缓冲区溢出漏洞，发生在不安全的 UEFI 变量处理过程中。根据漏洞信息，攻击者可能通过某种方式修改或设置恶意的UEFI变量，触发缓冲区溢出，从而在固件运行时执行任意代码。由于涉及底层固件，成功利用可能导致持久性控制，即使重装操作系统也无法清除。

**有效性：**
提供的POC代码主要用于检测目标系统是否使用了受影响的Phoenix SecureCore UEFI固件版本。它通过 `wmic` (Windows) 或 `dmesg` (Linux) 命令获取UEFI固件版本，然后将其与预定义的易受攻击版本列表进行比较。这段代码本身并不能直接利用缓冲区溢出漏洞，而是用于确定目标系统是否存在漏洞。因此，其有效性在于漏洞检测，而非漏洞利用。

**投毒风险：**
该仓库中存在少量投毒代码的风险，约为5%。

理由如下：

1.  **版本检测列表：** POC代码的核心在于 `vulnerable_versions` 列表，该列表中 `vulnerable_version_1` 和 `vulnerable_version_2` 只是占位符，并没有实际的漏洞版本号。如果攻击者修改了此列表，添加了虚假的“易受攻击”版本号，用户运行此脚本后可能会被误报为存在漏洞，从而采取不必要的措施。这是潜在的投毒点。

2.  **VirusTotal 集成 (README.md中提及，但代码中未实现):**  README.md 中提到了 VirusTotal 集成，但提供的 `Firmware Version Detection.py` 代码中并没有实现该功能。如果完整的 POC 包括 VirusTotal 集成，可能存在投毒风险，攻击者可以通过恶意配置或篡改上传的文件来植入恶意代码或泄露用户信息。

3.  **权限要求：** 虽然POC需要本地运行，但修改UEFI变量通常需要较高的权限。如果攻击者诱导用户以管理员权限运行恶意修改后的POC，风险会增加。

4.  **LICENSE和README.md:** LICENSE文件声明了MIT许可，相对宽松。README.md文件描述了脚本的功能和使用方法，但可能存在误导性信息，例如未实现的VirusTotal集成。

综上，虽然检测脚本本身不包含明显的恶意代码，但其版本检测逻辑和潜在的权限要求为投毒行为创造了机会。

**利用方式：**

该漏洞的利用方式如下：

1.  **攻击者需要首先获得具有足够权限的本地访问权限。**
2.  **攻击者需要确定目标系统使用的 Phoenix SecureCore UEFI 固件版本是否属于受影响的范围。**
3.  **攻击者需要构造特制的 UEFI 变量，该变量的内容会导致在写入或处理过程中发生缓冲区溢出。**
4.  **攻击者将特制的 UEFI 变量写入到系统中。** 这可能需要使用特定的工具或操作系统 API 来完成。
5.  **当 UEFI 固件处理该变量时，缓冲区溢出发生，攻击者控制了执行流程，可以执行任意代码。**
6.  **利用成功后，攻击者可以实现持久性的恶意代码执行，因为 UEFI 固件在操作系统之前启动，攻击代码可以绕过操作系统的安全机制。**

总的来说，这是一个复杂的漏洞，需要对 UEFI 固件和变量处理机制有深入的了解。成功利用的难度较高，但也具有极大的危害性。

**项目地址:** [tadash10/Detect-CVE-2024-0762](https://github.com/tadash10/Detect-CVE-2024-0762)

**漏洞详情:** [CVE-2024-0762](https://nvd.nist.gov/vuln/detail/CVE-2024-0762)