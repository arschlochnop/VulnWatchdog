## CVE-2015-6967-Nibbleblog-Unrestricted File Upload

**漏洞编号:** CVE-2015-6967

**漏洞类型:** Unrestricted File Upload

**影响应用:** Nibbleblog

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.0.5

**利用条件:** 需要管理员权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-6967 存在于 Nibbleblog 4.0.5 之前的版本中，My Image 插件存在一个不受限制的文件上传漏洞。攻击者需要具备管理员权限，利用此漏洞可以上传包含恶意代码的文件（例如 PHP shell），然后通过直接访问上传的文件来执行任意代码，实现远程代码执行。利用方式是首先通过管理员账户登录 Nibbleblog，然后通过 My Image 插件的上传功能上传一个包含恶意代码的 PHP 文件，最后通过构造特定的 URL 访问上传的文件，从而执行恶意代码。

**有效性分析:**

提供的 POC 代码 `exploit.py` 看起来是有效的。它模拟了利用该漏洞的步骤：

1.  **登录:** 使用提供的用户名和密码登录 Nibbleblog 管理后台。
2.  **上传 Shell:**  向 My Image 插件的配置页面发送包含恶意 PHP 代码的文件上传请求。
3.  **执行 Shell:** 构造 URL，访问上传的 PHP 文件，触发恶意代码的执行。

**投毒风险分析:**

查看 `exploit.py` 的代码，没有发现任何可疑或恶意的代码。代码的逻辑清晰，实现了漏洞利用的各个步骤，没有隐藏的后门或恶意行为。`README.md` 文件也没有任何可疑内容。因此，投毒风险为 0%。

**利用方式总结:**

1.  攻击者需要拥有 Nibbleblog 管理员账户的用户名和密码。
2.  攻击者运行 `exploit.py` 脚本，提供 Nibbleblog 的 URL、管理员用户名、密码以及包含恶意代码的 PHP 文件路径。
3.  脚本自动登录 Nibbleblog 后台，上传 PHP 文件到 `content/private/plugins/my_image/` 目录。
4.  脚本构造 URL，访问上传的 PHP 文件，触发恶意代码执行。

**项目地址:** [dix0nym/CVE-2015-6967](https://github.com/dix0nym/CVE-2015-6967)

**漏洞详情:** [CVE-2015-6967](https://nvd.nist.gov/vuln/detail/CVE-2015-6967)