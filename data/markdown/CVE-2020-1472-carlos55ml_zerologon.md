## CVE-2020-1472 Zerologon Netlogon特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息

**利用条件:** 需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的漏洞，存在于Microsoft Windows Netlogon远程协议（MS-NRPC）中。攻击者可以通过建立与域控制器的脆弱Netlogon安全通道连接来利用此漏洞，从而获得域管理员权限。 

**漏洞利用方式：**

1.  **利用MS-NRPC协议：** 攻击者使用MS-NRPC协议连接到域控制器。
2.  **零值凭据：**  攻击者通过发送一系列精心构造的Netlogon消息，其中包含零值凭据来重置域控制器的机器帐户密码。
3.  **权限提升：** 成功重置密码后，攻击者可以模拟域控制器账户，窃取域凭据并完全控制域。

**有效性评估：**

提供的PoC代码看起来有效，因为它实现了Zerologon漏洞利用的关键步骤，包括连接到Netlogon服务、使用零值凭据进行身份验证以及重置域控制器密码。

**投毒风险评估：**

分析提供的代码，特别是`empty_pw.py`文件，未发现明显的恶意或后门代码。但始终存在小概率风险，例如：

1.  **编码缺陷：** 代码中可能存在细微的编码错误，可能导致意外行为或拒绝服务，虽然不是恶意投毒，但也可能影响系统稳定性。（5%）
2.  **依赖风险：**  `requirements.txt`文件中列出的依赖项，如果使用了不可信的源，可能会引入恶意软件包。 (5%)

因此，综合评估投毒风险为10%。建议在使用PoC代码之前，仔细审查代码，并从可信来源获取依赖项。

**漏洞库信息：**

漏洞库信息表明，该漏洞影响多个版本的Windows Server，并且Microsoft已发布补丁程序。建议及时安装补丁。

**搜索引擎结果：**

搜索结果确认了该漏洞的严重性，并提供了有关漏洞分析、利用步骤和检测工具的信息。

**项目地址:** [carlos55ml/zerologon](https://github.com/carlos55ml/zerologon)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)