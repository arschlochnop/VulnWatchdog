## CVE-2024-43917-TI WooCommerce Wishlist-SQL注入

**漏洞编号:** CVE-2024-43917

**漏洞类型:** SQL注入

**影响应用:** TI WooCommerce Wishlist

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 2.8.2

**利用条件:** 需要目标WordPress站点安装并启用TI WooCommerce Wishlist插件，且版本小于等于2.8.2。无需用户登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43917是TI WooCommerce Wishlist插件2.8.2及更早版本中存在的SQL注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的攻击者执行任意SQL查询，从而可能访问敏感信息，如用户名和密码。提供的漏洞利用代码通过向`wp-json/wishlist/v1/{share_key}/get_products`端点发送特制的HTTP GET请求来利用此漏洞。 

1.  **有效性：**  根据提供的POC代码和搜索引擎结果，该POC代码的有效性较高。代码首先尝试使用`' OR '1'='1`作为`order`参数进行检测，如果服务器返回状态码200，则认为存在潜在的SQL注入漏洞。然后，它尝试使用`' UNION SELECT user_login, user_pass FROM wp_users --`作为`order`参数来提取`wp_users`表中的`user_login`和`user_pass`字段。如果成功，它会将检索到的数据打印到控制台。
2.  **投毒风险：** 分析POC代码，投毒风险较低。POC代码主要功能是检测和利用SQL注入漏洞，目的是从数据库中提取信息。虽然存在潜在的恶意使用风险，例如利用漏洞进一步篡改数据库，但代码本身并没有明显的后门或恶意代码。Readme.md提示使用者只在授权系统上使用，降低了风险。风险主要在于使用者利用此代码进行非法入侵。根据代码功能判断投毒风险极小，但无法完全排除，因此给与1%的评估。
3.  **利用方式：**  该漏洞的利用方式是通过构造恶意的SQL语句作为`order`参数传递给`wp-json/wishlist/v1/{share_key}/get_products` API端点。攻击者可以利用UNION语句注入恶意的SQL代码, 从数据库中提取敏感数据。该漏洞无需身份验证即可利用。
4.  **排序优先级:** 搜索引擎结果 > 漏洞利用代码 > 漏洞库信息。

**项目地址:** [p33d/CVE-2024-43917](https://github.com/p33d/CVE-2024-43917)

**漏洞详情:** [CVE-2024-43917](https://nvd.nist.gov/vuln/detail/CVE-2024-43917)