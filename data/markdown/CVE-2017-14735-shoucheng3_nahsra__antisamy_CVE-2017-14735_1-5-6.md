## CVE-2017-14735-OWASP AntiSamy-XSS

**漏洞编号:** CVE-2017-14735

**漏洞类型:** XSS

**影响应用:** OWASP AntiSamy

**危害等级:** 中危，可能允许攻击者执行任意JavaScript代码

**影响版本:** < 1.5.7

**利用条件:** 需要AntiSamy对用户可控的HTML内容进行清洗，且使用了存在漏洞的版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-14735 漏洞存在于 OWASP AntiSamy 1.5.7 之前的版本中。该漏洞允许攻击者利用 HTML5 实体进行跨站脚本攻击（XSS）。

**漏洞利用方式：**

攻击者可以使用 `&colon;` HTML5 实体来构造 `javascript:` URL。例如，以下代码可能绕过 AntiSamy 的过滤，导致 XSS：

```html
<a href="&colon;javascript:alert('XSS')">Click me</a>
```

当用户点击链接时，`javascript:alert('XSS')` 将被执行，显示一个警告框。

**有效性：**

根据漏洞描述和搜索结果，可以确认该漏洞是有效的。提供的漏洞利用代码（虽然不是直接的exploit，但仓库代码）进一步佐证了AntiSamy项目的存在，以及漏洞存在的上下文。

**投毒风险：**

分析提供的代码片段，主要包含以下文件：

*   `DevStyleXml.prefs`：Eclipse IDE 的首选项文件，不包含恶意代码。
*   `LICENSE`：AntiSamy 项目的许可证文件，不包含恶意代码。
*   `README.md`：AntiSamy 项目的 README 文件，包含项目描述和一些API变更说明，不包含恶意代码。

这些文件本身不包含任何明显的恶意代码或后门。然而，需要注意的是，如果攻击者能够篡改 AntiSamy 的策略文件，则可以有效地控制 AntiSamy 的行为，从而绕过其安全机制。这种风险不能通过仅仅分析这些文件来确定。这里假设是针对 AntiSamy 仓库本身的投毒风险，因此相对较低。

**利用方式总结：**

1.  攻击者构造包含恶意 HTML5 实体的 HTML 代码，例如使用 `&colon;` 构建 `javascript:` URL。
2.  将恶意 HTML 代码作为用户输入传递给使用 AntiSamy 进行清洗的应用程序。
3.  如果 AntiSamy 的版本低于 1.5.7，且未正确配置策略，则可能无法正确过滤恶意 HTML 代码。
4.  当用户浏览包含恶意代码的页面时，攻击者的 JavaScript 代码将被执行。

**防范措施：**

*   升级 AntiSamy 到 1.5.7 或更高版本。
*   仔细配置 AntiSamy 的策略文件，以确保正确过滤所有类型的 XSS 攻击。
*   对用户输入进行严格的验证和过滤。


**项目地址:** [shoucheng3/nahsra__antisamy_CVE-2017-14735_1-5-6](https://github.com/shoucheng3/nahsra__antisamy_CVE-2017-14735_1-5-6)

**漏洞详情:** [CVE-2017-14735](https://nvd.nist.gov/vuln/detail/CVE-2017-14735)