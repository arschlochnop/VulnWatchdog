## CVE-2022-32287-Apache UIMA-路径遍历

**漏洞编号:** CVE-2022-32287

**漏洞类型:** 路径遍历

**影响应用:** Apache UIMA

**危害等级:** 高危，可能导致任意文件写入

**影响版本:** <= 3.3.0

**利用条件:** 需要能够上传恶意的PEAR文件到UIMA系统

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-32287是Apache UIMA 3.3.0及之前版本中存在的一个路径遍历漏洞。该漏洞位于PEAR管理组件使用的FileUtil类中。攻击者可以通过构造包含恶意ZIP条目名称的PEAR文件，将文件写入到目标目录之外的位置，从而实现任意文件写入。

**有效性：**根据漏洞信息和搜索引擎结果，此漏洞是有效的，并且已经存在公开的利用方法。

**投毒风险：**
提供的代码片段主要包含以下文件：
*   `CONTRIBUTING.md`:  贡献指南，描述如何向Apache UIMA项目贡献代码。
*   `Jenkinsfile`:  Jenkins构建文件，用于自动化构建和测试。
*   `LICENSE.txt`:  Apache License 2.0 许可协议。

这些文件本身不包含任何可疑代码，但如果攻击者成功利用路径遍历漏洞，他们可以在UIMA系统上写入任意文件，包括恶意的JAR文件、脚本等。因此，投毒风险在于成功利用漏洞后植入恶意代码。

由于提供的代码片段仅是UIMA项目的一部分，缺乏完整的PEAR文件处理逻辑，无法直接判断是否存在作者隐藏的投毒代码。但从现有文件来看，直接投毒的可能性较低。投毒风险主要来自成功利用路径穿越漏洞后的进一步攻击行为。因此，判定投毒风险为10%。

**利用方式：**
1.  攻击者创建一个恶意的PEAR文件（实际上是一个ZIP文件）。
2.  该PEAR文件中的ZIP条目名称包含路径遍历序列（例如`../`）。
3.  攻击者将该PEAR文件上传到存在漏洞的Apache UIMA系统。
4.  UIMA系统在解压该PEAR文件时，由于FileUtil类没有正确验证ZIP条目名称，导致文件被写入到指定目标目录之外的位置。
5.  攻击者可以利用该漏洞覆盖系统文件、写入WebShell等，从而控制服务器。

**项目地址:** [shoucheng3/apache__uima-uimaj_CVE-2022-32287_3-3-0](https://github.com/shoucheng3/apache__uima-uimaj_CVE-2022-32287_3-3-0)

**漏洞详情:** [CVE-2022-32287](https://nvd.nist.gov/vuln/detail/CVE-2022-32287)