## CVE-2025-20124 - Cisco ISE Java Deserialization RCE

**漏洞编号:** CVE-2025-20124

**漏洞类型:** Java反序列化远程代码执行

**影响应用:** Cisco Identity Services Engine (ISE)

**危害等级:** 高危，可导致远程代码执行和权限提升

**影响版本:** 3.0.0, 3.0.0 p1, 3.0.0 p2, 3.0.0 p3, 3.1.0, 3.0.0 p4, 3.1.0 p1, 3.0.0 p5, 3.1.0 p3, 3.1.0 p2, 3.0.0 p6, 3.2.0, 3.1.0 p4, 2.7.0 p8, 3.1.0 p5, 3.2.0 p1, 3.0.0 p7, 3.1.0 p6, 3.2.0 p2, 3.1.0 p7, 3.3.0, 3.2.0 p3, 3.0.0 p8, 3.2.0 p4, 3.1.0 p8, 3.2.0 p5, 3.2.0 p6, 3.1.0 p9, 3.3 Patch 2, 3.3 Patch 1, 3.3 Patch 3

**利用条件:** 需要具备有效的只读管理凭据，并且目标Cisco ISE版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-20124 是 Cisco ISE 中的一个 API 漏洞，允许经过身份验证的远程攻击者在受影响设备上以 root 用户身份执行任意命令。该漏洞是由于受影响的软件对用户提供的 Java 字节流进行不安全的反序列化造成的。攻击者可以通过向受影响的 API 发送特制的序列化 Java 对象来利用此漏洞。成功利用此漏洞可能允许攻击者在设备上执行任意命令并提升权限。

**漏洞利用方式：**
1.  攻击者需要具备有效的只读管理凭据才能成功利用此漏洞。
2.  攻击者构造恶意的 Java 序列化对象，该对象包含执行任意命令的 payload。
3.  攻击者将构造好的序列化对象通过POST请求发送到 `/api/v1/admin/deserializer` 端点。
4.  Cisco ISE 服务器在反序列化恶意对象时，会执行其中的 payload，导致远程代码执行。

**有效性评估：**
提供的POC代码尝试利用CVE-2025-20124和CVE-2025-20125。针对CVE-2025-20124，POC中的`build_serialize_payload`函数创建了一个包含占位符“ExecGadget”的序列化payload。**实际利用需要一个有效的Java gadget chain**。由于POC中缺少实际的gadget chain，因此提供的代码**不具备直接可利用性**，需要攻击者自行替换。POC针对CVE-2025-20125进行了授权绕过的尝试，通过向`/api/v1/admin/reload`发送请求来尝试重新加载配置，但实际的成功取决于具体ISE的配置和补丁情况。

**投毒风险分析：**
代码中存在潜在的投毒风险的可能性较低（10%）。风险点在于payload构造部分，但因为当前payload是占位符，只有替换成真正的恶意payload才可能被利用。代码本身的功能是相对清晰的，即利用漏洞进行远程命令执行或授权绕过。如果存在投毒行为，可能存在于payload生成过程中，例如诱导用户使用包含恶意代码的gadget chain。因此，使用此POC时，务必仔细审查`build_serialize_payload`函数，确保使用的gadget chain是安全可信的。

**项目地址:** [Yuri08loveElaina/CVE-2025-20124_and_CVE-2025-20125](https://github.com/Yuri08loveElaina/CVE-2025-20124_and_CVE-2025-20125)

**漏洞详情:** [CVE-2025-20124](https://nvd.nist.gov/vuln/detail/CVE-2025-20124)