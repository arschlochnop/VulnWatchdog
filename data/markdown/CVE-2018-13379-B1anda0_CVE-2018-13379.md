## CVE-2018-13379 - Fortinet FortiOS/FortiProxy 路径遍历漏洞

**漏洞编号:** CVE-2018-13379

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Fortinet FortiOS/FortiProxy

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12, FortiProxy 2.0.0, 1.2.0 to 1.2.8, 1.1.0 to 1.1.6, 1.0.0 to 1.0.7

**利用条件:** 需要目标开启SSL VPN web portal，且存在漏洞版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-13379 是 Fortinet FortiOS 和 FortiProxy 中 SSL VPN web portal 存在的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造特殊的 HTTP 请求，下载系统文件。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，此漏洞利用的有效性较高。搜索引擎结果中多个链接表明该漏洞已被广泛利用。提供的POC代码（CVE-2018-13379.py）通过构造包含路径遍历的 URL（/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession）来尝试读取 `sslvpn_websession` 文件。README.md文件也描述了漏洞的影响版本以及利用方法。 

**投毒风险分析：**
检查了`CVE-2018-13379.py`和`README.md`文件，没有发现任何可疑的恶意代码或者后门，代码功能清晰，就是发送包含payload的请求，判断是否是漏洞地址，然后写入到vul.txt文件中，所以投毒风险为0%。

**利用方式：**
1.  攻击者构造包含路径遍历的恶意 HTTP 请求，例如：
   `GET /remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession HTTP/1.1`
2.  如果目标系统存在漏洞，且SSL VPN web portal 开启，则会返回被请求的文件内容。
3.  攻击者可以利用此漏洞下载敏感文件，例如包含 VPN 用户凭据的文件，从而进一步入侵系统。
4.  POC脚本通过读取URL列表文件，批量测试是否存在该漏洞。

**项目地址:** [B1anda0/CVE-2018-13379](https://github.com/B1anda0/CVE-2018-13379)

**漏洞详情:** [CVE-2018-13379](https://nvd.nist.gov/vuln/detail/CVE-2018-13379)