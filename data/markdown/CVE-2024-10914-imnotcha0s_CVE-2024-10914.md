## CVE-2024-10914 - D-Link NAS OS Command Injection

**漏洞编号:** CVE-2024-10914

**漏洞类型:** OS Command Injection

**影响应用:** D-Link DNS-320/DNS-320LW/DNS-325/DNS-340L

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** 受影响版本直至20241028 (包括DNS-320 v1.00, DNS-320LW v1.01.0914.2012, DNS-325 v1.01/1.02, DNS-340L v1.08)

**利用条件:** 需要网络访问目标设备的Web管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10914 存在于 D-Link DNS-320、DNS-320LW、DNS-325 和 DNS-340L NAS 设备中，是一个命令注入漏洞。攻击者可以通过操纵 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add`  接口的 `name` 参数来执行任意操作系统命令。

**有效性:**
根据提供的漏洞信息和利用代码，该漏洞利用的有效性较高。

**投毒风险评估:**
查看`exploit.py`文件, 主要逻辑就是拼接url，然后发送GET请求，将返回结果打印出来。`LICENSE`、 `README.md` 不包含恶意代码。未发现任何隐藏的投毒代码。所以投毒概率为0%。

**利用方式:**

1.  攻击者首先需要能够访问目标设备的Web管理界面。
2.  攻击者构造包含恶意操作系统命令的HTTP GET请求，并将其发送到 `/cgi-bin/account_mgr.cgi?cmd=cgi_user_add` 接口，其中恶意命令通过URL编码注入到 `name` 参数中。例如：`/cgi-bin/account_mgr.cgi?cmd=cgi_user_add&name=%27;{cmd};%27`。
3.  设备在处理请求时，由于未对 `name` 参数进行充分的过滤或转义，导致注入的操作系统命令被执行。
4.  攻击者可以通过这种方式在设备上执行任意命令，从而完全控制设备。

**项目地址:** [imnotcha0s/CVE-2024-10914](https://github.com/imnotcha0s/CVE-2024-10914)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)