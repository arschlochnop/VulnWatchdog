## CVE-2023-29489-cPanel-跨站脚本攻击(XSS)

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本攻击(XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户凭证泄露、会话劫持、恶意代码执行

**影响版本:** cPanel 版本低于 11.109.9999.116

**利用条件:** 目标服务器运行存在漏洞的cPanel版本，攻击者能够诱使用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息、搜索引擎结果和漏洞利用代码，可以得出以下结论：

1. **有效性：** 提供的POC代码（nuclei 模板）似乎是有效的。它利用 cPanel 的 'cpanelwebcall' 接口，通过构造包含 JavaScript 代码的 URL，触发 XSS 漏洞。当 cPanel 处理无效的 webcall ID 时，没有正确地对用户输入进行转义，导致恶意 JavaScript 代码被执行。

2. **投毒风险：** 分析POC代码内容，未发现任何作者隐藏的投毒代码。该POC只是用于验证XSS漏洞是否存在，而不是执行恶意操作。因此，投毒风险为0%。

3. **利用方式：** 漏洞利用方式是通过构造恶意的 URL，该 URL 包含嵌入在 'cpanelwebcall' 参数中的 JavaScript 代码。当用户访问这个 URL 时，cPanel 会显示一个错误页面，但错误页面会执行 URL 中包含的 JavaScript 代码。这是一种典型的反射型 XSS 攻击。

   具体步骤如下：
   - 攻击者构造一个包含恶意 JavaScript 代码的 URL，例如 `{{BaseURL}}/cpanelwebcall/<img%20src=x%20onerror="prompt(document.domain)">aaaaaaaaaaaa`
   - 攻击者诱使用户点击这个 URL (例如通过钓鱼邮件或其他方式)。
   - 当用户访问这个 URL 时，cPanel 服务器返回一个包含恶意 JavaScript 代码的错误页面。
   - 用户的浏览器执行页面中的 JavaScript 代码，从而触发 XSS 攻击。在这个例子中，`prompt(document.domain)` 会弹出一个显示当前域名信息的对话框，证明 XSS 漏洞存在。

4. **排序优先级：** 搜索引擎结果证实了漏洞的存在，并提供了更详细的背景信息。漏洞利用代码提供了验证漏洞的实际方法，而漏洞库信息提供了漏洞的基本描述和修复版本。


**项目地址:** [Mostafa-Elguerdawi/CVE-2023-29489](https://github.com/Mostafa-Elguerdawi/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)