## CVE-2017-8917 - Joomla SQL注入

**漏洞编号:** CVE-2017-8917

**漏洞类型:** SQL注入

**影响应用:** Joomla

**危害等级:** 高危，可能导致数据泄露、权限提升和服务器控制

**影响版本:** 3.7.x before 3.7.1

**利用条件:** 目标Joomla站点版本为3.7.0，需要网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是Joomla 3.7.0版本中存在的SQL注入漏洞(CVE-2017-8917)，通过`com_fields`组件的`list[fullordering]`参数进行注入。利用方式是通过构造特定的SQL payload，利用MySQL的报错信息来提取数据库中的敏感数据。POC代码首先构造一个MySQL错误payload，该payload利用了`CONCAT`、`FLOOR`、`RAND`和`GROUP BY`函数来触发错误，并将需要提取的数据包含在错误信息中。然后，POC代码向目标URL发送包含payload的HTTP请求，并使用正则表达式从响应中提取数据。漏洞利用的步骤包括：

1.  **获取数据库名称：** 利用报错注入获取当前数据库的名称。
2.  **获取表名：**  利用报错注入获取包含用户信息的表名（通常为`#__users`，但POC代码尝试匹配`%_users`）。
3.  **获取用户数量：**  利用报错注入获取用户信息表中的用户数量。
4.  **获取用户名和密码：** 循环遍历用户信息表，利用报错注入获取每个用户的用户名和密码。

**有效性评估：**
根据漏洞信息和POC代码，该漏洞利用是有效的。POC代码已经实现自动化利用，可以提取Joomla站点中的用户名和密码。

**投毒风险评估：**
在提供的POC代码中，没有发现明显的投毒代码。代码的目的是利用SQL注入漏洞提取数据，没有执行恶意操作或植入后门的行为。因此，投毒风险为0%。

**漏洞利用方式总结：**
攻击者通过向`index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=`参数发送恶意构造的SQL查询，触发SQL注入漏洞。利用MySQL的报错机制，将查询结果嵌入到错误信息中，从而绕过正常的SQL查询限制，获取数据库中的敏感信息，例如数据库名、表名、用户名和密码等。

**项目地址:** [AkuCyberSec/CVE-2017-8917-Joomla-370-SQL-Injection](https://github.com/AkuCyberSec/CVE-2017-8917-Joomla-370-SQL-Injection)

**漏洞详情:** [CVE-2017-8917](https://nvd.nist.gov/vuln/detail/CVE-2017-8917)