## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 严重，远程代码执行可能导致完全系统控制

**影响版本:** 参见漏洞库信息中的受影响版本列表

**利用条件:** 需要目标系统启用IPv6,并且存在于受影响的版本范围之内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38063 是一个Windows TCP/IP 远程代码执行漏洞，影响多个版本的Windows操作系统。根据漏洞信息和搜索结果，该漏洞允许攻击者通过发送特制的IPv6数据包在目标系统上执行任意代码。CVSS评分为9.8，表明其严重程度为危急。

**利用方式：**

1.  **网络信息收集：** 使用`netifaces`库自动获取网络接口、MAC地址和IPv6地址。
2.  **恶意数据包构造：** 使用`scapy`库构造包含`IPv6ExtHdrDestOpt`和`IPv6ExtHdrFragment`扩展头的恶意IPv6数据包。`PadN`选项和分片头的`offset`字段被用于触发漏洞，可能涉及到整数下溢或缓冲区溢出。
3.  **数据包发送：** 使用`scapy`的`sendp`函数将构造的恶意数据包发送到目标IPv6地址。
4.  **触发漏洞：** 发送的数据包会触发Windows TCP/IP 协议栈中的漏洞，导致远程代码执行。

**有效性：**

提供的POC代码似乎是有效的。搜索结果中的多个链接（例如，malwaretech.com的分析）表明存在可利用的PoC。

**投毒风险：**

虽然POC本身似乎旨在演示该漏洞，但我们需要评估其潜在的投毒风险。代码主要依赖于标准库（scapy，netifaces）。

*   **依赖项风险：** `scapy`和`netifaces`本身可能包含漏洞，但这不是此PoC引入的。通常可以通过检查依赖项的来源以及执行安全审计来缓解这种情况。
*   **代码逻辑：** 代码逻辑相对简单，主要集中在生成恶意数据包。未发现明显植入后门或恶意行为的迹象。
*   **变量名：** 作者ID（selenagomez25）略显可疑，但不能作为投毒的明确证据。

**综合评估：**

考虑到POC代码的结构和功能，以及对依赖项的审查，投毒的概率较低。如果作者恶意，他可能利用`scapy`包生成包含恶意负载的原始数据包，但代码中没有发现这种情况。此外，在传输层之下进行操作，通常需要root/管理员权限才能运行此利用程序，这增加了一层额外的限制. 综合来看投毒风险较低，大约5%。主要风险在于依赖项本身可能存在安全问题。

**总结：**

该漏洞是一个严重的远程代码执行漏洞，影响Windows TCP/IP协议栈。提供的POC代码通过构造和发送恶意IPv6数据包来利用此漏洞。虽然投毒风险较低，但用户应谨慎使用该POC，并在安全的环境中进行测试。同时应尽快安装微软官方发布的补丁。

**项目地址:** [selenagomez25/CVE-2024-38063](https://github.com/selenagomez25/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)