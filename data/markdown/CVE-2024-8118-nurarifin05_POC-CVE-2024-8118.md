## CVE-2024-8118-Grafana-权限绕过

**漏洞编号:** CVE-2024-8118

**漏洞类型:** 权限绕过

**影响应用:** Grafana

**危害等级:** 中危，允许具有外部告警实例写入权限的用户写入告警规则，可能导致告警配置被篡改。

**影响版本:** 8.5.0 <= version < 10.3.10, 10.4.0 <= version < 10.4.9, 11.0.0 <= version < 11.0.5, 11.1.0 <= version < 11.1.6, 11.2.0 <= version < 11.2.1

**利用条件:** 需要Grafana实例可访问，且攻击者需要具有外部告警实例写入权限。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-8118 漏洞存在于 Grafana 的告警规则写入 API 端点，由于权限验证错误，具有外部告警实例写入权限的用户可以写入告警规则。根据漏洞库信息和搜索引擎结果，该漏洞是一个中危漏洞。提供的 PoC 代码尝试利用具有 Viewer 角色的 Token 创建告警规则。PoC 代码首先配置 Grafana 的 URL、Token、数据源 UID 和命名空间，然后构造包含告警规则的 Payload，最后向 Grafana 的告警规则写入 API 端点发送 POST 请求。如果返回状态码为 200，则表示漏洞存在；如果返回状态码为 403，则表示用户没有创建告警的权限，说明Grafana服务已经修复。根据 PoC 代码的内容，没有发现任何隐藏的投毒代码，判断投毒风险为0%。利用方式为：攻击者利用具有外部告警实例写入权限的账户（例如Viewer权限），通过 API 接口创建或修改告警规则，从而影响告警系统的正常运行。

**项目地址:** [nurarifin05/POC-CVE-2024-8118](https://github.com/nurarifin05/POC-CVE-2024-8118)

**漏洞详情:** [CVE-2024-8118](https://nvd.nist.gov/vuln/detail/CVE-2024-8118)