## CVE-2024-3094 XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** XZ Utils

**危害等级:** 严重，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 系统使用了受感染的XZ Utils版本，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3094 是一个影响 XZ Utils 的供应链攻击漏洞。攻击者通过在 XZ Utils 的 5.6.0 和 5.6.1 版本中植入恶意代码，该恶意代码在构建过程中被激活，修改 liblzma 库的行为。

**有效性：**
漏洞库信息、搜索引擎结果和漏洞利用代码均证实此漏洞的存在和严重性。漏洞利用代码显示，攻击发生在构建过程中，通过复杂的混淆，将预构建的对象文件插入到 liblzma 代码中。

**投毒风险：**
提供的POC代码是一个GPL许可文件，看起来是一个正常的开源软件协议，不是后门利用代码。实际的投毒行为发生在xz的源码和编译过程中。因此，这个特定的LICENSE文件本身不包含任何投毒代码。投毒行为隐藏在复杂的构建过程和看似无害的测试文件中，很难直接通过查看单个文件来判断是否存在投毒。由于提供的LICENSE文件本身不包含任何可执行代码或恶意指令，因此投毒风险为0%。真正的恶意代码存在于构建脚本和修改过的库中，并使用多层混淆进行了保护。

**利用方式：**
1.  **恶意代码植入：** 攻击者向 XZ Utils 的源代码中添加恶意代码。该恶意代码隐藏在测试文件或其他看似无害的文件中，并通过复杂的构建过程进行混淆。
2.  **构建过程劫持：** 修改后的构建脚本会在构建过程中提取并执行恶意代码。该恶意代码会修改 liblzma 库的行为。
3.  **SSH后门：** 被修改的 liblzma 库会在 SSH 守护进程 (sshd) 中引入后门。当攻击者尝试通过 SSH 连接到受感染的系统时，后门会绕过身份验证，允许攻击者执行任意代码。

**总结：** CVE-2024-3094 是一个高度复杂的供应链攻击，利用了 XZ Utils 的构建过程和 liblzma 库。成功利用此漏洞可能导致未经授权的远程 SSH 访问和代码执行。 由于该投毒是利用构建工具和混淆代码达成的，传统的代码审计方法难以发现，具有极高的隐蔽性。

**项目地址:** [badsectorlabs/ludus_xz_backdoor](https://github.com/badsectorlabs/ludus_xz_backdoor)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)