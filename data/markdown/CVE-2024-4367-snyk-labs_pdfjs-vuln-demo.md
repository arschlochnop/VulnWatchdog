## CVE-2024-4367 - Mozilla Firefox, Firefox ESR, Thunderbird PDF.js JavaScript Execution

**漏洞编号:** CVE-2024-4367

**漏洞类型:** JavaScript 代码执行

**影响应用:** Mozilla Firefox, Firefox ESR, Thunderbird (通过 PDF.js)

**危害等级:** 高危，允许在 PDF.js 上下文中执行任意 JavaScript 代码

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户需要打开恶意的 PDF 文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4367 漏洞是 Mozilla Firefox, Firefox ESR, Thunderbird 中 PDF.js 组件的一个漏洞，由于处理字体时缺少类型检查，允许在 PDF.js 上下文中执行任意 JavaScript 代码。 攻击者可以构造恶意的 PDF 文件，当用户使用受影响的浏览器或 Thunderbird 打开此 PDF 文件时，恶意 JavaScript 代码将被执行。 从提供的漏洞利用代码来看，它提供了一个本地的开发环境来验证和测试利用此漏洞的 PDF 文件。 该 POC 代码包含一个用于演示漏洞利用的 Web 服务器，并提供不同前端框架（React, Vue, Svelte）的组件。通过修改组件指向的 PDF 文件，可以测试不同的攻击载荷。

**有效性评估:**

根据漏洞库信息和搜索结果（特别是 GitHub 上的 POC 仓库），该漏洞被确认存在且有可用的 POC 代码。 POC 代码提供了一个测试环境，可以用来验证漏洞利用。 因此，该漏洞的利用是有效的。

**投毒风险评估:**

分析提供的代码仓库，发现该仓库主要是为了演示和验证 CVE-2024-4367 漏洞，本身提供了 react, vue, svelte 三种框架来演示漏洞，代码本身相对清晰。 存在的风险是由于该漏洞本身会导致任意 JavaScript 代码执行，攻击者可能通过修改测试 PDF 文件或者前端代码（虽然不太容易）来引入恶意代码，从而实现投毒攻击。 因此，存在一定的投毒风险，但主要集中在使用该 POC 代码时，用户需要检查和验证所使用的 PDF 文件和前端代码的安全性。 代码框架较为规范，没有明显的恶意行为，作者可能只是想演示漏洞，而不是进行恶意活动。 考虑到这些因素，投毒风险估计为 10%。

**利用方式分析:**

1.  **漏洞根源：** PDF.js 在处理 PDF 文件中的字体时，缺少必要的类型检查。
2.  **攻击方式：** 攻击者构造一个包含恶意 JavaScript 代码的特制 PDF 文件。
3.  **攻击过程：**
    *   用户使用受影响的 Firefox, Firefox ESR 或 Thunderbird 版本打开该恶意 PDF 文件。
    *   PDF.js 解析该 PDF 文件。
    *   由于缺少类型检查，恶意 JavaScript 代码在 PDF.js 的上下文中被执行。
4.  **攻击结果：** 恶意 JavaScript 代码可以执行各种恶意操作，例如窃取敏感信息、执行任意代码等。 由于 PDF.js 运行在浏览器的安全上下文中，攻击者通常无法直接访问操作系统的底层资源。 然而，在某些情况下，他们可能通过其他漏洞或利用浏览器的功能来提升权限。

**项目地址:** [snyk-labs/pdfjs-vuln-demo](https://github.com/snyk-labs/pdfjs-vuln-demo)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)