## CVE-2025-48384-Git配置引用导致的任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本：< 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库，并使用 `--recurse-submodules` 参数初始化子模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 是一个 Git 漏洞，源于 Git 在处理配置文件中的引号时不正确，特别是当子模块路径包含尾随回车符（CR）时。攻击者可以利用此漏洞通过创建包含恶意子模块配置的 Git 仓库，诱使用户克隆该仓库，并通过 `--recurse-submodules` 初始化子模块，从而导致任意代码执行。

**有效性分析：**

提供的 PoC 代码通过以下步骤利用该漏洞：

1.  创建一个包含恶意 hook 的 `evil` 目录，该 hook 会执行反向 shell。
2.  创建一个 `mainrepo` 目录，作为主仓库。
3.  在 `mainrepo` 目录中，创建一个 `.gitmodules` 文件，其中包含一个子模块定义，该子模块的路径包含尾随回车符 (`evil\r`)。
4.  创建一个符号链接，将 `evil/hooks` 指向 `../evil/.git/hooks`，从而将恶意 hook 链接到子模块的 hooks 目录。
5.  将恶意子模块添加到仓库，并提交更改。
6.  通过 `git clone --recurse-submodules` 克隆 `mainrepo` 仓库，触发子模块初始化，从而执行恶意 hook。

根据 PoC 代码的逻辑和漏洞描述，该 PoC 代码是有效的。

**投毒风险分析：**

PoC 代码的目的是演示漏洞利用，其中包含的反向 shell 属于漏洞验证的一部分。但是，也存在潜在的投毒风险，比如在 `generate_poc.sh` 脚本中，作者可能会嵌入其他恶意代码，例如：

*   收集用户信息并发送到远程服务器。
*   修改系统文件。
*   安装恶意软件。

尽管PoC本身就是漏洞利用，但仍然存在被作者恶意利用的可能性，因此投毒风险评估为 10%。

**利用方式总结：**

1.  攻击者创建一个包含恶意子模块配置的 Git 仓库。
2.  攻击者诱使受害者克隆该仓库，并使用 `--recurse-submodules` 初始化子模块。
3.  Git 在处理包含尾随回车符的子模块路径时出现错误，导致子模块被检出到错误的位置。
4.  由于符号链接的存在，恶意 hook 被链接到子模块的 hooks 目录。
5.  在子模块初始化过程中，恶意 hook 被执行，导致任意代码执行。

**项目地址:** [nguyentranbaotran/cve-2025-48384-poc](https://github.com/nguyentranbaotran/cve-2025-48384-poc)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)