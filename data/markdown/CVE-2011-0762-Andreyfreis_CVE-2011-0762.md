## CVE-2011-0762-vsftpd-DoS

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 高危，导致服务不可用

**影响版本:** < 2.3.3

**利用条件:** 需要已认证的FTP用户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2011-0762 存在于 vsftpd 2.3.3 之前的版本中。漏洞位于 `ls.c` 文件的 `vsf_filename_passes_filter` 函数中。远程已认证的用户可以通过发送包含精心构造的 glob 表达式的 `STAT` 命令到多个 FTP 会话，导致拒绝服务。攻击方式是通过消耗 CPU 资源和耗尽进程槽位。根据提供的漏洞利用代码，该代码尝试使用用户名和密码登录FTP服务器, 然后发送包含大量glob模式的STAT命令, 从而触发漏洞。 漏洞利用代码的投毒风险较低,主要是因为其逻辑较为简单, 大部分代码是用于建立FTP连接和发送畸形`STAT`命令。但是仍然存在极小的风险,作者可能在发送数据包的函数中插入恶意代码，但概率极低。

**利用方式：**

1.  攻击者需要一个有效的 FTP 用户名和密码。
2.  攻击者通过 FTP 客户端连接到存在漏洞的 vsftpd 服务器。
3.  攻击者发送包含恶意 glob 表达式的 `STAT` 命令。
4.  `vsf_filename_passes_filter` 函数在处理这些表达式时会消耗大量的 CPU 资源。
5.  重复发送这些命令会耗尽服务器的资源，导致拒绝服务。

**项目地址:** [Andreyfreis/CVE-2011-0762](https://github.com/Andreyfreis/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)