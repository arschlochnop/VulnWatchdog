## CVE-2021-42013 - Apache HTTP Server RCE

**漏洞编号:** CVE-2021-42013

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致完全系统入侵和控制

**影响版本:** 2.4.49, 2.4.50

**利用条件:** CGI脚本已启用，且 Alias 指令配置不当，未对外部文件进行 "require all denied" 保护。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-42013 是一个 Apache HTTP Server 中的远程代码执行漏洞。该漏洞是 CVE-2021-41773 的不完整修复。攻击者可以利用路径遍历漏洞读取服务器上的任意文件，如果服务器开启了 CGI 支持，则可能执行任意命令。

**有效性：**
提供的PoC 代码 `exploit.py` 利用 curl 发送带有特殊构造的 URL 的 POST 请求，尝试绕过路径限制并执行命令。URL 包含 `/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh`，其中 `%%32%65` 是 `%2e` 的双重 URL 编码，表示 `.` 字符。这种编码绕过了 Apache 的某些安全检查。如果目标服务器存在漏洞且 CGI 启用，则可以成功执行命令。

**利用方式：**
1.  **路径遍历：** 攻击者使用特制的 URL，其中包含双重编码的 `.` 字符，以绕过路径检查，访问受限目录之外的文件。
2.  **CGI 执行：** 如果服务器的 CGI 脚本已启用，攻击者可以通过访问 `cgi-bin` 目录下的脚本来执行代码。
3.  **命令执行：** 通过 POST 请求的 body 部分，将需要执行的命令传递给服务器。PoC 代码使用 `echo;{command}` 的方式，将命令注入到 shell 中执行。
4.  **反弹shell：** PoC代码可以自动生成反弹shell，从而建立与目标服务器的连接。

**投毒风险：**
该仓库中的投毒风险评估为 10%。虽然利用代码本身实现了漏洞利用的功能，但仍存在潜在的风险：

*   **不明显的恶意代码：** 作者可能在代码中插入不明显的恶意代码，例如收集目标服务器信息、植入后门等。
*   **依赖风险：**  虽然说明中声称没有额外的 Python 依赖，但是依然需要 curl 和 netcat 。curl 本身可能存在安全问题，如果 curl 被替换为恶意版本，可能导致额外的风险。
*   **供应链投毒：** 尽管该 PoC 没有明确的依赖关系，但 GitHub 仓库本身也可能受到供应链攻击的影响，例如账户被盗用并被恶意修改。

总而言之，在使用任何公开的漏洞利用代码时，都应谨慎审查代码，确保其安全性。建议在隔离环境中运行该 PoC 代码，并监控其行为，以防止潜在的恶意行为。

**项目地址:** [FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit](https://github.com/FakhriCRD/Apache-CVE-2021-42013-RCE-Exploit)

**漏洞详情:** [CVE-2021-42013](https://nvd.nist.gov/vuln/detail/CVE-2021-42013)