## CVE-2018-10933 - libssh 身份验证绕过

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 身份验证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和远程代码执行

**影响版本:** 0.7.6, 0.8.4之前版本

**利用条件:** 目标服务器运行存在漏洞的libssh版本且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2018-10933 漏洞是 libssh 服务器端状态机中的一个身份验证绕过漏洞。攻击者可以通过发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息来绕过身份验证。漏洞存在于 0.7.6 和 0.8.4 之前的 libssh 版本中。

**有效性：**

根据漏洞库信息和搜索引擎结果，此漏洞是真实存在的，并且已经存在公开的PoC。

**投毒风险：**

提供的漏洞利用代码包含三个文件：`README.md`、`index.html` 和 `index2.html`。 这些文件看起来像是简单的网页，其主要作用是描述漏洞并提供一个指向其他资源（下载 PoC）的链接。 链接 `https://is.gd/9XCAh2` 是一个短链接，这本身就存在风险，因为它隐藏了真实的下载地址。 虽然提供的文件本身不包含恶意代码，但通过该短链接下载的PoC可能是被投毒的。 短链接指向的程序可能是恶意程序。

因此，这里存在的投毒风险较高，作者极有可能利用短链接，诱导用户下载恶意payload，从而控制用户服务器，或者进行其他恶意行为。

**利用方式：**

1.  攻击者连接到存在漏洞的 libssh 服务器。
2.  攻击者发送 `SSH2_MSG_USERAUTH_SUCCESS` 消息，绕过身份验证。
3.  成功绕过身份验证后，攻击者可以创建 channel 并执行任意命令。


**项目地址:** [cve-2018/cve-2018-10933](https://github.com/cve-2018/cve-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)