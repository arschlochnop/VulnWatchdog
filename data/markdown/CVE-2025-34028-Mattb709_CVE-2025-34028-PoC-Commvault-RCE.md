## CVE-2025-34028 - Commvault Command Center Remote Code Execution

**漏洞编号:** CVE-2025-34028

**漏洞类型:** 路径遍历导致的远程代码执行

**影响应用:** Commvault Command Center Innovation Release

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** 11.38

**利用条件:** 需要目标系统运行受影响的Commvault Command Center版本，并且攻击者能够通过网络访问该系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-34028 是 Commvault Command Center Innovation Release 11.38 版本中存在的一个路径遍历漏洞。未经身份验证的攻击者可以通过上传包含恶意路径的 ZIP 文件，利用此漏洞实现远程代码执行。服务器在解压 ZIP 文件时，恶意路径被利用，将文件写入到任意位置，从而执行恶意代码。

**有效性评估：** 根据搜索结果和提供的漏洞利用代码，此漏洞的利用是有效的，多个信息来源表明存在可用的 PoC，并且已经观察到攻击尝试。

**投毒风险分析：** 提供的代码仓库主要包含以下文件：LICENSE，README.md，requirements.txt，和一个Python exploit 主文件（虽然没有直接提供，但README中提到了文件名 `CVE-2025-34028-Commvault.py`）。

*   **LICENSE (MIT License):** 开源许可证本身不构成投毒风险。
*   **README.md:** 提供了漏洞描述、PoC 使用方法等信息，本身不构成投毒风险，但是需要注意其中描述的功能是否与实际代码一致。
*   **requirements.txt:** 列出了 PoC 运行所需的 Python 依赖库。检查这些库的版本是否存在已知的恶意版本或者安全漏洞是评估投毒风险的一部分。这里列出了 `requests==2.31.0`, `tabulate==0.9.0` 和 `urllib3==2.0.4`。这些库本身比较常见，风险较低, 但也不能排除未来出现新的安全问题。
*   **CVE-2025-34028-Commvault.py (假定):** 这是最需要关注的文件。需要检查以下几个方面：
    *   **ZIP 文件生成逻辑：** 检查 PoC 如何生成包含恶意路径的 ZIP 文件。确认路径遍历的方式是否正确，以及是否有可能被利用来写入恶意文件到危险位置。
    *   **Payload 执行方式：** 确认 PoC 如何在目标系统上执行 Payload。是否存在后门、信息收集等恶意行为。
    *   **错误处理：** 检查 PoC 的错误处理机制是否健全。恶意攻击者可能会利用错误处理机制来隐藏恶意代码。

在没有看到具体 `CVE-2025-34028-Commvault.py` 源代码的情况下，无法进行准确的投毒评估。但是，存在一定的风险，例如：该PoC会尝试进行RCE，如果被植入恶意代码, 则存在被投毒的可能。故评估存在10% 的投毒风险。

**利用方式：**

1.  **目标确定：** 攻击者需要确定存在漏洞的 Commvault Command Center Innovation Release 11.38 版本的目标系统。
2.  **ZIP 文件构造：** 攻击者构造一个恶意的 ZIP 文件，该文件包含一个或多个具有路径遍历序列的文件。这些序列旨在允许将文件写入到 Web 服务器文件系统上预期目录之外的位置，例如 Web shell 可访问的目录。
3.  **文件上传：** 攻击者通过 Commvault Command Center 的文件上传功能上传构造的 ZIP 文件。由于身份验证绕过，此上传可以未经身份验证执行。
4.  **远程代码执行：** Commvault Command Center 解压 ZIP 文件时，路径遍历序列会将文件写入到指定位置。 如果攻击者成功写入 Web shell，他们可以通过发送 HTTP 请求执行任意代码。

**项目地址:** [Mattb709/CVE-2025-34028-PoC-Commvault-RCE](https://github.com/Mattb709/CVE-2025-34028-PoC-Commvault-RCE)

**漏洞详情:** [CVE-2025-34028](https://nvd.nist.gov/vuln/detail/CVE-2025-34028)