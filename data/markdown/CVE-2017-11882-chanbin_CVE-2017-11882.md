## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 内存破坏漏洞

**影响应用:** Microsoft Office

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 需要用户打开特制的RTF文档。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-11882 是一个 Microsoft Office 内存破坏漏洞，存在于 Equation Editor 组件中。攻击者可以通过构造恶意的 RTF 文档，利用该漏洞在受害者系统上执行任意代码。从搜索引擎结果来看，此漏洞在野外被广泛利用，常被用于传播恶意软件，如 Agent Tesla 等。提供的 POC 代码是一个 Python 脚本，用于生成包含漏洞利用代码的 RTF 文件。脚本通过构造包含恶意 OBJECT 数据的 RTF 文件来触发漏洞。此OBJECT的数据部分利用了EQNEDT32.EXE处理公式时存在的栈缓冲区溢出。

**有效性：**
根据漏洞信息和网络搜索结果，提供的 POC 代码应该有效，可以成功触发漏洞并执行任意代码。因为此漏洞利用已存在多年，有大量公开的利用案例和 Metasploit 模块可用，证明了其有效性。

**投毒风险：**
查看POC代码，该脚本主要功能是生成恶意的RTF文件，利用office的公式编辑器漏洞执行命令。代码本身并不包含额外的恶意逻辑，如反弹 shell 或下载执行其他恶意程序等。因此，此仓库中作者隐藏的投毒代码的风险较低，只有生成恶意RTF文件的功能，不包含后门。可以判断投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的 Python 脚本 (CVE-2017-11882.py) 生成恶意的 RTF 文档，该文档包含特制的公式编辑器对象。
2.  攻击者将此 RTF 文档通过电子邮件、网络共享或其他方式发送给受害者。
3.  受害者使用存在漏洞的 Microsoft Office 版本打开 RTF 文档。
4.  当 Office 尝试解析和渲染 RTF 文档中的公式编辑器对象时，由于内存处理错误，触发栈缓冲区溢出漏洞。
5.  攻击者预先在公式编辑器对象中嵌入的恶意代码会被执行，从而在受害者系统上执行任意命令，通常用于下载和执行恶意载荷。

**缓解措施：**
*   及时安装 Microsoft 提供的安全补丁。
*   禁用或删除 Equation Editor 组件（如果不需要）。
*   使用最新的防病毒软件和入侵检测系统。

**项目地址:** [chanbin/CVE-2017-11882](https://github.com/chanbin/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)