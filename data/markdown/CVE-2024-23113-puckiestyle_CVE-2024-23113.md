## CVE-2024-23113 - Fortinet Format String Vulnerability

**漏洞编号:** CVE-2024-23113

**漏洞类型:** Format String Vulnerability

**影响应用:** FortiOS, FortiProxy, FortiPAM, FortiSwitchManager

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS (7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13), FortiProxy (7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.15), FortiPAM (1.2.0, 1.1.0-1.1.2, 1.0.0-1.0.3), FortiSwitchManager (7.2.0-7.2.3, 7.0.0-7.0.3)

**利用条件:** 需要网络访问，目标设备监听在541端口，并且运行受影响的Fortinet产品版本。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-23113是一个存在于多个Fortinet产品中的格式化字符串漏洞。攻击者可以通过发送特制的网络数据包利用此漏洞执行未授权的代码或命令，实现远程代码执行。根据提供的POC代码，该脚本尝试通过TLSv1.2连接到目标设备的541端口（FortiGate FGFM服务）。它发送一个包含格式化字符串`%n`的payload，如果目标设备存在漏洞，将导致连接中断或异常行为。`%n`格式化字符串会尝试将已输出的字符数写入内存地址，这可能导致程序崩溃或被利用于代码执行。该POC脚本的主要目的是检测漏洞的存在，而不是直接利用它。关于投毒风险的评估，代码库主要包含漏洞检测脚本和说明文档，旨在帮助安全研究人员和系统管理员识别潜在的漏洞。虽然该脚本可以用于未经授权的漏洞探测，但其本身并没有发现任何明显的恶意代码或后门。考虑到脚本的用途和内容，投毒风险较低。搜索引擎结果确认了漏洞的存在和严重性，并提供了关于漏洞利用和缓解措施的更多信息。综上所述，该漏洞的利用方式是通过发送包含恶意格式化字符串的网络数据包，导致目标设备执行未授权的代码或命令。POC代码有效，投毒风险极低。

**项目地址:** [puckiestyle/CVE-2024-23113](https://github.com/puckiestyle/CVE-2024-23113)

**漏洞详情:** [CVE-2024-23113](https://nvd.nist.gov/vuln/detail/CVE-2024-23113)