## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，允许未经身份验证的攻击者读取任意文件和/或执行远程代码

**影响版本:** 2.4.49

**利用条件:** 目标系统运行受影响的 Apache HTTP Server 版本，并配置了Alias指令或启用了CGI脚本执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞，如果配置不当，可能导致远程代码执行。该漏洞允许攻击者通过构造包含特殊字符（如 URL 编码的 `%2e` 和 `%2e%2e`）的 URL，来访问服务器上受限目录之外的文件。

**有效性:**

根据漏洞库信息，该漏洞已在野外被利用。提供的 exploit-db 链接 (在 `mass_cve-2021-41773/README.md` 中) 也验证了这一点。提供的python脚本 `cve-2021-41773.py`  通过读取 `/etc/passwd` 文件来检测漏洞存在。另一个脚本 `cve-2021-41773_RCE.py` 尝试通过 cgi-bin 执行命令 `uname`，如果返回 `Linux` 或 `linux`，则认为存在 RCE 漏洞。

**投毒风险:**

检查提供的代码，没有发现明显的恶意或后门代码。所有的脚本都是为了验证漏洞的存在，而不是植入任何持久性的后门。`cve-2021-41773.py`  扫描目标然后保存结果, `cve-2021-41773_RCE.py`  是RCE验证脚本。`cve-2021-41773_manual.py` 允许手动指定命令执行. 因此投毒风险评估为0%。

**利用方式:**

1.  **路径遍历 (文件读取):**  攻击者发送一个精心构造的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符，例如 `/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`。如果服务器存在漏洞且目录配置不当，服务器将返回 `/etc/passwd` 的内容。
2.  **远程代码执行 (RCE):**  如果服务器启用了 CGI 脚本执行，攻击者可以使用路径遍历来访问和执行任意脚本。`cve-2021-41773_RCE.py` 脚本通过POST请求向URL发送命令, 例如 `uname`，如果执行成功, 则判定可以RCE.  利用需要服务器配置支持 CGI 脚本，且目标路径没有 require all denied 配置。

**项目地址:** [justakazh/mass_cve-2021-41773](https://github.com/justakazh/mass_cve-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)