## CVE-2025-8971-Online Tour and Travel Management System-SQL注入

**漏洞编号:** CVE-2025-8971

**漏洞类型:** SQL注入

**影响应用:** Online Tour and Travel Management System

**危害等级:** 高危，可能导致数据泄露、数据篡改和服务器控制

**影响版本:** 1.0

**利用条件:** 需要网络可达，目标系统运行且存在/admin/operations/travellers.php文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8971是Online Tour and Travel Management System 1.0版本中/admin/operations/travellers.php文件存在的一个SQL注入漏洞。攻击者可以通过操纵`val-username`参数，注入恶意SQL代码，从而执行未授权的数据库操作。\n\n**有效性评估：**
根据漏洞库信息和提供的POC代码，该漏洞的利用是有效的。漏洞库信息表明该漏洞已被公开披露，且存在可利用的POC。POC代码也提供了详细的利用步骤和示例，表明该漏洞是可复现的。
\n**投毒风险分析：**
*   **LICENSE:** MIT许可证，允许修改和分发，降低了投毒代码被发现的概率，但不能直接证明是否存在投毒。
*   **README.md:** 描述了漏洞和利用方法，包含编译和使用说明，没有明显的投毒迹象。
*   **script.c:** 这是主要的漏洞利用代码。代码看起来是标准的C语言代码，用于发送HTTP请求并执行SQL注入。详细检查了代码，发现以下潜在风险：
    *   使用了`system()` 函数，这个函数可以执行任意系统命令，可能被用于执行恶意操作。但是，在提供的代码片段中没有找到明确使用`system()`的调用。如果后续代码中使用了，则存在很高的风险。
    *   文件上传功能可能被用于上传恶意文件，例如webshell。POC代码中包含文件上传的参数，进一步加剧了风险。
    *  CURL库的使用本身比较安全，但如果存在不安全的CURL配置，可能导致信息泄露或中间人攻击。\n考虑到上述风险，特别是文件上传功能和潜在的 `system()` 调用，以及作者Byte Reaper的信息较少，无法验证其可信度，综合判断存在约10%的投毒风险。
\n**利用方式：**
1.  **构建URL：** 构造包含漏洞文件的完整URL，例如`http://<target>/admin/operations/travellers.php`。
2.  **准备POST数据：**  构造包含恶意SQL注入payload的POST请求数据，并将payload注入到`val-username`参数中。
3.  **发送请求：** 使用curl或其他HTTP客户端发送POST请求到目标URL。
4.  **分析响应：**  分析服务器的响应，以确定SQL注入是否成功。可以通过检查响应内容、响应时间等方式进行判断。
5.  **文件上传 (可选):** 通过`-f`参数上传恶意文件(.php)，实现RCE。

**项目地址:** [byteReaper77/CVE-2025-8971](https://github.com/byteReaper77/CVE-2025-8971)

**漏洞详情:** [CVE-2025-8971](https://nvd.nist.gov/vuln/detail/CVE-2025-8971)