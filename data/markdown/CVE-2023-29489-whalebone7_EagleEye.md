## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致用户凭据泄露或恶意脚本执行

**影响版本:** before 11.109.9999.116

**利用条件:** 用户需要访问包含恶意链接的cPanel页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29489 是 cPanel 中的一个跨站脚本漏洞，存在于 11.109.9999.116 之前的版本中。该漏洞源于 cpsrvd 错误页面对 webcall ID 的不正确处理，攻击者可以通过构造包含恶意 JavaScript 代码的 URL，诱使用户点击，从而在受害者浏览器上执行任意脚本。 

**有效性：** 根据漏洞信息和搜索引擎结果，此漏洞是有效的，Assetnote 的博客文章详细描述了漏洞发现过程和利用方法。该漏洞利用代码 (EagleEye) 的作用是对通过 `gf xss` 和 `qsreplace` 生成的 XSS payload 进行验证，通过截图和 OCR 技术检测页面上是否存在注入的 XSS payload。

**投毒风险：** 提供的漏洞利用代码仓库 (EagleEye) 主要是一个辅助 XSS 漏洞检测的工具，利用 `httpx`、`gf`、`qsreplace`、`tesseract` 等工具链进行漏洞验证，本身不包含直接利用 CVE-2023-29489 的 payload。`ee.sh`脚本使用Tesseract OCR识别截图中的文本。潜在的投毒风险在于：

*   `ee.sh` 脚本在处理截图文件后，会将OCR识别结果保存在 `whalebone7.txt` 文件中，脚本运行完成后，会删除 `whalebone7*.txt` 和 `paths.txt`文件,没有恶意代码。
*   用户需要安装 Tesseract OCR，如果用户从非官方渠道下载安装 Tesseract OCR，可能存在被植入恶意代码的风险。

因此，该仓库本身直接包含恶意代码的风险较低，但用户在使用前仍需仔细检查脚本内容，确保其行为符合预期。 投毒风险评估为10%。

**利用方式：**

1.  **构造恶意链接：** 攻击者构造包含 XSS payload 的恶意 URL，该 URL 利用了 cpsrvd 错误页面对 webcall ID 的不正确处理。
2.  **诱导用户点击：** 攻击者通过钓鱼邮件、社交媒体等方式，诱导 cPanel 用户点击该恶意链接。
3.  **执行恶意脚本：** 当用户点击恶意链接后，cPanel 服务器会返回包含 XSS payload 的错误页面，从而在用户的浏览器上执行攻击者预先设定的恶意 JavaScript 代码。

攻击者可以利用 XSS 漏洞窃取用户的 cPanel 会话 Cookie，或者在用户不知情的情况下执行管理操作，例如创建新的用户账户、修改文件等等。

**缓解措施：**

*   升级 cPanel 到受影响版本之后的版本 (>= 11.109.9999.116)。
*   对用户输入进行严格的验证和过滤。
*   实施内容安全策略 (CSP)，限制页面可以加载的资源来源。

**项目地址:** [whalebone7/EagleEye](https://github.com/whalebone7/EagleEye)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)