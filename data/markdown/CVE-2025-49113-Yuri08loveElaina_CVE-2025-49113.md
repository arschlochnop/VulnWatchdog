## CVE-2025-49113-Roundcube-RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP 对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，允许经过身份验证的用户执行远程代码

**影响版本:** <=1.5.9 和 1.6.0-1.6.10

**利用条件:** 需要有效的Roundcube会话 cookie

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-49113 是 Roundcube Webmail 中的一个 PHP 对象反序列化漏洞。由于 `program/actions/settings/upload.php` 中未对 URL 中的 `_from` 参数进行验证，经过身份验证的用户可以通过构造恶意的序列化 PHP 对象，并将其作为 `_from` 参数的值传递，从而执行任意代码。

**有效性:**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出此漏洞会导致远程代码执行。搜索引擎结果也显示该漏洞已被积极利用。提供的POC代码提供了一种利用此漏洞的方法。

**投毒风险:**

分析POC代码，`exploit.py` 主要功能是：上传恶意 phar 文件到服务器，或者直接利用服务器上已存在的 phar 文件，通过构造特定的 URL 触发 PHP 反序列化漏洞，进而执行恶意代码。这个过程中并没有发现明显的后门代码或者恶意行为。POC 中使用了 `phpggc` 来生成 phar 文件，这个工具本身是安全的，但是生成 phar 文件的命令`phpggc monolog/rce1 system 'id' -p phar -o payload.phar` 中的 `system 'id'` 指示了会在目标系统上执行 `id` 命令，验证漏洞是否存在。 虽然代码本身未发现明显的投毒行为，但攻击者可能会使用此 POC 传播恶意 phar 文件，从而造成更大范围的危害。因此，投毒风险较低，大约为 1%。

**利用方式:**

1.  **创建恶意Payload:** 使用 `phpggc` 等工具创建包含恶意代码的 PHP 对象序列化后的 phar 文件。
2.  **上传Payload (可选):** 使用 POC 脚本上传 phar 文件到 Roundcube Webmail 服务器。POC 脚本支持自动猜测上传路径，或者直接指定上传路径。
3.  **触发反序列化:** 通过构造包含 `_from` 参数的 URL，并将其值设置为 `phar://` 协议指向上传的 phar 文件路径，触发 PHP 反序列化漏洞。
4.  **远程代码执行:** 成功利用漏洞后，恶意代码将在 Roundcube Webmail 服务器上执行。

该漏洞需要攻击者拥有有效的 Roundcube 会话 cookie，这意味着攻击者必须先通过身份验证才能利用此漏洞。

**项目地址:** [Yuri08loveElaina/CVE-2025-49113](https://github.com/Yuri08loveElaina/CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)