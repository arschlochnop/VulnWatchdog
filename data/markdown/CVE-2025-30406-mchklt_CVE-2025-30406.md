## CVE-2025-30406-CentreStack-反序列化漏洞

**漏洞编号:** CVE-2025-30406

**漏洞类型:** 反序列化漏洞

**影响应用:** Gladinet CentreStack

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 16.4.10315.56368

**利用条件:** 需要目标系统存在漏洞版本，并且攻击者需要知道machineKey。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30406是Gladinet CentreStack中存在的一个反序列化漏洞，源于程序使用了硬编码的machineKey。攻击者可以利用这个machineKey来构造恶意的序列化payload，从而在服务器端执行任意代码。漏洞利用需要攻击者知道目标系统的machineKey，可以通过读取`portal\web.config`文件获取（如果权限允许）。POC代码`exploit.py`利用ysoserial生成恶意ViewState payload，并将其发送到目标URL的`__VIEWSTATE`参数中。`server.py`可用于接收和显示命令执行结果，提供更友好的输出格式。虽然POC描述中包含exfiltration，但其中Invoke-WebRequest部分存在潜在的风险，可能被用于收集额外信息或执行其他恶意操作。尽管POC的主要功能是利用反序列化漏洞，但exfiltration部分如果滥用，则有投毒的嫌疑。攻击者可能修改`server.py`以记录更多信息或修改`exploit.py`以在受害者不知情的情况下进行额外的操作。

**有效性评估：** 根据漏洞描述和POC代码，该漏洞利用是有效的。漏洞库信息和搜索引擎结果均表明该漏洞已经被积极利用。

**投毒风险评估：** POC代码本身看起来是为了演示漏洞利用，但`exploit.py`中`-e`参数指定的回调URL以及`server.py`接收和显示命令输出的机制存在潜在的投毒风险。攻击者可以修改这两个脚本以收集额外信息或执行其他未经授权的操作。因此，投毒风险评估为10%。

**利用方式：**

1.  **确定目标系统版本：** 确认目标系统运行的是受影响的CentreStack版本（低于16.4.10315.56368）。
2.  **获取machineKey：** 尝试通过各种方式获取目标系统的machineKey。例如，如果可以访问`portal\web.config`文件，则可以直接读取该值。
3.  **准备ysoserial：** 下载并配置ysoserial工具。
4.  **生成payload：** 使用`exploit.py`脚本，提供目标URL、要执行的命令以及ysoserial的路径，生成恶意的ViewState payload。
5.  **发送payload：** 将生成的payload通过POST请求发送到目标URL的`__VIEWSTATE`参数中。
6.  **（可选）接收结果：** 如果使用了`-e`参数，则启动`server.py`，并观察是否收到命令执行的结果。

**项目地址:** [mchklt/CVE-2025-30406](https://github.com/mchklt/CVE-2025-30406)

**漏洞详情:** [CVE-2025-30406](https://nvd.nist.gov/vuln/detail/CVE-2025-30406)