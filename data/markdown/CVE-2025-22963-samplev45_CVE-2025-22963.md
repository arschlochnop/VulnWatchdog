## CVE-2025-22963-Teedy-CSRF账户接管

**漏洞编号:** CVE-2025-22963

**漏洞类型:** CSRF (跨站请求伪造)

**影响应用:** Teedy

**危害等级:** 高危，可能导致账户接管

**影响版本:** <= 1.11

**利用条件:** 用户已登录Teedy，攻击者诱骗用户访问恶意网站

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22963是Teedy 1.11及更早版本中存在的一个跨站请求伪造（CSRF）漏洞。攻击者可以利用此漏洞诱使用户（包括管理员）在不知情的情况下执行恶意操作，例如更改其密码并接管帐户。漏洞存在于`/api/user/admin`端点，该端点仅验证cookie中的`auth_token`进行身份验证。由于`auth_token`可以在其他源网站中使用，攻击者可以构建一个恶意网站，该网站向`/api/user/admin`发出请求以更改用户的帐户信息（包括密码）。

**有效性评估：**

提供的POC代码看起来是有效的，因为它展示了一个用于更改用户信息的POST请求，并且说明了如何利用该漏洞来接管帐户。POC通过指定`username`、`groups`、`email`、`totp_enabled`、`storage_quota`、`storage_current`、`disabled`、`password`和`passwordconfirm`等参数来修改admin用户的相关信息。

**投毒风险分析：**

该仓库中存在潜在的投毒风险，概率约为10%。虽然核心POC代码看起来是直接的CSRF利用，但是修复建议部分引入了新的Java代码（`CSRFToken.java`和`RandomTokenGenerator.java`）以及对现有JavaScript和Java代码的修改。这些修改可能包含隐藏的后门或漏洞，但需要进一步的审计才能确认。提供的图片链接是不可靠的，无法审核修复代码。

**利用方式：**

1.  攻击者构造一个包含恶意请求的HTML页面或脚本。
2.  攻击者诱骗已登录Teedy的用户访问该恶意页面。
3.  用户的浏览器在未经用户授权的情况下向Teedy服务器发送请求，更改用户帐户信息（例如，密码）。
4.  攻击者使用新密码登录受害者的帐户，实现帐户接管。

缓解措施是实施CSRF令牌验证，就像POC中建议的那样，为每个用户会话生成唯一的令牌，并验证每个请求中的令牌。

**项目地址:** [samplev45/CVE-2025-22963](https://github.com/samplev45/CVE-2025-22963)

**漏洞详情:** [CVE-2025-22963](https://nvd.nist.gov/vuln/detail/CVE-2025-22963)