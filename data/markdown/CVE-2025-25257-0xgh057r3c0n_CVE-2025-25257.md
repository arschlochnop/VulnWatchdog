## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，导致远程代码执行

**影响版本:** 未知，但参考搜索结果，是Fortinet FortiWeb的GUI组件中存在漏洞

**利用条件:** 需要目标FortiWeb实例的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25257是Fortinet FortiWeb中的一个未经身份验证的SQL注入漏洞。攻击者可以通过向/api/fabric/device/status API发送特制的请求，在Authorization头部注入恶意SQL代码，从而执行未经授权的SQL命令。

**有效性：**
根据搜索结果（特别是watchTowr的分析）和PoC代码，该漏洞利用是有效的。PoC代码演示了如何通过SQL注入上传webshell，并最终实现远程代码执行(RCE)。代码中的`SQLInjection`类负责执行SQL注入，`RCE`类继承它并实现了webshell上传和命令执行的功能。

**投毒风险：**
PoC代码本身的功能是利用SQL注入漏洞，实现RCE。 虽然不能完全排除任何细微的投毒可能性，但根据对提供的代码的分析，显著的恶意代码注入（例如反向shell，数据窃取等）的概率较低。PoC的主要目标似乎是演示漏洞利用，而不是植入长期后门。 此处假设的投毒风险较低，约10%，主要是考虑到代码的复杂性以及潜在的细微的隐藏恶意行为的可能性。

**利用方式：**
1.  **SQL注入：**  利用`SQLInjection`类，通过构造特殊的Authorization头部，向`/api/fabric/device/status` API发送包含恶意SQL语句的请求。注入点在Authorization头部中。
2.  **创建Webshell：** 使用SQL注入将webshell内容写入到`/migadmin/cgi-bin/x.cgi`。
3.  **修改文件权限：**  通过SQL注入执行chmod命令，赋予webshell可执行权限。利用python hook触发chmod，即通过将包含chmod命令的payload写入`/var/log/lib/python3.10/pylab.py`，再访问`/cgi-bin/ml-draw.py`触发python代码执行，从而执行chmod命令。
4.  **远程代码执行：**  webshell上传成功并且具有可执行权限后，通过修改User-Agent头来传递要执行的命令，访问webshell `/cgi-bin/x.cgi`即可执行任意命令。

**项目地址:** [0xgh057r3c0n/CVE-2025-25257](https://github.com/0xgh057r3c0n/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)