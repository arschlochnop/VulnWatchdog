## CVE-2025-9074 - Docker Desktop 远程API未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危，可能导致容器逃逸、主机文件系统访问、任意代码执行

**影响版本:** < 4.44.3

**利用条件:** Docker Desktop 运行，并且Docker Engine API暴露在192.168.65.7:2375(默认)或者0.0.0.0:2375未授权访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-9074 是 Docker Desktop 中的一个高危漏洞，允许本地运行的 Linux 容器访问 Docker Engine API，默认情况下位于 192.168.65.7:2375。此漏洞存在于启用了或未启用增强容器隔离 (ECI) 的情况下，以及启用了或未启用“在 tcp://localhost:2375 上公开守护程序而不使用 TLS”选项的情况下。

**有效性：**

提供的 PoC 代码是有效的。它演示了如何在未授权的情况下通过 Docker Remote API 创建和启动容器。搜索引擎结果也证实了漏洞的存在和严重性，并提供了相关的分析和缓解措施。

**投毒风险：**

PoC 代码本身相对简单，主要功能是创建和启动容器。在提供的代码片段中未发现明显的投毒代码。但是，攻击者可以修改 PoC 代码，例如修改镜像来源，加入恶意的命令，从而实现更高级的攻击。因此，存在一定的投毒风险，估计为 10%。

**利用方式：**

1.  **漏洞发现：** 攻击者需要首先确定目标 Docker Desktop 是否启用了未授权的 Docker Engine API 访问（通常是 192.168.65.7:2375 或 0.0.0.0:2375）。
2.  **API 交互：** 攻击者使用 PoC 代码或类似的工具，通过 HTTP 与 Docker Remote API 交互。
3.  **容器创建：** 攻击者可以创建新的容器，指定要运行的镜像和命令。恶意镜像可能包含后门程序或恶意软件。或者，攻击者可以挂载宿主机目录到容器内，从而读写宿主机文件系统。
4.  **容器启动：** 创建容器后，攻击者通过 API 启动容器。
5.  **权限提升：** 在容器内，攻击者可以执行任意命令，甚至可以利用Docker socket逃逸到宿主机，从而完全控制宿主机。
6.  **数据窃取/破坏：** 攻击者可能利用获取的权限窃取敏感数据、修改系统配置或进行其他恶意活动。

**缓解措施：**

*   升级到 Docker Desktop 4.44.3 或更高版本。
*   确保 Docker Engine API 未在没有身份验证的情况下公开。
*   使用防火墙或网络策略限制对 Docker Engine API 的访问。
*   监控容器活动，检测异常行为。

**项目地址:** [fortihack/CVE-2025-9074](https://github.com/fortihack/CVE-2025-9074)

**漏洞详情:** [CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)