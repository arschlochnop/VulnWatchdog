## CVE-2023-41425-WonderCMS-XSS to RCE

**漏洞编号:** CVE-2023-41425

**漏洞类型:** 跨站脚本 (XSS) 导致远程代码执行 (RCE)

**影响应用:** WonderCMS

**危害等级:** 高危，可能导致远程代码执行和完全控制服务器

**影响版本:** 3.2.0 <= 版本 <= 3.4.2

**利用条件:** 需要管理员用户访问易受攻击的WonderCMS实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-41425 是 WonderCMS 3.2.0 到 3.4.2 版本中的一个跨站脚本 (XSS) 漏洞。攻击者可以利用此漏洞通过上传精心设计的脚本来执行任意代码。具体利用方式如下：

1.  **XSS注入：** 攻击者首先需要找到一个可以注入XSS代码的入口点。根据提供的PoC，攻击者构造一个包含恶意JavaScript代码的URL，诱骗管理员点击该URL。

2.  **恶意Theme上传：** 恶意JavaScript代码会向服务器发送请求，该请求旨在通过`installModule`参数安装一个恶意的Theme。这个Theme实际上是一个包含后门PHP代码的zip文件。PoC会创建一个名为`evil.php`的文件，其中包含允许执行任意PHP代码的后门。

3.  **远程代码执行：** 一旦恶意Theme安装成功，攻击者就可以通过访问`evil.php`文件来执行任意PHP代码。PoC提供了一个示例，展示如何使用`curl`命令来执行`id`命令或启动反向shell。

**有效性：**  根据漏洞信息、搜索结果以及提供的漏洞利用代码，可以判断该PoC代码是有效的。搜索结果中的多个链接都表明该漏洞存在并且可以被利用。PoC代码也提供了详细的利用步骤和示例，进一步证实了漏洞的可利用性。

**投毒风险：**  PoC代码中存在一定的投毒风险的可能性。虽然主要目的是演示XSS到RCE的利用，但是以下几个方面值得注意：

*   **依赖外部资源：** PoC需要攻击者搭建一个Web服务器来托管恶意Theme zip文件和XSS payload（xssrce.js, xsscookie.js）。如果攻击者控制了这些服务器，可以修改这些文件来加入额外的恶意代码。
*   **sudo权限：** PoC中使用了`sudo python3 -m http.server`来启动web server,这意味着在运行PoC的机器上需要sudo权限,这可能会带来一定的风险。
*   **后门代码：** `evil.php`本身就是一个后门，允许执行任意PHP代码。虽然这是PoC的核心，但如果未经授权使用，将会导致严重的后果。

综合来看，投毒风险主要集中在攻击者可能修改PoC代码中的外部资源或滥用后门代码。考虑到这些因素，评估投毒风险为10%。

**利用方式总结：**

1.  构造包含XSS Payload的恶意URL。
2.  诱骗管理员访问该URL。
3.  XSS Payload触发Theme安装过程，从攻击者控制的服务器下载恶意Theme zip文件。
4.  恶意Theme安装后，攻击者通过访问后门PHP文件执行任意代码，获取服务器控制权。
5.  或者窃取cookie,假冒管理员登录。

此漏洞的危害性在于，攻击者无需身份验证，即可通过诱骗管理员点击恶意链接，最终实现远程代码执行，完全控制受影响的WonderCMS服务器。

**项目地址:** [charlesgargasson/CVE-2023-41425](https://github.com/charlesgargasson/CVE-2023-41425)

**漏洞详情:** [CVE-2023-41425](https://nvd.nist.gov/vuln/detail/CVE-2023-41425)