## CVE-2024-7014-Telegram for Android-EvilVideo

**漏洞编号:** CVE-2024-7014

**漏洞类型:** 恶意软件安装

**影响应用:** Telegram for Android

**危害等级:** 高危，可能导致设备被恶意控制和数据泄露

**影响版本:** <= 10.14.4

**利用条件:** 用户需要点击伪装成视频的恶意文件，并安装其中的恶意应用

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2024-7014是一个存在于Telegram for Android应用程序中的名为EvilVideo的漏洞。攻击者可以利用此漏洞，通过发送伪装成视频的恶意应用程序，诱导用户点击并安装。一旦安装，该恶意应用程序可能窃取用户数据、进行恶意操作，甚至完全控制设备。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞影响Telegram for Android 10.14.4及更早版本。提供的漏洞利用代码包含以下几个部分：
1.  `README.md`:  简单的描述文件。
2.  `testv.mp4`:  可能是伪装的恶意视频文件，其内容是一个 HTML 页面，模拟一个应用商店页面，诱导用户下载恶意APK。页面显示“Ultimate Video Player”，并使用假的下载链接指向softonic.com， softonic.com这个站点安全性未知。
3.  `tg.py`:  一个 Python 脚本，用于将 HTML 内容发送到 Telegram 聊天中。 这段代码不完整，但可以推断其目的是通过 Telegram Bot API 发送伪装的应用商店页面。
综合来看，提供的POC代码具备一定的有效性，因为它能够伪装成视频并尝试诱导用户安装恶意软件。

**投毒风险：**
*   `testv.mp4` 中的 HTML 页面链接指向 `softonic.com` 下载链接。链接具有一定的迷惑性，因为用户可能会认为是从一个相对可靠的第三方平台下载，但实际上`softonic.com`下载的软件安全性无法保证，存在被劫持或者本身就是恶意软件的可能。
*   `tg.py` 脚本本身不完整，无法直接执行。但考虑到其目的是通过 Telegram Bot 发送信息，意味着攻击者可能通过远程服务器控制传播恶意软件，增加了攻击的隐蔽性和范围。
*   综上，该仓库的投毒风险较高， 因为它包含诱导用户下载恶意链接，并且可以通过 bot 进行传播。

**利用方式：**
1.  攻击者创建一个恶意APK，并将其伪装成视频文件（例如`testv.mp4`）。
2.  攻击者使用`tg.py`脚本或其他方式，通过Telegram将伪装的视频文件发送给目标用户。
3.  目标用户在不知情的情况下点击“视频”文件，实际上是一个HTML页面。
4.  HTML页面模拟应用商店页面，诱导用户下载并安装恶意APK。
5.  用户安装恶意APK后，攻击者可以利用该APK进行恶意活动。
6.  攻击者可能会通过Telegram Bot实现自动化传播，扩大攻击范围。

**项目地址:** [hexspectrum1/CVE-2024-7014](https://github.com/hexspectrum1/CVE-2024-7014)

**漏洞详情:** [CVE-2024-7014](https://nvd.nist.gov/vuln/detail/CVE-2024-7014)