## CVE-2025-47176-Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2025-47176

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Outlook

**危害等级:** 高危，允许攻击者在本地执行任意代码

**影响版本:** Microsoft 365 Apps for Enterprise 16.0.1 (不包含 https://aka.ms/OfficeSecurityReleases) 和 Microsoft Office LTSC 2024 1.0.0 (不包含 https://aka.ms/OfficeSecurityReleases)

**利用条件:** 攻击者需要拥有Outlook账户并能够发送邮件，用户需要点击邮件中的链接。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-47176 是一个Microsoft Outlook的远程代码执行漏洞，利用方式是通过构造包含恶意路径的Outlook邮件。当Outlook解析包含'.../...//'的路径时，如果路径指向cmd.exe等敏感程序，可能导致本地代码执行。

**有效性评估：**

根据提供的PoC代码和漏洞信息，该PoC具有一定的有效性。PoC代码通过win32com库与Outlook交互，创建一个包含恶意路径的邮件，并将其保存到收件箱。然后，PoC启动一个HTTP服务器，等待用户点击邮件中的链接。当用户点击链接时，PoC会模拟易受攻击的路径解析器，如果路径包含"cmd.exe"，则执行重启系统的命令。由于漏洞描述中提到'.../...//'，以及PoC中使用了`os.path.normpath`进行标准化，可以推断漏洞的根本原因在于Outlook对路径的规范化处理不当，导致可以绕过安全检查执行恶意代码。 搜索引擎结果也表明此漏洞影响范围广，危害性高。

**投毒风险分析：**

PoC代码的主要功能是模拟漏洞利用过程，而不是植入后门或执行恶意操作。尽管PoC会重启系统，但这是为了演示漏洞的利用效果，而不是隐藏的恶意行为。 但是, 存在极小的风险，因为PoC涉及到远程链接的点击, 如果链接被替换为恶意的钓鱼网站或包含漏洞的网站, 可能会导致投毒。 综合评估投毒风险为 5%。

**利用方式分析：**

1.  攻击者构造包含恶意路径（如`.../...//windows/system32/cmd.exe`）的HTML邮件。
2.  攻击者通过Outlook将邮件发送给目标用户。
3.  用户打开邮件并点击其中的链接。
4.  Outlook尝试解析邮件中的路径，由于路径规范化处理不当，导致可以执行任意代码。
5.  PoC模拟执行`shutdown /r /t 5`命令，重启系统。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   避免点击不明来源的邮件中的链接。
*   加强Outlook安全设置，限制脚本执行。

**项目地址:** [mahyarx/CVE-2025-47176](https://github.com/mahyarx/CVE-2025-47176)

**漏洞详情:** [CVE-2025-47176](https://nvd.nist.gov/vuln/detail/CVE-2025-47176)