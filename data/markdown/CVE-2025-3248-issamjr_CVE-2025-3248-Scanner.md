## CVE-2025-3248 Langflow RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码

**影响版本:** < 1.3.0

**利用条件:** Langflow实例正在运行，并且可以通过网络访问/api/v1/validate/code端点

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3248 是 Langflow 中一个关键的未经身份验证的远程代码执行 (RCE) 漏洞。该漏洞存在于 `/api/v1/validate/code` 端点，该端点不安全地使用 Python `exec()` 执行用户提供的代码，而无需身份验证或沙盒。远程攻击者可以通过构造恶意的 HTTP 请求来利用此漏洞，从而执行任意 Python 代码。根据搜索结果，该漏洞已被积极利用，并与 Flodrix 僵尸网络的传播相关联。

**有效性：**

提供的 POC 代码看起来是有效的。它构建了一个带有恶意 Python 代码的 POST 请求，该代码旨在利用 `exec()` 函数执行任意命令。成功执行将返回包含系统信息的响应，从而确认 RCE。

**投毒风险：**

`scanner.py` 本身包含后门的风险较低。但是，需要注意以下几点：

*   该代码依赖于 `requests` 和 `colorama` 库。供应链攻击仍然是一个风险，因为这些库可能会被破坏。
*   脚本的目的本质上是攻击性的，可能会被滥用。作者在免责声明中承认了这一点。
*   scanner.py只发送payload并验证响应是否包含uname信息。如果payload发送恶意代码,风险在于目标系统执行payload，而不是scanner.py本身。
*   从概率上来讲，作者Issam Junior如果想投毒, 最好的方式是在exp发送payload时加入隐蔽的恶意代码, 这样可以大范围进行传播, 达到投毒的目的.

评估下来scanner.py本身存在投毒代码的可能性较低，约为5%。

**利用方式：**

1.  攻击者向 Langflow 实例的 `/api/v1/validate/code` 端点发送带有恶意 Python 代码的 POST 请求。
2.  Langflow 不安全地使用 `exec()` 执行提供的代码。
3.  攻击者执行任意 Python 代码，从而控制系统。

**项目地址:** [issamjr/CVE-2025-3248-Scanner](https://github.com/issamjr/CVE-2025-3248-Scanner)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)