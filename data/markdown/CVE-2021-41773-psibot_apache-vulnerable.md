## CVE-2021-41773 - Apache HTTP Server Path Traversal 和 RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** Path Traversal, Remote Code Execution (RCE)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49, 2.4.50

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49 或 2.4.50，且配置允许CGI脚本执行，部分Alias目录未进行 require all denied 限制。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中，是一个路径遍历漏洞。攻击者可以通过构造包含恶意路径的URL，绕过 Alias 指令配置的目录限制，访问服务器上的任意文件，如果目标开启了CGI支持，攻击者可以通过构造恶意请求执行任意代码。该漏洞利用的关键在于路径规范化处理的缺陷，允许攻击者使用 `/.%2e` 绕过限制。

**有效性：**
根据漏洞描述和提供的漏洞利用代码，可以判定该POC代码是有效的。漏洞库信息、搜索引擎结果和漏洞利用代码都确认了该漏洞的存在以及利用方式。Nuclei模板可以用来检测目标服务器是否存在漏洞，而curl命令的POC则直接利用了路径遍历读取 `/etc/passwd` 文件。

**投毒风险：**
提供的代码仓库主要包含Nuclei的YAML模板文件和一个README.md文件。Nuclei模板主要用于漏洞检测，本身不具备直接植入后门的能力。投毒风险主要集中在以下几个方面：
1.  **模板逻辑修改：** 攻击者可能修改模板的匹配规则，使得原本不存在漏洞的服务器也被误判为存在漏洞，从而误导用户进行后续操作。
2.  **模板Payload替换：**  攻击者可能在模板中替换恶意的payload，例如，将读取`/etc/passwd` 替换为执行恶意命令的payload。但提供的模板中直接包含RCE利用，风险相对较小
3.  **依赖库劫持：** 虽然Nuclei本身是安全的，但如果用户使用的Nuclei版本存在依赖库劫持的风险，攻击者可能通过替换Nuclei的依赖库来执行恶意代码。但此风险与本仓库代码关系不大。

因此，综合考虑，该仓库存在一定的投毒风险，但主要集中在Nuclei模板的修改上，而不是直接包含恶意代码。 风险占比10%。

**利用方式：**
1.  **路径遍历（文件读取）：** 攻击者构造包含 `/.%2e/%2e%2e/%2e%2e/%2e%2e/` 序列的URL，尝试读取服务器上的任意文件，例如 `/etc/passwd`。
2.  **远程代码执行 (RCE)：**  如果服务器启用了CGI，攻击者可以通过路径遍历访问到CGI脚本，并通过构造特殊的请求来执行任意命令。具体方法通常依赖于服务器的具体配置和CGI脚本的编写方式。

**项目地址:** [psibot/apache-vulnerable](https://github.com/psibot/apache-vulnerable)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)