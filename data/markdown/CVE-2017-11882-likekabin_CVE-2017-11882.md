## CVE-2017-11882-Microsoft Office 内存破坏漏洞

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 用户需要打开包含恶意构造的RTF文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882 是一个影响 Microsoft Office 的内存破坏漏洞。攻击者可以通过创建一个特制的 RTF 文档，利用 Equation Editor 组件中的漏洞来执行任意代码。根据漏洞库信息和搜索结果，该漏洞已经被广泛利用，并且有公开的 PoC 代码。

**有效性:**

提供的 PoC 代码 `Command109b_CVE-2017-11882.py` 是基于原始 PoC 修改的版本，它允许执行最大长度为 109 字节的命令。该 PoC 的有效性较高，因为漏洞信息表明该漏洞已经被广泛利用，且存在多个公开的 PoC。

**投毒风险:**

查看提供的 POC 代码， 该脚本主要用于生成包含漏洞利用代码的RTF文档，该文档依赖于目标系统上的`regsvr32` 组件执行远程sct文件。 理论上，作者可以在生成的RTF文档中加入其他恶意代码，或者修改脚本使得其下载执行恶意的sct文件，存在一定的投毒风险。由于该脚本的目的是为了远程代码执行，因此投毒的风险的可能性为10%。

**利用方式:**

1.  **构造恶意的 RTF 文档:**  攻击者使用 PoC 代码（如提供的 `Command109b_CVE-2017-11882.py`）生成包含漏洞利用代码的 RTF 文档。该文档利用了 Equation Editor 组件中的栈缓冲区溢出漏洞。
2.  **诱骗用户打开文档:**  攻击者通过电子邮件、网页或其他方式将恶意 RTF 文档发送给目标用户，诱骗其使用 Microsoft Office 打开。
3.  **触发漏洞执行代码:**  当用户打开 RTF 文档时，Equation Editor 组件尝试解析文档中的恶意数据，导致栈缓冲区溢出，最终执行攻击者预先设定的代码。该PoC允许执行109字节的命令。
4.  **远程代码执行:**  攻击者通常会利用 `regsvr32` 下载并执行远程 SCT 文件，从而实现远程代码执行。SCT 文件可以包含任意的 VBScript 或 JScript 代码，攻击者可以利用它来下载和执行其他恶意软件，或者直接控制目标系统。

**缓解措施:**

*   安装 Microsoft 提供的安全补丁。
*   禁用 Equation Editor 组件（如果不需要使用）。
*   使用最新的防病毒软件和安全工具。

**项目地址:** [likekabin/CVE-2017-11882](https://github.com/likekabin/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)