## CVE-2016-10002-Squid-信息泄露

**漏洞编号:** CVE-2016-10002

**漏洞类型:** 信息泄露

**影响应用:** Squid HTTP Proxy

**危害等级:** 中危，可能导致Cookie数据泄露

**影响版本:** 3.1.10 through 3.1.23, 3.2.0.3 through 3.5.22, and 4.0.1 through 4.0.16

**利用条件:** Squid代理服务器启用且处理If-None-Modified请求

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-10002是Squid HTTP代理服务器中的一个信息泄露漏洞，源于对If-None-Modified HTTP条件请求的响应处理不当。攻击者可以通过构造特定的HTTP请求，利用Squid缓存机制的缺陷，探测到其他客户端的Cookie数据。

**有效性分析：**
根据漏洞描述，搜索引擎结果和漏洞利用代码，该漏洞的PoC利用代码展示了两种不同的利用方式，一种是利用Swagger UI加载恶意Swagger定义文件（exploit.yaml）触发XSS漏洞，另一种是利用SSRF加载远程YAML文件(ssrf.json)。结合漏洞描述，此PoC能够用于验证漏洞的存在。

**投毒风险分析：**
查看PoC代码，`exploit.yaml`试图通过Swagger UI触发XSS，而`ssrf.json`尝试通过SSRF漏洞与外部服务器进行通信。虽然这些PoC本身是有效的利用手段，但它们也可能被用于投毒。特别是，如果攻击者能够控制`exploit.yaml`的内容，他们可以注入恶意代码。由于PoC代码相对简单，未发现明显的恶意投毒代码，但存在利用SSRF漏洞与外部服务器通信的可能性，增加潜在的风险。
投毒风险评估：5%。主要是因为利用该漏洞可以加载任意的远程YAML文件，增加恶意利用的可能性，但是PoC本身功能较为简单，因此，风险评估较低。

**利用方式：**
该漏洞的利用方式主要有两种：
1.  **Cookie数据泄露：** 攻击者构造恶意的If-None-Modified HTTP请求，诱使Squid缓存其他用户的Cookie数据，从而窃取敏感信息。
2.  **XSS漏洞触发：** 通过Swagger UI加载恶意的Swagger定义文件触发XSS。
3.  **SSRF漏洞触发:** 通过加载远程的YAML文件,可能存在SSRF漏洞。

**项目地址:** [barteeees/SwaggerUI-CVE-2016-1000229](https://github.com/barteeees/SwaggerUI-CVE-2016-1000229)

**漏洞详情:** [CVE-2016-10002](https://nvd.nist.gov/vuln/detail/CVE-2016-10002)