## CVE-2024-38063 - Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2008 至 2022，详见漏洞库信息。

**利用条件:** 需要目标系统开启IPv6，攻击者需要能够发送IPv6数据包到目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38063 是一个Windows TCP/IP协议栈中的远程代码执行漏洞，CVSS评分为9.8，属于危急漏洞。攻击者可以通过发送特制的IPv6数据包利用此漏洞，实现在目标系统上执行任意代码。漏洞存在于IPv6数据包解析过程中，可能涉及整数下溢等问题。从搜索结果和POC代码来看，该漏洞利用的有效性较高，多个来源都证实了其存在和利用的可能性。

**利用方式:**

1.  **发送恶意IPv6数据包：** 攻击者构造包含特定字段的IPv6数据包，例如使用IPv6扩展头和分片头。该数据包通过网络发送到目标系统。
2.  **触发漏洞：** 目标系统在处理该恶意IPv6数据包时，由于整数下溢等缺陷，导致内存破坏。
3.  **远程代码执行：** 攻击者通过控制内存，最终实现远程代码执行。具体执行的代码可能需要更进一步的漏洞利用技术。

**关于投毒风险:**

POC代码本身是用来验证漏洞的，主要功能是发送构造好的恶意数据包。但是代码中`hlim=64+i` 这种对TTL的修改，可能导致中间网络设备出现异常或者拒绝转发。此外，poc中发送大量的ipv6分片数据包也可能被防火墙检测到并拦截，或者导致网络拥塞。从README文件和代码本身来看，没有发现明显的恶意代码，但始终要对来源不明的代码保持警惕。因此，我给出的投毒风险评估是10%。

**项目地址:** [Sachinart/CVE-2024-38063-poc](https://github.com/Sachinart/CVE-2024-38063-poc)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)