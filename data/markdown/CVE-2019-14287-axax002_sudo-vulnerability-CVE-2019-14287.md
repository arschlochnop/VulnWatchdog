## CVE-2019-14287-Sudo权限提升

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许普通用户以root权限执行命令

**影响版本:** 1.8.28之前

**利用条件:** 需要用户具有Runas ALL sudoer权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-14287漏洞允许拥有Runas ALL权限的sudoer账户，通过指定用户ID为-1（或者等价的0xffffffff）来绕过安全策略的限制，包括`!root`配置和session PAM模块。PoC代码通过`sudo -u#-1 whoami`来验证漏洞，如果返回`root`，则表示漏洞存在。利用方式是使用`sudo -u#-1 /bin/bash`来获得root权限的shell。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是存在的，并且PoC代码中提供的方法是有效的利用方式。PoC通过检查sudo版本并尝试执行`whoami`命令来验证漏洞是否存在，如果成功，则执行`bash`以提升权限。

**投毒风险：**
浏览提供的PoC代码，没有发现明显的投毒代码。该代码的功能较为直接，用于检测并利用CVE-2019-14287漏洞。代码主要功能包括：

1.  打印banner信息
2.  检查sudo版本是否在受影响范围内。
3.  尝试利用漏洞，如果返回root，则成功利用。
4.  如果漏洞存在且利用成功，则注入payload启动root shell。

所有操作都与漏洞利用直接相关，未发现任何隐藏的恶意行为。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有在sudoers文件中被配置为`Runas ALL`的账户权限。这意味着该账户可以使用sudo命令以任何用户的身份运行命令。
2.  **绕过限制：** 利用漏洞，通过指定`-u#-1`或`-u#4294967295`来尝试绕过`!root`的配置限制，以及一些PAM模块。
3.  **执行命令：** 成功绕过限制后，可以以root权限执行任意命令。PoC中使用了`sudo -u#-1 /bin/bash`直接获取root shell。

总的来说，该漏洞利用的有效性较高，且PoC代码没有明显的投毒风险。

**项目地址:** [axax002/sudo-vulnerability-CVE-2019-14287](https://github.com/axax002/sudo-vulnerability-CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)