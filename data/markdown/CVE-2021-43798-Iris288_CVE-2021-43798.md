## CVE-2021-43798-Grafana-目录遍历

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 8.0.0, < 8.0.7; >= 8.1.0, < 8.1.8; >= 8.2.0, < 8.2.7; = 8.3.0

**利用条件:** 需要网络访问，目标Grafana实例存在受影响的版本且安装了插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-43798是Grafana中的一个目录遍历漏洞。根据漏洞信息和提供的PoC代码，该漏洞存在于Grafana的插件路径`/public/plugins//`中，攻击者可以通过构造包含`../`的payload，绕过目录限制，读取服务器上的任意文件。 

**有效性：**
PoC代码描述了如何使用Burp Suite进行漏洞利用。通过发送GET请求到`/public/plugins//`，并在路径中包含目录遍历的payload（例如`../../../../../../../../etc/passwd`），即可读取`/etc/passwd`文件。搜索引擎结果中vulncheck.com的博客也提到了该漏洞的利用。

**投毒风险：**
提供的漏洞利用代码`/tmp/0a318d4df3c80b7301d5a9d750da597a/README.md`仅包含漏洞描述和利用方法说明，没有发现任何可疑的、与漏洞利用无关的代码，因此不存在投毒风险。

**利用方式：**
1.  确定目标Grafana实例的版本在受影响范围内（8.0.0-beta1 to 8.3.0，但不包括已修补的版本）。
2.  找到目标Grafana实例上已安装的插件ID（例如`alertlist`）。
3.  构造包含目录遍历payload的URL，例如：
    ```
    /public/plugins/<plugin_id>/../../../../../../../../etc/passwd
    ```
4.  发送GET请求到构造的URL。如果漏洞存在，服务器将返回`/etc/passwd`文件的内容。

**总结:**
此漏洞利用方式简单，危害性高，可直接读取服务器敏感文件，但影响范围仅限于未修复版本的Grafana实例，且需要已知插件ID。提供的PoC代码仅包含利用说明，不存在投毒风险。

**项目地址:** [Iris288/CVE-2021-43798](https://github.com/Iris288/CVE-2021-43798)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)