## CVE-2020-26258-XStream-SSRF

**漏洞编号:** CVE-2020-26258

**漏洞类型:** SSRF (Server-Side Request Forgery)

**影响应用:** XStream

**危害等级:** 中危，可能导致内部信息泄露或利用内部服务进行攻击

**影响版本:** < 1.4.15

**利用条件:** 目标系统使用XStream < 1.4.15，且允许反序列化不受信任的XML数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-26258是XStream库中的一个SSRF漏洞。由于XStream在1.4.15之前的版本中，默认的黑名单机制存在缺陷，攻击者可以通过构造恶意的XML数据，利用`javax.activation.URLDataSource`类发起SSRF攻击。  

**漏洞利用方式：**
1.  攻击者构造包含恶意`URLDataSource`的XML数据。
2.  应用程序使用存在漏洞的XStream版本反序列化该XML数据。
3.  XStream尝试从XML中指定的URL加载数据，从而触发SSRF。攻击者可以利用这一点访问内部服务或资源。

**有效性：**
提供的POC代码是有效的，因为它展示了如何构造恶意的XML，利用`javax.activation.URLDataSource`发起SSRF请求。该POC使用dnslog.cn来验证SSRF是否成功。

**投毒风险：**
仓库中没有明显的投毒代码。`pom.xml`文件指定了XStream 1.4.14版本，这是一个已知的易受攻击的版本，符合漏洞描述。`CVE_2020_26258.java` 文件包含SSRF的POC,作者没有在示例代码中添加恶意代码,因此投毒风险为0。

**总结：**
该漏洞的利用依赖于XStream库反序列化XML数据。如果应用程序允许反序列化不受信任的XML数据，则攻击者可以利用此漏洞发起SSRF攻击。

**项目地址:** [Al1ex/CVE-2020-26258](https://github.com/Al1ex/CVE-2020-26258)

**漏洞详情:** [CVE-2020-26258](https://nvd.nist.gov/vuln/detail/CVE-2020-26258)