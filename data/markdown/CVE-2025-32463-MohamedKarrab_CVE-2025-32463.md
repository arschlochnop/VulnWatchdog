## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取Root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，目标系统Sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463是一个存在于Sudo 1.9.14到1.9.17版本（不包括1.9.17p1）中的本地权限提升漏洞。该漏洞允许本地用户通过`--chroot`选项利用用户控制的`/etc/nsswitch.conf`文件获取root权限。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞的POC代码是有效的。多个来源（如NVD, Wiz.io, ZeroPath等）都确认了该漏洞的存在，并且提供了利用方法。

提供的POC代码的`README.md`文件说明了利用过程，并声称无需gcc即可利用该漏洞。`get_root.py`脚本通过检测目标架构并选择对应的预编译payload来完成提权。

**投毒风险分析：**

*   **LICENSE文件：** 正常的MIT许可，无异常。
*   **README.md文件：** 提供了漏洞描述、影响版本、利用方法和免责声明，未发现可疑代码或恶意链接。
*   **get_root.py文件：**
    *   脚本首先检测目标系统的架构 (`detect_arch()` 函数)。
    *   然后，脚本尝试从预编译的payload目录 (`archs-dynamic` 和 `archs-static`) 中加载与目标架构匹配的base64编码的payload。
    *   如果找到payload，脚本会在临时目录中创建一些文件和目录，包括`king/etc/nsswitch.conf`，`libnss_/king.so.2`。其中`king.so.2`是base64解码后的payload。
    *   `nsswitch.conf` 配置 `passwd: /king`， 意味着当sudo需要解析用户密码的时候，就会尝试从`/king`（也就是chroot后的根目录下的king文件）去查找用户信息。
    *   最后，脚本使用`sudo -R king king`命令启动sudo，其中`-R king`指定了chroot根目录为king目录。
    *   脚本执行完毕后，会清理临时目录。

该POC的主要风险在于，它依赖于预编译的payload。虽然脚本尝试选择与目标架构匹配的payload，但这些payload的安全性依赖于开发者。如果开发者在payload中植入恶意代码，就可能存在投毒风险。
`get_root.py`中未发现明显的投毒代码，但payload本身可能被篡改。另外，`get_root.py`创建的目录和文件可能包含不希望存在的副作用，所以有一定的投毒风险。

综合考虑，投毒风险估计为10%。

**漏洞利用方式：**

1.  攻击者克隆包含漏洞利用代码的git仓库。
2.  运行`get_root.sh`或者`get_root.py`脚本。
3.  脚本会自动检测目标系统的架构，并尝试选择相应的预编译payload。
4.  脚本会在临时目录中创建必要的文件和目录，包括修改后的`/etc/nsswitch.conf`文件。
5.  脚本使用`sudo -R king king`命令启动sudo，利用chroot和修改后的nsswitch配置，执行payload，最终获取root权限。

**项目地址:** [MohamedKarrab/CVE-2025-32463](https://github.com/MohamedKarrab/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)