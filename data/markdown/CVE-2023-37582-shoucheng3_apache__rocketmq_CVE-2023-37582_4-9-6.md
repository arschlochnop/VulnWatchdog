## CVE-2023-37582-Apache RocketMQ-远程命令执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程命令执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露在公网且缺乏权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中的一个远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以在 NameServer 地址泄露且缺乏权限验证的情况下，利用 update configuration 功能执行任意命令，从而控制服务器。漏洞影响版本包括 RocketMQ 5.0.0 到 5.1.1 以及 4.9.6 及更早版本。

**有效性：**
根据漏洞描述和搜索结果，此漏洞利用代码通过更新 NameServer 的配置来执行命令，因此，如果满足 NameServer 地址泄露且缺乏权限验证这两个条件，那么漏洞利用是有效的。

**投毒风险：**
提供的“漏洞利用代码”实际上是RocketMQ的构建说明，贡献指南，许可证，并非真正的漏洞利用payload。代码中并没有发现明显的恶意代码或后门，因此投毒风险较低,为0%。

**利用方式：**
1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的公网地址。
2.  **绕过权限验证：**  确定目标 NameServer 没有进行适当的权限验证。
3.  **利用 update configuration 功能：**  构造恶意的配置更新请求，其中包含要执行的系统命令。此命令将以运行 RocketMQ 的系统用户身份执行。
4.  **执行任意命令：**  成功利用漏洞后，攻击者可以执行任何系统命令，从而完全控制服务器。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)