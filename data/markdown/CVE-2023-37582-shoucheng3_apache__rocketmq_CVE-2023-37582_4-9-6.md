## CVE-2023-37582-Apache RocketMQ-远程代码执行

**漏洞编号:** CVE-2023-37582

**漏洞类型:** 远程代码执行

**影响应用:** Apache RocketMQ

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 5.0.0 <= version <= 5.1.1, version <= 4.9.6

**利用条件:** NameServer地址泄露到外网且缺少权限验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-37582 是 Apache RocketMQ NameServer 组件中存在的远程命令执行漏洞。由于 CVE-2023-33246 的修复不完整，攻击者可以通过 NameServer 的更新配置功能执行命令。漏洞利用需要 NameServer 地址泄露到外网，并且缺少权限验证。漏洞利用代码中仅包含构建和贡献相关的说明文件，没有直接的exp代码，但根据漏洞描述，攻击者可以通过发送恶意配置更新请求来执行任意命令。尽管代码仓库本身不包含直接的利用代码，但存在一定投毒风险，例如通过贡献代码的方式植入恶意逻辑。评估投毒风险较低(5%)，因为项目有贡献指南，committer会对代码进行审核。

**利用方式：**

1.  **发现 NameServer 地址：** 攻击者需要首先获取 NameServer 的地址，这可能通过信息泄露等方式实现。
2.  **绕过权限验证：** 漏洞存在的前提是 NameServer 缺少适当的权限验证。
3.  **发送恶意配置更新请求：** 攻击者构造包含恶意命令的配置更新请求，发送到 NameServer。
4.  **执行命令：** NameServer 在处理配置更新请求时，会执行攻击者注入的命令，从而导致远程代码执行。

**有效性评估：**

根据漏洞描述和搜索引擎结果，此漏洞利用是有效的。漏洞利用代码本身不包含exp，需要自行构造恶意配置更新请求，具有一定门槛。

**项目地址:** [shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6](https://github.com/shoucheng3/apache__rocketmq_CVE-2023-37582_4-9-6)

**漏洞详情:** [CVE-2023-37582](https://nvd.nist.gov/vuln/detail/CVE-2023-37582)