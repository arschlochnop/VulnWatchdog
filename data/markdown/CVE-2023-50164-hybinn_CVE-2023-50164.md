## CVE-2023-50164 Apache Struts 文件上传目录遍历漏洞

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 文件上传目录遍历

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32 和 6.0.0 <= version <= 6.3.0.1

**利用条件:** 应用程序使用受影响版本的Apache Struts，且存在文件上传功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 框架中的一个文件上传漏洞，允许攻击者通过操纵文件上传参数实现目录遍历。在特定情况下，这可能导致上传恶意文件，进而执行远程代码。

**有效性：**
根据漏洞库信息和通常的文件上传漏洞利用方式，攻击者可以通过修改上传文件的路径参数（例如，文件名或路径字段）来突破文件上传的限制，将文件上传到服务器上的任意位置。如果上传的文件是可执行文件（例如，JSP、Servlet等），攻击者可以通过访问该文件来执行恶意代码，从而实现远程代码执行。
提供的POC代码`/tmp/51e0f4d2bf9d641c1230687a807c0d75/README.md`仅仅包含 `# CVE-2023-50164`，表明只是漏洞声明，没有实际利用代码. 因此，需要构造专门的请求来利用此漏洞。目前给出的代码无法验证漏洞。

**投毒风险：**
提供的POC代码仅为一个 README.md 文件，内容仅包含漏洞编号，没有包含任何可执行代码。因此投毒风险较低，可以认为几乎不存在投毒代码。 但不能排除该仓库的作者在其他分支或后续提交中添加恶意代码的可能性。因此将投毒风险设置为10%。

**利用方式：**
1.  攻击者构造包含目录遍历payload的文件上传请求。Payload 通常会修改文件上传路径参数，例如使用 `../../` 这样的序列来跳出预定的上传目录。
2.  Struts框架在处理文件上传请求时，如果未对文件路径进行充分验证和清理，会将文件上传到攻击者指定的目录。
3.  攻击者上传包含恶意代码的文件（例如，JSP脚本），并将其上传到Web服务器的可执行目录下。
4.  攻击者通过Web浏览器访问上传的恶意文件，触发恶意代码的执行，从而实现远程代码执行。

**项目地址:** [hybinn/CVE-2023-50164](https://github.com/hybinn/CVE-2023-50164)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)