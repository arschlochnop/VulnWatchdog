## CVE-2023-4357 Google Chrome XML 外部实体注入 (XXE)

**漏洞编号:** CVE-2023-4357

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** Google Chrome

**危害等级:** 中危，可能导致文件读取

**影响版本:** < 116.0.5845.96

**利用条件:** 需要用户打开恶意的HTML页面或者SVG文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-4357 是一个 Google Chrome 浏览器中的 XML 外部实体注入漏洞。该漏洞是由于 Chrome 在处理 XML 时对用户提供的输入验证不足，导致攻击者可以通过构造恶意的 XML 文件来读取本地文件，绕过文件访问限制。

**有效性评估：**

提供的PoC 代码看起来是有效的，实现了任意文件读取。它使用 SVG 文件嵌入 XSL 样式表，XSL 样式表包含 XML 外部实体定义，用于读取服务器上的文件。server.js 文件提供了静态文件的 HTTP 服务，模拟了漏洞利用场景。 

**利用方式分析：**

1.  攻击者需要创建一个恶意的 SVG 文件（例如 `test.svg`）。该 SVG 文件通过 `<?xml-stylesheet type="text/xsl" href="#"?>`  引用内联的 XSL 样式表。
2.  内联的 XSL 样式表会加载外部的 XSL 文件 (虽然test.svg中`document('test.xsl')`加载本地的test.xsl,但攻击者可修改为远程的)。
3.  恶意 XSL 文件（例如 `test.xsl`）定义了 XML 实体，指向想要读取的本地文件，如 `/etc/passwd`、`/etc/hosts` 和 `/etc/group`。
4.  当 Chrome 浏览器解析该 SVG 文件时，会加载并执行 XSL 样式表，XSL 样式表会尝试解析 XML 实体，从而导致 Chrome 浏览器读取本地文件。
5.  读取的文件内容会嵌入到 SVG 文件中，攻击者可以查看 SVG 文件来获取文件内容。

**投毒风险分析：**

该仓库主要目的是演示漏洞利用，PoC 本身是为了利用漏洞读取文件。但仍然存在一定的投毒风险，具体如下：

1.  **文件内容审查：** 仔细检查了 server.js，test.svg 和 test.xsl 文件，没有发现直接的恶意代码，如反弹 shell 等。
2.  **间接风险：** 如果攻击者修改了 test.xsl 文件，使其尝试读取系统中的敏感文件，可能会泄露用户的隐私数据。
3.  **网络风险：**  虽然 server.js 只是一个简单的 HTTP 服务器，但如果用户部署到公网环境，可能会被其他人利用，从而造成安全风险。
4.  **依赖风险:** `server.js` 使用了 `express` 库，需要检查 `express` 库是否存在已知的安全漏洞。

综合评估，该仓库中存在作者隐藏的恶意代码的风险较低，估计为 10%。主要的风险在于用户在使用该 PoC 时可能存在的误用或配置不当，导致暴露敏感信息。


**项目地址:** [WinnieZy/CVE-2023-4357](https://github.com/WinnieZy/CVE-2023-4357)

**漏洞详情:** [CVE-2023-4357](https://nvd.nist.gov/vuln/detail/CVE-2023-4357)