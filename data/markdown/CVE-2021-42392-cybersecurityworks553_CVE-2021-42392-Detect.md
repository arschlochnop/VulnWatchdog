## CVE-2021-42392 - H2 Database Console RCE

**漏洞编号:** CVE-2021-42392

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** H2 Database Console

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 1.1.000

**利用条件:** H2数据库使用Web Console并允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-42392 漏洞存在于 H2 数据库的 Web Console 中。攻击者可以利用 JNDI 注入，通过提供恶意的 JNDI 驱动程序名称和 URL，指向 LDAP 或 RMI 服务器，从而执行任意代码。利用方式类似于 Log4Shell 漏洞。从搜索结果和漏洞库信息来看，该漏洞影响启用了 Web Console 并允许远程连接的 H2 数据库。提供的漏洞利用代码 `h2_detect_v0.3.4.py` 是一个检测脚本，用于扫描指定 IP 地址是否存在 H2 Console，以及是否允许远程连接。如果检测到目标存在漏洞，会输出 `h2 Console detected on {r1.url}, further validation is required.`。它本身不包含直接利用漏洞的代码，而是用于辅助漏洞的发现。`README.md` 提供了脚本的使用说明。投毒风险评估：`h2_detect_v0.3.4.py`脚本的功能较为简单，主要作用是探测H2控制台，且代码量不大，通读代码后发现恶意代码可能性较低,代码中虽然存在文件读写操作，但仅仅是将检测到的URL写入文件中，正常使用不会造成危害。但是依然不能排除作者隐藏的风险,因此投毒风险评估为5%。利用方式总结：
1.  目标系统运行启用了 Web Console 的 H2 数据库。
2.  Web Console 允许远程连接。
3.  攻击者通过构造包含恶意 JNDI URL 的请求发送到 H2 Console。
4.  H2 数据库尝试连接到攻击者控制的 LDAP 或 RMI 服务器。
5.  攻击者在 LDAP 或 RMI 服务器上提供恶意代码，H2 数据库加载并执行该代码，最终导致远程代码执行。

**项目地址:** [cybersecurityworks553/CVE-2021-42392-Detect](https://github.com/cybersecurityworks553/CVE-2021-42392-Detect)

**漏洞详情:** [CVE-2021-42392](https://nvd.nist.gov/vuln/detail/CVE-2021-42392)