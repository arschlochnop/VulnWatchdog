## CVE-2025-48828-vBulletin-RCE

**漏洞编号:** CVE-2025-48828

**漏洞类型:** 远程代码执行

**影响应用:** vBulletin

**危害等级:** 高危，允许未授权的远程代码执行

**影响版本:** 6.0.3

**利用条件:** 目标vBulletin实例必须运行易受攻击的版本，且可以通过HTTP(S)访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48828 允许攻击者通过滥用vBulletin模板引擎中的模板条件来执行任意PHP代码。漏洞利用方法是构造一个包含恶意PHP代码（例如使用`var_dump`或其他函数调用语法）的模板，绕过安全检查并执行代码。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此漏洞利用**有效**。搜索引擎结果表明该漏洞已被积极利用。提供的漏洞利用代码 (scanner.py) 实现了自动化漏洞检测和利用，通过发送特制的HTTP请求到 `ajax/api/ad/replaceAdTemplate` 路由来设置模板，然后通过 `ajax/render/ad_rce` 路由执行命令。

**投毒风险：**
提供的代码主要功能是扫描和利用漏洞，但仍然存在一些潜在的投毒风险，虽然风险较低：
*   **依赖风险:** `scanner.py` 依赖 `requests` 库，虽然是常用库，但存在被供应链攻击的风险。
*   **默认配置风险:** 代码包含一些可配置的参数，如 `COMMAND`，`EXPECTED_OUTPUT`，和线程数。如果用户不小心使用了危险的命令或者配置了过高的线程数可能会带来风险。
*   **异常处理:** 脚本中的异常处理部分比较简单，可能无法捕获所有潜在的错误，这可能会导致脚本在某些情况下崩溃或产生不可预料的行为。

因此，综合评估投毒风险为 10%。

**利用方式：**
1.  **目标确定：** 通过 targets.txt 文件指定要扫描的目标 vBulletin 站点 URL。
2.  **模板设置：**  利用 `ajax/api/ad/replaceAdTemplate` 路由，发送包含恶意 PHP 代码的 POST 请求来设置模板。
    *   Payload 包含 `routestring`，`styleid`，`location` 和 `template` 字段。
    *   `template` 字段包含一个 `vb:if` 条件，其中利用 `passthru` 函数执行 POST 请求中 `cmd` 参数指定的命令。
3.  **命令执行：** 利用 `ajax/render/ad_rce` 路由，通过发送包含要执行命令的 POST 请求，触发恶意代码。
    *   Payload 包含 `routestring` 和 `cmd` 字段。
    *   `passthru` 函数执行 `cmd` 参数指定的命令，并将结果返回。
4.  **结果验证：** 通过检查响应中是否包含预期的输出 (`uid=`) 来确认漏洞是否成功利用。
5.  **结果记录：** 将成功利用漏洞的目标 URL 和命令执行结果记录到 vuln.txt 文件中。

**项目地址:** [ill-deed/vBulletin-CVE-2025-48828-Multi-target](https://github.com/ill-deed/vBulletin-CVE-2025-48828-Multi-target)

**漏洞详情:** [CVE-2025-48828](https://nvd.nist.gov/vuln/detail/CVE-2025-48828)