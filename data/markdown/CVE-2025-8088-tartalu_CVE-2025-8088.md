## CVE-2025-8088-WinRAR-路径遍历

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是 WinRAR Windows 版本中的一个路径遍历漏洞。攻击者可以制作恶意的 RAR 压缩包，将可执行文件放置到包括 Windows 启动文件夹在内的敏感目录中，从而实现任意代码执行。

**有效性：**
提供的 Python 脚本 `CVE-2025-8088.py` 旨在利用此漏洞。它通过以下步骤工作：

1.  **生成Payload：** 创建一个批处理文件 `payload.bat`，该文件在启动时执行 `notepad.exe`。 
2.  **生成诱饵文件：** 创建多个文本文件，并计算深度，使用相对路径名来尝试将 `payload.bat` 放入启动目录。
3.  **构建恶意压缩包：** 脚本创建RAR文件，写入多个具有目录遍历的伪造路径和诱饵文件

根据漏洞库信息和搜索引擎结果，此漏洞已被在野利用，因此该 POC 脚本大概率是有效的。

**投毒风险：**
脚本 `CVE-2025-8088.py` 主要功能是生成恶意RAR文件。存在轻微的投毒风险。脚本会从`http://176.65.132.63/cache_register.exe`下载并执行一个exe文件，虽然之后会删除，如果该地址被篡改或exe被替换，则会存在潜在的风险。因此该压缩包存在一定的风险，建议谨慎使用。
config.py 文件中指定的 `PAYLOAD` 是 `@echo off\nstart /B C:\Users\Public\file.exe\n`。如果用户直接使用此配置，则会尝试执行 `C:\Users\Public\file.exe`，而这个文件可能是恶意的，但这不是脚本作者投毒，而是用户自定义配置问题。整体的投毒风险较低。

**利用方式：**
1.  攻击者创建一个恶意的RAR压缩包，其中包含利用路径遍历漏洞的文件。
2.  诱骗受害者解压此RAR压缩包（例如，通过社会工程学）。
3.  当 WinRAR 解压文件时，由于路径遍历漏洞，恶意文件会被放置到指定的启动目录下。
4.  下次系统启动时，恶意程序会自动执行，从而导致任意代码执行。

**项目地址:** [tartalu/CVE-2025-8088](https://github.com/tartalu/CVE-2025-8088)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)