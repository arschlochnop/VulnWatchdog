## CVE-2025-44998-TinyFileManager-存储型XSS

**漏洞编号:** CVE-2025-44998

**漏洞类型:** 存储型XSS

**影响应用:** TinyFileManager

**危害等级:** 中危，可能导致会话劫持，结合CVE-2022-40916可能导致任意用户登录

**影响版本:** v2.4.7

**利用条件:** 需要访问 TinyFileManager 的设置页面，并具有修改配置的权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-44998是TinyFileManager v2.4.7的`/tinyfilemanager.php`组件中的一个存储型跨站脚本（XSS）漏洞。攻击者可以通过将精心制作的payload注入到`js-theme-3`参数中来执行任意JavaScript或HTML代码。POC表明，该漏洞允许攻击者注入恶意脚本，这些脚本在包括登录屏幕在内的整个页面上执行。由于`filemanager` cookie缺少httpOnly标志，使得会话容易被劫持。此外，结合先前报告的会话固定漏洞(CVE-2022-40916)，攻击者可以使用固定的'filemanager' cookie值登录任何用户。 

**利用方式：**
1. 访问TinyFileManager的设置页面（`index.php?p=&settings=1`）。
2. 修改`js-theme-3`参数的值为`light“></nav><img+src=x+onerror=alert(document.cookie)><nav+a=”`。
3. 恶意脚本将在页面加载时执行，例如显示cookie。

**投毒风险分析：**
虽然提供的POC本身旨在演示漏洞，但仓库中存在投毒代码的风险较低（约10%）。风险主要来自以下几个方面：

1.  **图片资源：** POC中使用了本地图片（`./assets/1.png`, `./assets/2.png`, `./assets/3.png`, `./assets/4.png`, `./assets/5.png`），如果这些图片被替换为包含恶意代码的图片（例如，包含XSS payload的SVG），则可能存在风险。但可能性较低，因为这需要攻击者能够修改仓库内容。
2.  **README.md 恶意链接：** README.md 中可能包含恶意链接,用户点击后可能跳转到恶意网站或者下载恶意文件。但是从描述来看，这种情况概率较低。

总的来说，该仓库的主要风险在于漏洞本身，而非隐藏的恶意代码。

**项目地址:** [l8BL/CVE-2025-44998](https://github.com/l8BL/CVE-2025-44998)

**漏洞详情:** [CVE-2025-44998](https://nvd.nist.gov/vuln/detail/CVE-2025-44998)