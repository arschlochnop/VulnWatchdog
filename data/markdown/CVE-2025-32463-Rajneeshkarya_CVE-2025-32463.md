## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户，存在漏洞版本的Sudo

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 中的一个本地提权漏洞。攻击者可以利用 `--chroot` 选项，结合用户可控目录中的 `/etc/nsswitch.conf` 文件，加载恶意的共享对象，从而获得 root 权限。

**有效性分析：**

从漏洞库信息和搜索引擎结果来看，该漏洞被认为是高危的，并且存在可利用的 POC 代码。给定的 POC 代码利用了 Sudo 的 `--chroot` 选项，通过构造恶意的 `nsswitch.conf` 文件和共享对象，欺骗 Sudo 加载恶意代码，从而提升权限到 root。

**利用方式：**

1.  **创建临时目录：** 脚本首先创建一个临时目录作为工作目录。
2.  **构造恶意共享对象：** 创建包含 `woot` 函数（构造函数）的 C 源代码 `exploit1337.c`。该函数设置进程的 UID 和 GID 为 0 (root)，然后执行 `/bin/bash`。
3.  **创建伪造的 NSS 配置：** 创建 `fake_root/etc` 目录，并在其中创建 `nsswitch.conf` 文件，将 `passwd` 数据库的查找指向 `/exploit1337` (实际上是恶意的共享对象)。同时复制 `/etc/group` 到 `fake_root/etc/` 以满足 Sudo 的需求。
4.  **编译恶意共享对象：** 使用 `gcc` 将 `exploit1337.c` 编译成共享对象 `libnss_/exploit1337.so.2`。`-Wl,-init,woot` 选项指定 `woot` 函数作为初始化函数，在共享对象加载时执行。
5.  **执行 Sudo 命令：** 使用 `sudo -R fake_root fake_root` 命令，指示 Sudo 使用 `fake_root` 作为 chroot 根目录，从而加载恶意共享对象。
6.  **清理：** 删除临时目录。

**投毒风险分析：**

该仓库的主要风险是：

1.  **过度清理：** 虽然脚本尝试清理临时文件，但仍然可能留下痕迹。攻击者可能修改清理过程，留下后门。
2.  **依赖外部组件：** 脚本依赖于 `gcc` 和 `sudo`。如果目标系统上的这些工具被篡改，可能会导致漏洞利用失败或者执行恶意代码。
3.  **修改后的利用脚本：** 脚本注释说明`Modified by Rajneesh Arya`，意味着代码可能被修改，其中修改的部分存在潜在的恶意行为的可能性,需要审计修改内容。

综合考虑，存在少量投毒的可能性。代码相对简单直接，主要依赖于漏洞本身。风险主要来自潜在的修改和环境依赖性。因此，判定投毒风险为 10%。主要是考虑到利用脚本修改者引入恶意代码的可能性。需要代码审计进行确认。

**项目地址:** [Rajneeshkarya/CVE-2025-32463](https://github.com/Rajneeshkarya/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)