## CVE-2020-0610 Windows Remote Desktop Gateway (RD Gateway) 远程代码执行漏洞

**漏洞编号:** CVE-2020-0610

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Gateway (RD Gateway)

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Windows Server 2012, 2012 R2, 2016, 2019

**利用条件:** RD Gateway角色已启用，UDP传输已启用，防火墙允许UDP/3391端口流量

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0610 是 Windows 远程桌面网关 (RD Gateway) 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的 UDP 数据包来利用此漏洞，从而在系统上执行任意代码。根据漏洞利用代码，该PoC利用的是DTLS握手过程中的漏洞，通过发送一个非常小的分片来触发漏洞。该PoC仓库提供了一个完整的可复现的实验环境，包括配置RD Gateway、启用UDP传输、配置防火墙的脚本，以及使用Nuclei扫描器进行漏洞测试的说明。

**有效性:**
根据漏洞信息和漏洞利用代码，此漏洞利用的有效性较高，因为该漏洞存在于多个版本的Windows Server中，并且有公开的PoC代码可供利用。搜索引擎结果中也包含了漏洞的详细信息和缓解措施。

**投毒风险:**
虽然提供的PoC代码主要是为了验证漏洞是否存在，但我仍然认为存在一定的投毒风险。具体来说，脚本中可能包含隐藏的恶意命令，例如在add-udp-3391-firewall.ps1或sanity-check.ps1脚本中。即使这些脚本的目的是为了配置环境，但攻击者可以在其中插入恶意代码，以便在受害者执行这些脚本时执行恶意操作。Nuclei模板本身也可能存在恶意行为。
该仓库的投毒风险大概为10%，因为大部分步骤都是围绕官方软件的配置展开，且提供了明确的验证方式，但是由于存在自定义脚本以及Nuclei模板，仍然存在一定的风险。

**利用方式:**
1.  配置目标系统：安装RD Gateway角色，启用UDP传输，并配置防火墙以允许UDP/3391端口的流量。
2.  使用Nuclei扫描器：使用提供的Nuclei模板向目标系统发送特制的UDP数据包。
3.  远程代码执行：如果目标系统存在漏洞，攻击者可以利用此漏洞在系统上执行任意代码。

**项目地址:** [ImBIOS/lab-cve-2020-0610](https://github.com/ImBIOS/lab-cve-2020-0610)

**漏洞详情:** [CVE-2020-0610](https://nvd.nist.gov/vuln/detail/CVE-2020-0610)