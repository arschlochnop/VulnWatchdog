## CVE-2018-9995 - TBK DVR 身份验证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份验证绕过

**影响应用:** TBK DVR4104, DVR4216 及其他重新命名的版本 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，可能导致未授权访问和控制DVR设备

**影响版本:** 受影响版本未知，可能影响TBK DVR4104和DVR4216系列及其重新命名的版本

**利用条件:** 需要网络访问目标DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-9995 漏洞允许远程攻击者通过设置 `Cookie: uid=admin` 头来绕过身份验证。 攻击者发送包含此Cookie头的HTTP请求，例如 `device.rsp?opt=user&cmd=list`，即可获得管理员权限，从而访问受保护的资源或执行未授权的操作。 

**有效性:** 根据漏洞库信息和Exploit-DB链接，此漏洞存在并且有可用的利用代码（Exploit-DB 44577）。 

**投毒风险:** 提供的代码段是GNU GPL许可协议，并非漏洞利用代码本身。 因此，无法直接分析其是否存在投毒代码。 但是，如果从不可信的来源下载利用脚本，始终存在投毒风险。根据经验判断，LICENSE文件通常不包含可执行代码，投毒风险较低。

**利用方式:**

1.  攻击者构造一个HTTP请求，并在请求头中设置 `Cookie: uid=admin`。
2.  将此请求发送到目标DVR设备，例如请求`device.rsp?opt=user&cmd=list`或其他需要身份验证的资源。
3.  如果DVR设备存在漏洞，则攻击者将绕过身份验证，并以管理员权限访问资源或执行操作。

**项目地址:** [ABIZCHI/CVE-2018-9995_dvr_credentials](https://github.com/ABIZCHI/CVE-2018-9995_dvr_credentials)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)