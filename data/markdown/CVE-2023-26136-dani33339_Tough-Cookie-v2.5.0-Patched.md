## CVE-2023-26136-tough-cookie-Prototype Pollution

**漏洞编号:** CVE-2023-26136

**漏洞类型:** Prototype Pollution

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致权限提升和拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要CookieJar使用rejectPublicSuffixes=false模式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响版本低于4.1.3。当CookieJar以`rejectPublicSuffixes=false`模式使用时，由于对Cookie处理不当，可能导致原型污染。具体来说，如果`cookie.domain`被设置为`__proto__`，攻击者可以修改`Object.prototype`，从而影响整个应用程序的行为。根据漏洞信息，该漏洞的CVSS评分为6.5，属于中危漏洞。搜索结果确认了漏洞的存在以及受影响的版本。提供的漏洞利用代码包括Dockerfile、LICENSE和README.md。README.md描述了漏洞和修复方案，以及安装patched版本的说明。Dockerfile用于构建包含易受攻击或修复后的tough-cookie版本的环境。LICENSE是MIT许可证。 

**有效性：**
根据README.md的描述，以及漏洞库信息和搜索结果，该漏洞确实存在并且可以被利用。

**投毒风险：**
检查提供的文件，主要风险点在于Dockerfile。虽然Dockerfile包含了一些常见的操作，例如安装vim和创建用户，但没有发现明显的恶意代码或后门。然而，`chmod -R a+w /usr/local/lib/node_modules`和`chmod -R a+w /usr/local/bin`这两条命令将给予所有用户对node_modules和/usr/local/bin的写权限，这可能被利用来安装恶意模块或者替换系统命令，从而实现投毒。LICENSE文件和README文件本身没有明显的投毒风险。因此，存在一定的投毒风险，但不是非常高，大概10%的风险。

**利用方式：**
利用方式是通过设置`cookie.domain`为`__proto__`来修改`Object.prototype`，进而影响使用tough-cookie的应用程序的行为。需要注意的是，利用需要应用程序配置`rejectPublicSuffixes=false`。攻击者可以通过发送包含特制Cookie的HTTP请求来触发该漏洞。攻击成功后，攻击者可以修改JavaScript对象的默认属性，从而导致权限提升、信息泄露或拒绝服务。

**项目地址:** [dani33339/Tough-Cookie-v2.5.0-Patched](https://github.com/dani33339/Tough-Cookie-v2.5.0-Patched)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)