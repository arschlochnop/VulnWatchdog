## CVE-2025-22056-Linux内核-nft_tunnel模块堆溢出

**漏洞编号:** CVE-2025-22056

**漏洞类型:** 堆溢出

**影响应用:** Linux内核

**危害等级:** 高危，可能导致内核崩溃或任意代码执行

**影响版本:** Linux kernel 5.7及以上版本，但低于修复版本

**利用条件:** 需要CAP_NET_ADMIN权限，允许创建netfilter规则

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22056是Linux内核netfilter子系统nft_tunnel模块中的一个堆溢出漏洞。该漏洞源于在处理多个NFTA_TUNNEL_KEY_OPTS_GENEVE属性时，解析逻辑在计算下一个geneve_opt结构体位置时存在类型转换错误，导致指针运算溢出，进而造成堆外写入。

**漏洞利用方式：**

1.  利用netfilter (nftables) 的接口，发送特制的NF_TABLES消息。
2.  创建包含多个NFTA_TUNNEL_KEY_OPTS_GENEVE属性的nft_tunnel对象。
3.  触发nft_tunnel_obj_init函数中的类型混淆加法，导致堆溢出。
4.  通过精心构造的payload，可覆盖相邻的堆对象，实现任意代码执行或内核崩溃。

根据提供的POC代码，它尝试创建 netfilter 表和规则，并且控制 geneve 选项来触发堆溢出。该POC代码看起来针对CVE-2025-22056，并尝试利用该漏洞。代码中包括创建netfilter表，规则，并发送包含Geneve选项的消息来触发漏洞。该利用方式与漏洞描述相符，有效性较高。

**投毒风险分析：**

虽然POC代码主要功能是利用漏洞，但仍存在一定的投毒风险。风险点在于作者可能在代码中插入恶意逻辑，例如：

*   **后门植入：** 在利用成功后，修改内核数据结构或文件，植入后门程序。
*   **权限提升：** 尝试通过溢出覆盖内核数据结构，获取root权限。
*   **拒绝服务：** 通过精心构造的溢出，导致内核崩溃，实现拒绝服务攻击。
*   **信息窃取：** 泄露敏感信息

代码使用了`unshare(CLONE_NEWUSER)`和`unshare(CLONE_NEWNET)`来创建新的用户和网络命名空间，这是一种常见的安全措施，用于限制漏洞利用的影响范围。代码中使用`sendmsg`发送精心构造的 netfilter 消息。这些消息包含用于触发漏洞的特定属性。虽然代码本身较为复杂，但主要目的是为了触发漏洞。因此，判定投毒的概率为10%。

**优先级排序:** 搜索引擎结果、漏洞利用代码和漏洞库信息都指向该漏洞的真实性和危害性，由于搜索结果包含更多来自不同来源的信息（NVD, RedHat, Wiz等），因此搜索引擎结果优先级最高，其次是直接的漏洞利用代码，最后是漏洞库信息，因为其内容已被其他信息源所涵盖。

**项目地址:** [henrymartin262/CVE-2025-22056-exploit](https://github.com/henrymartin262/CVE-2025-22056-exploit)

**漏洞详情:** [CVE-2025-22056](https://nvd.nist.gov/vuln/detail/CVE-2025-22056)