## CVE-2025-24813-Apache Tomcat-路径等价漏洞/反序列化

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价漏洞/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、信息泄露和恶意内容注入

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需满足以下条件之一：

1.  信息泄露/内容注入：writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, security sensitive files also being uploaded via partial PUT。
2.  远程代码执行：writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813是一个存在于Apache Tomcat中的路径等价漏洞，攻击者利用'file.Name'中的内部点，结合启用了写入的Default Servlet，可能导致远程代码执行、信息泄露或向上传文件中添加恶意内容。

**漏洞利用方式：**

此漏洞主要通过利用Tomcat的partial PUT特性和文件路径处理不当来实现。

1. **信息泄露/内容注入：** 攻击者首先需要Default Servlet开启了写入功能，并支持partial PUT。他们可以利用此漏洞上传恶意文件，或者修改已存在的文件内容，进行恶意内容注入，或者泄露安全敏感文件内容，需要利用精心构造的路径来实现攻击。例如，将恶意文件上传到公共目录的子目录下，利用Internal Dot来覆盖其他文件。

2. **远程代码执行：** 如果Tomcat启用了文件存储session，并且应用包含可被反序列化攻击的库，攻击者可以通过上传恶意的序列化文件，并覆盖Tomcat session文件，最终实现RCE。

**POC有效性分析：**

根据提供的POC代码，该脚本尝试通过PUT请求上传一个session文件，然后通过GET请求访问包含session ID的JSP页面。如果GET请求返回500错误，则认为目标存在漏洞，原因是上传的恶意session文件导致了反序列化异常。此方法可能可以验证漏洞的存在性，但需要目标环境满足特定的配置要求（例如，启用文件session存储并存在易受攻击的反序列化库）。搜索引擎结果也表明此漏洞在野外被积极利用。

**投毒风险分析：**

POC代码本身主要是漏洞验证，并无明显的恶意投毒行为。代码中使用了requests库进行HTTP请求，并根据响应状态码判断漏洞是否存在。 但是仍然存在一些风险：

*   **依赖风险：** 代码依赖于requests、pandas和colorama库，这些库可能存在安全漏洞，如果使用了被篡改的库，则可能引入安全风险。
*   **代码执行风险：** 虽然代码本身没有直接的恶意行为，但如果攻击者修改了代码，例如添加了反向shell等恶意逻辑，则可能实现远程代码执行。
*   **误报风险：** 如果目标服务器存在WAF或其他安全防护措施，可能会导致扫描结果出现误报。

综合考虑，此POC代码的投毒风险较低，大概为5%。主要风险在于对第三方库的依赖以及代码被篡改的可能性。

**项目地址:** [Mattb709/CVE-2025-24813-Scanner](https://github.com/Mattb709/CVE-2025-24813-Scanner)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)