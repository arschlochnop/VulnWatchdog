## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 6.x and 7.x

**利用条件:** 目标系统运行存在漏洞的MagnusBilling版本，且攻击者可以发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。未经身份验证的攻击者可以通过构造恶意的HTTP请求，利用`icepay.php`中的`democ`参数执行任意操作系统命令。提供的POC代码通过`requests`库发送带有恶意payload的GET请求，该payload尝试创建一个反向shell连接到攻击者的机器。由于POC代码逻辑较为简单，仅包含发送payload和接收反向shell，因此投毒风险极低。主要风险在于目标系统需要安装`netcat`，并且防火墙不能阻止反向shell的连接。漏洞利用方式为构造包含命令注入payload的HTTP GET请求，目标服务器未对用户输入进行充分过滤，导致系统执行恶意命令。

**项目地址:** [tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit](https://github.com/tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)