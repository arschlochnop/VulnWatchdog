## CVE-2024-25600 - WordPress Bricks Builder RCE

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Bricks Builder (WordPress plugin)

**危害等级:** 严重，可能导致服务器完全控制

**影响版本:** <= 1.9.6

**利用条件:** Bricks Builder插件版本<= 1.9.6，目标服务器可访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-25600 是 Bricks Builder WordPress 插件中的一个远程代码执行漏洞。该漏洞允许未经身份验证的攻击者注入并执行任意 PHP 代码。漏洞存在于插件处理用户输入的方式中，攻击者可以利用 `wp-json/bricks/v1/render_element` 端点发送特制的 POST 请求来执行任意代码。

**漏洞利用方式：**

1.  **获取 Nonce：** 利用代码首先尝试通过 GET 请求目标 URL，然后解析HTML，提取嵌入在 `<script id="bricks-scripts-js-extra">` 标签中的nonce 值。这个nonce用于绕过某些安全检查。
2.  **构造恶意请求：** 构造一个包含恶意 PHP 代码的 POST 请求，发送到 `wp-json/bricks/v1/render_element` 端点。利用了 `queryEditor` 参数中的代码注入点。
3.  **命令执行：** 注入的PHP代码会被执行，从而允许攻击者在目标服务器上执行任意命令。

**POC有效性：**
提供的漏洞信息、搜索结果和PoC代码都表明该漏洞是有效的。搜索结果中也包含了多个POC的GitHub链接。PoC代码通过发送特制的请求来触发代码注入，从而实现远程代码执行。

**投毒风险：**
仔细检查了`exploit.py`脚本，发现其目的是利用CVE-2024-25600漏洞，并无发现恶意代码。代码主要功能为：
1. 从目标网站获取nonce值。
2. 构造POST请求，利用queryEditor执行命令。
但是，存在一些风险：
*   **不安全性：** 代码禁用了SSL证书验证 (`verify=False`)，这会使用户容易受到中间人攻击。这部分可以认为是作者疏忽，但存在风险
*   **依赖性问题：** 该脚本依赖于BeautifulSoup、requests和prompt_toolkit等库，如果依赖项被篡改，则可能存在风险。但是，这不属于作者投毒的范畴
*   **命令执行的风险：** 该脚本允许执行任意命令。这意味着如果攻击者成功利用此漏洞，他们可以执行任何他们想要的命令，包括安装恶意软件或窃取数据。这个是漏洞本身的风险。

鉴于漏洞利用脚本可能被用于非法目的的固有风险，将投毒风险评估为5%。

**项目地址:** [Tornad0007/CVE-2024-25600-Bricks-Builder-plugin-for-WordPress](https://github.com/Tornad0007/CVE-2024-25600-Bricks-Builder-plugin-for-WordPress)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)