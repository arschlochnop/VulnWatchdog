## CVE-2025-6758 - Real Spaces WordPress Theme 未授权提权

**漏洞编号:** CVE-2025-6758

**漏洞类型:** 权限提升

**影响应用:** Real Spaces - WordPress Properties Directory Theme

**危害等级:** 严重，允许未授权用户注册为管理员

**影响版本:** <= 3.6

**利用条件:** 目标网站安装并启用了 Real Spaces WordPress 主题，且版本小于等于 3.6

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6758 存在于 Real Spaces WordPress Properties Directory Theme 主题中，版本小于等于 3.6。该漏洞允许未经身份验证的攻击者通过 `imic_agent_register` 函数将自己的角色设置为管理员。这是由于注册角色时缺乏限制造成的。漏洞利用方式如下：

1.  **漏洞分析：** 漏洞存在于主题的注册逻辑中，`imic_agent_register` 函数允许用户在注册时指定角色。由于缺乏适当的权限检查，攻击者可以将自己的角色设置为管理员，从而获得对整个 WordPress 网站的完全控制。

2.  **POC有效性：** 提供的 Python 脚本旨在通过以下步骤利用此漏洞：
    *   脚本尝试发现注册页面上的 nonce 值。Nonce 是一种安全令牌，用于防止跨站请求伪造（CSRF）攻击。脚本使用多种方法提取 nonce，包括解析 HTML 和查找 JavaScript 代码。
    *   脚本使用发现的 nonce 值和攻击者提供的用户名、密码、电子邮件和角色（设置为“administrator”）向注册端点发送 POST 请求。
    *   如果注册成功，攻击者将成为管理员。

3.  **利用方式：**
    *   首先，脚本尝试在目标网站上找到注册页面。它会扫描常见的路径，例如 `/register`、`/wp-register.php` 和 `/wp-login.php?action=register`。
    *   一旦找到注册页面，脚本会解析 HTML 源代码以查找 `registration_nonce` 值。该 nonce 值用于防止跨站请求伪造 (CSRF) 攻击。
    *   然后，脚本构造一个包含攻击者选择的用户名、密码、电子邮件地址和 `administrator` 角色的 POST 请求。
    *   脚本将 POST 请求发送到注册端点。如果请求成功，攻击者将在 WordPress 网站上注册为一个管理员用户。

4.  **投毒风险：** 代码整体结构是完整的漏洞利用脚本，具有收集目标注册页面的功能，并且能够提交注册请求。投毒风险较低，主要是因为其行为是直接利用漏洞进行提权，而非执行其他恶意操作。但是，存在微小的风险，例如：
    *   **错误处理：** 如果脚本无法成功提取 nonce 或注册用户，它可能会泄露敏感信息（例如，服务器响应）到日志或控制台。
    *   **依赖性：** 脚本依赖于多个第三方库（例如，`requests` 和 `BeautifulSoup`）。这些库可能包含漏洞，攻击者可以利用这些漏洞来执行恶意代码。
    *   **可移植性:** 该脚本的实现可能不适用于所有情况，例如目标注册页面存在特殊过滤字符等情况，攻击者需要自行修改脚本才能利用此漏洞. 

    因此，该脚本的投毒风险大约为5%。该百分比基于对代码的分析，表明它主要集中在漏洞利用上，但存在一些轻微的安全问题。

5.  **总结：** 提供的 POC 代码似乎有效，因为它实现了利用 CVE-2025-6758 漏洞所需的步骤。攻击者可以使用此脚本在易受攻击的 WordPress 网站上注册为管理员用户，从而完全控制该网站。存在轻微的投毒风险，但不影响漏洞的利用成功率。

**项目地址:** [Nxploited/CVE-2025-6758](https://github.com/Nxploited/CVE-2025-6758)

**漏洞详情:** [CVE-2025-6758](https://nvd.nist.gov/vuln/detail/CVE-2025-6758)