## CVE-2017-7921-Hikvision Cameras-不当身份验证

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 不当身份验证

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致权限提升和敏感信息泄露

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 需要网络访问，目标设备运行受影响版本的Hikvision摄像头

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-7921 存在于 Hikvision 摄像头中，由于不当的身份验证，未经身份验证的攻击者可以访问摄像头快照。PoC 代码通过向 `/onvif-http/snapshot?auth=YWRtaW46MTEK` 发送 HTTP GET 请求来利用此漏洞，其中 `YWRtaW46MTEK` 是经过 Base64 编码的用户名 admin 和密码 11。如果状态码为 200 且内容长度大于 100，则认为目标易受攻击。PoC 代码使用多线程加速扫描，并将易受攻击的 URL 写入 vulnerable.txt 文件。

**有效性：**
根据漏洞信息和搜索引擎结果，此 PoC 似乎有效，因为它可以利用身份验证绕过漏洞来获取摄像头快照。

**投毒风险：**
PoC 代码本身主要用于检测漏洞。虽然没有明显的恶意代码，但存在轻微的投毒风险（10%）。
*   该脚本在 vulnerable.txt 文件中追加 URL，如果被大规模利用，可能造成隐私泄露。
*   依赖 `requirements.txt` 安装第三方库，可能存在依赖包被篡改的风险。
*   目标IP列表targets.txt，如果被替换为蜜罐或者恶意IP地址，可能导致扫描者暴露自身。

**利用方式：**
1.  攻击者需要一个包含目标 Hikvision 摄像头 IP 地址的列表（targets.txt）。
2.  攻击者运行 PoC 脚本，脚本会并发地向目标 IP 地址发送特制的 HTTP 请求。
3.  如果摄像头存在漏洞，攻击者可以未经身份验证地访问摄像头快照，或者通过尝试其他的ONVIF接口进行控制。
4.  PoC 会将所有被发现存在漏洞的摄像头的地址保存到 vulnerable.txt 文件中， 方便攻击者后续利用。

**项目地址:** [kooroshsanaei/HikVision-CVE-2017-7921](https://github.com/kooroshsanaei/HikVision-CVE-2017-7921)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)