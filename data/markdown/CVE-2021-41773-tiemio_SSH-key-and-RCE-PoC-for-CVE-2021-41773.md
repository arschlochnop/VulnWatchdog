## CVE-2021-41773 - Apache HTTP Server Path Traversal and RCE

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，并开启了CGI脚本支持，且Alias配置不当或存在默认配置漏洞。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 中。由于路径规范化存在缺陷，未经身份验证的攻击者可以利用路径遍历漏洞读取服务器上的任意文件，甚至执行远程代码。根据漏洞库信息和搜索引擎结果，此漏洞已在野外被利用。

**利用方式：**

1.  **路径遍历：** 攻击者可以使用包含 `/.%2e` 序列的 URL 绕过路径限制，访问受限目录之外的文件。例如：`http://target/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd` 可以尝试读取 `/etc/passwd` 文件。
2.  **远程代码执行：** 如果启用了 CGI 脚本，并且可以通过路径遍历访问到 CGI 脚本目录之外的文件，攻击者可以通过上传恶意 CGI 脚本并执行它来实现远程代码执行。

**POC 代码分析：**

提供的 POC 代码是一个 Go 语言编写的工具，用于利用 CVE-2021-41773 进行攻击。该工具支持以下功能：

*   指定目标 IP 地址和端口。
*   选择 SSH 密钥字典的大小（小、中、大）。
*   启用 HTTPS。
*   指定自定义 SSH 密钥字典。
*   启用远程代码执行。

该 POC 的主要攻击流程如下：

1.  从目标服务器的 `/etc/passwd` 文件中提取用户名。
2.  使用指定的 SSH 密钥字典尝试暴力破解 SSH 密钥。
3.  （如果启用了 RCE）执行远程代码。

**投毒风险分析：**

经过对 POC 代码的分析，发现潜在的投毒风险较低，约为5%。主要原因如下：

*   该 POC 代码主要实现了路径遍历读取文件和 SSH 密钥爆破功能，本身不包含明显的恶意代码。
*   代码结构较为清晰，方便审查。
*   可以通过限制用户权限来降低风险，避免用户直接编译执行。

**潜在投毒点：**

*   如果攻击者替换了默认的 SSH 密钥字典，可能会导致爆破失败或者植入恶意 SSH 密钥。
*   在 RCE 功能中，攻击者可以执行任意命令，可能存在安全风险。

**总体评估：**

该 POC 代码的有效性较高，可以用于验证 CVE-2021-41773 漏洞，并进行简单的 SSH 密钥爆破。投毒风险较低，但仍然需要保持警惕，避免使用来源不明的字典文件，并限制 RCE 功能的使用。

**项目地址:** [tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773](https://github.com/tiemio/SSH-key-and-RCE-PoC-for-CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)