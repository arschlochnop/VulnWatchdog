## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 受影响版本：< 2.22.6, >= 2.23.0, < 2.23.6, >= 2.24.0, < 2.24.4, >= 2.25.0, < 2.25.2

**利用条件:** 需要能够访问GeoServer服务的网络连接，默认安装环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 是 GeoServer 中的一个远程代码执行 (RCE) 漏洞，由于不安全地将属性名称评估为 XPath 表达式而导致。攻击者可以通过构造特制的 OGC 请求（例如 WFS GetFeature、WFS GetPropertyValue、WMS GetMap、WMS GetFeatureInfo 和 WPS Execute）来利用此漏洞，从而在服务器上执行任意代码。提供的 POC 代码首先通过 GET 请求 `/geoserver/wfs?request=ListStoredQueries&service=wfs&version=2.0.0` 获取 `ReturnFeatureType`，然后构造一个包含恶意 XPath 表达式的 POST 请求，发送到 `/geoserver/wfs`，表达式中利用 `java.lang.Runtime.getRuntime()` 执行 base64 编码的反弹 shell 命令。POC中的投毒风险较低，主要体现在脚本中可能包含潜在的恶意代码，或者利用社会工程学诱导用户执行恶意操作。例如，如果脚本被修改为下载和执行额外的恶意负载，或者收集用户的敏感信息，就会造成更大的安全威胁。 此处的"poison"指的是，如果攻击者上传包含后门代码的图层定义，然后诱导其他用户下载并使用该定义，则可能构成投毒攻击。

**项目地址:** [0x0d3ad/CVE-2024-36401](https://github.com/0x0d3ad/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)