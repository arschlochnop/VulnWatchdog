## CVE-2022-21449 - Psychic Signatures

**漏洞编号:** CVE-2022-21449

**漏洞类型:** ECDSA 签名绕过

**影响应用:** Java SE JDK and JRE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，未经授权的数据创建、删除或修改

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 网络访问，受影响的 Java 版本部署了沙盒环境（例如，Web Start 应用程序或 Applet），或者通过 Web 服务等 API 使用了相关组件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-21449，又名“Psychic Signatures”，是一个存在于 Java ECDSA 签名验证实现中的严重漏洞。此漏洞允许攻击者使用畸形的签名绕过 ECDSA 验证，本质上伪造签名。根据漏洞描述和搜索结果，攻击者可以通过网络访问利用此漏洞。漏洞利用代码（pom.xml 和 PsychicSignaturesTests.java）是用于演示此漏洞的概念验证 (PoC) 代码。PoC 验证代码本身是为了证明漏洞的存在和工作原理，不包含恶意后门或主动攻击代码。虽然直接投毒的可能性较低（10%），但仍需谨慎，因为任何代码库都可能存在隐藏的、非预期的行为。利用方式如下：

1.  **构造畸形签名：** 攻击者生成一个特殊的 ECDSA 签名，其中签名值 R 和 S 均为零。
2.  **提交签名：** 攻击者将此畸形签名提交给使用受影响 Java 版本进行 ECDSA 验证的应用程序。
3.  **绕过验证：** 由于漏洞，Java 错误地将此畸形签名视为有效签名，从而允许攻击者绕过身份验证或执行其他未经授权的操作。

该漏洞影响使用 ECDSA 签名进行身份验证或完整性检查的应用程序。例如，TLS 握手、JWT 令牌验证或任何其他依赖于 ECDSA 签名的安全机制。利用该漏洞的成功会导致严重的安全风险，例如未经授权的访问、数据篡改和权限提升。

**项目地址:** [marschall/psychic-signatures](https://github.com/marschall/psychic-signatures)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)