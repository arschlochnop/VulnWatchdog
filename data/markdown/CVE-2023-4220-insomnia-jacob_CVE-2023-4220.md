## CVE-2023-4220-Chamilo LMS-RCE

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，允许未授权攻击者上传webshell并执行任意代码

**影响版本:** <= 1.11.24

**利用条件:** 目标系统安装了Chamilo LMS，且版本小于等于1.11.24，并且可以访问`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4220是Chamilo LMS <= v1.11.24中`/main/inc/lib/javascript/bigupload/inc/bigUpload.php`文件存在的一个未授权文件上传漏洞。攻击者可以利用此漏洞上传恶意webshell，从而实现远程代码执行。

**有效性分析：**
根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者上传任意文件，包括webshell，导致远程代码执行。提供的POC代码看起来能够自动化利用该漏洞。

**投毒风险分析：**
查看提供的`exploit.py`脚本，该脚本的功能是：
1.  检测目标URL是否存在漏洞（通过检查`/main/inc/lib/javascript/bigupload/files`目录）。
2.  如果检测到漏洞，则上传一个名为`insomnia.php`的webshell到目标服务器的`/main/inc/lib/javascript/bigupload/files/`目录下。
3.  脚本中创建了一个简单的webshell，允许通过GET参数`cmd`执行系统命令。并没有发现隐藏的、恶意的或不必要的功能，因此认为投毒风险极低，为0%。

**利用方式：**
1.  攻击者使用POC脚本指定目标Chamilo LMS的URL。
2.  POC脚本检查目标是否存在漏洞。
3.  如果存在漏洞，POC脚本上传一个简单的webshell。
4.  攻击者通过访问webshell的URL，并提供`cmd`参数来执行任意系统命令，如`http://example.com/main/inc/lib/javascript/bigupload/files/insomnia.php?cmd=id`。

综上所述，该漏洞的利用方式简单直接，危害性高，且POC有效。尽管POC可能被修改为恶意用途，但当前提供的代码没有发现明显的投毒行为。

**项目地址:** [insomnia-jacob/CVE-2023-4220](https://github.com/insomnia-jacob/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)