## CVE-2025-59230 - Windows Remote Access Connection Manager 权限提升

**漏洞编号:** CVE-2025-59230

**漏洞类型:** 权限提升

**影响应用:** Windows Remote Access Connection Manager

**危害等级:** 高危，本地权限提升至 SYSTEM

**影响版本:** 受影响的 Windows 版本：Windows 10 (versions 1507, 1607, 1809, 21H2, 22H2), Windows 11 (versions 22H2, 22H3, 23H2, 24H2, 25H2), Windows Server 2016, 2019, 2022 (including 23H2), 2025

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59230 漏洞存在于 Windows Remote Access Connection Manager (RasMan) 服务中，由于不正确的访问控制，允许经过身份验证的本地攻击者提升权限。提供的PoC代码包含一个可执行文件 `rasmanesc.exe`，该文件利用精心设计的 IOCTL 调用来覆盖 RasMan 服务的参数，从而提升到 SYSTEM 权限。`start_exp.bat` 批处理脚本用于安全地执行该漏洞利用程序。`payload.dll` 用于演示反向 shell。检测特征包括监控异常的 IOCTL 调用和注册表修改。缓解措施包括限制 RasMan 服务 ACL、启用 Credential Guard 和 AppLocker/WDAC。 风险评估表明存在一定投毒风险,因为payload是可以自定义的DLL,有可能会被植入后门代码。虽然主程序是为了提权, 但payload的加载增加了风险,故投毒风险为10%。漏洞利用方式：1. 获取 RasMan 服务的句柄。2. 发送特制的 IOCTL 缓冲区以覆盖服务参数。3. 通过令牌模拟提升到 SYSTEM 权限。4. 注入 payload 以生成 SYSTEM 级别的 shell。

**项目地址:** [moegameka/CVE-2025-59230](https://github.com/moegameka/CVE-2025-59230)

**漏洞详情:** [CVE-2025-59230](https://nvd.nist.gov/vuln/detail/CVE-2025-59230)