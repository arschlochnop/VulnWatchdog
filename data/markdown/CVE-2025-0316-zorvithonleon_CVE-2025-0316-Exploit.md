## CVE-2025-0316-WP Directorybox Manager-身份验证绕过

**漏洞编号:** CVE-2025-0316

**漏洞类型:** 身份验证绕过

**影响应用:** WP Directorybox Manager

**危害等级:** 高危，允许未经身份验证的攻击者以任何现有用户身份登录，包括管理员

**影响版本:** <= 2.5

**利用条件:** 需要目标网站安装了受影响版本的WP Directorybox Manager插件，且知道目标用户名

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0316是WP Directorybox Manager插件中的一个身份验证绕过漏洞。该漏洞存在于'wp_dp_enquiry_agent_contact_form_submit_callback'函数中，由于不正确的身份验证，允许未经身份验证的攻击者通过发送包含'action'和'user_login'参数的POST请求到'wp-admin/admin-ajax.php'，以任何现有用户身份登录，包括管理员。\n\n**有效性：**\n根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。漏洞库信息明确指出存在身份验证绕过，搜索引擎结果确认了该漏洞的存在和影响，而提供的POC代码实现了利用该漏洞的功能。\n\n**投毒风险：**\n代码中存在一定的投毒风险，可能性为10%。虽然代码主要功能是实现漏洞利用，但也包含了一些可疑的操作：\n1. **代理和User-Agent:** 代码包含随机User-Agent和代理功能，虽然增加了匿名性，但也可能被用于隐藏恶意行为。load_user_agents() 和 load_proxies()函数需要进一步检查，确认加载的数据源是否可信，如果数据源被篡改，可能导致恶意代理或User-Agent被使用。\n2. **Cookie存储和自动登录：**  自动保存cookie并尝试自动登录的功能存在风险，如果cookie被窃取或篡改，可能被用于进一步的攻击。\n3. **日志记录：** 日志记录功能可能存在信息泄露风险，需要确保日志记录的内容安全。\n\n**利用方式：**\n1. **目标确认:** 验证目标网站是否为WordPress，以及是否安装了受影响版本的WP Directorybox Manager插件。\n2. **用户名枚举:** 使用'author='参数进行用户名枚举，获取目标网站的有效用户名。\n3. **漏洞利用:** 发送包含'action'和'user_login'参数的POST请求到'wp-admin/admin-ajax.php'，其中'action'设置为'wp_dp_enquiry_agent_contact_form_submit_callback'，'user_login'设置为目标用户名。\n4. **身份验证绕过:** 如果漏洞利用成功，攻击者将获得目标用户的身份验证cookie。\n5. **登录:** 使用获取的cookie自动登录到目标网站的后台管理面板。

**项目地址:** [zorvithonleon/CVE-2025-0316-Exploit](https://github.com/zorvithonleon/CVE-2025-0316-Exploit)

**漏洞详情:** [CVE-2025-0316](https://nvd.nist.gov/vuln/detail/CVE-2025-0316)