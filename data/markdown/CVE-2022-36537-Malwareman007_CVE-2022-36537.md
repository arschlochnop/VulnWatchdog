## CVE-2022-36537-ZK Framework-信息泄露/RCE

**漏洞编号:** CVE-2022-36537

**漏洞类型:** 信息泄露/远程代码执行

**影响应用:** ZK Framework

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** v9.6.1, 9.6.0.1, 9.5.1.3, 9.0.1.2, 8.6.4.1

**利用条件:** 目标系统运行受影响的ZK Framework版本，攻击者能够发送POST请求到`AuUploader`组件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-36537存在于ZK Framework的`AuUploader`组件中，攻击者可以通过精心构造的POST请求来访问敏感信息。根据搜索引擎结果，此漏洞已被积极利用，并且可能导致远程代码执行，特别是结合R1Soft Server Backup Manager时。该漏洞利用代码首先尝试绕过身份验证，然后利用`AuUploader`组件的`nextURI`参数来读取任意文件或部署JDBC后门。

**有效性：**
提供的POC代码针对CVE-2022-36537，包含绕过身份验证和利用`AuUploader`组件读取文件以及部署JDBC后门的功能。根据搜索结果，此漏洞已被广泛利用，POC代码的可用性和相关分析文章表明其具有较高的有效性。

**投毒风险：**
对提供的POC代码进行了分析，发现其中包含创建和上传JDBC后门的功能。这部分代码本身是为了利用漏洞，但如果攻击者将此代码传播出去，接收者在不知情的情况下使用，可能会被攻击者利用。此外，代码中包含从目标系统读取文件的功能，这也存在潜在的风险。总的来说，投毒风险评估为10%。

**利用方式：**
1.  **身份验证绕过：** 利用`login.zul`页面获取`dtid`和`cookie`，绕过身份验证。
2.  **文件读取：** 通过构造包含恶意`nextURI`参数的POST请求发送到`AuUploader`组件，读取服务器上的任意文件。
3.  **JDBC后门部署：** 通过上传恶意JDBC驱动程序，在服务器上部署后门，实现远程代码执行。此方法需要利用`Configuration/database-drivers.zul`页面以及相关的组件ID（`database_dtid`，`mysql_driver_upload_button_id`，`file_upload_dlg_id`，`file_upload_id`），通过模拟点击和上传操作，将恶意的JDBC驱动上传到服务器。

**需要注意：**
*   POC代码中的`proxy`变量可以设置HTTP代理，用于调试或绕过网络限制。
*   代码中使用了`requests`和`selenium`库，需要确保已安装这些库。
*   JDBC后门只能部署一次，需要做好持久化操作。

**项目地址:** [Malwareman007/CVE-2022-36537](https://github.com/Malwareman007/CVE-2022-36537)

**漏洞详情:** [CVE-2022-36537](https://nvd.nist.gov/vuln/detail/CVE-2022-36537)