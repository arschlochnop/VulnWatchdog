## CVE-2024-38063 - Windows TCP/IP Remote Code Execution Vulnerability

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 严重，远程代码执行

**影响版本:** 见漏洞库信息

**利用条件:** 需要目标系统启用IPv6

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-38063 是一个 Windows TCP/IP 远程代码执行漏洞。根据漏洞库信息，多个版本的 Windows 操作系统受到影响，包括 Windows 10, Windows 11, Windows Server 等。该漏洞的 CVSS 评分为 9.8，表明其严重性极高。

**有效性：**
根据搜索结果，该漏洞允许攻击者在启用了 IPv6 的 Windows 系统上远程执行任意代码。提供的 PoC 代码尝试通过发送特制的 IPv6 数据包来触发漏洞。虽然 PoC 代码仅仅构造了一个畸形的IPv6包，并没有实际的代码执行payload，但是作为一个概念验证是可以触发漏洞的。

**投毒风险：**
提供的 PoC 代码片段看起来相对简单，主要目的是构造并发送恶意的 IPv6 数据包。然而，在真实利用场景中，攻击者可能会在 `create_ipv6_exploit_packet()` 函数中嵌入恶意代码，例如 shellcode，以实现远程代码执行。当前代码片段本身不包含明显的恶意行为，但存在被修改和利用的风险。同时`README.md`来自名为Marcus Hutchins的作者，这需要进一步验证其真实性。
初步判断投毒风险为10%，主要的风险点在于：
*   **依赖第三方库：**  PoC 依赖 socket 库，如果该库被篡改，可能引入恶意代码。
*   **可能存在的后门：** 代码本身逻辑简单，但攻击者可能通过修改操作系统底层网络组件植入后门，但这不在PoC的范围内。

**利用方式：**
1.  **漏洞触发：**  攻击者需要向目标系统发送特制的 IPv6 数据包，触发 tcpip.sys 中的漏洞。
2.  **代码执行：**  利用漏洞，攻击者可以在目标系统上执行任意代码。攻击者可以利用`create_ipv6_exploit_packet()`嵌入payload
3.  **权限提升：** 由于漏洞存在于内核驱动中，成功利用该漏洞可以导致系统权限提升，从而完全控制受害者系统。

总的来说，CVE-2024-38063 是一个高危漏洞，需要及时修复。提供的 PoC 代码可能有效，但存在被恶意修改的风险，用户在使用时需要格外小心。

**项目地址:** [AdminPentester/CVE-2024-38063-](https://github.com/AdminPentester/CVE-2024-38063-)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)