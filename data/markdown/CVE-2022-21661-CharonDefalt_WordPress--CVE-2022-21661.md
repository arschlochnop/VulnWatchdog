## CVE-2022-21661-WordPress-SQL注入

**漏洞编号:** CVE-2022-21661

**漏洞类型:** SQL注入

**影响应用:** WordPress

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 5.8.3

**利用条件:** 需要目标WordPress站点存在易受攻击的插件或主题，且用户具有足够权限（例如，管理员权限，虽然利用并不一定需要管理员权限，但CVSS评分显示需要高权限）

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-21661 是 WordPress Core 5.8.3 之前版本中 WP_Query 类中由于不正确的输入验证而产生的 SQL 注入漏洞。

**有效性：**
根据漏洞库信息、搜索引擎结果（特别是Exploit-DB的页面）和提供的漏洞利用代码，此漏洞是有效的。存在公开的PoC利用代码，并且多个安全厂商和研究人员已经确认并分析了该漏洞。

**投毒风险：**
检查了提供的PoC代码，包括`README.md`、视频目录下的文件和`50663.txt`（包含Exploit），没有发现明显的恶意代码或后门。

*   `README.md`: 主要提供漏洞描述和PoC视频的链接，本身不包含可执行代码。
*   视频目录下的文件:仅包含作者的个人信息和联系方式，没有发现任何恶意代码。
*   `50663.txt`: 包含漏洞利用的详细信息和示例HTTP请求。虽然可以利用它来攻击目标，但它本身不是投毒代码，而是一个合法的漏洞利用脚本。

因此，投毒风险很低，估计为1%。这主要是因为PoC代码本身相对简单，目的是演示漏洞，而非植入后门。

**利用方式：**
利用方式如下：

1.  **漏洞位置:** 漏洞存在于 `WP_Query` 类中，该类用于执行数据库查询。
2.  **攻击向量:** 攻击者可以通过 `admin-ajax.php` 接口，利用 `tax_query` 参数传递恶意的 SQL 代码。
3.  **利用过程:** 通过构造包含恶意 SQL 语句的 `query_vars` 参数发送 POST 请求到 `/wp-admin/admin-ajax.php`。该请求需要 `action` 和 `nonce` 参数。
4.  **影响:** 成功的利用可能允许攻击者执行任意 SQL 查询，从而泄露数据库信息，甚至可能导致远程代码执行。

**总结:**
该漏洞是一个高危 SQL 注入漏洞，存在公开的PoC代码，未经授权的攻击者可以利用它来获取敏感信息或执行恶意代码。建议受影响的用户尽快升级到 WordPress 5.8.3 或更高版本。

**项目地址:** [CharonDefalt/WordPress--CVE-2022-21661](https://github.com/CharonDefalt/WordPress--CVE-2022-21661)

**漏洞详情:** [CVE-2022-21661](https://nvd.nist.gov/vuln/detail/CVE-2022-21661)