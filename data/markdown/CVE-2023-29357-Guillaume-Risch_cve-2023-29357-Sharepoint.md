## CVE-2023-29357 - Microsoft SharePoint Server 权限提升漏洞

**漏洞编号:** CVE-2023-29357

**漏洞类型:** 权限提升

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，可能导致完全控制 SharePoint 服务器

**影响版本:** SharePoint Server 2019 版本 16.0.0 (不包含) 16.0.10399.20005

**利用条件:** 需要网络访问 SharePoint 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29357 是一个 Microsoft SharePoint Server 的权限提升漏洞。未经验证的远程攻击者可以通过伪造身份验证绕过身份验证，从而以管理员身份执行任意操作。\n\n**有效性：**\n根据漏洞库信息和搜索结果，该漏洞已被公开利用，CISA 已将其添加到已知被利用的漏洞目录中。提供的漏洞利用代码指向 GitHub 上的一个公开可用的 PoC（https://github.com/Chocapikk/CVE-2023-29357 ），表明该漏洞存在可用的利用方法，POC代码的有效性较高。\n\n**投毒风险：**\n分析提供的文件，主要包括一个 `README.md` 文件和两个 `Vagrantfile` 文件。`README.md` 文件提供了漏洞利用的信息，包括目标和攻击者的 IP 地址、登录凭据（可能用于测试环境），以及如何启动利用脚本的说明。`Vagrantfile` 文件用于配置测试环境的虚拟机。这些文件本身不包含任何明显的恶意代码。PoC利用了身份验证绕过，验证身份逻辑，因此不存在直接向目标植入后门的行为。\n\n然而，从仓库层面分析，**10%**的投毒风险主要来自以下几点：\n1.  **第三方依赖：**`exploit.py`脚本本身不在提供的文件中，这意味着必须从 `https://github.com/Chocapikk/CVE-2023-29357` 下载。攻击者可能会修改 GitHub 仓库中的 `exploit.py` 脚本，添加恶意代码，虽然几率较小，因为该存储库已被广泛关注，任何更改都可能被迅速发现。\n2.  **凭据泄露：** `README.md` 文件中包含测试环境的登录凭据。如果在生产环境中使用这些凭据，则可能导致安全风险。虽然不大可能，但攻击者可能会创建类似的 README，但实际链接到恶意的Exploit。\n3.  **供应链风险：** Vagrant box `leiven/cve-2023-29357-sharepoint` 和 `leiven/cve-2023-29357-lubuntu` 是预构建的虚拟机镜像。这些镜像可能包含未知的漏洞或恶意软件，尽管可能性较小，因为 Vagrant boxes 通常经过社区审查，而且会构建全新的虚拟机。\n\n因此，尽管提供的文件本身看起来无害，但使用第三方代码和预构建的虚拟机镜像总是存在一定的风险。\n\n**利用方式：**\n该漏洞的利用方式主要包括以下步骤：\n1.  **环境搭建：** 使用提供的 `Vagrantfile` 文件搭建一个包含易受攻击的 SharePoint 服务器和攻击者机器的测试环境（可选，也可以直接针对目标服务器）。\n2.  **下载 PoC：** 从 `https://github.com/Chocapikk/CVE-2023-29357` 下载 `exploit.py` 脚本。\n3.  **运行 PoC：** 在攻击者机器上运行 `exploit.py` 脚本，指定目标 SharePoint 服务器的 URL。`python3 exploit.py -u http://win-hevujkgjma6/ -v`\n4.  **权限提升：** PoC 脚本利用漏洞绕过身份验证，从而获得对 SharePoint 服务器的管理员权限。利用成功后，攻击者可以执行任意操作，包括读取敏感数据、修改配置和安装恶意软件。

**项目地址:** [Guillaume-Risch/cve-2023-29357-Sharepoint](https://github.com/Guillaume-Risch/cve-2023-29357-Sharepoint)

**漏洞详情:** [CVE-2023-29357](https://nvd.nist.gov/vuln/detail/CVE-2023-29357)