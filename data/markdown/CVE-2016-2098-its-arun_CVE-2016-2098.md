## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，允许攻击者执行任意Ruby代码

**影响版本:** 3.2.22.2之前, 4.x 4.1.14.2之前, 和 4.2.x 4.2.5.2之前

**利用条件:** 目标应用使用了存在漏洞的Rails版本，且`render`方法以不安全的方式处理用户输入。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-2098是Ruby on Rails Action Pack中的一个远程代码执行漏洞。该漏洞源于对`render`方法的不安全使用，允许远程攻击者通过操纵用户提供的数据来执行任意Ruby代码。

**有效性：**

提供的POC代码利用了这一漏洞。通过向易受攻击的Rails应用发送特制的HTTP请求，攻击者可以在服务器上执行任意命令。

**投毒风险：**

代码本身的功能就是利用漏洞执行命令，没有发现恶意添加的额外功能代码。但是，下载和使用任何未经审查的漏洞利用代码都存在风险。POC代码的设计目标是利用漏洞，而攻击者可以修改这些POC代码以包含恶意功能，例如安装后门、窃取数据或进行其他恶意活动。
`README.md` 文件描述了漏洞和基本用法，未发现恶意代码。
`CVE-2016-2098.sh` 脚本相对简单，主要功能是构造恶意请求以利用漏洞。虽然脚本本身没有明显的恶意代码，但用户应始终谨慎审查并理解任何下载的代码。

**利用方式：**

1.  **确定目标:** 识别运行易受攻击的Ruby on Rails版本的Web应用程序。
2.  **构造Payload:** 使用POC脚本，构造包含要执行的Ruby代码的HTTP请求。此代码将作为`render`方法的参数传递。
3.  **发送Payload:** 将构造的HTTP请求发送到目标Web应用程序。
4.  **执行代码:** 如果目标应用程序易受攻击，服务器将执行嵌入在Payload中的Ruby代码。

脚本的工作方式是：

*   它接受三个参数：目标主机、URI 和要执行的命令。
*   它使用 `curl` 命令发送一个包含恶意 payload 的 HTTP 请求到目标服务器。Payload 利用 Rails `render` 方法执行任意命令。
*   它提供一个简单的交互式 shell，允许攻击者重复执行命令。

**项目地址:** [its-arun/CVE-2016-2098](https://github.com/its-arun/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)