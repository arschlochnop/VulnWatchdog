## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46 and 7.0.0 to 7.0.81

**利用条件:** HTTP PUTs 必须启用 (例如，通过将 Default servlet 的 readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-12617 漏洞允许攻击者通过上传包含恶意代码的 JSP 文件到服务器来执行远程代码。漏洞利用的关键条件是 Tomcat 服务器启用了 HTTP PUT 方法，这通常需要管理员显式地配置。漏洞利用代码 `CVE-2017-12617.py` 提供了一个命令行工具，用于检测目标 URL 是否易受攻击并上传一个 webshell。

**利用方式：**

1.  **检测：**  使用脚本检测目标 Tomcat 服务器是否启用了 HTTP PUT 方法以及是否运行着受影响的版本。
2.  **上传 Webshell：**  如果满足条件，攻击者可以使用脚本上传一个恶意的 JSP 文件（webshell）。脚本通过构造一个 HTTP PUT 请求将包含恶意 Java 代码的 JSP 文件上传到服务器。
3.  **远程代码执行：**  一旦 webshell 上传成功，攻击者就可以通过访问该 JSP 文件来执行任意命令。脚本提供了一个交互式 shell，允许攻击者在目标服务器上执行命令。

**投毒风险评估：**

提供的漏洞利用代码 `CVE-2017-12617.py` 主要是利用漏洞，本身没有明显的投毒行为。代码虽然会上传webshell，但是webshell本身是用于漏洞验证以及远程控制，不是隐藏的恶意代码。代码中存在对用户输入参数的获取，如果该参数被恶意篡改，可能会造成一定影响。由于代码量不大，可以人工审核，判定为存在投毒的概率极低,低于 1%。

**有效性：**
根据漏洞库信息和搜索引擎结果，以及漏洞利用代码来看，提供的PoC代码有效。多个漏洞库和安全厂商都确认了该漏洞的存在，并提供了修复方案。漏洞利用代码实现了漏洞的利用过程，能够上传webshell并执行命令。

**项目地址:** [yZeetje/CVE-2017-12617](https://github.com/yZeetje/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)