## CVE-2025-4796-Eventin-特权提升/账户接管

**漏洞编号:** CVE-2025-4796

**漏洞类型:** 特权提升/账户接管

**影响应用:** Eventin

**危害等级:** 高危，可能导致账户接管和权限提升

**影响版本:** <= 4.0.34

**利用条件:** 需要Contributor或更高权限的WordPress账户

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4796 存在于 Eventin WordPress 插件中，版本小于等于 4.0.34。该漏洞允许具有投稿者（Contributor）或以上权限的已认证攻击者通过更改任意用户（包括管理员）的电子邮件地址来提升权限并接管账户。漏洞存在于 'Eventin\Speaker\Api\SpeakerController::update_item' 函数中，该函数在更新用户信息前未正确验证用户的身份或权限。

**有效性评估：**
提供的 Python POC 代码似乎有效。它通过以下步骤利用漏洞：

1.  **登录 WordPress：** 使用提供的用户名和密码登录 WordPress。
2.  **提取 Nonce 值：** 从管理页面提取 nonce 值，该值用于绕过 CSRF 保护。
3.  **更新 Speaker 信息：** 使用 API 端点和提取的 nonce 值，将目标用户的电子邮件地址更改为攻击者控制的地址。
4.  **重置密码：** 攻击者可以使用新设置的电子邮件地址重置目标用户的密码，并接管其帐户。

**投毒风险分析：**
POC 代码主要实现漏洞利用的功能，没有明显的恶意或隐藏代码，但在以下几点存在潜在的投毒风险：

*   **编码问题：** 代码中包含 `Nxploited_safe_print` 函数来处理 Unicode 编码问题。虽然这本身不是恶意代码，但可能被滥用以隐藏或混淆恶意字符串。
*   **依赖风险：** 虽然没有明确的外部依赖，但是requests库本身也存在被投毒的风险。
*   **隐蔽执行：** 通过更改sleep的时长来影响payload执行的效率.

代码中存在微小的投毒风险，概率大约为1%。

**利用方式：**
1.  攻击者需要拥有一个具有投稿者（Contributor）或更高权限的 WordPress 帐户。
2.  攻击者使用 POC 代码提供的脚本登录到 WordPress 网站。
3.  脚本会尝试提取 nonce 值，然后使用该值向 WordPress 发送恶意请求。
4.  恶意请求会修改目标用户的电子邮件地址。
5.  攻击者可以使用新设置的电子邮件地址重置目标用户的密码，从而接管目标用户的帐户。

**项目地址:** [Nxploited/CVE-2025-4796](https://github.com/Nxploited/CVE-2025-4796)

**漏洞详情:** [CVE-2025-4796](https://nvd.nist.gov/vuln/detail/CVE-2025-4796)