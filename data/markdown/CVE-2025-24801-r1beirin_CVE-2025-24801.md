## CVE-2025-24801-GLPI-远程代码执行

**漏洞编号:** CVE-2025-24801

**漏洞类型:** 远程代码执行

**影响应用:** GLPI

**危害等级:** 高危，允许经过身份验证的用户上传恶意PHP文件并执行

**影响版本:** >= 0.85, < 10.0.18

**利用条件:** 需要GLPI实例，用户具有经过身份验证的低权限访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24801 是 GLPI 中的一个远程代码执行漏洞。经过身份验证的用户可以通过上传包含恶意代码的 PHP 文件，然后强制执行该文件来利用此漏洞。从搜索引擎结果和漏洞库信息来看，此漏洞已被公开披露，并且存在可用的利用代码（POC）。

**利用方式：**

1.  **身份验证：** 攻击者需要GLPI实例的有效用户凭据。
2.  **计算机创建：**POC尝试创建一个计算机来生成报告。
3.  **获取GLPI TEMP目录:** POC代码尝试从GLPI的配置中检索临时目录的路径。
4.  **设置PDF字体：**利用本地文件包含(LFI),通过修改配置文件中的`pdffont`参数，将其指向位于GLPI临时目录的shell文件，达到执行恶意PHP代码的目的。POC将PDF字体设置为指向一个构造的路径`../../../../../../../../{glpi_temp_dir}/shell`。
5.  **上传恶意文件：**需要在glpi的临时目录中存在可执行的shell文件，可能是先前已经上传的文件，也可能是通过其他方式写入的。
6.  **触发报告生成：**当GLPI尝试使用设置的PDF字体生成报告时，它会包含并执行shell文件，从而导致远程代码执行。

**有效性评估：**

提供的 POC 代码看起来是有效的，因为它涵盖了漏洞利用所需的步骤。从代码分析来看，它尝试模拟利用过程，包括登录、修改 PDF 字体配置和触发代码执行。从README.md中可以看出，该漏洞利用与GLPI的LFI漏洞相关联。

**投毒风险评估：**

分析 POC 代码，发现存在轻微的投毒风险，大约为 10%。尽管代码本身似乎实现了漏洞利用，但仍然存在一些潜在的风险：

*   **依赖性风险：**POC 依赖于特定的 GLPI 配置（例如临时目录的位置）。如果目标 GLPI 实例的配置不同，则 POC 可能无法正常工作，并且可能需要修改。
*   **潜在后门：**在 `set_pdf_font` 函数中，虽然表面上只是设置了 `pdffont` 变量，但是如果攻击者控制了 `payload` 变量，那么可能会植入更隐蔽的后门代码。
*   **命令执行风险：**通过 `--cmd` 参数执行任意命令，在特定情况下可能存在风险。虽然这本身不是投毒，但如果未经授权使用，可能会对系统造成损害。

总体而言，该 POC 的主要目的是为了利用 CVE-2025-24801 漏洞，并非明显的恶意投毒软件，但仍需仔细审查和谨慎使用。


**项目地址:** [r1beirin/CVE-2025-24801](https://github.com/r1beirin/CVE-2025-24801)

**漏洞详情:** [CVE-2025-24801](https://nvd.nist.gov/vuln/detail/CVE-2025-24801)