## CVE-2023-22527-Confluence-远程代码执行

**漏洞编号:** CVE-2023-22527

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 严重，允许未经身份验证的攻击者执行任意代码

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22527 是 Atlassian Confluence Data Center 和 Server 中的一个模板注入漏洞，允许未经身份验证的攻击者通过注入 OGNL 表达式来执行任意代码。漏洞存在于受影响版本（8.0.0 <= version < 8.5.4）中。攻击者可以发送特制的 HTTP POST 请求到 `/template/aui/text-inline.vm` 端点，在 `label` 参数中包含恶意的 OGNL 表达式，从而执行服务器上的命令。

**有效性：**
提供的 POC 代码利用了该漏洞，通过构造包含 OGNL 表达式的 POST 请求，在目标系统上执行命令。POC 代码已经包含了利用的URL路径，以及所需的请求头。

**投毒风险：**
仓库中的主要代码文件 `CVE-2023-22527.py` 看起来是直接利用漏洞的 POC，并没有发现明显的恶意或投毒代码。`README.md` 文件也只是提供了漏洞描述、使用方法和免责声明。仔细检查了POC代码的每个函数，未发现有任何后门行为或恶意操作。但是，由于任何代码都可能被修改，仍然存在极低的风险，这里判断投毒风险为1%。

**利用方式：**
1.  攻击者向目标 Confluence 服务器的 `/template/aui/text-inline.vm` 发送精心构造的 POST 请求。
2.  请求的 `label` 参数包含一个 OGNL 表达式，该表达式允许执行任意命令。
3.  服务器解析该 OGNL 表达式，并在服务器上执行攻击者指定的命令。
4.  命令执行的结果被写入 HTTP 响应中，攻击者可以从响应中获取执行结果。

**总结:**
此漏洞是严重的安全问题，由于存在公开的 POC 代码，被利用的风险非常高。强烈建议受影响的用户尽快升级到不受影响的版本。

**项目地址:** [Vozec/CVE-2023-22527](https://github.com/Vozec/CVE-2023-22527)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)