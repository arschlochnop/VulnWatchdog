## CVE-2025-24813-Apache Tomcat-路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 ~ 11.0.2, 10.1.0-M1 ~ 10.1.34, 9.0.0.M1 ~ 9.0.98

**利用条件:** 默认Servlet写入已启用，支持部分PUT已启用，目标URL是公共上传URL的子目录, 攻击者需要知道上传的安全敏感文件的名称，安全敏感文件也通过部分PUT上传；或者应用程序使用 Tomcat 基于文件的会话持久性，默认存储位置，应用程序包含一个可以在反序列化攻击中使用的库

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 涉及 Apache Tomcat 的路径等价问题，可能导致远程代码执行、信息泄露或恶意内容注入。漏洞利用依赖于多个条件，包括默认Servlet写入已启用，支持部分PUT请求，以及特定的文件存储配置。搜索结果 "One PUT Request to Own Tomcat: CVE-2025-24813 RCE is in the Wild/" 表明该漏洞可能已在野外被利用，提高了其风险级别。提供的PoC代码是一个批量检测脚本，通过发送恶意PUT请求来验证目标是否存在漏洞。由于PoC中包含未经审查的base64解码payload, 存在极高的投毒风险，攻击者可能修改payload指向恶意地址，执行任意代码,因此投毒风险为100%。

**利用方式：**
1.  **信息泄露/恶意内容注入：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, a target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT，则可以查看安全敏感文件和/或将内容注入到这些文件中。
2.  **远程代码执行：** 如果满足条件 writes enabled for the default servlet, support for partial PUT, application was using Tomcat's file based session persistence with the default storage location, application included a library that may be leveraged in a deserialization attack，则可利用反序列化漏洞执行远程代码。
3.  **PoC 利用：** PoC脚本首先解析目标URL，然后发送精心构造的PUT请求到目标服务器。如果服务器存在漏洞，并且满足利用条件，攻击者可以实现远程代码执行或信息泄露。

**项目地址:** [iSee857/CVE-2025-24813-PoC](https://github.com/iSee857/CVE-2025-24813-PoC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)