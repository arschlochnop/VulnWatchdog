## CVE-2025-24813 - Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/路径穿越

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 需要默认Servlet开启写入功能（默认关闭），支持partial PUT（默认开启），以及目标URL为公共上传URL的子目录，攻击者需要知道敏感文件名，并且敏感文件也通过partial PUT上传。 或者需要应用使用Tomcat的基于文件的session持久化，并且包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813 是一个 Apache Tomcat 中的路径等价漏洞，允许攻击者通过构造包含 `../` 序列的恶意请求，绕过路径验证，从而实现远程代码执行或信息泄露。

**有效性：**
根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该PoC代码有效。搜索结果中多个来源表明该漏洞已被实际利用，并且存在公开的PoC。PoC代码展示了如何利用 PUT 方法上传包含恶意代码的 JSP 文件到 Tomcat 的 webapps 目录，从而实现远程代码执行。

**投毒风险：**
提供的PoC代码的主要功能是上传一个包含命令执行功能的 JSP 文件。该JSP文件允许攻击者通过 GET 参数 `cmd` 执行任意系统命令。PoC本身的功能是直接的，并没有发现隐藏的、非预期的恶意行为，例如：
*   篡改系统文件
*   植入持久性后门
*   窃取敏感信息并外传
*   利用其他漏洞
因此，根据现有信息，可以认为投毒风险较低。虽然使用了Runtime.getRuntime().exec来执行命令，但是这个是PoC的需要，目的是验证RCE。判断为0%.

**利用方式：**
1.  **利用条件确认：** 目标Tomcat服务器需要满足以下条件：
    *   默认Servlet开启写入功能（`readonly` 参数设置为 `false`）。
    *   支持 partial PUT 请求（默认开启）。
    *  攻击目标满足特定的文件存储结构和命名规则(参考漏洞描述)
    *   或者应用使用了Tomcat的基于文件的session持久化机制且包含可用于反序列化攻击的库
2.  **恶意JSP上传：** 攻击者使用 PUT 方法，将包含恶意代码的 JSP 文件上传到 Tomcat 服务器。PoC 中使用了路径穿越技巧（`../`），将文件上传到 webapps/ROOT 目录下，从而绕过访问限制。
3.  **命令执行：** 攻击者通过访问上传的 JSP 文件，并传递 `cmd` 参数，执行任意系统命令。PoC 中演示了如何使用 `cat /etc/passwd` 命令读取系统密码文件。

**搜索引擎结果总结：**
搜索结果表明该漏洞已存在实际攻击案例，并且 CISA 已将其添加到已知被利用漏洞目录中。多个安全厂商和博客都对该漏洞进行了分析和披露，并提供了检测和缓解建议。

**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)