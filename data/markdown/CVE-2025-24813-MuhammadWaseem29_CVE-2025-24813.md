## CVE-2025-24813-Apache Tomcat Path Equivalence Vulnerability

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径遍历/远程代码执行/信息泄露

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和任意文件上传

**影响版本:** 11.0.0-M1 <= version <= 11.0.2, 10.1.0-M1 <= version <= 10.1.34, 9.0.0.M1 <= version <= 9.0.98

**利用条件:** 默认Servlet的写入功能已启用（默认禁用），支持部分PUT（默认启用），存在可利用的反序列化库（RCE），或存在敏感文件上传路径为公开上传路径的子目录，攻击者知道敏感文件名并且通过分段PUT上传（信息泄露）。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等效漏洞，允许攻击者通过包含内部点（`../`）的路径来操纵文件位置。根据漏洞库信息和搜索结果，该漏洞可能导致未经授权的文件修改、信息泄露和潜在的远程代码执行 (RCE)。

**有效性：**
提供的nuclei POC 脚本利用了该漏洞。它通过向精心构造的 URL 发送 PUT 请求，试图修改 `tomcat-users.xml` 文件，添加一个具有管理权限的新用户。 另一个请求则尝试上传一个jsp webshell，并且尝试访问这个webshell来执行`id`命令。如果成功，攻击者就可以控制受影响的 Tomcat 服务器。根据搜索引擎结果，此漏洞在野外已被积极利用，表明该POC代码是有效的。

**投毒风险：**
分析提供的POC代码，该代码由三个raw http请求组成。第一个请求尝试上传恶意配置覆盖`tomcat-users.xml`，添加一个新的管理员用户。第二个请求尝试上传一个JSP webshell，用于执行任意命令。第三个请求则尝试通过GET方法执行任意系统命令。从代码分析来看，该POC旨在利用漏洞，并未发现明显的恶意代码或后门。虽然添加管理员用户和上传webshell本身属于恶意行为，但这属于漏洞利用的一部分，而非隐藏的投毒代码。存在极小的投毒风险(1%)，例如编写者通过在脚本中引入细微错误，降低脚本的利用成功率，但这种情况可能性很低。

**利用方式：**
1.  **先决条件：** 默认Servlet开启写入功能，支持分段PUT请求。
2.  **路径遍历：** 攻击者构造包含 `../` 的恶意文件路径，绕过 Tomcat 的路径规范化。
3.  **文件上传/修改：** 通过 PUT 请求将恶意文件上传到服务器，或修改现有的配置文件。
4.  **远程代码执行/信息泄露：**
    *   **RCE：** 如果应用程序使用基于文件的会话持久化，且存在可利用的反序列化库，攻击者可以将恶意序列化对象写入会话文件，从而实现远程代码执行。
    *   **信息泄露：** 攻击者可以读取敏感配置文件（例如 `tomcat-users.xml`），获取管理员凭据。

利用该漏洞进行攻击，首先需要满足特定的条件。然后，攻击者可以利用路径遍历漏洞上传恶意文件或修改敏感文件，最终导致远程代码执行或信息泄露。


**项目地址:** [MuhammadWaseem29/CVE-2025-24813](https://github.com/MuhammadWaseem29/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)