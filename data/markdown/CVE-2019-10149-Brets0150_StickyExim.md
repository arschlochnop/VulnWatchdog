## CVE-2019-10149 Exim RCE HoneyPot

**漏洞编号:** CVE-2019-10149

**漏洞类型:** 远程代码执行

**影响应用:** Exim

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.87 to 4.91 (inclusive)

**利用条件:** 需要Exim服务运行且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10149 是 Exim 4.87 到 4.91 版本中存在的一个远程代码执行漏洞。该漏洞源于 `deliver_message()` 函数中对接收者地址的不当验证，攻击者可以通过构造包含恶意命令的电子邮件，利用此漏洞在目标系统上执行任意代码。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的、被广泛讨论的严重漏洞，并且已经被实际利用。提供的漏洞利用代码实际上是一个蜜罐脚本，用于检测针对此漏洞的攻击尝试，而不是一个直接利用漏洞的 PoC。然而，README中提到了另一个PoC：`https://github.com/cowbe0x004/eximrce-CVE-2019-10149`， 可以验证漏洞。

**投毒风险评估：**

该仓库主要功能是做一个蜜罐，用于监控Exim漏洞(CVE-2019-10149)的攻击行为。

*   `install_StickyExim.sh`: 安装和配置蜜罐，包括Exim配置和Cron Job设置
*   `honey_harvester_exim_cve-2019-10149.sh`: 核心脚本，用于解析Exim日志，检测CVE-2019-10149攻击尝试，并发送告警邮件。

审查了安装脚本和核心检测脚本。发现主要功能是监控和告警，没有发现明显的恶意代码，考虑到代码会修改Exim配置以及加入Cron Job。存在一定的风险，但是风险较低。所以判断存在10%的投毒风险。

**利用方式分析：**

此PoC本身不是用于攻击的，而是用于创建一个蜜罐来捕获攻击流量。 但是根据漏洞描述，利用方式大致如下：

1.  攻击者构造一封特殊的电子邮件，该邮件的接收者地址包含恶意命令。
2.  当 Exim 处理这封邮件时，`deliver_message()` 函数未能正确验证接收者地址，导致恶意命令被执行。
3.  攻击者可以通过这种方式在服务器上执行任意代码，从而控制服务器。

**总结：**

该漏洞是一个严重的安全漏洞，可以允许未经身份验证的远程攻击者在受影响的 Exim 服务器上执行任意代码。需要尽快修补此漏洞。

**项目地址:** [Brets0150/StickyExim](https://github.com/Brets0150/StickyExim)

**漏洞详情:** [CVE-2019-10149](https://nvd.nist.gov/vuln/detail/CVE-2019-10149)