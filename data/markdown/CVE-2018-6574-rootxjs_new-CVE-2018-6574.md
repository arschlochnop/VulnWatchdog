## CVE-2018-6574 - Go "go get" 远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，允许远程命令执行

**影响版本:** < 1.8.7, 1.9.x < 1.9.4, 1.10 pre-releases < 1.10rc2

**利用条件:** 需要目标机器运行受影响版本的 Go，并且使用 'go get' 命令获取恶意代码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 漏洞允许攻击者在构建源代码期间，通过 'go get' 命令执行远程命令。这是因为受影响版本的 Go 没有阻止 `-fplugin=` 和 `-plugin=` 参数，这些参数可以被用来加载恶意的 gcc 或 clang 插件。提供的POC代码演示了如何利用此漏洞。它通过在 Go 代码中使用 `#cgo CFLAGS: -fplugin=./plugin.so` 指令来指定一个恶意的插件。当构建此代码时，go 会尝试加载 `./plugin.so`，这使得攻击者能够在目标机器上执行任意代码。根据POC代码内容分析，未发现作者隐藏的投毒代码。

**项目地址:** [rootxjs/new-CVE-2018-6574](https://github.com/rootxjs/new-CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)