## CVE-2021-31630 - OpenPLC Webserver v3 命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** v3

**利用条件:** 需要能够访问OpenPLC Webserver的/hardware页面，并具有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于OpenPLC Webserver v3的/hardware页面，允许远程攻击者通过“Hardware Layer Code Box”组件执行任意代码。利用方式如下：

1.  **身份验证：** 使用提供的用户名和密码登录OpenPLC Webserver。
2.  **构造恶意请求：** 构造一个包含恶意代码的multipart/form-data请求，该代码会被插入到“Hardware Layer Code Box”中。  `exploit.py` 脚本将一个反向shell的C代码注入到`custom_layer_code`字段中，该反向shell连接攻击者指定的IP地址和端口。
3.  **发送请求：** 将构造的请求发送到/hardware页面。
4.  **触发编译：** 访问/compile-program?file=blank_program.st页面触发代码编译。
5.  **代码执行：**  编译过程会执行注入的恶意代码，从而建立一个反向shell连接，允许攻击者在目标系统上执行任意命令。

**投毒风险分析：**

代码中包含`# FUCK ISRAEL`的注释，这表明作者可能存在政治倾向，但这并不构成技术上的投毒。`exploit.py`脚本本身实现了漏洞利用的功能，没有发现隐藏的恶意代码或后门。它执行的操作完全符合漏洞描述和利用目的。因此，投毒风险评估为0%。需要说明的是，利用漏洞本身就是在目标系统上植入后门，但是这属于漏洞利用的范畴，不属于投毒。

**项目地址:** [Hunt3r0x/CVE-2021-31630-HTB](https://github.com/Hunt3r0x/CVE-2021-31630-HTB)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)