## CVE-2025-7340 HT Contact Form Widget Plugin 未授权任意文件上传

**漏洞编号:** CVE-2025-7340

**漏洞类型:** 任意文件上传

**影响应用:** HT Contact Form Widget Plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.2.1

**利用条件:** 目标系统安装并启用了存在漏洞的HT Contact Form Widget Plugin，且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

根据搜索引擎结果，CVE-2025-7340 存在于 HT Contact Form Widget Plugin 2.2.1 及更早版本中，是一个关键漏洞。提供的漏洞利用代码是一个 Python 脚本，它尝试利用此漏洞进行未经验证的任意文件上传。

**有效性评估：**
该POC脚本的逻辑是：首先从目标页面提取 nonce, ajaxurl 和 form_id, 然后生成一个简单的 PHP webshell，并将其作为文件上传到服务器。如果上传成功，脚本将输出 webshell 的路径。根据脚本的逻辑和漏洞描述，该脚本可能有效。

**投毒风险评估：**
查看了脚本的内容，该脚本主要功能是利用文件上传漏洞，没有发现明显的恶意代码。但是 `shell.php` 的webshell代码存在安全风险, 攻击者可以通过 `cmd` 参数执行任意系统命令，但这部分是漏洞利用的后门代码，而非投毒代码。该脚本创建的webshell文件可以被用于进一步的攻击，因此存在一定风险。考虑到 license 文件的存在， 以及代码较为简单，投毒风险较低。

**利用方式分析：**
1.  **目标识别：** 攻击者需要确定目标系统是否使用了 HT Contact Form Widget Plugin 且版本存在漏洞（<=2.2.1）。
2.  **参数提取：** 攻击者运行提供的 Python 脚本，该脚本会自动从目标页面的 HTML 源代码中提取必要的参数，包括 nonce, ajaxurl 和 form_id。
3.  **webshell 生成：** 脚本会生成一个简单的 PHP webshell 文件（shell.php），该文件允许通过 `cmd` 参数执行系统命令。
4.  **文件上传：** 脚本使用提取的参数，构造一个 POST 请求，将 webshell 文件上传到服务器的临时目录。
5.  **路径获取：** 如果上传成功，服务器会返回上传文件的 ID，脚本会据此构建 webshell 的最终访问路径。
6.  **远程代码执行：** 攻击者可以通过访问 webshell 的 URL，并传递 `cmd` 参数来执行任意系统命令，从而控制服务器。

总而言之，该漏洞利用方式利用了未授权的文件上传漏洞，将恶意webshell上传到目标服务器，最终获取服务器的控制权限。

**项目地址:** [Nxploited/CVE-2025-7340](https://github.com/Nxploited/CVE-2025-7340)

**漏洞详情:** [CVE-2025-7340](https://nvd.nist.gov/vuln/detail/CVE-2025-7340)