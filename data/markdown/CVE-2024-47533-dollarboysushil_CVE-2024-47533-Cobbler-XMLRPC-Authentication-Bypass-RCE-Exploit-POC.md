## CVE-2024-47533-Cobbler XMLRPC 认证绕过 RCE

**漏洞编号:** CVE-2024-47533

**漏洞类型:** 认证绕过/远程代码执行

**影响应用:** Cobbler

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 3.0.0 <= version < 3.2.3 和 3.3.0 <= version < 3.3.7

**利用条件:** 目标Cobbler服务器开放XMLRPC端口(默认25151)，攻击者能够访问此端口

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-47533 存在于 Cobbler 的 XMLRPC 接口中。`utils.get_shared_secret()` 函数始终返回 `-1`，导致可以使用空用户名和密码 `-1` 绕过身份验证，从而允许未经授权的攻击者连接到 Cobbler XMLRPC 接口并执行任意代码。 

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞利用的有效性很高。漏洞库信息明确指出这是一个未经授权的访问漏洞，并给出了受影响的版本范围。搜索引擎结果中大量的文章都确认了该漏洞的存在。提供的漏洞利用代码 `CVE-2024-47533-dbs.py` 演示了如何通过 XMLRPC 接口绕过身份验证并执行命令。

**投毒风险：**

经过分析 `CVE-2024-47533-dbs.py` 脚本，发现其主要功能是利用 Cobbler 的认证绕过漏洞执行命令。脚本中包含多种反弹 shell 的 payload，例如 `bash`、`nc`、`python` 等，这些 payload 都是为了在目标机器上执行恶意代码并建立反向连接。脚本本身看起来没有明显的恶意代码，但如果攻击者修改了脚本，例如添加额外的后门，就存在投毒的风险。在 `README.md`文件中也没有发现任何异常行为。

但需要注意该脚本使用了 `ssl._create_unverified_context()` ，这会禁用 SSL 证书验证，增加了中间人攻击的风险。虽然这不是直接的投毒，但降低了安全性。

因此，总体而言，该存储库的投毒风险较低，约为 1%。主要是因为脚本的目的明确，Payload 也是常见的反弹shell的实现。

**利用方式：**

1.  **确定目标：** 找到运行存在漏洞的 Cobbler 版本的服务器，且 XMLRPC 端口（默认为25151）对外开放。
2.  **运行漏洞利用脚本：** 使用提供的 `CVE-2024-47533-dbs.py` 脚本，指定目标 URL、监听 IP 和端口，以及选择合适的 payload 类型。
3.  **监听连接：** 在攻击机上使用 Netcat 或其他工具监听指定的端口。
4.  **获取 Shell：** 如果漏洞利用成功，攻击者将在监听端口上获得目标服务器的 shell 访问权限。
5.  **利用XMLRPC接口:** 连接到目标Cobbler的XMLRPC接口后,利用background_import函数,通过修改path和name参数来执行任意命令.

**项目地址:** [dollarboysushil/CVE-2024-47533-Cobbler-XMLRPC-Authentication-Bypass-RCE-Exploit-POC](https://github.com/dollarboysushil/CVE-2024-47533-Cobbler-XMLRPC-Authentication-Bypass-RCE-Exploit-POC)

**漏洞详情:** [CVE-2024-47533](https://nvd.nist.gov/vuln/detail/CVE-2024-47533)