## CVE-2022-26134-Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未授权远程代码执行

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标Confluence服务器可访问，且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-26134 是 Atlassian Confluence Server 和 Data Center 中存在的一个 OGNL 注入漏洞。未经身份验证的攻击者可以利用此漏洞在受影响的 Confluence 服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是一个严重的安全问题，并且已被积极利用。提供的 POC 代码旨在利用此漏洞，通过发送包含恶意 OGNL 表达式的 HTTP 请求，在目标系统上执行命令。该 POC 通过检查响应头中是否存在 `X-Cmd-Response` 字段来验证漏洞是否成功利用。如果存在并且状态码为302，则认为存在漏洞，证明该PoC代码是有效的。

**投毒风险：**
该POC主要功能是验证漏洞是否存在，在验证思路上没有发现恶意代码，但是由于代码可以执行任意命令，存在被修改成恶意代码的可能，该代码存在一定的风险。因为代码量较少，经过分析，投毒风险较低，判断为5%。

**利用方式：**
1.  **OGNL 注入：** 漏洞的根本原因是 Confluence 存在 OGNL 注入缺陷。OGNL (Object-Graph Navigation Language) 是一种表达式语言，用于访问和设置 Java 对象的属性。攻击者通过构造恶意的 OGNL 表达式，可以绕过 Confluence 的安全检查，执行任意代码。
2.  **HTTP 请求：** 攻击者构造包含恶意 OGNL 表达式的 HTTP 请求，并将其发送到 Confluence 服务器。具体来说，POC代码构造了一个包含 OGNL 表达式的URL，该表达式会执行 `id` 命令并将结果设置在HTTP响应头`X-Cmd-Response` 中。
3.  **命令执行：** Confluence 服务器在处理该请求时，会解析并执行 OGNL 表达式，从而导致任意代码执行。 在POC中，执行的命令是 `id` 命令，用于获取当前用户的身份信息。
4.  **响应验证：** 攻击者通过检查服务器的响应，判断漏洞是否成功利用。 在POC中，检查HTTP 响应头中是否存在 `X-Cmd-Response` 字段。如果存在，则表示漏洞利用成功。

**项目地址:** [xanszZZ/ATLASSIAN-Confluence_rce](https://github.com/xanszZZ/ATLASSIAN-Confluence_rce)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)