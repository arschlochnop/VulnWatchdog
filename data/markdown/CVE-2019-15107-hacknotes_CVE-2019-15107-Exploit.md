## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 目标主机运行Webmin <= 1.920，且可以网络访问，知道Webmin的端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107是Webmin 1.920版本及之前版本中的一个命令注入漏洞。该漏洞存在于`password_change.cgi`脚本中。攻击者可以通过`old`参数注入恶意命令，从而在服务器上执行任意代码。

**有效性:**
提供的Python POC代码看起来有效。它构造了一个包含恶意命令的请求，并发送到`password_change.cgi`端点。搜索引擎结果也表明存在可用的expolit，rapid7，tenable等多个平台证明该漏洞的存在，侧面佐证poc的有效性。

**投毒风险:**
查看提供的webminExploit.py脚本，脚本主要是通过curl命令发送构造的payload。没有发现任何隐藏的、恶意的后门代码。payload只是执行了用户输入的command参数，不存在其它恶意行为。 因此，评估投毒风险为0%。

**利用方式:**
1.  攻击者首先确定目标主机运行的Webmin版本是否小于等于1.920。
2.  然后，攻击者需要确定Webmin的监听端口（默认为10000）。
3.  攻击者使用提供的POC脚本，指定目标IP地址、端口和要执行的命令。
4.  POC脚本构造一个包含注入命令的HTTP POST请求，发送到`password_change.cgi`。
5.  如果漏洞存在，Webmin服务器将执行注入的命令，并将结果返回给攻击者。

该漏洞利用无需身份验证，可直接远程执行代码。

**项目地址:** [hacknotes/CVE-2019-15107-Exploit](https://github.com/hacknotes/CVE-2019-15107-Exploit)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)