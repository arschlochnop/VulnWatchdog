## CVE-2021-3156 (Baron Samedit)

**漏洞编号:** CVE-2021-3156

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致本地提权至root

**影响版本:** < 1.9.5p2

**利用条件:** 本地用户可执行sudo

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-3156 是 Sudo 1.9.5p2 之前版本中存在的一个堆缓冲区溢出漏洞，也被称为 "Baron Samedit"。该漏洞允许任何本地用户通过 `sudoedit -s` 命令以及以单个反斜杠字符结尾的命令行参数来提升权限至 root。利用方式如下：

1.  **触发条件:**  需要目标系统上存在漏洞版本的 Sudo，且攻击者具备本地用户的权限。
2.  **漏洞触发:** 通过构造特定的 `sudoedit -s` 命令，并提供以单个反斜杠结尾的参数，触发 off-by-one 错误。
3.  **堆溢出:**  off-by-one 错误导致堆缓冲区溢出，覆盖相邻的内存区域。
4.  **权限提升:**  通过精心构造溢出数据，覆盖 Sudo 的内部数据结构，劫持控制流，最终实现以 root 权限执行任意代码。

**有效性:** 根据漏洞库信息、搜索结果，此漏洞影响范围广，危害程度高，存在公开可用的PoC。提供的代码只是一个README.md文件，说明这是一个漏洞研究的资料仓库，**并不能直接作为POC使用**。但基于搜索结果可知该漏洞是可利用的，且存在公开的POC。

**投毒风险:** 提供的漏洞利用代码仓库中仅包含一个 README.md 文件，内容是关于 CVE-2021-3156 漏洞的描述。并没有发现任何实际的可执行代码，因此判断存在投毒代码的可能性极低，几乎可以忽略不计。 风险评估为0%。

**项目地址:** [ret2basic/SudoScience](https://github.com/ret2basic/SudoScience)

**漏洞详情:** [CVE-2021-3156](https://nvd.nist.gov/vuln/detail/CVE-2021-3156)