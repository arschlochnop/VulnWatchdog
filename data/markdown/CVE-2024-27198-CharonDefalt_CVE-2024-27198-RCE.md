## CVE-2024-27198-JetBrains TeamCity Authentication Bypass & RCE

**漏洞编号:** CVE-2024-27198

**漏洞类型:** 身份验证绕过和远程代码执行

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经授权的管理员访问和远程代码执行

**影响版本:** < 2023.11.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27198 存在于 JetBrains TeamCity 中，允许未经身份验证的攻击者绕过身份验证并执行管理员操作。POC 代码通过发送特制的 HTTP 请求到 `/hax?jsp=/app/rest/server;.jsp` 路径来获取 TeamCity 的版本信息，并利用身份验证绕过漏洞。 

该漏洞利用方式主要分为以下几个步骤：

1. **获取 TeamCity 版本和操作系统信息:** POC 代码首先尝试获取 TeamCity 的版本信息和目标服务器的操作系统信息，以便更好地进行后续的漏洞利用。
2. **构造恶意的插件 ZIP 文件:** POC 代码会生成一个包含恶意 JSP 代码的插件 ZIP 文件。该 JSP 代码包含一个简单的 web shell，允许攻击者执行任意命令。
3. **利用身份验证绕过漏洞上传恶意插件:**  通过未经身份验证的 API 接口上传恶意插件，从而实现远程代码执行。
4. **执行任意命令:** 成功上传恶意插件后，攻击者可以通过访问该插件中的 JSP 页面来执行任意命令。

**关于投毒风险的分析：**

该 POC 代码主要包含漏洞利用功能，用于验证和利用 CVE-2024-27198 漏洞。虽然代码中包含生成包含 webshell 的 JSP 文件的部分，但这属于漏洞利用的正常组成部分，不应被视为投毒代码。考虑到代码中可能存在的细微的、难以察觉的后门或者隐藏功能（例如，收集用户信息并发送到恶意服务器等），但可能性较低。因此，投毒风险评估为5%。

**项目地址:** [CharonDefalt/CVE-2024-27198-RCE](https://github.com/CharonDefalt/CVE-2024-27198-RCE)

**漏洞详情:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)