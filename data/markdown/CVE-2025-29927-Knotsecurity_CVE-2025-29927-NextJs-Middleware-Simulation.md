## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感信息和功能

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用 Next.js，且授权检查位于中间件中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 存在于 Next.js 中，允许攻击者绕过中间件中的授权检查。该漏洞源于 Next.js 对 `x-middleware-subrequest` 标头处理不当。攻击者可以通过在请求中添加该标头来跳过中间件的执行，从而绕过授权验证，访问受保护的路由。

**漏洞利用方式：**

1.  攻击者构造包含 `x-middleware-subrequest` 标头的 HTTP 请求。
2.  Next.js 误将该请求识别为内部子请求，跳过中间件的执行。
3.  授权检查被绕过，攻击者可以访问原本需要授权才能访问的资源。

**有效性评估：**

提供的 PoC 代码是有效的，它提供了一个模拟环境来演示如何利用该漏洞，该POC提供了一个验证方法，可以通过burpsuite抓包添加`x-middleware-subrequest: middleware`请求头来验证漏洞。

**投毒风险分析：**

虽然该代码库主要用于漏洞演示，但仍然存在一定的投毒风险。风险点在于：

*   **潜在的恶意依赖：** 虽然目前的依赖看起来是标准的 Next.js 项目依赖，但未来可能被作者添加恶意依赖，例如在 `npm install` 阶段执行恶意脚本。
*   **后门代码：** 作者可能在表面上无害的代码中隐藏后门，例如在看似正常的日志记录或错误处理代码中添加执行任意代码的逻辑。不过根据代码，未发现明显的后门代码

由于代码量较小，且主要用于演示漏洞利用，因此判断投毒风险较低，约为 10%。 但是，在实际使用任何来自不可信来源的代码时，都应该进行彻底的审查和安全审计。

**项目地址:** [Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation](https://github.com/Knotsecurity/CVE-2025-29927-NextJs-Middleware-Simulation)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)