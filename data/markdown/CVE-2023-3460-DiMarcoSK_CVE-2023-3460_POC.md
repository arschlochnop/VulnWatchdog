## CVE-2023-3460-Ultimate Member-权限提升

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member

**危害等级:** 高危，允许未经验证的攻击者创建管理员账户，完全控制网站

**影响版本:** < 2.6.7

**利用条件:** 目标WordPress站点安装了存在漏洞的Ultimate Member插件，并且允许用户注册

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-3460是Ultimate Member WordPress插件中存在的一个权限提升漏洞。该漏洞允许未经验证的攻击者通过注册页面创建具有管理员权限的用户账户，从而完全控制受影响的WordPress网站。

**有效性：**
根据漏洞库信息、搜索结果和提供的Go语言POC代码，该漏洞的POC是有效的。搜索结果表明该漏洞已被积极利用。

**投毒风险：**
代码分析表明，该Go语言POC代码的主要功能是利用漏洞创建管理员账户。它首先获取注册表单的nonce值，然后构造包含管理员权限的注册请求，最后发送该请求到目标站点。该代码本身没有明显的恶意行为，例如文件系统操作或网络连接到其他服务器。README.md中的免责声明表明该PoC仅用于教育和研究目的。LICENSE文件为MIT许可，允许修改和分发。虽然无法100%确定没有隐藏的投毒代码，但是根据代码的功能和明显的意图，投毒的概率很低，故判断投毒风险为1%。

**利用方式：**
1.  攻击者首先确定目标WordPress站点是否安装了易受攻击的Ultimate Member插件版本（低于2.6.7）。
2.  攻击者访问目标站点的注册页面。
3.  攻击者使用提供的POC代码，通过构造恶意的注册请求，创建一个新的管理员账户。请求中包含`wp_capabilities[administrator]=1`，赋予新用户管理员权限。
4.  攻击者使用新创建的管理员账户登录WordPress后台，并完全控制网站。

**总结：**
该漏洞利用的有效性高，投毒风险低，利用方式简单。该漏洞影响严重，应尽快升级Ultimate Member插件到2.6.7或更高版本。

**项目地址:** [DiMarcoSK/CVE-2023-3460_POC](https://github.com/DiMarcoSK/CVE-2023-3460_POC)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)