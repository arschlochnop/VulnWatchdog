## CVE-2022-22963-SpringCloudFunction-RCE

**漏洞编号:** CVE-2022-22963

**漏洞类型:** 远程代码执行(RCE)

**影响应用:** Spring Cloud Function

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Spring Cloud Function 3.1.6, 3.2.2 及所有旧版本

**利用条件:** 需要Spring Cloud Function开启路由功能，且允许用户提供SpEL表达式

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-22963是Spring Cloud Function中的一个远程代码执行漏洞。当开启路由功能时，攻击者可以构造恶意的SpEL表达式，通过路由功能执行任意代码，从而完全控制服务器。该漏洞利用的关键在于SpEL表达式的注入。

**有效性分析：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被公开利用。提供的代码片段是典型的 Spring Boot 项目结构，包含 `pom.xml`，`application.properties`，`DemoApplication.java` 文件，构建了一个使用了 Spring Cloud Function 的 Web 应用。`pom.xml` 文件中指定了 `spring-cloud-function-web` 的版本为 3.2.2，属于受影响的版本范围。因此，该代码可以作为POC的基础。

**投毒风险分析：**
提供的代码片段本身不包含明显的恶意代码。风险主要在于：
1.  `pom.xml`文件可能包含指向恶意软件仓库的依赖项。但目前提供的`pom.xml`仅使用Spring官方仓库。
2.  `DemoApplication.java` 文件中虽然没有直接的恶意代码，但它作为应用程序的入口，如果被替换为包含恶意代码的版本，则可能构成投毒。
3.  `application.properties`如果配置不当，可能会暴露敏感信息。目前为空。

考虑到代码片段的简洁性以及主要依赖来自官方仓库，投毒风险较低，但是不排除人为修改上述文件进行投毒的可能性。综上，将投毒风险评估为5%。

**利用方式：**
1.  攻击者首先需要找到运行着存在漏洞的 Spring Cloud Function 应用程序的服务器。
2.  然后，攻击者通过构造包含恶意 SpEL 表达式的 HTTP 请求，将其作为路由表达式发送到服务器。
3.  服务器在处理该请求时，会解析并执行 SpEL 表达式，从而导致远程代码执行。
4.  攻击者可以使用 SpEL 表达式执行任意系统命令，例如下载并运行恶意软件、修改系统配置等。

根据搜索引擎结果得知，此漏洞的 CVSS 评分为 9.8，属于严重漏洞，可以无需认证即可远程利用。

**项目地址:** [Shayz614/CVE-2022-22963](https://github.com/Shayz614/CVE-2022-22963)

**漏洞详情:** [CVE-2022-22963](https://nvd.nist.gov/vuln/detail/CVE-2022-22963)