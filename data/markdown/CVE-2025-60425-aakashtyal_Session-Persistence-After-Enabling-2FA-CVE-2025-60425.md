## Nagios Fusion 2FA绕过漏洞

**漏洞编号:** CVE-2025-60425

**漏洞类型:** 身份验证绕过

**影响应用:** Nagios Fusion

**危害等级:** 高危，可能导致未经授权的访问和权限提升

**影响版本:** 2024R1.2 和 2024R2

**利用条件:** 用户启用了2FA，并且攻击者拥有在启用2FA之前有效的会话凭证（例如cookie）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

Nagios Fusion 2024R1.2 和 2024R2版本存在一个高危安全漏洞，该漏洞允许攻击者在启用双因素身份验证（2FA）后仍然使用之前有效的会话。具体来说，当为管理员帐户启用2FA时，应用程序未能使在启用2FA之前建立的所有活动会话失效。这使得攻击者或未经授权的用户能够利用旧会话绕过2FA机制并执行未经授权的操作。

**利用方式：**

1.  攻击者在目标用户启用2FA之前获得有效的会话cookie（例如通过网络嗅探、恶意软件、社会工程学等）。
2.  用户启用2FA。
3.  攻击者使用之前捕获的会话cookie访问Nagios Fusion应用程序。
4.  由于应用程序未能使旧会话失效，攻击者可以绕过2FA验证，并以目标用户的身份执行操作，例如修改帐户设置、访问敏感数据等。

**有效性：**

根据漏洞利用代码描述，该漏洞是有效的，因为应用程序没有在启用2FA时使现有会话失效。

**投毒风险：**

该漏洞利用代码只是一个README.md文件，用于描述漏洞。虽然该文件本身不包含任何恶意代码，但仍然存在一些投毒风险：

*   **误导性信息：** 该文件可能包含不准确或误导性的信息，例如夸大漏洞的影响或提供错误的缓解措施。
*   **依赖关系：** 如果该文件引用了其他资源（例如外部链接），这些资源可能包含恶意内容。
*   **供应链攻击：** 如果该文件被用于构建或部署自动化流程，攻击者可能会修改该文件以注入恶意代码。

尽管存在这些风险，但由于该文件主要用于描述漏洞，因此总体投毒风险较低。我估计投毒风险大约为10%。主要风险在于后续的利用过程中,攻击者可能会利用此漏洞进行恶意活动。

**总结：**

该漏洞是一个严重的安全问题，可能导致未经授权的访问和权限提升。建议Nagios Fusion用户尽快升级到2024R2.1或更高版本，并采取其他缓解措施，例如缩短会话生存期和轮换会话密钥。

**项目地址:** [aakashtyal/Session-Persistence-After-Enabling-2FA-CVE-2025-60425](https://github.com/aakashtyal/Session-Persistence-After-Enabling-2FA-CVE-2025-60425)

**漏洞详情:** [CVE-2025-60425](https://nvd.nist.gov/vuln/detail/CVE-2025-60425)