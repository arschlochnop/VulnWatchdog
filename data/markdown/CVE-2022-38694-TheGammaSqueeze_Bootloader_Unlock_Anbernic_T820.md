## CVE-2022-38694 - Unisoc BootROM 漏洞

**漏洞编号:** CVE-2022-38694

**漏洞类型:** BootROM漏洞，Bootloader解锁

**影响应用:** Unisoc SoC

**危害等级:** 高危，可能导致设备完全控制

**影响版本:** 受影响的Unisoc设备BootROM版本

**利用条件:** 需要物理访问设备，安装Unisoc USB驱动

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-38694是一个Unisoc SoC的BootROM漏洞，允许攻击者未经授权解锁Bootloader。根据搜索结果和提供的漏洞利用代码（unlock.bat脚本），利用方式如下：

1.  **漏洞利用方式：**
    *   攻击者需要物理访问目标设备。
    *   安装Unisoc USB驱动，以便计算机能够与设备通信。
    *   设备关机状态下，运行`unlock.bat`脚本。
    *   在脚本运行的30秒内，按住设备的HOME/BACK键并连接USB数据线。
    *   脚本将利用BootROM漏洞覆盖函数指针或返回地址，从而解锁Bootloader。
    *   设备重启后，会提示擦除数据，执行擦除操作即可完成解锁。

2.  **有效性：**
    *   根据搜索结果，尤其是GitHub链接，以及漏洞利用代码中的描述，该POC代码是有效的，可以用来解锁受影响的Unisoc设备的Bootloader。

3.  **投毒风险：**
    *   分析`README.md`和脚本内容，主要风险点在于下载链接和第三方驱动程序。
    *   驱动程序和解锁工具本身可能被篡改，包含恶意代码。即使是原作者也可能存在恶意。
    *   虽然代码参考了`TomKing062/CVE-2022-38694_unlock_bootloader`，但经过修改，增加了潜在的投毒风险。
    *   链接引导用户下载固件，链接可能为钓鱼链接，引导用户下载恶意固件。
    *   `unlock.bat`脚本需要仔细检查，以确认其只执行解锁Bootloader的必要操作，没有执行其他恶意行为。
    *   综合判断，投毒风险存在，评估为10%。主要基于该仓库的代码是针对特定设备修改过的，可能包含后门或恶意代码。
    *   此处的投毒风险主要指该仓库作者在解锁脚本或固件链接中加入恶意代码的可能性，而非POC验证的后门代码。

**项目地址:** [TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820](https://github.com/TheGammaSqueeze/Bootloader_Unlock_Anbernic_T820)

**漏洞详情:** [CVE-2022-38694](https://nvd.nist.gov/vuln/detail/CVE-2022-38694)