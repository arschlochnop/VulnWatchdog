## CVE-2024-0582-Linux Kernel io_uring Use-After-Free

**漏洞编号:** CVE-2024-0582

**漏洞类型:** Use-After-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可能导致权限提升或系统崩溃

**影响版本:** < 6.4.0

**利用条件:** 本地用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0582 是 Linux 内核 io_uring 子系统中的一个 use-after-free 漏洞。攻击者可以通过注册一个 buffer ring, mmap 它，然后释放它，触发漏洞。此漏洞允许本地用户崩溃系统或提升权限。

**有效性：**
根据提供的漏洞信息和搜索结果，以及POC代码，该漏洞利用是有效的。POC代码库提供了两种利用方法：Dirty Cred 和 Dirty Page Table，都旨在利用 io_uring 的 use-after-free 漏洞进行权限提升。

**投毒风险：**
POC代码库中存在一定投毒风险，约为10%。虽然代码描述了两种常见的利用方法，但由于攻击者可以自定义shellcode，并且`Adjust the Offset Values`说明的偏移量需要用户自行查找,如果用户使用了错误的偏移量，可能会导致意料之外的错误，例如内核崩溃，这可以被视为一种隐蔽的拒绝服务攻击形式。此外，尽管代码作者声明仅用于教育和研究目的，但实际使用中仍然存在被恶意利用的可能。代码本身的复杂性也增加了审查难度，存在隐藏恶意代码的可能性。

**利用方式：**
利用方式主要有两种：

1.  **Dirty Cred：** 通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得 `/etc/passwd` 的写权限，然后注入恶意用户条目，实现提权。
2.  **Dirty Page Table：** 同样通过 `io_uring` 注册/注销序列触发页面 use-after-free，获得页表的写权限，然后注入 shellcode 到 `pivot_root` 系统调用，实现提权。

**项目地址:** [kuzeyardabulut/CVE-2024-0582](https://github.com/kuzeyardabulut/CVE-2024-0582)

**漏洞详情:** [CVE-2024-0582](https://nvd.nist.gov/vuln/detail/CVE-2024-0582)