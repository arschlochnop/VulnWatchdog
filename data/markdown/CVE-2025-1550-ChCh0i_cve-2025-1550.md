## CVE-2025-1550-Keras-RCE

**漏洞编号:** CVE-2025-1550

**漏洞类型:** 代码注入

**影响应用:** Keras

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 3.8.0

**利用条件:** 需要上传恶意的.keras文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Keras的`Model.load_model`函数中。攻击者可以通过构造恶意的`.keras`文件，在`config.json`文件中指定恶意Python模块和函数及其参数，在模型加载时执行任意代码，即使启用了`safe_mode=True`。漏洞利用方式如下：

1.  **漏洞原理：** `keras.models.load_model`函数在加载模型时，会解析`.keras`压缩包中的`config.json`文件。该文件描述了模型的结构和参数。攻击者可以修改`config.json`，插入恶意代码。
2.  **POC分析：** `exploit.py`脚本首先生成一个简单的Keras模型，然后读取其`config.json`文件。修改`config.json`，将第一层替换为`subprocess.Popen`的调用，以执行`ls > ./index.html`命令。最后，将修改后的`config.json`写回`.keras`压缩包。
3.  **利用方式：**
    *   攻击者构造包含恶意`config.json`的`.keras`文件。
    *   攻击者将该文件上传到存在漏洞的Keras应用。
    *   应用调用`keras.models.load_model`加载该文件，导致恶意代码执行。
4. **投毒风险分析**
    * 仓库中未发现任何与漏洞利用无关的恶意代码，因此投毒风险为0%。检查模块（check.py）尝试阻止恶意模型的加载，但易于绕过，应用程序（app.py）加载模型时，并未调用检测模块
5. **有效性分析**
    *   根据漏洞信息和利用代码，此漏洞利用的有效性很高。通过修改config.json，可以在模型加载时执行任意代码。

**项目地址:** [ChCh0i/cve-2025-1550](https://github.com/ChCh0i/cve-2025-1550)

**漏洞详情:** [CVE-2025-1550](https://nvd.nist.gov/vuln/detail/CVE-2025-1550)