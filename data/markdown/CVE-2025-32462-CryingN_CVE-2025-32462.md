## CVE-2025-32462-Sudo-权限提升

**漏洞编号:** CVE-2025-32462

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 中危，允许本地用户在错误的机器上以root权限执行命令

**影响版本:** 1.8.8 到 1.9.17p1 (不包含1.9.17p1)

**利用条件:** 需要存在sudoers文件，其中指定了非当前主机或ALL以外的主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32462 是 Sudo 中的一个权限提升漏洞，允许在 sudoers 文件中指定了非当前主机或 ALL 以外的主机时，列出的用户可以在错误的机器上执行命令。根据漏洞库信息和搜索结果，这是一个中危漏洞，利用难度相对较低。利用代码中的Dockerfile尝试创建一个存在漏洞的环境，poc.sh 脚本尝试利用该漏洞。根据代码分析，该漏洞利用方式为：

1.  **配置sudoers:**  创建一个sudoers文件，其中用户被授权在特定主机上执行命令，但该主机不是当前主机或 `ALL`。
2.  **运行PoC:**  poc.sh脚本会读取sudoers文件，查找具有`NOPASSWD:ALL`权限的用户，并尝试使用 `sudo -i -h $user`  来提权，利用漏洞在错误的机器上执行命令。

**有效性评估：**

根据漏洞信息和漏洞利用代码，提供的PoC代码**可能有效**。虽然 README中说明作者未完全测试，但脚本逻辑符合漏洞描述。

**投毒风险评估：**

存在一定的投毒风险。PoC脚本本身相对简单，主要功能是读取`sudoers`文件并尝试利用漏洞。潜在的投毒点包括：

*   **Dockerfile:** Dockerfile下载了特定版本的sudo，虽然看起来是为了复现漏洞，但可能包含其他未知的恶意修改。虽然作者从官方github下载，并验证版本在漏洞版本范围内，但仍然存在风险。
*   **`poc.sh` 脚本:**  脚本中 `check_sudoers` 函数读取 `/etc/sudoers` 文件，如果恶意修改该文件，可能会导致其他问题。当前poc.sh只是用于验证漏洞，本身不具备后门功能。脚本要求root权限运行，也增加了潜在的风险。
*   **依赖外部资源:** 下载特定版本的 Sudo 存在风险，如果该 github 仓库被篡改，下载的 Sudo 可能包含恶意代码。

总体来说，投毒风险较低，约为10%。主要风险在于Dockerfile中的恶意修改或利用过程中对sudoers文件的篡改。

**利用方式总结：**

1.  目标系统必须安装受影响的Sudo版本 (1.8.8 到 1.9.17p1)。
2.  `sudoers` 文件必须包含允许用户在特定主机上执行命令的条目，但该主机不是当前主机或 `ALL`。
3.  攻击者运行PoC脚本，利用漏洞在错误的机器上以目标用户权限执行命令，从而可能提升权限。

**项目地址:** [CryingN/CVE-2025-32462](https://github.com/CryingN/CVE-2025-32462)

**漏洞详情:** [CVE-2025-32462](https://nvd.nist.gov/vuln/detail/CVE-2025-32462)