## CVE-2023-27350-PaperCut NG/MF Authentication Bypass and Remote Code Execution

**漏洞编号:** CVE-2023-27350

**漏洞类型:** 身份验证绕过,远程代码执行

**影响应用:** PaperCut NG/MF

**危害等级:** 极危，可导致完全系统控制

**影响版本:** 22.0.5 (Build 63914), 8.0 及以上，且低于 20.1.7, 21.2.11, 或 22.0.9

**利用条件:** 目标PaperCut服务器可通过网络访问,9191端口开放

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27350是一个存在于PaperCut NG/MF软件中的身份验证绕过漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者绕过身份验证并执行任意代码，获得SYSTEM权限。漏洞存在于SetupCompleted类中，原因是访问控制不当。多个安全厂商和CISA已发布警告，表明该漏洞已被恶意利用。

**有效性分析:**

提供的POC代码 `vuln.py` 主要用于检测目标PaperCut服务器是否存在漏洞，并通过`BeautifulSoup`解析HTML页面以获取版本信息。如果版本在受影响范围内，则脚本会打印易受攻击的信息以及绕过身份验证的URL。`README.md`中提供了利用步骤，包括使用给定的URL绕过身份验证，并利用PaperCut的内置脚本功能执行代码(未在提供的代码中体现，但在描述中提到)。综合来看，该POC代码的有效性较高，可以用来辅助漏洞验证。

**投毒风险分析:**

查看 `vuln.py` 代码，该脚本主要功能是发送HTTP请求、解析HTML并打印信息，未发现明显的恶意代码或后门。脚本依赖于`requests`，`bs4`和`pyfiglet`第三方库，理论上第三方库存在一定投毒风险，但概率较小。`README.md`文件中提供的指令本身不具备投毒行为。因此，综合评估投毒风险较低，约为10%。

**利用方式分析:**

1.  **版本检测:** 使用提供的`vuln.py`脚本检测目标PaperCut服务器的版本。该脚本通过访问`/app?service=page/SetupCompleted`页面，解析HTML获取版本信息。
2.  **身份验证绕过:** 如果版本在受影响范围内，则可以使用`http://<ip>:9191/app?service=page/Dashboard`URL绕过身份验证。
3.  **远程代码执行:** 身份验证绕过后，攻击者可以滥用PaperCut内置的脚本功能来执行任意代码。具体利用方式取决于PaperCut的配置和可用的API，由于未提供具体的执行代码，因此无法详细分析。但根据漏洞信息和搜索结果，执行任意代码是在SYSTEM上下文中进行的。

**项目地址:** [imancybersecurity/CVE-2023-27350-POC](https://github.com/imancybersecurity/CVE-2023-27350-POC)

**漏洞详情:** [CVE-2023-27350](https://nvd.nist.gov/vuln/detail/CVE-2023-27350)