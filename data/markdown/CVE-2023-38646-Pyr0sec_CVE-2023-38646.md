## CVE-2023-38646-Metabase-RCE

**漏洞编号:** CVE-2023-38646

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Metabase

**危害等级:** 高危，允许未经身份验证的攻击者在服务器上执行任意命令

**影响版本:** < 0.46.6.1 (Open Source) 和 < 1.46.6.1 (Enterprise)

**利用条件:** 目标系统运行受影响版本的Metabase，且攻击者能够通过网络访问该Metabase实例。

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2023-38646是一个存在于Metabase的远程代码执行漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许未经身份验证的攻击者在受影响的Metabase服务器上执行任意命令。多个信息来源都确认了此漏洞的存在和高危性，并提供了可利用的POC。漏洞利用方式通常涉及构造恶意的请求，触发Metabase中的反序列化或其他类型的漏洞，从而执行攻击者提供的恶意代码。

**有效性：** 漏洞库信息和多个搜索引擎结果表明存在公开可用的PoC，证明了漏洞的可利用性。

**投毒风险：** 提供的漏洞利用代码只包含Apache License。并没有发现任何直接的投毒代码。通常，投毒可能存在于更复杂的exp或者库的依赖中,例如，一些开发者可能在看似无害的代码中嵌入后门，这些后门在特定条件下被触发，从而允许攻击者远程控制受感染的系统。本次PoC的投毒分析占比为2%。

**利用方式：**

1.  **确定目标：** 确定运行Metabase的服务器，并确认其版本是否在受影响的范围内（低于0.46.6.1的开源版本或低于1.46.6.1的企业版本）。
2.  **构造恶意请求：** 使用已知的PoC或exp构造包含恶意代码的请求。具体的请求格式取决于漏洞的细节，可能涉及发送特制的JSON数据、利用SQL注入或其他类型的漏洞。
3.  **发送请求：** 将构造的恶意请求发送到Metabase服务器的特定端点。
4.  **执行代码：** 如果漏洞利用成功，Metabase服务器将执行攻击者提供的恶意代码，从而允许攻击者控制服务器。


**项目地址:** [Pyr0sec/CVE-2023-38646](https://github.com/Pyr0sec/CVE-2023-38646)

**漏洞详情:** [CVE-2023-38646](https://nvd.nist.gov/vuln/detail/CVE-2023-38646)