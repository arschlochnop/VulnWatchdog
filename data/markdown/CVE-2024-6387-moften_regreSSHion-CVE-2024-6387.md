## CVE-2024-6387-OpenSSH-竞争条件导致RCE/DoS

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 需要目标系统运行受影响的OpenSSH版本，且攻击者能够发起大量连接请求。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-6387是一个OpenSSH服务器(sshd)中的安全回归漏洞，存在于OpenSSH 8.5p1到9.7p1版本。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。远程攻击者可以通过在设定的时间内认证失败来触发此漏洞，可能导致远程代码执行或拒绝服务。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已确认存在，并且有POC代码可用。搜索引擎结果中的多个链接指向了漏洞分析、利用和修复方法，以及相关的讨论。

**投毒风险：**
提供的POC代码包含一个Python脚本（main.py）和一个README.md文件。脚本内容主要用于识别易受攻击的OpenSSH服务器，并无发现任何恶意代码或者后门，但是不排除后续增加投毒代码的可能性, 因此投毒风险极低。

**利用方式：**
1.  攻击者需要发起大量SSH连接到目标服务器。
2.  在LoginGraceTime时间内，故意使认证失败。
3.  利用竞争条件，使sshd以不安全的方式处理信号。
4.  如果成功，攻击者可能能够执行任意代码或导致服务崩溃（拒绝服务）。

**缓解措施：**
*   将OpenSSH升级到9.8或更高版本。
*   设置`LoginGraceTime 0`可以缓解RCE，但不能完全避免DoS攻击，建议结合`fail2ban`和防火墙使用。

**项目地址:** [moften/regreSSHion-CVE-2024-6387](https://github.com/moften/regreSSHion-CVE-2024-6387)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)