## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要克隆包含恶意配置的仓库，并且执行带有漏洞的Git版本。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理配置时对换行符（CRLF）处理不当。当初始化子模块时，如果子模块的路径包含尾随的CR，则读取更改后的路径，导致子模块被检出到错误的位置。如果存在一个符号链接将更改后的路径指向子模块的 hooks 目录，并且子模块包含一个可执行的 post-checkout hook，则在检出后可能会意外执行该脚本。

**有效性：**
根据漏洞描述和PoC代码，该PoC是有效的。攻击者可以通过创建一个包含恶意配置的 Git 仓库，诱导用户克隆该仓库，从而触发漏洞并执行任意代码。

提供的PoC代码包含以下文件：
*   `README.md`: 简单的README文件，用于初始化子模块。
*   `post-checkout`: 一个shell脚本，用于执行任意命令，此处是`echo`和`id`命令。

**投毒风险：**
分析PoC代码，未发现作者隐藏的恶意代码。`post-checkout` 脚本的功能仅为打印 `id` 命令的执行结果，用于验证漏洞的存在。**因此，投毒风险为0%。**

**利用方式：**
1.  攻击者创建一个包含恶意配置的 Git 仓库。该仓库的子模块路径包含尾随CR字符。
2.  攻击者创建一个符号链接，将包含CR字符的子模块路径指向 `.git/hooks` 目录，或者子模块下的 `.git/hooks` 目录。
3.  攻击者将包含恶意代码的 `post-checkout` 脚本添加到子模块的 `.git/hooks` 目录中。
4.  攻击者诱导用户克隆该恶意 Git 仓库。
5.  当用户克隆仓库并初始化子模块时，由于Git对CR字符处理不当，子模块会被检出到错误的位置，同时 `post-checkout` 脚本会被执行，从而导致任意代码执行。

**项目地址:** [Anezatraa/CVE-2025-48384-submodule](https://github.com/Anezatraa/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)