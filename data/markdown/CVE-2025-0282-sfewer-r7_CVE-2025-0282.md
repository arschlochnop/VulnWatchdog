## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 22.7R2.5 (Connect Secure), < 22.7R1.2 (Policy Secure), < 22.7R2.3 (Neurons for ZTA gateways)

**利用条件:** 需要目标主机开放网络访问端口（通常为443或80）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-0282 是 Ivanti Connect Secure, Policy Secure 和 Neurons for ZTA gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，该漏洞已被积极利用（in the wild）。提供的PoC代码基于watchTowr发布的利用策略，并且Rapid7也发布了相关的漏洞分析，表明PoC的有效性较高。

**投毒风险：**
PoC代码主要实现了以下功能：
1.  确定目标产品的版本。
2.  根据版本选择相应的内存地址偏移量（gadget）。
3.  构造包含溢出数据的HTTP请求，其中包含指向内存地址的指针，这些地址指向可用于执行任意代码的指令序列（ROP链）。
4.  发送恶意请求，触发栈溢出，并控制程序执行流程。

PoC代码中存在投毒的可能性较低，但不能完全排除。可能存在的风险包括：
1.  修改ROP链，植入恶意代码，例如下载和执行恶意软件。
2.  修改目标版本判断逻辑，使PoC在不适用的版本上运行，导致拒绝服务或系统崩溃。
3.  在溢出数据中添加额外的shellcode，用于执行恶意操作。
虽然存在理论上的投毒风险，但此PoC看起来较为直接地实现了漏洞利用逻辑。综合考虑，投毒风险估计在5%左右。

**利用方式：**
1.  攻击者首先向目标服务器发送HTTP请求，获取目标产品的版本信息。
2.  PoC脚本根据获取的版本信息选择相应的gadget地址。
3.  PoC脚本构造恶意的HTTP请求，该请求包含精心设计的溢出数据，覆盖栈上的返回地址。
4.  覆盖的返回地址指向ROP链，ROP链中的指令序列被设计为执行特定的操作，例如调用`system()`函数执行任意命令。
5.  目标服务器处理恶意请求时，触发栈溢出，程序执行流程被重定向到ROP链，最终导致任意代码执行。
根据 Palo Alto Networks 的报告，该漏洞与 IFT (IF-T) 连接的处理方式有关。

**优先级排序：**
搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**项目地址:** [sfewer-r7/CVE-2025-0282](https://github.com/sfewer-r7/CVE-2025-0282)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)