## CVE-2023-29360-Microsoft Streaming Service Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2023-29360

**漏洞类型:** 特权提升

**影响应用:** Microsoft Streaming Service (mskssrv.sys)

**危害等级:** 高危，可能导致本地权限提升

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要在受影响的Windows系统上运行POC代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29360是一个Microsoft Streaming Service（mskssrv.sys）驱动程序中的特权提升漏洞。攻击者可以利用此漏洞提升本地权限。

**有效性:**
从提供的漏洞利用代码和博客链接来看，POC代码是有效的。代码实现了对`mskssrv.sys`驱动程序的利用，通过精心构造的IOCTL请求，实现任意地址读写。

**投毒风险:**
代码分析结果显示投毒风险为0%。

*   代码结构清晰，各个函数的功能明确，例如 `InitializeStream`, `PublishTx`, `ConsumeTx`, `DrainTx`等，没有发现隐藏的恶意逻辑。
*   代码主要通过驱动程序通信实现任意地址读写，利用方式较为直接，没有额外的后门或者恶意行为。
*   代码中包含调试信息输出，例如 `std::cout << "[+] Publishing Tx data" << std::endl;`， 这些调试信息表明代码是用于漏洞研究和利用，而非恶意软件。

**利用方式:**
1.  **连接驱动程序:** 使用`CreateFileW`函数连接到`mskssrv.sys`驱动程序。
2.  **初始化流:**  通过`InitializeStream`和`RegisterStream`等函数初始化数据流。
3.  **任意地址读写:**  通过`PublishTx`, `ConsumeTx` 和 `DrainTx` 等函数，结合精心构造的 `FSFrameInfo` 结构体，实现任意地址读写。
    *   `PublishTx` 函数设置要读写的内存地址。
    *   `ConsumeTx` 和 `DrainTx` 函数触发漏洞，实现读写操作。
    *   `FSMemoryStreamArray.switch_case` 的值为 `0xffffffff00000008`时，允许对映射的页面进行读写操作。
4.  **权限提升:** 利用任意地址读写能力，攻击者可以修改内核数据结构，从而提升当前进程的权限。

**项目地址:** [0xDivyanshu-new/CVE-2023-29360](https://github.com/0xDivyanshu-new/CVE-2023-29360)

**漏洞详情:** [CVE-2023-29360](https://nvd.nist.gov/vuln/detail/CVE-2023-29360)