## CVE-2025-32433 - Erlang/OTP SSH Pre-Authentication RCE

**漏洞编号:** CVE-2025-32433

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Erlang/OTP SSH Server

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** OTP-27.3.2及更早版本, OTP-26.2.5.10及更早版本, OTP-25.3.2.19及更早版本

**利用条件:** 目标系统运行受影响版本的 Erlang/OTP SSH 服务器，且攻击者能够建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32433 漏洞存在于 Erlang/OTP SSH 服务器的 pre-authentication 阶段，由于服务器没有正确地强制执行 SSH 协议序列，未经身份验证的远程攻击者可以发送特制的 `SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST` 消息，从而打开一个会话通道并在目标系统上执行任意 Erlang 命令，进而执行系统命令。如果 SSH 守护进程以高权限（例如 root）运行，则成功利用可能导致完全系统入侵。

**有效性评估：**

根据漏洞库信息、搜索结果和提供的PoC代码，该漏洞利用的有效性非常高，CVSS v3.1 评分为 10.0，属于严重级别。大量安全厂商的分析报告（Palo Alto, SonicWall, Keysight, Wiz, Cisco）都证实了该漏洞的存在和潜在危害。

**投毒风险评估：**

PoC 代码主要用于搭建一个存在漏洞的环境，以便进行安全研究和漏洞验证。 代码本身主要是clone指定版本的Erlang/OTP，编译安装，并配置SSH服务，然后启动Erlang的SSH服务。 Dockerfile中没有发现明显的恶意代码或者后门。但是，无法完全排除作者在 `ssh_server.erl` 文件中或克隆的 Erlang/OTP 源代码中植入恶意代码的可能性。因此，存在一定的投毒风险，约为10%。使用此PoC时应在隔离环境中进行，并仔细审查相关代码。

**利用方式分析：**

1.  **环境搭建：** 使用提供的 Dockerfile 构建一个包含漏洞 Erlang/OTP SSH 服务器的环境。Dockerfile 会安装受影响的 Erlang/OTP 版本（例如 26.2.5.10），并生成 SSH 主机密钥。
2.  **漏洞触发：** 利用代码没有直接给出攻击脚本，但根据漏洞描述，攻击者需要构造恶意的 SSH 协议消息（`SSH_MSG_CHANNEL_OPEN` 和 `SSH_MSG_CHANNEL_REQUEST`），在 pre-authentication 阶段绕过身份验证。
3.  **命令执行：** 成功绕过身份验证后，攻击者可以在服务器上执行任意 Erlang 命令。由于 Erlang 代码可以调用系统命令，因此攻击者最终可以在目标系统上执行任意系统命令，实现远程代码执行。

**项目地址:** [NiteeshPujari/CVE-2025-32433-PoC](https://github.com/NiteeshPujari/CVE-2025-32433-PoC)

**漏洞详情:** [CVE-2025-32433](https://nvd.nist.gov/vuln/detail/CVE-2025-32433)