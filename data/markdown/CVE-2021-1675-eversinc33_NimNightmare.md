## CVE-2021-1675 Windows Print Spooler 远程代码执行漏洞

**漏洞编号:** CVE-2021-1675

**漏洞类型:** 远程代码执行

**影响应用:** Windows Print Spooler

**危害等级:** 高危，可能导致系统权限提升和远程代码执行

**影响版本:** 受影响的Windows版本低于漏洞库信息中列出的版本号

**利用条件:** 需要用户权限，目标机器启用Print Spooler服务，且未安装补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-1675 (PrintNightmare) 是一个 Windows Print Spooler 服务中的远程代码执行漏洞。该漏洞允许攻击者在目标系统上以 SYSTEM 权限执行任意代码。根据漏洞利用代码，攻击者需要首先生成一个恶意 DLL 文件，然后使用提供的 `nimnightmare.nim` 脚本将该 DLL 加载到 Print Spooler 服务中。该脚本利用 `AddPrinterDriverEx` 函数来加载恶意的驱动程序DLL。漏洞的利用方式涉及欺骗系统将恶意DLL视为合法的打印机驱动程序，从而允许恶意代码以SYSTEM权限执行。搜索结果表明，该漏洞已被广泛利用，并且存在公开的PoC代码。虽然该代码主要功能是利用漏洞，但存在投毒风险，因为攻击者可能在生成的DLL中植入后门。投毒风险较低(5%),主要风险来自于利用msfvenom生成dll时,加入恶意payload。`nimnightmare.nim`本身代码较为简短,主要功能是加载dll，恶意代码存在于dll中的可能性更高。CISA已将此漏洞添加到已知被利用的漏洞目录中。

**项目地址:** [eversinc33/NimNightmare](https://github.com/eversinc33/NimNightmare)

**漏洞详情:** [CVE-2021-1675](https://nvd.nist.gov/vuln/detail/CVE-2021-1675)