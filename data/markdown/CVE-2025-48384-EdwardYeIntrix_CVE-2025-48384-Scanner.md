## CVE-2025-48384-Git代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户clone包含恶意配置的Git仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 漏洞源于 Git 在处理配置文件时的不一致性，具体来说，Git 在读取配置值时会移除尾部的回车符（CRLF），但在写入时，如果配置值以回车符结尾，则不会对其进行引用。这会导致在稍后读取配置时丢失回车符。

**漏洞利用方式：**

1.  **恶意仓库创建：** 攻击者创建一个恶意的 Git 仓库，其中包含一个`.gitmodules`文件，该文件定义了一个 submodule，其路径包含尾部回车符（CR）。例如：`path = submodule_path\r`。
2.  **符号链接：** 仓库中存在一个符号链接，指向修改后的 submodule 路径到`.git/hooks`目录。这样可以将看似无害的目录路径重定向到 Git 钩子目录。
3.  **恶意钩子：** 仓库中包含一个可执行的`post-checkout`钩子脚本，该脚本会在 checkout 操作后执行。
4.  **诱导用户：** 攻击者诱导受害者克隆（`git clone --recursive`）该恶意仓库。
5.  **代码执行：** 当受害者执行 `git clone --recursive` 时，Git 会尝试 checkout submodule 到错误路径。由于存在符号链接，实际checkout操作会将文件写入到 `.git/hooks` 目录。`post-checkout` 钩子脚本会被执行，从而导致任意代码执行。

**有效性：**
提供的 Python 脚本 `cve_2025_48384_auto_print_scanner.py` 是一个扫描器，用于检测本地或远程 Git 仓库是否存在 CVE-2025-48384 漏洞的潜在利用。它会检查`.gitmodules`文件中是否存在包含尾部回车符或`..`的路径，查找指向`.git/hooks`的符号链接，并列出可执行的钩子脚本，并显示钩子脚本内容。虽然该脚本本身不能直接利用该漏洞，但可以帮助安全研究人员或用户识别潜在的恶意仓库。结合搜索结果，可以确认此漏洞存在可利用性。

**投毒风险：**
代码本身是一个扫描工具，旨在帮助用户识别潜在的漏洞。它没有发现任何主动植入后门或恶意代码的行为。因此，可以认为该代码本身不存在投毒风险。我评估投毒风险为0%。该脚本的目的是分析给定的 Git 仓库，而不是执行任何恶意操作，所以不应该存在投毒代码。

**项目地址:** [EdwardYeIntrix/CVE-2025-48384-Scanner](https://github.com/EdwardYeIntrix/CVE-2025-48384-Scanner)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)