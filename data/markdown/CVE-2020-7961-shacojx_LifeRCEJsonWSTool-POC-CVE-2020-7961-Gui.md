## CVE-2020-7961 Liferay Portal JSONWS反序列化RCE

**漏洞编号:** CVE-2020-7961

**漏洞类型:** 反序列化漏洞

**影响应用:** Liferay Portal

**危害等级:** 高危，远程代码执行

**影响版本:** 7.2.1 CE GA2之前版本

**利用条件:** 需要网络访问，目标开启JSON Web Services (JSONWS)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-7961 漏洞是 Liferay Portal 7.2.1 CE GA2 之前版本中存在的一个反序列化漏洞。攻击者可以通过构造恶意的序列化数据，通过JSON Web Services (JSONWS)接口发送给Liferay服务器，导致服务器执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已经有公开的POC代码。Rapid7、Synacktiv等安全厂商都对此漏洞进行了分析和验证。

**投毒风险：**
提供的POC代码是一个Maven项目，包含以下文件：
*   `README.md`: 包含工具下载链接。
*   `assembly.xml`: Maven Assembly Plugin的描述文件，用于打包包含依赖的jar包。
*   `nbactions.xml`: NetBeans IDE的配置文件，定义了运行、调试和profile actions。
*   `pom.xml`: Maven项目配置文件，定义了项目依赖和构建配置，okhttp3为网络请求库，是比较常规的依赖。
*   `src/main/java/Tool/LRCETool.form`: 图形化界面的描述文件，这暗示该POC很可能是一个GUI工具。

查看所有文件，并未发现存在恶意代码，该POC的作者创建图形化界面,降低了攻击门槛，方便用户使用。考虑到代码的复杂性以及GUI工具可能存在的隐藏操作，存在很小的投毒风险，例如搜集用户信息等，可能性约为5%。

**利用方式：**
根据漏洞描述，攻击者可以通过以下步骤利用该漏洞：
1.  确定目标Liferay Portal版本小于 7.2.1 CE GA2。
2.  构造包含恶意序列化数据的JSON请求。
3.  将该JSON请求发送到Liferay Portal的JSONWS接口（通常是 `/api/jsonws/invoke`）。
4.  Liferay Portal反序列化恶意数据，导致任意代码执行。

Packet Storm Security网站上提供了相关的利用代码和Payload，hackerone也有利用此漏洞的报告。提供的代码仓库像是简化了利用过程，提供了GUI工具，更加方便攻击。

**项目地址:** [shacojx/LifeRCEJsonWSTool-POC-CVE-2020-7961-Gui](https://github.com/shacojx/LifeRCEJsonWSTool-POC-CVE-2020-7961-Gui)

**漏洞详情:** [CVE-2020-7961](https://nvd.nist.gov/vuln/detail/CVE-2020-7961)