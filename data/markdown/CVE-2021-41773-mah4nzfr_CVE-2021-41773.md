## CVE-2021-41773 - Apache HTTP Server Path Traversal and Remote Code Execution

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历和远程代码执行

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且启用了 cgi-bin 目录，Alias配置不当，存在文件系统权限问题。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 版本中。该漏洞是由于路径规范化处理的缺陷导致的路径遍历漏洞，攻击者可以利用该漏洞访问服务器上受限目录之外的文件。如果服务器的 Alias 配置不当，并且文件系统权限设置不合理，攻击者甚至可以通过上传恶意 CGI 脚本来实现远程代码执行。

**有效性：**
提供的 POC 代码看起来是有效的。它利用了路径遍历漏洞，尝试访问 `/bin/sh` 可执行文件，并通过 POST 请求传递包含反向 shell 命令的 DATA。`--path-as-is` 选项确保 curl 不会对 URL 进行规范化，从而允许路径遍历。

**投毒风险：**
漏洞利用代码本身看起来比较直接，目的是触发一个反向shell。`LICENSE`文件正常。
检查以下内容：
1.  **代码混淆：** 代码没有被混淆。
2.  **隐藏命令：** 没有发现隐藏或混淆的命令。
3.  **依赖项：**  该脚本不依赖于任何外部文件或库。
4.  **作者信誉：**  作者的github需要进一步评估，但目前从代码本身看不出明显的恶意。
综合评估，存在投毒代码的可能性较低，估计为 10%。风险主要在于如果攻击成功，攻击者能够在目标系统上执行任意命令，这本身就构成了极大的安全风险。

**利用方式：**
1.  **路径遍历：**  利用 `/.%2e/%2e%2e/` 序列绕过 Apache 的路径访问限制。
2.  **CGI 执行：**  如果 `cgi-bin` 目录已启用，攻击者可以将请求指向该目录。
3.  **反向 Shell：**  通过 POST 请求，攻击者传递一个包含反向 shell 命令的字符串，该命令会在服务器上执行，从而使攻击者获得对服务器的远程访问权限。
4. **payload构造:** 首先构造畸形的URL, 包含`/.%2e/%2e%2e/` 序列, 并指定到系统程序`/bin/sh`, 通过`POST`方法,将需要执行的代码注入到`DATA`变量中.

**总结：**
CVE-2021-41773 是一个严重的安全漏洞，可以被利用进行路径遍历和远程代码执行。提供的 POC 代码可以有效利用此漏洞，但是务必在授权的情况下进行测试。代码本身投毒风险较低，但成功利用漏洞后的风险极高。

**项目地址:** [mah4nzfr/CVE-2021-41773](https://github.com/mah4nzfr/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)