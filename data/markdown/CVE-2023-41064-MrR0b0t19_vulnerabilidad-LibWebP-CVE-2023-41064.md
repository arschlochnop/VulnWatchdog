## CVE-2023-41064-ImageIO-缓冲区溢出

**漏洞编号:** CVE-2023-41064

**漏洞类型:** 缓冲区溢出

**影响应用:** ImageIO (macOS, iOS, iPadOS)

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** iOS/iPadOS < 16.6.1, macOS Monterey < 12.6.9, macOS Ventura < 13.5.2, iOS/iPadOS < 15.7.9, macOS Big Sur < 11.7.10

**利用条件:** 处理恶意构造的图像文件

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2023-41064 是 Apple ImageIO 框架中的一个缓冲区溢出漏洞。处理恶意构造的图像可能导致任意代码执行。根据漏洞信息，该漏洞已经被主动利用。搜索引擎结果表明，该漏洞与 BLASTPASS 攻击有关，可用于绕过 iMessage 沙箱。提供的漏洞利用代码是一个 Python 脚本，旨在创建一个具有特定头部结构的空 WebP 文件。尽管脚本本身并没有明显的恶意代码，但其目的在于生成可能触发漏洞的特定格式文件。README.md中提到，脚本最后运行一个名为“hola_mundo.exe”的外部程序。如果这个程序是恶意的，那么它就构成了投毒风险。代码的有效性依赖于能否成功构造触发 ImageIO 框架中缓冲区溢出的 WebP 文件。由于代码不完整（缺少 write_symbol 函数的具体实现），且 RIFF 和 VP8L 大小被设置为 0，直接运行此代码可能无法达到预期效果。但是，作为 POC，其价值在于展示了构造恶意 WebP 文件头部的一种方法。由于“hola_mundo.exe”的性质未知，且脚本缺少关键的符号写入逻辑，因此存在较高的投毒风险，且利用效果不确定。综合来看，此仓库存在很高的投毒风险，不建议直接使用。利用方式是精心构造的图像绕过apple沙盒机制，并最终导致任意代码执行。

**项目地址:** [MrR0b0t19/vulnerabilidad-LibWebP-CVE-2023-41064](https://github.com/MrR0b0t19/vulnerabilidad-LibWebP-CVE-2023-41064)

**漏洞详情:** [CVE-2023-41064](https://nvd.nist.gov/vuln/detail/CVE-2023-41064)