## CVE-2015-0009 - Group Policy Security Feature Bypass

**漏洞编号:** CVE-2015-0009

**漏洞类型:** 安全特性绕过

**影响应用:** Microsoft Windows (多个版本)

**危害等级:** 高危，允许中间人攻击者绕过安全限制，降级系统安全策略

**影响版本:** Windows Server 2003 SP2, Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT Gold and 8.1

**利用条件:** 需要处于与目标系统相同的网络中，能够进行中间人攻击

**POC 可用性:** 是

**投毒风险:** 50%

## 详情

CVE-2015-0009 漏洞允许攻击者通过中间人攻击篡改组策略更新，从而绕过 SMB 签名要求，将目标机器的组策略设置为默认值，降低系统的安全性。攻击者通过 ARP 欺骗拦截目标机器与域控制器之间的通信，然后使用 `netsed` 工具修改 GptTmpl.inf 文件，破坏数据包的完整性。该漏洞利用的有效性较高，但依赖于成功的中间人攻击。 

**利用方式:**

1.  **ARP 欺骗:** 利用脚本中的 `arpSpoof` 函数，对目标机器和域控制器(一个或多个)进行 ARP 欺骗，截获它们之间的网络流量。
2.  **流量重定向:** 使用 `iptables` 将目标机器请求域控制器 445 端口（SMB）的流量重定向到本地的 446 端口。
3.  **数据包篡改:** 使用 `netsed` 工具监听本地 446 端口，并替换特定的 GptTmpl.inf 文件内容，破坏 SMB 报文。
4.  **策略降级:** 被篡改的数据包导致目标机器的组策略更新失败，从而回退到默认设置，例如禁用 SMB 签名。

**投毒风险分析:**

此POC具有一定的投毒风险。 虽然代码的核心功能是利用漏洞，但攻击者可以修改 `netsed` 替换的内容，将恶意配置注入 GptTmpl.inf 文件中，从而在目标系统上执行恶意操作。 例如，可以修改注册表设置、安装恶意软件或更改其他安全设置。 因此，虽然此漏洞本身是安全绕过漏洞，但利用它的 POC 具有被用于投毒的潜力。

**搜索引擎结果分析:**

搜索引擎结果证实了该漏洞的存在，并提供了漏洞描述、受影响的系统版本、以及相关的安全公告和利用信息。 exploit-db 上的链接 (webpage 4) 明确表明存在可用于利用此漏洞的exploit代码。


**项目地址:** [PhoenixC46/ExploitPOC_MS15-014_CVE-2015-0009](https://github.com/PhoenixC46/ExploitPOC_MS15-014_CVE-2015-0009)

**漏洞详情:** [CVE-2015-0009](https://nvd.nist.gov/vuln/detail/CVE-2015-0009)