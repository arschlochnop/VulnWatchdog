## CVE-2024-50623-Cleo产品-未限制的文件上传漏洞

**漏洞编号:** CVE-2024-50623

**漏洞类型:** 未限制的文件上传漏洞

**影响应用:** Cleo Harmony, VLTrader, LexiCom

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 5.8.0.21

**利用条件:** 需要网络访问，服务端口开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-50623 是 Cleo Harmony、VLTrader 和 LexiCom 产品中存在的一个未限制文件上传漏洞。该漏洞允许攻击者上传恶意文件，例如webshell，从而导致远程代码执行。根据漏洞库信息和搜索结果，该漏洞已经被CISA列入已知被利用漏洞列表（KEV），并且在野外已被积极利用。提供的POC代码尝试通过构造特殊的`Retrieve`请求头，利用`/Synchronization`接口读取服务器上的任意文件（如`/etc/passwd`）。

**有效性：**
POC代码的有效性取决于目标服务器是否存在漏洞以及服务器配置。提供的代码尝试读取`/etc/passwd`文件，如果成功，则表明漏洞存在且可以利用。

**投毒风险：**
POC代码本身非常简单，主要是发送一个带有特定header的GET请求，风险极低。仅有的风险可能在于执行POC代码的主机本身的安全，但POC代码本身不具备主动投毒能力。风险主要来自于执行环境。POC代码只是读取文件内容，不具备写入或者修改文件内容的能力。

**利用方式：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，漏洞的利用方式如下：

1.  **漏洞原理：** Cleo Harmony、VLTrader 和 LexiCom 在处理文件上传和下载时，没有充分验证上传文件的类型和内容，导致可以上传任意文件。
2.  **攻击步骤：**
    *   攻击者构造包含恶意代码的文件（例如，webshell）。
    *   攻击者利用漏洞上传该恶意文件到服务器。
    *   攻击者通过访问上传的恶意文件，执行其中的代码，从而控制服务器。

提供的POC代码并没有直接上传恶意文件，而是利用一个文件读取漏洞去读取目标服务器的文件。这个方式只是验证漏洞是否存在，如果存在的话，可以进一步利用上传恶意文件的方式，去获取服务器权限。

**项目地址:** [congdong007/CVE-2024-50623-poc](https://github.com/congdong007/CVE-2024-50623-poc)

**漏洞详情:** [CVE-2024-50623](https://nvd.nist.gov/vuln/detail/CVE-2024-50623)