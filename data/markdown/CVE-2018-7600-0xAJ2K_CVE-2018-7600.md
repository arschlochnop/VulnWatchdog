## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** Drupal网站开启了用户注册功能，且未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（又名Drupalgeddon2）是一个Drupal核心中的远程代码执行漏洞。攻击者可以通过构造恶意请求，利用Drupal的多个子系统在默认或常见模块配置中存在的输入验证不足问题，执行任意代码。

**有效性：**
提供的POC代码针对的是Drupal 8.x 版本。根据漏洞库信息，此漏洞影响Drupal 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1。Exploit-DB中也存在多个利用此漏洞的PoC，表明该漏洞可被有效利用。搜索结果中也多次提到该漏洞被在野利用。

**投毒风险：**
代码本身的功能是发送恶意请求来执行命令，没有发现明显的投毒行为，比如上传恶意文件或修改系统配置等。但任何远程代码执行漏洞都可能被恶意利用，例如在目标服务器上植入后门。 代码仓库中存在`requirements.txt`文件, 如果攻击者替换了其中的requests包的来源，则存在一定的投毒风险。 因此，将投毒风险评估为5%。

**利用方式：**
1.  **漏洞触发点：** 漏洞存在于用户注册页面，攻击利用`user/register`路径。
2.  **攻击向量：** 攻击者通过修改`element_parents`参数，并构造恶意的`mail`参数，将需要执行的命令传递给Drupal。
3.  **数据构造：** 攻击者构造包含`#post_render`、`#type`、`#markup`的`mail`数组，利用Drupal的渲染机制执行任意命令。
4.  **请求方式：** 使用POST请求，Content-Type为`application/x-www-form-urlencoded`。
5.  **交互式利用：** 该POC提供了一个交互式shell，允许攻击者持续执行命令。

**项目地址:** [0xAJ2K/CVE-2018-7600](https://github.com/0xAJ2K/CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)