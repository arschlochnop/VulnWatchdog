## CVE-2024-25600 - WordPress Bricks Builder 远程代码执行

**漏洞编号:** CVE-2024-25600

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Bricks Builder (WordPress 插件)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 1.9.6

**利用条件:** 目标网站安装了 Bricks Builder 插件，且版本低于或等于 1.9.6

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-25600 是一个存在于 WordPress Bricks Builder 插件中的远程代码执行漏洞。该漏洞允许未经身份验证的攻击者注入并执行任意 PHP 代码。根据漏洞库信息和搜索结果，该漏洞影响 Bricks Builder 1.9.6 及更早版本。提供的漏洞利用代码 (`exploit.py`) 尝试利用此漏洞。

**有效性评估：**
根据提供的漏洞信息和利用代码，该漏洞利用具有较高的有效性。漏洞库信息明确指出这是一个未经身份验证的远程代码执行漏洞，CVSS 评分高达 10 分，表明其严重性。搜索引擎结果也证实了该漏洞的存在和可利用性。POC代码的实现思路是通过向 `/wp-json/bricks/v1/render_element` API 端点发送包含恶意 PHP 代码的请求，利用插件对用户输入验证不足的缺陷，从而执行任意代码。

**投毒风险评估：**
该漏洞利用代码 (`exploit.py`) 主要功能是：
1.  获取 nonce 值，绕过插件的 CSRF 保护。
2.  构造包含恶意 PHP 代码的 JSON payload。
3.  发送 POST 请求到 `/wp-json/bricks/v1/render_element` 端点。
4.  解析响应，提取执行结果。

代码中未发现明显的恶意行为或后门。可能的投毒风险在于作者可能在 payload 中添加隐蔽的后门代码，例如写入 webshell 或修改关键文件。但根据对代码的分析，直接的后门风险较低，更多在于使用者对于执行命令的控制。但是，由于脚本作者的不可信度，以及网络安全领域的零信任原则，判断存在10%的投毒风险。

**利用方式分析：**
1.  **漏洞发现：** 攻击者首先需要确定目标网站是否安装了受影响版本的 Bricks Builder 插件。
2.  **Nonce 获取：** 利用代码首先尝试从目标网站的 HTML 源代码中提取 nonce 值。这个nonce值用于绕过Bricks Builder插件的CSRF保护机制，使得攻击者可以发送恶意的请求。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的 JSON payload。该 payload 被嵌入到 `queryEditor` 字段中，利用 Bricks Builder 在处理查询编辑器时的代码注入漏洞。
4.  **请求发送：** 构造好的 payload 通过 POST 请求发送到 `/wp-json/bricks/v1/render_element` 端点。这个端点负责渲染 Bricks Builder 的元素，但由于漏洞的存在，它可以被用来执行任意 PHP 代码。
5.  **结果提取：** 服务器执行 payload 中的 PHP 代码，并将结果返回。攻击者从响应中提取执行结果。一般通过Exception的方式将结果返回，然后利用正则提取需要的内容。

通过以上步骤，攻击者可以在目标服务器上执行任意 PHP 代码，从而实现远程代码执行。这可能导致服务器被完全控制，数据泄露等严重后果。

**项目地址:** [hy011121/CVE-2024-25600-wordpress-Exploit-RCE](https://github.com/hy011121/CVE-2024-25600-wordpress-Exploit-RCE)

**漏洞详情:** [CVE-2024-25600](https://nvd.nist.gov/vuln/detail/CVE-2024-25600)