## CVE-2025-47812-WingFTP-远程代码执行

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行

**影响应用:** WingFTP Server

**危害等级:** 高危，可导致完整系统入侵

**影响版本:** <= 7.4.4

**利用条件:** 允许匿名登录或具有有效用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-47812是WingFTP Server中的一个远程代码执行漏洞。根据漏洞利用代码和搜索引擎结果，该漏洞是由于不正确的输入验证引起的。攻击者可以通过在用户名中注入NULL字节来绕过密码验证，从而执行任意代码。

**有效性：**
根据提供的POC代码和搜索引擎结果，该漏洞的POC代码是有效的。搜索引擎结果中提到了RCE Security发现了该漏洞，并发布了详细的技术分析报告。POC代码的README.md文件中也包含了漏洞的详细描述和利用方法，并提供了未经身份验证和经过身份验证的利用演示。

**投毒风险：**
该存储库存在一定的投毒风险，主要基于以下几点：
1.  **作者声誉：** 无法验证作者的声誉。尽管提供了许可证文件（MIT License），但这并不能保证代码的安全性。
2.  **代码审查：** 缺乏第三方安全审计。在将此代码投入生产环境之前，应进行彻底的代码审查。
3.  **反弹shell依赖：** 该漏洞利用依赖于反弹shell，这可能会引入额外的风险，因为攻击者可以利用反弹shell进一步入侵系统。因此，判断为10%的投毒风险。

**利用方式：**
1.  **漏洞原理：** 当用户尝试登录时，`c_CheckUser` 函数始终返回 `OK_CHECK_CONNECTION`，而忽略用户名中NULL字节后的所有内容，只要NULL字节之前的部分与现有用户匹配。
2.  **攻击步骤：**
    *   攻击者在用户名中添加NULL字节和额外的值，以绕过密码检查。
    *   系统使用 `strlen()` 函数来获取字符串的大小，但 `strlen()` 只会计算到NULL字节为止的字符。
    *   如果目标启用了匿名登录，则可以使用匿名用户进行攻击。或者，如果已知有效用户名，也可以利用此漏洞。
3.  **利用条件：**
    *   允许匿名登录，或具有有效的用户凭据。
    *   目标用户不需要sudo权限。
4.  **攻击效果：** 成功利用该漏洞可导致远程代码执行，并最终完全控制系统。

**项目地址:** [pevinkumar10/CVE-2025-47812](https://github.com/pevinkumar10/CVE-2025-47812)

**漏洞详情:** [CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)