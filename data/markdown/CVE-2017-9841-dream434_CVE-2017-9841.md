## CVE-2017-9841-PHPUnit远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit < 4.8.28 和 5.x < 5.6.3

**利用条件:** 目标服务器需存在脆弱版本的PHPUnit，且/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 路径可公开访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-9841 漏洞存在于 PHPUnit 框架的 Util/PHP/eval-stdin.php 文件中。攻击者可以通过向该文件发送包含 PHP 代码的 HTTP POST 请求来执行任意 PHP 代码。漏洞利用的有效性很高，因为该漏洞利用简单，且存在公开的 POC 代码。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行存在漏洞版本的 PHPUnit 的 web 应用程序，并且`/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php`文件可以被访问。
2.  **发送恶意请求：** 使用 POST 方法向 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 发送包含恶意 PHP 代码的数据。例如，可以使用 `<?php system('命令'); ?>` 来执行系统命令。
3.  **执行代码：** 如果目标服务器存在漏洞，PHPUnit 将执行 POST 请求中包含的 PHP 代码。

**投毒风险分析：**

代码本身是一个利用漏洞的工具，但存在潜在的投毒风险。例如，在 index.html 中，引用的 js 资源 `https://kit.fontawesome.com/a076d05399.js`如果被篡改，可能导致 XSS 攻击。此外，app.py 中的代码简化了漏洞利用过程，如果被恶意修改，例如在原本执行 `system('id')`的地方改为执行恶意脚本，则可能在使用者不知情的情况下进行攻击。此仓库的 README.md 使用法语，也值得警惕。

综合分析，该仓库存在一定的投毒风险，可能性约为 10%。使用者应当仔细检查代码，确保其安全性。

**项目地址:** [dream434/CVE-2017-9841](https://github.com/dream434/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)