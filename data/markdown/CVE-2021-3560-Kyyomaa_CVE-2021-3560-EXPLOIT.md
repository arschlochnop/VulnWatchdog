## CVE-2021-3560-Polkit权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，允许本地普通用户提升至root权限，导致数据泄露、篡改和系统不可用

**影响版本:** polkit 0.119

**利用条件:** 本地访问，目标系统安装了受影响版本的Polkit

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 允许未经授权的本地用户通过绕过 D-Bus 请求的凭据检查，将其权限提升为 root 用户。漏洞利用方式为：

1.  **漏洞原理：** Polkit 在处理 D-Bus 请求时，由于某些逻辑错误，导致可以绕过权限验证。
2.  **利用方式：** POC 代码通过 `dbus-send` 命令与 `org.freedesktop.Accounts` 服务进行交互，尝试创建用户并设置密码。利用了 Polkit 的漏洞，在权限验证方面出现问题，导致普通用户能够执行需要 root 权限的操作。
3.  **有效性：** 根据漏洞库信息和搜索引擎结果，此漏洞是一个已知的，并且存在公开的利用代码，因此可以判定POC代码有效。
4.  **投毒风险：** 代码本身的功能是创建用户和设置密码，虽然添加了重试和延时机制，但主要目的是为了提高漏洞利用的成功率。`exploit.py` 中存在 `openssl` 命令的使用，理论上可以在此处做手脚, 但整体代码逻辑较为清晰，没有发现明显的恶意代码或后门。`README.md` 中作者也提到了可能存在的bug,代码本身也比较简单，投毒可能性较低，但考虑到网络安全需要谨慎，因此评估投毒风险为10%。 风险主要来自于对`openssl`的调用以及用户输入变量。
5.  **缓解措施：** 升级Polkit到修复版本。


**项目地址:** [Kyyomaa/CVE-2021-3560-EXPLOIT](https://github.com/Kyyomaa/CVE-2021-3560-EXPLOIT)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)