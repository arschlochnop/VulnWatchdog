## CVE-2025-49113 - Roundcube Webmail PHP对象反序列化导致RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 1.5.10 和 1.6.0 - 1.6.10

**利用条件:** 需要已认证的用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113 是一个 Roundcube Webmail 的远程代码执行漏洞，存在于 program/actions/settings/upload.php 文件中。该漏洞是由于对 URL 中的 `_from` 参数验证不足，导致经过身份验证的用户可以利用 PHP 对象反序列化执行任意代码。

**利用方式：**

1.  攻击者需要首先获得 Roundcube Webmail 的有效用户凭据，完成身份验证。
2.  攻击者构造一个恶意的 PHP 对象，该对象在反序列化时会执行任意代码（例如，通过 `proc_open` 函数执行系统命令）。
3.  攻击者将构造的 PHP 对象序列化，并将其作为 `_from` 参数的值，发送到 `program/actions/settings/upload.php` 页面。
4.  Roundcube Webmail 在处理 `upload.php` 时，会将 `_from` 参数的值用于 `session->append()` 函数，由于没有充分的验证，导致反序列化操作。
5.  当用户退出登录或者会话结束时，触发 `session_decode()` 函数，从而触发 `unserialize()` 函数，执行攻击者构造的 PHP 对象，最终实现远程代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的利用是有效的。漏洞利用代码提供了一个可行的 PoC，并且搜索引擎结果也表明该漏洞已被积极利用。

**投毒风险：**

该漏洞利用代码(README.md)本身是一个实验记录，用于记录作者的漏洞复现过程，提供了一个利用框架，其中描述了漏洞原理以及如何使用现有的 PoC 脚本进行利用。它引用了 `fearsoff-org/CVE-2025-49113` 这个github仓库，攻击者可以通过替换该仓库的内容达到投毒的目的。考虑到作者在文件中并没有直接嵌入恶意代码,投毒风险较低，判断存在10%的投毒风险。

**缓解措施：**

1.  立即更新到 Roundcube Webmail 1.5.11 或 1.6.11 及更高版本。
2.  如果无法立即更新，可以通过 WAF、防火墙或重写规则阻止包含 `%22`、`%7C`、`!`、`.` 或控制字节的 `_from` 参数。
3.  在 `php.ini` 中禁用危险函数（`proc_open`、`exec` 等）。
4.  禁用配置面板中的上传功能，并监控日志。

**项目地址:** [5kr1pt/Roundcube_CVE-2025-49113](https://github.com/5kr1pt/Roundcube_CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)