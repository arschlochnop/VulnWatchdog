## CVE-2016-6210 - OpenSSH 用户枚举

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 用户枚举

**影响应用:** OpenSSH

**危害等级:** 低危，仅泄露用户名信息

**影响版本:** OpenSSH < 7.3

**利用条件:** 目标主机开启 SSH 服务且使用了 SHA256 或 SHA512 进行用户密码哈希

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2016-6210 漏洞存在于 OpenSSH 7.3 之前的版本中。当使用 SHA256 或 SHA512 对用户密码进行哈希时，如果用户名不存在，sshd 会使用 BLOWFISH 算法对一个静态密码进行哈希。由于存在这个差异，攻击者可以通过发送大量密码来测量响应时间，从而枚举目标系统上的有效用户名。PoC 代码通过尝试连接到 SSH 服务，并使用一个很长的密码针对不同的用户名进行认证，然后测量连接时间。存在的用户和不存在的用户的连接时间会有明显的差异，从而可以判断用户是否存在。

**有效性：** 根据漏洞信息和搜索引擎结果，该漏洞确实存在，并且存在公开的 PoC 代码。PoC 代码的实现原理与漏洞描述一致，通过时间差来判断用户是否存在，因此PoC代码是有效的。

**投毒风险：**  PoC代码存在较高的投毒风险。因为PoC代码的安装依赖Git仓库下载，而Git仓库可以被篡改。作者可能在代码中植入恶意代码，例如，收集目标主机的指纹信息、尝试其他漏洞利用、或者修改系统文件等。另一个风险是，用户可能下载了恶意修改过的PoC代码，并误以为是官方版本。此外，该PoC代码也可能被滥用，用于非法枚举用户名，因此存在较高的潜在风险。

**利用方式：**

1.  攻击者需要一个目标主机的 SSH 服务的 IP 地址和端口。
2.  攻击者可以选择一个用户名或一个用户名列表。
3.  攻击者运行 PoC 代码，该代码会尝试使用一个非常长的密码连接到 SSH 服务，并测量连接时间。
4.  对于存在的用户，连接时间会比不存在的用户长。
5.  通过比较连接时间，攻击者可以判断用户是否存在。

**项目地址:** [coolbabayaga/CVE-2016-6210](https://github.com/coolbabayaga/CVE-2016-6210)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)