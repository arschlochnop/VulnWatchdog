## CVE-2020-27955 Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** Remote Code Execution

**影响应用:** Git LFS

**危害等级:** 高危，可完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了受影响版本的Git LFS，并且可以克隆恶意仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的远程代码执行漏洞。利用方式是创建一个恶意的git仓库，其中包含一个`.gitattributes`文件，该文件定义了如何处理特定的文件类型。当用户克隆这个仓库时，Git LFS会尝试处理这些文件，从而触发漏洞。攻击者可以在`.gitattributes`文件中插入恶意命令，导致在受害者机器上执行任意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。
2.  受害者克隆该仓库。
3.  Git LFS处理`.gitattributes`文件，执行攻击者插入的恶意代码。

**POC代码分析：**

POC提供了一个复现该漏洞的步骤，包括：

1.  下载存在漏洞的Git-LFS版本。
2.  修改hosts文件，将 `abcall.xyz` 指向攻击者控制的IP地址。
3.  攻击者在 `abcall.xyz` 上监听8888端口（使用nc）。
4.  受害者克隆包含恶意配置的git仓库`https://github.com/z50913/CVE-2020-27955.git`
5.  当受害者克隆仓库时，会执行仓库中的恶意`.gitattributes`配置，连接攻击者的nc监听端口，执行PowerShell反向shell脚本 `revsh_powersh.ps1`，从而获得受害者的shell。

**投毒风险分析：**

仓库 `https://github.com/z50913/CVE-2020-27955.git` 本身就包含漏洞利用代码，不能算作投毒。但恶意git仓库本身存在一定投毒风险：

*   **依赖关系风险：** 仓库可能依赖其他子模块或者hooks，包含进一步的恶意代码，下载者可能不了解依赖关系，引入额外的风险。
*   **更新替换：** 作者后续可能更新仓库内容，替换为更具隐蔽性的恶意代码。
*   **域名控制：** 攻击者控制的域名`abcall.xyz`存在被出售或劫持的风险,潜在的攻击者可能利用该域名进行二次恶意活动。

因此，虽然主要目的是演示漏洞，但仍存在一定的投毒风险。 此处投毒风险评估为10%，因为主要代码是漏洞演示，而非故意隐藏的恶意功能。

**项目地址:** [z50913/CVE-2020-27955](https://github.com/z50913/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)