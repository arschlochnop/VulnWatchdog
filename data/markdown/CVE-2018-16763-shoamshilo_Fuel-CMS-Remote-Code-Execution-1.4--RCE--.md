## CVE-2018-16763-Fuel CMS-RCE

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** Fuel CMS

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** <= 1.4.1

**利用条件:** 需要目标系统运行存在漏洞的Fuel CMS 1.4.1版本，且攻击者可以访问该CMS的页面。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-16763 允许未经身份验证的远程代码执行。漏洞存在于 Fuel CMS 1.4.1 中，通过 `pages/select/` 路径的 `filter` 参数或 `preview/`路径的 `data` 参数，可以执行任意 PHP 代码。\n\n**有效性：**\n提供的 Python 脚本 `exploit.py`  利用了 `pages/select/?filter` 参数的漏洞。脚本首先构造包含 PHP 代码的 payload，该 payload 使用 `system()` 函数执行攻击者提供的命令。然后，脚本通过 HTTP GET 请求将 payload 发送到目标 URL。如果成功，服务器将执行该命令，并将结果返回给攻击者。根据漏洞信息和搜索结果，该POC代码是有效的。\n\n**投毒风险：**\n该脚本的主要功能是利用漏洞执行命令。仔细检查脚本，发现其主要功能是构造并发送payload，然后打印响应。代码中虽然使用了`requests`库，但未发现任何尝试向外部服务器发送敏感信息或下载恶意代码的行为。脚本只是简单地发送一个GET请求并打印响应。唯一潜在的风险是，如果用户不小心将恶意命令作为参数传递给脚本，可能会对目标系统造成损害。考虑到这一点，投毒的概率非常低，大约为1%。\n\n**利用方式：**\n1.  确定目标系统上运行的 Fuel CMS 版本为 1.4.1 或更早版本。\n2.  使用提供的 Python 脚本，指定目标 URL 和要执行的命令。 例如：`python exploit.py -u http://vulnsite.com -c whoami`\n3.  脚本构造一个包含恶意 PHP 代码的 payload。\n4.  脚本向目标 URL 发送 HTTP GET 请求，将 payload 作为 `filter` 参数的值。\n5.  目标系统执行 payload 中的 PHP 代码，从而执行攻击者指定的命令。\n6.  脚本从服务器接收响应，并将结果打印到控制台。

**项目地址:** [shoamshilo/Fuel-CMS-Remote-Code-Execution-1.4--RCE--](https://github.com/shoamshilo/Fuel-CMS-Remote-Code-Execution-1.4--RCE--)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)