## CVE-2022-23082-CureKit-路径遍历

**漏洞编号:** CVE-2022-23082

**漏洞类型:** 路径遍历

**影响应用:** CureKit

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** v1.0.1 <= version <= v1.1.3

**利用条件:** 需要网络访问，并允许用户提供文件路径作为输入

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2022-23082是WhiteSource CureKit v1.0.1到v1.1.3版本中的一个路径遍历漏洞。`isFileOutsideDir` 函数未能正确地过滤用户输入，攻击者可以通过构造包含`../`的恶意路径来访问受限目录之外的文件。根据NVD的数据，该漏洞的CVSS v3.1评分为7.5，属于高危漏洞，主要影响是信息泄露。

**有效性:**
虽然给出的代码片段看起来像一个Jenkinsfile，但与路径遍历漏洞本身没有直接关系。Jenkinsfile定义了构建流程，包括拉取代码、编译、测试和部署等步骤。提供的LICENSE文件也没有直接利用此漏洞的内容。因此，提供的POC代码本身**无法直接验证该漏洞**。

**投毒风险:**
提供的文件只是Jenkinsfile和LICENSE文件。Jenkinsfile通常用于定义构建流程，本身不具备投毒性质。LICENSE文件是Apache 2.0许可协议，与投毒无关。因此，**未发现任何投毒代码**，投毒风险为0%。

**利用方式:**
由于缺乏直接可用的PoC代码，利用方式需要基于漏洞描述来推断：
1.  **确定易受攻击的API端点：** 找到CureKit中调用`isFileOutsideDir` 函数的API端点，该函数接收用户提供的文件路径作为输入。
2.  **构造恶意路径：**  构造包含`../`的恶意文件路径，例如`../../../../etc/passwd`。攻击者通过控制输入到`isFileOutsideDir`函数的路径，使其能够读取到预期目录之外的文件。
3.  **发送请求：**  向易受攻击的API端点发送包含恶意路径的请求。
4.  **验证漏洞：**  检查响应，确认是否能够读取到预期之外的文件内容。如果能够读取到`/etc/passwd`等敏感文件，则说明漏洞成功利用。

总之，要成功利用此漏洞，需要找到使用 `isFileOutsideDir` 函数且允许用户提供文件路径的API端点，并构造恶意的payload。

**项目地址:** [shoucheng3/whitesource__curekit_CVE-2022-23082_1-1-3](https://github.com/shoucheng3/whitesource__curekit_CVE-2022-23082_1-1-3)

**漏洞详情:** [CVE-2022-23082](https://nvd.nist.gov/vuln/detail/CVE-2022-23082)