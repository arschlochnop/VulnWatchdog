## CVE-2024-7954-SPIP-porte_plume插件-远程代码执行

**漏洞编号:** CVE-2024-7954

**漏洞类型:** 远程代码执行

**影响应用:** SPIP porte_plume插件

**危害等级:** 高危，未经身份验证的攻击者可以执行任意PHP代码

**影响版本:** 小于4.3.0-alpha2, 小于4.2.13, 小于4.1.16

**利用条件:** 目标系统运行受影响的SPIP版本，并且porte_plume插件已启用。攻击者需要能够通过网络访问目标系统。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-7954是SPIP porte_plume插件中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求执行任意PHP代码。

**利用方式：**

1.  攻击者构造一个包含恶意PHP代码的HTTP POST请求，该请求的目标是`/index.php?action=porte_plume_previsu`，并包含一个特殊的`data`参数。`data`参数包含经过编码的PHP代码，SPIP会解析并执行这段代码。
2.  PoC代码通过`send_poc_request`函数向目标URL发送包含恶意PHP代码的POST请求。
3.  服务器执行恶意代码，攻击者通过响应获取命令执行结果。

**投毒风险评估：**

尽管提供的PoC代码可以用于验证漏洞，但存在一些潜在的投毒风险。例如，攻击者可能修改PoC代码，使其在成功利用漏洞后执行额外的恶意操作，如安装后门、上传恶意文件或修改系统配置。例如:
* 代码中存在`LOG_DIR`和`LOG_FILE`变量，PoC会将扫描信息记录到日志文件中，攻击者可能利用该功能记录敏感信息。
* `clean_host`函数可能存在绕过，攻击者可以构造恶意URL，导致PoC无法正常工作。
* PoC的`User-Agent`是固定的，攻击者可以通过修改`User-Agent`来隐藏攻击行为。
* PoC的`timeout`参数设置得比较大，攻击者可以通过修改`timeout`参数来控制PoC的扫描速度。

综合来看，虽然PoC的主要功能是验证漏洞的存在，但攻击者可以利用PoC中的一些功能来达到其他的攻击目的。我给出的投毒风险评估是10%。

**项目地址:** [bigb0x/CVE-2024-7954](https://github.com/bigb0x/CVE-2024-7954)

**漏洞详情:** [CVE-2024-7954](https://nvd.nist.gov/vuln/detail/CVE-2024-7954)