## CVE-2024-43425-Moodle-RCE

**漏洞编号:** CVE-2024-43425

**漏洞类型:** 远程代码执行

**影响应用:** Moodle

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.1.12, 4.2 < 4.2.9, 4.3 < 4.3.6, 4.4 < 4.4.2

**利用条件:** 需要能够添加/更新问题的权限，可能需要登录。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-43425是Moodle中计算题型处理不当导致远程代码执行漏洞。攻击者通过构造恶意的计算题，可以在服务器上执行任意代码。根据漏洞库信息，利用此漏洞需要能够添加/更新问题的权限，这意味着攻击者可能需要首先获得Moodle账户或者具有相应权限。搜索引擎结果显示，该漏洞已被公开讨论，并且存在可用的利用代码。提供的漏洞利用代码是一个Python脚本，它尝试利用该漏洞。代码首先进行登录，然后提取`sesskey`和`course_id`，最后创建一个包含恶意代码的计算题。由于代码中存在许多步骤来获取凭据和权限，并且可能需要在问题创建页面修改特定值，因此利用成功率可能不高。但是，只要Moodle实例存在漏洞并且攻击者具有必要的权限，该漏洞就可以被成功利用。在提供的漏洞利用代码中，风险较低，但不能完全排除作者植入后门代码的可能性。代码整体结构较为清晰，没有明显的恶意行为，但仍然需要人工代码审计。

**项目地址:** [Snizi/Moodle-CVE-2024-43425-Exploit](https://github.com/Snizi/Moodle-CVE-2024-43425-Exploit)

**漏洞详情:** [CVE-2024-43425](https://nvd.nist.gov/vuln/detail/CVE-2024-43425)