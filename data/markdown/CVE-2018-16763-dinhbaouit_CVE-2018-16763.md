## CVE-2018-16763-FUEL CMS-远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** FUEL CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 1.4.1

**利用条件:** 目标系统运行 FUEL CMS 1.4.1 并且网络可达

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-16763 允许未经身份验证的攻击者通过 `pages/select/` 的 `filter` 参数或 `preview/` 的 `data` 参数执行任意 PHP 代码。 

**有效性分析：**
提供的 Exploit-DB 链接（47138）和搜索结果中的网页表明该漏洞是真实存在的，并且存在公开的利用代码。提供的 python 脚本 `exploit.py` 似乎是一个可用的 PoC。

**投毒风险分析：**
查看提供的 `exploit.py` 代码，它从用户获取命令并将其注入到 URL 中，通过 `filter` 参数传递给服务器。 代码本身逻辑比较简单，直接使用了 `urllib.quote` 对命令进行 URL 编码，没有发现隐藏的恶意代码或后门。 同时检查了 `README.md` 和 `assets/image.png`（虽然没有提供图片文件），未发现任何可疑之处。因此，投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意 PHP 代码的 URL，并将该 URL 作为 `filter` 参数的值发送到 `fuel/pages/select/` 接口。 
2.  FUEL CMS 在处理请求时，会对 `filter` 参数进行 PHP 代码的 eval 解析，从而执行攻击者提供的恶意代码。
3.  攻击者可以通过执行任意 PHP 代码来获取服务器的控制权。

攻击流程：
```
cmd = input('cmd:')
burp0_url = url + "/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27" + urllib.quote(cmd) + "%27%29%2b%27"
```

此 PoC 通过 `system()` 函数执行 shell 命令。



**项目地址:** [dinhbaouit/CVE-2018-16763](https://github.com/dinhbaouit/CVE-2018-16763)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)