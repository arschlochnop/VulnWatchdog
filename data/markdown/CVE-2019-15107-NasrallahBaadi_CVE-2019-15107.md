## CVE-2019-15107 Webmin 1.920 远程命令执行

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 目标系统运行Webmin服务，且版本小于等于1.920，攻击者需要能够访问Webmin服务

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-15107漏洞存在于Webmin <=1.920版本的password_change.cgi文件中。'old'参数存在命令注入漏洞，未经身份验证的攻击者可以通过构造恶意的'old'参数，执行任意系统命令。根据提供的POC代码，攻击者可以通过发送包含恶意命令的POST请求到/password_change.cgi，从而在目标服务器上执行命令。

**漏洞利用方式：**

1.  攻击者构造包含恶意命令的HTTP POST请求，目标URL为 `/password_change.cgi`。
2.  在POST请求的`old`参数中，注入恶意命令。例如：`old=2|echo ""; <恶意命令>`。
3.  Webmin服务器处理请求时，由于未正确过滤`old`参数，导致恶意命令被执行。
4.  攻击者通过执行命令获取敏感信息或控制服务器。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，可以判断该POC代码是有效的。漏洞库信息中明确指出该漏洞的存在，搜索结果中也有大量关于该漏洞的讨论和利用方法。POC代码也提供了相应的利用脚本，可以执行任意命令或获取反向shell。

**投毒风险：**

分析提供的POC代码，未发现明显的恶意投毒代码。 代码主要功能是利用 Webmin 的命令注入漏洞执行用户指定的命令或获取反向 shell。唯一的风险点在于，反向 shell 的 IP 地址和端口由用户输入，如果用户输入了错误的或者被劫持的 IP 地址，可能会连接到恶意服务器。但是这个不属于作者投毒，而是用户自身的操作风险。
文件README.md和exploit.py内容一致，没有发现可疑代码。

因此，投毒风险很低，约为 1%。


**项目地址:** [NasrallahBaadi/CVE-2019-15107](https://github.com/NasrallahBaadi/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)