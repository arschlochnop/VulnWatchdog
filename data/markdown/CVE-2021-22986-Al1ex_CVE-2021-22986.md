## CVE-2021-22986-F5 BIG-IP/BIG-IQ-远程命令执行

**漏洞编号:** CVE-2021-22986

**漏洞类型:** 远程命令执行

**影响应用:** F5 BIG-IP/BIG-IQ

**危害等级:** 高危，可导致完全控制系统

**影响版本:** BIG-IP 16.0.x before 16.0.1.1, 15.1.x before 15.1.2.1, 14.1.x before 14.1.4, 13.1.x before 13.1.3.6, 12.1.x before 12.1.5.3; BIG-IQ 7.1.0.x before 7.1.0.3, 7.0.0.x before 7.0.0.2

**利用条件:** 目标系统存在漏洞版本，且iControl REST接口可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-22986 是 F5 BIG-IP 和 BIG-IQ 设备中 iControl REST 接口的一个未经验证的远程命令执行漏洞。攻击者可以发送特制的 HTTP 请求到 `/mgmt/tm/util/bash` 接口，在目标系统上执行任意命令。

**有效性:**
根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开可用的PoC代码。提供的PoC代码通过构造包含命令的JSON数据，发送POST请求到目标URL的`/mgmt/tm/util/bash`接口，从而执行命令。代码中包含了验证模式、攻击模式、批量检测模式和反弹shell模式，验证了其有效性。

**投毒风险:**
PoC代码本身主要功能是利用漏洞执行命令，投毒风险较低。但依旧存在一定投毒风险：
1.  **默认认证信息:** 代码中硬编码了 `Authorization: Basic YWRtaW46QVNhc1M=` 默认认证信息（admin:ASasS），若目标系统仍使用此默认密码，则漏洞利用成功概率更高，但这也可能被攻击者利用，如果攻击者修改了目标系统的配置,可能会影响正常的业务.
2.  **反弹shell风险:**  反弹shell功能如果被恶意利用，可能在受害者不知情的情况下建立连接。
3.  **脚本作者风险:**  作者 Al1ex@Heptagram 的真实意图未知，可能在未来版本中添加恶意代码. 总体投毒风险预估为10%。

**利用方式:**
1.  确定目标F5 BIG-IP/BIG-IQ设备的版本在受影响范围内。
2.  使用PoC脚本，指定目标URL，并选择验证模式或攻击模式。
3.  在攻击模式下，指定要执行的命令。反弹shell模式可用于建立反向shell连接。
4.  对于批量检测，提供包含目标URL的文件。
5.  运行PoC脚本，利用漏洞执行命令。

**项目地址:** [Al1ex/CVE-2021-22986](https://github.com/Al1ex/CVE-2021-22986)

**漏洞详情:** [CVE-2021-22986](https://nvd.nist.gov/vuln/detail/CVE-2021-22986)