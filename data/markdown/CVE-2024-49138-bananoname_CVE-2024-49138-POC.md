## CVE-2024-49138 - Windows CLFS 提权漏洞

**漏洞编号:** CVE-2024-49138

**漏洞类型:** 权限提升

**影响应用:** Windows Common Log File System (CLFS) Driver

**危害等级:** 高危，本地权限提升

**影响版本:** 受影响的Windows版本详见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-49138 是 Windows Common Log File System (CLFS) 驱动程序中的一个权限提升漏洞。根据漏洞库信息和搜索结果，该漏洞允许攻击者在受影响的系统上提升权限。CISA 已将其添加到已知被利用的漏洞目录中，表明该漏洞已被积极利用。

**有效性：**

根据 MrAle98 在 GitHub 上的 POC 代码（[webpage 5 begin]），该漏洞已被积极利用。POC 代码的存在进一步证实了该漏洞的可利用性。

**投毒风险：**

查看提供的 POC 代码（CVE-2024-49138-POC.cpp），虽然代码整体上看起来是漏洞利用的实现，但仍存在一些潜在的投毒风险。例如，resource.h文件未提供，不清楚是否存在恶意代码。 代码中包含许多Windows API调用和内核地址偏移量，如果这些偏移量被篡改，可能会导致拒绝服务或系统不稳定。综合来看，投毒风险较低，大约为 10%。

**利用方式：**

根据综合信息分析，利用方式如下：

1.  **漏洞成因：** 漏洞是由于 CLFS 驱动程序中存在堆缓冲区溢出（Heap-based Buffer Overflow，CWE-122）问题。
2.  **利用步骤：**
    *   攻击者需要首先获得对目标系统的本地访问权限。
    *   攻击者使用特制的 CLFS 日志文件或者利用代码触发漏洞，导致堆缓冲区溢出。
    *   攻击者通过精心构造溢出数据，覆盖内核内存中的关键数据结构，如进程令牌（Token）。
    *   攻击者将当前进程的令牌替换为具有更高权限（如 SYSTEM 权限）的令牌。
    *   攻击者从而以更高的权限执行任意代码，实现权限提升。

总的来说，该漏洞的利用需要攻击者具备一定的漏洞分析和利用能力，需要了解Windows内核的内部机制和数据结构。

**项目地址:** [bananoname/CVE-2024-49138-POC](https://github.com/bananoname/CVE-2024-49138-POC)

**漏洞详情:** [CVE-2024-49138](https://nvd.nist.gov/vuln/detail/CVE-2024-49138)