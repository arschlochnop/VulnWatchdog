## CVE-2023-50164-Apache Struts-路径遍历/远程代码执行

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 2.0.0 <= version <= 2.5.32
6.0.0 <= version <= 6.3.0.1

**利用条件:** 需要目标系统使用存在漏洞的Apache Struts版本，且存在文件上传功能。需要网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-50164是Apache Struts中的一个严重漏洞，允许攻击者操纵文件上传参数以实现路径遍历。在某些情况下，这可能导致上传恶意文件，从而导致远程代码执行（RCE）。

**漏洞利用有效性：**
根据漏洞库信息、搜索结果，该漏洞利用POC已公开，且已被观察到实际利用。

**投毒风险：**
提供的漏洞利用代码只是Apache License 2.0的license文件,无任何攻击代码,可以确定不存在投毒。

**利用方式：**
1.  **路径遍历：** 攻击者通过修改文件上传的参数，例如文件名，使其包含路径遍历字符（如`../`），从而能够将文件上传到服务器上的任意位置。
2.  **恶意文件上传：** 攻击者上传一个包含恶意代码的文件，例如JSP文件或者其他类型的可执行文件。
3.  **远程代码执行：** 攻击者通过访问上传的恶意文件，触发其中的恶意代码，从而在服务器上执行任意命令。

**缓解措施：**
*   升级到Struts 2.5.33或Struts 6.3.0.2或更高版本。
*   实施严格的文件上传验证，包括文件名检查、文件类型检查和文件大小限制。
*   配置Web服务器，限制对上传目录的访问权限。


**项目地址:** [snyk-labs/CVE-2023-50164-POC](https://github.com/snyk-labs/CVE-2023-50164-POC)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)