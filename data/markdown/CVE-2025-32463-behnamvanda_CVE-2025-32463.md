## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取Root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，目标系统Sudo版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `--chroot` 选项和用户可控的 `/etc/nsswitch.conf` 文件获取 root 权限。

**利用方式：**

1.  **创建恶意 nsswitch.conf:** PoC利用脚本首先会创建一个包含恶意配置的 `nsswitch.conf` 文件，该文件指定了 passwd 数据库的查找路径为一个用户可控的目录，例如 `/vanda`。
2.  **构建恶意共享库:**  PoC利用脚本编译一个共享库 `vanda.so.2`。这个共享库包含一个构造函数 `x()`，该函数在库加载时执行，将当前进程的 UID 和 GID 设置为 0 (root)，然后执行 `/bin/sh`。 
3.  **使用 Sudo --chroot:** 脚本创建一个目录结构，其中包含恶意的 `nsswitch.conf` 和共享库。然后，它使用 `sudo -R vanda vanda` 命令，在 chroot 环境中使用恶意 `nsswitch.conf` 加载恶意的共享库，从而提升权限到 root。

**有效性评估：**

根据漏洞信息、搜索引擎结果和提供的 PoC 代码，可以判断该 PoC 代码是有效的，因为它利用了 Sudo 的 `--chroot` 选项的缺陷，允许加载用户控制的 `nsswitch.conf` 和共享库，从而实现本地权限提升。

**投毒风险评估：**

对提供的PoC代码进行分析后，没有发现任何明显的恶意代码或后门。该脚本的目的就是利用漏洞提权，没有其他隐藏的恶意行为。因此，可以认为该 PoC 代码的投毒风险为 0%。

**项目地址:** [behnamvanda/CVE-2025-32463](https://github.com/behnamvanda/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)