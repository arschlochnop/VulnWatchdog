## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，允许本地攻击者获得SYSTEM权限

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 (受影响版本详见漏洞库信息)

**利用条件:** 需要在受影响的Windows系统上以本地用户身份运行

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个Windows Hyper-V NT Kernel Integration VSP 中的权限提升漏洞。该漏洞是由于堆缓冲区溢出导致，攻击者可以利用此漏洞在本地获取SYSTEM权限。

**有效性分析：**
根据漏洞信息、搜索结果和提供的POC代码，此漏洞被CISA列入已知被利用漏洞目录（KEV），表明该漏洞在野外已被积极利用。提供的POC代码是一个Visual Studio项目，包含源代码文件，以及详细的README文件。这些都表明该漏洞存在可利用的POC。

**投毒风险分析：**
从提供的POC代码来看，主要包含以下几个部分：

*   **CVE-2025-21333-POC.sln：** Visual Studio解决方案文件，用于组织和管理项目中的文件。
*   **README.md：** 包含漏洞的描述、利用方法、所需资源和免责声明，其中下载链接指向github仓库，较为可信。
*   **CVE-2025-21333-POC.cpp：** 包含漏洞利用的C++源代码。代码本身比较复杂，涉及到Windows API的调用，如IORING API、WNF API等。代码中存在内存操作，如果操作不当，可能会导致系统崩溃，但没有发现明显的恶意代码。
*   **Hexdump.hpp: ** 辅助代码,方便调试.
*   **wnf.h: ** 辅助代码，操作wnf状态数据.

在 `CVE-2025-21333-POC.cpp` 文件中,代码主要包含头文件引用,以及对ioringapi.h,tlhelp32.h,DbgEng.h,aclapi.h,wnf.h的调用,初步判断没有明显的恶意投毒代码，但是考虑到代码的复杂性以及对底层系统的操作，存在潜在的风险，因此判断存在10%的投毒风险。

**利用方式分析：**

1.  该漏洞是Hyper-V NT Kernel Integration VSP中的一个堆缓冲区溢出漏洞。
2.  攻击者通过操纵WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY来触发漏洞。
3.  通过精心构造的payload，攻击者可以覆盖内核内存，从而提升权限到SYSTEM。
4.  利用需要编译和执行POC代码，需要一定的技术能力。
5.  成功利用该漏洞后，攻击者可以在受影响的系统上执行任意代码，获得完全控制权。


**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)