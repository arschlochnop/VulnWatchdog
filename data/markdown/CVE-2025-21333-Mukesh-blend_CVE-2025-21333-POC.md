## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆缓冲区溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致SYSTEM权限获取

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本。

**利用条件:** 需要本地权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个Windows Hyper-V NT内核集成VSP中的权限提升漏洞。该漏洞源于NT内核集成VSP组件中的堆缓冲区溢出。本地攻击者可以利用此漏洞获得SYSTEM权限。

**有效性评估:**

根据漏洞描述、搜索结果，以及提供的POC代码，可以判断此漏洞的POC是有效的。reddit上ExploitDev的讨论和POC代码库的存在均表明漏洞的可利用性。

**投毒风险分析:**

评估POC代码是否存在投毒风险，需要对代码进行安全审计。从提供的代码片段来看，它主要包含以下组成部分：

*   Visual Studio Solution File (.sln)：用于构建项目的配置文件，本身不包含可执行代码。
*   README.md：包含漏洞描述、利用方法、资源链接等信息，本身不包含可执行代码。需要注意其中的链接，确保下载的资源是可信的。
*   C++ 源代码 (.cpp)：包含漏洞利用的实际代码。需要仔细审查代码逻辑，特别是涉及到内存操作、系统调用等敏感操作的部分。

代码中涉及WNF状态数据和I/O ring IOP_MC_BUFFER_ENTRY，表明该漏洞可能通过操纵内核对象来实现。由于代码量较大，无法在此次评估中进行完整的代码审计，因此无法完全排除投毒的可能性。可能存在一些隐藏的恶意代码，例如后门、数据窃取等。代码里有从EPROCESS结构体获取Token,PID等敏感信息，有替换Token的操作，这些都是提权操作，不是投毒行为。

考虑到代码来源和代码复杂性，以及缺乏完整的代码审计，保守估计存在10%的投毒风险。

**利用方式分析:**

根据漏洞信息和POC描述，利用方式大致如下：

1.  **触发漏洞：** 利用 Hyper-V NT Kernel Integration VSP 中的缺陷，构造恶意的输入数据，触发堆缓冲区溢出。
2.  **控制溢出：** 通过精心设计的payload，覆盖堆中的关键数据结构，例如内核对象，实现对内核执行流的控制。
3.  **提升权限：** 覆盖EPROCESS结构体中的Token，将当前进程的权限提升为SYSTEM权限。
4.  **执行恶意代码：** 在SYSTEM权限下，执行攻击者预先准备好的恶意代码，例如植入后门、窃取数据等。
5. 搜索结果也提及该漏洞影响主机操作系统和容器类型的虚拟机之间的通讯组件。

总而言之，这是一个本地提权漏洞，攻击者需要在目标系统上具有一定的权限才能利用。成功利用该漏洞后，攻击者可以获得SYSTEM权限，从而完全控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)