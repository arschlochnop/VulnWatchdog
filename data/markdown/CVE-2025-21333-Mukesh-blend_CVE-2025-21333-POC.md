## CVE-2025-21333-Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升（Elevation of Privilege）/ 堆缓冲区溢出（Heap-based Buffer Overflow）

**影响应用:** Windows Hyper-V NT Kernel Integration VSP

**危害等级:** 高危，可导致本地攻击者获得 SYSTEM 权限

**影响版本:** 受影响版本包括但不限于Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2等，版本详见漏洞库信息

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞，具体原因是堆缓冲区溢出。CISA已将其列入已知被利用漏洞目录。POC 代码显示，利用涉及 WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY。从提供的代码片段来看，poc.cpp文件包含利用漏洞所需的代码，包括对Windows API的调用，例如`CreateIoRing`、`NtQuerySystemInformation`等，以及用于提权的逻辑。README.md描述了如何使用POC，包括编译和运行。漏洞利用方式是利用Hyper-V的NT Kernel Integration VSP组件中的堆缓冲区溢出，攻击者可以利用此漏洞获得SYSTEM权限。该漏洞的PoC代码已经公开。投毒风险较低，因为公开的POC代码逻辑相对清晰，但仍存在少量风险：

1.  **复杂性隐藏后门：** 由于内核漏洞利用通常非常复杂，攻击者可能在复杂的代码逻辑中隐藏后门，使其难以被发现。
2.  **依赖项投毒：**  虽然未发现直接的投毒代码，但如果该POC依赖于外部库或组件，这些依赖项可能存在投毒的风险。
3.  **供应链攻击：** 攻击者可能通过污染开发环境或构建过程来注入恶意代码。

因此，虽然POC本身看起来是直接的漏洞利用，但必须对所有依赖项和构建过程进行彻底审查，以确保没有隐藏的恶意代码。谨慎评估使用风险，在隔离环境中使用。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)