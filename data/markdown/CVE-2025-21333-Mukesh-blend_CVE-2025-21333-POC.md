## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升

**影响应用:** Windows Hyper-V

**危害等级:** 高危，允许本地攻击者获取 SYSTEM 权限

**影响版本:** Windows 10 21H2 (版本 10.0.19043.0 到 10.0.19044.5371), Windows 11 22H2 (版本 10.0.22621.0 到 10.0.22621.4751), Windows 10 22H2 (版本 10.0.19045.0 到 10.0.19045.5371), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows 11 23H2 (版本 10.0.22631.0 到 10.0.22631.4751), Windows Server 23H2 (版本 10.0.25398.0 到 10.0.25398.1369), Windows 11 24H2 (版本 10.0.26100.0 到 10.0.26100.2894), Windows Server 2025 (版本 10.0.26100.0 到 10.0.26100.2894)

**利用条件:** 本地访问，需要 Guest 虚拟机环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 的权限提升漏洞，攻击者可以利用此漏洞通过Guest虚机提升至Host主机SYSTEM权限。根据漏洞库信息和搜索结果，这是一个堆缓冲区溢出漏洞。POC代码显示利用了WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。

**漏洞利用方式：**

1.  利用Guest虚机访问Hyper-V服务。
2.  通过精心构造的WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY触发堆缓冲区溢出。
3.  覆盖内核数据，从而获得 SYSTEM 权限。

**有效性：**

根据搜索结果和POC代码，该漏洞利用的POC已经存在，并且被CISA列入已知被利用的漏洞目录，表明该漏洞很可能已经被广泛利用。

**投毒风险：**

虽然POC代码主要关注漏洞利用，但仍需谨慎评估投毒风险。由于POC代码涉及到系统底层操作，存在作者在代码中添加恶意后门的可能性。通过分析代码，发现一些变量名和函数名称较为隐晦，可能存在隐藏的恶意逻辑。但是从整体的利用流程来看，添加后门的代码会影响利用的稳定性，因此投毒风险的概率较低，预估为10%。需要进一步的分析和调试才能确定是否存在恶意代码。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)