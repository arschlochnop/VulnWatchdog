## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆缓冲区溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致SYSTEM权限获取

**影响版本:** Windows 10 21H2 (versionStartIncluding: 10.0.19043.0, versionEndExcluding: 10.0.19044.5371)
Windows 11 22H2 (versionStartIncluding: 10.0.22621.0, versionEndExcluding: 10.0.22621.4751)
Windows 10 22H2 (versionStartIncluding: 10.0.19045.0, versionEndExcluding: 10.0.19045.5371)
Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)
Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751)
Windows 11 23H2 (versionStartIncluding: 10.0.22631.0, versionEndExcluding: 10.0.22631.4751)
Windows Server 23H2 (versionStartIncluding: 10.0.25398.0, versionEndExcluding: 10.0.25398.1369)
Windows 11 24H2 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)
Windows Server 2025 (versionStartIncluding: 10.0.26100.0, versionEndExcluding: 10.0.26100.2894)

**利用条件:** 需要本地访问权限

**POC 可用性:** 是

**投毒风险:** 99%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞，由堆缓冲区溢出导致。攻击者可以利用此漏洞获得 SYSTEM 权限。根据漏洞库信息，该漏洞影响多个 Windows 版本，包括 Windows 10, Windows 11 和 Windows Server。搜索结果表明该漏洞已被公开披露，并且CISA已将其添加到已知被利用漏洞目录中，存在可用的利用代码。提供的POC代码是一个 Visual Studio 解决方案，包含 C++ 源代码，利用 WNF状态数据和I/O ring IOP_MC_BUFFER_ENTRY 触发堆缓冲区溢出。

**有效性评估：**
根据搜索结果和漏洞利用代码，该漏洞的POC是可用的，并且已经被CISA标记为已知被利用的漏洞，证明该漏洞是有效的。

**投毒风险：**
由于POC代码来源于第三方，并且需要编译执行，存在潜在的投毒风险。 风险包括但不限于：
1.  **恶意代码注入：** POC代码可能包含后门、病毒或其他恶意代码。
2.  **供应链攻击：** 开发者环境可能被入侵，导致生成的POC代码包含恶意代码。
3.  **信息收集：** POC代码可能在未经授权的情况下收集系统信息并上传。
因此，该POC代码存在较高的投毒风险。

**利用方式分析：**
该漏洞的利用方式涉及以下步骤：
1.  **环境准备：** 在受影响的 Windows Hyper-V 环境中准备编译和运行 POC 代码的环境。
2.  **代码编译：** 使用 Visual Studio 编译提供的 C++ 源代码。
3.  **漏洞触发：** 运行编译后的可执行文件，利用 WNF状态数据和I/O ring IOP_MC_BUFFER_ENTRY 触发堆缓冲区溢出。
4.  **权限提升：** 成功触发漏洞后，攻击者可以获得 SYSTEM 权限。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)