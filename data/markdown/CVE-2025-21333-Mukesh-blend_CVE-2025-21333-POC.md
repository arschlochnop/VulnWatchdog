## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 权限提升漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 权限提升/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致SYSTEM权限提升

**影响版本:** Windows 10 21H2, Windows 11 22H2, Windows 10 22H2, Windows Server 2025, Windows 11 23H2, Windows Server 23H2, Windows 11 24H2 等受影响版本

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (Virtual Service Provider) 中的权限提升漏洞。该漏洞是由于 NT 内核集成 VSP 中存在堆缓冲区溢出造成的，攻击者可以利用此漏洞获得 SYSTEM 权限。

**有效性评估：**

根据漏洞描述和搜索结果，该漏洞是一个已知的、存在被利用的漏洞，CISA 已将其添加到已知被利用的漏洞目录中。 Reddit的帖子也表明有人发布了POC。提供的POC代码是一个Visual Studio解决方案，包含C++源代码，这进一步表明该漏洞是可以被利用的。readme描述利用了WNF state data 和 I/O ring IOP_MC_BUFFER_ENTRY，指向了具体利用的技术细节。

**投毒风险评估：**

评估POC代码的投毒风险需要仔细分析代码。从提供的代码片段来看，代码主要涉及Windows API调用，包括内存操作、对象操作、线程管理和进程管理等。初步分析没有发现明显的恶意代码或后门。但是考虑到漏洞利用代码本身的复杂性以及缺乏完整代码，存在一定的投毒风险，例如：

*   **隐蔽的权限提升：** 代码可能包含不易察觉的后门，在提权后执行恶意操作，例如安装恶意软件或收集敏感信息。
*   **代码注入：** 恶意代码可能会注入到其他进程中，从而绕过安全检测。
* **依赖风险:** readme中的链接可能指向恶意网站或包含恶意软件的下载链接。

虽然不能完全排除投毒的可能性，考虑到漏洞利用的复杂性，作者隐藏恶意代码的概率较低，因此暂定投毒风险为10%。

**利用方式分析：**

1.  **漏洞触发：** 攻击者利用Hyper-V NT Kernel Integration VSP中的漏洞，该漏洞位于内核态驱动中，允许从虚拟机内部触发。
2.  **堆溢出：** 利用特定的输入或操作，触发堆缓冲区溢出，覆盖相邻的内存区域。搜索结果表明是Paged Pool中的heap-based buffer overflow
3.  **权限提升：** 通过控制溢出的内容，例如覆盖内核对象或函数指针，攻击者可以将自己的权限提升到SYSTEM。
4.  **执行恶意代码：** 获得SYSTEM权限后，攻击者可以执行任意代码，例如安装恶意软件、窃取数据或控制系统。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)