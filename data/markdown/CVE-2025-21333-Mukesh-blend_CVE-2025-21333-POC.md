## CVE-2025-21333 - Windows Hyper-V NT Kernel Integration VSP Elevation of Privilege Vulnerability

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 特权提升/堆缓冲区溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可导致本地权限提升至SYSTEM

**影响版本:** Windows 10 21H2/22H2, Windows 11 22H2/23H2/24H2, Windows Server 2022 23H2, Windows Server 2025 (具体版本范围见漏洞库信息)

**利用条件:** 本地访问，需要运行Hyper-V的Windows环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP 特权提升漏洞，属于堆缓冲区溢出类型。攻击者可以利用此漏洞在本地获得 SYSTEM 权限。

**有效性：**

根据漏洞库信息和搜索结果，该漏洞已被CISA列入已知被利用漏洞目录(KEV)，表明该漏洞具有实际的利用价值。提供的POC代码是一个 Visual Studio 解决方案，包含了 exploit 代码，可以编译并运行来触发漏洞。README.md 文件也说明了如何编译和使用该 exploit。综合来看，该漏洞的POC代码应该是有效的。

**投毒风险：**

代码片段中虽然未直接发现恶意代码，但以下因素表明存在一定的投毒风险：

*   **完整性未知：**  代码片段仅为部分代码，无法完整评估整个项目的安全性。攻击者可能将恶意代码隐藏在未提供的文件中。例如，利用I/O环的机制进行shellcode注入。
*   **编译环境依赖：**  需要特定的编译环境 (Visual Studio) 才能编译和运行 POC 代码，攻击者可以利用编译过程引入恶意代码。
*   **免责声明：**  仓库中包含免责声明，这通常表示代码具有一定的风险。

因此，虽然提供的代码片段本身没有明显的投毒特征，但考虑到完整性未知和潜在的编译风险，投毒风险不能完全排除，估计为 10%。

**利用方式：**

该漏洞是 Hyper-V 的 NT Kernel Integration VSP 组件中的一个堆缓冲区溢出漏洞。利用方式通常包括以下步骤：

1.  **触发漏洞：**  通过特定的 Hyper-V 操作或者与 NT Kernel Integration VSP 组件的交互来触发堆缓冲区溢出。
2.  **控制溢出：**  精心构造输入数据，以便在堆上溢出，覆盖相邻的内存区域。根据README.md，此POC使用WNF状态数据和I/O环IOP_MC_BUFFER_ENTRY。
3.  **权限提升：**  通过覆盖特定的内核数据结构（例如当前进程的Token），将当前进程的权限提升到 SYSTEM 权限。
4.  **执行恶意代码：**  利用 SYSTEM 权限执行任意代码，从而完全控制受影响的系统。根据一些搜索结果表明是paged pool的堆缓冲区溢出。

总而言之，这是一个高危的本地权限提升漏洞，需要及时修补。

**项目地址:** [Mukesh-blend/CVE-2025-21333-POC](https://github.com/Mukesh-blend/CVE-2025-21333-POC)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)