## CVE-2024-45519 - Zimbra Collaboration Suite 远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 8.8.15 Patch 46之前, 9.0.0 Patch 41之前, 10.0.9之前, 10.1.1之前

**利用条件:** 目标服务器开放SMTP端口（通常是25）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-45519 允许未经身份验证的攻击者在受影响的Zimbra服务器上执行任意命令。该漏洞位于`postjournal`服务中。攻击者可以通过构造特殊的SMTP请求，在`RCPT TO`命令中注入恶意代码，从而执行操作系统命令。根据漏洞利用代码，攻击者将构造一个包含反向shell命令的base64编码的字符串，并通过SMTP协议发送到目标服务器。`exploit.py`脚本展示了如何利用此漏洞，包括生成随机电子邮件地址、生成base64编码的反向shell命令、连接到SMTP服务器、发送经过精心构造的SMTP命令。投毒风险评估为10%，主要依据是代码中存在生成随机邮箱地址的行为，这可能会在实际攻击中隐藏攻击者的身份，从而增加溯源难度。但总体而言，漏洞利用代码的目的明确，功能相对独立，因此判定为高度投毒的可能性较低。

**利用方式：**

1.  **确定目标：** 找到运行易受攻击的Zimbra Collaboration Suite版本的服务器，并确定SMTP端口（默认为25）是否开放。
2.  **准备反向shell：** 确定攻击者的IP地址和端口，用于接收来自目标服务器的反向shell连接。
3.  **生成payload：** 使用漏洞利用代码生成包含反向shell命令的base64编码的payload。该payload会被注入到`RCPT TO`命令中。
4.  **发送SMTP请求：** 使用脚本或手动发送构造好的SMTP请求到目标服务器。该请求会利用`postjournal`服务的漏洞。
5.  **获取shell：** 如果攻击成功，攻击者将在其指定的IP地址和端口上接收到反向shell连接，从而控制目标服务器。

**项目地址:** [Chocapikk/CVE-2024-45519](https://github.com/Chocapikk/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)