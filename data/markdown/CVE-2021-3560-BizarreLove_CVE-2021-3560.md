## CVE-2021-3560-Polkit-权限提升

**漏洞编号:** CVE-2021-3560

**漏洞类型:** 权限提升

**影响应用:** Polkit

**危害等级:** 高危，可能导致提权至root权限，控制系统

**影响版本:** polkit 0.119 及受影响的 Linux 发行版

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-3560 漏洞存在于 Polkit 中，允许未经授权的本地攻击者通过绕过 D-Bus 请求的凭据检查，将其权限提升到 root 用户。根据漏洞库信息和搜索引擎结果，该漏洞影响 polkit 0.119 版本，并且已被广泛利用。提供的 POC 代码通过 D-Bus 与 Polkit 交互，利用漏洞提升权限。利用过程大致如下：

1.  **连接 D-Bus：** POC 代码首先连接到系统 D-Bus。
2.  **构造恶意消息：** 构造一个特定的 D-Bus 消息，目标是 org.freedesktop.Accounts 服务，利用漏洞绕过权限验证。
3.  **利用漏洞：** 成功发送消息后，攻击者可以执行特权操作，例如创建新的管理员用户或修改系统配置。
4. **投毒风险分析:** POC代码包含了一些常规操作，如连接D-Bus、构造和发送消息，并未发现明显恶意代码或后门，但仍存在一定风险。check函数中存在检测操作系统版本及policykit版本的操作，如果check函数被篡改，可能导致未受到漏洞影响的系统被判定为存在漏洞，从而诱导用户执行提权操作。 另外，`cve-2021-3560_poc.c` 编译需要链接 `libdbus-1.so` 和 `libz.so`库，攻击者可能诱导用户链接恶意库文件实现代码注入。

**有效性：** 根据漏洞信息和公开的利用代码，该漏洞利用是有效的，并且已被CISA列入已知被利用漏洞目录。

**利用方式：** 攻击者可以利用此漏洞获取 root 权限，从而完全控制受影响的系统。


**项目地址:** [BizarreLove/CVE-2021-3560](https://github.com/BizarreLove/CVE-2021-3560)

**漏洞详情:** [CVE-2021-3560](https://nvd.nist.gov/vuln/detail/CVE-2021-3560)