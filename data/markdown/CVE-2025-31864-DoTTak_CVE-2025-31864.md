## CVE-2025-31864-Beam me up Scotty-存储型XSS

**漏洞编号:** CVE-2025-31864

**漏洞类型:** 存储型XSS

**影响应用:** Beam me up Scotty – Back to Top Button WordPress插件

**危害等级:** 中危，允许高权限用户注入恶意脚本，影响所有访问页面的用户

**影响版本:** <= 1.0.23

**利用条件:** 需要具有管理员权限的WordPress用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31864是一个存储型XSS漏洞，存在于Beam me up Scotty – Back to Top Button WordPress插件的1.0.23及更早版本中。攻击者需要拥有WordPress管理员权限，才能利用该漏洞。

**有效性：**
提供的POC代码是有效的。它演示了如何通过修改`beam_me_up_scotty_bottom_indentation`参数来注入恶意JavaScript代码。由于插件对用户输入的数据没有进行充分的验证和转义，导致存储的XSS漏洞。

**投毒风险：**
该POC代码主要演示XSS漏洞的利用，虽然看起来比较直接，但不能完全排除投毒风险。例如，`README.md`中的图片链接可能指向恶意网站，或者隐藏细微的字符编码问题。对该仓储的投毒风险预估为10%。

**利用方式：**
1.  攻击者需要拥有WordPress管理员权限。
2.  攻击者访问 ‘back to top button’ 的自定义设置页面 ( `/wp-admin/themes.php?page=beam-me-up-scotty_settings` )。
3.  攻击者通过拦截请求，修改`beam_me_up_scotty_bottom_indentation`参数的值，注入XSS payload。
4.  保存设置后，所有访问包含‘back to top button’页面的用户都会受到XSS攻击，执行攻击者注入的JavaScript代码。

**漏洞分析：**
该漏洞是由于插件在处理‘back to top button’的自定义设置时，没有对用户输入进行充分的验证和转义。具体来说，`beam_me_up_scotty_bottom_indentation`参数的值被直接插入到HTML的`<style>`标签中，导致攻击者可以注入恶意的CSS和JavaScript代码。动态生成CSS的 `/wp-content/plugins/beam-me-up-scotty/library/includes/dynamic-css.php` 没有做任何的escape处理。

**项目地址:** [DoTTak/CVE-2025-31864](https://github.com/DoTTak/CVE-2025-31864)

**漏洞详情:** [CVE-2025-31864](https://nvd.nist.gov/vuln/detail/CVE-2025-31864)