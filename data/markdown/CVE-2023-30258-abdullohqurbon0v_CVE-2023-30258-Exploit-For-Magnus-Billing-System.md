## CVE-2023-30258-MagnusBilling-命令注入

**漏洞编号:** CVE-2023-30258

**漏洞类型:** 命令注入

**影响应用:** MagnusBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 6.x, 7.x

**利用条件:** 需要网络访问目标MagnusBilling服务器，且服务器存在漏洞。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-30258是MagnusBilling 6.x和7.x版本中的一个命令注入漏洞。该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意操作系统命令。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，该漏洞利用代码是有效的。 搜索引擎结果中Rapid7, Wiz.io等知名安全公司都提到了该漏洞，并说明了其严重性，Github上也存在相关的POC脚本，表明该漏洞具备可利用性。提供的Python脚本通过向`/mbilling/lib/icepay/icepay.php`发送包含恶意payload的GET请求，从而实现命令注入。

**投毒风险：**
该POC代码的投毒风险较低，约为1%。该脚本的主要功能是利用命令注入漏洞执行反弹shell。虽然反弹shell本身具有一定的风险，因为它允许攻击者远程控制受害系统，但是提供的脚本相对简单，没有明显的恶意代码或隐藏功能。
风险点在于如果攻击者修改脚本，例如增加文件上传、恶意文件下载等功能，则可能增加投毒风险。因此，在使用任何公开的漏洞利用代码时，都应进行彻底的代码审计，确保其安全性。

**利用方式：**
1.  **确定目标:** 找到运行MagnusBilling 6.x或7.x版本的服务器。
2.  **准备攻击环境:** 设置一个监听端口，例如使用`nc -lvnp <attacker_port>`。
3.  **执行POC:** 运行提供的Python脚本，替换目标IP地址、攻击者IP地址和监听端口。
4.  **获取Shell:** 如果漏洞利用成功，将在攻击者的监听端口上获得一个反弹shell。然后，攻击者可以使用此shell执行任意命令，例如查看、修改或删除文件，甚至控制整个系统。

该漏洞的利用方式简单直接，且无需身份验证，因此危害较高。

**项目地址:** [abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System](https://github.com/abdullohqurbon0v/CVE-2023-30258-Exploit-For-Magnus-Billing-System)

**漏洞详情:** [CVE-2023-30258](https://nvd.nist.gov/vuln/detail/CVE-2023-30258)