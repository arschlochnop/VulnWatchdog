## CVE-2024-36991-Splunk Enterprise-路径遍历

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**利用条件:** Splunk Enterprise 运行在 Windows 系统上，且攻击者可以访问 /modules/messaging/ 接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-36991 是一个 Splunk Enterprise on Windows 平台的路径遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件。根据漏洞信息和搜索结果，该漏洞影响 Splunk Enterprise on Windows 版本低于 9.2.2、9.1.5 和 9.0.10 的版本。漏洞存在于 `/modules/messaging/` 接口。提供的Nuclei模版POC代码尝试通过构造包含`../`的恶意URL，访问`/etc/passwd`文件。根据提供的POC代码内容，该仓库中没有发现作者隐藏的投毒代码。利用方式为发送特制的HTTP GET请求到`/modules/messaging/`端点，利用路径遍历绕过访问控制，读取服务器上受限的文件。

**总结利用方式：**

1.  **目标确认：** 确认目标 Splunk Enterprise 服务运行在 Windows 系统上，且版本受漏洞影响。
2.  **构造 Payload：** 构造包含多个 `../` 的 URL，指向目标文件。例如：`{{BaseURL}}/en-US/modules/messaging/C:../C:../C:../C:../C:../etc/passwd`。
3.  **发送请求：** 通过 HTTP GET 方法将构造好的 URL 发送给 Splunk Enterprise 服务器的 `/modules/messaging/` 接口。
4.  **验证结果：** 如果返回状态码为 200，且响应内容包含目标文件的内容，则表示漏洞利用成功。 示例：`/etc/passwd` 文件包含 `root:x:0:0:root:/root:/bin/bash` 或 `admin:`。


**项目地址:** [sardine-web/CVE-2024-36991](https://github.com/sardine-web/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)