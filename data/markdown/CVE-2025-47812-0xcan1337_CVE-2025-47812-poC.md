## CVE-2025-47812 - Wing FTP Server 远程代码执行

**漏洞编号:** CVE-2025-47812

**漏洞类型:** 远程代码执行

**影响应用:** Wing FTP Server

**危害等级:** 高危，可获取root权限

**影响版本:** 未知，但根据搜索结果，可能影响较新的版本

**利用条件:** 需要能够访问Wing FTP Server的Web界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-47812 是 Wing FTP Server 中的一个严重漏洞，允许攻击者获得完整的 root 访问权限。此漏洞的 PoC 脚本的工作原理如下：

1.  **漏洞分析：** 该漏洞利用了 Wing FTP Server 在处理用户名时存在的 null 字节注入漏洞。通过在用户名中注入 null 字节（`%00`），可以截断用户名，并在其后注入 Lua 代码。
2.  **利用方式：** PoC 脚本首先构造一个包含恶意 Lua 代码的用户名。该 Lua 代码使用 `io.popen()` 函数执行任意系统命令，并将命令输出返回。然后，脚本使用 `requests` 库向 `/loginok.html` 发送 POST 请求，其中用户名包含注入的 Lua 代码。成功利用漏洞后，服务器会返回一个包含用户 UID 的 Cookie。
3.  **获取 UID：** 脚本解析服务器返回的 HTTP 响应头，提取 `Set-Cookie` 中的 `UID` 值。此 UID 用于后续的请求。
4.  **/dir.html 请求：** 脚本使用获取的 UID，向 `/dir.html` 发送 POST 请求。服务器执行注入的命令，并将结果包含在响应中。
5.  **PoC 有效性：** 根据搜索结果和 PoC 代码，此漏洞利用具有较高的有效性，因为提到了 null 字节注入漏洞。
6.  **投毒风险：** 审查提供的 PoC 代码后，未发现明显的投毒代码。PoC 的目的是为了验证漏洞和执行命令，虽然存在执行任意命令的风险，但这是漏洞利用本身的性质，而不是作者故意添加的恶意代码。所有执行的命令都来自用户输入，而不是硬编码在脚本中。因此，投毒风险评估为 0%。脚本本身包含获取反向shell的payloads，这些payloads通过用户输入ip和端口，不能认为是投毒行为。
7.  **搜索引擎结果：** 搜索引擎结果证实了 CVE-2025-47812 的存在，并表明这是一个严重的 null 字节注入漏洞，允许攻击者获得 root 权限。
8.  **结论：** 漏洞利用的有效性较高，投毒风险低。漏洞利用方式是通过 null 字节注入，在用户名中注入 Lua 代码，从而执行任意系统命令。

**项目地址:** [0xcan1337/CVE-2025-47812-poC](https://github.com/0xcan1337/CVE-2025-47812-poC)

**漏洞详情:** [CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)