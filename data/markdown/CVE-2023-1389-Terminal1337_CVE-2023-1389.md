## CVE-2023-1389 - TP-Link Archer AX21 Command Injection

**漏洞编号:** CVE-2023-1389

**漏洞类型:** 命令注入

**影响应用:** TP-Link Archer AX21 (AX1800)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 1.1.4 Build 20230219 之前的所有版本

**利用条件:** 需要在同一网络或通过Web管理界面远程访问，且设备存在漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以进行以下分析：

1.  **有效性：**
    *   漏洞库信息明确指出 TP-Link Archer AX21 (AX1800) 的固件版本 1.1.4 Build 20230219 之前存在命令注入漏洞。
    *   搜索引擎结果表明该漏洞已被广泛利用，甚至被用于 Botnet 传播。
    *   提供的漏洞利用代码（Loader POC）看起来是有效的，因为它提供了利用该漏洞的步骤，包括扫描目标IP、监听 Netcat 以及运行 Go 语言编写的 Exploit。

2.  **投毒风险：**
    *   `README.md` 文件只包含漏洞描述和使用方法。
    *   `go.mod` 和 `go.sum` 文件是 Go 语言的模块管理文件，本身不包含可执行代码。
    *   `list.txt` 文件包含大量 IP 地址，可能是潜在的受害者。虽然它本身不包含恶意代码，但用于大规模扫描和利用漏洞可能造成危害。
    *   `main.go` (代码未提供)如果包含将目标设备加入僵尸网络的代码，则存在投毒风险。假设 `main.go` 有 10% 的概率包含恶意投毒代码。

3.  **利用方式：**
    *   该漏洞位于 Web 管理界面的 `/cgi-bin/luci;stok=/locale` 端点，在 country 表单中存在命令注入漏洞。
    *   攻击者可以通过发送包含恶意命令的 POST 请求，利用 `country` 参数中的 `popen()` 函数执行任意命令。
    *   由于该漏洞未经身份验证即可利用，攻击者可以在未经授权的情况下以 root 权限执行命令，从而完全控制受影响的路由器。
    *   利用代码的步骤包括：
        1.  使用 Zmap 扫描目标 IP 地址列表（`list.txt`）。
        2.  在攻击者主机上设置 Netcat 监听器。
        3.  运行 Go 语言编写的 Exploit（`go run .`），指定 Netcat 监听器的 IP 地址和端口，以及目标 IP 地址列表。

4. **排序优先级**
   搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

综上所述，该漏洞利用的有效性较高，存在一定的投毒风险（主要取决于 `main.go` 的内容，代码未提供，所以评估为 10%），利用方式是通过构造恶意的 POST 请求注入命令。


**项目地址:** [Terminal1337/CVE-2023-1389](https://github.com/Terminal1337/CVE-2023-1389)

**漏洞详情:** [CVE-2023-1389](https://nvd.nist.gov/vuln/detail/CVE-2023-1389)