## CVE-2024-3094-xz-utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链后门

**影响应用:** xz-utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受感染版本的xz-utils，并且SSH服务链接到liblzma

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

**漏洞有效性：**

提供的POC代码（`CVE-2024-3094-Checker.sh`）并非漏洞利用代码，而是一个检测脚本，用于检查系统上安装的`xz`版本是否为受影响的`5.6.0`或`5.6.1`。因此，该脚本本身不具备漏洞利用能力，而是用于确认目标系统是否存在漏洞。

根据漏洞信息和搜索引擎结果，真正的漏洞利用涉及到通过供应链攻击植入的恶意代码，该恶意代码在构建过程中被插入到`liblzma`库中，从而影响依赖该库的软件，特别是SSH服务。成功的利用允许攻击者绕过SSH身份验证并执行任意代码。

**投毒风险：**

分析提供的脚本内容和相关文件（`LICENSE`，`README.md`），没有发现任何隐藏的恶意代码或潜在的投毒行为。脚本的功能仅限于版本检查，并提供缓解建议。`LICENSE`采用MIT许可，允许自由使用和修改。`README.md`文件也仅仅是描述脚本用途和使用方法，未包含任何恶意指令。

因此，该代码仓库的投毒风险评估为0%。

**利用方式：**

CVE-2024-3094的利用方式非常复杂，属于供应链攻击。攻击过程大致如下：

1.  **恶意代码注入：** 攻击者向`xz-utils`的源代码中注入了恶意代码，这些代码被伪装成测试文件的一部分，并通过复杂的混淆技术隐藏起来。
2.  **构建过程篡改：** 在`liblzma`的构建过程中，恶意代码被提取出来，并用于修改`liblzma`库中的特定函数。
3.  **SSH后门植入：** 修改后的`liblzma`库会在SSH服务启动时被加载，并允许攻击者绕过身份验证，执行任意代码。
4.  **远程代码执行：** 攻击者通过精心构造的SSH连接，利用后门执行恶意代码，从而完全控制受害系统。

简而言之，利用方式是通过篡改构建过程，在广泛使用的压缩库中植入后门，最终实现远程代码执行。


**项目地址:** [TheTorjanCaptain/CVE-2024-3094-Checker](https://github.com/TheTorjanCaptain/CVE-2024-3094-Checker)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)