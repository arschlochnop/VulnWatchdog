## CVE-2018-25031-Swagger UI-远程OpenAPI定义显示漏洞

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/跨站脚本 (Spoofing/XSS)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 4.1.2 (可能影响更高版本)

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱使用户打开精心制作的 URL，来显示远程的恶意 OpenAPI 定义。根据搜索结果和漏洞库信息，该漏洞的核心在于 Swagger UI 未能充分验证和过滤用户提供的 URL，导致可以加载并渲染来自任意来源的 OpenAPI 定义文件。这使得攻击者可以欺骗用户，展示伪造的 API 文档，甚至通过在 OpenAPI 定义中插入恶意 HTML 或 JavaScript 代码，实现跨站脚本攻击（XSS）。

**有效性：** 提供的 POC 代码有效。`domxss.yaml` 文件包含用于触发 DOM XSS 的恶意代码， `<form><math><mtext></form><form><mglyph><svg><mtext><textarea><path id="</textarea><img onerror=alert(document.domain) src>"></form>` 。 `poc.json` 和 `poc.yaml` 文件用于指定要加载的恶意 OpenAPI 定义文件。

**投毒风险：** 仓库中存在少量投毒风险。`domxss.yaml` 使用了 `otlu3omsk1ath8ur17a2kldtmksbg34s.oastify.com` 作为 `basePath`，这可能用于收集受害者的 IP 地址或进行其他形式的侦察。但核心的 XSS payload 和利用方式比较直接，主要的目的是验证漏洞，投毒的可能性较小。风险比例预估为10%。

**利用方式：**

1.  攻击者创建一个包含恶意代码的 OpenAPI 定义文件（例如 `domxss.yaml`）。
2.  攻击者将此文件托管在公开可访问的 URL 上（例如 GitHub Raw Content）。
3.  攻击者构造一个包含指向恶意 OpenAPI 定义文件 URL 的链接。
4.  攻击者诱使受害者点击该链接。
5.  受害者的浏览器加载 Swagger UI，并从攻击者指定的 URL 加载恶意 OpenAPI 定义文件。
6.  Swagger UI 渲染恶意 OpenAPI 定义文件，从而执行其中的恶意代码（例如 XSS payload）。

**项目地址:** [nigartest/CVE-2018-25031](https://github.com/nigartest/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)