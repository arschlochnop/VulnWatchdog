## CVE-2023-22515 - Atlassian Confluence Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Server and Data Center

**危害等级:** 严重，允许未经身份验证的攻击者创建管理员帐户并完全控制受影响的实例

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Server 或 Data Center 实例必须是公开可访问的，且位于受影响的版本范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-22515 是 Atlassian Confluence Server 和 Data Center 中的一个严重漏洞，属于未授权访问控制漏洞。未经身份验证的远程攻击者可以利用此漏洞在受影响的 Confluence 实例上创建未经授权的 Confluence 管理员帐户，从而获得对 Confluence 实例的完全控制权。

**漏洞利用方式：**

1.  **触发漏洞:** 首先，攻击者通过访问 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false` URL 来触发漏洞，该操作会将 Confluence 实例置于未设置完成的状态。
2.  **创建管理员帐户:** 然后，攻击者通过向 `/setup/setupadministrator.action` 发送 POST 请求，利用未授权访问控制漏洞创建一个新的管理员帐户。POST 请求包含用户名、密码和电子邮件等管理员帐户的信息。
3.  **身份验证:** 最后，攻击者使用新创建的管理员帐户登录 Confluence 实例，并获得完全的管理权限。

**投毒风险分析：**

提供的PoC代码主要功能是利用漏洞创建管理员账户，并未发现直接的恶意代码或后门植入行为。PoC代码虽然在创建管理员账户后，会将服务器、用户名和密码写入文件。这个行为本身不属于投毒，但如果该文件被泄露，可能会造成安全风险。 此外，该PoC使用了一些常用的库如`requests`, `rich`, `alive-progress`, `fire`，这些库本身被投毒的可能性较低，但需要确保从官方源安装，避免使用来源不明的第三方库。

因此，综合评估认为此仓库中存在作者隐藏的投毒代码的可能性较低，大约为5%。

**总结：**

此漏洞利用代码针对 CVE-2023-22515 进行了自动化利用，允许未经身份验证的攻击者创建管理员帐户。利用过程简单，只需要目标实例存在漏洞即可。该漏洞的风险极高，建议受影响的用户尽快升级到安全版本。

**项目地址:** [vivigotnotime/CVE-2023-22515-Exploit-Script](https://github.com/vivigotnotime/CVE-2023-22515-Exploit-Script)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)