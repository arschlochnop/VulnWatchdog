## CVE-2018-16763-FUEL CMS-远程代码执行

**漏洞编号:** CVE-2018-16763

**漏洞类型:** 远程代码执行

**影响应用:** FUEL CMS

**危害等级:** 高危，可导致服务器完全控制

**影响版本:** 1.4.1

**利用条件:** 目标系统运行 FUEL CMS 1.4.1 且可通过 HTTP 访问 /fuel/pages/select/ 或 /fuel/preview 路径

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-16763 允许未经身份验证的攻击者在 FUEL CMS 1.4.1 上执行任意 PHP 代码。攻击者可以通过 `pages/select/` 的 `filter` 参数或 `preview/` 的 `data` 参数，利用 PHP 代码执行漏洞。提供的 Python 脚本 `rce.py` 演示了如何通过构造恶意的 GET 请求，在 `filter` 参数中注入 PHP 代码来执行操作系统命令。漏洞利用方式为：

1.  发送包含恶意 PHP 代码的 GET 请求到 `/fuel/pages/select/?filter=%2Bpi(%24a%3D('system'))%2B%24a('{payload}')%2B'`，其中 `{payload}` 是要执行的操作系统命令。
2.  服务器解析并执行 `filter` 参数中的 PHP 代码，返回命令执行结果。
3.  攻击者解析响应，提取命令执行结果。

根据代码分析，该漏洞利用代码本身并不包含恶意投毒代码。该代码只是通过 HTTP 请求发送恶意payload，并没有主动在目标服务器写入后门或者进行其他恶意操作。THM-Vulnerability_Capstone-CVE-2018-16763仓库中也只是漏洞利用的脚本和描述文件，不存在隐藏的后门或者恶意代码，所以投毒风险为0%。但是不排除使用者会基于此漏洞，写入恶意webshell等后门代码。

**项目地址:** [wizardy0ga/THM-Vulnerability_Capstone-CVE-2018-16763](https://github.com/wizardy0ga/THM-Vulnerability_Capstone-CVE-2018-16763)

**漏洞详情:** [CVE-2018-16763](https://nvd.nist.gov/vuln/detail/CVE-2018-16763)