## CVE-2019-7214 SmarterMail 反序列化远程代码执行

**漏洞编号:** CVE-2019-7214

**漏洞类型:** 反序列化漏洞

**影响应用:** SmarterMail

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < build 6985

**利用条件:** 目标SmarterMail版本低于Build 6985，且17001端口对外开放。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-7214是SmarterMail 16.x版本Build 6985之前存在的一个反序列化漏洞。未经验证的攻击者可以通过TCP 17001端口向存在漏洞的SmarterMail服务器发送特制的序列化数据，从而执行任意命令。\n\n**有效性分析：**\n根据漏洞信息、搜索结果和提供的漏洞利用代码，可以确认该漏洞是有效的。漏洞库信息和搜索结果都明确指出SmarterMail在build 6985之前存在此漏洞，并且有公开的PoC代码可用。漏洞利用代码（CVE-2019-7214.py）实现了利用该漏洞进行远程代码执行的功能。\n\n**投毒风险分析：**\n提供的PoC代码主要功能是利用.NET反序列化漏洞，在目标服务器上执行PowerShell命令，并建立反向shell。PowerShell命令经过Base64编码，便于传输和执行。分析代码后发现，其主要功能是建立反向shell，虽然存在恶意利用的可能，但本身功能设计是漏洞利用的一部分，所以不存在明显的投毒代码。但该POC修改自其他作者，需要综合评估代码贡献者信誉和代码审查结果。推测的投毒风险较低，约为5%。风险主要来自于反向shell建立后的进一步恶意操作，不属于PoC代码投毒本身。\n\n**利用方式：**\n1.  **确定目标版本：** 确认目标SmarterMail服务器的版本低于Build 6985。\n2.  **开放端口检测：** 确认目标服务器的17001端口对外开放，或者攻击者可以访问该端口。\n3.  **配置攻击机：** 在攻击机上配置监听端口，用于接收反向shell。\n4.  **构造PoC：** 使用提供的PoC代码（CVE-2019-7214.py），设置攻击机的IP地址和监听端口。PoC 代码中使用了经过 base64 编码的 PowerShell 命令建立反向TCP连接。\n5.  **发送Payload：** 运行PoC代码，向目标服务器的17001端口发送构造的Payload。\n6.  **获取Shell：** 如果漏洞利用成功，攻击机将收到来自目标服务器的反向shell，从而可以在目标服务器上执行任意命令。

**项目地址:** [Drew-Alleman/CVE-2019-7214](https://github.com/Drew-Alleman/CVE-2019-7214)

**漏洞详情:** [CVE-2019-7214](https://nvd.nist.gov/vuln/detail/CVE-2019-7214)