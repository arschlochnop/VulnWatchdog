## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可被未授权的攻击者利用创建具有特权 15 的本地用户，为进一步攻击（如植入后门）铺平道路。

**影响版本:** 16.1.1 to 17.12.1 and potentially other versions as indicated in the CVE description.

**利用条件:** 目标设备启用了 Web UI 功能，且位于攻击者可访问的网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个权限提升漏洞。未经身份验证的远程攻击者可以通过向目标设备发送特制的 HTTP 请求来利用此漏洞。该漏洞允许攻击者在受影响的系统上创建一个具有特权级别 15 访问权限的帐户。此漏洞是攻击链的第一步，攻击者利用它来创建具有管理权限的本地用户，然后利用 CVE-2023-20273 进一步提升权限至 root，并在文件系统中写入植入程序。提供的 POC 代码 `main.py` 的作用是检测目标 IP 是否容易受到 CVE-2023-20198 的攻击。它通过发送特定的 GET 和 POST 请求来检查目标设备是否返回预期的响应。如果目标返回指示存在漏洞的响应，脚本将输出 'Vulnerable'，否则输出 'Not Vulnerable'。代码通过发送构造的 HTTP GET 请求来尝试绕过身份验证，并检查是否出现预期的“404 Not Found”响应。同时,代码还发送带有硬编码 Authorization 头的 POST 请求，以进一步确认漏洞的存在。尽管代码本身用于检测漏洞，但潜在的投毒风险在于硬编码的 Authorization 头部，以及对 HTTPS 请求的证书验证的禁用（`verify=False`），这可能被恶意修改以进行中间人攻击或者将流量重定向到恶意服务器，虽然这种可能性不大，只有10%。

**利用方式：**

1.  **未经身份验证的访问：** 攻击者无需任何凭据即可发起攻击。
2.  **特制的 HTTP 请求：**  攻击者构造特定的 HTTP GET/POST 请求，利用漏洞绕过身份验证。
3.  **创建特权用户：** 成功利用漏洞后，攻击者可以创建一个拥有最高权限（特权级别 15）的本地用户。
4.  **后续利用：**  创建的特权用户可被用于进一步的恶意活动，例如植入后门、收集敏感信息等（与 CVE-2023-20273 结合）。

**有效性：**
根据漏洞描述和搜索结果，提供的 POC 代码 `main.py` 旨在检测目标是否存在 CVE-2023-20198 漏洞，而不是直接利用该漏洞创建用户。 它通过发送特定的HTTP请求来验证是否存在漏洞。因此，该POC代码在检测方面是有效的。



**项目地址:** [kacem-expereo/CVE-2023-20198](https://github.com/kacem-expereo/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)