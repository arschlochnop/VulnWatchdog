## CVE-2025-53770 - Microsoft SharePoint Server RCE

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未授权的攻击者通过网络执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标系统为受影响的on-premises SharePoint Server版本，攻击者需要能够通过网络访问SharePoint服务器。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于反序列化不可信数据导致。攻击者可以利用此漏洞在未经授权的情况下通过网络执行代码。CISA已将其添加到已知被利用的漏洞目录中，表明该漏洞正在被积极利用。

**漏洞利用方式：**

1.  攻击者发送特制的序列化数据到SharePoint服务器。
2.  SharePoint服务器在处理该数据时，由于存在反序列化漏洞，导致代码执行。
3.  攻击者从而获得在服务器上执行任意代码的能力。

**投毒风险分析：**

提供的“漏洞利用代码”实际上是一个检测和修复工具包，而非直接的漏洞利用程序。它包含 PowerShell 脚本和 Bash 脚本，用于检测漏洞是否存在、是否已安装补丁、是否启用了 AMSI，以及扫描是否存在入侵痕迹。同时也提供了启用 AMSI 和轮换 MachineKey 的修复脚本。

尽管该工具包本身旨在帮助安全团队，但仍存在一定的投毒风险，尤其是考虑到以下几点：

*   **第三方维护：** 该工具包由 Bluefire Redteam 维护，用户需要信任该团队的代码和更新。如果该团队被攻击或恶意修改代码，可能会引入后门或恶意功能。
*   **脚本执行：** PowerShell 和 Bash 脚本具有很高的权限，如果脚本被篡改，可能会执行恶意操作，例如删除文件、窃取数据或安装恶意软件。
*   **复杂性：** 代码库的复杂性可能使得用户难以完全审计和理解脚本的功能，从而难以发现潜在的恶意行为。

因此，尽管工具包的目的是好的，但仍建议用户在运行之前仔细审查代码，并确保从可信的来源下载。考虑到以上风险，投毒风险评估为20%。 这个比例考虑了它主要是防御工具，直接的后门可能性较低，但存在被篡改引入恶意代码的风险。

**缓解措施：**

*   尽快应用 Microsoft 提供的安全更新。
*   启用 Antimalware Scan Interface (AMSI)。
*   轮换 SharePoint ASP.NET MachineKeys。
*   监控 SharePoint 服务器是否存在可疑活动。

**项目地址:** [Bluefire-Redteam-Cybersecurity/bluefire-sharepoint-cve-2025-53770](https://github.com/Bluefire-Redteam-Cybersecurity/bluefire-sharepoint-cve-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)