## CVE-2023-50164-Apache Struts文件上传路径遍历导致RCE

**漏洞编号:** CVE-2023-50164

**漏洞类型:** 路径遍历/远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.0.0 <= Struts <= 2.5.32 和 6.0.0 <= Struts <= 6.3.0.1

**利用条件:** 需要存在文件上传功能，且应用部署在支持WAR部署的环境，如Tomcat

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-50164 是 Apache Struts 中的一个关键漏洞，攻击者可以通过操纵文件上传参数实现路径遍历。在特定情况下，这可能导致上传恶意文件，进而实现远程代码执行 (RCE)。

**有效性评估：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞的PoC代码有效。漏洞库和搜索结果均表明这是一个严重的安全漏洞，并存在公开可用的PoC。

**投毒风险评估：**

分析提供的PoC代码（README.md 和 Vagrantfile），主要的风险点较低：

*   `README.md`:  该文件详细描述了漏洞和PoC的用法，并包含免责声明，表明其目的是用于研究和防御目的。
*   `Vagrantfile`:  该文件用于创建用于测试的环境，使用 `generic/debian12` 作为基础镜像，并配置了一个私有网络，IP 地址为 `192.168.56.25`。虽然 Vagrantfile 可以执行任意命令，但是目前文件中的命令都是常规配置，用于搭建测试环境。

尽管如此，所有来自第三方的代码都应谨慎对待。该仓库本身结构比较简单，主要功能代码应该在 `exploit.py` (未提供) 文件中。如果没有代码审计`exploit.py`, 不能完全排除隐蔽的恶意代码的可能性。综合评估，投毒风险较低，大约为10%。主要风险可能存在于`exploit.py` 中，例如在上传的webshell中添加后门，或者利用路径遍历写入恶意配置文件。但是鉴于PoC作者已经声明目的为研究，且相关信息比较透明，恶意投毒的可能性相对较低。

**利用方式分析：**

1.  **路径遍历：** 攻击者通过修改文件上传的参数，构造包含 `../` 的路径，突破文件上传的目录限制，实现任意文件写入。
2.  **Webshell 上传：** 攻击者利用路径遍历，将包含恶意代码的 Webshell 文件上传到 Web 服务器的可执行目录下。
3.  **远程代码执行：** 攻击者通过访问上传的 Webshell 文件，执行恶意代码，从而控制服务器。

根据PoC的描述，利用方式需要应用部署在类似Tomcat这样的服务器上，通过上传WAR包形式的Webshell来实现利用。



**项目地址:** [jakabakos/CVE-2023-50164-Apache-Struts-RCE](https://github.com/jakabakos/CVE-2023-50164-Apache-Struts-RCE)

**漏洞详情:** [CVE-2023-50164](https://nvd.nist.gov/vuln/detail/CVE-2023-50164)