## CVE-2010-3863 Apache Shiro 路径穿越

**漏洞编号:** CVE-2010-3863

**漏洞类型:** 路径穿越/安全绕过

**影响应用:** Apache Shiro

**危害等级:** 中危，可能导致未授权访问

**影响版本:** < 1.1.0, JSecurity 0.9.x

**利用条件:** 需要目标系统使用受影响的Apache Shiro版本并存在基于路径的访问控制配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2010-3863 存在于 Apache Shiro 1.1.0 之前的版本和 JSecurity 0.9.x 中。由于 Shiro 在将 URI 路径与 shiro.ini 文件中的条目进行比较之前，没有对 URI 路径进行规范化，攻击者可以通过构造包含 '/./' 的恶意请求绕过预期的访问限制。

**利用方式：**
攻击者通过在 URL 中使用 '/./' 绕过 Shiro 的访问控制。例如，如果 `/admin/` 路径需要身份验证，攻击者可以使用 `/./admin/` 来尝试绕过身份验证。

**POC 分析：**
POC 验证通过发送带有`/.//admin/`路径的GET请求，检查响应状态码是否为200以及响应体是否包含`rootAccount Info`。如果都满足，则说明漏洞存在，可以绕过权限验证访问到admin页面。

**投毒风险分析：**
查看提供的 POC 代码（poc.yml 和 readme.md），未发现任何可疑或恶意的代码。该 POC 只是验证漏洞是否存在，不会对系统造成任何危害。因此，投毒风险可以忽略不计 (0%)。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。攻击者可以通过构造特殊的 URL 绕过 Shiro 的访问控制。

**项目地址:** [sh1inroot-alt/shiro-cve-2010-3863](https://github.com/sh1inroot-alt/shiro-cve-2010-3863)

**漏洞详情:** [CVE-2010-3863](https://nvd.nist.gov/vuln/detail/CVE-2010-3863)