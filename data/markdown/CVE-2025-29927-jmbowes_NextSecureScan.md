## CVE-2025-29927-Next.js-Middleware权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问、数据泄露和权限提升

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了Next.js中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js中间件中的一个权限绕过漏洞。攻击者可以通过操纵特定的HTTP请求头（`X-Middleware-Subrequest`）来绕过中间件的身份验证检查，从而访问受保护的资源。漏洞利用方式如下：

1.  **漏洞描述：** 该漏洞源于Next.js中间件对`X-Middleware-Subrequest`请求头的处理不当。
2.  **影响版本：** Next.js版本 >= 11.1.4 且 <= 13.5.6, > 14.0.0 且 < 14.2.25, 以及 > 15.0.0 且 < 15.2.3。
3.  **利用方式：** 攻击者发送包含特制的`X-Middleware-Subrequest`头的HTTP请求，即可绕过中间件的权限验证。
4.  **POC有效性：** 提供的POC代码是一个用于检测该漏洞的扫描器，它通过发送包含`X-Middleware-Subrequest`头的请求来判断目标是否存在漏洞。根据描述，该POC代码是有效的。
5.  **投毒风险：**  提供的代码库主要是一个扫描工具，其目的是检测Next.js应用程序中CVE-2025-29927漏洞的存在。代码中没有发现明显的恶意代码，例如反向shell或数据泄露机制。它主要依赖于发送特定的HTTP请求头来测试中间件的行为。但是，它仍然存在一定的投毒风险，因为用户可能会误用此脚本，攻击未经授权的系统。此外，恶意攻击者也可能修改扫描器，添加恶意功能并在社区中传播。
6. **缓解措施：**
   * 升级Next.js版本到14.2.25或15.2.3及以上。
   * 在中间件中验证`x-middleware-subrequest`头，确保它不是来自外部用户的请求。

**项目地址:** [jmbowes/NextSecureScan](https://github.com/jmbowes/NextSecureScan)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)