## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致拒绝服务或客户端代码执行

**影响版本:** < 4.1.3

**利用条件:** 需要使用CookieJar，并且rejectPublicSuffixes=false

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-26136是tough-cookie包中的一个原型污染漏洞，影响4.1.3之前的版本。该漏洞是由于在使用CookieJar时，对Cookie的处理不当造成的，特别是当`rejectPublicSuffixes`设置为`false`时。攻击者可以通过构造恶意的Cookie，污染JavaScript对象的原型，从而影响应用程序的行为。虽然漏洞描述中提到影响的是客户端，但是如果服务器端也使用了存在漏洞的tough-cookie版本，并且依赖于受污染的原型属性，那么也可能受到影响。

**有效性：**
漏洞库信息和搜索引擎结果都确认了漏洞的存在，并且提供了commit信息，说明该漏洞已被修复。给出的Dockerfile和代码片段是tough-cookie仓库的代码，包括Dockerfile、LICENSE和README.md。这些文件本身不是漏洞利用代码，而是构建和描述该库的文件。

**投毒风险：**
提供的Dockerfile在构建过程中，修改了`/usr/local/lib/node_modules`和`/usr/local/bin`的权限，允许`cookie`用户写入。虽然这本身不是投毒行为，但如果构建环境或后续使用中存在其他漏洞，攻击者可能利用这些宽松的权限进行投毒，例如通过npm安装恶意依赖。因此，存在一定的投毒风险，但是从提供的代码片段来看，直接投毒的可能性较低，估计为10%。

**利用方式：**
1.  **条件：** 需要应用程序使用`tough-cookie`库的受影响版本（小于4.1.3），并且在创建`CookieJar`实例时，设置`rejectPublicSuffixes`为`false`。
2.  **攻击步骤：** 攻击者构造一个包含恶意属性的Cookie，例如`__proto__.polluted = true`。将此Cookie发送到服务器或客户端。
3.  **结果：** `Object.prototype`会被污染，所有JavaScript对象都会继承`polluted`属性，这可能会导致意外的行为或安全问题。
4. **修复方式：** 更新`tough-cookie`到4.1.3或更高版本。避免设置`rejectPublicSuffixes`为`false`。


**项目地址:** [guy2610/tough-cookie-patch-cve-2023-26136](https://github.com/guy2610/tough-cookie-patch-cve-2023-26136)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)