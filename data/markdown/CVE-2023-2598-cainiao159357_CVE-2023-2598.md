## CVE-2023-2598-Linux Kernel io_uring Out-of-Bounds Access

**漏洞编号:** CVE-2023-2598

**漏洞类型:** Out-of-Bounds Write/Read

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Kernel prior to 6.4-rc1

**利用条件:** 本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-2598 存在于 Linux Kernel 的 io_uring fixed buffer registration 代码 (io_sqe_buffer_register in io_uring/rsrc.c) 中。该漏洞允许越界访问物理内存，超出 buffer 范围。PoC 代码表明，该漏洞允许本地权限提升，无需特定地址依赖。

**有效性：**
提供的PoC代码通过修改uid来提权，说明该代码是有效的，因为它能够利用越界读写接口来修改用户ID，从而获得root权限。

**投毒风险：**
PoC 代码中主要的逻辑是利用漏洞进行提权，并没有发现明显的恶意代码。尽管如此，仍然存在一些潜在的风险：
*   **代码复杂性：** io_uring的利用本身就比较复杂，攻击者可能会在细节上做手脚，例如在错误处理流程中引入漏洞或者修改关键参数。
*   **安全假设：** 代码依赖于特定的内核配置或环境，如果环境不符合预期，可能会导致PoC失效甚至系统崩溃。
*   **Cred 喷射：** PoC使用了cred喷射技术，理论上存在污染其他进程cred的可能性，但可能性很低，而且也不是作者故意为之。

综合考虑，该PoC代码的投毒风险较低，但不能完全排除。评估的投毒风险为 10%。

**利用方式：**
1.  **漏洞触发：**
利用io_uring接口注册buffer，通过mmap将同一个物理页表映射到连续的虚拟地址上，绕过内核的检查。

2.  **越界读写：**
注册的buffer size大于实际分配的物理内存，导致可以越界读写。

3.  **提权：**
通过越界读写，修改当前进程的cred结构体中的uid为0，从而获得root权限。

4.  **执行shell：**
利用execve执行/bin/sh，获得root shell。

**项目地址:** [cainiao159357/CVE-2023-2598](https://github.com/cainiao159357/CVE-2023-2598)

**漏洞详情:** [CVE-2023-2598](https://nvd.nist.gov/vuln/detail/CVE-2023-2598)