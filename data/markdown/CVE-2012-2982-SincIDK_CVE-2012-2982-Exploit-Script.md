## CVE-2012-2982-Webmin-远程命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 远程命令执行

**影响应用:** Webmin

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.590

**利用条件:** 需要Webmin管理面板的登录凭据和网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2012-2982 是Webmin 1.590及更早版本中 file/show.cgi 存在的一个远程命令执行漏洞。经过身份验证的远程攻击者可以通过在文件路径名中使用无效字符（如管道符'|'）来执行任意命令。

**有效性:**
根据漏洞描述和搜索结果(特别是exploit-db和rapid7的链接)，此漏洞利用的PoC代码是有效的。该PoC通过构造包含管道符的恶意URL，利用file/show.cgi的输入验证缺陷来执行命令。

**投毒风险:**
分析提供的PoC代码（README.md）主要功能是利用漏洞，没有明显的恶意代码，只有免责声明。但仍有潜在的投毒风险，如果真正的利用脚本被隐藏在其它文件里。此仓库的PoC代码是否完全包含全部利用代码。需要分析仓库中是否包含其它恶意文件，例如混淆的shell脚本或者其他语言的后门程序。所以，投毒风险为10%，考虑了可能隐藏攻击payload的可能性，但是表面上没有明显后门。

**利用方式:**
1.  攻击者需要拥有Webmin管理面板的有效登录凭据。
2.  攻击者构造一个包含恶意命令的URL，并在文件路径中使用管道符“|”进行命令注入，例如：`/file/show.cgi/bin/任意文件名|恶意命令`。
3.  Webmin的`/file/show.cgi`脚本在处理文件路径时，没有正确过滤管道符，导致恶意命令被执行。
4.  攻击者可以通过Netcat监听端口接收反向shell，从而完全控制服务器。

**项目地址:** [SincIDK/CVE-2012-2982-Exploit-Script](https://github.com/SincIDK/CVE-2012-2982-Exploit-Script)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)