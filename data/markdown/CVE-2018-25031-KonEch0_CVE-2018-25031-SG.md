## CVE-2018-25031 - Swagger UI Spoofing

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击 (Spoofing)

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致用户被引导至恶意API定义，进而造成信息泄露或其他安全风险

**影响版本:** <= 4.1.2

**利用条件:** 用户需要点击攻击者构造的恶意URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者发起欺骗攻击。攻击者通过诱使用户打开特制的URL，可以利用此漏洞显示远程 OpenAPI 定义。漏洞的利用方式是构造一个包含指向恶意 OpenAPI 定义文件的 URL，当受害者在 Swagger UI 中打开这个 URL 时，Swagger UI 会加载并显示恶意定义文件，从而欺骗用户。漏洞利用代码`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.json`展示了如何通过`url`或`urls`参数指定远程OpenAPI定义文件的位置。`/tmp/4a3d6f006dadeb23a07d21da273d231b/main.yaml` 是一个openapi的示例，用于展示攻击效果。有效性分析：提供的POC代码通过指向远程json/yaml文件，可以实现漏洞利用，即远程加载openapi定义文件。投毒风险分析：代码中指向github仓库的文件，理论上存在被篡改的风险，从而可以投毒。投毒风险较低，可能性约为10%，因为github有commit记录，容易被溯源。攻击者可能利用这一点诱导用户访问恶意API文档，例如在API描述中包含恶意链接或误导性信息。

**项目地址:** [KonEch0/CVE-2018-25031-SG](https://github.com/KonEch0/CVE-2018-25031-SG)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)