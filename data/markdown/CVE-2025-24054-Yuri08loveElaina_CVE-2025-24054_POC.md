## CVE-2025-24054-Windows NTLM Hash Disclosure Spoofing

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM Hash Disclosure Spoofing

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致凭据泄露和权限提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 攻击者需要诱使用户访问恶意文件或共享，并且攻击者需要搭建SMB服务器监听NTLM握手

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24054 是一个 Windows NTLM 哈希泄露欺骗漏洞。攻击者可以利用精心制作的 `.library-ms` 文件触发漏洞，诱使用户连接到攻击者控制的 SMB 服务器，从而捕获 NTLM 哈希。

**利用方式：**

1.  **攻击者准备：**
    *   攻击者需要搭建一个 SMB 服务器，例如使用 Responder 工具。
    *   获取攻击者的 IP 地址，用于后续步骤。
2.  **生成恶意 `.library-ms` 文件：**
    *   利用提供的 `ELAINA-POC.py` 脚本，使用 `create` 命令生成恶意的 `.library-ms` 文件。
    *   命令格式：`python ELAINA-POC.py create -ip <attacker_ip> -o exploit.library-ms`
    *   该脚本会在生成的 `.library-ms` 文件中，将 `attacker_ip` 嵌入到`<simpleLocation>`标签内，指向攻击者搭建的SMB服务器。
    *   或者，手动修改`Exploit.library-ms`文件，将`<simpleLocation>`标签指向攻击者控制的SMB服务器地址。
3.  **诱骗受害者：**
    *   攻击者将生成的 `exploit.library-ms` 文件发送给受害者。
    *   诱骗受害者打开该文件（例如，通过电子邮件、社交媒体或共享文件夹）。
4.  **捕获 NTLM 哈希：**
    *   当受害者打开 `.library-ms` 文件时，Windows 会尝试连接到 `simpleLocation` 中指定的 SMB 服务器（即攻击者的服务器）。
    *   这个连接尝试会触发 NTLM 握手，攻击者的 SMB 服务器（如 Responder）可以捕获到受害者的 NTLMv2 哈希。
5.  **提取 NTLM 哈希：**
    *   攻击者使用提供的 `ELAINA-POC.py` 或 `CVE-2025-24054.py` 脚本从 Responder 的日志文件中提取 NTLM 哈希。
    *   命令格式：`python ELAINA-POC.py extract -f <responder_log_file>` 或 `python CVE-2025-24054.py <responder_log_file>`

**有效性：**
根据搜索结果和提供的代码，此漏洞利用方式是有效的，并且已经在野外被利用。

**投毒风险：**

`ELAINA-POC.py` 脚本在启动时会验证 ASCII Logo 的 MD5 值，这可以防止 Logo 被篡改。但是，`ELAINA-POC.py`和`CVE-2025-24054.py`的代码都很简单，只包含漏洞利用相关的功能，没有发现明显的恶意代码。Readme文件只是描述如何使用,未发现投毒风险。投毒的可能存在于作者植入其他隐蔽后门，但代码未展现。因此，评估的投毒风险为5%。

**项目地址:** [Yuri08loveElaina/CVE-2025-24054_POC](https://github.com/Yuri08loveElaina/CVE-2025-24054_POC)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)