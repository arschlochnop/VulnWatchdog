## CVE-2025-32710 Windows Remote Desktop Services Remote Code Execution

**漏洞编号:** CVE-2025-32710

**漏洞类型:** 远程代码执行

**影响应用:** Windows Remote Desktop Services

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** 受影响的Windows Server版本包括2008 SP2, 2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2022, 2025和23H2

**利用条件:** 需要目标系统开启远程桌面服务，攻击者需要能够通过网络访问目标系统的RDP端口（通常是3389）

**POC 可用性:** 是

**投毒风险:** 60%

## 详情

CVE-2025-32710 是 Windows 远程桌面服务中的一个使用后释放（Use-After-Free）漏洞，允许未经授权的攻击者通过网络执行任意代码。 根据漏洞信息，CVSS评分高达8.1，表明这是一个高危漏洞。

**有效性分析：**

根据提供的漏洞利用代码，该代码尝试自动化利用过程。它包含以下几个主要部分：

1.  **RDP协商请求构造 (`my_rdp.py`)：** 代码创建了一个RDP协商请求，可能用于触发漏洞或绕过某些安全机制。 但是这个请求本身看起来更像是用来协商RDP协议版本或者加密方式，跟直接触发UAF没有关系。
2.  **自动化攻击脚本 (`run.sh`)：** 这是一个 Bash 脚本，用于自动化扫描、攻击和验证过程。它使用 Nmap 扫描 RDP 端口，然后使用 `sodok.py` （代码未提供）进行攻击，最后使用 `xfreerdp` 验证漏洞是否成功利用。 创建新账户sincan2应该是`sodok.py`里的内容，可能通过某种方式执行命令创建账户。
3.  **利用流程：**
    *   使用 Nmap 扫描目标 RDP 端口。
    *   使用 Python 脚本 (`sodok.py`) 发送特制的 RDP 请求，触发 Use-After-Free 漏洞，并在目标系统上执行代码。
    *   利用成功后，创建管理员帐户 `sincan2:koped123` 并开启 RDP 服务。
    *   使用 `xfreerdp` 验证是否可以成功通过 RDP 连接到目标系统。

总的来说，提供的POC代码思路比较完整，自动化程度较高，如果 `sodok.py` 中的漏洞触发代码有效，那么该 POC 的利用成功率会比较高。

**投毒风险分析：**

该漏洞利用代码存在一定的投毒风险。

1.  **自动化脚本：** `run.sh` 脚本具有执行系统命令的权限，如果脚本被篡改，可能会执行恶意操作，例如删除文件、安装后门程序或传播恶意软件。
2.  **sodok.py 脚本：**  这是实际执行漏洞利用的脚本，如果该脚本被篡改，可能会执行恶意的代码，例如植入后门，收集用户信息等。由于没有提供 `sodok.py` 的源码，风险更大。
3. **创建用户：** 创建sincan2用户本身，也可能为攻击者留下后门，方便后续再次入侵。
4. **印尼语注释：** 代码包含印尼语注释，虽然不一定是恶意行为，但增加了代码审查的难度，可能隐藏了恶意代码。

**利用方式：**

1.  **RDP 端口扫描：** 攻击者首先使用端口扫描工具（如 Nmap）扫描目标网络，查找开放 RDP 端口的系统。
2.  **漏洞利用：** 攻击者使用提供的漏洞利用代码，向目标系统发送特制的 RDP 请求，触发 Use-After-Free 漏洞。
3.  **代码执行：** 成功触发漏洞后，攻击者可以在目标系统上执行任意代码，例如创建新的管理员帐户，安装恶意软件等。
4.  **RDP 访问：** 攻击者可以使用新创建的管理员帐户，通过 RDP 协议远程访问目标系统，从而完全控制目标系统。

总而言之，该漏洞的利用方式是利用一个存在于 Windows 远程桌面服务中的 UAF 漏洞，通过发送特制的 RDP 请求来执行任意代码，从而控制目标系统。

**项目地址:** [Sincan2/RCE-CVE-2025-32710](https://github.com/Sincan2/RCE-CVE-2025-32710)

**漏洞详情:** [CVE-2025-32710](https://nvd.nist.gov/vuln/detail/CVE-2025-32710)