## CVE-2023-25813-Sequelize-SQL注入

**漏洞编号:** CVE-2023-25813

**漏洞类型:** SQL注入

**影响应用:** Sequelize

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** < 6.19.1

**利用条件:** 应用程序使用受影响版本的Sequelize，并且在查询中使用 `replacements` 选项和 `where` 选项在同一个查询中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-25813 是 Sequelize ORM 工具中存在的一个 SQL 注入漏洞。该漏洞源于在使用 `replacements` 选项时，参数没有被正确转义，攻击者可以通过构造恶意的 SQL 语句来执行任意 SQL 代码。根据漏洞描述和搜索引擎结果，该漏洞的 CVSS 评分高达 10.0，属于严重级别。

**有效性：**

根据提供的漏洞信息和搜索引擎结果, 以及漏洞利用代码包含一个示例项目，其中 `package-lock.json` 文件显示依赖了易受攻击的版本 `sequelize: "^6.19.0"`，说明提供的POC代码有效。由于漏洞是由于参数没有被正确转义，所以通过恶意的sql查询，替换参数就可以执行sql代码。

**投毒风险：**

分析提供的 `package-lock.json` 文件，以及其他的代码文件，没有发现任何可疑的恶意代码或后门。该POC专注于重现和验证SQL注入漏洞，而不是传播恶意payload。因此，投毒的可能性为 0%。

**利用方式：**

1.  攻击者需要找到应用程序中使用 Sequelize 并且同时使用了 `replacements` 和 `where` 选项的查询。
2.  攻击者构造包含恶意 SQL 代码的 payload，并将其作为 `replacements` 的参数传递给查询。
3.  由于参数未被正确转义，恶意 SQL 代码会被执行，从而导致 SQL 注入攻击。

例如，攻击者可以在 `replacements` 中注入 SQL 代码来绕过身份验证、读取敏感数据或执行其他恶意操作。

**总结：**

CVE-2023-25813 是一个高危的 SQL 注入漏洞，利用方式相对简单，影响范围广泛。建议受影响的用户尽快升级到 Sequelize 6.19.1 或更高版本，或者避免在同一个查询中同时使用 `replacements` 和 `where` 选项。

**项目地址:** [White-BAO/CVE-2023-25813](https://github.com/White-BAO/CVE-2023-25813)

**漏洞详情:** [CVE-2023-25813](https://nvd.nist.gov/vuln/detail/CVE-2023-25813)