## CVE-2020-27955 Git LFS RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 2.12.0

**利用条件:** 需要克隆包含恶意Git LFS对象的仓库

**POC 可用性:** 是

**投毒风险:** 80%

## 详情

CVE-2020-27955是Git LFS 2.12.0中存在的一个远程代码执行漏洞。攻击者可以通过创建一个包含恶意Git LFS对象的仓库，当受害者克隆该仓库时，即可执行任意代码。提供的POC代码包含两个文件：

*   `/tmp/9561a509eac14276a7801197af1b917b/a.dat`：这是一个包含"pwn"字符串的数据文件，可能作为LFS对象的内容。
*   `/tmp/9561a509eac14276a7801197af1b917b/git.cmd`：这是一个Windows批处理文件，内容为"calc.exe"，这意味着攻击者试图执行计算器程序。

漏洞利用方式是精心构造 `.gitattributes` 文件，通过 `filter=lfs diff=lfs merge=lfs` 指定 LFS filter ，然后定义 `lfs.clean` 和 `lfs.smudge` 命令来执行恶意代码。

有效性：提供的POC代码看起来是有效的，因为它包含一个用于触发漏洞的数据文件和一个用于执行恶意代码的批处理文件。通过修改批处理文件，攻击者可以执行任意代码。

投毒风险：POC代码中存在明显的投毒风险。批处理文件`git.cmd`的内容是`calc.exe`，这仅仅是示例代码。攻击者可以很容易地将此批处理文件替换为更具破坏性的代码，例如删除文件、安装后门等。因此，克隆包含此漏洞的仓库存在极高的投毒风险，我认为投毒风险为80%。需要注意的是，验证POC本身的行为不应视为投毒，此处是指攻击者恶意利用此漏洞的可能性。

利用方式：

1.  攻击者创建一个包含恶意LFS对象的仓库。
2.  攻击者在仓库的.gitattributes文件中定义lfs filter, smudge, clean命令指向恶意脚本
3.  受害者克隆该仓库。
4.  当Git LFS尝试处理恶意LFS对象时，将执行攻击者预设的恶意代码。
5.  受害者机器被攻击者控制。

**项目地址:** [IanSmith123/CVE-2020-27955](https://github.com/IanSmith123/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)