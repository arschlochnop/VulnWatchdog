## CVE-2023-44487 HTTP/2 Rapid Reset 拒绝服务攻击

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2 协议实现

**危害等级:** 高危，可能导致服务器资源耗尽，服务不可用

**影响版本:** 受影响的 HTTP/2 协议实现，具体版本取决于使用的服务器软件和库

**利用条件:** 目标服务器必须支持 HTTP/2 协议，且没有针对此漏洞的缓解措施

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-44487 描述的是 HTTP/2 协议中的一个拒绝服务漏洞，被称为“Rapid Reset”。攻击者通过快速建立和重置大量的 HTTP/2 流，导致服务器消耗大量资源，从而造成拒绝服务。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该POC代码是有效的。漏洞库信息明确指出该漏洞在2023年8月至10月期间已被实际利用。搜索引擎结果中也包含了大量关于该漏洞的描述和分析，证明了该漏洞的真实性和危害性。提供的Python脚本通过 httpx 库发送大量快速重置的 HTTP/2 请求，模拟了攻击场景。

**投毒风险：**
查看提供的 Python POC 代码，主要功能是发送大量的 HTTP/2 请求，快速建立和重置流。投毒风险评估如下：

*   代码结构简单，主要依赖 httpx 库发送 HTTP/2 请求。
*   从 `.env` 文件读取目标 URL、请求总数和并发数，方便用户配置。
*   使用 `tqdm` 库显示攻击进度，方便用户观察。
*   包含简单的统计功能，显示成功率、错误率和 RPS（每秒请求数）。
*   **潜在风险：**  虽然代码本身看起来没有明显的恶意代码，但攻击脚本的本质就是消耗目标服务器的资源。使用该脚本进行未授权的测试或攻击可能导致严重的法律后果。

综合来看，该仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。

**利用方式：**

1.  攻击者首先需要确定目标服务器是否支持 HTTP/2 协议，并且没有针对此漏洞的缓解措施（如限制最大流数量或限制重置流的速度）。
2.  攻击者配置漏洞利用代码，指定目标 URL、总请求数和并发数。并发数越高，攻击强度越大，但同时也可能导致攻击者自身的网络连接出现问题。
3.  运行漏洞利用代码，该代码会快速建立大量的 HTTP/2 流，并立即重置这些流。
4.  目标服务器在处理这些大量的流建立和重置操作时，会消耗大量的 CPU 和内存资源，最终导致服务不可用。

**总结：**
CVE-2023-44487 是一个严重的拒绝服务漏洞，攻击利用简单，危害性大。 受影响的系统管理员应尽快应用补丁或采取缓解措施，例如限制 HTTP/2 连接和流的数量。


**项目地址:** [BMG-Black-Magic/CVE-2023-44487](https://github.com/BMG-Black-Magic/CVE-2023-44487)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)