## CVE-2025-29927-Next.js-Middleware授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用程序使用Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是一个 Next.js 中间件的授权绕过漏洞。根据漏洞库信息，如果 Next.js 应用程序在中间件中进行授权检查，攻击者可以通过某种方式绕过这些检查。搜索引擎结果表明，该漏洞与 `x-middleware-subrequest` 标头的使用不当有关。利用方式是攻击者可以在请求中包含或操纵 `x-middleware-subrequest` 标头，从而欺骗中间件，使其认为请求来自内部，进而绕过授权。提供的代码片段看起来是一个 Next.js 应用的 Dockerfile 和一些配置脚本，用于离线部署 MediGuard 应用。**Dockerfile** 用于构建Docker镜像，包含了安装依赖、复制文件、构建项目、裁剪生产环境依赖等操作。**OFFLINE.md** 提供了离线部署的步骤，包括安装依赖、复制字体和CSS文件、构建项目等。**README.md** 描述了MediGuard应用的功能和使用方法，以及一个安全警告，表明该应用包含一个故意设计的漏洞健康检查功能。该漏洞利用代码本身没有明显的投毒代码，主要功能是环境配置和部署，但鉴于 MediGuard 应用本身包含一个故意设计的漏洞健康检查功能，存在被恶意利用的风险，因此存在一定的投毒风险。风险评估为10%。 漏洞利用方式总结如下：

1.  **识别目标：** 寻找使用受影响的 Next.js 版本，并且授权逻辑依赖中间件的应用。
2.  **构造恶意请求：** 在HTTP请求中包含 `x-middleware-subrequest` 标头，或者修改该标头的值。
3.  **绕过授权：**  利用中间件对 `x-middleware-subrequest` 标头处理不当的缺陷，绕过授权检查，访问受保护的资源或功能。
4. **验证漏洞：** 尝试访问原本需要授权才能访问的资源，验证是否成功绕过。

**项目地址:** [CEAarab/CVE-2025-29927_env](https://github.com/CEAarab/CVE-2025-29927_env)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)