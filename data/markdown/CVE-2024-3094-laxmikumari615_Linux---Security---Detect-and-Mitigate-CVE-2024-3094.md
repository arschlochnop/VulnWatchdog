## CVE-2024-3094 - XZ Utils供应链后门

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** XZ Utils

**危害等级:** 极危，可能导致未经授权的远程SSH访问和任意代码执行

**影响版本:** 5.6.0, 5.6.1

**利用条件:** 系统使用了受影响版本的XZ Utils，并且sshd链接了被感染的liblzma库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 涉及 XZ Utils 软件库中的一个供应链后门。恶意代码被嵌入到上游 tarball 中，从 5.6.0 版本开始生效。该后门通过复杂的混淆手段，在 liblzma 的构建过程中，提取预构建的目标文件，并用它来修改 liblzma 代码中的特定函数。这导致生成一个被修改的 liblzma 库，任何链接到该库的软件都可能被利用。从搜索结果和漏洞库信息可知，此漏洞利用目的是在SSH连接建立前，通过被植入的恶意代码篡改sshd的身份验证过程，从而允许攻击者未经授权的远程访问。提供的漏洞利用代码（README.md）本身只是一个信息说明文档，用于检测和缓解该漏洞，不包含直接的利用代码。因此，它主要用于提供检测受影响系统的工具和技术，以及减轻漏洞影响的指导。虽然README.md文件本身不包含投毒代码，但由于它来自一个声称提供漏洞检测和缓解的仓库，存在作者可能在其他相关的文件或工具中隐藏恶意代码的风险，因此有一定的投毒风险。

**利用方式：**

1.  **恶意代码注入：** 攻击者通过精心构造的补丁或脚本，将恶意代码注入到 XZ Utils 的源代码中。
2.  **构建过程篡改：** 在构建 liblzma 库时，恶意代码会被激活，修改库中的关键函数。
3.  **SSH后门植入：** 被修改的 liblzma 库会被sshd链接，恶意代码拦截SSH连接，并在身份验证之前进行干预，允许攻击者绕过身份验证。
4.  **远程访问：** 攻击者利用后门，通过 SSH 远程访问受感染的系统。

**项目地址:** [laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094](https://github.com/laxmikumari615/Linux---Security---Detect-and-Mitigate-CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)