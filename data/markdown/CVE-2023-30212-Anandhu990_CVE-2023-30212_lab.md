## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户会话劫持、恶意脚本执行

**影响版本:** <= 7.2.0

**利用条件:** 需要用户访问包含恶意脚本的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212 是 OURPHP 7.2.0 版本中存在的一个反射型跨站脚本漏洞，位于 `/client/manage/ourphp_out.php` 文件。攻击者可以通过构造包含恶意 JavaScript 代码的 URL，诱使用户点击，从而在用户浏览器中执行恶意脚本，达到窃取用户 Cookie、篡改页面内容等目的。

**有效性：** 根据漏洞库信息和搜索结果，存在多个POC验证的链接，表明该漏洞可被复现，因此提供的POC代码有效。

**投毒风险：**  提供的代码主要是 Dockerfile 和一些配置说明，用于搭建包含漏洞的 OURPHP 环境，方便进行漏洞复现和测试。Dockerfile 中主要进行了 PHP 环境配置、数据库配置、以及 Web 应用文件的复制等操作。虽然代码本身没有明显的恶意代码，但是Dockerfile中依赖安装了一些组件，有一定风险被投毒，比如替换软件源。因此，投毒风险评为10%。

**利用方式：**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，该 URL 指向 `/client/manage/ourphp_out.php`，并包含恶意的 payload。
2.  攻击者通过各种方式（例如：钓鱼邮件，社交媒体）诱使用户点击该 URL。
3.  用户点击恶意 URL 后，恶意 JavaScript 代码会在用户浏览器中执行。
4.  攻击者可以利用执行的 JavaScript 代码窃取用户 Cookie、篡改页面内容，甚至重定向用户到恶意网站。

**项目地址:** [Anandhu990/CVE-2023-30212_lab](https://github.com/Anandhu990/CVE-2023-30212_lab)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)