## CVE-2018-14714-ASUS RT-AC3200-命令注入

**漏洞编号:** CVE-2018-14714

**漏洞类型:** 命令注入

**影响应用:** ASUS RT-AC3200

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.0.0.4.382.50010

**利用条件:** 需要能够访问目标设备的web管理界面，可能需要认证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14714存在于ASUS RT-AC3200 3.0.0.4.382.50010版本的appGet.cgi中。攻击者可以通过`load_script` URL参数注入系统命令。 

**有效性：** 
提供的POC代码`TimeInjector.sh`通过时间注入的方式来判断漏洞是否存在，如果执行`sleep 3`命令后，响应时间超过3秒，则认为存在漏洞。脚本首先尝试登录，然后检查是否存在可利用的页面，最后通过时间延迟判断是否存在远程代码执行漏洞。此方法相对可靠，能够验证漏洞的存在性。

**投毒风险：** 
`TimeInjector.sh`脚本本身的主要功能是检测和利用命令注入漏洞。 潜在的投毒风险可能存在于以下几个方面：

1.  **依赖的外部命令：** 脚本依赖`curl`、`base64`、`python3`等命令。如果这些命令被恶意替换，则可能导致投毒。但这种风险与脚本本身无关，而是系统环境问题。
2.  **命令执行：** 脚本会执行用户提供的命令。如果攻击者利用此脚本执行恶意命令，则可能对目标系统造成损害。这属于漏洞利用的范畴，而非脚本本身的投毒行为。
3.  **结果误判：** 时间注入依赖于网络延迟，可能存在误判的情况。网络不稳定可能导致脚本误判存在漏洞，或者将无害的操作判断为恶意操作。
4. **用户输入：** 脚本需要用户输入目标地址、用户名和密码。如果用户提供错误的信息，可能导致脚本执行失败，或者连接到错误的系统。
综合来看，脚本本身存在一定的投毒风险，例如通过社会工程学诱导用户使用脚本，执行恶意命令等。但是，这些风险相对较低，脚本的主要功能仍然是漏洞检测和利用。 因此，投毒风险评估为10%。

**利用方式：** 
1.  **登录：** 首先，脚本尝试使用提供的用户名和密码登录到目标设备的Web管理界面。
2.  **获取Cookie：** 成功登录后，脚本会获取会话Cookie，用于后续的请求。
3.  **检查漏洞页面：** 脚本检查是否存在可利用的页面 (`appGet.cgi?hook=load_script('')`)。
4.  **时间注入：** 脚本通过向`load_script`参数注入`sleep 3`命令，并测量响应时间来判断是否存在命令注入漏洞。
5.  **命令执行：** 如果确定存在漏洞，攻击者可以使用 `--shell`选项启动交互式shell，或者使用 `--read-file`和 `--list-dir`选项来读取文件和列出目录。
6.  **交互式Shell：**  如果启动交互式shell，攻击者可以执行任意命令，从而完全控制目标设备。

**项目地址:** [BreadSquad/TimeInjector](https://github.com/BreadSquad/TimeInjector)

**漏洞详情:** [CVE-2018-14714](https://nvd.nist.gov/vuln/detail/CVE-2018-14714)