## CVE-2024-47533 - Cobbler XMLRPC 未授权远程代码执行

**漏洞编号:** CVE-2024-47533

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Cobbler

**危害等级:** 高危，允许未授权的远程代码执行，完全控制受影响的服务器。

**影响版本:** 3.0.0 <= version < 3.2.3, 3.3.0 <= version < 3.3.7

**利用条件:** 目标Cobbler服务器暴露了XMLRPC端口（通常是25151）且未打补丁，攻击者可以从网络访问该端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-47533是一个存在于Cobbler的XMLRPC API中的严重漏洞。该漏洞源于`utils.get_shared_secret()`始终返回`-1`，导致任何人都能够使用用户名``和密码`-1`连接到Cobbler XML-RPC服务，从而拥有完全控制权限。 

**利用方式：**

1.  攻击者使用空的用户名和密码(-1)通过XML-RPC连接到Cobbler服务器。
2.  攻击者使用已认证的会话创建恶意分发，配置和系统条目。
3.  攻击者将恶意payload注入到系统模板文件中，Payload 使用python 语句执行任意系统命令。
4.  攻击者调用`get_template_file_for_system`方法触发模板渲染，从而执行注入的命令。

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的POC代码，该漏洞是有效的。POC代码展示了如何利用此漏洞在目标系统上执行任意命令。

**投毒风险分析：**

对提供的POC代码进行了分析，发现存在轻微的投毒风险的可能性（约5%）。

*   **潜在的风险点：**
    *   虽然主要功能是利用漏洞，但攻击者可能会在CMD参数中设置高危指令,如果脚本被其他用户直接使用,可能会造成破坏。
    *   创建恶意profile, distro, system 等资源。

总而言之，虽然 POC 主要关注漏洞利用，但存在极小的可能性恶意修改或滥用该 POC 造成意外风险，因此评估投毒风险为5%。

**项目地址:** [00xCanelo/CVE-2024-47533-PoC](https://github.com/00xCanelo/CVE-2024-47533-PoC)

**漏洞详情:** [CVE-2024-47533](https://nvd.nist.gov/vuln/detail/CVE-2024-47533)