## CVE-2025-32756-Fortinet-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2025-32756

**漏洞类型:** Stack-Based Buffer Overflow

**影响应用:** FortiVoice, FortiMail, FortiNDR, FortiRecorder, FortiCamera

**危害等级:** 严重，未经身份验证的远程攻击者可以执行任意代码或命令

**影响版本:** 受影响版本见漏洞库信息

**利用条件:** 目标设备开启HTTP服务，且可从攻击者控制的网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32756是一个存在于多个Fortinet产品中的栈缓冲区溢出漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者通过发送特制的HTTP请求来执行任意代码或命令。漏洞存在于处理AuthHash cookie的流程中，具体来说，是`/remote/hostcheck_validate`端点的`enc`参数处理不当导致的。POC代码展示了如何通过构造包含恶意AuthHash的HTTP请求来触发缓冲区溢出。 

**有效性：**根据搜索结果，该漏洞已被实际利用，并且存在公开可用的POC代码，因此利用的有效性较高。

**投毒风险：**

  *  POC代码的主要目的是演示漏洞，并未发现明显的恶意行为。  
  *  计算Keystream部分涉及到了salt的获取，但salt被硬编码，降低了投毒风险。
  *  创建payload的部分较为复杂，存在一定风险。
  *  免责声明强调了使用限制，降低了滥用风险。

总体来说，投毒风险较低，约为10%。可能存在的投毒代码体现在Payload的生成和加密长度的处理上，攻击者可能会在这里插入恶意代码。建议在使用前仔细审查代码。

**利用方式：**

1.  攻击者首先需要确定目标设备是否存在漏洞。
2.  攻击者构造包含恶意`enc`参数的HTTP请求，该参数的值是特制的AuthHash，其中包含溢出payload。
3.  攻击者将构造的HTTP请求发送到目标设备的`/remote/hostcheck_validate`端点。
4.  目标设备在处理AuthHash时，由于缺少边界检查，导致栈缓冲区溢出。
5.  攻击者利用溢出覆盖栈上的返回地址，将其指向shellcode的地址。
6.  当函数返回时，将执行shellcode，从而允许攻击者执行任意代码或命令。


**项目地址:** [alm6no5/CVE-2025-32756-POC](https://github.com/alm6no5/CVE-2025-32756-POC)

**漏洞详情:** [CVE-2025-32756](https://nvd.nist.gov/vuln/detail/CVE-2025-32756)