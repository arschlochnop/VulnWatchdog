## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8 环境)

**利用条件:** 需要具备文件上传权限（如 Author 角色），服务器运行 PHP 8

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个存在于 WordPress 5.6.0 到 5.7.1 版本的 XXE 漏洞，但该漏洞只有在使用 PHP 8 的环境下才能被触发。具有文件上传权限的用户，例如 Author 角色，可以通过上传包含恶意 XML 内容的文件（例如 MP3 或 WAVE 文件）到 Media Library 中，触发 XXE 漏洞，读取服务器上的敏感文件。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞的有效性较高，存在公开的 PoC。虽然提供的代码只是MIT协议的license文件，但根据搜索结果，已经存在利用该漏洞的PoC。

**投毒风险：**
提供的代码只有MIT协议的 license文件，没有包含任何可执行代码或恶意指令。因此，投毒风险为 0%。

**利用方式：**
1.  攻击者需要具备 WordPress 的文件上传权限（如 Author 角色）。
2.  攻击者构造一个包含恶意 XML 外部实体声明的 MP3 或 WAVE 文件。
3.  攻击者通过 WordPress 的 Media Library 上传该恶意文件。
4.  当 WordPress 解析该文件时，会触发 XXE 漏洞，攻击者可以读取服务器上的任意文件。例如, 攻击者可读取`/etc/passwd`文件。

**项目地址:** [Tea-On/CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7](https://github.com/Tea-On/CVE-2021-29447-Authenticated-XXE-WordPress-5.6-5.7)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)