## CVE-2025-31324-SAP NetWeaver Visual Composer-未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer

**危害等级:** 高危，可导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统开启了SAP NetWeaver Visual Composer服务，且攻击者可以访问该服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-31324是SAP NetWeaver Visual Composer中的一个严重漏洞，由于Metadata Uploader组件缺乏适当的授权检查，未经身份验证的攻击者可以上传任意文件，包括恶意的可执行二进制文件（例如WAR或JSP webshell）。

**有效性：** 根据漏洞描述、搜索结果和提供的PoC代码，可以确定该PoC代码具有较高的有效性。搜索结果显示该漏洞已被积极利用，PoC代码实现了文件上传和触发功能，能够验证漏洞的存在和利用效果。

**投毒风险：** 提供的PoC.py代码主要功能是模拟上传文件和触发URL，未发现明显的投毒代码。虽然代码中存在允许上传任意文件的功能，这本身是漏洞利用的一部分，不是恶意投毒。Payload的内容由使用者决定，所以投毒的风险很低。LICENSE是MIT License，比较常见。

**利用方式：**
1.  **漏洞定位：** 攻击者首先需要确定目标系统上运行的SAP NetWeaver Visual Composer版本为受影响的版本（VCFRAMEWORK 7.50），并找到Metadata Uploader组件的URI，例如`/irj/portal/sap/bc/webdynpro/sap/ZWDC_METADATA_UPLDR`或`/developmentserver/metadatauploader`。
2.  **文件上传：** 攻击者使用PoC脚本，指定目标主机、端口、上传端点和恶意文件（WAR或JSP Webshell）。脚本会构造一个HTTP POST请求，将恶意文件作为`UPLOAD_METADATA`字段上传到目标服务器。
3.  **Payload触发：** 上传成功后，攻击者通过PoC脚本提供的trigger功能或者直接构造HTTP GET请求访问上传的文件，例如`/irj/portal/irj/servlet_jsp/irj/root/EvilPayload/shell.jsp`或`/visual_composer/shell.jsp`。这个步骤会触发恶意代码的执行。
4.  **远程代码执行：** 成功触发Payload后，攻击者即可在目标服务器上执行任意代码，实现远程控制。

总的来说，利用方式简单，危害巨大。

**项目地址:** [abrewer251/CVE-2025-31324_PoC_SAP](https://github.com/abrewer251/CVE-2025-31324_PoC_SAP)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)