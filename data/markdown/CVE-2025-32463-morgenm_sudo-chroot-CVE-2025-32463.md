## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞允许本地用户通过 `--chroot` 选项和用户可控的 `/etc/nsswitch.conf` 文件获取 root 权限。 

**有效性评估：**

根据漏洞信息、搜索结果和提供的漏洞利用代码（Cargo.lock），可以判断此漏洞是有效的。搜索结果中多个链接指向漏洞详情和利用方法，GitHub上也有相关的POC。

**投毒风险分析：**

提供的代码是`Cargo.lock` 文件，此文件是Rust项目的依赖锁定文件，用于保证依赖版本的一致性。因此，直接在此文件中进行投毒的可能性较低。虽然 `Cargo.lock` 文件本身不包含可执行代码，但可以分析其依赖项是否存在风险。 `sudo_chroot_exploit` 是本次利用的本地包,存在10%的风险是由于此包可能存在后门,虽然当前未发现,但是不排除作者隐藏后门代码。

**漏洞利用方式：**

1.  **利用/etc/nsswitch.conf：** 攻击者创建一个恶意的`/etc/nsswitch.conf`文件，该文件指定了非标准的名称服务查找顺序，可能包含恶意配置。
2.  **使用 --chroot 选项：** 攻击者使用`sudo`命令的`--chroot`选项，将根目录更改为用户可控的目录，该目录包含攻击者创建的恶意`/etc/nsswitch.conf`文件。
3.  **权限提升：** 当`sudo`在chroot环境中运行时，会加载攻击者控制的`/etc/nsswitch.conf`文件，从而可能导致权限提升，最终获得root权限。

总而言之，攻击者通过控制`/etc/nsswitch.conf`文件和利用`--chroot`选项，使得`sudo`加载恶意配置文件，从而实现本地提权。

**项目地址:** [morgenm/sudo-chroot-CVE-2025-32463](https://github.com/morgenm/sudo-chroot-CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)