## CVE-2019-10089-Apache JSPWiki-XSS

**漏洞编号:** CVE-2019-10089

**漏洞类型:** XSS

**影响应用:** Apache JSPWiki

**危害等级:** 中危，可能导致信息泄露和恶意脚本执行

**影响版本:** <= 2.11.0.M4

**利用条件:** 需要用户访问包含恶意插件链接的页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10089是Apache JSPWiki中存在的跨站脚本（XSS）漏洞。漏洞存在于2.11.0.M4及更早版本。攻击者可以通过构造恶意的插件链接，利用WYSIWYG编辑器触发XSS，在受害者浏览器中执行JavaScript代码，从而窃取敏感信息。 

**有效性分析：**
漏洞库信息明确指出该漏洞是由于精心构造的插件链接调用导致，结合搜索结果miggo.io的描述（虽然未提供补丁细节，但指出了插件执行处理程序处理不可信输入），可以判断POC的有效性较高，因为可以通过特定的插件语法注入恶意代码。

**投毒风险分析：**
提供的代码段是Apache JSPWiki的ChangeLog，记录了从2.11.0.M3到2.11.0.M4的修改历史。虽然ChangeLog本身不太可能直接包含投毒代码，但需要注意以下几点：
1.  **开发人员引入：** 某些修复可能会引入新的问题。例如，为了修复一个XSS漏洞，开发者可能会采用不安全的过滤方法，反而在其他地方引入新的XSS或其他类型的漏洞。
2.  **依赖项：** ChangeLog中提到升级了一些依赖项，例如lucene，这些依赖项本身可能存在漏洞。
3.  **间接影响：** 某些看似无害的更改可能会影响到其他功能，从而为攻击者创造机会。
因此，不能完全排除投毒的可能，但是直接在ChangeLog中发现恶意代码的可能性较低。假设存在潜在投毒，可能性估计为10%。

**利用方式：**
1.  攻击者需要在JSPWiki页面中插入包含恶意JavaScript代码的特定格式的插件链接。这可能通过编辑Wiki页面、评论或其他允许用户输入内容的功能实现。
2.  当受害者（例如管理员或其他用户）访问包含恶意插件链接的页面时，恶意JavaScript代码将在其浏览器中执行。
3.  攻击者可以利用JavaScript代码窃取受害者的Cookie、Session信息，或者执行其他恶意操作，例如重定向到钓鱼网站或执行管理操作（如果受害者具有相应的权限）。

搜索结果进一步表明，应尽快升级到修复了此漏洞的版本。

**项目地址:** [shoucheng3/apache__jspwiki_CVE-2019-10089_2-11-0-M4](https://github.com/shoucheng3/apache__jspwiki_CVE-2019-10089_2-11-0-M4)

**漏洞详情:** [CVE-2019-10089](https://nvd.nist.gov/vuln/detail/CVE-2019-10089)