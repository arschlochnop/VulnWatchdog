## CVE-2025-54574-Squid-Heap-based Buffer Overflow

**漏洞编号:** CVE-2025-54574

**漏洞类型:** Heap-based Buffer Overflow

**影响应用:** Squid

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** < 6.4

**利用条件:** 需要Squid服务开启且处理URN请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54574是Squid缓存代理中的一个堆缓冲区溢出漏洞，影响版本6.3及以下。该漏洞源于Squid在处理URN（Uniform Resource Name）时，由于不正确的缓冲区管理导致。攻击者可以通过发送特制的URN请求，触发缓冲区溢出，从而可能导致远程代码执行或者服务崩溃。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被修复（版本6.4）。搜索结果中多个来源（NVD, Red Hat, Snyk, Vulmon等）都提到了该漏洞，并强调了升级到6.4版本的重要性。提供的POC代码`/tmp/3c93b0e7fa097ed0743fefd2087010fd/README.md` 仅包含漏洞ID，并未提供实际的exp代码，因此无法直接判断其有效性。但漏洞本身有效，只是需要其他更详细的POC代码进行验证。

**投毒风险：**
提供的POC代码只有一个`README.md`文件，内容仅包含CVE编号。理论上，只包含CVE编号的文件不可能存在直接的投毒代码。考虑到代码仓库可能在之后被恶意修改，植入恶意代码，所以存在很低的投毒风险，这里给出的投毒风险为10%。

**利用方式：**
利用方式是向Squid服务器发送特制的包含恶意URN的HTTP请求。具体步骤如下：

1.  **发送恶意URN请求:** 攻击者构造一个包含过长或格式错误的URN的HTTP请求，发送给Squid服务器。
2.  **触发缓冲区溢出:** Squid处理该URN时，由于缓冲区管理不当，导致数据溢出，覆盖堆上的内存。
3.  **远程代码执行（可能）：** 如果攻击者能够精确控制溢出的内容，他们可以将恶意代码注入到内存中，并控制程序执行流程，最终实现远程代码执行。
4.  **拒绝服务（可能）：** 缓冲区溢出也可能导致Squid服务崩溃，从而造成拒绝服务攻击。

要成功利用此漏洞，攻击者需要对Squid的内存管理机制有一定的了解，并能够精确控制溢出的数据。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-54574](https://github.com/B1ack4sh/Blackash-CVE-2025-54574)

**漏洞详情:** [CVE-2025-54574](https://nvd.nist.gov/vuln/detail/CVE-2025-54574)