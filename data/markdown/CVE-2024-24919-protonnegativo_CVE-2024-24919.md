## CVE-2024-24919-Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark Gateway)

**利用条件:** 需要目标设备连接互联网并启用远程访问 VPN 或 Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个信息泄露漏洞。攻击者可以通过发送特制的请求，读取目标设备上的任意文件。利用方式如下：

1.  **Shodan 搜索：** 使用提供的 Shodan 脚本（1-CVE-2024-24919-Shodan-Search.py） 搜索暴露在互联网上的 Check Point Security Gateway。该脚本使用 Shodan API 和 `http.favicon.hash:794809961` 查询来识别目标。
2.  **漏洞验证：** 使用提供的 PoC 脚本 (2-CVE-2024-24919-PoC.py) 验证目标是否存在漏洞。该脚本发送一个包含路径遍历的 POST 请求到 `/clients/MyCRL` 路径，尝试读取 `/etc/passwd` 文件。
3.  **信息泄露：** 如果目标存在漏洞，服务器会返回 `/etc/passwd` 文件的内容或其他被请求的文件内容，从而导致敏感信息泄露。

根据漏洞库信息、搜索结果和漏洞利用代码分析，该漏洞利用有效性高，因为 CISA 已将其添加到已知被利用的漏洞列表中 (KEV)。搜索结果也表明该漏洞已被广泛利用。

分析 PoC 代码（2-CVE-2024-24919-PoC.py），该脚本的功能是发送包含路径遍历的HTTP POST请求，用于验证漏洞的存在。经验证，未发现明显的恶意代码或后门，因此投毒风险较低 (0%)。脚本的功能符合漏洞描述，主要目的是读取任意文件。

**项目地址:** [protonnegativo/CVE-2024-24919](https://github.com/protonnegativo/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)