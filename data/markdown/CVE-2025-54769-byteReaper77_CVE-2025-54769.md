## CVE-2025-54769-Xorux LPAR2RRD-目录遍历与RCE

**漏洞编号:** CVE-2025-54769

**漏洞类型:** 目录遍历与远程代码执行

**影响应用:** LPAR2RRD

**危害等级:** 高危，未经授权的远程代码执行

**影响版本:** 8.04

**利用条件:** 需要LPAR2RRD 8.04版本,以及一个具有上传权限的只读用户账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Xorux LPAR2RRD 8.04 中。攻击者利用经过身份验证的只读用户，通过文件上传功能进行目录遍历，将恶意 Perl 脚本上传到 CGI 可执行路径，从而实现远程代码执行。

**利用方式：**

1.  **身份验证：** 攻击者需要一个 LPAR2RRD 实例上的有效用户凭据，即使是只读权限的用户也足够。
2.  **文件上传：** 攻击者使用文件上传功能，同时构造包含目录遍历字符（如 `../`）的文件名，将文件上传到服务器上的任意位置。
3.  **Perl 脚本覆盖：** 攻击者的目标是将恶意 Perl 脚本上传到 CGI 目录，覆盖现有的 Perl 模块或上传新的模块。
4.  **远程代码执行：** 一旦恶意 Perl 脚本被上传并可通过 Web 服务器访问，攻击者可以通过 HTTP 请求触发该脚本，从而执行任意命令。

**有效性：**

提供的 POC 代码是有效的，因为它模拟了攻击过程中涉及的步骤：

1.  **创建恶意 Perl 脚本：** `CreateFilePerl()` 函数创建名为 `users.pl` 的文件，其中包含一个简单的 Perl 脚本，该脚本接受 `cmd` 参数并在服务器上执行 `whoami` 命令。
2.  **文件上传（在C代码里没有展示）：** 代码中缺少实际执行上传操作的部分,需要结合实际的LPAR2RRD接口进行数据交互。
3.  **触发远程代码执行：** `getRequest()` 函数构造一个 HTTP GET 请求，以触发上传的 Perl 脚本。

**投毒风险：**

虽然提供的代码看起来像一个合法的漏洞利用程序，但仍然存在一些细微的投毒风险：

*   **休眠函数:** 代码中包含 `sleepAssembly()` 函数，该函数使用内联汇编来暂停执行。这可能会被滥用来延迟执行恶意代码，从而使检测更加困难。 *   **随机因素:** 通过在利用链中添加随机性或依赖性，攻击者可以使漏洞利用程序在某些情况下失败，从而降低被发现的几率。 *   **自定义syscall:**  `syscallLinux()`可能存在隐藏的恶意行为，虽然现在是退出程序，但是可能可以被修改为其他恶意syscall。 综上，投毒风险大约为10%。主要集中在syscallLinux和sleepAssembly函数上。

**项目地址:** [byteReaper77/CVE-2025-54769](https://github.com/byteReaper77/CVE-2025-54769)

**漏洞详情:** [CVE-2025-54769](https://nvd.nist.gov/vuln/detail/CVE-2025-54769)