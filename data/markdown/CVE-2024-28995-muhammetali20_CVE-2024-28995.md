## CVE-2024-28995 SolarWinds Serv-U 目录遍历漏洞

**漏洞编号:** CVE-2024-28995

**漏洞类型:** 目录遍历

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** 15.4.2 HF 1 及之前版本

**利用条件:** 需要网络访问，目标存在漏洞版本的SolarWinds Serv-U

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28995 是 SolarWinds Serv-U 中的一个目录遍历漏洞。未经身份验证的远程攻击者可以利用此漏洞读取目标服务器磁盘上的任意文件，包括二进制文件。根据搜索结果和漏洞利用代码，该漏洞利用有效。漏洞利用代码中的 `CVE-2024-28995.yaml` 文件包含 nuclei 模板，该模板通过构造包含目录遍历序列的 URL 来尝试读取服务器上的敏感文件，例如 `Serv-U-StartupLog.txt`、`win.ini` 和 `/etc/passwd`。`serv-u-version-detect.yaml` 模板用于检测 Serv-U 的版本，但其本身没有利用漏洞。在 `README.md` 中，作者提供了使用 nuclei 执行漏洞利用的命令，并展示了漏洞利用成功的截图。存在投毒风险的分析：该漏洞利用仓库中主要包含漏洞检测和利用的 YAML 配置文件和一个简短的 README，没有发现明显的恶意代码。`serv-u-version-detect.yaml` 文件只是用于版本检测，本身不具备攻击性。`CVE-2024-28995.yaml` 文件是漏洞利用的核心，其中包含了攻击载荷。由于作者提供了明确的漏洞利用方法和目标文件，因此判断为投毒的概率较低。考虑到仓库中包含的信息有限，作者可能在其他地方（例如，构建脚本或依赖项）隐藏了恶意代码，但可能性相对较低。总的来说，该仓库中存在作者隐藏的投毒代码的可能性为 10%。利用方式：攻击者可以通过构造包含目录遍历序列的 URL（例如 `/?InternalDir=/../../../../ProgramData/RhinoSoft/Serv-U/&InternalFile=Serv-U-StartupLog.txt`）来读取服务器上的敏感文件。攻击者可以使用 nuclei 等工具自动执行漏洞利用过程。

**项目地址:** [muhammetali20/CVE-2024-28995](https://github.com/muhammetali20/CVE-2024-28995)

**漏洞详情:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)