## CVE-2023-29357-Microsoft SharePoint Server-权限提升

**漏洞编号:** CVE-2023-29357

**漏洞类型:** 权限提升

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，可能导致权限提升和远程代码执行

**影响版本:** 16.0.0 <= version < 16.0.10399.20005

**利用条件:** 需要网络访问SharePoint服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29357是Microsoft SharePoint Server中的一个权限提升漏洞。未经身份验证的攻击者可能利用此漏洞冒充经过身份验证的用户，从而执行任意代码。该漏洞位于SharePoint Server的身份验证机制中，允许攻击者绕过身份验证算法，获取管理员权限。漏洞利用代码通过构造特定的请求，利用SharePoint Server对传入的身份验证请求处理不当的缺陷，欺骗服务器认为攻击者是具有管理权限的用户。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以确认该漏洞存在，并且有可用的POC利用代码。搜索引擎结果显示，该漏洞已被CISA添加到已知被利用的漏洞目录中，表明该漏洞在野外已被积极利用，POC代码的有效性高。

**投毒风险评估：**
该漏洞利用代码主要用于权限提升，但POC中存在一定的投毒风险。虽然作者声明该脚本仅用于教育目的和授权测试，并没有RCE功能，但在`exploit.py`中，使用了`leakpy`库，并且与LeakIX集成。恶意使用者可能利用LeakIX接口批量扫描和攻击SharePoint服务器，这可能会造成大规模的未授权访问和潜在的损害，因此存在一定的投毒风险。 `leakpy`库本身可能存在未知的安全问题。该脚本依赖外部服务LeakIX，如果LeakIX服务本身被攻陷，那么使用此脚本也可能被植入恶意代码。根据代码审计，判断投毒风险为10%。

**利用方式分析：**
1.  **单URL利用：** 使用`-u`参数指定目标SharePoint URL。
2.  **列表URL利用：** 使用`-l`参数指定包含多个SharePoint URL的文件。
3.  **LeakIX集成利用：** 使用`--leakpy`参数从LeakIX获取URL列表进行批量利用，需要LeakIX Pro API密钥。
攻击者可以通过构造恶意请求，伪造身份验证信息，从而提升权限。成功利用该漏洞后，攻击者可以执行任意代码，访问敏感数据，甚至控制整个SharePoint服务器。建议及时安装Microsoft提供的安全更新。

**项目地址:** [Chocapikk/CVE-2023-29357](https://github.com/Chocapikk/CVE-2023-29357)

**漏洞详情:** [CVE-2023-29357](https://nvd.nist.gov/vuln/detail/CVE-2023-29357)