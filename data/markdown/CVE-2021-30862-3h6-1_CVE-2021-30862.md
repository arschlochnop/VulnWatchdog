## CVE-2021-30862-iTunes U-XSS

**漏洞编号:** CVE-2021-30862

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** iTunes U

**危害等级:** 中危，可能导致敏感信息泄露和远程代码执行（通过利用iTunes API）

**影响版本:** < 3.8

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-30862 存在于 iTunes U 3.8 之前的版本。该漏洞允许攻击者通过构造恶意 URL，在 iTunes U 的上下文中执行任意 JavaScript 代码。根据提供的漏洞利用代码和描述，利用方式如下：

1.  **利用 itms-itunesu:// 协议:** POC.html 和 POC_5.html 使用 `itms-itunesu://` 协议打开指定的 URL，从而利用 iTunes U 加载恶意网页。
2.  **利用 iTunes API:** POC_2.html 尝试使用 `iTunes.softwareApplicationWithBundleID_` 和 `launchWithURL_options_suspended_` API 启动计算器应用，展示了远程代码执行的可能性。
3.  **信息泄露:** POC_3.html 尝试通过 XMLHttpRequest 将 iTunes 账号信息发送到攻击者的服务器。
4.  **文件读取:** POC_4.html 尝试读取 `file://r.mzstatic.com/etc/passwd` 文件内容，并将其发送到攻击者的服务器，试图泄露敏感文件。
5.  **UAF (Use-After-Free):** POC_6.html 尝试通过 `iTunes.makeWindow()` 创建窗口后立即释放两次，导致程序崩溃，展示了UAF漏洞的存在。
6.  **绕过沙箱:** README.md 描述了该漏洞可以绕过沙箱限制，执行恶意代码。

**有效性评估:** 根据漏洞描述和 POC 代码，该漏洞是有效的，可以导致 XSS、信息泄露，甚至在一定条件下可以执行任意代码。

**投毒风险评估:** 仓库中可能存在作者隐藏的投毒代码的概率较低，约为 10%。主要原因是：

    *   大部分POC是直接利用已知的API或协议执行操作，逻辑比较清晰。
    *   main.js尝试实现 `fakeobj` 和 `addrof`，但未成功实现，也未发现明确的后门代码。
    *   `Insert the URL to POST to here.` 说明poc是需要攻击者自行插入url,因此这里并不存在投毒后门

**项目地址:** [3h6-1/CVE-2021-30862](https://github.com/3h6-1/CVE-2021-30862)

**漏洞详情:** [CVE-2021-30862](https://nvd.nist.gov/vuln/detail/CVE-2021-30862)