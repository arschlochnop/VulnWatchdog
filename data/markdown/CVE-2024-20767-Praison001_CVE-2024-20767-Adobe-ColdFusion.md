## CVE-2024-20767-Adobe ColdFusion Improper Access Control

**漏洞编号:** CVE-2024-20767

**漏洞类型:** Improper Access Control / Arbitrary File Read

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2023.6, 2021.12

**利用条件:** 需要 ColdFusion 管理面板暴露在互联网上。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-20767 是 Adobe ColdFusion 中的一个权限控制不当漏洞，攻击者可以利用该漏洞读取任意文件系统上的文件。根据漏洞信息，攻击复杂度较高（AC:H），需要 ColdFusion 管理面板对外开放。漏洞利用代码 `exploit.py` 首先尝试从 `/CFIDE/adminapi/_servermanager/servermanager.cfc?method=getHeartBeat` 获取 UUID。然后，使用这个 UUID，构造一个包含路径遍历的 URL，例如 `/pms?module=logging&file_name=../../../../../../../../../../../../../..` + `targetFile` + `&number_of_lines=10000`，并将 UUID 放在请求头中，从而读取目标文件。此漏洞利用代码的投毒风险较低，因为代码逻辑简单，主要功能是利用漏洞读取文件，没有发现恶意代码或后门植入的痕迹。存在的风险可能是利用该漏洞进行未授权的访问，但在代码层面本身没有发现明显的投毒迹象。代码的有效性取决于目标系统是否满足漏洞利用的条件（存在漏洞且管理面板对外开放）。

**项目地址:** [Praison001/CVE-2024-20767-Adobe-ColdFusion](https://github.com/Praison001/CVE-2024-20767-Adobe-ColdFusion)

**漏洞详情:** [CVE-2024-20767](https://nvd.nist.gov/vuln/detail/CVE-2024-20767)