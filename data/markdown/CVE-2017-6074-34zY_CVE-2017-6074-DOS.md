## CVE-2017-6074 - Linux DCCP Double-Free

**漏洞编号:** CVE-2017-6074

**漏洞类型:** Double-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致本地提权或拒绝服务

**影响版本:** <= 4.9.11

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-6074 存在于 Linux 内核的 DCCP (Datagram Congestion Control Protocol) 实现中。`dccp_rcv_state_process` 函数在处理 LISTEN 状态下的 `DCCP_PKT_REQUEST` 包时，对数据结构处理不当，导致 double-free 漏洞。 

**有效性：**

根据漏洞库信息、搜索结果（特别是 `xairy.io` 的分析和 Exploit-DB 上的 PoC）以及提供的 PoC 代码，该漏洞是有效的，并且存在可利用的 PoC。
提供的PoC代码明确指出是为了演示拒绝服务（DoS）攻击，而不是提权，但也确认了漏洞的存在以及可以触发内核崩溃。

**投毒风险：**

PoC 代码本身看起来相对直接，主要是利用 DCCP 协议的漏洞触发 double-free 漏洞来导致内核崩溃。检查了PoC代码，在给定的代码中没有发现明显的恶意后门或植入行为。
存在一定的投毒风险，主要基于以下几点：
1.  **代码修改：**  攻击者可能会修改 PoC 代码，使其在触发漏洞的同时，执行其他恶意操作，例如，尝试进行内存dump，或尝试进行提权。
2.  **编译环境：**  攻击者可能会提供一个包含恶意代码的编译环境，诱导用户使用该环境编译 PoC 代码。

综合评估，投毒风险较低，约为10%。这个百分比是基于代码本身的可读性和相对简单的逻辑，以及PoC作者已经明确表明了其目的。

**利用方式：**

1.  **触发漏洞：** 利用需要先创建一个 DCCP socket，并使其处于监听状态。然后，利用 PoC 代码发送特制的 `DCCP_PKT_REQUEST` 包，触发 `dccp_rcv_state_process` 函数中的漏洞。
2.  **Double-Free：**  由于对数据结构处理不当，内核会尝试释放同一块内存两次，导致 double-free 漏洞。
3.  **内核崩溃/DoS：**  Double-free 漏洞会导致内核崩溃，从而造成拒绝服务 (DoS)。

提供的 PoC 代码专注于触发 DoS，但其他利用方式（如本地提权）也是存在的，尽管需要更复杂的利用技术。

**项目地址:** [34zY/CVE-2017-6074-DOS](https://github.com/34zY/CVE-2017-6074-DOS)

**漏洞详情:** [CVE-2017-6074](https://nvd.nist.gov/vuln/detail/CVE-2017-6074)