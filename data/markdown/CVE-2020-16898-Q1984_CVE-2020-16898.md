## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行/拒绝服务

**影响应用:** Windows TCP/IP 堆栈

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** Windows 10 Version 1709 - 2004, Windows Server 2019, Windows Server version 2004, Windows Server, version 1903/1909

**利用条件:** 需要与目标主机处于同一网络或可发送ICMPv6 Router Advertisement数据包到目标主机。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-16898，又名“Bad Neighbor”，是Windows TCP/IP堆栈中的一个远程代码执行漏洞。当Windows TCP/IP堆栈不正确地处理ICMPv6 Router Advertisement数据包时，就会出现此漏洞。攻击者可以通过发送特制的ICMPv6 Router Advertisement数据包到远程Windows计算机来利用此漏洞。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个Windows版本，且存在公开的PoC代码。搜索结果显示，该漏洞可能导致蓝屏死机（BSOD），进一步说明了其可能导致拒绝服务。尽管有些描述中提到远程代码执行的可能性，但提供的PoC代码的README.md文件表明该PoC主要用于触发BSOD (DoS)。因此，该PoC代码被认为是有效的，至少可以触发拒绝服务攻击。

**投毒风险：**
提供的PoC代码只包含README.md文件，文件内容描述了如何使用`CVE-2020-16898.exe`，并声明“Use at own risk!”。仅凭此信息无法判断`CVE-2020-16898.exe`是否存在恶意代码。但是，考虑到漏洞利用的敏感性，存在一定的投毒风险。由于缺少实际的可执行文件代码，投毒风险评估为低，约为10%。主要原因是无法验证可执行文件的真实功能。

**利用方式：**
1.  **目标确定：** 确定运行受影响Windows版本的计算机。
2.  **网络连接：** 攻击者需要与目标计算机位于同一网络中，或者能够向目标计算机发送ICMPv6 Router Advertisement数据包。
3.  **数据包构造：** 攻击者需要构造特制的ICMPv6 Router Advertisement数据包，其中包含恶意数据，特别是Option Type 25，可能导致缓冲区溢出。
4.  **攻击执行：** 将构造的数据包发送到目标计算机。
5.  **结果：** 成功利用此漏洞可能导致目标计算机蓝屏死机（拒绝服务），或者，如果攻击者能够绕过缓解措施，则可能执行任意代码。快速修复的可用性表示该漏洞可能会导致DoS。

**项目地址:** [Q1984/CVE-2020-16898](https://github.com/Q1984/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)