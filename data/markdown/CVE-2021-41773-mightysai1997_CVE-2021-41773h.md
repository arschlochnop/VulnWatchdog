## CVE-2021-41773-Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 需要目标服务器运行受影响的 Apache HTTP Server 版本，并且 Alias 指令配置不当，允许访问受限目录之外的文件。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中的一个路径遍历漏洞。攻击者可以利用该漏洞，通过构造包含特殊字符的 URL，绕过 Alias 指令的限制，访问服务器上未授权的文件。如果服务器配置允许 CGI 脚本在这些 aliased 路径下执行，则攻击者可能进一步实现远程代码执行。

**有效性分析：**

根据漏洞库信息和搜索结果，CVE-2021-41773 在野外已被利用。提供的 Dockerfile 使用了 `httpd:2.4.49-alpine` 镜像，明确指定了受影响的 Apache 版本。Dockerfile 下载并替换了默认的 `httpd.conf` 配置文件。如果这个 `httpd.conf` 配置不安全，例如没有正确的 `Require all denied` 规则，那么漏洞利用将是有效的。综上所述，该POC的有效性较高，但依赖于 `httpd.conf` 的具体内容。

**投毒风险分析：**

提供的文件列表中，`LICENSE` 文件是标准的 Apache 许可证，没有投毒风险。Dockerfile本身只包含下载配置文件和替换配置文件的操作。投毒风险主要在于从 `https://raw.githubusercontent.com/itsecurityco/CVE-2021-41773/main/httpd.conf` 下载的 `httpd.conf` 文件。攻击者可能会修改该文件，例如：

*   **放宽访问限制：**  允许访问敏感目录，例如 `/var/www/html` 之外的目录。
*   **配置恶意 CGI 脚本：**  允许执行任意代码。
*   **植入后门：**  在配置文件中添加恶意指令，例如通过 mod_rewrite 实现后门访问。

由于无法直接分析远程 `httpd.conf` 文件的内容，因此存在一定的投毒风险。 这里估计投毒风险为 10%，因为该项目看起来是为了演示漏洞，不太可能包含恶意代码，但仍然需要谨慎。

**利用方式分析：**

利用方式主要通过构造恶意的 HTTP GET 请求，其中包含经过 URL 编码的路径遍历字符。例如，可以使用 `%2e%2e/` 或 `%252e%252e/` 来绕过路径规范化，访问目标目录之外的文件。

例如，如果目标服务器存在以下 Alias 配置：

```
Alias /images /var/www/images
```

攻击者可以使用以下 URL 访问 `/etc/passwd` 文件：

```
GET /images/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd HTTP/1.1
```

如果 CGI 脚本已启用，则可以构造包含恶意代码的 CGI 脚本，并通过路径遍历漏洞执行它，从而实现远程代码执行。

**项目地址:** [mightysai1997/CVE-2021-41773h](https://github.com/mightysai1997/CVE-2021-41773h)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)