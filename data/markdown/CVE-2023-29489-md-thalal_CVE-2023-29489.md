## CVE-2023-29489 - cPanel XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致信息泄露，会话劫持，恶意代码执行等

**影响版本:** before 11.109.9999.116

**利用条件:** 需要目标cPanel实例存在漏洞，且用户访问恶意构造的URL

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-29489 是一个存在于 cPanel 11.109.9999.116 之前的版本中的跨站脚本漏洞。攻击者可以通过 `cpsrvd` 错误页面以及无效的 `webcall ID` 触发此漏洞。从搜索引擎的结果和提供的POC代码来看，此漏洞的利用方式是构造包含恶意 JavaScript 代码的 URL。当用户访问该 URL 时，恶意脚本会在用户的浏览器中执行，从而导致各种安全问题，例如会话劫持、信息窃取或恶意页面重定向。 

**有效性:**  根据搜索结果和提供的POC代码描述，该漏洞是可利用的。POC代码中提供的`pip install CVE-2023-29489`以及使用示例都表明这是一个已经实现的漏洞利用工具。

**投毒风险:**  提供的漏洞利用代码主要是一个扫描器，通过pip安装。`/tmp/b6d8a46aab8a56bc0bf992222fbb13bc/cve202329489/__init__.py`文件为空，初步判断没有恶意代码。但是README.md中引用了外部图片资源 `cve202329489/Pictures/screenshot1.png`和`cve202329489/Pictures/screenshot2.png`，如果这些图片服务器被攻陷，可能存在投毒风险。以及需要关注 `pip install CVE-2023-29489`是否真的从官方源安装，如果从第三方源安装，则存在投毒的可能。 总体来说，风险较低，估计投毒风险为10%。

**利用方式:**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，该 URL 包含一个无效的 `webcall ID` 参数。
2.  攻击者诱使用户点击该恶意 URL，例如通过钓鱼邮件或社交媒体。
3.  如果目标 cPanel 实例存在漏洞，并且用户点击了恶意 URL，则恶意 JavaScript 代码会在用户的浏览器中执行。
4.  攻击者可以利用执行的 JavaScript 代码来窃取用户的 cookie，重定向用户到恶意网站，或执行其他恶意操作。

**项目地址:** [md-thalal/CVE-2023-29489](https://github.com/md-thalal/CVE-2023-29489)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)