## CVE-2021-29425-Apache Commons IO-路径遍历

**漏洞编号:** CVE-2021-29425

**漏洞类型:** 路径遍历

**影响应用:** Apache Commons IO

**危害等级:** 中危，可能导致文件访问限制绕过

**影响版本:** 2.2 - 2.6

**利用条件:** 应用程序使用 FileNameUtils.normalize 方法处理用户提供的路径输入

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29425 存在于 Apache Commons IO 2.2 到 2.6 版本中。当应用程序调用 `FileNameUtils.normalize` 方法处理类似 `//../foo` 或 `\\..\foo` 这样的不规范输入时，该方法会返回相同的值，这可能导致有限的路径遍历漏洞。攻击者可以利用该漏洞访问父目录中的文件，但不能访问更高级别的目录。

**有效性：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，并且有公开的利用方法。POC 代码示例展示了如何利用不规范的路径输入绕过文件访问限制。虽然该漏洞只能实现有限的路径遍历，但仍然可能造成安全风险。

**投毒风险：**
提供的代码片段（CONTRIBUTING.md）是 Apache Commons IO 项目的贡献指南，用于指导开发者如何参与项目开发。该文件不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  应用程序使用受影响的 Apache Commons IO 版本（2.2 - 2.6）。
2.  应用程序调用 `FileNameUtils.normalize` 方法处理用户提供的文件路径输入。
3.  攻击者构造包含 `//../` 或 `\\..\` 等不规范路径的输入。
4.  `FileNameUtils.normalize` 方法未能正确处理这些不规范路径，导致返回原始输入。
5.  应用程序使用 `normalize` 方法返回的路径构造文件访问路径，从而允许攻击者访问父目录中的文件。

**总结：**
该漏洞的利用依赖于应用程序如何使用 `FileNameUtils.normalize` 方法的返回值。如果应用程序没有对 `normalize` 方法返回的路径进行进一步的验证和过滤，则可能存在安全风险。建议升级到 Apache Commons IO 2.7 或更高版本，该版本中 `FileNameUtils.normalize` 方法会返回 null 来指示无效输入。

**项目地址:** [shoucheng3/asf__commons-io_CVE-2021-29425_2-6](https://github.com/shoucheng3/asf__commons-io_CVE-2021-29425_2-6)

**漏洞详情:** [CVE-2021-29425](https://nvd.nist.gov/vuln/detail/CVE-2021-29425)