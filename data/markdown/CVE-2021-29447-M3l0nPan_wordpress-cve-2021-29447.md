## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XXE

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** >= 5.6.0, < 5.7.1，运行在PHP 8环境下

**利用条件:** 需要拥有上传文件权限（例如，作者权限），并且服务器运行在PHP 8环境下

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞存在于WordPress的媒体库中，允许具有上传文件权限的用户通过上传包含恶意XML的音频文件（如WAV或MP3）来触发XXE漏洞。此漏洞要求WordPress运行在PHP 8环境下，因为该版本的PHP中使用的XML解析器存在缺陷。攻击者可以利用此漏洞读取服务器上的敏感文件。PoC利用了本地启动HTTP服务的方式来接收目标服务器发送的文件内容，相对安全。投毒风险极低，主要风险点在脚本第一行的`#!/usr/bin/dev python3`，存在一定的误导性，如果用户直接复制该代码，可能会导致执行失败，但对安全性没有影响。主要功能代码位于`wordpress-cve-2021-29447.py`文件中，实现了漏洞利用的全部流程，包括身份验证、恶意文件上传和文件读取。

**项目地址:** [M3l0nPan/wordpress-cve-2021-29447](https://github.com/M3l0nPan/wordpress-cve-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)