## CVE-2024-23673 - Apache Sling Servlets Resolver Path Traversal

**漏洞编号:** CVE-2024-23673

**漏洞类型:** 路径遍历

**影响应用:** Apache Sling Servlets Resolver

**危害等级:** 高危，可能导致恶意代码执行

**影响版本:** < 2.11.0

**利用条件:** 需要对存储库的写入权限和特定的系统配置

**POC 可用性:** 是，但提供的代码并非直接的利用代码

**投毒风险:** 10%

## 详情

CVE-2024-23673 是 Apache Sling Servlets Resolver 中存在的一个路径遍历漏洞。攻击者如果具有对存储库的写入权限，则可能通过构造恶意的路径，欺骗 Sling Servlet Resolver 加载之前上传的恶意脚本，从而导致远程代码执行。

**有效性：**
提供的“漏洞利用代码”实际上是 Apache Sling 项目的一些标准文件，如行为准则、贡献指南、Jenkinsfile 和 LICENSE 文件。这些文件本身不构成漏洞利用，但暗示了该漏洞存在于该项目中。真正的漏洞利用方式需要利用路径遍历漏洞上传恶意脚本并执行它。因此，**提供的代码本身无效，但该漏洞是存在的**。

**投毒风险：**
提供的代码中并没有明显的恶意或投毒代码。这些文件是项目标准文件，但是需要注意该仓库中是否存在作者隐藏的恶意代码，代码被投毒的可能性较低，估计在10%左右，主要考虑后续开发人员可能会提交恶意代码。

**利用方式：**
1.  **先决条件：**
    *   目标系统运行着 Apache Sling Servlets Resolver 且版本低于 2.11.0。
    *   攻击者需要具有对目标系统存储库的写入权限。
    *   目标系统必须存在易受攻击的特定配置，即 Sling Servlet Resolver 允许通过路径遍历加载上传的脚本。
2.  **利用步骤：**
    *   攻击者首先创建一个包含恶意代码的脚本文件（例如，JSP、Servlet）。
    *   攻击者利用路径遍历漏洞，将该脚本文件上传到目标系统的存储库中，将其放置在一个 Sling Servlet Resolver 可以访问到的位置。攻击者需要构造包含 `../` 等路径遍历字符的 URL，以绕过文件上传限制，并将文件写入到预期之外的位置。
    *   攻击者通过特定的 URL 访问上传的恶意脚本文件，触发 Sling Servlet Resolver 加载并执行该脚本。
3.  **结果：**
    *   恶意脚本执行，攻击者获得在目标系统上执行任意代码的能力。

**总结：**
该漏洞利用的关键在于利用路径遍历将恶意脚本上传到服务器可访问的位置，然后通过请求该脚本来触发执行。虽然提供的代码本身不是利用代码，但它与存在漏洞的 Apache Sling Servlets Resolver 项目相关。

**项目地址:** [shoucheng3/apache__sling-org-apache-sling-servlets-resolver_CVE-2024-23673_2-10-0](https://github.com/shoucheng3/apache__sling-org-apache-sling-servlets-resolver_CVE-2024-23673_2-10-0)

**漏洞详情:** [CVE-2024-23673](https://nvd.nist.gov/vuln/detail/CVE-2024-23673)