## CVE-2021-38003 - Chrome V8 堆损坏

**漏洞编号:** CVE-2021-38003

**漏洞类型:** 堆损坏

**影响应用:** Google Chrome (V8)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 95.0.4638.69

**利用条件:** 用户访问恶意构造的HTML页面

**POC 可用性:** 是

**投毒风险:** 2%

## 详情

CVE-2021-38003 是 Google Chrome V8 引擎中的一个堆损坏漏洞。攻击者可以通过构造恶意的 HTML 页面，诱使用户在受影响的 Chrome 版本中打开，从而触发漏洞并可能导致远程代码执行。

**有效性：**

根据漏洞信息和搜索结果，此漏洞已被积极利用。提供的 POC 代码看起来像是利用了 V8 引擎中 TheHole 对象的泄漏漏洞。多个搜索结果提到了“TheHole”泄漏与此 CVE 的关系（例如，网页 4、6 和 7）。POC 代码包含 `leak_array_map`, `leak_addr_helper`, 和 `fake_obj_helper` 函数，这些函数很可能旨在通过利用 TheHole 对象的泄漏来操纵内存布局。代码还包括JIT优化的循环，旨在使漏洞更稳定。

**投毒风险：**

代码中存在一些混淆和复杂的计算，这可能被利用来隐藏恶意代码。此外，代码作者从推特上获取了部分代码, 意味着其中可能存在一些未知的行为。经过分析,认为存在2%投毒的可能性。主要风险在于：

*   **复杂性：** 漏洞利用代码通常很复杂，攻击者可能会在其中嵌入后门或恶意指令，而不会立即被发现。
*   **间接依赖：** 该代码依赖于推特，如果推特来源被篡改，可能导致投毒。

**利用方式：**

1.  **TheHole 对象泄漏：** 利用 V8 引擎的漏洞，泄漏 TheHole 对象的地址。
2.  **内存布局操纵：** 利用泄漏的地址，操纵堆内存的布局。
3.  **堆损坏：** 通过操纵内存布局，实现堆损坏，覆盖关键数据结构。
4.  **远程代码执行：** 利用堆损坏，控制程序执行流程，实现远程代码执行。

总而言之，此漏洞利用的有效性较高，但存在轻微的投毒风险。利用方式是通过泄漏 TheHole 对象，操纵堆内存，最终实现远程代码执行。

**项目地址:** [SpiralBL0CK/Chrome-V8-RCE-CVE-2021-38003](https://github.com/SpiralBL0CK/Chrome-V8-RCE-CVE-2021-38003)

**漏洞详情:** [CVE-2021-38003](https://nvd.nist.gov/vuln/detail/CVE-2021-38003)