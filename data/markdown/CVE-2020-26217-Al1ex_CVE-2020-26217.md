## CVE-2020-26217-XStream-RCE

**漏洞编号:** CVE-2020-26217

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** XStream

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 1.4.14

**利用条件:** 需要目标应用使用存在漏洞的XStream版本并且依赖存在漏洞的blocklist配置。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-26217是XStream的一个远程代码执行漏洞。该漏洞源于XStream在处理XML输入流时，由于不安全的反序列化操作，可能允许远程攻击者通过操纵输入流来执行任意shell命令。只有依赖黑名单的用户受到影响，使用安全框架白名单的用户不受影响。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，该POC代码**有效**。POC代码提供了一个XML Payload，该Payload利用`jdk.nashorn.internal.objects.NativeString`和`com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data`等类，最终通过`java.lang.ProcessBuilder`执行命令。该PoC尝试执行 `calc.exe` 命令，可以验证漏洞是否存在。

**投毒风险分析：**
该仓库中可能存在投毒代码的风险较低，约为5%。主要基于以下考虑：
*   **POC性质：** 该仓库主要目的是为了演示和复现漏洞，包含POC代码是很正常的。主要的java代码为漏洞验证代码，没有发现异常。
*   **文件名：**  仓库中包含一个名为`README.md`的文件，这通常用于描述仓库的目的和使用方法。如果存在恶意代码，通常会隐藏在其他文件中，而不是放在显眼的README中。
*   **payload：**  提供的XML Payload 是直接构造的，用于触发命令执行。没发现额外的后门代码。
*   **作者意图：**  从仓库结构和代码来看，作者的意图更偏向于漏洞的演示，而不是恶意攻击。

**利用方式：**
1.  **目标应用：** 目标应用必须使用XStream，且版本低于1.4.14。
2.  **黑名单配置：** 目标应用使用XStream的默认黑名单安全配置。
3.  **构造Payload：** 攻击者构造恶意的XML Payload，例如提供的POC代码。
4.  **发送Payload：** 攻击者将构造好的XML Payload发送给目标应用。
5.  **触发漏洞：** XStream解析XML时，由于不安全的反序列化操作，触发命令执行。
6.  **远程代码执行：** 攻击者在目标服务器上执行任意命令。

**项目地址:** [Al1ex/CVE-2020-26217](https://github.com/Al1ex/CVE-2020-26217)

**漏洞详情:** [CVE-2020-26217](https://nvd.nist.gov/vuln/detail/CVE-2020-26217)