## CVE-2023-3460-Ultimate Member-权限提升

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member

**危害等级:** 高危，可被未授权用户创建管理员账户并完全控制网站

**影响版本:** < 2.6.7

**利用条件:** 需要目标网站安装了Ultimate Member插件并且版本低于2.6.7, 且注册功能开启

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-3460 是 Ultimate Member WordPress 插件中的一个权限提升漏洞。未经身份验证的攻击者可以通过构造恶意请求注册用户，并将其权限提升为管理员。漏洞利用代码 `exploit.py` 模拟了这一过程，它首先获取注册表单的 nonce 值，然后构造包含管理员权限的注册请求，发送到目标网站的注册页面。如果注册成功，攻击者将获得一个具有管理员权限的新账户。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞信息表明该漏洞已被积极利用。

**投毒风险：**

漏洞利用代码本身的主要功能是实现权限提升，但存在一定的投毒风险。代码中`email = "exploit@rajneesh.com"`，若此邮箱为攻击者所有，则可以通过大量注册垃圾账户，造成拒绝服务攻击，增加服务器负担。此外，需要用户手动输入`form_id`，`username`，`password`，攻击者可以通过精心构造的提示语，诱导用户输入敏感信息。因此，判断投毒风险为 10%。该漏洞利用代码主要集中在利用已知的漏洞，没有发现明显的后门代码。

**利用方式：**

1.  **确定目标：** 找到安装了 Ultimate Member 插件且版本低于 2.6.7 的 WordPress 网站。
2.  **确定注册页面：** 找到目标网站的注册页面。
3.  **运行漏洞利用代码：** 运行 `exploit.py` 脚本，输入目标 URL、`form_id`、用户名和密码。
4.  **获取管理员权限：** 脚本将尝试注册一个具有管理员权限的新用户。如果成功，攻击者将获得新账户的用户名和密码。
5.  **登录后台：** 使用新获得的管理员账户登录 WordPress 后台，完全控制网站。

**项目地址:** [Rajneeshkarya/CVE-2023-3460](https://github.com/Rajneeshkarya/CVE-2023-3460)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)