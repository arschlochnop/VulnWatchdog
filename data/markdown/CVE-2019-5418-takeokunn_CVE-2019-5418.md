## CVE-2019-5418 - Rails File Content Disclosure

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 5.2.2.1, < 5.1.6.2, < 5.0.7.2, < 4.2.11.1 和 v3

**利用条件:** 目标应用使用存在漏洞的Rails版本，且允许处理包含特制Accept头的HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418 是一个 Rails Action View 组件中的文件内容泄露漏洞。攻击者可以利用特制的 Accept 头，配合 `render file:` 调用，读取服务器上的任意文件内容。根据漏洞库信息和搜索结果，该漏洞影响多个Rails版本。

**有效性：**
根据漏洞库信息和搜索结果，确认该漏洞存在并且有公开的利用方法。

**投毒风险：**
提供的代码片段仅包含 Gemfile 和 Gemfile.lock 文件。这些文件描述了 Rails 应用的依赖，并没有发现任何可疑的、可能构成投毒的代码。因此，投毒风险评估为0%。

**利用方式：**
利用方式是通过构造包含恶意 Accept 头的 HTTP 请求，诱使 Rails 应用读取并返回目标文件内容。攻击者通常会在 Accept 头中包含路径遍历字符串，例如 `../../../../etc/passwd`，以访问服务器上的敏感文件。

攻击者发送一个包含恶意 Accept 头的HTTP请求到存在漏洞的 Rails 应用。 Rails 应用在处理请求时，由于存在漏洞的 Action View 组件，会尝试根据 Accept 头渲染相应的文件。 恶意 Accept 头中的路径遍历字符串使得 Rails 应用读取到了预期之外的文件。 Rails 应用将读取到的文件内容作为响应返回给攻击者。

**项目地址:** [takeokunn/CVE-2019-5418](https://github.com/takeokunn/CVE-2019-5418)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)