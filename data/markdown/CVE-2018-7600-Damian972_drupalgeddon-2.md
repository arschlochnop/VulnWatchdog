## CVE-2018-7600 Drupalgeddon2

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点未打补丁，且配置允许远程访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个影响Drupal的远程代码执行漏洞。根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以得出以下结论：

**有效性：**

提供的POC代码是有效的漏洞检测脚本。它通过构造特定的URL和POST请求，利用Drupal中的输入验证漏洞，尝试执行任意命令。脚本会检测目标站点是否返回预期的“GOOD”字符串，以判断漏洞是否存在。

**投毒风险：**

该漏洞利用代码主要由一个PHP脚本组成，用于检测Drupal站点是否存在CVE-2018-7600漏洞。脚本的逻辑相对简单，主要功能是发送特定的HTTP请求并检查响应。主要的风险可能存在于以下几个方面：

1.  **命令执行：** 虽然脚本的目的是检测漏洞，但它确实会尝试在目标服务器上执行命令。如果脚本被恶意修改，攻击者可以更改`$command`变量，从而执行任意的恶意命令。
2.  **信息泄露：** 脚本会发送包含特定参数的HTTP请求，这些参数可能会泄露目标站点的信息。
3.  **拒绝服务（DoS）：** 如果脚本被大规模使用，可能会对目标服务器造成一定的负载，导致拒绝服务。

考虑到以上因素，认为此仓库中存在作者隐藏的投毒代码的可能性较低，约为5%。这个假设的依据是代码相对简单，容易审查，并且其主要目的是漏洞检测而非利用。

**利用方式：**

1.  **构造恶意请求：** 攻击者构造包含恶意代码的URL或POST请求，利用Drupal的多个子系统中的输入验证漏洞。
2.  **远程代码执行：** 恶意代码通过Drupal的渲染机制执行，导致远程代码执行。

具体来说，对于Drupal 7.x，POC利用`user/password`路径，通过`name[#post_render]`、`name[#type]`和`name[#markup]`参数注入PHP代码。对于Drupal 8.x，POC利用`user/register`路径，通过`element_parents`、`mail[a][#post_render]`、`mail[a][#type]`和`mail[a][#markup]`参数注入PHP代码。这些参数允许在特定情况下执行PHP代码，从而实现远程代码执行。

**总结：**

CVE-2018-7600是一个严重的安全漏洞，允许未经身份验证的攻击者在Drupal站点上执行任意代码。提供的POC代码可以有效地检测该漏洞，但使用时需要注意潜在的风险，以避免对目标系统造成损害。务必确保从可信来源获取利用代码，并在受控环境中进行测试。


**项目地址:** [Damian972/drupalgeddon-2](https://github.com/Damian972/drupalgeddon-2)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)