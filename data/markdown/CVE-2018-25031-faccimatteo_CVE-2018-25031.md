## CVE-2018-25031-Swagger UI-欺骗攻击/SSRF

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗攻击/SSRF

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致信息泄露或SSRF

**影响版本:** <= 4.1.2

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-25031 存在于 Swagger UI 4.1.2 及更早版本中。攻击者可以通过诱骗受害者打开一个特制的 URL，从而利用此漏洞显示远程 OpenAPI 定义，实现欺骗攻击。搜索结果表明，该漏洞与SSRF有关，恶意URL的`url`参数允许展示远程OpenAPI定义。提供的POC代码包含两个文件：`test.json` 和 `test.yaml`。

*   `test.json` 文件指定了 `url` 和 `urls` 字段，指向了远程的 `test.yaml` 文件。这指示 Swagger UI 加载远程的 OpenAPI 定义。
*   `test.yaml` 文件包含一个 `description` 字段，该字段包含 HTML 代码，用于在 Swagger UI 界面上显示一个指向 `evil_website` 的链接。这表明攻击者可以控制 Swagger UI 显示的内容，从而进行欺骗。

**有效性：** 该POC代码有效。通过诱导用户点击包含指向恶意`test.json`的URL链接，Swagger UI会加载远程`test.yaml`文件，从而在UI中显示恶意链接，实现欺骗攻击。

**投毒风险：** 该POC代码的投毒风险较低，因为其主要目的是进行欺骗攻击，而非直接执行恶意代码。YAML 文件中嵌入 HTML 链接，虽然具有一定的欺骗性，但本身不包含恶意代码或后门。因此判定仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式：**

1.  攻击者创建一个包含恶意 OpenAPI 定义（例如 `test.yaml`）的文件，并将其托管在远程服务器上。
2.  攻击者创建一个包含指向恶意 OpenAPI 定义 URL（例如 `test.json`）的 URL。
3.  攻击者诱骗受害者点击该恶意 URL。
4.  受害者的 Swagger UI 加载恶意 OpenAPI 定义，从而在界面上显示攻击者控制的内容，例如指向恶意网站的链接。

通过这种方式，攻击者可以欺骗用户，窃取敏感信息，或者利用SSRF漏洞。

**项目地址:** [faccimatteo/CVE-2018-25031](https://github.com/faccimatteo/CVE-2018-25031)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)