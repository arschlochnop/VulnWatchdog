## CVE-2025-29891 - Apache Camel Message Header Injection

**漏洞编号:** CVE-2025-29891

**漏洞类型:** Header Injection/Bypass

**影响应用:** Apache Camel

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** 3.10.0 < version < 3.22.4, 4.8.0 < version < 4.8.5, 4.10.0 < version < 4.10.2

**利用条件:** Camel应用直接通过HTTP暴露到互联网，并且使用了易受攻击的Camel组件 (例如 camel-bean, camel-exec) 。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

该漏洞源于Apache Camel默认的incoming header filter允许攻击者包含Camel特定的header。如果Camel应用直接通过HTTP暴露到互联网,攻击者可以通过HTTP请求参数将恶意header注入到Camel消息中，从而改变特定Camel组件的行为。例如，攻击者可以通过控制`camel-bean`组件调用的bean方法或者`camel-exec`组件执行的命令，实现远程代码执行。提供的Dockerfile包含了一个多阶段构建，首先使用maven构建Camel应用，然后在第二个阶段运行该应用。Dockerfile创建了多个模拟的敏感文件，包括数据库配置文件、支付系统私钥、客户数据文件、系统管理员SSH密钥、审计日志和系统配置文件，用于演示漏洞利用造成的潜在影响，如信息泄露。该Dockerfile主要用于漏洞演示，不包含恶意的投毒代码。投毒可能性评估较低，仅为1%，主要风险可能来自于镜像构建过程或依赖项，但Dockerfile本身没有明显的恶意行为。

**项目地址:** [Crystallen1/CVE-2025-29891-demo](https://github.com/Crystallen1/CVE-2025-29891-demo)

**漏洞详情:** [CVE-2025-29891](https://nvd.nist.gov/vuln/detail/CVE-2025-29891)