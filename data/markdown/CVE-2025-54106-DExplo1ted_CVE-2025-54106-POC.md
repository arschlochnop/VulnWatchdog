## CVE-2025-54106 - Windows RRAS 整数溢出远程代码执行漏洞

**漏洞编号:** CVE-2025-54106

**漏洞类型:** 远程代码执行

**影响应用:** Windows Routing and Remote Access Service (RRAS)

**危害等级:** 高危，允许未经授权的攻击者通过网络执行任意代码

**影响版本:** Windows Server 2012 R2 (6.3.9600.0 < version < 6.3.9600.22774), Windows Server 2016 (10.0.14393.0 < version < 10.0.14393.8422), Windows Server 2019 (10.0.17763.0 < version < 10.0.17763.7792), Windows Server 2022 (10.0.20348.0 < version < 10.0.20348.4171), Windows Server 2025 (10.0.26100.0 < version < 10.0.26100.6584), Windows Server 23H2 (10.0.25398.0 < version < 10.0.25398.1849)

**利用条件:** 需要网络访问，RRAS服务启用，用户交互（UI:R）。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-54106是Windows路由和远程访问服务（RRAS）中的一个整数溢出漏洞，允许未经授权的攻击者通过网络执行任意代码。该漏洞影响多个Windows Server版本。根据提供的漏洞利用代码，利用过程包括：

1.  **下载漏洞利用代码：** 从GitHub仓库下载包含`rras-exploit.exe`（主漏洞利用程序），`start-exploit.bat`（启动脚本）和`config.ini`（配置文件）的ZIP文件。
2.  **配置环境：** 设置Windows Server实例，确保拥有管理员权限，安装PowerShell 5.1或更高版本，并配置防火墙以允许测试（例如，打开1723 TCP和1701 UDP端口）。
3.  **运行漏洞利用程序：** 运行setup脚本配置RRAS，然后运行`start.bat`启动`rras-exploit.exe`，该程序会利用整数溢出漏洞攻击目标服务器。可以通过`config.ini`修改目标IP和端口。
4.  **监控事件日志：** 使用PowerShell命令`Get-EventLog -LogName Application -Source RemoteAccess`监控Windows事件日志，检查漏洞利用的影响。

**有效性：** 根据描述，该POC代码似乎有效，因为它提供了完整的漏洞利用步骤和所需的工具。

**投毒风险：** 从提供的文件来看，存在一定的投毒风险，具体分析如下：

*   `rras-exploit.exe`：该二进制文件是漏洞利用的核心，如果作者在其中植入恶意代码，可能在执行漏洞利用的同时执行其他恶意操作（例如，安装后门、窃取信息）。由于无法直接分析二进制文件，因此存在潜在风险。
*   `start-exploit.bat`：该批处理文件用于启动漏洞利用程序，理论上可以检查其内容，确认是否有其他恶意命令被执行。但如果`rras-exploit.exe`本身被投毒，该脚本的安全性就无关紧要了。
*   `config.ini`：配置文件通常用于设置目标IP、端口等参数，恶意利用的可能性较低，但如果用于配置恶意服务器，也可能造成危害。

虽然提供了利用代码，但其中的二进制文件 `rras-exploit.exe` 存在潜在的风险。由于无法审查该二进制文件的内部行为，无法完全排除其被篡改以执行恶意操作的可能性。 投毒风险评估为20%，主要基于无法验证二进制文件的安全性。

**利用方式：** 该漏洞的利用方式是通过构造特制的网络数据包，触发RRAS服务中的整数溢出，进而允许攻击者执行任意代码。利用需要一定的用户交互，使得触发更具欺骗性。

**项目地址:** [DExplo1ted/CVE-2025-54106-POC](https://github.com/DExplo1ted/CVE-2025-54106-POC)

**漏洞详情:** [CVE-2025-54106](https://nvd.nist.gov/vuln/detail/CVE-2025-54106)