## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 弱密码恢复机制

**影响应用:** GitLab

**危害等级:** 高危，可导致账户接管

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例存在漏洞且可公开访问或攻击者可以发送请求到目标实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-7028 是 GitLab CE/EE 版本 16.1 到 16.7 中存在的一个关键漏洞。该漏洞源于密码重置流程中对邮箱地址的校验不严格，攻击者可以通过在密码重置请求中提供两个邮箱地址（一个受害者邮箱，一个攻击者邮箱）来将密码重置邮件发送到未验证的邮箱地址，从而实现账户接管。

**利用方式：**

1.  **目标确定：**  确定存在漏洞的 GitLab 实例。
2.  **发起密码重置请求：**  使用受害者邮箱地址和攻击者控制的邮箱地址，构造恶意的密码重置请求。
3.  **获取重置链接：**  在攻击者控制的邮箱中获取密码重置链接。
4.  **重置密码：**  使用重置链接重置受害者账户的密码。
5.  **账户接管：**  使用新密码登录受害者账户，完成账户接管。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，可以判断该POC代码有效， 因为CISA已经将此漏洞加入到已知被利用的漏洞列表，证明该漏洞真实存在，并且已经被攻击者利用。

**投毒风险：**

提供的POC代码主要包含一个`exploit.py`脚本和一个`docker-compose.yml`文件。

*   `docker-compose.yml` 文件用于快速部署一个存在漏洞的GitLab实例，方便漏洞验证，本身不包含恶意代码。
*   `exploit.py` 脚本实现了漏洞利用的自动化， 其中使用OneSecMail_api来获取临时邮箱接收重置密码的链接,代码较为清晰,主要功能是构造恶意请求,没有发现明显的恶意代码。但是利用了第三方临时邮箱，可能会导致token泄漏，存在一定的风险。

**风险评估:**

该漏洞的利用难度较低，且影响严重，建议及时升级 GitLab 版本以修复此漏洞。

**投毒风险评估：**

虽然整体代码看起来较为直接，没有明显的后门或恶意行为。 但是依然存在一些潜在的风险，故给出10%的投毒风险。例如利用临时邮箱存在不稳定性，依赖于外部API，API失效会导致POC无法使用等。

**项目地址:** [soltanali0/CVE-2023-7028](https://github.com/soltanali0/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)