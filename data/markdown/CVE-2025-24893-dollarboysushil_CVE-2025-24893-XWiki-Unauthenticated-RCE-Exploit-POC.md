## CVE-2025-24893 - XWiki SolrSearchMacros 远程代码执行

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 15.10.11, 16.0.0-rc-1 < 16.4.1, <16.5.0RC1

**利用条件:** 目标XWiki实例存在漏洞，攻击者可以访问到/xwiki/bin/get/Main/SolrSearch接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24893 允许未经身份验证的攻击者通过构造恶意的 `SolrSearch` 请求执行任意代码。漏洞存在于`Main.SolrSearchMacros`宏中，由于对用户输入验证不足，攻击者可以在 `text` 参数中注入 Groovy 代码。PoC 提供的 Python 脚本利用此漏洞，通过构造包含反弹 shell 命令的 payload，并在目标系统上执行该 payload。 exploit 通过 curl 发送构造好的 URL，该 URL 包含经过 URL 编码的 Groovy payload。该 payload 包含一个反弹 shell 命令，连接到攻击者指定的 IP 地址和端口。README.md 文件描述了漏洞的原理和利用方法。投毒风险较低，主要是URL拼接中的IP和端口存在被替换的风险，且需要目标开启外网访问权限，否则反弹shell无法成功。经过分析，未发现明显的恶意代码，仅存在常规的反弹 shell 利用方式。

**项目地址:** [dollarboysushil/CVE-2025-24893-XWiki-Unauthenticated-RCE-Exploit-POC](https://github.com/dollarboysushil/CVE-2025-24893-XWiki-Unauthenticated-RCE-Exploit-POC)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)