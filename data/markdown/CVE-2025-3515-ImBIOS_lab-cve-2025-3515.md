## CVE-2025-3515 Drag and Drop Multiple File Upload for Contact Form 7 - 任意文件上传

**漏洞编号:** CVE-2025-3515

**漏洞类型:** 任意文件上传

**影响应用:** Drag and Drop Multiple File Upload for Contact Form 7 (WordPress plugin)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.3.8.9

**利用条件:** 需要目标网站安装了受影响的插件，并且服务器配置允许执行上传的恶意文件（如.phar文件）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3515 存在于 Drag and Drop Multiple File Upload for Contact Form 7 插件中，由于文件类型验证不足，允许未经身份验证的攻击者上传任意文件。利用方式是，攻击者可以绕过插件的黑名单，上传如 .phar 或其他危险文件类型，如果服务器配置不当（例如 Apache+mod_php），这些文件可能被当作 PHP 脚本执行，导致远程代码执行。

**有效性评估：**
提供的PoC代码通过 Docker 快速启动一个包含漏洞 WordPress 环境，验证该漏洞。Dockerfile 使用 `nuclei` 对漏洞进行验证，上传一个 PHP payload 执行后自删除，验证利用成功，

**投毒风险评估：**

该仓库的主要目的是重现和验证 CVE-2025-3515 漏洞，PoC 代码相对简单直接，没有明显的恶意代码迹象。

*   `docker-compose.yml`：定义了 WordPress 环境，包括数据库、WordPress 镜像以及 wp-cli 工具，用于初始化 WordPress。
*   `scripts/wp-init.sh`：初始化 WordPress 环境，安装 Contact Form 7 插件，并安装指定版本的存在漏洞的 drag-and-drop-multiple-file-upload-contact-form-7 插件，设置管理员账号密码等。

潜在的投毒风险在于：

1.  **依赖镜像的安全性：** Docker 镜像可能存在潜在的安全问题，但这是所有 Dockerized 环境都会面临的风险，与此 PoC 特定的投毒无关。
2.  **Nuclei 模板的安全性：** 虽然这个 nuclei 模板作者是没隐藏恶意代码，但是不排除 nuclei 模板本身可能包含设计不合理的地方，从而导致目标机器受到不期望的影响.

综合分析，此仓库存在作者隐藏的投毒代码的可能性极低，风险约为5%。主要集中在依赖镜像的安全问题上，以及nuclei模板的设计不合理导致的.

**利用方式总结：**

1.  **环境搭建：** 使用 Docker Compose 搭建包含漏洞插件的 WordPress 环境。
2.  **漏洞触发：** 利用 Nuclei 或类似工具，向 `/wp-admin/admin-ajax.php?action=ddmu_upload_file` 端点上传恶意文件（如 .phar 文件）。
3.  **代码执行：** 如果服务器配置允许，上传的恶意文件被执行，实现远程代码执行。

**项目地址:** [ImBIOS/lab-cve-2025-3515](https://github.com/ImBIOS/lab-cve-2025-3515)

**漏洞详情:** [CVE-2025-3515](https://nvd.nist.gov/vuln/detail/CVE-2025-3515)