## CVE-2025-32463-Sudo-Chroot-Privilege-Escalation

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户权限

**POC 可用性:** 部分，需要根据漏洞原理自行构造

**投毒风险:** 5%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之前的版本中。该漏洞允许本地用户通过 `--chroot` 选项和一个用户控制的 `/etc/nsswitch.conf` 文件来获取 root 权限。漏洞利用方式如下：

1.  **漏洞原理：** Sudo 在使用 `--chroot` 选项时，会切换根目录。如果用户可以控制 `/etc/nsswitch.conf` 文件，则可以利用该文件加载恶意的动态链接库，从而在 Sudo 进程中执行任意代码。
2.  **利用步骤：**
    *   创建一个恶意的 `/etc/nsswitch.conf` 文件，其中包含指向恶意动态链接库的配置。
    *   使用 `sudo --chroot <user-controlled-directory> <command>` 命令，其中 `<user-controlled-directory>` 指向包含恶意 `/etc/nsswitch.conf` 文件的目录。
    *   Sudo 会加载恶意的 `/etc/nsswitch.conf` 文件，并执行其中的恶意代码，从而提升权限至 root。

3.  **有效性评估：**
    *   提供的 POC 代码仅包含 README.md 文件，缺少实际的利用代码。该 README.md 只是一个环境设置的说明，因此需要自行构造利用代码。
    *   根据漏洞描述，该漏洞利用的有效性取决于能否成功创建一个恶意的 `/etc/nsswitch.conf` 文件，并让 Sudo 加载它。

4.  **投毒风险评估：**
    *   由于提供的 POC 代码不完整，仅包含 README.md 文件，因此投毒风险较低。但是，在实际利用过程中，如果从不可信的来源获取利用代码，则存在投毒风险。
    *   `README.md` 文件本身描述了如何测试漏洞。虽然它本身没有恶意代码，但如果有人伪造该存储库，并在其中添加了恶意的利用脚本，那么下载和运行该脚本可能会导致系统被攻击。因此，存在一定的投毒风险。这里的5%风险是评估下载了其他利用方式后，被投毒的风险。


**项目地址:** [ricardomaia/CVE-2025-32463](https://github.com/ricardomaia/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)