## CVE-2025-31161-CrushFTP-身份验证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致管理员权限获取，系统完全控制

**影响版本:** < 10.8.4 (CrushFTP 10), < 11.3.1 (CrushFTP 11)

**利用条件:** 需要网络访问CrushFTP服务，并且目标版本在受影响范围内，非DMZ代理实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-31161 存在于 CrushFTP 10 (版本低于 10.8.4) 和 11 (版本低于 11.3.1) 中。该漏洞允许未经身份验证的攻击者绕过身份验证并接管 crushadmin 帐户，除非使用了 DMZ 代理实例。该漏洞利用 AWS4-HMAC 授权方法中的竞争条件和头部解析缺陷。通过发送畸形的 AWS4-HMAC 头部，可以触发服务器的 index-out-of-bounds 错误，阻止会话清理，从而允许攻击者以任何已知或可猜测的用户（例如 crushadmin）身份进行身份验证，最终完全控制系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以确定该漏洞的PoC代码是有效的。搜索引擎结果中有多篇文章提到该漏洞已被在野利用。PoC代码也描述了具体的利用方法。

**投毒风险：**

评估PoC代码后，存在一定的投毒风险。具体分析如下：

*   **代码结构：** 代码结构比较清晰，包含了常见的漏洞利用流程。但是，代码中仍然可能存在作者隐藏的恶意代码，例如：
    *   **未记录的远程连接：** 代码中可能包含未记录的远程连接功能，例如连接到特定的服务器以下载或上传数据。
    *   **恶意Payload：** 代码中可以嵌入恶意的Payload，例如用于执行系统命令或安装后门程序。
    *   **信息收集：** 代码可以收集目标系统的敏感信息，例如用户名、密码、IP地址等，并将这些信息发送给攻击者。

基于上述分析，我估计该PoC代码的投毒风险为10%。

**利用方式：**

1.  **目标确认：** 确定目标CrushFTP服务器的版本是否在受影响范围内（低于 10.8.4 (CrushFTP 10) 或低于 11.3.1 (CrushFTP 11)），并且未使用 DMZ 代理。
2.  **构造恶意请求：**  构造包含畸形的AWS4-HMAC头部的HTTP(S)请求。关键在于提供用户名，但是缺少或篡改SignedHeaders条目以触发index-out-of-bounds错误。
3.  **绕过身份验证：**  利用漏洞绕过身份验证，以 crushadmin 或其他已知用户身份登录。
4.  **控制系统：**  成功登录后，攻击者可以执行任意操作，包括上传恶意文件、修改配置、创建新用户等，从而完全控制 CrushFTP 服务器。

**项目地址:** [ibrahmsql/CVE-2025-31161](https://github.com/ibrahmsql/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)