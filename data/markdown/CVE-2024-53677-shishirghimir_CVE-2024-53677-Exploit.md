## CVE-2024-53677-Apache Struts 文件上传路径穿越 RCE

**漏洞编号:** CVE-2024-53677

**漏洞类型:** 文件上传路径穿越导致远程代码执行

**影响应用:** Apache Struts

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 2.0.0 <= version < 6.4.0

**利用条件:** 需要目标应用使用了存在漏洞的FileuploadInterceptor且允许文件上传功能。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-53677 是 Apache Struts 2 中一个严重的文件上传漏洞。攻击者可以通过构造恶意的文件上传请求，利用路径穿越漏洞将恶意 JSP 文件上传到服务器的任意目录，最终导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。搜索引擎结果中多个链接都提到了该漏洞，并描述了其利用方式和风险。提供的 Python 脚本能够自动化利用该漏洞。

**投毒风险：**
分析提供的 exploit.py 和 shell.jsp 两个文件，没有发现明显的投毒代码。
*   `exploit.py`：此脚本的主要功能是上传 shell.jsp 并执行命令。它包含设置目标 URL、上传文件和执行命令的函数，不存在可疑或恶意的代码。
*   `shell.jsp`：此 JSP 文件实现了一个简单的 WebShell，允许通过 GET 请求执行系统命令。虽然 WebShell 本身具有潜在的风险，但其功能是明确的，不包含隐藏的恶意代码。
因此，判断此仓库中不存在作者隐藏的投毒代码的可能性为 100%。

**利用方式：**
1.  攻击者首先需要找到一个存在漏洞的 Apache Struts 2 应用，该应用使用了易受攻击的 FileuploadInterceptor 并且启用了文件上传功能。
2.  攻击者构造一个包含恶意路径的文件上传请求。例如，将文件名设置为 `../../../../tmp/shell.jsp`，尝试将文件上传到 `/tmp` 目录下。
3.  Struts 2 应用在处理文件上传请求时，由于存在路径穿越漏洞，会将恶意 JSP 文件上传到攻击者指定的目录。
4.  攻击者可以通过访问上传的 JSP 文件来执行任意系统命令。例如，访问 `http://example.com/tmp/shell.jsp?cmd=whoami` 可以在服务器上执行 `whoami` 命令，并将结果返回给攻击者。

**总结：**
CVE-2024-53677 是一个高危漏洞，利用难度相对较低，攻击者可以利用该漏洞完全控制服务器。建议受影响的用户尽快升级到最新版本，或采取缓解措施，如禁用易受攻击的 FileuploadInterceptor，并使用新的文件上传机制。

**项目地址:** [shishirghimir/CVE-2024-53677-Exploit](https://github.com/shishirghimir/CVE-2024-53677-Exploit)

**漏洞详情:** [CVE-2024-53677](https://nvd.nist.gov/vuln/detail/CVE-2024-53677)