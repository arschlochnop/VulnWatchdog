## CVE-2025-57833 Django FilteredRelation SQL 注入

**漏洞编号:** CVE-2025-57833

**漏洞类型:** SQL 注入

**影响应用:** Django

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行

**影响版本:** 4.2 < 4.2.24, 5.1 < 5.1.12, 5.2 < 5.2.6

**利用条件:** 需要能够向服务器发送带有恶意构造的 alias 参数的 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-57833 是一个 Django 框架中的 SQL 注入漏洞，存在于 FilteredRelation 功能中，通过精心构造的 column aliases 可以在 QuerySet.annotate() 或 QuerySet.alias() 方法中执行恶意 SQL 代码。

**漏洞利用方式：**

1.  **确定目标 Django 版本：** 目标 Django 版本必须在受影响的版本范围内（4.2 < 4.2.24, 5.1 < 5.1.12, 5.2 < 5.2.6）。
2.  **构造恶意请求：**  利用 `alias` 参数，该参数通常从 URL 中获取。该参数包含一个 JSON 字典，其中键值对用于 `annotate()` 或 `alias()` 方法。
3.  **SQL 注入：**  在键（column alias）中注入恶意 SQL 代码。例如，`{"evil); DROP TABLE myapp_book;--":"Count('id')"}` 这样的 payload 会尝试删除 `myapp_book` 表。
4.  **发送请求：** 将构造好的包含恶意 alias 参数的 HTTP 请求发送到易受攻击的 Django 应用。
5.  **利用 `eval()` 函数（如果存在）：** 如果 vulnerable_view 中存在 `eval()` 函数用于解析别名，则可以通过构造特定的 Python 代码来执行任意代码，但根据描述，修复后的版本移除了`eval()`函数

**投毒风险分析：**

提供的漏洞利用代码包含一个views.py文件，其中vulnerable_view函数中存在`eval()`的使用。虽然这个`eval()`使得代码存在SQL注入漏洞，但其本身目的是利用漏洞，而非隐藏的恶意代码。

但是存在一定风险，如果这个仓库存放了其他隐藏的恶意代码（例如，其他不相关的 Python 脚本或配置文件，这些文件可能在部署时被执行），那么存在投毒的可能性。这里的评估基于只检查了提供的漏洞利用代码和 Readme。由于主要代码的功能是展示和利用 SQL 注入漏洞，且作者在Readme中给出了修复建议，因此恶意投毒的可能性较低，约为20%。 这个评估是基于**提供的**代码，实际情况可能更复杂。

**项目地址:** [loic-houchi/Django-faille-CVE-2025-57833_test](https://github.com/loic-houchi/Django-faille-CVE-2025-57833_test)

**漏洞详情:** [CVE-2025-57833](https://nvd.nist.gov/vuln/detail/CVE-2025-57833)