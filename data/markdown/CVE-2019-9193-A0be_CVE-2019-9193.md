## CVE-2019-9193 - PostgreSQL 9.3-11.7 认证后的远程代码执行

**漏洞编号:** CVE-2019-9193

**漏洞类型:** 远程代码执行

**影响应用:** PostgreSQL

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3 到 11.7

**利用条件:** 需要PostgreSQL数据库的有效用户名和密码，以及网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞 (CVE-2019-9193) 允许拥有 `pg_execute_server_program` 权限的用户（包括超级用户）通过 `COPY TO/FROM PROGRAM` 命令在数据库服务器的操作系统上执行任意代码。漏洞利用方式是：

1.  **连接到数据库：** 使用提供的用户名、密码、IP地址、端口和数据库名称连接到目标PostgreSQL服务器。
2.  **检查PostgreSQL版本：** 验证目标PostgreSQL服务器的版本是否在漏洞影响范围内 (9.3 到 11.7)。
3.  **执行命令：**  利用`COPY TO/FROM PROGRAM`命令执行任意系统命令。攻击脚本会创建一个临时表，然后使用 `COPY ... FROM PROGRAM` 命令将命令的输出导入到该表中，最后再删除该表。

**有效性：** 根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，因为该漏洞利用代码利用了 `COPY TO/FROM PROGRAM` 命令执行任意系统命令的能力。 搜索结果表明有研究人员披露了该漏洞的细节，并且存在公开可用的PoC代码。

**投毒风险：** 提供的POC代码本身没有明显的投毒代码。 代码的功能主要是连接到PostgreSQL数据库，检查版本，然后使用`COPY ... FROM PROGRAM`执行命令。 该代码的意图是利用漏洞，而不是植入后门或执行恶意操作，因此投毒的风险评估为0%。

**利用方式：** 攻击者需要拥有PostgreSQL数据库的有效凭据（用户名和密码）以及对数据库的网络访问权限。他们可以通过执行 PoC 脚本，指定要执行的系统命令，从而在数据库服务器上执行任意代码。

**项目地址:** [A0be/CVE-2019-9193](https://github.com/A0be/CVE-2019-9193)

**漏洞详情:** [CVE-2019-9193](https://nvd.nist.gov/vuln/detail/CVE-2019-9193)