## CVE-2025-4403 - Drag and Drop Multiple File Upload for WooCommerce 未授权任意文件上传

**漏洞编号:** CVE-2025-4403

**漏洞类型:** 任意文件上传

**影响应用:** Drag and Drop Multiple File Upload for WooCommerce WordPress plugin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.1.6

**利用条件:** 目标网站安装了受影响的Drag and Drop Multiple File Upload for WooCommerce插件，且允许未授权用户访问上传接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-4403是一个存在于Drag and Drop Multiple File Upload for WooCommerce WordPress插件中的任意文件上传漏洞。攻击者可以利用此漏洞上传恶意文件，例如PHP脚本，从而获得服务器的远程代码执行权限。

**有效性：**

提供的POC代码尝试利用该漏洞。代码首先尝试从目标URL获取nonce和cookie，这是绕过插件安全检查的关键。然后，它构造一个POST请求，将名为`index.php.`的文件上传到`/wp-admin/admin-ajax.php` endpoint。`supported_type` 参数被设置为`.`，这指示插件接受任何文件类型。如果上传成功，代码将打印上传的文件URL，并将URL写入result.txt文件。

漏洞库信息和搜索引擎结果均确认了此漏洞的存在以及POC的有效性。

**投毒风险：**

虽然POC代码本身旨在验证漏洞，但是依然存在一定的投毒风险。主要风险在于：

1.  **恶意的文件内容:** 上传的`index.php.`文件可以包含恶意代码。虽然提供的POC中没有展示`index.php.`的内容，但如果攻击者修改POC并放入包含后门或其他恶意功能的`index.php.`，那么该漏洞的利用可能导致目标系统被植入恶意代码。
2. **result.txt 记录恶意链接:** 如果大量存在漏洞的站点URL被记录在result.txt文件中，恶意使用者可能会利用这些信息进行进一步的攻击。

总体来说，该代码的投毒风险较低，约为5%。这是因为POC的主要目的是验证漏洞，而恶意代码的存在取决于上传的文件内容。

**利用方式：**

利用此漏洞的典型步骤如下：

1.  **找到目标网站:** 找到安装了受影响的Drag and Drop Multiple File Upload for WooCommerce插件的WordPress网站。
2.  **运行POC脚本:** 运行提供的POC脚本，并提供目标网站的URL列表。
3.  **上传恶意文件:** POC脚本将上传一个包含恶意代码的`index.php.`文件。请确保在运行POC之前，将恶意代码添加到`index.php.`文件中。
4.  **访问上传的文件:** POC成功执行后，会返回上传文件的URL。通过浏览器访问此URL，即可执行上传的PHP代码，从而获得服务器的远程代码执行权限。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-4403](https://github.com/B1ack4sh/Blackash-CVE-2025-4403)

**漏洞详情:** [CVE-2025-4403](https://nvd.nist.gov/vuln/detail/CVE-2025-4403)