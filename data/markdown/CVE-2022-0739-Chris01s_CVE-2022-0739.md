## CVE-2022-0739-BookingPress-SQL注入

**漏洞编号:** CVE-2022-0739

**漏洞类型:** SQL注入

**影响应用:** BookingPress WordPress插件

**危害等级:** 高危，可能导致数据泄露和管理员权限获取

**影响版本:** < 1.0.11

**利用条件:** 目标网站安装了BookingPress插件，且版本低于1.0.11。攻击者需要能够发送HTTP请求到目标网站的/wp-admin/admin-ajax.php接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于BookingPress WordPress插件的1.0.11版本之前。攻击者可以利用未经验证的`bookingpress_front_get_category_services` AJAX action（无需认证），通过POST请求中的`category_id`和`total_service`参数注入恶意的SQL语句，从而获取数据库中的敏感信息，如用户名和密码哈希。 

**有效性:** 根据提供的漏洞库信息和POC代码，该漏洞利用是有效的。POC代码通过构造包含UNION ALL SELECT语句的恶意请求，从`information_schema.schemata`表中提取数据库名，并从`wp_users`表中提取用户名和密码哈希。

**投毒风险:** 查看提供的`exploit.sh`脚本，脚本的功能是利用SQL注入漏洞获取数据库名和用户凭据，没有发现任何可疑的或者具有破坏性的操作。脚本只是简单的构造恶意的请求并解析返回的内容。该脚本旨在演示和利用漏洞，而非执行恶意操作，因此没有投毒风险。

**利用方式:**
1.  获取WordPress站点的URL。
2.  使用提供的`exploit.sh`脚本，将目标URL作为参数传递给脚本。
3.  脚本首先发送请求到站点首页,提取nonce值。
4.  脚本然后使用SQL注入payload构造恶意请求，通过`bookingpress_front_get_category_services` AJAX action向`/wp-admin/admin-ajax.php`发送POST请求，注入SQL语句，以提取数据库名称。
5.  脚本进一步构造SQL注入payload，以从`wp_users`表中提取用户名和密码哈希。
6.  脚本将提取到的数据库名称、用户名和密码哈希输出到终端。

**项目地址:** [Chris01s/CVE-2022-0739](https://github.com/Chris01s/CVE-2022-0739)

**漏洞详情:** [CVE-2022-0739](https://nvd.nist.gov/vuln/detail/CVE-2022-0739)