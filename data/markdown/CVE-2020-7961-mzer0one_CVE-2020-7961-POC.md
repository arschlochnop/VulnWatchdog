## CVE-2020-7961-Liferay Portal-反序列化RCE

**漏洞编号:** CVE-2020-7961

**漏洞类型:** 反序列化远程代码执行

**影响应用:** Liferay Portal

**危害等级:** 高危，可能导致远程代码执行和系统完全控制

**影响版本:** 7.2.1 CE GA2之前版本

**利用条件:** 需要目标Liferay Portal实例开启JSON Web Services (JSONWS)且网络可达。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-7961是Liferay Portal 7.2.1 CE GA2之前版本中的一个反序列化漏洞，攻击者可以通过向JSON Web Services (JSONWS)发送特制的请求，利用Java反序列化漏洞执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的POC代码，此漏洞的利用是有效的。搜索结果中包含多个关于CVE-2020-7961的描述和利用方式，包括Rapid7的漏洞数据库、Synacktiv的PoC分析、以及其他漏洞报告和分析文章。提供的POC代码包含一个python脚本(poc.py)和一个Java类(LifExp.java)，用于利用此漏洞。

**投毒风险：** 提供的POC代码中，`LifExp.java`的作用是执行计算器程序，这是一个常见的PoC验证方式，用来确认代码是否能够被执行。`poc.py`脚本用于发送包含恶意序列化数据的请求。该仓库中并未发现作者隐藏的恶意代码，因此投毒风险为0%。

**利用方式：**
1.  编译恶意Java类：`javac LifExp.java`， 生成 `LifExp.class` 文件。
2.  运行python脚本：`python poc.py -t <target_host:port> -u api/jsonws`。
3.  `poc.py`会启动一个简单的HTTP服务器，用于提供编译后的Java类文件 (`LifExp.class`)。
4.  攻击者通过构造恶意的JSONWS请求，将payload发送到目标Liferay Portal服务器。
5.  Liferay Portal反序列化接收到的恶意数据，导致`LifExp.class`中的静态代码块被执行，从而实现远程代码执行。
6.  默认的 `LifExp.java` 示例代码会执行计算器程序，在实际利用中可以修改为执行其他恶意命令。

**项目地址:** [mzer0one/CVE-2020-7961-POC](https://github.com/mzer0one/CVE-2020-7961-POC)

**漏洞详情:** [CVE-2020-7961](https://nvd.nist.gov/vuln/detail/CVE-2020-7961)