## CVE-2025-54309 CrushFTP AS2验证绕过漏洞

**漏洞编号:** CVE-2025-54309

**漏洞类型:** 身份验证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可获取管理员权限

**影响版本:** CrushFTP 10 before 10.8.5, CrushFTP 11 before 11.3.4_23 (未使用DMZ代理功能)

**利用条件:** 目标服务器运行受影响版本的CrushFTP，并且没有使用DMZ代理功能，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-54309是CrushFTP中的一个身份验证绕过漏洞。当未使用DMZ代理功能时，AS2验证处理不当，允许远程攻击者通过HTTPS获得管理员访问权限。该漏洞已在野外被利用。提供的PoC代码通过多线程并发的方式利用竞态条件，生成随机`c2f`值并更新Cookie，发送包含特定`AS2-TO`头部的请求，绕过身份验证并创建具有管理员权限的用户。PoC代码基于Watchtowr Labs的原始PoC，并进行了增强，添加了用户创建和验证功能。PoC代码中的投毒风险较低（10%），主要集中在以下几个方面：

*   **依赖第三方库的风险:** 漏洞利用脚本依赖`requests`库。虽然requests库本身被广泛使用，但总是存在上游依赖被投毒的风险，如果安装了恶意版本的`requests`库，可能会导致漏洞利用过程中执行恶意代码。
*   **github仓库本身的风险:** 仓库本身是第三方创建的，存在被篡改的风险。

该漏洞的利用方式包括：

1.  生成随机`c2f`值和`CrushAuth` cookie。
2.  构造带有`AS2-TO`头部的HTTP请求，目标指向`\crushadmin`。
3.  在XML payload中创建admin用户。
4.  利用竞态条件，通过高并发线程发送多个请求，增加成功的概率。
5.  （可选）验证新创建的用户是否可以成功登录。

此漏洞利用代码专为授权渗透测试环境设计，如HackTheBox实验室，不应在未经授权的环境中使用。

**项目地址:** [whisperer1290/CVE-2025-54309__Enhanced_exploit](https://github.com/whisperer1290/CVE-2025-54309__Enhanced_exploit)

**漏洞详情:** [CVE-2025-54309](https://nvd.nist.gov/vuln/detail/CVE-2025-54309)