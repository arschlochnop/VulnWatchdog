## CVE-2013-3900 WinVerifyTrust 签名验证漏洞

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows操作系统

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本（参见漏洞库信息）

**利用条件:** 用户或应用程序运行或安装经过特殊构造的签名PE文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 WinVerifyTrust 函数处理 Windows Authenticode 签名验证的方式中，针对便携式可执行 (PE) 文件。攻击者可以通过修改已签名的可执行文件，利用文件中未验证的部分，将恶意代码添加到文件中，且不使签名失效，从而利用此漏洞。 

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且已被利用。提供的代码片段不是漏洞利用代码，而是用于缓解此漏洞的脚本。该脚本通过在注册表中设置 `EnableCertPaddingCheck` 值为1，来启用更严格的证书填充检查。

**投毒风险：**
提供的 PowerShell 脚本目的是缓解漏洞，检查并创建注册表项，然后设置 `EnableCertPaddingCheck` 的值为 1。该脚本本身没有发现恶意代码，其功能是按照既定的缓解措施执行，因此投毒风险较低，判断投毒风险为0%。

**利用方式：**
攻击者通常通过以下步骤利用该漏洞：
1.  选择一个已签名的可执行文件。
2.  修改该文件，在未验证的区域添加恶意代码。由于漏洞的存在，WinVerifyTrust 函数不会检测到这些修改。
3.  诱使用户或应用程序运行修改后的文件。
4.  当运行该文件时，恶意代码将在受害者的系统上执行。

搜索结果中提到该漏洞被用于 3CX 供应链攻击，攻击者通过利用该漏洞，使得恶意软件看起来像是经过合法签名的，从而绕过安全检测。

**项目地址:** [oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation](https://github.com/oukridrig772/-WinVerifyTrust-Signature-Validation-CVE-2013-3900-Mitigation)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)