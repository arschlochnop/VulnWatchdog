## CVE-2015-10141-Xdebug-RCE

**漏洞编号:** CVE-2015-10141

**漏洞类型:** 远程代码执行

**影响应用:** Xdebug

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 2.5.5

**利用条件:** Xdebug开启远程调试且版本低于或等于2.5.5，目标服务器9000端口对外开放

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-10141 是 Xdebug 2.5.5 及更早版本中的一个未经身份验证的操作系统命令注入漏洞。当启用了远程调试时，Xdebug 会在 9000 端口监听，并接受未经身份验证的调试器协议命令。攻击者可以发送特制的 eval 命令通过此接口执行任意 PHP 代码，进而调用 system() 或 passthru() 等系统级函数，从而完全控制主机，权限为 Web 服务器用户的权限。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞是真实存在的，并且影响 Xdebug 2.5.5 及更早版本。提供的 PoC 代码旨在利用此漏洞，从HackTheBox实战例子可以看出，该POC具有有效性。

**投毒风险：**
该 PoC 代码的投毒风险较低。虽然任何代码都可能包含恶意成分，但此代码结构清晰，主要功能是建立 socket 连接，发送经过 base64 编码的 PHP 命令，并解析响应。潜在的投毒风险可能在于：

*   在base64编码或解码部分，植入恶意代码，但整体代码流程相对简单，容易被发现。
*   攻击者可能利用subprocess初始化远程连接时，执行一些恶意命令，但从代码角度看，只是初始化连接而已。
因此，认为投毒风险较低，大约为5%。

**利用方式：**
1.  攻击者首先需要确定目标服务器上运行的 Xdebug 版本是否低于或等于 2.5.5，并且启用了远程调试功能。
2.  攻击者运行 PoC 脚本，指定目标服务器的 IP 地址。
3.  PoC 脚本尝试与目标服务器的 9000 端口建立 socket 连接。
4.  连接建立后，PoC 脚本会发送一个初始化调试的命令，该命令会通过web服务cookie头XDEBUG_SESSION触发Xdebug连接。
5.  攻击者可以在命令行输入要执行的系统命令。
6.  PoC 脚本将命令封装成 PHP 代码，使用 `system()` 函数执行，然后将 PHP 代码进行 Base64 编码。
7.  将编码后的命令通过 socket 连接发送到目标服务器。
8.  目标服务器执行命令后，将结果返回给攻击者。
9.  攻击者可以在本地终端看到命令执行的结果，并进一步利用漏洞控制服务器。

**项目地址:** [n0m4d22/PoC-CVE-2015-10141-Xdebug](https://github.com/n0m4d22/PoC-CVE-2015-10141-Xdebug)

**漏洞详情:** [CVE-2015-10141](https://nvd.nist.gov/vuln/detail/CVE-2015-10141)