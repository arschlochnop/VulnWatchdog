## CVE-2025-5328 – chshcms mccms 2.7 Path Traversal

**漏洞编号:** CVE-2025-5328

**漏洞类型:** 路径遍历

**影响应用:** chshcms mccms

**危害等级:** 中危，可能导致任意文件删除或覆盖

**影响版本:** 2.7

**利用条件:** 需要网络访问，目标服务器运行chshcms mccms 2.7

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-5328是chshcms mccms 2.7版本中的一个路径遍历漏洞。该漏洞存在于`/sys/apps/controllers/admin/Backups.php`文件的`restore_del`函数中。由于对`dirs`参数未进行充分的验证，攻击者可以利用精心构造的路径序列（如`../../../etc/passwd`）访问或删除备份目录之外的任意文件。

**有效性：**
根据提供的漏洞利用代码，该漏洞的POC是存在的，并且提供了利用方式。

**投毒风险：**
该漏洞利用代码文件是一个Markdown格式的说明文档，用于描述漏洞的详细信息和利用方法，主要包括漏洞描述、受影响组件、利用方法、检测与缓解措施等。其中包含一个`[Download](https://tinyurl.com/mtdn2udr)`链接，如果这个链接指向的不是预期的利用脚本，而是一个恶意的文件，那么就存在投毒风险。由于无法确定tinyurl所指向的具体内容，因此存在一定的投毒风险，初步评估为10%。

**利用方式：**
1.  攻击者找到一个公开可访问的端点，例如：`https://target.com/sys/apps/controllers/admin/Backups.php?act=restore_del&dirs=../../../../etc/passwd`。
2.  输入的`dirs`参数未经适当的清理而直接使用。
3.  在预期目录之外发生文件系统访问或删除操作。
4.  导致文件覆盖、配置删除或可用性中断。

**缓解措施：**
1.  对`dirs`参数应用严格的输入验证。
2.  使用`basename()`或目录白名单来限制路径范围。
3.  限制敏感文件的权限，以防止意外访问。

**项目地址:** [voyagken/CVE-2025-5328](https://github.com/voyagken/CVE-2025-5328)

**漏洞详情:** [CVE-2025-5328](https://nvd.nist.gov/vuln/detail/CVE-2025-5328)