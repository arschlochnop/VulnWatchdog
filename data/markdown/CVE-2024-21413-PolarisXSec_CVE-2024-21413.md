## CVE-2024-21413 Microsoft Outlook 远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，可能导致完全控制受影响的系统

**影响版本:** 受影响版本包括Microsoft Office 2016、2019、LTSC 2021以及Microsoft 365 Apps for Enterprise的特定版本

**利用条件:** 攻击者需要诱使用户点击恶意链接

**POC 可用性:** 是，但提供的POC代码未完全成功，仅实现了NTLM哈希泄露

**投毒风险:** 10%

## 详情

CVE-2024-21413是一个影响Microsoft Outlook的远程代码执行漏洞，被称为“MonikerLink”漏洞。该漏洞允许攻击者通过精心构造的链接绕过安全措施，并在受害者系统上执行任意代码。根据搜索结果和漏洞利用代码，利用方式如下：

1.  **漏洞原理：** 漏洞源于Outlook在处理特定类型的链接时存在缺陷，可能导致未经授权的SMB连接，从而泄露NTLM哈希。
2.  **攻击步骤：**
    *   攻击者搭建SMTP和POP3服务器（POC代码中使用了Python脚本实现）。
    *   攻击者创建一个包含恶意UNC路径的电子邮件，并发送给受害者。
    *   受害者打开Outlook并点击邮件中的恶意链接。
    *   Outlook尝试解析UNC路径，触发SMB连接到攻击者控制的服务器。
    *   攻击者捕获受害者的NTLM哈希，可用于离线破解或Pass-the-Hash攻击。

**有效性评估：**

根据提供的漏洞利用代码的描述，该POC并非完全成功，仅实现了NTLM哈希泄露，并没有实现远程代码执行。该POC旨在复现NTLM哈希泄露，而非直接执行任意代码。

**投毒风险评估：**

提供的代码包含SMTP和POP3服务器的Python脚本，以及利用漏洞的exploit脚本。仔细检查这些脚本，未发现明显的恶意代码。但是，使用第三方提供的exploit脚本始终存在风险，因为攻击者可能在其中植入恶意代码。经过分析，投毒风险评估为10%。主要风险点在于对第三方脚本的信任。

**总结：**

CVE-2024-21413是一个严重的Outlook RCE漏洞，攻击者可以通过诱使用户点击恶意链接来利用该漏洞。提供的POC代码主要用于演示NTLM哈希泄露，而非完整的RCE。在使用任何第三方提供的漏洞利用代码时，都需要谨慎评估其安全性。

**项目地址:** [PolarisXSec/CVE-2024-21413](https://github.com/PolarisXSec/CVE-2024-21413)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)