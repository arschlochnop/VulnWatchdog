## CVE-2025-49113-Roundcube-PHP对象反序列化RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化RCE

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可导致远程代码执行

**影响版本:** < 1.5.10 and 1.6.x < 1.6.11

**利用条件:** 需要已认证的用户权限或可伪造的会话 Cookie

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113是Roundcube Webmail中存在的一个严重的远程代码执行漏洞。该漏洞源于`program/actions/settings/upload.php` 文件中对URL中的`_from`参数未进行充分的验证，导致PHP对象反序列化漏洞。攻击者可以通过注入恶意构造的序列化PHP对象到`_from`参数，利用`unserialize()`函数触发远程代码执行。 

**有效性：**
根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该POC代码是有效的。漏洞库信息明确指出该漏洞是由于未验证的`_from`参数导致的PHP对象反序列化。 搜索引擎结果也确认了此漏洞的存在，并提供了利用的细节。POC代码实现了一个扫描器，利用不同的方法（错误分析、序列化泄漏、HTTP头分析）来检测目标Roundcube服务器是否容易受到攻击。 

**投毒风险：**
从提供的代码来看，投毒风险较低。 Scanner脚本的主要功能是检测漏洞，并没有明显的后门代码。 但仍然存在一定的风险，例如：
1.  **依赖库风险：**`requirements.txt` 中包含的依赖项可能存在潜在的安全风险，例如requests库如果被替换为恶意版本，可能导致信息泄露或代码执行。
2.  **更新风险：** 作者在后续更新中，可能添加恶意代码，需要保持警惕。
3.  **协作风险：** 如果有其他人参与到该项目的开发中，可能会引入恶意代码。
因此，综合评估投毒风险为10%。

**利用方式：**
1.  **攻击者需要已认证的用户权限**才能访问`upload.php`页面并利用该漏洞。
2.  **构造恶意的PHP序列化对象**，该对象包含攻击者希望执行的恶意代码。
3.  **将构造的序列化对象作为`_from`参数的值**，通过POST请求发送到`/?_task=settings&_action=upload-photo`。
4.  **Roundcube Webmail的`unserialize()`函数会反序列化该对象**，从而触发恶意代码的执行，最终导致远程代码执行。

POC代码中的scanner.py脚本尝试通过发送包含序列化对象的POST请求来检测目标服务器是否存在漏洞，并根据服务器的响应（错误信息、序列化泄漏等）来判断漏洞是否存在。

**项目地址:** [issamjr/CVE-2025-49113-Scanner](https://github.com/issamjr/CVE-2025-49113-Scanner)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)