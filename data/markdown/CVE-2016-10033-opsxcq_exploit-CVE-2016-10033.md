## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞版本的PHPMailer，并且使用isMail传输方式。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-10033 漏洞存在于 PHPMailer 5.2.18 之前的版本中。攻击者可以通过在 Sender 属性中构造包含 `\"` (反斜杠双引号) 的恶意字符串，向 mail 命令传递额外的参数，从而执行任意代码。

**漏洞利用方式：**

1.  漏洞利用代码提供了一个 Dockerfile，它构建了一个包含易受攻击的 PHPMailer 版本的环境（基于 Debian Jessie）。
2.  Dockerfile 安装了必要的组件，如 Apache2, PHP5, Python 和 Sendmail。
3.  `/www/vulnerable/` 目录下放置了易受攻击的 PHP 代码，攻击者通过访问该目录，可以触发漏洞。
4.  攻击者需要构造包含恶意代码的 Sender 属性，例如：
    ```
    $mail->Sender = 'attacker@example.com -oQ/tmp/ -X/tmp/shell.php';
    ```
5.  上述示例会在 `/tmp/shell.php` 中写入一个 Web shell，攻击者可以通过该 shell 执行任意命令。

**有效性：**

根据漏洞信息、搜索结果和漏洞利用代码，可以确认该漏洞的有效性。Exploit-DB 上存在多个针对该漏洞的利用代码，Rapid7 也有相应的 Metasploit 模块。

**投毒风险：**

在提供的 Dockerfile 和其他代码文件中，发现 `/main.sh` 文件内容缺失。如果在 `/main.sh` 中包含恶意代码，比如反弹 shell 或安装后门，则存在投毒风险。由于代码不全，投毒风险为 10%（基于现有信息判断）。Dockerfile 中 `chmod 777 -R /www` 存在安全风险，允许任何人修改 web 目录下的文件，可能被用于投毒，但也可能是方便漏洞利用测试。 `sendmail` 的存在也可能被用于发送垃圾邮件，虽然不是直接的投毒，但也可能造成滥用。

**项目地址:** [opsxcq/exploit-CVE-2016-10033](https://github.com/opsxcq/exploit-CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)