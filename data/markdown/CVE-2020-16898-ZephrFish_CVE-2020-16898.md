## CVE-2020-16898 Bad Neighbor

**漏洞编号:** CVE-2020-16898

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 10 Version 1709, 1803, 1809, 1903, 1909, 2004; Windows Server 2019, version 1903, version 1909, version 2004

**利用条件:** 目标主机开启IPv6，且与攻击者处于同一网络或攻击者能够发送ICMPv6 Router Advertisement报文到目标主机

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2020-16898 "Bad Neighbor" 漏洞存在于 Windows TCP/IP 协议栈中，当其不正确地处理 ICMPv6 路由器通告 (Router Advertisement) 报文时，可能导致远程代码执行。攻击者需要发送特制的 ICMPv6 报文到目标系统，利用Option Type 25触发漏洞。 根据提供的 exploit 代码的 README.md 文件中的描述, 该 exploit 为一个 Windows 可执行文件，需要指定目标主机和用户名。README 中特别提示 "This is a lesson as to why you should not trust binaries on the internet." 以及 "This is an educational exercise. Use at your own risk."，这暗示了此二进制文件可能存在恶意代码或后门. 因此，存在很高的投毒风险。虽然无法直接从提供的文件内容确定其是否恶意，但基于作者的明确警告，投毒的可能性较高。利用方式为，攻击者编译或直接运行提供的二进制文件，并指定目标 IP 地址和用户名，程序会发送恶意 ICMPv6 报文来尝试触发漏洞，实现远程代码执行。

根据搜索结果,此漏洞影响多个windows版本，通过发送恶意的ICMPv6数据包可以触发远程代码执行. 多个安全厂商博客都提到了这个漏洞。

综合分析，漏洞利用的有效性取决于目标系统是否存在漏洞，而投毒风险较高，建议在隔离环境中分析和测试POC。


**项目地址:** [ZephrFish/CVE-2020-16898](https://github.com/ZephrFish/CVE-2020-16898)

**漏洞详情:** [CVE-2020-16898](https://nvd.nist.gov/vuln/detail/CVE-2020-16898)