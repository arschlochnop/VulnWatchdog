## CVE-2017-11882-Microsoft Office Memory Corruption Vulnerability

**漏洞编号:** CVE-2017-11882

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Office

**危害等级:** 高危，可能导致远程代码执行，完全控制受害者系统

**影响版本:** Microsoft Office 2007 Service Pack 3, Microsoft Office 2010 Service Pack 2, Microsoft Office 2013 Service Pack 1, Microsoft Office 2016

**利用条件:** 用户需要打开恶意构造的Office文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-11882 漏洞是 Microsoft Office 公式编辑器 (EQNEDT32.EXE) 中的一个内存损坏漏洞。攻击者可以利用此漏洞在当前用户的上下文中执行任意代码。该漏洞存在于Office软件的公式编辑器中，由于编辑器进程没有对名称长度进行校验，导致缓冲区溢出。攻击者通过构造特殊的字符，可以实现任意代码执行。

**有效性：**

根据漏洞库信息、搜索引擎结果和漏洞利用代码，此漏洞的POC代码有效。多个来源表明该漏洞在野外被积极利用，并且存在可用的Metasploit模块。

**投毒风险：**

分析提供的POC代码（Command109b_CVE-2017-11882.py），该脚本接受一个最大长度为109字节的命令。虽然代码本身看起来直接利用漏洞执行命令，但存在作者在其他文件，例如生成的Office文档中，加入恶意代码的可能性。风险评估为10%。

**利用方式：**

1.  **利用公式编辑器溢出：** 攻击者创建一个特制的Office文档，其中包含一个恶意的公式编辑器对象。
2.  **缓冲区溢出：** 当Office尝试解析此公式时，由于未正确验证输入长度，导致缓冲区溢出。
3.  **执行任意代码：** 溢出允许攻击者覆盖内存中的返回地址，并控制程序执行流程，从而执行攻击者提供的shellcode。
4.  **代码执行：**  利用代码可以执行任意命令，例如启动计算器（calc.exe），或者执行更复杂的恶意操作，例如下载和执行恶意软件 (Agent Tesla)。 通过mshta的方式，加载远程的payload，获取shell。

**缓解措施：**
* 应用Microsoft提供的安全补丁。
* 禁用或删除公式编辑器组件（如果不需要）。
* 提高用户安全意识，避免打开来源不明的Office文档。

**项目地址:** [littlebin404/CVE-2017-11882](https://github.com/littlebin404/CVE-2017-11882)

**漏洞详情:** [CVE-2017-11882](https://nvd.nist.gov/vuln/detail/CVE-2017-11882)