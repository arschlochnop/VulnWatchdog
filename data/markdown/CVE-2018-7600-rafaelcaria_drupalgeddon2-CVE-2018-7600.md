## CVE-2018-7600-Drupal-RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点必须使用受影响的版本，且未打补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600，又名Drupalgeddon2，是一个Drupal核心的远程代码执行漏洞。该漏洞源于Drupal的Forms API中存在属性注入缺陷，允许未经身份验证的攻击者通过构造特制的请求来执行任意代码。

**有效性：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，此漏洞的POC代码是有效的。漏洞库信息明确指出存在远程代码执行，搜索结果中也确认了该漏洞的严重性和广泛利用。提供的Python脚本`drupalgeddon2.py`允许测试目标是否易受攻击，并执行任意命令。

**投毒风险：**
虽然提供的代码可以直接利用漏洞执行命令，但仍然存在一定的投毒风险，例如：
*   该仓库只包含简单的利用脚本和一个README,代码量少,检查难度低. 
*   代码中利用`requests`库发送HTTP请求，如果被篡改，可能会向恶意服务器发送敏感信息或执行其他恶意操作.因为代码量少,只有10%的风险。

**利用方式：**
该漏洞的利用方式如下：
1.  攻击者构造一个包含恶意参数的HTTP POST请求，发送到目标Drupal站点的`user/password`路径。
2.  恶意参数利用了Drupal Forms API中的`#post_render`属性，允许攻击者指定一个PHP函数（例如`passthru`）来执行命令。
3.  `name[#markup]`参数包含要执行的操作系统命令。
4.  目标Drupal站点处理请求时，会执行攻击者指定的命令。
5.  攻击者可以通过`?q=/file/ajax/name/%23value/` 获取命令执行的结果。

总之，CVE-2018-7600是一个严重的安全漏洞，允许远程攻击者执行任意代码。提供的POC代码是有效的，但使用者应谨慎使用，并注意潜在的投毒风险。

**项目地址:** [rafaelcaria/drupalgeddon2-CVE-2018-7600](https://github.com/rafaelcaria/drupalgeddon2-CVE-2018-7600)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)