## CVE-2023-25813-Sequelize-SQL注入

**漏洞编号:** CVE-2023-25813

**漏洞类型:** SQL注入

**影响应用:** Sequelize

**危害等级:** 高危，可能导致数据泄露、数据篡改和远程代码执行（取决于数据库权限）

**影响版本:** < 6.19.1

**利用条件:** 应用程序必须使用Sequelize ORM，且使用`replacements`选项与`literal`函数结合进行查询。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25813 是 Sequelize ORM 中一个严重的 SQL 注入漏洞。该漏洞源于在低于 6.19.1 的版本中，当 `replacements` 选项与 `literal` 函数一起使用时，对用户输入未进行充分的转义。

**漏洞利用方式：**

1.  攻击者可以构造恶意的 `firstName` 值，例如 `OR true; DROP TABLE users;`。
2.  当这个恶意值通过 `replacements` 选项传递给 `User.findAll` 方法时，由于 `literal` 函数的内容不会被转义，恶意 SQL 代码会被注入到查询中。
3.  如果数据库配置允许执行多个 SQL 语句，攻击者可以执行任意 SQL 命令，例如删除整个用户表。

**有效性：**

提供的 PoC 代码是有效的，它展示了如何利用 `replacements` 选项中的 SQL 注入漏洞。攻击者通过控制 `firstName` 参数，可以执行任意 SQL 命令。

**投毒风险：**

代码仓库存在潜在的投毒风险。虽然主要的 PoC 文件（README.md，index.js）展示的是SQL注入漏洞的利用方式，但其他部分可能包含恶意代码，即使这些代码不直接参与漏洞的利用，也可能对部署该代码的环境造成损害。特别是在`/join`路由中，如果存在未经验证的用户输入直接操作数据库，容易造成安全隐患。尽管代码中没有明显的后门，但用户注册流程可以被滥用，例如创建大量恶意账户。综合考虑，投毒风险评估为 10%。

**项目地址:** [bde574786/Sequelize-1day-CVE-2023-25813](https://github.com/bde574786/Sequelize-1day-CVE-2023-25813)

**漏洞详情:** [CVE-2023-25813](https://nvd.nist.gov/vuln/detail/CVE-2023-25813)