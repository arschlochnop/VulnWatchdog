## CVE-2025-24813 Apache Tomcat Path Equivalence / Deserialization RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 11.0.0-M1 through 11.0.2, 10.1.0-M1 through 10.1.34, 9.0.0.M1 through 9.0.98

**利用条件:** 对于路径等价漏洞：默认Servlet启用写入权限，支持partial PUT，存在目标URL是公共上传URL的子目录，攻击者知道敏感文件名，并且敏感文件通过partial PUT上传。对于反序列化漏洞：默认Servlet启用写入权限，支持partial PUT，应用程序使用Tomcat基于文件的session持久化默认存储位置，应用程序包含可用于反序列化攻击的库。

**POC 可用性:** 是

**投毒风险:** 100%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-24813 是 Apache Tomcat 中的一个漏洞，它涉及到路径等价和反序列化两个方面。路径等价漏洞允许攻击者通过特殊的路径构造（例如使用内部点 `.Name`）来访问或修改受保护的文件。如果同时启用了 Default Servlet 的写入权限和 Partial PUT 支持，攻击者可以上传恶意文件，导致信息泄露或远程代码执行。反序列化漏洞则允许攻击者通过上传包含恶意序列化数据的 session 文件，结合 Tomcat 的文件 session 持久化机制以及应用程序中存在的易受攻击的反序列化库，最终实现远程代码执行。

漏洞利用方式：

1.  **路径等价攻击：** 攻击者利用 `file.Name` 这样的路径构造绕过访问控制，结合 Default Servlet 的写入权限和 Partial PUT 支持，上传恶意 JSP 文件或覆盖现有的配置文件。
2.  **反序列化攻击：** 攻击者首先确定目标应用程序使用了 Tomcat 的默认文件 session 持久化位置，然后构造恶意的序列化 payload，该 payload 利用应用程序依赖中的反序列化漏洞执行任意代码。 攻击者通过 Partial PUT 上传包含此 payload 的 session 文件到 Tomcat 的 session 存储目录，当 Tomcat 反序列化该 session 时，payload 被触发，导致远程代码执行。

提供的 POC 代码 `CVE-2025-24813_POC.py` 旨在利用反序列化漏洞。代码中包含了一个 Java 序列化 payload (payload_01)，它被编码为十六进制字符串。 该 payload 似乎是为了利用 `TemplatesImpl` 类中的漏洞来执行任意代码。 脚本首先尝试连接到目标 Tomcat 服务器，然后使用 Partial PUT 请求上传包含恶意 payload 的文件。  payload 包含占位符 {payload}，说明此exp并非完整，需要二次编辑才可使用。

有效性分析： 根据提供的代码片段，结合漏洞描述， 该POC 代码利用反序列化漏洞，因此，在满足反序列化漏洞的条件时，POC有效。

投毒风险分析：POC 代码中使用了硬编码的 payload 和目标 URL。攻击者可以很容易地修改这些参数以执行恶意操作，例如上传后门或窃取敏感数据，而不仅仅是执行简单的命令。  因此，该 POC 具有高投毒风险。并且其中存在占位符，说明需要进行二次编辑,那么投毒风险就是百分之百。


**项目地址:** [N0c1or/CVE-2025-24813_POC](https://github.com/N0c1or/CVE-2025-24813_POC)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)