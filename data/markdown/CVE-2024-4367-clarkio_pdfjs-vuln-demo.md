## CVE-2024-4367-PDF.js-JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** JavaScript执行

**影响应用:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**危害等级:** 高危，允许在PDF.js上下文中执行任意JavaScript代码

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 需要用户打开恶意的PDF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4367是PDF.js中处理字体时缺少类型检查导致的一个漏洞，攻击者可以构造恶意的PDF文件，利用此漏洞在PDF.js上下文中执行任意JavaScript代码。这可能导致信息泄露、跨站脚本攻击（如果PDF.js在Web环境中运行）或者在某些情况下，完全控制受影响的应用程序（如Firefox、Thunderbird）。

**有效性分析：**
提供的漏洞利用代码是一个演示项目，旨在展示如何利用CVE-2024-4367漏洞。它包含React、Vue和Svelte的前端组件，用于加载和显示PDF文件。README.md文件指示如何运行该项目以及如何测试不同的PDF文件，包括利用该漏洞的PDF文件。根据描述，通过修改组件中引用的PDF文件，可以将一个利用漏洞的PDF加载到这些组件中进行测试。搜索引擎结果中“[webpage 6 begin] [title] exfil0/WEAPONIZING-CVE-2024-4367” 表明漏洞利用代码已公开。 综上，提供的PoC代码是有效的。

**投毒风险分析：**
查看漏洞利用代码，其中包含package-lock.json等文件。虽然没有发现立即可以判断为投毒的恶意代码，但考虑到npm包供应链的风险，不能完全排除作者在依赖项中引入恶意代码的可能性。代码本身的功能是创建一个演示环境来展示漏洞，因此大部分代码都是正常的框架代码。不过，**不能完全排除投毒的可能，风险估计为10%**。 代码中存在引用外部npm包的可能性。潜在风险点包括：依赖包本身是否安全，是否包含恶意代码；构建流程中是否存在被篡改的风险；以及开发者是否故意隐藏了恶意功能。 仔细审查 `package-lock.json` 文件中的依赖项及其来源，验证依赖包的完整性和安全性，可以降低投毒风险。 由于仅仅是demo代码，且依赖的包比较多，因此这里不能明确进行判断是否存在恶意代码。

**利用方式分析：**
1.  **漏洞触发点：** PDF.js在处理PDF文件中的字体时，缺少必要的类型检查。
2.  **攻击步骤：**
    *   攻击者构造一个恶意的PDF文件，该文件包含精心设计的字体数据。
    *   当PDF.js解析该PDF文件并处理字体时，由于缺少类型检查，会触发漏洞。
    *   攻击者通过构造特殊的字体数据，可以在PDF.js上下文中执行任意JavaScript代码。
3.  **攻击效果：** 成功利用该漏洞可以执行任意JavaScript代码，从而可能导致敏感信息泄露，或者在特定情况下完全控制应用程序。

**项目地址:** [clarkio/pdfjs-vuln-demo](https://github.com/clarkio/pdfjs-vuln-demo)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)