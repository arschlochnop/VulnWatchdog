## CVE-2025-29927-Next.js-中间件鉴权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 鉴权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞的Next.js版本，并且鉴权逻辑在中间件中实现

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927 是一个 Next.js 中间件鉴权绕过漏洞。该漏洞源于 Next.js 对 `x-middleware-subrequest` header 处理不当。攻击者可以通过发送带有特定 `x-middleware-subrequest` header 的恶意请求，绕过中间件中的鉴权检查，从而访问受保护的资源。根据漏洞库信息，受影响的版本包括 >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3。

**有效性：**
提供的 POC 代码 `cve_2025_29927_bypass.py` 旨在测试该漏洞的有效性。它通过发送带有不同 `x-middleware-subrequest` header 的 HTTP 请求，并分析服务器的响应状态码，以判断是否存在鉴权绕过。代码逻辑清晰，可有效验证漏洞。

**投毒风险：**
经分析，该 POC 代码未发现存在恶意投毒代码的迹象。代码功能单一，主要用于发送带有特定 header 的 HTTP 请求，并根据响应状态码判断是否存在漏洞。没有发现执行恶意操作或传播恶意代码的逻辑。

**利用方式：**
1.  **确定目标：** 确定运行存在漏洞版本的 Next.js 应用程序。
2.  **发送恶意请求：** 使用 POC 代码或手动构造 HTTP 请求，在请求头中包含 `x-middleware-subrequest` 字段，并尝试不同的值 (例如 `middleware`, `randomstring`, 空字符串等)。
3.  **分析响应：** 观察服务器的响应状态码。如果返回 200 OK，则表明可能成功绕过鉴权，攻击者可以访问受保护的资源。如果返回 401 或 403，则表明鉴权生效，漏洞利用失败。

该漏洞利用的关键在于 `x-middleware-subrequest` header 的处理不当，因此通过操纵该 header 的值，可以绕过中间件的鉴权逻辑。

**项目地址:** [Hirainsingadia/CVE-2025-29927](https://github.com/Hirainsingadia/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)