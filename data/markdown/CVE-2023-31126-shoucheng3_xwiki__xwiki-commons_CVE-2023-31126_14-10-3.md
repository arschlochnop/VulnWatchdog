## CVE-2023-31126-xwiki-commons-xml-XSS

**漏洞编号:** CVE-2023-31126

**漏洞类型:** 跨站脚本 (XSS)

**影响应用:** xwiki-commons

**危害等级:** 高危，可能导致账户劫持、信息泄露和恶意代码执行

**影响版本:** >= 14.6-rc-1, < 14.10.4

**利用条件:** 需要用户交互，利用恶意构造的XML数据属性

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-31126 是一个存在于 org.xwiki.commons:xwiki-commons-xml 库中的跨站脚本漏洞。漏洞源于HTML sanitizer对数据属性名称中无效字符的不当处理。攻击者可以通过注入包含恶意数据属性的HTML代码，从而执行任意JavaScript代码。漏洞利用需要用户交互，即用户需要浏览包含恶意代码的页面。尽管提供的 Jenkinsfile 文件与漏洞本身没有直接关系，它只是一个构建脚本，但可以被恶意修改以包含攻击载荷或者执行恶意操作，因此存在一定的投毒风险。

**有效性：**
漏洞库信息和搜索结果表明此漏洞存在并且可以被利用，因为允许注入任意HTML代码，从而可以注入XSS。

**投毒风险：**
提供的 Jenkinsfile 代码本身并非漏洞利用代码，而是一个 Jenkins 构建脚本，用于构建 XWiki Commons 项目。虽然此代码本身看起来没有直接的恶意代码，但存在被投毒的风险。例如，攻击者可以修改构建脚本，在构建过程中引入恶意依赖或执行恶意命令。

评估：该 Jenkinsfile 代码本身不构成直接的漏洞利用，但其存在的目的是用于构建项目。因此可以间接的进行攻击，比如篡改依赖，构建产物。

**利用方式：**
1.  攻击者构造包含恶意数据属性的HTML代码，例如：`<div data-x="</script><script>alert('XSS')</script>"></div>`。
2.  将此恶意HTML代码注入到 XWiki 页面中，例如通过编辑页面内容或利用其他漏洞。
3.  当用户浏览包含此恶意代码的页面时，恶意JavaScript代码将被执行，可能导致账户劫持、信息泄露等。

**总结：**
此漏洞是一个典型的XSS漏洞，攻击者可以利用它在用户浏览器中执行恶意代码。虽然提供的POC不是直接的XSS payload，但是该文件为jenkinsfile，如果被投毒会导致编译出存在漏洞的程序，间接实现攻击。

**项目地址:** [shoucheng3/xwiki__xwiki-commons_CVE-2023-31126_14-10-3](https://github.com/shoucheng3/xwiki__xwiki-commons_CVE-2023-31126_14-10-3)

**漏洞详情:** [CVE-2023-31126](https://nvd.nist.gov/vuln/detail/CVE-2023-31126)