## CVE-2024-27198-JetBrains TeamCity 认证绕过漏洞

**漏洞编号:** CVE-2024-27198

**漏洞类型:** 认证绕过

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，允许未授权用户执行管理操作

**影响版本:** < 2023.11.4

**利用条件:** 目标TeamCity实例可网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-27198是JetBrains TeamCity 2023.11.4之前版本中存在的认证绕过漏洞。漏洞允许未经身份验证的攻击者执行管理操作。提供的漏洞利用代码(CVE-2024-27198-RCE.py)尝试通过以下步骤利用此漏洞：

1.  **添加用户：** 首先，利用脚本的`/hax?jsp=/app/rest/users;.jsp`端点，尝试添加具有管理员权限的新用户，如果成功，则会拿到新增用户的userID。
2.  **获取Token：** 为该新增用户创建token，用于后续鉴权。
3.  **获取操作系统版本：** 脚本通过访问`/app/rest/debug/processes`端点，尝试执行`echo ReadyGO`命令来判断目标操作系统是Linux还是Windows。
4.  **执行命令：** 在获取操作系统版本后，脚本再次使用`/app/rest/debug/processes`端点，通过构造特定的URL来执行任意命令。命令的执行依赖于上一步token是否获取成功。

根据漏洞库信息，该漏洞已被CISA列入已知被利用漏洞目录，表明该漏洞在野外已被积极利用。CVSS评分为9.8，属于严重级别。提供的POC代码利用了身份验证绕过漏洞，能够创建管理员用户并执行任意命令，验证了其有效性。

**投毒风险评估：**

仔细检查提供的POC代码后，没有发现明显的恶意或投毒代码。代码逻辑清晰，主要用于利用漏洞进行身份验证绕过和命令执行。代码中的功能都与漏洞利用直接相关，没有发现与预期功能不符的隐藏或可疑行为。

**利用方式总结：**

攻击者可以通过发送特制的请求绕过身份验证，然后利用绕过的身份验证执行管理操作，包括添加恶意用户和执行任意命令。该漏洞可能被用于控制TeamCity服务器，窃取敏感信息，或者进一步攻击内部网络。

**项目地址:** [passwa11/CVE-2024-27198-RCE](https://github.com/passwa11/CVE-2024-27198-RCE)

**漏洞详情:** [CVE-2024-27198](https://nvd.nist.gov/vuln/detail/CVE-2024-27198)