## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 用户需要clone包含恶意配置的仓库或者初始化包含恶意配置的submodule。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384 是一个 Git 漏洞，允许攻击者通过精心构造的 Git 配置文件执行任意代码。该漏洞源于 Git 在处理包含回车符（CR）的配置值时的方式不一致。当读取配置值时，Git 会去除尾部的 CRLF。但是，当写入配置条目时，如果值包含尾部的 CR，则不会被正确引用，导致在后续读取配置时丢失 CR。根据漏洞描述和搜索结果，此漏洞可能通过以下方式利用：

1.  **恶意配置：** 攻击者创建一个包含恶意配置的 Git 仓库或 submodule。该配置中，submodule 的路径包含尾部的回车符（CR）。
2.  **符号链接操纵：** 由于 Git 在处理包含 CR 的 submodule 路径时存在缺陷，恶意仓库可以通过创建一个符号链接，将修改后的 submodule 路径指向 `.git/hooks` 目录。
3.  **钩子执行：** 当用户递归克隆恶意仓库时，Git 会将 submodule 检出到错误的位置（符号链接指向的位置），从而触发 `.git/hooks/post-checkout` 钩子。攻击者可以在 `post-checkout` 钩子中放置恶意代码，使其在克隆过程中被执行。

**POC有效性：**

提供的 POC 代码包含两个文件：

*   `README.md`: 指向了GitHub上的漏洞详情页面。
*   `post-checkout`: 包含简单的 shell 命令 `echo "Uh-oh, this is an RCE!"`。该脚本模拟了远程代码执行。

该 POC 代码看起来是有效的，因为它演示了如何通过 `post-checkout` 钩子执行任意命令。

**投毒风险：**

分析 POC 代码内容。`post-checkout` 脚本中的代码仅仅是用于验证 RCE 的，没有发现隐藏的恶意代码。因此，投毒风险为 0%。

**利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，该配置包括一个包含尾部 CR 的 submodule 路径，以及一个将修改后的 submodule 路径指向 `.git/hooks` 的符号链接。
2.  攻击者在 submodule 的 `.git/hooks/post-checkout` 文件中放置恶意代码。
3.  攻击者诱使用户递归克隆恶意仓库（`git clone --recursive <repository_url>`）。
4.  当用户克隆仓库时，Git 会错误地解析 submodule 路径，并触发 `post-checkout` 钩子，从而执行攻击者的恶意代码。

**项目地址:** [sahar042/CVE-2025-48384-submodule](https://github.com/sahar042/CVE-2025-48384-submodule)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)