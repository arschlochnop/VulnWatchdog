## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未授权用户创建管理员账户，完全控制Confluence实例

**影响版本:** 8.0.0 <= version <= 8.5.1 (受影响版本不包括 8.3.3, 8.4.3, 8.5.2)

**利用条件:** Confluence实例可以公开访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-22515是一个Atlassian Confluence Server和Data Center中的Broken Access Control漏洞。未经身份验证的攻击者可以利用此漏洞创建未授权的Confluence管理员账户。 

**利用方式：**

1.  **检查漏洞是否存在：** 通过访问`/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`页面来判断Confluence是否已完成初始化设置，如果返回包含"success"，则可能存在漏洞。
2.  **创建管理员账户：** 如果系统未完成设置，攻击者可以发送POST请求到`/setup/setupadministrator.action`，设置用户名、密码和邮箱等信息，创建一个新的管理员账户。
3.  **完成设置：** 创建管理员账户后，发送POST请求到`/setup/finishsetup.action`来完成设置。

**POC有效性：**

根据漏洞信息和利用代码，提供的POC代码有效。它可以自动化创建管理员账号的过程，从而验证漏洞的存在。

**投毒风险：**

虽然POC代码本身的功能是利用漏洞创建管理员账号，但我们需要评估是否存在作者隐藏的恶意代码。审查发现，代码主要功能为发送HTTP请求，生成随机用户名密码，没有发现明显的恶意行为，投毒风险极低,风险评估为1%。风险主要来源于对目标URL的误用和依赖库的安全。

**搜索引擎结果：**

搜索结果表明CVE-2023-22515是一个高危漏洞，被广泛利用。CISA也发布了相关的安全公告，敦促用户尽快修复。

**项目地址:** [sincere9/CVE-2023-22515](https://github.com/sincere9/CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)