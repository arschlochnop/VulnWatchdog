## CVE-2025-0133 PAN-OS GlobalProtect Reflected XSS

**漏洞编号:** CVE-2025-0133

**漏洞类型:** Reflected XSS

**影响应用:** PAN-OS GlobalProtect Gateway & Portal

**危害等级:** 中危，可能导致凭据盗窃和钓鱼攻击

**影响版本:** PAN-OS 11.2.0 through 11.2.7; PAN-OS 11.1.0 through 11.1.10; PAN-OS 10.2.0 through 10.2.16; PAN-OS 10.1.0 through 10.1.14

**利用条件:** 需要目标系统启用GlobalProtect Gateway或Portal功能，且受害者点击特制的恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-0133 是 Palo Alto Networks PAN-OS GlobalProtect Gateway 和 Portal 功能中的一个反射型跨站脚本 (XSS) 漏洞。该漏洞允许攻击者通过诱骗用户点击特制链接，在已通过身份验证的 Captive Portal 用户的浏览器上下文中执行恶意 JavaScript。主要风险是可能导致凭据盗窃的钓鱼攻击，尤其是在启用了 Clientless VPN 的情况下。

**有效性：**

提供的 POC 代码是一个 Bash 脚本，利用 `nuclei` 和 `shodanx` 扫描器来检测 CVE-2025-0133 漏洞。该脚本通过 Shodan 查询查找相关的 GlobalProtect 实例，然后使用 nuclei 模板扫描这些目标是否存在 XSS 漏洞。

**投毒风险：**

该脚本本身没有明显的恶意代码。但是，存在以下潜在风险：

*   **对外部工具的依赖性：** 该脚本依赖于 `nuclei` 和 `shodanx`，如果这些工具被恶意修改或感染，可能会导致安全问题。
*   **nuclei 模板的风险：** 脚本使用的 nuclei 模板(`/home/user/nuclei-templates/http/cves/2025/CVE-2025-0133.yaml`)如果被篡改，可能存在误报或执行恶意操作的风险。虽然该yaml文件并未提供，但可以推测其payload如果设计不当，可能存在风险。
*   **Shodan API 密钥泄露：** 如果脚本中硬编码了 Shodan API 密钥，或者密钥文件被泄露，可能被滥用。
*   **输入验证不足：** 脚本可能存在输入验证不足的问题，如果输入恶意构造的域名或 IP 地址，可能导致命令注入等安全问题。

总体而言，该脚本的投毒风险较低 (10%)，但需要谨慎使用，并确保所依赖的外部工具和资源是可信的。

**利用方式：**

1.  攻击者创建一个包含恶意 JavaScript 代码的特制 URL，该 URL 针对易受攻击的 GlobalProtect Portal 或 Gateway。
2.  攻击者通过电子邮件、社交媒体或其他方式将此 URL 发送给目标用户。
3.  如果用户点击了该 URL，恶意 JavaScript 代码将在用户的浏览器中执行。
4.  恶意代码可以窃取用户的凭据、重定向用户到恶意网站或执行其他恶意操作。

**缓解措施：**

*   升级到已修复此漏洞的 PAN-OS 版本。
*   启用 Threat Prevention 订阅，并启用 Threat ID 510003 和 510004。
*   禁用 Clientless VPN（如果不需要）。
*   对用户进行安全意识培训，告知他们不要点击来自未知来源的链接。

**项目地址:** [INTELEON404/CVE-2025-0133](https://github.com/INTELEON404/CVE-2025-0133)

**漏洞详情:** [CVE-2025-0133](https://nvd.nist.gov/vuln/detail/CVE-2025-0133)