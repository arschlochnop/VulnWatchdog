## CVE-2022-21449 - Java ECDSA 签名绕过 (Psychic Signatures)

**漏洞编号:** CVE-2022-21449

**漏洞类型:** 身份验证绕过

**影响应用:** Oracle Java SE, Oracle GraalVM Enterprise Edition

**危害等级:** 高危，可能导致未经授权的访问和数据篡改

**影响版本:** Oracle Java SE: 17.0.2 and 18; Oracle GraalVM Enterprise Edition: 21.3.1 and 22.0.0.2

**利用条件:** 需要受影响的 Java 版本，且应用程序使用 ECDSA 签名验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-21449，又名“Psychic Signatures”，是一个存在于 Java ECDSA 签名验证实现中的严重漏洞。攻击者可以通过提供一个特制的、实际上无效的签名来绕过身份验证。该漏洞源于 Java 15 中 ECDSA 签名验证算法的不当实现。 漏洞利用方式通常是向服务器发送包含零值的 's' 和 'r' 参数的签名，导致验证通过，即使签名无效。

**有效性评估：** 根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且容易被利用。已经有公开可用的PoC代码 (例如：https://github.com/notkmhn/CVE-2022-21449-TLS-PoC )证明了这一点。  

**投毒风险评估：** 提供的漏洞利用代码 `/tmp/bdd9c863ddd4947df1834a1e00949872/mvnw` 只是一个 Maven Wrapper 脚本。它本身不包含任何恶意代码或后门。这个脚本的作用是下载和运行指定版本的 Maven，以便构建项目。因此，该文件投毒风险极低。`mvnw`脚本内容是用于自动管理maven版本，不包含恶意代码。因此投毒风险评估为0%。

**利用方式分析：**

1.  **漏洞原理：**  该漏洞是由于 Java 在处理 ECDSA 签名时，没有正确验证签名的 's' 和 'r' 参数。当这两个参数为零时，验证逻辑存在缺陷，导致无效签名被接受。
2.  **攻击步骤：**
    *   攻击者构造一个包含无效 ECDSA 签名的请求。关键在于将签名的 's' 和 'r' 参数设置为零。
    *   将恶意请求发送到使用受影响 Java 版本进行 ECDSA 签名验证的服务器。
    *   由于漏洞存在，服务器会错误地认为签名有效，从而允许攻击者绕过身份验证。
3.  **影响：** 成功利用此漏洞可能允许攻击者以任何用户的身份进行身份验证，从而导致未经授权的访问、数据篡改或其他恶意活动。

**项目地址:** [jmiettinen/CVE-2022-21449-vuln-test](https://github.com/jmiettinen/CVE-2022-21449-vuln-test)

**漏洞详情:** [CVE-2022-21449](https://nvd.nist.gov/vuln/detail/CVE-2022-21449)