## CVE-2017-12615-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12615 允许攻击者通过精心构造的HTTP PUT请求上传JSP文件到服务器，从而导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的Dockerfile，该漏洞的POC代码大概率是有效的。漏洞库和搜索结果均表明存在公开的漏洞利用代码。提供的Dockerfile构建了一个存在漏洞的Tomcat 7.0.79环境，为漏洞复现提供了基础。  搜索结果中也存在可以用来进行漏洞复现的web页面，例如： https://www.keysight.com/blogs/en/tech/nwvs/2020/11/11/deconstructing-apache-tomcat-jsp-upload-remote-code-execution-cve-2017-12615

**投毒风险：**
提供的代码包括Dockerfile、README.md 和 web.xml，主要关注Dockerfile和web.xml。Dockerfile指定了tomcat的版本和基础镜像，并没有发现恶意代码。web.xml 文件设置了一些参数，其中`readonly`如果设置成`false`，才会存在漏洞。从现有代码来看，没有明显的投毒代码。该仓库中存在的风险在于，攻击者可能伪造其他的 Dockerfile 镜像。综合考虑，判断为10%的投毒风险。

**利用方式：**
1.  **环境准备：** 搭建存在漏洞的Tomcat环境，需要Tomcat版本在7.0.0到7.0.79之间，运行在Windows系统上，并且开启了HTTP PUT方法（`readonly`初始化参数设置为`false`）。
2.  **JSP文件上传：** 攻击者利用HTTP PUT方法，上传一个包含恶意代码的JSP文件。需要注意的是，上传的文件名需要绕过Tomcat的防御机制，例如可以使用特殊字符或后缀名。
3.  **代码执行：** 成功上传JSP文件后，攻击者可以通过访问该JSP文件的URL来触发恶意代码的执行，从而实现远程代码执行。


**项目地址:** [cved-sources/cve-2017-12615](https://github.com/cved-sources/cve-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)