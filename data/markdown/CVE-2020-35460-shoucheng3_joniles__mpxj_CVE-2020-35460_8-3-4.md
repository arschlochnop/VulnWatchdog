## CVE-2020-35460 - MPXJ Directory Traversal

**漏洞编号:** CVE-2020-35460

**漏洞类型:** 目录遍历

**影响应用:** MPXJ

**危害等级:** 中危，可能导致任意文件写入

**影响版本:** < 8.3.5

**利用条件:** 需要能够控制MPXJ处理的ZIP文件内容。

**POC 可用性:** 否（但漏洞信息明确，可构造利用）

**投毒风险:** 5%

## 详情

CVE-2020-35460 是 Packwood MPXJ 8.3.5 之前的版本中 `common/InputStreamHelper.java` 文件存在的一个目录遍历漏洞。该漏洞位于 zip 流处理流程中，允许攻击者通过构造恶意的 ZIP 文件，将文件写入到服务器上的任意位置。

**有效性：**
根据漏洞描述，该漏洞允许目录遍历，可以将文件写入任意位置。虽然没有直接提供PoC代码，但漏洞描述明确，可以根据描述构造一个包含恶意路径的ZIP文件来利用此漏洞。因此，漏洞是有效的。

**投毒风险：**
提供的代码是MPXJ的版本更新日志，用于描述不同版本之间的更改和修复。虽然不能直接作为PoC利用,但作者可能在历史版本中引入恶意代码的可能性极低，判断投毒风险为5%。

**利用方式：**
攻击者可以创建一个恶意的ZIP文件，其中包含带有目录遍历序列（例如 `../`）的文件名。当 MPXJ 处理此 ZIP 文件时，`InputStreamHelper.java` 中的代码会将这些文件解压到攻击者指定的目录，从而实现任意文件写入。例如，ZIP 文件中的文件名可以是 `../../../tmp/evil.txt`，这将导致文件 `evil.txt` 被写入到 `/tmp` 目录中。然后攻击者通过上传该恶意zip文件，触发MPXJ进行处理，即可将恶意文件写入目标服务器。

**项目地址:** [shoucheng3/joniles__mpxj_CVE-2020-35460_8-3-4](https://github.com/shoucheng3/joniles__mpxj_CVE-2020-35460_8-3-4)

**漏洞详情:** [CVE-2020-35460](https://nvd.nist.gov/vuln/detail/CVE-2020-35460)