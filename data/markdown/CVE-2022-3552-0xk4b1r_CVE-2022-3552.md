## CVE-2022-3552 BoxBilling 文件上传漏洞

**漏洞编号:** CVE-2022-3552

**漏洞类型:** 文件上传

**影响应用:** BoxBilling

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.0.1，可能也包括4.22.1.5 (根据Exploit-DB的描述)

**利用条件:** 需要管理员权限的已认证会话(根据Exploit-DB的描述)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-3552 描述了 BoxBilling 在 0.0.1 版本之前存在一个不受限制的文件上传漏洞。攻击者可以通过上传具有危险类型的文件来执行任意代码。根据 Exploit-DB (webpage 5) 和 Packet Storm (webpage 9) 的描述，BoxBilling 4.22.1.5 也受到此漏洞影响。漏洞利用代码中的 login 函数尝试使用提供的 email 和 password 登录。box_billing_rce_exploit 函数构造了一个 PHP 逆向 shell 负载。如果成功上传并执行该负载，攻击者将获得目标系统的 shell 访问权限。 代码中的小概率投毒风险在于，虽然主要功能是建立反向shell，但`printit` 函数可以被修改为在目标系统上执行其他恶意操作，或者收集信息并发送到外部服务器，但目前的比例非常低。端口和IP地址都明文显示, 容易被发现, 作者大概率是想完成利用，而不是投毒。

**项目地址:** [0xk4b1r/CVE-2022-3552](https://github.com/0xk4b1r/CVE-2022-3552)

**漏洞详情:** [CVE-2022-3552](https://nvd.nist.gov/vuln/detail/CVE-2022-3552)