## CVE-2015-9251-jQuery-跨站脚本攻击（XSS）

**漏洞编号:** CVE-2015-9251

**漏洞类型:** 跨站脚本攻击（XSS）

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户信息泄露、会话劫持和恶意代码执行

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用存在漏洞的jQuery版本，且允许跨域Ajax请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-9251 存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果未设置 `dataType` 选项，且服务器返回 `text/javascript` 内容类型，则响应内容将被当作 JavaScript 代码执行，从而导致 XSS 漏洞。

**有效性：**

提供的 POC 代码是有效的。它模拟了一个跨域 Ajax 请求，请求的目标是 `https://sakurity.com/jqueryxss`。如果这个URL返回的内容是 `text/javascript`类型，并且不指定`dataType`，就会执行返回的js代码，从而触发xss漏洞

**投毒风险：**

分析提供的文件，`/tmp/d259c26585c0db19b58b7b9c08c78627/CVE-2015-9251.html` 和 `/tmp/d259c26585c0db19b58b7b9c08c78627/README.md` 看起来都是标准的文件，用于展示漏洞的利用方法。 没有发现任何可疑的代码或行为，表明该存储库中没有隐藏的投毒代码。风险系数为0%。

**利用方式：**

1.  **确定目标网站是否使用了存在漏洞的 jQuery 版本。** 可以通过查看网站的源代码或使用开发者工具来判断。
2.  **找到一个可以发起跨域 Ajax 请求的点。** 这通常涉及到用户可控的 URL 参数或表单。
3.  **构造一个跨域 Ajax 请求，将 `url` 设置为指向攻击者控制的服务器。**
4.  **在攻击者控制的服务器上，返回 `Content-Type: text/javascript` 的响应，并在响应内容中包含恶意的 JavaScript 代码。**
5.  **当用户访问包含该恶意请求的页面时，恶意代码将在用户的浏览器中执行。**

**防范措施：**

*   升级 jQuery 到 3.0.0 或更高版本。
*   在执行跨域 Ajax 请求时，始终明确指定 `dataType` 选项，避免浏览器自动解析响应内容。
*   对所有用户输入进行严格的验证和过滤，防止 XSS 攻击。

**项目地址:** [halkichi0308/CVE-2015-9251](https://github.com/halkichi0308/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)