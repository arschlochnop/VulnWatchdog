## CVE-2024-8232 - SpiderControl SCADA Web Server 未授权文件上传

**漏洞编号:** CVE-2024-8232

**漏洞类型:** 未授权文件上传

**影响应用:** SpiderControl SCADA Web Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= v2.09

**利用条件:** 目标服务器运行受影响版本的SpiderControl SCADA Web Server，且攻击者能够访问目标服务器的网络端口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

根据漏洞信息，SpiderControl SCADA Web Server存在一个未授权的文件上传漏洞（CVE-2024-8232）。攻击者可以通过未经身份验证的方式上传恶意文件，例如webshell，从而获取远程代码执行权限。提供的POC代码 `poc.py` 实现了该漏洞的利用，它允许攻击者指定目标URL、上传路径和要上传的文件。 

**有效性：**
从漏洞描述和提供的POC代码来看，该漏洞利用的有效性较高。POC代码直接利用了未授权的文件上传漏洞，模拟了攻击者上传恶意文件的过程。上传成功后，攻击者可以通过访问上传的文件（例如webshell）来执行任意代码。

**投毒风险：**
提供的POC代码 `poc.py` 相对简单，主要功能是发送HTTP POST请求来上传文件。代码中没有明显的恶意行为，例如反弹shell、下载其他恶意文件等。`README.md` 也声明此PoC仅用于教育目的。但是，仍然存在一定的投毒风险，虽然很小：
1.  **参数欺骗：** 攻击者可能修改POC脚本，使用户上传的文件内容被篡改，例如添加后门或恶意代码。这种风险可以通过仔细检查POC脚本和上传的文件来降低。
2.  **依赖包风险：** 尽管代码本身看起来安全，但它依赖于 `requests` 库。如果 `requests` 库被恶意篡改，可能会引入额外的风险。

总体来说，投毒风险较低，但仍然需要保持警惕。

**利用方式：**
1.  **确定目标：** 确定运行着受影响版本的SpiderControl SCADA Web Server的目标服务器。
2.  **准备恶意文件：** 准备一个恶意文件，例如webshell（PHP、JSP等），用于上传到目标服务器。该文件将允许攻击者执行任意命令。
3.  **运行POC脚本：** 使用提供的POC脚本 `poc.py` ，指定目标URL、上传路径和恶意文件。例如：
   ```bash
   python3 poc.py http://TARGET-IP upload.php shell.php
   ```
4.  **访问上传的文件：** 上传成功后，通过浏览器访问上传的文件（例如 `http://TARGET-IP/shell.php`）。
5.  **远程代码执行：** 如果上传的是webshell，攻击者可以通过webshell执行任意命令，从而完全控制目标服务器。

**项目地址:** [z3usx01/CVE-2024-8232](https://github.com/z3usx01/CVE-2024-8232)

**漏洞详情:** [CVE-2024-8232](https://nvd.nist.gov/vuln/detail/CVE-2024-8232)