## CVE-2014-6271 - ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程命令执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统运行Bash且存在可利用的入口点，例如CGI脚本、OpenSSH ForceCommand等。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的远程命令执行漏洞。该漏洞允许攻击者通过构造包含恶意代码的环境变量来执行任意命令。漏洞利用的核心在于Bash在处理函数定义后附加的字符串时存在缺陷。 

**有效性评估：**
提供的Python POC代码利用了ShellShock漏洞，其有效性较高。代码首先通过发送包含特定字符串（`HelloKittyFromN0rdeN!`）的请求头来检测目标系统是否存在漏洞。如果检测到漏洞，则进入交互式shell，允许攻击者执行任意命令。

**利用方式分析：**
1.  **漏洞检测：** POC首先发送一个HTTP请求，其中User-Agent、Referer和Cookie头都包含恶意的Bash代码。这段代码的目的是在受影响的Bash版本中执行`echo HelloKittyFromN0rdeN!`命令，从而验证漏洞是否存在。
2.  **命令执行：** 如果漏洞存在，POC会进入一个循环，允许攻击者输入命令。输入的命令会被Base64编码，然后插入到HTTP请求头中。服务器端的Bash会解码并执行这些命令。
3.  **向量：** 此POC利用HTTP请求头（User-Agent, Referer, Cookie）作为攻击向量，这些头通常会被传递给服务器并可能被Bash处理。

**投毒风险分析：**
POC代码主要功能是检测和利用ShellShock漏洞。分析代码后，发现潜在的投毒风险较低（约1%）。

*   **Base64编码：** 使用Base64编码命令可能会被认为是一种混淆手段，但这是为了确保命令在HTTP头中传输的安全性，并非恶意隐藏代码。
*   **第三方库：** POC使用了requests库，理论上存在requests库被篡改的风险。但是，requests是常用的Python库，被篡改的可能性极低。
*   **BASE64_PATH变量:** 该变量用于指定`base64`命令的路径,如果该路径被修改为恶意程序,会存在投毒风险,但原代码中该变量默认为`/usr/bin/base64`,属于正常路径. 
*   **风险点：** 主要风险集中在使用未经授权的服务器上执行任意命令，这本身就是漏洞利用的目的，而不是POC代码引入的额外风险。

**搜索引擎结果印证：**
搜索结果确认了CVE-2014-6271是ShellShock漏洞，并且是广泛存在的，有多种利用方式。这些结果也强调了该漏洞的严重性和潜在影响。

综上所述，该POC代码的有效性较高，投毒风险较低，主要用于检测和利用ShellShock漏洞，允许攻击者通过HTTP请求头在目标系统上执行任意命令。

**项目地址:** [rsherstnev/CVE-2014-6271](https://github.com/rsherstnev/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)