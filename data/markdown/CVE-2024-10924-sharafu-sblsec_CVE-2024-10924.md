## CVE-2024-10924 - Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (WordPress插件)

**危害等级:** 严重，允许未经验证的攻击者以任何现有用户（包括管理员）的身份登录。

**影响版本:** 9.0.0 到 9.1.1.1

**利用条件:** 目标网站必须安装了受影响版本的 Really Simple Security 插件，并且启用了双因素身份验证功能（即使默认禁用，但如果启用则受影响）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924 存在于 Really Simple Security 插件的 9.0.0 到 9.1.1.1 版本中。该漏洞是由于在双因素 REST API 操作中的 'check_login_and_get_user' 函数中存在不正确的用户检查错误处理导致的。攻击者可以通过向 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送特制的 JSON 数据包，绕过双因素身份验证。PoC 代码利用了这一点，允许攻击者使用任意用户 ID 伪造登录请求，从而获得未经授权的访问权限。PoC 代码中通过发送包含 `invalid_nonce`的 JSON 数据绕过验证。利用方式包括:

1.  **确定目标网站是否使用受影响版本的 Really Simple Security 插件。**
2.  **获取目标用户 ID。** 可以尝试枚举用户ID, 或者从公开信息中获取
3.  **构造包含目标用户 ID 和 `invalid_nonce` 的 JSON 数据包。**
4.  **向 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送 POST 请求。**
5.  **如果成功，服务器将返回包含身份验证 cookie 的响应，攻击者可以使用该 cookie 登录到目标帐户。**

**投毒风险分析：**

虽然该代码看起来相对简单，并且直接实现了 CVE-2024-10924 的 PoC，但仍存在轻微的投毒风险。风险主要在于：

*   **恶意重定向：** PoC 代码中包含一个重定向参数 `redirect_to`，该参数设置为 `/wp-admin/`。 攻击者可能修改这个参数，将其指向恶意网站，从而诱骗用户访问恶意链接。虽然PoC 本身不是后门，但可能被滥用于钓鱼攻击。
*  **依赖外部库：** PoC依赖`libcurl`库，如果用户通过不安全的源安装libcurl，可能会引入恶意代码。虽然这并非直接投毒，但增加了攻击面。
* **作者安全性未知：** 代码作者`siberian lostsec`的安全性是未知的. 代码存在被作者植入后门的风险。

综合以上几点，判断存在 10% 的投毒风险。主要考虑点是用户可能会无意中点击攻击者构建的恶意链接，或者系统上的curl库本身存在安全问题。

**项目地址:** [sharafu-sblsec/CVE-2024-10924](https://github.com/sharafu-sblsec/CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)