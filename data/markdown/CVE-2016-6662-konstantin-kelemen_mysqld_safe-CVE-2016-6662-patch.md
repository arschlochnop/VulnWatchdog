## CVE-2016-6662 - MySQL/MariaDB/PerconaDB 权限提升/远程代码执行

**漏洞编号:** CVE-2016-6662

**漏洞类型:** 权限提升/远程代码执行

**影响应用:** MySQL, MariaDB, PerconaDB

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** MySQL: <= 5.5.52, 5.6.x <= 5.6.33, 5.7.x <= 5.7.15; MariaDB: < 5.5.51, 10.0.x < 10.0.27, 10.1.x < 10.1.17; Percona Server: < 5.5.51-38.1, 5.6.x < 5.6.32-78.0, 5.7.x < 5.7.14-7

**利用条件:** 本地用户权限或SQL注入漏洞

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2016-6662 允许本地用户通过设置 general_log_file 为 my.cnf 配置文件来创建任意配置并绕过某些保护机制。这可以被利用来通过设置 malloc_lib 以 root 权限执行任意代码。根据搜索结果，这是一个严重的安全漏洞，影响多个 MySQL 及其分支版本。利用方式通常涉及修改MySQL的配置文件，将 general_log_file 指向攻击者可控的文件，并在其中写入恶意配置，例如加载恶意动态链接库以执行任意代码。提供的Playbook 旨在通过添加安全检查来修补 `mysqld_safe` 脚本，防止从非标准系统目录加载 `ld_preload` 库。因此，此 Playbook 实际上是一个补丁，并非漏洞利用代码。Playbook 代码本身旨在修复漏洞，未发现隐藏的恶意代码，因此投毒风险为0%。根据漏洞信息和搜索结果，此漏洞影响广泛，需要尽快修复。

**项目地址:** [konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch](https://github.com/konstantin-kelemen/mysqld_safe-CVE-2016-6662-patch)

**漏洞详情:** [CVE-2016-6662](https://nvd.nist.gov/vuln/detail/CVE-2016-6662)