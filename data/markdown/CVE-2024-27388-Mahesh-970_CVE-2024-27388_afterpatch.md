## CVE-2024-27388 - SUNRPC GSSAPI内存泄漏

**漏洞编号:** CVE-2024-27388

**漏洞类型:** 内存泄漏

**影响应用:** Linux Kernel (SUNRPC)

**危害等级:** 中危，可能导致资源耗尽和拒绝服务

**影响版本:** Linux kernel versions 3.10 and later, before fixes addressing this issue

**利用条件:** 需要能够触发SUNRPC GSSAPI代码路径。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27388 描述的是 Linux 内核 SUNRPC 组件中 `gssx_dec_option_array` 函数的一个内存泄漏问题。当解析 GSSAPI 选项数组时，如果出现错误，某些已分配的内存（`creds` 和 `oa->data`）可能不会被正确释放，导致内存泄漏。根据漏洞库信息和搜索引擎结果，该漏洞本身是一个内存泄漏，可能导致系统性能下降甚至拒绝服务。 

**有效性：**

提供的“漏洞利用代码”实际上是修复该漏洞的补丁前的代码片段。因此，这段代码**并非**漏洞利用代码，而是存在漏洞的代码。要利用该漏洞，需要构造恶意的 GSSAPI 请求，触发 `gssx_dec_option_array` 函数中的错误处理路径，并且确保在该路径下内存没有被正确释放。从`gssx_dec_option_array` 代码可以看出，如果 `xdr_inline_decode` 返回错误，或者在处理Linux creds时发生错误，内存可能会泄漏。

**投毒风险：**

提供的代码片段本身不太可能存在投毒代码。因为它只是漏洞存在处的原始代码，目的是展示漏洞的根源。不过，在真实的利用场景中，攻击者可能会通过发送特制的RPC请求来触发漏洞，而这个请求本身可以被视为“投毒”，因为它可能导致目标系统资源耗尽。这里评估存在极低的投毒风险(5%)，因为更多的是触发漏洞利用，而不是隐藏恶意代码。

**利用方式：**

1.  **触发漏洞：** 攻击者需要能够发送 SUNRPC 请求，并触发 GSSAPI 身份验证流程。攻击者需要精心构造 RPC 请求中的 GSSAPI 选项数组，使其在 `gssx_dec_option_array` 函数解析过程中，满足导致内存泄漏的错误条件。
2.  **资源耗尽：** 通过重复发送恶意构造的请求，持续触发内存泄漏，最终导致系统内存耗尽。
3.  **拒绝服务：** 当系统内存耗尽时，可能导致系统崩溃或无法响应正常请求，从而实现拒绝服务攻击。

**项目地址:** [Mahesh-970/CVE-2024-27388_afterpatch](https://github.com/Mahesh-970/CVE-2024-27388_afterpatch)

**漏洞详情:** [CVE-2024-27388](https://nvd.nist.gov/vuln/detail/CVE-2024-27388)