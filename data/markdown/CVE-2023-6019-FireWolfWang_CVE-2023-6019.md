## CVE-2023-6019 - Ray OS Command Injection

**漏洞编号:** CVE-2023-6019

**漏洞类型:** OS Command Injection

**影响应用:** ray-project/ray

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.8.0 (推测，漏洞库信息显示已修复版本为2.8.1+)

**利用条件:** Ray dashboard需要开启且目标系统存在漏洞，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-6019是Ray框架中的一个操作系统命令注入漏洞，存在于Ray dashboard的cpu_profile URL参数中。由于Ray dashboard对cpu_profile参数处理不当，攻击者可以通过构造恶意的URL，将操作系统命令注入到后台执行，从而实现远程代码执行。漏洞利用代码显示，它将base64编码的payload注入到`format`参数中。Payload是一个反弹shell，会连接到攻击者指定的lhost和lport。该漏洞无需身份验证即可利用。检查投毒风险：虽然代码功能上是实现了漏洞利用，但考虑到该POC需要用户指定反弹shell的IP地址和端口，且利用的是公开的漏洞信息，可以判定投毒的可能性较低。投毒风险分析: 主要风险可能在于Payload部分被替换为恶意指令，但由于payload base64 编码，容易被发现。漏洞利用方式：攻击者构造包含恶意命令的URL，发送到存在漏洞的Ray dashboard。服务端未对URL中的cpu_profile参数进行充分验证，导致恶意命令被执行，攻击者获取目标系统的shell。

**有效性：**  根据漏洞库信息、搜索引擎结果（假设有更多细节）和提供的漏洞利用代码，该漏洞的POC代码是有效的。

**投毒风险：**  POC代码的投毒风险评估为10%。虽然主要功能是漏洞利用，但是payload存在可替换为恶意指令的风险。

**利用方式：** 攻击者通过构造恶意的`cpu_profile` URL参数，在目标系统上执行任意OS命令。该URL包含了经过Base64编码的反弹shell payload。如果目标机器配置了免密sudo，攻击者可以获得root权限的shell。否则，攻击者可以获得当前用户的shell。

**项目地址:** [FireWolfWang/CVE-2023-6019](https://github.com/FireWolfWang/CVE-2023-6019)

**漏洞详情:** [CVE-2023-6019](https://nvd.nist.gov/vuln/detail/CVE-2023-6019)