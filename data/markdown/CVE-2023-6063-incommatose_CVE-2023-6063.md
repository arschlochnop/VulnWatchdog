## CVE-2023-6063-WP Fastest Cache-SQL注入

**漏洞编号:** CVE-2023-6063

**漏洞类型:** SQL注入

**影响应用:** WP Fastest Cache

**危害等级:** 高危，可能导致数据泄露

**影响版本:** < 1.2.2

**利用条件:** 目标 WordPress 站点安装了受影响版本的 WP Fastest Cache 插件，且攻击者可以发送 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-6063 是一个存在于 WP Fastest Cache WordPress 插件 1.2.2 之前版本的 SQL 注入漏洞。攻击者可以通过 `wordpress_logged_in` cookie 注入恶意 SQL 语句，而无需身份验证。利用方式是使用时间盲注（Time-Based SQL Injection）来提取 `wp_users` 表中的用户密码哈希值和邮箱地址。

**有效性：**
根据漏洞信息、搜索结果和提供的 POC 代码，该漏洞是有效的。漏洞库信息明确指出该漏洞是未授权的 SQL 注入，搜索结果中也包含相关的描述和利用信息。提供的 POC 代码 `poc.py` 使用时间盲注来提取数据，表明漏洞可被利用。

**投毒风险：**
分析提供的 POC 代码 `poc.py`，未发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造 SQL 注入 payload 并利用时间延迟来判断注入是否成功，并逐步提取用户密码哈希值。代码中没有发现任何尝试修改文件系统、执行系统命令或与其他恶意服务器通信的行为。风险评估为0%

**利用方式：**
1.  **确定目标：** 找到安装了受影响版本 WP Fastest Cache 插件的 WordPress 站点。
2.  **构造 Payload：**  POC 代码通过修改 `wordpress_logged_in` cookie 的值，注入恶意的 SQL 语句。Payload 利用 `SLEEP()` 函数和条件判断，根据字符比较的结果来引入时间延迟。
3.  **发送请求：**  攻击者向目标站点发送包含恶意 `wordpress_logged_in` cookie 的 HTTP 请求。
4.  **提取数据：**  通过测量服务器响应时间，判断注入是否成功，并逐步提取 `wp_users` 表中的用户密码哈希值和邮箱地址。
5.  **破解密码：**  攻击者可以利用提取到的密码哈希值进行离线破解，从而获取用户账户的访问权限。

**项目地址:** [incommatose/CVE-2023-6063](https://github.com/incommatose/CVE-2023-6063)

**漏洞详情:** [CVE-2023-6063](https://nvd.nist.gov/vuln/detail/CVE-2023-6063)