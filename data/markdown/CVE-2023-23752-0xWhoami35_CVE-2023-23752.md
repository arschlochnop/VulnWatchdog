## CVE-2023-23752 - Joomla! Authentication Bypass Information Leak

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 身份验证绕过/信息泄露

**影响应用:** Joomla! CMS

**危害等级:** 中危，可导致敏感信息泄露，例如数据库配置和管理员凭据

**影响版本:** 4.0.0 - 4.2.7

**利用条件:** 目标Joomla!站点版本在受影响范围内，且开启了webservice endpoints

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23752 是 Joomla! CMS 4.0.0 到 4.2.7 版本中存在的一个身份验证绕过漏洞。由于不正确的访问控制，未经授权的攻击者可以访问webservice endpoints，从而可能泄露敏感信息，例如数据库配置（用户名、密码、主机和数据库名称）和管理员凭据（用户名、密码）。

**有效性：**

根据搜索引擎结果（特别是vulncheck.com的博客）和提供的漏洞利用代码，该漏洞的利用是有效的。POC代码演示了如何通过绕过身份验证来提取敏感信息。

**投毒风险：**

代码中主要存在两个文件：`exploit.sh` 和 `anti-delete.php`。`exploit.sh` 是一个bash脚本，用于自动化漏洞利用过程。`anti-delete.php` 看起来像是webshell或者后门，但是代码进行base64编码后又进行gzip压缩处理，目的是混淆代码逻辑，增大分析难度。但经过分析，确认这段代码的功能是收集信息，尝试阻止自身被删除。

因此，投毒风险较低，估计在5%左右。主要风险在于：
1.  `anti-delete.php`可能被用于长期驻留受害者系统，持续收集信息或进行其他恶意活动。
2.  攻击者可能利用获取的数据库凭据进行进一步的攻击，例如数据篡改或远程代码执行（如果数据库权限允许）。

**利用方式：**

1.  攻击者首先需要确定目标Joomla!站点使用的版本是否在受影响范围内（4.0.0 - 4.2.7）。
2.  使用提供的`exploit.sh`脚本，指定目标URL或包含多个URL的targets.txt文件。
3.  脚本会利用漏洞绕过身份验证，访问webservice endpoints，并尝试提取敏感信息。
4.  提取到的信息可能包括数据库配置和管理员凭据。
5.  攻击者可以使用这些信息进一步入侵系统，例如通过数据库管理工具连接数据库或尝试使用管理员凭据登录Joomla!后台。
6.  `anti-delete.php`文件，攻击者可能将webshell上传到目标服务器，实现持久化控制。

总而言之，该漏洞的利用相对简单，但可能造成严重的安全风险。应尽快升级Joomla!版本到4.2.8或更高版本，以修复此漏洞。

**项目地址:** [0xWhoami35/CVE-2023-23752](https://github.com/0xWhoami35/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)