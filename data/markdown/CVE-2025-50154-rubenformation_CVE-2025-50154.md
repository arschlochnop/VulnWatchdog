## CVE-2025-50154 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-50154

**漏洞类型:** NTLMv2-SSP Hash Disclosure

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户访问攻击者控制的SMB共享

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索引擎结果，CVE-2025-50154 描述的是一个 Windows 文件资源管理器欺骗漏洞，该漏洞允许未经授权的攻击者通过网络执行欺骗，泄露敏感信息，如 NTLM hash。PoC 代码通过创建一个指向远程 SMB 共享上的可执行文件的 LNK 文件来利用此漏洞。当 Explorer.exe 尝试提取远程可执行文件的图标时，会触发 NTLM 身份验证，从而将 NTLMv2-SSP 哈希发送到攻击者的 SMB 服务器。

**有效性：**

PoC 代码似乎有效，因为它利用了 Windows Explorer 提取远程可执行文件图标的机制来触发 NTLM 身份验证。搜索引擎结果也证实了该漏洞的存在，并提及了绕过补丁的情况。

**投毒风险：**

查看提供的PoC代码 `poc.ps1` 和相关说明文件，该仓库代码用于生成恶意的LNK文件，目的是触发NTLM认证，不存在隐藏的恶意代码或后门。该脚本的主要功能是创建快捷方式文件（.lnk）它指定目标路径(远程SMB共享)和图标位置(shell32.dll)。该存储库提供的信息更像是安全研究和概念验证，而不是用于恶意目的的工具。该代码的目的明确，并且提供的详细信息（如博客文章链接）有助于透明地使用该工具。 因此，该存储库中存在投毒代码的可能性非常低。

**利用方式：**

1.  攻击者搭建一个 SMB 服务器。
2.  攻击者在 SMB 服务器上放置一个任意的可执行文件。
3.  攻击者使用 PoC 代码 `poc.ps1` 创建一个恶意的 LNK 文件，该 LNK 文件的目标指向攻击者控制的 SMB 服务器上的可执行文件。
4.  攻击者诱骗受害者访问包含该 LNK 文件的目录。
5.  当受害者的 Windows Explorer 显示该目录时，会自动尝试提取 LNK 文件指向的远程可执行文件的图标，从而触发 NTLM 身份验证。
6.  攻击者使用 Responder 之类的工具捕获 NTLMv2-SSP 哈希。
7.  攻击者可以使用捕获的哈希进行离线破解或传递哈希攻击。

**项目地址:** [rubenformation/CVE-2025-50154](https://github.com/rubenformation/CVE-2025-50154)

**漏洞详情:** [CVE-2025-50154](https://nvd.nist.gov/vuln/detail/CVE-2025-50154)