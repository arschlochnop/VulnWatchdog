## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程代码执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** <= 4.3

**利用条件:** 目标系统使用Bash，并且攻击者能够控制环境变量。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-6271，也被称为Shellshock，是一个存在于GNU Bash中的严重漏洞。该漏洞源于Bash处理环境变量中函数定义之后存在的字符串的方式。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被Bash解析时，就能执行任意命令。

**有效性：**

根据漏洞库信息和搜索结果，CVE-2014-6271是一个经过验证的漏洞，具有较高的利用成功率。

提供的Dockerfile和相关文件构成了一个可以利用该漏洞的环境。Dockerfile设置了一个基于Debian Wheezy的Apache服务器，并部署了一个CGI脚本（vulnerable），该脚本会调用Bash。攻击者可以通过设置恶意的环境变量，然后向CGI脚本发送HTTP请求来触发漏洞，从而在服务器上执行任意命令。

**投毒风险：**

分析提供的文件，存在一定的投毒风险，约为10%。Dockerfile中从/packages安装了预先存在的软件包。虽然COPY指令本身没有明显的恶意代码，但有需要审核的地方：
1. Dockerfile 从 `/packages` 目录安装软件包，而软件包的具体内容没有给出。如果这些包由攻击者控制，可能包含恶意后门。
2. `vulnerable` CGI 脚本的内容需要仔细审查，如果脚本本身存在后门，则存在投毒风险
3. main.sh 的内容也需要确认, 是否有安装一些额外的包.

**利用方式：**

1.  **CGI脚本利用：**  最常见的利用方式是通过CGI脚本。攻击者向Web服务器发送包含恶意环境变量的HTTP请求。如果Web服务器配置为使用Bash执行CGI脚本，Bash将解析这些环境变量，导致恶意代码执行。
2.  **OpenSSH ForceCommand：**  如果OpenSSH配置了ForceCommand选项，攻击者可以通过修改环境变量来执行任意命令。
3.  **DHCP客户端：**  某些DHCP客户端在执行脚本时会设置环境变量，攻击者可以通过控制DHCP服务器来注入恶意环境变量。

总之，CVE-2014-6271是一个高危漏洞，利用简单，影响广泛。需要及时修补受影响的系统。


**项目地址:** [opsxcq/exploit-CVE-2014-6271](https://github.com/opsxcq/exploit-CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)