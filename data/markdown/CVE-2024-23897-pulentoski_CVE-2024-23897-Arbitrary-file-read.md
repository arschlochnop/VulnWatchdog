## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，权限提升

**影响版本:** 2.441 及更早版本，LTS 2.426.2 及更早版本（不包括修复版本）

**利用条件:** 需要网络访问Jenkins实例

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。漏洞原因是 Jenkins CLI 命令解析器的一个功能，它会将参数中以'@'字符开头的路径替换为文件内容。攻击者可以利用 `connect-node` 命令结合 `@` 符号读取任意文件，例如，`connect-node @/etc/passwd`。

**有效性：**
提供的PoC代码（CVE-2024-23897-A-scaner.py 和 CVE-2024-23897-B-DOCKER-scaner.py）利用了该漏洞，通过 `jenkins-cli.jar` 工具，使用 `connect-node` 命令读取目标文件，因此是有效的。

**投毒风险：**
代码本身主要功能是读取文件，但在用户输入 Jenkins URL 时存在潜在的风险，攻击者可能诱导用户输入恶意 URL，例如指向包含恶意代码的 jar 文件。代码中`/var/lib/jenkins/` to `/var/jenkins_home/`的替换，用于兼容Docker环境，不是恶意行为。
下载jenkins-cli.jar时，如果jenkins服务器被攻陷，返回恶意的jar文件，也可能存在投毒风险。因此，投毒风险较低，估计为5%。

**利用方式：**
1.  获取目标 Jenkins 实例的 URL。
2.  下载 `jenkins-cli.jar` （PoC 脚本提供了下载功能）。
3.  使用 `java -jar jenkins-cli.jar -s <jenkins_url> connect-node @<file_path>` 命令读取目标文件。例如，`java -jar jenkins-cli.jar -s http://example.com:8080 connect-node @/etc/passwd`。
4.  PoC 脚本自动化了以上步骤，提供了一个菜单，允许用户选择读取不同的文件，包括 `/etc/passwd`、`/etc/os-release`、`id_rsa` 等，以及 Jenkins 的配置文件和用户数据。

**项目地址:** [pulentoski/CVE-2024-23897-Arbitrary-file-read](https://github.com/pulentoski/CVE-2024-23897-Arbitrary-file-read)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)