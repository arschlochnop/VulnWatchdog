## CVE-2025-27591-Below-本地提权

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地提权

**影响应用:** Below

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** < 0.9.0

**利用条件:** 目标系统运行Below服务，且版本低于0.9.0

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-27591 是一个在 Below 服务 0.9.0 版本之前存在的本地提权漏洞。该漏洞的根源在于 Below 服务创建了一个全局可写的目录 /var/log/below。攻击者可以利用这个漏洞，通过符号链接攻击来修改敏感文件，例如 /etc/passwd，从而提升权限。

**漏洞利用方式：**

1.  **创建恶意密码文件：** PoC脚本首先创建一个包含恶意密码条目的文件 /tmp/evilpasswd。这个文件包含一个名为“evil”的用户，其UID和GID都为0，这意味着它本质上是一个root用户。
2.  **删除现有日志文件并创建符号链接：** PoC脚本删除了以当前用户名开头的 /var/log/below 目录下的 error 日志文件。然后，它创建一个从 /var/log/below/error_$user.log 到 /etc/passwd 的符号链接。这使得对日志文件的写入操作实际上是对 /etc/passwd 文件的写入操作。
3.  **覆盖/etc/passwd文件：** PoC脚本将 /tmp/evilpasswd 的内容重定向到 /var/log/below/error_$user.log，从而覆盖了 /etc/passwd 文件。这会将恶意用户条目添加到 /etc/passwd 文件中。
4.  **触发Below服务操作：** PoC脚本使用 `sudo /usr/bin/below snapshot --begin now 2>/dev/null` 命令触发 Below 服务，使其执行某些操作并将日志写入先前创建的符号链接（指向/etc/passwd）。即使命令输出被重定向到 /dev/null，服务仍可能尝试写入日志。
5.  **切换到恶意用户：** PoC脚本尝试使用 `su evil` 命令切换到新创建的恶意用户。由于 /etc/passwd 文件已被修改，系统现在允许切换到 evil 用户，该用户实际上具有 root 权限。

**有效性：**

根据漏洞描述和PoC代码，该漏洞利用方法是有效的。该PoC代码演示了如何利用全局可写的日志目录和符号链接攻击来修改 /etc/passwd 文件，从而创建一个具有 root 权限的恶意用户。

**投毒风险：**

PoC 代码相对简单，主要是创建符号链接并覆盖 `/etc/passwd`。潜在的投毒风险可能存在于：

*   **恶意程序下载：** 脚本可能包含下载和执行其他恶意程序的代码。但该脚本没有。
*   **环境变量篡改：** 脚本可能尝试修改环境变量以影响系统行为。但该脚本没有。
*   **后门植入：** 脚本可能会尝试植入更隐蔽的后门，例如通过修改其他系统文件或服务配置。但该脚本没有。

尽管存在上述潜在风险，但提供的 PoC 代码相对直接，没有明显的恶意行为。风险评估为 10%。

**项目地址:** [incommatose/CVE-2025-27591-PoC](https://github.com/incommatose/CVE-2025-27591-PoC)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)