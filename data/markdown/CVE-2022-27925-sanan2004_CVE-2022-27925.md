## CVE-2022-27925 Zimbra Collaboration Suite 路径遍历漏洞

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 Patch 30 (及更早版本), 9.0.0 Patch 23 (及更早版本)

**利用条件:** 需要目标系统存在漏洞版本，以及攻击者可以通过网络访问到zimbra的7071端口（默认情况下）。如果利用 CVE-2022-37042 绕过认证，则不需要管理员权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-27925是一个Zimbra Collaboration Suite (ZCS)中的路径遍历漏洞。ZCS的mboximport功能接收ZIP存档并从中提取文件。利用该漏洞，经过身份验证（最初被认为是需要管理员权限，但后来发现存在认证绕过漏洞CVE-2022-37042）的用户可以将任意文件上传到系统，从而导致目录遍历。该POC利用了这一漏洞，通过构造恶意的ZIP文件，将webshell上传到zimbraAdmin目录，从而实现远程代码执行。

**利用方式:**
1.  攻击者首先需要确定目标Zimbra服务器的版本是否在受影响的范围内。
2.  如果目标存在CVE-2022-37042认证绕过漏洞，攻击者可以匿名访问管理员端口7071进行攻击；否则需要具备管理员权限。
3.  攻击者使用POC脚本，指定目标URL。
4.  POC脚本会创建一个包含恶意路径的ZIP文件，该ZIP文件中的文件会被解压到指定目录(例如：../../../../mailboxd/webapps/zimbraAdmin/)，从而写入webshell。
5.  POC脚本会尝试访问上传的webshell，如果成功，则表明漏洞利用成功，并返回webshell的URL和执行uname -a命令的结果。

**有效性:**
根据漏洞信息、搜索结果和漏洞利用代码，提供的POC代码是有效的。搜索结果中提到了该漏洞被大规模利用，并存在公开的POC。

**投毒风险:**
POC代码相对简单，主要功能是生成包含恶意路径的ZIP文件并上传webshell。可能的投毒风险在于：
1.  webshell的内容可能被修改为包含恶意代码，例如下载并执行其他恶意程序。这种可能性很低，因为提供的代码片段明确提到了上传webshell的位置，如果webshell的内容与预期不符，攻击者很容易发现。
2.  脚本可能在上传webshell之后执行其他操作，例如修改系统配置或安装后门。虽然当前的代码片段没有显示这些行为，但不能完全排除。

综合考虑，该POC存在少量投毒风险，可能性约为10%。需要仔细检查POC脚本的完整代码，特别是webshell的内容和后续操作，以确保其安全性。

**项目地址:** [sanan2004/CVE-2022-27925](https://github.com/sanan2004/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)