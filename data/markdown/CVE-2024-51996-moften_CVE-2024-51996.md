## CVE-2024-51996-Symfony RememberMe 认证绕过

**漏洞编号:** CVE-2024-51996

**漏洞类型:** 认证绕过

**影响应用:** Symfony

**危害等级:** 高危，可能导致未经授权的访问和权限提升

**影响版本:** >= 5.3.0, < 5.4.47; >= 6.0.0-BETA1, < 6.4.15; >= 7.0.0-BETA1, < 7.1.8

**利用条件:** 需要目标系统启用RememberMe功能，并且攻击者需要拥有一个有效的RememberMe cookie

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-51996 是 Symfony 框架中 security-http 组件的一个认证绕过漏洞。该漏洞存在于 "Remember Me" 认证机制中。当 Symfony 处理持久化的 remember-me cookie 时，它不会检查数据库中持久化的用户名是否与 cookie 中附加的用户名匹配，导致认证绕过。

**有效性：**
根据漏洞描述和POC代码，提供的POC代码是有效的。攻击者可以通过修改REMEMBERME cookie中的用户名，冒充其他用户登录系统。

**投毒风险：**
查看提供的代码，python脚本本身并无明显的恶意代码，仅仅是一个利用漏洞的脚本。在README.md文件中，是对漏洞的描述。因此，可以认为投毒风险较低。这里给出的投毒风险评估为 10%， 因为作者可能在脚本中设置后门，这里保留小部分可能性。

**利用方式：**
1.  **前提条件：** 目标系统启用RememberMe功能，攻击者需要拥有一个合法用户的REMEMBERME cookie。
2.  **获取Cookie：** 攻击者首先需要获得一个已经登录用户的有效“REMEMBERME” cookie。可以通过多种方式获取，例如窃取网络流量，或者通过其他漏洞获取。
3.  **修改Cookie：** 攻击者将获得的REMEMBERME cookie中的用户名修改为目标用户的用户名，例如“admin”。
4.  **发送请求：** 攻击者将修改后的REMEMBERME cookie发送给目标系统。
5.  **绕过认证：** 由于Symfony没有正确验证cookie中的用户名和数据库中存储的用户名是否匹配，攻击者可以成功绕过认证，以目标用户的身份登录系统。
6.  **权限提升：** 如果目标用户具有管理员权限，攻击者将获得管理员权限。

**项目地址:** [moften/CVE-2024-51996](https://github.com/moften/CVE-2024-51996)

**漏洞详情:** [CVE-2024-51996](https://nvd.nist.gov/vuln/detail/CVE-2024-51996)