## CVE-2024-47575-FortiManager-未授权命令执行

**漏洞编号:** CVE-2024-47575

**漏洞类型:** 未授权命令执行

**影响应用:** FortiManager

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 7.6.0, 7.4.0-7.4.4, 7.2.0-7.2.7, 7.0.0-7.0.12, 6.4.0-6.4.14, 6.2.0-6.2.12, FortiManager Cloud 7.4.1-7.4.4, FortiManager Cloud 7.2.1-7.2.7, FortiManager Cloud 7.0.1-7.0.12, FortiManager Cloud 6.4.1-6.4.7

**利用条件:** FortiManager实例暴露在网络上，特别是541端口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-47575是FortiManager中的一个关键漏洞，由于fgfmsd守护进程缺少身份验证，未经身份验证的远程攻击者可以通过特制的请求执行任意代码或命令，从而完全控制系统。该漏洞的CVSS v3评分为9.8，属于严重级别。漏洞利用也被称为“FortiJump”。

**有效性：**
根据漏洞信息、搜索结果（例如Rapid7的博客）以及CISA的已知被利用漏洞目录 (KEV)，此漏洞已被积极利用，因此可以判断漏洞利用代码具有高度有效性。

**投毒风险：**
提供的漏洞利用代码(`/tmp/8074d255b753edbc832d97e62d1143d0/ioc_ip.txt`)包含一组IP地址。这些IP地址可能被用作攻击基础设施的一部分，或者它们可能是目标系统的IP地址，用于验证漏洞利用或进行其他恶意活动。但仅凭这些IP地址无法确定是否存在投毒代码，因此判断投毒风险为0%。这些IP地址可能来源于历史攻击事件的IOC (Indicators of Compromise)，用于威胁情报分析。

**利用方式：**
1.  **目标确定：** 确定暴露在网络上且运行受影响FortiManager版本的实例，特别是监听541端口的实例。
2.  **未授权访问：** 利用缺少身份验证的漏洞，绕过正常的身份验证机制。
3.  **命令执行：** 通过构造特制的请求，向目标系统发送恶意命令。
4.  **系统控制：** 成功执行命令后，攻击者可以获得对FortiManager系统的完全控制权，可以执行任意操作，包括但不限于数据窃取、配置更改、植入后门等。
5.  **IP地址利用：** 提供的IP地址可能用于建立初始连接，或者用作控制受感染系统的C&C服务器。

需要注意的是，搜索引擎结果显示漏洞被称为“FortiJump”，这暗示了其利用可能涉及跳过某些安全检查或身份验证过程。

**项目地址:** [krmxd/CVE-2024-47575](https://github.com/krmxd/CVE-2024-47575)

**漏洞详情:** [CVE-2024-47575](https://nvd.nist.gov/vuln/detail/CVE-2024-47575)