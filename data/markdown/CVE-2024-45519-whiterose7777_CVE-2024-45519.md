## CVE-2024-45519 Zimbra Collaboration OS Command Injection

**漏洞编号:** CVE-2024-45519

**漏洞类型:** OS Command Injection

**影响应用:** Zimbra Collaboration (ZCS)

**危害等级:** Critical，允许未经身份验证的用户执行任意命令，可能导致完全控制受影响的系统。

**影响版本:** ZCS before 8.8.15 Patch 46, 9 before 9.0.0 Patch 41, 10 before 10.0.9, and 10.1 before 10.1.1

**利用条件:** 目标Zimbra服务器需要开启25端口(SMTP)，且存在漏洞。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务中的一个 OS 命令注入漏洞。该漏洞允许未经身份验证的攻击者通过特制的 SMTP 请求执行任意命令。根据搜索引擎结果，该漏洞正在被积极利用。

**有效性：**

提供的 POC 代码通过 SMTP 协议发送特制的 `RCPT TO` 命令来实现命令注入。代码首先检查目标主机的 25 端口是否开放，然后尝试通过 `curl` 命令检查漏洞，最后尝试利用漏洞执行反向shell。从漏洞描述和搜索结果来看，该POC是有效的。

**投毒风险：**

检查提供的 POC 代码 `CVE-2024-45519-Poc.py` 和 `README.md`，没有发现作者隐藏的恶意代码。所有的代码都旨在验证和利用漏洞，并没有发现任何额外的、非预期的行为。因此，投毒风险评估为 0%。

**利用方式：**

1.  **端口扫描：** 首先确定目标 Zimbra 服务器的 25 端口（SMTP）是否开放。
2.  **漏洞验证：** 使用特制的 SMTP 请求，在 `RCPT TO` 命令中注入恶意命令。POC代码中使用`curl`命令来访问OAST服务器，以检测漏洞的存在。如果OAST服务器收到请求，则表明存在漏洞。
3.  **漏洞利用：** 如果漏洞存在，可以进一步构造 `RCPT TO` 命令，注入反向 shell 命令。攻击者可以通过反向 shell 连接到目标系统，从而获得对服务器的控制权。

总的来说，该漏洞的利用方式相对直接，利用难度不高，但危害性极大，允许未经授权的远程代码执行。

**项目地址:** [whiterose7777/CVE-2024-45519](https://github.com/whiterose7777/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)