## CVE-2023-5360 - Royal Elementor Addons and Templates - 任意文件上传

**漏洞编号:** CVE-2023-5360

**漏洞类型:** 任意文件上传

**影响应用:** Royal Elementor Addons and Templates

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.3.79

**利用条件:** WordPress 站点安装了受影响的 Royal Elementor Addons and Templates 插件，且漏洞未修复。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

根据漏洞信息和搜索结果，Royal Elementor Addons and Templates 插件存在一个未经身份验证的任意文件上传漏洞。未经身份验证的用户可以通过上传恶意文件（例如 PHP 文件）来执行远程代码。

**有效性：**
提供的漏洞利用代码 `exploit.py` 包含大量混淆代码。它首先检查 `pycryptodome` 模块是否安装，并声明仅适用于 v3.11 以上版本。 该脚本看起来严重混淆，使用了 `pyobfuscate` ,`base64` ,`codecs`, `zlib` 等库对代码进行多层混淆。解混淆后，预计会执行文件上传操作，上传包含恶意代码的 webshell。

**投毒风险：**
该代码经过了高度混淆，难以直接判断其功能，但是从大量混淆的代码中和访问phankz.com网址 可以初步判定投毒风险非常高，利用价值低。

**利用方式：**
1.  攻击者利用未经身份验证的漏洞，向 WordPress 站点上传包含恶意代码的 PHP 文件 (webshell)。
2.  服务器未正确验证上传的文件类型，允许上传 PHP 文件。
3.  攻击者通过 Web 浏览器访问上传的 PHP 文件。
4.  恶意 PHP 代码在服务器上执行，从而实现远程代码执行。

**项目地址:** [phankz/Worpress-CVE-2023-5360](https://github.com/phankz/Worpress-CVE-2023-5360)

**漏洞详情:** [CVE-2023-5360](https://nvd.nist.gov/vuln/detail/CVE-2023-5360)