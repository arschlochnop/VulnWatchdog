## CVE-2025-24813

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行或信息泄露

**影响版本:** Apache Tomcat 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要开启Default Servlet的写入功能，允许Partial PUT，并且满足特定的目录结构或使用Tomcat的文件Session持久化机制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞。如果满足以下条件，攻击者可以进行远程代码执行或泄露敏感信息:

1.  **信息泄露/恶意内容注入:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   存在安全敏感文件上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
    *   攻击者知道要上传的安全敏感文件的名称。
    *   安全敏感文件通过 Partial PUT 上传。

2.  **远程代码执行:**
    *   Default Servlet 的写入功能已启用（默认禁用）。
    *   支持 Partial PUT（默认启用）。
    *   应用程序使用 Tomcat 的基于文件的 Session 持久化，使用默认存储位置。
    *   应用程序包含一个可以在反序列化攻击中利用的库。

**漏洞利用方式：**

*   **信息泄露/恶意内容注入：** 攻击者可以利用路径等价漏洞，通过构造恶意请求，覆盖或读取特定的安全敏感文件。
*   **远程代码执行：** 攻击者利用 Partial PUT 功能上传恶意构造的序列化 session 文件，并结合目标应用中存在的可被利用的反序列化漏洞，最终实现远程代码执行。

**POC分析：**

提供的 Go 代码通过 PUT 方法上传 JSP webshell 到多个预定义的目录中。它首先检测目标是否是Tomcat服务器，然后尝试在不同的目录下上传 `update_log.jsp` 文件，其中包含一个简单的命令执行界面。如果上传成功，它会将 URL 写入到 `Shelled.txt` 文件中。

**投毒风险分析：**

该POC代码的主要目的是利用漏洞上传webshell，本身没有明显的投毒行为。虽然webshell本身是一种恶意代码，但是这是漏洞利用的一部分，不应被视为投毒。 风险评估为5%。

**搜索引擎结果：**

多个搜索结果表明 CVE-2025-24813 漏洞已经被积极利用，远程代码执行是主要的攻击目标。

**项目地址:** [Olabanji10/Apache-GOExploiter](https://github.com/Olabanji10/Apache-GOExploiter)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)