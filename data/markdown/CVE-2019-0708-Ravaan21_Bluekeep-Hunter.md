## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Remote Desktop Services

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Microsoft远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过RDP连接到目标系统并发送特制请求来利用此漏洞。成功利用此漏洞可能允许攻击者在目标系统上执行任意代码。

**有效性分析：**

根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判定此漏洞是真实存在的，并且存在可用的PoC代码。

搜索引擎结果提供了大量关于CVE-2019-0708的分析报告和补丁信息，例如 Unit 42 的分析（webpage 0, webpage 3）详细描述了漏洞原理和利用方式。微软官方也发布了安全公告（webpage 1）。这些信息都证实了该漏洞的真实性和严重性。

提供的漏洞利用代码（bluekeephunter.sh）是一个自动化扫描和利用BlueKeep漏洞的脚本。它使用Metasploit模块scanner/rdp/cve_2019_0708_bluekeep来检测目标系统是否存在漏洞，如果存在漏洞，则尝试利用它。脚本的基本逻辑是读取目标IP地址列表，然后针对每个IP地址运行Metasploit模块。

**投毒风险分析：**

分析提供的`bluekeephunter.sh`脚本，该脚本的主要功能是使用Metasploit的`scanner/rdp/cve_2019_0708_bluekeep`模块进行扫描和利用。代码本身逻辑比较清晰，主要就是循环读取IP地址，然后调用Metasploit模块。其中没有发现任何明显的恶意代码或后门。

因此，判断此仓库中不存在作者隐藏的投毒代码的风险为0%。

**利用方式分析：**

1.  **连接目标系统：** 攻击者首先需要能够通过RDP协议连接到目标系统。这意味着目标系统的RDP服务必须开启，并且攻击者能够访问该端口（通常是3389）。
2.  **发送特制请求：** 连接建立后，攻击者发送特制的RDP请求。这些请求旨在触发RDP服务中的漏洞，利用的是 use-after-free 漏洞。
3.  **代码执行：** 如果漏洞利用成功，攻击者可以在目标系统上执行任意代码。攻击者通常会利用此漏洞安装恶意软件、窃取敏感信息或控制整个系统。

总而言之，此漏洞的利用方式是利用RDP协议的漏洞，在未经授权的情况下在目标系统上执行代码。由于存在公开的PoC代码和Metasploit模块，该漏洞很容易被利用，因此需要及时修补。

**项目地址:** [Ravaan21/Bluekeep-Hunter](https://github.com/Ravaan21/Bluekeep-Hunter)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)