## CVE-2022-4361-Keycloak-XSS

**漏洞编号:** CVE-2022-4361

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Keycloak

**危害等级:** 高危，可能导致账户劫持、信息泄露和恶意代码执行

**影响版本:** 受影响版本 < 21.1.2

**利用条件:** 需要用户访问受攻击的Keycloak实例，并且攻击者能够控制 AssertionConsumerServiceURL 或 redirect_uri 参数。

**POC 可用性:** 是，漏洞利用代码通过修改 AssertionConsumerServiceURL 或 redirect_uri 参数来实现XSS攻击

**投毒风险:** 10%

## 详情

CVE-2022-4361是Keycloak身份认证管理系统中的一个跨站脚本漏洞，存在于SAML或OIDC提供程序中。攻击者可以通过设置恶意的AssertionConsumerServiceURL值或redirect_uri参数来执行任意JavaScript代码。漏洞利用方式为，构造包含恶意JavaScript代码的AssertionConsumerServiceURL或者redirect_uri，当用户访问受影响的Keycloak实例并触发身份验证流程时，恶意脚本将在用户浏览器中执行。提供的代码片段看起来像是项目文档，并没有漏洞利用相关的Payload，投毒风险较低，因为这些文件主要描述了如何贡献代码和项目采用者，隐藏恶意代码进行攻击的可能性较低，但仍需谨慎分析。

**项目地址:** [shoucheng3/keycloak__keycloak_CVE-2022-4361_21-1-1](https://github.com/shoucheng3/keycloak__keycloak_CVE-2022-4361_21-1-1)

**漏洞详情:** [CVE-2022-4361](https://nvd.nist.gov/vuln/detail/CVE-2022-4361)