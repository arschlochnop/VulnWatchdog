## CVE-2023-21716-Microsoft Word 远程代码执行漏洞

**漏洞编号:** CVE-2023-21716

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Word

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响版本包括Microsoft Office, SharePoint, 和 365 Apps的多个版本，具体参考CVE信息

**利用条件:** 用户需要打开或预览恶意的RTF文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-21716 是一个 Microsoft Word 远程代码执行漏洞，利用方式是通过构造恶意的RTF文件。当用户使用受影响的 Microsoft Word 版本打开或预览该文件时，可能触发漏洞，导致远程代码执行。

提供的POC代码（exploit.py）通过生成包含大量字体定义的RTF文件（exploit.rtf）来利用该漏洞。该RTF文件包含超过32000个字体定义，旨在触发wwlib.dll中的堆损坏漏洞，从而导致程序崩溃。

**有效性：**
根据提供的资料和搜索结果，该POC代码的目的是造成程序崩溃，展示漏洞存在，但实际的远程代码执行可能需要更复杂的利用方式。提供的代码可以生成一个导致Microsoft Word崩溃的RTF文件，证明漏洞可以被触发。 web页面8提到PoC允许攻击者利用Microsoft Word中的一个严重漏洞，只需三行代码，并导致崩溃。综合来看，该PoC具有一定的有效性，可以触发漏洞并导致拒绝服务。

**投毒风险：**
查看整个漏洞利用代码仓库，主要包括许可证文件、readme文件、python脚本以及生成的rtf文件。代码逻辑简单，目的是为了生成大量字体定义的RTF文件，以触发漏洞。没有发现任何明显的后门或恶意代码，因此，判定此仓库中不存在作者隐藏的投毒代码的可能性较低。作者XnuxersXploitXen的用户名没有在其他的投毒事件中出现，可以推测投毒的可能性较低。

**利用方式：**
1.  攻击者构造一个恶意的RTF文件，该文件包含精心设计的字体表或其他结构，以触发目标程序（Microsoft Word）中的整数溢出或堆损坏漏洞。
2.  攻击者通过电子邮件、网络共享或其他方式将恶意RTF文件发送给目标用户。
3.  目标用户使用Microsoft Word打开或预览该文件。如果目标用户的Microsoft Word版本存在漏洞，则会触发漏洞。
4.  成功利用漏洞可能导致程序崩溃（如提供的POC所示），或允许攻击者在目标系统上执行任意代码。要实现任意代码执行，攻击者需要进一步构造RTF文件，以便控制程序执行流程并注入恶意代码。

**项目地址:** [Xnuvers007/CVE-2023-21716](https://github.com/Xnuvers007/CVE-2023-21716)

**漏洞详情:** [CVE-2023-21716](https://nvd.nist.gov/vuln/detail/CVE-2023-21716)