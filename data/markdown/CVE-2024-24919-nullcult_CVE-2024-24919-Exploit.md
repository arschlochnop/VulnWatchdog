## CVE-2024-24919-Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 需要目标设备连接互联网，并启用远程接入VPN或移动接入软件 blades。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919 存在于 Check Point Security Gateways 中，是一个信息泄露漏洞。该漏洞允许未经身份验证的远程攻击者读取位于受影响设备上的任意文件内容。根据搜索引擎结果和漏洞利用代码，该漏洞利用的有效性较高。利用方式是利用路径遍历漏洞读取敏感文件。PoC代码通过构造包含路径遍历的POST请求，访问/clients/MyCRL端点，从而读取目标文件。

**有效性：**
提供的Go语言PoC代码似乎是有效的。它通过发送包含路径遍历的HTTP POST请求来尝试读取目标文件，并通过检查HTTP状态码来确定文件是否存在。代码会尝试读取多个敏感文件路径，增加了漏洞利用的成功率。

**投毒风险：**
虽然该仓库主要是漏洞利用代码，但仍然存在一定的投毒风险。PoC代码本身是公开的，但是考虑到代码仓库的作者可能会在代码中隐藏恶意行为，例如收集用户信息或植入后门。虽然代码量不多，人工审核相对容易，仍然不能排除被隐藏的风险。综合评估，投毒风险大约为10%。

**利用方式：**
攻击者发送特制的HTTP POST请求到 Check Point Security Gateway 的 `/clients/MyCRL` 端点。请求的body包含一个路径遍历payload，例如 `aCSHELL/../../../../../../../etc/passwd`，试图读取目标系统上的 `/etc/passwd` 文件。

由于漏洞存在于启用了远程接入VPN或移动接入软件 blades 的设备上，因此攻击者可以远程利用该漏洞，无需进行身份验证。成功利用此漏洞将允许攻击者读取 Check Point Security Gateway 设备上的敏感文件，例如配置文件、SSH密钥或密码哈希值。

**项目地址:** [nullcult/CVE-2024-24919-Exploit](https://github.com/nullcult/CVE-2024-24919-Exploit)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)