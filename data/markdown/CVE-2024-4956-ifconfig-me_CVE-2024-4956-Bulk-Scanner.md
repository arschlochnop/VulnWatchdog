## CVE-2024-4956 Sonatype Nexus Repository 3 Path Traversal

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，允许未经身份验证的攻击者读取系统文件

**影响版本:** <= 3.68.0

**利用条件:** 目标系统运行受影响版本的Sonatype Nexus Repository Manager 3，且攻击者能够通过网络访问该服务。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-4956 存在于 Sonatype Nexus Repository Manager 3 中。该漏洞允许未经身份验证的远程攻击者通过构造包含路径遍历的 URL 来读取服务器上的任意文件。PoC 代码 `CVE-2024-4956-scanner.py` 是一个批量扫描器，它从文件中读取域名和payloads，然后向每个域名发送包含 payload 的请求。如果响应包含"root:"字符串（通常在 `/etc/passwd` 文件中），则认为该URL存在漏洞并将其写入 `successful_urls.txt` 文件中。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，且PoC代码旨在利用此漏洞，因此PoC的有效性较高。

**投毒风险：**
PoC代码的主要功能是发送HTTP请求并检查响应内容。代码中包含了一些打印语句和文件写入操作，但没有发现任何明显的恶意代码或后门。
*   代码的目的是扫描漏洞，并记录成功利用的URL，而不是修改或破坏目标系统。
*   虽然存在文件写入操作 (`successful_urls.txt`)，但这仅用于记录目的，不会执行任何潜在的恶意操作。
*   代码的所有操作都与其声明的目标一致，没有发现任何隐藏或未记录的功能。

因此，可以认为此仓库中存在作者隐藏的投毒代码的风险非常低。考虑到代码的简单性和功能的透明性，投毒风险约为1%。

**利用方式：**
1.  攻击者需要一个包含目标Nexus Repository Manager实例URL的列表。
2.  攻击者需要一个包含路径遍历payload的列表，例如 `../../../../etc/passwd`。
3.  运行PoC脚本 `CVE-2024-4956-scanner.py`，并提供包含URL列表和payload列表的文件路径。
4.  该脚本会向每个URL发送包含payload的请求。
5.  如果服务器存在漏洞，则会返回被读取的文件内容。脚本将检测`/etc/passwd`文件中的“root:”字符串以判断是否成功利用。
6.  利用成功的URL将被记录在`successful_urls.txt`文件中。

攻击者可以利用此漏洞读取敏感的系统文件，例如配置文件、源代码等，从而获取敏感信息或进一步利用系统。

**项目地址:** [ifconfig-me/CVE-2024-4956-Bulk-Scanner](https://github.com/ifconfig-me/CVE-2024-4956-Bulk-Scanner)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)