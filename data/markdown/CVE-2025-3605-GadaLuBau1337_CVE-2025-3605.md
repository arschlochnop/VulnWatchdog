## CVE-2025-3605-Frontend Login and Registration Blocks-权限提升

**漏洞编号:** CVE-2025-3605

**漏洞类型:** 权限提升

**影响应用:** Frontend Login and Registration Blocks

**危害等级:** 高危，可能导致账户接管和完全控制 WordPress 站点

**影响版本:** <= 1.0.7

**利用条件:** 需要目标 WordPress 站点安装并启用存在漏洞的前端登录和注册 Blocks 插件，且无需身份验证即可访问。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-3605 存在于 Frontend Login and Registration Blocks 插件中，允许未经身份验证的攻击者通过修改任意用户（包括管理员）的电子邮件地址来提升权限。攻击者利用 `flr_blocks_user_settings_handle_ajax_callback()` 函数中缺少适当的身份验证，通过发送包含目标用户 ID 和新电子邮件地址的 POST 请求到 `/wp-admin/admin-ajax.php` 端点，更改目标用户的电子邮件地址。之后，攻击者可以利用“忘记密码”功能，使用新设置的电子邮件地址重置密码，从而获得对目标账户的完全控制权。

**漏洞利用方式：**

1.  **未经身份验证的请求：** 攻击者无需登录或提供任何凭据。
2.  **目标用户ID：** 攻击者需要知道目标用户的 ID (例如，管理员 ID 通常为 1)。
3.  **修改电子邮件地址：**  攻击者发送POST请求到 `/wp-admin/admin-ajax.php` ，数据包中包含 `action=flrblocksusersettingsupdatehandle`，`user_id=目标用户ID`，`flr-blocks-email-update=新的邮箱地址`。
4.  **重置密码：** 使用新的邮箱地址，通过“忘记密码”功能重置目标账户的密码。
5.  **账户接管：** 使用重置后的密码登录目标账户。

**有效性：**

提供的 PoC 代码看起来有效，因为它实现了上述的漏洞利用步骤，通过构造恶意请求来修改目标用户的电子邮件地址。漏洞库信息表明此漏洞是真实存在的，且有可利用的 PoC。

**投毒风险：**

分析 PoC 代码，发现其主要功能是利用漏洞修改用户邮箱，并通过修改后的邮箱进行密码重置以达到提权的目的。代码结构清晰，功能明确，没有发现明显的恶意行为。User-Agent 的自定义虽然可以用于跟踪，但本身不属于恶意行为。 README文件是对POC的使用说明，也没有包含恶意代码。

综上所述，PoC 代码本身被植入恶意后门的风险较低，但仍需保持警惕，因为攻击者可能会利用此漏洞进行进一步的攻击，例如植入恶意代码或进行其他恶意活动。因此，将投毒风险评估为5%。

**项目地址:** [GadaLuBau1337/CVE-2025-3605](https://github.com/GadaLuBau1337/CVE-2025-3605)

**漏洞详情:** [CVE-2025-3605](https://nvd.nist.gov/vuln/detail/CVE-2025-3605)