## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能允许未授权访问受保护的资源和功能

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 目标应用使用了存在漏洞的Next.js版本，并且授权检查依赖于middleware。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是一个 Next.js 中间件授权绕过漏洞。该漏洞源于 Next.js 对 `x-middleware-subrequest` 标头处理不当。攻击者可以通过在 HTTP 请求中设置 `x-middleware-subrequest` 标头来绕过中间件中的授权检查，从而未经授权访问受保护的路由。根据漏洞利用代码，只需在请求中添加 `x-middleware-subrequest: middleware:middleware:middleware:middleware:middleware` 标头即可绕过身份验证并访问受保护的路由，如 `/dashboard`。搜索结果表明该漏洞影响 Next.js 多个版本，并被认为是高危漏洞。PoC 代码提供了一个简单的示例，展示了如何利用此漏洞。仓库投毒风险较低，因为代码非常简短，主要是一个 Markdown 文件，且利用方式明确，没有隐藏的恶意代码。风险主要来自于后续使用者在使用该POC进行渗透测试过程中的不规范操作带来的风险。但是由于该漏洞已经公开，且存在已知利用方式，恶意攻击者也可以直接利用，因此需要及时修复。

**有效性：**
根据漏洞描述和PoC代码，该漏洞利用是有效的。

**投毒风险：**
该PoC仓库主要包含一个README.md文件，用于解释漏洞和提供示例。根据现有信息，直接投毒风险较低，估计在5%左右。但需要注意，后续开发者可能会修改或添加恶意代码。

**利用方式：**
攻击者通过在HTTP请求中设置 `x-middleware-subrequest` 标头来绕过 Next.js 中间件中的授权检查，从而未经授权访问受保护的路由。

**项目地址:** [b4sh0xf/PoC-CVE-2025-29927](https://github.com/b4sh0xf/PoC-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)