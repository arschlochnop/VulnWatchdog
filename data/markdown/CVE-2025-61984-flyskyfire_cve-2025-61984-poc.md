## CVE-2025-61984-OpenSSH-用户名控制字符注入

**漏洞编号:** CVE-2025-61984

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** < 10.1

**利用条件:** 需要开启 ProxyCommand 并且允许通过命令行或配置文件的 %-sequence 展开来设置用户名

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-61984 漏洞存在于 OpenSSH 10.1 之前的版本中。漏洞原因是 OpenSSH 在处理来自某些不受信任来源（如命令行和配置文件的 %-sequence 展开）的用户名时，没有正确过滤控制字符。如果配置了 ProxyCommand，攻击者可以通过在用户名中注入控制字符来执行任意命令。提供的POC代码是一个简单的反向shell脚本，攻击者可以将其注入到用户名中，从而在目标机器上执行该脚本。该脚本的功能是尝试连接到攻击者控制的IP地址（192.168.129.150）的4444端口，并建立一个交互式的bash shell。投毒风险分析：POC代码的主要功能是建立反向 shell，本身具备一定的攻击性，如果攻击者将该POC进行修改，加入删除系统日志、上传恶意文件等操作，可能会造成更大的危害。但是该POC的主要目的是验证漏洞，因此判断投毒风险为较低，大约10%。利用方式：1. 配置 OpenSSH 使用 ProxyCommand。 2. 通过命令行或包含 %-sequence 展开的配置文件设置用户名，并在用户名中注入包含恶意代码的反向 shell 脚本。 3. 触发 SSH 连接，导致 ProxyCommand 执行包含恶意代码的用户名，从而执行任意命令。

**项目地址:** [flyskyfire/cve-2025-61984-poc](https://github.com/flyskyfire/cve-2025-61984-poc)

**漏洞详情:** [CVE-2025-61984](https://nvd.nist.gov/vuln/detail/CVE-2025-61984)