## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23897 是 Jenkins 插件 args4j 中的一个漏洞，允许未经身份验证的攻击者通过 Jenkins CLI 读取 Jenkins 控制器文件系统上的任意文件。攻击者利用了args4j库的特性，该特性将以'@'字符开头的参数视为文件路径，并将其内容作为参数传递。通过构造包含恶意文件路径的CLI命令，攻击者可以读取服务器上的任何文件。根据搜索结果，可以通过 HTTP, WebSocket 和 SSH 访问CLI接口进行利用。PoC 代码利用了该漏洞，通过 `connect-node` 命令和 `@` 符号读取文件。该脚本通过构建特定的payload, 使用requests 库发送 POST 请求到 Jenkins 的 `/cli?remoting=false` 接口。虽然代码的主体功能是利用漏洞，但存在一定的投毒风险，主要体现在以下几个方面：

1.  **URL硬编码风险：** 虽然使用了 `args.url`，但如果解析参数时出现问题，可能会导致连接到错误的Jenkins实例，但影响有限。
2.  **代理设置：** 代码中存在 `proxies` 变量，如果攻击者修改了该变量，可能会导致流量被重定向到恶意服务器，但前提是攻击者能够修改脚本。
3.  **依赖风险:** 脚本依赖于 `requests` 和 `colorama` 库。恶意修改这些依赖可能会导致任意代码执行，但风险较低。

考虑到这些因素，投毒风险估计为10%。

**项目地址:** [verylazytech/CVE-2024-23897](https://github.com/verylazytech/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)