## CVE-2025-48384-Git配置引号处理缺陷导致任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致系统被完全控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户clone包含恶意配置的仓库，并初始化包含恶意配置的子模块，且子模块包含恶意的post-checkout hook。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384是Git中的一个高危漏洞，源于Git在处理配置引号时存在缺陷。当读取配置值时，Git会删除任何尾部的回车符和换行符（CRLF）。当写入配置项时，尾部带有CR的值不会被引用，导致CR在稍后读取配置时丢失。当初始化子模块时，如果子模块路径包含尾部CR，则会读取更改后的路径，导致子模块被检出到错误的位置。如果存在一个符号链接，将更改后的路径指向子模块的hooks目录，并且子模块包含一个可执行的post-checkout hook，则在检出后可能会意外执行该脚本。

根据提供的POC代码，`/tmp/81a81d657749821214a4f9bba7b4c2c8/post`文件是一个简单的bash脚本，其功能是在`/tmp`目录下创建一个名为`CVE-2025-48384`的空文件。这个脚本本身不包含明显的恶意代码，但如果利用该漏洞，它可以被放置到`.git/hooks/post-checkout`中，在`git checkout`命令执行后自动执行。这使得攻击者可以控制受害者的系统。

**利用方式：**
1.  攻击者创建一个包含恶意配置的Git仓库。恶意配置包含一个包含尾部CR的子模块路径，该路径指向子模块的hooks目录。
2.  攻击者在该仓库中添加一个可执行的`post-checkout` hook脚本 (例如，提供的`post`脚本)到子模块的hooks目录中。
3.  攻击者诱导受害者克隆该恶意仓库并初始化子模块。
4.  由于Git的配置引号处理缺陷，子模块会被检出到错误的位置，符号链接会将该位置指向子模块的hooks目录。
5.  当受害者执行`git checkout`命令时，`post-checkout` hook脚本会被执行，攻击者从而实现任意代码执行。

**有效性：**
提供的POC代码是有效的，因为它展示了如何创建一个触发漏洞的`post-checkout` hook脚本。尽管脚本本身的功能很简单，但可以替换为任何恶意代码。

**投毒风险：**
该仓库中存在作者隐藏的投毒代码的风险较低，估计为10%。当前提供的脚本只是一个简单的测试脚本，用于验证漏洞的存在。但是，攻击者可能会在更复杂的仓库中隐藏更高级的恶意代码，使其更难被检测到。该风险评估基于提供的信息，实际风险可能因仓库的具体内容而有所不同。

**项目地址:** [admin-ping/CVE-2025-48384-RCE](https://github.com/admin-ping/CVE-2025-48384-RCE)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)