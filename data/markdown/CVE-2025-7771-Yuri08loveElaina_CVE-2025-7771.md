## CVE-2025-7771-ThrottleStop.sys-权限提升

**漏洞编号:** CVE-2025-7771

**漏洞类型:** 权限提升

**影响应用:** ThrottleStop

**危害等级:** 高危，允许本地用户以内核权限执行任意代码

**影响版本:** 3.0.0.0 及可能存在的其他版本

**利用条件:** 需要目标系统安装了受影响版本的ThrottleStop.sys驱动，并且攻击者需要在本地拥有一定权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对此漏洞进行评估如下：

**有效性：**
根据漏洞库信息，`ThrottleStop.sys`驱动存在两个IOCTL接口，允许任意读写物理内存。POC代码中定义了多个IOCTL码（`IOCTL_THROTTLESTOP_V1_READ` 到 `IOCTL_THROTTLESTOP_V5_WRITE`），暗示可能存在多个版本或变体的漏洞利用方式。代码片段包含对 `MmMapIoSpace` 函数的使用，这与漏洞描述中提到的利用方式一致。综上，提供的POC代码**具有有效性**，能够利用此漏洞进行权限提升。

**投毒风险：**
POC代码包含大量的反调试和反虚拟机技术（如 `IsDebuggerPresentAdvanced`、`IsRunningInVMAdvanced`）。虽然这些技术可以用于躲避检测，但也可能被恶意利用。此外，POC代码还包含加密字符串和API名称的机制，用于混淆代码和躲避静态分析。虽然这本身不是投毒行为，但增加了分析代码的难度，使得隐藏恶意代码变得更容易。代码中还存在联网功能，通过 `WinHttp` 库实现，增加了潜在的风险。根据以上分析，此仓库中存在作者隐藏的投毒代码的可能性评估为 **10%**。这种可能性主要来自联网行为以及混淆手段的使用。例如，联网功能可能用于回传信息，或下载执行恶意代码。

**利用方式：**
1.  **找到易受攻击的驱动程序：**  攻击者需要找到存在漏洞的`ThrottleStop.sys`驱动程序。
2.  **利用IOCTL接口：**  利用该驱动暴露的IOCTL接口，通过用户态程序与驱动程序进行交互。
3.  **读写物理内存：**  通过IOCTL接口，使用`MmMapIoSpace`函数实现对物理内存的任意读写。
4.  **修补内核：**  读取内核内存，找到敏感数据结构（如EPROCESS结构），修改其中的成员（如Token），从而提升当前进程的权限到SYSTEM。
5.  **执行任意代码：**  通过修补内核，攻击者可以执行任意内核代码，实现对系统的完全控制。

**搜索引擎结果佐证：**
搜索引擎结果显示，CVE-2025-7771是一个公开的漏洞，多个网站都对其进行了描述。这进一步证实了漏洞的存在性和潜在的风险。


**项目地址:** [Yuri08loveElaina/CVE-2025-7771](https://github.com/Yuri08loveElaina/CVE-2025-7771)

**漏洞详情:** [CVE-2025-7771](https://nvd.nist.gov/vuln/detail/CVE-2025-7771)