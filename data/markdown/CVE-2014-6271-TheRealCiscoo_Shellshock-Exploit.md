## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 远程命令执行

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 1.14 - 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过HTTP Header设置环境变量，且Bash版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2014-6271，也被称为ShellShock，是一个存在于GNU Bash中的高危漏洞。该漏洞源于Bash处理环境变量中函数定义后附加字符串的方式存在缺陷，攻击者可以通过构造包含恶意代码的环境变量，当Bash执行相关程序时，恶意代码会被执行，从而实现远程命令执行。从漏洞库信息和搜索引擎结果来看，此漏洞影响广泛，修复不彻底，危害巨大。

**有效性：**
提供的Python POC代码利用了ShellShock漏洞。它构造了一个包含恶意Bash代码的User-Agent头，并向目标URI发送GET请求。如果目标URI是一个CGI脚本，或者其他任何调用Bash并使用该User-Agent头作为环境变量的应用程序，那么恶意的Bash代码就会被执行，从而建立反向shell。

**投毒风险：**
该仓库的投毒风险较低。虽然任何代码都可能包含恶意成分，但此POC代码相对简单，主要功能是利用已知的ShellShock漏洞。潜在的风险可能包括：

*   作者可能在反向shell的Payload中植入其他恶意命令。但通过代码审计，反向shell的Payload清晰可见，未发现隐藏的恶意代码。
*   该代码可能针对特定系统环境做了优化，如果攻击者不了解这些优化，可能会导致利用失败，或留下攻击痕迹。但这种“优化”也可以被视作一种隐蔽的攻击尝试。

综合评估，该代码存在恶意投毒的可能性较低，约为5%。这个百分比代表一种潜在的风险，需要仔细审查代码才能完全消除。

**利用方式：**
1.  **确定目标：** 找到运行受影响Bash版本的服务器，并确认存在可以通过HTTP头设置环境变量的CGI脚本或其他应用。
2.  **准备攻击环境：** 在攻击者机器上设置NetCat监听指定端口，等待反向shell连接：`ncat -lkvnp <attacker-port>`。
3.  **构造Payload：** 使用POC脚本，指定目标IP地址、URI、攻击者IP地址和监听端口。
4.  **发送请求：** 运行POC脚本，它会构造一个包含恶意代码的HTTP GET请求，并将User-Agent设置为包含恶意代码的环境变量。
5.  **利用漏洞：** 如果目标存在漏洞，Bash会执行User-Agent头中的恶意代码，建立与攻击者机器的反向shell连接。
6.  **控制目标：** 攻击者通过反向shell控制目标系统，执行任意命令。

**项目地址:** [TheRealCiscoo/Shellshock-Exploit](https://github.com/TheRealCiscoo/Shellshock-Exploit)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)