## CVE-2022-31195-DSpace-路径遍历

**漏洞编号:** CVE-2022-31195

**漏洞类型:** 路径遍历

**影响应用:** DSpace

**危害等级:** 高危，可能导致任意文件写入，最终导致远程代码执行

**影响版本:** >= 4.0, < 5.11 和 >= 6.0, < 6.4

**利用条件:** 需要管理员权限或命令行访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-31195是DSpace的ItemImportServiceImpl中存在的路径遍历漏洞。攻击者通过构造恶意的SAF（Simple Archive Format）包，可以在服务器上Tomcat/DSpace用户具有写权限的任何位置创建文件/目录。

**有效性：**
根据漏洞信息，搜索引擎结果和漏洞利用代码分析，该漏洞利用的有效性较高。该漏洞存在于受影响的DSpace版本中，并且可以通过构造恶意的SAF包进行利用。

**投毒风险：**
提供的代码片段是Dockerfile和许可协议。Dockerfile 描述了如何构建DSpace Docker镜像，包括从Maven构建，使用Ant进行部署，最后基于Tomcat运行DSpace。 代码本身没有发现明显的恶意行为或后门代码。 这些文件主要用于设置和配置DSpace环境，因此，**投毒风险为0%**。

**利用方式：**
1.  攻击者需要具有DSpace的管理员权限或命令行访问权限。
2.  攻击者构造恶意的SAF包，其中包含路径遍历的payload。Payload可能包含诸如`../../../../`之类的路径，用于跳出预期的目录。
3.  攻击者通过Admin Batch Import工具或命令行上传恶意的SAF包。
4.  DSpace的ItemImportServiceImpl处理SAF包时，由于没有充分的路径验证，导致路径遍历漏洞。
5.  攻击者可以在服务器上Tomcat/DSpace用户具有写权限的任何位置创建文件/目录， 例如，覆盖Tomcat的配置文件或部署Webshell，从而实现远程代码执行。

**项目地址:** [shoucheng3/DSpace__DSpace_CVE-2022-31195_5-10](https://github.com/shoucheng3/DSpace__DSpace_CVE-2022-31195_5-10)

**漏洞详情:** [CVE-2022-31195](https://nvd.nist.gov/vuln/detail/CVE-2022-31195)