## CVE-2023-20198-Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，可完全控制受影响设备

**影响版本:** 受影响版本范围广泛，详见漏洞库信息

**利用条件:** Web UI 功能启用且可访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 存在于 Cisco IOS XE 软件的 Web UI 中。未经身份验证的攻击者可以利用此漏洞创建具有 privilege level 15 权限的本地用户，从而获得对设备的完全控制权。利用方式主要通过发送特制的 SOAP 请求到目标设备的 Web UI 接口，绕过身份验证，执行 CLI 命令。PoC 代码通过构造恶意的 SOAP 消息，例如 `username <username> privilege 15 secret <password>`，添加高权限用户。 

有效性分析：根据漏洞库信息和搜索结果，此漏洞已被积极利用，并且存在公开的 PoC。提供的 PoC 代码实现了漏洞利用的基本功能，包括检查漏洞、获取配置、执行命令和添加/删除用户。因此，提供的 PoC 代码是有效的。

投毒风险分析：代码本身主要实现了漏洞利用功能，但仍然存在一定的投毒风险。体现在以下几个方面：

*   **恶意命令执行：** 虽然代码本身没有硬编码的恶意命令，但 `-e` 参数允许攻击者执行任意 Cisco IOS 命令。攻击者可能会使用此参数注入恶意配置或植入后门。
*   **硬编码凭据：** 默认用户名 `shellsmoke` 和密码 `pwned` 如果不修改，可能被其他攻击者利用。虽然这是一个PoC，但在实际使用中容易被忽视，从而导致设备被二次入侵。
*   **异常处理：** 某些异常处理不够完善，可能导致程序崩溃或泄露敏感信息。
*   **Payload内容:** 在SOAP请求模板中，攻击者可能修改命令或者在ADD_USER的情况下，添加后门账户。

综合考虑，该 PoC 存在一定的投毒风险，但主要集中在用户使用不当或被恶意利用的可能性上，PoC本身是漏洞的利用，投毒代码的可能性评判为 10%。建议使用者在使用 PoC 时仔细审查代码，并采取必要的安全措施。

利用方式总结：

1.  **目标确认：** 确定目标 Cisco IOS XE 设备是否启用了 Web UI 功能。
2.  **发送恶意 SOAP 请求：** 构造包含 CLI 命令的恶意 SOAP 请求，绕过身份验证。
3.  **权限提升：** 利用漏洞创建具有 privilege level 15 权限的本地用户。
4.  **完全控制：** 使用新创建的用户登录并完全控制设备。

**项目地址:** [XiaomingX/cve-2023-20198-poc](https://github.com/XiaomingX/cve-2023-20198-poc)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)