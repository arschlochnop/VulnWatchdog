## CVE-2020-3452 - Cisco ASA/FTD 目录遍历

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用WebVPN或AnyConnect功能，且存在可访问的Web服务接口。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452 是一个存在于 Cisco ASA (Adaptive Security Appliance) 软件和 Cisco FTD (Firepower Threat Defense) 软件 Web 服务接口中的目录遍历漏洞。由于对 HTTP 请求中 URL 的输入验证不足，未经身份验证的远程攻击者可以利用此漏洞执行目录遍历攻击，并读取目标系统上的敏感文件。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。漏洞库信息明确指出存在该漏洞，并提供了受影响的版本范围。搜索引擎结果也确认了该漏洞的存在，并提供了相关分析和补丁信息。提供的漏洞利用代码（cve_2020_3452.py）包含了一个 POC，该 POC 使用特定的 URL 路径（/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../）来触发目录遍历。

**投毒风险：**
漏洞利用代码（cve_2020_3452.py）包含以下关键部分：
1.  **banner()**：打印一个横幅，用于标识该工具。
2.  **check_vuln(target)**：检查目标是否存在漏洞。它构造一个包含 POC 的 URL，并向目标发送 HTTP 请求。如果响应状态码为 200，则认为目标存在漏洞，并将响应内容保存到文件中。
3.  **scan_range(ip_start, ip_finish)**：扫描 IP 地址范围以查找存在漏洞的目标。
4.  **scan_list(ip_list)**：扫描 IP 地址列表以查找存在漏洞的目标。
5.  **get_targets_from_file(filename)**：从文件中读取目标 IP 地址列表。
6.  **send_request(url)**：发送 HTTP 请求到目标 URL。
7.  **save_in_file(filename, text, target)**：将从目标收到的响应保存到文件中。

代码中没有发现明显的恶意或投毒行为。该脚本主要用于检查目标系统是否存在 CVE-2020-3452 漏洞，并将响应保存到文件中。作者声明该工具仅用于教育和道德测试目的。**投毒风险评估为0%。**

**利用方式：**
1.  **确定目标：** 找到运行受影响的 Cisco ASA 或 FTD 软件，并且启用了 WebVPN 或 AnyConnect 功能的设备。
2.  **发送恶意 HTTP 请求：** 构造包含目录遍历序列的 HTTP 请求，发送到目标设备的 Web 服务接口。POC 使用的 URL 是：/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../。这个 URL 利用了 ASA/FTD 软件对目录遍历字符处理不当的缺陷。
3.  **读取敏感文件：** 如果漏洞利用成功，攻击者可以读取 Web 服务文件系统中的任意文件。根据漏洞描述，该漏洞不能用于访问 ASA 或 FTD 系统文件或底层操作系统文件。
4.  **自动化利用：** 提供的 Python 脚本可以自动化整个利用过程，包括扫描 IP 范围、发送恶意请求和保存响应。

**项目地址:** [paran0id34/CVE-2020-3452](https://github.com/paran0id34/CVE-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)