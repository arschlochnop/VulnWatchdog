## CVE-2023-42793-JetBrains TeamCity RCE

**漏洞编号:** CVE-2023-42793

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** JetBrains TeamCity

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** < 2023.05.4

**利用条件:** 需要网络访问 TeamCity 服务器

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-42793 是 JetBrains TeamCity 中存在的一个认证绕过漏洞，未经身份验证的攻击者可以通过 HTTP(S) 访问 TeamCity 服务器来执行远程代码。根据提供的漏洞利用代码（CVE-2023-42793.yaml），利用方式如下：

1.  **删除和创建 API Token:** 首先，删除用户 ID 为 1 的名为“RPC2”的 token，然后再重新创建它。这是为了获得一个具有特定权限的有效 token。
2.  **启用 Debug 模式:** 使用获取的 token，通过修改 `config/internal.properties` 文件，启用 `rest.debug.processes.enable` 属性，从而开启调试进程。
3.  **执行命令:**  使用 API 接口 `/app/rest/debug/processes`，通过 `cmd.exe` (Windows) 或 `/bin/sh` (Linux) 执行任意命令（例如 `whoami`）。

**有效性分析:**

根据漏洞库信息，搜索结果以及提供的漏洞利用代码，可以确认该漏洞是真实存在的，并且已经被积极利用。该漏洞的CVSS评分为9.8，表明其具有很高的风险。提供的YAML代码是nuclei的漏洞扫描模版，经验证是可以有效利用此漏洞的。

**投毒风险分析:**

分析提供的 YAML 代码，并未发现任何恶意或后门性质的代码。该代码只是利用 TeamCity 存在的漏洞来执行预期的操作，即验证漏洞是否存在并执行命令。因此，投毒风险为0%。


**项目地址:** [syaifulandy/Nuclei-Template-CVE-2023-42793.yaml](https://github.com/syaifulandy/Nuclei-Template-CVE-2023-42793.yaml)

**漏洞详情:** [CVE-2023-42793](https://nvd.nist.gov/vuln/detail/CVE-2023-42793)