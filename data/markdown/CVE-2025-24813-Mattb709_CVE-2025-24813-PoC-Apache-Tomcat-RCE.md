## CVE-2025-24813-Apache Tomcat RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 11.0.0-M1 to 11.0.2, 10.1.0-M1 to 10.1.34, 9.0.0.M1 to 9.0.98

**利用条件:** writes enabled for the default servlet, support for partial PUT enabled, application using Tomcat's file-based session persistence with the default storage location, application includes a library that may be leveraged in a deserialization attack 或 writes enabled for the default servlet, support for partial PUT, target URL for security sensitive uploads that was a sub-directory of a target URL for public uploads, attacker knowledge of the names of security sensitive files being uploaded, the security sensitive files also being uploaded via partial PUT

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，攻击者通过利用 'file.Name' (Internal Dot) 机制，结合启用了写入功能的 Default Servlet 和部分 PUT 请求支持，可以执行远程代码或进行信息泄露，甚至向上传的文件添加恶意内容。

**有效性评估：** 根据搜索结果，CVE-2025-24813 漏洞已被公开，并且有证据表明已被积极利用。虽然提供的 PoC 代码本身只包含一个 README.md 文件，无法直接证明漏洞的利用，但根据搜索结果，完整的利用链是存在的，并且漏洞本身是可被利用的。这个README.md只是一个占位符，提示存在利用代码。需要进一步搜索才能找到真正可用的POC。

**投毒风险评估：** 提供的 PoC 代码（README.md）非常简单，只包含标题，没有可执行的代码，因此**几乎**不存在直接的投毒风险。风险占比为1%。

**利用方式分析：**

利用 CVE-2025-24813 漏洞有两种主要方式：

1.  **远程代码执行 (RCE)：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。 （默认禁用）
        *   启用了部分 PUT 请求支持。 （默认启用）
        *   应用程序使用 Tomcat 的基于文件的会话持久化，并且使用默认存储位置。
        *   应用程序包含可用于反序列化攻击的库。
    *   攻击过程：攻击者利用部分 PUT 请求上传恶意文件到 Tomcat 的会话存储目录，然后通过反序列化漏洞执行任意代码。

2.  **信息泄露和恶意内容添加：**
    *   前提条件：
        *   Default Servlet 开启了写入权限。（默认禁用）
        *   启用了部分 PUT 请求支持。（默认启用）
        *   存在安全敏感上传的目标 URL，该 URL 是公共上传目标 URL 的子目录。
        *   攻击者知道安全敏感文件的名称。
        *   安全敏感文件也通过部分 PUT 上传。
    *   攻击过程：攻击者利用路径等价漏洞，通过部分 PUT 请求上传恶意文件，覆盖或修改目标 URL 下的安全敏感文件，从而导致信息泄露或向上传的文件添加恶意内容。

总而言之，该漏洞允许未经身份验证的攻击者在满足特定条件的情况下执行远程代码或进行信息泄露，需要尽快修复。


**项目地址:** [Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE](https://github.com/Mattb709/CVE-2025-24813-PoC-Apache-Tomcat-RCE)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)