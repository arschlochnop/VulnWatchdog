## CVE-2025-57819-FreePBX-身份验证绕过SQL注入RCE

**漏洞编号:** CVE-2025-57819

**漏洞类型:** 身份验证绕过, SQL注入, 远程代码执行

**影响应用:** FreePBX

**危害等级:** 严重，未经身份验证的攻击者可以完全控制受影响的FreePBX系统，导致数据泄露、篡改和系统不可用，甚至控制整个PBX网络。

**影响版本:** 15, 16, 17 ( < 15.0.66, < 16.0.89, < 17.0.3)

**利用条件:** FreePBX实例暴露在公网上，且防火墙未限制对modular.php的访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57819 是 FreePBX 中的一个漏洞，影响版本15、16和17。该漏洞源于对用户提供的数据进行的不充分的清理，导致未经身份验证的攻击者能够访问 FreePBX 管理员账户，从而允许任意数据库操作和远程代码执行。

**有效性:**
根据提供的漏洞库信息和搜索引擎结果，该漏洞已经被积极利用(CISA KEV)，漏洞影响范围和危害都比较大，且漏洞利用代码（POC）已公开，验证有效性高。

**投毒风险:**
提供的漏洞利用代码（Write-up.md）主要描述了漏洞原理、利用方式和缓解措施，并没有发现直接的后门代码或者恶意指令。虽然该 Write-up.md 文件本身看起来没有包含任何直接的“投毒”代码，但存在间接风险。该文档建议检查可疑流量和文件，例如`*.clean.sh*`，该文件可能本身就是一个清理脚本，也可能是一个攻击者上传的用于隐藏或进一步利用的恶意脚本。此外，任何公开的漏洞利用信息都可能被恶意行为者修改并重新分发，包含恶意后门，此处POC的投毒风险较低，约 10%。

**利用方式:**
1.  **发现目标：** 攻击者在公网上寻找暴露的 FreePBX 实例。
2.  **绕过认证：** 攻击者发送精心构造的恶意 HTTP 请求到 `modular.php` 脚本，这些请求包含未经过滤的 SQL 注入 payload。
3.  **SQL 注入：** 恶意请求中的 SQL 注入 payload 允许攻击者绕过身份验证，并获得管理员权限。
4.  **远程代码执行：** 获得管理员权限后，攻击者可以执行任意数据库操作，甚至上传和执行恶意代码，从而完全控制 FreePBX 系统。

**总结:**
该漏洞的利用方式是通过利用FreePBX 未对modular.php的请求进行进行过滤,直接绕过身份验证并进行SQL注入,拿到管理员权限后,再通过管理员权限进行RCE,风险极高。


**项目地址:** [net-hex/CVE-2025-57819](https://github.com/net-hex/CVE-2025-57819)

**漏洞详情:** [CVE-2025-57819](https://nvd.nist.gov/vuln/detail/CVE-2025-57819)