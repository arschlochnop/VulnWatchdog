## CVE-2025-49113-Roundcube-PHP对象反序列化RCE

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化RCE

**影响应用:** Roundcube Webmail

**危害等级:** 严重，可导致远程代码执行

**影响版本:** < 1.5.10, 1.6.0 <= version < 1.6.11

**利用条件:** 需要已认证用户权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-49113 是 Roundcube Webmail 中一个 PHP 对象反序列化漏洞，位于 `program/actions/settings/upload.php` 文件，由于对 `_from` 参数的 URL 验证不足导致。已认证的用户可以通过构造恶意的序列化 PHP 对象，并将其作为 `_from` 参数的值，通过用户设置上传端点进行注入，从而实现远程代码执行。提供的 PoC 代码通过模拟登录，然后构造恶意 payload 文件进行上传，最终触发反序列化漏洞并执行任意命令。PoC 代码的功能较为完善，能够自动获取 CSRF token 和 session cookie，并执行命令。该漏洞的利用需要具备 Roundcube Webmail 账户的有效凭据。由于 PoC 代码主要用于执行任意命令，因此具有一定的风险，但并未发现明显的恶意投毒代码，例如植入后门或恶意传播等，但存在收集目标服务器信息进行外传的可能性,风险较低。

**利用方式:**

1.  **身份验证：** 首先，攻击者需要拥有一个有效的 Roundcube Webmail 账号和密码。
2.  **获取 CSRF Token 和 Session Cookie：** 使用有效的凭据向 Roundcube Webmail 发送一个 GET 请求，以获取 CSRF Token 和 Session Cookie。
3.  **构造恶意 Payload：**  根据目标 PHP 版本构造恶意的 PHP 对象，该对象在反序列化时会执行攻击者指定的任意命令。PoC 已经实现了这一步。
4.  **注入 Payload：** 将构造好的恶意 PHP 对象序列化后，作为 `_from` 参数的值，通过用户设置上传端点进行注入。PoC 代码已经实现了自动注入。
5.  **触发反序列化：** 访问包含恶意 Payload 的 URL，触发 PHP 对象反序列化，从而执行任意命令。
6.  **命令执行：**  成功利用该漏洞后，攻击者可以在目标服务器上执行任意命令，例如安装恶意软件、窃取敏感数据等。

根据搜索结果，该漏洞已经被积极利用，因此需要及时修复。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-49113](https://github.com/B1ack4sh/Blackash-CVE-2025-49113)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)