## CVE-2022-44136-Zenar CMS 9.3 Remote Code Execution

**漏洞编号:** CVE-2022-44136

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zenar CMS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.3.57186

**利用条件:** 目标服务器运行 Zenar CMS 9.3.57186 且可从攻击者处访问

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对漏洞利用的有效性、是否存在投毒风险以及漏洞利用方式进行评估和分析。

**1. 有效性：**

*   **漏洞信息：** CVE-2022-44136 描述了 Zenario CMS 9.3.57186 存在远程代码执行漏洞。
*   **搜索引擎结果：** 搜索结果确认了该漏洞的存在，并指出未经身份验证的攻击者可以利用该漏洞在受影响的系统上执行任意代码。
*   **漏洞利用代码：** 提供的 Python 脚本 `CVE-2022-44136-EXP.py` 旨在利用此漏洞。它模拟了漏洞利用过程，包括检查目标是否易受攻击，上传 shell，执行命令以及生成报告。但是, 脚本中存在大量的`random.randint`和`time.sleep` 函数, 实际上并未提供真正的漏洞利用代码, 只是模拟了漏洞利用的流程. 因此, 脚本并不能直接实现RCE.

**结论：** 尽管存在漏洞信息和相关的搜索结果，证明了漏洞的真实性,但提供的POC代码并不能直接利用漏洞，只是模拟了漏洞利用过程.

**2. 投毒风险：**

*   **POC代码分析：**
    *   脚本中包含`print_warning()`函数，提醒用户不要信任从网上下载的POC，但这也可能是一种障眼法。
    *   脚本中存在`C2_SERVER`变量，指向`https://command.ctrl.domain/api/v1`。虽然脚本本身没有直接向该服务器发送数据，但如果攻击者修改了脚本，则可能将受害者信息发送到该服务器。因此，存在潜在的C2通信风险。
    *   脚本模拟了报告生成功能，将目标信息写入到本地文件，攻击者可以修改此部分代码，窃取更多敏感信息。
    *   脚本大量使用随机数和延时函数，增加了分析的难度，可能隐藏了恶意代码。
    *   脚本中的`check_vulnerability`、`upload_shell`和`execute_command`函数都使用了`random.randint`来模拟成功或失败，并没有实际的漏洞利用代码，降低了脚本的可用性，但同时也增加了潜在的投毒风险。

**结论：**  脚本存在很高的投毒风险，虽然它目前看起来只是一个模拟漏洞利用的脚本，但潜在的恶意代码可以被轻松地添加。因此，建议不要直接使用该脚本，或者在使用前进行全面的代码审计，确保其安全性。

**3. 利用方式：**

根据搜索结果，该漏洞与文件上传处理有关。攻击者可能通过上传恶意文件（如 PHP shell）到服务器，然后通过访问该文件来执行任意代码。具体的利用方式可能涉及绕过文件上传的限制，或者利用文件上传后的处理逻辑中的漏洞。搜索结果提到“handlePluginAJAX function added security”，这可能表明漏洞与插件处理有关，攻击者可以利用插件上传功能来执行恶意代码。

综合以上信息，漏洞的利用方式可能是：

1.  攻击者构造一个包含恶意代码的文件（例如，一个 PHP shell）。
2.  攻击者利用 Zenario CMS 的文件上传功能（可能与用户表单或插件处理有关）将恶意文件上传到服务器。
3.  攻击者通过访问上传的恶意文件，触发服务器执行其中的恶意代码，从而实现远程代码执行。

**4. 排序优先级：**

搜索引擎结果 > 漏洞利用代码 > 漏洞库信息

**结论：** 提供的 POC 代码有效性低，只是模拟了攻击流程，实际存在投毒风险。需要谨慎使用并进行详细的安全审计。漏洞利用方式是利用未授权的文件上传漏洞上传恶意文件，从而实现 RCE。

**项目地址:** [Ch35h1r3c47/CVE-2022-44136-poc](https://github.com/Ch35h1r3c47/CVE-2022-44136-poc)

**漏洞详情:** [CVE-2022-44136](https://nvd.nist.gov/vuln/detail/CVE-2022-44136)