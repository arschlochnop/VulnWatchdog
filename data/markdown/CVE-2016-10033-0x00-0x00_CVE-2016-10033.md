## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行受影响的PHPMailer版本，并且邮件发送功能允许外部控制Sender属性。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于PHPMailer 5.2.18之前的版本中。攻击者可以通过在Sender属性中注入带有反斜杠双引号(\")的恶意参数，传递给底层的mail命令，从而执行任意代码。  

**利用方式：**
1.  **参数注入：** 攻击者构造特殊的Sender地址，包含反斜杠双引号，用于闭合引号并注入额外的mail命令参数。
2.  **代码执行：** 注入的参数可以控制mail命令的行为，例如指定一个文件作为配置文件（`-C`），或者执行任意shell命令（`-X`）。
3.  **Webshell上传：**  POC代码中使用 `-oQ/tmp/ -X/var/www/shell.php` 参数将 `<?php system($_GET[cmd]);?>` 的内容写入到 `/var/www/shell.php` 中，创建一个Webshell。
4.  **命令执行：** 访问Webshell,例如`http://target.com/shell.php?cmd=id`，即可执行任意命令。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞POC是有效的。多个Exploit-DB条目都证实了该漏洞的存在和可利用性。

**投毒风险：**
代码整体是一个相对简单的利用脚本，主要功能是构造payload发送请求，然后在目标机器上写入webshell，从而实现RCE。代码本身不包含明显的投毒代码，例如反向shell或者其他恶意行为。  但是，在 `remote_location` 和 `shell_name` 中，用户可以自定义webshell的上传路径和名字，这里存在一定的风险，如果用户不小心设置成覆盖重要文件或者目录，可能会导致系统崩溃。整体代码的投毒风险较低，为5%。

**项目地址:** [0x00-0x00/CVE-2016-10033](https://github.com/0x00-0x00/CVE-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)