## CVE-2022-26134 - Atlassian Confluence OGNL 注入 RCE

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL 注入

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** 1.3.0 之前到 7.4.17, 7.13.0 之前到 7.13.7, 7.14.0 之前到 7.14.3, 7.15.0 之前到 7.15.2, 7.16.0 之前到 7.16.4, 7.17.0 之前到 7.17.4, 以及 7.18.0 之前到 7.18.1

**利用条件:** Confluence Server 或 Data Center 实例可访问，无需身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-26134 是一个 Atlassian Confluence Server 和 Data Center 中的 OGNL 注入漏洞。根据漏洞库信息和搜索结果，该漏洞允许未经身份验证的远程攻击者在受影响的 Confluence 实例上执行任意代码。多个来源 (Rapid7, Qualys, Unit 42, NVD) 证实了该漏洞的存在以及其高危性。

提供的漏洞利用代码 `ConfluentPwn` 是一个扫描器，用于检测 Confluence 服务器是否存在此漏洞，并且可以执行命令。其使用方式包括直接指定 URL 或通过文件指定 URL 列表。该工具允许指定并发线程数、超时时间和用户代理。它会输出扫描结果到 CSV 文件，包含目标、Confluence 版本、漏洞状态和命令输出。

**有效性：** 根据搜索结果和提供的 POC 代码，此漏洞利用是有效的。搜索结果表明该漏洞已被积极利用 (Active Exploitation)。`ConfluentPwn` 工具的存在也表明存在可用的利用方式。

**投毒风险：** 分析了提供的 `LICENSE` 和 `README.md` 文件，没有发现明显的恶意代码。但由于代码本身能够执行任意命令，存在一定的投毒风险，比如作者可能在其他版本或分支中添加恶意代码，或者使用者在不了解代码全部功能的情况下使用，从而引入风险。此仓库的投毒风险预估为 10%，主要基于供应链安全的考虑，以及使用者可能引入其他恶意组件的风险。

**利用方式：**
1.  **未经身份验证的 RCE：** 攻击者无需任何凭据，可以直接利用该漏洞。
2.  **OGNL 注入：** 漏洞的根源在于 OGNL 表达式注入，通过构造恶意的 OGNL 表达式来执行任意代码。
3.  **命令执行：** 攻击者可以执行系统命令，从而完全控制受影响的服务器。这可能包括安装恶意软件、窃取敏感数据或破坏系统。
4.  **大规模扫描与利用：** 使用 `ConfluentPwn` 等工具，攻击者可以大规模扫描互联网上的 Confluence 服务器，并自动利用该漏洞。

**项目地址:** [redhuntlabs/ConfluentPwn](https://github.com/redhuntlabs/ConfluentPwn)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)