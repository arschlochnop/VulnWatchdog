## CVE-2025-32023-Redis-HyperLogLog-RCE

**漏洞编号:** CVE-2025-32023

**漏洞类型:** 远程代码执行

**影响应用:** Redis

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.8.0 <= version < 6.2.19, 7.0.0 <= version < 7.2.10, 7.4-rc1 <= version < 7.4.5, 8.0.0 <= version < 8.0.3

**利用条件:** 需要已认证的 Redis 用户，且 Redis 实例存在于漏洞影响版本中。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32023 漏洞存在于 Redis 的 HyperLogLog (HLL) 实现中，允许经过身份验证的用户通过构造特殊的字符串触发栈/堆的越界写入，从而可能导致远程代码执行。漏洞影响 Redis 版本 2.8 到 8.0.3 之前的多个版本。漏洞利用方式通常涉及利用 HLL 命令（如 PFADD、PFCOUNT、PFMERGE）处理恶意构造的输入，从而触发整数溢出，导致缓冲区溢出，最终执行任意代码。

**有效性：**
根据漏洞描述，该漏洞影响多个 Redis 版本，且已经有公开的修复补丁。攻击复杂度较高 (LOCAL/HIGH)，需要已认证的用户，但如果利用成功，可以获得服务器的完全控制权。

**投毒风险：**
提供的代码片段是 Apache 2.0 许可协议，不包含任何可执行代码，因此不存在投毒风险。

**利用方式：**
1.  攻击者需要拥有 Redis 实例的有效身份验证凭据。
2.  攻击者构造一个恶意的字符串，该字符串能够触发 HyperLogLog 命令中的整数溢出。
3.  攻击者使用受影响的 HyperLogLog 命令（如 PFADD、PFCOUNT、PFMERGE）将恶意字符串传递给 Redis 服务器。
4.  Redis 服务器在处理恶意字符串时发生整数溢出，导致缓冲区溢出。
5.  攻击者利用缓冲区溢出执行任意代码，从而控制 Redis 服务器。

**项目地址:** [shayantrix/POC-CVE-2025-32023](https://github.com/shayantrix/POC-CVE-2025-32023)

**漏洞详情:** [CVE-2025-32023](https://nvd.nist.gov/vuln/detail/CVE-2025-32023)