## CVE-2024-20767-Adobe ColdFusion-任意文件读取

**漏洞编号:** CVE-2024-20767

**漏洞类型:** 任意文件读取

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2023.6, <= 2021.12

**利用条件:** ColdFusion Admin Panel需要暴露在互联网上, 需要知道UUID

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-20767是Adobe ColdFusion中的一个不当访问控制漏洞，允许未经身份验证的攻击者读取服务器上的任意文件。

**漏洞利用方式：**
1.  首先，攻击者利用`/CFIDE/adminapi/_servermanager/servermanager.cfc?method=getHeartBeat`接口获取UUID，该接口存在权限绕过，可以未授权访问。
2.  然后，攻击者构造恶意请求，通过`/pms?module=logging&file_name=../../../../../../../[file_path]&number_of_lines=100`接口，利用`file_name`参数的路径遍历漏洞读取目标文件。其中`[file_path]`替换为想要读取的文件的路径。
3.  攻击者在请求头中设置`uuid`字段，值为之前获取的UUID。
4.  服务器返回目标文件的内容。

**投毒风险分析：**
查看了提供的python脚本，未发现明显的恶意代码。脚本的主要功能是利用两个接口实现任意文件读取，逻辑清晰。
1%是存在代码同质化的风险，无法完全规避，但是POC代码本身风险较低

**有效性：**
根据漏洞信息和提供的POC代码，该漏洞利用是有效的。漏洞库和搜索结果都表明该漏洞允许任意文件读取，并且POC代码也实现了这一功能。

**项目地址:** [alm6no5/CVE-2024-20767](https://github.com/alm6no5/CVE-2024-20767)

**漏洞详情:** [CVE-2024-20767](https://nvd.nist.gov/vuln/detail/CVE-2024-20767)