## CVE-2025-34085-Simple File List Plugin-RCE

**漏洞编号:** CVE-2025-34085

**漏洞类型:** 远程代码执行

**影响应用:** Simple File List WordPress Plugin

**危害等级:** 高危，未授权的远程攻击者可以执行任意代码。

**影响版本:** < 4.2.3

**利用条件:** 目标网站必须安装Simple File List WordPress插件，且版本低于4.2.3。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-34085是一个存在于Simple File List WordPress插件4.2.3之前版本中的未授权文件上传漏洞，允许远程攻击者执行任意代码。 

**漏洞利用方式：**

1.  攻击者首先上传一个伪装成`.png`文件的PHP payload到`ee-upload-engine.php`。
2.  然后，利用`ee-file-engine.php`的重命名功能将文件扩展名更改为`.php`，绕过上传限制。
3.  最后，访问上传的`.php`文件即可执行任意代码。

**POC分析：**

POC代码通过以下步骤利用此漏洞：

1.  生成一个包含PHP代码的payload，该代码执行通过GET参数传递的命令或直接执行预设命令(取决于INLINE变量)。
2.  使用multipart/form-data将payload作为`.png`文件上传到`ee-upload-engine.php`。
3.  使用`ee-file-engine.php`将上传的文件重命名为`.php`，`.phtml`，`.php5`，或者 `.php3`。
4.  最后，通过GET请求访问重命名后的文件，传递需要执行的命令(如果INLINE为False)，或直接访问(如果INLINE为True)，并打印输出结果。
5.  检查返回的状态码和期望的子字符串，以确认利用是否成功。

**投毒风险分析：**

该POC代码包含一定的投毒风险，主要体现在以下几个方面：

*   **COMMAND变量：** 该变量用于指定要执行的命令。如果攻击者在不知情的情况下直接使用该代码，可能会意外地在目标服务器上执行恶意命令。该值可以通过参数传入，有一定的风险
*   **INLINE变量：** 该变量决定了执行命令的方式。如果设置为`True`，payload会直接执行预设的命令，而不需要通过GET参数传递。这可能会导致payload在上传后立即执行，从而增加风险。
*   **EXPECTED_SUBSTRING变量：**  该变量允许校验命令执行结果中是否包含特定的字符串，从而判断漏洞是否利用成功。如果配置不当，可能会导致误报。
*   **SHELL_PATH变量：** 该变量指定了文件上传目录，如果该目录被修改，可能导致恶意文件被上传到不安全的位置。

虽然上述变量存在潜在的风险，但总体而言，该POC代码的投毒风险较低，因为这些变量主要用于配置和控制漏洞利用过程，而不是直接执行恶意操作。但是，使用者仍然需要谨慎使用，并仔细检查和修改代码，以确保其安全性。

综合来看，考虑到POC代码的结构以及各个变量的用途，判断投毒风险为10%。

**项目地址:** [yukinime/CVE-2025-34085](https://github.com/yukinime/CVE-2025-34085)

**漏洞详情:** [CVE-2025-34085](https://nvd.nist.gov/vuln/detail/CVE-2025-34085)