## CVE-2025-27636-Apache Camel-消息头注入

**漏洞编号:** CVE-2025-27636

**漏洞类型:** 消息头注入/Bean方法调用/JMS队列篡改/RCE

**影响应用:** Apache Camel

**危害等级:** 高危，可能导致远程代码执行和数据泄露

**影响版本:** 4.10.0-4.10.1, 4.8.0-4.8.4, 3.10.0-3.22.3

**利用条件:** 需要应用使用受影响的Camel组件（camel-activemq, camel-activemq6, camel-amqp, camel-aws2-sqs, camel-azure-servicebus, camel-cxf-rest, camel-cxf-soap, camel-http, camel-jetty, camel-jms, camel-kafka, camel-knative, camel-mail, camel-nats, camel-netty-http, camel-platform-http, camel-rest, camel-sjms, camel-spring-rabbitmq, camel-stomp, camel-tahu, camel-undertow, camel-xmpp）并允许外部注入HTTP头。

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-27636是Apache Camel中的一个消息头注入漏洞，影响多个版本。由于默认的消息头过滤器对大小写处理不当，攻击者可以通过构造大小写混合的恶意header绕过过滤，例如使用`CAmelExecCommandExecutable`替代`CamelExecCommandExecutable`。这允许攻击者注入特定的Camel header，从而改变Camel组件的行为。例如，对于camel-bean组件，可以调用应用程序代码中未指定的其他方法；对于camel-jms组件，可以将消息发送到应用程序代码中未指定的其他队列。 更严重的是，结合`camel-exec`组件，可以实现远程代码执行（RCE）。

**利用方式：**

1.  攻击者向目标Camel应用的HTTP端点发送恶意请求。
2.  在HTTP请求头中，构造大小写混合的Camel组件相关的Header，例如`CAmelExecCommandExecutable`，并设置恶意值（例如，要执行的系统命令）。
3.  Camel应用接收到请求后，由于header过滤器的缺陷，未能正确过滤恶意header。
4.  恶意header被传递到相应的Camel组件（如camel-exec），导致执行攻击者指定的命令。

**投毒风险：**

提供的漏洞利用代码（POC）存在较高的投毒风险。尽管POC本身旨在演示漏洞利用，但恶意攻击者可能修改POC，使其包含恶意payload，例如植入后门、窃取敏感信息或进行拒绝服务攻击。 此外，在实际环境中，攻击者可能会结合其他攻击手段，使利用过程更加隐蔽和复杂，增加检测和防御的难度。 因此，使用和传播POC代码时，务必保持高度警惕，并进行充分的安全评估，以防止潜在的投毒攻击。

**项目地址:** [akamai/CVE-2025-27636-Apache-Camel-PoC](https://github.com/akamai/CVE-2025-27636-Apache-Camel-PoC)

**漏洞详情:** [CVE-2025-27636](https://nvd.nist.gov/vuln/detail/CVE-2025-27636)