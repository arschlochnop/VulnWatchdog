## 未识别漏洞-XXX服务器-SQL注入

**漏洞编号:** CVE-2023-49440

**漏洞类型:** SQL注入

**影响应用:** XXX服务器

**危害等级:** 高危，可导致敏感信息泄露，如管理员账号密码。

**影响版本:** 未知，需要根据URL判断。

**利用条件:** 需要知道目标XXX服务器的URL，以及至少一个管理员用户名（POC中需要作为参数）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该POC利用了XXX服务器的SQL注入漏洞。攻击者首先获取加密密钥，然后使用该密钥加密提供的密码，模拟登录过程。成功登录后，通过SQL注入漏洞读取`tb_admin`表中的管理员ID和密码哈希值。 具体利用方式如下：

1. **获取加密密钥：** 通过向`/api/console/ems/conceal`端点发送POST请求，获取服务器用于加密密码的密钥。
2. **密码加密：** 使用获取到的密钥和AES加密算法加密提供的密码。
3. **登录认证：** 向`/api/console/ems/admin/force_login`端点发送POST请求，模拟管理员登录，获取访问令牌（access_token）。
4. **SQL注入：**  构造包含恶意SQL查询的JSON数据，并将其发送到`/api/console/ems/query/report/preview`端点。服务器在处理查询时，由于未正确过滤，执行了恶意SQL查询，从而泄露了`tb_admin`表中的数据。

**关于投毒风险：**

虽然代码的主要功能是利用SQL注入漏洞，但是存在轻微的投毒的可能性，因为代码具有未明确说明的依赖 CryptoJS，且从代码上看使用了硬编码的IV（`<react base64>`），不排除存在其他隐蔽的恶意行为，但整体风险较低，主要集中在依赖项和硬编码上。

**项目地址:** [KernelCipher/CVE-2023-49440-POC](https://github.com/KernelCipher/CVE-2023-49440-POC)

**漏洞详情:** [CVE-2023-49440](https://nvd.nist.gov/vuln/detail/CVE-2023-49440)