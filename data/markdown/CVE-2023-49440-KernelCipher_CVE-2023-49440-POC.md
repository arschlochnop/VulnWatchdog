## CVE-2023-49440-AhnLab EPP Management-SQL注入

**漏洞编号:** CVE-2023-49440

**漏洞类型:** SQL注入

**影响应用:** AhnLab EPP Management

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 1.0.15

**利用条件:** 需要网络访问和有效的Authorization Token

**POC 可用性:** 是，但作者未公开完整的Python脚本

**投毒风险:** 10%

## 详情

CVE-2023-49440是AhnLab EPP Management 1.0.15及之前版本中存在的基于布尔的SQL注入漏洞。该漏洞位于Web管理界面，攻击者可以通过在'preview'、'list'等端点的JSON参数中注入恶意SQL代码来提取敏感信息，甚至可能进一步利用实现远程代码执行。提供的POC代码展示了如何构造恶意的POST请求到`/api/console/ems/query/report/preview`端点，通过修改`params`参数中的SQL查询语句，根据响应结果判断SQL注入是否成功。作者提到不会公开完整的Python脚本，这可能增加了利用的难度。作者只提供了HTTP请求包,需要自行实现发送逻辑。 fixed版本通过SWU-00027错误信息,验证extract_key是否过期,来修复此问题.投毒风险较低，主要因为POC只是HTTP请求示例，需要自己写代码实现，但如果脚本中嵌入了恶意行为，存在一定风险。例如，在payload中写入恶意数据库操作、反弹shell等。

利用方式如下：
1.  构造包含恶意SQL语句的JSON请求体，发送到`/api/console/ems/query/report/preview`端点。
2.  通过分析响应结果，判断SQL注入是否成功。
3.  进一步利用SQL注入，提取敏感信息或执行任意代码。

**项目地址:** [KernelCipher/CVE-2023-49440-POC](https://github.com/KernelCipher/CVE-2023-49440-POC)

**漏洞详情:** [CVE-2023-49440](https://nvd.nist.gov/vuln/detail/CVE-2023-49440)