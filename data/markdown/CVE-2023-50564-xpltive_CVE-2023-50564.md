## CVE-2023-50564-PluckCMS-任意文件上传

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck CMS

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v4.7.18

**利用条件:** 需要Pluck CMS v4.7.18环境，已知管理员密码，网络可访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-50564 是 Pluck CMS v4.7.18 中的一个远程代码执行 (RCE) 漏洞。该漏洞是由于 `/inc/modules_install.php` 组件中存在任意文件上传漏洞，允许攻击者通过上传恶意的 `.zip` 文件来执行任意代码。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，该漏洞利用是有效的。漏洞库信息明确指出存在任意文件上传漏洞，搜索结果也证实了这一点，并提供了多个关于该漏洞的描述、影响和利用方式的链接。漏洞利用代码（`exploit.py`）提供了一个可执行的PoC，通过上传包含恶意 PHP 文件的 ZIP 压缩包，攻击者可以执行任意命令。

**投毒风险评估：**

该仓库中的投毒风险极低。尽管存在恶意文件上传，但其目的是利用漏洞，并非为了进行供应链投毒。漏洞利用代码本身较短，关键逻辑是上传 ZIP 文件并在服务器上执行其中的 PHP 代码。仔细审查代码后，发现 `exploit.py` 只包含漏洞利用相关的代码，没有发现其他恶意行为。因此，投毒风险估计为1%。`import a` 在 `exploit.py` 是无效的,会引发运行异常,应该是作者笔误。

**利用方式分析：**

1.  **身份验证：**  利用脚本需要提供管理员密码，首先需要登录到Pluck CMS后台。
2.  **payload制作:**  创建一个包含恶意 PHP 文件的 ZIP 压缩包。恶意 PHP 文件通常包含执行系统命令的代码，例如 webshell。
3.  **文件上传：**  通过 `/inc/modules_install.php` 组件上传恶意的 ZIP 文件。该组件存在任意文件上传漏洞，允许上传不受限制的文件类型。
4.  **代码执行：**  上传的 ZIP 文件解压后，其中的恶意 PHP 文件会被放置在服务器的 Web 可访问目录下。攻击者可以通过访问该 PHP 文件的 URL，并附加命令参数，来执行任意命令。
5.  **反弹 Shell：**  利用漏洞执行反弹 shell 的命令，从而获得对服务器的控制权。

此漏洞需要有效密码，增加了利用的难度。但是一旦密码泄露或者被破解，该漏洞就能轻易被利用。

**项目地址:** [xpltive/CVE-2023-50564](https://github.com/xpltive/CVE-2023-50564)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)