## CVE-2020-7247-OpenSMTPD-远程代码执行

**漏洞编号:** CVE-2020-7247

**漏洞类型:** 远程代码执行

**影响应用:** OpenSMTPD

**危害等级:** 高危，可能导致root权限下的远程代码执行

**影响版本:** 6.6

**利用条件:** 需要OpenSMTPD服务未修补，默认配置（未注释）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7247 允许远程攻击者通过构造恶意的SMTP会话，利用`MAIL FROM`字段中的shell元字符，以root权限执行任意命令。POC代码通过socket连接到目标主机的25端口（SMTP），发送HELO，MAIL FROM，RCPT TO，DATA和QUIT等SMTP命令。`MAIL FROM`命令中注入了shell命令，通过`for i in 0 1 2 3 4 5 6 7 8 9 a b c d;do read r;done;sh;exit 0;`执行shell。`DATA`命令后发送的`payload`会将用户输入的内容写入指定文件，完成利用。存在投毒风险，代码中写文件的行为，可能可以恶意篡改系统文件，也可能上传webshell，风险概率较低。

**项目地址:** [FiroSolutions/cve-2020-7247-exploit](https://github.com/FiroSolutions/cve-2020-7247-exploit)

**漏洞详情:** [CVE-2020-7247](https://nvd.nist.gov/vuln/detail/CVE-2020-7247)