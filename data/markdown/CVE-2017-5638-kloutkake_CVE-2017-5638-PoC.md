## CVE-2017-5638 Apache Struts 2 远程代码执行

**漏洞编号:** CVE-2017-5638

**漏洞类型:** 远程代码执行

**影响应用:** Apache Struts 2

**危害等级:** 高危，可完全控制受影响的服务器

**影响版本:** 2.3.x (before 2.3.32), 2.5.x (before 2.5.10.1)

**利用条件:** 目标系统运行存在漏洞的Apache Struts 2 版本，并且允许通过HTTP请求上传文件或者处理包含 Content-Type 头的请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-5638 是一个存在于 Apache Struts 2 中的远程代码执行漏洞。该漏洞源于 Jakarta Multipart parser 在处理文件上传请求时，对 Content-Type 头部信息处理不当。攻击者可以通过构造恶意的 Content-Type, Content-Disposition, 或 Content-Length HTTP 头部，执行任意 OGNL 表达式，从而导致远程代码执行。

**有效性：**
根据漏洞描述和提供的PoC代码，该漏洞利用是有效的。PoC代码 `exploit.py` 提供了检测目标是否易受攻击的 `--check` 参数，以及执行任意命令的 `--cmd` 参数。 该漏洞在野外被广泛利用，多个安全厂商发布了相关的分析报告。

**投毒风险：**
虽然提供的PoC代码本身看起来是直接的，但仍存在一定的投毒风险。主要风险点在于：

*   **依赖项：** `requirements.txt` 文件可能包含恶意软件包，安装这些包可能会引入后门或恶意功能。
*   **命令执行：** 即使PoC本身没有直接的恶意代码，但它允许攻击者在目标系统上执行任意命令。攻击者可以通过 `--cmd` 参数传递恶意命令，从而感染系统。

因此，尽管 PoC 代码本身相对简单，但考虑到其潜在的恶意使用方式和对依赖项的信任，存在约10%的投毒风险。

**利用方式：**

1.  **目标确定：** 确定运行存在漏洞的 Apache Struts 2 版本的应用程序。
2.  **漏洞验证：** 使用 PoC 脚本的 `--check` 参数验证目标是否易受攻击。
3.  **命令执行：** 如果目标易受攻击，使用 `--cmd` 参数执行任意命令。攻击者可以使用此命令来获取系统信息、安装后门、或执行其他恶意操作。

总的来说，CVE-2017-5638 是一个严重的安全漏洞，允许远程攻击者完全控制受影响的系统。务必及时更新 Apache Struts 2 到安全版本。

**项目地址:** [kloutkake/CVE-2017-5638-PoC](https://github.com/kloutkake/CVE-2017-5638-PoC)

**漏洞详情:** [CVE-2017-5638](https://nvd.nist.gov/vuln/detail/CVE-2017-5638)