## CVE-2017-9841-PHPUnit-远程代码执行

**漏洞编号:** CVE-2017-9841

**漏洞类型:** 远程代码执行

**影响应用:** PHPUnit

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** PHPUnit before 4.8.28 and 5.x before 5.6.3

**利用条件:** 目标服务器存在暴露的/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php URI，且PHPUnit版本符合漏洞影响范围。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9841 漏洞允许远程攻击者通过 HTTP POST 请求向易受攻击的 PHPUnit 应用发送包含 PHP 代码的恶意数据，从而执行任意 PHP 代码。漏洞存在于 `Util/PHP/eval-stdin.php` 文件中。攻击者需要能够访问该文件，通常位于 `/vendor` 目录下。PoC 代码（`cve_phpunit.sh`）主要用于检测目标系统是否存在受漏洞影响的 PHPUnit 版本，而非直接利用该漏洞进行攻击。它通过扫描文件系统查找 `phpunit/phpunit` 目录并检查 `Version.php` 文件来确定 PHPUnit 的版本。虽然该代码本身不包含投毒内容，但攻击者可以利用该漏洞执行任意 PHP 代码，例如植入后门。 根据漏洞库信息,CISA将此漏洞标记为已知被利用漏洞. 根据搜索结果,观察到CVE-2017-9841的大量扫描活动。

**利用方式：**

1.  **查找目标：** 寻找安装了存在漏洞版本的 PHPUnit 且 `eval-stdin.php` 暴露在外的服务器。
2.  **发送恶意POST请求：**  构造一个 HTTP POST 请求，其中包含以 `<?php ` 开头的 PHP 代码，并将其发送到 `eval-stdin.php` 文件的 URI。
3.  **执行代码：** 服务器将执行 POST 请求中的 PHP 代码。
4.  **检测脚本用途：** 提供的脚本`cve_phpunit.sh` 主要是检测工具，用于判断目标服务器是否存在受影响的phpunit版本，而非漏洞利用。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是有效的，并且已经被广泛利用。提供的检测脚本用于辅助评估，而非直接利用。

**投毒风险评估：**

提供的检测脚本`cve_phpunit.sh` 代码本身是用于检测漏洞存在的，没有发现存在恶意代码或者后门，投毒风险评估为0%。LICENSE和README文件也未见异常。

**项目地址:** [mbrasile/CVE-2017-9841](https://github.com/mbrasile/CVE-2017-9841)

**漏洞详情:** [CVE-2017-9841](https://nvd.nist.gov/vuln/detail/CVE-2017-9841)