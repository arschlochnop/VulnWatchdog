## CVE-2025-31161-CrushFTP-认证绕过

**漏洞编号:** CVE-2025-31161

**漏洞类型:** 认证绕过

**影响应用:** CrushFTP

**危害等级:** 高危，可能导致完全系统权限控制

**影响版本:** 10.0.0 - 10.8.3 和 11.0.0 - 11.3.0

**利用条件:** CrushFTP服务需要通过HTTP(S)协议对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31161 允许未经身份验证的攻击者绕过 CrushFTP 的身份验证，并接管 crushadmin 帐户（除非使用 DMZ 代理实例）。该漏洞利用了 HTTP 组件中 AWS4-HMAC (与 S3 兼容) 授权方法中的竞争条件。服务器首先调用 login_user_pass()，而无需密码，从而验证用户的存在。通过提供带有用户名和后缀斜杠（/）的伪造 AWS4-HMAC 标头，服务器可以成功找到用户名，从而触发 anypass 身份验证过程，但服务器将无法找到预期的 SignedHeaders 条目，从而导致索引越界错误，从而阻止代码到达会话清理。PoC 代码使用带有构造的 `CrushAuth` cookie 和 `Authorization` 标头的 GET 请求，通过 `/WebInterface/function/?command=getUserList&serverGroup=MainUsers` 端点获取用户列表，以证明认证绕过。由于其依赖于标准库并且没有执行任何可疑操作,投毒风险极低。

**项目地址:** [r0otk3r/CVE-2025-31161](https://github.com/r0otk3r/CVE-2025-31161)

**漏洞详情:** [CVE-2025-31161](https://nvd.nist.gov/vuln/detail/CVE-2025-31161)