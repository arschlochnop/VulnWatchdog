## CVE-2025-24201 - WebKit RCE

**漏洞编号:** CVE-2025-24201

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WebKit (Safari, iOS, macOS, visionOS)

**危害等级:** 高危，可导致远程代码执行、权限提升、数据泄露、设备控制甚至砖机

**影响版本:** < iOS 18.3.2, iPadOS 18.3.2, macOS Sequoia 15.3.2, Safari 18.3.1, watchOS 11.4, iPadOS 17.7.6, iOS 16.7.11, iPadOS 16.7.11, iOS 15.8.4, iPadOS 15.8.4, visionOS 2.3.2

**利用条件:** 受害者需要通过iMessage接收并自动处理恶意PNG文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24201 是 WebKit 中的一个越界写入漏洞，由精心制作的 Web 内容触发，可能导致沙箱逃逸。 根据提供的漏洞利用代码报告，此漏洞被用于一个复杂的零点击 RCE 攻击链，通过 iMessage 发送恶意 PNG 文件来利用。该 PNG 文件包含嵌入的 HEIF 有效负载，在 `ATXEncoder` 中触发堆损坏。 成功利用 CVE-2025-24201 后，攻击者可以绕过沙箱，并结合 CVE-2025-24085 (Core Media 权限提升) 来获得内核级别的控制权。 整个攻击链无需用户交互，可以实现持久化控制设备，包括网络劫持、访问密钥链，甚至导致设备砖机。

**有效性评估：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，此漏洞的POC是有效的。搜索引擎结果中也表明此漏洞已经被在实际攻击中使用。

**投毒风险评估：**
  * 代码分析：代码中存在一些修改IODeviceTree，和设置网络代理的动作，理论上存在被投毒的风险。如修改为特定的IP地址等，或者在销毁设备上投毒，但是这种概率非常小，且根据描述主要功能与已知漏洞利用方式相符，初步判断不存在明显的恶意代码。风险度暂定10%。

**漏洞利用方式：**
1.  **恶意PNG创建：** 创建包含嵌入式 HEIF 有效载荷的恶意 PNG 文件。利用 PNG 元数据字段（例如 Subsample，PixelXDimension 和 PixelYDimension）和畸形的 EXIF 来触发堆损坏。
2.  **iMessage 传递：** 通过 iMessage 发送 PNG 文件。`MessagesBlastDoorService` 会自动处理图像。
3.  **WebKit 漏洞利用（CVE-2025-24201）：** HEIF->ASTC 解码器中的 `ATXEncoder` 中的堆损坏触发代码执行，绕过资源查找限制。
4.  **内核操控（CVE-2025-24085）：** 通过 Core Media (mediaplaybackd，codecctl，IOHIDInterface) 进行内核层面的操作，利用堆损坏覆盖关键指针。
5.  **持久化控制：** 通过修改 IODeviceTree 条目来砖机，或者劫持 Wi-Fi 代理，通过 `launchd` 重新启动恶意服务，并篡改 CloudKeychainProxy 来实现持久化控制。

**项目地址:** [5ky9uy/glass-cage-i18-2025-24085-and-cve-2025-24201](https://github.com/5ky9uy/glass-cage-i18-2025-24085-and-cve-2025-24201)

**漏洞详情:** [CVE-2025-24201](https://nvd.nist.gov/vuln/detail/CVE-2025-24201)