## CVE-2019-10743-archiver-Zip Slip

**漏洞编号:** CVE-2019-10743

**漏洞类型:** Zip Slip

**影响应用:** archiver

**危害等级:** 高危，可能导致任意文件写入和远程代码执行

**影响版本:** All versions

**利用条件:** 需要上传zip文件到服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-10743 存在于 archiver 的所有版本中，是一个 Zip Slip 漏洞。攻击者可以上传包含恶意构造的文件名的 ZIP 压缩包，文件名包含路径遍历字符（例如 `../../../../../tmp/hacked.txt`）。当服务器使用受影响的 archiver 库解压该压缩包时，恶意文件将被写入到目标目录之外，可能覆盖系统文件，导致任意文件写入，甚至远程代码执行。

**有效性：**
提供的 POC 代码有效。该代码包含一个 Dockerfile 用于构建包含漏洞的应用程序，一个 README.md 解释了 Zip Slip 漏洞，一个 docker-run.sh 脚本用于启动和停止 Docker 容器，以及一个 test_exploit.py 脚本用于利用该漏洞。

**投毒风险：**
该仓库的投毒风险较低（5%）。虽然存在安全风险，但从提供的代码来看，该漏洞利用代码本身是为了演示漏洞而编写的，其目的是证明 Zip Slip 漏洞的存在，而不是恶意地向系统中植入后门或恶意软件。test_exploit.py脚本会按照指定路径写入内容。

docker-run.sh中存在删除容器和镜像的操作，降低了安全风险。
Dockerfile中创建了非root用户，降低了安全风险。

**利用方式：**
1.  服务器接收 ZIP 文件上传。
2.  服务器使用 `mholt/archiver` 库解压 ZIP 文件。
3.  攻击者构造包含恶意文件名的 ZIP 文件，文件名包含路径遍历字符 (例如：`../../../../../tmp/evil.sh`)。
4.  服务器解压 ZIP 文件时，由于未对文件名进行充分验证，恶意文件被写入到目标目录之外。
5.  如果攻击者覆盖了重要的系统文件或配置文件，可能导致提权、代码执行等严重后果。

攻击者可以通过 HTTP POST 方法上传恶意 ZIP 文件，`test_exploit.py` 脚本可以用于生成包含恶意文件名的 ZIP 文件并发送到服务器。


**项目地址:** [albisorua/PoC-CVE-2019-10743](https://github.com/albisorua/PoC-CVE-2019-10743)

**漏洞详情:** [CVE-2019-10743](https://nvd.nist.gov/vuln/detail/CVE-2019-10743)