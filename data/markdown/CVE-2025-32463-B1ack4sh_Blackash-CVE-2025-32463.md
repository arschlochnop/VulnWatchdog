## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，可使本地用户获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地shell访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 是 Sudo 1.9.14 到 1.9.17 版本中存在的本地权限提升漏洞。该漏洞利用了 `--chroot` (`-R`) 选项，通过操纵 Sudo 处理 `nsswitch.conf` 的方式，允许本地攻击者欺骗 Sudo 加载恶意共享库，从而获得 root 访问权限，即使他们不在 `sudoers` 文件中。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的 PoC 代码，该漏洞是有效的。漏洞利用代码中的 `sudo -R woot woot` 命令尝试在 chroot 环境中使用用户控制的 `nsswitch.conf` 文件，加载恶意的动态链接库，从而执行提权操作。

**投毒风险：**

该仓库存在一定的投毒风险，因为攻击者可能会修改`woot1337.c`文件的内容，植入其他恶意代码，例如反弹shell等。 虽然 `CVE-2025-32463.sh` 脚本本身的功能是利用该漏洞进行提权，但存在以下潜在的投毒场景：

1.  **修改 `woot1337.c`：** 攻击者可以在 `woot1337.c` 中添加额外的恶意代码，这些代码会在提权成功后执行。例如，植入后门、收集敏感信息或进行其他恶意活动。
2.  **替换 `libnss_/woot1337.so.2`：** 攻击者可以提供一个预先编译好的恶意 `libnss_/woot1337.so.2` 文件，该文件包含了恶意代码。
3.  **篡改`CVE-2025-32463.sh`脚本:** 攻击者可能对脚本内容进行修改，在提权之前或之后执行其他的恶意指令，例如删除日志，安装其他后门程序等。

考虑到代码本身已经包含了提权逻辑，而潜在的投毒行为需要额外的代码修改，我们假设投毒的可能性相对较低，约为10%。

**利用方式：**

1.  攻击者首先需要拥有本地 shell 访问权限，即使没有 sudo 权限也可以。
2.  攻击者创建一个包含恶意 `etc/nsswitch.conf` 文件的目录结构 (`woot/etc`)。
3.  `nsswitch.conf` 文件配置 Sudo 使用自定义的名称服务解析方式，指向一个恶意的共享库。
4.  攻击者使用 `sudo -R <目录> <命令>` 命令，其中 `<目录>` 是包含恶意 `nsswitch.conf` 的目录，`<命令>` 可以是任意命令。
5.  Sudo 在 chroot 环境中加载恶意共享库，共享库中的代码被执行，从而实现提权。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-32463](https://github.com/B1ack4sh/Blackash-CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)