## CVE-2024-28000 - LiteSpeed Cache Privilege Escalation

**漏洞编号:** CVE-2024-28000

**漏洞类型:** 权限提升

**影响应用:** LiteSpeed Cache

**危害等级:** 高危，未经身份验证的攻击者可以获得管理员权限

**影响版本:** <= 6.3.0.1

**利用条件:** 目标网站安装并启用了受影响版本的LiteSpeed Cache插件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28000是LiteSpeed Cache WordPress插件中的一个不正确的权限分配漏洞，允许未经身份验证的攻击者提升权限。根据漏洞库信息，该漏洞影响1.9到6.3.0.1版本。搜索引擎结果显示，存在多个关于此漏洞的分析和利用文章，以及公开可用的PoC代码。提供的C# PoC代码尝试利用该漏洞，通过爆破哈希来修改用户密码，从而提升权限。 

**有效性：**
根据搜索结果和提供的PoC代码，可以判断此漏洞利用具有较高的有效性。多个来源都证实了该漏洞的存在以及成功利用的可能性。

**投毒风险：**
PoC代码主要功能是：
1.  检查目标网站是否安装并启用LiteSpeed Cache插件 (通过检查X-LiteSpeed-Tag Header)。
2.  检测LiteSpeed Cache插件的版本，如果版本>=6.4，则退出。
3.  根据提供的用户ID，暴力破解用户密码的哈希值。
4.  利用破解的密码，修改wordpress用户密码，从而提升权限。

代码中可能存在的潜在投毒风险主要集中在以下几个方面：
*   **硬编码的参数：** 代码中存在硬编码的REST API endpoint和AJAX endpoint，这些参数如果被修改指向恶意服务器，可能导致信息泄露或者执行恶意操作。但本次提供的代码中,这些参数均为wordpress的正常接口,故不属于投毒。
*   **恶意依赖：** 虽然PoC只使用了Newtonsoft.Json，但攻击者可以添加恶意的NuGet包，这些包可能包含恶意代码，在编译时被引入。
*   **后门代码：** 作者可能在代码中添加隐藏的后门，例如收集用户信息、植入恶意脚本等。需要仔细审查代码，查找可疑的函数调用或逻辑。

综合分析，该仓库中存在作者隐藏的投毒代码的可能性较低，但不能完全排除。由于PoC代码功能相对简单，主要依赖于已知的漏洞利用，因此额外的恶意代码不太容易隐藏。但是，仍然需要进行代码审计，以确认是否存在潜在的风险。预估投毒风险为10%。

**利用方式：**
1.  **检查目标：** 使用PoC检查目标网站是否运行受影响版本的LiteSpeed Cache插件。
2.  **暴力破解哈希：** 如果目标存在漏洞，PoC尝试通过暴力破解用户密码的哈希值。
3.  **修改密码：** 成功破解哈希后，PoC利用破解的密码修改指定用户的密码（默认为管理员用户ID 1）。
4.  **权限提升：** 通过修改管理员密码，攻击者可以登录到WordPress后台并获得管理员权限。

**项目地址:** [ebrasha/CVE-2024-28000](https://github.com/ebrasha/CVE-2024-28000)

**漏洞详情:** [CVE-2024-28000](https://nvd.nist.gov/vuln/detail/CVE-2024-28000)