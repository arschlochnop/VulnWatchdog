## CVE-2025-22224-VMware-TOCTOU-Out-of-bounds Write

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU Out-of-bounds Write

**影响应用:** VMware ESXi, Workstation

**危害等级:** 高危，可执行代码，权限提升

**影响版本:** ESXi 8.0, 7.0, Workstation 17.x

**利用条件:** 虚拟机本地管理员权限

**POC 可用性:** 是

**投毒风险:** 70%

## 详情

CVE-2025-22224是VMware ESXi和Workstation中的一个TOCTOU（Time-of-Check Time-of-Use）漏洞，导致越界写入。拥有虚拟机本地管理员权限的恶意行为者可以利用此问题，以在主机上运行的虚拟机的VMX进程身份执行代码。

**有效性：**根据漏洞库信息和搜索引擎结果，漏洞影响VMware ESXi和Workstation的多个版本，并已被CISA添加到已知被利用漏洞列表中，表明该漏洞具有实际的利用价值。

**投毒风险：**提供的漏洞利用代码实际上只是一个包含README.md文件的仓库，真正的利用代码托管在 `https://tinyurl.com/34h77mfz` 上。这是一个短链接，增加了潜在的风险。如果该链接指向的payload被篡改，攻击者可能下载并执行恶意代码，从而被投毒。因此，仓库本身是安全的，但下载链接可能包含投毒风险，考虑到短链接的不可信性，投毒风险较高，估计为70%。

**利用方式：**该漏洞是TOCTOU漏洞，发生在检查和使用资源之间。攻击者利用虚拟机中的本地管理员权限，通过修改资源状态（可能涉及竞态条件），导致VMX进程发生越界写入，最终在主机上执行恶意代码，实现权限提升和控制。

**项目地址:** [bronsoneaver/CVE-2025-22224](https://github.com/bronsoneaver/CVE-2025-22224)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)