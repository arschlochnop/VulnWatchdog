## CVE-2025-5054-Apport-信息泄露

**漏洞编号:** CVE-2025-5054

**漏洞类型:** 信息泄露

**影响应用:** Apport

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** <= 2.32.0

**利用条件:** 本地用户，需要触发Apport的崩溃处理机制，并利用PID复用竞争条件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5054是Canonical Apport中的一个竞争条件漏洞，影响版本至2.32.0。本地攻击者可以通过PID复用利用命名空间泄露敏感信息。

**有效性：**
根据漏洞信息和搜索结果，该漏洞存在POC，且已被公开，因此漏洞利用是有效的。Qualys TRU发现了该漏洞，并提供了PoC。

**投毒风险：**
提供的漏洞利用代码是一个检测脚本，用于检测系统是否受CVE-2025-5054漏洞影响。它主要检查操作系统版本、Apport版本、core dump配置、suid_dumpable设置以及是否存在SUID/SGID的unix_chkpwd等。该脚本本身没有发现明显的恶意代码，只是用于检测，因此投毒风险较低，约5%。风险主要在于如果用户从不可信的来源下载并运行此脚本，可能会存在一定的风险，但是从代码本身来看，没有发现恶意行为。

**利用方式：**
1.  利用该漏洞的先决条件是目标系统上运行着受影响版本的Apport。
2.  攻击者需要触发一个进程崩溃，导致Apport启动崩溃处理程序。
3.  攻击者需要迅速地用一个容器化的进程替换掉崩溃的进程，并复用相同的PID。这一步是竞争条件的关键。
4.  由于Apport在`_check_global_pid_and_forward` 函数之前没有进行充分的`consistency_checks`，它可能会错误地将核心转储转发到新容器中。
5.  核心转储包含敏感信息，攻击者可以利用这些信息。

**项目地址:** [daryllundy/cve-2025-5054](https://github.com/daryllundy/cve-2025-5054)

**漏洞详情:** [CVE-2025-5054](https://nvd.nist.gov/vuln/detail/CVE-2025-5054)