## CVE-2025-31324-SAP NetWeaver Visual Composer-未授权文件上传

**漏洞编号:** CVE-2025-31324

**漏洞类型:** 未授权文件上传

**影响应用:** SAP NetWeaver Visual Composer (Visual Composer development server)

**危害等级:** 高危，允许未授权用户上传恶意文件，可能导致远程代码执行

**影响版本:** VCFRAMEWORK 7.50

**利用条件:** 目标系统运行受影响的SAP NetWeaver Visual Composer版本，且Metadata Uploader组件对外开放

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-31324是SAP NetWeaver Visual Composer中Metadata Uploader组件的一个未授权文件上传漏洞。由于缺乏适当的权限验证，攻击者无需身份验证即可上传恶意文件，例如webshell或其他可执行文件，从而可能导致远程代码执行，严重威胁系统的保密性、完整性和可用性。

**有效性分析:**

根据漏洞库信息、搜索引擎结果和提供的Nuclei模板，该漏洞是有效的，并且存在活跃的利用。

提供的Nuclei模板 `cve-2025-31324-validation.yaml`  尝试通过POST请求上传包含命令注入的payload到`/vulnerable_endpoint`。通过检查响应中是否存在`nuclei-pwned`字符串来验证漏洞是否存在。

**投毒风险分析:**

Nuclei模板的功能是检测漏洞的存在，本身不包含任何恶意代码。模板通过发送包含命令注入的请求并验证响应来判断漏洞是否存在。风险主要在于未经授权访问和滥用目标系统中存在的漏洞，利用该漏洞上传恶意文件进行攻击。

文件读我中只包含使用说明，不存在投毒的可能。

**利用方式分析:**

1.  **确定目标：**  确定运行受影响的SAP NetWeaver Visual Composer版本的系统。漏洞影响版本为VCFRAMEWORK 7.50。
2.  **构造恶意请求：**  构造包含恶意payload的POST请求，payload包含命令注入代码。根据nuclei模板，请求发送到`/vulnerable_endpoint`，并使用`application/x-www-form-urlencoded`格式传递payload，例如 `input=test; echo nuclei-pwned`。
3.  **上传恶意文件：** 利用未经授权的文件上传漏洞上传webshell或其他恶意可执行文件。具体上传接口和参数需要根据实际环境确定，因为YAML配置中使用了`vulnerable_endpoint`作为示例，可能需要手动更改成实际的接口地址
4.  **执行恶意代码：**  成功上传恶意文件后，通过访问该文件来执行其中的恶意代码，从而控制目标系统。

**排序优先级:**

优先级顺序: 搜索引擎结果 >  漏洞利用代码 > 漏洞库信息

*   搜索引擎结果表明该漏洞已被积极利用，并有多个安全厂商发出警告，表明漏洞的严重性和紧迫性。
*   漏洞利用代码提供了验证和利用漏洞的技术细节，但具体实现可能需要根据实际环境进行调整。
*   漏洞库信息提供了漏洞的基本描述和CVSS评分，但相对搜索引擎结果和漏洞利用代码，信息的实时性和实用性较低。

**项目地址:** [moften/CVE-2025-31324-NUCLEI](https://github.com/moften/CVE-2025-31324-NUCLEI)

**漏洞详情:** [CVE-2025-31324](https://nvd.nist.gov/vuln/detail/CVE-2025-31324)