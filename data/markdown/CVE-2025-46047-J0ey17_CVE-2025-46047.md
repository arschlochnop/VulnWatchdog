## CVE-2025-46047 - Silverpeas Username Enumeration

**漏洞编号:** CVE-2025-46047

**漏洞类型:** 用户名枚举

**影响应用:** Silverpeas

**危害等级:** 低危，可能为进一步攻击提供信息

**影响版本:** <= 6.4.2

**利用条件:** 需要网络访问Silverpeas的ForgotPassword功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Silverpeas 6.4.2及更早版本的忘记密码功能中。攻击者可以通过向`/silverpeas/CredentialsServlet/ForgotPassword`端点发送带有潜在用户名作为`Login`参数的POST请求，并观察服务器返回的HTTP状态码（200 OK表示有效用户，302 Found表示无效用户）。这种差异允许未认证的远程攻击者枚举系统上有效的用户名。

**漏洞利用方式：**

1.  攻击者发送POST请求到`/silverpeas/CredentialsServlet/ForgotPassword`端点。
2.  请求中包含`Login`参数，其值为待测试的用户名。
3.  服务器返回HTTP状态码：
    *   200 OK：表示用户名可能有效。
    *   302 Found：表示用户名无效。
4.  攻击者根据HTTP状态码判断用户名的有效性，从而枚举有效的用户名。

**投毒风险分析：**

查看了提供的LICENSE文件，未发现明显的恶意代码。README.md文件描述了漏洞和PoC的使用方法，但没有发现任何隐藏的、非预期的操作。`silverpeas_enum_poc.py`脚本的主要功能是发送HTTP请求并分析响应，也没有直接执行恶意操作的代码。

但是，存在以下潜在的投毒风险：

1.  **依赖包风险：**脚本依赖`requests`库。如果攻击者能够控制用户安装的`requests`库，则可以植入恶意代码。这个风险并不特定于此PoC，而是Python项目普遍存在的风险。

2.  **目标URL欺骗：**攻击者可能通过某种方式诱使用户修改目标URL，使其指向攻击者控制的服务器。然后，攻击者可以记录用户尝试枚举的用户名，或者返回误导性的HTTP状态码，从而误导用户。

3. **脚本篡改:** 攻击者可能篡改脚本，例如添加额外的HTTP请求、记录用户信息等。

虽然存在上述风险，但这些风险并非此PoC特有的，并且可以通过安全编程实践（例如，校验目标URL、使用虚拟环境等）来降低。总的来说，此PoC的投毒风险较低，大概在5%左右。

**项目地址:** [J0ey17/CVE-2025-46047](https://github.com/J0ey17/CVE-2025-46047)

**漏洞详情:** [CVE-2025-46047](https://nvd.nist.gov/vuln/detail/CVE-2025-46047)