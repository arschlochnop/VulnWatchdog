## CVE-2023-7028 - GitLab Account Takeover via Password Reset

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab CE/EE

**危害等级:** 严重，可能导致账户完全控制，数据泄露，代码篡改等

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例的版本在受影响范围内，且可以访问忘记密码重置页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028 允许攻击者通过在密码重置请求中提供多个电子邮件地址，将重置邮件发送到未经授权的电子邮件地址。该漏洞存在于GitLab CE/EE 的密码重置功能中。攻击者可以利用此漏洞，控制其他用户的账户，包括管理员账户。

**利用方式：**

1.  访问GitLab实例的密码重置页面。
2.  在电子邮件输入字段中，提供目标用户的电子邮件地址以及攻击者控制的电子邮件地址。
3.  提交密码重置请求。
4.  GitLab会将密码重置链接发送到两个电子邮件地址，攻击者可以点击发送到其邮箱的链接来重置目标用户的密码。

**POC有效性：**

提供的POC脚本 `cve-2023-7028.sh` 通过构造包含多个 email 参数的 POST 请求到 `/users/password` 路径来触发漏洞。脚本首先获取 CSRF token 和 session cookie, 然后使用 curl 发送包含两个 email 地址的请求。
根据漏洞描述和搜索引擎结果，该POC是有效的。

**投毒风险分析：**

查看了提供的README.md和cve-2023-7028.sh脚本。

*   `README.md` 提供了漏洞描述，复现步骤和修复建议。
*   `cve-2023-7028.sh` 脚本的功能是利用 curl 发送构造的恶意请求，未发现任何隐藏的恶意代码。

因此，判断此仓库中不存在作者隐藏的投毒代码的概率为100%。

**项目地址:** [duy-31/CVE-2023-7028](https://github.com/duy-31/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)