## CVE-2017-10004

**漏洞编号:** CVE-2017-10004

**漏洞类型:** Solaris Kernel Takeover

**影响应用:** Solaris Operating System

**危害等级:** 高危，可完全控制Solaris系统

**影响版本:** 10 和 11

**利用条件:** 需要具有高权限的用户登录Solaris系统

**POC 可用性:** 是，但提供的代码是另一个漏洞(CVE-2017-1000486)的POC，不适用于CVE-2017-10004

**投毒风险:** 20%

## 详情

CVE-2017-10004是Oracle Sun Systems Products Suite中Solaris组件（子组件：内核）中的一个漏洞。受影响的版本为10和11。具有高权限的攻击者如果能够登录到Solaris系统，就可以利用此漏洞完全控制Solaris系统。CVSS 3.0基本得分6.7（保密性、完整性和可用性影响均为高）。根据CVE的描述，利用方式是高权限用户本地提权。

提供的POC代码实际上是CVE-2017-1000486漏洞的利用代码，该漏洞是关于Primefaces RCE的，利用了EL表达式注入和Padding Oracle攻击。该POC尝试绕过黑名单机制，执行任意命令，并通过Padding Oracle获取Primefaces secret。虽然POC本身描述得很详细，但与CVE-2017-10004漏洞无关。

**有效性评估：**
由于提供的POC代码针对的是CVE-2017-1000486，因此对于CVE-2017-10004是无效的。

**投毒风险评估：**
代码中存在一定的投毒风险，约为20%。虽然代码的主要目的是为了利用Primefaces RCE，但其中包含了一些模糊处理和利用技巧，例如尝试绕过黑名单的payload。 这些技术可能会被用于在其他环境中执行恶意操作，比如在绕过WAF策略之后执行RCE。

**利用方式：**
CVE-2017-10004漏洞的利用方式是，高权限攻击者需要登录Solaris系统，然后利用内核中的漏洞实现提权，最终完全控制系统。

**总结：**
虽然提供了POC代码，但它与CVE-2017-10004漏洞无关。POC代码针对的是Primefaces的RCE漏洞（CVE-2017-1000486），涉及EL表达式注入和Padding Oracle攻击。CVE-2017-10004需要高权限本地用户进行利用。

**项目地址:** [Pastea/CVE-2017-1000486](https://github.com/Pastea/CVE-2017-1000486)

**漏洞详情:** [CVE-2017-10004](https://nvd.nist.gov/vuln/detail/CVE-2017-10004)