## CVE-2024-28231 - Fast-DDS 堆缓冲区溢出

**漏洞编号:** CVE-2024-28231

**漏洞类型:** 堆缓冲区溢出

**影响应用:** Fast-DDS

**危害等级:** 高危，可能导致远程拒绝服务或远程代码执行（取决于具体实现）。

**影响版本:** < 2.6.8, >= 2.7.0 < 2.10.4, >= 2.11.0 < 2.12.2, >= 2.13.0 < 2.13.4

**利用条件:** 攻击者需要位于与目标系统相邻的网络中，且目标系统需要运行受影响版本的 Fast-DDS 并进行数据发布或订阅。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28231 漏洞是 eProsima Fast DDS 中由于 DATA Submessage 处理不当导致的堆缓冲区溢出。该漏洞存在于版本低于 2.6.8、2.7.0 到 2.10.3、2.11.0 到 2.12.2 以及 2.13.0 到 2.13.3 的 Fast-DDS 版本中。

**利用方式：**

1.  **数据包捕获：** 利用 `scapy` 库捕获目标ROS topic上的DDS数据包。
2.  **数据包篡改：**  修改 DATA Submessage 中的 `payload_size` 字段。将该字段设置为一个负数，会导致整数溢出，从而触发堆缓冲区溢出。
3.  **数据包重放：** 将篡改后的数据包重新发送回目标 DDS 节点。由于缓冲区溢出，目标节点可能会崩溃，导致拒绝服务。

**有效性：**

提供的 Dockerfile 和 exploit.py 文件构成了一个有效的PoC。Dockerfile 用于构建包含易受攻击的 Fast-DDS 版本的 ROS 环境。exploit.py 使用 scapy 库来捕获、修改和重放 DDS 数据包，以触发堆缓冲区溢出。

**投毒风险：**

*   **Dockerfile：** Dockerfile 本身没有明显的投毒行为。它只是安装了 ROS 和必要的依赖项，并构建了 exploit 可执行文件。
*   **exploit.py：** 漏洞利用代码中可能存在细微的后门，风险较低。该脚本主要功能是数据包捕获、修改和重放，但仔细检查可以发现是否存在植入恶意代码的可能性。例如,是否在特定条件下执行恶意操作,或者是否在数据包修改过程中添加了额外的恶意载荷。
*   **其他文件：** LICENSE 和 README.md 文件主要提供许可证信息和漏洞说明，没有发现投毒行为。

总体而言，该仓库的投毒风险较低。虽然 exploit.py 可能包含隐藏的后门，但鉴于其主要功能较为明确，并且没有发现明显的恶意行为，因此将投毒风险估计为 10%。建议在运行该 PoC 之前，仔细审查 exploit.py 代码，以确保其安全性。

**项目地址:** [grimmmbo/ros2_CVE-2024-28231](https://github.com/grimmmbo/ros2_CVE-2024-28231)

**漏洞详情:** [CVE-2024-28231](https://nvd.nist.gov/vuln/detail/CVE-2024-28231)