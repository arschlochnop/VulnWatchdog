## CVE-2025-29927-Next.js-授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据和操作

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用使用了Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 是 Next.js 中间件的授权绕过漏洞。根据漏洞描述，如果授权检查发生在中间件中，则可能被绕过。漏洞根源在于 Next.js 处理 `x-middleware-subrequest` header 的方式存在缺陷。攻击者可以利用该 header 绕过中间件的身份验证。

**有效性:**

根据漏洞信息和搜索结果，漏洞利用的有效性较高。多个安全厂商（如Rapid7, JFrog, Picus Security, TrueSec, Strobes, UpGuard, SocPrime）的博客都提到了该漏洞，并描述了利用方法。漏洞利用的关键在于构造包含 `x-middleware-subrequest` header 的请求。

**投毒风险:**

提供的漏洞利用代码主要是一个标准的Next.js项目模板，包含了 `README.md`, `jsconfig.json`, `next.config.mjs`, 和 `package-lock.json` 等文件。`package-lock.json` 文件显示项目依赖的 Next.js 版本为 15.2.2，这是一个受漏洞影响的版本。但是，从提供的代码来看，并没有发现明显的恶意代码，例如下载和执行任意脚本等。虽然`package-lock.json` 中可能存在供应链攻击的风险，但从提供的文件内容本身来看，直接投毒的可能性较低。漏洞利用代码本身倾向于验证漏洞的存在，而非实施恶意行为，因此投毒风险较低，估计在10%左右。

**利用方式:**

1.  目标应用使用 Next.js 并且授权检查逻辑位于中间件中。
2.  攻击者发送 HTTP 请求，并在请求中包含 `x-middleware-subrequest` header。
3.  由于 Next.js 对该 header 的处理存在缺陷，中间件的授权检查被绕过。
4.  攻击者未经授权访问受保护的资源或执行受限操作。

**缓解措施:**

*   升级 Next.js 到 14.2.25 或 15.2.3 及以上版本。
*   如果无法升级，阻止包含 `x-middleware-subrequest` header 的外部用户请求到达 Next.js 应用。

**项目地址:** [Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927](https://github.com/Naveen-005/Next.Js-middleware-bypass-vulnerability-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)