## CVE-2024-43018-Piwigo-SQL注入

**漏洞编号:** CVE-2024-43018

**漏洞类型:** SQL注入

**影响应用:** Piwigo

**危害等级:** 高危，可能导致信息泄露和代码执行

**影响版本:** <= 13.8.0

**利用条件:** 需要访问Piwigo管理页面，通常需要管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-43018 存在于 Piwigo 13.8.0 及以下版本中，攻击者可以通过 `admin.php?page=user_list` 页面的 `max_level` 和 `min_register` 参数进行 SQL 注入攻击。这些参数在 `include\ws_functions\pwg.users.php` 文件的 `ws_user_gerList` 函数中使用，该函数被 `ws.php` 调用，用于在 `/admin.php?page=user_list` 页面进行高级用户搜索。 

**漏洞有效性：**
提供的PoC代码通过在 `max_level` 和 `min_register` 参数中注入单引号来触发 SQL 错误，证明了漏洞的存在。

**投毒风险：**
该漏洞利用代码本身主要包含漏洞描述和验证步骤，风险较低。仓库主要包含漏洞验证的步骤和截图, 存在一定风险，但可能性较低。因此，投毒风险评估为5%。

**利用方式：**
1.  访问 `HOST/admin.php?page=user_list` 页面。
2.  通过 Burp Suite 或其他工具拦截请求。
3.  修改 `max_level` 和 `min_register` 参数，注入 SQL 恶意代码，例如添加单引号 `'` 触发错误，或执行其他 SQL 注入攻击。
4.  发送修改后的请求，观察服务器响应，确认 SQL 注入是否成功。
5.  进一步利用 SQL 注入漏洞，例如提取数据库信息或执行恶意代码。

**项目地址:** [joaosilva21/CVE-2024-43018](https://github.com/joaosilva21/CVE-2024-43018)

**漏洞详情:** [CVE-2024-43018](https://nvd.nist.gov/vuln/detail/CVE-2024-43018)