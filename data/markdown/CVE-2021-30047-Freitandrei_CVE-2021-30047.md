## CVE-2021-30047 - VSFTPD 3.0.3 DoS

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** VSFTPD

**危害等级:** 高危，可能导致服务中断

**影响版本:** 3.0.3

**利用条件:** 需要网络可达性，目标FTP服务运行在3.0.3版本。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 VSFTPD 3.0.3 版本中，由于允许的连接数有限，攻击者可以通过建立大量的 FTP 连接来耗尽服务器资源，从而导致拒绝服务。利用方式是通过编写脚本 (如提供的 Python 脚本) 快速建立大量到目标 FTP 服务器的连接。 

**有效性评估：**

提供的PoC代码看起来是有效的。它使用 Python 编写，利用 `subprocess.Popen` 来并发创建多个 FTP 连接。代码包含测试连接可用性的函数以及超时机制，可以有效防止攻击无限进行。

**投毒风险分析：**

PoC 代码本身执行的是 DoS 攻击，其目的是使目标服务器崩溃，而不是植入后门或执行恶意代码。 脚本的主要功能集中于建立和管理 FTP 连接，没有发现明显的恶意代码或后门。 然而，由于 `subprocess.Popen(f"ftp {alvo} {porta}", shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)` 使用了 `shell=True`，这存在一定的命令注入风险，尽管实际利用难度较高。攻击者如果能够控制 `alvo` 和 `porta` 变量，理论上可能执行任意命令。但这通常需要配合其他漏洞才能实现，因此将其判定为投毒的可能性较低，约为5%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行 VSFTPD 3.0.3 版本的 FTP 服务器。
2.  **运行 PoC：** 使用提供的 Python 脚本，指定目标服务器的 IP 地址和端口，以及最大连接数。
3.  **发起攻击：** 脚本会尝试建立指定数量的 FTP 连接，耗尽服务器资源。
4.  **结果：** 目标 FTP 服务器因为无法处理大量的连接请求而变得缓慢或崩溃，从而实现拒绝服务攻击。

**项目地址:** [Freitandrei/CVE-2021-30047](https://github.com/Freitandrei/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)