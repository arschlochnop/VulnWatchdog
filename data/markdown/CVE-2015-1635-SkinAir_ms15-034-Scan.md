## CVE-2015-1635-HTTP.sys远程代码执行漏洞

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft HTTP.sys

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2

**利用条件:** 目标系统运行存在漏洞的HTTP.sys服务，且攻击者可以发送HTTP请求到该服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Microsoft Windows的HTTP.sys组件中，允许远程攻击者通过特制的HTTP请求执行任意代码。提供的PoC代码是一个Python脚本（ms-socket.py），用于扫描目标是否存在MS15-034漏洞。它首先发送一个普通的HTTP请求来检查目标是否运行IIS服务器。如果确认是IIS服务器，则发送一个包含畸形Range头的HTTP请求。如果目标服务器返回“Requested Range Not Satisfiable”错误，则表示目标存在MS15-034漏洞。PoC通过读取url.txt文件，批量检测URL是否存在漏洞，并将结果写入result.txt。

**有效性：**根据漏洞库信息和提供的PoC代码，该漏洞是真实存在的，并且存在公开可用的PoC。该PoC通过发送包含特殊 Range 头的 HTTP 请求来触发漏洞，检测目标是否存在漏洞。

**投毒风险：**代码整体逻辑较为简单，主要功能是发送特定的HTTP请求并根据响应判断漏洞是否存在。但是，PoC脚本从`url.txt`读取目标URL，存在被替换`url.txt`文件，将扫描目标指向恶意服务器的风险，以及攻击者可能修改`result.txt`文件中的结果，误导用户。还存在被供应链投毒的风险，如被篡改用于扫描的IP地址列表等，因此判断投毒风险为10%。

**利用方式：**
1.  攻击者准备一个包含目标URL列表的url.txt文件。
2.  运行PoC脚本`python3 ms-socket.py url.txt`。
3.  脚本会读取url.txt中的URL，并向每个URL发送特制的HTTP请求。
4.  根据服务器的响应，判断目标是否存在MS15-034漏洞。
5.  如果目标存在漏洞，PoC脚本会将URL写入result.txt文件。

**项目地址:** [SkinAir/ms15-034-Scan](https://github.com/SkinAir/ms15-034-Scan)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)