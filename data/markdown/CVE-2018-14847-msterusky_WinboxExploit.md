## CVE-2018-14847-MikroTik RouterOS-目录遍历

**漏洞编号:** CVE-2018-14847

**漏洞类型:** 目录遍历

**影响应用:** MikroTik RouterOS

**危害等级:** 高危，可能导致敏感信息泄露或任意文件读写

**影响版本:** <= 6.42

**利用条件:** 需要网络访问Winbox接口，未授权或已授权用户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-14847是一个存在于MikroTik RouterOS 6.42及更早版本中的目录遍历漏洞。攻击者可以利用Winbox接口中的缺陷，未经授权读取任意文件，或者在已授权的情况下写入任意文件。根据漏洞库信息，该漏洞的CVSS v3.1评分为9.1，属于高危漏洞。

**有效性：**

漏洞库信息和搜索引擎结果均表明该漏洞存在，并且有公开的PoC代码可用。提供的漏洞利用代码（MST.MikroTik.WinboxExploit.sln）是一个Visual Studio解决方案，包含一个用于利用该漏洞的C#项目。 README.md 表明此项目是基于 [https://github.com/BasuCert/WinboxPoC] 的重新实现。综合来看，该漏洞利用代码的有效性较高。

**投毒风险：**

提供的代码仓库中包含以下文件：

*   .sln文件：Visual Studio解决方案文件
*   README.md：说明文件，描述了漏洞利用方式和代码来源
*   .csproj文件：C#项目文件
*   .xaml和.xaml.cs文件：WPF界面相关文件
*   App.config: 配置文件

由于代码是基于公开的PoC进行重新实现的，并且包含WPF界面，需要编译执行。存在一定投毒风险，但可能性较低。主要风险点在于编译后的二进制文件中可能被植入恶意代码。考虑到代码结构和来源，以及代码量，投毒的可能性评估为10%。

**利用方式：**

根据漏洞描述和搜索结果，该漏洞的利用方式如下：

1.  攻击者通过Winbox接口发送特制的请求，其中包含目录遍历payload。
2.  对于未授权的远程攻击者，可以利用该漏洞读取任意文件，获取敏感信息，如用户名、密码等。
3.  对于已授权的远程攻击者，可以利用该漏洞写入任意文件，例如，上传恶意脚本并执行，从而获取设备的控制权。或者修改配置信息。
4.  漏洞利用通常涉及构造包含“../”序列的路径，以突破目录限制，访问受限文件。

总而言之，该漏洞是一个严重的安全问题，可能导致敏感信息泄露和设备控制。建议尽快升级到最新版本，以修复该漏洞。

**项目地址:** [msterusky/WinboxExploit](https://github.com/msterusky/WinboxExploit)

**漏洞详情:** [CVE-2018-14847](https://nvd.nist.gov/vuln/detail/CVE-2018-14847)