## CVE-2025-4334-Simple User Registration-权限提升

**漏洞编号:** CVE-2025-4334

**漏洞类型:** 权限提升

**影响应用:** Simple User Registration (WordPress 插件)

**危害等级:** 高危，允许未经身份验证的攻击者注册为管理员

**影响版本:** <= 6.3

**利用条件:** 目标WordPress站点安装了受影响版本的Simple User Registration插件，且允许用户注册

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Simple User Registration插件中，由于对注册过程中提供的用户元数据值的限制不足，未经身份验证的攻击者可以通过发送特制的注册请求，将新注册用户的角色设置为管理员，从而获得管理员权限。

**漏洞利用方式：**

1.  攻击者首先访问包含注册表单的页面，并从中提取`wpr_nonce`和`wpr_form_id`。
2.  攻击者构造一个POST请求发送到`wp-admin/admin-ajax.php`，`action`参数设置为`wpr_submit_form`。
3.  请求体中包含`wpr_form_id`、`wpr_nonce`、`_wp_http_referer`以及包含恶意用户数据的`wpr[wp_field]`字段。
4.  `wpr[wp_field][role]`设置为`administrator`。
5.  服务器在处理注册请求时，没有充分验证`wpr[wp_field][role]`的值，导致新的用户被创建为管理员。

**有效性评估：**
根据提供的漏洞信息和利用代码，此漏洞利用的有效性较高。该POC代码能够自动提取所需参数，并构造包含恶意数据的POST请求。

**投毒风险评估：**
分析POC代码，未发现明显的投毒代码。代码功能明确，即利用漏洞提升权限。虽然代码中存在 `verify=False` 关闭了SSL证书验证，但这是为了方便测试，并不是恶意行为。所以投毒风险评估为0%。

**项目地址:** [vinodwick/CVE-2025-4334](https://github.com/vinodwick/CVE-2025-4334)

**漏洞详情:** [CVE-2025-4334](https://nvd.nist.gov/vuln/detail/CVE-2025-4334)