## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要目标系统运行Webmin，并可通过网络访问 password_change.cgi 页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107 是 Webmin 1.920 及更早版本中的一个命令注入漏洞。该漏洞存在于 `password_change.cgi` 文件的 `old` 参数（以及PoC中使用的`expired`参数）。未经身份验证的攻击者可以通过向该页面发送特制的 HTTP POST 请求，在服务器上执行任意命令。

**有效性:**
提供的 PoC 代码是有效的。它通过向 `/password_change.cgi` 发送包含恶意命令的 POST 请求，利用 `expired` 参数的命令注入漏洞来执行系统命令。PoC 包含漏洞检查和利用部分。检查部分发送 `expired=id`，如果响应包含 `uid=`，则表示存在漏洞。利用部分允许用户选择预定义的命令，或输入自定义命令执行。

**投毒风险:**
分析 PoC 代码，没有发现明显的投毒代码。代码的主要功能是利用漏洞执行命令，没有发现作者植入后门或恶意行为的迹象。

**利用方式:**
1.  攻击者确定目标系统是否运行易受攻击的 Webmin 版本（<= 1.920）。
2.  攻击者构造一个包含恶意命令的 HTTP POST 请求，将命令注入到 `password_change.cgi` 的 `expired` 参数中。
3.  攻击者将请求发送到目标 Webmin 服务器。
4.  Webmin 服务器执行注入的命令。
5.  攻击者从响应中获取命令的输出。PoC中会解析`<p>`标签来获取命令执行结果.如果不存在则全部显示。

总而言之，提供的 PoC 代码是有效的，并且未发现投毒风险。漏洞利用方式是通过向 `password_change.cgi` 的 `expired` 参数发送包含恶意命令的 HTTP POST 请求来实现远程命令执行。

**项目地址:** [Mattb709/CVE-2019-15107-Webmin-RCE-PoC](https://github.com/Mattb709/CVE-2019-15107-Webmin-RCE-PoC)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)