## CVE-2023-32784-KeePass主密码泄露

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 敏感信息泄露

**影响应用:** KeePass

**危害等级:** 高危，攻击者可以获得 KeePass 数据库的访问权限，从而窃取所有存储的密码

**影响版本:** < 2.54

**利用条件:** 攻击者需要能够访问 KeePass 进程的内存转储，例如通过物理访问、恶意软件或其他漏洞利用。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-32784 允许攻击者从 KeePass 2.x (低于 2.54 版本) 的内存转储中恢复明文主密码。即使工作区已锁定或不再运行，此漏洞仍然存在。内存转储可以是 KeePass 进程转储、交换文件 (pagefile.sys)、休眠文件 (hiberfil.sys) 或整个系统的 RAM 转储。

**漏洞利用方式：**
1.  获取 KeePass 进程的内存转储。
2.  使用密码提取工具（如 vdohney/keepass-password-dumper）从内存转储中提取主密码。
3.  根据提供的漏洞利用代码，`generate_passwords.py`脚本并非直接dump密码，而是配合密码dump工具，针对dump出的密码中可能包含的乱码(用'●'表示)进行暴力破解。该脚本的目的是在密码转储后，如果某些字符无法正确识别，则生成可能的密码组合。
4.  如果提取的密码包含未知字符（通常显示为 '●'），则使用`generate_passwords.py`生成可能的密码组合。

**有效性：**
漏洞有效。多个来源（NVD、Wiz.io、Sysdig、Cyberis、Rapid7）证实了该漏洞的存在，并提供了利用方法。`vdohney/keepass-password-dumper`项目提供了概念验证代码，用于从内存转储中提取主密码。而提供的`generate_passwords.py`是辅助脚本。

**投毒风险：**
`generate_passwords.py` 脚本本身的功能是生成密码组合，根据其代码逻辑，不存在明显的投毒风险。它只是一个辅助利用工具。虽然存在一定风险，例如脚本作者可能故意设计效率较低的算法，导致资源消耗增加，但直接的恶意代码注入的风险较低。`README.md`中的声明要求用户负责任地使用该工具，这也在一定程度上减轻了潜在的法律责任。因此，投毒风险评估为10%。主要考虑脚本的依赖以及作者可能的非直接恶意行为(比如消耗大量资源).

**项目地址:** [G4sp4rCS/CVE-2023-32784-password-combinator-fixer](https://github.com/G4sp4rCS/CVE-2023-32784-password-combinator-fixer)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)