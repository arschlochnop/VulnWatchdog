## CVE-2020-3452 - Cisco ASA/FTD Read-Only Path Traversal

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用了WebVPN或AnyConnect功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-3452 存在于 Cisco ASA 和 FTD 软件的 Web 服务接口中。由于缺乏对 HTTP 请求中 URL 的正确输入验证，未经身份验证的远程攻击者可以利用此漏洞执行目录遍历攻击，读取目标系统上的敏感文件。

**利用方式：**
攻击者通过发送特制的 HTTP 请求，其中包含目录遍历字符序列，到受影响的设备。成功利用此漏洞可使攻击者查看目标设备 Web 服务文件系统中的任意文件。从提供的漏洞利用代码可以看出，攻击者通过构造包含`/+CSCOT+/translation-table?type=mst&textdomain=/%2bCSCOE%2b/portal_inc.lua&default-language&lang=../`的URL来读取文件。代码中的`strings.Contains(bs, "INTERNAL_PASSWORD_ENABLED") || strings.Contains(bs, "CONF_VIRTUAL_KEYBOARD")`语句表明，该 PoC 的目的是尝试读取包含密码或键盘配置的文件。

**有效性：**
根据漏洞描述和搜索引擎结果，该漏洞利用代码是有效的。该代码通过发送特制的 HTTP 请求尝试利用目录遍历漏洞读取服务器文件。漏洞库信息和搜索引擎结果确认了该漏洞的存在以及其高危性。

**投毒风险：**
分析提供的 Go 代码，没有发现明显的恶意代码或后门。代码功能明确，即发送 HTTP 请求并检查响应内容是否包含特定字符串。整个代码逻辑较为简单，未发现任何可疑之处。因此，投毒风险较低，为 0%。代码只是验证是否存在 vulnerability，不是恶意攻击。

**项目地址:** [Loneyers/cve-2020-3452](https://github.com/Loneyers/cve-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)