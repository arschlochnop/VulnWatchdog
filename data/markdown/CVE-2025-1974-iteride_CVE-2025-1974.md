## CVE-2025-1974 - ingress-nginx 远程代码执行

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 严重，可能导致集群接管和敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要访问Pod网络或能够发送 AdmissionReview 请求到 validating webhook

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes 的 ingress-nginx 控制器中，由于 Validating Admission Controller 对 `Ingress` 或 `AdmissionReview` 对象的处理不当，未经身份验证的攻击者可以通过 Pod 网络实现远程代码执行 (RCE)。攻击者可以构造恶意的 `Ingress` 对象或 `AdmissionReview` 请求，将其中的恶意代码注入到 NGINX 的配置文件中，并在 `nginx -t` 命令执行时触发 RCE。

**有效性评估：**
根据漏洞描述、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性很高。漏洞库信息和搜索结果都表明这是一个严重漏洞，CVSS 评分高达 9.8，存在公开可用的 RCE 漏洞利用。

**投毒风险评估：**
提供的代码片段主要是一个 README 文件，描述了漏洞的分析和利用过程。其中包含免责声明，表明研究仅用于教育和道德目的，并警告不要在未经授权的环境中使用。代码中并没有发现明显的恶意代码或后门。
然而，由于这是一个漏洞利用相关的文档，存在潜在的投毒风险：
*   攻击者可能修改此文档，添加恶意代码，并将其伪装成漏洞利用的一部分。
*   文档中提供的 PoC 可能会被用于非法目的。

综合考虑，考虑到该文档的性质（漏洞分析）和免责声明，虽然存在投毒风险，但概率相对较低，评估为 10%。需要注意的是，实际使用时应保持警惕，仔细审查代码，并仅在授权的环境中进行测试。

**漏洞利用方式：**
1.  攻击者需要能够访问 Pod 网络或能够发送 `AdmissionReview` 请求到 ingress-nginx 的 validating webhook。
2.  攻击者构造一个恶意的 `Ingress` 对象或 `AdmissionReview` 请求。这个对象包含特殊的代码片段，可以被注入到 NGINX 的配置文件中。
3.  当 ingress-nginx 控制器处理这个恶意的 `Ingress` 对象或 `AdmissionReview` 请求时，会生成包含恶意代码的 NGINX 配置文件。
4.  控制器执行 `nginx -t` 命令来验证配置文件。恶意代码在 `nginx -t` 执行过程中被触发，导致 RCE。
5.  攻击者可以在 ingress-nginx 控制器的 Pod 中执行任意代码，从而可能访问 Secret 并控制整个 Kubernetes 集群。

**项目地址:** [iteride/CVE-2025-1974](https://github.com/iteride/CVE-2025-1974)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)