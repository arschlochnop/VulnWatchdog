## CVE-2024-10924 - Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress plugin

**危害等级:** 严重，可能导致未经授权的访问、数据泄露和网站控制

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标网站必须安装受影响版本的Really Simple Security插件，并且启用了双因素认证（即使默认关闭）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924 允许未经身份验证的攻击者绕过 WordPress Really Simple Security 插件中的身份验证机制。漏洞存在于处理双因素认证的REST API端点中，具体是`check_login_and_get_user`函数中的用户检查错误处理不当。攻击者可以通过发送特制的POST请求到`/wp-json/reallysimplessl/v1/two_fa/skip_onboarding`端点，指定`user_id`和伪造的`login_nonce`以及重定向url，从而以任何现有用户的身份（包括管理员）登录。提供的POC代码演示了如何利用此漏洞。利用方式包括：

1.  **发送恶意请求：** 向目标 WordPress 网站的 `/wp-json/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送 POST 请求，请求体包含精心构造的 JSON 数据。
2.  **绕过身份验证：**  由于不正确的用户检查，插件会错误地验证请求，允许攻击者以 `user_id` 指定的用户身份登录。
3.  **获取访问权限：**  成功利用漏洞后，攻击者可以重定向到管理面板（`/wp-admin/`）或任何其他授权页面，从而获得对网站的完全控制权。

**投毒风险分析：**

仓库中主要的漏洞利用代码是请求的结构体，从披露的漏洞原理上来看，漏洞存在于wordpress插件中的函数错误处理，仓库中只有请求的数据，并没有任何其他代码，从理论上来讲投毒风险较低，可能存在的风险是利用成功后跳转的url地址被篡改为恶意地址，假设为10%。

**项目地址:** [RandomRobbieBF/CVE-2024-10924](https://github.com/RandomRobbieBF/CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)