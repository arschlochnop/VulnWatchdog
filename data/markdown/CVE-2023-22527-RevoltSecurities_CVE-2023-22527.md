## CVE-2023-22527-Atlassian Confluence-OGNL注入

**漏洞编号:** CVE-2023-22527

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Data Center 和 Server

**危害等级:** 高危，允许未经身份验证的攻击者执行远程代码

**影响版本:** 8.0.0 <= version < 8.5.4

**利用条件:** 目标Confluence实例版本在受影响范围内，且网络可达

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-22527 是 Atlassian Confluence Data Center 和 Server 中存在的一个模板注入漏洞，攻击者可以通过构造恶意的 OGNL 表达式来实现远程代码执行。攻击无需身份验证，因此风险极高。

**有效性：**
提供的POC代码是一个 Python 脚本，声称可以利用此漏洞。从代码结构来看，它具备发送恶意请求到目标 Confluence 服务器，并执行命令的能力。

**投毒风险：**
代码中存在一定的投毒风险的可能性。虽然作者提供了license，并且有联系方式，但是仍有必要谨慎。 

*   **潜在风险点：**
	*   `exploit.py`脚本会发起网络请求，存在向恶意服务器发送信息的可能性。
	*   脚本可以执行任意命令，攻击者可能通过命令执行下载恶意payload并执行。

综上，投毒风险评估为 20%，建议在使用前进行代码审计。

**利用方式：**
1.  攻击者构造包含恶意 OGNL 表达式的 HTTP 请求。
2.  Confluence 服务器解析该请求时，由于模板注入漏洞，OGNL 表达式被执行。
3.  攻击者利用 OGNL 表达式执行任意代码，从而控制服务器。

**防范措施：**
1.  升级到不受影响的 Confluence 版本 (>= 8.5.4, >= 8.6.0, >= 8.7.1)。
2.  应用 Atlassian 官方提供的安全补丁。
3.  实施网络分段和访问控制，限制对 Confluence 服务器的访问。
4.  部署入侵检测系统（IDS）和入侵防御系统（IPS），监控和阻止恶意流量。

**项目地址:** [RevoltSecurities/CVE-2023-22527](https://github.com/RevoltSecurities/CVE-2023-22527)

**漏洞详情:** [CVE-2023-22527](https://nvd.nist.gov/vuln/detail/CVE-2023-22527)