## CVE-2015-1635 (MS15-034) HTTP.sys Remote Code Execution Vulnerability

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Windows HTTP.sys

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, Windows Server 2012 Gold and R2

**利用条件:** 目标系统需要运行存在漏洞的HTTP.sys服务，且攻击者能够发送HTTP请求到目标系统。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-1635 (MS15-034) 是一个存在于 Microsoft Windows HTTP.sys 中的远程代码执行漏洞。攻击者可以通过发送特制的 HTTP 请求到受影响的系统来利用此漏洞。漏洞的根本原因是HTTP.sys处理Range请求时存在整数溢出，导致缓冲区读取错误。 

**有效性：**
提供的Python脚本 `chk-ms15-034.py` 通过发送包含恶意 Range 头的HTTP请求来检测目标系统是否存在此漏洞。如果服务器返回“416 Requested Range Not Satisfiable”，则表明系统可能存在漏洞。如果返回“The request has an invalid header”，则表明系统已修补。脚本还包含一个攻击选项，通过发送特定的payload可能导致Windows 2012 R2拒绝服务。 根据漏洞库信息和互联网资料，此POC代码有效，可以用来检测漏洞和进行PoC攻击。

**投毒风险：**
查看提供的 `chk-ms15-034.py` 脚本，没有发现明显的恶意代码，例如后门、数据窃取或未经授权的访问。此脚本主要用于漏洞检测和DoS攻击，其行为与其声明的目的相符。因此，评估的投毒风险为 0%。 

**利用方式：**
1.  **漏洞检测：** 使用 `chk-ms15-034.py` 脚本发送包含恶意 Range 头的 HTTP 请求到目标服务器。
2.  **拒绝服务 (DoS)：** 如果目标是未修补的 Windows Server 2012 R2 系统，可以使用脚本的 `--attack` 选项发送恶意 payload，可能导致服务器崩溃或拒绝服务。
3.  **远程代码执行 (RCE)：** 虽然POC脚本的主要功能是漏洞检测和DoS，但是根据漏洞信息描述，此漏洞本身允许攻击者执行任意代码。完整的RCE利用需要更复杂的payload，不在本POC脚本范围内，但可以通过构造特定的HTTP请求实现。 

**漏洞修复建议:**
及时安装微软发布的MS15-034安全补丁。


**项目地址:** [wiredaem0n/chk-ms15-034](https://github.com/wiredaem0n/chk-ms15-034)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)