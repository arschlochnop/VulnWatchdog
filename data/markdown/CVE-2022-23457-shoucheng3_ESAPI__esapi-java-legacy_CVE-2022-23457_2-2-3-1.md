## CVE-2022-23457-ESAPI-路径遍历

**漏洞编号:** CVE-2022-23457

**漏洞类型:** 路径遍历

**影响应用:** OWASP ESAPI

**危害等级:** 高危，可能导致敏感文件读取和控制流绕过

**影响版本:** < 2.3.0.0

**利用条件:** 需要应用使用存在漏洞的ESAPI版本，且攻击者能够控制输入路径。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-23457是OWASP ESAPI中的一个路径遍历漏洞。具体来说，`Validator.getValidDirectoryPath` 方法在版本2.3.0.0之前存在缺陷，可能错误地将输入字符串视为指定父目录的子目录。如果攻击者可以控制整个输入路径字符串，则可能绕过控制流检查。 

**有效性：**
根据漏洞描述和搜索结果，漏洞是存在的，并且在ESAPI 2.3.0.0版本中已修复。搜索结果也表明存在关于该漏洞的详细分析和利用描述。

**投毒风险：**
提供的漏洞利用代码实际上是ESAPI的`CONTRIBUTING-TO-ESAPI.txt`文件，它描述了如何为ESAPI项目做贡献，而不是真正的exploit。其中maven依赖、git的使用和贡献的步骤说明，属于代码贡献的文档，并没有发现恶意代码。但是不排除在该项目的其他分支存在投毒代码。因此，只能认定为极低。

**利用方式：**
利用方式是，如果应用程序使用了存在漏洞的ESAPI版本，攻击者可以构造恶意的输入路径，绕过 `Validator.getValidDirectoryPath` 的验证，从而访问受限目录或文件。例如，攻击者可以提交包含 `../` 序列的路径，从而访问父目录及其中的文件。该漏洞的利用难度被评为高，这意味着利用需要一些技术水平，例如了解应用程序的路径验证逻辑和如何构造恶意输入。

**总结：**
该漏洞是真实存在的，并且具有潜在的危害性。应用程序开发人员应升级到ESAPI 2.3.0.0或更高版本来修复此漏洞。此外，应该对用户输入进行严格的验证和过滤，以防止路径遍历攻击。


**项目地址:** [shoucheng3/ESAPI__esapi-java-legacy_CVE-2022-23457_2-2-3-1](https://github.com/shoucheng3/ESAPI__esapi-java-legacy_CVE-2022-23457_2-2-3-1)

**漏洞详情:** [CVE-2022-23457](https://nvd.nist.gov/vuln/detail/CVE-2022-23457)