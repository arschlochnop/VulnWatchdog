## CVE-2024-6387-OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件漏洞

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行或拒绝服务

**影响版本:** 8.5p1 <= OpenSSH <= 9.7p1

**利用条件:** 目标系统运行受影响的OpenSSH版本，且攻击者能够建立SSH连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（也称为regreSSHion）是OpenSSH服务器中的一个安全回归漏洞，源于CVE-2006-5051。这是一个竞争条件漏洞，可能导致sshd以不安全的方式处理某些信号。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。

**有效性：**

从搜索结果和漏洞库信息来看，该漏洞存在可利用的POC。提供的Rust代码是一个漏洞检查器，它通过连接到SSH服务器并读取SSH banner来判断目标服务器是否运行着存在漏洞的OpenSSH版本。

**投毒风险：**

提供的代码是一个漏洞检测工具，用于检查目标系统是否存在CVE-2024-6387漏洞。代码功能相对清晰，主要包括：

*   定义了易受攻击和已修补的版本列表。
*   通过TCP连接获取SSH banner。
*   将获取的banner与已知易受攻击的版本进行比较。

代码中没有发现恶意行为，例如执行系统命令或上传/下载文件。因此，**投毒风险较低，判断为0%**。

**利用方式：**

根据漏洞信息和搜索结果，攻击者需要发起大量的连接尝试，以触发sshd中的竞争条件。成功利用该漏洞可能允许攻击者在目标系统上执行任意代码或导致拒绝服务。Offsec的博客提供了关于如何利用该漏洞的更详细的解释。

**总结：**

CVE-2024-6387是一个严重的安全漏洞，允许未经身份验证的攻击者远程执行代码。虽然利用该漏洞需要一定的资源和技术，但由于存在公开的POC，因此建议尽快更新OpenSSH版本。

**项目地址:** [kubota/CVE-2024-6387-Vulnerability-Checker](https://github.com/kubota/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)