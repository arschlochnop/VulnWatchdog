## CVE-2025-25257-FortiWeb-SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致数据泄露、远程代码执行以及未经授权的访问

**影响版本:** 7.6.0 <= version <= 7.6.3, 7.4.0 <= version <= 7.4.7, 7.2.0 <= version <= 7.2.10, version < 7.0.10

**利用条件:** 目标FortiWeb实例需要开放HTTP或HTTPS端口，攻击者需要能够通过网络访问到存在漏洞的FortiWeb设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-25257 是 Fortinet FortiWeb 中存在的 SQL 注入漏洞。该漏洞存在于GUI组件中，由于没有正确过滤SQL语句中的特殊字符导致。未经验证的攻击者可以通过构造恶意的 HTTP 或 HTTPS 请求执行未经授权的 SQL 代码或命令，从而可能导致远程代码执行(RCE)。

**有效性：**

提供的POC代码`exp.py` 尝试通过修改 `Authorization` 请求头，在 `Bearer` 字段中注入 SQL 语句。POC代码通过向`/api/fabric/device/status`接口发送包含恶意SQL注入的请求，如果服务器返回401状态码则证明注入成功。由于漏洞库信息和搜索结果都表明该漏洞无需身份验证，因此POC代码的有效性较高，能够成功利用该漏洞。

**投毒风险：**

查看提供的POC代码，发现其主要功能是发送带有SQL注入的请求，并根据返回状态码判断注入是否成功。代码本身较为简洁，没有发现明显的恶意代码或者后门，但是也不能排除通过release释放带有恶意代码的安装包。综合考虑，投毒的风险较低，大约为10%。

**利用方式：**

1.  攻击者构造包含恶意 SQL 注入的 HTTP 或 HTTPS 请求。
2.  将构造的请求发送到目标 FortiWeb 设备的 `/api/fabric/device/status` 接口。
3.  FortiWeb 设备在处理请求时，由于没有正确过滤 SQL 语句中的特殊字符，导致恶意 SQL 代码被执行。
4.  攻击者通过执行恶意 SQL 代码，可以读取、修改或删除数据库中的数据，甚至可以执行系统命令，实现远程代码执行（RCE）。
5.  成功利用漏洞后，攻击者可能获取敏感信息、控制 FortiWeb 设备，进一步攻击内网系统。

**项目地址:** [kityzed2003/CVE-2025-25257](https://github.com/kityzed2003/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)