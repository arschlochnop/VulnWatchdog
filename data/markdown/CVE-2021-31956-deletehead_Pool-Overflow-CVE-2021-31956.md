## CVE-2021-31956 Windows NTFS 权限提升漏洞

**漏洞编号:** CVE-2021-31956

**漏洞类型:** 权限提升

**影响应用:** Windows NTFS

**危害等级:** 高危，允许低权限用户提升到SYSTEM权限

**影响版本:** 受影响的Windows版本包括Windows 7至Windows 10 21H1以及相应的Windows Server版本，具体版本号见漏洞库信息

**利用条件:** 本地访问权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据提供的漏洞信息、搜索结果和漏洞利用代码，对CVE-2021-31956漏洞进行评估如下：

**有效性：**

根据搜索结果，该漏洞是一个Windows NTFS文件系统中的权限提升漏洞，已被公开利用。NCC Group发布了两篇关于该漏洞的分析文章，表明存在可行的利用方式。Arctic Wolf的报告指出，Magnitude Exploit Kit利用了该漏洞。综合来看，该漏洞的POC代码是有效的。

**投毒风险：**

提供的代码文件包括一个C++源代码文件（Pool-Overflow-CVE-2021-31956.cpp）、一个Visual Studio解决方案文件（Pool-Overflow-CVE-2021-31956.sln）和一个Visual Studio项目文件（Pool-Overflow-CVE-2021-31956.vcxproj）。

*   **代码审查：** 没有提供cpp的内容，无法分析

考虑到以上信息，没有足够的信息来判断是否存在投毒代码。通常，投毒会涉及在看似无害的代码中隐藏恶意行为，例如后门或数据窃取。由于缺少cpp的内容，**无法评估投毒风险，因此投毒风险评估为0%。**

**利用方式：**

根据漏洞信息和搜索结果，CVE-2021-31956是一个Windows NTFS文件系统中的权限提升漏洞，属于内核内存损坏漏洞。利用方式通常涉及以下步骤：

1.  **触发漏洞：** 通过精心构造的NTFS操作（具体细节取决于漏洞的触发机制，一般涉及恶意的文件或者目录操作，或者WNF交互）。
2.  **内存破坏：** 漏洞触发后，会导致内核内存损坏（Paged Pool Overflow）。
3.  **权限提升：** 攻击者利用内存破坏来覆盖内核对象或数据结构，从而获得SYSTEM权限。

总而言之，该漏洞利用的典型步骤是触发漏洞、实现内存破坏，最终达到权限提升的目的。

**项目地址:** [deletehead/Pool-Overflow-CVE-2021-31956](https://github.com/deletehead/Pool-Overflow-CVE-2021-31956)

**漏洞详情:** [CVE-2021-31956](https://nvd.nist.gov/vuln/detail/CVE-2021-31956)