## CVE-2016-5394-Apache Sling-XSS

**漏洞编号:** CVE-2016-5394

**漏洞类型:** XSS

**影响应用:** Apache Sling

**危害等级:** 中危，可能导致用户凭据泄露、会话劫持和恶意脚本执行

**影响版本:** prior to 1.0.12

**利用条件:** 需要用户访问包含恶意代码的页面

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2016-5394是Apache Sling XSS Protection API模块中的一个漏洞，具体来说，是`XSSAPI.encodeForJSString()`方法在1.0.12之前的版本中，对某些输入模式的编码不够严格，导致`<script>`标签可以通过未编码的方式传递，从而造成潜在的XSS漏洞。

**有效性：**
漏洞信息表明，此漏洞在Apache Sling 1.0.12之前的版本中存在，攻击者可以利用此漏洞注入恶意脚本。

**投毒风险：**
提供的“漏洞利用代码”实际上是PGP公钥块，并非可执行的漏洞利用代码，因此不存在投毒风险。虽然包含了签名信息，但这些签名用于验证软件发布者的身份，而不是注入恶意代码。投毒风险评估为0%。

**利用方式：**
利用方式是通过构造特定的输入字符串，绕过`XSSAPI.encodeForJSString()`的过滤，从而在JavaScript上下文中执行恶意代码。具体步骤如下：

1.  确定目标Apache Sling服务器运行着受影响的版本（1.0.12之前）。
2.  找到一个允许用户输入数据，并且该数据会通过`XSSAPI.encodeForJSString()`方法进行处理并输出到页面的地方。
3.  构造包含`<script>`标签或其他恶意JavaScript代码的特殊输入字符串，使其能够绕过编码。
4.  将构造的输入字符串提交给目标服务器。
5.  当服务器处理该输入并将其输出到页面时，恶意JavaScript代码会被执行。

**项目地址:** [epicosy/VUL4J-23](https://github.com/epicosy/VUL4J-23)

**漏洞详情:** [CVE-2016-5394](https://nvd.nist.gov/vuln/detail/CVE-2016-5394)