## CVE-2015-9251-jQuery-XSS

**漏洞编号:** CVE-2015-9251

**漏洞类型:** XSS

**影响应用:** jQuery

**危害等级:** 中危，可能导致用户敏感信息泄露或恶意脚本执行

**影响版本:** < 3.0.0

**利用条件:** 需要目标网站使用存在漏洞的jQuery版本，且允许跨域Ajax请求但未设置dataType

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2015-9251 存在于 jQuery 3.0.0 之前的版本中。当执行跨域 Ajax 请求时，如果未设置 `dataType` 选项，`text/javascript` 响应会被执行，从而导致跨站脚本攻击（XSS）。

**有效性分析：**

提供的 PoC 代码看起来是有效的。它包含一个 HTML 页面，该页面使用 jQuery 1.8.1（存在漏洞的版本）发起一个跨域 AJAX 请求到 `http://localhost:8081/malicious.js`，并没有设置 `dataType`。`server.py` 文件模拟了一个恶意服务器，它会返回一段 JavaScript 代码 (`alert(document.domain);`)，这段代码会在客户端执行，从而证明 XSS 漏洞的存在。

**投毒风险分析：**

浏览了提供的代码，没有发现作者隐藏的恶意或后门代码。server.py中的恶意js脚本只是用来验证漏洞的存在。

**利用方式：**

1.  **目标网站条件：** 目标网站需要使用 jQuery 3.0.0 之前的版本。
2.  **跨域请求：** 攻击者需要找到或创建一个机会，让目标网站发起一个到攻击者控制的域的 AJAX 请求。
3.  **绕过同源策略：** 服务器必须返回 `Access-Control-Allow-Origin: *` 头部，以允许跨域请求。同时，服务端还需要设置 `Content-Type: text/javascript`。
4.  **没有 `dataType`：** AJAX 请求不能显式设置 `dataType` 选项。如果没有设置，jQuery 会尝试自动检测响应类型。如果服务器返回 `text/javascript`，jQuery 会将其作为 JavaScript 代码执行。
5.  **XSS 执行：** 攻击者控制的服务器返回包含恶意 JavaScript 代码的响应。由于 jQuery 将其作为代码执行，因此会发生 XSS，允许攻击者在目标网站的上下文中运行任意 JavaScript 代码（例如，窃取 cookie，重定向用户，更改页面内容）。

总之，PoC的目的是模拟利用此漏洞，允许在受害者浏览器中执行任意JavaScript代码。通过设置跨域访问许可并返回 `text/javascript` 内容类型，攻击者可以绕过浏览器的安全限制，并执行恶意脚本。

**项目地址:** [hackgiver/CVE-2015-9251](https://github.com/hackgiver/CVE-2015-9251)

**漏洞详情:** [CVE-2015-9251](https://nvd.nist.gov/vuln/detail/CVE-2015-9251)