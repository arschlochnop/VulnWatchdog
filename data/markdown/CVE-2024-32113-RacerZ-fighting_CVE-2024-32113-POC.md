## CVE-2024-32113-Apache OFBiz-路径遍历导致RCE

**漏洞编号:** CVE-2024-32113

**漏洞类型:** 路径遍历

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 18.12.13

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是 Apache OFBiz 中的一个路径遍历漏洞，攻击者可以通过构造包含 `../` 的恶意 URL，绕过身份验证访问受限的 webtools 管理界面，并在 `ProgramExport` 模块中执行任意 Groovy 代码，从而实现远程代码执行 (RCE)。

**利用方式：**

1.  **路径遍历：** 攻击者利用`../../../%2e/`或`..;/` 这样的payload来进行路径遍历，绕过目录限制，访问到 `/webtools/control/ProgramExport` 接口。
2.  **身份验证绕过：** 漏洞允许未授权访问原本需要身份验证的 `/webtools/control/ProgramExport` 接口。
3.  **远程代码执行：** 通过向 `/webtools/control/ProgramExport` 接口的 `groovyProgram` 参数传递恶意的 Groovy 代码，实现在服务器上执行任意命令。

**有效性评估：**

提供的 POC 代码有效，可用于验证漏洞的存在和进行利用。

**投毒风险评估：**

存在一定的投毒风险，因为 README.md 文件中包含了多个漏洞的 POC。攻击者可能在提供的poc的基础上进行恶意篡改，例如加入反弹shell代码，用于攻击。

**POC列表和漏洞简述:**

*   **CVE-2024-32113:** 路径遍历配合ProgramExport RCE。
*   **CVE-2024-36104:** 路径遍历配合ProgramExport RCE, 使用了不同的路径遍历绕过方式(`.%2e/.%2e/.%2e`和`..;/`)。
*   **CVE-2024-38856:** 通过替换 `forgotPassword` 请求与其他请求，配合 ProgramExport 模块进行 RCE，强调了可以通过fuzz webapp/webtools/WEB-INF/controller.xml来寻找更多可利用的入口。

尽管提供了多个POC，但主要利用方式和目的都是实现RCE，因此，投毒风险评估为10%。主要集中在被攻击者利用，对 POC 进行修改，以达到其恶意目的（例如，静默后门植入）。

**项目地址:** [RacerZ-fighting/CVE-2024-32113-POC](https://github.com/RacerZ-fighting/CVE-2024-32113-POC)

**漏洞详情:** [CVE-2024-32113](https://nvd.nist.gov/vuln/detail/CVE-2024-32113)