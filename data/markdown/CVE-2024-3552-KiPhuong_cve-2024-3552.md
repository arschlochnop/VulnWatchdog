## CVE-2024-3552-Web Directory Free-SQL注入

**漏洞编号:** CVE-2024-3552

**漏洞类型:** SQL注入

**影响应用:** Web Directory Free WordPress插件

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 1.7.0

**利用条件:** 目标网站安装了Web Directory Free插件且版本低于1.7.0，未经身份验证即可访问admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Web Directory Free WordPress插件的ajax-controller.php文件中，具体是w2dc_ajax_controller类的get_map_marker_info函数。攻击者可以通过POST请求的locations_ids[]参数注入恶意SQL代码。由于插件没有对该参数进行充分的过滤和转义，直接将其拼接到了SQL查询语句中，导致SQL注入漏洞。从提供的POC代码来看，它使用了时间盲注，通过构造包含SLEEP函数的SQL语句来判断注入是否成功。POC代码也展示了使用sqlmap进行漏洞扫描。投毒风险较低，主要因为POC验证的后门代码可能存在，但整体代码目标明确，主要用于漏洞验证和利用。

**项目地址:** [KiPhuong/cve-2024-3552](https://github.com/KiPhuong/cve-2024-3552)

**漏洞详情:** [CVE-2024-3552](https://nvd.nist.gov/vuln/detail/CVE-2024-3552)