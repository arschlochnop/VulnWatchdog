## CVE-2025-2294 - WordPress Kubio AI Page Builder LFI

**漏洞编号:** CVE-2025-2294

**漏洞类型:** 本地文件包含 (LFI)

**影响应用:** Kubio AI Page Builder

**危害等级:** 严重，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 2.5.1

**利用条件:** 目标WordPress站点安装了受影响版本的Kubio AI Page Builder插件，且允许未授权的网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-2294 漏洞存在于 Kubio AI Page Builder 插件中，由于 `thekubio_hybrid_theme_load_template` 函数未对用户输入进行充分的过滤，导致未经身份验证的攻击者可以通过构造特殊的 HTTP GET 请求，包含恶意的文件路径，从而读取服务器上的任意文件。如果攻击者能够上传包含 PHP 代码的文件（例如，通过图片上传等方式），则可以通过 LFI 漏洞执行任意代码。

**漏洞利用方式：**

1.  攻击者构造包含恶意文件路径的 HTTP GET 请求，发送到目标 WordPress 站点。请求URL如下：
    `{url}/?__kubio-site-edit-iframe-preview=1&__kubio-site-edit-iframe-classic-template={payload}`
    其中，`{url}` 是目标站点的 URL，`{payload}` 是要包含的文件路径。
2.  服务器接收到请求后，`thekubio_hybrid_theme_load_template` 函数会尝试加载 `{payload}` 指定的文件。
3.  如果 `{payload}` 指向的文件存在且可读，服务器会将文件内容返回给攻击者。

**有效性：**
提供的PoC代码是有效的，它通过发送包含恶意 payload 的 HTTP 请求来验证漏洞的存在。

**投毒风险：**
PoC 代码主要功能是利用 LFI 漏洞读取文件。但存在一定的投毒风险，主要体现在：

*   **恶意重定向/下载:** 攻击者可能修改代码，添加恶意重定向或下载行为，诱导用户访问恶意网站或下载恶意文件。
*   **信息收集:** 作者可能在代码中加入隐蔽的信息收集功能，例如收集用户的 IP 地址、操作系统等信息。
*   **后门植入:**  虽然当前代码未发现后门植入，但攻击者可能通过修改代码在受害者系统上植入后门，长期控制系统。检查 `exploit` 函数中对于 response 的处理过程，以及是否会执行额外的系统命令。
鉴于 PoC 的复杂性和潜在的风险，存在大约 10% 的投毒风险。建议用户在使用 PoC 代码之前进行仔细审查，并从可信的来源下载。

**项目地址:** [r0otk3r/CVE-2025-2294](https://github.com/r0otk3r/CVE-2025-2294)

**漏洞详情:** [CVE-2025-2294](https://nvd.nist.gov/vuln/detail/CVE-2025-2294)