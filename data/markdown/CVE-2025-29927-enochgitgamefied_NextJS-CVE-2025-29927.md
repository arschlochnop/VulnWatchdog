## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** 应用使用了Next.js中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927是Next.js中间件中存在的授权绕过漏洞。根据漏洞库信息，受影响的版本包括多个Next.js版本范围。搜索引擎结果也证实了该漏洞的存在，并指出是由于Next.js对 `x-middleware-subrequest`  header处理不当造成的。提供的漏洞利用代码是一个展示漏洞的、故意存在漏洞的Next.js应用程序。这个应用包含模拟Web应用防火墙（WAF）的中间件，以及存在漏洞的Next.js版本。利用方式是通过构造包含 `x-middleware-subrequest`  header的请求，绕过中间件的授权检查，从而访问受保护的资源。虽然提供的代码本身是为了演示漏洞，但仍需要谨慎评估其安全性，尤其是依赖项和数据库配置。投毒风险评估为10%，主要基于以下几点：

1.  数据库配置： `README.md` 中提到需要配置MySQL数据库，并且给出了一个简单的配置示例。如果用户直接使用示例配置，并且数据库未进行安全加固，则可能存在被攻击的风险。
2.  依赖项： `package-lock.json` 文件中列出了应用程序的依赖项。虽然未发现明显的恶意依赖，但仍需定期检查这些依赖项是否存在安全漏洞。

总体来说，此POC本身是为了演示漏洞的存在，主要风险在于用户不安全地使用和配置此POC环境。


**项目地址:** [enochgitgamefied/NextJS-CVE-2025-29927](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)