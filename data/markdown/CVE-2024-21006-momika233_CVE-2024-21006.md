## CVE-2024-21006 - Oracle WebLogic Server 未授权访问漏洞

**漏洞编号:** CVE-2024-21006

**漏洞类型:** 未授权访问

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致敏感数据泄露和完全控制WebLogic Server

**影响版本:** 12.2.1.4.0, 14.1.1.0.0

**利用条件:** 需要网络访问T3或IIOP端口（默认7001）

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-21006 是 Oracle WebLogic Server 中 Core 组件的一个高危漏洞。受影响的版本包括 12.2.1.4.0 和 14.1.1.0.0。攻击者可以通过 T3 或 IIOP 协议进行网络访问，利用此漏洞在未经身份验证的情况下完全控制 WebLogic Server，包括读取敏感数据。CVSS 3.1 评分为 7.5，利用方式简单，影响严重。

**有效性：**
提供的 POC 代码尝试利用 `weblogic.application.naming.MessageDestinationReference` 类绕过身份验证。代码创建了一个 `MessageDestinationReference` 对象，并尝试通过 IIOP 协议连接到 WebLogic Server。 如果 WebLogic Server 存在漏洞，攻击者可能能够利用这个引用来执行未授权操作，获取敏感信息。

**投毒风险：**
在提供的 POC 代码中，存在少量潜在的投毒风险（5%）。虽然代码主要用于利用漏洞，但攻击者可以在 `rmiurl` 变量中注入恶意 RMI 地址，诱导用户连接到恶意的 RMI 服务器，从而执行任意代码。然而，此处的`rmiurl`变量被注释掉了,并且漏洞的整体思路和方向是利用IIOP协议进行未授权访问，而非依赖于RMI，所以投毒可能性极低。此外，需要强调的是，验证POC本身执行恶意代码的行为（如创建文件）不应被错误地判定为投毒。

**利用方式：**
1.  攻击者通过 T3 或 IIOP 协议（通常是7001端口）建立与目标 WebLogic Server 的网络连接。
2.  利用 `weblogic.application.naming.MessageDestinationReference` 或类似机制绕过身份验证。
3.  利用漏洞获取敏感信息或执行任意代码，从而完全控制 WebLogic Server。

**项目地址:** [momika233/CVE-2024-21006](https://github.com/momika233/CVE-2024-21006)

**漏洞详情:** [CVE-2024-21006](https://nvd.nist.gov/vuln/detail/CVE-2024-21006)