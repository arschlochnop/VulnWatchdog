## CVE-2019-5418 - Rails Action View 文件内容泄露

**漏洞编号:** CVE-2019-5418

**漏洞类型:** 文件内容泄露

**影响应用:** Rails Action View

**危害等级:** 高危，可能泄露敏感信息

**影响版本:** <5.2.2.1, <5.1.6.2, <5.0.7.2, <4.2.11.1, v3

**利用条件:** 需要目标系统运行存在漏洞的Rails应用，并能发送特制的HTTP请求

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-5418 是一个 Rails Action View 中的文件内容泄露漏洞。攻击者可以通过构造特殊的 `Accept` HTTP 头，结合调用 `render file:` 方法，读取目标系统上的任意文件。 

**有效性:**  漏洞库信息、搜索引擎结果和已公开的利用代码都证实了该漏洞的存在和可利用性。可以通过发送包含特定格式 `Accept` 头的HTTP请求来触发漏洞，从而读取服务器上的文件。

**投毒风险:**  提供的漏洞利用代码仅包含 GNU GPL 协议的 LICENSE 文件。该文件本身不包含任何恶意代码，因此投毒风险为 0%。

**利用方式:**  利用方式是构造恶意的 HTTP `Accept` 头。通常，攻击者会发送包含诸如 `../../../../etc/passwd` 之类的路径的 `Accept` 头，以尝试读取服务器上的敏感文件。 服务器在处理该请求时，由于漏洞的存在，会错误地将指定文件的内容作为响应返回，从而导致信息泄露。

根据搜索结果中的链接，例如 [webpage 7 begin] [title] Exploiting CVE-2019–5418- File Content Disclosure on Rails [description] A File Content Disclosure vulnerability exists where properly designed accept headers can reveal the contents of arbitrary files on the target system's ... [link] https://spoofing.medium.com/exploiting-cve-2019-5418-file-content-disclosure-on-rails-58cfa488fb51 可以进一步研究利用的细节。

**项目地址:** [brompwnie/CVE-2019-5418-Scanner](https://github.com/brompwnie/CVE-2019-5418-Scanner)

**漏洞详情:** [CVE-2019-5418](https://nvd.nist.gov/vuln/detail/CVE-2019-5418)