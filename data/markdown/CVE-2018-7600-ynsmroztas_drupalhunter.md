## CVE-2018-7600 Drupalgeddon2 RCE

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未经身份验证的攻击者执行任意代码

**影响版本:** Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1

**利用条件:** 目标Drupal站点存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600（Drupalgeddon2）是一个存在于Drupal核心中的远程代码执行漏洞。根据漏洞库信息和搜索结果，该漏洞影响多个子系统，常见模块配置也可能受到影响。大量Drupal网站受到影响。 

**有效性：**

提供的Python POC代码利用了Drupal的多个漏洞组合来实现远程代码执行。它通过构造特定的请求参数，包括`q`、`name[#post_render][]`、`name[#markup]`和`name[#type]`，以及提交`form_id`和`_triggering_element_name`来触发漏洞。然后，它解析响应以获取`form_build_id`，并使用它来发送另一个请求以执行任意命令。 搜索引擎结果中的多个条目表明该漏洞被广泛利用。

**投毒风险：**

虽然POC代码本身是为了演示漏洞利用而编写的，但存在一定的投毒风险。  如果攻击者修改了POC代码，例如，将command参数修改成下载恶意脚本并执行，那么该POC可以被用来传播恶意软件。 由于代码逻辑相对简单，作者在其中隐藏复杂后门的可能性较低。但是，无法完全排除，所以投毒风险定为10%。

**利用方式：**

1.  攻击者首先构造包含恶意参数的POST请求到目标Drupal站点的`/user/password`路径。
2.  恶意参数包括`q`设置为`user/password`，以及使用`name[#post_render][]`，`name[#markup]`和`name[#type]`来注入要执行的操作系统命令。
3.  服务器响应包含`form_build_id`。
4.  攻击者使用`form_build_id`构造另一个POST请求到`/file/ajax/name/#value/{form_build_id}`，执行先前注入的命令。
5.  命令执行的结果将返回给攻击者。

**项目地址:** [ynsmroztas/drupalhunter](https://github.com/ynsmroztas/drupalhunter)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)