## CVE-2024-37054-MLflow-反序列化漏洞

**漏洞编号:** CVE-2024-37054

**漏洞类型:** 反序列化漏洞

**影响应用:** MLflow

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 0.9.0 <= version < 2.14.2

**利用条件:** 需要用户交互，加载恶意模型

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-37054 是 MLflow 中的一个反序列化漏洞。攻击者可以上传一个包含恶意 pickle 负载的 PyFunc 模型。当受害者加载此模型时，恶意负载将通过 `cloudpickle.load` 反序列化，从而导致受害者机器上执行任意代码。该漏洞影响 MLflow 0.9.0 及更高版本，直到 2.14.2 版本（不包括 2.14.2）。

**有效性分析：**

根据提供的漏洞信息和搜索结果，该漏洞利用的有效性较高。漏洞库信息和多个搜索结果都确认了该漏洞的存在以及远程代码执行的风险。提供的PoC代码包含Dockerfile，能够构建一个存在漏洞的MLflow环境，并且README.md中详细描述了利用步骤，包括构建docker镜像，运行容器等，可以模拟攻击者上传恶意模型和受害者加载模型，从而触发RCE。

**投毒风险分析：**

虽然提供的PoC代码主要是为了演示漏洞利用，但仍存在一定的投毒风险，代码中安装了mlflow 2.14.1 版本,该版本是存在漏洞的版本，如果用户直接使用该Dockerfile部署MLflow服务，则会暴露安全风险。但仓库本身目的是为了演示漏洞,不算是真正的投毒,但存在一定风险,这里判定为10%。

**利用方式：**

1.  **攻击者：** 构造一个恶意的MLflow PyFunc 模型，其中包含一个序列化的恶意 payload。该 payload 在反序列化时会执行攻击者预期的任意代码。
2.  **上传：** 攻击者将构造的恶意模型上传到MLflow 服务器。
3.  **受害者：** 受害者（例如，MLflow 用户或管理员）尝试加载或使用上传的恶意模型。
4.  **触发：** MLflow 在加载模型时，会使用 `cloudpickle.load` 反序列化模型中的 payload。
5.  **RCE：** 恶意 payload 在受害者机器上执行，导致远程代码执行。

总而言之，利用方式就是通过上传恶意模型，诱导受害者加载执行，从而实现远程代码执行。

**项目地址:** [NiteeshPujari/CVE-2024-37054-MLflow-RCE](https://github.com/NiteeshPujari/CVE-2024-37054-MLflow-RCE)

**漏洞详情:** [CVE-2024-37054](https://nvd.nist.gov/vuln/detail/CVE-2024-37054)