## CVE-2025-56399 - laravel-file-manager Authenticated Remote Code Execution

**漏洞编号:** CVE-2025-56399

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** laravel-file-manager

**危害等级:** 高危，允许认证后的攻击者执行任意代码

**影响版本:** <= 3.3.1

**利用条件:** 需要有效的用户账户，并且该账户需要有文件管理器的上传或创建文件的权限。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

laravel-file-manager v3.3.1及以下版本存在身份验证的远程代码执行(RCE)漏洞。攻击者通过文件管理器界面上传包含恶意PHP代码的非PHP扩展名文件(如.png, .pdf)，然后将其重命名为.php扩展名，或者直接创建和编辑.php文件，当通过公共URL访问该文件时，攻击者可以实现RCE。

**漏洞利用方式：**
1. 使用具有文件管理器上传或创建文件功能的帐户进行身份验证。
2. 通过文件管理器的上传界面或API上传包含恶意PHP代码的文件（例如，shell.png）（例如：<?php system($_GET['c']); ?>）。
3. 使用重命名API或界面将文件扩展名从shell.png更改为shell.php。
4. 在公共URL（例如，https://server-ip-address/storage/shell.php?c=id）访问该文件以执行PHP有效负载。
5. 或者，使用“创建文件”功能创建一个文件（例如，shell.php），然后使用编辑功能插入恶意PHP代码并通过公共URL访问它。

**投毒风险分析：**
该漏洞利用代码主要包含漏洞描述和PoC验证步骤，并无明显恶意代码。但仍然存在一定的投毒风险，例如，PoC中使用的图片可能包含恶意代码，或者在安装、配置过程中引入其他的恶意文件。因此，投毒风险评估为5%。

**项目地址:** [Theethat-Thamwasin/CVE-2025-56399](https://github.com/Theethat-Thamwasin/CVE-2025-56399)

**漏洞详情:** [CVE-2025-56399](https://nvd.nist.gov/vuln/detail/CVE-2025-56399)