## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据和功能

**影响版本:** 受影响版本包括：>= 11.1.4, <= 13.5.6，> 14.0.0, < 14.2.25，> 15.0.0, < 15.2.3

**利用条件:** 需要目标Next.js应用使用中间件进行权限验证，且未升级到修复版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-29927 存在于 Next.js 中，如果授权检查发生在中间件中，则可能绕过授权检查。漏洞利用方式是通过发送包含 `x-middleware-subrequest` 头的恶意请求来绕过中间件的身份验证。此仓库提供了一个 Docker 环境来复现漏洞,通过`curl -H "X-Middleware-Subrequest: src/middleware:nowaf" http://localhost:3000/admin` 命令可以绕过中间件。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断此漏洞利用的有效性较高。漏洞库信息明确指出该漏洞是由于对 `x-middleware-subrequest` 标头处理不当引起的，搜索结果中也包含多个关于该漏洞的分析和利用的文章。漏洞利用代码提供了一个 Docker 环境，方便用户复现该漏洞，进一步验证了漏洞的有效性。

**投毒风险：**
提供的 Dockerfile 主要用于构建 Next.js 应用，没有发现明显的恶意代码。README.md 和 VULNERABILITY.md 文件也主要提供漏洞的说明和利用方法。docker-compose.yml文件未提供，无法进行分析。需要注意的是，此仓库本身就是为了演示漏洞而存在，因此存在一定风险，不应直接部署到生产环境。

**利用方式：**
1.  攻击者利用 Next.js 中间件对 `x-middleware-subrequest` 标头处理不当的缺陷。
2.  构造包含 `x-middleware-subrequest` 标头的恶意 HTTP 请求。
3.  发送恶意请求到受影响的 Next.js 应用，绕过中间件的权限验证。
4.  成功访问受保护的路由或资源。

**项目地址:** [enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab](https://github.com/enochgitgamefied/NextJS-CVE-2025-29927-Docker-Lab)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)