## CVE-2021-29447-WordPress-XXE

**漏洞编号:** CVE-2021-29447

**漏洞类型:** XML 外部实体注入 (XXE)

**影响应用:** WordPress

**危害等级:** 高危，可能导致敏感信息泄露、服务器端请求伪造 (SSRF)

**影响版本:** >= 5.6.0, < 5.7.1 (PHP 8)

**利用条件:** 需要 WordPress 版本在 5.6.0 到 5.7.1 之间，并且运行在 PHP 8 环境下。攻击者需要具有上传文件的权限 (例如 Author 角色)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2021-29447 是一个 WordPress 媒体库中存在的 XXE 漏洞。攻击者通过上传包含恶意 XML 内容的文件（例如 WAV 文件或其他支持 XML 解析的文件格式）到媒体库，触发 XML 解析过程中的外部实体注入。由于 WordPress 使用的音频解析库 ID3 在 PHP 8 及以上版本中存在 XXE 漏洞，攻击者可以读取服务器上的任意文件或者进行服务器端请求伪造 (SSRF)。

**有效性：** 根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码的仓库名"0xRar/CVE-2021-29447-PoC"，可以判断存在可用的 POC 代码，因此该漏洞的利用是有效的。

**投毒风险：** 提供的代码段是 Creative Commons CC0 1.0 通用许可协议，这是一种开源许可协议，本身不包含任何恶意代码，也无法进行投毒。此文件为LICENSE文件，与PoC代码无关，因此推断投毒风险为0%。

**利用方式：**
1.  攻击者需要具备 WordPress Author 或更高权限，以便能够上传文件到媒体库。
2.  攻击者构造一个包含恶意 XML 实体定义的音频文件（或其他允许上传并解析 XML 的文件类型，例如SVG）。恶意 XML 实体指向系统内部文件，或者指向攻击者控制的外部服务器。
3.  攻击者将构造的恶意文件上传到 WordPress 媒体库。
4.  当 WordPress 解析上传的文件时，会尝试解析 XML 实体，从而导致 XXE 漏洞的触发。
5.  如果成功，攻击者可以读取服务器上的敏感文件（例如 WordPress 配置文件 `wp-config.php`）或进行服务器端请求伪造（SSRF）攻击。

**项目地址:** [magicrc/CVE-2021-29447](https://github.com/magicrc/CVE-2021-29447)

**漏洞详情:** [CVE-2021-29447](https://nvd.nist.gov/vuln/detail/CVE-2021-29447)