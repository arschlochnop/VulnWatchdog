## CVE-2015-6967-Nibbleblog-文件上传

**漏洞编号:** CVE-2015-6967

**漏洞类型:** 文件上传

**影响应用:** Nibbleblog

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 4.0.5

**利用条件:** 需要管理员权限登录Nibbleblog后台

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Nibbleblog 4.0.5之前的版本中，My Image插件存在未限制的文件上传漏洞。远程管理员可以通过上传具有可执行扩展名的文件（如.php），然后通过直接请求`content/private/plugins/my_image/image.php`中的文件来执行任意代码。

**有效性：**
根据漏洞信息、搜索结果和提供的POC代码，该漏洞利用的有效性较高。POC代码利用了Nibbleblog My Image插件中的文件上传漏洞，通过上传包含PHP代码的恶意文件，实现了远程代码执行。

**投毒风险：**
通过分析提供的POC代码，没有发现明显的投毒代码。该代码的功能是利用漏洞上传webshell并执行命令，代码逻辑清晰，没有隐藏的恶意操作。因此，投毒风险较低，可以认为风险是0%。

**利用方式：**
1.  **身份验证：** 首先，攻击者需要拥有Nibbleblog的管理员权限，使用提供的用户名和密码进行登录。
2.  **上传恶意文件：** 登录后，攻击者访问My Image插件的配置页面。利用该插件的文件上传功能，上传一个包含恶意PHP代码的文件，例如上传一个名为`doesnt_matter.php`的文件，其中包含`<?php echo shell_exec($_GET["cmd"]); ?>`。
3.  **远程代码执行：** 上传成功后，攻击者可以通过构造特定的URL，例如`target/nibbleblog/content/private/plugins/my_image/image.php?cmd=whoami`，来执行任意命令。`cmd`参数的值会被`shell_exec`函数执行，并将结果返回给攻击者。

**项目地址:** [FredBrave/CVE-2015-6967](https://github.com/FredBrave/CVE-2015-6967)

**漏洞详情:** [CVE-2015-6967](https://nvd.nist.gov/vuln/detail/CVE-2015-6967)