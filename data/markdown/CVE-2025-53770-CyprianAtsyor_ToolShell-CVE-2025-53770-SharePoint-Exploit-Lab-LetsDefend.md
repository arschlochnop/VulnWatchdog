## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以在服务器上执行任意代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要能够发送 HTTP POST 请求到 SharePoint 服务器

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一个 Microsoft SharePoint Server 的远程代码执行漏洞，由于未经验证的数据反序列化导致。攻击者可以通过向 `/ToolPane.aspx` 端点发送特制的 POST 请求，利用此漏洞在服务器上执行任意代码。攻击需要构造恶意的 PowerShell 脚本并进行 Base64 编码，然后将其作为 POST 请求的 payload 发送。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞已被积极利用，并且存在公开可用的 PoC。提供的 PoC 代码展示了利用该漏洞的步骤，包括构造恶意 POST 请求、解码 PowerShell payload、编译可执行文件以及放置 Web shell。

**投毒风险评估：**

PoC代码提供了一个 LetsDefend lab的演练方案。它本身是用来分析漏洞的。因此直接判定是投毒是不合适的。该仓库代码中"payload.cs contained a simulated payload, no real exploit", 该说明明确表示 `payload.cs` 包含模拟 payload，并非真实漏洞利用代码。 该PoC中存在一定投毒风险,主要是因为用户下载后可能会误以为是直接可用的exp,未进行详细分析,直接应用在实际环境中。

**利用方式：**

1.  **漏洞触发：**  攻击者向 `/ToolPane.aspx` 端点发送特制的 POST 请求，其中包含 Base64 编码的恶意 PowerShell payload。
2.  **Payload 解码：**  SharePoint 服务器在处理请求时，会对 Base64 编码的 payload 进行解码，并执行其中的 PowerShell 脚本。
3.  **代码执行：**  PowerShell 脚本可以执行任意操作，例如窃取敏感信息（如 MachineKeySection 密钥）、编译可执行文件或放置 Web shell。
4.  **持久化（可选）：**  通过放置 Web shell，攻击者可以长期控制受感染的 SharePoint 服务器。
5. 成功利用后可以在服务器执行任意代码, 例如安装后门、收集敏感信息或进行其他恶意活动。

**项目地址:** [CyprianAtsyor/ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend](https://github.com/CyprianAtsyor/ToolShell-CVE-2025-53770-SharePoint-Exploit-Lab-LetsDefend)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)