## CVE-2025-29927-Next.js-Middleware-Authorization-Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标应用使用Next.js中间件进行权限验证，且版本在受影响范围内

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞，由于 Next.js 对 `x-middleware-subrequest` header 处理不当导致。攻击者可以通过在请求中添加该 header 绕过中间件的授权检查，访问未授权的资源。

**有效性：**
根据漏洞信息，搜索引擎结果以及提供的POC代码，可以判断该漏洞是有效的。多个来源都确认了该漏洞的存在，并提供了利用该漏洞的信息。

**投毒风险：**
提供的POC代码主要包含一个 README.md 文件和一个 MIT 许可协议文件，以及一个演示的gif图片。这些文件本身不包含任何恶意代码。但是，`NextBypass`工具的使用需要用户自己 `git clone` 代码，并执行 `./NextBypass`命令。如果攻击者修改了github仓库中的NextBypass内容添加了恶意代码，将会存在一定的投毒风险，但是整体风险较低，因为代码量较小，容易被发现。 估计投毒风险为 5%。

**利用方式：**
1.  攻击者构造包含 `x-middleware-subrequest` header 的恶意 HTTP 请求。
2.  Next.js 应用的中间件在处理请求时，由于漏洞，未能正确验证用户的权限。
3.  攻击者成功绕过授权检查，访问受保护的资源或执行未授权的操作。

**项目地址:** [fahimalshihab/NextBypass](https://github.com/fahimalshihab/NextBypass)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)