## CVE-2025-4796-Eventin-权限提升

**漏洞编号:** CVE-2025-4796

**漏洞类型:** 权限提升

**影响应用:** Eventin – Event Manager, Events Calendar, Booking, Tickets and Registration

**危害等级:** 高危，可能导致账户被盗和任意代码执行

**影响版本:** <= 4.0.34

**利用条件:** 需要Contributor及以上权限的WordPress账户，且安装Eventin插件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Eventin插件的SpeakerController::update_item函数中。由于插件在更新用户邮箱时未正确验证用户的身份或权限，攻击者可以使用具有Contributor及以上权限的账户，通过修改Speaker的邮箱地址，来更改任意用户（包括管理员）的邮箱，然后通过密码重置流程获取目标账户的控制权。

**利用方式：**

1.  攻击者需要一个具有Contributor及以上权限的WordPress账户。
2.  攻击者需要知道目标站点上一个Speaker的ID。
3.  攻击者使用PoC脚本，输入目标URL、Speaker ID、目标邮箱地址和自己的用户名和密码。
4.  PoC脚本会登录到WordPress后台，获取nonce值。
5.  PoC脚本使用获取的nonce值和更新后的邮箱地址，向`/wp-json/eventin/v2/speakers/{speaker_id}`发送PUT请求，修改指定Speaker的邮箱地址。
6. 如果攻击者修改了管理员的邮箱，则可以通过忘记密码功能重置管理员密码，从而获得管理员权限。

**投毒风险分析：**

代码中存在一些异常处理，但总体来看，代码逻辑符合漏洞描述，没有发现明显的恶意代码，例如后门、信息窃取或破坏性操作。所有操作都集中在利用漏洞进行邮箱更新。因此，投毒风险较低。

**风险评估：**

该漏洞风险极高，因为它可以使低权限用户获得管理员权限，从而控制整个网站。由于PoC代码可用，该漏洞容易被利用。建议立即更新到最新版本的Eventin插件。

**项目地址:** [Pwdnx1337/CVE-2025-4796](https://github.com/Pwdnx1337/CVE-2025-4796)

**漏洞详情:** [CVE-2025-4796](https://nvd.nist.gov/vuln/detail/CVE-2025-4796)