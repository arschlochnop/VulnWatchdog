## CVE-2025-4796-Eventin-权限提升/账户接管

**漏洞编号:** CVE-2025-4796

**漏洞类型:** 权限提升/账户接管

**影响应用:** Eventin – Event Manager, Events Calendar, Booking, Tickets and Registration

**危害等级:** 高危，可能导致账户接管和未授权访问

**影响版本:** <= 4.0.34

**利用条件:** 需要Contributor及以上权限的WordPress账户，且Eventin插件已安装并启用。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-4796漏洞存在于Eventin插件中，允许具有Contributor及以上权限的认证用户通过修改任意用户的邮箱地址，实现权限提升和账户接管。攻击者利用`Eventin\Speaker\Api\SpeakerController::update_item`函数中对用户身份验证不足的缺陷，发送PUT请求到`/wp-json/eventin/v2/speakers/{speaker_id}` API端点，修改指定`speaker_id`对应的用户的邮箱地址。成功修改邮箱地址后，攻击者可以通过重置密码流程接管目标账户。

提供的POC代码实现了以下步骤：
1.  用户输入目标站点URL、Speaker ID、新的邮箱地址、用户名和密码。
2.  标准化URL，并验证邮箱地址。
3.  禁用SSL证书验证警告（可选，但建议在测试环境中使用）。
4.  使用提供的用户名和密码登录WordPress站点。
5.  提取nonce token，用于后续的API请求。
6.  构造PUT请求，更新指定Speaker ID的邮箱地址为新的邮箱地址。
7.  验证请求是否成功，并输出结果。

**有效性：**
根据漏洞库信息和POC代码分析，该POC代码是有效的。它利用了Eventin插件在`update_item`函数中对用户权限验证不足的缺陷，通过API请求修改用户邮箱地址，从而实现账户接管。

**投毒风险：**
经过分析，提供的POC代码没有明显的投毒代码。该代码的主要功能是利用漏洞，进行权限提升或账户接管。代码中的print函数被pwdnx_print代替，只是对输出进行了编码处理，防止出现编码错误。 代码逻辑清晰，没有隐藏恶意行为。因此，投毒风险为0%。

**利用方式：**
1.  获取目标WordPress站点的Contributor及以上权限的账户凭据。
2.  找到目标用户的Speaker ID。可以通过公开资料或枚举用户ID来获取。
3.  运行POC代码，输入目标站点URL、Speaker ID、新的邮箱地址以及步骤1中获取的账户凭据。
4.  POC代码会登录WordPress站点，获取nonce token，并发送PUT请求到Eventin API，修改目标用户的邮箱地址。
5.  如果请求成功，攻击者可以使用新的邮箱地址重置目标用户的密码，从而接管其账户。

**项目地址:** [Pwdnx1337/CVE-2025-4796](https://github.com/Pwdnx1337/CVE-2025-4796)

**漏洞详情:** [CVE-2025-4796](https://nvd.nist.gov/vuln/detail/CVE-2025-4796)