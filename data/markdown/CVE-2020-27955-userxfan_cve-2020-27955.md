## CVE-2020-27955-Git LFS Remote Code Execution

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.12.0

**利用条件:** 目标机器安装了Git LFS 2.12.0，并且clone了包含恶意配置的仓库。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-27955 存在于 Git LFS 2.12.0 中，允许远程代码执行。根据漏洞库信息，存在多个关于此漏洞的参考链接，包括exploitbox.io, legalhackers.com 等，这些链接提供了漏洞详情和可能的利用方式。 

**有效性分析：**

提供的POC代码包含三个文件：

*   `README.md`：包含CVE编号信息。
*   `git.cmd`：包含 `calc.exe`，这表明漏洞利用可能涉及执行任意命令。
*   `large.dat`：包含字符串 `test`，这可能是 LFS 对象的内容。

根据已有的漏洞分析报告，利用方式通常是，在`.gitattributes` 文件中设置一个恶意filter，当检出包含 LFS 对象的特定文件时，会触发该filter执行。POC中的 `git.cmd` 脚本 `calc.exe` 符合这个利用模式，表明这个POC很可能有效。

**投毒风险分析：**

分析POC代码内容，此仓库主要包含漏洞验证代码，没有发现隐藏的投毒代码。因此，投毒风险评估为0%。

**利用方式：**

1.  攻击者创建一个包含恶意`.gitattributes`文件的Git仓库。`.gitattributes`文件将特定的文件类型或路径与一个恶意的Git filter（例如clean或smudge）关联起来。
2.  该filter配置执行任意命令。例如，可以执行一个shell脚本或任何其他可执行文件。
3.  攻击者将包含恶意`.gitattributes`文件的仓库上传到公共或私有Git服务器。
4.  受害者克隆（clone）或检出（checkout）该仓库。
5.  当Git处理与恶意filter关联的文件时，它会执行`.gitattributes`文件中配置的恶意命令，从而导致远程代码执行。
6.  POC中的 `git.cmd` 脚本是恶意命令，large.dat 是需要处理的 LFS 对象。当用户 clone 包含这些文件的仓库时，就会触发 RCE。


**项目地址:** [userxfan/cve-2020-27955](https://github.com/userxfan/cve-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)