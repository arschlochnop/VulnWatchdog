## CVE-2022-30190 Microsoft Windows Support Diagnostic Tool (MSDT) 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码，可能导致系统完全控制

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户打开包含恶意代码的文档，例如Word文档

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-30190 (Follina) 是一个远程代码执行漏洞，存在于 Microsoft Windows Support Diagnostic Tool (MSDT) 中。当 MSDT 被一个调用应用程序（例如 Microsoft Word）通过 URL 协议调用时，会触发此漏洞。攻击者可以通过构造一个包含恶意链接或嵌入恶意HTML的Word文档，诱使用户打开。当用户打开该文档时，MSDT 会尝试连接到攻击者控制的服务器，下载并执行恶意代码。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意链接或嵌入恶意 HTML 的 Word 文档。
2.  该文档利用 Word 的远程模板功能，从远程 Web 服务器检索 HTML 文件。
3.  HTML 文件包含一个 `ms-msdt:` 协议处理程序的调用，该协议处理程序用于启动 MSDT。
4.  MSDT 执行 HTML 文件中指定的命令，从而允许攻击者执行任意代码。

**有效性：**

根据漏洞库信息和搜索结果，此漏洞的PoC已经公开，且被积极利用。

**投毒风险：**

提供的漏洞利用代码仅包含 Apache 许可证，用于说明代码的使用条款，没有发现任何明显的恶意代码。因此，投毒风险较低，估计为 5%。但不能完全排除，因为攻击者可能会在其他相关组件中进行投毒，所以需要进一步分析依赖项才能彻底排除。

**排序优先级说明：**

此处遵循优先级的原则，搜索引擎结果用于确定漏洞的基本信息和利用方式。漏洞库信息用于确认受影响的版本和漏洞的严重程度。漏洞利用代码则用于评估投毒风险。

**项目地址:** [DerZiad/CVE-2022-30190](https://github.com/DerZiad/CVE-2022-30190)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)