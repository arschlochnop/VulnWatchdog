## CVE-2018-25031-Swagger UI Spoofing/SSRF/XSS

**漏洞编号:** CVE-2018-25031

**漏洞类型:** 欺骗/SSRF/XSS

**影响应用:** Swagger UI

**危害等级:** 中危，可能导致敏感信息泄露或恶意代码执行

**影响版本:** <= 4.1.2 (可能更高版本也受影响)

**利用条件:** 需要目标系统使用存在漏洞版本的Swagger UI，并允许用户访问恶意构造的URL。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-25031 允许远程攻击者通过诱使用户打开特制的URL来发起欺骗攻击，显示远程 OpenAPI 定义。漏洞利用方式：

1.  **欺骗攻击 (Spoofing):** 攻击者可以托管一个恶意的 OpenAPI 定义（例如 YAML 或 JSON 文件）。
2.  **诱导用户：** 攻击者构建一个包含指向恶意 OpenAPI 定义的 URL。然后，攻击者诱使用户点击此 URL。这可以通过社会工程学或其他技术实现。
3.  **Swagger UI 显示恶意定义：** 当用户访问包含恶意定义的 URL 时，Swagger UI 将加载并显示该恶意定义。
4.  **XSS/信息窃取:** 恶意的 OpenAPI 定义可以包含恶意HTML/JavaScript代码，例如，在`description`字段中插入`<script>`标签或者`<form>`标签，在用户浏览器中执行，从而窃取用户信息（例如cookie）或执行其他恶意操作，比如进行钓鱼。

从提供的漏洞利用代码来看， `poc3.yaml`和`try.yaml` 文件中， `description` 字段包含了`<form>`标签，模拟了一个登录表单，目的是诱骗用户输入用户名和密码，并将这些信息发送到攻击者控制的服务器 `ttqbbaf0yx45z9zqgpmfcvjyhpngbcz1.oastify.com` 。另外，还包含一个`onerror`事件的图像标签，当图片加载失败时，会执行JavaScript代码`alert(document.cookie)`，从而可能泄露用户的cookie信息。 这些代码证明了利用此漏洞执行XSS攻击，窃取用户信息的可能性。

**投毒风险分析:**

虽然主要的攻击向量是利用Swagger UI的缺陷来展示恶意的OpenAPI定义，但代码仓库中存在一定的投毒风险。这种风险主要体现在：

*   攻击者可能会在 YAML/JSON 文件中加入一些隐蔽的恶意代码，例如混淆的 JavaScript 或利用其他漏洞的代码片段。然而，从提供的代码中看，主要利用方式较为直接，没有明显的隐藏后门。
*   仓库本身可能被篡改，虽然代码相对简单，但仓库维护者的身份以及代码的来源都存在一定的不确定性，不能完全排除代码仓库所有者添加恶意代码的可能性。

因此，综合考虑以上因素，判断存在10%的投毒风险。

**项目地址:** [johnlaurance/CVE-2018-25031-test2](https://github.com/johnlaurance/CVE-2018-25031-test2)

**漏洞详情:** [CVE-2018-25031](https://nvd.nist.gov/vuln/detail/CVE-2018-25031)