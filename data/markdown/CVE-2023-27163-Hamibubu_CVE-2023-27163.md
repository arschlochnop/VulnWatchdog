## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致敏感信息泄露和内网资源访问

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets服务可访问，并且攻击者可以发送POST请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及之前版本中的一个 SSRF 漏洞。攻击者可以通过向 `/api/baskets/{name}` 发送特制的 API 请求，利用该漏洞发起服务器端请求伪造攻击。 

**有效性评估：**
根据漏洞库信息和搜索引擎结果，此漏洞的存在已得到确认，并且有公开可用的 PoC 代码。提供的 PoC 代码（CVE-2023-27163.py）看起来能够有效利用此漏洞。它允许攻击者指定一个目标 URL (`-t`) 和一个恶意 URL (`-e`)，然后创建一个新的 basket，并将其配置为将请求转发到恶意 URL。 这说明提供的POC代码有效。

**投毒风险分析：**
提供的代码主要包含以下几个文件：
*   `CVE-2023-27163.py`:  这是主要的 PoC 脚本，用于利用 SSRF 漏洞。脚本的逻辑是创建具有转发功能的 request-baskets，将流量转发到攻击者指定的 URL。
*   `README.md`:  包含脚本的使用说明。
*   `requirements.txt`:  列出了脚本所需的依赖项，只有 `requests>=2.25.1`，是一个常见的Python库。

没有发现明显的恶意代码。 但风险依然存在：

1.  **依赖风险：** `requirements.txt` 文件中声明了 `requests` 库。如果攻击者控制了上游 PyPI 仓库，并且能够投毒 `requests` 库，那么运行此脚本的用户可能会受到影响。此风险较低，因为 `requests` 是一个非常流行的库，任何投毒行为都会很快被发现。
2. **间接风险:**  虽然该POC本身没有发现恶意代码,但是使用者如果滥用此POC,比如扫描内网弱口令服务等,会造成更大的安全风险.

基于以上分析，我估计此仓库中存在作者隐藏的投毒代码的风险为 10%。主要是考虑到依赖项的潜在风险以及被滥用的可能。

**利用方式总结：**
1.  攻击者需要找到一个运行着易受攻击版本的 Request-Baskets 的服务器。
2.  攻击者使用 PoC 脚本（`CVE-2023-27163.py`）创建一个新的 basket，并设置 `forward_url` 参数为攻击者控制的恶意 URL。
3.  当有人访问新创建的 basket 时，Request-Baskets 服务器会向攻击者指定的 URL 发起请求，从而允许攻击者执行 SSRF 攻击，例如访问内部服务或泄露敏感信息。
4.  通过设置不同的 URL, 可以探测内网端口开放, 访问内网服务,甚至可以通过内网服务进行进一步的攻击。

**项目地址:** [Hamibubu/CVE-2023-27163](https://github.com/Hamibubu/CVE-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)