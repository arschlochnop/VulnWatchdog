## CVE-2023-34960-Chamilo-命令注入

**漏洞编号:** CVE-2023-34960

**漏洞类型:** 命令注入

**影响应用:** Chamilo

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v1.11.* up to v1.11.18

**利用条件:** 需要访问Chamilo的SOAP API接口/webservices/additional_webservices.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-34960是Chamilo v1.11.* 到 v1.11.18版本中wsConvertPpt组件存在的一个命令注入漏洞。攻击者可以通过构造包含恶意命令的PowerPoint文件名，并利用SOAP API调用/webservices/additional_webservices.php接口来执行任意命令。 

**有效性分析：**
根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该漏洞利用是有效的。搜索引擎结果中多个链接都指向了该漏洞的描述，并且Rapid7 Metasploit已经发布了利用该漏洞的模块，表明该漏洞是可被利用的。
提供的POC代码`/tmp/176d720a26918eb35b36eadd06dede84/README.md`虽然简单，但明确指出了利用的API端点和漏洞类型，说明存在已知的利用方法。

**投毒风险分析：**
提供的POC代码只是一个`README.md`文件，内容非常简短，只说明了漏洞和利用的API端点，没有包含任何可执行的代码。因此，从代码本身来看，不存在明显的投毒代码。然而，整个仓库可能被用于传播恶意软件或其他目的，或者未来的提交可能会包含恶意代码，因此投毒风险评估为10%。这个数字考虑了开发者可能在其他地方（如依赖项或后续更新）引入恶意代码的可能性，虽然当前POC本身看起来是安全的。

**利用方式分析：**
1.  攻击者构造一个包含恶意命令的PowerPoint文件名，例如 `test.ppt; malicious_command;`。
2.  攻击者通过SOAP API调用Chamilo的`/webservices/additional_webservices.php`接口。
3.  在SOAP请求中，将包含恶意命令的文件名作为参数传递给`wsConvertPpt`组件。
4.  `wsConvertPpt`组件处理PowerPoint文件名时，由于没有正确地过滤特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [mr-won/cve-2023-34960](https://github.com/mr-won/cve-2023-34960)

**漏洞详情:** [CVE-2023-34960](https://nvd.nist.gov/vuln/detail/CVE-2023-34960)