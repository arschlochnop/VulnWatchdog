## CVE-2025-32444-vLLM-RCE

**漏洞编号:** CVE-2025-32444

**漏洞类型:** 反序列化漏洞

**影响应用:** vLLM

**危害等级:** 严重，可能导致远程代码执行

**影响版本:** >= 0.6.5, < 0.8.5

**利用条件:** 需要vLLM集成Mooncake，且ZeroMQ套接字暴露在网络上

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32444 漏洞是 vLLM 在与 Mooncake 集成时由于使用了基于 pickle 的序列化，并且在不安全的 ZeroMQ 套接字上进行数据传输而导致的远程代码执行漏洞。漏洞影响 vLLM 0.6.5 到 0.8.5 之间的版本。ZeroMQ 套接字监听所有网络接口增加了攻击者利用该漏洞的可能性。 

**漏洞利用方式：**

1.  **确定目标：** 找到运行着存在漏洞版本 vLLM 的服务器，并且该 vLLM 实例使用了 Mooncake 集成。
2.  **网络访问：** 确保能够通过网络访问到 vLLM 实例暴露的 ZeroMQ 套接字。
3.  **构造恶意数据：** 构造包含恶意代码的 pickle 对象。该对象在反序列化时会执行攻击者预设的命令。
4.  **发送恶意数据：** 将构造好的恶意 pickle 数据通过 ZeroMQ 套接字发送给 vLLM 服务器。
5.  **远程代码执行：** vLLM 服务器反序列化接收到的数据，执行恶意代码，导致远程代码执行。

**漏洞利用代码分析：**

提供的 Dockerfile 文件用于构建一个包含易受攻击的 vLLM 实例的 Docker 镜像，该镜像集成了MCP服务器。这个 Dockerfile 的目的是创建一个可以验证漏洞的环境，它并不是直接攻击的exploit代码。Dockerfile 通过设置特定的环境变量和检出特定的分支来模拟存在漏洞的环境。

**投毒风险分析：**

分析提供的 Dockerfile，存在一定的投毒风险，但概率较低。以下是分析依据：

*   **可疑操作：** Dockerfile 中存在从 GitHub 克隆 vLLM 仓库的操作，并且指定了分支 `VULN_BRANCH=baseline`，`TEST_BRANCH=test`, `GOLDEN_BRANCH=golden`。攻击者可能会在这些分支中植入恶意代码，然后在构建镜像时引入。
*   **测试补丁：** Dockerfile 尝试创建测试补丁，这增加了恶意代码被隐藏的可能性，表面上是为了测试。
*   **后门风险：** 尽管该 Dockerfile 主要目的是复现漏洞，但通过修改 vLLM 源代码，攻击者可以在镜像中植入后门。
*  **MCP服务器代码**：MCP服务器代码 `src/`，`shared/`目录下的代码可能存在漏洞或者恶意代码，在docker镜像启动时运行。

**风险评估：**

虽然 Dockerfile 的主要目的是构建漏洞环境，但仍需谨慎评估投毒风险。特别是需要仔细审查从 GitHub 克隆的代码，以及 MCP 服务器相关的代码。由于该 Dockerfile 主要侧重于漏洞复现，因此判断投毒风险较低，约为 5%。主要风险在于克隆的 vLLM 仓库以及 MCP 服务器代码中可能存在的后门。

**项目地址:** [stuxbench/vLLM-CVE-2025-32444](https://github.com/stuxbench/vLLM-CVE-2025-32444)

**漏洞详情:** [CVE-2025-32444](https://nvd.nist.gov/vuln/detail/CVE-2025-32444)