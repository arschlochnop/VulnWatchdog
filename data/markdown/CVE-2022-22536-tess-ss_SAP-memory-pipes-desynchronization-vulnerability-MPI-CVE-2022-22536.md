## CVE-2022-22536 - SAP NetWeaver Request Smuggling/Concatenation

**漏洞编号:** CVE-2022-22536

**漏洞类型:** 请求走私/请求串联

**影响应用:** SAP NetWeaver Application Server ABAP, SAP NetWeaver Application Server Java, ABAP Platform, SAP Content Server, SAP Web Dispatcher

**危害等级:** 高危，可能导致信息泄露、权限提升、拒绝服务以及中间Web缓存投毒

**影响版本:** 受影响版本包括：KERNEL 7.22, 8.04, 7.49, 7.53, 7.77, 7.81, 7.85, 7.86, 7.87, KRNL64UC 8.04, 7.22EXT, KRNL64NUC 7.22 (以及 Web Dispatcher 7.49, 7.53, 7.77, 7.81, 7.85, 7.22EXT, 7.86, 7.87 和 Content Server 7.53)

**利用条件:** 需要目标系统存在受影响的SAP组件，且可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22536 漏洞是 SAP NetWeaver 及其相关组件中的请求走私和请求串联漏洞。攻击者可以通过在受害者请求前添加恶意数据来利用此漏洞，从而冒充受害者执行功能或毒化中间 Web 缓存。攻击者发送构造好的HTTP请求，利用服务器对Content-Length的处理差异，实现请求走私，后续合法的用户请求可能会受到攻击者恶意请求的影响。PoC利用了 Content-Length 字段，通过发送大量'A'字符来尝试造成 Desynchronization，从而影响后续请求。高危性体现在，未经身份验证的攻击者可以通过此漏洞获得对系统的完全控制，包括数据的机密性、完整性和可用性。投毒风险评估为10%，主要原因是虽然原理上可以通过篡改缓存等方式投毒，但提供的PoC 主要目的是验证漏洞的存在，直接包含恶意代码的可能性较低，但仍然存在一定风险，比如利用该漏洞实施进一步的攻击，比如缓存投毒等。此仓库中包含指向 Onapsis 和 antx-code 提供的漏洞验证脚本的链接。

**项目地址:** [tess-ss/SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536](https://github.com/tess-ss/SAP-memory-pipes-desynchronization-vulnerability-MPI-CVE-2022-22536)

**漏洞详情:** [CVE-2022-22536](https://nvd.nist.gov/vuln/detail/CVE-2022-22536)