## CVE-2022-1388 - F5 BIG-IP iControl REST 身份验证绕过导致RCE

**漏洞编号:** CVE-2022-1388

**漏洞类型:** 身份验证绕过/远程代码执行

**影响应用:** F5 BIG-IP

**危害等级:** 极高危，未经身份验证的攻击者可执行任意命令

**影响版本:** 受影响版本包括16.1.x (低于16.1.2.2), 15.1.x (低于15.1.5.1), 14.1.x (低于14.1.4.6), 13.1.x (低于13.1.5), 12.1.x (所有12.1.x版本) 和 11.6.x (所有11.6.x版本)

**利用条件:** 目标系统运行受影响的F5 BIG-IP版本，并且可以从攻击者网络访问iControl REST API。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-1388 允许未经身份验证的攻击者绕过 F5 BIG-IP iControl REST API 的身份验证，并在目标系统上执行任意命令。提供的漏洞利用代码 (exploit.py) 使用带有特定 Header（包括 'Host': '127.0.0.1', 'Authorization': 'Basic YWRtaW46aG9yaXpvbjM=', 'X-F5-Auth-Token': 'asdf','Connection': 'X-F5-Auth-Token'）的 POST 请求将命令发送到 `/mgmt/tm/util/bash` 端点，从而实现远程代码执行。该利用代码包括测试目标是否易受攻击的功能，以及运行交互式 shell 的选项。 

**漏洞利用有效性：**
根据漏洞库信息和搜索结果，CVE-2022-1388 是一个严重漏洞，并且在野外被积极利用。提供的 POC 代码与公开描述的漏洞利用方式一致，因此很可能有效。搜索结果中也提到该漏洞利用可以实现远程代码执行(RCE)。

**投毒风险：**
查看提供的Dockerfile文件，主要是安装python包环境和准备运行python环境，没有发现恶意代码。查看提供的exploit.py文件，该脚本从url中读取目标地址，然后通过精心构造http请求，绕过身份验证，最后在目标机器上执行bash命令。检查了提供的Dockerfile和exploit.py的内容，没有发现任何明显的投毒代码。该仓库代码的目的是为了模拟CVE-2022-1388漏洞，以方便研究和测试，代码结构清晰，功能单一，因此投毒风险较低。

**利用方式：**
1.  攻击者向目标 F5 BIG-IP 系统的 iControl REST API 发送特制的 HTTP POST 请求。
2.  请求包含特定的 Header，用于绕过身份验证。
3.  请求的目标端点是 `/mgmt/tm/util/bash`，用于执行 bash 命令。
4.  通过 JSON 格式在请求体中指定要执行的命令。
5.  服务器执行命令并将结果返回给攻击者。

**结论：** 该漏洞利用代码有效，且未发现明显的投毒风险。漏洞利用方式简单直接，利用价值高。

**项目地址:** [battleofthebots/refresh](https://github.com/battleofthebots/refresh)

**漏洞详情:** [CVE-2022-1388](https://nvd.nist.gov/vuln/detail/CVE-2022-1388)