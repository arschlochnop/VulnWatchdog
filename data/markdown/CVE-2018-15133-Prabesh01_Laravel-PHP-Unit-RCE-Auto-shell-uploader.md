## CVE-2018-15133-Laravel-反序列化RCE

**漏洞编号:** CVE-2018-15133

**漏洞类型:** 反序列化RCE

**影响应用:** Laravel Framework

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 5.5.x <= 5.5.40, 5.6.x <= 5.6.29

**利用条件:** 需要知道应用的APP_KEY，通过 X-XSRF-TOKEN 传递恶意序列化数据。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15133 漏洞是 Laravel 框架中由于对 X-XSRF-TOKEN 值的反序列化操作不当导致的远程代码执行漏洞。攻击者可以构造恶意的序列化数据，通过 X-XSRF-TOKEN 头部发送给服务器，服务器在解密和反序列化该数据时，执行攻击者预先设定的恶意代码。漏洞利用的关键在于需要知道 Laravel 应用的 APP_KEY，才能成功加密和构造恶意数据。搜索结果表明该漏洞已被CISA列入已知被利用的漏洞目录。

提供的漏洞利用代码 `rce.sh` 通过访问 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 接口，利用该接口执行PHP代码的特性，尝试上传一个PHP Webshell（uploader.php）。虽然脚本本身的功能是上传webshell，但脚本并不会主动植入恶意后门,所以判定投毒风险为0%。 脚本的原理是利用 phpunit 的 eval-stdin.php 文件, 该文件可以执行POST请求中的PHP代码, 从而进行webshell上传。 这种利用方式依赖于目标环境存在phpunit且eval-stdin.php文件存在且可访问。

**项目地址:** [Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader](https://github.com/Prabesh01/Laravel-PHP-Unit-RCE-Auto-shell-uploader)

**漏洞详情:** [CVE-2018-15133](https://nvd.nist.gov/vuln/detail/CVE-2018-15133)