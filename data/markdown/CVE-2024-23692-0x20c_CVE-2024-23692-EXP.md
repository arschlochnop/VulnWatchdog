## CVE-2024-23692-Rejetto HTTP File Server-模板注入

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 需要目标系统运行受影响版本的 Rejetto HTTP File Server，并允许网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692 是 Rejetto HTTP File Server 2.3m 及更早版本中的一个模板注入漏洞。未经身份验证的远程攻击者可以通过发送特制的 HTTP 请求利用此漏洞在受影响的系统上执行任意命令。

**1. 有效性：**
   - 提供的 PoC 代码（`CVE-2024-23692.sh` 和 `CVE-2024-23692.yaml`）看起来是有效的。 `CVE-2024-23692.sh` 是一个 Bash 脚本，它构造一个包含命令的恶意 URL，并使用 `curl` 发送请求，最后解析响应以获取命令输出。 `CVE-2024-23692.yaml` 是一个 Nuclei 模板，用于检测此漏洞，使用 `interactsh-url` 验证是否存在漏洞。
   - 搜索结果中提及了 Metasploit 模块，表明漏洞是可利用的。

**2. 投毒风险：**
   - `CVE-2024-23692.sh` 脚本使用 `iconv` 和 `base64` 对命令进行编码，这可能会被误认为是试图隐藏恶意代码。但是，此编码过程对于确保命令正确地作为模板注入的一部分发送是必要的。
   -Nuclei 模板文件(`CVE-2024-23692.yaml`)，通过 interactsh 进行验证，不太可能包含恶意代码，属于常见的漏洞验证方式
   - 考虑到脚本的功能和用途，投毒风险较低，但仍存在一定风险，例如，脚本可能依赖外部资源，或者作者未来可能修改脚本。所以，投毒风险估计为10%。

**3. 利用方式：**
   - 攻击者构造包含恶意命令的特殊 HTTP 请求，利用模板注入漏洞。
   - `CVE-2024-23692.sh` 脚本自动执行此过程：
      1.  使用 `iconv` 将命令转换为 UTF-16LE 编码。
      2.  使用 `base64` 对 UTF-16LE 编码的命令进行编码。
      3.  将编码后的命令插入到特制的 URL 中。
      4.  使用 `curl` 发送 GET 请求到目标服务器。
      5.  解析响应以提取命令的输出。
   - Nuclei 模板通过 dns 探测验证漏洞。

**项目地址:** [0x20c/CVE-2024-23692-EXP](https://github.com/0x20c/CVE-2024-23692-EXP)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)