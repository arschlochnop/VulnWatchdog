## CVE-2025-21298-Windows OLE Remote Code Execution

**漏洞编号:** CVE-2025-21298

**漏洞类型:** 远程代码执行

**影响应用:** Windows OLE

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 受影响的Windows版本和Build号详见漏洞库信息

**利用条件:** 用户需要打开恶意的RTF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2025-21298是一个Windows OLE远程代码执行漏洞，CVSS评分为9.8，属于严重级别。该漏洞是由于`ole32.dll`库中的`UtOlePresStmToContentsStm`函数在处理OLE对象时存在Use-After-Free漏洞（CWE-416）。攻击者可以构造恶意的RTF文件，当用户打开该文件时，触发漏洞，从而在目标系统上执行任意代码。搜索结果表明，该漏洞可以通过精心制作的电子邮件进行利用，实现零点击攻击。提供的POC代码描述了漏洞的原理和影响，即当程序尝试使用已经释放的内存时，可能导致意外行为或允许攻击者执行恶意代码（shellcode）。

**有效性：**
根据搜索结果和POC描述，漏洞利用是有效的。多个来源确认了这是一个可利用的RCE漏洞，并且存在PoC。

**投毒风险：**
提供的POC代码是一个`README.md`文件，用于描述漏洞。它本身不包含可执行的代码，因此直接的投毒风险较低。但是，需要警惕以下情况：
*   如果该`README.md`文件来自不可信的来源，它可能引导用户下载或使用其他恶意文件。间接投毒的可能性较高。
*   完整的漏洞利用链可能涉及其他组件，这些组件可能被投毒。由于只提供了`README.md`文件，无法全面评估整个利用链的投毒风险。
综合考虑，投毒风险评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意OLE对象的RTF文件。
2.  受害者通过电子邮件或其他方式接收并打开该RTF文件。
3.  当Windows OLE处理该恶意OLE对象时，`UtOlePresStmToContentsStm`函数中的Use-After-Free漏洞被触发。
4.  攻击者利用该漏洞执行任意代码，例如安装恶意软件、窃取敏感信息等。

**项目地址:** [fy-poc/full-poc-CVE-2025_21298](https://github.com/fy-poc/full-poc-CVE-2025_21298)

**漏洞详情:** [CVE-2025-21298](https://nvd.nist.gov/vuln/detail/CVE-2025-21298)