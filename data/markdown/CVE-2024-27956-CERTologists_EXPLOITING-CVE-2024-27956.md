## CVE-2024-27956-WordPress Automatic-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可能导致数据库信息泄露、数据篡改甚至远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** 目标 WordPress 站点安装了存在漏洞版本的 WordPress Automatic 插件，且允许未授权访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索引擎结果，CVE-2024-27956 是 WordPress Automatic 插件中存在的一个未经身份验证的 SQL 注入漏洞。该漏洞允许攻击者执行任意 SQL 命令，从而可能导致敏感数据泄露、数据篡改，甚至在某些情况下实现远程代码执行。

**有效性：**
提供的 POC 代码尝试利用该 SQL 注入漏洞。它首先尝试创建一个恶意管理员用户（eviladmin），密码进行hash加密，然后尝试利用该用户进行下一步操作。根据代码的结构，它使用 `requests` 库发送 POST 请求到 `/wp-content/plugins/wp-automatic/inc/csv.php` 路径，payload中包含恶意的SQL语句，通过 `q` 参数传递。漏洞利用的有效性取决于目标站点是否安装了受影响版本的插件，以及数据库配置是否允许注入攻击。

**投毒风险：**
代码中存在轻微的投毒风险的可能性。虽然代码的主要目的是利用 SQL 注入创建恶意用户，但需要仔细检查代码中是否存在隐藏的后门或恶意操作。目前的分析发现，代码中使用了 colorama 库，可能会被用于隐藏恶意输出或篡改显示信息。此外，f字符串中拼接的url可能会被替换成恶意的地址，有一定的风险，综合考虑，投毒的可能性为10%。

**利用方式：**
1.  **漏洞点：** 该漏洞位于 `/wp-content/plugins/wp-automatic/inc/csv.php` 文件，该文件在处理用户提供的输入时没有进行充分的过滤和转义，导致 SQL 注入。
2.  **攻击方式：** 攻击者可以构造恶意的 SQL 查询语句，并将其作为 `q` 参数的值发送到易受攻击的端点。
3.  **利用过程：**
    *   POC 代码首先构造一个 SQL 注入 payload，用于向 `wp_users` 表中插入一个新的管理员用户。
    *   然后，它向 `/wp-content/plugins/wp-automatic/inc/csv.php` 发送 POST 请求，将 payload 作为 `q` 参数的值传递。
    *   如果 SQL 注入成功，则会在 `wp_users` 表中创建一个新的管理员用户，攻击者可以使用该用户登录 WordPress 后台。
    *  成功登录后台后，攻击者可以安装恶意插件或上传webshell从而实现RCE。

**缓解措施：**
*   将 WordPress Automatic 插件更新到 3.92.1 或更高版本。
*   实施强输入验证和输出编码，以防止 SQL 注入。
*   定期审查和更新 WordPress 站点及其插件。

**项目地址:** [CERTologists/EXPLOITING-CVE-2024-27956](https://github.com/CERTologists/EXPLOITING-CVE-2024-27956)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)