## CVE-2024-38063 Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 见CVE描述中的受影响版本列表

**利用条件:** 需要目标系统开启IPv6

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-38063 是一个 Windows TCP/IP 远程代码执行漏洞。根据搜索结果，该漏洞允许攻击者通过发送特制的 IPv6 数据包来在目标系统上执行任意代码，从而完全控制系统。该漏洞影响多个 Windows 版本，包括 Windows 10, Windows 11, Windows Server 等。漏洞利用代码提供了一个 Powershell 脚本，用于禁用或启用 IPv6 接口作为缓解措施，表明该漏洞与 IPv6 协议相关。

**有效性：**

搜索结果表明该漏洞是真实存在的，且危害严重。POC 代码提供的是一种缓解措施，即禁用 IPv6。虽然 POC 本身没有直接利用该漏洞，但说明利用漏洞可能需要 IPv6 环境。因此，可以认为存在潜在的利用方法。

**投毒风险：**

提供的 PowerShell 脚本的主要功能是禁用/启用 IPv6 网络适配器。代码本身相对简单，主要调用 `Get-NetAdapter`、`Get-NetAdapterBinding`、`Disable-NetAdapterBinding` 和 `Enable-NetAdapterBinding` 等 cmdlet。经过审查，没有发现直接恶意代码，例如执行任意命令或下载恶意文件的行为。潜在的投毒风险可能在于：

1.  **依赖模块风险：** 脚本依赖于 `NetAdapter` 模块，如果该模块本身被篡改（但可能性较低，因为是微软官方模块），则可能存在风险。
2.  **参数注入风险：**  脚本在某些函数中接受适配器名称作为参数，如果对输入没有足够的验证，可能会存在一定的参数注入风险，但这种风险较小，且难以直接构成 RCE。
3. **信息搜集** 脚本会列出所有适配器信息，攻击者可以利用此信息收集网络信息。

总体来说，该脚本本身存在投毒的可能性较低，但需要注意潜在的依赖模块和参数注入风险。综合评估，投毒风险大约为 5%。

**利用方式：**

1.  **漏洞触发：** 攻击者需要向目标系统发送特制的 IPv6 数据包。
2.  **代码执行：**  成功利用漏洞后，攻击者可以在目标系统上执行任意代码。
3.  **权限提升：** 攻击者可能利用该漏洞获取系统最高权限。

**项目地址:** [diegoalbuquerque/CVE-2024-38063](https://github.com/diegoalbuquerque/CVE-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)