## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 7.1.0-49

**利用条件:** 需要目标系统安装存在漏洞的ImageMagick版本，且magick二进制文件拥有读取目标文件的权限。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-44268 是 ImageMagick 7.1.0-49 中存在的一个信息泄露漏洞。当 ImageMagick 解析 PNG 图像时（例如，调整图像大小），生成的图像可能会嵌入任意文件的内容（如果 magick 二进制文件具有读取该文件的权限）。

**有效性评估：**
根据漏洞库信息、搜索引擎结果，以及提供的漏洞利用代码来看，这个漏洞是存在的，并且存在可利用性。

**投毒风险评估：**
提供的漏洞利用代码是一个重定向链接，指向 `https://git.rotfl.io/v/CVE-2022-44268`。直接分析提供的代码无法确定是否存在投毒，必须分析重定向后的git仓库代码。
假设该仓库包含构建恶意PNG图像的脚本，该图像在被ImageMagick处理后会将指定文件内容嵌入到输出图像中。投毒风险在于：
*   **脚本可能包含恶意依赖:** 构建脚本可能依赖未知的第三方库，这些库可能包含后门。
*   **构建过程中的注入:**  脚本本身可能看似无害，但在构建过程中被篡改，例如，通过Makefile或构建脚本中的漏洞注入恶意代码。
*   **供应链攻击:** 攻击者可能控制了脚本所依赖的某个上游项目，从而间接影响使用该脚本的用户。
*   **误导性信息:** 仓库中的文档或示例可能误导用户，导致他们以不安全的方式使用该漏洞利用工具。
由于只能看到重定向，没有实际代码，我无法分析以上任何风险，我评估只有10%的概率重定向地址存在投毒风险。

**利用方式：**
1.  构造一个恶意的 PNG 图像，该图像包含一个指令，指示 ImageMagick 读取目标文件（例如 `/etc/passwd`）。
2.  将该 PNG 图像提交给使用 ImageMagick 进行图像处理的应用程序。
3.  当 ImageMagick 处理该图像时，它会读取目标文件并将内容嵌入到生成的图像中。
4.  攻击者可以下载生成的图像并提取嵌入的文件内容，从而实现任意文件读取。

此漏洞的修复方案是升级到 ImageMagick 的最新版本，或者使用缓解措施来限制 ImageMagick 的文件读取权限。

**项目地址:** [voidz0r/CVE-2022-44268](https://github.com/voidz0r/CVE-2022-44268)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)