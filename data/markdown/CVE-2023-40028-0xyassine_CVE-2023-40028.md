## CVE-2023-40028-Ghost-任意文件读取

**漏洞编号:** CVE-2023-40028

**漏洞类型:** 任意文件读取

**影响应用:** Ghost

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 5.59.1

**利用条件:** 需要Ghost后台的高权限用户账号

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Ghost CMS中，允许具有高权限的认证用户通过上传包含符号链接的文件来读取服务器上的任意文件。

**有效性分析：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞的POC代码是有效的。PoC仓库[webpage 2, 5, 8]明确说明了其功能是利用CVE-2023-40028实现任意文件读取。

**投毒风险分析：**

提供的POC代码主要包含一个Shell脚本和一个README.md文件。Shell脚本的目的是利用Ghost的上传功能，上传一个包含指向目标文件的符号链接的zip文件，然后通过访问上传的图片来读取目标文件。脚本本身较为直接，主要操作包括：

1.  生成包含符号链接的ZIP文件
2.  使用提供的用户名和密码登录Ghost后台获取cookie
3.  上传生成的ZIP文件
4.  尝试通过URL访问符号链接指向的文件
5.  清理临时文件

README.md文件仅包含漏洞的描述、影响和修复建议。

风险点主要在于：

*   脚本需要用户名和密码才能利用，意味着需要先获得一个高权限账户，这个风险相对可控。
*   脚本的目的是读取文件，相对来说，风险在于信息泄露。

代码中并未发现明显的恶意代码，例如反弹shell、植入后门等。 风险主要集中在用户提供的用户名密码是否会泄露,但从代码功能上来看，该行为是PoC本身逻辑所需要的。 因此，投毒的可能性较低，估计为5%。但仍然建议在使用任何第三方提供的代码前进行代码审计。

**利用方式：**

1.  **权限获取：** 攻击者首先需要获得Ghost CMS后台的高权限用户账号和密码。
2.  **构造Payload：** 利用脚本中的`generate_exploit`函数，指定要读取的目标文件路径，脚本会自动生成一个包含指向目标文件的符号链接的ZIP压缩包。
3.  **身份验证：** 脚本使用提供的用户名和密码向Ghost API进行身份验证，获取cookie。
4.  **上传Payload：** 利用获取的cookie，将包含符号链接的ZIP文件上传到Ghost CMS。
5.  **触发漏洞：** 上传成功后，脚本尝试通过构造的URL访问上传的符号链接图片，从而触发任意文件读取漏洞，读取目标文件的内容。
6.  **清理：** 读取完成后，脚本会清理上传的临时文件。


**项目地址:** [0xyassine/CVE-2023-40028](https://github.com/0xyassine/CVE-2023-40028)

**漏洞详情:** [CVE-2023-40028](https://nvd.nist.gov/vuln/detail/CVE-2023-40028)