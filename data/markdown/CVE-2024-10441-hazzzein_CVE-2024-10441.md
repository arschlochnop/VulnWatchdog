## CVE-2024-10441-Synology-命令注入

**漏洞编号:** CVE-2024-10441

**漏洞类型:** 命令注入

**影响应用:** Synology DiskStation Manager (DSM) / BeeStation OS (BSM)

**危害等级:** 高危，允许远程代码执行

**影响版本:** BSM < 1.1-65374, DSM < 7.2-64570-4, DSM 7.2.1 < 7.2.1-69057-6, DSM 7.2.2 < 7.2.2-72806-1

**利用条件:** 需要网络访问，目标设备运行受影响版本的 Synology DSM/BSM

**POC 可用性:** 是

**投毒风险:** 75%

## 详情

CVE-2024-10441 是 Synology DSM 和 BeeStation OS 中的一个由于不正确的输出编码或转义而导致的命令注入漏洞。远程攻击者可以通过向 system plugin daemon 发送特制的请求，利用此漏洞执行任意代码。漏洞利用代码显示需要 Python 3.9 环境,并通过`python exploit.py -h <目标IP> -c '<命令>'`的方式来执行命令。提供的链接`https://bit.ly/43ApbAH`可能存在钓鱼风险或提供带有恶意代码的payload。尽管poc代码中没有直接的恶意代码，但是通过短链接传播的方式,恶意作者可以在链接后方投放恶意代码,所以存在投毒风险。利用方式是通过网络发送恶意构造的请求到存在漏洞的 Synology 设备上的 system plugin daemon，从而执行攻击者指定的命令。由于漏洞可以远程利用且无需用户交互,CVSS 评分为 9.8，属于严重级别。

**投毒风险分析：**

*   **短链接风险：**  提供的 POC 代码使用 `bit.ly` 短链接分享exp,无法直接查看链接指向的内容，可能存在恶意软件或payload。 这是最主要的投毒风险来源。
*   **未公开漏洞细节：** README.md 文件中没有提供详细的漏洞触发机制和验证方法，仅说明通过指定 IP 和命令执行，攻击代码的实现细节未知，增加了分析难度，可能存在隐藏的恶意行为。
*  **exploit.in 域名:** 该域名信息未知，如果被黑客控制，可能篡改exp。

由于以上不确定因素和短链接的固有风险，判断存在较高投毒风险。

**综上：** 漏洞本身危害性高，但需警惕 POC 代码的潜在投毒风险,务必在隔离环境中分析验证。

**项目地址:** [hazzzein/CVE-2024-10441](https://github.com/hazzzein/CVE-2024-10441)

**漏洞详情:** [CVE-2024-10441](https://nvd.nist.gov/vuln/detail/CVE-2024-10441)