## CVE-2023-7028-GitLab-账户接管

**漏洞编号:** CVE-2023-7028

**漏洞类型:** 账户接管

**影响应用:** GitLab

**危害等级:** 严重，可能导致账户完全控制

**影响版本:** 16.1 直到 16.1.6, 16.2 直到 16.2.9, 16.3 直到 16.3.7, 16.4 直到 16.4.5, 16.5 直到 16.5.6, 16.6 直到 16.6.4, and 16.7 直到 16.7.2

**利用条件:** 需要未打补丁的GitLab实例，以及目标用户的邮箱地址

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-7028 允许攻击者通过在密码重置过程中利用 email[] 参数，将重置邮件发送到攻击者控制的邮箱，从而接管受害者账户。 

**有效性:**

根据漏洞库信息、搜索引擎结果（特别是HackerOne报告）以及提供的PoC代码，此漏洞的PoC代码是有效的。 PoC 代码通过构造包含两个email参数（目标email和攻击者控制的email）的POST请求到 `/users/password` 端点，利用了 GitLab 的密码重置逻辑缺陷。

**投毒风险:**

检查PoC代码，没有发现明显的恶意代码。所有操作都集中在利用GitLab的密码重置功能。 该脚本的目的就是发送密码重置请求，并打印是否成功。没有发现任何尝试修改文件、执行系统命令或者进行其他恶意操作的代码。 因此，投毒风险为 0%。

**利用方式:**

1.  攻击者需要知道目标用户的邮箱地址。
2.  攻击者向GitLab的密码重置页面（`/users/password/new`）发送一个POST请求。
3.  POST请求的 `user[email][]` 参数包含两个邮箱地址：目标用户的邮箱和攻击者控制的邮箱。
4.  由于漏洞，GitLab会将密码重置邮件同时发送到这两个邮箱。
5.  攻击者通过其控制的邮箱中的链接重置目标用户的密码，从而接管账户。

此漏洞的关键在于`user[email][]`参数的利用，允许同时指定多个邮箱地址，而GitLab没有正确验证或处理这些邮箱地址，导致重置邮件发送到未经授权的邮箱。


**项目地址:** [mochammadrafi/CVE-2023-7028](https://github.com/mochammadrafi/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)