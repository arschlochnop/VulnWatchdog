## CVE-2021-25646-Apache Druid-远程代码执行

**漏洞编号:** CVE-2021-25646

**漏洞类型:** 远程代码执行

**影响应用:** Apache Druid

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** <= 0.20.0

**利用条件:** 需要目标服务器运行Apache Druid 0.20.0及更早版本，并且攻击者需要具有已认证用户的权限，或者Druid未启用身份验证，允许未经身份验证的攻击者利用(参考搜索引擎结果6)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-25646 允许认证用户通过构造特殊的请求，覆盖系统配置，从而在 Apache Druid 服务器上执行任意 JavaScript 代码。即使 JavaScript 功能被禁用，仍然可以利用此漏洞。利用方式包括：

1.  **身份验证绕过/利用：** 如果 Druid 未配置身份验证，攻击者可以未经身份验证直接利用该漏洞。
2.  **构造恶意请求：** 攻击者需要构造包含恶意 JavaScript 代码的请求，该代码将在 Druid 服务器上执行。
3.  **配置覆盖：** 该请求能够覆盖服务器配置，从而绕过 JavaScript 执行的限制。
4.  **远程代码执行：** 成功利用后，攻击者可以在目标服务器上执行任意命令，完全控制服务器。

POC代码分析：提供的POC代码（/tmp/35517cee5a63804036351d2adea12397/README.md）只是一个简单的说明文件，指示该POC用于命令注入。由于只包含`README.md`文件，本身并不包含任何可执行的漏洞利用代码，所以要判断是否存在投毒代码需要看是否会引导用户去下载其他的恶意脚本或者链接，该文件本身没有这些行为，因此判断存在投毒的风险相对较低。但是考虑到攻击者可能在其他地方托管恶意代码，并诱导用户下载执行，因此存在一定的投毒风险。需要注意，判断该POC的有效性需结合实际可执行的漏洞利用脚本。

搜索引擎结果表明，该漏洞可以被未经身份验证的攻击者利用（在某些配置下），并且存在公开可用的漏洞利用代码。


**项目地址:** [tiemio/RCE-PoC-CVE-2021-25646](https://github.com/tiemio/RCE-PoC-CVE-2021-25646)

**漏洞详情:** [CVE-2021-25646](https://nvd.nist.gov/vuln/detail/CVE-2021-25646)