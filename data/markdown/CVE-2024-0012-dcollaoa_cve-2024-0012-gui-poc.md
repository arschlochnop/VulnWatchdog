## CVE-2024-0012 PAN-OS Authentication Bypass

**漏洞编号:** CVE-2024-0012

**漏洞类型:** 身份验证绕过

**影响应用:** Palo Alto Networks PAN-OS

**危害等级:** 高危，可能导致管理员权限获取、配置篡改和进一步漏洞利用（如CVE-2024-9474）

**影响版本:** PAN-OS 10.2, 11.0, 11.1, and 11.2 (受影响版本低于已修复版本)

**利用条件:** 需要网络访问目标PAN-OS设备的管理Web界面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-0012是Palo Alto Networks PAN-OS软件中的一个身份验证绕过漏洞。未经身份验证的攻击者通过网络访问管理Web界面，可以获取PAN-OS管理员权限，执行管理操作，篡改配置或利用其他身份验证的权限提升漏洞。根据漏洞描述和搜索结果，该漏洞影响特定版本的PAN-OS，且存在在野利用。提供的POC代码（`cve-2024-0012-gui.py`）利用了此漏洞。利用方式如下：

1.  **创建初始会话：**  通过`createRemoteAppwebSession.php`端点，设置`X-PAN-AUTHCHECK`为`off`，并且在POST数据中，将`user`参数设置为包含命令注入的恶意代码。攻击者可以通过这个方式在目标机器上写入一个PHP文件，例如`cve.php`。命令通过反引号执行，将结果写入PHP文件。
2.  **触发执行：**  使用创建的`PHPSESSID` cookie，访问`/index.php/.js.map`端点，触发之前注入的命令执行。
3.  **验证执行：**  访问`/unauth/cve.php`，检查命令是否成功执行，并获取命令输出。

**投毒风险分析：**

查看`cve-2024-0012-gui.py`脚本，发现其主要功能是利用漏洞进行命令注入和验证，基本符合漏洞利用的逻辑。`self.command_input = QLineEdit()` 允许用户输入命令，增加了灵活性，但也引入了一定的风险，使用者可能使用恶意命令。但是从代码逻辑上，此仓库直接投毒的可能性较低。`README.md`文件仅包含漏洞描述和作者信息，无恶意代码。

总而言之，考虑到代码的开源性质，以及主要功能符合漏洞利用的预期，投毒的概率较低，但是命令的执行权交给了用户，如果用户使用了恶意命令，也可能造成危害。因此投毒风险评估为10%。

**项目地址:** [dcollaoa/cve-2024-0012-gui-poc](https://github.com/dcollaoa/cve-2024-0012-gui-poc)

**漏洞详情:** [CVE-2024-0012](https://nvd.nist.gov/vuln/detail/CVE-2024-0012)