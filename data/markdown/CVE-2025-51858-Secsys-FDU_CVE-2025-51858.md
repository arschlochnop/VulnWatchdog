## CVE-2025-51858 - ChatPlayground.ai XSS 和 IDOR漏洞

**漏洞编号:** CVE-2025-51858

**漏洞类型:** 跨站脚本 (XSS) 和 不安全直接对象引用 (IDOR)

**影响应用:** ChatPlayground.ai

**危害等级:** 高危，可能导致账户劫持和数据泄露

**影响版本:** 所有版本

**利用条件:** 需要用户访问存在XSS漏洞的聊天组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞包含两个部分：

1.  **跨站脚本 (XSS) 漏洞：**  ChatPlayground.ai的聊天组件存在XSS漏洞，允许攻击者通过复制粘贴恶意文本到聊天框中执行任意JavaScript代码。攻击者可以利用此漏洞窃取用户的JWT Token，进而劫持用户账户。

2.  **不安全直接对象引用 (IDOR) 漏洞：**  `/api/chat-history` endpoint存在弱访问控制。攻击者可以利用泄露的JWT token（特别是其中的用户名信息）访问受害者的聊天记录，即使在JWT Token过期后也可以访问。攻击者可以使用受害者用户名持续访问其聊天记录，造成永久性的数据泄露。

**利用方式：**

1.  攻击者构造包含SVG XSS payload的恶意文本。
2.  诱导受害者将恶意文本复制粘贴到ChatPlayground.ai的聊天组件中。
3.  恶意JavaScript代码在受害者浏览器中执行，窃取受害者的JWT Token，并从中提取用户名信息。
4.  攻击者利用窃取的用户名信息访问`/api/chat-history` endpoint，获取受害者的聊天记录。

**有效性：**
根据提供的漏洞利用代码，该漏洞利用有效，因为详细描述了漏洞的存在，利用步骤，并提供了利用该漏洞窃取JWT Token以及获取chat history的步骤以及截图，表明其经过验证。

**投毒风险：**
提供的漏洞利用代码主要包含漏洞描述和利用说明，没有发现潜在的恶意代码。存储库中包含图像文件（figure1.png, figure2.png）, 这些图像本身不太可能被利用来传播恶意软件或执行其他恶意活动, 因此投毒风险为0%。

**其他信息：**
虽然漏洞库信息为空，但搜索引擎结果中包含了CVE-2024-51858的描述，说明该漏洞是经过认证的。Scribd上的网页(webpage 5)标题中提到51858并提及PoC证明了可以通过在帖子中插入恶意payload来利用此漏洞，这进一步验证了漏洞的真实性。

**项目地址:** [Secsys-FDU/CVE-2025-51858](https://github.com/Secsys-FDU/CVE-2025-51858)

**漏洞详情:** [CVE-2025-51858](https://nvd.nist.gov/vuln/detail/CVE-2025-51858)