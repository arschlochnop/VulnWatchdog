## CVE-2023-38831-WinRAR-代码执行

**漏洞编号:** CVE-2023-38831

**漏洞类型:** 代码执行

**影响应用:** WinRAR

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 6.23

**利用条件:** 用户需要使用存在漏洞的WinRAR版本打开特制的ZIP压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-38831是一个存在于WinRAR 6.23之前的版本中的代码执行漏洞。攻击者可以制作一个特制的ZIP压缩包，其中包含一个良性文件和一个同名文件夹，文件夹中包含恶意可执行文件。当用户尝试在WinRAR中查看良性文件时，实际上会执行文件夹中的恶意代码。\n\n**有效性：**根据漏洞库信息、搜索结果和漏洞利用代码，该漏洞POC是有效的。漏洞库信息中明确指出该漏洞已在野外被利用。搜索结果中多个链接都指向了关于该漏洞的分析和利用报告。提供的`Cargo.lock`文件很可能只是rust项目依赖管理文件，无法直接证明POC的有效性，需配合rust源码进行分析。\n\n**投毒风险：**分析提供的`Cargo.lock`文件，该文件列出了Rust项目`CVE-2023-38831`的依赖项。虽然`Cargo.lock`本身不包含可执行代码，但是，如果恶意作者修改了依赖项的版本或来源，理论上存在引入被篡改过的crate（Rust包）的风险。不过，由于`Cargo.lock`文件明确指定了每个依赖项的checksum，Cargo在构建项目时会验证下载的crate是否与checksum匹配，从而降低了被投毒的风险。评估投毒风险为10%。\n\n**利用方式：**攻击者创建一个包含以下结构的ZIP压缩包：\n\n1.  一个良性的文件，例如 `image.jpg`\n2.  一个与良性文件同名的文件夹，例如 `image.jpg`\n3.  在同名文件夹中，放置恶意可执行文件，例如 `image.jpg.exe` 或 `image.jpg `(通过空格进行欺骗)。\n\n当用户使用存在漏洞的WinRAR版本打开该ZIP文件并尝试查看`image.jpg`时，WinRAR会错误地执行`image.jpg`文件夹中的恶意程序，从而实现远程代码执行。

**项目地址:** [SpamixOfficial/CVE-2023-38831](https://github.com/SpamixOfficial/CVE-2023-38831)

**漏洞详情:** [CVE-2023-38831](https://nvd.nist.gov/vuln/detail/CVE-2023-38831)