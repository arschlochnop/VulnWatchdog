## CVE-2025-10041 - Flex QR Code Generator WordPress Plugin Arbitrary File Upload

**漏洞编号:** CVE-2025-10041

**漏洞类型:** 任意文件上传

**影响应用:** Flex QR Code Generator WordPress插件

**危害等级:** 高危，可导致远程代码执行

**影响版本:** <= 1.2.5 (基于readme.txt的判断)

**利用条件:** 需要WordPress网站安装Flex QR Code Generator插件，且版本小于等于1.2.5

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

此POC利用了Flex QR Code Generator插件中存在的任意文件上传漏洞。攻击者可以通过上传包含恶意代码的PHP文件（webshell）到服务器，从而实现远程代码执行。  

**利用方式：**
1.  **版本检测：**  通过访问`readme.txt`文件来确定目标插件的版本是否在受影响范围内（<=1.2.5）。
2.  **webshell生成：**  生成包含恶意代码的PHP webshell文件，可以使用简单的命令执行代码或者base64编码混淆。
3.  **文件名编码：**  如果需要，对webshell的文件名进行编码（base64或URL编码）来绕过某些安全限制。
4.  **构建Payload：**  构造包含webshell文件和相关参数（qrName, qrDesc, qrData, isTrackingEnabled）的multipart/form-data请求。
5.  **文件上传：**  通过`wp-admin/admin-ajax.php`接口上传webshell文件，利用`flexqr_save_qr` action。
6.  **上传后的文件名获取：**  解析响应JSON数据，获取上传后的文件名，包含插入ID。
7.  **访问webshell：**  通过构造特定的URL来访问上传的webshell，执行任意命令。

**有效性：**  POC代码有效，它能够自动化利用此漏洞，上传webshell并执行命令。

**投毒风险：**  虽然POC主要功能是漏洞利用，但存在潜在的投毒风险。具体体现在以下几点：
1.  **随机Header：**  虽然随机User-Agent和Referer是为了模拟正常流量，但也可能包含恶意链接或代码。
2.  **文件名/内容编码：**  虽然编码是为了绕过WAF，但也可能被用于隐藏恶意代码，导致更隐蔽的攻击。
3.  **`evil.com` Referer：** 在随机referer中包含了`evil.com`，如果攻击者控制了`evil.com`，可能会记录利用者的信息或者重定向到恶意站点。
4.  **`shell_exec($_GET['cmd'])` 使用：**  这个 webshell 非常危险，直接使用 `$_GET['cmd']` 作为参数，没有任何过滤，攻击者可以执行任何系统命令。在实际利用中，攻击者可能将 `shell_exec($_GET['cmd'])`替换为更复杂的后门代码。

综合评估，投毒风险较低，主要集中在使用的referer和可能被替换的webshell内容上。需要仔细检查POC代码，特别是webshell生成部分。

**项目地址:** [Nxploited/CVE-2025-10041](https://github.com/Nxploited/CVE-2025-10041)

**漏洞详情:** [CVE-2025-10041](https://nvd.nist.gov/vuln/detail/CVE-2025-10041)