## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/15, 2019 CU3/4

**利用条件:** 需要具有Exchange用户的凭据或能够获取到凭据，以及能够访问Exchange Control Panel (ECP)。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是一个 Microsoft Exchange Server 的远程代码执行漏洞，源于 Exchange Control Panel (ECP) 在处理内存对象时的方式不当。攻击者可以利用静态密钥进行 ViewState 反序列化，从而执行任意代码。漏洞利用通常涉及以下步骤：

1.  **获取有效的Exchange用户凭据：** 攻击者需要拥有Exchange服务器上用户的有效凭据才能访问ECP。
2.  **构造恶意的ViewState:**  攻击者使用静态密钥构造一个包含恶意代码的 ViewState 对象。
3.  **发送请求：**  攻击者将构造的 ViewState 对象通过 HTTP 请求发送到易受攻击的 ECP 页面。
4.  **代码执行：** Exchange服务器反序列化 ViewState 对象，从而执行攻击者嵌入的恶意代码。

提供的POC代码 `/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml` 似乎是一个XML文档，描述了 `FSharp.Core` 程序集的成员。它本身不太可能是直接的利用代码，更像是程序集的一部分或文档。实际的利用代码可能使用这个程序集或其他方式来构造恶意的ViewState。

根据搜索引擎结果，已经有针对此漏洞的公开PoC，并且该漏洞已被积极利用。例如，[zyn3rgy/ecp_slap](https://github.com/zyn3rgy/ecp_slap)仓库包含扫描和利用易受攻击的Exchange实例的函数。

**有效性：** 根据漏洞库信息和搜索引擎结果，该漏洞确实存在并且已被利用，因此利用是有效的。

**投毒风险：**提供的代码片段(`/tmp/01ddbe7d3c9df93cbdc1b119a0d43d96/FSharp.Core.xml`)本身不太可能包含投毒代码，因为看起来只是一个XML文档，描述FSharp.Core程序集的成员。然而，如果从不可信的来源获取完整的利用代码，则存在投毒风险。例如，在其他未提供的代码中，作者可能隐藏了后门或恶意功能。由于只看到部分代码，无法完全排除风险，因此假设有10%的投毒风险。

**利用方式：** 利用方式是利用ECP的ViewState反序列化漏洞，结合已知的静态密钥来执行任意代码。攻击者需要有效的Exchange用户凭据才能访问ECP。攻击者构造一个包含恶意代码的ViewState对象，并将其发送到易受攻击的ECP页面。服务器反序列化该对象后，就会执行恶意代码，从而允许攻击者完全控制Exchange服务器。

**项目地址:** [truongtn/cve-2020-0688](https://github.com/truongtn/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)