## CVE-2025-24071 Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露

**影响应用:** Windows File Explorer

**危害等级:** 中危，泄露NTLM hash可能导致权限提升

**影响版本:** 受影响的Windows版本（详见漏洞库信息）

**利用条件:** 受害者机器开启SMB服务，且攻击者可访问该SMB服务。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071 漏洞允许攻击者通过诱导用户访问特制的`.library-ms`文件，泄露用户的NTLM hash。PoC代码显示攻击者创建一个包含指向攻击者控制的SMB服务器的`.library-ms`文件，并将其打包成`.tar`文件。当受害者访问包含`.library-ms`文件的`.tar`文件时，Windows File Explorer会尝试连接到攻击者的SMB服务器以解析库文件，这个过程中会发送用户的NTLM hash。利用方式如下：

1.  **攻击者准备：**
    *   运行Responder或者其他SMB服务器。
    *   使用 `poc_tar.py` 脚本生成恶意的 `.library-ms` 文件，该文件包含指向攻击者控制的SMB服务器的UNC路径。
    *   将生成的 `.library-ms` 文件打包到 `exploit.tar` 文件中。
2.  **攻击者部署：**
    *   将 `exploit.tar` 文件放置在受害者可访问的SMB共享目录中。
3.  **受害者触发：**
    *   受害者通过File Explorer访问该SMB共享目录，并尝试访问`exploit.tar` (例如, 使用 `smbclient`提取该文件)。 Windows File Explorer会自动尝试解析其中的 `.library-ms` 文件，触发NTLM认证。
4.  **攻击者捕获：**
    *   Responder捕获受害者的NTLM hash。
5.  **攻击者破解/利用：**
    *   攻击者可以使用hashcat等工具破解NTLM hash，或者利用NTLM relay攻击进行权限提升。

PoC代码中未发现明显的投毒代码。脚本 `poc_tar.py` 只是生成一个`.library-ms`文件，并将该文件打包到`.tar`文件中。主要的风险在于利用该漏洞本身带来的安全风险，即泄露用户的NTLM hash。搜索引擎结果也证实该漏洞可以通过构造恶意网络共享来捕获NTLM凭据。

**项目地址:** [ex-cal1bur/SMB_CVE-2025-24071](https://github.com/ex-cal1bur/SMB_CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)