## CVE-2023-4220 Chamilo LMS Unauthenticated Big Upload File Remote Code Execution

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，未经身份验证的攻击者可以通过上传恶意文件执行任意代码。

**影响版本:** <= 1.11.24

**利用条件:** 目标系统运行Chamilo LMS 1.11.24或更早版本，且未应用补丁。攻击者需要能够访问目标系统的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 漏洞存在于 Chamilo LMS 的 bigUpload.php 文件中，允许未经身份验证的攻击者上传任意文件，包括 webshell。根据漏洞库信息和搜索引擎结果，该漏洞的CVSS评分为高危，攻击者可以利用此漏洞执行存储型跨站脚本攻击 (XSS) 并获得远程代码执行 (RCE) 权限。

**利用方式：**
1.  攻击者使用提供的 PoC 脚本 (exploit.py)。
2.  该脚本首先上传一个包含恶意 PHP 代码的 webshell 文件到目标 Chamilo LMS 系统的 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 路径。
3.  上传成功后，攻击者可以通过访问上传的 webshell 文件，并传递 `cmd` 参数来执行任意系统命令。例如： `http://lms.target-site/main/inc/lib/javascript/bigupload/files/my_shell.php?cmd=id`
4.  PoC 脚本会显示命令执行的结果。

**有效性评估：**
根据PoC代码中的描述,该利用代码经验证有效，可以实现未经身份验证的远程代码执行。

**投毒风险分析：**
查看PoC代码，主要功能为上传webshell并执行命令。虽然存在远程代码执行的风险，但PoC本身的目的就是利用漏洞，所以不属于投毒代码。在LICENSE文件和README文件中没有发现恶意代码，根据作者以前的项目, 判断此仓库中作者隐藏的投毒代码可能性较低。因此，投毒风险较低，评估为1%。

**项目地址:** [0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit](https://github.com/0x00-null/Chamilo-CVE-2023-4220-RCE-Exploit)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)