## CVE-2017-8291-Ghostscript-远程命令执行

**漏洞编号:** CVE-2017-8291

**漏洞类型:** 远程命令执行

**影响应用:** Ghostscript

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** through 2017-04-26

**利用条件:** 需要目标系统运行存在漏洞的Ghostscript版本，并能够处理恶意EPS文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-8291 漏洞允许攻击者通过构造恶意的EPS文件，利用`.rsdparams`类型混淆和`/OutputFile (%pipe%`字符串绕过 `-dSAFER` 保护，从而执行任意命令。 

**有效性：** 根据漏洞库信息和搜索结果，该漏洞在野外已被利用，并且存在公开的Exploit-DB条目（https://www.exploit-db.com/exploits/41955/），表明该漏洞是可利用的。

**投毒风险：** 提供的代码片段是GNU GPL许可证，并非漏洞利用代码本身。因此，直接从该代码片段评估投毒风险较为困难。但是，考虑到漏洞利用涉及到上传恶意EPS文件，攻击者可能在EPS文件中嵌入恶意代码（例如，利用PostScript语言的特性）来进一步控制系统或进行其他恶意活动。因此，存在一定的投毒风险。虽然提供的license文件本身不包含恶意代码，但是下载和使用漏洞利用代码时，需要仔细检查其他相关文件，以防止引入恶意代码。

**利用方式：**
1.  攻击者构造一个包含恶意PostScript代码的EPS文件。
2.  该EPS文件利用`.rsdparams`类型混淆，绕过 `-dSAFER` 保护。
3.  恶意代码使用`/OutputFile (%pipe%`将命令注入到shell中执行，实现远程命令执行。

根据搜索结果，该漏洞利用涉及到类型混淆和管道命令注入，影响较大，因此建议及时更新Ghostscript版本。

**项目地址:** [hkcfs/PIL-CVE-2017-8291](https://github.com/hkcfs/PIL-CVE-2017-8291)

**漏洞详情:** [CVE-2017-8291](https://nvd.nist.gov/vuln/detail/CVE-2017-8291)