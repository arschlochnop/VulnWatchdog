## CVE-2020-1472 (Zerologon) Netlogon 权限提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本众多，参见漏洞库信息

**利用条件:** 需要位于与域控制器相同的网络，无需身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是一个严重的权限提升漏洞，存在于 Netlogon 远程协议 (MS-NRPC) 中。未经身份验证的攻击者可以通过建立与域控制器的脆弱 Netlogon 安全通道连接来利用此漏洞，最终获得域管理员权限。

**利用方式：**
1.  攻击者使用漏洞利用脚本（例如提供的`zerologon_tester.py`）通过 MS-NRPC 与域控制器建立连接。
2.  脚本利用 Netlogon 协议中的加密缺陷，将域控制器的计算机帐户密码重置为空。
3.  攻击者现在可以使用重置的密码或使用其他技术（例如 DCSync）来转储域凭据。
4.  攻击者可以使用获得的域凭据来控制域。

**有效性：**
提供的 PoC 代码 (`zerologon_tester.py`) 旨在验证域控制器的漏洞，并且根据描述，它能够成功地表明目标可以被 ZeroLogon 攻击完全攻破。搜索结果也证实了此漏洞的严重性和可利用性。

**投毒风险：**
尽管主要代码似乎是为了检测漏洞，但该仓库中存在投毒风险的可能性较低，估计为10%。原因如下：
* 仓库主要目的是演示检测和缓解措施，而非直接的攻击利用。
* 代码使用了公开可用的 PoC 脚本，来源SecuraBV，降低了作者自行添加恶意代码的可能性。
*  虽然存在修改 Suricata 配置文件的步骤，但这通常是出于配置目的，但仍然可能存在恶意配置被添加到 Suricata 规则中。因此，用户在使用该仓库中的脚本和规则时，应仔细审查代码和配置，确保没有隐藏的恶意行为。

**项目地址:** [tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation](https://github.com/tdevworks/CVE-2020-1472-ZeroLogon-Demo-Detection-Mitigation)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)