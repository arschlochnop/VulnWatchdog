## CVE-2023-26049-Eclipse Jetty Cookie Smuggling

**漏洞编号:** CVE-2023-26049

**漏洞类型:** 信息泄露

**影响应用:** Eclipse Jetty

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 9.4.51, >= 10.0.0, < 10.0.14, >= 11.0.0, < 11.0.14, >= 12.0.0.alpha0, < 12.0.0.beta0

**利用条件:** 需要目标服务器运行存在漏洞的Jetty版本，以及能够发送包含恶意构造的Cookie的HTTP请求。

**POC 可用性:** 否

**投毒风险:** 10%

## 详情

CVE-2023-26049 存在于 Eclipse Jetty 的 cookie 解析过程中。当 Jetty 遇到以双引号 `"` 开头的 cookie 值时，它会持续读取 cookie 字符串，直到遇到一个闭合的引号，即使在此过程中遇到了分号。这允许攻击者将其他 cookie “走私”到这个 cookie 中。如果走私的 cookie 是 `HttpOnly` 的，并且包含走私 cookie 的 cookie 值呈现在页面上，攻击者可以提取 `HttpOnly` cookie。漏洞利用方式如下：

1.  攻击者构造一个恶意 cookie，该 cookie 的值以双引号开始，并包含攻击者想要窃取的其他 cookie（例如 `JSESSIONID`）。例如： `DISPLAY_LANGUAGE="b; JSESSIONID=1337; c=d"`
2.  攻击者将包含恶意 cookie 的 HTTP 请求发送到易受攻击的 Jetty 服务器。
3.  Jetty 将解析该 cookie，并将 `DISPLAY_LANGUAGE` 的值设置为 `b; JSESSIONID=1337; c=d`。
4.  如果服务器将 `DISPLAY_LANGUAGE` 的值呈现在页面上，攻击者可以通过查看页面的源代码来窃取 `JSESSIONID` cookie。

提供的代码片段看起来是 Whitesource 扫描action，和jetty漏洞本身没有直接关系。 代码片段中包含的jdbcRealm.properties 可能存在安全问题，如果默认配置被使用，攻击者可能通过弱口令或者默认密码的方式来尝试连接数据库，但这与cookie走私漏洞无关。 代码存在投毒风险，主要源于该 action 可能被用于扫描其他项目，如果该action被篡改，添加了恶意代码，可能会影响使用该action进行扫描的其他项目。考虑到 Whitesource 是一家安全公司，且该 Action 的目的是进行安全扫描，加入恶意代码的动机较低，因此投毒风险较低，约 10%。

**项目地址:** [uthrasri/jetty-9.4.31.v20200723_CVE-2023-26049](https://github.com/uthrasri/jetty-9.4.31.v20200723_CVE-2023-26049)

**漏洞详情:** [CVE-2023-26049](https://nvd.nist.gov/vuln/detail/CVE-2023-26049)