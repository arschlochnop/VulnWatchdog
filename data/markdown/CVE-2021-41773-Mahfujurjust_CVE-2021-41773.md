## CVE-2021-41773-Apache HTTP Server-路径遍历

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可能导致文件泄露和远程代码执行

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且受影响的目录未配置"require all denied"。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-41773 存在于 Apache HTTP Server 2.4.49 的路径规范化更改中。攻击者可以利用路径遍历攻击将 URL 映射到由 Alias 类指令配置的目录之外的文件。如果这些目录之外的文件不受通常的默认配置“require all denied”保护，则这些请求可能会成功。如果为这些别名路径启用了 CGI 脚本，则可能允许远程代码执行。

**有效性：**
根据漏洞库信息，该漏洞已被在野利用，说明漏洞的利用具有实际的可能性。

**投毒风险：**
提供的POC代码是一个简单的HTML页面，显示一个404错误页面，并提示存在CVE-2021-41773漏洞。代码本身的功能是展示漏洞的存在，而不包含任何恶意代码。虽然不直接包含投毒代码，但是可能存在间接的风险，例如诱导用户访问恶意网站或执行其他恶意操作。因此，判断投毒风险为10%。

**利用方式：**
1.  **路径遍历：** 攻击者构造包含`..`的URL，尝试访问服务器上的任意文件。例如，`http://target/../../../../etc/passwd`尝试读取`/etc/passwd`文件。
2.  **绕过访问控制：** 漏洞利用依赖于Alias指令配置的目录之外的文件没有被"require all denied"保护。如果存在疏忽配置，攻击者可以访问这些文件。
3.  **远程代码执行（可选）：** 如果目标服务器为受影响的别名路径启用了CGI脚本，攻击者可以通过上传并执行恶意CGI脚本来实现远程代码执行。

总而言之，该漏洞利用的有效性高，风险等级为高危，利用方式主要是路径遍历，如果目标环境配置不当，可能造成远程代码执行。

**项目地址:** [Mahfujurjust/CVE-2021-41773](https://github.com/Mahfujurjust/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)