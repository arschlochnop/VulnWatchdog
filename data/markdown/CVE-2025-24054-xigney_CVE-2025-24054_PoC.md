## CVE-2025-24054-NTLM Hash Disclosure Spoofing

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM哈希泄露欺骗

**影响应用:** Windows NTLM

**危害等级:** 中危，可能导致凭据泄露，但需要用户交互

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要攻击者能够诱使用户打开恶意文件或访问恶意共享。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24054是一个Windows NTLM哈希泄露欺骗漏洞。攻击者可以利用该漏洞诱使用户连接到攻击者控制的服务器，从而捕获用户的NTLM哈希。

**有效性分析：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，可以判断该漏洞是有效的，并且已被积极利用。CISA已将其添加到已知被利用漏洞目录中。搜索引擎结果显示，攻击者利用恶意`.library-ms`文件通过钓鱼攻击来泄露NTLM哈希。

提供的PoC代码是一个Python脚本，用于生成恶意的`.library-ms`文件。该文件包含一个指向攻击者控制的IP地址的`url`。当用户打开这个`.library-ms`文件时，Windows会尝试访问指定的URL，并使用NTLM身份验证。攻击者可以在其服务器上捕获用户的NTLM哈希。

**投毒风险分析：**

分析PoC代码，没有发现任何明显的投毒代码。该脚本的功能很明确，就是生成一个包含恶意URL的`.library-ms`文件。因此，该仓库中存在作者隐藏的投毒代码的可能性为0%。

**利用方式分析：**

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的服务器的URL（使用提供的PoC脚本）。
2.  攻击者通过钓鱼邮件或其他方式，诱使用户下载并打开该文件。
3.  当用户打开该文件时，Windows会尝试连接到攻击者控制的服务器，并发送用户的NTLM哈希。
4.  攻击者捕获用户的NTLM哈希，并尝试破解它以获取用户的密码。

**优先级排序依据：**
根据您的指示,我遵循了以下优先级顺序对信息进行分析：搜索引擎结果>漏洞利用代码>漏洞库信息
搜索引擎结果突出了漏洞的活跃利用和攻击方式（钓鱼攻击）。漏洞利用代码揭示了生成恶意`.library-ms`文件的细节。漏洞库信息提供了受影响的Windows版本和基本漏洞描述。


**项目地址:** [xigney/CVE-2025-24054_PoC](https://github.com/xigney/CVE-2025-24054_PoC)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)