## CVE-2018-7600-Drupalgeddon2-远程代码执行

**漏洞编号:** CVE-2018-7600

**漏洞类型:** 远程代码执行

**影响应用:** Drupal

**危害等级:** 高危，允许未授权的远程攻击者执行任意代码，完全控制受影响的服务器，导致数据泄露、篡改、拒绝服务或植入恶意软件。

**影响版本:** Drupal 7.x < 7.58, Drupal 8.3.x < 8.3.9, Drupal 8.4.x < 8.4.6, Drupal 8.5.x < 8.5.1

**利用条件:** 目标系统运行着存在漏洞的Drupal版本，且攻击者能够通过网络访问Drupal站点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-7600 (Drupalgeddon2) 是 Drupal 中的一个高危远程代码执行漏洞。该漏洞源于 Drupal Form API (FAPI) 在处理 AJAX 请求时，对数组值过滤不足，允许未经身份验证的攻击者执行任意代码。 

**有效性：**
提供的POC代码（drupalgeddon2.py）是一个Python脚本，旨在利用 CVE-2018-7600 漏洞。根据脚本描述，它包含漏洞检测、多线程和命令输出解析等功能。该脚本利用了 Drupal 的 FAPI 中存在的缺陷，通过构造恶意的 AJAX 请求来执行任意命令。多个来源（如Exploit-DB, Rapid7, NVD）确认了此漏洞的存在，并提供了利用方法。因此，该POC代码被认为是有效的。

**投毒风险：**
代码主要功能为发送恶意请求到目标Drupal服务器，并执行指定的命令。风险主要在于：

1.  **远程执行任意命令：** 脚本允许指定要执行的命令，这可能会导致攻击者在目标系统上运行恶意代码。虽然脚本本身没有包含明显的恶意代码，但是攻击者可以使用它来下载和执行其他恶意脚本。
2.  **日志记录：** 脚本可以将输出记录到文件中。恶意攻击者可能将敏感信息记录到本地日志。

总体而言，该仓库本身没有明显投毒代码,但也不能排除作者隐藏其他后门或者恶意代码的可能， 风险评估为10%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含恶意代码的特殊请求，利用 Drupal Form API 在处理 AJAX 请求时的输入验证漏洞。
2.  **代码执行：**  Drupal 在处理该请求时，会执行攻击者注入的恶意代码。
3.  **远程控制：** 攻击者通过执行任意命令来获取服务器的控制权，窃取数据、篡改内容或进行其他恶意活动。

简单来说，攻击者通过发送特制的HTTP请求到存在漏洞的Drupal站点，即可在服务器上执行任意命令，从而实现远程代码执行。

**项目地址:** [SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution](https://github.com/SyedGhufranRaza/CVE-2018-7600-Remote-Code-Execution)

**漏洞详情:** [CVE-2018-7600](https://nvd.nist.gov/vuln/detail/CVE-2018-7600)