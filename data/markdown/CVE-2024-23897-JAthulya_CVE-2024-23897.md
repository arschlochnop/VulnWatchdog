## CVE-2024-23897 - Jenkins Arbitrary File Read

**漏洞编号:** CVE-2024-23897

**漏洞类型:** Arbitrary File Read

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露和潜在的RCE

**影响版本:** Jenkins 2.441及更早版本, LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口（可能通过HTTP, WebSocket或SSH）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取Jenkins控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中的一个功能，该功能会将参数中以“@”字符开头的路径替换为文件内容。 攻击者可以利用此功能，通过构造包含目标文件路径的恶意 CLI 命令来读取服务器上的任意文件。

**有效性分析:**

根据漏洞库信息，该漏洞存在于 Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本。搜索结果也确认了该漏洞的存在和高危性。提供的 POC 代码 `CVE-2024-23897.py` 尝试通过发送特制的 HTTP 请求来利用此漏洞。代码首先创建一个会话 ID，然后使用 `get_payload` 函数构造包含目标文件路径的 payload，接着使用两个线程并发发送请求：一个用于设置连接（download side），另一个用于发送包含payload的请求(upload side)。这利用了 Jenkins CLI 的特性，将指定文件内容读取出来。根据 README.md，该脚本的目的是为了帮助理解攻击请求和响应的组合，通常需要借助代理工具才能查看到结果。

**投毒风险分析:**

在提供的 `CVE-2024-23897.py` 和 `README.md` 文件中，没有发现明显的恶意代码或后门。代码逻辑清晰，主要功能是构造和发送 HTTP 请求来利用 Jenkins CLI 的文件读取漏洞。虽然代码中使用了代理配置，但这是为了方便调试和观察请求/响应，本身不构成投毒。`get_payload` 函数用于构造payload，`createpayload`函数根据指定路径创建 payload，该脚本功能就是读取文件，因此投毒可能性较低。

**利用方式:**

1.  **确定目标 Jenkins 实例存在漏洞：** 版本在受影响范围内（Jenkins 2.441 及更早版本，LTS 2.426.2 及更早版本）。
2.  **获取 Jenkins CLI 接口的访问权限：**  可以通过 HTTP、WebSocket 或 SSH 访问 Jenkins CLI。
3.  **构造包含目标文件路径的恶意 CLI 命令：** 使用 `CVE-2024-23897.py` 脚本，指定目标 Jenkins URL 和要读取的文件路径。例如，要读取 `/etc/passwd` 文件，可以执行 `python3 CVE-2024-23897.py -u <Jenkins URL> -p /etc/passwd`。
4.  **发送恶意 CLI 命令：**  POC代码通过发送带有特殊构造的header的POST请求触发漏洞。
5.  **获取文件内容：**  通过代理工具拦截响应包获取文件内容。

总而言之，提供的POC代码有效，可以用于利用 CVE-2024-23897 读取 Jenkins 服务器上的任意文件，并且没有明显的投毒风险。

**项目地址:** [JAthulya/CVE-2024-23897](https://github.com/JAthulya/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)