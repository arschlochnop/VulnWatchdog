## CVE-2024-3640 - Rockwell Automation FactoryTalk Remote Access 未引用搜索路径或元素

**漏洞编号:** CVE-2024-3640

**漏洞类型:** 未引用搜索路径或元素 (CWE-428)

**影响应用:** Rockwell Automation FactoryTalk Remote Access

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** v13.5.0.174

**利用条件:** 需要管理员权限和用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3640 是关于 Rockwell Automation FactoryTalk® Remote Access™ 中存在未引用可执行路径的漏洞。攻击者需要在安装 FTRA 时利用此漏洞，通过放置恶意可执行文件到未被正确引用的路径中，从而以 SYSTEM 用户身份执行任意代码。该漏洞利用需要管理员权限，并且在安装过程中需要用户交互（例如，修改安装路径）。

**有效性评估：**

根据漏洞信息和搜索结果，该漏洞是真实存在的，并且已经被分配了 CVE 编号。提供的漏洞利用代码（Woodpecker 插件）是针对该漏洞的 Web 应用防火墙（WAF）绕过，目标是 GeoServer 漏洞（但是描述中错误的描述成了geoserver的漏洞）。实际上，这部分代码与FactoryTalk Remote Access vulnerability的原始漏洞并没有直接关系。漏洞利用有效性取决于在存在WAF的环境中，该绕过技术是否成功。 该漏洞主要依赖于利用 XML 注释符来绕过关键字过滤，从而实现延时检测、回显命令执行和自定义内存马的注入。 但是该插件的poc验证的description存在和CVE-2024-3640不一致的情况. 插件作者可能在描述中混合了对GeoServer漏洞的描述

**投毒风险分析：**

提供的代码是 Woodpecker 插件，用于绕过 WAF。虽然核心功能是 WAF 绕过，但潜在的投毒风险在于，攻击者可能会在绕过代码中添加恶意代码，例如植入后门或执行其他恶意操作。由于代码相对清晰，主要集中在 WAF 绕过技术上，因此投毒的概率相对较低，约为 10%。 需要注意的是，如果该插件被恶意修改，可能会在目标系统上执行未经授权的操作。

**利用方式：**

1.  攻击者首先需要获得管理员权限，以便能够修改 FactoryTalk® Remote Access™ 的安装路径。
2.  在安装过程中，攻击者将恶意可执行文件放置在未被正确引用的路径中。
3.  当系统尝试以 SYSTEM 用户身份执行未引用的路径中的可执行文件时，会执行攻击者的恶意代码，从而导致远程代码执行。

**总结：**

CVE-2024-3640 是一个潜在的风险漏洞，允许攻击者通过利用未引用的可执行路径来执行任意代码。该漏洞的利用需要管理员权限和用户交互。提供的 Woodpecker 插件主要是针对 WAF 的绕过技术，虽然有潜在的投毒风险，但风险较低。该插件利用 XML 注释符绕过 WAF，以实现更深层次的攻击。 整体而言， FactoryTalk Remote Access vulnerability的原始漏洞和Woodpecker plugin插件之间没有明显的关联.

**项目地址:** [H1ng007/CVE-2024-3640_WafBypass](https://github.com/H1ng007/CVE-2024-3640_WafBypass)

**漏洞详情:** [CVE-2024-3640](https://nvd.nist.gov/vuln/detail/CVE-2024-3640)