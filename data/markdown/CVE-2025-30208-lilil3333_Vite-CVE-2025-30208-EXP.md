## CVE-2025-30208-Vite-任意文件读取

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 任意文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0 < 5.4.15, >= 6.0.0 < 6.0.12, >= 6.1.0 < 6.1.2, >= 6.2.0 < 6.2.3

**利用条件:** Vite dev server 需显式暴露到网络 (使用 `--host` 或 `server.host` 配置选项), 需要用户交互（用户访问构造的URL）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-30208是Vite前端开发工具的一个任意文件读取漏洞。该漏洞源于Vite在处理包含`?raw??` 或 `?import&raw??`的URL时，绕过了`server.fs.deny`的限制，导致可以读取Vite服务目录之外的文件内容。

**有效性：**

提供的POC代码有效。该代码通过构造包含`/@fs/{filepath}?import&raw?&`的URL，尝试读取目标服务器上的文件。代码中包含了默认的敏感文件检测（如`etc/passwd`和`C://windows/win.ini`），以及基础系统信息探测和增强版的系统探测功能。代码使用`requests`库发送HTTP请求，并根据返回的状态码和内容判断文件是否读取成功。

**投毒风险：**

代码中未发现明显的投毒代码。代码的功能主要是利用漏洞读取文件内容，没有发现任何主动向服务器写入文件、执行恶意代码或者进行其他恶意操作的痕迹。作者没有隐藏任何后门或者恶意逻辑，故判断投毒风险为0%。

**利用方式：**

1.  **漏洞触发：**  攻击者构造包含`?raw??` 或 `?import&raw??`的恶意URL，例如：`http://target.com/@fs/etc/passwd?import&raw?&`。
2.  **绕过限制：**  Vite服务器在处理该URL时，由于对`?`等字符的处理不当，绕过了`server.fs.deny`的访问控制。
3.  **文件读取：**  服务器返回被请求的文件内容，攻击者从而获取敏感信息。

**搜索引擎结果佐证：**

搜索引擎结果表明，该漏洞是一个公开的任意文件读取漏洞，存在多个相关的漏洞描述和安全公告。其中sploitus.com的链接可能包含更详细的利用分析。

**风险缓解措施：**

*   升级Vite到安全版本（>= 4.5.10, >= 5.4.15, >= 6.0.12, >= 6.1.2, >= 6.2.3）。
*   避免将Vite开发服务器暴露到公共网络。
*   配置严格的文件访问控制策略。

**项目地址:** [lilil3333/Vite-CVE-2025-30208-EXP](https://github.com/lilil3333/Vite-CVE-2025-30208-EXP)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)