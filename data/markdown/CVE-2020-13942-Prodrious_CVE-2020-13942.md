## CVE-2020-13942-Apache Unomi-远程代码执行

**漏洞编号:** CVE-2020-13942

**漏洞类型:** 远程代码执行

**影响应用:** Apache Unomi

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.5.2

**利用条件:** 需要目标服务器开放/context.json endpoint

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-13942 存在于 Apache Unomi 1.5.2 之前的版本中。该漏洞允许未经身份验证的远程攻击者通过向 `/context.json` 端点注入恶意 OGNL 或 MVEL 脚本来执行任意代码。

**有效性：**
提供的 POC 代码 `CVE-2020-13942.sh` 看起来是有效的。它通过发送包含恶意 OGNL/MVEL 表达式的 POST 请求到 `/context.json` 端点来利用该漏洞。脚本会检查响应中是否包含 "boom" 字符串，如果存在，则认为目标易受攻击。

**投毒风险：**
查看提供的 `CVE-2020-13942.sh` 和 `README.md` 文件，没有明显的迹象表明存在恶意代码或后门。脚本的功能是利用已知的漏洞执行命令。因此，投毒风险较低，估计为 0%。 代码逻辑较为简单，没有发现异常操作，主要是发送一个包含payload的http请求。

**利用方式：**
1.  **确定目标：** 找到运行着 Apache Unomi 且版本低于 1.5.2 的服务器。
2.  **发送恶意请求：** 使用类似提供的 POC 脚本，构造一个包含恶意 OGNL 或 MVEL 表达式的 JSON 数据，并将其作为 POST 请求发送到目标的 `/context.json` 端点。
3.  **代码执行：** 如果目标存在漏洞，Unomi 会执行注入的脚本，从而允许攻击者执行任意代码。本例子的POC中，payload是执行id命令。

**总结：**
CVE-2020-13942 是一个高危漏洞，利用起来相对简单。提供的 POC 代码可用于检测和验证该漏洞。 虽然使用了不安全的 `curl --insecure`, 但这不是代码投毒.  建议用户尽快升级到 Apache Unomi 1.5.2 或更高版本。

**项目地址:** [Prodrious/CVE-2020-13942](https://github.com/Prodrious/CVE-2020-13942)

**漏洞详情:** [CVE-2020-13942](https://nvd.nist.gov/vuln/detail/CVE-2020-13942)