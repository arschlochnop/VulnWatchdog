## CVE-2011-0762-vsftpd-DoS

**漏洞编号:** CVE-2011-0762

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致CPU资源耗尽和进程槽耗尽

**影响版本:** < 2.3.3

**利用条件:** 需要FTP服务器开启，且攻击者需要通过身份验证

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2011-0762是vsftpd 2.3.3之前版本中ls.c文件的vsf_filename_passes_filter函数存在的一个拒绝服务漏洞。远程已通过身份验证的用户可以通过在多个FTP会话的STAT命令中使用精心设计的glob表达式，导致拒绝服务（CPU消耗和进程槽耗尽）。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，此漏洞已得到确认，并且存在公开可用的PoC代码。PoC代码（如Exploit-DB上的16270）和提供的`cve-2011-0762.c`表明，可以通过发送包含大量嵌套花括号的STAT命令来触发该漏洞，导致服务器CPU资源耗尽。因此，提供的POC代码**有效**。

**投毒风险分析：**

检查`cve-2011-0762.c`的代码，该代码主要是建立FTP连接，进行身份验证（如果提供用户名和密码，否则使用匿名登录），然后发送一个包含大量嵌套花括号的STAT命令。代码中存在`sendftp`和`readftp`函数，用于发送和接收FTP命令和响应。`skip`变量允许忽略读取错误。并没有发现明显的后门代码，例如执行任意系统命令或泄露敏感信息。主要功能集中在利用`STAT`命令的glob表达式处理缺陷上，进行拒绝服务攻击。

但是，任何从互联网下载的代码都存在一定风险，即使是很小的几率。代码可能包含细微的恶意修改，例如，虽然当前代码目标是DoS，但可能会尝试进行内存损坏或信息收集，这需要进一步的逆向分析才能确定。这里估计的投毒概率为5%，主要是基于代码复杂度和潜在的隐藏恶意行为的可能性，而不是确凿的证据。

**利用方式：**

1.  **连接到FTP服务器：** 使用提供的IP地址和端口连接到目标vsftpd服务器。
2.  **身份验证：** 如果需要，提供用户名和密码进行身份验证。如果允许匿名登录，则使用匿名凭据。
3.  **发送恶意的STAT命令：** 发送构造好的STAT命令，该命令包含大量的嵌套花括号，例如：`STAT {{*},{{*},...}}`。
4.  **触发DoS：** vsftpd服务器在处理恶意的STAT命令时，会消耗大量的CPU资源，最终导致拒绝服务。可以通过建立多个连接并同时发送STAT命令来加剧攻击效果。

**项目地址:** [Andreyfts7/CVE-2011-0762](https://github.com/Andreyfts7/CVE-2011-0762)

**漏洞详情:** [CVE-2011-0762](https://nvd.nist.gov/vuln/detail/CVE-2011-0762)