## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互，克隆包含恶意配置的仓库或初始化包含恶意配置的子模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-48384 是一个 Git 漏洞，允许攻击者通过构造特殊的 Git 配置文件，在受害者克隆或初始化子模块时执行任意代码。漏洞的根源在于 Git 对配置项中尾部回车符（CR）处理不当。当 Git 读取配置值时，会删除尾部的 CRLF，但写入时，如果值以 CR 结尾，则不会进行引号处理，导致 CR 在后续读取时丢失。如果子模块路径包含尾部 CR，这会导致子模块被检出到错误的位置。如果存在一个符号链接，将更改后的路径指向子模块钩子目录，并且子模块包含一个可执行的 post-checkout 钩子，那么在检出后可能会意外执行该脚本。

**有效性：**

提供的 POC 代码 `/tmp/4ddcea7dd1399c323a9fb7a8b3071e04/README.md` 本身并不能直接验证漏洞，它只是一个简单的说明文件。真正的 POC 应该包含能够触发漏洞的恶意 Git 仓库配置和子模块结构。从搜索结果来看，存在可用的 POC。

**投毒风险：**

提供的 README.md 文件本身不包含任何可执行代码，因此直接的投毒风险较低。但是，如果该仓库中存在其他文件（例如恶意的 `.gitmodules` 文件或者钩子脚本），则存在投毒的风险。假设仓库作者在其他文件中隐藏了恶意代码的可能性存在，估计投毒风险为 10%。

**利用方式：**

1.  **创建恶意仓库：** 攻击者创建一个包含特殊构造的 `.gitmodules` 文件和恶意的子模块钩子脚本的 Git 仓库。
2.  **.gitmodules 构造：**  `.gitmodules` 文件中的子模块路径包含尾部回车符（CR），例如 `path = submodule_path\r`。
3.  **符号链接：** 创建一个符号链接，将 `submodule_path` 指向 `.git/modules/<submodule_name>/hooks`。
4.  **恶意钩子：** 子模块中包含一个 `post-checkout` 钩子脚本，该脚本包含恶意代码。
5.  **诱骗用户：** 攻击者诱骗受害者克隆该恶意仓库并初始化子模块（使用 `git clone --recurse-submodules` 或 `git submodule update --init --recursive`）。
6.  **触发漏洞：** 当 Git 初始化子模块时，由于路径中的回车符被错误处理，子模块会被检出到错误的位置。由于存在符号链接，`post-checkout` 钩子会被执行，从而导致任意代码执行。

**项目地址:** [eliox01/CVE-2025-48384](https://github.com/eliox01/CVE-2025-48384)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)