## CVE-2025-47577 - WordPress TI WooCommerce Wishlist Arbitrary File Upload

**漏洞编号:** CVE-2025-47577

**漏洞类型:** 任意文件上传

**影响应用:** TI WooCommerce Wishlist

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 2.9.2

**利用条件:** 目标网站安装并启用了受影响版本的 TI WooCommerce Wishlist 插件，并且允许未授权的上传操作。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是一个存在于 WordPress TI WooCommerce Wishlist 插件中的任意文件上传漏洞，影响版本小于等于2.9.2。未经身份验证的攻击者可以通过上传包含恶意代码的文件（例如 Web Shell）来利用此漏洞，从而在目标服务器上实现远程代码执行。

**有效性：**
提供的 POC 代码看起来有效。它包含以下步骤：
1.  从目标网站的首页提取 `product_id`，利用正则表达式 `data-tinv-wl-product="(\d+)"`。
2.  构造包含恶意文件的 multipart/form-data POST 请求，并发送到目标网站。文件类型伪装成 image/jpeg，但可以上传任意文件。
3.  解析响应的 JSON 数据，提取 `wishlist_url`。
4.  访问 `wishlist_url`，并使用正则表达式 `(\/wp-content\/uploads\/product_addons_uploads\/[a-z0-9\/\-_]+\.jpg)` 查找上传文件的路径。
5.  如果找到上传的文件，将 URL 写入 `result.txt`。

**投毒风险：**
分析 POC 代码后，投毒风险较低，约为 10%。代码本身逻辑较为清晰，主要执行文件上传和结果验证。潜在的投毒点可能在于：
1.  `list.txt` 文件：如果该文件包含大量恶意网站，则可能被用于大规模攻击，作者可以利用此行为进行恶意活动。
2.  上传的文件 `hinata.jpg`：虽然文件扩展名为 jpg，但文件内容可以是包含 PHP 代码的恶意文件，攻击者可能利用该文件进行恶意攻击。但是，这属于漏洞验证的范畴，不能简单判定为投毒。
3.  `redirect` 参数：poc中存在 `redirect': (None, 'http://testing.test/')` 参数,可能会用于跳转钓鱼。
但是总体来看，作者隐藏的恶意代码的可能性较低。

**利用方式：**
1.  准备目标网站列表 `list.txt`。
2.  将恶意文件（例如 `shell.php`，但伪装成 `hinata.jpg`）放置在与 POC 脚本相同的目录下。
3.  运行 POC 脚本 `python3 CVE-2025-47577.py`。
4.  POC 脚本会自动从目标网站提取 `product_id`，上传恶意文件，并尝试访问上传的文件。
5.  如果上传成功，恶意文件的 URL 将被写入 `result.txt`。
6.  攻击者可以访问 `result.txt` 中的 URL 来执行恶意代码，从而控制目标服务器。

**项目地址:** [Yucaerin/CVE-2025-47577](https://github.com/Yucaerin/CVE-2025-47577)

**漏洞详情:** [CVE-2025-47577](https://nvd.nist.gov/vuln/detail/CVE-2025-47577)