## CVE-2024-3400 PAN-OS GlobalProtect 任意文件创建导致命令注入

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 命令注入

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，允许未授权的攻击者以root权限执行任意代码

**影响版本:** PAN-OS 10.2.0 < 10.2.9-h1, PAN-OS 11.0.0 < 11.0.4-h1, PAN-OS 11.1.0 < 11.1.2-h3

**利用条件:** 目标系统需要配置GlobalProtect网关或门户，且未应用漏洞补丁或缓解措施

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-3400是Palo Alto Networks PAN-OS软件GlobalProtect功能中的一个命令注入漏洞。该漏洞源于任意文件创建，可能允许未经身份验证的攻击者在防火墙上以root权限执行任意代码。

**有效性分析：**

根据漏洞信息、搜索结果和提供的POC代码，该漏洞的POC代码是有效的。搜索结果表明，该漏洞已被积极利用，并且存在公开可用的POC。
提供的Python和Rust版本的POC代码尝试利用该漏洞来检测目标系统是否存在漏洞。POC代码通过发送特制的HTTP请求到目标系统的GlobalProtect接口，尝试创建或访问特定文件。如果成功，则认为系统易受攻击。

**投毒风险分析：**

查看提供的Python和Rust POC代码，未发现明显的恶意或投毒代码。这些代码的主要目的是验证漏洞的存在，而非植入后门或执行恶意操作。

*   Python 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/CVE-2024-3400.py` 使用 `requests` 库发送 HTTP 请求，检查目标是否易受攻击，并将易受攻击的IP地址写入`vuln.txt`。这部分代码没有发现任何投毒行为。
*   Rust 代码：`/tmp/b413b80758a8cc351e9d0e6068c08cc3/src/main.rs` 的功能与 Python 版本类似，使用 `reqwest` 库发送 HTTP 请求，并将易受攻击的 IP 地址写入`vuln.txt`。同样，没有发现恶意代码。

因此，投毒风险评估为0%。

**利用方式：**

1.  **漏洞触发：** 攻击者发送特制的HTTP请求到目标系统的GlobalProtect接口，请求包含恶意构造的文件路径，导致服务器尝试创建或访问该文件。
2.  **命令注入：** 由于输入验证不当，恶意文件路径中的特殊字符被解释为命令，导致系统执行攻击者指定的任意代码。
3.  **权限提升：** 该漏洞允许攻击者以root权限执行代码，从而完全控制受影响的防火墙。

**缓解措施：**

*   立即升级到PAN-OS 10.2.9-h1, PAN-OS 11.0.4-h1, PAN-OS 11.1.2-h3或更高版本。
*   如果无法立即升级，可以应用威胁防御签名95187、95189和95191（在应用程序和威胁内容版本8836-8695及更高版本中可用）来阻止攻击。

**项目地址:** [Ravaan21/CVE-2024-3400](https://github.com/Ravaan21/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)