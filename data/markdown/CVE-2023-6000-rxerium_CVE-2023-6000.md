## CVE-2023-6000-Popup Builder-Stored XSS

**漏洞编号:** CVE-2023-6000

**漏洞类型:** Stored XSS

**影响应用:** Popup Builder

**危害等级:** 高危，可能导致任意代码执行，权限提升，信息泄露

**影响版本:** < 4.2.3

**利用条件:** 目标WordPress站点安装了Popup Builder插件，并且版本低于4.2.3，无需认证即可访问修改popup的接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-6000 是 WordPress Popup Builder 插件 4.2.3 之前版本中的一个存储型 XSS 漏洞。未经身份验证的攻击者可以通过更新现有的弹窗，并注入恶意 JavaScript 代码来利用此漏洞。

**漏洞利用有效性：**

根据漏洞描述和提供的Nuclei模板，该漏洞利用的有效性较高。Nuclei模板会检查目标站点是否存在 `wp-content/plugins/popup-builder/readme.txt` 文件，并通过正则表达式提取插件版本号。如果版本号低于 4.2.3，则判定目标站点存在漏洞。利用搜索结果可知，此漏洞已被实际利用，攻击者已经开始利用此漏洞感染网站。

**投毒风险：**

分析提供的POC代码，主要是 nuclei 的 yaml 脚本和readme，用于检测是否存在漏洞，检测脚本本身没有发现明显的恶意代码或后门。README 文件主要是对漏洞的描述和nuclei脚本的使用方法。但是，任何代码都存在被篡改的风险，如果从不可信的来源下载POC，则存在一定的投毒风险，此处将风险预估为5%。

**漏洞利用方式：**

1.  **版本检测：** 通过访问 `/wp-content/plugins/popup-builder/readme.txt` 文件，确定 Popup Builder 插件的版本。
2.  **XSS 注入：** 如果插件版本低于 4.2.3，攻击者可以直接修改popup的内容，在popup的某些字段中插入恶意的 JavaScript 代码。
3.  **触发 XSS：** 当管理员或用户访问包含恶意 JavaScript 代码的弹窗时，XSS 漏洞被触发，执行攻击者注入的恶意代码。恶意代码可以窃取用户的 Cookie、重定向用户到恶意网站、修改页面内容等。

**项目地址:** [rxerium/CVE-2023-6000](https://github.com/rxerium/CVE-2023-6000)

**漏洞详情:** [CVE-2023-6000](https://nvd.nist.gov/vuln/detail/CVE-2023-6000)