## CVE-2022-26134 - Atlassian Confluence OGNL 注入远程代码执行

**漏洞编号:** CVE-2022-26134

**漏洞类型:** 远程代码执行

**影响应用:** Atlassian Confluence Server 和 Data Center

**危害等级:** 高危，未经身份验证的攻击者可以在受影响的Confluence Server或Data Center实例上执行任意代码。

**影响版本:** 1.3.0 < version < 7.4.17, 7.13.0 < version < 7.13.7, 7.14.0 < version < 7.14.3, 7.15.0 < version < 7.15.2, 7.16.0 < version < 7.16.4, 7.17.0 < version < 7.17.4, 7.18.0 < version < 7.18.1

**利用条件:** 目标系统运行受影响版本的Atlassian Confluence Server或Data Center，且可以通过网络访问。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-26134是一个严重的远程代码执行漏洞，存在于Atlassian Confluence Server 和 Data Center中。漏洞原因是OGNL表达式注入。未经身份验证的攻击者通过构造特殊的请求，可以将恶意OGNL表达式注入到Confluence Server，从而执行任意代码，完全控制服务器。

**漏洞利用方式：**

1.  攻击者构造包含恶意OGNL表达式的HTTP请求。
2.  Confluence Server解析该请求时，执行其中的OGNL表达式。
3.  恶意OGNL表达式执行攻击者指定的代码，例如执行系统命令、安装后门程序等。

提供的PoC代码是一个简单的检测脚本，它发送一个包含特定字符串的HTTP GET请求到目标Confluence服务器。如果服务器返回包含"Confluence"和"com.atlassian.confluence.extra.jira"的响应，并且状态码为200，则该脚本会判断目标服务器存在漏洞。这个PoC代码仅仅是用来检测漏洞是否存在，并不包含任何利用漏洞执行恶意操作的代码。

**投毒风险分析：**

分析提供的文件列表，其中包括一个Python检测脚本(`CVE-2022-26134_check.py`)和一个GPL许可文件(`LICENSE`)。

*   `CVE-2022-26134_check.py`：该脚本的目的是检测目标Confluence服务器是否存在CVE-2022-26134漏洞。脚本通过发送HTTP GET请求到`/rest/tinymce/1/macro/preview`端点，并检查响应的状态码和内容来判断漏洞是否存在。该脚本**不包含任何执行恶意操作的代码**，例如执行系统命令、上传文件等。该脚本是一个**纯粹的漏洞检测工具**。
*   `LICENSE`：该文件包含GNU General Public License的文本，用于声明软件的使用许可。

因此，根据提供的文件内容，可以判断该仓库中**不存在作者隐藏的投毒代码**，Poison的风险是0%。

**项目地址:** [cbk914/CVE-2022-26134_check](https://github.com/cbk914/CVE-2022-26134_check)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)