## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露，进一步导致远程代码执行

**影响版本:** 受影响版本包括Jenkins 2.441及更早版本，LTS 2.426.2及更早版本

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-23897是一个Jenkins中的任意文件读取漏洞。由于Jenkins CLI命令解析器中存在一个功能，该功能会将参数中的'@'字符后跟文件路径替换为文件内容，未经身份验证的攻击者可以利用此漏洞读取Jenkins控制器文件系统上的任意文件。根据搜索结果，可以通过HTTP、WebSocket和SSH利用此漏洞，其中HTTP和WebSocket的利用可能性最高。

提供的POC代码描述了一个Python脚本，该脚本利用jenkins-cli.jar文件与Jenkins服务器通信并执行任意命令，以读取服务器上的任意文件。该脚本需要Python 3.x环境，并且需要安装requests和subprocess库。此外，POC还提供了一个基于Docker的脆弱环境，以便在受控环境中测试漏洞利用。

**漏洞利用方式：**

1.  攻击者通过Jenkins CLI接口发送包含“@”符号后跟目标文件路径的恶意请求。
2.  Jenkins CLI解析器将“@”符号后的文件路径替换为文件内容。
3.  Jenkins服务器返回目标文件的内容给攻击者。

**投毒风险分析：**

POC代码本身是一个文件读取的利用脚本，并没有发现明显的后门代码。但是，风险点在于：

*   **jenkins-cli.jar下载：** 脚本会从Jenkins服务器下载jenkins-cli.jar文件。如果攻击者能够控制Jenkins服务器，则可能替换该文件为恶意版本，从而在受害者运行脚本时执行恶意代码。但这个属于服务器被攻陷的情况，不属于POC的投毒。
*   **Docker镜像：** 提供的Docker镜像可能包含恶意软件或配置，但这是漏洞环境的一部分，而不是投毒。
*   **命令执行：** 尽管脚本主要是为了文件读取，但攻击者可能会修改脚本以执行其他命令，如果这些命令没有适当的验证，可能会导致系统被攻击，但这取决于使用者如何修改利用脚本。

因此，代码本身的投毒概率较低，判断投毒风险为20%，主要存在于使用者未进行代码审计，直接用于生产环境，并修改脚本执行其他恶意行为。

**项目地址:** [D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins](https://github.com/D1se0/CVE-2024-23897-Vulnerabilidad-Jenkins)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)