## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获得域管理员权限。

**影响版本:** 受影响的Windows Server版本包括2008 R2到20H2等多个版本，具体版本请参考漏洞库信息。

**利用条件:** 攻击者需要与域控制器建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472（Zerologon）是一个严重的权限提升漏洞，存在于Windows Server的Netlogon协议中。攻击者可以通过将Netlogon客户端使用的身份验证凭据中的多个零值设置为全零来利用此漏洞。如果攻击成功，攻击者可以冒充域控制器上的任何计算机（包括域控制器本身），并获得域管理员权限。

**有效性：**
根据漏洞信息和搜索结果，该漏洞POC是有效的，并且已经被广泛利用。

**投毒风险：**
提供的代码（zeroscan）描述中明确声明它是一个漏洞扫描器，而不是漏洞利用工具，并且专门指出它不尝试利用Zerologon漏洞，只是检查是否存在漏洞。代码库借鉴自SecuraBV的CVE-2020-1472检查脚本。虽然zeroscan本身声明不进行利用，但它依赖于其他工具和脚本，这些依赖项可能存在潜在的风险。此外，代码中可能存在作者有意或无意引入的缺陷或后门。考虑到zeroscan的性质，以及它wrapper Impacket等工具，我们无法完全排除投毒的可能性。因此，存在一定比例的投毒风险。 

**利用方式：**

1.  攻击者使用MS-NRPC协议与域控制器建立连接。
2.  攻击者发送特制的身份验证请求，将Netlogon客户端凭据设置为零。
3.  由于Netlogon协议的缺陷，域控制器错误地接受了零凭据，从而允许攻击者通过身份验证。
4.  攻击者现在可以冒充域控制器并执行恶意操作，例如更改域管理员密码或部署恶意软件。
5. 通过rpcdump可以检测MS-PAR/MS-RPRN服务是否开启，为进一步攻击提供信息。
6. 通过检测SMB signing配置，决定后续横向移动的策略。


**项目地址:** [B34MR/zeroscan](https://github.com/B34MR/zeroscan)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)