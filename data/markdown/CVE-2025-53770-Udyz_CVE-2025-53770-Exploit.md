## CVE-2025-53770-Microsoft SharePoint Server Remote Code Execution Vulnerability

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，允许未经授权的攻击者通过网络执行代码

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 需要目标系统存在漏洞版本的 SharePoint Server 且网络可达。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息、搜索结果和提供的漏洞利用代码，CVE-2025-53770 是一个存在于 Microsoft SharePoint Server 中的远程代码执行漏洞，源于对不可信数据的反序列化。

**有效性：**
提供的 POC 代码是有效的，因为它详细描述了利用该漏洞所需的步骤：

1.  **获取必要参数：** 首先需要从目标 SharePoint 页面获取 `__VIEWSTATEGENERATOR`、`VALIDATION_KEY` 和 `VALIDATION_ALG` 的值。这些值用于后续生成恶意的 ViewState payload。
2.  **生成 ViewState Payload：** 使用 `ysoserial.exe` 工具生成一个包含 PowerShell 命令的 ViewState payload。该 PowerShell 命令旨在执行任意代码，例如列出服务器上的目录并将文件名发送到攻击者的服务器。POC中给出的例子是列出`C:\Program Files\Common Files\Microsoft Shared\Web Server Extensions\15\TEMPLATE\LAYOUTS` 目录。
3.  **发送恶意 POST 请求：** 将生成的 payload 嵌入到发送到 SharePoint 服务器的 POST 请求中，通过 `/_layouts/15/ToolPane.aspx` 路径触发漏洞。

**投毒风险：**
提供的代码主要是一个使用 `ysoserial.exe` 生成 payload 的指导说明。`ysoserial.exe` 本身是一个已知的 payload 生成工具，可能被用于恶意目的，但该工具本身不包含恶意代码。提供的 README.md 文件没有发现明显的投毒代码，风险较低。`ysoserial` 本身存在一定风险，若使用者从不可信的来源下载，则可能存在投毒风险，但这里假定使用者从可信来源获取。因此评估该仓库的投毒风险为 10%，主要来自于对 `ysoserial` 工具来源的不确定性。

**利用方式：**
1.  攻击者首先需要确定目标 SharePoint Server 是否存在漏洞。
2.  攻击者从目标服务器获取 `__VIEWSTATEGENERATOR`， `VALIDATION_KEY` 和 `VALIDATION_ALG` 的值。
3.  攻击者使用 `ysoserial.exe` 生成包含恶意 PowerShell 命令的 ViewState payload。攻击者可以根据需要修改 PowerShell 命令以执行不同的操作。
4.  攻击者构造一个包含恶意 payload 的 POST 请求，发送到目标服务器的 `/_layouts/15/ToolPane.aspx` 路径。利用 `MSOTlPn_Uri` 和 `MSOTlPn_DWP` 参数传递攻击载荷。
5.  如果漏洞利用成功，目标服务器将执行攻击者提供的 PowerShell 命令，实现远程代码执行。

**项目地址:** [Udyz/CVE-2025-53770-Exploit](https://github.com/Udyz/CVE-2025-53770-Exploit)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)