## CVE-2020-7378-OpenCRX-未验证密码更改

**漏洞编号:** CVE-2020-7378

**漏洞类型:** 未验证密码更改

**影响应用:** OpenCRX

**危害等级:** 高危，允许未经身份验证的攻击者更改任意用户的密码，包括管理员帐户

**影响版本:** <= 4.30 和 5.0-20200717

**利用条件:** 需要能够连接到受影响的 OpenCRX 实例的网络访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-7378 存在于 CRIXP OpenCRX 版本 4.30 和 5.0-20200717 及更早版本中。它是一个未经身份验证的密码更改漏洞。攻击者能够连接到受影响的 OpenCRX 实例，可以更改任何用户的密码，包括 admin-Standard，更改为任何选择的值。漏洞利用方式如下：

1.  **漏洞原理：** OpenCRX 使用 `java.util.Random` 生成密码重置令牌，而不是更安全的 `java.security.SecureRandom`。这意味着可以预测令牌，从而允许攻击者绕过密码重置验证。
2.  **利用步骤：**
    *   攻击者向 `RequestPasswordReset.jsp` 发送 POST 请求，提供要更改密码的用户名。
    *   服务器发送一封包含重置链接的电子邮件，其中包含基于 `java.util.Random` 生成的令牌。
    *   攻击者使用提供的 Python 脚本 `openCRXreset.py` 模拟此过程并暴力破解或预测时间戳。
    *   脚本通过获取起始和结束时间戳来生成可能的时间戳列表。
    *   然后，脚本构建一个包含预测的时间戳、用户名、新密码等参数的 POST 请求，并将其发送到密码重置 URL。
    *   如果时间戳匹配，密码将被更改。
3.  **POC 代码分析：** 提供的 Python 脚本 `openCRXreset.py` 实现了上述攻击过程。它接受 OpenCRX 实例的 URL、用户名和新密码作为参数。脚本首先检查用户是否存在，然后通过生成时间戳列表并尝试使用它们来重置密码。
4.  **投毒风险分析：** 风险较低，为10%。代码主要执行密码重置流程，看起来比较直接。但是，仍然存在细微的风险，例如：
    *   **time_stamps 文件的持久化：** 脚本虽然会删除临时文件，但如果删除失败，`time_stamps` 文件可能包含有关时间戳的信息。
    *   **异常处理不足：** 如果在网络请求或子进程执行期间发生异常，脚本可能无法正确清理资源或退出，这可能会导致信息泄露或拒绝服务。
    *   **依赖项风险：** 使用的 `rich` 和 `beautifulsoup4` 库可能存在未知的漏洞。虽然不太可能，但存在作者在代码中包含恶意逻辑的可能性。
5.  **总结：** 此漏洞的利用依赖于可预测的随机数生成器。成功利用此漏洞允许攻击者完全控制受影响的 OpenCRX 实例上的任何帐户。

**项目地址:** [ruthvikvegunta/openCRX-CVE-2020-7378](https://github.com/ruthvikvegunta/openCRX-CVE-2020-7378)

**漏洞详情:** [CVE-2020-7378](https://nvd.nist.gov/vuln/detail/CVE-2020-7378)