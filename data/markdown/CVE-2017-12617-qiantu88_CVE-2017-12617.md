## CVE-2017-12617-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat实例启用HTTP PUT方法（`readonly`初始化参数设置为`false`）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 允许未经身份验证的攻击者通过构造恶意请求上传JSP文件到服务器，并在服务器上执行任意代码。漏洞利用过程如下：

1.  **漏洞原理：** 当 Tomcat 配置允许 HTTP PUT 请求（即 `readonly` 参数设置为 `false`）时，攻击者可以利用此漏洞。
2.  **利用方式：** 攻击者发送特制的 HTTP PUT 请求，上传包含恶意代码的 JSP 文件到服务器上的任意位置。
3.  **代码分析：** 提供的 `tomcat-cve-2017-12617.py` 脚本使用 `requests` 库发送 HTTP PUT 请求来上传JSP webshell。脚本首先检查目标URL是否存在漏洞，然后可以利用该漏洞上传webshell并执行命令。
4.  **有效性：** 根据漏洞描述和提供的POC代码，该漏洞利用方式是有效的，只要目标环境满足漏洞利用的条件。
5.  **投毒风险：** 代码相对简单，主要功能是发送PUT请求，未发现明显的恶意代码或后门。但仍存在一定的投毒风险，例如，webshell可能包含恶意代码或者脚本从外部源下载恶意payload。根据代码分析，投毒风险评定为10%。大部分代码用于发送HTTP请求和处理响应，风险主要来自于webshell本身可能存在的恶意行为。

**项目地址:** [qiantu88/CVE-2017-12617](https://github.com/qiantu88/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)