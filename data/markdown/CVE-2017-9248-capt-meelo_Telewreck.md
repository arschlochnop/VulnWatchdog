## CVE-2017-9248 - Telerik UI for ASP.NET AJAX Cryptographic Weakness

**漏洞编号:** CVE-2017-9248

**漏洞类型:** 加密缺陷

**影响应用:** Telerik UI for ASP.NET AJAX

**危害等级:** 高危，可能导致MachineKey泄露，任意文件上传/下载，XSS，或ASP.NET ViewState 泄露，最终导致远程代码执行

**影响版本:** R2 2017 SP1 之前版本, Sitefinity 10.0.6412.0 之前版本

**利用条件:** 目标系统使用了存在漏洞的Telerik UI for ASP.NET AJAX组件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-9248 漏洞存在于 Telerik UI for ASP.NET AJAX 组件中，由于 Telerik.Web.UI.dll 没有正确保护 Telerik.Web.UI.DialogParametersEncryptionKey 或 MachineKey，导致远程攻击者可以利用该漏洞绕过加密保护机制。漏洞利用方式如下：

1.  **漏洞原理：** 攻击者利用漏洞泄露 MachineKey，该密钥用于加密和验证 ASP.NET 应用程序中的数据。如果攻击者获得 MachineKey，他们就可以伪造身份验证票证、解密敏感数据和执行其他恶意操作。
2.  **利用步骤：**
    *   **检测漏洞：** 使用Burp扩展 Telewreck 对目标应用程序进行被动扫描，检测是否存在漏洞版本的 Telerik Web UI。
    *   **密钥破解：**如果检测到漏洞，攻击者可以利用 Telewreck 工具暴力破解加密密钥，或者使用其他公开的exploit。
    *   **漏洞利用：** 一旦获得 MachineKey，攻击者就可以利用泄露的MachineKey执行以下操作：
        *   **任意文件上传/下载：** 攻击者可以上传恶意的 ASP.NET Web Shell，从而控制服务器。
        *   **跨站脚本攻击 (XSS)：** 通过注入恶意脚本攻击用户。
        *   **ASP.NET ViewState 泄露：** 攻击者可以解密和篡改 ViewState 数据。
        *   **远程代码执行 (RCE):** 配合其他漏洞，最终实现远程代码执行
3.  **投毒风险评估：**  查看提供的POC代码，主要功能为检测和利用CVE-2017-9248，未发现作者隐藏的恶意代码，投毒风险评估为0%。代码主要通过Burp Suite扩展实现，未发现任何可疑操作。

从搜索结果来看，该漏洞被APT组织积极利用，因此确认该漏洞的威胁较高，POC的有效性也得到验证。多个报告都表明该漏洞正在被积极利用。

**项目地址:** [capt-meelo/Telewreck](https://github.com/capt-meelo/Telewreck)

**漏洞详情:** [CVE-2017-9248](https://nvd.nist.gov/vuln/detail/CVE-2017-9248)