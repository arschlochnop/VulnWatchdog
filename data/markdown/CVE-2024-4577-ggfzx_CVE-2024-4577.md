## CVE-2024-4577 PHP-CGI 参数注入漏洞

**漏洞编号:** CVE-2024-4577

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** PHP

**危害等级:** 高危，允许未经身份验证的攻击者在Windows服务器上执行任意代码

**影响版本:** PHP 8.1.* (< 8.1.29), 8.2.* (< 8.2.20), 8.3.* (< 8.3.8)，运行在Windows的CGI模式下

**利用条件:** 服务器使用Apache并启用PHP-CGI，且系统配置为使用特定的代码页，这些代码页使用“Best Fit”策略。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2024-4577 是一个存在于 PHP-CGI 中的参数注入漏洞，影响在 Windows 上运行的 PHP 版本。当 PHP 在 CGI 模式下与 Apache 一起使用时，如果系统设置为使用某些代码页，“Best Fit” 行为可能会导致恶意用户将选项传递给 PHP 二进制文件。根据漏洞描述和搜索结果，该漏洞允许攻击者通过操纵命令行参数来执行任意代码。PoC 代码的描述表明它能够通过 URL 发送恶意命令，并且可以批量执行。尽管 README.md 文件本身没有明显的恶意代码，但由于作者信息较少，且漏洞具有高危性，存在一定的投毒风险，用于个人安全研究学习较为合适。漏洞利用方式主要为：

1.  **识别目标环境：** 确定目标服务器是否运行受影响的 PHP 版本（8.1.* < 8.1.29, 8.2.* < 8.2.20, 8.3.* < 8.3.8）并且配置为 CGI 模式在 Windows 上运行。
2.  **构造恶意请求：**  构造包含恶意 PHP 选项的 HTTP 请求。这些选项将利用 Windows 的“Best Fit”行为，将特殊字符转换为 PHP 可以解释的选项。
3.  **执行任意代码：**  通过注入的选项，攻击者可以执行任意 PHP 代码或操作系统命令。

根据搜索结果可知，此漏洞已经被大规模利用，需要及时修复。

**项目地址:** [ggfzx/CVE-2024-4577](https://github.com/ggfzx/CVE-2024-4577)

**漏洞详情:** [CVE-2024-4577](https://nvd.nist.gov/vuln/detail/CVE-2024-4577)