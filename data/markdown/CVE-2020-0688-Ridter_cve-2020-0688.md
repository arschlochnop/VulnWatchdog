## CVE-2020-0688-Microsoft Exchange Server-远程代码执行

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Microsoft Exchange Server 2010 SP3 UR30, 2013 CU23, 2016 CU14/CU15, 2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据（用户名和密码）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，源于 Exchange 控制面板 (ECP) 未能正确处理内存中的对象。攻击者可以通过拥有合法Exchange用户的凭据，利用静态密钥进行 ViewState 反序列化，从而在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息和搜索结果，CVE-2020-0688 是一个已被广泛利用的漏洞。提供的 POC 代码（0688-detect.py）旨在检测和利用此漏洞。从代码分析来看，该脚本首先尝试使用提供的凭据登录到 OWA。成功登录后，它会构造一个恶意的 ViewState payload，该 payload 利用了不安全的 ViewState 反序列化。然后，它通过发送带有特制 ViewState 的请求到 ECP 页面来触发漏洞，最终导致远程代码执行。

**投毒风险分析：**
审阅提供的`0688-detect.py` 脚本，并未发现明显的恶意或后门代码。脚本的功能是利用 CVE-2020-0688 漏洞进行远程代码执行。虽然脚本本身是为了攻击目的而编写，但这并不等同于投毒。`out_payload` 是该漏洞利用的关键部分，它包含用于触发漏洞的序列化对象。虽然脚本的目的是为了利用漏洞，增加了攻击风险，但从代码本身来看，不属于投毒行为，只是实现了漏洞利用。

但是考虑到github仓库本身的风险，以及代码中可能存在的细微修改，将投毒风险评估为10%。

**利用方式：**
1.  **获取凭据：** 攻击者需要拥有一个有效的 Microsoft Exchange 用户帐户的用户名和密码。这可能通过网络钓鱼、密码猜测或其他攻击手段获得。
2.  **身份验证：** 使用获得的凭据登录到 Exchange Webmail (OWA)。
3.  **构造 Payload：**  该 POC 脚本会构造一个恶意的 `__VIEWSTATE` 参数，其中包含一个经过特殊设计的序列化对象。该对象旨在利用 ViewState 的不安全反序列化机制来执行任意代码。
4.  **触发漏洞：**  将构造的 `__VIEWSTATE` 参数附加到对 ECP 页面的请求中，从而触发反序列化漏洞。服务器在处理该请求时，会反序列化恶意对象，从而执行攻击者指定的代码。
5.  **远程代码执行：** 成功利用漏洞后，攻击者可以在 Exchange 服务器上执行任意代码，从而完全控制服务器。


**项目地址:** [Ridter/cve-2020-0688](https://github.com/Ridter/cve-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)