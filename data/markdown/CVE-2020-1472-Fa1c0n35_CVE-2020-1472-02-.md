## CVE-2020-1472 (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域管理员权限被获取

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 2004, 1903, 1909, 20H2

**利用条件:** 需要与域控制器的网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个Windows Netlogon协议中的权限提升漏洞。攻击者可以通过建立一个到域控制器的脆弱的Netlogon安全通道连接来利用此漏洞。漏洞利用代码通过将Netlogon会话密钥重置为零，从而绕过身份验证。提供的`zerologon_tester.py`脚本用于检测目标域控制器是否存在此漏洞。脚本尝试使用全零的challenge和credential进行身份验证。如果成功，则表明目标存在漏洞。虽然脚本的主要目的是测试漏洞是否存在，但潜在的投毒风险在于，攻击者可能修改该脚本以在成功利用漏洞后执行恶意操作，例如安装后门或收集敏感信息。要求Python 3.7或更高版本，以及`requirements.txt`中列出的依赖项。脚本通过`pip install -r requirements.txt`安装依赖。利用方式为：1. 运行`zerologon_tester.py`脚本，指定目标域控制器的NetBIOS名称和IP地址。2. 脚本尝试使用零密钥进行身份验证。3. 如果身份验证成功，脚本会立即终止，表明目标易受攻击。根据漏洞描述，成功利用此漏洞可能允许未经身份验证的攻击者获得域管理员权限，从而完全控制域。

**投毒风险分析：**

*   **README.md:** 描述了脚本的使用方法和漏洞背景，未发现可疑代码。
*   **LICENSE:** MIT许可证，允许自由使用、修改和分发，但也增加了被修改后用于恶意目的的风险。
*   **requirements.txt:** 列出了脚本依赖的Python库。虽然这些库本身是合法的，但攻击者可能替换或篡改这些库的安装源，从而引入恶意代码。impacket库本身如果来源不明，存在一定风险。
*   **zerologon_tester.py:** 脚本的核心代码，实现了漏洞的检测和利用。虽然代码本身看起来是合法的漏洞验证代码，但是仍然存在被篡改的风险，例如添加在成功利用漏洞后执行恶意操作的代码。例如，在`try_zero_authenticate` 函数中，成功绕过身份验证后，可以添加执行任意代码的逻辑。

因此，虽然提供的代码主要是漏洞检测工具，但仍然存在一定的投毒风险。特别是需要注意impacket包的来源可靠性，以及防止`zerologon_tester.py`被篡改添加恶意逻辑。

综合考虑，判定投毒风险为10%。

**项目地址:** [Fa1c0n35/CVE-2020-1472-02-](https://github.com/Fa1c0n35/CVE-2020-1472-02-)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)