## CVE-2025-57870 - Esri ArcGIS Server SQL注入

**漏洞编号:** CVE-2025-57870

**漏洞类型:** SQL注入

**影响应用:** Esri ArcGIS Server

**危害等级:** 严重，可能导致数据泄露、数据修改、数据删除以及远程代码执行

**影响版本:** 11.3, 11.4, 11.5

**利用条件:** 需要目标ArcGIS Server实例运行并暴露Feature Service的/query接口。

**POC 可用性:** 是

**投毒风险:** 85%

## 详情

CVE-2025-57870 是 Esri ArcGIS Server 11.3, 11.4 和 11.5 版本中存在的 SQL 注入漏洞。该漏洞位于 Feature Service 的 `/query` 端点，允许未经验证的远程攻击者执行任意 SQL 命令，可能导致未经授权的数据访问、修改或删除，甚至在特定数据库后端实现远程代码执行。 

**有效性评估：**

提供的漏洞利用代码描述了一个专业的漏洞利用工具，该工具针对 CVE-2025-57870。它支持多种数据库后端（MSSQL、Oracle、PostgreSQL）以及多种注入模式（错误、盲注、带外）。 该代码仓库似乎提供了完整的功能，包括扫描器、payload生成器、规避技术和后渗透模块，利用代码的详细描述增强了其有效性。 因此，该POC代码**可能有效**。

**投毒风险评估：**

尽管代码仓库看起来很完整，但存在一些危险信号，表明可能存在投毒风险：

1.  **`tinyurl.com` 链接：** 使用 `tinyurl.com` 缩短的链接指向完整的源代码，这是可疑的。攻击者可能会使用此链接重定向到包含恶意代码的存储库。
2.  **`demo.mp4`** 这是一个视频教学，应该是一个链接而不是本地目录。
3.  **联系方式：** 使用 `outlook.com` 的电子邮件地址进行联系，这对于一个声称专业的公司来说并不常见。
4.  **免责声明：** 明确声明仅用于授权安全测试，这通常是恶意软件作者的常见做法。

基于这些因素，此仓库中作者隐藏的投毒代码的风险很高，估计为 **85%**。潜在的投毒方式包括：

*   **后门：** 在 `sqli_exploit.py` 或 backend-specific 文件中插入恶意代码，允许攻击者控制受害者系统。
*   **凭据窃取：** 在 `config.yaml` 中插入代码，窃取用户配置的代理凭据。
*   **供应链攻击：** 在 `requirements.txt` 中包含恶意依赖项，将后门引入受害者环境。
*   **远程代码执行：** 在 `execute_cmd` 动作中，直接执行高危命令，使得目标系统更容易被控制。

**利用方式分析：**

1.  **漏洞定位：** 该漏洞存在于 ArcGIS Server Feature Service 的 `/query` 端点。
2.  **攻击向量：** 未经验证的攻击者可以构造恶意的 SQL 查询参数，通过 `/query` 端点发送到 ArcGIS Server。
3.  **注入类型：** 支持错误注入、盲注和带外注入，从而提高了攻击的成功率。
4.  **Payload 生成：** `payload_generator.py` 用于生成特定操作的自定义 SQL payload。
5.  **后渗透利用：** 成功利用后，攻击者可以执行以下操作：
    *   `dump_schema`: 导出数据库 schema。
    *   `dump_table`: 导出特定表的数据。
    *   `execute_cmd`: 在数据库服务器上执行命令（如果数据库后端支持）。

**安全建议：**

*   避免使用来自未知或不受信任来源的漏洞利用代码。
*   在受控环境中分析和测试漏洞利用代码。
*   更新 ArcGIS Server 到最新版本，以修复此漏洞。
*   实施强输入验证和参数化查询，以防止 SQL 注入攻击。
*   监控 ArcGIS Server 日志，以检测潜在的攻击活动。

**项目地址:** [ByteHawkSec/CVE-2025-57870-POC](https://github.com/ByteHawkSec/CVE-2025-57870-POC)

**漏洞详情:** [CVE-2025-57870](https://nvd.nist.gov/vuln/detail/CVE-2025-57870)