## CVE-2025-24252 - Apple AirPlay Use-After-Free RCE (AirBorne)

**漏洞编号:** CVE-2025-24252

**漏洞类型:** Use-After-Free

**影响应用:** tvOS, iOS and iPadOS, iPadOS, macOS, visionOS

**危害等级:** 高危，远程代码执行

**影响版本:** < 18.4 (tvOS, iOS and iPadOS), < 17.7 (iPadOS), < 15.4, < 14.7, < 13.7 (macOS), < 2.4 (visionOS)

**利用条件:** 位于同一本地网络，无需用户交互

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24252是一个存在于Apple AirPlay中的使用后释放漏洞(UAF)，被称为 "AirBorne"。攻击者位于同一本地网络即可利用此漏洞，无需用户交互。该漏洞允许攻击者通过特制的mDNS TXT记录触发`AirPlayReceiver`的崩溃，甚至在与其他漏洞（如CVE-2025-24206）组合利用时，实现远程代码执行（RCE）。提供的漏洞利用代码包括：

*   `CVE-2025-24132_RCE.py`: 虽然文件名包含不同的CVE编号，但脚本实际上是尝试利用AirPlay配对流程中的漏洞。它构造一个包含恶意plist数据的HTTP POST请求，旨在通过向目标设备发送包含反向shell命令的plist，从而实现远程代码执行。脚本通过`pairing-init`端点发送payload。
*   `PoC_CVE-2025-24132`: 这个脚本通过发送格式错误的`pairing-init`数据包来模糊测试AirPlay配对，通过超大缓冲区溢出，触发设备崩溃或超时。

**有效性：**

提供的PoC代码看起来基本有效，`CVE-2025-24132_RCE.py`通过 AirPlay 配对过程发送恶意 plist, 尝试执行反向 Shell。但是否能成功RCE，取决于目标系统漏洞是否可被利用。`PoC_CVE-2025-24132` 是一个模糊测试脚本，更倾向于导致拒绝服务。

**投毒风险：**

虽然无法100%保证，但根据代码内容和作者提供的LICENSE，初步评估投毒风险较低（5%）。风险主要在于：

1.  **依赖性风险**: 代码使用了`socket`，这本身没有问题。但是，如果作者在其他地方（例如，在更复杂的利用链中）引入了依赖，并修改了这些依赖以包含恶意代码，则可能存在风险。但本示例不涉及。
2.  **后门指令**: 代码中嵌入了反向shell命令。尽管这被用于漏洞利用，但如果攻击者修改了这些命令，指向一个他们控制的服务器，则可以将受害者重定向到恶意服务器。

**利用方式：**

1.  **网络嗅探与中间人攻击：** 攻击者需要与目标设备位于同一本地网络。可以通过网络嗅探或者中间人攻击来拦截和篡改AirPlay通信。
2.  **mDNS欺骗（针对CVE-2025-24252）：**攻击者可以发送恶意的mDNS广播，包含精心构造的TXT记录，这些记录可以触发目标设备上的use-after-free漏洞。
3.  **AirPlay配对流程攻击 (针对CVE-2025-24132)：** 攻击者通过AirPlay的配对流程发送畸形的或者包含恶意payload的数据包，例如通过`pairing-init`端点发送。
4.  **利用链：** 单独利用UAF漏洞可能只能导致设备崩溃。为了实现RCE，攻击者可能需要将CVE-2025-24252与信息泄露漏洞（如CVE-2025-24206）组合使用，绕过地址空间布局随机化（ASLR）等安全机制。

**项目地址:** [apwlq/AirBorne-PoC](https://github.com/apwlq/AirBorne-PoC)

**漏洞详情:** [CVE-2025-24252](https://nvd.nist.gov/vuln/detail/CVE-2025-24252)