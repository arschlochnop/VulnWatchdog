## CVE-2025-7401-Premium Age Verification / Restriction for WordPress-Unauthenticated Arbitrary File Read and Write

**漏洞编号:** CVE-2025-7401

**漏洞类型:** 任意文件读取/写入

**影响应用:** Premium Age Verification / Restriction for WordPress

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** <= 3.0.2

**利用条件:** 插件版本小于等于3.0.2，目标服务器允许外部网络访问，且remote_tunnel.php文件存在。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Premium Age Verification / Restriction for WordPress 插件的remote_tunnel.php文件中。未经身份验证的攻击者可以利用此漏洞读取或写入服务器上的任意文件，可能导致敏感信息泄露或远程代码执行。

**利用方式：**

1.  **漏洞点：** `/wp-content/plugins/age-restriction/modules/remote_support/remote_tunnel.php` 文件存在未授权访问，且包含不安全的远程支持功能。
2.  **利用过程：**
    *   攻击者首先构造恶意的URL，访问 `remote_tunnel.php` 文件。
    *   攻击者通过构造`connection_key`（默认为'330489965d8266a739442ef890f57805'，但可能可猜测或被其他方式泄露）和操作类型（`action=save_file`）以及目标文件路径（`/var/www/html/wp-content/plugins/age-restriction/modules/remote_support/remote_init.php`），将恶意PHP代码写入到指定文件中。
    *   恶意PHP代码被写入到 `remote_init.php` 后，攻击者即可访问该文件执行任意命令，例如 `remote_init.php?cmd=whoami`。

**有效性：**

提供的POC代码是有效的，因为它能够利用 `remote_tunnel.php` 中的漏洞，写入任意PHP代码到服务器上的指定位置。

**投毒风险：**

POC代码本身主要功能是进行漏洞验证和利用，但仍然存在一定的投毒风险。虽然代码的主要目的是利用漏洞，但以下因素可能构成潜在的投毒风险：

*   **默认Key的使用：** 脚本中使用了硬编码的默认 `connection_key`，这使得攻击变得更容易，如果攻击者利用此脚本攻击大量站点，可能会被追踪到脚本作者或相关仓库。
*   **写入任意PHP代码的灵活性：** 脚本允许用户自定义要写入的PHP代码。虽然这增强了脚本的灵活性，但也可能被用于注入更复杂的恶意代码，而不仅仅是简单的webshell，例如，攻击者可以注入包含恶意链接或重定向的代码，用于钓鱼攻击或传播恶意软件。
*   **后门维护：** 攻击者可以利用此漏洞在目标网站上植入持久性后门，以便在漏洞修复后仍然可以访问该网站。  例如，覆盖主题文件或核心WordPress文件，实现长期控制。
*  **无代码混淆和隐藏：** 从代码本身来看，并没有发现明显的隐藏恶意代码，例如利用编码、加密或者其他混淆技术来隐藏恶意行为。代码的功能相对直白，主要是完成漏洞利用，但长期以往的使用，会引起安全研究人员的注意,进行溯源。

综合来看，投毒风险较低，大约为5%，主要是由于代码的透明性以及目的明确，但使用者可能会滥用该脚本进行恶意活动。重点在于使用者可能利用此脚本植入长期后门，而非脚本本身存在恶意代码。


**项目地址:** [Nxploited/CVE-2025-7401](https://github.com/Nxploited/CVE-2025-7401)

**漏洞详情:** [CVE-2025-7401](https://nvd.nist.gov/vuln/detail/CVE-2025-7401)