## CVE-2022-30190 - Microsoft MSDT Follina 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，可导致远程代码执行，完全控制受害者系统

**影响版本:** 受影响的Windows版本包括但不限于 Windows 7, Windows 8.1, Windows 10 (多个版本), Windows 11, Windows Server (多个版本)

**利用条件:** 用户需要打开包含恶意payload的文档（如Word文档），或点击恶意链接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft支持诊断工具（MSDT）中的远程代码执行漏洞。攻击者可以利用此漏洞，通过调用应用程序（如Word）中的URL协议来执行任意代码，获得与该应用程序相同的权限。攻击者可以通过精心构造的恶意文档或链接，诱使用户打开，从而触发漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意payload的文档（例如，一个包含远程模板的Word文档）。该模板指向一个由攻击者控制的服务器。
2.  当用户打开文档时，Word会尝试从远程服务器检索模板。
3.  远程服务器返回一个包含MSDT协议处理程序的HTML文件。
4.  MSDT通过URL协议被调用，并执行HTML文件中包含的恶意代码。

**POC代码分析：**
提供的代码 `FollinaScanner` 并非漏洞利用代码，而是一个用于扫描文件系统中可能包含Follina漏洞的文件的工具。 它通过搜索特定模式（例如，包含URL）的文件来工作。因此，提供的代码不能直接用于触发漏洞。

**投毒风险分析：**
  仓库主要功能是扫描本地文件是否存在漏洞，并没有实际利用漏洞的功能。 主要代码功能为扫描本地文件URL特征，判断本地是否存在恶意文件， 因此投毒风险较低。仓库中存在恶意代码的可能性极小，评估投毒风险约为1%。

**项目地址:** [ErrorNoInternet/FollinaScanner](https://github.com/ErrorNoInternet/FollinaScanner)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)