## CVE-2023-4357

**漏洞编号:** CVE-2023-4357

**漏洞类型:** 文件访问限制绕过

**影响应用:** Google Chrome

**危害等级:** 中危，允许远程攻击者绕过文件访问限制，可能导致敏感信息泄露。

**影响版本:** < 116.0.5845.96

**利用条件:** 需要用户打开恶意构造的HTML页面（需要用户交互）。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息和搜索结果，CVE-2023-4357 漏洞是 Google Chrome 浏览器中 XML 处理时由于未充分验证不可信输入而导致的文件访问限制绕过漏洞。攻击者可以利用此漏洞，通过构造恶意的 HTML 页面，诱骗用户打开，从而绕过浏览器的文件访问限制，读取本地文件。

**有效性：**
提供的POC代码包含三个文件：
1.  `1.svg`：包含一个 XML 样式表定义，用于加载 `exp.php`。SVG中使用XSLT转换尝试从'exp.php'加载内容。
2.  `README.md`：简单的说明文件，没有实际功能。
3.  `exp.php`：PHP脚本，用于读取 `/etc/passwd`、`/etc/hosts` 和 `/etc/group` 文件，并进行Base64编码，并通过Access-Control-Allow-Origin头允许跨域请求。`1.svg`尝试获取这些内容,然后通过POST请求将这些文件发送到攻击者指定的IP和端口。

综合来看，这个POC代码是有一定效力的。它通过SVG加载远程PHP文件（exp.php），该PHP文件本身构造了一个包含文件读取的XML，然后通过JavaScript把读取到的文件内容发送到攻击者的服务器。Chrome 116.0.5845.96之前的版本可能允许这样的文件读取操作。利用成功后，攻击者可以获取用户的敏感信息（如/etc/passwd, /etc/hosts, /etc/group）。

**投毒风险：**
该仓库中的POC代码主要由SVG和PHP构成。`exp.php` 尝试读取敏感文件并通过 HTTP POST 请求回传到攻击者的服务器，这些是漏洞利用代码的核心逻辑。虽然`exp.php`中使用了`base64_decode`函数，但是解码的内容是正常的XML结构定义，并没有发现隐藏的恶意代码。所以，该仓库中直接植入恶意后门代码的概率较低，判断投毒风险为0%。

**利用方式：**
1.  攻击者创建一个包含恶意 SVG 文件的 HTML 页面。该SVG文件使用XML样式表加载远程exp.php。
2.  `exp.php`文件定义了读取敏感文件的XML实体。
3.  诱骗用户使用受影响的 Chrome 浏览器打开该 HTML 页面。
4.  浏览器解析 SVG 文件，执行其中的 XSLT 转换，从远程服务器加载 `exp.php`。如果 exp.php 中的 XML 实体成功解析，则会尝试读取本地文件。
5.  SVG 中嵌入的 JavaScript 代码通过 XMLHttpRequest 将读取到的文件内容 POST 到攻击者指定的服务器。  攻击者部署服务器监听相应端口，接收被攻击者机器的文件内容。

**项目地址:** [sunu11/chrome-CVE-2023-4357](https://github.com/sunu11/chrome-CVE-2023-4357)

**漏洞详情:** [CVE-2023-4357](https://nvd.nist.gov/vuln/detail/CVE-2023-4357)