## CVE-2023-23397-Microsoft Outlook权限提升漏洞

**漏洞编号:** CVE-2023-23397

**漏洞类型:** 权限提升

**影响应用:** Microsoft Outlook

**危害等级:** 高危，可能导致Net-NTLM hash泄露，进而冒充用户身份。

**影响版本:** 受影响版本包括Microsoft Outlook 2013 SP1, Outlook 2016, Office 2019, Office LTSC 2021和Microsoft 365 Apps for Enterprise的特定版本，具体参见CVE描述。

**利用条件:** 攻击者需要向目标用户发送特制的邮件或会议邀请。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-23397是一个Microsoft Outlook权限提升漏洞。攻击者可以利用此漏洞通过构造包含指向恶意SMB服务器的`ReminderSoundFile`字段的邮件或者会议邀请，当Outlook客户端收到并处理该邮件时，会自动尝试连接到该SMB服务器，从而泄露用户的Net-NTLM hash。该漏洞利用无需用户交互（零点击）。

根据提供的漏洞库信息，该漏洞的CVSS v3.1评分为9.8，属于严重级别，并且已被CISA列入已知被利用漏洞目录。

搜索引擎结果显示，该漏洞已被广泛分析和利用，存在针对该漏洞的检测方法和缓解措施。

提供的POC代码是一个PowerShell脚本，它创建并保存一个包含恶意`ReminderSoundFile`字段的Outlook日历项（会议邀请）。`Save-CalendarNTLMLeak` 函数允许设置远程文件路径（`$remotefilepath`）作为提醒声音文件，当目标用户打开或预览此日历项时，Outlook会尝试访问该路径，从而触发NTLM hash泄露。

**有效性：** 提供的POC代码有效，可以用于触发漏洞，泄露Net-NTLM hash。

**投毒风险：** 提供的POC代码本身不包含明显的恶意代码，主要功能是生成包含漏洞利用载荷的Outlook日历项。因此，投毒风险较低，但不能完全排除作者在其他地方隐藏恶意代码的可能性。 经过分析，确认只有生成日历项功能，没有发现其他恶意代码，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用提供的POC代码（或类似工具）生成包含指向攻击者控制的SMB服务器的恶意`ReminderSoundFile`字段的Outlook日历项（.msg文件）。
2.  攻击者将此日历项通过电子邮件发送给目标用户。
3.  当目标用户使用受影响版本的Outlook客户端打开或预览该日历项时，Outlook会自动尝试连接到攻击者控制的SMB服务器。
4.  目标用户的Net-NTLM hash会被发送到攻击者的SMB服务器。
5.  攻击者可以使用获得的Net-NTLM hash进行进一步的攻击，例如NTLM Relay攻击，从而冒充用户身份访问网络资源。

**项目地址:** [stevesec/CVE-2023-23397](https://github.com/stevesec/CVE-2023-23397)

**漏洞详情:** [CVE-2023-23397](https://nvd.nist.gov/vuln/detail/CVE-2023-23397)