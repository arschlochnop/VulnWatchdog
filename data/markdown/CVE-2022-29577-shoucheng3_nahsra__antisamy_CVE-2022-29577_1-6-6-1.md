## CVE-2022-29577-OWASP AntiSamy-XSS

**漏洞编号:** CVE-2022-29577

**漏洞类型:** XSS

**影响应用:** OWASP AntiSamy

**危害等级:** 中危，可能导致跨站脚本攻击

**影响版本:** < 1.6.7

**利用条件:** 需要能够向AntiSamy处理的输入中注入恶意代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-29577 漏洞存在于 OWASP AntiSamy 1.6.7 之前的版本中。该漏洞允许攻击者通过在 STYLE 标签的内容中进行 HTML 标签的“走私（smuggling）”来执行跨站脚本攻击（XSS）。

**有效性：**
根据漏洞描述，由于输出序列化器没有正确编码 CSS 内容，因此可以利用此漏洞。搜索引擎结果中也提到了该漏洞的细节、影响和缓解步骤。因此，可以认为该漏洞利用是有效的。

**投毒风险：**
提供的漏洞利用代码仅仅是AntiSamy的LICENSE和README，其中LICENSE是软件许可协议，README是对AntiSamy项目的介绍和使用说明，并没有发现任何与漏洞利用相关的代码，**更没有任何恶意代码存在**。因此，投毒风险为0%。

**利用方式：**
1.  攻击者构造包含恶意 HTML 标签的输入，并将该输入嵌入到 STYLE 标签的内容中。
2.  AntiSamy 对输入进行处理，由于存在漏洞，AntiSamy 没有正确编码恶意 HTML 标签。
3.  AntiSamy 将处理后的内容输出到 Web 页面。
4.  当用户浏览包含恶意代码的页面时，恶意代码将在用户浏览器中执行，从而导致 XSS 攻击。

**总结：** 漏洞利用方式是通过构造特殊的包含 HTML 标签的 STYLE 内容，绕过 AntiSamy 的过滤，从而执行 XSS 攻击。

**项目地址:** [shoucheng3/nahsra__antisamy_CVE-2022-29577_1-6-6-1](https://github.com/shoucheng3/nahsra__antisamy_CVE-2022-29577_1-6-6-1)

**漏洞详情:** [CVE-2022-29577](https://nvd.nist.gov/vuln/detail/CVE-2022-29577)