## CVE-2025-34159-Coolify-Docker Compose注入

**漏洞编号:** CVE-2025-34159

**漏洞类型:** Docker Compose 注入/远程代码执行

**影响应用:** Coolify

**危害等级:** 高危，可导致主机完全控制

**影响版本:** <= v4.0.0-beta.420.6

**利用条件:** 需要 Coolify 实例，并具有低级别成员权限的账户

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Coolify 的应用部署工作流中，允许低权限成员用户通过注入恶意的 Docker Compose 指令来执行任意代码。攻击者可以通过创建一个包含恶意服务的项目，该服务将主机的文件系统挂载到容器中，从而获得对底层服务器的完全 root 权限。 

**有效性：**
提供的 POC 代码有效。它展示了两种攻击方式：
*   **PoC 1：** 将整个主机根目录挂载到容器中，然后在主机上创建一个文件，验证 RCE。
*   **PoC 2：** 将主机的特定目录挂载到容器中，然后在该目录下写入文件。

**投毒风险：**
经过对漏洞利用代码仓库的分析，初步判断投毒风险较低。风险评估为 5%。该仓库主要包含漏洞描述、PoC 代码以及利用方法说明，没有发现隐藏的恶意代码或后门。但是,不能完全排除作者在其他地方埋藏后门的可能性，只是在本代码中未发现。

**利用方式：**
1.  攻击者需要拥有 Coolify 实例的低权限成员账户。
2.  攻击者创建一个新的项目或者编辑现有的项目。
3.  在 Docker Compose 配置文件中，攻击者添加一个恶意的服务定义，该服务定义将主机的文件系统（例如根目录 `/`）挂载到容器内部。
4.  攻击者可以在容器内部通过挂载的目录访问和修改主机的文件系统，从而执行任意命令。
5.  成功利用漏洞后，攻击者可以获得主机的 root 权限，完全控制 Coolify 实例。

**项目地址:** [Eyodav/CVE-2025-34159](https://github.com/Eyodav/CVE-2025-34159)

**漏洞详情:** [CVE-2025-34159](https://nvd.nist.gov/vuln/detail/CVE-2025-34159)