## CVE-2025-3568-Webkul Krayin CRM SVG File edit cross site scripting

**漏洞编号:** CVE-2025-3568

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** Webkul Krayin CRM

**危害等级:** 高危，可能导致管理员账户被劫持和数据泄露

**影响版本:** <= 2.1.0

**利用条件:** 需要攻击者具备低权限用户账户，诱骗管理员打开恶意SVG文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3568 存在于 Webkul Krayin CRM 2.1.0 及更早版本中。该漏洞允许低权限用户通过上传包含恶意 JavaScript 的 SVG 文件，利用管理员的权限执行操作。

**有效性：**
根据漏洞描述和提供的 PoC 代码，此漏洞利用方法是有效的。PoC 利用了以下两个关键点：
1.  **SVG 文件中的 XSS：**  CRM 未对上传的 SVG 文件进行充分的清理，允许嵌入 JavaScript 代码。
2.  **缺少当前密码验证的密码更改功能：**  `/admin/settings/users/edit/[ID]` 端点允许在不知道当前密码的情况下更改管理员密码。

PoC 的攻击流程如下：
1.  攻击者创建一个包含恶意 JavaScript 的 SVG 文件（`svgxss.svg`）。
2.  攻击者将 SVG 文件通过邮件或其他方式发送给管理员。
3.  管理员打开 SVG 文件，其中的 JavaScript 代码执行。
4.  JavaScript 代码窃取管理员的 XSRF-TOKEN Cookie
5.  JavaScript 代码构造一个 POST 请求，向 `/admin/settings/users/edit/1` 端点发送请求，修改管理员密码。
6.  攻击者使用新密码登录管理员账户。

**投毒风险：**
PoC 代码中存在少量投毒的潜在可能性：
1.  **`attacker.com` 域：** PoC 代码尝试将数据发送到 `https://attacker.com/collect`。 如果攻击者控制该域，他们可能会收集有关受害者的信息，或者使用该域来托管进一步的恶意内容。  虽然这是一个明显的指示器，但在实际利用中，攻击者可以修改此 URL 为他们控制的地址。

总体而言，投毒风险较低，约 10%。 因为主要的危害在于 XSS 漏洞本身和弱密码更新策略，`attacker.com` 只作为一个可选项存在，用于收集信息，或者进行进一步攻击。

**利用方式：**
该漏洞的利用方式是结合了 CSRF 和 XSS 的攻击。攻击者利用 SVG 文件上传功能，嵌入 JavaScript 代码，当管理员打开包含恶意代码的 SVG 文件时，代码会窃取管理员的 XSRF token，然后利用该 token 构造一个请求，修改管理员密码。由于修改密码的接口没有做当前密码验证，攻击者可以直接修改密码。

**项目地址:** [shellkraft/CVE-2025-3568](https://github.com/shellkraft/CVE-2025-3568)

**漏洞详情:** [CVE-2025-3568](https://nvd.nist.gov/vuln/detail/CVE-2025-3568)