## CVE-2023-27163-Request-Baskets-SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** SSRF (服务器端请求伪造)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能导致内部信息泄露和访问内部服务

**影响版本:** <= 1.2.1

**利用条件:** 需要能够访问Request-Baskets API

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中的一个服务器端请求伪造 (SSRF) 漏洞，存在于 `/api/baskets/{name}` 组件中。

**有效性分析：**
提供的漏洞利用代码 `main.py` 是一个用于利用该 SSRF 漏洞的 Python 脚本。它通过向 Request-Baskets API 发送 POST 请求，创建一个包含 `forward_url` 参数的 basket。该 `forward_url` 参数允许攻击者指定 Request-Baskets 服务器应该请求的内部或外部 URL。脚本通过字典文件枚举内部服务器，从而实现SSRF。

**投毒风险分析：**
查看了 `main.py` 的代码，没有发现任何明显的恶意代码或后门。该脚本的功能集中在利用 SSRF 漏洞上，执行指定 URL 的请求，并检查响应状态码。由于代码功能明确，且主要执行 HTTP 请求和状态码检查，因此可以认为不存在投毒风险。投毒风险评估为0%。

**利用方式分析：**
1.  **创建 Basket：** 攻击者使用提供的脚本，指定目标 Request-Baskets API URL 和内部目标 URL。
2.  **Wordlist 扫描：**  脚本从提供的 Wordlist 中读取条目，并将它们附加到内部目标 URL。例如，`http://127.0.0.1/path/leading/to/search/` + `wordlist_entry`。
3.  **发送请求：**  脚本构造包含恶意 `forward_url` 的 POST 请求，并将其发送到 Request-Baskets API 的 `/api/baskets/{name}` 端点。 `{name}` 是动态创建的 basket 名称。
4.  **服务器请求：** Request-Baskets 服务器会根据 `forward_url` 的值向内部目标服务器发出请求。
5.  **获取响应：**  攻击者可以检查 Request-Baskets 服务的响应，以获取有关内部服务器的信息，例如状态代码、内容长度等。此方法可用于枚举内部端口和服务。

**项目地址:** [seanrdev/cve-2023-27163](https://github.com/seanrdev/cve-2023-27163)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)