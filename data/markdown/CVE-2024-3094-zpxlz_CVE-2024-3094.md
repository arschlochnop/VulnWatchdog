## CVE-2024-3094 xz supply chain backdoor

**漏洞编号:** CVE-2024-3094

**漏洞类型:** 供应链攻击/后门

**影响应用:** xz-utils

**危害等级:** 严重，可能导致远程代码执行和系统控制

**影响版本:** 5.6.0 和 5.6.1

**利用条件:** 目标系统使用了受感染的 xz-utils 版本，并且 OpenSSH 链接到 liblzma。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-3094 是一个存在于 xz-utils 压缩库中的供应链后门漏洞。恶意代码被插入到 xz-utils 的上游 tarball 中，影响了 5.6.0 和 5.6.1 版本。该后门通过复杂的混淆手段，在构建过程中从伪装的测试文件中提取预构建的对象文件，并修改 liblzma 代码中的特定函数。这导致任何链接到该库的软件都可能被劫持和修改其数据交互。攻击主要影响 OpenSSH，通过拦截和修改 SSH 连接，攻击者可能实现未授权访问，甚至远程代码执行。

**有效性:** 根据漏洞信息，此漏洞已确认存在于特定版本的 xz-utils 中，且危害极大。PoC 代码的存在表明该漏洞是可利用的。

**投毒风险:**  提供的漏洞利用代码 (实际上是指向相关信息的链接和描述的 Markdown 文件) 本身不包含直接可执行的投毒代码。然而，供应链攻击的本质意味着恶意代码已经存在于受感染的 xz-utils 库中。该库被植入恶意代码的方式非常隐蔽和复杂，表明攻击者有能力进行高级的混淆和隐藏。由于攻击的复杂性，不能完全排除其他潜在的恶意行为或者隐藏的投毒代码的可能性，但从现有信息来看，直接的投毒风险较低。此处给出的 10% 的投毒风险概率，主要考虑的是文档中链接的各种资源可能存在潜在的风险，以及未来可能发现的该后门的其他恶意功能。

**利用方式:**
1.  **供应链污染：** 攻击者首先将恶意代码注入到 xz-utils 的源代码中。
2.  **构建过程劫持：** 在构建 liblzma 库时，恶意代码会被激活，修改关键函数。
3.  **SSH 拦截：** 受感染的 liblzma 库会被 OpenSSH 等应用程序链接。后门会拦截 SSH 连接。
4.  **权限提升/远程代码执行：** 通过修改 SSH 认证过程，攻击者可能绕过身份验证，获取系统访问权限，或者执行任意代码。

**项目地址:** [zpxlz/CVE-2024-3094](https://github.com/zpxlz/CVE-2024-3094)

**漏洞详情:** [CVE-2024-3094](https://nvd.nist.gov/vuln/detail/CVE-2024-3094)