## CVE-2010-1240-Adobe Reader Launch File 任意代码执行

**漏洞编号:** CVE-2010-1240

**漏洞类型:** 任意代码执行

**影响应用:** Adobe Reader and Acrobat

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** 9.x before 9.3.3, 8.x before 8.2.3

**利用条件:** 用户需要打开恶意的PDF文档

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2010-1240 漏洞存在于 Adobe Reader 和 Acrobat 9.x (9.3.3 之前版本) 和 8.x (8.2.3 之前版本)。该漏洞允许攻击者通过特制的 PDF 文档执行任意代码。漏洞的根本原因是 Adobe Reader 在处理 Launch File 警告对话框中的文本字段时，没有充分限制其内容。攻击者可以利用这一点，欺骗用户执行 PDF 文档中指定的任意本地程序。漏洞利用方式如下：

1.  **创建恶意 PDF：** 攻击者创建一个包含 Launch Action 的恶意 PDF 文档。Launch Action 指定要执行的本地程序（例如，PowerShell 脚本）。
2.  **欺骗用户：** 攻击者使用社会工程学技巧，修改 Launch File 警告对话框中的文本字段，使其看起来像是安全的操作（例如，声称打开按钮将允许用户阅读加密消息）。根据提供的代码信息，攻击者可以使用换行符和格式设置来伪装实际执行的命令。
3.  **代码执行：** 当用户打开 PDF 文档并单击“打开”按钮时，Adobe Reader 将执行指定的本地程序，从而允许攻击者在用户系统上执行任意代码。

**有效性：**

根据漏洞库信息、搜索引擎结果（尤其是 Exploit-DB 的链接）和提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。该代码提供了一个 Python 脚本，可以生成包含恶意 Launch Action 的 PDF 文档，从而触发该漏洞。

**投毒风险：**

在提供的代码中，存在一定投毒风险。因为该工具使用户可以嵌入自定义的PowerShell命令，那么可以添加一些恶意命令，例如安装后门、收集信息等。但是直接在pdf_generator.py文件中修改的投毒风险比较低，只有10%。

**利用方式：**

该漏洞的利用方式涉及社会工程学。攻击者必须诱骗用户打开恶意的 PDF 文档并单击“打开”按钮。如果用户使用的是受影响的 Adobe Reader 或 Acrobat 版本，并且没有应用相应的安全补丁，则攻击者可以成功执行任意代码。

**项目地址:** [12345qwert123456/CVE-2010-1240](https://github.com/12345qwert123456/CVE-2010-1240)

**漏洞详情:** [CVE-2010-1240](https://nvd.nist.gov/vuln/detail/CVE-2010-1240)