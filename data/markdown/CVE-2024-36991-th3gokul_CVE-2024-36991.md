## CVE-2024-36991 Splunk Enterprise on Windows 路径遍历漏洞

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感文件读取

**影响版本:** 9.0.x (< 9.0.10), 9.1.x (< 9.1.5), 9.2.x (< 9.2.2)

**利用条件:** Splunk Enterprise 运行在 Windows 操作系统上，且受影响版本。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36991是Splunk Enterprise在Windows操作系统上存在的路径遍历漏洞，存在于`/modules/messaging/`端点。攻击者可以通过构造包含`../`的恶意请求，绕过目录限制，读取服务器上的任意文件。根据提供的漏洞利用代码，该代码可以进行批量扫描和漏洞利用，但同时也存在一定的投毒风险，因为攻击者可能在代码中添加恶意功能，例如上传恶意文件或执行系统命令。虽然代码本身看起来是用于检测漏洞，但使用者如果从不可信的来源下载并使用，可能面临安全风险。

**利用方式:**

1.  **构造恶意URL:** 攻击者构造包含`../`序列的URL，例如：`{Splunk_URL}/en-US/modules/messaging/C:../C:../C:../windows/win.ini`。
2.  **发送HTTP请求:** 攻击者将构造的URL发送到受影响的Splunk Enterprise实例。
3.  **读取文件:** 如果漏洞存在且利用成功，服务器将返回请求的文件内容，例如`win.ini`文件。

**投毒风险评估:**

提供的POC代码主要功能是发送包含路径遍历的HTTP请求，并检查响应。潜在的投毒风险主要集中在以下几个方面：

*   **恶意文件下载/执行:** 攻击者可能修改代码，在成功利用漏洞后，从指定URL下载恶意文件并执行。
*   **信息窃取:** 攻击者可能修改代码，在扫描或利用过程中窃取目标服务器的敏感信息，例如操作系统版本、已安装软件列表等。
*   **后门植入:** 攻击者可能修改代码，在目标服务器上植入后门，以便长期控制。
*   **资源消耗:** 攻击者可能修改代码，发起大量请求，导致目标服务器资源耗尽，拒绝服务。

基于以上分析，虽然POC的主要功能是漏洞检测和利用，但由于代码的开源性，攻击者可以对其进行修改和二次分发，因此存在一定的投毒风险。考虑到github仓库的代码任何人都可以修改，并且作者也声明了免责声明,所以判断投毒风险为10%。

**项目地址:** [th3gokul/CVE-2024-36991](https://github.com/th3gokul/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)