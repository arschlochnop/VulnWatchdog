## CVE-2019-13272-Linux Kernel PTRACE_TRACEME 本地提权

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，允许本地用户获得 root 权限

**影响版本:** < 5.1.17

**利用条件:** 需要本地用户权限，可能依赖于特定程序（如 Polkit 的 pkexec 助手）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-13272 漏洞存在于 Linux Kernel 的 ptrace.c 中的 ptrace_link 函数，该函数处理进程创建 ptrace 关系时凭据的记录不当。攻击者可以利用父子进程关系，父进程放弃权限并调用 execve (可能允许攻击者控制)，从而获得 root 权限。漏洞利用方式主要涉及以下几个步骤：

1.  **建立 PTRACE 关系:** 利用 PTRACE_TRACEME，使进程成为另一个进程的 tracee。
2.  **权限丢弃与 execve:** 父进程先降低权限，然后调用 execve 执行新程序。
3.  **利用 ptracer_cred 缺陷:**  在 execve 过程中，由于 ptracer_cred 处理不当，可能导致权限检查绕过，从而执行 setuid 程序并提升权限。

根据漏洞库信息和搜索结果，该漏洞利用的有效性较高，存在公开的利用代码。

**关于投毒风险:**
提供的 POC 代码主要是漏洞分析，并未提供直接的可执行exp。 提供的分析代码主要用于解释漏洞原理，帮助理解漏洞触发条件。但无法完全排除代码贡献者在其他相关资源（例如exp代码）中植入恶意代码的可能性，但就仓库本身的内容判断投毒风险较低，估计在 10% 左右。实际使用任何漏洞利用代码时，务必进行充分的安全审查和测试。

**项目地址:** [datntsec/CVE-2019-13272](https://github.com/datntsec/CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)