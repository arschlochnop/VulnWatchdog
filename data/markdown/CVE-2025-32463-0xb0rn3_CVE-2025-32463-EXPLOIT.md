## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 版本中。该漏洞允许本地用户利用 `--chroot` 选项和用户可控的 `/etc/nsswitch.conf` 文件来获取 root 权限。

**有效性：**
根据漏洞库信息、搜索结果和提供的PoC代码，可以判断该漏洞利用是有效的。PoC代码详细描述了利用步骤，包括：

1.  **环境准备：** 创建一个恶意的 chroot 环境，包含伪造的 `/etc/nsswitch.conf` 文件。
2.  **恶意 NSS 库：** 编译一个包含恶意代码的 NSS 库，当 Sudo 加载该库时，恶意代码会执行并提升权限。
3.  **触发漏洞：** 使用 `sudo -R <chroot_dir> <command>` 命令，Sudo 在 chroot 环境中运行，并加载恶意的 NSS 库，导致权限提升。

**投毒风险：**
PoC代码本身是为了演示漏洞，但存在一定投毒风险。风险点在于：

1.  **恶意代码执行：** 编译后的恶意 NSS 库可以执行任意命令，如果攻击者修改了PoC代码，可能会植入恶意后门，执行未经授权的操作。
2.  **环境破坏：** 恶意的 chroot 环境可能会对系统造成破坏。

评估PoC投毒风险为 10%，主要的风险在于编译和部署阶段，如果未经仔细审查直接使用，可能存在被植入后门的风险，需要仔细检查Makefile和C代码。

**利用方式：**

1.  **创建恶意 chroot 环境：** 在用户可控的目录下，创建包含恶意的 `/etc/nsswitch.conf` 文件的 chroot 环境。
2.  **编译恶意 NSS 库：** 编写一个恶意的 NSS 库，其中包含提升权限的代码，例如调用 `setreuid(0,0)` 和 `setregid(0,0)`。
3.  **使用 Sudo 触发漏洞：** 运行 `sudo -R <chroot_dir> <command>` 命令，Sudo 会进入 chroot 环境，加载恶意的 NSS 库，并执行其中的代码，从而提升权限。

**项目地址:** [0xb0rn3/CVE-2025-32463-EXPLOIT](https://github.com/0xb0rn3/CVE-2025-32463-EXPLOIT)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)