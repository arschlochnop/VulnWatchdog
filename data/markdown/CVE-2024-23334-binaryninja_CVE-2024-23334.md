## CVE-2024-23334-aiohttp-目录遍历

**漏洞编号:** CVE-2024-23334

**漏洞类型:** 目录遍历

**影响应用:** aiohttp

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 3.9.2

**利用条件:** 需要目标服务器启用了`aiohttp.web.static`，并且设置了`follow_symlinks=True`。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23334 是 aiohttp 中的一个目录遍历漏洞。当使用 aiohttp 作为 Web 服务器并配置静态路由时，如果启用了 `follow_symlinks=True`，则可能允许攻击者访问静态文件根目录之外的文件。漏洞利用方式是通过构造包含 `../` 的 URL 路径，绕过访问控制，读取服务器上的任意文件。提供的 PoC 代码包含 Dockerfile、exploit.py、server.py 等文件。Dockerfile 用于构建包含漏洞版本的 aiohttp 的 Docker 镜像。server.py 实现了存在漏洞的 aiohttp Web 服务器。exploit.py 是漏洞利用脚本，通过发送包含目录遍历payload的HTTP请求来读取敏感文件，例如 `/etc/passwd`。 

**有效性：** 根据漏洞描述和 PoC 代码，提供的 PoC 应该有效。PoC 包含完整的环境搭建和利用脚本，可以验证漏洞的存在。

**投毒风险：** 分析 PoC 代码发现，exploit.py 有提取用户名 `/etc/passwd` 的操作，从提取的用户名中排除了 root，nobody 等系统用户，只保留非系统用户。该操作可能被利用于进一步的攻击，例如暴力破解用户名密码等，因此存在一定的风险。 但是总体来说，该仓库的投毒风险较低，评估为10%，主要是因为 exploit 脚本的目的主要是验证漏洞的存在。

**利用方式：**
1.  配置存在漏洞的 aiohttp Web 服务器，并设置 `follow_symlinks=True`。
2.  使用 exploit.py 脚本，指定目标服务器的 URL。
3.  脚本会发送包含目录遍历 payload 的 HTTP 请求，尝试读取敏感文件。
4.  如果漏洞存在，脚本将成功读取文件内容，例如 `/etc/passwd`，并提取用户名。

**项目地址:** [binaryninja/CVE-2024-23334](https://github.com/binaryninja/CVE-2024-23334)

**漏洞详情:** [CVE-2024-23334](https://nvd.nist.gov/vuln/detail/CVE-2024-23334)