## CVE-2017-6074-Linux Kernel DCCP Double-Free

**漏洞编号:** CVE-2017-6074

**漏洞类型:** Double-Free

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可提升至root权限或导致拒绝服务

**影响版本:** <= 4.9.11

**利用条件:** 本地用户权限，目标系统运行受影响的kernel版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-6074是一个Linux内核DCCP（Datagram Congestion Control Protocol）实现中的双重释放漏洞。具体来说，在`net/dccp/input.c`文件的`dccp_rcv_state_process`函数中，当内核处于LISTEN状态时，对DCCP_PKT_REQUEST类型的数据包处理不当，导致双重释放。攻击者可以通过调用`setsockopt`系统调用并设置`IPV6_RECVPKTINFO`选项来触发此漏洞，从而实现本地提权或者拒绝服务攻击（系统崩溃）。

**有效性：**
根据搜索结果，存在多个PoC代码，并且已经有成功利用的案例，因此判断该漏洞的POC代码有效。

**投毒风险：**
提供的漏洞利用代码只有`README.md`文件，内容为漏洞标题，无法判断是否有投毒代码，其他搜索结果发现的PoC在github上,存在一定的风险,但是大部分PoC只是为了验证漏洞的存在。考虑到漏洞利用本身较为复杂，需要精细的内存布局控制，攻击者可能在利用代码中加入一些不易察觉的恶意逻辑，但这种可能性相对较低，因此估计投毒风险为5%。主要风险在于使用者下载未经验证的第三方代码，可能存在编译错误或其他问题，但将其归类为“投毒”不太准确。

**利用方式：**
1.  攻击者首先需要拥有目标系统的本地用户权限。
2.  攻击者创建一个DCCP套接字。
3.  攻击者使用`setsockopt`系统调用，并设置`IPV6_RECVPKTINFO`选项，使得内核在处理DCCP数据包时会存储额外的信息。
4.  攻击者向监听DCCP端口的套接字发送构造好的DCCP_PKT_REQUEST数据包，触发内核中的双重释放漏洞。
5.  通过精心构造的内存布局，攻击者可以利用双重释放漏洞改写内核内存，从而实现提权或者拒绝服务攻击。

总而言之，该漏洞利用需要对内核有一定的了解，并且需要进行一定的调试和修改才能在不同的系统上成功利用。但是，由于该漏洞可以直接提升权限，因此危害性非常高。

**项目地址:** [BimsaraMalinda/Linux-Kernel-4.4.0-Ubuntu---DCCP-Double-Free-Privilege-Escalation-CVE-2017-6074](https://github.com/BimsaraMalinda/Linux-Kernel-4.4.0-Ubuntu---DCCP-Double-Free-Privilege-Escalation-CVE-2017-6074)

**漏洞详情:** [CVE-2017-6074](https://nvd.nist.gov/vuln/detail/CVE-2017-6074)