## CVE-2024-10914-D-Link NAS设备命令注入

**漏洞编号:** CVE-2024-10914

**漏洞类型:** 操作系统命令注入

**影响应用:** D-Link DNS-320, DNS-320LW, DNS-325, DNS-340L

**危害等级:** 高危，可远程执行任意代码，完全控制受影响的NAS设备

**影响版本:** <= 20241028

**利用条件:** 需要网络可达，且目标设备未打补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-10914是D-Link NAS设备中发现的一个严重命令注入漏洞，影响DNS-320、DNS-320LW、DNS-325和DNS-340L型号，版本最高至20241028。该漏洞存在于`/cgi-bin/account_mgr.cgi`的`cgi_user_add`函数中，通过操纵`name`参数，攻击者可以远程注入并执行任意操作系统命令。\n\n**有效性分析：**根据漏洞库信息、搜索引擎结果（特别是引用了POC的链接，如`https://www.verylazytech.com/vulnerabilities-and-exploits/cve-poc/cve-2024-10914-command-injection-vulnerability-in-name-parameter-for-d-link-nas`和github链接`https://github.com/ThemeHackers/CVE-2024-10914`）以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。脚本通过构造包含恶意命令的URL发送到受影响的设备，从而利用该漏洞。\n\n**投毒风险分析：** 提供的POC代码本身较为简洁，主要功能是构造包含命令注入payload的URL，并使用`curl`发送请求。虽然代码看起来简单，但任何未经授权的命令执行都存在潜在风险。例如，攻击者可以通过注入恶意命令来修改系统配置、安装后门、窃取敏感数据或进行拒绝服务攻击。因此，在使用或分发此类代码时，务必谨慎，并仅在授权的环境中进行测试。对POC的风险评估中，主要关注其利用漏洞执行任意命令的潜力。\n\n 投毒风险主要来源于：\n1. **命令参数中的潜在恶意代码：** 攻击者可能在`-c`参数中注入恶意代码，例如下载并执行恶意脚本。\n2. **URL解析的潜在风险：** 脚本对URL的处理可能存在漏洞，允许攻击者绕过某些安全检查。\n3. **依赖库的安全问题：** 虽然脚本只依赖`curl`和`figlet`，但这些库本身可能存在安全漏洞。\n总的来说，POC代码本身存在一定的投毒风险，主要体现在命令执行的不可控性。如果用户不小心执行了包含恶意代码的命令，可能会导致系统受损。因此，在使用该POC时，务必仔细检查要执行的命令，并确保来源可靠。脚本本身的功能较为直接，没有明显的恶意代码植入，因此投毒风险较低，故评定为5%。\n\n**利用方式：**\n1.  确定目标D-Link NAS设备的IP地址或域名。\n2.  使用提供的脚本`cve-2024-10914-exploit.sh`，通过`-u`参数指定目标URL，`-c`参数指定要执行的命令。例如：`./cve-2024-10914-exploit.sh -u http://<target_ip> -c 'echo hello'`。\n3.  脚本会构造包含恶意命令的URL，并使用`curl`发送请求到目标设备。\n4.  如果漏洞利用成功，目标设备将执行指定的命令，并将结果返回到攻击者。\n5.  攻击者可以根据返回结果判断漏洞是否成功利用，并进一步执行更复杂的命令，例如下载并执行恶意脚本，以获取对设备的完全控制权。

**项目地址:** [jahithoque/CVE-2024-10914-Exploit](https://github.com/jahithoque/CVE-2024-10914-Exploit)

**漏洞详情:** [CVE-2024-10914](https://nvd.nist.gov/vuln/detail/CVE-2024-10914)