## CVE-2023-23638 - Apache Dubbo 反序列化漏洞

**漏洞编号:** CVE-2023-23638

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Dubbo

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Apache Dubbo 2.7.x <= 2.7.21, Apache Dubbo 3.0.x <= 3.0.13, Apache Dubbo 3.1.x <= 3.1.5

**利用条件:** 需要Dubbo服务暴露，攻击者能够访问Dubbo服务端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23638 是 Apache Dubbo 中的一个反序列化漏洞，存在于泛化调用（generic invoke）功能中。攻击者可以利用此漏洞，通过发送特制的恶意序列化数据，在 Dubbo 服务端执行任意代码。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的漏洞利用代码，此漏洞的PoC代码是有效的。漏洞库信息和搜索引擎结果都确认了此漏洞的存在和风险。提供的代码仓库包含完整的利用链，从服务发现到代码执行再到回显，覆盖了Dubbo 3.x的利用过程，同时兼容Dubbo 2.x。

**投毒风险：**

分析提供的漏洞利用代码，仓库本身的主要功能是实现漏洞的利用。该仓库提供了漏洞利用工具，包含命令行和GUI界面，用于检测和利用该漏洞。代码中可能存在的风险点在于，如果攻击者使用该工具扫描大量目标，可能会引起法律问题。考虑到代码设计偏向于漏洞利用，存在一定的被恶意使用的风险，例如攻击者可能修改工具以进行大规模攻击，但是作者本身目的不属于投毒，投毒风险估计为10%。

**利用方式：**

利用方式主要通过 Dubbo 的泛化调用接口，发送恶意的序列化数据。具体步骤如下：

1.  **服务发现 (Dubbo 3.x):**  工具可以自动发现 Dubbo 服务。
2.  **构造恶意序列化数据:**  利用 Fastjson 或其他反序列化 Gadget 构造包含恶意代码的序列化数据。
3.  **泛化调用:**  通过 Dubbo 的泛化调用接口，将构造的恶意序列化数据发送到 Dubbo 服务端。
4.  **代码执行:**  Dubbo 服务端反序列化恶意数据，导致恶意代码执行。
5.  **回显:** 工具包含回显功能，将命令执行的结果返回给攻击者。

PoC代码提供了命令行和GUI两种使用方式，方便使用者进行漏洞验证和利用。


**项目地址:** [YYHYlh/Apache-Dubbo-CVE-2023-23638-exp](https://github.com/YYHYlh/Apache-Dubbo-CVE-2023-23638-exp)

**漏洞详情:** [CVE-2023-23638](https://nvd.nist.gov/vuln/detail/CVE-2023-23638)