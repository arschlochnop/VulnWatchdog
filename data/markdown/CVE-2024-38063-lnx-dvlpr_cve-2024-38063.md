## CVE-2024-38063 - Windows TCP/IP 远程代码执行漏洞

**漏洞编号:** CVE-2024-38063

**漏洞类型:** 远程代码执行

**影响应用:** Windows TCP/IP 协议栈

**危害等级:** 高危，可导致系统崩溃（蓝屏）和远程代码执行。

**影响版本:** 受影响的Windows版本包括 Windows 10, Windows 11, Windows Server 2008 至 2022 的多个版本（详见CVE描述）。

**利用条件:** 目标系统启用 IPv6。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以得出以下结论：

**1. 有效性：**

*   提供的 Python 脚本 `ipv6_bsod.py` 是一个 PoC（Proof-of-Concept）代码，旨在利用 CVE-2024-38063 漏洞导致目标系统蓝屏死机（BSOD）。
*   脚本使用 Scapy 库来构建和发送恶意的 IPv6 数据包。
*   搜索结果中的多个链接表明该漏洞确实存在，并且有公开的 PoC 代码。
*   该脚本通过构造包含特定选项 (PadN) 的 IPv6 目的选项扩展头以及分片 IPv6 数据包，来触发 Windows TCP/IP 协议栈中的整数下溢漏洞，从而导致内核崩溃。

**2. 投毒风险：**

*   分析提供的 Python 脚本，没有发现明显的恶意代码或后门。脚本的功能集中于构造和发送特定的网络数据包以触发漏洞。
*   所有操作都是围绕着scapy构造网络包，并发送。
*   该脚本的功能相对明确，没有超出漏洞利用的范围，因此投毒风险较低。
*   当然，任何代码都需要经过仔细审查，以确保其安全性。

**3. 利用方式：**

*   该漏洞是一个远程代码执行漏洞，攻击者可以通过发送特制的 IPv6 数据包来利用该漏洞。
*   利用方式主要涉及以下步骤：
    1.  使用 Scapy 库构建恶意的 IPv6 数据包。数据包中包含 `IPv6ExtHdrDestOpt` 扩展头，包含一个 `PadN` 选项，以及经过分片的 IPv6 数据包。
    2.  通过`sendp` 或者 `send` 函数将构造的数据包发送到目标系统。目标系统需要开启 IPv6。
    3.  当目标系统接收到这些数据包后，TCP/IP 协议栈中的漏洞会被触发，导致整数下溢，最终导致系统崩溃。
    4. PoC中存在一个延迟，方便用户观察。

**总结：**

提供的 PoC 代码有效，可以用于触发 CVE-2024-38063 漏洞。代码本身未发现投毒风险。漏洞利用方式是通过发送特制的 IPv6 数据包，触发 Windows TCP/IP 协议栈中的整数下溢漏洞，导致系统崩溃或远程代码执行。


**项目地址:** [lnx-dvlpr/cve-2024-38063](https://github.com/lnx-dvlpr/cve-2024-38063)

**漏洞详情:** [CVE-2024-38063](https://nvd.nist.gov/vuln/detail/CVE-2024-38063)