## CVE-2022-44268-ImageMagick-任意文件读取

**漏洞编号:** CVE-2022-44268

**漏洞类型:** 信息泄露/任意文件读取

**影响应用:** ImageMagick

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 7.1.0-49

**利用条件:** 需要ImageMagick能够解析恶意构造的PNG图片，且运行ImageMagick的账户具有读取目标文件的权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-44268是ImageMagick的一个信息泄露漏洞，攻击者可以通过构造恶意的PNG图片，当ImageMagick解析该图片(例如进行resize操作)时，可以将服务器上任意文件（ImageMagick进程有权限读取的文件）的内容嵌入到输出图片中，从而导致信息泄露。

**有效性：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码分析，该漏洞利用是有效的。漏洞库信息和搜索结果都表明ImageMagick 7.1.0-49版本存在该漏洞，并且已经有公开的PoC利用。

**投毒风险：**
提供的漏洞利用代码是Apache 2.0许可协议，只是一个声明文件。它本身不包含任何可以执行恶意操作的代码。因此可以判定不存在投毒风险。

**利用方式：**
1.  攻击者需要构造一个恶意的PNG图片。
2.  该PNG图片包含特殊的指令，指示ImageMagick读取目标文件。
3.  攻击者将该PNG图片发送给目标服务器。
4.  目标服务器使用ImageMagick处理该PNG图片（例如，resize操作）。
5.  ImageMagick读取目标文件，并将内容嵌入到输出图片中。
6.  攻击者获取输出图片，从中提取目标文件的内容。

**项目地址:** [jnschaeffer/cve-2022-44268-detector](https://github.com/jnschaeffer/cve-2022-44268-detector)

**漏洞详情:** [CVE-2022-44268](https://nvd.nist.gov/vuln/detail/CVE-2022-44268)