## CVE-2021-34527 PrintNightmare Windows Print Spooler Remote Code Execution

**漏洞编号:** CVE-2021-34527

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Print Spooler Service

**危害等级:** 高危，允许攻击者以SYSTEM权限执行任意代码

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要目标系统启用Print Spooler服务，且攻击者能够通过网络或本地访问Print Spooler服务

**POC 可用性:** 是，但提供的代码并非直接的漏洞利用，而是缓解脚本

**投毒风险:** 10%

## 详情

CVE-2021-34527（PrintNightmare）是一个Windows Print Spooler服务中的远程代码执行漏洞。攻击者可以利用此漏洞在目标系统上以SYSTEM权限执行任意代码。漏洞利用方式通常涉及向Print Spooler服务发送特制的请求，导致服务加载并执行恶意的DLL文件。提供的POC代码实际上是PowerShell脚本，用于设置注册表项以缓解此漏洞，而不是利用它。servers.ps1配置服务器的PointAndPrint设置，而workstations.ps1旨在阻止工作站上的远程打印连接。这些脚本通过修改注册表项来限制驱动程序安装和禁用远程RPC端点注册。由于脚本目标是缓解漏洞而非利用，因此投毒风险较低，但仍存在一定风险，例如配置错误可能导致打印功能失效，或者被篡改的脚本可能包含恶意代码。 搜索引擎结果表明此漏洞影响广泛，并且已经被积极利用。漏洞库信息也详细列出了受影响的Windows版本。需要注意的是，微软已经发布了安全更新来修复此漏洞，建议尽快安装。综合判断投毒风险约为10%，主要基于对脚本修改的可能性以及配置错误的风险。

**项目地址:** [syntaxbearror/PowerShell-PrintNightmare](https://github.com/syntaxbearror/PowerShell-PrintNightmare)

**漏洞详情:** [CVE-2021-34527](https://nvd.nist.gov/vuln/detail/CVE-2021-34527)