## CVE-2025-46817 Redis Integer Overflow RCE

**漏洞编号:** CVE-2025-46817

**漏洞类型:** Integer Overflow

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务开启Lua脚本支持，以及能与Redis服务器建立连接

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Redis的Lua脚本功能中，具体是`unpack()`函数。攻击者可以利用精心构造的Lua脚本，触发整数溢出，导致内存破坏，最终可能实现远程代码执行。

**漏洞利用方式：**

1.  攻击者需要能够连接到目标Redis服务器。
2.  攻击者需要确保Redis服务器启用了Lua脚本功能（默认开启）。
3.  攻击者利用提供的C代码编译生成可执行文件`exploit`。
4.  运行`exploit`，指定目标Redis服务器的IP地址和端口。
5.  `exploit`会发送包含恶意Lua脚本的命令到Redis服务器。
6.  恶意Lua脚本利用`unpack()`函数触发整数溢出。
7.  整数溢出导致内存破坏，如果成功，可能导致服务器崩溃或者被远程控制。

**有效性：**

根据漏洞库信息和提供的利用代码，该漏洞利用是有效的。漏洞库明确指出该漏洞允许经过身份验证的用户使用特制的Lua脚本导致整数溢出，并可能导致远程代码执行。POC代码旨在利用此漏洞，并通过`unpack()`函数的整数溢出导致Redis服务器崩溃，从而验证漏洞存在。

**投毒风险：**

分析提供的C代码和README.md文件，没有发现明显的投毒代码。C代码主要是利用hiredis库与Redis服务器交互，发送恶意Lua脚本。README.md文件仅包含漏洞描述、使用方法和免责声明。 虽然该POC的主要目的是演示漏洞，但理论上攻击者可以通过替换`EXPLOIT_PAYLOAD`宏定义的值，修改Lua脚本的内容，使其执行恶意操作。因此,从理论上来说，存在一定的修改payload进行恶意利用的可能，但从目前代码内容来看，没有明显的投毒代码。

**总结：**

该漏洞的利用依赖于Redis服务器的Lua脚本功能。攻击者利用`unpack()`函数的整数溢出漏洞，可能导致服务器崩溃或远程代码执行。提供的POC代码能够有效验证该漏洞，但需要Redis服务器开启Lua脚本功能。 目前没有在代码中发现投毒代码，只是利用的payload可以进行恶意代码替换

**项目地址:** [slayerkkkk/CVE-2025-46817-PoC](https://github.com/slayerkkkk/CVE-2025-46817-PoC)

**漏洞详情:** [CVE-2025-46817](https://nvd.nist.gov/vuln/detail/CVE-2025-46817)