## CVE-2023-22515-Confluence-Broken Access Control

**漏洞编号:** CVE-2023-22515

**漏洞类型:** Broken Access Control

**影响应用:** Atlassian Confluence Data Center and Server

**危害等级:** 高危，允许未经身份验证的远程攻击者创建 Confluence 管理员帐户，并完全控制 Confluence 实例。

**影响版本:** 8.0.0 <= version < 8.3.3, 8.4.0 <= version < 8.4.3, 8.5.0 <= version < 8.5.2

**利用条件:** Confluence Data Center 和 Server 实例必须可公开访问且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22515 是 Atlassian Confluence Data Center 和 Server 中的一个严重漏洞，允许未经身份验证的远程攻击者利用Broken Access Control漏洞创建未经授权的 Confluence 管理员帐户。 根据CISA信息，该漏洞已经被实际利用。

**漏洞利用方式：**
1.  攻击者首先发送一个 GET 请求到 `/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false`，该请求用于检查 Confluence 是否已完成设置。
2.  如果 Confluence 未完成设置（状态码为 200），攻击者会发送一个 POST 请求到 `/setup/setupadministrator.action`，并在请求体中包含要创建的管理员帐户的用户名、全名、电子邮件和密码。
3.  最后，攻击者发送一个 POST 请求到 `/setup/finishsetup.action` 以完成设置过程。成功后，攻击者即可使用新创建的管理员帐户登录 Confluence 并完全控制该实例。

**有效性：** 提供的 NSE 脚本 (cve-2023-22515.nse) 旨在检测目标主机是否存在 CVE-2023-22515 漏洞，并尝试利用该漏洞创建管理员账户。

**投毒风险：** 查看提供的 NSE 脚本，该脚本的功能是利用漏洞创建管理员账户以验证漏洞是否存在。该脚本本身并不包含任何恶意或隐藏的投毒代码，只是模拟了攻击过程来检查漏洞。因此，该仓库中存在作者隐藏的投毒代码的可能性极低，评估为0%。

**项目地址:** [fyx1t/NSE--CVE-2023-22515](https://github.com/fyx1t/NSE--CVE-2023-22515)

**漏洞详情:** [CVE-2023-22515](https://nvd.nist.gov/vuln/detail/CVE-2023-22515)