## CVE-2019-19781 - Citrix ADC/Gateway 目录遍历

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 13.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 产品中存在的一个目录遍历漏洞。攻击者可以利用该漏洞读取服务器上的任意文件，甚至可能执行任意代码。 

**有效性：** 根据漏洞库信息、搜索结果和漏洞利用代码，此漏洞利用是有效的，并且已被广泛利用。

**投毒风险：** 提供的漏洞利用代码 `CVE-2019-19781-DFIR.md` 主要是用于事件响应和数字取证的文档，包含了检查受影响系统的方法和IOC（入侵指标）。

*   **投毒可能性评估：** 虽然这份文档本身主要是为了帮助安全人员，但其中也存在一定的投毒风险，可能性较低（10%）。
    *   **原因：** 文档中可能存在一些微妙的、不明显的建议或命令，如果执行不当，可能会导致系统不稳定或者留下后门。例如，文档中提到的扫描器如果使用不当，可能会对目标系统造成干扰。此外，攻击者也可能通过修改或传播恶意版本的DFIR文档来误导安全人员。

**利用方式：**

1.  **目录遍历：** 攻击者通过构造特殊的 URL，利用`../`等字符进行目录跳转，访问受限目录下的文件。
2.  **文件读取：** 成功进行目录遍历后，攻击者可以读取服务器上的敏感文件，例如配置文件、密钥等。
3.  **远程代码执行 (结合其他漏洞)：** 通过读取配置文件等敏感信息，攻击者可以进一步利用其他漏洞（例如模板注入）实现远程代码执行。根据搜索结果，该漏洞经常与远程代码执行联系在一起。
4.  **恶意文件上传:** 根据packetstormsecurity上的利用信息,可以上传恶意文件到服务器上.

**缓解措施：**

*   及时更新 Citrix ADC 和 Gateway 到最新版本。
*   应用 Citrix 官方提供的缓解措施。
*   监控系统日志，检测可疑的目录遍历行为。

**项目地址:** [zerobytesecure/CVE-2019-19781](https://github.com/zerobytesecure/CVE-2019-19781)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)