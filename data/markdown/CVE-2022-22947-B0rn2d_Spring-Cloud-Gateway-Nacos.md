## CVE-2022-22947 Spring Cloud Gateway 代码注入

**漏洞编号:** CVE-2022-22947

**漏洞类型:** 代码注入

**影响应用:** Spring Cloud Gateway

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 3.1.x prior to 3.1.1+, 3.0.x prior to 3.0.7+ 以及所有旧版本

**利用条件:** Gateway Actuator endpoint 必须启用、暴露且未进行安全保护

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-22947 存在于 Spring Cloud Gateway 中，当 Gateway Actuator endpoint 启用、暴露且未进行安全保护时，允许未经身份验证的远程攻击者发送恶意构造的请求，利用 SpEL 表达式注入执行任意代码。根据搜索引擎结果和漏洞库信息，该漏洞已被公开利用，CISA KEV 中已收录。提供的代码片段是一个 Maven 项目的 `.iml` 文件，它描述了项目的依赖关系。虽然不能直接确定利用代码，但通过依赖信息（如 `spring-cloud-gateway-server:3.1.0`）可以推断该项目旨在构建一个易受攻击的 Spring Cloud Gateway 实例。利用方式通常涉及向 Actuator endpoint 发送包含恶意 SpEL 表达式的 HTTP 请求。投毒风险分析：提供的代码片段 `.iml` 文件本身不包含恶意代码，因为它只是描述了项目的依赖。 然而，整个代码仓库（如果存在其他文件）可能包含被作者隐藏的恶意代码。 这里将风险预估为10%，原因是不排除整个项目被投毒的可能性，例如构建脚本或隐藏的资源文件。

**项目地址:** [B0rn2d/Spring-Cloud-Gateway-Nacos](https://github.com/B0rn2d/Spring-Cloud-Gateway-Nacos)

**漏洞详情:** [CVE-2022-22947](https://nvd.nist.gov/vuln/detail/CVE-2022-22947)