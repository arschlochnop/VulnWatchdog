## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，允许攻击者上传恶意JSP文件并执行，从而完全控制服务器

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** 运行在Windows系统上，HTTP PUT方法启用（readonly初始化参数设置为false）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞存在于 Apache Tomcat 7.0.0 到 7.0.79 版本中。当 Tomcat 运行在 Windows 操作系统上，且配置允许 HTTP PUT 方法（例如，readonly 初始化参数被设置为 false）时，攻击者可以通过构造特殊的请求上传恶意的 JSP 文件到服务器。上传的 JSP 文件随后可以被访问，其中的恶意代码会被服务器执行，导致远程代码执行。

**有效性：**
根据漏洞库信息、搜索结果以及提供的 PoC 代码 `tomcate-cve-put.py`，此漏洞的 PoC 代码是有效的。搜索结果也表明这是一个已知的、被广泛利用的漏洞，CISA 的 Known Exploited Vulnerabilities Catalog 已经收录了此漏洞。

**投毒风险：**
查看`tomcate-cve-put.py`文件，该脚本主要功能是发送PUT请求上传JSP后门文件，没有发现隐藏的、与漏洞利用无关的代码。脚本内容清晰，功能明确，风险可控。因此，判断此仓库中作者隐藏投毒代码的可能性较低，估计为0%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行在 Windows 操作系统上，并且启用了 HTTP PUT 方法（readonly 参数设置为 false）。
2.  **上传恶意JSP文件：** 攻击者构造一个 HTTP PUT 请求，将包含恶意代码的 JSP 文件上传到服务器。利用`.jsp`后缀绕过上传限制。
3.  **执行恶意代码：** 攻击者通过 Web 浏览器或 HTTP 客户端访问上传的 JSP 文件。Tomcat 服务器会执行该 JSP 文件中的代码，从而实现远程代码执行。提供的 PoC 代码 `tomcate-cve-put.py` 正是实现了这个过程，它上传一个包含命令执行功能的JSP shell。


**项目地址:** [zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717](https://github.com/zi0Black/POC-CVE-2017-12615-or-CVE-2017-12717)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)