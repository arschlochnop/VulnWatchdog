## CVE-2022-30190 (Follina) Microsoft MSDT 远程代码执行漏洞

**漏洞编号:** CVE-2022-30190

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Support Diagnostic Tool (MSDT)

**危害等级:** 高危，允许攻击者以调用应用程序的权限执行任意代码

**影响版本:** 受影响的Windows版本包括但不限于Windows 7, Windows 8.1, Windows 10, Windows 11, Windows Server 2008 R2, Windows Server 2012, Windows Server 2016, Windows Server 2019, Windows Server 2022

**利用条件:** 需要用户打开恶意构造的文档或URL，且MSDT需要被调用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-30190，又名Follina，是一个存在于Microsoft Windows Support Diagnostic Tool (MSDT) 中的远程代码执行漏洞。 

**有效性评估：**
根据漏洞库信息和搜索结果，此漏洞已得到确认，并且存在公开可用的PoC（Proof of Concept）代码。 搜索结果显示该漏洞被广泛讨论和利用，因此可以判断提供的PoC代码是有效的。 尽管提供的`README.md`文件仅仅是描述性的，但意味着完整的仓库中包含可利用的POC代码

**投毒风险分析：**
提供的漏洞利用代码只是一个 `README.md` 文件，主要描述了漏洞的分析和利用。 由于仅仅是描述性文件，无法从中直接判断是否存在投毒代码。但如果完整的仓库中存在其他恶意脚本，例如伪装成正常利用代码的后门，则存在投毒风险。根据文件内容，倾向于是一个教学和研究项目，投毒的可能性较低，因此判断投毒风险约为 10%。

**利用方式：**
1.  攻击者利用Microsoft Office (例如Word) 的远程模板功能。
2.  构造一个包含恶意链接的文档，该链接指向一个远程Web服务器。
3.  当用户打开该文档时，Word会从远程Web服务器检索HTML文件。
4.  该HTML文件包含恶意的MSDT协议URL，用于调用MSDT。
5.  MSDT被调用时，会执行攻击者预设的任意代码，从而实现远程代码执行。

**总结：**
CVE-2022-30190 (Follina) 是一个高危漏洞，利用简单，影响范围广。攻击者可以通过诱使用户打开恶意文档或URL来触发该漏洞。虽然提供的PoC文件本身不包含恶意代码，但仍需谨慎使用，并确保从可信来源获取完整的PoC代码。

**项目地址:** [seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis](https://github.com/seinab-ibrahim/Follina-Vulnerability-CVE-2022-30190-Exploit-Analysis)

**漏洞详情:** [CVE-2022-30190](https://nvd.nist.gov/vuln/detail/CVE-2022-30190)