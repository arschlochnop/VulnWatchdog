## CVE-2020-9483 - Apache SkyWalking SQL注入

**漏洞编号:** CVE-2020-9483

**漏洞类型:** SQL注入

**影响应用:** Apache SkyWalking

**危害等级:** 高危，可能导致数据泄露和未授权数据访问

**影响版本:** 6.0.0 to 6.6.0, 7.0.0

**利用条件:** 使用H2/MySQL/TiDB作为存储，且允许通过GraphQL协议进行元数据查询

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-9483 存在于 Apache SkyWalking 6.0.0 到 6.6.0 和 7.0.0 版本中。当使用 H2/MySQL/TiDB 作为存储时，通过 GraphQL 协议进行元数据查询时，存在 SQL 注入漏洞。漏洞原因是 H2/MySQL/TiDB 存储实现未使用适当的方式设置 SQL 参数，攻击者可以通过构造恶意的 GraphQL 查询，注入 SQL 代码，从而访问未授权的数据。PoC代码（`Neko-chanQwQ/CVE-2020-9483`仓库）的存在证明了该漏洞的可利用性。提供的漏洞利用代码仓库 `6605ab9b6e51dfcad3b47614688e6a0b/README.md` 只有一个 README 文件，内容仅为 `# CVE-2020-9483---Apache-Skywalking-8.3.0`，没有实际的利用代码。因此，可以认为本身不具备直接利用的价值。投毒风险较低，因为只包含简单的说明信息，但考虑到攻击者可能会利用相似仓库进行传播恶意代码，所以仍旧有一定的潜在风险，此处评估为10%。

利用方式：

1.  **确定目标：** 确认目标 SkyWalking 版本是否在受影响范围内 (6.0.0 - 6.6.0, 7.0.0) 且使用了 H2/MySQL/TiDB 作为存储。
2.  **构造恶意 GraphQL 查询：** 构造包含恶意 SQL 代码的 GraphQL 查询，例如，在查询参数中注入 SQL 语句。
3.  **发送请求：** 将构造好的 GraphQL 查询发送到 SkyWalking 服务器。
4.  **利用成功：** 如果利用成功，攻击者可以读取、修改或删除数据库中的数据，或者执行其他恶意操作。

从搜索引擎结果来看，有明确的扫描器和PoC可以用来验证和利用此漏洞。

**项目地址:** [tuaandatt/CVE-2020-9483---Apache-Skywalking-8.3.0](https://github.com/tuaandatt/CVE-2020-9483---Apache-Skywalking-8.3.0)

**漏洞详情:** [CVE-2020-9483](https://nvd.nist.gov/vuln/detail/CVE-2020-9483)