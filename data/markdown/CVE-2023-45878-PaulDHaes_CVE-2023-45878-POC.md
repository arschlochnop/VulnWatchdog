## CVE-2023-45878-GibbonEdu-任意文件写入

**漏洞编号:** CVE-2023-45878

**漏洞类型:** 任意文件写入

**影响应用:** GibbonEdu

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 25.0.1

**利用条件:** 需要未授权访问 rubrics_visualise_saveAjax.php 页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45878 漏洞存在于 GibbonEdu 25.0.1 及更早版本中。攻击者可以通过未授权访问 `rubrics_visualise_saveAjax.php` 页面，利用 `img` 和 `path` 参数实现任意文件写入。`img` 参数接收 base64 编码的图片数据，`path` 参数指定写入路径。由于该页面未进行身份验证，攻击者可以构造包含恶意 PHP 代码的图片，并将其写入到 Web 目录下，从而实现远程代码执行。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用的有效性较高。POC 代码通过构造包含 PHP 代码的 base64 编码图片，并利用 `rubrics_visualise_saveAjax.php` 页面写入该文件。搜索引擎结果也显示有可用的 Exploit 代码。

**投毒风险：**
分析 POC 代码内容，发现其功能主要是上传 webshell 和执行命令。代码存在开启 HTTP 服务，使用 PowerShell 下载执行脚本，以及启动 Netcat 监听等功能。 虽然这些功能本身是为了完成漏洞利用，但攻击者可以利用这些功能进行恶意活动。例如，可以修改 reverse shell 脚本，或者利用 HTTP 服务传播恶意软件。 代码中 powershell 加载的脚本存在一定风险，如果脚本源被劫持，可能被植入恶意代码。考虑到 HTTP 服务器和 PowerShell 脚本的潜在风险，这里将投毒风险评估为 10%。

**利用方式：**
1.  攻击者利用 `rubrics_visualise_saveAjax.php` 页面上传包含 PHP 代码的 webshell。
2.  攻击者通过访问 webshell 执行任意命令，例如下载并执行 PowerShell 脚本。
3.  PowerShell 脚本可以用于建立反向 shell 连接，从而控制受害者服务器。

**项目地址:** [PaulDHaes/CVE-2023-45878-POC](https://github.com/PaulDHaes/CVE-2023-45878-POC)

**漏洞详情:** [CVE-2023-45878](https://nvd.nist.gov/vuln/detail/CVE-2023-45878)