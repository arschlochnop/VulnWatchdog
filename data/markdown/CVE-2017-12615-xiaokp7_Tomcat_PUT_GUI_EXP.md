## CVE-2017-12615 - Apache Tomcat PUT方法任意文件写入

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 任意文件上传/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Tomcat运行在Windows主机上，启用了HTTP PUT请求方法，readonly初始化参数设置为false

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-12615 漏洞允许攻击者通过PUT方法上传包含恶意代码的JSP文件到Tomcat服务器，从而导致远程代码执行。该漏洞利用的有效性取决于目标环境是否满足以下条件：

1.  **操作系统**: 目标服务器必须运行在Windows操作系统上。
2.  **Tomcat版本**:  Tomcat版本必须在7.0.0到7.0.79之间。
3.  **PUT方法启用**: 必须启用HTTP PUT方法。通常，这需要将`readonly`初始化参数设置为`false`。

**漏洞利用方式：**

1.  **检测漏洞存在**:  使用提供的工具检测目标站点是否存在Tomcat PUT漏洞。可以通过发送特制的PUT请求来判断服务器是否允许上传JSP文件。
2.  **上传JSP文件**:  如果漏洞存在，攻击者可以使用PUT方法上传一个包含恶意JSP代码的文件。通常，利用程序会尝试上传一个webshell，以便进一步控制服务器。
3.  **执行JSP代码**:  上传成功后，攻击者可以通过访问上传的JSP文件来执行其中的代码。攻击者可以通过构造包含恶意代码的JSP文件，例如执行系统命令，读取敏感文件等。

**投毒风险分析：**

分析提供的POC代码，主要功能包括漏洞检测、命令执行和文件上传。文件上传功能默认上传哥斯拉webshell，并允许自定义webshell内容及文件名。该工具本身旨在利用漏洞，并未发现作者隐藏的恶意代码或后门，用于感染攻击者系统或进行其他恶意活动。因此，投毒风险评估为0%。 该漏洞已被CISA列入已知被利用漏洞目录，具有较高的现实威胁。

**项目地址:** [xiaokp7/Tomcat_PUT_GUI_EXP](https://github.com/xiaokp7/Tomcat_PUT_GUI_EXP)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)