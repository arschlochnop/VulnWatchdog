## CVE-2022-41082-Microsoft Exchange Server Remote Code Execution

**漏洞编号:** CVE-2022-41082

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，允许远程代码执行，可能导致服务器完全控制

**影响版本:** 受影响版本包括 Microsoft Exchange Server 2013 Cumulative Update 23、2016 Cumulative Update 22 and 23, 以及 2019 Cumulative Update 11 and 12，具体版本范围请参考漏洞库信息。

**利用条件:** 需要攻击者能够访问 Exchange PowerShell 或者利用 SSRF 漏洞 (CVE-2022-41040) 配合利用。根据搜索结果，通常需要身份验证。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2022-41082 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，该漏洞通常与 CVE-2022-41040 (ProxyNotShell) 结合使用。CVE-2022-41040 是一个服务器端请求伪造 (SSRF) 漏洞，攻击者利用它来触发 CVE-2022-41082。利用方式通常涉及构造特定的 HTTP 请求发送到 Exchange 服务器，从而执行任意代码。提供的 YAML 格式的 PoC 代码主要用于检测漏洞是否存在。它尝试访问 `/autodiscover/autodiscover.json@Powershell.{{randstr}}.com/owa/` 路径，并检查服务器的响应状态码是否为 401 (未经授权)以及响应头中是否包含 `x-owa-version`。如果同时满足这两个条件，则可能存在此漏洞。关于投毒风险，PoC 本身主要目的是验证漏洞是否存在，但仍然存在一定的风险，例如，如果利用代码被修改为在服务器上执行恶意操作，或者被用来扫描大量目标服务器，可能会对网络造成一定的影响。PoC 验证阶段，不应该被认为是投毒行为。基于提供的 PoC 代码，其中使用了随机字符串 `{{randstr}}`，表明其主要目的是探测漏洞是否存在，而不是执行具体的恶意操作。因此，可以评估投毒风险较低，但是考虑到任何代码都可能被滥用或修改，仍然存在潜在风险。搜索结果也表明该漏洞被积极利用，需要及时修补。尽管 YAML 文件本身没有看到直接执行恶意操作的代码，但不能完全排除编写者或使用者后续添加恶意代码的可能性。所以评估投毒风险为 10%。

**项目地址:** [SUPRAAA-1337/CVE-2022-41082](https://github.com/SUPRAAA-1337/CVE-2022-41082)

**漏洞详情:** [CVE-2022-41082](https://nvd.nist.gov/vuln/detail/CVE-2022-41082)