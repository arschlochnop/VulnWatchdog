## CVE-2014-6287-Rejetto HFS-远程命令执行

**漏洞编号:** CVE-2014-6287

**漏洞类型:** 远程命令执行

**影响应用:** Rejetto HTTP File Server (HFS)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3x before 2.3c

**利用条件:** 需要目标服务器运行存在漏洞的Rejetto HFS 2.3x版本，并且攻击者可以网络访问该服务器的HTTP服务端口(默认80)。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6287是Rejetto HTTP File Server (HFS) 2.3x版本(低于2.3c)中parserLib.pas文件的findMacroMarker函数存在的一个远程命令执行漏洞。攻击者可以利用该漏洞，通过在search action中发送包含%00序列的特制请求，在服务器上执行任意程序。

**有效性：**
提供的Metasploit POC是有效的。漏洞信息和搜索引擎结果都表明该漏洞存在并且可以被利用。Metasploit模块的存在进一步确认了该漏洞的可利用性。

**投毒风险：**
提供的POC代码是一个Metasploit模块的使用说明。它描述了如何使用Metasploit框架来利用这个漏洞，并没有包含任何恶意或隐藏的代码。因此，投毒风险为0%。

**利用方式：**
1.  攻击者发送包含`%00`序列的恶意请求到Rejetto HFS服务器的search action。
2.  `findMacroMarker`函数未能正确处理空字节`%00`，导致后续的程序执行流程可以被攻击者控制。
3.  攻击者通过精心构造的请求，在服务器上执行任意命令。这通常通过在请求中嵌入操作系统命令来实现，例如 `ipconfig`（Windows）或 `ifconfig`（Linux），用于验证漏洞的存在，更进一步则可以直接执行shell后门程序。
4. Metasploit模块简化了利用过程，攻击者只需要设置目标IP地址、端口和攻击者IP地址，Metasploit就会自动生成包含恶意命令的请求，并发送到目标服务器，从而实现远程代码执行。

**项目地址:** [Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287](https://github.com/Nicoslo/Windows-exploitation-Rejetto-HTTP-File-Server-HFS-2.3.x-CVE-2014-6287)

**漏洞详情:** [CVE-2014-6287](https://nvd.nist.gov/vuln/detail/CVE-2014-6287)