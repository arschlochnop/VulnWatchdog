## CVE-2024-10924 - Really Simple Security Authentication Bypass

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress Plugin

**危害等级:** 严重，可能导致未经授权的访问和完全控制受影响的WordPress站点

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** 目标WordPress站点必须安装并启用受影响版本的Really Simple Security插件，并且启用了Two-Factor Authentication功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-10924 允许未经身份验证的攻击者绕过身份验证并以站点上任何现有用户的身份（包括管理员）登录。漏洞存在于 Really Simple Security 插件的 REST API 中，具体是在处理两因素身份验证的 'check_login_and_get_user' 函数时，对用户检查错误处理不当。PoC 代码首先向 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送一个POST请求，尝试绕过Two-Factor Authentication，并获取一个Set-Cookie。然后，使用获取的Cookie和提供的用户名密码，向 `/wp-admin/profile.php` 发送POST请求，尝试进行身份验证。成功后，PoC会将响应保存到HTML文件中，并在浏览器中自动打开该文件。 投毒风险分析：PoC代码本身主要用于演示漏洞，并自动打开浏览器，方便用户测试。风险在于脚本本身会请求用户输入密码，并且会在本地生成html文件，如果用户不注意可能会造成本地信息泄露。此外，github中包含的其他链接，例如docker环境，也存在一定的下载编译风险，但整体投毒风险较低，大约为10%。

**项目地址:** [Maalfer/CVE-2024-10924-PoC](https://github.com/Maalfer/CVE-2024-10924-PoC)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)