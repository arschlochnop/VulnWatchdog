## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** 远程桌面服务 (RDP)

**危害等级:** 严重，可能导致远程代码执行，完全控制受影响的系统

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，且未安装相应的安全补丁。攻击者需要能够通过网络访问目标系统的3389端口。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708（BlueKeep）是一个存在于Windows远程桌面服务中的远程代码执行漏洞。未经身份验证的攻击者可以通过向目标系统发送特制的RDP请求来利用此漏洞。成功利用此漏洞的攻击者可以在目标系统上执行任意代码。 

**有效性评估：**

根据提供的漏洞库信息和搜索结果，CVE-2019-0708是一个已知的、影响广泛且严重的漏洞。搜索结果中包含多个关于漏洞利用和缓解措施的文章，表明该漏洞已被积极研究和利用。

提供的Dockerfile和相关文件似乎构建了一个用于漏洞利用的环境。Dockerfile指示构建一个包含打了补丁的rdesktop的Debian容器。`setup.sh` 脚本可能用于编译和配置rdesktop， `entrypoint.sh`脚本定义了容器的启动行为。 由于使用了打了补丁的rdesktop， 这可能是一个用于测试或研究漏洞利用的PoC， 但它本身不会主动攻击目标。

**投毒风险分析：**

分析Dockerfile和相关文件，存在一定的投毒风险的可能性，但概率较低。因为Dockerfile构建的是一个包含打了补丁的rdesktop的环境, 存在作者在`setup.sh` 或其他脚本中加入恶意代码的可能性，例如，在编译过程中植入后门或收集目标信息。 因此，需要仔细审查`setup.sh`，`entrypoint.sh` 以及 `rdesktop-fork-bd6aa6acddf0ba640a49834807872f4cc0d0a773`的代码。

**利用方式分析：**

根据漏洞描述和搜索结果，利用方式如下：

1.  攻击者通过RDP协议连接到目标系统。
2.  攻击者发送特制的RDP请求，触发漏洞。
3.  漏洞触发后，攻击者可以在目标系统上执行任意代码。

利用代码可能包含以下步骤：

1.  构建一个包含修改后的RDP客户端（rdesktop）的环境。
2.  使用该RDP客户端连接到目标系统。
3.  发送包含漏洞触发代码的RDP数据包。
4.  在目标系统上执行payload。

**项目地址:** [andripwn/CVE-2019-0708](https://github.com/andripwn/CVE-2019-0708)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)