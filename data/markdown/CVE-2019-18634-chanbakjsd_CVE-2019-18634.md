## CVE-2019-18634-Sudo-Stack-Based Buffer Overflow

**漏洞编号:** CVE-2019-18634

**漏洞类型:** 栈缓冲区溢出

**影响应用:** Sudo

**危害等级:** 高危，可导致权限提升

**影响版本:** < 1.8.26

**利用条件:** pwfeedback在/etc/sudoers中启用

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2019-18634是一个存在于Sudo 1.8.26之前版本的栈缓冲区溢出漏洞。当/etc/sudoers文件中启用了pwfeedback选项时，攻击者可以利用此漏洞。 

**漏洞利用方式：**
攻击者需要向tgetpass.c中的getln()函数的标准输入（stdin）传递一个长字符串，从而触发sudo进程中的栈缓冲区溢出，从而达到权限提升的目的。

**有效性：**
提供的POC代码似乎有效。Dockerfile配置了易受攻击的环境，并编译安装了存在漏洞的sudo版本。 Python脚本（exploit.py）旨在通过溢出缓冲区并覆盖相关变量来实现权限提升。

**投毒风险：**
在提供的代码仓库中，投毒风险极低。以下是风险评估：

*   **Dockerfile:**  Dockerfile的功能是构建一个包含易受攻击sudo版本的环境。恶意投毒代码不太可能隐藏在这里。
*   **LICENSE:**  ISC许可证是一个常见的开源许可证，本身不构成风险。
*   **README.md:**  README文件描述了漏洞和利用方法，不包含恶意代码。
*   **develop.sh:**  此脚本用于构建docker镜像并分析编译后的sudo可执行文件。虽然脚本中包含objdump等命令，但这些命令是为了分析二进制文件，而不是植入恶意代码。
*   **exploit.py:**  Python 脚本是主要攻击载荷。它用于利用漏洞。虽然它本身是攻击代码，但与“投毒”的概念不同。

**项目地址:** [chanbakjsd/CVE-2019-18634](https://github.com/chanbakjsd/CVE-2019-18634)

**漏洞详情:** [CVE-2019-18634](https://nvd.nist.gov/vuln/detail/CVE-2019-18634)