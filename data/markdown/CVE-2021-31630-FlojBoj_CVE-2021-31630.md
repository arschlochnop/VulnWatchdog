## CVE-2021-31630 - OpenPLC Webserver v3 远程命令执行

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 远程命令执行

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** v3

**利用条件:** 需要OpenPLC Webserver v3运行，且攻击者能够访问/hardware页面，并拥有有效的用户名和密码进行身份验证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞信息，OpenPLC Webserver v3 存在一个远程命令执行漏洞（CVE-2021-31630），攻击者可以通过“Hardware Layer Code Box”组件，在/hardware页面上执行任意代码。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录OpenPLC Webserver v3。
2.  **上传恶意C文件：** 攻击者将包含反向shell的恶意C代码上传到“Hardware Layer Code Box”组件。该代码会在目标系统上创建一个反向shell连接到攻击者的监听器IP地址和端口。
3.  **编译：** 攻击者通过访问/compile-program端点触发C代码的编译。
4.  **启动PLC：** 攻击者访问/start_plc端点启动PLC，这将执行编译后的恶意代码，从而建立反向shell。
5.  **停止PLC：**  攻击者访问/stop_plc端点停止PLC。停止PLC不是必须的操作，因为反向shell一旦建立，就会保持连接，即使PLC停止运行。

**有效性：**

提供的PoC代码看起来是有效的。它包含了必要的步骤，如身份验证、上传恶意C文件、编译、启动PLC和停止PLC。代码中使用的反向shell技术是一种常见的利用远程命令执行漏洞的方式。

**投毒风险：**

PoC代码本身没有明显的投毒行为。`exploit.py`脚本的主要功能是自动化漏洞利用过程，没有发现任何会损害攻击者自身或其他用户的恶意代码。恶意行为都集中在创建反向shell，利用目标机器，没有迹象表明会影响到攻击者或其他人, 投毒风险可能性为0%。

**项目地址:** [FlojBoj/CVE-2021-31630](https://github.com/FlojBoj/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)