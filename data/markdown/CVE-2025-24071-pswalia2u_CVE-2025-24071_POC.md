## CVE-2025-24071-Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/欺骗

**影响应用:** Microsoft Windows File Explorer

**危害等级:** 高危，可能导致NTLM凭据泄露和远程文件访问

**影响版本:** 受影响的Windows版本见漏洞库信息

**利用条件:** 需要目标用户打开特制的.library-ms文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞。攻击者可以通过创建一个恶意的`.library-ms`文件，诱导用户打开该文件。当用户打开该文件时，文件资源管理器会尝试访问该文件指定的网络路径，从而可能泄露用户的NTLM凭据。 

**漏洞利用方式：**

1.  **创建恶意.library-ms文件：** 攻击者使用PoC代码生成一个包含恶意网络路径的`.library-ms`文件。  PoC代码从环境变量 `IP_ADDRESS` 和 `FILE_NAME` 读取值,  `IP_ADDRESS` 默认为 `127.0.0.1`，`FILE_NAME`默认为 “Increment”, 然后将 `FILE_NAME` 加上 “.library-ms” 后缀。 文件内容包含一个指向`\\{value1}\apnashare`的URL，其中{value1}是IP_ADDRESS环境变量的值。
2.  **诱骗用户打开文件：** 攻击者将该文件发送给目标用户，并诱骗其打开。这可以通过社会工程学或其他攻击手段实现。
3.  **NTLM凭据泄露：** 当用户打开`.library-ms`文件时，文件资源管理器会尝试访问指定的网络路径。如果攻击者控制该网络路径，则可以捕获用户的NTLM凭据。
4.  **利用NTLM凭据：** 攻击者可以使用泄露的NTLM凭据进行进一步的攻击，例如横向移动或提权。

**有效性分析：**

根据漏洞描述和PoC代码，该漏洞利用方式是有效的。PoC代码能够生成包含恶意网络路径的`.library-ms`文件，从而触发NTLM凭据泄露。

**投毒风险分析：**

该PoC代码本身未发现明显的投毒代码。 代码的作用是创建一个`.library-ms`文件, 文件内容指向环境变量指定的IP地址的共享目录。  该代码只是一个漏洞演示，不包含任何恶意功能,因此代码存在投毒的可能性较低, 可以认为投毒风险是0%。

**缓解措施：**

*   及时安装Microsoft发布的补丁。
*   不要轻易打开来源不明的`.library-ms`文件。
*   配置网络访问控制，限制文件资源管理器访问不信任的网络路径。


**项目地址:** [pswalia2u/CVE-2025-24071_POC](https://github.com/pswalia2u/CVE-2025-24071_POC)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)