## CVE-2025-46157 – Timetrax V1 (2025) 远程代码执行和权限提升

**漏洞编号:** CVE-2025-46157

**漏洞类型:** 远程代码执行 (RCE) 和权限提升

**影响应用:** Timetrax V1 (2025)

**危害等级:** 严重，可能导致完全系统控制

**影响版本:** V1 (2025)

**利用条件:** 需要有效用户凭据才能访问Leave Request表单。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞利用代码，CVE-2025-46157 漏洞存在于 Timetrax V1 (2025) 的 Attendance 模块的 Leave Request 表单中。

**利用方式：**

1.  **远程代码执行 (RCE):** 攻击者首先需要拥有有效的用户凭据登录 Timetrax。然后，攻击者访问 Leave Request 表单，上传一个 `.txt` 文件。通过 Burp Suite 等工具拦截 HTTP 请求，并将文件扩展名从 `.txt` 修改为 `.asp`。服务器端不安全的验证允许上传 `.asp` 文件，从而实现 WebShell 的上传和执行，导致远程代码执行。

2.  **权限提升:**  成功执行 RCE 后，攻击者可以利用 EfsPotato 技术提升权限至 SYSTEM。该技术滥用 `SeImpersonatePrivilege` 权限。为了绕过反病毒软件的检测，攻击者需要对 EfsPotato 攻击的二进制文件或 payload 进行混淆。

**有效性：**

该漏洞利用代码提供了详细的利用步骤，包括 RCE 和权限提升，因此 POC 代码看起来有效。根据描述，该漏洞能够实现远程代码执行和权限提升，危害性极高。

**投毒风险：**

虽然POC描述利用了公开的EfsPotato项目，但攻击者可能在利用过程中引入恶意代码，例如在混淆payload时，可能包含隐蔽的后门或者恶意功能。POC本身主要通过描述步骤进行漏洞利用，直接在POC文档里投毒可能性较低。但是，如果参考的EfsPotato项目本身被投毒，则存在间接投毒的风险。考虑到这些因素，投毒风险评估为 10%。

**项目地址:** [morphine009/CVE-2025-46157](https://github.com/morphine009/CVE-2025-46157)

**漏洞详情:** [CVE-2025-46157](https://nvd.nist.gov/vuln/detail/CVE-2025-46157)