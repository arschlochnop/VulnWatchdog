## CVE-2024-23692 - Rejetto HTTP File Server 2.3m 远程代码执行

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入/远程代码执行

**影响应用:** Rejetto HTTP File Server

**危害等级:** 严重，允许未授权的远程代码执行

**影响版本:** <= 2.3m

**利用条件:** 目标系统运行Rejetto HFS 2.3m，且允许网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中的一个模板注入漏洞。未经身份验证的攻击者可以通过发送特制的HTTP请求来执行任意命令。漏洞利用代码通过构造包含恶意payload的GET请求，该payload利用模板引擎的特性执行操作系统命令。payload的形式为 `/?search=%25x%25url%25:%host%}{.exec|cmd.}{.break.}`，其中`cmd`是要执行的命令。检测脚本使用相同的payload，但只是验证服务是否返回200 OK，表明存在漏洞。

**有效性：** 根据漏洞描述、搜索引擎结果以及提供的漏洞利用代码，该漏洞利用代码很可能是有效的。漏洞信息明确指出存在远程代码执行漏洞，搜索引擎结果证实了这一点，漏洞利用代码也实现了构造恶意请求并执行命令的功能。

**投毒风险：** 提供的代码主要是利用漏洞执行命令，并没有发现明显的恶意代码。但仍然存在微小的风险：

*   **依赖风险：** 代码使用了标准库如socket和sys，风险较低。
*   **命令执行风险：** `cmd`参数由用户提供，如果用户不小心执行了恶意命令，可能会导致问题。但是，这不是代码本身的投毒，而是用户使用不当造成的。
*   **网络连接风险：** 虽然有超时设置，但如果目标服务器被攻陷，可能被用于DDoS等攻击。

考虑到以上因素，投毒风险评估为5%。

**利用方式：**

1.  **确定目标：** 找到运行Rejetto HTTP File Server 2.3m的目标IP地址和端口。
2.  **构造恶意请求：** 使用提供的exploit.py脚本，指定目标IP地址、端口以及要执行的命令。
3.  **发送请求：** 脚本将构造包含恶意payload的HTTP GET请求，并发送到目标服务器。
4.  **执行命令：** 如果目标服务器存在漏洞，服务器将执行payload中的命令。
5.  **验证结果：** 脚本会打印服务器的响应。如果返回“200 OK”，则表示漏洞利用可能成功。弹出计算器或者其他命令执行的反馈需要根据具体环境判断。

**项目地址:** [jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS](https://github.com/jakabakos/CVE-2024-23692-RCE-in-Rejetto-HFS)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)