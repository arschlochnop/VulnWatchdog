## CVE-2024-6387 - OpenSSH RegreSSHion 漏洞

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要目标系统运行受影响版本的OpenSSH，且攻击者能够发起大量的连接尝试。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-6387 (RegreSSHion) 是 OpenSSH 服务器 (sshd) 中的一个安全漏洞，源于 CVE-2006-5051 的回归。它是一个信号处理竞争条件，可能导致 sshd 以不安全的方式处理某些信号。未经验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发此漏洞。成功利用此漏洞可能允许远程代码执行或者导致拒绝服务攻击。

**有效性分析：**

根据漏洞信息和搜索结果，CVE-2024-6387 漏洞是真实存在的，并且存在公开的PoC代码。漏洞利用的有效性取决于目标系统是否使用受影响的OpenSSH版本（8.5p1到9.7p1）以及glibc版本。搜索结果中提到了多个PoC和利用此漏洞的 write-up，例如`https://www.offsec.com/blog/regresshion-exploit-cve-2024-6387/`。

**投毒风险分析：**

提供的漏洞利用代码是Cargo.lock文件，它是Rust项目的依赖锁定文件，用于确保构建的可重复性。`Cargo.lock` 本身不包含可执行代码，它只是记录了项目依赖项的确切版本和校验和。因此，直接从 `Cargo.lock` 文件投毒的可能性较低。但是，如果依赖关系本身的源代码存在问题，则可能存在投毒风险。由于无法确认依赖项源代码的安全性，因此假定存在较低的投毒风险，约为10%。

**利用方式分析：**

利用方式的核心在于触发sshd中的竞争条件。攻击者需要发起大量的连接请求，并故意使身份验证失败，以此来触发信号处理中的漏洞。成功利用此漏洞后，攻击者可以在目标系统上执行任意代码，或者通过耗尽系统资源来造成拒绝服务。利用成功的先决条件是大量并发的连接尝试，因此在具有良好安全配置或速率限制的系统上，利用难度较高。

**总结：**
CVE-2024-6387 漏洞是 OpenSSH 中一个严重的安全问题，可能导致远程代码执行。虽然利用难度较高，但由于存在公开的PoC代码，攻击者可以利用此漏洞攻击未及时更新的系统。建议尽快升级 OpenSSH 版本或者应用缓解措施。


**项目地址:** [wiggels/regresshion-check](https://github.com/wiggels/regresshion-check)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)