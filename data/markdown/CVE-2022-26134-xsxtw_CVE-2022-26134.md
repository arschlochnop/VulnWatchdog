## CVE-2022-26134-Confluence-OGNL注入

**漏洞编号:** CVE-2022-26134

**漏洞类型:** OGNL注入

**影响应用:** Atlassian Confluence Server/Data Center

**危害等级:** 高危，允许未授权远程代码执行

**影响版本:** 1.3.0 < Version < 7.4.17, 7.13.0 <= Version < 7.13.7, 7.14.0 <= Version < 7.14.3, 7.15.0 <= Version < 7.15.2, 7.16.0 <= Version < 7.16.4, 7.17.0 <= Version < 7.17.4, 7.18.0 <= Version < 7.18.1

**利用条件:** 目标Confluence实例版本在受影响范围内，攻击者需要能够访问Confluence服务器的网络。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-26134是一个存在于Atlassian Confluence Server和Data Center的OGNL注入漏洞。根据漏洞库信息和搜索结果，此漏洞允许未经身份验证的攻击者在Confluence服务器上执行任意代码。漏洞存在于多个版本范围中，表明这是一个影响广泛的漏洞。提供的漏洞利用代码(exploit.py)是一个Python脚本，它利用OGNL注入漏洞发送包含恶意OGNL表达式的HTTP GET请求，从而在目标服务器上执行命令。

**有效性：**
根据搜索结果，CVE-2022-26134在野外被积极利用，这意味着提供的POC代码大概率有效。

**投毒风险：**
分析了提供的exploit.py脚本，该脚本主要功能是发送包含恶意OGNL表达式的请求，并将命令执行结果从HTTP响应头中提取出来。代码结构简单，逻辑清晰，未发现明显的恶意代码或者后门。虽然任何代码都可能存在潜在的风险，但该POC代码的投毒风险较低。README.md文件只包含PoC的下载和使用方法，没有发现可疑代码。因此，评估投毒风险为1%。

**利用方式：**
1.  攻击者首先向目标Confluence服务器发送包含特殊构造的OGNL表达式的HTTP GET请求。
2.  该OGNL表达式利用`@org.apache.commons.io.IOUtils`和`@java.lang.Runtime`类执行操作系统命令。
3.  命令执行的结果被写入HTTP响应头（X-Cmd-Response）。
4.  攻击者从HTTP响应头中提取命令执行结果。
5.  该漏洞无需身份验证，因此任何能够访问Confluence服务器的攻击者都可以利用。

**项目地址:** [xsxtw/CVE-2022-26134](https://github.com/xsxtw/CVE-2022-26134)

**漏洞详情:** [CVE-2022-26134](https://nvd.nist.gov/vuln/detail/CVE-2022-26134)