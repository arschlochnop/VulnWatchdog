## CVE-2024-23692-Rejetto HTTP File Server-模板注入RCE

**漏洞编号:** CVE-2024-23692

**漏洞类型:** 模板注入RCE

**影响应用:** Rejetto HTTP File Server

**危害等级:** 高危，允许远程、未经身份验证的攻击者执行任意命令

**影响版本:** <= 2.3m

**利用条件:** 需要目标服务器运行Rejetto HTTP File Server 2.3m或更早版本，且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-23692是Rejetto HTTP File Server 2.3m版本中存在的一个模板注入漏洞。攻击者可以通过发送特制的HTTP请求，利用模板引擎的漏洞执行任意命令。根据漏洞库信息和搜索结果，该漏洞影响所有2.3m及以下版本。PoC代码通过构造包含恶意代码的URL，发送到目标服务器。URL中的`cmd=whoami`部分展示了执行命令的能力。虽然PoC主要功能是验证漏洞，但需要人工审查和小心使用以防止潜在的恶意利用. 

**有效性：** 根据漏洞库信息，搜索引擎结果和POC代码，可以确定该POC代码有效。 多个信息源都表明可以通过特制的HTTP请求执行任意命令。

**投毒风险：** 该仓库的投毒风险较低，估计为10%。主要原因：

1.  **PoC的直接性：** PoC的主要目的是验证漏洞的存在，而不是植入后门。代码功能相对简单，直接发送包含命令的HTTP请求。
2.  **命令执行：** PoC中使用的`whoami`命令用于验证，但如果将命令替换为例如下载并执行恶意脚本的命令，则可能存在风险。
3.  **依赖性：** 该PoC只依赖于requests库，没有使用其他的隐蔽的第三方依赖，降低了引入恶意代码的风险。

**利用方式：** 漏洞利用方式如下：

1.  **确定目标：** 确定目标服务器上运行着存在漏洞的Rejetto HTTP File Server版本（<=2.3m）。
2.  **构造恶意URL：**  使用类似PoC中的URL，将`cmd=whoami`替换为需要执行的系统命令。
3.  **发送HTTP请求：**  通过GET请求将构造的URL发送到目标服务器。
4.  **执行命令：**  目标服务器执行URL中指定的命令。

**项目地址:** [NingXin2002/HFS2.3_poc](https://github.com/NingXin2002/HFS2.3_poc)

**漏洞详情:** [CVE-2024-23692](https://nvd.nist.gov/vuln/detail/CVE-2024-23692)