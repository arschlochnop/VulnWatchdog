## CVE-2024-28995-SolarWinds Serv-U-目录遍历

**漏洞编号:** CVE-2024-28995

**漏洞类型:** 目录遍历

**影响应用:** SolarWinds Serv-U

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** <= 15.4.2 HF1

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-28995 是 SolarWinds Serv-U 中的一个目录遍历漏洞。未经身份验证的远程攻击者可以利用此漏洞读取主机上的敏感文件。 

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞利用的有效性较高。漏洞信息描述了目录遍历漏洞，多个搜索结果表明该漏洞易于利用，并且在野外已被利用。提供的 Python 脚本似乎是一个功能齐全的利用程序，包括版本检测和操作系统识别。

**投毒风险：**
代码中存在极低的投毒风险。代码主要功能是发送 HTTP 请求，没有发现恶意代码，比如反弹shell，植入后门等，主要为目录遍历。

**利用方式：**
1.  **漏洞原理：** 漏洞利用了 SolarWinds Serv-U 中存在的目录遍历缺陷，攻击者可以通过构造包含 "../" 等特殊字符的 URL，绕过访问限制，读取服务器上的任意文件。
2.  **攻击步骤：**
    *   发送特制的 HTTP GET 请求到 SolarWinds Serv-U 服务器。
    *   在 URL 中包含目录遍历payload，指向想要读取的文件（例如，`/../../../../windows/win.ini` 或 `/../../../../etc/passwd`）。
    *   服务器如果存在漏洞，将返回目标文件的内容。
3.  **利用代码分析：**
    *   `normalize_url(url)`: 规范化 URL，确保包含协议 (http/https)。
    *   `extract_server_version(headers)`: 从 HTTP 响应头中提取 Serv-U 的版本信息。
    *   `is_vulnerable_version(version)`: 检查检测到的版本是否易受攻击（<= 15.4.2 HF1）。
    *   `detect_os_type(content)`: 根据文件内容判断操作系统类型。
    *   `get_default_payloads()`: 用于生成目录遍历payload。

总的来说，利用方式简单，只需构造特定的 URL 即可读取文件。POC 代码的质量相对较高，考虑了多个方面，包括版本检测、操作系统识别和多种payload。


**项目地址:** [ibrahmsql/CVE-2024-28995](https://github.com/ibrahmsql/CVE-2024-28995)

**漏洞详情:** [CVE-2024-28995](https://nvd.nist.gov/vuln/detail/CVE-2024-28995)