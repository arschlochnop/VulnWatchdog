## CVE-2019-0708 (BlueKeep) RDP远程代码执行漏洞

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows Remote Desktop Services

**危害等级:** 高危，无需身份验证即可远程代码执行

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2

**利用条件:** 目标系统开启RDP服务，攻击者能够建立RDP连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，又名BlueKeep，是Microsoft Windows Remote Desktop Services中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来触发此漏洞，从而在目标系统上执行任意代码。根据漏洞库信息和搜索结果，此漏洞影响Windows 7 SP1，Windows Server 2008 R2 SP1和Windows Server 2008 SP2等版本。漏洞利用代码显示，攻击者需要替换`TARGET_IP`为目标IP地址，并且可能需要替换`SHELLCODE`为攻击者自己的shellcode。 

**有效性评估：**

根据搜索结果和漏洞库信息，CVE-2019-0708是一个严重漏洞，存在可用的POC。提供的代码片段包括Java, C++, Python, 和Ruby，表明该漏洞已被广泛研究和利用。

**投毒风险分析：**

提供的代码片段中，主要的投毒风险在于`SHELLCODE`部分。如果攻击者提供的`SHELLCODE`并非如描述那样简单地提供反向shell，而是包含恶意指令，例如删除文件、传播恶意软件或者进行拒绝服务攻击，则会构成投毒。此外，`createPacket`函数的具体实现也可能包含后门，但鉴于代码片段未提供完整实现，评估难度较高。考虑到提供的代码片段只是一个框架，需要用户自行填充shellcode和packet creation logic，因此存在潜在的投毒风险，风险评估为10%。 此仓库结构较为完整, 具有LICENSE,贡献,以及目录结构描述, 降低了投毒风险.

**利用方式分析：**

1.  **建立RDP连接：** 攻击者首先需要能够通过RDP协议连接到目标系统。
2.  **构造恶意RDP数据包：**  攻击者需要构造包含漏洞触发代码的特殊RDP数据包。根据Unit 42的报告（网页0和3），可以通过结合Refresh Rect PDU和RDPDR Client Name Request PDU来实现远程代码执行。
3.  **发送恶意数据包：**  攻击者将构造好的恶意RDP数据包发送到目标系统。
4.  **执行Shellcode：** 成功利用漏洞后，攻击者可以执行任意代码，通常是用于建立反向shell的shellcode。

总而言之，成功利用此漏洞的关键在于构造正确的RDP数据包，这需要对RDP协议有深入的了解。

**项目地址:** [adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC](https://github.com/adyanamul/Remote-Code-Execution-RCE-Exploit-BlueKeep-CVE-2019-0708-PoC)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)