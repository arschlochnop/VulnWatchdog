## CVE-2023-27372-SPIP-远程代码执行

**漏洞编号:** CVE-2023-27372

**漏洞类型:** 远程代码执行

**影响应用:** SPIP

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 4.2.1 (受影响版本还包括3.2.x, 4.0.x, 4.1.x)

**利用条件:** 需要能够通过网络访问SPIP站点，且SPIP版本低于4.2.1，未应用安全补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27372 是 SPIP 4.2.1 之前版本中的一个远程代码执行 (RCE) 漏洞。该漏洞的根本原因是程序未正确处理反序列化数据，导致攻击者可以通过构造恶意表单值，在服务器上执行任意代码。

**有效性分析：**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，可以判断该PoC代码有效。
- 漏洞库信息明确指出SPIP在4.2.1之前的版本存在RCE漏洞，并通过不安全的反序列化来实现。
- 搜索引擎结果也证实了该漏洞的存在，并提供了多个漏洞分析和利用链接。
- PoC代码通过利用`spip_pass`页面中的`oubli`参数，传递一个包含PHP代码的序列化字符串，从而执行任意命令。该代码首先获取CSRF token，然后构造包含恶意PHP代码的payload，并发送POST请求到`spip.php?page=spip_pass`。恶意PHP代码使用`system`函数执行经过base64编码的命令。

**投毒风险分析：**
仔细检查了提供的PoC代码，没有发现明显的投毒代码。该代码结构清晰，功能明确，主要用于验证和利用漏洞。风险百分比评估为0%。

**利用方式：**
1.  **漏洞定位：** 该漏洞存在于 SPIP 的前台页面，攻击者无需认证即可利用。
2.  **CSRF Token 获取：** 攻击者首先访问 `spip.php?page=spip_pass` 页面，从中提取 CSRF Token，用于绕过 CSRF 保护。
3.  **Payload 构造：** 攻击者构造一个包含恶意 PHP 代码的序列化字符串。该 PHP 代码通常使用 `system()` 函数执行任意命令。为了避免过滤，命令通常会进行 base64 编码。
4.  **漏洞触发：** 攻击者将构造好的 Payload 放入 `oubli` 参数中，通过 POST 请求发送到 `spip.php?page=spip_pass` 页面，触发反序列化漏洞，从而执行任意代码。
5.  **反弹shell:** 通过反弹shell获得目标机器的权限。


**项目地址:** [1amthebest1/CVE-2023-27372](https://github.com/1amthebest1/CVE-2023-27372)

**漏洞详情:** [CVE-2023-27372](https://nvd.nist.gov/vuln/detail/CVE-2023-27372)