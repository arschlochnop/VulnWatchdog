## CVE-2023-29489-cPanel-XSS

**漏洞编号:** CVE-2023-29489

**漏洞类型:** 跨站脚本攻击 (XSS)

**影响应用:** cPanel

**危害等级:** 中危，可能导致敏感信息泄露和会话劫持

**影响版本:** 11.109.9999.116之前版本

**利用条件:** 需要目标cPanel实例存在且版本未修复，需要能构造恶意URL并诱导用户点击。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-29489 是 cPanel 中的一个跨站脚本漏洞 (XSS)。该漏洞位于 `cpsrvd` 错误页面，攻击者可以通过提供一个包含恶意 JavaScript 代码的特制 `webcall ID` 来利用此漏洞。当用户访问包含恶意 `webcall ID` 的 URL 时，恶意 JavaScript 代码将在用户的浏览器中执行，从而可能导致会话劫持、敏感信息泄露或重定向到恶意网站。

**有效性分析：**
根据提供的漏洞信息和搜索引擎结果，此漏洞存在且被广泛报道。POC代码利用 Shodan 搜索暴露在外的 cPanel 主机，并尝试通过构造包含 JavaScript 代码的 URL 来触发 XSS。  POC代码中使用了 `requests.get(xss_url, verify=False)`，显式禁用了 SSL 证书验证，这在生产环境中是不安全的做法，但对于测试未配置有效证书的 cPanel 实例是必要的。 POC 代码通过检查响应的 HTML 中是否存在包含 `onerror` 属性的 `<img>` 标签来验证 XSS 是否成功触发。综合来看，提供的 POC 代码是有效的。

**投毒风险分析：**
审查提供的 Python 代码，没有发现明显的恶意代码或后门。代码主要功能是利用Shodan API搜索cPanel主机，并针对发现的主机尝试进行XSS漏洞验证。`SHODAN_API_KEY = 'your_shodan_api_key_here'`需要用户提供自己的Shodan API KEY，这本身就增加了一些风险，但并非作者投毒。代码中使用 `requests.get(xss_url, verify=False)` 关闭了 SSL 验证，虽然这不是一个好的安全实践，但更多的是为了方便测试，因此判定投毒风险为0%。

**利用方式：**
1.  攻击者使用 Shodan 等搜索引擎查找暴露在外的 cPanel 实例。
2.  攻击者构造一个包含恶意 JavaScript 代码的 URL，该 URL 的 `cpanelwebcall` 参数被设置为包含 XSS payload 的值，例如 ``/cpanelwebcall/<img%20src=x%20onerror="prompt(1)">aaaaaaaaaaaa`。
3.  攻击者将此 URL 发送给目标用户。
4.  如果目标用户点击了该 URL，恶意 JavaScript 代码将在用户的浏览器中执行。
5.  攻击者可以利用此 XSS 漏洞执行各种恶意操作，例如窃取用户的会话 Cookie、更改网页内容或将用户重定向到恶意网站。

**项目地址:** [tucommenceapousser/CVE-2023-29489.py](https://github.com/tucommenceapousser/CVE-2023-29489.py)

**漏洞详情:** [CVE-2023-29489](https://nvd.nist.gov/vuln/detail/CVE-2023-29489)