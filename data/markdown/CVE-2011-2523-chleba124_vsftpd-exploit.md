## CVE-2011-2523 - vsftpd 2.3.4 Backdoor Command Execution

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 2.3.4 (仅限20110630至20110703期间下载的版本)

**利用条件:** 目标系统运行着受感染的 vsftpd 2.3.4 版本，且攻击者能够建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于特定时间段内下载的 vsftpd 2.3.4 版本中，该版本包含一个后门，允许攻击者在端口 6200 上执行任意命令。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞是一个已知的后门，存在于特定时间段内下载的 vsftpd 2.3.4 版本中。POC代码尝试利用此后门，通过连接到端口6200获得shell。从提供的`main.py`来看，脚本首先构建一个ftp命令文件cmd.txt，然后尝试通过ftp连接victim_ip，绕过密码验证并触发后门，然后尝试连接6200端口。

**投毒风险：**
虽然主要功能是利用已知的后门，但仓库中仍存在一些潜在的投毒风险。`README.md`中声明该脚本在Windows上运行,但是`main.py`中使用了`os.system`调用外部命令，这存在一定的风险，因为攻击者可能会通过修改`cmd.txt`，`main.py`中的shell_payload 间接执行恶意命令。此外，脚本依赖`colorama`和`pystyle`库，虽然这些库本身不太可能包含恶意代码，但供应链攻击始终是一种潜在的风险。`requirements.txt`指定了依赖库，相对来说降低了恶意依赖库的风险。

**利用方式：**
1.  **检查目标版本：** 确保目标系统运行的是在 20110630 到 20110703 之间下载的 vsftpd 2.3.4 版本。
2.  **执行POC代码：** 下载并运行提供的 POC 代码。该代码会尝试连接到目标系统的 6200 端口，从而获得 shell 访问权限。
    *   脚本 `main.py` 使用 `cmd.txt` 文件构造 FTP 命令，尝试绕过身份验证。
    *   `cmd.txt` 包含用户名 `user:)` 和密码 `chleba124washere`，这可能是触发后门的特殊凭据。
    *   脚本尝试通过 `nc` 命令连接到目标 IP 的 6200 端口，从而获得反向 shell。

整体而言，该漏洞的利用方式相对简单，主要是利用已知的后门。然而，在实际利用过程中，需要注意目标系统的版本和配置，以及潜在的投毒风险。

**项目地址:** [chleba124/vsftpd-exploit](https://github.com/chleba124/vsftpd-exploit)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)