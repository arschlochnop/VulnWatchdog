## CVE-2024-36991 - Splunk Enterprise Windows 路径遍历

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，允许未经身份验证的攻击者读取服务器上的任意文件，可能包含敏感信息如密码、配置信息等

**影响版本:** Splunk Enterprise Windows 版本低于 9.2.2, 9.1.5, 和 9.0.10

**利用条件:** Splunk Enterprise Windows服务正在运行，且目标版本存在漏洞。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36991 是 Splunk Enterprise 在 Windows 平台上发现的路径遍历漏洞。攻击者利用该漏洞，可以通过构造特制的URL，访问`/modules/messaging/` 接口，并使用`../` 序列绕过目录限制，读取服务器上的任意文件。根据搜索结果和漏洞利用代码，攻击者可以通过发送包含恶意路径的HTTP请求到存在漏洞的 Splunk Enterprise 实例的 `/modules/messaging/` 端点来利用此漏洞。漏洞利用代码中提供了多个常见配置文件路径，包括认证文件、LDAP配置和服务器配置文件，增加了漏洞利用的成功率。 投毒风险评估为10%，主要考虑到代码中包含了多个已知splunk配置文件的路径。攻击者可能通过修改这些配置，例如authentication.conf或ldap.conf，来实现后门或权限提升。

**项目地址:** [xploitnik/CVE-2024-36991-modified](https://github.com/xploitnik/CVE-2024-36991-modified)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)