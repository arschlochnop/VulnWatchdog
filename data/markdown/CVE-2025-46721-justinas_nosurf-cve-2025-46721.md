## CVE-2025-46721-justinas/nosurf-CSRF

**漏洞编号:** CVE-2025-46721

**漏洞类型:** CSRF

**影响应用:** justinas/nosurf

**危害等级:** 中危，允许跨域请求，可能导致未经授权的状态更改

**影响版本:** < 1.2.0

**利用条件:** 需要目标网站存在允许用户控制HTML内容的区域（例如子域名），或者存在XSS漏洞

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于justinas/nosurf库中，由于对请求的同源检查不正确，攻击者可以利用此漏洞发起跨站请求伪造（CSRF）攻击。

**有效性评估：**
提供的POC代码似乎有效。它模拟了一个攻击者控制的页面（attacker.go），该页面包含一个表单，该表单将数据提交到受害者站点（target.go）。Caddyfile用于设置反向代理，以便测试可以使用HTTPS。

**投毒风险分析：**
尽管存在attacker.go, target.go 和 Caddyfile ，这些都是为了演示漏洞而存在的。其中attacker.go 模拟攻击者的行为，利用漏洞向target.go发送请求。因此，判断投毒风险较低，但代码可能存在隐藏的细微问题，因此风险评估为10%。

**利用方式：**
1.  攻击者需要找到或创建一个他们可以控制HTML内容的区域，例如受害者网站的子域名（attacker.target.localhost）。
2.  攻击者将POC中的attacker.go部署到此区域。
3.  攻击者诱骗用户访问此页面。
4.  当用户访问攻击者控制的页面时，页面上的JavaScript代码会自动向受害者站点（target.localhost）发送一个POST请求，其中包含伪造的CSRF token。
5.  由于受害者站点的同源检查不正确，此请求将被接受，从而允许攻击者以用户的身份执行未经授权的操作。

**项目地址:** [justinas/nosurf-cve-2025-46721](https://github.com/justinas/nosurf-cve-2025-46721)

**漏洞详情:** [CVE-2025-46721](https://nvd.nist.gov/vuln/detail/CVE-2025-46721)