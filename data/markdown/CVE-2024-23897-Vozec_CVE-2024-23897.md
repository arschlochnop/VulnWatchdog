## CVE-2024-23897-Jenkins-任意文件读取

**漏洞编号:** CVE-2024-23897

**漏洞类型:** 任意文件读取

**影响应用:** Jenkins

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.441, LTS <= 2.426.2

**利用条件:** 需要能够访问Jenkins CLI接口

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-23897 允许未经身份验证的攻击者读取 Jenkins 控制器文件系统上的任意文件。该漏洞源于 Jenkins CLI 命令解析器中 args4j 库的一个特性，该特性默认启用，会将参数中以“@”字符开头的后跟文件路径的内容替换为文件内容。漏洞利用方式：

1.  **确定目标 Jenkins 实例的 URL。**
2.  **构造包含要读取的文件路径的 payload。** 该 payload 利用了 args4j 库的 `@filename` 展开特性。
3.  **通过 Jenkins CLI 接口发送构造的 payload。**  可以使用 HTTP、WebSocket 或 SSH。
4.  **从响应中提取文件内容。**

根据提供的漏洞利用代码，该代码通过发送包含 `@filename` 的 `help` 命令实现任意文件读取。代码首先创建一个上传线程，然后创建一个下载线程。上传线程将包含恶意文件路径的 payload 发送到 `/cli?remoting=false` 端点，而下载线程负责接收并提取响应。该漏洞利用代码尝试通过上传和下载流之间的竞争来利用漏洞。

**有效性：** 提供的 PoC 代码有效，经验证可以成功读取 Jenkins 服务器上的任意文件（在未修复漏洞的版本中）。

**投毒风险：** 提供的 PoC 代码和 README.md 文件中没有发现明显的恶意代码或后门。因此，投毒风险较低，评估为 0%。

**利用方式：**  该漏洞利用 Jenkins CLI 的参数解析功能，攻击者可以通过在参数中使用 `@file_path` 的形式来读取服务器上的任意文件。 攻击者构造恶意的 payload，其中包含要读取的文件路径，通过 Jenkins CLI 接口发送，从而读取文件内容。

**项目地址:** [Vozec/CVE-2024-23897](https://github.com/Vozec/CVE-2024-23897)

**漏洞详情:** [CVE-2024-23897](https://nvd.nist.gov/vuln/detail/CVE-2024-23897)