## CVE-2020-9483-Apache SkyWalking-SQL注入

**漏洞编号:** CVE-2020-9483

**漏洞类型:** SQL注入

**影响应用:** Apache SkyWalking

**危害等级:** 高危，可能导致数据泄露和未授权数据访问

**影响版本:** 6.0.0 to 6.6.0, 7.0.0

**利用条件:** 需要目标系统使用H2/MySQL/TiDB作为存储，且GraphQL接口对外开放。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-9483是Apache SkyWalking 6.0.0到6.6.0以及7.0.0版本中存在的一个SQL注入漏洞。当SkyWalking使用H2/MySQL/TiDB作为存储时，通过GraphQL协议进行的元数据查询存在SQL注入风险。攻击者可以通过构造恶意的GraphQL查询语句，执行任意SQL命令，从而访问未授权的数据。 

**有效性分析：**

提供的PoC代码是有效的。它利用了GraphQL接口的SQL注入漏洞，通过构造包含恶意SQL语句的payload发送到目标服务器。PoC成功执行后，能够获取数据库版本信息，证明了漏洞的存在。

**投毒风险分析：**

PoC代码本身相对简洁，主要功能是发送GraphQL请求并提取数据库版本信息。`README.md`文件中包含一张图片链接，该图片存储在github仓库中，存在风险但是可控。综合评估，投毒的可能性较低，约为10%。

**利用方式：**

1.  **确定目标：** 确定目标Apache SkyWalking服务使用的数据库类型（H2/MySQL/TiDB）。
2.  **发送恶意GraphQL请求：** 使用PoC代码，修改目标IP地址，并发送包含SQL注入payload的GraphQL请求到`/graphql`端点。
3.  **提取敏感信息：** 成功利用漏洞后，可以执行任意SQL查询，从而提取数据库中的敏感信息，或者修改数据库内容，甚至可能通过数据库的某些特性执行系统命令。

**代码分析:**

*   **`CVE-2020-9483.py`**: 该Python脚本实现了CVE-2020-9483漏洞的PoC。
    *   使用`argparse`模块接收目标IP地址作为输入。
    *   构造包含SQL注入payload的GraphQL查询。
    *   通过`requests`库发送POST请求到目标服务器的`/graphql`端点。
    *   使用正则表达式提取响应中的数据库版本信息。

*   **`README.md`**: 包含PoC的使用说明和一张效果图。

**参考链接：**

*   [https://nvd.nist.gov/vuln/detail/cve-2020-9483](https://nvd.nist.gov/vuln/detail/cve-2020-9483)
*   [https://github.com/Neko-chanQwQ/CVE-2020-9483](https://github.com/Neko-chanQwQ/CVE-2020-9483)


**项目地址:** [Neko-chanQwQ/CVE-2020-9483](https://github.com/Neko-chanQwQ/CVE-2020-9483)

**漏洞详情:** [CVE-2020-9483](https://nvd.nist.gov/vuln/detail/CVE-2020-9483)