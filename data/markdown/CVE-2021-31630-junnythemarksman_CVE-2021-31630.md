## CVE-2021-31630-OpenPLC Webserver v3-命令注入

**漏洞编号:** CVE-2021-31630

**漏洞类型:** 命令注入

**影响应用:** OpenPLC Webserver

**危害等级:** 高危，可导致远程代码执行

**影响版本:** v3

**利用条件:** 需要目标系统开启OpenPLC Webserver v3，攻击者需要具有有效的管理员账户密码

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-31630 是 OpenPLC Webserver v3 中的一个命令注入漏洞。攻击者可以利用"Hardware Layer Code Box"组件，通过 `/hardware` 页面执行任意代码。 

**利用方式：**

1.  **身份验证：** 首先，攻击者需要使用有效的用户名和密码登录 OpenPLC Webserver v3。
2.  **上传恶意程序：** 使用提供的exploit.py脚本，该脚本首先尝试使用提供的凭据进行身份验证。成功登录后，它将包含反向 shell 命令的恶意 PLC 程序上传到服务器，这个PLC程序会被上传到programs目录中。
3.  **编译恶意程序：** 脚本接着会请求编译上传的程序。
4.  **运行PLC服务：** 脚本会启动 PLC 服务，从而触发命令注入。

该漏洞利用脚本通过修改 Fellipe Oliveira 提供的 PoC 代码实现，允许远程攻击者在 OpenPLC Webserver v3 上执行任意代码。

**投毒风险分析：**

该POC脚本本身存在一定的投毒风险，因为脚本的功能是上传并执行PLC程序，该程序的内容完全由攻击者控制。虽然目前的POC代码中没有明显的恶意行为，但攻击者可以很容易地修改`upload_data`变量，植入恶意的代码来执行任何操作，例如删除文件，修改配置等。由于该脚本需要身份验证才能利用，因此只有具有有效凭据的用户才能触发该漏洞，从而降低了投毒风险。但是，一旦凭据泄露，攻击者就可以完全控制系统。综合评估，投毒风险为10%。

**项目地址:** [junnythemarksman/CVE-2021-31630](https://github.com/junnythemarksman/CVE-2021-31630)

**漏洞详情:** [CVE-2021-31630](https://nvd.nist.gov/vuln/detail/CVE-2021-31630)