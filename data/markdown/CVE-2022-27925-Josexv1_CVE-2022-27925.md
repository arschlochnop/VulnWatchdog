## CVE-2022-27925 - Zimbra Collaboration Suite 任意文件上传导致目录遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 目录遍历/文件上传

**影响应用:** Zimbra Collaboration Suite

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Zimbra Collaboration Suite Network Edition 9.0.0 Patch 23 (及更早版本); Zimbra Collaboration Suite Network Edition 8.8.15 Patch 30 (及更早版本)

**利用条件:** 需要目标存在漏洞版本的Zimbra Collaboration Suite，且攻击者可以通过网络访问目标服务器的7071端口(默认管理员端口)。某些情况下需要绕过身份验证 (CVE-2022-37042)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中，该功能接收ZIP压缩包并从中提取文件。由于存在路径遍历漏洞，攻击者可以通过构造恶意的ZIP压缩包，将任意文件上传到服务器的任意目录。根据搜索引擎结果，早期需要管理员权限，但后续发现存在身份验证绕过漏洞（CVE-2022-37042），允许未经身份验证的攻击者利用该漏洞。提供的POC代码利用了这一漏洞，通过上传JSP webshell来实现远程代码执行。由于POC代码只包含漏洞利用逻辑，不包含任何与漏洞利用无关的恶意代码，因此投毒风险较低。该POC的有效性较高，但需要注意的是，如果目标服务器已经修复了漏洞，则利用会失败。利用方式是，首先判断目标是否为漏洞版本，然后构造包含恶意路径的ZIP文件，上传到服务器指定目录，然后访问上传的JSP webshell，执行任意命令。

POC代码分析：

*   代码通过 `-t` 参数指定目标URL，通过 `-l` 参数指定目标列表。
*   代码首先测试目标URL是否可访问。
*   然后，代码构造恶意的ZIP文件，该ZIP文件包含一个JSP webshell，并将其放置在目标服务器的 `mailboxd/webapps/zimbraAdmin/` 或者 `jetty_base/webapps/zimbraAdmin/` 目录下。
*   代码利用Zimbra的mboximport功能上传ZIP文件，触发路径遍历漏洞。
*   最后，代码尝试访问上传的JSP webshell，如果访问成功，则表示漏洞利用成功，并显示webshell的URL地址，以及执行 `uname -a` 命令的结果。

综上，该漏洞利用有效性较高，但取决于目标是否已修复。POC代码不包含明显投毒代码，因此投毒风险为0%。漏洞利用方式清晰，攻击者可以通过构造恶意的ZIP文件，上传webshell，实现远程代码执行。

**项目地址:** [Josexv1/CVE-2022-27925](https://github.com/Josexv1/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)