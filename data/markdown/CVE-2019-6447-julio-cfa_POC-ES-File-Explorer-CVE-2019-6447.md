## CVE-2019-6447 - ES File Explorer File Manager 任意文件读取/命令执行

**漏洞编号:** CVE-2019-6447

**漏洞类型:** 任意文件读取/命令执行

**影响应用:** ES File Explorer File Manager

**危害等级:** 高危，可能导致敏感信息泄露和远程命令执行

**影响版本:** <= 4.1.9.7.4

**利用条件:** 目标设备安装了受影响版本的ES File Explorer，并且与攻击者处于同一局域网内。ES File Explorer 启动后，59777端口保持开放。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于ES File Explorer File Manager应用中，攻击者可以通过向目标设备开放的59777端口发送特制的HTTP请求，读取任意文件或者执行应用。

**有效性：**
提供的PoC代码看起来有效。它使用curl命令构造HTTP POST请求，并发送包含特定命令的JSON数据到目标设备的59777端口。根据漏洞描述，该端口在应用启动后保持开放，并且接受未认证的application/json数据。

**投毒风险：**
分析提供的PoC代码，不存在明显的投毒代码。该脚本主要作用是构造特定的HTTP请求，利用ES File Explorer的漏洞执行预定义的命令。所有操作都是基于漏洞本身的能力，没有发现额外恶意功能的实现，例如上传恶意文件、修改系统配置等。

**利用方式：**
1.  **确定目标IP地址：** 攻击者需要知道目标Android设备在局域网内的IP地址。
2.  **检查端口开放：** 确认目标设备上ES File Explorer的59777端口处于开放状态。
3.  **构造HTTP请求：** 使用PoC脚本或者其他HTTP客户端，构造包含特定命令的JSON数据，发送到目标设备的59777端口。
4.  **执行命令：** ES File Explorer收到请求后，会根据JSON数据中的命令执行相应的操作，例如列出文件、启动应用等。通过`appPull`可以下载应用，可能包含敏感信息。通过命令执行可以造成更大的危害。

参考搜索引擎结果，验证了该漏洞的存在和利用方式，多个链接指向了漏洞的详细描述和PoC代码。

综上所述，该漏洞利用的有效性高，不存在明显的投毒风险，利用方式相对简单，攻击者可以通过构造特定的HTTP请求来读取文件或执行命令。

**项目地址:** [julio-cfa/POC-ES-File-Explorer-CVE-2019-6447](https://github.com/julio-cfa/POC-ES-File-Explorer-CVE-2019-6447)

**漏洞详情:** [CVE-2019-6447](https://nvd.nist.gov/vuln/detail/CVE-2019-6447)