## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致数据泄露、权限提升和服务器控制

**影响版本:** <= 2.2.9

**利用条件:** 需要目标CMS Made Simple实例的URL，News模块启用，以及可以访问该URL的网络环境

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053是CMS Made Simple 2.2.9及更早版本中News模块的一个未经身份验证的盲注时间型SQL注入漏洞。攻击者可以通过构造恶意的URL，特别是`m1_idlist`参数，来执行SQL注入。该漏洞是时间型的，意味着攻击者通过观察服务器响应时间来推断SQL查询的结果。PoC利用代码通过二分法逐字符地提取数据库信息，例如salt，password和username。利用方式如下：

1.  **漏洞定位:** 该漏洞存在于News模块的`moduleinterface.php`文件的`m1_idlist`参数中。
2.  **攻击向量:** 攻击者构造包含`sleep()`函数的SQL查询语句，并将其注入到`m1_idlist`参数中。例如：`...&m1_idlist=a,b,1,5))+and+(select+sleep(3)+from+cms_users+where+username+like+0x6125+and+user_id+like+0x31)+--+`。
3.  **时间盲注:** 通过比较服务器响应时间与预设的阈值（TIME变量），攻击者可以判断SQL查询是否成功执行了`sleep()`函数。如果响应时间超过阈值，则表示条件为真，反之则为假。
4.  **数据提取:** 攻击者可以使用时间盲注技术，逐字符地提取数据库中的敏感信息，如用户名、密码盐值和密码哈希。
5.  **密码破解（可选）:** PoC代码包含一个可选的密码破解功能，可以使用提供的字典文件来破解管理员密码。

**关于投毒风险：**

PoC代码本身实现了漏洞利用的功能，并未发现明显的恶意代码或者后门。 但需要注意的是，使用第三方提供的代码始终存在潜在风险。 风险点如下:
*   **依赖项风险:** 代码依赖于`requests`和`termcolor`库，如果这些库本身被篡改，可能会引入恶意代码。
*   **执行环境风险:** 在不受信任的环境中执行PoC代码，可能会导致信息泄露或者被恶意利用。例如，如果攻击者修改了PoC代码，使其在提取数据库信息的同时，将这些信息发送到远程服务器，那么即使PoC代码本身没有后门，也会造成安全风险。
*   **隐蔽性风险：** 作者有可能在代码中加入不易察觉的恶意逻辑，例如，在特定条件下执行额外的操作，或者在提取数据的过程中留下后门。尽管PoC代码中没有明显的恶意代码，但仍然建议仔细审查代码，并在隔离环境中运行，以降低潜在的投毒风险。

**有效性评估：**

根据漏洞描述和PoC代码，该漏洞利用的有效性较高。PoC代码已经实现了未经身份验证的SQL注入，并且可以提取数据库中的敏感信息。公开的漏洞信息和搜索引擎结果也表明该漏洞真实存在。

综上所述，该漏洞利用的有效性较高，但使用PoC代码时需要注意潜在的投毒风险。

**项目地址:** [Jason-Siu/CVE-2019-9053-Exploit-in-Python-3](https://github.com/Jason-Siu/CVE-2019-9053-Exploit-in-Python-3)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)