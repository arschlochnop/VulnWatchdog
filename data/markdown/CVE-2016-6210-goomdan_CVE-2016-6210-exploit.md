## CVE-2016-6210-OpenSSH用户名枚举

**漏洞编号:** CVE-2016-6210

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 低危，泄露用户名信息

**影响版本:** < 7.3

**利用条件:** 需要目标主机开启SSH服务，且配置为使用SHA256或SHA512进行用户密码哈希。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-6210漏洞允许攻击者通过分析OpenSSH服务器对无效用户名和有效用户名的响应时间差异来枚举用户名。当使用SHA256或SHA512进行用户密码哈希时，对于不存在的用户名，OpenSSH会使用BLOWFISH算法对静态密码进行哈希处理。攻击者发送一个超长密码尝试登录不同的用户名，然后通过测量响应时间来判断用户是否存在。有效用户的响应时间会比无效用户稍长。提供的PoC代码 `exploit_6210.py` 利用了这一时间差异，通过发送大量用户名并测量响应时间来枚举用户。

**有效性：**
根据漏洞描述和PoC代码，该漏洞利用是有效的。PoC通过修改Eddie Harari的代码实现了用户名枚举。

**投毒风险：**
分析PoC代码，主要功能是发送SSH请求并计时，没有发现明显的恶意代码，例如文件操作、反弹shell等。`cveCode.py` 文件头部注释声明代码基于Eddie Harari的公开代码修改。风险点在于，攻击脚本依赖于目标服务器的时间响应差异，这种差异可能受到网络状况、服务器负载等因素影响，导致结果不准确。此外，脚本使用 `paramiko.util.log_to_file("filename.log")` 记录日志，虽然本身不是恶意行为，但在未授权渗透测试中可能会留下痕迹，需要谨慎处理。同时需要用户提供用户名列表，存在被钓鱼的风险。
总体判断投毒风险较低，大约为 10%。

**利用方式：**
1.  攻击者运行 `exploit_6210.py` 脚本，指定目标SSH服务器IP地址。
2.  脚本会从指定的用户名列表（或默认列表）中读取用户名。
3.  对于每个用户名，脚本会构造一个超长密码，并尝试使用该用户名和密码登录SSH服务器。
4.  脚本记录SSH服务器的响应时间。
5.  脚本对每个用户名进行多次尝试，并计算平均响应时间。
6.  如果平均响应时间超过设定的阈值（`-a ALERT`），则认为该用户名存在，并输出该用户名。
7.  脚本还可以尝试在用户名后添加邮箱后缀（`-e EMAIL`），以增加枚举范围。

利用此漏洞的目的是获取目标系统上存在的用户名列表，这些信息可以被用于后续的攻击，例如密码破解。


**项目地址:** [goomdan/CVE-2016-6210-exploit](https://github.com/goomdan/CVE-2016-6210-exploit)

**漏洞详情:** [CVE-2016-6210](https://nvd.nist.gov/vuln/detail/CVE-2016-6210)