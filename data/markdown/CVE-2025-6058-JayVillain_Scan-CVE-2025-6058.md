## CVE-2025-6058 - WPBookit Unauthenticated Arbitrary File Upload

**漏洞编号:** CVE-2025-6058

**漏洞类型:** 任意文件上传

**影响应用:** WPBookit WordPress 插件

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.0.4

**利用条件:** 目标 WordPress 站点安装了 WPBookit 插件，且版本小于等于 1.0.4，无需认证即可访问相关接口。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-6058 是 WPBookit WordPress 插件中的一个任意文件上传漏洞。该漏洞位于 `image_upload_handle()` 函数，该函数通过 `add_booking_type` 路由调用。由于缺少文件类型验证，未经身份验证的攻击者可以上传任意文件到受影响的服务器，从而可能导致远程代码执行。

**利用方式：**

1.  **漏洞定位：** 漏洞存在于 `wpbookit/core/admin/classes/controllers/class.wpb-booking-type-controller.php` 文件的 `image_upload_handle()` 函数中。
2.  **请求构造：**  攻击者可以构造一个 POST 请求到 `add_booking_type` 路由，其中包含恶意文件。由于缺乏验证，服务器将接受并保存该文件。
3.  **文件上传：** 上传包含恶意代码的文件，例如 PHP webshell。
4.  **远程代码执行：**  通过访问上传的文件，攻击者可以在服务器上执行任意代码。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本 (`mass_scan_wpbookit.py`)，用于批量检测目标站点是否存在 WPBookit 插件，并判断其版本是否小于等于 1.0.4。该脚本通过访问 `README.txt` 文件来获取插件版本信息，并与 `VERSION_THRESHOLD` (1.0.4) 进行比较。

**投毒风险分析：**

该脚本的主要功能是版本检测，并未直接利用文件上传漏洞。仔细检查脚本，发现以下潜在风险点：

*   **User-Agent:** 脚本使用了自定义的 User-Agent (`Mozilla/5.0 mass-scanner`)，可能被服务器记录并用于识别扫描行为。
*   **错误处理：** 脚本在处理异常时简单地将错误信息记录到 `error` 字段中，可能泄露敏感信息。
*   **依赖风险：** 脚本依赖 `requests` 库，如果该库本身存在漏洞，可能导致安全问题。

虽然存在上述风险点，但脚本本身并未发现明显的恶意代码。由于脚本的主要功能是检测漏洞是否存在，而非利用漏洞，因此判定投毒风险较低, 估计为 5%。

**结论：**

该漏洞利用方式简单，危害性高。POC 代码可用于快速识别受影响的站点。建议及时更新 WPBookit 插件到最新版本。

**项目地址:** [JayVillain/Scan-CVE-2025-6058](https://github.com/JayVillain/Scan-CVE-2025-6058)

**漏洞详情:** [CVE-2025-6058](https://nvd.nist.gov/vuln/detail/CVE-2025-6058)