## CVE-2025-48129 - WordPress Spreadsheet Price Changer Plugin Privilege Escalation

**漏洞编号:** CVE-2025-48129

**漏洞类型:** 权限提升

**影响应用:** Spreadsheet Price Changer for WooCommerce and WP E-commerce – Light

**危害等级:** 高危，可能导致未经授权的管理员访问和控制网站

**影响版本:** <= 2.4.37

**利用条件:** 目标WordPress站点安装了受影响版本的插件，且可以访问wp-admin/admin-ajax.php

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据提供的漏洞信息和漏洞利用代码，CVE-2025-48129存在于 WordPress Spreadsheet Price Changer 插件中，允许未经身份验证的攻击者提升权限。漏洞利用代码通过构造特定的 POST 请求到 `wp-admin/admin-ajax.php`，利用 `sellingcommander-endpoint` action，来创建一个新的管理员账户或重置现有账户密码。脚本首先检查插件版本，如果版本小于等于 2.4.37，则执行漏洞利用。利用方式是通过发送包含 email 和 password（md5哈希） 的payload到目标服务器。成功利用后，攻击者可以使用新创建或重置的管理员账户登录 WordPress 后台。

**有效性：**
提供的POC代码看起来有效，因为它利用了已知的漏洞并且包含版本检查逻辑。

**投毒风险：**
代码的投毒风险较低，约为10%。主要风险点在于`consumer_secret`的值是硬编码的`xyz`，这可能是一个后门，允许作者在知道`scemail`和`consumer_key`(password哈希)的情况下进行未授权访问，但这个后门是验证流程的一部分，如果密码足够复杂，这个风险可以忽略。另外，检查了`requests.post`请求的目标地址和传递的数据，没有发现任何可疑的地址或参数，因此没有发现明显的恶意代码。

**利用方式：**
1.  脚本接收目标 WordPress 站点 URL，新管理员账户的邮箱地址和密码作为参数。
2.  格式化 URL，并检查目标站点是否安装了 Spreadsheet Price Changer 插件，并检查插件版本是否小于等于 2.4.37。
3.  如果插件版本在受影响范围内，脚本计算密码的 MD5 哈希值，并构造 POST 请求发送到 `wp-admin/admin-ajax.php`，其中包含邮箱地址、密码哈希值和硬编码的 consumer_secret。
4.  如果请求成功，脚本会输出新管理员账户的用户名和密码哈希值，并提示攻击者使用这些凭据登录 WordPress 后台。如果登录失败，脚本会提供密码重置链接。

**项目地址:** [Nxploited/CVE-2025-48129](https://github.com/Nxploited/CVE-2025-48129)

**漏洞详情:** [CVE-2025-48129](https://nvd.nist.gov/vuln/detail/CVE-2025-48129)