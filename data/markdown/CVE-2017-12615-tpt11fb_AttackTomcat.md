## CVE-2017-12615-Apache Tomcat-远程代码执行

**漏洞编号:** CVE-2017-12615

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 7.0.0 to 7.0.79

**利用条件:** Windows平台，HTTP PUTs enabled (readonly 参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2017-12615 允许攻击者通过上传恶意的 JSP 文件到存在漏洞的 Tomcat 服务器上，从而执行任意代码。漏洞的利用需要满足以下条件：

1.  Tomcat 运行在 Windows 操作系统上。
2.  Tomcat 版本在 7.0.0 到 7.0.79 之间。
3.  HTTP PUT 方法被启用 (通常通过设置 `readonly` 初始化参数为 `false`)。

**有效性评估：**

根据漏洞库信息和搜索结果，此漏洞已公开披露且存在可用的 PoC 代码（如 Exploit-DB 42953）。搜索结果中也明确指出存在公开可用的漏洞利用程序，并且已经被广泛利用，因此该漏洞利用的有效性较高。

根据提供的代码，AttackTomcat工具包含了CVE-2017-12615的PUT文件上传漏洞检测功能。

**投毒风险分析：**

提供的 `AttackTomcat` 工具代码主要包含以下功能：

*   CVE-2017-12615 PUT 文件上传漏洞检测
*   Tomcat 弱口令爆破
*   CVE-2020-1938 Tomcat 文件读取/包含
*   弱认证部署 war 包

分析代码后，`AttackTomcat` 工具本身是一个漏洞利用框架，旨在帮助安全研究人员和渗透测试人员进行漏洞验证和利用。虽然工具本身不包含明显的恶意代码，但是所有工具都存在被滥用的风险。由于该工具能够自动检测并利用多个 Tomcat 漏洞，攻击者可以利用该工具快速扫描并攻击大量 Tomcat 服务器。风险评估，`AttackTomcat`工具包含投毒的可能性为20%。

**利用方式：**

1.  **检查环境:** 确保目标 Tomcat 服务器满足漏洞利用的条件 (Windows, 7.0.0-7.0.79, PUT enabled)。
2.  **上传 JSP 文件:** 使用 HTTP PUT 方法上传包含恶意代码的 JSP 文件到服务器。利用`.jsp.`绕过上传限制。
3.  **执行代码:** 通过访问上传的 JSP 文件，触发服务器执行恶意代码。
4.  **利用AttackTomcat工具：**使用该工具检测并利用漏洞，可自动化上传和执行JSP文件。

**项目地址:** [tpt11fb/AttackTomcat](https://github.com/tpt11fb/AttackTomcat)

**漏洞详情:** [CVE-2017-12615](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)