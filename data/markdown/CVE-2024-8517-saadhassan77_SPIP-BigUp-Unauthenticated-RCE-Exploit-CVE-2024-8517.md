## CVE-2024-8517 - SPIP BigUp Multipart File Upload OS Command Injection

**漏洞编号:** CVE-2024-8517

**漏洞类型:** 命令注入

**影响应用:** SPIP

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 4.3.1, <= 4.2.15, <= 4.1.17

**利用条件:** 需要目标系统运行受影响的SPIP版本，且存在 BigUp 插件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞是SPIP CMS BigUp插件中的一个未经身份验证的远程代码执行漏洞（CVE-2024-8517）。攻击者可以通过发送特制的multipart文件上传HTTP请求，在服务器上执行任意操作系统命令。漏洞存在于 `lister_fichiers_par_champs` 函数中，该函数未能正确验证输入，当 `bigup_retrouver_fichiers` 参数设置为 `1` 时，允许攻击者上传恶意PHP payload。

**利用方式：**

1.  攻击者发送一个特制的multipart文件上传请求到存在漏洞的SPIP站点。
2.  该请求包含恶意的PHP代码，该代码将被写入到服务器上的一个可访问的位置。
3.  攻击者通过构造的URL访问上传的PHP文件，执行其中的恶意代码。

**有效性：**

根据提供的漏洞信息，POC代码的存在以及搜索引擎的结果，该漏洞利用是有效的。 POC 代码针对在受限环境中运行，仅使用标准 Python 库，无需安装额外的库。

**投毒风险：**

检查提供的 `exploit.py` 脚本，没有发现明显的恶意代码。该脚本主要用于上传Webshell执行命令。 `LICENSE` 文件声明使用MIT许可证，较为宽松，降低了作者恶意投毒的可能性。 `Readme.md` 清晰地描述了漏洞和利用方法。 综上所述，投毒风险较低。因此，投毒风险评估为0%。

**项目地址:** [saadhassan77/SPIP-BigUp-Unauthenticated-RCE-Exploit-CVE-2024-8517](https://github.com/saadhassan77/SPIP-BigUp-Unauthenticated-RCE-Exploit-CVE-2024-8517)

**漏洞详情:** [CVE-2024-8517](https://nvd.nist.gov/vuln/detail/CVE-2024-8517)