## CVE-2024-4956 - Sonatype Nexus Repository 3 Path Traversal

**漏洞编号:** CVE-2024-4956

**漏洞类型:** 路径遍历

**影响应用:** Sonatype Nexus Repository Manager 3

**危害等级:** 高危，可读取任意系统文件

**影响版本:** <= 3.68.0

**利用条件:** 无需认证，需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-4956 是 Sonatype Nexus Repository Manager 3 中的一个路径遍历漏洞。未经身份验证的攻击者可以通过构造包含目录遍历序列（例如 `../`）的恶意 URL，读取服务器上的任意文件。 

**有效性：**

根据漏洞信息、搜索结果和提供的漏洞利用代码，可以判断该漏洞利用是有效的。NVD、Broadcom、INCIBE-CERT、Acunetix 等多个来源均确认了该漏洞的存在，并指出未经身份验证的攻击者可以读取系统文件。提供的 YAML 格式的 Nuclei 模板和 PoC 显示了如何利用该漏洞读取 `/etc/passwd` 文件。这些信息都证明了该漏洞利用的有效性。

**投毒风险：**

分析提供的 `CVE-2024-4956.yaml` 和 `README.md` 文件，发现存在投毒代码的可能性较低。Nuclei 模板的功能是发送包含目录遍历序列的 HTTP GET 请求，并根据响应状态码和响应体内容判断漏洞是否存在。该模板本身不包含任何恶意代码。README 文件提供了漏洞的描述、受影响版本、缓解措施和 PoC。整个仓库的主要目的是提供一个漏洞验证工具，而不是传播恶意软件。但是不排除作者在其他版本中加入恶意代码, 故给出5%的投毒概率.

**利用方式：**

该漏洞的利用方式是：

1.  攻击者构造包含目录遍历序列的恶意 URL，例如：`{{BaseURL}}/%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2f../etc/passwd`。
2.  攻击者向目标 Nexus Repository Manager 3 服务器发送 HTTP GET 请求，请求该恶意 URL。
3.  如果服务器存在漏洞，则会返回 `/etc/passwd` 文件的内容，攻击者从而读取到敏感信息。

**项目地址:** [erickfernandox/CVE-2024-4956](https://github.com/erickfernandox/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)