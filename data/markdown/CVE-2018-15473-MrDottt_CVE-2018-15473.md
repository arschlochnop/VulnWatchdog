## CVE-2018-15473 OpenSSH用户名枚举漏洞

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可为后续攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问SSH服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-15473是OpenSSH 7.7及之前版本中的一个用户名枚举漏洞。由于OpenSSH在完全解析包含请求的数据包之前不会延迟无效认证用户的退出，攻击者可以通过观察认证时间的差异来判断用户名是否存在。

**有效性：**
提供的POC代码 `sshuserenumeration.py` 旨在利用CVE-2018-15473漏洞进行用户名枚举。它通过尝试使用不同的用户名连接SSH服务器，并测量连接尝试所需的时间。通过比较已知无效用户名和潜在有效用户名的响应时间，可以推断用户名是否存在。

**投毒风险：**
通过对POC代码的分析，没有发现明显的恶意或隐藏代码。该脚本主要依赖于`paramiko`库来进行SSH连接，并且其核心逻辑是基于时间差分析。因此，投毒风险较低，判断风险百分比为0%。需要注意的是，使用此脚本进行未经授权的扫描行为仍然是非法的。

**利用方式：**
1.  **安装依赖:** 使用 `pip` 安装脚本所需的 `paramiko`, `property`, 和 `numpy` 库。
2.  **运行脚本:** 使用提供的命令行参数，例如 `-u` 指定单个用户名，或 `--userlist` 指定包含用户名列表的文件。
3.  **分析结果:** 脚本会尝试使用每个用户名连接目标SSH服务器，并根据响应时间判断用户名是否存在。存在的用户名会被标记出来。

**漏洞利用流程:**
1.  攻击者使用该脚本，指定目标SSH服务器地址和用户名列表。
2.  脚本对每个用户名执行SSH连接尝试。
3.  脚本测量每个连接尝试的响应时间。
4.  脚本将响应时间与基线时间进行比较，以确定用户名是否存在。
5.  攻击者可以利用枚举出的用户名进行后续的密码爆破或其他攻击。

**项目地址:** [MrDottt/CVE-2018-15473](https://github.com/MrDottt/CVE-2018-15473)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)