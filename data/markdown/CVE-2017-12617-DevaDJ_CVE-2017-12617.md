## CVE-2017-12617-Apache Tomcat-RCE

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** HTTP PUTs 启用 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 是 Apache Tomcat 中的一个远程代码执行漏洞。如果 Tomcat 服务器配置允许使用 HTTP PUT 方法（例如，`readonly` 初始化参数设置为 `false`），攻击者可以上传包含恶意代码的 JSP 文件到服务器。然后，通过请求该 JSP 文件，服务器将执行其中的恶意代码，从而导致远程代码执行。

**有效性：**
根据漏洞信息和搜索结果，该漏洞真实存在且已公开利用。提供的 POC 代码旨在验证漏洞的存在，通过上传包含特定字符串的 JSP 文件，然后检查服务器是否能返回该字符串来确认漏洞。

**投毒风险：**
POC 代码中存在一定投毒风险。虽然主要功能是验证漏洞，但也包含直接上传 JSP Webshell 的功能， 如果用户直接使用此代码，容易因为修改不当引入新的安全问题。因此，判定投毒风险为10%。

**利用方式：**
1.  **前提条件：** 目标 Tomcat 服务器运行受影响的版本，并且启用了 HTTP PUT 方法（`readonly` 参数设置为 `false`）。
2.  **JSP 文件上传：** 攻击者使用 PUT 请求上传一个包含恶意代码的 JSP 文件。例如，可以使用如下请求：
    ```
    PUT /path/to/evil.jsp/ HTTP/1.1
    Content-Type: text/plain
    ... 其他头部 ...

    <% out.println("AAAAAAAAAAAAAAAAAAAAAAAAAAAAA"); %>
    ```
3.  **代码执行：** 攻击者通过访问上传的 JSP 文件（例如，`http://target/path/to/evil.jsp`）来触发恶意代码的执行。
4.  **远程控制：** 上传的 JSP 文件可以包含执行系统命令的代码，从而允许攻击者控制服务器。

POC代码包含了上传webshell 的功能， 使用户可以更方便的进行远程控制。


**项目地址:** [DevaDJ/CVE-2017-12617](https://github.com/DevaDJ/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)