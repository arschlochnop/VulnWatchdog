## CVE-2015-1635

**漏洞编号:** CVE-2015-1635

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft HTTP.sys

**危害等级:** 高危，允许远程攻击者在系统帐户的上下文中执行任意代码

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows 8, Windows 8.1, and Windows Server 2012 Gold and R2

**利用条件:** 需要目标系统存在漏洞且未打补丁, 网络可达

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2015-1635是一个存在于Microsoft Windows HTTP.sys中的远程代码执行漏洞。该漏洞是由于HTTP.sys未能正确解析特制的HTTP请求造成的。攻击者可以通过发送包含特制Range头的HTTP请求来触发此漏洞，如果目标系统未打补丁，攻击者即可在系统帐户上下文中执行任意代码。

**有效性：**

根据漏洞库信息和提供的POC代码，可以判断该漏洞是真实存在的，且POC代码能够检测目标系统是否存在此漏洞。POC代码通过发送包含恶意Range头的HTTP请求，如果服务器返回"Requested Range Not Satisfiable"，则表明服务器可能存在漏洞。

**投毒风险：**

查看提供的POC代码`MS15-034.py`， 代码本身主要是构造特定的HTTP请求来触发漏洞。检查了代码中的所有导入库（socket, random, getopt, sys），均为常用库，没有发现恶意行为。 此外，脚本逻辑简单，目的是为了检测漏洞是否存在，而不是直接执行恶意代码。因此，代码本身的投毒风险较低，可以忽略不计。但是，在使用任何第三方代码时，都应该谨慎，并进行代码审计。

**利用方式：**

1.  攻击者构造包含恶意Range头的HTTP请求，例如`Range: bytes=0-18446744073709551615`。
2.  将该请求发送到目标服务器的HTTP.sys服务。
3.  如果服务器存在漏洞且未打补丁，HTTP.sys在处理该请求时会发生错误，可能导致远程代码执行。
4.  攻击者可以在系统帐户的上下文中执行任意代码，从而完全控制受影响的系统。

POC提供的利用方式是验证漏洞的存在，而非直接利用，要实现RCE还需要其他步骤和代码。

**项目地址:** [Zx7ffa4512-Python/Project-CVE-2015-1635](https://github.com/Zx7ffa4512-Python/Project-CVE-2015-1635)

**漏洞详情:** [CVE-2015-1635](https://nvd.nist.gov/vuln/detail/CVE-2015-1635)