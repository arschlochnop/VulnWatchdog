## CVE-2018-10933-libssh-Authentication Bypass

**漏洞编号:** CVE-2018-10933

**漏洞类型:** 认证绕过

**影响应用:** libssh

**危害等级:** 高危，可能导致未授权访问和控制

**影响版本:** 0.6 - 0.7.5, 0.8 - 0.8.3

**利用条件:** 目标服务器运行受影响的libssh版本且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2018-10933是libssh服务器端状态机中存在的一个认证绕过漏洞。攻击者可以通过向服务器发送SSH2_MSG_USERAUTH_SUCCESS消息，而无需事先进行身份验证，即可创建通道并执行任意操作。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞存在于libssh 0.6至0.7.5和0.8至0.8.3版本中。Exploit-DB上存在公开的PoC代码（https://www.exploit-db.com/exploits/45638/），证明该漏洞是可利用的。搜索结果中也提到，攻击者可以绕过身份验证创建通道。

**投毒风险：**
提供的代码片段是一个GNU通用公共许可证。这本身并不是漏洞利用代码，而是软件许可协议。因此，在该文件中不存在投毒代码。但是通常漏洞利用代码会从不安全的代码托管平台下载，需要确认利用代码本身的安全性。因此该文件中投毒风险很低。

**利用方式：**
1.  攻击者与目标服务器建立SSH连接。
2.  攻击者发送SSH2_MSG_USERAUTH_SUCCESS消息，伪装成已通过身份验证的用户。
3.  如果服务器存在漏洞，则会错误地将攻击者视为已通过身份验证，并允许其创建通道。
4.  攻击者可以使用创建的通道执行未经授权的操作，例如执行命令或访问敏感数据。
根据Rapid7的描述，受影响的服务器将接受SSH2_MSG_USERAUTH_SUCCESS消息，即使客户端尚未通过任何身份验证方法进行身份验证。这使得未经身份验证的攻击者可以执行任意命令。

**项目地址:** [Bifrozt/CVE-2018-10933](https://github.com/Bifrozt/CVE-2018-10933)

**漏洞详情:** [CVE-2018-10933](https://nvd.nist.gov/vuln/detail/CVE-2018-10933)