## CVE-2025-24071 Microsoft Windows File Explorer Spoofing Vulnerability

**漏洞编号:** CVE-2025-24071

**漏洞类型:** 信息泄露/NTLM Hash Capture

**影响应用:** Windows File Explorer

**危害等级:** 中危，可能导致凭据泄露和进一步的横向移动

**影响版本:** 受影响的Windows版本（见漏洞库信息）

**利用条件:** 需要受害者提取恶意制作的ZIP/RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和搜索结果，CVE-2025-24071是一个Windows文件资源管理器欺骗漏洞，允许攻击者通过网络捕获NTLM凭据。PoC代码通过创建一个包含指向攻击者控制的SMB共享的`.library-ms`文件，然后将其打包到ZIP文件中来实现。当受害者提取ZIP文件时，文件资源管理器会自动尝试访问SMB共享，从而导致受害者的NTLM哈希被发送到攻击者的服务器。有效性分析：PoC代码有效，因为`.library-ms`文件被提取就会触发SMB身份验证请求。投毒风险分析：PoC代码本身相对简单，主要用于演示漏洞。投毒代码风险较低（10%），但仍存在可能。例如，攻击者可能在`poc.py`中添加额外的功能，如反向shell或数据收集，或者修改`.library-ms`文件内容，使其在受害者系统上执行恶意操作（尽管这需要额外的利用链）。但当前代码来看，主要目的在于 NTLM hash 泄漏，暂未发现明显恶意行为。

利用方式：

1.  攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的SMB共享的URL（如`\\attacker-ip\shared`）。
2.  将此`.library-ms`文件打包到一个ZIP文件中。
3.  诱骗受害者下载并提取此ZIP文件。
4.  一旦受害者提取ZIP文件，Windows文件资源管理器将自动尝试访问`.library-ms`文件中指定的SMB共享。
5.  此尝试将导致受害者的NTLM哈希被发送到攻击者的服务器。
6.  攻击者可以使用这些NTLM哈希进行离线破解或中继攻击。

**项目地址:** [Royall-Researchers/CVE-2025-24071](https://github.com/Royall-Researchers/CVE-2025-24071)

**漏洞详情:** [CVE-2025-24071](https://nvd.nist.gov/vuln/detail/CVE-2025-24071)