## CVE-2025-59287 - Windows Server Update Service (WSUS) Remote Code Execution

**漏洞编号:** CVE-2025-59287

**漏洞类型:** 远程代码执行

**影响应用:** Windows Server Update Service (WSUS)

**危害等级:** 严重，允许未经授权的攻击者通过网络执行代码

**影响版本:** 受影响的Windows Server版本请参考漏洞库信息中的CPE匹配。

**利用条件:** 目标服务器必须运行受影响的WSUS版本，且攻击者需要能够访问WSUS服务器的网络。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-59287是一个Windows Server Update Service (WSUS)中的远程代码执行漏洞。该漏洞是由于WSUS中存在对不受信任数据进行反序列化造成的，允许未经授权的攻击者通过网络发送特制的请求来执行任意代码。\n\n**利用方式：**\n
1.  **确定目标WSUS服务器：** 首先需要确定目标WSUS服务器的地址。\n2.  **探测端点：** 使用`probe_endpoints`函数探测目标服务器上可用的WSUS端点，如`/ClientWebService/Client.asmx`, `/SimpleAuthWebService/SimpleAuth.asmx`, 和 `/ReportingWebService/ReportingWebService.asmx`。\n3.  **获取Server ID：** 使用`get_server_id`函数从ReportingWebService获取ServerId，如果获取失败，则使用随机生成的UUID作为ServerId。\n4.  **获取授权Cookie：**  使用`get_auth_cookie`函数从SimpleAuthWebService获取授权Cookie。该Cookie用于后续的身份验证。\n5.  **构造恶意SOAP请求：**  利用XML反序列化漏洞，构造包含恶意payload的SOAP请求发送到WSUS服务器。具体payload的构造细节需要根据WSUS使用的具体反序列化库来确定，但总体思路是在XML中嵌入可执行代码或命令。\n6.  **发送请求并执行代码：** 将构造好的SOAP请求发送到易受攻击的WSUS端点，例如ClientWebService。如果利用成功，服务器将反序列化恶意XML，从而执行攻击者嵌入的任意代码。\n\n**有效性：**\n从提供的POC代码来看，该代码尝试自动化利用CVE-2025-59287漏洞的过程，包含探测端点、获取认证信息以及构建恶意请求的初步框架。由于缺少构造恶意XML payload的具体反序列化细节，因此该代码的有效性取决于能否成功构造出合适的payload。考虑到CISA ADP Vulnrichment将该漏洞标记为 "poc" 和 "Automatable: yes"，以及"Technical Impact: total"，表明存在可用的POC和自动化利用的可能性。\n\n**投毒风险：**\n该POC代码本身存在一定的投毒风险，例如，攻击者可能在POC中加入后门代码，以便在目标系统上安装恶意软件。虽然代码中没有发现明显的恶意行为，但仍需谨慎审查所有外部代码。 投毒风险评估为10%是基于以下考虑：代码主要功能是漏洞利用，虽然存在被恶意修改的可能性，但作者的主要目的是展示漏洞利用，而不是隐藏恶意代码。

**项目地址:** [FurkanKAYAPINAR/CVE-2025-59287](https://github.com/FurkanKAYAPINAR/CVE-2025-59287)

**漏洞详情:** [CVE-2025-59287](https://nvd.nist.gov/vuln/detail/CVE-2025-59287)