## CVE-2025-8088 WinRAR Path Traversal

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，可能导致任意代码执行

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088 是一个 WinRAR 的路径遍历漏洞，攻击者可以通过构造恶意的 RAR 压缩文件，当用户使用存在漏洞的 WinRAR 版本解压该文件时，恶意文件会被释放到任意目录，包括 Windows 启动目录，从而实现任意代码执行。 

**利用方式：**

1.  攻击者构造恶意的RAR文件，其中包含带有路径遍历的文件条目（例如：`..\..\..\Windows\Startup\payload.exe`）。
2.  该RAR文件通常会伪装成正常文件，通过社会工程学等方式诱导用户下载并解压。
3.  用户使用 WinRAR 解压该恶意 RAR 文件。
4.  WinRAR 在解压过程中，由于路径遍历漏洞，会将文件释放到构造的恶意路径。
5.  如果恶意路径指向启动目录，则payload.exe会在系统启动时自动执行。

**有效性：**

根据漏洞信息和搜索结果，该漏洞已被在野利用，PoC 代码也提供了利用该漏洞的工具，因此该漏洞的有效性较高。

**投毒风险分析：**

提供的 PoC 代码主要用于创建恶意 RAR 压缩文件，其中利用了 NTFS 备用数据流 (ADS) 和 RAR5 头部操作来隐藏 payload 并注入路径。虽然代码本身看起来是为了方便利用该漏洞，但仍存在一定的投毒风险。

*   **对WinRAR路径的依赖:** `_find_winrar`尝试查找`rar.exe`,恶意代码可能会将非预期的路径设置到该变量，虽然概率很小，但是恶意篡改该路径后,可能会执行其他非预期的程序。
*   **GUI依赖和风险:** `gui.py`和`customtkinter`的依赖虽然方便使用者,但同时也为恶意代码的隐藏提供了入口。例如在图片资源中,或者第三方库中植入恶意代码。
*   **CRC校验逻辑可能被绕过：**虽然PoC 代码中包含 CRC 校验重计算，但如果该逻辑存在缺陷，攻击者仍然可能篡改 RAR 文件内容而不被检测到。
*    **fallback_username恶意使用:** `fallback_username`默认是`Administrator`,如果被更改,则可能会导致提权失败。

虽然存在上述风险，但整体分析下来，PoC 代码的投毒概率相对较低，主要风险在于使用者利用该工具进行非授权的渗透测试或攻击活动。综合评估投毒风险为 **10%**。

**项目地址:** [hexsecteam/CVE-2025-8088-Winrar-Tool](https://github.com/hexsecteam/CVE-2025-8088-Winrar-Tool)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)