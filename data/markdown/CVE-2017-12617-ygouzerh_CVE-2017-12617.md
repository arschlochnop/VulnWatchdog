## CVE-2017-12617 - Apache Tomcat 远程代码执行

**漏洞编号:** CVE-2017-12617

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 9.0.0.M1 to 9.0.0, 8.5.0 to 8.5.22, 8.0.0.RC1 to 8.0.46, 7.0.0 to 7.0.81

**利用条件:** 需要目标Tomcat服务器开启HTTP PUT方法 (readonly 初始化参数设置为 false)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-12617 漏洞允许攻击者通过发送特制的HTTP PUT请求，上传包含恶意代码的JSP文件到服务器上。漏洞利用的有效性很高，因为公开的漏洞利用代码（POC）可以直接使用。根据漏洞描述和搜索引擎结果，利用此漏洞需要目标Tomcat服务器配置不当，即启用了HTTP PUT方法，且`readonly`初始化参数设置为`false`。  

**利用方式：**

1.  攻击者发送一个HTTP PUT请求，将一个JSP文件（例如`web_shell.jsp`）上传到服务器。这个JSP文件包含可以执行任意系统命令的代码。
2.  服务器将JSP文件保存到其文件系统中。
3.  攻击者通过访问上传的JSP文件的URL，触发恶意代码的执行。
4.  JSP文件中的代码允许攻击者在服务器上执行任意系统命令，从而实现远程代码执行。

**投毒风险分析：**

提供的POC代码本身的功能是验证漏洞，即上传一个webshell并执行命令。但是，其中存在一定潜在的投毒风险，主要体现在以下几个方面：

*   **webshell本身：** `web_shell.jsp` 文件是一个简易的webshell，如果被恶意使用，可能被用于进一步的攻击，例如植入后门、窃取数据等。
*   **依赖环境：**  `Makefile` 和 `attack.sh` 脚本依赖于 `curl` 和 `firefox` 等工具，如果攻击者修改这些脚本，可能会在受害者机器上执行额外的恶意操作。
*   **Docker镜像：** `victim/Dockerfile` 构建了一个包含漏洞的Tomcat环境，如果该镜像被篡改，可能会包含预先植入的恶意代码。

**投毒风险评估：**

尽管POC代码本身旨在验证漏洞，但潜在的滥用风险依然存在。我评估此仓库中存在作者隐藏的投毒代码的可能性为 10%。此评估基于以下原因：

*   POC的主要目的是演示漏洞，通常不会包含额外的恶意代码。
*   代码结构相对简单，容易进行安全审计。
*   公开的POC更容易受到安全研究人员的审查。

然而，使用者仍然需要谨慎对待，仔细审查POC代码，确保没有隐藏的恶意行为。在生产环境中部署或使用任何POC代码之前，务必进行全面的安全评估和测试。

**项目地址:** [ygouzerh/CVE-2017-12617](https://github.com/ygouzerh/CVE-2017-12617)

**漏洞详情:** [CVE-2017-12617](https://nvd.nist.gov/vuln/detail/CVE-2017-12617)