## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，本地用户可提升至root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 本地用户访问权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 版本中，允许本地用户通过 `--chroot` 选项和操控 `/etc/nsswitch.conf` 文件来获得 root 权限。漏洞的利用方式是利用 sudo 在解析 sudoers 文件之前通过 `--chroot` 选项更改其根目录的行为。如果攻击者可以控制 `/etc/nsswitch.conf` 文件（例如，通过将其放置在用户可写的目录中），则他们可以使用该文件来加载恶意共享库，从而在主机上以 root 身份执行任意代码。

**有效性：** 根据漏洞信息、搜索结果和提供的描述文件，POC 代码是有效的，因为它提供了检测和演示该漏洞利用的方法。搜索结果表明该漏洞是一个关键的本地提权漏洞，并且存在利用的 PoC。

**投毒风险：** 仓库中存在投毒代码的可能性较低，估计为 10%。 原因是：

1.  提供的代码主要侧重于漏洞的检测和演示环境的搭建，包含一个检测工具和一个 Docker 演示环境。
2.  虽然 `demo/run_demo.sh` 脚本可能会执行一些命令，但这些命令的目的是为了演示漏洞，而不是植入恶意代码。但是也不能排除该脚本存在后门操作的可能性，故评判存在小部分投毒风险。
3.  `cve_2025_32463_detector.py` 旨在扫描系统日志、进程和文件权限以查找可疑活动，这是一种防御性的安全工具。

**利用方式：**

1.  **前提条件：** 本地用户访问权限，目标系统上安装了受影响的 Sudo 版本 (1.9.14 到 1.9.17p1)。
2.  **利用步骤：**
    *   攻击者创建一个恶意的 `/etc/nsswitch.conf` 文件，该文件配置为加载恶意共享库。
    *   攻击者使用 `sudo --chroot` 选项指定一个他们控制的目录作为新的根目录，该目录包含恶意的 `/etc/nsswitch.conf` 文件。
    *   当 sudo 在 chroot 环境中运行时，它会解析恶意的 `/etc/nsswitch.conf` 文件并加载恶意共享库。
    *   恶意共享库以 root 权限执行，从而导致提权。

**项目地址:** [daryllundy/CVE-2025-32463](https://github.com/daryllundy/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)