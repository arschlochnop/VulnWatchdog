## CVE-2025-5287-Likes and Dislikes Plugin-SQL注入

**漏洞编号:** CVE-2025-5287

**漏洞类型:** SQL注入

**影响应用:** Likes and Dislikes Plugin

**危害等级:** 高危，可能导致数据泄露

**影响版本:** <= 1.0.0

**利用条件:** 需要WordPress安装目标插件，且未进行身份验证即可访问`wp-admin/admin-ajax.php`

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-5287存在于WordPress Likes and Dislikes插件1.0.0及更早版本中。漏洞原因是插件在处理用户提供的'post'参数时，未进行充分的转义，导致SQL注入。攻击者可以通过向`wp-admin/admin-ajax.php`发送包含恶意SQL代码的POST请求，利用`post`参数执行任意SQL查询，从而提取敏感信息。

**有效性：** 提供的PoC代码利用了时间盲注，通过控制`sleep_time`参数，可以验证目标是否存在SQL注入漏洞。PoC代码通过发送包含`SLEEP()`函数的payload，根据响应时间判断目标是否执行了恶意SQL。如果响应时间超过预设的`sleep_time`，则认为目标存在漏洞。

**投毒风险：** 提供的PoC代码中未发现明显的投毒行为。代码的功能集中于验证SQL注入漏洞，没有发现任何尝试执行恶意操作（例如上传webshell、修改文件等）的代码。`README.md`文件描述了该PoC的用途和使用方法，并声明了免责声明，表明该工具仅用于教育和授权渗透测试。但是依旧存在风险，例如作者故意延迟一定时间，或者在特定条件下执行恶意代码，因此判定投毒风险为5%。

**利用方式：**

1.  **确定目标：** 找到安装了受影响版本Likes and Dislikes插件的WordPress站点。
2.  **发送恶意请求：** 使用PoC代码或类似工具，构造包含恶意SQL代码的POST请求，发送到`wp-admin/admin-ajax.php`，其中`action`参数设置为`my_likes_dislikes_action`，`post`参数包含SQL注入payload。
3.  **时间盲注：** 通过调整`sleep_time`参数，观察响应时间，判断是否存在SQL注入。如果响应时间显著增加，则表明SQL注入成功。
4.  **信息提取：** 利用SQL注入，可以提取数据库中的敏感信息，例如用户名、密码哈希等。

**项目地址:** [RootHarpy/CVE-2025-5287](https://github.com/RootHarpy/CVE-2025-5287)

**漏洞详情:** [CVE-2025-5287](https://nvd.nist.gov/vuln/detail/CVE-2025-5287)