## CVE-2019-5736-runc-容器逃逸

**漏洞编号:** CVE-2019-5736

**漏洞类型:** 容器逃逸

**影响应用:** runc (Docker, Kubernetes等)

**危害等级:** 高危，允许容器逃逸并获取宿主机root权限

**影响版本:** <= 1.0-rc6 (Docker < 18.09.2)

**利用条件:** 需要能够以root身份在受影响的容器中执行命令 (创建新容器或docker exec到已有容器)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5736 漏洞存在于 runc 中，允许攻击者通过文件描述符处理不当，覆盖宿主机上的 runc 二进制文件。利用方式如下：

1.  **攻击条件：** 攻击者需要在存在漏洞的 Docker 或 Kubernetes 环境中，能够以 root 身份在容器内执行命令。
2.  **漏洞原理：** 漏洞源于 runc 在容器启动或执行 docker exec 时，对 `/proc/self/exe` 的处理存在缺陷。攻击者可以利用这个缺陷，打开宿主机上的 runc 二进制文件描述符。
3.  **利用过程：** 攻击者在容器内部运行恶意程序，该程序会尝试打开 `/proc/self/exe`，获得宿主机上 runc 二进制文件的文件描述符。然后，恶意程序会将恶意的代码（例如，添加一个后门）写入这个文件描述符，从而覆盖宿主机上的 runc 二进制文件。
4.  **攻击结果：** 当宿主机下次调用被篡改的 runc 二进制文件来创建或管理容器时，恶意代码就会以 root 权限在宿主机上执行，从而导致容器逃逸，攻击者获得宿主机的完全控制权。

**有效性评估：**

根据漏洞库信息和搜索引擎结果，该漏洞是一个已经公开且存在有效 PoC 的高危漏洞。大量的安全公告和分析文章证实了该漏洞的可利用性。

**投毒风险评估：**

提供的代码片段只是 GNU GPL 许可证，无法直接分析投毒风险。但是，考虑到漏洞利用通常涉及到修改 runc 二进制文件，恶意攻击者可能会在 PoC 中嵌入恶意代码，从而在成功利用漏洞后，在宿主机上植入后门。需要检查完整的POC代码分析是否存在恶意行为，例如反弹shell，添加用户等。 总体代码投毒风险评估为10%，主要来于与后期利用时可能引入的恶意操作。

**项目地址:** [takumak/cve-2019-5736-reproducer](https://github.com/takumak/cve-2019-5736-reproducer)

**漏洞详情:** [CVE-2019-5736](https://nvd.nist.gov/vuln/detail/CVE-2019-5736)