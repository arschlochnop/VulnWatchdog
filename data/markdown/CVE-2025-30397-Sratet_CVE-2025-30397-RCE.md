## CVE-2025-30397-Microsoft Scripting Engine Type Confusion RCE

**漏洞编号:** CVE-2025-30397

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Scripting Engine (Internet Explorer, Windows Scripting Host, etc.)

**危害等级:** 高危，允许攻击者在目标系统上执行任意代码

**影响版本:** 受影响的Windows版本和版本范围详见CVE描述。

**利用条件:** 需要用户交互（例如，打开恶意HTML文件）

**POC 可用性:** 是，但需下载。

**投毒风险:** 70%

## 详情

CVE-2025-30397是Microsoft Scripting Engine中的一个类型混淆漏洞。攻击者可以通过构造特制的脚本内容来利用此漏洞，实现在受害者系统上远程执行代码。漏洞利用涉及JScript和VBScript的混合使用，通过`Array.prototype.slice`在强制转换的VBScript对象上触发类型混淆，导致堆元数据损坏，从而覆盖函数指针并将控制权转移到攻击者提供的shellcode。

根据提供的漏洞利用代码仓库的README.md文件, 可以看到提供了一个下载链接。 根据搜索结果, 可以确定该漏洞是一个在野利用的0day漏洞。 漏洞利用代码仓库中存在潜在的投毒风险，因为需要下载才能获取利用代码，下载链接`https://tinyurl.com/svyntfz3`可能指向包含恶意代码的payload或后门程序的压缩包。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意JScript和VBScript代码的HTML文件。
2.  受害者通过某种方式（例如，点击钓鱼链接）打开该HTML文件。
3.  JScript中的`Array.prototype.slice`调用在被强制转换的VBScript对象上执行，触发类型混淆。
4.  堆元数据被破坏，攻击者可以覆盖函数指针。
5.  程序执行流程被劫持，跳转到攻击者提供的shellcode，从而执行任意代码。

**项目地址:** [Sratet/CVE-2025-30397-RCE](https://github.com/Sratet/CVE-2025-30397-RCE)

**漏洞详情:** [CVE-2025-30397](https://nvd.nist.gov/vuln/detail/CVE-2025-30397)