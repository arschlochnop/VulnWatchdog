## CVE-2024-9014-pgAdmin4-敏感信息泄露

**漏洞编号:** CVE-2024-9014

**漏洞类型:** 敏感信息泄露

**影响应用:** pgAdmin 4

**危害等级:** 高危，可能导致未授权访问用户数据

**影响版本:** <= 8.11

**利用条件:** 需要网络访问pgAdmin 4的登录页面

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2024-9014是pgAdmin 4版本8.11及更早版本中OAuth2认证实现中的一个安全漏洞。攻击者可以通过访问登录页面并提取`oauth2Config`变量来获取`client ID`和`client secret`。 

**有效性：**
提供的PoC代码有效。它使用`curl`命令从登录页面检索包含OAuth2配置的JSON数据，然后使用`grep`和`sed`提取`oauth2Config`的值。

**投毒风险：**
该仓库的PoC代码主要用于演示漏洞利用，用于提取敏感信息，本身没有明显的投毒代码。其中README.md文件中包含了bash命令，因此存在一定的投毒风险，如果使用者直接复制粘贴并且执行，如果URL_TO_TEST被替换成恶意地址，则会存在一定的风险，因此投毒风险较低。

**利用方式：**
1.  攻击者访问pgAdmin 4的登录页面 (`/login?next=/`)。
2.  攻击者使用`curl`或其他工具获取页面的HTML源代码。
3.  攻击者使用`grep`和`sed`等命令从HTML源代码中提取`oauth2Config`的值，其中包括`OAUTH2_CLIENT_ID`和`OAUTH2_CLIENT_SECRET`。
4.  攻击者可以使用泄露的`client ID`和`client secret`来冒充应用程序，并获取用户的访问令牌和个人信息。

**项目地址:** [EQSTLab/CVE-2024-9014](https://github.com/EQSTLab/CVE-2024-9014)

**漏洞详情:** [CVE-2024-9014](https://nvd.nist.gov/vuln/detail/CVE-2024-9014)