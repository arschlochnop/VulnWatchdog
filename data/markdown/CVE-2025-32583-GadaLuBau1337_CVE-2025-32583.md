## CVE-2025-32583-WordPress PDF 2 Post Plugin-RCE

**漏洞编号:** CVE-2025-32583

**漏洞类型:** 远程代码执行

**影响应用:** WordPress PDF 2 Post Plugin

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 2.4.0

**利用条件:** 需要WordPress后台低权限用户账号密码

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-32583是WordPress PDF 2 Post插件中存在的一个远程代码执行漏洞，影响版本小于等于2.4.0。该漏洞是由于插件对代码生成控制不当（Improper Control of Generation of Code），导致远程代码包含（Remote Code Inclusion）。

**漏洞利用方式：**

1.  攻击者需要具备WordPress后台的低权限用户账号密码。
2.  漏洞利用脚本首先使用提供的用户名和密码登录WordPress后台。
3.  登录成功后，脚本会获取一个名为`pdf2post_upload_nonce`的nonce值，该值用于CSRF保护。
4.  脚本创建一个包含恶意PHP代码的zip文件（gadalubau.zip）。该PHP代码允许通过`cmd`参数执行任意系统命令。
5.  脚本通过POST请求将zip文件上传到`/wp-admin/edit.php?page=new-post-from-pdf`，同时传递nonce值。
6.  插件在处理上传的zip文件时，没有进行充分的安全检查，导致zip文件中的PHP代码被解压到WordPress的uploads目录下，并可以被远程访问执行。
7.  攻击者可以通过访问上传目录下的恶意PHP文件，并传递`cmd`参数来执行任意系统命令，从而控制服务器。

**有效性评估：**

提供的POC代码是有效的，它能够自动化利用该漏洞，实现远程代码执行。

**投毒风险评估：**

POC代码的主要功能是利用漏洞，但仍然存在极低的潜在投毒风险（约1%），
1.  **文件名混淆:**虽然恶意PHP文件被命名为`gadalubau.php`，但如果攻击者修改脚本，可以将恶意文件命名为看似无害的文件名，例如`wp-temp.php`，从而增加隐蔽性。
2.  **执行参数:**脚本中的PHP代码通过`$_REQUEST['cmd']`接收命令，这是一种常见的后门形式。虽然这是漏洞利用的一部分，但攻击者可能会添加更复杂的逻辑，例如记录执行日志或添加持久化机制，使其更像一个后门。
3.  **依赖性风险:** 脚本依赖于`requests`，`BeautifulSoup4`和`zipfile`等Python库，这些库本身可能存在安全漏洞或被篡改。

建议在使用POC代码前进行代码审计，确保其安全性。

**项目地址:** [GadaLuBau1337/CVE-2025-32583](https://github.com/GadaLuBau1337/CVE-2025-32583)

**漏洞详情:** [CVE-2025-32583](https://nvd.nist.gov/vuln/detail/CVE-2025-32583)