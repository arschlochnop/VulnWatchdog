## CVE-2013-3900 WinVerifyTrust Signature Validation Vulnerability

**漏洞编号:** CVE-2013-3900

**漏洞类型:** 签名验证绕过

**影响应用:** Windows

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** Windows Server 2008 SP2 及以上版本，包括 Windows 10 和 Windows 11 的多个版本

**利用条件:** 用户或应用程序运行或安装被篡改的、伪造签名的 PE 文件

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2013-3900 漏洞存在于 Windows 的 WinVerifyTrust 函数中，该函数在处理可移植可执行 (PE) 文件的 Windows Authenticode 签名验证时存在缺陷。攻击者可以修改已签名的可执行文件，在不使签名失效的情况下，利用未验证的部分向文件中添加恶意代码，从而实现远程代码执行。

**有效性：**
从提供的漏洞信息、搜索结果和利用代码来看，此漏洞确实存在，并且有公开的利用方法。漏洞利用代码提供的是用于配置注册表项`EnableCertPaddingCheck`的 ADMX 和 ADML 文件，该注册表项用于启用证书填充检查，以缓解此漏洞。这意味着此POC并非直接执行代码，而是提供一种缓解措施。

**投毒风险：**
提供的漏洞利用代码（ADMX 和 ADML 文件）主要用于配置 Windows 组策略，以启用 `EnableCertPaddingCheck` 注册表项。这些文件本身不包含任何可执行代码或恶意指令，其作用是修改注册表设置。因此，该存储库本身**不存在**作者隐藏的投毒代码的风险，投毒风险为 0%。但需要注意，攻击者可能会利用此漏洞制作恶意程序，诱导用户运行。

**利用方式：**
1.  **攻击者修改已签名 PE 文件：** 攻击者首先需要找到一个已签名的 PE 文件（例如，合法的软件安装包）。
2.  **添加恶意代码：** 攻击者利用漏洞，在不破坏原始签名的情况下，向 PE 文件中添加恶意代码。
3.  **诱骗用户运行：** 攻击者通过各种方式（例如，社会工程学、网络钓鱼）诱骗用户运行被篡改的 PE 文件。
4.  **远程代码执行：** 当用户运行被篡改的 PE 文件时，WinVerifyTrust 函数未能正确验证签名，导致恶意代码被执行，从而实现远程代码执行。

**缓解措施：**
通过设置 `EnableCertPaddingCheck` 注册表项，可以强制 WinVerifyTrust 函数执行更严格的签名验证，从而阻止攻击者利用此漏洞。提供的 ADMX 和 ADML 文件可用于通过组策略集中管理此设置。

**结论：**
此漏洞是真实存在的，风险较高，但提供的 POC 主要是为了缓解此漏洞，不含恶意代码。攻击者主要通过篡改签名文件，诱骗用户运行来利用此漏洞。

**项目地址:** [AdenilsonSantos/WinVerifyTrust](https://github.com/AdenilsonSantos/WinVerifyTrust)

**漏洞详情:** [CVE-2013-3900](https://nvd.nist.gov/vuln/detail/CVE-2013-3900)