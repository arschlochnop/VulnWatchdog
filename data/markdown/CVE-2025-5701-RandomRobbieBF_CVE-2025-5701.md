## CVE-2025-5701-HyperComments-权限提升

**漏洞编号:** CVE-2025-5701

**漏洞类型:** 权限提升

**影响应用:** HyperComments

**危害等级:** 严重，允许未认证的攻击者获得管理员权限

**影响版本:** <= 1.2.2

**利用条件:** 需要安装并启用HyperComments插件的WordPress站点,并且插件版本小于等于1.2.2,无需认证。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-5701 存在于 WordPress HyperComments 插件中，版本小于等于 1.2.2。漏洞原因是 `hc_request_handler` 函数缺少权限检查，导致未经验证的攻击者可以更新 WordPress 站点的任意选项。利用方式是发送一个 POST 请求到 WordPress 站点，其中 `hc_action` 参数设置为 `update_options`，`data` 参数包含要更新的选项，例如将 `users_can_register` 设置为 `1` 并将 `default_role` 设置为 `administrator`，从而允许任何人注册为管理员。

**有效性：**
根据漏洞信息和提供的PoC代码，可以判断PoC代码有效。PoC代码通过修改 `users_can_register` 和 `default_role` 配置，实现权限提升。

**投毒风险：**
PoC 代码的功能是利用漏洞提升权限，没有发现隐藏的恶意代码或后门，因此投毒风险为 0%。

**利用方式：**
1.  确认目标 WordPress 站点安装并启用了 HyperComments 插件，并且版本小于等于 1.2.2。
2.  构造一个 HTTP POST 请求，包含 `hc_action=update_options` 以及 `data` 参数，`data` 参数是一个 JSON 字符串，其中包含要修改的 WordPress 选项。
3.  发送该 POST 请求到目标站点的根目录，成功后，用户注册功能将被开启，并且新注册的用户将拥有管理员权限。
4.  攻击者注册一个新用户，从而获得管理员权限。

**项目地址:** [RandomRobbieBF/CVE-2025-5701](https://github.com/RandomRobbieBF/CVE-2025-5701)

**漏洞详情:** [CVE-2025-5701](https://nvd.nist.gov/vuln/detail/CVE-2025-5701)