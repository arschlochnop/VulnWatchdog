## CVE-2025-41244 - VMware Aria Operations/Tools 本地提权

**漏洞编号:** CVE-2025-41244

**漏洞类型:** 本地权限提升

**影响应用:** VMware Aria Operations, VMware Tools

**危害等级:** 高危，可获得 root 权限

**影响版本:** VCF operations 9.0.x (< 9.0.1.0), VMware tools 13.x.x.x (< 13.0.5.0), 12.5.x (< 12.5.4), VMware Aria Operations 8.18.x (< 8.18.5), VMware Cloud Foundation 5.x, 4.x (< 8.18.5), VMware Telco Cloud Platform 5.x, 4.x (< 8.18.5), VMware Telco Cloud Infrastructure 3.x, 2.x (< 8.18.5)

**利用条件:** 需要在受影响的虚拟机上拥有非管理权限的本地账户，且该虚拟机需要由启用了 SDMP 的 Aria Operations 管理并安装了 VMware Tools。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-41244 漏洞是 VMware Aria Operations 和 VMware Tools 中的一个本地权限提升漏洞。攻击者需要在目标虚拟机上拥有一个非管理权限的本地账户，并且该虚拟机需要被启用了 SDMP (Software Defined Management Platform) 的 Aria Operations 管理，同时安装了 VMware Tools。攻击者可以利用此漏洞将权限提升到 root 权限。

**利用方式：**

提供的 Go 代码实现了一个本地权限提升的 PoC。该 PoC 主要分为两个部分：一个非特权进程 (serve) 和一个特权进程 (connect)。

1.  **非特权进程 (serve):**
    *   创建一个 Unix Domain Socket 监听器 ("@cve" 或者 "@localbus"取决于版本)。
    *   等待特权进程连接到该监听器。
    *   接受来自特权进程的 stdin、stdout 和 stderr 流。
    *   将这些流连接到自身的 stdin、stdout 和 stderr，从而与特权进程进行交互。

2.  **特权进程 (connect):**
    *   创建一个 shell 进程（/bin/sh -i）
    *   连接到非特权进程创建的 Unix Domain Socket 监听器 ("@cve" 或者 "@localbus"取决于版本)。
    *   将 shell 进程的 stdin、stdout 和 stderr 重定向到与非特权进程建立的连接，从而获得一个具有 root 权限的 shell。

**有效性：**

提供的 POC 代码看起来是有效的，因为它遵循了本地权限提升漏洞的典型利用模式：利用一个已经存在的、以更高权限运行的进程（这里是通过 Aria Operations 管理的 VMware Tools）来执行任意代码。通过 Unix Domain Socket 传递标准输入、输出和错误流，攻击者可以控制特权进程。

**投毒风险：**

代码本身没有明显的投毒迹象。它是一个相对简单的本地权限提升 PoC，没有包含任何恶意代码或后门。两段代码除了 socket监听的名称不一样之外，基本一致。投毒风险评估为 0%。

**项目地址:** [haspiranti/CVE-2025-41244-PoC](https://github.com/haspiranti/CVE-2025-41244-PoC)

**漏洞详情:** [CVE-2025-41244](https://nvd.nist.gov/vuln/detail/CVE-2025-41244)