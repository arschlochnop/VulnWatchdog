## CVE-2022-0492-Linux Kernel-cgroups v1 release_agent权限提升

**漏洞编号:** CVE-2022-0492

**漏洞类型:** 权限提升/容器逃逸

**影响应用:** Linux Kernel

**危害等级:** 高危，可导致容器逃逸和权限提升

**影响版本:** kernel 5.17 rc3

**利用条件:** 需要开启cgroups v1功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0492 漏洞存在于 Linux 内核的 cgroup_release_agent_write 函数中 (kernel/cgroup/cgroup-v1.c)。该漏洞允许在特定情况下利用 cgroups v1 release_agent 功能来提升权限并绕过命名空间隔离。漏洞利用方式通常是：

1.  创建一个新的 cgroup v1。
2.  修改 cgroup 的 release_agent 文件，指向一个攻击者可控的脚本。
3.  触发 cgroup 的 oom_kill 事件，或者通过其他方式使 cgroup 被销毁。
4.  当 cgroup 被销毁时，内核会执行 release_agent 指定的脚本，由于该脚本由攻击者控制，因此可以执行任意代码，从而实现权限提升。从搜索结果来看，该漏洞可以导致容器逃逸，影响较大。

提供的漏洞利用代码只是 `COPYING` 和 `CREDITS` 文件，并非真正的漏洞利用代码。该代码段不包含任何可疑的恶意代码，因此投毒风险评估为 0%。

根据搜索结果，存在公开可用的漏洞利用代码，利用有效性较高。

**项目地址:** [Trinadh465/device_renesas_kernel_AOSP10_r33_CVE-2022-0492](https://github.com/Trinadh465/device_renesas_kernel_AOSP10_r33_CVE-2022-0492)

**漏洞详情:** [CVE-2022-0492](https://nvd.nist.gov/vuln/detail/CVE-2022-0492)