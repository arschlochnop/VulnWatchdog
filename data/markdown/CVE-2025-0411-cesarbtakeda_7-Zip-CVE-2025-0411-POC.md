## CVE-2025-0411-7-Zip-Mark-of-the-Web Bypass

**漏洞编号:** CVE-2025-0411

**漏洞类型:** Mark-of-the-Web (MotW) Bypass

**影响应用:** 7-Zip

**危害等级:** 中危，用户交互后可导致任意代码执行

**影响版本:** < 24.09

**利用条件:** 用户需要下载并解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0411 是 7-Zip 中存在的 Mark-of-the-Web (MotW) 绕过漏洞。攻击者可以利用此漏洞绕过 Windows 的安全机制，在用户不知情的情况下执行恶意代码。

**有效性:**
提供的 POC 代码通过双重压缩的方式，将带有 MotW 的文件中的可执行文件在解压后去除 MotW 标记，使得可执行文件在运行时不会触发 Windows SmartScreen 警告。POC 描述中展示了 vulnerable 版本直接执行 calc.exe 而没有警告，而 patched 版本会弹出 SmartScreen 警告。因此，提供的POC代码**有效**。

**投毒风险:**
*   `LICENSE` 和 `README.md` 文件未发现任何恶意代码。
*   `loader.cpp` 文件包含一个简单的 shellcode 加载器，用于执行硬编码的 calc.exe shellcode。这段代码本身并无恶意，只是作为 POC 的一部分，演示漏洞利用。
*   整个仓库的目的是演示 CVE-2025-0411 漏洞，没有发现明显的投毒代码。仓库中所有文件用于漏洞验证,执行的是计算器程序。

**利用方式:**
1.  攻击者创建一个恶意压缩包，其中包含可执行文件（例如 `loader.exe`）。
2.  攻击者将该压缩包再次压缩，形成双重压缩包。
3.  攻击者将双重压缩包托管在服务器上，并通过钓鱼邮件等方式诱骗用户下载。
4.  用户使用易受攻击的 7-Zip 版本（低于 24.09）解压该双重压缩包。
5.  由于 7-Zip 未能正确传递 MotW 标记，解压后的可执行文件将不包含 MotW 标记。
6.  用户运行解压后的可执行文件，恶意代码将在没有安全警告的情况下执行。

**总结:**
此漏洞利用的关键在于双重压缩，通过这种方式可以绕过 Windows 的 MotW 保护机制。用户交互是利用此漏洞的必要条件，需要用户下载并解压恶意构造的压缩包。

**项目地址:** [cesarbtakeda/7-Zip-CVE-2025-0411-POC](https://github.com/cesarbtakeda/7-Zip-CVE-2025-0411-POC)

**漏洞详情:** [CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)