## CVE-2021-41773 - Apache HTTP Server Path Traversal

**漏洞编号:** CVE-2021-41773

**漏洞类型:** 路径遍历 (Path Traversal)

**影响应用:** Apache HTTP Server

**危害等级:** 高危，可导致敏感信息泄露和远程代码执行 (Remote Code Execution, RCE)

**影响版本:** 2.4.49

**利用条件:** 目标服务器运行Apache HTTP Server 2.4.49，且Alias指令配置不当，未对外部文件目录进行访问限制。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-41773 是 Apache HTTP Server 2.4.49 中存在的路径遍历漏洞。攻击者可以通过构造包含`/.%2e`或`/%2e%2e`等特殊序列的URL，绕过服务器的路径规范化检查，从而访问Alias指令配置之外的文件。

**有效性：**
提供的Dockerfile和docker-compose.yml文件用于搭建存在CVE-2021-41773漏洞的Apache HTTP Server 2.4.49环境。README.md中提供了利用该漏洞读取`/etc/passwd`文件的POC，验证了漏洞的有效性。搜索引擎结果也表明该漏洞可以被利用来进行路径遍历和远程代码执行。

**投毒风险：**
Dockerfile仅仅是从官方镜像拉取存在漏洞的镜像并复制httpd.conf，httpd.conf是基本的apache配置，没有恶意代码。docker-compose文件只是启动docker。
文件分析结果如下：
*   **Dockerfile:**  该文件用于构建包含漏洞版本的Apache镜像，没有发现恶意行为。
*   **README.md:**  该文件提供了漏洞的POC，用于验证漏洞，其中包含的命令用于读取`/etc/passwd`等文件，属于漏洞利用行为，而非投毒。
*   **docker-compose.yml:**  该文件用于配置和启动Docker容器，没有发现恶意行为。
*   **httpd.conf:**  配置文件为apache的默认配置, 没有恶意行为
虽然没发现明显的恶意代码，但如果使用者不了解漏洞原理，直接部署该环境，可能会造成安全风险。因此，存在极低的投毒风险，约5%。

**利用方式：**
1.  攻击者构造恶意的URL，其中包含`/.%2e`或`/%2e%2e`等序列，用于绕过路径规范化检查。
2.  URL指向`/cgi-bin/`目录下的文件，并利用路径遍历访问目标文件，例如`/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd`。
3.  如果服务器配置允许执行CGI脚本，攻击者甚至可以利用该漏洞执行任意代码，例如通过POST请求传递恶意代码到目标文件。

**修复建议：**
1.  升级到Apache HTTP Server 2.4.50或更高版本。
2.  在Apache配置文件中，对根目录`/`设置`Require all denied`，防止未授权访问。

**项目地址:** [luongchivi/CVE-2021-41773](https://github.com/luongchivi/CVE-2021-41773)

**漏洞详情:** [CVE-2021-41773](https://nvd.nist.gov/vuln/detail/CVE-2021-41773)