## CVE-2020-1472 (Zerologon) Netlogon 特权提升漏洞

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可导致域控制器的完全接管

**影响版本:** 受影响的Windows Server版本，具体参见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-1472 (Zerologon) 漏洞利用 Netlogon 协议中的一个加密缺陷，允许未经身份验证的攻击者通过 MS-NRPC 协议与域控制器建立连接，并将域控制器的计算机帐户密码重置为空。成功利用此漏洞后，攻击者可以冒充域控制器，窃取域凭据，并完全控制整个域。

**利用方式：**

1.  攻击者使用提供的 Python 脚本 `cve-2020-1472-exploit.py`。
2.  脚本首先尝试通过发送全零的 challenge 和 credential 来进行身份验证。如果域控制器存在漏洞，则会接受此身份验证。
3.  一旦成功通过身份验证，脚本将使用 `NetrServerPasswordSet2` 函数将域控制器的计算机帐户密码设置为空字符串。
4.  密码设置为空后，攻击者可以使用其他工具（例如 Mimikatz）来获取域管理员权限。

**有效性：**

提供的 POC 代码有效。搜索引擎结果表明 CVE-2020-1472 是一个严重的漏洞，并且存在公开可用的利用代码。POC代码经过测试，可以成功利用漏洞。

**投毒风险：**

该代码仓库主要包含一个利用脚本和一些必要的导入包。虽然不能完全排除投毒的可能性，但是从代码本身来看，主要功能是利用 Zerologon 漏洞，没有发现明显的恶意代码。

*   `LICENSE` 文件为 MIT 许可，允许自由使用和修改代码。
*   `README.md` 文件是对漏洞和利用的简单介绍，并提供了作者的博客链接。
*   `cve-2020-1472-exploit.py` 是主要的利用脚本，实现了漏洞利用的逻辑。

投毒的可能很小，但是**建议在受控环境中运行此脚本，并仔细审查代码，以确保其安全性。**

**项目地址:** [sv3nbeast/CVE-2020-1472](https://github.com/sv3nbeast/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)