## CVE-2023-22809-Sudoedit权限提升

**漏洞编号:** CVE-2023-22809

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许本地攻击者提升权限至root

**影响版本:** 1.8.0 - 1.9.12p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-22809 漏洞存在于 Sudo 1.9.12p2 之前的版本中，允许本地攻击者通过操纵 SUDO_EDITOR, VISUAL, 和 EDITOR 环境变量中的参数，利用 sudoedit 命令附加额外的文件进行编辑，从而导致权限提升。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的利用是有效的。多个安全厂商和社区都确认了该漏洞的存在和利用方式。

**投毒风险：**
提供的漏洞利用代码 (`CVE-2023-22809Patch.sh` 和 `README.md`) 实际上是一个用于**更新 Sudo 版本**的脚本，它从 GitHub 下载一个 Debian 包并安装它。这个脚本本身并没有包含任何恶意代码或后门，所以投毒风险评估为0%。它仅仅是尝试修复漏洞，而不是利用漏洞。

**利用方式：**
该漏洞的利用方式是通过设置环境变量 `SUDO_EDITOR`，`VISUAL` 或 `EDITOR`，在其中包含 `--` 参数以及要编辑的恶意文件路径，当用户使用 `sudoedit` 命令时，这些额外的参数会被传递给编辑器，从而允许编辑本来没有权限编辑的文件。例如：`EDITOR='vim -- /etc/shadow'; sudoedit 文件名`。攻击者可以利用此漏洞修改 `/etc/shadow` 文件或其它特权文件，从而获得 root 权限。

**项目地址:** [hello4r1end/patch_CVE-2023-22809](https://github.com/hello4r1end/patch_CVE-2023-22809)

**漏洞详情:** [CVE-2023-22809](https://nvd.nist.gov/vuln/detail/CVE-2023-22809)