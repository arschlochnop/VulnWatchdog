## CVE-2023-50564-Pluck-CMS-任意文件上传

**漏洞编号:** CVE-2023-50564

**漏洞类型:** 任意文件上传

**影响应用:** Pluck CMS

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 4.7.18

**利用条件:** 需要低权限用户账号

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-50564是Pluck CMS v4.7.18版本中/inc/modules_install.php组件存在的一个任意文件上传漏洞。攻击者可以利用该漏洞上传精心构造的ZIP文件，从而执行任意代码。\n\n**有效性分析：**
根据漏洞库信息和搜索结果，该漏洞是真实存在的，并且已经被公开。POC代码也已经发布，证明了该漏洞的可利用性。POC代码通过以下步骤利用漏洞：
1.  用户提供目标主机、用户名、密码、监听IP和端口。
2.  生成包含反向shell代码的PHP文件 (rev.php)。
3.  将PHP文件压缩成ZIP文件 (rev.zip)。
4.  使用提供的用户名和密码登录Pluck CMS。
5.  上传恶意ZIP文件到/inc/modules_install.php。
6.  成功上传后，访问上传的PHP文件，建立反向shell连接。
\n**投毒风险分析：**
该POC代码的主要功能是利用漏洞上传包含反向shell的PHP文件。反向shell代码本身是恶意代码，用于获取目标系统的控制权。检查POC代码，没有发现作者隐藏的额外恶意逻辑或后门。但是，使用者需要注意以下几点：
1.  该POC代码本身是用于攻击的工具，使用不当可能造成危害。
2.  反向shell连接建立后，攻击者可以在目标系统上执行任意命令。
3.  由于使用了用户提供的lhost和lport，在一定程度上降低了投毒风险。该脚本本身较为透明，易于审查。
综合考虑，存在极低的被投毒风险，大约5%。
\n**利用方式：**
1.  **身份验证绕过：** 攻击者需要有效的用户名和密码才能登录Pluck CMS后台。\n2.  **ZIP文件上传：** 攻击者创建一个包含恶意PHP文件的ZIP文件。\n3.  **文件上传漏洞：** 攻击者利用/inc/modules_install.php组件中的漏洞上传ZIP文件。\n4.  **远程代码执行：** 上传的PHP文件被执行，攻击者获得目标系统的远程代码执行权限。

**项目地址:** [thefizzyfish/CVE-2023-50564-pluck](https://github.com/thefizzyfish/CVE-2023-50564-pluck)

**漏洞详情:** [CVE-2023-50564](https://nvd.nist.gov/vuln/detail/CVE-2023-50564)