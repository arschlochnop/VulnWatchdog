## CVE-2017-0143 Windows SMB Remote Code Execution Vulnerability

**漏洞编号:** CVE-2017-0143

**漏洞类型:** 远程代码执行

**影响应用:** Windows SMBv1

**危害等级:** 高危，可能导致系统完全控制和数据泄露

**影响版本:** Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607; and Windows Server 2016

**利用条件:** 目标系统启用SMBv1服务且未安装MS17-010补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2017-0143 是一个Windows SMBv1服务器中的远程代码执行漏洞。攻击者可以通过构造特制的SMB数据包发送到目标服务器，从而在目标系统上执行任意代码。此漏洞与EternalBlue exploit有关，是WannaCry勒索软件传播利用的漏洞之一。

**有效性：**
根据漏洞库信息和搜索结果，CVE-2017-0143漏洞被广泛利用，存在公开可用的漏洞利用代码（如EternalBlue）。提供的POC代码（Eternal-blue-Windows-7-Checker）是一个检测工具，用于判断目标主机是否受到EternalBlue攻击的影响，并非直接利用漏洞的代码，但是表明了该漏洞利用的有效性。

**投毒风险：**
提供的checker.py（未提供完整代码） 是用于检测目标是否存在漏洞。bucket.cpp 文件是哈希桶的实现，从代码来看，主要功能是实现一个简单的哈希表，没有发现明显的恶意代码或后门。但是，任何代码都可能被用于恶意目的，因此仍然存在一定的投毒风险。此处的10%表示存在一些细微的风险，需要进一步审计。

**利用方式：**
1.  攻击者扫描网络，查找启用SMBv1且未安装MS17-010补丁的目标系统。
2.  攻击者使用EternalBlue exploit或其他针对CVE-2017-0143的exploit，构造恶意的SMB数据包。
3.  攻击者将恶意数据包发送到目标系统。
4.  如果目标系统存在漏洞，恶意代码将在目标系统上执行，攻击者可以获得系统控制权。

**排序优先级说明：**
在本次分析中，搜索引擎结果提供了漏洞的总体描述和影响，漏洞利用代码提供了漏洞利用的细节和检测方法，漏洞库信息提供了漏洞的官方描述和受影响的系统版本。因此，搜索引擎结果>漏洞利用代码>漏洞库信息。

**项目地址:** [NatteeSetobol/Etern-blue-Windows-7-Checker](https://github.com/NatteeSetobol/Etern-blue-Windows-7-Checker)

**漏洞详情:** [CVE-2017-0143](https://nvd.nist.gov/vuln/detail/CVE-2017-0143)