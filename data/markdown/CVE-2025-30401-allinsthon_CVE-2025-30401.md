## CVE-2025-30401: WhatsApp for Windows Attachment Spoofing Exploit

**漏洞编号:** CVE-2025-30401

**漏洞类型:** 附件欺骗导致任意代码执行

**影响应用:** WhatsApp Desktop for Windows

**危害等级:** 中危，用户需要手动打开附件

**影响版本:** < 2.2450.6

**利用条件:** 需要攻击者能够通过WhatsApp发送文件给受害者，且受害者使用存在漏洞的WhatsApp for Windows版本并手动打开附件。

**POC 可用性:** 是

**投毒风险:** 30%

## 详情

CVE-2025-30401 是一个 WhatsApp for Windows 桌面客户端的附件欺骗漏洞。攻击者可以通过构造一个具有欺骗性的文件，使其 MIME 类型看起来安全（例如图片），但实际的文件扩展名却是可执行文件类型（例如 .exe, .bat, .ps1）。当用户手动打开这个附件时，Windows 会根据文件扩展名选择对应的处理程序，从而执行恶意代码。

**漏洞利用方式：**

1.  攻击者使用提供的 `whatsappexploit.py` 脚本，指定附件类型 (`-t`) 和要执行的命令 (`-c`) 以及输出文件名 (`-o`)，生成恶意附件。
2.  攻击者通过 WhatsApp 将生成的恶意文件发送给受害者。
3.  受害者在 WhatsApp 中看到的文件图标和 MIME 类型显示为安全的类型（例如图片）。
4.  受害者手动双击打开该文件。
5.  Windows 根据文件扩展名执行恶意代码，例如 `calc.exe` 或 `notepad.exe`。

**有效性：**

根据漏洞描述和PoC代码描述，该漏洞利用方式是有效的，可以实现任意代码执行，但需要用户交互。

**投毒风险：**

PoC 仓库本身包含一定的风险，具体风险分析如下：

*   **下载链接风险：** PoC 中包含一个 `[Download](https://tinyurl.com/2pyrfuva)` 链接。虽然链接描述为下载 Exploit，但 `tinyurl.com` 短链接服务可能会被滥用，指向包含恶意软件或后门代码的压缩包。**这是最主要的投毒风险点。**需要对下载的文件进行严格的安全检查。
*   **`whatsappexploit.py` 脚本风险：** 脚本本身可能包含恶意代码，例如在生成恶意附件时植入后门。虽然 PoC 描述中没有明确说明，但不能完全排除这种可能性。审查脚本的内容可以降低这种风险。
*   **payload代码风险：** 攻击者可以修改生成的payload，从而导致更大的损失。

综合考虑，认为该 PoC 仓库存在一定的投毒风险，特别是未经验证的下载链接。 因此，投毒风险评定为 30%。 请务必谨慎使用，并进行充分的安全评估。

**项目地址:** [allinsthon/CVE-2025-30401](https://github.com/allinsthon/CVE-2025-30401)

**漏洞详情:** [CVE-2025-30401](https://nvd.nist.gov/vuln/detail/CVE-2025-30401)