## CVE-2018-6574-Go-get远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 用户使用受影响的Go版本执行`go get`命令获取恶意代码仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Go语言的`go get`命令中。攻击者可以通过在恶意Go代码仓库中包含特制的C代码，利用`gcc`或`clang`的插件机制，在用户执行`go get`命令构建源代码时执行任意命令。

**有效性：**
提供的POC代码是有效的。攻击者通过创建一个包含恶意C代码（`attack.c`）的共享库（`attack.so`），然后在Go代码（`main.go`）中使用`#cgo CFLAGS: -fplugin=./attack.so`指令，指示`go build`或`go get`命令在编译过程中加载该恶意共享库。当程序被编译或安装时，恶意代码就会被执行。

**投毒风险：**
该仓库存在一定的投毒风险，因为`attack.c`中包含`system("you cmd command");`。虽然这里的"you cmd command"只是一个占位符，需要替换为实际的攻击命令，但是攻击者可能在不知情的情况下直接使用该代码，从而暴露自己的攻击行为。风险评定为10%是因为该代码中`system`函数明显是一个可以执行恶意代码的地方,容易被发现并修改.

**利用方式：**
1.  攻击者创建一个包含恶意C代码（`attack.c`）和Go代码（`main.go`）的Go代码仓库。
2.  恶意C代码使用`__attribute__((constructor))`修饰的函数，确保在共享库加载时自动执行。
3.  Go代码使用`#cgo CFLAGS: -fplugin=./attack.so`指令，指示`go build`或`go get`命令在编译过程中加载该恶意共享库。
4.  攻击者诱骗受害者使用`go get`命令获取该恶意代码仓库。
5.  当受害者执行`go get`命令时，恶意C代码被编译成共享库并加载，从而执行攻击者预设的任意命令。

**项目地址:** [zerbaliy3v/cve-2018-6574-exploit](https://github.com/zerbaliy3v/cve-2018-6574-exploit)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)