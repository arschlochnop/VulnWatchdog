## CVE-2024-36401-GeoServer-RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行

**影响应用:** GeoServer

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** 受影响版本包括 2.22.6 之前，2.23.0 到 2.23.6 之间，2.24.0 到 2.24.4 之间，以及 2.25.0 到 2.25.2 之间的版本

**利用条件:** 目标GeoServer实例对外开放且运行于受影响的版本

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401是GeoServer中的一个远程代码执行(RCE)漏洞，源于GeoTools库API不安全地将属性名作为XPath表达式传递给commons-jxpath库。未经身份验证的攻击者可以通过构造恶意的OGC请求参数（如WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute requests）来利用此漏洞，在服务器上执行任意代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已被积极利用。提供的POC代码仓库 `RevoltSecurities/CVE-2024-36401` 提供了一个用于检测和利用此漏洞的工具，包含docker-compose 文件用于搭建测试环境，以及 `exploit.py` 脚本用于漏洞利用，因此POC代码有效。

**投毒风险：**
*   `exploit.py` 文件中，脚本尝试与`https://api.cvssadvisor.com/ssrf/` 建立连接。这是一个潜在的风险点，因为攻击者可能通过控制该API来收集目标信息或进行其他恶意活动。但目前只是get请求实例信息，危害较小。但从代码的整体结构来看，投毒的风险较低。主要的功能还是针对`CVE-2024-36401`的利用。综上，认为投毒风险较低，约为10%。

**利用方式：**
1.  **确定目标GeoServer版本：** 确认目标GeoServer实例是否在受影响的版本范围内。
2.  **发送恶意OGC请求：** 构造包含恶意XPath表达式的OGC请求，例如WFS GetFeature请求。请求的Payload包含恶意的XPath表达式注入。
3.  **远程代码执行：** GeoServer在处理请求时，会将恶意XPath表达式传递给commons-jxpath库，导致执行任意代码。
4.  **利用工具：** 使用提供的`exploit.py`脚本，指定目标URL，通过发送恶意请求触发漏洞。

简而言之，攻击者通过发送特制的OGC请求，利用GeoServer对属性名表达式的不安全评估，实现远程代码执行。

**项目地址:** [RevoltSecurities/CVE-2024-36401](https://github.com/RevoltSecurities/CVE-2024-36401)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)