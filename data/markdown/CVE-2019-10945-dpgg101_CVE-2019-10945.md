## CVE-2019-10945-Joomla-目录遍历/任意文件删除

**漏洞编号:** CVE-2019-10945

**漏洞类型:** 目录遍历/任意文件删除

**影响应用:** Joomla

**危害等级:** 高危，可能导致信息泄露和服务器被控制

**影响版本:** 1.5.0 <= version <= 3.9.4

**利用条件:** 需要Joomla管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-10945 是 Joomla! CMS 中的一个目录遍历漏洞，存在于 Media Manager 组件中。该漏洞是由于 Media Manager 组件未能正确过滤 `folder` 参数，导致攻击者能够访问 Media Manager 根目录之外的文件。结合提供的漏洞利用代码，攻击者首先需要通过已知管理员用户名和密码进行身份验证。成功登录后，攻击者可以利用该漏洞列出任意目录中的文件或删除服务器上的文件。 

**有效性：**
根据漏洞描述和搜索结果，漏洞利用代码是有效的，可以成功利用该漏洞进行目录遍历和文件删除。

**投毒风险：**
该 POC 代码主要功能是实现目录遍历和删除文件。代码中存在使用pickle序列化和反序列化cookie，这可能被利用进行投毒，但是概率较低。同时代码作者信息明确，来自 haboob.sa，降低了投毒风险。综合判断，存在10%的投毒风险。

**利用方式：**
1.  使用提供的脚本 `CVE-2019-10945.py`。
2.  指定目标 Joomla 站点的 URL、管理员用户名和密码，例如：`python CVE-2019-10945.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password>`
3.  使用 `--dir` 参数指定要列出文件的目录，例如：`python CVE-2019-10945.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=/../../configuration.php`
4.  使用 `--rm` 参数删除文件，例如：`python CVE-2019-10945.py --url=http://example.com/administrator --username=<joomla-manager-username> --password=<joomla-manager-password> --dir=/tmp --rm=evil.txt`

攻击者通过构造包含目录遍历字符（如 `../`）的 `folder` 参数，便可绕过 Media Manager 的访问限制，访问或删除服务器上的敏感文件，从而导致信息泄露或服务器被完全控制。

**项目地址:** [dpgg101/CVE-2019-10945](https://github.com/dpgg101/CVE-2019-10945)

**漏洞详情:** [CVE-2019-10945](https://nvd.nist.gov/vuln/detail/CVE-2019-10945)