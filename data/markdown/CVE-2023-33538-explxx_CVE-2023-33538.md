## CVE-2023-33538-TP-Link路由器-命令注入

**漏洞编号:** CVE-2023-33538

**漏洞类型:** 命令注入

**影响应用:** TP-Link TL-WR940N/TL-WR841N/TL-WR740N

**危害等级:** 高危，可导致远程代码执行

**影响版本:** TL-WR940N V2/V4, TL-WR841N V8/V10, and TL-WR740N V1/V2

**利用条件:** 需要与目标路由器在同一网络，且具有web管理界面登录权限（默认admin/admin）或无需认证配置错误的设备。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-33538是一个TP-Link路由器中的命令注入漏洞，存在于/userRpm/WlanNetworkRpm组件中。攻击者可以通过构造包含恶意命令的ssid1参数发起攻击。

**有效性分析：**
从提供的漏洞利用代码来看，该PoC代码有效。它通过向`/userRpm/WlanNetworkRpm.htm`发送包含恶意payload的GET请求来利用该漏洞。Payload被插入到ssid1参数中，导致命令注入。该PoC支持基本漏洞检查、执行自定义命令和反弹shell三种利用方式。

**投毒风险分析：**
虽然提供的代码主要用于漏洞利用，但仍然存在一定的投毒风险。风险点在于：
*   **反弹shell：** PoC中包含反弹shell的功能，如果攻击者利用该功能，可能会在目标设备上植入恶意代码或后门。
*   **命令执行的隐蔽性：** 该漏洞允许执行任意命令，攻击者可以在不引起注意的情况下执行恶意操作，例如修改DNS设置、窃取敏感信息等。
*   **依赖外部资源风险**: 脚本中使用了`urllib.parse.quote`进行url编码，攻击者可能通过修改编码后的内容来尝试绕过某些安全策略。
综合来看，投毒风险较低，估计为10%。PoC的主要功能是演示漏洞利用，但恶意使用可能会导致严重后果。

**利用方式分析：**
1.  **身份验证绕过：** 某些配置错误的设备可能无需身份验证即可访问/userRpm/WlanNetworkRpm.htm。即使需要身份验证，默认的用户名和密码（admin/admin）也容易被猜测。
2.  **发送恶意请求：** 攻击者构造包含恶意命令的ssid1参数，并通过GET请求发送到`/userRpm/WlanNetworkRpm.htm`。
3.  **命令注入：** 路由器在处理ssid1参数时，未正确过滤特殊字符，导致命令注入。
4.  **远程代码执行：** 成功利用漏洞后，攻击者可以在路由器上执行任意命令，例如反弹shell，从而完全控制路由器。

**搜索引擎结果补充：**
搜索结果表明该漏洞已被CISA列入已知被利用漏洞目录，并且存在活跃攻击。这进一步证实了该漏洞的严重性和利用价值。

**结论：**
该漏洞是高危漏洞，PoC代码有效，存在一定的投毒风险，利用方式简单直接，易于被攻击者利用。建议受影响的用户尽快采取措施，例如升级固件或更换设备。

**项目地址:** [explxx/CVE-2023-33538](https://github.com/explxx/CVE-2023-33538)

**漏洞详情:** [CVE-2023-33538](https://nvd.nist.gov/vuln/detail/CVE-2023-33538)