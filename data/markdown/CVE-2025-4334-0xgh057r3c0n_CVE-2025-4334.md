## CVE-2025-4334-Simple User Registration-权限提升

**漏洞编号:** CVE-2025-4334

**漏洞类型:** 权限提升

**影响应用:** Simple User Registration WordPress 插件

**危害等级:** 高危，未经身份验证的攻击者可以注册为管理员

**影响版本:** <= 6.3

**利用条件:** 目标网站安装了Simple User Registration <= 6.3版本的WordPress插件，且允许用户注册

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-4334 漏洞存在于Simple User Registration WordPress插件中，允许未经身份验证的攻击者通过注册时操纵用户元数据，将其角色设置为管理员。提供的PoC代码通过以下步骤利用此漏洞：

1.  **信息收集：** PoC首先从注册表单页面提取 `wpr_nonce` 和 `wpr_form_id`，这些值用于绕过插件的安全检查。
2.  **构造恶意请求：** PoC构造一个POST请求，发送到 `wp-admin/admin-ajax.php` 端点，该端点处理插件的表单提交。
3.  **权限提升：** 在POST数据中，`wpr[wp_field][role]` 字段被设置为 `administrator`，这指示插件将新注册的用户创建为管理员。
4.  **发送请求：** PoC发送带有恶意数据的POST请求到目标WordPress站点。
5.  **验证结果：** PoC检查响应，以确认用户是否成功注册为管理员。

**有效性：** 根据漏洞描述和PoC代码，该漏洞利用很可能有效。PoC代码演示了如何利用漏洞描述中提到的不充分的权限控制，成功注册管理员用户。

**投毒风险：** PoC代码主要功能是实现权限提升，没有明显的恶意行为或后门。`test@admin.ksa` 邮箱地址可能暗示目标群体是沙特阿拉伯，但不能直接判定为投毒。由于代码会创建新的管理员账户，如果被滥用，可能导致网站被控制，这可以被视为一种间接的风险。投毒风险的评估较低，约为1%。

**利用方式：** 利用方式是未经身份验证的攻击者访问启用了Simple User Registration插件的WordPress网站的注册页面，然后通过修改POST请求中的用户角色字段将其注册为管理员用户。

**项目地址:** [0xgh057r3c0n/CVE-2025-4334](https://github.com/0xgh057r3c0n/CVE-2025-4334)

**漏洞详情:** [CVE-2025-4334](https://nvd.nist.gov/vuln/detail/CVE-2025-4334)