## CVE-2023-26360

**漏洞编号:** CVE-2023-26360

**漏洞类型:** 不当访问控制导致任意代码执行

**影响应用:** Adobe ColdFusion

**危害等级:** 高危，可导致远程代码执行

**影响版本:** CF2018U15 及更早版本，CF2021U5 及更早版本

**利用条件:** 目标ColdFusion服务器开启且可网络访问，攻击者无需用户交互

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 Adobe ColdFusion 中的不当访问控制引起的。未经身份验证的攻击者可以通过构造特定的请求，利用 `iedit.cfc` 组件执行任意代码。利用方式如下：

1.  **漏洞分析:**
    *   `iedit.cfc` 组件存在未授权访问漏洞。
    *   攻击者可以调用此组件的方法，并传递恶意 CFML 代码。
    *   通过精心构造的 CFML 代码，可以加载远程 Java 类（利用 `java.net.URLClassLoader`）并执行。
2.  **漏洞利用方式:**
    *   **第一步：** 启动一个 HTTP 服务器 (`server.py`)，用于托管恶意 Java Payload (`file.java`)。
    *   **第二步：** 执行 Python 脚本 (`cve-2023-26360.py`)，该脚本向 ColdFusion 服务器发送恶意请求。
        *   请求包含 CFML 代码，该代码会创建 `java.net.URL` 对象，指向攻击者控制的 HTTP 服务器。
        *   CFML 代码使用 `java.net.URLClassLoader` 加载并执行远程 Java 类 (`metasploit.Payload`)，从而实现远程代码执行。
    *   `cve-2023-26360.py` 会重复调用 `trigger_urlclassloader` 函数5次，增加漏洞利用的成功率。
3.  **投毒风险评估：**
    *   `server.py` 从 `file.java` 文件读取payload,该文件内容攻击者可以自定义，存在一定的投毒风险，风险点在于java payload的恶意性。
    *   `cve-2023-26360.py` 脚本主要负责构造和发送 HTTP 请求，以及执行 CFML 代码，本身不存在明显的投毒代码。但如果 `file.java` 包含恶意行为（例如安装后门、收集信息等），则可能存在投毒风险。
    *   综合考虑，该利用链中存在一定的投毒风险，主要体现在 Java Payload 的可控性上，存在一定风险。我个人认为投毒的概率是10%。
4.  **漏洞有效性：**
    根据漏洞描述、CISA KEV信息和提供的 POC 代码，该漏洞利用的有效性较高，已经在野利用。


**项目地址:** [H3rm1tR3b0rn/CVE-2023-26360-RCE](https://github.com/H3rm1tR3b0rn/CVE-2023-26360-RCE)

**漏洞详情:** [CVE-2023-26360](https://nvd.nist.gov/vuln/detail/CVE-2023-26360)