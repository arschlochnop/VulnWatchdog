## CVE-2014-6271 ShellShock

**漏洞编号:** CVE-2014-6271

**漏洞类型:** 命令注入

**影响应用:** GNU Bash

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 4.3

**利用条件:** 目标系统存在CGI脚本或其他方式允许通过环境变量影响Bash执行

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2014-6271，又名ShellShock，是GNU Bash中的一个严重漏洞。攻击者可以通过构造包含恶意代码的环境变量，当这些环境变量被传递给Bash执行的进程时，会导致远程代码执行。 

**有效性：** 提供的POC代码是有效的。它通过设置`User-Agent`头来传递恶意payload。如果目标URL指向一个CGI脚本，且该脚本使用Bash处理环境变量，那么攻击者就可以执行任意命令。POC代码还包含一个检查机制，如果URL不包含`/cgi-bin/status`，它会提示用户是否要添加该路径，这增加了攻击的灵活性。

**投毒风险：** 在提供的`exploit.py`和`README.md`文件中，没有发现任何明显的投毒代码。代码逻辑清晰，目标是利用ShellShock漏洞执行命令。没有发现作者尝试引入恶意行为，例如上传恶意文件、植入后门或窃取凭据。因此，投毒风险评估为0%。

**利用方式：** 

1.  **确定目标：** 找到运行存在漏洞的Bash版本的系统，该系统需要具有某种暴露点，该暴露点允许通过环境变量注入的方式利用Bash。常见的暴露点包括CGI脚本、OpenSSH的`ForceCommand`特性以及某些DHCP客户端。
2.  **构造Payload：** 构造一个包含恶意代码的环境变量。Payload的形式通常为`() { :; }; <command>`。其中`<command>`是要执行的shell命令。
3.  **传递Payload：** 将构造的Payload作为环境变量传递给Bash。对于CGI脚本，这可以通过设置HTTP头的`User-Agent`字段来实现，如提供的POC代码所示。在其他场景中，可能需要使用其他方法来设置环境变量。
4.  **执行命令：** 当Bash执行接收到包含Payload的CGI脚本时，它会解析环境变量，触发漏洞，并执行注入的命令。
5.  **验证执行结果:** POC脚本会打印出`page`的内容,命令执行的结果将会嵌入到返回的内容中.

**综上所述：** 提供的POC代码利用了ShellShock漏洞，通过构造恶意环境变量并在目标系统上触发执行，实现了远程命令执行。虽然漏洞利用风险很高，但提供的代码本身没有发现投毒风险。

**项目地址:** [mritunjay-k/CVE-2014-6271](https://github.com/mritunjay-k/CVE-2014-6271)

**漏洞详情:** [CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271)