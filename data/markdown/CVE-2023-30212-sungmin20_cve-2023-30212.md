## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** XSS

**影响应用:** OURPHP

**危害等级:** 中危，可能导致Cookie窃取、页面重定向等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接或访问被注入恶意代码的页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212是OURPHP 7.2.0及更早版本中存在的一个跨站脚本（XSS）漏洞，位于/client/manage/ourphp_out.php文件中。根据漏洞库信息和搜索结果，这是一个反射型XSS漏洞。

**有效性：**
根据搜索结果（特别是GitHub仓库链接）以及CISA的漏洞丰富信息,存在可利用的Docker POC，表明漏洞利用具有一定的有效性。

**投毒风险：**
提供的漏洞利用代码（Dockerfile、docker-compose.yaml、README.md）主要用于搭建存在漏洞的OURPHP环境，以便复现和验证CVE-2023-30212漏洞。其中`vulnerable.php`模拟存在漏洞的文件，`malicious.php` 则用于执行系统命令。
Dockerfile 会修改apache的监听端口，这可能会影响后续的一些其他的测试。

分析`README.md`文件，该文件提供了详细的PoC步骤，包括如何通过LFI读取`malicious.php`的内容，以及如何执行其中的命令。

总体来说，这些代码的目的是为了验证漏洞，但仍存在潜在的投毒风险，例如：
*   **修改后的镜像可能包含其他恶意软件：** 虽然提供的代码没有直接表现出投毒行为，但如果Dockerfile被修改，加入了额外的恶意软件安装或配置，则可能存在投毒风险。
*   **诱导下载包含恶意代码的镜像：** 攻击者可能创建包含恶意后门的docker image，并且引导用户下载。

因此，在拉取和使用第三方提供的Docker镜像时，务必进行安全审查，确保镜像来源可信。 综合考虑，代码本身主要用于漏洞验证，但存在一定的潜在风险，因此投毒风险占比为10%。

**利用方式：**
1.  **找到/client/manage/ourphp_out.php中存在反射型XSS的参数。**
2.  **构造包含恶意JavaScript代码的URL。**
3.  **诱导管理员或用户点击该URL。**
4.  **用户的浏览器执行恶意JavaScript代码，从而窃取Cookie、重定向页面等。**

例如，攻击者可以构造如下URL：`http://example.com/client/manage/ourphp_out.php?参数=<script>alert('XSS')</script>`，当用户访问该URL时，会弹出一个包含"XSS"的警告框，证明XSS漏洞存在。

实际利用中，攻击者会将`alert('XSS')`替换为更具危害性的恶意代码，例如：窃取Cookie并发送到攻击者的服务器，或者将用户重定向到钓鱼网站。

**项目地址:** [sungmin20/cve-2023-30212](https://github.com/sungmin20/cve-2023-30212)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)