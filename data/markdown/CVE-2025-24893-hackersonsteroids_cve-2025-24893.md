## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki Platform

**危害等级:** 严重，允许未经身份验证的远程代码执行

**影响版本:** 5.3-milestone-2, < 15.10.11 和 >= 16.0.0-rc-1, < 16.4.1

**利用条件:** 目标系统需要暴露XWiki服务，且未应用补丁

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-24893 是 XWiki Platform 中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过向 `SolrSearch` 发送恶意请求来执行任意代码。根据漏洞库信息和搜索结果，该漏洞源于 `SolrSearch` 宏中输入验证不足。

**有效性：**
根据搜索结果和漏洞库信息，该漏洞是真实存在的，并且存在可用的PoC代码。提供的PoC代码是一个Python脚本，它利用了 XWiki 的 `SolrSearch` 宏中的 Groovy 代码注入漏洞。

**利用方式：**
1.  脚本首先尝试通过 HTTPS 和 HTTP 连接目标 XWiki 实例，确定可用的协议。
2.  然后，它构造一个包含恶意 Groovy 代码的 URL，该代码使用 `ProcessBuilder` 执行反向 shell 命令。
3.  脚本对 URL 进行编码，并将其发送到 `/xwiki/bin/get/Main/SolrSearch?media=rss&text=` 端点。
4.  如果目标易受攻击，它将执行 Groovy 代码并建立反向 shell 连接到攻击者的机器。

**投毒风险：**
分析提供的 PoC 代码，没有发现明显的恶意代码或后门。该脚本主要功能是利用漏洞执行命令，未发现其他恶意行为。
主要风险在于脚本中使用的反向shell，它会将目标的访问权限交给攻击者。
基于代码审查，投毒的可能性较低，可以忽略。

**总结：**
CVE-2025-24893 是 XWiki Platform 中的一个严重漏洞，允许未经身份验证的远程代码执行。提供的 PoC 代码可以有效地利用此漏洞。虽然 PoC 本身没有明显的投毒迹象，但使用任何漏洞利用代码都存在风险，应谨慎使用。

**项目地址:** [hackersonsteroids/cve-2025-24893](https://github.com/hackersonsteroids/cve-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)