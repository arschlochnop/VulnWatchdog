## CVE-2019-0708 (BlueKeep)

**漏洞编号:** CVE-2019-0708

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Remote Desktop Services (RDP)

**危害等级:** 高危，可能导致系统完全控制

**影响版本:** Windows 7 SP1, Windows Server 2008 R2 SP1, Windows Server 2008 SP2等受影响版本

**利用条件:** 目标系统开启RDP服务，且未安装相关补丁。攻击者需要网络连接到目标系统的RDP端口（默认为3389）。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-0708，也被称为BlueKeep，是Windows远程桌面服务中的一个远程代码执行漏洞。未经身份验证的攻击者可以通过RDP协议发送特制的请求来利用此漏洞，从而在目标系统上执行任意代码。

**有效性：**
提供的POC代码包含一个Python脚本`cve-2019-0708_v2.py`，该脚本使用`0708Detector_v2_x64.exe`检测目标IP是否存在CVE-2019-0708漏洞。如果检测到漏洞，脚本会将存在漏洞的IP地址保存到`vulnerable_ips.txt`文件中。根据文件名称和其他信息，这个是无损扫描器，只用于检测，利用性取决于检测工具的准确性，从描述上来看，poc本身是有效的，可以用来扫描指定网段或者文件中的目标是否存在漏洞。

**投毒风险：**
代码本身主要的功能是调用外部程序进行漏洞扫描，存在一定的投毒风险。脚本本身的代码相对简单，主要逻辑是执行外部的`0708Detector_v2_x64.exe`文件，并根据其输出来判断目标是否易受攻击。`0708Detector_v2_x64.exe` 是二进制文件，无法直接审查其内容，因此存在潜在的恶意行为风险。如果该二进制文件被篡改，可能会执行恶意操作，例如安装后门、收集信息或进行其他未经授权的活动。由于二进制文件缺乏透明性，难以保证其安全性，投毒风险为10%。

**利用方式：**
1.  **漏洞扫描：** 使用提供的Python脚本`cve-2019-0708_v2.py`，该脚本依赖于`0708Detector_v2_x64.exe`，扫描目标网络或IP列表，检测是否存在CVE-2019-0708漏洞。
2.  **RDP连接：** 攻击者需要能够通过RDP协议连接到目标系统。
3.  **构造恶意请求：** 利用专门为此漏洞设计的漏洞利用代码（通常不包含在扫描器中，需要另外寻找），构造包含恶意载荷的RDP请求。
4.  **远程代码执行：**  发送恶意请求到目标系统，成功利用漏洞后，攻击者可以在目标系统上执行任意代码，从而完全控制系统。

**项目地址:** [hualy13/CVE-2019-0708-Check](https://github.com/hualy13/CVE-2019-0708-Check)

**漏洞详情:** [CVE-2019-0708](https://nvd.nist.gov/vuln/detail/CVE-2019-0708)