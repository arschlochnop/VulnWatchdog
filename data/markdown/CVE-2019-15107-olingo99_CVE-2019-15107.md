## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.920

**利用条件:** 目标系统运行Webmin <= 1.920，攻击者可以网络访问到Webmin服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

根据漏洞库信息和搜索结果，CVE-2019-15107 漏洞存在于 Webmin 1.920 及更早版本中。`password_change.cgi` 文件的 `old` 参数存在命令注入漏洞，未经身份验证的攻击者可以利用此漏洞执行任意系统命令。

**有效性：**

提供的 POC 代码是一个 Python 脚本，它通过向 `password_change.cgi` 发送 POST 请求来利用该漏洞。脚本构造包含嵌入恶意命令的 `old` 参数，从而实现远程代码执行。脚本中使用了反向shell的方法。

**投毒风险：**

查看 `/tmp/9fc0aaa0410e764ea588c0f0642d3823/myexploit.py` 脚本内容，没有发现明显的恶意代码，仅包含漏洞利用代码，用于建立反向 shell。该仓库中的投毒风险评估为 0%。

**利用方式：**

1.  攻击者首先需要确定目标系统上运行的 Webmin 版本小于等于 1.920。
2.  攻击者构造包含恶意命令的 HTTP POST 请求，并将该请求发送到 `password_change.cgi` 文件的目标服务器。
3.  服务器收到请求后，由于没有对 `old` 参数进行充分的过滤，恶意命令被执行。
4.  恶意命令通常会建立一个反向 shell，允许攻击者远程控制目标系统。

脚本会修改`myIp`和`myPort` ,在攻击机上监听端口，然后执行脚本即可。 



**项目地址:** [olingo99/CVE-2019-15107](https://github.com/olingo99/CVE-2019-15107)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)