## CVE-2025-1974 - Ingress-nginx Admission Controller RCE

**漏洞编号:** CVE-2025-1974

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ingress-nginx

**危害等级:** 高危，CVSS 9.8 (Critical)，可能导致集群权限接管，敏感信息泄露

**影响版本:** <= 1.11.4, 1.12.0

**利用条件:** 需要能够访问Pod网络，且目标系统使用了受影响版本的ingress-nginx并启用了Validating Admission Controller

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-1974 存在于 Kubernetes ingress-nginx 的 Validating Admission Controller 中。未经身份验证的攻击者如果能够访问 Pod 网络，即可通过构造恶意的 Ingress 对象，向 Nginx 配置中注入恶意指令，从而实现远程代码执行。漏洞利用通过发送特制的 AdmissionReview 请求到 admission controller，注入恶意配置到 Nginx，进而导致 RCE。POC代码 `poc.py` 演示了如何利用此漏洞。该代码构建一个包含恶意配置的 Ingress 对象，通过AdmissionReview API发送到ingress-nginx的admission controller，从而在ingress-nginx controller pod中执行任意代码，实现反弹shell。该仓库存在轻微投毒风险，因为shellcode 可以被替换为任何其他恶意代码，但该代码本身利用的是合法的功能，而非隐藏的后门代码。风险较低。

**项目地址:** [hi-unc1e/CVE-2025-1974-poc](https://github.com/hi-unc1e/CVE-2025-1974-poc)

**漏洞详情:** [CVE-2025-1974](https://nvd.nist.gov/vuln/detail/CVE-2025-1974)