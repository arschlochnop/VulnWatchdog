## CVE-2025-57819-FreePBX-身份验证绕过导致SQL注入和RCE

**漏洞编号:** CVE-2025-57819

**漏洞类型:** 身份验证绕过/SQL注入/远程代码执行

**影响应用:** FreePBX

**危害等级:** 严重，可能导致完全控制系统

**影响版本:** < 15.0.66, < 16.0.89, < 17.0.3

**利用条件:** FreePBX实例可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-57819 是 FreePBX 的一个严重漏洞，允许未经身份验证的攻击者绕过身份验证，执行任意 SQL 注入，最终导致远程代码执行 (RCE)。漏洞存在于未充分清理用户提供的数据的 FreePBX 15、16 和 17 版本中。根据搜索引擎结果和漏洞库信息，此漏洞的 CVSS 评分高达 10.0，表明最大严重性。漏洞利用方式是利用用户输入验证不足，攻击者可以构造恶意请求，绕过身份验证，然后注入 SQL 代码以操纵数据库，并最终执行任意系统命令。

提供的 POC 代码 (check.sh) 实际上是一个入侵检测脚本 (IoC scan)，用于检测 CVE-2025-57819 的攻击痕迹，而不是一个漏洞利用脚本。该脚本检查 FreePBX 配置文件是否存在，检测是否存在遗留的利用文件，并检查 Apache 日志中是否存在对 modular.php 的 POST 请求。它还提供手动步骤，以审查 MariaDB/MySQL 日志和 ampusers 表。

**有效性：** 根据已获得信息，该漏洞确实存在。PoC 代码虽然不是直接的漏洞利用代码，但可用于检测系统是否已被攻陷。

**投毒风险：** 该 check.sh 脚本本身不包含任何明显的恶意代码。然而，代码中提及的外部网站 https://sucurilabs.com 和 LinkedIn 链接 https://www.linkedin.com/company/sucurilabs 以及作者信息SucuriLabs，都有可能被篡改，引导用户访问恶意站点或下载恶意软件。 此外，该脚本建议手动检查日志和数据库，可能存在引导用户执行错误操作的风险。因此，存在较低的投毒风险，大约为 10%。

**利用方式：** 漏洞利用方式涉及通过构造恶意的 HTTP 请求（通常是 POST 请求），向 FreePBX 服务器发送包含恶意 SQL 注入代码的未经过滤的用户输入。由于身份验证绕过漏洞，攻击者无需提供有效的凭据即可执行此操作。成功的 SQL 注入可用于修改数据库中的数据（例如，添加具有管理员权限的用户），或者执行存储过程来执行任意系统命令，从而实现 RCE。


**项目地址:** [Sucuri-Labs/CVE-2025-57819-ioc-check](https://github.com/Sucuri-Labs/CVE-2025-57819-ioc-check)

**漏洞详情:** [CVE-2025-57819](https://nvd.nist.gov/vuln/detail/CVE-2025-57819)