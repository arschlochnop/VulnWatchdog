## CVE-2016-2098 - Ruby on Rails Action Pack 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails Action Pack

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 3.2.22.2之前, 4.x before 4.1.14.2, and 4.2.x before 4.2.5.2

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2016-2098 漏洞存在于 Ruby on Rails 的 Action Pack 组件中，由于对`render`方法的使用方式不当，允许远程攻击者执行任意 Ruby 代码。攻击者通过向`render`方法传递恶意构造的输入，可执行服务器端代码。漏洞利用代码 (POC) 表明，攻击者可以通过控制渲染的内容来注入恶意代码。提供的`Gemfile`和`Gemfile.lock`是 Rails 项目的依赖描述文件，用于指定项目所依赖的 Ruby Gems 及其版本。这些文件本身没有直接包含恶意代码，但它们指定了存在漏洞的 Rails 版本 (4.2.5.1)。

**有效性:**
提供的POC代码 (实际上是 Rails 项目的依赖描述文件) 与漏洞描述中受影响的版本一致，因此，如果目标应用使用存在漏洞的 Rails 版本并且允许用户可控的输入传递给`render`方法，那么该漏洞可以被成功利用。

**投毒风险:**
`Gemfile` 和 `Gemfile.lock` 文件本身不包含可执行代码，因此直接的投毒风险较低。但是，如果攻击者能够控制应用程序使用的 Gems 仓库或者能够篡改应用程序使用的 Gems，则可能存在通过引入被篡改的 Gems 来投毒的风险。对这些依赖项的评估表明，其中不太可能存在直接的投毒代码。投毒风险评估为5%。

**利用方式:**
利用方式是向易受攻击的 Rails 应用发送包含恶意参数的请求，这些参数会被传递给`render`方法，从而执行攻击者指定的 Ruby 代码。 例如，攻击者可以构造一个包含恶意代码的字符串，并将其作为模板名称或局部变量传递给`render`方法。当 Rails 应用尝试渲染该模板或使用该局部变量时，恶意代码就会被执行。根据 exploit-db 的 40086 描述，可以使用 `render :inline` 来执行代码。

**项目地址:** [Alejandro-MartinG/rails-PoC-CVE-2016-2098](https://github.com/Alejandro-MartinG/rails-PoC-CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)