## CVE-2023-25157-GeoServer-SQL注入

**漏洞编号:** CVE-2023-25157

**漏洞类型:** SQL注入

**影响应用:** GeoServer

**危害等级:** 严重，可导致数据泄露、篡改、拒绝服务，甚至远程代码执行

**影响版本:** < 2.21.4, >= 2.22.0, < 2.22.2

**利用条件:** 需要能够访问存在漏洞的GeoServer实例

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-25157是GeoServer中的一个SQL注入漏洞。根据漏洞库信息，该漏洞存在于OGC Filter表达式语言和OGC Common Query Language (CQL) 中，影响Web Feature Service (WFS)和Web Map Service (WMS) 协议，以及Web Coverage Service (WCS) 协议的ImageMosaic覆盖。搜索引擎结果也证实了该漏洞的存在，并提供了相关的分析报告和修复建议。漏洞利用代码（Go语言编写的POC）首先检查GeoServer实例是否存活，然后尝试列出可用的feature names，接着针对每个feature name, 结合CQL_FILTER，尝试使用`strEndsWith` 函数注入恶意的SQL语句。这个恶意SQL尝试执行 `SELECT current_user`。由于Go语言代码本身主要用于验证和利用漏洞，不存在明显的后门或者恶意代码。但需要注意的是，该POC代码可能被恶意使用者修改后进行传播，加入恶意代码，因此存在一定的投毒风险。该漏洞利用方式主要依赖于构造恶意的CQL_FILTER，其中包含SQL注入语句，如果GeoServer实例未能正确过滤或转义这些输入，则可能执行攻击者构造的SQL查询，导致信息泄露或权限提升。

**项目地址:** [7imbitz/CVE-2023-25157-checker](https://github.com/7imbitz/CVE-2023-25157-checker)

**漏洞详情:** [CVE-2023-25157](https://nvd.nist.gov/vuln/detail/CVE-2023-25157)