## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问敏感数据和操作

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要部署受影响版本的Next.js应用，且应用使用了中间件进行授权检查。

**POC 可用性:** 是，但提供的POC仅包含README.md文件，需要进一步研究以确认利用方式。

**投毒风险:** 10%

## 详情

CVE-2025-29927 漏洞存在于 Next.js 中，允许攻击者绕过中间件中的授权检查。漏洞影响的版本包括 11.1.4 到 13.5.6，14.0.0 到 14.2.25，以及 15.0.0 到 15.2.3。根据漏洞描述，可以通过某种方式构造请求绕过中间件的授权逻辑。修复建议是升级到 14.2.25 或 15.2.3 及以上版本。由于提供的POC代码仅包含README.md，无法直接验证漏洞，有效性需要进一步评估。但是，根据搜索结果中的信息，该漏洞已被广泛讨论，并且存在可利用的攻击方法。关于投毒风险，由于提供的POC非常简单，仅包含一个 README 文件，因此存在作者隐藏恶意代码的可能性较低，估计约为10%。

**利用方式：**

1.  **理解中间件授权逻辑：** 攻击者需要分析目标 Next.js 应用的中间件代码，了解其授权检查的方式。例如，中间件可能会检查用户的身份验证状态、角色或权限。
2.  **构造恶意请求：** 攻击者需要构造一个特定的 HTTP 请求，该请求能够绕过中间件的授权检查。从漏洞描述中的`x-middleware-subrequest` header来看，可能与内部子请求有关。攻击者可以通过模拟或篡改此请求头，或通过其他方式，使中间件的授权逻辑失效。
3.  **访问受保护资源：** 成功绕过授权后，攻击者就可以访问原本需要授权才能访问的资源，例如敏感数据、管理页面等。

**项目地址:** [0xPThree/next.js_cve-2025-29927](https://github.com/0xPThree/next.js_cve-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)