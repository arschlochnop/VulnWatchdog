## CVE-2025-32463-Sudo-本地权限提升

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地权限提升

**影响应用:** Sudo

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32463 漏洞存在于 Sudo 1.9.14 到 1.9.17p1 版本中。该漏洞允许本地用户通过 `--chroot` 选项获得 root 权限。漏洞的根本原因是 Sudo 在使用 `--chroot` 选项时，会使用用户可控目录下的 `/etc/nsswitch.conf` 文件。

**利用方式：**

1.  创建一个临时目录作为 chroot 的根目录 (STAGE)。
2.  在临时目录下创建 `woot/etc` 目录。
3.  在 `woot/etc/nsswitch.conf` 文件中指定使用 `/woot1337` 作为 `passwd` 的查找源。
4.  创建一个动态链接库 `libnss_/woot1337.so.2`，其中包含一个 `woot()` 函数，该函数在库加载时执行，设置 `reuid` 和 `regid` 为 0，然后执行 `/bin/bash`。
5.  使用 `sudo -R woot woot` 命令，该命令会 chroot 到 `STAGE/woot` 目录，并加载 `libnss_/woot1337.so.2` 动态链接库。
6.  由于 `libnss_/woot1337.so.2` 库中的 `woot()` 函数被执行，攻击者将获得 root shell。

**有效性：**

根据漏洞库信息和搜索引擎结果，该漏洞是真实存在的，且提供的 PoC 代码能够成功利用该漏洞。

**投毒风险：**

PoC 代码本身主要包含创建临时目录、构建恶意 `nsswitch.conf` 文件、编译共享库、以及执行 `sudo -R` 命令。`woot1337.c` 会创建一个提权后的shell，这不是投毒行为，而是利用漏洞的正常行为。没有发现作者隐藏的任何恶意代码或者后门。因此投毒风险评估为 0%。


**项目地址:** [4f-kira/CVE-2025-32463](https://github.com/4f-kira/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)