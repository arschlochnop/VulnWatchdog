## CVE-2024-24919 Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露，如系统配置、用户凭据等

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network), R81.10, R80.20 (Spark Gateway)

**利用条件:** 需要目标设备已连接互联网，并启用远程接入VPN或移动接入软件 blades

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919是一个存在于Check Point Security Gateway中的信息泄露漏洞。攻击者可以通过发送特制的请求，读取目标设备上的任意文件。从搜索结果和POC代码来看，攻击者通过构造包含路径遍历的POST请求到`/clients/MyCRL`端点，可以读取`/etc/passwd`, `/etc/shadow`等敏感文件。POC代码中的`send_request`函数模拟了攻击过程，通过`requests.post`发送请求，并验证返回状态码，实现了漏洞验证。 漏洞利用方式主要为利用路径穿越读取敏感信息。

**有效性：**
POC代码有效，能够利用路径穿越读取敏感文件。

**投毒风险：**
该POC代码主要用于信息泄露，但存在一定的潜在投毒风险。 代码中存在requests库未指定版本, 若安装最新版requests 库, 存在被上游投毒风险, 风险较低。代码本身的功能是读取文件，并没有发现直接执行恶意代码的部分。但是，如果攻击者能够利用此漏洞读取到包含凭据的配置文件，就有可能进一步控制目标系统。

**利用方式：**
1.  目标设备需开启远程接入VPN或移动接入软件 blades，且能被互联网访问。
2.  使用POC脚本，指定目标IP地址和端口。
3.  通过选择预设的文件路径或自定义路径，构造包含路径穿越的POST请求，发送到`/clients/MyCRL`端点。
4.  如果请求成功，脚本会打印出读取到的文件内容。
5.  攻击者可以利用泄露的敏感信息，进一步入侵目标系统。


**项目地址:** [0xlf/CVE-2024-24919](https://github.com/0xlf/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)