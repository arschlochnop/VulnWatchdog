## CVE-2025-59246 - Azure Entra ID 权限提升漏洞

**漏洞编号:** CVE-2025-59246

**漏洞类型:** 权限提升

**影响应用:** Microsoft Entra ID

**危害等级:** 高危，可能导致完全控制组织身份管理和Azure资源

**影响版本:** N/A (影响所有未修复版本)

**利用条件:** 需要网络访问 Entra ID Graph API Endpoint

**POC 可用性:** 是 (可能需购买)

**投毒风险:** 75%

## 详情

CVE-2025-59246 描述了一个 Microsoft Entra ID 中的权限提升漏洞。根据漏洞库信息，该漏洞是由于关键功能的身份验证缺失 (CWE-306)。CVSS 评分高达 9.8，表明其危害性极高。描述表明未经身份验证的攻击者可以利用此漏洞获得管理员权限。

从提供的漏洞利用代码来看，这是一个概念验证 (POC) 代码，旨在演示 CVE-2025-59246 漏洞。自述文件说明了该漏洞影响 Entra ID Graph API 扩展中的一个关键管理端点，允许远程攻击者在没有凭据或用户交互的情况下分配高权限角色（例如全局管理员）。漏洞利用是通过 Entra ID 服务主体管理层中的一个内部 API 路由实现的，由于身份验证中间件中的疏忽，角色分配功能的请求在通过特定端点路由时会绕过令牌验证。该漏洞利用代码的作者声明该漏洞已在生产 Entra ID 租户上成功利用，成功率高达 95%。

**有效性：**
根据POC描述和漏洞信息，此漏洞利用的有效性较高。POC代码已经验证了该漏洞的存在，并说明了漏洞的利用方式。

**投毒风险：**
虽然POC的README.md本身没有直接的投毒代码，但存在以下风险：
1.  **代码完整性：** 由于完整的漏洞利用代码需要购买才能获得，因此无法直接评估实际代码是否存在恶意代码。考虑到作者的联系方式是一个公开的邮箱，并且声称提供漏洞利用视频，这暗示可能存在后门或者信息收集的风险。
2.  **依赖风险：** 购买的漏洞利用代码可能包含恶意依赖项，这些依赖项可能会在目标系统上执行恶意操作。
3. **利用不当：** 该漏洞利用代码如果被恶意人员利用，可能会对目标系统造成严重损害。

因此，尽管提供的README.md文件没有明确的投毒代码，但考虑到完整代码需要购买以及潜在的供应链风险，存在相当高的投毒风险(75%)。

**利用方式：**
1.  攻击者识别未修补的 Azure Entra ID 实例。
2.  攻击者通过特定端点向 Entra ID Graph API 发送未经验证的请求。
3.  请求绕过身份验证检查。
4.  攻击者通过绕过的身份验证，将高权限角色（例如全局管理员）分配给攻击者控制的帐户或服务主体。
5.  攻击者使用新获得的权限完全控制受害组织的 Entra ID 租户及其关联的 Azure 资源。

**项目地址:** [callinston/CVE-2025-59246](https://github.com/callinston/CVE-2025-59246)

**漏洞详情:** [CVE-2025-59246](https://nvd.nist.gov/vuln/detail/CVE-2025-59246)