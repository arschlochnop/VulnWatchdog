## CVE-2024-9756 - Order Attachments for WooCommerce 未授权文件上传

**漏洞编号:** CVE-2024-9756

**漏洞类型:** 未授权文件上传

**影响应用:** Order Attachments for WooCommerce

**危害等级:** 中危，可能允许攻击者上传恶意文件，导致远程代码执行或信息泄露

**影响版本:** 2.0 - 2.4.1

**利用条件:** 需要WordPress站点启用该插件，且攻击者拥有Subscriber或更高权限的账户

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9756 存在于 WordPress 的 Order Attachments for WooCommerce 插件的 2.0 到 2.4.1 版本中。由于 `wcoa_add_attachment` AJAX action 缺少权限检查，认证后的攻击者（具有 Subscriber 级别或更高级别的权限）可以上传受限制的文件类型。 

**利用方式:**

1.  攻击者需要一个 WordPress 账户，权限至少为 Subscriber。
2.  攻击者利用提供的 Python 脚本，首先使用用户名和密码进行身份验证。
3.  脚本构造一个 POST 请求，将恶意文件上传到 `/wp-admin/admin-ajax.php`，`action` 参数设置为 `wcoa_add_attachment`，并提供 `order_id`。
4.  由于缺少权限验证，服务器允许上传受限制的文件类型到指定的订单。
5.  攻击者可以通过服务器返回的URL访问上传的文件。

**投毒风险分析:**

检查提供的漏洞利用代码，发现该脚本主要功能是利用漏洞上传文件。它包含身份验证、文件上传和响应分析等步骤。虽然脚本本身可以被滥用，但没有发现明显的恶意代码，例如反弹 shell 或植入后门等。LICENSE表明作者保留所有权利，且DISCLAIMER声明该脚本仅用于教育和安全研究目的。考虑到代码的简洁性，以及没有发现任何隐藏的恶意行为，初步评估投毒风险较低。作者可能是通过修改代码来达到控制的目的，需要进一步分析才能确定。



**项目地址:** [Nxploited/CVE-2024-9756](https://github.com/Nxploited/CVE-2024-9756)

**漏洞详情:** [CVE-2024-9756](https://nvd.nist.gov/vuln/detail/CVE-2024-9756)