## CVE-2025-0282-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-0282

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Connect Secure <= 22.7R2.4, Policy Secure <= 22.7R1.2, Neurons for ZTA gateways <= 22.7R2.3

**利用条件:** 需要网络访问，目标系统运行受影响的Ivanti产品及版本。

**POC 可用性:** 是

**投毒风险:** 75%

## 详情

CVE-2025-0282是Ivanti Connect Secure、Policy Secure和Neurons for ZTA网关中存在的一个栈溢出漏洞。未经验证的远程攻击者可以通过向`/dana-na/auth/url_default/welcome.cgi`端点发送特制的POST请求来利用此漏洞，实现远程代码执行。

**有效性评估：**

根据漏洞库信息、搜索引擎结果（如Rapid7、Google Cloud的分析）和提供的PoC代码，该漏洞被积极利用，且PoC代码旨在演示远程代码执行。 综合判断PoC代码是有效的。

**投毒风险分析：**

PoC代码存在很高的投毒风险，主要基于以下几点：

1.  **联系方式：** README中要求联系Telegram获取完整代码，这本身就增加了中间人攻击和代码篡改的风险。
2.  **OpenAI依赖：** PoC依赖 OpenAI API 获取系统地址、退出地址和shellcode，将漏洞利用的关键步骤外包给第三方服务，增加代码行为不可预测性，若 OpenAI 返回恶意内容，则可能被利用进行投毒。OPENAI_API_KEY 被代码托管者标记为 XXXX， 这意味着需要用户自行填写，存在让使用者意外使用付费API的可能性。
3.  **MongoDB存储：** PoC将利用结果存储在本地MongoDB数据库中，这虽然看似无害，但可能用于追踪用户行为或收集敏感信息，作者可以在MongoDB中预置恶意数据。
4.  **重试机制：** PoC包含重试机制，这可能被滥用，例如，在成功后植入后门。
5.  **Payload生成方式：** PoC结合msfvenom或OpenAI生成shellcode。虽然msfvenom是常用工具，但如果OpenAI生成恶意shellcode，则存在风险。

综上所述，PoC代码的投毒风险较高。尽管其目的是演示漏洞，但依赖第三方服务、不透明的代码获取方式以及可能存在的恶意代码植入都增加了风险。

**利用方式：**

1.  攻击者构造恶意的POST请求，发送到`/dana-na/auth/url_default/welcome.cgi`端点。
2.  该请求包含精心构造的payload，目的是覆盖栈上的返回地址。
3.  利用ROP（Return-Oriented Programming）绕过ASLR，执行攻击者注入的shellcode。
4.  Shellcode执行后，攻击者可以获得目标系统的控制权，例如反向shell。
5.  PoC代码尝试连接目标，从 OpenAI API 获取地址和 shellcode, 生成 payload, 然后发送 payload。 它验证 payload 并尝试再次连接直到成功。

**项目地址:** [AnonStorks/CVE-2025-0282-Full-version](https://github.com/AnonStorks/CVE-2025-0282-Full-version)

**漏洞详情:** [CVE-2025-0282](https://nvd.nist.gov/vuln/detail/CVE-2025-0282)