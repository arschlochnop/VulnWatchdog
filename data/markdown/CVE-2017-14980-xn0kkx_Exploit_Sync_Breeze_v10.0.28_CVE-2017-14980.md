## CVE-2017-14980-Sync Breeze Enterprise-缓冲区溢出

**漏洞编号:** CVE-2017-14980

**漏洞类型:** 缓冲区溢出

**影响应用:** Sync Breeze Enterprise

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 10.0.28

**利用条件:** 需要网络访问 Sync Breeze Enterprise 的Web服务，目标系统运行在Windows系统上，存在libspp.dll库，且该库的地址空间中存在 JMP ESP 指令。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 Sync Breeze Enterprise 10.0.28 的 /login 接口，由于程序没有充分验证 username 参数的长度，导致缓冲区溢出。攻击者可以通过发送包含超长 username 参数的POST请求到/login接口来触发漏洞。利用代码 `Sync_Breeze_Exploit.c`  构造了一个HTTP POST请求，其中username参数包含大量的 'A' 字符（padding）、返回地址（retn，指向libspp.dll中的JMP ESP指令地址 0x10090c83），以及shellcode。该shellcode旨在执行恶意操作。代码通过 Winsock 库建立 TCP 连接，发送构造的恶意请求，从而利用该漏洞。`syncbreeze_exploit.py`文件为空，所以不能使用python代码复现。

**有效性：** 根据漏洞信息和提供的漏洞利用代码，该POC代码针对 Sync Breeze Enterprise 10.0.28 的缓冲区溢出漏洞，并通过覆盖返回地址到 JMP ESP 指令来执行 shellcode，因此，该POC代码是有效的。需要注意的是，shellcode 是一个 Payload，如果想要在不同环境中成功运行，可能需要根据目标系统的具体情况进行调整，例如关闭DEP。此外，exp中指定的地址和目标IP需要根据实际情况修改。

**投毒风险：** 分析 C 语言的漏洞利用代码后，shellcode 部分虽然看起来比较复杂，但是并没有发现明显的恶意行为或者后门代码。这段代码是一个用于测试的shellcode，并没有明显的危害行为。文件名中包含"Иван-дурак"，可能作者来自俄罗斯，但这本身不能说明存在投毒。`README.md` 文件仅仅是对漏洞利用的简单描述，没有可疑代码。但是文件`syncbreeze_exploit.py`文件为空，并没有实际用途，说明文件没有编写完整。综合来看，该仓库中存在作者隐藏的投毒代码的可能性较小，估算为 10%。

**利用方式：** 
1.  **确定目标系统:** 目标系统运行着存在漏洞的 Sync Breeze Enterprise 10.0.28。
2.  **网络连接:** 攻击者需要能够通过网络访问目标系统的Web服务。
3.  **构造恶意请求:**  构造包含恶意 username 参数的 HTTP POST 请求。username 参数需要足够长以覆盖缓冲区，并包含 shellcode 和指向 JMP ESP 指令的返回地址。
4.  **发送请求:**  将构造的恶意请求发送到目标系统的 /login 接口。
5.  **Shellcode执行:**  当目标系统处理该请求时，缓冲区溢出将覆盖返回地址，并跳转到 JMP ESP 指令，最终执行攻击者提供的 shellcode。如果shellcode成功执行，攻击者将可能获得目标系统的控制权。

**项目地址:** [xn0kkx/Exploit_Sync_Breeze_v10.0.28_CVE-2017-14980](https://github.com/xn0kkx/Exploit_Sync_Breeze_v10.0.28_CVE-2017-14980)

**漏洞详情:** [CVE-2017-14980](https://nvd.nist.gov/vuln/detail/CVE-2017-14980)