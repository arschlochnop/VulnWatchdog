## CVE-2025-24813 Apache Tomcat 路径等价漏洞

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价/反序列化

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 默认Servlet开启写入(默认关闭), 支持partial PUT(默认开启), 使用Tomcat文件session持久化(默认位置), 应用包含可被反序列化利用的库

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价漏洞，允许攻击者利用 'file.Name' (内部点) 绕过安全检查，导致远程代码执行、信息泄露或恶意内容注入。该漏洞利用方式主要依赖于 Tomcat 的 Default Servlet 和 partial PUT 功能。从提供的漏洞库信息和搜索引擎结果来看，该漏洞的利用需要满足多个前提条件：

1.  **Default Servlet 开启写入:** Tomcat 默认禁止 Default Servlet 写入，如果开启则存在风险。
2.  **支持 Partial PUT:**  Tomcat 默认支持 Partial PUT，攻击者可以分块上传文件。
3.  **应用程序使用基于文件的会话持久性，且使用默认存储位置:** 如果应用程序使用 Tomcat 的文件会话持久性，攻击者可以覆盖 session 文件。
4.  **应用包含可被反序列化利用的库:**  攻击者需要找到一个存在反序列化漏洞的库，并构造恶意的序列化对象。

提供的 POC 代码 `cve_2025_24813_poc.py` 看起来是一个较为完整的漏洞利用工具，具备以下功能：

*   多目标扫描和单目标利用。
*   自动检测可用的 gadget chain (CommonsCollections, BeanShell, Spring 等)。
*   操作系统检测和后渗透 payload (Linux/Windows)。
*   从常见 endpoint 中提取 Session ID。
*   支持 HTTPS 和 SSL 验证绕过。

**利用方式总结:**

1.  **检测目标 Tomcat 是否开启了 Default Servlet 的写入功能。**
2.  **如果开启，利用 Partial PUT 功能上传恶意构造的 session 文件。**
3.  **构造恶意的序列化对象，利用目标应用中存在的反序列化漏洞执行任意代码。**
4.  **如果无法直接 RCE，可以尝试利用路径等价漏洞覆盖敏感文件，造成信息泄露。**

**关于投毒风险分析:**

该漏洞利用代码的投毒风险较低 (5%)。虽然代码功能强大，但主要逻辑围绕着已知的漏洞利用展开。需要关注的地方是:

*   `os.system` 或 `subprocess.call` 这类函数，因为它们可以执行任意系统命令。代码中 `subprocess`被用于 `ysoserial` 命令执行,相对安全。
*   Payload 生成部分，需要确保 ysoserial 生成的 payload 符合预期，没有被篡改。
*   结果记录日志是否会在未授权的情况下,将数据上传到服务器.

综合来看，该 POC 具备较高的有效性，但使用时务必谨慎，并在授权环境下进行测试。

**项目地址:** [cyglegit/CVE-2025-24813](https://github.com/cyglegit/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)