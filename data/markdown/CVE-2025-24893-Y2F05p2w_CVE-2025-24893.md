## CVE-2025-24893-XWiki-RCE

**漏洞编号:** CVE-2025-24893

**漏洞类型:** 远程代码执行

**影响应用:** XWiki

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** 5.3-milestone-2 <= version < 15.10.11, 16.0.0-rc-1 <= version < 16.4.1

**利用条件:** XWiki实例可公开访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24893 漏洞存在于 XWiki 平台的 SolrSearch 宏中，允许未经身份验证的攻击者执行任意远程代码。该漏洞是由于 SolrSearch 宏未正确过滤用户提供的输入，导致了模板注入。

**有效性分析：**
提供的 POC 代码通过构造恶意的 SolrSearch 请求，利用 Groovy 脚本执行任意命令来验证漏洞的存在。该 POC 首先测试目标是否易受攻击，如果易受攻击，则进入交互式 shell，允许用户远程执行命令。该POC代码通过了漏洞库信息的验证,可以判定为有效。

**投毒风险分析：**
阅读POC代码后，没有发现任何明显的恶意行为或隐藏的后门。代码逻辑清晰，主要功能是利用已知的 SSTI 漏洞执行命令。代码中使用了requests库发送http请求，urllib.parse库对url进行编码，cmd 库构造交互式shell,bs4库用于解析HTML内容。debug 模式会输出请求的 URL 和响应内容，方便调试。 综合分析，投毒风险为 0%。

**利用方式：**

1.  **漏洞触发：**  攻击者通过发送特制的 HTTP 请求到 XWiki 服务器的 SolrSearch 接口触发漏洞。该请求包含恶意的 Groovy 代码，利用模板注入漏洞执行。
2.  **代码执行：**  XWiki 服务器在处理 SolrSearch 请求时，由于没有充分过滤用户输入，会将恶意 Groovy 代码作为模板执行，从而导致远程代码执行。
3.  **命令执行：**  攻击者可以利用执行的 Groovy 代码执行任意系统命令，控制 XWiki 服务器。

利用该漏洞，攻击者可以获取 XWiki 服务器的敏感信息、修改 XWiki 页面、甚至完全控制 XWiki 服务器。 

**项目地址:** [Y2F05p2w/CVE-2025-24893](https://github.com/Y2F05p2w/CVE-2025-24893)

**漏洞详情:** [CVE-2025-24893](https://nvd.nist.gov/vuln/detail/CVE-2025-24893)