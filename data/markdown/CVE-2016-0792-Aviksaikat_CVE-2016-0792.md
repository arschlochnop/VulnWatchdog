## CVE-2016-0792-Jenkins-反序列化RCE

**漏洞编号:** CVE-2016-0792

**漏洞类型:** 反序列化RCE

**影响应用:** Jenkins

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 低于1.650，LTS低于1.642.2

**利用条件:** 需要经过身份验证的用户访问Jenkins API端点

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-0792 漏洞是由于Jenkins在处理XML格式的反序列化数据时，使用了不安全的XStream库以及groovy.util.Expando，导致远程认证用户可以通过在XML文件中构造恶意序列化数据，在未打补丁的Jenkins服务器上执行任意代码。

**有效性：**

根据漏洞信息、搜索引擎结果以及提供的POC代码，该漏洞利用是有效的。搜索引擎结果中包含了Metasploit模块链接，Exploit-DB的链接，多个安全厂商的分析，以及Jenkins官方的安全公告，这些都表明该漏洞的真实性和可利用性。提供的Python POC代码也验证了这一点，该代码构造包含恶意序列化数据的XML文件，并尝试发送到Jenkins服务器以执行命令。

**投毒风险：**

评估提供的POC代码是否存在投毒风险。快速过了一遍POC代码，主要功能是构造恶意XML并发送到Jenkins实例，执行指定的命令。虽然代码本身存在安全风险（利用漏洞），但没有发现明显的、作者有意添加的恶意代码，例如删除文件、上传恶意程序等。风险来自于漏洞利用本身，而非代码作者的恶意行为。因此，代码本身的投毒风险较低,小于 1%。此处的'投毒'指的是作者在利用代码中隐藏了额外的恶意功能，而非指利用漏洞本身造成的危害。

**利用方式：**

1.  **身份验证：** 攻击者首先需要获得一个有效的Jenkins用户凭据。虽然漏洞本身是反序列化漏洞，但是需要通过Jenkins的API端点进行触发，而访问这些API通常需要一定的权限。
2.  **构造恶意XML：** 使用提供的POC代码或类似工具，构造包含恶意序列化数据的XML文件。这个XML文件利用了XStream库的反序列化漏洞，通过groovy.util.Expando对象来执行任意命令。
3.  **发送请求：** 将构造好的XML数据通过POST或其他HTTP方法发送到Jenkins服务器的某个API端点。具体端点未明确指定，但漏洞描述中指出是“多个未指定的API端点”。攻击者需要根据具体Jenkins实例的情况找到可用的端点。
4.  **执行命令：** Jenkins服务器在接收到包含恶意XML的请求后，会尝试反序列化XML数据。由于XStream库存在漏洞，反序列化过程会触发恶意代码的执行，从而在服务器上执行攻击者指定的命令。
5.  **权限获取：** 命令执行的权限通常与Jenkins进程的运行权限相同。攻击者可以利用该权限进一步提权或执行其他恶意操作。

**项目地址:** [Aviksaikat/CVE-2016-0792](https://github.com/Aviksaikat/CVE-2016-0792)

**漏洞详情:** [CVE-2016-0792](https://nvd.nist.gov/vuln/detail/CVE-2016-0792)