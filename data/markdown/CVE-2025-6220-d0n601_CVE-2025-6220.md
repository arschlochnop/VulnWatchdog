## CVE-2025-6220

**漏洞编号:** CVE-2025-6220

**漏洞类型:** 任意文件上传

**影响应用:** Ultimate Addons for Contact Form 7 (WordPress插件)

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 3.5.12

**利用条件:** 需要具备 WordPress 管理员权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

该漏洞存在于 Ultimate Addons for Contact Form 7 WordPress 插件中，版本小于等于 3.5.12。攻击者需要具备 WordPress 管理员权限。利用方式是通过登录 WordPress 后台，访问插件设置页面，抓取 uacf7_option_nonce 值，然后构造包含恶意 PHP 代码的上传请求，绕过文件类型检查，上传 webshell 到服务器，最终实现远程代码执行。 

**有效性:**  提供的 POC 代码有效，能够利用该漏洞上传 webshell。

**投毒风险:**  POC 代码本身主要目的是漏洞验证，后门是webshell,代码中用于上传的文件名为shell.php，内容为简单的命令执行。但存在极小的投毒风险（5%），例如：

*   **隐藏后门:** 攻击者可能在webshell代码中加入更隐蔽的后门，例如反弹shell、添加用户等，但POC代码中没有发现。
*   **依赖项风险:**  POC代码使用requests库，可能存在依赖项安全问题，但requests库本身安全性较高。

**利用方式:**

1.  **身份验证:** 使用提供的用户名和密码，通过 `wp_login` 函数登录到 WordPress 后台。此步骤模拟了攻击者获得管理员权限的场景。
2.  **获取 Nonce 值:** 访问 Ultimate Addons for Contact Form 7 的设置页面，使用正则表达式 `extract_uacf7_options_nonce` 提取 `uacf7_option_nonce` 的值。这个 nonce 值用于绕过 CSRF 保护。
3.  **构造上传请求:** 构造一个 multipart/form-data 请求，其中包含以下关键部分：
    *   `uacf7_current_page`:  设置为 `uacf7_settings_page`。
    *   `uacf7_option_nonce`:  设置为之前获取的 nonce 值。
    *   `action`: 设置为 `uacf7_options_save`。
    *   `file[]`:  包含要上传的 webshell 文件 (`shell.php`)。webshell内容为简单的get请求命令执行。
4.  **发送请求:**  将构造好的请求发送到 `wp-admin/admin-ajax.php`。
5.  **执行代码:** 成功上传 webshell 后，攻击者可以通过访问 webshell 文件，执行任意命令。

综合来看，该漏洞利用过程清晰，POC 代码完整，可以有效复现漏洞。

**项目地址:** [d0n601/CVE-2025-6220](https://github.com/d0n601/CVE-2025-6220)

**漏洞详情:** [CVE-2025-6220](https://nvd.nist.gov/vuln/detail/CVE-2025-6220)