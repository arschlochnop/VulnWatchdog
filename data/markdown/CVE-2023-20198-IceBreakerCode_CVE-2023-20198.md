## CVE-2023-20198 - Cisco IOS XE Web UI 权限提升

**漏洞编号:** CVE-2023-20198

**漏洞类型:** 权限提升

**影响应用:** Cisco IOS XE Software

**危害等级:** 高危，允许未授权的远程攻击者创建具有特权级别 15 的帐户，从而完全控制设备

**影响版本:** 16.1.1 to 17.12.1 and earlier versions

**利用条件:** Web UI 功能已启用并且设备易受攻击版本的影响。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-20198 是 Cisco IOS XE 软件 Web UI 中的一个漏洞，允许未经身份验证的远程攻击者在受影响的系统上创建具有特权级别 15 访问权限的帐户。 

**漏洞利用方式：**

1.  攻击者发送一个特制的 HTTP POST 请求到 `/webui/logoutconfirm.html?logon_hash=1` 端点，绕过身份验证。
2.  成功利用此漏洞后，攻击者可以执行任意命令，包括创建具有特权级别 15 的本地用户。
3.  然后，攻击者使用另一个漏洞（CVE-2023-20273）并通过新创建的本地用户权限提升到 root 权限，并将植入程序写入文件系统。

**有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，可以判定该漏洞的POC代码是有效的。漏洞库信息明确指出存在正在进行的漏洞利用活动。搜索结果也提供了多个关于该漏洞的深度分析和POC示例的链接，例如horizon3.ai上的POC代码。
提供的python脚本模拟了发送特制HTTP请求的过程，旨在检测目标系统是否存在漏洞。脚本会检查HTTP响应状态码和响应体内容，以判断是否存在潜在的植入程序。

**投毒风险：**

评估POC代码的投毒风险，需要仔细分析代码是否存在恶意行为，例如：
1.  **植入后门：**  代码是否在目标系统上安装未经授权的后门。
2.  **数据窃取：**  代码是否窃取敏感信息并发送到外部服务器。
3.  **拒绝服务：**  代码是否导致目标系统崩溃或无法正常运行。
4.  **恶意传播：**  代码是否试图感染其他系统。

分析提供的python脚本，该脚本主要用于检测漏洞是否存在，并未发现明显的恶意行为。脚本的功能是发送特定的HTTP请求并检查响应，以确定目标系统是否受到CVE-2023-20198漏洞的影响。然而，使用任何未经授权的漏洞利用代码都存在风险，因为代码的作者可能隐藏了不易察觉的恶意功能。因此，在使用任何POC代码之前，务必进行彻底的安全审查。

考虑到以上因素，判定该POC代码存在10%的投毒风险，主要是由于作者可能隐藏了一些不易察觉的恶意代码，但主要功能是漏洞验证。

**缓解措施：**

*   禁用 Web UI 功能，特别是当设备面向互联网时。
*   将 Web UI 访问限制为受信任的网络。
*   升级到已修复漏洞的 Cisco IOS XE 软件版本。

**项目地址:** [IceBreakerCode/CVE-2023-20198](https://github.com/IceBreakerCode/CVE-2023-20198)

**漏洞详情:** [CVE-2023-20198](https://nvd.nist.gov/vuln/detail/CVE-2023-20198)