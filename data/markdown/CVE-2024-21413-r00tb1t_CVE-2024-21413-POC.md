## CVE-2024-21413 - Microsoft Outlook远程代码执行漏洞

**漏洞编号:** CVE-2024-21413

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Outlook

**危害等级:** 严重，无需用户交互即可远程执行代码，可能导致完全控制受影响的系统。

**影响版本:** Microsoft Office 2016版本 < 16.0.5435.1001, Microsoft Office 2019版本 < https://aka.ms/OfficeSecurityReleases, Microsoft 365 Apps for Enterprise版本 < https://aka.ms/OfficeSecurityReleases, Microsoft Office LTSC 2021版本 < https://aka.ms/OfficeSecurityReleases

**利用条件:** 攻击者需要知道受害者的邮箱地址，并能够通过SMTP发送邮件。受害者需要点击邮件中的恶意链接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21413，也被称为“MonikerLink”漏洞，是一个存在于Microsoft Outlook中的零日漏洞。此漏洞允许攻击者通过发送特制的电子邮件在受害者计算机上执行任意代码，而无需任何用户交互。根据描述，利用方式是：攻击者发送包含恶意链接的电子邮件，当用户点击链接时，Outlook会尝试访问链接指向的`file:///` URL，导致执行攻击者控制的代码。提供的POC代码模拟了发送包含恶意链接的电子邮件的过程。该链接指向攻击者控制的SMB共享，当Outlook尝试访问此共享时，受害者的NTLM哈希会被发送到攻击者处。利用此漏洞通常需要用户点击邮件中的链接。关于投毒风险，虽然POC代码本身实现了漏洞利用，但是README中指示要运行`impacket-smbserver` ，并且提供了进一步利用CVE-2023-21716的思路，结合免责声明可以判断，作者主观上没有进行恶意投毒行为，但是客观上如果使用者继续利用可能会进行恶意投毒攻击，因此存在一定的投毒风险，概率约为10%。漏洞库信息和搜索引擎结果均证实了该漏洞的存在和严重性，以及其远程代码执行的性质。

**项目地址:** [r00tb1t/CVE-2024-21413-POC](https://github.com/r00tb1t/CVE-2024-21413-POC)

**漏洞详情:** [CVE-2024-21413](https://nvd.nist.gov/vuln/detail/CVE-2024-21413)