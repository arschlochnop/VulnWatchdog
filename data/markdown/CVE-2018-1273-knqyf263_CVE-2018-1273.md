## CVE-2018-1273-SpringDataCommons-RCE

**漏洞编号:** CVE-2018-1273

**漏洞类型:** 远程代码执行

**影响应用:** Spring Data Commons

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Versions prior to 1.13 to 1.13.10, 2.0 to 2.0.5, and older unsupported versions

**利用条件:** 需要Spring Data REST暴露HTTP资源或使用Spring Data的projection-based request payload binding。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-1273是Spring Data Commons中存在的一个属性绑定漏洞，由于未能正确中和特殊元素，未经身份验证的远程恶意用户可以通过构造特制的请求参数，针对Spring Data REST支持的HTTP资源或者使用Spring Data的基于projections的请求负载绑定，从而导致远程代码执行攻击。

**有效性分析：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，该漏洞是真实存在的，并且存在公开可用的PoC。PoC代码中提供了一个Dockerfile，用于构建一个存在漏洞的Spring Data Web Example应用。README.md文件中提供了运行Docker容器的步骤，以及两种攻击方式的示例，都是利用SpEL表达式注入来执行任意命令。攻击向量是通过构造包含SpEL表达式的请求参数，例如`username[#this.getClass().forName("java.lang.Runtime").getRuntime().exec("cp /etc/passwd /tmp")]`。

**投毒风险分析：**
提供的Dockerfile、README.md和pom.xml文件中，没有发现明显的恶意代码，其目的仅为搭建漏洞环境和提供利用方式，用于验证漏洞，因此可以认为不存在投毒风险。

**利用方式：**
1.  **漏洞触发点：**Spring Data REST或Spring Data的projection-based request payload binding。
2.  **攻击方式：**构造包含SpEL表达式的恶意请求参数，利用Spring Data Commons的属性绑定机制，将SpEL表达式注入到应用程序中。
3.  **利用结果：**成功利用该漏洞可以执行任意代码，例如读取敏感文件、反弹shell等，从而完全控制受影响的系统。

**项目地址:** [knqyf263/CVE-2018-1273](https://github.com/knqyf263/CVE-2018-1273)

**漏洞详情:** [CVE-2018-1273](https://nvd.nist.gov/vuln/detail/CVE-2018-1273)