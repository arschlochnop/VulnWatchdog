## CVE-2023-23638 - Apache Dubbo Deserialization

**漏洞编号:** CVE-2023-23638

**漏洞类型:** 反序列化漏洞

**影响应用:** Apache Dubbo

**危害等级:** 中危，可能导致远程代码执行

**影响版本:** 2.7.x <= 2.7.21, 3.0.x <= 3.0.13, 3.1.x <= 3.1.5

**利用条件:** 需要Dubbo服务开启generic invoke功能，且攻击者能够发送恶意序列化数据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-23638是Apache Dubbo中的一个反序列化漏洞，存在于泛化调用（generic invoke）功能中。攻击者可以通过发送特制的序列化数据绕过安全限制，从而在目标服务器上执行任意代码。

**有效性：**

根据提供的漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞是存在的，并且存在可用的PoC代码。 PoC的有效性取决于目标环境是否满足利用条件，例如是否开启了generic invoke，以及是否存在其他的安全措施。

根据提供的README.md文件，该PoC需要在DemoConsumer中添加VM参数`-Ddubbo.hessian.allowNonSerializable=true`，表明利用需要特定的配置，同时也说明了该漏洞的利用依赖于hessian反序列化。

**投毒风险：**

查看提供的pom.xml文件和README.md文件，并未发现明显的恶意代码或后门。但由于反序列化漏洞本身的复杂性，以及PoC代码可能包含的隐蔽利用方式，仍然存在一定的投毒风险。PoC代码中存在JNDI注入的利用方式，提示可以修改成反序列化的利用方式，存在一定的风险。

综合评估，投毒风险约为10%，主要来自于对反序列化利用链的潜在篡改或隐藏恶意行为的可能性。

**利用方式：**

1.  **漏洞触发：** 利用Dubbo的泛化调用（generic invoke）功能发送恶意构造的序列化数据。
2.  **绕过限制：**  利用特定的类（如PoC中提到的修改properties的类）绕过Dubbo的序列化安全限制。
3.  **代码执行：**  通过反序列化漏洞执行恶意代码，例如JNDI注入或直接执行系统命令。
4.  **前置条件：**  需要目标Dubbo服务开启generic invoke功能，并且攻击者能够访问Dubbo服务。
5.  **利用过程：**
    * 构造恶意的序列化数据，其中包含能够触发远程代码执行的Payload。
    *  调用Dubbo服务的generic invoke接口，并将恶意数据作为参数传递。
    * Dubbo服务在处理generic invoke请求时，会反序列化接收到的数据。
    * 由于存在反序列化漏洞，恶意Payload会被执行，导致远程代码执行。

**项目地址:** [cuijiung/dubbo-CVE-2023-23638](https://github.com/cuijiung/dubbo-CVE-2023-23638)

**漏洞详情:** [CVE-2023-23638](https://nvd.nist.gov/vuln/detail/CVE-2023-23638)