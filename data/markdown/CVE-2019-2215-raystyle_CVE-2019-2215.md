## CVE-2019-2215 Android Binder Use-After-Free 漏洞

**漏洞编号:** CVE-2019-2215

**漏洞类型:** Use-After-Free

**影响应用:** Android Kernel

**危害等级:** 高危，可导致权限提升至Linux内核级别

**影响版本:** Kernel

**利用条件:** 需要安装恶意本地应用程序或网络应用中的其他漏洞进行利用

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-2215是一个Android Binder中的use-after-free漏洞，存在于binder.c文件中。该漏洞允许本地应用程序将权限提升到Linux内核级别。漏洞的根本原因是当一个线程使用epoll显式退出时（BINDER_THREAD_EXIT），waitqueue会被释放，但它从未从相应的epoll数据结构中删除。当进程随后退出时，epoll清理代码试图访问waitlist，从而导致use-after-free。\n\n**有效性：**\n根据漏洞利用代码信息，提供的PoC代码在Pixel 2上已成功触发KASAN崩溃，证明其有效性。同时，漏洞报告中提到，该漏洞已经被用于实际攻击中。\n\n**投毒风险：**\n分析PoC代码，代码本身结构简单，主要功能是打开/dev/binder0，创建一个epoll实例，将binder文件描述符添加到epoll中，然后调用ioctl BINDER_THREAD_EXIT。没有发现明显的后门或恶意代码，但考虑到漏洞利用的复杂性，以及攻击者可能通过其他方式（例如，替换PoC代码中的某些参数，使其在特定环境下执行恶意操作）引入投毒行为，因此，存在一定的投毒风险。这里将投毒风险预估为10%。\n\n**利用方式：**\n1.  **触发UAF：** 通过ioctl(fd, BINDER_THREAD_EXIT, NULL) 触发binder线程退出，导致waitqueue被释放。\n2.  **利用释放后的内存：**  进程退出时，epoll清理代码会尝试访问已经被释放的waitlist，从而触发use-after-free。\n3.  **权限提升：**  利用UAF漏洞，攻击者可以实现任意内核读/写，从而获得root权限。

**项目地址:** [raystyle/CVE-2019-2215](https://github.com/raystyle/CVE-2019-2215)

**漏洞详情:** [CVE-2019-2215](https://nvd.nist.gov/vuln/detail/CVE-2019-2215)