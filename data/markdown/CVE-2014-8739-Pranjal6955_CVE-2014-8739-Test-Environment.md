## CVE-2014-8739 - jQuery File Upload Plugin 未限制文件上传漏洞

**漏洞编号:** CVE-2014-8739

**漏洞类型:** 未限制文件上传

**影响应用:** jQuery File Upload Plugin (6.4.4)

**危害等级:** 高危，可导致远程代码执行

**影响版本:** 6.4.4

**利用条件:** 目标系统使用了受影响的 jQuery File Upload Plugin 版本，且文件上传目录可公开访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2014-8739 存在于 jQuery File Upload Plugin 6.4.4 的 server/php/UploadHandler.php 文件中，是一个未限制文件上传漏洞。攻击者可以通过上传包含恶意 PHP 代码的文件，并直接访问该文件来执行任意代码。 

**有效性评估：**

提供的漏洞利用代码包含一个 Python 脚本和一个 README.md 文件。README.md 提供了使用 Docker 镜像快速测试漏洞的步骤，以及使用 Nuclei 进行漏洞扫描的方法。Python 脚本 `test-vulnerability.py` 旨在通过上传 PHP 文件并尝试执行它来验证漏洞。

从漏洞描述和利用代码来看，该漏洞利用的有效性较高，因为漏洞原理简单直接：未经校验的文件上传导致远程代码执行。

**投毒风险分析：**

代码仓库中存在投毒代码的可能性较低（估计为 10%）。主要基于以下几点：

*   该仓库的主要目的是提供 CVE-2014-8739 的测试环境，代码量相对较小。
*   代码仓库中包含了用于测试漏洞利用的脚本和说明，以及免责声明，表明其用途是安全研究和测试。
*   尽管如此，仍然存在微小风险，例如，Python 脚本可能包含隐蔽的恶意代码，或者 Docker 镜像本身可能被篡改过。 建议在使用前仔细审查所有代码。

**利用方式：**

1.  **漏洞定位：** 确认目标系统使用了受影响的 jQuery File Upload Plugin 6.4.4，并且存在 `server/php/UploadHandler.php` 文件。
2.  **上传恶意文件：**  构造一个包含恶意 PHP 代码的文件（例如 `test.php`），利用文件上传功能上传该文件。
3.  **执行恶意代码：** 通过直接访问上传的文件（例如 `http://example.com/server/php/files/test.php`）来执行恶意代码。服务器会解析并执行上传的 PHP 代码，从而导致远程代码执行。

提供的Nuclei模板也可以自动检测该漏洞。

总之，CVE-2014-8739 是一个严重的安全漏洞，攻击者可以利用该漏洞在目标系统上执行任意代码。 建议受影响的用户尽快升级到最新版本，并实施适当的文件上传验证和安全措施。

**项目地址:** [Pranjal6955/CVE-2014-8739-Test-Environment](https://github.com/Pranjal6955/CVE-2014-8739-Test-Environment)

**漏洞详情:** [CVE-2014-8739](https://nvd.nist.gov/vuln/detail/CVE-2014-8739)