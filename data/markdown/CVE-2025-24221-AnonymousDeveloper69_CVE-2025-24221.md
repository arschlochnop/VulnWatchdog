## CVE-2025-24221 – iOS Keychain Backup Vulnerability Disclosure

**漏洞编号:** CVE-2025-24221

**漏洞类型:** 信息泄露

**影响应用:** iOS, iPadOS, visionOS

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < visionOS 2.4, iOS 18.4, iPadOS 18.4, iPadOS 17.7.6

**利用条件:** 需要访问iOS设备的备份文件

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2025-24221 漏洞允许从 iOS 备份中访问敏感的 Keychain 数据。漏洞利用代码 `fmi.php` 尝试利用 'Find My iPhone' (FMiP) 服务绕过数据访问限制。其利用方式如下：

1.  **漏洞原理：** 该漏洞存在于受影响的 iOS、iPadOS 和 visionOS 版本中，由于数据访问限制不完善，导致备份中的 Keychain 数据可以被未经授权访问。
2.  **POC 代码分析：**
    *   `README.md` 描述了漏洞和 PoC。它声称苹果公司没有完全修补该漏洞。
    *   `fmi.php` 尝试通过 FMiP 服务绕过身份验证和数据访问限制，以获取设备信息，并可能禁用设备。该脚本模拟了与 FMiP 服务的交互，包括设备初始化 (`initClient`) 和认证 (`authForUserDevice`) 。
3.  **利用方式：**
    *   攻击者首先需要获取目标 iOS 设备的备份文件。
    *   然后，使用 `fmi.php` 脚本，通过提供 Apple ID 和密码（或其他认证信息），尝试与 FMiP 服务通信。
    *   脚本试图获取设备列表，并对每个设备进行认证，然后可能执行某些操作（如禁用设备，但这并不是该漏洞本身所导致的直接后果）。
4.  **有效性评估：**
    *   该 PoC 的有效性取决于 Apple 是否完全修复了漏洞。README描述苹果并未完全修复该漏洞。如果漏洞仍然存在，该 PoC 理论上可以工作。
5.  **投毒风险：**
    *   `fmi.php` 脚本包含对 `curl_setopt` 的调用，且包含多个URL字符串，这可能存在风险。虽然脚本的主要目的是利用漏洞，但也可能被修改为执行恶意操作，例如：向攻击者发送敏感信息。脚本中存在一些硬编码的值(如User-Agent)，这降低了投毒风险，但不能完全排除。鉴于此，评估投毒风险为 20%。
6.  **缓解措施：**
    *   及时更新到 visionOS 2.4, iOS 18.4, iPadOS 18.4, iPadOS 17.7.6 或更高版本。
    *   加强对 iOS 备份文件的保护，使用强密码加密备份。
    *   监控 FMiP 服务相关的异常活动。

**项目地址:** [AnonymousDeveloper69/CVE-2025-24221](https://github.com/AnonymousDeveloper69/CVE-2025-24221)

**漏洞详情:** [CVE-2025-24221](https://nvd.nist.gov/vuln/detail/CVE-2025-24221)