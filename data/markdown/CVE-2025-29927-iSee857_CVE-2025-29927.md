## CVE-2025-29927-Next.js中间件权限绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 权限绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** Next.js应用使用了中间件进行权限验证

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-29927是Next.js框架中的一个权限绕过漏洞，存在于使用中间件进行授权检查的应用中。该漏洞允许攻击者通过操纵`x-middleware-subrequest`请求头来绕过中间件的授权检查，从而访问受保护的资源。

**有效性：**

根据漏洞描述和搜索结果，提供的POC代码是有效的。该代码通过发送包含特制`x-middleware-subrequest`头的请求来模拟攻击，并检查服务器的响应状态码来判断目标是否存在漏洞。

**投毒风险：**

分析提供的POC代码，未发现明显的投毒代码。代码逻辑清晰，主要功能是发送带有特定header的HTTP请求，并根据响应判断是否存在漏洞。所有操作都在预期之内，没有发现恶意行为或隐藏的后门，风险是0%。

**利用方式：**

1.  **确定目标：** 识别运行着受影响版本Next.js的应用，且该应用使用中间件进行权限验证。
2.  **构造恶意请求：** 使用POC或类似工具，构造包含`x-middleware-subrequest`头的HTTP请求。`x-middleware-subrequest`的值设置为`middleware:middleware:middleware:middleware:middleware`。
3.  **发送请求：** 将构造好的请求发送到目标服务器的受保护资源。
4.  **验证漏洞：** 检查服务器的响应。如果未经授权即可访问资源，则表明存在漏洞。

**缓解措施：**

*   升级Next.js版本到14.2.25或15.2.3及以上。
*   如果无法升级，建议阻止包含`x-middleware-subrequest`头的外部用户请求到达Next.js应用程序。

**项目地址:** [iSee857/CVE-2025-29927](https://github.com/iSee857/CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)