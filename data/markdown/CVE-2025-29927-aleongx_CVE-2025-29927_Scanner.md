## CVE-2025-29927-Next.js Middleware Authorization Bypass

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未授权访问和数据泄露

**影响版本:** 受影响版本包括：>= 11.1.4, <= 13.5.6, > 14.0.0, < 14.2.25, > 15.0.0, < 15.2.3

**利用条件:** 需要目标服务器运行受影响版本的Next.js，且授权检查位于middleware中

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2025-29927是Next.js中间件中的一个授权绕过漏洞。如果授权检查发生在middleware中，攻击者可以通过操纵`x-middleware-subrequest` header来绕过授权验证，从而访问受保护的路由，例如`/dashboard`、`/admin`等。

**漏洞利用方式：**

1.  攻击者发送HTTP请求到目标Next.js服务器。
2.  在请求头中，攻击者设置`x-middleware-subrequest` header，并赋予特定的payload，该payload旨在欺骗或绕过middleware中的授权检查逻辑。
3.  服务器在处理请求时，由于漏洞存在，未能正确验证`x-middleware-subrequest` header，导致授权绕过。
4.  攻击者成功访问原本需要授权才能访问的资源或页面。

**POC有效性：**
提供的POC代码通过发送带有不同payload的请求来测试目标服务器是否存在此漏洞。它会检测响应状态码以及响应内容中是否包含敏感路径，从而判断漏洞是否存在。

**投毒风险：**
该POC代码主要用于漏洞检测，用于发送特定header并分析响应。`README.md` 文件描述了该漏洞的原理和利用方式，没有发现恶意代码。投毒风险极低。存在很低的概率被植入后门，但是可能性很小，小于1%。

**项目地址:** [aleongx/CVE-2025-29927_Scanner](https://github.com/aleongx/CVE-2025-29927_Scanner)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)