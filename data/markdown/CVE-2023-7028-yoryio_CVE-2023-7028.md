## CVE-2023-7028 - GitLab Account Takeover

**漏洞编号:** CVE-2023-7028

**漏洞类型:** Account Takeover

**影响应用:** GitLab CE/EE

**危害等级:** 高危，可导致未经授权的账户访问和控制

**影响版本:** 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2

**利用条件:** 目标GitLab实例需要存在漏洞，并且攻击者需要知道目标用户的邮箱地址。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-7028是一个GitLab CE/EE中的账户接管漏洞。该漏洞源于密码重置流程中的缺陷，允许攻击者通过向目标用户和一个攻击者控制的邮箱地址同时发送密码重置邮件，从而接管目标账户。攻击者通过提供两个邮箱地址（目标用户的邮箱和攻击者的邮箱）到密码重置接口，GitLab会将密码重置链接发送到两个邮箱。攻击者利用这一点，便可以重置目标用户的密码。POC代码通过发送包含目标用户邮箱和攻击者邮箱的POST请求到/users/password接口来触发密码重置流程。经过分析，仓库中存在投毒代码的可能性较低，主要集中于利用环节，通过双邮箱进行重置，但考虑到存在引入恶意依赖或者其他未知风险，因此判定为5% 。

**项目地址:** [yoryio/CVE-2023-7028](https://github.com/yoryio/CVE-2023-7028)

**漏洞详情:** [CVE-2023-7028](https://nvd.nist.gov/vuln/detail/CVE-2023-7028)