## CVE-2022-0739-BookingPress-SQL注入

**漏洞编号:** CVE-2022-0739

**漏洞类型:** SQL注入

**影响应用:** BookingPress WordPress plugin

**危害等级:** 高危，可能导致数据泄露，权限提升

**影响版本:** < 1.0.11

**利用条件:** 目标网站安装了BookingPress插件且版本低于1.0.11，攻击者需要知道或猜测到有效的wpnonce值，插件开启了bookingpress_front_get_category_services AJAX action。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-0739是BookingPress WordPress插件1.0.11版本之前的未经验证的SQL注入漏洞。该漏洞位于`bookingpress_front_get_category_services` AJAX action中，该action允许未经身份验证的用户访问。攻击者可以通过构造恶意的`category_id`和`total_service`参数，将恶意SQL注入到数据库查询中。提供的POC代码通过发送包含恶意SQL payload的POST请求到`/wp-admin/admin-ajax.php`端点来利用此漏洞，其中`category_id`参数被设置为一个数字，`total_service`包含UNION SELECT语句，用于提取`wp_users`表中的`user_login`、`user_email`和`user_pass`字段。POC代码首先构建包含SQL注入的POST数据，然后发送到目标URL。然后，它解析响应以提取用户名、电子邮件和密码。由于代码的目的是读取数据库信息，因此没有观察到投毒行为。该漏洞利用的有效性取决于成功获取有效的`_wpnonce`，如果不能确定nonce值，则利用会受到限制。由于该插件的AJAX操作公开给未经身份验证的用户，因此成功利用可能导致敏感数据泄露，例如用户凭据。

**项目地址:** [hadrian3689/wp_bookingpress_1.0.11](https://github.com/hadrian3689/wp_bookingpress_1.0.11)

**漏洞详情:** [CVE-2022-0739](https://nvd.nist.gov/vuln/detail/CVE-2022-0739)