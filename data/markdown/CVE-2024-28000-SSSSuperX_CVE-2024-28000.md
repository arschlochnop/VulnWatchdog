## CVE-2024-28000 - WordPress LiteSpeed Cache 未授权提权漏洞

**漏洞编号:** CVE-2024-28000

**漏洞类型:** 未授权提权

**影响应用:** LiteSpeed Cache WordPress 插件

**危害等级:** 严重，可能导致管理员权限获取

**影响版本:** <= 6.3.0.1

**利用条件:** 目标网站安装了受影响版本的 LiteSpeed Cache 插件，并且启用了相关功能。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28000 是 LiteSpeed Cache WordPress 插件中存在的一个未授权提权漏洞。攻击者可以通过发送特制的 HTTP 请求，设置特定的 `litespeed_hash` 和 `litespeed_role` Cookie，绕过权限验证，创建具有管理员权限的用户。该漏洞的利用方式如下：

1.  **漏洞描述：** 该漏洞是由于插件对用户角色的权限检查不充分导致的。
2.  **影响版本：** LiteSpeed Cache 插件 1.9 到 6.3.0.1 版本。
3.  **利用方式：**
    *   发送包含特制 Cookie 的 POST 请求到 `/wp-json/wp/v2/users` 接口，其中 `litespeed_hash` 可以是任意字符串，`litespeed_role` 设置为 "1"。
    *   在 POST 请求的 JSON 数据中，包含要创建的用户名、密码、邮箱以及角色信息，其中角色设置为 `administrator`。
    *   如果服务器返回 `rest_user_invalid_role` 错误，则表示漏洞利用成功，已经成功创建了一个具有管理员权限的用户。
4.  **POC 分析：** 提供的 Python 脚本 `CVE-2024-28000_Exploit.py` 实现了上述利用过程。它接受目标 URL 和 hash 列表作为输入，然后针对每个 hash 值，构造包含特定 Cookie 和 JSON 数据的 POST 请求，尝试创建管理员用户。`CVE-2024-28000_Scan.py`文件进行扫描，确认目标站点是否存在漏洞。
5.  **投毒风险分析：**  `CVE-2024-28000_Exploit.py` 中存在投毒的可能性较低，主要风险在于脚本的运行依赖外部参数（目标 URL 和 hash 列表），如果这些参数被篡改，可能导致脚本行为异常，例如，攻击到错误的网站。脚本本身的功能是创建管理员用户，如果脚本被用于未经授权的渗透测试，也存在一定的法律风险。虽然脚本使用了`fake_useragent`库，但没有其他的恶意行为，因此判定投毒风险较低。
6.  **有效性评估：** 根据漏洞描述和提供的 POC 代码，可以判断该漏洞的利用是有效的。多个搜索结果链接也证实了该漏洞的存在以及利用方式。

**项目地址:** [SSSSuperX/CVE-2024-28000](https://github.com/SSSSuperX/CVE-2024-28000)

**漏洞详情:** [CVE-2024-28000](https://nvd.nist.gov/vuln/detail/CVE-2024-28000)