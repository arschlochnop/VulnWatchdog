## CVE-2023-51385-OpenSSH-命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要目标系统存在受影响版本的OpenSSH，且攻击者能够控制用户名或主机名中使用的某些字符（通常通过Git子模块等方式）。

**POC 可用性:** 部分。提供的README.md只是描述，需要构造特定的用户名/主机名利用。

**投毒风险:** 10%

## 详情

CVE-2023-51385是OpenSSH 9.6之前版本中的一个命令注入漏洞。如果用户名或主机名包含shell元字符，并且该名称在某些情况下被扩展令牌引用，则可能发生操作系统命令注入。例如，不受信任的Git存储库可能包含一个子模块，该子模块在用户名或主机名中具有shell元字符。攻击者可以利用此漏洞在目标系统上执行任意命令。

**有效性：**
提供的POC代码（README.md文件）本身不构成一个完整的PoC。它只是对漏洞的描述。完整的利用需要攻击者能够控制用户名或主机名，并在其中插入恶意的shell元字符。

**投毒风险：**
提供的代码仓库（只有README.md）投毒的可能性较低，但是不排除作者在其他相关代码中包含恶意payload的可能。考虑到只有README.md,所以投毒风险较低,评估为10%。

**利用方式：**
1.  **控制用户名/主机名：** 攻击者需要找到一种方法来控制OpenSSH客户端使用的用户名或主机名。这可能通过以下方式实现：
    *   **恶意的Git子模块：**  创建一个包含恶意子模块的Git仓库。该子模块的URL可能包含带有shell元字符的用户名或主机名。
    *   **其他配置：**  在其他OpenSSH配置文件（例如`~/.ssh/config`）中，如果可以控制Host字段,也可以插入恶意字符
2.  **触发漏洞：** 当OpenSSH客户端尝试连接到恶意主机或处理包含恶意子模块的仓库时，它会展开用户名/主机名中的shell元字符，从而导致命令注入。
3.  **执行任意命令：** 攻击者可以通过注入的命令在目标系统上执行任意代码。

综上所述，该漏洞利用需要一定的条件，但如果成功利用，则风险极高。

**项目地址:** [runooovb/CVE-2023-51385test](https://github.com/runooovb/CVE-2023-51385test)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)