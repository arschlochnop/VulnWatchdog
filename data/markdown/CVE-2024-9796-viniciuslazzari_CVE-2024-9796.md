## CVE-2024-9796-WP-Advanced-Search-SQL注入

**漏洞编号:** CVE-2024-9796

**漏洞类型:** SQL注入

**影响应用:** WP-Advanced-Search

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** < 3.3.9.2

**利用条件:** 需要目标 WordPress 站点安装了受影响版本的 WP-Advanced-Search 插件，且攻击者能够发送 HTTP 请求。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9796 是 WP-Advanced-Search WordPress 插件中存在的一个未经身份验证的 SQL 注入漏洞。根据漏洞描述，3.3.9.2 之前的版本没有充分地对 `t` 参数进行过滤和转义，导致攻击者可以在 SQL 查询中注入恶意代码。

**有效性：**

根据搜索结果和漏洞库信息，存在公开的漏洞利用证明(POC)。但是提供的漏洞利用代码只包含一个简单的 README 文件，WordPress 框架代码和GPL协议,并没有提供利用漏洞的代码,不能直接验证漏洞的有效性。Github上存在POC，因此可信度高。

**投毒风险：**

提供的代码仓库主要包含了一个 `README.md`， `index.php` 和 `license.txt`，这部分代码是WordPress的框架代码和GPL协议文本，不像是用于漏洞利用或攻击的代码。`index.php`是 WordPress 的前端入口文件，正常情况下不包含恶意代码。因此，从直接的代码分析来看，投毒的概率较低，但仍存在风险，例如在 WordPress 框架代码中隐藏后门，或通过 README.md 文件诱导用户执行恶意操作。给10%是考虑到代码比较少，无法验证投毒的完全性。

**利用方式：**

1.  确定目标 WordPress 站点安装了受影响版本的 WP-Advanced-Search 插件 (低于3.3.9.2)。
2.  构造包含恶意 SQL 代码的 HTTP 请求，特别是针对 `t` 参数。
3.  将构造的 HTTP 请求发送到目标站点的 WordPress 实例。
4.  如果漏洞成功利用，攻击者将能够执行任意 SQL 查询，例如，可以提取数据库中的敏感数据或执行其他恶意操作，比如插入或更新数据。

**总结：**

CVE-2024-9796 是 WP-Advanced-Search 插件中的一个高危 SQL 注入漏洞。虽然提供的POC代码不完整，但公开的信息表明该漏洞是可利用的。开发者应该尽快升级插件到最新版本，以修复该漏洞。

**项目地址:** [viniciuslazzari/CVE-2024-9796](https://github.com/viniciuslazzari/CVE-2024-9796)

**漏洞详情:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)