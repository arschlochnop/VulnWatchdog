## CVE-2025-24813-Apache Tomcat Path Equivalence RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 路径等价性漏洞/远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行和信息泄露

**影响版本:** 9.0.0.M1-9.0.98, 10.1.0-M1-10.1.34, 11.0.0-M1-11.0.2

**利用条件:** 需要满足以下条件：默认Servlet的写入已启用（默认禁用）、支持部分PUT（默认启用）、应用程序使用Tomcat基于文件的会话持久性，默认存储位置、应用程序包含可在反序列化攻击中使用的库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24813 是 Apache Tomcat 中的一个路径等价性漏洞，源于对包含特殊字符（特别是分号“;”）的 URL 的解析不一致。这种不一致允许攻击者构造恶意 URL，该 URL 被安全检查组件和文件服务组件以不同的方式解释。如果启用了`default` servlet 的写权限和启用了`partial PUT`，并且使用了存在反序列化漏洞的依赖， 攻击者可以通过上传恶意文件（例如，JSP webshell），然后利用构造的包含 `..;/` 的 URL 来绕过安全限制，最终在服务器上实现远程代码执行(RCE)。

**有效性评估：**

根据漏洞描述和搜索结果，此漏洞已在野外被积极利用。漏洞利用代码中的 `README.md` 文件详细描述了漏洞原理、攻击链和利用方式，表明该 PoC 代码具备一定的有效性。

**投毒风险评估：**

分析了漏洞利用代码目录下的 `LICENSE` 和 `README.md` 文件，未发现明显的恶意代码。但任何 PoC 代码都存在潜在风险，不应在生产环境直接运行。 无法保证作者没有在其他文件中添加隐藏的后门代码。因此, 投毒风险评估为10%。

**漏洞利用方式：**

1.  **上传恶意 Payload：** 攻击者通过 Web 应用程序的文件上传功能，将恶意的 JSP Web Shell（例如 `shell.jsp`）上传到已知的非可执行目录，例如 `/uploads`。
2.  **发现Endpoint：** 攻击者识别服务器上一个合法的，可执行的 JSP 端点，例如 `/user/profile.jsp`。
3.  **构造和执行攻击URL：** 攻击者构造最终 URL，其中包含 `..;/` 序列来绕过安全检查。例如：`/app/user/..;/uploads/shell.jsp`。当服务器接收到此请求时，安全管理器可能只检查 `/app/user/` 的权限，而文件系统解析器会处理 `../` 并执行 `/uploads/shell.jsp` 中的代码。

**修复建议：**

*   升级到 Apache Tomcat 11.0.3, 10.1.35 或 9.0.98 及以上版本。
*   禁用 default servlet 的写权限，除非绝对必要。
*   审查并更新应用程序依赖，移除存在反序列化漏洞的库。

**项目地址:** [threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat](https://github.com/threadpoolx/CVE-2025-24813-Remote-Code-Execution-in-Apache-Tomcat)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)