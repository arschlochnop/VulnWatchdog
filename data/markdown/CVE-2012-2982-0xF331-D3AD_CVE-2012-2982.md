## CVE-2012-2982 Webmin file/show.cgi 命令执行

**漏洞编号:** CVE-2012-2982

**漏洞类型:** 命令执行

**影响应用:** Webmin

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 1.590

**利用条件:** 需要Webmin后台的认证用户权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2012-2982漏洞存在于Webmin 1.590及更早版本的file/show.cgi文件中。该漏洞允许经过身份验证的远程用户通过路径名中的无效字符（例如 | 管道符）执行任意命令。 

**有效性：**

根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞是有效的。存在公开的Metasploit模块以及Python脚本可以利用此漏洞。

**投毒风险：**

提供的POC代码（pom.xml, Exploit.java, README.md）没有明显的投毒代码。代码主要功能是利用Maven构建一个Java程序，该程序用于发送HTTP请求，利用漏洞执行命令。没有发现任何恶意或隐藏的功能。

**利用方式：**

1.  **身份验证：** 首先，攻击者需要拥有Webmin后台的有效用户名和密码进行身份验证。
2.  **构造恶意请求：** 攻击者构造包含恶意字符（例如 | ）的URL，并将其发送到受影响的file/show.cgi文件。
3.  **命令执行：** Webmin服务器在处理该请求时，由于未正确过滤恶意字符，会将恶意字符传递给系统命令，导致任意命令执行。

提供的java代码显示了利用漏洞的大致流程,首先进行登录, 拿到sid, 然后利用sid进行后续的利用。

**有效性验证:**  搜索引擎结果表明，已经存在公开可用的Metasploit模块和Python脚本，证明漏洞可利用。


**项目地址:** [0xF331-D3AD/CVE-2012-2982](https://github.com/0xF331-D3AD/CVE-2012-2982)

**漏洞详情:** [CVE-2012-2982](https://nvd.nist.gov/vuln/detail/CVE-2012-2982)