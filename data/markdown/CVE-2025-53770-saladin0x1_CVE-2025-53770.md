## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft SharePoint Server

**危害等级:** 严重，未经身份验证的攻击者可以通过网络执行任意代码。

**影响版本:** 受影响版本包括 SharePoint Server 2016, SharePoint Server 2019, 和 SharePoint Server Subscription Edition (版本低于 16.0.18526.20508)

**利用条件:** 目标 SharePoint 服务器需要暴露在网络中，且未安装相应的安全更新或缓解措施。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是一种 Microsoft SharePoint Server 远程代码执行漏洞，源于对不可信数据的反序列化。该漏洞允许未经授权的攻击者通过网络执行代码。根据漏洞库信息，该漏洞已被公开利用 (Exploit Exists)。

**利用方式：**

1.  **身份验证绕过:** 攻击者首先绕过身份验证机制，访问受保护的 ToolPane.aspx 页面（CVE-2025-49706 及其补丁绕过 CVE-2025-53771）。
2.  **不安全的反序列化:** 成功绕过身份验证后，攻击者利用不安全的反序列化漏洞 (CVE-2025-49704 和 CVE-2025-53770 的补丁绕过)，将恶意序列化对象发送到 SharePoint 服务器。
3.  **远程代码执行:** SharePoint 服务器在反序列化恶意对象时，会执行其中包含的任意代码，从而导致远程代码执行。

**POC 代码分析：**

提供的 POC 代码包含以下组件：

*   `scanner/scanner.py`: 用于扫描易受攻击的 SharePoint 安装。
*   `exploit/exploit.py`: 主要的 Python RCE 利用脚本，用于发送恶意负载。
*   `metasploit_ref/cURL`: 包含 cURL 命令示例，用于测试利用。
*   `analysis/analyse.py`: 用于解码和分析利用响应的工具。

POC 代码利用了身份验证绕过和不安全的反序列化漏洞链，实现未经身份验证的远程代码执行。

**投毒风险分析：**

尽管 POC 代码提供了漏洞利用的功能，但它也可能包含潜在的投毒代码。风险评估基于以下几点：

*   **代码复杂性:** 代码逻辑相对清晰，易于理解。但是仍然需要审查依赖项和外部资源，以排除恶意代码的可能性。
*   **权限要求:** 利用需要对目标系统执行代码，这意味着任何隐藏的恶意代码也可能以相同的权限运行。文件读写操作，网络行为和系统调用需要仔细审查。
*   **代码来源:** 代码的作者身份未知，增加了潜在风险。建议从可信来源获取 POC 代码，并进行彻底审查。

综上所述，POC 代码存在一定的投毒风险，评估为 **10%**。虽然代码结构看似正常，但仍然需要仔细检查，以确保其中不包含任何隐藏的恶意代码。建议在隔离环境中运行 POC 代码，并使用安全工具进行分析。

**项目地址:** [saladin0x1/CVE-2025-53770](https://github.com/saladin0x1/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)