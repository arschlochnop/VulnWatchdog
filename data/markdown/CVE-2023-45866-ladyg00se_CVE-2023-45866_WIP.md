## CVE-2023-45866-BlueZ蓝牙HID主机未授权连接

**漏洞编号:** CVE-2023-45866

**漏洞类型:** 认证绕过

**影响应用:** BlueZ

**危害等级:** 高危，可能导致未经授权的键盘输入和命令执行

**影响版本:** bluez <= 5.64 (例如Ubuntu 22.04LTS中的bluez 5.64-0ubuntu1)

**利用条件:** 攻击者需要在目标蓝牙设备的附近

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-45866 允许未经验证的蓝牙 HID 设备（作为Peripheral角色）发起并建立加密连接，并接受 HID 键盘报告。这使得攻击者能够在Central角色没有用户交互的情况下注入 HID 消息。根据搜索结果，该漏洞影响 Apple、Android 和 Linux 设备，尤其是与 Apple Magic Keyboard 配对时。利用方式包括欺骗蓝牙主机状态机，使其与伪造的键盘配对，而无需用户确认。提供的漏洞利用代码仅包含 GNU GPL 许可证，没有发现直接的利用代码，但参考[webpage 7 begin]  reblog/cve-2023-45866/README.md at main  [description] The vulnerabilities work by tricking the Bluetooth host state-machine into pairing with a fake keyboard without user-confirmation.，说明存在绕过用户确认进行蓝牙配对的方式。

**有效性评估:**
  虽然提供的代码片段只是一个许可证，但结合漏洞描述和搜索结果可以推断出，如果结合特定的漏洞利用技术（例如欺骗蓝牙主机状态机），该漏洞是可利用的。

**投毒风险分析:**
  提供的代码片段是GNU通用公共许可证，本身不包含任何恶意代码。然而，考虑到漏洞利用通常需要编写额外的代码来模拟HID设备并发送恶意输入，攻击者可能在其他地方发布的POC中包含恶意代码。因此，从其他来源获取的漏洞利用代码存在一定的投毒风险（约为10%）。例如，攻击者可能会添加后门，在成功注入键盘输入后，进一步执行恶意命令。

**漏洞利用方式:**
1.  **被动监听:** 攻击者监听附近的蓝牙设备。
2.  **模拟HID设备:**  攻击者创建一个假的蓝牙HID设备（如键盘）。
3.  **建立连接:** 利用漏洞，在未经用户授权的情况下与目标蓝牙主机建立加密连接。
4.  **注入HID消息:**  攻击者通过建立的连接发送恶意键盘输入，执行任意命令。

利用的关键在于绕过认证，并在建立连接后能够模拟键盘输入。

**项目地址:** [ladyg00se/CVE-2023-45866_WIP](https://github.com/ladyg00se/CVE-2023-45866_WIP)

**漏洞详情:** [CVE-2023-45866](https://nvd.nist.gov/vuln/detail/CVE-2023-45866)