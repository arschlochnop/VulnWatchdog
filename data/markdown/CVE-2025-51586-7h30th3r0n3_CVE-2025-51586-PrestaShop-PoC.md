## CVE-2025-51586 - PrestaShop AdminLogin Email Enumeration

**漏洞编号:** CVE-2025-51586

**漏洞类型:** 信息泄露

**影响应用:** PrestaShop

**危害等级:** 低危，泄露管理员邮箱

**影响版本:** < 8.2.1

**利用条件:** 需要网络访问，目标 PrestaShop 实例存在 reset password 功能

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-51586 漏洞存在于PrestaShop 8.2.1 之前的版本中的 `controllers/admin/AdminLoginController.php` 文件。攻击者可以通过操纵 `id_employee` 参数和提供无效的 `reset_token`，利用密码重置功能泄露管理员的邮箱地址。

**有效性:**

提供的PoC代码有效。代码通过发送带有特定 `id_employee` 和 `reset_token` 的请求到密码重置页面，然后解析响应的 HTML 内容，寻找包含管理员邮箱的隐藏字段 `reset_email`。

**投毒风险:**

经过对 PoC 代码的分析，没有发现明显的投毒代码。代码逻辑主要集中在邮箱枚举和可选的暴力破解登录。未发现作者隐藏的恶意代码，例如执行系统命令或上传恶意文件等行为。

**利用方式:**

1.  攻击者向 PrestaShop 管理员登录页面的密码重置功能发送请求。
2.  请求中包含一个范围内的 `id_employee` 值和一个无效的 `reset_token`。
3.  服务器端脚本在处理请求时，如果 `id_employee` 对应于有效的管理员账号，则会在响应中包含一个隐藏的 HTML 字段 `reset_email`，其中包含管理员的邮箱地址。
4.  攻击者通过解析响应的 HTML 代码，提取 `reset_email` 字段的值，从而获取管理员的邮箱地址。
5. 可选地，PoC还支持通过用户提供的字典文件对发现的电子邮件地址进行暴力破解。

**优先级:** 搜索引擎结果显示该漏洞允许远程攻击者通过操纵 `idemployee` 获取管理员邮件地址。漏洞利用代码证实了此说法，并提供了枚举ID，利用弱口令字典暴力破解的实现。


**项目地址:** [7h30th3r0n3/CVE-2025-51586-PrestaShop-PoC](https://github.com/7h30th3r0n3/CVE-2025-51586-PrestaShop-PoC)

**漏洞详情:** [CVE-2025-51586](https://nvd.nist.gov/vuln/detail/CVE-2025-51586)