## CVE-2022-25765-pdfkit-命令注入

**漏洞编号:** CVE-2022-25765

**漏洞类型:** 命令注入

**影响应用:** pdfkit

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 0.8.7.2

**利用条件:** 需要目标服务器运行存在漏洞版本的pdfkit，且允许通过URL参数控制PDF生成过程。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2022-25765是pdfkit库中的一个命令注入漏洞。根据漏洞信息，由于URL未经过充分的过滤，攻击者可以通过构造恶意的URL参数，将恶意命令注入到pdfkit执行的命令中，从而实现远程代码执行。提供的POC代码 `cve-2022-25765.py` 利用了该漏洞，它接受目标URL、攻击者IP地址和端口作为参数，然后构造包含反弹shell命令的恶意URL，当pdfkit处理这个URL时，就会执行攻击者注入的命令，从而建立反弹shell连接。参考搜索引擎返回结果，该漏洞存在已知的利用方式，并且存在公开的exp可供使用。虽然POC代码主要是用于漏洞验证，但仍然存在微小的投毒风险，例如，攻击者可能会修改POC代码，添加额外的恶意功能，比如在反弹shell建立后执行持久化操作，或进行信息收集等。但从代码本身来看，其主要功能是利用漏洞建立反弹shell，因此投毒风险较低。

**利用方式：**

1.  攻击者构造包含恶意命令的URL，该命令通常用于执行系统命令，例如反弹shell。
2.  将构造的URL作为参数传递给pdfkit，pdfkit在生成PDF的过程中会解析该URL。
3.  由于pdfkit没有正确地过滤URL，恶意命令会被注入到pdfkit执行的命令中。
4.  pdfkit执行包含恶意命令的命令，导致攻击者注入的命令被执行，从而实现远程代码执行。
5.  攻击者通过反弹shell获取目标服务器的控制权。

**项目地址:** [lowercasenumbers/CVE-2022-25765](https://github.com/lowercasenumbers/CVE-2022-25765)

**漏洞详情:** [CVE-2022-25765](https://nvd.nist.gov/vuln/detail/CVE-2022-25765)