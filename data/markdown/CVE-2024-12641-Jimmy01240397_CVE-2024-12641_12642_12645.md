## CVE-2024-12641-Chunghwa Telecom TenderDocTransfer-Reflected XSS to RCE

**漏洞编号:** CVE-2024-12641

**漏洞类型:** Reflected XSS to RCE

**影响应用:** Chunghwa Telecom TenderDocTransfer

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 0.41.156

**利用条件:** 需要用户交互（点击恶意链接），目标应用开启本地web服务且存在脆弱的API

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2024-12641是中华电信TenderDocTransfer的一个反射型跨站脚本漏洞，通过诱导用户点击恶意链接，利用应用程序缺乏CSRF保护的API，攻击者可以在用户浏览器中执行任意JavaScript代码。由于该应用搭建了一个简单的本地Web服务器，并且支持Node.js特性，攻击者可以进一步利用XSS漏洞执行操作系统命令，实现远程代码执行。

**有效性分析：**
根据提供的漏洞信息和代码，可以判断该漏洞利用是有效的。POC代码中包含以下几个关键部分：
*   docker-compose.yml 和 server.conf: 用于设置nginx反向代理，模拟存在漏洞的本地web服务。
*   file.html：包含用于测试文件读取功能的 JavaScript 代码，通过构造恶意的文件路径，尝试读取服务器上的敏感文件。
*   rce1.html：包含用于触发RCE的 JavaScript 代码，利用`docDownload/download`接口，尝试执行PowerShell命令。

**投毒风险分析：**
根据提供的POC代码，投毒风险非常高(95%)。`rce1.html`中包含大量的混淆代码，最终目的是执行一个PowerShell命令。虽然无法立刻判断该PowerShell命令的具体行为，但这种模式非常符合恶意代码的特征。攻击者可以通过这种方式在受害者机器上执行恶意操作，例如下载和执行其他恶意程序，窃取敏感信息等。

**利用方式分析：**
1.  **诱导用户点击恶意链接：** 攻击者需要构造一个包含恶意 JavaScript 代码的 URL，并诱导目标用户点击该链接。
2.  **执行 XSS 攻击：**  用户点击链接后，恶意 JavaScript 代码将在用户的浏览器中执行。
3.  **利用API执行RCE:** 恶意 JavaScript 代码利用 TenderDocTransfer 提供的 API，在受害者的本地Web服务器上执行任意操作系统命令，例如执行PowerShell命令。

**建议：**
*   立即升级到 0.41.157 或更高版本。
*   在使用该应用程序时，保持警惕，不要轻易点击不明链接。

**项目地址:** [Jimmy01240397/CVE-2024-12641_12642_12645](https://github.com/Jimmy01240397/CVE-2024-12641_12642_12645)

**漏洞详情:** [CVE-2024-12641](https://nvd.nist.gov/vuln/detail/CVE-2024-12641)