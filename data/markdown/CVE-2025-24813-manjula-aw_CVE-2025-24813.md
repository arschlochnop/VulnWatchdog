## CVE-2025-24813-Apache Tomcat-RCE/信息泄露/文件篡改

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行/信息泄露/文件篡改

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致远程代码执行、敏感信息泄露和文件篡改

**影响版本:** 9.0.0.M1 <= version <= 9.0.98, 10.1.0-M1 <= version <= 10.1.34, 11.0.0-M1 <= version <= 11.0.2

**利用条件:** 需要满足以下条件：1. 启用了DefaultServlet的写入功能（默认禁用）；2. 启用了partial PUT支持（默认启用）；3. 对于RCE，需要应用程序使用Tomcat基于文件的会话持久化，并且包含可用于反序列化攻击的库；对于信息泄露和文件篡改，攻击目标URL是公共上传URL的子目录，且攻击者知道要上传的敏感文件名称,并且敏感文件也通过partial PUT上传。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-24813是Apache Tomcat中的一个路径等价漏洞，利用 'file.Name' (Internal Dot) 导致远程代码执行（RCE）和/或信息泄露和/或通过写入启用的 Default Servlet 将恶意内容添加到上传的文件中。根据漏洞描述和搜索结果，此漏洞利用需要特定配置才能成功。利用方式涉及通过 partial PUT 请求上传恶意构造的文件。提供的POC代码包含三个主要脚本：`01-prepare-environment.sh` 用于配置Tomcat环境，包括启用 DefaultServlet 的写入功能、配置会话持久化（RCE所需），以及下载必要的依赖（ysoserial和commons-collections）；`03-test.sh` 用于构造和发送包含恶意payload的PUT请求，使用ysoserial生成payload，利用CommonsCollections5链执行命令 `touch /tmp/pwndtomcat`。漏洞利用的关键在于 `Content-Range` 头部，该头部用于执行 partial PUT 请求，从而允许攻击者利用路径等价漏洞。该脚本通过修改Content-Range头部中的长度字段，来绕过一些安全检查，实现恶意payload的上传和执行。

**有效性：** 提供的POC代码有效，如果目标环境满足漏洞利用的先决条件（启用了DefaultServlet的写入功能，支持partial PUT，以及特定的部署配置），则可以成功利用该漏洞进行RCE或文件篡改/信息泄露。

**投毒风险：** 经过对POC代码的分析，未发现明显的投毒代码。该POC的目的是重现和利用CVE-2025-24813漏洞。脚本的行为符合漏洞利用的预期步骤，没有发现作者隐藏的恶意行为。所有操作都与漏洞利用直接相关。因此，投毒风险评估为0%。

**利用方式：**
1.  **环境准备：** 使用 `01-prepare-environment.sh` 脚本配置Tomcat环境，使其满足漏洞利用的先决条件（例如，启用写入的DefaultServlet，配置基于文件的会话管理）。
2.  **Payload生成：** 使用 `ysoserial` 工具生成恶意序列化 payload。  该 payload 会在目标服务器上执行任意命令。
3.  **Partial PUT 请求：**  使用 `03-test.sh` 脚本，通过精心构造的带有 `Content-Range` 头的 HTTP PUT 请求将 payload 发送到 Tomcat 服务器。 `Content-Range` 头的构造是利用漏洞的关键步骤。 
4.  **RCE/信息泄露/文件篡改：**  如果一切顺利，Tomcat 服务器会反序列化恶意 payload，导致在服务器上执行任意代码（RCE）或修改服务器上的文件，导致信息泄露或文件篡改。

**项目地址:** [manjula-aw/CVE-2025-24813](https://github.com/manjula-aw/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)