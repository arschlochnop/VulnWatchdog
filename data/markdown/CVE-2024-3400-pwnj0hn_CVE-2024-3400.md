## CVE-2024-3400 PAN-OS GlobalProtect 远程命令执行漏洞

**漏洞编号:** CVE-2024-3400

**漏洞类型:** 远程命令执行

**影响应用:** PAN-OS GlobalProtect

**危害等级:** 高危，未经身份验证的攻击者可以root权限执行任意代码。

**影响版本:** PAN-OS 10.2 (低于10.2.9-h1), PAN-OS 11.0 (低于11.0.4-h1), PAN-OS 11.1 (低于11.1.2-h3)

**利用条件:** 需要目标设备配置了GlobalProtect网关或门户，且攻击者可以访问GlobalProtect服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-3400 是 Palo Alto Networks PAN-OS 软件 GlobalProtect 功能中的一个命令注入漏洞。由于任意文件创建导致了命令注入。未经身份验证的远程攻击者可以通过利用此漏洞，以 root 权限在防火墙上执行任意代码。

**有效性：**
根据漏洞库信息、搜索结果以及提供的漏洞利用代码，可以判断该漏洞利用代码是有效的。漏洞库信息明确指出存在利用此漏洞的攻击，并且公开了PoC。提供的代码尝试创建一个文件，然后检查文件是否成功创建，以确认漏洞是否存在。搜索结果中也提到了该漏洞正在被积极利用。

**投毒风险：**
该PoC代码主要功能是检测目标是否存在漏洞，通过构造特殊的Cookie，尝试在目标服务器上创建文件。代码本身相对简单，主要使用了`requests`库发送HTTP请求，未发现明显的恶意行为。主要风险可能在于：
1.  **误报风险：**  PoC可能因为网络环境或其他因素导致误报。
2.  **资源消耗：**  如果大规模扫描，可能会对目标设备造成一定的资源消耗。
3.  **依赖风险：**  依赖requests库，如果该库被篡改，可能存在风险。

该PoC本身进行恶意操作的可能性很低，因此投毒风险较低，大约为 5%。

**利用方式：**
1.  **漏洞触发：** 攻击者构造包含特殊路径的Cookie，发送到受影响的PAN-OS设备的GlobalProtect服务。
2.  **任意文件创建：** 恶意Cookie中的路径被用于创建任意文件。
3.  **命令注入：** 由于文件创建过程中的不当处理，攻击者可以在文件名中注入操作系统命令。
4.  **代码执行：** 操作系统命令以root权限执行，从而允许攻击者完全控制受影响的设备。

简单来说，利用方式就是通过发送特制的HTTP请求，在目标设备上创建任意文件，进而执行任意命令。

**项目地址:** [pwnj0hn/CVE-2024-3400](https://github.com/pwnj0hn/CVE-2024-3400)

**漏洞详情:** [CVE-2024-3400](https://nvd.nist.gov/vuln/detail/CVE-2024-3400)