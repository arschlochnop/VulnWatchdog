## CVE-2017-7921 - Hikvision IP Camera Authentication Bypass and Configuration Decryption

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 认证绕过

**影响应用:** Hikvision IP Cameras

**危害等级:** 高危，可能导致敏感信息泄露和权限提升

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备存在漏洞且可网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2017-7921 存在于某些版本的 Hikvision IP 摄像头中，允许未经身份验证的攻击者绕过身份验证并下载包含敏感信息的配置文件。根据提供的漏洞利用代码，该漏洞通过在 URL 中提供一个特定的 base64 编码字符串（`auth=YWRtaW46MTEK`）来利用，从而允许下载配置文件。提供的 Python 脚本 `decrypt_configurationFile.py` 用于解密此配置文件。脚本使用 AES 解密（ECB 模式，密钥硬编码为 `279977f62f6cfd2d91cd75b889ce0c9a`）和 XOR 运算（密钥为 `0x73, 0x8B, 0x55, 0x44`）来提取有意义的字符串。有效性：根据漏洞信息和搜索引擎结果，此 POC 有效，可以绕过身份验证并解密敏感配置数据。投毒风险：代码中存在硬编码密钥，虽然这不是恶意投毒，但降低了安全性，如果攻击者修改默认密钥并传播，可能导致只有特定攻击者能利用。脚本本身的功能是解密配置文件，而不是执行恶意操作，因此直接投毒的风险较低。但存在修改脚本以包含其他恶意功能的潜在风险。这里判断投毒风险为5%主要是考虑到存在被其他攻击者修改脚本，放入其他后门的可能性。

**项目地址:** [chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor](https://github.com/chrisjd20/hikvision_CVE-2017-7921_auth_bypass_config_decryptor)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)