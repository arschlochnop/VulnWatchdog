## CVE-2017-5487 WordPress REST API 用户枚举

**漏洞编号:** CVE-2017-5487

**漏洞类型:** 信息泄露

**影响应用:** WordPress

**危害等级:** 低危，泄露用户名可能为后续攻击提供便利

**影响版本:** < 4.7.1

**利用条件:** 目标WordPress站点开启了REST API，且版本低于4.7.1

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-5487 漏洞存在于 WordPress 4.7 到 4.7.1 之前的版本中，是由于 REST API 实现中 `wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php` 文件对 post author 的列表权限限制不当造成的。攻击者可以通过构造 `wp-json/wp/v2/users` 请求，未授权地获取站点用户的用户名、ID 和其他信息。

**漏洞利用方式：**

1.  **发送请求：** 攻击者向目标 WordPress 站点发送一个 GET 请求，URL 为 `[WordPress站点URL]/wp-json/wp/v2/users`。
2.  **获取用户信息：** 如果站点存在漏洞，服务器会返回一个 JSON 格式的响应，其中包含用户的用户名、ID、名称等信息。

**POC代码分析：**

提供的 Python 脚本 `wpUsersScan.py` 的功能是利用该漏洞枚举 WordPress 用户的用户名。该脚本的主要流程如下：

1.  **输入 URL：** 脚本接收一个 URL 作为参数，该 URL 为目标 WordPress 站点的地址。
2.  **构造请求：** 脚本构造一个 REST API 请求，即向 `[URL]/wp-json/wp/v2/users` 发送 GET 请求。
3.  **解析响应：** 如果服务器返回状态码 200，则脚本解析 JSON 响应，并提取用户的 ID、名称和用户名，然后将这些信息输出到控制台。

**有效性评估：**

提供的POC代码针对的是 WordPress 4.7.1 之前的版本，在满足漏洞条件的情况下，可以有效地枚举用户名信息。

**投毒风险评估：**

查看提供的代码，`wpUsersScan.py` 脚本主要功能是发送 HTTP 请求并解析 JSON 响应，没有发现任何可疑的代码，例如执行系统命令、写入文件等恶意操作。`requirements.txt` 文件中列出的依赖库都是常见的 Python 库，没有发现包含恶意代码或已知漏洞的库。`README.md` 只是描述了脚本的使用方法，没有包含任何可执行代码。

因此，判定该仓库中存在作者隐藏的投毒代码的可能性为 0%。

**项目地址:** [R3K1NG/wpUsersScan](https://github.com/R3K1NG/wpUsersScan)

**漏洞详情:** [CVE-2017-5487](https://nvd.nist.gov/vuln/detail/CVE-2017-5487)