## CVE-2025-32395-Vite-文件读取

**漏洞编号:** CVE-2025-32395

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.13, >= 5.0.0, < 5.4.18, >= 6.0.0, < 6.0.15, >= 6.1.0, < 6.1.5, >= 6.2.0, < 6.2.6

**利用条件:** Vite dev server 运行于 Node 或 Bun，并暴露到网络 (使用 --host 或 server.host 配置)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-32395 存在于 Vite 的开发服务器中。由于 Vite 在检查 `server.fs.deny` 时未正确处理包含 `#` 字符的请求 URL，导致攻击者可以绕过文件系统限制，读取任意文件。

**有效性：**
根据漏洞描述和提供的 POC 代码，该漏洞利用是有效的。POC 代码首先尝试通过访问 `/@fs/tmp` 路径来获取根路径（root path），然后构造包含 `#` 字符的恶意 URL，例如 `/@fs{root_path}/#/../../../../../etc/passwd`，以读取 `/etc/passwd` 文件。代码使用原始套接字（raw socket）发送包含 `#` 字符的请求，因为标准的 HTTP 客户端可能无法处理此类 URL。如果成功读取到 `/etc/passwd` 文件，则认为目标存在漏洞。

**投毒风险：**
该 POC 代码中没有明显的投毒代码。它主要用于验证漏洞是否存在，目的是读取目标服务器上的文件。代码结构清晰，功能明确，没有发现任何尝试执行恶意操作或植入后门的迹象。

**利用方式：**
1.  **确定目标是否运行存在漏洞的 Vite 版本。**
2.  **确定 Vite dev server 是否已暴露到网络。**
3.  **获取根路径（root path）：** 通过访问 `/@fs/tmp` 路径，解析返回的 403 错误页面，提取文件路径信息。
4.  **构造恶意 URL：** 使用获取到的根路径构造包含 `#` 字符的 URL，例如 `/@fs{root_path}/#/../../../../../etc/passwd`。
5.  **发送恶意请求：** 使用原始套接字（raw socket）向目标服务器发送构造的恶意请求。
6.  **验证漏洞：** 检查响应内容，如果成功读取到 `/etc/passwd` 文件，则确认目标存在漏洞，攻击者可以读取服务器上的任意文件。

**项目地址:** [ruiwenya/CVE-2025-32395](https://github.com/ruiwenya/CVE-2025-32395)

**漏洞详情:** [CVE-2025-32395](https://nvd.nist.gov/vuln/detail/CVE-2025-32395)