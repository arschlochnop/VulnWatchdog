## CVE-2025-25257 - FortiWeb SQL注入

**漏洞编号:** CVE-2025-25257

**漏洞类型:** SQL 注入

**影响应用:** FortiWeb

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 未知，但搜索结果表明受影响版本已发布修复

**利用条件:** 目标 FortiWeb 实例可以通过网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据搜索结果和提供的漏洞利用代码，CVE-2025-25257 是 FortiWeb GUI 组件中存在的一个未经身份验证的 SQL 注入漏洞。漏洞位于`/api/fabric/device/status`接口，攻击者可以通过在 `Authorization`  header 中注入恶意 SQL 代码，从而绕过身份验证，最终实现远程代码执行。

**利用方式：**

1.  **SQL 注入：** 通过构造包含恶意 SQL 代码的 `Authorization` header 发送到 `/api/fabric/device/status` 接口。
2.  **写入 Webshell：**  利用 SQL 注入漏洞，将webshell内容写入到`/migadmin/cgi-bin/x.cgi`文件中。
3.  **权限修改：**  通过 SQL 注入漏洞，将修改 webshell 权限的代码写入到`/var/log/lib/python3.10/pylab.py`文件中，并触发执行，以确保 webshell 可执行。
4.  **远程代码执行：** 成功写入webshell之后，通过访问该webshell，并在HTTP `User-Agent`中传入要执行的命令，从而实现远程代码执行。

**有效性：**

提供的`exp.py`代码是一个完整的漏洞利用程序，可以实现从 SQL 注入到远程代码执行。代码通过注入 SQL 语句来写入 webshell 和权限修改脚本，最后通过访问 webshell 执行任意命令。

**投毒风险：**

代码本身存在一定的投毒风险，但风险较低。例如，webshell的位置、python hook的位置是固定的，如果攻击者替换掉这些位置，导致漏洞利用失败，会存在一定的风险。此外`signed.py` 文件内容不完整，被截断，也无法进行分析。作者可能在编写过程中添加隐藏的后门或者修改脚本，但根据现有的代码，主要关注以下几点：

*   **webshell 内容：** webshell 代码是否包含恶意功能。
*   **chmod 脚本：**  chmod 脚本是否执行了预期之外的操作。
*   **请求头注入的参数：**  注入的参数是否经过了特殊编码，如果包含恶意代码则存在风险。

**漏洞修复建议：**

建议尽快升级 FortiWeb 版本到官方发布的修复版本，以避免受到攻击。

**项目地址:** [0xbigshaq/CVE-2025-25257](https://github.com/0xbigshaq/CVE-2025-25257)

**漏洞详情:** [CVE-2025-25257](https://nvd.nist.gov/vuln/detail/CVE-2025-25257)