## CVE-2025-27591-below-权限提升

**漏洞编号:** CVE-2025-27591

**漏洞类型:** 权限提升

**影响应用:** below

**危害等级:** 高危，本地用户可以获得root权限

**影响版本:** < 0.9.0

**利用条件:** 目标系统运行着低于0.9.0版本的below，且本地用户可以执行below命令。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-27591是一个存在于below服务0.9.0之前版本的权限提升漏洞。漏洞原因是below服务在/var/log/below/目录下创建了一个世界可写的目录。攻击者可以利用这个漏洞，通过创建指向敏感文件（如/etc/passwd）的符号链接，然后通过below服务对日志文件的写入操作，来修改这些敏感文件，最终实现权限提升。提供的PoC脚本首先备份/etc/passwd，然后创建一个从/var/log/below/error_root.log到/etc/passwd的符号链接。接着，脚本循环执行below命令，并在每次循环中尝试向/etc/passwd文件中注入一个新的root用户。如果注入成功，脚本会提示用户可以使用新创建的root用户登录。如果所有尝试都失败，脚本会恢复原始的/etc/passwd文件。 

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。漏洞库信息明确指出该漏洞是由于不正确的权限分配导致，搜索结果中也包含了多个关于该漏洞的描述和PoC链接，以及PoC代码本身的说明，都表明该漏洞是可利用的。

**投毒风险：**

检查提供的POC代码后，未发现明显的投毒代码。脚本的主要功能是利用符号链接漏洞修改/etc/passwd文件。其中涉及到的操作，如备份、创建符号链接、注入用户、恢复文件等，都是与漏洞利用直接相关的步骤。该仓库中没有发现任何试图损害系统或窃取信息的恶意代码。

**利用方式：**

该漏洞的利用方式如下：

1.  **创建世界可写目录：** below服务创建了一个世界可写的目录/var/log/below/。
2.  **符号链接攻击：** 攻击者利用该目录，创建一个指向/etc/passwd的符号链接，命名为/var/log/below/error_root.log。
3.  **日志写入：** 运行below服务会导致它向/var/log/below/error_root.log（即/etc/passwd）写入日志信息。
4.  **注入恶意用户：** 攻击者通过向/var/log/below/error_root.log写入包含恶意用户的字符串，将恶意用户的信息添加到/etc/passwd文件中。
5.  **权限提升：** 攻击者使用新添加的恶意用户登录，获得root权限。

**项目地址:** [danil-koltsov/below-log-race-poc](https://github.com/danil-koltsov/below-log-race-poc)

**漏洞详情:** [CVE-2025-27591](https://nvd.nist.gov/vuln/detail/CVE-2025-27591)