## CVE-2025-51396 - LiveHelperChat Stored XSS

**漏洞编号:** CVE-2025-51396

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** LiveHelperChat

**危害等级:** 中危，可能导致敏感信息泄露，会话劫持，甚至管理账号被控制。

**影响版本:** <= 4.61

**利用条件:** 需要操作员用户权限，能够访问和修改Telegram Bot设置。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

漏洞存在于LiveHelperChat 4.61及更早版本中。攻击者可以通过在Telegram Bot Username字段中注入恶意JavaScript代码，实现存储型XSS。当管理员或其他具有更高权限的用户访问或编辑Telegram Bot配置时，这段恶意代码会被执行。

**有效性：**
POC代码有效。通过在Telegram Bot Username字段中插入`<img src="x" onerror="prompt(1);">`，可以触发XSS漏洞。

**投毒风险：**
虽然readme中的PoC看起来没有直接的恶意代码。 但是Github仓库可能包含作者隐藏的其他恶意payload或者脚本，或者直接在LiveHelperChat的代码中隐藏后门，此仓库中存在作者隐藏的投毒代码的可能性为10%。

**利用方式：**
1.  攻击者以操作员身份登录LiveHelperChat。
2.  导航到`Settings > Live Help Configuration > Telegram Bot`。
3.  在“Bot Username”字段中，输入XSS payload，例如`<img src="x" onerror="prompt(1);">`。
4.  保存设置。
5.  每当管理员访问Telegram配置页面时，payload就会执行。这可能导致会话劫持、敏感信息泄露，或在管理员上下文中执行恶意操作。

**项目地址:** [Thewhiteevil/CVE-2025-51396](https://github.com/Thewhiteevil/CVE-2025-51396)

**漏洞详情:** [CVE-2025-51396](https://nvd.nist.gov/vuln/detail/CVE-2025-51396)