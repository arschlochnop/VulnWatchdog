## CVE-2025-61183 - VaahCMS Stored XSS

**漏洞编号:** CVE-2025-61183

**漏洞类型:** Stored XSS

**影响应用:** VaahCMS

**危害等级:** 高危，攻击者可以控制受害者浏览器执行恶意脚本，可能导致会话劫持、信息窃取、恶意重定向等。

**影响版本:** 2.3.1

**利用条件:** 需要低权限用户账号，目标服务器允许上传SVG文件，且允许通过<img>或<object>等标签加载`/storage/media/`目录下的SVG文件。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-61183存在于VaahCMS 2.3.1版本，是一个存储型XSS漏洞。攻击者可以通过上传包含恶意JavaScript代码的SVG文件来利用此漏洞。关键在于服务器在保存文件到`/storage/media/YYYY/MM/<controlled-filename>.svg`路径之前没有进行充分的内容或MIME类型验证。由于文件路径可预测，攻击者可以诱导其他用户访问该SVG文件，从而执行恶意脚本。

**有效性：**
提供的PoC代码描述了漏洞利用的完整流程，包括创建恶意SVG文件、上传、以及诱导用户访问，因此PoC代码有效。

**投毒风险：**
分析提供的README.md文件，没有发现任何与XSS Payload无关的可疑代码。该仓库的主要目标是展示和解释漏洞，而不是隐藏恶意代码。POC代码描述的也是XSS漏洞验证的流程，没有发现额外的后门，因此可以认为投毒风险为0%。POC.svg文件需要进一步分析以确定其Payload，但从现有信息来看，没有理由认为存在投毒。

**利用方式：**
1.  攻击者创建一个恶意的SVG文件，该文件包含嵌入的JavaScript代码，例如`<svg onload=alert(document.domain)>`。
2.  攻击者使用低权限用户账户登录VaahCMS系统。
3.  攻击者利用`/backend/vaah/manage/media/upload` endpoint上传该恶意SVG文件，并控制文件名。
4.  即使后端返回错误（例如，由于文件解码失败），文件仍然会保存到`/storage/media/YYYY/MM/<controlled-filename>.svg`路径下。
5.  攻击者将包含该SVG文件URL的链接发送给受害者，或者将该URL嵌入到其他页面中（例如论坛帖子、评论等）。
6.  当受害者访问包含该SVG文件URL的页面或直接访问该URL时，浏览器会执行SVG文件中的JavaScript代码，从而触发XSS攻击。

**项目地址:** [thawphone/CVE-2025-61183](https://github.com/thawphone/CVE-2025-61183)

**漏洞详情:** [CVE-2025-61183](https://nvd.nist.gov/vuln/detail/CVE-2025-61183)