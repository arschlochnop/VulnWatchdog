## CVE-2024-28000 - LiteSpeed Cache Privilege Escalation

**漏洞编号:** CVE-2024-28000

**漏洞类型:** 权限提升

**影响应用:** LiteSpeed Cache

**危害等级:** 高危，可导致完全控制 WordPress 站点

**影响版本:** < 6.4

**利用条件:** 目标站点安装了受影响版本的 LiteSpeed Cache 插件，且未进行相关安全加固

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-28000 是 LiteSpeed Cache WordPress 插件中一个严重权限提升漏洞。未经身份验证的攻击者可以通过暴力破解插件使用的弱安全哈希来获得管理员权限。漏洞利用过程如下：

1.  **触发哈希生成：** PoC脚本首先尝试触发目标站点上安全哈希的生成，这通常通过发送一个未经验证的 AJAX 请求到 `admin-ajax.php`来实现，模拟爬虫行为。
2.  **暴力破解哈希：** 脚本使用多线程暴力破解弱安全哈希。该哈希用于用户模拟功能。
3.  **权限提升：** 找到有效的哈希后，攻击者可以将其与目标管理员用户的用户 ID 一起放置在 cookie 中，从而模拟该用户并获得管理员权限。

**有效性：** 根据漏洞信息、搜索结果和 PoC 代码，该漏洞利用是有效的。多个来源证实了该漏洞的存在和严重性，并提供了可用于利用它的 PoC 代码。

**投毒风险：** PoC 代码本身主要功能是进行漏洞验证，用于提权。经过对 PoC 代码的分析，发现存在一定的投毒风险，风险点在于：

1.  **硬编码的用户名和密码：** PoC 中包含创建新管理员用户的代码，其中用户名 (`newadminuser`) 和密码 (`NewAdminPassword123!`) 是硬编码的。如果攻击者直接使用该 PoC，且目标站点没有其他安全措施，则可能导致恶意用户创建可长期控制站点的后门账户，即使漏洞本身被修复，后门仍然存在。
2.  **不完善的错误处理：** 代码中部分错误处理不够严谨,可能导致某些异常情况下,恶意代码被执行。

因此，虽然该 PoC 的主要目的是验证漏洞，但其中的某些部分可能被恶意利用来植入后门，有一定的投毒风险，估计约为 10%。

**利用方式：**

1.  确定目标站点是否运行受影响版本的 LiteSpeed Cache 插件。
2.  运行 PoC 脚本，设置目标 URL 和管理员用户 ID。
3.  PoC 脚本将触发哈希生成，然后尝试暴力破解该哈希。
4.  如果破解成功，PoC 将打印有效的哈希值。
5.  攻击者可以使用该哈希值和管理员用户 ID 设置 cookie，从而获得管理员权限。也可以使用PoC中添加用户的逻辑，添加一个管理员用户。
6.  成功登录后，攻击者可以完全控制 WordPress 站点。

**项目地址:** [Alucard0x1/CVE-2024-28000](https://github.com/Alucard0x1/CVE-2024-28000)

**漏洞详情:** [CVE-2024-28000](https://nvd.nist.gov/vuln/detail/CVE-2024-28000)