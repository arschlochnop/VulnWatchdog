## CVE-2021-27905-ApacheSolr-SSRF

**漏洞编号:** CVE-2021-27905

**漏洞类型:** SSRF

**影响应用:** Apache Solr

**危害等级:** 高危，可能导致服务器端请求伪造，信息泄露和潜在的RCE

**影响版本:** < 8.8.2

**利用条件:** 需要目标Solr实例的/replication接口对外开放且未进行访问控制

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞存在于Apache Solr的ReplicationHandler中。攻击者可以通过操纵`masterUrl`或`leaderUrl`参数，指定一个恶意的URL，导致Solr服务器向该URL发起请求，从而实现SSRF攻击。提供的Python脚本利用了这一漏洞，通过向`/solr/{core}/replication`接口发送包含恶意`masterUrl`的请求，来尝试触发SSRF。脚本首先尝试获取Solr Core的名称，然后构造包含恶意DNSLog服务器地址的`masterUrl`，并发送请求。如果DNSLog服务器收到了请求，则证明漏洞存在。经过对提供的python脚本`CVE-2021-27905.py`和`README.md`文件内容检查，未发现任何可疑的或恶意的代码片段，因此判断不存在投毒风险。

**项目地址:** [Henry4E36/Solr-SSRF](https://github.com/Henry4E36/Solr-SSRF)

**漏洞详情:** [CVE-2021-27905](https://nvd.nist.gov/vuln/detail/CVE-2021-27905)