## CVE-2023-23752-Joomla-信息泄露

**漏洞编号:** CVE-2023-23752

**漏洞类型:** 信息泄露

**影响应用:** Joomla! CMS

**危害等级:** 中危，可能泄露敏感信息，例如数据库配置和用户信息。

**影响版本:** 4.0.0-4.2.7

**利用条件:** 目标Joomla!站点开启了webservice endpoints且版本在受影响范围内。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-23752 是 Joomla! 4.0.0 到 4.2.7 版本中存在的一个不当访问控制漏洞。未经身份验证的攻击者可以通过访问 webservice endpoints 来获取敏感信息，例如用户信息（用户名、邮箱、用户组等）和站点配置（数据库类型、主机、用户名、密码等）。

**漏洞利用有效性：**

根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。搜索引擎结果中明确指出该漏洞是一个身份验证绕过漏洞，允许未经身份验证的用户访问敏感信息。提供的漏洞利用代码 `exploit.rb` 验证了这一点，它通过构造特定的URL（例如 `/api/index.php/v1/users?public=true` 和 `/api/index.php/v1/config/application?public=true`）来访问 webservice endpoints，从而获取用户信息和数据库配置信息。

**投毒风险：**

分析 `exploit.rb` 脚本，该脚本主要功能是：

1.  发送 HTTP 请求到特定的 webservice endpoints。
2.  解析返回的 JSON 数据。
3.  提取并显示用户信息和数据库配置信息。

脚本中没有发现任何可疑的代码，例如执行系统命令、上传文件或修改系统配置。虽然脚本依赖于 `httpx`、`docopt` 和 `paint` 这几个 gem，但这些 gem 都是常见的 Ruby 库，被供应链投毒的可能性较低。但依然存在微小的风险，如果攻击者替换了这些 gem 的源，并将恶意代码注入到这些 gem 中，则可能存在投毒风险，因此判断投毒风险为5%。

**利用方式：**

1.  确定目标 Joomla! 站点版本是否在受影响范围内 (4.0.0-4.2.7)。
2.  安装脚本所需的 Ruby gems：`httpx`、`docopt` 和 `paint`。
3.  运行 `exploit.rb` 脚本，并提供目标站点的 URL 作为参数。
4.  脚本会发送请求到 `/api/index.php/v1/users?public=true` 和 `/api/index.php/v1/config/application?public=true` 这两个 endpoints，获取用户信息和数据库配置信息，并将其显示在控制台上。

**项目地址:** [n3rdh4x0r/CVE-2023-23752](https://github.com/n3rdh4x0r/CVE-2023-23752)

**漏洞详情:** [CVE-2023-23752](https://nvd.nist.gov/vuln/detail/CVE-2023-23752)