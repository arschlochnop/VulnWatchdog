## CVE-2025-32965 - xrpl.js Supply Chain Attack

**漏洞编号:** CVE-2025-32965

**漏洞类型:** 供应链攻击

**影响应用:** xrpl.js

**危害等级:** 极危，可导致加密货币资金完全失控

**影响版本:** 4.2.1, 4.2.2, 4.2.3, 4.2.4, 2.14.2

**利用条件:** 受影响版本的xrpl.js被集成到使用XRP Ledger的应用程序中

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32965 描述了 xrpl.js 库（版本 4.2.1, 4.2.2, 4.2.3, 4.2.4 和 2.14.2）中存在的供应链攻击。受影响的版本包含恶意代码，旨在窃取 XRP Ledger 账户的私钥（seed）。

**有效性：** 提供的 PoC 代码有效。`test.js` 模拟了使用 `xrpl.js` 生成钱包的行为，而 `fake_xrpl.js` 中 `checkValidityOfSeed` 函数模拟了恶意代码，将生成的 seed 数据发送到攻击者的服务器（`poc-listener:3000`）。攻击者的服务器 `server.js` 接收并记录窃取的 seed。 Dockerfile 定义了构建和运行 PoC 的环境。

**投毒风险：** 仓库中存在作者隐藏的投毒代码的风险较低，估计约为 5%。代码的主要目的是重现已知漏洞。虽然 `fake_xrpl.js` 本身是恶意代码的模拟，但其目的是展示漏洞的利用，而非进一步的攻击或隐藏后门。 潜在的风险可能存在于攻击者控制 poc-listener 服务器，并利用窃取的 seed 进行恶意活动的可能性。此外，也存在用户在未经充分审查的情况下直接使用或修改 PoC 代码，从而引入新的漏洞或暴露自身风险的可能性。

**利用方式：** 攻击者通过以下步骤利用此漏洞：

1.  **入侵 xrpl.js 仓库/发布渠道：** 攻击者通过某种方式（例如，入侵维护者账户或利用发布系统的漏洞）篡改了 xrpl.js 库的特定版本。
2.  **植入恶意代码：** 攻击者在受影响的 xrpl.js 版本中插入了恶意代码。该恶意代码通常会拦截私钥或 seed 的生成/使用过程。
3.  **分发恶意版本：** 攻击者将包含恶意代码的 xrpl.js 版本发布到 npm 等包管理平台上。
4.  **受害者安装/更新：** 开发人员在不知情的情况下安装或更新到受感染的 xrpl.js 版本。
5.  **私钥泄露：** 当受害者使用受感染的 xrpl.js 版本生成或使用 XRP Ledger 账户时，恶意代码会将私钥/seed 发送到攻击者的服务器。
6.  **资金盗取：** 攻击者使用窃取的私钥访问受害者的 XRP Ledger 账户，并转移资金。

**项目地址:** [yusufdalbudak/CVE-2025-32965-xrpl-js-poc](https://github.com/yusufdalbudak/CVE-2025-32965-xrpl-js-poc)

**漏洞详情:** [CVE-2025-32965](https://nvd.nist.gov/vuln/detail/CVE-2025-32965)