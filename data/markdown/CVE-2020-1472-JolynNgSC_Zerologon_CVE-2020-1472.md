## CVE-2020-1472 Netlogon Elevation of Privilege Vulnerability (Zerologon)

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows Server

**危害等级:** 高危，允许未经身份验证的攻击者获取域管理员权限并完全控制域

**影响版本:** 受影响的Windows Server版本包括2008 R2 SP1, 2012, 2012 R2, 2016, 2019, 1903, 1909, 2004, 20H2

**利用条件:** 攻击者需要与域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472 (Zerologon) 是 Microsoft Netlogon 协议中的一个严重漏洞，允许未经身份验证的攻击者通过设置 Netlogon 安全通道连接的客户端凭据为全零来冒充域控制器。成功利用此漏洞后，攻击者可以接管整个 Windows 域。 

**有效性:**  根据搜索引擎结果和漏洞利用代码，此漏洞的POC代码是有效的。许多安全研究人员和组织已经成功地利用此漏洞进行了概念验证和实际攻击。

**投毒风险:**  提供的代码仓库主要包含漏洞利用步骤和检测方法，用于模拟 Zerologon 攻击以进行防御和缓解。其中提到的[https://github.com/dirkjanm/CVE-2020-1472](https://github.com/dirkjanm/CVE-2020-1472)是原始漏洞利用代码，本身不包含恶意代码，投毒风险主要存在于引用的第三方库或者其他未明确说明的操作中。由于该代码库的目的在于演示漏洞，且代码量相对较小，人工可以审核，因此判断投毒风险较低。但依旧存在一定的风险。通过分析整个代码仓库，包含恶意代码的风险预估为10%。

**利用方式:**

1.  **利用漏洞:**  攻击者使用提供的 Python 脚本（cve-2020-1472-exploit.py）将域控制器的 Netlogon 安全通道凭据设置为全零。
2.  **获取域管理员哈希:**  使用 `secretsdump.py` 从域控制器转储域管理员哈希。
3.  **权限提升:**  使用 `wmiexec.py` 通过获得的域管理员哈希来执行任意命令并完全控制域。

**缓解措施:**

*   及时应用 Microsoft 提供的安全补丁。
*   监控 Windows 事件查看器中与 Zerologon 攻击相关的事件 ID（例如，4624 和 4742）。
*   强制执行安全的 RPC 与 Netlogon 连接。

**项目地址:** [JolynNgSC/Zerologon_CVE-2020-1472](https://github.com/JolynNgSC/Zerologon_CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)