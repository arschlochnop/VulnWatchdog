## CVE-2023-4357-Google Chrome XML File Access Restriction Bypass

**漏洞编号:** CVE-2023-4357

**漏洞类型:** 文件访问限制绕过

**影响应用:** Google Chrome

**危害等级:** 中危，可能导致本地文件读取

**影响版本:** < 116.0.5845.96

**利用条件:** 需要用户打开包含恶意SVG的HTML页面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-4357是Google Chrome浏览器中XML解析器的一个漏洞，允许远程攻击者通过构造恶意的HTML页面绕过文件访问限制，读取本地文件。

**有效性分析：**
根据漏洞信息和漏洞利用代码，该POC利用了XML外部实体注入（XXE）来读取`/etc/passwd`文件。`proof.svg`文件包含一个指向自身的`xml-stylesheet`声明，然后使用DTD中的`<!ENTITY>`定义了两个实体`passwd_p`和`passwd_c`，它们的值指向本地文件`/etc/passwd`。 XSLT样式表用于处理XML文档，并将文件内容插入到HTML中。 `server.py` 搭建了一个简单的HTTP服务器来提供 `proof.svg` 文件，`Start.sh` 脚本首先启动HTTP服务器，然后使用`--no-sandbox`参数启动Chrome浏览器，并打开`http://localhost:8000`， 从而触发该漏洞。因为chromium 需要 `--no-sandbox` 启动，所以利用的成功率并不高。

**投毒风险分析：**
查看提供的代码，`Start.sh` 脚本用于启动服务器和Chrome，没有发现可疑行为。`proof.svg` 文件包含了XXE漏洞的payload，目的是读取`/etc/passwd`文件，本身不包含恶意代码。`server.py` 只是一个简单的HTTP服务器，用于提供SVG文件，也没有发现可疑行为。因此，此仓库中作者隐藏投毒代码的可能性很低，风险评估为0%。

**利用方式：**
1.  攻击者创建一个包含恶意SVG文件的HTML页面。
2.  攻击者诱使用户使用受影响的Chrome浏览器打开该HTML页面。
3.  Chrome浏览器解析SVG文件时，由于XML解析器对用户提供的输入验证不足，恶意SVG文件中的XXE payload会被执行。
4.  攻击者可以利用XXE漏洞读取本地文件（如`/etc/passwd`），绕过文件访问限制。
5.  读取的文件内容会显示在页面上，并且可以通过JavaScript发送到攻击者的服务器。

**项目地址:** [CamillaFranceschini/CVE-2023-4357](https://github.com/CamillaFranceschini/CVE-2023-4357)

**漏洞详情:** [CVE-2023-4357](https://nvd.nist.gov/vuln/detail/CVE-2023-4357)