## CVE-2025-8088 WinRAR 路径遍历漏洞

**漏洞编号:** CVE-2025-8088

**漏洞类型:** 路径遍历

**影响应用:** WinRAR

**危害等级:** 高危，允许攻击者执行任意代码

**影响版本:** <= 7.12

**利用条件:** 用户需要解压恶意RAR压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8088是一个WinRAR的路径遍历漏洞。攻击者可以通过构造恶意的RAR压缩包，将恶意文件释放到任意目录，从而执行任意代码。

**有效性评估：**

根据漏洞库信息、搜索引擎结果以及提供的PoC代码，此漏洞是真实存在的，并且已经被在野利用。PoC代码利用了NTFS ADS (Alternate Data Streams) 和 RAR5 的header 操控技术，可以绕过WinRAR的路径检查。

**投毒风险分析：**

PoC代码主要由`gui.py`和`exploit_core.py`组成。`gui.py`负责提供图形界面，`exploit_core.py` 负责实现漏洞利用的核心逻辑，例如创建恶意RAR文件、操作ADS等。代码中存在以下可能的风险点：
* 直接运行WinRAR CLI，如果WinRAR CLI本身存在安全问题，可能会引入新的安全风险。
*  依赖于`customtkinter`等第三方库，如果这些库被投毒，PoC也会受到影响。
*  虽然代码中没有明显的恶意行为，例如反弹shell，信息窃取等，但是如果攻击者修改`payload_path`参数，则可能造成用户运行恶意程序。

综合来看，此PoC代码的投毒风险较低，约为10%。主要风险来自攻击者利用此PoC传播包含恶意payload的恶意RAR文件。

**利用方式：**

1.  **创建恶意RAR文件：** 使用PoC代码生成一个恶意的RAR压缩包，该压缩包包含一个恶意payload（例如：.exe、.bat等）以及一个诱饵文件(可选)。
2.  **利用ADS隐藏payload：**  利用NTFS ADS将payload隐藏在诱饵文件中。
3.  **操纵RAR5 Header：** 通过直接修改RAR5的头部信息，插入路径遍历字符串，例如：`..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\payload.exe`
4.  **传播：** 将恶意的RAR文件发送给目标用户。
5.  **解压：** 目标用户使用受漏洞影响的WinRAR版本解压该RAR文件。
6.  **执行payload：** 由于路径遍历漏洞，payload被释放到`Windows Startup`目录下，当用户重启计算机时，payload会自动执行。


**项目地址:** [onlytoxi/CVE-2025-8088-Winrar-Tool](https://github.com/onlytoxi/CVE-2025-8088-Winrar-Tool)

**漏洞详情:** [CVE-2025-8088](https://nvd.nist.gov/vuln/detail/CVE-2025-8088)