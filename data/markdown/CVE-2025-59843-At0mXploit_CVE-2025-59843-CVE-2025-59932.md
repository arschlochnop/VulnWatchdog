## CVE-2025-59843 & CVE-2025-59932 - FlagForgeCTF 信息泄露和未授权资源操作

**漏洞编号:** CVE-2025-59843

**漏洞类型:** 信息泄露 (CVE-2025-59843) 和 未授权操作 (CVE-2025-59932)

**影响应用:** FlagForgeCTF flagForge

**危害等级:** 中危/高危 (取决于CVE-2025-59932是否可利用)

**影响版本:** >= 2.0.0, < 2.3.1 (CVE-2025-59843)； 未知 (CVE-2025-59932，未经确认)

**利用条件:** 网络可访问 /api/user/[username] 和 /api/resources 端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-59843 是一个信息泄露漏洞，存在于 FlagForgeCTF 的 flagForge 2.0.0 到 2.3.0 版本。攻击者可以通过访问公开的 `/api/user/[username]` API 端点，获取用户的电子邮件地址。该漏洞利用简单，只需要构造一个包含目标用户名的 URL 即可。

CVE-2025-59932 是一个潜在的未授权资源修改/删除漏洞，攻击者可能在未经身份验证的情况下通过 `POST` 和 `DELETE` 方法操作 `/api/resources` 端点。 PoC 代码提供了创建和删除资源的 `curl` 命令。然而，PoC代码中的提示表明，该漏洞并未在生产环境中进行测试，其可利用性未知。如果 `POST` 和 `DELETE` 请求确实未经身份验证，则风险级别为高危。

**有效性：**
* CVE-2025-59843: PoC 代码有效，通过 `curl` 请求可以获取用户邮箱。
* CVE-2025-59932: PoC 代码的 `GET` 方法有效，可以获取资源信息。`POST` 和 `DELETE` 方法的有效性未经验证，但根据 OPTIONS 请求的结果（允许 DELETE, GET, HEAD, OPTIONS, POST），存在利用的可能性。

**投毒风险：**
分析提供的 PoC 代码和 `README.md` 文件，未发现明显的恶意代码或后门。代码主要展示了如何利用漏洞，不存在作者试图通过该仓库植入恶意代码的迹象。因此，投毒风险估计为 0%。

**利用方式：**
* **CVE-2025-59843：** 通过构造 `https://staging.flagforge.xyz/api/user/[username]` URL，替换 `[username]` 为目标用户名，即可获取该用户的电子邮件地址。可以使用 `curl` 或其他 HTTP 客户端发送请求。
* **CVE-2025-59932：**
    1.  首先，使用 `GET` 请求获取资源的 `_id`。
    2.  如果 `POST` 方法未经身份验证，则可以使用提供的 `curl` 命令创建新资源，通过指定 `title`、`description` 等字段，构造恶意的资源。
    3.  如果 `DELETE` 方法未经身份验证，则可以使用提供的 `curl` 命令删除资源，需要将 `<resource-id>` 替换为目标资源的 `_id`。

**项目地址:** [At0mXploit/CVE-2025-59843-CVE-2025-59932](https://github.com/At0mXploit/CVE-2025-59843-CVE-2025-59932)

**漏洞详情:** [CVE-2025-59843](https://nvd.nist.gov/vuln/detail/CVE-2025-59843)