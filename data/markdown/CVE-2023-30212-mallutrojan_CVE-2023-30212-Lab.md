## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** 反射型跨站脚本 (XSS)

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户凭据泄露、会话劫持、恶意脚本执行等

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-30212 是一个存在于 OURPHP <= 7.2.0 版本的反射型 XSS 漏洞，位于 `/client/manage/ourphp_out.php` 文件中。攻击者可以通过构造包含恶意 JavaScript 代码的 URL，诱使用户点击该链接，从而在用户的浏览器中执行恶意脚本。根据提供的漏洞利用代码，可以通过访问 `http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=%3C/script%3E%3Cscript%3Ealert(`xss`)%3C/script%3E` 触发 XSS 漏洞。

**有效性:** 提供的 POC 代码有效，可以成功触发 XSS 漏洞。

**投毒风险:**
Dockerfile 文件用于构建包含 OURPHP v7.2.0 的 Docker 镜像，脚本 `lab.sh` 用于自动安装 Docker、下载 OURPHP 代码、构建 Docker 镜像并运行容器。`lab.sh`脚本存在一定的投毒风险：
  * **下载恶意代码:**`lab.sh` 从`https://down.chinaz.com/api/index/download?id=51308&type=code` 下载 zip 文件，该链接有潜在的风险，如果chinaz被攻击，可能导致下载的文件被替换为恶意文件。
  * **执行任意命令：**`lab.sh` 通过 `docker exec` 执行 MySQL 命令，赋予 root 用户所有权限。虽然这是为了方便漏洞利用，但也可能被利用于执行恶意命令。但是考虑到脚本主要目的是创建一个可利用的环境，因此投毒的可能性较低，大约为 10%。

**利用方式:**
1.  攻击者构造包含恶意 JavaScript 代码的 URL，例如：`http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=%3C/script%3E%3Cscript%3Ealert(`xss`)%3C/script%3E`
2.  攻击者诱使用户点击该 URL（例如通过电子邮件、社交媒体等方式）。
3.  当用户点击该 URL 时，恶意 JavaScript 代码将在用户的浏览器中执行。
4.  恶意代码可以窃取用户的 Cookie、会话信息，或者执行其他恶意操作。

**项目地址:** [mallutrojan/CVE-2023-30212-Lab](https://github.com/mallutrojan/CVE-2023-30212-Lab)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)