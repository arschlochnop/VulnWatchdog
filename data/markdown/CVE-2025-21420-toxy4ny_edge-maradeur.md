## CVE-2025-21420-Windows Disk Cleanup Tool-权限提升

**漏洞编号:** CVE-2025-21420

**漏洞类型:** 权限提升

**影响应用:** Windows Disk Cleanup Tool

**危害等级:** 高危，可导致系统权限被获取

**影响版本:** 受影响的Windows版本见CVE描述

**利用条件:** 需要物理访问（BadUSB）或者已控制目标机器执行powershell

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息和提供的POC代码，此漏洞利用的有效性较高。漏洞CVE-2025-21420允许攻击者通过Windows Disk Cleanup Tool获得权限提升。利用方式如下：

1.  **漏洞描述：** CVE-2025-21420 是 Windows Disk Cleanup Tool 的一个权限提升漏洞，攻击者可以利用此漏洞获取 SYSTEM 权限。

2.  **利用方式：** 提供的POC代码（`edge-maradeur.txt`）是一个BadUSB脚本，它模拟键盘输入，执行以下步骤：
    *   创建一个计划任务 `ElevatePrivileges`，该任务使用 SYSTEM 权限运行 PowerShell。
    *   该PowerShell脚本的功能是:
        *   获取当前用户名。
        *   定位Edge浏览器的Login Data数据库文件。
        *   在C:\temp创建临时目录
        *   复制Login Data数据库到临时目录。
        *   使用提供的 FTP 凭据将Login Data数据库上传到远程FTP服务器。
        *   删除临时文件。
        *   退出 PowerShell。
    *   该脚本结合了CVE-2025-21420和CVE-2025-21401（根据README.md）。

3.  **有效性：** 该POC的有效性取决于以下因素：
    *   目标系统是否受 CVE-2025-21420 影响。
    *   目标系统是否安装了Edge浏览器，且存在Login Data数据库。
    *   攻击者是否拥有可用的FTP服务器和有效的凭据。
    *   目标系统是否允许执行powershell

4.  **投毒风险分析：**  POC 中存在一定的投毒风险，虽然主要功能是利用漏洞提升权限并导出Edge浏览器的数据，但以下几点需要关注：
    *   **FTP 上传：** 恶意攻击者可能通过控制 FTP 服务器来收集受害者的数据，例如浏览器保存的密码等敏感信息，存在信息泄露的风险。
    *   **计划任务：** 计划任务如果被滥用，可能被用于持久化后门。
    *   **C:\temp目录创建:** 如果创建临时目录失败，或者删除临时文件失败，也可能会导致拒绝服务或者留下恶意文件。

    综合考虑，我认为投毒风险为 10%。主要的风险在于，攻击者可能会利用此脚本在目标系统上植入后门或者窃取信息，但脚本本身的功能和目标相对明确，隐藏恶意代码的空间有限。 该脚本主要是配合BadUSB实现的攻击，如果用户对BadUSB设备不了解,容易被攻击.


**项目地址:** [toxy4ny/edge-maradeur](https://github.com/toxy4ny/edge-maradeur)

**漏洞详情:** [CVE-2025-21420](https://nvd.nist.gov/vuln/detail/CVE-2025-21420)