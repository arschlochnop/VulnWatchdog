## CVE-2017-5487-WordPress-用户枚举

**漏洞编号:** CVE-2017-5487

**漏洞类型:** 信息泄露/用户枚举

**影响应用:** WordPress

**危害等级:** 中危，可能泄露用户名等敏感信息，为进一步攻击提供便利

**影响版本:** 4.7 before 4.7.1

**利用条件:** 目标WordPress版本低于4.7.1，且REST API未被禁用或限制访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞源于WordPress 4.7到4.7.1版本中REST API实现中，`wp-includes/rest-api/endpoints/class-wp-rest-users-controller.php` 文件对post作者的列表权限控制不当。攻击者可以通过未授权访问 `/wp-json/wp/v2/users` 接口，获取包括用户名、用户ID等敏感信息。提供的POC代码 `/tmp/db5e3ca75342225c0181e046c0133ca1/wp.py` 利用了 leakix.net 搜索引擎，搜索包含wordpress字样且URL中含有`/wp/v2/users/`的链接，然后从搜索结果中的链接发送GET请求，解析返回的JSON数据，从而枚举用户名和其他相关信息。漏洞利用的有效性取决于目标网站是否在 leakix.net 的索引中，且目标WordPress版本是否受影响。漏洞利用代码本身主要功能在于信息收集，从leakix.net上搜索链接再请求并打印，没有发现恶意代码，因此投毒风险为0%。

利用方式总结：

1.  确定目标WordPress站点版本低于4.7.1。
2.  未授权访问REST API接口 `/wp-json/wp/v2/users`。
3.  解析返回的JSON数据，提取用户名、用户ID等信息。
4.  利用收集到的信息进行进一步的攻击，如暴力破解密码。

**项目地址:** [zkhalidul/GrabberWP-CVE-2017-5487](https://github.com/zkhalidul/GrabberWP-CVE-2017-5487)

**漏洞详情:** [CVE-2017-5487](https://nvd.nist.gov/vuln/detail/CVE-2017-5487)