## CVE-2021-43798 Grafana 目录遍历/任意文件读取

**漏洞编号:** CVE-2021-43798

**漏洞类型:** 目录遍历/任意文件读取

**影响应用:** Grafana

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** 8.0.0-beta1 to 8.3.0 (除已修复版本)

**利用条件:** Grafana 服务需要对外开放，攻击者能够通过网络访问目标 Grafana 实例。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2021-43798 存在于 Grafana 8.0.0-beta1 到 8.3.0 版本。攻击者可以通过构造特殊的 URL，利用目录遍历漏洞读取 Grafana 服务器上的任意文件。漏洞利用的关键在于 `public/plugins//` 路径，其中  是已安装插件的 ID。攻击者可以通过构造包含 `../../` 的路径来突破目录限制，读取服务器上的敏感文件，例如 `/etc/passwd`。提供的 POC 代码 `grafana.py` 实现了该漏洞的利用。该脚本通过发送包含恶意路径的 HTTP 请求，检查响应中是否包含 `/etc/passwd` 的内容，来判断漏洞是否存在。脚本支持单个 URL 和 URL 列表的批量检测。虽然漏洞本身是直接的目录遍历，但POC 中存在通过`poc.txt`读取poc的潜在风险，这个txt文件存在被投毒的风险，如果txt文件被投毒，那么最终执行结果就会导致被攻击。

**项目地址:** [k3rwin/CVE-2021-43798-Grafana](https://github.com/k3rwin/CVE-2021-43798-Grafana)

**漏洞详情:** [CVE-2021-43798](https://nvd.nist.gov/vuln/detail/CVE-2021-43798)