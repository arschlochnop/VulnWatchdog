## CVE-2017-10271-Oracle WebLogic Server-反序列化RCE

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化RCE

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问，目标服务器开启T3协议或存在可访问的/wls-wsat/CoordinatorPortType端点

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中的一个反序列化远程代码执行漏洞。未经身份验证的攻击者可以通过 T3 协议或发送特制的 SOAP 请求到 `/wls-wsat/CoordinatorPortType` 端点来利用此漏洞。 漏洞利用方式是构造包含恶意 Java 对象的 XML 数据，利用 `java.beans.XMLDecoder` 进行反序列化，从而在目标服务器上执行任意命令。

提供的漏洞利用代码包含以下几个部分：

*   `README.md`:  包含漏洞描述和参考链接。
*   `exploit.py`:  一个 Python 脚本，它接受 WebLogic Server 的 URL 和要执行的命令作为输入，并发送包含恶意 XML 数据的 POST 请求到 `/wls-wsat/CoordinatorPortType` 端点。
*   `payloads.py`: 包含生成payload的脚本

**有效性：**
根据漏洞库信息和提供的漏洞利用代码，该漏洞是可以利用的。`exploit.py`脚本构造包含命令的 XML payload，并通过 HTTP POST 请求发送到目标服务器。成功利用此漏洞会导致远程代码执行。

**投毒风险：**
审阅了提供的代码，没有发现明显的投毒代码。该代码的功能主要是为了利用 CVE-2017-10271 漏洞，执行用户指定的命令。但是，需要注意的是，在生产环境中，使用任何未经授权的漏洞利用代码都存在风险。

**利用方式：**

1.  攻击者需要确定目标 WebLogic Server 的版本是否在受影响的范围内 (10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0)。
2.  攻击者需要找到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
3.  攻击者使用提供的 `exploit.py` 脚本，指定目标 URL 和要执行的命令。
4.  `exploit.py` 脚本会构造包含恶意 XML 数据的 SOAP 请求，并将其发送到目标服务器的 `/wls-wsat/CoordinatorPortType` 端点。
5.  WebLogic Server 在处理 SOAP 请求时，会使用 `java.beans.XMLDecoder` 反序列化 XML 数据，从而执行攻击者指定的命令。

请注意，成功利用此漏洞需要目标服务器没有安装相应的补丁。

**项目地址:** [c0mmand3rOpSec/CVE-2017-10271](https://github.com/c0mmand3rOpSec/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)