## CVE-2024-11042-invokeai-Arbitrary File Delete

**漏洞编号:** CVE-2024-11042

**漏洞类型:** 任意文件删除

**影响应用:** invoke-ai/invokeai

**危害等级:** 高危，可能导致数据丢失、服务中断、敏感信息泄露

**影响版本:** < 5.3.0

**利用条件:** 需要网络访问invokeai的Web API接口，该接口未授权。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-11042是invokeai v5.0.2中存在的一个任意文件删除漏洞。未经授权的攻击者可以利用`POST /api/v1/images/delete`接口删除服务器上的任意文件，包括关键系统文件。提供的POC代码通过构造一个包含要删除文件名的JSON payload，并发送到目标API端点，从而实现文件删除。因为POC代码只是简单的发起POST请求并删除指定文件，没有发现任何隐藏的恶意代码或后门，因此投毒风险评估为0%。

**漏洞利用方式：**

1.  **确定目标:**  确定运行invokeai且版本低于5.3.0的服务器。
2.  **构造请求:**  修改POC代码，设置目标URL、端口和要删除的文件路径（`--url`, `--port`, `--images`参数）。
3.  **发送请求:**  运行POC代码，发送包含目标文件路径的POST请求到`/api/v1/images/delete`。
4.  **验证结果:**  检查服务器，确认目标文件已被删除。

**有效性评估：**
根据漏洞库信息、搜索引擎结果和提供的POC代码，该漏洞的利用是有效的。POC代码能够成功地向目标API发送请求，并根据提供的文件列表删除相应文件。

**优先级：**
由于漏洞允许未经授权的任意文件删除，对系统完整性和可用性构成严重威胁，应给予高优先级修复。

**项目地址:** [gothburz/CVE-2024-11042](https://github.com/gothburz/CVE-2024-11042)

**漏洞详情:** [CVE-2024-11042](https://nvd.nist.gov/vuln/detail/CVE-2024-11042)