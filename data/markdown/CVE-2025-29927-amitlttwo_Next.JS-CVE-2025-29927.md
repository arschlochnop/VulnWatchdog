## CVE-2025-29927-Next.js中间件授权绕过

**漏洞编号:** CVE-2025-29927

**漏洞类型:** 授权绕过

**影响应用:** Next.js

**危害等级:** 高危，可能导致未经授权的访问和数据泄露

**影响版本:** >= 11.1.4, <= 13.5.6; > 14.0.0, < 14.2.25; > 15.0.0, < 15.2.3

**利用条件:** Next.js应用使用了中间件进行授权检查

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29927 是 Next.js 中间件授权绕过漏洞。攻击者可以通过操纵 `x-middleware-subrequest` 头部来绕过中间件中的授权检查，从而访问受保护的资源。利用方式如下：

1.  **漏洞原理：**  Next.js 在处理内部子请求时，对 `x-middleware-subrequest` 头部处理不当，导致授权检查失效。
2.  **攻击步骤：** 攻击者构造包含 `x-middleware-subrequest` 头部的恶意 HTTP 请求，发送到存在漏洞的 Next.js 应用。
3.  **影响：**  成功利用此漏洞可能导致未经授权的用户访问敏感数据或执行未授权操作。
4.  **缓解措施：**  升级到 Next.js 14.2.25 或 15.2.3 及以上版本，或阻止包含 `x-middleware-subrequest` 头部的外部请求。
5.  **POC分析：** 提供的Go代码是一个Next.js版本扫描器，它通过发送HTTP请求并检查响应头或内容来检测目标URL是否运行Next.js，并尝试确定其版本。然后，它将检测到的版本与已知的易受攻击的版本范围进行比较，以确定目标是否容易受到CVE-2025-29927的攻击。此代码**本身不包含利用漏洞的后门**，而只是一个用于确定目标系统是否易受攻击的工具。

**投毒风险分析：**

虽然提供的Go代码主要用于漏洞检测，但仍存在一些潜在的投毒风险：

*   **依赖风险：** `go.mod`文件未提供，代码依赖第三方库，如`github.com/fatih/color`、`github.com/hashicorp/go-version`。恶意作者可能篡改这些依赖项，植入恶意代码。**风险较低，但不能排除**。
*   **输出控制：**  扫描器可以将结果输出到文件。如果输出文件被其他系统或进程使用，恶意作者可能通过精心构造的扫描结果，间接影响其他系统。**风险较低**。
* **逻辑后门:** 代码会根据配置项`-thorough`决定是否进行更彻底的验证，作者可能存在隐藏的判断，当特定条件满足时，存在连接恶意服务器，或者执行特定操作.该风险较低. 因此，综合评估，该代码的投毒风险较低，估计在 **5%** 左右。需要人工审核依赖项和输出逻辑，以确保安全性。

**项目地址:** [amitlttwo/Next.JS-CVE-2025-29927](https://github.com/amitlttwo/Next.JS-CVE-2025-29927)

**漏洞详情:** [CVE-2025-29927](https://nvd.nist.gov/vuln/detail/CVE-2025-29927)