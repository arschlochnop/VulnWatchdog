## CVE-2019-9053-CMS Made Simple-SQL注入

**漏洞编号:** CVE-2019-9053

**漏洞类型:** 时间盲注SQL注入

**影响应用:** CMS Made Simple

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** <= 2.2.9（漏洞报告称<= 2.2.8, 但利用代码标明 <= 2.2.9, 搜索引擎结果显示2.2.10及更早版本也受影响，取最宽松版本<= 2.2.9）

**利用条件:** 需要目标CMS存在 News 模块，且攻击者能够发起HTTP请求

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-9053 存在于 CMS Made Simple 2.2.9 及更早版本的 News 模块中。攻击者可以通过构造恶意的 URL 参数 `m1_idlist`，利用时间盲注（Time-Based Blind SQL Injection）来获取数据库中的敏感信息，例如管理员的 salt，用户名，邮箱和密码哈希值。由于是时间盲注，攻击者根据服务器响应时间来判断SQL语句是否执行成功。提供的PoC代码利用了这一漏洞，并通过增大 `TIME` 变量和增加重试逻辑来提高利用的成功率。攻击需要`requests`和`termcolor`库。代码主要功能为：1. 提取Salt；2. 提取用户名；3. 提取邮箱；4. 提取密码哈希。如果提供了密码字典和`-c`参数，则尝试进行密码破解。

**关于投毒风险的分析：**

该PoC代码整体结构清晰，主要是利用时间盲注读取数据，并无发现明显的恶意代码。代码修改说明中提及增强了错误处理和提高了代码可读性，这些修改都是合理的。存在轻微投毒的可能性，主要体现在以下几个方面：

*   **依赖项风险：** 依赖`requests`和`termcolor`库，如果这些库被恶意篡改，可能引入安全风险。但这并非PoC代码本身的投毒。
*   **密码破解模块：** 密码破解部分依赖外部字典文件，如果攻击者提供一个包含恶意Payload的字典，可能导致目标系统受到攻击，但这属于字典文件投毒，而非PoC代码本身。
*   **时间延迟：** 虽然增加了TIME变量是为了提高可靠性，但过长的延迟也可能被恶意利用，例如拖慢服务器速度，但不太可能构成严重的投毒。

综上，PoC代码本身投毒的可能性较低，主要是需要防范依赖库和字典文件带来的风险。

**利用方式：**

1.  攻击者发送包含恶意 SQL 注入 Payload 的 HTTP 请求，该Payload 位于 `moduleinterface.php` 中 `m1_idlist` 参数
2.  服务器执行 Payload，由于是时间盲注，攻击者根据服务器响应时间来判断注入的条件是否成立，从而推断出数据库中的信息。
3.  如果提供字典，则尝试破解密码。

**项目地址:** [Dh4nuJ4/SimpleCTF-UpdatedExploit](https://github.com/Dh4nuJ4/SimpleCTF-UpdatedExploit)

**漏洞详情:** [CVE-2019-9053](https://nvd.nist.gov/vuln/detail/CVE-2019-9053)