## CVE-2025-9074 - Docker Desktop 远程 API 未授权访问

**漏洞编号:** CVE-2025-9074

**漏洞类型:** 未授权访问

**影响应用:** Docker Desktop

**危害等级:** 高危，可能导致容器逃逸、主机控制

**影响版本:** < 4.44.3

**利用条件:** Docker Desktop 版本低于 4.44.3，并且运行 Linux 容器，攻击者需要位于Docker容器网络中。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-9074 漏洞存在于 Docker Desktop 中，允许本地运行的 Linux 容器通过 Docker 子网（默认 192.168.65.7:2375）访问 Docker Engine API。此漏洞的利用方式是，攻击者通过容器内的 Python 脚本，向未授权的 Docker Engine API 发送请求，创建并启动新的容器，从而执行任意命令，甚至挂载宿主机文件系统，最终实现容器逃逸和主机控制。

**有效性：**

根据漏洞描述、搜索引擎结果和提供的 PoC 代码，该漏洞的 PoC 代码有效。PoC 代码通过 Python 脚本，利用 `requests` 库向 Docker Engine API 发送 HTTP 请求，模拟了创建、启动容器并执行命令的过程。

**投毒风险：**

PoC 代码本身主要目的是演示漏洞利用，但仍然存在一定的投毒风险。 虽然 README 声明仅用于教育目的，并且明确说明了漏洞已修复，但`exploit.py`脚本可以被修改为执行恶意操作，例如下载并执行任意代码。默认代码中，挂载了宿主机根目录`/mnt/host/c:/host_root`。这增加了宿主机被篡改的可能性。 此外，代码缺乏严格的输入验证，使得攻击者有可能通过精心构造的 `cmd` 参数来绕过安全检查。综合评估，投毒风险为10%。

**利用方式：**

1.  攻击者需要运行一个 Linux 容器，并确保该容器与 Docker Desktop 共享同一个网络（通常是 192.168.65.0/24）。
2.  攻击者使用 PoC 脚本，指定 Docker Engine API 的 URL（例如 `http://192.168.65.7:2375`）和要执行的命令。
3.  PoC 脚本首先通过 API 创建一个新的容器，镜像为 Alpine Linux，并执行指定的命令。其中，通过 Binds 将主机目录挂载到容器中，是提权的关键一步。
4.  然后，PoC 脚本启动该容器，命令会在容器内执行。
5.  PoC 脚本可以获取容器的日志，从而查看命令执行的结果。
6.  （可选）PoC 脚本可以清理创建的容器。

**项目地址:** [j3r1ch0123/CVE-2025-9074](https://github.com/j3r1ch0123/CVE-2025-9074)

**漏洞详情:** [CVE-2025-9074](https://nvd.nist.gov/vuln/detail/CVE-2025-9074)