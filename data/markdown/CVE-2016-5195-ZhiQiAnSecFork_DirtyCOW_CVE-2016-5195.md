## CVE-2016-5195 Dirty COW

**漏洞编号:** CVE-2016-5195

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获得root权限

**影响版本:** Linux kernel 2.x through 4.x before 4.8.3

**利用条件:** 需要本地用户权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2016-5195，又名Dirty COW，是一个Linux内核中的竞争条件漏洞。此漏洞存在于Linux内核的内存子系统中，在处理私有只读内存映射的写时复制（COW）断裂时存在缺陷。一个非特权本地用户可以利用此漏洞获得对只读内存映射的写访问权限，从而提升他们在系统上的权限。

**有效性：**
提供的POC代码是有效的。多个来源（漏洞库信息，搜索引擎结果，和漏洞利用代码）都确认了此漏洞的存在，并提供了可利用的POC。

**投毒风险：**
尽管提供的代码仓库主要是漏洞利用的示例和测试脚本，仍然存在一定的投毒风险。 风险点在于：

1.  **脚本来源：** 脚本通常从外部URL下载，如果原始URL被篡改，可能引入恶意代码。
2.  **Root权限要求：** 检测脚本需要root权限运行，如果被植入恶意代码，可能对系统造成严重破坏。
3.  **GCC编译：**脚本会下载C代码并编译，如果C代码被篡改，可能引入后门或恶意功能。

因此，虽然大部分代码是用于验证漏洞，但由于其执行方式和对外部资源的依赖，仍然存在一定的投毒风险。 评估为10%。

**利用方式：**
1.  **利用竞争条件：** 攻击者创建一个只读内存映射的文件。
2.  **触发写时复制(COW):**  攻击者使用多线程并发地尝试写入只读内存映射，同时利用`/proc/self/mem`文件映射到进程的内存空间。
3.  **绕过权限检查：** 由于竞争条件，内核在某些情况下无法正确处理写时复制，导致写入操作绕过只读保护。
4.  **权限提升：** 成功写入只读内存映射后，攻击者可以修改系统文件（如`/etc/passwd`）或注入恶意代码，从而获得root权限。

**项目地址:** [ZhiQiAnSecFork/DirtyCOW_CVE-2016-5195](https://github.com/ZhiQiAnSecFork/DirtyCOW_CVE-2016-5195)

**漏洞详情:** [CVE-2016-5195](https://nvd.nist.gov/vuln/detail/CVE-2016-5195)