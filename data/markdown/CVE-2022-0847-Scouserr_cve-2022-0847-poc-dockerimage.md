## CVE-2022-0847-Dirty Pipe

**漏洞编号:** CVE-2022-0847

**漏洞类型:** 本地提权

**影响应用:** Linux Kernel

**危害等级:** 高危，本地权限提升

**影响版本:** Linux Kernel 5.8+

**利用条件:** 本地用户，可读取目标文件

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2022-0847，又名Dirty Pipe，是一个Linux内核中的权限提升漏洞。该漏洞源于`copy_page_to_iter_pipe`和`push_pipe`函数中新的管道缓冲区结构的“flags”成员缺乏适当的初始化，可能包含过时值。未经授权的本地用户可以利用此漏洞写入由只读文件支持的页面缓存中的页面，从而提升他们在系统上的权限。

**利用方式：**

1.  利用pipe机制将数据写入内核缓冲区。
2.  覆盖只读文件在page cache中的内容。
3.  利用被覆盖的文件，例如SUID程序，来提升权限。

**有效性：**

根据搜索结果，该漏洞存在可用的PoC。提供的PoC代码只是一个README文件，但搜索结果表明存在其他的exp代码。因此，结合漏洞库信息和搜索结果，可以判定存在有效的PoC利用该漏洞。

**投毒风险：**

提供的PoC代码只有一个README.md文件，内容为空，几乎不包含投毒代码的可能。假设该仓库中存在恶意代码，那么投毒风险是1%。虽然给出的代码本身看起来无害，但用户从其他来源下载的exp代码需要仔细审查，以确保没有植入恶意代码。

**项目地址:** [Scouserr/cve-2022-0847-poc-dockerimage](https://github.com/Scouserr/cve-2022-0847-poc-dockerimage)

**漏洞详情:** [CVE-2022-0847](https://nvd.nist.gov/vuln/detail/CVE-2022-0847)