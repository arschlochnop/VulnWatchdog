## CVE-2023-3460 - Ultimate Member Privilege Escalation

**漏洞编号:** CVE-2023-3460

**漏洞类型:** 权限提升

**影响应用:** Ultimate Member WordPress Plugin

**危害等级:** 高危，允许未授权用户创建管理员账户并完全控制网站

**影响版本:** < 2.6.7

**利用条件:** Ultimate Member插件版本低于2.6.7，并且允许用户注册。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-3460 是 Ultimate Member WordPress 插件中存在的一个权限提升漏洞，版本低于 2.6.7。未经身份验证的攻击者可以利用此漏洞创建具有管理员权限的用户帐户，从而完全控制受影响的 WordPress 网站。漏洞利用方式通常涉及发送特制的 HTTP 请求到 WordPress 站点的注册页面，在请求中包含将新注册用户的角色设置为管理员的参数。 

**有效性评估：**
根据漏洞库信息、搜索引擎结果和漏洞利用代码，该漏洞利用是有效的。漏洞库明确指出该漏洞正在被积极利用。搜索引擎结果中也提供了关于此漏洞的详细信息，包括其影响和利用方式。提供的漏洞利用代码（虽然是 drawio 文件，需要进一步分析其具体利用步骤，但可以确定其目标是权限提升）进一步证实了该漏洞的可利用性。

**投毒风险分析：**
提供的POC代码包含一个README.md文件和一个drawio图表文件。README.md提供的是linux权限提升的学习链接,而非漏洞利用代码。drawio文件是一个流程图，不能直接运行。虽然该文件本身不能直接执行恶意代码，但如果攻击者在论坛或博客中发布，并声称是利用此漏洞的“流程图”，并篡改流程图中的步骤（例如，包含从恶意来源下载和执行脚本的指令），则可能存在投毒风险。但根据目前内容，可以判断投毒风险较低，约为5%。

**利用方式分析：**
1.  **未授权访问注册页面：** 攻击者无需登录即可访问 WordPress 站点的用户注册页面。
2.  **构造恶意注册请求：** 攻击者构造包含特定参数的 HTTP 请求，模拟用户注册过程。关键参数通常是 `role` 或 `capabilities`，用于指定新注册用户的角色。攻击者将这些参数设置为 `administrator` 或其他具有管理员权限的角色。
3.  **绕过权限检查：** 漏洞的根本原因是 Ultimate Member 插件未正确验证或清理注册请求中的用户角色参数。这导致攻击者能够绕过正常的权限检查机制。
4.  **创建管理员账户：** WordPress 接收到恶意注册请求后，由于插件的漏洞，会将攻击者指定的角色分配给新注册的用户。因此，攻击者可以成功创建一个具有管理员权限的用户帐户。
5.  **完全控制网站：** 攻击者使用新创建的管理员帐户登录 WordPress 站点，并获得对网站的完全控制权，包括修改内容、安装插件、删除文件等。

**项目地址:** [TranKuBao/CVE-2023-3460_FIX](https://github.com/TranKuBao/CVE-2023-3460_FIX)

**漏洞详情:** [CVE-2023-3460](https://nvd.nist.gov/vuln/detail/CVE-2023-3460)