## CVE-2011-2523-vsftpd-Backdoor

**漏洞编号:** CVE-2011-2523

**漏洞类型:** 后门

**影响应用:** vsftpd

**危害等级:** 高危，远程代码执行

**影响版本:** 2.3.4 downloaded between 20110630 and 20110703

**利用条件:** 目标系统运行存在后门的 vsftpd 2.3.4 版本，且防火墙未阻止 6200 端口的连接

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2011-2523 是 vsftpd 2.3.4 版本中存在的一个后门漏洞。该后门存在于 2011 年 6 月 30 日至 2011 年 7 月 3 日期间下载的版本中。攻击者可以通过向目标 FTP 服务器发送特制的用户名 'USER Hello:)' 和密码 'PASS Hello:)'，触发后门。触发后，vsftpd 会在目标服务器上监听 6200 端口。攻击者可以通过连接到 6200 端口获得一个 root shell，从而执行任意命令。

提供的 exploit.py 脚本利用了这一漏洞。首先，它会尝试连接到目标 FTP 服务器，并检查服务器 banner 是否包含 '2.3.4'，以验证目标是否为易受攻击的版本。然后，它发送特制的用户名和密码来触发后门。最后，它使用 Telnet 连接到 6200 端口，获得一个交互式的 shell。

**漏洞利用有效性：**
根据漏洞信息和提供的利用代码，该漏洞利用方式是有效的。PoC代码实现了漏洞描述中的利用方式，即通过特定的用户名和密码组合触发后门，并在6200端口获得shell。

**投毒风险：**
在提供的 `exploit.py` 脚本中，没有明显的投毒代码。代码的目的是利用已知的 vsftpd 后门漏洞。脚本的功能是连接到目标 FTP 服务器，发送特定的用户名和密码来触发后门，然后连接到 6200 端口以获得 shell。脚本中的所有操作都与利用该后门漏洞相关，没有发现任何额外或恶意的功能。但是，依然存在极小的风险，可能存在不易察觉的隐藏指令，因此投毒风险评估为 1%。脚本本身功能是利用已经存在的后门，而并非植入新的后门或者恶意程序。

**利用方式：**
1.  **版本检查：** 连接到目标FTP服务器，检查banner信息，确认目标服务器运行的是存在后门的vsftpd 2.3.4版本。
2.  **触发后门：** 向目标FTP服务器发送特制的用户名 "USER Hello:)
" 和密码 "PASS Hello:)
"。
3.  **连接到后门shell：** 使用Telnet客户端连接到目标服务器的6200端口，获得一个root shell。
4.  **执行命令：** 在获得的shell中执行任意命令。

**项目地址:** [0xSojalSec/CVE-2011-2523](https://github.com/0xSojalSec/CVE-2011-2523)

**漏洞详情:** [CVE-2011-2523](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)