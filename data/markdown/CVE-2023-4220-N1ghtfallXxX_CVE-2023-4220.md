## CVE-2023-4220-Chamilo LMS-远程代码执行

**漏洞编号:** CVE-2023-4220

**漏洞类型:** 远程代码执行

**影响应用:** Chamilo LMS

**危害等级:** 高危，可完全控制服务器

**影响版本:** <= 1.11.24

**利用条件:** 需要网络访问，Chamilo LMS版本小于等于1.11.24

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-4220 是 Chamilo LMS 中一个未授权的任意文件上传漏洞。攻击者可以通过向 `/main/inc/lib/javascript/bigupload/inc/bigUpload.php` 发送恶意请求，上传包含恶意代码的 PHP 文件，从而实现远程代码执行。

**有效性：**

根据搜索引擎结果和漏洞利用代码，该漏洞的利用是有效的。存在公开可用的 PoC 代码，可以验证该漏洞的存在并实现远程代码执行。搜索结果中也提到了远程代码执行的风险。

**投毒风险：**

提供的漏洞利用代码包含两个文件：`README.md` 和 `chamilo-rce.py`。
*   `README.md`: 包含漏洞描述、利用方法和免责声明，没有发现恶意代码。
*   `chamilo-rce.py`: 是一个 Python 脚本，用于生成包含反向 shell 的 PHP payload，并将其上传到目标服务器。脚本会根据用户输入的 IP 地址和端口，生成反向 shell 代码，并保存为 `rce.php` 文件。然后，脚本会构造一个 HTTP 请求，将 `rce.php` 文件上传到存在漏洞的 Chamilo LMS 实例。

虽然该脚本本身旨在利用漏洞，但它允许用户自定义反向 shell 的 IP 地址和端口。 因此，虽然利用本身是恶意的，但脚本本身并没有被投毒。只有非常轻微的投毒风险，例如在代码中引入细微的错误或依赖项，使得Payload失效，或者导致目标系统不稳定。但此几率极低。

**利用方式：**

1.  攻击者克隆包含PoC的git仓库 `https://github.com/N1ghtfallXxX/CVE-2023-4220` 
2.  攻击者通过 `chamilo-rce.py` 脚本生成包含恶意 PHP 代码的文件（Web Shell）。
3.  利用漏洞，未经验证上传恶意 PHP 文件。
4.  通过访问上传的 PHP 文件，执行其中的恶意代码，从而获得服务器的控制权。
5.  通过反弹shell连接攻击者本地监听端口,获得服务器shell

**项目地址:** [N1ghtfallXxX/CVE-2023-4220](https://github.com/N1ghtfallXxX/CVE-2023-4220)

**漏洞详情:** [CVE-2023-4220](https://nvd.nist.gov/vuln/detail/CVE-2023-4220)