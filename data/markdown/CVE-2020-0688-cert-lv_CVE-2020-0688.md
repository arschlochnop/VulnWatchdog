## CVE-2020-0688 Microsoft Exchange Server 远程代码执行漏洞

**漏洞编号:** CVE-2020-0688

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，可能导致完全系统控制

**影响版本:** 受影响版本包括：Microsoft Exchange Server 2010 SP3 UR30、2013 CU23、2016 CU14/CU15、2019 CU3/CU4

**利用条件:** 需要有效的Exchange用户凭据

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0688 是 Microsoft Exchange Server 中的一个远程代码执行漏洞，它源于服务器未能正确处理内存中的对象。该漏洞是由于 Exchange 在安装时未能创建唯一的密钥导致的，攻击者可以利用静态密钥进行 ViewState 的反序列化攻击，从而执行任意代码。根据搜索结果和漏洞利用代码可知，此漏洞利用需要有效的 Exchange 用户凭据，并且该漏洞已经被积极利用。提供的漏洞利用代码 (scan.py) 主要用于识别易受攻击的 Exchange 服务器，而真正的漏洞利用还需要配合其他工具，例如ysoserial.net生成恶意ViewState。

**有效性：** 该漏洞的POC代码有效，可以用于检测存在漏洞的Exchange服务器。

**投毒风险：** 提供的`scan.py`和`lib.py`代码主要是用于扫描存在漏洞的服务器，没有直接包含恶意代码，但是仍然存在一定的投毒风险：
1. **依赖风险：**`scan.py`依赖于zmap以及一些python库，如果攻击者篡改了这些依赖项，可能会引入恶意代码。
2. **结果利用：** 扫描结果可能被攻击者用于识别易受攻击的服务器，从而发起进一步的攻击。 虽然该脚本本身看起来没有恶意投毒代码，但无法保证作者不会在未来版本中添加恶意代码。由于利用过程中需要用户本身具有一定权限，即使存在投毒代码，也需要用户执行才会触发。因此，综合评估投毒风险为10%。

**利用方式：**
1.  **获取用户凭据:** 攻击者首先需要获得Exchange用户的有效凭据(通常通过钓鱼等方式)。
2.  **识别漏洞服务器:** 使用类似于提供的`scan.py`脚本识别存在CVE-2020-0688漏洞的Exchange服务器。
3.  **生成恶意ViewState:** 利用ysoserial.net等工具，使用已知的静态密钥生成包含恶意代码的ViewState。
4.  **发送恶意请求:**  将包含恶意ViewState的请求发送到Exchange服务器的某个页面 (例如`/ecp/default.aspx`)，服务器反序列化ViewState时执行恶意代码，从而实现远程代码执行。

总的来说，CVE-2020-0688是一个严重的安全漏洞，需要及时修补。即使已经修补，也应该定期检查系统是否存在被入侵的痕迹。

**项目地址:** [cert-lv/CVE-2020-0688](https://github.com/cert-lv/CVE-2020-0688)

**漏洞详情:** [CVE-2020-0688](https://nvd.nist.gov/vuln/detail/CVE-2020-0688)