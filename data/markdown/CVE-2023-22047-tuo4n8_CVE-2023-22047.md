## CVE-2023-22047 - Oracle PeopleSoft Unauthenticated File Read Vulnerability

**漏洞编号:** CVE-2023-22047

**漏洞类型:** 文件读取/SSRF/潜在RCE

**影响应用:** PeopleSoft Enterprise PeopleTools

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 8.59, 8.60

**利用条件:** 需要网络访问 PeopleSoft Enterprise PeopleTools 服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-22047 存在于 Oracle PeopleSoft Enterprise PeopleTools 的 Portal 组件中。该漏洞允许未经身份验证的攻击者通过 HTTP 进行网络访问，从而危及 PeopleSoft Enterprise PeopleTools。成功利用此漏洞可能导致未经授权访问关键数据或完全访问所有 PeopleSoft Enterprise PeopleTools 可访问的数据。 

**有效性分析：**

根据提供的漏洞信息和漏洞利用代码，POC代码看起来是有效的。它利用了 `/RP` 接口，并通过 `wsrp-url` 参数读取服务器上的文件。成功读取 `/etc/passwd` 或 `c:\windows\win.ini` 文件可以验证漏洞的存在。

**投毒风险分析：**

该POC的主要功能是读取文件。通过分析 `CVE-2023-22047.yaml` 和 `README.md` 文件，并没有发现明显的恶意代码或后门。`README.md` 中提到的 RCE 利用链是基于 SSRF 进一步利用 WebLogic 的 RESTful Management Services，属于对漏洞的更深层次利用，而不是 POC 本身携带的恶意代码。但是，存在以下潜在风险：
*   **依赖环境：** POC 依赖 Nuclei 扫描器，如果 Nuclei 被篡改，可能存在风险。
*   **二次利用：** 攻击者可能修改 POC，添加恶意功能，例如尝试读取更敏感的文件或者利用 SSRF 进行更危险的操作。
因此，投毒风险不能完全排除，但主要风险在于使用者对 POC 的不当使用或依赖软件的安全性问题，而不在于原始 POC 本身。因此，判定投毒风险为10%。

**利用方式分析：**

1.  **文件读取：** 攻击者可以利用该漏洞读取服务器上的任意文件，例如配置文件、日志文件等，从而获取敏感信息。
2.  **SSRF：** `README.md` 中提到，该漏洞实际上可以被利用为 SSRF（服务器端请求伪造）漏洞。攻击者可以利用 `wsrp-url` 参数向内部网络发起请求，探测内部服务，或进行进一步的攻击。
3.  **RCE（潜在）：** `README.md` 中提到，如果目标系统启用了 WebLogic 的 RESTful Management Services，攻击者可以利用 SSRF 读取 WebLogic 的 `SerializedSystemIni.dat` 和 `credentials` 文件，解密后获取 WebLogic 的管理凭据，然后使用 REST API 部署 webshell，最终实现远程代码执行。这个过程需要多个步骤，并且依赖特定的配置，但表明该漏洞具有升级为 RCE 的潜力。

**总结：**

该漏洞危害较高，易于利用，可能导致信息泄露和潜在的 RCE。建议受影响的用户尽快升级到安全版本。

**项目地址:** [tuo4n8/CVE-2023-22047](https://github.com/tuo4n8/CVE-2023-22047)

**漏洞详情:** [CVE-2023-22047](https://nvd.nist.gov/vuln/detail/CVE-2023-22047)