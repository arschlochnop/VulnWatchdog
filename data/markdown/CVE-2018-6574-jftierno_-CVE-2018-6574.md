## CVE-2018-6574

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程代码执行

**影响应用:** Go

**危害等级:** 高危，可能导致完全控制受影响的系统

**影响版本:** Go before 1.8.7, Go 1.9.x before 1.9.4, and Go 1.10 pre-releases before Go 1.10rc2

**利用条件:** 受害者使用存在漏洞的 Go 版本，并且运行 `go get` 获取恶意代码。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 允许攻击者通过 `go get` 命令执行远程代码。具体利用方式如下：

1.  **攻击者创建恶意 Go 包：** 攻击者创建一个包含恶意代码的 Go 包，利用 gcc 或 clang 插件特性。 在提供的POC代码中,attack.c 文件定义了一个 `malicious()` 函数，该函数被声明为 `__attribute__((constructor))`，这意味着它会在程序加载时自动执行。该函数会执行 `system("/usr/local/bin/score a321915f-37a6-465f-be95-ce9602f6a9e1")` 命令。这表明攻击者试图执行一个特定的程序 `/usr/local/bin/score`，并传递一个特定的ID作为参数。

2.  **诱导受害者获取恶意包：** 攻击者诱导受害者使用 `go get` 命令获取该恶意包。这可以通过多种方式实现，例如通过社会工程学攻击，或者将恶意包伪装成有用的工具库。

3.  **构建时执行恶意代码：** 当受害者使用 `go get` 命令获取并构建恶意包时，Go 会调用 gcc 或 clang 来编译代码。由于存在漏洞，Go 没有正确地过滤 `-fplugin=` 和 `-plugin=` 参数，导致 gcc 或 clang 加载并执行攻击者提供的恶意插件，从而执行攻击者预先设定的恶意代码。

**有效性分析：**
提供的POC代码通过构造一个包含constructor属性的C代码，在编译时自动执行恶意命令`/usr/local/bin/score a321915f-37a6-465f-be95-ce9602f6a9e1`。如果攻击者能够控制 go get 获取的源码，并在其中包含类似的代码，那么这个POC是有效的。

**投毒风险分析：**
提供的POC代码本身没有明显的投毒行为，它只是简单地执行一个命令。是否包含投毒代码需要分析 go get 获取的整个代码仓库，而不仅仅是 attack.c 这个文件。根据目前的信息，无法确定是否存在投毒风险。
提供的 attack.c 代码直接执行预设的命令，没有发现隐藏恶意行为的迹象。假设作者仅提供了已验证可复现漏洞的代码，所以判定投毒风险为0%

**利用方式总结：**
攻击者利用该漏洞，主要是利用了`go get`命令在构建过程中的不安全行为，通过`gcc`或`clang`的插件机制执行恶意代码，达到远程代码执行的目的。攻击的关键在于诱使受害者获取并构建包含恶意插件的Go包。

**项目地址:** [jftierno/-CVE-2018-6574](https://github.com/jftierno/-CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)