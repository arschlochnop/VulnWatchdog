## CVE-2024-36991 - Splunk Enterprise on Windows Path Traversal

**漏洞编号:** CVE-2024-36991

**漏洞类型:** 路径遍历

**影响应用:** Splunk Enterprise

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Splunk Enterprise < 9.2.2, Splunk Enterprise < 9.1.5, Splunk Enterprise < 9.0.10

**利用条件:** 目标系统为Windows，且运行受影响的Splunk Enterprise版本，攻击者需要能够访问Splunk Web服务。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-36991是一个存在于Splunk Enterprise on Windows中的路径遍历漏洞。攻击者可以利用`/modules/messaging/`端点，通过构造特殊的URL，读取服务器上的任意文件。 

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码，该POC代码是有效的。漏洞库信息明确指出该漏洞的存在，搜索结果中包含多个验证了该漏洞的页面，包括PoC代码的GitHub仓库。提供的代码是一个Python脚本，它通过构造包含路径遍历序列的URL来利用漏洞，从而读取目标系统上的敏感文件。

**投毒风险：**

分析提供的Python代码（exploit.py）：该脚本的主要功能是发送包含恶意路径的HTTP请求，以下是判断是否存在投毒风险的分析：
*   **明确的功能：** 脚本的核心功能是利用curl命令发起HTTP请求，利用路径遍历漏洞读取文件。这个功能是明确的，且与漏洞描述相符。
*   **网络请求：** 脚本使用了`curl`命令发起网络请求。虽然这是一个潜在的风险点，但`curl`命令本身只是用来发送HTTP请求，请求内容由脚本控制。只要脚本中没有隐藏的恶意URL或payload，风险较低。
*   **参数化：** 脚本使用了参数化，例如 `-u` 设置URL，`-s` 设置读取的敏感信息区段。这可以增强代码的可读性和灵活性，降低恶意代码隐藏的概率。
*   **依赖：** 脚本依赖 `curl` 命令，这是一种常见且广泛使用的工具，本身不太可能存在后门。

考虑到代码的功能相对简单，且主要依赖外部命令 `curl` 完成网络请求，因此投毒的可能性较低。初步判断认为，此仓库存在作者隐藏的投毒代码的可能性约为5%。

**利用方式：**

1.  **确定目标：** 确定运行在Windows上的Splunk Enterprise实例的URL。
2.  **选择目标文件：** 选择要读取的目标文件，或者选择脚本中预定义的section（例如，包含密码的文件）。
3.  **运行漏洞利用代码：** 运行提供的Python脚本，指定目标URL和要读取的section。
4.  **分析结果：** 脚本会输出读取到的文件内容。攻击者可以分析这些内容，获取敏感信息，例如用户名、密码或其他配置信息。

**项目地址:** [jaytiwari05/CVE-2024-36991](https://github.com/jaytiwari05/CVE-2024-36991)

**漏洞详情:** [CVE-2024-36991](https://nvd.nist.gov/vuln/detail/CVE-2024-36991)