## CVE-2025-3248-Langflow-RCE

**漏洞编号:** CVE-2025-3248

**漏洞类型:** 远程代码执行

**影响应用:** Langflow

**危害等级:** 高危，允许未经身份验证的远程代码执行

**影响版本:** < 1.3.0

**利用条件:** 目标系统运行Langflow，且版本低于1.3.0，攻击者可网络访问Langflow服务。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-3248是Langflow 1.3.0之前版本中存在的一个未经身份验证的远程代码执行（RCE）漏洞。该漏洞位于`/api/v1/validate/code`端点，攻击者可以通过发送特制的HTTP请求来执行任意代码。

**有效性评估：**

提供的`LangflowCheck.py`脚本旨在验证目标系统是否存在此漏洞。它通过向`/api/v1/validate/code`端点发送包含恶意Python代码的POST请求来实现。如果脚本成功执行代码并能够读取`/etc/passwd`文件的内容（通过检查响应体中是否存在"root:"字符串），则目标被认为是易受攻击的。脚本同时检查响应头`Content-Type`是否为`application/json`以及状态码是否为200，进一步验证漏洞的存在。

**投毒风险评估：**

`LangflowCheck.py`本身旨在检测漏洞，其利用代码相对直接，风险较低。其中检查`/etc/passwd`属于常规操作，用于检查服务器是否可以执行命令。

`exploit.py` (虽然未提供代码，但README提到) 存在风险，因为它旨在执行反向shell。潜在的投毒风险可能存在于`exploit.py`之中，例如：

*   **后门植入：** 攻击者可能通过反向shell在目标系统上植入持久性后门，以便长期控制目标。
*   **恶意软件传播：** 攻击者可能利用该漏洞传播恶意软件，感染其他系统。

总的来说，`LangflowCheck.py`本身包含投毒代码的可能性较低，但是若使用README中提到的`exploit.py`，风险会增高。因此总体投毒风险评估为10%，主要考虑到代码可能存在的潜在风险和`exploit.py`未提供具体代码，无法进行详细分析。

**利用方式：**

1.  **漏洞定位：**  CVE-2025-3248存在于Langflow的`/api/v1/validate/code`端点。
2.  **Payload构建：**  攻击者构建包含恶意Python代码的JSON payload。漏洞利用代码使用`@exec`修饰器在目标系统上执行代码。`LangflowCheck.py` 中的payload 尝试读取`/etc/passwd`文件来验证漏洞。
3.  **请求发送：**  攻击者向`/api/v1/validate/code`端点发送包含恶意payload的POST请求。
4.  **代码执行：**  如果目标系统存在漏洞，Langflow将执行payload中的恶意代码。
5.  **结果验证/利用：**  `LangflowCheck.py`通过检查响应判断漏洞是否存在。`exploit.py`（根据描述）会建立反向shell，允许攻击者完全控制目标系统。

**缓解措施：**

*   将Langflow更新到1.3.0或更高版本。
*   实施严格的输入验证和清理，以防止代码注入。
*   限制对`/api/v1/validate/code`端点的访问。

**项目地址:** [r0otk3r/CVE-2025-3248](https://github.com/r0otk3r/CVE-2025-3248)

**漏洞详情:** [CVE-2025-3248](https://nvd.nist.gov/vuln/detail/CVE-2025-3248)