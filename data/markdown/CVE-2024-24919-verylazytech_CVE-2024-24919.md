## CVE-2024-24919 - Check Point Security Gateway 信息泄露

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径遍历

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** Check Point Quantum Gateway and CloudGuard Network versions R81.20, R81.10, R81, R80.40 and Check Point Spark versions R81.10, R80.20.

**利用条件:** 目标设备需要连接到互联网，并且启用了远程访问VPN或移动访问软件 blades。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个信息泄露漏洞。根据漏洞库信息和搜索结果，未经身份验证的远程攻击者可以读取目标设备上的任意文件内容。POC 代码利用路径遍历漏洞，通过构造包含 `aCSHELL/../../../../../../../etc/passwd` 或 `aCSHELL/../../../../../../../etc/shadow` 的 POST 请求，尝试读取 `/etc/passwd` 和 `/etc/shadow` 文件。 

**有效性：**
根据CISA的已知可利用漏洞目录（KEV），该漏洞已被积极利用，POC 代码很可能有效。

**投毒风险：**
POC 代码本身包含一些用于美化输出和判断漏洞是否存在的逻辑，例如颜色输出和检查响应中是否包含 'root:' 或 'nobody:' 字符串。代码存在将`/etc/shadow` 和 `/etc/passwd` 写入本地文件的行为，可能会被恶意利用，但是整体判断投毒风险较低。代码中发现的潜在风险点在于可以指定任意文件读取，攻击者可以利用此点读取其他敏感文件。此外，虽然代码作者提供了 Buy Me a Coffee 链接，但这不是典型的投毒行为。考虑到代码的整体结构和功能，以及代码中的小错误，例如banner信息格式问题，可以推断作者的主要目的是展示漏洞利用，而不是隐藏恶意代码。

**利用方式：**
1.  攻击者通过发送特制的 HTTP POST 请求到目标 Check Point Security Gateway 设备。
2.  请求的 Payload 包含一个路径遍历序列，例如 `aCSHELL/../../../../../../../etc/passwd`，用于尝试访问系统文件。
3.  如果设备存在漏洞，且启用了远程访问 VPN 或移动访问软件 blades，则设备会返回请求的文件内容。
4.  攻击者可以利用此漏洞读取敏感文件，例如 `/etc/passwd`、`/etc/shadow` 或其他包含配置信息的文件，从而获取用户名、密码哈希值或其他敏感信息。

**项目地址:** [verylazytech/CVE-2024-24919](https://github.com/verylazytech/CVE-2024-24919)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)