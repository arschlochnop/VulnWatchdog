## CVE-2025-22870-golang-x-net-HTTP代理绕过

**漏洞编号:** CVE-2025-22870

**漏洞类型:** HTTP代理绕过

**影响应用:** golang.org/x/net

**危害等级:** 中危，可能导致SSRF

**影响版本:** < 0.36.0

**利用条件:** 需要目标系统配置了HTTP代理，并使用了受影响的golang.org/x/net版本

**POC 可用性:** 是

**投毒风险:** 95%

## 详情

CVE-2025-22870 漏洞存在于 golang.org/x/net 包中，允许攻击者通过操纵 IPv6 Zone ID 绕过 HTTP 代理设置。当 NO_PROXY 环境变量设置为 "*.example.com" 时，如果请求的目标地址是 "[::1%25.example.com]:80"，程序会错误地认为这个地址与 NO_PROXY 匹配，从而不会通过代理服务器发送请求。这可能导致 SSRF 漏洞，攻击者可以访问内部服务。

**有效性：**
从搜索结果来看，存在公开的PoC（https://github.com/JoshuaProvoste/CVE-2025-22870），表明该漏洞是可利用的。但是，给出的PoC代码只是一个README.md文件，内容为空，因此，无法直接评估此特定PoC的有效性。需要查看github上的具体代码。

**投毒风险：**
提供的PoC代码只有一个空的README.md文件，不包含任何可执行代码，因此，投毒风险非常高。作者可能故意上传一个空的或者不工作的POC，误导安全研究人员或者安全工具. 可以认为有95%的可能性是投毒。

**利用方式：**
1.  **配置受影响的环境：** 设置 NO_PROXY 环境变量，例如 `NO_PROXY=*.example.com`。
2.  **构造恶意请求：** 发送包含 IPv6 Zone ID 的请求，例如 `[::1%25.example.com]:80`。
3.  **绕过代理：** 由于漏洞，该请求将不会通过配置的代理服务器发送，而是直接发送到目标服务器。

**总结：**
该漏洞的利用依赖于目标系统对代理的配置和对 golang.org/x/net 包的使用。攻击者可以通过构造特殊的 IPv6 地址来绕过代理，从而访问原本受保护的内部服务。

**项目地址:** [B1ack4sh/Blackash-CVE-2025-22870](https://github.com/B1ack4sh/Blackash-CVE-2025-22870)

**漏洞详情:** [CVE-2025-22870](https://nvd.nist.gov/vuln/detail/CVE-2025-22870)