## CVE-2025-55188-7-Zip符号链接处理不当漏洞

**漏洞编号:** CVE-2025-55188

**漏洞类型:** 符号链接处理不当

**影响应用:** 7-Zip

**危害等级:** 中危，可能导致任意文件写入

**影响版本:** < 25.01

**利用条件:** 用户解压恶意构造的压缩包

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-55188是7-Zip在25.01版本之前存在的一个安全漏洞，由于7-Zip在提取压缩文件时未能正确处理符号链接导致的。攻击者可以创建一个包含恶意符号链接的压缩包，当用户使用存在漏洞的7-Zip版本解压此压缩包时，符号链接可能被解析到文件系统中的任意位置，导致任意文件写入。

**有效性分析：**
根据漏洞信息、搜索结果以及提供的POC代码，此漏洞利用是有效的。POC代码模拟了创建包含恶意符号链接的压缩包的过程，利用7-Zip处理符号链接的缺陷，达到任意文件写入的目的。

**投毒风险分析：**
提供的POC代码主要包含两个文件：README.md 和 exploit.sh。
*   `README.md`:  主要提供关于POC的描述信息，包括使用方法、系统要求等，没有发现恶意代码。
*   `exploit.sh`:  这是一个shell脚本，用于创建包含恶意符号链接的压缩包。它接受三个参数：payload文件、目标符号链接路径和输出archive，通过创建符号链接，将payload文件链接到目标文件，然后将其打包成tar文件，再用7z压缩。该脚本的行为符合漏洞描述，用于演示漏洞利用，并未发现明显的投毒代码。

尽管如此，任何从第三方来源获取的代码都存在潜在风险。考虑到该POC的主要功能是利用符号链接进行文件写入，如果攻击者控制了`PAYLOAD`的内容，它可以覆盖或者修改目标文件，造成一定危害。因此，`exploit.sh`脚本本身并不能直接判定为投毒，但利用此脚本可能产生恶意影响。

总体而言，仓库中存在作者隐藏的投毒代码的风险较低，估计约为10%。

**利用方式：**
1.  攻击者创建一个包含恶意符号链接的7z压缩包。
2.  该压缩包中的符号链接指向用户文件系统中的敏感位置（例如：`~/.ssh/authorized_keys`）。
3.  受害者使用存在漏洞的7-Zip版本解压该压缩包。
4.  7-Zip在提取文件时，会错误地将符号链接解析到目标位置，导致恶意文件被写入到该位置。
5.  攻击者可能通过写入恶意内容到`authorized_keys`文件实现SSH免密登录，或者通过其他方式利用任意文件写入漏洞。

综上所述，该漏洞利用的有效性较高，但需要用户主动解压恶意构造的压缩包。POC代码未发现明显的投毒代码，但存在被利用的潜在风险。

**项目地址:** [Sh3ruman/CVE-2025-55188-7z-exploit](https://github.com/Sh3ruman/CVE-2025-55188-7z-exploit)

**漏洞详情:** [CVE-2025-55188](https://nvd.nist.gov/vuln/detail/CVE-2025-55188)