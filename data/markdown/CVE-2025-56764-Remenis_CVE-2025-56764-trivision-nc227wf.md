## CVE-2025-56764-Trivision NC-227WF 认证绕过和用户名枚举

**漏洞编号:** CVE-2025-56764

**漏洞类型:** 认证绕过/用户名枚举

**影响应用:** Trivision NC-227WF

**危害等级:** 高危，可能导致未授权访问和敏感信息泄露

**影响版本:** 5.80 (build 20141010)

**利用条件:** 需要访问Trivision NC-227WF设备的Web接口

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-56764 存在于Trivision NC-227WF 摄像头的 5.80 (build 20141010) 版本固件中。该漏洞允许攻击者绕过 Digest 认证，因为设备同时也接受 HTTP Basic 认证，导致攻击者无需有效的凭据即可访问受保护的 Web 接口和摄像头数据流。利用方式是，攻击者可以使用`curl -u admin:admin http://<device_ip>:20080/en/player/flash_vga.asp`命令绕过Digest认证直接获取信息。此外，该漏洞还允许攻击者枚举用户名，因为设备对不存在的用户和密码错误的用户返回不同的错误信息，攻击者据此可以暴力破解或者进行凭据重用攻击。

**有效性：**根据提供的漏洞利用代码（README.md），该漏洞的PoC是有效的。curl 命令演示了如何通过 Basic 认证绕过 Digest 认证，直接访问设备接口。不同错误提示也确认了用户名枚举的可行性。

**投毒风险：**该存储库中的投毒风险较低，约为10%。虽然作者鼓励提供请求/响应示例、屏幕截图和 PCAP 文件，但明确禁止包含可执行的漏洞利用脚本或实际的活动凭据。但由于仓库的目的是为了公开漏洞，不排除其他攻击者基于此信息创建恶意利用脚本并进行传播，存在间接投毒的可能。

**利用方式：**
1.  **认证绕过：**使用 HTTP Basic 认证访问本应受到 Digest 认证保护的 Web 接口，例如 `/en/player/flash_vga.asp`。
2.  **信息泄露：**获取摄像头数据流 URL，可能包含 base64 编码的凭据。
3.  **用户名枚举：**通过尝试不同的用户名，根据返回的错误信息（"Unknown user" 或 "Wrong password"）确定用户是否存在。

**缓解措施建议：**

*   只允许 Digest (或更强的) 认证，拒绝 Digest 保护端点上的 Basic 认证。
*   规范登录错误消息，以避免泄漏用户存在信息。
*   立即轮换可疑凭据并审核日志。
*   通过 IP 限制管理接口访问，并将其置于经过身份验证的网关之后。

**项目地址:** [Remenis/CVE-2025-56764-trivision-nc227wf](https://github.com/Remenis/CVE-2025-56764-trivision-nc227wf)

**漏洞详情:** [CVE-2025-56764](https://nvd.nist.gov/vuln/detail/CVE-2025-56764)