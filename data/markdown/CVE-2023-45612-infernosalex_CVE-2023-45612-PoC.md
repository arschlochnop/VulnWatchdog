## CVE-2023-45612 - JetBrains Ktor XXE

**漏洞编号:** CVE-2023-45612

**漏洞类型:** XML外部实体注入 (XXE)

**影响应用:** JetBrains Ktor

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 2.3.5

**利用条件:** 目标应用使用了Ktor且启用了ContentNegotiation处理XML，未进行安全配置

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-45612 漏洞是JetBrains Ktor在处理XML内容时，由于ContentNegotiation的默认配置存在缺陷，导致可能发生XML外部实体注入(XXE)攻击。攻击者可以构造恶意的XML文档，通过外部实体引用读取服务器上的敏感文件。 

**有效性：**

根据漏洞描述和提供的PoC代码，可以判断该PoC代码是有效的。PoC代码通过构造包含外部实体引用的XML文档，并将其发送到目标Ktor应用的XML处理接口，从而尝试读取指定的文件。如果Ktor应用存在漏洞，则会返回被读取的文件内容。

**投毒风险：**

分析提供的PoC代码，代码本身的功能是利用XXE漏洞读取文件，未发现任何明显的恶意代码或后门。代码主要功能是构造XML payload, 发起HTTP请求，并输出响应结果。可以认为投毒风险很低。

**利用方式：**

1.  **确定目标应用使用了Ktor，并且存在处理XML数据的接口。**  可以通过分析目标应用的请求和响应，或者查看应用的依赖库来判断。
2.  **构造恶意的XML文档。**  XML文档中需要包含DOCTYPE声明，定义外部实体，并引用该实体。
3.  **将构造的XML文档发送到目标应用的XML处理接口。**  可以使用HTTP POST请求，将XML文档作为请求体发送。
4.  **分析响应结果。**  如果目标应用存在漏洞，则响应结果中会包含被读取的文件内容。

**搜索引擎结果分析：**

搜索结果证实了漏洞的存在，并提供了漏洞的详细信息，包括漏洞描述、影响范围和修复建议。


**项目地址:** [infernosalex/CVE-2023-45612-PoC](https://github.com/infernosalex/CVE-2023-45612-PoC)

**漏洞详情:** [CVE-2023-45612](https://nvd.nist.gov/vuln/detail/CVE-2023-45612)