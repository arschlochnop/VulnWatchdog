## CVE-2019-6447 - ES File Explorer 远程文件读取/应用执行

**漏洞编号:** CVE-2019-6447

**漏洞类型:** 远程代码执行/信息泄露

**影响应用:** ES File Explorer

**危害等级:** 高危，可能导致敏感信息泄露、远程代码执行和设备控制

**影响版本:** <= 4.1.9.7.4

**利用条件:** 攻击者和受害者需要在同一局域网内，且受害者设备上安装了受影响版本的 ES File Explorer 并启动过

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-6447 漏洞存在于 ES File Explorer 应用中，攻击者可以通过向受害者设备开放的 59777 端口发送特定的 JSON 请求，从而实现远程读取文件、获取设备信息和执行应用等操作。

**有效性：**

根据漏洞库信息、搜索结果和漏洞利用代码来看，此漏洞是真实存在的，并且POC代码有效。多个来源证实了该漏洞的存在，并提供了利用方法。POC代码中给出了详细的利用示例，可以实现列举文件、获取设备信息、拉取文件和启动应用等功能。

**投毒风险：**

提供的代码主要是一个 `README.md` 文件，描述了漏洞原理和利用方法。虽然没有直接的投毒代码，但存在以下潜在风险：

*   **依赖风险：** `poc.py` 没有提供，实际使用需要用户自己编写或者从其他地方下载，可能引入恶意代码。
*   **命令执行风险：** 利用 POC 执行 appLaunch 时，如果用户不小心启动了恶意应用，或者拉取了恶意文件，会导致设备被感染。
*   **隐私风险：**  POC 中包含大量获取手机信息的命令，比如 listAppsAll, listFiles 等，这些信息如果被恶意收集，可能被用于其他攻击。

综合评估，`README.md` 本身不包含恶意代码，但是依赖的 `poc.py` 存在被替换成恶意代码的风险，并且利用过程中存在命令执行风险。所以投毒风险评估为 10% 。主要风险在于使用者如果从不可信的来源下载`poc.py` 可能存在后门。

**利用方式：**

1.  **目标确定：** 攻击者需要与受害者在同一局域网内，并确定受害者设备的 IP 地址。
2.  **端口探测：**  攻击者通过端口扫描或其他方式确认受害者设备的 59777 端口是否开放。
3.  **JSON 请求构造：**  攻击者根据要执行的操作，构造相应的 JSON 格式的请求，发送到受害者设备的 59777 端口。例如：`{"command":"listFiles"}` 可以列出文件列表，`{"command":"appLaunch", "pkg":"com.tencent.mm"}` 可以启动微信。
4.  **执行攻击：**  攻击者可以利用漏洞读取任意文件、获取设备信息，甚至启动恶意应用，从而控制受害者设备。

**项目地址:** [fs0c131y/ESFileExplorerOpenPortVuln](https://github.com/fs0c131y/ESFileExplorerOpenPortVuln)

**漏洞详情:** [CVE-2019-6447](https://nvd.nist.gov/vuln/detail/CVE-2019-6447)