## CVE-2025-22457-Ivanti Connect Secure-栈溢出

**漏洞编号:** CVE-2025-22457

**漏洞类型:** 栈溢出

**影响应用:** Ivanti Connect Secure, Policy Secure, Neurons for ZTA gateways

**危害等级:** 高危，远程代码执行

**影响版本:** < 22.7R2.6 (Connect Secure), < 22.7R1.4 (Policy Secure), < 22.8R2.2 (ZTA Gateways)

**利用条件:** 需要网络访问，目标存在漏洞版本的Ivanti设备

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-22457 是 Ivanti Connect Secure, Policy Secure 和 ZTA Gateways 中存在的一个栈溢出漏洞。未经身份验证的远程攻击者可以通过发送特制的请求利用此漏洞，实现在目标系统上执行任意代码。根据漏洞库信息，攻击复杂度较高，但CVSS评分高达9.0，属于Critical级别。搜索引擎结果表明，该漏洞已被在野利用，并且有APT组织参与。PoC代码利用方式是首先获取目标设备的productversion，然后根据productversion选择相应的gadget地址, 结合 libdsplibs.so 的基地址，构造ROP链，最终实现远程代码执行。PoC代码中存在一个可疑的地方，就是attempt 循环。循环中不断尝试使用不同的libdsplibs.so地址，这可能是在实际环境中libdsplibs.so地址不固定造成的，也可能存在尝试特定范围地址的可能性，但总体来看不构成明显的投毒行为。PoC首先会创建多个socket连接, 通过修改HTTP请求头来触发漏洞。利用的关键在于栈溢出，覆盖返回地址，执行ROP链。投毒风险较低，主要风险在于利用是否稳定，因为需要猜测 libdsplibs.so 的地址，猜测错误会导致服务崩溃，但并不构成投毒。

**项目地址:** [sfewer-r7/CVE-2025-22457](https://github.com/sfewer-r7/CVE-2025-22457)

**漏洞详情:** [CVE-2025-22457](https://nvd.nist.gov/vuln/detail/CVE-2025-22457)