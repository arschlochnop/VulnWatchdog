## CVE-2025-43300-iOS/macOS DNG Image Processing Memory Corruption

**漏洞编号:** CVE-2025-43300

**漏洞类型:** 内存损坏

**影响应用:** iOS/macOS ImageIO (RawCamera.bundle)

**危害等级:** 高危，可能导致内存损坏、崩溃或潜在的代码执行

**影响版本:** iOS <= 18.6.1, macOS < 14.7.8, macOS < 13.7.8, iPadOS < 17.7.10, macOS < 15.6.1, iOS and iPadOS < 18.6.2

**利用条件:** 需要处理恶意DNG图像文件，可能通过AirDrop、邮件、网页等方式触发

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-43300 是一个存在于 Apple ImageIO 框架中的内存损坏漏洞。该漏洞源于 DNG 图像文件中的 TIFF 元数据和 JPEG Lossless 参数不匹配，导致缓冲区分配错误和数据溢出。攻击者可以通过精心制作的 DNG 文件触发此漏洞，从而导致目标设备上的内存损坏，可能导致崩溃或潜在的代码执行。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2025-43300 是一个已被利用的 0-day 漏洞。提供的漏洞利用代码（`hex_modifier.py`）用于修改 DNG 图像文件，以触发 TIFF 元数据和 JPEG Lossless 参数之间的不匹配。该代码通过修改特定的字节，来改变 `SamplesPerPixel` 的值（TIFF 头部）以及 `SOF3 component count`（JPEG Lossless 数据），从而人为制造数据冲突。由于该漏洞已经被利用，且提供了明确的修改步骤和代码，因此可以判定POC有效。

**投毒风险分析：**
提供的代码主要功能是修改 DNG 文件的特定字节，以触发漏洞。`hex_modifier.py` 脚本的功能是安全地修改文件中的字节，并进行校验。其中包含了对偏移量是否超出文件大小的检查，以及当要修改的字节与期望值不符时的警告，这表明作者试图避免误操作。脚本会计算原始和修改后文件的 SHA256 哈希值，这有助于验证修改是否成功，以及在出现问题时进行调试。代码本身看起来专注于漏洞复现和测试，没有明显的恶意代码或后门。
投毒的风险相对较低，约为5%。主要考虑的点是：

1.  脚本功能集中在修改文件内容上，没有网络连接或执行其他系统命令的部分。
2.  脚本包含安全检查，虽然简单，但也增加了一些安全性。
3.  虽然代码可以用来创建恶意样本，但其本身并不具备恶意行为。

**利用方式分析：**
1.  **攻击者制作恶意的DNG图像文件：** 攻击者使用提供的脚本（或类似工具）修改 DNG 图像文件，人为地在 TIFF 元数据和 JPEG Lossless 参数之间制造不匹配，例如更改`SamplesPerPixel`的值，使其与 JPEG 流中的实际通道数不一致。
2.  **传播恶意DNG文件：** 攻击者通过各种方式传播恶意 DNG 文件，例如通过 AirDrop、iMessage、电子邮件、网页等。
3.  **目标设备处理DNG文件：** 当目标设备（例如 iPhone、iPad、Mac）使用 ImageIO 框架处理该 DNG 文件时，由于元数据和实际数据不一致，导致缓冲区分配错误。在解码 JPEG Lossless 数据时，会发生缓冲区溢出，覆盖相邻内存区域，造成内存损坏。
4.  **潜在影响：** 内存损坏可能导致应用程序崩溃。更严重的情况下，攻击者可以利用此漏洞实现任意代码执行，例如通过ROP链等技术。


**项目地址:** [PwnToday/CVE-2025-43300](https://github.com/PwnToday/CVE-2025-43300)

**漏洞详情:** [CVE-2025-43300](https://nvd.nist.gov/vuln/detail/CVE-2025-43300)