## CVE-2018-1260 - Spring Security OAuth 远程代码执行

**漏洞编号:** CVE-2018-1260

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Spring Security OAuth

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 2.3 prior to 2.3.3; 2.2 prior to 2.2.2; 2.1 prior to 2.1.2; 2.0 prior to 2.0.15

**利用条件:** 需要能够向授权端点发送精心构造的授权请求。

**POC 可用性:** 是，已公开

**投毒风险:** 10%

## 详情

CVE-2018-1260 漏洞存在于 Spring Security OAuth 框架中，允许攻击者通过构造恶意的授权请求，在资源所有者被转发到审批端点时执行任意代码。该漏洞利用了 Spring Expression Language (SpEL) 的特性。虽然提供的代码是 Spring Security OAuth 项目的代码仓库，但其中包含行为准则和项目说明，并非直接的漏洞利用代码，无法从中判断投毒情况。因此需要结合搜索结果和漏洞原理来进行判断。根据搜索结果和漏洞描述，攻击者可以通过在授权请求中注入恶意的 SpEL 表达式来实现 RCE。 风险在于恶意用户可以完全控制受影响的服务器。

**利用方式:**

1.  **构造恶意授权请求:** 攻击者需要构造一个包含恶意 SpEL 表达式的授权请求。
2.  **发送请求到授权端点:** 将构造的恶意请求发送到 Spring Security OAuth 的授权端点。
3.  **触发 RCE:** 当资源所有者被重定向到审批端点时，恶意 SpEL 表达式会被执行，导致远程代码执行。

**关于投毒风险：**
分析提供的代码仓库的内容,未发现明显存在后门或恶意代码。代码仓库似乎包含正常的项目文档，行为准则等，并无直接漏洞利用代码。但考虑到开源项目的特性，以及历史安全事件，仍需保持警惕。 投毒风险评估为10%。

**项目地址:** [shoucheng3/SpringSource__spring-security-oauth_CVE-2018-1260_2-3-2-RELEASE](https://github.com/shoucheng3/SpringSource__spring-security-oauth_CVE-2018-1260_2-3-2-RELEASE)

**漏洞详情:** [CVE-2018-1260](https://nvd.nist.gov/vuln/detail/CVE-2018-1260)