## CVE-2024-27956-WordPress Automatic-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，可能导致数据库信息泄露、任意代码执行，并完全控制受影响的WordPress站点。

**影响版本:** <= 3.92.0

**利用条件:** WordPress站点安装了受影响版本的wp-automatic插件，且无需身份验证即可访问漏洞利用点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-27956 是 WordPress Automatic 插件中存在的一个未经身份验证的 SQL 注入漏洞。根据漏洞库信息和搜索引擎结果，该漏洞允许攻击者执行任意 SQL 命令。 

**有效性：**

提供的 POC 代码有效，它通过以下步骤利用该漏洞：

1.  **注入恶意用户：** 首先，POC 代码尝试通过 SQL 注入在 `wp_users` 表中插入一个新的管理员用户（eviladmin）。
2.  **查找新用户ID：** 之后，代码尝试确定新插入用户的 ID，这是通过循环查询 `wp_users` 表，匹配用户名和ID。 
3.  **赋予管理员权限：** 确定 ID 后，代码将 'administrator' 角色添加到 `wp_usermeta` 表中新创建的用户。
4.  **上传webshell:** 使用新创建的管理员账户登录后台，获取nonce值，上传webshell，实现远程代码执行。

**投毒风险：**

POC 代码的主要目的是利用 SQL 注入漏洞创建一个新的管理员帐户并在目标服务器上放置一个webshell，以便完全控制目标服务器。其中存在一定的投毒风险，例如：

*   **硬编码凭据：** POC 代码使用硬编码的用户名（eviladmin）和密码（eviladmin）。如果攻击者直接使用此代码而不更改凭据，则所有使用相同代码的受害者都将具有相同的后门帐户，这可能会使攻击者能够相互访问或导致混乱。这属于一种弱后门。
*   **Reverse Shell IP地址：**  上传的shell中包含一个硬编码的IP地址 (127.0.0.1)，将反弹shell到攻击者控制的机器，这需要攻击者进行监听。如果攻击者更改了这个IP地址，将会影响所有受害者。

这些因素占有一定的投毒风险，占比约为10%。

**利用方式：**

1.  **未经身份验证的 SQL 注入：** 攻击者无需任何凭据，即可通过构造恶意的 SQL 查询语句，利用 `csv.php` 文件中的漏洞点。
2.  **创建恶意管理员帐户：** 通过注入，攻击者可以在 WordPress 数据库中创建一个具有管理员权限的新帐户。
3.  **远程代码执行：** 攻击者使用新创建的管理员账户登录后台，上传webshell，实现远程代码执行。从而完全控制受影响的WordPress站点。

总而言之，该漏洞利用的有效性很高，因为 POC 代码演示了如何通过未经身份验证的 SQL 注入创建管理员帐户并获得对 WordPress 站点的完全控制权。投毒风险较低，主要体现在硬编码的凭据，使得所有受害者都将具有相同的后门帐户。攻击者可以利用此漏洞完全控制受影响的 WordPress 站点。

**项目地址:** [m4nInTh3mIdDle/wordpress-CVE-2024-27956](https://github.com/m4nInTh3mIdDle/wordpress-CVE-2024-27956)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)