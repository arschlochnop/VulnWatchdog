## CVE-2025-30208-Vite-文件读取漏洞

**漏洞编号:** CVE-2025-30208

**漏洞类型:** 文件读取

**影响应用:** Vite

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** < 4.5.10, >= 5.0.0, < 5.4.15, >= 6.0.0, < 6.0.12, >= 6.1.0, < 6.1.2, >= 6.2.0, < 6.2.3

**利用条件:** Vite dev server 显式暴露到网络 (使用 `--host` 或 `server.host` 配置选项)

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-30208 是 Vite 框架中的一个文件读取漏洞。由于 Vite 在处理 URL 查询字符串时存在缺陷，攻击者可以通过在 URL 中添加 `?raw??` 或 `?import&raw??` 来绕过 `server.fs.deny` 的限制，读取服务器上的任意文件。

**利用方式：**

1.  攻击者构造包含 `?raw??` 或 `?import&raw??` 的恶意 URL，例如：`http://example.com/index.js?raw??`， 其中`example.com` 为存在漏洞的vite项目地址。
2.  Vite 服务器在处理该 URL 时，会错误地允许访问被 `server.fs.deny` 策略禁止的文件。
3.  服务器将目标文件的内容返回给攻击者，导致敏感信息泄露。

**POC 代码分析：**

提供的 POC 代码是一个 Python 脚本，用于自动化检测 Vite 应用程序是否存在 CVE-2025-30208 漏洞。

*   脚本使用 `requests` 库发送 HTTP 请求，探测目标 URL 是否存在漏洞。
*   脚本支持批量扫描目标 URL，并使用多线程加速扫描过程。
*   脚本可以将检测结果保存到文件中。

**投毒风险分析：**

代码中存在一定的投毒风险，风险程度估计为10%。具体分析如下：

*   虽然代码本身的功能是漏洞扫描，但如果攻击者修改了 `check_target` 函数，例如添加了向指定服务器发送请求的功能，或者在发现漏洞后执行恶意操作，就可以将该脚本用于非法用途。
*   `scanner.py` 通过`args.path`参数自定义检测路径, 这本身是正常的漏洞测试操作,但如果攻击者将此文件传播给其他人,可能会存在被植入恶意路径导致信息泄露。
*   项目描述和免责声明中规避了相关责任，但依然无法完全排除恶意使用的情况。
*   `requirements.txt` 中指定的依赖库版本相对较旧，虽然没有直接证据表明存在恶意依赖，但存在一定的安全风险，因为旧版本的库可能存在已知的漏洞。

**项目地址:** [marino-admin/Vite-CVE-2025-30208-Scanner](https://github.com/marino-admin/Vite-CVE-2025-30208-Scanner)

**漏洞详情:** [CVE-2025-30208](https://nvd.nist.gov/vuln/detail/CVE-2025-30208)