## CVE-2019-5736-runc容器逃逸

**漏洞编号:** CVE-2019-5736

**漏洞类型:** 容器逃逸

**影响应用:** runc (Docker)

**危害等级:** 高危，可导致主机被完全控制

**影响版本:** <= 1.0-rc6 (Docker < 18.09.2)

**利用条件:** 需要能够以root身份在受影响的容器内执行命令，或者能够创建新的包含恶意镜像的容器，或者可以attach到一个已经具有写入权限的容器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-5736 漏洞允许攻击者通过恶意容器覆盖宿主机的 runc 二进制文件，从而获得宿主机的 root 权限。利用方式是利用文件描述符处理不当，通过 `/proc/self/exe` 访问宿主机上的 runc 二进制文件并进行替换。提供的 POC 代码描述了一个攻击场景，该场景中，攻击者首先备份 runc 文件，然后将恶意脚本添加到容器设置中，该脚本将在用户运行容器后修改 runc 文件。攻击者在其设备上设置一个监听器，以便在用户运行容器时获得 root 访问权限。该漏洞利用的有效性较高，因为公开了可用的PoC。

关于投毒风险，虽然提供的代码旨在演示攻击和防御，但存在一定的风险。该仓库中的 README.md 描述了如何实现攻击和防御，但恶意攻击者可能会修改此代码，例如，在利用代码中添加隐藏的后门，以便在攻击成功后在主机上安装恶意软件或建立持久性连接。因为代码仓库简单，作者的目的是实现和演示攻击，因此投毒风险较低，预估为10%。通过`chattr`命令设置 `/usr/docker/runc` 文件为不可修改是有效的缓解措施。

**项目地址:** [sonyavalo/CVE-2019-5736-Dockerattack-and-security-mechanism](https://github.com/sonyavalo/CVE-2019-5736-Dockerattack-and-security-mechanism)

**漏洞详情:** [CVE-2019-5736](https://nvd.nist.gov/vuln/detail/CVE-2019-5736)