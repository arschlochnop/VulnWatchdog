## CVE-2017-7921 - Hikvision摄像机未授权访问漏洞

**漏洞编号:** CVE-2017-7921

**漏洞类型:** 未授权访问/权限提升

**影响应用:** Hikvision Cameras

**危害等级:** 高危，可能导致信息泄露和设备控制

**影响版本:** DS-2CD2xx2F-I Series V5.2.0 build 140721 to V5.4.0 build 160530, DS-2CD2xx0F-I Series V5.2.0 build 140721 to V5.4.0 Build 160401, DS-2CD2xx2FWD Series V5.3.1 build 150410 to V5.4.4 Build 161125, DS-2CD4x2xFWD Series V5.2.0 build 140721 to V5.4.0 Build 160414, DS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 Build 160421, DS-2DFx Series V5.2.0 build 140805 to V5.4.5 Build 160928, and DS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 Build 160106

**利用条件:** 目标设备开启Web服务且存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2017-7921存在于多个Hikvision摄像机型号中，是一个未授权访问漏洞。攻击者无需身份验证即可访问敏感信息或提升权限。

**有效性：**

根据漏洞库信息、搜索结果以及提供的PoC代码，可以判断该漏洞是有效的。搜索结果中多个链接都指向了该漏洞的详细描述和分析，并有博客文章提供了如何识别和利用该漏洞的信息。PoC代码尝试通过特定的URL（/Security/users, /System/configurationFile, /onvif-http/snapshot）绕过身份验证，从而获取用户信息、配置文件或摄像机快照。如果目标摄像机存在漏洞，PoC代码很可能会成功利用。

**投毒风险：**

PoC代码主要功能是发送HTTP请求，解析响应，并提取敏感信息。代码中存在加解密函数`decrypt` 和 `xore`, 存在利用漏洞获取用户密码等敏感信息的可能, 但不属于投毒代码。该代码只是为了验证漏洞的存在而编写的，本身不太可能包含恶意代码。因此,投毒风险较低，大概为1%。

**利用方式：**

1.  **确定目标：** 确定目标Hikvision摄像机的IP地址和端口号。
2.  **版本确认：** 确认目标摄像机的固件版本是否在受影响的范围内。
3.  **发送未授权请求：** 使用PoC代码中提供的URL（例如`/Security/users?auth=YWRtaW46MTEK`）向目标摄像机发送未授权请求。
4.  **获取敏感信息：** 如果漏洞存在，摄像机将返回包含用户信息、配置文件或快照图像的数据。
5.  **权限提升（理论上）：** 虽然PoC代码主要演示了信息泄露，但漏洞描述中提到可能导致权限提升。攻击者可以利用泄露的信息进一步尝试获取设备的控制权。

**搜索引擎结果优先级：**
搜索结果提供了漏洞的详细信息，利用方法，受影响范围等信息，因此优先级最高。
**漏洞利用代码优先级：**
PoC代码验证了漏洞的存在，并提供了一种利用漏洞的途径，优先级次之。
**漏洞库信息优先级：**
漏洞库信息提供了漏洞的基本描述和受影响的产品，优先级最低。

**项目地址:** [K3ysTr0K3R/CVE-2017-7921-EXPLOIT](https://github.com/K3ysTr0K3R/CVE-2017-7921-EXPLOIT)

**漏洞详情:** [CVE-2017-7921](https://nvd.nist.gov/vuln/detail/CVE-2017-7921)