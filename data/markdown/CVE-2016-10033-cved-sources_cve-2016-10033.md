## CVE-2016-10033-PHPMailer-远程代码执行

**漏洞编号:** CVE-2016-10033

**漏洞类型:** 远程代码执行

**影响应用:** PHPMailer

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 5.2.18

**利用条件:** 目标系统运行存在漏洞的PHPMailer版本，并且使用isMail传输方式

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于PHPMailer的mailSend函数中，当使用isMail传输方式时，通过构造恶意的Sender属性，可以向mail命令传递额外的参数，从而执行任意代码。\n\n**有效性：**\n提供的Dockerfile和相关代码构建了一个易受攻击的PHPMailer环境。index.php 模拟了一个邮件发送表单，该表单使用存在漏洞的PHPMailer 5.2.17版本。攻击者可以通过操控表单中的email字段（Sender属性）来注入恶意参数。\n\n**投毒风险：**\nDockerfile构建了一个包含漏洞版本的环境，但其中没有发现明显的、作者故意添加的恶意后门或恶意行为。`main.sh` 脚本主要负责设置hosts文件和启动apache2以及一个简单的smtp调试服务器。 虽然没有明显恶意代码，但整个环境本身就是为了演示漏洞而存在，其目的是提供一个可利用的环境，因此存在一定的潜在风险，例如被用于非授权的测试或攻击。 因为是漏洞演示环境，存在被滥用的可能性，故投毒风险定为10%。\n\n**利用方式：**\n1.  攻击者需要找到使用易受攻击的PHPMailer版本的Web应用程序。\n2.  在Web应用程序提供的邮件发送表单中，修改email字段，构造包含恶意参数的payload。例如：`attacker@example.com -oQ/tmp/ -X/var/www/html/shell.php`，这个payload尝试将shell写入`/var/www/html/shell.php`。\n3.  提交表单，PHPMailer将使用构造的email字段调用mail命令，从而执行注入的命令。\n4.  攻击者可以通过访问生成的shell文件来执行任意代码，从而完全控制服务器。

**项目地址:** [cved-sources/cve-2016-10033](https://github.com/cved-sources/cve-2016-10033)

**漏洞详情:** [CVE-2016-10033](https://nvd.nist.gov/vuln/detail/CVE-2016-10033)