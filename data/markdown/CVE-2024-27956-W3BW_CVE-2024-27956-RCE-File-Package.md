## CVE-2024-27956 - WordPress Automatic Plugin SQL 注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL 注入

**影响应用:** WordPress Automatic Plugin

**危害等级:** 高危，允许未经身份验证的任意 SQL 执行

**影响版本:** <= 3.92.0

**利用条件:** 需要目标网站安装了受影响版本的 WordPress Automatic 插件，且插件目录可访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于 WordPress Automatic 插件的 csv.php 文件中，允许未经身份验证的攻击者执行任意 SQL 查询。攻击者可以利用此漏洞创建新的管理员帐户。从搜索结果和漏洞信息来看，该漏洞已经被积极利用。提供的 POC 代码包含两个 Python 脚本：exploit.py 和 modified_exploit.py。modified_exploit.py 版本只是增加了一个忽略SSL证书验证的选项，在https站点证书存在问题的情况下可以使用。该漏洞的利用方式是向 /wp-content/plugins/wp-automatic/inc/csv.php 发送 POST 请求，其中包含恶意的 SQL payload 以及对应的 hash 值。第一个请求用于创建用户名为 eviladmin 的新用户，密码硬编码为 admin。第二个请求用于授予 eviladmin 用户管理员权限。如果目标系统存在此漏洞，攻击者将能够使用新创建的管理员帐户登录并完全控制 WordPress 网站。投毒风险：虽然利用代码的主要目的是创建后门账户，但仍存在一定的投毒风险。例如，攻击者可能修改 SQL 语句以删除数据、篡改内容或执行其他恶意操作。代码中hash值是预先计算好的，如果插件服务端对这个hash验证不严格，攻击者可能会修改payload来执行其他恶意SQL，但目前来看，是为了防止payload被篡改，可以视为一种防御机制。考虑到这些因素，投毒风险评定为10%。

**项目地址:** [W3BW/CVE-2024-27956-RCE-File-Package](https://github.com/W3BW/CVE-2024-27956-RCE-File-Package)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)