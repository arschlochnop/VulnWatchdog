## CVE-2023-51385-OpenSSH命令注入

**漏洞编号:** CVE-2023-51385

**漏洞类型:** 命令注入

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 9.6

**利用条件:** 需要受害者使用受污染的用户名或主机名连接到攻击者控制的服务器，或者受害者访问包含恶意子模块的 Git 仓库。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2023-51385 存在于 OpenSSH 9.6 之前的版本中。当用户名或主机名包含 shell 元字符时，可能发生操作系统命令注入。例如，如果一个不受信任的 Git 仓库有一个子模块，该子模块的用户名或主机名包含 shell 元字符，则可能触发此漏洞。

**漏洞利用方式：**

1.  攻击者创建一个包含恶意配置的 Git 仓库，其中子模块的用户名或主机名包含 shell 元字符。
2.  或者，攻击者控制一个 SSH 服务器，并设置包含恶意 shell 元字符的用户名或主机名。
3.  受害者克隆恶意 Git 仓库或使用易受攻击的 OpenSSH 客户端连接到攻击者控制的 SSH 服务器。
4.  OpenSSH 在处理用户名或主机名时，由于未正确转义 shell 元字符，导致命令注入，执行攻击者控制的恶意命令。

**有效性：**
根据漏洞描述和搜索结果，此漏洞是有效的。许多安全厂商和组织都发布了关于此漏洞的公告和修复建议。

**投毒风险：**
提供的 POC 代码 `/tmp/d37649a81685a000f41564edc2078d9f/README.md` 仅仅包含了一个 README.md 文件，内容为 `# CVE-2023-51385-exploit`。 虽然这个文件本身不包含任何恶意代码，但不能完全排除整个仓库中存在其他隐藏的投毒代码的可能性。假设仓库中存在其他恶意脚本或配置文件的可能性是 10%。 这个README文件仅仅是声明，没有体现exp代码，无法验证漏洞。


**项目地址:** [MiningBot-eth/CVE-2023-51385-exploit](https://github.com/MiningBot-eth/CVE-2023-51385-exploit)

**漏洞详情:** [CVE-2023-51385](https://nvd.nist.gov/vuln/detail/CVE-2023-51385)