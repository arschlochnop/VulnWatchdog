## CVE-2025-24132 - AirPlay 远程代码执行

**漏洞编号:** CVE-2025-24132

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** AirPlay audio SDK, AirPlay video SDK, CarPlay Communication Plug-in

**危害等级:** 中危，可能导致应用意外终止

**影响版本:** < AirPlay audio SDK 2.7.1, < AirPlay video SDK 3.6.0.126, < CarPlay Communication Plug-in R18.1

**利用条件:** 位于同一局域网的攻击者

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-24132 漏洞是 Apple AirPlay 相关 SDK 和 CarPlay Communication Plug-in 中存在的内存处理问题，可能允许同一局域网的攻击者导致应用意外终止。根据漏洞库信息，该问题通过改进内存处理得到修复。从搜索结果来看，secure-iss.com 将其描述为“AirBorne”零点击 RCE 漏洞，并指出是栈溢出漏洞，风险等级为Critical。然而，漏洞库信息将其描述为导致应用终止的问题，风险等级为 Medium，侧重点不同。PoC 代码（`main.py`）通过 mDNS (Zeroconf) 发现局域网内的 AirPlay 设备，并尝试通过发送包含 reverse shell plist 数据的 HTTP POST 请求到 `/pairing-init` 路径来测试 CVE-2025-24132 漏洞。如果收到任何 HTTP 响应，则将设备标记为易受攻击。这种做法存在误判可能，如果服务只是存在，就会被判定为漏洞。

**有效性：**

PoC 代码可能有效，但存在一定的误判风险，因为它只检测是否有 HTTP 响应，而没有验证是否成功利用漏洞，真实的漏洞利用场景需要进一步验证。

**投毒风险：**

尽管代码本身旨在扫描和测试漏洞，但可能存在以下投毒风险：

1.  **依赖项投毒：** `requirements.txt` 文件中使用的 PyQt5 和 zeroconf 等包有可能来自被篡改的源，导致安装恶意代码。概率较低，因为这些是常见的库。
2.  **后门植入：** 作者可能在代码中添加了隐蔽的后门代码，例如收集扫描到的设备信息并发送到外部服务器，或者在满足特定条件时执行恶意操作。查看`main.py` 中的 `ATTACKER_IP`和`ATTACKER_PORT`定义,存在反向连接的嫌疑。但是考虑到需要测试漏洞,属于正常利用。
3.  **误报：** PoC 的检测方法过于简单，可能会将未受漏洞影响的设备误判为 vulnerable，从而引发不必要的恐慌。

考虑到上述风险，将投毒风险评定为 10%。大部分代码看起来是为了实现漏洞扫描和利用。但是，存在反向连接尝试，也存在一定隐患。

**利用方式：**

1.  **扫描：** 使用 `zeroconf` 发现局域网内的 AirPlay 设备。
2.  **探测：** 向 AirPlay 设备发送包含恶意 payload 的 `POST /pairing-init` 请求。
3.  **判断：** 根据是否收到 HTTP 响应判断设备是否存在漏洞。
4.  **利用(如果存在栈溢出):** 利用栈溢出漏洞，执行任意代码（搜索结果显示 `secure-iss.com` 将其描述为栈溢出）。
5.  **利用(如果仅仅是拒绝服务)：** 触发内存处理问题导致服务崩溃。

**项目地址:** [Feralthedogg/CVE-2025-24132-Scanner](https://github.com/Feralthedogg/CVE-2025-24132-Scanner)

**漏洞详情:** [CVE-2025-24132](https://nvd.nist.gov/vuln/detail/CVE-2025-24132)