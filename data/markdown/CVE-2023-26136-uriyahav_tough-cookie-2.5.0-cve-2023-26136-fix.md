## CVE-2023-26136-tough-cookie-原型污染

**漏洞编号:** CVE-2023-26136

**漏洞类型:** 原型污染

**影响应用:** tough-cookie

**危害等级:** 中危，可能导致应用程序行为被篡改，甚至造成拒绝服务

**影响版本:** < 4.1.3

**利用条件:** 需要应用程序使用受影响版本的tough-cookie，并且在rejectPublicSuffixes=false的模式下使用CookieJar。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2023-26136是tough-cookie库中一个原型污染漏洞。当CookieJar在rejectPublicSuffixes=false模式下处理Cookie时，由于对象初始化不当导致。攻击者可以通过设置具有恶意域（例如`__proto__`）的cookie来污染`Object.prototype`，从而影响所有继承自该原型的对象。

**有效性分析：**

提供的POC代码（`tough-cookie/index.js`）旨在演示此漏洞，并且`test-cve-2023-26136.js`单元测试验证了修复程序。利用代码的描述表明，它能够成功利用易受攻击的版本，并且针对修补版本会失败，这表明POC是有效的。

**投毒风险分析：**

该仓库包含修复漏洞的代码和测试，以及利用漏洞的演示代码。虽然存在利用代码，但主要目的是验证修复程序。考虑到作者提供了修复方案、测试用例以及详细的漏洞描述，投毒的可能性较低。但仍然存在一定的风险，例如，`tough-cookie/index.js`如果被恶意修改，可能会在不知情的情况下引入后门。总体评估投毒风险为5%，主要是基于对代码质量和作者意图的信任，但不能完全排除。

**利用方式：**

1.  创建一个`CookieJar`实例，并将`rejectPublicSuffixes`设置为`false`。
2.  构造一个包含恶意域名（例如`__proto__`）的Cookie，将其设置为`CookieJar`。
3.  由于`rejectPublicSuffixes`为`false`，`tough-cookie`将尝试设置此cookie，从而污染`Object.prototype`。
4.  一旦`Object.prototype`被污染，所有基于此原型的对象都会受到影响，可能导致应用程序行为异常或安全漏洞。

**项目地址:** [uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix](https://github.com/uriyahav/tough-cookie-2.5.0-cve-2023-26136-fix)

**漏洞详情:** [CVE-2023-26136](https://nvd.nist.gov/vuln/detail/CVE-2023-26136)