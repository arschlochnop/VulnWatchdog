## CVE-2019-3980 - SolarWinds Dameware Remote Mini Remote Client Agent Service RCE

**漏洞编号:** CVE-2019-3980

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** SolarWinds Dameware Remote Mini Remote Client Agent Service

**危害等级:** 高危，允许未授权的远程攻击者以Local System权限执行任意代码。

**影响版本:** Versions up to and including 12.1.0.89

**利用条件:** 目标系统运行着受影响版本的Dameware Mini Remote Client Agent Service，且攻击者能够与目标系统建立网络连接。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-3980 漏洞存在于 SolarWinds Dameware Mini Remote Client Agent Service v12.1.0.89 及更早版本中。该漏洞允许未经身份验证的远程攻击者通过利用智能卡认证机制，上传恶意的可执行文件到 DWRCS.exe 进程的上下文中执行，从而实现远程代码执行，权限为Local System。 

**利用方式：**

1.  攻击者首先向目标系统发起智能卡登录请求。
2.  利用漏洞，上传一个特制的恶意可执行文件（C# exe）。
3.  恶意可执行文件在目标系统上执行，该程序会回连到攻击者的服务器，获取要执行的命令（从攻击者服务器的/cmd路径）。
4.  在目标主机上执行从服务器获取的命令。
5.  执行结果通过 base64 编码后通过 GET 请求发送到攻击者的 Web 服务器。
6.  攻击者从 Web 服务器接收执行结果，并进行解码。

**有效性：**

根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞的POC代码有效。该POC包含一个 Python 脚本和一个 C# 可执行文件。

**投毒风险：**

该POC代码的投毒风险较低，大约为10%。风险主要集中在以下几个方面：

*   **C# 可执行文件：**攻击者可能会修改C#可执行文件，添加额外的恶意功能，例如持久化后门或窃取敏感信息。虽然目前的功能看起来比较直接，但存在隐藏恶意代码的可能性。
*   **Web服务器：**Python脚本中启动的简易Web服务器可能会被用于分发其他恶意文件，或者记录受害者的IP地址等信息。脚本的功能是接收执行结果,虽然看起来只是简单地接收base64编码后的数据，但不能排除记录IP或其他信息的可能。
*   **依赖项风险：**  脚本依赖 `Crypto` 库，这些库的版本如果过低或者来自不受信任的源，可能引入额外的安全风险，但此项风险较低,属于基本风险。

总而言之，虽然POC代码主要用于执行命令，但潜在的风险点在于C#程序和Web服务器的利用，以及依赖库的安全性。使用前务必进行代码审计，避免受到攻击。

**项目地址:** [warferik/CVE-2019-3980](https://github.com/warferik/CVE-2019-3980)

**漏洞详情:** [CVE-2019-3980](https://nvd.nist.gov/vuln/detail/CVE-2019-3980)