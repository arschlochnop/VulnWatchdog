## CVE-2024-9796-WP-Advanced-Search-SQL注入

**漏洞编号:** CVE-2024-9796

**漏洞类型:** SQL注入

**影响应用:** WP-Advanced-Search

**危害等级:** 高危，可能导致敏感数据泄露

**影响版本:** <= 3.3.9

**利用条件:** 目标WordPress站点安装了存在漏洞版本的WP-Advanced-Search插件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-9796是WordPress WP-Advanced-Search插件3.3.9版本及之前版本中存在的SQL注入漏洞。攻击者可以通过`t`参数，向`/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php`发送恶意请求，注入恶意的SQL语句。由于插件没有充分过滤和转义用户提供的参数，且未对SQL查询进行适当的预处理，导致未经身份验证的攻击者可以执行任意SQL查询，可能提取数据库中的敏感信息。提供的POC代码使用`ghauri`工具验证漏洞，并提供了基于时间的盲注Payload，该Payload通过控制`f`参数，利用`SLEEP()`函数来判断SQL注入是否成功。虽然POC看起来直接有效，但YAML文件中的`tags`字段中的评论性语句“github.com/fa-rrel ==> WHAT DO YOU THINK ABOUT ME ?”暗示了作者可能存在某种意图，虽然不一定是恶意代码，但存在潜在的风险。这种风险判定为投毒。综合考虑，投毒风险比例估计为10%。

**项目地址:** [issamjr/CVE-2024-9796](https://github.com/issamjr/CVE-2024-9796)

**漏洞详情:** [CVE-2024-9796](https://nvd.nist.gov/vuln/detail/CVE-2024-9796)