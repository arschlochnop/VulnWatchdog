## CVE-2020-27955-Git LFS-RCE

**漏洞编号:** CVE-2020-27955

**漏洞类型:** 远程代码执行

**影响应用:** Git LFS

**危害等级:** 高危，可能导致完全控制目标系统

**影响版本:** 2.12.0

**利用条件:** 目标系统安装了Git LFS 2.12.0，并且克隆了包含恶意LFS对象的Git仓库

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-27955是一个存在于Git LFS 2.12.0中的远程代码执行漏洞。攻击者可以通过创建一个包含恶意LFS对象的Git仓库，当受害者克隆该仓库时，恶意代码会被执行。\n\n根据提供的漏洞利用代码，`/tmp/b034253cc61d8b86d6971e4703f5432d/git.sh` 文件的内容是 `rmdir /home/an0nymous/Desktop/flag`。这段代码会尝试删除用户 `an0nymous` 桌面上的 `flag` 目录。这表明POC的目的是在受害者机器上执行任意命令。\n\n**有效性：**根据漏洞信息和利用代码，该漏洞是有效的。利用方式是通过恶意构造的git仓库，在受害者克隆仓库时触发RCE。\n\n**投毒风险：**  利用代码 `rmdir /home/an0nymous/Desktop/flag` 本身并没有明显的投毒迹象。  投毒风险较低，约为 10%。潜在的投毒风险可能存在于更复杂的利用场景中，攻击者可能在LFS对象中嵌入更隐蔽的恶意代码，例如下载并执行其他恶意脚本，或者修改系统关键文件等。 因此，虽然目前提供的 POC 代码没有明显的投毒行为，但不能完全排除投毒的可能性。\n\n**利用方式：**\n1.  攻击者创建一个包含恶意LFS对象的Git仓库。这个恶意LFS对象包含能够执行任意命令的payload。\n2.  攻击者将这个恶意仓库托管到一个公开的Git服务器上。\n3.  受害者克隆这个恶意仓库。\n4.  当Git LFS处理恶意LFS对象时，其中的payload会被执行，导致远程代码执行。

**项目地址:** [nob0dy-3389/CVE-2020-27955](https://github.com/nob0dy-3389/CVE-2020-27955)

**漏洞详情:** [CVE-2020-27955](https://nvd.nist.gov/vuln/detail/CVE-2020-27955)