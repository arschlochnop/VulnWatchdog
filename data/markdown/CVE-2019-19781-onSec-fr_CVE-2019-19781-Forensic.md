## CVE-2019-19781-Citrix ADC和Gateway目录遍历漏洞

**漏洞编号:** CVE-2019-19781

**漏洞类型:** 目录遍历

**影响应用:** Citrix Application Delivery Controller (ADC) 和 Gateway

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 10.5, 11.1, 12.0, 12.1, 和 13.0

**利用条件:** 目标系统存在漏洞且网络可达

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2019-19781 是 Citrix ADC 和 Gateway 中存在的目录遍历漏洞。攻击者可以利用此漏洞读取服务器上的任意文件，甚至可能结合其他漏洞实现远程代码执行。

**有效性：**
根据漏洞库信息和搜索引擎结果，该漏洞已被广泛利用，存在公开的PoC代码。提供的代码仓库包含一个用于取证分析的脚本，而不是直接的漏洞利用代码。但是，这个取证脚本的存在暗示了漏洞利用的真实性和普遍性，以及对受感染系统的进一步分析和清除的必要性。

**投毒风险：**
该仓库主要包含一个取证脚本（script.sh）、一个示例输出文件（output_demo.txt）、LICENSE和README.md。取证脚本本身的目的并非攻击，而是检测利用漏洞后的痕迹。投毒风险主要在于：
*   **脚本伪装：** 攻击者可能修改取证脚本，使其在检测漏洞痕迹的同时，植入后门或执行恶意操作。由于该脚本需要高权限运行，因此一旦被篡改，危害极大。
*   **供应链攻击：** 攻击者可能通过篡改GitHub仓库，发布包含恶意代码的“更新”，诱导用户下载并执行。

综合评估，该仓库本身直接包含投毒代码的可能性较低，但存在被恶意修改或利用进行供应链攻击的风险。因此，投毒风险估计为10%。该风险主要源于脚本执行需要高权限，以及缺乏代码签名或校验机制。

**利用方式：**
根据搜索结果和漏洞描述，CVE-2019-19781 是一个目录遍历漏洞，攻击者可以构造恶意的URL，例如包含“../”序列的路径，来访问受限制的目录和文件。更复杂的利用方式是结合其他漏洞，例如模板注入，实现远程代码执行。具体的利用步骤如下：

1.  **发送恶意请求：** 攻击者向存在漏洞的Citrix ADC或Gateway服务器发送包含目录遍历payload的HTTP请求。
2.  **读取敏感文件：** 利用目录遍历漏洞读取服务器上的敏感配置文件，例如包含用户凭据的文件。
3.  **远程代码执行：** 结合模板注入或其他漏洞，在服务器上执行任意代码。这通常涉及上传包含恶意代码的模板文件，然后通过目录遍历漏洞访问该文件，触发代码执行。

提供的输出示例文件展示了攻击者成功利用漏洞后，在`/var/tmp/netscaler/portal/templates/`目录下创建的临时XML文件，这些文件由`nobody`用户创建，表明攻击者可能利用该漏洞上传或修改了模板文件。

**项目地址:** [onSec-fr/CVE-2019-19781-Forensic](https://github.com/onSec-fr/CVE-2019-19781-Forensic)

**漏洞详情:** [CVE-2019-19781](https://nvd.nist.gov/vuln/detail/CVE-2019-19781)