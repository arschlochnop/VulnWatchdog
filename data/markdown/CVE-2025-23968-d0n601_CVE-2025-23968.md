## CVE-2025-23968-AiBud_WP-任意文件上传

**漏洞编号:** CVE-2025-23968

**漏洞类型:** 任意文件上传

**影响应用:** AiBud WP

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** <= 1.8.5

**利用条件:** 需要WordPress后台管理员或以上权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-23968是WPCenter AiBud WP插件中存在的一个任意文件上传漏洞，允许攻击者上传恶意Web Shell到服务器，从而获取服务器控制权。该漏洞存在于REST API端点`/wp-json/ai-buddy/v1/wp/attachments`的文件上传逻辑中。具体利用方式如下：

1.  攻击者准备一个包含PHP代码的Web Shell，并将其伪装成图片文件（例如`shell.jpg`），包含JPG的文件头`FF D8 FF E0`。
2.  攻击者将伪装后的Web Shell上传到自己控制的服务器上。
3.  攻击者利用WordPress后台管理员或以上权限，向`/wp-json/ai-buddy/v1/wp/attachments`发送POST请求，其中包含以下参数：
    *   `url`: 攻击者服务器上Web Shell的URL。
    *   `filename`:  将Web Shell重命名为`.php`后缀（例如`shell.php`）。
4.  由于插件的文件重命名逻辑存在漏洞，攻击者可以成功将Web Shell上传到WordPress服务器上的`/wp-content/uploads/YEAR/MONTH/`目录下，并将其命名为`shell.php`。
5.  攻击者访问上传后的Web Shell文件（例如`/wp-content/uploads/YEAR/MONTH/shell.php`），执行其中的PHP代码，从而获取服务器控制权。

**有效性：**

提供的POC代码有效，能够成功利用该漏洞上传Web Shell并执行。

**投毒风险：**

检查了提供的`README.md`和`cve-2025-23968.py`，未发现明显的恶意代码。风险在于：

1.  **依赖项风险：**`cve-2025-23968.py`可能依赖于某些第三方库，这些库可能存在安全漏洞或被恶意篡改。但是未提供依赖项，无法判断。
2.  **利用方式的潜在风险：** 利用脚本本身没有恶意行为，但是通过漏洞上传的Web Shell可能被用于执行各种恶意操作，例如植入后门、窃取数据、篡改网站内容等。取决于攻击者如何使用上传的webshell，存在一定风险，但并非代码作者投毒。我给出了相对保守的估计 5%。

**利用方式：**

1.  **前提条件：** 需要具有 WordPress 后台管理员权限或者更高权限的用户。
2.  **上传伪装的 Web Shell：** 构造一个包含 PHP 代码的图片文件(jpg)，文件头包含`FF D8 FF E0`。
3.  **利用 REST API 上传：** 通过 `/wp-json/ai-buddy/v1/wp/attachments` 接口，指定图片 URL 和 `filename` 参数为 `shell.php`。
4.  **访问 Web Shell：** 访问上传的 `shell.php` 文件，执行任意 PHP 代码。

**项目地址:** [d0n601/CVE-2025-23968](https://github.com/d0n601/CVE-2025-23968)

**漏洞详情:** [CVE-2025-23968](https://nvd.nist.gov/vuln/detail/CVE-2025-23968)