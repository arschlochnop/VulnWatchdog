## CVE-2023-30212-OURPHP-XSS

**漏洞编号:** CVE-2023-30212

**漏洞类型:** XSS（跨站脚本）

**影响应用:** OURPHP

**危害等级:** 中危，可能导致用户会话劫持、网页篡改、恶意脚本执行

**影响版本:** <= 7.2.0

**利用条件:** 需要用户点击恶意链接或访问被注入恶意代码的页面，管理员身份可以提高危害。

**POC 可用性:** 是

**投毒风险:** 20%

## 详情

CVE-2023-30212是OURPHP 7.2.0版本及更早版本中存在的一个跨站脚本漏洞，位于`/client/manage/ourphp_out.php`。根据漏洞库信息和搜索结果，攻击者可以通过构造恶意的URL参数，将恶意JavaScript代码注入到页面中，当用户访问该页面时，恶意脚本会在用户浏览器中执行。漏洞利用代码提供了一个 Docker 环境，用于模拟和复现该漏洞。

**有效性：**根据提供的漏洞库信息、搜索引擎结果以及漏洞利用代码的`README.md`，可以判断此漏洞的POC是有效的。

**投毒风险：**提供的漏洞利用代码只是一个Docker环境的描述文件，其`README.md`文件主要用于说明该漏洞以及如何使用Docker环境进行复现。初步判断存在投毒代码的风险较低，但需要仔细审查 Dockerfile 和相关脚本。由于这是一个 XSS 漏洞的 POC，后门代码可能隐藏在注入的 JavaScript 代码中。因此，评估投毒风险为20%。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，例如：`http://example.com/client/manage/ourphp_out.php?参数=<script>alert('XSS')</script>`
2.  攻击者诱导用户点击该URL或者将该URL嵌入到其他页面中。
3.  用户访问该URL后，恶意JavaScript代码会在用户的浏览器中执行，从而实现XSS攻击。
4.  攻击者可以利用XSS漏洞进行用户会话劫持、网页篡改、钓鱼等恶意行为。利用的必要前提是管理员或者用户登录后台。

**项目地址:** [libas7994/CVE-2023-30212](https://github.com/libas7994/CVE-2023-30212)

**漏洞详情:** [CVE-2023-30212](https://nvd.nist.gov/vuln/detail/CVE-2023-30212)