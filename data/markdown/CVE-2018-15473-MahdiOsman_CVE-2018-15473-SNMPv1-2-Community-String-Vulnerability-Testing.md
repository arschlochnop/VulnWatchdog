## CVE-2018-15473-OpenSSH用户名枚举

**漏洞编号:** CVE-2018-15473

**漏洞类型:** 用户名枚举

**影响应用:** OpenSSH

**危害等级:** 中危，可能为进一步攻击提供信息

**影响版本:** <= 7.7

**利用条件:** 需要网络访问OpenSSH服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2018-15473 漏洞允许攻击者枚举OpenSSH服务器上的有效用户名。OpenSSH 7.7及更早版本在处理身份验证请求时，不会延迟对无效用户的退出，导致通过时间差异可以区分有效和无效用户。漏洞利用方式：

1.  **漏洞信息：** 漏洞库和搜索引擎结果均表明该漏洞影响OpenSSH 7.7及更早版本，允许用户枚举。
2.  **漏洞利用代码：** 提供的`sshUsernameEnumExploit.py`脚本旨在利用此漏洞。该脚本通过发送针对不同用户的身份验证请求，并测量服务器的响应时间来判断用户是否存在。如果服务器处理有效用户的时间与处理无效用户的时间存在明显差异，则攻击者可以推断出有效用户名。
3.  **有效性评估：** 该POC代码的有效性取决于服务器是否修补了该漏洞，以及网络延迟是否会干扰时间测量。在未修补的OpenSSH服务器上，该漏洞利用很可能有效。
4.  **投毒风险评估：** 代码仓库中存在投毒风险的可能性较低，但不能完全排除。主要风险来自于以下几点：
    *   `sshUsernameEnumExploit.py`脚本本身可能包含恶意代码，尽管可能性不大。
    *   `Docker/Dockerfile.ssh-snmp`文件配置了弱SNMP社区字符串（public），虽然明确声明是“Intentionally using”，但如果用户不理解其含义直接部署，可能引入新的安全风险。
    *   `sshtranger_things.py`文件未提供内容，可能存在未知的安全隐患，但因为没有实际代码，风险暂时无法评估。

    总体来说，投毒风险较低，约为5%。主要是代码仓库中其他配置导致的风险。

5.  **利用方式总结：**
    1.  攻击者使用`sshUsernameEnumExploit.py`脚本或其他类似工具。
    2.  脚本向目标OpenSSH服务器发送大量用户名尝试连接请求。
    3.  脚本测量每个请求的响应时间。
    4.  根据响应时间差异，攻击者可以区分服务器上存在的用户名。

**项目地址:** [MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing](https://github.com/MahdiOsman/CVE-2018-15473-SNMPv1-2-Community-String-Vulnerability-Testing)

**漏洞详情:** [CVE-2018-15473](https://nvd.nist.gov/vuln/detail/CVE-2018-15473)