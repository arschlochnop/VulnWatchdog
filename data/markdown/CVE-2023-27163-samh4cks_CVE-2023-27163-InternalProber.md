## CVE-2023-27163 Request-Baskets SSRF

**漏洞编号:** CVE-2023-27163

**漏洞类型:** 服务器端请求伪造 (SSRF)

**影响应用:** Request-Baskets

**危害等级:** 中危，可能允许攻击者访问内部网络资源

**影响版本:** <= 1.2.1

**利用条件:** 需要目标Request-Baskets实例可访问，且攻击者能够创建和配置basket

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-27163 是 Request-Baskets 1.2.1 及更早版本中存在的服务器端请求伪造 (SSRF) 漏洞。攻击者可以通过向 `/api/baskets/{name}` 组件发送特制的 API 请求，利用此漏洞访问内部网络资源和敏感信息。

**有效性：**
根据漏洞库信息、搜索引擎结果以及提供的漏洞利用代码，可以判断该漏洞的POC代码是有效的。搜索引擎结果中多个链接指向了公开的 PoC 代码库 (如 `https://github.com/entr0pie/CVE-2023-27163` 和 `https://github.com/mathias-mrsn/request-baskets-v121-ssrf`)，证明漏洞可被利用。提供的 Python 脚本 `CVE-2023-27163.py` 实现了利用该漏洞进行内部端口扫描的功能。

**投毒风险：**
分析提供的 Python 脚本 `CVE-2023-27163.py` 和相关文件 (LICENSE, README.md) 后，**没有发现任何明显的恶意代码或后门**。该脚本主要功能是创建 basket，配置 basket 的 forward_url 为内部 IP 地址和端口，然后通过发送请求到 basket 来判断该端口是否开放。脚本的逻辑清晰，代码量不大，易于审计。LICENSE 文件是标准的 MIT 许可证，表明代码是开源的，可以自由使用和修改。README.md 文件是简单的项目说明。因此，**投毒风险较低，接近 0%**。

**利用方式：**
1.  **创建 Basket：** 攻击者首先在目标 Request-Baskets 实例上创建一个新的 basket。这可以通过向 `/api/baskets/{name}` 发送 POST 请求来完成。脚本中使用随机字符串生成basket名称
2.  **获取 Token：** 创建 basket 成功后，服务器会返回一个 token，攻击者需要使用该 token 来配置 basket。
3.  **配置 Basket (SSRF)：** 攻击者使用 PUT 请求向 `/api/baskets/{name}` 发送配置信息，将 basket 的 `forward_url` 设置为内部 IP 地址和端口 (例如 `http://127.0.0.1:80`)。 `forward_url` 参数是 SSRF 漏洞的关键。攻击者通过控制这个参数，使 Request-Baskets 服务向内部网络发起请求。
4.  **触发 SSRF：** 攻击者向创建的 basket 发送 GET 请求 (例如 `{target_url}/{basket_name}` )。Request-Baskets 服务会将该请求转发到配置的 `forward_url`。如果内部端口开放，则服务会返回响应。如果端口关闭，则服务可能会返回错误 (例如 502 Bad Gateway)。
5.  **端口扫描：** 脚本通过遍历端口范围 (1-65535)，重复步骤 3 和 4，实现内部端口扫描的功能。如果某个端口返回非 502 状态码，则认为该端口是开放的。

**项目地址:** [samh4cks/CVE-2023-27163-InternalProber](https://github.com/samh4cks/CVE-2023-27163-InternalProber)

**漏洞详情:** [CVE-2023-27163](https://nvd.nist.gov/vuln/detail/CVE-2023-27163)