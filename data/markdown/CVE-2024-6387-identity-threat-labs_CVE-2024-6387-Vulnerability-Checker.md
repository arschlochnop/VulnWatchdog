## CVE-2024-6387-OpenSSH-竞争条件

**漏洞编号:** CVE-2024-6387

**漏洞类型:** 竞争条件

**影响应用:** OpenSSH

**危害等级:** 高危，可能导致远程代码执行和拒绝服务

**影响版本:** 8.5p1 <= version <= 9.7p1

**利用条件:** 需要网络访问，sshd服务运行且存在于受影响版本范围内，目标系统是基于glibc的Linux系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-6387（又名regreSSHion）是OpenSSH服务器中发现的竞争条件漏洞。未经身份验证的远程攻击者可以通过在设定的时间内未能通过身份验证来触发该漏洞。成功利用可能导致以root权限远程执行代码或拒绝服务。该漏洞的利用依赖于触发信号处理程序的竞争条件，攻击者需要发起大量连接尝试才能提高触发漏洞的几率。提供的PoC代码是一个漏洞验证工具，用于检测目标系统上运行的OpenSSH版本是否存在漏洞。它通过连接到目标SSH端口并检查SSH横幅来工作。如果横幅指示易受攻击的版本，则该工具会将目标标记为易受攻击。PoC代码本身似乎不包含任何明显的投毒代码。它仅仅用于验证漏洞是否存在，并不会主动进行利用。

**利用方式：**

1.  攻击者向目标服务器的SSH端口发起大量连接请求。
2.  连接请求需要故意失败，例如提供无效的用户名或密码，以便触发身份验证失败流程。
3.  攻击者利用OpenSSH处理信号时的竞争条件，将恶意指令插入堆中。
4.  如果竞争条件利用成功，攻击者即可在目标系统上以root权限执行任意代码或导致拒绝服务。

**项目地址:** [identity-threat-labs/CVE-2024-6387-Vulnerability-Checker](https://github.com/identity-threat-labs/CVE-2024-6387-Vulnerability-Checker)

**漏洞详情:** [CVE-2024-6387](https://nvd.nist.gov/vuln/detail/CVE-2024-6387)