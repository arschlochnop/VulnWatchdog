## CVE-2021-24006 - FortiManager Improper Access Control

**漏洞编号:** CVE-2021-24006

**漏洞类型:** 不当访问控制

**影响应用:** Fortinet FortiManager

**危害等级:** 中危，可能导致未经授权的访问和信息泄露

**影响版本:** 6.4.0 to 6.4.3

**利用条件:** 需要已认证的低权限用户，且FortiManager已安装SD-WAN Orchestrator

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-24006漏洞存在于FortiManager 6.4.0到6.4.3版本中。该漏洞允许具有受限用户配置文件的已认证攻击者，通过直接访问其URL来访问SD-WAN Orchestrator面板。漏洞利用方式是利用受限用户权限登录FortiManager，然后直接访问`/fortiwan/maintenance/controller_configuration` URL。如果成功，将可以访问SD-WAN Orchestrator界面，超出其权限范围。

**有效性：**

提供的PoC代码看起来是有效的。它模拟了具有受限权限的用户的身份验证过程，并尝试直接访问SD-WAN Orchestrator页面。代码检查响应状态码和页面内容以确认是否成功绕过访问控制。

**投毒风险：**

该PoC代码的投毒风险较低，约为5%。`exploit.py`脚本主要用于验证漏洞，除了设置目标URL、登录信息和发送请求外，没有发现任何可疑的或恶意操作的代码。 主要风险在于脚本中的硬编码的用户名和密码(`restricted_admin`, `senha123`)。如果攻击者直接使用这些凭据而不进行修改，可能会暴露其身份。虽然不构成直接的恶意代码，但是一种不良的安全实践。 `README.md`文件仅包含漏洞描述、影响版本、利用说明、缓解措施和免责声明，未发现任何恶意内容。

**利用方式：**

1.  使用具有受限权限的帐户登录到FortiManager Web界面。
2.  绕过访问控制，直接访问SD-WAN Orchestrator的URL：`https://<IP>/fortiwan/maintenance/controller_configuration`。
3.  如果漏洞存在且利用成功，受限用户将能够访问和操作SD-WAN Orchestrator界面。

**项目地址:** [cnetsec/CVE-2021-24006-Fortimanager-Exploit](https://github.com/cnetsec/CVE-2021-24006-Fortimanager-Exploit)

**漏洞详情:** [CVE-2021-24006](https://nvd.nist.gov/vuln/detail/CVE-2021-24006)