## CVE-2018-6574-Go-远程命令执行

**漏洞编号:** CVE-2018-6574

**漏洞类型:** 远程命令执行

**影响应用:** Go

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.8.7, 1.9.x < 1.9.4, 1.10 pre-releases < 1.10rc2

**利用条件:** 受害者使用存在漏洞的Go版本执行 `go get` 命令拉取恶意代码

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2018-6574 允许攻击者通过构造包含恶意 `// #cgo CFLAGS: -fplugin=` 指令的 Go 代码，在受害者使用 `go get` 命令拉取并构建该代码时，利用 gcc 或 clang 插件功能执行任意命令。

**有效性：**
提供的 PoC 代码是有效的。`attack.c` 文件包含一个在程序加载时执行 `system()` 函数的恶意函数，该函数会执行 `/usr/local/bin/score a96ec182-5326-4191-9570-5d5c3fe248a8` 命令。`main.go` 文件使用 `// #cgo CFLAGS: -fplugin=./attack.so` 指令告诉 Go 编译器在构建过程中加载 `attack.so` 插件，从而触发恶意代码的执行。

**投毒风险：**
经过分析，此 PoC 本身并不包含隐藏的投毒代码。`/usr/local/bin/score` 命令的功能未知，但如果该路径指向攻击者控制的服务器，可以构成数据回传或者其他恶意行为。不过单从提供的代码来看，其目的仅仅是利用漏洞触发执行任意命令，而非在代码中植入后门或其他形式的恶意代码。因此，投毒风险评估为 0%。

**利用方式：**
1.  攻击者创建一个包含恶意 `// #cgo CFLAGS: -fplugin=` 指令的 Go 包，并将该包托管在公开的代码仓库中。
2.  受害者使用存在漏洞的 Go 版本执行 `go get` 命令拉取该恶意包。
3.  `go get` 命令会自动构建该包，此时 Go 编译器会加载攻击者指定的恶意插件。
4.  恶意插件中的代码被执行，导致攻击者可以在受害者机器上执行任意命令。

**项目地址:** [Saboor-Hakimi/CVE-2018-6574](https://github.com/Saboor-Hakimi/CVE-2018-6574)

**漏洞详情:** [CVE-2018-6574](https://nvd.nist.gov/vuln/detail/CVE-2018-6574)