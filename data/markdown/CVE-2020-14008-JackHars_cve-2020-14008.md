## CVE-2020-14008 Zoho ManageEngine Applications Manager RCE

**漏洞编号:** CVE-2020-14008

**漏洞类型:** 远程代码执行

**影响应用:** Zoho ManageEngine Applications Manager

**危害等级:** 高危，允许经过身份验证的管理员用户上传恶意JAR文件，从而导致远程代码执行

**影响版本:** <= 14710

**利用条件:** 需要管理员权限，目标系统开启ManageEngine Applications Manager服务，且攻击者能够访问目标系统

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2020-14008 存在于 Zoho ManageEngine Applications Manager 14710 及更早版本中。该漏洞允许经过身份验证的管理员用户在特定位置上传恶意 JAR 文件，从而导致远程代码执行。

**有效性：**
提供的POC代码看起来有效，因为它模拟了以下步骤：
1.  **身份验证：** 使用提供的用户名和密码对 ManageEngine Applications Manager 进行身份验证。
2.  **payload构建：** 构建一个 PowerShell 反向 shell payload，并对其进行 Base64 编码。
3.  **漏洞利用：**  通过 `RestAPI/LogReceiver` 端点发送包含恶意payload的POST请求。利用了Java反序列化漏洞，通过`com.adventnet.servicemanager.install.dir`属性执行任意代码。

**投毒风险：**
此仓库中没有明显的恶意代码或后门。代码执行流程清晰，旨在利用已知的反序列化漏洞。

**利用方式：**
1.  攻击者需要拥有 ManageEngine Applications Manager 的管理员权限。
2.  攻击者使用提供的脚本，指定目标 URL、管理员凭据、攻击者的 IP 地址和端口。
3.  脚本首先尝试使用提供的凭据进行身份验证。
4.  身份验证成功后，脚本构建一个 PowerShell 反向 shell payload，该 payload 将连接回攻击者的机器并提供一个 shell。
5.  脚本将 payload 嵌入到专门构造的 JSON 数据中，并将其发送到 `/RestAPI/LogReceiver` 端点，触发Java反序列化漏洞。
6.  如果漏洞利用成功，目标系统将执行 payload，攻击者将在其监听端口上获得一个反向 shell，具有 SYSTEM 权限。

**项目地址:** [JackHars/cve-2020-14008](https://github.com/JackHars/cve-2020-14008)

**漏洞详情:** [CVE-2020-14008](https://nvd.nist.gov/vuln/detail/CVE-2020-14008)