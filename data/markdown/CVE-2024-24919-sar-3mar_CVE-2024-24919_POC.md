## CVE-2024-24919 Check Point Security Gateway 信息泄露漏洞

**漏洞编号:** CVE-2024-24919

**漏洞类型:** 信息泄露/路径穿越

**影响应用:** Check Point Quantum Gateway, Spark Gateway and CloudGuard Network

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** R81.20, R81.10, R81, R80.40 (Quantum Gateway and CloudGuard Network); R81.10, R80.20 (Spark Gateway)

**利用条件:** 需要目标设备连接到互联网，并启用远程Access VPN或Mobile Access Software Blades

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-24919 是 Check Point Security Gateway 中的一个信息泄露漏洞。根据漏洞信息和搜索结果，该漏洞允许未经身份验证的远程攻击者读取 Check Point Security Gateway 设备上的任意文件，从而泄露敏感信息。利用方式是通过构造包含路径遍历的恶意请求，例如 `aCSHELL/../../../../../../../etc/shadow`，发送到目标设备的 `/clients/MyCRL` 路径。POC代码中给出了使用 `curl` 命令的示例，演示了如何利用该漏洞读取 `/etc/shadow` 文件。由于POC简单明了，主要功能是利用路径穿越读取文件，因此投毒风险较低。虽然存在一定风险，即作者可能在其他地方（例如提供的 Notion 链接）嵌入恶意代码，但直接代码层面的投毒概率较低，初步估计为10%。

**漏洞利用方式：**

1.  **确定目标：** 找到运行受影响 Check Point Security Gateway 版本的设备，并且启用了远程 Access VPN 或 Mobile Access Software Blades。
2.  **构造恶意请求：**  构造包含路径遍历的 URL，例如：`https://<目标IP>/clients/MyCRL`，并在 POST 请求的 body 中包含路径遍历字符串，例如 `aCSHELL/../../../../../../../etc/shadow`。
3.  **发送请求：** 使用 `curl` 或其他 HTTP 客户端工具发送构造的请求。
4.  **提取信息：**  如果漏洞利用成功，服务器将返回所请求的文件内容，攻击者可以从中提取敏感信息，例如用户名和哈希密码。

**项目地址:** [sar-3mar/CVE-2024-24919_POC](https://github.com/sar-3mar/CVE-2024-24919_POC)

**漏洞详情:** [CVE-2024-24919](https://nvd.nist.gov/vuln/detail/CVE-2024-24919)