## CVE-2025-53770 - Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞导致远程代码执行

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码。

**影响版本:** SharePoint Server 2016，SharePoint Server 2019，SharePoint Server Subscription Edition (16.0.0 <= version < 16.0.18526.20508)

**利用条件:** 需要网络可达，目标SharePoint服务器存在漏洞且未应用补丁。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-53770 是 Microsoft SharePoint Server 中的一个反序列化漏洞，允许未经授权的攻击者通过网络执行任意代码。漏洞原理在于SharePoint Server在处理用户提交的恶意构造的序列化数据时，未能进行充分的验证，导致恶意代码被执行。 

**利用方式：**

1.  攻击者需要构造恶意的序列化数据，通常使用ysoserial等工具生成适用于.NET反序列化的Payload。
2.  POC提供的`Vul_Sacnner.py`脚本用于检测目标SharePoint服务器是否存在此漏洞。
3.  此脚本通过发送包含恶意Payload的HTTP POST请求到SharePoint服务器，默认通过Burp Suite代理进行流量分析。
4.  `config.json`文件包含检测规则，比如状态码、返回内容中的特征字符串等，用于判断目标是否受到攻击。
5.  `payload.json`文件包含POST数据，其中`MSOTlPn_Uri`指向一个SharePoint Server的`.ascx`控件，`MSOTlPn_DWP`包含了恶意payload。
6.  如果服务器存在漏洞，恶意Payload将被反序列化并执行，从而导致远程代码执行。

**有效性：**

根据漏洞描述和搜索结果，以及POC代码的逻辑，此POC代码是有效的，因为CVE描述中明确说明了该漏洞的存在性，以及漏洞的类型为反序列化。

**投毒风险：**

代码存在一定的投毒风险，虽然脚本的主要功能是漏洞检测，但`config.json`和`payload.json`的内容完全由使用者控制。因此，使用者可以修改`payload.json`来执行任意代码，如果攻击者将包含恶意代码的`config.json`或`payload.json`分发给他人，可能会导致被攻击者在不知情的情况下执行恶意操作。投毒风险评估为10%，因为利用此脚本进行攻击需要对`payload.json`进行构造，存在一定门槛，且需要修改配置文件，不会直接执行恶意操作。

**项目地址:** [imbas007/CVE-2025-53770-Vulnerable-Scanner](https://github.com/imbas007/CVE-2025-53770-Vulnerable-Scanner)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)