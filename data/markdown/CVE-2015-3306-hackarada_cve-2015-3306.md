## CVE-2015-3306 - ProFTPD mod_copy 任意文件读写

**漏洞编号:** CVE-2015-3306

**漏洞类型:** 任意文件读写

**影响应用:** ProFTPD

**危害等级:** 高危，可能导致敏感信息泄露和远程代码执行

**影响版本:** 1.3.5

**利用条件:** 需要目标服务器运行 ProFTPD 1.3.5，且开启 mod_copy 模块。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2015-3306 漏洞存在于 ProFTPD 1.3.5 版本的 mod_copy 模块中。攻击者可以利用 `SITE CPFR` 和 `SITE CPTO` 命令读取和写入服务器上的任意文件。 

**有效性：** 根据漏洞库信息、搜索结果以及提供的 Dockerfile，可以确认此漏洞存在且有可利用的PoC。大量的参考链接指向了漏洞的描述、利用方法和缓解措施。Dockerfile 文件展示了如何构建一个包含漏洞版本的 ProFTPD 的环境，用于漏洞复现。

**投毒风险：** 查看提供的Dockerfile和LICENSE文件.Dockerfile文件拉取`ftp://ftp.proftpd.org/distrib/source/proftpd-1.3.5.tar.gz`，进行编译安装。这里没有明显的投毒代码。main.sh 文件未提供，因此无法分析其内容，默认情况下，投毒代码的风险较低，但main.sh文件存在潜在风险. 总体风险评估为10%。

**利用方式：**

1.  **漏洞原理：** `mod_copy` 模块没有正确限制 `SITE CPFR` 和 `SITE CPTO` 命令的参数，导致可以指定任意文件路径作为源文件和目标文件。
2.  **利用步骤：**
    *   连接到 ProFTPD 服务器。
    *   使用 `SITE CPFR` 命令指定要复制的源文件路径（可以是任意文件）。
    *   使用 `SITE CPTO` 命令指定要复制的目标文件路径（也可以是任意文件）。
    *   通过复制文件，攻击者可以读取敏感文件的内容，或者写入恶意代码到服务器上。

**总结：** 此漏洞允许攻击者在服务器上执行任意文件读写操作，可能导致敏感信息泄露、权限提升甚至远程代码执行。需要及时升级 ProFTPD 版本或禁用 `mod_copy` 模块。

**项目地址:** [hackarada/cve-2015-3306](https://github.com/hackarada/cve-2015-3306)

**漏洞详情:** [CVE-2015-3306](https://nvd.nist.gov/vuln/detail/CVE-2015-3306)