## CVE-2025-33073 Windows SMB Client 提权漏洞

**漏洞编号:** CVE-2025-33073

**漏洞类型:** 权限提升

**影响应用:** Windows SMB Client

**危害等级:** 高危，可能导致系统权限被提升

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要目标机器开启SMB服务，并且攻击者需要拥有有效的用户名和密码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-33073是一个Windows SMB客户端提权漏洞。根据漏洞库信息和搜索结果，攻击者可以利用此漏洞通过网络提升权限。此漏洞绕过了NTLM反射缓解措施，允许经过身份验证的远程攻击者提升权限至SYSTEM级别。PoC代码通过以下步骤利用此漏洞：

1.  **检查SMB签名:** 使用crackmapexec工具检查目标IP上的SMB签名是否禁用。
2.  **域匹配验证:** 检查crackmapexec报告的域是否与提供的域匹配。
3.  **PetitPotam攻击:** 如果SMB签名被禁用且域匹配，则使用PetitPotam工具强制目标机器进行身份验证。
4.  **NTLM连接监听:** 启动netcat监听445端口，等待NTLM连接。
5.  **验证漏洞:** 如果接收到NTLM连接，则认为目标机器易受攻击。

**有效性:**

提供的PoC代码似乎是有效的。它结合了`crackmapexec`，`PetitPotam`和`netcat`等工具，实现了漏洞的检测和利用。

**投毒风险:**

该脚本主要流程是检测SMB签名是否被禁用，然后结合 PetitPotam 工具进行 NTLM 中继。其中存在一定的投毒风险，主要体现在以下几个方面：

*   **PetitPotam依赖:** 脚本依赖于外部的`PetitPotam.py`脚本，如果该脚本被恶意修改，可能导致未知的安全问题。恶意修改的 `PetitPotam.py` 可以包含后门或执行恶意代码。
*   **netcat监听:** 脚本使用`netcat`监听445端口，如果攻击者控制了该脚本，可以修改监听地址，将受害者的流量重定向到恶意服务器。
*   **域名劫持风险:** README中提到需要注册一个特殊的域名，如果攻击者同时控制了DNS服务器，可能存在域名劫持的风险。
*   **其他未知的潜在后门代码的风险:** 例如,对IP_FILE文件内容进行恶意篡改，导致拒绝服务攻击. 或者对用户名,密码进行记录，上传等.

综合评估，该PoC的投毒风险约为10%。PoC的主要功能是漏洞验证，但集成的外部依赖和潜在的恶意修改可能引入风险。

**项目地址:** [matejsmycka/CVE-2025-33073-checker](https://github.com/matejsmycka/CVE-2025-33073-checker)

**漏洞详情:** [CVE-2025-33073](https://nvd.nist.gov/vuln/detail/CVE-2025-33073)