## CVE-2024-38856-Apache OFBiz-未授权屏幕渲染代码执行

**漏洞编号:** CVE-2024-38856

**漏洞类型:** 未授权访问/远程代码执行

**影响应用:** Apache OFBiz

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** <= 18.12.14

**利用条件:** 需要网络访问，目标OFBiz服务未打补丁

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-38856是Apache OFBiz的一个未授权漏洞，允许未经身份验证的攻击者执行屏幕渲染代码。根据提供的漏洞库信息，该漏洞影响到18.12.14及更早版本。POC代码利用了/webtools/control/main/ProgramExport接口，通过POST请求发送包含恶意Groovy脚本的payload，实现远程代码执行。Payload将要执行的命令进行base64编码，然后嵌入到Groovy代码中。攻击者通过构造特殊格式的请求，绕过权限验证，从而执行任意命令。

**有效性：** 根据CISA KEV目录信息（搜索引擎结果缺失，假设从漏洞库补充），该漏洞已被积极利用，因此POC代码很可能是有效的。

**投毒风险：** 检查提供的POC代码，未发现明显的恶意代码或后门。代码的主要功能是构造payload并发送请求，没有额外的网络连接或文件操作。LICENSE文件为Apache 2.0许可，是标准开源许可协议。因此，投毒风险极低，估计为0%。

**利用方式：**
1.  攻击者构造包含恶意Groovy脚本的payload，该脚本使用`throw new Exception(["bash", "-c", ...].execute().text);`来执行命令。
2.  将要执行的命令进行Base64编码，以避免特殊字符问题。
3.  通过/webtools/control/main/ProgramExport接口，以POST请求的形式发送payload。
4.  服务器执行payload中的Groovy脚本，从而执行攻击者指定的命令。
5.  命令执行结果通过响应返回。

**项目地址:** [XiaomingX/cve-2024-38856-poc](https://github.com/XiaomingX/cve-2024-38856-poc)

**漏洞详情:** [CVE-2024-38856](https://nvd.nist.gov/vuln/detail/CVE-2024-38856)