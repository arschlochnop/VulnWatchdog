## CVE-2025-32463-Sudo-本地提权

**漏洞编号:** CVE-2025-32463

**漏洞类型:** 本地提权

**影响应用:** Sudo

**危害等级:** 高危，允许本地用户获得root权限

**影响版本:** 1.9.14 <= version < 1.9.17p1

**利用条件:** 需要本地用户权限，sudo程序存在漏洞版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-32463 漏洞允许本地用户通过利用 sudo 的 --chroot 选项和精心构造的 /etc/nsswitch.conf 文件来获得 root 权限。该漏洞存在于 Sudo 1.9.14 到 1.9.17p1 之前的版本。

**利用方式：**

1.  **创建临时目录：** 首先，创建一个临时目录作为漏洞利用的工作环境。
2.  **构造恶意 C 代码：**  编写一个包含构造函数的 C 程序（xd1337.c），该构造函数在加载时会执行特权提升操作（设置 uid 和 gid 为 0，然后执行 /bin/bash）。
3.  **准备虚假的 NSS 环境：**  创建一个包含 `etc/nsswitch.conf` 文件的目录结构。这个 `nsswitch.conf` 文件指向一个不存在的“数据库”，该“数据库”实际上就是编译好的恶意共享库。
4.  **编译恶意共享库：**  使用 gcc 将 C 代码编译为共享库（libnss_/xd1337.so.2）。关键在于使用 `-Wl,-init,xd1337` 选项，确保在库加载时执行 `xd1337` 函数。
5.  **利用 sudo -R 执行：**  使用 `sudo -R xd /bin/true` 命令，利用 sudo 的 --chroot 功能，将根目录切换到之前创建的虚假 NSS 环境的根目录（xd）。由于切换了根目录，sudo 会使用我们提供的 `nsswitch.conf` 文件，并尝试加载其中指定的“数据库”，实际上加载了我们的恶意共享库，从而执行了提权操作。
6.  **清理：**  删除临时目录。

**有效性：**

提供的 POC 代码看起来是有效的。它实现了上述利用方式，能够触发漏洞并获得 root 权限。

**投毒风险：**

存在较低的投毒风险（5%）。

*   脚本本身的核心逻辑是利用漏洞，没有发现明显的恶意代码。
*   README.md 中规中矩，没有可疑之处。

可能的风险点在于：

*   C 源码 `xd1337.c`  的构造函数中可以插入恶意代码，但这部分是漏洞利用的核心，不能算作额外投毒。但作者可以加入一些不明显但有危害的指令。
*   构建的目录结构可以隐藏其他恶意文件，但这个可能性较低。

总体而言，代码的意图是复现漏洞，投毒风险较低，但仍需谨慎。

**项目地址:** [9Insomnie/CVE-2025-32463](https://github.com/9Insomnie/CVE-2025-32463)

**漏洞详情:** [CVE-2025-32463](https://nvd.nist.gov/vuln/detail/CVE-2025-32463)