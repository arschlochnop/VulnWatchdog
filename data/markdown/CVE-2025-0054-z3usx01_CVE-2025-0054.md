## CVE-2025-0054 – SAP NetWeaver Stored XSS

**漏洞编号:** CVE-2025-0054

**漏洞类型:** 存储型跨站脚本 (Stored XSS)

**影响应用:** SAP NetWeaver Application Server Java

**危害等级:** 中危，可能允许攻击者读取或修改与受攻击网页相关的信息

**影响版本:** EP-BASIS 7.50, FRAMEWORK-EXT 7.50

**利用条件:** 需要低权限用户账户，以及目标SAP NetWeaver实例存在漏洞的端点。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞信息、搜索结果和漏洞利用代码，该漏洞是SAP NetWeaver Application Server Java中的一个存储型XSS漏洞。攻击者可以通过具有基本用户权限的帐户，将恶意JavaScript代码存储在服务器上。当其他用户访问包含该恶意代码的页面时，JavaScript代码将在他们的浏览器中执行，可能导致信息泄露或篡改。

**有效性：**

提供的Python POC代码似乎有效，它包含以下步骤：
1.  提交Payload: 使用`requests`库向目标URL的漏洞端点发送包含XSS Payload的POST请求。
2.  检测Payload: 再次访问漏洞页面，使用`BeautifulSoup`解析页面内容，检测XSS Payload是否被存储并执行。通过检查页面源代码中是否存在提交的`<script>`标签或Payload的反射来判断。

**投毒风险：**

该POC代码的投毒风险较低，大约为10%。 虽然该代码主要用于检测XSS漏洞，但需要注意以下几点：

*   **依赖的第三方库：** 使用了`requests`和`beautifulsoup4`库，如果这些库本身存在漏洞或被恶意篡改，可能会导致安全问题。但这种情况并不属于代码本身投毒。
*   **TARGET_URL：** 如果攻击者诱导用户修改`TARGET_URL`指向恶意服务器，可能会窃取用户提交的Cookie等敏感信息，但这属于用户自身安全意识问题。
*   **COOKIE：** 脚本要求提供有效的Cookie，这本身是为了利用漏洞，但如果Cookie泄露，攻击者可以直接利用。

总的来说，该脚本本身功能较为直接，风险点在于使用者的安全意识和所依赖的第三方库的安全性。

**利用方式：**

1.  **获得SAP NetWeaver Application Server Java实例的低权限帐户。**
2.  **配置POC代码：** 修改`scanner.py`文件中的`TARGET_URL`、`VULN_ENDPOINT`和`COOKIE`变量，使其指向目标SAP实例和有效的用户会话。
3.  **执行POC代码：** 运行`python3 scanner.py`，将XSS Payload提交到漏洞端点。
4.  **等待受害者访问：** 当其他用户访问包含恶意代码的页面时，XSS Payload将在他们的浏览器中执行。
5.  **利用XSS Payload：**  攻击者可以使用XSS Payload执行各种恶意操作，例如窃取Cookie、重定向用户到恶意网站、篡改页面内容等。


**项目地址:** [z3usx01/CVE-2025-0054](https://github.com/z3usx01/CVE-2025-0054)

**漏洞详情:** [CVE-2025-0054](https://nvd.nist.gov/vuln/detail/CVE-2025-0054)