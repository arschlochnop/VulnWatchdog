## CVE-2020-0796 SMBGhost 远程代码执行漏洞

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可导致远程代码执行

**影响版本:** Windows 10 Version 1903 和 1909, Windows Server, version 1903 和 1909

**利用条件:** 目标系统开启SMB服务（445端口）

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-0796（SMBGhost）是一个存在于 Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理特定请求方式中的远程代码执行漏洞。该漏洞影响Windows 10版本1903和1909以及Windows Server版本1903和1909。根据漏洞信息和搜索结果，该漏洞是“wormable”，这意味着它可以自我传播。POC代码已经公开，包括远程代码执行的PoC。利用方式通常涉及发送特制的SMBv3请求，触发缓冲区溢出，从而执行恶意代码。提供的README.md文件也说明了如何使用msfvenom生成payload，并使用python脚本执行漏洞。

**有效性：** 根据搜索结果和提供的README.md文件，该漏洞存在可用的POC代码，并且已经被广泛研究，因此，提供的POC代码**大概率有效**，但实际效果取决于目标环境和利用的配置是否正确。

**投毒风险：** 分析提供的README.md文件，其中包含的指令主要是关于如何生成payload和执行漏洞的步骤，以及一些参考链接。虽然README.md文件本身没有明显的恶意代码，但是，漏洞利用代码`exploit.py`可能存在投毒风险。例如，`exploit.py`可以被修改为：
1.  在攻击成功后，悄悄安装后门程序或上传其他恶意文件。
2.  收集目标系统的信息并发送到攻击者的服务器。
3.  植入恶意payload，影响其他系统或服务。
4.  依赖包投毒，通过pip安装恶意依赖。
5. 检查代码中是否有多余的网络请求或文件操作，这些操作可能是隐藏的恶意行为。由于我无法直接访问和分析`exploit.py`，因此无法完全排除投毒风险。基于现有信息，`exploit.py`存在**10%**的投毒风险。

**利用方式：**

1.  **确定目标系统：** 扫描网络，确定存在SMBv3漏洞的目标系统。
2.  **生成Payload：** 使用`msfvenom`或其他工具生成用于反弹shell或其他恶意操作的payload。
3.  **执行漏洞：** 使用提供的`exploit.py`脚本，向目标系统发送特制的SMBv3请求，触发漏洞并执行payload。
4.  **获取控制权：** 如果漏洞利用成功，攻击者将获得目标系统的控制权，例如反弹shell。

**项目地址:** [arzuozkan/CVE-2020-0796](https://github.com/arzuozkan/CVE-2020-0796)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)