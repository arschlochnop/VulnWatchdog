## CVE-2020-3452 Cisco ASA/FTD 目录遍历漏洞

**漏洞编号:** CVE-2020-3452

**漏洞类型:** 目录遍历

**影响应用:** Cisco ASA/FTD

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** < 9.6.4.42, < 9.8.4.20, < 9.9.2.74, < 9.10.1.42, < 9.13.1.10, < 9.14.1.10

**利用条件:** 目标设备启用了 WebVPN 或 AnyConnect 功能

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2020-3452 存在于 Cisco ASA 和 FTD 软件的 Web 服务接口中，允许未经身份验证的远程攻击者通过目录遍历攻击读取目标系统上的敏感文件。该漏洞是由于受影响设备处理的 HTTP 请求中的 URL 缺少适当的输入验证。攻击者可以发送包含目录遍历字符序列的特制 HTTP 请求来利用此漏洞。成功利用后，攻击者可以查看目标设备上 Web 服务文件系统中的任意文件。Web 服务文件系统在受影响的设备配置了 WebVPN 或 AnyConnect 功能时启用。此漏洞无法用于访问 ASA 或 FTD 系统文件或底层操作系统（OS）文件。

**漏洞利用有效性：**
根据漏洞库信息、搜索引擎结果和提供的漏洞利用代码，该漏洞利用是有效的。多个来源 (Rapid7, NVD, SonicWall, Invgate, HackerOne, Cisco, Tenable, Secpod, Twingate, Anvilogic) 都确认了该漏洞的存在以及其高危性。漏洞利用代码提供了一个基本的脚本，可以枚举 Cisco ASA/FTD 设备 Web 目录中可访问的标准文件。

**投毒风险：**
提供的漏洞利用代码主要包含一个脚本和一个文件列表。脚本本身似乎只是一个简单的利用工具，没有明显的恶意代码。`cisco_asa_file_list.txt` 文件是从 Metasploit 框架的 `CVE-2018-0296` 模块中提取的，用于枚举文件。但是，考虑到这是从外部源获取的文件列表，仍然存在微小的投毒风险，即该文件可能包含不必要的或误导性的条目，虽然它不会直接危害系统，但可能会分散分析人员的注意力或导致错误的结论。 总体来看，投毒风险较低，大约为 5%。

**利用方式：**
1.  目标系统需要启用 WebVPN 或 AnyConnect 功能，因为漏洞存在于 Web 服务接口中。
2.  攻击者需要构造包含目录遍历字符序列的特制 HTTP 请求。
3.  攻击者可以使用类似提供的脚本的工具，通过发送一系列包含不同文件名的 HTTP 请求，来枚举和下载目标设备上的文件。
4.  例如，攻击者可以发送如下请求：`GET /+CSCOE+/../+CSCOE+/../+CSCOE+/../+CSCOE+/../+CSCOE+/../+CSCOE+/etc/passwd` 来尝试读取 `/etc/passwd` 文件（虽然漏洞描述指出无法访问操作系统文件，但攻击者仍然会尝试）。

总而言之，这是一个高危漏洞，利用简单且影响较大（虽然仅限于读取 Web 服务文件系统中的文件），应该尽快修复。

**项目地址:** [iveresk/cve-2020-3452](https://github.com/iveresk/cve-2020-3452)

**漏洞详情:** [CVE-2020-3452](https://nvd.nist.gov/vuln/detail/CVE-2020-3452)