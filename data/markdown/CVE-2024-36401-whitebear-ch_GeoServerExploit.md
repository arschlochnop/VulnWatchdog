## CVE-2024-36401 - GeoServer RCE

**漏洞编号:** CVE-2024-36401

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** GeoServer

**危害等级:** 严重，未经身份验证的攻击者可以执行任意代码。

**影响版本:** 受影响版本包括 2.22.6 之前的所有版本，2.23.0 <= version < 2.23.6, 2.24.0 <= version < 2.24.4, 2.25.0 <= version < 2.25.2

**利用条件:** 默认 GeoServer 安装，需要网络访问。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-36401 存在于 GeoServer 中，由于 GeoTools 库不安全地将属性名称作为 XPath 表达式传递给 commons-jxpath 库，导致未经身份验证的用户可以通过构造特定的 OGC 请求参数（如 WFS GetFeature, WFS GetPropertyValue, WMS GetMap, WMS GetFeatureInfo, WMS GetLegendGraphic 和 WPS Execute）执行任意代码。

根据漏洞库信息和搜索结果，此漏洞利用已被积极利用。提供的漏洞利用代码（GeoServerExploit）表明已经存在可用的 PoC。

投毒风险分析：提供的漏洞利用代码仅包含 README.md 文件，展示了工具的使用示例和致谢信息。虽然从单个 README.md 文件无法完全判断是否存在投毒代码，但考虑到这是一个漏洞利用工具，仍有小概率（10%）存在作者隐藏的恶意代码或其他未公开的利用方式。需要检查完整的项目代码才能更准确地评估投毒风险。

利用方式总结：攻击者通过构造恶意的 OGC 请求，利用 commons-jxpath 库执行任意 XPath 表达式，从而实现远程代码执行。

**项目地址:** [whitebear-ch/GeoServerExploit](https://github.com/whitebear-ch/GeoServerExploit)

**漏洞详情:** [CVE-2024-36401](https://nvd.nist.gov/vuln/detail/CVE-2024-36401)