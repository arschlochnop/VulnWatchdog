## CVE-2024-47575-FortiManager-RCE

**漏洞编号:** CVE-2024-47575

**漏洞类型:** 未授权远程代码执行

**影响应用:** FortiManager

**危害等级:** 高危，无需身份验证即可远程执行代码

**影响版本:** FortiManager 7.6.0, 7.4.0-7.4.4, 7.2.0-7.2.7, 7.0.0-7.0.12, 6.4.0-6.4.14, 6.2.0-6.2.12, FortiManager Cloud 7.4.1-7.4.4, FortiManager Cloud 7.2.1-7.2.7, FortiManager Cloud 7.0.1-7.0.12, FortiManager Cloud 6.4.1-6.4.7

**利用条件:** 目标FortiManager实例暴露在网络上，且允许通过541端口进行通信

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-47575是FortiManager中的一个严重漏洞，源于fgfmsd守护进程缺少关键功能的身份验证。攻击者可以通过发送特制的请求在未授权的情况下执行任意代码或命令。

**利用方式：**

1.  **建立SSL连接:** 利用代码首先创建一个SSL连接到目标FortiManager的541端口。
2.  **获取IP:** 发送`get ip`请求以获取目标设备的信息。
3.  **获取认证:** 发送`get auth`请求。
4.  **文件交换请求:** 发送`get file_exchange`请求，并从中提取`remoteid`，该ID用于后续的通道操作。
5.  **通道打开:**  使用提取的`remoteid`构造`channel`请求，其中包含一个JSON payload，该payload会执行反向shell命令。此命令会将目标设备的shell重定向到攻击者指定的IP地址和端口。
6.  **通道关闭:**  发送`channel close`请求关闭通道。

**有效性评估：**

根据提供的漏洞信息、搜索结果和漏洞利用代码，可以判断该POC代码是有效的。搜索结果表明该漏洞已被积极利用，并且存在公开可用的POC。POC代码通过模拟FortiManager设备注册过程，并利用未授权的通道来执行任意命令。

**投毒风险评估：**

仔细检查了提供的POC代码，未发现任何明显的恶意或投毒代码。该代码按照漏洞利用的逻辑，构造请求并发送到目标，最终执行反向shell。虽然漏洞本身具有高危性，但提供的代码本身并没有额外的恶意行为。因此，投毒风险评估为0%。

**项目地址:** [watchtowrlabs/Fortijump-Exploit-CVE-2024-47575](https://github.com/watchtowrlabs/Fortijump-Exploit-CVE-2024-47575)

**漏洞详情:** [CVE-2024-47575](https://nvd.nist.gov/vuln/detail/CVE-2024-47575)