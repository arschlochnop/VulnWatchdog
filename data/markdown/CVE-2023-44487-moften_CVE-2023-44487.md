## CVE-2023-44487-HTTP/2 Rapid Reset攻击

**漏洞编号:** CVE-2023-44487

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** HTTP/2协议实现

**危害等级:** 高危，可能导致服务器资源耗尽，服务中断

**影响版本:** 受影响的HTTP/2协议实现

**利用条件:** 目标服务器启用HTTP/2协议

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-44487 漏洞是 HTTP/2 协议中的一个拒绝服务漏洞，被称为“Rapid Reset”攻击。该漏洞允许攻击者通过快速建立和重置大量 HTTP/2 流来耗尽服务器资源，导致拒绝服务。

**有效性分析：**

提供的PoC代码 `CVE-2023-44487.py` 旨在重现 Rapid Reset 攻击。该脚本使用 `h2` 库建立到目标服务器的 HTTP/2 连接，然后循环创建大量的 HTTP/2 流，并在发送少量数据后立即重置这些流。通过快速重复此过程，攻击者可以迫使服务器分配大量资源来处理这些流，从而导致资源耗尽和服务中断。

根据漏洞描述和搜索结果，该PoC代码基本有效。

**投毒风险分析：**

检查提供的Python脚本 `CVE-2023-44487.py` 和 `README.md` 文件。代码相对简洁，主要功能是建立 HTTP/2 连接并发送大量的RESET_STREAM帧。代码本身的功能符合漏洞描述，未发现明显的恶意代码或后门。`README.md` 仅为漏洞的描述和PoC的使用说明，没有包含任何可疑内容。

因此，投毒风险评估为 0%。

**利用方式分析：**

1.  **建立HTTP/2连接：** 攻击者首先与目标服务器建立一个 HTTP/2 连接。
2.  **创建大量流：** 在单个 HTTP/2 连接上，攻击者快速创建大量的 HTTP/2 流。每个流都代表一个独立的请求/响应序列。
3.  **快速重置流：** 攻击者在发送完整请求之前，立即向服务器发送 RST_STREAM 帧以重置每个流。这意味着服务器必须为每个流分配资源，然后立即释放它们。
4.  **资源耗尽：** 通过快速重复创建和重置流的过程，攻击者可以迫使服务器花费大量资源来处理这些流，从而导致 CPU、内存或其他资源的耗尽。
5.  **拒绝服务：** 当服务器的资源耗尽时，它将无法处理合法用户的请求，从而导致拒绝服务。

**缓解措施：**

*   **限制每个连接的最大流数：** 通过限制每个连接允许的最大活动流数，可以防止攻击者创建过多的流并耗尽服务器资源。
*   **限制流的创建速率：** 限制新流的创建速率可以防止攻击者快速创建大量流。
*   **实施重置限制：** 限制连接或特定时间内允许的重置流的数量，可以降低攻击的影响。
*   **更新服务器软件：** 及时更新服务器软件可以确保应用最新的安全补丁，从而修复已知的漏洞。

**项目地址:** [moften/CVE-2023-44487](https://github.com/moften/CVE-2023-44487)

**漏洞详情:** [CVE-2023-44487](https://nvd.nist.gov/vuln/detail/CVE-2023-44487)