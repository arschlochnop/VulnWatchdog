## CVE-2024-21513-langchain-experimental-代码执行

**漏洞编号:** CVE-2024-21513

**漏洞类型:** 代码执行

**影响应用:** langchain-experimental

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 0.0.15 <= version < 0.0.21

**利用条件:** 需要使用VectorSQLDatabaseChain，并能够影响输入prompt

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-21513 是一个存在于 langchain-experimental 包（版本 0.0.15 到低于 0.0.21）中的代码执行漏洞。漏洞原因是当从数据库检索值时，代码会尝试对所有值调用 'eval'。攻击者如果可以控制输入prompt，且服务器配置了 VectorSQLDatabaseChain，就可以利用此漏洞执行任意Python代码。

**有效性：**
从漏洞库信息和搜索结果来看，该漏洞是存在的，并且已经有公开的PoC。

**投毒风险：**
提供的 PoC 代码只包含一个 README.md 文件，描述了 CVE-2024-21513。因此，不存在明显的投毒代码。当然，不排除其他仓库或者payload中存在，但此处评估的这个仓库投毒风险为 0%。

**利用方式：**
1.  攻击者需要能够控制提供给 langchain-experimental 的输入 prompt。
2.  目标系统必须配置了 VectorSQLDatabaseChain。
3.  攻击者在 prompt 中注入恶意代码，该代码会被存储到数据库中。
4.  当 langchain-experimental 从数据库检索该值时，会使用 `eval` 函数执行恶意代码，从而导致任意代码执行。

**缓解措施：**
升级到 langchain-experimental 的 0.0.21 或更高版本。

**项目地址:** [nskath/CVE-2024-21513](https://github.com/nskath/CVE-2024-21513)

**漏洞详情:** [CVE-2024-21513](https://nvd.nist.gov/vuln/detail/CVE-2024-21513)