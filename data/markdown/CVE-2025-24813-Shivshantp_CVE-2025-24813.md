## CVE-2025-24813 - Apache Tomcat PUT JSP RCE

**漏洞编号:** CVE-2025-24813

**漏洞类型:** 远程代码执行

**影响应用:** Apache Tomcat

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 9.0.0.M1 - 9.0.98, 10.1.0-M1 - 10.1.34, 11.0.0-M1 - 11.0.2

**利用条件:** 需要目标Tomcat实例启用默认servlet的写入功能 (disabled by default) 和 支持 partial PUT (enabled by default)

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24813 是 Apache Tomcat 中一个路径等价漏洞，允许未经身份验证的攻击者通过 PUT 请求上传恶意 JSP 文件来执行远程代码。漏洞利用依赖于两个关键配置：1. Tomcat 默认 Servlet 的写入功能必须启用（默认情况下禁用）。 2. 必须支持 partial PUT（默认启用）。

**有效性：**
根据提供的漏洞利用代码（`exploit/1. exploit_cve_2025_24813.py`），该 PoC 尝试通过 PUT 请求将一个包含命令执行功能的 JSP webshell 上传到目标 Tomcat 服务器，默认路径为 `/shell.jsp`。 成功上传后，该 PoC 尝试通过发送带有 `cmd` 参数的 GET 请求来执行系统命令，验证是否成功执行远程代码。

**投毒风险：**
该仓库主要包含漏洞利用脚本，webshell 以及 Dockerfile 等配置，作者在docker配置中创建了`/usr/local/tomcat/conf/Catalina/localhost/ROOT.xml`,并设置了`<Context privileged='true' antiResourceLocking='false' swallowOutput='true' />`, 如果docker hub上存在投毒行为,可能会导致用户的敏感信息泄露。经过分析，未发现明显的恶意代码或后门。`exploit/2.shell.jsp` 只是webshell 的另一个副本，与PoC脚本一致。总体来说，代码的投毒风险较低，约为5%。

**利用方式：**
1.  **前提条件检查：** 确保目标 Tomcat 服务器满足漏洞利用的条件（默认 Servlet 写入已启用，支持 partial PUT）。
2.  **上传恶意 JSP 文件：** 使用 PUT 请求将包含恶意代码的 JSP 文件（如 `shell.jsp`）上传到目标服务器。`exploit/1. exploit_cve_2025_24813.py` 脚本即实现了此步骤。
3.  **执行远程代码：** 成功上传 JSP 文件后，通过访问该文件并传递命令参数（如 `shell.jsp?cmd=whoami`）来执行任意系统命令。

**缓解措施：**
*   升级到受影响的 Apache Tomcat 版本的修复版本 (11.0.3, 10.1.35, or 9.0.98).
*   禁用默认 servlet 的写入功能。
*   限制对 Tomcat 服务器的访问权限。

**项目地址:** [Shivshantp/CVE-2025-24813](https://github.com/Shivshantp/CVE-2025-24813)

**漏洞详情:** [CVE-2025-24813](https://nvd.nist.gov/vuln/detail/CVE-2025-24813)