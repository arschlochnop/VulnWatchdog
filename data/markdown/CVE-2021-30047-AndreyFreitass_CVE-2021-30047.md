## CVE-2021-30047-vsftpd-拒绝服务

**漏洞编号:** CVE-2021-30047

**漏洞类型:** 拒绝服务 (DoS)

**影响应用:** vsftpd

**危害等级:** 中危，导致服务不可用

**影响版本:** 3.0.3

**利用条件:** 需要网络访问目标FTP服务器

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-30047 漏洞存在于 vsftpd 3.0.3 版本中。该漏洞允许攻击者通过创建大量连接来耗尽服务器资源，导致拒绝服务。漏洞利用方式是通过发送大量的FTP连接请求，超出服务器的最大连接限制，使得正常用户无法连接。提供的PoC 代码通过使用多线程，循环创建 `ftp` 进程连接目标服务器，模拟了连接洪水攻击。`temporizador` 函数保证攻击在 15 分钟后自动停止，并通过 `pkill ftp` 命令结束所有 `ftp` 进程。代码中调用了外部命令 `ftp` 和 `pkill`，如果系统缺少这些命令可能无法运行。投毒风险较低，主要风险在于过度使用该脚本可能对目标系统或网络造成实际损害。代码中定时结束进程的操作，有几率会结束其他用户的ftp连接，存在一定误伤概率。

**项目地址:** [AndreyFreitass/CVE-2021-30047](https://github.com/AndreyFreitass/CVE-2021-30047)

**漏洞详情:** [CVE-2021-30047](https://nvd.nist.gov/vuln/detail/CVE-2021-30047)