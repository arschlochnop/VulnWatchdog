## CVE-2023-49109 - Apache DolphinScheduler Remote Code Execution

**漏洞编号:** CVE-2023-49109

**漏洞类型:** 远程代码执行

**影响应用:** Apache DolphinScheduler

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** < 3.2.1 (影响版本 3.0.0 及以上)

**利用条件:** 需要网络访问到DolphinScheduler服务

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息和搜索结果，CVE-2023-49109 是 Apache DolphinScheduler 3.2.1 之前版本中存在的一个远程代码执行漏洞。攻击者可以通过未授权的方式执行任意代码，从而完全控制服务器。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞已经确认存在，并且有公开的PoC。虽然提供的代码片段看起来是项目的构建和贡献指南，不直接是利用代码，但表明该项目存在代码构建过程，攻击者可能通过其他途径，如注入恶意依赖或者利用已知的反序列化漏洞等手段，实现远程代码执行。

**投毒风险：**
提供的代码片段（`CONTRIBUTING.md`、`LICENSE`）本身**不包含明显的恶意代码**，主要内容是项目贡献指南和 Apache License 2.0 许可协议，是合法的开源代码文件。判断是否存在投毒风险，需要关注以下几点：

1.  **构建过程：** `CONTRIBUTING.md` 中展示了构建项目的命令（`./mvnw clean install -Prelease`），攻击者可能通过篡改构建脚本或 POM 文件来引入恶意依赖，从而在构建过程中植入后门。
2.  **依赖管理：** DolphinScheduler 使用 Maven 进行依赖管理，攻击者可能尝试投毒 Maven 仓库，导致用户下载包含恶意代码的依赖。
3.  **源代码：** 尽管提供的代码片段是无害的，但攻击者可能尝试向 DolphinScheduler 的源代码仓库提交包含后门的恶意代码。

基于提供的有限信息，我给出的投毒风险是10%。这个百分比是基于一种推测：虽然直接的代码投毒不明显，但攻击者可以通过复杂的供应链攻击手段（例如，控制某个依赖库）来间接实现投毒。

**利用方式：**
1.  **漏洞触发：** 漏洞的具体触发方式需要进一步分析 DolphinScheduler 的代码，但已知的是攻击者可以通过某种未授权的方式，向DolphinScheduler服务发送恶意构造的请求。
2.  **代码执行：** 成功触发漏洞后，攻击者可以执行任意代码，例如，安装恶意软件、窃取敏感数据、或者破坏系统。
3.  **权限提升：** 攻击者可能尝试利用代码执行漏洞来提升权限，从而获得对服务器的完全控制。

总之，CVE-2023-49109 是一个严重的安全漏洞，需要尽快升级到 3.2.1 或更高版本。即使升级到最新版本，仍然需要关注供应链安全，避免受到投毒攻击。

**项目地址:** [shoucheng3/apache__dolphinscheduler_CVE-2023-49109_3-2-0](https://github.com/shoucheng3/apache__dolphinscheduler_CVE-2023-49109_3-2-0)

**漏洞详情:** [CVE-2023-49109](https://nvd.nist.gov/vuln/detail/CVE-2023-49109)