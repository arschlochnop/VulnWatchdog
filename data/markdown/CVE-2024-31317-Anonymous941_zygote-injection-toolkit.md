## CVE-2024-31317-Android Zygote注入

**漏洞编号:** CVE-2024-31317

**漏洞类型:** 特权提升

**影响应用:** Android

**危害等级:** 高危，可提升为system权限

**影响版本:** Android 12, 12L, 13, 14 (June 1, 2024 security patch 之前)

**利用条件:** 需要ADB和USB调试开启，以及未安装2024年6月1日之后的安全补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-31317 是一个Android Zygote注入漏洞，允许攻击者通过不安全的反序列化，利用`WRITE_SECURE_SETTINGS`权限，实现以任意应用身份执行代码。此漏洞不需要用户交互，本地用户即可利用提升权限。

**有效性：**
根据搜索结果和提供的PoC代码（`zygote_injection_toolkit`），可以判断该漏洞利用代码是有效的。多个搜索结果（例如，webpage 1, 3, 7, 9）都提到了该漏洞的利用方法，甚至有专门的文章分析和复现此漏洞。PoC代码包含利用所需的必要文件和初步框架，readme也详细介绍了漏洞的利用条件和影响。

**投毒风险：**
PoC代码存在一定的投毒风险，约为10%。主要依据以下几点：
*   **匿名作者和MIT许可证：** 虽然使用了MIT许可证，但作者署名为Anonymous941，缺乏背景信息，增加了代码可信度方面的风险。
*   **实验性代码：** 代码声明为“very experimental”，意味着可能存在未知的bug或后门。
*   **依赖项：** `pyproject.toml` 中声明依赖 `aidl@git+https://github.com/MatrixEditor/aidl-parser`，直接从GitHub安装，增加了依赖项被篡改的风险，虽然aidl-parser库看上去比较可信，但依然存在风险。
*   **缺乏完整实现：** 提供的代码片段并不完整，stage2部分缺失，需要用户自行实现，这增加了恶意代码注入的可能性。
虽然`IOemLockService.aidl` 是一个已知的Android接口定义，`LICENSE` 是一个标准的MIT许可，`README.md` 描述看起来是合理的，但是这些代码的组合以及依赖项存在一定的风险，不能完全排除作者故意添加恶意代码的可能性。风险主要在于依赖的第三方库和代码的不完整性。

**利用方式：**
1.  **前提条件：** 开启Android设备的USB调试，并通过ADB连接到设备。
2.  **检查漏洞：** 运行PoC代码检查设备是否受CVE-2024-31317影响，即是否安装了2024年6月1日之前的安全补丁。
3.  **Zygote注入：** PoC代码利用Zygote进程中的漏洞，通过不安全的反序列化机制，将恶意代码注入到Zygote进程中。
4.  **权限提升：** 注入的代码以`system`用户的身份执行，从而获得系统级别的权限。
5.  **执行恶意操作：** 利用system权限，可以执行以下操作：
    *   备份私有应用数据
    *   篡改系统应用数据
    *   绕过OEM限制
    *   尝试绕过运营商对Bootloader解锁的限制
    *   与其他提权漏洞链式利用，实现root权限。

**项目地址:** [Anonymous941/zygote-injection-toolkit](https://github.com/Anonymous941/zygote-injection-toolkit)

**漏洞详情:** [CVE-2024-31317](https://nvd.nist.gov/vuln/detail/CVE-2024-31317)