## CVE-2022-36804-Atlassian Bitbucket-命令注入

**漏洞编号:** CVE-2022-36804

**漏洞类型:** 命令注入

**影响应用:** Atlassian Bitbucket Server and Data Center

**危害等级:** 高危，允许远程攻击者执行任意代码

**影响版本:** 7.0.0 <= version < 7.6.17, 7.7.0 <= version < 7.17.10, 7.18.0 <= version < 7.21.4, 8.0.0 <= version < 8.0.3, 8.1.0 <= version < 8.1.3, 8.2.0 <= version < 8.2.2, 8.3.0 <= version < 8.3.1

**利用条件:** 需要对公开或私有Bitbucket仓库具有读取权限

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-36804是Atlassian Bitbucket Server和Data Center中的一个命令注入漏洞。根据漏洞描述，具有公开仓库访问权限或私有仓库读取权限的攻击者可以通过发送恶意HTTP请求来执行任意代码。从搜索结果来看，多个安全团队已经发现了此漏洞并发布了相关的分析报告和利用方式。漏洞存在于多个API端点中，利用方式是通过构造恶意的git命令，利用`--exec`参数执行任意命令。

提供的漏洞利用代码只包含了一个Apache License 2.0的许可证文件，没有实际的漏洞利用代码。因此，无法直接评估提供的POC代码的有效性。

由于提供的代码只是许可证文件，因此可以判定此仓库中不存在作者隐藏的投毒代码的风险。所以投毒风险为0%。

漏洞的利用方式：攻击者需要对目标Bitbucket仓库具有读取权限（公共仓库或私有仓库的读取权限）。然后，攻击者通过构造包含恶意git命令的HTTP请求发送到存在漏洞的API端点，服务器在处理这个请求时，由于没有充分过滤和转义特殊字符，导致恶意命令被执行，从而实现远程代码执行。

**项目地址:** [Inplex-sys/CVE-2022-36804](https://github.com/Inplex-sys/CVE-2022-36804)

**漏洞详情:** [CVE-2022-36804](https://nvd.nist.gov/vuln/detail/CVE-2022-36804)