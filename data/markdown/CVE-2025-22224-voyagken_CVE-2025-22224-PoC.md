## CVE-2025-22224-VMware VMX TOCTOU 漏洞

**漏洞编号:** CVE-2025-22224

**漏洞类型:** TOCTOU (Time-of-Check Time-of-Use) 竞争条件漏洞

**影响应用:** VMware ESXi, VMware Workstation

**危害等级:** 高危，可能导致虚拟机逃逸，在宿主机上执行代码

**影响版本:** ESXi 7.0/8.0受影响版本，Workstation 17.x 受影响版本

**利用条件:** 需要虚拟机内的本地管理员权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-22224 是 VMware ESXi 和 Workstation 中的一个 TOCTOU（Time-of-Check Time-of-Use）竞争条件漏洞，它会导致越界写入。具有虚拟机本地管理员权限的恶意行为者可以利用此漏洞，以在宿主机上运行的虚拟机的 VMX 进程的身份执行代码。

**有效性：**
根据漏洞库信息和搜索结果，此漏洞影响多个 VMware 产品，并且已被 CISA 加入 KEV 列表，表明该漏洞已被积极利用。提供的 POC 代码仓库名称为 `CVE-2025-22224-PoC`，且描述为 `Privilege Escalation via TOCTOU in VMware VMX (CVE-2025-22224)`，表明存在可用的 POC 代码。

**投毒风险：**
POC 代码仓库目前只包含一个 README.md 文件，无法直接评估其投毒风险。考虑到通常 PoC 会附带漏洞验证及利用代码,此 PoC 验证代码可能存在恶意的后门或植入行为。如果后期代码仓库更新添加了二进制文件或其他可执行代码，则投毒风险将大大提高。目前仅从 README.md 文件来判断，投毒风险较低，估计为 10%。

**利用方式：**
1.  攻击者需要在受影响的 VMware ESXi 或 Workstation 上的虚拟机中获得本地管理员权限。
2.  利用 TOCTOU 漏洞，在检查和使用某资源之间的时间差内，修改该资源的状态。
3.  通过精心设计的攻击，造成越界写入。
4.  最终，攻击者可以在宿主机上运行的虚拟机的 VMX 进程的身份执行任意代码，实现虚拟机逃逸和宿主机控制。

**项目地址:** [voyagken/CVE-2025-22224-PoC](https://github.com/voyagken/CVE-2025-22224-PoC)

**漏洞详情:** [CVE-2025-22224](https://nvd.nist.gov/vuln/detail/CVE-2025-22224)