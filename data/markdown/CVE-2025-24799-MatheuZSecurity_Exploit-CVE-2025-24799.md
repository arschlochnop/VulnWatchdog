## CVE-2025-24799-GLPI-SQL注入

**漏洞编号:** CVE-2025-24799

**漏洞类型:** SQL注入

**影响应用:** GLPI

**危害等级:** 高危，可能导致敏感信息泄露

**影响版本:** >= 10.0.0, < 10.0.18

**利用条件:** 目标GLPI实例开启inventory功能，且未进行身份验证

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于GLPI的inventory endpoint，未经身份验证的攻击者可以通过构造恶意的XML payload，向服务器发送包含SQL注入语句的请求。由于漏洞点无需身份验证，CVSS评分为7.5。PoC利用time-based blind SQL注入，通过sleep函数判断条件是否成立。虽然代码看起来比较规范，但攻击脚本的下载地址是github, github存在被投毒的风险，且PoC中使用的requests库也存在中间人攻击的风险。 综合评估，投毒风险为10%。利用方式如下：

1.  攻击者发送特制的XML payload到GLPI的inventory endpoint。
2.  Payload中的deviceid参数包含SQL注入语句，利用`OR IF(condition,SLEEP(SLEEP_TIME),0)-- -` 构造延时注入。
3.  通过判断请求响应时间，确定SQL条件是否为真，从而提取数据库中的敏感信息，如用户名和密码。
4. PoC通过遍历用户表，逐字符猜测用户名和密码。

**项目地址:** [MatheuZSecurity/Exploit-CVE-2025-24799](https://github.com/MatheuZSecurity/Exploit-CVE-2025-24799)

**漏洞详情:** [CVE-2025-24799](https://nvd.nist.gov/vuln/detail/CVE-2025-24799)