## CVE-2019-13272-Linux Kernel PTRACE_TRACEME Privilege Escalation

**漏洞编号:** CVE-2019-13272

**漏洞类型:** 权限提升

**影响应用:** Linux Kernel

**危害等级:** 高危，本地用户可获取root权限

**影响版本:** < 5.1.17

**利用条件:** 本地用户权限，目标kernel版本低于5.1.17，可能需要满足特定的父子进程关系和权限设置。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-13272 漏洞存在于 Linux kernel 5.1.17 之前的版本中，`kernel/ptrace.c` 中的 `ptrace_link` 函数在处理进程创建 ptrace 关系时的凭据记录时存在缺陷，导致本地用户可以利用该漏洞获取 root 权限。该漏洞利用涉及父子进程关系，父进程降低权限后调用 `execve`，攻击者可能控制子进程。漏洞触发原因包括对象生命周期问题和 ptrace 关系标记为特权关系时的不正确处理。利用方式通常涉及使用 `PTRACE_TRACEME`，例如通过 Polkit 的 `pkexec` 辅助程序。提供的漏洞利用代码 `/tmp/d11d72749c26a560b42d6bdc83929fcb/README.md` 仅仅是一个包含漏洞名称的文件，本身不包含任何可执行代码，因此没有投毒风险，有效性需要其他exp代码的配合。从搜索引擎结果来看，存在多个exp利用此漏洞，成功利用可以提升权限。

**项目地址:** [sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272](https://github.com/sumedhaDharmasena/-Kernel-ptrace-c-mishandles-vulnerability-CVE-2019-13272)

**漏洞详情:** [CVE-2019-13272](https://nvd.nist.gov/vuln/detail/CVE-2019-13272)