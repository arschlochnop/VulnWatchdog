## CVE-2019-14287-Sudo权限绕过

**漏洞编号:** CVE-2019-14287

**漏洞类型:** 权限提升

**影响应用:** Sudo

**危害等级:** 高危，允许低权限用户以root权限执行命令

**影响版本:** < 1.8.28

**利用条件:** 需要用户在sudoers文件中拥有Runas ALL权限，但不允许以root身份运行特定命令（例如!root）。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2019-14287漏洞允许具有Runas ALL权限的sudo用户绕过某些策略黑名单和会话PAM模块。攻击者可以通过指定一个特殊的UID（例如#-1或0xffffffff，这两个值都会被解释为0，即root用户ID）来执行命令，即使sudoers配置文件明确禁止以root身份运行命令。利用方式是使用`sudo -u#-1 <command>`。 

**有效性：**提供的POC代码（`exploit.py`）利用了这一漏洞，首先检查当前用户通过sudo可以运行哪些命令，然后尝试使用`-u#-1`选项以root权限执行这些命令。根据漏洞描述，该POC代码应该是有效的。

**投毒风险：**分析`exploit.py`、`README.md`和`linpeas.sh`三个文件，发现`exploit.py`主要实现了漏洞的利用，没有发现明显的恶意代码。`README.md`只是漏洞的描述信息。`linpeas.sh`是一个Linux权限提升检查脚本，本身功能是为了辅助权限提升，但如果被恶意修改，例如在特定条件下执行恶意命令，则可能被用于投毒。虽然该脚本本身不直接包含恶意代码，但是存在被篡改后利用的可能性。

综合考虑，`exploit.py` 主要用于漏洞利用，功能相对独立，投毒可能性较低。`linpeas.sh` 脚本功能强大，但存在一定被植入恶意代码的可能性，评估其投毒风险为5%。

**利用方式：**
1.  **前提条件：** 攻击者需要拥有sudo权限，并且sudoers配置文件允许以Runas ALL身份运行命令，但可能存在对root用户的限制（如`!root`）。
2.  **利用方法：** 使用`sudo -u#-1 <command>`或其他类似的UID绕过方式，使得sudo将该命令以root权限执行，从而绕过sudoers配置文件的限制。
3.  **结果：** 攻击者成功以root权限执行任意命令，实现权限提升。

**项目地址:** [MariliaMeira/CVE-2019-14287](https://github.com/MariliaMeira/CVE-2019-14287)

**漏洞详情:** [CVE-2019-14287](https://nvd.nist.gov/vuln/detail/CVE-2019-14287)