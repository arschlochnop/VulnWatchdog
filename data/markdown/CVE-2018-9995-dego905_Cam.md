## CVE-2018-9995-TBK DVR身份认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 身份认证绕过

**影响应用:** TBK DVR4104/DVR4216以及相关品牌DVR

**危害等级:** 高危，可能导致未经授权的访问和控制

**影响版本:** TBK DVR4104 和 DVR4216设备, 以及 Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, 和 MDVR Login，这些设备运行原始TBK DVR4104和DVR4216系列的重新贴牌版本

**利用条件:** 需要网络访问DVR设备的HTTP服务

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

漏洞CVE-2018-9995存在于TBK DVR4104和DVR4216等一系列DVR设备中。攻击者可以通过在HTTP请求头中设置`Cookie: uid=admin`来绕过身份验证。提供的POC代码使用`curl`命令发送带有特制Cookie头的HTTP请求，访问`/device.rsp?opt=user&cmd=list`接口，从而获取设备上的用户信息，包括用户名和密码。该POC代码首先构建一个包含`uid=admin` Cookie的HTTP请求头，然后使用`curl`发送请求并解析返回的JSON数据。 

**有效性：**
提供的POC代码似乎是有效的，因为它直接利用了漏洞描述中的方法，即通过设置Cookie来绕过身份验证。如果目标设备存在此漏洞，该代码应该能够成功获取用户信息。

**投毒风险：**
代码本身没有明显的投毒行为。它只是简单地发送一个带有特定Cookie的请求，然后解析响应。所有操作都是与利用CVE-2018-9995漏洞相关的行为。该脚本是为了方便利用漏洞而编写的，本身并不会执行任何恶意操作，如安装后门、上传数据等。所以投毒风险为0%。

**利用方式：**
1.  攻击者找到一个存在漏洞的TBK DVR或其重新贴牌的设备。
2.  攻击者运行POC脚本，指定目标设备的IP地址和端口号。
3.  POC脚本会发送一个带有`Cookie: uid=admin`头部的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`接口。
4.  如果漏洞存在，设备会返回包含用户信息的JSON数据，而无需进行身份验证。
5.  攻击者可以利用返回的用户信息，例如用户名和密码，来进一步控制设备。

**项目地址:** [dego905/Cam](https://github.com/dego905/Cam)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)