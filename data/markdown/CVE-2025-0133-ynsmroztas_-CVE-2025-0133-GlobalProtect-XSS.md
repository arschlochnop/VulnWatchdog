## CVE-2025-0133-PAN-OS-Reflected XSS

**漏洞编号:** CVE-2025-0133

**漏洞类型:** Reflected XSS

**影响应用:** PAN-OS GlobalProtect Gateway/Portal

**危害等级:** 中危，可能导致凭据窃取和钓鱼攻击

**影响版本:** PAN-OS 11.2.0-11.2.7, 11.1.0-11.1.10, 10.2.0-10.2.16, 10.1.0-10.1.14

**利用条件:** 需要目标系统启用GlobalProtect网关或门户，且用户已通过身份验证的Captive Portal

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-0133是Palo Alto Networks PAN-OS GlobalProtect网关和门户功能中的一个反射型跨站脚本 (XSS) 漏洞。攻击者可以通过构造包含恶意JavaScript代码的特殊链接，诱导已通过身份验证的Captive Portal用户点击该链接。当用户点击链接时，恶意JavaScript代码将在用户的浏览器上下文中执行，可能导致凭据窃取（尤其是启用了Clientless VPN时）或进行钓鱼攻击。

**有效性：**
提供的PoC代码利用了`/ssl-vpn/getconfig.esp`端点，并通过`user`参数将XSS payload注入到URL中。PoC代码会发送带有payload的请求，并检查响应是否包含注入的payload，以此判断XSS是否成功执行。根据PoC的逻辑，该PoC应该是有效的。

**投毒风险：**
查看提供的PoC代码，该代码主要功能是构造包含XSS payload的URL，并发送GET请求。代码中没有发现任何可疑的、与漏洞利用无关的操作，如文件读写、反向shell等。因此，该PoC代码的投毒风险较低。

**利用方式：**
1.  攻击者构造包含恶意JavaScript代码的URL，该URL指向受影响的PAN-OS GlobalProtect网关或门户的`/ssl-vpn/getconfig.esp`端点，并将恶意代码嵌入到`user`参数中。
2.  攻击者通过各种方式（例如，电子邮件、社交媒体）将构造的恶意链接发送给目标用户。
3.  目标用户（已通过身份验证的Captive Portal用户）点击该恶意链接。
4.  用户的浏览器向受影响的PAN-OS设备发送请求，PAN-OS设备将恶意JavaScript代码反射回用户的浏览器。
5.  用户的浏览器执行恶意JavaScript代码，攻击者可以利用该代码窃取用户的凭据（特别是启用了Clientless VPN时）或进行钓鱼攻击。

**项目地址:** [ynsmroztas/-CVE-2025-0133-GlobalProtect-XSS](https://github.com/ynsmroztas/-CVE-2025-0133-GlobalProtect-XSS)

**漏洞详情:** [CVE-2025-0133](https://nvd.nist.gov/vuln/detail/CVE-2025-0133)