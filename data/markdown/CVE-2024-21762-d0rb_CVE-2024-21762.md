## CVE-2024-21762-FortiOS/FortiProxy-Out-of-Bounds Write

**漏洞编号:** CVE-2024-21762

**漏洞类型:** Out-of-Bounds Write

**影响应用:** FortiOS/FortiProxy

**危害等级:** 高危，远程代码执行

**影响版本:** FortiOS: 7.4.0-7.4.2, 7.2.0-7.2.6, 7.0.0-7.0.13, 6.4.0-6.4.14, 6.2.0-6.2.15, 6.0.0-6.0.17; FortiProxy: 7.4.0-7.4.2, 7.2.0-7.2.8, 7.0.0-7.0.14, 2.0.0-2.0.13, 1.2.0-1.2.13, 1.1.0-1.1.6, 1.0.0-1.0.7

**利用条件:** 目标系统存在漏洞版本，且可从网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-21762 是 FortiOS 和 FortiProxy 中 SSL VPN 组件的越界写入漏洞。未经身份验证的远程攻击者可以通过精心构造的请求利用此漏洞执行任意代码或命令。

**漏洞利用分析：**

1.  **漏洞类型：** 越界写入。
2.  **影响组件：** SSL VPN (sslvpnd) 服务。
3.  **利用方式：**  
    *   POC 利用 Python 脚本，通过发送特制的 HTTP POST 请求到 `/remote/hostcheck_validate` 触发漏洞。
    *   payload 包含 ROP 链（Return Oriented Programming），用于绕过安全机制，执行任意代码。
    *   脚本首先发送一个精心构造的包含大量填充字节和覆盖指针的 POST 请求。
    *   然后发送一个chunked的POST请求，里面包含一些0和A，进一步利用。
4.  **有效性评估：**
    *   根据搜索结果，此漏洞已被野外利用 (exploited in the wild)。
    *   Assetnote 提供了漏洞分析和利用的文章。
    *   Bishop Fox 发布了漏洞扫描器。
    *   POC 较为完整，提供了目标地址和端口配置，以及构造 payload 的细节，应该具有较高的成功率。
5. **投毒风险评估:**
   *   `README.md` 中包含支持以色列的政治声明，这本身不构成投毒，但可能暗示作者的政治立场，需要关注。
   *   POC 本身利用了漏洞，如果攻击者修改了 `JS_PAYLOAD` 部分，可能会植入恶意代码。
   *   `form_value` 中包含 `JS_PAYLOAD` 字符串，脚本将用实际的 JavaScript 代码替换它。如果此 JavaScript 代码是恶意的，则存在投毒的可能。
   *   `rop` 变量被标记为 “Example ROP chain”，如果未经修改直接使用，可能导致利用失败，但也可能被修改为恶意 ROP 链。
   *   考虑到以上几点，仓库存在潜在的投毒风险，但主要取决于使用者如何修改和使用payload, 故风险百分比定为10%。
6.  **修复建议：** 升级到 Fortinet 官方提供的修复版本。

**项目地址:** [d0rb/CVE-2024-21762](https://github.com/d0rb/CVE-2024-21762)

**漏洞详情:** [CVE-2024-21762](https://nvd.nist.gov/vuln/detail/CVE-2024-21762)