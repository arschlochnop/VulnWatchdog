## CVE-2018-19207-WP GDPR Compliance-远程代码执行

**漏洞编号:** CVE-2018-19207

**漏洞类型:** 远程代码执行

**影响应用:** WP GDPR Compliance

**危害等级:** 高危，可能导致服务器被完全控制

**影响版本:** < 1.4.3

**利用条件:** WordPress站点安装了受影响版本的WP GDPR Compliance插件，且允许远程访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2018-19207 存在于 WordPress 的 WP GDPR Compliance 插件的 1.4.3 之前版本中。漏洞原因是 $wpdb->prepare() 函数处理输入不当，导致远程攻击者可以执行任意代码。根据搜索结果和提供的漏洞利用代码，可以确认该漏洞的存在和利用方式。提供的 Dockerfile 构建了一个包含漏洞版本的 WordPress 实例，方便漏洞复现和测试。build/main.sh 脚本用于启动数据库、配置 WordPress 并激活存在漏洞的插件。 

**有效性：** 根据漏洞库信息、搜索结果和提供的 Dockerfile，该漏洞利用有效。存在公开的利用代码，并且漏洞已经被广泛讨论。

**投毒风险：** 漏洞利用代码存在轻微的投毒风险。具体分析如下：
* Dockerfile 从 `cved/base-wordpress` 镜像构建。虽然作者声明为`cved (cved@protonmail.com)`，但如果 `cved/base-wordpress` 镜像被篡改，则可能引入恶意代码。需要检查基础镜像来源的可靠性。
* `build/main.sh` 脚本设置了 MySQL root 用户的密码为 "root"，这本身是一个安全风险，可能被恶意利用。但这更多的是为了方便复现漏洞，而非有意投毒。
* `/db.sql` 文件内容未提供，无法评估是否存在恶意SQL注入等投毒行为。 但考虑初始化数据库的脚本，风险相对较低。
综合考虑，主要风险在于基础镜像和未知的`/db.sql`内容，因此投毒可能性评估为 10%。

**利用方式：** 攻击者可以利用该漏洞，通过构造恶意的 SQL 查询语句，利用 $wpdb->prepare() 函数的缺陷执行任意代码。攻击者通常会利用这个漏洞来上传恶意插件或修改数据库中的敏感信息，从而控制整个 WordPress 站点。

**项目地址:** [cved-sources/cve-2018-19207](https://github.com/cved-sources/cve-2018-19207)

**漏洞详情:** [CVE-2018-19207](https://nvd.nist.gov/vuln/detail/CVE-2018-19207)