## CVE-2018-9995 - TBK DVR 认证绕过

**漏洞编号:** CVE-2018-9995

**漏洞类型:** 认证绕过

**影响应用:** TBK DVR4104, DVR4216以及其他Re-branded设备 (Novo, CeNova, QSee, Pulnix, XVR 5 in 1, Securus, Night OWL, DVR Login, HVR Login, MDVR Login)

**危害等级:** 高危，允许未授权访问DVR控制面板，获取敏感信息如用户名和密码

**影响版本:** 受影响的TBK DVR4104和DVR4216系列以及re-branded版本

**利用条件:** 需要能够访问DVR设备的HTTP服务端口（通常是80端口）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

该漏洞允许攻击者通过设置Cookie "uid=admin"绕过身份验证，直接访问DVR设备的控制面板。提供的PoC代码使用Python脚本，通过发送带有特定Cookie的HTTP请求到目标设备的`/device.rsp?opt=user&cmd=list`路径，来获取设备的用户名和密码。脚本首先构造包含恶意Cookie的HTTP头部，然后发送GET请求，解析返回的JSON数据，提取用户名和密码并以表格形式显示。

**有效性分析：**
根据漏洞描述和PoC代码，该漏洞利用方法直接简单，通过设置Cookie即可绕过身份验证。提供的PoC代码能够成功利用该漏洞，获取设备上的用户信息。

**投毒风险分析：**
分析PoC代码后，未发现明显的恶意代码或后门。代码的主要功能是发送HTTP请求和解析JSON响应，没有执行系统命令或进行其他可疑操作。因此，可以认为投毒风险较低。

**利用方式：**
1.  确定目标DVR设备的IP地址和端口号。
2.  运行PoC脚本，提供目标设备的IP地址和端口号作为参数。
3.  脚本将发送带有"uid=admin" Cookie的HTTP请求到目标设备。
4.  如果设备存在漏洞，脚本将解析返回的JSON数据，并显示设备上的用户名和密码。

**项目地址:** [dearpan/cve-2018-9995](https://github.com/dearpan/cve-2018-9995)

**漏洞详情:** [CVE-2018-9995](https://nvd.nist.gov/vuln/detail/CVE-2018-9995)