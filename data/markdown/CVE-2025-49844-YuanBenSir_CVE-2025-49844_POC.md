## CVE-2025-49844-Redis-Lua Use-After-Free

**漏洞编号:** CVE-2025-49844

**漏洞类型:** Use-After-Free

**影响应用:** Redis

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 8.2.2

**利用条件:** 需要Redis服务器启用Lua脚本功能，且攻击者具有执行Lua脚本的权限（通常需要已认证的用户身份）

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-49844 漏洞是 Redis 中 Lua 脚本引擎的一个 Use-After-Free 漏洞。攻击者可以利用精心构造的 Lua 脚本来操作垃圾回收器，从而触发 Use-After-Free 漏洞，最终可能导致远程代码执行。

**有效性：**
根据漏洞描述，只要 Redis 服务器版本低于 8.2.2，并且启用了 Lua 脚本功能，就可能受到攻击。攻击者需要具有执行 Lua 脚本的权限。

**投毒风险：**
提供的漏洞利用代码仅包含 Apache License 的文本内容，没有发现任何恶意代码或后门，因此投毒风险为0%。

**利用方式：**
1.  **漏洞触发：** 攻击者需要向 Redis 服务器发送包含恶意 Lua 脚本的 EVAL 或 EVALSHA 命令。
2.  **内存操作：** 恶意 Lua 脚本会尝试操作 Redis 的垃圾回收器，例如释放已经释放的内存。
3.  **Use-After-Free：** 攻击者通过特定的 Lua 脚本，控制内存释放和访问，触发 Use-After-Free 漏洞。
4.  **远程代码执行：** 进一步利用 Use-After-Free 漏洞，通过内存布局和函数指针覆盖等技术，最终实现远程代码执行。

**总结：**
该漏洞危害性极高，可能导致 Redis 服务器被完全控制。修复方法是升级到 Redis 8.2.2 或更高版本，或者使用 ACL 限制 EVAL 和 EVALSHA 命令的执行，从而禁用 Lua 脚本功能。

**项目地址:** [YuanBenSir/CVE-2025-49844_POC](https://github.com/YuanBenSir/CVE-2025-49844_POC)

**漏洞详情:** [CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)