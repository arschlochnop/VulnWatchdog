## CVE-2022-1274-Keycloak-HTML注入

**漏洞编号:** CVE-2022-1274

**漏洞类型:** HTML注入

**影响应用:** Keycloak

**危害等级:** 中危，可能导致钓鱼攻击或其他针对用户的攻击

**影响版本:** 未知，但存在于execute-actions-email端点

**利用条件:** 需要访问Keycloak的Admin REST API和execute-actions-email端点

**POC 可用性:** 否 (提供的文件不是漏洞利用代码，而是项目文档)

**投毒风险:** 0%

## 详情

CVE-2022-1274 漏洞存在于 Keycloak 的 `execute-actions-email` 端点，允许攻击者注入任意 HTML 代码到发送给 Keycloak 用户的电子邮件中。这可能被滥用以进行钓鱼攻击或其他恶意行为。

**有效性评估：**
根据漏洞库信息和搜索结果，漏洞是有效的。但是，提供的“漏洞利用代码”实际上是 Keycloak 项目的 `ADOPTERS.md` 和 `CONTRIBUTING.md` 文件，并非漏洞利用代码，因此无法直接验证其有效性。

**投毒风险评估：**
提供的两个文件是项目文档，不太可能包含投毒代码。因此，投毒风险评估为 0%。

**利用方式分析：**
根据搜索结果，攻击者可以通过向 `execute-actions-email` 端点发送包含恶意 HTML 代码的请求来利用此漏洞。Keycloak 会将这些 HTML 代码插入到发送给用户的电子邮件中。例如，攻击者可以插入一个伪造的登录表单，诱骗用户输入凭据，从而窃取用户的账号。

**优先级排序：**
1. 搜索引擎结果（提供了漏洞信息和利用场景）
2. 漏洞利用代码（虽然提供的不是真正的利用代码，但检查了内容，确认没有投毒风险）
3. 漏洞库信息（提供了漏洞描述和相关链接）

**项目地址:** [shoucheng3/keycloak__keycloak_CVE-2022-1274_20-0-3](https://github.com/shoucheng3/keycloak__keycloak_CVE-2022-1274_20-0-3)

**漏洞详情:** [CVE-2022-1274](https://nvd.nist.gov/vuln/detail/CVE-2022-1274)