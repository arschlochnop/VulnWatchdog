## CVE-2025-24054 - NTLM Hash Disclosure Spoofing

**漏洞编号:** CVE-2025-24054

**漏洞类型:** NTLM Hash Disclosure Spoofing

**影响应用:** Microsoft Windows

**危害等级:** 中危，可能导致凭据泄露和身份冒充

**影响版本:** 受影响的Windows版本请参考漏洞库信息

**利用条件:** 需要用户访问恶意构造的`.library-ms`文件

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24054是一个Windows NTLM哈希泄露欺骗漏洞，允许未经授权的攻击者通过网络执行欺骗。该漏洞涉及对Windows NTLM中文件名或路径的外部控制。

**有效性：**
提供的PoC代码有效，利用了`.library-ms`文件来触发NTLM哈希泄露。攻击者创建一个恶意的`.library-ms`文件，其中包含指向攻击者控制的UNC路径。当受害者访问此文件时，Windows会尝试通过NTLM身份验证访问该UNC路径，从而将受害者的NTLM哈希发送到攻击者。

**投毒风险：**
该仓库的投毒风险较低，约为5%。`exploit.py`脚本本身功能明确，仅用于生成`.library-ms`文件。但是，需要注意以下几点：
*   `README.md` 中提供的下载链接存在潜在风险，虽然当前指向的是github release页面，但将来可能会被篡改为指向恶意文件。强烈建议用户自行从github release页面下载，并仔细检查文件的哈希值。
*   此 PoC 脚本可能被滥用，攻击者可能将恶意 `.library-ms` 文件伪装成正常文件，诱骗用户打开，从而窃取 NTLM 哈希。
*   作者可能在其他地方隐藏了恶意代码。鉴于代码量较小且功能较为简单，故认定投毒概率较低。

**利用方式：**
1.  攻击者设置一个SMB服务器来捕获NTLM哈希。
2.  攻击者使用`exploit.py`脚本创建一个恶意的`.library-ms`文件，将`ATTACKER_IP`设置为攻击者的IP地址。
3.  攻击者诱骗受害者打开该`.library-ms`文件，例如通过社交工程或将其嵌入到电子邮件中。
4.  当受害者打开该文件时，Windows会尝试连接到攻击者的SMB服务器进行身份验证。
5.  攻击者的SMB服务器捕获受害者的NTLM哈希。
6.  攻击者可以使用捕获的NTLM哈希进行进一步的攻击，例如Pass-the-Hash。

**项目地址:** [yum1ra/CVE-2025-24054_CVE-2025-24071-PoC](https://github.com/yum1ra/CVE-2025-24054_CVE-2025-24071-PoC)

**漏洞详情:** [CVE-2025-24054](https://nvd.nist.gov/vuln/detail/CVE-2025-24054)