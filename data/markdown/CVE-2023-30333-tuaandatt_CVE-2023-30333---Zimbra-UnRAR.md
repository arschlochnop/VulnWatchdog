## CVE-2023-30333 - PerfreeBlog 任意文件上传

**漏洞编号:** CVE-2023-30333

**漏洞类型:** 任意文件上传

**影响应用:** PerfreeBlog

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 3.1.2

**利用条件:** 需要访问 PerfreeBlog 后台管理界面

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2023-30333 漏洞存在于 PerfreeBlog v3.1.2 的 `/admin/ThemeController.java` 组件中，是一个任意文件上传漏洞。攻击者可以通过上传恶意文件（例如包含恶意代码的 JSP 文件）到服务器，从而实现远程代码执行。根据提供的漏洞信息和搜索结果，该漏洞利用的有效性较高。漏洞库信息明确指出该漏洞允许攻击者通过精心构造的文件执行任意代码。搜索结果中也多次提到了这个漏洞的存在和危害。提供的POC代码（虽然是参考CVE-2022-30333，即UnRAR漏洞的利用方式），展示了如何通过构造包含恶意路径的压缩文件（rar 文件），并利用 Amavis 组件进行解压，从而将 JSP shell 写入到 Zimbra 服务器的 public 目录下，最终实现远程代码执行。虽然 POC 代码是关于 Zimbra + UnRAR 的，但是逻辑是类似的，都是利用路径穿越进行任意文件写入。由于提供的代码只是演示了如何构造 payload 和利用 metasploit 进行攻击，并没有发现作者隐藏的恶意代码，因此投毒风险较低。利用方式是通过上传恶意文件到存在漏洞的 `/admin/ThemeController.java` 组件，服务器未正确校验文件类型和内容，导致恶意文件被上传并执行，最终控制服务器。尽管POC本身不是直接针对PerfreeBlog的，但它展示了利用路径穿越漏洞进行任意文件写入的通用技术，这种技术可以被应用于PerfreeBlog CVE-2023-30333，只需要将payload改成针对PerfreeBlog的webshell即可。

**项目地址:** [tuaandatt/CVE-2023-30333---Zimbra-UnRAR](https://github.com/tuaandatt/CVE-2023-30333---Zimbra-UnRAR)

**漏洞详情:** [CVE-2023-30333](https://nvd.nist.gov/vuln/detail/CVE-2023-30333)