## CVE-2025-24963 - Vitest Browser Mode - Local File Read

**漏洞编号:** CVE-2025-24963

**漏洞类型:** 目录遍历 (Path Traversal)

**影响应用:** Vitest

**危害等级:** 中危，可能导致敏感信息泄露

**影响版本:** 2.0.4 to 2.1.8, 3.0.0 to 3.0.3

**利用条件:** 需要Vitest配置 browser.api.host: true 且服务器暴露在网络上

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-24963 存在于 Vitest 的浏览器模式中，由于 `__screenshot-error` 处理程序对路径的限制不当，攻击者可以通过构造恶意的 HTTP 请求读取服务器上的任意文件。利用条件是 `browser.api.host: true` 允许外部访问服务器。提供的 POC 代码包含一个 Dockerfile 和相关配置文件，用于搭建一个存在漏洞的 Vitest 环境，并通过设置 `browser.api.host: true` 来暴露漏洞。攻击者可以通过发送带有目录遍历payload的请求到 `__screenshot-error` 接口来读取目标文件。漏洞利用代码本身没有发现明显的恶意投毒行为，但需要注意的是，运行任何从网络上获取的代码都存在潜在风险，代码作者可能在其他地方加入恶意代码，例如通过修改测试用例植入后门，虽然从代码中没有直接发现，但这是一种潜在的风险，故判定投毒风险为5%。

**漏洞利用方式：**

1.  **环境准备：** 搭建存在漏洞的 Vitest 环境，并配置 `browser.api.host: true`，将 Vitest 的测试服务器暴露到网络。
2.  **构造恶意请求：** 构造包含目录遍历 payload 的 HTTP 请求，发送到 `__screenshot-error` 接口。例如，可以使用 `../../../etc/passwd` 来读取系统敏感文件。
3.  **读取文件：** 服务器返回请求的文件内容，攻击者获取敏感信息。

**项目地址:** [0xdeviner/CVE-2025-24963](https://github.com/0xdeviner/CVE-2025-24963)

**漏洞详情:** [CVE-2025-24963](https://nvd.nist.gov/vuln/detail/CVE-2025-24963)