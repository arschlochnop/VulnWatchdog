## CVE-2024-45519-Zimbra-远程代码执行

**漏洞编号:** CVE-2024-45519

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 严重，允许未授权用户执行任意命令

**影响版本:** < 8.8.15 Patch 46, < 9.0.0 Patch 41, < 10.0.9, < 10.1.1

**利用条件:** 目标Zimbra服务器开启了postjournal服务，且端口对外开放

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-45519 是 Zimbra Collaboration Suite (ZCS) 中 postjournal 服务存在的一个命令注入漏洞。该漏洞允许未经身份验证的攻击者通过构造包含恶意命令的电子邮件，利用SMTP协议发送给目标服务器。目标服务器在处理该邮件时，会将恶意命令注入到操作系统中执行，从而实现远程代码执行。

**有效性:** 根据漏洞信息、搜索结果和提供的POC代码，此漏洞利用的有效性较高。漏洞库信息显示该漏洞允许未授权用户执行命令，搜索引擎结果表明该漏洞已被积极利用。提供的POC代码尝试通过构造包含命令的收件人邮箱地址来触发漏洞。

**投毒风险:** 分析POC代码，该脚本主要功能是利用SMTP协议发送包含恶意命令的邮件来触发目标系统的漏洞。该脚本依赖 `interactsh` 服务来验证漏洞是否成功利用，如果收到了回调就证明命令执行成功，`interactsh` 是一个用于带外漏洞检测的工具，本身不具备恶意代码投放能力。因此，在当前提供的代码中，不存在明显的投毒代码。投毒风险为0%。

**利用方式:**
1.  攻击者构造包含恶意命令的电子邮件地址（例如，`"admin$(' + command + ')"@mail.test.com`），其中`command`为要执行的操作系统命令。
2.  使用SMTP协议将该邮件发送到目标Zimbra服务器。
3.  Zimbra服务器的postjournal服务在处理邮件时，由于未正确过滤或转义特殊字符，会将恶意命令注入到操作系统中。
4.  操作系统执行恶意命令，从而导致远程代码执行。
5.  POC 使用 `interactsh` 验证是否利用成功。构造curl和wget命令，回连 `interactsh` 服务器，从而验证命令执行成功。

**项目地址:** [sec13b/CVE-2024-45519](https://github.com/sec13b/CVE-2024-45519)

**漏洞详情:** [CVE-2024-45519](https://nvd.nist.gov/vuln/detail/CVE-2024-45519)