## CVE-2025-3102 - SureTriggers WordPress Plugin Authentication Bypass

**漏洞编号:** CVE-2025-3102

**漏洞类型:** 身份验证绕过

**影响应用:** SureTriggers WordPress Plugin (Formerly OttoKit: All-in-One Automation Platform)

**危害等级:** 高危，允许未经身份验证的攻击者创建管理员账户，可能导致完全站点控制

**影响版本:** <= 1.0.78

**利用条件:** 插件已安装和激活，但未配置 API 密钥

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-3102 存在于 SureTriggers WordPress 插件中，由于 `autheticate_user` 函数中缺少对 'secret_key' 值的空值检查，导致身份验证绕过。攻击者可以利用此漏洞，通过发送特制的请求到 `/wp-json/sure-triggers/v1/automation/action` 端点，创建一个新的管理员账户。提供的 POC 代码通过以下步骤利用此漏洞：

1.  **版本检测：** (可选)尝试从 `readme.txt` 文件中获取插件版本，并判断版本是否在受影响范围内（<= 1.0.78）。即使无法获取版本，默认也会继续尝试利用。
2.  **构建请求头：**  设置 `User-Agent` 和 `Content-Type`，`st_authorization` 留空，绕过身份验证。
3.  **构建 Payload：**  创建一个包含要注册的管理员用户电子邮件、用户名和密码的 JSON payload。
4.  **发送请求：**  向 `/wp-json/sure-triggers/v1/automation/action` 端点发送 POST 请求，payload 中包含新管理员的详细信息。
5.  **处理响应：**  检查响应是否成功，如果成功，则输出新创建的管理员账户的凭据。

由于POC代码只做了利用漏洞的逻辑, 没有发现任何的后门代码逻辑,因此，投毒风险评估为0%。

**利用方式总结：**

未经身份验证的攻击者通过向 WordPress 站点的 `/wp-json/sure-triggers/v1/automation/action` 发送包含用户注册信息的特制 POST 请求，即可绕过身份验证，创建一个新的管理员账户。缺少对 secret_key 的验证是漏洞的根本原因。

**项目地址:** [rhz0d/CVE-2025-3102](https://github.com/rhz0d/CVE-2025-3102)

**漏洞详情:** [CVE-2025-3102](https://nvd.nist.gov/vuln/detail/CVE-2025-3102)