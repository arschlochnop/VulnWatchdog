## CVE-2016-2098 - Ruby on Rails 远程代码执行

**漏洞编号:** CVE-2016-2098

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Ruby on Rails (Action Pack)

**危害等级:** 高危，可能导致服务器完全控制

**影响版本:** 3.2.22.2之前, 4.x版本在4.1.14.2之前, 4.2.x版本在4.2.5.2之前

**利用条件:** 应用程序必须允许通过`render`方法处理用户提供的输入。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2016-2098 是一个 Ruby on Rails Action Pack 中的远程代码执行漏洞。攻击者可以通过向`render`方法提供恶意构造的输入来执行任意 Ruby 代码。  根据漏洞描述，漏洞根源在于Rails的`render`方法对用户输入的不当处理。POC 利用方式是通过`view[inline]`参数传递 Ruby 代码，该代码会被服务器执行。具体来说，POC 使用了 `<%= %x('[CMD]') %>` 这样的 Ruby 代码结构，其中 `[CMD]` 会被替换成想要执行的系统命令。例如，`<%= %x('whoami') %>` 会执行 `whoami` 命令，并将其输出显示在页面上。  利用步骤： 1. 确定目标 Rails 应用使用的 Rails 版本在受影响范围内。 2. 构造包含恶意 Ruby 代码的 URL，例如 `http://example.com/?view[inline]=<%= %x('whoami') %>` （需要 URL 编码）。 3. 将构造的 URL 发送到目标服务器。 4. 如果服务器存在漏洞，则会执行恶意代码，并将结果返回给攻击者。  投毒风险较低，主要因为 POC 代码的功能明确，目的是执行用户指定的命令。虽然攻击者可以利用该漏洞执行任何命令，但提供的 POC 本身不包含任何隐藏的恶意功能。 投毒的可能来自于下载后使用者更改后门,但原始版本后门概率极低。

**项目地址:** [j4k0m/CVE-2016-2098](https://github.com/j4k0m/CVE-2016-2098)

**漏洞详情:** [CVE-2016-2098](https://nvd.nist.gov/vuln/detail/CVE-2016-2098)