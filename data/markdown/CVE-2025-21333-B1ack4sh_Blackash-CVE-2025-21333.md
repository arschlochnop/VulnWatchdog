## CVE-2025-21333 Windows Hyper-V NT Kernel Integration VSP 提权漏洞

**漏洞编号:** CVE-2025-21333

**漏洞类型:** 提权漏洞/堆溢出

**影响应用:** Windows Hyper-V

**危害等级:** 高危，可能导致虚拟机逃逸，主机权限获取

**影响版本:** 受影响的Windows版本 (见漏洞库信息)

**利用条件:** 需要Guest虚拟机权限

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-21333 是一个 Windows Hyper-V NT Kernel Integration VSP (虚拟机服务提供者) 中的提权漏洞，本质是堆溢出。攻击者（虚拟机内的用户）可以利用此漏洞，通过特制的请求导致在主机操作系统内核中发生堆缓冲区溢出，从而获得主机操作系统的管理员权限。

**有效性：**

根据搜索引擎结果，此漏洞已经被公开披露，并且存在公开可用的PoC（例如 GitHub上的`MrAle98/CVE-2025-21333-POC`仓库），表明该漏洞的利用已经得到验证。 漏洞库信息也表明CISA ADP已经将此漏洞添加到已知被利用漏洞列表中，进一步证明了其有效性。

提供的漏洞利用代码`/tmp/32315364bfebb19c9bcece1aca1942c9/README.md` 仅包含CVE编号的信息，本身并没有可执行的利用代码。但是，结合搜索引擎结果，可以找到其他存储库中提供的PoC 代码。

**投毒风险：**

由于提供的代码只是一个包含CVE编号的`README.md`文件，因此直接分析该文件进行投毒判断没有意义。真正的PoC代码位于其他存储库。但是，在实际利用PoC的过程中，需要仔细审查代码，因为PoC代码可能包含恶意修改。 

假设用户下载并执行了某个声称是CVE-2025-21333的PoC代码。 评估投毒风险。鉴于漏洞利用开发和安全研究的复杂性，有以下可能性：

*   **有意后门：** 某些代码作者可能会故意在PoC中添加后门，以便进一步攻击或控制目标系统。风险较高，因为内核漏洞利用通常需要精心的内存操作，很容易隐藏恶意代码。
*   **代码质量问题：** PoC代码可能未经充分测试或包含错误，导致系统崩溃或不稳定。这虽然不是直接的投毒，但也可能对系统造成损害。
*   **依赖项风险：** PoC可能依赖于外部库或组件，这些库或组件本身可能存在漏洞或恶意代码。

考虑到这些因素，初步估计投毒风险为10%。更详细的代码审计可以提供更准确的风险评估。

**利用方式：**

1.  **触发漏洞：** 虚拟机内的攻击者，通过构造恶意的请求发送给Hyper-V主机。
2.  **堆溢出：** 恶意的请求会触发 Hyper-V NT Kernel Integration VSP 组件中的堆缓冲区溢出。
3.  **控制流劫持：** 利用堆溢出覆盖关键内核数据结构，例如函数指针，从而控制内核执行流。
4.  **权限提升：** 执行恶意代码，例如调用`PsLookupProcessByProcessId`和`SeAssignPrivileges`等函数，以提升虚拟机内的进程权限到 SYSTEM。
5.  **虚拟机逃逸：** 利用获得的 SYSTEM 权限，攻击者可以执行虚拟机逃逸操作，例如访问Hyper-V主机的文件系统，甚至控制整个主机。


**项目地址:** [B1ack4sh/Blackash-CVE-2025-21333](https://github.com/B1ack4sh/Blackash-CVE-2025-21333)

**漏洞详情:** [CVE-2025-21333](https://nvd.nist.gov/vuln/detail/CVE-2025-21333)