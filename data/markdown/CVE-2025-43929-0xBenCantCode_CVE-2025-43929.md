## CVE-2025-43929-kitty-本地文件执行

**漏洞编号:** CVE-2025-43929

**漏洞类型:** 本地文件执行

**影响应用:** kitty

**危害等级:** 中危，用户交互后可能导致本地命令执行，敏感信息泄露

**影响版本:** < 0.41.0

**利用条件:** 需要用户打开包含恶意链接的文档，且kitty版本低于0.41.0

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

根据漏洞库信息，CVE-2025-43929 存在于 kitty 0.41.0 之前的版本中，由于 `open_actions.py` 在运行本地可执行文件之前，没有进行用户确认，导致当用户在 KDE ghostwriter 等软件中打开包含恶意链接的文档时，可以执行本地文件。

**有效性分析：**
提供的POC代码包含以下文件：
*   `README.md`：漏洞描述信息，包括CVE编号，CVSS评分，CWE编号，以及漏洞简述和Github链接。
*   `CVE-2025-43929-POC/test`：一个bash脚本，用于执行 `whoami` 命令，并使用 `curl` 命令向 `httpbin.org/get` 发送请求，用于验证漏洞是否成功利用以及进行数据外泄。
*   `CVE-2025-43929-POC/test.md`：一个 markdown 文档，包含一个指向 `test` 脚本的链接。

攻击者可以创建一个包含指向恶意脚本的链接的 markdown 文档，当用户使用受影响的 kitty 版本打开该文档时，kitty 会自动执行该脚本。
该POC代码是有效的。

**投毒风险分析：**
查看`test`脚本，发现其主要功能是执行`whoami`命令（用于获取当前用户名），以及向`httpbin.org/get`发送网络请求（用于测试网络连通性以及可能的数据外泄）。虽然存在通过`curl`外泄信息的可能性，但当前脚本仅仅是演示，如果想要投毒，可以在脚本中加入恶意代码，例如下载并执行恶意程序，或者窃取用户敏感信息。当前`test`脚本的行为相对无害，但存在被替换成恶意脚本的风险。投毒风险评估为10%。

**利用方式：**
1.  攻击者创建一个包含指向恶意脚本的链接的 markdown 文档（例如 `test.md`）。
2.  攻击者将该 markdown 文档发送给受害者。
3.  受害者使用受影响的 kitty 版本打开该文档。
4.  kitty 自动执行 markdown 文档中链接指向的恶意脚本（例如 `test`）。
5.  恶意脚本执行，攻击者可以控制受害者的系统。

**项目地址:** [0xBenCantCode/CVE-2025-43929](https://github.com/0xBenCantCode/CVE-2025-43929)

**漏洞详情:** [CVE-2025-43929](https://nvd.nist.gov/vuln/detail/CVE-2025-43929)