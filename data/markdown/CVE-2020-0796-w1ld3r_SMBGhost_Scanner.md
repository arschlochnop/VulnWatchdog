## CVE-2020-0796 (SMBGhost)

**漏洞编号:** CVE-2020-0796

**漏洞类型:** 远程代码执行

**影响应用:** Microsoft Windows SMBv3

**危害等级:** 高危，可导致远程代码执行，蠕虫式传播

**影响版本:** Windows 10 Version 1903, 1909; Windows Server, version 1903, 1909 (Server Core installation)

**利用条件:** 目标系统开启SMBv3服务，攻击者需要与目标系统建立SMB连接。

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2020-0796，又名SMBGhost，是Microsoft Server Message Block 3.1.1 (SMBv3) 协议处理特定请求时存在远程代码执行漏洞。该漏洞是由于SMBv3压缩功能中对数据包长度处理不当导致的缓冲区溢出漏洞。攻击者可以利用此漏洞在目标系统上执行任意代码。

**有效性评估：**
根据漏洞库信息和搜索结果，CVE-2020-0796是一个严重的远程代码执行漏洞，存在公开可用的PoC代码。多个来源证实了该漏洞的存在和利用的可能性。

**投毒风险评估：**
提供的漏洞利用代码片段仅为GPL许可证，无法直接判断是否存在投毒代码。根据已知的公开PoC，攻击者需要构造恶意的SMB数据包来触发漏洞，通过分析网络流量判断是否存在后门代码。
此漏洞利用代码看起来只是许可证文件，不包含任何可执行的代码，因此可以忽略恶意代码风险。

**漏洞利用方式：**
1.  攻击者利用SMBv3协议发送特制的压缩数据包到目标服务器。
2.  目标服务器在处理该数据包时，由于长度验证不足，导致缓冲区溢出。
3.  攻击者利用缓冲区溢出，覆盖内存中的重要数据，例如函数返回地址。
4.  攻击者将返回地址修改为指向恶意代码的地址，从而控制程序执行流程。
5.  目标系统执行攻击者提供的恶意代码，实现远程代码执行。

**项目地址:** [w1ld3r/SMBGhost_Scanner](https://github.com/w1ld3r/SMBGhost_Scanner)

**漏洞详情:** [CVE-2020-0796](https://nvd.nist.gov/vuln/detail/CVE-2020-0796)