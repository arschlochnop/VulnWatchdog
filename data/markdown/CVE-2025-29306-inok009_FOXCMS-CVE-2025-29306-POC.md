## CVE-2025-29306-FoxCMS-远程代码执行

**漏洞编号:** CVE-2025-29306

**漏洞类型:** 远程代码执行

**影响应用:** FoxCMS

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** 1.2.5

**利用条件:** 目标URL需要存在`/images/index.html?id=`参数

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-29306是FoxCMS v1.2.5中的一个远程代码执行漏洞。攻击者可以通过构造恶意的`id`参数，利用`${@print()}`表达式注入PHP代码，从而在服务器上执行任意命令。

**有效性分析：**

根据漏洞信息和提供的PoC代码，该漏洞的利用方式较为直接有效。PoC代码通过生成一系列包含PHP函数的payload，并将其作为`id`参数的值发送到目标URL。如果目标系统存在漏洞，PHP代码将被执行，攻击者可以获取服务器信息、执行系统命令等。

**投毒风险分析：**

PoC代码本身主要功能是测试目标是否存在漏洞，并通过一系列payload尝试执行命令。虽然代码中包含写入文件的操作，例如`file_put_contents('shell.php', '<?php system($_GET["cmd"]); ?>')`，但这些操作都是为了验证漏洞而设，目的是在目标机器上创建一个webshell。

作者隐藏的投毒代码风险较低，约为5%。风险主要在于：

*   **恶意payload修改：** 攻击者可能在payload列表中添加更具破坏性的payload，例如删除关键文件、篡改数据等。但提供的payload列表相对通用，直接造成严重破坏的可能性较低。
*   **后门植入：** 攻击者可能修改脚本，在成功利用漏洞后植入持久性后门，以便长期控制目标系统。但从目前的代码来看，没有发现明显的后门植入行为。

**利用方式：**

1.  攻击者构造包含恶意PHP代码的`id`参数，例如`${@print(phpinfo())}`或`${@print(system('id'))}`。
2.  攻击者将构造的URL发送到目标服务器。
3.  如果目标服务器存在漏洞，PHP代码将被执行。
4.  攻击者通过执行任意PHP代码，可以获取服务器信息、执行系统命令、读取敏感文件等，甚至完全控制目标系统。

**项目地址:** [inok009/FOXCMS-CVE-2025-29306-POC](https://github.com/inok009/FOXCMS-CVE-2025-29306-POC)

**漏洞详情:** [CVE-2025-29306](https://nvd.nist.gov/vuln/detail/CVE-2025-29306)