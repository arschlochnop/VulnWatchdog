## CVE-2019-15107-Webmin-命令注入

**漏洞编号:** CVE-2019-15107

**漏洞类型:** 命令注入

**影响应用:** Webmin

**危害等级:** 高危，未经身份验证的远程代码执行

**影响版本:** <= 1.920

**利用条件:** 需要目标Webmin服务开放网络访问

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2019-15107存在于Webmin <= 1.920版本中。`password_change.cgi` 脚本中的 `old` 参数存在命令注入漏洞。未经身份验证的攻击者可以通过向该脚本发送特制的POST请求，在服务器上执行任意命令。

**有效性：**
根据漏洞库信息、搜索结果和提供的漏洞利用代码，该漏洞是有效的，并且存在公开可用的利用代码。

**投毒风险：**
提供的`exploit.py`脚本首先通过GET请求获取Webmin版本，然后构造POST请求，在`old`参数中注入操作系统命令。代码中没有发现明显的恶意投毒代码。但不能排除利用过程中目标服务器被植入后门的风险。此脚本的主要功能是利用漏洞，而非进行破坏或植入恶意代码。README.md只是检测脚本说明。所以投毒风险评估为0%。

**利用方式：**
1.  **版本检测：** 脚本首先发送GET请求到Webmin服务器，从响应头中提取Webmin版本信息。
2.  **漏洞验证：** 如果Webmin版本小于等于1.920，脚本构造一个包含恶意命令的POST请求发送到`/password_change.cgi`，其中命令被注入到`old`参数中。
3.  **命令执行：** Webmin服务器执行`old`参数中的命令。
4.  **结果获取：**  脚本通过检查响应状态码和响应内容来判断命令是否成功执行，并提取命令执行的结果。

攻击者可以利用此漏洞在Webmin服务器上执行任意命令，从而完全控制服务器。

**项目地址:** [CyberTuz/CVE-2019-15107_detection](https://github.com/CyberTuz/CVE-2019-15107_detection)

**漏洞详情:** [CVE-2019-15107](https://nvd.nist.gov/vuln/detail/CVE-2019-15107)