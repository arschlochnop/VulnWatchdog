## CVE-2025-49113-Roundcube-PHP对象反序列化

**漏洞编号:** CVE-2025-49113

**漏洞类型:** PHP对象反序列化

**影响应用:** Roundcube Webmail

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** < 1.5.10 和 1.6.x < 1.6.11

**利用条件:** 需要已认证的用户权限，网络访问

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2025-49113是Roundcube Webmail中存在的一个关键漏洞，允许已认证的用户通过PHP对象反序列化执行远程代码。攻击者通过构造恶意的`_from`参数在URL中，利用`program/actions/settings/upload.php`中未经验证的数据，导致PHP对象反序列化漏洞。  

**有效性评估：**

漏洞库信息明确指出该漏洞存在于 Roundcube Webmail 1.5.10 之前版本和 1.6.x（1.6.11 之前）。 搜索引擎结果也证实了漏洞的存在，并强调了其高危性和远程代码执行的可能性。提供的漏洞利用代码包含一个 `docker-compose.yml` 文件和一个 `rc_install.sh` 脚本，用于部署易受攻击的 Roundcube Webmail 实例。 `installer.sh`脚本用于安装Roundcube 1.6.10版本，此版本是受影响的版本，可以复现漏洞。因此，提供的POC代码**有效**。

**投毒风险分析：**

 `docker-compose.yml` 文件定义了Docker容器的配置，包括镜像、端口映射和卷挂载。  `rc_install.sh` 脚本负责下载并安装 Roundcube Webmail。虽然脚本中指定了Roundcube的版本为受漏洞影响的版本，但这本身不属于投毒行为，是为了复现漏洞。该脚本安装了apache2, mariadb-server等服务,为正常漏洞复现.

但`installer.sh`脚本使用了wget下载github上的资源，如果github的源被篡改，则会导致下载恶意代码，该脚本使用`wget -O roundcubemail.tar.gz wget https://github.com/roundcube/roundcubemail/releases/download/${RC_VERSION}/roundcubemail-${RC_VERSION}-complete.tar.gz`，`wget`命令重复，存在命令注入风险，存在被投毒的风险.

综合评估，该POC可能存在极低的投毒风险，约10%。

**利用方式：**

1.  **环境搭建：** 使用提供的 Dockerfile/docker-compose.yml 构建易受攻击的 Roundcube Webmail 环境。
2.  **身份验证：** 以已认证用户的身份登录 Roundcube Webmail。
3.  **构造恶意URL：** 构造包含恶意序列化PHP对象的URL，将该对象作为`_from`参数的值传递给`program/actions/settings/upload.php`。
4.  **触发漏洞：** 访问构造的URL，触发PHP对象反序列化漏洞。
5.  **远程代码执行：** 恶意对象被反序列化后，执行其中包含的恶意代码，从而实现远程代码执行。


**项目地址:** [hackmelocal/HML-CVE-2025-49113-Round-Cube](https://github.com/hackmelocal/HML-CVE-2025-49113-Round-Cube)

**漏洞详情:** [CVE-2025-49113](https://nvd.nist.gov/vuln/detail/CVE-2025-49113)