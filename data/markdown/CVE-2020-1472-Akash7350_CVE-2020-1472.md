## CVE-2020-1472-Zerologon-特权提升

**漏洞编号:** CVE-2020-1472

**漏洞类型:** 特权提升

**影响应用:** Windows Server

**危害等级:** 高危，可能导致域控制器的完全控制

**影响版本:** 受影响的Windows Server版本，详见漏洞库信息

**利用条件:** 需要与目标域控制器建立网络连接

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2020-1472，又名Zerologon，是一个影响Microsoft Windows Netlogon Remote Protocol (MS-NRPC) 的特权提升漏洞。未经身份验证的攻击者可以通过与域控制器建立脆弱的Netlogon安全通道连接来利用此漏洞。成功利用该漏洞可能允许攻击者冒充域控制器，并最终获得域管理员权限，从而完全控制整个域。

**有效性：**
根据漏洞信息、搜索结果和提供的漏洞利用代码，此POC代码是有效的。搜索结果中多个链接指向了关于该漏洞的分析和利用文章，证明了该漏洞的可利用性。POC代码描述也表明，它能够重置域控制器的帐户密码为空字符串，从而实现权限提升。

**投毒风险：**
评估POC代码的投毒风险较低，大约为10%。代码主要逻辑集中在利用Netlogon协议的加密缺陷，通过重复的认证尝试来绕过身份验证。虽然存在一定的风险，例如代码的维护者可能在未来版本中引入恶意代码，或者安装过程中依赖的第三方库存在安全问题，但从当前提供的代码来看，直接包含恶意、后门代码的可能性不大。该代码更侧重于漏洞利用的验证和概念证明。

**利用方式：**
1.  **建立连接：** 攻击者使用MS-NRPC协议与目标域控制器建立网络连接。
2.  **零化凭据：** 攻击者发送一个包含全零凭据的Netlogon身份验证请求。
3.  **重复尝试：** 由于协议的加密缺陷，攻击者重复发送此请求多次。每次尝试都有可能成功绕过身份验证。
4.  **密码重置：** 成功绕过身份验证后，攻击者将域控制器的帐户密码重置为空字符串。
5.  **权限提升：** 此时，攻击者可以利用空密码来冒充域控制器并获取域管理员权限。

需要注意的是，成功利用此漏洞需要目标域控制器未安装相应的安全补丁。此外，利用该漏洞可能会导致域环境不稳定甚至崩溃，因此在生产环境中进行测试需要谨慎。

**项目地址:** [Akash7350/CVE-2020-1472](https://github.com/Akash7350/CVE-2020-1472)

**漏洞详情:** [CVE-2020-1472](https://nvd.nist.gov/vuln/detail/CVE-2020-1472)