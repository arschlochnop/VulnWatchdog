## CVE-2022-32532-Apache Shiro 身份验证绕过

**漏洞编号:** CVE-2022-32532

**漏洞类型:** 身份验证绕过

**影响应用:** Apache Shiro

**危害等级:** 高危，可能导致未授权访问

**影响版本:** Before 1.9.1

**利用条件:** 应用程序使用 RegExPatternMatcher 且正则表达式中包含`.`

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2022-32532 漏洞存在于 Apache Shiro 1.9.1 之前的版本中。当应用程序使用 `RegExPatternMatcher` 并且在正则表达式中使用了 `.` 时，可能导致身份验证绕过。 

**有效性：**

提供的 POC 代码展示了该漏洞的一种利用方式。在特定配置下，可以通过在 URL 中插入 `%0a` 字符来绕过 Shiro 的身份验证。

**投毒风险：**

分析提供的代码，未发现明显的投毒代码。该仓库主要用于演示漏洞利用，代码功能相对简单，没有发现恶意行为或隐藏后门。

**利用方式：**

1.  应用程序必须使用 Apache Shiro 且版本低于 1.9.1。
2.  Shiro 配置中使用了 `RegExPatternMatcher` 来进行请求匹配。
3.  用于匹配的正则表达式中包含了 `.` 字符。
4.  攻击者可以通过在请求的 URL 中插入换行符 `%0a` 来绕过身份验证。

此漏洞的根本原因是 `RegExPatternMatcher` 对包含换行符的 URL 处理不当，导致匹配失败，从而绕过了身份验证。

**项目地址:** [Lay0us/CVE-2022-32532](https://github.com/Lay0us/CVE-2022-32532)

**漏洞详情:** [CVE-2022-32532](https://nvd.nist.gov/vuln/detail/CVE-2022-32532)