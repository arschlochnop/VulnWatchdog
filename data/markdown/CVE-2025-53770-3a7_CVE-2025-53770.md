## CVE-2025-53770-Microsoft SharePoint Server 远程代码执行漏洞

**漏洞编号:** CVE-2025-53770

**漏洞类型:** 反序列化漏洞

**影响应用:** Microsoft SharePoint Server

**危害等级:** 高危，未经授权的攻击者可以通过网络执行任意代码，导致完全系统入侵。

**影响版本:** SharePoint Server 2016, SharePoint Server 2019, SharePoint Server Subscription Edition (< 16.0.18526.20508)

**利用条件:** 需要目标服务器存在漏洞，并且攻击者可以访问目标服务器的ToolPane.aspx页面。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞是由于 SharePoint Server 在处理不可信数据反序列化时存在缺陷，允许未经身份验证的攻击者远程执行代码。利用方式是向 `/_layouts/15/ToolPane.aspx` 页面发送包含恶意序列化数据的 POST 请求。  

**有效性：**

提供的 POC 代码 `CVE-2025-53770-Scanner.py` 通过发送精心构造的 POST 请求到 `ToolPane.aspx` 页面，利用 SharePoint Server 的反序列化漏洞。如果目标服务器存在漏洞，扫描器会识别到并报告。根据搜索引擎结果，此漏洞正在被积极利用，因此POC的有效性较高。

**投毒风险：**

代码主要功能是利用漏洞进行扫描，用于判断目标系统是否存在漏洞。虽然代码本身主要是为了验证漏洞是否存在，但是仍存在轻微的投毒风险，例如:

*   **依赖项风险：** 代码依赖于 `requests`, `re`, `base64`, `gzip`, `urllib3` 库，如果恶意攻击者篡改了依赖库，可能会引入恶意代码。
*   **结果误判：** 虽然代码已经尽可能精确的识别漏洞，但是任然存在误判的风险，例如将未授权的服务器标记为存在漏洞，从而导致不必要的恐慌。
*   **信息泄露风险：** 扫描器本身会发送HTTP请求，可能会在日志中留下痕迹，为攻击者提供一些信息。

**利用方式：**

1.  攻击者构造包含恶意序列化数据的 SOAP 包。
2.  将构造的 SOAP 包作为 POST 请求的数据发送到 `/_layouts/15/ToolPane.aspx` 页面。
3.  SharePoint Server 反序列化 SOAP 包中的数据。
4.  由于数据包含恶意代码，反序列化过程会导致代码执行。

总的来说，此 POC 的主要目的是验证漏洞的存在，而非直接进行攻击。因此，投毒风险相对较低，约为10%。 但需要注意使用环境和依赖项的安全性。

**项目地址:** [3a7/CVE-2025-53770](https://github.com/3a7/CVE-2025-53770)

**漏洞详情:** [CVE-2025-53770](https://nvd.nist.gov/vuln/detail/CVE-2025-53770)