## CVE-2025-48384-Git-任意代码执行

**漏洞编号:** CVE-2025-48384

**漏洞类型:** 任意代码执行

**影响应用:** Git

**危害等级:** 高危，可能导致远程代码执行和系统控制

**影响版本:** < 2.43.7, >= 2.44.0-rc0, < 2.44.4, >= 2.45.0-rc0, < 2.45.4, >= 2.46.0-rc0, < 2.46.4, >= 2.47.0-rc0, < 2.47.3, >= 2.48.0-rc0, < 2.48.2, >= 2.49.0-rc0, < 2.49.1, >= 2.50.0-rc0, < 2.50.1

**利用条件:** 需要用户交互，克隆包含恶意配置的仓库

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-48384是Git中的一个高危漏洞，源于Git在处理配置文件时对回车符（CR）处理不当，允许通过精心构造的仓库配置执行任意代码。

**有效性：**
根据提供的漏洞信息和搜索结果，该漏洞允许攻击者通过在 submodule 路径中注入包含回车符的恶意配置，导致 submodule 被检出到错误的位置。如果该错误位置存在指向 submodule hooks 目录的符号链接，且 submodule 包含可执行的 post-checkout 钩子，则该钩子会被意外执行，从而实现任意代码执行。

提供的POC代码是一个简单的 post-checkout 钩子脚本，它会在检出后显示一个banner。这个脚本本身没有问题，证明了漏洞利用的可行性。漏洞利用的核心在于精心构造包含恶意回车符的仓库配置和符号链接。

**投毒风险：**
提供的POC代码（/tmp/77b6aa1852eafe71ccbdb092fa3f1fb6/post-checkout）本身只是一个banner打印脚本，其目的是验证漏洞利用后可以执行任意代码，本身不具备投毒行为。但是，需要注意的是，如果攻击者控制了整个包含该POC代码的Git仓库，那么他们可以在仓库的其他位置添加恶意代码，从而实现投毒。基于当前信息，POC本身不具备投毒性，投毒的可能性为0%。

**利用方式：**
1.  攻击者创建一个恶意的Git仓库，其中包含一个带有回车符的submodule路径的.gitmodules文件。例如，submodule的路径可能是 "submodule\r"。
2.  攻击者创建一个符号链接，将 "submodule" 指向".git/modules/<submodule-name>/hooks"目录，这个目录包含git hooks。
3.  攻击者在 submodule 中添加一个 post-checkout 钩子脚本，该脚本包含要执行的恶意代码。
4.  攻击者将这个恶意仓库分享给受害者。
5.  受害者克隆这个仓库。由于Git对回车符处理不当，submodule会被检出到错误的位置（即符号链接指向的hooks目录）。
6.  当 submodule 完成检出时，post-checkout 钩子脚本会被执行，从而导致恶意代码执行。

**项目地址:** [fluoworite/CVE-2025-48384-sub](https://github.com/fluoworite/CVE-2025-48384-sub)

**漏洞详情:** [CVE-2025-48384](https://nvd.nist.gov/vuln/detail/CVE-2025-48384)