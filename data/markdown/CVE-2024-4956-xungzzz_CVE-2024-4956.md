## CVE-2024-4956-Nexus Repository 3-Path Traversal

**漏洞编号:** CVE-2024-4956

**漏洞类型:** Path Traversal

**影响应用:** Nexus Repository 3

**危害等级:** 高危，可能导致敏感文件泄露

**影响版本:** <= 3.68.0

**利用条件:** 需要网络访问目标Nexus Repository 3服务

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-4956是Sonatype Nexus Repository 3中的一个路径遍历漏洞，未经身份验证的攻击者可以通过构造恶意URL读取服务器上的任意文件。

**有效性:**
根据漏洞库信息、搜索引擎结果和提供的PoC代码，该漏洞利用是有效的。PoC代码尝试通过路径遍历读取`/etc/passwd`文件，如果成功读取到包含"root:"的响应，则表明漏洞存在。

**投毒风险:**
PoC代码本身非常简单，旨在读取`/etc/passwd`文件。投毒代码可能存在于以下几个方面：
1.  **测试框架本身的风险：**如果使用自动化测试框架执行此PoC，框架可能被植入恶意代码，但yaml文件本身不具备此特性。
2.  **下载源的风险：**如果yaml文件不是从可信的源下载，下载过程中可能被篡改。
考虑到yaml文件的简单性以及PoC的性质，直接在PoC中投毒的可能性较低。因此，投毒风险估计为5%。

**利用方式:**
1.  攻击者构造包含路径遍历的URL，例如`/%2F%2F%2F%2F%2F%2F%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd`。
2.  攻击者发送GET请求到存在漏洞的Nexus Repository 3服务器。
3.  如果服务器存在漏洞，将返回`/etc/passwd`文件的内容，否则返回错误信息。
4.  攻击者可以替换`/etc/passwd`为其他敏感文件路径，以读取其他文件内容。

**排序优先级说明:**
尽管漏洞库信息提供了漏洞的基本信息，但搜索引擎结果提供了更广泛的参考信息，包括受影响的版本范围和可能的缓解措施。漏洞利用代码是验证漏洞存在的直接证据，因此漏洞利用代码的优先级高于漏洞库信息，而搜索引擎结果的优先级高于漏洞利用代码，是因为搜索引擎结果可以提供更全面的信息。

**项目地址:** [xungzzz/CVE-2024-4956](https://github.com/xungzzz/CVE-2024-4956)

**漏洞详情:** [CVE-2024-4956](https://nvd.nist.gov/vuln/detail/CVE-2024-4956)