## CVE-2024-10924 - Really Simple Security 插件身份验证绕过

**漏洞编号:** CVE-2024-10924

**漏洞类型:** 身份验证绕过

**影响应用:** Really Simple Security (Free, Pro, and Pro Multisite) WordPress 插件

**危害等级:** 高危，可能导致管理员权限被盗用，数据泄露，恶意软件安装

**影响版本:** 9.0.0 - 9.1.1.1

**利用条件:** Two-Factor Authentication 设置已启用

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2024-10924 存在于 Really Simple Security WordPress 插件中，允许未经身份验证的攻击者绕过双因素身份验证，并以任何现有用户的身份登录，包括管理员。这是由于'check_login_and_get_user'函数中的用户检查错误处理不当造成的，该函数用于双因素REST API操作。

**有效性：**

提供的 POC 代码有效，因为它利用了插件中的 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点，通过发送包含 `user_id` 和无效 `login_nonce` 的 POST 请求来绕过 2FA 验证，从而获取有效的身份验证 cookies。

**投毒风险：**

提供的代码中没有明显的投毒代码。它执行的是利用已知漏洞的直接操作，没有发现任何隐藏的恶意行为或后门。

**利用方式：**

1.  攻击者首先需要确定目标 WordPress 网站上一个存在的用户 ID，例如管理员用户 ID（通常为 1）。
2.  攻击者使用 POC 脚本，指定目标域名和用户 ID。
3.  脚本向 `/reallysimplessl/v1/two_fa/skip_onboarding` 端点发送一个 POST 请求，包含 `user_id` 和一个无效的 `login_nonce`。
4.  如果漏洞存在，服务器将返回包含 `wordpress_logged_in_*` 和 `wordpress_*` cookie 的响应。
5.  攻击者手动将这些 cookies 添加到其浏览器中。
6.  攻击者导航到 `wp-admin` 页面，从而获得对 WordPress 管理面板的未经授权的访问权限。

**项目地址:** [sariamubeen/CVE-2024-10924](https://github.com/sariamubeen/CVE-2024-10924)

**漏洞详情:** [CVE-2024-10924](https://nvd.nist.gov/vuln/detail/CVE-2024-10924)