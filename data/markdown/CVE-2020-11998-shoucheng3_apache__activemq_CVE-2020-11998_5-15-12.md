## CVE-2020-11998 Apache ActiveMQ JMX RCE

**漏洞编号:** CVE-2020-11998

**漏洞类型:** 远程代码执行

**影响应用:** Apache ActiveMQ

**危害等级:** 高危，可导致服务器被完全控制

**影响版本:** 5.15.12

**利用条件:** 目标ActiveMQ实例开启JMX且未配置安全认证

**POC 可用性:** 否

**投毒风险:** 0%

## 详情

CVE-2020-11998 漏洞是 Apache ActiveMQ 5.15.12 版本中由于 JMX 配置不当导致的远程代码执行漏洞。根据漏洞描述，当 ActiveMQ 在初始化 RMIConnectorServer 时，错误地传递了一个空的 environment map，导致 JMX 未启用身份验证。这意味着未经授权的远程攻击者可以通过 JMX 接口创建 `javax.management.loading.MLet` MBean，并利用它从任意 URL 加载和实例化恶意 MBeans，从而在目标服务器上执行任意代码。

**有效性评估：**
根据漏洞描述和搜索结果，该漏洞是真实存在的，并且具有较高的风险。攻击者利用该漏洞可以完全控制受影响的 ActiveMQ 服务器。

**投毒风险分析：**
提供的“漏洞利用代码”实际上是一组 PGP 公钥块，用于验证 Apache ActiveMQ 软件的签名。 这些密钥本身不包含任何恶意代码，因此**投毒风险为 0%**。

**利用方式分析：**
1.  **确定目标：** 攻击者需要确定运行着存在漏洞的 Apache ActiveMQ 5.15.12 实例的目标服务器。
2.  **JMX 连接：** 攻击者需要能够通过 JMX 端口连接到目标服务器。默认 JMX 端口通常是 1099，但可能已被更改。
3.  **创建 MLet MBean：** 攻击者使用 JMX 客户端创建一个 `javax.management.loading.MLet` MBean。
4.  **加载恶意 MBean：** 攻击者指示 MLet MBean 从远程 URL 加载一个恶意的 MBean。这个恶意的 MBean 包含攻击者想要在目标服务器上执行的恶意代码。
5.  **执行代码：** 一旦恶意 MBean 被加载和实例化，其构造函数或方法就会被调用，从而在目标服务器上执行任意代码。

**修复建议：**
升级到 Apache ActiveMQ 5.15.13 或更高版本是修复此漏洞的推荐方法。如果无法立即升级，则应该配置 JMX 身份验证，以防止未经授权的访问。

**项目地址:** [shoucheng3/apache__activemq_CVE-2020-11998_5-15-12](https://github.com/shoucheng3/apache__activemq_CVE-2020-11998_5-15-12)

**漏洞详情:** [CVE-2020-11998](https://nvd.nist.gov/vuln/detail/CVE-2020-11998)