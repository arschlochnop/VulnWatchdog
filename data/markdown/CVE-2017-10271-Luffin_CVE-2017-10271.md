## CVE-2017-10271 Oracle WebLogic Server WLS Security 组件反序列化漏洞

**漏洞编号:** CVE-2017-10271

**漏洞类型:** 反序列化漏洞

**影响应用:** Oracle WebLogic Server

**危害等级:** 高危，可能导致远程代码执行，服务器完全控制

**影响版本:** 10.3.6.0.0, 12.1.3.0.0, 12.2.1.1.0, 12.2.1.2.0

**利用条件:** 需要网络访问T3协议端口 (漏洞库信息显示通过T3协议，但POC使用HTTP，实际测试可能需要根据环境调整)

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2017-10271 是 Oracle WebLogic Server 中 WLS Security 组件的一个反序列化漏洞。未经身份验证的攻击者可以通过向 `/wls-wsat/CoordinatorPortType` 发送特制的 SOAP 消息，利用此漏洞在受影响的服务器上执行任意代码。

**有效性评估：**
提供的 POC 代码 `CVE-2017-10271.py` 尝试利用该漏洞。它通过构造包含恶意 Java 对象的 SOAP 消息，并将其通过 HTTP POST 请求发送到 `/wls-wsat/CoordinatorPortType` 端点。代码尝试在目标服务器上执行 `ping` 命令，使用 `ceye.io` 服务来验证漏洞是否成功利用。`README.md` 文件也确认了脚本的功能。

**投毒风险分析：**
审阅提供的代码后，未发现明显的恶意代码或后门。该脚本的目的是利用已知的漏洞，而不是植入任何持久性的恶意功能。漏洞利用过程依赖于 `ceye.io` 服务进行验证，这是一种常见的漏洞验证技术。因此，投毒风险评估为0%。

**利用方式：**
1.  **目标确定：** 确定运行易受攻击的 Oracle WebLogic Server 版本的服务器。
2.  **漏洞利用：** 使用提供的 Python 脚本 `CVE-2017-10271.py`。需要修改脚本中的 `API` 和 `domain` 变量，使用自己的 `ceye.io` 账户信息。
3.  **Payload 传输：** 该脚本构造包含嵌入式恶意 Java 对象的 SOAP 消息，这些对象旨在执行操作系统命令。
4.  **命令执行：** 当 WebLogic Server 反序列化 SOAP 消息时，恶意 Java 对象被实例化，导致在服务器上执行预期的命令（在本例中为 `ping` 命令）。
5.  **验证：** 脚本通过轮询 `ceye.io` API 来验证命令是否已成功执行。如果收到与由脚本生成的随机BANNER匹配的 DNS 查询，则表示漏洞已成功利用。

**项目地址:** [Luffin/CVE-2017-10271](https://github.com/Luffin/CVE-2017-10271)

**漏洞详情:** [CVE-2017-10271](https://nvd.nist.gov/vuln/detail/CVE-2017-10271)