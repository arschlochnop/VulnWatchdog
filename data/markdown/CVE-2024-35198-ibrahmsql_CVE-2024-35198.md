## CVE-2024-35198-TorchServe-路径遍历

**漏洞编号:** CVE-2024-35198

**漏洞类型:** 路径遍历

**影响应用:** TorchServe

**危害等级:** 高危，可能导致任意文件读取、写入和远程代码执行

**影响版本:** >= 0.4.2, < 0.11.0

**利用条件:** 需要网络访问

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-35198是TorchServe中存在的一个路径遍历漏洞。攻击者可以利用".."等字符绕过`allowed_urls`配置的检查，将恶意模型下载到模型存储中。之后，可以无需提供URL直接引用该恶意文件，从而绕过安全检查，最终导致任意文件读取/写入或者远程代码执行。

**有效性：**根据漏洞库信息和搜索结果，此漏洞存在且影响特定版本的TorchServe。POC代码的有效性需要进一步验证，但漏洞描述和搜索结果表明该漏洞是可利用的。

**投毒风险：**提供的POC代码 (`CVE-2024-35198.rb`) **并非**针对TorchServe的路径遍历漏洞，而是针对Discourse的服务器端模板注入漏洞(CVE-2024-35198)。这是一个错误的POC文件，无法用来直接评估TorchServe漏洞的利用。然而，分析该Ruby脚本，存在潜在的风险。脚本尝试各种服务器端模板注入payload，包括执行系统命令（`id`, `whoami`）的payload。如果脚本作者有意插入恶意代码，例如将命令执行结果回传到外部服务器或写入恶意文件，则可能构成投毒。当前分析，未发现明显的恶意回传或恶意写入行为。但代码中存在大量字符串拼接和动态执行，理论上增加了投毒风险。评估投毒风险：代码包含大量复杂逻辑,存在很小几率通过某些方式植入后门代码进行攻击,但是总体分析投毒风险概率较低,**初步分析判断投毒风险在5%左右**。需要安全专家进行进一步分析。

**利用方式：**
1.  攻击者构造包含".."等字符的恶意URL，尝试绕过`allowed_urls`配置的检查。
2.  如果绕过成功，TorchServe会将恶意模型文件下载到模型存储中。
3.  攻击者随后可以不提供URL，直接引用存储中的恶意模型文件。
4.  加载恶意模型时，可能触发恶意代码执行，例如执行任意系统命令。

**项目地址:** [ibrahmsql/CVE-2024-35198](https://github.com/ibrahmsql/CVE-2024-35198)

**漏洞详情:** [CVE-2024-35198](https://nvd.nist.gov/vuln/detail/CVE-2024-35198)