## CVE-2025-1055 - K7RKScan.sys 任意进程终止

**漏洞编号:** CVE-2025-1055

**漏洞类型:** 权限提升/拒绝服务

**影响应用:** K7 Security Anti-Malware

**危害等级:** 中危，可能导致系统服务中断

**影响版本:** < 23.0.0.10

**利用条件:** 本地低权限用户，需要安装存在漏洞的K7 Security Anti-Malware版本

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2025-1055 漏洞存在于 K7 Security Anti-Malware 的 K7RKScan.sys 驱动中。该驱动的 IOCTL 处理程序缺少适当的访问控制，允许本地低权限用户发送特制的 IOCTL 请求，从而终止以管理员或系统权限运行的进程。提供的 POC 代码通过 CreateFileA 函数打开设备句柄，然后使用 DeviceIoControl 函数发送 IOCTL 0x222018 和目标进程的 PID 来利用此漏洞。POC 代码首先通过 `getPID` 函数查找目标进程 `MsMpEng.exe` (Windows Defender) 的 PID，然后不断尝试终止该进程。根据漏洞描述，操作系统本身保护的进程无法被终止。

**有效性评估：**
POC 代码似乎有效。根据 CVE 描述和 POC 说明，它利用了驱动程序中的权限提升漏洞，允许低权限用户终止高权限进程。实际效果取决于操作系统对受保护进程的限制。

**投毒风险分析：**
该 POC 代码主要包含以下功能：
1.  获取进程 PID (`getPID` 函数)。
2.  打开设备驱动程序 (`CreateFileA`)。
3.  使用 `DeviceIoControl` 函数发送 IOCTL 请求以终止进程。
代码中没有明显的恶意行为，例如写入文件、修改注册表或建立网络连接。但是，由于漏洞利用本身涉及终止进程，如果目标进程是关键系统进程，可能会导致系统不稳定或崩溃。无限循环终止进程可以视为一种拒绝服务攻击。 投毒风险较低， 估计为5%。

**利用方式总结：**
1.  目标系统必须安装受影响版本的 K7 Security Anti-Malware。
2.  攻击者需要具有本地低权限帐户。
3.  攻击者需要运行 POC 代码，该代码将利用 K7RKScan.sys 驱动程序中的漏洞来终止指定的进程。
4.  漏洞利用成功后，目标进程将被终止，可能导致服务中断或系统不稳定。

**项目地址:** [diego-tella/CVE-2025-1055-poc](https://github.com/diego-tella/CVE-2025-1055-poc)

**漏洞详情:** [CVE-2025-1055](https://nvd.nist.gov/vuln/detail/CVE-2025-1055)