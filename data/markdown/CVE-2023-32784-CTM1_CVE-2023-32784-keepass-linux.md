## CVE-2023-32784-KeePass-内存泄漏

**漏洞编号:** CVE-2023-32784

**漏洞类型:** 内存泄漏

**影响应用:** KeePass

**危害等级:** 高危，可能导致主密码泄露

**影响版本:** < 2.54

**利用条件:** 需要本地系统访问权限

**POC 可用性:** 是

**投毒风险:** 1%

## 详情

CVE-2023-32784 允许从 KeePass 2.x (版本低于 2.54) 的内存转储中恢复明文主密码，即使工作区已锁定或不再运行。攻击者可以通过获取 KeePass 进程的内存转储、交换文件（pagefile.sys）、休眠文件（hiberfil.sys）或整个系统的 RAM 转储来利用此漏洞。POC代码通过扫描 /proc/<pid>/cmdline 文件找到包含“KeePass”的进程，然后读取 /proc/<pid>/maps 中没有直接关联库（空文件路径）的内存地址，并使用 /proc/<pid>/mem 将这些内存映射的内容转储到缓冲区中。最后，解析内存，查找用户输入主密码时留下的痕迹字符串（例如 “•a, ••s, •••s”）。此漏洞利用需要访问 /proc 虚拟文件系统，通常只有 root 用户有权访问。PoC代码中存在极小的投毒风险，例如，攻击者可能会修改内存解析逻辑，使其仅在特定环境下有效，从而隐藏攻击行为，但可能性很小，因为代码相对简单直接。

**项目地址:** [CTM1/CVE-2023-32784-keepass-linux](https://github.com/CTM1/CVE-2023-32784-keepass-linux)

**漏洞详情:** [CVE-2023-32784](https://nvd.nist.gov/vuln/detail/CVE-2023-32784)