## CVE-2022-27925-Zimbra-路径遍历

**漏洞编号:** CVE-2022-27925

**漏洞类型:** 路径遍历/文件上传

**影响应用:** Zimbra Collaboration Suite (ZCS)

**危害等级:** 高危，可能导致任意文件上传和远程代码执行

**影响版本:** 8.8.15 和 9.0

**利用条件:** 需要管理员权限，但可能存在未授权访问利用链（CVE-2022-37042）。 需要能够上传 ZIP 压缩包到服务器。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于Zimbra Collaboration Suite的mboximport功能中。一个具有管理员权限的认证用户可以通过上传恶意的ZIP压缩包，利用路径遍历漏洞将任意文件写入系统，最终可能导致远程代码执行。POC代码通过构造包含恶意路径的ZIP文件，并利用mboximport接口上传到服务器。搜索引擎结果显示，此漏洞被大规模利用，并且存在未经身份验证的利用方式（CVE-2022-37042）。

**漏洞利用方式：**

1.  攻击者需要访问Zimbra服务器的mboximport功能。
2.  攻击者构造一个包含恶意路径的ZIP压缩包。该ZIP包中的文件路径包含路径遍历字符（例如`../`），指向服务器文件系统中的目标位置。
3.  攻击者通过mboximport接口上传该ZIP压缩包。
4.  Zimbra服务器解压该ZIP压缩包，由于没有充分验证文件路径，导致恶意文件被写入到指定的位置。
5. 攻击者可以通过上传webshell等文件, 获取服务器的控制权限.

**投毒风险分析：**

虽然POC代码本身功能是实现漏洞利用，但仍然存在一些潜在的投毒风险：

1.  **利用脚本的隐蔽修改：** 攻击者可能在原始利用脚本中添加额外的恶意代码，例如反向shell、数据收集等。用户下载并执行被篡改的脚本后，可能会受到进一步的攻击。
2.  **ZIP文件内容替换：** 攻击者可能会替换POC中使用的ZIP文件，使其包含更具破坏性的恶意代码或文件。
3.  **对cmd.jsp的修改:** 攻击者可能会修改`cmd.jsp`里的内容,植入恶意代码.

基于以上分析，我将投毒风险评定为10%。 虽然poc验证本身是按照漏洞描述进行的, 没有发现明确的后门, 但是用户在使用POC时，仍应保持警惕，验证代码的完整性和安全性。特别注意检查ZIP文件的内容以及利用脚本的来源。

**项目地址:** [miko550/CVE-2022-27925](https://github.com/miko550/CVE-2022-27925)

**漏洞详情:** [CVE-2022-27925](https://nvd.nist.gov/vuln/detail/CVE-2022-27925)