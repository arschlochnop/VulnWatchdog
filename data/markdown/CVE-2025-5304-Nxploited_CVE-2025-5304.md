## CVE-2025-5304 - PT Project Notebooks 未授权特权提升

**漏洞编号:** CVE-2025-5304

**漏洞类型:** 特权提升

**影响应用:** PT Project Notebooks WordPress 插件

**危害等级:** 高危，允许未授权用户提升为管理员权限

**影响版本:** 1.0.0 - 1.1.3

**利用条件:** 目标网站安装并启用了受影响版本的 PT Project Notebooks 插件，且攻击者能够访问该网站。

**POC 可用性:** 是

**投毒风险:** 0%

## 详情

CVE-2025-5304 存在于 PT Project Notebooks WordPress 插件中，允许未授权的攻击者通过 wpnb_pto_new_users_add 函数提升权限。漏洞原因是该函数缺少授权验证。攻击者可以通过发送包含目标用户ID和设置为管理员用户类型参数的 POST 请求到 admin-ajax.php，从而将指定用户提升为管理员。

**利用方式：**

1.  **版本检测：** 使用 PoC 脚本尝试从 readme.txt 文件中获取插件版本。如果指定了`--skip-version`参数，则跳过此步骤。
2.  **Nonce 和 AJAX URL 提取：** 脚本尝试从页面源代码中提取 nonce 值和 AJAX URL。 如果无法提取，则使用默认的 /wp-admin/admin-ajax.php 作为 AJAX URL。
3.  **漏洞利用：** 脚本构造一个包含 `action`、`nonce`、`ids` (用户ID) 和 `user_type` (设置为2，代表管理员) 的 POST 请求，并将其发送到 AJAX URL。如果成功，指定的 User ID 将被提升到管理员角色。

**有效性评估：**

根据漏洞描述和提供的 PoC 代码，可以判断该漏洞利用是有效的。 PoC 代码实现了利用漏洞所需的步骤，包括版本检测、 nonce 获取和构造恶意请求。

**投毒风险评估：**

该 PoC 代码主要实现了漏洞的利用，没有发现明显的恶意代码或后门。代码的意图是提升指定用户的权限，没有发现其他未声明的功能。因此，投毒风险评估为 0%。所有操作都围绕着利用这个未授权访问漏洞展开。

**项目地址:** [Nxploited/CVE-2025-5304](https://github.com/Nxploited/CVE-2025-5304)

**漏洞详情:** [CVE-2025-5304](https://nvd.nist.gov/vuln/detail/CVE-2025-5304)