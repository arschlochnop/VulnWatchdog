## CVE-2021-26855 Microsoft Exchange Server ProxyLogon RCE

**漏洞编号:** CVE-2021-26855

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** Microsoft Exchange Server

**危害等级:** 高危，未经身份验证的远程攻击者可以执行任意命令

**影响版本:** Exchange 2013 Versions < 15.00.1497.012, Exchange 2016 CU18 < 15.01.2106.013, Exchange 2016 CU19 < 15.01.2176.009, Exchange 2019 CU7 < 15.02.0721.013, Exchange 2019 CU8 < 15.02.0792.010

**利用条件:** 目标 Exchange Server 必须可从网络访问,且未安装相应的安全补丁

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2021-26855 是 Microsoft Exchange Server 中的一个服务器端请求伪造 (SSRF) 漏洞，属于 ProxyLogon 攻击链的一部分。未经身份验证的攻击者可以利用此漏洞发送任意 HTTP 请求，绕过身份验证，并冒充管理员。该漏洞本身并不能直接导致 RCE，但可以与其他漏洞（如 CVE-2021-27065，一个身份验证后的任意文件写入漏洞）结合使用，最终实现远程代码执行。

**利用方式：**

1.  **SSRF（CVE-2021-26855）：**  攻击者利用 SSRF 漏洞发送精心构造的 HTTP 请求，绕过 Exchange Server 的身份验证。
2.  **身份验证绕过：**  成功利用 SSRF 后，攻击者可以获得 Exchange Server 的管理权限，无需提供有效的用户名和密码。
3.  **任意文件写入（CVE-2021-27065 或其他）：**  获得身份验证后，攻击者利用任意文件写入漏洞，将恶意代码写入 Exchange Server 的文件系统中。
4.  **代码执行：**  通过访问写入的恶意文件，攻击者可以在 Exchange Server 上执行任意命令，实现远程代码执行。

**有效性：**

提供的 Metasploit 模块 (`exchange_proxylogon.rb`) 是一个扫描器，用于检测目标 Exchange Server 是否存在 CVE-2021-26855 漏洞。它通过发送特定的 HTTP 请求来验证漏洞是否存在。如果扫描器检测到漏洞，则表明目标服务器容易受到 ProxyLogon 攻击。

**投毒风险：**

提供的代码主要是一个漏洞验证和扫描工具，没有明显的投毒代码。但任何来自外部的代码都存在一定的风险，所以投毒风险估计为5%。主要需要关注的是Metasploit模块中使用的HTTP请求的构造，以及是否会意外地对目标系统造成破坏。此外，攻击者可能会修改此模块以达到恶意目的，但在提供的代码本身中没有发现此类行为。

**项目地址:** [mekhalleh/exchange_proxylogon](https://github.com/mekhalleh/exchange_proxylogon)

**漏洞详情:** [CVE-2021-26855](https://nvd.nist.gov/vuln/detail/CVE-2021-26855)