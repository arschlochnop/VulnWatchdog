## CVE-2011-1249 - Windows AFD Elevation of Privilege

**漏洞编号:** CVE-2011-1249

**漏洞类型:** 权限提升

**影响应用:** Microsoft Windows

**危害等级:** 高危，本地用户可提升权限

**影响版本:** Windows XP SP2/SP3, Windows Server 2003 SP2, Windows Vista SP1/SP2, Windows Server 2008 Gold/SP2/R2/R2 SP1, Windows 7 Gold/SP1

**利用条件:** 本地用户权限，目标系统未安装MS11-046补丁

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2011-1249 存在于 Windows 的 Ancillary Function Driver (AFD) (afd.sys) 中，由于 afd.sys 没有正确验证用户模式的输入，本地用户可以通过特制的应用程序提升权限。根据漏洞库信息和搜索结果，漏洞利用代码已公开 (Exploit-DB 40564)。

**有效性：**
根据搜索结果，存在公开的漏洞利用代码，并且 Microsoft 发布了安全公告 MS11-046 来修复此漏洞。因此，利用代码是有效的，在未打补丁的系统上可以成功利用。

**投毒风险：**
提供的漏洞利用代码仓库只包含一个 README.md 文件,风险较低。但是，始终存在代码被篡改并植入恶意代码的可能性。由于只包含一个描述性文件，没有实际的C语言代码，所以投毒风险主要在于对描述文件内容的篡改或替换。因此，将投毒风险评估为10%。

**利用方式：**
该漏洞的利用方式通常涉及以下步骤：
1.  编写或使用现成的漏洞利用程序。
2.  该程序会构造恶意的输入数据，发送给 afd.sys 驱动。
3.  afd.sys 驱动未能正确处理这些输入，导致内存损坏或代码执行。
4.  攻击者通过精心构造的 payload 来提升权限，例如，覆盖内核对象或修改进程令牌。

由于提供的代码仓库只有 README.md 文件，所以需要进一步获取到实际的C代码才能进一步确认详细的利用方式。

**项目地址:** [Madusanka99/OHTS](https://github.com/Madusanka99/OHTS)

**漏洞详情:** [CVE-2011-1249](https://nvd.nist.gov/vuln/detail/CVE-2011-1249)