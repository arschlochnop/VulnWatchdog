## CVE-2025-34085 - WordPress Simple File List Plugin RCE

**漏洞编号:** CVE-2025-34085

**漏洞类型:** 远程代码执行 (RCE)

**影响应用:** WordPress Simple File List Plugin

**危害等级:** 高危，允许未经身份验证的远程攻击者执行任意代码

**影响版本:** < 4.2.3

**利用条件:** 目标网站安装了Simple File List插件，且版本低于4.2.3，目标服务器允许执行PHP代码。

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

该漏洞存在于WordPress Simple File List插件中，由于插件对上传文件和重命名文件时的扩展名验证不足，导致未经身份验证的攻击者可以上传恶意PHP文件并执行。利用方式如下：

1.  **漏洞描述：** CVE-2025-34085是一个未经身份验证的远程代码执行漏洞，影响WordPress Simple File List插件4.2.3之前的版本。
2.  **漏洞原理：** 攻击者可以首先上传一个伪装成`.png`文件的PHP payload，然后使用插件的重命名功能`ee-file-engine.php`将扩展名更改为`.php`。这绕过了上传限制，导致上传的payload在服务器上可执行。
3.  **利用方式：**
    *   使用POC脚本或手动构造HTTP请求，上传包含PHP代码的`.png`文件到`ee-upload-engine.php`。
    *   使用`ee-file-engine.php`将上传的`.png`文件重命名为`.php`或`.phtml`等PHP可执行扩展名。
    *   访问重命名后的PHP文件，即可执行其中的恶意代码，实现远程代码执行。

4.  **POC有效性：** 提供的POC代码看起来有效。它实现了漏洞描述中的上传和重命名步骤，并尝试通过GET请求执行上传的shell，检查返回结果中是否包含预期的字符串。脚本还使用了多线程来加速扫描。

5.  **投毒风险：**  代码中存在潜在的风险，尽管看起来像一个合法的漏洞利用程序。它下载一个文件到目标系统，如果目标机器比较重要，一旦这个系统被控制，就可能对内网进行渗透。LICENSE使用的名称是ill deed, 有“恶意行为”的意思，一定程度上作者有不良企图，因此存在一定的投毒风险。但是考虑到代码逻辑清晰，功能单一，针对特定漏洞，以及免责声明的存在，判断投毒风险为10%。 主要风险点在于，如果利用成功，会在目标服务器留下webshell，长期存在安全隐患。 脚本尝试多个php扩展名是一个比较好的尝试.

6. **搜索引擎结果参考:** 搜索引擎结果证实了该漏洞的存在以及其严重性，并提供了多个来源的参考信息，包括NVD、Red Hat和VulDB等。


**项目地址:** [ill-deed/CVE-2025-34085-Multi-target](https://github.com/ill-deed/CVE-2025-34085-Multi-target)

**漏洞详情:** [CVE-2025-34085](https://nvd.nist.gov/vuln/detail/CVE-2025-34085)