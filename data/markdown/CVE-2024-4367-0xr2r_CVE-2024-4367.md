## CVE-2024-4367-PDF.js-任意JavaScript执行

**漏洞编号:** CVE-2024-4367

**漏洞类型:** 任意JavaScript执行

**影响应用:** PDF.js (Firefox, Firefox ESR, Thunderbird)

**危害等级:** 高危，可能导致跨站脚本攻击（XSS）和信息泄露

**影响版本:** Firefox < 126, Firefox ESR < 115.11, Thunderbird < 115.11

**利用条件:** 用户需要打开恶意PDF文件

**POC 可用性:** 是

**投毒风险:** 10%

## 详情

CVE-2024-4367是PDF.js中的一个漏洞，由于在处理字体时缺少类型检查，攻击者可以通过构造恶意的PDF文件，在PDF.js上下文中执行任意JavaScript代码。用户打开恶意PDF文件后，攻击者的JavaScript代码将在用户的浏览器中执行，可能导致跨站脚本攻击(XSS)、信息窃取或其他恶意行为。

**有效性：**
根据漏洞信息和搜索结果，提供的POC代码是有效的。它利用了PDF.js字体处理中缺少类型检查的漏洞，将JavaScript代码注入到PDF文件中，并在打开该文件时执行。

**投毒风险：**
虽然POC代码本身是为了验证漏洞的存在，但仓库中存在轻微的投毒风险。POC代码的功能是生成包含恶意JavaScript的PDF文件，其目的是触发漏洞。但mali.pdf可能存在非预期代码的风险。因此，风险评估为10%。

**利用方式：**
1.  攻击者构造一个包含恶意JavaScript代码的PDF文件。
2.  攻击者将恶意PDF文件发送给受害者，或者将其托管在网站上诱导受害者下载。
3.  受害者使用受影响的Firefox、Firefox ESR或Thunderbird版本打开该PDF文件。
4.  PDF.js解析PDF文件时，由于缺少类型检查，恶意JavaScript代码被执行。
5.  恶意JavaScript代码在受害者的浏览器中执行，可能导致跨站脚本攻击（XSS）、信息窃取或其他恶意行为。

**项目地址:** [0xr2r/CVE-2024-4367](https://github.com/0xr2r/CVE-2024-4367)

**漏洞详情:** [CVE-2024-4367](https://nvd.nist.gov/vuln/detail/CVE-2024-4367)