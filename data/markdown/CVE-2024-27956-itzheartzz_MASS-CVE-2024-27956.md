## CVE-2024-27956-WordPress Automatic-SQL注入

**漏洞编号:** CVE-2024-27956

**漏洞类型:** SQL注入

**影响应用:** WordPress Automatic插件

**危害等级:** 高危，可能导致数据泄露和远程代码执行

**影响版本:** <= 3.92.0

**利用条件:** WordPress站点安装了存在漏洞的wp-automatic插件，且未进行身份验证即可访问csv.php文件。

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

CVE-2024-27956是WordPress Automatic插件3.92.0及之前版本中存在的一个SQL注入漏洞。未经身份验证的攻击者可以通过`wp-content/plugins/wp-automatic/inc/csv.php`文件发送特制的POST请求，注入恶意的SQL语句，执行任意SQL查询。PoC代码通过创建新的管理员用户'eviladmin'并赋予其administrator权限来利用此漏洞，从而可能导致远程代码执行。\n\n**有效性：** PoC代码有效，根据搜索结果和PoC代码描述，攻击者可以利用此漏洞在受影响的WordPress站点上创建管理员账户，从而获得完全控制权限。\n\n**投毒风险：** PoC代码本身旨在创建管理员用户，但并不能完全排除投毒的可能。可能存在的投毒风险包括：\n1.  **密码哈希的安全性问题：** PoC中使用了硬编码的密码哈希`$P$BASbMqW0nlZRux/2IhCw7AdvoNI4VT0`，虽然对应的密码是'admin'，但如果攻击者修改了哈希但没有更新密码，那么就可能留下了一个更难被发现的后门。\n2.  **其他隐藏的数据库操作：** 攻击者可能在SQL注入语句中加入额外的恶意操作，例如修改其他用户权限、植入webshell等。\n3.  **下载源的可靠性：** 虽然PoC代码本身没有明显的恶意代码，但是下载该代码的GitHub仓库可能存在风险，例如被恶意修改或包含其他恶意文件。\n\n因此，尽管PoC的主要功能是利用SQL注入创建管理员，但仍存在一些潜在的投毒风险，估计投毒风险为5%。\n\n**利用方式：**\n1.  攻击者构造包含恶意SQL代码的POST请求，发送到目标WordPress站点的`/wp-content/plugins/wp-automatic/inc/csv.php`文件。请求包含`q`参数（用于SQL注入）和`auth`、`integ`参数（用于绕过插件的简单完整性检查）。\n2.  第一次请求使用`INSERT INTO wp_users`语句创建一个新的用户'eviladmin'，密码设置为'admin'（对应于硬编码的哈希值）。\n3.  第二次请求使用`INSERT INTO wp_usermeta`语句将'eviladmin'用户的`wp_capabilities`元数据设置为`administrator`，从而赋予其管理员权限。\n4.  攻击者可以使用新创建的管理员账户登录WordPress后台，进行任意操作，包括上传恶意插件、修改主题文件等，最终实现远程代码执行。

**项目地址:** [itzheartzz/MASS-CVE-2024-27956](https://github.com/itzheartzz/MASS-CVE-2024-27956)

**漏洞详情:** [CVE-2024-27956](https://nvd.nist.gov/vuln/detail/CVE-2024-27956)